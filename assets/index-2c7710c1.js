var Koe=Object.defineProperty;var Joe=(n,e,i)=>e in n?Koe(n,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):n[e]=i;var wn=(n,e,i)=>(Joe(n,typeof e!="symbol"?e+"":e,i),i);function Mj(n,e){for(var i=0;i<e.length;i++){const a=e[i];if(typeof a!="string"&&!Array.isArray(a)){for(const s in a)if(s!=="default"&&!(s in n)){const l=Object.getOwnPropertyDescriptor(a,s);l&&Object.defineProperty(n,s,l.get?l:{enumerable:!0,get:()=>a[s]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))a(s);new MutationObserver(s=>{for(const l of s)if(l.type==="childList")for(const d of l.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&a(d)}).observe(document,{childList:!0,subtree:!0});function i(s){const l={};return s.integrity&&(l.integrity=s.integrity),s.referrerPolicy&&(l.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?l.credentials="include":s.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function a(s){if(s.ep)return;s.ep=!0;const l=i(s);fetch(s.href,l)}})();var Qoe=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Nw(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function Tj(n){if(n.__esModule)return n;var e=n.default;if(typeof e=="function"){var i=function a(){return this instanceof a?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};i.prototype=e.prototype}else i={};return Object.defineProperty(i,"__esModule",{value:!0}),Object.keys(n).forEach(function(a){var s=Object.getOwnPropertyDescriptor(n,a);Object.defineProperty(i,a,s.get?s:{enumerable:!0,get:function(){return n[a]}})}),i}var Aj={exports:{}},rr={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Fw=Symbol.for("react.element"),ese=Symbol.for("react.portal"),tse=Symbol.for("react.fragment"),nse=Symbol.for("react.strict_mode"),ise=Symbol.for("react.profiler"),rse=Symbol.for("react.provider"),ase=Symbol.for("react.context"),ose=Symbol.for("react.forward_ref"),sse=Symbol.for("react.suspense"),lse=Symbol.for("react.memo"),cse=Symbol.for("react.lazy"),H8=Symbol.iterator;function use(n){return n===null||typeof n!="object"?null:(n=H8&&n[H8]||n["@@iterator"],typeof n=="function"?n:null)}var Cj={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Pj=Object.assign,Ij={};function T_(n,e,i){this.props=n,this.context=e,this.refs=Ij,this.updater=i||Cj}T_.prototype.isReactComponent={};T_.prototype.setState=function(n,e){if(typeof n!="object"&&typeof n!="function"&&n!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,n,e,"setState")};T_.prototype.forceUpdate=function(n){this.updater.enqueueForceUpdate(this,n,"forceUpdate")};function Rj(){}Rj.prototype=T_.prototype;function xD(n,e,i){this.props=n,this.context=e,this.refs=Ij,this.updater=i||Cj}var bD=xD.prototype=new Rj;bD.constructor=xD;Pj(bD,T_.prototype);bD.isPureReactComponent=!0;var j8=Array.isArray,Lj=Object.prototype.hasOwnProperty,wD={current:null},kj={key:!0,ref:!0,__self:!0,__source:!0};function Dj(n,e,i){var a,s={},l=null,d=null;if(e!=null)for(a in e.ref!==void 0&&(d=e.ref),e.key!==void 0&&(l=""+e.key),e)Lj.call(e,a)&&!kj.hasOwnProperty(a)&&(s[a]=e[a]);var f=arguments.length-2;if(f===1)s.children=i;else if(1<f){for(var p=Array(f),y=0;y<f;y++)p[y]=arguments[y+2];s.children=p}if(n&&n.defaultProps)for(a in f=n.defaultProps,f)s[a]===void 0&&(s[a]=f[a]);return{$$typeof:Fw,type:n,key:l,ref:d,props:s,_owner:wD.current}}function dse(n,e){return{$$typeof:Fw,type:n.type,key:e,ref:n.ref,props:n.props,_owner:n._owner}}function SD(n){return typeof n=="object"&&n!==null&&n.$$typeof===Fw}function hse(n){var e={"=":"=0",":":"=2"};return"$"+n.replace(/[=:]/g,function(i){return e[i]})}var $8=/\/+/g;function KI(n,e){return typeof n=="object"&&n!==null&&n.key!=null?hse(""+n.key):e.toString(36)}function qE(n,e,i,a,s){var l=typeof n;(l==="undefined"||l==="boolean")&&(n=null);var d=!1;if(n===null)d=!0;else switch(l){case"string":case"number":d=!0;break;case"object":switch(n.$$typeof){case Fw:case ese:d=!0}}if(d)return d=n,s=s(d),n=a===""?"."+KI(d,0):a,j8(s)?(i="",n!=null&&(i=n.replace($8,"$&/")+"/"),qE(s,e,i,"",function(y){return y})):s!=null&&(SD(s)&&(s=dse(s,i+(!s.key||d&&d.key===s.key?"":(""+s.key).replace($8,"$&/")+"/")+n)),e.push(s)),1;if(d=0,a=a===""?".":a+":",j8(n))for(var f=0;f<n.length;f++){l=n[f];var p=a+KI(l,f);d+=qE(l,e,i,p,s)}else if(p=use(n),typeof p=="function")for(n=p.call(n),f=0;!(l=n.next()).done;)l=l.value,p=a+KI(l,f++),d+=qE(l,e,i,p,s);else if(l==="object")throw e=String(n),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return d}function s3(n,e,i){if(n==null)return n;var a=[],s=0;return qE(n,a,"","",function(l){return e.call(i,l,s++)}),a}function fse(n){if(n._status===-1){var e=n._result;e=e(),e.then(function(i){(n._status===0||n._status===-1)&&(n._status=1,n._result=i)},function(i){(n._status===0||n._status===-1)&&(n._status=2,n._result=i)}),n._status===-1&&(n._status=0,n._result=e)}if(n._status===1)return n._result.default;throw n._result}var Xs={current:null},XE={transition:null},pse={ReactCurrentDispatcher:Xs,ReactCurrentBatchConfig:XE,ReactCurrentOwner:wD};rr.Children={map:s3,forEach:function(n,e,i){s3(n,function(){e.apply(this,arguments)},i)},count:function(n){var e=0;return s3(n,function(){e++}),e},toArray:function(n){return s3(n,function(e){return e})||[]},only:function(n){if(!SD(n))throw Error("React.Children.only expected to receive a single React element child.");return n}};rr.Component=T_;rr.Fragment=tse;rr.Profiler=ise;rr.PureComponent=xD;rr.StrictMode=nse;rr.Suspense=sse;rr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=pse;rr.cloneElement=function(n,e,i){if(n==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+n+".");var a=Pj({},n.props),s=n.key,l=n.ref,d=n._owner;if(e!=null){if(e.ref!==void 0&&(l=e.ref,d=wD.current),e.key!==void 0&&(s=""+e.key),n.type&&n.type.defaultProps)var f=n.type.defaultProps;for(p in e)Lj.call(e,p)&&!kj.hasOwnProperty(p)&&(a[p]=e[p]===void 0&&f!==void 0?f[p]:e[p])}var p=arguments.length-2;if(p===1)a.children=i;else if(1<p){f=Array(p);for(var y=0;y<p;y++)f[y]=arguments[y+2];a.children=f}return{$$typeof:Fw,type:n.type,key:s,ref:l,props:a,_owner:d}};rr.createContext=function(n){return n={$$typeof:ase,_currentValue:n,_currentValue2:n,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},n.Provider={$$typeof:rse,_context:n},n.Consumer=n};rr.createElement=Dj;rr.createFactory=function(n){var e=Dj.bind(null,n);return e.type=n,e};rr.createRef=function(){return{current:null}};rr.forwardRef=function(n){return{$$typeof:ose,render:n}};rr.isValidElement=SD;rr.lazy=function(n){return{$$typeof:cse,_payload:{_status:-1,_result:n},_init:fse}};rr.memo=function(n,e){return{$$typeof:lse,type:n,compare:e===void 0?null:e}};rr.startTransition=function(n){var e=XE.transition;XE.transition={};try{n()}finally{XE.transition=e}};rr.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};rr.useCallback=function(n,e){return Xs.current.useCallback(n,e)};rr.useContext=function(n){return Xs.current.useContext(n)};rr.useDebugValue=function(){};rr.useDeferredValue=function(n){return Xs.current.useDeferredValue(n)};rr.useEffect=function(n,e){return Xs.current.useEffect(n,e)};rr.useId=function(){return Xs.current.useId()};rr.useImperativeHandle=function(n,e,i){return Xs.current.useImperativeHandle(n,e,i)};rr.useInsertionEffect=function(n,e){return Xs.current.useInsertionEffect(n,e)};rr.useLayoutEffect=function(n,e){return Xs.current.useLayoutEffect(n,e)};rr.useMemo=function(n,e){return Xs.current.useMemo(n,e)};rr.useReducer=function(n,e,i){return Xs.current.useReducer(n,e,i)};rr.useRef=function(n){return Xs.current.useRef(n)};rr.useState=function(n){return Xs.current.useState(n)};rr.useSyncExternalStore=function(n,e,i){return Xs.current.useSyncExternalStore(n,e,i)};rr.useTransition=function(){return Xs.current.useTransition()};rr.version="18.2.0";Aj.exports=rr;var ne=Aj.exports;const Kl=Nw(ne),IM=Mj({__proto__:null,default:Kl},[ne]);var ZL={},zj={exports:{}},rc={},Oj={exports:{}},Nj={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(n){function e(le,me){var we=le.length;le.push(me);e:for(;0<we;){var re=we-1>>>1,Te=le[re];if(0<s(Te,me))le[re]=me,le[we]=Te,we=re;else break e}}function i(le){return le.length===0?null:le[0]}function a(le){if(le.length===0)return null;var me=le[0],we=le.pop();if(we!==me){le[0]=we;e:for(var re=0,Te=le.length,Je=Te>>>1;re<Je;){var Xe=2*(re+1)-1,Ze=le[Xe],Fe=Xe+1,ct=le[Fe];if(0>s(Ze,we))Fe<Te&&0>s(ct,Ze)?(le[re]=ct,le[Fe]=we,re=Fe):(le[re]=Ze,le[Xe]=we,re=Xe);else if(Fe<Te&&0>s(ct,we))le[re]=ct,le[Fe]=we,re=Fe;else break e}}return me}function s(le,me){var we=le.sortIndex-me.sortIndex;return we!==0?we:le.id-me.id}if(typeof performance=="object"&&typeof performance.now=="function"){var l=performance;n.unstable_now=function(){return l.now()}}else{var d=Date,f=d.now();n.unstable_now=function(){return d.now()-f}}var p=[],y=[],_=1,b=null,S=3,A=!1,P=!1,L=!1,k=typeof setTimeout=="function"?setTimeout:null,R=typeof clearTimeout=="function"?clearTimeout:null,z=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function O(le){for(var me=i(y);me!==null;){if(me.callback===null)a(y);else if(me.startTime<=le)a(y),me.sortIndex=me.expirationTime,e(p,me);else break;me=i(y)}}function F(le){if(L=!1,O(le),!P)if(i(p)!==null)P=!0,Re(H);else{var me=i(y);me!==null&&Be(F,me.startTime-le)}}function H(le,me){P=!1,L&&(L=!1,R(te),te=-1),A=!0;var we=S;try{for(O(me),b=i(p);b!==null&&(!(b.expirationTime>me)||le&&!he());){var re=b.callback;if(typeof re=="function"){b.callback=null,S=b.priorityLevel;var Te=re(b.expirationTime<=me);me=n.unstable_now(),typeof Te=="function"?b.callback=Te:b===i(p)&&a(p),O(me)}else a(p);b=i(p)}if(b!==null)var Je=!0;else{var Xe=i(y);Xe!==null&&Be(F,Xe.startTime-me),Je=!1}return Je}finally{b=null,S=we,A=!1}}var $=!1,Y=null,te=-1,G=5,Q=-1;function he(){return!(n.unstable_now()-Q<G)}function pe(){if(Y!==null){var le=n.unstable_now();Q=le;var me=!0;try{me=Y(!0,le)}finally{me?ye():($=!1,Y=null)}}else $=!1}var ye;if(typeof z=="function")ye=function(){z(pe)};else if(typeof MessageChannel<"u"){var fe=new MessageChannel,Ae=fe.port2;fe.port1.onmessage=pe,ye=function(){Ae.postMessage(null)}}else ye=function(){k(pe,0)};function Re(le){Y=le,$||($=!0,ye())}function Be(le,me){te=k(function(){le(n.unstable_now())},me)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(le){le.callback=null},n.unstable_continueExecution=function(){P||A||(P=!0,Re(H))},n.unstable_forceFrameRate=function(le){0>le||125<le?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):G=0<le?Math.floor(1e3/le):5},n.unstable_getCurrentPriorityLevel=function(){return S},n.unstable_getFirstCallbackNode=function(){return i(p)},n.unstable_next=function(le){switch(S){case 1:case 2:case 3:var me=3;break;default:me=S}var we=S;S=me;try{return le()}finally{S=we}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(le,me){switch(le){case 1:case 2:case 3:case 4:case 5:break;default:le=3}var we=S;S=le;try{return me()}finally{S=we}},n.unstable_scheduleCallback=function(le,me,we){var re=n.unstable_now();switch(typeof we=="object"&&we!==null?(we=we.delay,we=typeof we=="number"&&0<we?re+we:re):we=re,le){case 1:var Te=-1;break;case 2:Te=250;break;case 5:Te=1073741823;break;case 4:Te=1e4;break;default:Te=5e3}return Te=we+Te,le={id:_++,callback:me,priorityLevel:le,startTime:we,expirationTime:Te,sortIndex:-1},we>re?(le.sortIndex=we,e(y,le),i(p)===null&&le===i(y)&&(L?(R(te),te=-1):L=!0,Be(F,we-re))):(le.sortIndex=Te,e(p,le),P||A||(P=!0,Re(H))),le},n.unstable_shouldYield=he,n.unstable_wrapCallback=function(le){var me=S;return function(){var we=S;S=me;try{return le.apply(this,arguments)}finally{S=we}}}})(Nj);Oj.exports=Nj;var mse=Oj.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Fj=ne,nc=mse;function pn(n){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+n,i=1;i<arguments.length;i++)e+="&args[]="+encodeURIComponent(arguments[i]);return"Minified React error #"+n+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Bj=new Set,zb={};function Qg(n,e){t_(n,e),t_(n+"Capture",e)}function t_(n,e){for(zb[n]=e,n=0;n<e.length;n++)Bj.add(e[n])}var Vh=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),KL=Object.prototype.hasOwnProperty,gse=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Y8={},q8={};function yse(n){return KL.call(q8,n)?!0:KL.call(Y8,n)?!1:gse.test(n)?q8[n]=!0:(Y8[n]=!0,!1)}function vse(n,e,i,a){if(i!==null&&i.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return a?!1:i!==null?!i.acceptsBooleans:(n=n.toLowerCase().slice(0,5),n!=="data-"&&n!=="aria-");default:return!1}}function _se(n,e,i,a){if(e===null||typeof e>"u"||vse(n,e,i,a))return!0;if(a)return!1;if(i!==null)switch(i.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Zs(n,e,i,a,s,l,d){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=a,this.attributeNamespace=s,this.mustUseProperty=i,this.propertyName=n,this.type=e,this.sanitizeURL=l,this.removeEmptyString=d}var is={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(n){is[n]=new Zs(n,0,!1,n,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(n){var e=n[0];is[e]=new Zs(e,1,!1,n[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(n){is[n]=new Zs(n,2,!1,n.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(n){is[n]=new Zs(n,2,!1,n,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(n){is[n]=new Zs(n,3,!1,n.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(n){is[n]=new Zs(n,3,!0,n,null,!1,!1)});["capture","download"].forEach(function(n){is[n]=new Zs(n,4,!1,n,null,!1,!1)});["cols","rows","size","span"].forEach(function(n){is[n]=new Zs(n,6,!1,n,null,!1,!1)});["rowSpan","start"].forEach(function(n){is[n]=new Zs(n,5,!1,n.toLowerCase(),null,!1,!1)});var ED=/[\-:]([a-z])/g;function MD(n){return n[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(n){var e=n.replace(ED,MD);is[e]=new Zs(e,1,!1,n,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(n){var e=n.replace(ED,MD);is[e]=new Zs(e,1,!1,n,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(n){var e=n.replace(ED,MD);is[e]=new Zs(e,1,!1,n,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(n){is[n]=new Zs(n,1,!1,n.toLowerCase(),null,!1,!1)});is.xlinkHref=new Zs("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(n){is[n]=new Zs(n,1,!1,n.toLowerCase(),null,!0,!0)});function TD(n,e,i,a){var s=is.hasOwnProperty(e)?is[e]:null;(s!==null?s.type!==0:a||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(_se(e,i,s,a)&&(i=null),a||s===null?yse(e)&&(i===null?n.removeAttribute(e):n.setAttribute(e,""+i)):s.mustUseProperty?n[s.propertyName]=i===null?s.type===3?!1:"":i:(e=s.attributeName,a=s.attributeNamespace,i===null?n.removeAttribute(e):(s=s.type,i=s===3||s===4&&i===!0?"":""+i,a?n.setAttributeNS(a,e,i):n.setAttribute(e,i))))}var Xh=Fj.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,l3=Symbol.for("react.element"),w0=Symbol.for("react.portal"),S0=Symbol.for("react.fragment"),AD=Symbol.for("react.strict_mode"),JL=Symbol.for("react.profiler"),Uj=Symbol.for("react.provider"),Wj=Symbol.for("react.context"),CD=Symbol.for("react.forward_ref"),QL=Symbol.for("react.suspense"),ek=Symbol.for("react.suspense_list"),PD=Symbol.for("react.memo"),Kf=Symbol.for("react.lazy"),Vj=Symbol.for("react.offscreen"),X8=Symbol.iterator;function J1(n){return n===null||typeof n!="object"?null:(n=X8&&n[X8]||n["@@iterator"],typeof n=="function"?n:null)}var Na=Object.assign,JI;function Ux(n){if(JI===void 0)try{throw Error()}catch(i){var e=i.stack.trim().match(/\n( *(at )?)/);JI=e&&e[1]||""}return`
`+JI+n}var QI=!1;function eR(n,e){if(!n||QI)return"";QI=!0;var i=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(y){var a=y}Reflect.construct(n,[],e)}else{try{e.call()}catch(y){a=y}n.call(e.prototype)}else{try{throw Error()}catch(y){a=y}n()}}catch(y){if(y&&a&&typeof y.stack=="string"){for(var s=y.stack.split(`
`),l=a.stack.split(`
`),d=s.length-1,f=l.length-1;1<=d&&0<=f&&s[d]!==l[f];)f--;for(;1<=d&&0<=f;d--,f--)if(s[d]!==l[f]){if(d!==1||f!==1)do if(d--,f--,0>f||s[d]!==l[f]){var p=`
`+s[d].replace(" at new "," at ");return n.displayName&&p.includes("<anonymous>")&&(p=p.replace("<anonymous>",n.displayName)),p}while(1<=d&&0<=f);break}}}finally{QI=!1,Error.prepareStackTrace=i}return(n=n?n.displayName||n.name:"")?Ux(n):""}function xse(n){switch(n.tag){case 5:return Ux(n.type);case 16:return Ux("Lazy");case 13:return Ux("Suspense");case 19:return Ux("SuspenseList");case 0:case 2:case 15:return n=eR(n.type,!1),n;case 11:return n=eR(n.type.render,!1),n;case 1:return n=eR(n.type,!0),n;default:return""}}function tk(n){if(n==null)return null;if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case S0:return"Fragment";case w0:return"Portal";case JL:return"Profiler";case AD:return"StrictMode";case QL:return"Suspense";case ek:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case Wj:return(n.displayName||"Context")+".Consumer";case Uj:return(n._context.displayName||"Context")+".Provider";case CD:var e=n.render;return n=n.displayName,n||(n=e.displayName||e.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case PD:return e=n.displayName||null,e!==null?e:tk(n.type)||"Memo";case Kf:e=n._payload,n=n._init;try{return tk(n(e))}catch{}}return null}function bse(n){var e=n.type;switch(n.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return n=e.render,n=n.displayName||n.name||"",e.displayName||(n!==""?"ForwardRef("+n+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return tk(e);case 8:return e===AD?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function wp(n){switch(typeof n){case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function Gj(n){var e=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function wse(n){var e=Gj(n)?"checked":"value",i=Object.getOwnPropertyDescriptor(n.constructor.prototype,e),a=""+n[e];if(!n.hasOwnProperty(e)&&typeof i<"u"&&typeof i.get=="function"&&typeof i.set=="function"){var s=i.get,l=i.set;return Object.defineProperty(n,e,{configurable:!0,get:function(){return s.call(this)},set:function(d){a=""+d,l.call(this,d)}}),Object.defineProperty(n,e,{enumerable:i.enumerable}),{getValue:function(){return a},setValue:function(d){a=""+d},stopTracking:function(){n._valueTracker=null,delete n[e]}}}}function c3(n){n._valueTracker||(n._valueTracker=wse(n))}function Hj(n){if(!n)return!1;var e=n._valueTracker;if(!e)return!0;var i=e.getValue(),a="";return n&&(a=Gj(n)?n.checked?"true":"false":n.value),n=a,n!==i?(e.setValue(n),!0):!1}function RM(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}function nk(n,e){var i=e.checked;return Na({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:i??n._wrapperState.initialChecked})}function Z8(n,e){var i=e.defaultValue==null?"":e.defaultValue,a=e.checked!=null?e.checked:e.defaultChecked;i=wp(e.value!=null?e.value:i),n._wrapperState={initialChecked:a,initialValue:i,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function jj(n,e){e=e.checked,e!=null&&TD(n,"checked",e,!1)}function ik(n,e){jj(n,e);var i=wp(e.value),a=e.type;if(i!=null)a==="number"?(i===0&&n.value===""||n.value!=i)&&(n.value=""+i):n.value!==""+i&&(n.value=""+i);else if(a==="submit"||a==="reset"){n.removeAttribute("value");return}e.hasOwnProperty("value")?rk(n,e.type,i):e.hasOwnProperty("defaultValue")&&rk(n,e.type,wp(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(n.defaultChecked=!!e.defaultChecked)}function K8(n,e,i){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var a=e.type;if(!(a!=="submit"&&a!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+n._wrapperState.initialValue,i||e===n.value||(n.value=e),n.defaultValue=e}i=n.name,i!==""&&(n.name=""),n.defaultChecked=!!n._wrapperState.initialChecked,i!==""&&(n.name=i)}function rk(n,e,i){(e!=="number"||RM(n.ownerDocument)!==n)&&(i==null?n.defaultValue=""+n._wrapperState.initialValue:n.defaultValue!==""+i&&(n.defaultValue=""+i))}var Wx=Array.isArray;function W0(n,e,i,a){if(n=n.options,e){e={};for(var s=0;s<i.length;s++)e["$"+i[s]]=!0;for(i=0;i<n.length;i++)s=e.hasOwnProperty("$"+n[i].value),n[i].selected!==s&&(n[i].selected=s),s&&a&&(n[i].defaultSelected=!0)}else{for(i=""+wp(i),e=null,s=0;s<n.length;s++){if(n[s].value===i){n[s].selected=!0,a&&(n[s].defaultSelected=!0);return}e!==null||n[s].disabled||(e=n[s])}e!==null&&(e.selected=!0)}}function ak(n,e){if(e.dangerouslySetInnerHTML!=null)throw Error(pn(91));return Na({},e,{value:void 0,defaultValue:void 0,children:""+n._wrapperState.initialValue})}function J8(n,e){var i=e.value;if(i==null){if(i=e.children,e=e.defaultValue,i!=null){if(e!=null)throw Error(pn(92));if(Wx(i)){if(1<i.length)throw Error(pn(93));i=i[0]}e=i}e==null&&(e=""),i=e}n._wrapperState={initialValue:wp(i)}}function $j(n,e){var i=wp(e.value),a=wp(e.defaultValue);i!=null&&(i=""+i,i!==n.value&&(n.value=i),e.defaultValue==null&&n.defaultValue!==i&&(n.defaultValue=i)),a!=null&&(n.defaultValue=""+a)}function Q8(n){var e=n.textContent;e===n._wrapperState.initialValue&&e!==""&&e!==null&&(n.value=e)}function Yj(n){switch(n){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ok(n,e){return n==null||n==="http://www.w3.org/1999/xhtml"?Yj(e):n==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":n}var u3,qj=function(n){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,i,a,s){MSApp.execUnsafeLocalFunction(function(){return n(e,i,a,s)})}:n}(function(n,e){if(n.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in n)n.innerHTML=e;else{for(u3=u3||document.createElement("div"),u3.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=u3.firstChild;n.firstChild;)n.removeChild(n.firstChild);for(;e.firstChild;)n.appendChild(e.firstChild)}});function Ob(n,e){if(e){var i=n.firstChild;if(i&&i===n.lastChild&&i.nodeType===3){i.nodeValue=e;return}}n.textContent=e}var tb={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Sse=["Webkit","ms","Moz","O"];Object.keys(tb).forEach(function(n){Sse.forEach(function(e){e=e+n.charAt(0).toUpperCase()+n.substring(1),tb[e]=tb[n]})});function Xj(n,e,i){return e==null||typeof e=="boolean"||e===""?"":i||typeof e!="number"||e===0||tb.hasOwnProperty(n)&&tb[n]?(""+e).trim():e+"px"}function Zj(n,e){n=n.style;for(var i in e)if(e.hasOwnProperty(i)){var a=i.indexOf("--")===0,s=Xj(i,e[i],a);i==="float"&&(i="cssFloat"),a?n.setProperty(i,s):n[i]=s}}var Ese=Na({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function sk(n,e){if(e){if(Ese[n]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(pn(137,n));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(pn(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(pn(61))}if(e.style!=null&&typeof e.style!="object")throw Error(pn(62))}}function lk(n,e){if(n.indexOf("-")===-1)return typeof e.is=="string";switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ck=null;function ID(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var uk=null,V0=null,G0=null;function eW(n){if(n=Ww(n)){if(typeof uk!="function")throw Error(pn(280));var e=n.stateNode;e&&(e=OT(e),uk(n.stateNode,n.type,e))}}function Kj(n){V0?G0?G0.push(n):G0=[n]:V0=n}function Jj(){if(V0){var n=V0,e=G0;if(G0=V0=null,eW(n),e)for(n=0;n<e.length;n++)eW(e[n])}}function Qj(n,e){return n(e)}function e$(){}var tR=!1;function t$(n,e,i){if(tR)return n(e,i);tR=!0;try{return Qj(n,e,i)}finally{tR=!1,(V0!==null||G0!==null)&&(e$(),Jj())}}function Nb(n,e){var i=n.stateNode;if(i===null)return null;var a=OT(i);if(a===null)return null;i=a[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(a=!a.disabled)||(n=n.type,a=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!a;break e;default:n=!1}if(n)return null;if(i&&typeof i!="function")throw Error(pn(231,e,typeof i));return i}var dk=!1;if(Vh)try{var Q1={};Object.defineProperty(Q1,"passive",{get:function(){dk=!0}}),window.addEventListener("test",Q1,Q1),window.removeEventListener("test",Q1,Q1)}catch{dk=!1}function Mse(n,e,i,a,s,l,d,f,p){var y=Array.prototype.slice.call(arguments,3);try{e.apply(i,y)}catch(_){this.onError(_)}}var nb=!1,LM=null,kM=!1,hk=null,Tse={onError:function(n){nb=!0,LM=n}};function Ase(n,e,i,a,s,l,d,f,p){nb=!1,LM=null,Mse.apply(Tse,arguments)}function Cse(n,e,i,a,s,l,d,f,p){if(Ase.apply(this,arguments),nb){if(nb){var y=LM;nb=!1,LM=null}else throw Error(pn(198));kM||(kM=!0,hk=y)}}function ey(n){var e=n,i=n;if(n.alternate)for(;e.return;)e=e.return;else{n=e;do e=n,e.flags&4098&&(i=e.return),n=e.return;while(n)}return e.tag===3?i:null}function n$(n){if(n.tag===13){var e=n.memoizedState;if(e===null&&(n=n.alternate,n!==null&&(e=n.memoizedState)),e!==null)return e.dehydrated}return null}function tW(n){if(ey(n)!==n)throw Error(pn(188))}function Pse(n){var e=n.alternate;if(!e){if(e=ey(n),e===null)throw Error(pn(188));return e!==n?null:n}for(var i=n,a=e;;){var s=i.return;if(s===null)break;var l=s.alternate;if(l===null){if(a=s.return,a!==null){i=a;continue}break}if(s.child===l.child){for(l=s.child;l;){if(l===i)return tW(s),n;if(l===a)return tW(s),e;l=l.sibling}throw Error(pn(188))}if(i.return!==a.return)i=s,a=l;else{for(var d=!1,f=s.child;f;){if(f===i){d=!0,i=s,a=l;break}if(f===a){d=!0,a=s,i=l;break}f=f.sibling}if(!d){for(f=l.child;f;){if(f===i){d=!0,i=l,a=s;break}if(f===a){d=!0,a=l,i=s;break}f=f.sibling}if(!d)throw Error(pn(189))}}if(i.alternate!==a)throw Error(pn(190))}if(i.tag!==3)throw Error(pn(188));return i.stateNode.current===i?n:e}function i$(n){return n=Pse(n),n!==null?r$(n):null}function r$(n){if(n.tag===5||n.tag===6)return n;for(n=n.child;n!==null;){var e=r$(n);if(e!==null)return e;n=n.sibling}return null}var a$=nc.unstable_scheduleCallback,nW=nc.unstable_cancelCallback,Ise=nc.unstable_shouldYield,Rse=nc.unstable_requestPaint,uo=nc.unstable_now,Lse=nc.unstable_getCurrentPriorityLevel,RD=nc.unstable_ImmediatePriority,o$=nc.unstable_UserBlockingPriority,DM=nc.unstable_NormalPriority,kse=nc.unstable_LowPriority,s$=nc.unstable_IdlePriority,LT=null,yd=null;function Dse(n){if(yd&&typeof yd.onCommitFiberRoot=="function")try{yd.onCommitFiberRoot(LT,n,void 0,(n.current.flags&128)===128)}catch{}}var yu=Math.clz32?Math.clz32:Nse,zse=Math.log,Ose=Math.LN2;function Nse(n){return n>>>=0,n===0?32:31-(zse(n)/Ose|0)|0}var d3=64,h3=4194304;function Vx(n){switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return n&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return n}}function zM(n,e){var i=n.pendingLanes;if(i===0)return 0;var a=0,s=n.suspendedLanes,l=n.pingedLanes,d=i&268435455;if(d!==0){var f=d&~s;f!==0?a=Vx(f):(l&=d,l!==0&&(a=Vx(l)))}else d=i&~s,d!==0?a=Vx(d):l!==0&&(a=Vx(l));if(a===0)return 0;if(e!==0&&e!==a&&!(e&s)&&(s=a&-a,l=e&-e,s>=l||s===16&&(l&4194240)!==0))return e;if(a&4&&(a|=i&16),e=n.entangledLanes,e!==0)for(n=n.entanglements,e&=a;0<e;)i=31-yu(e),s=1<<i,a|=n[i],e&=~s;return a}function Fse(n,e){switch(n){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Bse(n,e){for(var i=n.suspendedLanes,a=n.pingedLanes,s=n.expirationTimes,l=n.pendingLanes;0<l;){var d=31-yu(l),f=1<<d,p=s[d];p===-1?(!(f&i)||f&a)&&(s[d]=Fse(f,e)):p<=e&&(n.expiredLanes|=f),l&=~f}}function fk(n){return n=n.pendingLanes&-1073741825,n!==0?n:n&1073741824?1073741824:0}function l$(){var n=d3;return d3<<=1,!(d3&4194240)&&(d3=64),n}function nR(n){for(var e=[],i=0;31>i;i++)e.push(n);return e}function Bw(n,e,i){n.pendingLanes|=e,e!==536870912&&(n.suspendedLanes=0,n.pingedLanes=0),n=n.eventTimes,e=31-yu(e),n[e]=i}function Use(n,e){var i=n.pendingLanes&~e;n.pendingLanes=e,n.suspendedLanes=0,n.pingedLanes=0,n.expiredLanes&=e,n.mutableReadLanes&=e,n.entangledLanes&=e,e=n.entanglements;var a=n.eventTimes;for(n=n.expirationTimes;0<i;){var s=31-yu(i),l=1<<s;e[s]=0,a[s]=-1,n[s]=-1,i&=~l}}function LD(n,e){var i=n.entangledLanes|=e;for(n=n.entanglements;i;){var a=31-yu(i),s=1<<a;s&e|n[a]&e&&(n[a]|=e),i&=~s}}var Hr=0;function c$(n){return n&=-n,1<n?4<n?n&268435455?16:536870912:4:1}var u$,kD,d$,h$,f$,pk=!1,f3=[],cp=null,up=null,dp=null,Fb=new Map,Bb=new Map,Qf=[],Wse="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function iW(n,e){switch(n){case"focusin":case"focusout":cp=null;break;case"dragenter":case"dragleave":up=null;break;case"mouseover":case"mouseout":dp=null;break;case"pointerover":case"pointerout":Fb.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Bb.delete(e.pointerId)}}function ex(n,e,i,a,s,l){return n===null||n.nativeEvent!==l?(n={blockedOn:e,domEventName:i,eventSystemFlags:a,nativeEvent:l,targetContainers:[s]},e!==null&&(e=Ww(e),e!==null&&kD(e)),n):(n.eventSystemFlags|=a,e=n.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),n)}function Vse(n,e,i,a,s){switch(e){case"focusin":return cp=ex(cp,n,e,i,a,s),!0;case"dragenter":return up=ex(up,n,e,i,a,s),!0;case"mouseover":return dp=ex(dp,n,e,i,a,s),!0;case"pointerover":var l=s.pointerId;return Fb.set(l,ex(Fb.get(l)||null,n,e,i,a,s)),!0;case"gotpointercapture":return l=s.pointerId,Bb.set(l,ex(Bb.get(l)||null,n,e,i,a,s)),!0}return!1}function p$(n){var e=pg(n.target);if(e!==null){var i=ey(e);if(i!==null){if(e=i.tag,e===13){if(e=n$(i),e!==null){n.blockedOn=e,f$(n.priority,function(){d$(i)});return}}else if(e===3&&i.stateNode.current.memoizedState.isDehydrated){n.blockedOn=i.tag===3?i.stateNode.containerInfo:null;return}}}n.blockedOn=null}function ZE(n){if(n.blockedOn!==null)return!1;for(var e=n.targetContainers;0<e.length;){var i=mk(n.domEventName,n.eventSystemFlags,e[0],n.nativeEvent);if(i===null){i=n.nativeEvent;var a=new i.constructor(i.type,i);ck=a,i.target.dispatchEvent(a),ck=null}else return e=Ww(i),e!==null&&kD(e),n.blockedOn=i,!1;e.shift()}return!0}function rW(n,e,i){ZE(n)&&i.delete(e)}function Gse(){pk=!1,cp!==null&&ZE(cp)&&(cp=null),up!==null&&ZE(up)&&(up=null),dp!==null&&ZE(dp)&&(dp=null),Fb.forEach(rW),Bb.forEach(rW)}function tx(n,e){n.blockedOn===e&&(n.blockedOn=null,pk||(pk=!0,nc.unstable_scheduleCallback(nc.unstable_NormalPriority,Gse)))}function Ub(n){function e(s){return tx(s,n)}if(0<f3.length){tx(f3[0],n);for(var i=1;i<f3.length;i++){var a=f3[i];a.blockedOn===n&&(a.blockedOn=null)}}for(cp!==null&&tx(cp,n),up!==null&&tx(up,n),dp!==null&&tx(dp,n),Fb.forEach(e),Bb.forEach(e),i=0;i<Qf.length;i++)a=Qf[i],a.blockedOn===n&&(a.blockedOn=null);for(;0<Qf.length&&(i=Qf[0],i.blockedOn===null);)p$(i),i.blockedOn===null&&Qf.shift()}var H0=Xh.ReactCurrentBatchConfig,OM=!0;function Hse(n,e,i,a){var s=Hr,l=H0.transition;H0.transition=null;try{Hr=1,DD(n,e,i,a)}finally{Hr=s,H0.transition=l}}function jse(n,e,i,a){var s=Hr,l=H0.transition;H0.transition=null;try{Hr=4,DD(n,e,i,a)}finally{Hr=s,H0.transition=l}}function DD(n,e,i,a){if(OM){var s=mk(n,e,i,a);if(s===null)hR(n,e,a,NM,i),iW(n,a);else if(Vse(s,n,e,i,a))a.stopPropagation();else if(iW(n,a),e&4&&-1<Wse.indexOf(n)){for(;s!==null;){var l=Ww(s);if(l!==null&&u$(l),l=mk(n,e,i,a),l===null&&hR(n,e,a,NM,i),l===s)break;s=l}s!==null&&a.stopPropagation()}else hR(n,e,a,null,i)}}var NM=null;function mk(n,e,i,a){if(NM=null,n=ID(a),n=pg(n),n!==null)if(e=ey(n),e===null)n=null;else if(i=e.tag,i===13){if(n=n$(e),n!==null)return n;n=null}else if(i===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;n=null}else e!==n&&(n=null);return NM=n,null}function m$(n){switch(n){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Lse()){case RD:return 1;case o$:return 4;case DM:case kse:return 16;case s$:return 536870912;default:return 16}default:return 16}}var np=null,zD=null,KE=null;function g$(){if(KE)return KE;var n,e=zD,i=e.length,a,s="value"in np?np.value:np.textContent,l=s.length;for(n=0;n<i&&e[n]===s[n];n++);var d=i-n;for(a=1;a<=d&&e[i-a]===s[l-a];a++);return KE=s.slice(n,1<a?1-a:void 0)}function JE(n){var e=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&e===13&&(n=13)):n=e,n===10&&(n=13),32<=n||n===13?n:0}function p3(){return!0}function aW(){return!1}function ac(n){function e(i,a,s,l,d){this._reactName=i,this._targetInst=s,this.type=a,this.nativeEvent=l,this.target=d,this.currentTarget=null;for(var f in n)n.hasOwnProperty(f)&&(i=n[f],this[f]=i?i(l):l[f]);return this.isDefaultPrevented=(l.defaultPrevented!=null?l.defaultPrevented:l.returnValue===!1)?p3:aW,this.isPropagationStopped=aW,this}return Na(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var i=this.nativeEvent;i&&(i.preventDefault?i.preventDefault():typeof i.returnValue!="unknown"&&(i.returnValue=!1),this.isDefaultPrevented=p3)},stopPropagation:function(){var i=this.nativeEvent;i&&(i.stopPropagation?i.stopPropagation():typeof i.cancelBubble!="unknown"&&(i.cancelBubble=!0),this.isPropagationStopped=p3)},persist:function(){},isPersistent:p3}),e}var A_={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},OD=ac(A_),Uw=Na({},A_,{view:0,detail:0}),$se=ac(Uw),iR,rR,nx,kT=Na({},Uw,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ND,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==nx&&(nx&&n.type==="mousemove"?(iR=n.screenX-nx.screenX,rR=n.screenY-nx.screenY):rR=iR=0,nx=n),iR)},movementY:function(n){return"movementY"in n?n.movementY:rR}}),oW=ac(kT),Yse=Na({},kT,{dataTransfer:0}),qse=ac(Yse),Xse=Na({},Uw,{relatedTarget:0}),aR=ac(Xse),Zse=Na({},A_,{animationName:0,elapsedTime:0,pseudoElement:0}),Kse=ac(Zse),Jse=Na({},A_,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),Qse=ac(Jse),ele=Na({},A_,{data:0}),sW=ac(ele),tle={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},nle={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ile={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function rle(n){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(n):(n=ile[n])?!!e[n]:!1}function ND(){return rle}var ale=Na({},Uw,{key:function(n){if(n.key){var e=tle[n.key]||n.key;if(e!=="Unidentified")return e}return n.type==="keypress"?(n=JE(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?nle[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ND,charCode:function(n){return n.type==="keypress"?JE(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?JE(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),ole=ac(ale),sle=Na({},kT,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),lW=ac(sle),lle=Na({},Uw,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ND}),cle=ac(lle),ule=Na({},A_,{propertyName:0,elapsedTime:0,pseudoElement:0}),dle=ac(ule),hle=Na({},kT,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),fle=ac(hle),ple=[9,13,27,32],FD=Vh&&"CompositionEvent"in window,ib=null;Vh&&"documentMode"in document&&(ib=document.documentMode);var mle=Vh&&"TextEvent"in window&&!ib,y$=Vh&&(!FD||ib&&8<ib&&11>=ib),cW=String.fromCharCode(32),uW=!1;function v$(n,e){switch(n){case"keyup":return ple.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function _$(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var E0=!1;function gle(n,e){switch(n){case"compositionend":return _$(e);case"keypress":return e.which!==32?null:(uW=!0,cW);case"textInput":return n=e.data,n===cW&&uW?null:n;default:return null}}function yle(n,e){if(E0)return n==="compositionend"||!FD&&v$(n,e)?(n=g$(),KE=zD=np=null,E0=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return y$&&e.locale!=="ko"?null:e.data;default:return null}}var vle={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function dW(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e==="input"?!!vle[n.type]:e==="textarea"}function x$(n,e,i,a){Kj(a),e=FM(e,"onChange"),0<e.length&&(i=new OD("onChange","change",null,i,a),n.push({event:i,listeners:e}))}var rb=null,Wb=null;function _le(n){R$(n,0)}function DT(n){var e=A0(n);if(Hj(e))return n}function xle(n,e){if(n==="change")return e}var b$=!1;if(Vh){var oR;if(Vh){var sR="oninput"in document;if(!sR){var hW=document.createElement("div");hW.setAttribute("oninput","return;"),sR=typeof hW.oninput=="function"}oR=sR}else oR=!1;b$=oR&&(!document.documentMode||9<document.documentMode)}function fW(){rb&&(rb.detachEvent("onpropertychange",w$),Wb=rb=null)}function w$(n){if(n.propertyName==="value"&&DT(Wb)){var e=[];x$(e,Wb,n,ID(n)),t$(_le,e)}}function ble(n,e,i){n==="focusin"?(fW(),rb=e,Wb=i,rb.attachEvent("onpropertychange",w$)):n==="focusout"&&fW()}function wle(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return DT(Wb)}function Sle(n,e){if(n==="click")return DT(e)}function Ele(n,e){if(n==="input"||n==="change")return DT(e)}function Mle(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var xu=typeof Object.is=="function"?Object.is:Mle;function Vb(n,e){if(xu(n,e))return!0;if(typeof n!="object"||n===null||typeof e!="object"||e===null)return!1;var i=Object.keys(n),a=Object.keys(e);if(i.length!==a.length)return!1;for(a=0;a<i.length;a++){var s=i[a];if(!KL.call(e,s)||!xu(n[s],e[s]))return!1}return!0}function pW(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function mW(n,e){var i=pW(n);n=0;for(var a;i;){if(i.nodeType===3){if(a=n+i.textContent.length,n<=e&&a>=e)return{node:i,offset:e-n};n=a}e:{for(;i;){if(i.nextSibling){i=i.nextSibling;break e}i=i.parentNode}i=void 0}i=pW(i)}}function S$(n,e){return n&&e?n===e?!0:n&&n.nodeType===3?!1:e&&e.nodeType===3?S$(n,e.parentNode):"contains"in n?n.contains(e):n.compareDocumentPosition?!!(n.compareDocumentPosition(e)&16):!1:!1}function E$(){for(var n=window,e=RM();e instanceof n.HTMLIFrameElement;){try{var i=typeof e.contentWindow.location.href=="string"}catch{i=!1}if(i)n=e.contentWindow;else break;e=RM(n.document)}return e}function BD(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e&&(e==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||e==="textarea"||n.contentEditable==="true")}function Tle(n){var e=E$(),i=n.focusedElem,a=n.selectionRange;if(e!==i&&i&&i.ownerDocument&&S$(i.ownerDocument.documentElement,i)){if(a!==null&&BD(i)){if(e=a.start,n=a.end,n===void 0&&(n=e),"selectionStart"in i)i.selectionStart=e,i.selectionEnd=Math.min(n,i.value.length);else if(n=(e=i.ownerDocument||document)&&e.defaultView||window,n.getSelection){n=n.getSelection();var s=i.textContent.length,l=Math.min(a.start,s);a=a.end===void 0?l:Math.min(a.end,s),!n.extend&&l>a&&(s=a,a=l,l=s),s=mW(i,l);var d=mW(i,a);s&&d&&(n.rangeCount!==1||n.anchorNode!==s.node||n.anchorOffset!==s.offset||n.focusNode!==d.node||n.focusOffset!==d.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),n.removeAllRanges(),l>a?(n.addRange(e),n.extend(d.node,d.offset)):(e.setEnd(d.node,d.offset),n.addRange(e)))}}for(e=[],n=i;n=n.parentNode;)n.nodeType===1&&e.push({element:n,left:n.scrollLeft,top:n.scrollTop});for(typeof i.focus=="function"&&i.focus(),i=0;i<e.length;i++)n=e[i],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}var Ale=Vh&&"documentMode"in document&&11>=document.documentMode,M0=null,gk=null,ab=null,yk=!1;function gW(n,e,i){var a=i.window===i?i.document:i.nodeType===9?i:i.ownerDocument;yk||M0==null||M0!==RM(a)||(a=M0,"selectionStart"in a&&BD(a)?a={start:a.selectionStart,end:a.selectionEnd}:(a=(a.ownerDocument&&a.ownerDocument.defaultView||window).getSelection(),a={anchorNode:a.anchorNode,anchorOffset:a.anchorOffset,focusNode:a.focusNode,focusOffset:a.focusOffset}),ab&&Vb(ab,a)||(ab=a,a=FM(gk,"onSelect"),0<a.length&&(e=new OD("onSelect","select",null,e,i),n.push({event:e,listeners:a}),e.target=M0)))}function m3(n,e){var i={};return i[n.toLowerCase()]=e.toLowerCase(),i["Webkit"+n]="webkit"+e,i["Moz"+n]="moz"+e,i}var T0={animationend:m3("Animation","AnimationEnd"),animationiteration:m3("Animation","AnimationIteration"),animationstart:m3("Animation","AnimationStart"),transitionend:m3("Transition","TransitionEnd")},lR={},M$={};Vh&&(M$=document.createElement("div").style,"AnimationEvent"in window||(delete T0.animationend.animation,delete T0.animationiteration.animation,delete T0.animationstart.animation),"TransitionEvent"in window||delete T0.transitionend.transition);function zT(n){if(lR[n])return lR[n];if(!T0[n])return n;var e=T0[n],i;for(i in e)if(e.hasOwnProperty(i)&&i in M$)return lR[n]=e[i];return n}var T$=zT("animationend"),A$=zT("animationiteration"),C$=zT("animationstart"),P$=zT("transitionend"),I$=new Map,yW="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Lp(n,e){I$.set(n,e),Qg(e,[n])}for(var cR=0;cR<yW.length;cR++){var uR=yW[cR],Cle=uR.toLowerCase(),Ple=uR[0].toUpperCase()+uR.slice(1);Lp(Cle,"on"+Ple)}Lp(T$,"onAnimationEnd");Lp(A$,"onAnimationIteration");Lp(C$,"onAnimationStart");Lp("dblclick","onDoubleClick");Lp("focusin","onFocus");Lp("focusout","onBlur");Lp(P$,"onTransitionEnd");t_("onMouseEnter",["mouseout","mouseover"]);t_("onMouseLeave",["mouseout","mouseover"]);t_("onPointerEnter",["pointerout","pointerover"]);t_("onPointerLeave",["pointerout","pointerover"]);Qg("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Qg("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Qg("onBeforeInput",["compositionend","keypress","textInput","paste"]);Qg("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Qg("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Qg("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Gx="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Ile=new Set("cancel close invalid load scroll toggle".split(" ").concat(Gx));function vW(n,e,i){var a=n.type||"unknown-event";n.currentTarget=i,Cse(a,e,void 0,n),n.currentTarget=null}function R$(n,e){e=(e&4)!==0;for(var i=0;i<n.length;i++){var a=n[i],s=a.event;a=a.listeners;e:{var l=void 0;if(e)for(var d=a.length-1;0<=d;d--){var f=a[d],p=f.instance,y=f.currentTarget;if(f=f.listener,p!==l&&s.isPropagationStopped())break e;vW(s,f,y),l=p}else for(d=0;d<a.length;d++){if(f=a[d],p=f.instance,y=f.currentTarget,f=f.listener,p!==l&&s.isPropagationStopped())break e;vW(s,f,y),l=p}}}if(kM)throw n=hk,kM=!1,hk=null,n}function ua(n,e){var i=e[wk];i===void 0&&(i=e[wk]=new Set);var a=n+"__bubble";i.has(a)||(L$(e,n,2,!1),i.add(a))}function dR(n,e,i){var a=0;e&&(a|=4),L$(i,n,a,e)}var g3="_reactListening"+Math.random().toString(36).slice(2);function Gb(n){if(!n[g3]){n[g3]=!0,Bj.forEach(function(i){i!=="selectionchange"&&(Ile.has(i)||dR(i,!1,n),dR(i,!0,n))});var e=n.nodeType===9?n:n.ownerDocument;e===null||e[g3]||(e[g3]=!0,dR("selectionchange",!1,e))}}function L$(n,e,i,a){switch(m$(e)){case 1:var s=Hse;break;case 4:s=jse;break;default:s=DD}i=s.bind(null,e,i,n),s=void 0,!dk||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),a?s!==void 0?n.addEventListener(e,i,{capture:!0,passive:s}):n.addEventListener(e,i,!0):s!==void 0?n.addEventListener(e,i,{passive:s}):n.addEventListener(e,i,!1)}function hR(n,e,i,a,s){var l=a;if(!(e&1)&&!(e&2)&&a!==null)e:for(;;){if(a===null)return;var d=a.tag;if(d===3||d===4){var f=a.stateNode.containerInfo;if(f===s||f.nodeType===8&&f.parentNode===s)break;if(d===4)for(d=a.return;d!==null;){var p=d.tag;if((p===3||p===4)&&(p=d.stateNode.containerInfo,p===s||p.nodeType===8&&p.parentNode===s))return;d=d.return}for(;f!==null;){if(d=pg(f),d===null)return;if(p=d.tag,p===5||p===6){a=l=d;continue e}f=f.parentNode}}a=a.return}t$(function(){var y=l,_=ID(i),b=[];e:{var S=I$.get(n);if(S!==void 0){var A=OD,P=n;switch(n){case"keypress":if(JE(i)===0)break e;case"keydown":case"keyup":A=ole;break;case"focusin":P="focus",A=aR;break;case"focusout":P="blur",A=aR;break;case"beforeblur":case"afterblur":A=aR;break;case"click":if(i.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":A=oW;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":A=qse;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":A=cle;break;case T$:case A$:case C$:A=Kse;break;case P$:A=dle;break;case"scroll":A=$se;break;case"wheel":A=fle;break;case"copy":case"cut":case"paste":A=Qse;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":A=lW}var L=(e&4)!==0,k=!L&&n==="scroll",R=L?S!==null?S+"Capture":null:S;L=[];for(var z=y,O;z!==null;){O=z;var F=O.stateNode;if(O.tag===5&&F!==null&&(O=F,R!==null&&(F=Nb(z,R),F!=null&&L.push(Hb(z,F,O)))),k)break;z=z.return}0<L.length&&(S=new A(S,P,null,i,_),b.push({event:S,listeners:L}))}}if(!(e&7)){e:{if(S=n==="mouseover"||n==="pointerover",A=n==="mouseout"||n==="pointerout",S&&i!==ck&&(P=i.relatedTarget||i.fromElement)&&(pg(P)||P[Gh]))break e;if((A||S)&&(S=_.window===_?_:(S=_.ownerDocument)?S.defaultView||S.parentWindow:window,A?(P=i.relatedTarget||i.toElement,A=y,P=P?pg(P):null,P!==null&&(k=ey(P),P!==k||P.tag!==5&&P.tag!==6)&&(P=null)):(A=null,P=y),A!==P)){if(L=oW,F="onMouseLeave",R="onMouseEnter",z="mouse",(n==="pointerout"||n==="pointerover")&&(L=lW,F="onPointerLeave",R="onPointerEnter",z="pointer"),k=A==null?S:A0(A),O=P==null?S:A0(P),S=new L(F,z+"leave",A,i,_),S.target=k,S.relatedTarget=O,F=null,pg(_)===y&&(L=new L(R,z+"enter",P,i,_),L.target=O,L.relatedTarget=k,F=L),k=F,A&&P)t:{for(L=A,R=P,z=0,O=L;O;O=Ov(O))z++;for(O=0,F=R;F;F=Ov(F))O++;for(;0<z-O;)L=Ov(L),z--;for(;0<O-z;)R=Ov(R),O--;for(;z--;){if(L===R||R!==null&&L===R.alternate)break t;L=Ov(L),R=Ov(R)}L=null}else L=null;A!==null&&_W(b,S,A,L,!1),P!==null&&k!==null&&_W(b,k,P,L,!0)}}e:{if(S=y?A0(y):window,A=S.nodeName&&S.nodeName.toLowerCase(),A==="select"||A==="input"&&S.type==="file")var H=xle;else if(dW(S))if(b$)H=Ele;else{H=wle;var $=ble}else(A=S.nodeName)&&A.toLowerCase()==="input"&&(S.type==="checkbox"||S.type==="radio")&&(H=Sle);if(H&&(H=H(n,y))){x$(b,H,i,_);break e}$&&$(n,S,y),n==="focusout"&&($=S._wrapperState)&&$.controlled&&S.type==="number"&&rk(S,"number",S.value)}switch($=y?A0(y):window,n){case"focusin":(dW($)||$.contentEditable==="true")&&(M0=$,gk=y,ab=null);break;case"focusout":ab=gk=M0=null;break;case"mousedown":yk=!0;break;case"contextmenu":case"mouseup":case"dragend":yk=!1,gW(b,i,_);break;case"selectionchange":if(Ale)break;case"keydown":case"keyup":gW(b,i,_)}var Y;if(FD)e:{switch(n){case"compositionstart":var te="onCompositionStart";break e;case"compositionend":te="onCompositionEnd";break e;case"compositionupdate":te="onCompositionUpdate";break e}te=void 0}else E0?v$(n,i)&&(te="onCompositionEnd"):n==="keydown"&&i.keyCode===229&&(te="onCompositionStart");te&&(y$&&i.locale!=="ko"&&(E0||te!=="onCompositionStart"?te==="onCompositionEnd"&&E0&&(Y=g$()):(np=_,zD="value"in np?np.value:np.textContent,E0=!0)),$=FM(y,te),0<$.length&&(te=new sW(te,n,null,i,_),b.push({event:te,listeners:$}),Y?te.data=Y:(Y=_$(i),Y!==null&&(te.data=Y)))),(Y=mle?gle(n,i):yle(n,i))&&(y=FM(y,"onBeforeInput"),0<y.length&&(_=new sW("onBeforeInput","beforeinput",null,i,_),b.push({event:_,listeners:y}),_.data=Y))}R$(b,e)})}function Hb(n,e,i){return{instance:n,listener:e,currentTarget:i}}function FM(n,e){for(var i=e+"Capture",a=[];n!==null;){var s=n,l=s.stateNode;s.tag===5&&l!==null&&(s=l,l=Nb(n,i),l!=null&&a.unshift(Hb(n,l,s)),l=Nb(n,e),l!=null&&a.push(Hb(n,l,s))),n=n.return}return a}function Ov(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5);return n||null}function _W(n,e,i,a,s){for(var l=e._reactName,d=[];i!==null&&i!==a;){var f=i,p=f.alternate,y=f.stateNode;if(p!==null&&p===a)break;f.tag===5&&y!==null&&(f=y,s?(p=Nb(i,l),p!=null&&d.unshift(Hb(i,p,f))):s||(p=Nb(i,l),p!=null&&d.push(Hb(i,p,f)))),i=i.return}d.length!==0&&n.push({event:e,listeners:d})}var Rle=/\r\n?/g,Lle=/\u0000|\uFFFD/g;function xW(n){return(typeof n=="string"?n:""+n).replace(Rle,`
`).replace(Lle,"")}function y3(n,e,i){if(e=xW(e),xW(n)!==e&&i)throw Error(pn(425))}function BM(){}var vk=null,_k=null;function xk(n,e){return n==="textarea"||n==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var bk=typeof setTimeout=="function"?setTimeout:void 0,kle=typeof clearTimeout=="function"?clearTimeout:void 0,bW=typeof Promise=="function"?Promise:void 0,Dle=typeof queueMicrotask=="function"?queueMicrotask:typeof bW<"u"?function(n){return bW.resolve(null).then(n).catch(zle)}:bk;function zle(n){setTimeout(function(){throw n})}function fR(n,e){var i=e,a=0;do{var s=i.nextSibling;if(n.removeChild(i),s&&s.nodeType===8)if(i=s.data,i==="/$"){if(a===0){n.removeChild(s),Ub(e);return}a--}else i!=="$"&&i!=="$?"&&i!=="$!"||a++;i=s}while(i);Ub(e)}function hp(n){for(;n!=null;n=n.nextSibling){var e=n.nodeType;if(e===1||e===3)break;if(e===8){if(e=n.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return n}function wW(n){n=n.previousSibling;for(var e=0;n;){if(n.nodeType===8){var i=n.data;if(i==="$"||i==="$!"||i==="$?"){if(e===0)return n;e--}else i==="/$"&&e++}n=n.previousSibling}return null}var C_=Math.random().toString(36).slice(2),hd="__reactFiber$"+C_,jb="__reactProps$"+C_,Gh="__reactContainer$"+C_,wk="__reactEvents$"+C_,Ole="__reactListeners$"+C_,Nle="__reactHandles$"+C_;function pg(n){var e=n[hd];if(e)return e;for(var i=n.parentNode;i;){if(e=i[Gh]||i[hd]){if(i=e.alternate,e.child!==null||i!==null&&i.child!==null)for(n=wW(n);n!==null;){if(i=n[hd])return i;n=wW(n)}return e}n=i,i=n.parentNode}return null}function Ww(n){return n=n[hd]||n[Gh],!n||n.tag!==5&&n.tag!==6&&n.tag!==13&&n.tag!==3?null:n}function A0(n){if(n.tag===5||n.tag===6)return n.stateNode;throw Error(pn(33))}function OT(n){return n[jb]||null}var Sk=[],C0=-1;function kp(n){return{current:n}}function fa(n){0>C0||(n.current=Sk[C0],Sk[C0]=null,C0--)}function oa(n,e){C0++,Sk[C0]=n.current,n.current=e}var Sp={},Cs=kp(Sp),wl=kp(!1),Og=Sp;function n_(n,e){var i=n.type.contextTypes;if(!i)return Sp;var a=n.stateNode;if(a&&a.__reactInternalMemoizedUnmaskedChildContext===e)return a.__reactInternalMemoizedMaskedChildContext;var s={},l;for(l in i)s[l]=e[l];return a&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=e,n.__reactInternalMemoizedMaskedChildContext=s),s}function Sl(n){return n=n.childContextTypes,n!=null}function UM(){fa(wl),fa(Cs)}function SW(n,e,i){if(Cs.current!==Sp)throw Error(pn(168));oa(Cs,e),oa(wl,i)}function k$(n,e,i){var a=n.stateNode;if(e=e.childContextTypes,typeof a.getChildContext!="function")return i;a=a.getChildContext();for(var s in a)if(!(s in e))throw Error(pn(108,bse(n)||"Unknown",s));return Na({},i,a)}function WM(n){return n=(n=n.stateNode)&&n.__reactInternalMemoizedMergedChildContext||Sp,Og=Cs.current,oa(Cs,n),oa(wl,wl.current),!0}function EW(n,e,i){var a=n.stateNode;if(!a)throw Error(pn(169));i?(n=k$(n,e,Og),a.__reactInternalMemoizedMergedChildContext=n,fa(wl),fa(Cs),oa(Cs,n)):fa(wl),oa(wl,i)}var Ch=null,NT=!1,pR=!1;function D$(n){Ch===null?Ch=[n]:Ch.push(n)}function Fle(n){NT=!0,D$(n)}function Dp(){if(!pR&&Ch!==null){pR=!0;var n=0,e=Hr;try{var i=Ch;for(Hr=1;n<i.length;n++){var a=i[n];do a=a(!0);while(a!==null)}Ch=null,NT=!1}catch(s){throw Ch!==null&&(Ch=Ch.slice(n+1)),a$(RD,Dp),s}finally{Hr=e,pR=!1}}return null}var P0=[],I0=0,VM=null,GM=0,Ac=[],Cc=0,Ng=null,kh=1,Dh="";function ig(n,e){P0[I0++]=GM,P0[I0++]=VM,VM=n,GM=e}function z$(n,e,i){Ac[Cc++]=kh,Ac[Cc++]=Dh,Ac[Cc++]=Ng,Ng=n;var a=kh;n=Dh;var s=32-yu(a)-1;a&=~(1<<s),i+=1;var l=32-yu(e)+s;if(30<l){var d=s-s%5;l=(a&(1<<d)-1).toString(32),a>>=d,s-=d,kh=1<<32-yu(e)+s|i<<s|a,Dh=l+n}else kh=1<<l|i<<s|a,Dh=n}function UD(n){n.return!==null&&(ig(n,1),z$(n,1,0))}function WD(n){for(;n===VM;)VM=P0[--I0],P0[I0]=null,GM=P0[--I0],P0[I0]=null;for(;n===Ng;)Ng=Ac[--Cc],Ac[Cc]=null,Dh=Ac[--Cc],Ac[Cc]=null,kh=Ac[--Cc],Ac[Cc]=null}var Ql=null,Jl=null,wa=!1,fu=null;function O$(n,e){var i=Pc(5,null,null,0);i.elementType="DELETED",i.stateNode=e,i.return=n,e=n.deletions,e===null?(n.deletions=[i],n.flags|=16):e.push(i)}function MW(n,e){switch(n.tag){case 5:var i=n.type;return e=e.nodeType!==1||i.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(n.stateNode=e,Ql=n,Jl=hp(e.firstChild),!0):!1;case 6:return e=n.pendingProps===""||e.nodeType!==3?null:e,e!==null?(n.stateNode=e,Ql=n,Jl=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(i=Ng!==null?{id:kh,overflow:Dh}:null,n.memoizedState={dehydrated:e,treeContext:i,retryLane:1073741824},i=Pc(18,null,null,0),i.stateNode=e,i.return=n,n.child=i,Ql=n,Jl=null,!0):!1;default:return!1}}function Ek(n){return(n.mode&1)!==0&&(n.flags&128)===0}function Mk(n){if(wa){var e=Jl;if(e){var i=e;if(!MW(n,e)){if(Ek(n))throw Error(pn(418));e=hp(i.nextSibling);var a=Ql;e&&MW(n,e)?O$(a,i):(n.flags=n.flags&-4097|2,wa=!1,Ql=n)}}else{if(Ek(n))throw Error(pn(418));n.flags=n.flags&-4097|2,wa=!1,Ql=n}}}function TW(n){for(n=n.return;n!==null&&n.tag!==5&&n.tag!==3&&n.tag!==13;)n=n.return;Ql=n}function v3(n){if(n!==Ql)return!1;if(!wa)return TW(n),wa=!0,!1;var e;if((e=n.tag!==3)&&!(e=n.tag!==5)&&(e=n.type,e=e!=="head"&&e!=="body"&&!xk(n.type,n.memoizedProps)),e&&(e=Jl)){if(Ek(n))throw N$(),Error(pn(418));for(;e;)O$(n,e),e=hp(e.nextSibling)}if(TW(n),n.tag===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(pn(317));e:{for(n=n.nextSibling,e=0;n;){if(n.nodeType===8){var i=n.data;if(i==="/$"){if(e===0){Jl=hp(n.nextSibling);break e}e--}else i!=="$"&&i!=="$!"&&i!=="$?"||e++}n=n.nextSibling}Jl=null}}else Jl=Ql?hp(n.stateNode.nextSibling):null;return!0}function N$(){for(var n=Jl;n;)n=hp(n.nextSibling)}function i_(){Jl=Ql=null,wa=!1}function VD(n){fu===null?fu=[n]:fu.push(n)}var Ble=Xh.ReactCurrentBatchConfig;function cu(n,e){if(n&&n.defaultProps){e=Na({},e),n=n.defaultProps;for(var i in n)e[i]===void 0&&(e[i]=n[i]);return e}return e}var HM=kp(null),jM=null,R0=null,GD=null;function HD(){GD=R0=jM=null}function jD(n){var e=HM.current;fa(HM),n._currentValue=e}function Tk(n,e,i){for(;n!==null;){var a=n.alternate;if((n.childLanes&e)!==e?(n.childLanes|=e,a!==null&&(a.childLanes|=e)):a!==null&&(a.childLanes&e)!==e&&(a.childLanes|=e),n===i)break;n=n.return}}function j0(n,e){jM=n,GD=R0=null,n=n.dependencies,n!==null&&n.firstContext!==null&&(n.lanes&e&&(bl=!0),n.firstContext=null)}function Lc(n){var e=n._currentValue;if(GD!==n)if(n={context:n,memoizedValue:e,next:null},R0===null){if(jM===null)throw Error(pn(308));R0=n,jM.dependencies={lanes:0,firstContext:n}}else R0=R0.next=n;return e}var mg=null;function $D(n){mg===null?mg=[n]:mg.push(n)}function F$(n,e,i,a){var s=e.interleaved;return s===null?(i.next=i,$D(e)):(i.next=s.next,s.next=i),e.interleaved=i,Hh(n,a)}function Hh(n,e){n.lanes|=e;var i=n.alternate;for(i!==null&&(i.lanes|=e),i=n,n=n.return;n!==null;)n.childLanes|=e,i=n.alternate,i!==null&&(i.childLanes|=e),i=n,n=n.return;return i.tag===3?i.stateNode:null}var Jf=!1;function YD(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function B$(n,e){n=n.updateQueue,e.updateQueue===n&&(e.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,effects:n.effects})}function Uh(n,e){return{eventTime:n,lane:e,tag:0,payload:null,callback:null,next:null}}function fp(n,e,i){var a=n.updateQueue;if(a===null)return null;if(a=a.shared,pr&2){var s=a.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),a.pending=e,Hh(n,i)}return s=a.interleaved,s===null?(e.next=e,$D(a)):(e.next=s.next,s.next=e),a.interleaved=e,Hh(n,i)}function QE(n,e,i){if(e=e.updateQueue,e!==null&&(e=e.shared,(i&4194240)!==0)){var a=e.lanes;a&=n.pendingLanes,i|=a,e.lanes=i,LD(n,i)}}function AW(n,e){var i=n.updateQueue,a=n.alternate;if(a!==null&&(a=a.updateQueue,i===a)){var s=null,l=null;if(i=i.firstBaseUpdate,i!==null){do{var d={eventTime:i.eventTime,lane:i.lane,tag:i.tag,payload:i.payload,callback:i.callback,next:null};l===null?s=l=d:l=l.next=d,i=i.next}while(i!==null);l===null?s=l=e:l=l.next=e}else s=l=e;i={baseState:a.baseState,firstBaseUpdate:s,lastBaseUpdate:l,shared:a.shared,effects:a.effects},n.updateQueue=i;return}n=i.lastBaseUpdate,n===null?i.firstBaseUpdate=e:n.next=e,i.lastBaseUpdate=e}function $M(n,e,i,a){var s=n.updateQueue;Jf=!1;var l=s.firstBaseUpdate,d=s.lastBaseUpdate,f=s.shared.pending;if(f!==null){s.shared.pending=null;var p=f,y=p.next;p.next=null,d===null?l=y:d.next=y,d=p;var _=n.alternate;_!==null&&(_=_.updateQueue,f=_.lastBaseUpdate,f!==d&&(f===null?_.firstBaseUpdate=y:f.next=y,_.lastBaseUpdate=p))}if(l!==null){var b=s.baseState;d=0,_=y=p=null,f=l;do{var S=f.lane,A=f.eventTime;if((a&S)===S){_!==null&&(_=_.next={eventTime:A,lane:0,tag:f.tag,payload:f.payload,callback:f.callback,next:null});e:{var P=n,L=f;switch(S=e,A=i,L.tag){case 1:if(P=L.payload,typeof P=="function"){b=P.call(A,b,S);break e}b=P;break e;case 3:P.flags=P.flags&-65537|128;case 0:if(P=L.payload,S=typeof P=="function"?P.call(A,b,S):P,S==null)break e;b=Na({},b,S);break e;case 2:Jf=!0}}f.callback!==null&&f.lane!==0&&(n.flags|=64,S=s.effects,S===null?s.effects=[f]:S.push(f))}else A={eventTime:A,lane:S,tag:f.tag,payload:f.payload,callback:f.callback,next:null},_===null?(y=_=A,p=b):_=_.next=A,d|=S;if(f=f.next,f===null){if(f=s.shared.pending,f===null)break;S=f,f=S.next,S.next=null,s.lastBaseUpdate=S,s.shared.pending=null}}while(1);if(_===null&&(p=b),s.baseState=p,s.firstBaseUpdate=y,s.lastBaseUpdate=_,e=s.shared.interleaved,e!==null){s=e;do d|=s.lane,s=s.next;while(s!==e)}else l===null&&(s.shared.lanes=0);Bg|=d,n.lanes=d,n.memoizedState=b}}function CW(n,e,i){if(n=e.effects,e.effects=null,n!==null)for(e=0;e<n.length;e++){var a=n[e],s=a.callback;if(s!==null){if(a.callback=null,a=i,typeof s!="function")throw Error(pn(191,s));s.call(a)}}}var U$=new Fj.Component().refs;function Ak(n,e,i,a){e=n.memoizedState,i=i(a,e),i=i==null?e:Na({},e,i),n.memoizedState=i,n.lanes===0&&(n.updateQueue.baseState=i)}var FT={isMounted:function(n){return(n=n._reactInternals)?ey(n)===n:!1},enqueueSetState:function(n,e,i){n=n._reactInternals;var a=qs(),s=mp(n),l=Uh(a,s);l.payload=e,i!=null&&(l.callback=i),e=fp(n,l,s),e!==null&&(vu(e,n,s,a),QE(e,n,s))},enqueueReplaceState:function(n,e,i){n=n._reactInternals;var a=qs(),s=mp(n),l=Uh(a,s);l.tag=1,l.payload=e,i!=null&&(l.callback=i),e=fp(n,l,s),e!==null&&(vu(e,n,s,a),QE(e,n,s))},enqueueForceUpdate:function(n,e){n=n._reactInternals;var i=qs(),a=mp(n),s=Uh(i,a);s.tag=2,e!=null&&(s.callback=e),e=fp(n,s,a),e!==null&&(vu(e,n,a,i),QE(e,n,a))}};function PW(n,e,i,a,s,l,d){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(a,l,d):e.prototype&&e.prototype.isPureReactComponent?!Vb(i,a)||!Vb(s,l):!0}function W$(n,e,i){var a=!1,s=Sp,l=e.contextType;return typeof l=="object"&&l!==null?l=Lc(l):(s=Sl(e)?Og:Cs.current,a=e.contextTypes,l=(a=a!=null)?n_(n,s):Sp),e=new e(i,l),n.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=FT,n.stateNode=e,e._reactInternals=n,a&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=s,n.__reactInternalMemoizedMaskedChildContext=l),e}function IW(n,e,i,a){n=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(i,a),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(i,a),e.state!==n&&FT.enqueueReplaceState(e,e.state,null)}function Ck(n,e,i,a){var s=n.stateNode;s.props=i,s.state=n.memoizedState,s.refs=U$,YD(n);var l=e.contextType;typeof l=="object"&&l!==null?s.context=Lc(l):(l=Sl(e)?Og:Cs.current,s.context=n_(n,l)),s.state=n.memoizedState,l=e.getDerivedStateFromProps,typeof l=="function"&&(Ak(n,e,l,i),s.state=n.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&FT.enqueueReplaceState(s,s.state,null),$M(n,i,s,a),s.state=n.memoizedState),typeof s.componentDidMount=="function"&&(n.flags|=4194308)}function ix(n,e,i){if(n=i.ref,n!==null&&typeof n!="function"&&typeof n!="object"){if(i._owner){if(i=i._owner,i){if(i.tag!==1)throw Error(pn(309));var a=i.stateNode}if(!a)throw Error(pn(147,n));var s=a,l=""+n;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===l?e.ref:(e=function(d){var f=s.refs;f===U$&&(f=s.refs={}),d===null?delete f[l]:f[l]=d},e._stringRef=l,e)}if(typeof n!="string")throw Error(pn(284));if(!i._owner)throw Error(pn(290,n))}return n}function _3(n,e){throw n=Object.prototype.toString.call(e),Error(pn(31,n==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":n))}function RW(n){var e=n._init;return e(n._payload)}function V$(n){function e(R,z){if(n){var O=R.deletions;O===null?(R.deletions=[z],R.flags|=16):O.push(z)}}function i(R,z){if(!n)return null;for(;z!==null;)e(R,z),z=z.sibling;return null}function a(R,z){for(R=new Map;z!==null;)z.key!==null?R.set(z.key,z):R.set(z.index,z),z=z.sibling;return R}function s(R,z){return R=gp(R,z),R.index=0,R.sibling=null,R}function l(R,z,O){return R.index=O,n?(O=R.alternate,O!==null?(O=O.index,O<z?(R.flags|=2,z):O):(R.flags|=2,z)):(R.flags|=1048576,z)}function d(R){return n&&R.alternate===null&&(R.flags|=2),R}function f(R,z,O,F){return z===null||z.tag!==6?(z=bR(O,R.mode,F),z.return=R,z):(z=s(z,O),z.return=R,z)}function p(R,z,O,F){var H=O.type;return H===S0?_(R,z,O.props.children,F,O.key):z!==null&&(z.elementType===H||typeof H=="object"&&H!==null&&H.$$typeof===Kf&&RW(H)===z.type)?(F=s(z,O.props),F.ref=ix(R,z,O),F.return=R,F):(F=aM(O.type,O.key,O.props,null,R.mode,F),F.ref=ix(R,z,O),F.return=R,F)}function y(R,z,O,F){return z===null||z.tag!==4||z.stateNode.containerInfo!==O.containerInfo||z.stateNode.implementation!==O.implementation?(z=wR(O,R.mode,F),z.return=R,z):(z=s(z,O.children||[]),z.return=R,z)}function _(R,z,O,F,H){return z===null||z.tag!==7?(z=Ag(O,R.mode,F,H),z.return=R,z):(z=s(z,O),z.return=R,z)}function b(R,z,O){if(typeof z=="string"&&z!==""||typeof z=="number")return z=bR(""+z,R.mode,O),z.return=R,z;if(typeof z=="object"&&z!==null){switch(z.$$typeof){case l3:return O=aM(z.type,z.key,z.props,null,R.mode,O),O.ref=ix(R,null,z),O.return=R,O;case w0:return z=wR(z,R.mode,O),z.return=R,z;case Kf:var F=z._init;return b(R,F(z._payload),O)}if(Wx(z)||J1(z))return z=Ag(z,R.mode,O,null),z.return=R,z;_3(R,z)}return null}function S(R,z,O,F){var H=z!==null?z.key:null;if(typeof O=="string"&&O!==""||typeof O=="number")return H!==null?null:f(R,z,""+O,F);if(typeof O=="object"&&O!==null){switch(O.$$typeof){case l3:return O.key===H?p(R,z,O,F):null;case w0:return O.key===H?y(R,z,O,F):null;case Kf:return H=O._init,S(R,z,H(O._payload),F)}if(Wx(O)||J1(O))return H!==null?null:_(R,z,O,F,null);_3(R,O)}return null}function A(R,z,O,F,H){if(typeof F=="string"&&F!==""||typeof F=="number")return R=R.get(O)||null,f(z,R,""+F,H);if(typeof F=="object"&&F!==null){switch(F.$$typeof){case l3:return R=R.get(F.key===null?O:F.key)||null,p(z,R,F,H);case w0:return R=R.get(F.key===null?O:F.key)||null,y(z,R,F,H);case Kf:var $=F._init;return A(R,z,O,$(F._payload),H)}if(Wx(F)||J1(F))return R=R.get(O)||null,_(z,R,F,H,null);_3(z,F)}return null}function P(R,z,O,F){for(var H=null,$=null,Y=z,te=z=0,G=null;Y!==null&&te<O.length;te++){Y.index>te?(G=Y,Y=null):G=Y.sibling;var Q=S(R,Y,O[te],F);if(Q===null){Y===null&&(Y=G);break}n&&Y&&Q.alternate===null&&e(R,Y),z=l(Q,z,te),$===null?H=Q:$.sibling=Q,$=Q,Y=G}if(te===O.length)return i(R,Y),wa&&ig(R,te),H;if(Y===null){for(;te<O.length;te++)Y=b(R,O[te],F),Y!==null&&(z=l(Y,z,te),$===null?H=Y:$.sibling=Y,$=Y);return wa&&ig(R,te),H}for(Y=a(R,Y);te<O.length;te++)G=A(Y,R,te,O[te],F),G!==null&&(n&&G.alternate!==null&&Y.delete(G.key===null?te:G.key),z=l(G,z,te),$===null?H=G:$.sibling=G,$=G);return n&&Y.forEach(function(he){return e(R,he)}),wa&&ig(R,te),H}function L(R,z,O,F){var H=J1(O);if(typeof H!="function")throw Error(pn(150));if(O=H.call(O),O==null)throw Error(pn(151));for(var $=H=null,Y=z,te=z=0,G=null,Q=O.next();Y!==null&&!Q.done;te++,Q=O.next()){Y.index>te?(G=Y,Y=null):G=Y.sibling;var he=S(R,Y,Q.value,F);if(he===null){Y===null&&(Y=G);break}n&&Y&&he.alternate===null&&e(R,Y),z=l(he,z,te),$===null?H=he:$.sibling=he,$=he,Y=G}if(Q.done)return i(R,Y),wa&&ig(R,te),H;if(Y===null){for(;!Q.done;te++,Q=O.next())Q=b(R,Q.value,F),Q!==null&&(z=l(Q,z,te),$===null?H=Q:$.sibling=Q,$=Q);return wa&&ig(R,te),H}for(Y=a(R,Y);!Q.done;te++,Q=O.next())Q=A(Y,R,te,Q.value,F),Q!==null&&(n&&Q.alternate!==null&&Y.delete(Q.key===null?te:Q.key),z=l(Q,z,te),$===null?H=Q:$.sibling=Q,$=Q);return n&&Y.forEach(function(pe){return e(R,pe)}),wa&&ig(R,te),H}function k(R,z,O,F){if(typeof O=="object"&&O!==null&&O.type===S0&&O.key===null&&(O=O.props.children),typeof O=="object"&&O!==null){switch(O.$$typeof){case l3:e:{for(var H=O.key,$=z;$!==null;){if($.key===H){if(H=O.type,H===S0){if($.tag===7){i(R,$.sibling),z=s($,O.props.children),z.return=R,R=z;break e}}else if($.elementType===H||typeof H=="object"&&H!==null&&H.$$typeof===Kf&&RW(H)===$.type){i(R,$.sibling),z=s($,O.props),z.ref=ix(R,$,O),z.return=R,R=z;break e}i(R,$);break}else e(R,$);$=$.sibling}O.type===S0?(z=Ag(O.props.children,R.mode,F,O.key),z.return=R,R=z):(F=aM(O.type,O.key,O.props,null,R.mode,F),F.ref=ix(R,z,O),F.return=R,R=F)}return d(R);case w0:e:{for($=O.key;z!==null;){if(z.key===$)if(z.tag===4&&z.stateNode.containerInfo===O.containerInfo&&z.stateNode.implementation===O.implementation){i(R,z.sibling),z=s(z,O.children||[]),z.return=R,R=z;break e}else{i(R,z);break}else e(R,z);z=z.sibling}z=wR(O,R.mode,F),z.return=R,R=z}return d(R);case Kf:return $=O._init,k(R,z,$(O._payload),F)}if(Wx(O))return P(R,z,O,F);if(J1(O))return L(R,z,O,F);_3(R,O)}return typeof O=="string"&&O!==""||typeof O=="number"?(O=""+O,z!==null&&z.tag===6?(i(R,z.sibling),z=s(z,O),z.return=R,R=z):(i(R,z),z=bR(O,R.mode,F),z.return=R,R=z),d(R)):i(R,z)}return k}var r_=V$(!0),G$=V$(!1),Vw={},vd=kp(Vw),$b=kp(Vw),Yb=kp(Vw);function gg(n){if(n===Vw)throw Error(pn(174));return n}function qD(n,e){switch(oa(Yb,e),oa($b,n),oa(vd,Vw),n=e.nodeType,n){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:ok(null,"");break;default:n=n===8?e.parentNode:e,e=n.namespaceURI||null,n=n.tagName,e=ok(e,n)}fa(vd),oa(vd,e)}function a_(){fa(vd),fa($b),fa(Yb)}function H$(n){gg(Yb.current);var e=gg(vd.current),i=ok(e,n.type);e!==i&&(oa($b,n),oa(vd,i))}function XD(n){$b.current===n&&(fa(vd),fa($b))}var La=kp(0);function YM(n){for(var e=n;e!==null;){if(e.tag===13){var i=e.memoizedState;if(i!==null&&(i=i.dehydrated,i===null||i.data==="$?"||i.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var mR=[];function ZD(){for(var n=0;n<mR.length;n++)mR[n]._workInProgressVersionPrimary=null;mR.length=0}var eM=Xh.ReactCurrentDispatcher,gR=Xh.ReactCurrentBatchConfig,Fg=0,za=null,Ro=null,Vo=null,qM=!1,ob=!1,qb=0,Ule=0;function ms(){throw Error(pn(321))}function KD(n,e){if(e===null)return!1;for(var i=0;i<e.length&&i<n.length;i++)if(!xu(n[i],e[i]))return!1;return!0}function JD(n,e,i,a,s,l){if(Fg=l,za=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,eM.current=n===null||n.memoizedState===null?Hle:jle,n=i(a,s),ob){l=0;do{if(ob=!1,qb=0,25<=l)throw Error(pn(301));l+=1,Vo=Ro=null,e.updateQueue=null,eM.current=$le,n=i(a,s)}while(ob)}if(eM.current=XM,e=Ro!==null&&Ro.next!==null,Fg=0,Vo=Ro=za=null,qM=!1,e)throw Error(pn(300));return n}function QD(){var n=qb!==0;return qb=0,n}function ld(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Vo===null?za.memoizedState=Vo=n:Vo=Vo.next=n,Vo}function kc(){if(Ro===null){var n=za.alternate;n=n!==null?n.memoizedState:null}else n=Ro.next;var e=Vo===null?za.memoizedState:Vo.next;if(e!==null)Vo=e,Ro=n;else{if(n===null)throw Error(pn(310));Ro=n,n={memoizedState:Ro.memoizedState,baseState:Ro.baseState,baseQueue:Ro.baseQueue,queue:Ro.queue,next:null},Vo===null?za.memoizedState=Vo=n:Vo=Vo.next=n}return Vo}function Xb(n,e){return typeof e=="function"?e(n):e}function yR(n){var e=kc(),i=e.queue;if(i===null)throw Error(pn(311));i.lastRenderedReducer=n;var a=Ro,s=a.baseQueue,l=i.pending;if(l!==null){if(s!==null){var d=s.next;s.next=l.next,l.next=d}a.baseQueue=s=l,i.pending=null}if(s!==null){l=s.next,a=a.baseState;var f=d=null,p=null,y=l;do{var _=y.lane;if((Fg&_)===_)p!==null&&(p=p.next={lane:0,action:y.action,hasEagerState:y.hasEagerState,eagerState:y.eagerState,next:null}),a=y.hasEagerState?y.eagerState:n(a,y.action);else{var b={lane:_,action:y.action,hasEagerState:y.hasEagerState,eagerState:y.eagerState,next:null};p===null?(f=p=b,d=a):p=p.next=b,za.lanes|=_,Bg|=_}y=y.next}while(y!==null&&y!==l);p===null?d=a:p.next=f,xu(a,e.memoizedState)||(bl=!0),e.memoizedState=a,e.baseState=d,e.baseQueue=p,i.lastRenderedState=a}if(n=i.interleaved,n!==null){s=n;do l=s.lane,za.lanes|=l,Bg|=l,s=s.next;while(s!==n)}else s===null&&(i.lanes=0);return[e.memoizedState,i.dispatch]}function vR(n){var e=kc(),i=e.queue;if(i===null)throw Error(pn(311));i.lastRenderedReducer=n;var a=i.dispatch,s=i.pending,l=e.memoizedState;if(s!==null){i.pending=null;var d=s=s.next;do l=n(l,d.action),d=d.next;while(d!==s);xu(l,e.memoizedState)||(bl=!0),e.memoizedState=l,e.baseQueue===null&&(e.baseState=l),i.lastRenderedState=l}return[l,a]}function j$(){}function $$(n,e){var i=za,a=kc(),s=e(),l=!xu(a.memoizedState,s);if(l&&(a.memoizedState=s,bl=!0),a=a.queue,e4(X$.bind(null,i,a,n),[n]),a.getSnapshot!==e||l||Vo!==null&&Vo.memoizedState.tag&1){if(i.flags|=2048,Zb(9,q$.bind(null,i,a,s,e),void 0,null),Ho===null)throw Error(pn(349));Fg&30||Y$(i,e,s)}return s}function Y$(n,e,i){n.flags|=16384,n={getSnapshot:e,value:i},e=za.updateQueue,e===null?(e={lastEffect:null,stores:null},za.updateQueue=e,e.stores=[n]):(i=e.stores,i===null?e.stores=[n]:i.push(n))}function q$(n,e,i,a){e.value=i,e.getSnapshot=a,Z$(e)&&K$(n)}function X$(n,e,i){return i(function(){Z$(e)&&K$(n)})}function Z$(n){var e=n.getSnapshot;n=n.value;try{var i=e();return!xu(n,i)}catch{return!0}}function K$(n){var e=Hh(n,1);e!==null&&vu(e,n,1,-1)}function LW(n){var e=ld();return typeof n=="function"&&(n=n()),e.memoizedState=e.baseState=n,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Xb,lastRenderedState:n},e.queue=n,n=n.dispatch=Gle.bind(null,za,n),[e.memoizedState,n]}function Zb(n,e,i,a){return n={tag:n,create:e,destroy:i,deps:a,next:null},e=za.updateQueue,e===null?(e={lastEffect:null,stores:null},za.updateQueue=e,e.lastEffect=n.next=n):(i=e.lastEffect,i===null?e.lastEffect=n.next=n:(a=i.next,i.next=n,n.next=a,e.lastEffect=n)),n}function J$(){return kc().memoizedState}function tM(n,e,i,a){var s=ld();za.flags|=n,s.memoizedState=Zb(1|e,i,void 0,a===void 0?null:a)}function BT(n,e,i,a){var s=kc();a=a===void 0?null:a;var l=void 0;if(Ro!==null){var d=Ro.memoizedState;if(l=d.destroy,a!==null&&KD(a,d.deps)){s.memoizedState=Zb(e,i,l,a);return}}za.flags|=n,s.memoizedState=Zb(1|e,i,l,a)}function kW(n,e){return tM(8390656,8,n,e)}function e4(n,e){return BT(2048,8,n,e)}function Q$(n,e){return BT(4,2,n,e)}function eY(n,e){return BT(4,4,n,e)}function tY(n,e){if(typeof e=="function")return n=n(),e(n),function(){e(null)};if(e!=null)return n=n(),e.current=n,function(){e.current=null}}function nY(n,e,i){return i=i!=null?i.concat([n]):null,BT(4,4,tY.bind(null,e,n),i)}function t4(){}function iY(n,e){var i=kc();e=e===void 0?null:e;var a=i.memoizedState;return a!==null&&e!==null&&KD(e,a[1])?a[0]:(i.memoizedState=[n,e],n)}function rY(n,e){var i=kc();e=e===void 0?null:e;var a=i.memoizedState;return a!==null&&e!==null&&KD(e,a[1])?a[0]:(n=n(),i.memoizedState=[n,e],n)}function aY(n,e,i){return Fg&21?(xu(i,e)||(i=l$(),za.lanes|=i,Bg|=i,n.baseState=!0),e):(n.baseState&&(n.baseState=!1,bl=!0),n.memoizedState=i)}function Wle(n,e){var i=Hr;Hr=i!==0&&4>i?i:4,n(!0);var a=gR.transition;gR.transition={};try{n(!1),e()}finally{Hr=i,gR.transition=a}}function oY(){return kc().memoizedState}function Vle(n,e,i){var a=mp(n);if(i={lane:a,action:i,hasEagerState:!1,eagerState:null,next:null},sY(n))lY(e,i);else if(i=F$(n,e,i,a),i!==null){var s=qs();vu(i,n,a,s),cY(i,e,a)}}function Gle(n,e,i){var a=mp(n),s={lane:a,action:i,hasEagerState:!1,eagerState:null,next:null};if(sY(n))lY(e,s);else{var l=n.alternate;if(n.lanes===0&&(l===null||l.lanes===0)&&(l=e.lastRenderedReducer,l!==null))try{var d=e.lastRenderedState,f=l(d,i);if(s.hasEagerState=!0,s.eagerState=f,xu(f,d)){var p=e.interleaved;p===null?(s.next=s,$D(e)):(s.next=p.next,p.next=s),e.interleaved=s;return}}catch{}finally{}i=F$(n,e,s,a),i!==null&&(s=qs(),vu(i,n,a,s),cY(i,e,a))}}function sY(n){var e=n.alternate;return n===za||e!==null&&e===za}function lY(n,e){ob=qM=!0;var i=n.pending;i===null?e.next=e:(e.next=i.next,i.next=e),n.pending=e}function cY(n,e,i){if(i&4194240){var a=e.lanes;a&=n.pendingLanes,i|=a,e.lanes=i,LD(n,i)}}var XM={readContext:Lc,useCallback:ms,useContext:ms,useEffect:ms,useImperativeHandle:ms,useInsertionEffect:ms,useLayoutEffect:ms,useMemo:ms,useReducer:ms,useRef:ms,useState:ms,useDebugValue:ms,useDeferredValue:ms,useTransition:ms,useMutableSource:ms,useSyncExternalStore:ms,useId:ms,unstable_isNewReconciler:!1},Hle={readContext:Lc,useCallback:function(n,e){return ld().memoizedState=[n,e===void 0?null:e],n},useContext:Lc,useEffect:kW,useImperativeHandle:function(n,e,i){return i=i!=null?i.concat([n]):null,tM(4194308,4,tY.bind(null,e,n),i)},useLayoutEffect:function(n,e){return tM(4194308,4,n,e)},useInsertionEffect:function(n,e){return tM(4,2,n,e)},useMemo:function(n,e){var i=ld();return e=e===void 0?null:e,n=n(),i.memoizedState=[n,e],n},useReducer:function(n,e,i){var a=ld();return e=i!==void 0?i(e):e,a.memoizedState=a.baseState=e,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:e},a.queue=n,n=n.dispatch=Vle.bind(null,za,n),[a.memoizedState,n]},useRef:function(n){var e=ld();return n={current:n},e.memoizedState=n},useState:LW,useDebugValue:t4,useDeferredValue:function(n){return ld().memoizedState=n},useTransition:function(){var n=LW(!1),e=n[0];return n=Wle.bind(null,n[1]),ld().memoizedState=n,[e,n]},useMutableSource:function(){},useSyncExternalStore:function(n,e,i){var a=za,s=ld();if(wa){if(i===void 0)throw Error(pn(407));i=i()}else{if(i=e(),Ho===null)throw Error(pn(349));Fg&30||Y$(a,e,i)}s.memoizedState=i;var l={value:i,getSnapshot:e};return s.queue=l,kW(X$.bind(null,a,l,n),[n]),a.flags|=2048,Zb(9,q$.bind(null,a,l,i,e),void 0,null),i},useId:function(){var n=ld(),e=Ho.identifierPrefix;if(wa){var i=Dh,a=kh;i=(a&~(1<<32-yu(a)-1)).toString(32)+i,e=":"+e+"R"+i,i=qb++,0<i&&(e+="H"+i.toString(32)),e+=":"}else i=Ule++,e=":"+e+"r"+i.toString(32)+":";return n.memoizedState=e},unstable_isNewReconciler:!1},jle={readContext:Lc,useCallback:iY,useContext:Lc,useEffect:e4,useImperativeHandle:nY,useInsertionEffect:Q$,useLayoutEffect:eY,useMemo:rY,useReducer:yR,useRef:J$,useState:function(){return yR(Xb)},useDebugValue:t4,useDeferredValue:function(n){var e=kc();return aY(e,Ro.memoizedState,n)},useTransition:function(){var n=yR(Xb)[0],e=kc().memoizedState;return[n,e]},useMutableSource:j$,useSyncExternalStore:$$,useId:oY,unstable_isNewReconciler:!1},$le={readContext:Lc,useCallback:iY,useContext:Lc,useEffect:e4,useImperativeHandle:nY,useInsertionEffect:Q$,useLayoutEffect:eY,useMemo:rY,useReducer:vR,useRef:J$,useState:function(){return vR(Xb)},useDebugValue:t4,useDeferredValue:function(n){var e=kc();return Ro===null?e.memoizedState=n:aY(e,Ro.memoizedState,n)},useTransition:function(){var n=vR(Xb)[0],e=kc().memoizedState;return[n,e]},useMutableSource:j$,useSyncExternalStore:$$,useId:oY,unstable_isNewReconciler:!1};function o_(n,e){try{var i="",a=e;do i+=xse(a),a=a.return;while(a);var s=i}catch(l){s=`
Error generating stack: `+l.message+`
`+l.stack}return{value:n,source:e,stack:s,digest:null}}function _R(n,e,i){return{value:n,source:null,stack:i??null,digest:e??null}}function Pk(n,e){try{console.error(e.value)}catch(i){setTimeout(function(){throw i})}}var Yle=typeof WeakMap=="function"?WeakMap:Map;function uY(n,e,i){i=Uh(-1,i),i.tag=3,i.payload={element:null};var a=e.value;return i.callback=function(){KM||(KM=!0,Bk=a),Pk(n,e)},i}function dY(n,e,i){i=Uh(-1,i),i.tag=3;var a=n.type.getDerivedStateFromError;if(typeof a=="function"){var s=e.value;i.payload=function(){return a(s)},i.callback=function(){Pk(n,e)}}var l=n.stateNode;return l!==null&&typeof l.componentDidCatch=="function"&&(i.callback=function(){Pk(n,e),typeof a!="function"&&(pp===null?pp=new Set([this]):pp.add(this));var d=e.stack;this.componentDidCatch(e.value,{componentStack:d!==null?d:""})}),i}function DW(n,e,i){var a=n.pingCache;if(a===null){a=n.pingCache=new Yle;var s=new Set;a.set(e,s)}else s=a.get(e),s===void 0&&(s=new Set,a.set(e,s));s.has(i)||(s.add(i),n=sce.bind(null,n,e,i),e.then(n,n))}function zW(n){do{var e;if((e=n.tag===13)&&(e=n.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return n;n=n.return}while(n!==null);return null}function OW(n,e,i,a,s){return n.mode&1?(n.flags|=65536,n.lanes=s,n):(n===e?n.flags|=65536:(n.flags|=128,i.flags|=131072,i.flags&=-52805,i.tag===1&&(i.alternate===null?i.tag=17:(e=Uh(-1,1),e.tag=2,fp(i,e,1))),i.lanes|=1),n)}var qle=Xh.ReactCurrentOwner,bl=!1;function $s(n,e,i,a){e.child=n===null?G$(e,null,i,a):r_(e,n.child,i,a)}function NW(n,e,i,a,s){i=i.render;var l=e.ref;return j0(e,s),a=JD(n,e,i,a,l,s),i=QD(),n!==null&&!bl?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~s,jh(n,e,s)):(wa&&i&&UD(e),e.flags|=1,$s(n,e,a,s),e.child)}function FW(n,e,i,a,s){if(n===null){var l=i.type;return typeof l=="function"&&!c4(l)&&l.defaultProps===void 0&&i.compare===null&&i.defaultProps===void 0?(e.tag=15,e.type=l,hY(n,e,l,a,s)):(n=aM(i.type,null,a,e,e.mode,s),n.ref=e.ref,n.return=e,e.child=n)}if(l=n.child,!(n.lanes&s)){var d=l.memoizedProps;if(i=i.compare,i=i!==null?i:Vb,i(d,a)&&n.ref===e.ref)return jh(n,e,s)}return e.flags|=1,n=gp(l,a),n.ref=e.ref,n.return=e,e.child=n}function hY(n,e,i,a,s){if(n!==null){var l=n.memoizedProps;if(Vb(l,a)&&n.ref===e.ref)if(bl=!1,e.pendingProps=a=l,(n.lanes&s)!==0)n.flags&131072&&(bl=!0);else return e.lanes=n.lanes,jh(n,e,s)}return Ik(n,e,i,a,s)}function fY(n,e,i){var a=e.pendingProps,s=a.children,l=n!==null?n.memoizedState:null;if(a.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},oa(k0,$l),$l|=i;else{if(!(i&1073741824))return n=l!==null?l.baseLanes|i:i,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:n,cachePool:null,transitions:null},e.updateQueue=null,oa(k0,$l),$l|=n,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},a=l!==null?l.baseLanes:i,oa(k0,$l),$l|=a}else l!==null?(a=l.baseLanes|i,e.memoizedState=null):a=i,oa(k0,$l),$l|=a;return $s(n,e,s,i),e.child}function pY(n,e){var i=e.ref;(n===null&&i!==null||n!==null&&n.ref!==i)&&(e.flags|=512,e.flags|=2097152)}function Ik(n,e,i,a,s){var l=Sl(i)?Og:Cs.current;return l=n_(e,l),j0(e,s),i=JD(n,e,i,a,l,s),a=QD(),n!==null&&!bl?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~s,jh(n,e,s)):(wa&&a&&UD(e),e.flags|=1,$s(n,e,i,s),e.child)}function BW(n,e,i,a,s){if(Sl(i)){var l=!0;WM(e)}else l=!1;if(j0(e,s),e.stateNode===null)nM(n,e),W$(e,i,a),Ck(e,i,a,s),a=!0;else if(n===null){var d=e.stateNode,f=e.memoizedProps;d.props=f;var p=d.context,y=i.contextType;typeof y=="object"&&y!==null?y=Lc(y):(y=Sl(i)?Og:Cs.current,y=n_(e,y));var _=i.getDerivedStateFromProps,b=typeof _=="function"||typeof d.getSnapshotBeforeUpdate=="function";b||typeof d.UNSAFE_componentWillReceiveProps!="function"&&typeof d.componentWillReceiveProps!="function"||(f!==a||p!==y)&&IW(e,d,a,y),Jf=!1;var S=e.memoizedState;d.state=S,$M(e,a,d,s),p=e.memoizedState,f!==a||S!==p||wl.current||Jf?(typeof _=="function"&&(Ak(e,i,_,a),p=e.memoizedState),(f=Jf||PW(e,i,f,a,S,p,y))?(b||typeof d.UNSAFE_componentWillMount!="function"&&typeof d.componentWillMount!="function"||(typeof d.componentWillMount=="function"&&d.componentWillMount(),typeof d.UNSAFE_componentWillMount=="function"&&d.UNSAFE_componentWillMount()),typeof d.componentDidMount=="function"&&(e.flags|=4194308)):(typeof d.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=a,e.memoizedState=p),d.props=a,d.state=p,d.context=y,a=f):(typeof d.componentDidMount=="function"&&(e.flags|=4194308),a=!1)}else{d=e.stateNode,B$(n,e),f=e.memoizedProps,y=e.type===e.elementType?f:cu(e.type,f),d.props=y,b=e.pendingProps,S=d.context,p=i.contextType,typeof p=="object"&&p!==null?p=Lc(p):(p=Sl(i)?Og:Cs.current,p=n_(e,p));var A=i.getDerivedStateFromProps;(_=typeof A=="function"||typeof d.getSnapshotBeforeUpdate=="function")||typeof d.UNSAFE_componentWillReceiveProps!="function"&&typeof d.componentWillReceiveProps!="function"||(f!==b||S!==p)&&IW(e,d,a,p),Jf=!1,S=e.memoizedState,d.state=S,$M(e,a,d,s);var P=e.memoizedState;f!==b||S!==P||wl.current||Jf?(typeof A=="function"&&(Ak(e,i,A,a),P=e.memoizedState),(y=Jf||PW(e,i,y,a,S,P,p)||!1)?(_||typeof d.UNSAFE_componentWillUpdate!="function"&&typeof d.componentWillUpdate!="function"||(typeof d.componentWillUpdate=="function"&&d.componentWillUpdate(a,P,p),typeof d.UNSAFE_componentWillUpdate=="function"&&d.UNSAFE_componentWillUpdate(a,P,p)),typeof d.componentDidUpdate=="function"&&(e.flags|=4),typeof d.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof d.componentDidUpdate!="function"||f===n.memoizedProps&&S===n.memoizedState||(e.flags|=4),typeof d.getSnapshotBeforeUpdate!="function"||f===n.memoizedProps&&S===n.memoizedState||(e.flags|=1024),e.memoizedProps=a,e.memoizedState=P),d.props=a,d.state=P,d.context=p,a=y):(typeof d.componentDidUpdate!="function"||f===n.memoizedProps&&S===n.memoizedState||(e.flags|=4),typeof d.getSnapshotBeforeUpdate!="function"||f===n.memoizedProps&&S===n.memoizedState||(e.flags|=1024),a=!1)}return Rk(n,e,i,a,l,s)}function Rk(n,e,i,a,s,l){pY(n,e);var d=(e.flags&128)!==0;if(!a&&!d)return s&&EW(e,i,!1),jh(n,e,l);a=e.stateNode,qle.current=e;var f=d&&typeof i.getDerivedStateFromError!="function"?null:a.render();return e.flags|=1,n!==null&&d?(e.child=r_(e,n.child,null,l),e.child=r_(e,null,f,l)):$s(n,e,f,l),e.memoizedState=a.state,s&&EW(e,i,!0),e.child}function mY(n){var e=n.stateNode;e.pendingContext?SW(n,e.pendingContext,e.pendingContext!==e.context):e.context&&SW(n,e.context,!1),qD(n,e.containerInfo)}function UW(n,e,i,a,s){return i_(),VD(s),e.flags|=256,$s(n,e,i,a),e.child}var Lk={dehydrated:null,treeContext:null,retryLane:0};function kk(n){return{baseLanes:n,cachePool:null,transitions:null}}function gY(n,e,i){var a=e.pendingProps,s=La.current,l=!1,d=(e.flags&128)!==0,f;if((f=d)||(f=n!==null&&n.memoizedState===null?!1:(s&2)!==0),f?(l=!0,e.flags&=-129):(n===null||n.memoizedState!==null)&&(s|=1),oa(La,s&1),n===null)return Mk(e),n=e.memoizedState,n!==null&&(n=n.dehydrated,n!==null)?(e.mode&1?n.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(d=a.children,n=a.fallback,l?(a=e.mode,l=e.child,d={mode:"hidden",children:d},!(a&1)&&l!==null?(l.childLanes=0,l.pendingProps=d):l=VT(d,a,0,null),n=Ag(n,a,i,null),l.return=e,n.return=e,l.sibling=n,e.child=l,e.child.memoizedState=kk(i),e.memoizedState=Lk,n):n4(e,d));if(s=n.memoizedState,s!==null&&(f=s.dehydrated,f!==null))return Xle(n,e,d,a,f,s,i);if(l){l=a.fallback,d=e.mode,s=n.child,f=s.sibling;var p={mode:"hidden",children:a.children};return!(d&1)&&e.child!==s?(a=e.child,a.childLanes=0,a.pendingProps=p,e.deletions=null):(a=gp(s,p),a.subtreeFlags=s.subtreeFlags&14680064),f!==null?l=gp(f,l):(l=Ag(l,d,i,null),l.flags|=2),l.return=e,a.return=e,a.sibling=l,e.child=a,a=l,l=e.child,d=n.child.memoizedState,d=d===null?kk(i):{baseLanes:d.baseLanes|i,cachePool:null,transitions:d.transitions},l.memoizedState=d,l.childLanes=n.childLanes&~i,e.memoizedState=Lk,a}return l=n.child,n=l.sibling,a=gp(l,{mode:"visible",children:a.children}),!(e.mode&1)&&(a.lanes=i),a.return=e,a.sibling=null,n!==null&&(i=e.deletions,i===null?(e.deletions=[n],e.flags|=16):i.push(n)),e.child=a,e.memoizedState=null,a}function n4(n,e){return e=VT({mode:"visible",children:e},n.mode,0,null),e.return=n,n.child=e}function x3(n,e,i,a){return a!==null&&VD(a),r_(e,n.child,null,i),n=n4(e,e.pendingProps.children),n.flags|=2,e.memoizedState=null,n}function Xle(n,e,i,a,s,l,d){if(i)return e.flags&256?(e.flags&=-257,a=_R(Error(pn(422))),x3(n,e,d,a)):e.memoizedState!==null?(e.child=n.child,e.flags|=128,null):(l=a.fallback,s=e.mode,a=VT({mode:"visible",children:a.children},s,0,null),l=Ag(l,s,d,null),l.flags|=2,a.return=e,l.return=e,a.sibling=l,e.child=a,e.mode&1&&r_(e,n.child,null,d),e.child.memoizedState=kk(d),e.memoizedState=Lk,l);if(!(e.mode&1))return x3(n,e,d,null);if(s.data==="$!"){if(a=s.nextSibling&&s.nextSibling.dataset,a)var f=a.dgst;return a=f,l=Error(pn(419)),a=_R(l,a,void 0),x3(n,e,d,a)}if(f=(d&n.childLanes)!==0,bl||f){if(a=Ho,a!==null){switch(d&-d){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(a.suspendedLanes|d)?0:s,s!==0&&s!==l.retryLane&&(l.retryLane=s,Hh(n,s),vu(a,n,s,-1))}return l4(),a=_R(Error(pn(421))),x3(n,e,d,a)}return s.data==="$?"?(e.flags|=128,e.child=n.child,e=lce.bind(null,n),s._reactRetry=e,null):(n=l.treeContext,Jl=hp(s.nextSibling),Ql=e,wa=!0,fu=null,n!==null&&(Ac[Cc++]=kh,Ac[Cc++]=Dh,Ac[Cc++]=Ng,kh=n.id,Dh=n.overflow,Ng=e),e=n4(e,a.children),e.flags|=4096,e)}function WW(n,e,i){n.lanes|=e;var a=n.alternate;a!==null&&(a.lanes|=e),Tk(n.return,e,i)}function xR(n,e,i,a,s){var l=n.memoizedState;l===null?n.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:a,tail:i,tailMode:s}:(l.isBackwards=e,l.rendering=null,l.renderingStartTime=0,l.last=a,l.tail=i,l.tailMode=s)}function yY(n,e,i){var a=e.pendingProps,s=a.revealOrder,l=a.tail;if($s(n,e,a.children,i),a=La.current,a&2)a=a&1|2,e.flags|=128;else{if(n!==null&&n.flags&128)e:for(n=e.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&WW(n,i,e);else if(n.tag===19)WW(n,i,e);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break e;for(;n.sibling===null;){if(n.return===null||n.return===e)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}a&=1}if(oa(La,a),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(i=e.child,s=null;i!==null;)n=i.alternate,n!==null&&YM(n)===null&&(s=i),i=i.sibling;i=s,i===null?(s=e.child,e.child=null):(s=i.sibling,i.sibling=null),xR(e,!1,s,i,l);break;case"backwards":for(i=null,s=e.child,e.child=null;s!==null;){if(n=s.alternate,n!==null&&YM(n)===null){e.child=s;break}n=s.sibling,s.sibling=i,i=s,s=n}xR(e,!0,i,null,l);break;case"together":xR(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function nM(n,e){!(e.mode&1)&&n!==null&&(n.alternate=null,e.alternate=null,e.flags|=2)}function jh(n,e,i){if(n!==null&&(e.dependencies=n.dependencies),Bg|=e.lanes,!(i&e.childLanes))return null;if(n!==null&&e.child!==n.child)throw Error(pn(153));if(e.child!==null){for(n=e.child,i=gp(n,n.pendingProps),e.child=i,i.return=e;n.sibling!==null;)n=n.sibling,i=i.sibling=gp(n,n.pendingProps),i.return=e;i.sibling=null}return e.child}function Zle(n,e,i){switch(e.tag){case 3:mY(e),i_();break;case 5:H$(e);break;case 1:Sl(e.type)&&WM(e);break;case 4:qD(e,e.stateNode.containerInfo);break;case 10:var a=e.type._context,s=e.memoizedProps.value;oa(HM,a._currentValue),a._currentValue=s;break;case 13:if(a=e.memoizedState,a!==null)return a.dehydrated!==null?(oa(La,La.current&1),e.flags|=128,null):i&e.child.childLanes?gY(n,e,i):(oa(La,La.current&1),n=jh(n,e,i),n!==null?n.sibling:null);oa(La,La.current&1);break;case 19:if(a=(i&e.childLanes)!==0,n.flags&128){if(a)return yY(n,e,i);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),oa(La,La.current),a)break;return null;case 22:case 23:return e.lanes=0,fY(n,e,i)}return jh(n,e,i)}var vY,Dk,_Y,xY;vY=function(n,e){for(var i=e.child;i!==null;){if(i.tag===5||i.tag===6)n.appendChild(i.stateNode);else if(i.tag!==4&&i.child!==null){i.child.return=i,i=i.child;continue}if(i===e)break;for(;i.sibling===null;){if(i.return===null||i.return===e)return;i=i.return}i.sibling.return=i.return,i=i.sibling}};Dk=function(){};_Y=function(n,e,i,a){var s=n.memoizedProps;if(s!==a){n=e.stateNode,gg(vd.current);var l=null;switch(i){case"input":s=nk(n,s),a=nk(n,a),l=[];break;case"select":s=Na({},s,{value:void 0}),a=Na({},a,{value:void 0}),l=[];break;case"textarea":s=ak(n,s),a=ak(n,a),l=[];break;default:typeof s.onClick!="function"&&typeof a.onClick=="function"&&(n.onclick=BM)}sk(i,a);var d;i=null;for(y in s)if(!a.hasOwnProperty(y)&&s.hasOwnProperty(y)&&s[y]!=null)if(y==="style"){var f=s[y];for(d in f)f.hasOwnProperty(d)&&(i||(i={}),i[d]="")}else y!=="dangerouslySetInnerHTML"&&y!=="children"&&y!=="suppressContentEditableWarning"&&y!=="suppressHydrationWarning"&&y!=="autoFocus"&&(zb.hasOwnProperty(y)?l||(l=[]):(l=l||[]).push(y,null));for(y in a){var p=a[y];if(f=s!=null?s[y]:void 0,a.hasOwnProperty(y)&&p!==f&&(p!=null||f!=null))if(y==="style")if(f){for(d in f)!f.hasOwnProperty(d)||p&&p.hasOwnProperty(d)||(i||(i={}),i[d]="");for(d in p)p.hasOwnProperty(d)&&f[d]!==p[d]&&(i||(i={}),i[d]=p[d])}else i||(l||(l=[]),l.push(y,i)),i=p;else y==="dangerouslySetInnerHTML"?(p=p?p.__html:void 0,f=f?f.__html:void 0,p!=null&&f!==p&&(l=l||[]).push(y,p)):y==="children"?typeof p!="string"&&typeof p!="number"||(l=l||[]).push(y,""+p):y!=="suppressContentEditableWarning"&&y!=="suppressHydrationWarning"&&(zb.hasOwnProperty(y)?(p!=null&&y==="onScroll"&&ua("scroll",n),l||f===p||(l=[])):(l=l||[]).push(y,p))}i&&(l=l||[]).push("style",i);var y=l;(e.updateQueue=y)&&(e.flags|=4)}};xY=function(n,e,i,a){i!==a&&(e.flags|=4)};function rx(n,e){if(!wa)switch(n.tailMode){case"hidden":e=n.tail;for(var i=null;e!==null;)e.alternate!==null&&(i=e),e=e.sibling;i===null?n.tail=null:i.sibling=null;break;case"collapsed":i=n.tail;for(var a=null;i!==null;)i.alternate!==null&&(a=i),i=i.sibling;a===null?e||n.tail===null?n.tail=null:n.tail.sibling=null:a.sibling=null}}function gs(n){var e=n.alternate!==null&&n.alternate.child===n.child,i=0,a=0;if(e)for(var s=n.child;s!==null;)i|=s.lanes|s.childLanes,a|=s.subtreeFlags&14680064,a|=s.flags&14680064,s.return=n,s=s.sibling;else for(s=n.child;s!==null;)i|=s.lanes|s.childLanes,a|=s.subtreeFlags,a|=s.flags,s.return=n,s=s.sibling;return n.subtreeFlags|=a,n.childLanes=i,e}function Kle(n,e,i){var a=e.pendingProps;switch(WD(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return gs(e),null;case 1:return Sl(e.type)&&UM(),gs(e),null;case 3:return a=e.stateNode,a_(),fa(wl),fa(Cs),ZD(),a.pendingContext&&(a.context=a.pendingContext,a.pendingContext=null),(n===null||n.child===null)&&(v3(e)?e.flags|=4:n===null||n.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,fu!==null&&(Vk(fu),fu=null))),Dk(n,e),gs(e),null;case 5:XD(e);var s=gg(Yb.current);if(i=e.type,n!==null&&e.stateNode!=null)_Y(n,e,i,a,s),n.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!a){if(e.stateNode===null)throw Error(pn(166));return gs(e),null}if(n=gg(vd.current),v3(e)){a=e.stateNode,i=e.type;var l=e.memoizedProps;switch(a[hd]=e,a[jb]=l,n=(e.mode&1)!==0,i){case"dialog":ua("cancel",a),ua("close",a);break;case"iframe":case"object":case"embed":ua("load",a);break;case"video":case"audio":for(s=0;s<Gx.length;s++)ua(Gx[s],a);break;case"source":ua("error",a);break;case"img":case"image":case"link":ua("error",a),ua("load",a);break;case"details":ua("toggle",a);break;case"input":Z8(a,l),ua("invalid",a);break;case"select":a._wrapperState={wasMultiple:!!l.multiple},ua("invalid",a);break;case"textarea":J8(a,l),ua("invalid",a)}sk(i,l),s=null;for(var d in l)if(l.hasOwnProperty(d)){var f=l[d];d==="children"?typeof f=="string"?a.textContent!==f&&(l.suppressHydrationWarning!==!0&&y3(a.textContent,f,n),s=["children",f]):typeof f=="number"&&a.textContent!==""+f&&(l.suppressHydrationWarning!==!0&&y3(a.textContent,f,n),s=["children",""+f]):zb.hasOwnProperty(d)&&f!=null&&d==="onScroll"&&ua("scroll",a)}switch(i){case"input":c3(a),K8(a,l,!0);break;case"textarea":c3(a),Q8(a);break;case"select":case"option":break;default:typeof l.onClick=="function"&&(a.onclick=BM)}a=s,e.updateQueue=a,a!==null&&(e.flags|=4)}else{d=s.nodeType===9?s:s.ownerDocument,n==="http://www.w3.org/1999/xhtml"&&(n=Yj(i)),n==="http://www.w3.org/1999/xhtml"?i==="script"?(n=d.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild)):typeof a.is=="string"?n=d.createElement(i,{is:a.is}):(n=d.createElement(i),i==="select"&&(d=n,a.multiple?d.multiple=!0:a.size&&(d.size=a.size))):n=d.createElementNS(n,i),n[hd]=e,n[jb]=a,vY(n,e,!1,!1),e.stateNode=n;e:{switch(d=lk(i,a),i){case"dialog":ua("cancel",n),ua("close",n),s=a;break;case"iframe":case"object":case"embed":ua("load",n),s=a;break;case"video":case"audio":for(s=0;s<Gx.length;s++)ua(Gx[s],n);s=a;break;case"source":ua("error",n),s=a;break;case"img":case"image":case"link":ua("error",n),ua("load",n),s=a;break;case"details":ua("toggle",n),s=a;break;case"input":Z8(n,a),s=nk(n,a),ua("invalid",n);break;case"option":s=a;break;case"select":n._wrapperState={wasMultiple:!!a.multiple},s=Na({},a,{value:void 0}),ua("invalid",n);break;case"textarea":J8(n,a),s=ak(n,a),ua("invalid",n);break;default:s=a}sk(i,s),f=s;for(l in f)if(f.hasOwnProperty(l)){var p=f[l];l==="style"?Zj(n,p):l==="dangerouslySetInnerHTML"?(p=p?p.__html:void 0,p!=null&&qj(n,p)):l==="children"?typeof p=="string"?(i!=="textarea"||p!=="")&&Ob(n,p):typeof p=="number"&&Ob(n,""+p):l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&l!=="autoFocus"&&(zb.hasOwnProperty(l)?p!=null&&l==="onScroll"&&ua("scroll",n):p!=null&&TD(n,l,p,d))}switch(i){case"input":c3(n),K8(n,a,!1);break;case"textarea":c3(n),Q8(n);break;case"option":a.value!=null&&n.setAttribute("value",""+wp(a.value));break;case"select":n.multiple=!!a.multiple,l=a.value,l!=null?W0(n,!!a.multiple,l,!1):a.defaultValue!=null&&W0(n,!!a.multiple,a.defaultValue,!0);break;default:typeof s.onClick=="function"&&(n.onclick=BM)}switch(i){case"button":case"input":case"select":case"textarea":a=!!a.autoFocus;break e;case"img":a=!0;break e;default:a=!1}}a&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return gs(e),null;case 6:if(n&&e.stateNode!=null)xY(n,e,n.memoizedProps,a);else{if(typeof a!="string"&&e.stateNode===null)throw Error(pn(166));if(i=gg(Yb.current),gg(vd.current),v3(e)){if(a=e.stateNode,i=e.memoizedProps,a[hd]=e,(l=a.nodeValue!==i)&&(n=Ql,n!==null))switch(n.tag){case 3:y3(a.nodeValue,i,(n.mode&1)!==0);break;case 5:n.memoizedProps.suppressHydrationWarning!==!0&&y3(a.nodeValue,i,(n.mode&1)!==0)}l&&(e.flags|=4)}else a=(i.nodeType===9?i:i.ownerDocument).createTextNode(a),a[hd]=e,e.stateNode=a}return gs(e),null;case 13:if(fa(La),a=e.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(wa&&Jl!==null&&e.mode&1&&!(e.flags&128))N$(),i_(),e.flags|=98560,l=!1;else if(l=v3(e),a!==null&&a.dehydrated!==null){if(n===null){if(!l)throw Error(pn(318));if(l=e.memoizedState,l=l!==null?l.dehydrated:null,!l)throw Error(pn(317));l[hd]=e}else i_(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;gs(e),l=!1}else fu!==null&&(Vk(fu),fu=null),l=!0;if(!l)return e.flags&65536?e:null}return e.flags&128?(e.lanes=i,e):(a=a!==null,a!==(n!==null&&n.memoizedState!==null)&&a&&(e.child.flags|=8192,e.mode&1&&(n===null||La.current&1?Do===0&&(Do=3):l4())),e.updateQueue!==null&&(e.flags|=4),gs(e),null);case 4:return a_(),Dk(n,e),n===null&&Gb(e.stateNode.containerInfo),gs(e),null;case 10:return jD(e.type._context),gs(e),null;case 17:return Sl(e.type)&&UM(),gs(e),null;case 19:if(fa(La),l=e.memoizedState,l===null)return gs(e),null;if(a=(e.flags&128)!==0,d=l.rendering,d===null)if(a)rx(l,!1);else{if(Do!==0||n!==null&&n.flags&128)for(n=e.child;n!==null;){if(d=YM(n),d!==null){for(e.flags|=128,rx(l,!1),a=d.updateQueue,a!==null&&(e.updateQueue=a,e.flags|=4),e.subtreeFlags=0,a=i,i=e.child;i!==null;)l=i,n=a,l.flags&=14680066,d=l.alternate,d===null?(l.childLanes=0,l.lanes=n,l.child=null,l.subtreeFlags=0,l.memoizedProps=null,l.memoizedState=null,l.updateQueue=null,l.dependencies=null,l.stateNode=null):(l.childLanes=d.childLanes,l.lanes=d.lanes,l.child=d.child,l.subtreeFlags=0,l.deletions=null,l.memoizedProps=d.memoizedProps,l.memoizedState=d.memoizedState,l.updateQueue=d.updateQueue,l.type=d.type,n=d.dependencies,l.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),i=i.sibling;return oa(La,La.current&1|2),e.child}n=n.sibling}l.tail!==null&&uo()>s_&&(e.flags|=128,a=!0,rx(l,!1),e.lanes=4194304)}else{if(!a)if(n=YM(d),n!==null){if(e.flags|=128,a=!0,i=n.updateQueue,i!==null&&(e.updateQueue=i,e.flags|=4),rx(l,!0),l.tail===null&&l.tailMode==="hidden"&&!d.alternate&&!wa)return gs(e),null}else 2*uo()-l.renderingStartTime>s_&&i!==1073741824&&(e.flags|=128,a=!0,rx(l,!1),e.lanes=4194304);l.isBackwards?(d.sibling=e.child,e.child=d):(i=l.last,i!==null?i.sibling=d:e.child=d,l.last=d)}return l.tail!==null?(e=l.tail,l.rendering=e,l.tail=e.sibling,l.renderingStartTime=uo(),e.sibling=null,i=La.current,oa(La,a?i&1|2:i&1),e):(gs(e),null);case 22:case 23:return s4(),a=e.memoizedState!==null,n!==null&&n.memoizedState!==null!==a&&(e.flags|=8192),a&&e.mode&1?$l&1073741824&&(gs(e),e.subtreeFlags&6&&(e.flags|=8192)):gs(e),null;case 24:return null;case 25:return null}throw Error(pn(156,e.tag))}function Jle(n,e){switch(WD(e),e.tag){case 1:return Sl(e.type)&&UM(),n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 3:return a_(),fa(wl),fa(Cs),ZD(),n=e.flags,n&65536&&!(n&128)?(e.flags=n&-65537|128,e):null;case 5:return XD(e),null;case 13:if(fa(La),n=e.memoizedState,n!==null&&n.dehydrated!==null){if(e.alternate===null)throw Error(pn(340));i_()}return n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 19:return fa(La),null;case 4:return a_(),null;case 10:return jD(e.type._context),null;case 22:case 23:return s4(),null;case 24:return null;default:return null}}var b3=!1,ws=!1,Qle=typeof WeakSet=="function"?WeakSet:Set,Bn=null;function L0(n,e){var i=n.ref;if(i!==null)if(typeof i=="function")try{i(null)}catch(a){Ya(n,e,a)}else i.current=null}function zk(n,e,i){try{i()}catch(a){Ya(n,e,a)}}var VW=!1;function ece(n,e){if(vk=OM,n=E$(),BD(n)){if("selectionStart"in n)var i={start:n.selectionStart,end:n.selectionEnd};else e:{i=(i=n.ownerDocument)&&i.defaultView||window;var a=i.getSelection&&i.getSelection();if(a&&a.rangeCount!==0){i=a.anchorNode;var s=a.anchorOffset,l=a.focusNode;a=a.focusOffset;try{i.nodeType,l.nodeType}catch{i=null;break e}var d=0,f=-1,p=-1,y=0,_=0,b=n,S=null;t:for(;;){for(var A;b!==i||s!==0&&b.nodeType!==3||(f=d+s),b!==l||a!==0&&b.nodeType!==3||(p=d+a),b.nodeType===3&&(d+=b.nodeValue.length),(A=b.firstChild)!==null;)S=b,b=A;for(;;){if(b===n)break t;if(S===i&&++y===s&&(f=d),S===l&&++_===a&&(p=d),(A=b.nextSibling)!==null)break;b=S,S=b.parentNode}b=A}i=f===-1||p===-1?null:{start:f,end:p}}else i=null}i=i||{start:0,end:0}}else i=null;for(_k={focusedElem:n,selectionRange:i},OM=!1,Bn=e;Bn!==null;)if(e=Bn,n=e.child,(e.subtreeFlags&1028)!==0&&n!==null)n.return=e,Bn=n;else for(;Bn!==null;){e=Bn;try{var P=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(P!==null){var L=P.memoizedProps,k=P.memoizedState,R=e.stateNode,z=R.getSnapshotBeforeUpdate(e.elementType===e.type?L:cu(e.type,L),k);R.__reactInternalSnapshotBeforeUpdate=z}break;case 3:var O=e.stateNode.containerInfo;O.nodeType===1?O.textContent="":O.nodeType===9&&O.documentElement&&O.removeChild(O.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(pn(163))}}catch(F){Ya(e,e.return,F)}if(n=e.sibling,n!==null){n.return=e.return,Bn=n;break}Bn=e.return}return P=VW,VW=!1,P}function sb(n,e,i){var a=e.updateQueue;if(a=a!==null?a.lastEffect:null,a!==null){var s=a=a.next;do{if((s.tag&n)===n){var l=s.destroy;s.destroy=void 0,l!==void 0&&zk(e,i,l)}s=s.next}while(s!==a)}}function UT(n,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var i=e=e.next;do{if((i.tag&n)===n){var a=i.create;i.destroy=a()}i=i.next}while(i!==e)}}function Ok(n){var e=n.ref;if(e!==null){var i=n.stateNode;switch(n.tag){case 5:n=i;break;default:n=i}typeof e=="function"?e(n):e.current=n}}function bY(n){var e=n.alternate;e!==null&&(n.alternate=null,bY(e)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(e=n.stateNode,e!==null&&(delete e[hd],delete e[jb],delete e[wk],delete e[Ole],delete e[Nle])),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}function wY(n){return n.tag===5||n.tag===3||n.tag===4}function GW(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||wY(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function Nk(n,e,i){var a=n.tag;if(a===5||a===6)n=n.stateNode,e?i.nodeType===8?i.parentNode.insertBefore(n,e):i.insertBefore(n,e):(i.nodeType===8?(e=i.parentNode,e.insertBefore(n,i)):(e=i,e.appendChild(n)),i=i._reactRootContainer,i!=null||e.onclick!==null||(e.onclick=BM));else if(a!==4&&(n=n.child,n!==null))for(Nk(n,e,i),n=n.sibling;n!==null;)Nk(n,e,i),n=n.sibling}function Fk(n,e,i){var a=n.tag;if(a===5||a===6)n=n.stateNode,e?i.insertBefore(n,e):i.appendChild(n);else if(a!==4&&(n=n.child,n!==null))for(Fk(n,e,i),n=n.sibling;n!==null;)Fk(n,e,i),n=n.sibling}var es=null,du=!1;function Wf(n,e,i){for(i=i.child;i!==null;)SY(n,e,i),i=i.sibling}function SY(n,e,i){if(yd&&typeof yd.onCommitFiberUnmount=="function")try{yd.onCommitFiberUnmount(LT,i)}catch{}switch(i.tag){case 5:ws||L0(i,e);case 6:var a=es,s=du;es=null,Wf(n,e,i),es=a,du=s,es!==null&&(du?(n=es,i=i.stateNode,n.nodeType===8?n.parentNode.removeChild(i):n.removeChild(i)):es.removeChild(i.stateNode));break;case 18:es!==null&&(du?(n=es,i=i.stateNode,n.nodeType===8?fR(n.parentNode,i):n.nodeType===1&&fR(n,i),Ub(n)):fR(es,i.stateNode));break;case 4:a=es,s=du,es=i.stateNode.containerInfo,du=!0,Wf(n,e,i),es=a,du=s;break;case 0:case 11:case 14:case 15:if(!ws&&(a=i.updateQueue,a!==null&&(a=a.lastEffect,a!==null))){s=a=a.next;do{var l=s,d=l.destroy;l=l.tag,d!==void 0&&(l&2||l&4)&&zk(i,e,d),s=s.next}while(s!==a)}Wf(n,e,i);break;case 1:if(!ws&&(L0(i,e),a=i.stateNode,typeof a.componentWillUnmount=="function"))try{a.props=i.memoizedProps,a.state=i.memoizedState,a.componentWillUnmount()}catch(f){Ya(i,e,f)}Wf(n,e,i);break;case 21:Wf(n,e,i);break;case 22:i.mode&1?(ws=(a=ws)||i.memoizedState!==null,Wf(n,e,i),ws=a):Wf(n,e,i);break;default:Wf(n,e,i)}}function HW(n){var e=n.updateQueue;if(e!==null){n.updateQueue=null;var i=n.stateNode;i===null&&(i=n.stateNode=new Qle),e.forEach(function(a){var s=cce.bind(null,n,a);i.has(a)||(i.add(a),a.then(s,s))})}}function au(n,e){var i=e.deletions;if(i!==null)for(var a=0;a<i.length;a++){var s=i[a];try{var l=n,d=e,f=d;e:for(;f!==null;){switch(f.tag){case 5:es=f.stateNode,du=!1;break e;case 3:es=f.stateNode.containerInfo,du=!0;break e;case 4:es=f.stateNode.containerInfo,du=!0;break e}f=f.return}if(es===null)throw Error(pn(160));SY(l,d,s),es=null,du=!1;var p=s.alternate;p!==null&&(p.return=null),s.return=null}catch(y){Ya(s,e,y)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)EY(e,n),e=e.sibling}function EY(n,e){var i=n.alternate,a=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:if(au(e,n),od(n),a&4){try{sb(3,n,n.return),UT(3,n)}catch(L){Ya(n,n.return,L)}try{sb(5,n,n.return)}catch(L){Ya(n,n.return,L)}}break;case 1:au(e,n),od(n),a&512&&i!==null&&L0(i,i.return);break;case 5:if(au(e,n),od(n),a&512&&i!==null&&L0(i,i.return),n.flags&32){var s=n.stateNode;try{Ob(s,"")}catch(L){Ya(n,n.return,L)}}if(a&4&&(s=n.stateNode,s!=null)){var l=n.memoizedProps,d=i!==null?i.memoizedProps:l,f=n.type,p=n.updateQueue;if(n.updateQueue=null,p!==null)try{f==="input"&&l.type==="radio"&&l.name!=null&&jj(s,l),lk(f,d);var y=lk(f,l);for(d=0;d<p.length;d+=2){var _=p[d],b=p[d+1];_==="style"?Zj(s,b):_==="dangerouslySetInnerHTML"?qj(s,b):_==="children"?Ob(s,b):TD(s,_,b,y)}switch(f){case"input":ik(s,l);break;case"textarea":$j(s,l);break;case"select":var S=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!l.multiple;var A=l.value;A!=null?W0(s,!!l.multiple,A,!1):S!==!!l.multiple&&(l.defaultValue!=null?W0(s,!!l.multiple,l.defaultValue,!0):W0(s,!!l.multiple,l.multiple?[]:"",!1))}s[jb]=l}catch(L){Ya(n,n.return,L)}}break;case 6:if(au(e,n),od(n),a&4){if(n.stateNode===null)throw Error(pn(162));s=n.stateNode,l=n.memoizedProps;try{s.nodeValue=l}catch(L){Ya(n,n.return,L)}}break;case 3:if(au(e,n),od(n),a&4&&i!==null&&i.memoizedState.isDehydrated)try{Ub(e.containerInfo)}catch(L){Ya(n,n.return,L)}break;case 4:au(e,n),od(n);break;case 13:au(e,n),od(n),s=n.child,s.flags&8192&&(l=s.memoizedState!==null,s.stateNode.isHidden=l,!l||s.alternate!==null&&s.alternate.memoizedState!==null||(a4=uo())),a&4&&HW(n);break;case 22:if(_=i!==null&&i.memoizedState!==null,n.mode&1?(ws=(y=ws)||_,au(e,n),ws=y):au(e,n),od(n),a&8192){if(y=n.memoizedState!==null,(n.stateNode.isHidden=y)&&!_&&n.mode&1)for(Bn=n,_=n.child;_!==null;){for(b=Bn=_;Bn!==null;){switch(S=Bn,A=S.child,S.tag){case 0:case 11:case 14:case 15:sb(4,S,S.return);break;case 1:L0(S,S.return);var P=S.stateNode;if(typeof P.componentWillUnmount=="function"){a=S,i=S.return;try{e=a,P.props=e.memoizedProps,P.state=e.memoizedState,P.componentWillUnmount()}catch(L){Ya(a,i,L)}}break;case 5:L0(S,S.return);break;case 22:if(S.memoizedState!==null){$W(b);continue}}A!==null?(A.return=S,Bn=A):$W(b)}_=_.sibling}e:for(_=null,b=n;;){if(b.tag===5){if(_===null){_=b;try{s=b.stateNode,y?(l=s.style,typeof l.setProperty=="function"?l.setProperty("display","none","important"):l.display="none"):(f=b.stateNode,p=b.memoizedProps.style,d=p!=null&&p.hasOwnProperty("display")?p.display:null,f.style.display=Xj("display",d))}catch(L){Ya(n,n.return,L)}}}else if(b.tag===6){if(_===null)try{b.stateNode.nodeValue=y?"":b.memoizedProps}catch(L){Ya(n,n.return,L)}}else if((b.tag!==22&&b.tag!==23||b.memoizedState===null||b===n)&&b.child!==null){b.child.return=b,b=b.child;continue}if(b===n)break e;for(;b.sibling===null;){if(b.return===null||b.return===n)break e;_===b&&(_=null),b=b.return}_===b&&(_=null),b.sibling.return=b.return,b=b.sibling}}break;case 19:au(e,n),od(n),a&4&&HW(n);break;case 21:break;default:au(e,n),od(n)}}function od(n){var e=n.flags;if(e&2){try{e:{for(var i=n.return;i!==null;){if(wY(i)){var a=i;break e}i=i.return}throw Error(pn(160))}switch(a.tag){case 5:var s=a.stateNode;a.flags&32&&(Ob(s,""),a.flags&=-33);var l=GW(n);Fk(n,l,s);break;case 3:case 4:var d=a.stateNode.containerInfo,f=GW(n);Nk(n,f,d);break;default:throw Error(pn(161))}}catch(p){Ya(n,n.return,p)}n.flags&=-3}e&4096&&(n.flags&=-4097)}function tce(n,e,i){Bn=n,MY(n)}function MY(n,e,i){for(var a=(n.mode&1)!==0;Bn!==null;){var s=Bn,l=s.child;if(s.tag===22&&a){var d=s.memoizedState!==null||b3;if(!d){var f=s.alternate,p=f!==null&&f.memoizedState!==null||ws;f=b3;var y=ws;if(b3=d,(ws=p)&&!y)for(Bn=s;Bn!==null;)d=Bn,p=d.child,d.tag===22&&d.memoizedState!==null?YW(s):p!==null?(p.return=d,Bn=p):YW(s);for(;l!==null;)Bn=l,MY(l),l=l.sibling;Bn=s,b3=f,ws=y}jW(n)}else s.subtreeFlags&8772&&l!==null?(l.return=s,Bn=l):jW(n)}}function jW(n){for(;Bn!==null;){var e=Bn;if(e.flags&8772){var i=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:ws||UT(5,e);break;case 1:var a=e.stateNode;if(e.flags&4&&!ws)if(i===null)a.componentDidMount();else{var s=e.elementType===e.type?i.memoizedProps:cu(e.type,i.memoizedProps);a.componentDidUpdate(s,i.memoizedState,a.__reactInternalSnapshotBeforeUpdate)}var l=e.updateQueue;l!==null&&CW(e,l,a);break;case 3:var d=e.updateQueue;if(d!==null){if(i=null,e.child!==null)switch(e.child.tag){case 5:i=e.child.stateNode;break;case 1:i=e.child.stateNode}CW(e,d,i)}break;case 5:var f=e.stateNode;if(i===null&&e.flags&4){i=f;var p=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":p.autoFocus&&i.focus();break;case"img":p.src&&(i.src=p.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var y=e.alternate;if(y!==null){var _=y.memoizedState;if(_!==null){var b=_.dehydrated;b!==null&&Ub(b)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(pn(163))}ws||e.flags&512&&Ok(e)}catch(S){Ya(e,e.return,S)}}if(e===n){Bn=null;break}if(i=e.sibling,i!==null){i.return=e.return,Bn=i;break}Bn=e.return}}function $W(n){for(;Bn!==null;){var e=Bn;if(e===n){Bn=null;break}var i=e.sibling;if(i!==null){i.return=e.return,Bn=i;break}Bn=e.return}}function YW(n){for(;Bn!==null;){var e=Bn;try{switch(e.tag){case 0:case 11:case 15:var i=e.return;try{UT(4,e)}catch(p){Ya(e,i,p)}break;case 1:var a=e.stateNode;if(typeof a.componentDidMount=="function"){var s=e.return;try{a.componentDidMount()}catch(p){Ya(e,s,p)}}var l=e.return;try{Ok(e)}catch(p){Ya(e,l,p)}break;case 5:var d=e.return;try{Ok(e)}catch(p){Ya(e,d,p)}}}catch(p){Ya(e,e.return,p)}if(e===n){Bn=null;break}var f=e.sibling;if(f!==null){f.return=e.return,Bn=f;break}Bn=e.return}}var nce=Math.ceil,ZM=Xh.ReactCurrentDispatcher,i4=Xh.ReactCurrentOwner,Ic=Xh.ReactCurrentBatchConfig,pr=0,Ho=null,So=null,ns=0,$l=0,k0=kp(0),Do=0,Kb=null,Bg=0,WT=0,r4=0,lb=null,gl=null,a4=0,s_=1/0,Ah=null,KM=!1,Bk=null,pp=null,w3=!1,ip=null,JM=0,cb=0,Uk=null,iM=-1,rM=0;function qs(){return pr&6?uo():iM!==-1?iM:iM=uo()}function mp(n){return n.mode&1?pr&2&&ns!==0?ns&-ns:Ble.transition!==null?(rM===0&&(rM=l$()),rM):(n=Hr,n!==0||(n=window.event,n=n===void 0?16:m$(n.type)),n):1}function vu(n,e,i,a){if(50<cb)throw cb=0,Uk=null,Error(pn(185));Bw(n,i,a),(!(pr&2)||n!==Ho)&&(n===Ho&&(!(pr&2)&&(WT|=i),Do===4&&ep(n,ns)),El(n,a),i===1&&pr===0&&!(e.mode&1)&&(s_=uo()+500,NT&&Dp()))}function El(n,e){var i=n.callbackNode;Bse(n,e);var a=zM(n,n===Ho?ns:0);if(a===0)i!==null&&nW(i),n.callbackNode=null,n.callbackPriority=0;else if(e=a&-a,n.callbackPriority!==e){if(i!=null&&nW(i),e===1)n.tag===0?Fle(qW.bind(null,n)):D$(qW.bind(null,n)),Dle(function(){!(pr&6)&&Dp()}),i=null;else{switch(c$(a)){case 1:i=RD;break;case 4:i=o$;break;case 16:i=DM;break;case 536870912:i=s$;break;default:i=DM}i=kY(i,TY.bind(null,n))}n.callbackPriority=e,n.callbackNode=i}}function TY(n,e){if(iM=-1,rM=0,pr&6)throw Error(pn(327));var i=n.callbackNode;if($0()&&n.callbackNode!==i)return null;var a=zM(n,n===Ho?ns:0);if(a===0)return null;if(a&30||a&n.expiredLanes||e)e=QM(n,a);else{e=a;var s=pr;pr|=2;var l=CY();(Ho!==n||ns!==e)&&(Ah=null,s_=uo()+500,Tg(n,e));do try{ace();break}catch(f){AY(n,f)}while(1);HD(),ZM.current=l,pr=s,So!==null?e=0:(Ho=null,ns=0,e=Do)}if(e!==0){if(e===2&&(s=fk(n),s!==0&&(a=s,e=Wk(n,s))),e===1)throw i=Kb,Tg(n,0),ep(n,a),El(n,uo()),i;if(e===6)ep(n,a);else{if(s=n.current.alternate,!(a&30)&&!ice(s)&&(e=QM(n,a),e===2&&(l=fk(n),l!==0&&(a=l,e=Wk(n,l))),e===1))throw i=Kb,Tg(n,0),ep(n,a),El(n,uo()),i;switch(n.finishedWork=s,n.finishedLanes=a,e){case 0:case 1:throw Error(pn(345));case 2:rg(n,gl,Ah);break;case 3:if(ep(n,a),(a&130023424)===a&&(e=a4+500-uo(),10<e)){if(zM(n,0)!==0)break;if(s=n.suspendedLanes,(s&a)!==a){qs(),n.pingedLanes|=n.suspendedLanes&s;break}n.timeoutHandle=bk(rg.bind(null,n,gl,Ah),e);break}rg(n,gl,Ah);break;case 4:if(ep(n,a),(a&4194240)===a)break;for(e=n.eventTimes,s=-1;0<a;){var d=31-yu(a);l=1<<d,d=e[d],d>s&&(s=d),a&=~l}if(a=s,a=uo()-a,a=(120>a?120:480>a?480:1080>a?1080:1920>a?1920:3e3>a?3e3:4320>a?4320:1960*nce(a/1960))-a,10<a){n.timeoutHandle=bk(rg.bind(null,n,gl,Ah),a);break}rg(n,gl,Ah);break;case 5:rg(n,gl,Ah);break;default:throw Error(pn(329))}}}return El(n,uo()),n.callbackNode===i?TY.bind(null,n):null}function Wk(n,e){var i=lb;return n.current.memoizedState.isDehydrated&&(Tg(n,e).flags|=256),n=QM(n,e),n!==2&&(e=gl,gl=i,e!==null&&Vk(e)),n}function Vk(n){gl===null?gl=n:gl.push.apply(gl,n)}function ice(n){for(var e=n;;){if(e.flags&16384){var i=e.updateQueue;if(i!==null&&(i=i.stores,i!==null))for(var a=0;a<i.length;a++){var s=i[a],l=s.getSnapshot;s=s.value;try{if(!xu(l(),s))return!1}catch{return!1}}}if(i=e.child,e.subtreeFlags&16384&&i!==null)i.return=e,e=i;else{if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function ep(n,e){for(e&=~r4,e&=~WT,n.suspendedLanes|=e,n.pingedLanes&=~e,n=n.expirationTimes;0<e;){var i=31-yu(e),a=1<<i;n[i]=-1,e&=~a}}function qW(n){if(pr&6)throw Error(pn(327));$0();var e=zM(n,0);if(!(e&1))return El(n,uo()),null;var i=QM(n,e);if(n.tag!==0&&i===2){var a=fk(n);a!==0&&(e=a,i=Wk(n,a))}if(i===1)throw i=Kb,Tg(n,0),ep(n,e),El(n,uo()),i;if(i===6)throw Error(pn(345));return n.finishedWork=n.current.alternate,n.finishedLanes=e,rg(n,gl,Ah),El(n,uo()),null}function o4(n,e){var i=pr;pr|=1;try{return n(e)}finally{pr=i,pr===0&&(s_=uo()+500,NT&&Dp())}}function Ug(n){ip!==null&&ip.tag===0&&!(pr&6)&&$0();var e=pr;pr|=1;var i=Ic.transition,a=Hr;try{if(Ic.transition=null,Hr=1,n)return n()}finally{Hr=a,Ic.transition=i,pr=e,!(pr&6)&&Dp()}}function s4(){$l=k0.current,fa(k0)}function Tg(n,e){n.finishedWork=null,n.finishedLanes=0;var i=n.timeoutHandle;if(i!==-1&&(n.timeoutHandle=-1,kle(i)),So!==null)for(i=So.return;i!==null;){var a=i;switch(WD(a),a.tag){case 1:a=a.type.childContextTypes,a!=null&&UM();break;case 3:a_(),fa(wl),fa(Cs),ZD();break;case 5:XD(a);break;case 4:a_();break;case 13:fa(La);break;case 19:fa(La);break;case 10:jD(a.type._context);break;case 22:case 23:s4()}i=i.return}if(Ho=n,So=n=gp(n.current,null),ns=$l=e,Do=0,Kb=null,r4=WT=Bg=0,gl=lb=null,mg!==null){for(e=0;e<mg.length;e++)if(i=mg[e],a=i.interleaved,a!==null){i.interleaved=null;var s=a.next,l=i.pending;if(l!==null){var d=l.next;l.next=s,a.next=d}i.pending=a}mg=null}return n}function AY(n,e){do{var i=So;try{if(HD(),eM.current=XM,qM){for(var a=za.memoizedState;a!==null;){var s=a.queue;s!==null&&(s.pending=null),a=a.next}qM=!1}if(Fg=0,Vo=Ro=za=null,ob=!1,qb=0,i4.current=null,i===null||i.return===null){Do=1,Kb=e,So=null;break}e:{var l=n,d=i.return,f=i,p=e;if(e=ns,f.flags|=32768,p!==null&&typeof p=="object"&&typeof p.then=="function"){var y=p,_=f,b=_.tag;if(!(_.mode&1)&&(b===0||b===11||b===15)){var S=_.alternate;S?(_.updateQueue=S.updateQueue,_.memoizedState=S.memoizedState,_.lanes=S.lanes):(_.updateQueue=null,_.memoizedState=null)}var A=zW(d);if(A!==null){A.flags&=-257,OW(A,d,f,l,e),A.mode&1&&DW(l,y,e),e=A,p=y;var P=e.updateQueue;if(P===null){var L=new Set;L.add(p),e.updateQueue=L}else P.add(p);break e}else{if(!(e&1)){DW(l,y,e),l4();break e}p=Error(pn(426))}}else if(wa&&f.mode&1){var k=zW(d);if(k!==null){!(k.flags&65536)&&(k.flags|=256),OW(k,d,f,l,e),VD(o_(p,f));break e}}l=p=o_(p,f),Do!==4&&(Do=2),lb===null?lb=[l]:lb.push(l),l=d;do{switch(l.tag){case 3:l.flags|=65536,e&=-e,l.lanes|=e;var R=uY(l,p,e);AW(l,R);break e;case 1:f=p;var z=l.type,O=l.stateNode;if(!(l.flags&128)&&(typeof z.getDerivedStateFromError=="function"||O!==null&&typeof O.componentDidCatch=="function"&&(pp===null||!pp.has(O)))){l.flags|=65536,e&=-e,l.lanes|=e;var F=dY(l,f,e);AW(l,F);break e}}l=l.return}while(l!==null)}IY(i)}catch(H){e=H,So===i&&i!==null&&(So=i=i.return);continue}break}while(1)}function CY(){var n=ZM.current;return ZM.current=XM,n===null?XM:n}function l4(){(Do===0||Do===3||Do===2)&&(Do=4),Ho===null||!(Bg&268435455)&&!(WT&268435455)||ep(Ho,ns)}function QM(n,e){var i=pr;pr|=2;var a=CY();(Ho!==n||ns!==e)&&(Ah=null,Tg(n,e));do try{rce();break}catch(s){AY(n,s)}while(1);if(HD(),pr=i,ZM.current=a,So!==null)throw Error(pn(261));return Ho=null,ns=0,Do}function rce(){for(;So!==null;)PY(So)}function ace(){for(;So!==null&&!Ise();)PY(So)}function PY(n){var e=LY(n.alternate,n,$l);n.memoizedProps=n.pendingProps,e===null?IY(n):So=e,i4.current=null}function IY(n){var e=n;do{var i=e.alternate;if(n=e.return,e.flags&32768){if(i=Jle(i,e),i!==null){i.flags&=32767,So=i;return}if(n!==null)n.flags|=32768,n.subtreeFlags=0,n.deletions=null;else{Do=6,So=null;return}}else if(i=Kle(i,e,$l),i!==null){So=i;return}if(e=e.sibling,e!==null){So=e;return}So=e=n}while(e!==null);Do===0&&(Do=5)}function rg(n,e,i){var a=Hr,s=Ic.transition;try{Ic.transition=null,Hr=1,oce(n,e,i,a)}finally{Ic.transition=s,Hr=a}return null}function oce(n,e,i,a){do $0();while(ip!==null);if(pr&6)throw Error(pn(327));i=n.finishedWork;var s=n.finishedLanes;if(i===null)return null;if(n.finishedWork=null,n.finishedLanes=0,i===n.current)throw Error(pn(177));n.callbackNode=null,n.callbackPriority=0;var l=i.lanes|i.childLanes;if(Use(n,l),n===Ho&&(So=Ho=null,ns=0),!(i.subtreeFlags&2064)&&!(i.flags&2064)||w3||(w3=!0,kY(DM,function(){return $0(),null})),l=(i.flags&15990)!==0,i.subtreeFlags&15990||l){l=Ic.transition,Ic.transition=null;var d=Hr;Hr=1;var f=pr;pr|=4,i4.current=null,ece(n,i),EY(i,n),Tle(_k),OM=!!vk,_k=vk=null,n.current=i,tce(i),Rse(),pr=f,Hr=d,Ic.transition=l}else n.current=i;if(w3&&(w3=!1,ip=n,JM=s),l=n.pendingLanes,l===0&&(pp=null),Dse(i.stateNode),El(n,uo()),e!==null)for(a=n.onRecoverableError,i=0;i<e.length;i++)s=e[i],a(s.value,{componentStack:s.stack,digest:s.digest});if(KM)throw KM=!1,n=Bk,Bk=null,n;return JM&1&&n.tag!==0&&$0(),l=n.pendingLanes,l&1?n===Uk?cb++:(cb=0,Uk=n):cb=0,Dp(),null}function $0(){if(ip!==null){var n=c$(JM),e=Ic.transition,i=Hr;try{if(Ic.transition=null,Hr=16>n?16:n,ip===null)var a=!1;else{if(n=ip,ip=null,JM=0,pr&6)throw Error(pn(331));var s=pr;for(pr|=4,Bn=n.current;Bn!==null;){var l=Bn,d=l.child;if(Bn.flags&16){var f=l.deletions;if(f!==null){for(var p=0;p<f.length;p++){var y=f[p];for(Bn=y;Bn!==null;){var _=Bn;switch(_.tag){case 0:case 11:case 15:sb(8,_,l)}var b=_.child;if(b!==null)b.return=_,Bn=b;else for(;Bn!==null;){_=Bn;var S=_.sibling,A=_.return;if(bY(_),_===y){Bn=null;break}if(S!==null){S.return=A,Bn=S;break}Bn=A}}}var P=l.alternate;if(P!==null){var L=P.child;if(L!==null){P.child=null;do{var k=L.sibling;L.sibling=null,L=k}while(L!==null)}}Bn=l}}if(l.subtreeFlags&2064&&d!==null)d.return=l,Bn=d;else e:for(;Bn!==null;){if(l=Bn,l.flags&2048)switch(l.tag){case 0:case 11:case 15:sb(9,l,l.return)}var R=l.sibling;if(R!==null){R.return=l.return,Bn=R;break e}Bn=l.return}}var z=n.current;for(Bn=z;Bn!==null;){d=Bn;var O=d.child;if(d.subtreeFlags&2064&&O!==null)O.return=d,Bn=O;else e:for(d=z;Bn!==null;){if(f=Bn,f.flags&2048)try{switch(f.tag){case 0:case 11:case 15:UT(9,f)}}catch(H){Ya(f,f.return,H)}if(f===d){Bn=null;break e}var F=f.sibling;if(F!==null){F.return=f.return,Bn=F;break e}Bn=f.return}}if(pr=s,Dp(),yd&&typeof yd.onPostCommitFiberRoot=="function")try{yd.onPostCommitFiberRoot(LT,n)}catch{}a=!0}return a}finally{Hr=i,Ic.transition=e}}return!1}function XW(n,e,i){e=o_(i,e),e=uY(n,e,1),n=fp(n,e,1),e=qs(),n!==null&&(Bw(n,1,e),El(n,e))}function Ya(n,e,i){if(n.tag===3)XW(n,n,i);else for(;e!==null;){if(e.tag===3){XW(e,n,i);break}else if(e.tag===1){var a=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof a.componentDidCatch=="function"&&(pp===null||!pp.has(a))){n=o_(i,n),n=dY(e,n,1),e=fp(e,n,1),n=qs(),e!==null&&(Bw(e,1,n),El(e,n));break}}e=e.return}}function sce(n,e,i){var a=n.pingCache;a!==null&&a.delete(e),e=qs(),n.pingedLanes|=n.suspendedLanes&i,Ho===n&&(ns&i)===i&&(Do===4||Do===3&&(ns&130023424)===ns&&500>uo()-a4?Tg(n,0):r4|=i),El(n,e)}function RY(n,e){e===0&&(n.mode&1?(e=h3,h3<<=1,!(h3&130023424)&&(h3=4194304)):e=1);var i=qs();n=Hh(n,e),n!==null&&(Bw(n,e,i),El(n,i))}function lce(n){var e=n.memoizedState,i=0;e!==null&&(i=e.retryLane),RY(n,i)}function cce(n,e){var i=0;switch(n.tag){case 13:var a=n.stateNode,s=n.memoizedState;s!==null&&(i=s.retryLane);break;case 19:a=n.stateNode;break;default:throw Error(pn(314))}a!==null&&a.delete(e),RY(n,i)}var LY;LY=function(n,e,i){if(n!==null)if(n.memoizedProps!==e.pendingProps||wl.current)bl=!0;else{if(!(n.lanes&i)&&!(e.flags&128))return bl=!1,Zle(n,e,i);bl=!!(n.flags&131072)}else bl=!1,wa&&e.flags&1048576&&z$(e,GM,e.index);switch(e.lanes=0,e.tag){case 2:var a=e.type;nM(n,e),n=e.pendingProps;var s=n_(e,Cs.current);j0(e,i),s=JD(null,e,a,n,s,i);var l=QD();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Sl(a)?(l=!0,WM(e)):l=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,YD(e),s.updater=FT,e.stateNode=s,s._reactInternals=e,Ck(e,a,n,i),e=Rk(null,e,a,!0,l,i)):(e.tag=0,wa&&l&&UD(e),$s(null,e,s,i),e=e.child),e;case 16:a=e.elementType;e:{switch(nM(n,e),n=e.pendingProps,s=a._init,a=s(a._payload),e.type=a,s=e.tag=dce(a),n=cu(a,n),s){case 0:e=Ik(null,e,a,n,i);break e;case 1:e=BW(null,e,a,n,i);break e;case 11:e=NW(null,e,a,n,i);break e;case 14:e=FW(null,e,a,cu(a.type,n),i);break e}throw Error(pn(306,a,""))}return e;case 0:return a=e.type,s=e.pendingProps,s=e.elementType===a?s:cu(a,s),Ik(n,e,a,s,i);case 1:return a=e.type,s=e.pendingProps,s=e.elementType===a?s:cu(a,s),BW(n,e,a,s,i);case 3:e:{if(mY(e),n===null)throw Error(pn(387));a=e.pendingProps,l=e.memoizedState,s=l.element,B$(n,e),$M(e,a,null,i);var d=e.memoizedState;if(a=d.element,l.isDehydrated)if(l={element:a,isDehydrated:!1,cache:d.cache,pendingSuspenseBoundaries:d.pendingSuspenseBoundaries,transitions:d.transitions},e.updateQueue.baseState=l,e.memoizedState=l,e.flags&256){s=o_(Error(pn(423)),e),e=UW(n,e,a,i,s);break e}else if(a!==s){s=o_(Error(pn(424)),e),e=UW(n,e,a,i,s);break e}else for(Jl=hp(e.stateNode.containerInfo.firstChild),Ql=e,wa=!0,fu=null,i=G$(e,null,a,i),e.child=i;i;)i.flags=i.flags&-3|4096,i=i.sibling;else{if(i_(),a===s){e=jh(n,e,i);break e}$s(n,e,a,i)}e=e.child}return e;case 5:return H$(e),n===null&&Mk(e),a=e.type,s=e.pendingProps,l=n!==null?n.memoizedProps:null,d=s.children,xk(a,s)?d=null:l!==null&&xk(a,l)&&(e.flags|=32),pY(n,e),$s(n,e,d,i),e.child;case 6:return n===null&&Mk(e),null;case 13:return gY(n,e,i);case 4:return qD(e,e.stateNode.containerInfo),a=e.pendingProps,n===null?e.child=r_(e,null,a,i):$s(n,e,a,i),e.child;case 11:return a=e.type,s=e.pendingProps,s=e.elementType===a?s:cu(a,s),NW(n,e,a,s,i);case 7:return $s(n,e,e.pendingProps,i),e.child;case 8:return $s(n,e,e.pendingProps.children,i),e.child;case 12:return $s(n,e,e.pendingProps.children,i),e.child;case 10:e:{if(a=e.type._context,s=e.pendingProps,l=e.memoizedProps,d=s.value,oa(HM,a._currentValue),a._currentValue=d,l!==null)if(xu(l.value,d)){if(l.children===s.children&&!wl.current){e=jh(n,e,i);break e}}else for(l=e.child,l!==null&&(l.return=e);l!==null;){var f=l.dependencies;if(f!==null){d=l.child;for(var p=f.firstContext;p!==null;){if(p.context===a){if(l.tag===1){p=Uh(-1,i&-i),p.tag=2;var y=l.updateQueue;if(y!==null){y=y.shared;var _=y.pending;_===null?p.next=p:(p.next=_.next,_.next=p),y.pending=p}}l.lanes|=i,p=l.alternate,p!==null&&(p.lanes|=i),Tk(l.return,i,e),f.lanes|=i;break}p=p.next}}else if(l.tag===10)d=l.type===e.type?null:l.child;else if(l.tag===18){if(d=l.return,d===null)throw Error(pn(341));d.lanes|=i,f=d.alternate,f!==null&&(f.lanes|=i),Tk(d,i,e),d=l.sibling}else d=l.child;if(d!==null)d.return=l;else for(d=l;d!==null;){if(d===e){d=null;break}if(l=d.sibling,l!==null){l.return=d.return,d=l;break}d=d.return}l=d}$s(n,e,s.children,i),e=e.child}return e;case 9:return s=e.type,a=e.pendingProps.children,j0(e,i),s=Lc(s),a=a(s),e.flags|=1,$s(n,e,a,i),e.child;case 14:return a=e.type,s=cu(a,e.pendingProps),s=cu(a.type,s),FW(n,e,a,s,i);case 15:return hY(n,e,e.type,e.pendingProps,i);case 17:return a=e.type,s=e.pendingProps,s=e.elementType===a?s:cu(a,s),nM(n,e),e.tag=1,Sl(a)?(n=!0,WM(e)):n=!1,j0(e,i),W$(e,a,s),Ck(e,a,s,i),Rk(null,e,a,!0,n,i);case 19:return yY(n,e,i);case 22:return fY(n,e,i)}throw Error(pn(156,e.tag))};function kY(n,e){return a$(n,e)}function uce(n,e,i,a){this.tag=n,this.key=i,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=a,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Pc(n,e,i,a){return new uce(n,e,i,a)}function c4(n){return n=n.prototype,!(!n||!n.isReactComponent)}function dce(n){if(typeof n=="function")return c4(n)?1:0;if(n!=null){if(n=n.$$typeof,n===CD)return 11;if(n===PD)return 14}return 2}function gp(n,e){var i=n.alternate;return i===null?(i=Pc(n.tag,e,n.key,n.mode),i.elementType=n.elementType,i.type=n.type,i.stateNode=n.stateNode,i.alternate=n,n.alternate=i):(i.pendingProps=e,i.type=n.type,i.flags=0,i.subtreeFlags=0,i.deletions=null),i.flags=n.flags&14680064,i.childLanes=n.childLanes,i.lanes=n.lanes,i.child=n.child,i.memoizedProps=n.memoizedProps,i.memoizedState=n.memoizedState,i.updateQueue=n.updateQueue,e=n.dependencies,i.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},i.sibling=n.sibling,i.index=n.index,i.ref=n.ref,i}function aM(n,e,i,a,s,l){var d=2;if(a=n,typeof n=="function")c4(n)&&(d=1);else if(typeof n=="string")d=5;else e:switch(n){case S0:return Ag(i.children,s,l,e);case AD:d=8,s|=8;break;case JL:return n=Pc(12,i,e,s|2),n.elementType=JL,n.lanes=l,n;case QL:return n=Pc(13,i,e,s),n.elementType=QL,n.lanes=l,n;case ek:return n=Pc(19,i,e,s),n.elementType=ek,n.lanes=l,n;case Vj:return VT(i,s,l,e);default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case Uj:d=10;break e;case Wj:d=9;break e;case CD:d=11;break e;case PD:d=14;break e;case Kf:d=16,a=null;break e}throw Error(pn(130,n==null?n:typeof n,""))}return e=Pc(d,i,e,s),e.elementType=n,e.type=a,e.lanes=l,e}function Ag(n,e,i,a){return n=Pc(7,n,a,e),n.lanes=i,n}function VT(n,e,i,a){return n=Pc(22,n,a,e),n.elementType=Vj,n.lanes=i,n.stateNode={isHidden:!1},n}function bR(n,e,i){return n=Pc(6,n,null,e),n.lanes=i,n}function wR(n,e,i){return e=Pc(4,n.children!==null?n.children:[],n.key,e),e.lanes=i,e.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},e}function hce(n,e,i,a,s){this.tag=e,this.containerInfo=n,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=nR(0),this.expirationTimes=nR(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=nR(0),this.identifierPrefix=a,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function u4(n,e,i,a,s,l,d,f,p){return n=new hce(n,e,i,f,p),e===1?(e=1,l===!0&&(e|=8)):e=0,l=Pc(3,null,null,e),n.current=l,l.stateNode=n,l.memoizedState={element:a,isDehydrated:i,cache:null,transitions:null,pendingSuspenseBoundaries:null},YD(l),n}function fce(n,e,i){var a=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:w0,key:a==null?null:""+a,children:n,containerInfo:e,implementation:i}}function DY(n){if(!n)return Sp;n=n._reactInternals;e:{if(ey(n)!==n||n.tag!==1)throw Error(pn(170));var e=n;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Sl(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(pn(171))}if(n.tag===1){var i=n.type;if(Sl(i))return k$(n,i,e)}return e}function zY(n,e,i,a,s,l,d,f,p){return n=u4(i,a,!0,n,s,l,d,f,p),n.context=DY(null),i=n.current,a=qs(),s=mp(i),l=Uh(a,s),l.callback=e??null,fp(i,l,s),n.current.lanes=s,Bw(n,s,a),El(n,a),n}function GT(n,e,i,a){var s=e.current,l=qs(),d=mp(s);return i=DY(i),e.context===null?e.context=i:e.pendingContext=i,e=Uh(l,d),e.payload={element:n},a=a===void 0?null:a,a!==null&&(e.callback=a),n=fp(s,e,d),n!==null&&(vu(n,s,d,l),QE(n,s,d)),d}function eT(n){if(n=n.current,!n.child)return null;switch(n.child.tag){case 5:return n.child.stateNode;default:return n.child.stateNode}}function ZW(n,e){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var i=n.retryLane;n.retryLane=i!==0&&i<e?i:e}}function d4(n,e){ZW(n,e),(n=n.alternate)&&ZW(n,e)}function pce(){return null}var OY=typeof reportError=="function"?reportError:function(n){console.error(n)};function h4(n){this._internalRoot=n}HT.prototype.render=h4.prototype.render=function(n){var e=this._internalRoot;if(e===null)throw Error(pn(409));GT(n,e,null,null)};HT.prototype.unmount=h4.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var e=n.containerInfo;Ug(function(){GT(null,n,null,null)}),e[Gh]=null}};function HT(n){this._internalRoot=n}HT.prototype.unstable_scheduleHydration=function(n){if(n){var e=h$();n={blockedOn:null,target:n,priority:e};for(var i=0;i<Qf.length&&e!==0&&e<Qf[i].priority;i++);Qf.splice(i,0,n),i===0&&p$(n)}};function f4(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function jT(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11&&(n.nodeType!==8||n.nodeValue!==" react-mount-point-unstable "))}function KW(){}function mce(n,e,i,a,s){if(s){if(typeof a=="function"){var l=a;a=function(){var y=eT(d);l.call(y)}}var d=zY(e,a,n,0,null,!1,!1,"",KW);return n._reactRootContainer=d,n[Gh]=d.current,Gb(n.nodeType===8?n.parentNode:n),Ug(),d}for(;s=n.lastChild;)n.removeChild(s);if(typeof a=="function"){var f=a;a=function(){var y=eT(p);f.call(y)}}var p=u4(n,0,!1,null,null,!1,!1,"",KW);return n._reactRootContainer=p,n[Gh]=p.current,Gb(n.nodeType===8?n.parentNode:n),Ug(function(){GT(e,p,i,a)}),p}function $T(n,e,i,a,s){var l=i._reactRootContainer;if(l){var d=l;if(typeof s=="function"){var f=s;s=function(){var p=eT(d);f.call(p)}}GT(e,d,n,s)}else d=mce(i,e,n,s,a);return eT(d)}u$=function(n){switch(n.tag){case 3:var e=n.stateNode;if(e.current.memoizedState.isDehydrated){var i=Vx(e.pendingLanes);i!==0&&(LD(e,i|1),El(e,uo()),!(pr&6)&&(s_=uo()+500,Dp()))}break;case 13:Ug(function(){var a=Hh(n,1);if(a!==null){var s=qs();vu(a,n,1,s)}}),d4(n,1)}};kD=function(n){if(n.tag===13){var e=Hh(n,134217728);if(e!==null){var i=qs();vu(e,n,134217728,i)}d4(n,134217728)}};d$=function(n){if(n.tag===13){var e=mp(n),i=Hh(n,e);if(i!==null){var a=qs();vu(i,n,e,a)}d4(n,e)}};h$=function(){return Hr};f$=function(n,e){var i=Hr;try{return Hr=n,e()}finally{Hr=i}};uk=function(n,e,i){switch(e){case"input":if(ik(n,i),e=i.name,i.type==="radio"&&e!=null){for(i=n;i.parentNode;)i=i.parentNode;for(i=i.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<i.length;e++){var a=i[e];if(a!==n&&a.form===n.form){var s=OT(a);if(!s)throw Error(pn(90));Hj(a),ik(a,s)}}}break;case"textarea":$j(n,i);break;case"select":e=i.value,e!=null&&W0(n,!!i.multiple,e,!1)}};Qj=o4;e$=Ug;var gce={usingClientEntryPoint:!1,Events:[Ww,A0,OT,Kj,Jj,o4]},ax={findFiberByHostInstance:pg,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},yce={bundleType:ax.bundleType,version:ax.version,rendererPackageName:ax.rendererPackageName,rendererConfig:ax.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Xh.ReactCurrentDispatcher,findHostInstanceByFiber:function(n){return n=i$(n),n===null?null:n.stateNode},findFiberByHostInstance:ax.findFiberByHostInstance||pce,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var S3=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!S3.isDisabled&&S3.supportsFiber)try{LT=S3.inject(yce),yd=S3}catch{}}rc.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=gce;rc.createPortal=function(n,e){var i=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!f4(e))throw Error(pn(200));return fce(n,e,null,i)};rc.createRoot=function(n,e){if(!f4(n))throw Error(pn(299));var i=!1,a="",s=OY;return e!=null&&(e.unstable_strictMode===!0&&(i=!0),e.identifierPrefix!==void 0&&(a=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=u4(n,1,!1,null,null,i,!1,a,s),n[Gh]=e.current,Gb(n.nodeType===8?n.parentNode:n),new h4(e)};rc.findDOMNode=function(n){if(n==null)return null;if(n.nodeType===1)return n;var e=n._reactInternals;if(e===void 0)throw typeof n.render=="function"?Error(pn(188)):(n=Object.keys(n).join(","),Error(pn(268,n)));return n=i$(e),n=n===null?null:n.stateNode,n};rc.flushSync=function(n){return Ug(n)};rc.hydrate=function(n,e,i){if(!jT(e))throw Error(pn(200));return $T(null,n,e,!0,i)};rc.hydrateRoot=function(n,e,i){if(!f4(n))throw Error(pn(405));var a=i!=null&&i.hydratedSources||null,s=!1,l="",d=OY;if(i!=null&&(i.unstable_strictMode===!0&&(s=!0),i.identifierPrefix!==void 0&&(l=i.identifierPrefix),i.onRecoverableError!==void 0&&(d=i.onRecoverableError)),e=zY(e,null,n,1,i??null,s,!1,l,d),n[Gh]=e.current,Gb(n),a)for(n=0;n<a.length;n++)i=a[n],s=i._getVersion,s=s(i._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[i,s]:e.mutableSourceEagerHydrationData.push(i,s);return new HT(e)};rc.render=function(n,e,i){if(!jT(e))throw Error(pn(200));return $T(null,n,e,!1,i)};rc.unmountComponentAtNode=function(n){if(!jT(n))throw Error(pn(40));return n._reactRootContainer?(Ug(function(){$T(null,null,n,!1,function(){n._reactRootContainer=null,n[Gh]=null})}),!0):!1};rc.unstable_batchedUpdates=o4;rc.unstable_renderSubtreeIntoContainer=function(n,e,i,a){if(!jT(i))throw Error(pn(200));if(n==null||n._reactInternals===void 0)throw Error(pn(38));return $T(n,e,i,!1,a)};rc.version="18.2.0-next-9e3b772b8-20220608";function NY(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(NY)}catch(n){console.error(n)}}NY(),zj.exports=rc;var Gw=zj.exports;const Hx=Nw(Gw),vce=Mj({__proto__:null,default:Hx},[Gw]);var JW=Gw;ZL.createRoot=JW.createRoot,ZL.hydrateRoot=JW.hydrateRoot;/**
 * @remix-run/router v1.12.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function qa(){return qa=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])}return n},qa.apply(this,arguments)}var so;(function(n){n.Pop="POP",n.Push="PUSH",n.Replace="REPLACE"})(so||(so={}));const QW="popstate";function _ce(n){n===void 0&&(n={});function e(s,l){let{pathname:d="/",search:f="",hash:p=""}=Rd(s.location.hash.substr(1));return!d.startsWith("/")&&!d.startsWith(".")&&(d="/"+d),Jb("",{pathname:d,search:f,hash:p},l.state&&l.state.usr||null,l.state&&l.state.key||"default")}function i(s,l){let d=s.document.querySelector("base"),f="";if(d&&d.getAttribute("href")){let p=s.location.href,y=p.indexOf("#");f=y===-1?p:p.slice(0,y)}return f+"#"+(typeof l=="string"?l:Hw(l))}function a(s,l){Ep(s.pathname.charAt(0)==="/","relative pathnames are not supported in hash history.push("+JSON.stringify(l)+")")}return bce(e,i,a,n)}function nr(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function Ep(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function xce(){return Math.random().toString(36).substr(2,8)}function e9(n,e){return{usr:n.state,key:n.key,idx:e}}function Jb(n,e,i,a){return i===void 0&&(i=null),qa({pathname:typeof n=="string"?n:n.pathname,search:"",hash:""},typeof e=="string"?Rd(e):e,{state:i,key:e&&e.key||a||xce()})}function Hw(n){let{pathname:e="/",search:i="",hash:a=""}=n;return i&&i!=="?"&&(e+=i.charAt(0)==="?"?i:"?"+i),a&&a!=="#"&&(e+=a.charAt(0)==="#"?a:"#"+a),e}function Rd(n){let e={};if(n){let i=n.indexOf("#");i>=0&&(e.hash=n.substr(i),n=n.substr(0,i));let a=n.indexOf("?");a>=0&&(e.search=n.substr(a),n=n.substr(0,a)),n&&(e.pathname=n)}return e}function bce(n,e,i,a){a===void 0&&(a={});let{window:s=document.defaultView,v5Compat:l=!1}=a,d=s.history,f=so.Pop,p=null,y=_();y==null&&(y=0,d.replaceState(qa({},d.state,{idx:y}),""));function _(){return(d.state||{idx:null}).idx}function b(){f=so.Pop;let k=_(),R=k==null?null:k-y;y=k,p&&p({action:f,location:L.location,delta:R})}function S(k,R){f=so.Push;let z=Jb(L.location,k,R);i&&i(z,k),y=_()+1;let O=e9(z,y),F=L.createHref(z);try{d.pushState(O,"",F)}catch(H){if(H instanceof DOMException&&H.name==="DataCloneError")throw H;s.location.assign(F)}l&&p&&p({action:f,location:L.location,delta:1})}function A(k,R){f=so.Replace;let z=Jb(L.location,k,R);i&&i(z,k),y=_();let O=e9(z,y),F=L.createHref(z);d.replaceState(O,"",F),l&&p&&p({action:f,location:L.location,delta:0})}function P(k){let R=s.location.origin!=="null"?s.location.origin:s.location.href,z=typeof k=="string"?k:Hw(k);return nr(R,"No window.location.(origin|href) available to create URL for href: "+z),new URL(z,R)}let L={get action(){return f},get location(){return n(s,d)},listen(k){if(p)throw new Error("A history only accepts one active listener");return s.addEventListener(QW,b),p=k,()=>{s.removeEventListener(QW,b),p=null}},createHref(k){return e(s,k)},createURL:P,encodeLocation(k){let R=P(k);return{pathname:R.pathname,search:R.search,hash:R.hash}},push:S,replace:A,go(k){return d.go(k)}};return L}var lo;(function(n){n.data="data",n.deferred="deferred",n.redirect="redirect",n.error="error"})(lo||(lo={}));const wce=new Set(["lazy","caseSensitive","path","id","index","children"]);function Sce(n){return n.index===!0}function Gk(n,e,i,a){return i===void 0&&(i=[]),a===void 0&&(a={}),n.map((s,l)=>{let d=[...i,l],f=typeof s.id=="string"?s.id:d.join("-");if(nr(s.index!==!0||!s.children,"Cannot specify children on an index route"),nr(!a[f],'Found a route id collision on id "'+f+`".  Route id's must be globally unique within Data Router usages`),Sce(s)){let p=qa({},s,e(s),{id:f});return a[f]=p,p}else{let p=qa({},s,e(s),{id:f,children:void 0});return a[f]=p,s.children&&(p.children=Gk(s.children,e,d,a)),p}})}function D0(n,e,i){i===void 0&&(i="/");let a=typeof e=="string"?Rd(e):e,s=jw(a.pathname||"/",i);if(s==null)return null;let l=FY(n);Mce(l);let d=null;for(let f=0;d==null&&f<l.length;++f)d=Dce(l[f],Nce(s));return d}function Ece(n,e){let{route:i,pathname:a,params:s}=n;return{id:i.id,pathname:a,params:s,data:e[i.id],handle:i.handle}}function FY(n,e,i,a){e===void 0&&(e=[]),i===void 0&&(i=[]),a===void 0&&(a="");let s=(l,d,f)=>{let p={relativePath:f===void 0?l.path||"":f,caseSensitive:l.caseSensitive===!0,childrenIndex:d,route:l};p.relativePath.startsWith("/")&&(nr(p.relativePath.startsWith(a),'Absolute route path "'+p.relativePath+'" nested under path '+('"'+a+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),p.relativePath=p.relativePath.slice(a.length));let y=yp([a,p.relativePath]),_=i.concat(p);l.children&&l.children.length>0&&(nr(l.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+y+'".')),FY(l.children,e,_,y)),!(l.path==null&&!l.index)&&e.push({path:y,score:Lce(y,l.index),routesMeta:_})};return n.forEach((l,d)=>{var f;if(l.path===""||!((f=l.path)!=null&&f.includes("?")))s(l,d);else for(let p of BY(l.path))s(l,d,p)}),e}function BY(n){let e=n.split("/");if(e.length===0)return[];let[i,...a]=e,s=i.endsWith("?"),l=i.replace(/\?$/,"");if(a.length===0)return s?[l,""]:[l];let d=BY(a.join("/")),f=[];return f.push(...d.map(p=>p===""?l:[l,p].join("/"))),s&&f.push(...d),f.map(p=>n.startsWith("/")&&p===""?"/":p)}function Mce(n){n.sort((e,i)=>e.score!==i.score?i.score-e.score:kce(e.routesMeta.map(a=>a.childrenIndex),i.routesMeta.map(a=>a.childrenIndex)))}const Tce=/^:\w+$/,Ace=3,Cce=2,Pce=1,Ice=10,Rce=-2,t9=n=>n==="*";function Lce(n,e){let i=n.split("/"),a=i.length;return i.some(t9)&&(a+=Rce),e&&(a+=Cce),i.filter(s=>!t9(s)).reduce((s,l)=>s+(Tce.test(l)?Ace:l===""?Pce:Ice),a)}function kce(n,e){return n.length===e.length&&n.slice(0,-1).every((a,s)=>a===e[s])?n[n.length-1]-e[e.length-1]:0}function Dce(n,e){let{routesMeta:i}=n,a={},s="/",l=[];for(let d=0;d<i.length;++d){let f=i[d],p=d===i.length-1,y=s==="/"?e:e.slice(s.length)||"/",_=zce({path:f.relativePath,caseSensitive:f.caseSensitive,end:p},y);if(!_)return null;Object.assign(a,_.params);let b=f.route;l.push({params:a,pathname:yp([s,_.pathname]),pathnameBase:Wce(yp([s,_.pathnameBase])),route:b}),_.pathnameBase!=="/"&&(s=yp([s,_.pathnameBase]))}return l}function zce(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[i,a]=Oce(n.path,n.caseSensitive,n.end),s=e.match(i);if(!s)return null;let l=s[0],d=l.replace(/(.)\/+$/,"$1"),f=s.slice(1);return{params:a.reduce((y,_,b)=>{let{paramName:S,isOptional:A}=_;if(S==="*"){let L=f[b]||"";d=l.slice(0,l.length-L.length).replace(/(.)\/+$/,"$1")}const P=f[b];return A&&!P?y[S]=void 0:y[S]=Fce(P||"",S),y},{}),pathname:l,pathnameBase:d,pattern:n}}function Oce(n,e,i){e===void 0&&(e=!1),i===void 0&&(i=!0),Ep(n==="*"||!n.endsWith("*")||n.endsWith("/*"),'Route path "'+n+'" will be treated as if it were '+('"'+n.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+n.replace(/\*$/,"/*")+'".'));let a=[],s="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:(\w+)(\?)?/g,(d,f,p)=>(a.push({paramName:f,isOptional:p!=null}),p?"/?([^\\/]+)?":"/([^\\/]+)"));return n.endsWith("*")?(a.push({paramName:"*"}),s+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):i?s+="\\/*$":n!==""&&n!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),a]}function Nce(n){try{return decodeURI(n)}catch(e){return Ep(!1,'The URL path "'+n+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),n}}function Fce(n,e){try{return decodeURIComponent(n)}catch(i){return Ep(!1,'The value for the URL param "'+e+'" will not be decoded because'+(' the string "'+n+'" is a malformed URL segment. This is probably')+(" due to a bad percent encoding ("+i+").")),n}}function jw(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let i=e.endsWith("/")?e.length-1:e.length,a=n.charAt(i);return a&&a!=="/"?null:n.slice(i)||"/"}function Bce(n,e){e===void 0&&(e="/");let{pathname:i,search:a="",hash:s=""}=typeof n=="string"?Rd(n):n;return{pathname:i?i.startsWith("/")?i:Uce(i,e):e,search:Vce(a),hash:Gce(s)}}function Uce(n,e){let i=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(s=>{s===".."?i.length>1&&i.pop():s!=="."&&i.push(s)}),i.length>1?i.join("/"):"/"}function SR(n,e,i,a){return"Cannot include a '"+n+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(a)+"].  Please separate it out to the ")+("`to."+i+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function p4(n){return n.filter((e,i)=>i===0||e.route.path&&e.route.path.length>0)}function UY(n,e,i,a){a===void 0&&(a=!1);let s;typeof n=="string"?s=Rd(n):(s=qa({},n),nr(!s.pathname||!s.pathname.includes("?"),SR("?","pathname","search",s)),nr(!s.pathname||!s.pathname.includes("#"),SR("#","pathname","hash",s)),nr(!s.search||!s.search.includes("#"),SR("#","search","hash",s)));let l=n===""||s.pathname==="",d=l?"/":s.pathname,f;if(d==null)f=i;else if(a){let b=e[e.length-1].replace(/^\//,"").split("/");if(d.startsWith("..")){let S=d.split("/");for(;S[0]==="..";)S.shift(),b.pop();s.pathname=S.join("/")}f="/"+b.join("/")}else{let b=e.length-1;if(d.startsWith("..")){let S=d.split("/");for(;S[0]==="..";)S.shift(),b-=1;s.pathname=S.join("/")}f=b>=0?e[b]:"/"}let p=Bce(s,f),y=d&&d!=="/"&&d.endsWith("/"),_=(l||d===".")&&i.endsWith("/");return!p.pathname.endsWith("/")&&(y||_)&&(p.pathname+="/"),p}const yp=n=>n.join("/").replace(/\/\/+/g,"/"),Wce=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),Vce=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,Gce=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n;class m4{constructor(e,i,a,s){s===void 0&&(s=!1),this.status=e,this.statusText=i||"",this.internal=s,a instanceof Error?(this.data=a.toString(),this.error=a):this.data=a}}function WY(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}const VY=["post","put","patch","delete"],Hce=new Set(VY),jce=["get",...VY],$ce=new Set(jce),Yce=new Set([301,302,303,307,308]),qce=new Set([307,308]),ER={state:"idle",location:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},Xce={state:"idle",data:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},ox={state:"unblocked",proceed:void 0,reset:void 0,location:void 0},GY=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Zce=n=>({hasErrorBoundary:!!n.hasErrorBoundary}),HY="remix-router-transitions";function Kce(n){const e=n.window?n.window:typeof window<"u"?window:void 0,i=typeof e<"u"&&typeof e.document<"u"&&typeof e.document.createElement<"u",a=!i;nr(n.routes.length>0,"You must provide a non-empty routes array to createRouter");let s;if(n.mapRouteProperties)s=n.mapRouteProperties;else if(n.detectErrorBoundary){let be=n.detectErrorBoundary;s=Qe=>({hasErrorBoundary:be(Qe)})}else s=Zce;let l={},d=Gk(n.routes,s,void 0,l),f,p=n.basename||"/",y=qa({v7_fetcherPersist:!1,v7_normalizeFormMethod:!1,v7_prependBasename:!1},n.future),_=null,b=new Set,S=null,A=null,P=null,L=n.hydrationData!=null,k=D0(d,n.history.location,p),R=null;if(k==null){let be=Mc(404,{pathname:n.history.location.pathname}),{matches:Qe,route:Se}=c9(d);k=Qe,R={[Se.id]:be}}let z=!k.some(be=>be.route.lazy)&&(!k.some(be=>be.route.loader)||n.hydrationData!=null),O,F={historyAction:n.history.action,location:n.history.location,matches:k,initialized:z,navigation:ER,restoreScrollPosition:n.hydrationData!=null?!1:null,preventScrollReset:!1,revalidation:"idle",loaderData:n.hydrationData&&n.hydrationData.loaderData||{},actionData:n.hydrationData&&n.hydrationData.actionData||null,errors:n.hydrationData&&n.hydrationData.errors||R,fetchers:new Map,blockers:new Map},H=so.Pop,$=!1,Y,te=!1,G=new Map,Q=null,he=!1,pe=!1,ye=[],fe=[],Ae=new Map,Re=0,Be=-1,le=new Map,me=new Set,we=new Map,re=new Map,Te=new Set,Je=new Map,Xe=new Map,Ze=!1;function Fe(){if(_=n.history.listen(be=>{let{action:Qe,location:Se,delta:Ce}=be;if(Ze){Ze=!1;return}Ep(Xe.size===0||Ce!=null,"You are trying to use a blocker on a POP navigation to a location that was not created by @remix-run/router. This will fail silently in production. This can happen if you are navigating outside the router via `window.history.pushState`/`window.location.hash` instead of using router navigation APIs.  This can also happen if you are using createHashRouter and the user manually changes the URL.");let Ne=wt({currentLocation:F.location,nextLocation:Se,historyAction:Qe});if(Ne&&Ce!=null){Ze=!0,n.history.go(Ce*-1),Dt(Ne,{state:"blocked",location:Se,proceed(){Dt(Ne,{state:"proceeding",proceed:void 0,reset:void 0,location:Se}),n.history.go(Ce)},reset(){let et=new Map(F.blockers);et.set(Ne,ox),kt({blockers:et})}});return}return pt(Qe,Se)}),i){lue(e,G);let be=()=>cue(e,G);e.addEventListener("pagehide",be),Q=()=>e.removeEventListener("pagehide",be)}return F.initialized||pt(so.Pop,F.location),O}function ct(){_&&_(),Q&&Q(),b.clear(),Y&&Y.abort(),F.fetchers.forEach((be,Qe)=>Oe(Qe)),F.blockers.forEach((be,Qe)=>Ht(Qe))}function At(be){return b.add(be),()=>b.delete(be)}function kt(be,Qe){Qe===void 0&&(Qe={}),F=qa({},F,be);let Se=[],Ce=[];y.v7_fetcherPersist&&F.fetchers.forEach((Ne,et)=>{Ne.state==="idle"&&(Te.has(et)?Ce.push(et):Se.push(et))}),[...b].forEach(Ne=>Ne(F,{deletedFetchers:Ce,unstable_viewTransitionOpts:Qe.viewTransitionOpts,unstable_flushSync:Qe.flushSync===!0})),y.v7_fetcherPersist&&(Se.forEach(Ne=>F.fetchers.delete(Ne)),Ce.forEach(Ne=>Oe(Ne)))}function Kt(be,Qe,Se){var Ce,Ne;let{flushSync:et}=Se===void 0?{}:Se,tt=F.actionData!=null&&F.navigation.formMethod!=null&&hu(F.navigation.formMethod)&&F.navigation.state==="loading"&&((Ce=be.state)==null?void 0:Ce._isRedirect)!==!0,vt;Qe.actionData?Object.keys(Qe.actionData).length>0?vt=Qe.actionData:vt=null:tt?vt=F.actionData:vt=null;let ht=Qe.loaderData?l9(F.loaderData,Qe.loaderData,Qe.matches||[],Qe.errors):F.loaderData,dt=F.blockers;dt.size>0&&(dt=new Map(dt),dt.forEach((Qt,mn)=>dt.set(mn,ox)));let Vt=$===!0||F.navigation.formMethod!=null&&hu(F.navigation.formMethod)&&((Ne=be.state)==null?void 0:Ne._isRedirect)!==!0;f&&(d=f,f=void 0),he||H===so.Pop||(H===so.Push?n.history.push(be,be.state):H===so.Replace&&n.history.replace(be,be.state));let It;if(H===so.Pop){let Qt=G.get(F.location.pathname);Qt&&Qt.has(be.pathname)?It={currentLocation:F.location,nextLocation:be}:G.has(be.pathname)&&(It={currentLocation:be,nextLocation:F.location})}else if(te){let Qt=G.get(F.location.pathname);Qt?Qt.add(be.pathname):(Qt=new Set([be.pathname]),G.set(F.location.pathname,Qt)),It={currentLocation:F.location,nextLocation:be}}kt(qa({},Qe,{actionData:vt,loaderData:ht,historyAction:H,location:be,initialized:!0,navigation:ER,revalidation:"idle",restoreScrollPosition:Ot(be,Qe.matches||F.matches),preventScrollReset:Vt,blockers:dt}),{viewTransitionOpts:It,flushSync:et===!0}),H=so.Pop,$=!1,te=!1,he=!1,pe=!1,ye=[],fe=[]}async function Et(be,Qe){if(typeof be=="number"){n.history.go(be);return}let Se=Hk(F.location,F.matches,p,y.v7_prependBasename,be,Qe==null?void 0:Qe.fromRouteId,Qe==null?void 0:Qe.relative),{path:Ce,submission:Ne,error:et}=n9(y.v7_normalizeFormMethod,!1,Se,Qe),tt=F.location,vt=Jb(F.location,Ce,Qe&&Qe.state);vt=qa({},vt,n.history.encodeLocation(vt));let ht=Qe&&Qe.replace!=null?Qe.replace:void 0,dt=so.Push;ht===!0?dt=so.Replace:ht===!1||Ne!=null&&hu(Ne.formMethod)&&Ne.formAction===F.location.pathname+F.location.search&&(dt=so.Replace);let Vt=Qe&&"preventScrollReset"in Qe?Qe.preventScrollReset===!0:void 0,It=(Qe&&Qe.unstable_flushSync)===!0,Qt=wt({currentLocation:tt,nextLocation:vt,historyAction:dt});if(Qt){Dt(Qt,{state:"blocked",location:vt,proceed(){Dt(Qt,{state:"proceeding",proceed:void 0,reset:void 0,location:vt}),Et(be,Qe)},reset(){let mn=new Map(F.blockers);mn.set(Qt,ox),kt({blockers:mn})}});return}return await pt(dt,vt,{submission:Ne,pendingError:et,preventScrollReset:Vt,replace:Qe&&Qe.replace,enableViewTransition:Qe&&Qe.unstable_viewTransition,flushSync:It})}function Ie(){if(ze(),kt({revalidation:"loading"}),F.navigation.state!=="submitting"){if(F.navigation.state==="idle"){pt(F.historyAction,F.location,{startUninterruptedRevalidation:!0});return}pt(H||F.historyAction,F.navigation.location,{overrideNavigation:F.navigation})}}async function pt(be,Qe,Se){Y&&Y.abort(),Y=null,H=be,he=(Se&&Se.startUninterruptedRevalidation)===!0,qt(F.location,F.matches),$=(Se&&Se.preventScrollReset)===!0,te=(Se&&Se.enableViewTransition)===!0;let Ce=f||d,Ne=Se&&Se.overrideNavigation,et=D0(Ce,Qe,p),tt=(Se&&Se.flushSync)===!0;if(!et){let mn=Mc(404,{pathname:Qe.pathname}),{matches:en,route:_n}=c9(Ce);Xt(),Kt(Qe,{matches:en,loaderData:{},errors:{[_n.id]:mn}},{flushSync:tt});return}if(F.initialized&&!pe&&nue(F.location,Qe)&&!(Se&&Se.submission&&hu(Se.submission.formMethod))){Kt(Qe,{matches:et},{flushSync:tt});return}Y=new AbortController;let vt=lx(n.history,Qe,Y.signal,Se&&Se.submission),ht,dt;if(Se&&Se.pendingError)dt={[ub(et).route.id]:Se.pendingError};else if(Se&&Se.submission&&hu(Se.submission.formMethod)){let mn=await gt(vt,Qe,Se.submission,et,{replace:Se.replace,flushSync:tt});if(mn.shortCircuited)return;ht=mn.pendingActionData,dt=mn.pendingActionError,Ne=MR(Qe,Se.submission),tt=!1,vt=new Request(vt.url,{signal:vt.signal})}let{shortCircuited:Vt,loaderData:It,errors:Qt}=await _t(vt,Qe,et,Ne,Se&&Se.submission,Se&&Se.fetcherSubmission,Se&&Se.replace,tt,ht,dt);Vt||(Y=null,Kt(Qe,qa({matches:et},ht?{actionData:ht}:{},{loaderData:It,errors:Qt})))}async function gt(be,Qe,Se,Ce,Ne){Ne===void 0&&(Ne={}),ze();let et=oue(Qe,Se);kt({navigation:et},{flushSync:Ne.flushSync===!0});let tt,vt=$k(Ce,Qe);if(!vt.route.action&&!vt.route.lazy)tt={type:lo.error,error:Mc(405,{method:be.method,pathname:Qe.pathname,routeId:vt.route.id})};else if(tt=await sx("action",be,vt,Ce,l,s,p),be.signal.aborted)return{shortCircuited:!0};if(Y0(tt)){let ht;return Ne&&Ne.replace!=null?ht=Ne.replace:ht=tt.location===F.location.pathname+F.location.search,await xe(F,tt,{submission:Se,replace:ht}),{shortCircuited:!0}}if(db(tt)){let ht=ub(Ce,vt.route.id);return(Ne&&Ne.replace)!==!0&&(H=so.Push),{pendingActionData:{},pendingActionError:{[ht.route.id]:tt.error}}}if(yg(tt))throw Mc(400,{type:"defer-action"});return{pendingActionData:{[vt.route.id]:tt.data}}}async function _t(be,Qe,Se,Ce,Ne,et,tt,vt,ht,dt){let Vt=Ce||MR(Qe,Ne),It=Ne||et||h9(Vt),Qt=f||d,[mn,en]=i9(n.history,F,Se,It,Qe,pe,ye,fe,we,me,Qt,p,ht,dt);if(Xt(Rt=>!(Se&&Se.some(Nt=>Nt.route.id===Rt))||mn&&mn.some(Nt=>Nt.route.id===Rt)),Be=++Re,mn.length===0&&en.length===0){let Rt=Mt();return Kt(Qe,qa({matches:Se,loaderData:{},errors:dt||null},ht?{actionData:ht}:{},Rt?{fetchers:new Map(F.fetchers)}:{}),{flushSync:vt}),{shortCircuited:!0}}if(!he){en.forEach(Nt=>{let jt=F.fetchers.get(Nt.key),yn=cx(void 0,jt?jt.data:void 0);F.fetchers.set(Nt.key,yn)});let Rt=ht||F.actionData;kt(qa({navigation:Vt},Rt?Object.keys(Rt).length===0?{actionData:null}:{actionData:Rt}:{},en.length>0?{fetchers:new Map(F.fetchers)}:{}),{flushSync:vt})}en.forEach(Rt=>{Ae.has(Rt.key)&&it(Rt.key),Rt.controller&&Ae.set(Rt.key,Rt.controller)});let _n=()=>en.forEach(Rt=>it(Rt.key));Y&&Y.signal.addEventListener("abort",_n);let{results:Hn,loaderResults:ni,fetcherResults:Ei}=await Ye(F.matches,Se,mn,en,be);if(be.signal.aborted)return{shortCircuited:!0};Y&&Y.signal.removeEventListener("abort",_n),en.forEach(Rt=>Ae.delete(Rt.key));let Mi=u9(Hn);if(Mi){if(Mi.idx>=mn.length){let Rt=en[Mi.idx-mn.length].key;me.add(Rt)}return await xe(F,Mi.result,{replace:tt}),{shortCircuited:!0}}let{loaderData:gr,errors:sr}=s9(F,Se,mn,ni,dt,en,Ei,Je);Je.forEach((Rt,Nt)=>{Rt.subscribe(jt=>{(jt||Rt.done)&&Je.delete(Nt)})});let ke=Mt(),xt=Ut(Be),zt=ke||xt||en.length>0;return qa({loaderData:gr,errors:sr},zt?{fetchers:new Map(F.fetchers)}:{})}function Ue(be,Qe,Se,Ce){if(a)throw new Error("router.fetch() was called during the server render, but it shouldn't be. You are likely calling a useFetcher() method in the body of your component. Try moving it to a useEffect or a callback.");Ae.has(be)&&it(be);let Ne=(Ce&&Ce.unstable_flushSync)===!0,et=f||d,tt=Hk(F.location,F.matches,p,y.v7_prependBasename,Se,Qe,Ce==null?void 0:Ce.relative),vt=D0(et,tt,p);if(!vt){de(be,Qe,Mc(404,{pathname:tt}),{flushSync:Ne});return}let{path:ht,submission:dt,error:Vt}=n9(y.v7_normalizeFormMethod,!0,tt,Ce);if(Vt){de(be,Qe,Vt,{flushSync:Ne});return}let It=$k(vt,ht);if($=(Ce&&Ce.preventScrollReset)===!0,dt&&hu(dt.formMethod)){ue(be,Qe,ht,It,vt,Ne,dt);return}we.set(be,{routeId:Qe,path:ht}),se(be,Qe,ht,It,vt,Ne,dt)}async function ue(be,Qe,Se,Ce,Ne,et,tt){if(ze(),we.delete(be),!Ce.route.action&&!Ce.route.lazy){let jt=Mc(405,{method:tt.formMethod,pathname:Se,routeId:Qe});de(be,Qe,jt,{flushSync:et});return}let vt=F.fetchers.get(be);st(be,sue(tt,vt),{flushSync:et});let ht=new AbortController,dt=lx(n.history,Se,ht.signal,tt);Ae.set(be,ht);let Vt=Re,It=await sx("action",dt,Ce,Ne,l,s,p);if(dt.signal.aborted){Ae.get(be)===ht&&Ae.delete(be);return}if(Te.has(be)){st(be,Zf(void 0));return}if(Y0(It))if(Ae.delete(be),Be>Vt){st(be,Zf(void 0));return}else return me.add(be),st(be,cx(tt)),xe(F,It,{fetcherSubmission:tt});if(db(It)){de(be,Qe,It.error);return}if(yg(It))throw Mc(400,{type:"defer-action"});let Qt=F.navigation.location||F.location,mn=lx(n.history,Qt,ht.signal),en=f||d,_n=F.navigation.state!=="idle"?D0(en,F.navigation.location,p):F.matches;nr(_n,"Didn't find any matches after fetcher action");let Hn=++Re;le.set(be,Hn);let ni=cx(tt,It.data);F.fetchers.set(be,ni);let[Ei,Mi]=i9(n.history,F,_n,tt,Qt,pe,ye,fe,we,me,en,p,{[Ce.route.id]:It.data},void 0);Mi.filter(jt=>jt.key!==be).forEach(jt=>{let yn=jt.key,Zn=F.fetchers.get(yn),on=cx(void 0,Zn?Zn.data:void 0);F.fetchers.set(yn,on),Ae.has(yn)&&it(yn),jt.controller&&Ae.set(yn,jt.controller)}),kt({fetchers:new Map(F.fetchers)});let gr=()=>Mi.forEach(jt=>it(jt.key));ht.signal.addEventListener("abort",gr);let{results:sr,loaderResults:ke,fetcherResults:xt}=await Ye(F.matches,_n,Ei,Mi,mn);if(ht.signal.aborted)return;ht.signal.removeEventListener("abort",gr),le.delete(be),Ae.delete(be),Mi.forEach(jt=>Ae.delete(jt.key));let zt=u9(sr);if(zt){if(zt.idx>=Ei.length){let jt=Mi[zt.idx-Ei.length].key;me.add(jt)}return xe(F,zt.result)}let{loaderData:Rt,errors:Nt}=s9(F,F.matches,Ei,ke,void 0,Mi,xt,Je);if(F.fetchers.has(be)){let jt=Zf(It.data);F.fetchers.set(be,jt)}Ut(Hn),F.navigation.state==="loading"&&Hn>Be?(nr(H,"Expected pending action"),Y&&Y.abort(),Kt(F.navigation.location,{matches:_n,loaderData:Rt,errors:Nt,fetchers:new Map(F.fetchers)})):(kt({errors:Nt,loaderData:l9(F.loaderData,Rt,_n,Nt),fetchers:new Map(F.fetchers)}),pe=!1)}async function se(be,Qe,Se,Ce,Ne,et,tt){let vt=F.fetchers.get(be);st(be,cx(tt,vt?vt.data:void 0),{flushSync:et});let ht=new AbortController,dt=lx(n.history,Se,ht.signal);Ae.set(be,ht);let Vt=Re,It=await sx("loader",dt,Ce,Ne,l,s,p);if(yg(It)&&(It=await YY(It,dt.signal,!0)||It),Ae.get(be)===ht&&Ae.delete(be),!dt.signal.aborted){if(Te.has(be)){st(be,Zf(void 0));return}if(Y0(It))if(Be>Vt){st(be,Zf(void 0));return}else{me.add(be),await xe(F,It);return}if(db(It)){de(be,Qe,It.error);return}nr(!yg(It),"Unhandled fetcher deferred data"),st(be,Zf(It.data))}}async function xe(be,Qe,Se){let{submission:Ce,fetcherSubmission:Ne,replace:et}=Se===void 0?{}:Se;Qe.revalidate&&(pe=!0);let tt=Jb(be.location,Qe.location,{_isRedirect:!0});if(nr(tt,"Expected a location on the redirect navigation"),i){let Qt=!1;if(Qe.reloadDocument)Qt=!0;else if(GY.test(Qe.location)){const mn=n.history.createURL(Qe.location);Qt=mn.origin!==e.location.origin||jw(mn.pathname,p)==null}if(Qt){et?e.location.replace(Qe.location):e.location.assign(Qe.location);return}}Y=null;let vt=et===!0?so.Replace:so.Push,{formMethod:ht,formAction:dt,formEncType:Vt}=be.navigation;!Ce&&!Ne&&ht&&dt&&Vt&&(Ce=h9(be.navigation));let It=Ce||Ne;if(qce.has(Qe.status)&&It&&hu(It.formMethod))await pt(vt,tt,{submission:qa({},It,{formAction:Qe.location}),preventScrollReset:$});else{let Qt=MR(tt,Ce);await pt(vt,tt,{overrideNavigation:Qt,fetcherSubmission:Ne,preventScrollReset:$})}}async function Ye(be,Qe,Se,Ce,Ne){let et=await Promise.all([...Se.map(ht=>sx("loader",Ne,ht,Qe,l,s,p)),...Ce.map(ht=>ht.matches&&ht.match&&ht.controller?sx("loader",lx(n.history,ht.path,ht.controller.signal),ht.match,ht.matches,l,s,p):{type:lo.error,error:Mc(404,{pathname:ht.path})})]),tt=et.slice(0,Se.length),vt=et.slice(Se.length);return await Promise.all([d9(be,Se,tt,tt.map(()=>Ne.signal),!1,F.loaderData),d9(be,Ce.map(ht=>ht.match),vt,Ce.map(ht=>ht.controller?ht.controller.signal:null),!0)]),{results:et,loaderResults:tt,fetcherResults:vt}}function ze(){pe=!0,ye.push(...Xt()),we.forEach((be,Qe)=>{Ae.has(Qe)&&(fe.push(Qe),it(Qe))})}function st(be,Qe,Se){Se===void 0&&(Se={}),F.fetchers.set(be,Qe),kt({fetchers:new Map(F.fetchers)},{flushSync:(Se&&Se.flushSync)===!0})}function de(be,Qe,Se,Ce){Ce===void 0&&(Ce={});let Ne=ub(F.matches,Qe);Oe(be),kt({errors:{[Ne.route.id]:Se},fetchers:new Map(F.fetchers)},{flushSync:(Ce&&Ce.flushSync)===!0})}function ie(be){return y.v7_fetcherPersist&&(re.set(be,(re.get(be)||0)+1),Te.has(be)&&Te.delete(be)),F.fetchers.get(be)||Xce}function Oe(be){let Qe=F.fetchers.get(be);Ae.has(be)&&!(Qe&&Qe.state==="loading"&&le.has(be))&&it(be),we.delete(be),le.delete(be),me.delete(be),Te.delete(be),F.fetchers.delete(be)}function ut(be){if(y.v7_fetcherPersist){let Qe=(re.get(be)||0)-1;Qe<=0?(re.delete(be),Te.add(be)):re.set(be,Qe)}else Oe(be);kt({fetchers:new Map(F.fetchers)})}function it(be){let Qe=Ae.get(be);nr(Qe,"Expected fetch controller: "+be),Qe.abort(),Ae.delete(be)}function lt(be){for(let Qe of be){let Se=ie(Qe),Ce=Zf(Se.data);F.fetchers.set(Qe,Ce)}}function Mt(){let be=[],Qe=!1;for(let Se of me){let Ce=F.fetchers.get(Se);nr(Ce,"Expected fetcher: "+Se),Ce.state==="loading"&&(me.delete(Se),be.push(Se),Qe=!0)}return lt(be),Qe}function Ut(be){let Qe=[];for(let[Se,Ce]of le)if(Ce<be){let Ne=F.fetchers.get(Se);nr(Ne,"Expected fetcher: "+Se),Ne.state==="loading"&&(it(Se),le.delete(Se),Qe.push(Se))}return lt(Qe),Qe.length>0}function Wt(be,Qe){let Se=F.blockers.get(be)||ox;return Xe.get(be)!==Qe&&Xe.set(be,Qe),Se}function Ht(be){F.blockers.delete(be),Xe.delete(be)}function Dt(be,Qe){let Se=F.blockers.get(be)||ox;nr(Se.state==="unblocked"&&Qe.state==="blocked"||Se.state==="blocked"&&Qe.state==="blocked"||Se.state==="blocked"&&Qe.state==="proceeding"||Se.state==="blocked"&&Qe.state==="unblocked"||Se.state==="proceeding"&&Qe.state==="unblocked","Invalid blocker state transition: "+Se.state+" -> "+Qe.state);let Ce=new Map(F.blockers);Ce.set(be,Qe),kt({blockers:Ce})}function wt(be){let{currentLocation:Qe,nextLocation:Se,historyAction:Ce}=be;if(Xe.size===0)return;Xe.size>1&&Ep(!1,"A router only supports one blocker at a time");let Ne=Array.from(Xe.entries()),[et,tt]=Ne[Ne.length-1],vt=F.blockers.get(et);if(!(vt&&vt.state==="proceeding")&&tt({currentLocation:Qe,nextLocation:Se,historyAction:Ce}))return et}function Xt(be){let Qe=[];return Je.forEach((Se,Ce)=>{(!be||be(Ce))&&(Se.cancel(),Qe.push(Ce),Je.delete(Ce))}),Qe}function $e(be,Qe,Se){if(S=be,P=Qe,A=Se||null,!L&&F.navigation===ER){L=!0;let Ce=Ot(F.location,F.matches);Ce!=null&&kt({restoreScrollPosition:Ce})}return()=>{S=null,P=null,A=null}}function Pt(be,Qe){return A&&A(be,Qe.map(Ce=>Ece(Ce,F.loaderData)))||be.key}function qt(be,Qe){if(S&&P){let Se=Pt(be,Qe);S[Se]=P()}}function Ot(be,Qe){if(S){let Se=Pt(be,Qe),Ce=S[Se];if(typeof Ce=="number")return Ce}return null}function fn(be){l={},f=Gk(be,s,void 0,l)}return O={get basename(){return p},get state(){return F},get routes(){return d},get window(){return e},initialize:Fe,subscribe:At,enableScrollRestoration:$e,navigate:Et,fetch:Ue,revalidate:Ie,createHref:be=>n.history.createHref(be),encodeLocation:be=>n.history.encodeLocation(be),getFetcher:ie,deleteFetcher:ut,dispose:ct,getBlocker:Wt,deleteBlocker:Ht,_internalFetchControllers:Ae,_internalActiveDeferreds:Je,_internalSetRoutes:fn},O}function Jce(n){return n!=null&&("formData"in n&&n.formData!=null||"body"in n&&n.body!==void 0)}function Hk(n,e,i,a,s,l,d){let f,p;if(l){f=[];for(let _ of e)if(f.push(_),_.route.id===l){p=_;break}}else f=e,p=e[e.length-1];let y=UY(s||".",p4(f).map(_=>_.pathnameBase),jw(n.pathname,i)||n.pathname,d==="path");return s==null&&(y.search=n.search,y.hash=n.hash),(s==null||s===""||s===".")&&p&&p.route.index&&!g4(y.search)&&(y.search=y.search?y.search.replace(/^\?/,"?index&"):"?index"),a&&i!=="/"&&(y.pathname=y.pathname==="/"?i:yp([i,y.pathname])),Hw(y)}function n9(n,e,i,a){if(!a||!Jce(a))return{path:i};if(a.formMethod&&!aue(a.formMethod))return{path:i,error:Mc(405,{method:a.formMethod})};let s=()=>({path:i,error:Mc(400,{type:"invalid-body"})}),l=a.formMethod||"get",d=n?l.toUpperCase():l.toLowerCase(),f=$Y(i);if(a.body!==void 0){if(a.formEncType==="text/plain"){if(!hu(d))return s();let S=typeof a.body=="string"?a.body:a.body instanceof FormData||a.body instanceof URLSearchParams?Array.from(a.body.entries()).reduce((A,P)=>{let[L,k]=P;return""+A+L+"="+k+`
`},""):String(a.body);return{path:i,submission:{formMethod:d,formAction:f,formEncType:a.formEncType,formData:void 0,json:void 0,text:S}}}else if(a.formEncType==="application/json"){if(!hu(d))return s();try{let S=typeof a.body=="string"?JSON.parse(a.body):a.body;return{path:i,submission:{formMethod:d,formAction:f,formEncType:a.formEncType,formData:void 0,json:S,text:void 0}}}catch{return s()}}}nr(typeof FormData=="function","FormData is not available in this environment");let p,y;if(a.formData)p=jk(a.formData),y=a.formData;else if(a.body instanceof FormData)p=jk(a.body),y=a.body;else if(a.body instanceof URLSearchParams)p=a.body,y=o9(p);else if(a.body==null)p=new URLSearchParams,y=new FormData;else try{p=new URLSearchParams(a.body),y=o9(p)}catch{return s()}let _={formMethod:d,formAction:f,formEncType:a&&a.formEncType||"application/x-www-form-urlencoded",formData:y,json:void 0,text:void 0};if(hu(_.formMethod))return{path:i,submission:_};let b=Rd(i);return e&&b.search&&g4(b.search)&&p.append("index",""),b.search="?"+p,{path:Hw(b),submission:_}}function Qce(n,e){let i=n;if(e){let a=n.findIndex(s=>s.route.id===e);a>=0&&(i=n.slice(0,a))}return i}function i9(n,e,i,a,s,l,d,f,p,y,_,b,S,A){let P=A?Object.values(A)[0]:S?Object.values(S)[0]:void 0,L=n.createURL(e.location),k=n.createURL(s),R=A?Object.keys(A)[0]:void 0,O=Qce(i,R).filter((H,$)=>{if(H.route.lazy)return!0;if(H.route.loader==null)return!1;if(eue(e.loaderData,e.matches[$],H)||d.some(G=>G===H.route.id))return!0;let Y=e.matches[$],te=H;return r9(H,qa({currentUrl:L,currentParams:Y.params,nextUrl:k,nextParams:te.params},a,{actionResult:P,defaultShouldRevalidate:l||L.pathname+L.search===k.pathname+k.search||L.search!==k.search||jY(Y,te)}))}),F=[];return p.forEach((H,$)=>{if(!i.some(he=>he.route.id===H.routeId))return;let Y=D0(_,H.path,b);if(!Y){F.push({key:$,routeId:H.routeId,path:H.path,matches:null,match:null,controller:null});return}let te=e.fetchers.get($),G=$k(Y,H.path),Q=!1;y.has($)?Q=!1:f.includes($)?Q=!0:te&&te.state!=="idle"&&te.data===void 0?Q=l:Q=r9(G,qa({currentUrl:L,currentParams:e.matches[e.matches.length-1].params,nextUrl:k,nextParams:i[i.length-1].params},a,{actionResult:P,defaultShouldRevalidate:l})),Q&&F.push({key:$,routeId:H.routeId,path:H.path,matches:Y,match:G,controller:new AbortController})}),[O,F]}function eue(n,e,i){let a=!e||i.route.id!==e.route.id,s=n[i.route.id]===void 0;return a||s}function jY(n,e){let i=n.route.path;return n.pathname!==e.pathname||i!=null&&i.endsWith("*")&&n.params["*"]!==e.params["*"]}function r9(n,e){if(n.route.shouldRevalidate){let i=n.route.shouldRevalidate(e);if(typeof i=="boolean")return i}return e.defaultShouldRevalidate}async function a9(n,e,i){if(!n.lazy)return;let a=await n.lazy();if(!n.lazy)return;let s=i[n.id];nr(s,"No route found in manifest");let l={};for(let d in a){let p=s[d]!==void 0&&d!=="hasErrorBoundary";Ep(!p,'Route "'+s.id+'" has a static property "'+d+'" defined but its lazy function is also returning a value for this property. '+('The lazy route property "'+d+'" will be ignored.')),!p&&!wce.has(d)&&(l[d]=a[d])}Object.assign(s,l),Object.assign(s,qa({},e(s),{lazy:void 0}))}async function sx(n,e,i,a,s,l,d,f){f===void 0&&(f={});let p,y,_,b=P=>{let L,k=new Promise((R,z)=>L=z);return _=()=>L(),e.signal.addEventListener("abort",_),Promise.race([P({request:e,params:i.params,context:f.requestContext}),k])};try{let P=i.route[n];if(i.route.lazy)if(P){let L,k=await Promise.all([b(P).catch(R=>{L=R}),a9(i.route,l,s)]);if(L)throw L;y=k[0]}else if(await a9(i.route,l,s),P=i.route[n],P)y=await b(P);else if(n==="action"){let L=new URL(e.url),k=L.pathname+L.search;throw Mc(405,{method:e.method,pathname:k,routeId:i.route.id})}else return{type:lo.data,data:void 0};else if(P)y=await b(P);else{let L=new URL(e.url),k=L.pathname+L.search;throw Mc(404,{pathname:k})}nr(y!==void 0,"You defined "+(n==="action"?"an action":"a loader")+" for route "+('"'+i.route.id+"\" but didn't return anything from your `"+n+"` ")+"function. Please return a value or `null`.")}catch(P){p=lo.error,y=P}finally{_&&e.signal.removeEventListener("abort",_)}if(rue(y)){let P=y.status;if(Yce.has(P)){let R=y.headers.get("Location");if(nr(R,"Redirects returned/thrown from loaders/actions must have a Location header"),!GY.test(R))R=Hk(new URL(e.url),a.slice(0,a.indexOf(i)+1),d,!0,R);else if(!f.isStaticRequest){let z=new URL(e.url),O=R.startsWith("//")?new URL(z.protocol+R):new URL(R),F=jw(O.pathname,d)!=null;O.origin===z.origin&&F&&(R=O.pathname+O.search+O.hash)}if(f.isStaticRequest)throw y.headers.set("Location",R),y;return{type:lo.redirect,status:P,location:R,revalidate:y.headers.get("X-Remix-Revalidate")!==null,reloadDocument:y.headers.get("X-Remix-Reload-Document")!==null}}if(f.isRouteRequest)throw{type:p===lo.error?lo.error:lo.data,response:y};let L,k=y.headers.get("Content-Type");return k&&/\bapplication\/json\b/.test(k)?L=await y.json():L=await y.text(),p===lo.error?{type:p,error:new m4(P,y.statusText,L),headers:y.headers}:{type:lo.data,data:L,statusCode:y.status,headers:y.headers}}if(p===lo.error)return{type:p,error:y};if(iue(y)){var S,A;return{type:lo.deferred,deferredData:y,statusCode:(S=y.init)==null?void 0:S.status,headers:((A=y.init)==null?void 0:A.headers)&&new Headers(y.init.headers)}}return{type:lo.data,data:y}}function lx(n,e,i,a){let s=n.createURL($Y(e)).toString(),l={signal:i};if(a&&hu(a.formMethod)){let{formMethod:d,formEncType:f}=a;l.method=d.toUpperCase(),f==="application/json"?(l.headers=new Headers({"Content-Type":f}),l.body=JSON.stringify(a.json)):f==="text/plain"?l.body=a.text:f==="application/x-www-form-urlencoded"&&a.formData?l.body=jk(a.formData):l.body=a.formData}return new Request(s,l)}function jk(n){let e=new URLSearchParams;for(let[i,a]of n.entries())e.append(i,typeof a=="string"?a:a.name);return e}function o9(n){let e=new FormData;for(let[i,a]of n.entries())e.append(i,a);return e}function tue(n,e,i,a,s){let l={},d=null,f,p=!1,y={};return i.forEach((_,b)=>{let S=e[b].route.id;if(nr(!Y0(_),"Cannot handle redirect results in processLoaderData"),db(_)){let A=ub(n,S),P=_.error;a&&(P=Object.values(a)[0],a=void 0),d=d||{},d[A.route.id]==null&&(d[A.route.id]=P),l[S]=void 0,p||(p=!0,f=WY(_.error)?_.error.status:500),_.headers&&(y[S]=_.headers)}else yg(_)?(s.set(S,_.deferredData),l[S]=_.deferredData.data):l[S]=_.data,_.statusCode!=null&&_.statusCode!==200&&!p&&(f=_.statusCode),_.headers&&(y[S]=_.headers)}),a&&(d=a,l[Object.keys(a)[0]]=void 0),{loaderData:l,errors:d,statusCode:f||200,loaderHeaders:y}}function s9(n,e,i,a,s,l,d,f){let{loaderData:p,errors:y}=tue(e,i,a,s,f);for(let _=0;_<l.length;_++){let{key:b,match:S,controller:A}=l[_];nr(d!==void 0&&d[_]!==void 0,"Did not find corresponding fetcher result");let P=d[_];if(!(A&&A.signal.aborted))if(db(P)){let L=ub(n.matches,S==null?void 0:S.route.id);y&&y[L.route.id]||(y=qa({},y,{[L.route.id]:P.error})),n.fetchers.delete(b)}else if(Y0(P))nr(!1,"Unhandled fetcher revalidation redirect");else if(yg(P))nr(!1,"Unhandled fetcher deferred data");else{let L=Zf(P.data);n.fetchers.set(b,L)}}return{loaderData:p,errors:y}}function l9(n,e,i,a){let s=qa({},e);for(let l of i){let d=l.route.id;if(e.hasOwnProperty(d)?e[d]!==void 0&&(s[d]=e[d]):n[d]!==void 0&&l.route.loader&&(s[d]=n[d]),a&&a.hasOwnProperty(d))break}return s}function ub(n,e){return(e?n.slice(0,n.findIndex(a=>a.route.id===e)+1):[...n]).reverse().find(a=>a.route.hasErrorBoundary===!0)||n[0]}function c9(n){let e=n.length===1?n[0]:n.find(i=>i.index||!i.path||i.path==="/")||{id:"__shim-error-route__"};return{matches:[{params:{},pathname:"",pathnameBase:"",route:e}],route:e}}function Mc(n,e){let{pathname:i,routeId:a,method:s,type:l}=e===void 0?{}:e,d="Unknown Server Error",f="Unknown @remix-run/router error";return n===400?(d="Bad Request",s&&i&&a?f="You made a "+s+' request to "'+i+'" but '+('did not provide a `loader` for route "'+a+'", ')+"so there is no way to handle the request.":l==="defer-action"?f="defer() is not supported in actions":l==="invalid-body"&&(f="Unable to encode submission body")):n===403?(d="Forbidden",f='Route "'+a+'" does not match URL "'+i+'"'):n===404?(d="Not Found",f='No route matches URL "'+i+'"'):n===405&&(d="Method Not Allowed",s&&i&&a?f="You made a "+s.toUpperCase()+' request to "'+i+'" but '+('did not provide an `action` for route "'+a+'", ')+"so there is no way to handle the request.":s&&(f='Invalid request method "'+s.toUpperCase()+'"')),new m4(n||500,d,new Error(f),!0)}function u9(n){for(let e=n.length-1;e>=0;e--){let i=n[e];if(Y0(i))return{result:i,idx:e}}}function $Y(n){let e=typeof n=="string"?Rd(n):n;return Hw(qa({},e,{hash:""}))}function nue(n,e){return n.pathname!==e.pathname||n.search!==e.search?!1:n.hash===""?e.hash!=="":n.hash===e.hash?!0:e.hash!==""}function yg(n){return n.type===lo.deferred}function db(n){return n.type===lo.error}function Y0(n){return(n&&n.type)===lo.redirect}function iue(n){let e=n;return e&&typeof e=="object"&&typeof e.data=="object"&&typeof e.subscribe=="function"&&typeof e.cancel=="function"&&typeof e.resolveData=="function"}function rue(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.headers=="object"&&typeof n.body<"u"}function aue(n){return $ce.has(n.toLowerCase())}function hu(n){return Hce.has(n.toLowerCase())}async function d9(n,e,i,a,s,l){for(let d=0;d<i.length;d++){let f=i[d],p=e[d];if(!p)continue;let y=n.find(b=>b.route.id===p.route.id),_=y!=null&&!jY(y,p)&&(l&&l[p.route.id])!==void 0;if(yg(f)&&(s||_)){let b=a[d];nr(b,"Expected an AbortSignal for revalidating fetcher deferred result"),await YY(f,b,s).then(S=>{S&&(i[d]=S||i[d])})}}}async function YY(n,e,i){if(i===void 0&&(i=!1),!await n.deferredData.resolveData(e)){if(i)try{return{type:lo.data,data:n.deferredData.unwrappedData}}catch(s){return{type:lo.error,error:s}}return{type:lo.data,data:n.deferredData.data}}}function g4(n){return new URLSearchParams(n).getAll("index").some(e=>e==="")}function $k(n,e){let i=typeof e=="string"?Rd(e).search:e.search;if(n[n.length-1].route.index&&g4(i||""))return n[n.length-1];let a=p4(n);return a[a.length-1]}function h9(n){let{formMethod:e,formAction:i,formEncType:a,text:s,formData:l,json:d}=n;if(!(!e||!i||!a)){if(s!=null)return{formMethod:e,formAction:i,formEncType:a,formData:void 0,json:void 0,text:s};if(l!=null)return{formMethod:e,formAction:i,formEncType:a,formData:l,json:void 0,text:void 0};if(d!==void 0)return{formMethod:e,formAction:i,formEncType:a,formData:void 0,json:d,text:void 0}}}function MR(n,e){return e?{state:"loading",location:n,formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text}:{state:"loading",location:n,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0}}function oue(n,e){return{state:"submitting",location:n,formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text}}function cx(n,e){return n?{state:"loading",formMethod:n.formMethod,formAction:n.formAction,formEncType:n.formEncType,formData:n.formData,json:n.json,text:n.text,data:e}:{state:"loading",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:e}}function sue(n,e){return{state:"submitting",formMethod:n.formMethod,formAction:n.formAction,formEncType:n.formEncType,formData:n.formData,json:n.json,text:n.text,data:e?e.data:void 0}}function Zf(n){return{state:"idle",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:n}}function lue(n,e){try{let i=n.sessionStorage.getItem(HY);if(i){let a=JSON.parse(i);for(let[s,l]of Object.entries(a||{}))l&&Array.isArray(l)&&e.set(s,new Set(l||[]))}}catch{}}function cue(n,e){if(e.size>0){let i={};for(let[a,s]of e)i[a]=[...s];try{n.sessionStorage.setItem(HY,JSON.stringify(i))}catch(a){Ep(!1,"Failed to save applied view transitions in sessionStorage ("+a+").")}}}/**
 * React Router v6.19.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function tT(){return tT=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])}return n},tT.apply(this,arguments)}const YT=ne.createContext(null),qY=ne.createContext(null),qT=ne.createContext(null),XT=ne.createContext(null),ty=ne.createContext({outlet:null,matches:[],isDataRoute:!1}),XY=ne.createContext(null);function ZT(){return ne.useContext(XT)!=null}function ZY(){return ZT()||nr(!1),ne.useContext(XT).location}function KY(n){ne.useContext(qT).static||ne.useLayoutEffect(n)}function oc(){let{isDataRoute:n}=ne.useContext(ty);return n?bue():uue()}function uue(){ZT()||nr(!1);let n=ne.useContext(YT),{basename:e,navigator:i}=ne.useContext(qT),{matches:a}=ne.useContext(ty),{pathname:s}=ZY(),l=JSON.stringify(p4(a).map(p=>p.pathnameBase)),d=ne.useRef(!1);return KY(()=>{d.current=!0}),ne.useCallback(function(p,y){if(y===void 0&&(y={}),!d.current)return;if(typeof p=="number"){i.go(p);return}let _=UY(p,JSON.parse(l),s,y.relative==="path");n==null&&e!=="/"&&(_.pathname=_.pathname==="/"?e:yp([e,_.pathname])),(y.replace?i.replace:i.push)(_,y.state,y)},[e,i,l,s,n])}function y4(){let{matches:n}=ne.useContext(ty),e=n[n.length-1];return e?e.params:{}}function due(n,e,i){ZT()||nr(!1);let{navigator:a}=ne.useContext(qT),{matches:s}=ne.useContext(ty),l=s[s.length-1],d=l?l.params:{};l&&l.pathname;let f=l?l.pathnameBase:"/";l&&l.route;let p=ZY(),y;if(e){var _;let L=typeof e=="string"?Rd(e):e;f==="/"||(_=L.pathname)!=null&&_.startsWith(f)||nr(!1),y=L}else y=p;let b=y.pathname||"/",S=f==="/"?b:b.slice(f.length)||"/",A=D0(n,{pathname:S}),P=gue(A&&A.map(L=>Object.assign({},L,{params:Object.assign({},d,L.params),pathname:yp([f,a.encodeLocation?a.encodeLocation(L.pathname).pathname:L.pathname]),pathnameBase:L.pathnameBase==="/"?f:yp([f,a.encodeLocation?a.encodeLocation(L.pathnameBase).pathname:L.pathnameBase])})),s,i);return e&&P?ne.createElement(XT.Provider,{value:{location:tT({pathname:"/",search:"",hash:"",state:null,key:"default"},y),navigationType:so.Pop}},P):P}function hue(){let n=xue(),e=WY(n)?n.status+" "+n.statusText:n instanceof Error?n.message:JSON.stringify(n),i=n instanceof Error?n.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"},l=null;return ne.createElement(ne.Fragment,null,ne.createElement("h2",null,"Unexpected Application Error!"),ne.createElement("h3",{style:{fontStyle:"italic"}},e),i?ne.createElement("pre",{style:s},i):null,l)}const fue=ne.createElement(hue,null);class pue extends ne.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,i){return i.location!==e.location||i.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error||i.error,location:i.location,revalidation:e.revalidation||i.revalidation}}componentDidCatch(e,i){console.error("React Router caught the following error during render",e,i)}render(){return this.state.error?ne.createElement(ty.Provider,{value:this.props.routeContext},ne.createElement(XY.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function mue(n){let{routeContext:e,match:i,children:a}=n,s=ne.useContext(YT);return s&&s.static&&s.staticContext&&(i.route.errorElement||i.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=i.route.id),ne.createElement(ty.Provider,{value:e},a)}function gue(n,e,i){var a;if(e===void 0&&(e=[]),i===void 0&&(i=null),n==null){var s;if((s=i)!=null&&s.errors)n=i.matches;else return null}let l=n,d=(a=i)==null?void 0:a.errors;if(d!=null){let f=l.findIndex(p=>p.route.id&&(d==null?void 0:d[p.route.id]));f>=0||nr(!1),l=l.slice(0,Math.min(l.length,f+1))}return l.reduceRight((f,p,y)=>{let _=p.route.id?d==null?void 0:d[p.route.id]:null,b=null;i&&(b=p.route.errorElement||fue);let S=e.concat(l.slice(0,y+1)),A=()=>{let P;return _?P=b:p.route.Component?P=ne.createElement(p.route.Component,null):p.route.element?P=p.route.element:P=f,ne.createElement(mue,{match:p,routeContext:{outlet:f,matches:S,isDataRoute:i!=null},children:P})};return i&&(p.route.ErrorBoundary||p.route.errorElement||y===0)?ne.createElement(pue,{location:i.location,revalidation:i.revalidation,component:b,error:_,children:A(),routeContext:{outlet:null,matches:S,isDataRoute:!0}}):A()},null)}var JY=function(n){return n.UseBlocker="useBlocker",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n}(JY||{}),nT=function(n){return n.UseBlocker="useBlocker",n.UseLoaderData="useLoaderData",n.UseActionData="useActionData",n.UseRouteError="useRouteError",n.UseNavigation="useNavigation",n.UseRouteLoaderData="useRouteLoaderData",n.UseMatches="useMatches",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n.UseRouteId="useRouteId",n}(nT||{});function yue(n){let e=ne.useContext(YT);return e||nr(!1),e}function vue(n){let e=ne.useContext(qY);return e||nr(!1),e}function _ue(n){let e=ne.useContext(ty);return e||nr(!1),e}function QY(n){let e=_ue(),i=e.matches[e.matches.length-1];return i.route.id||nr(!1),i.route.id}function xue(){var n;let e=ne.useContext(XY),i=vue(nT.UseRouteError),a=QY(nT.UseRouteError);return e||((n=i.errors)==null?void 0:n[a])}function bue(){let{router:n}=yue(JY.UseNavigateStable),e=QY(nT.UseNavigateStable),i=ne.useRef(!1);return KY(()=>{i.current=!0}),ne.useCallback(function(s,l){l===void 0&&(l={}),i.current&&(typeof s=="number"?n.navigate(s):n.navigate(s,tT({fromRouteId:e},l)))},[n,e])}function wue(n){let{basename:e="/",children:i=null,location:a,navigationType:s=so.Pop,navigator:l,static:d=!1}=n;ZT()&&nr(!1);let f=e.replace(/^\/*/,"/"),p=ne.useMemo(()=>({basename:f,navigator:l,static:d}),[f,l,d]);typeof a=="string"&&(a=Rd(a));let{pathname:y="/",search:_="",hash:b="",state:S=null,key:A="default"}=a,P=ne.useMemo(()=>{let L=jw(y,f);return L==null?null:{location:{pathname:L,search:_,hash:b,state:S,key:A},navigationType:s}},[f,y,_,b,S,A,s]);return P==null?null:ne.createElement(qT.Provider,{value:p},ne.createElement(XT.Provider,{children:i,value:P}))}new Promise(()=>{});function Sue(n){let e={hasErrorBoundary:n.ErrorBoundary!=null||n.errorElement!=null};return n.Component&&Object.assign(e,{element:ne.createElement(n.Component),Component:void 0}),n.ErrorBoundary&&Object.assign(e,{errorElement:ne.createElement(n.ErrorBoundary),ErrorBoundary:void 0}),e}/**
 * React Router DOM v6.19.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function iT(){return iT=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])}return n},iT.apply(this,arguments)}function eq(n,e){return Kce({basename:e==null?void 0:e.basename,future:iT({},e==null?void 0:e.future,{v7_prependBasename:!0}),history:_ce({window:e==null?void 0:e.window}),hydrationData:(e==null?void 0:e.hydrationData)||Eue(),routes:n,mapRouteProperties:Sue,window:e==null?void 0:e.window}).initialize()}function Eue(){var n;let e=(n=window)==null?void 0:n.__staticRouterHydrationData;return e&&e.errors&&(e=iT({},e,{errors:Mue(e.errors)})),e}function Mue(n){if(!n)return null;let e=Object.entries(n),i={};for(let[a,s]of e)if(s&&s.__type==="RouteErrorResponse")i[a]=new m4(s.status,s.statusText,s.data,s.internal===!0);else if(s&&s.__type==="Error"){if(s.__subType){let l=window[s.__subType];if(typeof l=="function")try{let d=new l(s.message);d.stack="",i[a]=d}catch{}}if(i[a]==null){let l=new Error(s.message);l.stack="",i[a]=l}}else i[a]=s;return i}const Tue=ne.createContext({isTransitioning:!1}),Aue=ne.createContext(new Map),Cue="startTransition",f9=IM[Cue],Pue="flushSync",p9=vce[Pue];function Iue(n){f9?f9(n):n()}function ux(n){p9?p9(n):n()}class Rue{constructor(){this.status="pending",this.promise=new Promise((e,i)=>{this.resolve=a=>{this.status==="pending"&&(this.status="resolved",e(a))},this.reject=a=>{this.status==="pending"&&(this.status="rejected",i(a))}})}}function tq(n){let{fallbackElement:e,router:i,future:a}=n,[s,l]=ne.useState(i.state),[d,f]=ne.useState(),[p,y]=ne.useState({isTransitioning:!1}),[_,b]=ne.useState(),[S,A]=ne.useState(),[P,L]=ne.useState(),k=ne.useRef(new Map),{v7_startTransition:R}=a||{},z=ne.useCallback(Y=>{R?Iue(Y):Y()},[R]),O=ne.useCallback((Y,te)=>{let{deletedFetchers:G,unstable_flushSync:Q,unstable_viewTransitionOpts:he}=te;G.forEach(ye=>k.current.delete(ye)),Y.fetchers.forEach((ye,fe)=>{ye.data!==void 0&&k.current.set(fe,ye.data)});let pe=i.window==null||typeof i.window.document.startViewTransition!="function";if(!he||pe){Q?ux(()=>l(Y)):z(()=>l(Y));return}if(Q){ux(()=>{S&&(_&&_.resolve(),S.skipTransition()),y({isTransitioning:!0,flushSync:!0,currentLocation:he.currentLocation,nextLocation:he.nextLocation})});let ye=i.window.document.startViewTransition(()=>{ux(()=>l(Y))});ye.finished.finally(()=>{ux(()=>{b(void 0),A(void 0),f(void 0),y({isTransitioning:!1})})}),ux(()=>A(ye));return}S?(_&&_.resolve(),S.skipTransition(),L({state:Y,currentLocation:he.currentLocation,nextLocation:he.nextLocation})):(f(Y),y({isTransitioning:!0,flushSync:!1,currentLocation:he.currentLocation,nextLocation:he.nextLocation}))},[i.window,S,_,k,z]);ne.useLayoutEffect(()=>i.subscribe(O),[i,O]),ne.useEffect(()=>{p.isTransitioning&&!p.flushSync&&b(new Rue)},[p]),ne.useEffect(()=>{if(_&&d&&i.window){let Y=d,te=_.promise,G=i.window.document.startViewTransition(async()=>{z(()=>l(Y)),await te});G.finished.finally(()=>{b(void 0),A(void 0),f(void 0),y({isTransitioning:!1})}),A(G)}},[z,d,_,i.window]),ne.useEffect(()=>{_&&d&&s.location.key===d.location.key&&_.resolve()},[_,S,s.location,d]),ne.useEffect(()=>{!p.isTransitioning&&P&&(f(P.state),y({isTransitioning:!0,flushSync:!1,currentLocation:P.currentLocation,nextLocation:P.nextLocation}),L(void 0))},[p.isTransitioning,P]);let F=ne.useMemo(()=>({createHref:i.createHref,encodeLocation:i.encodeLocation,go:Y=>i.navigate(Y),push:(Y,te,G)=>i.navigate(Y,{state:te,preventScrollReset:G==null?void 0:G.preventScrollReset}),replace:(Y,te,G)=>i.navigate(Y,{replace:!0,state:te,preventScrollReset:G==null?void 0:G.preventScrollReset})}),[i]),H=i.basename||"/",$=ne.useMemo(()=>({router:i,navigator:F,static:!1,basename:H}),[i,F,H]);return ne.createElement(ne.Fragment,null,ne.createElement(YT.Provider,{value:$},ne.createElement(qY.Provider,{value:s},ne.createElement(Aue.Provider,{value:k.current},ne.createElement(Tue.Provider,{value:p},ne.createElement(wue,{basename:H,location:s.location,navigationType:s.historyAction,navigator:F},s.initialized?ne.createElement(Lue,{routes:i.routes,state:s}):e))))),null)}function Lue(n){let{routes:e,state:i}=n;return due(e,void 0,i)}var m9;(function(n){n.UseScrollRestoration="useScrollRestoration",n.UseSubmit="useSubmit",n.UseSubmitFetcher="useSubmitFetcher",n.UseFetcher="useFetcher",n.useViewTransitionState="useViewTransitionState"})(m9||(m9={}));var g9;(function(n){n.UseFetcher="useFetcher",n.UseFetchers="useFetchers",n.UseScrollRestoration="useScrollRestoration"})(g9||(g9={}));const kue={black:"#000",white:"#fff"},Qb=kue,Due={50:"#ffebee",100:"#ffcdd2",200:"#ef9a9a",300:"#e57373",400:"#ef5350",500:"#f44336",600:"#e53935",700:"#d32f2f",800:"#c62828",900:"#b71c1c",A100:"#ff8a80",A200:"#ff5252",A400:"#ff1744",A700:"#d50000"},Nv=Due,zue={50:"#f3e5f5",100:"#e1bee7",200:"#ce93d8",300:"#ba68c8",400:"#ab47bc",500:"#9c27b0",600:"#8e24aa",700:"#7b1fa2",800:"#6a1b9a",900:"#4a148c",A100:"#ea80fc",A200:"#e040fb",A400:"#d500f9",A700:"#aa00ff"},Fv=zue,Oue={50:"#e3f2fd",100:"#bbdefb",200:"#90caf9",300:"#64b5f6",400:"#42a5f5",500:"#2196f3",600:"#1e88e5",700:"#1976d2",800:"#1565c0",900:"#0d47a1",A100:"#82b1ff",A200:"#448aff",A400:"#2979ff",A700:"#2962ff"},Bv=Oue,Nue={50:"#e1f5fe",100:"#b3e5fc",200:"#81d4fa",300:"#4fc3f7",400:"#29b6f6",500:"#03a9f4",600:"#039be5",700:"#0288d1",800:"#0277bd",900:"#01579b",A100:"#80d8ff",A200:"#40c4ff",A400:"#00b0ff",A700:"#0091ea"},Uv=Nue,Fue={50:"#e8f5e9",100:"#c8e6c9",200:"#a5d6a7",300:"#81c784",400:"#66bb6a",500:"#4caf50",600:"#43a047",700:"#388e3c",800:"#2e7d32",900:"#1b5e20",A100:"#b9f6ca",A200:"#69f0ae",A400:"#00e676",A700:"#00c853"},Wv=Fue,Bue={50:"#fff3e0",100:"#ffe0b2",200:"#ffcc80",300:"#ffb74d",400:"#ffa726",500:"#ff9800",600:"#fb8c00",700:"#f57c00",800:"#ef6c00",900:"#e65100",A100:"#ffd180",A200:"#ffab40",A400:"#ff9100",A700:"#ff6d00"},dx=Bue,Uue={50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121",A100:"#f5f5f5",A200:"#eeeeee",A400:"#bdbdbd",A700:"#616161"},Wue=Uue;function Ge(){return Ge=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])}return n},Ge.apply(this,arguments)}function Rh(n){return n!==null&&typeof n=="object"&&n.constructor===Object}function nq(n){if(!Rh(n))return n;const e={};return Object.keys(n).forEach(i=>{e[i]=nq(n[i])}),e}function Ml(n,e,i={clone:!0}){const a=i.clone?Ge({},n):n;return Rh(n)&&Rh(e)&&Object.keys(e).forEach(s=>{s!=="__proto__"&&(Rh(e[s])&&s in n&&Rh(n[s])?a[s]=Ml(n[s],e[s],i):i.clone?a[s]=Rh(e[s])?nq(e[s]):e[s]:a[s]=e[s])}),a}function Mp(n){let e="https://mui.com/production-error/?code="+n;for(let i=1;i<arguments.length;i+=1)e+="&args[]="+encodeURIComponent(arguments[i]);return"Minified MUI error #"+n+"; visit "+e+" for the full message."}var Yr={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var v4=Symbol.for("react.element"),_4=Symbol.for("react.portal"),KT=Symbol.for("react.fragment"),JT=Symbol.for("react.strict_mode"),QT=Symbol.for("react.profiler"),eA=Symbol.for("react.provider"),tA=Symbol.for("react.context"),Vue=Symbol.for("react.server_context"),nA=Symbol.for("react.forward_ref"),iA=Symbol.for("react.suspense"),rA=Symbol.for("react.suspense_list"),aA=Symbol.for("react.memo"),oA=Symbol.for("react.lazy"),Gue=Symbol.for("react.offscreen"),iq;iq=Symbol.for("react.module.reference");function Nc(n){if(typeof n=="object"&&n!==null){var e=n.$$typeof;switch(e){case v4:switch(n=n.type,n){case KT:case QT:case JT:case iA:case rA:return n;default:switch(n=n&&n.$$typeof,n){case Vue:case tA:case nA:case oA:case aA:case eA:return n;default:return e}}case _4:return e}}}Yr.ContextConsumer=tA;Yr.ContextProvider=eA;Yr.Element=v4;Yr.ForwardRef=nA;Yr.Fragment=KT;Yr.Lazy=oA;Yr.Memo=aA;Yr.Portal=_4;Yr.Profiler=QT;Yr.StrictMode=JT;Yr.Suspense=iA;Yr.SuspenseList=rA;Yr.isAsyncMode=function(){return!1};Yr.isConcurrentMode=function(){return!1};Yr.isContextConsumer=function(n){return Nc(n)===tA};Yr.isContextProvider=function(n){return Nc(n)===eA};Yr.isElement=function(n){return typeof n=="object"&&n!==null&&n.$$typeof===v4};Yr.isForwardRef=function(n){return Nc(n)===nA};Yr.isFragment=function(n){return Nc(n)===KT};Yr.isLazy=function(n){return Nc(n)===oA};Yr.isMemo=function(n){return Nc(n)===aA};Yr.isPortal=function(n){return Nc(n)===_4};Yr.isProfiler=function(n){return Nc(n)===QT};Yr.isStrictMode=function(n){return Nc(n)===JT};Yr.isSuspense=function(n){return Nc(n)===iA};Yr.isSuspenseList=function(n){return Nc(n)===rA};Yr.isValidElementType=function(n){return typeof n=="string"||typeof n=="function"||n===KT||n===QT||n===JT||n===iA||n===rA||n===Gue||typeof n=="object"&&n!==null&&(n.$$typeof===oA||n.$$typeof===aA||n.$$typeof===eA||n.$$typeof===tA||n.$$typeof===nA||n.$$typeof===iq||n.getModuleId!==void 0)};Yr.typeOf=Nc;function ti(n){if(typeof n!="string")throw new Error(Mp(7));return n.charAt(0).toUpperCase()+n.slice(1)}function Yk(...n){return n.reduce((e,i)=>i==null?e:function(...s){e.apply(this,s),i.apply(this,s)},()=>{})}function sA(n,e=166){let i;function a(...s){const l=()=>{n.apply(this,s)};clearTimeout(i),i=setTimeout(l,e)}return a.clear=()=>{clearTimeout(i)},a}function Hue(n,e){return()=>null}function oM(n,e){var i,a;return ne.isValidElement(n)&&e.indexOf((i=n.type.muiName)!=null?i:(a=n.type)==null||(a=a._payload)==null||(a=a.value)==null?void 0:a.muiName)!==-1}function Ms(n){return n&&n.ownerDocument||document}function Md(n){return Ms(n).defaultView||window}function jue(n,e){return()=>null}function rT(n,e){typeof n=="function"?n(e):n&&(n.current=e)}const $ue=typeof window<"u"?ne.useLayoutEffect:ne.useEffect,bu=$ue;let y9=0;function Yue(n){const[e,i]=ne.useState(n),a=n||e;return ne.useEffect(()=>{e==null&&(y9+=1,i(`mui-${y9}`))},[e]),a}const v9=IM["useId".toString()];function lA(n){if(v9!==void 0){const e=v9();return n??e}return Yue(n)}function que(n,e,i,a,s){return null}function ew({controlled:n,default:e,name:i,state:a="value"}){const{current:s}=ne.useRef(n!==void 0),[l,d]=ne.useState(e),f=s?n:l,p=ne.useCallback(y=>{s||d(y)},[]);return[f,p]}function rp(n){const e=ne.useRef(n);return bu(()=>{e.current=n}),ne.useRef((...i)=>(0,e.current)(...i)).current}function Mo(...n){return ne.useMemo(()=>n.every(e=>e==null)?null:e=>{n.forEach(i=>{rT(i,e)})},n)}let cA=!0,qk=!1,_9;const Xue={text:!0,search:!0,url:!0,tel:!0,email:!0,password:!0,number:!0,date:!0,month:!0,week:!0,time:!0,datetime:!0,"datetime-local":!0};function Zue(n){const{type:e,tagName:i}=n;return!!(i==="INPUT"&&Xue[e]&&!n.readOnly||i==="TEXTAREA"&&!n.readOnly||n.isContentEditable)}function Kue(n){n.metaKey||n.altKey||n.ctrlKey||(cA=!0)}function TR(){cA=!1}function Jue(){this.visibilityState==="hidden"&&qk&&(cA=!0)}function Que(n){n.addEventListener("keydown",Kue,!0),n.addEventListener("mousedown",TR,!0),n.addEventListener("pointerdown",TR,!0),n.addEventListener("touchstart",TR,!0),n.addEventListener("visibilitychange",Jue,!0)}function ede(n){const{target:e}=n;try{return e.matches(":focus-visible")}catch{}return cA||Zue(e)}function x4(){const n=ne.useCallback(s=>{s!=null&&Que(s.ownerDocument)},[]),e=ne.useRef(!1);function i(){return e.current?(qk=!0,window.clearTimeout(_9),_9=window.setTimeout(()=>{qk=!1},100),e.current=!1,!0):!1}function a(s){return ede(s)?(e.current=!0,!0):!1}return{isFocusVisibleRef:e,onFocus:a,onBlur:i,ref:n}}function rq(n){const e=n.documentElement.clientWidth;return Math.abs(window.innerWidth-e)}function b4(n,e){const i=Ge({},e);return Object.keys(n).forEach(a=>{if(a.toString().match(/^(components|slots)$/))i[a]=Ge({},n[a],i[a]);else if(a.toString().match(/^(componentsProps|slotProps)$/)){const s=n[a]||{},l=e[a];i[a]={},!l||!Object.keys(l)?i[a]=s:!s||!Object.keys(s)?i[a]=l:(i[a]=Ge({},l),Object.keys(s).forEach(d=>{i[a][d]=b4(s[d],l[d])}))}else i[a]===void 0&&(i[a]=n[a])}),i}function er(n,e,i=void 0){const a={};return Object.keys(n).forEach(s=>{a[s]=n[s].reduce((l,d)=>{if(d){const f=e(d);f!==""&&l.push(f),i&&i[d]&&l.push(i[d])}return l},[]).join(" ")}),a}const x9=n=>n,tde=()=>{let n=x9;return{configure(e){n=e},generate(e){return n(e)},reset(){n=x9}}},nde=tde(),aq=nde,ide={active:"active",checked:"checked",completed:"completed",disabled:"disabled",error:"error",expanded:"expanded",focused:"focused",focusVisible:"focusVisible",open:"open",readOnly:"readOnly",required:"required",selected:"selected"};function Zi(n,e,i="Mui"){const a=ide[e];return a?`${i}-${a}`:`${aq.generate(n)}-${e}`}function $i(n,e,i="Mui"){const a={};return e.forEach(s=>{a[s]=Zi(n,s,i)}),a}const l_="$$material";function Wn(n,e){if(n==null)return{};var i={},a=Object.keys(n),s,l;for(l=0;l<a.length;l++)s=a[l],!(e.indexOf(s)>=0)&&(i[s]=n[s]);return i}function oq(n){var e=Object.create(null);return function(i){return e[i]===void 0&&(e[i]=n(i)),e[i]}}var rde=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|download|draggable|encType|enterKeyHint|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,ade=oq(function(n){return rde.test(n)||n.charCodeAt(0)===111&&n.charCodeAt(1)===110&&n.charCodeAt(2)<91});function ode(n){if(n.sheet)return n.sheet;for(var e=0;e<document.styleSheets.length;e++)if(document.styleSheets[e].ownerNode===n)return document.styleSheets[e]}function sde(n){var e=document.createElement("style");return e.setAttribute("data-emotion",n.key),n.nonce!==void 0&&e.setAttribute("nonce",n.nonce),e.appendChild(document.createTextNode("")),e.setAttribute("data-s",""),e}var lde=function(){function n(i){var a=this;this._insertTag=function(s){var l;a.tags.length===0?a.insertionPoint?l=a.insertionPoint.nextSibling:a.prepend?l=a.container.firstChild:l=a.before:l=a.tags[a.tags.length-1].nextSibling,a.container.insertBefore(s,l),a.tags.push(s)},this.isSpeedy=i.speedy===void 0?!0:i.speedy,this.tags=[],this.ctr=0,this.nonce=i.nonce,this.key=i.key,this.container=i.container,this.prepend=i.prepend,this.insertionPoint=i.insertionPoint,this.before=null}var e=n.prototype;return e.hydrate=function(a){a.forEach(this._insertTag)},e.insert=function(a){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(sde(this));var s=this.tags[this.tags.length-1];if(this.isSpeedy){var l=ode(s);try{l.insertRule(a,l.cssRules.length)}catch{}}else s.appendChild(document.createTextNode(a));this.ctr++},e.flush=function(){this.tags.forEach(function(a){return a.parentNode&&a.parentNode.removeChild(a)}),this.tags=[],this.ctr=0},n}(),xs="-ms-",aT="-moz-",Ir="-webkit-",sq="comm",w4="rule",S4="decl",cde="@import",lq="@keyframes",ude="@layer",dde=Math.abs,uA=String.fromCharCode,hde=Object.assign;function fde(n,e){return ts(n,0)^45?(((e<<2^ts(n,0))<<2^ts(n,1))<<2^ts(n,2))<<2^ts(n,3):0}function cq(n){return n.trim()}function pde(n,e){return(n=e.exec(n))?n[0]:n}function Rr(n,e,i){return n.replace(e,i)}function Xk(n,e){return n.indexOf(e)}function ts(n,e){return n.charCodeAt(e)|0}function tw(n,e,i){return n.slice(e,i)}function ud(n){return n.length}function E4(n){return n.length}function E3(n,e){return e.push(n),n}function mde(n,e){return n.map(e).join("")}var dA=1,c_=1,uq=0,Cl=0,wo=0,P_="";function hA(n,e,i,a,s,l,d){return{value:n,root:e,parent:i,type:a,props:s,children:l,line:dA,column:c_,length:d,return:""}}function hx(n,e){return hde(hA("",null,null,"",null,null,0),n,{length:-n.length},e)}function gde(){return wo}function yde(){return wo=Cl>0?ts(P_,--Cl):0,c_--,wo===10&&(c_=1,dA--),wo}function ec(){return wo=Cl<uq?ts(P_,Cl++):0,c_++,wo===10&&(c_=1,dA++),wo}function _d(){return ts(P_,Cl)}function sM(){return Cl}function $w(n,e){return tw(P_,n,e)}function nw(n){switch(n){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function dq(n){return dA=c_=1,uq=ud(P_=n),Cl=0,[]}function hq(n){return P_="",n}function lM(n){return cq($w(Cl-1,Zk(n===91?n+2:n===40?n+1:n)))}function vde(n){for(;(wo=_d())&&wo<33;)ec();return nw(n)>2||nw(wo)>3?"":" "}function _de(n,e){for(;--e&&ec()&&!(wo<48||wo>102||wo>57&&wo<65||wo>70&&wo<97););return $w(n,sM()+(e<6&&_d()==32&&ec()==32))}function Zk(n){for(;ec();)switch(wo){case n:return Cl;case 34:case 39:n!==34&&n!==39&&Zk(wo);break;case 40:n===41&&Zk(n);break;case 92:ec();break}return Cl}function xde(n,e){for(;ec()&&n+wo!==47+10;)if(n+wo===42+42&&_d()===47)break;return"/*"+$w(e,Cl-1)+"*"+uA(n===47?n:ec())}function bde(n){for(;!nw(_d());)ec();return $w(n,Cl)}function wde(n){return hq(cM("",null,null,null,[""],n=dq(n),0,[0],n))}function cM(n,e,i,a,s,l,d,f,p){for(var y=0,_=0,b=d,S=0,A=0,P=0,L=1,k=1,R=1,z=0,O="",F=s,H=l,$=a,Y=O;k;)switch(P=z,z=ec()){case 40:if(P!=108&&ts(Y,b-1)==58){Xk(Y+=Rr(lM(z),"&","&\f"),"&\f")!=-1&&(R=-1);break}case 34:case 39:case 91:Y+=lM(z);break;case 9:case 10:case 13:case 32:Y+=vde(P);break;case 92:Y+=_de(sM()-1,7);continue;case 47:switch(_d()){case 42:case 47:E3(Sde(xde(ec(),sM()),e,i),p);break;default:Y+="/"}break;case 123*L:f[y++]=ud(Y)*R;case 125*L:case 59:case 0:switch(z){case 0:case 125:k=0;case 59+_:R==-1&&(Y=Rr(Y,/\f/g,"")),A>0&&ud(Y)-b&&E3(A>32?w9(Y+";",a,i,b-1):w9(Rr(Y," ","")+";",a,i,b-2),p);break;case 59:Y+=";";default:if(E3($=b9(Y,e,i,y,_,s,f,O,F=[],H=[],b),l),z===123)if(_===0)cM(Y,e,$,$,F,l,b,f,H);else switch(S===99&&ts(Y,3)===110?100:S){case 100:case 108:case 109:case 115:cM(n,$,$,a&&E3(b9(n,$,$,0,0,s,f,O,s,F=[],b),H),s,H,b,f,a?F:H);break;default:cM(Y,$,$,$,[""],H,0,f,H)}}y=_=A=0,L=R=1,O=Y="",b=d;break;case 58:b=1+ud(Y),A=P;default:if(L<1){if(z==123)--L;else if(z==125&&L++==0&&yde()==125)continue}switch(Y+=uA(z),z*L){case 38:R=_>0?1:(Y+="\f",-1);break;case 44:f[y++]=(ud(Y)-1)*R,R=1;break;case 64:_d()===45&&(Y+=lM(ec())),S=_d(),_=b=ud(O=Y+=bde(sM())),z++;break;case 45:P===45&&ud(Y)==2&&(L=0)}}return l}function b9(n,e,i,a,s,l,d,f,p,y,_){for(var b=s-1,S=s===0?l:[""],A=E4(S),P=0,L=0,k=0;P<a;++P)for(var R=0,z=tw(n,b+1,b=dde(L=d[P])),O=n;R<A;++R)(O=cq(L>0?S[R]+" "+z:Rr(z,/&\f/g,S[R])))&&(p[k++]=O);return hA(n,e,i,s===0?w4:f,p,y,_)}function Sde(n,e,i){return hA(n,e,i,sq,uA(gde()),tw(n,2,-2),0)}function w9(n,e,i,a){return hA(n,e,i,S4,tw(n,0,a),tw(n,a+1,-1),a)}function q0(n,e){for(var i="",a=E4(n),s=0;s<a;s++)i+=e(n[s],s,n,e)||"";return i}function Ede(n,e,i,a){switch(n.type){case ude:if(n.children.length)break;case cde:case S4:return n.return=n.return||n.value;case sq:return"";case lq:return n.return=n.value+"{"+q0(n.children,a)+"}";case w4:n.value=n.props.join(",")}return ud(i=q0(n.children,a))?n.return=n.value+"{"+i+"}":""}function Mde(n){var e=E4(n);return function(i,a,s,l){for(var d="",f=0;f<e;f++)d+=n[f](i,a,s,l)||"";return d}}function Tde(n){return function(e){e.root||(e=e.return)&&n(e)}}var Ade=function(e,i,a){for(var s=0,l=0;s=l,l=_d(),s===38&&l===12&&(i[a]=1),!nw(l);)ec();return $w(e,Cl)},Cde=function(e,i){var a=-1,s=44;do switch(nw(s)){case 0:s===38&&_d()===12&&(i[a]=1),e[a]+=Ade(Cl-1,i,a);break;case 2:e[a]+=lM(s);break;case 4:if(s===44){e[++a]=_d()===58?"&\f":"",i[a]=e[a].length;break}default:e[a]+=uA(s)}while(s=ec());return e},Pde=function(e,i){return hq(Cde(dq(e),i))},S9=new WeakMap,Ide=function(e){if(!(e.type!=="rule"||!e.parent||e.length<1)){for(var i=e.value,a=e.parent,s=e.column===a.column&&e.line===a.line;a.type!=="rule";)if(a=a.parent,!a)return;if(!(e.props.length===1&&i.charCodeAt(0)!==58&&!S9.get(a))&&!s){S9.set(e,!0);for(var l=[],d=Pde(i,l),f=a.props,p=0,y=0;p<d.length;p++)for(var _=0;_<f.length;_++,y++)e.props[y]=l[p]?d[p].replace(/&\f/g,f[_]):f[_]+" "+d[p]}}},Rde=function(e){if(e.type==="decl"){var i=e.value;i.charCodeAt(0)===108&&i.charCodeAt(2)===98&&(e.return="",e.value="")}};function fq(n,e){switch(fde(n,e)){case 5103:return Ir+"print-"+n+n;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return Ir+n+n;case 5349:case 4246:case 4810:case 6968:case 2756:return Ir+n+aT+n+xs+n+n;case 6828:case 4268:return Ir+n+xs+n+n;case 6165:return Ir+n+xs+"flex-"+n+n;case 5187:return Ir+n+Rr(n,/(\w+).+(:[^]+)/,Ir+"box-$1$2"+xs+"flex-$1$2")+n;case 5443:return Ir+n+xs+"flex-item-"+Rr(n,/flex-|-self/,"")+n;case 4675:return Ir+n+xs+"flex-line-pack"+Rr(n,/align-content|flex-|-self/,"")+n;case 5548:return Ir+n+xs+Rr(n,"shrink","negative")+n;case 5292:return Ir+n+xs+Rr(n,"basis","preferred-size")+n;case 6060:return Ir+"box-"+Rr(n,"-grow","")+Ir+n+xs+Rr(n,"grow","positive")+n;case 4554:return Ir+Rr(n,/([^-])(transform)/g,"$1"+Ir+"$2")+n;case 6187:return Rr(Rr(Rr(n,/(zoom-|grab)/,Ir+"$1"),/(image-set)/,Ir+"$1"),n,"")+n;case 5495:case 3959:return Rr(n,/(image-set\([^]*)/,Ir+"$1$`$1");case 4968:return Rr(Rr(n,/(.+:)(flex-)?(.*)/,Ir+"box-pack:$3"+xs+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+Ir+n+n;case 4095:case 3583:case 4068:case 2532:return Rr(n,/(.+)-inline(.+)/,Ir+"$1$2")+n;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(ud(n)-1-e>6)switch(ts(n,e+1)){case 109:if(ts(n,e+4)!==45)break;case 102:return Rr(n,/(.+:)(.+)-([^]+)/,"$1"+Ir+"$2-$3$1"+aT+(ts(n,e+3)==108?"$3":"$2-$3"))+n;case 115:return~Xk(n,"stretch")?fq(Rr(n,"stretch","fill-available"),e)+n:n}break;case 4949:if(ts(n,e+1)!==115)break;case 6444:switch(ts(n,ud(n)-3-(~Xk(n,"!important")&&10))){case 107:return Rr(n,":",":"+Ir)+n;case 101:return Rr(n,/(.+:)([^;!]+)(;|!.+)?/,"$1"+Ir+(ts(n,14)===45?"inline-":"")+"box$3$1"+Ir+"$2$3$1"+xs+"$2box$3")+n}break;case 5936:switch(ts(n,e+11)){case 114:return Ir+n+xs+Rr(n,/[svh]\w+-[tblr]{2}/,"tb")+n;case 108:return Ir+n+xs+Rr(n,/[svh]\w+-[tblr]{2}/,"tb-rl")+n;case 45:return Ir+n+xs+Rr(n,/[svh]\w+-[tblr]{2}/,"lr")+n}return Ir+n+xs+n+n}return n}var Lde=function(e,i,a,s){if(e.length>-1&&!e.return)switch(e.type){case S4:e.return=fq(e.value,e.length);break;case lq:return q0([hx(e,{value:Rr(e.value,"@","@"+Ir)})],s);case w4:if(e.length)return mde(e.props,function(l){switch(pde(l,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return q0([hx(e,{props:[Rr(l,/:(read-\w+)/,":"+aT+"$1")]})],s);case"::placeholder":return q0([hx(e,{props:[Rr(l,/:(plac\w+)/,":"+Ir+"input-$1")]}),hx(e,{props:[Rr(l,/:(plac\w+)/,":"+aT+"$1")]}),hx(e,{props:[Rr(l,/:(plac\w+)/,xs+"input-$1")]})],s)}return""})}},kde=[Lde],Dde=function(e){var i=e.key;if(i==="css"){var a=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(a,function(L){var k=L.getAttribute("data-emotion");k.indexOf(" ")!==-1&&(document.head.appendChild(L),L.setAttribute("data-s",""))})}var s=e.stylisPlugins||kde,l={},d,f=[];d=e.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+i+' "]'),function(L){for(var k=L.getAttribute("data-emotion").split(" "),R=1;R<k.length;R++)l[k[R]]=!0;f.push(L)});var p,y=[Ide,Rde];{var _,b=[Ede,Tde(function(L){_.insert(L)})],S=Mde(y.concat(s,b)),A=function(k){return q0(wde(k),S)};p=function(k,R,z,O){_=z,A(k?k+"{"+R.styles+"}":R.styles),O&&(P.inserted[R.name]=!0)}}var P={key:i,sheet:new lde({key:i,container:d,nonce:e.nonce,speedy:e.speedy,prepend:e.prepend,insertionPoint:e.insertionPoint}),nonce:e.nonce,inserted:l,registered:{},insert:p};return P.sheet.hydrate(f),P},pq={exports:{}},jr={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $o=typeof Symbol=="function"&&Symbol.for,M4=$o?Symbol.for("react.element"):60103,T4=$o?Symbol.for("react.portal"):60106,fA=$o?Symbol.for("react.fragment"):60107,pA=$o?Symbol.for("react.strict_mode"):60108,mA=$o?Symbol.for("react.profiler"):60114,gA=$o?Symbol.for("react.provider"):60109,yA=$o?Symbol.for("react.context"):60110,A4=$o?Symbol.for("react.async_mode"):60111,vA=$o?Symbol.for("react.concurrent_mode"):60111,_A=$o?Symbol.for("react.forward_ref"):60112,xA=$o?Symbol.for("react.suspense"):60113,zde=$o?Symbol.for("react.suspense_list"):60120,bA=$o?Symbol.for("react.memo"):60115,wA=$o?Symbol.for("react.lazy"):60116,Ode=$o?Symbol.for("react.block"):60121,Nde=$o?Symbol.for("react.fundamental"):60117,Fde=$o?Symbol.for("react.responder"):60118,Bde=$o?Symbol.for("react.scope"):60119;function sc(n){if(typeof n=="object"&&n!==null){var e=n.$$typeof;switch(e){case M4:switch(n=n.type,n){case A4:case vA:case fA:case mA:case pA:case xA:return n;default:switch(n=n&&n.$$typeof,n){case yA:case _A:case wA:case bA:case gA:return n;default:return e}}case T4:return e}}}function mq(n){return sc(n)===vA}jr.AsyncMode=A4;jr.ConcurrentMode=vA;jr.ContextConsumer=yA;jr.ContextProvider=gA;jr.Element=M4;jr.ForwardRef=_A;jr.Fragment=fA;jr.Lazy=wA;jr.Memo=bA;jr.Portal=T4;jr.Profiler=mA;jr.StrictMode=pA;jr.Suspense=xA;jr.isAsyncMode=function(n){return mq(n)||sc(n)===A4};jr.isConcurrentMode=mq;jr.isContextConsumer=function(n){return sc(n)===yA};jr.isContextProvider=function(n){return sc(n)===gA};jr.isElement=function(n){return typeof n=="object"&&n!==null&&n.$$typeof===M4};jr.isForwardRef=function(n){return sc(n)===_A};jr.isFragment=function(n){return sc(n)===fA};jr.isLazy=function(n){return sc(n)===wA};jr.isMemo=function(n){return sc(n)===bA};jr.isPortal=function(n){return sc(n)===T4};jr.isProfiler=function(n){return sc(n)===mA};jr.isStrictMode=function(n){return sc(n)===pA};jr.isSuspense=function(n){return sc(n)===xA};jr.isValidElementType=function(n){return typeof n=="string"||typeof n=="function"||n===fA||n===vA||n===mA||n===pA||n===xA||n===zde||typeof n=="object"&&n!==null&&(n.$$typeof===wA||n.$$typeof===bA||n.$$typeof===gA||n.$$typeof===yA||n.$$typeof===_A||n.$$typeof===Nde||n.$$typeof===Fde||n.$$typeof===Bde||n.$$typeof===Ode)};jr.typeOf=sc;pq.exports=jr;var Ude=pq.exports,gq=Ude,Wde={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},Vde={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},yq={};yq[gq.ForwardRef]=Wde;yq[gq.Memo]=Vde;var Gde=!0;function vq(n,e,i){var a="";return i.split(" ").forEach(function(s){n[s]!==void 0?e.push(n[s]+";"):a+=s+" "}),a}var _q=function(e,i,a){var s=e.key+"-"+i.name;(a===!1||Gde===!1)&&e.registered[s]===void 0&&(e.registered[s]=i.styles)},C4=function(e,i,a){_q(e,i,a);var s=e.key+"-"+i.name;if(e.inserted[i.name]===void 0){var l=i;do e.insert(i===l?"."+s:"",l,e.sheet,!0),l=l.next;while(l!==void 0)}};function Hde(n){for(var e=0,i,a=0,s=n.length;s>=4;++a,s-=4)i=n.charCodeAt(a)&255|(n.charCodeAt(++a)&255)<<8|(n.charCodeAt(++a)&255)<<16|(n.charCodeAt(++a)&255)<<24,i=(i&65535)*1540483477+((i>>>16)*59797<<16),i^=i>>>24,e=(i&65535)*1540483477+((i>>>16)*59797<<16)^(e&65535)*1540483477+((e>>>16)*59797<<16);switch(s){case 3:e^=(n.charCodeAt(a+2)&255)<<16;case 2:e^=(n.charCodeAt(a+1)&255)<<8;case 1:e^=n.charCodeAt(a)&255,e=(e&65535)*1540483477+((e>>>16)*59797<<16)}return e^=e>>>13,e=(e&65535)*1540483477+((e>>>16)*59797<<16),((e^e>>>15)>>>0).toString(36)}var jde={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},$de=/[A-Z]|^ms/g,Yde=/_EMO_([^_]+?)_([^]*?)_EMO_/g,xq=function(e){return e.charCodeAt(1)===45},E9=function(e){return e!=null&&typeof e!="boolean"},AR=oq(function(n){return xq(n)?n:n.replace($de,"-$&").toLowerCase()}),M9=function(e,i){switch(e){case"animation":case"animationName":if(typeof i=="string")return i.replace(Yde,function(a,s,l){return dd={name:s,styles:l,next:dd},s})}return jde[e]!==1&&!xq(e)&&typeof i=="number"&&i!==0?i+"px":i};function iw(n,e,i){if(i==null)return"";if(i.__emotion_styles!==void 0)return i;switch(typeof i){case"boolean":return"";case"object":{if(i.anim===1)return dd={name:i.name,styles:i.styles,next:dd},i.name;if(i.styles!==void 0){var a=i.next;if(a!==void 0)for(;a!==void 0;)dd={name:a.name,styles:a.styles,next:dd},a=a.next;var s=i.styles+";";return s}return qde(n,e,i)}case"function":{if(n!==void 0){var l=dd,d=i(n);return dd=l,iw(n,e,d)}break}}if(e==null)return i;var f=e[i];return f!==void 0?f:i}function qde(n,e,i){var a="";if(Array.isArray(i))for(var s=0;s<i.length;s++)a+=iw(n,e,i[s])+";";else for(var l in i){var d=i[l];if(typeof d!="object")e!=null&&e[d]!==void 0?a+=l+"{"+e[d]+"}":E9(d)&&(a+=AR(l)+":"+M9(l,d)+";");else if(Array.isArray(d)&&typeof d[0]=="string"&&(e==null||e[d[0]]===void 0))for(var f=0;f<d.length;f++)E9(d[f])&&(a+=AR(l)+":"+M9(l,d[f])+";");else{var p=iw(n,e,d);switch(l){case"animation":case"animationName":{a+=AR(l)+":"+p+";";break}default:a+=l+"{"+p+"}"}}}return a}var T9=/label:\s*([^\s;\n{]+)\s*(;|$)/g,dd,SA=function(e,i,a){if(e.length===1&&typeof e[0]=="object"&&e[0]!==null&&e[0].styles!==void 0)return e[0];var s=!0,l="";dd=void 0;var d=e[0];d==null||d.raw===void 0?(s=!1,l+=iw(a,i,d)):l+=d[0];for(var f=1;f<e.length;f++)l+=iw(a,i,e[f]),s&&(l+=d[f]);T9.lastIndex=0;for(var p="",y;(y=T9.exec(l))!==null;)p+="-"+y[1];var _=Hde(l)+p;return{name:_,styles:l,next:dd}},Xde=function(e){return e()},bq=IM["useInsertionEffect"]?IM["useInsertionEffect"]:!1,Zde=bq||Xde,A9=bq||ne.useLayoutEffect,P4=ne.createContext(typeof HTMLElement<"u"?Dde({key:"css"}):null);P4.Provider;var Kde=function(){return ne.useContext(P4)},wq=function(e){return ne.forwardRef(function(i,a){var s=ne.useContext(P4);return e(i,s,a)})},EA=ne.createContext({}),Jde=wq(function(n,e){var i=n.styles,a=SA([i],void 0,ne.useContext(EA)),s=ne.useRef();return A9(function(){var l=e.key+"-global",d=new e.sheet.constructor({key:l,nonce:e.sheet.nonce,container:e.sheet.container,speedy:e.sheet.isSpeedy}),f=!1,p=document.querySelector('style[data-emotion="'+l+" "+a.name+'"]');return e.sheet.tags.length&&(d.before=e.sheet.tags[0]),p!==null&&(f=!0,p.setAttribute("data-emotion",l),d.hydrate([p])),s.current=[d,f],function(){d.flush()}},[e]),A9(function(){var l=s.current,d=l[0],f=l[1];if(f){l[1]=!1;return}if(a.next!==void 0&&C4(e,a.next,!0),d.tags.length){var p=d.tags[d.tags.length-1].nextElementSibling;d.before=p,d.flush()}e.insert("",a,d,!1)},[e,a.name]),null});function Qde(){for(var n=arguments.length,e=new Array(n),i=0;i<n;i++)e[i]=arguments[i];return SA(e)}var I4=function(){var e=Qde.apply(void 0,arguments),i="animation-"+e.name;return{name:i,styles:"@keyframes "+i+"{"+e.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}},ehe=ade,the=function(e){return e!=="theme"},C9=function(e){return typeof e=="string"&&e.charCodeAt(0)>96?ehe:the},P9=function(e,i,a){var s;if(i){var l=i.shouldForwardProp;s=e.__emotion_forwardProp&&l?function(d){return e.__emotion_forwardProp(d)&&l(d)}:l}return typeof s!="function"&&a&&(s=e.__emotion_forwardProp),s},nhe=function(e){var i=e.cache,a=e.serialized,s=e.isStringTag;return _q(i,a,s),Zde(function(){return C4(i,a,s)}),null},ihe=function n(e,i){var a=e.__emotion_real===e,s=a&&e.__emotion_base||e,l,d;i!==void 0&&(l=i.label,d=i.target);var f=P9(e,i,a),p=f||C9(s),y=!p("as");return function(){var _=arguments,b=a&&e.__emotion_styles!==void 0?e.__emotion_styles.slice(0):[];if(l!==void 0&&b.push("label:"+l+";"),_[0]==null||_[0].raw===void 0)b.push.apply(b,_);else{b.push(_[0][0]);for(var S=_.length,A=1;A<S;A++)b.push(_[A],_[0][A])}var P=wq(function(L,k,R){var z=y&&L.as||s,O="",F=[],H=L;if(L.theme==null){H={};for(var $ in L)H[$]=L[$];H.theme=ne.useContext(EA)}typeof L.className=="string"?O=vq(k.registered,F,L.className):L.className!=null&&(O=L.className+" ");var Y=SA(b.concat(F),k.registered,H);O+=k.key+"-"+Y.name,d!==void 0&&(O+=" "+d);var te=y&&f===void 0?C9(z):p,G={};for(var Q in L)y&&Q==="as"||te(Q)&&(G[Q]=L[Q]);return G.className=O,G.ref=R,ne.createElement(ne.Fragment,null,ne.createElement(nhe,{cache:k,serialized:Y,isStringTag:typeof z=="string"}),ne.createElement(z,G))});return P.displayName=l!==void 0?l:"Styled("+(typeof s=="string"?s:s.displayName||s.name||"Component")+")",P.defaultProps=e.defaultProps,P.__emotion_real=P,P.__emotion_base=s,P.__emotion_styles=b,P.__emotion_forwardProp=f,Object.defineProperty(P,"toString",{value:function(){return"."+d}}),P.withComponent=function(L,k){return n(L,Ge({},i,k,{shouldForwardProp:P9(P,k,!0)})).apply(void 0,b)},P}},rhe=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"],Kk=ihe.bind();rhe.forEach(function(n){Kk[n]=Kk(n)});var Sq={exports:{}},MA={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ahe=ne,ohe=Symbol.for("react.element"),she=Symbol.for("react.fragment"),lhe=Object.prototype.hasOwnProperty,che=ahe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,uhe={key:!0,ref:!0,__self:!0,__source:!0};function Eq(n,e,i){var a,s={},l=null,d=null;i!==void 0&&(l=""+i),e.key!==void 0&&(l=""+e.key),e.ref!==void 0&&(d=e.ref);for(a in e)lhe.call(e,a)&&!uhe.hasOwnProperty(a)&&(s[a]=e[a]);if(n&&n.defaultProps)for(a in e=n.defaultProps,e)s[a]===void 0&&(s[a]=e[a]);return{$$typeof:ohe,type:n,key:l,ref:d,props:s,_owner:che.current}}MA.Fragment=she;MA.jsx=Eq;MA.jsxs=Eq;Sq.exports=MA;var R4=Sq.exports;const U=R4.jsx,_e=R4.jsxs,ko=R4.Fragment,dhe=Object.freeze(Object.defineProperty({__proto__:null,Fragment:ko,jsx:U,jsxs:_e},Symbol.toStringTag,{value:"Module"}));function hhe(n){return n==null||Object.keys(n).length===0}function fhe(n){const{styles:e,defaultTheme:i={}}=n;return U(Jde,{styles:typeof e=="function"?s=>e(hhe(s)?i:s):e})}/**
 * @mui/styled-engine v5.14.17
 *
 * @license MIT
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */function phe(n,e){return Kk(n,e)}const mhe=(n,e)=>{Array.isArray(n.__emotion_styles)&&(n.__emotion_styles=e(n.__emotion_styles))},ghe=["values","unit","step"],yhe=n=>{const e=Object.keys(n).map(i=>({key:i,val:n[i]}))||[];return e.sort((i,a)=>i.val-a.val),e.reduce((i,a)=>Ge({},i,{[a.key]:a.val}),{})};function vhe(n){const{values:e={xs:0,sm:600,md:900,lg:1200,xl:1536},unit:i="px",step:a=5}=n,s=Wn(n,ghe),l=yhe(e),d=Object.keys(l);function f(S){return`@media (min-width:${typeof e[S]=="number"?e[S]:S}${i})`}function p(S){return`@media (max-width:${(typeof e[S]=="number"?e[S]:S)-a/100}${i})`}function y(S,A){const P=d.indexOf(A);return`@media (min-width:${typeof e[S]=="number"?e[S]:S}${i}) and (max-width:${(P!==-1&&typeof e[d[P]]=="number"?e[d[P]]:A)-a/100}${i})`}function _(S){return d.indexOf(S)+1<d.length?y(S,d[d.indexOf(S)+1]):f(S)}function b(S){const A=d.indexOf(S);return A===0?f(d[1]):A===d.length-1?p(d[A]):y(S,d[d.indexOf(S)+1]).replace("@media","@media not all and")}return Ge({keys:d,values:l,up:f,down:p,between:y,only:_,not:b,unit:i},s)}const _he={borderRadius:4},xhe=_he;function hb(n,e){return e?Ml(n,e,{clone:!1}):n}const L4={xs:0,sm:600,md:900,lg:1200,xl:1536},I9={keys:["xs","sm","md","lg","xl"],up:n=>`@media (min-width:${L4[n]}px)`};function Dc(n,e,i){const a=n.theme||{};if(Array.isArray(e)){const l=a.breakpoints||I9;return e.reduce((d,f,p)=>(d[l.up(l.keys[p])]=i(e[p]),d),{})}if(typeof e=="object"){const l=a.breakpoints||I9;return Object.keys(e).reduce((d,f)=>{if(Object.keys(l.values||L4).indexOf(f)!==-1){const p=l.up(f);d[p]=i(e[f],f)}else{const p=f;d[p]=e[p]}return d},{})}return i(e)}function bhe(n={}){var e;return((e=n.keys)==null?void 0:e.reduce((a,s)=>{const l=n.up(s);return a[l]={},a},{}))||{}}function whe(n,e){return n.reduce((i,a)=>{const s=i[a];return(!s||Object.keys(s).length===0)&&delete i[a],i},e)}function She(n,e){if(typeof n!="object")return{};const i={},a=Object.keys(e);return Array.isArray(n)?a.forEach((s,l)=>{l<n.length&&(i[s]=!0)}):a.forEach(s=>{n[s]!=null&&(i[s]=!0)}),i}function TA({values:n,breakpoints:e,base:i}){const a=i||She(n,e),s=Object.keys(a);if(s.length===0)return n;let l;return s.reduce((d,f,p)=>(Array.isArray(n)?(d[f]=n[p]!=null?n[p]:n[l],l=p):typeof n=="object"?(d[f]=n[f]!=null?n[f]:n[l],l=f):d[f]=n,d),{})}function AA(n,e,i=!0){if(!e||typeof e!="string")return null;if(n&&n.vars&&i){const a=`vars.${e}`.split(".").reduce((s,l)=>s&&s[l]?s[l]:null,n);if(a!=null)return a}return e.split(".").reduce((a,s)=>a&&a[s]!=null?a[s]:null,n)}function oT(n,e,i,a=i){let s;return typeof n=="function"?s=n(i):Array.isArray(n)?s=n[i]||a:s=AA(n,i)||a,e&&(s=e(s,a,n)),s}function Nr(n){const{prop:e,cssProperty:i=n.prop,themeKey:a,transform:s}=n,l=d=>{if(d[e]==null)return null;const f=d[e],p=d.theme,y=AA(p,a)||{};return Dc(d,f,b=>{let S=oT(y,s,b);return b===S&&typeof b=="string"&&(S=oT(y,s,`${e}${b==="default"?"":ti(b)}`,b)),i===!1?S:{[i]:S}})};return l.propTypes={},l.filterProps=[e],l}function Ehe(n){const e={};return i=>(e[i]===void 0&&(e[i]=n(i)),e[i])}const Mhe={m:"margin",p:"padding"},The={t:"Top",r:"Right",b:"Bottom",l:"Left",x:["Left","Right"],y:["Top","Bottom"]},R9={marginX:"mx",marginY:"my",paddingX:"px",paddingY:"py"},Ahe=Ehe(n=>{if(n.length>2)if(R9[n])n=R9[n];else return[n];const[e,i]=n.split(""),a=Mhe[e],s=The[i]||"";return Array.isArray(s)?s.map(l=>a+l):[a+s]}),k4=["m","mt","mr","mb","ml","mx","my","margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","marginInline","marginInlineStart","marginInlineEnd","marginBlock","marginBlockStart","marginBlockEnd"],D4=["p","pt","pr","pb","pl","px","py","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","paddingX","paddingY","paddingInline","paddingInlineStart","paddingInlineEnd","paddingBlock","paddingBlockStart","paddingBlockEnd"];[...k4,...D4];function Yw(n,e,i,a){var s;const l=(s=AA(n,e,!1))!=null?s:i;return typeof l=="number"?d=>typeof d=="string"?d:l*d:Array.isArray(l)?d=>typeof d=="string"?d:l[d]:typeof l=="function"?l:()=>{}}function Mq(n){return Yw(n,"spacing",8)}function qw(n,e){if(typeof e=="string"||e==null)return e;const i=Math.abs(e),a=n(i);return e>=0?a:typeof a=="number"?-a:`-${a}`}function Che(n,e){return i=>n.reduce((a,s)=>(a[s]=qw(e,i),a),{})}function Phe(n,e,i,a){if(e.indexOf(i)===-1)return null;const s=Ahe(i),l=Che(s,a),d=n[i];return Dc(n,d,l)}function Tq(n,e){const i=Mq(n.theme);return Object.keys(n).map(a=>Phe(n,e,a,i)).reduce(hb,{})}function Ha(n){return Tq(n,k4)}Ha.propTypes={};Ha.filterProps=k4;function ja(n){return Tq(n,D4)}ja.propTypes={};ja.filterProps=D4;function Ihe(n=8){if(n.mui)return n;const e=Mq({spacing:n}),i=(...a)=>(a.length===0?[1]:a).map(l=>{const d=e(l);return typeof d=="number"?`${d}px`:d}).join(" ");return i.mui=!0,i}function CA(...n){const e=n.reduce((a,s)=>(s.filterProps.forEach(l=>{a[l]=s}),a),{}),i=a=>Object.keys(a).reduce((s,l)=>e[l]?hb(s,e[l](a)):s,{});return i.propTypes={},i.filterProps=n.reduce((a,s)=>a.concat(s.filterProps),[]),i}function fd(n){return typeof n!="number"?n:`${n}px solid`}const Rhe=Nr({prop:"border",themeKey:"borders",transform:fd}),Lhe=Nr({prop:"borderTop",themeKey:"borders",transform:fd}),khe=Nr({prop:"borderRight",themeKey:"borders",transform:fd}),Dhe=Nr({prop:"borderBottom",themeKey:"borders",transform:fd}),zhe=Nr({prop:"borderLeft",themeKey:"borders",transform:fd}),Ohe=Nr({prop:"borderColor",themeKey:"palette"}),Nhe=Nr({prop:"borderTopColor",themeKey:"palette"}),Fhe=Nr({prop:"borderRightColor",themeKey:"palette"}),Bhe=Nr({prop:"borderBottomColor",themeKey:"palette"}),Uhe=Nr({prop:"borderLeftColor",themeKey:"palette"}),PA=n=>{if(n.borderRadius!==void 0&&n.borderRadius!==null){const e=Yw(n.theme,"shape.borderRadius",4),i=a=>({borderRadius:qw(e,a)});return Dc(n,n.borderRadius,i)}return null};PA.propTypes={};PA.filterProps=["borderRadius"];CA(Rhe,Lhe,khe,Dhe,zhe,Ohe,Nhe,Fhe,Bhe,Uhe,PA);const IA=n=>{if(n.gap!==void 0&&n.gap!==null){const e=Yw(n.theme,"spacing",8),i=a=>({gap:qw(e,a)});return Dc(n,n.gap,i)}return null};IA.propTypes={};IA.filterProps=["gap"];const RA=n=>{if(n.columnGap!==void 0&&n.columnGap!==null){const e=Yw(n.theme,"spacing",8),i=a=>({columnGap:qw(e,a)});return Dc(n,n.columnGap,i)}return null};RA.propTypes={};RA.filterProps=["columnGap"];const LA=n=>{if(n.rowGap!==void 0&&n.rowGap!==null){const e=Yw(n.theme,"spacing",8),i=a=>({rowGap:qw(e,a)});return Dc(n,n.rowGap,i)}return null};LA.propTypes={};LA.filterProps=["rowGap"];const Whe=Nr({prop:"gridColumn"}),Vhe=Nr({prop:"gridRow"}),Ghe=Nr({prop:"gridAutoFlow"}),Hhe=Nr({prop:"gridAutoColumns"}),jhe=Nr({prop:"gridAutoRows"}),$he=Nr({prop:"gridTemplateColumns"}),Yhe=Nr({prop:"gridTemplateRows"}),qhe=Nr({prop:"gridTemplateAreas"}),Xhe=Nr({prop:"gridArea"});CA(IA,RA,LA,Whe,Vhe,Ghe,Hhe,jhe,$he,Yhe,qhe,Xhe);function X0(n,e){return e==="grey"?e:n}const Zhe=Nr({prop:"color",themeKey:"palette",transform:X0}),Khe=Nr({prop:"bgcolor",cssProperty:"backgroundColor",themeKey:"palette",transform:X0}),Jhe=Nr({prop:"backgroundColor",themeKey:"palette",transform:X0});CA(Zhe,Khe,Jhe);function ql(n){return n<=1&&n!==0?`${n*100}%`:n}const Qhe=Nr({prop:"width",transform:ql}),z4=n=>{if(n.maxWidth!==void 0&&n.maxWidth!==null){const e=i=>{var a,s;const l=((a=n.theme)==null||(a=a.breakpoints)==null||(a=a.values)==null?void 0:a[i])||L4[i];return l?((s=n.theme)==null||(s=s.breakpoints)==null?void 0:s.unit)!=="px"?{maxWidth:`${l}${n.theme.breakpoints.unit}`}:{maxWidth:l}:{maxWidth:ql(i)}};return Dc(n,n.maxWidth,e)}return null};z4.filterProps=["maxWidth"];const efe=Nr({prop:"minWidth",transform:ql}),tfe=Nr({prop:"height",transform:ql}),nfe=Nr({prop:"maxHeight",transform:ql}),ife=Nr({prop:"minHeight",transform:ql});Nr({prop:"size",cssProperty:"width",transform:ql});Nr({prop:"size",cssProperty:"height",transform:ql});const rfe=Nr({prop:"boxSizing"});CA(Qhe,z4,efe,tfe,nfe,ife,rfe);const afe={border:{themeKey:"borders",transform:fd},borderTop:{themeKey:"borders",transform:fd},borderRight:{themeKey:"borders",transform:fd},borderBottom:{themeKey:"borders",transform:fd},borderLeft:{themeKey:"borders",transform:fd},borderColor:{themeKey:"palette"},borderTopColor:{themeKey:"palette"},borderRightColor:{themeKey:"palette"},borderBottomColor:{themeKey:"palette"},borderLeftColor:{themeKey:"palette"},borderRadius:{themeKey:"shape.borderRadius",style:PA},color:{themeKey:"palette",transform:X0},bgcolor:{themeKey:"palette",cssProperty:"backgroundColor",transform:X0},backgroundColor:{themeKey:"palette",transform:X0},p:{style:ja},pt:{style:ja},pr:{style:ja},pb:{style:ja},pl:{style:ja},px:{style:ja},py:{style:ja},padding:{style:ja},paddingTop:{style:ja},paddingRight:{style:ja},paddingBottom:{style:ja},paddingLeft:{style:ja},paddingX:{style:ja},paddingY:{style:ja},paddingInline:{style:ja},paddingInlineStart:{style:ja},paddingInlineEnd:{style:ja},paddingBlock:{style:ja},paddingBlockStart:{style:ja},paddingBlockEnd:{style:ja},m:{style:Ha},mt:{style:Ha},mr:{style:Ha},mb:{style:Ha},ml:{style:Ha},mx:{style:Ha},my:{style:Ha},margin:{style:Ha},marginTop:{style:Ha},marginRight:{style:Ha},marginBottom:{style:Ha},marginLeft:{style:Ha},marginX:{style:Ha},marginY:{style:Ha},marginInline:{style:Ha},marginInlineStart:{style:Ha},marginInlineEnd:{style:Ha},marginBlock:{style:Ha},marginBlockStart:{style:Ha},marginBlockEnd:{style:Ha},displayPrint:{cssProperty:!1,transform:n=>({"@media print":{display:n}})},display:{},overflow:{},textOverflow:{},visibility:{},whiteSpace:{},flexBasis:{},flexDirection:{},flexWrap:{},justifyContent:{},alignItems:{},alignContent:{},order:{},flex:{},flexGrow:{},flexShrink:{},alignSelf:{},justifyItems:{},justifySelf:{},gap:{style:IA},rowGap:{style:LA},columnGap:{style:RA},gridColumn:{},gridRow:{},gridAutoFlow:{},gridAutoColumns:{},gridAutoRows:{},gridTemplateColumns:{},gridTemplateRows:{},gridTemplateAreas:{},gridArea:{},position:{},zIndex:{themeKey:"zIndex"},top:{},right:{},bottom:{},left:{},boxShadow:{themeKey:"shadows"},width:{transform:ql},maxWidth:{style:z4},minWidth:{transform:ql},height:{transform:ql},maxHeight:{transform:ql},minHeight:{transform:ql},boxSizing:{},fontFamily:{themeKey:"typography"},fontSize:{themeKey:"typography"},fontStyle:{themeKey:"typography"},fontWeight:{themeKey:"typography"},letterSpacing:{},textTransform:{},lineHeight:{},textAlign:{},typography:{cssProperty:!1,themeKey:"typography"}},kA=afe;function ofe(...n){const e=n.reduce((a,s)=>a.concat(Object.keys(s)),[]),i=new Set(e);return n.every(a=>i.size===Object.keys(a).length)}function sfe(n,e){return typeof n=="function"?n(e):n}function lfe(){function n(i,a,s,l){const d={[i]:a,theme:s},f=l[i];if(!f)return{[i]:a};const{cssProperty:p=i,themeKey:y,transform:_,style:b}=f;if(a==null)return null;if(y==="typography"&&a==="inherit")return{[i]:a};const S=AA(s,y)||{};return b?b(d):Dc(d,a,P=>{let L=oT(S,_,P);return P===L&&typeof P=="string"&&(L=oT(S,_,`${i}${P==="default"?"":ti(P)}`,P)),p===!1?L:{[p]:L}})}function e(i){var a;const{sx:s,theme:l={}}=i||{};if(!s)return null;const d=(a=l.unstable_sxConfig)!=null?a:kA;function f(p){let y=p;if(typeof p=="function")y=p(l);else if(typeof p!="object")return p;if(!y)return null;const _=bhe(l.breakpoints),b=Object.keys(_);let S=_;return Object.keys(y).forEach(A=>{const P=sfe(y[A],l);if(P!=null)if(typeof P=="object")if(d[A])S=hb(S,n(A,P,l,d));else{const L=Dc({theme:l},P,k=>({[A]:k}));ofe(L,P)?S[A]=e({sx:P,theme:l}):S=hb(S,L)}else S=hb(S,n(A,P,l,d))}),whe(b,S)}return Array.isArray(s)?s.map(f):f(s)}return e}const Aq=lfe();Aq.filterProps=["sx"];const O4=Aq,cfe=["breakpoints","palette","spacing","shape"];function N4(n={},...e){const{breakpoints:i={},palette:a={},spacing:s,shape:l={}}=n,d=Wn(n,cfe),f=vhe(i),p=Ihe(s);let y=Ml({breakpoints:f,direction:"ltr",components:{},palette:Ge({mode:"light"},a),spacing:p,shape:Ge({},xhe,l)},d);return y=e.reduce((_,b)=>Ml(_,b),y),y.unstable_sxConfig=Ge({},kA,d==null?void 0:d.unstable_sxConfig),y.unstable_sx=function(b){return O4({sx:b,theme:this})},y}function ufe(n){return Object.keys(n).length===0}function F4(n=null){const e=ne.useContext(EA);return!e||ufe(e)?n:e}const dfe=N4();function B4(n=dfe){return F4(n)}function hfe({styles:n,themeId:e,defaultTheme:i={}}){const a=B4(i),s=typeof n=="function"?n(e&&a[e]||a):n;return U(fhe,{styles:s})}const ffe=["sx"],pfe=n=>{var e,i;const a={systemProps:{},otherProps:{}},s=(e=n==null||(i=n.theme)==null?void 0:i.unstable_sxConfig)!=null?e:kA;return Object.keys(n).forEach(l=>{s[l]?a.systemProps[l]=n[l]:a.otherProps[l]=n[l]}),a};function Cq(n){const{sx:e}=n,i=Wn(n,ffe),{systemProps:a,otherProps:s}=pfe(i);let l;return Array.isArray(e)?l=[a,...e]:typeof e=="function"?l=(...d)=>{const f=e(...d);return Rh(f)?Ge({},a,f):a}:l=Ge({},a,e),Ge({},s,{sx:l})}function Pq(n){var e,i,a="";if(typeof n=="string"||typeof n=="number")a+=n;else if(typeof n=="object")if(Array.isArray(n))for(e=0;e<n.length;e++)n[e]&&(i=Pq(n[e]))&&(a&&(a+=" "),a+=i);else for(e in n)n[e]&&(a&&(a+=" "),a+=e);return a}function fi(){for(var n,e,i=0,a="";i<arguments.length;)(n=arguments[i++])&&(e=Pq(n))&&(a&&(a+=" "),a+=e);return a}const mfe=["variant"];function L9(n){return n.length===0}function Iq(n){const{variant:e}=n,i=Wn(n,mfe);let a=e||"";return Object.keys(i).sort().forEach(s=>{s==="color"?a+=L9(a)?n[s]:ti(n[s]):a+=`${L9(a)?s:ti(s)}${ti(n[s].toString())}`}),a}const gfe=["name","slot","skipVariantsResolver","skipSx","overridesResolver"];function yfe(n){return Object.keys(n).length===0}function vfe(n){return typeof n=="string"&&n.charCodeAt(0)>96}const _fe=(n,e)=>e.components&&e.components[n]&&e.components[n].styleOverrides?e.components[n].styleOverrides:null,sT=n=>{const e={};return n&&n.forEach(i=>{const a=Iq(i.props);e[a]=i.style}),e},xfe=(n,e)=>{let i=[];return e&&e.components&&e.components[n]&&e.components[n].variants&&(i=e.components[n].variants),sT(i)},lT=(n,e,i)=>{const{ownerState:a={}}=n,s=[];return i&&i.forEach(l=>{let d=!0;Object.keys(l.props).forEach(f=>{a[f]!==l.props[f]&&n[f]!==l.props[f]&&(d=!1)}),d&&s.push(e[Iq(l.props)])}),s},bfe=(n,e,i,a)=>{var s;const l=i==null||(s=i.components)==null||(s=s[a])==null?void 0:s.variants;return lT(n,e,l)};function fb(n){return n!=="ownerState"&&n!=="theme"&&n!=="sx"&&n!=="as"}const wfe=N4(),Sfe=n=>n&&n.charAt(0).toLowerCase()+n.slice(1);function uM({defaultTheme:n,theme:e,themeId:i}){return yfe(e)?n:e[i]||e}function Efe(n){return n?(e,i)=>i[n]:null}const k9=({styledArg:n,props:e,defaultTheme:i,themeId:a})=>{const s=n(Ge({},e,{theme:uM(Ge({},e,{defaultTheme:i,themeId:a}))}));let l;if(s&&s.variants&&(l=s.variants,delete s.variants),l){const d=lT(e,sT(l),l);return[s,...d]}return s};function Mfe(n={}){const{themeId:e,defaultTheme:i=wfe,rootShouldForwardProp:a=fb,slotShouldForwardProp:s=fb}=n,l=d=>O4(Ge({},d,{theme:uM(Ge({},d,{defaultTheme:i,themeId:e}))}));return l.__mui_systemSx=!0,(d,f={})=>{mhe(d,F=>F.filter(H=>!(H!=null&&H.__mui_systemSx)));const{name:p,slot:y,skipVariantsResolver:_,skipSx:b,overridesResolver:S=Efe(Sfe(y))}=f,A=Wn(f,gfe),P=_!==void 0?_:y&&y!=="Root"&&y!=="root"||!1,L=b||!1;let k,R=fb;y==="Root"||y==="root"?R=a:y?R=s:vfe(d)&&(R=void 0);const z=phe(d,Ge({shouldForwardProp:R,label:k},A)),O=(F,...H)=>{const $=H?H.map(Q=>{if(typeof Q=="function"&&Q.__emotion_real!==Q)return he=>k9({styledArg:Q,props:he,defaultTheme:i,themeId:e});if(Rh(Q)){let he=Q,pe;return Q&&Q.variants&&(pe=Q.variants,delete he.variants,he=ye=>{let fe=Q;return lT(ye,sT(pe),pe).forEach(Re=>{fe=Ml(fe,Re)}),fe}),he}return Q}):[];let Y=F;if(Rh(F)){let Q;F&&F.variants&&(Q=F.variants,delete Y.variants,Y=he=>{let pe=F;return lT(he,sT(Q),Q).forEach(fe=>{pe=Ml(pe,fe)}),pe})}else typeof F=="function"&&F.__emotion_real!==F&&(Y=Q=>k9({styledArg:F,props:Q,defaultTheme:i,themeId:e}));p&&S&&$.push(Q=>{const he=uM(Ge({},Q,{defaultTheme:i,themeId:e})),pe=_fe(p,he);if(pe){const ye={};return Object.entries(pe).forEach(([fe,Ae])=>{ye[fe]=typeof Ae=="function"?Ae(Ge({},Q,{theme:he})):Ae}),S(Q,ye)}return null}),p&&!P&&$.push(Q=>{const he=uM(Ge({},Q,{defaultTheme:i,themeId:e}));return bfe(Q,xfe(p,he),he,p)}),L||$.push(l);const te=$.length-H.length;if(Array.isArray(F)&&te>0){const Q=new Array(te).fill("");Y=[...F,...Q],Y.raw=[...F.raw,...Q]}const G=z(Y,...$);return d.muiName&&(G.muiName=d.muiName),G};return z.withConfig&&(O.withConfig=z.withConfig),O}}function Tfe(n){const{theme:e,name:i,props:a}=n;return!e||!e.components||!e.components[i]||!e.components[i].defaultProps?a:b4(e.components[i].defaultProps,a)}function Afe({props:n,name:e,defaultTheme:i,themeId:a}){let s=B4(i);return a&&(s=s[a]||s),Tfe({theme:s,name:e,props:n})}function U4(n,e=0,i=1){return Math.min(Math.max(e,n),i)}function Cfe(n){n=n.slice(1);const e=new RegExp(`.{1,${n.length>=6?2:1}}`,"g");let i=n.match(e);return i&&i[0].length===1&&(i=i.map(a=>a+a)),i?`rgb${i.length===4?"a":""}(${i.map((a,s)=>s<3?parseInt(a,16):Math.round(parseInt(a,16)/255*1e3)/1e3).join(", ")})`:""}function Wg(n){if(n.type)return n;if(n.charAt(0)==="#")return Wg(Cfe(n));const e=n.indexOf("("),i=n.substring(0,e);if(["rgb","rgba","hsl","hsla","color"].indexOf(i)===-1)throw new Error(Mp(9,n));let a=n.substring(e+1,n.length-1),s;if(i==="color"){if(a=a.split(" "),s=a.shift(),a.length===4&&a[3].charAt(0)==="/"&&(a[3]=a[3].slice(1)),["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].indexOf(s)===-1)throw new Error(Mp(10,s))}else a=a.split(",");return a=a.map(l=>parseFloat(l)),{type:i,values:a,colorSpace:s}}function DA(n){const{type:e,colorSpace:i}=n;let{values:a}=n;return e.indexOf("rgb")!==-1?a=a.map((s,l)=>l<3?parseInt(s,10):s):e.indexOf("hsl")!==-1&&(a[1]=`${a[1]}%`,a[2]=`${a[2]}%`),e.indexOf("color")!==-1?a=`${i} ${a.join(" ")}`:a=`${a.join(", ")}`,`${e}(${a})`}function Pfe(n){n=Wg(n);const{values:e}=n,i=e[0],a=e[1]/100,s=e[2]/100,l=a*Math.min(s,1-s),d=(y,_=(y+i/30)%12)=>s-l*Math.max(Math.min(_-3,9-_,1),-1);let f="rgb";const p=[Math.round(d(0)*255),Math.round(d(8)*255),Math.round(d(4)*255)];return n.type==="hsla"&&(f+="a",p.push(e[3])),DA({type:f,values:p})}function D9(n){n=Wg(n);let e=n.type==="hsl"||n.type==="hsla"?Wg(Pfe(n)).values:n.values;return e=e.map(i=>(n.type!=="color"&&(i/=255),i<=.03928?i/12.92:((i+.055)/1.055)**2.4)),Number((.2126*e[0]+.7152*e[1]+.0722*e[2]).toFixed(3))}function Ife(n,e){const i=D9(n),a=D9(e);return(Math.max(i,a)+.05)/(Math.min(i,a)+.05)}function Sa(n,e){return n=Wg(n),e=U4(e),(n.type==="rgb"||n.type==="hsl")&&(n.type+="a"),n.type==="color"?n.values[3]=`/${e}`:n.values[3]=e,DA(n)}function W4(n,e){if(n=Wg(n),e=U4(e),n.type.indexOf("hsl")!==-1)n.values[2]*=1-e;else if(n.type.indexOf("rgb")!==-1||n.type.indexOf("color")!==-1)for(let i=0;i<3;i+=1)n.values[i]*=1-e;return DA(n)}function V4(n,e){if(n=Wg(n),e=U4(e),n.type.indexOf("hsl")!==-1)n.values[2]+=(100-n.values[2])*e;else if(n.type.indexOf("rgb")!==-1)for(let i=0;i<3;i+=1)n.values[i]+=(255-n.values[i])*e;else if(n.type.indexOf("color")!==-1)for(let i=0;i<3;i+=1)n.values[i]+=(1-n.values[i])*e;return DA(n)}const Rfe=ne.createContext(null),Rq=Rfe;function Lq(){return ne.useContext(Rq)}const Lfe=typeof Symbol=="function"&&Symbol.for,kfe=Lfe?Symbol.for("mui.nested"):"__THEME_NESTED__";function Dfe(n,e){return typeof e=="function"?e(n):Ge({},n,e)}function zfe(n){const{children:e,theme:i}=n,a=Lq(),s=ne.useMemo(()=>{const l=a===null?i:Dfe(a,i);return l!=null&&(l[kfe]=a!==null),l},[i,a]);return U(Rq.Provider,{value:s,children:e})}const z9={};function O9(n,e,i,a=!1){return ne.useMemo(()=>{const s=n&&e[n]||e;if(typeof i=="function"){const l=i(s),d=n?Ge({},e,{[n]:l}):l;return a?()=>d:d}return n?Ge({},e,{[n]:i}):Ge({},e,i)},[n,e,i,a])}function Ofe(n){const{children:e,theme:i,themeId:a}=n,s=F4(z9),l=Lq()||z9,d=O9(a,s,i),f=O9(a,l,i,!0);return U(zfe,{theme:f,children:U(EA.Provider,{value:d,children:e})})}function Nfe(n,e){return Ge({toolbar:{minHeight:56,[n.up("xs")]:{"@media (orientation: landscape)":{minHeight:48}},[n.up("sm")]:{minHeight:64}}},e)}const Ffe=["mode","contrastThreshold","tonalOffset"],N9={text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.6)",disabled:"rgba(0, 0, 0, 0.38)"},divider:"rgba(0, 0, 0, 0.12)",background:{paper:Qb.white,default:Qb.white},action:{active:"rgba(0, 0, 0, 0.54)",hover:"rgba(0, 0, 0, 0.04)",hoverOpacity:.04,selected:"rgba(0, 0, 0, 0.08)",selectedOpacity:.08,disabled:"rgba(0, 0, 0, 0.26)",disabledBackground:"rgba(0, 0, 0, 0.12)",disabledOpacity:.38,focus:"rgba(0, 0, 0, 0.12)",focusOpacity:.12,activatedOpacity:.12}},CR={text:{primary:Qb.white,secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",icon:"rgba(255, 255, 255, 0.5)"},divider:"rgba(255, 255, 255, 0.12)",background:{paper:"#121212",default:"#121212"},action:{active:Qb.white,hover:"rgba(255, 255, 255, 0.08)",hoverOpacity:.08,selected:"rgba(255, 255, 255, 0.16)",selectedOpacity:.16,disabled:"rgba(255, 255, 255, 0.3)",disabledBackground:"rgba(255, 255, 255, 0.12)",disabledOpacity:.38,focus:"rgba(255, 255, 255, 0.12)",focusOpacity:.12,activatedOpacity:.24}};function F9(n,e,i,a){const s=a.light||a,l=a.dark||a*1.5;n[e]||(n.hasOwnProperty(i)?n[e]=n[i]:e==="light"?n.light=V4(n.main,s):e==="dark"&&(n.dark=W4(n.main,l)))}function Bfe(n="light"){return n==="dark"?{main:Bv[200],light:Bv[50],dark:Bv[400]}:{main:Bv[700],light:Bv[400],dark:Bv[800]}}function Ufe(n="light"){return n==="dark"?{main:Fv[200],light:Fv[50],dark:Fv[400]}:{main:Fv[500],light:Fv[300],dark:Fv[700]}}function Wfe(n="light"){return n==="dark"?{main:Nv[500],light:Nv[300],dark:Nv[700]}:{main:Nv[700],light:Nv[400],dark:Nv[800]}}function Vfe(n="light"){return n==="dark"?{main:Uv[400],light:Uv[300],dark:Uv[700]}:{main:Uv[700],light:Uv[500],dark:Uv[900]}}function Gfe(n="light"){return n==="dark"?{main:Wv[400],light:Wv[300],dark:Wv[700]}:{main:Wv[800],light:Wv[500],dark:Wv[900]}}function Hfe(n="light"){return n==="dark"?{main:dx[400],light:dx[300],dark:dx[700]}:{main:"#ed6c02",light:dx[500],dark:dx[900]}}function jfe(n){const{mode:e="light",contrastThreshold:i=3,tonalOffset:a=.2}=n,s=Wn(n,Ffe),l=n.primary||Bfe(e),d=n.secondary||Ufe(e),f=n.error||Wfe(e),p=n.info||Vfe(e),y=n.success||Gfe(e),_=n.warning||Hfe(e);function b(L){return Ife(L,CR.text.primary)>=i?CR.text.primary:N9.text.primary}const S=({color:L,name:k,mainShade:R=500,lightShade:z=300,darkShade:O=700})=>{if(L=Ge({},L),!L.main&&L[R]&&(L.main=L[R]),!L.hasOwnProperty("main"))throw new Error(Mp(11,k?` (${k})`:"",R));if(typeof L.main!="string")throw new Error(Mp(12,k?` (${k})`:"",JSON.stringify(L.main)));return F9(L,"light",z,a),F9(L,"dark",O,a),L.contrastText||(L.contrastText=b(L.main)),L},A={dark:CR,light:N9};return Ml(Ge({common:Ge({},Qb),mode:e,primary:S({color:l,name:"primary"}),secondary:S({color:d,name:"secondary",mainShade:"A400",lightShade:"A200",darkShade:"A700"}),error:S({color:f,name:"error"}),warning:S({color:_,name:"warning"}),info:S({color:p,name:"info"}),success:S({color:y,name:"success"}),grey:Wue,contrastThreshold:i,getContrastText:b,augmentColor:S,tonalOffset:a},A[e]),s)}const $fe=["fontFamily","fontSize","fontWeightLight","fontWeightRegular","fontWeightMedium","fontWeightBold","htmlFontSize","allVariants","pxToRem"];function Yfe(n){return Math.round(n*1e5)/1e5}const B9={textTransform:"uppercase"},U9='"Roboto", "Helvetica", "Arial", sans-serif';function qfe(n,e){const i=typeof e=="function"?e(n):e,{fontFamily:a=U9,fontSize:s=14,fontWeightLight:l=300,fontWeightRegular:d=400,fontWeightMedium:f=500,fontWeightBold:p=700,htmlFontSize:y=16,allVariants:_,pxToRem:b}=i,S=Wn(i,$fe),A=s/14,P=b||(R=>`${R/y*A}rem`),L=(R,z,O,F,H)=>Ge({fontFamily:a,fontWeight:R,fontSize:P(z),lineHeight:O},a===U9?{letterSpacing:`${Yfe(F/z)}em`}:{},H,_),k={h1:L(l,96,1.167,-1.5),h2:L(l,60,1.2,-.5),h3:L(d,48,1.167,0),h4:L(d,34,1.235,.25),h5:L(d,24,1.334,0),h6:L(f,20,1.6,.15),subtitle1:L(d,16,1.75,.15),subtitle2:L(f,14,1.57,.1),body1:L(d,16,1.5,.15),body2:L(d,14,1.43,.15),button:L(f,14,1.75,.4,B9),caption:L(d,12,1.66,.4),overline:L(d,12,2.66,1,B9),inherit:{fontFamily:"inherit",fontWeight:"inherit",fontSize:"inherit",lineHeight:"inherit",letterSpacing:"inherit"}};return Ml(Ge({htmlFontSize:y,pxToRem:P,fontFamily:a,fontSize:s,fontWeightLight:l,fontWeightRegular:d,fontWeightMedium:f,fontWeightBold:p},k),S,{clone:!1})}const Xfe=.2,Zfe=.14,Kfe=.12;function ba(...n){return[`${n[0]}px ${n[1]}px ${n[2]}px ${n[3]}px rgba(0,0,0,${Xfe})`,`${n[4]}px ${n[5]}px ${n[6]}px ${n[7]}px rgba(0,0,0,${Zfe})`,`${n[8]}px ${n[9]}px ${n[10]}px ${n[11]}px rgba(0,0,0,${Kfe})`].join(",")}const Jfe=["none",ba(0,2,1,-1,0,1,1,0,0,1,3,0),ba(0,3,1,-2,0,2,2,0,0,1,5,0),ba(0,3,3,-2,0,3,4,0,0,1,8,0),ba(0,2,4,-1,0,4,5,0,0,1,10,0),ba(0,3,5,-1,0,5,8,0,0,1,14,0),ba(0,3,5,-1,0,6,10,0,0,1,18,0),ba(0,4,5,-2,0,7,10,1,0,2,16,1),ba(0,5,5,-3,0,8,10,1,0,3,14,2),ba(0,5,6,-3,0,9,12,1,0,3,16,2),ba(0,6,6,-3,0,10,14,1,0,4,18,3),ba(0,6,7,-4,0,11,15,1,0,4,20,3),ba(0,7,8,-4,0,12,17,2,0,5,22,4),ba(0,7,8,-4,0,13,19,2,0,5,24,4),ba(0,7,9,-4,0,14,21,2,0,5,26,4),ba(0,8,9,-5,0,15,22,2,0,6,28,5),ba(0,8,10,-5,0,16,24,2,0,6,30,5),ba(0,8,11,-5,0,17,26,2,0,6,32,5),ba(0,9,11,-5,0,18,28,2,0,7,34,6),ba(0,9,12,-6,0,19,29,2,0,7,36,6),ba(0,10,13,-6,0,20,31,3,0,8,38,7),ba(0,10,13,-6,0,21,33,3,0,8,40,7),ba(0,10,14,-6,0,22,35,3,0,8,42,7),ba(0,11,14,-7,0,23,36,3,0,9,44,8),ba(0,11,15,-7,0,24,38,3,0,9,46,8)],Qfe=Jfe,epe=["duration","easing","delay"],tpe={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",easeIn:"cubic-bezier(0.4, 0, 1, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},npe={shortest:150,shorter:200,short:250,standard:300,complex:375,enteringScreen:225,leavingScreen:195};function W9(n){return`${Math.round(n)}ms`}function ipe(n){if(!n)return 0;const e=n/36;return Math.round((4+15*e**.25+e/5)*10)}function rpe(n){const e=Ge({},tpe,n.easing),i=Ge({},npe,n.duration);return Ge({getAutoHeightDuration:ipe,create:(s=["all"],l={})=>{const{duration:d=i.standard,easing:f=e.easeInOut,delay:p=0}=l;return Wn(l,epe),(Array.isArray(s)?s:[s]).map(y=>`${y} ${typeof d=="string"?d:W9(d)} ${f} ${typeof p=="string"?p:W9(p)}`).join(",")}},n,{easing:e,duration:i})}const ape={mobileStepper:1e3,fab:1050,speedDial:1050,appBar:1100,drawer:1200,modal:1300,snackbar:1400,tooltip:1500},ope=ape,spe=["breakpoints","mixins","spacing","palette","transitions","typography","shape"];function G4(n={},...e){const{mixins:i={},palette:a={},transitions:s={},typography:l={}}=n,d=Wn(n,spe);if(n.vars)throw new Error(Mp(18));const f=jfe(a),p=N4(n);let y=Ml(p,{mixins:Nfe(p.breakpoints,i),palette:f,shadows:Qfe.slice(),typography:qfe(f,l),transitions:rpe(s),zIndex:Ge({},ope)});return y=Ml(y,d),y=e.reduce((_,b)=>Ml(_,b),y),y.unstable_sxConfig=Ge({},kA,d==null?void 0:d.unstable_sxConfig),y.unstable_sx=function(b){return O4({sx:b,theme:this})},y}const lpe=G4(),zA=lpe;function zp(){const n=B4(zA);return n[l_]||n}function ar({props:n,name:e}){return Afe({props:n,name:e,defaultTheme:zA,themeId:l_})}const Pl=n=>fb(n)&&n!=="classes",cpe=fb,upe=Mfe({themeId:l_,defaultTheme:zA,rootShouldForwardProp:Pl}),Rn=upe,dpe=["theme"];function kq(n){let{theme:e}=n,i=Wn(n,dpe);const a=e[l_];return U(Ofe,Ge({},i,{themeId:a?l_:void 0,theme:a||e}))}const hpe=n=>{let e;return n<1?e=5.11916*n**2:e=4.5*Math.log(n+1)+2,(e/100).toFixed(2)},V9=hpe;function fpe(n){return Zi("MuiSvgIcon",n)}$i("MuiSvgIcon",["root","colorPrimary","colorSecondary","colorAction","colorError","colorDisabled","fontSizeInherit","fontSizeSmall","fontSizeMedium","fontSizeLarge"]);const ppe=["children","className","color","component","fontSize","htmlColor","inheritViewBox","titleAccess","viewBox"],mpe=n=>{const{color:e,fontSize:i,classes:a}=n,s={root:["root",e!=="inherit"&&`color${ti(e)}`,`fontSize${ti(i)}`]};return er(s,fpe,a)},gpe=Rn("svg",{name:"MuiSvgIcon",slot:"Root",overridesResolver:(n,e)=>{const{ownerState:i}=n;return[e.root,i.color!=="inherit"&&e[`color${ti(i.color)}`],e[`fontSize${ti(i.fontSize)}`]]}})(({theme:n,ownerState:e})=>{var i,a,s,l,d,f,p,y,_,b,S,A,P;return{userSelect:"none",width:"1em",height:"1em",display:"inline-block",fill:e.hasSvgAsChild?void 0:"currentColor",flexShrink:0,transition:(i=n.transitions)==null||(a=i.create)==null?void 0:a.call(i,"fill",{duration:(s=n.transitions)==null||(s=s.duration)==null?void 0:s.shorter}),fontSize:{inherit:"inherit",small:((l=n.typography)==null||(d=l.pxToRem)==null?void 0:d.call(l,20))||"1.25rem",medium:((f=n.typography)==null||(p=f.pxToRem)==null?void 0:p.call(f,24))||"1.5rem",large:((y=n.typography)==null||(_=y.pxToRem)==null?void 0:_.call(y,35))||"2.1875rem"}[e.fontSize],color:(b=(S=(n.vars||n).palette)==null||(S=S[e.color])==null?void 0:S.main)!=null?b:{action:(A=(n.vars||n).palette)==null||(A=A.action)==null?void 0:A.active,disabled:(P=(n.vars||n).palette)==null||(P=P.action)==null?void 0:P.disabled,inherit:void 0}[e.color]}}),Dq=ne.forwardRef(function(e,i){const a=ar({props:e,name:"MuiSvgIcon"}),{children:s,className:l,color:d="inherit",component:f="svg",fontSize:p="medium",htmlColor:y,inheritViewBox:_=!1,titleAccess:b,viewBox:S="0 0 24 24"}=a,A=Wn(a,ppe),P=ne.isValidElement(s)&&s.type==="svg",L=Ge({},a,{color:d,component:f,fontSize:p,instanceFontSize:e.fontSize,inheritViewBox:_,viewBox:S,hasSvgAsChild:P}),k={};_||(k.viewBox=S);const R=mpe(L);return _e(gpe,Ge({as:f,className:fi(R.root,l),focusable:"false",color:y,"aria-hidden":b?void 0:!0,role:b?"img":void 0,ref:i},k,A,P&&s.props,{ownerState:L,children:[P?s.props.children:s,b?U("title",{children:b}):null]}))});Dq.muiName="SvgIcon";const G9=Dq;function Xw(n,e){function i(a,s){return U(G9,Ge({"data-testid":`${e}Icon`,ref:s},a,{children:n}))}return i.muiName=G9.muiName,ne.memo(ne.forwardRef(i))}const ype={configure:n=>{aq.configure(n)}},vpe=Object.freeze(Object.defineProperty({__proto__:null,capitalize:ti,createChainedFunction:Yk,createSvgIcon:Xw,debounce:sA,deprecatedPropType:Hue,isMuiElement:oM,ownerDocument:Ms,ownerWindow:Md,requirePropFactory:jue,setRef:rT,unstable_ClassNameGenerator:ype,unstable_useEnhancedEffect:bu,unstable_useId:lA,unsupportedProp:que,useControlled:ew,useEventCallback:rp,useForkRef:Mo,useIsFocusVisible:x4},Symbol.toStringTag,{value:"Module"}));function Jk(n,e){return Jk=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,s){return a.__proto__=s,a},Jk(n,e)}function zq(n,e){n.prototype=Object.create(e.prototype),n.prototype.constructor=n,Jk(n,e)}const H9={disabled:!1},cT=Kl.createContext(null);var _pe=function(e){return e.scrollTop},jx="unmounted",ag="exited",og="entering",v0="entered",Qk="exiting",Zh=function(n){zq(e,n);function e(a,s){var l;l=n.call(this,a,s)||this;var d=s,f=d&&!d.isMounting?a.enter:a.appear,p;return l.appearStatus=null,a.in?f?(p=ag,l.appearStatus=og):p=v0:a.unmountOnExit||a.mountOnEnter?p=jx:p=ag,l.state={status:p},l.nextCallback=null,l}e.getDerivedStateFromProps=function(s,l){var d=s.in;return d&&l.status===jx?{status:ag}:null};var i=e.prototype;return i.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},i.componentDidUpdate=function(s){var l=null;if(s!==this.props){var d=this.state.status;this.props.in?d!==og&&d!==v0&&(l=og):(d===og||d===v0)&&(l=Qk)}this.updateStatus(!1,l)},i.componentWillUnmount=function(){this.cancelNextCallback()},i.getTimeouts=function(){var s=this.props.timeout,l,d,f;return l=d=f=s,s!=null&&typeof s!="number"&&(l=s.exit,d=s.enter,f=s.appear!==void 0?s.appear:d),{exit:l,enter:d,appear:f}},i.updateStatus=function(s,l){if(s===void 0&&(s=!1),l!==null)if(this.cancelNextCallback(),l===og){if(this.props.unmountOnExit||this.props.mountOnEnter){var d=this.props.nodeRef?this.props.nodeRef.current:Hx.findDOMNode(this);d&&_pe(d)}this.performEnter(s)}else this.performExit();else this.props.unmountOnExit&&this.state.status===ag&&this.setState({status:jx})},i.performEnter=function(s){var l=this,d=this.props.enter,f=this.context?this.context.isMounting:s,p=this.props.nodeRef?[f]:[Hx.findDOMNode(this),f],y=p[0],_=p[1],b=this.getTimeouts(),S=f?b.appear:b.enter;if(!s&&!d||H9.disabled){this.safeSetState({status:v0},function(){l.props.onEntered(y)});return}this.props.onEnter(y,_),this.safeSetState({status:og},function(){l.props.onEntering(y,_),l.onTransitionEnd(S,function(){l.safeSetState({status:v0},function(){l.props.onEntered(y,_)})})})},i.performExit=function(){var s=this,l=this.props.exit,d=this.getTimeouts(),f=this.props.nodeRef?void 0:Hx.findDOMNode(this);if(!l||H9.disabled){this.safeSetState({status:ag},function(){s.props.onExited(f)});return}this.props.onExit(f),this.safeSetState({status:Qk},function(){s.props.onExiting(f),s.onTransitionEnd(d.exit,function(){s.safeSetState({status:ag},function(){s.props.onExited(f)})})})},i.cancelNextCallback=function(){this.nextCallback!==null&&(this.nextCallback.cancel(),this.nextCallback=null)},i.safeSetState=function(s,l){l=this.setNextCallback(l),this.setState(s,l)},i.setNextCallback=function(s){var l=this,d=!0;return this.nextCallback=function(f){d&&(d=!1,l.nextCallback=null,s(f))},this.nextCallback.cancel=function(){d=!1},this.nextCallback},i.onTransitionEnd=function(s,l){this.setNextCallback(l);var d=this.props.nodeRef?this.props.nodeRef.current:Hx.findDOMNode(this),f=s==null&&!this.props.addEndListener;if(!d||f){setTimeout(this.nextCallback,0);return}if(this.props.addEndListener){var p=this.props.nodeRef?[this.nextCallback]:[d,this.nextCallback],y=p[0],_=p[1];this.props.addEndListener(y,_)}s!=null&&setTimeout(this.nextCallback,s)},i.render=function(){var s=this.state.status;if(s===jx)return null;var l=this.props,d=l.children;l.in,l.mountOnEnter,l.unmountOnExit,l.appear,l.enter,l.exit,l.timeout,l.addEndListener,l.onEnter,l.onEntering,l.onEntered,l.onExit,l.onExiting,l.onExited,l.nodeRef;var f=Wn(l,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]);return Kl.createElement(cT.Provider,{value:null},typeof d=="function"?d(s,f):Kl.cloneElement(Kl.Children.only(d),f))},e}(Kl.Component);Zh.contextType=cT;Zh.propTypes={};function Vv(){}Zh.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:Vv,onEntering:Vv,onEntered:Vv,onExit:Vv,onExiting:Vv,onExited:Vv};Zh.UNMOUNTED=jx;Zh.EXITED=ag;Zh.ENTERING=og;Zh.ENTERED=v0;Zh.EXITING=Qk;const H4=Zh;function xpe(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function j4(n,e){var i=function(l){return e&&ne.isValidElement(l)?e(l):l},a=Object.create(null);return n&&ne.Children.map(n,function(s){return s}).forEach(function(s){a[s.key]=i(s)}),a}function bpe(n,e){n=n||{},e=e||{};function i(_){return _ in e?e[_]:n[_]}var a=Object.create(null),s=[];for(var l in n)l in e?s.length&&(a[l]=s,s=[]):s.push(l);var d,f={};for(var p in e){if(a[p])for(d=0;d<a[p].length;d++){var y=a[p][d];f[a[p][d]]=i(y)}f[p]=i(p)}for(d=0;d<s.length;d++)f[s[d]]=i(s[d]);return f}function vg(n,e,i){return i[e]!=null?i[e]:n.props[e]}function wpe(n,e){return j4(n.children,function(i){return ne.cloneElement(i,{onExited:e.bind(null,i),in:!0,appear:vg(i,"appear",n),enter:vg(i,"enter",n),exit:vg(i,"exit",n)})})}function Spe(n,e,i){var a=j4(n.children),s=bpe(e,a);return Object.keys(s).forEach(function(l){var d=s[l];if(ne.isValidElement(d)){var f=l in e,p=l in a,y=e[l],_=ne.isValidElement(y)&&!y.props.in;p&&(!f||_)?s[l]=ne.cloneElement(d,{onExited:i.bind(null,d),in:!0,exit:vg(d,"exit",n),enter:vg(d,"enter",n)}):!p&&f&&!_?s[l]=ne.cloneElement(d,{in:!1}):p&&f&&ne.isValidElement(y)&&(s[l]=ne.cloneElement(d,{onExited:i.bind(null,d),in:y.props.in,exit:vg(d,"exit",n),enter:vg(d,"enter",n)}))}}),s}var Epe=Object.values||function(n){return Object.keys(n).map(function(e){return n[e]})},Mpe={component:"div",childFactory:function(e){return e}},$4=function(n){zq(e,n);function e(a,s){var l;l=n.call(this,a,s)||this;var d=l.handleExited.bind(xpe(l));return l.state={contextValue:{isMounting:!0},handleExited:d,firstRender:!0},l}var i=e.prototype;return i.componentDidMount=function(){this.mounted=!0,this.setState({contextValue:{isMounting:!1}})},i.componentWillUnmount=function(){this.mounted=!1},e.getDerivedStateFromProps=function(s,l){var d=l.children,f=l.handleExited,p=l.firstRender;return{children:p?wpe(s,f):Spe(s,d,f),firstRender:!1}},i.handleExited=function(s,l){var d=j4(this.props.children);s.key in d||(s.props.onExited&&s.props.onExited(l),this.mounted&&this.setState(function(f){var p=Ge({},f.children);return delete p[s.key],{children:p}}))},i.render=function(){var s=this.props,l=s.component,d=s.childFactory,f=Wn(s,["component","childFactory"]),p=this.state.contextValue,y=Epe(this.state.children).map(d);return delete f.appear,delete f.enter,delete f.exit,l===null?Kl.createElement(cT.Provider,{value:p},y):Kl.createElement(cT.Provider,{value:p},Kl.createElement(l,f,y))},e}(Kl.Component);$4.propTypes={};$4.defaultProps=Mpe;const Tpe=$4,Y4=n=>n.scrollTop;function u_(n,e){var i,a;const{timeout:s,easing:l,style:d={}}=n;return{duration:(i=d.transitionDuration)!=null?i:typeof s=="number"?s:s[e.mode]||0,easing:(a=d.transitionTimingFunction)!=null?a:typeof l=="object"?l[e.mode]:l,delay:d.transitionDelay}}function Ape(n){return Zi("MuiPaper",n)}$i("MuiPaper",["root","rounded","outlined","elevation","elevation0","elevation1","elevation2","elevation3","elevation4","elevation5","elevation6","elevation7","elevation8","elevation9","elevation10","elevation11","elevation12","elevation13","elevation14","elevation15","elevation16","elevation17","elevation18","elevation19","elevation20","elevation21","elevation22","elevation23","elevation24"]);const Cpe=["className","component","elevation","square","variant"],Ppe=n=>{const{square:e,elevation:i,variant:a,classes:s}=n,l={root:["root",a,!e&&"rounded",a==="elevation"&&`elevation${i}`]};return er(l,Ape,s)},Ipe=Rn("div",{name:"MuiPaper",slot:"Root",overridesResolver:(n,e)=>{const{ownerState:i}=n;return[e.root,e[i.variant],!i.square&&e.rounded,i.variant==="elevation"&&e[`elevation${i.elevation}`]]}})(({theme:n,ownerState:e})=>{var i;return Ge({backgroundColor:(n.vars||n).palette.background.paper,color:(n.vars||n).palette.text.primary,transition:n.transitions.create("box-shadow")},!e.square&&{borderRadius:n.shape.borderRadius},e.variant==="outlined"&&{border:`1px solid ${(n.vars||n).palette.divider}`},e.variant==="elevation"&&Ge({boxShadow:(n.vars||n).shadows[e.elevation]},!n.vars&&n.palette.mode==="dark"&&{backgroundImage:`linear-gradient(${Sa("#fff",V9(e.elevation))}, ${Sa("#fff",V9(e.elevation))})`},n.vars&&{backgroundImage:(i=n.vars.overlays)==null?void 0:i[e.elevation]}))}),Rpe=ne.forwardRef(function(e,i){const a=ar({props:e,name:"MuiPaper"}),{className:s,component:l="div",elevation:d=1,square:f=!1,variant:p="elevation"}=a,y=Wn(a,Cpe),_=Ge({},a,{component:l,elevation:d,square:f,variant:p}),b=Ppe(_);return U(Ipe,Ge({as:l,ownerState:_,className:fi(b.root,s),ref:i},y))}),Oq=Rpe;function Lpe(n){const{className:e,classes:i,pulsate:a=!1,rippleX:s,rippleY:l,rippleSize:d,in:f,onExited:p,timeout:y}=n,[_,b]=ne.useState(!1),S=fi(e,i.ripple,i.rippleVisible,a&&i.ripplePulsate),A={width:d,height:d,top:-(d/2)+l,left:-(d/2)+s},P=fi(i.child,_&&i.childLeaving,a&&i.childPulsate);return!f&&!_&&b(!0),ne.useEffect(()=>{if(!f&&p!=null){const L=setTimeout(p,y);return()=>{clearTimeout(L)}}},[p,f,y]),U("span",{className:S,style:A,children:U("span",{className:P})})}const kpe=$i("MuiTouchRipple",["root","ripple","rippleVisible","ripplePulsate","child","childLeaving","childPulsate"]),Tc=kpe,Dpe=["center","classes","className"];let OA=n=>n,j9,$9,Y9,q9;const e5=550,zpe=80,Ope=I4(j9||(j9=OA`
  0% {
    transform: scale(0);
    opacity: 0.1;
  }

  100% {
    transform: scale(1);
    opacity: 0.3;
  }
`)),Npe=I4($9||($9=OA`
  0% {
    opacity: 1;
  }

  100% {
    opacity: 0;
  }
`)),Fpe=I4(Y9||(Y9=OA`
  0% {
    transform: scale(1);
  }

  50% {
    transform: scale(0.92);
  }

  100% {
    transform: scale(1);
  }
`)),Bpe=Rn("span",{name:"MuiTouchRipple",slot:"Root"})({overflow:"hidden",pointerEvents:"none",position:"absolute",zIndex:0,top:0,right:0,bottom:0,left:0,borderRadius:"inherit"}),Upe=Rn(Lpe,{name:"MuiTouchRipple",slot:"Ripple"})(q9||(q9=OA`
  opacity: 0;
  position: absolute;

  &.${0} {
    opacity: 0.3;
    transform: scale(1);
    animation-name: ${0};
    animation-duration: ${0}ms;
    animation-timing-function: ${0};
  }

  &.${0} {
    animation-duration: ${0}ms;
  }

  & .${0} {
    opacity: 1;
    display: block;
    width: 100%;
    height: 100%;
    border-radius: 50%;
    background-color: currentColor;
  }

  & .${0} {
    opacity: 0;
    animation-name: ${0};
    animation-duration: ${0}ms;
    animation-timing-function: ${0};
  }

  & .${0} {
    position: absolute;
    /* @noflip */
    left: 0px;
    top: 0;
    animation-name: ${0};
    animation-duration: 2500ms;
    animation-timing-function: ${0};
    animation-iteration-count: infinite;
    animation-delay: 200ms;
  }
`),Tc.rippleVisible,Ope,e5,({theme:n})=>n.transitions.easing.easeInOut,Tc.ripplePulsate,({theme:n})=>n.transitions.duration.shorter,Tc.child,Tc.childLeaving,Npe,e5,({theme:n})=>n.transitions.easing.easeInOut,Tc.childPulsate,Fpe,({theme:n})=>n.transitions.easing.easeInOut),Wpe=ne.forwardRef(function(e,i){const a=ar({props:e,name:"MuiTouchRipple"}),{center:s=!1,classes:l={},className:d}=a,f=Wn(a,Dpe),[p,y]=ne.useState([]),_=ne.useRef(0),b=ne.useRef(null);ne.useEffect(()=>{b.current&&(b.current(),b.current=null)},[p]);const S=ne.useRef(!1),A=ne.useRef(0),P=ne.useRef(null),L=ne.useRef(null);ne.useEffect(()=>()=>{A.current&&clearTimeout(A.current)},[]);const k=ne.useCallback(F=>{const{pulsate:H,rippleX:$,rippleY:Y,rippleSize:te,cb:G}=F;y(Q=>[...Q,U(Upe,{classes:{ripple:fi(l.ripple,Tc.ripple),rippleVisible:fi(l.rippleVisible,Tc.rippleVisible),ripplePulsate:fi(l.ripplePulsate,Tc.ripplePulsate),child:fi(l.child,Tc.child),childLeaving:fi(l.childLeaving,Tc.childLeaving),childPulsate:fi(l.childPulsate,Tc.childPulsate)},timeout:e5,pulsate:H,rippleX:$,rippleY:Y,rippleSize:te},_.current)]),_.current+=1,b.current=G},[l]),R=ne.useCallback((F={},H={},$=()=>{})=>{const{pulsate:Y=!1,center:te=s||H.pulsate,fakeElement:G=!1}=H;if((F==null?void 0:F.type)==="mousedown"&&S.current){S.current=!1;return}(F==null?void 0:F.type)==="touchstart"&&(S.current=!0);const Q=G?null:L.current,he=Q?Q.getBoundingClientRect():{width:0,height:0,left:0,top:0};let pe,ye,fe;if(te||F===void 0||F.clientX===0&&F.clientY===0||!F.clientX&&!F.touches)pe=Math.round(he.width/2),ye=Math.round(he.height/2);else{const{clientX:Ae,clientY:Re}=F.touches&&F.touches.length>0?F.touches[0]:F;pe=Math.round(Ae-he.left),ye=Math.round(Re-he.top)}if(te)fe=Math.sqrt((2*he.width**2+he.height**2)/3),fe%2===0&&(fe+=1);else{const Ae=Math.max(Math.abs((Q?Q.clientWidth:0)-pe),pe)*2+2,Re=Math.max(Math.abs((Q?Q.clientHeight:0)-ye),ye)*2+2;fe=Math.sqrt(Ae**2+Re**2)}F!=null&&F.touches?P.current===null&&(P.current=()=>{k({pulsate:Y,rippleX:pe,rippleY:ye,rippleSize:fe,cb:$})},A.current=setTimeout(()=>{P.current&&(P.current(),P.current=null)},zpe)):k({pulsate:Y,rippleX:pe,rippleY:ye,rippleSize:fe,cb:$})},[s,k]),z=ne.useCallback(()=>{R({},{pulsate:!0})},[R]),O=ne.useCallback((F,H)=>{if(clearTimeout(A.current),(F==null?void 0:F.type)==="touchend"&&P.current){P.current(),P.current=null,A.current=setTimeout(()=>{O(F,H)});return}P.current=null,y($=>$.length>0?$.slice(1):$),b.current=H},[]);return ne.useImperativeHandle(i,()=>({pulsate:z,start:R,stop:O}),[z,R,O]),U(Bpe,Ge({className:fi(Tc.root,l.root,d),ref:L},f,{children:U(Tpe,{component:null,exit:!0,children:p})}))}),Vpe=Wpe;function Gpe(n){return Zi("MuiButtonBase",n)}const Hpe=$i("MuiButtonBase",["root","disabled","focusVisible"]),jpe=Hpe,$pe=["action","centerRipple","children","className","component","disabled","disableRipple","disableTouchRipple","focusRipple","focusVisibleClassName","LinkComponent","onBlur","onClick","onContextMenu","onDragLeave","onFocus","onFocusVisible","onKeyDown","onKeyUp","onMouseDown","onMouseLeave","onMouseUp","onTouchEnd","onTouchMove","onTouchStart","tabIndex","TouchRippleProps","touchRippleRef","type"],Ype=n=>{const{disabled:e,focusVisible:i,focusVisibleClassName:a,classes:s}=n,d=er({root:["root",e&&"disabled",i&&"focusVisible"]},Gpe,s);return i&&a&&(d.root+=` ${a}`),d},qpe=Rn("button",{name:"MuiButtonBase",slot:"Root",overridesResolver:(n,e)=>e.root})({display:"inline-flex",alignItems:"center",justifyContent:"center",position:"relative",boxSizing:"border-box",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle",MozAppearance:"none",WebkitAppearance:"none",textDecoration:"none",color:"inherit","&::-moz-focus-inner":{borderStyle:"none"},[`&.${jpe.disabled}`]:{pointerEvents:"none",cursor:"default"},"@media print":{colorAdjust:"exact"}}),Xpe=ne.forwardRef(function(e,i){const a=ar({props:e,name:"MuiButtonBase"}),{action:s,centerRipple:l=!1,children:d,className:f,component:p="button",disabled:y=!1,disableRipple:_=!1,disableTouchRipple:b=!1,focusRipple:S=!1,LinkComponent:A="a",onBlur:P,onClick:L,onContextMenu:k,onDragLeave:R,onFocus:z,onFocusVisible:O,onKeyDown:F,onKeyUp:H,onMouseDown:$,onMouseLeave:Y,onMouseUp:te,onTouchEnd:G,onTouchMove:Q,onTouchStart:he,tabIndex:pe=0,TouchRippleProps:ye,touchRippleRef:fe,type:Ae}=a,Re=Wn(a,$pe),Be=ne.useRef(null),le=ne.useRef(null),me=Mo(le,fe),{isFocusVisibleRef:we,onFocus:re,onBlur:Te,ref:Je}=x4(),[Xe,Ze]=ne.useState(!1);y&&Xe&&Ze(!1),ne.useImperativeHandle(s,()=>({focusVisible:()=>{Ze(!0),Be.current.focus()}}),[]);const[Fe,ct]=ne.useState(!1);ne.useEffect(()=>{ct(!0)},[]);const At=Fe&&!_&&!y;ne.useEffect(()=>{Xe&&S&&!_&&Fe&&le.current.pulsate()},[_,S,Xe,Fe]);function kt(Mt,Ut,Wt=b){return rp(Ht=>(Ut&&Ut(Ht),!Wt&&le.current&&le.current[Mt](Ht),!0))}const Kt=kt("start",$),Et=kt("stop",k),Ie=kt("stop",R),pt=kt("stop",te),gt=kt("stop",Mt=>{Xe&&Mt.preventDefault(),Y&&Y(Mt)}),_t=kt("start",he),Ue=kt("stop",G),ue=kt("stop",Q),se=kt("stop",Mt=>{Te(Mt),we.current===!1&&Ze(!1),P&&P(Mt)},!1),xe=rp(Mt=>{Be.current||(Be.current=Mt.currentTarget),re(Mt),we.current===!0&&(Ze(!0),O&&O(Mt)),z&&z(Mt)}),Ye=()=>{const Mt=Be.current;return p&&p!=="button"&&!(Mt.tagName==="A"&&Mt.href)},ze=ne.useRef(!1),st=rp(Mt=>{S&&!ze.current&&Xe&&le.current&&Mt.key===" "&&(ze.current=!0,le.current.stop(Mt,()=>{le.current.start(Mt)})),Mt.target===Mt.currentTarget&&Ye()&&Mt.key===" "&&Mt.preventDefault(),F&&F(Mt),Mt.target===Mt.currentTarget&&Ye()&&Mt.key==="Enter"&&!y&&(Mt.preventDefault(),L&&L(Mt))}),de=rp(Mt=>{S&&Mt.key===" "&&le.current&&Xe&&!Mt.defaultPrevented&&(ze.current=!1,le.current.stop(Mt,()=>{le.current.pulsate(Mt)})),H&&H(Mt),L&&Mt.target===Mt.currentTarget&&Ye()&&Mt.key===" "&&!Mt.defaultPrevented&&L(Mt)});let ie=p;ie==="button"&&(Re.href||Re.to)&&(ie=A);const Oe={};ie==="button"?(Oe.type=Ae===void 0?"button":Ae,Oe.disabled=y):(!Re.href&&!Re.to&&(Oe.role="button"),y&&(Oe["aria-disabled"]=y));const ut=Mo(i,Je,Be),it=Ge({},a,{centerRipple:l,component:p,disabled:y,disableRipple:_,disableTouchRipple:b,focusRipple:S,tabIndex:pe,focusVisible:Xe}),lt=Ype(it);return _e(qpe,Ge({as:ie,className:fi(lt.root,f),ownerState:it,onBlur:se,onClick:L,onContextMenu:Et,onFocus:xe,onKeyDown:st,onKeyUp:de,onMouseDown:Kt,onMouseLeave:gt,onMouseUp:pt,onDragLeave:Ie,onTouchEnd:Ue,onTouchMove:ue,onTouchStart:_t,ref:ut,tabIndex:y?-1:pe,type:Ae},Oe,Re,{children:[d,At?U(Vpe,Ge({ref:me,center:l},ye)):null]}))}),NA=Xpe;function Zpe(n){return Zi("MuiTypography",n)}$i("MuiTypography",["root","h1","h2","h3","h4","h5","h6","subtitle1","subtitle2","body1","body2","inherit","button","caption","overline","alignLeft","alignRight","alignCenter","alignJustify","noWrap","gutterBottom","paragraph"]);const Kpe=["align","className","component","gutterBottom","noWrap","paragraph","variant","variantMapping"],Jpe=n=>{const{align:e,gutterBottom:i,noWrap:a,paragraph:s,variant:l,classes:d}=n,f={root:["root",l,n.align!=="inherit"&&`align${ti(e)}`,i&&"gutterBottom",a&&"noWrap",s&&"paragraph"]};return er(f,Zpe,d)},Qpe=Rn("span",{name:"MuiTypography",slot:"Root",overridesResolver:(n,e)=>{const{ownerState:i}=n;return[e.root,i.variant&&e[i.variant],i.align!=="inherit"&&e[`align${ti(i.align)}`],i.noWrap&&e.noWrap,i.gutterBottom&&e.gutterBottom,i.paragraph&&e.paragraph]}})(({theme:n,ownerState:e})=>Ge({margin:0},e.variant==="inherit"&&{font:"inherit"},e.variant!=="inherit"&&n.typography[e.variant],e.align!=="inherit"&&{textAlign:e.align},e.noWrap&&{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},e.gutterBottom&&{marginBottom:"0.35em"},e.paragraph&&{marginBottom:16})),X9={h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",h6:"h6",subtitle1:"h6",subtitle2:"h6",body1:"p",body2:"p",inherit:"p"},eme={primary:"primary.main",textPrimary:"text.primary",secondary:"secondary.main",textSecondary:"text.secondary",error:"error.main"},tme=n=>eme[n]||n,nme=ne.forwardRef(function(e,i){const a=ar({props:e,name:"MuiTypography"}),s=tme(a.color),l=Cq(Ge({},a,{color:s})),{align:d="inherit",className:f,component:p,gutterBottom:y=!1,noWrap:_=!1,paragraph:b=!1,variant:S="body1",variantMapping:A=X9}=l,P=Wn(l,Kpe),L=Ge({},l,{align:d,color:s,className:f,component:p,gutterBottom:y,noWrap:_,paragraph:b,variant:S,variantMapping:A}),k=p||(b?"p":A[S]||X9[S])||"span",R=Jpe(L);return U(Qpe,Ge({as:k,ref:i,ownerState:L,className:fi(R.root,f)},P))}),nn=nme;function uT(n){return typeof n=="string"}function $x(n,e,i){return n===void 0||uT(n)?e:Ge({},e,{ownerState:Ge({},e.ownerState,i)})}const ime={disableDefaultClasses:!1},rme=ne.createContext(ime);function ame(n){const{disableDefaultClasses:e}=ne.useContext(rme);return i=>e?"":n(i)}function Nq(n,e=[]){if(n===void 0)return{};const i={};return Object.keys(n).filter(a=>a.match(/^on[A-Z]/)&&typeof n[a]=="function"&&!e.includes(a)).forEach(a=>{i[a]=n[a]}),i}function ome(n,e,i){return typeof n=="function"?n(e,i):n}function Z9(n){if(n===void 0)return{};const e={};return Object.keys(n).filter(i=>!(i.match(/^on[A-Z]/)&&typeof n[i]=="function")).forEach(i=>{e[i]=n[i]}),e}function sme(n){const{getSlotProps:e,additionalProps:i,externalSlotProps:a,externalForwardedProps:s,className:l}=n;if(!e){const A=fi(i==null?void 0:i.className,l,s==null?void 0:s.className,a==null?void 0:a.className),P=Ge({},i==null?void 0:i.style,s==null?void 0:s.style,a==null?void 0:a.style),L=Ge({},i,s,a);return A.length>0&&(L.className=A),Object.keys(P).length>0&&(L.style=P),{props:L,internalRef:void 0}}const d=Nq(Ge({},s,a)),f=Z9(a),p=Z9(s),y=e(d),_=fi(y==null?void 0:y.className,i==null?void 0:i.className,l,s==null?void 0:s.className,a==null?void 0:a.className),b=Ge({},y==null?void 0:y.style,i==null?void 0:i.style,s==null?void 0:s.style,a==null?void 0:a.style),S=Ge({},y,i,p,f);return _.length>0&&(S.className=_),Object.keys(b).length>0&&(S.style=b),{props:S,internalRef:y.ref}}const lme=["elementType","externalSlotProps","ownerState","skipResolvingSlotProps"];function Vg(n){var e;const{elementType:i,externalSlotProps:a,ownerState:s,skipResolvingSlotProps:l=!1}=n,d=Wn(n,lme),f=l?{}:ome(a,s),{props:p,internalRef:y}=sme(Ge({},d,{externalSlotProps:f})),_=Mo(y,f==null?void 0:f.ref,(e=n.additionalProps)==null?void 0:e.ref);return $x(i,Ge({},p,{ref:_}),s)}const cme=["input","select","textarea","a[href]","button","[tabindex]","audio[controls]","video[controls]",'[contenteditable]:not([contenteditable="false"])'].join(",");function ume(n){const e=parseInt(n.getAttribute("tabindex")||"",10);return Number.isNaN(e)?n.contentEditable==="true"||(n.nodeName==="AUDIO"||n.nodeName==="VIDEO"||n.nodeName==="DETAILS")&&n.getAttribute("tabindex")===null?0:n.tabIndex:e}function dme(n){if(n.tagName!=="INPUT"||n.type!=="radio"||!n.name)return!1;const e=a=>n.ownerDocument.querySelector(`input[type="radio"]${a}`);let i=e(`[name="${n.name}"]:checked`);return i||(i=e(`[name="${n.name}"]`)),i!==n}function hme(n){return!(n.disabled||n.tagName==="INPUT"&&n.type==="hidden"||dme(n))}function fme(n){const e=[],i=[];return Array.from(n.querySelectorAll(cme)).forEach((a,s)=>{const l=ume(a);l===-1||!hme(a)||(l===0?e.push(a):i.push({documentOrder:s,tabIndex:l,node:a}))}),i.sort((a,s)=>a.tabIndex===s.tabIndex?a.documentOrder-s.documentOrder:a.tabIndex-s.tabIndex).map(a=>a.node).concat(e)}function pme(){return!0}function mme(n){const{children:e,disableAutoFocus:i=!1,disableEnforceFocus:a=!1,disableRestoreFocus:s=!1,getTabbable:l=fme,isEnabled:d=pme,open:f}=n,p=ne.useRef(!1),y=ne.useRef(null),_=ne.useRef(null),b=ne.useRef(null),S=ne.useRef(null),A=ne.useRef(!1),P=ne.useRef(null),L=Mo(e.ref,P),k=ne.useRef(null);ne.useEffect(()=>{!f||!P.current||(A.current=!i)},[i,f]),ne.useEffect(()=>{if(!f||!P.current)return;const O=Ms(P.current);return P.current.contains(O.activeElement)||(P.current.hasAttribute("tabIndex")||P.current.setAttribute("tabIndex","-1"),A.current&&P.current.focus()),()=>{s||(b.current&&b.current.focus&&(p.current=!0,b.current.focus()),b.current=null)}},[f]),ne.useEffect(()=>{if(!f||!P.current)return;const O=Ms(P.current),F=Y=>{k.current=Y,!(a||!d()||Y.key!=="Tab")&&O.activeElement===P.current&&Y.shiftKey&&(p.current=!0,_.current&&_.current.focus())},H=()=>{const Y=P.current;if(Y===null)return;if(!O.hasFocus()||!d()||p.current){p.current=!1;return}if(Y.contains(O.activeElement)||a&&O.activeElement!==y.current&&O.activeElement!==_.current)return;if(O.activeElement!==S.current)S.current=null;else if(S.current!==null)return;if(!A.current)return;let te=[];if((O.activeElement===y.current||O.activeElement===_.current)&&(te=l(P.current)),te.length>0){var G,Q;const he=!!((G=k.current)!=null&&G.shiftKey&&((Q=k.current)==null?void 0:Q.key)==="Tab"),pe=te[0],ye=te[te.length-1];typeof pe!="string"&&typeof ye!="string"&&(he?ye.focus():pe.focus())}else Y.focus()};O.addEventListener("focusin",H),O.addEventListener("keydown",F,!0);const $=setInterval(()=>{O.activeElement&&O.activeElement.tagName==="BODY"&&H()},50);return()=>{clearInterval($),O.removeEventListener("focusin",H),O.removeEventListener("keydown",F,!0)}},[i,a,s,d,f,l]);const R=O=>{b.current===null&&(b.current=O.relatedTarget),A.current=!0,S.current=O.target;const F=e.props.onFocus;F&&F(O)},z=O=>{b.current===null&&(b.current=O.relatedTarget),A.current=!0};return _e(ne.Fragment,{children:[U("div",{tabIndex:f?0:-1,onFocus:z,ref:y,"data-testid":"sentinelStart"}),ne.cloneElement(e,{ref:L,onFocus:R}),U("div",{tabIndex:f?0:-1,onFocus:z,ref:_,"data-testid":"sentinelEnd"})]})}var Tl="top",zc="bottom",Oc="right",Al="left",q4="auto",Zw=[Tl,zc,Oc,Al],d_="start",rw="end",gme="clippingParents",Fq="viewport",fx="popper",yme="reference",K9=Zw.reduce(function(n,e){return n.concat([e+"-"+d_,e+"-"+rw])},[]),Bq=[].concat(Zw,[q4]).reduce(function(n,e){return n.concat([e,e+"-"+d_,e+"-"+rw])},[]),vme="beforeRead",_me="read",xme="afterRead",bme="beforeMain",wme="main",Sme="afterMain",Eme="beforeWrite",Mme="write",Tme="afterWrite",Ame=[vme,_me,xme,bme,wme,Sme,Eme,Mme,Tme];function Td(n){return n?(n.nodeName||"").toLowerCase():null}function ic(n){if(n==null)return window;if(n.toString()!=="[object Window]"){var e=n.ownerDocument;return e&&e.defaultView||window}return n}function Gg(n){var e=ic(n).Element;return n instanceof e||n instanceof Element}function Rc(n){var e=ic(n).HTMLElement;return n instanceof e||n instanceof HTMLElement}function X4(n){if(typeof ShadowRoot>"u")return!1;var e=ic(n).ShadowRoot;return n instanceof e||n instanceof ShadowRoot}function Cme(n){var e=n.state;Object.keys(e.elements).forEach(function(i){var a=e.styles[i]||{},s=e.attributes[i]||{},l=e.elements[i];!Rc(l)||!Td(l)||(Object.assign(l.style,a),Object.keys(s).forEach(function(d){var f=s[d];f===!1?l.removeAttribute(d):l.setAttribute(d,f===!0?"":f)}))})}function Pme(n){var e=n.state,i={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,i.popper),e.styles=i,e.elements.arrow&&Object.assign(e.elements.arrow.style,i.arrow),function(){Object.keys(e.elements).forEach(function(a){var s=e.elements[a],l=e.attributes[a]||{},d=Object.keys(e.styles.hasOwnProperty(a)?e.styles[a]:i[a]),f=d.reduce(function(p,y){return p[y]="",p},{});!Rc(s)||!Td(s)||(Object.assign(s.style,f),Object.keys(l).forEach(function(p){s.removeAttribute(p)}))})}}const Ime={name:"applyStyles",enabled:!0,phase:"write",fn:Cme,effect:Pme,requires:["computeStyles"]};function xd(n){return n.split("-")[0]}var Cg=Math.max,dT=Math.min,h_=Math.round;function t5(){var n=navigator.userAgentData;return n!=null&&n.brands&&Array.isArray(n.brands)?n.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function Uq(){return!/^((?!chrome|android).)*safari/i.test(t5())}function f_(n,e,i){e===void 0&&(e=!1),i===void 0&&(i=!1);var a=n.getBoundingClientRect(),s=1,l=1;e&&Rc(n)&&(s=n.offsetWidth>0&&h_(a.width)/n.offsetWidth||1,l=n.offsetHeight>0&&h_(a.height)/n.offsetHeight||1);var d=Gg(n)?ic(n):window,f=d.visualViewport,p=!Uq()&&i,y=(a.left+(p&&f?f.offsetLeft:0))/s,_=(a.top+(p&&f?f.offsetTop:0))/l,b=a.width/s,S=a.height/l;return{width:b,height:S,top:_,right:y+b,bottom:_+S,left:y,x:y,y:_}}function Z4(n){var e=f_(n),i=n.offsetWidth,a=n.offsetHeight;return Math.abs(e.width-i)<=1&&(i=e.width),Math.abs(e.height-a)<=1&&(a=e.height),{x:n.offsetLeft,y:n.offsetTop,width:i,height:a}}function Wq(n,e){var i=e.getRootNode&&e.getRootNode();if(n.contains(e))return!0;if(i&&X4(i)){var a=e;do{if(a&&n.isSameNode(a))return!0;a=a.parentNode||a.host}while(a)}return!1}function $h(n){return ic(n).getComputedStyle(n)}function Rme(n){return["table","td","th"].indexOf(Td(n))>=0}function Op(n){return((Gg(n)?n.ownerDocument:n.document)||window.document).documentElement}function FA(n){return Td(n)==="html"?n:n.assignedSlot||n.parentNode||(X4(n)?n.host:null)||Op(n)}function J9(n){return!Rc(n)||$h(n).position==="fixed"?null:n.offsetParent}function Lme(n){var e=/firefox/i.test(t5()),i=/Trident/i.test(t5());if(i&&Rc(n)){var a=$h(n);if(a.position==="fixed")return null}var s=FA(n);for(X4(s)&&(s=s.host);Rc(s)&&["html","body"].indexOf(Td(s))<0;){var l=$h(s);if(l.transform!=="none"||l.perspective!=="none"||l.contain==="paint"||["transform","perspective"].indexOf(l.willChange)!==-1||e&&l.willChange==="filter"||e&&l.filter&&l.filter!=="none")return s;s=s.parentNode}return null}function Kw(n){for(var e=ic(n),i=J9(n);i&&Rme(i)&&$h(i).position==="static";)i=J9(i);return i&&(Td(i)==="html"||Td(i)==="body"&&$h(i).position==="static")?e:i||Lme(n)||e}function K4(n){return["top","bottom"].indexOf(n)>=0?"x":"y"}function pb(n,e,i){return Cg(n,dT(e,i))}function kme(n,e,i){var a=pb(n,e,i);return a>i?i:a}function Vq(){return{top:0,right:0,bottom:0,left:0}}function Gq(n){return Object.assign({},Vq(),n)}function Hq(n,e){return e.reduce(function(i,a){return i[a]=n,i},{})}var Dme=function(e,i){return e=typeof e=="function"?e(Object.assign({},i.rects,{placement:i.placement})):e,Gq(typeof e!="number"?e:Hq(e,Zw))};function zme(n){var e,i=n.state,a=n.name,s=n.options,l=i.elements.arrow,d=i.modifiersData.popperOffsets,f=xd(i.placement),p=K4(f),y=[Al,Oc].indexOf(f)>=0,_=y?"height":"width";if(!(!l||!d)){var b=Dme(s.padding,i),S=Z4(l),A=p==="y"?Tl:Al,P=p==="y"?zc:Oc,L=i.rects.reference[_]+i.rects.reference[p]-d[p]-i.rects.popper[_],k=d[p]-i.rects.reference[p],R=Kw(l),z=R?p==="y"?R.clientHeight||0:R.clientWidth||0:0,O=L/2-k/2,F=b[A],H=z-S[_]-b[P],$=z/2-S[_]/2+O,Y=pb(F,$,H),te=p;i.modifiersData[a]=(e={},e[te]=Y,e.centerOffset=Y-$,e)}}function Ome(n){var e=n.state,i=n.options,a=i.element,s=a===void 0?"[data-popper-arrow]":a;s!=null&&(typeof s=="string"&&(s=e.elements.popper.querySelector(s),!s)||Wq(e.elements.popper,s)&&(e.elements.arrow=s))}const Nme={name:"arrow",enabled:!0,phase:"main",fn:zme,effect:Ome,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function p_(n){return n.split("-")[1]}var Fme={top:"auto",right:"auto",bottom:"auto",left:"auto"};function Bme(n,e){var i=n.x,a=n.y,s=e.devicePixelRatio||1;return{x:h_(i*s)/s||0,y:h_(a*s)/s||0}}function Q9(n){var e,i=n.popper,a=n.popperRect,s=n.placement,l=n.variation,d=n.offsets,f=n.position,p=n.gpuAcceleration,y=n.adaptive,_=n.roundOffsets,b=n.isFixed,S=d.x,A=S===void 0?0:S,P=d.y,L=P===void 0?0:P,k=typeof _=="function"?_({x:A,y:L}):{x:A,y:L};A=k.x,L=k.y;var R=d.hasOwnProperty("x"),z=d.hasOwnProperty("y"),O=Al,F=Tl,H=window;if(y){var $=Kw(i),Y="clientHeight",te="clientWidth";if($===ic(i)&&($=Op(i),$h($).position!=="static"&&f==="absolute"&&(Y="scrollHeight",te="scrollWidth")),$=$,s===Tl||(s===Al||s===Oc)&&l===rw){F=zc;var G=b&&$===H&&H.visualViewport?H.visualViewport.height:$[Y];L-=G-a.height,L*=p?1:-1}if(s===Al||(s===Tl||s===zc)&&l===rw){O=Oc;var Q=b&&$===H&&H.visualViewport?H.visualViewport.width:$[te];A-=Q-a.width,A*=p?1:-1}}var he=Object.assign({position:f},y&&Fme),pe=_===!0?Bme({x:A,y:L},ic(i)):{x:A,y:L};if(A=pe.x,L=pe.y,p){var ye;return Object.assign({},he,(ye={},ye[F]=z?"0":"",ye[O]=R?"0":"",ye.transform=(H.devicePixelRatio||1)<=1?"translate("+A+"px, "+L+"px)":"translate3d("+A+"px, "+L+"px, 0)",ye))}return Object.assign({},he,(e={},e[F]=z?L+"px":"",e[O]=R?A+"px":"",e.transform="",e))}function Ume(n){var e=n.state,i=n.options,a=i.gpuAcceleration,s=a===void 0?!0:a,l=i.adaptive,d=l===void 0?!0:l,f=i.roundOffsets,p=f===void 0?!0:f,y={placement:xd(e.placement),variation:p_(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:s,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,Q9(Object.assign({},y,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:d,roundOffsets:p})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,Q9(Object.assign({},y,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:p})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}const Wme={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:Ume,data:{}};var M3={passive:!0};function Vme(n){var e=n.state,i=n.instance,a=n.options,s=a.scroll,l=s===void 0?!0:s,d=a.resize,f=d===void 0?!0:d,p=ic(e.elements.popper),y=[].concat(e.scrollParents.reference,e.scrollParents.popper);return l&&y.forEach(function(_){_.addEventListener("scroll",i.update,M3)}),f&&p.addEventListener("resize",i.update,M3),function(){l&&y.forEach(function(_){_.removeEventListener("scroll",i.update,M3)}),f&&p.removeEventListener("resize",i.update,M3)}}const Gme={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:Vme,data:{}};var Hme={left:"right",right:"left",bottom:"top",top:"bottom"};function dM(n){return n.replace(/left|right|bottom|top/g,function(e){return Hme[e]})}var jme={start:"end",end:"start"};function eV(n){return n.replace(/start|end/g,function(e){return jme[e]})}function J4(n){var e=ic(n),i=e.pageXOffset,a=e.pageYOffset;return{scrollLeft:i,scrollTop:a}}function Q4(n){return f_(Op(n)).left+J4(n).scrollLeft}function $me(n,e){var i=ic(n),a=Op(n),s=i.visualViewport,l=a.clientWidth,d=a.clientHeight,f=0,p=0;if(s){l=s.width,d=s.height;var y=Uq();(y||!y&&e==="fixed")&&(f=s.offsetLeft,p=s.offsetTop)}return{width:l,height:d,x:f+Q4(n),y:p}}function Yme(n){var e,i=Op(n),a=J4(n),s=(e=n.ownerDocument)==null?void 0:e.body,l=Cg(i.scrollWidth,i.clientWidth,s?s.scrollWidth:0,s?s.clientWidth:0),d=Cg(i.scrollHeight,i.clientHeight,s?s.scrollHeight:0,s?s.clientHeight:0),f=-a.scrollLeft+Q4(n),p=-a.scrollTop;return $h(s||i).direction==="rtl"&&(f+=Cg(i.clientWidth,s?s.clientWidth:0)-l),{width:l,height:d,x:f,y:p}}function ez(n){var e=$h(n),i=e.overflow,a=e.overflowX,s=e.overflowY;return/auto|scroll|overlay|hidden/.test(i+s+a)}function jq(n){return["html","body","#document"].indexOf(Td(n))>=0?n.ownerDocument.body:Rc(n)&&ez(n)?n:jq(FA(n))}function mb(n,e){var i;e===void 0&&(e=[]);var a=jq(n),s=a===((i=n.ownerDocument)==null?void 0:i.body),l=ic(a),d=s?[l].concat(l.visualViewport||[],ez(a)?a:[]):a,f=e.concat(d);return s?f:f.concat(mb(FA(d)))}function n5(n){return Object.assign({},n,{left:n.x,top:n.y,right:n.x+n.width,bottom:n.y+n.height})}function qme(n,e){var i=f_(n,!1,e==="fixed");return i.top=i.top+n.clientTop,i.left=i.left+n.clientLeft,i.bottom=i.top+n.clientHeight,i.right=i.left+n.clientWidth,i.width=n.clientWidth,i.height=n.clientHeight,i.x=i.left,i.y=i.top,i}function tV(n,e,i){return e===Fq?n5($me(n,i)):Gg(e)?qme(e,i):n5(Yme(Op(n)))}function Xme(n){var e=mb(FA(n)),i=["absolute","fixed"].indexOf($h(n).position)>=0,a=i&&Rc(n)?Kw(n):n;return Gg(a)?e.filter(function(s){return Gg(s)&&Wq(s,a)&&Td(s)!=="body"}):[]}function Zme(n,e,i,a){var s=e==="clippingParents"?Xme(n):[].concat(e),l=[].concat(s,[i]),d=l[0],f=l.reduce(function(p,y){var _=tV(n,y,a);return p.top=Cg(_.top,p.top),p.right=dT(_.right,p.right),p.bottom=dT(_.bottom,p.bottom),p.left=Cg(_.left,p.left),p},tV(n,d,a));return f.width=f.right-f.left,f.height=f.bottom-f.top,f.x=f.left,f.y=f.top,f}function $q(n){var e=n.reference,i=n.element,a=n.placement,s=a?xd(a):null,l=a?p_(a):null,d=e.x+e.width/2-i.width/2,f=e.y+e.height/2-i.height/2,p;switch(s){case Tl:p={x:d,y:e.y-i.height};break;case zc:p={x:d,y:e.y+e.height};break;case Oc:p={x:e.x+e.width,y:f};break;case Al:p={x:e.x-i.width,y:f};break;default:p={x:e.x,y:e.y}}var y=s?K4(s):null;if(y!=null){var _=y==="y"?"height":"width";switch(l){case d_:p[y]=p[y]-(e[_]/2-i[_]/2);break;case rw:p[y]=p[y]+(e[_]/2-i[_]/2);break}}return p}function aw(n,e){e===void 0&&(e={});var i=e,a=i.placement,s=a===void 0?n.placement:a,l=i.strategy,d=l===void 0?n.strategy:l,f=i.boundary,p=f===void 0?gme:f,y=i.rootBoundary,_=y===void 0?Fq:y,b=i.elementContext,S=b===void 0?fx:b,A=i.altBoundary,P=A===void 0?!1:A,L=i.padding,k=L===void 0?0:L,R=Gq(typeof k!="number"?k:Hq(k,Zw)),z=S===fx?yme:fx,O=n.rects.popper,F=n.elements[P?z:S],H=Zme(Gg(F)?F:F.contextElement||Op(n.elements.popper),p,_,d),$=f_(n.elements.reference),Y=$q({reference:$,element:O,strategy:"absolute",placement:s}),te=n5(Object.assign({},O,Y)),G=S===fx?te:$,Q={top:H.top-G.top+R.top,bottom:G.bottom-H.bottom+R.bottom,left:H.left-G.left+R.left,right:G.right-H.right+R.right},he=n.modifiersData.offset;if(S===fx&&he){var pe=he[s];Object.keys(Q).forEach(function(ye){var fe=[Oc,zc].indexOf(ye)>=0?1:-1,Ae=[Tl,zc].indexOf(ye)>=0?"y":"x";Q[ye]+=pe[Ae]*fe})}return Q}function Kme(n,e){e===void 0&&(e={});var i=e,a=i.placement,s=i.boundary,l=i.rootBoundary,d=i.padding,f=i.flipVariations,p=i.allowedAutoPlacements,y=p===void 0?Bq:p,_=p_(a),b=_?f?K9:K9.filter(function(P){return p_(P)===_}):Zw,S=b.filter(function(P){return y.indexOf(P)>=0});S.length===0&&(S=b);var A=S.reduce(function(P,L){return P[L]=aw(n,{placement:L,boundary:s,rootBoundary:l,padding:d})[xd(L)],P},{});return Object.keys(A).sort(function(P,L){return A[P]-A[L]})}function Jme(n){if(xd(n)===q4)return[];var e=dM(n);return[eV(n),e,eV(e)]}function Qme(n){var e=n.state,i=n.options,a=n.name;if(!e.modifiersData[a]._skip){for(var s=i.mainAxis,l=s===void 0?!0:s,d=i.altAxis,f=d===void 0?!0:d,p=i.fallbackPlacements,y=i.padding,_=i.boundary,b=i.rootBoundary,S=i.altBoundary,A=i.flipVariations,P=A===void 0?!0:A,L=i.allowedAutoPlacements,k=e.options.placement,R=xd(k),z=R===k,O=p||(z||!P?[dM(k)]:Jme(k)),F=[k].concat(O).reduce(function(Xe,Ze){return Xe.concat(xd(Ze)===q4?Kme(e,{placement:Ze,boundary:_,rootBoundary:b,padding:y,flipVariations:P,allowedAutoPlacements:L}):Ze)},[]),H=e.rects.reference,$=e.rects.popper,Y=new Map,te=!0,G=F[0],Q=0;Q<F.length;Q++){var he=F[Q],pe=xd(he),ye=p_(he)===d_,fe=[Tl,zc].indexOf(pe)>=0,Ae=fe?"width":"height",Re=aw(e,{placement:he,boundary:_,rootBoundary:b,altBoundary:S,padding:y}),Be=fe?ye?Oc:Al:ye?zc:Tl;H[Ae]>$[Ae]&&(Be=dM(Be));var le=dM(Be),me=[];if(l&&me.push(Re[pe]<=0),f&&me.push(Re[Be]<=0,Re[le]<=0),me.every(function(Xe){return Xe})){G=he,te=!1;break}Y.set(he,me)}if(te)for(var we=P?3:1,re=function(Ze){var Fe=F.find(function(ct){var At=Y.get(ct);if(At)return At.slice(0,Ze).every(function(kt){return kt})});if(Fe)return G=Fe,"break"},Te=we;Te>0;Te--){var Je=re(Te);if(Je==="break")break}e.placement!==G&&(e.modifiersData[a]._skip=!0,e.placement=G,e.reset=!0)}}const ege={name:"flip",enabled:!0,phase:"main",fn:Qme,requiresIfExists:["offset"],data:{_skip:!1}};function nV(n,e,i){return i===void 0&&(i={x:0,y:0}),{top:n.top-e.height-i.y,right:n.right-e.width+i.x,bottom:n.bottom-e.height+i.y,left:n.left-e.width-i.x}}function iV(n){return[Tl,Oc,zc,Al].some(function(e){return n[e]>=0})}function tge(n){var e=n.state,i=n.name,a=e.rects.reference,s=e.rects.popper,l=e.modifiersData.preventOverflow,d=aw(e,{elementContext:"reference"}),f=aw(e,{altBoundary:!0}),p=nV(d,a),y=nV(f,s,l),_=iV(p),b=iV(y);e.modifiersData[i]={referenceClippingOffsets:p,popperEscapeOffsets:y,isReferenceHidden:_,hasPopperEscaped:b},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":_,"data-popper-escaped":b})}const nge={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:tge};function ige(n,e,i){var a=xd(n),s=[Al,Tl].indexOf(a)>=0?-1:1,l=typeof i=="function"?i(Object.assign({},e,{placement:n})):i,d=l[0],f=l[1];return d=d||0,f=(f||0)*s,[Al,Oc].indexOf(a)>=0?{x:f,y:d}:{x:d,y:f}}function rge(n){var e=n.state,i=n.options,a=n.name,s=i.offset,l=s===void 0?[0,0]:s,d=Bq.reduce(function(_,b){return _[b]=ige(b,e.rects,l),_},{}),f=d[e.placement],p=f.x,y=f.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=p,e.modifiersData.popperOffsets.y+=y),e.modifiersData[a]=d}const age={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:rge};function oge(n){var e=n.state,i=n.name;e.modifiersData[i]=$q({reference:e.rects.reference,element:e.rects.popper,strategy:"absolute",placement:e.placement})}const sge={name:"popperOffsets",enabled:!0,phase:"read",fn:oge,data:{}};function lge(n){return n==="x"?"y":"x"}function cge(n){var e=n.state,i=n.options,a=n.name,s=i.mainAxis,l=s===void 0?!0:s,d=i.altAxis,f=d===void 0?!1:d,p=i.boundary,y=i.rootBoundary,_=i.altBoundary,b=i.padding,S=i.tether,A=S===void 0?!0:S,P=i.tetherOffset,L=P===void 0?0:P,k=aw(e,{boundary:p,rootBoundary:y,padding:b,altBoundary:_}),R=xd(e.placement),z=p_(e.placement),O=!z,F=K4(R),H=lge(F),$=e.modifiersData.popperOffsets,Y=e.rects.reference,te=e.rects.popper,G=typeof L=="function"?L(Object.assign({},e.rects,{placement:e.placement})):L,Q=typeof G=="number"?{mainAxis:G,altAxis:G}:Object.assign({mainAxis:0,altAxis:0},G),he=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,pe={x:0,y:0};if($){if(l){var ye,fe=F==="y"?Tl:Al,Ae=F==="y"?zc:Oc,Re=F==="y"?"height":"width",Be=$[F],le=Be+k[fe],me=Be-k[Ae],we=A?-te[Re]/2:0,re=z===d_?Y[Re]:te[Re],Te=z===d_?-te[Re]:-Y[Re],Je=e.elements.arrow,Xe=A&&Je?Z4(Je):{width:0,height:0},Ze=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:Vq(),Fe=Ze[fe],ct=Ze[Ae],At=pb(0,Y[Re],Xe[Re]),kt=O?Y[Re]/2-we-At-Fe-Q.mainAxis:re-At-Fe-Q.mainAxis,Kt=O?-Y[Re]/2+we+At+ct+Q.mainAxis:Te+At+ct+Q.mainAxis,Et=e.elements.arrow&&Kw(e.elements.arrow),Ie=Et?F==="y"?Et.clientTop||0:Et.clientLeft||0:0,pt=(ye=he==null?void 0:he[F])!=null?ye:0,gt=Be+kt-pt-Ie,_t=Be+Kt-pt,Ue=pb(A?dT(le,gt):le,Be,A?Cg(me,_t):me);$[F]=Ue,pe[F]=Ue-Be}if(f){var ue,se=F==="x"?Tl:Al,xe=F==="x"?zc:Oc,Ye=$[H],ze=H==="y"?"height":"width",st=Ye+k[se],de=Ye-k[xe],ie=[Tl,Al].indexOf(R)!==-1,Oe=(ue=he==null?void 0:he[H])!=null?ue:0,ut=ie?st:Ye-Y[ze]-te[ze]-Oe+Q.altAxis,it=ie?Ye+Y[ze]+te[ze]-Oe-Q.altAxis:de,lt=A&&ie?kme(ut,Ye,it):pb(A?ut:st,Ye,A?it:de);$[H]=lt,pe[H]=lt-Ye}e.modifiersData[a]=pe}}const uge={name:"preventOverflow",enabled:!0,phase:"main",fn:cge,requiresIfExists:["offset"]};function dge(n){return{scrollLeft:n.scrollLeft,scrollTop:n.scrollTop}}function hge(n){return n===ic(n)||!Rc(n)?J4(n):dge(n)}function fge(n){var e=n.getBoundingClientRect(),i=h_(e.width)/n.offsetWidth||1,a=h_(e.height)/n.offsetHeight||1;return i!==1||a!==1}function pge(n,e,i){i===void 0&&(i=!1);var a=Rc(e),s=Rc(e)&&fge(e),l=Op(e),d=f_(n,s,i),f={scrollLeft:0,scrollTop:0},p={x:0,y:0};return(a||!a&&!i)&&((Td(e)!=="body"||ez(l))&&(f=hge(e)),Rc(e)?(p=f_(e,!0),p.x+=e.clientLeft,p.y+=e.clientTop):l&&(p.x=Q4(l))),{x:d.left+f.scrollLeft-p.x,y:d.top+f.scrollTop-p.y,width:d.width,height:d.height}}function mge(n){var e=new Map,i=new Set,a=[];n.forEach(function(l){e.set(l.name,l)});function s(l){i.add(l.name);var d=[].concat(l.requires||[],l.requiresIfExists||[]);d.forEach(function(f){if(!i.has(f)){var p=e.get(f);p&&s(p)}}),a.push(l)}return n.forEach(function(l){i.has(l.name)||s(l)}),a}function gge(n){var e=mge(n);return Ame.reduce(function(i,a){return i.concat(e.filter(function(s){return s.phase===a}))},[])}function yge(n){var e;return function(){return e||(e=new Promise(function(i){Promise.resolve().then(function(){e=void 0,i(n())})})),e}}function vge(n){var e=n.reduce(function(i,a){var s=i[a.name];return i[a.name]=s?Object.assign({},s,a,{options:Object.assign({},s.options,a.options),data:Object.assign({},s.data,a.data)}):a,i},{});return Object.keys(e).map(function(i){return e[i]})}var rV={placement:"bottom",modifiers:[],strategy:"absolute"};function aV(){for(var n=arguments.length,e=new Array(n),i=0;i<n;i++)e[i]=arguments[i];return!e.some(function(a){return!(a&&typeof a.getBoundingClientRect=="function")})}function _ge(n){n===void 0&&(n={});var e=n,i=e.defaultModifiers,a=i===void 0?[]:i,s=e.defaultOptions,l=s===void 0?rV:s;return function(f,p,y){y===void 0&&(y=l);var _={placement:"bottom",orderedModifiers:[],options:Object.assign({},rV,l),modifiersData:{},elements:{reference:f,popper:p},attributes:{},styles:{}},b=[],S=!1,A={state:_,setOptions:function(R){var z=typeof R=="function"?R(_.options):R;L(),_.options=Object.assign({},l,_.options,z),_.scrollParents={reference:Gg(f)?mb(f):f.contextElement?mb(f.contextElement):[],popper:mb(p)};var O=gge(vge([].concat(a,_.options.modifiers)));return _.orderedModifiers=O.filter(function(F){return F.enabled}),P(),A.update()},forceUpdate:function(){if(!S){var R=_.elements,z=R.reference,O=R.popper;if(aV(z,O)){_.rects={reference:pge(z,Kw(O),_.options.strategy==="fixed"),popper:Z4(O)},_.reset=!1,_.placement=_.options.placement,_.orderedModifiers.forEach(function(Q){return _.modifiersData[Q.name]=Object.assign({},Q.data)});for(var F=0;F<_.orderedModifiers.length;F++){if(_.reset===!0){_.reset=!1,F=-1;continue}var H=_.orderedModifiers[F],$=H.fn,Y=H.options,te=Y===void 0?{}:Y,G=H.name;typeof $=="function"&&(_=$({state:_,options:te,name:G,instance:A})||_)}}}},update:yge(function(){return new Promise(function(k){A.forceUpdate(),k(_)})}),destroy:function(){L(),S=!0}};if(!aV(f,p))return A;A.setOptions(y).then(function(k){!S&&y.onFirstUpdate&&y.onFirstUpdate(k)});function P(){_.orderedModifiers.forEach(function(k){var R=k.name,z=k.options,O=z===void 0?{}:z,F=k.effect;if(typeof F=="function"){var H=F({state:_,name:R,instance:A,options:O}),$=function(){};b.push(H||$)}})}function L(){b.forEach(function(k){return k()}),b=[]}return A}}var xge=[Gme,sge,Wme,Ime,age,ege,uge,Nme,nge],bge=_ge({defaultModifiers:xge});function wge(n){return typeof n=="function"?n():n}const Yq=ne.forwardRef(function(e,i){const{children:a,container:s,disablePortal:l=!1}=e,[d,f]=ne.useState(null),p=Mo(ne.isValidElement(a)?a.ref:null,i);if(bu(()=>{l||f(wge(s)||document.body)},[s,l]),bu(()=>{if(d&&!l)return rT(i,d),()=>{rT(i,null)}},[i,d,l]),l){if(ne.isValidElement(a)){const y={ref:p};return ne.cloneElement(a,y)}return U(ne.Fragment,{children:a})}return U(ne.Fragment,{children:d&&Gw.createPortal(a,d)})});function Sge(n){return Zi("MuiPopper",n)}$i("MuiPopper",["root"]);const Ege=["anchorEl","children","direction","disablePortal","modifiers","open","placement","popperOptions","popperRef","slotProps","slots","TransitionProps","ownerState"],Mge=["anchorEl","children","container","direction","disablePortal","keepMounted","modifiers","open","placement","popperOptions","popperRef","style","transition","slotProps","slots"];function Tge(n,e){if(e==="ltr")return n;switch(n){case"bottom-end":return"bottom-start";case"bottom-start":return"bottom-end";case"top-end":return"top-start";case"top-start":return"top-end";default:return n}}function i5(n){return typeof n=="function"?n():n}function Age(n){return n.nodeType!==void 0}const Cge=()=>er({root:["root"]},ame(Sge)),Pge={},Ige=ne.forwardRef(function(e,i){var a;const{anchorEl:s,children:l,direction:d,disablePortal:f,modifiers:p,open:y,placement:_,popperOptions:b,popperRef:S,slotProps:A={},slots:P={},TransitionProps:L}=e,k=Wn(e,Ege),R=ne.useRef(null),z=Mo(R,i),O=ne.useRef(null),F=Mo(O,S),H=ne.useRef(F);bu(()=>{H.current=F},[F]),ne.useImperativeHandle(S,()=>O.current,[]);const $=Tge(_,d),[Y,te]=ne.useState($),[G,Q]=ne.useState(i5(s));ne.useEffect(()=>{O.current&&O.current.forceUpdate()}),ne.useEffect(()=>{s&&Q(i5(s))},[s]),bu(()=>{if(!G||!y)return;const Ae=le=>{te(le.placement)};let Re=[{name:"preventOverflow",options:{altBoundary:f}},{name:"flip",options:{altBoundary:f}},{name:"onUpdate",enabled:!0,phase:"afterWrite",fn:({state:le})=>{Ae(le)}}];p!=null&&(Re=Re.concat(p)),b&&b.modifiers!=null&&(Re=Re.concat(b.modifiers));const Be=bge(G,R.current,Ge({placement:$},b,{modifiers:Re}));return H.current(Be),()=>{Be.destroy(),H.current(null)}},[G,f,p,y,b,$]);const he={placement:Y};L!==null&&(he.TransitionProps=L);const pe=Cge(),ye=(a=P.root)!=null?a:"div",fe=Vg({elementType:ye,externalSlotProps:A.root,externalForwardedProps:k,additionalProps:{role:"tooltip",ref:z},ownerState:e,className:pe.root});return U(ye,Ge({},fe,{children:typeof l=="function"?l(he):l}))}),Rge=ne.forwardRef(function(e,i){const{anchorEl:a,children:s,container:l,direction:d="ltr",disablePortal:f=!1,keepMounted:p=!1,modifiers:y,open:_,placement:b="bottom",popperOptions:S=Pge,popperRef:A,style:P,transition:L=!1,slotProps:k={},slots:R={}}=e,z=Wn(e,Mge),[O,F]=ne.useState(!0),H=()=>{F(!1)},$=()=>{F(!0)};if(!p&&!_&&(!L||O))return null;let Y;if(l)Y=l;else if(a){const Q=i5(a);Y=Q&&Age(Q)?Ms(Q).body:Ms(null).body}const te=!_&&p&&(!L||O)?"none":void 0,G=L?{in:_,onEnter:H,onExited:$}:void 0;return U(Yq,{disablePortal:f,container:Y,children:U(Ige,Ge({anchorEl:a,direction:d,disablePortal:f,modifiers:y,ref:i,open:L?!O:_,placement:b,popperOptions:S,popperRef:A,slotProps:k,slots:R},z,{style:Ge({position:"fixed",top:0,left:0,display:te},P),TransitionProps:G,children:s}))})});function Lge(n){const e=Ms(n);return e.body===n?Md(n).innerWidth>e.documentElement.clientWidth:n.scrollHeight>n.clientHeight}function gb(n,e){e?n.setAttribute("aria-hidden","true"):n.removeAttribute("aria-hidden")}function oV(n){return parseInt(Md(n).getComputedStyle(n).paddingRight,10)||0}function kge(n){const i=["TEMPLATE","SCRIPT","STYLE","LINK","MAP","META","NOSCRIPT","PICTURE","COL","COLGROUP","PARAM","SLOT","SOURCE","TRACK"].indexOf(n.tagName)!==-1,a=n.tagName==="INPUT"&&n.getAttribute("type")==="hidden";return i||a}function sV(n,e,i,a,s){const l=[e,i,...a];[].forEach.call(n.children,d=>{const f=l.indexOf(d)===-1,p=!kge(d);f&&p&&gb(d,s)})}function PR(n,e){let i=-1;return n.some((a,s)=>e(a)?(i=s,!0):!1),i}function Dge(n,e){const i=[],a=n.container;if(!e.disableScrollLock){if(Lge(a)){const d=rq(Ms(a));i.push({value:a.style.paddingRight,property:"padding-right",el:a}),a.style.paddingRight=`${oV(a)+d}px`;const f=Ms(a).querySelectorAll(".mui-fixed");[].forEach.call(f,p=>{i.push({value:p.style.paddingRight,property:"padding-right",el:p}),p.style.paddingRight=`${oV(p)+d}px`})}let l;if(a.parentNode instanceof DocumentFragment)l=Ms(a).body;else{const d=a.parentElement,f=Md(a);l=(d==null?void 0:d.nodeName)==="HTML"&&f.getComputedStyle(d).overflowY==="scroll"?d:a}i.push({value:l.style.overflow,property:"overflow",el:l},{value:l.style.overflowX,property:"overflow-x",el:l},{value:l.style.overflowY,property:"overflow-y",el:l}),l.style.overflow="hidden"}return()=>{i.forEach(({value:l,el:d,property:f})=>{l?d.style.setProperty(f,l):d.style.removeProperty(f)})}}function zge(n){const e=[];return[].forEach.call(n.children,i=>{i.getAttribute("aria-hidden")==="true"&&e.push(i)}),e}class Oge{constructor(){this.containers=void 0,this.modals=void 0,this.modals=[],this.containers=[]}add(e,i){let a=this.modals.indexOf(e);if(a!==-1)return a;a=this.modals.length,this.modals.push(e),e.modalRef&&gb(e.modalRef,!1);const s=zge(i);sV(i,e.mount,e.modalRef,s,!0);const l=PR(this.containers,d=>d.container===i);return l!==-1?(this.containers[l].modals.push(e),a):(this.containers.push({modals:[e],container:i,restore:null,hiddenSiblings:s}),a)}mount(e,i){const a=PR(this.containers,l=>l.modals.indexOf(e)!==-1),s=this.containers[a];s.restore||(s.restore=Dge(s,i))}remove(e,i=!0){const a=this.modals.indexOf(e);if(a===-1)return a;const s=PR(this.containers,d=>d.modals.indexOf(e)!==-1),l=this.containers[s];if(l.modals.splice(l.modals.indexOf(e),1),this.modals.splice(a,1),l.modals.length===0)l.restore&&l.restore(),e.modalRef&&gb(e.modalRef,i),sV(l.container,e.mount,e.modalRef,l.hiddenSiblings,!1),this.containers.splice(s,1);else{const d=l.modals[l.modals.length-1];d.modalRef&&gb(d.modalRef,!1)}return a}isTopModal(e){return this.modals.length>0&&this.modals[this.modals.length-1]===e}}function Nge(n){return typeof n=="function"?n():n}function Fge(n){return n?n.props.hasOwnProperty("in"):!1}const Bge=new Oge;function Uge(n){const{container:e,disableEscapeKeyDown:i=!1,disableScrollLock:a=!1,manager:s=Bge,closeAfterTransition:l=!1,onTransitionEnter:d,onTransitionExited:f,children:p,onClose:y,open:_,rootRef:b}=n,S=ne.useRef({}),A=ne.useRef(null),P=ne.useRef(null),L=Mo(P,b),[k,R]=ne.useState(!_),z=Fge(p);let O=!0;(n["aria-hidden"]==="false"||n["aria-hidden"]===!1)&&(O=!1);const F=()=>Ms(A.current),H=()=>(S.current.modalRef=P.current,S.current.mount=A.current,S.current),$=()=>{s.mount(H(),{disableScrollLock:a}),P.current&&(P.current.scrollTop=0)},Y=rp(()=>{const Re=Nge(e)||F().body;s.add(H(),Re),P.current&&$()}),te=ne.useCallback(()=>s.isTopModal(H()),[s]),G=rp(Re=>{A.current=Re,Re&&(_&&te()?$():P.current&&gb(P.current,O))}),Q=ne.useCallback(()=>{s.remove(H(),O)},[O,s]);ne.useEffect(()=>()=>{Q()},[Q]),ne.useEffect(()=>{_?Y():(!z||!l)&&Q()},[_,Q,z,l,Y]);const he=Re=>Be=>{var le;(le=Re.onKeyDown)==null||le.call(Re,Be),!(Be.key!=="Escape"||Be.which===229||!te())&&(i||(Be.stopPropagation(),y&&y(Be,"escapeKeyDown")))},pe=Re=>Be=>{var le;(le=Re.onClick)==null||le.call(Re,Be),Be.target===Be.currentTarget&&y&&y(Be,"backdropClick")};return{getRootProps:(Re={})=>{const Be=Nq(n);delete Be.onTransitionEnter,delete Be.onTransitionExited;const le=Ge({},Be,Re);return Ge({role:"presentation"},le,{onKeyDown:he(le),ref:L})},getBackdropProps:(Re={})=>{const Be=Re;return Ge({"aria-hidden":!0},Be,{onClick:pe(Be),open:_})},getTransitionProps:()=>{const Re=()=>{R(!1),d&&d()},Be=()=>{R(!0),f&&f(),l&&Q()};return{onEnter:Yk(Re,p==null?void 0:p.props.onEnter),onExited:Yk(Be,p==null?void 0:p.props.onExited)}},rootRef:L,portalRef:G,isTopModal:te,exited:k,hasTransition:z}}const Wge=["onChange","maxRows","minRows","style","value"];function T3(n){return parseInt(n,10)||0}const Vge={shadow:{visibility:"hidden",position:"absolute",overflow:"hidden",height:0,top:0,left:0,transform:"translateZ(0)"}};function lV(n){return n==null||Object.keys(n).length===0||n.outerHeightStyle===0&&!n.overflow}const Gge=ne.forwardRef(function(e,i){const{onChange:a,maxRows:s,minRows:l=1,style:d,value:f}=e,p=Wn(e,Wge),{current:y}=ne.useRef(f!=null),_=ne.useRef(null),b=Mo(i,_),S=ne.useRef(null),A=ne.useRef(0),[P,L]=ne.useState({outerHeightStyle:0}),k=ne.useCallback(()=>{const F=_.current,$=Md(F).getComputedStyle(F);if($.width==="0px")return{outerHeightStyle:0};const Y=S.current;Y.style.width=$.width,Y.value=F.value||e.placeholder||"x",Y.value.slice(-1)===`
`&&(Y.value+=" ");const te=$.boxSizing,G=T3($.paddingBottom)+T3($.paddingTop),Q=T3($.borderBottomWidth)+T3($.borderTopWidth),he=Y.scrollHeight;Y.value="x";const pe=Y.scrollHeight;let ye=he;l&&(ye=Math.max(Number(l)*pe,ye)),s&&(ye=Math.min(Number(s)*pe,ye)),ye=Math.max(ye,pe);const fe=ye+(te==="border-box"?G+Q:0),Ae=Math.abs(ye-he)<=1;return{outerHeightStyle:fe,overflow:Ae}},[s,l,e.placeholder]),R=(F,H)=>{const{outerHeightStyle:$,overflow:Y}=H;return A.current<20&&($>0&&Math.abs((F.outerHeightStyle||0)-$)>1||F.overflow!==Y)?(A.current+=1,{overflow:Y,outerHeightStyle:$}):F},z=ne.useCallback(()=>{const F=k();lV(F)||L(H=>R(H,F))},[k]);bu(()=>{const F=()=>{const he=k();lV(he)||Gw.flushSync(()=>{L(pe=>R(pe,he))})},H=()=>{A.current=0,F()};let $;const Y=sA(H),te=_.current,G=Md(te);G.addEventListener("resize",Y);let Q;return typeof ResizeObserver<"u"&&(Q=new ResizeObserver(H),Q.observe(te)),()=>{Y.clear(),cancelAnimationFrame($),G.removeEventListener("resize",Y),Q&&Q.disconnect()}},[k]),bu(()=>{z()}),ne.useEffect(()=>{A.current=0},[f]);const O=F=>{A.current=0,y||z(),a&&a(F)};return _e(ne.Fragment,{children:[U("textarea",Ge({value:f,onChange:O,ref:b,rows:l,style:Ge({height:P.outerHeightStyle,overflow:P.overflow?"hidden":void 0},d)},p)),U("textarea",{"aria-hidden":!0,className:e.className,readOnly:!0,ref:S,tabIndex:-1,style:Ge({},Vge.shadow,d,{paddingTop:0,paddingBottom:0})})]})}),Hge=["anchorEl","component","components","componentsProps","container","disablePortal","keepMounted","modifiers","open","placement","popperOptions","popperRef","transition","slots","slotProps"],jge=Rn(Rge,{name:"MuiPopper",slot:"Root",overridesResolver:(n,e)=>e.root})({}),$ge=ne.forwardRef(function(e,i){var a;const s=F4(),l=ar({props:e,name:"MuiPopper"}),{anchorEl:d,component:f,components:p,componentsProps:y,container:_,disablePortal:b,keepMounted:S,modifiers:A,open:P,placement:L,popperOptions:k,popperRef:R,transition:z,slots:O,slotProps:F}=l,H=Wn(l,Hge),$=(a=O==null?void 0:O.root)!=null?a:p==null?void 0:p.Root,Y=Ge({anchorEl:d,container:_,disablePortal:b,keepMounted:S,modifiers:A,open:P,placement:L,popperOptions:k,popperRef:R,transition:z},H);return U(jge,Ge({as:f,direction:s==null?void 0:s.direction,slots:{root:$},slotProps:F??y},Y,{ref:i}))}),qq=$ge;function I_({props:n,states:e,muiFormControl:i}){return e.reduce((a,s)=>(a[s]=n[s],i&&typeof n[s]>"u"&&(a[s]=i[s]),a),{})}const Yge=ne.createContext(void 0),tz=Yge;function ny(){return ne.useContext(tz)}function qge(n){return U(hfe,Ge({},n,{defaultTheme:zA,themeId:l_}))}function cV(n){return n!=null&&!(Array.isArray(n)&&n.length===0)}function hT(n,e=!1){return n&&(cV(n.value)&&n.value!==""||e&&cV(n.defaultValue)&&n.defaultValue!=="")}function Xge(n){return n.startAdornment}function Zge(n){return Zi("MuiInputBase",n)}const Kge=$i("MuiInputBase",["root","formControl","focused","disabled","adornedStart","adornedEnd","error","sizeSmall","multiline","colorSecondary","fullWidth","hiddenLabel","readOnly","input","inputSizeSmall","inputMultiline","inputTypeSearch","inputAdornedStart","inputAdornedEnd","inputHiddenLabel"]),m_=Kge,Jge=["aria-describedby","autoComplete","autoFocus","className","color","components","componentsProps","defaultValue","disabled","disableInjectingGlobalStyles","endAdornment","error","fullWidth","id","inputComponent","inputProps","inputRef","margin","maxRows","minRows","multiline","name","onBlur","onChange","onClick","onFocus","onKeyDown","onKeyUp","placeholder","readOnly","renderSuffix","rows","size","slotProps","slots","startAdornment","type","value"],BA=(n,e)=>{const{ownerState:i}=n;return[e.root,i.formControl&&e.formControl,i.startAdornment&&e.adornedStart,i.endAdornment&&e.adornedEnd,i.error&&e.error,i.size==="small"&&e.sizeSmall,i.multiline&&e.multiline,i.color&&e[`color${ti(i.color)}`],i.fullWidth&&e.fullWidth,i.hiddenLabel&&e.hiddenLabel]},UA=(n,e)=>{const{ownerState:i}=n;return[e.input,i.size==="small"&&e.inputSizeSmall,i.multiline&&e.inputMultiline,i.type==="search"&&e.inputTypeSearch,i.startAdornment&&e.inputAdornedStart,i.endAdornment&&e.inputAdornedEnd,i.hiddenLabel&&e.inputHiddenLabel]},Qge=n=>{const{classes:e,color:i,disabled:a,error:s,endAdornment:l,focused:d,formControl:f,fullWidth:p,hiddenLabel:y,multiline:_,readOnly:b,size:S,startAdornment:A,type:P}=n,L={root:["root",`color${ti(i)}`,a&&"disabled",s&&"error",p&&"fullWidth",d&&"focused",f&&"formControl",S&&S!=="medium"&&`size${ti(S)}`,_&&"multiline",A&&"adornedStart",l&&"adornedEnd",y&&"hiddenLabel",b&&"readOnly"],input:["input",a&&"disabled",P==="search"&&"inputTypeSearch",_&&"inputMultiline",S==="small"&&"inputSizeSmall",y&&"inputHiddenLabel",A&&"inputAdornedStart",l&&"inputAdornedEnd",b&&"readOnly"]};return er(L,Zge,e)},WA=Rn("div",{name:"MuiInputBase",slot:"Root",overridesResolver:BA})(({theme:n,ownerState:e})=>Ge({},n.typography.body1,{color:(n.vars||n).palette.text.primary,lineHeight:"1.4375em",boxSizing:"border-box",position:"relative",cursor:"text",display:"inline-flex",alignItems:"center",[`&.${m_.disabled}`]:{color:(n.vars||n).palette.text.disabled,cursor:"default"}},e.multiline&&Ge({padding:"4px 0 5px"},e.size==="small"&&{paddingTop:1}),e.fullWidth&&{width:"100%"})),VA=Rn("input",{name:"MuiInputBase",slot:"Input",overridesResolver:UA})(({theme:n,ownerState:e})=>{const i=n.palette.mode==="light",a=Ge({color:"currentColor"},n.vars?{opacity:n.vars.opacity.inputPlaceholder}:{opacity:i?.42:.5},{transition:n.transitions.create("opacity",{duration:n.transitions.duration.shorter})}),s={opacity:"0 !important"},l=n.vars?{opacity:n.vars.opacity.inputPlaceholder}:{opacity:i?.42:.5};return Ge({font:"inherit",letterSpacing:"inherit",color:"currentColor",padding:"4px 0 5px",border:0,boxSizing:"content-box",background:"none",height:"1.4375em",margin:0,WebkitTapHighlightColor:"transparent",display:"block",minWidth:0,width:"100%",animationName:"mui-auto-fill-cancel",animationDuration:"10ms","&::-webkit-input-placeholder":a,"&::-moz-placeholder":a,"&:-ms-input-placeholder":a,"&::-ms-input-placeholder":a,"&:focus":{outline:0},"&:invalid":{boxShadow:"none"},"&::-webkit-search-decoration":{WebkitAppearance:"none"},[`label[data-shrink=false] + .${m_.formControl} &`]:{"&::-webkit-input-placeholder":s,"&::-moz-placeholder":s,"&:-ms-input-placeholder":s,"&::-ms-input-placeholder":s,"&:focus::-webkit-input-placeholder":l,"&:focus::-moz-placeholder":l,"&:focus:-ms-input-placeholder":l,"&:focus::-ms-input-placeholder":l},[`&.${m_.disabled}`]:{opacity:1,WebkitTextFillColor:(n.vars||n).palette.text.disabled},"&:-webkit-autofill":{animationDuration:"5000s",animationName:"mui-auto-fill"}},e.size==="small"&&{paddingTop:1},e.multiline&&{height:"auto",resize:"none",padding:0,paddingTop:0},e.type==="search"&&{MozAppearance:"textfield"})}),eye=U(qge,{styles:{"@keyframes mui-auto-fill":{from:{display:"block"}},"@keyframes mui-auto-fill-cancel":{from:{display:"block"}}}}),tye=ne.forwardRef(function(e,i){var a;const s=ar({props:e,name:"MuiInputBase"}),{"aria-describedby":l,autoComplete:d,autoFocus:f,className:p,components:y={},componentsProps:_={},defaultValue:b,disabled:S,disableInjectingGlobalStyles:A,endAdornment:P,fullWidth:L=!1,id:k,inputComponent:R="input",inputProps:z={},inputRef:O,maxRows:F,minRows:H,multiline:$=!1,name:Y,onBlur:te,onChange:G,onClick:Q,onFocus:he,onKeyDown:pe,onKeyUp:ye,placeholder:fe,readOnly:Ae,renderSuffix:Re,rows:Be,slotProps:le={},slots:me={},startAdornment:we,type:re="text",value:Te}=s,Je=Wn(s,Jge),Xe=z.value!=null?z.value:Te,{current:Ze}=ne.useRef(Xe!=null),Fe=ne.useRef(),ct=ne.useCallback(lt=>{},[]),At=Mo(Fe,O,z.ref,ct),[kt,Kt]=ne.useState(!1),Et=ny(),Ie=I_({props:s,muiFormControl:Et,states:["color","disabled","error","hiddenLabel","size","required","filled"]});Ie.focused=Et?Et.focused:kt,ne.useEffect(()=>{!Et&&S&&kt&&(Kt(!1),te&&te())},[Et,S,kt,te]);const pt=Et&&Et.onFilled,gt=Et&&Et.onEmpty,_t=ne.useCallback(lt=>{hT(lt)?pt&&pt():gt&&gt()},[pt,gt]);bu(()=>{Ze&&_t({value:Xe})},[Xe,_t,Ze]);const Ue=lt=>{if(Ie.disabled){lt.stopPropagation();return}he&&he(lt),z.onFocus&&z.onFocus(lt),Et&&Et.onFocus?Et.onFocus(lt):Kt(!0)},ue=lt=>{te&&te(lt),z.onBlur&&z.onBlur(lt),Et&&Et.onBlur?Et.onBlur(lt):Kt(!1)},se=(lt,...Mt)=>{if(!Ze){const Ut=lt.target||Fe.current;if(Ut==null)throw new Error(Mp(1));_t({value:Ut.value})}z.onChange&&z.onChange(lt,...Mt),G&&G(lt,...Mt)};ne.useEffect(()=>{_t(Fe.current)},[]);const xe=lt=>{Fe.current&&lt.currentTarget===lt.target&&Fe.current.focus(),Q&&Q(lt)};let Ye=R,ze=z;$&&Ye==="input"&&(Be?ze=Ge({type:void 0,minRows:Be,maxRows:Be},ze):ze=Ge({type:void 0,maxRows:F,minRows:H},ze),Ye=Gge);const st=lt=>{_t(lt.animationName==="mui-auto-fill-cancel"?Fe.current:{value:"x"})};ne.useEffect(()=>{Et&&Et.setAdornedStart(!!we)},[Et,we]);const de=Ge({},s,{color:Ie.color||"primary",disabled:Ie.disabled,endAdornment:P,error:Ie.error,focused:Ie.focused,formControl:Et,fullWidth:L,hiddenLabel:Ie.hiddenLabel,multiline:$,size:Ie.size,startAdornment:we,type:re}),ie=Qge(de),Oe=me.root||y.Root||WA,ut=le.root||_.root||{},it=me.input||y.Input||VA;return ze=Ge({},ze,(a=le.input)!=null?a:_.input),_e(ne.Fragment,{children:[!A&&eye,_e(Oe,Ge({},ut,!uT(Oe)&&{ownerState:Ge({},de,ut.ownerState)},{ref:i,onClick:xe},Je,{className:fi(ie.root,ut.className,p,Ae&&"MuiInputBase-readOnly"),children:[we,U(tz.Provider,{value:null,children:U(it,Ge({ownerState:de,"aria-invalid":Ie.error,"aria-describedby":l,autoComplete:d,autoFocus:f,defaultValue:b,disabled:Ie.disabled,id:k,onAnimationStart:st,name:Y,placeholder:fe,readOnly:Ae,required:Ie.required,rows:Be,value:Xe,onKeyDown:pe,onKeyUp:ye,type:re},ze,!uT(it)&&{as:Ye,ownerState:Ge({},de,ze.ownerState)},{ref:At,className:fi(ie.input,ze.className,Ae&&"MuiInputBase-readOnly"),onBlur:ue,onChange:se,onFocus:Ue}))}),P,Re?Re(Ge({},Ie,{startAdornment:we})):null]}))]})}),GA=tye;function nye(n){return Zi("MuiInput",n)}const iye=Ge({},m_,$i("MuiInput",["root","underline","input"])),px=iye;function rye(n){return Zi("MuiOutlinedInput",n)}const aye=Ge({},m_,$i("MuiOutlinedInput",["root","notchedOutline","input"])),Vf=aye;function oye(n){return Zi("MuiFilledInput",n)}const sye=Ge({},m_,$i("MuiFilledInput",["root","underline","input"])),Vm=sye,lye=Xw(U("path",{d:"M7 10l5 5 5-5z"}),"ArrowDropDown"),cye=["addEndListener","appear","children","easing","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","style","timeout","TransitionComponent"],uye={entering:{opacity:1},entered:{opacity:1}},dye=ne.forwardRef(function(e,i){const a=zp(),s={enter:a.transitions.duration.enteringScreen,exit:a.transitions.duration.leavingScreen},{addEndListener:l,appear:d=!0,children:f,easing:p,in:y,onEnter:_,onEntered:b,onEntering:S,onExit:A,onExited:P,onExiting:L,style:k,timeout:R=s,TransitionComponent:z=H4}=e,O=Wn(e,cye),F=ne.useRef(null),H=Mo(F,f.ref,i),$=fe=>Ae=>{if(fe){const Re=F.current;Ae===void 0?fe(Re):fe(Re,Ae)}},Y=$(S),te=$((fe,Ae)=>{Y4(fe);const Re=u_({style:k,timeout:R,easing:p},{mode:"enter"});fe.style.webkitTransition=a.transitions.create("opacity",Re),fe.style.transition=a.transitions.create("opacity",Re),_&&_(fe,Ae)}),G=$(b),Q=$(L),he=$(fe=>{const Ae=u_({style:k,timeout:R,easing:p},{mode:"exit"});fe.style.webkitTransition=a.transitions.create("opacity",Ae),fe.style.transition=a.transitions.create("opacity",Ae),A&&A(fe)}),pe=$(P);return U(z,Ge({appear:d,in:y,nodeRef:F,onEnter:te,onEntered:G,onEntering:Y,onExit:he,onExited:pe,onExiting:Q,addEndListener:fe=>{l&&l(F.current,fe)},timeout:R},O,{children:(fe,Ae)=>ne.cloneElement(f,Ge({style:Ge({opacity:0,visibility:fe==="exited"&&!y?"hidden":void 0},uye[fe],k,f.props.style),ref:H},Ae))}))}),hye=dye;function fye(n){return Zi("MuiBackdrop",n)}$i("MuiBackdrop",["root","invisible"]);const pye=["children","className","component","components","componentsProps","invisible","open","slotProps","slots","TransitionComponent","transitionDuration"],mye=n=>{const{classes:e,invisible:i}=n;return er({root:["root",i&&"invisible"]},fye,e)},gye=Rn("div",{name:"MuiBackdrop",slot:"Root",overridesResolver:(n,e)=>{const{ownerState:i}=n;return[e.root,i.invisible&&e.invisible]}})(({ownerState:n})=>Ge({position:"fixed",display:"flex",alignItems:"center",justifyContent:"center",right:0,bottom:0,top:0,left:0,backgroundColor:"rgba(0, 0, 0, 0.5)",WebkitTapHighlightColor:"transparent"},n.invisible&&{backgroundColor:"transparent"})),yye=ne.forwardRef(function(e,i){var a,s,l;const d=ar({props:e,name:"MuiBackdrop"}),{children:f,className:p,component:y="div",components:_={},componentsProps:b={},invisible:S=!1,open:A,slotProps:P={},slots:L={},TransitionComponent:k=hye,transitionDuration:R}=d,z=Wn(d,pye),O=Ge({},d,{component:y,invisible:S}),F=mye(O),H=(a=P.root)!=null?a:b.root;return U(k,Ge({in:A,timeout:R},z,{children:U(gye,Ge({"aria-hidden":!0},H,{as:(s=(l=L.root)!=null?l:_.Root)!=null?s:y,className:fi(F.root,p,H==null?void 0:H.className),ownerState:Ge({},O,H==null?void 0:H.ownerState),classes:F,ref:i,children:f}))}))}),vye=yye;function _ye(n){return Zi("MuiButton",n)}const xye=$i("MuiButton",["root","text","textInherit","textPrimary","textSecondary","textSuccess","textError","textInfo","textWarning","outlined","outlinedInherit","outlinedPrimary","outlinedSecondary","outlinedSuccess","outlinedError","outlinedInfo","outlinedWarning","contained","containedInherit","containedPrimary","containedSecondary","containedSuccess","containedError","containedInfo","containedWarning","disableElevation","focusVisible","disabled","colorInherit","textSizeSmall","textSizeMedium","textSizeLarge","outlinedSizeSmall","outlinedSizeMedium","outlinedSizeLarge","containedSizeSmall","containedSizeMedium","containedSizeLarge","sizeMedium","sizeSmall","sizeLarge","fullWidth","startIcon","endIcon","iconSizeSmall","iconSizeMedium","iconSizeLarge"]),A3=xye,bye=ne.createContext({}),wye=bye,Sye=ne.createContext(void 0),Eye=Sye,Mye=["children","color","component","className","disabled","disableElevation","disableFocusRipple","endIcon","focusVisibleClassName","fullWidth","size","startIcon","type","variant"],Tye=n=>{const{color:e,disableElevation:i,fullWidth:a,size:s,variant:l,classes:d}=n,f={root:["root",l,`${l}${ti(e)}`,`size${ti(s)}`,`${l}Size${ti(s)}`,e==="inherit"&&"colorInherit",i&&"disableElevation",a&&"fullWidth"],label:["label"],startIcon:["startIcon",`iconSize${ti(s)}`],endIcon:["endIcon",`iconSize${ti(s)}`]},p=er(f,_ye,d);return Ge({},d,p)},Xq=n=>Ge({},n.size==="small"&&{"& > *:nth-of-type(1)":{fontSize:18}},n.size==="medium"&&{"& > *:nth-of-type(1)":{fontSize:20}},n.size==="large"&&{"& > *:nth-of-type(1)":{fontSize:22}}),Aye=Rn(NA,{shouldForwardProp:n=>Pl(n)||n==="classes",name:"MuiButton",slot:"Root",overridesResolver:(n,e)=>{const{ownerState:i}=n;return[e.root,e[i.variant],e[`${i.variant}${ti(i.color)}`],e[`size${ti(i.size)}`],e[`${i.variant}Size${ti(i.size)}`],i.color==="inherit"&&e.colorInherit,i.disableElevation&&e.disableElevation,i.fullWidth&&e.fullWidth]}})(({theme:n,ownerState:e})=>{var i,a;const s=n.palette.mode==="light"?n.palette.grey[300]:n.palette.grey[800],l=n.palette.mode==="light"?n.palette.grey.A100:n.palette.grey[700];return Ge({},n.typography.button,{minWidth:64,padding:"6px 16px",borderRadius:(n.vars||n).shape.borderRadius,transition:n.transitions.create(["background-color","box-shadow","border-color","color"],{duration:n.transitions.duration.short}),"&:hover":Ge({textDecoration:"none",backgroundColor:n.vars?`rgba(${n.vars.palette.text.primaryChannel} / ${n.vars.palette.action.hoverOpacity})`:Sa(n.palette.text.primary,n.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},e.variant==="text"&&e.color!=="inherit"&&{backgroundColor:n.vars?`rgba(${n.vars.palette[e.color].mainChannel} / ${n.vars.palette.action.hoverOpacity})`:Sa(n.palette[e.color].main,n.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},e.variant==="outlined"&&e.color!=="inherit"&&{border:`1px solid ${(n.vars||n).palette[e.color].main}`,backgroundColor:n.vars?`rgba(${n.vars.palette[e.color].mainChannel} / ${n.vars.palette.action.hoverOpacity})`:Sa(n.palette[e.color].main,n.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},e.variant==="contained"&&{backgroundColor:n.vars?n.vars.palette.Button.inheritContainedHoverBg:l,boxShadow:(n.vars||n).shadows[4],"@media (hover: none)":{boxShadow:(n.vars||n).shadows[2],backgroundColor:(n.vars||n).palette.grey[300]}},e.variant==="contained"&&e.color!=="inherit"&&{backgroundColor:(n.vars||n).palette[e.color].dark,"@media (hover: none)":{backgroundColor:(n.vars||n).palette[e.color].main}}),"&:active":Ge({},e.variant==="contained"&&{boxShadow:(n.vars||n).shadows[8]}),[`&.${A3.focusVisible}`]:Ge({},e.variant==="contained"&&{boxShadow:(n.vars||n).shadows[6]}),[`&.${A3.disabled}`]:Ge({color:(n.vars||n).palette.action.disabled},e.variant==="outlined"&&{border:`1px solid ${(n.vars||n).palette.action.disabledBackground}`},e.variant==="contained"&&{color:(n.vars||n).palette.action.disabled,boxShadow:(n.vars||n).shadows[0],backgroundColor:(n.vars||n).palette.action.disabledBackground})},e.variant==="text"&&{padding:"6px 8px"},e.variant==="text"&&e.color!=="inherit"&&{color:(n.vars||n).palette[e.color].main},e.variant==="outlined"&&{padding:"5px 15px",border:"1px solid currentColor"},e.variant==="outlined"&&e.color!=="inherit"&&{color:(n.vars||n).palette[e.color].main,border:n.vars?`1px solid rgba(${n.vars.palette[e.color].mainChannel} / 0.5)`:`1px solid ${Sa(n.palette[e.color].main,.5)}`},e.variant==="contained"&&{color:n.vars?n.vars.palette.text.primary:(i=(a=n.palette).getContrastText)==null?void 0:i.call(a,n.palette.grey[300]),backgroundColor:n.vars?n.vars.palette.Button.inheritContainedBg:s,boxShadow:(n.vars||n).shadows[2]},e.variant==="contained"&&e.color!=="inherit"&&{color:(n.vars||n).palette[e.color].contrastText,backgroundColor:(n.vars||n).palette[e.color].main},e.color==="inherit"&&{color:"inherit",borderColor:"currentColor"},e.size==="small"&&e.variant==="text"&&{padding:"4px 5px",fontSize:n.typography.pxToRem(13)},e.size==="large"&&e.variant==="text"&&{padding:"8px 11px",fontSize:n.typography.pxToRem(15)},e.size==="small"&&e.variant==="outlined"&&{padding:"3px 9px",fontSize:n.typography.pxToRem(13)},e.size==="large"&&e.variant==="outlined"&&{padding:"7px 21px",fontSize:n.typography.pxToRem(15)},e.size==="small"&&e.variant==="contained"&&{padding:"4px 10px",fontSize:n.typography.pxToRem(13)},e.size==="large"&&e.variant==="contained"&&{padding:"8px 22px",fontSize:n.typography.pxToRem(15)},e.fullWidth&&{width:"100%"})},({ownerState:n})=>n.disableElevation&&{boxShadow:"none","&:hover":{boxShadow:"none"},[`&.${A3.focusVisible}`]:{boxShadow:"none"},"&:active":{boxShadow:"none"},[`&.${A3.disabled}`]:{boxShadow:"none"}}),Cye=Rn("span",{name:"MuiButton",slot:"StartIcon",overridesResolver:(n,e)=>{const{ownerState:i}=n;return[e.startIcon,e[`iconSize${ti(i.size)}`]]}})(({ownerState:n})=>Ge({display:"inherit",marginRight:8,marginLeft:-4},n.size==="small"&&{marginLeft:-2},Xq(n))),Pye=Rn("span",{name:"MuiButton",slot:"EndIcon",overridesResolver:(n,e)=>{const{ownerState:i}=n;return[e.endIcon,e[`iconSize${ti(i.size)}`]]}})(({ownerState:n})=>Ge({display:"inherit",marginRight:-4,marginLeft:8},n.size==="small"&&{marginRight:-2},Xq(n))),Iye=ne.forwardRef(function(e,i){const a=ne.useContext(wye),s=ne.useContext(Eye),l=b4(a,e),d=ar({props:l,name:"MuiButton"}),{children:f,color:p="primary",component:y="button",className:_,disabled:b=!1,disableElevation:S=!1,disableFocusRipple:A=!1,endIcon:P,focusVisibleClassName:L,fullWidth:k=!1,size:R="medium",startIcon:z,type:O,variant:F="text"}=d,H=Wn(d,Mye),$=Ge({},d,{color:p,component:y,disabled:b,disableElevation:S,disableFocusRipple:A,fullWidth:k,size:R,type:O,variant:F}),Y=Tye($),te=z&&U(Cye,{className:Y.startIcon,ownerState:$,children:z}),G=P&&U(Pye,{className:Y.endIcon,ownerState:$,children:P}),Q=s||"";return _e(Aye,Ge({ownerState:$,className:fi(a.className,Y.root,_,Q),component:y,disabled:b,focusRipple:!A,focusVisibleClassName:fi(Y.focusVisible,L),ref:i,type:O},H,{classes:Y,children:[te,f,G]}))}),oi=Iye;function Rye(n){return Zi("PrivateSwitchBase",n)}$i("PrivateSwitchBase",["root","checked","disabled","input","edgeStart","edgeEnd"]);const Lye=["autoFocus","checked","checkedIcon","className","defaultChecked","disabled","disableFocusRipple","edge","icon","id","inputProps","inputRef","name","onBlur","onChange","onFocus","readOnly","required","tabIndex","type","value"],kye=n=>{const{classes:e,checked:i,disabled:a,edge:s}=n,l={root:["root",i&&"checked",a&&"disabled",s&&`edge${ti(s)}`],input:["input"]};return er(l,Rye,e)},Dye=Rn(NA)(({ownerState:n})=>Ge({padding:9,borderRadius:"50%"},n.edge==="start"&&{marginLeft:n.size==="small"?-3:-12},n.edge==="end"&&{marginRight:n.size==="small"?-3:-12})),zye=Rn("input",{shouldForwardProp:Pl})({cursor:"inherit",position:"absolute",opacity:0,width:"100%",height:"100%",top:0,left:0,margin:0,padding:0,zIndex:1}),Oye=ne.forwardRef(function(e,i){const{autoFocus:a,checked:s,checkedIcon:l,className:d,defaultChecked:f,disabled:p,disableFocusRipple:y=!1,edge:_=!1,icon:b,id:S,inputProps:A,inputRef:P,name:L,onBlur:k,onChange:R,onFocus:z,readOnly:O,required:F=!1,tabIndex:H,type:$,value:Y}=e,te=Wn(e,Lye),[G,Q]=ew({controlled:s,default:!!f,name:"SwitchBase",state:"checked"}),he=ny(),pe=me=>{z&&z(me),he&&he.onFocus&&he.onFocus(me)},ye=me=>{k&&k(me),he&&he.onBlur&&he.onBlur(me)},fe=me=>{if(me.nativeEvent.defaultPrevented)return;const we=me.target.checked;Q(we),R&&R(me,we)};let Ae=p;he&&typeof Ae>"u"&&(Ae=he.disabled);const Re=$==="checkbox"||$==="radio",Be=Ge({},e,{checked:G,disabled:Ae,disableFocusRipple:y,edge:_}),le=kye(Be);return _e(Dye,Ge({component:"span",className:fi(le.root,d),centerRipple:!0,focusRipple:!y,disabled:Ae,tabIndex:null,role:void 0,onFocus:pe,onBlur:ye,ownerState:Be,ref:i},te,{children:[U(zye,Ge({autoFocus:a,checked:s,defaultChecked:f,className:le.input,disabled:Ae,id:Re?S:void 0,name:L,onChange:fe,readOnly:O,ref:P,required:F,ownerState:Be,tabIndex:H,type:$},$==="checkbox"&&Y===void 0?{}:{value:Y},A)),G?l:b]}))}),Zq=Oye,Nye=Xw(U("path",{d:"M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"}),"CheckBoxOutlineBlank"),Fye=Xw(U("path",{d:"M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.11 0 2-.9 2-2V5c0-1.1-.89-2-2-2zm-9 14l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"}),"CheckBox"),Bye=Xw(U("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-2 10H7v-2h10v2z"}),"IndeterminateCheckBox");function Uye(n){return Zi("MuiCheckbox",n)}const Wye=$i("MuiCheckbox",["root","checked","disabled","indeterminate","colorPrimary","colorSecondary","sizeSmall","sizeMedium"]),IR=Wye,Vye=["checkedIcon","color","icon","indeterminate","indeterminateIcon","inputProps","size","className"],Gye=n=>{const{classes:e,indeterminate:i,color:a,size:s}=n,l={root:["root",i&&"indeterminate",`color${ti(a)}`,`size${ti(s)}`]},d=er(l,Uye,e);return Ge({},e,d)},Hye=Rn(Zq,{shouldForwardProp:n=>Pl(n)||n==="classes",name:"MuiCheckbox",slot:"Root",overridesResolver:(n,e)=>{const{ownerState:i}=n;return[e.root,i.indeterminate&&e.indeterminate,e[`size${ti(i.size)}`],i.color!=="default"&&e[`color${ti(i.color)}`]]}})(({theme:n,ownerState:e})=>Ge({color:(n.vars||n).palette.text.secondary},!e.disableRipple&&{"&:hover":{backgroundColor:n.vars?`rgba(${e.color==="default"?n.vars.palette.action.activeChannel:n.vars.palette[e.color].mainChannel} / ${n.vars.palette.action.hoverOpacity})`:Sa(e.color==="default"?n.palette.action.active:n.palette[e.color].main,n.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},e.color!=="default"&&{[`&.${IR.checked}, &.${IR.indeterminate}`]:{color:(n.vars||n).palette[e.color].main},[`&.${IR.disabled}`]:{color:(n.vars||n).palette.action.disabled}})),jye=U(Fye,{}),$ye=U(Nye,{}),Yye=U(Bye,{}),qye=ne.forwardRef(function(e,i){var a,s;const l=ar({props:e,name:"MuiCheckbox"}),{checkedIcon:d=jye,color:f="primary",icon:p=$ye,indeterminate:y=!1,indeterminateIcon:_=Yye,inputProps:b,size:S="medium",className:A}=l,P=Wn(l,Vye),L=y?_:p,k=y?_:d,R=Ge({},l,{color:f,indeterminate:y,size:S}),z=Gye(R);return U(Hye,Ge({type:"checkbox",inputProps:Ge({"data-indeterminate":y},b),icon:ne.cloneElement(L,{fontSize:(a=L.props.fontSize)!=null?a:S}),checkedIcon:ne.cloneElement(k,{fontSize:(s=k.props.fontSize)!=null?s:S}),ownerState:R,ref:i,className:fi(z.root,A)},P,{classes:z}))}),Kq=qye;function Xye(n){return Zi("MuiModal",n)}$i("MuiModal",["root","hidden","backdrop"]);const Zye=["BackdropComponent","BackdropProps","classes","className","closeAfterTransition","children","container","component","components","componentsProps","disableAutoFocus","disableEnforceFocus","disableEscapeKeyDown","disablePortal","disableRestoreFocus","disableScrollLock","hideBackdrop","keepMounted","onBackdropClick","onClose","onTransitionEnter","onTransitionExited","open","slotProps","slots","theme"],Kye=n=>{const{open:e,exited:i,classes:a}=n;return er({root:["root",!e&&i&&"hidden"],backdrop:["backdrop"]},Xye,a)},Jye=Rn("div",{name:"MuiModal",slot:"Root",overridesResolver:(n,e)=>{const{ownerState:i}=n;return[e.root,!i.open&&i.exited&&e.hidden]}})(({theme:n,ownerState:e})=>Ge({position:"fixed",zIndex:(n.vars||n).zIndex.modal,right:0,bottom:0,top:0,left:0},!e.open&&e.exited&&{visibility:"hidden"})),Qye=Rn(vye,{name:"MuiModal",slot:"Backdrop",overridesResolver:(n,e)=>e.backdrop})({zIndex:-1}),eve=ne.forwardRef(function(e,i){var a,s,l,d,f,p;const y=ar({name:"MuiModal",props:e}),{BackdropComponent:_=Qye,BackdropProps:b,className:S,closeAfterTransition:A=!1,children:P,container:L,component:k,components:R={},componentsProps:z={},disableAutoFocus:O=!1,disableEnforceFocus:F=!1,disableEscapeKeyDown:H=!1,disablePortal:$=!1,disableRestoreFocus:Y=!1,disableScrollLock:te=!1,hideBackdrop:G=!1,keepMounted:Q=!1,onBackdropClick:he,open:pe,slotProps:ye,slots:fe}=y,Ae=Wn(y,Zye),Re=Ge({},y,{closeAfterTransition:A,disableAutoFocus:O,disableEnforceFocus:F,disableEscapeKeyDown:H,disablePortal:$,disableRestoreFocus:Y,disableScrollLock:te,hideBackdrop:G,keepMounted:Q}),{getRootProps:Be,getBackdropProps:le,getTransitionProps:me,portalRef:we,isTopModal:re,exited:Te,hasTransition:Je}=Uge(Ge({},Re,{rootRef:i})),Xe=Ge({},Re,{exited:Te}),Ze=Kye(Xe),Fe={};if(P.props.tabIndex===void 0&&(Fe.tabIndex="-1"),Je){const{onEnter:pt,onExited:gt}=me();Fe.onEnter=pt,Fe.onExited=gt}const ct=(a=(s=fe==null?void 0:fe.root)!=null?s:R.Root)!=null?a:Jye,At=(l=(d=fe==null?void 0:fe.backdrop)!=null?d:R.Backdrop)!=null?l:_,kt=(f=ye==null?void 0:ye.root)!=null?f:z.root,Kt=(p=ye==null?void 0:ye.backdrop)!=null?p:z.backdrop,Et=Vg({elementType:ct,externalSlotProps:kt,externalForwardedProps:Ae,getSlotProps:Be,additionalProps:{ref:i,as:k},ownerState:Xe,className:fi(S,kt==null?void 0:kt.className,Ze==null?void 0:Ze.root,!Xe.open&&Xe.exited&&(Ze==null?void 0:Ze.hidden))}),Ie=Vg({elementType:At,externalSlotProps:Kt,additionalProps:b,getSlotProps:pt=>le(Ge({},pt,{onClick:gt=>{he&&he(gt),pt!=null&&pt.onClick&&pt.onClick(gt)}})),className:fi(Kt==null?void 0:Kt.className,b==null?void 0:b.className,Ze==null?void 0:Ze.backdrop),ownerState:Xe});return!Q&&!pe&&(!Je||Te)?null:U(Yq,{ref:we,container:L,disablePortal:$,children:_e(ct,Ge({},Et,{children:[!G&&_?U(At,Ge({},Ie)):null,U(mme,{disableEnforceFocus:F,disableAutoFocus:O,disableRestoreFocus:Y,isEnabled:re,open:pe,children:ne.cloneElement(P,Fe)})]}))})}),tve=eve;function nve(n){return Zi("MuiDivider",n)}const uV=$i("MuiDivider",["root","absolute","fullWidth","inset","middle","flexItem","light","vertical","withChildren","withChildrenVertical","textAlignRight","textAlignLeft","wrapper","wrapperVertical"]),ive=["absolute","children","className","component","flexItem","light","orientation","role","textAlign","variant"],rve=n=>{const{absolute:e,children:i,classes:a,flexItem:s,light:l,orientation:d,textAlign:f,variant:p}=n;return er({root:["root",e&&"absolute",p,l&&"light",d==="vertical"&&"vertical",s&&"flexItem",i&&"withChildren",i&&d==="vertical"&&"withChildrenVertical",f==="right"&&d!=="vertical"&&"textAlignRight",f==="left"&&d!=="vertical"&&"textAlignLeft"],wrapper:["wrapper",d==="vertical"&&"wrapperVertical"]},nve,a)},ave=Rn("div",{name:"MuiDivider",slot:"Root",overridesResolver:(n,e)=>{const{ownerState:i}=n;return[e.root,i.absolute&&e.absolute,e[i.variant],i.light&&e.light,i.orientation==="vertical"&&e.vertical,i.flexItem&&e.flexItem,i.children&&e.withChildren,i.children&&i.orientation==="vertical"&&e.withChildrenVertical,i.textAlign==="right"&&i.orientation!=="vertical"&&e.textAlignRight,i.textAlign==="left"&&i.orientation!=="vertical"&&e.textAlignLeft]}})(({theme:n,ownerState:e})=>Ge({margin:0,flexShrink:0,borderWidth:0,borderStyle:"solid",borderColor:(n.vars||n).palette.divider,borderBottomWidth:"thin"},e.absolute&&{position:"absolute",bottom:0,left:0,width:"100%"},e.light&&{borderColor:n.vars?`rgba(${n.vars.palette.dividerChannel} / 0.08)`:Sa(n.palette.divider,.08)},e.variant==="inset"&&{marginLeft:72},e.variant==="middle"&&e.orientation==="horizontal"&&{marginLeft:n.spacing(2),marginRight:n.spacing(2)},e.variant==="middle"&&e.orientation==="vertical"&&{marginTop:n.spacing(1),marginBottom:n.spacing(1)},e.orientation==="vertical"&&{height:"100%",borderBottomWidth:0,borderRightWidth:"thin"},e.flexItem&&{alignSelf:"stretch",height:"auto"}),({ownerState:n})=>Ge({},n.children&&{display:"flex",whiteSpace:"nowrap",textAlign:"center",border:0,"&::before, &::after":{content:'""',alignSelf:"center"}}),({theme:n,ownerState:e})=>Ge({},e.children&&e.orientation!=="vertical"&&{"&::before, &::after":{width:"100%",borderTop:`thin solid ${(n.vars||n).palette.divider}`}}),({theme:n,ownerState:e})=>Ge({},e.children&&e.orientation==="vertical"&&{flexDirection:"column","&::before, &::after":{height:"100%",borderLeft:`thin solid ${(n.vars||n).palette.divider}`}}),({ownerState:n})=>Ge({},n.textAlign==="right"&&n.orientation!=="vertical"&&{"&::before":{width:"90%"},"&::after":{width:"10%"}},n.textAlign==="left"&&n.orientation!=="vertical"&&{"&::before":{width:"10%"},"&::after":{width:"90%"}})),ove=Rn("span",{name:"MuiDivider",slot:"Wrapper",overridesResolver:(n,e)=>{const{ownerState:i}=n;return[e.wrapper,i.orientation==="vertical"&&e.wrapperVertical]}})(({theme:n,ownerState:e})=>Ge({display:"inline-block",paddingLeft:`calc(${n.spacing(1)} * 1.2)`,paddingRight:`calc(${n.spacing(1)} * 1.2)`},e.orientation==="vertical"&&{paddingTop:`calc(${n.spacing(1)} * 1.2)`,paddingBottom:`calc(${n.spacing(1)} * 1.2)`})),Jq=ne.forwardRef(function(e,i){const a=ar({props:e,name:"MuiDivider"}),{absolute:s=!1,children:l,className:d,component:f=l?"div":"hr",flexItem:p=!1,light:y=!1,orientation:_="horizontal",role:b=f!=="hr"?"separator":void 0,textAlign:S="center",variant:A="fullWidth"}=a,P=Wn(a,ive),L=Ge({},a,{absolute:s,component:f,flexItem:p,light:y,orientation:_,role:b,textAlign:S,variant:A}),k=rve(L);return U(ave,Ge({as:f,className:fi(k.root,d),role:b,ref:i,ownerState:L},P,{children:l?U(ove,{className:k.wrapper,ownerState:L,children:l}):null}))});Jq.muiSkipListHighlight=!0;const mx=Jq,sve=["addEndListener","appear","children","container","direction","easing","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","style","timeout","TransitionComponent"];function lve(n,e,i){const a=e.getBoundingClientRect(),s=i&&i.getBoundingClientRect(),l=Md(e);let d;if(e.fakeTransform)d=e.fakeTransform;else{const y=l.getComputedStyle(e);d=y.getPropertyValue("-webkit-transform")||y.getPropertyValue("transform")}let f=0,p=0;if(d&&d!=="none"&&typeof d=="string"){const y=d.split("(")[1].split(")")[0].split(",");f=parseInt(y[4],10),p=parseInt(y[5],10)}return n==="left"?s?`translateX(${s.right+f-a.left}px)`:`translateX(${l.innerWidth+f-a.left}px)`:n==="right"?s?`translateX(-${a.right-s.left-f}px)`:`translateX(-${a.left+a.width-f}px)`:n==="up"?s?`translateY(${s.bottom+p-a.top}px)`:`translateY(${l.innerHeight+p-a.top}px)`:s?`translateY(-${a.top-s.top+a.height-p}px)`:`translateY(-${a.top+a.height-p}px)`}function cve(n){return typeof n=="function"?n():n}function C3(n,e,i){const a=cve(i),s=lve(n,e,a);s&&(e.style.webkitTransform=s,e.style.transform=s)}const uve=ne.forwardRef(function(e,i){const a=zp(),s={enter:a.transitions.easing.easeOut,exit:a.transitions.easing.sharp},l={enter:a.transitions.duration.enteringScreen,exit:a.transitions.duration.leavingScreen},{addEndListener:d,appear:f=!0,children:p,container:y,direction:_="down",easing:b=s,in:S,onEnter:A,onEntered:P,onEntering:L,onExit:k,onExited:R,onExiting:z,style:O,timeout:F=l,TransitionComponent:H=H4}=e,$=Wn(e,sve),Y=ne.useRef(null),te=Mo(p.ref,Y,i),G=le=>me=>{le&&(me===void 0?le(Y.current):le(Y.current,me))},Q=G((le,me)=>{C3(_,le,y),Y4(le),A&&A(le,me)}),he=G((le,me)=>{const we=u_({timeout:F,style:O,easing:b},{mode:"enter"});le.style.webkitTransition=a.transitions.create("-webkit-transform",Ge({},we)),le.style.transition=a.transitions.create("transform",Ge({},we)),le.style.webkitTransform="none",le.style.transform="none",L&&L(le,me)}),pe=G(P),ye=G(z),fe=G(le=>{const me=u_({timeout:F,style:O,easing:b},{mode:"exit"});le.style.webkitTransition=a.transitions.create("-webkit-transform",me),le.style.transition=a.transitions.create("transform",me),C3(_,le,y),k&&k(le)}),Ae=G(le=>{le.style.webkitTransition="",le.style.transition="",R&&R(le)}),Re=le=>{d&&d(Y.current,le)},Be=ne.useCallback(()=>{Y.current&&C3(_,Y.current,y)},[_,y]);return ne.useEffect(()=>{if(S||_==="down"||_==="right")return;const le=sA(()=>{Y.current&&C3(_,Y.current,y)}),me=Md(Y.current);return me.addEventListener("resize",le),()=>{le.clear(),me.removeEventListener("resize",le)}},[_,S,y]),ne.useEffect(()=>{S||Be()},[S,Be]),U(H,Ge({nodeRef:Y,onEnter:Q,onEntered:pe,onEntering:he,onExit:fe,onExited:Ae,onExiting:ye,addEndListener:Re,appear:f,in:S,timeout:F},$,{children:(le,me)=>ne.cloneElement(p,Ge({ref:te,style:Ge({visibility:le==="exited"&&!S?"hidden":void 0},O,p.props.style)},me))}))}),dve=uve,hve=["disableUnderline","components","componentsProps","fullWidth","hiddenLabel","inputComponent","multiline","slotProps","slots","type"],fve=n=>{const{classes:e,disableUnderline:i}=n,s=er({root:["root",!i&&"underline"],input:["input"]},oye,e);return Ge({},e,s)},pve=Rn(WA,{shouldForwardProp:n=>Pl(n)||n==="classes",name:"MuiFilledInput",slot:"Root",overridesResolver:(n,e)=>{const{ownerState:i}=n;return[...BA(n,e),!i.disableUnderline&&e.underline]}})(({theme:n,ownerState:e})=>{var i;const a=n.palette.mode==="light",s=a?"rgba(0, 0, 0, 0.42)":"rgba(255, 255, 255, 0.7)",l=a?"rgba(0, 0, 0, 0.06)":"rgba(255, 255, 255, 0.09)",d=a?"rgba(0, 0, 0, 0.09)":"rgba(255, 255, 255, 0.13)",f=a?"rgba(0, 0, 0, 0.12)":"rgba(255, 255, 255, 0.12)";return Ge({position:"relative",backgroundColor:n.vars?n.vars.palette.FilledInput.bg:l,borderTopLeftRadius:(n.vars||n).shape.borderRadius,borderTopRightRadius:(n.vars||n).shape.borderRadius,transition:n.transitions.create("background-color",{duration:n.transitions.duration.shorter,easing:n.transitions.easing.easeOut}),"&:hover":{backgroundColor:n.vars?n.vars.palette.FilledInput.hoverBg:d,"@media (hover: none)":{backgroundColor:n.vars?n.vars.palette.FilledInput.bg:l}},[`&.${Vm.focused}`]:{backgroundColor:n.vars?n.vars.palette.FilledInput.bg:l},[`&.${Vm.disabled}`]:{backgroundColor:n.vars?n.vars.palette.FilledInput.disabledBg:f}},!e.disableUnderline&&{"&:after":{borderBottom:`2px solid ${(i=(n.vars||n).palette[e.color||"primary"])==null?void 0:i.main}`,left:0,bottom:0,content:'""',position:"absolute",right:0,transform:"scaleX(0)",transition:n.transitions.create("transform",{duration:n.transitions.duration.shorter,easing:n.transitions.easing.easeOut}),pointerEvents:"none"},[`&.${Vm.focused}:after`]:{transform:"scaleX(1) translateX(0)"},[`&.${Vm.error}`]:{"&:before, &:after":{borderBottomColor:(n.vars||n).palette.error.main}},"&:before":{borderBottom:`1px solid ${n.vars?`rgba(${n.vars.palette.common.onBackgroundChannel} / ${n.vars.opacity.inputUnderline})`:s}`,left:0,bottom:0,content:'"\\00a0"',position:"absolute",right:0,transition:n.transitions.create("border-bottom-color",{duration:n.transitions.duration.shorter}),pointerEvents:"none"},[`&:hover:not(.${Vm.disabled}, .${Vm.error}):before`]:{borderBottom:`1px solid ${(n.vars||n).palette.text.primary}`},[`&.${Vm.disabled}:before`]:{borderBottomStyle:"dotted"}},e.startAdornment&&{paddingLeft:12},e.endAdornment&&{paddingRight:12},e.multiline&&Ge({padding:"25px 12px 8px"},e.size==="small"&&{paddingTop:21,paddingBottom:4},e.hiddenLabel&&{paddingTop:16,paddingBottom:17}))}),mve=Rn(VA,{name:"MuiFilledInput",slot:"Input",overridesResolver:UA})(({theme:n,ownerState:e})=>Ge({paddingTop:25,paddingRight:12,paddingBottom:8,paddingLeft:12},!n.vars&&{"&:-webkit-autofill":{WebkitBoxShadow:n.palette.mode==="light"?null:"0 0 0 100px #266798 inset",WebkitTextFillColor:n.palette.mode==="light"?null:"#fff",caretColor:n.palette.mode==="light"?null:"#fff",borderTopLeftRadius:"inherit",borderTopRightRadius:"inherit"}},n.vars&&{"&:-webkit-autofill":{borderTopLeftRadius:"inherit",borderTopRightRadius:"inherit"},[n.getColorSchemeSelector("dark")]:{"&:-webkit-autofill":{WebkitBoxShadow:"0 0 0 100px #266798 inset",WebkitTextFillColor:"#fff",caretColor:"#fff"}}},e.size==="small"&&{paddingTop:21,paddingBottom:4},e.hiddenLabel&&{paddingTop:16,paddingBottom:17},e.multiline&&{paddingTop:0,paddingBottom:0,paddingLeft:0,paddingRight:0},e.startAdornment&&{paddingLeft:0},e.endAdornment&&{paddingRight:0},e.hiddenLabel&&e.size==="small"&&{paddingTop:8,paddingBottom:9})),Qq=ne.forwardRef(function(e,i){var a,s,l,d;const f=ar({props:e,name:"MuiFilledInput"}),{components:p={},componentsProps:y,fullWidth:_=!1,inputComponent:b="input",multiline:S=!1,slotProps:A,slots:P={},type:L="text"}=f,k=Wn(f,hve),R=Ge({},f,{fullWidth:_,inputComponent:b,multiline:S,type:L}),z=fve(f),O={root:{ownerState:R},input:{ownerState:R}},F=A??y?Ml(A??y,O):O,H=(a=(s=P.root)!=null?s:p.Root)!=null?a:pve,$=(l=(d=P.input)!=null?d:p.Input)!=null?l:mve;return U(GA,Ge({slots:{root:H,input:$},componentsProps:F,fullWidth:_,inputComponent:b,multiline:S,ref:i,type:L},k,{classes:z}))});Qq.muiName="Input";const eX=Qq;function gve(n){return Zi("MuiFormControl",n)}$i("MuiFormControl",["root","marginNone","marginNormal","marginDense","fullWidth","disabled"]);const yve=["children","className","color","component","disabled","error","focused","fullWidth","hiddenLabel","margin","required","size","variant"],vve=n=>{const{classes:e,margin:i,fullWidth:a}=n,s={root:["root",i!=="none"&&`margin${ti(i)}`,a&&"fullWidth"]};return er(s,gve,e)},_ve=Rn("div",{name:"MuiFormControl",slot:"Root",overridesResolver:({ownerState:n},e)=>Ge({},e.root,e[`margin${ti(n.margin)}`],n.fullWidth&&e.fullWidth)})(({ownerState:n})=>Ge({display:"inline-flex",flexDirection:"column",position:"relative",minWidth:0,padding:0,margin:0,border:0,verticalAlign:"top"},n.margin==="normal"&&{marginTop:16,marginBottom:8},n.margin==="dense"&&{marginTop:8,marginBottom:4},n.fullWidth&&{width:"100%"})),xve=ne.forwardRef(function(e,i){const a=ar({props:e,name:"MuiFormControl"}),{children:s,className:l,color:d="primary",component:f="div",disabled:p=!1,error:y=!1,focused:_,fullWidth:b=!1,hiddenLabel:S=!1,margin:A="none",required:P=!1,size:L="medium",variant:k="outlined"}=a,R=Wn(a,yve),z=Ge({},a,{color:d,component:f,disabled:p,error:y,fullWidth:b,hiddenLabel:S,margin:A,required:P,size:L,variant:k}),O=vve(z),[F,H]=ne.useState(()=>{let ye=!1;return s&&ne.Children.forEach(s,fe=>{if(!oM(fe,["Input","Select"]))return;const Ae=oM(fe,["Select"])?fe.props.input:fe;Ae&&Xge(Ae.props)&&(ye=!0)}),ye}),[$,Y]=ne.useState(()=>{let ye=!1;return s&&ne.Children.forEach(s,fe=>{oM(fe,["Input","Select"])&&(hT(fe.props,!0)||hT(fe.props.inputProps,!0))&&(ye=!0)}),ye}),[te,G]=ne.useState(!1);p&&te&&G(!1);const Q=_!==void 0&&!p?_:te;let he;const pe=ne.useMemo(()=>({adornedStart:F,setAdornedStart:H,color:d,disabled:p,error:y,filled:$,focused:Q,fullWidth:b,hiddenLabel:S,size:L,onBlur:()=>{G(!1)},onEmpty:()=>{Y(!1)},onFilled:()=>{Y(!0)},onFocus:()=>{G(!0)},registerEffect:he,required:P,variant:k}),[F,d,p,y,$,Q,b,S,he,P,L,k]);return U(tz.Provider,{value:pe,children:U(_ve,Ge({as:f,ownerState:z,className:fi(O.root,l),ref:i},R,{children:s}))})}),tX=xve;function bve(n){return Zi("MuiFormHelperText",n)}const wve=$i("MuiFormHelperText",["root","error","disabled","sizeSmall","sizeMedium","contained","focused","filled","required"]),dV=wve;var hV;const Sve=["children","className","component","disabled","error","filled","focused","margin","required","variant"],Eve=n=>{const{classes:e,contained:i,size:a,disabled:s,error:l,filled:d,focused:f,required:p}=n,y={root:["root",s&&"disabled",l&&"error",a&&`size${ti(a)}`,i&&"contained",f&&"focused",d&&"filled",p&&"required"]};return er(y,bve,e)},Mve=Rn("p",{name:"MuiFormHelperText",slot:"Root",overridesResolver:(n,e)=>{const{ownerState:i}=n;return[e.root,i.size&&e[`size${ti(i.size)}`],i.contained&&e.contained,i.filled&&e.filled]}})(({theme:n,ownerState:e})=>Ge({color:(n.vars||n).palette.text.secondary},n.typography.caption,{textAlign:"left",marginTop:3,marginRight:0,marginBottom:0,marginLeft:0,[`&.${dV.disabled}`]:{color:(n.vars||n).palette.text.disabled},[`&.${dV.error}`]:{color:(n.vars||n).palette.error.main}},e.size==="small"&&{marginTop:4},e.contained&&{marginLeft:14,marginRight:14})),Tve=ne.forwardRef(function(e,i){const a=ar({props:e,name:"MuiFormHelperText"}),{children:s,className:l,component:d="p"}=a,f=Wn(a,Sve),p=ny(),y=I_({props:a,muiFormControl:p,states:["variant","size","disabled","error","filled","focused","required"]}),_=Ge({},a,{component:d,contained:y.variant==="filled"||y.variant==="outlined",variant:y.variant,size:y.size,disabled:y.disabled,error:y.error,filled:y.filled,focused:y.focused,required:y.required}),b=Eve(_);return U(Mve,Ge({as:d,ownerState:_,className:fi(b.root,l),ref:i},f,{children:s===" "?hV||(hV=U("span",{className:"notranslate",children:""})):s}))}),Ave=Tve;function Cve(n){return Zi("MuiFormLabel",n)}const Pve=$i("MuiFormLabel",["root","colorSecondary","focused","disabled","error","filled","required","asterisk"]),yb=Pve,Ive=["children","className","color","component","disabled","error","filled","focused","required"],Rve=n=>{const{classes:e,color:i,focused:a,disabled:s,error:l,filled:d,required:f}=n,p={root:["root",`color${ti(i)}`,s&&"disabled",l&&"error",d&&"filled",a&&"focused",f&&"required"],asterisk:["asterisk",l&&"error"]};return er(p,Cve,e)},Lve=Rn("label",{name:"MuiFormLabel",slot:"Root",overridesResolver:({ownerState:n},e)=>Ge({},e.root,n.color==="secondary"&&e.colorSecondary,n.filled&&e.filled)})(({theme:n,ownerState:e})=>Ge({color:(n.vars||n).palette.text.secondary},n.typography.body1,{lineHeight:"1.4375em",padding:0,position:"relative",[`&.${yb.focused}`]:{color:(n.vars||n).palette[e.color].main},[`&.${yb.disabled}`]:{color:(n.vars||n).palette.text.disabled},[`&.${yb.error}`]:{color:(n.vars||n).palette.error.main}})),kve=Rn("span",{name:"MuiFormLabel",slot:"Asterisk",overridesResolver:(n,e)=>e.asterisk})(({theme:n})=>({[`&.${yb.error}`]:{color:(n.vars||n).palette.error.main}})),Dve=ne.forwardRef(function(e,i){const a=ar({props:e,name:"MuiFormLabel"}),{children:s,className:l,component:d="label"}=a,f=Wn(a,Ive),p=ny(),y=I_({props:a,muiFormControl:p,states:["color","required","focused","disabled","error","filled"]}),_=Ge({},a,{color:y.color||"primary",component:d,disabled:y.disabled,error:y.error,filled:y.filled,focused:y.focused,required:y.required}),b=Rve(_);return _e(Lve,Ge({as:d,ownerState:_,className:fi(b.root,l),ref:i},f,{children:[s,y.required&&_e(kve,{ownerState:_,"aria-hidden":!0,className:b.asterisk,children:["","*"]})]}))}),zve=Dve,Ove=ne.createContext(),fV=Ove;function Nve(n){return Zi("MuiGrid",n)}const Fve=[0,1,2,3,4,5,6,7,8,9,10],Bve=["column-reverse","column","row-reverse","row"],Uve=["nowrap","wrap-reverse","wrap"],gx=["auto",!0,1,2,3,4,5,6,7,8,9,10,11,12],Wve=$i("MuiGrid",["root","container","item","zeroMinWidth",...Fve.map(n=>`spacing-xs-${n}`),...Bve.map(n=>`direction-xs-${n}`),...Uve.map(n=>`wrap-xs-${n}`),...gx.map(n=>`grid-xs-${n}`),...gx.map(n=>`grid-sm-${n}`),...gx.map(n=>`grid-md-${n}`),...gx.map(n=>`grid-lg-${n}`),...gx.map(n=>`grid-xl-${n}`)]),ow=Wve,Vve=["className","columns","columnSpacing","component","container","direction","item","rowSpacing","spacing","wrap","zeroMinWidth"];function Z0(n){const e=parseFloat(n);return`${e}${String(n).replace(String(e),"")||"px"}`}function Gve({theme:n,ownerState:e}){let i;return n.breakpoints.keys.reduce((a,s)=>{let l={};if(e[s]&&(i=e[s]),!i)return a;if(i===!0)l={flexBasis:0,flexGrow:1,maxWidth:"100%"};else if(i==="auto")l={flexBasis:"auto",flexGrow:0,flexShrink:0,maxWidth:"none",width:"auto"};else{const d=TA({values:e.columns,breakpoints:n.breakpoints.values}),f=typeof d=="object"?d[s]:d;if(f==null)return a;const p=`${Math.round(i/f*1e8)/1e6}%`;let y={};if(e.container&&e.item&&e.columnSpacing!==0){const _=n.spacing(e.columnSpacing);if(_!=="0px"){const b=`calc(${p} + ${Z0(_)})`;y={flexBasis:b,maxWidth:b}}}l=Ge({flexBasis:p,flexGrow:0,maxWidth:p},y)}return n.breakpoints.values[s]===0?Object.assign(a,l):a[n.breakpoints.up(s)]=l,a},{})}function Hve({theme:n,ownerState:e}){const i=TA({values:e.direction,breakpoints:n.breakpoints.values});return Dc({theme:n},i,a=>{const s={flexDirection:a};return a.indexOf("column")===0&&(s[`& > .${ow.item}`]={maxWidth:"none"}),s})}function nX({breakpoints:n,values:e}){let i="";Object.keys(e).forEach(s=>{i===""&&e[s]!==0&&(i=s)});const a=Object.keys(n).sort((s,l)=>n[s]-n[l]);return a.slice(0,a.indexOf(i))}function jve({theme:n,ownerState:e}){const{container:i,rowSpacing:a}=e;let s={};if(i&&a!==0){const l=TA({values:a,breakpoints:n.breakpoints.values});let d;typeof l=="object"&&(d=nX({breakpoints:n.breakpoints.values,values:l})),s=Dc({theme:n},l,(f,p)=>{var y;const _=n.spacing(f);return _!=="0px"?{marginTop:`-${Z0(_)}`,[`& > .${ow.item}`]:{paddingTop:Z0(_)}}:(y=d)!=null&&y.includes(p)?{}:{marginTop:0,[`& > .${ow.item}`]:{paddingTop:0}}})}return s}function $ve({theme:n,ownerState:e}){const{container:i,columnSpacing:a}=e;let s={};if(i&&a!==0){const l=TA({values:a,breakpoints:n.breakpoints.values});let d;typeof l=="object"&&(d=nX({breakpoints:n.breakpoints.values,values:l})),s=Dc({theme:n},l,(f,p)=>{var y;const _=n.spacing(f);return _!=="0px"?{width:`calc(100% + ${Z0(_)})`,marginLeft:`-${Z0(_)}`,[`& > .${ow.item}`]:{paddingLeft:Z0(_)}}:(y=d)!=null&&y.includes(p)?{}:{width:"100%",marginLeft:0,[`& > .${ow.item}`]:{paddingLeft:0}}})}return s}function Yve(n,e,i={}){if(!n||n<=0)return[];if(typeof n=="string"&&!Number.isNaN(Number(n))||typeof n=="number")return[i[`spacing-xs-${String(n)}`]];const a=[];return e.forEach(s=>{const l=n[s];Number(l)>0&&a.push(i[`spacing-${s}-${String(l)}`])}),a}const qve=Rn("div",{name:"MuiGrid",slot:"Root",overridesResolver:(n,e)=>{const{ownerState:i}=n,{container:a,direction:s,item:l,spacing:d,wrap:f,zeroMinWidth:p,breakpoints:y}=i;let _=[];a&&(_=Yve(d,y,e));const b=[];return y.forEach(S=>{const A=i[S];A&&b.push(e[`grid-${S}-${String(A)}`])}),[e.root,a&&e.container,l&&e.item,p&&e.zeroMinWidth,..._,s!=="row"&&e[`direction-xs-${String(s)}`],f!=="wrap"&&e[`wrap-xs-${String(f)}`],...b]}})(({ownerState:n})=>Ge({boxSizing:"border-box"},n.container&&{display:"flex",flexWrap:"wrap",width:"100%"},n.item&&{margin:0},n.zeroMinWidth&&{minWidth:0},n.wrap!=="wrap"&&{flexWrap:n.wrap}),Hve,jve,$ve,Gve);function Xve(n,e){if(!n||n<=0)return[];if(typeof n=="string"&&!Number.isNaN(Number(n))||typeof n=="number")return[`spacing-xs-${String(n)}`];const i=[];return e.forEach(a=>{const s=n[a];if(Number(s)>0){const l=`spacing-${a}-${String(s)}`;i.push(l)}}),i}const Zve=n=>{const{classes:e,container:i,direction:a,item:s,spacing:l,wrap:d,zeroMinWidth:f,breakpoints:p}=n;let y=[];i&&(y=Xve(l,p));const _=[];p.forEach(S=>{const A=n[S];A&&_.push(`grid-${S}-${String(A)}`)});const b={root:["root",i&&"container",s&&"item",f&&"zeroMinWidth",...y,a!=="row"&&`direction-xs-${String(a)}`,d!=="wrap"&&`wrap-xs-${String(d)}`,..._]};return er(b,Nve,e)},Kve=ne.forwardRef(function(e,i){const a=ar({props:e,name:"MuiGrid"}),{breakpoints:s}=zp(),l=Cq(a),{className:d,columns:f,columnSpacing:p,component:y="div",container:_=!1,direction:b="row",item:S=!1,rowSpacing:A,spacing:P=0,wrap:L="wrap",zeroMinWidth:k=!1}=l,R=Wn(l,Vve),z=A||P,O=p||P,F=ne.useContext(fV),H=_?f||12:F,$={},Y=Ge({},R);s.keys.forEach(Q=>{R[Q]!=null&&($[Q]=R[Q],delete Y[Q])});const te=Ge({},l,{columns:H,container:_,direction:b,item:S,rowSpacing:z,columnSpacing:O,wrap:L,zeroMinWidth:k,spacing:P},$,{breakpoints:s.keys}),G=Zve(te);return U(fV.Provider,{value:H,children:U(qve,Ge({ownerState:te,className:fi(G.root,d),as:y,ref:i},Y))})}),Vl=Kve,Jve=["addEndListener","appear","children","easing","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","style","timeout","TransitionComponent"];function r5(n){return`scale(${n}, ${n**2})`}const Qve={entering:{opacity:1,transform:r5(1)},entered:{opacity:1,transform:"none"}},RR=typeof navigator<"u"&&/^((?!chrome|android).)*(safari|mobile)/i.test(navigator.userAgent)&&/(os |version\/)15(.|_)4/i.test(navigator.userAgent),iX=ne.forwardRef(function(e,i){const{addEndListener:a,appear:s=!0,children:l,easing:d,in:f,onEnter:p,onEntered:y,onEntering:_,onExit:b,onExited:S,onExiting:A,style:P,timeout:L="auto",TransitionComponent:k=H4}=e,R=Wn(e,Jve),z=ne.useRef(),O=ne.useRef(),F=zp(),H=ne.useRef(null),$=Mo(H,l.ref,i),Y=Ae=>Re=>{if(Ae){const Be=H.current;Re===void 0?Ae(Be):Ae(Be,Re)}},te=Y(_),G=Y((Ae,Re)=>{Y4(Ae);const{duration:Be,delay:le,easing:me}=u_({style:P,timeout:L,easing:d},{mode:"enter"});let we;L==="auto"?(we=F.transitions.getAutoHeightDuration(Ae.clientHeight),O.current=we):we=Be,Ae.style.transition=[F.transitions.create("opacity",{duration:we,delay:le}),F.transitions.create("transform",{duration:RR?we:we*.666,delay:le,easing:me})].join(","),p&&p(Ae,Re)}),Q=Y(y),he=Y(A),pe=Y(Ae=>{const{duration:Re,delay:Be,easing:le}=u_({style:P,timeout:L,easing:d},{mode:"exit"});let me;L==="auto"?(me=F.transitions.getAutoHeightDuration(Ae.clientHeight),O.current=me):me=Re,Ae.style.transition=[F.transitions.create("opacity",{duration:me,delay:Be}),F.transitions.create("transform",{duration:RR?me:me*.666,delay:RR?Be:Be||me*.333,easing:le})].join(","),Ae.style.opacity=0,Ae.style.transform=r5(.75),b&&b(Ae)}),ye=Y(S),fe=Ae=>{L==="auto"&&(z.current=setTimeout(Ae,O.current||0)),a&&a(H.current,Ae)};return ne.useEffect(()=>()=>{clearTimeout(z.current)},[]),U(k,Ge({appear:s,in:f,nodeRef:H,onEnter:G,onEntered:Q,onEntering:te,onExit:pe,onExited:ye,onExiting:he,addEndListener:fe,timeout:L==="auto"?null:L},R,{children:(Ae,Re)=>ne.cloneElement(l,Ge({style:Ge({opacity:0,transform:r5(.75),visibility:Ae==="exited"&&!f?"hidden":void 0},Qve[Ae],P,l.props.style),ref:$},Re))}))});iX.muiSupportAuto=!0;const a5=iX,e0e=["disableUnderline","components","componentsProps","fullWidth","inputComponent","multiline","slotProps","slots","type"],t0e=n=>{const{classes:e,disableUnderline:i}=n,s=er({root:["root",!i&&"underline"],input:["input"]},nye,e);return Ge({},e,s)},n0e=Rn(WA,{shouldForwardProp:n=>Pl(n)||n==="classes",name:"MuiInput",slot:"Root",overridesResolver:(n,e)=>{const{ownerState:i}=n;return[...BA(n,e),!i.disableUnderline&&e.underline]}})(({theme:n,ownerState:e})=>{let a=n.palette.mode==="light"?"rgba(0, 0, 0, 0.42)":"rgba(255, 255, 255, 0.7)";return n.vars&&(a=`rgba(${n.vars.palette.common.onBackgroundChannel} / ${n.vars.opacity.inputUnderline})`),Ge({position:"relative"},e.formControl&&{"label + &":{marginTop:16}},!e.disableUnderline&&{"&:after":{borderBottom:`2px solid ${(n.vars||n).palette[e.color].main}`,left:0,bottom:0,content:'""',position:"absolute",right:0,transform:"scaleX(0)",transition:n.transitions.create("transform",{duration:n.transitions.duration.shorter,easing:n.transitions.easing.easeOut}),pointerEvents:"none"},[`&.${px.focused}:after`]:{transform:"scaleX(1) translateX(0)"},[`&.${px.error}`]:{"&:before, &:after":{borderBottomColor:(n.vars||n).palette.error.main}},"&:before":{borderBottom:`1px solid ${a}`,left:0,bottom:0,content:'"\\00a0"',position:"absolute",right:0,transition:n.transitions.create("border-bottom-color",{duration:n.transitions.duration.shorter}),pointerEvents:"none"},[`&:hover:not(.${px.disabled}, .${px.error}):before`]:{borderBottom:`2px solid ${(n.vars||n).palette.text.primary}`,"@media (hover: none)":{borderBottom:`1px solid ${a}`}},[`&.${px.disabled}:before`]:{borderBottomStyle:"dotted"}})}),i0e=Rn(VA,{name:"MuiInput",slot:"Input",overridesResolver:UA})({}),rX=ne.forwardRef(function(e,i){var a,s,l,d;const f=ar({props:e,name:"MuiInput"}),{disableUnderline:p,components:y={},componentsProps:_,fullWidth:b=!1,inputComponent:S="input",multiline:A=!1,slotProps:P,slots:L={},type:k="text"}=f,R=Wn(f,e0e),z=t0e(f),F={root:{ownerState:{disableUnderline:p}}},H=P??_?Ml(P??_,F):F,$=(a=(s=L.root)!=null?s:y.Root)!=null?a:n0e,Y=(l=(d=L.input)!=null?d:y.Input)!=null?l:i0e;return U(GA,Ge({slots:{root:$,input:Y},slotProps:H,fullWidth:b,inputComponent:S,multiline:A,ref:i,type:k},R,{classes:z}))});rX.muiName="Input";const aX=rX;function r0e(n){return Zi("MuiInputLabel",n)}$i("MuiInputLabel",["root","focused","disabled","error","required","asterisk","formControl","sizeSmall","shrink","animated","standard","filled","outlined"]);const a0e=["disableAnimation","margin","shrink","variant","className"],o0e=n=>{const{classes:e,formControl:i,size:a,shrink:s,disableAnimation:l,variant:d,required:f}=n,p={root:["root",i&&"formControl",!l&&"animated",s&&"shrink",a&&a!=="normal"&&`size${ti(a)}`,d],asterisk:[f&&"asterisk"]},y=er(p,r0e,e);return Ge({},e,y)},s0e=Rn(zve,{shouldForwardProp:n=>Pl(n)||n==="classes",name:"MuiInputLabel",slot:"Root",overridesResolver:(n,e)=>{const{ownerState:i}=n;return[{[`& .${yb.asterisk}`]:e.asterisk},e.root,i.formControl&&e.formControl,i.size==="small"&&e.sizeSmall,i.shrink&&e.shrink,!i.disableAnimation&&e.animated,i.focused&&e.focused,e[i.variant]]}})(({theme:n,ownerState:e})=>Ge({display:"block",transformOrigin:"top left",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"100%"},e.formControl&&{position:"absolute",left:0,top:0,transform:"translate(0, 20px) scale(1)"},e.size==="small"&&{transform:"translate(0, 17px) scale(1)"},e.shrink&&{transform:"translate(0, -1.5px) scale(0.75)",transformOrigin:"top left",maxWidth:"133%"},!e.disableAnimation&&{transition:n.transitions.create(["color","transform","max-width"],{duration:n.transitions.duration.shorter,easing:n.transitions.easing.easeOut})},e.variant==="filled"&&Ge({zIndex:1,pointerEvents:"none",transform:"translate(12px, 16px) scale(1)",maxWidth:"calc(100% - 24px)"},e.size==="small"&&{transform:"translate(12px, 13px) scale(1)"},e.shrink&&Ge({userSelect:"none",pointerEvents:"auto",transform:"translate(12px, 7px) scale(0.75)",maxWidth:"calc(133% - 24px)"},e.size==="small"&&{transform:"translate(12px, 4px) scale(0.75)"})),e.variant==="outlined"&&Ge({zIndex:1,pointerEvents:"none",transform:"translate(14px, 16px) scale(1)",maxWidth:"calc(100% - 24px)"},e.size==="small"&&{transform:"translate(14px, 9px) scale(1)"},e.shrink&&{userSelect:"none",pointerEvents:"auto",maxWidth:"calc(133% - 32px)",transform:"translate(14px, -9px) scale(0.75)"}))),l0e=ne.forwardRef(function(e,i){const a=ar({name:"MuiInputLabel",props:e}),{disableAnimation:s=!1,shrink:l,className:d}=a,f=Wn(a,a0e),p=ny();let y=l;typeof y>"u"&&p&&(y=p.filled||p.focused||p.adornedStart);const _=I_({props:a,muiFormControl:p,states:["size","variant","required","focused"]}),b=Ge({},a,{disableAnimation:s,formControl:p,shrink:y,size:_.size,variant:_.variant,required:_.required,focused:_.focused}),S=o0e(b);return U(s0e,Ge({"data-shrink":y,ownerState:b,ref:i,className:fi(S.root,d)},f,{classes:S}))}),oX=l0e,c0e=ne.createContext({}),o5=c0e;function u0e(n){return Zi("MuiList",n)}$i("MuiList",["root","padding","dense","subheader"]);const d0e=["children","className","component","dense","disablePadding","subheader"],h0e=n=>{const{classes:e,disablePadding:i,dense:a,subheader:s}=n;return er({root:["root",!i&&"padding",a&&"dense",s&&"subheader"]},u0e,e)},f0e=Rn("ul",{name:"MuiList",slot:"Root",overridesResolver:(n,e)=>{const{ownerState:i}=n;return[e.root,!i.disablePadding&&e.padding,i.dense&&e.dense,i.subheader&&e.subheader]}})(({ownerState:n})=>Ge({listStyle:"none",margin:0,padding:0,position:"relative"},!n.disablePadding&&{paddingTop:8,paddingBottom:8},n.subheader&&{paddingTop:0})),p0e=ne.forwardRef(function(e,i){const a=ar({props:e,name:"MuiList"}),{children:s,className:l,component:d="ul",dense:f=!1,disablePadding:p=!1,subheader:y}=a,_=Wn(a,d0e),b=ne.useMemo(()=>({dense:f}),[f]),S=Ge({},a,{component:d,dense:f,disablePadding:p}),A=h0e(S);return U(o5.Provider,{value:b,children:_e(f0e,Ge({as:d,className:fi(A.root,l),ref:i,ownerState:S},_,{children:[y,s]}))})}),m0e=p0e,g0e=$i("MuiListItemIcon",["root","alignItemsFlexStart"]),pV=g0e,y0e=$i("MuiListItemText",["root","multiline","dense","inset","primary","secondary"]),mV=y0e,v0e=["actions","autoFocus","autoFocusItem","children","className","disabledItemsFocusable","disableListWrap","onKeyDown","variant"];function LR(n,e,i){return n===e?n.firstChild:e&&e.nextElementSibling?e.nextElementSibling:i?null:n.firstChild}function gV(n,e,i){return n===e?i?n.firstChild:n.lastChild:e&&e.previousElementSibling?e.previousElementSibling:i?null:n.lastChild}function sX(n,e){if(e===void 0)return!0;let i=n.innerText;return i===void 0&&(i=n.textContent),i=i.trim().toLowerCase(),i.length===0?!1:e.repeating?i[0]===e.keys[0]:i.indexOf(e.keys.join(""))===0}function yx(n,e,i,a,s,l){let d=!1,f=s(n,e,e?i:!1);for(;f;){if(f===n.firstChild){if(d)return!1;d=!0}const p=a?!1:f.disabled||f.getAttribute("aria-disabled")==="true";if(!f.hasAttribute("tabindex")||!sX(f,l)||p)f=s(n,f,i);else return f.focus(),!0}return!1}const _0e=ne.forwardRef(function(e,i){const{actions:a,autoFocus:s=!1,autoFocusItem:l=!1,children:d,className:f,disabledItemsFocusable:p=!1,disableListWrap:y=!1,onKeyDown:_,variant:b="selectedMenu"}=e,S=Wn(e,v0e),A=ne.useRef(null),P=ne.useRef({keys:[],repeating:!0,previousKeyMatched:!0,lastTime:null});bu(()=>{s&&A.current.focus()},[s]),ne.useImperativeHandle(a,()=>({adjustStyleForScrollbar:(O,F)=>{const H=!A.current.style.width;if(O.clientHeight<A.current.clientHeight&&H){const $=`${rq(Ms(O))}px`;A.current.style[F.direction==="rtl"?"paddingLeft":"paddingRight"]=$,A.current.style.width=`calc(100% + ${$})`}return A.current}}),[]);const L=O=>{const F=A.current,H=O.key,$=Ms(F).activeElement;if(H==="ArrowDown")O.preventDefault(),yx(F,$,y,p,LR);else if(H==="ArrowUp")O.preventDefault(),yx(F,$,y,p,gV);else if(H==="Home")O.preventDefault(),yx(F,null,y,p,LR);else if(H==="End")O.preventDefault(),yx(F,null,y,p,gV);else if(H.length===1){const Y=P.current,te=H.toLowerCase(),G=performance.now();Y.keys.length>0&&(G-Y.lastTime>500?(Y.keys=[],Y.repeating=!0,Y.previousKeyMatched=!0):Y.repeating&&te!==Y.keys[0]&&(Y.repeating=!1)),Y.lastTime=G,Y.keys.push(te);const Q=$&&!Y.repeating&&sX($,Y);Y.previousKeyMatched&&(Q||yx(F,$,!1,p,LR,Y))?O.preventDefault():Y.previousKeyMatched=!1}_&&_(O)},k=Mo(A,i);let R=-1;ne.Children.forEach(d,(O,F)=>{if(!ne.isValidElement(O)){R===F&&(R+=1,R>=d.length&&(R=-1));return}O.props.disabled||(b==="selectedMenu"&&O.props.selected||R===-1)&&(R=F),R===F&&(O.props.disabled||O.props.muiSkipListHighlight||O.type.muiSkipListHighlight)&&(R+=1,R>=d.length&&(R=-1))});const z=ne.Children.map(d,(O,F)=>{if(F===R){const H={};return l&&(H.autoFocus=!0),O.props.tabIndex===void 0&&b==="selectedMenu"&&(H.tabIndex=0),ne.cloneElement(O,H)}return O});return U(m0e,Ge({role:"menu",ref:k,className:f,onKeyDown:L,tabIndex:s?0:-1},S,{children:z}))}),x0e=_0e;function b0e(n){return Zi("MuiPopover",n)}$i("MuiPopover",["root","paper"]);const w0e=["onEntering"],S0e=["action","anchorEl","anchorOrigin","anchorPosition","anchorReference","children","className","container","elevation","marginThreshold","open","PaperProps","slots","slotProps","transformOrigin","TransitionComponent","transitionDuration","TransitionProps","disableScrollLock"],E0e=["slotProps"];function yV(n,e){let i=0;return typeof e=="number"?i=e:e==="center"?i=n.height/2:e==="bottom"&&(i=n.height),i}function vV(n,e){let i=0;return typeof e=="number"?i=e:e==="center"?i=n.width/2:e==="right"&&(i=n.width),i}function _V(n){return[n.horizontal,n.vertical].map(e=>typeof e=="number"?`${e}px`:e).join(" ")}function kR(n){return typeof n=="function"?n():n}const M0e=n=>{const{classes:e}=n;return er({root:["root"],paper:["paper"]},b0e,e)},T0e=Rn(tve,{name:"MuiPopover",slot:"Root",overridesResolver:(n,e)=>e.root})({}),lX=Rn(Oq,{name:"MuiPopover",slot:"Paper",overridesResolver:(n,e)=>e.paper})({position:"absolute",overflowY:"auto",overflowX:"hidden",minWidth:16,minHeight:16,maxWidth:"calc(100% - 32px)",maxHeight:"calc(100% - 32px)",outline:0}),A0e=ne.forwardRef(function(e,i){var a,s,l;const d=ar({props:e,name:"MuiPopover"}),{action:f,anchorEl:p,anchorOrigin:y={vertical:"top",horizontal:"left"},anchorPosition:_,anchorReference:b="anchorEl",children:S,className:A,container:P,elevation:L=8,marginThreshold:k=16,open:R,PaperProps:z={},slots:O,slotProps:F,transformOrigin:H={vertical:"top",horizontal:"left"},TransitionComponent:$=a5,transitionDuration:Y="auto",TransitionProps:{onEntering:te}={},disableScrollLock:G=!1}=d,Q=Wn(d.TransitionProps,w0e),he=Wn(d,S0e),pe=(a=F==null?void 0:F.paper)!=null?a:z,ye=ne.useRef(),fe=Mo(ye,pe.ref),Ae=Ge({},d,{anchorOrigin:y,anchorReference:b,elevation:L,marginThreshold:k,externalPaperSlotProps:pe,transformOrigin:H,TransitionComponent:$,transitionDuration:Y,TransitionProps:Q}),Re=M0e(Ae),Be=ne.useCallback(()=>{if(b==="anchorPosition")return _;const pt=kR(p),_t=(pt&&pt.nodeType===1?pt:Ms(ye.current).body).getBoundingClientRect();return{top:_t.top+yV(_t,y.vertical),left:_t.left+vV(_t,y.horizontal)}},[p,y.horizontal,y.vertical,_,b]),le=ne.useCallback(pt=>({vertical:yV(pt,H.vertical),horizontal:vV(pt,H.horizontal)}),[H.horizontal,H.vertical]),me=ne.useCallback(pt=>{const gt={width:pt.offsetWidth,height:pt.offsetHeight},_t=le(gt);if(b==="none")return{top:null,left:null,transformOrigin:_V(_t)};const Ue=Be();let ue=Ue.top-_t.vertical,se=Ue.left-_t.horizontal;const xe=ue+gt.height,Ye=se+gt.width,ze=Md(kR(p)),st=ze.innerHeight-k,de=ze.innerWidth-k;if(k!==null&&ue<k){const ie=ue-k;ue-=ie,_t.vertical+=ie}else if(k!==null&&xe>st){const ie=xe-st;ue-=ie,_t.vertical+=ie}if(k!==null&&se<k){const ie=se-k;se-=ie,_t.horizontal+=ie}else if(Ye>de){const ie=Ye-de;se-=ie,_t.horizontal+=ie}return{top:`${Math.round(ue)}px`,left:`${Math.round(se)}px`,transformOrigin:_V(_t)}},[p,b,Be,le,k]),[we,re]=ne.useState(R),Te=ne.useCallback(()=>{const pt=ye.current;if(!pt)return;const gt=me(pt);gt.top!==null&&(pt.style.top=gt.top),gt.left!==null&&(pt.style.left=gt.left),pt.style.transformOrigin=gt.transformOrigin,re(!0)},[me]);ne.useEffect(()=>(G&&window.addEventListener("scroll",Te),()=>window.removeEventListener("scroll",Te)),[p,G,Te]);const Je=(pt,gt)=>{te&&te(pt,gt),Te()},Xe=()=>{re(!1)};ne.useEffect(()=>{R&&Te()}),ne.useImperativeHandle(f,()=>R?{updatePosition:()=>{Te()}}:null,[R,Te]),ne.useEffect(()=>{if(!R)return;const pt=sA(()=>{Te()}),gt=Md(p);return gt.addEventListener("resize",pt),()=>{pt.clear(),gt.removeEventListener("resize",pt)}},[p,R,Te]);let Ze=Y;Y==="auto"&&!$.muiSupportAuto&&(Ze=void 0);const Fe=P||(p?Ms(kR(p)).body:void 0),ct=(s=O==null?void 0:O.root)!=null?s:T0e,At=(l=O==null?void 0:O.paper)!=null?l:lX,kt=Vg({elementType:At,externalSlotProps:Ge({},pe,{style:we?pe.style:Ge({},pe.style,{opacity:0})}),additionalProps:{elevation:L,ref:fe},ownerState:Ae,className:fi(Re.paper,pe==null?void 0:pe.className)}),Kt=Vg({elementType:ct,externalSlotProps:(F==null?void 0:F.root)||{},externalForwardedProps:he,additionalProps:{ref:i,slotProps:{backdrop:{invisible:!0}},container:Fe,open:R},ownerState:Ae,className:fi(Re.root,A)}),{slotProps:Et}=Kt,Ie=Wn(Kt,E0e);return U(ct,Ge({},Ie,!uT(ct)&&{slotProps:Et,disableScrollLock:G},{children:U($,Ge({appear:!0,in:R,onEntering:Je,onExited:Xe,timeout:Ze},Q,{children:U(At,Ge({},kt,{children:S}))}))}))}),C0e=A0e;function P0e(n){return Zi("MuiMenu",n)}$i("MuiMenu",["root","paper","list"]);const I0e=["onEntering"],R0e=["autoFocus","children","className","disableAutoFocusItem","MenuListProps","onClose","open","PaperProps","PopoverClasses","transitionDuration","TransitionProps","variant","slots","slotProps"],L0e={vertical:"top",horizontal:"right"},k0e={vertical:"top",horizontal:"left"},D0e=n=>{const{classes:e}=n;return er({root:["root"],paper:["paper"],list:["list"]},P0e,e)},z0e=Rn(C0e,{shouldForwardProp:n=>Pl(n)||n==="classes",name:"MuiMenu",slot:"Root",overridesResolver:(n,e)=>e.root})({}),O0e=Rn(lX,{name:"MuiMenu",slot:"Paper",overridesResolver:(n,e)=>e.paper})({maxHeight:"calc(100% - 96px)",WebkitOverflowScrolling:"touch"}),N0e=Rn(x0e,{name:"MuiMenu",slot:"List",overridesResolver:(n,e)=>e.list})({outline:0}),F0e=ne.forwardRef(function(e,i){var a,s;const l=ar({props:e,name:"MuiMenu"}),{autoFocus:d=!0,children:f,className:p,disableAutoFocusItem:y=!1,MenuListProps:_={},onClose:b,open:S,PaperProps:A={},PopoverClasses:P,transitionDuration:L="auto",TransitionProps:{onEntering:k}={},variant:R="selectedMenu",slots:z={},slotProps:O={}}=l,F=Wn(l.TransitionProps,I0e),H=Wn(l,R0e),$=zp(),Y=$.direction==="rtl",te=Ge({},l,{autoFocus:d,disableAutoFocusItem:y,MenuListProps:_,onEntering:k,PaperProps:A,transitionDuration:L,TransitionProps:F,variant:R}),G=D0e(te),Q=d&&!y&&S,he=ne.useRef(null),pe=(me,we)=>{he.current&&he.current.adjustStyleForScrollbar(me,$),k&&k(me,we)},ye=me=>{me.key==="Tab"&&(me.preventDefault(),b&&b(me,"tabKeyDown"))};let fe=-1;ne.Children.map(f,(me,we)=>{ne.isValidElement(me)&&(me.props.disabled||(R==="selectedMenu"&&me.props.selected||fe===-1)&&(fe=we))});const Ae=(a=z.paper)!=null?a:O0e,Re=(s=O.paper)!=null?s:A,Be=Vg({elementType:z.root,externalSlotProps:O.root,ownerState:te,className:[G.root,p]}),le=Vg({elementType:Ae,externalSlotProps:Re,ownerState:te,className:G.paper});return U(z0e,Ge({onClose:b,anchorOrigin:{vertical:"bottom",horizontal:Y?"right":"left"},transformOrigin:Y?L0e:k0e,slots:{paper:Ae,root:z.root},slotProps:{root:Be,paper:le},open:S,ref:i,transitionDuration:L,TransitionProps:Ge({onEntering:pe},F),ownerState:te},H,{classes:P,children:U(N0e,Ge({onKeyDown:ye,actions:he,autoFocus:d&&(fe===-1||y),autoFocusItem:Q,variant:R},_,{className:fi(G.list,_.className),children:f}))}))}),Hg=F0e;function B0e(n){return Zi("MuiMenuItem",n)}const U0e=$i("MuiMenuItem",["root","focusVisible","dense","disabled","divider","gutters","selected"]),vx=U0e,W0e=["autoFocus","component","dense","divider","disableGutters","focusVisibleClassName","role","tabIndex","className"],V0e=(n,e)=>{const{ownerState:i}=n;return[e.root,i.dense&&e.dense,i.divider&&e.divider,!i.disableGutters&&e.gutters]},G0e=n=>{const{disabled:e,dense:i,divider:a,disableGutters:s,selected:l,classes:d}=n,p=er({root:["root",i&&"dense",e&&"disabled",!s&&"gutters",a&&"divider",l&&"selected"]},B0e,d);return Ge({},d,p)},H0e=Rn(NA,{shouldForwardProp:n=>Pl(n)||n==="classes",name:"MuiMenuItem",slot:"Root",overridesResolver:V0e})(({theme:n,ownerState:e})=>Ge({},n.typography.body1,{display:"flex",justifyContent:"flex-start",alignItems:"center",position:"relative",textDecoration:"none",minHeight:48,paddingTop:6,paddingBottom:6,boxSizing:"border-box",whiteSpace:"nowrap"},!e.disableGutters&&{paddingLeft:16,paddingRight:16},e.divider&&{borderBottom:`1px solid ${(n.vars||n).palette.divider}`,backgroundClip:"padding-box"},{"&:hover":{textDecoration:"none",backgroundColor:(n.vars||n).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${vx.selected}`]:{backgroundColor:n.vars?`rgba(${n.vars.palette.primary.mainChannel} / ${n.vars.palette.action.selectedOpacity})`:Sa(n.palette.primary.main,n.palette.action.selectedOpacity),[`&.${vx.focusVisible}`]:{backgroundColor:n.vars?`rgba(${n.vars.palette.primary.mainChannel} / calc(${n.vars.palette.action.selectedOpacity} + ${n.vars.palette.action.focusOpacity}))`:Sa(n.palette.primary.main,n.palette.action.selectedOpacity+n.palette.action.focusOpacity)}},[`&.${vx.selected}:hover`]:{backgroundColor:n.vars?`rgba(${n.vars.palette.primary.mainChannel} / calc(${n.vars.palette.action.selectedOpacity} + ${n.vars.palette.action.hoverOpacity}))`:Sa(n.palette.primary.main,n.palette.action.selectedOpacity+n.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:n.vars?`rgba(${n.vars.palette.primary.mainChannel} / ${n.vars.palette.action.selectedOpacity})`:Sa(n.palette.primary.main,n.palette.action.selectedOpacity)}},[`&.${vx.focusVisible}`]:{backgroundColor:(n.vars||n).palette.action.focus},[`&.${vx.disabled}`]:{opacity:(n.vars||n).palette.action.disabledOpacity},[`& + .${uV.root}`]:{marginTop:n.spacing(1),marginBottom:n.spacing(1)},[`& + .${uV.inset}`]:{marginLeft:52},[`& .${mV.root}`]:{marginTop:0,marginBottom:0},[`& .${mV.inset}`]:{paddingLeft:36},[`& .${pV.root}`]:{minWidth:36}},!e.dense&&{[n.breakpoints.up("sm")]:{minHeight:"auto"}},e.dense&&Ge({minHeight:32,paddingTop:4,paddingBottom:4},n.typography.body2,{[`& .${pV.root} svg`]:{fontSize:"1.25rem"}}))),j0e=ne.forwardRef(function(e,i){const a=ar({props:e,name:"MuiMenuItem"}),{autoFocus:s=!1,component:l="li",dense:d=!1,divider:f=!1,disableGutters:p=!1,focusVisibleClassName:y,role:_="menuitem",tabIndex:b,className:S}=a,A=Wn(a,W0e),P=ne.useContext(o5),L=ne.useMemo(()=>({dense:d||P.dense||!1,disableGutters:p}),[P.dense,d,p]),k=ne.useRef(null);bu(()=>{s&&k.current&&k.current.focus()},[s]);const R=Ge({},a,{dense:L.dense,divider:f,disableGutters:p}),z=G0e(a),O=Mo(k,i);let F;return a.disabled||(F=b!==void 0?b:-1),U(o5.Provider,{value:L,children:U(H0e,Ge({ref:O,role:_,tabIndex:F,component:l,focusVisibleClassName:fi(z.focusVisible,y),className:fi(z.root,S)},A,{ownerState:R,classes:z}))})}),Tp=j0e;function $0e(n){return Zi("MuiNativeSelect",n)}const Y0e=$i("MuiNativeSelect",["root","select","multiple","filled","outlined","standard","disabled","icon","iconOpen","iconFilled","iconOutlined","iconStandard","nativeInput","error"]),nz=Y0e,q0e=["className","disabled","error","IconComponent","inputRef","variant"],X0e=n=>{const{classes:e,variant:i,disabled:a,multiple:s,open:l,error:d}=n,f={select:["select",i,a&&"disabled",s&&"multiple",d&&"error"],icon:["icon",`icon${ti(i)}`,l&&"iconOpen",a&&"disabled"]};return er(f,$0e,e)},cX=({ownerState:n,theme:e})=>Ge({MozAppearance:"none",WebkitAppearance:"none",userSelect:"none",borderRadius:0,cursor:"pointer","&:focus":Ge({},e.vars?{backgroundColor:`rgba(${e.vars.palette.common.onBackgroundChannel} / 0.05)`}:{backgroundColor:e.palette.mode==="light"?"rgba(0, 0, 0, 0.05)":"rgba(255, 255, 255, 0.05)"},{borderRadius:0}),"&::-ms-expand":{display:"none"},[`&.${nz.disabled}`]:{cursor:"default"},"&[multiple]":{height:"auto"},"&:not([multiple]) option, &:not([multiple]) optgroup":{backgroundColor:(e.vars||e).palette.background.paper},"&&&":{paddingRight:24,minWidth:16}},n.variant==="filled"&&{"&&&":{paddingRight:32}},n.variant==="outlined"&&{borderRadius:(e.vars||e).shape.borderRadius,"&:focus":{borderRadius:(e.vars||e).shape.borderRadius},"&&&":{paddingRight:32}}),Z0e=Rn("select",{name:"MuiNativeSelect",slot:"Select",shouldForwardProp:Pl,overridesResolver:(n,e)=>{const{ownerState:i}=n;return[e.select,e[i.variant],i.error&&e.error,{[`&.${nz.multiple}`]:e.multiple}]}})(cX),uX=({ownerState:n,theme:e})=>Ge({position:"absolute",right:0,top:"calc(50% - .5em)",pointerEvents:"none",color:(e.vars||e).palette.action.active,[`&.${nz.disabled}`]:{color:(e.vars||e).palette.action.disabled}},n.open&&{transform:"rotate(180deg)"},n.variant==="filled"&&{right:7},n.variant==="outlined"&&{right:7}),K0e=Rn("svg",{name:"MuiNativeSelect",slot:"Icon",overridesResolver:(n,e)=>{const{ownerState:i}=n;return[e.icon,i.variant&&e[`icon${ti(i.variant)}`],i.open&&e.iconOpen]}})(uX),J0e=ne.forwardRef(function(e,i){const{className:a,disabled:s,error:l,IconComponent:d,inputRef:f,variant:p="standard"}=e,y=Wn(e,q0e),_=Ge({},e,{disabled:s,variant:p,error:l}),b=X0e(_);return _e(ne.Fragment,{children:[U(Z0e,Ge({ownerState:_,className:fi(b.select,a),disabled:s,ref:f||i},y)),e.multiple?null:U(K0e,{as:d,ownerState:_,className:b.icon})]})}),Q0e=J0e;var xV;const e_e=["children","classes","className","label","notched"],t_e=Rn("fieldset",{shouldForwardProp:Pl})({textAlign:"left",position:"absolute",bottom:0,right:0,top:-5,left:0,margin:0,padding:"0 8px",pointerEvents:"none",borderRadius:"inherit",borderStyle:"solid",borderWidth:1,overflow:"hidden",minWidth:"0%"}),n_e=Rn("legend",{shouldForwardProp:Pl})(({ownerState:n,theme:e})=>Ge({float:"unset",width:"auto",overflow:"hidden"},!n.withLabel&&{padding:0,lineHeight:"11px",transition:e.transitions.create("width",{duration:150,easing:e.transitions.easing.easeOut})},n.withLabel&&Ge({display:"block",padding:0,height:11,fontSize:"0.75em",visibility:"hidden",maxWidth:.01,transition:e.transitions.create("max-width",{duration:50,easing:e.transitions.easing.easeOut}),whiteSpace:"nowrap","& > span":{paddingLeft:5,paddingRight:5,display:"inline-block",opacity:0,visibility:"visible"}},n.notched&&{maxWidth:"100%",transition:e.transitions.create("max-width",{duration:100,easing:e.transitions.easing.easeOut,delay:50})})));function i_e(n){const{className:e,label:i,notched:a}=n,s=Wn(n,e_e),l=i!=null&&i!=="",d=Ge({},n,{notched:a,withLabel:l});return U(t_e,Ge({"aria-hidden":!0,className:e,ownerState:d},s,{children:U(n_e,{ownerState:d,children:l?U("span",{children:i}):xV||(xV=U("span",{className:"notranslate",children:""}))})}))}const r_e=["components","fullWidth","inputComponent","label","multiline","notched","slots","type"],a_e=n=>{const{classes:e}=n,a=er({root:["root"],notchedOutline:["notchedOutline"],input:["input"]},rye,e);return Ge({},e,a)},o_e=Rn(WA,{shouldForwardProp:n=>Pl(n)||n==="classes",name:"MuiOutlinedInput",slot:"Root",overridesResolver:BA})(({theme:n,ownerState:e})=>{const i=n.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)";return Ge({position:"relative",borderRadius:(n.vars||n).shape.borderRadius,[`&:hover .${Vf.notchedOutline}`]:{borderColor:(n.vars||n).palette.text.primary},"@media (hover: none)":{[`&:hover .${Vf.notchedOutline}`]:{borderColor:n.vars?`rgba(${n.vars.palette.common.onBackgroundChannel} / 0.23)`:i}},[`&.${Vf.focused} .${Vf.notchedOutline}`]:{borderColor:(n.vars||n).palette[e.color].main,borderWidth:2},[`&.${Vf.error} .${Vf.notchedOutline}`]:{borderColor:(n.vars||n).palette.error.main},[`&.${Vf.disabled} .${Vf.notchedOutline}`]:{borderColor:(n.vars||n).palette.action.disabled}},e.startAdornment&&{paddingLeft:14},e.endAdornment&&{paddingRight:14},e.multiline&&Ge({padding:"16.5px 14px"},e.size==="small"&&{padding:"8.5px 14px"}))}),s_e=Rn(i_e,{name:"MuiOutlinedInput",slot:"NotchedOutline",overridesResolver:(n,e)=>e.notchedOutline})(({theme:n})=>{const e=n.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)";return{borderColor:n.vars?`rgba(${n.vars.palette.common.onBackgroundChannel} / 0.23)`:e}}),l_e=Rn(VA,{name:"MuiOutlinedInput",slot:"Input",overridesResolver:UA})(({theme:n,ownerState:e})=>Ge({padding:"16.5px 14px"},!n.vars&&{"&:-webkit-autofill":{WebkitBoxShadow:n.palette.mode==="light"?null:"0 0 0 100px #266798 inset",WebkitTextFillColor:n.palette.mode==="light"?null:"#fff",caretColor:n.palette.mode==="light"?null:"#fff",borderRadius:"inherit"}},n.vars&&{"&:-webkit-autofill":{borderRadius:"inherit"},[n.getColorSchemeSelector("dark")]:{"&:-webkit-autofill":{WebkitBoxShadow:"0 0 0 100px #266798 inset",WebkitTextFillColor:"#fff",caretColor:"#fff"}}},e.size==="small"&&{padding:"8.5px 14px"},e.multiline&&{padding:0},e.startAdornment&&{paddingLeft:0},e.endAdornment&&{paddingRight:0})),dX=ne.forwardRef(function(e,i){var a,s,l,d,f;const p=ar({props:e,name:"MuiOutlinedInput"}),{components:y={},fullWidth:_=!1,inputComponent:b="input",label:S,multiline:A=!1,notched:P,slots:L={},type:k="text"}=p,R=Wn(p,r_e),z=a_e(p),O=ny(),F=I_({props:p,muiFormControl:O,states:["color","disabled","error","focused","hiddenLabel","size","required"]}),H=Ge({},p,{color:F.color||"primary",disabled:F.disabled,error:F.error,focused:F.focused,formControl:O,fullWidth:_,hiddenLabel:F.hiddenLabel,multiline:A,size:F.size,type:k}),$=(a=(s=L.root)!=null?s:y.Root)!=null?a:o_e,Y=(l=(d=L.input)!=null?d:y.Input)!=null?l:l_e;return U(GA,Ge({slots:{root:$,input:Y},renderSuffix:te=>U(s_e,{ownerState:H,className:z.notchedOutline,label:S!=null&&S!==""&&F.required?f||(f=_e(ne.Fragment,{children:[S,"","*"]})):S,notched:typeof P<"u"?P:!!(te.startAdornment||te.filled||te.focused)}),fullWidth:_,inputComponent:b,multiline:A,ref:i,type:k},R,{classes:Ge({},z,{notchedOutline:null})}))});dX.muiName="Input";const hX=dX;function c_e(n){return Zi("MuiSelect",n)}const u_e=$i("MuiSelect",["root","select","multiple","filled","outlined","standard","disabled","focused","icon","iconOpen","iconFilled","iconOutlined","iconStandard","nativeInput","error"]),_x=u_e;var bV;const d_e=["aria-describedby","aria-label","autoFocus","autoWidth","children","className","defaultOpen","defaultValue","disabled","displayEmpty","error","IconComponent","inputRef","labelId","MenuProps","multiple","name","onBlur","onChange","onClose","onFocus","onOpen","open","readOnly","renderValue","SelectDisplayProps","tabIndex","type","value","variant"],h_e=Rn("div",{name:"MuiSelect",slot:"Select",overridesResolver:(n,e)=>{const{ownerState:i}=n;return[{[`&.${_x.select}`]:e.select},{[`&.${_x.select}`]:e[i.variant]},{[`&.${_x.error}`]:e.error},{[`&.${_x.multiple}`]:e.multiple}]}})(cX,{[`&.${_x.select}`]:{height:"auto",minHeight:"1.4375em",textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"}}),f_e=Rn("svg",{name:"MuiSelect",slot:"Icon",overridesResolver:(n,e)=>{const{ownerState:i}=n;return[e.icon,i.variant&&e[`icon${ti(i.variant)}`],i.open&&e.iconOpen]}})(uX),p_e=Rn("input",{shouldForwardProp:n=>cpe(n)&&n!=="classes",name:"MuiSelect",slot:"NativeInput",overridesResolver:(n,e)=>e.nativeInput})({bottom:0,left:0,position:"absolute",opacity:0,pointerEvents:"none",width:"100%",boxSizing:"border-box"});function wV(n,e){return typeof e=="object"&&e!==null?n===e:String(n)===String(e)}function m_e(n){return n==null||typeof n=="string"&&!n.trim()}const g_e=n=>{const{classes:e,variant:i,disabled:a,multiple:s,open:l,error:d}=n,f={select:["select",i,a&&"disabled",s&&"multiple",d&&"error"],icon:["icon",`icon${ti(i)}`,l&&"iconOpen",a&&"disabled"],nativeInput:["nativeInput"]};return er(f,c_e,e)},y_e=ne.forwardRef(function(e,i){var a;const{"aria-describedby":s,"aria-label":l,autoFocus:d,autoWidth:f,children:p,className:y,defaultOpen:_,defaultValue:b,disabled:S,displayEmpty:A,error:P=!1,IconComponent:L,inputRef:k,labelId:R,MenuProps:z={},multiple:O,name:F,onBlur:H,onChange:$,onClose:Y,onFocus:te,onOpen:G,open:Q,readOnly:he,renderValue:pe,SelectDisplayProps:ye={},tabIndex:fe,value:Ae,variant:Re="standard"}=e,Be=Wn(e,d_e),[le,me]=ew({controlled:Ae,default:b,name:"Select"}),[we,re]=ew({controlled:Q,default:_,name:"Select"}),Te=ne.useRef(null),Je=ne.useRef(null),[Xe,Ze]=ne.useState(null),{current:Fe}=ne.useRef(Q!=null),[ct,At]=ne.useState(),kt=Mo(i,k),Kt=ne.useCallback(Dt=>{Je.current=Dt,Dt&&Ze(Dt)},[]),Et=Xe==null?void 0:Xe.parentNode;ne.useImperativeHandle(kt,()=>({focus:()=>{Je.current.focus()},node:Te.current,value:le}),[le]),ne.useEffect(()=>{_&&we&&Xe&&!Fe&&(At(f?null:Et.clientWidth),Je.current.focus())},[Xe,f]),ne.useEffect(()=>{d&&Je.current.focus()},[d]),ne.useEffect(()=>{if(!R)return;const Dt=Ms(Je.current).getElementById(R);if(Dt){const wt=()=>{getSelection().isCollapsed&&Je.current.focus()};return Dt.addEventListener("click",wt),()=>{Dt.removeEventListener("click",wt)}}},[R]);const Ie=(Dt,wt)=>{Dt?G&&G(wt):Y&&Y(wt),Fe||(At(f?null:Et.clientWidth),re(Dt))},pt=Dt=>{Dt.button===0&&(Dt.preventDefault(),Je.current.focus(),Ie(!0,Dt))},gt=Dt=>{Ie(!1,Dt)},_t=ne.Children.toArray(p),Ue=Dt=>{const wt=_t.find(Xt=>Xt.props.value===Dt.target.value);wt!==void 0&&(me(wt.props.value),$&&$(Dt,wt))},ue=Dt=>wt=>{let Xt;if(wt.currentTarget.hasAttribute("tabindex")){if(O){Xt=Array.isArray(le)?le.slice():[];const $e=le.indexOf(Dt.props.value);$e===-1?Xt.push(Dt.props.value):Xt.splice($e,1)}else Xt=Dt.props.value;if(Dt.props.onClick&&Dt.props.onClick(wt),le!==Xt&&(me(Xt),$)){const $e=wt.nativeEvent||wt,Pt=new $e.constructor($e.type,$e);Object.defineProperty(Pt,"target",{writable:!0,value:{value:Xt,name:F}}),$(Pt,Dt)}O||Ie(!1,wt)}},se=Dt=>{he||[" ","ArrowUp","ArrowDown","Enter"].indexOf(Dt.key)!==-1&&(Dt.preventDefault(),Ie(!0,Dt))},xe=Xe!==null&&we,Ye=Dt=>{!xe&&H&&(Object.defineProperty(Dt,"target",{writable:!0,value:{value:le,name:F}}),H(Dt))};delete Be["aria-invalid"];let ze,st;const de=[];let ie=!1;(hT({value:le})||A)&&(pe?ze=pe(le):ie=!0);const Oe=_t.map(Dt=>{if(!ne.isValidElement(Dt))return null;let wt;if(O){if(!Array.isArray(le))throw new Error(Mp(2));wt=le.some(Xt=>wV(Xt,Dt.props.value)),wt&&ie&&de.push(Dt.props.children)}else wt=wV(le,Dt.props.value),wt&&ie&&(st=Dt.props.children);return ne.cloneElement(Dt,{"aria-selected":wt?"true":"false",onClick:ue(Dt),onKeyUp:Xt=>{Xt.key===" "&&Xt.preventDefault(),Dt.props.onKeyUp&&Dt.props.onKeyUp(Xt)},role:"option",selected:wt,value:void 0,"data-value":Dt.props.value})});ie&&(O?de.length===0?ze=null:ze=de.reduce((Dt,wt,Xt)=>(Dt.push(wt),Xt<de.length-1&&Dt.push(", "),Dt),[]):ze=st);let ut=ct;!f&&Fe&&Xe&&(ut=Et.clientWidth);let it;typeof fe<"u"?it=fe:it=S?null:0;const lt=ye.id||(F?`mui-component-select-${F}`:void 0),Mt=Ge({},e,{variant:Re,value:le,open:xe,error:P}),Ut=g_e(Mt),Wt=Ge({},z.PaperProps,(a=z.slotProps)==null?void 0:a.paper),Ht=lA();return _e(ne.Fragment,{children:[U(h_e,Ge({ref:Kt,tabIndex:it,role:"combobox","aria-controls":Ht,"aria-disabled":S?"true":void 0,"aria-expanded":xe?"true":"false","aria-haspopup":"listbox","aria-label":l,"aria-labelledby":[R,lt].filter(Boolean).join(" ")||void 0,"aria-describedby":s,onKeyDown:se,onMouseDown:S||he?null:pt,onBlur:Ye,onFocus:te},ye,{ownerState:Mt,className:fi(ye.className,Ut.select,y),id:lt,children:m_e(ze)?bV||(bV=U("span",{className:"notranslate",children:""})):ze})),U(p_e,Ge({"aria-invalid":P,value:Array.isArray(le)?le.join(","):le,name:F,ref:Te,"aria-hidden":!0,onChange:Ue,tabIndex:-1,disabled:S,className:Ut.nativeInput,autoFocus:d,ownerState:Mt},Be)),U(f_e,{as:L,className:Ut.icon,ownerState:Mt}),U(Hg,Ge({id:`menu-${F||""}`,anchorEl:Et,open:xe,onClose:gt,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"}},z,{MenuListProps:Ge({"aria-labelledby":R,role:"listbox","aria-multiselectable":O?"true":void 0,disableListWrap:!0,id:Ht},z.MenuListProps),slotProps:Ge({},z.slotProps,{paper:Ge({},Wt,{style:Ge({minWidth:ut},Wt!=null?Wt.style:null)})}),children:Oe}))]})}),v_e=y_e,__e=["autoWidth","children","classes","className","defaultOpen","displayEmpty","IconComponent","id","input","inputProps","label","labelId","MenuProps","multiple","native","onClose","onOpen","open","renderValue","SelectDisplayProps","variant"],x_e=["root"],b_e=n=>{const{classes:e}=n;return e},iz={name:"MuiSelect",overridesResolver:(n,e)=>e.root,shouldForwardProp:n=>Pl(n)&&n!=="variant",slot:"Root"},w_e=Rn(aX,iz)(""),S_e=Rn(hX,iz)(""),E_e=Rn(eX,iz)(""),fX=ne.forwardRef(function(e,i){const a=ar({name:"MuiSelect",props:e}),{autoWidth:s=!1,children:l,classes:d={},className:f,defaultOpen:p=!1,displayEmpty:y=!1,IconComponent:_=lye,id:b,input:S,inputProps:A,label:P,labelId:L,MenuProps:k,multiple:R=!1,native:z=!1,onClose:O,onOpen:F,open:H,renderValue:$,SelectDisplayProps:Y,variant:te="outlined"}=a,G=Wn(a,__e),Q=z?Q0e:v_e,he=ny(),pe=I_({props:a,muiFormControl:he,states:["variant","error"]}),ye=pe.variant||te,fe=Ge({},a,{variant:ye,classes:d}),Ae=b_e(fe),Re=Wn(Ae,x_e),Be=S||{standard:U(w_e,{ownerState:fe}),outlined:U(S_e,{label:P,ownerState:fe}),filled:U(E_e,{ownerState:fe})}[ye],le=Mo(i,Be.ref);return U(ne.Fragment,{children:ne.cloneElement(Be,Ge({inputComponent:Q,inputProps:Ge({children:l,error:pe.error,IconComponent:_,variant:ye,type:void 0,multiple:R},z?{id:b}:{autoWidth:s,defaultOpen:p,displayEmpty:y,labelId:L,MenuProps:k,onClose:O,onOpen:F,open:H,renderValue:$,SelectDisplayProps:Ge({id:b},Y)},A,{classes:A?Ml(Re,A.classes):Re},S?S.props.inputProps:{})},R&&z&&ye==="outlined"?{notched:!0}:{},{ref:le,className:fi(Be.props.className,f,Ae.root)},!S&&{variant:ye},G))})});fX.muiName="Select";const pX=fX;function M_e(n){return Zi("MuiTooltip",n)}const T_e=$i("MuiTooltip",["popper","popperInteractive","popperArrow","popperClose","tooltip","tooltipArrow","touch","tooltipPlacementLeft","tooltipPlacementRight","tooltipPlacementTop","tooltipPlacementBottom","arrow"]),pd=T_e,A_e=["arrow","children","classes","components","componentsProps","describeChild","disableFocusListener","disableHoverListener","disableInteractive","disableTouchListener","enterDelay","enterNextDelay","enterTouchDelay","followCursor","id","leaveDelay","leaveTouchDelay","onClose","onOpen","open","placement","PopperComponent","PopperProps","slotProps","slots","title","TransitionComponent","TransitionProps"];function C_e(n){return Math.round(n*1e5)/1e5}const P_e=n=>{const{classes:e,disableInteractive:i,arrow:a,touch:s,placement:l}=n,d={popper:["popper",!i&&"popperInteractive",a&&"popperArrow"],tooltip:["tooltip",a&&"tooltipArrow",s&&"touch",`tooltipPlacement${ti(l.split("-")[0])}`],arrow:["arrow"]};return er(d,M_e,e)},I_e=Rn(qq,{name:"MuiTooltip",slot:"Popper",overridesResolver:(n,e)=>{const{ownerState:i}=n;return[e.popper,!i.disableInteractive&&e.popperInteractive,i.arrow&&e.popperArrow,!i.open&&e.popperClose]}})(({theme:n,ownerState:e,open:i})=>Ge({zIndex:(n.vars||n).zIndex.tooltip,pointerEvents:"none"},!e.disableInteractive&&{pointerEvents:"auto"},!i&&{pointerEvents:"none"},e.arrow&&{[`&[data-popper-placement*="bottom"] .${pd.arrow}`]:{top:0,marginTop:"-0.71em","&::before":{transformOrigin:"0 100%"}},[`&[data-popper-placement*="top"] .${pd.arrow}`]:{bottom:0,marginBottom:"-0.71em","&::before":{transformOrigin:"100% 0"}},[`&[data-popper-placement*="right"] .${pd.arrow}`]:Ge({},e.isRtl?{right:0,marginRight:"-0.71em"}:{left:0,marginLeft:"-0.71em"},{height:"1em",width:"0.71em","&::before":{transformOrigin:"100% 100%"}}),[`&[data-popper-placement*="left"] .${pd.arrow}`]:Ge({},e.isRtl?{left:0,marginLeft:"-0.71em"}:{right:0,marginRight:"-0.71em"},{height:"1em",width:"0.71em","&::before":{transformOrigin:"0 0"}})})),R_e=Rn("div",{name:"MuiTooltip",slot:"Tooltip",overridesResolver:(n,e)=>{const{ownerState:i}=n;return[e.tooltip,i.touch&&e.touch,i.arrow&&e.tooltipArrow,e[`tooltipPlacement${ti(i.placement.split("-")[0])}`]]}})(({theme:n,ownerState:e})=>Ge({backgroundColor:n.vars?n.vars.palette.Tooltip.bg:Sa(n.palette.grey[700],.92),borderRadius:(n.vars||n).shape.borderRadius,color:(n.vars||n).palette.common.white,fontFamily:n.typography.fontFamily,padding:"4px 8px",fontSize:n.typography.pxToRem(11),maxWidth:300,margin:2,wordWrap:"break-word",fontWeight:n.typography.fontWeightMedium},e.arrow&&{position:"relative",margin:0},e.touch&&{padding:"8px 16px",fontSize:n.typography.pxToRem(14),lineHeight:`${C_e(16/14)}em`,fontWeight:n.typography.fontWeightRegular},{[`.${pd.popper}[data-popper-placement*="left"] &`]:Ge({transformOrigin:"right center"},e.isRtl?Ge({marginLeft:"14px"},e.touch&&{marginLeft:"24px"}):Ge({marginRight:"14px"},e.touch&&{marginRight:"24px"})),[`.${pd.popper}[data-popper-placement*="right"] &`]:Ge({transformOrigin:"left center"},e.isRtl?Ge({marginRight:"14px"},e.touch&&{marginRight:"24px"}):Ge({marginLeft:"14px"},e.touch&&{marginLeft:"24px"})),[`.${pd.popper}[data-popper-placement*="top"] &`]:Ge({transformOrigin:"center bottom",marginBottom:"14px"},e.touch&&{marginBottom:"24px"}),[`.${pd.popper}[data-popper-placement*="bottom"] &`]:Ge({transformOrigin:"center top",marginTop:"14px"},e.touch&&{marginTop:"24px"})})),L_e=Rn("span",{name:"MuiTooltip",slot:"Arrow",overridesResolver:(n,e)=>e.arrow})(({theme:n})=>({overflow:"hidden",position:"absolute",width:"1em",height:"0.71em",boxSizing:"border-box",color:n.vars?n.vars.palette.Tooltip.bg:Sa(n.palette.grey[700],.9),"&::before":{content:'""',margin:"auto",display:"block",width:"100%",height:"100%",backgroundColor:"currentColor",transform:"rotate(45deg)"}}));let P3=!1,DR=null,xx={x:0,y:0};function I3(n,e){return i=>{e&&e(i),n(i)}}const k_e=ne.forwardRef(function(e,i){var a,s,l,d,f,p,y,_,b,S,A,P,L,k,R,z,O,F,H;const $=ar({props:e,name:"MuiTooltip"}),{arrow:Y=!1,children:te,components:G={},componentsProps:Q={},describeChild:he=!1,disableFocusListener:pe=!1,disableHoverListener:ye=!1,disableInteractive:fe=!1,disableTouchListener:Ae=!1,enterDelay:Re=100,enterNextDelay:Be=0,enterTouchDelay:le=700,followCursor:me=!1,id:we,leaveDelay:re=0,leaveTouchDelay:Te=1500,onClose:Je,onOpen:Xe,open:Ze,placement:Fe="bottom",PopperComponent:ct,PopperProps:At={},slotProps:kt={},slots:Kt={},title:Et,TransitionComponent:Ie=a5,TransitionProps:pt}=$,gt=Wn($,A_e),_t=ne.isValidElement(te)?te:U("span",{children:te}),Ue=zp(),ue=Ue.direction==="rtl",[se,xe]=ne.useState(),[Ye,ze]=ne.useState(null),st=ne.useRef(!1),de=fe||me,ie=ne.useRef(),Oe=ne.useRef(),ut=ne.useRef(),it=ne.useRef(),[lt,Mt]=ew({controlled:Ze,default:!1,name:"Tooltip",state:"open"});let Ut=lt;const Wt=lA(we),Ht=ne.useRef(),Dt=ne.useCallback(()=>{Ht.current!==void 0&&(document.body.style.WebkitUserSelect=Ht.current,Ht.current=void 0),clearTimeout(it.current)},[]);ne.useEffect(()=>()=>{clearTimeout(ie.current),clearTimeout(Oe.current),clearTimeout(ut.current),Dt()},[Dt]);const wt=jt=>{clearTimeout(DR),P3=!0,Mt(!0),Xe&&!Ut&&Xe(jt)},Xt=rp(jt=>{clearTimeout(DR),DR=setTimeout(()=>{P3=!1},800+re),Mt(!1),Je&&Ut&&Je(jt),clearTimeout(ie.current),ie.current=setTimeout(()=>{st.current=!1},Ue.transitions.duration.shortest)}),$e=jt=>{st.current&&jt.type!=="touchstart"||(se&&se.removeAttribute("title"),clearTimeout(Oe.current),clearTimeout(ut.current),Re||P3&&Be?Oe.current=setTimeout(()=>{wt(jt)},P3?Be:Re):wt(jt))},Pt=jt=>{clearTimeout(Oe.current),clearTimeout(ut.current),ut.current=setTimeout(()=>{Xt(jt)},re)},{isFocusVisibleRef:qt,onBlur:Ot,onFocus:fn,ref:be}=x4(),[,Qe]=ne.useState(!1),Se=jt=>{Ot(jt),qt.current===!1&&(Qe(!1),Pt(jt))},Ce=jt=>{se||xe(jt.currentTarget),fn(jt),qt.current===!0&&(Qe(!0),$e(jt))},Ne=jt=>{st.current=!0;const yn=_t.props;yn.onTouchStart&&yn.onTouchStart(jt)},et=$e,tt=Pt,vt=jt=>{Ne(jt),clearTimeout(ut.current),clearTimeout(ie.current),Dt(),Ht.current=document.body.style.WebkitUserSelect,document.body.style.WebkitUserSelect="none",it.current=setTimeout(()=>{document.body.style.WebkitUserSelect=Ht.current,$e(jt)},le)},ht=jt=>{_t.props.onTouchEnd&&_t.props.onTouchEnd(jt),Dt(),clearTimeout(ut.current),ut.current=setTimeout(()=>{Xt(jt)},Te)};ne.useEffect(()=>{if(!Ut)return;function jt(yn){(yn.key==="Escape"||yn.key==="Esc")&&Xt(yn)}return document.addEventListener("keydown",jt),()=>{document.removeEventListener("keydown",jt)}},[Xt,Ut]);const dt=Mo(_t.ref,be,xe,i);!Et&&Et!==0&&(Ut=!1);const Vt=ne.useRef(),It=jt=>{const yn=_t.props;yn.onMouseMove&&yn.onMouseMove(jt),xx={x:jt.clientX,y:jt.clientY},Vt.current&&Vt.current.update()},Qt={},mn=typeof Et=="string";he?(Qt.title=!Ut&&mn&&!ye?Et:null,Qt["aria-describedby"]=Ut?Wt:null):(Qt["aria-label"]=mn?Et:null,Qt["aria-labelledby"]=Ut&&!mn?Wt:null);const en=Ge({},Qt,gt,_t.props,{className:fi(gt.className,_t.props.className),onTouchStart:Ne,ref:dt},me?{onMouseMove:It}:{}),_n={};Ae||(en.onTouchStart=vt,en.onTouchEnd=ht),ye||(en.onMouseOver=I3(et,en.onMouseOver),en.onMouseLeave=I3(tt,en.onMouseLeave),de||(_n.onMouseOver=et,_n.onMouseLeave=tt)),pe||(en.onFocus=I3(Ce,en.onFocus),en.onBlur=I3(Se,en.onBlur),de||(_n.onFocus=Ce,_n.onBlur=Se));const Hn=ne.useMemo(()=>{var jt;let yn=[{name:"arrow",enabled:!!Ye,options:{element:Ye,padding:4}}];return(jt=At.popperOptions)!=null&&jt.modifiers&&(yn=yn.concat(At.popperOptions.modifiers)),Ge({},At.popperOptions,{modifiers:yn})},[Ye,At]),ni=Ge({},$,{isRtl:ue,arrow:Y,disableInteractive:de,placement:Fe,PopperComponentProp:ct,touch:st.current}),Ei=P_e(ni),Mi=(a=(s=Kt.popper)!=null?s:G.Popper)!=null?a:I_e,gr=(l=(d=(f=Kt.transition)!=null?f:G.Transition)!=null?d:Ie)!=null?l:a5,sr=(p=(y=Kt.tooltip)!=null?y:G.Tooltip)!=null?p:R_e,ke=(_=(b=Kt.arrow)!=null?b:G.Arrow)!=null?_:L_e,xt=$x(Mi,Ge({},At,(S=kt.popper)!=null?S:Q.popper,{className:fi(Ei.popper,At==null?void 0:At.className,(A=(P=kt.popper)!=null?P:Q.popper)==null?void 0:A.className)}),ni),zt=$x(gr,Ge({},pt,(L=kt.transition)!=null?L:Q.transition),ni),Rt=$x(sr,Ge({},(k=kt.tooltip)!=null?k:Q.tooltip,{className:fi(Ei.tooltip,(R=(z=kt.tooltip)!=null?z:Q.tooltip)==null?void 0:R.className)}),ni),Nt=$x(ke,Ge({},(O=kt.arrow)!=null?O:Q.arrow,{className:fi(Ei.arrow,(F=(H=kt.arrow)!=null?H:Q.arrow)==null?void 0:F.className)}),ni);return _e(ne.Fragment,{children:[ne.cloneElement(_t,en),U(Mi,Ge({as:ct??qq,placement:Fe,anchorEl:me?{getBoundingClientRect:()=>({top:xx.y,left:xx.x,right:xx.x,bottom:xx.y,width:0,height:0})}:se,popperRef:Vt,open:se?Ut:!1,id:Wt,transition:!0},_n,xt,{popperOptions:Hn,children:({TransitionProps:jt})=>U(gr,Ge({timeout:Ue.transitions.duration.shorter},jt,zt,{children:_e(sr,Ge({},Rt,{children:[Et,Y?U(ke,Ge({},Nt,{ref:ze})):null]}))}))}))]})}),mX=k_e;function D_e(n){return Zi("MuiSwitch",n)}const z_e=$i("MuiSwitch",["root","edgeStart","edgeEnd","switchBase","colorPrimary","colorSecondary","sizeSmall","sizeMedium","checked","disabled","input","thumb","track"]),js=z_e,O_e=["className","color","edge","size","sx"],N_e=n=>{const{classes:e,edge:i,size:a,color:s,checked:l,disabled:d}=n,f={root:["root",i&&`edge${ti(i)}`,`size${ti(a)}`],switchBase:["switchBase",`color${ti(s)}`,l&&"checked",d&&"disabled"],thumb:["thumb"],track:["track"],input:["input"]},p=er(f,D_e,e);return Ge({},e,p)},F_e=Rn("span",{name:"MuiSwitch",slot:"Root",overridesResolver:(n,e)=>{const{ownerState:i}=n;return[e.root,i.edge&&e[`edge${ti(i.edge)}`],e[`size${ti(i.size)}`]]}})(({ownerState:n})=>Ge({display:"inline-flex",width:34+12*2,height:14+12*2,overflow:"hidden",padding:12,boxSizing:"border-box",position:"relative",flexShrink:0,zIndex:0,verticalAlign:"middle","@media print":{colorAdjust:"exact"}},n.edge==="start"&&{marginLeft:-8},n.edge==="end"&&{marginRight:-8},n.size==="small"&&{width:40,height:24,padding:7,[`& .${js.thumb}`]:{width:16,height:16},[`& .${js.switchBase}`]:{padding:4,[`&.${js.checked}`]:{transform:"translateX(16px)"}}})),B_e=Rn(Zq,{name:"MuiSwitch",slot:"SwitchBase",overridesResolver:(n,e)=>{const{ownerState:i}=n;return[e.switchBase,{[`& .${js.input}`]:e.input},i.color!=="default"&&e[`color${ti(i.color)}`]]}})(({theme:n})=>({position:"absolute",top:0,left:0,zIndex:1,color:n.vars?n.vars.palette.Switch.defaultColor:`${n.palette.mode==="light"?n.palette.common.white:n.palette.grey[300]}`,transition:n.transitions.create(["left","transform"],{duration:n.transitions.duration.shortest}),[`&.${js.checked}`]:{transform:"translateX(20px)"},[`&.${js.disabled}`]:{color:n.vars?n.vars.palette.Switch.defaultDisabledColor:`${n.palette.mode==="light"?n.palette.grey[100]:n.palette.grey[600]}`},[`&.${js.checked} + .${js.track}`]:{opacity:.5},[`&.${js.disabled} + .${js.track}`]:{opacity:n.vars?n.vars.opacity.switchTrackDisabled:`${n.palette.mode==="light"?.12:.2}`},[`& .${js.input}`]:{left:"-100%",width:"300%"}}),({theme:n,ownerState:e})=>Ge({"&:hover":{backgroundColor:n.vars?`rgba(${n.vars.palette.action.activeChannel} / ${n.vars.palette.action.hoverOpacity})`:Sa(n.palette.action.active,n.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},e.color!=="default"&&{[`&.${js.checked}`]:{color:(n.vars||n).palette[e.color].main,"&:hover":{backgroundColor:n.vars?`rgba(${n.vars.palette[e.color].mainChannel} / ${n.vars.palette.action.hoverOpacity})`:Sa(n.palette[e.color].main,n.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${js.disabled}`]:{color:n.vars?n.vars.palette.Switch[`${e.color}DisabledColor`]:`${n.palette.mode==="light"?V4(n.palette[e.color].main,.62):W4(n.palette[e.color].main,.55)}`}},[`&.${js.checked} + .${js.track}`]:{backgroundColor:(n.vars||n).palette[e.color].main}})),U_e=Rn("span",{name:"MuiSwitch",slot:"Track",overridesResolver:(n,e)=>e.track})(({theme:n})=>({height:"100%",width:"100%",borderRadius:14/2,zIndex:-1,transition:n.transitions.create(["opacity","background-color"],{duration:n.transitions.duration.shortest}),backgroundColor:n.vars?n.vars.palette.common.onBackground:`${n.palette.mode==="light"?n.palette.common.black:n.palette.common.white}`,opacity:n.vars?n.vars.opacity.switchTrack:`${n.palette.mode==="light"?.38:.3}`})),W_e=Rn("span",{name:"MuiSwitch",slot:"Thumb",overridesResolver:(n,e)=>e.thumb})(({theme:n})=>({boxShadow:(n.vars||n).shadows[1],backgroundColor:"currentColor",width:20,height:20,borderRadius:"50%"})),V_e=ne.forwardRef(function(e,i){const a=ar({props:e,name:"MuiSwitch"}),{className:s,color:l="primary",edge:d=!1,size:f="medium",sx:p}=a,y=Wn(a,O_e),_=Ge({},a,{color:l,edge:d,size:f}),b=N_e(_),S=U(W_e,{className:b.thumb,ownerState:_});return _e(F_e,{className:fi(b.root,s),sx:p,ownerState:_,children:[U(B_e,Ge({type:"checkbox",icon:S,checkedIcon:S,ref:i,ownerState:_},y,{classes:Ge({},b,{root:b.switchBase})})),U(U_e,{className:b.track,ownerState:_})]})}),gX=V_e,G_e=ne.createContext(),yX=G_e;function H_e(n){return Zi("MuiTable",n)}$i("MuiTable",["root","stickyHeader"]);const j_e=["className","component","padding","size","stickyHeader"],$_e=n=>{const{classes:e,stickyHeader:i}=n;return er({root:["root",i&&"stickyHeader"]},H_e,e)},Y_e=Rn("table",{name:"MuiTable",slot:"Root",overridesResolver:(n,e)=>{const{ownerState:i}=n;return[e.root,i.stickyHeader&&e.stickyHeader]}})(({theme:n,ownerState:e})=>Ge({display:"table",width:"100%",borderCollapse:"collapse",borderSpacing:0,"& caption":Ge({},n.typography.body2,{padding:n.spacing(2),color:(n.vars||n).palette.text.secondary,textAlign:"left",captionSide:"bottom"})},e.stickyHeader&&{borderCollapse:"separate"})),SV="table",q_e=ne.forwardRef(function(e,i){const a=ar({props:e,name:"MuiTable"}),{className:s,component:l=SV,padding:d="normal",size:f="medium",stickyHeader:p=!1}=a,y=Wn(a,j_e),_=Ge({},a,{component:l,padding:d,size:f,stickyHeader:p}),b=$_e(_),S=ne.useMemo(()=>({padding:d,size:f,stickyHeader:p}),[d,f,p]);return U(yX.Provider,{value:S,children:U(Y_e,Ge({as:l,role:l===SV?null:"table",ref:i,className:fi(b.root,s),ownerState:_},y))})}),X_e=q_e,Z_e=ne.createContext(),HA=Z_e;function K_e(n){return Zi("MuiTableBody",n)}$i("MuiTableBody",["root"]);const J_e=["className","component"],Q_e=n=>{const{classes:e}=n;return er({root:["root"]},K_e,e)},e1e=Rn("tbody",{name:"MuiTableBody",slot:"Root",overridesResolver:(n,e)=>e.root})({display:"table-row-group"}),t1e={variant:"body"},EV="tbody",n1e=ne.forwardRef(function(e,i){const a=ar({props:e,name:"MuiTableBody"}),{className:s,component:l=EV}=a,d=Wn(a,J_e),f=Ge({},a,{component:l}),p=Q_e(f);return U(HA.Provider,{value:t1e,children:U(e1e,Ge({className:fi(p.root,s),as:l,ref:i,role:l===EV?null:"rowgroup",ownerState:f},d))})}),i1e=n1e;function r1e(n){return Zi("MuiTableCell",n)}const a1e=$i("MuiTableCell",["root","head","body","footer","sizeSmall","sizeMedium","paddingCheckbox","paddingNone","alignLeft","alignCenter","alignRight","alignJustify","stickyHeader"]),o1e=a1e,s1e=["align","className","component","padding","scope","size","sortDirection","variant"],l1e=n=>{const{classes:e,variant:i,align:a,padding:s,size:l,stickyHeader:d}=n,f={root:["root",i,d&&"stickyHeader",a!=="inherit"&&`align${ti(a)}`,s!=="normal"&&`padding${ti(s)}`,`size${ti(l)}`]};return er(f,r1e,e)},c1e=Rn("td",{name:"MuiTableCell",slot:"Root",overridesResolver:(n,e)=>{const{ownerState:i}=n;return[e.root,e[i.variant],e[`size${ti(i.size)}`],i.padding!=="normal"&&e[`padding${ti(i.padding)}`],i.align!=="inherit"&&e[`align${ti(i.align)}`],i.stickyHeader&&e.stickyHeader]}})(({theme:n,ownerState:e})=>Ge({},n.typography.body2,{display:"table-cell",verticalAlign:"inherit",borderBottom:n.vars?`1px solid ${n.vars.palette.TableCell.border}`:`1px solid
    ${n.palette.mode==="light"?V4(Sa(n.palette.divider,1),.88):W4(Sa(n.palette.divider,1),.68)}`,textAlign:"left",padding:16},e.variant==="head"&&{color:(n.vars||n).palette.text.primary,lineHeight:n.typography.pxToRem(24),fontWeight:n.typography.fontWeightMedium},e.variant==="body"&&{color:(n.vars||n).palette.text.primary},e.variant==="footer"&&{color:(n.vars||n).palette.text.secondary,lineHeight:n.typography.pxToRem(21),fontSize:n.typography.pxToRem(12)},e.size==="small"&&{padding:"6px 16px",[`&.${o1e.paddingCheckbox}`]:{width:24,padding:"0 12px 0 16px","& > *":{padding:0}}},e.padding==="checkbox"&&{width:48,padding:"0 0 0 4px"},e.padding==="none"&&{padding:0},e.align==="left"&&{textAlign:"left"},e.align==="center"&&{textAlign:"center"},e.align==="right"&&{textAlign:"right",flexDirection:"row-reverse"},e.align==="justify"&&{textAlign:"justify"},e.stickyHeader&&{position:"sticky",top:0,zIndex:2,backgroundColor:(n.vars||n).palette.background.default})),u1e=ne.forwardRef(function(e,i){const a=ar({props:e,name:"MuiTableCell"}),{align:s="inherit",className:l,component:d,padding:f,scope:p,size:y,sortDirection:_,variant:b}=a,S=Wn(a,s1e),A=ne.useContext(yX),P=ne.useContext(HA),L=P&&P.variant==="head";let k;d?k=d:k=L?"th":"td";let R=p;k==="td"?R=void 0:!R&&L&&(R="col");const z=b||P&&P.variant,O=Ge({},a,{align:s,component:k,padding:f||(A&&A.padding?A.padding:"normal"),size:y||(A&&A.size?A.size:"medium"),sortDirection:_,stickyHeader:z==="head"&&A&&A.stickyHeader,variant:z}),F=l1e(O);let H=null;return _&&(H=_==="asc"?"ascending":"descending"),U(c1e,Ge({as:k,ref:i,className:fi(F.root,l),"aria-sort":H,scope:R,ownerState:O},S))}),ys=u1e;function d1e(n){return Zi("MuiTableContainer",n)}$i("MuiTableContainer",["root"]);const h1e=["className","component"],f1e=n=>{const{classes:e}=n;return er({root:["root"]},d1e,e)},p1e=Rn("div",{name:"MuiTableContainer",slot:"Root",overridesResolver:(n,e)=>e.root})({width:"100%",overflowX:"auto"}),m1e=ne.forwardRef(function(e,i){const a=ar({props:e,name:"MuiTableContainer"}),{className:s,component:l="div"}=a,d=Wn(a,h1e),f=Ge({},a,{component:l}),p=f1e(f);return U(p1e,Ge({ref:i,as:l,className:fi(p.root,s),ownerState:f},d))}),g1e=m1e;function y1e(n){return Zi("MuiTableHead",n)}$i("MuiTableHead",["root"]);const v1e=["className","component"],_1e=n=>{const{classes:e}=n;return er({root:["root"]},y1e,e)},x1e=Rn("thead",{name:"MuiTableHead",slot:"Root",overridesResolver:(n,e)=>e.root})({display:"table-header-group"}),b1e={variant:"head"},MV="thead",w1e=ne.forwardRef(function(e,i){const a=ar({props:e,name:"MuiTableHead"}),{className:s,component:l=MV}=a,d=Wn(a,v1e),f=Ge({},a,{component:l}),p=_1e(f);return U(HA.Provider,{value:b1e,children:U(x1e,Ge({as:l,className:fi(p.root,s),ref:i,role:l===MV?null:"rowgroup",ownerState:f},d))})}),S1e=w1e;function E1e(n){return Zi("MuiTableRow",n)}const M1e=$i("MuiTableRow",["root","selected","hover","head","footer"]),TV=M1e,T1e=["className","component","hover","selected"],A1e=n=>{const{classes:e,selected:i,hover:a,head:s,footer:l}=n;return er({root:["root",i&&"selected",a&&"hover",s&&"head",l&&"footer"]},E1e,e)},C1e=Rn("tr",{name:"MuiTableRow",slot:"Root",overridesResolver:(n,e)=>{const{ownerState:i}=n;return[e.root,i.head&&e.head,i.footer&&e.footer]}})(({theme:n})=>({color:"inherit",display:"table-row",verticalAlign:"middle",outline:0,[`&.${TV.hover}:hover`]:{backgroundColor:(n.vars||n).palette.action.hover},[`&.${TV.selected}`]:{backgroundColor:n.vars?`rgba(${n.vars.palette.primary.mainChannel} / ${n.vars.palette.action.selectedOpacity})`:Sa(n.palette.primary.main,n.palette.action.selectedOpacity),"&:hover":{backgroundColor:n.vars?`rgba(${n.vars.palette.primary.mainChannel} / calc(${n.vars.palette.action.selectedOpacity} + ${n.vars.palette.action.hoverOpacity}))`:Sa(n.palette.primary.main,n.palette.action.selectedOpacity+n.palette.action.hoverOpacity)}}})),AV="tr",P1e=ne.forwardRef(function(e,i){const a=ar({props:e,name:"MuiTableRow"}),{className:s,component:l=AV,hover:d=!1,selected:f=!1}=a,p=Wn(a,T1e),y=ne.useContext(HA),_=Ge({},a,{component:l,hover:d,selected:f,head:y&&y.variant==="head",footer:y&&y.variant==="footer"}),b=A1e(_);return U(C1e,Ge({as:l,ref:i,className:fi(b.root,s),role:l===AV?null:"row",ownerState:_},p))}),CV=P1e;function I1e(n){return Zi("MuiTextField",n)}$i("MuiTextField",["root"]);const R1e=["autoComplete","autoFocus","children","className","color","defaultValue","disabled","error","FormHelperTextProps","fullWidth","helperText","id","InputLabelProps","inputProps","InputProps","inputRef","label","maxRows","minRows","multiline","name","onBlur","onChange","onFocus","placeholder","required","rows","select","SelectProps","type","value","variant"],L1e={standard:aX,filled:eX,outlined:hX},k1e=n=>{const{classes:e}=n;return er({root:["root"]},I1e,e)},D1e=Rn(tX,{name:"MuiTextField",slot:"Root",overridesResolver:(n,e)=>e.root})({}),z1e=ne.forwardRef(function(e,i){const a=ar({props:e,name:"MuiTextField"}),{autoComplete:s,autoFocus:l=!1,children:d,className:f,color:p="primary",defaultValue:y,disabled:_=!1,error:b=!1,FormHelperTextProps:S,fullWidth:A=!1,helperText:P,id:L,InputLabelProps:k,inputProps:R,InputProps:z,inputRef:O,label:F,maxRows:H,minRows:$,multiline:Y=!1,name:te,onBlur:G,onChange:Q,onFocus:he,placeholder:pe,required:ye=!1,rows:fe,select:Ae=!1,SelectProps:Re,type:Be,value:le,variant:me="outlined"}=a,we=Wn(a,R1e),re=Ge({},a,{autoFocus:l,color:p,disabled:_,error:b,fullWidth:A,multiline:Y,required:ye,select:Ae,variant:me}),Te=k1e(re),Je={};me==="outlined"&&(k&&typeof k.shrink<"u"&&(Je.notched=k.shrink),Je.label=F),Ae&&((!Re||!Re.native)&&(Je.id=void 0),Je["aria-describedby"]=void 0);const Xe=lA(L),Ze=P&&Xe?`${Xe}-helper-text`:void 0,Fe=F&&Xe?`${Xe}-label`:void 0,ct=L1e[me],At=U(ct,Ge({"aria-describedby":Ze,autoComplete:s,autoFocus:l,defaultValue:y,fullWidth:A,multiline:Y,name:te,rows:fe,maxRows:H,minRows:$,type:Be,value:le,id:Xe,inputRef:O,onBlur:G,onChange:Q,onFocus:he,placeholder:pe,inputProps:R},Je,z));return _e(D1e,Ge({className:fi(Te.root,f),disabled:_,error:b,fullWidth:A,ref:i,required:ye,color:p,variant:me,ownerState:re},we,{children:[F!=null&&F!==""&&U(oX,Ge({htmlFor:Xe,id:Fe},k,{children:F})),Ae?U(pX,Ge({"aria-describedby":Ze,id:Xe,labelId:Fe,value:le,input:At},Re,{children:d})):At,P&&U(Ave,Ge({id:Ze},S,{children:P}))]}))}),PV=z1e;function O1e(n){return Zi("MuiToggleButton",n)}const N1e=$i("MuiToggleButton",["root","disabled","selected","standard","primary","secondary","sizeSmall","sizeMedium","sizeLarge","fullWidth"]),IV=N1e,F1e=["children","className","color","disabled","disableFocusRipple","fullWidth","onChange","onClick","selected","size","value"],B1e=n=>{const{classes:e,fullWidth:i,selected:a,disabled:s,size:l,color:d}=n,f={root:["root",a&&"selected",s&&"disabled",i&&"fullWidth",`size${ti(l)}`,d]};return er(f,O1e,e)},U1e=Rn(NA,{name:"MuiToggleButton",slot:"Root",overridesResolver:(n,e)=>{const{ownerState:i}=n;return[e.root,e[`size${ti(i.size)}`]]}})(({theme:n,ownerState:e})=>{let i=e.color==="standard"?n.palette.text.primary:n.palette[e.color].main,a;return n.vars&&(i=e.color==="standard"?n.vars.palette.text.primary:n.vars.palette[e.color].main,a=e.color==="standard"?n.vars.palette.text.primaryChannel:n.vars.palette[e.color].mainChannel),Ge({},n.typography.button,{borderRadius:(n.vars||n).shape.borderRadius,padding:11,border:`1px solid ${(n.vars||n).palette.divider}`,color:(n.vars||n).palette.action.active},e.fullWidth&&{width:"100%"},{[`&.${IV.disabled}`]:{color:(n.vars||n).palette.action.disabled,border:`1px solid ${(n.vars||n).palette.action.disabledBackground}`},"&:hover":{textDecoration:"none",backgroundColor:n.vars?`rgba(${n.vars.palette.text.primaryChannel} / ${n.vars.palette.action.hoverOpacity})`:Sa(n.palette.text.primary,n.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${IV.selected}`]:{color:i,backgroundColor:n.vars?`rgba(${a} / ${n.vars.palette.action.selectedOpacity})`:Sa(i,n.palette.action.selectedOpacity),"&:hover":{backgroundColor:n.vars?`rgba(${a} / calc(${n.vars.palette.action.selectedOpacity} + ${n.vars.palette.action.hoverOpacity}))`:Sa(i,n.palette.action.selectedOpacity+n.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:n.vars?`rgba(${a} / ${n.vars.palette.action.selectedOpacity})`:Sa(i,n.palette.action.selectedOpacity)}}}},e.size==="small"&&{padding:7,fontSize:n.typography.pxToRem(13)},e.size==="large"&&{padding:15,fontSize:n.typography.pxToRem(15)})}),W1e=ne.forwardRef(function(e,i){const a=ar({props:e,name:"MuiToggleButton"}),{children:s,className:l,color:d="standard",disabled:f=!1,disableFocusRipple:p=!1,fullWidth:y=!1,onChange:_,onClick:b,selected:S,size:A="medium",value:P}=a,L=Wn(a,F1e),k=Ge({},a,{color:d,disabled:f,disableFocusRipple:p,fullWidth:y,size:A}),R=B1e(k),z=O=>{b&&(b(O,P),O.defaultPrevented)||_&&_(O,P)};return U(U1e,Ge({className:fi(R.root,l),disabled:f,focusRipple:!p,ref:i,onClick:z,onChange:_,value:P,ownerState:k,"aria-pressed":S},L,{children:s}))}),vX=W1e;function V1e(n,e){return e===void 0||n===void 0?!1:Array.isArray(e)?e.indexOf(n)>=0:n===e}function G1e(n){return Zi("MuiToggleButtonGroup",n)}const H1e=$i("MuiToggleButtonGroup",["root","selected","vertical","disabled","grouped","groupedHorizontal","groupedVertical","fullWidth"]),gh=H1e,j1e=["children","className","color","disabled","exclusive","fullWidth","onChange","orientation","size","value"],$1e=n=>{const{classes:e,orientation:i,fullWidth:a,disabled:s}=n,l={root:["root",i==="vertical"&&"vertical",a&&"fullWidth"],grouped:["grouped",`grouped${ti(i)}`,s&&"disabled"]};return er(l,G1e,e)},Y1e=Rn("div",{name:"MuiToggleButtonGroup",slot:"Root",overridesResolver:(n,e)=>{const{ownerState:i}=n;return[{[`& .${gh.grouped}`]:e.grouped},{[`& .${gh.grouped}`]:e[`grouped${ti(i.orientation)}`]},e.root,i.orientation==="vertical"&&e.vertical,i.fullWidth&&e.fullWidth]}})(({ownerState:n,theme:e})=>Ge({display:"inline-flex",borderRadius:(e.vars||e).shape.borderRadius},n.orientation==="vertical"&&{flexDirection:"column"},n.fullWidth&&{width:"100%"},{[`& .${gh.grouped}`]:Ge({},n.orientation==="horizontal"?{"&:not(:first-of-type)":{marginLeft:-1,borderLeft:"1px solid transparent",borderTopLeftRadius:0,borderBottomLeftRadius:0},"&:not(:last-of-type)":{borderTopRightRadius:0,borderBottomRightRadius:0},[`&.${gh.selected} + .${gh.grouped}.${gh.selected}`]:{borderLeft:0,marginLeft:0}}:{"&:not(:first-of-type)":{marginTop:-1,borderTop:"1px solid transparent",borderTopLeftRadius:0,borderTopRightRadius:0},"&:not(:last-of-type)":{borderBottomLeftRadius:0,borderBottomRightRadius:0},[`&.${gh.selected} + .${gh.grouped}.${gh.selected}`]:{borderTop:0,marginTop:0}})})),q1e=ne.forwardRef(function(e,i){const a=ar({props:e,name:"MuiToggleButtonGroup"}),{children:s,className:l,color:d="standard",disabled:f=!1,exclusive:p=!1,fullWidth:y=!1,onChange:_,orientation:b="horizontal",size:S="medium",value:A}=a,P=Wn(a,j1e),L=Ge({},a,{disabled:f,fullWidth:y,orientation:b,size:S}),k=$1e(L),R=(O,F)=>{if(!_)return;const H=A&&A.indexOf(F);let $;A&&H>=0?($=A.slice(),$.splice(H,1)):$=A?A.concat(F):[F],_(O,$)},z=(O,F)=>{_&&_(O,A===F?null:F)};return U(Y1e,Ge({role:"group",className:fi(k.root,l),ref:i,ownerState:L},P,{children:ne.Children.map(s,O=>ne.isValidElement(O)?ne.cloneElement(O,{className:fi(k.grouped,O.props.className),onChange:p?z:R,selected:O.props.selected===void 0?V1e(O.props.value,A):O.props.selected,size:O.props.size||S,fullWidth:y,color:O.props.color||d,disabled:O.props.disabled||f}):null)}))}),_X=q1e,X1e=G4({palette:{primary:{main:"#007378"},secondary:{main:"#959595"}},components:{MuiSwitch:{styleOverrides:{root:{"& .MuiSwitch-switchBase":{"&.Mui-checked":{color:"#fff","& + .MuiSwitch-track":{opacity:1,backgroundColor:"#2D67FF",borderColor:"#007378"}}}}}},MuiDialog:{styleOverrides:{paper:{maxWidth:"none",borderRadius:40,marginTop:96}}},MuiDialogContent:{styleOverrides:{root:{padding:0}}},MuiCheckbox:{styleOverrides:{root:{color:"#D9D9D9","&.Mui-checked":{color:"#2D67FF"}}}},MuiTable:{styleOverrides:{root:{"& .MuiTableCell-root":{fontFamily:"SuisseIntl-Light",fontWeight:600,fontSize:"2vh"},"& .MuiTableCell-head":{fontFamily:"SuisseIntl-Light",fontWeight:600,fontSize:"2vh",color:"rgba(0, 0, 0, 0.6)"}}}},MuiTableContainer:{styleOverrides:{root:{borderRadius:0,boxShadow:"none"}}}}}),xX=Object.fromEntries?Object.fromEntries:n=>{if(!n||!n[Symbol.iterator])throw new Error("Object.fromEntries() requires a single iterable argument");const e={};return Object.keys(n).forEach(i=>{const[a,s]=n[i];e[a]=s}),e};function g_(n){return Object.keys(n)}function rz(n,e){if(!n)throw new Error(e)}function az(n,e){return e}const oz=n=>{const e=n.length;let i=0,a="";for(;i<e;i++){const s=n[i];if(s==null)continue;let l;switch(typeof s){case"boolean":break;case"object":{if(Array.isArray(s))l=oz(s);else{rz(!az(s,!1)),l="";for(const d in s)s[d]&&d&&(l&&(l+=" "),l+=d)}break}default:l=s}l&&(a&&(a+=" "),a+=l)}return a};function Z1e(n,e){const i=ne.useRef();return(!i.current||e.length!==i.current.prevDeps.length||i.current.prevDeps.map((a,s)=>a===e[s]).indexOf(!1)>=0)&&(i.current={v:n(),prevDeps:[...e]}),i.current.v}function K1e(n){return n instanceof Object&&!("styles"in n)&&!("length"in n)&&!("__emotion_styles"in n)}const{createCssAndCx:J1e}=(()=>{function n(i,a,s){const l=[],d=vq(i,l,s);return l.length<2?s:d+a(l)}function e(i){const{cache:a}=i,s=(...d)=>{const f=SA(d,a.registered);C4(a,f,!1);const p=`${a.key}-${f.name}`;e:{const y=d[0];if(!K1e(y))break e;RV.saveClassNameCSSObjectMapping(a,p,y)}return p};return{css:s,cx:(...d)=>{const f=oz(d),p=RV.fixClassName(a,f,s);return n(a.registered,s,p)}}}return{createCssAndCx:e}})();function bX(n){const{useCache:e}=n;function i(){const a=e(),{css:s,cx:l}=Z1e(()=>J1e({cache:a}),[a]);return{css:s,cx:l}}return{useCssAndCx:i}}const RV=(()=>{const n=new WeakMap;return{saveClassNameCSSObjectMapping:(e,i,a)=>{let s=n.get(e);s===void 0&&(s=new Map,n.set(e,s)),s.set(i,a)},fixClassName:(()=>{function e(i){let a=!1;return i.map(([s,l])=>{if(l===void 0)return s;let d;if(a)d={"&&":l};else{d=s;for(const f in l)if(f.startsWith("@media")){a=!0;break}}return d})}return(i,a,s)=>{const l=n.get(i);return oz(e(a.split(" ").map(d=>[d,l==null?void 0:l.get(d)])).map(d=>typeof d=="string"?d:s(d)))}})()}})();function y_(n){if(!(n instanceof Object)||typeof n=="function")return n;const e=[];for(const i in n){const a=n[i],s=typeof a;if(!(s==="string"||s==="number"&&!isNaN(a)||s==="boolean"||a===void 0||a===null))return n;e.push(`${i}:${s}_${a}`)}return"xSqLiJdLMd9s"+e.join("|")}function sz(n,e,i){if(!(e instanceof Object))return n;const a={};return g_(n).forEach(s=>a[s]=i(n[s],e[s])),g_(e).forEach(s=>{if(s in n)return;const l=e[s];typeof l=="string"&&(a[s]=l)}),a}const wX=({classes:n,theme:e,muiStyleOverridesParams:i,css:a,cx:s,name:l})=>{var d,f;e:{if(l==="makeStyle no name"){l=void 0;break e}if(i!==void 0&&l===void 0)throw new Error("To use muiStyleOverridesParams, you must specify a name using .withName('MyComponent')")}let p;try{p=l===void 0?void 0:((f=(d=e.components)===null||d===void 0?void 0:d[l])===null||f===void 0?void 0:f.styleOverrides)||void 0}catch{}const y=ne.useMemo(()=>{if(p===void 0)return;const _={};for(const b in p){const S=p[b];S instanceof Object&&(_[b]=a(typeof S=="function"?S(Object.assign({theme:e,ownerState:i==null?void 0:i.ownerState},i==null?void 0:i.props)):S))}return _},[p,y_(i==null?void 0:i.props),y_(i==null?void 0:i.ownerState),a]);return n=ne.useMemo(()=>sz(n,y,s),[n,y,s]),{classes:n}};let Q1e=0;function SX(n){const{useTheme:e,cache:i}=n,{useCache:a}=EX({cacheProvidedAtInception:i}),{useCssAndCx:s}=bX({useCache:a});function l(f){const{name:p,uniqId:y=`${Q1e++}`}=f??{},_=typeof p!="object"?p:Object.keys(p)[0];return function(b){const S=typeof b=="function"?b:()=>b;return function(P,L){const k=e();let{css:R,cx:z}=s();const O=a();let F=ne.useMemo(()=>{const H={},$=typeof Proxy<"u"&&new Proxy({},{get:(G,Q)=>(typeof Q=="symbol"&&rz(!1),H[Q]=`${O.key}-${y}${_!==void 0?`-${_}`:""}-${Q}-ref`)}),Y=S(k,P,$||{}),te=xX(g_(Y).map(G=>{const Q=Y[G];return Q.label||(Q.label=`${_!==void 0?`${_}-`:""}${G}`),[G,`${R(Q)}${az(G,G in H)?` ${H[G]}`:""}`]}));return g_(H).forEach(G=>{G in te||(te[G]=H[G])}),te},[O,R,z,k,y_(P)]);{const H=L==null?void 0:L.props.classes;F=ne.useMemo(()=>sz(F,H,z),[F,y_(H),z])}{const H=wX({classes:F,css:R,cx:z,name:_??"makeStyle no name",idOfUseStyles:y,muiStyleOverridesParams:L,theme:k});H.classes!==void 0&&(F=H.classes),H.css!==void 0&&(R=H.css),H.cx!==void 0&&(z=H.cx)}return{classes:F,theme:k,css:R,cx:z}}}}function d(){const f=e(),{css:p,cx:y}=s();return{theme:f,css:p,cx:y}}return{makeStyles:l,useStyles:d}}const exe=ne.createContext(void 0),{createUseCache:EX}=(()=>{function n(){return ne.useContext(exe)}function e(i){const{cacheProvidedAtInception:a}=i;function s(){var l;const d=Kde(),f=n(),p=(l=a??f)!==null&&l!==void 0?l:d;if(p===null)throw new Error(["In order to get SSR working with tss-react you need to explicitly provide an Emotion cache.","MUI users be aware: This is not an error strictly related to tss-react, with or without tss-react,","MUI needs an Emotion cache to be provided for SSR to work.","Here is the MUI documentation related to SSR setup: https://mui.com/material-ui/guides/server-rendering/","TSS provides helper that makes the process of setting up SSR easier: https://docs.tss-react.dev/ssr"].join(`
`));return p}return{useCache:s}}return{createUseCache:e}})();function LV(n){return n.charAt(0).toUpperCase()+n.slice(1)}var kV=globalThis&&globalThis.__rest||function(n,e){var i={};for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&e.indexOf(a)<0&&(i[a]=n[a]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,a=Object.getOwnPropertySymbols(n);s<a.length;s++)e.indexOf(a[s])<0&&Object.prototype.propertyIsEnumerable.call(n,a[s])&&(i[a[s]]=n[a[s]]);return i};function txe(n){const{useTheme:e,cache:i}=n,{makeStyles:a}=SX({useTheme:e,cache:i});function s(l,d,f){const p=typeof l=="string"?(()=>{const A=l,P=function(L){var{children:k}=L,R=kV(L,["children"]);return ne.createElement(A,R,k)};return Object.defineProperty(P,"name",{value:LV(A)}),P})():l,y=(()=>{{const{name:A}=f??{};if(A!==void 0)return typeof A!="object"?A:Object.keys(A)[0]}{const A=p.displayName;if(typeof A=="string"&&A!=="")return A}{const{name:A}=p;if(A)return A.replace(/\$/g,"usd")}})(),_=a(Object.assign(Object.assign({},f),{name:y}))(typeof d=="function"?(A,P,L)=>zV(d(A,P,L)):zV(d));function b(A){for(const P in A)if(P!=="root")return!0;return!1}const S=ne.forwardRef(function(A,P){const{className:L,classes:k}=A,R=kV(A,["className","classes"]),{classes:z,cx:O}=_(A,{props:A}),F=O(z.root,L);return MX.set(z,Object.assign(Object.assign({},z),{root:F})),U(p,{...Object.assign({ref:P,className:b(z)?L:F},typeof l=="string"?{}:{classes:z},R)})});return y!==void 0&&(S.displayName=`${LV(y)}WithStyles`,Object.defineProperty(S,"name",{value:S.displayName})),S}return s.getClasses=nxe,{withStyles:s}}const MX=new WeakMap,DV="getClasses should only be used in conjunction with withStyles";function nxe(n){const e=n.classes;if(e===void 0)throw new Error(DV);const i=MX.get(e);if(i===void 0)throw new Error(DV);return i}function zV(n){const e={},i={};return Object.keys(n).forEach(a=>(a.startsWith("@media")?i:e)[a]=n[a]),Object.keys(i).forEach(a=>{const s=i[a];Object.keys(s).forEach(l=>{var d;return e[l]=Object.assign(Object.assign({},(d=e[l])!==null&&d!==void 0?d:{}),{[a]:s[l]})})}),e}const ixe=(()=>!(typeof document=="object"&&typeof(document==null?void 0:document.getElementById)=="function")&&!(typeof jest<"u")&&!(typeof mocha<"u")&&!(typeof __vitest_worker__<"u"))();var rxe=globalThis&&globalThis.__rest||function(n,e){var i={};for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&e.indexOf(a)<0&&(i[a]=n[a]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,a=Object.getOwnPropertySymbols(n);s<a.length;s++)e.indexOf(a[s])<0&&Object.prototype.propertyIsEnumerable.call(n,a[s])&&(i[a[s]]=n[a[s]]);return i};function TX(n){const{useContext:e,usePlugin:i,cache:a}=n,{useCache:s}=EX({cacheProvidedAtInception:a}),{useCssAndCx:l}=bX({useCache:s});return{tss:hM({useContext:e,useCache:s,useCssAndCx:l,usePlugin:i??(({classes:p,cx:y,css:_})=>({classes:p,cx:y,css:_})),name:void 0,doesUseNestedSelectors:!1})}}let axe=0;const zR=[];function hM(n){const{useContext:e,useCache:i,useCssAndCx:a,usePlugin:s,name:l,doesUseNestedSelectors:d}=n;return{withParams:()=>hM(Object.assign({},n)),withName:f=>hM(Object.assign(Object.assign({},n),{name:typeof f!="object"?f:Object.keys(f)[0]})),withNestedSelectors:()=>hM(Object.assign(Object.assign({},n),{doesUseNestedSelectors:!0})),create:f=>{const p=`x${axe++}`,y=typeof f=="function"?f:()=>f;return function(b){var S,A,P;const L=b??{},{classesOverrides:k}=L,R=rxe(L,["classesOverrides"]),z=e(),{css:O,cx:F}=a(),H=i();let $=ne.useMemo(()=>{const te={},G=y(Object.assign(Object.assign(Object.assign({},b),z),d?{classes:typeof Proxy>"u"?{}:new Proxy({},{get:(he,pe)=>{if(typeof pe=="symbol"&&rz(!1),ixe){{let ye=zR.find(fe=>fe.name===l&&fe.idOfUseStyles===p);ye===void 0&&(ye={name:l,idOfUseStyles:p,nestedSelectorRuleNames:new Set},zR.push(ye)),ye.nestedSelectorRuleNames.add(pe)}if(zR.find(ye=>ye.name===l&&ye.idOfUseStyles!==p&&ye.nestedSelectorRuleNames.has(pe))!==void 0)throw new Error([`tss-react: Duplicate nested selector "${pe}" detected in ${l===void 0?`useStyles named "${l}"`:"anonymous useStyles function"}.`,"In SSR setups, this may lead to CSS class name collisions, causing nested selectors to target elements outside of the intended scope.",'Solution: Ensure each useStyles using nested selectors has a unique name. Use tss.withName("UniqueName").withNestedSelectors<...>()... to set a name.'].join(`
`))}return te[pe]=`${H.key}-${p}${l!==void 0?`-${l}`:""}-${pe}-ref`}})}:{})),Q=xX(g_(G).map(he=>{const pe=G[he];return pe.label||(pe.label=`${l!==void 0?`${l}-`:""}${he}`),[he,`${O(pe)}${az(he,he in te)?` ${te[he]}`:""}`]}));return g_(te).forEach(he=>{he in Q||(Q[he]=te[he])}),Q},[H,O,F,y_(b),...Object.values(z)]);$=ne.useMemo(()=>sz($,k,F),[$,y_(k),F]);const Y=s(Object.assign(Object.assign({classes:$,css:O,cx:F,idOfUseStyles:p,name:l},z),R));return Object.assign({classes:(S=Y.classes)!==null&&S!==void 0?S:$,css:(A=Y.css)!==null&&A!==void 0?A:O,cx:(P=Y.cx)!==null&&P!==void 0?P:F},z)}}}}function oxe(n){return Object.assign(Object.assign({},SX(n)),txe(n))}const{tss:sxe}=TX({useContext:()=>({})});sxe.create({});const{makeStyles:wr,withStyles:NDe}=oxe({useTheme:zp}),{tss:lxe}=TX({useContext:function(){return{theme:zp()}},usePlugin:wX});lxe.create({});const lz=wr()({root:{padding:0,margin:0,backgroundColor:"#1433AE",color:"#fff",height:"100vh"},contentWrapper:{maxWidth:"100%",margin:"0 auto",padding:"0 5%"},gradient:{position:"absolute",top:"0",left:"0",width:"100%",height:"100%",zIndex:1,backgroundImage:"radial-gradient(53.6% 37.94% at 49.21% 62.06%, rgba(33, 63, 178, 0) 0%, #1424A2 100%)"},graph3dWrapper:{backgroundColor:"transparent",zIndex:1,position:"absolute",top:"-30%",left:"8%",width:"100%",height:"130%"}}),jA=wr()({root:{position:"absolute",marginTop:"1.5vh",zIndex:1},titleWrapper:{display:"flex",flexDirection:"row",gap:"5vh",alignItems:"center",justifyContent:"flex-start"},cityNameAndCountryNameWrapper:{display:"flex",flexDirection:"column"},cityName:{fontFamily:"SuisseIntl-Light",fontWeight:400,fontSize:"10.8vh",marginLeft:"-1vh"},cityDescription:{fontFamily:"SuisseIntl-Light",fontWeight:400,fontSize:"1.6vh",opacity:"0.5"},countryName:{fontFamily:"SuisseIntl-Light",fontWeight:400,fontSize:"2vh",marginTop:"-0.95vh"},statWrapper:{display:"flex",flexDirection:"row",gap:"3.5vh",alignItems:"center",justifyContent:"flex-start",marginTop:"2vh"},statItem:{display:"flex",flexDirection:"column",gap:"1vh",justifyContent:"flex-end"},statTitle:{fontFamily:"SuisseIntl-Light",fontWeight:100,fontSize:"1.40vh",opacity:"0.5"},statValue:{fontFamily:"SuisseIntl-Light",fontWeight:200,fontSize:"1.95vh",marginTop:"-0.40vh"},statStatus:{fontFamily:"SuisseIntl-Light",fontWeight:300,width:"fit-content",fontSize:"1.4vh",color:"#2D67FF",border:"1px solid #2D67FF",borderRadius:"50px",padding:"0.6rem .9rem",marginTop:"0vh"},statsContainer:{width:"63.5vh",marginTop:"5.5vh",marginLeft:"-2vh",padding:0,paddingLeft:"2vh",borderLeft:"1px solid #fff"},statStatusBig:{fontFamily:"SuisseIntl-Light",fontWeight:300,width:"fit-content",fontSize:"2vh",borderRadius:"50px",marginTop:"0vh"},statItemBigWrapper:{display:"flex",flexDirection:"column",gap:"1vh",justifyContent:"flex-end"},smallRowWrapper:{position:"relative",width:"auto",display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center"},lowOpacityLabel:{fontFamily:"SuisseIntl-Light",fontWeight:100,fontSize:"1.40vh",opacity:"0.5"},statsBigText:{fontFamily:"SuisseIntl-Light",fontWeight:200,fontSize:"2.5vh",width:"22vh"},statsSmallText:{fontFamily:"SuisseIntl-Light",fontWeight:100,fontSize:"1.5vh"},smallItemsListWrapper:{marginTop:"4vh",display:"flex",flexDirection:"column",gap:"1.1vh"},bottomWrapper:{zIndex:1,display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"flex-end",marginBottom:"29vh",pointerEvents:"none",height:"5vh",marginLeft:"0vh"},smallTextWrapper:{pointerEvents:"all",display:"flex",flexDirection:"row",gap:"10px"},smallText:{fontFamily:"SuisseIntl-Light",fontSize:"1.8vh",color:"#fff",opacity:"0.6",cursor:"pointer"}}),Jw=wr()({root:{zIndex:2,position:"relative",display:"flex",borderBottom:"1px solid #fff",height:"10.3vh",justifyContent:"space-between",alignItems:"center"},menuIconWrapper:{cursor:"pointer",display:"flex",justifyContent:"space-between",alignItems:"center",gap:"8px"},buttonsWrapper:{display:"flex",gap:"8px",justifyContent:"space-between",alignItems:"center"},whiteText:{fontFamily:"SuisseIntl-Light",fontWeight:400,color:"#fff",textTransform:"none",fontSize:"1.8vh","&:hover":{backgroundColor:"inherit"}},signUpButton:{fontFamily:"SuisseIntl-Light",fontWeight:600,color:"#fff",textTransform:"none",fontSize:"1.8vh",height:"4.6vh",backgroundColor:"rgba(45, 103, 255, 1)",borderRadius:"50px",padding:"0.5rem 1.3rem","&:hover":{backgroundColor:"rgba(45, 103, 255, 0.85)"}}}),cz=wr()({root:{display:"flex",flexDirection:"column",justifyContent:"space-between",height:"90vh"},bigText:{paddingTop:"18px",fontFamily:"SuisseIntl-Light",fontWeight:300,lineHeight:"9vh",letterSpacing:"-0.5vh",fontSize:"10.7vh",color:"#fff"},bigTextSubtitle:{position:"absolute",top:"48%",width:"40%",paddingTop:"18px",fontFamily:"SuisseIntl-Thin",lineHeight:"3vh",letterSpacing:"0vh",fontSize:"2vh",color:"#fff",pointerEvents:"none"},bigTextBlue:{paddingTop:"18px",fontFamily:"SuisseIntl-Medium",fontWeight:500,lineHeight:"9vh",letterSpacing:"-0.5vh",fontSize:"10.7vh",color:"#2D67FF"},textAndToggleWrapper:{zIndex:2,display:"flex",flexDirection:"column",gap:"30px",pointerEvents:"none"},filterButtonAndScaleWrapper:{zIndex:1,minWidth:"100px",display:"flex",flexDirection:"column",alignItems:"flex-end",justifyContent:"space-between"},filterSelect:{zIndex:2,borderRadius:"50px",background:"white",minWidth:"unset",minHeight:"unset",height:"4.6vh",fontSize:"1.8vh",padding:"0px 0px 0px 5px","& .MuiSelect-select":{padding:"0px 0px 0px 15px","&:focus":{backgroundColor:"transparent"}}},filterButton:{minWidth:"unset",minHeight:"unset",height:"4.6vh",fontFamily:"SuisseIntl-Light",fontWeight:400,color:"#000000",textTransform:"none",fontSize:"1.8vh",zIndex:2,backgroundColor:"rgba(255, 255, 255, 1)",borderRadius:"50px",padding:"0.5rem 1rem",opacity:"1","&:hover":{backgroundColor:"rgba(255, 255, 255, 0.85)"}},topLineWrapper:{width:"100%",display:"flex",justifyContent:"space-between",flexDirection:"row"},bottomWrapper:{zIndex:1,display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"flex-end",marginBottom:"40px",pointerEvents:"none",height:"10vh"},smallTextWrapper:{pointerEvents:"all",display:"flex",flexDirection:"row",gap:"10px"},smallText:{fontFamily:"SuisseIntl-Light",fontSize:"17px",color:"#7386CA",cursor:"pointer"},legendLine:{position:"absolute",height:"51.5vh",top:"50%",right:"5%",transform:"translate(0, -45%)",pointerEvents:"none",zIndex:"1"},filterButtonsWrapper:{display:"flex",flexDirection:"row",justifyContent:"space-between",marginTop:"-92vh",alignSelf:"end"},blurAll:{position:"absolute",width:"100%",height:"100%",top:0,left:0,zIndex:2,background:"rgba(0, 0, 0, 0.5)",backdropFilter:"blur(10px)"}}),cxe=Rn(_X)(()=>({"& .MuiToggleButtonGroup-grouped":{borderRadius:"50px",border:"1px solid rgba(255, 255, 255, 0.2)",color:"#fff",textTransform:"none",pointerEvents:"all"}})),OV=Rn(vX)({"&.MuiToggleButton-root":{fontFamily:"SuisseIntl-Regular",fontSize:"4vh",textTransform:"none",borderRadius:"50px",border:"1px solid rgba(255, 255, 255, 0.2)",backgroundColor:"transparent",padding:"0.2rem 1.5rem","&:hover":{backgroundColor:"#fff",color:"#000"}},"&.Mui-selected":{backgroundColor:"#fff",color:"#000"}}),uxe=({children:n,backgroundColor:e})=>{const{classes:i}=lz(),a="#1433AE";return U("div",{className:i.root,style:{backgroundColor:e||a},children:U("div",{className:i.contentWrapper,children:n})})},dxe={menu:"Menu",login:"Log in",signup:"Sign up",back:"Back to globe"},hxe=({isCitySelected:n,setSelectedCity:e,setMenuVisible:i})=>{const a=l=>dxe[l],{classes:s}=Jw();return _e("div",{className:s.root,children:[_e("div",{style:{display:"flex",gap:"2.5vh",alignItems:"center"},children:[n&&_e("div",{onClick:()=>{e(null)},className:s.menuIconWrapper,children:[U("img",{style:{width:"4.7vh"},src:"/assets/backToGlobeIcon.svg",width:45,alt:"logo"}),U(nn,{className:s.whiteText,children:a("back")})]}),_e("div",{onClick:()=>i(!0),className:s.menuIconWrapper,children:[U("img",{style:{width:"4.7vh"},src:"/assets/menuIcon.svg",width:45,alt:"logo"}),U(nn,{className:s.whiteText,children:a("menu")})]})]}),U("img",{style:{width:"7.8vh"},src:"/assets/logo.svg",alt:"logo"}),_e("div",{className:s.buttonsWrapper,children:[U(oi,{className:s.whiteText,children:a("login")}),U(oi,{className:s.signUpButton,style:{backgroundColor:n?"#FFFFFF":"#2D67FF",color:n?"#1433AE":"#FFFFFF"},children:a("signup")})]})]})},fxe=({map:n})=>_e("div",{style:{position:"relative",zIndex:2,marginRight:"15px",height:"10.5vh",width:"4.7vh",display:"flex",flexDirection:"column",backgroundColor:"#fff",borderRadius:"50px",overflow:"hidden",padding:0,margin:0,pointerEvents:"all"},children:[U("div",{onClick:()=>{n&&n.zoomIn()},style:{cursor:"pointer",height:"50%",display:"flex",justifyContent:"center",alignItems:"center",backgroundColor:"#fff",borderRadius:"50px",overflow:"hidden",padding:0,margin:0},children:U("img",{src:"/assets/plusIcon.svg",width:"45%",alt:"zoom in"})}),U("div",{onClick:()=>{n&&n.zoomOut()},style:{cursor:"pointer",height:"50%",display:"flex",justifyContent:"center",alignItems:"center",backgroundColor:"#fff",borderRadius:"50px",overflow:"hidden",padding:0,margin:0},children:U("img",{src:"/assets/minusIcon.svg",width:"45%",alt:"zoom out"})})]});/**
 * @license
 * Copyright 2010-2023 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const $A="158",sg={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},lg={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},AX=0,s5=1,CX=2,pxe=3,PX=0,YA=1,vb=2,uu=3,Ad=0,Ts=1,Xl=2,mxe=2,Wh=0,Pg=1,l5=2,c5=3,u5=4,IX=5,tp=100,RX=101,LX=102,d5=103,h5=104,kX=200,DX=201,zX=202,OX=203,fT=204,pT=205,NX=206,FX=207,BX=208,UX=209,WX=210,VX=211,GX=212,HX=213,jX=214,$X=0,YX=1,qX=2,sw=3,XX=4,ZX=5,KX=6,JX=7,Qw=0,QX=1,eZ=2,bd=0,tZ=1,nZ=2,iZ=3,uz=4,rZ=5,f5="attached",aZ="detached",qA=300,Yh=301,Ap=302,lw=303,cw=304,R_=306,uw=1e3,Ss=1001,dw=1002,co=1003,mT=1004,gxe=1004,_b=1005,yxe=1005,ka=1006,dz=1007,vxe=1007,Cp=1008,_xe=1008,wd=1009,oZ=1010,sZ=1011,XA=1012,hz=1013,zh=1014,md=1015,v_=1016,fz=1017,pz=1018,vp=1020,lZ=1021,vl=1023,cZ=1024,uZ=1025,_p=1026,jg=1027,dZ=1028,mz=1029,hZ=1030,gz=1031,yz=1033,fM=33776,pM=33777,mM=33778,gM=33779,p5=35840,m5=35841,g5=35842,y5=35843,fZ=36196,v5=37492,_5=37496,x5=37808,b5=37809,w5=37810,S5=37811,E5=37812,M5=37813,T5=37814,A5=37815,C5=37816,P5=37817,I5=37818,R5=37819,L5=37820,k5=37821,yM=36492,D5=36494,z5=36495,pZ=36283,O5=36284,N5=36285,F5=36286,mZ=2200,gZ=2201,yZ=2202,hw=2300,fw=2301,vM=2302,_g=2400,xg=2401,pw=2402,ZA=2500,vz=2501,xxe=0,bxe=1,wxe=2,_z=3e3,xp=3001,vZ=3200,xz=3201,Np=0,_Z=1,Zl="",Lo="srgb",Cd="srgb-linear",KA="display-p3",eS="display-p3-linear",mw="linear",ra="srgb",gw="rec709",yw="p3",Sxe=0,cg=7680,Exe=7681,Mxe=7682,Txe=7683,Axe=34055,Cxe=34056,Pxe=5386,Ixe=512,Rxe=513,Lxe=514,kxe=515,Dxe=516,zxe=517,Oxe=518,B5=519,xZ=512,bZ=513,wZ=514,SZ=515,EZ=516,MZ=517,TZ=518,AZ=519,vw=35044,Nxe=35048,Fxe=35040,Bxe=35045,Uxe=35049,Wxe=35041,Vxe=35046,Gxe=35050,Hxe=35042,jxe="100",U5="300 es",gT=1035,gd=2e3,_w=2001;class Ld{addEventListener(e,i){this._listeners===void 0&&(this._listeners={});const a=this._listeners;a[e]===void 0&&(a[e]=[]),a[e].indexOf(i)===-1&&a[e].push(i)}hasEventListener(e,i){if(this._listeners===void 0)return!1;const a=this._listeners;return a[e]!==void 0&&a[e].indexOf(i)!==-1}removeEventListener(e,i){if(this._listeners===void 0)return;const s=this._listeners[e];if(s!==void 0){const l=s.indexOf(i);l!==-1&&s.splice(l,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const a=this._listeners[e.type];if(a!==void 0){e.target=this;const s=a.slice(0);for(let l=0,d=s.length;l<d;l++)s[l].call(this,e);e.target=null}}}const vs=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let NV=1234567;const Ig=Math.PI/180,__=180/Math.PI;function tc(){const n=Math.random()*4294967295|0,e=Math.random()*4294967295|0,i=Math.random()*4294967295|0,a=Math.random()*4294967295|0;return(vs[n&255]+vs[n>>8&255]+vs[n>>16&255]+vs[n>>24&255]+"-"+vs[e&255]+vs[e>>8&255]+"-"+vs[e>>16&15|64]+vs[e>>24&255]+"-"+vs[i&63|128]+vs[i>>8&255]+"-"+vs[i>>16&255]+vs[i>>24&255]+vs[a&255]+vs[a>>8&255]+vs[a>>16&255]+vs[a>>24&255]).toLowerCase()}function Xa(n,e,i){return Math.max(e,Math.min(i,n))}function bz(n,e){return(n%e+e)%e}function $xe(n,e,i,a,s){return a+(n-e)*(s-a)/(i-e)}function Yxe(n,e,i){return n!==e?(i-n)/(e-n):0}function xb(n,e,i){return(1-i)*n+i*e}function qxe(n,e,i,a){return xb(n,e,1-Math.exp(-i*a))}function Xxe(n,e=1){return e-Math.abs(bz(n,e*2)-e)}function Zxe(n,e,i){return n<=e?0:n>=i?1:(n=(n-e)/(i-e),n*n*(3-2*n))}function Kxe(n,e,i){return n<=e?0:n>=i?1:(n=(n-e)/(i-e),n*n*n*(n*(n*6-15)+10))}function Jxe(n,e){return n+Math.floor(Math.random()*(e-n+1))}function Qxe(n,e){return n+Math.random()*(e-n)}function ebe(n){return n*(.5-Math.random())}function tbe(n){n!==void 0&&(NV=n);let e=NV+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function nbe(n){return n*Ig}function ibe(n){return n*__}function W5(n){return(n&n-1)===0&&n!==0}function CZ(n){return Math.pow(2,Math.ceil(Math.log(n)/Math.LN2))}function yT(n){return Math.pow(2,Math.floor(Math.log(n)/Math.LN2))}function rbe(n,e,i,a,s){const l=Math.cos,d=Math.sin,f=l(i/2),p=d(i/2),y=l((e+a)/2),_=d((e+a)/2),b=l((e-a)/2),S=d((e-a)/2),A=l((a-e)/2),P=d((a-e)/2);switch(s){case"XYX":n.set(f*_,p*b,p*S,f*y);break;case"YZY":n.set(p*S,f*_,p*b,f*y);break;case"ZXZ":n.set(p*b,p*S,f*_,f*y);break;case"XZX":n.set(f*_,p*P,p*A,f*y);break;case"YXY":n.set(p*A,f*_,p*P,f*y);break;case"ZYZ":n.set(p*P,p*A,f*_,f*y);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+s)}}function _l(n,e){switch(e.constructor){case Float32Array:return n;case Uint32Array:return n/4294967295;case Uint16Array:return n/65535;case Uint8Array:return n/255;case Int32Array:return Math.max(n/2147483647,-1);case Int16Array:return Math.max(n/32767,-1);case Int8Array:return Math.max(n/127,-1);default:throw new Error("Invalid component type.")}}function Gi(n,e){switch(e.constructor){case Float32Array:return n;case Uint32Array:return Math.round(n*4294967295);case Uint16Array:return Math.round(n*65535);case Uint8Array:return Math.round(n*255);case Int32Array:return Math.round(n*2147483647);case Int16Array:return Math.round(n*32767);case Int8Array:return Math.round(n*127);default:throw new Error("Invalid component type.")}}const abe={DEG2RAD:Ig,RAD2DEG:__,generateUUID:tc,clamp:Xa,euclideanModulo:bz,mapLinear:$xe,inverseLerp:Yxe,lerp:xb,damp:qxe,pingpong:Xxe,smoothstep:Zxe,smootherstep:Kxe,randInt:Jxe,randFloat:Qxe,randFloatSpread:ebe,seededRandom:tbe,degToRad:nbe,radToDeg:ibe,isPowerOfTwo:W5,ceilPowerOfTwo:CZ,floorPowerOfTwo:yT,setQuaternionFromProperEuler:rbe,normalize:Gi,denormalize:_l};class tn{constructor(e=0,i=0){tn.prototype.isVector2=!0,this.x=e,this.y=i}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,i){return this.x=e,this.y=i,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,i){switch(e){case 0:this.x=i;break;case 1:this.y=i;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,i){return this.x=e.x+i.x,this.y=e.y+i.y,this}addScaledVector(e,i){return this.x+=e.x*i,this.y+=e.y*i,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,i){return this.x=e.x-i.x,this.y=e.y-i.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const i=this.x,a=this.y,s=e.elements;return this.x=s[0]*i+s[3]*a+s[6],this.y=s[1]*i+s[4]*a+s[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,i){return this.x=Math.max(e.x,Math.min(i.x,this.x)),this.y=Math.max(e.y,Math.min(i.y,this.y)),this}clampScalar(e,i){return this.x=Math.max(e,Math.min(i,this.x)),this.y=Math.max(e,Math.min(i,this.y)),this}clampLength(e,i){const a=this.length();return this.divideScalar(a||1).multiplyScalar(Math.max(e,Math.min(i,a)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const i=Math.sqrt(this.lengthSq()*e.lengthSq());if(i===0)return Math.PI/2;const a=this.dot(e)/i;return Math.acos(Xa(a,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const i=this.x-e.x,a=this.y-e.y;return i*i+a*a}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,i){return this.x+=(e.x-this.x)*i,this.y+=(e.y-this.y)*i,this}lerpVectors(e,i,a){return this.x=e.x+(i.x-e.x)*a,this.y=e.y+(i.y-e.y)*a,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,i=0){return this.x=e[i],this.y=e[i+1],this}toArray(e=[],i=0){return e[i]=this.x,e[i+1]=this.y,e}fromBufferAttribute(e,i){return this.x=e.getX(i),this.y=e.getY(i),this}rotateAround(e,i){const a=Math.cos(i),s=Math.sin(i),l=this.x-e.x,d=this.y-e.y;return this.x=l*a-d*s+e.x,this.y=l*s+d*a+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Vi{constructor(e,i,a,s,l,d,f,p,y){Vi.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,i,a,s,l,d,f,p,y)}set(e,i,a,s,l,d,f,p,y){const _=this.elements;return _[0]=e,_[1]=s,_[2]=f,_[3]=i,_[4]=l,_[5]=p,_[6]=a,_[7]=d,_[8]=y,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const i=this.elements,a=e.elements;return i[0]=a[0],i[1]=a[1],i[2]=a[2],i[3]=a[3],i[4]=a[4],i[5]=a[5],i[6]=a[6],i[7]=a[7],i[8]=a[8],this}extractBasis(e,i,a){return e.setFromMatrix3Column(this,0),i.setFromMatrix3Column(this,1),a.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const i=e.elements;return this.set(i[0],i[4],i[8],i[1],i[5],i[9],i[2],i[6],i[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,i){const a=e.elements,s=i.elements,l=this.elements,d=a[0],f=a[3],p=a[6],y=a[1],_=a[4],b=a[7],S=a[2],A=a[5],P=a[8],L=s[0],k=s[3],R=s[6],z=s[1],O=s[4],F=s[7],H=s[2],$=s[5],Y=s[8];return l[0]=d*L+f*z+p*H,l[3]=d*k+f*O+p*$,l[6]=d*R+f*F+p*Y,l[1]=y*L+_*z+b*H,l[4]=y*k+_*O+b*$,l[7]=y*R+_*F+b*Y,l[2]=S*L+A*z+P*H,l[5]=S*k+A*O+P*$,l[8]=S*R+A*F+P*Y,this}multiplyScalar(e){const i=this.elements;return i[0]*=e,i[3]*=e,i[6]*=e,i[1]*=e,i[4]*=e,i[7]*=e,i[2]*=e,i[5]*=e,i[8]*=e,this}determinant(){const e=this.elements,i=e[0],a=e[1],s=e[2],l=e[3],d=e[4],f=e[5],p=e[6],y=e[7],_=e[8];return i*d*_-i*f*y-a*l*_+a*f*p+s*l*y-s*d*p}invert(){const e=this.elements,i=e[0],a=e[1],s=e[2],l=e[3],d=e[4],f=e[5],p=e[6],y=e[7],_=e[8],b=_*d-f*y,S=f*p-_*l,A=y*l-d*p,P=i*b+a*S+s*A;if(P===0)return this.set(0,0,0,0,0,0,0,0,0);const L=1/P;return e[0]=b*L,e[1]=(s*y-_*a)*L,e[2]=(f*a-s*d)*L,e[3]=S*L,e[4]=(_*i-s*p)*L,e[5]=(s*l-f*i)*L,e[6]=A*L,e[7]=(a*p-y*i)*L,e[8]=(d*i-a*l)*L,this}transpose(){let e;const i=this.elements;return e=i[1],i[1]=i[3],i[3]=e,e=i[2],i[2]=i[6],i[6]=e,e=i[5],i[5]=i[7],i[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const i=this.elements;return e[0]=i[0],e[1]=i[3],e[2]=i[6],e[3]=i[1],e[4]=i[4],e[5]=i[7],e[6]=i[2],e[7]=i[5],e[8]=i[8],this}setUvTransform(e,i,a,s,l,d,f){const p=Math.cos(l),y=Math.sin(l);return this.set(a*p,a*y,-a*(p*d+y*f)+d+e,-s*y,s*p,-s*(-y*d+p*f)+f+i,0,0,1),this}scale(e,i){return this.premultiply(OR.makeScale(e,i)),this}rotate(e){return this.premultiply(OR.makeRotation(-e)),this}translate(e,i){return this.premultiply(OR.makeTranslation(e,i)),this}makeTranslation(e,i){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,i,0,0,1),this}makeRotation(e){const i=Math.cos(e),a=Math.sin(e);return this.set(i,-a,0,a,i,0,0,0,1),this}makeScale(e,i){return this.set(e,0,0,0,i,0,0,0,1),this}equals(e){const i=this.elements,a=e.elements;for(let s=0;s<9;s++)if(i[s]!==a[s])return!1;return!0}fromArray(e,i=0){for(let a=0;a<9;a++)this.elements[a]=e[a+i];return this}toArray(e=[],i=0){const a=this.elements;return e[i]=a[0],e[i+1]=a[1],e[i+2]=a[2],e[i+3]=a[3],e[i+4]=a[4],e[i+5]=a[5],e[i+6]=a[6],e[i+7]=a[7],e[i+8]=a[8],e}clone(){return new this.constructor().fromArray(this.elements)}}const OR=new Vi;function PZ(n){for(let e=n.length-1;e>=0;--e)if(n[e]>=65535)return!0;return!1}const obe={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function z0(n,e){return new obe[n](e)}function xw(n){return document.createElementNS("http://www.w3.org/1999/xhtml",n)}function IZ(){const n=xw("canvas");return n.style.display="block",n}const FV={};function bb(n){n in FV||(FV[n]=!0,console.warn(n))}const BV=new Vi().set(.8224621,.177538,0,.0331941,.9668058,0,.0170827,.0723974,.9105199),UV=new Vi().set(1.2249401,-.2249404,0,-.0420569,1.0420571,0,-.0196376,-.0786361,1.0982735),R3={[Cd]:{transfer:mw,primaries:gw,toReference:n=>n,fromReference:n=>n},[Lo]:{transfer:ra,primaries:gw,toReference:n=>n.convertSRGBToLinear(),fromReference:n=>n.convertLinearToSRGB()},[eS]:{transfer:mw,primaries:yw,toReference:n=>n.applyMatrix3(UV),fromReference:n=>n.applyMatrix3(BV)},[KA]:{transfer:ra,primaries:yw,toReference:n=>n.convertSRGBToLinear().applyMatrix3(UV),fromReference:n=>n.applyMatrix3(BV).convertLinearToSRGB()}},sbe=new Set([Cd,eS]),Vr={enabled:!0,_workingColorSpace:Cd,get legacyMode(){return console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),!this.enabled},set legacyMode(n){console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),this.enabled=!n},get workingColorSpace(){return this._workingColorSpace},set workingColorSpace(n){if(!sbe.has(n))throw new Error(`Unsupported working color space, "${n}".`);this._workingColorSpace=n},convert:function(n,e,i){if(this.enabled===!1||e===i||!e||!i)return n;const a=R3[e].toReference,s=R3[i].fromReference;return s(a(n))},fromWorkingColorSpace:function(n,e){return this.convert(n,this._workingColorSpace,e)},toWorkingColorSpace:function(n,e){return this.convert(n,e,this._workingColorSpace)},getPrimaries:function(n){return R3[n].primaries},getTransfer:function(n){return n===Zl?mw:R3[n].transfer}};function K0(n){return n<.04045?n*.0773993808:Math.pow(n*.9478672986+.0521327014,2.4)}function NR(n){return n<.0031308?n*12.92:1.055*Math.pow(n,.41666)-.055}let Gv;class wz{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let i;if(e instanceof HTMLCanvasElement)i=e;else{Gv===void 0&&(Gv=xw("canvas")),Gv.width=e.width,Gv.height=e.height;const a=Gv.getContext("2d");e instanceof ImageData?a.putImageData(e,0,0):a.drawImage(e,0,0,e.width,e.height),i=Gv}return i.width>2048||i.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),i.toDataURL("image/jpeg",.6)):i.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const i=xw("canvas");i.width=e.width,i.height=e.height;const a=i.getContext("2d");a.drawImage(e,0,0,e.width,e.height);const s=a.getImageData(0,0,e.width,e.height),l=s.data;for(let d=0;d<l.length;d++)l[d]=K0(l[d]/255)*255;return a.putImageData(s,0,0),i}else if(e.data){const i=e.data.slice(0);for(let a=0;a<i.length;a++)i instanceof Uint8Array||i instanceof Uint8ClampedArray?i[a]=Math.floor(K0(i[a]/255)*255):i[a]=K0(i[a]);return{data:i,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let lbe=0;class bg{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:lbe++}),this.uuid=tc(),this.data=e,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const i=e===void 0||typeof e=="string";if(!i&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const a={uuid:this.uuid,url:""},s=this.data;if(s!==null){let l;if(Array.isArray(s)){l=[];for(let d=0,f=s.length;d<f;d++)s[d].isDataTexture?l.push(FR(s[d].image)):l.push(FR(s[d]))}else l=FR(s);a.url=l}return i||(e.images[this.uuid]=a),a}}function FR(n){return typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&n instanceof ImageBitmap?wz.getDataURL(n):n.data?{data:Array.from(n.data),width:n.width,height:n.height,type:n.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let cbe=0;class Oa extends Ld{constructor(e=Oa.DEFAULT_IMAGE,i=Oa.DEFAULT_MAPPING,a=Ss,s=Ss,l=ka,d=Cp,f=vl,p=wd,y=Oa.DEFAULT_ANISOTROPY,_=Zl){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:cbe++}),this.uuid=tc(),this.name="",this.source=new bg(e),this.mipmaps=[],this.mapping=i,this.channel=0,this.wrapS=a,this.wrapT=s,this.magFilter=l,this.minFilter=d,this.anisotropy=y,this.format=f,this.internalFormat=null,this.type=p,this.offset=new tn(0,0),this.repeat=new tn(1,1),this.center=new tn(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Vi,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,typeof _=="string"?this.colorSpace=_:(bb("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=_===xp?Lo:Zl),this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const i=e===void 0||typeof e=="string";if(!i&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const a={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(a.userData=this.userData),i||(e.textures[this.uuid]=a),a}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==qA)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case uw:e.x=e.x-Math.floor(e.x);break;case Ss:e.x=e.x<0?0:1;break;case dw:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case uw:e.y=e.y-Math.floor(e.y);break;case Ss:e.y=e.y<0?0:1;break;case dw:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}get encoding(){return bb("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace===Lo?xp:_z}set encoding(e){bb("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=e===xp?Lo:Zl}}Oa.DEFAULT_IMAGE=null;Oa.DEFAULT_MAPPING=qA;Oa.DEFAULT_ANISOTROPY=1;class Lr{constructor(e=0,i=0,a=0,s=1){Lr.prototype.isVector4=!0,this.x=e,this.y=i,this.z=a,this.w=s}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,i,a,s){return this.x=e,this.y=i,this.z=a,this.w=s,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,i){switch(e){case 0:this.x=i;break;case 1:this.y=i;break;case 2:this.z=i;break;case 3:this.w=i;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,i){return this.x=e.x+i.x,this.y=e.y+i.y,this.z=e.z+i.z,this.w=e.w+i.w,this}addScaledVector(e,i){return this.x+=e.x*i,this.y+=e.y*i,this.z+=e.z*i,this.w+=e.w*i,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,i){return this.x=e.x-i.x,this.y=e.y-i.y,this.z=e.z-i.z,this.w=e.w-i.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const i=this.x,a=this.y,s=this.z,l=this.w,d=e.elements;return this.x=d[0]*i+d[4]*a+d[8]*s+d[12]*l,this.y=d[1]*i+d[5]*a+d[9]*s+d[13]*l,this.z=d[2]*i+d[6]*a+d[10]*s+d[14]*l,this.w=d[3]*i+d[7]*a+d[11]*s+d[15]*l,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const i=Math.sqrt(1-e.w*e.w);return i<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/i,this.y=e.y/i,this.z=e.z/i),this}setAxisAngleFromRotationMatrix(e){let i,a,s,l;const p=e.elements,y=p[0],_=p[4],b=p[8],S=p[1],A=p[5],P=p[9],L=p[2],k=p[6],R=p[10];if(Math.abs(_-S)<.01&&Math.abs(b-L)<.01&&Math.abs(P-k)<.01){if(Math.abs(_+S)<.1&&Math.abs(b+L)<.1&&Math.abs(P+k)<.1&&Math.abs(y+A+R-3)<.1)return this.set(1,0,0,0),this;i=Math.PI;const O=(y+1)/2,F=(A+1)/2,H=(R+1)/2,$=(_+S)/4,Y=(b+L)/4,te=(P+k)/4;return O>F&&O>H?O<.01?(a=0,s=.707106781,l=.707106781):(a=Math.sqrt(O),s=$/a,l=Y/a):F>H?F<.01?(a=.707106781,s=0,l=.707106781):(s=Math.sqrt(F),a=$/s,l=te/s):H<.01?(a=.707106781,s=.707106781,l=0):(l=Math.sqrt(H),a=Y/l,s=te/l),this.set(a,s,l,i),this}let z=Math.sqrt((k-P)*(k-P)+(b-L)*(b-L)+(S-_)*(S-_));return Math.abs(z)<.001&&(z=1),this.x=(k-P)/z,this.y=(b-L)/z,this.z=(S-_)/z,this.w=Math.acos((y+A+R-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,i){return this.x=Math.max(e.x,Math.min(i.x,this.x)),this.y=Math.max(e.y,Math.min(i.y,this.y)),this.z=Math.max(e.z,Math.min(i.z,this.z)),this.w=Math.max(e.w,Math.min(i.w,this.w)),this}clampScalar(e,i){return this.x=Math.max(e,Math.min(i,this.x)),this.y=Math.max(e,Math.min(i,this.y)),this.z=Math.max(e,Math.min(i,this.z)),this.w=Math.max(e,Math.min(i,this.w)),this}clampLength(e,i){const a=this.length();return this.divideScalar(a||1).multiplyScalar(Math.max(e,Math.min(i,a)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,i){return this.x+=(e.x-this.x)*i,this.y+=(e.y-this.y)*i,this.z+=(e.z-this.z)*i,this.w+=(e.w-this.w)*i,this}lerpVectors(e,i,a){return this.x=e.x+(i.x-e.x)*a,this.y=e.y+(i.y-e.y)*a,this.z=e.z+(i.z-e.z)*a,this.w=e.w+(i.w-e.w)*a,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,i=0){return this.x=e[i],this.y=e[i+1],this.z=e[i+2],this.w=e[i+3],this}toArray(e=[],i=0){return e[i]=this.x,e[i+1]=this.y,e[i+2]=this.z,e[i+3]=this.w,e}fromBufferAttribute(e,i){return this.x=e.getX(i),this.y=e.getY(i),this.z=e.getZ(i),this.w=e.getW(i),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class RZ extends Ld{constructor(e=1,i=1,a={}){super(),this.isRenderTarget=!0,this.width=e,this.height=i,this.depth=1,this.scissor=new Lr(0,0,e,i),this.scissorTest=!1,this.viewport=new Lr(0,0,e,i);const s={width:e,height:i,depth:1};a.encoding!==void 0&&(bb("THREE.WebGLRenderTarget: option.encoding has been replaced by option.colorSpace."),a.colorSpace=a.encoding===xp?Lo:Zl),a=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:ka,depthBuffer:!0,stencilBuffer:!1,depthTexture:null,samples:0},a),this.texture=new Oa(s,a.mapping,a.wrapS,a.wrapT,a.magFilter,a.minFilter,a.format,a.type,a.anisotropy,a.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=a.generateMipmaps,this.texture.internalFormat=a.internalFormat,this.depthBuffer=a.depthBuffer,this.stencilBuffer=a.stencilBuffer,this.depthTexture=a.depthTexture,this.samples=a.samples}setSize(e,i,a=1){(this.width!==e||this.height!==i||this.depth!==a)&&(this.width=e,this.height=i,this.depth=a,this.texture.image.width=e,this.texture.image.height=i,this.texture.image.depth=a,this.dispose()),this.viewport.set(0,0,e,i),this.scissor.set(0,0,e,i)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0;const i=Object.assign({},e.texture.image);return this.texture.source=new bg(i),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class wu extends RZ{constructor(e=1,i=1,a={}){super(e,i,a),this.isWebGLRenderTarget=!0}}class JA extends Oa{constructor(e=null,i=1,a=1,s=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:i,height:a,depth:s},this.magFilter=co,this.minFilter=co,this.wrapR=Ss,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class ube extends wu{constructor(e=1,i=1,a=1){super(e,i),this.isWebGLArrayRenderTarget=!0,this.depth=a,this.texture=new JA(null,e,i,a),this.texture.isRenderTargetTexture=!0}}class Sz extends Oa{constructor(e=null,i=1,a=1,s=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:i,height:a,depth:s},this.magFilter=co,this.minFilter=co,this.wrapR=Ss,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class dbe extends wu{constructor(e=1,i=1,a=1){super(e,i),this.isWebGL3DRenderTarget=!0,this.depth=a,this.texture=new Sz(null,e,i,a),this.texture.isRenderTargetTexture=!0}}class hbe extends wu{constructor(e=1,i=1,a=1,s={}){super(e,i,s),this.isWebGLMultipleRenderTargets=!0;const l=this.texture;this.texture=[];for(let d=0;d<a;d++)this.texture[d]=l.clone(),this.texture[d].isRenderTargetTexture=!0}setSize(e,i,a=1){if(this.width!==e||this.height!==i||this.depth!==a){this.width=e,this.height=i,this.depth=a;for(let s=0,l=this.texture.length;s<l;s++)this.texture[s].image.width=e,this.texture[s].image.height=i,this.texture[s].image.depth=a;this.dispose()}this.viewport.set(0,0,e,i),this.scissor.set(0,0,e,i)}copy(e){this.dispose(),this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.texture.length=0;for(let i=0,a=e.texture.length;i<a;i++)this.texture[i]=e.texture[i].clone(),this.texture[i].isRenderTargetTexture=!0;return this}}class As{constructor(e=0,i=0,a=0,s=1){this.isQuaternion=!0,this._x=e,this._y=i,this._z=a,this._w=s}static slerpFlat(e,i,a,s,l,d,f){let p=a[s+0],y=a[s+1],_=a[s+2],b=a[s+3];const S=l[d+0],A=l[d+1],P=l[d+2],L=l[d+3];if(f===0){e[i+0]=p,e[i+1]=y,e[i+2]=_,e[i+3]=b;return}if(f===1){e[i+0]=S,e[i+1]=A,e[i+2]=P,e[i+3]=L;return}if(b!==L||p!==S||y!==A||_!==P){let k=1-f;const R=p*S+y*A+_*P+b*L,z=R>=0?1:-1,O=1-R*R;if(O>Number.EPSILON){const H=Math.sqrt(O),$=Math.atan2(H,R*z);k=Math.sin(k*$)/H,f=Math.sin(f*$)/H}const F=f*z;if(p=p*k+S*F,y=y*k+A*F,_=_*k+P*F,b=b*k+L*F,k===1-f){const H=1/Math.sqrt(p*p+y*y+_*_+b*b);p*=H,y*=H,_*=H,b*=H}}e[i]=p,e[i+1]=y,e[i+2]=_,e[i+3]=b}static multiplyQuaternionsFlat(e,i,a,s,l,d){const f=a[s],p=a[s+1],y=a[s+2],_=a[s+3],b=l[d],S=l[d+1],A=l[d+2],P=l[d+3];return e[i]=f*P+_*b+p*A-y*S,e[i+1]=p*P+_*S+y*b-f*A,e[i+2]=y*P+_*A+f*S-p*b,e[i+3]=_*P-f*b-p*S-y*A,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,i,a,s){return this._x=e,this._y=i,this._z=a,this._w=s,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,i){const a=e._x,s=e._y,l=e._z,d=e._order,f=Math.cos,p=Math.sin,y=f(a/2),_=f(s/2),b=f(l/2),S=p(a/2),A=p(s/2),P=p(l/2);switch(d){case"XYZ":this._x=S*_*b+y*A*P,this._y=y*A*b-S*_*P,this._z=y*_*P+S*A*b,this._w=y*_*b-S*A*P;break;case"YXZ":this._x=S*_*b+y*A*P,this._y=y*A*b-S*_*P,this._z=y*_*P-S*A*b,this._w=y*_*b+S*A*P;break;case"ZXY":this._x=S*_*b-y*A*P,this._y=y*A*b+S*_*P,this._z=y*_*P+S*A*b,this._w=y*_*b-S*A*P;break;case"ZYX":this._x=S*_*b-y*A*P,this._y=y*A*b+S*_*P,this._z=y*_*P-S*A*b,this._w=y*_*b+S*A*P;break;case"YZX":this._x=S*_*b+y*A*P,this._y=y*A*b+S*_*P,this._z=y*_*P-S*A*b,this._w=y*_*b-S*A*P;break;case"XZY":this._x=S*_*b-y*A*P,this._y=y*A*b-S*_*P,this._z=y*_*P+S*A*b,this._w=y*_*b+S*A*P;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+d)}return i!==!1&&this._onChangeCallback(),this}setFromAxisAngle(e,i){const a=i/2,s=Math.sin(a);return this._x=e.x*s,this._y=e.y*s,this._z=e.z*s,this._w=Math.cos(a),this._onChangeCallback(),this}setFromRotationMatrix(e){const i=e.elements,a=i[0],s=i[4],l=i[8],d=i[1],f=i[5],p=i[9],y=i[2],_=i[6],b=i[10],S=a+f+b;if(S>0){const A=.5/Math.sqrt(S+1);this._w=.25/A,this._x=(_-p)*A,this._y=(l-y)*A,this._z=(d-s)*A}else if(a>f&&a>b){const A=2*Math.sqrt(1+a-f-b);this._w=(_-p)/A,this._x=.25*A,this._y=(s+d)/A,this._z=(l+y)/A}else if(f>b){const A=2*Math.sqrt(1+f-a-b);this._w=(l-y)/A,this._x=(s+d)/A,this._y=.25*A,this._z=(p+_)/A}else{const A=2*Math.sqrt(1+b-a-f);this._w=(d-s)/A,this._x=(l+y)/A,this._y=(p+_)/A,this._z=.25*A}return this._onChangeCallback(),this}setFromUnitVectors(e,i){let a=e.dot(i)+1;return a<Number.EPSILON?(a=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=a):(this._x=0,this._y=-e.z,this._z=e.y,this._w=a)):(this._x=e.y*i.z-e.z*i.y,this._y=e.z*i.x-e.x*i.z,this._z=e.x*i.y-e.y*i.x,this._w=a),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Xa(this.dot(e),-1,1)))}rotateTowards(e,i){const a=this.angleTo(e);if(a===0)return this;const s=Math.min(1,i/a);return this.slerp(e,s),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,i){const a=e._x,s=e._y,l=e._z,d=e._w,f=i._x,p=i._y,y=i._z,_=i._w;return this._x=a*_+d*f+s*y-l*p,this._y=s*_+d*p+l*f-a*y,this._z=l*_+d*y+a*p-s*f,this._w=d*_-a*f-s*p-l*y,this._onChangeCallback(),this}slerp(e,i){if(i===0)return this;if(i===1)return this.copy(e);const a=this._x,s=this._y,l=this._z,d=this._w;let f=d*e._w+a*e._x+s*e._y+l*e._z;if(f<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,f=-f):this.copy(e),f>=1)return this._w=d,this._x=a,this._y=s,this._z=l,this;const p=1-f*f;if(p<=Number.EPSILON){const A=1-i;return this._w=A*d+i*this._w,this._x=A*a+i*this._x,this._y=A*s+i*this._y,this._z=A*l+i*this._z,this.normalize(),this._onChangeCallback(),this}const y=Math.sqrt(p),_=Math.atan2(y,f),b=Math.sin((1-i)*_)/y,S=Math.sin(i*_)/y;return this._w=d*b+this._w*S,this._x=a*b+this._x*S,this._y=s*b+this._y*S,this._z=l*b+this._z*S,this._onChangeCallback(),this}slerpQuaternions(e,i,a){return this.copy(e).slerp(i,a)}random(){const e=Math.random(),i=Math.sqrt(1-e),a=Math.sqrt(e),s=2*Math.PI*Math.random(),l=2*Math.PI*Math.random();return this.set(i*Math.cos(s),a*Math.sin(l),a*Math.cos(l),i*Math.sin(s))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,i=0){return this._x=e[i],this._y=e[i+1],this._z=e[i+2],this._w=e[i+3],this._onChangeCallback(),this}toArray(e=[],i=0){return e[i]=this._x,e[i+1]=this._y,e[i+2]=this._z,e[i+3]=this._w,e}fromBufferAttribute(e,i){return this._x=e.getX(i),this._y=e.getY(i),this._z=e.getZ(i),this._w=e.getW(i),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class We{constructor(e=0,i=0,a=0){We.prototype.isVector3=!0,this.x=e,this.y=i,this.z=a}set(e,i,a){return a===void 0&&(a=this.z),this.x=e,this.y=i,this.z=a,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,i){switch(e){case 0:this.x=i;break;case 1:this.y=i;break;case 2:this.z=i;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,i){return this.x=e.x+i.x,this.y=e.y+i.y,this.z=e.z+i.z,this}addScaledVector(e,i){return this.x+=e.x*i,this.y+=e.y*i,this.z+=e.z*i,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,i){return this.x=e.x-i.x,this.y=e.y-i.y,this.z=e.z-i.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,i){return this.x=e.x*i.x,this.y=e.y*i.y,this.z=e.z*i.z,this}applyEuler(e){return this.applyQuaternion(WV.setFromEuler(e))}applyAxisAngle(e,i){return this.applyQuaternion(WV.setFromAxisAngle(e,i))}applyMatrix3(e){const i=this.x,a=this.y,s=this.z,l=e.elements;return this.x=l[0]*i+l[3]*a+l[6]*s,this.y=l[1]*i+l[4]*a+l[7]*s,this.z=l[2]*i+l[5]*a+l[8]*s,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const i=this.x,a=this.y,s=this.z,l=e.elements,d=1/(l[3]*i+l[7]*a+l[11]*s+l[15]);return this.x=(l[0]*i+l[4]*a+l[8]*s+l[12])*d,this.y=(l[1]*i+l[5]*a+l[9]*s+l[13])*d,this.z=(l[2]*i+l[6]*a+l[10]*s+l[14])*d,this}applyQuaternion(e){const i=this.x,a=this.y,s=this.z,l=e.x,d=e.y,f=e.z,p=e.w,y=2*(d*s-f*a),_=2*(f*i-l*s),b=2*(l*a-d*i);return this.x=i+p*y+d*b-f*_,this.y=a+p*_+f*y-l*b,this.z=s+p*b+l*_-d*y,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const i=this.x,a=this.y,s=this.z,l=e.elements;return this.x=l[0]*i+l[4]*a+l[8]*s,this.y=l[1]*i+l[5]*a+l[9]*s,this.z=l[2]*i+l[6]*a+l[10]*s,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,i){return this.x=Math.max(e.x,Math.min(i.x,this.x)),this.y=Math.max(e.y,Math.min(i.y,this.y)),this.z=Math.max(e.z,Math.min(i.z,this.z)),this}clampScalar(e,i){return this.x=Math.max(e,Math.min(i,this.x)),this.y=Math.max(e,Math.min(i,this.y)),this.z=Math.max(e,Math.min(i,this.z)),this}clampLength(e,i){const a=this.length();return this.divideScalar(a||1).multiplyScalar(Math.max(e,Math.min(i,a)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,i){return this.x+=(e.x-this.x)*i,this.y+=(e.y-this.y)*i,this.z+=(e.z-this.z)*i,this}lerpVectors(e,i,a){return this.x=e.x+(i.x-e.x)*a,this.y=e.y+(i.y-e.y)*a,this.z=e.z+(i.z-e.z)*a,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,i){const a=e.x,s=e.y,l=e.z,d=i.x,f=i.y,p=i.z;return this.x=s*p-l*f,this.y=l*d-a*p,this.z=a*f-s*d,this}projectOnVector(e){const i=e.lengthSq();if(i===0)return this.set(0,0,0);const a=e.dot(this)/i;return this.copy(e).multiplyScalar(a)}projectOnPlane(e){return BR.copy(this).projectOnVector(e),this.sub(BR)}reflect(e){return this.sub(BR.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const i=Math.sqrt(this.lengthSq()*e.lengthSq());if(i===0)return Math.PI/2;const a=this.dot(e)/i;return Math.acos(Xa(a,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const i=this.x-e.x,a=this.y-e.y,s=this.z-e.z;return i*i+a*a+s*s}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,i,a){const s=Math.sin(i)*e;return this.x=s*Math.sin(a),this.y=Math.cos(i)*e,this.z=s*Math.cos(a),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,i,a){return this.x=e*Math.sin(i),this.y=a,this.z=e*Math.cos(i),this}setFromMatrixPosition(e){const i=e.elements;return this.x=i[12],this.y=i[13],this.z=i[14],this}setFromMatrixScale(e){const i=this.setFromMatrixColumn(e,0).length(),a=this.setFromMatrixColumn(e,1).length(),s=this.setFromMatrixColumn(e,2).length();return this.x=i,this.y=a,this.z=s,this}setFromMatrixColumn(e,i){return this.fromArray(e.elements,i*4)}setFromMatrix3Column(e,i){return this.fromArray(e.elements,i*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,i=0){return this.x=e[i],this.y=e[i+1],this.z=e[i+2],this}toArray(e=[],i=0){return e[i]=this.x,e[i+1]=this.y,e[i+2]=this.z,e}fromBufferAttribute(e,i){return this.x=e.getX(i),this.y=e.getY(i),this.z=e.getZ(i),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=(Math.random()-.5)*2,i=Math.random()*Math.PI*2,a=Math.sqrt(1-e**2);return this.x=a*Math.cos(i),this.y=a*Math.sin(i),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const BR=new We,WV=new As;class Su{constructor(e=new We(1/0,1/0,1/0),i=new We(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=i}set(e,i){return this.min.copy(e),this.max.copy(i),this}setFromArray(e){this.makeEmpty();for(let i=0,a=e.length;i<a;i+=3)this.expandByPoint(ou.fromArray(e,i));return this}setFromBufferAttribute(e){this.makeEmpty();for(let i=0,a=e.count;i<a;i++)this.expandByPoint(ou.fromBufferAttribute(e,i));return this}setFromPoints(e){this.makeEmpty();for(let i=0,a=e.length;i<a;i++)this.expandByPoint(e[i]);return this}setFromCenterAndSize(e,i){const a=ou.copy(i).multiplyScalar(.5);return this.min.copy(e).sub(a),this.max.copy(e).add(a),this}setFromObject(e,i=!1){return this.makeEmpty(),this.expandByObject(e,i)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,i=!1){e.updateWorldMatrix(!1,!1);const a=e.geometry;if(a!==void 0){const l=a.getAttribute("position");if(i===!0&&l!==void 0&&e.isInstancedMesh!==!0)for(let d=0,f=l.count;d<f;d++)e.isMesh===!0?e.getVertexPosition(d,ou):ou.fromBufferAttribute(l,d),ou.applyMatrix4(e.matrixWorld),this.expandByPoint(ou);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),L3.copy(e.boundingBox)):(a.boundingBox===null&&a.computeBoundingBox(),L3.copy(a.boundingBox)),L3.applyMatrix4(e.matrixWorld),this.union(L3)}const s=e.children;for(let l=0,d=s.length;l<d;l++)this.expandByObject(s[l],i);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,i){return i.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,ou),ou.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let i,a;return e.normal.x>0?(i=e.normal.x*this.min.x,a=e.normal.x*this.max.x):(i=e.normal.x*this.max.x,a=e.normal.x*this.min.x),e.normal.y>0?(i+=e.normal.y*this.min.y,a+=e.normal.y*this.max.y):(i+=e.normal.y*this.max.y,a+=e.normal.y*this.min.y),e.normal.z>0?(i+=e.normal.z*this.min.z,a+=e.normal.z*this.max.z):(i+=e.normal.z*this.max.z,a+=e.normal.z*this.min.z),i<=-e.constant&&a>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(bx),k3.subVectors(this.max,bx),Hv.subVectors(e.a,bx),jv.subVectors(e.b,bx),$v.subVectors(e.c,bx),Gf.subVectors(jv,Hv),Hf.subVectors($v,jv),Gm.subVectors(Hv,$v);let i=[0,-Gf.z,Gf.y,0,-Hf.z,Hf.y,0,-Gm.z,Gm.y,Gf.z,0,-Gf.x,Hf.z,0,-Hf.x,Gm.z,0,-Gm.x,-Gf.y,Gf.x,0,-Hf.y,Hf.x,0,-Gm.y,Gm.x,0];return!UR(i,Hv,jv,$v,k3)||(i=[1,0,0,0,1,0,0,0,1],!UR(i,Hv,jv,$v,k3))?!1:(D3.crossVectors(Gf,Hf),i=[D3.x,D3.y,D3.z],UR(i,Hv,jv,$v,k3))}clampPoint(e,i){return i.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,ou).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(ou).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(yh[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),yh[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),yh[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),yh[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),yh[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),yh[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),yh[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),yh[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(yh),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const yh=[new We,new We,new We,new We,new We,new We,new We,new We],ou=new We,L3=new Su,Hv=new We,jv=new We,$v=new We,Gf=new We,Hf=new We,Gm=new We,bx=new We,k3=new We,D3=new We,Hm=new We;function UR(n,e,i,a,s){for(let l=0,d=n.length-3;l<=d;l+=3){Hm.fromArray(n,l);const f=s.x*Math.abs(Hm.x)+s.y*Math.abs(Hm.y)+s.z*Math.abs(Hm.z),p=e.dot(Hm),y=i.dot(Hm),_=a.dot(Hm);if(Math.max(-Math.max(p,y,_),Math.min(p,y,_))>f)return!1}return!0}const fbe=new Su,wx=new We,WR=new We;class Fc{constructor(e=new We,i=-1){this.center=e,this.radius=i}set(e,i){return this.center.copy(e),this.radius=i,this}setFromPoints(e,i){const a=this.center;i!==void 0?a.copy(i):fbe.setFromPoints(e).getCenter(a);let s=0;for(let l=0,d=e.length;l<d;l++)s=Math.max(s,a.distanceToSquared(e[l]));return this.radius=Math.sqrt(s),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const i=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=i*i}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,i){const a=this.center.distanceToSquared(e);return i.copy(e),a>this.radius*this.radius&&(i.sub(this.center).normalize(),i.multiplyScalar(this.radius).add(this.center)),i}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;wx.subVectors(e,this.center);const i=wx.lengthSq();if(i>this.radius*this.radius){const a=Math.sqrt(i),s=(a-this.radius)*.5;this.center.addScaledVector(wx,s/a),this.radius+=s}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(WR.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(wx.copy(e.center).add(WR)),this.expandByPoint(wx.copy(e.center).sub(WR))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}}const vh=new We,VR=new We,z3=new We,jf=new We,GR=new We,O3=new We,HR=new We;class iy{constructor(e=new We,i=new We(0,0,-1)){this.origin=e,this.direction=i}set(e,i){return this.origin.copy(e),this.direction.copy(i),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,i){return i.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,vh)),this}closestPointToPoint(e,i){i.subVectors(e,this.origin);const a=i.dot(this.direction);return a<0?i.copy(this.origin):i.copy(this.origin).addScaledVector(this.direction,a)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const i=vh.subVectors(e,this.origin).dot(this.direction);return i<0?this.origin.distanceToSquared(e):(vh.copy(this.origin).addScaledVector(this.direction,i),vh.distanceToSquared(e))}distanceSqToSegment(e,i,a,s){VR.copy(e).add(i).multiplyScalar(.5),z3.copy(i).sub(e).normalize(),jf.copy(this.origin).sub(VR);const l=e.distanceTo(i)*.5,d=-this.direction.dot(z3),f=jf.dot(this.direction),p=-jf.dot(z3),y=jf.lengthSq(),_=Math.abs(1-d*d);let b,S,A,P;if(_>0)if(b=d*p-f,S=d*f-p,P=l*_,b>=0)if(S>=-P)if(S<=P){const L=1/_;b*=L,S*=L,A=b*(b+d*S+2*f)+S*(d*b+S+2*p)+y}else S=l,b=Math.max(0,-(d*S+f)),A=-b*b+S*(S+2*p)+y;else S=-l,b=Math.max(0,-(d*S+f)),A=-b*b+S*(S+2*p)+y;else S<=-P?(b=Math.max(0,-(-d*l+f)),S=b>0?-l:Math.min(Math.max(-l,-p),l),A=-b*b+S*(S+2*p)+y):S<=P?(b=0,S=Math.min(Math.max(-l,-p),l),A=S*(S+2*p)+y):(b=Math.max(0,-(d*l+f)),S=b>0?l:Math.min(Math.max(-l,-p),l),A=-b*b+S*(S+2*p)+y);else S=d>0?-l:l,b=Math.max(0,-(d*S+f)),A=-b*b+S*(S+2*p)+y;return a&&a.copy(this.origin).addScaledVector(this.direction,b),s&&s.copy(VR).addScaledVector(z3,S),A}intersectSphere(e,i){vh.subVectors(e.center,this.origin);const a=vh.dot(this.direction),s=vh.dot(vh)-a*a,l=e.radius*e.radius;if(s>l)return null;const d=Math.sqrt(l-s),f=a-d,p=a+d;return p<0?null:f<0?this.at(p,i):this.at(f,i)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const i=e.normal.dot(this.direction);if(i===0)return e.distanceToPoint(this.origin)===0?0:null;const a=-(this.origin.dot(e.normal)+e.constant)/i;return a>=0?a:null}intersectPlane(e,i){const a=this.distanceToPlane(e);return a===null?null:this.at(a,i)}intersectsPlane(e){const i=e.distanceToPoint(this.origin);return i===0||e.normal.dot(this.direction)*i<0}intersectBox(e,i){let a,s,l,d,f,p;const y=1/this.direction.x,_=1/this.direction.y,b=1/this.direction.z,S=this.origin;return y>=0?(a=(e.min.x-S.x)*y,s=(e.max.x-S.x)*y):(a=(e.max.x-S.x)*y,s=(e.min.x-S.x)*y),_>=0?(l=(e.min.y-S.y)*_,d=(e.max.y-S.y)*_):(l=(e.max.y-S.y)*_,d=(e.min.y-S.y)*_),a>d||l>s||((l>a||isNaN(a))&&(a=l),(d<s||isNaN(s))&&(s=d),b>=0?(f=(e.min.z-S.z)*b,p=(e.max.z-S.z)*b):(f=(e.max.z-S.z)*b,p=(e.min.z-S.z)*b),a>p||f>s)||((f>a||a!==a)&&(a=f),(p<s||s!==s)&&(s=p),s<0)?null:this.at(a>=0?a:s,i)}intersectsBox(e){return this.intersectBox(e,vh)!==null}intersectTriangle(e,i,a,s,l){GR.subVectors(i,e),O3.subVectors(a,e),HR.crossVectors(GR,O3);let d=this.direction.dot(HR),f;if(d>0){if(s)return null;f=1}else if(d<0)f=-1,d=-d;else return null;jf.subVectors(this.origin,e);const p=f*this.direction.dot(O3.crossVectors(jf,O3));if(p<0)return null;const y=f*this.direction.dot(GR.cross(jf));if(y<0||p+y>d)return null;const _=-f*jf.dot(HR);return _<0?null:this.at(_/d,l)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class Di{constructor(e,i,a,s,l,d,f,p,y,_,b,S,A,P,L,k){Di.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,i,a,s,l,d,f,p,y,_,b,S,A,P,L,k)}set(e,i,a,s,l,d,f,p,y,_,b,S,A,P,L,k){const R=this.elements;return R[0]=e,R[4]=i,R[8]=a,R[12]=s,R[1]=l,R[5]=d,R[9]=f,R[13]=p,R[2]=y,R[6]=_,R[10]=b,R[14]=S,R[3]=A,R[7]=P,R[11]=L,R[15]=k,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new Di().fromArray(this.elements)}copy(e){const i=this.elements,a=e.elements;return i[0]=a[0],i[1]=a[1],i[2]=a[2],i[3]=a[3],i[4]=a[4],i[5]=a[5],i[6]=a[6],i[7]=a[7],i[8]=a[8],i[9]=a[9],i[10]=a[10],i[11]=a[11],i[12]=a[12],i[13]=a[13],i[14]=a[14],i[15]=a[15],this}copyPosition(e){const i=this.elements,a=e.elements;return i[12]=a[12],i[13]=a[13],i[14]=a[14],this}setFromMatrix3(e){const i=e.elements;return this.set(i[0],i[3],i[6],0,i[1],i[4],i[7],0,i[2],i[5],i[8],0,0,0,0,1),this}extractBasis(e,i,a){return e.setFromMatrixColumn(this,0),i.setFromMatrixColumn(this,1),a.setFromMatrixColumn(this,2),this}makeBasis(e,i,a){return this.set(e.x,i.x,a.x,0,e.y,i.y,a.y,0,e.z,i.z,a.z,0,0,0,0,1),this}extractRotation(e){const i=this.elements,a=e.elements,s=1/Yv.setFromMatrixColumn(e,0).length(),l=1/Yv.setFromMatrixColumn(e,1).length(),d=1/Yv.setFromMatrixColumn(e,2).length();return i[0]=a[0]*s,i[1]=a[1]*s,i[2]=a[2]*s,i[3]=0,i[4]=a[4]*l,i[5]=a[5]*l,i[6]=a[6]*l,i[7]=0,i[8]=a[8]*d,i[9]=a[9]*d,i[10]=a[10]*d,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,this}makeRotationFromEuler(e){const i=this.elements,a=e.x,s=e.y,l=e.z,d=Math.cos(a),f=Math.sin(a),p=Math.cos(s),y=Math.sin(s),_=Math.cos(l),b=Math.sin(l);if(e.order==="XYZ"){const S=d*_,A=d*b,P=f*_,L=f*b;i[0]=p*_,i[4]=-p*b,i[8]=y,i[1]=A+P*y,i[5]=S-L*y,i[9]=-f*p,i[2]=L-S*y,i[6]=P+A*y,i[10]=d*p}else if(e.order==="YXZ"){const S=p*_,A=p*b,P=y*_,L=y*b;i[0]=S+L*f,i[4]=P*f-A,i[8]=d*y,i[1]=d*b,i[5]=d*_,i[9]=-f,i[2]=A*f-P,i[6]=L+S*f,i[10]=d*p}else if(e.order==="ZXY"){const S=p*_,A=p*b,P=y*_,L=y*b;i[0]=S-L*f,i[4]=-d*b,i[8]=P+A*f,i[1]=A+P*f,i[5]=d*_,i[9]=L-S*f,i[2]=-d*y,i[6]=f,i[10]=d*p}else if(e.order==="ZYX"){const S=d*_,A=d*b,P=f*_,L=f*b;i[0]=p*_,i[4]=P*y-A,i[8]=S*y+L,i[1]=p*b,i[5]=L*y+S,i[9]=A*y-P,i[2]=-y,i[6]=f*p,i[10]=d*p}else if(e.order==="YZX"){const S=d*p,A=d*y,P=f*p,L=f*y;i[0]=p*_,i[4]=L-S*b,i[8]=P*b+A,i[1]=b,i[5]=d*_,i[9]=-f*_,i[2]=-y*_,i[6]=A*b+P,i[10]=S-L*b}else if(e.order==="XZY"){const S=d*p,A=d*y,P=f*p,L=f*y;i[0]=p*_,i[4]=-b,i[8]=y*_,i[1]=S*b+L,i[5]=d*_,i[9]=A*b-P,i[2]=P*b-A,i[6]=f*_,i[10]=L*b+S}return i[3]=0,i[7]=0,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,this}makeRotationFromQuaternion(e){return this.compose(pbe,e,mbe)}lookAt(e,i,a){const s=this.elements;return Gl.subVectors(e,i),Gl.lengthSq()===0&&(Gl.z=1),Gl.normalize(),$f.crossVectors(a,Gl),$f.lengthSq()===0&&(Math.abs(a.z)===1?Gl.x+=1e-4:Gl.z+=1e-4,Gl.normalize(),$f.crossVectors(a,Gl)),$f.normalize(),N3.crossVectors(Gl,$f),s[0]=$f.x,s[4]=N3.x,s[8]=Gl.x,s[1]=$f.y,s[5]=N3.y,s[9]=Gl.y,s[2]=$f.z,s[6]=N3.z,s[10]=Gl.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,i){const a=e.elements,s=i.elements,l=this.elements,d=a[0],f=a[4],p=a[8],y=a[12],_=a[1],b=a[5],S=a[9],A=a[13],P=a[2],L=a[6],k=a[10],R=a[14],z=a[3],O=a[7],F=a[11],H=a[15],$=s[0],Y=s[4],te=s[8],G=s[12],Q=s[1],he=s[5],pe=s[9],ye=s[13],fe=s[2],Ae=s[6],Re=s[10],Be=s[14],le=s[3],me=s[7],we=s[11],re=s[15];return l[0]=d*$+f*Q+p*fe+y*le,l[4]=d*Y+f*he+p*Ae+y*me,l[8]=d*te+f*pe+p*Re+y*we,l[12]=d*G+f*ye+p*Be+y*re,l[1]=_*$+b*Q+S*fe+A*le,l[5]=_*Y+b*he+S*Ae+A*me,l[9]=_*te+b*pe+S*Re+A*we,l[13]=_*G+b*ye+S*Be+A*re,l[2]=P*$+L*Q+k*fe+R*le,l[6]=P*Y+L*he+k*Ae+R*me,l[10]=P*te+L*pe+k*Re+R*we,l[14]=P*G+L*ye+k*Be+R*re,l[3]=z*$+O*Q+F*fe+H*le,l[7]=z*Y+O*he+F*Ae+H*me,l[11]=z*te+O*pe+F*Re+H*we,l[15]=z*G+O*ye+F*Be+H*re,this}multiplyScalar(e){const i=this.elements;return i[0]*=e,i[4]*=e,i[8]*=e,i[12]*=e,i[1]*=e,i[5]*=e,i[9]*=e,i[13]*=e,i[2]*=e,i[6]*=e,i[10]*=e,i[14]*=e,i[3]*=e,i[7]*=e,i[11]*=e,i[15]*=e,this}determinant(){const e=this.elements,i=e[0],a=e[4],s=e[8],l=e[12],d=e[1],f=e[5],p=e[9],y=e[13],_=e[2],b=e[6],S=e[10],A=e[14],P=e[3],L=e[7],k=e[11],R=e[15];return P*(+l*p*b-s*y*b-l*f*S+a*y*S+s*f*A-a*p*A)+L*(+i*p*A-i*y*S+l*d*S-s*d*A+s*y*_-l*p*_)+k*(+i*y*b-i*f*A-l*d*b+a*d*A+l*f*_-a*y*_)+R*(-s*f*_-i*p*b+i*f*S+s*d*b-a*d*S+a*p*_)}transpose(){const e=this.elements;let i;return i=e[1],e[1]=e[4],e[4]=i,i=e[2],e[2]=e[8],e[8]=i,i=e[6],e[6]=e[9],e[9]=i,i=e[3],e[3]=e[12],e[12]=i,i=e[7],e[7]=e[13],e[13]=i,i=e[11],e[11]=e[14],e[14]=i,this}setPosition(e,i,a){const s=this.elements;return e.isVector3?(s[12]=e.x,s[13]=e.y,s[14]=e.z):(s[12]=e,s[13]=i,s[14]=a),this}invert(){const e=this.elements,i=e[0],a=e[1],s=e[2],l=e[3],d=e[4],f=e[5],p=e[6],y=e[7],_=e[8],b=e[9],S=e[10],A=e[11],P=e[12],L=e[13],k=e[14],R=e[15],z=b*k*y-L*S*y+L*p*A-f*k*A-b*p*R+f*S*R,O=P*S*y-_*k*y-P*p*A+d*k*A+_*p*R-d*S*R,F=_*L*y-P*b*y+P*f*A-d*L*A-_*f*R+d*b*R,H=P*b*p-_*L*p-P*f*S+d*L*S+_*f*k-d*b*k,$=i*z+a*O+s*F+l*H;if($===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const Y=1/$;return e[0]=z*Y,e[1]=(L*S*l-b*k*l-L*s*A+a*k*A+b*s*R-a*S*R)*Y,e[2]=(f*k*l-L*p*l+L*s*y-a*k*y-f*s*R+a*p*R)*Y,e[3]=(b*p*l-f*S*l-b*s*y+a*S*y+f*s*A-a*p*A)*Y,e[4]=O*Y,e[5]=(_*k*l-P*S*l+P*s*A-i*k*A-_*s*R+i*S*R)*Y,e[6]=(P*p*l-d*k*l-P*s*y+i*k*y+d*s*R-i*p*R)*Y,e[7]=(d*S*l-_*p*l+_*s*y-i*S*y-d*s*A+i*p*A)*Y,e[8]=F*Y,e[9]=(P*b*l-_*L*l-P*a*A+i*L*A+_*a*R-i*b*R)*Y,e[10]=(d*L*l-P*f*l+P*a*y-i*L*y-d*a*R+i*f*R)*Y,e[11]=(_*f*l-d*b*l-_*a*y+i*b*y+d*a*A-i*f*A)*Y,e[12]=H*Y,e[13]=(_*L*s-P*b*s+P*a*S-i*L*S-_*a*k+i*b*k)*Y,e[14]=(P*f*s-d*L*s-P*a*p+i*L*p+d*a*k-i*f*k)*Y,e[15]=(d*b*s-_*f*s+_*a*p-i*b*p-d*a*S+i*f*S)*Y,this}scale(e){const i=this.elements,a=e.x,s=e.y,l=e.z;return i[0]*=a,i[4]*=s,i[8]*=l,i[1]*=a,i[5]*=s,i[9]*=l,i[2]*=a,i[6]*=s,i[10]*=l,i[3]*=a,i[7]*=s,i[11]*=l,this}getMaxScaleOnAxis(){const e=this.elements,i=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],a=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],s=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(i,a,s))}makeTranslation(e,i,a){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,i,0,0,1,a,0,0,0,1),this}makeRotationX(e){const i=Math.cos(e),a=Math.sin(e);return this.set(1,0,0,0,0,i,-a,0,0,a,i,0,0,0,0,1),this}makeRotationY(e){const i=Math.cos(e),a=Math.sin(e);return this.set(i,0,a,0,0,1,0,0,-a,0,i,0,0,0,0,1),this}makeRotationZ(e){const i=Math.cos(e),a=Math.sin(e);return this.set(i,-a,0,0,a,i,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,i){const a=Math.cos(i),s=Math.sin(i),l=1-a,d=e.x,f=e.y,p=e.z,y=l*d,_=l*f;return this.set(y*d+a,y*f-s*p,y*p+s*f,0,y*f+s*p,_*f+a,_*p-s*d,0,y*p-s*f,_*p+s*d,l*p*p+a,0,0,0,0,1),this}makeScale(e,i,a){return this.set(e,0,0,0,0,i,0,0,0,0,a,0,0,0,0,1),this}makeShear(e,i,a,s,l,d){return this.set(1,a,l,0,e,1,d,0,i,s,1,0,0,0,0,1),this}compose(e,i,a){const s=this.elements,l=i._x,d=i._y,f=i._z,p=i._w,y=l+l,_=d+d,b=f+f,S=l*y,A=l*_,P=l*b,L=d*_,k=d*b,R=f*b,z=p*y,O=p*_,F=p*b,H=a.x,$=a.y,Y=a.z;return s[0]=(1-(L+R))*H,s[1]=(A+F)*H,s[2]=(P-O)*H,s[3]=0,s[4]=(A-F)*$,s[5]=(1-(S+R))*$,s[6]=(k+z)*$,s[7]=0,s[8]=(P+O)*Y,s[9]=(k-z)*Y,s[10]=(1-(S+L))*Y,s[11]=0,s[12]=e.x,s[13]=e.y,s[14]=e.z,s[15]=1,this}decompose(e,i,a){const s=this.elements;let l=Yv.set(s[0],s[1],s[2]).length();const d=Yv.set(s[4],s[5],s[6]).length(),f=Yv.set(s[8],s[9],s[10]).length();this.determinant()<0&&(l=-l),e.x=s[12],e.y=s[13],e.z=s[14],su.copy(this);const y=1/l,_=1/d,b=1/f;return su.elements[0]*=y,su.elements[1]*=y,su.elements[2]*=y,su.elements[4]*=_,su.elements[5]*=_,su.elements[6]*=_,su.elements[8]*=b,su.elements[9]*=b,su.elements[10]*=b,i.setFromRotationMatrix(su),a.x=l,a.y=d,a.z=f,this}makePerspective(e,i,a,s,l,d,f=gd){const p=this.elements,y=2*l/(i-e),_=2*l/(a-s),b=(i+e)/(i-e),S=(a+s)/(a-s);let A,P;if(f===gd)A=-(d+l)/(d-l),P=-2*d*l/(d-l);else if(f===_w)A=-d/(d-l),P=-d*l/(d-l);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+f);return p[0]=y,p[4]=0,p[8]=b,p[12]=0,p[1]=0,p[5]=_,p[9]=S,p[13]=0,p[2]=0,p[6]=0,p[10]=A,p[14]=P,p[3]=0,p[7]=0,p[11]=-1,p[15]=0,this}makeOrthographic(e,i,a,s,l,d,f=gd){const p=this.elements,y=1/(i-e),_=1/(a-s),b=1/(d-l),S=(i+e)*y,A=(a+s)*_;let P,L;if(f===gd)P=(d+l)*b,L=-2*b;else if(f===_w)P=l*b,L=-1*b;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+f);return p[0]=2*y,p[4]=0,p[8]=0,p[12]=-S,p[1]=0,p[5]=2*_,p[9]=0,p[13]=-A,p[2]=0,p[6]=0,p[10]=L,p[14]=-P,p[3]=0,p[7]=0,p[11]=0,p[15]=1,this}equals(e){const i=this.elements,a=e.elements;for(let s=0;s<16;s++)if(i[s]!==a[s])return!1;return!0}fromArray(e,i=0){for(let a=0;a<16;a++)this.elements[a]=e[a+i];return this}toArray(e=[],i=0){const a=this.elements;return e[i]=a[0],e[i+1]=a[1],e[i+2]=a[2],e[i+3]=a[3],e[i+4]=a[4],e[i+5]=a[5],e[i+6]=a[6],e[i+7]=a[7],e[i+8]=a[8],e[i+9]=a[9],e[i+10]=a[10],e[i+11]=a[11],e[i+12]=a[12],e[i+13]=a[13],e[i+14]=a[14],e[i+15]=a[15],e}}const Yv=new We,su=new Di,pbe=new We(0,0,0),mbe=new We(1,1,1),$f=new We,N3=new We,Gl=new We,VV=new Di,GV=new As;class tS{constructor(e=0,i=0,a=0,s=tS.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=i,this._z=a,this._order=s}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,i,a,s=this._order){return this._x=e,this._y=i,this._z=a,this._order=s,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,i=this._order,a=!0){const s=e.elements,l=s[0],d=s[4],f=s[8],p=s[1],y=s[5],_=s[9],b=s[2],S=s[6],A=s[10];switch(i){case"XYZ":this._y=Math.asin(Xa(f,-1,1)),Math.abs(f)<.9999999?(this._x=Math.atan2(-_,A),this._z=Math.atan2(-d,l)):(this._x=Math.atan2(S,y),this._z=0);break;case"YXZ":this._x=Math.asin(-Xa(_,-1,1)),Math.abs(_)<.9999999?(this._y=Math.atan2(f,A),this._z=Math.atan2(p,y)):(this._y=Math.atan2(-b,l),this._z=0);break;case"ZXY":this._x=Math.asin(Xa(S,-1,1)),Math.abs(S)<.9999999?(this._y=Math.atan2(-b,A),this._z=Math.atan2(-d,y)):(this._y=0,this._z=Math.atan2(p,l));break;case"ZYX":this._y=Math.asin(-Xa(b,-1,1)),Math.abs(b)<.9999999?(this._x=Math.atan2(S,A),this._z=Math.atan2(p,l)):(this._x=0,this._z=Math.atan2(-d,y));break;case"YZX":this._z=Math.asin(Xa(p,-1,1)),Math.abs(p)<.9999999?(this._x=Math.atan2(-_,y),this._y=Math.atan2(-b,l)):(this._x=0,this._y=Math.atan2(f,A));break;case"XZY":this._z=Math.asin(-Xa(d,-1,1)),Math.abs(d)<.9999999?(this._x=Math.atan2(S,y),this._y=Math.atan2(f,l)):(this._x=Math.atan2(-_,A),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+i)}return this._order=i,a===!0&&this._onChangeCallback(),this}setFromQuaternion(e,i,a){return VV.makeRotationFromQuaternion(e),this.setFromRotationMatrix(VV,i,a)}setFromVector3(e,i=this._order){return this.set(e.x,e.y,e.z,i)}reorder(e){return GV.setFromEuler(this),this.setFromQuaternion(GV,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],i=0){return e[i]=this._x,e[i+1]=this._y,e[i+2]=this._z,e[i+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}tS.DEFAULT_ORDER="XYZ";class Rg{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let gbe=0;const HV=new We,qv=new As,_h=new Di,F3=new We,Sx=new We,ybe=new We,vbe=new As,jV=new We(1,0,0),$V=new We(0,1,0),YV=new We(0,0,1),_be={type:"added"},xbe={type:"removed"};class br extends Ld{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:gbe++}),this.uuid=tc(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=br.DEFAULT_UP.clone();const e=new We,i=new tS,a=new As,s=new We(1,1,1);function l(){a.setFromEuler(i,!1)}function d(){i.setFromQuaternion(a,void 0,!1)}i._onChange(l),a._onChange(d),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:i},quaternion:{configurable:!0,enumerable:!0,value:a},scale:{configurable:!0,enumerable:!0,value:s},modelViewMatrix:{value:new Di},normalMatrix:{value:new Vi}}),this.matrix=new Di,this.matrixWorld=new Di,this.matrixAutoUpdate=br.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.matrixWorldAutoUpdate=br.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.layers=new Rg,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,i){this.quaternion.setFromAxisAngle(e,i)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,i){return qv.setFromAxisAngle(e,i),this.quaternion.multiply(qv),this}rotateOnWorldAxis(e,i){return qv.setFromAxisAngle(e,i),this.quaternion.premultiply(qv),this}rotateX(e){return this.rotateOnAxis(jV,e)}rotateY(e){return this.rotateOnAxis($V,e)}rotateZ(e){return this.rotateOnAxis(YV,e)}translateOnAxis(e,i){return HV.copy(e).applyQuaternion(this.quaternion),this.position.add(HV.multiplyScalar(i)),this}translateX(e){return this.translateOnAxis(jV,e)}translateY(e){return this.translateOnAxis($V,e)}translateZ(e){return this.translateOnAxis(YV,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(_h.copy(this.matrixWorld).invert())}lookAt(e,i,a){e.isVector3?F3.copy(e):F3.set(e,i,a);const s=this.parent;this.updateWorldMatrix(!0,!1),Sx.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?_h.lookAt(Sx,F3,this.up):_h.lookAt(F3,Sx,this.up),this.quaternion.setFromRotationMatrix(_h),s&&(_h.extractRotation(s.matrixWorld),qv.setFromRotationMatrix(_h),this.quaternion.premultiply(qv.invert()))}add(e){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.add(arguments[i]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.parent!==null&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(_be)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let a=0;a<arguments.length;a++)this.remove(arguments[a]);return this}const i=this.children.indexOf(e);return i!==-1&&(e.parent=null,this.children.splice(i,1),e.dispatchEvent(xbe)),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),_h.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),_h.multiply(e.parent.matrixWorld)),e.applyMatrix4(_h),this.add(e),e.updateWorldMatrix(!1,!0),this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,i){if(this[e]===i)return this;for(let a=0,s=this.children.length;a<s;a++){const d=this.children[a].getObjectByProperty(e,i);if(d!==void 0)return d}}getObjectsByProperty(e,i){let a=[];this[e]===i&&a.push(this);for(let s=0,l=this.children.length;s<l;s++){const d=this.children[s].getObjectsByProperty(e,i);d.length>0&&(a=a.concat(d))}return a}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Sx,e,ybe),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Sx,vbe,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const i=this.matrixWorld.elements;return e.set(i[8],i[9],i[10]).normalize()}raycast(){}traverse(e){e(this);const i=this.children;for(let a=0,s=i.length;a<s;a++)i[a].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const i=this.children;for(let a=0,s=i.length;a<s;a++)i[a].traverseVisible(e)}traverseAncestors(e){const i=this.parent;i!==null&&(e(i),i.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);const i=this.children;for(let a=0,s=i.length;a<s;a++){const l=i[a];(l.matrixWorldAutoUpdate===!0||e===!0)&&l.updateMatrixWorld(e)}}updateWorldMatrix(e,i){const a=this.parent;if(e===!0&&a!==null&&a.matrixWorldAutoUpdate===!0&&a.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),i===!0){const s=this.children;for(let l=0,d=s.length;l<d;l++){const f=s[l];f.matrixWorldAutoUpdate===!0&&f.updateWorldMatrix(!1,!0)}}}toJSON(e){const i=e===void 0||typeof e=="string",a={};i&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},a.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const s={};s.uuid=this.uuid,s.type=this.type,this.name!==""&&(s.name=this.name),this.castShadow===!0&&(s.castShadow=!0),this.receiveShadow===!0&&(s.receiveShadow=!0),this.visible===!1&&(s.visible=!1),this.frustumCulled===!1&&(s.frustumCulled=!1),this.renderOrder!==0&&(s.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(s.userData=this.userData),s.layers=this.layers.mask,s.matrix=this.matrix.toArray(),s.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(s.matrixAutoUpdate=!1),this.isInstancedMesh&&(s.type="InstancedMesh",s.count=this.count,s.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(s.instanceColor=this.instanceColor.toJSON()));function l(f,p){return f[p.uuid]===void 0&&(f[p.uuid]=p.toJSON(e)),p.uuid}if(this.isScene)this.background&&(this.background.isColor?s.background=this.background.toJSON():this.background.isTexture&&(s.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(s.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){s.geometry=l(e.geometries,this.geometry);const f=this.geometry.parameters;if(f!==void 0&&f.shapes!==void 0){const p=f.shapes;if(Array.isArray(p))for(let y=0,_=p.length;y<_;y++){const b=p[y];l(e.shapes,b)}else l(e.shapes,p)}}if(this.isSkinnedMesh&&(s.bindMode=this.bindMode,s.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(l(e.skeletons,this.skeleton),s.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const f=[];for(let p=0,y=this.material.length;p<y;p++)f.push(l(e.materials,this.material[p]));s.material=f}else s.material=l(e.materials,this.material);if(this.children.length>0){s.children=[];for(let f=0;f<this.children.length;f++)s.children.push(this.children[f].toJSON(e).object)}if(this.animations.length>0){s.animations=[];for(let f=0;f<this.animations.length;f++){const p=this.animations[f];s.animations.push(l(e.animations,p))}}if(i){const f=d(e.geometries),p=d(e.materials),y=d(e.textures),_=d(e.images),b=d(e.shapes),S=d(e.skeletons),A=d(e.animations),P=d(e.nodes);f.length>0&&(a.geometries=f),p.length>0&&(a.materials=p),y.length>0&&(a.textures=y),_.length>0&&(a.images=_),b.length>0&&(a.shapes=b),S.length>0&&(a.skeletons=S),A.length>0&&(a.animations=A),P.length>0&&(a.nodes=P)}return a.object=s,a;function d(f){const p=[];for(const y in f){const _=f[y];delete _.metadata,p.push(_)}return p}}clone(e){return new this.constructor().copy(this,e)}copy(e,i=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),i===!0)for(let a=0;a<e.children.length;a++){const s=e.children[a];this.add(s.clone())}return this}}br.DEFAULT_UP=new We(0,1,0);br.DEFAULT_MATRIX_AUTO_UPDATE=!0;br.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const lu=new We,xh=new We,jR=new We,bh=new We,Xv=new We,Zv=new We,qV=new We,$R=new We,YR=new We,qR=new We;let B3=!1;class yl{constructor(e=new We,i=new We,a=new We){this.a=e,this.b=i,this.c=a}static getNormal(e,i,a,s){s.subVectors(a,i),lu.subVectors(e,i),s.cross(lu);const l=s.lengthSq();return l>0?s.multiplyScalar(1/Math.sqrt(l)):s.set(0,0,0)}static getBarycoord(e,i,a,s,l){lu.subVectors(s,i),xh.subVectors(a,i),jR.subVectors(e,i);const d=lu.dot(lu),f=lu.dot(xh),p=lu.dot(jR),y=xh.dot(xh),_=xh.dot(jR),b=d*y-f*f;if(b===0)return l.set(-2,-1,-1);const S=1/b,A=(y*p-f*_)*S,P=(d*_-f*p)*S;return l.set(1-A-P,P,A)}static containsPoint(e,i,a,s){return this.getBarycoord(e,i,a,s,bh),bh.x>=0&&bh.y>=0&&bh.x+bh.y<=1}static getUV(e,i,a,s,l,d,f,p){return B3===!1&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),B3=!0),this.getInterpolation(e,i,a,s,l,d,f,p)}static getInterpolation(e,i,a,s,l,d,f,p){return this.getBarycoord(e,i,a,s,bh),p.setScalar(0),p.addScaledVector(l,bh.x),p.addScaledVector(d,bh.y),p.addScaledVector(f,bh.z),p}static isFrontFacing(e,i,a,s){return lu.subVectors(a,i),xh.subVectors(e,i),lu.cross(xh).dot(s)<0}set(e,i,a){return this.a.copy(e),this.b.copy(i),this.c.copy(a),this}setFromPointsAndIndices(e,i,a,s){return this.a.copy(e[i]),this.b.copy(e[a]),this.c.copy(e[s]),this}setFromAttributeAndIndices(e,i,a,s){return this.a.fromBufferAttribute(e,i),this.b.fromBufferAttribute(e,a),this.c.fromBufferAttribute(e,s),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return lu.subVectors(this.c,this.b),xh.subVectors(this.a,this.b),lu.cross(xh).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return yl.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,i){return yl.getBarycoord(e,this.a,this.b,this.c,i)}getUV(e,i,a,s,l){return B3===!1&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),B3=!0),yl.getInterpolation(e,this.a,this.b,this.c,i,a,s,l)}getInterpolation(e,i,a,s,l){return yl.getInterpolation(e,this.a,this.b,this.c,i,a,s,l)}containsPoint(e){return yl.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return yl.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,i){const a=this.a,s=this.b,l=this.c;let d,f;Xv.subVectors(s,a),Zv.subVectors(l,a),$R.subVectors(e,a);const p=Xv.dot($R),y=Zv.dot($R);if(p<=0&&y<=0)return i.copy(a);YR.subVectors(e,s);const _=Xv.dot(YR),b=Zv.dot(YR);if(_>=0&&b<=_)return i.copy(s);const S=p*b-_*y;if(S<=0&&p>=0&&_<=0)return d=p/(p-_),i.copy(a).addScaledVector(Xv,d);qR.subVectors(e,l);const A=Xv.dot(qR),P=Zv.dot(qR);if(P>=0&&A<=P)return i.copy(l);const L=A*y-p*P;if(L<=0&&y>=0&&P<=0)return f=y/(y-P),i.copy(a).addScaledVector(Zv,f);const k=_*P-A*b;if(k<=0&&b-_>=0&&A-P>=0)return qV.subVectors(l,s),f=(b-_)/(b-_+(A-P)),i.copy(s).addScaledVector(qV,f);const R=1/(k+L+S);return d=L*R,f=S*R,i.copy(a).addScaledVector(Xv,d).addScaledVector(Zv,f)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}const LZ={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Yf={h:0,s:0,l:0},U3={h:0,s:0,l:0};function XR(n,e,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?n+(e-n)*6*i:i<1/2?e:i<2/3?n+(e-n)*6*(2/3-i):n}let In=class{constructor(e,i,a){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,i,a)}set(e,i,a){if(i===void 0&&a===void 0){const s=e;s&&s.isColor?this.copy(s):typeof s=="number"?this.setHex(s):typeof s=="string"&&this.setStyle(s)}else this.setRGB(e,i,a);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,i=Lo){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,Vr.toWorkingColorSpace(this,i),this}setRGB(e,i,a,s=Vr.workingColorSpace){return this.r=e,this.g=i,this.b=a,Vr.toWorkingColorSpace(this,s),this}setHSL(e,i,a,s=Vr.workingColorSpace){if(e=bz(e,1),i=Xa(i,0,1),a=Xa(a,0,1),i===0)this.r=this.g=this.b=a;else{const l=a<=.5?a*(1+i):a+i-a*i,d=2*a-l;this.r=XR(d,l,e+1/3),this.g=XR(d,l,e),this.b=XR(d,l,e-1/3)}return Vr.toWorkingColorSpace(this,s),this}setStyle(e,i=Lo){function a(l){l!==void 0&&parseFloat(l)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let s;if(s=/^(\w+)\(([^\)]*)\)/.exec(e)){let l;const d=s[1],f=s[2];switch(d){case"rgb":case"rgba":if(l=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(f))return a(l[4]),this.setRGB(Math.min(255,parseInt(l[1],10))/255,Math.min(255,parseInt(l[2],10))/255,Math.min(255,parseInt(l[3],10))/255,i);if(l=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(f))return a(l[4]),this.setRGB(Math.min(100,parseInt(l[1],10))/100,Math.min(100,parseInt(l[2],10))/100,Math.min(100,parseInt(l[3],10))/100,i);break;case"hsl":case"hsla":if(l=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(f))return a(l[4]),this.setHSL(parseFloat(l[1])/360,parseFloat(l[2])/100,parseFloat(l[3])/100,i);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(s=/^\#([A-Fa-f\d]+)$/.exec(e)){const l=s[1],d=l.length;if(d===3)return this.setRGB(parseInt(l.charAt(0),16)/15,parseInt(l.charAt(1),16)/15,parseInt(l.charAt(2),16)/15,i);if(d===6)return this.setHex(parseInt(l,16),i);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,i);return this}setColorName(e,i=Lo){const a=LZ[e.toLowerCase()];return a!==void 0?this.setHex(a,i):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=K0(e.r),this.g=K0(e.g),this.b=K0(e.b),this}copyLinearToSRGB(e){return this.r=NR(e.r),this.g=NR(e.g),this.b=NR(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=Lo){return Vr.fromWorkingColorSpace(_s.copy(this),e),Math.round(Xa(_s.r*255,0,255))*65536+Math.round(Xa(_s.g*255,0,255))*256+Math.round(Xa(_s.b*255,0,255))}getHexString(e=Lo){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,i=Vr.workingColorSpace){Vr.fromWorkingColorSpace(_s.copy(this),i);const a=_s.r,s=_s.g,l=_s.b,d=Math.max(a,s,l),f=Math.min(a,s,l);let p,y;const _=(f+d)/2;if(f===d)p=0,y=0;else{const b=d-f;switch(y=_<=.5?b/(d+f):b/(2-d-f),d){case a:p=(s-l)/b+(s<l?6:0);break;case s:p=(l-a)/b+2;break;case l:p=(a-s)/b+4;break}p/=6}return e.h=p,e.s=y,e.l=_,e}getRGB(e,i=Vr.workingColorSpace){return Vr.fromWorkingColorSpace(_s.copy(this),i),e.r=_s.r,e.g=_s.g,e.b=_s.b,e}getStyle(e=Lo){Vr.fromWorkingColorSpace(_s.copy(this),e);const i=_s.r,a=_s.g,s=_s.b;return e!==Lo?`color(${e} ${i.toFixed(3)} ${a.toFixed(3)} ${s.toFixed(3)})`:`rgb(${Math.round(i*255)},${Math.round(a*255)},${Math.round(s*255)})`}offsetHSL(e,i,a){return this.getHSL(Yf),this.setHSL(Yf.h+e,Yf.s+i,Yf.l+a)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,i){return this.r=e.r+i.r,this.g=e.g+i.g,this.b=e.b+i.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,i){return this.r+=(e.r-this.r)*i,this.g+=(e.g-this.g)*i,this.b+=(e.b-this.b)*i,this}lerpColors(e,i,a){return this.r=e.r+(i.r-e.r)*a,this.g=e.g+(i.g-e.g)*a,this.b=e.b+(i.b-e.b)*a,this}lerpHSL(e,i){this.getHSL(Yf),e.getHSL(U3);const a=xb(Yf.h,U3.h,i),s=xb(Yf.s,U3.s,i),l=xb(Yf.l,U3.l,i);return this.setHSL(a,s,l),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const i=this.r,a=this.g,s=this.b,l=e.elements;return this.r=l[0]*i+l[3]*a+l[6]*s,this.g=l[1]*i+l[4]*a+l[7]*s,this.b=l[2]*i+l[5]*a+l[8]*s,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,i=0){return this.r=e[i],this.g=e[i+1],this.b=e[i+2],this}toArray(e=[],i=0){return e[i]=this.r,e[i+1]=this.g,e[i+2]=this.b,e}fromBufferAttribute(e,i){return this.r=e.getX(i),this.g=e.getY(i),this.b=e.getZ(i),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}};const _s=new In;In.NAMES=LZ;let bbe=0;class rs extends Ld{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:bbe++}),this.uuid=tc(),this.name="",this.type="Material",this.blending=Pg,this.side=Ad,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=fT,this.blendDst=pT,this.blendEquation=tp,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new In(0,0,0),this.blendAlpha=0,this.depthFunc=sw,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=B5,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=cg,this.stencilZFail=cg,this.stencilZPass=cg,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const i in e){const a=e[i];if(a===void 0){console.warn(`THREE.Material: parameter '${i}' has value of undefined.`);continue}const s=this[i];if(s===void 0){console.warn(`THREE.Material: '${i}' is not a property of THREE.${this.type}.`);continue}s&&s.isColor?s.set(a):s&&s.isVector3&&a&&a.isVector3?s.copy(a):this[i]=a}}toJSON(e){const i=e===void 0||typeof e=="string";i&&(e={textures:{},images:{}});const a={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};a.uuid=this.uuid,a.type=this.type,this.name!==""&&(a.name=this.name),this.color&&this.color.isColor&&(a.color=this.color.getHex()),this.roughness!==void 0&&(a.roughness=this.roughness),this.metalness!==void 0&&(a.metalness=this.metalness),this.sheen!==void 0&&(a.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(a.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(a.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(a.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(a.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(a.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(a.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(a.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(a.shininess=this.shininess),this.clearcoat!==void 0&&(a.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(a.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(a.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(a.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(a.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,a.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.iridescence!==void 0&&(a.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(a.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(a.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(a.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(a.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(a.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(a.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(a.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(a.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(a.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(a.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(a.lightMap=this.lightMap.toJSON(e).uuid,a.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(a.aoMap=this.aoMap.toJSON(e).uuid,a.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(a.bumpMap=this.bumpMap.toJSON(e).uuid,a.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(a.normalMap=this.normalMap.toJSON(e).uuid,a.normalMapType=this.normalMapType,a.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(a.displacementMap=this.displacementMap.toJSON(e).uuid,a.displacementScale=this.displacementScale,a.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(a.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(a.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(a.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(a.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(a.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(a.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(a.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(a.combine=this.combine)),this.envMapIntensity!==void 0&&(a.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(a.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(a.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(a.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(a.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(a.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(a.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(a.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(a.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(a.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(a.size=this.size),this.shadowSide!==null&&(a.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(a.sizeAttenuation=this.sizeAttenuation),this.blending!==Pg&&(a.blending=this.blending),this.side!==Ad&&(a.side=this.side),this.vertexColors===!0&&(a.vertexColors=!0),this.opacity<1&&(a.opacity=this.opacity),this.transparent===!0&&(a.transparent=!0),this.blendSrc!==fT&&(a.blendSrc=this.blendSrc),this.blendDst!==pT&&(a.blendDst=this.blendDst),this.blendEquation!==tp&&(a.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(a.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(a.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(a.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(a.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(a.blendAlpha=this.blendAlpha),this.depthFunc!==sw&&(a.depthFunc=this.depthFunc),this.depthTest===!1&&(a.depthTest=this.depthTest),this.depthWrite===!1&&(a.depthWrite=this.depthWrite),this.colorWrite===!1&&(a.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(a.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==B5&&(a.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(a.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(a.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==cg&&(a.stencilFail=this.stencilFail),this.stencilZFail!==cg&&(a.stencilZFail=this.stencilZFail),this.stencilZPass!==cg&&(a.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(a.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(a.rotation=this.rotation),this.polygonOffset===!0&&(a.polygonOffset=!0),this.polygonOffsetFactor!==0&&(a.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(a.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(a.linewidth=this.linewidth),this.dashSize!==void 0&&(a.dashSize=this.dashSize),this.gapSize!==void 0&&(a.gapSize=this.gapSize),this.scale!==void 0&&(a.scale=this.scale),this.dithering===!0&&(a.dithering=!0),this.alphaTest>0&&(a.alphaTest=this.alphaTest),this.alphaHash===!0&&(a.alphaHash=!0),this.alphaToCoverage===!0&&(a.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(a.premultipliedAlpha=!0),this.forceSinglePass===!0&&(a.forceSinglePass=!0),this.wireframe===!0&&(a.wireframe=!0),this.wireframeLinewidth>1&&(a.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(a.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(a.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(a.flatShading=!0),this.visible===!1&&(a.visible=!1),this.toneMapped===!1&&(a.toneMapped=!1),this.fog===!1&&(a.fog=!1),Object.keys(this.userData).length>0&&(a.userData=this.userData);function s(l){const d=[];for(const f in l){const p=l[f];delete p.metadata,d.push(p)}return d}if(i){const l=s(e.textures),d=s(e.images);l.length>0&&(a.textures=l),d.length>0&&(a.images=d)}return a}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const i=e.clippingPlanes;let a=null;if(i!==null){const s=i.length;a=new Array(s);for(let l=0;l!==s;++l)a[l]=i[l].clone()}return this.clippingPlanes=a,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}}class Kh extends rs{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new In(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Qw,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const Lh=wbe();function wbe(){const n=new ArrayBuffer(4),e=new Float32Array(n),i=new Uint32Array(n),a=new Uint32Array(512),s=new Uint32Array(512);for(let p=0;p<256;++p){const y=p-127;y<-27?(a[p]=0,a[p|256]=32768,s[p]=24,s[p|256]=24):y<-14?(a[p]=1024>>-y-14,a[p|256]=1024>>-y-14|32768,s[p]=-y-1,s[p|256]=-y-1):y<=15?(a[p]=y+15<<10,a[p|256]=y+15<<10|32768,s[p]=13,s[p|256]=13):y<128?(a[p]=31744,a[p|256]=64512,s[p]=24,s[p|256]=24):(a[p]=31744,a[p|256]=64512,s[p]=13,s[p|256]=13)}const l=new Uint32Array(2048),d=new Uint32Array(64),f=new Uint32Array(64);for(let p=1;p<1024;++p){let y=p<<13,_=0;for(;!(y&8388608);)y<<=1,_-=8388608;y&=-8388609,_+=947912704,l[p]=y|_}for(let p=1024;p<2048;++p)l[p]=939524096+(p-1024<<13);for(let p=1;p<31;++p)d[p]=p<<23;d[31]=1199570944,d[32]=2147483648;for(let p=33;p<63;++p)d[p]=2147483648+(p-32<<23);d[63]=3347054592;for(let p=1;p<64;++p)p!==32&&(f[p]=1024);return{floatView:e,uint32View:i,baseTable:a,shiftTable:s,mantissaTable:l,exponentTable:d,offsetTable:f}}function ml(n){Math.abs(n)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),n=Xa(n,-65504,65504),Lh.floatView[0]=n;const e=Lh.uint32View[0],i=e>>23&511;return Lh.baseTable[i]+((e&8388607)>>Lh.shiftTable[i])}function Yx(n){const e=n>>10;return Lh.uint32View[0]=Lh.mantissaTable[Lh.offsetTable[e]+(n&1023)]+Lh.exponentTable[e],Lh.floatView[0]}const Sbe={toHalfFloat:ml,fromHalfFloat:Yx},bo=new We,W3=new tn;class Qr{constructor(e,i,a=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=i,this.count=e!==void 0?e.length/i:0,this.normalized=a,this.usage=vw,this.updateRange={offset:0,count:-1},this.gpuType=md,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,i,a){e*=this.itemSize,a*=i.itemSize;for(let s=0,l=this.itemSize;s<l;s++)this.array[e+s]=i.array[a+s];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let i=0,a=this.count;i<a;i++)W3.fromBufferAttribute(this,i),W3.applyMatrix3(e),this.setXY(i,W3.x,W3.y);else if(this.itemSize===3)for(let i=0,a=this.count;i<a;i++)bo.fromBufferAttribute(this,i),bo.applyMatrix3(e),this.setXYZ(i,bo.x,bo.y,bo.z);return this}applyMatrix4(e){for(let i=0,a=this.count;i<a;i++)bo.fromBufferAttribute(this,i),bo.applyMatrix4(e),this.setXYZ(i,bo.x,bo.y,bo.z);return this}applyNormalMatrix(e){for(let i=0,a=this.count;i<a;i++)bo.fromBufferAttribute(this,i),bo.applyNormalMatrix(e),this.setXYZ(i,bo.x,bo.y,bo.z);return this}transformDirection(e){for(let i=0,a=this.count;i<a;i++)bo.fromBufferAttribute(this,i),bo.transformDirection(e),this.setXYZ(i,bo.x,bo.y,bo.z);return this}set(e,i=0){return this.array.set(e,i),this}getComponent(e,i){let a=this.array[e*this.itemSize+i];return this.normalized&&(a=_l(a,this.array)),a}setComponent(e,i,a){return this.normalized&&(a=Gi(a,this.array)),this.array[e*this.itemSize+i]=a,this}getX(e){let i=this.array[e*this.itemSize];return this.normalized&&(i=_l(i,this.array)),i}setX(e,i){return this.normalized&&(i=Gi(i,this.array)),this.array[e*this.itemSize]=i,this}getY(e){let i=this.array[e*this.itemSize+1];return this.normalized&&(i=_l(i,this.array)),i}setY(e,i){return this.normalized&&(i=Gi(i,this.array)),this.array[e*this.itemSize+1]=i,this}getZ(e){let i=this.array[e*this.itemSize+2];return this.normalized&&(i=_l(i,this.array)),i}setZ(e,i){return this.normalized&&(i=Gi(i,this.array)),this.array[e*this.itemSize+2]=i,this}getW(e){let i=this.array[e*this.itemSize+3];return this.normalized&&(i=_l(i,this.array)),i}setW(e,i){return this.normalized&&(i=Gi(i,this.array)),this.array[e*this.itemSize+3]=i,this}setXY(e,i,a){return e*=this.itemSize,this.normalized&&(i=Gi(i,this.array),a=Gi(a,this.array)),this.array[e+0]=i,this.array[e+1]=a,this}setXYZ(e,i,a,s){return e*=this.itemSize,this.normalized&&(i=Gi(i,this.array),a=Gi(a,this.array),s=Gi(s,this.array)),this.array[e+0]=i,this.array[e+1]=a,this.array[e+2]=s,this}setXYZW(e,i,a,s,l){return e*=this.itemSize,this.normalized&&(i=Gi(i,this.array),a=Gi(a,this.array),s=Gi(s,this.array),l=Gi(l,this.array)),this.array[e+0]=i,this.array[e+1]=a,this.array[e+2]=s,this.array[e+3]=l,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==vw&&(e.usage=this.usage),(this.updateRange.offset!==0||this.updateRange.count!==-1)&&(e.updateRange=this.updateRange),e}}class Ebe extends Qr{constructor(e,i,a){super(new Int8Array(e),i,a)}}class Mbe extends Qr{constructor(e,i,a){super(new Uint8Array(e),i,a)}}class Tbe extends Qr{constructor(e,i,a){super(new Uint8ClampedArray(e),i,a)}}class Abe extends Qr{constructor(e,i,a){super(new Int16Array(e),i,a)}}class Ez extends Qr{constructor(e,i,a){super(new Uint16Array(e),i,a)}}class Cbe extends Qr{constructor(e,i,a){super(new Int32Array(e),i,a)}}class Mz extends Qr{constructor(e,i,a){super(new Uint32Array(e),i,a)}}class Pbe extends Qr{constructor(e,i,a){super(new Uint16Array(e),i,a),this.isFloat16BufferAttribute=!0}getX(e){let i=Yx(this.array[e*this.itemSize]);return this.normalized&&(i=_l(i,this.array)),i}setX(e,i){return this.normalized&&(i=Gi(i,this.array)),this.array[e*this.itemSize]=ml(i),this}getY(e){let i=Yx(this.array[e*this.itemSize+1]);return this.normalized&&(i=_l(i,this.array)),i}setY(e,i){return this.normalized&&(i=Gi(i,this.array)),this.array[e*this.itemSize+1]=ml(i),this}getZ(e){let i=Yx(this.array[e*this.itemSize+2]);return this.normalized&&(i=_l(i,this.array)),i}setZ(e,i){return this.normalized&&(i=Gi(i,this.array)),this.array[e*this.itemSize+2]=ml(i),this}getW(e){let i=Yx(this.array[e*this.itemSize+3]);return this.normalized&&(i=_l(i,this.array)),i}setW(e,i){return this.normalized&&(i=Gi(i,this.array)),this.array[e*this.itemSize+3]=ml(i),this}setXY(e,i,a){return e*=this.itemSize,this.normalized&&(i=Gi(i,this.array),a=Gi(a,this.array)),this.array[e+0]=ml(i),this.array[e+1]=ml(a),this}setXYZ(e,i,a,s){return e*=this.itemSize,this.normalized&&(i=Gi(i,this.array),a=Gi(a,this.array),s=Gi(s,this.array)),this.array[e+0]=ml(i),this.array[e+1]=ml(a),this.array[e+2]=ml(s),this}setXYZW(e,i,a,s,l){return e*=this.itemSize,this.normalized&&(i=Gi(i,this.array),a=Gi(a,this.array),s=Gi(s,this.array),l=Gi(l,this.array)),this.array[e+0]=ml(i),this.array[e+1]=ml(a),this.array[e+2]=ml(s),this.array[e+3]=ml(l),this}}class jn extends Qr{constructor(e,i,a){super(new Float32Array(e),i,a)}}class Ibe extends Qr{constructor(e,i,a){super(new Float64Array(e),i,a)}}let Rbe=0;const Sc=new Di,ZR=new br,Kv=new We,Hl=new Su,Ex=new Su,Wo=new We;class zi extends Ld{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:Rbe++}),this.uuid=tc(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(PZ(e)?Mz:Ez)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,i){return this.attributes[e]=i,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,i,a=0){this.groups.push({start:e,count:i,materialIndex:a})}clearGroups(){this.groups=[]}setDrawRange(e,i){this.drawRange.start=e,this.drawRange.count=i}applyMatrix4(e){const i=this.attributes.position;i!==void 0&&(i.applyMatrix4(e),i.needsUpdate=!0);const a=this.attributes.normal;if(a!==void 0){const l=new Vi().getNormalMatrix(e);a.applyNormalMatrix(l),a.needsUpdate=!0}const s=this.attributes.tangent;return s!==void 0&&(s.transformDirection(e),s.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return Sc.makeRotationFromQuaternion(e),this.applyMatrix4(Sc),this}rotateX(e){return Sc.makeRotationX(e),this.applyMatrix4(Sc),this}rotateY(e){return Sc.makeRotationY(e),this.applyMatrix4(Sc),this}rotateZ(e){return Sc.makeRotationZ(e),this.applyMatrix4(Sc),this}translate(e,i,a){return Sc.makeTranslation(e,i,a),this.applyMatrix4(Sc),this}scale(e,i,a){return Sc.makeScale(e,i,a),this.applyMatrix4(Sc),this}lookAt(e){return ZR.lookAt(e),ZR.updateMatrix(),this.applyMatrix4(ZR.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Kv).negate(),this.translate(Kv.x,Kv.y,Kv.z),this}setFromPoints(e){const i=[];for(let a=0,s=e.length;a<s;a++){const l=e[a];i.push(l.x,l.y,l.z||0)}return this.setAttribute("position",new jn(i,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Su);const e=this.attributes.position,i=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new We(-1/0,-1/0,-1/0),new We(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),i)for(let a=0,s=i.length;a<s;a++){const l=i[a];Hl.setFromBufferAttribute(l),this.morphTargetsRelative?(Wo.addVectors(this.boundingBox.min,Hl.min),this.boundingBox.expandByPoint(Wo),Wo.addVectors(this.boundingBox.max,Hl.max),this.boundingBox.expandByPoint(Wo)):(this.boundingBox.expandByPoint(Hl.min),this.boundingBox.expandByPoint(Hl.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Fc);const e=this.attributes.position,i=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingSphere.set(new We,1/0);return}if(e){const a=this.boundingSphere.center;if(Hl.setFromBufferAttribute(e),i)for(let l=0,d=i.length;l<d;l++){const f=i[l];Ex.setFromBufferAttribute(f),this.morphTargetsRelative?(Wo.addVectors(Hl.min,Ex.min),Hl.expandByPoint(Wo),Wo.addVectors(Hl.max,Ex.max),Hl.expandByPoint(Wo)):(Hl.expandByPoint(Ex.min),Hl.expandByPoint(Ex.max))}Hl.getCenter(a);let s=0;for(let l=0,d=e.count;l<d;l++)Wo.fromBufferAttribute(e,l),s=Math.max(s,a.distanceToSquared(Wo));if(i)for(let l=0,d=i.length;l<d;l++){const f=i[l],p=this.morphTargetsRelative;for(let y=0,_=f.count;y<_;y++)Wo.fromBufferAttribute(f,y),p&&(Kv.fromBufferAttribute(e,y),Wo.add(Kv)),s=Math.max(s,a.distanceToSquared(Wo))}this.boundingSphere.radius=Math.sqrt(s),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,i=this.attributes;if(e===null||i.position===void 0||i.normal===void 0||i.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const a=e.array,s=i.position.array,l=i.normal.array,d=i.uv.array,f=s.length/3;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new Qr(new Float32Array(4*f),4));const p=this.getAttribute("tangent").array,y=[],_=[];for(let Q=0;Q<f;Q++)y[Q]=new We,_[Q]=new We;const b=new We,S=new We,A=new We,P=new tn,L=new tn,k=new tn,R=new We,z=new We;function O(Q,he,pe){b.fromArray(s,Q*3),S.fromArray(s,he*3),A.fromArray(s,pe*3),P.fromArray(d,Q*2),L.fromArray(d,he*2),k.fromArray(d,pe*2),S.sub(b),A.sub(b),L.sub(P),k.sub(P);const ye=1/(L.x*k.y-k.x*L.y);isFinite(ye)&&(R.copy(S).multiplyScalar(k.y).addScaledVector(A,-L.y).multiplyScalar(ye),z.copy(A).multiplyScalar(L.x).addScaledVector(S,-k.x).multiplyScalar(ye),y[Q].add(R),y[he].add(R),y[pe].add(R),_[Q].add(z),_[he].add(z),_[pe].add(z))}let F=this.groups;F.length===0&&(F=[{start:0,count:a.length}]);for(let Q=0,he=F.length;Q<he;++Q){const pe=F[Q],ye=pe.start,fe=pe.count;for(let Ae=ye,Re=ye+fe;Ae<Re;Ae+=3)O(a[Ae+0],a[Ae+1],a[Ae+2])}const H=new We,$=new We,Y=new We,te=new We;function G(Q){Y.fromArray(l,Q*3),te.copy(Y);const he=y[Q];H.copy(he),H.sub(Y.multiplyScalar(Y.dot(he))).normalize(),$.crossVectors(te,he);const ye=$.dot(_[Q])<0?-1:1;p[Q*4]=H.x,p[Q*4+1]=H.y,p[Q*4+2]=H.z,p[Q*4+3]=ye}for(let Q=0,he=F.length;Q<he;++Q){const pe=F[Q],ye=pe.start,fe=pe.count;for(let Ae=ye,Re=ye+fe;Ae<Re;Ae+=3)G(a[Ae+0]),G(a[Ae+1]),G(a[Ae+2])}}computeVertexNormals(){const e=this.index,i=this.getAttribute("position");if(i!==void 0){let a=this.getAttribute("normal");if(a===void 0)a=new Qr(new Float32Array(i.count*3),3),this.setAttribute("normal",a);else for(let S=0,A=a.count;S<A;S++)a.setXYZ(S,0,0,0);const s=new We,l=new We,d=new We,f=new We,p=new We,y=new We,_=new We,b=new We;if(e)for(let S=0,A=e.count;S<A;S+=3){const P=e.getX(S+0),L=e.getX(S+1),k=e.getX(S+2);s.fromBufferAttribute(i,P),l.fromBufferAttribute(i,L),d.fromBufferAttribute(i,k),_.subVectors(d,l),b.subVectors(s,l),_.cross(b),f.fromBufferAttribute(a,P),p.fromBufferAttribute(a,L),y.fromBufferAttribute(a,k),f.add(_),p.add(_),y.add(_),a.setXYZ(P,f.x,f.y,f.z),a.setXYZ(L,p.x,p.y,p.z),a.setXYZ(k,y.x,y.y,y.z)}else for(let S=0,A=i.count;S<A;S+=3)s.fromBufferAttribute(i,S+0),l.fromBufferAttribute(i,S+1),d.fromBufferAttribute(i,S+2),_.subVectors(d,l),b.subVectors(s,l),_.cross(b),a.setXYZ(S+0,_.x,_.y,_.z),a.setXYZ(S+1,_.x,_.y,_.z),a.setXYZ(S+2,_.x,_.y,_.z);this.normalizeNormals(),a.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let i=0,a=e.count;i<a;i++)Wo.fromBufferAttribute(e,i),Wo.normalize(),e.setXYZ(i,Wo.x,Wo.y,Wo.z)}toNonIndexed(){function e(f,p){const y=f.array,_=f.itemSize,b=f.normalized,S=new y.constructor(p.length*_);let A=0,P=0;for(let L=0,k=p.length;L<k;L++){f.isInterleavedBufferAttribute?A=p[L]*f.data.stride+f.offset:A=p[L]*_;for(let R=0;R<_;R++)S[P++]=y[A++]}return new Qr(S,_,b)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const i=new zi,a=this.index.array,s=this.attributes;for(const f in s){const p=s[f],y=e(p,a);i.setAttribute(f,y)}const l=this.morphAttributes;for(const f in l){const p=[],y=l[f];for(let _=0,b=y.length;_<b;_++){const S=y[_],A=e(S,a);p.push(A)}i.morphAttributes[f]=p}i.morphTargetsRelative=this.morphTargetsRelative;const d=this.groups;for(let f=0,p=d.length;f<p;f++){const y=d[f];i.addGroup(y.start,y.count,y.materialIndex)}return i}toJSON(){const e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const p=this.parameters;for(const y in p)p[y]!==void 0&&(e[y]=p[y]);return e}e.data={attributes:{}};const i=this.index;i!==null&&(e.data.index={type:i.array.constructor.name,array:Array.prototype.slice.call(i.array)});const a=this.attributes;for(const p in a){const y=a[p];e.data.attributes[p]=y.toJSON(e.data)}const s={};let l=!1;for(const p in this.morphAttributes){const y=this.morphAttributes[p],_=[];for(let b=0,S=y.length;b<S;b++){const A=y[b];_.push(A.toJSON(e.data))}_.length>0&&(s[p]=_,l=!0)}l&&(e.data.morphAttributes=s,e.data.morphTargetsRelative=this.morphTargetsRelative);const d=this.groups;d.length>0&&(e.data.groups=JSON.parse(JSON.stringify(d)));const f=this.boundingSphere;return f!==null&&(e.data.boundingSphere={center:f.center.toArray(),radius:f.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const i={};this.name=e.name;const a=e.index;a!==null&&this.setIndex(a.clone(i));const s=e.attributes;for(const y in s){const _=s[y];this.setAttribute(y,_.clone(i))}const l=e.morphAttributes;for(const y in l){const _=[],b=l[y];for(let S=0,A=b.length;S<A;S++)_.push(b[S].clone(i));this.morphAttributes[y]=_}this.morphTargetsRelative=e.morphTargetsRelative;const d=e.groups;for(let y=0,_=d.length;y<_;y++){const b=d[y];this.addGroup(b.start,b.count,b.materialIndex)}const f=e.boundingBox;f!==null&&(this.boundingBox=f.clone());const p=e.boundingSphere;return p!==null&&(this.boundingSphere=p.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const XV=new Di,jm=new iy,V3=new Fc,ZV=new We,Jv=new We,Qv=new We,e0=new We,KR=new We,G3=new We,H3=new tn,j3=new tn,$3=new tn,KV=new We,JV=new We,QV=new We,Y3=new We,q3=new We;class Eo extends br{constructor(e=new zi,i=new Kh){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=i,this.updateMorphTargets()}copy(e,i){return super.copy(e,i),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const i=this.geometry.morphAttributes,a=Object.keys(i);if(a.length>0){const s=i[a[0]];if(s!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let l=0,d=s.length;l<d;l++){const f=s[l].name||String(l);this.morphTargetInfluences.push(0),this.morphTargetDictionary[f]=l}}}}getVertexPosition(e,i){const a=this.geometry,s=a.attributes.position,l=a.morphAttributes.position,d=a.morphTargetsRelative;i.fromBufferAttribute(s,e);const f=this.morphTargetInfluences;if(l&&f){G3.set(0,0,0);for(let p=0,y=l.length;p<y;p++){const _=f[p],b=l[p];_!==0&&(KR.fromBufferAttribute(b,e),d?G3.addScaledVector(KR,_):G3.addScaledVector(KR.sub(i),_))}i.add(G3)}return i}raycast(e,i){const a=this.geometry,s=this.material,l=this.matrixWorld;s!==void 0&&(a.boundingSphere===null&&a.computeBoundingSphere(),V3.copy(a.boundingSphere),V3.applyMatrix4(l),jm.copy(e.ray).recast(e.near),!(V3.containsPoint(jm.origin)===!1&&(jm.intersectSphere(V3,ZV)===null||jm.origin.distanceToSquared(ZV)>(e.far-e.near)**2))&&(XV.copy(l).invert(),jm.copy(e.ray).applyMatrix4(XV),!(a.boundingBox!==null&&jm.intersectsBox(a.boundingBox)===!1)&&this._computeIntersections(e,i,jm)))}_computeIntersections(e,i,a){let s;const l=this.geometry,d=this.material,f=l.index,p=l.attributes.position,y=l.attributes.uv,_=l.attributes.uv1,b=l.attributes.normal,S=l.groups,A=l.drawRange;if(f!==null)if(Array.isArray(d))for(let P=0,L=S.length;P<L;P++){const k=S[P],R=d[k.materialIndex],z=Math.max(k.start,A.start),O=Math.min(f.count,Math.min(k.start+k.count,A.start+A.count));for(let F=z,H=O;F<H;F+=3){const $=f.getX(F),Y=f.getX(F+1),te=f.getX(F+2);s=X3(this,R,e,a,y,_,b,$,Y,te),s&&(s.faceIndex=Math.floor(F/3),s.face.materialIndex=k.materialIndex,i.push(s))}}else{const P=Math.max(0,A.start),L=Math.min(f.count,A.start+A.count);for(let k=P,R=L;k<R;k+=3){const z=f.getX(k),O=f.getX(k+1),F=f.getX(k+2);s=X3(this,d,e,a,y,_,b,z,O,F),s&&(s.faceIndex=Math.floor(k/3),i.push(s))}}else if(p!==void 0)if(Array.isArray(d))for(let P=0,L=S.length;P<L;P++){const k=S[P],R=d[k.materialIndex],z=Math.max(k.start,A.start),O=Math.min(p.count,Math.min(k.start+k.count,A.start+A.count));for(let F=z,H=O;F<H;F+=3){const $=F,Y=F+1,te=F+2;s=X3(this,R,e,a,y,_,b,$,Y,te),s&&(s.faceIndex=Math.floor(F/3),s.face.materialIndex=k.materialIndex,i.push(s))}}else{const P=Math.max(0,A.start),L=Math.min(p.count,A.start+A.count);for(let k=P,R=L;k<R;k+=3){const z=k,O=k+1,F=k+2;s=X3(this,d,e,a,y,_,b,z,O,F),s&&(s.faceIndex=Math.floor(k/3),i.push(s))}}}}function Lbe(n,e,i,a,s,l,d,f){let p;if(e.side===Ts?p=a.intersectTriangle(d,l,s,!0,f):p=a.intersectTriangle(s,l,d,e.side===Ad,f),p===null)return null;q3.copy(f),q3.applyMatrix4(n.matrixWorld);const y=i.ray.origin.distanceTo(q3);return y<i.near||y>i.far?null:{distance:y,point:q3.clone(),object:n}}function X3(n,e,i,a,s,l,d,f,p,y){n.getVertexPosition(f,Jv),n.getVertexPosition(p,Qv),n.getVertexPosition(y,e0);const _=Lbe(n,e,i,a,Jv,Qv,e0,Y3);if(_){s&&(H3.fromBufferAttribute(s,f),j3.fromBufferAttribute(s,p),$3.fromBufferAttribute(s,y),_.uv=yl.getInterpolation(Y3,Jv,Qv,e0,H3,j3,$3,new tn)),l&&(H3.fromBufferAttribute(l,f),j3.fromBufferAttribute(l,p),$3.fromBufferAttribute(l,y),_.uv1=yl.getInterpolation(Y3,Jv,Qv,e0,H3,j3,$3,new tn),_.uv2=_.uv1),d&&(KV.fromBufferAttribute(d,f),JV.fromBufferAttribute(d,p),QV.fromBufferAttribute(d,y),_.normal=yl.getInterpolation(Y3,Jv,Qv,e0,KV,JV,QV,new We),_.normal.dot(a.direction)>0&&_.normal.multiplyScalar(-1));const b={a:f,b:p,c:y,normal:new We,materialIndex:0};yl.getNormal(Jv,Qv,e0,b.normal),_.face=b}return _}class ry extends zi{constructor(e=1,i=1,a=1,s=1,l=1,d=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:i,depth:a,widthSegments:s,heightSegments:l,depthSegments:d};const f=this;s=Math.floor(s),l=Math.floor(l),d=Math.floor(d);const p=[],y=[],_=[],b=[];let S=0,A=0;P("z","y","x",-1,-1,a,i,e,d,l,0),P("z","y","x",1,-1,a,i,-e,d,l,1),P("x","z","y",1,1,e,a,i,s,d,2),P("x","z","y",1,-1,e,a,-i,s,d,3),P("x","y","z",1,-1,e,i,a,s,l,4),P("x","y","z",-1,-1,e,i,-a,s,l,5),this.setIndex(p),this.setAttribute("position",new jn(y,3)),this.setAttribute("normal",new jn(_,3)),this.setAttribute("uv",new jn(b,2));function P(L,k,R,z,O,F,H,$,Y,te,G){const Q=F/Y,he=H/te,pe=F/2,ye=H/2,fe=$/2,Ae=Y+1,Re=te+1;let Be=0,le=0;const me=new We;for(let we=0;we<Re;we++){const re=we*he-ye;for(let Te=0;Te<Ae;Te++){const Je=Te*Q-pe;me[L]=Je*z,me[k]=re*O,me[R]=fe,y.push(me.x,me.y,me.z),me[L]=0,me[k]=0,me[R]=$>0?1:-1,_.push(me.x,me.y,me.z),b.push(Te/Y),b.push(1-we/te),Be+=1}}for(let we=0;we<te;we++)for(let re=0;re<Y;re++){const Te=S+re+Ae*we,Je=S+re+Ae*(we+1),Xe=S+(re+1)+Ae*(we+1),Ze=S+(re+1)+Ae*we;p.push(Te,Je,Ze),p.push(Je,Xe,Ze),le+=6}f.addGroup(A,le,G),A+=le,S+=Be}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new ry(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function x_(n){const e={};for(const i in n){e[i]={};for(const a in n[i]){const s=n[i][a];s&&(s.isColor||s.isMatrix3||s.isMatrix4||s.isVector2||s.isVector3||s.isVector4||s.isTexture||s.isQuaternion)?s.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[i][a]=null):e[i][a]=s.clone():Array.isArray(s)?e[i][a]=s.slice():e[i][a]=s}}return e}function Hs(n){const e={};for(let i=0;i<n.length;i++){const a=x_(n[i]);for(const s in a)e[s]=a[s]}return e}function kbe(n){const e=[];for(let i=0;i<n.length;i++)e.push(n[i].clone());return e}function kZ(n){return n.getRenderTarget()===null?n.outputColorSpace:Vr.workingColorSpace}const Tz={clone:x_,merge:Hs};var Dbe=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,zbe=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class Pd extends rs{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=Dbe,this.fragmentShader=zbe,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=x_(e.uniforms),this.uniformsGroups=kbe(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const i=super.toJSON(e);i.glslVersion=this.glslVersion,i.uniforms={};for(const s in this.uniforms){const d=this.uniforms[s].value;d&&d.isTexture?i.uniforms[s]={type:"t",value:d.toJSON(e).uuid}:d&&d.isColor?i.uniforms[s]={type:"c",value:d.getHex()}:d&&d.isVector2?i.uniforms[s]={type:"v2",value:d.toArray()}:d&&d.isVector3?i.uniforms[s]={type:"v3",value:d.toArray()}:d&&d.isVector4?i.uniforms[s]={type:"v4",value:d.toArray()}:d&&d.isMatrix3?i.uniforms[s]={type:"m3",value:d.toArray()}:d&&d.isMatrix4?i.uniforms[s]={type:"m4",value:d.toArray()}:i.uniforms[s]={value:d}}Object.keys(this.defines).length>0&&(i.defines=this.defines),i.vertexShader=this.vertexShader,i.fragmentShader=this.fragmentShader,i.lights=this.lights,i.clipping=this.clipping;const a={};for(const s in this.extensions)this.extensions[s]===!0&&(a[s]=!0);return Object.keys(a).length>0&&(i.extensions=a),i}}class nS extends br{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Di,this.projectionMatrix=new Di,this.projectionMatrixInverse=new Di,this.coordinateSystem=gd}copy(e,i){return super.copy(e,i),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,i){super.updateWorldMatrix(e,i),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}class Za extends nS{constructor(e=50,i=1,a=.1,s=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=a,this.far=s,this.focus=10,this.aspect=i,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,i){return super.copy(e,i),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const i=.5*this.getFilmHeight()/e;this.fov=__*2*Math.atan(i),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(Ig*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return __*2*Math.atan(Math.tan(Ig*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,i,a,s,l,d){this.aspect=e/i,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=i,this.view.offsetX=a,this.view.offsetY=s,this.view.width=l,this.view.height=d,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let i=e*Math.tan(Ig*.5*this.fov)/this.zoom,a=2*i,s=this.aspect*a,l=-.5*s;const d=this.view;if(this.view!==null&&this.view.enabled){const p=d.fullWidth,y=d.fullHeight;l+=d.offsetX*s/p,i-=d.offsetY*a/y,s*=d.width/p,a*=d.height/y}const f=this.filmOffset;f!==0&&(l+=e*f/this.getFilmWidth()),this.projectionMatrix.makePerspective(l,l+s,i,i-a,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const i=super.toJSON(e);return i.object.fov=this.fov,i.object.zoom=this.zoom,i.object.near=this.near,i.object.far=this.far,i.object.focus=this.focus,i.object.aspect=this.aspect,this.view!==null&&(i.object.view=Object.assign({},this.view)),i.object.filmGauge=this.filmGauge,i.object.filmOffset=this.filmOffset,i}}const t0=-90,n0=1;class DZ extends br{constructor(e,i,a){super(),this.type="CubeCamera",this.renderTarget=a,this.coordinateSystem=null,this.activeMipmapLevel=0;const s=new Za(t0,n0,e,i);s.layers=this.layers,this.add(s);const l=new Za(t0,n0,e,i);l.layers=this.layers,this.add(l);const d=new Za(t0,n0,e,i);d.layers=this.layers,this.add(d);const f=new Za(t0,n0,e,i);f.layers=this.layers,this.add(f);const p=new Za(t0,n0,e,i);p.layers=this.layers,this.add(p);const y=new Za(t0,n0,e,i);y.layers=this.layers,this.add(y)}updateCoordinateSystem(){const e=this.coordinateSystem,i=this.children.concat(),[a,s,l,d,f,p]=i;for(const y of i)this.remove(y);if(e===gd)a.up.set(0,1,0),a.lookAt(1,0,0),s.up.set(0,1,0),s.lookAt(-1,0,0),l.up.set(0,0,-1),l.lookAt(0,1,0),d.up.set(0,0,1),d.lookAt(0,-1,0),f.up.set(0,1,0),f.lookAt(0,0,1),p.up.set(0,1,0),p.lookAt(0,0,-1);else if(e===_w)a.up.set(0,-1,0),a.lookAt(-1,0,0),s.up.set(0,-1,0),s.lookAt(1,0,0),l.up.set(0,0,1),l.lookAt(0,1,0),d.up.set(0,0,-1),d.lookAt(0,-1,0),f.up.set(0,-1,0),f.lookAt(0,0,1),p.up.set(0,-1,0),p.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(const y of i)this.add(y),y.updateMatrixWorld()}update(e,i){this.parent===null&&this.updateMatrixWorld();const{renderTarget:a,activeMipmapLevel:s}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[l,d,f,p,y,_]=this.children,b=e.getRenderTarget(),S=e.getActiveCubeFace(),A=e.getActiveMipmapLevel(),P=e.xr.enabled;e.xr.enabled=!1;const L=a.texture.generateMipmaps;a.texture.generateMipmaps=!1,e.setRenderTarget(a,0,s),e.render(i,l),e.setRenderTarget(a,1,s),e.render(i,d),e.setRenderTarget(a,2,s),e.render(i,f),e.setRenderTarget(a,3,s),e.render(i,p),e.setRenderTarget(a,4,s),e.render(i,y),a.texture.generateMipmaps=L,e.setRenderTarget(a,5,s),e.render(i,_),e.setRenderTarget(b,S,A),e.xr.enabled=P,a.texture.needsPMREMUpdate=!0}}class iS extends Oa{constructor(e,i,a,s,l,d,f,p,y,_){e=e!==void 0?e:[],i=i!==void 0?i:Yh,super(e,i,a,s,l,d,f,p,y,_),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class zZ extends wu{constructor(e=1,i={}){super(e,e,i),this.isWebGLCubeRenderTarget=!0;const a={width:e,height:e,depth:1},s=[a,a,a,a,a,a];i.encoding!==void 0&&(bb("THREE.WebGLCubeRenderTarget: option.encoding has been replaced by option.colorSpace."),i.colorSpace=i.encoding===xp?Lo:Zl),this.texture=new iS(s,i.mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=i.generateMipmaps!==void 0?i.generateMipmaps:!1,this.texture.minFilter=i.minFilter!==void 0?i.minFilter:ka}fromEquirectangularTexture(e,i){this.texture.type=i.type,this.texture.colorSpace=i.colorSpace,this.texture.generateMipmaps=i.generateMipmaps,this.texture.minFilter=i.minFilter,this.texture.magFilter=i.magFilter;const a={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},s=new ry(5,5,5),l=new Pd({name:"CubemapFromEquirect",uniforms:x_(a.uniforms),vertexShader:a.vertexShader,fragmentShader:a.fragmentShader,side:Ts,blending:Wh});l.uniforms.tEquirect.value=i;const d=new Eo(s,l),f=i.minFilter;return i.minFilter===Cp&&(i.minFilter=ka),new DZ(1,10,this).update(e,d),i.minFilter=f,d.geometry.dispose(),d.material.dispose(),this}clear(e,i,a,s){const l=e.getRenderTarget();for(let d=0;d<6;d++)e.setRenderTarget(this,d),e.clear(i,a,s);e.setRenderTarget(l)}}const JR=new We,Obe=new We,Nbe=new Vi;class Ph{constructor(e=new We(1,0,0),i=0){this.isPlane=!0,this.normal=e,this.constant=i}set(e,i){return this.normal.copy(e),this.constant=i,this}setComponents(e,i,a,s){return this.normal.set(e,i,a),this.constant=s,this}setFromNormalAndCoplanarPoint(e,i){return this.normal.copy(e),this.constant=-i.dot(this.normal),this}setFromCoplanarPoints(e,i,a){const s=JR.subVectors(a,i).cross(Obe.subVectors(e,i)).normalize();return this.setFromNormalAndCoplanarPoint(s,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,i){return i.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,i){const a=e.delta(JR),s=this.normal.dot(a);if(s===0)return this.distanceToPoint(e.start)===0?i.copy(e.start):null;const l=-(e.start.dot(this.normal)+this.constant)/s;return l<0||l>1?null:i.copy(e.start).addScaledVector(a,l)}intersectsLine(e){const i=this.distanceToPoint(e.start),a=this.distanceToPoint(e.end);return i<0&&a>0||a<0&&i>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,i){const a=i||Nbe.getNormalMatrix(e),s=this.coplanarPoint(JR).applyMatrix4(e),l=this.normal.applyMatrix3(a).normalize();return this.constant=-s.dot(l),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}const $m=new Fc,Z3=new We;class QA{constructor(e=new Ph,i=new Ph,a=new Ph,s=new Ph,l=new Ph,d=new Ph){this.planes=[e,i,a,s,l,d]}set(e,i,a,s,l,d){const f=this.planes;return f[0].copy(e),f[1].copy(i),f[2].copy(a),f[3].copy(s),f[4].copy(l),f[5].copy(d),this}copy(e){const i=this.planes;for(let a=0;a<6;a++)i[a].copy(e.planes[a]);return this}setFromProjectionMatrix(e,i=gd){const a=this.planes,s=e.elements,l=s[0],d=s[1],f=s[2],p=s[3],y=s[4],_=s[5],b=s[6],S=s[7],A=s[8],P=s[9],L=s[10],k=s[11],R=s[12],z=s[13],O=s[14],F=s[15];if(a[0].setComponents(p-l,S-y,k-A,F-R).normalize(),a[1].setComponents(p+l,S+y,k+A,F+R).normalize(),a[2].setComponents(p+d,S+_,k+P,F+z).normalize(),a[3].setComponents(p-d,S-_,k-P,F-z).normalize(),a[4].setComponents(p-f,S-b,k-L,F-O).normalize(),i===gd)a[5].setComponents(p+f,S+b,k+L,F+O).normalize();else if(i===_w)a[5].setComponents(f,b,L,O).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+i);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),$m.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const i=e.geometry;i.boundingSphere===null&&i.computeBoundingSphere(),$m.copy(i.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere($m)}intersectsSprite(e){return $m.center.set(0,0,0),$m.radius=.7071067811865476,$m.applyMatrix4(e.matrixWorld),this.intersectsSphere($m)}intersectsSphere(e){const i=this.planes,a=e.center,s=-e.radius;for(let l=0;l<6;l++)if(i[l].distanceToPoint(a)<s)return!1;return!0}intersectsBox(e){const i=this.planes;for(let a=0;a<6;a++){const s=i[a];if(Z3.x=s.normal.x>0?e.max.x:e.min.x,Z3.y=s.normal.y>0?e.max.y:e.min.y,Z3.z=s.normal.z>0?e.max.z:e.min.z,s.distanceToPoint(Z3)<0)return!1}return!0}containsPoint(e){const i=this.planes;for(let a=0;a<6;a++)if(i[a].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}function OZ(){let n=null,e=!1,i=null,a=null;function s(l,d){i(l,d),a=n.requestAnimationFrame(s)}return{start:function(){e!==!0&&i!==null&&(a=n.requestAnimationFrame(s),e=!0)},stop:function(){n.cancelAnimationFrame(a),e=!1},setAnimationLoop:function(l){i=l},setContext:function(l){n=l}}}function Fbe(n,e){const i=e.isWebGL2,a=new WeakMap;function s(y,_){const b=y.array,S=y.usage,A=n.createBuffer();n.bindBuffer(_,A),n.bufferData(_,b,S),y.onUploadCallback();let P;if(b instanceof Float32Array)P=n.FLOAT;else if(b instanceof Uint16Array)if(y.isFloat16BufferAttribute)if(i)P=n.HALF_FLOAT;else throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");else P=n.UNSIGNED_SHORT;else if(b instanceof Int16Array)P=n.SHORT;else if(b instanceof Uint32Array)P=n.UNSIGNED_INT;else if(b instanceof Int32Array)P=n.INT;else if(b instanceof Int8Array)P=n.BYTE;else if(b instanceof Uint8Array)P=n.UNSIGNED_BYTE;else if(b instanceof Uint8ClampedArray)P=n.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+b);return{buffer:A,type:P,bytesPerElement:b.BYTES_PER_ELEMENT,version:y.version}}function l(y,_,b){const S=_.array,A=_.updateRange;n.bindBuffer(b,y),A.count===-1?n.bufferSubData(b,0,S):(i?n.bufferSubData(b,A.offset*S.BYTES_PER_ELEMENT,S,A.offset,A.count):n.bufferSubData(b,A.offset*S.BYTES_PER_ELEMENT,S.subarray(A.offset,A.offset+A.count)),A.count=-1),_.onUploadCallback()}function d(y){return y.isInterleavedBufferAttribute&&(y=y.data),a.get(y)}function f(y){y.isInterleavedBufferAttribute&&(y=y.data);const _=a.get(y);_&&(n.deleteBuffer(_.buffer),a.delete(y))}function p(y,_){if(y.isGLBufferAttribute){const S=a.get(y);(!S||S.version<y.version)&&a.set(y,{buffer:y.buffer,type:y.type,bytesPerElement:y.elementSize,version:y.version});return}y.isInterleavedBufferAttribute&&(y=y.data);const b=a.get(y);b===void 0?a.set(y,s(y,_)):b.version<y.version&&(l(b.buffer,y,_),b.version=y.version)}return{get:d,remove:f,update:p}}class Fp extends zi{constructor(e=1,i=1,a=1,s=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:i,widthSegments:a,heightSegments:s};const l=e/2,d=i/2,f=Math.floor(a),p=Math.floor(s),y=f+1,_=p+1,b=e/f,S=i/p,A=[],P=[],L=[],k=[];for(let R=0;R<_;R++){const z=R*S-d;for(let O=0;O<y;O++){const F=O*b-l;P.push(F,-z,0),L.push(0,0,1),k.push(O/f),k.push(1-R/p)}}for(let R=0;R<p;R++)for(let z=0;z<f;z++){const O=z+y*R,F=z+y*(R+1),H=z+1+y*(R+1),$=z+1+y*R;A.push(O,F,$),A.push(F,H,$)}this.setIndex(A),this.setAttribute("position",new jn(P,3)),this.setAttribute("normal",new jn(L,3)),this.setAttribute("uv",new jn(k,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Fp(e.width,e.height,e.widthSegments,e.heightSegments)}}var Bbe=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,Ube=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,Wbe=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,Vbe=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,Gbe=`#ifdef USE_ALPHATEST
	if ( diffuseColor.a < alphaTest ) discard;
#endif`,Hbe=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,jbe=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,$be=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,Ybe=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,qbe=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,Xbe=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,Zbe=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,Kbe=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,Jbe=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#pragma unroll_loop_start
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
		plane = clippingPlanes[ i ];
		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
	}
	#pragma unroll_loop_end
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		#pragma unroll_loop_start
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
		}
		#pragma unroll_loop_end
		if ( clipped ) discard;
	#endif
#endif`,Qbe=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,ewe=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,twe=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,nwe=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,iwe=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,rwe=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,awe=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,owe=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float luminance( const in vec3 rgb ) {
	const vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );
	return dot( weights, rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,swe=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_v0 0.339
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_v1 0.276
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_v4 0.046
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_v5 0.016
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_v6 0.0038
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,lwe=`vec3 transformedNormal = objectNormal;
#ifdef USE_INSTANCING
	mat3 m = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );
	transformedNormal = m * transformedNormal;
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	vec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,cwe=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,uwe=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,dwe=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,hwe=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,fwe="gl_FragColor = linearToOutputTexel( gl_FragColor );",pwe=`
const mat3 LINEAR_SRGB_TO_LINEAR_DISPLAY_P3 = mat3(
	vec3( 0.8224621, 0.177538, 0.0 ),
	vec3( 0.0331941, 0.9668058, 0.0 ),
	vec3( 0.0170827, 0.0723974, 0.9105199 )
);
const mat3 LINEAR_DISPLAY_P3_TO_LINEAR_SRGB = mat3(
	vec3( 1.2249401, - 0.2249404, 0.0 ),
	vec3( - 0.0420569, 1.0420571, 0.0 ),
	vec3( - 0.0196376, - 0.0786361, 1.0982735 )
);
vec4 LinearSRGBToLinearDisplayP3( in vec4 value ) {
	return vec4( value.rgb * LINEAR_SRGB_TO_LINEAR_DISPLAY_P3, value.a );
}
vec4 LinearDisplayP3ToLinearSRGB( in vec4 value ) {
	return vec4( value.rgb * LINEAR_DISPLAY_P3_TO_LINEAR_SRGB, value.a );
}
vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}
vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 LinearTosRGB( in vec4 value ) {
	return sRGBTransferOETF( value );
}`,mwe=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,gwe=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,ywe=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,vwe=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,_we=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,xwe=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,bwe=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,wwe=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,Swe=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,Ewe=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,Mwe=`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
	vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
	reflectedLight.indirectDiffuse += lightMapIrradiance;
#endif`,Twe=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,Awe=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,Cwe=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,Pwe=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	#if defined ( LEGACY_LIGHTS )
		if ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
			return pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );
		}
		return 1.0;
	#else
		float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
		if ( cutoffDistance > 0.0 ) {
			distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
		}
		return distanceFalloff;
	#endif
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,Iwe=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,Rwe=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,Lwe=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,kwe=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,Dwe=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,zwe=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	anisotropyV /= material.anisotropy;
	material.anisotropy = saturate( material.anisotropy );
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x - tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x + tbn[ 0 ] * anisotropyV.y;
#endif`,Owe=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return saturate(v);
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,Nwe=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,Fwe=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,Bwe=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,Uwe=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,Wwe=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,Vwe=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,Gwe=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,Hwe=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );
	
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,jwe=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,$we=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,Ywe=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,qwe=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,Xwe=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,Zwe=`#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,Kwe=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
		objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
		objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
		objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
	#endif
#endif`,Jwe=`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
		uniform sampler2DArray morphTargetsTexture;
		uniform ivec2 morphTargetsTextureSize;
		vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
			int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
			int y = texelIndex / morphTargetsTextureSize.x;
			int x = texelIndex - y * morphTargetsTextureSize.x;
			ivec3 morphUV = ivec3( x, y, morphTargetIndex );
			return texelFetch( morphTargetsTexture, morphUV, 0 );
		}
	#else
		#ifndef USE_MORPHNORMALS
			uniform float morphTargetInfluences[ 8 ];
		#else
			uniform float morphTargetInfluences[ 4 ];
		#endif
	#endif
#endif`,Qwe=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		transformed += morphTarget0 * morphTargetInfluences[ 0 ];
		transformed += morphTarget1 * morphTargetInfluences[ 1 ];
		transformed += morphTarget2 * morphTargetInfluences[ 2 ];
		transformed += morphTarget3 * morphTargetInfluences[ 3 ];
		#ifndef USE_MORPHNORMALS
			transformed += morphTarget4 * morphTargetInfluences[ 4 ];
			transformed += morphTarget5 * morphTargetInfluences[ 5 ];
			transformed += morphTarget6 * morphTargetInfluences[ 6 ];
			transformed += morphTarget7 * morphTargetInfluences[ 7 ];
		#endif
	#endif
#endif`,eSe=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,tSe=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,nSe=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,iSe=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,rSe=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,aSe=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,oSe=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,sSe=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,lSe=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,cSe=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,uSe=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,dSe=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec2 packDepthToRG( in highp float v ) {
	return packDepthToRGBA( v ).yx;
}
float unpackRGToDepth( const in highp vec2 v ) {
	return unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,hSe=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,fSe=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,pSe=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,mSe=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,gSe=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,ySe=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,vSe=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,_Se=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,xSe=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,bSe=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,wSe=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,SSe=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	uniform int boneTextureSize;
	mat4 getBoneMatrix( const in float i ) {
		float j = i * 4.0;
		float x = mod( j, float( boneTextureSize ) );
		float y = floor( j / float( boneTextureSize ) );
		float dx = 1.0 / float( boneTextureSize );
		float dy = 1.0 / float( boneTextureSize );
		y = dy * ( y + 0.5 );
		vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );
		vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );
		vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );
		vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );
		mat4 bone = mat4( v1, v2, v3, v4 );
		return bone;
	}
#endif`,ESe=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,MSe=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,TSe=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,ASe=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,CSe=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,PSe=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,ISe=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,RSe=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
		vec3 refractedRayExit = position + transmissionRay;
		vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
		vec2 refractionCoords = ndcPos.xy / ndcPos.w;
		refractionCoords += 1.0;
		refractionCoords /= 2.0;
		vec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
		vec3 transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,LSe=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,kSe=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,DSe=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,zSe=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const OSe=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,NSe=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,FSe=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,BSe=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,USe=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,WSe=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,VSe=`#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,GSe=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,HSe=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,jSe=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,$Se=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,YSe=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,qSe=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,XSe=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,ZSe=`#include <common>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,KSe=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,JSe=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,QSe=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,e2e=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,t2e=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,n2e=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,i2e=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,r2e=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,a2e=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,o2e=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,s2e=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,l2e=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,c2e=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,u2e=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,d2e=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,h2e=`#include <common>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,f2e=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,p2e=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,m2e=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,Bi={alphahash_fragment:Bbe,alphahash_pars_fragment:Ube,alphamap_fragment:Wbe,alphamap_pars_fragment:Vbe,alphatest_fragment:Gbe,alphatest_pars_fragment:Hbe,aomap_fragment:jbe,aomap_pars_fragment:$be,begin_vertex:Ybe,beginnormal_vertex:qbe,bsdfs:Xbe,iridescence_fragment:Zbe,bumpmap_pars_fragment:Kbe,clipping_planes_fragment:Jbe,clipping_planes_pars_fragment:Qbe,clipping_planes_pars_vertex:ewe,clipping_planes_vertex:twe,color_fragment:nwe,color_pars_fragment:iwe,color_pars_vertex:rwe,color_vertex:awe,common:owe,cube_uv_reflection_fragment:swe,defaultnormal_vertex:lwe,displacementmap_pars_vertex:cwe,displacementmap_vertex:uwe,emissivemap_fragment:dwe,emissivemap_pars_fragment:hwe,colorspace_fragment:fwe,colorspace_pars_fragment:pwe,envmap_fragment:mwe,envmap_common_pars_fragment:gwe,envmap_pars_fragment:ywe,envmap_pars_vertex:vwe,envmap_physical_pars_fragment:Iwe,envmap_vertex:_we,fog_vertex:xwe,fog_pars_vertex:bwe,fog_fragment:wwe,fog_pars_fragment:Swe,gradientmap_pars_fragment:Ewe,lightmap_fragment:Mwe,lightmap_pars_fragment:Twe,lights_lambert_fragment:Awe,lights_lambert_pars_fragment:Cwe,lights_pars_begin:Pwe,lights_toon_fragment:Rwe,lights_toon_pars_fragment:Lwe,lights_phong_fragment:kwe,lights_phong_pars_fragment:Dwe,lights_physical_fragment:zwe,lights_physical_pars_fragment:Owe,lights_fragment_begin:Nwe,lights_fragment_maps:Fwe,lights_fragment_end:Bwe,logdepthbuf_fragment:Uwe,logdepthbuf_pars_fragment:Wwe,logdepthbuf_pars_vertex:Vwe,logdepthbuf_vertex:Gwe,map_fragment:Hwe,map_pars_fragment:jwe,map_particle_fragment:$we,map_particle_pars_fragment:Ywe,metalnessmap_fragment:qwe,metalnessmap_pars_fragment:Xwe,morphcolor_vertex:Zwe,morphnormal_vertex:Kwe,morphtarget_pars_vertex:Jwe,morphtarget_vertex:Qwe,normal_fragment_begin:eSe,normal_fragment_maps:tSe,normal_pars_fragment:nSe,normal_pars_vertex:iSe,normal_vertex:rSe,normalmap_pars_fragment:aSe,clearcoat_normal_fragment_begin:oSe,clearcoat_normal_fragment_maps:sSe,clearcoat_pars_fragment:lSe,iridescence_pars_fragment:cSe,opaque_fragment:uSe,packing:dSe,premultiplied_alpha_fragment:hSe,project_vertex:fSe,dithering_fragment:pSe,dithering_pars_fragment:mSe,roughnessmap_fragment:gSe,roughnessmap_pars_fragment:ySe,shadowmap_pars_fragment:vSe,shadowmap_pars_vertex:_Se,shadowmap_vertex:xSe,shadowmask_pars_fragment:bSe,skinbase_vertex:wSe,skinning_pars_vertex:SSe,skinning_vertex:ESe,skinnormal_vertex:MSe,specularmap_fragment:TSe,specularmap_pars_fragment:ASe,tonemapping_fragment:CSe,tonemapping_pars_fragment:PSe,transmission_fragment:ISe,transmission_pars_fragment:RSe,uv_pars_fragment:LSe,uv_pars_vertex:kSe,uv_vertex:DSe,worldpos_vertex:zSe,background_vert:OSe,background_frag:NSe,backgroundCube_vert:FSe,backgroundCube_frag:BSe,cube_vert:USe,cube_frag:WSe,depth_vert:VSe,depth_frag:GSe,distanceRGBA_vert:HSe,distanceRGBA_frag:jSe,equirect_vert:$Se,equirect_frag:YSe,linedashed_vert:qSe,linedashed_frag:XSe,meshbasic_vert:ZSe,meshbasic_frag:KSe,meshlambert_vert:JSe,meshlambert_frag:QSe,meshmatcap_vert:e2e,meshmatcap_frag:t2e,meshnormal_vert:n2e,meshnormal_frag:i2e,meshphong_vert:r2e,meshphong_frag:a2e,meshphysical_vert:o2e,meshphysical_frag:s2e,meshtoon_vert:l2e,meshtoon_frag:c2e,points_vert:u2e,points_frag:d2e,shadow_vert:h2e,shadow_frag:f2e,sprite_vert:p2e,sprite_frag:m2e},Sn={common:{diffuse:{value:new In(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new Vi},alphaMap:{value:null},alphaMapTransform:{value:new Vi},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new Vi}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new Vi}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new Vi}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new Vi},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new Vi},normalScale:{value:new tn(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new Vi},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new Vi}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new Vi}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new Vi}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new In(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new In(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new Vi},alphaTest:{value:0},uvTransform:{value:new Vi}},sprite:{diffuse:{value:new In(16777215)},opacity:{value:1},center:{value:new tn(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new Vi},alphaMap:{value:null},alphaMapTransform:{value:new Vi},alphaTest:{value:0}}},pu={basic:{uniforms:Hs([Sn.common,Sn.specularmap,Sn.envmap,Sn.aomap,Sn.lightmap,Sn.fog]),vertexShader:Bi.meshbasic_vert,fragmentShader:Bi.meshbasic_frag},lambert:{uniforms:Hs([Sn.common,Sn.specularmap,Sn.envmap,Sn.aomap,Sn.lightmap,Sn.emissivemap,Sn.bumpmap,Sn.normalmap,Sn.displacementmap,Sn.fog,Sn.lights,{emissive:{value:new In(0)}}]),vertexShader:Bi.meshlambert_vert,fragmentShader:Bi.meshlambert_frag},phong:{uniforms:Hs([Sn.common,Sn.specularmap,Sn.envmap,Sn.aomap,Sn.lightmap,Sn.emissivemap,Sn.bumpmap,Sn.normalmap,Sn.displacementmap,Sn.fog,Sn.lights,{emissive:{value:new In(0)},specular:{value:new In(1118481)},shininess:{value:30}}]),vertexShader:Bi.meshphong_vert,fragmentShader:Bi.meshphong_frag},standard:{uniforms:Hs([Sn.common,Sn.envmap,Sn.aomap,Sn.lightmap,Sn.emissivemap,Sn.bumpmap,Sn.normalmap,Sn.displacementmap,Sn.roughnessmap,Sn.metalnessmap,Sn.fog,Sn.lights,{emissive:{value:new In(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Bi.meshphysical_vert,fragmentShader:Bi.meshphysical_frag},toon:{uniforms:Hs([Sn.common,Sn.aomap,Sn.lightmap,Sn.emissivemap,Sn.bumpmap,Sn.normalmap,Sn.displacementmap,Sn.gradientmap,Sn.fog,Sn.lights,{emissive:{value:new In(0)}}]),vertexShader:Bi.meshtoon_vert,fragmentShader:Bi.meshtoon_frag},matcap:{uniforms:Hs([Sn.common,Sn.bumpmap,Sn.normalmap,Sn.displacementmap,Sn.fog,{matcap:{value:null}}]),vertexShader:Bi.meshmatcap_vert,fragmentShader:Bi.meshmatcap_frag},points:{uniforms:Hs([Sn.points,Sn.fog]),vertexShader:Bi.points_vert,fragmentShader:Bi.points_frag},dashed:{uniforms:Hs([Sn.common,Sn.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Bi.linedashed_vert,fragmentShader:Bi.linedashed_frag},depth:{uniforms:Hs([Sn.common,Sn.displacementmap]),vertexShader:Bi.depth_vert,fragmentShader:Bi.depth_frag},normal:{uniforms:Hs([Sn.common,Sn.bumpmap,Sn.normalmap,Sn.displacementmap,{opacity:{value:1}}]),vertexShader:Bi.meshnormal_vert,fragmentShader:Bi.meshnormal_frag},sprite:{uniforms:Hs([Sn.sprite,Sn.fog]),vertexShader:Bi.sprite_vert,fragmentShader:Bi.sprite_frag},background:{uniforms:{uvTransform:{value:new Vi},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:Bi.background_vert,fragmentShader:Bi.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:Bi.backgroundCube_vert,fragmentShader:Bi.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Bi.cube_vert,fragmentShader:Bi.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Bi.equirect_vert,fragmentShader:Bi.equirect_frag},distanceRGBA:{uniforms:Hs([Sn.common,Sn.displacementmap,{referencePosition:{value:new We},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Bi.distanceRGBA_vert,fragmentShader:Bi.distanceRGBA_frag},shadow:{uniforms:Hs([Sn.lights,Sn.fog,{color:{value:new In(0)},opacity:{value:1}}]),vertexShader:Bi.shadow_vert,fragmentShader:Bi.shadow_frag}};pu.physical={uniforms:Hs([pu.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new Vi},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new Vi},clearcoatNormalScale:{value:new tn(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new Vi},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new Vi},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new Vi},sheen:{value:0},sheenColor:{value:new In(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new Vi},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new Vi},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new Vi},transmissionSamplerSize:{value:new tn},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new Vi},attenuationDistance:{value:0},attenuationColor:{value:new In(0)},specularColor:{value:new In(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new Vi},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new Vi},anisotropyVector:{value:new tn},anisotropyMap:{value:null},anisotropyMapTransform:{value:new Vi}}]),vertexShader:Bi.meshphysical_vert,fragmentShader:Bi.meshphysical_frag};const K3={r:0,b:0,g:0};function g2e(n,e,i,a,s,l,d){const f=new In(0);let p=l===!0?0:1,y,_,b=null,S=0,A=null;function P(k,R){let z=!1,O=R.isScene===!0?R.background:null;O&&O.isTexture&&(O=(R.backgroundBlurriness>0?i:e).get(O)),O===null?L(f,p):O&&O.isColor&&(L(O,1),z=!0);const F=n.xr.getEnvironmentBlendMode();F==="additive"?a.buffers.color.setClear(0,0,0,1,d):F==="alpha-blend"&&a.buffers.color.setClear(0,0,0,0,d),(n.autoClear||z)&&n.clear(n.autoClearColor,n.autoClearDepth,n.autoClearStencil),O&&(O.isCubeTexture||O.mapping===R_)?(_===void 0&&(_=new Eo(new ry(1,1,1),new Pd({name:"BackgroundCubeMaterial",uniforms:x_(pu.backgroundCube.uniforms),vertexShader:pu.backgroundCube.vertexShader,fragmentShader:pu.backgroundCube.fragmentShader,side:Ts,depthTest:!1,depthWrite:!1,fog:!1})),_.geometry.deleteAttribute("normal"),_.geometry.deleteAttribute("uv"),_.onBeforeRender=function(H,$,Y){this.matrixWorld.copyPosition(Y.matrixWorld)},Object.defineProperty(_.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),s.update(_)),_.material.uniforms.envMap.value=O,_.material.uniforms.flipEnvMap.value=O.isCubeTexture&&O.isRenderTargetTexture===!1?-1:1,_.material.uniforms.backgroundBlurriness.value=R.backgroundBlurriness,_.material.uniforms.backgroundIntensity.value=R.backgroundIntensity,_.material.toneMapped=Vr.getTransfer(O.colorSpace)!==ra,(b!==O||S!==O.version||A!==n.toneMapping)&&(_.material.needsUpdate=!0,b=O,S=O.version,A=n.toneMapping),_.layers.enableAll(),k.unshift(_,_.geometry,_.material,0,0,null)):O&&O.isTexture&&(y===void 0&&(y=new Eo(new Fp(2,2),new Pd({name:"BackgroundMaterial",uniforms:x_(pu.background.uniforms),vertexShader:pu.background.vertexShader,fragmentShader:pu.background.fragmentShader,side:Ad,depthTest:!1,depthWrite:!1,fog:!1})),y.geometry.deleteAttribute("normal"),Object.defineProperty(y.material,"map",{get:function(){return this.uniforms.t2D.value}}),s.update(y)),y.material.uniforms.t2D.value=O,y.material.uniforms.backgroundIntensity.value=R.backgroundIntensity,y.material.toneMapped=Vr.getTransfer(O.colorSpace)!==ra,O.matrixAutoUpdate===!0&&O.updateMatrix(),y.material.uniforms.uvTransform.value.copy(O.matrix),(b!==O||S!==O.version||A!==n.toneMapping)&&(y.material.needsUpdate=!0,b=O,S=O.version,A=n.toneMapping),y.layers.enableAll(),k.unshift(y,y.geometry,y.material,0,0,null))}function L(k,R){k.getRGB(K3,kZ(n)),a.buffers.color.setClear(K3.r,K3.g,K3.b,R,d)}return{getClearColor:function(){return f},setClearColor:function(k,R=1){f.set(k),p=R,L(f,p)},getClearAlpha:function(){return p},setClearAlpha:function(k){p=k,L(f,p)},render:P}}function y2e(n,e,i,a){const s=n.getParameter(n.MAX_VERTEX_ATTRIBS),l=a.isWebGL2?null:e.get("OES_vertex_array_object"),d=a.isWebGL2||l!==null,f={},p=k(null);let y=p,_=!1;function b(fe,Ae,Re,Be,le){let me=!1;if(d){const we=L(Be,Re,Ae);y!==we&&(y=we,A(y.object)),me=R(fe,Be,Re,le),me&&z(fe,Be,Re,le)}else{const we=Ae.wireframe===!0;(y.geometry!==Be.id||y.program!==Re.id||y.wireframe!==we)&&(y.geometry=Be.id,y.program=Re.id,y.wireframe=we,me=!0)}le!==null&&i.update(le,n.ELEMENT_ARRAY_BUFFER),(me||_)&&(_=!1,te(fe,Ae,Re,Be),le!==null&&n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,i.get(le).buffer))}function S(){return a.isWebGL2?n.createVertexArray():l.createVertexArrayOES()}function A(fe){return a.isWebGL2?n.bindVertexArray(fe):l.bindVertexArrayOES(fe)}function P(fe){return a.isWebGL2?n.deleteVertexArray(fe):l.deleteVertexArrayOES(fe)}function L(fe,Ae,Re){const Be=Re.wireframe===!0;let le=f[fe.id];le===void 0&&(le={},f[fe.id]=le);let me=le[Ae.id];me===void 0&&(me={},le[Ae.id]=me);let we=me[Be];return we===void 0&&(we=k(S()),me[Be]=we),we}function k(fe){const Ae=[],Re=[],Be=[];for(let le=0;le<s;le++)Ae[le]=0,Re[le]=0,Be[le]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:Ae,enabledAttributes:Re,attributeDivisors:Be,object:fe,attributes:{},index:null}}function R(fe,Ae,Re,Be){const le=y.attributes,me=Ae.attributes;let we=0;const re=Re.getAttributes();for(const Te in re)if(re[Te].location>=0){const Xe=le[Te];let Ze=me[Te];if(Ze===void 0&&(Te==="instanceMatrix"&&fe.instanceMatrix&&(Ze=fe.instanceMatrix),Te==="instanceColor"&&fe.instanceColor&&(Ze=fe.instanceColor)),Xe===void 0||Xe.attribute!==Ze||Ze&&Xe.data!==Ze.data)return!0;we++}return y.attributesNum!==we||y.index!==Be}function z(fe,Ae,Re,Be){const le={},me=Ae.attributes;let we=0;const re=Re.getAttributes();for(const Te in re)if(re[Te].location>=0){let Xe=me[Te];Xe===void 0&&(Te==="instanceMatrix"&&fe.instanceMatrix&&(Xe=fe.instanceMatrix),Te==="instanceColor"&&fe.instanceColor&&(Xe=fe.instanceColor));const Ze={};Ze.attribute=Xe,Xe&&Xe.data&&(Ze.data=Xe.data),le[Te]=Ze,we++}y.attributes=le,y.attributesNum=we,y.index=Be}function O(){const fe=y.newAttributes;for(let Ae=0,Re=fe.length;Ae<Re;Ae++)fe[Ae]=0}function F(fe){H(fe,0)}function H(fe,Ae){const Re=y.newAttributes,Be=y.enabledAttributes,le=y.attributeDivisors;Re[fe]=1,Be[fe]===0&&(n.enableVertexAttribArray(fe),Be[fe]=1),le[fe]!==Ae&&((a.isWebGL2?n:e.get("ANGLE_instanced_arrays"))[a.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](fe,Ae),le[fe]=Ae)}function $(){const fe=y.newAttributes,Ae=y.enabledAttributes;for(let Re=0,Be=Ae.length;Re<Be;Re++)Ae[Re]!==fe[Re]&&(n.disableVertexAttribArray(Re),Ae[Re]=0)}function Y(fe,Ae,Re,Be,le,me,we){we===!0?n.vertexAttribIPointer(fe,Ae,Re,le,me):n.vertexAttribPointer(fe,Ae,Re,Be,le,me)}function te(fe,Ae,Re,Be){if(a.isWebGL2===!1&&(fe.isInstancedMesh||Be.isInstancedBufferGeometry)&&e.get("ANGLE_instanced_arrays")===null)return;O();const le=Be.attributes,me=Re.getAttributes(),we=Ae.defaultAttributeValues;for(const re in me){const Te=me[re];if(Te.location>=0){let Je=le[re];if(Je===void 0&&(re==="instanceMatrix"&&fe.instanceMatrix&&(Je=fe.instanceMatrix),re==="instanceColor"&&fe.instanceColor&&(Je=fe.instanceColor)),Je!==void 0){const Xe=Je.normalized,Ze=Je.itemSize,Fe=i.get(Je);if(Fe===void 0)continue;const ct=Fe.buffer,At=Fe.type,kt=Fe.bytesPerElement,Kt=a.isWebGL2===!0&&(At===n.INT||At===n.UNSIGNED_INT||Je.gpuType===hz);if(Je.isInterleavedBufferAttribute){const Et=Je.data,Ie=Et.stride,pt=Je.offset;if(Et.isInstancedInterleavedBuffer){for(let gt=0;gt<Te.locationSize;gt++)H(Te.location+gt,Et.meshPerAttribute);fe.isInstancedMesh!==!0&&Be._maxInstanceCount===void 0&&(Be._maxInstanceCount=Et.meshPerAttribute*Et.count)}else for(let gt=0;gt<Te.locationSize;gt++)F(Te.location+gt);n.bindBuffer(n.ARRAY_BUFFER,ct);for(let gt=0;gt<Te.locationSize;gt++)Y(Te.location+gt,Ze/Te.locationSize,At,Xe,Ie*kt,(pt+Ze/Te.locationSize*gt)*kt,Kt)}else{if(Je.isInstancedBufferAttribute){for(let Et=0;Et<Te.locationSize;Et++)H(Te.location+Et,Je.meshPerAttribute);fe.isInstancedMesh!==!0&&Be._maxInstanceCount===void 0&&(Be._maxInstanceCount=Je.meshPerAttribute*Je.count)}else for(let Et=0;Et<Te.locationSize;Et++)F(Te.location+Et);n.bindBuffer(n.ARRAY_BUFFER,ct);for(let Et=0;Et<Te.locationSize;Et++)Y(Te.location+Et,Ze/Te.locationSize,At,Xe,Ze*kt,Ze/Te.locationSize*Et*kt,Kt)}}else if(we!==void 0){const Xe=we[re];if(Xe!==void 0)switch(Xe.length){case 2:n.vertexAttrib2fv(Te.location,Xe);break;case 3:n.vertexAttrib3fv(Te.location,Xe);break;case 4:n.vertexAttrib4fv(Te.location,Xe);break;default:n.vertexAttrib1fv(Te.location,Xe)}}}}$()}function G(){pe();for(const fe in f){const Ae=f[fe];for(const Re in Ae){const Be=Ae[Re];for(const le in Be)P(Be[le].object),delete Be[le];delete Ae[Re]}delete f[fe]}}function Q(fe){if(f[fe.id]===void 0)return;const Ae=f[fe.id];for(const Re in Ae){const Be=Ae[Re];for(const le in Be)P(Be[le].object),delete Be[le];delete Ae[Re]}delete f[fe.id]}function he(fe){for(const Ae in f){const Re=f[Ae];if(Re[fe.id]===void 0)continue;const Be=Re[fe.id];for(const le in Be)P(Be[le].object),delete Be[le];delete Re[fe.id]}}function pe(){ye(),_=!0,y!==p&&(y=p,A(y.object))}function ye(){p.geometry=null,p.program=null,p.wireframe=!1}return{setup:b,reset:pe,resetDefaultState:ye,dispose:G,releaseStatesOfGeometry:Q,releaseStatesOfProgram:he,initAttributes:O,enableAttribute:F,disableUnusedAttributes:$}}function v2e(n,e,i,a){const s=a.isWebGL2;let l;function d(y){l=y}function f(y,_){n.drawArrays(l,y,_),i.update(_,l,1)}function p(y,_,b){if(b===0)return;let S,A;if(s)S=n,A="drawArraysInstanced";else if(S=e.get("ANGLE_instanced_arrays"),A="drawArraysInstancedANGLE",S===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}S[A](l,y,_,b),i.update(_,l,b)}this.setMode=d,this.render=f,this.renderInstances=p}function _2e(n,e,i){let a;function s(){if(a!==void 0)return a;if(e.has("EXT_texture_filter_anisotropic")===!0){const Y=e.get("EXT_texture_filter_anisotropic");a=n.getParameter(Y.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else a=0;return a}function l(Y){if(Y==="highp"){if(n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.HIGH_FLOAT).precision>0&&n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.HIGH_FLOAT).precision>0)return"highp";Y="mediump"}return Y==="mediump"&&n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.MEDIUM_FLOAT).precision>0&&n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}const d=typeof WebGL2RenderingContext<"u"&&n.constructor.name==="WebGL2RenderingContext";let f=i.precision!==void 0?i.precision:"highp";const p=l(f);p!==f&&(console.warn("THREE.WebGLRenderer:",f,"not supported, using",p,"instead."),f=p);const y=d||e.has("WEBGL_draw_buffers"),_=i.logarithmicDepthBuffer===!0,b=n.getParameter(n.MAX_TEXTURE_IMAGE_UNITS),S=n.getParameter(n.MAX_VERTEX_TEXTURE_IMAGE_UNITS),A=n.getParameter(n.MAX_TEXTURE_SIZE),P=n.getParameter(n.MAX_CUBE_MAP_TEXTURE_SIZE),L=n.getParameter(n.MAX_VERTEX_ATTRIBS),k=n.getParameter(n.MAX_VERTEX_UNIFORM_VECTORS),R=n.getParameter(n.MAX_VARYING_VECTORS),z=n.getParameter(n.MAX_FRAGMENT_UNIFORM_VECTORS),O=S>0,F=d||e.has("OES_texture_float"),H=O&&F,$=d?n.getParameter(n.MAX_SAMPLES):0;return{isWebGL2:d,drawBuffers:y,getMaxAnisotropy:s,getMaxPrecision:l,precision:f,logarithmicDepthBuffer:_,maxTextures:b,maxVertexTextures:S,maxTextureSize:A,maxCubemapSize:P,maxAttributes:L,maxVertexUniforms:k,maxVaryings:R,maxFragmentUniforms:z,vertexTextures:O,floatFragmentTextures:F,floatVertexTextures:H,maxSamples:$}}function x2e(n){const e=this;let i=null,a=0,s=!1,l=!1;const d=new Ph,f=new Vi,p={value:null,needsUpdate:!1};this.uniform=p,this.numPlanes=0,this.numIntersection=0,this.init=function(b,S){const A=b.length!==0||S||a!==0||s;return s=S,a=b.length,A},this.beginShadows=function(){l=!0,_(null)},this.endShadows=function(){l=!1},this.setGlobalState=function(b,S){i=_(b,S,0)},this.setState=function(b,S,A){const P=b.clippingPlanes,L=b.clipIntersection,k=b.clipShadows,R=n.get(b);if(!s||P===null||P.length===0||l&&!k)l?_(null):y();else{const z=l?0:a,O=z*4;let F=R.clippingState||null;p.value=F,F=_(P,S,O,A);for(let H=0;H!==O;++H)F[H]=i[H];R.clippingState=F,this.numIntersection=L?this.numPlanes:0,this.numPlanes+=z}};function y(){p.value!==i&&(p.value=i,p.needsUpdate=a>0),e.numPlanes=a,e.numIntersection=0}function _(b,S,A,P){const L=b!==null?b.length:0;let k=null;if(L!==0){if(k=p.value,P!==!0||k===null){const R=A+L*4,z=S.matrixWorldInverse;f.getNormalMatrix(z),(k===null||k.length<R)&&(k=new Float32Array(R));for(let O=0,F=A;O!==L;++O,F+=4)d.copy(b[O]).applyMatrix4(z,f),d.normal.toArray(k,F),k[F+3]=d.constant}p.value=k,p.needsUpdate=!0}return e.numPlanes=L,e.numIntersection=0,k}}function b2e(n){let e=new WeakMap;function i(d,f){return f===lw?d.mapping=Yh:f===cw&&(d.mapping=Ap),d}function a(d){if(d&&d.isTexture&&d.isRenderTargetTexture===!1){const f=d.mapping;if(f===lw||f===cw)if(e.has(d)){const p=e.get(d).texture;return i(p,d.mapping)}else{const p=d.image;if(p&&p.height>0){const y=new zZ(p.height/2);return y.fromEquirectangularTexture(n,d),e.set(d,y),d.addEventListener("dispose",s),i(y.texture,d.mapping)}else return null}}return d}function s(d){const f=d.target;f.removeEventListener("dispose",s);const p=e.get(f);p!==void 0&&(e.delete(f),p.dispose())}function l(){e=new WeakMap}return{get:a,dispose:l}}class Oh extends nS{constructor(e=-1,i=1,a=1,s=-1,l=.1,d=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=i,this.top=a,this.bottom=s,this.near=l,this.far=d,this.updateProjectionMatrix()}copy(e,i){return super.copy(e,i),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,i,a,s,l,d){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=i,this.view.offsetX=a,this.view.offsetY=s,this.view.width=l,this.view.height=d,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),i=(this.top-this.bottom)/(2*this.zoom),a=(this.right+this.left)/2,s=(this.top+this.bottom)/2;let l=a-e,d=a+e,f=s+i,p=s-i;if(this.view!==null&&this.view.enabled){const y=(this.right-this.left)/this.view.fullWidth/this.zoom,_=(this.top-this.bottom)/this.view.fullHeight/this.zoom;l+=y*this.view.offsetX,d=l+y*this.view.width,f-=_*this.view.offsetY,p=f-_*this.view.height}this.projectionMatrix.makeOrthographic(l,d,f,p,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const i=super.toJSON(e);return i.object.zoom=this.zoom,i.object.left=this.left,i.object.right=this.right,i.object.top=this.top,i.object.bottom=this.bottom,i.object.near=this.near,i.object.far=this.far,this.view!==null&&(i.object.view=Object.assign({},this.view)),i}}const O0=4,e7=[.125,.215,.35,.446,.526,.582],fg=20,QR=new Oh,t7=new In;let eL=null,tL=0,nL=0;const ug=(1+Math.sqrt(5))/2,i0=1/ug,n7=[new We(1,1,1),new We(-1,1,1),new We(1,1,-1),new We(-1,1,-1),new We(0,ug,i0),new We(0,ug,-i0),new We(i0,0,ug),new We(-i0,0,ug),new We(ug,i0,0),new We(-ug,i0,0)];class V5{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,i=0,a=.1,s=100){eL=this._renderer.getRenderTarget(),tL=this._renderer.getActiveCubeFace(),nL=this._renderer.getActiveMipmapLevel(),this._setSize(256);const l=this._allocateTargets();return l.depthBuffer=!0,this._sceneToCubeUV(e,a,s,l),i>0&&this._blur(l,0,0,i),this._applyPMREM(l),this._cleanup(l),l}fromEquirectangular(e,i=null){return this._fromTexture(e,i)}fromCubemap(e,i=null){return this._fromTexture(e,i)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=a7(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=r7(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(eL,tL,nL),e.scissorTest=!1,J3(e,0,0,e.width,e.height)}_fromTexture(e,i){e.mapping===Yh||e.mapping===Ap?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),eL=this._renderer.getRenderTarget(),tL=this._renderer.getActiveCubeFace(),nL=this._renderer.getActiveMipmapLevel();const a=i||this._allocateTargets();return this._textureToCubeUV(e,a),this._applyPMREM(a),this._cleanup(a),a}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),i=4*this._cubeSize,a={magFilter:ka,minFilter:ka,generateMipmaps:!1,type:v_,format:vl,colorSpace:Cd,depthBuffer:!1},s=i7(e,i,a);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==i){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=i7(e,i,a);const{_lodMax:l}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=w2e(l)),this._blurMaterial=S2e(l,e,i)}return s}_compileMaterial(e){const i=new Eo(this._lodPlanes[0],e);this._renderer.compile(i,QR)}_sceneToCubeUV(e,i,a,s){const f=new Za(90,1,i,a),p=[1,-1,1,1,1,1],y=[1,1,1,-1,-1,-1],_=this._renderer,b=_.autoClear,S=_.toneMapping;_.getClearColor(t7),_.toneMapping=bd,_.autoClear=!1;const A=new Kh({name:"PMREM.Background",side:Ts,depthWrite:!1,depthTest:!1}),P=new Eo(new ry,A);let L=!1;const k=e.background;k?k.isColor&&(A.color.copy(k),e.background=null,L=!0):(A.color.copy(t7),L=!0);for(let R=0;R<6;R++){const z=R%3;z===0?(f.up.set(0,p[R],0),f.lookAt(y[R],0,0)):z===1?(f.up.set(0,0,p[R]),f.lookAt(0,y[R],0)):(f.up.set(0,p[R],0),f.lookAt(0,0,y[R]));const O=this._cubeSize;J3(s,z*O,R>2?O:0,O,O),_.setRenderTarget(s),L&&_.render(P,f),_.render(e,f)}P.geometry.dispose(),P.material.dispose(),_.toneMapping=S,_.autoClear=b,e.background=k}_textureToCubeUV(e,i){const a=this._renderer,s=e.mapping===Yh||e.mapping===Ap;s?(this._cubemapMaterial===null&&(this._cubemapMaterial=a7()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=r7());const l=s?this._cubemapMaterial:this._equirectMaterial,d=new Eo(this._lodPlanes[0],l),f=l.uniforms;f.envMap.value=e;const p=this._cubeSize;J3(i,0,0,3*p,2*p),a.setRenderTarget(i),a.render(d,QR)}_applyPMREM(e){const i=this._renderer,a=i.autoClear;i.autoClear=!1;for(let s=1;s<this._lodPlanes.length;s++){const l=Math.sqrt(this._sigmas[s]*this._sigmas[s]-this._sigmas[s-1]*this._sigmas[s-1]),d=n7[(s-1)%n7.length];this._blur(e,s-1,s,l,d)}i.autoClear=a}_blur(e,i,a,s,l){const d=this._pingPongRenderTarget;this._halfBlur(e,d,i,a,s,"latitudinal",l),this._halfBlur(d,e,a,a,s,"longitudinal",l)}_halfBlur(e,i,a,s,l,d,f){const p=this._renderer,y=this._blurMaterial;d!=="latitudinal"&&d!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const _=3,b=new Eo(this._lodPlanes[s],y),S=y.uniforms,A=this._sizeLods[a]-1,P=isFinite(l)?Math.PI/(2*A):2*Math.PI/(2*fg-1),L=l/P,k=isFinite(l)?1+Math.floor(_*L):fg;k>fg&&console.warn(`sigmaRadians, ${l}, is too large and will clip, as it requested ${k} samples when the maximum is set to ${fg}`);const R=[];let z=0;for(let Y=0;Y<fg;++Y){const te=Y/L,G=Math.exp(-te*te/2);R.push(G),Y===0?z+=G:Y<k&&(z+=2*G)}for(let Y=0;Y<R.length;Y++)R[Y]=R[Y]/z;S.envMap.value=e.texture,S.samples.value=k,S.weights.value=R,S.latitudinal.value=d==="latitudinal",f&&(S.poleAxis.value=f);const{_lodMax:O}=this;S.dTheta.value=P,S.mipInt.value=O-a;const F=this._sizeLods[s],H=3*F*(s>O-O0?s-O+O0:0),$=4*(this._cubeSize-F);J3(i,H,$,3*F,2*F),p.setRenderTarget(i),p.render(b,QR)}}function w2e(n){const e=[],i=[],a=[];let s=n;const l=n-O0+1+e7.length;for(let d=0;d<l;d++){const f=Math.pow(2,s);i.push(f);let p=1/f;d>n-O0?p=e7[d-n+O0-1]:d===0&&(p=0),a.push(p);const y=1/(f-2),_=-y,b=1+y,S=[_,_,b,_,b,b,_,_,b,b,_,b],A=6,P=6,L=3,k=2,R=1,z=new Float32Array(L*P*A),O=new Float32Array(k*P*A),F=new Float32Array(R*P*A);for(let $=0;$<A;$++){const Y=$%3*2/3-1,te=$>2?0:-1,G=[Y,te,0,Y+2/3,te,0,Y+2/3,te+1,0,Y,te,0,Y+2/3,te+1,0,Y,te+1,0];z.set(G,L*P*$),O.set(S,k*P*$);const Q=[$,$,$,$,$,$];F.set(Q,R*P*$)}const H=new zi;H.setAttribute("position",new Qr(z,L)),H.setAttribute("uv",new Qr(O,k)),H.setAttribute("faceIndex",new Qr(F,R)),e.push(H),s>O0&&s--}return{lodPlanes:e,sizeLods:i,sigmas:a}}function i7(n,e,i){const a=new wu(n,e,i);return a.texture.mapping=R_,a.texture.name="PMREM.cubeUv",a.scissorTest=!0,a}function J3(n,e,i,a,s){n.viewport.set(e,i,a,s),n.scissor.set(e,i,a,s)}function S2e(n,e,i){const a=new Float32Array(fg),s=new We(0,1,0);return new Pd({name:"SphericalGaussianBlur",defines:{n:fg,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/i,CUBEUV_MAX_MIP:`${n}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:a},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:s}},vertexShader:Az(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:Wh,depthTest:!1,depthWrite:!1})}function r7(){return new Pd({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:Az(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:Wh,depthTest:!1,depthWrite:!1})}function a7(){return new Pd({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:Az(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:Wh,depthTest:!1,depthWrite:!1})}function Az(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function E2e(n){let e=new WeakMap,i=null;function a(f){if(f&&f.isTexture){const p=f.mapping,y=p===lw||p===cw,_=p===Yh||p===Ap;if(y||_)if(f.isRenderTargetTexture&&f.needsPMREMUpdate===!0){f.needsPMREMUpdate=!1;let b=e.get(f);return i===null&&(i=new V5(n)),b=y?i.fromEquirectangular(f,b):i.fromCubemap(f,b),e.set(f,b),b.texture}else{if(e.has(f))return e.get(f).texture;{const b=f.image;if(y&&b&&b.height>0||_&&b&&s(b)){i===null&&(i=new V5(n));const S=y?i.fromEquirectangular(f):i.fromCubemap(f);return e.set(f,S),f.addEventListener("dispose",l),S.texture}else return null}}}return f}function s(f){let p=0;const y=6;for(let _=0;_<y;_++)f[_]!==void 0&&p++;return p===y}function l(f){const p=f.target;p.removeEventListener("dispose",l);const y=e.get(p);y!==void 0&&(e.delete(p),y.dispose())}function d(){e=new WeakMap,i!==null&&(i.dispose(),i=null)}return{get:a,dispose:d}}function M2e(n){const e={};function i(a){if(e[a]!==void 0)return e[a];let s;switch(a){case"WEBGL_depth_texture":s=n.getExtension("WEBGL_depth_texture")||n.getExtension("MOZ_WEBGL_depth_texture")||n.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":s=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":s=n.getExtension("WEBGL_compressed_texture_s3tc")||n.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":s=n.getExtension("WEBGL_compressed_texture_pvrtc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:s=n.getExtension(a)}return e[a]=s,s}return{has:function(a){return i(a)!==null},init:function(a){a.isWebGL2?i("EXT_color_buffer_float"):(i("WEBGL_depth_texture"),i("OES_texture_float"),i("OES_texture_half_float"),i("OES_texture_half_float_linear"),i("OES_standard_derivatives"),i("OES_element_index_uint"),i("OES_vertex_array_object"),i("ANGLE_instanced_arrays")),i("OES_texture_float_linear"),i("EXT_color_buffer_half_float"),i("WEBGL_multisampled_render_to_texture")},get:function(a){const s=i(a);return s===null&&console.warn("THREE.WebGLRenderer: "+a+" extension not supported."),s}}}function T2e(n,e,i,a){const s={},l=new WeakMap;function d(b){const S=b.target;S.index!==null&&e.remove(S.index);for(const P in S.attributes)e.remove(S.attributes[P]);for(const P in S.morphAttributes){const L=S.morphAttributes[P];for(let k=0,R=L.length;k<R;k++)e.remove(L[k])}S.removeEventListener("dispose",d),delete s[S.id];const A=l.get(S);A&&(e.remove(A),l.delete(S)),a.releaseStatesOfGeometry(S),S.isInstancedBufferGeometry===!0&&delete S._maxInstanceCount,i.memory.geometries--}function f(b,S){return s[S.id]===!0||(S.addEventListener("dispose",d),s[S.id]=!0,i.memory.geometries++),S}function p(b){const S=b.attributes;for(const P in S)e.update(S[P],n.ARRAY_BUFFER);const A=b.morphAttributes;for(const P in A){const L=A[P];for(let k=0,R=L.length;k<R;k++)e.update(L[k],n.ARRAY_BUFFER)}}function y(b){const S=[],A=b.index,P=b.attributes.position;let L=0;if(A!==null){const z=A.array;L=A.version;for(let O=0,F=z.length;O<F;O+=3){const H=z[O+0],$=z[O+1],Y=z[O+2];S.push(H,$,$,Y,Y,H)}}else if(P!==void 0){const z=P.array;L=P.version;for(let O=0,F=z.length/3-1;O<F;O+=3){const H=O+0,$=O+1,Y=O+2;S.push(H,$,$,Y,Y,H)}}else return;const k=new(PZ(S)?Mz:Ez)(S,1);k.version=L;const R=l.get(b);R&&e.remove(R),l.set(b,k)}function _(b){const S=l.get(b);if(S){const A=b.index;A!==null&&S.version<A.version&&y(b)}else y(b);return l.get(b)}return{get:f,update:p,getWireframeAttribute:_}}function A2e(n,e,i,a){const s=a.isWebGL2;let l;function d(S){l=S}let f,p;function y(S){f=S.type,p=S.bytesPerElement}function _(S,A){n.drawElements(l,A,f,S*p),i.update(A,l,1)}function b(S,A,P){if(P===0)return;let L,k;if(s)L=n,k="drawElementsInstanced";else if(L=e.get("ANGLE_instanced_arrays"),k="drawElementsInstancedANGLE",L===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}L[k](l,A,f,S*p,P),i.update(A,l,P)}this.setMode=d,this.setIndex=y,this.render=_,this.renderInstances=b}function C2e(n){const e={geometries:0,textures:0},i={frame:0,calls:0,triangles:0,points:0,lines:0};function a(l,d,f){switch(i.calls++,d){case n.TRIANGLES:i.triangles+=f*(l/3);break;case n.LINES:i.lines+=f*(l/2);break;case n.LINE_STRIP:i.lines+=f*(l-1);break;case n.LINE_LOOP:i.lines+=f*l;break;case n.POINTS:i.points+=f*l;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",d);break}}function s(){i.calls=0,i.triangles=0,i.points=0,i.lines=0}return{memory:e,render:i,programs:null,autoReset:!0,reset:s,update:a}}function P2e(n,e){return n[0]-e[0]}function I2e(n,e){return Math.abs(e[1])-Math.abs(n[1])}function R2e(n,e,i){const a={},s=new Float32Array(8),l=new WeakMap,d=new Lr,f=[];for(let y=0;y<8;y++)f[y]=[y,0];function p(y,_,b){const S=y.morphTargetInfluences;if(e.isWebGL2===!0){const P=_.morphAttributes.position||_.morphAttributes.normal||_.morphAttributes.color,L=P!==void 0?P.length:0;let k=l.get(_);if(k===void 0||k.count!==L){let Ae=function(){ye.dispose(),l.delete(_),_.removeEventListener("dispose",Ae)};var A=Ae;k!==void 0&&k.texture.dispose();const O=_.morphAttributes.position!==void 0,F=_.morphAttributes.normal!==void 0,H=_.morphAttributes.color!==void 0,$=_.morphAttributes.position||[],Y=_.morphAttributes.normal||[],te=_.morphAttributes.color||[];let G=0;O===!0&&(G=1),F===!0&&(G=2),H===!0&&(G=3);let Q=_.attributes.position.count*G,he=1;Q>e.maxTextureSize&&(he=Math.ceil(Q/e.maxTextureSize),Q=e.maxTextureSize);const pe=new Float32Array(Q*he*4*L),ye=new JA(pe,Q,he,L);ye.type=md,ye.needsUpdate=!0;const fe=G*4;for(let Re=0;Re<L;Re++){const Be=$[Re],le=Y[Re],me=te[Re],we=Q*he*4*Re;for(let re=0;re<Be.count;re++){const Te=re*fe;O===!0&&(d.fromBufferAttribute(Be,re),pe[we+Te+0]=d.x,pe[we+Te+1]=d.y,pe[we+Te+2]=d.z,pe[we+Te+3]=0),F===!0&&(d.fromBufferAttribute(le,re),pe[we+Te+4]=d.x,pe[we+Te+5]=d.y,pe[we+Te+6]=d.z,pe[we+Te+7]=0),H===!0&&(d.fromBufferAttribute(me,re),pe[we+Te+8]=d.x,pe[we+Te+9]=d.y,pe[we+Te+10]=d.z,pe[we+Te+11]=me.itemSize===4?d.w:1)}}k={count:L,texture:ye,size:new tn(Q,he)},l.set(_,k),_.addEventListener("dispose",Ae)}let R=0;for(let O=0;O<S.length;O++)R+=S[O];const z=_.morphTargetsRelative?1:1-R;b.getUniforms().setValue(n,"morphTargetBaseInfluence",z),b.getUniforms().setValue(n,"morphTargetInfluences",S),b.getUniforms().setValue(n,"morphTargetsTexture",k.texture,i),b.getUniforms().setValue(n,"morphTargetsTextureSize",k.size)}else{const P=S===void 0?0:S.length;let L=a[_.id];if(L===void 0||L.length!==P){L=[];for(let F=0;F<P;F++)L[F]=[F,0];a[_.id]=L}for(let F=0;F<P;F++){const H=L[F];H[0]=F,H[1]=S[F]}L.sort(I2e);for(let F=0;F<8;F++)F<P&&L[F][1]?(f[F][0]=L[F][0],f[F][1]=L[F][1]):(f[F][0]=Number.MAX_SAFE_INTEGER,f[F][1]=0);f.sort(P2e);const k=_.morphAttributes.position,R=_.morphAttributes.normal;let z=0;for(let F=0;F<8;F++){const H=f[F],$=H[0],Y=H[1];$!==Number.MAX_SAFE_INTEGER&&Y?(k&&_.getAttribute("morphTarget"+F)!==k[$]&&_.setAttribute("morphTarget"+F,k[$]),R&&_.getAttribute("morphNormal"+F)!==R[$]&&_.setAttribute("morphNormal"+F,R[$]),s[F]=Y,z+=Y):(k&&_.hasAttribute("morphTarget"+F)===!0&&_.deleteAttribute("morphTarget"+F),R&&_.hasAttribute("morphNormal"+F)===!0&&_.deleteAttribute("morphNormal"+F),s[F]=0)}const O=_.morphTargetsRelative?1:1-z;b.getUniforms().setValue(n,"morphTargetBaseInfluence",O),b.getUniforms().setValue(n,"morphTargetInfluences",s)}}return{update:p}}function L2e(n,e,i,a){let s=new WeakMap;function l(p){const y=a.render.frame,_=p.geometry,b=e.get(p,_);if(s.get(b)!==y&&(e.update(b),s.set(b,y)),p.isInstancedMesh&&(p.hasEventListener("dispose",f)===!1&&p.addEventListener("dispose",f),s.get(p)!==y&&(i.update(p.instanceMatrix,n.ARRAY_BUFFER),p.instanceColor!==null&&i.update(p.instanceColor,n.ARRAY_BUFFER),s.set(p,y))),p.isSkinnedMesh){const S=p.skeleton;s.get(S)!==y&&(S.update(),s.set(S,y))}return b}function d(){s=new WeakMap}function f(p){const y=p.target;y.removeEventListener("dispose",f),i.remove(y.instanceMatrix),y.instanceColor!==null&&i.remove(y.instanceColor)}return{update:l,dispose:d}}const NZ=new Oa,FZ=new JA,BZ=new Sz,UZ=new iS,o7=[],s7=[],l7=new Float32Array(16),c7=new Float32Array(9),u7=new Float32Array(4);function L_(n,e,i){const a=n[0];if(a<=0||a>0)return n;const s=e*i;let l=o7[s];if(l===void 0&&(l=new Float32Array(s),o7[s]=l),e!==0){a.toArray(l,0);for(let d=1,f=0;d!==e;++d)f+=i,n[d].toArray(l,f)}return l}function Oo(n,e){if(n.length!==e.length)return!1;for(let i=0,a=n.length;i<a;i++)if(n[i]!==e[i])return!1;return!0}function No(n,e){for(let i=0,a=e.length;i<a;i++)n[i]=e[i]}function eC(n,e){let i=s7[e];i===void 0&&(i=new Int32Array(e),s7[e]=i);for(let a=0;a!==e;++a)i[a]=n.allocateTextureUnit();return i}function k2e(n,e){const i=this.cache;i[0]!==e&&(n.uniform1f(this.addr,e),i[0]=e)}function D2e(n,e){const i=this.cache;if(e.x!==void 0)(i[0]!==e.x||i[1]!==e.y)&&(n.uniform2f(this.addr,e.x,e.y),i[0]=e.x,i[1]=e.y);else{if(Oo(i,e))return;n.uniform2fv(this.addr,e),No(i,e)}}function z2e(n,e){const i=this.cache;if(e.x!==void 0)(i[0]!==e.x||i[1]!==e.y||i[2]!==e.z)&&(n.uniform3f(this.addr,e.x,e.y,e.z),i[0]=e.x,i[1]=e.y,i[2]=e.z);else if(e.r!==void 0)(i[0]!==e.r||i[1]!==e.g||i[2]!==e.b)&&(n.uniform3f(this.addr,e.r,e.g,e.b),i[0]=e.r,i[1]=e.g,i[2]=e.b);else{if(Oo(i,e))return;n.uniform3fv(this.addr,e),No(i,e)}}function O2e(n,e){const i=this.cache;if(e.x!==void 0)(i[0]!==e.x||i[1]!==e.y||i[2]!==e.z||i[3]!==e.w)&&(n.uniform4f(this.addr,e.x,e.y,e.z,e.w),i[0]=e.x,i[1]=e.y,i[2]=e.z,i[3]=e.w);else{if(Oo(i,e))return;n.uniform4fv(this.addr,e),No(i,e)}}function N2e(n,e){const i=this.cache,a=e.elements;if(a===void 0){if(Oo(i,e))return;n.uniformMatrix2fv(this.addr,!1,e),No(i,e)}else{if(Oo(i,a))return;u7.set(a),n.uniformMatrix2fv(this.addr,!1,u7),No(i,a)}}function F2e(n,e){const i=this.cache,a=e.elements;if(a===void 0){if(Oo(i,e))return;n.uniformMatrix3fv(this.addr,!1,e),No(i,e)}else{if(Oo(i,a))return;c7.set(a),n.uniformMatrix3fv(this.addr,!1,c7),No(i,a)}}function B2e(n,e){const i=this.cache,a=e.elements;if(a===void 0){if(Oo(i,e))return;n.uniformMatrix4fv(this.addr,!1,e),No(i,e)}else{if(Oo(i,a))return;l7.set(a),n.uniformMatrix4fv(this.addr,!1,l7),No(i,a)}}function U2e(n,e){const i=this.cache;i[0]!==e&&(n.uniform1i(this.addr,e),i[0]=e)}function W2e(n,e){const i=this.cache;if(e.x!==void 0)(i[0]!==e.x||i[1]!==e.y)&&(n.uniform2i(this.addr,e.x,e.y),i[0]=e.x,i[1]=e.y);else{if(Oo(i,e))return;n.uniform2iv(this.addr,e),No(i,e)}}function V2e(n,e){const i=this.cache;if(e.x!==void 0)(i[0]!==e.x||i[1]!==e.y||i[2]!==e.z)&&(n.uniform3i(this.addr,e.x,e.y,e.z),i[0]=e.x,i[1]=e.y,i[2]=e.z);else{if(Oo(i,e))return;n.uniform3iv(this.addr,e),No(i,e)}}function G2e(n,e){const i=this.cache;if(e.x!==void 0)(i[0]!==e.x||i[1]!==e.y||i[2]!==e.z||i[3]!==e.w)&&(n.uniform4i(this.addr,e.x,e.y,e.z,e.w),i[0]=e.x,i[1]=e.y,i[2]=e.z,i[3]=e.w);else{if(Oo(i,e))return;n.uniform4iv(this.addr,e),No(i,e)}}function H2e(n,e){const i=this.cache;i[0]!==e&&(n.uniform1ui(this.addr,e),i[0]=e)}function j2e(n,e){const i=this.cache;if(e.x!==void 0)(i[0]!==e.x||i[1]!==e.y)&&(n.uniform2ui(this.addr,e.x,e.y),i[0]=e.x,i[1]=e.y);else{if(Oo(i,e))return;n.uniform2uiv(this.addr,e),No(i,e)}}function $2e(n,e){const i=this.cache;if(e.x!==void 0)(i[0]!==e.x||i[1]!==e.y||i[2]!==e.z)&&(n.uniform3ui(this.addr,e.x,e.y,e.z),i[0]=e.x,i[1]=e.y,i[2]=e.z);else{if(Oo(i,e))return;n.uniform3uiv(this.addr,e),No(i,e)}}function Y2e(n,e){const i=this.cache;if(e.x!==void 0)(i[0]!==e.x||i[1]!==e.y||i[2]!==e.z||i[3]!==e.w)&&(n.uniform4ui(this.addr,e.x,e.y,e.z,e.w),i[0]=e.x,i[1]=e.y,i[2]=e.z,i[3]=e.w);else{if(Oo(i,e))return;n.uniform4uiv(this.addr,e),No(i,e)}}function q2e(n,e,i){const a=this.cache,s=i.allocateTextureUnit();a[0]!==s&&(n.uniform1i(this.addr,s),a[0]=s),i.setTexture2D(e||NZ,s)}function X2e(n,e,i){const a=this.cache,s=i.allocateTextureUnit();a[0]!==s&&(n.uniform1i(this.addr,s),a[0]=s),i.setTexture3D(e||BZ,s)}function Z2e(n,e,i){const a=this.cache,s=i.allocateTextureUnit();a[0]!==s&&(n.uniform1i(this.addr,s),a[0]=s),i.setTextureCube(e||UZ,s)}function K2e(n,e,i){const a=this.cache,s=i.allocateTextureUnit();a[0]!==s&&(n.uniform1i(this.addr,s),a[0]=s),i.setTexture2DArray(e||FZ,s)}function J2e(n){switch(n){case 5126:return k2e;case 35664:return D2e;case 35665:return z2e;case 35666:return O2e;case 35674:return N2e;case 35675:return F2e;case 35676:return B2e;case 5124:case 35670:return U2e;case 35667:case 35671:return W2e;case 35668:case 35672:return V2e;case 35669:case 35673:return G2e;case 5125:return H2e;case 36294:return j2e;case 36295:return $2e;case 36296:return Y2e;case 35678:case 36198:case 36298:case 36306:case 35682:return q2e;case 35679:case 36299:case 36307:return X2e;case 35680:case 36300:case 36308:case 36293:return Z2e;case 36289:case 36303:case 36311:case 36292:return K2e}}function Q2e(n,e){n.uniform1fv(this.addr,e)}function e3e(n,e){const i=L_(e,this.size,2);n.uniform2fv(this.addr,i)}function t3e(n,e){const i=L_(e,this.size,3);n.uniform3fv(this.addr,i)}function n3e(n,e){const i=L_(e,this.size,4);n.uniform4fv(this.addr,i)}function i3e(n,e){const i=L_(e,this.size,4);n.uniformMatrix2fv(this.addr,!1,i)}function r3e(n,e){const i=L_(e,this.size,9);n.uniformMatrix3fv(this.addr,!1,i)}function a3e(n,e){const i=L_(e,this.size,16);n.uniformMatrix4fv(this.addr,!1,i)}function o3e(n,e){n.uniform1iv(this.addr,e)}function s3e(n,e){n.uniform2iv(this.addr,e)}function l3e(n,e){n.uniform3iv(this.addr,e)}function c3e(n,e){n.uniform4iv(this.addr,e)}function u3e(n,e){n.uniform1uiv(this.addr,e)}function d3e(n,e){n.uniform2uiv(this.addr,e)}function h3e(n,e){n.uniform3uiv(this.addr,e)}function f3e(n,e){n.uniform4uiv(this.addr,e)}function p3e(n,e,i){const a=this.cache,s=e.length,l=eC(i,s);Oo(a,l)||(n.uniform1iv(this.addr,l),No(a,l));for(let d=0;d!==s;++d)i.setTexture2D(e[d]||NZ,l[d])}function m3e(n,e,i){const a=this.cache,s=e.length,l=eC(i,s);Oo(a,l)||(n.uniform1iv(this.addr,l),No(a,l));for(let d=0;d!==s;++d)i.setTexture3D(e[d]||BZ,l[d])}function g3e(n,e,i){const a=this.cache,s=e.length,l=eC(i,s);Oo(a,l)||(n.uniform1iv(this.addr,l),No(a,l));for(let d=0;d!==s;++d)i.setTextureCube(e[d]||UZ,l[d])}function y3e(n,e,i){const a=this.cache,s=e.length,l=eC(i,s);Oo(a,l)||(n.uniform1iv(this.addr,l),No(a,l));for(let d=0;d!==s;++d)i.setTexture2DArray(e[d]||FZ,l[d])}function v3e(n){switch(n){case 5126:return Q2e;case 35664:return e3e;case 35665:return t3e;case 35666:return n3e;case 35674:return i3e;case 35675:return r3e;case 35676:return a3e;case 5124:case 35670:return o3e;case 35667:case 35671:return s3e;case 35668:case 35672:return l3e;case 35669:case 35673:return c3e;case 5125:return u3e;case 36294:return d3e;case 36295:return h3e;case 36296:return f3e;case 35678:case 36198:case 36298:case 36306:case 35682:return p3e;case 35679:case 36299:case 36307:return m3e;case 35680:case 36300:case 36308:case 36293:return g3e;case 36289:case 36303:case 36311:case 36292:return y3e}}class _3e{constructor(e,i,a){this.id=e,this.addr=a,this.cache=[],this.setValue=J2e(i.type)}}class x3e{constructor(e,i,a){this.id=e,this.addr=a,this.cache=[],this.size=i.size,this.setValue=v3e(i.type)}}class b3e{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,i,a){const s=this.seq;for(let l=0,d=s.length;l!==d;++l){const f=s[l];f.setValue(e,i[f.id],a)}}}const iL=/(\w+)(\])?(\[|\.)?/g;function d7(n,e){n.seq.push(e),n.map[e.id]=e}function w3e(n,e,i){const a=n.name,s=a.length;for(iL.lastIndex=0;;){const l=iL.exec(a),d=iL.lastIndex;let f=l[1];const p=l[2]==="]",y=l[3];if(p&&(f=f|0),y===void 0||y==="["&&d+2===s){d7(i,y===void 0?new _3e(f,n,e):new x3e(f,n,e));break}else{let b=i.map[f];b===void 0&&(b=new b3e(f),d7(i,b)),i=b}}}class _M{constructor(e,i){this.seq=[],this.map={};const a=e.getProgramParameter(i,e.ACTIVE_UNIFORMS);for(let s=0;s<a;++s){const l=e.getActiveUniform(i,s),d=e.getUniformLocation(i,l.name);w3e(l,d,this)}}setValue(e,i,a,s){const l=this.map[i];l!==void 0&&l.setValue(e,a,s)}setOptional(e,i,a){const s=i[a];s!==void 0&&this.setValue(e,a,s)}static upload(e,i,a,s){for(let l=0,d=i.length;l!==d;++l){const f=i[l],p=a[f.id];p.needsUpdate!==!1&&f.setValue(e,p.value,s)}}static seqWithValue(e,i){const a=[];for(let s=0,l=e.length;s!==l;++s){const d=e[s];d.id in i&&a.push(d)}return a}}function h7(n,e,i){const a=n.createShader(e);return n.shaderSource(a,i),n.compileShader(a),a}const S3e=37297;let E3e=0;function M3e(n,e){const i=n.split(`
`),a=[],s=Math.max(e-6,0),l=Math.min(e+6,i.length);for(let d=s;d<l;d++){const f=d+1;a.push(`${f===e?">":" "} ${f}: ${i[d]}`)}return a.join(`
`)}function T3e(n){const e=Vr.getPrimaries(Vr.workingColorSpace),i=Vr.getPrimaries(n);let a;switch(e===i?a="":e===yw&&i===gw?a="LinearDisplayP3ToLinearSRGB":e===gw&&i===yw&&(a="LinearSRGBToLinearDisplayP3"),n){case Cd:case eS:return[a,"LinearTransferOETF"];case Lo:case KA:return[a,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space:",n),[a,"LinearTransferOETF"]}}function f7(n,e,i){const a=n.getShaderParameter(e,n.COMPILE_STATUS),s=n.getShaderInfoLog(e).trim();if(a&&s==="")return"";const l=/ERROR: 0:(\d+)/.exec(s);if(l){const d=parseInt(l[1]);return i.toUpperCase()+`

`+s+`

`+M3e(n.getShaderSource(e),d)}else return s}function A3e(n,e){const i=T3e(e);return`vec4 ${n}( vec4 value ) { return ${i[0]}( ${i[1]}( value ) ); }`}function C3e(n,e){let i;switch(e){case tZ:i="Linear";break;case nZ:i="Reinhard";break;case iZ:i="OptimizedCineon";break;case uz:i="ACESFilmic";break;case rZ:i="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),i="Linear"}return"vec3 "+n+"( vec3 color ) { return "+i+"ToneMapping( color ); }"}function P3e(n){return[n.extensionDerivatives||n.envMapCubeUVHeight||n.bumpMap||n.normalMapTangentSpace||n.clearcoatNormalMap||n.flatShading||n.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(n.extensionFragDepth||n.logarithmicDepthBuffer)&&n.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",n.extensionDrawBuffers&&n.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(n.extensionShaderTextureLOD||n.envMap||n.transmission)&&n.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(qx).join(`
`)}function I3e(n){const e=[];for(const i in n){const a=n[i];a!==!1&&e.push("#define "+i+" "+a)}return e.join(`
`)}function R3e(n,e){const i={},a=n.getProgramParameter(e,n.ACTIVE_ATTRIBUTES);for(let s=0;s<a;s++){const l=n.getActiveAttrib(e,s),d=l.name;let f=1;l.type===n.FLOAT_MAT2&&(f=2),l.type===n.FLOAT_MAT3&&(f=3),l.type===n.FLOAT_MAT4&&(f=4),i[d]={type:l.type,location:n.getAttribLocation(e,d),locationSize:f}}return i}function qx(n){return n!==""}function p7(n,e){const i=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return n.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,i).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function m7(n,e){return n.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const L3e=/^[ \t]*#include +<([\w\d./]+)>/gm;function G5(n){return n.replace(L3e,D3e)}const k3e=new Map([["encodings_fragment","colorspace_fragment"],["encodings_pars_fragment","colorspace_pars_fragment"],["output_fragment","opaque_fragment"]]);function D3e(n,e){let i=Bi[e];if(i===void 0){const a=k3e.get(e);if(a!==void 0)i=Bi[a],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,a);else throw new Error("Can not resolve #include <"+e+">")}return G5(i)}const z3e=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function g7(n){return n.replace(z3e,O3e)}function O3e(n,e,i,a){let s="";for(let l=parseInt(e);l<parseInt(i);l++)s+=a.replace(/\[\s*i\s*\]/g,"[ "+l+" ]").replace(/UNROLLED_LOOP_INDEX/g,l);return s}function y7(n){let e="precision "+n.precision+` float;
precision `+n.precision+" int;";return n.precision==="highp"?e+=`
#define HIGH_PRECISION`:n.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:n.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function N3e(n){let e="SHADOWMAP_TYPE_BASIC";return n.shadowMapType===YA?e="SHADOWMAP_TYPE_PCF":n.shadowMapType===vb?e="SHADOWMAP_TYPE_PCF_SOFT":n.shadowMapType===uu&&(e="SHADOWMAP_TYPE_VSM"),e}function F3e(n){let e="ENVMAP_TYPE_CUBE";if(n.envMap)switch(n.envMapMode){case Yh:case Ap:e="ENVMAP_TYPE_CUBE";break;case R_:e="ENVMAP_TYPE_CUBE_UV";break}return e}function B3e(n){let e="ENVMAP_MODE_REFLECTION";if(n.envMap)switch(n.envMapMode){case Ap:e="ENVMAP_MODE_REFRACTION";break}return e}function U3e(n){let e="ENVMAP_BLENDING_NONE";if(n.envMap)switch(n.combine){case Qw:e="ENVMAP_BLENDING_MULTIPLY";break;case QX:e="ENVMAP_BLENDING_MIX";break;case eZ:e="ENVMAP_BLENDING_ADD";break}return e}function W3e(n){const e=n.envMapCubeUVHeight;if(e===null)return null;const i=Math.log2(e)-2,a=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,i),7*16)),texelHeight:a,maxMip:i}}function V3e(n,e,i,a){const s=n.getContext(),l=i.defines;let d=i.vertexShader,f=i.fragmentShader;const p=N3e(i),y=F3e(i),_=B3e(i),b=U3e(i),S=W3e(i),A=i.isWebGL2?"":P3e(i),P=I3e(l),L=s.createProgram();let k,R,z=i.glslVersion?"#version "+i.glslVersion+`
`:"";i.isRawShaderMaterial?(k=["#define SHADER_TYPE "+i.shaderType,"#define SHADER_NAME "+i.shaderName,P].filter(qx).join(`
`),k.length>0&&(k+=`
`),R=[A,"#define SHADER_TYPE "+i.shaderType,"#define SHADER_NAME "+i.shaderName,P].filter(qx).join(`
`),R.length>0&&(R+=`
`)):(k=[y7(i),"#define SHADER_TYPE "+i.shaderType,"#define SHADER_NAME "+i.shaderName,P,i.instancing?"#define USE_INSTANCING":"",i.instancingColor?"#define USE_INSTANCING_COLOR":"",i.useFog&&i.fog?"#define USE_FOG":"",i.useFog&&i.fogExp2?"#define FOG_EXP2":"",i.map?"#define USE_MAP":"",i.envMap?"#define USE_ENVMAP":"",i.envMap?"#define "+_:"",i.lightMap?"#define USE_LIGHTMAP":"",i.aoMap?"#define USE_AOMAP":"",i.bumpMap?"#define USE_BUMPMAP":"",i.normalMap?"#define USE_NORMALMAP":"",i.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",i.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",i.displacementMap?"#define USE_DISPLACEMENTMAP":"",i.emissiveMap?"#define USE_EMISSIVEMAP":"",i.anisotropy?"#define USE_ANISOTROPY":"",i.anisotropyMap?"#define USE_ANISOTROPYMAP":"",i.clearcoatMap?"#define USE_CLEARCOATMAP":"",i.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",i.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",i.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",i.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",i.specularMap?"#define USE_SPECULARMAP":"",i.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",i.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",i.roughnessMap?"#define USE_ROUGHNESSMAP":"",i.metalnessMap?"#define USE_METALNESSMAP":"",i.alphaMap?"#define USE_ALPHAMAP":"",i.alphaHash?"#define USE_ALPHAHASH":"",i.transmission?"#define USE_TRANSMISSION":"",i.transmissionMap?"#define USE_TRANSMISSIONMAP":"",i.thicknessMap?"#define USE_THICKNESSMAP":"",i.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",i.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",i.mapUv?"#define MAP_UV "+i.mapUv:"",i.alphaMapUv?"#define ALPHAMAP_UV "+i.alphaMapUv:"",i.lightMapUv?"#define LIGHTMAP_UV "+i.lightMapUv:"",i.aoMapUv?"#define AOMAP_UV "+i.aoMapUv:"",i.emissiveMapUv?"#define EMISSIVEMAP_UV "+i.emissiveMapUv:"",i.bumpMapUv?"#define BUMPMAP_UV "+i.bumpMapUv:"",i.normalMapUv?"#define NORMALMAP_UV "+i.normalMapUv:"",i.displacementMapUv?"#define DISPLACEMENTMAP_UV "+i.displacementMapUv:"",i.metalnessMapUv?"#define METALNESSMAP_UV "+i.metalnessMapUv:"",i.roughnessMapUv?"#define ROUGHNESSMAP_UV "+i.roughnessMapUv:"",i.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+i.anisotropyMapUv:"",i.clearcoatMapUv?"#define CLEARCOATMAP_UV "+i.clearcoatMapUv:"",i.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+i.clearcoatNormalMapUv:"",i.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+i.clearcoatRoughnessMapUv:"",i.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+i.iridescenceMapUv:"",i.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+i.iridescenceThicknessMapUv:"",i.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+i.sheenColorMapUv:"",i.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+i.sheenRoughnessMapUv:"",i.specularMapUv?"#define SPECULARMAP_UV "+i.specularMapUv:"",i.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+i.specularColorMapUv:"",i.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+i.specularIntensityMapUv:"",i.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+i.transmissionMapUv:"",i.thicknessMapUv?"#define THICKNESSMAP_UV "+i.thicknessMapUv:"",i.vertexTangents&&i.flatShading===!1?"#define USE_TANGENT":"",i.vertexColors?"#define USE_COLOR":"",i.vertexAlphas?"#define USE_COLOR_ALPHA":"",i.vertexUv1s?"#define USE_UV1":"",i.vertexUv2s?"#define USE_UV2":"",i.vertexUv3s?"#define USE_UV3":"",i.pointsUvs?"#define USE_POINTS_UV":"",i.flatShading?"#define FLAT_SHADED":"",i.skinning?"#define USE_SKINNING":"",i.morphTargets?"#define USE_MORPHTARGETS":"",i.morphNormals&&i.flatShading===!1?"#define USE_MORPHNORMALS":"",i.morphColors&&i.isWebGL2?"#define USE_MORPHCOLORS":"",i.morphTargetsCount>0&&i.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",i.morphTargetsCount>0&&i.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+i.morphTextureStride:"",i.morphTargetsCount>0&&i.isWebGL2?"#define MORPHTARGETS_COUNT "+i.morphTargetsCount:"",i.doubleSided?"#define DOUBLE_SIDED":"",i.flipSided?"#define FLIP_SIDED":"",i.shadowMapEnabled?"#define USE_SHADOWMAP":"",i.shadowMapEnabled?"#define "+p:"",i.sizeAttenuation?"#define USE_SIZEATTENUATION":"",i.numLightProbes>0?"#define USE_LIGHT_PROBES":"",i.useLegacyLights?"#define LEGACY_LIGHTS":"",i.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",i.logarithmicDepthBuffer&&i.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(qx).join(`
`),R=[A,y7(i),"#define SHADER_TYPE "+i.shaderType,"#define SHADER_NAME "+i.shaderName,P,i.useFog&&i.fog?"#define USE_FOG":"",i.useFog&&i.fogExp2?"#define FOG_EXP2":"",i.map?"#define USE_MAP":"",i.matcap?"#define USE_MATCAP":"",i.envMap?"#define USE_ENVMAP":"",i.envMap?"#define "+y:"",i.envMap?"#define "+_:"",i.envMap?"#define "+b:"",S?"#define CUBEUV_TEXEL_WIDTH "+S.texelWidth:"",S?"#define CUBEUV_TEXEL_HEIGHT "+S.texelHeight:"",S?"#define CUBEUV_MAX_MIP "+S.maxMip+".0":"",i.lightMap?"#define USE_LIGHTMAP":"",i.aoMap?"#define USE_AOMAP":"",i.bumpMap?"#define USE_BUMPMAP":"",i.normalMap?"#define USE_NORMALMAP":"",i.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",i.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",i.emissiveMap?"#define USE_EMISSIVEMAP":"",i.anisotropy?"#define USE_ANISOTROPY":"",i.anisotropyMap?"#define USE_ANISOTROPYMAP":"",i.clearcoat?"#define USE_CLEARCOAT":"",i.clearcoatMap?"#define USE_CLEARCOATMAP":"",i.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",i.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",i.iridescence?"#define USE_IRIDESCENCE":"",i.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",i.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",i.specularMap?"#define USE_SPECULARMAP":"",i.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",i.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",i.roughnessMap?"#define USE_ROUGHNESSMAP":"",i.metalnessMap?"#define USE_METALNESSMAP":"",i.alphaMap?"#define USE_ALPHAMAP":"",i.alphaTest?"#define USE_ALPHATEST":"",i.alphaHash?"#define USE_ALPHAHASH":"",i.sheen?"#define USE_SHEEN":"",i.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",i.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",i.transmission?"#define USE_TRANSMISSION":"",i.transmissionMap?"#define USE_TRANSMISSIONMAP":"",i.thicknessMap?"#define USE_THICKNESSMAP":"",i.vertexTangents&&i.flatShading===!1?"#define USE_TANGENT":"",i.vertexColors||i.instancingColor?"#define USE_COLOR":"",i.vertexAlphas?"#define USE_COLOR_ALPHA":"",i.vertexUv1s?"#define USE_UV1":"",i.vertexUv2s?"#define USE_UV2":"",i.vertexUv3s?"#define USE_UV3":"",i.pointsUvs?"#define USE_POINTS_UV":"",i.gradientMap?"#define USE_GRADIENTMAP":"",i.flatShading?"#define FLAT_SHADED":"",i.doubleSided?"#define DOUBLE_SIDED":"",i.flipSided?"#define FLIP_SIDED":"",i.shadowMapEnabled?"#define USE_SHADOWMAP":"",i.shadowMapEnabled?"#define "+p:"",i.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",i.numLightProbes>0?"#define USE_LIGHT_PROBES":"",i.useLegacyLights?"#define LEGACY_LIGHTS":"",i.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",i.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",i.logarithmicDepthBuffer&&i.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",i.toneMapping!==bd?"#define TONE_MAPPING":"",i.toneMapping!==bd?Bi.tonemapping_pars_fragment:"",i.toneMapping!==bd?C3e("toneMapping",i.toneMapping):"",i.dithering?"#define DITHERING":"",i.opaque?"#define OPAQUE":"",Bi.colorspace_pars_fragment,A3e("linearToOutputTexel",i.outputColorSpace),i.useDepthPacking?"#define DEPTH_PACKING "+i.depthPacking:"",`
`].filter(qx).join(`
`)),d=G5(d),d=p7(d,i),d=m7(d,i),f=G5(f),f=p7(f,i),f=m7(f,i),d=g7(d),f=g7(f),i.isWebGL2&&i.isRawShaderMaterial!==!0&&(z=`#version 300 es
`,k=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+k,R=["precision mediump sampler2DArray;","#define varying in",i.glslVersion===U5?"":"layout(location = 0) out highp vec4 pc_fragColor;",i.glslVersion===U5?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+R);const O=z+k+d,F=z+R+f,H=h7(s,s.VERTEX_SHADER,O),$=h7(s,s.FRAGMENT_SHADER,F);s.attachShader(L,H),s.attachShader(L,$),i.index0AttributeName!==void 0?s.bindAttribLocation(L,0,i.index0AttributeName):i.morphTargets===!0&&s.bindAttribLocation(L,0,"position"),s.linkProgram(L);function Y(he){if(n.debug.checkShaderErrors){const pe=s.getProgramInfoLog(L).trim(),ye=s.getShaderInfoLog(H).trim(),fe=s.getShaderInfoLog($).trim();let Ae=!0,Re=!0;if(s.getProgramParameter(L,s.LINK_STATUS)===!1)if(Ae=!1,typeof n.debug.onShaderError=="function")n.debug.onShaderError(s,L,H,$);else{const Be=f7(s,H,"vertex"),le=f7(s,$,"fragment");console.error("THREE.WebGLProgram: Shader Error "+s.getError()+" - VALIDATE_STATUS "+s.getProgramParameter(L,s.VALIDATE_STATUS)+`

Program Info Log: `+pe+`
`+Be+`
`+le)}else pe!==""?console.warn("THREE.WebGLProgram: Program Info Log:",pe):(ye===""||fe==="")&&(Re=!1);Re&&(he.diagnostics={runnable:Ae,programLog:pe,vertexShader:{log:ye,prefix:k},fragmentShader:{log:fe,prefix:R}})}s.deleteShader(H),s.deleteShader($),te=new _M(s,L),G=R3e(s,L)}let te;this.getUniforms=function(){return te===void 0&&Y(this),te};let G;this.getAttributes=function(){return G===void 0&&Y(this),G};let Q=i.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return Q===!1&&(Q=s.getProgramParameter(L,S3e)),Q},this.destroy=function(){a.releaseStatesOfProgram(this),s.deleteProgram(L),this.program=void 0},this.type=i.shaderType,this.name=i.shaderName,this.id=E3e++,this.cacheKey=e,this.usedTimes=1,this.program=L,this.vertexShader=H,this.fragmentShader=$,this}let G3e=0;class H3e{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const i=e.vertexShader,a=e.fragmentShader,s=this._getShaderStage(i),l=this._getShaderStage(a),d=this._getShaderCacheForMaterial(e);return d.has(s)===!1&&(d.add(s),s.usedTimes++),d.has(l)===!1&&(d.add(l),l.usedTimes++),this}remove(e){const i=this.materialCache.get(e);for(const a of i)a.usedTimes--,a.usedTimes===0&&this.shaderCache.delete(a.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const i=this.materialCache;let a=i.get(e);return a===void 0&&(a=new Set,i.set(e,a)),a}_getShaderStage(e){const i=this.shaderCache;let a=i.get(e);return a===void 0&&(a=new j3e(e),i.set(e,a)),a}}class j3e{constructor(e){this.id=G3e++,this.code=e,this.usedTimes=0}}function $3e(n,e,i,a,s,l,d){const f=new Rg,p=new H3e,y=[],_=s.isWebGL2,b=s.logarithmicDepthBuffer,S=s.vertexTextures;let A=s.precision;const P={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function L(G){return G===0?"uv":`uv${G}`}function k(G,Q,he,pe,ye){const fe=pe.fog,Ae=ye.geometry,Re=G.isMeshStandardMaterial?pe.environment:null,Be=(G.isMeshStandardMaterial?i:e).get(G.envMap||Re),le=Be&&Be.mapping===R_?Be.image.height:null,me=P[G.type];G.precision!==null&&(A=s.getMaxPrecision(G.precision),A!==G.precision&&console.warn("THREE.WebGLProgram.getParameters:",G.precision,"not supported, using",A,"instead."));const we=Ae.morphAttributes.position||Ae.morphAttributes.normal||Ae.morphAttributes.color,re=we!==void 0?we.length:0;let Te=0;Ae.morphAttributes.position!==void 0&&(Te=1),Ae.morphAttributes.normal!==void 0&&(Te=2),Ae.morphAttributes.color!==void 0&&(Te=3);let Je,Xe,Ze,Fe;if(me){const vt=pu[me];Je=vt.vertexShader,Xe=vt.fragmentShader}else Je=G.vertexShader,Xe=G.fragmentShader,p.update(G),Ze=p.getVertexShaderID(G),Fe=p.getFragmentShaderID(G);const ct=n.getRenderTarget(),At=ye.isInstancedMesh===!0,kt=!!G.map,Kt=!!G.matcap,Et=!!Be,Ie=!!G.aoMap,pt=!!G.lightMap,gt=!!G.bumpMap,_t=!!G.normalMap,Ue=!!G.displacementMap,ue=!!G.emissiveMap,se=!!G.metalnessMap,xe=!!G.roughnessMap,Ye=G.anisotropy>0,ze=G.clearcoat>0,st=G.iridescence>0,de=G.sheen>0,ie=G.transmission>0,Oe=Ye&&!!G.anisotropyMap,ut=ze&&!!G.clearcoatMap,it=ze&&!!G.clearcoatNormalMap,lt=ze&&!!G.clearcoatRoughnessMap,Mt=st&&!!G.iridescenceMap,Ut=st&&!!G.iridescenceThicknessMap,Wt=de&&!!G.sheenColorMap,Ht=de&&!!G.sheenRoughnessMap,Dt=!!G.specularMap,wt=!!G.specularColorMap,Xt=!!G.specularIntensityMap,$e=ie&&!!G.transmissionMap,Pt=ie&&!!G.thicknessMap,qt=!!G.gradientMap,Ot=!!G.alphaMap,fn=G.alphaTest>0,be=!!G.alphaHash,Qe=!!G.extensions,Se=!!Ae.attributes.uv1,Ce=!!Ae.attributes.uv2,Ne=!!Ae.attributes.uv3;let et=bd;return G.toneMapped&&(ct===null||ct.isXRRenderTarget===!0)&&(et=n.toneMapping),{isWebGL2:_,shaderID:me,shaderType:G.type,shaderName:G.name,vertexShader:Je,fragmentShader:Xe,defines:G.defines,customVertexShaderID:Ze,customFragmentShaderID:Fe,isRawShaderMaterial:G.isRawShaderMaterial===!0,glslVersion:G.glslVersion,precision:A,instancing:At,instancingColor:At&&ye.instanceColor!==null,supportsVertexTextures:S,outputColorSpace:ct===null?n.outputColorSpace:ct.isXRRenderTarget===!0?ct.texture.colorSpace:Cd,map:kt,matcap:Kt,envMap:Et,envMapMode:Et&&Be.mapping,envMapCubeUVHeight:le,aoMap:Ie,lightMap:pt,bumpMap:gt,normalMap:_t,displacementMap:S&&Ue,emissiveMap:ue,normalMapObjectSpace:_t&&G.normalMapType===_Z,normalMapTangentSpace:_t&&G.normalMapType===Np,metalnessMap:se,roughnessMap:xe,anisotropy:Ye,anisotropyMap:Oe,clearcoat:ze,clearcoatMap:ut,clearcoatNormalMap:it,clearcoatRoughnessMap:lt,iridescence:st,iridescenceMap:Mt,iridescenceThicknessMap:Ut,sheen:de,sheenColorMap:Wt,sheenRoughnessMap:Ht,specularMap:Dt,specularColorMap:wt,specularIntensityMap:Xt,transmission:ie,transmissionMap:$e,thicknessMap:Pt,gradientMap:qt,opaque:G.transparent===!1&&G.blending===Pg,alphaMap:Ot,alphaTest:fn,alphaHash:be,combine:G.combine,mapUv:kt&&L(G.map.channel),aoMapUv:Ie&&L(G.aoMap.channel),lightMapUv:pt&&L(G.lightMap.channel),bumpMapUv:gt&&L(G.bumpMap.channel),normalMapUv:_t&&L(G.normalMap.channel),displacementMapUv:Ue&&L(G.displacementMap.channel),emissiveMapUv:ue&&L(G.emissiveMap.channel),metalnessMapUv:se&&L(G.metalnessMap.channel),roughnessMapUv:xe&&L(G.roughnessMap.channel),anisotropyMapUv:Oe&&L(G.anisotropyMap.channel),clearcoatMapUv:ut&&L(G.clearcoatMap.channel),clearcoatNormalMapUv:it&&L(G.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:lt&&L(G.clearcoatRoughnessMap.channel),iridescenceMapUv:Mt&&L(G.iridescenceMap.channel),iridescenceThicknessMapUv:Ut&&L(G.iridescenceThicknessMap.channel),sheenColorMapUv:Wt&&L(G.sheenColorMap.channel),sheenRoughnessMapUv:Ht&&L(G.sheenRoughnessMap.channel),specularMapUv:Dt&&L(G.specularMap.channel),specularColorMapUv:wt&&L(G.specularColorMap.channel),specularIntensityMapUv:Xt&&L(G.specularIntensityMap.channel),transmissionMapUv:$e&&L(G.transmissionMap.channel),thicknessMapUv:Pt&&L(G.thicknessMap.channel),alphaMapUv:Ot&&L(G.alphaMap.channel),vertexTangents:!!Ae.attributes.tangent&&(_t||Ye),vertexColors:G.vertexColors,vertexAlphas:G.vertexColors===!0&&!!Ae.attributes.color&&Ae.attributes.color.itemSize===4,vertexUv1s:Se,vertexUv2s:Ce,vertexUv3s:Ne,pointsUvs:ye.isPoints===!0&&!!Ae.attributes.uv&&(kt||Ot),fog:!!fe,useFog:G.fog===!0,fogExp2:fe&&fe.isFogExp2,flatShading:G.flatShading===!0,sizeAttenuation:G.sizeAttenuation===!0,logarithmicDepthBuffer:b,skinning:ye.isSkinnedMesh===!0,morphTargets:Ae.morphAttributes.position!==void 0,morphNormals:Ae.morphAttributes.normal!==void 0,morphColors:Ae.morphAttributes.color!==void 0,morphTargetsCount:re,morphTextureStride:Te,numDirLights:Q.directional.length,numPointLights:Q.point.length,numSpotLights:Q.spot.length,numSpotLightMaps:Q.spotLightMap.length,numRectAreaLights:Q.rectArea.length,numHemiLights:Q.hemi.length,numDirLightShadows:Q.directionalShadowMap.length,numPointLightShadows:Q.pointShadowMap.length,numSpotLightShadows:Q.spotShadowMap.length,numSpotLightShadowsWithMaps:Q.numSpotLightShadowsWithMaps,numLightProbes:Q.numLightProbes,numClippingPlanes:d.numPlanes,numClipIntersection:d.numIntersection,dithering:G.dithering,shadowMapEnabled:n.shadowMap.enabled&&he.length>0,shadowMapType:n.shadowMap.type,toneMapping:et,useLegacyLights:n._useLegacyLights,decodeVideoTexture:kt&&G.map.isVideoTexture===!0&&Vr.getTransfer(G.map.colorSpace)===ra,premultipliedAlpha:G.premultipliedAlpha,doubleSided:G.side===Xl,flipSided:G.side===Ts,useDepthPacking:G.depthPacking>=0,depthPacking:G.depthPacking||0,index0AttributeName:G.index0AttributeName,extensionDerivatives:Qe&&G.extensions.derivatives===!0,extensionFragDepth:Qe&&G.extensions.fragDepth===!0,extensionDrawBuffers:Qe&&G.extensions.drawBuffers===!0,extensionShaderTextureLOD:Qe&&G.extensions.shaderTextureLOD===!0,rendererExtensionFragDepth:_||a.has("EXT_frag_depth"),rendererExtensionDrawBuffers:_||a.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:_||a.has("EXT_shader_texture_lod"),rendererExtensionParallelShaderCompile:a.has("KHR_parallel_shader_compile"),customProgramCacheKey:G.customProgramCacheKey()}}function R(G){const Q=[];if(G.shaderID?Q.push(G.shaderID):(Q.push(G.customVertexShaderID),Q.push(G.customFragmentShaderID)),G.defines!==void 0)for(const he in G.defines)Q.push(he),Q.push(G.defines[he]);return G.isRawShaderMaterial===!1&&(z(Q,G),O(Q,G),Q.push(n.outputColorSpace)),Q.push(G.customProgramCacheKey),Q.join()}function z(G,Q){G.push(Q.precision),G.push(Q.outputColorSpace),G.push(Q.envMapMode),G.push(Q.envMapCubeUVHeight),G.push(Q.mapUv),G.push(Q.alphaMapUv),G.push(Q.lightMapUv),G.push(Q.aoMapUv),G.push(Q.bumpMapUv),G.push(Q.normalMapUv),G.push(Q.displacementMapUv),G.push(Q.emissiveMapUv),G.push(Q.metalnessMapUv),G.push(Q.roughnessMapUv),G.push(Q.anisotropyMapUv),G.push(Q.clearcoatMapUv),G.push(Q.clearcoatNormalMapUv),G.push(Q.clearcoatRoughnessMapUv),G.push(Q.iridescenceMapUv),G.push(Q.iridescenceThicknessMapUv),G.push(Q.sheenColorMapUv),G.push(Q.sheenRoughnessMapUv),G.push(Q.specularMapUv),G.push(Q.specularColorMapUv),G.push(Q.specularIntensityMapUv),G.push(Q.transmissionMapUv),G.push(Q.thicknessMapUv),G.push(Q.combine),G.push(Q.fogExp2),G.push(Q.sizeAttenuation),G.push(Q.morphTargetsCount),G.push(Q.morphAttributeCount),G.push(Q.numDirLights),G.push(Q.numPointLights),G.push(Q.numSpotLights),G.push(Q.numSpotLightMaps),G.push(Q.numHemiLights),G.push(Q.numRectAreaLights),G.push(Q.numDirLightShadows),G.push(Q.numPointLightShadows),G.push(Q.numSpotLightShadows),G.push(Q.numSpotLightShadowsWithMaps),G.push(Q.numLightProbes),G.push(Q.shadowMapType),G.push(Q.toneMapping),G.push(Q.numClippingPlanes),G.push(Q.numClipIntersection),G.push(Q.depthPacking)}function O(G,Q){f.disableAll(),Q.isWebGL2&&f.enable(0),Q.supportsVertexTextures&&f.enable(1),Q.instancing&&f.enable(2),Q.instancingColor&&f.enable(3),Q.matcap&&f.enable(4),Q.envMap&&f.enable(5),Q.normalMapObjectSpace&&f.enable(6),Q.normalMapTangentSpace&&f.enable(7),Q.clearcoat&&f.enable(8),Q.iridescence&&f.enable(9),Q.alphaTest&&f.enable(10),Q.vertexColors&&f.enable(11),Q.vertexAlphas&&f.enable(12),Q.vertexUv1s&&f.enable(13),Q.vertexUv2s&&f.enable(14),Q.vertexUv3s&&f.enable(15),Q.vertexTangents&&f.enable(16),Q.anisotropy&&f.enable(17),Q.alphaHash&&f.enable(18),G.push(f.mask),f.disableAll(),Q.fog&&f.enable(0),Q.useFog&&f.enable(1),Q.flatShading&&f.enable(2),Q.logarithmicDepthBuffer&&f.enable(3),Q.skinning&&f.enable(4),Q.morphTargets&&f.enable(5),Q.morphNormals&&f.enable(6),Q.morphColors&&f.enable(7),Q.premultipliedAlpha&&f.enable(8),Q.shadowMapEnabled&&f.enable(9),Q.useLegacyLights&&f.enable(10),Q.doubleSided&&f.enable(11),Q.flipSided&&f.enable(12),Q.useDepthPacking&&f.enable(13),Q.dithering&&f.enable(14),Q.transmission&&f.enable(15),Q.sheen&&f.enable(16),Q.opaque&&f.enable(17),Q.pointsUvs&&f.enable(18),Q.decodeVideoTexture&&f.enable(19),G.push(f.mask)}function F(G){const Q=P[G.type];let he;if(Q){const pe=pu[Q];he=Tz.clone(pe.uniforms)}else he=G.uniforms;return he}function H(G,Q){let he;for(let pe=0,ye=y.length;pe<ye;pe++){const fe=y[pe];if(fe.cacheKey===Q){he=fe,++he.usedTimes;break}}return he===void 0&&(he=new V3e(n,Q,G,l),y.push(he)),he}function $(G){if(--G.usedTimes===0){const Q=y.indexOf(G);y[Q]=y[y.length-1],y.pop(),G.destroy()}}function Y(G){p.remove(G)}function te(){p.dispose()}return{getParameters:k,getProgramCacheKey:R,getUniforms:F,acquireProgram:H,releaseProgram:$,releaseShaderCache:Y,programs:y,dispose:te}}function Y3e(){let n=new WeakMap;function e(l){let d=n.get(l);return d===void 0&&(d={},n.set(l,d)),d}function i(l){n.delete(l)}function a(l,d,f){n.get(l)[d]=f}function s(){n=new WeakMap}return{get:e,remove:i,update:a,dispose:s}}function q3e(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.material.id!==e.material.id?n.material.id-e.material.id:n.z!==e.z?n.z-e.z:n.id-e.id}function v7(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.z!==e.z?e.z-n.z:n.id-e.id}function _7(){const n=[];let e=0;const i=[],a=[],s=[];function l(){e=0,i.length=0,a.length=0,s.length=0}function d(b,S,A,P,L,k){let R=n[e];return R===void 0?(R={id:b.id,object:b,geometry:S,material:A,groupOrder:P,renderOrder:b.renderOrder,z:L,group:k},n[e]=R):(R.id=b.id,R.object=b,R.geometry=S,R.material=A,R.groupOrder=P,R.renderOrder=b.renderOrder,R.z=L,R.group=k),e++,R}function f(b,S,A,P,L,k){const R=d(b,S,A,P,L,k);A.transmission>0?a.push(R):A.transparent===!0?s.push(R):i.push(R)}function p(b,S,A,P,L,k){const R=d(b,S,A,P,L,k);A.transmission>0?a.unshift(R):A.transparent===!0?s.unshift(R):i.unshift(R)}function y(b,S){i.length>1&&i.sort(b||q3e),a.length>1&&a.sort(S||v7),s.length>1&&s.sort(S||v7)}function _(){for(let b=e,S=n.length;b<S;b++){const A=n[b];if(A.id===null)break;A.id=null,A.object=null,A.geometry=null,A.material=null,A.group=null}}return{opaque:i,transmissive:a,transparent:s,init:l,push:f,unshift:p,finish:_,sort:y}}function X3e(){let n=new WeakMap;function e(a,s){const l=n.get(a);let d;return l===void 0?(d=new _7,n.set(a,[d])):s>=l.length?(d=new _7,l.push(d)):d=l[s],d}function i(){n=new WeakMap}return{get:e,dispose:i}}function Z3e(){const n={};return{get:function(e){if(n[e.id]!==void 0)return n[e.id];let i;switch(e.type){case"DirectionalLight":i={direction:new We,color:new In};break;case"SpotLight":i={position:new We,direction:new We,color:new In,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":i={position:new We,color:new In,distance:0,decay:0};break;case"HemisphereLight":i={direction:new We,skyColor:new In,groundColor:new In};break;case"RectAreaLight":i={color:new In,position:new We,halfWidth:new We,halfHeight:new We};break}return n[e.id]=i,i}}}function K3e(){const n={};return{get:function(e){if(n[e.id]!==void 0)return n[e.id];let i;switch(e.type){case"DirectionalLight":i={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new tn};break;case"SpotLight":i={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new tn};break;case"PointLight":i={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new tn,shadowCameraNear:1,shadowCameraFar:1e3};break}return n[e.id]=i,i}}}let J3e=0;function Q3e(n,e){return(e.castShadow?2:0)-(n.castShadow?2:0)+(e.map?1:0)-(n.map?1:0)}function eEe(n,e){const i=new Z3e,a=K3e(),s={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let _=0;_<9;_++)s.probe.push(new We);const l=new We,d=new Di,f=new Di;function p(_,b){let S=0,A=0,P=0;for(let pe=0;pe<9;pe++)s.probe[pe].set(0,0,0);let L=0,k=0,R=0,z=0,O=0,F=0,H=0,$=0,Y=0,te=0,G=0;_.sort(Q3e);const Q=b===!0?Math.PI:1;for(let pe=0,ye=_.length;pe<ye;pe++){const fe=_[pe],Ae=fe.color,Re=fe.intensity,Be=fe.distance,le=fe.shadow&&fe.shadow.map?fe.shadow.map.texture:null;if(fe.isAmbientLight)S+=Ae.r*Re*Q,A+=Ae.g*Re*Q,P+=Ae.b*Re*Q;else if(fe.isLightProbe){for(let me=0;me<9;me++)s.probe[me].addScaledVector(fe.sh.coefficients[me],Re);G++}else if(fe.isDirectionalLight){const me=i.get(fe);if(me.color.copy(fe.color).multiplyScalar(fe.intensity*Q),fe.castShadow){const we=fe.shadow,re=a.get(fe);re.shadowBias=we.bias,re.shadowNormalBias=we.normalBias,re.shadowRadius=we.radius,re.shadowMapSize=we.mapSize,s.directionalShadow[L]=re,s.directionalShadowMap[L]=le,s.directionalShadowMatrix[L]=fe.shadow.matrix,F++}s.directional[L]=me,L++}else if(fe.isSpotLight){const me=i.get(fe);me.position.setFromMatrixPosition(fe.matrixWorld),me.color.copy(Ae).multiplyScalar(Re*Q),me.distance=Be,me.coneCos=Math.cos(fe.angle),me.penumbraCos=Math.cos(fe.angle*(1-fe.penumbra)),me.decay=fe.decay,s.spot[R]=me;const we=fe.shadow;if(fe.map&&(s.spotLightMap[Y]=fe.map,Y++,we.updateMatrices(fe),fe.castShadow&&te++),s.spotLightMatrix[R]=we.matrix,fe.castShadow){const re=a.get(fe);re.shadowBias=we.bias,re.shadowNormalBias=we.normalBias,re.shadowRadius=we.radius,re.shadowMapSize=we.mapSize,s.spotShadow[R]=re,s.spotShadowMap[R]=le,$++}R++}else if(fe.isRectAreaLight){const me=i.get(fe);me.color.copy(Ae).multiplyScalar(Re),me.halfWidth.set(fe.width*.5,0,0),me.halfHeight.set(0,fe.height*.5,0),s.rectArea[z]=me,z++}else if(fe.isPointLight){const me=i.get(fe);if(me.color.copy(fe.color).multiplyScalar(fe.intensity*Q),me.distance=fe.distance,me.decay=fe.decay,fe.castShadow){const we=fe.shadow,re=a.get(fe);re.shadowBias=we.bias,re.shadowNormalBias=we.normalBias,re.shadowRadius=we.radius,re.shadowMapSize=we.mapSize,re.shadowCameraNear=we.camera.near,re.shadowCameraFar=we.camera.far,s.pointShadow[k]=re,s.pointShadowMap[k]=le,s.pointShadowMatrix[k]=fe.shadow.matrix,H++}s.point[k]=me,k++}else if(fe.isHemisphereLight){const me=i.get(fe);me.skyColor.copy(fe.color).multiplyScalar(Re*Q),me.groundColor.copy(fe.groundColor).multiplyScalar(Re*Q),s.hemi[O]=me,O++}}z>0&&(e.isWebGL2||n.has("OES_texture_float_linear")===!0?(s.rectAreaLTC1=Sn.LTC_FLOAT_1,s.rectAreaLTC2=Sn.LTC_FLOAT_2):n.has("OES_texture_half_float_linear")===!0?(s.rectAreaLTC1=Sn.LTC_HALF_1,s.rectAreaLTC2=Sn.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),s.ambient[0]=S,s.ambient[1]=A,s.ambient[2]=P;const he=s.hash;(he.directionalLength!==L||he.pointLength!==k||he.spotLength!==R||he.rectAreaLength!==z||he.hemiLength!==O||he.numDirectionalShadows!==F||he.numPointShadows!==H||he.numSpotShadows!==$||he.numSpotMaps!==Y||he.numLightProbes!==G)&&(s.directional.length=L,s.spot.length=R,s.rectArea.length=z,s.point.length=k,s.hemi.length=O,s.directionalShadow.length=F,s.directionalShadowMap.length=F,s.pointShadow.length=H,s.pointShadowMap.length=H,s.spotShadow.length=$,s.spotShadowMap.length=$,s.directionalShadowMatrix.length=F,s.pointShadowMatrix.length=H,s.spotLightMatrix.length=$+Y-te,s.spotLightMap.length=Y,s.numSpotLightShadowsWithMaps=te,s.numLightProbes=G,he.directionalLength=L,he.pointLength=k,he.spotLength=R,he.rectAreaLength=z,he.hemiLength=O,he.numDirectionalShadows=F,he.numPointShadows=H,he.numSpotShadows=$,he.numSpotMaps=Y,he.numLightProbes=G,s.version=J3e++)}function y(_,b){let S=0,A=0,P=0,L=0,k=0;const R=b.matrixWorldInverse;for(let z=0,O=_.length;z<O;z++){const F=_[z];if(F.isDirectionalLight){const H=s.directional[S];H.direction.setFromMatrixPosition(F.matrixWorld),l.setFromMatrixPosition(F.target.matrixWorld),H.direction.sub(l),H.direction.transformDirection(R),S++}else if(F.isSpotLight){const H=s.spot[P];H.position.setFromMatrixPosition(F.matrixWorld),H.position.applyMatrix4(R),H.direction.setFromMatrixPosition(F.matrixWorld),l.setFromMatrixPosition(F.target.matrixWorld),H.direction.sub(l),H.direction.transformDirection(R),P++}else if(F.isRectAreaLight){const H=s.rectArea[L];H.position.setFromMatrixPosition(F.matrixWorld),H.position.applyMatrix4(R),f.identity(),d.copy(F.matrixWorld),d.premultiply(R),f.extractRotation(d),H.halfWidth.set(F.width*.5,0,0),H.halfHeight.set(0,F.height*.5,0),H.halfWidth.applyMatrix4(f),H.halfHeight.applyMatrix4(f),L++}else if(F.isPointLight){const H=s.point[A];H.position.setFromMatrixPosition(F.matrixWorld),H.position.applyMatrix4(R),A++}else if(F.isHemisphereLight){const H=s.hemi[k];H.direction.setFromMatrixPosition(F.matrixWorld),H.direction.transformDirection(R),k++}}}return{setup:p,setupView:y,state:s}}function x7(n,e){const i=new eEe(n,e),a=[],s=[];function l(){a.length=0,s.length=0}function d(b){a.push(b)}function f(b){s.push(b)}function p(b){i.setup(a,b)}function y(b){i.setupView(a,b)}return{init:l,state:{lightsArray:a,shadowsArray:s,lights:i},setupLights:p,setupLightsView:y,pushLight:d,pushShadow:f}}function tEe(n,e){let i=new WeakMap;function a(l,d=0){const f=i.get(l);let p;return f===void 0?(p=new x7(n,e),i.set(l,[p])):d>=f.length?(p=new x7(n,e),f.push(p)):p=f[d],p}function s(){i=new WeakMap}return{get:a,dispose:s}}class tC extends rs{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=vZ,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class nC extends rs{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}const nEe=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,iEe=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function rEe(n,e,i){let a=new QA;const s=new tn,l=new tn,d=new Lr,f=new tC({depthPacking:xz}),p=new nC,y={},_=i.maxTextureSize,b={[Ad]:Ts,[Ts]:Ad,[Xl]:Xl},S=new Pd({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new tn},radius:{value:4}},vertexShader:nEe,fragmentShader:iEe}),A=S.clone();A.defines.HORIZONTAL_PASS=1;const P=new zi;P.setAttribute("position",new Qr(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const L=new Eo(P,S),k=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=YA;let R=this.type;this.render=function(H,$,Y){if(k.enabled===!1||k.autoUpdate===!1&&k.needsUpdate===!1||H.length===0)return;const te=n.getRenderTarget(),G=n.getActiveCubeFace(),Q=n.getActiveMipmapLevel(),he=n.state;he.setBlending(Wh),he.buffers.color.setClear(1,1,1,1),he.buffers.depth.setTest(!0),he.setScissorTest(!1);const pe=R!==uu&&this.type===uu,ye=R===uu&&this.type!==uu;for(let fe=0,Ae=H.length;fe<Ae;fe++){const Re=H[fe],Be=Re.shadow;if(Be===void 0){console.warn("THREE.WebGLShadowMap:",Re,"has no shadow.");continue}if(Be.autoUpdate===!1&&Be.needsUpdate===!1)continue;s.copy(Be.mapSize);const le=Be.getFrameExtents();if(s.multiply(le),l.copy(Be.mapSize),(s.x>_||s.y>_)&&(s.x>_&&(l.x=Math.floor(_/le.x),s.x=l.x*le.x,Be.mapSize.x=l.x),s.y>_&&(l.y=Math.floor(_/le.y),s.y=l.y*le.y,Be.mapSize.y=l.y)),Be.map===null||pe===!0||ye===!0){const we=this.type!==uu?{minFilter:co,magFilter:co}:{};Be.map!==null&&Be.map.dispose(),Be.map=new wu(s.x,s.y,we),Be.map.texture.name=Re.name+".shadowMap",Be.camera.updateProjectionMatrix()}n.setRenderTarget(Be.map),n.clear();const me=Be.getViewportCount();for(let we=0;we<me;we++){const re=Be.getViewport(we);d.set(l.x*re.x,l.y*re.y,l.x*re.z,l.y*re.w),he.viewport(d),Be.updateMatrices(Re,we),a=Be.getFrustum(),F($,Y,Be.camera,Re,this.type)}Be.isPointLightShadow!==!0&&this.type===uu&&z(Be,Y),Be.needsUpdate=!1}R=this.type,k.needsUpdate=!1,n.setRenderTarget(te,G,Q)};function z(H,$){const Y=e.update(L);S.defines.VSM_SAMPLES!==H.blurSamples&&(S.defines.VSM_SAMPLES=H.blurSamples,A.defines.VSM_SAMPLES=H.blurSamples,S.needsUpdate=!0,A.needsUpdate=!0),H.mapPass===null&&(H.mapPass=new wu(s.x,s.y)),S.uniforms.shadow_pass.value=H.map.texture,S.uniforms.resolution.value=H.mapSize,S.uniforms.radius.value=H.radius,n.setRenderTarget(H.mapPass),n.clear(),n.renderBufferDirect($,null,Y,S,L,null),A.uniforms.shadow_pass.value=H.mapPass.texture,A.uniforms.resolution.value=H.mapSize,A.uniforms.radius.value=H.radius,n.setRenderTarget(H.map),n.clear(),n.renderBufferDirect($,null,Y,A,L,null)}function O(H,$,Y,te){let G=null;const Q=Y.isPointLight===!0?H.customDistanceMaterial:H.customDepthMaterial;if(Q!==void 0)G=Q;else if(G=Y.isPointLight===!0?p:f,n.localClippingEnabled&&$.clipShadows===!0&&Array.isArray($.clippingPlanes)&&$.clippingPlanes.length!==0||$.displacementMap&&$.displacementScale!==0||$.alphaMap&&$.alphaTest>0||$.map&&$.alphaTest>0){const he=G.uuid,pe=$.uuid;let ye=y[he];ye===void 0&&(ye={},y[he]=ye);let fe=ye[pe];fe===void 0&&(fe=G.clone(),ye[pe]=fe),G=fe}if(G.visible=$.visible,G.wireframe=$.wireframe,te===uu?G.side=$.shadowSide!==null?$.shadowSide:$.side:G.side=$.shadowSide!==null?$.shadowSide:b[$.side],G.alphaMap=$.alphaMap,G.alphaTest=$.alphaTest,G.map=$.map,G.clipShadows=$.clipShadows,G.clippingPlanes=$.clippingPlanes,G.clipIntersection=$.clipIntersection,G.displacementMap=$.displacementMap,G.displacementScale=$.displacementScale,G.displacementBias=$.displacementBias,G.wireframeLinewidth=$.wireframeLinewidth,G.linewidth=$.linewidth,Y.isPointLight===!0&&G.isMeshDistanceMaterial===!0){const he=n.properties.get(G);he.light=Y}return G}function F(H,$,Y,te,G){if(H.visible===!1)return;if(H.layers.test($.layers)&&(H.isMesh||H.isLine||H.isPoints)&&(H.castShadow||H.receiveShadow&&G===uu)&&(!H.frustumCulled||a.intersectsObject(H))){H.modelViewMatrix.multiplyMatrices(Y.matrixWorldInverse,H.matrixWorld);const pe=e.update(H),ye=H.material;if(Array.isArray(ye)){const fe=pe.groups;for(let Ae=0,Re=fe.length;Ae<Re;Ae++){const Be=fe[Ae],le=ye[Be.materialIndex];if(le&&le.visible){const me=O(H,le,te,G);n.renderBufferDirect(Y,null,pe,me,H,Be)}}}else if(ye.visible){const fe=O(H,ye,te,G);n.renderBufferDirect(Y,null,pe,fe,H,null)}}const he=H.children;for(let pe=0,ye=he.length;pe<ye;pe++)F(he[pe],$,Y,te,G)}}function aEe(n,e,i){const a=i.isWebGL2;function s(){let be=!1;const Qe=new Lr;let Se=null;const Ce=new Lr(0,0,0,0);return{setMask:function(Ne){Se!==Ne&&!be&&(n.colorMask(Ne,Ne,Ne,Ne),Se=Ne)},setLocked:function(Ne){be=Ne},setClear:function(Ne,et,tt,vt,ht){ht===!0&&(Ne*=vt,et*=vt,tt*=vt),Qe.set(Ne,et,tt,vt),Ce.equals(Qe)===!1&&(n.clearColor(Ne,et,tt,vt),Ce.copy(Qe))},reset:function(){be=!1,Se=null,Ce.set(-1,0,0,0)}}}function l(){let be=!1,Qe=null,Se=null,Ce=null;return{setTest:function(Ne){Ne?kt(n.DEPTH_TEST):Kt(n.DEPTH_TEST)},setMask:function(Ne){Qe!==Ne&&!be&&(n.depthMask(Ne),Qe=Ne)},setFunc:function(Ne){if(Se!==Ne){switch(Ne){case $X:n.depthFunc(n.NEVER);break;case YX:n.depthFunc(n.ALWAYS);break;case qX:n.depthFunc(n.LESS);break;case sw:n.depthFunc(n.LEQUAL);break;case XX:n.depthFunc(n.EQUAL);break;case ZX:n.depthFunc(n.GEQUAL);break;case KX:n.depthFunc(n.GREATER);break;case JX:n.depthFunc(n.NOTEQUAL);break;default:n.depthFunc(n.LEQUAL)}Se=Ne}},setLocked:function(Ne){be=Ne},setClear:function(Ne){Ce!==Ne&&(n.clearDepth(Ne),Ce=Ne)},reset:function(){be=!1,Qe=null,Se=null,Ce=null}}}function d(){let be=!1,Qe=null,Se=null,Ce=null,Ne=null,et=null,tt=null,vt=null,ht=null;return{setTest:function(dt){be||(dt?kt(n.STENCIL_TEST):Kt(n.STENCIL_TEST))},setMask:function(dt){Qe!==dt&&!be&&(n.stencilMask(dt),Qe=dt)},setFunc:function(dt,Vt,It){(Se!==dt||Ce!==Vt||Ne!==It)&&(n.stencilFunc(dt,Vt,It),Se=dt,Ce=Vt,Ne=It)},setOp:function(dt,Vt,It){(et!==dt||tt!==Vt||vt!==It)&&(n.stencilOp(dt,Vt,It),et=dt,tt=Vt,vt=It)},setLocked:function(dt){be=dt},setClear:function(dt){ht!==dt&&(n.clearStencil(dt),ht=dt)},reset:function(){be=!1,Qe=null,Se=null,Ce=null,Ne=null,et=null,tt=null,vt=null,ht=null}}}const f=new s,p=new l,y=new d,_=new WeakMap,b=new WeakMap;let S={},A={},P=new WeakMap,L=[],k=null,R=!1,z=null,O=null,F=null,H=null,$=null,Y=null,te=null,G=new In(0,0,0),Q=0,he=!1,pe=null,ye=null,fe=null,Ae=null,Re=null;const Be=n.getParameter(n.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let le=!1,me=0;const we=n.getParameter(n.VERSION);we.indexOf("WebGL")!==-1?(me=parseFloat(/^WebGL (\d)/.exec(we)[1]),le=me>=1):we.indexOf("OpenGL ES")!==-1&&(me=parseFloat(/^OpenGL ES (\d)/.exec(we)[1]),le=me>=2);let re=null,Te={};const Je=n.getParameter(n.SCISSOR_BOX),Xe=n.getParameter(n.VIEWPORT),Ze=new Lr().fromArray(Je),Fe=new Lr().fromArray(Xe);function ct(be,Qe,Se,Ce){const Ne=new Uint8Array(4),et=n.createTexture();n.bindTexture(be,et),n.texParameteri(be,n.TEXTURE_MIN_FILTER,n.NEAREST),n.texParameteri(be,n.TEXTURE_MAG_FILTER,n.NEAREST);for(let tt=0;tt<Se;tt++)a&&(be===n.TEXTURE_3D||be===n.TEXTURE_2D_ARRAY)?n.texImage3D(Qe,0,n.RGBA,1,1,Ce,0,n.RGBA,n.UNSIGNED_BYTE,Ne):n.texImage2D(Qe+tt,0,n.RGBA,1,1,0,n.RGBA,n.UNSIGNED_BYTE,Ne);return et}const At={};At[n.TEXTURE_2D]=ct(n.TEXTURE_2D,n.TEXTURE_2D,1),At[n.TEXTURE_CUBE_MAP]=ct(n.TEXTURE_CUBE_MAP,n.TEXTURE_CUBE_MAP_POSITIVE_X,6),a&&(At[n.TEXTURE_2D_ARRAY]=ct(n.TEXTURE_2D_ARRAY,n.TEXTURE_2D_ARRAY,1,1),At[n.TEXTURE_3D]=ct(n.TEXTURE_3D,n.TEXTURE_3D,1,1)),f.setClear(0,0,0,1),p.setClear(1),y.setClear(0),kt(n.DEPTH_TEST),p.setFunc(sw),se(!1),xe(s5),kt(n.CULL_FACE),Ue(Wh);function kt(be){S[be]!==!0&&(n.enable(be),S[be]=!0)}function Kt(be){S[be]!==!1&&(n.disable(be),S[be]=!1)}function Et(be,Qe){return A[be]!==Qe?(n.bindFramebuffer(be,Qe),A[be]=Qe,a&&(be===n.DRAW_FRAMEBUFFER&&(A[n.FRAMEBUFFER]=Qe),be===n.FRAMEBUFFER&&(A[n.DRAW_FRAMEBUFFER]=Qe)),!0):!1}function Ie(be,Qe){let Se=L,Ce=!1;if(be)if(Se=P.get(Qe),Se===void 0&&(Se=[],P.set(Qe,Se)),be.isWebGLMultipleRenderTargets){const Ne=be.texture;if(Se.length!==Ne.length||Se[0]!==n.COLOR_ATTACHMENT0){for(let et=0,tt=Ne.length;et<tt;et++)Se[et]=n.COLOR_ATTACHMENT0+et;Se.length=Ne.length,Ce=!0}}else Se[0]!==n.COLOR_ATTACHMENT0&&(Se[0]=n.COLOR_ATTACHMENT0,Ce=!0);else Se[0]!==n.BACK&&(Se[0]=n.BACK,Ce=!0);Ce&&(i.isWebGL2?n.drawBuffers(Se):e.get("WEBGL_draw_buffers").drawBuffersWEBGL(Se))}function pt(be){return k!==be?(n.useProgram(be),k=be,!0):!1}const gt={[tp]:n.FUNC_ADD,[RX]:n.FUNC_SUBTRACT,[LX]:n.FUNC_REVERSE_SUBTRACT};if(a)gt[d5]=n.MIN,gt[h5]=n.MAX;else{const be=e.get("EXT_blend_minmax");be!==null&&(gt[d5]=be.MIN_EXT,gt[h5]=be.MAX_EXT)}const _t={[kX]:n.ZERO,[DX]:n.ONE,[zX]:n.SRC_COLOR,[fT]:n.SRC_ALPHA,[WX]:n.SRC_ALPHA_SATURATE,[BX]:n.DST_COLOR,[NX]:n.DST_ALPHA,[OX]:n.ONE_MINUS_SRC_COLOR,[pT]:n.ONE_MINUS_SRC_ALPHA,[UX]:n.ONE_MINUS_DST_COLOR,[FX]:n.ONE_MINUS_DST_ALPHA,[VX]:n.CONSTANT_COLOR,[GX]:n.ONE_MINUS_CONSTANT_COLOR,[HX]:n.CONSTANT_ALPHA,[jX]:n.ONE_MINUS_CONSTANT_ALPHA};function Ue(be,Qe,Se,Ce,Ne,et,tt,vt,ht,dt){if(be===Wh){R===!0&&(Kt(n.BLEND),R=!1);return}if(R===!1&&(kt(n.BLEND),R=!0),be!==IX){if(be!==z||dt!==he){if((O!==tp||$!==tp)&&(n.blendEquation(n.FUNC_ADD),O=tp,$=tp),dt)switch(be){case Pg:n.blendFuncSeparate(n.ONE,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case l5:n.blendFunc(n.ONE,n.ONE);break;case c5:n.blendFuncSeparate(n.ZERO,n.ONE_MINUS_SRC_COLOR,n.ZERO,n.ONE);break;case u5:n.blendFuncSeparate(n.ZERO,n.SRC_COLOR,n.ZERO,n.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",be);break}else switch(be){case Pg:n.blendFuncSeparate(n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case l5:n.blendFunc(n.SRC_ALPHA,n.ONE);break;case c5:n.blendFuncSeparate(n.ZERO,n.ONE_MINUS_SRC_COLOR,n.ZERO,n.ONE);break;case u5:n.blendFunc(n.ZERO,n.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",be);break}F=null,H=null,Y=null,te=null,G.set(0,0,0),Q=0,z=be,he=dt}return}Ne=Ne||Qe,et=et||Se,tt=tt||Ce,(Qe!==O||Ne!==$)&&(n.blendEquationSeparate(gt[Qe],gt[Ne]),O=Qe,$=Ne),(Se!==F||Ce!==H||et!==Y||tt!==te)&&(n.blendFuncSeparate(_t[Se],_t[Ce],_t[et],_t[tt]),F=Se,H=Ce,Y=et,te=tt),(vt.equals(G)===!1||ht!==Q)&&(n.blendColor(vt.r,vt.g,vt.b,ht),G.copy(vt),Q=ht),z=be,he=!1}function ue(be,Qe){be.side===Xl?Kt(n.CULL_FACE):kt(n.CULL_FACE);let Se=be.side===Ts;Qe&&(Se=!Se),se(Se),be.blending===Pg&&be.transparent===!1?Ue(Wh):Ue(be.blending,be.blendEquation,be.blendSrc,be.blendDst,be.blendEquationAlpha,be.blendSrcAlpha,be.blendDstAlpha,be.blendColor,be.blendAlpha,be.premultipliedAlpha),p.setFunc(be.depthFunc),p.setTest(be.depthTest),p.setMask(be.depthWrite),f.setMask(be.colorWrite);const Ce=be.stencilWrite;y.setTest(Ce),Ce&&(y.setMask(be.stencilWriteMask),y.setFunc(be.stencilFunc,be.stencilRef,be.stencilFuncMask),y.setOp(be.stencilFail,be.stencilZFail,be.stencilZPass)),ze(be.polygonOffset,be.polygonOffsetFactor,be.polygonOffsetUnits),be.alphaToCoverage===!0?kt(n.SAMPLE_ALPHA_TO_COVERAGE):Kt(n.SAMPLE_ALPHA_TO_COVERAGE)}function se(be){pe!==be&&(be?n.frontFace(n.CW):n.frontFace(n.CCW),pe=be)}function xe(be){be!==AX?(kt(n.CULL_FACE),be!==ye&&(be===s5?n.cullFace(n.BACK):be===CX?n.cullFace(n.FRONT):n.cullFace(n.FRONT_AND_BACK))):Kt(n.CULL_FACE),ye=be}function Ye(be){be!==fe&&(le&&n.lineWidth(be),fe=be)}function ze(be,Qe,Se){be?(kt(n.POLYGON_OFFSET_FILL),(Ae!==Qe||Re!==Se)&&(n.polygonOffset(Qe,Se),Ae=Qe,Re=Se)):Kt(n.POLYGON_OFFSET_FILL)}function st(be){be?kt(n.SCISSOR_TEST):Kt(n.SCISSOR_TEST)}function de(be){be===void 0&&(be=n.TEXTURE0+Be-1),re!==be&&(n.activeTexture(be),re=be)}function ie(be,Qe,Se){Se===void 0&&(re===null?Se=n.TEXTURE0+Be-1:Se=re);let Ce=Te[Se];Ce===void 0&&(Ce={type:void 0,texture:void 0},Te[Se]=Ce),(Ce.type!==be||Ce.texture!==Qe)&&(re!==Se&&(n.activeTexture(Se),re=Se),n.bindTexture(be,Qe||At[be]),Ce.type=be,Ce.texture=Qe)}function Oe(){const be=Te[re];be!==void 0&&be.type!==void 0&&(n.bindTexture(be.type,null),be.type=void 0,be.texture=void 0)}function ut(){try{n.compressedTexImage2D.apply(n,arguments)}catch(be){console.error("THREE.WebGLState:",be)}}function it(){try{n.compressedTexImage3D.apply(n,arguments)}catch(be){console.error("THREE.WebGLState:",be)}}function lt(){try{n.texSubImage2D.apply(n,arguments)}catch(be){console.error("THREE.WebGLState:",be)}}function Mt(){try{n.texSubImage3D.apply(n,arguments)}catch(be){console.error("THREE.WebGLState:",be)}}function Ut(){try{n.compressedTexSubImage2D.apply(n,arguments)}catch(be){console.error("THREE.WebGLState:",be)}}function Wt(){try{n.compressedTexSubImage3D.apply(n,arguments)}catch(be){console.error("THREE.WebGLState:",be)}}function Ht(){try{n.texStorage2D.apply(n,arguments)}catch(be){console.error("THREE.WebGLState:",be)}}function Dt(){try{n.texStorage3D.apply(n,arguments)}catch(be){console.error("THREE.WebGLState:",be)}}function wt(){try{n.texImage2D.apply(n,arguments)}catch(be){console.error("THREE.WebGLState:",be)}}function Xt(){try{n.texImage3D.apply(n,arguments)}catch(be){console.error("THREE.WebGLState:",be)}}function $e(be){Ze.equals(be)===!1&&(n.scissor(be.x,be.y,be.z,be.w),Ze.copy(be))}function Pt(be){Fe.equals(be)===!1&&(n.viewport(be.x,be.y,be.z,be.w),Fe.copy(be))}function qt(be,Qe){let Se=b.get(Qe);Se===void 0&&(Se=new WeakMap,b.set(Qe,Se));let Ce=Se.get(be);Ce===void 0&&(Ce=n.getUniformBlockIndex(Qe,be.name),Se.set(be,Ce))}function Ot(be,Qe){const Ce=b.get(Qe).get(be);_.get(Qe)!==Ce&&(n.uniformBlockBinding(Qe,Ce,be.__bindingPointIndex),_.set(Qe,Ce))}function fn(){n.disable(n.BLEND),n.disable(n.CULL_FACE),n.disable(n.DEPTH_TEST),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SCISSOR_TEST),n.disable(n.STENCIL_TEST),n.disable(n.SAMPLE_ALPHA_TO_COVERAGE),n.blendEquation(n.FUNC_ADD),n.blendFunc(n.ONE,n.ZERO),n.blendFuncSeparate(n.ONE,n.ZERO,n.ONE,n.ZERO),n.blendColor(0,0,0,0),n.colorMask(!0,!0,!0,!0),n.clearColor(0,0,0,0),n.depthMask(!0),n.depthFunc(n.LESS),n.clearDepth(1),n.stencilMask(4294967295),n.stencilFunc(n.ALWAYS,0,4294967295),n.stencilOp(n.KEEP,n.KEEP,n.KEEP),n.clearStencil(0),n.cullFace(n.BACK),n.frontFace(n.CCW),n.polygonOffset(0,0),n.activeTexture(n.TEXTURE0),n.bindFramebuffer(n.FRAMEBUFFER,null),a===!0&&(n.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),n.bindFramebuffer(n.READ_FRAMEBUFFER,null)),n.useProgram(null),n.lineWidth(1),n.scissor(0,0,n.canvas.width,n.canvas.height),n.viewport(0,0,n.canvas.width,n.canvas.height),S={},re=null,Te={},A={},P=new WeakMap,L=[],k=null,R=!1,z=null,O=null,F=null,H=null,$=null,Y=null,te=null,G=new In(0,0,0),Q=0,he=!1,pe=null,ye=null,fe=null,Ae=null,Re=null,Ze.set(0,0,n.canvas.width,n.canvas.height),Fe.set(0,0,n.canvas.width,n.canvas.height),f.reset(),p.reset(),y.reset()}return{buffers:{color:f,depth:p,stencil:y},enable:kt,disable:Kt,bindFramebuffer:Et,drawBuffers:Ie,useProgram:pt,setBlending:Ue,setMaterial:ue,setFlipSided:se,setCullFace:xe,setLineWidth:Ye,setPolygonOffset:ze,setScissorTest:st,activeTexture:de,bindTexture:ie,unbindTexture:Oe,compressedTexImage2D:ut,compressedTexImage3D:it,texImage2D:wt,texImage3D:Xt,updateUBOMapping:qt,uniformBlockBinding:Ot,texStorage2D:Ht,texStorage3D:Dt,texSubImage2D:lt,texSubImage3D:Mt,compressedTexSubImage2D:Ut,compressedTexSubImage3D:Wt,scissor:$e,viewport:Pt,reset:fn}}function oEe(n,e,i,a,s,l,d){const f=s.isWebGL2,p=s.maxTextures,y=s.maxCubemapSize,_=s.maxTextureSize,b=s.maxSamples,S=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,A=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),P=new WeakMap;let L;const k=new WeakMap;let R=!1;try{R=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function z(de,ie){return R?new OffscreenCanvas(de,ie):xw("canvas")}function O(de,ie,Oe,ut){let it=1;if((de.width>ut||de.height>ut)&&(it=ut/Math.max(de.width,de.height)),it<1||ie===!0)if(typeof HTMLImageElement<"u"&&de instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&de instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&de instanceof ImageBitmap){const lt=ie?yT:Math.floor,Mt=lt(it*de.width),Ut=lt(it*de.height);L===void 0&&(L=z(Mt,Ut));const Wt=Oe?z(Mt,Ut):L;return Wt.width=Mt,Wt.height=Ut,Wt.getContext("2d").drawImage(de,0,0,Mt,Ut),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+de.width+"x"+de.height+") to ("+Mt+"x"+Ut+")."),Wt}else return"data"in de&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+de.width+"x"+de.height+")."),de;return de}function F(de){return W5(de.width)&&W5(de.height)}function H(de){return f?!1:de.wrapS!==Ss||de.wrapT!==Ss||de.minFilter!==co&&de.minFilter!==ka}function $(de,ie){return de.generateMipmaps&&ie&&de.minFilter!==co&&de.minFilter!==ka}function Y(de){n.generateMipmap(de)}function te(de,ie,Oe,ut,it=!1){if(f===!1)return ie;if(de!==null){if(n[de]!==void 0)return n[de];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+de+"'")}let lt=ie;if(ie===n.RED&&(Oe===n.FLOAT&&(lt=n.R32F),Oe===n.HALF_FLOAT&&(lt=n.R16F),Oe===n.UNSIGNED_BYTE&&(lt=n.R8)),ie===n.RED_INTEGER&&(Oe===n.UNSIGNED_BYTE&&(lt=n.R8UI),Oe===n.UNSIGNED_SHORT&&(lt=n.R16UI),Oe===n.UNSIGNED_INT&&(lt=n.R32UI),Oe===n.BYTE&&(lt=n.R8I),Oe===n.SHORT&&(lt=n.R16I),Oe===n.INT&&(lt=n.R32I)),ie===n.RG&&(Oe===n.FLOAT&&(lt=n.RG32F),Oe===n.HALF_FLOAT&&(lt=n.RG16F),Oe===n.UNSIGNED_BYTE&&(lt=n.RG8)),ie===n.RGBA){const Mt=it?mw:Vr.getTransfer(ut);Oe===n.FLOAT&&(lt=n.RGBA32F),Oe===n.HALF_FLOAT&&(lt=n.RGBA16F),Oe===n.UNSIGNED_BYTE&&(lt=Mt===ra?n.SRGB8_ALPHA8:n.RGBA8),Oe===n.UNSIGNED_SHORT_4_4_4_4&&(lt=n.RGBA4),Oe===n.UNSIGNED_SHORT_5_5_5_1&&(lt=n.RGB5_A1)}return(lt===n.R16F||lt===n.R32F||lt===n.RG16F||lt===n.RG32F||lt===n.RGBA16F||lt===n.RGBA32F)&&e.get("EXT_color_buffer_float"),lt}function G(de,ie,Oe){return $(de,Oe)===!0||de.isFramebufferTexture&&de.minFilter!==co&&de.minFilter!==ka?Math.log2(Math.max(ie.width,ie.height))+1:de.mipmaps!==void 0&&de.mipmaps.length>0?de.mipmaps.length:de.isCompressedTexture&&Array.isArray(de.image)?ie.mipmaps.length:1}function Q(de){return de===co||de===mT||de===_b?n.NEAREST:n.LINEAR}function he(de){const ie=de.target;ie.removeEventListener("dispose",he),ye(ie),ie.isVideoTexture&&P.delete(ie)}function pe(de){const ie=de.target;ie.removeEventListener("dispose",pe),Ae(ie)}function ye(de){const ie=a.get(de);if(ie.__webglInit===void 0)return;const Oe=de.source,ut=k.get(Oe);if(ut){const it=ut[ie.__cacheKey];it.usedTimes--,it.usedTimes===0&&fe(de),Object.keys(ut).length===0&&k.delete(Oe)}a.remove(de)}function fe(de){const ie=a.get(de);n.deleteTexture(ie.__webglTexture);const Oe=de.source,ut=k.get(Oe);delete ut[ie.__cacheKey],d.memory.textures--}function Ae(de){const ie=de.texture,Oe=a.get(de),ut=a.get(ie);if(ut.__webglTexture!==void 0&&(n.deleteTexture(ut.__webglTexture),d.memory.textures--),de.depthTexture&&de.depthTexture.dispose(),de.isWebGLCubeRenderTarget)for(let it=0;it<6;it++){if(Array.isArray(Oe.__webglFramebuffer[it]))for(let lt=0;lt<Oe.__webglFramebuffer[it].length;lt++)n.deleteFramebuffer(Oe.__webglFramebuffer[it][lt]);else n.deleteFramebuffer(Oe.__webglFramebuffer[it]);Oe.__webglDepthbuffer&&n.deleteRenderbuffer(Oe.__webglDepthbuffer[it])}else{if(Array.isArray(Oe.__webglFramebuffer))for(let it=0;it<Oe.__webglFramebuffer.length;it++)n.deleteFramebuffer(Oe.__webglFramebuffer[it]);else n.deleteFramebuffer(Oe.__webglFramebuffer);if(Oe.__webglDepthbuffer&&n.deleteRenderbuffer(Oe.__webglDepthbuffer),Oe.__webglMultisampledFramebuffer&&n.deleteFramebuffer(Oe.__webglMultisampledFramebuffer),Oe.__webglColorRenderbuffer)for(let it=0;it<Oe.__webglColorRenderbuffer.length;it++)Oe.__webglColorRenderbuffer[it]&&n.deleteRenderbuffer(Oe.__webglColorRenderbuffer[it]);Oe.__webglDepthRenderbuffer&&n.deleteRenderbuffer(Oe.__webglDepthRenderbuffer)}if(de.isWebGLMultipleRenderTargets)for(let it=0,lt=ie.length;it<lt;it++){const Mt=a.get(ie[it]);Mt.__webglTexture&&(n.deleteTexture(Mt.__webglTexture),d.memory.textures--),a.remove(ie[it])}a.remove(ie),a.remove(de)}let Re=0;function Be(){Re=0}function le(){const de=Re;return de>=p&&console.warn("THREE.WebGLTextures: Trying to use "+de+" texture units while this GPU supports only "+p),Re+=1,de}function me(de){const ie=[];return ie.push(de.wrapS),ie.push(de.wrapT),ie.push(de.wrapR||0),ie.push(de.magFilter),ie.push(de.minFilter),ie.push(de.anisotropy),ie.push(de.internalFormat),ie.push(de.format),ie.push(de.type),ie.push(de.generateMipmaps),ie.push(de.premultiplyAlpha),ie.push(de.flipY),ie.push(de.unpackAlignment),ie.push(de.colorSpace),ie.join()}function we(de,ie){const Oe=a.get(de);if(de.isVideoTexture&&ze(de),de.isRenderTargetTexture===!1&&de.version>0&&Oe.__version!==de.version){const ut=de.image;if(ut===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(ut.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{kt(Oe,de,ie);return}}i.bindTexture(n.TEXTURE_2D,Oe.__webglTexture,n.TEXTURE0+ie)}function re(de,ie){const Oe=a.get(de);if(de.version>0&&Oe.__version!==de.version){kt(Oe,de,ie);return}i.bindTexture(n.TEXTURE_2D_ARRAY,Oe.__webglTexture,n.TEXTURE0+ie)}function Te(de,ie){const Oe=a.get(de);if(de.version>0&&Oe.__version!==de.version){kt(Oe,de,ie);return}i.bindTexture(n.TEXTURE_3D,Oe.__webglTexture,n.TEXTURE0+ie)}function Je(de,ie){const Oe=a.get(de);if(de.version>0&&Oe.__version!==de.version){Kt(Oe,de,ie);return}i.bindTexture(n.TEXTURE_CUBE_MAP,Oe.__webglTexture,n.TEXTURE0+ie)}const Xe={[uw]:n.REPEAT,[Ss]:n.CLAMP_TO_EDGE,[dw]:n.MIRRORED_REPEAT},Ze={[co]:n.NEAREST,[mT]:n.NEAREST_MIPMAP_NEAREST,[_b]:n.NEAREST_MIPMAP_LINEAR,[ka]:n.LINEAR,[dz]:n.LINEAR_MIPMAP_NEAREST,[Cp]:n.LINEAR_MIPMAP_LINEAR},Fe={[xZ]:n.NEVER,[AZ]:n.ALWAYS,[bZ]:n.LESS,[SZ]:n.LEQUAL,[wZ]:n.EQUAL,[TZ]:n.GEQUAL,[EZ]:n.GREATER,[MZ]:n.NOTEQUAL};function ct(de,ie,Oe){if(Oe?(n.texParameteri(de,n.TEXTURE_WRAP_S,Xe[ie.wrapS]),n.texParameteri(de,n.TEXTURE_WRAP_T,Xe[ie.wrapT]),(de===n.TEXTURE_3D||de===n.TEXTURE_2D_ARRAY)&&n.texParameteri(de,n.TEXTURE_WRAP_R,Xe[ie.wrapR]),n.texParameteri(de,n.TEXTURE_MAG_FILTER,Ze[ie.magFilter]),n.texParameteri(de,n.TEXTURE_MIN_FILTER,Ze[ie.minFilter])):(n.texParameteri(de,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(de,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),(de===n.TEXTURE_3D||de===n.TEXTURE_2D_ARRAY)&&n.texParameteri(de,n.TEXTURE_WRAP_R,n.CLAMP_TO_EDGE),(ie.wrapS!==Ss||ie.wrapT!==Ss)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),n.texParameteri(de,n.TEXTURE_MAG_FILTER,Q(ie.magFilter)),n.texParameteri(de,n.TEXTURE_MIN_FILTER,Q(ie.minFilter)),ie.minFilter!==co&&ie.minFilter!==ka&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),ie.compareFunction&&(n.texParameteri(de,n.TEXTURE_COMPARE_MODE,n.COMPARE_REF_TO_TEXTURE),n.texParameteri(de,n.TEXTURE_COMPARE_FUNC,Fe[ie.compareFunction])),e.has("EXT_texture_filter_anisotropic")===!0){const ut=e.get("EXT_texture_filter_anisotropic");if(ie.magFilter===co||ie.minFilter!==_b&&ie.minFilter!==Cp||ie.type===md&&e.has("OES_texture_float_linear")===!1||f===!1&&ie.type===v_&&e.has("OES_texture_half_float_linear")===!1)return;(ie.anisotropy>1||a.get(ie).__currentAnisotropy)&&(n.texParameterf(de,ut.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(ie.anisotropy,s.getMaxAnisotropy())),a.get(ie).__currentAnisotropy=ie.anisotropy)}}function At(de,ie){let Oe=!1;de.__webglInit===void 0&&(de.__webglInit=!0,ie.addEventListener("dispose",he));const ut=ie.source;let it=k.get(ut);it===void 0&&(it={},k.set(ut,it));const lt=me(ie);if(lt!==de.__cacheKey){it[lt]===void 0&&(it[lt]={texture:n.createTexture(),usedTimes:0},d.memory.textures++,Oe=!0),it[lt].usedTimes++;const Mt=it[de.__cacheKey];Mt!==void 0&&(it[de.__cacheKey].usedTimes--,Mt.usedTimes===0&&fe(ie)),de.__cacheKey=lt,de.__webglTexture=it[lt].texture}return Oe}function kt(de,ie,Oe){let ut=n.TEXTURE_2D;(ie.isDataArrayTexture||ie.isCompressedArrayTexture)&&(ut=n.TEXTURE_2D_ARRAY),ie.isData3DTexture&&(ut=n.TEXTURE_3D);const it=At(de,ie),lt=ie.source;i.bindTexture(ut,de.__webglTexture,n.TEXTURE0+Oe);const Mt=a.get(lt);if(lt.version!==Mt.__version||it===!0){i.activeTexture(n.TEXTURE0+Oe);const Ut=Vr.getPrimaries(Vr.workingColorSpace),Wt=ie.colorSpace===Zl?null:Vr.getPrimaries(ie.colorSpace),Ht=ie.colorSpace===Zl||Ut===Wt?n.NONE:n.BROWSER_DEFAULT_WEBGL;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,ie.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,ie.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,ie.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,Ht);const Dt=H(ie)&&F(ie.image)===!1;let wt=O(ie.image,Dt,!1,_);wt=st(ie,wt);const Xt=F(wt)||f,$e=l.convert(ie.format,ie.colorSpace);let Pt=l.convert(ie.type),qt=te(ie.internalFormat,$e,Pt,ie.colorSpace,ie.isVideoTexture);ct(ut,ie,Xt);let Ot;const fn=ie.mipmaps,be=f&&ie.isVideoTexture!==!0,Qe=Mt.__version===void 0||it===!0,Se=G(ie,wt,Xt);if(ie.isDepthTexture)qt=n.DEPTH_COMPONENT,f?ie.type===md?qt=n.DEPTH_COMPONENT32F:ie.type===zh?qt=n.DEPTH_COMPONENT24:ie.type===vp?qt=n.DEPTH24_STENCIL8:qt=n.DEPTH_COMPONENT16:ie.type===md&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),ie.format===_p&&qt===n.DEPTH_COMPONENT&&ie.type!==XA&&ie.type!==zh&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),ie.type=zh,Pt=l.convert(ie.type)),ie.format===jg&&qt===n.DEPTH_COMPONENT&&(qt=n.DEPTH_STENCIL,ie.type!==vp&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),ie.type=vp,Pt=l.convert(ie.type))),Qe&&(be?i.texStorage2D(n.TEXTURE_2D,1,qt,wt.width,wt.height):i.texImage2D(n.TEXTURE_2D,0,qt,wt.width,wt.height,0,$e,Pt,null));else if(ie.isDataTexture)if(fn.length>0&&Xt){be&&Qe&&i.texStorage2D(n.TEXTURE_2D,Se,qt,fn[0].width,fn[0].height);for(let Ce=0,Ne=fn.length;Ce<Ne;Ce++)Ot=fn[Ce],be?i.texSubImage2D(n.TEXTURE_2D,Ce,0,0,Ot.width,Ot.height,$e,Pt,Ot.data):i.texImage2D(n.TEXTURE_2D,Ce,qt,Ot.width,Ot.height,0,$e,Pt,Ot.data);ie.generateMipmaps=!1}else be?(Qe&&i.texStorage2D(n.TEXTURE_2D,Se,qt,wt.width,wt.height),i.texSubImage2D(n.TEXTURE_2D,0,0,0,wt.width,wt.height,$e,Pt,wt.data)):i.texImage2D(n.TEXTURE_2D,0,qt,wt.width,wt.height,0,$e,Pt,wt.data);else if(ie.isCompressedTexture)if(ie.isCompressedArrayTexture){be&&Qe&&i.texStorage3D(n.TEXTURE_2D_ARRAY,Se,qt,fn[0].width,fn[0].height,wt.depth);for(let Ce=0,Ne=fn.length;Ce<Ne;Ce++)Ot=fn[Ce],ie.format!==vl?$e!==null?be?i.compressedTexSubImage3D(n.TEXTURE_2D_ARRAY,Ce,0,0,0,Ot.width,Ot.height,wt.depth,$e,Ot.data,0,0):i.compressedTexImage3D(n.TEXTURE_2D_ARRAY,Ce,qt,Ot.width,Ot.height,wt.depth,0,Ot.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):be?i.texSubImage3D(n.TEXTURE_2D_ARRAY,Ce,0,0,0,Ot.width,Ot.height,wt.depth,$e,Pt,Ot.data):i.texImage3D(n.TEXTURE_2D_ARRAY,Ce,qt,Ot.width,Ot.height,wt.depth,0,$e,Pt,Ot.data)}else{be&&Qe&&i.texStorage2D(n.TEXTURE_2D,Se,qt,fn[0].width,fn[0].height);for(let Ce=0,Ne=fn.length;Ce<Ne;Ce++)Ot=fn[Ce],ie.format!==vl?$e!==null?be?i.compressedTexSubImage2D(n.TEXTURE_2D,Ce,0,0,Ot.width,Ot.height,$e,Ot.data):i.compressedTexImage2D(n.TEXTURE_2D,Ce,qt,Ot.width,Ot.height,0,Ot.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):be?i.texSubImage2D(n.TEXTURE_2D,Ce,0,0,Ot.width,Ot.height,$e,Pt,Ot.data):i.texImage2D(n.TEXTURE_2D,Ce,qt,Ot.width,Ot.height,0,$e,Pt,Ot.data)}else if(ie.isDataArrayTexture)be?(Qe&&i.texStorage3D(n.TEXTURE_2D_ARRAY,Se,qt,wt.width,wt.height,wt.depth),i.texSubImage3D(n.TEXTURE_2D_ARRAY,0,0,0,0,wt.width,wt.height,wt.depth,$e,Pt,wt.data)):i.texImage3D(n.TEXTURE_2D_ARRAY,0,qt,wt.width,wt.height,wt.depth,0,$e,Pt,wt.data);else if(ie.isData3DTexture)be?(Qe&&i.texStorage3D(n.TEXTURE_3D,Se,qt,wt.width,wt.height,wt.depth),i.texSubImage3D(n.TEXTURE_3D,0,0,0,0,wt.width,wt.height,wt.depth,$e,Pt,wt.data)):i.texImage3D(n.TEXTURE_3D,0,qt,wt.width,wt.height,wt.depth,0,$e,Pt,wt.data);else if(ie.isFramebufferTexture){if(Qe)if(be)i.texStorage2D(n.TEXTURE_2D,Se,qt,wt.width,wt.height);else{let Ce=wt.width,Ne=wt.height;for(let et=0;et<Se;et++)i.texImage2D(n.TEXTURE_2D,et,qt,Ce,Ne,0,$e,Pt,null),Ce>>=1,Ne>>=1}}else if(fn.length>0&&Xt){be&&Qe&&i.texStorage2D(n.TEXTURE_2D,Se,qt,fn[0].width,fn[0].height);for(let Ce=0,Ne=fn.length;Ce<Ne;Ce++)Ot=fn[Ce],be?i.texSubImage2D(n.TEXTURE_2D,Ce,0,0,$e,Pt,Ot):i.texImage2D(n.TEXTURE_2D,Ce,qt,$e,Pt,Ot);ie.generateMipmaps=!1}else be?(Qe&&i.texStorage2D(n.TEXTURE_2D,Se,qt,wt.width,wt.height),i.texSubImage2D(n.TEXTURE_2D,0,0,0,$e,Pt,wt)):i.texImage2D(n.TEXTURE_2D,0,qt,$e,Pt,wt);$(ie,Xt)&&Y(ut),Mt.__version=lt.version,ie.onUpdate&&ie.onUpdate(ie)}de.__version=ie.version}function Kt(de,ie,Oe){if(ie.image.length!==6)return;const ut=At(de,ie),it=ie.source;i.bindTexture(n.TEXTURE_CUBE_MAP,de.__webglTexture,n.TEXTURE0+Oe);const lt=a.get(it);if(it.version!==lt.__version||ut===!0){i.activeTexture(n.TEXTURE0+Oe);const Mt=Vr.getPrimaries(Vr.workingColorSpace),Ut=ie.colorSpace===Zl?null:Vr.getPrimaries(ie.colorSpace),Wt=ie.colorSpace===Zl||Mt===Ut?n.NONE:n.BROWSER_DEFAULT_WEBGL;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,ie.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,ie.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,ie.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,Wt);const Ht=ie.isCompressedTexture||ie.image[0].isCompressedTexture,Dt=ie.image[0]&&ie.image[0].isDataTexture,wt=[];for(let Ce=0;Ce<6;Ce++)!Ht&&!Dt?wt[Ce]=O(ie.image[Ce],!1,!0,y):wt[Ce]=Dt?ie.image[Ce].image:ie.image[Ce],wt[Ce]=st(ie,wt[Ce]);const Xt=wt[0],$e=F(Xt)||f,Pt=l.convert(ie.format,ie.colorSpace),qt=l.convert(ie.type),Ot=te(ie.internalFormat,Pt,qt,ie.colorSpace),fn=f&&ie.isVideoTexture!==!0,be=lt.__version===void 0||ut===!0;let Qe=G(ie,Xt,$e);ct(n.TEXTURE_CUBE_MAP,ie,$e);let Se;if(Ht){fn&&be&&i.texStorage2D(n.TEXTURE_CUBE_MAP,Qe,Ot,Xt.width,Xt.height);for(let Ce=0;Ce<6;Ce++){Se=wt[Ce].mipmaps;for(let Ne=0;Ne<Se.length;Ne++){const et=Se[Ne];ie.format!==vl?Pt!==null?fn?i.compressedTexSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ce,Ne,0,0,et.width,et.height,Pt,et.data):i.compressedTexImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ce,Ne,Ot,et.width,et.height,0,et.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):fn?i.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ce,Ne,0,0,et.width,et.height,Pt,qt,et.data):i.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ce,Ne,Ot,et.width,et.height,0,Pt,qt,et.data)}}}else{Se=ie.mipmaps,fn&&be&&(Se.length>0&&Qe++,i.texStorage2D(n.TEXTURE_CUBE_MAP,Qe,Ot,wt[0].width,wt[0].height));for(let Ce=0;Ce<6;Ce++)if(Dt){fn?i.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ce,0,0,0,wt[Ce].width,wt[Ce].height,Pt,qt,wt[Ce].data):i.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ce,0,Ot,wt[Ce].width,wt[Ce].height,0,Pt,qt,wt[Ce].data);for(let Ne=0;Ne<Se.length;Ne++){const tt=Se[Ne].image[Ce].image;fn?i.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ce,Ne+1,0,0,tt.width,tt.height,Pt,qt,tt.data):i.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ce,Ne+1,Ot,tt.width,tt.height,0,Pt,qt,tt.data)}}else{fn?i.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ce,0,0,0,Pt,qt,wt[Ce]):i.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ce,0,Ot,Pt,qt,wt[Ce]);for(let Ne=0;Ne<Se.length;Ne++){const et=Se[Ne];fn?i.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ce,Ne+1,0,0,Pt,qt,et.image[Ce]):i.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Ce,Ne+1,Ot,Pt,qt,et.image[Ce])}}}$(ie,$e)&&Y(n.TEXTURE_CUBE_MAP),lt.__version=it.version,ie.onUpdate&&ie.onUpdate(ie)}de.__version=ie.version}function Et(de,ie,Oe,ut,it,lt){const Mt=l.convert(Oe.format,Oe.colorSpace),Ut=l.convert(Oe.type),Wt=te(Oe.internalFormat,Mt,Ut,Oe.colorSpace);if(!a.get(ie).__hasExternalTextures){const Dt=Math.max(1,ie.width>>lt),wt=Math.max(1,ie.height>>lt);it===n.TEXTURE_3D||it===n.TEXTURE_2D_ARRAY?i.texImage3D(it,lt,Wt,Dt,wt,ie.depth,0,Mt,Ut,null):i.texImage2D(it,lt,Wt,Dt,wt,0,Mt,Ut,null)}i.bindFramebuffer(n.FRAMEBUFFER,de),Ye(ie)?S.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,ut,it,a.get(Oe).__webglTexture,0,xe(ie)):(it===n.TEXTURE_2D||it>=n.TEXTURE_CUBE_MAP_POSITIVE_X&&it<=n.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&n.framebufferTexture2D(n.FRAMEBUFFER,ut,it,a.get(Oe).__webglTexture,lt),i.bindFramebuffer(n.FRAMEBUFFER,null)}function Ie(de,ie,Oe){if(n.bindRenderbuffer(n.RENDERBUFFER,de),ie.depthBuffer&&!ie.stencilBuffer){let ut=f===!0?n.DEPTH_COMPONENT24:n.DEPTH_COMPONENT16;if(Oe||Ye(ie)){const it=ie.depthTexture;it&&it.isDepthTexture&&(it.type===md?ut=n.DEPTH_COMPONENT32F:it.type===zh&&(ut=n.DEPTH_COMPONENT24));const lt=xe(ie);Ye(ie)?S.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,lt,ut,ie.width,ie.height):n.renderbufferStorageMultisample(n.RENDERBUFFER,lt,ut,ie.width,ie.height)}else n.renderbufferStorage(n.RENDERBUFFER,ut,ie.width,ie.height);n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.RENDERBUFFER,de)}else if(ie.depthBuffer&&ie.stencilBuffer){const ut=xe(ie);Oe&&Ye(ie)===!1?n.renderbufferStorageMultisample(n.RENDERBUFFER,ut,n.DEPTH24_STENCIL8,ie.width,ie.height):Ye(ie)?S.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,ut,n.DEPTH24_STENCIL8,ie.width,ie.height):n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,ie.width,ie.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,de)}else{const ut=ie.isWebGLMultipleRenderTargets===!0?ie.texture:[ie.texture];for(let it=0;it<ut.length;it++){const lt=ut[it],Mt=l.convert(lt.format,lt.colorSpace),Ut=l.convert(lt.type),Wt=te(lt.internalFormat,Mt,Ut,lt.colorSpace),Ht=xe(ie);Oe&&Ye(ie)===!1?n.renderbufferStorageMultisample(n.RENDERBUFFER,Ht,Wt,ie.width,ie.height):Ye(ie)?S.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,Ht,Wt,ie.width,ie.height):n.renderbufferStorage(n.RENDERBUFFER,Wt,ie.width,ie.height)}}n.bindRenderbuffer(n.RENDERBUFFER,null)}function pt(de,ie){if(ie&&ie.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(i.bindFramebuffer(n.FRAMEBUFFER,de),!(ie.depthTexture&&ie.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!a.get(ie.depthTexture).__webglTexture||ie.depthTexture.image.width!==ie.width||ie.depthTexture.image.height!==ie.height)&&(ie.depthTexture.image.width=ie.width,ie.depthTexture.image.height=ie.height,ie.depthTexture.needsUpdate=!0),we(ie.depthTexture,0);const ut=a.get(ie.depthTexture).__webglTexture,it=xe(ie);if(ie.depthTexture.format===_p)Ye(ie)?S.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,ut,0,it):n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,ut,0);else if(ie.depthTexture.format===jg)Ye(ie)?S.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.TEXTURE_2D,ut,0,it):n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.TEXTURE_2D,ut,0);else throw new Error("Unknown depthTexture format")}function gt(de){const ie=a.get(de),Oe=de.isWebGLCubeRenderTarget===!0;if(de.depthTexture&&!ie.__autoAllocateDepthBuffer){if(Oe)throw new Error("target.depthTexture not supported in Cube render targets");pt(ie.__webglFramebuffer,de)}else if(Oe){ie.__webglDepthbuffer=[];for(let ut=0;ut<6;ut++)i.bindFramebuffer(n.FRAMEBUFFER,ie.__webglFramebuffer[ut]),ie.__webglDepthbuffer[ut]=n.createRenderbuffer(),Ie(ie.__webglDepthbuffer[ut],de,!1)}else i.bindFramebuffer(n.FRAMEBUFFER,ie.__webglFramebuffer),ie.__webglDepthbuffer=n.createRenderbuffer(),Ie(ie.__webglDepthbuffer,de,!1);i.bindFramebuffer(n.FRAMEBUFFER,null)}function _t(de,ie,Oe){const ut=a.get(de);ie!==void 0&&Et(ut.__webglFramebuffer,de,de.texture,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,0),Oe!==void 0&&gt(de)}function Ue(de){const ie=de.texture,Oe=a.get(de),ut=a.get(ie);de.addEventListener("dispose",pe),de.isWebGLMultipleRenderTargets!==!0&&(ut.__webglTexture===void 0&&(ut.__webglTexture=n.createTexture()),ut.__version=ie.version,d.memory.textures++);const it=de.isWebGLCubeRenderTarget===!0,lt=de.isWebGLMultipleRenderTargets===!0,Mt=F(de)||f;if(it){Oe.__webglFramebuffer=[];for(let Ut=0;Ut<6;Ut++)if(f&&ie.mipmaps&&ie.mipmaps.length>0){Oe.__webglFramebuffer[Ut]=[];for(let Wt=0;Wt<ie.mipmaps.length;Wt++)Oe.__webglFramebuffer[Ut][Wt]=n.createFramebuffer()}else Oe.__webglFramebuffer[Ut]=n.createFramebuffer()}else{if(f&&ie.mipmaps&&ie.mipmaps.length>0){Oe.__webglFramebuffer=[];for(let Ut=0;Ut<ie.mipmaps.length;Ut++)Oe.__webglFramebuffer[Ut]=n.createFramebuffer()}else Oe.__webglFramebuffer=n.createFramebuffer();if(lt)if(s.drawBuffers){const Ut=de.texture;for(let Wt=0,Ht=Ut.length;Wt<Ht;Wt++){const Dt=a.get(Ut[Wt]);Dt.__webglTexture===void 0&&(Dt.__webglTexture=n.createTexture(),d.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(f&&de.samples>0&&Ye(de)===!1){const Ut=lt?ie:[ie];Oe.__webglMultisampledFramebuffer=n.createFramebuffer(),Oe.__webglColorRenderbuffer=[],i.bindFramebuffer(n.FRAMEBUFFER,Oe.__webglMultisampledFramebuffer);for(let Wt=0;Wt<Ut.length;Wt++){const Ht=Ut[Wt];Oe.__webglColorRenderbuffer[Wt]=n.createRenderbuffer(),n.bindRenderbuffer(n.RENDERBUFFER,Oe.__webglColorRenderbuffer[Wt]);const Dt=l.convert(Ht.format,Ht.colorSpace),wt=l.convert(Ht.type),Xt=te(Ht.internalFormat,Dt,wt,Ht.colorSpace,de.isXRRenderTarget===!0),$e=xe(de);n.renderbufferStorageMultisample(n.RENDERBUFFER,$e,Xt,de.width,de.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+Wt,n.RENDERBUFFER,Oe.__webglColorRenderbuffer[Wt])}n.bindRenderbuffer(n.RENDERBUFFER,null),de.depthBuffer&&(Oe.__webglDepthRenderbuffer=n.createRenderbuffer(),Ie(Oe.__webglDepthRenderbuffer,de,!0)),i.bindFramebuffer(n.FRAMEBUFFER,null)}}if(it){i.bindTexture(n.TEXTURE_CUBE_MAP,ut.__webglTexture),ct(n.TEXTURE_CUBE_MAP,ie,Mt);for(let Ut=0;Ut<6;Ut++)if(f&&ie.mipmaps&&ie.mipmaps.length>0)for(let Wt=0;Wt<ie.mipmaps.length;Wt++)Et(Oe.__webglFramebuffer[Ut][Wt],de,ie,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+Ut,Wt);else Et(Oe.__webglFramebuffer[Ut],de,ie,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+Ut,0);$(ie,Mt)&&Y(n.TEXTURE_CUBE_MAP),i.unbindTexture()}else if(lt){const Ut=de.texture;for(let Wt=0,Ht=Ut.length;Wt<Ht;Wt++){const Dt=Ut[Wt],wt=a.get(Dt);i.bindTexture(n.TEXTURE_2D,wt.__webglTexture),ct(n.TEXTURE_2D,Dt,Mt),Et(Oe.__webglFramebuffer,de,Dt,n.COLOR_ATTACHMENT0+Wt,n.TEXTURE_2D,0),$(Dt,Mt)&&Y(n.TEXTURE_2D)}i.unbindTexture()}else{let Ut=n.TEXTURE_2D;if((de.isWebGL3DRenderTarget||de.isWebGLArrayRenderTarget)&&(f?Ut=de.isWebGL3DRenderTarget?n.TEXTURE_3D:n.TEXTURE_2D_ARRAY:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),i.bindTexture(Ut,ut.__webglTexture),ct(Ut,ie,Mt),f&&ie.mipmaps&&ie.mipmaps.length>0)for(let Wt=0;Wt<ie.mipmaps.length;Wt++)Et(Oe.__webglFramebuffer[Wt],de,ie,n.COLOR_ATTACHMENT0,Ut,Wt);else Et(Oe.__webglFramebuffer,de,ie,n.COLOR_ATTACHMENT0,Ut,0);$(ie,Mt)&&Y(Ut),i.unbindTexture()}de.depthBuffer&&gt(de)}function ue(de){const ie=F(de)||f,Oe=de.isWebGLMultipleRenderTargets===!0?de.texture:[de.texture];for(let ut=0,it=Oe.length;ut<it;ut++){const lt=Oe[ut];if($(lt,ie)){const Mt=de.isWebGLCubeRenderTarget?n.TEXTURE_CUBE_MAP:n.TEXTURE_2D,Ut=a.get(lt).__webglTexture;i.bindTexture(Mt,Ut),Y(Mt),i.unbindTexture()}}}function se(de){if(f&&de.samples>0&&Ye(de)===!1){const ie=de.isWebGLMultipleRenderTargets?de.texture:[de.texture],Oe=de.width,ut=de.height;let it=n.COLOR_BUFFER_BIT;const lt=[],Mt=de.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT,Ut=a.get(de),Wt=de.isWebGLMultipleRenderTargets===!0;if(Wt)for(let Ht=0;Ht<ie.length;Ht++)i.bindFramebuffer(n.FRAMEBUFFER,Ut.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+Ht,n.RENDERBUFFER,null),i.bindFramebuffer(n.FRAMEBUFFER,Ut.__webglFramebuffer),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0+Ht,n.TEXTURE_2D,null,0);i.bindFramebuffer(n.READ_FRAMEBUFFER,Ut.__webglMultisampledFramebuffer),i.bindFramebuffer(n.DRAW_FRAMEBUFFER,Ut.__webglFramebuffer);for(let Ht=0;Ht<ie.length;Ht++){lt.push(n.COLOR_ATTACHMENT0+Ht),de.depthBuffer&&lt.push(Mt);const Dt=Ut.__ignoreDepthValues!==void 0?Ut.__ignoreDepthValues:!1;if(Dt===!1&&(de.depthBuffer&&(it|=n.DEPTH_BUFFER_BIT),de.stencilBuffer&&(it|=n.STENCIL_BUFFER_BIT)),Wt&&n.framebufferRenderbuffer(n.READ_FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.RENDERBUFFER,Ut.__webglColorRenderbuffer[Ht]),Dt===!0&&(n.invalidateFramebuffer(n.READ_FRAMEBUFFER,[Mt]),n.invalidateFramebuffer(n.DRAW_FRAMEBUFFER,[Mt])),Wt){const wt=a.get(ie[Ht]).__webglTexture;n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,wt,0)}n.blitFramebuffer(0,0,Oe,ut,0,0,Oe,ut,it,n.NEAREST),A&&n.invalidateFramebuffer(n.READ_FRAMEBUFFER,lt)}if(i.bindFramebuffer(n.READ_FRAMEBUFFER,null),i.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),Wt)for(let Ht=0;Ht<ie.length;Ht++){i.bindFramebuffer(n.FRAMEBUFFER,Ut.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+Ht,n.RENDERBUFFER,Ut.__webglColorRenderbuffer[Ht]);const Dt=a.get(ie[Ht]).__webglTexture;i.bindFramebuffer(n.FRAMEBUFFER,Ut.__webglFramebuffer),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0+Ht,n.TEXTURE_2D,Dt,0)}i.bindFramebuffer(n.DRAW_FRAMEBUFFER,Ut.__webglMultisampledFramebuffer)}}function xe(de){return Math.min(b,de.samples)}function Ye(de){const ie=a.get(de);return f&&de.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&ie.__useRenderToTexture!==!1}function ze(de){const ie=d.render.frame;P.get(de)!==ie&&(P.set(de,ie),de.update())}function st(de,ie){const Oe=de.colorSpace,ut=de.format,it=de.type;return de.isCompressedTexture===!0||de.isVideoTexture===!0||de.format===gT||Oe!==Cd&&Oe!==Zl&&(Vr.getTransfer(Oe)===ra?f===!1?e.has("EXT_sRGB")===!0&&ut===vl?(de.format=gT,de.minFilter=ka,de.generateMipmaps=!1):ie=wz.sRGBToLinear(ie):(ut!==vl||it!==wd)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",Oe)),ie}this.allocateTextureUnit=le,this.resetTextureUnits=Be,this.setTexture2D=we,this.setTexture2DArray=re,this.setTexture3D=Te,this.setTextureCube=Je,this.rebindTextures=_t,this.setupRenderTarget=Ue,this.updateRenderTargetMipmap=ue,this.updateMultisampleRenderTarget=se,this.setupDepthRenderbuffer=gt,this.setupFrameBufferTexture=Et,this.useMultisampledRTT=Ye}function WZ(n,e,i){const a=i.isWebGL2;function s(l,d=Zl){let f;const p=Vr.getTransfer(d);if(l===wd)return n.UNSIGNED_BYTE;if(l===fz)return n.UNSIGNED_SHORT_4_4_4_4;if(l===pz)return n.UNSIGNED_SHORT_5_5_5_1;if(l===oZ)return n.BYTE;if(l===sZ)return n.SHORT;if(l===XA)return n.UNSIGNED_SHORT;if(l===hz)return n.INT;if(l===zh)return n.UNSIGNED_INT;if(l===md)return n.FLOAT;if(l===v_)return a?n.HALF_FLOAT:(f=e.get("OES_texture_half_float"),f!==null?f.HALF_FLOAT_OES:null);if(l===lZ)return n.ALPHA;if(l===vl)return n.RGBA;if(l===cZ)return n.LUMINANCE;if(l===uZ)return n.LUMINANCE_ALPHA;if(l===_p)return n.DEPTH_COMPONENT;if(l===jg)return n.DEPTH_STENCIL;if(l===gT)return f=e.get("EXT_sRGB"),f!==null?f.SRGB_ALPHA_EXT:null;if(l===dZ)return n.RED;if(l===mz)return n.RED_INTEGER;if(l===hZ)return n.RG;if(l===gz)return n.RG_INTEGER;if(l===yz)return n.RGBA_INTEGER;if(l===fM||l===pM||l===mM||l===gM)if(p===ra)if(f=e.get("WEBGL_compressed_texture_s3tc_srgb"),f!==null){if(l===fM)return f.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(l===pM)return f.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(l===mM)return f.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(l===gM)return f.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(f=e.get("WEBGL_compressed_texture_s3tc"),f!==null){if(l===fM)return f.COMPRESSED_RGB_S3TC_DXT1_EXT;if(l===pM)return f.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(l===mM)return f.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(l===gM)return f.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(l===p5||l===m5||l===g5||l===y5)if(f=e.get("WEBGL_compressed_texture_pvrtc"),f!==null){if(l===p5)return f.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(l===m5)return f.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(l===g5)return f.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(l===y5)return f.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(l===fZ)return f=e.get("WEBGL_compressed_texture_etc1"),f!==null?f.COMPRESSED_RGB_ETC1_WEBGL:null;if(l===v5||l===_5)if(f=e.get("WEBGL_compressed_texture_etc"),f!==null){if(l===v5)return p===ra?f.COMPRESSED_SRGB8_ETC2:f.COMPRESSED_RGB8_ETC2;if(l===_5)return p===ra?f.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:f.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(l===x5||l===b5||l===w5||l===S5||l===E5||l===M5||l===T5||l===A5||l===C5||l===P5||l===I5||l===R5||l===L5||l===k5)if(f=e.get("WEBGL_compressed_texture_astc"),f!==null){if(l===x5)return p===ra?f.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:f.COMPRESSED_RGBA_ASTC_4x4_KHR;if(l===b5)return p===ra?f.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:f.COMPRESSED_RGBA_ASTC_5x4_KHR;if(l===w5)return p===ra?f.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:f.COMPRESSED_RGBA_ASTC_5x5_KHR;if(l===S5)return p===ra?f.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:f.COMPRESSED_RGBA_ASTC_6x5_KHR;if(l===E5)return p===ra?f.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:f.COMPRESSED_RGBA_ASTC_6x6_KHR;if(l===M5)return p===ra?f.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:f.COMPRESSED_RGBA_ASTC_8x5_KHR;if(l===T5)return p===ra?f.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:f.COMPRESSED_RGBA_ASTC_8x6_KHR;if(l===A5)return p===ra?f.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:f.COMPRESSED_RGBA_ASTC_8x8_KHR;if(l===C5)return p===ra?f.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:f.COMPRESSED_RGBA_ASTC_10x5_KHR;if(l===P5)return p===ra?f.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:f.COMPRESSED_RGBA_ASTC_10x6_KHR;if(l===I5)return p===ra?f.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:f.COMPRESSED_RGBA_ASTC_10x8_KHR;if(l===R5)return p===ra?f.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:f.COMPRESSED_RGBA_ASTC_10x10_KHR;if(l===L5)return p===ra?f.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:f.COMPRESSED_RGBA_ASTC_12x10_KHR;if(l===k5)return p===ra?f.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:f.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(l===yM||l===D5||l===z5)if(f=e.get("EXT_texture_compression_bptc"),f!==null){if(l===yM)return p===ra?f.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:f.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(l===D5)return f.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(l===z5)return f.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(l===pZ||l===O5||l===N5||l===F5)if(f=e.get("EXT_texture_compression_rgtc"),f!==null){if(l===yM)return f.COMPRESSED_RED_RGTC1_EXT;if(l===O5)return f.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(l===N5)return f.COMPRESSED_RED_GREEN_RGTC2_EXT;if(l===F5)return f.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return l===vp?a?n.UNSIGNED_INT_24_8:(f=e.get("WEBGL_depth_texture"),f!==null?f.UNSIGNED_INT_24_8_WEBGL:null):n[l]!==void 0?n[l]:null}return{convert:s}}class VZ extends Za{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}}class N0 extends br{constructor(){super(),this.isGroup=!0,this.type="Group"}}const sEe={type:"move"};class rL{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new N0,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new N0,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new We,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new We),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new N0,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new We,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new We),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const i=this._hand;if(i)for(const a of e.hand.values())this._getHandJoint(i,a)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,i,a){let s=null,l=null,d=null;const f=this._targetRay,p=this._grip,y=this._hand;if(e&&i.session.visibilityState!=="visible-blurred"){if(y&&e.hand){d=!0;for(const L of e.hand.values()){const k=i.getJointPose(L,a),R=this._getHandJoint(y,L);k!==null&&(R.matrix.fromArray(k.transform.matrix),R.matrix.decompose(R.position,R.rotation,R.scale),R.matrixWorldNeedsUpdate=!0,R.jointRadius=k.radius),R.visible=k!==null}const _=y.joints["index-finger-tip"],b=y.joints["thumb-tip"],S=_.position.distanceTo(b.position),A=.02,P=.005;y.inputState.pinching&&S>A+P?(y.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!y.inputState.pinching&&S<=A-P&&(y.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else p!==null&&e.gripSpace&&(l=i.getPose(e.gripSpace,a),l!==null&&(p.matrix.fromArray(l.transform.matrix),p.matrix.decompose(p.position,p.rotation,p.scale),p.matrixWorldNeedsUpdate=!0,l.linearVelocity?(p.hasLinearVelocity=!0,p.linearVelocity.copy(l.linearVelocity)):p.hasLinearVelocity=!1,l.angularVelocity?(p.hasAngularVelocity=!0,p.angularVelocity.copy(l.angularVelocity)):p.hasAngularVelocity=!1));f!==null&&(s=i.getPose(e.targetRaySpace,a),s===null&&l!==null&&(s=l),s!==null&&(f.matrix.fromArray(s.transform.matrix),f.matrix.decompose(f.position,f.rotation,f.scale),f.matrixWorldNeedsUpdate=!0,s.linearVelocity?(f.hasLinearVelocity=!0,f.linearVelocity.copy(s.linearVelocity)):f.hasLinearVelocity=!1,s.angularVelocity?(f.hasAngularVelocity=!0,f.angularVelocity.copy(s.angularVelocity)):f.hasAngularVelocity=!1,this.dispatchEvent(sEe)))}return f!==null&&(f.visible=s!==null),p!==null&&(p.visible=l!==null),y!==null&&(y.visible=d!==null),this}_getHandJoint(e,i){if(e.joints[i.jointName]===void 0){const a=new N0;a.matrixAutoUpdate=!1,a.visible=!1,e.joints[i.jointName]=a,e.add(a)}return e.joints[i.jointName]}}class GZ extends Oa{constructor(e,i,a,s,l,d,f,p,y,_){if(_=_!==void 0?_:_p,_!==_p&&_!==jg)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");a===void 0&&_===_p&&(a=zh),a===void 0&&_===jg&&(a=vp),super(null,s,l,d,f,p,_,a,y),this.isDepthTexture=!0,this.image={width:e,height:i},this.magFilter=f!==void 0?f:co,this.minFilter=p!==void 0?p:co,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.compareFunction=e.compareFunction,this}toJSON(e){const i=super.toJSON(e);return this.compareFunction!==null&&(i.compareFunction=this.compareFunction),i}}class lEe extends Ld{constructor(e,i){super();const a=this;let s=null,l=1,d=null,f="local-floor",p=1,y=null,_=null,b=null,S=null,A=null,P=null;const L=i.getContextAttributes();let k=null,R=null;const z=[],O=[],F=new Za;F.layers.enable(1),F.viewport=new Lr;const H=new Za;H.layers.enable(2),H.viewport=new Lr;const $=[F,H],Y=new VZ;Y.layers.enable(1),Y.layers.enable(2);let te=null,G=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(re){let Te=z[re];return Te===void 0&&(Te=new rL,z[re]=Te),Te.getTargetRaySpace()},this.getControllerGrip=function(re){let Te=z[re];return Te===void 0&&(Te=new rL,z[re]=Te),Te.getGripSpace()},this.getHand=function(re){let Te=z[re];return Te===void 0&&(Te=new rL,z[re]=Te),Te.getHandSpace()};function Q(re){const Te=O.indexOf(re.inputSource);if(Te===-1)return;const Je=z[Te];Je!==void 0&&(Je.update(re.inputSource,re.frame,y||d),Je.dispatchEvent({type:re.type,data:re.inputSource}))}function he(){s.removeEventListener("select",Q),s.removeEventListener("selectstart",Q),s.removeEventListener("selectend",Q),s.removeEventListener("squeeze",Q),s.removeEventListener("squeezestart",Q),s.removeEventListener("squeezeend",Q),s.removeEventListener("end",he),s.removeEventListener("inputsourceschange",pe);for(let re=0;re<z.length;re++){const Te=O[re];Te!==null&&(O[re]=null,z[re].disconnect(Te))}te=null,G=null,e.setRenderTarget(k),A=null,S=null,b=null,s=null,R=null,we.stop(),a.isPresenting=!1,a.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(re){l=re,a.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(re){f=re,a.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return y||d},this.setReferenceSpace=function(re){y=re},this.getBaseLayer=function(){return S!==null?S:A},this.getBinding=function(){return b},this.getFrame=function(){return P},this.getSession=function(){return s},this.setSession=async function(re){if(s=re,s!==null){if(k=e.getRenderTarget(),s.addEventListener("select",Q),s.addEventListener("selectstart",Q),s.addEventListener("selectend",Q),s.addEventListener("squeeze",Q),s.addEventListener("squeezestart",Q),s.addEventListener("squeezeend",Q),s.addEventListener("end",he),s.addEventListener("inputsourceschange",pe),L.xrCompatible!==!0&&await i.makeXRCompatible(),s.renderState.layers===void 0||e.capabilities.isWebGL2===!1){const Te={antialias:s.renderState.layers===void 0?L.antialias:!0,alpha:!0,depth:L.depth,stencil:L.stencil,framebufferScaleFactor:l};A=new XRWebGLLayer(s,i,Te),s.updateRenderState({baseLayer:A}),R=new wu(A.framebufferWidth,A.framebufferHeight,{format:vl,type:wd,colorSpace:e.outputColorSpace,stencilBuffer:L.stencil})}else{let Te=null,Je=null,Xe=null;L.depth&&(Xe=L.stencil?i.DEPTH24_STENCIL8:i.DEPTH_COMPONENT24,Te=L.stencil?jg:_p,Je=L.stencil?vp:zh);const Ze={colorFormat:i.RGBA8,depthFormat:Xe,scaleFactor:l};b=new XRWebGLBinding(s,i),S=b.createProjectionLayer(Ze),s.updateRenderState({layers:[S]}),R=new wu(S.textureWidth,S.textureHeight,{format:vl,type:wd,depthTexture:new GZ(S.textureWidth,S.textureHeight,Je,void 0,void 0,void 0,void 0,void 0,void 0,Te),stencilBuffer:L.stencil,colorSpace:e.outputColorSpace,samples:L.antialias?4:0});const Fe=e.properties.get(R);Fe.__ignoreDepthValues=S.ignoreDepthValues}R.isXRRenderTarget=!0,this.setFoveation(p),y=null,d=await s.requestReferenceSpace(f),we.setContext(s),we.start(),a.isPresenting=!0,a.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(s!==null)return s.environmentBlendMode};function pe(re){for(let Te=0;Te<re.removed.length;Te++){const Je=re.removed[Te],Xe=O.indexOf(Je);Xe>=0&&(O[Xe]=null,z[Xe].disconnect(Je))}for(let Te=0;Te<re.added.length;Te++){const Je=re.added[Te];let Xe=O.indexOf(Je);if(Xe===-1){for(let Fe=0;Fe<z.length;Fe++)if(Fe>=O.length){O.push(Je),Xe=Fe;break}else if(O[Fe]===null){O[Fe]=Je,Xe=Fe;break}if(Xe===-1)break}const Ze=z[Xe];Ze&&Ze.connect(Je)}}const ye=new We,fe=new We;function Ae(re,Te,Je){ye.setFromMatrixPosition(Te.matrixWorld),fe.setFromMatrixPosition(Je.matrixWorld);const Xe=ye.distanceTo(fe),Ze=Te.projectionMatrix.elements,Fe=Je.projectionMatrix.elements,ct=Ze[14]/(Ze[10]-1),At=Ze[14]/(Ze[10]+1),kt=(Ze[9]+1)/Ze[5],Kt=(Ze[9]-1)/Ze[5],Et=(Ze[8]-1)/Ze[0],Ie=(Fe[8]+1)/Fe[0],pt=ct*Et,gt=ct*Ie,_t=Xe/(-Et+Ie),Ue=_t*-Et;Te.matrixWorld.decompose(re.position,re.quaternion,re.scale),re.translateX(Ue),re.translateZ(_t),re.matrixWorld.compose(re.position,re.quaternion,re.scale),re.matrixWorldInverse.copy(re.matrixWorld).invert();const ue=ct+_t,se=At+_t,xe=pt-Ue,Ye=gt+(Xe-Ue),ze=kt*At/se*ue,st=Kt*At/se*ue;re.projectionMatrix.makePerspective(xe,Ye,ze,st,ue,se),re.projectionMatrixInverse.copy(re.projectionMatrix).invert()}function Re(re,Te){Te===null?re.matrixWorld.copy(re.matrix):re.matrixWorld.multiplyMatrices(Te.matrixWorld,re.matrix),re.matrixWorldInverse.copy(re.matrixWorld).invert()}this.updateCamera=function(re){if(s===null)return;Y.near=H.near=F.near=re.near,Y.far=H.far=F.far=re.far,(te!==Y.near||G!==Y.far)&&(s.updateRenderState({depthNear:Y.near,depthFar:Y.far}),te=Y.near,G=Y.far);const Te=re.parent,Je=Y.cameras;Re(Y,Te);for(let Xe=0;Xe<Je.length;Xe++)Re(Je[Xe],Te);Je.length===2?Ae(Y,F,H):Y.projectionMatrix.copy(F.projectionMatrix),Be(re,Y,Te)};function Be(re,Te,Je){Je===null?re.matrix.copy(Te.matrixWorld):(re.matrix.copy(Je.matrixWorld),re.matrix.invert(),re.matrix.multiply(Te.matrixWorld)),re.matrix.decompose(re.position,re.quaternion,re.scale),re.updateMatrixWorld(!0),re.projectionMatrix.copy(Te.projectionMatrix),re.projectionMatrixInverse.copy(Te.projectionMatrixInverse),re.isPerspectiveCamera&&(re.fov=__*2*Math.atan(1/re.projectionMatrix.elements[5]),re.zoom=1)}this.getCamera=function(){return Y},this.getFoveation=function(){if(!(S===null&&A===null))return p},this.setFoveation=function(re){p=re,S!==null&&(S.fixedFoveation=re),A!==null&&A.fixedFoveation!==void 0&&(A.fixedFoveation=re)};let le=null;function me(re,Te){if(_=Te.getViewerPose(y||d),P=Te,_!==null){const Je=_.views;A!==null&&(e.setRenderTargetFramebuffer(R,A.framebuffer),e.setRenderTarget(R));let Xe=!1;Je.length!==Y.cameras.length&&(Y.cameras.length=0,Xe=!0);for(let Ze=0;Ze<Je.length;Ze++){const Fe=Je[Ze];let ct=null;if(A!==null)ct=A.getViewport(Fe);else{const kt=b.getViewSubImage(S,Fe);ct=kt.viewport,Ze===0&&(e.setRenderTargetTextures(R,kt.colorTexture,S.ignoreDepthValues?void 0:kt.depthStencilTexture),e.setRenderTarget(R))}let At=$[Ze];At===void 0&&(At=new Za,At.layers.enable(Ze),At.viewport=new Lr,$[Ze]=At),At.matrix.fromArray(Fe.transform.matrix),At.matrix.decompose(At.position,At.quaternion,At.scale),At.projectionMatrix.fromArray(Fe.projectionMatrix),At.projectionMatrixInverse.copy(At.projectionMatrix).invert(),At.viewport.set(ct.x,ct.y,ct.width,ct.height),Ze===0&&(Y.matrix.copy(At.matrix),Y.matrix.decompose(Y.position,Y.quaternion,Y.scale)),Xe===!0&&Y.cameras.push(At)}}for(let Je=0;Je<z.length;Je++){const Xe=O[Je],Ze=z[Je];Xe!==null&&Ze!==void 0&&Ze.update(Xe,Te,y||d)}le&&le(re,Te),Te.detectedPlanes&&a.dispatchEvent({type:"planesdetected",data:Te}),P=null}const we=new OZ;we.setAnimationLoop(me),this.setAnimationLoop=function(re){le=re},this.dispose=function(){}}}function cEe(n,e){function i(k,R){k.matrixAutoUpdate===!0&&k.updateMatrix(),R.value.copy(k.matrix)}function a(k,R){R.color.getRGB(k.fogColor.value,kZ(n)),R.isFog?(k.fogNear.value=R.near,k.fogFar.value=R.far):R.isFogExp2&&(k.fogDensity.value=R.density)}function s(k,R,z,O,F){R.isMeshBasicMaterial||R.isMeshLambertMaterial?l(k,R):R.isMeshToonMaterial?(l(k,R),b(k,R)):R.isMeshPhongMaterial?(l(k,R),_(k,R)):R.isMeshStandardMaterial?(l(k,R),S(k,R),R.isMeshPhysicalMaterial&&A(k,R,F)):R.isMeshMatcapMaterial?(l(k,R),P(k,R)):R.isMeshDepthMaterial?l(k,R):R.isMeshDistanceMaterial?(l(k,R),L(k,R)):R.isMeshNormalMaterial?l(k,R):R.isLineBasicMaterial?(d(k,R),R.isLineDashedMaterial&&f(k,R)):R.isPointsMaterial?p(k,R,z,O):R.isSpriteMaterial?y(k,R):R.isShadowMaterial?(k.color.value.copy(R.color),k.opacity.value=R.opacity):R.isShaderMaterial&&(R.uniformsNeedUpdate=!1)}function l(k,R){k.opacity.value=R.opacity,R.color&&k.diffuse.value.copy(R.color),R.emissive&&k.emissive.value.copy(R.emissive).multiplyScalar(R.emissiveIntensity),R.map&&(k.map.value=R.map,i(R.map,k.mapTransform)),R.alphaMap&&(k.alphaMap.value=R.alphaMap,i(R.alphaMap,k.alphaMapTransform)),R.bumpMap&&(k.bumpMap.value=R.bumpMap,i(R.bumpMap,k.bumpMapTransform),k.bumpScale.value=R.bumpScale,R.side===Ts&&(k.bumpScale.value*=-1)),R.normalMap&&(k.normalMap.value=R.normalMap,i(R.normalMap,k.normalMapTransform),k.normalScale.value.copy(R.normalScale),R.side===Ts&&k.normalScale.value.negate()),R.displacementMap&&(k.displacementMap.value=R.displacementMap,i(R.displacementMap,k.displacementMapTransform),k.displacementScale.value=R.displacementScale,k.displacementBias.value=R.displacementBias),R.emissiveMap&&(k.emissiveMap.value=R.emissiveMap,i(R.emissiveMap,k.emissiveMapTransform)),R.specularMap&&(k.specularMap.value=R.specularMap,i(R.specularMap,k.specularMapTransform)),R.alphaTest>0&&(k.alphaTest.value=R.alphaTest);const z=e.get(R).envMap;if(z&&(k.envMap.value=z,k.flipEnvMap.value=z.isCubeTexture&&z.isRenderTargetTexture===!1?-1:1,k.reflectivity.value=R.reflectivity,k.ior.value=R.ior,k.refractionRatio.value=R.refractionRatio),R.lightMap){k.lightMap.value=R.lightMap;const O=n._useLegacyLights===!0?Math.PI:1;k.lightMapIntensity.value=R.lightMapIntensity*O,i(R.lightMap,k.lightMapTransform)}R.aoMap&&(k.aoMap.value=R.aoMap,k.aoMapIntensity.value=R.aoMapIntensity,i(R.aoMap,k.aoMapTransform))}function d(k,R){k.diffuse.value.copy(R.color),k.opacity.value=R.opacity,R.map&&(k.map.value=R.map,i(R.map,k.mapTransform))}function f(k,R){k.dashSize.value=R.dashSize,k.totalSize.value=R.dashSize+R.gapSize,k.scale.value=R.scale}function p(k,R,z,O){k.diffuse.value.copy(R.color),k.opacity.value=R.opacity,k.size.value=R.size*z,k.scale.value=O*.5,R.map&&(k.map.value=R.map,i(R.map,k.uvTransform)),R.alphaMap&&(k.alphaMap.value=R.alphaMap,i(R.alphaMap,k.alphaMapTransform)),R.alphaTest>0&&(k.alphaTest.value=R.alphaTest)}function y(k,R){k.diffuse.value.copy(R.color),k.opacity.value=R.opacity,k.rotation.value=R.rotation,R.map&&(k.map.value=R.map,i(R.map,k.mapTransform)),R.alphaMap&&(k.alphaMap.value=R.alphaMap,i(R.alphaMap,k.alphaMapTransform)),R.alphaTest>0&&(k.alphaTest.value=R.alphaTest)}function _(k,R){k.specular.value.copy(R.specular),k.shininess.value=Math.max(R.shininess,1e-4)}function b(k,R){R.gradientMap&&(k.gradientMap.value=R.gradientMap)}function S(k,R){k.metalness.value=R.metalness,R.metalnessMap&&(k.metalnessMap.value=R.metalnessMap,i(R.metalnessMap,k.metalnessMapTransform)),k.roughness.value=R.roughness,R.roughnessMap&&(k.roughnessMap.value=R.roughnessMap,i(R.roughnessMap,k.roughnessMapTransform)),e.get(R).envMap&&(k.envMapIntensity.value=R.envMapIntensity)}function A(k,R,z){k.ior.value=R.ior,R.sheen>0&&(k.sheenColor.value.copy(R.sheenColor).multiplyScalar(R.sheen),k.sheenRoughness.value=R.sheenRoughness,R.sheenColorMap&&(k.sheenColorMap.value=R.sheenColorMap,i(R.sheenColorMap,k.sheenColorMapTransform)),R.sheenRoughnessMap&&(k.sheenRoughnessMap.value=R.sheenRoughnessMap,i(R.sheenRoughnessMap,k.sheenRoughnessMapTransform))),R.clearcoat>0&&(k.clearcoat.value=R.clearcoat,k.clearcoatRoughness.value=R.clearcoatRoughness,R.clearcoatMap&&(k.clearcoatMap.value=R.clearcoatMap,i(R.clearcoatMap,k.clearcoatMapTransform)),R.clearcoatRoughnessMap&&(k.clearcoatRoughnessMap.value=R.clearcoatRoughnessMap,i(R.clearcoatRoughnessMap,k.clearcoatRoughnessMapTransform)),R.clearcoatNormalMap&&(k.clearcoatNormalMap.value=R.clearcoatNormalMap,i(R.clearcoatNormalMap,k.clearcoatNormalMapTransform),k.clearcoatNormalScale.value.copy(R.clearcoatNormalScale),R.side===Ts&&k.clearcoatNormalScale.value.negate())),R.iridescence>0&&(k.iridescence.value=R.iridescence,k.iridescenceIOR.value=R.iridescenceIOR,k.iridescenceThicknessMinimum.value=R.iridescenceThicknessRange[0],k.iridescenceThicknessMaximum.value=R.iridescenceThicknessRange[1],R.iridescenceMap&&(k.iridescenceMap.value=R.iridescenceMap,i(R.iridescenceMap,k.iridescenceMapTransform)),R.iridescenceThicknessMap&&(k.iridescenceThicknessMap.value=R.iridescenceThicknessMap,i(R.iridescenceThicknessMap,k.iridescenceThicknessMapTransform))),R.transmission>0&&(k.transmission.value=R.transmission,k.transmissionSamplerMap.value=z.texture,k.transmissionSamplerSize.value.set(z.width,z.height),R.transmissionMap&&(k.transmissionMap.value=R.transmissionMap,i(R.transmissionMap,k.transmissionMapTransform)),k.thickness.value=R.thickness,R.thicknessMap&&(k.thicknessMap.value=R.thicknessMap,i(R.thicknessMap,k.thicknessMapTransform)),k.attenuationDistance.value=R.attenuationDistance,k.attenuationColor.value.copy(R.attenuationColor)),R.anisotropy>0&&(k.anisotropyVector.value.set(R.anisotropy*Math.cos(R.anisotropyRotation),R.anisotropy*Math.sin(R.anisotropyRotation)),R.anisotropyMap&&(k.anisotropyMap.value=R.anisotropyMap,i(R.anisotropyMap,k.anisotropyMapTransform))),k.specularIntensity.value=R.specularIntensity,k.specularColor.value.copy(R.specularColor),R.specularColorMap&&(k.specularColorMap.value=R.specularColorMap,i(R.specularColorMap,k.specularColorMapTransform)),R.specularIntensityMap&&(k.specularIntensityMap.value=R.specularIntensityMap,i(R.specularIntensityMap,k.specularIntensityMapTransform))}function P(k,R){R.matcap&&(k.matcap.value=R.matcap)}function L(k,R){const z=e.get(R).light;k.referencePosition.value.setFromMatrixPosition(z.matrixWorld),k.nearDistance.value=z.shadow.camera.near,k.farDistance.value=z.shadow.camera.far}return{refreshFogUniforms:a,refreshMaterialUniforms:s}}function uEe(n,e,i,a){let s={},l={},d=[];const f=i.isWebGL2?n.getParameter(n.MAX_UNIFORM_BUFFER_BINDINGS):0;function p(z,O){const F=O.program;a.uniformBlockBinding(z,F)}function y(z,O){let F=s[z.id];F===void 0&&(P(z),F=_(z),s[z.id]=F,z.addEventListener("dispose",k));const H=O.program;a.updateUBOMapping(z,H);const $=e.render.frame;l[z.id]!==$&&(S(z),l[z.id]=$)}function _(z){const O=b();z.__bindingPointIndex=O;const F=n.createBuffer(),H=z.__size,$=z.usage;return n.bindBuffer(n.UNIFORM_BUFFER,F),n.bufferData(n.UNIFORM_BUFFER,H,$),n.bindBuffer(n.UNIFORM_BUFFER,null),n.bindBufferBase(n.UNIFORM_BUFFER,O,F),F}function b(){for(let z=0;z<f;z++)if(d.indexOf(z)===-1)return d.push(z),z;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function S(z){const O=s[z.id],F=z.uniforms,H=z.__cache;n.bindBuffer(n.UNIFORM_BUFFER,O);for(let $=0,Y=F.length;$<Y;$++){const te=F[$];if(A(te,$,H)===!0){const G=te.__offset,Q=Array.isArray(te.value)?te.value:[te.value];let he=0;for(let pe=0;pe<Q.length;pe++){const ye=Q[pe],fe=L(ye);typeof ye=="number"?(te.__data[0]=ye,n.bufferSubData(n.UNIFORM_BUFFER,G+he,te.__data)):ye.isMatrix3?(te.__data[0]=ye.elements[0],te.__data[1]=ye.elements[1],te.__data[2]=ye.elements[2],te.__data[3]=ye.elements[0],te.__data[4]=ye.elements[3],te.__data[5]=ye.elements[4],te.__data[6]=ye.elements[5],te.__data[7]=ye.elements[0],te.__data[8]=ye.elements[6],te.__data[9]=ye.elements[7],te.__data[10]=ye.elements[8],te.__data[11]=ye.elements[0]):(ye.toArray(te.__data,he),he+=fe.storage/Float32Array.BYTES_PER_ELEMENT)}n.bufferSubData(n.UNIFORM_BUFFER,G,te.__data)}}n.bindBuffer(n.UNIFORM_BUFFER,null)}function A(z,O,F){const H=z.value;if(F[O]===void 0){if(typeof H=="number")F[O]=H;else{const $=Array.isArray(H)?H:[H],Y=[];for(let te=0;te<$.length;te++)Y.push($[te].clone());F[O]=Y}return!0}else if(typeof H=="number"){if(F[O]!==H)return F[O]=H,!0}else{const $=Array.isArray(F[O])?F[O]:[F[O]],Y=Array.isArray(H)?H:[H];for(let te=0;te<$.length;te++){const G=$[te];if(G.equals(Y[te])===!1)return G.copy(Y[te]),!0}}return!1}function P(z){const O=z.uniforms;let F=0;const H=16;let $=0;for(let Y=0,te=O.length;Y<te;Y++){const G=O[Y],Q={boundary:0,storage:0},he=Array.isArray(G.value)?G.value:[G.value];for(let pe=0,ye=he.length;pe<ye;pe++){const fe=he[pe],Ae=L(fe);Q.boundary+=Ae.boundary,Q.storage+=Ae.storage}if(G.__data=new Float32Array(Q.storage/Float32Array.BYTES_PER_ELEMENT),G.__offset=F,Y>0){$=F%H;const pe=H-$;$!==0&&pe-Q.boundary<0&&(F+=H-$,G.__offset=F)}F+=Q.storage}return $=F%H,$>0&&(F+=H-$),z.__size=F,z.__cache={},this}function L(z){const O={boundary:0,storage:0};return typeof z=="number"?(O.boundary=4,O.storage=4):z.isVector2?(O.boundary=8,O.storage=8):z.isVector3||z.isColor?(O.boundary=16,O.storage=12):z.isVector4?(O.boundary=16,O.storage=16):z.isMatrix3?(O.boundary=48,O.storage=48):z.isMatrix4?(O.boundary=64,O.storage=64):z.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",z),O}function k(z){const O=z.target;O.removeEventListener("dispose",k);const F=d.indexOf(O.__bindingPointIndex);d.splice(F,1),n.deleteBuffer(s[O.id]),delete s[O.id],delete l[O.id]}function R(){for(const z in s)n.deleteBuffer(s[z]);d=[],s={},l={}}return{bind:p,update:y,dispose:R}}class Cz{constructor(e={}){const{canvas:i=IZ(),context:a=null,depth:s=!0,stencil:l=!0,alpha:d=!1,antialias:f=!1,premultipliedAlpha:p=!0,preserveDrawingBuffer:y=!1,powerPreference:_="default",failIfMajorPerformanceCaveat:b=!1}=e;this.isWebGLRenderer=!0;let S;a!==null?S=a.getContextAttributes().alpha:S=d;const A=new Uint32Array(4),P=new Int32Array(4);let L=null,k=null;const R=[],z=[];this.domElement=i,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this._outputColorSpace=Lo,this._useLegacyLights=!1,this.toneMapping=bd,this.toneMappingExposure=1;const O=this;let F=!1,H=0,$=0,Y=null,te=-1,G=null;const Q=new Lr,he=new Lr;let pe=null;const ye=new In(0);let fe=0,Ae=i.width,Re=i.height,Be=1,le=null,me=null;const we=new Lr(0,0,Ae,Re),re=new Lr(0,0,Ae,Re);let Te=!1;const Je=new QA;let Xe=!1,Ze=!1,Fe=null;const ct=new Di,At=new tn,kt=new We,Kt={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function Et(){return Y===null?Be:1}let Ie=a;function pt(ke,xt){for(let zt=0;zt<ke.length;zt++){const Rt=ke[zt],Nt=i.getContext(Rt,xt);if(Nt!==null)return Nt}return null}try{const ke={alpha:!0,depth:s,stencil:l,antialias:f,premultipliedAlpha:p,preserveDrawingBuffer:y,powerPreference:_,failIfMajorPerformanceCaveat:b};if("setAttribute"in i&&i.setAttribute("data-engine",`three.js r${$A}`),i.addEventListener("webglcontextlost",fn,!1),i.addEventListener("webglcontextrestored",be,!1),i.addEventListener("webglcontextcreationerror",Qe,!1),Ie===null){const xt=["webgl2","webgl","experimental-webgl"];if(O.isWebGL1Renderer===!0&&xt.shift(),Ie=pt(xt,ke),Ie===null)throw pt(xt)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}typeof WebGLRenderingContext<"u"&&Ie instanceof WebGLRenderingContext&&console.warn("THREE.WebGLRenderer: WebGL 1 support was deprecated in r153 and will be removed in r163."),Ie.getShaderPrecisionFormat===void 0&&(Ie.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(ke){throw console.error("THREE.WebGLRenderer: "+ke.message),ke}let gt,_t,Ue,ue,se,xe,Ye,ze,st,de,ie,Oe,ut,it,lt,Mt,Ut,Wt,Ht,Dt,wt,Xt,$e,Pt;function qt(){gt=new M2e(Ie),_t=new _2e(Ie,gt,e),gt.init(_t),Xt=new WZ(Ie,gt,_t),Ue=new aEe(Ie,gt,_t),ue=new C2e(Ie),se=new Y3e,xe=new oEe(Ie,gt,Ue,se,_t,Xt,ue),Ye=new b2e(O),ze=new E2e(O),st=new Fbe(Ie,_t),$e=new y2e(Ie,gt,st,_t),de=new T2e(Ie,st,ue,$e),ie=new L2e(Ie,de,st,ue),Ht=new R2e(Ie,_t,xe),Mt=new x2e(se),Oe=new $3e(O,Ye,ze,gt,_t,$e,Mt),ut=new cEe(O,se),it=new X3e,lt=new tEe(gt,_t),Wt=new g2e(O,Ye,ze,Ue,ie,S,p),Ut=new rEe(O,ie,_t),Pt=new uEe(Ie,ue,_t,Ue),Dt=new v2e(Ie,gt,ue,_t),wt=new A2e(Ie,gt,ue,_t),ue.programs=Oe.programs,O.capabilities=_t,O.extensions=gt,O.properties=se,O.renderLists=it,O.shadowMap=Ut,O.state=Ue,O.info=ue}qt();const Ot=new lEe(O,Ie);this.xr=Ot,this.getContext=function(){return Ie},this.getContextAttributes=function(){return Ie.getContextAttributes()},this.forceContextLoss=function(){const ke=gt.get("WEBGL_lose_context");ke&&ke.loseContext()},this.forceContextRestore=function(){const ke=gt.get("WEBGL_lose_context");ke&&ke.restoreContext()},this.getPixelRatio=function(){return Be},this.setPixelRatio=function(ke){ke!==void 0&&(Be=ke,this.setSize(Ae,Re,!1))},this.getSize=function(ke){return ke.set(Ae,Re)},this.setSize=function(ke,xt,zt=!0){if(Ot.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}Ae=ke,Re=xt,i.width=Math.floor(ke*Be),i.height=Math.floor(xt*Be),zt===!0&&(i.style.width=ke+"px",i.style.height=xt+"px"),this.setViewport(0,0,ke,xt)},this.getDrawingBufferSize=function(ke){return ke.set(Ae*Be,Re*Be).floor()},this.setDrawingBufferSize=function(ke,xt,zt){Ae=ke,Re=xt,Be=zt,i.width=Math.floor(ke*zt),i.height=Math.floor(xt*zt),this.setViewport(0,0,ke,xt)},this.getCurrentViewport=function(ke){return ke.copy(Q)},this.getViewport=function(ke){return ke.copy(we)},this.setViewport=function(ke,xt,zt,Rt){ke.isVector4?we.set(ke.x,ke.y,ke.z,ke.w):we.set(ke,xt,zt,Rt),Ue.viewport(Q.copy(we).multiplyScalar(Be).floor())},this.getScissor=function(ke){return ke.copy(re)},this.setScissor=function(ke,xt,zt,Rt){ke.isVector4?re.set(ke.x,ke.y,ke.z,ke.w):re.set(ke,xt,zt,Rt),Ue.scissor(he.copy(re).multiplyScalar(Be).floor())},this.getScissorTest=function(){return Te},this.setScissorTest=function(ke){Ue.setScissorTest(Te=ke)},this.setOpaqueSort=function(ke){le=ke},this.setTransparentSort=function(ke){me=ke},this.getClearColor=function(ke){return ke.copy(Wt.getClearColor())},this.setClearColor=function(){Wt.setClearColor.apply(Wt,arguments)},this.getClearAlpha=function(){return Wt.getClearAlpha()},this.setClearAlpha=function(){Wt.setClearAlpha.apply(Wt,arguments)},this.clear=function(ke=!0,xt=!0,zt=!0){let Rt=0;if(ke){let Nt=!1;if(Y!==null){const jt=Y.texture.format;Nt=jt===yz||jt===gz||jt===mz}if(Nt){const jt=Y.texture.type,yn=jt===wd||jt===zh||jt===XA||jt===vp||jt===fz||jt===pz,Zn=Wt.getClearColor(),on=Wt.getClearAlpha(),pi=Zn.r,_i=Zn.g,ui=Zn.b;yn?(A[0]=pi,A[1]=_i,A[2]=ui,A[3]=on,Ie.clearBufferuiv(Ie.COLOR,0,A)):(P[0]=pi,P[1]=_i,P[2]=ui,P[3]=on,Ie.clearBufferiv(Ie.COLOR,0,P))}else Rt|=Ie.COLOR_BUFFER_BIT}xt&&(Rt|=Ie.DEPTH_BUFFER_BIT),zt&&(Rt|=Ie.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),Ie.clear(Rt)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){i.removeEventListener("webglcontextlost",fn,!1),i.removeEventListener("webglcontextrestored",be,!1),i.removeEventListener("webglcontextcreationerror",Qe,!1),it.dispose(),lt.dispose(),se.dispose(),Ye.dispose(),ze.dispose(),ie.dispose(),$e.dispose(),Pt.dispose(),Oe.dispose(),Ot.dispose(),Ot.removeEventListener("sessionstart",ht),Ot.removeEventListener("sessionend",dt),Fe&&(Fe.dispose(),Fe=null),Vt.stop()};function fn(ke){ke.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),F=!0}function be(){console.log("THREE.WebGLRenderer: Context Restored."),F=!1;const ke=ue.autoReset,xt=Ut.enabled,zt=Ut.autoUpdate,Rt=Ut.needsUpdate,Nt=Ut.type;qt(),ue.autoReset=ke,Ut.enabled=xt,Ut.autoUpdate=zt,Ut.needsUpdate=Rt,Ut.type=Nt}function Qe(ke){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",ke.statusMessage)}function Se(ke){const xt=ke.target;xt.removeEventListener("dispose",Se),Ce(xt)}function Ce(ke){Ne(ke),se.remove(ke)}function Ne(ke){const xt=se.get(ke).programs;xt!==void 0&&(xt.forEach(function(zt){Oe.releaseProgram(zt)}),ke.isShaderMaterial&&Oe.releaseShaderCache(ke))}this.renderBufferDirect=function(ke,xt,zt,Rt,Nt,jt){xt===null&&(xt=Kt);const yn=Nt.isMesh&&Nt.matrixWorld.determinant()<0,Zn=Mi(ke,xt,zt,Rt,Nt);Ue.setMaterial(Rt,yn);let on=zt.index,pi=1;if(Rt.wireframe===!0){if(on=de.getWireframeAttribute(zt),on===void 0)return;pi=2}const _i=zt.drawRange,ui=zt.attributes.position;let cr=_i.start*pi,Ea=(_i.start+_i.count)*pi;jt!==null&&(cr=Math.max(cr,jt.start*pi),Ea=Math.min(Ea,(jt.start+jt.count)*pi)),on!==null?(cr=Math.max(cr,0),Ea=Math.min(Ea,on.count)):ui!=null&&(cr=Math.max(cr,0),Ea=Math.min(Ea,ui.count));const lr=Ea-cr;if(lr<0||lr===1/0)return;$e.setup(Nt,Rt,Zn,zt,on);let ea,si=Dt;if(on!==null&&(ea=st.get(on),si=wt,si.setIndex(ea)),Nt.isMesh)Rt.wireframe===!0?(Ue.setLineWidth(Rt.wireframeLinewidth*Et()),si.setMode(Ie.LINES)):si.setMode(Ie.TRIANGLES);else if(Nt.isLine){let Dn=Rt.linewidth;Dn===void 0&&(Dn=1),Ue.setLineWidth(Dn*Et()),Nt.isLineSegments?si.setMode(Ie.LINES):Nt.isLineLoop?si.setMode(Ie.LINE_LOOP):si.setMode(Ie.LINE_STRIP)}else Nt.isPoints?si.setMode(Ie.POINTS):Nt.isSprite&&si.setMode(Ie.TRIANGLES);if(Nt.isInstancedMesh)si.renderInstances(cr,lr,Nt.count);else if(zt.isInstancedBufferGeometry){const Dn=zt._maxInstanceCount!==void 0?zt._maxInstanceCount:1/0,fo=Math.min(zt.instanceCount,Dn);si.renderInstances(cr,lr,fo)}else si.render(cr,lr)};function et(ke,xt,zt){ke.transparent===!0&&ke.side===Xl&&ke.forceSinglePass===!1?(ke.side=Ts,ke.needsUpdate=!0,Hn(ke,xt,zt),ke.side=Ad,ke.needsUpdate=!0,Hn(ke,xt,zt),ke.side=Xl):Hn(ke,xt,zt)}this.compile=function(ke,xt,zt=null){zt===null&&(zt=ke),k=lt.get(zt),k.init(),z.push(k),zt.traverseVisible(function(Nt){Nt.isLight&&Nt.layers.test(xt.layers)&&(k.pushLight(Nt),Nt.castShadow&&k.pushShadow(Nt))}),ke!==zt&&ke.traverseVisible(function(Nt){Nt.isLight&&Nt.layers.test(xt.layers)&&(k.pushLight(Nt),Nt.castShadow&&k.pushShadow(Nt))}),k.setupLights(O._useLegacyLights);const Rt=new Set;return ke.traverse(function(Nt){const jt=Nt.material;if(jt)if(Array.isArray(jt))for(let yn=0;yn<jt.length;yn++){const Zn=jt[yn];et(Zn,zt,Nt),Rt.add(Zn)}else et(jt,zt,Nt),Rt.add(jt)}),z.pop(),k=null,Rt},this.compileAsync=function(ke,xt,zt=null){const Rt=this.compile(ke,xt,zt);return new Promise(Nt=>{function jt(){if(Rt.forEach(function(yn){se.get(yn).currentProgram.isReady()&&Rt.delete(yn)}),Rt.size===0){Nt(ke);return}setTimeout(jt,10)}gt.get("KHR_parallel_shader_compile")!==null?jt():setTimeout(jt,10)})};let tt=null;function vt(ke){tt&&tt(ke)}function ht(){Vt.stop()}function dt(){Vt.start()}const Vt=new OZ;Vt.setAnimationLoop(vt),typeof self<"u"&&Vt.setContext(self),this.setAnimationLoop=function(ke){tt=ke,Ot.setAnimationLoop(ke),ke===null?Vt.stop():Vt.start()},Ot.addEventListener("sessionstart",ht),Ot.addEventListener("sessionend",dt),this.render=function(ke,xt){if(xt!==void 0&&xt.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(F===!0)return;ke.matrixWorldAutoUpdate===!0&&ke.updateMatrixWorld(),xt.parent===null&&xt.matrixWorldAutoUpdate===!0&&xt.updateMatrixWorld(),Ot.enabled===!0&&Ot.isPresenting===!0&&(Ot.cameraAutoUpdate===!0&&Ot.updateCamera(xt),xt=Ot.getCamera()),ke.isScene===!0&&ke.onBeforeRender(O,ke,xt,Y),k=lt.get(ke,z.length),k.init(),z.push(k),ct.multiplyMatrices(xt.projectionMatrix,xt.matrixWorldInverse),Je.setFromProjectionMatrix(ct),Ze=this.localClippingEnabled,Xe=Mt.init(this.clippingPlanes,Ze),L=it.get(ke,R.length),L.init(),R.push(L),It(ke,xt,0,O.sortObjects),L.finish(),O.sortObjects===!0&&L.sort(le,me),this.info.render.frame++,Xe===!0&&Mt.beginShadows();const zt=k.state.shadowsArray;if(Ut.render(zt,ke,xt),Xe===!0&&Mt.endShadows(),this.info.autoReset===!0&&this.info.reset(),Wt.render(L,ke),k.setupLights(O._useLegacyLights),xt.isArrayCamera){const Rt=xt.cameras;for(let Nt=0,jt=Rt.length;Nt<jt;Nt++){const yn=Rt[Nt];Qt(L,ke,yn,yn.viewport)}}else Qt(L,ke,xt);Y!==null&&(xe.updateMultisampleRenderTarget(Y),xe.updateRenderTargetMipmap(Y)),ke.isScene===!0&&ke.onAfterRender(O,ke,xt),$e.resetDefaultState(),te=-1,G=null,z.pop(),z.length>0?k=z[z.length-1]:k=null,R.pop(),R.length>0?L=R[R.length-1]:L=null};function It(ke,xt,zt,Rt){if(ke.visible===!1)return;if(ke.layers.test(xt.layers)){if(ke.isGroup)zt=ke.renderOrder;else if(ke.isLOD)ke.autoUpdate===!0&&ke.update(xt);else if(ke.isLight)k.pushLight(ke),ke.castShadow&&k.pushShadow(ke);else if(ke.isSprite){if(!ke.frustumCulled||Je.intersectsSprite(ke)){Rt&&kt.setFromMatrixPosition(ke.matrixWorld).applyMatrix4(ct);const yn=ie.update(ke),Zn=ke.material;Zn.visible&&L.push(ke,yn,Zn,zt,kt.z,null)}}else if((ke.isMesh||ke.isLine||ke.isPoints)&&(!ke.frustumCulled||Je.intersectsObject(ke))){const yn=ie.update(ke),Zn=ke.material;if(Rt&&(ke.boundingSphere!==void 0?(ke.boundingSphere===null&&ke.computeBoundingSphere(),kt.copy(ke.boundingSphere.center)):(yn.boundingSphere===null&&yn.computeBoundingSphere(),kt.copy(yn.boundingSphere.center)),kt.applyMatrix4(ke.matrixWorld).applyMatrix4(ct)),Array.isArray(Zn)){const on=yn.groups;for(let pi=0,_i=on.length;pi<_i;pi++){const ui=on[pi],cr=Zn[ui.materialIndex];cr&&cr.visible&&L.push(ke,yn,cr,zt,kt.z,ui)}}else Zn.visible&&L.push(ke,yn,Zn,zt,kt.z,null)}}const jt=ke.children;for(let yn=0,Zn=jt.length;yn<Zn;yn++)It(jt[yn],xt,zt,Rt)}function Qt(ke,xt,zt,Rt){const Nt=ke.opaque,jt=ke.transmissive,yn=ke.transparent;k.setupLightsView(zt),Xe===!0&&Mt.setGlobalState(O.clippingPlanes,zt),jt.length>0&&mn(Nt,jt,xt,zt),Rt&&Ue.viewport(Q.copy(Rt)),Nt.length>0&&en(Nt,xt,zt),jt.length>0&&en(jt,xt,zt),yn.length>0&&en(yn,xt,zt),Ue.buffers.depth.setTest(!0),Ue.buffers.depth.setMask(!0),Ue.buffers.color.setMask(!0),Ue.setPolygonOffset(!1)}function mn(ke,xt,zt,Rt){if((zt.isScene===!0?zt.overrideMaterial:null)!==null)return;const jt=_t.isWebGL2;Fe===null&&(Fe=new wu(1,1,{generateMipmaps:!0,type:gt.has("EXT_color_buffer_half_float")?v_:wd,minFilter:Cp,samples:jt?4:0})),O.getDrawingBufferSize(At),jt?Fe.setSize(At.x,At.y):Fe.setSize(yT(At.x),yT(At.y));const yn=O.getRenderTarget();O.setRenderTarget(Fe),O.getClearColor(ye),fe=O.getClearAlpha(),fe<1&&O.setClearColor(16777215,.5),O.clear();const Zn=O.toneMapping;O.toneMapping=bd,en(ke,zt,Rt),xe.updateMultisampleRenderTarget(Fe),xe.updateRenderTargetMipmap(Fe);let on=!1;for(let pi=0,_i=xt.length;pi<_i;pi++){const ui=xt[pi],cr=ui.object,Ea=ui.geometry,lr=ui.material,ea=ui.group;if(lr.side===Xl&&cr.layers.test(Rt.layers)){const si=lr.side;lr.side=Ts,lr.needsUpdate=!0,_n(cr,zt,Rt,Ea,lr,ea),lr.side=si,lr.needsUpdate=!0,on=!0}}on===!0&&(xe.updateMultisampleRenderTarget(Fe),xe.updateRenderTargetMipmap(Fe)),O.setRenderTarget(yn),O.setClearColor(ye,fe),O.toneMapping=Zn}function en(ke,xt,zt){const Rt=xt.isScene===!0?xt.overrideMaterial:null;for(let Nt=0,jt=ke.length;Nt<jt;Nt++){const yn=ke[Nt],Zn=yn.object,on=yn.geometry,pi=Rt===null?yn.material:Rt,_i=yn.group;Zn.layers.test(zt.layers)&&_n(Zn,xt,zt,on,pi,_i)}}function _n(ke,xt,zt,Rt,Nt,jt){ke.onBeforeRender(O,xt,zt,Rt,Nt,jt),ke.modelViewMatrix.multiplyMatrices(zt.matrixWorldInverse,ke.matrixWorld),ke.normalMatrix.getNormalMatrix(ke.modelViewMatrix),Nt.onBeforeRender(O,xt,zt,Rt,ke,jt),Nt.transparent===!0&&Nt.side===Xl&&Nt.forceSinglePass===!1?(Nt.side=Ts,Nt.needsUpdate=!0,O.renderBufferDirect(zt,xt,Rt,Nt,ke,jt),Nt.side=Ad,Nt.needsUpdate=!0,O.renderBufferDirect(zt,xt,Rt,Nt,ke,jt),Nt.side=Xl):O.renderBufferDirect(zt,xt,Rt,Nt,ke,jt),ke.onAfterRender(O,xt,zt,Rt,Nt,jt)}function Hn(ke,xt,zt){xt.isScene!==!0&&(xt=Kt);const Rt=se.get(ke),Nt=k.state.lights,jt=k.state.shadowsArray,yn=Nt.state.version,Zn=Oe.getParameters(ke,Nt.state,jt,xt,zt),on=Oe.getProgramCacheKey(Zn);let pi=Rt.programs;Rt.environment=ke.isMeshStandardMaterial?xt.environment:null,Rt.fog=xt.fog,Rt.envMap=(ke.isMeshStandardMaterial?ze:Ye).get(ke.envMap||Rt.environment),pi===void 0&&(ke.addEventListener("dispose",Se),pi=new Map,Rt.programs=pi);let _i=pi.get(on);if(_i!==void 0){if(Rt.currentProgram===_i&&Rt.lightsStateVersion===yn)return Ei(ke,Zn),_i}else Zn.uniforms=Oe.getUniforms(ke),ke.onBuild(zt,Zn,O),ke.onBeforeCompile(Zn,O),_i=Oe.acquireProgram(Zn,on),pi.set(on,_i),Rt.uniforms=Zn.uniforms;const ui=Rt.uniforms;return(!ke.isShaderMaterial&&!ke.isRawShaderMaterial||ke.clipping===!0)&&(ui.clippingPlanes=Mt.uniform),Ei(ke,Zn),Rt.needsLights=sr(ke),Rt.lightsStateVersion=yn,Rt.needsLights&&(ui.ambientLightColor.value=Nt.state.ambient,ui.lightProbe.value=Nt.state.probe,ui.directionalLights.value=Nt.state.directional,ui.directionalLightShadows.value=Nt.state.directionalShadow,ui.spotLights.value=Nt.state.spot,ui.spotLightShadows.value=Nt.state.spotShadow,ui.rectAreaLights.value=Nt.state.rectArea,ui.ltc_1.value=Nt.state.rectAreaLTC1,ui.ltc_2.value=Nt.state.rectAreaLTC2,ui.pointLights.value=Nt.state.point,ui.pointLightShadows.value=Nt.state.pointShadow,ui.hemisphereLights.value=Nt.state.hemi,ui.directionalShadowMap.value=Nt.state.directionalShadowMap,ui.directionalShadowMatrix.value=Nt.state.directionalShadowMatrix,ui.spotShadowMap.value=Nt.state.spotShadowMap,ui.spotLightMatrix.value=Nt.state.spotLightMatrix,ui.spotLightMap.value=Nt.state.spotLightMap,ui.pointShadowMap.value=Nt.state.pointShadowMap,ui.pointShadowMatrix.value=Nt.state.pointShadowMatrix),Rt.currentProgram=_i,Rt.uniformsList=null,_i}function ni(ke){if(ke.uniformsList===null){const xt=ke.currentProgram.getUniforms();ke.uniformsList=_M.seqWithValue(xt.seq,ke.uniforms)}return ke.uniformsList}function Ei(ke,xt){const zt=se.get(ke);zt.outputColorSpace=xt.outputColorSpace,zt.instancing=xt.instancing,zt.instancingColor=xt.instancingColor,zt.skinning=xt.skinning,zt.morphTargets=xt.morphTargets,zt.morphNormals=xt.morphNormals,zt.morphColors=xt.morphColors,zt.morphTargetsCount=xt.morphTargetsCount,zt.numClippingPlanes=xt.numClippingPlanes,zt.numIntersection=xt.numClipIntersection,zt.vertexAlphas=xt.vertexAlphas,zt.vertexTangents=xt.vertexTangents,zt.toneMapping=xt.toneMapping}function Mi(ke,xt,zt,Rt,Nt){xt.isScene!==!0&&(xt=Kt),xe.resetTextureUnits();const jt=xt.fog,yn=Rt.isMeshStandardMaterial?xt.environment:null,Zn=Y===null?O.outputColorSpace:Y.isXRRenderTarget===!0?Y.texture.colorSpace:Cd,on=(Rt.isMeshStandardMaterial?ze:Ye).get(Rt.envMap||yn),pi=Rt.vertexColors===!0&&!!zt.attributes.color&&zt.attributes.color.itemSize===4,_i=!!zt.attributes.tangent&&(!!Rt.normalMap||Rt.anisotropy>0),ui=!!zt.morphAttributes.position,cr=!!zt.morphAttributes.normal,Ea=!!zt.morphAttributes.color;let lr=bd;Rt.toneMapped&&(Y===null||Y.isXRRenderTarget===!0)&&(lr=O.toneMapping);const ea=zt.morphAttributes.position||zt.morphAttributes.normal||zt.morphAttributes.color,si=ea!==void 0?ea.length:0,Dn=se.get(Rt),fo=k.state.lights;if(Xe===!0&&(Ze===!0||ke!==G)){const Qn=ke===G&&Rt.id===te;Mt.setState(Rt,ke,Qn)}let Oi=!1;Rt.version===Dn.__version?(Dn.needsLights&&Dn.lightsStateVersion!==fo.state.version||Dn.outputColorSpace!==Zn||Nt.isInstancedMesh&&Dn.instancing===!1||!Nt.isInstancedMesh&&Dn.instancing===!0||Nt.isSkinnedMesh&&Dn.skinning===!1||!Nt.isSkinnedMesh&&Dn.skinning===!0||Nt.isInstancedMesh&&Dn.instancingColor===!0&&Nt.instanceColor===null||Nt.isInstancedMesh&&Dn.instancingColor===!1&&Nt.instanceColor!==null||Dn.envMap!==on||Rt.fog===!0&&Dn.fog!==jt||Dn.numClippingPlanes!==void 0&&(Dn.numClippingPlanes!==Mt.numPlanes||Dn.numIntersection!==Mt.numIntersection)||Dn.vertexAlphas!==pi||Dn.vertexTangents!==_i||Dn.morphTargets!==ui||Dn.morphNormals!==cr||Dn.morphColors!==Ea||Dn.toneMapping!==lr||_t.isWebGL2===!0&&Dn.morphTargetsCount!==si)&&(Oi=!0):(Oi=!0,Dn.__version=Rt.version);let kr=Dn.currentProgram;Oi===!0&&(kr=Hn(Rt,xt,Nt));let Yo=!1,Ma=!1,ta=!1;const yr=kr.getUniforms(),Fa=Dn.uniforms;if(Ue.useProgram(kr.program)&&(Yo=!0,Ma=!0,ta=!0),Rt.id!==te&&(te=Rt.id,Ma=!0),Yo||G!==ke){yr.setValue(Ie,"projectionMatrix",ke.projectionMatrix),yr.setValue(Ie,"viewMatrix",ke.matrixWorldInverse);const Qn=yr.map.cameraPosition;Qn!==void 0&&Qn.setValue(Ie,kt.setFromMatrixPosition(ke.matrixWorld)),_t.logarithmicDepthBuffer&&yr.setValue(Ie,"logDepthBufFC",2/(Math.log(ke.far+1)/Math.LN2)),(Rt.isMeshPhongMaterial||Rt.isMeshToonMaterial||Rt.isMeshLambertMaterial||Rt.isMeshBasicMaterial||Rt.isMeshStandardMaterial||Rt.isShaderMaterial)&&yr.setValue(Ie,"isOrthographic",ke.isOrthographicCamera===!0),G!==ke&&(G=ke,Ma=!0,ta=!0)}if(Nt.isSkinnedMesh){yr.setOptional(Ie,Nt,"bindMatrix"),yr.setOptional(Ie,Nt,"bindMatrixInverse");const Qn=Nt.skeleton;Qn&&(_t.floatVertexTextures?(Qn.boneTexture===null&&Qn.computeBoneTexture(),yr.setValue(Ie,"boneTexture",Qn.boneTexture,xe),yr.setValue(Ie,"boneTextureSize",Qn.boneTextureSize)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}const Pn=zt.morphAttributes;if((Pn.position!==void 0||Pn.normal!==void 0||Pn.color!==void 0&&_t.isWebGL2===!0)&&Ht.update(Nt,zt,kr),(Ma||Dn.receiveShadow!==Nt.receiveShadow)&&(Dn.receiveShadow=Nt.receiveShadow,yr.setValue(Ie,"receiveShadow",Nt.receiveShadow)),Rt.isMeshGouraudMaterial&&Rt.envMap!==null&&(Fa.envMap.value=on,Fa.flipEnvMap.value=on.isCubeTexture&&on.isRenderTargetTexture===!1?-1:1),Ma&&(yr.setValue(Ie,"toneMappingExposure",O.toneMappingExposure),Dn.needsLights&&gr(Fa,ta),jt&&Rt.fog===!0&&ut.refreshFogUniforms(Fa,jt),ut.refreshMaterialUniforms(Fa,Rt,Be,Re,Fe),_M.upload(Ie,ni(Dn),Fa,xe)),Rt.isShaderMaterial&&Rt.uniformsNeedUpdate===!0&&(_M.upload(Ie,ni(Dn),Fa,xe),Rt.uniformsNeedUpdate=!1),Rt.isSpriteMaterial&&yr.setValue(Ie,"center",Nt.center),yr.setValue(Ie,"modelViewMatrix",Nt.modelViewMatrix),yr.setValue(Ie,"normalMatrix",Nt.normalMatrix),yr.setValue(Ie,"modelMatrix",Nt.matrixWorld),Rt.isShaderMaterial||Rt.isRawShaderMaterial){const Qn=Rt.uniformsGroups;for(let qr=0,Ta=Qn.length;qr<Ta;qr++)if(_t.isWebGL2){const Is=Qn[qr];Pt.update(Is,kr),Pt.bind(Is,kr)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return kr}function gr(ke,xt){ke.ambientLightColor.needsUpdate=xt,ke.lightProbe.needsUpdate=xt,ke.directionalLights.needsUpdate=xt,ke.directionalLightShadows.needsUpdate=xt,ke.pointLights.needsUpdate=xt,ke.pointLightShadows.needsUpdate=xt,ke.spotLights.needsUpdate=xt,ke.spotLightShadows.needsUpdate=xt,ke.rectAreaLights.needsUpdate=xt,ke.hemisphereLights.needsUpdate=xt}function sr(ke){return ke.isMeshLambertMaterial||ke.isMeshToonMaterial||ke.isMeshPhongMaterial||ke.isMeshStandardMaterial||ke.isShadowMaterial||ke.isShaderMaterial&&ke.lights===!0}this.getActiveCubeFace=function(){return H},this.getActiveMipmapLevel=function(){return $},this.getRenderTarget=function(){return Y},this.setRenderTargetTextures=function(ke,xt,zt){se.get(ke.texture).__webglTexture=xt,se.get(ke.depthTexture).__webglTexture=zt;const Rt=se.get(ke);Rt.__hasExternalTextures=!0,Rt.__hasExternalTextures&&(Rt.__autoAllocateDepthBuffer=zt===void 0,Rt.__autoAllocateDepthBuffer||gt.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),Rt.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(ke,xt){const zt=se.get(ke);zt.__webglFramebuffer=xt,zt.__useDefaultFramebuffer=xt===void 0},this.setRenderTarget=function(ke,xt=0,zt=0){Y=ke,H=xt,$=zt;let Rt=!0,Nt=null,jt=!1,yn=!1;if(ke){const on=se.get(ke);on.__useDefaultFramebuffer!==void 0?(Ue.bindFramebuffer(Ie.FRAMEBUFFER,null),Rt=!1):on.__webglFramebuffer===void 0?xe.setupRenderTarget(ke):on.__hasExternalTextures&&xe.rebindTextures(ke,se.get(ke.texture).__webglTexture,se.get(ke.depthTexture).__webglTexture);const pi=ke.texture;(pi.isData3DTexture||pi.isDataArrayTexture||pi.isCompressedArrayTexture)&&(yn=!0);const _i=se.get(ke).__webglFramebuffer;ke.isWebGLCubeRenderTarget?(Array.isArray(_i[xt])?Nt=_i[xt][zt]:Nt=_i[xt],jt=!0):_t.isWebGL2&&ke.samples>0&&xe.useMultisampledRTT(ke)===!1?Nt=se.get(ke).__webglMultisampledFramebuffer:Array.isArray(_i)?Nt=_i[zt]:Nt=_i,Q.copy(ke.viewport),he.copy(ke.scissor),pe=ke.scissorTest}else Q.copy(we).multiplyScalar(Be).floor(),he.copy(re).multiplyScalar(Be).floor(),pe=Te;if(Ue.bindFramebuffer(Ie.FRAMEBUFFER,Nt)&&_t.drawBuffers&&Rt&&Ue.drawBuffers(ke,Nt),Ue.viewport(Q),Ue.scissor(he),Ue.setScissorTest(pe),jt){const on=se.get(ke.texture);Ie.framebufferTexture2D(Ie.FRAMEBUFFER,Ie.COLOR_ATTACHMENT0,Ie.TEXTURE_CUBE_MAP_POSITIVE_X+xt,on.__webglTexture,zt)}else if(yn){const on=se.get(ke.texture),pi=xt||0;Ie.framebufferTextureLayer(Ie.FRAMEBUFFER,Ie.COLOR_ATTACHMENT0,on.__webglTexture,zt||0,pi)}te=-1},this.readRenderTargetPixels=function(ke,xt,zt,Rt,Nt,jt,yn){if(!(ke&&ke.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let Zn=se.get(ke).__webglFramebuffer;if(ke.isWebGLCubeRenderTarget&&yn!==void 0&&(Zn=Zn[yn]),Zn){Ue.bindFramebuffer(Ie.FRAMEBUFFER,Zn);try{const on=ke.texture,pi=on.format,_i=on.type;if(pi!==vl&&Xt.convert(pi)!==Ie.getParameter(Ie.IMPLEMENTATION_COLOR_READ_FORMAT)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}const ui=_i===v_&&(gt.has("EXT_color_buffer_half_float")||_t.isWebGL2&&gt.has("EXT_color_buffer_float"));if(_i!==wd&&Xt.convert(_i)!==Ie.getParameter(Ie.IMPLEMENTATION_COLOR_READ_TYPE)&&!(_i===md&&(_t.isWebGL2||gt.has("OES_texture_float")||gt.has("WEBGL_color_buffer_float")))&&!ui){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}xt>=0&&xt<=ke.width-Rt&&zt>=0&&zt<=ke.height-Nt&&Ie.readPixels(xt,zt,Rt,Nt,Xt.convert(pi),Xt.convert(_i),jt)}finally{const on=Y!==null?se.get(Y).__webglFramebuffer:null;Ue.bindFramebuffer(Ie.FRAMEBUFFER,on)}}},this.copyFramebufferToTexture=function(ke,xt,zt=0){const Rt=Math.pow(2,-zt),Nt=Math.floor(xt.image.width*Rt),jt=Math.floor(xt.image.height*Rt);xe.setTexture2D(xt,0),Ie.copyTexSubImage2D(Ie.TEXTURE_2D,zt,0,0,ke.x,ke.y,Nt,jt),Ue.unbindTexture()},this.copyTextureToTexture=function(ke,xt,zt,Rt=0){const Nt=xt.image.width,jt=xt.image.height,yn=Xt.convert(zt.format),Zn=Xt.convert(zt.type);xe.setTexture2D(zt,0),Ie.pixelStorei(Ie.UNPACK_FLIP_Y_WEBGL,zt.flipY),Ie.pixelStorei(Ie.UNPACK_PREMULTIPLY_ALPHA_WEBGL,zt.premultiplyAlpha),Ie.pixelStorei(Ie.UNPACK_ALIGNMENT,zt.unpackAlignment),xt.isDataTexture?Ie.texSubImage2D(Ie.TEXTURE_2D,Rt,ke.x,ke.y,Nt,jt,yn,Zn,xt.image.data):xt.isCompressedTexture?Ie.compressedTexSubImage2D(Ie.TEXTURE_2D,Rt,ke.x,ke.y,xt.mipmaps[0].width,xt.mipmaps[0].height,yn,xt.mipmaps[0].data):Ie.texSubImage2D(Ie.TEXTURE_2D,Rt,ke.x,ke.y,yn,Zn,xt.image),Rt===0&&zt.generateMipmaps&&Ie.generateMipmap(Ie.TEXTURE_2D),Ue.unbindTexture()},this.copyTextureToTexture3D=function(ke,xt,zt,Rt,Nt=0){if(O.isWebGL1Renderer){console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");return}const jt=ke.max.x-ke.min.x+1,yn=ke.max.y-ke.min.y+1,Zn=ke.max.z-ke.min.z+1,on=Xt.convert(Rt.format),pi=Xt.convert(Rt.type);let _i;if(Rt.isData3DTexture)xe.setTexture3D(Rt,0),_i=Ie.TEXTURE_3D;else if(Rt.isDataArrayTexture)xe.setTexture2DArray(Rt,0),_i=Ie.TEXTURE_2D_ARRAY;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}Ie.pixelStorei(Ie.UNPACK_FLIP_Y_WEBGL,Rt.flipY),Ie.pixelStorei(Ie.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Rt.premultiplyAlpha),Ie.pixelStorei(Ie.UNPACK_ALIGNMENT,Rt.unpackAlignment);const ui=Ie.getParameter(Ie.UNPACK_ROW_LENGTH),cr=Ie.getParameter(Ie.UNPACK_IMAGE_HEIGHT),Ea=Ie.getParameter(Ie.UNPACK_SKIP_PIXELS),lr=Ie.getParameter(Ie.UNPACK_SKIP_ROWS),ea=Ie.getParameter(Ie.UNPACK_SKIP_IMAGES),si=zt.isCompressedTexture?zt.mipmaps[0]:zt.image;Ie.pixelStorei(Ie.UNPACK_ROW_LENGTH,si.width),Ie.pixelStorei(Ie.UNPACK_IMAGE_HEIGHT,si.height),Ie.pixelStorei(Ie.UNPACK_SKIP_PIXELS,ke.min.x),Ie.pixelStorei(Ie.UNPACK_SKIP_ROWS,ke.min.y),Ie.pixelStorei(Ie.UNPACK_SKIP_IMAGES,ke.min.z),zt.isDataTexture||zt.isData3DTexture?Ie.texSubImage3D(_i,Nt,xt.x,xt.y,xt.z,jt,yn,Zn,on,pi,si.data):zt.isCompressedArrayTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),Ie.compressedTexSubImage3D(_i,Nt,xt.x,xt.y,xt.z,jt,yn,Zn,on,si.data)):Ie.texSubImage3D(_i,Nt,xt.x,xt.y,xt.z,jt,yn,Zn,on,pi,si),Ie.pixelStorei(Ie.UNPACK_ROW_LENGTH,ui),Ie.pixelStorei(Ie.UNPACK_IMAGE_HEIGHT,cr),Ie.pixelStorei(Ie.UNPACK_SKIP_PIXELS,Ea),Ie.pixelStorei(Ie.UNPACK_SKIP_ROWS,lr),Ie.pixelStorei(Ie.UNPACK_SKIP_IMAGES,ea),Nt===0&&Rt.generateMipmaps&&Ie.generateMipmap(_i),Ue.unbindTexture()},this.initTexture=function(ke){ke.isCubeTexture?xe.setTextureCube(ke,0):ke.isData3DTexture?xe.setTexture3D(ke,0):ke.isDataArrayTexture||ke.isCompressedArrayTexture?xe.setTexture2DArray(ke,0):xe.setTexture2D(ke,0),Ue.unbindTexture()},this.resetState=function(){H=0,$=0,Y=null,Ue.reset(),$e.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return gd}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const i=this.getContext();i.drawingBufferColorSpace=e===KA?"display-p3":"srgb",i.unpackColorSpace=Vr.workingColorSpace===eS?"display-p3":"srgb"}get physicallyCorrectLights(){return console.warn("THREE.WebGLRenderer: The property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),!this.useLegacyLights}set physicallyCorrectLights(e){console.warn("THREE.WebGLRenderer: The property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),this.useLegacyLights=!e}get outputEncoding(){return console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace===Lo?xp:_z}set outputEncoding(e){console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace=e===xp?Lo:Cd}get useLegacyLights(){return console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights}set useLegacyLights(e){console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights=e}}class HZ extends Cz{}HZ.prototype.isWebGL1Renderer=!0;class iC{constructor(e,i=25e-5){this.isFogExp2=!0,this.name="",this.color=new In(e),this.density=i}clone(){return new iC(this.color,this.density)}toJSON(){return{type:"FogExp2",name:this.name,color:this.color.getHex(),density:this.density}}}class rC{constructor(e,i=1,a=1e3){this.isFog=!0,this.name="",this.color=new In(e),this.near=i,this.far=a}clone(){return new rC(this.color,this.near,this.far)}toJSON(){return{type:"Fog",name:this.name,color:this.color.getHex(),near:this.near,far:this.far}}}class vT extends br{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,i){return super.copy(e,i),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const i=super.toJSON(e);return this.fog!==null&&(i.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(i.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(i.object.backgroundIntensity=this.backgroundIntensity),i}}class aC{constructor(e,i){this.isInterleavedBuffer=!0,this.array=e,this.stride=i,this.count=e!==void 0?e.length/i:0,this.usage=vw,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=tc()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,i,a){e*=this.stride,a*=i.stride;for(let s=0,l=this.stride;s<l;s++)this.array[e+s]=i.array[a+s];return this}set(e,i=0){return this.array.set(e,i),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=tc()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const i=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),a=new this.constructor(i,this.stride);return a.setUsage(this.usage),a}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=tc()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const Vs=new We;class $g{constructor(e,i,a,s=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=i,this.offset=a,this.normalized=s}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let i=0,a=this.data.count;i<a;i++)Vs.fromBufferAttribute(this,i),Vs.applyMatrix4(e),this.setXYZ(i,Vs.x,Vs.y,Vs.z);return this}applyNormalMatrix(e){for(let i=0,a=this.count;i<a;i++)Vs.fromBufferAttribute(this,i),Vs.applyNormalMatrix(e),this.setXYZ(i,Vs.x,Vs.y,Vs.z);return this}transformDirection(e){for(let i=0,a=this.count;i<a;i++)Vs.fromBufferAttribute(this,i),Vs.transformDirection(e),this.setXYZ(i,Vs.x,Vs.y,Vs.z);return this}setX(e,i){return this.normalized&&(i=Gi(i,this.array)),this.data.array[e*this.data.stride+this.offset]=i,this}setY(e,i){return this.normalized&&(i=Gi(i,this.array)),this.data.array[e*this.data.stride+this.offset+1]=i,this}setZ(e,i){return this.normalized&&(i=Gi(i,this.array)),this.data.array[e*this.data.stride+this.offset+2]=i,this}setW(e,i){return this.normalized&&(i=Gi(i,this.array)),this.data.array[e*this.data.stride+this.offset+3]=i,this}getX(e){let i=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(i=_l(i,this.array)),i}getY(e){let i=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(i=_l(i,this.array)),i}getZ(e){let i=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(i=_l(i,this.array)),i}getW(e){let i=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(i=_l(i,this.array)),i}setXY(e,i,a){return e=e*this.data.stride+this.offset,this.normalized&&(i=Gi(i,this.array),a=Gi(a,this.array)),this.data.array[e+0]=i,this.data.array[e+1]=a,this}setXYZ(e,i,a,s){return e=e*this.data.stride+this.offset,this.normalized&&(i=Gi(i,this.array),a=Gi(a,this.array),s=Gi(s,this.array)),this.data.array[e+0]=i,this.data.array[e+1]=a,this.data.array[e+2]=s,this}setXYZW(e,i,a,s,l){return e=e*this.data.stride+this.offset,this.normalized&&(i=Gi(i,this.array),a=Gi(a,this.array),s=Gi(s,this.array),l=Gi(l,this.array)),this.data.array[e+0]=i,this.data.array[e+1]=a,this.data.array[e+2]=s,this.data.array[e+3]=l,this}clone(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const i=[];for(let a=0;a<this.count;a++){const s=a*this.data.stride+this.offset;for(let l=0;l<this.itemSize;l++)i.push(this.data.array[s+l])}return new Qr(new this.array.constructor(i),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new $g(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const i=[];for(let a=0;a<this.count;a++){const s=a*this.data.stride+this.offset;for(let l=0;l<this.itemSize;l++)i.push(this.data.array[s+l])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:i,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class Pz extends rs{constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new In(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}let r0;const Mx=new We,a0=new We,o0=new We,s0=new tn,Tx=new tn,jZ=new Di,Q3=new We,Ax=new We,eE=new We,b7=new tn,aL=new tn,w7=new tn;class $Z extends br{constructor(e=new Pz){if(super(),this.isSprite=!0,this.type="Sprite",r0===void 0){r0=new zi;const i=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),a=new aC(i,5);r0.setIndex([0,1,2,0,2,3]),r0.setAttribute("position",new $g(a,3,0,!1)),r0.setAttribute("uv",new $g(a,2,3,!1))}this.geometry=r0,this.material=e,this.center=new tn(.5,.5)}raycast(e,i){e.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),a0.setFromMatrixScale(this.matrixWorld),jZ.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),o0.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&a0.multiplyScalar(-o0.z);const a=this.material.rotation;let s,l;a!==0&&(l=Math.cos(a),s=Math.sin(a));const d=this.center;tE(Q3.set(-.5,-.5,0),o0,d,a0,s,l),tE(Ax.set(.5,-.5,0),o0,d,a0,s,l),tE(eE.set(.5,.5,0),o0,d,a0,s,l),b7.set(0,0),aL.set(1,0),w7.set(1,1);let f=e.ray.intersectTriangle(Q3,Ax,eE,!1,Mx);if(f===null&&(tE(Ax.set(-.5,.5,0),o0,d,a0,s,l),aL.set(0,1),f=e.ray.intersectTriangle(Q3,eE,Ax,!1,Mx),f===null))return;const p=e.ray.origin.distanceTo(Mx);p<e.near||p>e.far||i.push({distance:p,point:Mx.clone(),uv:yl.getInterpolation(Mx,Q3,Ax,eE,b7,aL,w7,new tn),face:null,object:this})}copy(e,i){return super.copy(e,i),e.center!==void 0&&this.center.copy(e.center),this.material=e.material,this}}function tE(n,e,i,a,s,l){s0.subVectors(n,i).addScalar(.5).multiply(a),s!==void 0?(Tx.x=l*s0.x-s*s0.y,Tx.y=s*s0.x+l*s0.y):Tx.copy(s0),n.copy(e),n.x+=Tx.x,n.y+=Tx.y,n.applyMatrix4(jZ)}const nE=new We,S7=new We;class YZ extends br{constructor(){super(),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),this.autoUpdate=!0}copy(e){super.copy(e,!1);const i=e.levels;for(let a=0,s=i.length;a<s;a++){const l=i[a];this.addLevel(l.object.clone(),l.distance,l.hysteresis)}return this.autoUpdate=e.autoUpdate,this}addLevel(e,i=0,a=0){i=Math.abs(i);const s=this.levels;let l;for(l=0;l<s.length&&!(i<s[l].distance);l++);return s.splice(l,0,{distance:i,hysteresis:a,object:e}),this.add(e),this}getCurrentLevel(){return this._currentLevel}getObjectForDistance(e){const i=this.levels;if(i.length>0){let a,s;for(a=1,s=i.length;a<s;a++){let l=i[a].distance;if(i[a].object.visible&&(l-=l*i[a].hysteresis),e<l)break}return i[a-1].object}return null}raycast(e,i){if(this.levels.length>0){nE.setFromMatrixPosition(this.matrixWorld);const s=e.ray.origin.distanceTo(nE);this.getObjectForDistance(s).raycast(e,i)}}update(e){const i=this.levels;if(i.length>1){nE.setFromMatrixPosition(e.matrixWorld),S7.setFromMatrixPosition(this.matrixWorld);const a=nE.distanceTo(S7)/e.zoom;i[0].object.visible=!0;let s,l;for(s=1,l=i.length;s<l;s++){let d=i[s].distance;if(i[s].object.visible&&(d-=d*i[s].hysteresis),a>=d)i[s-1].object.visible=!1,i[s].object.visible=!0;else break}for(this._currentLevel=s-1;s<l;s++)i[s].object.visible=!1}}toJSON(e){const i=super.toJSON(e);this.autoUpdate===!1&&(i.object.autoUpdate=!1),i.object.levels=[];const a=this.levels;for(let s=0,l=a.length;s<l;s++){const d=a[s];i.object.levels.push({object:d.object.uuid,distance:d.distance,hysteresis:d.hysteresis})}return i}}const E7=new We,M7=new Lr,T7=new Lr,dEe=new We,A7=new Di,iE=new We,oL=new Fc,C7=new Di,sL=new iy;class qZ extends Eo{constructor(e,i){super(e,i),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=f5,this.bindMatrix=new Di,this.bindMatrixInverse=new Di,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const e=this.geometry;this.boundingBox===null&&(this.boundingBox=new Su),this.boundingBox.makeEmpty();const i=e.getAttribute("position");for(let a=0;a<i.count;a++)this.getVertexPosition(a,iE),this.boundingBox.expandByPoint(iE)}computeBoundingSphere(){const e=this.geometry;this.boundingSphere===null&&(this.boundingSphere=new Fc),this.boundingSphere.makeEmpty();const i=e.getAttribute("position");for(let a=0;a<i.count;a++)this.getVertexPosition(a,iE),this.boundingSphere.expandByPoint(iE)}copy(e,i){return super.copy(e,i),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}raycast(e,i){const a=this.material,s=this.matrixWorld;a!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),oL.copy(this.boundingSphere),oL.applyMatrix4(s),e.ray.intersectsSphere(oL)!==!1&&(C7.copy(s).invert(),sL.copy(e.ray).applyMatrix4(C7),!(this.boundingBox!==null&&sL.intersectsBox(this.boundingBox)===!1)&&this._computeIntersections(e,i,sL)))}getVertexPosition(e,i){return super.getVertexPosition(e,i),this.applyBoneTransform(e,i),i}bind(e,i){this.skeleton=e,i===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),i=this.matrixWorld),this.bindMatrix.copy(i),this.bindMatrixInverse.copy(i).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new Lr,i=this.geometry.attributes.skinWeight;for(let a=0,s=i.count;a<s;a++){e.fromBufferAttribute(i,a);const l=1/e.manhattanLength();l!==1/0?e.multiplyScalar(l):e.set(1,0,0,0),i.setXYZW(a,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode===f5?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode===aZ?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,i){const a=this.skeleton,s=this.geometry;M7.fromBufferAttribute(s.attributes.skinIndex,e),T7.fromBufferAttribute(s.attributes.skinWeight,e),E7.copy(i).applyMatrix4(this.bindMatrix),i.set(0,0,0);for(let l=0;l<4;l++){const d=T7.getComponent(l);if(d!==0){const f=M7.getComponent(l);A7.multiplyMatrices(a.bones[f].matrixWorld,a.boneInverses[f]),i.addScaledVector(dEe.copy(E7).applyMatrix4(A7),d)}}return i.applyMatrix4(this.bindMatrixInverse)}boneTransform(e,i){return console.warn("THREE.SkinnedMesh: .boneTransform() was renamed to .applyBoneTransform() in r151."),this.applyBoneTransform(e,i)}}class Iz extends br{constructor(){super(),this.isBone=!0,this.type="Bone"}}class J0 extends Oa{constructor(e=null,i=1,a=1,s,l,d,f,p,y=co,_=co,b,S){super(null,d,f,p,y,_,s,l,b,S),this.isDataTexture=!0,this.image={data:e,width:i,height:a},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const P7=new Di,hEe=new Di;class oC{constructor(e=[],i=[]){this.uuid=tc(),this.bones=e.slice(0),this.boneInverses=i,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.init()}init(){const e=this.bones,i=this.boneInverses;if(this.boneMatrices=new Float32Array(e.length*16),i.length===0)this.calculateInverses();else if(e.length!==i.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let a=0,s=this.bones.length;a<s;a++)this.boneInverses.push(new Di)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,i=this.bones.length;e<i;e++){const a=new Di;this.bones[e]&&a.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(a)}}pose(){for(let e=0,i=this.bones.length;e<i;e++){const a=this.bones[e];a&&a.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,i=this.bones.length;e<i;e++){const a=this.bones[e];a&&(a.parent&&a.parent.isBone?(a.matrix.copy(a.parent.matrixWorld).invert(),a.matrix.multiply(a.matrixWorld)):a.matrix.copy(a.matrixWorld),a.matrix.decompose(a.position,a.quaternion,a.scale))}}update(){const e=this.bones,i=this.boneInverses,a=this.boneMatrices,s=this.boneTexture;for(let l=0,d=e.length;l<d;l++){const f=e[l]?e[l].matrixWorld:hEe;P7.multiplyMatrices(f,i[l]),P7.toArray(a,l*16)}s!==null&&(s.needsUpdate=!0)}clone(){return new oC(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(this.bones.length*4);e=CZ(e),e=Math.max(e,4);const i=new Float32Array(e*e*4);i.set(this.boneMatrices);const a=new J0(i,e,e,vl,md);return a.needsUpdate=!0,this.boneMatrices=i,this.boneTexture=a,this.boneTextureSize=e,this}getBoneByName(e){for(let i=0,a=this.bones.length;i<a;i++){const s=this.bones[i];if(s.name===e)return s}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,i){this.uuid=e.uuid;for(let a=0,s=e.bones.length;a<s;a++){const l=e.bones[a];let d=i[l];d===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",l),d=new Iz),this.bones.push(d),this.boneInverses.push(new Di().fromArray(e.boneInverses[a]))}return this.init(),this}toJSON(){const e={metadata:{version:4.6,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const i=this.bones,a=this.boneInverses;for(let s=0,l=i.length;s<l;s++){const d=i[s];e.bones.push(d.uuid);const f=a[s];e.boneInverses.push(f.toArray())}return e}}class Yg extends Qr{constructor(e,i,a,s=1){super(e,i,a),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=s}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const l0=new Di,I7=new Di,rE=[],R7=new Su,fEe=new Di,Cx=new Eo,Px=new Fc;class XZ extends Eo{constructor(e,i,a){super(e,i),this.isInstancedMesh=!0,this.instanceMatrix=new Yg(new Float32Array(a*16),16),this.instanceColor=null,this.count=a,this.boundingBox=null,this.boundingSphere=null;for(let s=0;s<a;s++)this.setMatrixAt(s,fEe)}computeBoundingBox(){const e=this.geometry,i=this.count;this.boundingBox===null&&(this.boundingBox=new Su),e.boundingBox===null&&e.computeBoundingBox(),this.boundingBox.makeEmpty();for(let a=0;a<i;a++)this.getMatrixAt(a,l0),R7.copy(e.boundingBox).applyMatrix4(l0),this.boundingBox.union(R7)}computeBoundingSphere(){const e=this.geometry,i=this.count;this.boundingSphere===null&&(this.boundingSphere=new Fc),e.boundingSphere===null&&e.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let a=0;a<i;a++)this.getMatrixAt(a,l0),Px.copy(e.boundingSphere).applyMatrix4(l0),this.boundingSphere.union(Px)}copy(e,i){return super.copy(e,i),this.instanceMatrix.copy(e.instanceMatrix),e.instanceColor!==null&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}getColorAt(e,i){i.fromArray(this.instanceColor.array,e*3)}getMatrixAt(e,i){i.fromArray(this.instanceMatrix.array,e*16)}raycast(e,i){const a=this.matrixWorld,s=this.count;if(Cx.geometry=this.geometry,Cx.material=this.material,Cx.material!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),Px.copy(this.boundingSphere),Px.applyMatrix4(a),e.ray.intersectsSphere(Px)!==!1))for(let l=0;l<s;l++){this.getMatrixAt(l,l0),I7.multiplyMatrices(a,l0),Cx.matrixWorld=I7,Cx.raycast(e,rE);for(let d=0,f=rE.length;d<f;d++){const p=rE[d];p.instanceId=l,p.object=this,i.push(p)}rE.length=0}}setColorAt(e,i){this.instanceColor===null&&(this.instanceColor=new Yg(new Float32Array(this.instanceMatrix.count*3),3)),i.toArray(this.instanceColor.array,e*3)}setMatrixAt(e,i){i.toArray(this.instanceMatrix.array,e*16)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}class Ks extends rs{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new In(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const L7=new We,k7=new We,D7=new Di,lL=new iy,aE=new Fc;let Pp=class extends br{constructor(e=new zi,i=new Ks){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=i,this.updateMorphTargets()}copy(e,i){return super.copy(e,i),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.index===null){const i=e.attributes.position,a=[0];for(let s=1,l=i.count;s<l;s++)L7.fromBufferAttribute(i,s-1),k7.fromBufferAttribute(i,s),a[s]=a[s-1],a[s]+=L7.distanceTo(k7);e.setAttribute("lineDistance",new jn(a,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,i){const a=this.geometry,s=this.matrixWorld,l=e.params.Line.threshold,d=a.drawRange;if(a.boundingSphere===null&&a.computeBoundingSphere(),aE.copy(a.boundingSphere),aE.applyMatrix4(s),aE.radius+=l,e.ray.intersectsSphere(aE)===!1)return;D7.copy(s).invert(),lL.copy(e.ray).applyMatrix4(D7);const f=l/((this.scale.x+this.scale.y+this.scale.z)/3),p=f*f,y=new We,_=new We,b=new We,S=new We,A=this.isLineSegments?2:1,P=a.index,k=a.attributes.position;if(P!==null){const R=Math.max(0,d.start),z=Math.min(P.count,d.start+d.count);for(let O=R,F=z-1;O<F;O+=A){const H=P.getX(O),$=P.getX(O+1);if(y.fromBufferAttribute(k,H),_.fromBufferAttribute(k,$),lL.distanceSqToSegment(y,_,S,b)>p)continue;S.applyMatrix4(this.matrixWorld);const te=e.ray.origin.distanceTo(S);te<e.near||te>e.far||i.push({distance:te,point:b.clone().applyMatrix4(this.matrixWorld),index:O,face:null,faceIndex:null,object:this})}}else{const R=Math.max(0,d.start),z=Math.min(k.count,d.start+d.count);for(let O=R,F=z-1;O<F;O+=A){if(y.fromBufferAttribute(k,O),_.fromBufferAttribute(k,O+1),lL.distanceSqToSegment(y,_,S,b)>p)continue;S.applyMatrix4(this.matrixWorld);const $=e.ray.origin.distanceTo(S);$<e.near||$>e.far||i.push({distance:$,point:b.clone().applyMatrix4(this.matrixWorld),index:O,face:null,faceIndex:null,object:this})}}}updateMorphTargets(){const i=this.geometry.morphAttributes,a=Object.keys(i);if(a.length>0){const s=i[a[0]];if(s!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let l=0,d=s.length;l<d;l++){const f=s[l].name||String(l);this.morphTargetInfluences.push(0),this.morphTargetDictionary[f]=l}}}}};const z7=new We,O7=new We;class kd extends Pp{constructor(e,i){super(e,i),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.index===null){const i=e.attributes.position,a=[];for(let s=0,l=i.count;s<l;s+=2)z7.fromBufferAttribute(i,s),O7.fromBufferAttribute(i,s+1),a[s]=s===0?0:a[s-1],a[s+1]=a[s]+z7.distanceTo(O7);e.setAttribute("lineDistance",new jn(a,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class ZZ extends Pp{constructor(e,i){super(e,i),this.isLineLoop=!0,this.type="LineLoop"}}class Rz extends rs{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new In(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const N7=new Di,H5=new iy,oE=new Fc,sE=new We;class KZ extends br{constructor(e=new zi,i=new Rz){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=i,this.updateMorphTargets()}copy(e,i){return super.copy(e,i),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,i){const a=this.geometry,s=this.matrixWorld,l=e.params.Points.threshold,d=a.drawRange;if(a.boundingSphere===null&&a.computeBoundingSphere(),oE.copy(a.boundingSphere),oE.applyMatrix4(s),oE.radius+=l,e.ray.intersectsSphere(oE)===!1)return;N7.copy(s).invert(),H5.copy(e.ray).applyMatrix4(N7);const f=l/((this.scale.x+this.scale.y+this.scale.z)/3),p=f*f,y=a.index,b=a.attributes.position;if(y!==null){const S=Math.max(0,d.start),A=Math.min(y.count,d.start+d.count);for(let P=S,L=A;P<L;P++){const k=y.getX(P);sE.fromBufferAttribute(b,k),F7(sE,k,p,s,e,i,this)}}else{const S=Math.max(0,d.start),A=Math.min(b.count,d.start+d.count);for(let P=S,L=A;P<L;P++)sE.fromBufferAttribute(b,P),F7(sE,P,p,s,e,i,this)}}updateMorphTargets(){const i=this.geometry.morphAttributes,a=Object.keys(i);if(a.length>0){const s=i[a[0]];if(s!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let l=0,d=s.length;l<d;l++){const f=s[l].name||String(l);this.morphTargetInfluences.push(0),this.morphTargetDictionary[f]=l}}}}}function F7(n,e,i,a,s,l,d){const f=H5.distanceSqToPoint(n);if(f<i){const p=new We;H5.closestPointToPoint(n,p),p.applyMatrix4(a);const y=s.ray.origin.distanceTo(p);if(y<s.near||y>s.far)return;l.push({distance:y,distanceToRay:Math.sqrt(f),point:p,index:e,face:null,object:d})}}class pEe extends Oa{constructor(e,i,a,s,l,d,f,p,y){super(e,i,a,s,l,d,f,p,y),this.isVideoTexture=!0,this.minFilter=d!==void 0?d:ka,this.magFilter=l!==void 0?l:ka,this.generateMipmaps=!1;const _=this;function b(){_.needsUpdate=!0,e.requestVideoFrameCallback(b)}"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback(b)}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image;"requestVideoFrameCallback"in e===!1&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}class mEe extends Oa{constructor(e,i){super({width:e,height:i}),this.isFramebufferTexture=!0,this.magFilter=co,this.minFilter=co,this.generateMipmaps=!1,this.needsUpdate=!0}}class sC extends Oa{constructor(e,i,a,s,l,d,f,p,y,_,b,S){super(null,d,f,p,y,_,s,l,b,S),this.isCompressedTexture=!0,this.image={width:i,height:a},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}class gEe extends sC{constructor(e,i,a,s,l,d){super(e,i,a,l,d),this.isCompressedArrayTexture=!0,this.image.depth=s,this.wrapR=Ss}}class yEe extends sC{constructor(e,i,a){super(void 0,e[0].width,e[0].height,i,a,Yh),this.isCompressedCubeTexture=!0,this.isCubeTexture=!0,this.image=e}}class vEe extends Oa{constructor(e,i,a,s,l,d,f,p,y){super(e,i,a,s,l,d,f,p,y),this.isCanvasTexture=!0,this.needsUpdate=!0}}class Eu{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,i){const a=this.getUtoTmapping(e);return this.getPoint(a,i)}getPoints(e=5){const i=[];for(let a=0;a<=e;a++)i.push(this.getPoint(a/e));return i}getSpacedPoints(e=5){const i=[];for(let a=0;a<=e;a++)i.push(this.getPointAt(a/e));return i}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const i=[];let a,s=this.getPoint(0),l=0;i.push(0);for(let d=1;d<=e;d++)a=this.getPoint(d/e),l+=a.distanceTo(s),i.push(l),s=a;return this.cacheArcLengths=i,i}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,i){const a=this.getLengths();let s=0;const l=a.length;let d;i?d=i:d=e*a[l-1];let f=0,p=l-1,y;for(;f<=p;)if(s=Math.floor(f+(p-f)/2),y=a[s]-d,y<0)f=s+1;else if(y>0)p=s-1;else{p=s;break}if(s=p,a[s]===d)return s/(l-1);const _=a[s],S=a[s+1]-_,A=(d-_)/S;return(s+A)/(l-1)}getTangent(e,i){let s=e-1e-4,l=e+1e-4;s<0&&(s=0),l>1&&(l=1);const d=this.getPoint(s),f=this.getPoint(l),p=i||(d.isVector2?new tn:new We);return p.copy(f).sub(d).normalize(),p}getTangentAt(e,i){const a=this.getUtoTmapping(e);return this.getTangent(a,i)}computeFrenetFrames(e,i){const a=new We,s=[],l=[],d=[],f=new We,p=new Di;for(let A=0;A<=e;A++){const P=A/e;s[A]=this.getTangentAt(P,new We)}l[0]=new We,d[0]=new We;let y=Number.MAX_VALUE;const _=Math.abs(s[0].x),b=Math.abs(s[0].y),S=Math.abs(s[0].z);_<=y&&(y=_,a.set(1,0,0)),b<=y&&(y=b,a.set(0,1,0)),S<=y&&a.set(0,0,1),f.crossVectors(s[0],a).normalize(),l[0].crossVectors(s[0],f),d[0].crossVectors(s[0],l[0]);for(let A=1;A<=e;A++){if(l[A]=l[A-1].clone(),d[A]=d[A-1].clone(),f.crossVectors(s[A-1],s[A]),f.length()>Number.EPSILON){f.normalize();const P=Math.acos(Xa(s[A-1].dot(s[A]),-1,1));l[A].applyMatrix4(p.makeRotationAxis(f,P))}d[A].crossVectors(s[A],l[A])}if(i===!0){let A=Math.acos(Xa(l[0].dot(l[e]),-1,1));A/=e,s[0].dot(f.crossVectors(l[0],l[e]))>0&&(A=-A);for(let P=1;P<=e;P++)l[P].applyMatrix4(p.makeRotationAxis(s[P],A*P)),d[P].crossVectors(s[P],l[P])}return{tangents:s,normals:l,binormals:d}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class lC extends Eu{constructor(e=0,i=0,a=1,s=1,l=0,d=Math.PI*2,f=!1,p=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=i,this.xRadius=a,this.yRadius=s,this.aStartAngle=l,this.aEndAngle=d,this.aClockwise=f,this.aRotation=p}getPoint(e,i){const a=i||new tn,s=Math.PI*2;let l=this.aEndAngle-this.aStartAngle;const d=Math.abs(l)<Number.EPSILON;for(;l<0;)l+=s;for(;l>s;)l-=s;l<Number.EPSILON&&(d?l=0:l=s),this.aClockwise===!0&&!d&&(l===s?l=-s:l=l-s);const f=this.aStartAngle+e*l;let p=this.aX+this.xRadius*Math.cos(f),y=this.aY+this.yRadius*Math.sin(f);if(this.aRotation!==0){const _=Math.cos(this.aRotation),b=Math.sin(this.aRotation),S=p-this.aX,A=y-this.aY;p=S*_-A*b+this.aX,y=S*b+A*_+this.aY}return a.set(p,y)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}class JZ extends lC{constructor(e,i,a,s,l,d){super(e,i,a,a,s,l,d),this.isArcCurve=!0,this.type="ArcCurve"}}function Lz(){let n=0,e=0,i=0,a=0;function s(l,d,f,p){n=l,e=f,i=-3*l+3*d-2*f-p,a=2*l-2*d+f+p}return{initCatmullRom:function(l,d,f,p,y){s(d,f,y*(f-l),y*(p-d))},initNonuniformCatmullRom:function(l,d,f,p,y,_,b){let S=(d-l)/y-(f-l)/(y+_)+(f-d)/_,A=(f-d)/_-(p-d)/(_+b)+(p-f)/b;S*=_,A*=_,s(d,f,S,A)},calc:function(l){const d=l*l,f=d*l;return n+e*l+i*d+a*f}}}const lE=new We,cL=new Lz,uL=new Lz,dL=new Lz;class QZ extends Eu{constructor(e=[],i=!1,a="centripetal",s=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=i,this.curveType=a,this.tension=s}getPoint(e,i=new We){const a=i,s=this.points,l=s.length,d=(l-(this.closed?0:1))*e;let f=Math.floor(d),p=d-f;this.closed?f+=f>0?0:(Math.floor(Math.abs(f)/l)+1)*l:p===0&&f===l-1&&(f=l-2,p=1);let y,_;this.closed||f>0?y=s[(f-1)%l]:(lE.subVectors(s[0],s[1]).add(s[0]),y=lE);const b=s[f%l],S=s[(f+1)%l];if(this.closed||f+2<l?_=s[(f+2)%l]:(lE.subVectors(s[l-1],s[l-2]).add(s[l-1]),_=lE),this.curveType==="centripetal"||this.curveType==="chordal"){const A=this.curveType==="chordal"?.5:.25;let P=Math.pow(y.distanceToSquared(b),A),L=Math.pow(b.distanceToSquared(S),A),k=Math.pow(S.distanceToSquared(_),A);L<1e-4&&(L=1),P<1e-4&&(P=L),k<1e-4&&(k=L),cL.initNonuniformCatmullRom(y.x,b.x,S.x,_.x,P,L,k),uL.initNonuniformCatmullRom(y.y,b.y,S.y,_.y,P,L,k),dL.initNonuniformCatmullRom(y.z,b.z,S.z,_.z,P,L,k)}else this.curveType==="catmullrom"&&(cL.initCatmullRom(y.x,b.x,S.x,_.x,this.tension),uL.initCatmullRom(y.y,b.y,S.y,_.y,this.tension),dL.initCatmullRom(y.z,b.z,S.z,_.z,this.tension));return a.set(cL.calc(p),uL.calc(p),dL.calc(p)),a}copy(e){super.copy(e),this.points=[];for(let i=0,a=e.points.length;i<a;i++){const s=e.points[i];this.points.push(s.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let i=0,a=this.points.length;i<a;i++){const s=this.points[i];e.points.push(s.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let i=0,a=e.points.length;i<a;i++){const s=e.points[i];this.points.push(new We().fromArray(s))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function B7(n,e,i,a,s){const l=(a-e)*.5,d=(s-i)*.5,f=n*n,p=n*f;return(2*i-2*a+l+d)*p+(-3*i+3*a-2*l-d)*f+l*n+i}function _Ee(n,e){const i=1-n;return i*i*e}function xEe(n,e){return 2*(1-n)*n*e}function bEe(n,e){return n*n*e}function wb(n,e,i,a){return _Ee(n,e)+xEe(n,i)+bEe(n,a)}function wEe(n,e){const i=1-n;return i*i*i*e}function SEe(n,e){const i=1-n;return 3*i*i*n*e}function EEe(n,e){return 3*(1-n)*n*n*e}function MEe(n,e){return n*n*n*e}function Sb(n,e,i,a,s){return wEe(n,e)+SEe(n,i)+EEe(n,a)+MEe(n,s)}class kz extends Eu{constructor(e=new tn,i=new tn,a=new tn,s=new tn){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=i,this.v2=a,this.v3=s}getPoint(e,i=new tn){const a=i,s=this.v0,l=this.v1,d=this.v2,f=this.v3;return a.set(Sb(e,s.x,l.x,d.x,f.x),Sb(e,s.y,l.y,d.y,f.y)),a}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class eK extends Eu{constructor(e=new We,i=new We,a=new We,s=new We){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=i,this.v2=a,this.v3=s}getPoint(e,i=new We){const a=i,s=this.v0,l=this.v1,d=this.v2,f=this.v3;return a.set(Sb(e,s.x,l.x,d.x,f.x),Sb(e,s.y,l.y,d.y,f.y),Sb(e,s.z,l.z,d.z,f.z)),a}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class Dz extends Eu{constructor(e=new tn,i=new tn){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=i}getPoint(e,i=new tn){const a=i;return e===1?a.copy(this.v2):(a.copy(this.v2).sub(this.v1),a.multiplyScalar(e).add(this.v1)),a}getPointAt(e,i){return this.getPoint(e,i)}getTangent(e,i=new tn){return i.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,i){return this.getTangent(e,i)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class tK extends Eu{constructor(e=new We,i=new We){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=i}getPoint(e,i=new We){const a=i;return e===1?a.copy(this.v2):(a.copy(this.v2).sub(this.v1),a.multiplyScalar(e).add(this.v1)),a}getPointAt(e,i){return this.getPoint(e,i)}getTangent(e,i=new We){return i.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,i){return this.getTangent(e,i)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class zz extends Eu{constructor(e=new tn,i=new tn,a=new tn){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=i,this.v2=a}getPoint(e,i=new tn){const a=i,s=this.v0,l=this.v1,d=this.v2;return a.set(wb(e,s.x,l.x,d.x),wb(e,s.y,l.y,d.y)),a}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class Oz extends Eu{constructor(e=new We,i=new We,a=new We){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=i,this.v2=a}getPoint(e,i=new We){const a=i,s=this.v0,l=this.v1,d=this.v2;return a.set(wb(e,s.x,l.x,d.x),wb(e,s.y,l.y,d.y),wb(e,s.z,l.z,d.z)),a}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class Nz extends Eu{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,i=new tn){const a=i,s=this.points,l=(s.length-1)*e,d=Math.floor(l),f=l-d,p=s[d===0?d:d-1],y=s[d],_=s[d>s.length-2?s.length-1:d+1],b=s[d>s.length-3?s.length-1:d+2];return a.set(B7(f,p.x,y.x,_.x,b.x),B7(f,p.y,y.y,_.y,b.y)),a}copy(e){super.copy(e),this.points=[];for(let i=0,a=e.points.length;i<a;i++){const s=e.points[i];this.points.push(s.clone())}return this}toJSON(){const e=super.toJSON();e.points=[];for(let i=0,a=this.points.length;i<a;i++){const s=this.points[i];e.points.push(s.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let i=0,a=e.points.length;i<a;i++){const s=e.points[i];this.points.push(new tn().fromArray(s))}return this}}var _T=Object.freeze({__proto__:null,ArcCurve:JZ,CatmullRomCurve3:QZ,CubicBezierCurve:kz,CubicBezierCurve3:eK,EllipseCurve:lC,LineCurve:Dz,LineCurve3:tK,QuadraticBezierCurve:zz,QuadraticBezierCurve3:Oz,SplineCurve:Nz});class nK extends Eu{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),i=this.curves[this.curves.length-1].getPoint(1);if(!e.equals(i)){const a=e.isVector2===!0?"LineCurve":"LineCurve3";this.curves.push(new _T[a](i,e))}return this}getPoint(e,i){const a=e*this.getLength(),s=this.getCurveLengths();let l=0;for(;l<s.length;){if(s[l]>=a){const d=s[l]-a,f=this.curves[l],p=f.getLength(),y=p===0?0:1-d/p;return f.getPointAt(y,i)}l++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let i=0;for(let a=0,s=this.curves.length;a<s;a++)i+=this.curves[a].getLength(),e.push(i);return this.cacheLengths=e,e}getSpacedPoints(e=40){const i=[];for(let a=0;a<=e;a++)i.push(this.getPoint(a/e));return this.autoClose&&i.push(i[0]),i}getPoints(e=12){const i=[];let a;for(let s=0,l=this.curves;s<l.length;s++){const d=l[s],f=d.isEllipseCurve?e*2:d.isLineCurve||d.isLineCurve3?1:d.isSplineCurve?e*d.points.length:e,p=d.getPoints(f);for(let y=0;y<p.length;y++){const _=p[y];a&&a.equals(_)||(i.push(_),a=_)}}return this.autoClose&&i.length>1&&!i[i.length-1].equals(i[0])&&i.push(i[0]),i}copy(e){super.copy(e),this.curves=[];for(let i=0,a=e.curves.length;i<a;i++){const s=e.curves[i];this.curves.push(s.clone())}return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let i=0,a=this.curves.length;i<a;i++){const s=this.curves[i];e.curves.push(s.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let i=0,a=e.curves.length;i<a;i++){const s=e.curves[i];this.curves.push(new _T[s.type]().fromJSON(s))}return this}}class bw extends nK{constructor(e){super(),this.type="Path",this.currentPoint=new tn,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let i=1,a=e.length;i<a;i++)this.lineTo(e[i].x,e[i].y);return this}moveTo(e,i){return this.currentPoint.set(e,i),this}lineTo(e,i){const a=new Dz(this.currentPoint.clone(),new tn(e,i));return this.curves.push(a),this.currentPoint.set(e,i),this}quadraticCurveTo(e,i,a,s){const l=new zz(this.currentPoint.clone(),new tn(e,i),new tn(a,s));return this.curves.push(l),this.currentPoint.set(a,s),this}bezierCurveTo(e,i,a,s,l,d){const f=new kz(this.currentPoint.clone(),new tn(e,i),new tn(a,s),new tn(l,d));return this.curves.push(f),this.currentPoint.set(l,d),this}splineThru(e){const i=[this.currentPoint.clone()].concat(e),a=new Nz(i);return this.curves.push(a),this.currentPoint.copy(e[e.length-1]),this}arc(e,i,a,s,l,d){const f=this.currentPoint.x,p=this.currentPoint.y;return this.absarc(e+f,i+p,a,s,l,d),this}absarc(e,i,a,s,l,d){return this.absellipse(e,i,a,a,s,l,d),this}ellipse(e,i,a,s,l,d,f,p){const y=this.currentPoint.x,_=this.currentPoint.y;return this.absellipse(e+y,i+_,a,s,l,d,f,p),this}absellipse(e,i,a,s,l,d,f,p){const y=new lC(e,i,a,s,l,d,f,p);if(this.curves.length>0){const b=y.getPoint(0);b.equals(this.currentPoint)||this.lineTo(b.x,b.y)}this.curves.push(y);const _=y.getPoint(1);return this.currentPoint.copy(_),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class rS extends zi{constructor(e=[new tn(0,-.5),new tn(.5,0),new tn(0,.5)],i=12,a=0,s=Math.PI*2){super(),this.type="LatheGeometry",this.parameters={points:e,segments:i,phiStart:a,phiLength:s},i=Math.floor(i),s=Xa(s,0,Math.PI*2);const l=[],d=[],f=[],p=[],y=[],_=1/i,b=new We,S=new tn,A=new We,P=new We,L=new We;let k=0,R=0;for(let z=0;z<=e.length-1;z++)switch(z){case 0:k=e[z+1].x-e[z].x,R=e[z+1].y-e[z].y,A.x=R*1,A.y=-k,A.z=R*0,L.copy(A),A.normalize(),p.push(A.x,A.y,A.z);break;case e.length-1:p.push(L.x,L.y,L.z);break;default:k=e[z+1].x-e[z].x,R=e[z+1].y-e[z].y,A.x=R*1,A.y=-k,A.z=R*0,P.copy(A),A.x+=L.x,A.y+=L.y,A.z+=L.z,A.normalize(),p.push(A.x,A.y,A.z),L.copy(P)}for(let z=0;z<=i;z++){const O=a+z*_*s,F=Math.sin(O),H=Math.cos(O);for(let $=0;$<=e.length-1;$++){b.x=e[$].x*F,b.y=e[$].y,b.z=e[$].x*H,d.push(b.x,b.y,b.z),S.x=z/i,S.y=$/(e.length-1),f.push(S.x,S.y);const Y=p[3*$+0]*F,te=p[3*$+1],G=p[3*$+0]*H;y.push(Y,te,G)}}for(let z=0;z<i;z++)for(let O=0;O<e.length-1;O++){const F=O+z*e.length,H=F,$=F+e.length,Y=F+e.length+1,te=F+1;l.push(H,$,te),l.push(Y,te,$)}this.setIndex(l),this.setAttribute("position",new jn(d,3)),this.setAttribute("uv",new jn(f,2)),this.setAttribute("normal",new jn(y,3))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new rS(e.points,e.segments,e.phiStart,e.phiLength)}}class cC extends rS{constructor(e=1,i=1,a=4,s=8){const l=new bw;l.absarc(0,-i/2,e,Math.PI*1.5,0),l.absarc(0,i/2,e,0,Math.PI*.5),super(l.getPoints(a),s),this.type="CapsuleGeometry",this.parameters={radius:e,length:i,capSegments:a,radialSegments:s}}static fromJSON(e){return new cC(e.radius,e.length,e.capSegments,e.radialSegments)}}class uC extends zi{constructor(e=1,i=32,a=0,s=Math.PI*2){super(),this.type="CircleGeometry",this.parameters={radius:e,segments:i,thetaStart:a,thetaLength:s},i=Math.max(3,i);const l=[],d=[],f=[],p=[],y=new We,_=new tn;d.push(0,0,0),f.push(0,0,1),p.push(.5,.5);for(let b=0,S=3;b<=i;b++,S+=3){const A=a+b/i*s;y.x=e*Math.cos(A),y.y=e*Math.sin(A),d.push(y.x,y.y,y.z),f.push(0,0,1),_.x=(d[S]/e+1)/2,_.y=(d[S+1]/e+1)/2,p.push(_.x,_.y)}for(let b=1;b<=i;b++)l.push(b,b+1,0);this.setIndex(l),this.setAttribute("position",new jn(d,3)),this.setAttribute("normal",new jn(f,3)),this.setAttribute("uv",new jn(p,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new uC(e.radius,e.segments,e.thetaStart,e.thetaLength)}}class k_ extends zi{constructor(e=1,i=1,a=1,s=32,l=1,d=!1,f=0,p=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:i,height:a,radialSegments:s,heightSegments:l,openEnded:d,thetaStart:f,thetaLength:p};const y=this;s=Math.floor(s),l=Math.floor(l);const _=[],b=[],S=[],A=[];let P=0;const L=[],k=a/2;let R=0;z(),d===!1&&(e>0&&O(!0),i>0&&O(!1)),this.setIndex(_),this.setAttribute("position",new jn(b,3)),this.setAttribute("normal",new jn(S,3)),this.setAttribute("uv",new jn(A,2));function z(){const F=new We,H=new We;let $=0;const Y=(i-e)/a;for(let te=0;te<=l;te++){const G=[],Q=te/l,he=Q*(i-e)+e;for(let pe=0;pe<=s;pe++){const ye=pe/s,fe=ye*p+f,Ae=Math.sin(fe),Re=Math.cos(fe);H.x=he*Ae,H.y=-Q*a+k,H.z=he*Re,b.push(H.x,H.y,H.z),F.set(Ae,Y,Re).normalize(),S.push(F.x,F.y,F.z),A.push(ye,1-Q),G.push(P++)}L.push(G)}for(let te=0;te<s;te++)for(let G=0;G<l;G++){const Q=L[G][te],he=L[G+1][te],pe=L[G+1][te+1],ye=L[G][te+1];_.push(Q,he,ye),_.push(he,pe,ye),$+=6}y.addGroup(R,$,0),R+=$}function O(F){const H=P,$=new tn,Y=new We;let te=0;const G=F===!0?e:i,Q=F===!0?1:-1;for(let pe=1;pe<=s;pe++)b.push(0,k*Q,0),S.push(0,Q,0),A.push(.5,.5),P++;const he=P;for(let pe=0;pe<=s;pe++){const fe=pe/s*p+f,Ae=Math.cos(fe),Re=Math.sin(fe);Y.x=G*Re,Y.y=k*Q,Y.z=G*Ae,b.push(Y.x,Y.y,Y.z),S.push(0,Q,0),$.x=Ae*.5+.5,$.y=Re*.5*Q+.5,A.push($.x,$.y),P++}for(let pe=0;pe<s;pe++){const ye=H+pe,fe=he+pe;F===!0?_.push(fe,fe+1,ye):_.push(fe+1,fe,ye),te+=3}y.addGroup(R,te,F===!0?1:2),R+=te}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new k_(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class dC extends k_{constructor(e=1,i=1,a=32,s=1,l=!1,d=0,f=Math.PI*2){super(0,e,i,a,s,l,d,f),this.type="ConeGeometry",this.parameters={radius:e,height:i,radialSegments:a,heightSegments:s,openEnded:l,thetaStart:d,thetaLength:f}}static fromJSON(e){return new dC(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class Bp extends zi{constructor(e=[],i=[],a=1,s=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:i,radius:a,detail:s};const l=[],d=[];f(s),y(a),_(),this.setAttribute("position",new jn(l,3)),this.setAttribute("normal",new jn(l.slice(),3)),this.setAttribute("uv",new jn(d,2)),s===0?this.computeVertexNormals():this.normalizeNormals();function f(z){const O=new We,F=new We,H=new We;for(let $=0;$<i.length;$+=3)A(i[$+0],O),A(i[$+1],F),A(i[$+2],H),p(O,F,H,z)}function p(z,O,F,H){const $=H+1,Y=[];for(let te=0;te<=$;te++){Y[te]=[];const G=z.clone().lerp(F,te/$),Q=O.clone().lerp(F,te/$),he=$-te;for(let pe=0;pe<=he;pe++)pe===0&&te===$?Y[te][pe]=G:Y[te][pe]=G.clone().lerp(Q,pe/he)}for(let te=0;te<$;te++)for(let G=0;G<2*($-te)-1;G++){const Q=Math.floor(G/2);G%2===0?(S(Y[te][Q+1]),S(Y[te+1][Q]),S(Y[te][Q])):(S(Y[te][Q+1]),S(Y[te+1][Q+1]),S(Y[te+1][Q]))}}function y(z){const O=new We;for(let F=0;F<l.length;F+=3)O.x=l[F+0],O.y=l[F+1],O.z=l[F+2],O.normalize().multiplyScalar(z),l[F+0]=O.x,l[F+1]=O.y,l[F+2]=O.z}function _(){const z=new We;for(let O=0;O<l.length;O+=3){z.x=l[O+0],z.y=l[O+1],z.z=l[O+2];const F=k(z)/2/Math.PI+.5,H=R(z)/Math.PI+.5;d.push(F,1-H)}P(),b()}function b(){for(let z=0;z<d.length;z+=6){const O=d[z+0],F=d[z+2],H=d[z+4],$=Math.max(O,F,H),Y=Math.min(O,F,H);$>.9&&Y<.1&&(O<.2&&(d[z+0]+=1),F<.2&&(d[z+2]+=1),H<.2&&(d[z+4]+=1))}}function S(z){l.push(z.x,z.y,z.z)}function A(z,O){const F=z*3;O.x=e[F+0],O.y=e[F+1],O.z=e[F+2]}function P(){const z=new We,O=new We,F=new We,H=new We,$=new tn,Y=new tn,te=new tn;for(let G=0,Q=0;G<l.length;G+=9,Q+=6){z.set(l[G+0],l[G+1],l[G+2]),O.set(l[G+3],l[G+4],l[G+5]),F.set(l[G+6],l[G+7],l[G+8]),$.set(d[Q+0],d[Q+1]),Y.set(d[Q+2],d[Q+3]),te.set(d[Q+4],d[Q+5]),H.copy(z).add(O).add(F).divideScalar(3);const he=k(H);L($,Q+0,z,he),L(Y,Q+2,O,he),L(te,Q+4,F,he)}}function L(z,O,F,H){H<0&&z.x===1&&(d[O]=z.x-1),F.x===0&&F.z===0&&(d[O]=H/2/Math.PI+.5)}function k(z){return Math.atan2(z.z,-z.x)}function R(z){return Math.atan2(-z.y,Math.sqrt(z.x*z.x+z.z*z.z))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Bp(e.vertices,e.indices,e.radius,e.details)}}class hC extends Bp{constructor(e=1,i=0){const a=(1+Math.sqrt(5))/2,s=1/a,l=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-s,-a,0,-s,a,0,s,-a,0,s,a,-s,-a,0,-s,a,0,s,-a,0,s,a,0,-a,0,-s,a,0,-s,-a,0,s,a,0,s],d=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(l,d,e,i),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:i}}static fromJSON(e){return new hC(e.radius,e.detail)}}const cE=new We,uE=new We,hL=new We,dE=new yl;class iK extends zi{constructor(e=null,i=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:i},e!==null){const s=Math.pow(10,4),l=Math.cos(Ig*i),d=e.getIndex(),f=e.getAttribute("position"),p=d?d.count:f.count,y=[0,0,0],_=["a","b","c"],b=new Array(3),S={},A=[];for(let P=0;P<p;P+=3){d?(y[0]=d.getX(P),y[1]=d.getX(P+1),y[2]=d.getX(P+2)):(y[0]=P,y[1]=P+1,y[2]=P+2);const{a:L,b:k,c:R}=dE;if(L.fromBufferAttribute(f,y[0]),k.fromBufferAttribute(f,y[1]),R.fromBufferAttribute(f,y[2]),dE.getNormal(hL),b[0]=`${Math.round(L.x*s)},${Math.round(L.y*s)},${Math.round(L.z*s)}`,b[1]=`${Math.round(k.x*s)},${Math.round(k.y*s)},${Math.round(k.z*s)}`,b[2]=`${Math.round(R.x*s)},${Math.round(R.y*s)},${Math.round(R.z*s)}`,!(b[0]===b[1]||b[1]===b[2]||b[2]===b[0]))for(let z=0;z<3;z++){const O=(z+1)%3,F=b[z],H=b[O],$=dE[_[z]],Y=dE[_[O]],te=`${F}_${H}`,G=`${H}_${F}`;G in S&&S[G]?(hL.dot(S[G].normal)<=l&&(A.push($.x,$.y,$.z),A.push(Y.x,Y.y,Y.z)),S[G]=null):te in S||(S[te]={index0:y[z],index1:y[O],normal:hL.clone()})}}for(const P in S)if(S[P]){const{index0:L,index1:k}=S[P];cE.fromBufferAttribute(f,L),uE.fromBufferAttribute(f,k),A.push(cE.x,cE.y,cE.z),A.push(uE.x,uE.y,uE.z)}this.setAttribute("position",new jn(A,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}class Lg extends bw{constructor(e){super(e),this.uuid=tc(),this.type="Shape",this.holes=[]}getPointsHoles(e){const i=[];for(let a=0,s=this.holes.length;a<s;a++)i[a]=this.holes[a].getPoints(e);return i}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let i=0,a=e.holes.length;i<a;i++){const s=e.holes[i];this.holes.push(s.clone())}return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let i=0,a=this.holes.length;i<a;i++){const s=this.holes[i];e.holes.push(s.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let i=0,a=e.holes.length;i<a;i++){const s=e.holes[i];this.holes.push(new bw().fromJSON(s))}return this}}const TEe={triangulate:function(n,e,i=2){const a=e&&e.length,s=a?e[0]*i:n.length;let l=rK(n,0,s,i,!0);const d=[];if(!l||l.next===l.prev)return d;let f,p,y,_,b,S,A;if(a&&(l=REe(n,e,l,i)),n.length>80*i){f=y=n[0],p=_=n[1];for(let P=i;P<s;P+=i)b=n[P],S=n[P+1],b<f&&(f=b),S<p&&(p=S),b>y&&(y=b),S>_&&(_=S);A=Math.max(y-f,_-p),A=A!==0?32767/A:0}return ww(l,d,i,f,p,A,0),d}};function rK(n,e,i,a,s){let l,d;if(s===VEe(n,e,i,a)>0)for(l=e;l<i;l+=a)d=U7(l,n[l],n[l+1],d);else for(l=i-a;l>=e;l-=a)d=U7(l,n[l],n[l+1],d);return d&&fC(d,d.next)&&(Ew(d),d=d.next),d}function qg(n,e){if(!n)return n;e||(e=n);let i=n,a;do if(a=!1,!i.steiner&&(fC(i,i.next)||Da(i.prev,i,i.next)===0)){if(Ew(i),i=e=i.prev,i===i.next)break;a=!0}else i=i.next;while(a||i!==e);return e}function ww(n,e,i,a,s,l,d){if(!n)return;!d&&l&&OEe(n,a,s,l);let f=n,p,y;for(;n.prev!==n.next;){if(p=n.prev,y=n.next,l?CEe(n,a,s,l):AEe(n)){e.push(p.i/i|0),e.push(n.i/i|0),e.push(y.i/i|0),Ew(n),n=y.next,f=y.next;continue}if(n=y,n===f){d?d===1?(n=PEe(qg(n),e,i),ww(n,e,i,a,s,l,2)):d===2&&IEe(n,e,i,a,s,l):ww(qg(n),e,i,a,s,l,1);break}}}function AEe(n){const e=n.prev,i=n,a=n.next;if(Da(e,i,a)>=0)return!1;const s=e.x,l=i.x,d=a.x,f=e.y,p=i.y,y=a.y,_=s<l?s<d?s:d:l<d?l:d,b=f<p?f<y?f:y:p<y?p:y,S=s>l?s>d?s:d:l>d?l:d,A=f>p?f>y?f:y:p>y?p:y;let P=a.next;for(;P!==e;){if(P.x>=_&&P.x<=S&&P.y>=b&&P.y<=A&&F0(s,f,l,p,d,y,P.x,P.y)&&Da(P.prev,P,P.next)>=0)return!1;P=P.next}return!0}function CEe(n,e,i,a){const s=n.prev,l=n,d=n.next;if(Da(s,l,d)>=0)return!1;const f=s.x,p=l.x,y=d.x,_=s.y,b=l.y,S=d.y,A=f<p?f<y?f:y:p<y?p:y,P=_<b?_<S?_:S:b<S?b:S,L=f>p?f>y?f:y:p>y?p:y,k=_>b?_>S?_:S:b>S?b:S,R=j5(A,P,e,i,a),z=j5(L,k,e,i,a);let O=n.prevZ,F=n.nextZ;for(;O&&O.z>=R&&F&&F.z<=z;){if(O.x>=A&&O.x<=L&&O.y>=P&&O.y<=k&&O!==s&&O!==d&&F0(f,_,p,b,y,S,O.x,O.y)&&Da(O.prev,O,O.next)>=0||(O=O.prevZ,F.x>=A&&F.x<=L&&F.y>=P&&F.y<=k&&F!==s&&F!==d&&F0(f,_,p,b,y,S,F.x,F.y)&&Da(F.prev,F,F.next)>=0))return!1;F=F.nextZ}for(;O&&O.z>=R;){if(O.x>=A&&O.x<=L&&O.y>=P&&O.y<=k&&O!==s&&O!==d&&F0(f,_,p,b,y,S,O.x,O.y)&&Da(O.prev,O,O.next)>=0)return!1;O=O.prevZ}for(;F&&F.z<=z;){if(F.x>=A&&F.x<=L&&F.y>=P&&F.y<=k&&F!==s&&F!==d&&F0(f,_,p,b,y,S,F.x,F.y)&&Da(F.prev,F,F.next)>=0)return!1;F=F.nextZ}return!0}function PEe(n,e,i){let a=n;do{const s=a.prev,l=a.next.next;!fC(s,l)&&aK(s,a,a.next,l)&&Sw(s,l)&&Sw(l,s)&&(e.push(s.i/i|0),e.push(a.i/i|0),e.push(l.i/i|0),Ew(a),Ew(a.next),a=n=l),a=a.next}while(a!==n);return qg(a)}function IEe(n,e,i,a,s,l){let d=n;do{let f=d.next.next;for(;f!==d.prev;){if(d.i!==f.i&&BEe(d,f)){let p=oK(d,f);d=qg(d,d.next),p=qg(p,p.next),ww(d,e,i,a,s,l,0),ww(p,e,i,a,s,l,0);return}f=f.next}d=d.next}while(d!==n)}function REe(n,e,i,a){const s=[];let l,d,f,p,y;for(l=0,d=e.length;l<d;l++)f=e[l]*a,p=l<d-1?e[l+1]*a:n.length,y=rK(n,f,p,a,!1),y===y.next&&(y.steiner=!0),s.push(FEe(y));for(s.sort(LEe),l=0;l<s.length;l++)i=kEe(s[l],i);return i}function LEe(n,e){return n.x-e.x}function kEe(n,e){const i=DEe(n,e);if(!i)return e;const a=oK(i,n);return qg(a,a.next),qg(i,i.next)}function DEe(n,e){let i=e,a=-1/0,s;const l=n.x,d=n.y;do{if(d<=i.y&&d>=i.next.y&&i.next.y!==i.y){const S=i.x+(d-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(S<=l&&S>a&&(a=S,s=i.x<i.next.x?i:i.next,S===l))return s}i=i.next}while(i!==e);if(!s)return null;const f=s,p=s.x,y=s.y;let _=1/0,b;i=s;do l>=i.x&&i.x>=p&&l!==i.x&&F0(d<y?l:a,d,p,y,d<y?a:l,d,i.x,i.y)&&(b=Math.abs(d-i.y)/(l-i.x),Sw(i,n)&&(b<_||b===_&&(i.x>s.x||i.x===s.x&&zEe(s,i)))&&(s=i,_=b)),i=i.next;while(i!==f);return s}function zEe(n,e){return Da(n.prev,n,e.prev)<0&&Da(e.next,n,n.next)<0}function OEe(n,e,i,a){let s=n;do s.z===0&&(s.z=j5(s.x,s.y,e,i,a)),s.prevZ=s.prev,s.nextZ=s.next,s=s.next;while(s!==n);s.prevZ.nextZ=null,s.prevZ=null,NEe(s)}function NEe(n){let e,i,a,s,l,d,f,p,y=1;do{for(i=n,n=null,l=null,d=0;i;){for(d++,a=i,f=0,e=0;e<y&&(f++,a=a.nextZ,!!a);e++);for(p=y;f>0||p>0&&a;)f!==0&&(p===0||!a||i.z<=a.z)?(s=i,i=i.nextZ,f--):(s=a,a=a.nextZ,p--),l?l.nextZ=s:n=s,s.prevZ=l,l=s;i=a}l.nextZ=null,y*=2}while(d>1);return n}function j5(n,e,i,a,s){return n=(n-i)*s|0,e=(e-a)*s|0,n=(n|n<<8)&16711935,n=(n|n<<4)&252645135,n=(n|n<<2)&858993459,n=(n|n<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,n|e<<1}function FEe(n){let e=n,i=n;do(e.x<i.x||e.x===i.x&&e.y<i.y)&&(i=e),e=e.next;while(e!==n);return i}function F0(n,e,i,a,s,l,d,f){return(s-d)*(e-f)>=(n-d)*(l-f)&&(n-d)*(a-f)>=(i-d)*(e-f)&&(i-d)*(l-f)>=(s-d)*(a-f)}function BEe(n,e){return n.next.i!==e.i&&n.prev.i!==e.i&&!UEe(n,e)&&(Sw(n,e)&&Sw(e,n)&&WEe(n,e)&&(Da(n.prev,n,e.prev)||Da(n,e.prev,e))||fC(n,e)&&Da(n.prev,n,n.next)>0&&Da(e.prev,e,e.next)>0)}function Da(n,e,i){return(e.y-n.y)*(i.x-e.x)-(e.x-n.x)*(i.y-e.y)}function fC(n,e){return n.x===e.x&&n.y===e.y}function aK(n,e,i,a){const s=fE(Da(n,e,i)),l=fE(Da(n,e,a)),d=fE(Da(i,a,n)),f=fE(Da(i,a,e));return!!(s!==l&&d!==f||s===0&&hE(n,i,e)||l===0&&hE(n,a,e)||d===0&&hE(i,n,a)||f===0&&hE(i,e,a))}function hE(n,e,i){return e.x<=Math.max(n.x,i.x)&&e.x>=Math.min(n.x,i.x)&&e.y<=Math.max(n.y,i.y)&&e.y>=Math.min(n.y,i.y)}function fE(n){return n>0?1:n<0?-1:0}function UEe(n,e){let i=n;do{if(i.i!==n.i&&i.next.i!==n.i&&i.i!==e.i&&i.next.i!==e.i&&aK(i,i.next,n,e))return!0;i=i.next}while(i!==n);return!1}function Sw(n,e){return Da(n.prev,n,n.next)<0?Da(n,e,n.next)>=0&&Da(n,n.prev,e)>=0:Da(n,e,n.prev)<0||Da(n,n.next,e)<0}function WEe(n,e){let i=n,a=!1;const s=(n.x+e.x)/2,l=(n.y+e.y)/2;do i.y>l!=i.next.y>l&&i.next.y!==i.y&&s<(i.next.x-i.x)*(l-i.y)/(i.next.y-i.y)+i.x&&(a=!a),i=i.next;while(i!==n);return a}function oK(n,e){const i=new $5(n.i,n.x,n.y),a=new $5(e.i,e.x,e.y),s=n.next,l=e.prev;return n.next=e,e.prev=n,i.next=s,s.prev=i,a.next=i,i.prev=a,l.next=a,a.prev=l,a}function U7(n,e,i,a){const s=new $5(n,e,i);return a?(s.next=a.next,s.prev=a,a.next.prev=s,a.next=s):(s.prev=s,s.next=s),s}function Ew(n){n.next.prev=n.prev,n.prev.next=n.next,n.prevZ&&(n.prevZ.nextZ=n.nextZ),n.nextZ&&(n.nextZ.prevZ=n.prevZ)}function $5(n,e,i){this.i=n,this.x=e,this.y=i,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function VEe(n,e,i,a){let s=0;for(let l=e,d=i-a;l<i;l+=a)s+=(n[d]-n[l])*(n[l+1]+n[d+1]),d=l;return s}class Sd{static area(e){const i=e.length;let a=0;for(let s=i-1,l=0;l<i;s=l++)a+=e[s].x*e[l].y-e[l].x*e[s].y;return a*.5}static isClockWise(e){return Sd.area(e)<0}static triangulateShape(e,i){const a=[],s=[],l=[];W7(e),V7(a,e);let d=e.length;i.forEach(W7);for(let p=0;p<i.length;p++)s.push(d),d+=i[p].length,V7(a,i[p]);const f=TEe.triangulate(a,s);for(let p=0;p<f.length;p+=3)l.push(f.slice(p,p+3));return l}}function W7(n){const e=n.length;e>2&&n[e-1].equals(n[0])&&n.pop()}function V7(n,e){for(let i=0;i<e.length;i++)n.push(e[i].x),n.push(e[i].y)}class pC extends zi{constructor(e=new Lg([new tn(.5,.5),new tn(-.5,.5),new tn(-.5,-.5),new tn(.5,-.5)]),i={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:i},e=Array.isArray(e)?e:[e];const a=this,s=[],l=[];for(let f=0,p=e.length;f<p;f++){const y=e[f];d(y)}this.setAttribute("position",new jn(s,3)),this.setAttribute("uv",new jn(l,2)),this.computeVertexNormals();function d(f){const p=[],y=i.curveSegments!==void 0?i.curveSegments:12,_=i.steps!==void 0?i.steps:1,b=i.depth!==void 0?i.depth:1;let S=i.bevelEnabled!==void 0?i.bevelEnabled:!0,A=i.bevelThickness!==void 0?i.bevelThickness:.2,P=i.bevelSize!==void 0?i.bevelSize:A-.1,L=i.bevelOffset!==void 0?i.bevelOffset:0,k=i.bevelSegments!==void 0?i.bevelSegments:3;const R=i.extrudePath,z=i.UVGenerator!==void 0?i.UVGenerator:GEe;let O,F=!1,H,$,Y,te;R&&(O=R.getSpacedPoints(_),F=!0,S=!1,H=R.computeFrenetFrames(_,!1),$=new We,Y=new We,te=new We),S||(k=0,A=0,P=0,L=0);const G=f.extractPoints(y);let Q=G.shape;const he=G.holes;if(!Sd.isClockWise(Q)){Q=Q.reverse();for(let Ie=0,pt=he.length;Ie<pt;Ie++){const gt=he[Ie];Sd.isClockWise(gt)&&(he[Ie]=gt.reverse())}}const ye=Sd.triangulateShape(Q,he),fe=Q;for(let Ie=0,pt=he.length;Ie<pt;Ie++){const gt=he[Ie];Q=Q.concat(gt)}function Ae(Ie,pt,gt){return pt||console.error("THREE.ExtrudeGeometry: vec does not exist"),Ie.clone().addScaledVector(pt,gt)}const Re=Q.length,Be=ye.length;function le(Ie,pt,gt){let _t,Ue,ue;const se=Ie.x-pt.x,xe=Ie.y-pt.y,Ye=gt.x-Ie.x,ze=gt.y-Ie.y,st=se*se+xe*xe,de=se*ze-xe*Ye;if(Math.abs(de)>Number.EPSILON){const ie=Math.sqrt(st),Oe=Math.sqrt(Ye*Ye+ze*ze),ut=pt.x-xe/ie,it=pt.y+se/ie,lt=gt.x-ze/Oe,Mt=gt.y+Ye/Oe,Ut=((lt-ut)*ze-(Mt-it)*Ye)/(se*ze-xe*Ye);_t=ut+se*Ut-Ie.x,Ue=it+xe*Ut-Ie.y;const Wt=_t*_t+Ue*Ue;if(Wt<=2)return new tn(_t,Ue);ue=Math.sqrt(Wt/2)}else{let ie=!1;se>Number.EPSILON?Ye>Number.EPSILON&&(ie=!0):se<-Number.EPSILON?Ye<-Number.EPSILON&&(ie=!0):Math.sign(xe)===Math.sign(ze)&&(ie=!0),ie?(_t=-xe,Ue=se,ue=Math.sqrt(st)):(_t=se,Ue=xe,ue=Math.sqrt(st/2))}return new tn(_t/ue,Ue/ue)}const me=[];for(let Ie=0,pt=fe.length,gt=pt-1,_t=Ie+1;Ie<pt;Ie++,gt++,_t++)gt===pt&&(gt=0),_t===pt&&(_t=0),me[Ie]=le(fe[Ie],fe[gt],fe[_t]);const we=[];let re,Te=me.concat();for(let Ie=0,pt=he.length;Ie<pt;Ie++){const gt=he[Ie];re=[];for(let _t=0,Ue=gt.length,ue=Ue-1,se=_t+1;_t<Ue;_t++,ue++,se++)ue===Ue&&(ue=0),se===Ue&&(se=0),re[_t]=le(gt[_t],gt[ue],gt[se]);we.push(re),Te=Te.concat(re)}for(let Ie=0;Ie<k;Ie++){const pt=Ie/k,gt=A*Math.cos(pt*Math.PI/2),_t=P*Math.sin(pt*Math.PI/2)+L;for(let Ue=0,ue=fe.length;Ue<ue;Ue++){const se=Ae(fe[Ue],me[Ue],_t);ct(se.x,se.y,-gt)}for(let Ue=0,ue=he.length;Ue<ue;Ue++){const se=he[Ue];re=we[Ue];for(let xe=0,Ye=se.length;xe<Ye;xe++){const ze=Ae(se[xe],re[xe],_t);ct(ze.x,ze.y,-gt)}}}const Je=P+L;for(let Ie=0;Ie<Re;Ie++){const pt=S?Ae(Q[Ie],Te[Ie],Je):Q[Ie];F?(Y.copy(H.normals[0]).multiplyScalar(pt.x),$.copy(H.binormals[0]).multiplyScalar(pt.y),te.copy(O[0]).add(Y).add($),ct(te.x,te.y,te.z)):ct(pt.x,pt.y,0)}for(let Ie=1;Ie<=_;Ie++)for(let pt=0;pt<Re;pt++){const gt=S?Ae(Q[pt],Te[pt],Je):Q[pt];F?(Y.copy(H.normals[Ie]).multiplyScalar(gt.x),$.copy(H.binormals[Ie]).multiplyScalar(gt.y),te.copy(O[Ie]).add(Y).add($),ct(te.x,te.y,te.z)):ct(gt.x,gt.y,b/_*Ie)}for(let Ie=k-1;Ie>=0;Ie--){const pt=Ie/k,gt=A*Math.cos(pt*Math.PI/2),_t=P*Math.sin(pt*Math.PI/2)+L;for(let Ue=0,ue=fe.length;Ue<ue;Ue++){const se=Ae(fe[Ue],me[Ue],_t);ct(se.x,se.y,b+gt)}for(let Ue=0,ue=he.length;Ue<ue;Ue++){const se=he[Ue];re=we[Ue];for(let xe=0,Ye=se.length;xe<Ye;xe++){const ze=Ae(se[xe],re[xe],_t);F?ct(ze.x,ze.y+O[_-1].y,O[_-1].x+gt):ct(ze.x,ze.y,b+gt)}}}Xe(),Ze();function Xe(){const Ie=s.length/3;if(S){let pt=0,gt=Re*pt;for(let _t=0;_t<Be;_t++){const Ue=ye[_t];At(Ue[2]+gt,Ue[1]+gt,Ue[0]+gt)}pt=_+k*2,gt=Re*pt;for(let _t=0;_t<Be;_t++){const Ue=ye[_t];At(Ue[0]+gt,Ue[1]+gt,Ue[2]+gt)}}else{for(let pt=0;pt<Be;pt++){const gt=ye[pt];At(gt[2],gt[1],gt[0])}for(let pt=0;pt<Be;pt++){const gt=ye[pt];At(gt[0]+Re*_,gt[1]+Re*_,gt[2]+Re*_)}}a.addGroup(Ie,s.length/3-Ie,0)}function Ze(){const Ie=s.length/3;let pt=0;Fe(fe,pt),pt+=fe.length;for(let gt=0,_t=he.length;gt<_t;gt++){const Ue=he[gt];Fe(Ue,pt),pt+=Ue.length}a.addGroup(Ie,s.length/3-Ie,1)}function Fe(Ie,pt){let gt=Ie.length;for(;--gt>=0;){const _t=gt;let Ue=gt-1;Ue<0&&(Ue=Ie.length-1);for(let ue=0,se=_+k*2;ue<se;ue++){const xe=Re*ue,Ye=Re*(ue+1),ze=pt+_t+xe,st=pt+Ue+xe,de=pt+Ue+Ye,ie=pt+_t+Ye;kt(ze,st,de,ie)}}}function ct(Ie,pt,gt){p.push(Ie),p.push(pt),p.push(gt)}function At(Ie,pt,gt){Kt(Ie),Kt(pt),Kt(gt);const _t=s.length/3,Ue=z.generateTopUV(a,s,_t-3,_t-2,_t-1);Et(Ue[0]),Et(Ue[1]),Et(Ue[2])}function kt(Ie,pt,gt,_t){Kt(Ie),Kt(pt),Kt(_t),Kt(pt),Kt(gt),Kt(_t);const Ue=s.length/3,ue=z.generateSideWallUV(a,s,Ue-6,Ue-3,Ue-2,Ue-1);Et(ue[0]),Et(ue[1]),Et(ue[3]),Et(ue[1]),Et(ue[2]),Et(ue[3])}function Kt(Ie){s.push(p[Ie*3+0]),s.push(p[Ie*3+1]),s.push(p[Ie*3+2])}function Et(Ie){l.push(Ie.x),l.push(Ie.y)}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),i=this.parameters.shapes,a=this.parameters.options;return HEe(i,a,e)}static fromJSON(e,i){const a=[];for(let l=0,d=e.shapes.length;l<d;l++){const f=i[e.shapes[l]];a.push(f)}const s=e.options.extrudePath;return s!==void 0&&(e.options.extrudePath=new _T[s.type]().fromJSON(s)),new pC(a,e.options)}}const GEe={generateTopUV:function(n,e,i,a,s){const l=e[i*3],d=e[i*3+1],f=e[a*3],p=e[a*3+1],y=e[s*3],_=e[s*3+1];return[new tn(l,d),new tn(f,p),new tn(y,_)]},generateSideWallUV:function(n,e,i,a,s,l){const d=e[i*3],f=e[i*3+1],p=e[i*3+2],y=e[a*3],_=e[a*3+1],b=e[a*3+2],S=e[s*3],A=e[s*3+1],P=e[s*3+2],L=e[l*3],k=e[l*3+1],R=e[l*3+2];return Math.abs(f-_)<Math.abs(d-y)?[new tn(d,1-p),new tn(y,1-b),new tn(S,1-P),new tn(L,1-R)]:[new tn(f,1-p),new tn(_,1-b),new tn(A,1-P),new tn(k,1-R)]}};function HEe(n,e,i){if(i.shapes=[],Array.isArray(n))for(let a=0,s=n.length;a<s;a++){const l=n[a];i.shapes.push(l.uuid)}else i.shapes.push(n.uuid);return i.options=Object.assign({},e),e.extrudePath!==void 0&&(i.options.extrudePath=e.extrudePath.toJSON()),i}class mC extends Bp{constructor(e=1,i=0){const a=(1+Math.sqrt(5))/2,s=[-1,a,0,1,a,0,-1,-a,0,1,-a,0,0,-1,a,0,1,a,0,-1,-a,0,1,-a,a,0,-1,a,0,1,-a,0,-1,-a,0,1],l=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(s,l,e,i),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:i}}static fromJSON(e){return new mC(e.radius,e.detail)}}class aS extends Bp{constructor(e=1,i=0){const a=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],s=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];super(a,s,e,i),this.type="OctahedronGeometry",this.parameters={radius:e,detail:i}}static fromJSON(e){return new aS(e.radius,e.detail)}}class gC extends zi{constructor(e=.5,i=1,a=32,s=1,l=0,d=Math.PI*2){super(),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:i,thetaSegments:a,phiSegments:s,thetaStart:l,thetaLength:d},a=Math.max(3,a),s=Math.max(1,s);const f=[],p=[],y=[],_=[];let b=e;const S=(i-e)/s,A=new We,P=new tn;for(let L=0;L<=s;L++){for(let k=0;k<=a;k++){const R=l+k/a*d;A.x=b*Math.cos(R),A.y=b*Math.sin(R),p.push(A.x,A.y,A.z),y.push(0,0,1),P.x=(A.x/i+1)/2,P.y=(A.y/i+1)/2,_.push(P.x,P.y)}b+=S}for(let L=0;L<s;L++){const k=L*(a+1);for(let R=0;R<a;R++){const z=R+k,O=z,F=z+a+1,H=z+a+2,$=z+1;f.push(O,F,$),f.push(F,H,$)}}this.setIndex(f),this.setAttribute("position",new jn(p,3)),this.setAttribute("normal",new jn(y,3)),this.setAttribute("uv",new jn(_,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new gC(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}}class yC extends zi{constructor(e=new Lg([new tn(0,.5),new tn(-.5,-.5),new tn(.5,-.5)]),i=12){super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:i};const a=[],s=[],l=[],d=[];let f=0,p=0;if(Array.isArray(e)===!1)y(e);else for(let _=0;_<e.length;_++)y(e[_]),this.addGroup(f,p,_),f+=p,p=0;this.setIndex(a),this.setAttribute("position",new jn(s,3)),this.setAttribute("normal",new jn(l,3)),this.setAttribute("uv",new jn(d,2));function y(_){const b=s.length/3,S=_.extractPoints(i);let A=S.shape;const P=S.holes;Sd.isClockWise(A)===!1&&(A=A.reverse());for(let k=0,R=P.length;k<R;k++){const z=P[k];Sd.isClockWise(z)===!0&&(P[k]=z.reverse())}const L=Sd.triangulateShape(A,P);for(let k=0,R=P.length;k<R;k++){const z=P[k];A=A.concat(z)}for(let k=0,R=A.length;k<R;k++){const z=A[k];s.push(z.x,z.y,0),l.push(0,0,1),d.push(z.x,z.y)}for(let k=0,R=L.length;k<R;k++){const z=L[k],O=z[0]+b,F=z[1]+b,H=z[2]+b;a.push(O,F,H),p+=3}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),i=this.parameters.shapes;return jEe(i,e)}static fromJSON(e,i){const a=[];for(let s=0,l=e.shapes.length;s<l;s++){const d=i[e.shapes[s]];a.push(d)}return new yC(a,e.curveSegments)}}function jEe(n,e){if(e.shapes=[],Array.isArray(n))for(let i=0,a=n.length;i<a;i++){const s=n[i];e.shapes.push(s.uuid)}else e.shapes.push(n.uuid);return e}class oS extends zi{constructor(e=1,i=32,a=16,s=0,l=Math.PI*2,d=0,f=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:i,heightSegments:a,phiStart:s,phiLength:l,thetaStart:d,thetaLength:f},i=Math.max(3,Math.floor(i)),a=Math.max(2,Math.floor(a));const p=Math.min(d+f,Math.PI);let y=0;const _=[],b=new We,S=new We,A=[],P=[],L=[],k=[];for(let R=0;R<=a;R++){const z=[],O=R/a;let F=0;R===0&&d===0?F=.5/i:R===a&&p===Math.PI&&(F=-.5/i);for(let H=0;H<=i;H++){const $=H/i;b.x=-e*Math.cos(s+$*l)*Math.sin(d+O*f),b.y=e*Math.cos(d+O*f),b.z=e*Math.sin(s+$*l)*Math.sin(d+O*f),P.push(b.x,b.y,b.z),S.copy(b).normalize(),L.push(S.x,S.y,S.z),k.push($+F,1-O),z.push(y++)}_.push(z)}for(let R=0;R<a;R++)for(let z=0;z<i;z++){const O=_[R][z+1],F=_[R][z],H=_[R+1][z],$=_[R+1][z+1];(R!==0||d>0)&&A.push(O,F,$),(R!==a-1||p<Math.PI)&&A.push(F,H,$)}this.setIndex(A),this.setAttribute("position",new jn(P,3)),this.setAttribute("normal",new jn(L,3)),this.setAttribute("uv",new jn(k,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new oS(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class vC extends Bp{constructor(e=1,i=0){const a=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],s=[2,1,0,0,3,2,1,3,0,2,3,1];super(a,s,e,i),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:i}}static fromJSON(e){return new vC(e.radius,e.detail)}}class _C extends zi{constructor(e=1,i=.4,a=12,s=48,l=Math.PI*2){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:i,radialSegments:a,tubularSegments:s,arc:l},a=Math.floor(a),s=Math.floor(s);const d=[],f=[],p=[],y=[],_=new We,b=new We,S=new We;for(let A=0;A<=a;A++)for(let P=0;P<=s;P++){const L=P/s*l,k=A/a*Math.PI*2;b.x=(e+i*Math.cos(k))*Math.cos(L),b.y=(e+i*Math.cos(k))*Math.sin(L),b.z=i*Math.sin(k),f.push(b.x,b.y,b.z),_.x=e*Math.cos(L),_.y=e*Math.sin(L),S.subVectors(b,_).normalize(),p.push(S.x,S.y,S.z),y.push(P/s),y.push(A/a)}for(let A=1;A<=a;A++)for(let P=1;P<=s;P++){const L=(s+1)*A+P-1,k=(s+1)*(A-1)+P-1,R=(s+1)*(A-1)+P,z=(s+1)*A+P;d.push(L,k,z),d.push(k,R,z)}this.setIndex(d),this.setAttribute("position",new jn(f,3)),this.setAttribute("normal",new jn(p,3)),this.setAttribute("uv",new jn(y,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new _C(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class xC extends zi{constructor(e=1,i=.4,a=64,s=8,l=2,d=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:i,tubularSegments:a,radialSegments:s,p:l,q:d},a=Math.floor(a),s=Math.floor(s);const f=[],p=[],y=[],_=[],b=new We,S=new We,A=new We,P=new We,L=new We,k=new We,R=new We;for(let O=0;O<=a;++O){const F=O/a*l*Math.PI*2;z(F,l,d,e,A),z(F+.01,l,d,e,P),k.subVectors(P,A),R.addVectors(P,A),L.crossVectors(k,R),R.crossVectors(L,k),L.normalize(),R.normalize();for(let H=0;H<=s;++H){const $=H/s*Math.PI*2,Y=-i*Math.cos($),te=i*Math.sin($);b.x=A.x+(Y*R.x+te*L.x),b.y=A.y+(Y*R.y+te*L.y),b.z=A.z+(Y*R.z+te*L.z),p.push(b.x,b.y,b.z),S.subVectors(b,A).normalize(),y.push(S.x,S.y,S.z),_.push(O/a),_.push(H/s)}}for(let O=1;O<=a;O++)for(let F=1;F<=s;F++){const H=(s+1)*(O-1)+(F-1),$=(s+1)*O+(F-1),Y=(s+1)*O+F,te=(s+1)*(O-1)+F;f.push(H,$,te),f.push($,Y,te)}this.setIndex(f),this.setAttribute("position",new jn(p,3)),this.setAttribute("normal",new jn(y,3)),this.setAttribute("uv",new jn(_,2));function z(O,F,H,$,Y){const te=Math.cos(O),G=Math.sin(O),Q=H/F*O,he=Math.cos(Q);Y.x=$*(2+he)*.5*te,Y.y=$*(2+he)*G*.5,Y.z=$*Math.sin(Q)*.5}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new xC(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}}class bC extends zi{constructor(e=new Oz(new We(-1,-1,0),new We(-1,1,0),new We(1,1,0)),i=64,a=1,s=8,l=!1){super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:i,radius:a,radialSegments:s,closed:l};const d=e.computeFrenetFrames(i,l);this.tangents=d.tangents,this.normals=d.normals,this.binormals=d.binormals;const f=new We,p=new We,y=new tn;let _=new We;const b=[],S=[],A=[],P=[];L(),this.setIndex(P),this.setAttribute("position",new jn(b,3)),this.setAttribute("normal",new jn(S,3)),this.setAttribute("uv",new jn(A,2));function L(){for(let O=0;O<i;O++)k(O);k(l===!1?i:0),z(),R()}function k(O){_=e.getPointAt(O/i,_);const F=d.normals[O],H=d.binormals[O];for(let $=0;$<=s;$++){const Y=$/s*Math.PI*2,te=Math.sin(Y),G=-Math.cos(Y);p.x=G*F.x+te*H.x,p.y=G*F.y+te*H.y,p.z=G*F.z+te*H.z,p.normalize(),S.push(p.x,p.y,p.z),f.x=_.x+a*p.x,f.y=_.y+a*p.y,f.z=_.z+a*p.z,b.push(f.x,f.y,f.z)}}function R(){for(let O=1;O<=i;O++)for(let F=1;F<=s;F++){const H=(s+1)*(O-1)+(F-1),$=(s+1)*O+(F-1),Y=(s+1)*O+F,te=(s+1)*(O-1)+F;P.push(H,$,te),P.push($,Y,te)}}function z(){for(let O=0;O<=i;O++)for(let F=0;F<=s;F++)y.x=O/i,y.y=F/s,A.push(y.x,y.y)}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new bC(new _T[e.path.type]().fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}class sK extends zi{constructor(e=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:e},e!==null){const i=[],a=new Set,s=new We,l=new We;if(e.index!==null){const d=e.attributes.position,f=e.index;let p=e.groups;p.length===0&&(p=[{start:0,count:f.count,materialIndex:0}]);for(let y=0,_=p.length;y<_;++y){const b=p[y],S=b.start,A=b.count;for(let P=S,L=S+A;P<L;P+=3)for(let k=0;k<3;k++){const R=f.getX(P+k),z=f.getX(P+(k+1)%3);s.fromBufferAttribute(d,R),l.fromBufferAttribute(d,z),G7(s,l,a)===!0&&(i.push(s.x,s.y,s.z),i.push(l.x,l.y,l.z))}}}else{const d=e.attributes.position;for(let f=0,p=d.count/3;f<p;f++)for(let y=0;y<3;y++){const _=3*f+y,b=3*f+(y+1)%3;s.fromBufferAttribute(d,_),l.fromBufferAttribute(d,b),G7(s,l,a)===!0&&(i.push(s.x,s.y,s.z),i.push(l.x,l.y,l.z))}}this.setAttribute("position",new jn(i,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}function G7(n,e,i){const a=`${n.x},${n.y},${n.z}-${e.x},${e.y},${e.z}`,s=`${e.x},${e.y},${e.z}-${n.x},${n.y},${n.z}`;return i.has(a)===!0||i.has(s)===!0?!1:(i.add(a),i.add(s),!0)}var H7=Object.freeze({__proto__:null,BoxGeometry:ry,CapsuleGeometry:cC,CircleGeometry:uC,ConeGeometry:dC,CylinderGeometry:k_,DodecahedronGeometry:hC,EdgesGeometry:iK,ExtrudeGeometry:pC,IcosahedronGeometry:mC,LatheGeometry:rS,OctahedronGeometry:aS,PlaneGeometry:Fp,PolyhedronGeometry:Bp,RingGeometry:gC,ShapeGeometry:yC,SphereGeometry:oS,TetrahedronGeometry:vC,TorusGeometry:_C,TorusKnotGeometry:xC,TubeGeometry:bC,WireframeGeometry:sK});class lK extends rs{constructor(e){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new In(0),this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.fog=e.fog,this}}class cK extends Pd{constructor(e){super(e),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class Fz extends rs{constructor(e){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new In(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new In(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Np,this.normalScale=new tn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class uK extends Fz{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new tn(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return Xa(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(i){this.ior=(1+.4*i)/(1-.4*i)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new In(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new In(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new In(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class dK extends rs{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new In(16777215),this.specular=new In(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new In(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Np,this.normalScale=new tn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Qw,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class hK extends rs{constructor(e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new In(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new In(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Np,this.normalScale=new tn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}class fK extends rs{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Np,this.normalScale=new tn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}class pK extends rs{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new In(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new In(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Np,this.normalScale=new tn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Qw,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class mK extends rs{constructor(e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new In(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Np,this.normalScale=new tn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this.fog=e.fog,this}}class gK extends Ks{constructor(e){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}function wg(n,e,i){return!n||!i&&n.constructor===e?n:typeof e.BYTES_PER_ELEMENT=="number"?new e(n):Array.prototype.slice.call(n)}function yK(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)}function vK(n){function e(s,l){return n[s]-n[l]}const i=n.length,a=new Array(i);for(let s=0;s!==i;++s)a[s]=s;return a.sort(e),a}function Y5(n,e,i){const a=n.length,s=new n.constructor(a);for(let l=0,d=0;d!==a;++l){const f=i[l]*e;for(let p=0;p!==e;++p)s[d++]=n[f+p]}return s}function Bz(n,e,i,a){let s=1,l=n[0];for(;l!==void 0&&l[a]===void 0;)l=n[s++];if(l===void 0)return;let d=l[a];if(d!==void 0)if(Array.isArray(d))do d=l[a],d!==void 0&&(e.push(l.time),i.push.apply(i,d)),l=n[s++];while(l!==void 0);else if(d.toArray!==void 0)do d=l[a],d!==void 0&&(e.push(l.time),d.toArray(i,i.length)),l=n[s++];while(l!==void 0);else do d=l[a],d!==void 0&&(e.push(l.time),i.push(d)),l=n[s++];while(l!==void 0)}function $Ee(n,e,i,a,s=30){const l=n.clone();l.name=e;const d=[];for(let p=0;p<l.tracks.length;++p){const y=l.tracks[p],_=y.getValueSize(),b=[],S=[];for(let A=0;A<y.times.length;++A){const P=y.times[A]*s;if(!(P<i||P>=a)){b.push(y.times[A]);for(let L=0;L<_;++L)S.push(y.values[A*_+L])}}b.length!==0&&(y.times=wg(b,y.times.constructor),y.values=wg(S,y.values.constructor),d.push(y))}l.tracks=d;let f=1/0;for(let p=0;p<l.tracks.length;++p)f>l.tracks[p].times[0]&&(f=l.tracks[p].times[0]);for(let p=0;p<l.tracks.length;++p)l.tracks[p].shift(-1*f);return l.resetDuration(),l}function YEe(n,e=0,i=n,a=30){a<=0&&(a=30);const s=i.tracks.length,l=e/a;for(let d=0;d<s;++d){const f=i.tracks[d],p=f.ValueTypeName;if(p==="bool"||p==="string")continue;const y=n.tracks.find(function(R){return R.name===f.name&&R.ValueTypeName===p});if(y===void 0)continue;let _=0;const b=f.getValueSize();f.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(_=b/3);let S=0;const A=y.getValueSize();y.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(S=A/3);const P=f.times.length-1;let L;if(l<=f.times[0]){const R=_,z=b-_;L=f.values.slice(R,z)}else if(l>=f.times[P]){const R=P*b+_,z=R+b-_;L=f.values.slice(R,z)}else{const R=f.createInterpolant(),z=_,O=b-_;R.evaluate(l),L=R.resultBuffer.slice(z,O)}p==="quaternion"&&new As().fromArray(L).normalize().conjugate().toArray(L);const k=y.times.length;for(let R=0;R<k;++R){const z=R*A+S;if(p==="quaternion")As.multiplyQuaternionsFlat(y.values,z,L,0,y.values,z);else{const O=A-S*2;for(let F=0;F<O;++F)y.values[z+F]-=L[F]}}}return n.blendMode=vz,n}const qEe={convertArray:wg,isTypedArray:yK,getKeyframeOrder:vK,sortedArray:Y5,flattenJSON:Bz,subclip:$Ee,makeClipAdditive:YEe};class sS{constructor(e,i,a,s){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=s!==void 0?s:new i.constructor(a),this.sampleValues=i,this.valueSize=a,this.settings=null,this.DefaultSettings_={}}evaluate(e){const i=this.parameterPositions;let a=this._cachedIndex,s=i[a],l=i[a-1];e:{t:{let d;n:{i:if(!(e<s)){for(let f=a+2;;){if(s===void 0){if(e<l)break i;return a=i.length,this._cachedIndex=a,this.copySampleValue_(a-1)}if(a===f)break;if(l=s,s=i[++a],e<s)break t}d=i.length;break n}if(!(e>=l)){const f=i[1];e<f&&(a=2,l=f);for(let p=a-2;;){if(l===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(a===p)break;if(s=l,l=i[--a-1],e>=l)break t}d=a,a=0;break n}break e}for(;a<d;){const f=a+d>>>1;e<i[f]?d=f:a=f+1}if(s=i[a],l=i[a-1],l===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(s===void 0)return a=i.length,this._cachedIndex=a,this.copySampleValue_(a-1)}this._cachedIndex=a,this.intervalChanged_(a,l,s)}return this.interpolate_(a,l,e,s)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const i=this.resultBuffer,a=this.sampleValues,s=this.valueSize,l=e*s;for(let d=0;d!==s;++d)i[d]=a[l+d];return i}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class _K extends sS{constructor(e,i,a,s){super(e,i,a,s),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:_g,endingEnd:_g}}intervalChanged_(e,i,a){const s=this.parameterPositions;let l=e-2,d=e+1,f=s[l],p=s[d];if(f===void 0)switch(this.getSettings_().endingStart){case xg:l=e,f=2*i-a;break;case pw:l=s.length-2,f=i+s[l]-s[l+1];break;default:l=e,f=a}if(p===void 0)switch(this.getSettings_().endingEnd){case xg:d=e,p=2*a-i;break;case pw:d=1,p=a+s[1]-s[0];break;default:d=e-1,p=i}const y=(a-i)*.5,_=this.valueSize;this._weightPrev=y/(i-f),this._weightNext=y/(p-a),this._offsetPrev=l*_,this._offsetNext=d*_}interpolate_(e,i,a,s){const l=this.resultBuffer,d=this.sampleValues,f=this.valueSize,p=e*f,y=p-f,_=this._offsetPrev,b=this._offsetNext,S=this._weightPrev,A=this._weightNext,P=(a-i)/(s-i),L=P*P,k=L*P,R=-S*k+2*S*L-S*P,z=(1+S)*k+(-1.5-2*S)*L+(-.5+S)*P+1,O=(-1-A)*k+(1.5+A)*L+.5*P,F=A*k-A*L;for(let H=0;H!==f;++H)l[H]=R*d[_+H]+z*d[y+H]+O*d[p+H]+F*d[b+H];return l}}class Uz extends sS{constructor(e,i,a,s){super(e,i,a,s)}interpolate_(e,i,a,s){const l=this.resultBuffer,d=this.sampleValues,f=this.valueSize,p=e*f,y=p-f,_=(a-i)/(s-i),b=1-_;for(let S=0;S!==f;++S)l[S]=d[y+S]*b+d[p+S]*_;return l}}class xK extends sS{constructor(e,i,a,s){super(e,i,a,s)}interpolate_(e){return this.copySampleValue_(e-1)}}class Mu{constructor(e,i,a,s){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(i===void 0||i.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=wg(i,this.TimeBufferType),this.values=wg(a,this.ValueBufferType),this.setInterpolation(s||this.DefaultInterpolation)}static toJSON(e){const i=e.constructor;let a;if(i.toJSON!==this.toJSON)a=i.toJSON(e);else{a={name:e.name,times:wg(e.times,Array),values:wg(e.values,Array)};const s=e.getInterpolation();s!==e.DefaultInterpolation&&(a.interpolation=s)}return a.type=e.ValueTypeName,a}InterpolantFactoryMethodDiscrete(e){return new xK(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new Uz(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new _K(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let i;switch(e){case hw:i=this.InterpolantFactoryMethodDiscrete;break;case fw:i=this.InterpolantFactoryMethodLinear;break;case vM:i=this.InterpolantFactoryMethodSmooth;break}if(i===void 0){const a="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(a);return console.warn("THREE.KeyframeTrack:",a),this}return this.createInterpolant=i,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return hw;case this.InterpolantFactoryMethodLinear:return fw;case this.InterpolantFactoryMethodSmooth:return vM}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){const i=this.times;for(let a=0,s=i.length;a!==s;++a)i[a]+=e}return this}scale(e){if(e!==1){const i=this.times;for(let a=0,s=i.length;a!==s;++a)i[a]*=e}return this}trim(e,i){const a=this.times,s=a.length;let l=0,d=s-1;for(;l!==s&&a[l]<e;)++l;for(;d!==-1&&a[d]>i;)--d;if(++d,l!==0||d!==s){l>=d&&(d=Math.max(d,1),l=d-1);const f=this.getValueSize();this.times=a.slice(l,d),this.values=this.values.slice(l*f,d*f)}return this}validate(){let e=!0;const i=this.getValueSize();i-Math.floor(i)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const a=this.times,s=this.values,l=a.length;l===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let d=null;for(let f=0;f!==l;f++){const p=a[f];if(typeof p=="number"&&isNaN(p)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,f,p),e=!1;break}if(d!==null&&d>p){console.error("THREE.KeyframeTrack: Out of order keys.",this,f,p,d),e=!1;break}d=p}if(s!==void 0&&yK(s))for(let f=0,p=s.length;f!==p;++f){const y=s[f];if(isNaN(y)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,f,y),e=!1;break}}return e}optimize(){const e=this.times.slice(),i=this.values.slice(),a=this.getValueSize(),s=this.getInterpolation()===vM,l=e.length-1;let d=1;for(let f=1;f<l;++f){let p=!1;const y=e[f],_=e[f+1];if(y!==_&&(f!==1||y!==e[0]))if(s)p=!0;else{const b=f*a,S=b-a,A=b+a;for(let P=0;P!==a;++P){const L=i[b+P];if(L!==i[S+P]||L!==i[A+P]){p=!0;break}}}if(p){if(f!==d){e[d]=e[f];const b=f*a,S=d*a;for(let A=0;A!==a;++A)i[S+A]=i[b+A]}++d}}if(l>0){e[d]=e[l];for(let f=l*a,p=d*a,y=0;y!==a;++y)i[p+y]=i[f+y];++d}return d!==e.length?(this.times=e.slice(0,d),this.values=i.slice(0,d*a)):(this.times=e,this.values=i),this}clone(){const e=this.times.slice(),i=this.values.slice(),a=this.constructor,s=new a(this.name,e,i);return s.createInterpolant=this.createInterpolant,s}}Mu.prototype.TimeBufferType=Float32Array;Mu.prototype.ValueBufferType=Float32Array;Mu.prototype.DefaultInterpolation=fw;class ay extends Mu{}ay.prototype.ValueTypeName="bool";ay.prototype.ValueBufferType=Array;ay.prototype.DefaultInterpolation=hw;ay.prototype.InterpolantFactoryMethodLinear=void 0;ay.prototype.InterpolantFactoryMethodSmooth=void 0;class Wz extends Mu{}Wz.prototype.ValueTypeName="color";class Mw extends Mu{}Mw.prototype.ValueTypeName="number";class bK extends sS{constructor(e,i,a,s){super(e,i,a,s)}interpolate_(e,i,a,s){const l=this.resultBuffer,d=this.sampleValues,f=this.valueSize,p=(a-i)/(s-i);let y=e*f;for(let _=y+f;y!==_;y+=4)As.slerpFlat(l,0,d,y-f,d,y,p);return l}}class D_ extends Mu{InterpolantFactoryMethodLinear(e){return new bK(this.times,this.values,this.getValueSize(),e)}}D_.prototype.ValueTypeName="quaternion";D_.prototype.DefaultInterpolation=fw;D_.prototype.InterpolantFactoryMethodSmooth=void 0;class oy extends Mu{}oy.prototype.ValueTypeName="string";oy.prototype.ValueBufferType=Array;oy.prototype.DefaultInterpolation=hw;oy.prototype.InterpolantFactoryMethodLinear=void 0;oy.prototype.InterpolantFactoryMethodSmooth=void 0;class Tw extends Mu{}Tw.prototype.ValueTypeName="vector";class Aw{constructor(e,i=-1,a,s=ZA){this.name=e,this.tracks=a,this.duration=i,this.blendMode=s,this.uuid=tc(),this.duration<0&&this.resetDuration()}static parse(e){const i=[],a=e.tracks,s=1/(e.fps||1);for(let d=0,f=a.length;d!==f;++d)i.push(ZEe(a[d]).scale(s));const l=new this(e.name,e.duration,i,e.blendMode);return l.uuid=e.uuid,l}static toJSON(e){const i=[],a=e.tracks,s={name:e.name,duration:e.duration,tracks:i,uuid:e.uuid,blendMode:e.blendMode};for(let l=0,d=a.length;l!==d;++l)i.push(Mu.toJSON(a[l]));return s}static CreateFromMorphTargetSequence(e,i,a,s){const l=i.length,d=[];for(let f=0;f<l;f++){let p=[],y=[];p.push((f+l-1)%l,f,(f+1)%l),y.push(0,1,0);const _=vK(p);p=Y5(p,1,_),y=Y5(y,1,_),!s&&p[0]===0&&(p.push(l),y.push(y[0])),d.push(new Mw(".morphTargetInfluences["+i[f].name+"]",p,y).scale(1/a))}return new this(e,-1,d)}static findByName(e,i){let a=e;if(!Array.isArray(e)){const s=e;a=s.geometry&&s.geometry.animations||s.animations}for(let s=0;s<a.length;s++)if(a[s].name===i)return a[s];return null}static CreateClipsFromMorphTargetSequences(e,i,a){const s={},l=/^([\w-]*?)([\d]+)$/;for(let f=0,p=e.length;f<p;f++){const y=e[f],_=y.name.match(l);if(_&&_.length>1){const b=_[1];let S=s[b];S||(s[b]=S=[]),S.push(y)}}const d=[];for(const f in s)d.push(this.CreateFromMorphTargetSequence(f,s[f],i,a));return d}static parseAnimation(e,i){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const a=function(b,S,A,P,L){if(A.length!==0){const k=[],R=[];Bz(A,k,R,P),k.length!==0&&L.push(new b(S,k,R))}},s=[],l=e.name||"default",d=e.fps||30,f=e.blendMode;let p=e.length||-1;const y=e.hierarchy||[];for(let b=0;b<y.length;b++){const S=y[b].keys;if(!(!S||S.length===0))if(S[0].morphTargets){const A={};let P;for(P=0;P<S.length;P++)if(S[P].morphTargets)for(let L=0;L<S[P].morphTargets.length;L++)A[S[P].morphTargets[L]]=-1;for(const L in A){const k=[],R=[];for(let z=0;z!==S[P].morphTargets.length;++z){const O=S[P];k.push(O.time),R.push(O.morphTarget===L?1:0)}s.push(new Mw(".morphTargetInfluence["+L+"]",k,R))}p=A.length*d}else{const A=".bones["+i[b].name+"]";a(Tw,A+".position",S,"pos",s),a(D_,A+".quaternion",S,"rot",s),a(Tw,A+".scale",S,"scl",s)}}return s.length===0?null:new this(l,p,s,f)}resetDuration(){const e=this.tracks;let i=0;for(let a=0,s=e.length;a!==s;++a){const l=this.tracks[a];i=Math.max(i,l.times[l.times.length-1])}return this.duration=i,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let i=0;i<this.tracks.length;i++)e=e&&this.tracks[i].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let i=0;i<this.tracks.length;i++)e.push(this.tracks[i].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function XEe(n){switch(n.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Mw;case"vector":case"vector2":case"vector3":case"vector4":return Tw;case"color":return Wz;case"quaternion":return D_;case"bool":case"boolean":return ay;case"string":return oy}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+n)}function ZEe(n){if(n.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=XEe(n.type);if(n.times===void 0){const i=[],a=[];Bz(n.keys,i,a,"value"),n.times=i,n.values=a}return e.parse!==void 0?e.parse(n):new e(n.name,n.times,n.values,n.interpolation)}const Xg={enabled:!1,files:{},add:function(n,e){this.enabled!==!1&&(this.files[n]=e)},get:function(n){if(this.enabled!==!1)return this.files[n]},remove:function(n){delete this.files[n]},clear:function(){this.files={}}};class Vz{constructor(e,i,a){const s=this;let l=!1,d=0,f=0,p;const y=[];this.onStart=void 0,this.onLoad=e,this.onProgress=i,this.onError=a,this.itemStart=function(_){f++,l===!1&&s.onStart!==void 0&&s.onStart(_,d,f),l=!0},this.itemEnd=function(_){d++,s.onProgress!==void 0&&s.onProgress(_,d,f),d===f&&(l=!1,s.onLoad!==void 0&&s.onLoad())},this.itemError=function(_){s.onError!==void 0&&s.onError(_)},this.resolveURL=function(_){return p?p(_):_},this.setURLModifier=function(_){return p=_,this},this.addHandler=function(_,b){return y.push(_,b),this},this.removeHandler=function(_){const b=y.indexOf(_);return b!==-1&&y.splice(b,2),this},this.getHandler=function(_){for(let b=0,S=y.length;b<S;b+=2){const A=y[b],P=y[b+1];if(A.global&&(A.lastIndex=0),A.test(_))return P}return null}}}const wK=new Vz;class Il{constructor(e){this.manager=e!==void 0?e:wK,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,i){const a=this;return new Promise(function(s,l){a.load(e,s,i,l)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}Il.DEFAULT_MATERIAL_NAME="__DEFAULT";const wh={};class KEe extends Error{constructor(e,i){super(e),this.response=i}}class qh extends Il{constructor(e){super(e)}load(e,i,a,s){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const l=Xg.get(e);if(l!==void 0)return this.manager.itemStart(e),setTimeout(()=>{i&&i(l),this.manager.itemEnd(e)},0),l;if(wh[e]!==void 0){wh[e].push({onLoad:i,onProgress:a,onError:s});return}wh[e]=[],wh[e].push({onLoad:i,onProgress:a,onError:s});const d=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),f=this.mimeType,p=this.responseType;fetch(d).then(y=>{if(y.status===200||y.status===0){if(y.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||y.body===void 0||y.body.getReader===void 0)return y;const _=wh[e],b=y.body.getReader(),S=y.headers.get("Content-Length")||y.headers.get("X-File-Size"),A=S?parseInt(S):0,P=A!==0;let L=0;const k=new ReadableStream({start(R){z();function z(){b.read().then(({done:O,value:F})=>{if(O)R.close();else{L+=F.byteLength;const H=new ProgressEvent("progress",{lengthComputable:P,loaded:L,total:A});for(let $=0,Y=_.length;$<Y;$++){const te=_[$];te.onProgress&&te.onProgress(H)}R.enqueue(F),z()}})}}});return new Response(k)}else throw new KEe(`fetch for "${y.url}" responded with ${y.status}: ${y.statusText}`,y)}).then(y=>{switch(p){case"arraybuffer":return y.arrayBuffer();case"blob":return y.blob();case"document":return y.text().then(_=>new DOMParser().parseFromString(_,f));case"json":return y.json();default:if(f===void 0)return y.text();{const b=/charset="?([^;"\s]*)"?/i.exec(f),S=b&&b[1]?b[1].toLowerCase():void 0,A=new TextDecoder(S);return y.arrayBuffer().then(P=>A.decode(P))}}}).then(y=>{Xg.add(e,y);const _=wh[e];delete wh[e];for(let b=0,S=_.length;b<S;b++){const A=_[b];A.onLoad&&A.onLoad(y)}}).catch(y=>{const _=wh[e];if(_===void 0)throw this.manager.itemError(e),y;delete wh[e];for(let b=0,S=_.length;b<S;b++){const A=_[b];A.onError&&A.onError(y)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class JEe extends Il{constructor(e){super(e)}load(e,i,a,s){const l=this,d=new qh(this.manager);d.setPath(this.path),d.setRequestHeader(this.requestHeader),d.setWithCredentials(this.withCredentials),d.load(e,function(f){try{i(l.parse(JSON.parse(f)))}catch(p){s?s(p):console.error(p),l.manager.itemError(e)}},a,s)}parse(e){const i=[];for(let a=0;a<e.length;a++){const s=Aw.parse(e[a]);i.push(s)}return i}}class QEe extends Il{constructor(e){super(e)}load(e,i,a,s){const l=this,d=[],f=new sC,p=new qh(this.manager);p.setPath(this.path),p.setResponseType("arraybuffer"),p.setRequestHeader(this.requestHeader),p.setWithCredentials(l.withCredentials);let y=0;function _(b){p.load(e[b],function(S){const A=l.parse(S,!0);d[b]={width:A.width,height:A.height,format:A.format,mipmaps:A.mipmaps},y+=1,y===6&&(A.mipmapCount===1&&(f.minFilter=ka),f.image=d,f.format=A.format,f.needsUpdate=!0,i&&i(f))},a,s)}if(Array.isArray(e))for(let b=0,S=e.length;b<S;++b)_(b);else p.load(e,function(b){const S=l.parse(b,!0);if(S.isCubemap){const A=S.mipmaps.length/S.mipmapCount;for(let P=0;P<A;P++){d[P]={mipmaps:[]};for(let L=0;L<S.mipmapCount;L++)d[P].mipmaps.push(S.mipmaps[P*S.mipmapCount+L]),d[P].format=S.format,d[P].width=S.width,d[P].height=S.height}f.image=d}else f.image.width=S.width,f.image.height=S.height,f.mipmaps=S.mipmaps;S.mipmapCount===1&&(f.minFilter=ka),f.format=S.format,f.needsUpdate=!0,i&&i(f)},a,s);return f}}class Cw extends Il{constructor(e){super(e)}load(e,i,a,s){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const l=this,d=Xg.get(e);if(d!==void 0)return l.manager.itemStart(e),setTimeout(function(){i&&i(d),l.manager.itemEnd(e)},0),d;const f=xw("img");function p(){_(),Xg.add(e,this),i&&i(this),l.manager.itemEnd(e)}function y(b){_(),s&&s(b),l.manager.itemError(e),l.manager.itemEnd(e)}function _(){f.removeEventListener("load",p,!1),f.removeEventListener("error",y,!1)}return f.addEventListener("load",p,!1),f.addEventListener("error",y,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(f.crossOrigin=this.crossOrigin),l.manager.itemStart(e),f.src=e,f}}class eMe extends Il{constructor(e){super(e)}load(e,i,a,s){const l=new iS;l.colorSpace=Lo;const d=new Cw(this.manager);d.setCrossOrigin(this.crossOrigin),d.setPath(this.path);let f=0;function p(y){d.load(e[y],function(_){l.images[y]=_,f++,f===6&&(l.needsUpdate=!0,i&&i(l))},void 0,s)}for(let y=0;y<e.length;++y)p(y);return l}}class tMe extends Il{constructor(e){super(e)}load(e,i,a,s){const l=this,d=new J0,f=new qh(this.manager);return f.setResponseType("arraybuffer"),f.setRequestHeader(this.requestHeader),f.setPath(this.path),f.setWithCredentials(l.withCredentials),f.load(e,function(p){let y;try{y=l.parse(p)}catch(_){if(s!==void 0)s(_);else{console.error(_);return}}y.image!==void 0?d.image=y.image:y.data!==void 0&&(d.image.width=y.width,d.image.height=y.height,d.image.data=y.data),d.wrapS=y.wrapS!==void 0?y.wrapS:Ss,d.wrapT=y.wrapT!==void 0?y.wrapT:Ss,d.magFilter=y.magFilter!==void 0?y.magFilter:ka,d.minFilter=y.minFilter!==void 0?y.minFilter:ka,d.anisotropy=y.anisotropy!==void 0?y.anisotropy:1,y.colorSpace!==void 0?d.colorSpace=y.colorSpace:y.encoding!==void 0&&(d.encoding=y.encoding),y.flipY!==void 0&&(d.flipY=y.flipY),y.format!==void 0&&(d.format=y.format),y.type!==void 0&&(d.type=y.type),y.mipmaps!==void 0&&(d.mipmaps=y.mipmaps,d.minFilter=Cp),y.mipmapCount===1&&(d.minFilter=ka),y.generateMipmaps!==void 0&&(d.generateMipmaps=y.generateMipmaps),d.needsUpdate=!0,i&&i(d,y)},a,s),d}}class SK extends Il{constructor(e){super(e)}load(e,i,a,s){const l=new Oa,d=new Cw(this.manager);return d.setCrossOrigin(this.crossOrigin),d.setPath(this.path),d.load(e,function(f){l.image=f,l.needsUpdate=!0,i!==void 0&&i(l)},a,s),l}}class Up extends br{constructor(e,i=1){super(),this.isLight=!0,this.type="Light",this.color=new In(e),this.intensity=i}dispose(){}copy(e,i){return super.copy(e,i),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const i=super.toJSON(e);return i.object.color=this.color.getHex(),i.object.intensity=this.intensity,this.groundColor!==void 0&&(i.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(i.object.distance=this.distance),this.angle!==void 0&&(i.object.angle=this.angle),this.decay!==void 0&&(i.object.decay=this.decay),this.penumbra!==void 0&&(i.object.penumbra=this.penumbra),this.shadow!==void 0&&(i.object.shadow=this.shadow.toJSON()),i}}class EK extends Up{constructor(e,i,a){super(e,a),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(br.DEFAULT_UP),this.updateMatrix(),this.groundColor=new In(i)}copy(e,i){return super.copy(e,i),this.groundColor.copy(e.groundColor),this}}const fL=new Di,j7=new We,$7=new We;class Gz{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new tn(512,512),this.map=null,this.mapPass=null,this.matrix=new Di,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new QA,this._frameExtents=new tn(1,1),this._viewportCount=1,this._viewports=[new Lr(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const i=this.camera,a=this.matrix;j7.setFromMatrixPosition(e.matrixWorld),i.position.copy(j7),$7.setFromMatrixPosition(e.target.matrixWorld),i.lookAt($7),i.updateMatrixWorld(),fL.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),this._frustum.setFromProjectionMatrix(fL),a.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),a.multiply(fL)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class nMe extends Gz{constructor(){super(new Za(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){const i=this.camera,a=__*2*e.angle*this.focus,s=this.mapSize.width/this.mapSize.height,l=e.distance||i.far;(a!==i.fov||s!==i.aspect||l!==i.far)&&(i.fov=a,i.aspect=s,i.far=l,i.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class MK extends Up{constructor(e,i,a=0,s=Math.PI/3,l=0,d=2){super(e,i),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(br.DEFAULT_UP),this.updateMatrix(),this.target=new br,this.distance=a,this.angle=s,this.penumbra=l,this.decay=d,this.map=null,this.shadow=new nMe}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,i){return super.copy(e,i),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}const Y7=new Di,Ix=new We,pL=new We;class iMe extends Gz{constructor(){super(new Za(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new tn(4,2),this._viewportCount=6,this._viewports=[new Lr(2,1,1,1),new Lr(0,1,1,1),new Lr(3,1,1,1),new Lr(1,1,1,1),new Lr(3,0,1,1),new Lr(1,0,1,1)],this._cubeDirections=[new We(1,0,0),new We(-1,0,0),new We(0,0,1),new We(0,0,-1),new We(0,1,0),new We(0,-1,0)],this._cubeUps=[new We(0,1,0),new We(0,1,0),new We(0,1,0),new We(0,1,0),new We(0,0,1),new We(0,0,-1)]}updateMatrices(e,i=0){const a=this.camera,s=this.matrix,l=e.distance||a.far;l!==a.far&&(a.far=l,a.updateProjectionMatrix()),Ix.setFromMatrixPosition(e.matrixWorld),a.position.copy(Ix),pL.copy(a.position),pL.add(this._cubeDirections[i]),a.up.copy(this._cubeUps[i]),a.lookAt(pL),a.updateMatrixWorld(),s.makeTranslation(-Ix.x,-Ix.y,-Ix.z),Y7.multiplyMatrices(a.projectionMatrix,a.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Y7)}}class TK extends Up{constructor(e,i,a=0,s=2){super(e,i),this.isPointLight=!0,this.type="PointLight",this.distance=a,this.decay=s,this.shadow=new iMe}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,i){return super.copy(e,i),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class rMe extends Gz{constructor(){super(new Oh(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class AK extends Up{constructor(e,i){super(e,i),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(br.DEFAULT_UP),this.updateMatrix(),this.target=new br,this.shadow=new rMe}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class CK extends Up{constructor(e,i){super(e,i),this.isAmbientLight=!0,this.type="AmbientLight"}}class PK extends Up{constructor(e,i,a=10,s=10){super(e,i),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=a,this.height=s}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const i=super.toJSON(e);return i.object.width=this.width,i.object.height=this.height,i}}class IK{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new We)}set(e){for(let i=0;i<9;i++)this.coefficients[i].copy(e[i]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,i){const a=e.x,s=e.y,l=e.z,d=this.coefficients;return i.copy(d[0]).multiplyScalar(.282095),i.addScaledVector(d[1],.488603*s),i.addScaledVector(d[2],.488603*l),i.addScaledVector(d[3],.488603*a),i.addScaledVector(d[4],1.092548*(a*s)),i.addScaledVector(d[5],1.092548*(s*l)),i.addScaledVector(d[6],.315392*(3*l*l-1)),i.addScaledVector(d[7],1.092548*(a*l)),i.addScaledVector(d[8],.546274*(a*a-s*s)),i}getIrradianceAt(e,i){const a=e.x,s=e.y,l=e.z,d=this.coefficients;return i.copy(d[0]).multiplyScalar(.886227),i.addScaledVector(d[1],2*.511664*s),i.addScaledVector(d[2],2*.511664*l),i.addScaledVector(d[3],2*.511664*a),i.addScaledVector(d[4],2*.429043*a*s),i.addScaledVector(d[5],2*.429043*s*l),i.addScaledVector(d[6],.743125*l*l-.247708),i.addScaledVector(d[7],2*.429043*a*l),i.addScaledVector(d[8],.429043*(a*a-s*s)),i}add(e){for(let i=0;i<9;i++)this.coefficients[i].add(e.coefficients[i]);return this}addScaledSH(e,i){for(let a=0;a<9;a++)this.coefficients[a].addScaledVector(e.coefficients[a],i);return this}scale(e){for(let i=0;i<9;i++)this.coefficients[i].multiplyScalar(e);return this}lerp(e,i){for(let a=0;a<9;a++)this.coefficients[a].lerp(e.coefficients[a],i);return this}equals(e){for(let i=0;i<9;i++)if(!this.coefficients[i].equals(e.coefficients[i]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(e,i=0){const a=this.coefficients;for(let s=0;s<9;s++)a[s].fromArray(e,i+s*3);return this}toArray(e=[],i=0){const a=this.coefficients;for(let s=0;s<9;s++)a[s].toArray(e,i+s*3);return e}static getBasisAt(e,i){const a=e.x,s=e.y,l=e.z;i[0]=.282095,i[1]=.488603*s,i[2]=.488603*l,i[3]=.488603*a,i[4]=1.092548*a*s,i[5]=1.092548*s*l,i[6]=.315392*(3*l*l-1),i[7]=1.092548*a*l,i[8]=.546274*(a*a-s*s)}}class RK extends Up{constructor(e=new IK,i=1){super(void 0,i),this.isLightProbe=!0,this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){const i=super.toJSON(e);return i.object.sh=this.sh.toArray(),i}}class wC extends Il{constructor(e){super(e),this.textures={}}load(e,i,a,s){const l=this,d=new qh(l.manager);d.setPath(l.path),d.setRequestHeader(l.requestHeader),d.setWithCredentials(l.withCredentials),d.load(e,function(f){try{i(l.parse(JSON.parse(f)))}catch(p){s?s(p):console.error(p),l.manager.itemError(e)}},a,s)}parse(e){const i=this.textures;function a(l){return i[l]===void 0&&console.warn("THREE.MaterialLoader: Undefined texture",l),i[l]}const s=wC.createMaterialFromType(e.type);if(e.uuid!==void 0&&(s.uuid=e.uuid),e.name!==void 0&&(s.name=e.name),e.color!==void 0&&s.color!==void 0&&s.color.setHex(e.color),e.roughness!==void 0&&(s.roughness=e.roughness),e.metalness!==void 0&&(s.metalness=e.metalness),e.sheen!==void 0&&(s.sheen=e.sheen),e.sheenColor!==void 0&&(s.sheenColor=new In().setHex(e.sheenColor)),e.sheenRoughness!==void 0&&(s.sheenRoughness=e.sheenRoughness),e.emissive!==void 0&&s.emissive!==void 0&&s.emissive.setHex(e.emissive),e.specular!==void 0&&s.specular!==void 0&&s.specular.setHex(e.specular),e.specularIntensity!==void 0&&(s.specularIntensity=e.specularIntensity),e.specularColor!==void 0&&s.specularColor!==void 0&&s.specularColor.setHex(e.specularColor),e.shininess!==void 0&&(s.shininess=e.shininess),e.clearcoat!==void 0&&(s.clearcoat=e.clearcoat),e.clearcoatRoughness!==void 0&&(s.clearcoatRoughness=e.clearcoatRoughness),e.iridescence!==void 0&&(s.iridescence=e.iridescence),e.iridescenceIOR!==void 0&&(s.iridescenceIOR=e.iridescenceIOR),e.iridescenceThicknessRange!==void 0&&(s.iridescenceThicknessRange=e.iridescenceThicknessRange),e.transmission!==void 0&&(s.transmission=e.transmission),e.thickness!==void 0&&(s.thickness=e.thickness),e.attenuationDistance!==void 0&&(s.attenuationDistance=e.attenuationDistance),e.attenuationColor!==void 0&&s.attenuationColor!==void 0&&s.attenuationColor.setHex(e.attenuationColor),e.anisotropy!==void 0&&(s.anisotropy=e.anisotropy),e.anisotropyRotation!==void 0&&(s.anisotropyRotation=e.anisotropyRotation),e.fog!==void 0&&(s.fog=e.fog),e.flatShading!==void 0&&(s.flatShading=e.flatShading),e.blending!==void 0&&(s.blending=e.blending),e.combine!==void 0&&(s.combine=e.combine),e.side!==void 0&&(s.side=e.side),e.shadowSide!==void 0&&(s.shadowSide=e.shadowSide),e.opacity!==void 0&&(s.opacity=e.opacity),e.transparent!==void 0&&(s.transparent=e.transparent),e.alphaTest!==void 0&&(s.alphaTest=e.alphaTest),e.alphaHash!==void 0&&(s.alphaHash=e.alphaHash),e.depthFunc!==void 0&&(s.depthFunc=e.depthFunc),e.depthTest!==void 0&&(s.depthTest=e.depthTest),e.depthWrite!==void 0&&(s.depthWrite=e.depthWrite),e.colorWrite!==void 0&&(s.colorWrite=e.colorWrite),e.blendSrc!==void 0&&(s.blendSrc=e.blendSrc),e.blendDst!==void 0&&(s.blendDst=e.blendDst),e.blendEquation!==void 0&&(s.blendEquation=e.blendEquation),e.blendSrcAlpha!==void 0&&(s.blendSrcAlpha=e.blendSrcAlpha),e.blendDstAlpha!==void 0&&(s.blendDstAlpha=e.blendDstAlpha),e.blendEquationAlpha!==void 0&&(s.blendEquationAlpha=e.blendEquationAlpha),e.blendColor!==void 0&&s.blendColor!==void 0&&s.blendColor.setHex(e.blendColor),e.blendAlpha!==void 0&&(s.blendAlpha=e.blendAlpha),e.stencilWriteMask!==void 0&&(s.stencilWriteMask=e.stencilWriteMask),e.stencilFunc!==void 0&&(s.stencilFunc=e.stencilFunc),e.stencilRef!==void 0&&(s.stencilRef=e.stencilRef),e.stencilFuncMask!==void 0&&(s.stencilFuncMask=e.stencilFuncMask),e.stencilFail!==void 0&&(s.stencilFail=e.stencilFail),e.stencilZFail!==void 0&&(s.stencilZFail=e.stencilZFail),e.stencilZPass!==void 0&&(s.stencilZPass=e.stencilZPass),e.stencilWrite!==void 0&&(s.stencilWrite=e.stencilWrite),e.wireframe!==void 0&&(s.wireframe=e.wireframe),e.wireframeLinewidth!==void 0&&(s.wireframeLinewidth=e.wireframeLinewidth),e.wireframeLinecap!==void 0&&(s.wireframeLinecap=e.wireframeLinecap),e.wireframeLinejoin!==void 0&&(s.wireframeLinejoin=e.wireframeLinejoin),e.rotation!==void 0&&(s.rotation=e.rotation),e.linewidth!==void 0&&(s.linewidth=e.linewidth),e.dashSize!==void 0&&(s.dashSize=e.dashSize),e.gapSize!==void 0&&(s.gapSize=e.gapSize),e.scale!==void 0&&(s.scale=e.scale),e.polygonOffset!==void 0&&(s.polygonOffset=e.polygonOffset),e.polygonOffsetFactor!==void 0&&(s.polygonOffsetFactor=e.polygonOffsetFactor),e.polygonOffsetUnits!==void 0&&(s.polygonOffsetUnits=e.polygonOffsetUnits),e.dithering!==void 0&&(s.dithering=e.dithering),e.alphaToCoverage!==void 0&&(s.alphaToCoverage=e.alphaToCoverage),e.premultipliedAlpha!==void 0&&(s.premultipliedAlpha=e.premultipliedAlpha),e.forceSinglePass!==void 0&&(s.forceSinglePass=e.forceSinglePass),e.visible!==void 0&&(s.visible=e.visible),e.toneMapped!==void 0&&(s.toneMapped=e.toneMapped),e.userData!==void 0&&(s.userData=e.userData),e.vertexColors!==void 0&&(typeof e.vertexColors=="number"?s.vertexColors=e.vertexColors>0:s.vertexColors=e.vertexColors),e.uniforms!==void 0)for(const l in e.uniforms){const d=e.uniforms[l];switch(s.uniforms[l]={},d.type){case"t":s.uniforms[l].value=a(d.value);break;case"c":s.uniforms[l].value=new In().setHex(d.value);break;case"v2":s.uniforms[l].value=new tn().fromArray(d.value);break;case"v3":s.uniforms[l].value=new We().fromArray(d.value);break;case"v4":s.uniforms[l].value=new Lr().fromArray(d.value);break;case"m3":s.uniforms[l].value=new Vi().fromArray(d.value);break;case"m4":s.uniforms[l].value=new Di().fromArray(d.value);break;default:s.uniforms[l].value=d.value}}if(e.defines!==void 0&&(s.defines=e.defines),e.vertexShader!==void 0&&(s.vertexShader=e.vertexShader),e.fragmentShader!==void 0&&(s.fragmentShader=e.fragmentShader),e.glslVersion!==void 0&&(s.glslVersion=e.glslVersion),e.extensions!==void 0)for(const l in e.extensions)s.extensions[l]=e.extensions[l];if(e.lights!==void 0&&(s.lights=e.lights),e.clipping!==void 0&&(s.clipping=e.clipping),e.size!==void 0&&(s.size=e.size),e.sizeAttenuation!==void 0&&(s.sizeAttenuation=e.sizeAttenuation),e.map!==void 0&&(s.map=a(e.map)),e.matcap!==void 0&&(s.matcap=a(e.matcap)),e.alphaMap!==void 0&&(s.alphaMap=a(e.alphaMap)),e.bumpMap!==void 0&&(s.bumpMap=a(e.bumpMap)),e.bumpScale!==void 0&&(s.bumpScale=e.bumpScale),e.normalMap!==void 0&&(s.normalMap=a(e.normalMap)),e.normalMapType!==void 0&&(s.normalMapType=e.normalMapType),e.normalScale!==void 0){let l=e.normalScale;Array.isArray(l)===!1&&(l=[l,l]),s.normalScale=new tn().fromArray(l)}return e.displacementMap!==void 0&&(s.displacementMap=a(e.displacementMap)),e.displacementScale!==void 0&&(s.displacementScale=e.displacementScale),e.displacementBias!==void 0&&(s.displacementBias=e.displacementBias),e.roughnessMap!==void 0&&(s.roughnessMap=a(e.roughnessMap)),e.metalnessMap!==void 0&&(s.metalnessMap=a(e.metalnessMap)),e.emissiveMap!==void 0&&(s.emissiveMap=a(e.emissiveMap)),e.emissiveIntensity!==void 0&&(s.emissiveIntensity=e.emissiveIntensity),e.specularMap!==void 0&&(s.specularMap=a(e.specularMap)),e.specularIntensityMap!==void 0&&(s.specularIntensityMap=a(e.specularIntensityMap)),e.specularColorMap!==void 0&&(s.specularColorMap=a(e.specularColorMap)),e.envMap!==void 0&&(s.envMap=a(e.envMap)),e.envMapIntensity!==void 0&&(s.envMapIntensity=e.envMapIntensity),e.reflectivity!==void 0&&(s.reflectivity=e.reflectivity),e.refractionRatio!==void 0&&(s.refractionRatio=e.refractionRatio),e.lightMap!==void 0&&(s.lightMap=a(e.lightMap)),e.lightMapIntensity!==void 0&&(s.lightMapIntensity=e.lightMapIntensity),e.aoMap!==void 0&&(s.aoMap=a(e.aoMap)),e.aoMapIntensity!==void 0&&(s.aoMapIntensity=e.aoMapIntensity),e.gradientMap!==void 0&&(s.gradientMap=a(e.gradientMap)),e.clearcoatMap!==void 0&&(s.clearcoatMap=a(e.clearcoatMap)),e.clearcoatRoughnessMap!==void 0&&(s.clearcoatRoughnessMap=a(e.clearcoatRoughnessMap)),e.clearcoatNormalMap!==void 0&&(s.clearcoatNormalMap=a(e.clearcoatNormalMap)),e.clearcoatNormalScale!==void 0&&(s.clearcoatNormalScale=new tn().fromArray(e.clearcoatNormalScale)),e.iridescenceMap!==void 0&&(s.iridescenceMap=a(e.iridescenceMap)),e.iridescenceThicknessMap!==void 0&&(s.iridescenceThicknessMap=a(e.iridescenceThicknessMap)),e.transmissionMap!==void 0&&(s.transmissionMap=a(e.transmissionMap)),e.thicknessMap!==void 0&&(s.thicknessMap=a(e.thicknessMap)),e.anisotropyMap!==void 0&&(s.anisotropyMap=a(e.anisotropyMap)),e.sheenColorMap!==void 0&&(s.sheenColorMap=a(e.sheenColorMap)),e.sheenRoughnessMap!==void 0&&(s.sheenRoughnessMap=a(e.sheenRoughnessMap)),s}setTextures(e){return this.textures=e,this}static createMaterialFromType(e){const i={ShadowMaterial:lK,SpriteMaterial:Pz,RawShaderMaterial:cK,ShaderMaterial:Pd,PointsMaterial:Rz,MeshPhysicalMaterial:uK,MeshStandardMaterial:Fz,MeshPhongMaterial:dK,MeshToonMaterial:hK,MeshNormalMaterial:fK,MeshLambertMaterial:pK,MeshDepthMaterial:tC,MeshDistanceMaterial:nC,MeshBasicMaterial:Kh,MeshMatcapMaterial:mK,LineDashedMaterial:gK,LineBasicMaterial:Ks,Material:rs};return new i[e]}}class q5{static decodeText(e){if(typeof TextDecoder<"u")return new TextDecoder().decode(e);let i="";for(let a=0,s=e.length;a<s;a++)i+=String.fromCharCode(e[a]);try{return decodeURIComponent(escape(i))}catch{return i}}static extractUrlBase(e){const i=e.lastIndexOf("/");return i===-1?"./":e.slice(0,i+1)}static resolveURL(e,i){return typeof e!="string"||e===""?"":(/^https?:\/\//i.test(i)&&/^\//.test(e)&&(i=i.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:i+e)}}class Hz extends zi{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){const e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}class LK extends Il{constructor(e){super(e)}load(e,i,a,s){const l=this,d=new qh(l.manager);d.setPath(l.path),d.setRequestHeader(l.requestHeader),d.setWithCredentials(l.withCredentials),d.load(e,function(f){try{i(l.parse(JSON.parse(f)))}catch(p){s?s(p):console.error(p),l.manager.itemError(e)}},a,s)}parse(e){const i={},a={};function s(A,P){if(i[P]!==void 0)return i[P];const k=A.interleavedBuffers[P],R=l(A,k.buffer),z=z0(k.type,R),O=new aC(z,k.stride);return O.uuid=k.uuid,i[P]=O,O}function l(A,P){if(a[P]!==void 0)return a[P];const k=A.arrayBuffers[P],R=new Uint32Array(k).buffer;return a[P]=R,R}const d=e.isInstancedBufferGeometry?new Hz:new zi,f=e.data.index;if(f!==void 0){const A=z0(f.type,f.array);d.setIndex(new Qr(A,1))}const p=e.data.attributes;for(const A in p){const P=p[A];let L;if(P.isInterleavedBufferAttribute){const k=s(e.data,P.data);L=new $g(k,P.itemSize,P.offset,P.normalized)}else{const k=z0(P.type,P.array),R=P.isInstancedBufferAttribute?Yg:Qr;L=new R(k,P.itemSize,P.normalized)}P.name!==void 0&&(L.name=P.name),P.usage!==void 0&&L.setUsage(P.usage),P.updateRange!==void 0&&(L.updateRange.offset=P.updateRange.offset,L.updateRange.count=P.updateRange.count),d.setAttribute(A,L)}const y=e.data.morphAttributes;if(y)for(const A in y){const P=y[A],L=[];for(let k=0,R=P.length;k<R;k++){const z=P[k];let O;if(z.isInterleavedBufferAttribute){const F=s(e.data,z.data);O=new $g(F,z.itemSize,z.offset,z.normalized)}else{const F=z0(z.type,z.array);O=new Qr(F,z.itemSize,z.normalized)}z.name!==void 0&&(O.name=z.name),L.push(O)}d.morphAttributes[A]=L}e.data.morphTargetsRelative&&(d.morphTargetsRelative=!0);const b=e.data.groups||e.data.drawcalls||e.data.offsets;if(b!==void 0)for(let A=0,P=b.length;A!==P;++A){const L=b[A];d.addGroup(L.start,L.count,L.materialIndex)}const S=e.data.boundingSphere;if(S!==void 0){const A=new We;S.center!==void 0&&A.fromArray(S.center),d.boundingSphere=new Fc(A,S.radius)}return e.name&&(d.name=e.name),e.userData&&(d.userData=e.userData),d}}class aMe extends Il{constructor(e){super(e)}load(e,i,a,s){const l=this,d=this.path===""?q5.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||d;const f=new qh(this.manager);f.setPath(this.path),f.setRequestHeader(this.requestHeader),f.setWithCredentials(this.withCredentials),f.load(e,function(p){let y=null;try{y=JSON.parse(p)}catch(b){s!==void 0&&s(b),console.error("THREE:ObjectLoader: Can't parse "+e+".",b.message);return}const _=y.metadata;if(_===void 0||_.type===void 0||_.type.toLowerCase()==="geometry"){s!==void 0&&s(new Error("THREE.ObjectLoader: Can't load "+e)),console.error("THREE.ObjectLoader: Can't load "+e);return}l.parse(y,i)},a,s)}async loadAsync(e,i){const a=this,s=this.path===""?q5.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||s;const l=new qh(this.manager);l.setPath(this.path),l.setRequestHeader(this.requestHeader),l.setWithCredentials(this.withCredentials);const d=await l.loadAsync(e,i),f=JSON.parse(d),p=f.metadata;if(p===void 0||p.type===void 0||p.type.toLowerCase()==="geometry")throw new Error("THREE.ObjectLoader: Can't load "+e);return await a.parseAsync(f)}parse(e,i){const a=this.parseAnimations(e.animations),s=this.parseShapes(e.shapes),l=this.parseGeometries(e.geometries,s),d=this.parseImages(e.images,function(){i!==void 0&&i(y)}),f=this.parseTextures(e.textures,d),p=this.parseMaterials(e.materials,f),y=this.parseObject(e.object,l,p,f,a),_=this.parseSkeletons(e.skeletons,y);if(this.bindSkeletons(y,_),i!==void 0){let b=!1;for(const S in d)if(d[S].data instanceof HTMLImageElement){b=!0;break}b===!1&&i(y)}return y}async parseAsync(e){const i=this.parseAnimations(e.animations),a=this.parseShapes(e.shapes),s=this.parseGeometries(e.geometries,a),l=await this.parseImagesAsync(e.images),d=this.parseTextures(e.textures,l),f=this.parseMaterials(e.materials,d),p=this.parseObject(e.object,s,f,d,i),y=this.parseSkeletons(e.skeletons,p);return this.bindSkeletons(p,y),p}parseShapes(e){const i={};if(e!==void 0)for(let a=0,s=e.length;a<s;a++){const l=new Lg().fromJSON(e[a]);i[l.uuid]=l}return i}parseSkeletons(e,i){const a={},s={};if(i.traverse(function(l){l.isBone&&(s[l.uuid]=l)}),e!==void 0)for(let l=0,d=e.length;l<d;l++){const f=new oC().fromJSON(e[l],s);a[f.uuid]=f}return a}parseGeometries(e,i){const a={};if(e!==void 0){const s=new LK;for(let l=0,d=e.length;l<d;l++){let f;const p=e[l];switch(p.type){case"BufferGeometry":case"InstancedBufferGeometry":f=s.parse(p);break;default:p.type in H7?f=H7[p.type].fromJSON(p,i):console.warn(`THREE.ObjectLoader: Unsupported geometry type "${p.type}"`)}f.uuid=p.uuid,p.name!==void 0&&(f.name=p.name),p.userData!==void 0&&(f.userData=p.userData),a[p.uuid]=f}}return a}parseMaterials(e,i){const a={},s={};if(e!==void 0){const l=new wC;l.setTextures(i);for(let d=0,f=e.length;d<f;d++){const p=e[d];a[p.uuid]===void 0&&(a[p.uuid]=l.parse(p)),s[p.uuid]=a[p.uuid]}}return s}parseAnimations(e){const i={};if(e!==void 0)for(let a=0;a<e.length;a++){const s=e[a],l=Aw.parse(s);i[l.uuid]=l}return i}parseImages(e,i){const a=this,s={};let l;function d(p){return a.manager.itemStart(p),l.load(p,function(){a.manager.itemEnd(p)},void 0,function(){a.manager.itemError(p),a.manager.itemEnd(p)})}function f(p){if(typeof p=="string"){const y=p,_=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(y)?y:a.resourcePath+y;return d(_)}else return p.data?{data:z0(p.type,p.data),width:p.width,height:p.height}:null}if(e!==void 0&&e.length>0){const p=new Vz(i);l=new Cw(p),l.setCrossOrigin(this.crossOrigin);for(let y=0,_=e.length;y<_;y++){const b=e[y],S=b.url;if(Array.isArray(S)){const A=[];for(let P=0,L=S.length;P<L;P++){const k=S[P],R=f(k);R!==null&&(R instanceof HTMLImageElement?A.push(R):A.push(new J0(R.data,R.width,R.height)))}s[b.uuid]=new bg(A)}else{const A=f(b.url);s[b.uuid]=new bg(A)}}}return s}async parseImagesAsync(e){const i=this,a={};let s;async function l(d){if(typeof d=="string"){const f=d,p=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(f)?f:i.resourcePath+f;return await s.loadAsync(p)}else return d.data?{data:z0(d.type,d.data),width:d.width,height:d.height}:null}if(e!==void 0&&e.length>0){s=new Cw(this.manager),s.setCrossOrigin(this.crossOrigin);for(let d=0,f=e.length;d<f;d++){const p=e[d],y=p.url;if(Array.isArray(y)){const _=[];for(let b=0,S=y.length;b<S;b++){const A=y[b],P=await l(A);P!==null&&(P instanceof HTMLImageElement?_.push(P):_.push(new J0(P.data,P.width,P.height)))}a[p.uuid]=new bg(_)}else{const _=await l(p.url);a[p.uuid]=new bg(_)}}}return a}parseTextures(e,i){function a(l,d){return typeof l=="number"?l:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",l),d[l])}const s={};if(e!==void 0)for(let l=0,d=e.length;l<d;l++){const f=e[l];f.image===void 0&&console.warn('THREE.ObjectLoader: No "image" specified for',f.uuid),i[f.image]===void 0&&console.warn("THREE.ObjectLoader: Undefined image",f.image);const p=i[f.image],y=p.data;let _;Array.isArray(y)?(_=new iS,y.length===6&&(_.needsUpdate=!0)):(y&&y.data?_=new J0:_=new Oa,y&&(_.needsUpdate=!0)),_.source=p,_.uuid=f.uuid,f.name!==void 0&&(_.name=f.name),f.mapping!==void 0&&(_.mapping=a(f.mapping,oMe)),f.channel!==void 0&&(_.channel=f.channel),f.offset!==void 0&&_.offset.fromArray(f.offset),f.repeat!==void 0&&_.repeat.fromArray(f.repeat),f.center!==void 0&&_.center.fromArray(f.center),f.rotation!==void 0&&(_.rotation=f.rotation),f.wrap!==void 0&&(_.wrapS=a(f.wrap[0],q7),_.wrapT=a(f.wrap[1],q7)),f.format!==void 0&&(_.format=f.format),f.internalFormat!==void 0&&(_.internalFormat=f.internalFormat),f.type!==void 0&&(_.type=f.type),f.colorSpace!==void 0&&(_.colorSpace=f.colorSpace),f.encoding!==void 0&&(_.encoding=f.encoding),f.minFilter!==void 0&&(_.minFilter=a(f.minFilter,X7)),f.magFilter!==void 0&&(_.magFilter=a(f.magFilter,X7)),f.anisotropy!==void 0&&(_.anisotropy=f.anisotropy),f.flipY!==void 0&&(_.flipY=f.flipY),f.generateMipmaps!==void 0&&(_.generateMipmaps=f.generateMipmaps),f.premultiplyAlpha!==void 0&&(_.premultiplyAlpha=f.premultiplyAlpha),f.unpackAlignment!==void 0&&(_.unpackAlignment=f.unpackAlignment),f.compareFunction!==void 0&&(_.compareFunction=f.compareFunction),f.userData!==void 0&&(_.userData=f.userData),s[f.uuid]=_}return s}parseObject(e,i,a,s,l){let d;function f(S){return i[S]===void 0&&console.warn("THREE.ObjectLoader: Undefined geometry",S),i[S]}function p(S){if(S!==void 0){if(Array.isArray(S)){const A=[];for(let P=0,L=S.length;P<L;P++){const k=S[P];a[k]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",k),A.push(a[k])}return A}return a[S]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",S),a[S]}}function y(S){return s[S]===void 0&&console.warn("THREE.ObjectLoader: Undefined texture",S),s[S]}let _,b;switch(e.type){case"Scene":d=new vT,e.background!==void 0&&(Number.isInteger(e.background)?d.background=new In(e.background):d.background=y(e.background)),e.environment!==void 0&&(d.environment=y(e.environment)),e.fog!==void 0&&(e.fog.type==="Fog"?d.fog=new rC(e.fog.color,e.fog.near,e.fog.far):e.fog.type==="FogExp2"&&(d.fog=new iC(e.fog.color,e.fog.density)),e.fog.name!==""&&(d.fog.name=e.fog.name)),e.backgroundBlurriness!==void 0&&(d.backgroundBlurriness=e.backgroundBlurriness),e.backgroundIntensity!==void 0&&(d.backgroundIntensity=e.backgroundIntensity);break;case"PerspectiveCamera":d=new Za(e.fov,e.aspect,e.near,e.far),e.focus!==void 0&&(d.focus=e.focus),e.zoom!==void 0&&(d.zoom=e.zoom),e.filmGauge!==void 0&&(d.filmGauge=e.filmGauge),e.filmOffset!==void 0&&(d.filmOffset=e.filmOffset),e.view!==void 0&&(d.view=Object.assign({},e.view));break;case"OrthographicCamera":d=new Oh(e.left,e.right,e.top,e.bottom,e.near,e.far),e.zoom!==void 0&&(d.zoom=e.zoom),e.view!==void 0&&(d.view=Object.assign({},e.view));break;case"AmbientLight":d=new CK(e.color,e.intensity);break;case"DirectionalLight":d=new AK(e.color,e.intensity);break;case"PointLight":d=new TK(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":d=new PK(e.color,e.intensity,e.width,e.height);break;case"SpotLight":d=new MK(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":d=new EK(e.color,e.groundColor,e.intensity);break;case"LightProbe":d=new RK().fromJSON(e);break;case"SkinnedMesh":_=f(e.geometry),b=p(e.material),d=new qZ(_,b),e.bindMode!==void 0&&(d.bindMode=e.bindMode),e.bindMatrix!==void 0&&d.bindMatrix.fromArray(e.bindMatrix),e.skeleton!==void 0&&(d.skeleton=e.skeleton);break;case"Mesh":_=f(e.geometry),b=p(e.material),d=new Eo(_,b);break;case"InstancedMesh":_=f(e.geometry),b=p(e.material);const S=e.count,A=e.instanceMatrix,P=e.instanceColor;d=new XZ(_,b,S),d.instanceMatrix=new Yg(new Float32Array(A.array),16),P!==void 0&&(d.instanceColor=new Yg(new Float32Array(P.array),P.itemSize));break;case"LOD":d=new YZ;break;case"Line":d=new Pp(f(e.geometry),p(e.material));break;case"LineLoop":d=new ZZ(f(e.geometry),p(e.material));break;case"LineSegments":d=new kd(f(e.geometry),p(e.material));break;case"PointCloud":case"Points":d=new KZ(f(e.geometry),p(e.material));break;case"Sprite":d=new $Z(p(e.material));break;case"Group":d=new N0;break;case"Bone":d=new Iz;break;default:d=new br}if(d.uuid=e.uuid,e.name!==void 0&&(d.name=e.name),e.matrix!==void 0?(d.matrix.fromArray(e.matrix),e.matrixAutoUpdate!==void 0&&(d.matrixAutoUpdate=e.matrixAutoUpdate),d.matrixAutoUpdate&&d.matrix.decompose(d.position,d.quaternion,d.scale)):(e.position!==void 0&&d.position.fromArray(e.position),e.rotation!==void 0&&d.rotation.fromArray(e.rotation),e.quaternion!==void 0&&d.quaternion.fromArray(e.quaternion),e.scale!==void 0&&d.scale.fromArray(e.scale)),e.up!==void 0&&d.up.fromArray(e.up),e.castShadow!==void 0&&(d.castShadow=e.castShadow),e.receiveShadow!==void 0&&(d.receiveShadow=e.receiveShadow),e.shadow&&(e.shadow.bias!==void 0&&(d.shadow.bias=e.shadow.bias),e.shadow.normalBias!==void 0&&(d.shadow.normalBias=e.shadow.normalBias),e.shadow.radius!==void 0&&(d.shadow.radius=e.shadow.radius),e.shadow.mapSize!==void 0&&d.shadow.mapSize.fromArray(e.shadow.mapSize),e.shadow.camera!==void 0&&(d.shadow.camera=this.parseObject(e.shadow.camera))),e.visible!==void 0&&(d.visible=e.visible),e.frustumCulled!==void 0&&(d.frustumCulled=e.frustumCulled),e.renderOrder!==void 0&&(d.renderOrder=e.renderOrder),e.userData!==void 0&&(d.userData=e.userData),e.layers!==void 0&&(d.layers.mask=e.layers),e.children!==void 0){const S=e.children;for(let A=0;A<S.length;A++)d.add(this.parseObject(S[A],i,a,s,l))}if(e.animations!==void 0){const S=e.animations;for(let A=0;A<S.length;A++){const P=S[A];d.animations.push(l[P])}}if(e.type==="LOD"){e.autoUpdate!==void 0&&(d.autoUpdate=e.autoUpdate);const S=e.levels;for(let A=0;A<S.length;A++){const P=S[A],L=d.getObjectByProperty("uuid",P.object);L!==void 0&&d.addLevel(L,P.distance,P.hysteresis)}}return d}bindSkeletons(e,i){Object.keys(i).length!==0&&e.traverse(function(a){if(a.isSkinnedMesh===!0&&a.skeleton!==void 0){const s=i[a.skeleton];s===void 0?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",a.skeleton):a.bind(s,a.bindMatrix)}})}}const oMe={UVMapping:qA,CubeReflectionMapping:Yh,CubeRefractionMapping:Ap,EquirectangularReflectionMapping:lw,EquirectangularRefractionMapping:cw,CubeUVReflectionMapping:R_},q7={RepeatWrapping:uw,ClampToEdgeWrapping:Ss,MirroredRepeatWrapping:dw},X7={NearestFilter:co,NearestMipmapNearestFilter:mT,NearestMipmapLinearFilter:_b,LinearFilter:ka,LinearMipmapNearestFilter:dz,LinearMipmapLinearFilter:Cp};class sMe extends Il{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,i,a,s){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const l=this,d=Xg.get(e);if(d!==void 0)return l.manager.itemStart(e),setTimeout(function(){i&&i(d),l.manager.itemEnd(e)},0),d;const f={};f.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",f.headers=this.requestHeader,fetch(e,f).then(function(p){return p.blob()}).then(function(p){return createImageBitmap(p,Object.assign(l.options,{colorSpaceConversion:"none"}))}).then(function(p){Xg.add(e,p),i&&i(p),l.manager.itemEnd(e)}).catch(function(p){s&&s(p),l.manager.itemError(e),l.manager.itemEnd(e)}),l.manager.itemStart(e)}}let pE;class jz{static getContext(){return pE===void 0&&(pE=new(window.AudioContext||window.webkitAudioContext)),pE}static setContext(e){pE=e}}class lMe extends Il{constructor(e){super(e)}load(e,i,a,s){const l=this,d=new qh(this.manager);d.setResponseType("arraybuffer"),d.setPath(this.path),d.setRequestHeader(this.requestHeader),d.setWithCredentials(this.withCredentials),d.load(e,function(p){try{const y=p.slice(0);jz.getContext().decodeAudioData(y,function(b){i(b)},f)}catch(y){f(y)}},a,s);function f(p){s?s(p):console.error(p),l.manager.itemError(e)}}}const Z7=new Di,K7=new Di,Ym=new Di;class cMe{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new Za,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new Za,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(e){const i=this._cache;if(i.focus!==e.focus||i.fov!==e.fov||i.aspect!==e.aspect*this.aspect||i.near!==e.near||i.far!==e.far||i.zoom!==e.zoom||i.eyeSep!==this.eyeSep){i.focus=e.focus,i.fov=e.fov,i.aspect=e.aspect*this.aspect,i.near=e.near,i.far=e.far,i.zoom=e.zoom,i.eyeSep=this.eyeSep,Ym.copy(e.projectionMatrix);const s=i.eyeSep/2,l=s*i.near/i.focus,d=i.near*Math.tan(Ig*i.fov*.5)/i.zoom;let f,p;K7.elements[12]=-s,Z7.elements[12]=s,f=-d*i.aspect+l,p=d*i.aspect+l,Ym.elements[0]=2*i.near/(p-f),Ym.elements[8]=(p+f)/(p-f),this.cameraL.projectionMatrix.copy(Ym),f=-d*i.aspect-l,p=d*i.aspect-l,Ym.elements[0]=2*i.near/(p-f),Ym.elements[8]=(p+f)/(p-f),this.cameraR.projectionMatrix.copy(Ym)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(K7),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(Z7)}}class $z{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=J7(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const i=J7();e=(i-this.oldTime)/1e3,this.oldTime=i,this.elapsedTime+=e}return e}}function J7(){return(typeof performance>"u"?Date:performance).now()}const qm=new We,Q7=new As,uMe=new We,Xm=new We;class dMe extends br{constructor(){super(),this.type="AudioListener",this.context=jz.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new $z}getInput(){return this.gain}removeFilter(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(e){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}updateMatrixWorld(e){super.updateMatrixWorld(e);const i=this.context.listener,a=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(qm,Q7,uMe),Xm.set(0,0,-1).applyQuaternion(Q7),i.positionX){const s=this.context.currentTime+this.timeDelta;i.positionX.linearRampToValueAtTime(qm.x,s),i.positionY.linearRampToValueAtTime(qm.y,s),i.positionZ.linearRampToValueAtTime(qm.z,s),i.forwardX.linearRampToValueAtTime(Xm.x,s),i.forwardY.linearRampToValueAtTime(Xm.y,s),i.forwardZ.linearRampToValueAtTime(Xm.z,s),i.upX.linearRampToValueAtTime(a.x,s),i.upY.linearRampToValueAtTime(a.y,s),i.upZ.linearRampToValueAtTime(a.z,s)}else i.setPosition(qm.x,qm.y,qm.z),i.setOrientation(Xm.x,Xm.y,Xm.z,a.x,a.y,a.z)}}class kK extends br{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(e=0){if(this.isPlaying===!0){console.warn("THREE.Audio: Audio is already playing.");return}if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+e;const i=this.context.createBufferSource();return i.buffer=this.buffer,i.loop=this.loop,i.loopStart=this.loopStart,i.loopEnd=this.loopEnd,i.onended=this.onEnded.bind(this),i.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=i,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this}stop(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this._progress=0,this.source!==null&&(this.source.stop(),this.source.onended=null),this.isPlaying=!1,this}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,i=this.filters.length;e<i;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this._connected!==!1){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,i=this.filters.length;e<i;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}}getFilters(){return this.filters}setFilters(e){return e||(e=[]),this._connected===!0?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){if(this.detune=e,this.source.detune!==void 0)return this.isPlaying===!0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.playbackRate=e,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.loop=e,this.isPlaying===!0&&(this.source.loop=this.loop),this}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}}const Zm=new We,eG=new As,hMe=new We,Km=new We;class fMe extends kK{constructor(e){super(e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}connect(){super.connect(),this.panner.connect(this.gain)}disconnect(){super.disconnect(),this.panner.disconnect(this.gain)}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(e){return this.panner.refDistance=e,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(e){return this.panner.rolloffFactor=e,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(e){return this.panner.distanceModel=e,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(e){return this.panner.maxDistance=e,this}setDirectionalCone(e,i,a){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=i,this.panner.coneOuterGain=a,this}updateMatrixWorld(e){if(super.updateMatrixWorld(e),this.hasPlaybackControl===!0&&this.isPlaying===!1)return;this.matrixWorld.decompose(Zm,eG,hMe),Km.set(0,0,1).applyQuaternion(eG);const i=this.panner;if(i.positionX){const a=this.context.currentTime+this.listener.timeDelta;i.positionX.linearRampToValueAtTime(Zm.x,a),i.positionY.linearRampToValueAtTime(Zm.y,a),i.positionZ.linearRampToValueAtTime(Zm.z,a),i.orientationX.linearRampToValueAtTime(Km.x,a),i.orientationY.linearRampToValueAtTime(Km.y,a),i.orientationZ.linearRampToValueAtTime(Km.z,a)}else i.setPosition(Zm.x,Zm.y,Zm.z),i.setOrientation(Km.x,Km.y,Km.z)}}class pMe{constructor(e,i=2048){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=i,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let e=0;const i=this.getFrequencyData();for(let a=0;a<i.length;a++)e+=i[a];return e/i.length}}class DK{constructor(e,i,a){this.binding=e,this.valueSize=a;let s,l,d;switch(i){case"quaternion":s=this._slerp,l=this._slerpAdditive,d=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(a*6),this._workIndex=5;break;case"string":case"bool":s=this._select,l=this._select,d=this._setAdditiveIdentityOther,this.buffer=new Array(a*5);break;default:s=this._lerp,l=this._lerpAdditive,d=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(a*5)}this._mixBufferRegion=s,this._mixBufferRegionAdditive=l,this._setIdentity=d,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,i){const a=this.buffer,s=this.valueSize,l=e*s+s;let d=this.cumulativeWeight;if(d===0){for(let f=0;f!==s;++f)a[l+f]=a[f];d=i}else{d+=i;const f=i/d;this._mixBufferRegion(a,l,0,f,s)}this.cumulativeWeight=d}accumulateAdditive(e){const i=this.buffer,a=this.valueSize,s=a*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(i,s,0,e,a),this.cumulativeWeightAdditive+=e}apply(e){const i=this.valueSize,a=this.buffer,s=e*i+i,l=this.cumulativeWeight,d=this.cumulativeWeightAdditive,f=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,l<1){const p=i*this._origIndex;this._mixBufferRegion(a,s,p,1-l,i)}d>0&&this._mixBufferRegionAdditive(a,s,this._addIndex*i,1,i);for(let p=i,y=i+i;p!==y;++p)if(a[p]!==a[p+i]){f.setValue(a,s);break}}saveOriginalState(){const e=this.binding,i=this.buffer,a=this.valueSize,s=a*this._origIndex;e.getValue(i,s);for(let l=a,d=s;l!==d;++l)i[l]=i[s+l%a];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const e=this.valueSize*3;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,i=e+this.valueSize;for(let a=e;a<i;a++)this.buffer[a]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,i=this._addIndex*this.valueSize;for(let a=0;a<this.valueSize;a++)this.buffer[i+a]=this.buffer[e+a]}_select(e,i,a,s,l){if(s>=.5)for(let d=0;d!==l;++d)e[i+d]=e[a+d]}_slerp(e,i,a,s){As.slerpFlat(e,i,e,i,e,a,s)}_slerpAdditive(e,i,a,s,l){const d=this._workIndex*l;As.multiplyQuaternionsFlat(e,d,e,i,e,a),As.slerpFlat(e,i,e,i,e,d,s)}_lerp(e,i,a,s,l){const d=1-s;for(let f=0;f!==l;++f){const p=i+f;e[p]=e[p]*d+e[a+f]*s}}_lerpAdditive(e,i,a,s,l){for(let d=0;d!==l;++d){const f=i+d;e[f]=e[f]+e[a+d]*s}}}const Yz="\\[\\]\\.:\\/",mMe=new RegExp("["+Yz+"]","g"),qz="[^"+Yz+"]",gMe="[^"+Yz.replace("\\.","")+"]",yMe=/((?:WC+[\/:])*)/.source.replace("WC",qz),vMe=/(WCOD+)?/.source.replace("WCOD",gMe),_Me=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",qz),xMe=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",qz),bMe=new RegExp("^"+yMe+vMe+_Me+xMe+"$"),wMe=["material","materials","bones","map"];class SMe{constructor(e,i,a){const s=a||fr.parseTrackName(i);this._targetGroup=e,this._bindings=e.subscribe_(i,s)}getValue(e,i){this.bind();const a=this._targetGroup.nCachedObjects_,s=this._bindings[a];s!==void 0&&s.getValue(e,i)}setValue(e,i){const a=this._bindings;for(let s=this._targetGroup.nCachedObjects_,l=a.length;s!==l;++s)a[s].setValue(e,i)}bind(){const e=this._bindings;for(let i=this._targetGroup.nCachedObjects_,a=e.length;i!==a;++i)e[i].bind()}unbind(){const e=this._bindings;for(let i=this._targetGroup.nCachedObjects_,a=e.length;i!==a;++i)e[i].unbind()}}class fr{constructor(e,i,a){this.path=i,this.parsedPath=a||fr.parseTrackName(i),this.node=fr.findNode(e,this.parsedPath.nodeName),this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,i,a){return e&&e.isAnimationObjectGroup?new fr.Composite(e,i,a):new fr(e,i,a)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(mMe,"")}static parseTrackName(e){const i=bMe.exec(e);if(i===null)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const a={nodeName:i[2],objectName:i[3],objectIndex:i[4],propertyName:i[5],propertyIndex:i[6]},s=a.nodeName&&a.nodeName.lastIndexOf(".");if(s!==void 0&&s!==-1){const l=a.nodeName.substring(s+1);wMe.indexOf(l)!==-1&&(a.nodeName=a.nodeName.substring(0,s),a.objectName=l)}if(a.propertyName===null||a.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return a}static findNode(e,i){if(i===void 0||i===""||i==="."||i===-1||i===e.name||i===e.uuid)return e;if(e.skeleton){const a=e.skeleton.getBoneByName(i);if(a!==void 0)return a}if(e.children){const a=function(l){for(let d=0;d<l.length;d++){const f=l[d];if(f.name===i||f.uuid===i)return f;const p=a(f.children);if(p)return p}return null},s=a(e.children);if(s)return s}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,i){e[i]=this.targetObject[this.propertyName]}_getValue_array(e,i){const a=this.resolvedProperty;for(let s=0,l=a.length;s!==l;++s)e[i++]=a[s]}_getValue_arrayElement(e,i){e[i]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,i){this.resolvedProperty.toArray(e,i)}_setValue_direct(e,i){this.targetObject[this.propertyName]=e[i]}_setValue_direct_setNeedsUpdate(e,i){this.targetObject[this.propertyName]=e[i],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,i){this.targetObject[this.propertyName]=e[i],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,i){const a=this.resolvedProperty;for(let s=0,l=a.length;s!==l;++s)a[s]=e[i++]}_setValue_array_setNeedsUpdate(e,i){const a=this.resolvedProperty;for(let s=0,l=a.length;s!==l;++s)a[s]=e[i++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,i){const a=this.resolvedProperty;for(let s=0,l=a.length;s!==l;++s)a[s]=e[i++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,i){this.resolvedProperty[this.propertyIndex]=e[i]}_setValue_arrayElement_setNeedsUpdate(e,i){this.resolvedProperty[this.propertyIndex]=e[i],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,i){this.resolvedProperty[this.propertyIndex]=e[i],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,i){this.resolvedProperty.fromArray(e,i)}_setValue_fromArray_setNeedsUpdate(e,i){this.resolvedProperty.fromArray(e,i),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,i){this.resolvedProperty.fromArray(e,i),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,i){this.bind(),this.getValue(e,i)}_setValue_unbound(e,i){this.bind(),this.setValue(e,i)}bind(){let e=this.node;const i=this.parsedPath,a=i.objectName,s=i.propertyName;let l=i.propertyIndex;if(e||(e=fr.findNode(this.rootNode,i.nodeName),this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");return}if(a){let y=i.objectIndex;switch(a){case"materials":if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let _=0;_<e.length;_++)if(e[_].name===y){y=_;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}e=e.material.map;break;default:if(e[a]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[a]}if(y!==void 0){if(e[y]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[y]}}const d=e[s];if(d===void 0){const y=i.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+y+"."+s+" but it wasn't found.",e);return}let f=this.Versioning.None;this.targetObject=e,e.needsUpdate!==void 0?f=this.Versioning.NeedsUpdate:e.matrixWorldNeedsUpdate!==void 0&&(f=this.Versioning.MatrixWorldNeedsUpdate);let p=this.BindingType.Direct;if(l!==void 0){if(s==="morphTargetInfluences"){if(!e.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!e.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[l]!==void 0&&(l=e.morphTargetDictionary[l])}p=this.BindingType.ArrayElement,this.resolvedProperty=d,this.propertyIndex=l}else d.fromArray!==void 0&&d.toArray!==void 0?(p=this.BindingType.HasFromToArray,this.resolvedProperty=d):Array.isArray(d)?(p=this.BindingType.EntireArray,this.resolvedProperty=d):this.propertyName=s;this.getValue=this.GetterByBindingType[p],this.setValue=this.SetterByBindingTypeAndVersioning[p][f]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}fr.Composite=SMe;fr.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};fr.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};fr.prototype.GetterByBindingType=[fr.prototype._getValue_direct,fr.prototype._getValue_array,fr.prototype._getValue_arrayElement,fr.prototype._getValue_toArray];fr.prototype.SetterByBindingTypeAndVersioning=[[fr.prototype._setValue_direct,fr.prototype._setValue_direct_setNeedsUpdate,fr.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[fr.prototype._setValue_array,fr.prototype._setValue_array_setNeedsUpdate,fr.prototype._setValue_array_setMatrixWorldNeedsUpdate],[fr.prototype._setValue_arrayElement,fr.prototype._setValue_arrayElement_setNeedsUpdate,fr.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[fr.prototype._setValue_fromArray,fr.prototype._setValue_fromArray_setNeedsUpdate,fr.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class EMe{constructor(){this.isAnimationObjectGroup=!0,this.uuid=tc(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const e={};this._indicesByUUID=e;for(let a=0,s=arguments.length;a!==s;++a)e[arguments[a].uuid]=a;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const i=this;this.stats={objects:{get total(){return i._objects.length},get inUse(){return this.total-i.nCachedObjects_}},get bindingsPerObject(){return i._bindings.length}}}add(){const e=this._objects,i=this._indicesByUUID,a=this._paths,s=this._parsedPaths,l=this._bindings,d=l.length;let f,p=e.length,y=this.nCachedObjects_;for(let _=0,b=arguments.length;_!==b;++_){const S=arguments[_],A=S.uuid;let P=i[A];if(P===void 0){P=p++,i[A]=P,e.push(S);for(let L=0,k=d;L!==k;++L)l[L].push(new fr(S,a[L],s[L]))}else if(P<y){f=e[P];const L=--y,k=e[L];i[k.uuid]=P,e[P]=k,i[A]=L,e[L]=S;for(let R=0,z=d;R!==z;++R){const O=l[R],F=O[L];let H=O[P];O[P]=F,H===void 0&&(H=new fr(S,a[R],s[R])),O[L]=H}}else e[P]!==f&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=y}remove(){const e=this._objects,i=this._indicesByUUID,a=this._bindings,s=a.length;let l=this.nCachedObjects_;for(let d=0,f=arguments.length;d!==f;++d){const p=arguments[d],y=p.uuid,_=i[y];if(_!==void 0&&_>=l){const b=l++,S=e[b];i[S.uuid]=_,e[_]=S,i[y]=b,e[b]=p;for(let A=0,P=s;A!==P;++A){const L=a[A],k=L[b],R=L[_];L[_]=k,L[b]=R}}}this.nCachedObjects_=l}uncache(){const e=this._objects,i=this._indicesByUUID,a=this._bindings,s=a.length;let l=this.nCachedObjects_,d=e.length;for(let f=0,p=arguments.length;f!==p;++f){const y=arguments[f],_=y.uuid,b=i[_];if(b!==void 0)if(delete i[_],b<l){const S=--l,A=e[S],P=--d,L=e[P];i[A.uuid]=b,e[b]=A,i[L.uuid]=S,e[S]=L,e.pop();for(let k=0,R=s;k!==R;++k){const z=a[k],O=z[S],F=z[P];z[b]=O,z[S]=F,z.pop()}}else{const S=--d,A=e[S];S>0&&(i[A.uuid]=b),e[b]=A,e.pop();for(let P=0,L=s;P!==L;++P){const k=a[P];k[b]=k[S],k.pop()}}}this.nCachedObjects_=l}subscribe_(e,i){const a=this._bindingsIndicesByPath;let s=a[e];const l=this._bindings;if(s!==void 0)return l[s];const d=this._paths,f=this._parsedPaths,p=this._objects,y=p.length,_=this.nCachedObjects_,b=new Array(y);s=l.length,a[e]=s,d.push(e),f.push(i),l.push(b);for(let S=_,A=p.length;S!==A;++S){const P=p[S];b[S]=new fr(P,e,i)}return b}unsubscribe_(e){const i=this._bindingsIndicesByPath,a=i[e];if(a!==void 0){const s=this._paths,l=this._parsedPaths,d=this._bindings,f=d.length-1,p=d[f],y=e[f];i[y]=a,d[a]=p,d.pop(),l[a]=l[f],l.pop(),s[a]=s[f],s.pop()}}}class zK{constructor(e,i,a=null,s=i.blendMode){this._mixer=e,this._clip=i,this._localRoot=a,this.blendMode=s;const l=i.tracks,d=l.length,f=new Array(d),p={endingStart:_g,endingEnd:_g};for(let y=0;y!==d;++y){const _=l[y].createInterpolant(null);f[y]=_,_.settings=p}this._interpolantSettings=p,this._interpolants=f,this._propertyBindings=new Array(d),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=gZ,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,i){return this.loop=e,this.repetitions=i,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,i,a){if(e.fadeOut(i),this.fadeIn(i),a){const s=this._clip.duration,l=e._clip.duration,d=l/s,f=s/l;e.warp(1,d,i),this.warp(f,1,i)}return this}crossFadeTo(e,i,a){return e.crossFadeFrom(this,i,a)}stopFading(){const e=this._weightInterpolant;return e!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,i,a){const s=this._mixer,l=s.time,d=this.timeScale;let f=this._timeScaleInterpolant;f===null&&(f=s._lendControlInterpolant(),this._timeScaleInterpolant=f);const p=f.parameterPositions,y=f.sampleValues;return p[0]=l,p[1]=l+a,y[0]=e/d,y[1]=i/d,this}stopWarping(){const e=this._timeScaleInterpolant;return e!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,i,a,s){if(!this.enabled){this._updateWeight(e);return}const l=this._startTime;if(l!==null){const p=(e-l)*a;p<0||a===0?i=0:(this._startTime=null,i=a*p)}i*=this._updateTimeScale(e);const d=this._updateTime(i),f=this._updateWeight(e);if(f>0){const p=this._interpolants,y=this._propertyBindings;switch(this.blendMode){case vz:for(let _=0,b=p.length;_!==b;++_)p[_].evaluate(d),y[_].accumulateAdditive(f);break;case ZA:default:for(let _=0,b=p.length;_!==b;++_)p[_].evaluate(d),y[_].accumulate(s,f)}}}_updateWeight(e){let i=0;if(this.enabled){i=this.weight;const a=this._weightInterpolant;if(a!==null){const s=a.evaluate(e)[0];i*=s,e>a.parameterPositions[1]&&(this.stopFading(),s===0&&(this.enabled=!1))}}return this._effectiveWeight=i,i}_updateTimeScale(e){let i=0;if(!this.paused){i=this.timeScale;const a=this._timeScaleInterpolant;if(a!==null){const s=a.evaluate(e)[0];i*=s,e>a.parameterPositions[1]&&(this.stopWarping(),i===0?this.paused=!0:this.timeScale=i)}}return this._effectiveTimeScale=i,i}_updateTime(e){const i=this._clip.duration,a=this.loop;let s=this.time+e,l=this._loopCount;const d=a===yZ;if(e===0)return l===-1?s:d&&(l&1)===1?i-s:s;if(a===mZ){l===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(s>=i)s=i;else if(s<0)s=0;else{this.time=s;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=s,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(l===-1&&(e>=0?(l=0,this._setEndings(!0,this.repetitions===0,d)):this._setEndings(this.repetitions===0,!0,d)),s>=i||s<0){const f=Math.floor(s/i);s-=i*f,l+=Math.abs(f);const p=this.repetitions-l;if(p<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,s=e>0?i:0,this.time=s,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(p===1){const y=e<0;this._setEndings(y,!y,d)}else this._setEndings(!1,!1,d);this._loopCount=l,this.time=s,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:f})}}else this.time=s;if(d&&(l&1)===1)return i-s}return s}_setEndings(e,i,a){const s=this._interpolantSettings;a?(s.endingStart=xg,s.endingEnd=xg):(e?s.endingStart=this.zeroSlopeAtStart?xg:_g:s.endingStart=pw,i?s.endingEnd=this.zeroSlopeAtEnd?xg:_g:s.endingEnd=pw)}_scheduleFading(e,i,a){const s=this._mixer,l=s.time;let d=this._weightInterpolant;d===null&&(d=s._lendControlInterpolant(),this._weightInterpolant=d);const f=d.parameterPositions,p=d.sampleValues;return f[0]=l,p[0]=i,f[1]=l+e,p[1]=a,this}}const MMe=new Float32Array(1);class TMe extends Ld{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,i){const a=e._localRoot||this._root,s=e._clip.tracks,l=s.length,d=e._propertyBindings,f=e._interpolants,p=a.uuid,y=this._bindingsByRootAndName;let _=y[p];_===void 0&&(_={},y[p]=_);for(let b=0;b!==l;++b){const S=s[b],A=S.name;let P=_[A];if(P!==void 0)++P.referenceCount,d[b]=P;else{if(P=d[b],P!==void 0){P._cacheIndex===null&&(++P.referenceCount,this._addInactiveBinding(P,p,A));continue}const L=i&&i._propertyBindings[b].binding.parsedPath;P=new DK(fr.create(a,A,L),S.ValueTypeName,S.getValueSize()),++P.referenceCount,this._addInactiveBinding(P,p,A),d[b]=P}f[b].resultBuffer=P.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(e._cacheIndex===null){const a=(e._localRoot||this._root).uuid,s=e._clip.uuid,l=this._actionsByClip[s];this._bindAction(e,l&&l.knownActions[0]),this._addInactiveAction(e,s,a)}const i=e._propertyBindings;for(let a=0,s=i.length;a!==s;++a){const l=i[a];l.useCount++===0&&(this._lendBinding(l),l.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const i=e._propertyBindings;for(let a=0,s=i.length;a!==s;++a){const l=i[a];--l.useCount===0&&(l.restoreOriginalState(),this._takeBackBinding(l))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const i=e._cacheIndex;return i!==null&&i<this._nActiveActions}_addInactiveAction(e,i,a){const s=this._actions,l=this._actionsByClip;let d=l[i];if(d===void 0)d={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,l[i]=d;else{const f=d.knownActions;e._byClipCacheIndex=f.length,f.push(e)}e._cacheIndex=s.length,s.push(e),d.actionByRoot[a]=e}_removeInactiveAction(e){const i=this._actions,a=i[i.length-1],s=e._cacheIndex;a._cacheIndex=s,i[s]=a,i.pop(),e._cacheIndex=null;const l=e._clip.uuid,d=this._actionsByClip,f=d[l],p=f.knownActions,y=p[p.length-1],_=e._byClipCacheIndex;y._byClipCacheIndex=_,p[_]=y,p.pop(),e._byClipCacheIndex=null;const b=f.actionByRoot,S=(e._localRoot||this._root).uuid;delete b[S],p.length===0&&delete d[l],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const i=e._propertyBindings;for(let a=0,s=i.length;a!==s;++a){const l=i[a];--l.referenceCount===0&&this._removeInactiveBinding(l)}}_lendAction(e){const i=this._actions,a=e._cacheIndex,s=this._nActiveActions++,l=i[s];e._cacheIndex=s,i[s]=e,l._cacheIndex=a,i[a]=l}_takeBackAction(e){const i=this._actions,a=e._cacheIndex,s=--this._nActiveActions,l=i[s];e._cacheIndex=s,i[s]=e,l._cacheIndex=a,i[a]=l}_addInactiveBinding(e,i,a){const s=this._bindingsByRootAndName,l=this._bindings;let d=s[i];d===void 0&&(d={},s[i]=d),d[a]=e,e._cacheIndex=l.length,l.push(e)}_removeInactiveBinding(e){const i=this._bindings,a=e.binding,s=a.rootNode.uuid,l=a.path,d=this._bindingsByRootAndName,f=d[s],p=i[i.length-1],y=e._cacheIndex;p._cacheIndex=y,i[y]=p,i.pop(),delete f[l],Object.keys(f).length===0&&delete d[s]}_lendBinding(e){const i=this._bindings,a=e._cacheIndex,s=this._nActiveBindings++,l=i[s];e._cacheIndex=s,i[s]=e,l._cacheIndex=a,i[a]=l}_takeBackBinding(e){const i=this._bindings,a=e._cacheIndex,s=--this._nActiveBindings,l=i[s];e._cacheIndex=s,i[s]=e,l._cacheIndex=a,i[a]=l}_lendControlInterpolant(){const e=this._controlInterpolants,i=this._nActiveControlInterpolants++;let a=e[i];return a===void 0&&(a=new Uz(new Float32Array(2),new Float32Array(2),1,MMe),a.__cacheIndex=i,e[i]=a),a}_takeBackControlInterpolant(e){const i=this._controlInterpolants,a=e.__cacheIndex,s=--this._nActiveControlInterpolants,l=i[s];e.__cacheIndex=s,i[s]=e,l.__cacheIndex=a,i[a]=l}clipAction(e,i,a){const s=i||this._root,l=s.uuid;let d=typeof e=="string"?Aw.findByName(s,e):e;const f=d!==null?d.uuid:e,p=this._actionsByClip[f];let y=null;if(a===void 0&&(d!==null?a=d.blendMode:a=ZA),p!==void 0){const b=p.actionByRoot[l];if(b!==void 0&&b.blendMode===a)return b;y=p.knownActions[0],d===null&&(d=y._clip)}if(d===null)return null;const _=new zK(this,d,i,a);return this._bindAction(_,y),this._addInactiveAction(_,f,l),_}existingAction(e,i){const a=i||this._root,s=a.uuid,l=typeof e=="string"?Aw.findByName(a,e):e,d=l?l.uuid:e,f=this._actionsByClip[d];return f!==void 0&&f.actionByRoot[s]||null}stopAllAction(){const e=this._actions,i=this._nActiveActions;for(let a=i-1;a>=0;--a)e[a].stop();return this}update(e){e*=this.timeScale;const i=this._actions,a=this._nActiveActions,s=this.time+=e,l=Math.sign(e),d=this._accuIndex^=1;for(let y=0;y!==a;++y)i[y]._update(s,e,l,d);const f=this._bindings,p=this._nActiveBindings;for(let y=0;y!==p;++y)f[y].apply(d);return this}setTime(e){this.time=0;for(let i=0;i<this._actions.length;i++)this._actions[i].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const i=this._actions,a=e.uuid,s=this._actionsByClip,l=s[a];if(l!==void 0){const d=l.knownActions;for(let f=0,p=d.length;f!==p;++f){const y=d[f];this._deactivateAction(y);const _=y._cacheIndex,b=i[i.length-1];y._cacheIndex=null,y._byClipCacheIndex=null,b._cacheIndex=_,i[_]=b,i.pop(),this._removeInactiveBindingsForAction(y)}delete s[a]}}uncacheRoot(e){const i=e.uuid,a=this._actionsByClip;for(const d in a){const f=a[d].actionByRoot,p=f[i];p!==void 0&&(this._deactivateAction(p),this._removeInactiveAction(p))}const s=this._bindingsByRootAndName,l=s[i];if(l!==void 0)for(const d in l){const f=l[d];f.restoreOriginalState(),this._removeInactiveBinding(f)}}uncacheAction(e,i){const a=this.existingAction(e,i);a!==null&&(this._deactivateAction(a),this._removeInactiveAction(a))}}class Xz{constructor(e){this.value=e}clone(){return new Xz(this.value.clone===void 0?this.value:this.value.clone())}}let AMe=0;class CMe extends Ld{constructor(){super(),this.isUniformsGroup=!0,Object.defineProperty(this,"id",{value:AMe++}),this.name="",this.usage=vw,this.uniforms=[]}add(e){return this.uniforms.push(e),this}remove(e){const i=this.uniforms.indexOf(e);return i!==-1&&this.uniforms.splice(i,1),this}setName(e){return this.name=e,this}setUsage(e){return this.usage=e,this}dispose(){return this.dispatchEvent({type:"dispose"}),this}copy(e){this.name=e.name,this.usage=e.usage;const i=e.uniforms;this.uniforms.length=0;for(let a=0,s=i.length;a<s;a++)this.uniforms.push(i[a].clone());return this}clone(){return new this.constructor().copy(this)}}class PMe extends aC{constructor(e,i,a=1){super(e,i),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=a}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const i=super.clone(e);return i.meshPerAttribute=this.meshPerAttribute,i}toJSON(e){const i=super.toJSON(e);return i.isInstancedInterleavedBuffer=!0,i.meshPerAttribute=this.meshPerAttribute,i}}class IMe{constructor(e,i,a,s,l){this.isGLBufferAttribute=!0,this.name="",this.buffer=e,this.type=i,this.itemSize=a,this.elementSize=s,this.count=l,this.version=0}set needsUpdate(e){e===!0&&this.version++}setBuffer(e){return this.buffer=e,this}setType(e,i){return this.type=e,this.elementSize=i,this}setItemSize(e){return this.itemSize=e,this}setCount(e){return this.count=e,this}}class OK{constructor(e,i,a=0,s=1/0){this.ray=new iy(e,i),this.near=a,this.far=s,this.camera=null,this.layers=new Rg,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,i){this.ray.set(e,i)}setFromCamera(e,i){i.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(i.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(i).sub(this.ray.origin).normalize(),this.camera=i):i.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(i.near+i.far)/(i.near-i.far)).unproject(i),this.ray.direction.set(0,0,-1).transformDirection(i.matrixWorld),this.camera=i):console.error("THREE.Raycaster: Unsupported camera type: "+i.type)}intersectObject(e,i=!0,a=[]){return X5(e,this,a,i),a.sort(tG),a}intersectObjects(e,i=!0,a=[]){for(let s=0,l=e.length;s<l;s++)X5(e[s],this,a,i);return a.sort(tG),a}}function tG(n,e){return n.distance-e.distance}function X5(n,e,i,a){if(n.layers.test(e.layers)&&n.raycast(e,i),a===!0){const s=n.children;for(let l=0,d=s.length;l<d;l++)X5(s[l],e,i,!0)}}class Z5{constructor(e=1,i=0,a=0){return this.radius=e,this.phi=i,this.theta=a,this}set(e,i,a){return this.radius=e,this.phi=i,this.theta=a,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,i,a){return this.radius=Math.sqrt(e*e+i*i+a*a),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,a),this.phi=Math.acos(Xa(i/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}class RMe{constructor(e=1,i=0,a=0){return this.radius=e,this.theta=i,this.y=a,this}set(e,i,a){return this.radius=e,this.theta=i,this.y=a,this}copy(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,i,a){return this.radius=Math.sqrt(e*e+a*a),this.theta=Math.atan2(e,a),this.y=i,this}clone(){return new this.constructor().copy(this)}}const nG=new tn;class LMe{constructor(e=new tn(1/0,1/0),i=new tn(-1/0,-1/0)){this.isBox2=!0,this.min=e,this.max=i}set(e,i){return this.min.copy(e),this.max.copy(i),this}setFromPoints(e){this.makeEmpty();for(let i=0,a=e.length;i<a;i++)this.expandByPoint(e[i]);return this}setFromCenterAndSize(e,i){const a=nG.copy(i).multiplyScalar(.5);return this.min.copy(e).sub(a),this.max.copy(e).add(a),this}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,i){return i.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)}clampPoint(e,i){return i.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,nG).distanceTo(e)}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const iG=new We,mE=new We;class kMe{constructor(e=new We,i=new We){this.start=e,this.end=i}set(e,i){return this.start.copy(e),this.end.copy(i),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,i){return this.delta(i).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,i){iG.subVectors(e,this.start),mE.subVectors(this.end,this.start);const a=mE.dot(mE);let l=mE.dot(iG)/a;return i&&(l=Xa(l,0,1)),l}closestPointToPoint(e,i,a){const s=this.closestPointToPointParameter(e,i);return this.delta(a).multiplyScalar(s).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return new this.constructor().copy(this)}}const rG=new We;class DMe extends br{constructor(e,i){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=i,this.type="SpotLightHelper";const a=new zi,s=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let d=0,f=1,p=32;d<p;d++,f++){const y=d/p*Math.PI*2,_=f/p*Math.PI*2;s.push(Math.cos(y),Math.sin(y),1,Math.cos(_),Math.sin(_),1)}a.setAttribute("position",new jn(s,3));const l=new Ks({fog:!1,toneMapped:!1});this.cone=new kd(a,l),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1);const e=this.light.distance?this.light.distance:1e3,i=e*Math.tan(this.light.angle);this.cone.scale.set(i,i,e),rG.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(rG),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const qf=new We,gE=new Di,mL=new Di;class zMe extends kd{constructor(e){const i=NK(e),a=new zi,s=[],l=[],d=new In(0,0,1),f=new In(0,1,0);for(let y=0;y<i.length;y++){const _=i[y];_.parent&&_.parent.isBone&&(s.push(0,0,0),s.push(0,0,0),l.push(d.r,d.g,d.b),l.push(f.r,f.g,f.b))}a.setAttribute("position",new jn(s,3)),a.setAttribute("color",new jn(l,3));const p=new Ks({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});super(a,p),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=e,this.bones=i,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(e){const i=this.bones,a=this.geometry,s=a.getAttribute("position");mL.copy(this.root.matrixWorld).invert();for(let l=0,d=0;l<i.length;l++){const f=i[l];f.parent&&f.parent.isBone&&(gE.multiplyMatrices(mL,f.matrixWorld),qf.setFromMatrixPosition(gE),s.setXYZ(d,qf.x,qf.y,qf.z),gE.multiplyMatrices(mL,f.parent.matrixWorld),qf.setFromMatrixPosition(gE),s.setXYZ(d+1,qf.x,qf.y,qf.z),d+=2)}a.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose()}}function NK(n){const e=[];n.isBone===!0&&e.push(n);for(let i=0;i<n.children.length;i++)e.push.apply(e,NK(n.children[i]));return e}class OMe extends Eo{constructor(e,i,a){const s=new oS(i,4,2),l=new Kh({wireframe:!0,fog:!1,toneMapped:!1});super(s,l),this.light=e,this.color=a,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const NMe=new We,aG=new In,oG=new In;class FMe extends br{constructor(e,i,a){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=a,this.type="HemisphereLightHelper";const s=new aS(i);s.rotateY(Math.PI*.5),this.material=new Kh({wireframe:!0,fog:!1,toneMapped:!1}),this.color===void 0&&(this.material.vertexColors=!0);const l=s.getAttribute("position"),d=new Float32Array(l.count*3);s.setAttribute("color",new Qr(d,3)),this.add(new Eo(s,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const e=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{const i=e.geometry.getAttribute("color");aG.copy(this.light.color),oG.copy(this.light.groundColor);for(let a=0,s=i.count;a<s;a++){const l=a<s/2?aG:oG;i.setXYZ(a,l.r,l.g,l.b)}i.needsUpdate=!0}this.light.updateWorldMatrix(!0,!1),e.lookAt(NMe.setFromMatrixPosition(this.light.matrixWorld).negate())}}class BMe extends kd{constructor(e=10,i=10,a=4473924,s=8947848){a=new In(a),s=new In(s);const l=i/2,d=e/i,f=e/2,p=[],y=[];for(let S=0,A=0,P=-f;S<=i;S++,P+=d){p.push(-f,0,P,f,0,P),p.push(P,0,-f,P,0,f);const L=S===l?a:s;L.toArray(y,A),A+=3,L.toArray(y,A),A+=3,L.toArray(y,A),A+=3,L.toArray(y,A),A+=3}const _=new zi;_.setAttribute("position",new jn(p,3)),_.setAttribute("color",new jn(y,3));const b=new Ks({vertexColors:!0,toneMapped:!1});super(_,b),this.type="GridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}class UMe extends kd{constructor(e=10,i=16,a=8,s=64,l=4473924,d=8947848){l=new In(l),d=new In(d);const f=[],p=[];if(i>1)for(let b=0;b<i;b++){const S=b/i*(Math.PI*2),A=Math.sin(S)*e,P=Math.cos(S)*e;f.push(0,0,0),f.push(A,0,P);const L=b&1?l:d;p.push(L.r,L.g,L.b),p.push(L.r,L.g,L.b)}for(let b=0;b<a;b++){const S=b&1?l:d,A=e-e/a*b;for(let P=0;P<s;P++){let L=P/s*(Math.PI*2),k=Math.sin(L)*A,R=Math.cos(L)*A;f.push(k,0,R),p.push(S.r,S.g,S.b),L=(P+1)/s*(Math.PI*2),k=Math.sin(L)*A,R=Math.cos(L)*A,f.push(k,0,R),p.push(S.r,S.g,S.b)}}const y=new zi;y.setAttribute("position",new jn(f,3)),y.setAttribute("color",new jn(p,3));const _=new Ks({vertexColors:!0,toneMapped:!1});super(y,_),this.type="PolarGridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}const sG=new We,yE=new We,lG=new We;class WMe extends br{constructor(e,i,a){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=a,this.type="DirectionalLightHelper",i===void 0&&(i=1);let s=new zi;s.setAttribute("position",new jn([-i,i,0,i,i,0,i,-i,0,-i,-i,0,-i,i,0],3));const l=new Ks({fog:!1,toneMapped:!1});this.lightPlane=new Pp(s,l),this.add(this.lightPlane),s=new zi,s.setAttribute("position",new jn([0,0,0,0,0,1],3)),this.targetLine=new Pp(s,l),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),sG.setFromMatrixPosition(this.light.matrixWorld),yE.setFromMatrixPosition(this.light.target.matrixWorld),lG.subVectors(yE,sG),this.lightPlane.lookAt(yE),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(yE),this.targetLine.scale.z=lG.length()}}const vE=new We,Ga=new nS;class VMe extends kd{constructor(e){const i=new zi,a=new Ks({color:16777215,vertexColors:!0,toneMapped:!1}),s=[],l=[],d={};f("n1","n2"),f("n2","n4"),f("n4","n3"),f("n3","n1"),f("f1","f2"),f("f2","f4"),f("f4","f3"),f("f3","f1"),f("n1","f1"),f("n2","f2"),f("n3","f3"),f("n4","f4"),f("p","n1"),f("p","n2"),f("p","n3"),f("p","n4"),f("u1","u2"),f("u2","u3"),f("u3","u1"),f("c","t"),f("p","c"),f("cn1","cn2"),f("cn3","cn4"),f("cf1","cf2"),f("cf3","cf4");function f(P,L){p(P),p(L)}function p(P){s.push(0,0,0),l.push(0,0,0),d[P]===void 0&&(d[P]=[]),d[P].push(s.length/3-1)}i.setAttribute("position",new jn(s,3)),i.setAttribute("color",new jn(l,3)),super(i,a),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=d,this.update();const y=new In(16755200),_=new In(16711680),b=new In(43775),S=new In(16777215),A=new In(3355443);this.setColors(y,_,b,S,A)}setColors(e,i,a,s,l){const f=this.geometry.getAttribute("color");f.setXYZ(0,e.r,e.g,e.b),f.setXYZ(1,e.r,e.g,e.b),f.setXYZ(2,e.r,e.g,e.b),f.setXYZ(3,e.r,e.g,e.b),f.setXYZ(4,e.r,e.g,e.b),f.setXYZ(5,e.r,e.g,e.b),f.setXYZ(6,e.r,e.g,e.b),f.setXYZ(7,e.r,e.g,e.b),f.setXYZ(8,e.r,e.g,e.b),f.setXYZ(9,e.r,e.g,e.b),f.setXYZ(10,e.r,e.g,e.b),f.setXYZ(11,e.r,e.g,e.b),f.setXYZ(12,e.r,e.g,e.b),f.setXYZ(13,e.r,e.g,e.b),f.setXYZ(14,e.r,e.g,e.b),f.setXYZ(15,e.r,e.g,e.b),f.setXYZ(16,e.r,e.g,e.b),f.setXYZ(17,e.r,e.g,e.b),f.setXYZ(18,e.r,e.g,e.b),f.setXYZ(19,e.r,e.g,e.b),f.setXYZ(20,e.r,e.g,e.b),f.setXYZ(21,e.r,e.g,e.b),f.setXYZ(22,e.r,e.g,e.b),f.setXYZ(23,e.r,e.g,e.b),f.setXYZ(24,i.r,i.g,i.b),f.setXYZ(25,i.r,i.g,i.b),f.setXYZ(26,i.r,i.g,i.b),f.setXYZ(27,i.r,i.g,i.b),f.setXYZ(28,i.r,i.g,i.b),f.setXYZ(29,i.r,i.g,i.b),f.setXYZ(30,i.r,i.g,i.b),f.setXYZ(31,i.r,i.g,i.b),f.setXYZ(32,a.r,a.g,a.b),f.setXYZ(33,a.r,a.g,a.b),f.setXYZ(34,a.r,a.g,a.b),f.setXYZ(35,a.r,a.g,a.b),f.setXYZ(36,a.r,a.g,a.b),f.setXYZ(37,a.r,a.g,a.b),f.setXYZ(38,s.r,s.g,s.b),f.setXYZ(39,s.r,s.g,s.b),f.setXYZ(40,l.r,l.g,l.b),f.setXYZ(41,l.r,l.g,l.b),f.setXYZ(42,l.r,l.g,l.b),f.setXYZ(43,l.r,l.g,l.b),f.setXYZ(44,l.r,l.g,l.b),f.setXYZ(45,l.r,l.g,l.b),f.setXYZ(46,l.r,l.g,l.b),f.setXYZ(47,l.r,l.g,l.b),f.setXYZ(48,l.r,l.g,l.b),f.setXYZ(49,l.r,l.g,l.b),f.needsUpdate=!0}update(){const e=this.geometry,i=this.pointMap,a=1,s=1;Ga.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),oo("c",i,e,Ga,0,0,-1),oo("t",i,e,Ga,0,0,1),oo("n1",i,e,Ga,-a,-s,-1),oo("n2",i,e,Ga,a,-s,-1),oo("n3",i,e,Ga,-a,s,-1),oo("n4",i,e,Ga,a,s,-1),oo("f1",i,e,Ga,-a,-s,1),oo("f2",i,e,Ga,a,-s,1),oo("f3",i,e,Ga,-a,s,1),oo("f4",i,e,Ga,a,s,1),oo("u1",i,e,Ga,a*.7,s*1.1,-1),oo("u2",i,e,Ga,-a*.7,s*1.1,-1),oo("u3",i,e,Ga,0,s*2,-1),oo("cf1",i,e,Ga,-a,0,1),oo("cf2",i,e,Ga,a,0,1),oo("cf3",i,e,Ga,0,-s,1),oo("cf4",i,e,Ga,0,s,1),oo("cn1",i,e,Ga,-a,0,-1),oo("cn2",i,e,Ga,a,0,-1),oo("cn3",i,e,Ga,0,-s,-1),oo("cn4",i,e,Ga,0,s,-1),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function oo(n,e,i,a,s,l,d){vE.set(s,l,d).unproject(a);const f=e[n];if(f!==void 0){const p=i.getAttribute("position");for(let y=0,_=f.length;y<_;y++)p.setXYZ(f[y],vE.x,vE.y,vE.z)}}const _E=new Su;class GMe extends kd{constructor(e,i=16776960){const a=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),s=new Float32Array(8*3),l=new zi;l.setIndex(new Qr(a,1)),l.setAttribute("position",new Qr(s,3)),super(l,new Ks({color:i,toneMapped:!1})),this.object=e,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(e){if(e!==void 0&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),this.object!==void 0&&_E.setFromObject(this.object),_E.isEmpty())return;const i=_E.min,a=_E.max,s=this.geometry.attributes.position,l=s.array;l[0]=a.x,l[1]=a.y,l[2]=a.z,l[3]=i.x,l[4]=a.y,l[5]=a.z,l[6]=i.x,l[7]=i.y,l[8]=a.z,l[9]=a.x,l[10]=i.y,l[11]=a.z,l[12]=a.x,l[13]=a.y,l[14]=i.z,l[15]=i.x,l[16]=a.y,l[17]=i.z,l[18]=i.x,l[19]=i.y,l[20]=i.z,l[21]=a.x,l[22]=i.y,l[23]=i.z,s.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(e){return this.object=e,this.update(),this}copy(e,i){return super.copy(e,i),this.object=e.object,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class HMe extends kd{constructor(e,i=16776960){const a=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),s=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],l=new zi;l.setIndex(new Qr(a,1)),l.setAttribute("position",new jn(s,3)),super(l,new Ks({color:i,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){const i=this.box;i.isEmpty()||(i.getCenter(this.position),i.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}dispose(){this.geometry.dispose(),this.material.dispose()}}class jMe extends Pp{constructor(e,i=1,a=16776960){const s=a,l=[1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],d=new zi;d.setAttribute("position",new jn(l,3)),d.computeBoundingSphere(),super(d,new Ks({color:s,toneMapped:!1})),this.type="PlaneHelper",this.plane=e,this.size=i;const f=[1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],p=new zi;p.setAttribute("position",new jn(f,3)),p.computeBoundingSphere(),this.add(new Eo(p,new Kh({color:s,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(e){this.position.set(0,0,0),this.scale.set(.5*this.size,.5*this.size,1),this.lookAt(this.plane.normal),this.translateZ(-this.plane.constant),super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}}const cG=new We;let xE,gL;class $Me extends br{constructor(e=new We(0,0,1),i=new We(0,0,0),a=1,s=16776960,l=a*.2,d=l*.2){super(),this.type="ArrowHelper",xE===void 0&&(xE=new zi,xE.setAttribute("position",new jn([0,0,0,0,1,0],3)),gL=new k_(0,.5,1,5,1),gL.translate(0,-.5,0)),this.position.copy(i),this.line=new Pp(xE,new Ks({color:s,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new Eo(gL,new Kh({color:s,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(a,l,d)}setDirection(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{cG.set(e.z,0,-e.x).normalize();const i=Math.acos(e.y);this.quaternion.setFromAxisAngle(cG,i)}}setLength(e,i=e*.2,a=i*.2){this.line.scale.set(1,Math.max(1e-4,e-i),1),this.line.updateMatrix(),this.cone.scale.set(a,i,a),this.cone.position.y=e,this.cone.updateMatrix()}setColor(e){this.line.material.color.set(e),this.cone.material.color.set(e)}copy(e){return super.copy(e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}dispose(){this.line.geometry.dispose(),this.line.material.dispose(),this.cone.geometry.dispose(),this.cone.material.dispose()}}class YMe extends kd{constructor(e=1){const i=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],a=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],s=new zi;s.setAttribute("position",new jn(i,3)),s.setAttribute("color",new jn(a,3));const l=new Ks({vertexColors:!0,toneMapped:!1});super(s,l),this.type="AxesHelper"}setColors(e,i,a){const s=new In,l=this.geometry.attributes.color.array;return s.set(e),s.toArray(l,0),s.toArray(l,3),s.set(i),s.toArray(l,6),s.toArray(l,9),s.set(a),s.toArray(l,12),s.toArray(l,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class qMe{constructor(){this.type="ShapePath",this.color=new In,this.subPaths=[],this.currentPath=null}moveTo(e,i){return this.currentPath=new bw,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,i),this}lineTo(e,i){return this.currentPath.lineTo(e,i),this}quadraticCurveTo(e,i,a,s){return this.currentPath.quadraticCurveTo(e,i,a,s),this}bezierCurveTo(e,i,a,s,l,d){return this.currentPath.bezierCurveTo(e,i,a,s,l,d),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e){function i(R){const z=[];for(let O=0,F=R.length;O<F;O++){const H=R[O],$=new Lg;$.curves=H.curves,z.push($)}return z}function a(R,z){const O=z.length;let F=!1;for(let H=O-1,$=0;$<O;H=$++){let Y=z[H],te=z[$],G=te.x-Y.x,Q=te.y-Y.y;if(Math.abs(Q)>Number.EPSILON){if(Q<0&&(Y=z[$],G=-G,te=z[H],Q=-Q),R.y<Y.y||R.y>te.y)continue;if(R.y===Y.y){if(R.x===Y.x)return!0}else{const he=Q*(R.x-Y.x)-G*(R.y-Y.y);if(he===0)return!0;if(he<0)continue;F=!F}}else{if(R.y!==Y.y)continue;if(te.x<=R.x&&R.x<=Y.x||Y.x<=R.x&&R.x<=te.x)return!0}}return F}const s=Sd.isClockWise,l=this.subPaths;if(l.length===0)return[];let d,f,p;const y=[];if(l.length===1)return f=l[0],p=new Lg,p.curves=f.curves,y.push(p),y;let _=!s(l[0].getPoints());_=e?!_:_;const b=[],S=[];let A=[],P=0,L;S[P]=void 0,A[P]=[];for(let R=0,z=l.length;R<z;R++)f=l[R],L=f.getPoints(),d=s(L),d=e?!d:d,d?(!_&&S[P]&&P++,S[P]={s:new Lg,p:L},S[P].s.curves=f.curves,_&&P++,A[P]=[]):A[P].push({h:f,p:L[0]});if(!S[0])return i(l);if(S.length>1){let R=!1,z=0;for(let O=0,F=S.length;O<F;O++)b[O]=[];for(let O=0,F=S.length;O<F;O++){const H=A[O];for(let $=0;$<H.length;$++){const Y=H[$];let te=!0;for(let G=0;G<S.length;G++)a(Y.p,S[G].p)&&(O!==G&&z++,te?(te=!1,b[G].push(Y)):R=!0);te&&b[O].push(Y)}}z>0&&R===!1&&(A=b)}let k;for(let R=0,z=S.length;R<z;R++){p=S[R].s,y.push(p),k=A[R];for(let O=0,F=k.length;O<F;O++)p.holes.push(k[O].h)}return y}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:$A}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=$A);const XMe=Object.freeze(Object.defineProperty({__proto__:null,ACESFilmicToneMapping:uz,AddEquation:tp,AddOperation:eZ,AdditiveAnimationBlendMode:vz,AdditiveBlending:l5,AlphaFormat:lZ,AlwaysCompare:AZ,AlwaysDepth:YX,AlwaysStencilFunc:B5,AmbientLight:CK,AnimationAction:zK,AnimationClip:Aw,AnimationLoader:JEe,AnimationMixer:TMe,AnimationObjectGroup:EMe,AnimationUtils:qEe,ArcCurve:JZ,ArrayCamera:VZ,ArrowHelper:$Me,AttachedBindMode:f5,Audio:kK,AudioAnalyser:pMe,AudioContext:jz,AudioListener:dMe,AudioLoader:lMe,AxesHelper:YMe,BackSide:Ts,BasicDepthPacking:vZ,BasicShadowMap:PX,Bone:Iz,BooleanKeyframeTrack:ay,Box2:LMe,Box3:Su,Box3Helper:HMe,BoxGeometry:ry,BoxHelper:GMe,BufferAttribute:Qr,BufferGeometry:zi,BufferGeometryLoader:LK,ByteType:oZ,Cache:Xg,Camera:nS,CameraHelper:VMe,CanvasTexture:vEe,CapsuleGeometry:cC,CatmullRomCurve3:QZ,CineonToneMapping:iZ,CircleGeometry:uC,ClampToEdgeWrapping:Ss,Clock:$z,Color:In,ColorKeyframeTrack:Wz,ColorManagement:Vr,CompressedArrayTexture:gEe,CompressedCubeTexture:yEe,CompressedTexture:sC,CompressedTextureLoader:QEe,ConeGeometry:dC,ConstantAlphaFactor:HX,ConstantColorFactor:VX,CubeCamera:DZ,CubeReflectionMapping:Yh,CubeRefractionMapping:Ap,CubeTexture:iS,CubeTextureLoader:eMe,CubeUVReflectionMapping:R_,CubicBezierCurve:kz,CubicBezierCurve3:eK,CubicInterpolant:_K,CullFaceBack:s5,CullFaceFront:CX,CullFaceFrontBack:pxe,CullFaceNone:AX,Curve:Eu,CurvePath:nK,CustomBlending:IX,CustomToneMapping:rZ,CylinderGeometry:k_,Cylindrical:RMe,Data3DTexture:Sz,DataArrayTexture:JA,DataTexture:J0,DataTextureLoader:tMe,DataUtils:Sbe,DecrementStencilOp:Txe,DecrementWrapStencilOp:Cxe,DefaultLoadingManager:wK,DepthFormat:_p,DepthStencilFormat:jg,DepthTexture:GZ,DetachedBindMode:aZ,DirectionalLight:AK,DirectionalLightHelper:WMe,DiscreteInterpolant:xK,DisplayP3ColorSpace:KA,DodecahedronGeometry:hC,DoubleSide:Xl,DstAlphaFactor:NX,DstColorFactor:BX,DynamicCopyUsage:Gxe,DynamicDrawUsage:Nxe,DynamicReadUsage:Uxe,EdgesGeometry:iK,EllipseCurve:lC,EqualCompare:wZ,EqualDepth:XX,EqualStencilFunc:Lxe,EquirectangularReflectionMapping:lw,EquirectangularRefractionMapping:cw,Euler:tS,EventDispatcher:Ld,ExtrudeGeometry:pC,FileLoader:qh,Float16BufferAttribute:Pbe,Float32BufferAttribute:jn,Float64BufferAttribute:Ibe,FloatType:md,Fog:rC,FogExp2:iC,FramebufferTexture:mEe,FrontSide:Ad,Frustum:QA,GLBufferAttribute:IMe,GLSL1:jxe,GLSL3:U5,GreaterCompare:EZ,GreaterDepth:KX,GreaterEqualCompare:TZ,GreaterEqualDepth:ZX,GreaterEqualStencilFunc:Oxe,GreaterStencilFunc:Dxe,GridHelper:BMe,Group:N0,HalfFloatType:v_,HemisphereLight:EK,HemisphereLightHelper:FMe,IcosahedronGeometry:mC,ImageBitmapLoader:sMe,ImageLoader:Cw,ImageUtils:wz,IncrementStencilOp:Mxe,IncrementWrapStencilOp:Axe,InstancedBufferAttribute:Yg,InstancedBufferGeometry:Hz,InstancedInterleavedBuffer:PMe,InstancedMesh:XZ,Int16BufferAttribute:Abe,Int32BufferAttribute:Cbe,Int8BufferAttribute:Ebe,IntType:hz,InterleavedBuffer:aC,InterleavedBufferAttribute:$g,Interpolant:sS,InterpolateDiscrete:hw,InterpolateLinear:fw,InterpolateSmooth:vM,InvertStencilOp:Pxe,KeepStencilOp:cg,KeyframeTrack:Mu,LOD:YZ,LatheGeometry:rS,Layers:Rg,LessCompare:bZ,LessDepth:qX,LessEqualCompare:SZ,LessEqualDepth:sw,LessEqualStencilFunc:kxe,LessStencilFunc:Rxe,Light:Up,LightProbe:RK,Line:Pp,Line3:kMe,LineBasicMaterial:Ks,LineCurve:Dz,LineCurve3:tK,LineDashedMaterial:gK,LineLoop:ZZ,LineSegments:kd,LinearDisplayP3ColorSpace:eS,LinearEncoding:_z,LinearFilter:ka,LinearInterpolant:Uz,LinearMipMapLinearFilter:_xe,LinearMipMapNearestFilter:vxe,LinearMipmapLinearFilter:Cp,LinearMipmapNearestFilter:dz,LinearSRGBColorSpace:Cd,LinearToneMapping:tZ,LinearTransfer:mw,Loader:Il,LoaderUtils:q5,LoadingManager:Vz,LoopOnce:mZ,LoopPingPong:yZ,LoopRepeat:gZ,LuminanceAlphaFormat:uZ,LuminanceFormat:cZ,MOUSE:sg,Material:rs,MaterialLoader:wC,MathUtils:abe,Matrix3:Vi,Matrix4:Di,MaxEquation:h5,Mesh:Eo,MeshBasicMaterial:Kh,MeshDepthMaterial:tC,MeshDistanceMaterial:nC,MeshLambertMaterial:pK,MeshMatcapMaterial:mK,MeshNormalMaterial:fK,MeshPhongMaterial:dK,MeshPhysicalMaterial:uK,MeshStandardMaterial:Fz,MeshToonMaterial:hK,MinEquation:d5,MirroredRepeatWrapping:dw,MixOperation:QX,MultiplyBlending:u5,MultiplyOperation:Qw,NearestFilter:co,NearestMipMapLinearFilter:yxe,NearestMipMapNearestFilter:gxe,NearestMipmapLinearFilter:_b,NearestMipmapNearestFilter:mT,NeverCompare:xZ,NeverDepth:$X,NeverStencilFunc:Ixe,NoBlending:Wh,NoColorSpace:Zl,NoToneMapping:bd,NormalAnimationBlendMode:ZA,NormalBlending:Pg,NotEqualCompare:MZ,NotEqualDepth:JX,NotEqualStencilFunc:zxe,NumberKeyframeTrack:Mw,Object3D:br,ObjectLoader:aMe,ObjectSpaceNormalMap:_Z,OctahedronGeometry:aS,OneFactor:DX,OneMinusConstantAlphaFactor:jX,OneMinusConstantColorFactor:GX,OneMinusDstAlphaFactor:FX,OneMinusDstColorFactor:UX,OneMinusSrcAlphaFactor:pT,OneMinusSrcColorFactor:OX,OrthographicCamera:Oh,P3Primaries:yw,PCFShadowMap:YA,PCFSoftShadowMap:vb,PMREMGenerator:V5,Path:bw,PerspectiveCamera:Za,Plane:Ph,PlaneGeometry:Fp,PlaneHelper:jMe,PointLight:TK,PointLightHelper:OMe,Points:KZ,PointsMaterial:Rz,PolarGridHelper:UMe,PolyhedronGeometry:Bp,PositionalAudio:fMe,PropertyBinding:fr,PropertyMixer:DK,QuadraticBezierCurve:zz,QuadraticBezierCurve3:Oz,Quaternion:As,QuaternionKeyframeTrack:D_,QuaternionLinearInterpolant:bK,RED_GREEN_RGTC2_Format:N5,RED_RGTC1_Format:pZ,REVISION:$A,RGBADepthPacking:xz,RGBAFormat:vl,RGBAIntegerFormat:yz,RGBA_ASTC_10x10_Format:R5,RGBA_ASTC_10x5_Format:C5,RGBA_ASTC_10x6_Format:P5,RGBA_ASTC_10x8_Format:I5,RGBA_ASTC_12x10_Format:L5,RGBA_ASTC_12x12_Format:k5,RGBA_ASTC_4x4_Format:x5,RGBA_ASTC_5x4_Format:b5,RGBA_ASTC_5x5_Format:w5,RGBA_ASTC_6x5_Format:S5,RGBA_ASTC_6x6_Format:E5,RGBA_ASTC_8x5_Format:M5,RGBA_ASTC_8x6_Format:T5,RGBA_ASTC_8x8_Format:A5,RGBA_BPTC_Format:yM,RGBA_ETC2_EAC_Format:_5,RGBA_PVRTC_2BPPV1_Format:y5,RGBA_PVRTC_4BPPV1_Format:g5,RGBA_S3TC_DXT1_Format:pM,RGBA_S3TC_DXT3_Format:mM,RGBA_S3TC_DXT5_Format:gM,RGB_BPTC_SIGNED_Format:D5,RGB_BPTC_UNSIGNED_Format:z5,RGB_ETC1_Format:fZ,RGB_ETC2_Format:v5,RGB_PVRTC_2BPPV1_Format:m5,RGB_PVRTC_4BPPV1_Format:p5,RGB_S3TC_DXT1_Format:fM,RGFormat:hZ,RGIntegerFormat:gz,RawShaderMaterial:cK,Ray:iy,Raycaster:OK,Rec709Primaries:gw,RectAreaLight:PK,RedFormat:dZ,RedIntegerFormat:mz,ReinhardToneMapping:nZ,RenderTarget:RZ,RepeatWrapping:uw,ReplaceStencilOp:Exe,ReverseSubtractEquation:LX,RingGeometry:gC,SIGNED_RED_GREEN_RGTC2_Format:F5,SIGNED_RED_RGTC1_Format:O5,SRGBColorSpace:Lo,SRGBTransfer:ra,Scene:vT,ShaderChunk:Bi,ShaderLib:pu,ShaderMaterial:Pd,ShadowMaterial:lK,Shape:Lg,ShapeGeometry:yC,ShapePath:qMe,ShapeUtils:Sd,ShortType:sZ,Skeleton:oC,SkeletonHelper:zMe,SkinnedMesh:qZ,Source:bg,Sphere:Fc,SphereGeometry:oS,Spherical:Z5,SphericalHarmonics3:IK,SplineCurve:Nz,SpotLight:MK,SpotLightHelper:DMe,Sprite:$Z,SpriteMaterial:Pz,SrcAlphaFactor:fT,SrcAlphaSaturateFactor:WX,SrcColorFactor:zX,StaticCopyUsage:Vxe,StaticDrawUsage:vw,StaticReadUsage:Bxe,StereoCamera:cMe,StreamCopyUsage:Hxe,StreamDrawUsage:Fxe,StreamReadUsage:Wxe,StringKeyframeTrack:oy,SubtractEquation:RX,SubtractiveBlending:c5,TOUCH:lg,TangentSpaceNormalMap:Np,TetrahedronGeometry:vC,Texture:Oa,TextureLoader:SK,TorusGeometry:_C,TorusKnotGeometry:xC,Triangle:yl,TriangleFanDrawMode:wxe,TriangleStripDrawMode:bxe,TrianglesDrawMode:xxe,TubeGeometry:bC,TwoPassDoubleSide:mxe,UVMapping:qA,Uint16BufferAttribute:Ez,Uint32BufferAttribute:Mz,Uint8BufferAttribute:Mbe,Uint8ClampedBufferAttribute:Tbe,Uniform:Xz,UniformsGroup:CMe,UniformsLib:Sn,UniformsUtils:Tz,UnsignedByteType:wd,UnsignedInt248Type:vp,UnsignedIntType:zh,UnsignedShort4444Type:fz,UnsignedShort5551Type:pz,UnsignedShortType:XA,VSMShadowMap:uu,Vector2:tn,Vector3:We,Vector4:Lr,VectorKeyframeTrack:Tw,VideoTexture:pEe,WebGL1Renderer:HZ,WebGL3DRenderTarget:dbe,WebGLArrayRenderTarget:ube,WebGLCoordinateSystem:gd,WebGLCubeRenderTarget:zZ,WebGLMultipleRenderTargets:hbe,WebGLRenderTarget:wu,WebGLRenderer:Cz,WebGLUtils:WZ,WebGPUCoordinateSystem:_w,WireframeGeometry:sK,WrapAroundEnding:pw,ZeroCurvatureEnding:_g,ZeroFactor:kX,ZeroSlopeEnding:xg,ZeroStencilOp:Sxe,_SRGBAFormat:gT,createCanvasElement:IZ,sRGBEncoding:xp},Symbol.toStringTag,{value:"Module"}));var FK={exports:{}},sy={};/**
 * @license React
 * react-reconciler-constants.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */sy.ConcurrentRoot=1;sy.ContinuousEventPriority=4;sy.DefaultEventPriority=16;sy.DiscreteEventPriority=1;sy.IdleEventPriority=536870912;sy.LegacyRoot=0;FK.exports=sy;var B0=FK.exports;function ZMe(n){let e;const i=new Set,a=(y,_)=>{const b=typeof y=="function"?y(e):y;if(b!==e){const S=e;e=_?b:Object.assign({},e,b),i.forEach(A=>A(e,S))}},s=()=>e,l=(y,_=s,b=Object.is)=>{console.warn("[DEPRECATED] Please use `subscribeWithSelector` middleware");let S=_(e);function A(){const P=_(e);if(!b(S,P)){const L=S;y(S=P,L)}}return i.add(A),()=>i.delete(A)},p={setState:a,getState:s,subscribe:(y,_,b)=>_||b?l(y,_,b):(i.add(y),()=>i.delete(y)),destroy:()=>i.clear()};return e=n(a,s,p),p}const KMe=typeof window>"u"||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent),uG=KMe?ne.useEffect:ne.useLayoutEffect;function JMe(n){const e=typeof n=="function"?ZMe(n):n,i=(a=e.getState,s=Object.is)=>{const[,l]=ne.useReducer(k=>k+1,0),d=e.getState(),f=ne.useRef(d),p=ne.useRef(a),y=ne.useRef(s),_=ne.useRef(!1),b=ne.useRef();b.current===void 0&&(b.current=a(d));let S,A=!1;(f.current!==d||p.current!==a||y.current!==s||_.current)&&(S=a(d),A=!s(b.current,S)),uG(()=>{A&&(b.current=S),f.current=d,p.current=a,y.current=s,_.current=!1});const P=ne.useRef(d);uG(()=>{const k=()=>{try{const z=e.getState(),O=p.current(z);y.current(b.current,O)||(f.current=z,b.current=O,l())}catch{_.current=!0,l()}},R=e.subscribe(k);return e.getState()!==P.current&&k(),R},[]);const L=A?S:b.current;return ne.useDebugValue(L),L};return Object.assign(i,e),i[Symbol.iterator]=function(){console.warn("[useStore, api] = create() is deprecated and will be removed in v4");const a=[i,e];return{next(){const s=a.length<=0;return{value:a.shift(),done:s}}}},i}var BK={exports:{}},yL={exports:{}},vL={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var dG;function QMe(){return dG||(dG=1,function(n){function e(le,me){var we=le.length;le.push(me);e:for(;0<we;){var re=we-1>>>1,Te=le[re];if(0<s(Te,me))le[re]=me,le[we]=Te,we=re;else break e}}function i(le){return le.length===0?null:le[0]}function a(le){if(le.length===0)return null;var me=le[0],we=le.pop();if(we!==me){le[0]=we;e:for(var re=0,Te=le.length,Je=Te>>>1;re<Je;){var Xe=2*(re+1)-1,Ze=le[Xe],Fe=Xe+1,ct=le[Fe];if(0>s(Ze,we))Fe<Te&&0>s(ct,Ze)?(le[re]=ct,le[Fe]=we,re=Fe):(le[re]=Ze,le[Xe]=we,re=Xe);else if(Fe<Te&&0>s(ct,we))le[re]=ct,le[Fe]=we,re=Fe;else break e}}return me}function s(le,me){var we=le.sortIndex-me.sortIndex;return we!==0?we:le.id-me.id}if(typeof performance=="object"&&typeof performance.now=="function"){var l=performance;n.unstable_now=function(){return l.now()}}else{var d=Date,f=d.now();n.unstable_now=function(){return d.now()-f}}var p=[],y=[],_=1,b=null,S=3,A=!1,P=!1,L=!1,k=typeof setTimeout=="function"?setTimeout:null,R=typeof clearTimeout=="function"?clearTimeout:null,z=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function O(le){for(var me=i(y);me!==null;){if(me.callback===null)a(y);else if(me.startTime<=le)a(y),me.sortIndex=me.expirationTime,e(p,me);else break;me=i(y)}}function F(le){if(L=!1,O(le),!P)if(i(p)!==null)P=!0,Re(H);else{var me=i(y);me!==null&&Be(F,me.startTime-le)}}function H(le,me){P=!1,L&&(L=!1,R(te),te=-1),A=!0;var we=S;try{for(O(me),b=i(p);b!==null&&(!(b.expirationTime>me)||le&&!he());){var re=b.callback;if(typeof re=="function"){b.callback=null,S=b.priorityLevel;var Te=re(b.expirationTime<=me);me=n.unstable_now(),typeof Te=="function"?b.callback=Te:b===i(p)&&a(p),O(me)}else a(p);b=i(p)}if(b!==null)var Je=!0;else{var Xe=i(y);Xe!==null&&Be(F,Xe.startTime-me),Je=!1}return Je}finally{b=null,S=we,A=!1}}var $=!1,Y=null,te=-1,G=5,Q=-1;function he(){return!(n.unstable_now()-Q<G)}function pe(){if(Y!==null){var le=n.unstable_now();Q=le;var me=!0;try{me=Y(!0,le)}finally{me?ye():($=!1,Y=null)}}else $=!1}var ye;if(typeof z=="function")ye=function(){z(pe)};else if(typeof MessageChannel<"u"){var fe=new MessageChannel,Ae=fe.port2;fe.port1.onmessage=pe,ye=function(){Ae.postMessage(null)}}else ye=function(){k(pe,0)};function Re(le){Y=le,$||($=!0,ye())}function Be(le,me){te=k(function(){le(n.unstable_now())},me)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(le){le.callback=null},n.unstable_continueExecution=function(){P||A||(P=!0,Re(H))},n.unstable_forceFrameRate=function(le){0>le||125<le?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):G=0<le?Math.floor(1e3/le):5},n.unstable_getCurrentPriorityLevel=function(){return S},n.unstable_getFirstCallbackNode=function(){return i(p)},n.unstable_next=function(le){switch(S){case 1:case 2:case 3:var me=3;break;default:me=S}var we=S;S=me;try{return le()}finally{S=we}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(le,me){switch(le){case 1:case 2:case 3:case 4:case 5:break;default:le=3}var we=S;S=le;try{return me()}finally{S=we}},n.unstable_scheduleCallback=function(le,me,we){var re=n.unstable_now();switch(typeof we=="object"&&we!==null?(we=we.delay,we=typeof we=="number"&&0<we?re+we:re):we=re,le){case 1:var Te=-1;break;case 2:Te=250;break;case 5:Te=1073741823;break;case 4:Te=1e4;break;default:Te=5e3}return Te=we+Te,le={id:_++,callback:me,priorityLevel:le,startTime:we,expirationTime:Te,sortIndex:-1},we>re?(le.sortIndex=we,e(y,le),i(p)===null&&le===i(y)&&(L?(R(te),te=-1):L=!0,Be(F,we-re))):(le.sortIndex=Te,e(p,le),P||A||(P=!0,Re(H))),le},n.unstable_shouldYield=he,n.unstable_wrapCallback=function(le){var me=S;return function(){var we=S;S=me;try{return le.apply(this,arguments)}finally{S=we}}}}(vL)),vL}var hG;function eTe(){return hG||(hG=1,yL.exports=QMe()),yL.exports}/**
 * @license React
 * react-reconciler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var tTe=function(e){var i={},a=ne,s=eTe(),l=Object.assign;function d(M){for(var T="https://reactjs.org/docs/error-decoder.html?invariant="+M,B=1;B<arguments.length;B++)T+="&args[]="+encodeURIComponent(arguments[B]);return"Minified React error #"+M+"; visit "+T+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var f=a.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,p=Symbol.for("react.element"),y=Symbol.for("react.portal"),_=Symbol.for("react.fragment"),b=Symbol.for("react.strict_mode"),S=Symbol.for("react.profiler"),A=Symbol.for("react.provider"),P=Symbol.for("react.context"),L=Symbol.for("react.forward_ref"),k=Symbol.for("react.suspense"),R=Symbol.for("react.suspense_list"),z=Symbol.for("react.memo"),O=Symbol.for("react.lazy"),F=Symbol.for("react.offscreen"),H=Symbol.iterator;function $(M){return M===null||typeof M!="object"?null:(M=H&&M[H]||M["@@iterator"],typeof M=="function"?M:null)}function Y(M){if(M==null)return null;if(typeof M=="function")return M.displayName||M.name||null;if(typeof M=="string")return M;switch(M){case _:return"Fragment";case y:return"Portal";case S:return"Profiler";case b:return"StrictMode";case k:return"Suspense";case R:return"SuspenseList"}if(typeof M=="object")switch(M.$$typeof){case P:return(M.displayName||"Context")+".Consumer";case A:return(M._context.displayName||"Context")+".Provider";case L:var T=M.render;return M=M.displayName,M||(M=T.displayName||T.name||"",M=M!==""?"ForwardRef("+M+")":"ForwardRef"),M;case z:return T=M.displayName||null,T!==null?T:Y(M.type)||"Memo";case O:T=M._payload,M=M._init;try{return Y(M(T))}catch{}}return null}function te(M){var T=M.type;switch(M.tag){case 24:return"Cache";case 9:return(T.displayName||"Context")+".Consumer";case 10:return(T._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return M=T.render,M=M.displayName||M.name||"",T.displayName||(M!==""?"ForwardRef("+M+")":"ForwardRef");case 7:return"Fragment";case 5:return T;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Y(T);case 8:return T===b?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof T=="function")return T.displayName||T.name||null;if(typeof T=="string")return T}return null}function G(M){var T=M,B=M;if(M.alternate)for(;T.return;)T=T.return;else{M=T;do T=M,T.flags&4098&&(B=T.return),M=T.return;while(M)}return T.tag===3?B:null}function Q(M){if(G(M)!==M)throw Error(d(188))}function he(M){var T=M.alternate;if(!T){if(T=G(M),T===null)throw Error(d(188));return T!==M?null:M}for(var B=M,j=T;;){var ee=B.return;if(ee===null)break;var oe=ee.alternate;if(oe===null){if(j=ee.return,j!==null){B=j;continue}break}if(ee.child===oe.child){for(oe=ee.child;oe;){if(oe===B)return Q(ee),M;if(oe===j)return Q(ee),T;oe=oe.sibling}throw Error(d(188))}if(B.return!==j.return)B=ee,j=oe;else{for(var qe=!1,bt=ee.child;bt;){if(bt===B){qe=!0,B=ee,j=oe;break}if(bt===j){qe=!0,j=ee,B=oe;break}bt=bt.sibling}if(!qe){for(bt=oe.child;bt;){if(bt===B){qe=!0,B=oe,j=ee;break}if(bt===j){qe=!0,j=oe,B=ee;break}bt=bt.sibling}if(!qe)throw Error(d(189))}}if(B.alternate!==j)throw Error(d(190))}if(B.tag!==3)throw Error(d(188));return B.stateNode.current===B?M:T}function pe(M){return M=he(M),M!==null?ye(M):null}function ye(M){if(M.tag===5||M.tag===6)return M;for(M=M.child;M!==null;){var T=ye(M);if(T!==null)return T;M=M.sibling}return null}function fe(M){if(M.tag===5||M.tag===6)return M;for(M=M.child;M!==null;){if(M.tag!==4){var T=fe(M);if(T!==null)return T}M=M.sibling}return null}var Ae=Array.isArray,Re=e.getPublicInstance,Be=e.getRootHostContext,le=e.getChildHostContext,me=e.prepareForCommit,we=e.resetAfterCommit,re=e.createInstance,Te=e.appendInitialChild,Je=e.finalizeInitialChildren,Xe=e.prepareUpdate,Ze=e.shouldSetTextContent,Fe=e.createTextInstance,ct=e.scheduleTimeout,At=e.cancelTimeout,kt=e.noTimeout,Kt=e.isPrimaryRenderer,Et=e.supportsMutation,Ie=e.supportsPersistence,pt=e.supportsHydration,gt=e.getInstanceFromNode,_t=e.preparePortalMount,Ue=e.getCurrentEventPriority,ue=e.detachDeletedInstance,se=e.supportsMicrotasks,xe=e.scheduleMicrotask,Ye=e.supportsTestSelectors,ze=e.findFiberRoot,st=e.getBoundingRect,de=e.getTextContent,ie=e.isHiddenSubtree,Oe=e.matchAccessibilityRole,ut=e.setFocusIfFocusable,it=e.setupIntersectionObserver,lt=e.appendChild,Mt=e.appendChildToContainer,Ut=e.commitTextUpdate,Wt=e.commitMount,Ht=e.commitUpdate,Dt=e.insertBefore,wt=e.insertInContainerBefore,Xt=e.removeChild,$e=e.removeChildFromContainer,Pt=e.resetTextContent,qt=e.hideInstance,Ot=e.hideTextInstance,fn=e.unhideInstance,be=e.unhideTextInstance,Qe=e.clearContainer,Se=e.cloneInstance,Ce=e.createContainerChildSet,Ne=e.appendChildToContainerChildSet,et=e.finalizeContainerChildren,tt=e.replaceContainerChildren,vt=e.cloneHiddenInstance,ht=e.cloneHiddenTextInstance,dt=e.canHydrateInstance,Vt=e.canHydrateTextInstance,It=e.canHydrateSuspenseInstance,Qt=e.isSuspenseInstancePending,mn=e.isSuspenseInstanceFallback,en=e.registerSuspenseInstanceRetry,_n=e.getNextHydratableSibling,Hn=e.getFirstHydratableChild,ni=e.getFirstHydratableChildWithinContainer,Ei=e.getFirstHydratableChildWithinSuspenseInstance,Mi=e.hydrateInstance,gr=e.hydrateTextInstance,sr=e.hydrateSuspenseInstance,ke=e.getNextHydratableInstanceAfterSuspenseInstance,xt=e.commitHydratedContainer,zt=e.commitHydratedSuspenseInstance,Rt=e.clearSuspenseBoundary,Nt=e.clearSuspenseBoundaryFromContainer,jt=e.shouldDeleteUnhydratedTailInstances,yn=e.didNotMatchHydratedContainerTextInstance,Zn=e.didNotMatchHydratedTextInstance,on;function pi(M){if(on===void 0)try{throw Error()}catch(B){var T=B.stack.trim().match(/\n( *(at )?)/);on=T&&T[1]||""}return`
`+on+M}var _i=!1;function ui(M,T){if(!M||_i)return"";_i=!0;var B=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(T)if(T=function(){throw Error()},Object.defineProperty(T.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(T,[])}catch(hn){var j=hn}Reflect.construct(M,[],T)}else{try{T.call()}catch(hn){j=hn}M.call(T.prototype)}else{try{throw Error()}catch(hn){j=hn}M()}}catch(hn){if(hn&&j&&typeof hn.stack=="string"){for(var ee=hn.stack.split(`
`),oe=j.stack.split(`
`),qe=ee.length-1,bt=oe.length-1;1<=qe&&0<=bt&&ee[qe]!==oe[bt];)bt--;for(;1<=qe&&0<=bt;qe--,bt--)if(ee[qe]!==oe[bt]){if(qe!==1||bt!==1)do if(qe--,bt--,0>bt||ee[qe]!==oe[bt]){var Yt=`
`+ee[qe].replace(" at new "," at ");return M.displayName&&Yt.includes("<anonymous>")&&(Yt=Yt.replace("<anonymous>",M.displayName)),Yt}while(1<=qe&&0<=bt);break}}}finally{_i=!1,Error.prepareStackTrace=B}return(M=M?M.displayName||M.name:"")?pi(M):""}var cr=Object.prototype.hasOwnProperty,Ea=[],lr=-1;function ea(M){return{current:M}}function si(M){0>lr||(M.current=Ea[lr],Ea[lr]=null,lr--)}function Dn(M,T){lr++,Ea[lr]=M.current,M.current=T}var fo={},Oi=ea(fo),kr=ea(!1),Yo=fo;function Ma(M,T){var B=M.type.contextTypes;if(!B)return fo;var j=M.stateNode;if(j&&j.__reactInternalMemoizedUnmaskedChildContext===T)return j.__reactInternalMemoizedMaskedChildContext;var ee={},oe;for(oe in B)ee[oe]=T[oe];return j&&(M=M.stateNode,M.__reactInternalMemoizedUnmaskedChildContext=T,M.__reactInternalMemoizedMaskedChildContext=ee),ee}function ta(M){return M=M.childContextTypes,M!=null}function yr(){si(kr),si(Oi)}function Fa(M,T,B){if(Oi.current!==fo)throw Error(d(168));Dn(Oi,T),Dn(kr,B)}function Pn(M,T,B){var j=M.stateNode;if(T=T.childContextTypes,typeof j.getChildContext!="function")return B;j=j.getChildContext();for(var ee in j)if(!(ee in T))throw Error(d(108,te(M)||"Unknown",ee));return l({},B,j)}function Qn(M){return M=(M=M.stateNode)&&M.__reactInternalMemoizedMergedChildContext||fo,Yo=Oi.current,Dn(Oi,M),Dn(kr,kr.current),!0}function qr(M,T,B){var j=M.stateNode;if(!j)throw Error(d(169));B?(M=Pn(M,T,Yo),j.__reactInternalMemoizedMergedChildContext=M,si(kr),si(Oi),Dn(Oi,M)):si(kr),Dn(kr,B)}var Ta=Math.clz32?Math.clz32:Vp,Is=Math.log,Tu=Math.LN2;function Vp(M){return M>>>=0,M===0?32:31-(Is(M)/Tu|0)|0}var lc=64,Rl=4194304;function Ll(M){switch(M&-M){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return M&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return M&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return M}}function kl(M,T){var B=M.pendingLanes;if(B===0)return 0;var j=0,ee=M.suspendedLanes,oe=M.pingedLanes,qe=B&268435455;if(qe!==0){var bt=qe&~ee;bt!==0?j=Ll(bt):(oe&=qe,oe!==0&&(j=Ll(oe)))}else qe=B&~ee,qe!==0?j=Ll(qe):oe!==0&&(j=Ll(oe));if(j===0)return 0;if(T!==0&&T!==j&&!(T&ee)&&(ee=j&-j,oe=T&-T,ee>=oe||ee===16&&(oe&4194240)!==0))return T;if(j&4&&(j|=B&16),T=M.entangledLanes,T!==0)for(M=M.entanglements,T&=j;0<T;)B=31-Ta(T),ee=1<<B,j|=M[B],T&=~ee;return j}function Dd(M,T){switch(M){case 1:case 2:case 4:return T+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return T+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ef(M,T){for(var B=M.suspendedLanes,j=M.pingedLanes,ee=M.expirationTimes,oe=M.pendingLanes;0<oe;){var qe=31-Ta(oe),bt=1<<qe,Yt=ee[qe];Yt===-1?(!(bt&B)||bt&j)&&(ee[qe]=Dd(bt,T)):Yt<=T&&(M.expiredLanes|=bt),oe&=~bt}}function cc(M){return M=M.pendingLanes&-1073741825,M!==0?M:M&1073741824?1073741824:0}function zd(M){for(var T=[],B=0;31>B;B++)T.push(M);return T}function Js(M,T,B){M.pendingLanes|=T,T!==536870912&&(M.suspendedLanes=0,M.pingedLanes=0),M=M.eventTimes,T=31-Ta(T),M[T]=B}function $t(M,T){var B=M.pendingLanes&~T;M.pendingLanes=T,M.suspendedLanes=0,M.pingedLanes=0,M.expiredLanes&=T,M.mutableReadLanes&=T,M.entangledLanes&=T,T=M.entanglements;var j=M.eventTimes;for(M=M.expirationTimes;0<B;){var ee=31-Ta(B),oe=1<<ee;T[ee]=0,j[ee]=-1,M[ee]=-1,B&=~oe}}function bn(M,T){var B=M.entangledLanes|=T;for(M=M.entanglements;B;){var j=31-Ta(B),ee=1<<j;ee&T|M[j]&T&&(M[j]|=T),B&=~ee}}var Vn=0;function rt(M){return M&=-M,1<M?4<M?M&268435455?16:536870912:4:1}var cn=s.unstable_scheduleCallback,Qs=s.unstable_cancelCallback,Rs=s.unstable_shouldYield,$r=s.unstable_requestPaint,ur=s.unstable_now,Od=s.unstable_ImmediatePriority,Ls=s.unstable_UserBlockingPriority,To=s.unstable_NormalPriority,Gp=s.unstable_IdlePriority,el=null,an=null;function xi(M){if(an&&typeof an.onCommitFiberRoot=="function")try{an.onCommitFiberRoot(el,M,void 0,(M.current.flags&128)===128)}catch{}}function Ci(M,T){return M===T&&(M!==0||1/M===1/T)||M!==M&&T!==T}var na=typeof Object.is=="function"?Object.is:Ci,Ba=null,li=!1,qo=!1;function Bc(M){Ba===null?Ba=[M]:Ba.push(M)}function Uc(M){li=!0,Bc(M)}function Fr(){if(!qo&&Ba!==null){qo=!0;var M=0,T=Vn;try{var B=Ba;for(Vn=1;M<B.length;M++){var j=B[M];do j=j(!0);while(j!==null)}Ba=null,li=!1}catch(ee){throw Ba!==null&&(Ba=Ba.slice(M+1)),cn(Od,Fr),ee}finally{Vn=T,qo=!1}}return null}var vr=f.ReactCurrentBatchConfig;function Nd(M,T){if(na(M,T))return!0;if(typeof M!="object"||M===null||typeof T!="object"||T===null)return!1;var B=Object.keys(M),j=Object.keys(T);if(B.length!==j.length)return!1;for(j=0;j<B.length;j++){var ee=B[j];if(!cr.call(T,ee)||!na(M[ee],T[ee]))return!1}return!0}function Dl(M){switch(M.tag){case 5:return pi(M.type);case 16:return pi("Lazy");case 13:return pi("Suspense");case 19:return pi("SuspenseList");case 0:case 2:case 15:return M=ui(M.type,!1),M;case 11:return M=ui(M.type.render,!1),M;case 1:return M=ui(M.type,!0),M;default:return""}}function Ao(M,T){if(M&&M.defaultProps){T=l({},T),M=M.defaultProps;for(var B in M)T[B]===void 0&&(T[B]=M[B]);return T}return T}var ga=ea(null),Au=null,tl=null,zl=null;function Cu(){zl=tl=Au=null}function Fd(M,T,B){Kt?(Dn(ga,T._currentValue),T._currentValue=B):(Dn(ga,T._currentValue2),T._currentValue2=B)}function Ua(M){var T=ga.current;si(ga),Kt?M._currentValue=T:M._currentValue2=T}function Dr(M,T,B){for(;M!==null;){var j=M.alternate;if((M.childLanes&T)!==T?(M.childLanes|=T,j!==null&&(j.childLanes|=T)):j!==null&&(j.childLanes&T)!==T&&(j.childLanes|=T),M===B)break;M=M.return}}function En(M,T){Au=M,zl=tl=null,M=M.dependencies,M!==null&&M.firstContext!==null&&(M.lanes&T&&(ls=!0),M.firstContext=null)}function sa(M){var T=Kt?M._currentValue:M._currentValue2;if(zl!==M)if(M={context:M,memoizedValue:T,next:null},tl===null){if(Au===null)throw Error(d(308));tl=M,Au.dependencies={lanes:0,firstContext:M}}else tl=tl.next=M;return T}var Xo=null,Aa=!1;function as(M){M.updateQueue={baseState:M.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function z_(M,T){M=M.updateQueue,T.updateQueue===M&&(T.updateQueue={baseState:M.baseState,firstBaseUpdate:M.firstBaseUpdate,lastBaseUpdate:M.lastBaseUpdate,shared:M.shared,effects:M.effects})}function os(M,T){return{eventTime:M,lane:T,tag:0,payload:null,callback:null,next:null}}function zr(M,T){var B=M.updateQueue;B!==null&&(B=B.shared,Xr!==null&&M.mode&1&&!(Fi&2)?(M=B.interleaved,M===null?(T.next=T,Xo===null?Xo=[B]:Xo.push(B)):(T.next=M.next,M.next=T),B.interleaved=T):(M=B.pending,M===null?T.next=T:(T.next=M.next,M.next=T),B.pending=T))}function Pu(M,T,B){if(T=T.updateQueue,T!==null&&(T=T.shared,(B&4194240)!==0)){var j=T.lanes;j&=M.pendingLanes,B|=j,T.lanes=B,bn(M,B)}}function cy(M,T){var B=M.updateQueue,j=M.alternate;if(j!==null&&(j=j.updateQueue,B===j)){var ee=null,oe=null;if(B=B.firstBaseUpdate,B!==null){do{var qe={eventTime:B.eventTime,lane:B.lane,tag:B.tag,payload:B.payload,callback:B.callback,next:null};oe===null?ee=oe=qe:oe=oe.next=qe,B=B.next}while(B!==null);oe===null?ee=oe=T:oe=oe.next=T}else ee=oe=T;B={baseState:j.baseState,firstBaseUpdate:ee,lastBaseUpdate:oe,shared:j.shared,effects:j.effects},M.updateQueue=B;return}M=B.lastBaseUpdate,M===null?B.firstBaseUpdate=T:M.next=T,B.lastBaseUpdate=T}function Iu(M,T,B,j){var ee=M.updateQueue;Aa=!1;var oe=ee.firstBaseUpdate,qe=ee.lastBaseUpdate,bt=ee.shared.pending;if(bt!==null){ee.shared.pending=null;var Yt=bt,hn=Yt.next;Yt.next=null,qe===null?oe=hn:qe.next=hn,qe=Yt;var Cn=M.alternate;Cn!==null&&(Cn=Cn.updateQueue,bt=Cn.lastBaseUpdate,bt!==qe&&(bt===null?Cn.firstBaseUpdate=hn:bt.next=hn,Cn.lastBaseUpdate=Yt))}if(oe!==null){var Ti=ee.baseState;qe=0,Cn=hn=Yt=null,bt=oe;do{var ii=bt.lane,Mr=bt.eventTime;if((j&ii)===ii){Cn!==null&&(Cn=Cn.next={eventTime:Mr,lane:0,tag:bt.tag,payload:bt.payload,callback:bt.callback,next:null});e:{var $n=M,vo=bt;switch(ii=T,Mr=B,vo.tag){case 1:if($n=vo.payload,typeof $n=="function"){Ti=$n.call(Mr,Ti,ii);break e}Ti=$n;break e;case 3:$n.flags=$n.flags&-65537|128;case 0:if($n=vo.payload,ii=typeof $n=="function"?$n.call(Mr,Ti,ii):$n,ii==null)break e;Ti=l({},Ti,ii);break e;case 2:Aa=!0}}bt.callback!==null&&bt.lane!==0&&(M.flags|=64,ii=ee.effects,ii===null?ee.effects=[bt]:ii.push(bt))}else Mr={eventTime:Mr,lane:ii,tag:bt.tag,payload:bt.payload,callback:bt.callback,next:null},Cn===null?(hn=Cn=Mr,Yt=Ti):Cn=Cn.next=Mr,qe|=ii;if(bt=bt.next,bt===null){if(bt=ee.shared.pending,bt===null)break;ii=bt,bt=ii.next,ii.next=null,ee.lastBaseUpdate=ii,ee.shared.pending=null}}while(1);if(Cn===null&&(Yt=Ti),ee.baseState=Yt,ee.firstBaseUpdate=hn,ee.lastBaseUpdate=Cn,T=ee.shared.interleaved,T!==null){ee=T;do qe|=ee.lane,ee=ee.next;while(ee!==T)}else oe===null&&(ee.shared.lanes=0);Qd|=qe,M.lanes=qe,M.memoizedState=Ti}}function Ca(M,T,B){if(M=T.effects,T.effects=null,M!==null)for(T=0;T<M.length;T++){var j=M[T],ee=j.callback;if(ee!==null){if(j.callback=null,j=B,typeof ee!="function")throw Error(d(191,ee));ee.call(j)}}}var uy=new a.Component().refs;function Hp(M,T,B,j){T=M.memoizedState,B=B(j,T),B=B==null?T:l({},T,B),M.memoizedState=B,M.lanes===0&&(M.updateQueue.baseState=B)}var nl={isMounted:function(M){return(M=M._reactInternals)?G(M)===M:!1},enqueueSetState:function(M,T,B){M=M._reactInternals;var j=yo(),ee=ju(M),oe=os(j,ee);oe.payload=T,B!=null&&(oe.callback=B),zr(M,oe),T=eo(M,ee,j),T!==null&&Pu(T,M,ee)},enqueueReplaceState:function(M,T,B){M=M._reactInternals;var j=yo(),ee=ju(M),oe=os(j,ee);oe.tag=1,oe.payload=T,B!=null&&(oe.callback=B),zr(M,oe),T=eo(M,ee,j),T!==null&&Pu(T,M,ee)},enqueueForceUpdate:function(M,T){M=M._reactInternals;var B=yo(),j=ju(M),ee=os(B,j);ee.tag=2,T!=null&&(ee.callback=T),zr(M,ee),T=eo(M,j,B),T!==null&&Pu(T,M,j)}};function tf(M,T,B,j,ee,oe,qe){return M=M.stateNode,typeof M.shouldComponentUpdate=="function"?M.shouldComponentUpdate(j,oe,qe):T.prototype&&T.prototype.isPureReactComponent?!Nd(B,j)||!Nd(ee,oe):!0}function nf(M,T,B){var j=!1,ee=fo,oe=T.contextType;return typeof oe=="object"&&oe!==null?oe=sa(oe):(ee=ta(T)?Yo:Oi.current,j=T.contextTypes,oe=(j=j!=null)?Ma(M,ee):fo),T=new T(B,oe),M.memoizedState=T.state!==null&&T.state!==void 0?T.state:null,T.updater=nl,M.stateNode=T,T._reactInternals=M,j&&(M=M.stateNode,M.__reactInternalMemoizedUnmaskedChildContext=ee,M.__reactInternalMemoizedMaskedChildContext=oe),T}function Ni(M,T,B,j){M=T.state,typeof T.componentWillReceiveProps=="function"&&T.componentWillReceiveProps(B,j),typeof T.UNSAFE_componentWillReceiveProps=="function"&&T.UNSAFE_componentWillReceiveProps(B,j),T.state!==M&&nl.enqueueReplaceState(T,T.state,null)}function O_(M,T,B,j){var ee=M.stateNode;ee.props=B,ee.state=M.memoizedState,ee.refs=uy,as(M);var oe=T.contextType;typeof oe=="object"&&oe!==null?ee.context=sa(oe):(oe=ta(T)?Yo:Oi.current,ee.context=Ma(M,oe)),ee.state=M.memoizedState,oe=T.getDerivedStateFromProps,typeof oe=="function"&&(Hp(M,T,oe,B),ee.state=M.memoizedState),typeof T.getDerivedStateFromProps=="function"||typeof ee.getSnapshotBeforeUpdate=="function"||typeof ee.UNSAFE_componentWillMount!="function"&&typeof ee.componentWillMount!="function"||(T=ee.state,typeof ee.componentWillMount=="function"&&ee.componentWillMount(),typeof ee.UNSAFE_componentWillMount=="function"&&ee.UNSAFE_componentWillMount(),T!==ee.state&&nl.enqueueReplaceState(ee,ee.state,null),Iu(M,B,ee,j),ee.state=M.memoizedState),typeof ee.componentDidMount=="function"&&(M.flags|=4194308)}var Ru=[],il=0,dy=null,jp=0,Co=[],Pa=0,uc=null,dc=1,Wc="";function Bd(M,T){Ru[il++]=jp,Ru[il++]=dy,dy=M,jp=T}function rf(M,T,B){Co[Pa++]=dc,Co[Pa++]=Wc,Co[Pa++]=uc,uc=M;var j=dc;M=Wc;var ee=32-Ta(j)-1;j&=~(1<<ee),B+=1;var oe=32-Ta(T)+ee;if(30<oe){var qe=ee-ee%5;oe=(j&(1<<qe)-1).toString(32),j>>=qe,ee-=qe,dc=1<<32-Ta(T)+ee|B<<ee|j,Wc=oe+M}else dc=1<<oe|B<<ee|j,Wc=M}function Ud(M){M.return!==null&&(Bd(M,1),rf(M,1,0))}function N_(M){for(;M===dy;)dy=Ru[--il],Ru[il]=null,jp=Ru[--il],Ru[il]=null;for(;M===uc;)uc=Co[--Pa],Co[Pa]=null,Wc=Co[--Pa],Co[Pa]=null,dc=Co[--Pa],Co[Pa]=null}var po=null,ss=null,Br=!1,rl=!1,Ol=null;function pS(M,T){var B=hs(5,null,null,0);B.elementType="DELETED",B.stateNode=T,B.return=M,T=M.deletions,T===null?(M.deletions=[B],M.flags|=16):T.push(B)}function mS(M,T){switch(M.tag){case 5:return T=dt(T,M.type,M.pendingProps),T!==null?(M.stateNode=T,po=M,ss=Hn(T),!0):!1;case 6:return T=Vt(T,M.pendingProps),T!==null?(M.stateNode=T,po=M,ss=null,!0):!1;case 13:if(T=It(T),T!==null){var B=uc!==null?{id:dc,overflow:Wc}:null;return M.memoizedState={dehydrated:T,treeContext:B,retryLane:1073741824},B=hs(18,null,null,0),B.stateNode=T,B.return=M,M.child=B,po=M,ss=null,!0}return!1;default:return!1}}function hy(M){return(M.mode&1)!==0&&(M.flags&128)===0}function F_(M){if(Br){var T=ss;if(T){var B=T;if(!mS(M,T)){if(hy(M))throw Error(d(418));T=_n(B);var j=po;T&&mS(M,T)?pS(j,B):(M.flags=M.flags&-4097|2,Br=!1,po=M)}}else{if(hy(M))throw Error(d(418));M.flags=M.flags&-4097|2,Br=!1,po=M}}}function fy(M){for(M=M.return;M!==null&&M.tag!==5&&M.tag!==3&&M.tag!==13;)M=M.return;po=M}function af(M){if(!pt||M!==po)return!1;if(!Br)return fy(M),Br=!0,!1;if(M.tag!==3&&(M.tag!==5||jt(M.type)&&!Ze(M.type,M.memoizedProps))){var T=ss;if(T){if(hy(M)){for(M=ss;M;)M=_n(M);throw Error(d(418))}for(;T;)pS(M,T),T=_n(T)}}if(fy(M),M.tag===13){if(!pt)throw Error(d(316));if(M=M.memoizedState,M=M!==null?M.dehydrated:null,!M)throw Error(d(317));ss=ke(M)}else ss=po?_n(M.stateNode):null;return!0}function Wd(){pt&&(ss=po=null,rl=Br=!1)}function py(M){Ol===null?Ol=[M]:Ol.push(M)}function of(M,T,B){if(M=B.ref,M!==null&&typeof M!="function"&&typeof M!="object"){if(B._owner){if(B=B._owner,B){if(B.tag!==1)throw Error(d(309));var j=B.stateNode}if(!j)throw Error(d(147,M));var ee=j,oe=""+M;return T!==null&&T.ref!==null&&typeof T.ref=="function"&&T.ref._stringRef===oe?T.ref:(T=function(qe){var bt=ee.refs;bt===uy&&(bt=ee.refs={}),qe===null?delete bt[oe]:bt[oe]=qe},T._stringRef=oe,T)}if(typeof M!="string")throw Error(d(284));if(!B._owner)throw Error(d(290,M))}return M}function Lu(M,T){throw M=Object.prototype.toString.call(T),Error(d(31,M==="[object Object]"?"object with keys {"+Object.keys(T).join(", ")+"}":M))}function my(M){var T=M._init;return T(M._payload)}function B_(M){function T(Bt,Tt){if(M){var Gt=Bt.deletions;Gt===null?(Bt.deletions=[Tt],Bt.flags|=16):Gt.push(Tt)}}function B(Bt,Tt){if(!M)return null;for(;Tt!==null;)T(Bt,Tt),Tt=Tt.sibling;return null}function j(Bt,Tt){for(Bt=new Map;Tt!==null;)Tt.key!==null?Bt.set(Tt.key,Tt):Bt.set(Tt.index,Tt),Tt=Tt.sibling;return Bt}function ee(Bt,Tt){return Bt=Xc(Bt,Tt),Bt.index=0,Bt.sibling=null,Bt}function oe(Bt,Tt,Gt){return Bt.index=Gt,M?(Gt=Bt.alternate,Gt!==null?(Gt=Gt.index,Gt<Tt?(Bt.flags|=2,Tt):Gt):(Bt.flags|=2,Tt)):(Bt.flags|=1048576,Tt)}function qe(Bt){return M&&Bt.alternate===null&&(Bt.flags|=2),Bt}function bt(Bt,Tt,Gt,Tn){return Tt===null||Tt.tag!==6?(Tt=Zt(Gt,Bt.mode,Tn),Tt.return=Bt,Tt):(Tt=ee(Tt,Gt),Tt.return=Bt,Tt)}function Yt(Bt,Tt,Gt,Tn){var On=Gt.type;return On===_?Cn(Bt,Tt,Gt.props.children,Tn,Gt.key):Tt!==null&&(Tt.elementType===On||typeof On=="object"&&On!==null&&On.$$typeof===O&&my(On)===Tt.type)?(Tn=ee(Tt,Gt.props),Tn.ref=of(Bt,Tt,Gt),Tn.return=Bt,Tn):(Tn=ov(Gt.type,Gt.key,Gt.props,null,Bt.mode,Tn),Tn.ref=of(Bt,Tt,Gt),Tn.return=Bt,Tn)}function hn(Bt,Tt,Gt,Tn){return Tt===null||Tt.tag!==4||Tt.stateNode.containerInfo!==Gt.containerInfo||Tt.stateNode.implementation!==Gt.implementation?(Tt=xn(Gt,Bt.mode,Tn),Tt.return=Bt,Tt):(Tt=ee(Tt,Gt.children||[]),Tt.return=Bt,Tt)}function Cn(Bt,Tt,Gt,Tn,On){return Tt===null||Tt.tag!==7?(Tt=ll(Gt,Bt.mode,Tn,On),Tt.return=Bt,Tt):(Tt=ee(Tt,Gt),Tt.return=Bt,Tt)}function Ti(Bt,Tt,Gt){if(typeof Tt=="string"&&Tt!==""||typeof Tt=="number")return Tt=Zt(""+Tt,Bt.mode,Gt),Tt.return=Bt,Tt;if(typeof Tt=="object"&&Tt!==null){switch(Tt.$$typeof){case p:return Gt=ov(Tt.type,Tt.key,Tt.props,null,Bt.mode,Gt),Gt.ref=of(Bt,null,Tt),Gt.return=Bt,Gt;case y:return Tt=xn(Tt,Bt.mode,Gt),Tt.return=Bt,Tt;case O:var Tn=Tt._init;return Ti(Bt,Tn(Tt._payload),Gt)}if(Ae(Tt)||$(Tt))return Tt=ll(Tt,Bt.mode,Gt,null),Tt.return=Bt,Tt;Lu(Bt,Tt)}return null}function ii(Bt,Tt,Gt,Tn){var On=Tt!==null?Tt.key:null;if(typeof Gt=="string"&&Gt!==""||typeof Gt=="number")return On!==null?null:bt(Bt,Tt,""+Gt,Tn);if(typeof Gt=="object"&&Gt!==null){switch(Gt.$$typeof){case p:return Gt.key===On?Yt(Bt,Tt,Gt,Tn):null;case y:return Gt.key===On?hn(Bt,Tt,Gt,Tn):null;case O:return On=Gt._init,ii(Bt,Tt,On(Gt._payload),Tn)}if(Ae(Gt)||$(Gt))return On!==null?null:Cn(Bt,Tt,Gt,Tn,null);Lu(Bt,Gt)}return null}function Mr(Bt,Tt,Gt,Tn,On){if(typeof Tn=="string"&&Tn!==""||typeof Tn=="number")return Bt=Bt.get(Gt)||null,bt(Tt,Bt,""+Tn,On);if(typeof Tn=="object"&&Tn!==null){switch(Tn.$$typeof){case p:return Bt=Bt.get(Tn.key===null?Gt:Tn.key)||null,Yt(Tt,Bt,Tn,On);case y:return Bt=Bt.get(Tn.key===null?Gt:Tn.key)||null,hn(Tt,Bt,Tn,On);case O:var Un=Tn._init;return Mr(Bt,Tt,Gt,Un(Tn._payload),On)}if(Ae(Tn)||$(Tn))return Bt=Bt.get(Gt)||null,Cn(Tt,Bt,Tn,On,null);Lu(Tt,Tn)}return null}function $n(Bt,Tt,Gt,Tn){for(var On=null,Un=null,Pi=Tt,tr=Tt=0,va=null;Pi!==null&&tr<Gt.length;tr++){Pi.index>tr?(va=Pi,Pi=null):va=Pi.sibling;var Hi=ii(Bt,Pi,Gt[tr],Tn);if(Hi===null){Pi===null&&(Pi=va);break}M&&Pi&&Hi.alternate===null&&T(Bt,Pi),Tt=oe(Hi,Tt,tr),Un===null?On=Hi:Un.sibling=Hi,Un=Hi,Pi=va}if(tr===Gt.length)return B(Bt,Pi),Br&&Bd(Bt,tr),On;if(Pi===null){for(;tr<Gt.length;tr++)Pi=Ti(Bt,Gt[tr],Tn),Pi!==null&&(Tt=oe(Pi,Tt,tr),Un===null?On=Pi:Un.sibling=Pi,Un=Pi);return Br&&Bd(Bt,tr),On}for(Pi=j(Bt,Pi);tr<Gt.length;tr++)va=Mr(Pi,Bt,tr,Gt[tr],Tn),va!==null&&(M&&va.alternate!==null&&Pi.delete(va.key===null?tr:va.key),Tt=oe(va,Tt,tr),Un===null?On=va:Un.sibling=va,Un=va);return M&&Pi.forEach(function(yc){return T(Bt,yc)}),Br&&Bd(Bt,tr),On}function vo(Bt,Tt,Gt,Tn){var On=$(Gt);if(typeof On!="function")throw Error(d(150));if(Gt=On.call(Gt),Gt==null)throw Error(d(151));for(var Un=On=null,Pi=Tt,tr=Tt=0,va=null,Hi=Gt.next();Pi!==null&&!Hi.done;tr++,Hi=Gt.next()){Pi.index>tr?(va=Pi,Pi=null):va=Pi.sibling;var yc=ii(Bt,Pi,Hi.value,Tn);if(yc===null){Pi===null&&(Pi=va);break}M&&Pi&&yc.alternate===null&&T(Bt,Pi),Tt=oe(yc,Tt,tr),Un===null?On=yc:Un.sibling=yc,Un=yc,Pi=va}if(Hi.done)return B(Bt,Pi),Br&&Bd(Bt,tr),On;if(Pi===null){for(;!Hi.done;tr++,Hi=Gt.next())Hi=Ti(Bt,Hi.value,Tn),Hi!==null&&(Tt=oe(Hi,Tt,tr),Un===null?On=Hi:Un.sibling=Hi,Un=Hi);return Br&&Bd(Bt,tr),On}for(Pi=j(Bt,Pi);!Hi.done;tr++,Hi=Gt.next())Hi=Mr(Pi,Bt,tr,Hi.value,Tn),Hi!==null&&(M&&Hi.alternate!==null&&Pi.delete(Hi.key===null?tr:Hi.key),Tt=oe(Hi,Tt,tr),Un===null?On=Hi:Un.sibling=Hi,Un=Hi);return M&&Pi.forEach(function(u1){return T(Bt,u1)}),Br&&Bd(Bt,tr),On}function no(Bt,Tt,Gt,Tn){if(typeof Gt=="object"&&Gt!==null&&Gt.type===_&&Gt.key===null&&(Gt=Gt.props.children),typeof Gt=="object"&&Gt!==null){switch(Gt.$$typeof){case p:e:{for(var On=Gt.key,Un=Tt;Un!==null;){if(Un.key===On){if(On=Gt.type,On===_){if(Un.tag===7){B(Bt,Un.sibling),Tt=ee(Un,Gt.props.children),Tt.return=Bt,Bt=Tt;break e}}else if(Un.elementType===On||typeof On=="object"&&On!==null&&On.$$typeof===O&&my(On)===Un.type){B(Bt,Un.sibling),Tt=ee(Un,Gt.props),Tt.ref=of(Bt,Un,Gt),Tt.return=Bt,Bt=Tt;break e}B(Bt,Un);break}else T(Bt,Un);Un=Un.sibling}Gt.type===_?(Tt=ll(Gt.props.children,Bt.mode,Tn,Gt.key),Tt.return=Bt,Bt=Tt):(Tn=ov(Gt.type,Gt.key,Gt.props,null,Bt.mode,Tn),Tn.ref=of(Bt,Tt,Gt),Tn.return=Bt,Bt=Tn)}return qe(Bt);case y:e:{for(Un=Gt.key;Tt!==null;){if(Tt.key===Un)if(Tt.tag===4&&Tt.stateNode.containerInfo===Gt.containerInfo&&Tt.stateNode.implementation===Gt.implementation){B(Bt,Tt.sibling),Tt=ee(Tt,Gt.children||[]),Tt.return=Bt,Bt=Tt;break e}else{B(Bt,Tt);break}else T(Bt,Tt);Tt=Tt.sibling}Tt=xn(Gt,Bt.mode,Tn),Tt.return=Bt,Bt=Tt}return qe(Bt);case O:return Un=Gt._init,no(Bt,Tt,Un(Gt._payload),Tn)}if(Ae(Gt))return $n(Bt,Tt,Gt,Tn);if($(Gt))return vo(Bt,Tt,Gt,Tn);Lu(Bt,Gt)}return typeof Gt=="string"&&Gt!==""||typeof Gt=="number"?(Gt=""+Gt,Tt!==null&&Tt.tag===6?(B(Bt,Tt.sibling),Tt=ee(Tt,Gt),Tt.return=Bt,Bt=Tt):(B(Bt,Tt),Tt=Zt(Gt,Bt.mode,Tn),Tt.return=Bt,Bt=Tt),qe(Bt)):B(Bt,Tt)}return no}var ku=B_(!0),U_=B_(!1),Vd={},mt=ea(Vd),sf=ea(Vd),Du=ea(Vd);function al(M){if(M===Vd)throw Error(d(174));return M}function gy(M,T){Dn(Du,T),Dn(sf,M),Dn(mt,Vd),M=Be(T),si(mt),Dn(mt,M)}function Vc(){si(mt),si(sf),si(Du)}function hc(M){var T=al(Du.current),B=al(mt.current);T=le(B,M.type,T),B!==T&&(Dn(sf,M),Dn(mt,T))}function $p(M){sf.current===M&&(si(mt),si(sf))}var Sr=ea(0);function Gd(M){for(var T=M;T!==null;){if(T.tag===13){var B=T.memoizedState;if(B!==null&&(B=B.dehydrated,B===null||Qt(B)||mn(B)))return T}else if(T.tag===19&&T.memoizedProps.revealOrder!==void 0){if(T.flags&128)return T}else if(T.child!==null){T.child.return=T,T=T.child;continue}if(T===M)break;for(;T.sibling===null;){if(T.return===null||T.return===M)return null;T=T.return}T.sibling.return=T.return,T=T.sibling}return null}var zu=[];function Yp(){for(var M=0;M<zu.length;M++){var T=zu[M];Kt?T._workInProgressVersionPrimary=null:T._workInProgressVersionSecondary=null}zu.length=0}var yy=f.ReactCurrentDispatcher,ks=f.ReactCurrentBatchConfig,Hd=0,ia=null,Fo=null,mo=null,vy=!1,qp=!1,lf=0,LC=0;function Qa(){throw Error(d(321))}function W_(M,T){if(T===null)return!1;for(var B=0;B<T.length&&B<M.length;B++)if(!na(M[B],T[B]))return!1;return!0}function _y(M,T,B,j,ee,oe){if(Hd=oe,ia=T,T.memoizedState=null,T.updateQueue=null,T.lanes=0,yy.current=M===null||M.memoizedState===null?Qp:em,M=B(j,ee),qp){oe=0;do{if(qp=!1,lf=0,25<=oe)throw Error(d(301));oe+=1,mo=Fo=null,T.updateQueue=null,yy.current=vS,M=B(j,ee)}while(qp)}if(yy.current=Ty,T=Fo!==null&&Fo.next!==null,Hd=0,mo=Fo=ia=null,vy=!1,T)throw Error(d(300));return M}function Xp(){var M=lf!==0;return lf=0,M}function ol(){var M={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return mo===null?ia.memoizedState=mo=M:mo=mo.next=M,mo}function sl(){if(Fo===null){var M=ia.alternate;M=M!==null?M.memoizedState:null}else M=Fo.next;var T=mo===null?ia.memoizedState:mo.next;if(T!==null)mo=T,Fo=M;else{if(M===null)throw Error(d(310));Fo=M,M={memoizedState:Fo.memoizedState,baseState:Fo.baseState,baseQueue:Fo.baseQueue,queue:Fo.queue,next:null},mo===null?ia.memoizedState=mo=M:mo=mo.next=M}return mo}function Nl(M,T){return typeof T=="function"?T(M):T}function cf(M){var T=sl(),B=T.queue;if(B===null)throw Error(d(311));B.lastRenderedReducer=M;var j=Fo,ee=j.baseQueue,oe=B.pending;if(oe!==null){if(ee!==null){var qe=ee.next;ee.next=oe.next,oe.next=qe}j.baseQueue=ee=oe,B.pending=null}if(ee!==null){oe=ee.next,j=j.baseState;var bt=qe=null,Yt=null,hn=oe;do{var Cn=hn.lane;if((Hd&Cn)===Cn)Yt!==null&&(Yt=Yt.next={lane:0,action:hn.action,hasEagerState:hn.hasEagerState,eagerState:hn.eagerState,next:null}),j=hn.hasEagerState?hn.eagerState:M(j,hn.action);else{var Ti={lane:Cn,action:hn.action,hasEagerState:hn.hasEagerState,eagerState:hn.eagerState,next:null};Yt===null?(bt=Yt=Ti,qe=j):Yt=Yt.next=Ti,ia.lanes|=Cn,Qd|=Cn}hn=hn.next}while(hn!==null&&hn!==oe);Yt===null?qe=j:Yt.next=bt,na(j,T.memoizedState)||(ls=!0),T.memoizedState=j,T.baseState=qe,T.baseQueue=Yt,B.lastRenderedState=j}if(M=B.interleaved,M!==null){ee=M;do oe=ee.lane,ia.lanes|=oe,Qd|=oe,ee=ee.next;while(ee!==M)}else ee===null&&(B.lanes=0);return[T.memoizedState,B.dispatch]}function Ou(M){var T=sl(),B=T.queue;if(B===null)throw Error(d(311));B.lastRenderedReducer=M;var j=B.dispatch,ee=B.pending,oe=T.memoizedState;if(ee!==null){B.pending=null;var qe=ee=ee.next;do oe=M(oe,qe.action),qe=qe.next;while(qe!==ee);na(oe,T.memoizedState)||(ls=!0),T.memoizedState=oe,T.baseQueue===null&&(T.baseState=oe),B.lastRenderedState=oe}return[oe,j]}function Zp(){}function xy(M,T){var B=ia,j=sl(),ee=T(),oe=!na(j.memoizedState,ee);if(oe&&(j.memoizedState=ee,ls=!0),j=j.queue,hf(V_.bind(null,B,j,M),[M]),j.getSnapshot!==T||oe||mo!==null&&mo.memoizedState.tag&1){if(B.flags|=2048,$d(9,by.bind(null,B,j,ee,T),void 0,null),Xr===null)throw Error(d(349));Hd&30||jd(B,T,ee)}return ee}function jd(M,T,B){M.flags|=16384,M={getSnapshot:T,value:B},T=ia.updateQueue,T===null?(T={lastEffect:null,stores:null},ia.updateQueue=T,T.stores=[M]):(B=T.stores,B===null?T.stores=[M]:B.push(M))}function by(M,T,B,j){T.value=B,T.getSnapshot=j,wy(T)&&eo(M,1,-1)}function V_(M,T,B){return B(function(){wy(T)&&eo(M,1,-1)})}function wy(M){var T=M.getSnapshot;M=M.value;try{var B=T();return!na(M,B)}catch{return!0}}function Sy(M){var T=ol();return typeof M=="function"&&(M=M()),T.memoizedState=T.baseState=M,M={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Nl,lastRenderedState:M},T.queue=M,M=M.dispatch=q_.bind(null,ia,M),[T.memoizedState,M]}function $d(M,T,B,j){return M={tag:M,create:T,destroy:B,deps:j,next:null},T=ia.updateQueue,T===null?(T={lastEffect:null,stores:null},ia.updateQueue=T,T.lastEffect=M.next=M):(B=T.lastEffect,B===null?T.lastEffect=M.next=M:(j=B.next,B.next=M,M.next=j,T.lastEffect=M)),M}function Kp(){return sl().memoizedState}function uf(M,T,B,j){var ee=ol();ia.flags|=M,ee.memoizedState=$d(1|T,B,void 0,j===void 0?null:j)}function df(M,T,B,j){var ee=sl();j=j===void 0?null:j;var oe=void 0;if(Fo!==null){var qe=Fo.memoizedState;if(oe=qe.destroy,j!==null&&W_(j,qe.deps)){ee.memoizedState=$d(T,B,oe,j);return}}ia.flags|=M,ee.memoizedState=$d(1|T,B,oe,j)}function kn(M,T){return uf(8390656,8,M,T)}function hf(M,T){return df(2048,8,M,T)}function Jp(M,T){return df(4,2,M,T)}function G_(M,T){return df(4,4,M,T)}function H_(M,T){if(typeof T=="function")return M=M(),T(M),function(){T(null)};if(T!=null)return M=M(),T.current=M,function(){T.current=null}}function j_(M,T,B){return B=B!=null?B.concat([M]):null,df(4,4,H_.bind(null,T,M),B)}function Nu(){}function $_(M,T){var B=sl();T=T===void 0?null:T;var j=B.memoizedState;return j!==null&&T!==null&&W_(T,j[1])?j[0]:(B.memoizedState=[M,T],M)}function gS(M,T){var B=sl();T=T===void 0?null:T;var j=B.memoizedState;return j!==null&&T!==null&&W_(T,j[1])?j[0]:(M=M(),B.memoizedState=[M,T],M)}function kC(M,T){var B=Vn;Vn=B!==0&&4>B?B:4,M(!0);var j=ks.transition;ks.transition={};try{M(!1),T()}finally{Vn=B,ks.transition=j}}function yS(){return sl().memoizedState}function Y_(M,T,B){var j=ju(M);B={lane:j,action:B,hasEagerState:!1,eagerState:null,next:null},Ey(M)?My(T,B):(X_(M,T,B),B=yo(),M=eo(M,j,B),M!==null&&Z_(M,T,j))}function q_(M,T,B){var j=ju(M),ee={lane:j,action:B,hasEagerState:!1,eagerState:null,next:null};if(Ey(M))My(T,ee);else{X_(M,T,ee);var oe=M.alternate;if(M.lanes===0&&(oe===null||oe.lanes===0)&&(oe=T.lastRenderedReducer,oe!==null))try{var qe=T.lastRenderedState,bt=oe(qe,B);if(ee.hasEagerState=!0,ee.eagerState=bt,na(bt,qe))return}catch{}finally{}B=yo(),M=eo(M,j,B),M!==null&&Z_(M,T,j)}}function Ey(M){var T=M.alternate;return M===ia||T!==null&&T===ia}function My(M,T){qp=vy=!0;var B=M.pending;B===null?T.next=T:(T.next=B.next,B.next=T),M.pending=T}function X_(M,T,B){Xr!==null&&M.mode&1&&!(Fi&2)?(M=T.interleaved,M===null?(B.next=B,Xo===null?Xo=[T]:Xo.push(T)):(B.next=M.next,M.next=B),T.interleaved=B):(M=T.pending,M===null?B.next=B:(B.next=M.next,M.next=B),T.pending=B)}function Z_(M,T,B){if(B&4194240){var j=T.lanes;j&=M.pendingLanes,B|=j,T.lanes=B,bn(M,B)}}var Ty={readContext:sa,useCallback:Qa,useContext:Qa,useEffect:Qa,useImperativeHandle:Qa,useInsertionEffect:Qa,useLayoutEffect:Qa,useMemo:Qa,useReducer:Qa,useRef:Qa,useState:Qa,useDebugValue:Qa,useDeferredValue:Qa,useTransition:Qa,useMutableSource:Qa,useSyncExternalStore:Qa,useId:Qa,unstable_isNewReconciler:!1},Qp={readContext:sa,useCallback:function(M,T){return ol().memoizedState=[M,T===void 0?null:T],M},useContext:sa,useEffect:kn,useImperativeHandle:function(M,T,B){return B=B!=null?B.concat([M]):null,uf(4194308,4,H_.bind(null,T,M),B)},useLayoutEffect:function(M,T){return uf(4194308,4,M,T)},useInsertionEffect:function(M,T){return uf(4,2,M,T)},useMemo:function(M,T){var B=ol();return T=T===void 0?null:T,M=M(),B.memoizedState=[M,T],M},useReducer:function(M,T,B){var j=ol();return T=B!==void 0?B(T):T,j.memoizedState=j.baseState=T,M={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:M,lastRenderedState:T},j.queue=M,M=M.dispatch=Y_.bind(null,ia,M),[j.memoizedState,M]},useRef:function(M){var T=ol();return M={current:M},T.memoizedState=M},useState:Sy,useDebugValue:Nu,useDeferredValue:function(M){var T=Sy(M),B=T[0],j=T[1];return kn(function(){var ee=ks.transition;ks.transition={};try{j(M)}finally{ks.transition=ee}},[M]),B},useTransition:function(){var M=Sy(!1),T=M[0];return M=kC.bind(null,M[1]),ol().memoizedState=M,[T,M]},useMutableSource:function(){},useSyncExternalStore:function(M,T,B){var j=ia,ee=ol();if(Br){if(B===void 0)throw Error(d(407));B=B()}else{if(B=T(),Xr===null)throw Error(d(349));Hd&30||jd(j,T,B)}ee.memoizedState=B;var oe={value:B,getSnapshot:T};return ee.queue=oe,kn(V_.bind(null,j,oe,M),[M]),j.flags|=2048,$d(9,by.bind(null,j,oe,B,T),void 0,null),B},useId:function(){var M=ol(),T=Xr.identifierPrefix;if(Br){var B=Wc,j=dc;B=(j&~(1<<32-Ta(j)-1)).toString(32)+B,T=":"+T+"R"+B,B=lf++,0<B&&(T+="H"+B.toString(32)),T+=":"}else B=LC++,T=":"+T+"r"+B.toString(32)+":";return M.memoizedState=T},unstable_isNewReconciler:!1},em={readContext:sa,useCallback:$_,useContext:sa,useEffect:hf,useImperativeHandle:j_,useInsertionEffect:Jp,useLayoutEffect:G_,useMemo:gS,useReducer:cf,useRef:Kp,useState:function(){return cf(Nl)},useDebugValue:Nu,useDeferredValue:function(M){var T=cf(Nl),B=T[0],j=T[1];return hf(function(){var ee=ks.transition;ks.transition={};try{j(M)}finally{ks.transition=ee}},[M]),B},useTransition:function(){var M=cf(Nl)[0],T=sl().memoizedState;return[M,T]},useMutableSource:Zp,useSyncExternalStore:xy,useId:yS,unstable_isNewReconciler:!1},vS={readContext:sa,useCallback:$_,useContext:sa,useEffect:hf,useImperativeHandle:j_,useInsertionEffect:Jp,useLayoutEffect:G_,useMemo:gS,useReducer:Ou,useRef:Kp,useState:function(){return Ou(Nl)},useDebugValue:Nu,useDeferredValue:function(M){var T=Ou(Nl),B=T[0],j=T[1];return hf(function(){var ee=ks.transition;ks.transition={};try{j(M)}finally{ks.transition=ee}},[M]),B},useTransition:function(){var M=Ou(Nl)[0],T=sl().memoizedState;return[M,T]},useMutableSource:Zp,useSyncExternalStore:xy,useId:yS,unstable_isNewReconciler:!1};function ff(M,T){try{var B="",j=T;do B+=Dl(j),j=j.return;while(j);var ee=B}catch(oe){ee=`
Error generating stack: `+oe.message+`
`+oe.stack}return{value:M,source:T,stack:ee}}function tm(M,T){try{console.error(T.value)}catch(B){setTimeout(function(){throw B})}}var fc=typeof WeakMap=="function"?WeakMap:Map;function Ay(M,T,B){B=os(-1,B),B.tag=3,B.payload={element:null};var j=T.value;return B.callback=function(){Zy||(Zy=!0,r1=j),tm(M,T)},B}function K_(M,T,B){B=os(-1,B),B.tag=3;var j=M.type.getDerivedStateFromError;if(typeof j=="function"){var ee=T.value;B.payload=function(){return j(ee)},B.callback=function(){tm(M,T)}}var oe=M.stateNode;return oe!==null&&typeof oe.componentDidCatch=="function"&&(B.callback=function(){tm(M,T),typeof j!="function"&&(Gu===null?Gu=new Set([this]):Gu.add(this));var qe=T.stack;this.componentDidCatch(T.value,{componentStack:qe!==null?qe:""})}),B}function Cy(M,T,B){var j=M.pingCache;if(j===null){j=M.pingCache=new fc;var ee=new Set;j.set(T,ee)}else ee=j.get(T),ee===void 0&&(ee=new Set,j.set(T,ee));ee.has(B)||(ee.add(B),M=s1.bind(null,M,T,B),T.then(M,M))}function J_(M){do{var T;if((T=M.tag===13)&&(T=M.memoizedState,T=T!==null?T.dehydrated!==null:!0),T)return M;M=M.return}while(M!==null);return null}function Py(M,T,B,j,ee){return M.mode&1?(M.flags|=65536,M.lanes=ee,M):(M===T?M.flags|=65536:(M.flags|=128,B.flags|=131072,B.flags&=-52805,B.tag===1&&(B.alternate===null?B.tag=17:(T=os(-1,1),T.tag=2,zr(B,T))),B.lanes|=1),M)}function pc(M){M.flags|=4}function Iy(M,T){if(M!==null&&M.child===T.child)return!0;if(T.flags&16)return!1;for(M=T.child;M!==null;){if(M.flags&12854||M.subtreeFlags&12854)return!1;M=M.sibling}return!0}var nm,Fu,Ry,pf;if(Et)nm=function(M,T){for(var B=T.child;B!==null;){if(B.tag===5||B.tag===6)Te(M,B.stateNode);else if(B.tag!==4&&B.child!==null){B.child.return=B,B=B.child;continue}if(B===T)break;for(;B.sibling===null;){if(B.return===null||B.return===T)return;B=B.return}B.sibling.return=B.return,B=B.sibling}},Fu=function(){},Ry=function(M,T,B,j,ee){if(M=M.memoizedProps,M!==j){var oe=T.stateNode,qe=al(mt.current);B=Xe(oe,B,M,j,ee,qe),(T.updateQueue=B)&&pc(T)}},pf=function(M,T,B,j){B!==j&&pc(T)};else if(Ie){nm=function(M,T,B,j){for(var ee=T.child;ee!==null;){if(ee.tag===5){var oe=ee.stateNode;B&&j&&(oe=vt(oe,ee.type,ee.memoizedProps,ee)),Te(M,oe)}else if(ee.tag===6)oe=ee.stateNode,B&&j&&(oe=ht(oe,ee.memoizedProps,ee)),Te(M,oe);else if(ee.tag!==4){if(ee.tag===22&&ee.memoizedState!==null)oe=ee.child,oe!==null&&(oe.return=ee),nm(M,ee,!0,!0);else if(ee.child!==null){ee.child.return=ee,ee=ee.child;continue}}if(ee===T)break;for(;ee.sibling===null;){if(ee.return===null||ee.return===T)return;ee=ee.return}ee.sibling.return=ee.return,ee=ee.sibling}};var _S=function(M,T,B,j){for(var ee=T.child;ee!==null;){if(ee.tag===5){var oe=ee.stateNode;B&&j&&(oe=vt(oe,ee.type,ee.memoizedProps,ee)),Ne(M,oe)}else if(ee.tag===6)oe=ee.stateNode,B&&j&&(oe=ht(oe,ee.memoizedProps,ee)),Ne(M,oe);else if(ee.tag!==4){if(ee.tag===22&&ee.memoizedState!==null)oe=ee.child,oe!==null&&(oe.return=ee),_S(M,ee,!0,!0);else if(ee.child!==null){ee.child.return=ee,ee=ee.child;continue}}if(ee===T)break;for(;ee.sibling===null;){if(ee.return===null||ee.return===T)return;ee=ee.return}ee.sibling.return=ee.return,ee=ee.sibling}};Fu=function(M,T){var B=T.stateNode;if(!Iy(M,T)){M=B.containerInfo;var j=Ce(M);_S(j,T,!1,!1),B.pendingChildren=j,pc(T),et(M,j)}},Ry=function(M,T,B,j,ee){var oe=M.stateNode,qe=M.memoizedProps;if((M=Iy(M,T))&&qe===j)T.stateNode=oe;else{var bt=T.stateNode,Yt=al(mt.current),hn=null;qe!==j&&(hn=Xe(bt,B,qe,j,ee,Yt)),M&&hn===null?T.stateNode=oe:(oe=Se(oe,hn,B,qe,j,T,M,bt),Je(oe,B,j,ee,Yt)&&pc(T),T.stateNode=oe,M?pc(T):nm(oe,T,!1,!1))}},pf=function(M,T,B,j){B!==j?(M=al(Du.current),B=al(mt.current),T.stateNode=Fe(j,M,B,T),pc(T)):T.stateNode=M.stateNode}}else Fu=function(){},Ry=function(){},pf=function(){};function Yd(M,T){if(!Br)switch(M.tailMode){case"hidden":T=M.tail;for(var B=null;T!==null;)T.alternate!==null&&(B=T),T=T.sibling;B===null?M.tail=null:B.sibling=null;break;case"collapsed":B=M.tail;for(var j=null;B!==null;)B.alternate!==null&&(j=B),B=B.sibling;j===null?T||M.tail===null?M.tail=null:M.tail.sibling=null:j.sibling=null}}function Bo(M){var T=M.alternate!==null&&M.alternate.child===M.child,B=0,j=0;if(T)for(var ee=M.child;ee!==null;)B|=ee.lanes|ee.childLanes,j|=ee.subtreeFlags&14680064,j|=ee.flags&14680064,ee.return=M,ee=ee.sibling;else for(ee=M.child;ee!==null;)B|=ee.lanes|ee.childLanes,j|=ee.subtreeFlags,j|=ee.flags,ee.return=M,ee=ee.sibling;return M.subtreeFlags|=j,M.childLanes=B,T}function Ly(M,T,B){var j=T.pendingProps;switch(N_(T),T.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Bo(T),null;case 1:return ta(T.type)&&yr(),Bo(T),null;case 3:return j=T.stateNode,Vc(),si(kr),si(Oi),Yp(),j.pendingContext&&(j.context=j.pendingContext,j.pendingContext=null),(M===null||M.child===null)&&(af(T)?pc(T):M===null||M.memoizedState.isDehydrated&&!(T.flags&256)||(T.flags|=1024,Ol!==null&&(Qy(Ol),Ol=null))),Fu(M,T),Bo(T),null;case 5:$p(T),B=al(Du.current);var ee=T.type;if(M!==null&&T.stateNode!=null)Ry(M,T,ee,j,B),M.ref!==T.ref&&(T.flags|=512,T.flags|=2097152);else{if(!j){if(T.stateNode===null)throw Error(d(166));return Bo(T),null}if(M=al(mt.current),af(T)){if(!pt)throw Error(d(175));M=Mi(T.stateNode,T.type,T.memoizedProps,B,M,T,!rl),T.updateQueue=M,M!==null&&pc(T)}else{var oe=re(ee,j,B,M,T);nm(oe,T,!1,!1),T.stateNode=oe,Je(oe,ee,j,B,M)&&pc(T)}T.ref!==null&&(T.flags|=512,T.flags|=2097152)}return Bo(T),null;case 6:if(M&&T.stateNode!=null)pf(M,T,M.memoizedProps,j);else{if(typeof j!="string"&&T.stateNode===null)throw Error(d(166));if(M=al(Du.current),B=al(mt.current),af(T)){if(!pt)throw Error(d(176));if(M=T.stateNode,j=T.memoizedProps,(B=gr(M,j,T,!rl))&&(ee=po,ee!==null))switch(oe=(ee.mode&1)!==0,ee.tag){case 3:yn(ee.stateNode.containerInfo,M,j,oe);break;case 5:Zn(ee.type,ee.memoizedProps,ee.stateNode,M,j,oe)}B&&pc(T)}else T.stateNode=Fe(j,M,B,T)}return Bo(T),null;case 13:if(si(Sr),j=T.memoizedState,Br&&ss!==null&&T.mode&1&&!(T.flags&128)){for(M=ss;M;)M=_n(M);return Wd(),T.flags|=98560,T}if(j!==null&&j.dehydrated!==null){if(j=af(T),M===null){if(!j)throw Error(d(318));if(!pt)throw Error(d(344));if(M=T.memoizedState,M=M!==null?M.dehydrated:null,!M)throw Error(d(317));sr(M,T)}else Wd(),!(T.flags&128)&&(T.memoizedState=null),T.flags|=4;return Bo(T),null}return Ol!==null&&(Qy(Ol),Ol=null),T.flags&128?(T.lanes=B,T):(j=j!==null,B=!1,M===null?af(T):B=M.memoizedState!==null,j&&!B&&(T.child.flags|=8192,T.mode&1&&(M===null||Sr.current&1?Wa===0&&(Wa=3):tv())),T.updateQueue!==null&&(T.flags|=4),Bo(T),null);case 4:return Vc(),Fu(M,T),M===null&&_t(T.stateNode.containerInfo),Bo(T),null;case 10:return Ua(T.type._context),Bo(T),null;case 17:return ta(T.type)&&yr(),Bo(T),null;case 19:if(si(Sr),ee=T.memoizedState,ee===null)return Bo(T),null;if(j=(T.flags&128)!==0,oe=ee.rendering,oe===null)if(j)Yd(ee,!1);else{if(Wa!==0||M!==null&&M.flags&128)for(M=T.child;M!==null;){if(oe=Gd(M),oe!==null){for(T.flags|=128,Yd(ee,!1),M=oe.updateQueue,M!==null&&(T.updateQueue=M,T.flags|=4),T.subtreeFlags=0,M=B,j=T.child;j!==null;)B=j,ee=M,B.flags&=14680066,oe=B.alternate,oe===null?(B.childLanes=0,B.lanes=ee,B.child=null,B.subtreeFlags=0,B.memoizedProps=null,B.memoizedState=null,B.updateQueue=null,B.dependencies=null,B.stateNode=null):(B.childLanes=oe.childLanes,B.lanes=oe.lanes,B.child=oe.child,B.subtreeFlags=0,B.deletions=null,B.memoizedProps=oe.memoizedProps,B.memoizedState=oe.memoizedState,B.updateQueue=oe.updateQueue,B.type=oe.type,ee=oe.dependencies,B.dependencies=ee===null?null:{lanes:ee.lanes,firstContext:ee.firstContext}),j=j.sibling;return Dn(Sr,Sr.current&1|2),T.child}M=M.sibling}ee.tail!==null&&ur()>Vu&&(T.flags|=128,j=!0,Yd(ee,!1),T.lanes=4194304)}else{if(!j)if(M=Gd(oe),M!==null){if(T.flags|=128,j=!0,M=M.updateQueue,M!==null&&(T.updateQueue=M,T.flags|=4),Yd(ee,!0),ee.tail===null&&ee.tailMode==="hidden"&&!oe.alternate&&!Br)return Bo(T),null}else 2*ur()-ee.renderingStartTime>Vu&&B!==1073741824&&(T.flags|=128,j=!0,Yd(ee,!1),T.lanes=4194304);ee.isBackwards?(oe.sibling=T.child,T.child=oe):(M=ee.last,M!==null?M.sibling=oe:T.child=oe,ee.last=oe)}return ee.tail!==null?(T=ee.tail,ee.rendering=T,ee.tail=T.sibling,ee.renderingStartTime=ur(),T.sibling=null,M=Sr.current,Dn(Sr,j?M&1|2:M&1),T):(Bo(T),null);case 22:case 23:return Sm(),j=T.memoizedState!==null,M!==null&&M.memoizedState!==null!==j&&(T.flags|=8192),j&&T.mode&1?Ds&1073741824&&(Bo(T),Et&&T.subtreeFlags&6&&(T.flags|=8192)):Bo(T),null;case 24:return null;case 25:return null}throw Error(d(156,T.tag))}var DC=f.ReactCurrentOwner,ls=!1;function Uo(M,T,B,j){T.child=M===null?U_(T,null,B,j):ku(T,M.child,B,j)}function qd(M,T,B,j,ee){B=B.render;var oe=T.ref;return En(T,ee),j=_y(M,T,B,j,oe,ee),B=Xp(),M!==null&&!ls?(T.updateQueue=M.updateQueue,T.flags&=-2053,M.lanes&=~ee,gc(M,T,ee)):(Br&&B&&Ud(T),T.flags|=1,Uo(M,T,j,ee),T.child)}function xS(M,T,B,j,ee){if(M===null){var oe=B.type;return typeof oe=="function"&&!nh(oe)&&oe.defaultProps===void 0&&B.compare===null&&B.defaultProps===void 0?(T.tag=15,T.type=oe,bS(M,T,oe,j,ee)):(M=ov(B.type,null,j,T,T.mode,ee),M.ref=T.ref,M.return=T,T.child=M)}if(oe=M.child,!(M.lanes&ee)){var qe=oe.memoizedProps;if(B=B.compare,B=B!==null?B:Nd,B(qe,j)&&M.ref===T.ref)return gc(M,T,ee)}return T.flags|=1,M=Xc(oe,j),M.ref=T.ref,M.return=T,T.child=M}function bS(M,T,B,j,ee){if(M!==null&&Nd(M.memoizedProps,j)&&M.ref===T.ref)if(ls=!1,(M.lanes&ee)!==0)M.flags&131072&&(ls=!0);else return T.lanes=M.lanes,gc(M,T,ee);return Q_(M,T,B,j,ee)}function wS(M,T,B){var j=T.pendingProps,ee=j.children,oe=M!==null?M.memoizedState:null;if(j.mode==="hidden")if(!(T.mode&1))T.memoizedState={baseLanes:0,cachePool:null},Dn(Jd,Ds),Ds|=B;else if(B&1073741824)T.memoizedState={baseLanes:0,cachePool:null},j=oe!==null?oe.baseLanes:B,Dn(Jd,Ds),Ds|=j;else return M=oe!==null?oe.baseLanes|B:B,T.lanes=T.childLanes=1073741824,T.memoizedState={baseLanes:M,cachePool:null},T.updateQueue=null,Dn(Jd,Ds),Ds|=M,null;else oe!==null?(j=oe.baseLanes|B,T.memoizedState=null):j=B,Dn(Jd,Ds),Ds|=j;return Uo(M,T,ee,B),T.child}function SS(M,T){var B=T.ref;(M===null&&B!==null||M!==null&&M.ref!==B)&&(T.flags|=512,T.flags|=2097152)}function Q_(M,T,B,j,ee){var oe=ta(B)?Yo:Oi.current;return oe=Ma(T,oe),En(T,ee),B=_y(M,T,B,j,oe,ee),j=Xp(),M!==null&&!ls?(T.updateQueue=M.updateQueue,T.flags&=-2053,M.lanes&=~ee,gc(M,T,ee)):(Br&&j&&Ud(T),T.flags|=1,Uo(M,T,B,ee),T.child)}function ES(M,T,B,j,ee){if(ta(B)){var oe=!0;Qn(T)}else oe=!1;if(En(T,ee),T.stateNode===null)M!==null&&(M.alternate=null,T.alternate=null,T.flags|=2),nf(T,B,j),O_(T,B,j,ee),j=!0;else if(M===null){var qe=T.stateNode,bt=T.memoizedProps;qe.props=bt;var Yt=qe.context,hn=B.contextType;typeof hn=="object"&&hn!==null?hn=sa(hn):(hn=ta(B)?Yo:Oi.current,hn=Ma(T,hn));var Cn=B.getDerivedStateFromProps,Ti=typeof Cn=="function"||typeof qe.getSnapshotBeforeUpdate=="function";Ti||typeof qe.UNSAFE_componentWillReceiveProps!="function"&&typeof qe.componentWillReceiveProps!="function"||(bt!==j||Yt!==hn)&&Ni(T,qe,j,hn),Aa=!1;var ii=T.memoizedState;qe.state=ii,Iu(T,j,qe,ee),Yt=T.memoizedState,bt!==j||ii!==Yt||kr.current||Aa?(typeof Cn=="function"&&(Hp(T,B,Cn,j),Yt=T.memoizedState),(bt=Aa||tf(T,B,bt,j,ii,Yt,hn))?(Ti||typeof qe.UNSAFE_componentWillMount!="function"&&typeof qe.componentWillMount!="function"||(typeof qe.componentWillMount=="function"&&qe.componentWillMount(),typeof qe.UNSAFE_componentWillMount=="function"&&qe.UNSAFE_componentWillMount()),typeof qe.componentDidMount=="function"&&(T.flags|=4194308)):(typeof qe.componentDidMount=="function"&&(T.flags|=4194308),T.memoizedProps=j,T.memoizedState=Yt),qe.props=j,qe.state=Yt,qe.context=hn,j=bt):(typeof qe.componentDidMount=="function"&&(T.flags|=4194308),j=!1)}else{qe=T.stateNode,z_(M,T),bt=T.memoizedProps,hn=T.type===T.elementType?bt:Ao(T.type,bt),qe.props=hn,Ti=T.pendingProps,ii=qe.context,Yt=B.contextType,typeof Yt=="object"&&Yt!==null?Yt=sa(Yt):(Yt=ta(B)?Yo:Oi.current,Yt=Ma(T,Yt));var Mr=B.getDerivedStateFromProps;(Cn=typeof Mr=="function"||typeof qe.getSnapshotBeforeUpdate=="function")||typeof qe.UNSAFE_componentWillReceiveProps!="function"&&typeof qe.componentWillReceiveProps!="function"||(bt!==Ti||ii!==Yt)&&Ni(T,qe,j,Yt),Aa=!1,ii=T.memoizedState,qe.state=ii,Iu(T,j,qe,ee);var $n=T.memoizedState;bt!==Ti||ii!==$n||kr.current||Aa?(typeof Mr=="function"&&(Hp(T,B,Mr,j),$n=T.memoizedState),(hn=Aa||tf(T,B,hn,j,ii,$n,Yt)||!1)?(Cn||typeof qe.UNSAFE_componentWillUpdate!="function"&&typeof qe.componentWillUpdate!="function"||(typeof qe.componentWillUpdate=="function"&&qe.componentWillUpdate(j,$n,Yt),typeof qe.UNSAFE_componentWillUpdate=="function"&&qe.UNSAFE_componentWillUpdate(j,$n,Yt)),typeof qe.componentDidUpdate=="function"&&(T.flags|=4),typeof qe.getSnapshotBeforeUpdate=="function"&&(T.flags|=1024)):(typeof qe.componentDidUpdate!="function"||bt===M.memoizedProps&&ii===M.memoizedState||(T.flags|=4),typeof qe.getSnapshotBeforeUpdate!="function"||bt===M.memoizedProps&&ii===M.memoizedState||(T.flags|=1024),T.memoizedProps=j,T.memoizedState=$n),qe.props=j,qe.state=$n,qe.context=Yt,j=hn):(typeof qe.componentDidUpdate!="function"||bt===M.memoizedProps&&ii===M.memoizedState||(T.flags|=4),typeof qe.getSnapshotBeforeUpdate!="function"||bt===M.memoizedProps&&ii===M.memoizedState||(T.flags|=1024),j=!1)}return im(M,T,B,j,oe,ee)}function im(M,T,B,j,ee,oe){SS(M,T);var qe=(T.flags&128)!==0;if(!j&&!qe)return ee&&qr(T,B,!1),gc(M,T,oe);j=T.stateNode,DC.current=T;var bt=qe&&typeof B.getDerivedStateFromError!="function"?null:j.render();return T.flags|=1,M!==null&&qe?(T.child=ku(T,M.child,null,oe),T.child=ku(T,null,bt,oe)):Uo(M,T,bt,oe),T.memoizedState=j.state,ee&&qr(T,B,!0),T.child}function ky(M){var T=M.stateNode;T.pendingContext?Fa(M,T.pendingContext,T.pendingContext!==T.context):T.context&&Fa(M,T.context,!1),gy(M,T.containerInfo)}function Dy(M,T,B,j,ee){return Wd(),py(ee),T.flags|=256,Uo(M,T,B,j),T.child}var rm={dehydrated:null,treeContext:null,retryLane:0};function am(M){return{baseLanes:M,cachePool:null}}function e1(M,T,B){var j=T.pendingProps,ee=Sr.current,oe=!1,qe=(T.flags&128)!==0,bt;if((bt=qe)||(bt=M!==null&&M.memoizedState===null?!1:(ee&2)!==0),bt?(oe=!0,T.flags&=-129):(M===null||M.memoizedState!==null)&&(ee|=1),Dn(Sr,ee&1),M===null)return F_(T),M=T.memoizedState,M!==null&&(M=M.dehydrated,M!==null)?(T.mode&1?mn(M)?T.lanes=8:T.lanes=1073741824:T.lanes=1,null):(ee=j.children,M=j.fallback,oe?(j=T.mode,oe=T.child,ee={mode:"hidden",children:ee},!(j&1)&&oe!==null?(oe.childLanes=0,oe.pendingProps=ee):oe=$u(ee,j,0,null),M=ll(M,j,B,null),oe.return=T,M.return=T,oe.sibling=M,T.child=oe,T.child.memoizedState=am(B),T.memoizedState=rm,M):zy(T,ee));if(ee=M.memoizedState,ee!==null){if(bt=ee.dehydrated,bt!==null){if(qe)return T.flags&256?(T.flags&=-257,mc(M,T,B,Error(d(422)))):T.memoizedState!==null?(T.child=M.child,T.flags|=128,null):(oe=j.fallback,ee=T.mode,j=$u({mode:"visible",children:j.children},ee,0,null),oe=ll(oe,ee,B,null),oe.flags|=2,j.return=T,oe.return=T,j.sibling=oe,T.child=j,T.mode&1&&ku(T,M.child,null,B),T.child.memoizedState=am(B),T.memoizedState=rm,oe);if(!(T.mode&1))T=mc(M,T,B,null);else if(mn(bt))T=mc(M,T,B,Error(d(419)));else if(j=(B&M.childLanes)!==0,ls||j){if(j=Xr,j!==null){switch(B&-B){case 4:oe=2;break;case 16:oe=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:oe=32;break;case 536870912:oe=268435456;break;default:oe=0}j=oe&(j.suspendedLanes|B)?0:oe,j!==0&&j!==ee.retryLane&&(ee.retryLane=j,eo(M,j,-1))}tv(),T=mc(M,T,B,Error(d(421)))}else Qt(bt)?(T.flags|=128,T.child=M.child,T=l1.bind(null,M),en(bt,T),T=null):(B=ee.treeContext,pt&&(ss=Ei(bt),po=T,Br=!0,Ol=null,rl=!1,B!==null&&(Co[Pa++]=dc,Co[Pa++]=Wc,Co[Pa++]=uc,dc=B.id,Wc=B.overflow,uc=T)),T=zy(T,T.pendingProps.children),T.flags|=4096);return T}return oe?(j=t1(M,T,j.children,j.fallback,B),oe=T.child,ee=M.child.memoizedState,oe.memoizedState=ee===null?am(B):{baseLanes:ee.baseLanes|B,cachePool:null},oe.childLanes=M.childLanes&~B,T.memoizedState=rm,j):(B=Oy(M,T,j.children,B),T.memoizedState=null,B)}return oe?(j=t1(M,T,j.children,j.fallback,B),oe=T.child,ee=M.child.memoizedState,oe.memoizedState=ee===null?am(B):{baseLanes:ee.baseLanes|B,cachePool:null},oe.childLanes=M.childLanes&~B,T.memoizedState=rm,j):(B=Oy(M,T,j.children,B),T.memoizedState=null,B)}function zy(M,T){return T=$u({mode:"visible",children:T},M.mode,0,null),T.return=M,M.child=T}function Oy(M,T,B,j){var ee=M.child;return M=ee.sibling,B=Xc(ee,{mode:"visible",children:B}),!(T.mode&1)&&(B.lanes=j),B.return=T,B.sibling=null,M!==null&&(j=T.deletions,j===null?(T.deletions=[M],T.flags|=16):j.push(M)),T.child=B}function t1(M,T,B,j,ee){var oe=T.mode;M=M.child;var qe=M.sibling,bt={mode:"hidden",children:B};return!(oe&1)&&T.child!==M?(B=T.child,B.childLanes=0,B.pendingProps=bt,T.deletions=null):(B=Xc(M,bt),B.subtreeFlags=M.subtreeFlags&14680064),qe!==null?j=Xc(qe,j):(j=ll(j,oe,ee,null),j.flags|=2),j.return=T,B.return=T,B.sibling=j,T.child=B,j}function mc(M,T,B,j){return j!==null&&py(j),ku(T,M.child,null,B),M=zy(T,T.pendingProps.children),M.flags|=2,T.memoizedState=null,M}function mf(M,T,B){M.lanes|=T;var j=M.alternate;j!==null&&(j.lanes|=T),Dr(M.return,T,B)}function Ny(M,T,B,j,ee){var oe=M.memoizedState;oe===null?M.memoizedState={isBackwards:T,rendering:null,renderingStartTime:0,last:j,tail:B,tailMode:ee}:(oe.isBackwards=T,oe.rendering=null,oe.renderingStartTime=0,oe.last=j,oe.tail=B,oe.tailMode=ee)}function Bu(M,T,B){var j=T.pendingProps,ee=j.revealOrder,oe=j.tail;if(Uo(M,T,j.children,B),j=Sr.current,j&2)j=j&1|2,T.flags|=128;else{if(M!==null&&M.flags&128)e:for(M=T.child;M!==null;){if(M.tag===13)M.memoizedState!==null&&mf(M,B,T);else if(M.tag===19)mf(M,B,T);else if(M.child!==null){M.child.return=M,M=M.child;continue}if(M===T)break e;for(;M.sibling===null;){if(M.return===null||M.return===T)break e;M=M.return}M.sibling.return=M.return,M=M.sibling}j&=1}if(Dn(Sr,j),!(T.mode&1))T.memoizedState=null;else switch(ee){case"forwards":for(B=T.child,ee=null;B!==null;)M=B.alternate,M!==null&&Gd(M)===null&&(ee=B),B=B.sibling;B=ee,B===null?(ee=T.child,T.child=null):(ee=B.sibling,B.sibling=null),Ny(T,!1,ee,B,oe);break;case"backwards":for(B=null,ee=T.child,T.child=null;ee!==null;){if(M=ee.alternate,M!==null&&Gd(M)===null){T.child=ee;break}M=ee.sibling,ee.sibling=B,B=ee,ee=M}Ny(T,!0,B,null,oe);break;case"together":Ny(T,!1,null,null,void 0);break;default:T.memoizedState=null}return T.child}function gc(M,T,B){if(M!==null&&(T.dependencies=M.dependencies),Qd|=T.lanes,!(B&T.childLanes))return null;if(M!==null&&T.child!==M.child)throw Error(d(153));if(T.child!==null){for(M=T.child,B=Xc(M,M.pendingProps),T.child=B,B.return=T;M.sibling!==null;)M=M.sibling,B=B.sibling=Xc(M,M.pendingProps),B.return=T;B.sibling=null}return T.child}function Xd(M,T,B){switch(T.tag){case 3:ky(T),Wd();break;case 5:hc(T);break;case 1:ta(T.type)&&Qn(T);break;case 4:gy(T,T.stateNode.containerInfo);break;case 10:Fd(T,T.type._context,T.memoizedProps.value);break;case 13:var j=T.memoizedState;if(j!==null)return j.dehydrated!==null?(Dn(Sr,Sr.current&1),T.flags|=128,null):B&T.child.childLanes?e1(M,T,B):(Dn(Sr,Sr.current&1),M=gc(M,T,B),M!==null?M.sibling:null);Dn(Sr,Sr.current&1);break;case 19:if(j=(B&T.childLanes)!==0,M.flags&128){if(j)return Bu(M,T,B);T.flags|=128}var ee=T.memoizedState;if(ee!==null&&(ee.rendering=null,ee.tail=null,ee.lastEffect=null),Dn(Sr,Sr.current),j)break;return null;case 22:case 23:return T.lanes=0,wS(M,T,B)}return gc(M,T,B)}function MS(M,T){switch(N_(T),T.tag){case 1:return ta(T.type)&&yr(),M=T.flags,M&65536?(T.flags=M&-65537|128,T):null;case 3:return Vc(),si(kr),si(Oi),Yp(),M=T.flags,M&65536&&!(M&128)?(T.flags=M&-65537|128,T):null;case 5:return $p(T),null;case 13:if(si(Sr),M=T.memoizedState,M!==null&&M.dehydrated!==null){if(T.alternate===null)throw Error(d(340));Wd()}return M=T.flags,M&65536?(T.flags=M&-65537|128,T):null;case 19:return si(Sr),null;case 4:return Vc(),null;case 10:return Ua(T.type._context),null;case 22:case 23:return Sm(),null;case 24:return null;default:return null}}var gf=!1,Gc=!1,Fy=typeof WeakSet=="function"?WeakSet:Set,Mn=null;function om(M,T){var B=M.ref;if(B!==null)if(typeof B=="function")try{B(null)}catch(j){Zo(M,T,j)}else B.current=null}function Zd(M,T,B){try{B()}catch(j){Zo(M,T,j)}}var TS=!1;function zC(M,T){for(me(M.containerInfo),Mn=T;Mn!==null;)if(M=Mn,T=M.child,(M.subtreeFlags&1028)!==0&&T!==null)T.return=M,Mn=T;else for(;Mn!==null;){M=Mn;try{var B=M.alternate;if(M.flags&1024)switch(M.tag){case 0:case 11:case 15:break;case 1:if(B!==null){var j=B.memoizedProps,ee=B.memoizedState,oe=M.stateNode,qe=oe.getSnapshotBeforeUpdate(M.elementType===M.type?j:Ao(M.type,j),ee);oe.__reactInternalSnapshotBeforeUpdate=qe}break;case 3:Et&&Qe(M.stateNode.containerInfo);break;case 5:case 6:case 4:case 17:break;default:throw Error(d(163))}}catch(bt){Zo(M,M.return,bt)}if(T=M.sibling,T!==null){T.return=M.return,Mn=T;break}Mn=M.return}return B=TS,TS=!1,B}function Uu(M,T,B){var j=T.updateQueue;if(j=j!==null?j.lastEffect:null,j!==null){var ee=j=j.next;do{if((ee.tag&M)===M){var oe=ee.destroy;ee.destroy=void 0,oe!==void 0&&Zd(T,B,oe)}ee=ee.next}while(ee!==j)}}function sm(M,T){if(T=T.updateQueue,T=T!==null?T.lastEffect:null,T!==null){var B=T=T.next;do{if((B.tag&M)===M){var j=B.create;B.destroy=j()}B=B.next}while(B!==T)}}function lm(M){var T=M.ref;if(T!==null){var B=M.stateNode;switch(M.tag){case 5:M=Re(B);break;default:M=B}typeof T=="function"?T(M):T.current=M}}function cm(M,T,B){if(an&&typeof an.onCommitFiberUnmount=="function")try{an.onCommitFiberUnmount(el,T)}catch{}switch(T.tag){case 0:case 11:case 14:case 15:if(M=T.updateQueue,M!==null&&(M=M.lastEffect,M!==null)){var j=M=M.next;do{var ee=j,oe=ee.destroy;ee=ee.tag,oe!==void 0&&(ee&2||ee&4)&&Zd(T,B,oe),j=j.next}while(j!==M)}break;case 1:if(om(T,B),M=T.stateNode,typeof M.componentWillUnmount=="function")try{M.props=T.memoizedProps,M.state=T.memoizedState,M.componentWillUnmount()}catch(qe){Zo(T,B,qe)}break;case 5:om(T,B);break;case 4:Et?n1(M,T,B):Ie&&Ie&&(T=T.stateNode.containerInfo,B=Ce(T),tt(T,B))}}function Hc(M,T,B){for(var j=T;;)if(cm(M,j,B),j.child===null||Et&&j.tag===4){if(j===T)break;for(;j.sibling===null;){if(j.return===null||j.return===T)return;j=j.return}j.sibling.return=j.return,j=j.sibling}else j.child.return=j,j=j.child}function By(M){var T=M.alternate;T!==null&&(M.alternate=null,By(T)),M.child=null,M.deletions=null,M.sibling=null,M.tag===5&&(T=M.stateNode,T!==null&&ue(T)),M.stateNode=null,M.return=null,M.dependencies=null,M.memoizedProps=null,M.memoizedState=null,M.pendingProps=null,M.stateNode=null,M.updateQueue=null}function jc(M){return M.tag===5||M.tag===3||M.tag===4}function Uy(M){e:for(;;){for(;M.sibling===null;){if(M.return===null||jc(M.return))return null;M=M.return}for(M.sibling.return=M.return,M=M.sibling;M.tag!==5&&M.tag!==6&&M.tag!==18;){if(M.flags&2||M.child===null||M.tag===4)continue e;M.child.return=M,M=M.child}if(!(M.flags&2))return M.stateNode}}function um(M){if(Et){e:{for(var T=M.return;T!==null;){if(jc(T))break e;T=T.return}throw Error(d(160))}var B=T;switch(B.tag){case 5:T=B.stateNode,B.flags&32&&(Pt(T),B.flags&=-33),B=Uy(M),cs(M,B,T);break;case 3:case 4:T=B.stateNode.containerInfo,B=Uy(M),yf(M,B,T);break;default:throw Error(d(161))}}}function yf(M,T,B){var j=M.tag;if(j===5||j===6)M=M.stateNode,T?wt(B,M,T):Mt(B,M);else if(j!==4&&(M=M.child,M!==null))for(yf(M,T,B),M=M.sibling;M!==null;)yf(M,T,B),M=M.sibling}function cs(M,T,B){var j=M.tag;if(j===5||j===6)M=M.stateNode,T?Dt(B,M,T):lt(B,M);else if(j!==4&&(M=M.child,M!==null))for(cs(M,T,B),M=M.sibling;M!==null;)cs(M,T,B),M=M.sibling}function n1(M,T,B){for(var j=T,ee=!1,oe,qe;;){if(!ee){ee=j.return;e:for(;;){if(ee===null)throw Error(d(160));switch(oe=ee.stateNode,ee.tag){case 5:qe=!1;break e;case 3:oe=oe.containerInfo,qe=!0;break e;case 4:oe=oe.containerInfo,qe=!0;break e}ee=ee.return}ee=!0}if(j.tag===5||j.tag===6)Hc(M,j,B),qe?$e(oe,j.stateNode):Xt(oe,j.stateNode);else if(j.tag===18)qe?Nt(oe,j.stateNode):Rt(oe,j.stateNode);else if(j.tag===4){if(j.child!==null){oe=j.stateNode.containerInfo,qe=!0,j.child.return=j,j=j.child;continue}}else if(cm(M,j,B),j.child!==null){j.child.return=j,j=j.child;continue}if(j===T)break;for(;j.sibling===null;){if(j.return===null||j.return===T)return;j=j.return,j.tag===4&&(ee=!1)}j.sibling.return=j.return,j=j.sibling}}function Wy(M,T){if(Et){switch(T.tag){case 0:case 11:case 14:case 15:Uu(3,T,T.return),sm(3,T),Uu(5,T,T.return);return;case 1:return;case 5:var B=T.stateNode;if(B!=null){var j=T.memoizedProps;M=M!==null?M.memoizedProps:j;var ee=T.type,oe=T.updateQueue;T.updateQueue=null,oe!==null&&Ht(B,oe,ee,M,j,T)}return;case 6:if(T.stateNode===null)throw Error(d(162));B=T.memoizedProps,Ut(T.stateNode,M!==null?M.memoizedProps:B,B);return;case 3:pt&&M!==null&&M.memoizedState.isDehydrated&&xt(T.stateNode.containerInfo);return;case 12:return;case 13:dm(T);return;case 19:dm(T);return;case 17:return}throw Error(d(163))}switch(T.tag){case 0:case 11:case 14:case 15:Uu(3,T,T.return),sm(3,T),Uu(5,T,T.return);return;case 12:return;case 13:dm(T);return;case 19:dm(T);return;case 3:pt&&M!==null&&M.memoizedState.isDehydrated&&xt(T.stateNode.containerInfo);break;case 22:case 23:return}e:if(Ie){switch(T.tag){case 1:case 5:case 6:break e;case 3:case 4:T=T.stateNode,tt(T.containerInfo,T.pendingChildren);break e}throw Error(d(163))}}function dm(M){var T=M.updateQueue;if(T!==null){M.updateQueue=null;var B=M.stateNode;B===null&&(B=M.stateNode=new Fy),T.forEach(function(j){var ee=RS.bind(null,M,j);B.has(j)||(B.add(j),j.then(ee,ee))})}}function Kd(M,T){for(Mn=T;Mn!==null;){T=Mn;var B=T.deletions;if(B!==null)for(var j=0;j<B.length;j++){var ee=B[j];try{var oe=M;Et?n1(oe,ee,T):Hc(oe,ee,T);var qe=ee.alternate;qe!==null&&(qe.return=null),ee.return=null}catch(On){Zo(ee,T,On)}}if(B=T.child,T.subtreeFlags&12854&&B!==null)B.return=T,Mn=B;else for(;Mn!==null;){T=Mn;try{var bt=T.flags;if(bt&32&&Et&&Pt(T.stateNode),bt&512){var Yt=T.alternate;if(Yt!==null){var hn=Yt.ref;hn!==null&&(typeof hn=="function"?hn(null):hn.current=null)}}if(bt&8192)switch(T.tag){case 13:if(T.memoizedState!==null){var Cn=T.alternate;(Cn===null||Cn.memoizedState===null)&&(Xy=ur())}break;case 22:var Ti=T.memoizedState!==null,ii=T.alternate,Mr=ii!==null&&ii.memoizedState!==null;if(B=T,Et){e:if(j=B,ee=Ti,oe=null,Et)for(var $n=j;;){if($n.tag===5){if(oe===null){oe=$n;var vo=$n.stateNode;ee?qt(vo):fn($n.stateNode,$n.memoizedProps)}}else if($n.tag===6){if(oe===null){var no=$n.stateNode;ee?Ot(no):be(no,$n.memoizedProps)}}else if(($n.tag!==22&&$n.tag!==23||$n.memoizedState===null||$n===j)&&$n.child!==null){$n.child.return=$n,$n=$n.child;continue}if($n===j)break;for(;$n.sibling===null;){if($n.return===null||$n.return===j)break e;oe===$n&&(oe=null),$n=$n.return}oe===$n&&(oe=null),$n.sibling.return=$n.return,$n=$n.sibling}}if(Ti&&!Mr&&B.mode&1){Mn=B;for(var Bt=B.child;Bt!==null;){for(B=Mn=Bt;Mn!==null;){j=Mn;var Tt=j.child;switch(j.tag){case 0:case 11:case 14:case 15:Uu(4,j,j.return);break;case 1:om(j,j.return);var Gt=j.stateNode;if(typeof Gt.componentWillUnmount=="function"){var Tn=j.return;try{Gt.props=j.memoizedProps,Gt.state=j.memoizedState,Gt.componentWillUnmount()}catch(On){Zo(j,Tn,On)}}break;case 5:om(j,j.return);break;case 22:if(j.memoizedState!==null){fm(B);continue}}Tt!==null?(Tt.return=j,Mn=Tt):fm(B)}Bt=Bt.sibling}}}switch(bt&4102){case 2:um(T),T.flags&=-3;break;case 6:um(T),T.flags&=-3,Wy(T.alternate,T);break;case 4096:T.flags&=-4097;break;case 4100:T.flags&=-4097,Wy(T.alternate,T);break;case 4:Wy(T.alternate,T)}}catch(On){Zo(T,T.return,On)}if(B=T.sibling,B!==null){B.return=T.return,Mn=B;break}Mn=T.return}}}function AS(M,T,B){Mn=M,hm(M)}function hm(M,T,B){for(var j=(M.mode&1)!==0;Mn!==null;){var ee=Mn,oe=ee.child;if(ee.tag===22&&j){var qe=ee.memoizedState!==null||gf;if(!qe){var bt=ee.alternate,Yt=bt!==null&&bt.memoizedState!==null||Gc;bt=gf;var hn=Gc;if(gf=qe,(Gc=Yt)&&!hn)for(Mn=ee;Mn!==null;)qe=Mn,Yt=qe.child,qe.tag===22&&qe.memoizedState!==null?i1(ee):Yt!==null?(Yt.return=qe,Mn=Yt):i1(ee);for(;oe!==null;)Mn=oe,hm(oe),oe=oe.sibling;Mn=ee,gf=bt,Gc=hn}Vy(M)}else ee.subtreeFlags&8772&&oe!==null?(oe.return=ee,Mn=oe):Vy(M)}}function Vy(M){for(;Mn!==null;){var T=Mn;if(T.flags&8772){var B=T.alternate;try{if(T.flags&8772)switch(T.tag){case 0:case 11:case 15:Gc||sm(5,T);break;case 1:var j=T.stateNode;if(T.flags&4&&!Gc)if(B===null)j.componentDidMount();else{var ee=T.elementType===T.type?B.memoizedProps:Ao(T.type,B.memoizedProps);j.componentDidUpdate(ee,B.memoizedState,j.__reactInternalSnapshotBeforeUpdate)}var oe=T.updateQueue;oe!==null&&Ca(T,oe,j);break;case 3:var qe=T.updateQueue;if(qe!==null){if(B=null,T.child!==null)switch(T.child.tag){case 5:B=Re(T.child.stateNode);break;case 1:B=T.child.stateNode}Ca(T,qe,B)}break;case 5:var bt=T.stateNode;B===null&&T.flags&4&&Wt(bt,T.type,T.memoizedProps,T);break;case 6:break;case 4:break;case 12:break;case 13:if(pt&&T.memoizedState===null){var Yt=T.alternate;if(Yt!==null){var hn=Yt.memoizedState;if(hn!==null){var Cn=hn.dehydrated;Cn!==null&&zt(Cn)}}}break;case 19:case 17:case 21:case 22:case 23:break;default:throw Error(d(163))}Gc||T.flags&512&&lm(T)}catch(Ti){Zo(T,T.return,Ti)}}if(T===M){Mn=null;break}if(B=T.sibling,B!==null){B.return=T.return,Mn=B;break}Mn=T.return}}function fm(M){for(;Mn!==null;){var T=Mn;if(T===M){Mn=null;break}var B=T.sibling;if(B!==null){B.return=T.return,Mn=B;break}Mn=T.return}}function i1(M){for(;Mn!==null;){var T=Mn;try{switch(T.tag){case 0:case 11:case 15:var B=T.return;try{sm(4,T)}catch(Yt){Zo(T,B,Yt)}break;case 1:var j=T.stateNode;if(typeof j.componentDidMount=="function"){var ee=T.return;try{j.componentDidMount()}catch(Yt){Zo(T,ee,Yt)}}var oe=T.return;try{lm(T)}catch(Yt){Zo(T,oe,Yt)}break;case 5:var qe=T.return;try{lm(T)}catch(Yt){Zo(T,qe,Yt)}}}catch(Yt){Zo(T,T.return,Yt)}if(T===M){Mn=null;break}var bt=T.sibling;if(bt!==null){bt.return=T.return,Mn=bt;break}Mn=T.return}}var pm=0,$c=1,Gy=2,Hy=3,mm=4;if(typeof Symbol=="function"&&Symbol.for){var Wu=Symbol.for;pm=Wu("selector.component"),$c=Wu("selector.has_pseudo_class"),Gy=Wu("selector.role"),Hy=Wu("selector.test_id"),mm=Wu("selector.text")}function gm(M){var T=gt(M);if(T!=null){if(typeof T.memoizedProps["data-testname"]!="string")throw Error(d(364));return T}if(M=ze(M),M===null)throw Error(d(362));return M.stateNode.current}function jy(M,T){switch(T.$$typeof){case pm:if(M.type===T.value)return!0;break;case $c:e:{T=T.value,M=[M,0];for(var B=0;B<M.length;){var j=M[B++],ee=M[B++],oe=T[ee];if(j.tag!==5||!ie(j)){for(;oe!=null&&jy(j,oe);)ee++,oe=T[ee];if(ee===T.length){T=!0;break e}else for(j=j.child;j!==null;)M.push(j,ee),j=j.sibling}}T=!1}return T;case Gy:if(M.tag===5&&Oe(M.stateNode,T.value))return!0;break;case mm:if((M.tag===5||M.tag===6)&&(M=de(M),M!==null&&0<=M.indexOf(T.value)))return!0;break;case Hy:if(M.tag===5&&(M=M.memoizedProps["data-testname"],typeof M=="string"&&M.toLowerCase()===T.value.toLowerCase()))return!0;break;default:throw Error(d(365))}return!1}function $y(M){switch(M.$$typeof){case pm:return"<"+(Y(M.value)||"Unknown")+">";case $c:return":has("+($y(M)||"")+")";case Gy:return'[role="'+M.value+'"]';case mm:return'"'+M.value+'"';case Hy:return'[data-testname="'+M.value+'"]';default:throw Error(d(365))}}function ym(M,T){var B=[];M=[M,0];for(var j=0;j<M.length;){var ee=M[j++],oe=M[j++],qe=T[oe];if(ee.tag!==5||!ie(ee)){for(;qe!=null&&jy(ee,qe);)oe++,qe=T[oe];if(oe===T.length)B.push(ee);else for(ee=ee.child;ee!==null;)M.push(ee,oe),ee=ee.sibling}}return B}function vm(M,T){if(!Ye)throw Error(d(363));M=gm(M),M=ym(M,T),T=[],M=Array.from(M);for(var B=0;B<M.length;){var j=M[B++];if(j.tag===5)ie(j)||T.push(j.stateNode);else for(j=j.child;j!==null;)M.push(j),j=j.sibling}return T}var CS=Math.ceil,_m=f.ReactCurrentDispatcher,Yy=f.ReactCurrentOwner,ya=f.ReactCurrentBatchConfig,Fi=0,Xr=null,Ia=null,go=0,Ds=0,Jd=ea(0),Wa=0,vf=null,Qd=0,xm=0,qy=0,la=null,us=null,Xy=0,Vu=1/0;function _f(){Vu=ur()+500}var Zy=!1,r1=null,Gu=null,Ky=!1,Hu=null,xf=0,bm=0,a1=null,Jy=-1,ds=0;function yo(){return Fi&6?ur():Jy!==-1?Jy:Jy=ur()}function ju(M){return M.mode&1?Fi&2&&go!==0?go&-go:vr.transition!==null?(ds===0&&(M=lc,lc<<=1,!(lc&4194240)&&(lc=64),ds=M),ds):(M=Vn,M!==0?M:Ue()):1}function eo(M,T,B){if(50<bm)throw bm=0,a1=null,Error(d(185));var j=zs(M,T);return j===null?null:(Js(j,T,B),(!(Fi&2)||j!==Xr)&&(j===Xr&&(!(Fi&2)&&(xm|=T),Wa===4&&Os(j,go)),to(j,B),T===1&&Fi===0&&!(M.mode&1)&&(_f(),li&&Fr())),j)}function zs(M,T){M.lanes|=T;var B=M.alternate;for(B!==null&&(B.lanes|=T),B=M,M=M.return;M!==null;)M.childLanes|=T,B=M.alternate,B!==null&&(B.childLanes|=T),B=M,M=M.return;return B.tag===3?B.stateNode:null}function to(M,T){var B=M.callbackNode;ef(M,T);var j=kl(M,M===Xr?go:0);if(j===0)B!==null&&Qs(B),M.callbackNode=null,M.callbackPriority=0;else if(T=j&-j,M.callbackPriority!==T){if(B!=null&&Qs(B),T===1)M.tag===0?Uc(eh.bind(null,M)):Bc(eh.bind(null,M)),se?xe(function(){Fi===0&&Fr()}):cn(Od,Fr),B=null;else{switch(rt(j)){case 1:B=Od;break;case 4:B=Ls;break;case 16:B=To;break;case 536870912:B=Gp;break;default:B=To}B=dr(B,wm.bind(null,M))}M.callbackPriority=T,M.callbackNode=B}}function wm(M,T){if(Jy=-1,ds=0,Fi&6)throw Error(d(327));var B=M.callbackNode;if(Va()&&M.callbackNode!==B)return null;var j=kl(M,M===Xr?go:0);if(j===0)return null;if(j&30||j&M.expiredLanes||T)T=Em(M,j);else{T=j;var ee=Fi;Fi|=2;var oe=ev();(Xr!==M||go!==T)&&(_f(),th(M,T));do try{NC();break}catch(bt){IS(M,bt)}while(1);Cu(),_m.current=oe,Fi=ee,Ia!==null?T=0:(Xr=null,go=0,T=Wa)}if(T!==0){if(T===2&&(ee=cc(M),ee!==0&&(j=ee,T=dn(M,ee))),T===1)throw B=vf,th(M,0),Os(M,j),to(M,ur()),B;if(T===6)Os(M,j);else{if(ee=M.current.alternate,!(j&30)&&!PS(ee)&&(T=Em(M,j),T===2&&(oe=cc(M),oe!==0&&(j=oe,T=dn(M,oe))),T===1))throw B=vf,th(M,0),Os(M,j),to(M,ur()),B;switch(M.finishedWork=ee,M.finishedLanes=j,T){case 0:case 1:throw Error(d(345));case 2:Yc(M,us);break;case 3:if(Os(M,j),(j&130023424)===j&&(T=Xy+500-ur(),10<T)){if(kl(M,0)!==0)break;if(ee=M.suspendedLanes,(ee&j)!==j){yo(),M.pingedLanes|=M.suspendedLanes&ee;break}M.timeoutHandle=ct(Yc.bind(null,M,us),T);break}Yc(M,us);break;case 4:if(Os(M,j),(j&4194240)===j)break;for(T=M.eventTimes,ee=-1;0<j;){var qe=31-Ta(j);oe=1<<qe,qe=T[qe],qe>ee&&(ee=qe),j&=~oe}if(j=ee,j=ur()-j,j=(120>j?120:480>j?480:1080>j?1080:1920>j?1920:3e3>j?3e3:4320>j?4320:1960*CS(j/1960))-j,10<j){M.timeoutHandle=ct(Yc.bind(null,M,us),j);break}Yc(M,us);break;case 5:Yc(M,us);break;default:throw Error(d(329))}}}return to(M,ur()),M.callbackNode===B?wm.bind(null,M):null}function dn(M,T){var B=la;return M.current.memoizedState.isDehydrated&&(th(M,T).flags|=256),M=Em(M,T),M!==2&&(T=us,us=B,T!==null&&Qy(T)),M}function Qy(M){us===null?us=M:us.push.apply(us,M)}function PS(M){for(var T=M;;){if(T.flags&16384){var B=T.updateQueue;if(B!==null&&(B=B.stores,B!==null))for(var j=0;j<B.length;j++){var ee=B[j],oe=ee.getSnapshot;ee=ee.value;try{if(!na(oe(),ee))return!1}catch{return!1}}}if(B=T.child,T.subtreeFlags&16384&&B!==null)B.return=T,T=B;else{if(T===M)break;for(;T.sibling===null;){if(T.return===null||T.return===M)return!0;T=T.return}T.sibling.return=T.return,T=T.sibling}}return!0}function Os(M,T){for(T&=~qy,T&=~xm,M.suspendedLanes|=T,M.pingedLanes&=~T,M=M.expirationTimes;0<T;){var B=31-Ta(T),j=1<<B;M[B]=-1,T&=~j}}function eh(M){if(Fi&6)throw Error(d(327));Va();var T=kl(M,0);if(!(T&1))return to(M,ur()),null;var B=Em(M,T);if(M.tag!==0&&B===2){var j=cc(M);j!==0&&(T=j,B=dn(M,j))}if(B===1)throw B=vf,th(M,0),Os(M,T),to(M,ur()),B;if(B===6)throw Error(d(345));return M.finishedWork=M.current.alternate,M.finishedLanes=T,Yc(M,us),to(M,ur()),null}function gn(M){Hu!==null&&Hu.tag===0&&!(Fi&6)&&Va();var T=Fi;Fi|=1;var B=ya.transition,j=Vn;try{if(ya.transition=null,Vn=1,M)return M()}finally{Vn=j,ya.transition=B,Fi=T,!(Fi&6)&&Fr()}}function Sm(){Ds=Jd.current,si(Jd)}function th(M,T){M.finishedWork=null,M.finishedLanes=0;var B=M.timeoutHandle;if(B!==kt&&(M.timeoutHandle=kt,At(B)),Ia!==null)for(B=Ia.return;B!==null;){var j=B;switch(N_(j),j.tag){case 1:j=j.type.childContextTypes,j!=null&&yr();break;case 3:Vc(),si(kr),si(Oi),Yp();break;case 5:$p(j);break;case 4:Vc();break;case 13:si(Sr);break;case 19:si(Sr);break;case 10:Ua(j.type._context);break;case 22:case 23:Sm()}B=B.return}if(Xr=M,Ia=M=Xc(M.current,null),go=Ds=T,Wa=0,vf=null,qy=xm=Qd=0,us=la=null,Xo!==null){for(T=0;T<Xo.length;T++)if(B=Xo[T],j=B.interleaved,j!==null){B.interleaved=null;var ee=j.next,oe=B.pending;if(oe!==null){var qe=oe.next;oe.next=ee,j.next=qe}B.pending=j}Xo=null}return M}function IS(M,T){do{var B=Ia;try{if(Cu(),yy.current=Ty,vy){for(var j=ia.memoizedState;j!==null;){var ee=j.queue;ee!==null&&(ee.pending=null),j=j.next}vy=!1}if(Hd=0,mo=Fo=ia=null,qp=!1,lf=0,Yy.current=null,B===null||B.return===null){Wa=1,vf=T,Ia=null;break}e:{var oe=M,qe=B.return,bt=B,Yt=T;if(T=go,bt.flags|=32768,Yt!==null&&typeof Yt=="object"&&typeof Yt.then=="function"){var hn=Yt,Cn=bt,Ti=Cn.tag;if(!(Cn.mode&1)&&(Ti===0||Ti===11||Ti===15)){var ii=Cn.alternate;ii?(Cn.updateQueue=ii.updateQueue,Cn.memoizedState=ii.memoizedState,Cn.lanes=ii.lanes):(Cn.updateQueue=null,Cn.memoizedState=null)}var Mr=J_(qe);if(Mr!==null){Mr.flags&=-257,Py(Mr,qe,bt,oe,T),Mr.mode&1&&Cy(oe,hn,T),T=Mr,Yt=hn;var $n=T.updateQueue;if($n===null){var vo=new Set;vo.add(Yt),T.updateQueue=vo}else $n.add(Yt);break e}else{if(!(T&1)){Cy(oe,hn,T),tv();break e}Yt=Error(d(426))}}else if(Br&&bt.mode&1){var no=J_(qe);if(no!==null){!(no.flags&65536)&&(no.flags|=256),Py(no,qe,bt,oe,T),py(Yt);break e}}oe=Yt,Wa!==4&&(Wa=2),la===null?la=[oe]:la.push(oe),Yt=ff(Yt,bt),bt=qe;do{switch(bt.tag){case 3:bt.flags|=65536,T&=-T,bt.lanes|=T;var Bt=Ay(bt,Yt,T);cy(bt,Bt);break e;case 1:oe=Yt;var Tt=bt.type,Gt=bt.stateNode;if(!(bt.flags&128)&&(typeof Tt.getDerivedStateFromError=="function"||Gt!==null&&typeof Gt.componentDidCatch=="function"&&(Gu===null||!Gu.has(Gt)))){bt.flags|=65536,T&=-T,bt.lanes|=T;var Tn=K_(bt,oe,T);cy(bt,Tn);break e}}bt=bt.return}while(bt!==null)}iv(B)}catch(On){T=On,Ia===B&&B!==null&&(Ia=B=B.return);continue}break}while(1)}function ev(){var M=_m.current;return _m.current=Ty,M===null?Ty:M}function tv(){(Wa===0||Wa===3||Wa===2)&&(Wa=4),Xr===null||!(Qd&268435455)&&!(xm&268435455)||Os(Xr,go)}function Em(M,T){var B=Fi;Fi|=2;var j=ev();Xr===M&&go===T||th(M,T);do try{OC();break}catch(ee){IS(M,ee)}while(1);if(Cu(),Fi=B,_m.current=j,Ia!==null)throw Error(d(261));return Xr=null,go=0,Wa}function OC(){for(;Ia!==null;)nv(Ia)}function NC(){for(;Ia!==null&&!Rs();)nv(Ia)}function nv(M){var T=Ns(M.alternate,M,Ds);M.memoizedProps=M.pendingProps,T===null?iv(M):Ia=T,Yy.current=null}function iv(M){var T=M;do{var B=T.alternate;if(M=T.return,T.flags&32768){if(B=MS(B,T),B!==null){B.flags&=32767,Ia=B;return}if(M!==null)M.flags|=32768,M.subtreeFlags=0,M.deletions=null;else{Wa=6,Ia=null;return}}else if(B=Ly(B,T,Ds),B!==null){Ia=B;return}if(T=T.sibling,T!==null){Ia=T;return}Ia=T=M}while(T!==null);Wa===0&&(Wa=5)}function Yc(M,T){var B=Vn,j=ya.transition;try{ya.transition=null,Vn=1,o1(M,T,B)}finally{ya.transition=j,Vn=B}return null}function o1(M,T,B){do Va();while(Hu!==null);if(Fi&6)throw Error(d(327));var j=M.finishedWork,ee=M.finishedLanes;if(j===null)return null;if(M.finishedWork=null,M.finishedLanes=0,j===M.current)throw Error(d(177));M.callbackNode=null,M.callbackPriority=0;var oe=j.lanes|j.childLanes;if($t(M,oe),M===Xr&&(Ia=Xr=null,go=0),!(j.subtreeFlags&2064)&&!(j.flags&2064)||Ky||(Ky=!0,dr(To,function(){return Va(),null})),oe=(j.flags&15990)!==0,j.subtreeFlags&15990||oe){oe=ya.transition,ya.transition=null;var qe=Vn;Vn=1;var bt=Fi;Fi|=4,Yy.current=null,zC(M,j),Kd(M,j),we(M.containerInfo),M.current=j,AS(j),$r(),Fi=bt,Vn=qe,ya.transition=oe}else M.current=j;if(Ky&&(Ky=!1,Hu=M,xf=ee),oe=M.pendingLanes,oe===0&&(Gu=null),xi(j.stateNode),to(M,ur()),T!==null)for(B=M.onRecoverableError,j=0;j<T.length;j++)B(T[j]);if(Zy)throw Zy=!1,M=r1,r1=null,M;return xf&1&&M.tag!==0&&Va(),oe=M.pendingLanes,oe&1?M===a1?bm++:(bm=0,a1=M):bm=0,Fr(),null}function Va(){if(Hu!==null){var M=rt(xf),T=ya.transition,B=Vn;try{if(ya.transition=null,Vn=16>M?16:M,Hu===null)var j=!1;else{if(M=Hu,Hu=null,xf=0,Fi&6)throw Error(d(331));var ee=Fi;for(Fi|=4,Mn=M.current;Mn!==null;){var oe=Mn,qe=oe.child;if(Mn.flags&16){var bt=oe.deletions;if(bt!==null){for(var Yt=0;Yt<bt.length;Yt++){var hn=bt[Yt];for(Mn=hn;Mn!==null;){var Cn=Mn;switch(Cn.tag){case 0:case 11:case 15:Uu(8,Cn,oe)}var Ti=Cn.child;if(Ti!==null)Ti.return=Cn,Mn=Ti;else for(;Mn!==null;){Cn=Mn;var ii=Cn.sibling,Mr=Cn.return;if(By(Cn),Cn===hn){Mn=null;break}if(ii!==null){ii.return=Mr,Mn=ii;break}Mn=Mr}}}var $n=oe.alternate;if($n!==null){var vo=$n.child;if(vo!==null){$n.child=null;do{var no=vo.sibling;vo.sibling=null,vo=no}while(vo!==null)}}Mn=oe}}if(oe.subtreeFlags&2064&&qe!==null)qe.return=oe,Mn=qe;else e:for(;Mn!==null;){if(oe=Mn,oe.flags&2048)switch(oe.tag){case 0:case 11:case 15:Uu(9,oe,oe.return)}var Bt=oe.sibling;if(Bt!==null){Bt.return=oe.return,Mn=Bt;break e}Mn=oe.return}}var Tt=M.current;for(Mn=Tt;Mn!==null;){qe=Mn;var Gt=qe.child;if(qe.subtreeFlags&2064&&Gt!==null)Gt.return=qe,Mn=Gt;else e:for(qe=Tt;Mn!==null;){if(bt=Mn,bt.flags&2048)try{switch(bt.tag){case 0:case 11:case 15:sm(9,bt)}}catch(On){Zo(bt,bt.return,On)}if(bt===qe){Mn=null;break e}var Tn=bt.sibling;if(Tn!==null){Tn.return=bt.return,Mn=Tn;break e}Mn=bt.return}}if(Fi=ee,Fr(),an&&typeof an.onPostCommitFiberRoot=="function")try{an.onPostCommitFiberRoot(el,M)}catch{}j=!0}return j}finally{Vn=B,ya.transition=T}}return!1}function qc(M,T,B){T=ff(B,T),T=Ay(M,T,1),zr(M,T),T=yo(),M=zs(M,1),M!==null&&(Js(M,1,T),to(M,T))}function Zo(M,T,B){if(M.tag===3)qc(M,M,B);else for(;T!==null;){if(T.tag===3){qc(T,M,B);break}else if(T.tag===1){var j=T.stateNode;if(typeof T.type.getDerivedStateFromError=="function"||typeof j.componentDidCatch=="function"&&(Gu===null||!Gu.has(j))){M=ff(B,M),M=K_(T,M,1),zr(T,M),M=yo(),T=zs(T,1),T!==null&&(Js(T,1,M),to(T,M));break}}T=T.return}}function s1(M,T,B){var j=M.pingCache;j!==null&&j.delete(T),T=yo(),M.pingedLanes|=M.suspendedLanes&B,Xr===M&&(go&B)===B&&(Wa===4||Wa===3&&(go&130023424)===go&&500>ur()-Xy?th(M,0):qy|=B),to(M,T)}function rv(M,T){T===0&&(M.mode&1?(T=Rl,Rl<<=1,!(Rl&130023424)&&(Rl=4194304)):T=1);var B=yo();M=zs(M,T),M!==null&&(Js(M,T,B),to(M,B))}function l1(M){var T=M.memoizedState,B=0;T!==null&&(B=T.retryLane),rv(M,B)}function RS(M,T){var B=0;switch(M.tag){case 13:var j=M.stateNode,ee=M.memoizedState;ee!==null&&(B=ee.retryLane);break;case 19:j=M.stateNode;break;default:throw Error(d(314))}j!==null&&j.delete(T),rv(M,B)}var Ns;Ns=function(M,T,B){if(M!==null)if(M.memoizedProps!==T.pendingProps||kr.current)ls=!0;else{if(!(M.lanes&B)&&!(T.flags&128))return ls=!1,Xd(M,T,B);ls=!!(M.flags&131072)}else ls=!1,Br&&T.flags&1048576&&rf(T,jp,T.index);switch(T.lanes=0,T.tag){case 2:var j=T.type;M!==null&&(M.alternate=null,T.alternate=null,T.flags|=2),M=T.pendingProps;var ee=Ma(T,Oi.current);En(T,B),ee=_y(null,T,j,M,ee,B);var oe=Xp();return T.flags|=1,typeof ee=="object"&&ee!==null&&typeof ee.render=="function"&&ee.$$typeof===void 0?(T.tag=1,T.memoizedState=null,T.updateQueue=null,ta(j)?(oe=!0,Qn(T)):oe=!1,T.memoizedState=ee.state!==null&&ee.state!==void 0?ee.state:null,as(T),ee.updater=nl,T.stateNode=ee,ee._reactInternals=T,O_(T,j,M,B),T=im(null,T,j,!0,oe,B)):(T.tag=0,Br&&oe&&Ud(T),Uo(null,T,ee,B),T=T.child),T;case 16:j=T.elementType;e:{switch(M!==null&&(M.alternate=null,T.alternate=null,T.flags|=2),M=T.pendingProps,ee=j._init,j=ee(j._payload),T.type=j,ee=T.tag=LS(j),M=Ao(j,M),ee){case 0:T=Q_(null,T,j,M,B);break e;case 1:T=ES(null,T,j,M,B);break e;case 11:T=qd(null,T,j,M,B);break e;case 14:T=xS(null,T,j,Ao(j.type,M),B);break e}throw Error(d(306,j,""))}return T;case 0:return j=T.type,ee=T.pendingProps,ee=T.elementType===j?ee:Ao(j,ee),Q_(M,T,j,ee,B);case 1:return j=T.type,ee=T.pendingProps,ee=T.elementType===j?ee:Ao(j,ee),ES(M,T,j,ee,B);case 3:e:{if(ky(T),M===null)throw Error(d(387));j=T.pendingProps,oe=T.memoizedState,ee=oe.element,z_(M,T),Iu(T,j,null,B);var qe=T.memoizedState;if(j=qe.element,pt&&oe.isDehydrated)if(oe={element:j,isDehydrated:!1,cache:qe.cache,transitions:qe.transitions},T.updateQueue.baseState=oe,T.memoizedState=oe,T.flags&256){ee=Error(d(423)),T=Dy(M,T,j,B,ee);break e}else if(j!==ee){ee=Error(d(424)),T=Dy(M,T,j,B,ee);break e}else for(pt&&(ss=ni(T.stateNode.containerInfo),po=T,Br=!0,Ol=null,rl=!1),B=U_(T,null,j,B),T.child=B;B;)B.flags=B.flags&-3|4096,B=B.sibling;else{if(Wd(),j===ee){T=gc(M,T,B);break e}Uo(M,T,j,B)}T=T.child}return T;case 5:return hc(T),M===null&&F_(T),j=T.type,ee=T.pendingProps,oe=M!==null?M.memoizedProps:null,qe=ee.children,Ze(j,ee)?qe=null:oe!==null&&Ze(j,oe)&&(T.flags|=32),SS(M,T),Uo(M,T,qe,B),T.child;case 6:return M===null&&F_(T),null;case 13:return e1(M,T,B);case 4:return gy(T,T.stateNode.containerInfo),j=T.pendingProps,M===null?T.child=ku(T,null,j,B):Uo(M,T,j,B),T.child;case 11:return j=T.type,ee=T.pendingProps,ee=T.elementType===j?ee:Ao(j,ee),qd(M,T,j,ee,B);case 7:return Uo(M,T,T.pendingProps,B),T.child;case 8:return Uo(M,T,T.pendingProps.children,B),T.child;case 12:return Uo(M,T,T.pendingProps.children,B),T.child;case 10:e:{if(j=T.type._context,ee=T.pendingProps,oe=T.memoizedProps,qe=ee.value,Fd(T,j,qe),oe!==null)if(na(oe.value,qe)){if(oe.children===ee.children&&!kr.current){T=gc(M,T,B);break e}}else for(oe=T.child,oe!==null&&(oe.return=T);oe!==null;){var bt=oe.dependencies;if(bt!==null){qe=oe.child;for(var Yt=bt.firstContext;Yt!==null;){if(Yt.context===j){if(oe.tag===1){Yt=os(-1,B&-B),Yt.tag=2;var hn=oe.updateQueue;if(hn!==null){hn=hn.shared;var Cn=hn.pending;Cn===null?Yt.next=Yt:(Yt.next=Cn.next,Cn.next=Yt),hn.pending=Yt}}oe.lanes|=B,Yt=oe.alternate,Yt!==null&&(Yt.lanes|=B),Dr(oe.return,B,T),bt.lanes|=B;break}Yt=Yt.next}}else if(oe.tag===10)qe=oe.type===T.type?null:oe.child;else if(oe.tag===18){if(qe=oe.return,qe===null)throw Error(d(341));qe.lanes|=B,bt=qe.alternate,bt!==null&&(bt.lanes|=B),Dr(qe,B,T),qe=oe.sibling}else qe=oe.child;if(qe!==null)qe.return=oe;else for(qe=oe;qe!==null;){if(qe===T){qe=null;break}if(oe=qe.sibling,oe!==null){oe.return=qe.return,qe=oe;break}qe=qe.return}oe=qe}Uo(M,T,ee.children,B),T=T.child}return T;case 9:return ee=T.type,j=T.pendingProps.children,En(T,B),ee=sa(ee),j=j(ee),T.flags|=1,Uo(M,T,j,B),T.child;case 14:return j=T.type,ee=Ao(j,T.pendingProps),ee=Ao(j.type,ee),xS(M,T,j,ee,B);case 15:return bS(M,T,T.type,T.pendingProps,B);case 17:return j=T.type,ee=T.pendingProps,ee=T.elementType===j?ee:Ao(j,ee),M!==null&&(M.alternate=null,T.alternate=null,T.flags|=2),T.tag=1,ta(j)?(M=!0,Qn(T)):M=!1,En(T,B),nf(T,j,ee),O_(T,j,ee,B),im(null,T,j,!0,M,B);case 19:return Bu(M,T,B);case 22:return wS(M,T,B)}throw Error(d(156,T.tag))};function dr(M,T){return cn(M,T)}function av(M,T,B,j){this.tag=M,this.key=B,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=T,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=j,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function hs(M,T,B,j){return new av(M,T,B,j)}function nh(M){return M=M.prototype,!(!M||!M.isReactComponent)}function LS(M){if(typeof M=="function")return nh(M)?1:0;if(M!=null){if(M=M.$$typeof,M===L)return 11;if(M===z)return 14}return 2}function Xc(M,T){var B=M.alternate;return B===null?(B=hs(M.tag,T,M.key,M.mode),B.elementType=M.elementType,B.type=M.type,B.stateNode=M.stateNode,B.alternate=M,M.alternate=B):(B.pendingProps=T,B.type=M.type,B.flags=0,B.subtreeFlags=0,B.deletions=null),B.flags=M.flags&14680064,B.childLanes=M.childLanes,B.lanes=M.lanes,B.child=M.child,B.memoizedProps=M.memoizedProps,B.memoizedState=M.memoizedState,B.updateQueue=M.updateQueue,T=M.dependencies,B.dependencies=T===null?null:{lanes:T.lanes,firstContext:T.firstContext},B.sibling=M.sibling,B.index=M.index,B.ref=M.ref,B}function ov(M,T,B,j,ee,oe){var qe=2;if(j=M,typeof M=="function")nh(M)&&(qe=1);else if(typeof M=="string")qe=5;else e:switch(M){case _:return ll(B.children,ee,oe,T);case b:qe=8,ee|=8;break;case S:return M=hs(12,B,T,ee|2),M.elementType=S,M.lanes=oe,M;case k:return M=hs(13,B,T,ee),M.elementType=k,M.lanes=oe,M;case R:return M=hs(19,B,T,ee),M.elementType=R,M.lanes=oe,M;case F:return $u(B,ee,oe,T);default:if(typeof M=="object"&&M!==null)switch(M.$$typeof){case A:qe=10;break e;case P:qe=9;break e;case L:qe=11;break e;case z:qe=14;break e;case O:qe=16,j=null;break e}throw Error(d(130,M==null?M:typeof M,""))}return T=hs(qe,B,T,ee),T.elementType=M,T.type=j,T.lanes=oe,T}function ll(M,T,B,j){return M=hs(7,M,j,T),M.lanes=B,M}function $u(M,T,B,j){return M=hs(22,M,j,T),M.elementType=F,M.lanes=B,M.stateNode={},M}function Zt(M,T,B){return M=hs(6,M,null,T),M.lanes=B,M}function xn(M,T,B){return T=hs(4,M.children!==null?M.children:[],M.key,T),T.lanes=B,T.stateNode={containerInfo:M.containerInfo,pendingChildren:null,implementation:M.implementation},T}function Mm(M,T,B,j,ee){this.tag=T,this.containerInfo=M,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=kt,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=zd(0),this.expirationTimes=zd(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=zd(0),this.identifierPrefix=j,this.onRecoverableError=ee,pt&&(this.mutableSourceEagerHydrationData=null)}function Er(M,T,B,j,ee,oe,qe,bt,Yt){return M=new Mm(M,T,B,bt,Yt),T===1?(T=1,oe===!0&&(T|=8)):T=0,oe=hs(3,null,null,T),M.current=oe,oe.stateNode=M,oe.memoizedState={element:j,isDehydrated:B,cache:null,transitions:null},as(oe),M}function Ko(M){if(!M)return fo;M=M._reactInternals;e:{if(G(M)!==M||M.tag!==1)throw Error(d(170));var T=M;do{switch(T.tag){case 3:T=T.stateNode.context;break e;case 1:if(ta(T.type)){T=T.stateNode.__reactInternalMemoizedMergedChildContext;break e}}T=T.return}while(T!==null);throw Error(d(171))}if(M.tag===1){var B=M.type;if(ta(B))return Pn(M,B,T)}return T}function sv(M){var T=M._reactInternals;if(T===void 0)throw typeof M.render=="function"?Error(d(188)):(M=Object.keys(M).join(","),Error(d(268,M)));return M=pe(T),M===null?null:M.stateNode}function c1(M,T){if(M=M.memoizedState,M!==null&&M.dehydrated!==null){var B=M.retryLane;M.retryLane=B!==0&&B<T?B:T}}function Jo(M,T){c1(M,T),(M=M.alternate)&&c1(M,T)}function FC(M){return M=pe(M),M===null?null:M.stateNode}function BC(){return null}return i.attemptContinuousHydration=function(M){if(M.tag===13){var T=yo();eo(M,134217728,T),Jo(M,134217728)}},i.attemptHydrationAtCurrentPriority=function(M){if(M.tag===13){var T=yo(),B=ju(M);eo(M,B,T),Jo(M,B)}},i.attemptSynchronousHydration=function(M){switch(M.tag){case 3:var T=M.stateNode;if(T.current.memoizedState.isDehydrated){var B=Ll(T.pendingLanes);B!==0&&(bn(T,B|1),to(T,ur()),!(Fi&6)&&(_f(),Fr()))}break;case 13:var j=yo();gn(function(){return eo(M,1,j)}),Jo(M,1)}},i.batchedUpdates=function(M,T){var B=Fi;Fi|=1;try{return M(T)}finally{Fi=B,Fi===0&&(_f(),li&&Fr())}},i.createComponentSelector=function(M){return{$$typeof:pm,value:M}},i.createContainer=function(M,T,B,j,ee,oe,qe){return Er(M,T,!1,null,B,j,ee,oe,qe)},i.createHasPseudoClassSelector=function(M){return{$$typeof:$c,value:M}},i.createHydrationContainer=function(M,T,B,j,ee,oe,qe,bt,Yt){return M=Er(B,j,!0,M,ee,oe,qe,bt,Yt),M.context=Ko(null),B=M.current,j=yo(),ee=ju(B),oe=os(j,ee),oe.callback=T??null,zr(B,oe),M.current.lanes=ee,Js(M,ee,j),to(M,j),M},i.createPortal=function(M,T,B){var j=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:y,key:j==null?null:""+j,children:M,containerInfo:T,implementation:B}},i.createRoleSelector=function(M){return{$$typeof:Gy,value:M}},i.createTestNameSelector=function(M){return{$$typeof:Hy,value:M}},i.createTextSelector=function(M){return{$$typeof:mm,value:M}},i.deferredUpdates=function(M){var T=Vn,B=ya.transition;try{return ya.transition=null,Vn=16,M()}finally{Vn=T,ya.transition=B}},i.discreteUpdates=function(M,T,B,j,ee){var oe=Vn,qe=ya.transition;try{return ya.transition=null,Vn=1,M(T,B,j,ee)}finally{Vn=oe,ya.transition=qe,Fi===0&&_f()}},i.findAllNodes=vm,i.findBoundingRects=function(M,T){if(!Ye)throw Error(d(363));T=vm(M,T),M=[];for(var B=0;B<T.length;B++)M.push(st(T[B]));for(T=M.length-1;0<T;T--){B=M[T];for(var j=B.x,ee=j+B.width,oe=B.y,qe=oe+B.height,bt=T-1;0<=bt;bt--)if(T!==bt){var Yt=M[bt],hn=Yt.x,Cn=hn+Yt.width,Ti=Yt.y,ii=Ti+Yt.height;if(j>=hn&&oe>=Ti&&ee<=Cn&&qe<=ii){M.splice(T,1);break}else if(j!==hn||B.width!==Yt.width||ii<oe||Ti>qe){if(!(oe!==Ti||B.height!==Yt.height||Cn<j||hn>ee)){hn>j&&(Yt.width+=hn-j,Yt.x=j),Cn<ee&&(Yt.width=ee-hn),M.splice(T,1);break}}else{Ti>oe&&(Yt.height+=Ti-oe,Yt.y=oe),ii<qe&&(Yt.height=qe-Ti),M.splice(T,1);break}}}return M},i.findHostInstance=sv,i.findHostInstanceWithNoPortals=function(M){return M=he(M),M=M!==null?fe(M):null,M===null?null:M.stateNode},i.findHostInstanceWithWarning=function(M){return sv(M)},i.flushControlled=function(M){var T=Fi;Fi|=1;var B=ya.transition,j=Vn;try{ya.transition=null,Vn=1,M()}finally{Vn=j,ya.transition=B,Fi=T,Fi===0&&(_f(),Fr())}},i.flushPassiveEffects=Va,i.flushSync=gn,i.focusWithin=function(M,T){if(!Ye)throw Error(d(363));for(M=gm(M),T=ym(M,T),T=Array.from(T),M=0;M<T.length;){var B=T[M++];if(!ie(B)){if(B.tag===5&&ut(B.stateNode))return!0;for(B=B.child;B!==null;)T.push(B),B=B.sibling}}return!1},i.getCurrentUpdatePriority=function(){return Vn},i.getFindAllNodesFailureDescription=function(M,T){if(!Ye)throw Error(d(363));var B=0,j=[];M=[gm(M),0];for(var ee=0;ee<M.length;){var oe=M[ee++],qe=M[ee++],bt=T[qe];if((oe.tag!==5||!ie(oe))&&(jy(oe,bt)&&(j.push($y(bt)),qe++,qe>B&&(B=qe)),qe<T.length))for(oe=oe.child;oe!==null;)M.push(oe,qe),oe=oe.sibling}if(B<T.length){for(M=[];B<T.length;B++)M.push($y(T[B]));return`findAllNodes was able to match part of the selector:
  `+(j.join(" > ")+`

No matching component was found for:
  `)+M.join(" > ")}return null},i.getPublicRootInstance=function(M){if(M=M.current,!M.child)return null;switch(M.child.tag){case 5:return Re(M.child.stateNode);default:return M.child.stateNode}},i.injectIntoDevTools=function(M){if(M={bundleType:M.bundleType,version:M.version,rendererPackageName:M.rendererPackageName,rendererConfig:M.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:f.ReactCurrentDispatcher,findHostInstanceByFiber:FC,findFiberByHostInstance:M.findFiberByHostInstance||BC,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.0.0-fc46dba67-20220329"},typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")M=!1;else{var T=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(T.isDisabled||!T.supportsFiber)M=!0;else{try{el=T.inject(M),an=T}catch{}M=!!T.checkDCE}}return M},i.isAlreadyRendering=function(){return!1},i.observeVisibleRects=function(M,T,B,j){if(!Ye)throw Error(d(363));M=vm(M,T);var ee=it(M,B,j).disconnect;return{disconnect:function(){ee()}}},i.registerMutableSourceForHydration=function(M,T){var B=T._getVersion;B=B(T._source),M.mutableSourceEagerHydrationData==null?M.mutableSourceEagerHydrationData=[T,B]:M.mutableSourceEagerHydrationData.push(T,B)},i.runWithPriority=function(M,T){var B=Vn;try{return Vn=M,T()}finally{Vn=B}},i.shouldError=function(){return null},i.shouldSuspend=function(){return!1},i.updateContainer=function(M,T,B,j){var ee=T.current,oe=yo(),qe=ju(ee);return B=Ko(B),T.context===null?T.context=B:T.pendingContext=B,T=os(oe,qe),T.payload={element:M},j=j===void 0?null:j,j!==null&&(T.callback=j),zr(ee,T),M=eo(ee,qe,oe),M!==null&&Pu(M,ee,qe),qe},i};BK.exports=tTe;var nTe=BK.exports;const iTe=Nw(nTe);var UK={exports:{}},WK={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(n){function e(le,me){var we=le.length;le.push(me);e:for(;0<we;){var re=we-1>>>1,Te=le[re];if(0<s(Te,me))le[re]=me,le[we]=Te,we=re;else break e}}function i(le){return le.length===0?null:le[0]}function a(le){if(le.length===0)return null;var me=le[0],we=le.pop();if(we!==me){le[0]=we;e:for(var re=0,Te=le.length,Je=Te>>>1;re<Je;){var Xe=2*(re+1)-1,Ze=le[Xe],Fe=Xe+1,ct=le[Fe];if(0>s(Ze,we))Fe<Te&&0>s(ct,Ze)?(le[re]=ct,le[Fe]=we,re=Fe):(le[re]=Ze,le[Xe]=we,re=Xe);else if(Fe<Te&&0>s(ct,we))le[re]=ct,le[Fe]=we,re=Fe;else break e}}return me}function s(le,me){var we=le.sortIndex-me.sortIndex;return we!==0?we:le.id-me.id}if(typeof performance=="object"&&typeof performance.now=="function"){var l=performance;n.unstable_now=function(){return l.now()}}else{var d=Date,f=d.now();n.unstable_now=function(){return d.now()-f}}var p=[],y=[],_=1,b=null,S=3,A=!1,P=!1,L=!1,k=typeof setTimeout=="function"?setTimeout:null,R=typeof clearTimeout=="function"?clearTimeout:null,z=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function O(le){for(var me=i(y);me!==null;){if(me.callback===null)a(y);else if(me.startTime<=le)a(y),me.sortIndex=me.expirationTime,e(p,me);else break;me=i(y)}}function F(le){if(L=!1,O(le),!P)if(i(p)!==null)P=!0,Re(H);else{var me=i(y);me!==null&&Be(F,me.startTime-le)}}function H(le,me){P=!1,L&&(L=!1,R(te),te=-1),A=!0;var we=S;try{for(O(me),b=i(p);b!==null&&(!(b.expirationTime>me)||le&&!he());){var re=b.callback;if(typeof re=="function"){b.callback=null,S=b.priorityLevel;var Te=re(b.expirationTime<=me);me=n.unstable_now(),typeof Te=="function"?b.callback=Te:b===i(p)&&a(p),O(me)}else a(p);b=i(p)}if(b!==null)var Je=!0;else{var Xe=i(y);Xe!==null&&Be(F,Xe.startTime-me),Je=!1}return Je}finally{b=null,S=we,A=!1}}var $=!1,Y=null,te=-1,G=5,Q=-1;function he(){return!(n.unstable_now()-Q<G)}function pe(){if(Y!==null){var le=n.unstable_now();Q=le;var me=!0;try{me=Y(!0,le)}finally{me?ye():($=!1,Y=null)}}else $=!1}var ye;if(typeof z=="function")ye=function(){z(pe)};else if(typeof MessageChannel<"u"){var fe=new MessageChannel,Ae=fe.port2;fe.port1.onmessage=pe,ye=function(){Ae.postMessage(null)}}else ye=function(){k(pe,0)};function Re(le){Y=le,$||($=!0,ye())}function Be(le,me){te=k(function(){le(n.unstable_now())},me)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(le){le.callback=null},n.unstable_continueExecution=function(){P||A||(P=!0,Re(H))},n.unstable_forceFrameRate=function(le){0>le||125<le?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):G=0<le?Math.floor(1e3/le):5},n.unstable_getCurrentPriorityLevel=function(){return S},n.unstable_getFirstCallbackNode=function(){return i(p)},n.unstable_next=function(le){switch(S){case 1:case 2:case 3:var me=3;break;default:me=S}var we=S;S=me;try{return le()}finally{S=we}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(le,me){switch(le){case 1:case 2:case 3:case 4:case 5:break;default:le=3}var we=S;S=le;try{return me()}finally{S=we}},n.unstable_scheduleCallback=function(le,me,we){var re=n.unstable_now();switch(typeof we=="object"&&we!==null?(we=we.delay,we=typeof we=="number"&&0<we?re+we:re):we=re,le){case 1:var Te=-1;break;case 2:Te=250;break;case 5:Te=1073741823;break;case 4:Te=1e4;break;default:Te=5e3}return Te=we+Te,le={id:_++,callback:me,priorityLevel:le,startTime:we,expirationTime:Te,sortIndex:-1},we>re?(le.sortIndex=we,e(y,le),i(p)===null&&le===i(y)&&(L?(R(te),te=-1):L=!0,Be(F,we-re))):(le.sortIndex=Te,e(p,le),P||A||(P=!0,Re(H))),le},n.unstable_shouldYield=he,n.unstable_wrapCallback=function(le){var me=S;return function(){var we=S;S=me;try{return le.apply(this,arguments)}finally{S=we}}}})(WK);UK.exports=WK;var fG=UK.exports;const rTe=n=>typeof n=="object"&&typeof n.then=="function",Sg=[];function VK(n,e,i=(a,s)=>a===s){if(n===e)return!0;if(!n||!e)return!1;const a=n.length;if(e.length!==a)return!1;for(let s=0;s<a;s++)if(!i(n[s],e[s]))return!1;return!0}function GK(n,e=null,i=!1,a={}){e===null&&(e=[n]);for(const l of Sg)if(VK(e,l.keys,l.equal)){if(i)return;if(Object.prototype.hasOwnProperty.call(l,"error"))throw l.error;if(Object.prototype.hasOwnProperty.call(l,"response"))return a.lifespan&&a.lifespan>0&&(l.timeout&&clearTimeout(l.timeout),l.timeout=setTimeout(l.remove,a.lifespan)),l.response;if(!i)throw l.promise}const s={keys:e,equal:a.equal,remove:()=>{const l=Sg.indexOf(s);l!==-1&&Sg.splice(l,1)},promise:(rTe(n)?n:n(...e)).then(l=>{s.response=l,a.lifespan&&a.lifespan>0&&(s.timeout=setTimeout(s.remove,a.lifespan))}).catch(l=>s.error=l)};if(Sg.push(s),!i)throw s.promise}const HK=(n,e,i)=>GK(n,e,!1,i),aTe=(n,e,i)=>void GK(n,e,!0,i),oTe=n=>{if(n===void 0||n.length===0)Sg.splice(0,Sg.length);else{const e=Sg.find(i=>VK(n,i.keys,i.equal));e&&e.remove()}},Zz={},sTe=n=>void Object.assign(Zz,n);function lTe(n,e){function i(_,{args:b=[],attach:S,...A},P){let L=`${_[0].toUpperCase()}${_.slice(1)}`,k;if(_==="primitive"){if(A.object===void 0)throw new Error("R3F: Primitives without 'object' are invalid!");const R=A.object;k=_0(R,{type:_,root:P,attach:S,primitive:!0})}else{const R=Zz[L];if(!R)throw new Error(`R3F: ${L} is not part of the THREE namespace! Did you forget to extend? See: https://docs.pmnd.rs/react-three-fiber/api/objects#using-3rd-party-objects-declaratively`);if(!Array.isArray(b))throw new Error("R3F: The args prop must be an array!");k=_0(new R(...b),{type:_,root:P,attach:S,memoizedProps:{args:b}})}return k.__r3f.attach===void 0&&(k instanceof zi?k.__r3f.attach="geometry":k instanceof rs&&(k.__r3f.attach="material")),L!=="inject"&&bL(k,A),k}function a(_,b){let S=!1;if(b){var A,P;(A=b.__r3f)!=null&&A.attach?xL(_,b,b.__r3f.attach):b.isObject3D&&_.isObject3D&&(_.add(b),S=!0),S||(P=_.__r3f)==null||P.objects.push(b),b.__r3f||_0(b,{}),b.__r3f.parent=_,J5(b),x0(b)}}function s(_,b,S){let A=!1;if(b){var P,L;if((P=b.__r3f)!=null&&P.attach)xL(_,b,b.__r3f.attach);else if(b.isObject3D&&_.isObject3D){b.parent=_,b.dispatchEvent({type:"added"});const k=_.children.filter(z=>z!==b),R=k.indexOf(S);_.children=[...k.slice(0,R),b,...k.slice(R)],A=!0}A||(L=_.__r3f)==null||L.objects.push(b),b.__r3f||_0(b,{}),b.__r3f.parent=_,J5(b),x0(b)}}function l(_,b,S=!1){_&&[..._].forEach(A=>d(b,A,S))}function d(_,b,S){if(b){var A,P,L;if(b.__r3f&&(b.__r3f.parent=null),(A=_.__r3f)!=null&&A.objects&&(_.__r3f.objects=_.__r3f.objects.filter(F=>F!==b)),(P=b.__r3f)!=null&&P.attach)vG(_,b,b.__r3f.attach);else if(b.isObject3D&&_.isObject3D){var k;_.remove(b),(k=b.__r3f)!=null&&k.root&&yTe(b.__r3f.root,b)}const z=(L=b.__r3f)==null?void 0:L.primitive,O=!z&&(S===void 0?b.dispose!==null:S);if(!z){var R;l((R=b.__r3f)==null?void 0:R.objects,b,O),l(b.children,b,O)}delete b.__r3f,O&&b.dispose&&b.type!=="Scene"&&fG.unstable_scheduleCallback(fG.unstable_IdlePriority,()=>{try{b.dispose()}catch{}}),x0(_)}}function f(_,b,S,A){var P;const L=(P=_.__r3f)==null?void 0:P.parent;if(!L)return;const k=i(b,S,_.__r3f.root);if(_.children){for(const R of _.children)R.__r3f&&a(k,R);_.children=_.children.filter(R=>!R.__r3f)}_.__r3f.objects.forEach(R=>a(k,R)),_.__r3f.objects=[],_.__r3f.autoRemovedBeforeAppend||d(L,_),k.parent&&(k.__r3f.autoRemovedBeforeAppend=!0),a(L,k),k.raycast&&k.__r3f.eventCount&&k.__r3f.root.getState().internal.interaction.push(k),[A,A.alternate].forEach(R=>{R!==null&&(R.stateNode=k,R.ref&&(typeof R.ref=="function"?R.ref(k):R.ref.current=k))})}const p=()=>console.warn("Text is not allowed in the R3F tree! This could be stray whitespace or characters.");return{reconciler:iTe({createInstance:i,removeChild:d,appendChild:a,appendInitialChild:a,insertBefore:s,supportsMutation:!0,isPrimaryRenderer:!1,supportsPersistence:!1,supportsHydration:!1,noTimeout:-1,appendChildToContainer:(_,b)=>{if(!b)return;const S=_.getState().scene;S.__r3f&&(S.__r3f.root=_,a(S,b))},removeChildFromContainer:(_,b)=>{b&&d(_.getState().scene,b)},insertInContainerBefore:(_,b,S)=>{if(!b||!S)return;const A=_.getState().scene;A.__r3f&&s(A,b,S)},getRootHostContext:()=>null,getChildHostContext:_=>_,finalizeInitialChildren(_){var b;return!!((b=_==null?void 0:_.__r3f)!=null?b:{}).handlers},prepareUpdate(_,b,S,A){var P;if(((P=_==null?void 0:_.__r3f)!=null?P:{}).primitive&&A.object&&A.object!==_)return[!0];{const{args:k=[],children:R,...z}=A,{args:O=[],children:F,...H}=S;if(!Array.isArray(k))throw new Error("R3F: the args prop must be an array!");if(k.some((Y,te)=>Y!==O[te]))return[!0];const $=KK(_,z,H,!0);return $.changes.length?[!1,$]:null}},commitUpdate(_,[b,S],A,P,L,k){b?f(_,A,L,k):bL(_,S)},commitMount(_,b,S,A){var P;const L=(P=_.__r3f)!=null?P:{};_.raycast&&L.handlers&&L.eventCount&&_.__r3f.root.getState().internal.interaction.push(_)},getPublicInstance:_=>_,prepareForCommit:()=>null,preparePortalMount:_=>_0(_.getState().scene),resetAfterCommit:()=>{},shouldSetTextContent:()=>!1,clearContainer:()=>!1,hideInstance(_){var b;const{attach:S,parent:A}=(b=_.__r3f)!=null?b:{};S&&A&&vG(A,_,S),_.isObject3D&&(_.visible=!1),x0(_)},unhideInstance(_,b){var S;const{attach:A,parent:P}=(S=_.__r3f)!=null?S:{};A&&P&&xL(P,_,A),(_.isObject3D&&b.visible==null||b.visible)&&(_.visible=!0),x0(_)},createTextInstance:p,hideTextInstance:p,unhideTextInstance:p,getCurrentEventPriority:()=>e?e():B0.DefaultEventPriority,beforeActiveInstanceBlur:()=>{},afterActiveInstanceBlur:()=>{},detachDeletedInstance:()=>{},now:typeof performance<"u"&&da.fun(performance.now)?performance.now:da.fun(Date.now)?Date.now:()=>0,scheduleTimeout:da.fun(setTimeout)?setTimeout:void 0,cancelTimeout:da.fun(clearTimeout)?clearTimeout:void 0}),applyProps:bL}}var pG,mG;const _L=n=>"colorSpace"in n||"outputColorSpace"in n,jK=()=>{var n;return(n=Zz.ColorManagement)!=null?n:null},$K=n=>n&&n.isOrthographicCamera,cTe=n=>n&&n.hasOwnProperty("current"),lS=typeof window<"u"&&((pG=window.document)!=null&&pG.createElement||((mG=window.navigator)==null?void 0:mG.product)==="ReactNative")?ne.useLayoutEffect:ne.useEffect;function YK(n){const e=ne.useRef(n);return lS(()=>void(e.current=n),[n]),e}function uTe({set:n}){return lS(()=>(n(new Promise(()=>null)),()=>n(!1)),[n]),null}class qK extends ne.Component{constructor(...e){super(...e),this.state={error:!1}}componentDidCatch(e){this.props.set(e)}render(){return this.state.error?null:this.props.children}}qK.getDerivedStateFromError=()=>({error:!0});const XK="__default",gG=new Map,dTe=n=>n&&!!n.memoized&&!!n.changes;function ZK(n){var e;const i=typeof window<"u"?(e=window.devicePixelRatio)!=null?e:2:1;return Array.isArray(n)?Math.min(Math.max(n[0],i),n[1]):n}const Rx=n=>{var e;return(e=n.__r3f)==null?void 0:e.root.getState()},da={obj:n=>n===Object(n)&&!da.arr(n)&&typeof n!="function",fun:n=>typeof n=="function",str:n=>typeof n=="string",num:n=>typeof n=="number",boo:n=>typeof n=="boolean",und:n=>n===void 0,arr:n=>Array.isArray(n),equ(n,e,{arrays:i="shallow",objects:a="reference",strict:s=!0}={}){if(typeof n!=typeof e||!!n!=!!e)return!1;if(da.str(n)||da.num(n))return n===e;const l=da.obj(n);if(l&&a==="reference")return n===e;const d=da.arr(n);if(d&&i==="reference")return n===e;if((d||l)&&n===e)return!0;let f;for(f in n)if(!(f in e))return!1;if(l&&i==="shallow"&&a==="shallow"){for(f in s?e:n)if(!da.equ(n[f],e[f],{strict:s,objects:"reference"}))return!1}else for(f in s?e:n)if(n[f]!==e[f])return!1;if(da.und(f)){if(d&&n.length===0&&e.length===0||l&&Object.keys(n).length===0&&Object.keys(e).length===0)return!0;if(n!==e)return!1}return!0}};function hTe(n){const e={nodes:{},materials:{}};return n&&n.traverse(i=>{i.name&&(e.nodes[i.name]=i),i.material&&!e.materials[i.material.name]&&(e.materials[i.material.name]=i.material)}),e}function fTe(n){n.dispose&&n.type!=="Scene"&&n.dispose();for(const e in n)e.dispose==null||e.dispose(),delete n[e]}function _0(n,e){const i=n;return i.__r3f={type:"",root:null,previousAttach:null,memoizedProps:{},eventCount:0,handlers:{},objects:[],parent:null,...e},n}function K5(n,e){let i=n;if(e.includes("-")){const a=e.split("-"),s=a.pop();return i=a.reduce((l,d)=>l[d],n),{target:i,key:s}}else return{target:i,key:e}}const yG=/-\d+$/;function xL(n,e,i){if(da.str(i)){if(yG.test(i)){const l=i.replace(yG,""),{target:d,key:f}=K5(n,l);Array.isArray(d[f])||(d[f]=[])}const{target:a,key:s}=K5(n,i);e.__r3f.previousAttach=a[s],a[s]=e}else e.__r3f.previousAttach=i(n,e)}function vG(n,e,i){var a,s;if(da.str(i)){const{target:l,key:d}=K5(n,i),f=e.__r3f.previousAttach;f===void 0?delete l[d]:l[d]=f}else(a=e.__r3f)==null||a.previousAttach==null||a.previousAttach(n,e);(s=e.__r3f)==null||delete s.previousAttach}function KK(n,{children:e,key:i,ref:a,...s},{children:l,key:d,ref:f,...p}={},y=!1){var _;const b=(_=n==null?void 0:n.__r3f)!=null?_:{},S=Object.entries(s),A=[];if(y){const L=Object.keys(p);for(let k=0;k<L.length;k++)s.hasOwnProperty(L[k])||S.unshift([L[k],XK+"remove"])}S.forEach(([L,k])=>{var R;if((R=n.__r3f)!=null&&R.primitive&&L==="object"||da.equ(k,p[L]))return;if(/^on(Pointer|Click|DoubleClick|ContextMenu|Wheel)/.test(L))return A.push([L,k,!0,[]]);let z=[];L.includes("-")&&(z=L.split("-")),A.push([L,k,!1,z]);for(const O in s){const F=s[O];O.startsWith(`${L}-`)&&A.push([O,F,!1,O.split("-")])}});const P={...s};return b.memoizedProps&&b.memoizedProps.args&&(P.args=b.memoizedProps.args),b.memoizedProps&&b.memoizedProps.attach&&(P.attach=b.memoizedProps.attach),{memoized:P,changes:A}}const pTe=typeof process<"u"&&!1;function bL(n,e){var i,a,s;const l=(i=n.__r3f)!=null?i:{},d=l.root,f=(a=d==null||d.getState==null?void 0:d.getState())!=null?a:{},{memoized:p,changes:y}=dTe(e)?e:KK(n,e),_=l.eventCount;n.__r3f&&(n.__r3f.memoizedProps=p);for(let S=0;S<y.length;S++){let[A,P,L,k]=y[S];if(_L(n)){const F="srgb",H="srgb-linear";A==="encoding"?(A="colorSpace",P=P===3001?F:H):A==="outputEncoding"&&(A="outputColorSpace",P=P===3001?F:H)}let R=n,z=R[A];if(k.length&&(z=k.reduce((O,F)=>O[F],n),!(z&&z.set))){const[O,...F]=k.reverse();R=F.reverse().reduce((H,$)=>H[$],n),A=O}if(P===XK+"remove")if(R.constructor){let O=gG.get(R.constructor);O||(O=new R.constructor,gG.set(R.constructor,O)),P=O[A]}else P=0;if(L)P?l.handlers[A]=P:delete l.handlers[A],l.eventCount=Object.keys(l.handlers).length;else if(z&&z.set&&(z.copy||z instanceof Rg)){if(Array.isArray(P))z.fromArray?z.fromArray(P):z.set(...P);else if(z.copy&&P&&P.constructor&&(pTe?z.constructor.name===P.constructor.name:z.constructor===P.constructor))z.copy(P);else if(P!==void 0){const O=z instanceof In;!O&&z.setScalar?z.setScalar(P):z instanceof Rg&&P instanceof Rg?z.mask=P.mask:z.set(P),!jK()&&!f.linear&&O&&z.convertSRGBToLinear()}}else if(R[A]=P,R[A]instanceof Oa&&R[A].format===vl&&R[A].type===wd){const O=R[A];_L(O)&&_L(f.gl)?O.colorSpace=f.gl.outputColorSpace:O.encoding=f.gl.outputEncoding}x0(n)}if(l.parent&&f.internal&&n.raycast&&_!==l.eventCount){const S=f.internal.interaction.indexOf(n);S>-1&&f.internal.interaction.splice(S,1),l.eventCount&&f.internal.interaction.push(n)}return!(y.length===1&&y[0][0]==="onUpdate")&&y.length&&(s=n.__r3f)!=null&&s.parent&&J5(n),n}function x0(n){var e,i;const a=(e=n.__r3f)==null||(i=e.root)==null||i.getState==null?void 0:i.getState();a&&a.internal.frames===0&&a.invalidate()}function J5(n){n.onUpdate==null||n.onUpdate(n)}function mTe(n,e){n.manual||($K(n)?(n.left=e.width/-2,n.right=e.width/2,n.top=e.height/2,n.bottom=e.height/-2):n.aspect=e.width/e.height,n.updateProjectionMatrix(),n.updateMatrixWorld())}function bE(n){return(n.eventObject||n.object).uuid+"/"+n.index+n.instanceId}function gTe(){var n;const e=typeof self<"u"&&self||typeof window<"u"&&window;if(!e)return B0.DefaultEventPriority;switch((n=e.event)==null?void 0:n.type){case"click":case"contextmenu":case"dblclick":case"pointercancel":case"pointerdown":case"pointerup":return B0.DiscreteEventPriority;case"pointermove":case"pointerout":case"pointerover":case"pointerenter":case"pointerleave":case"wheel":return B0.ContinuousEventPriority;default:return B0.DefaultEventPriority}}function JK(n,e,i,a){const s=i.get(e);s&&(i.delete(e),i.size===0&&(n.delete(a),s.target.releasePointerCapture(a)))}function yTe(n,e){const{internal:i}=n.getState();i.interaction=i.interaction.filter(a=>a!==e),i.initialHits=i.initialHits.filter(a=>a!==e),i.hovered.forEach((a,s)=>{(a.eventObject===e||a.object===e)&&i.hovered.delete(s)}),i.capturedMap.forEach((a,s)=>{JK(i.capturedMap,e,a,s)})}function vTe(n){function e(p){const{internal:y}=n.getState(),_=p.offsetX-y.initialClick[0],b=p.offsetY-y.initialClick[1];return Math.round(Math.sqrt(_*_+b*b))}function i(p){return p.filter(y=>["Move","Over","Enter","Out","Leave"].some(_=>{var b;return(b=y.__r3f)==null?void 0:b.handlers["onPointer"+_]}))}function a(p,y){const _=n.getState(),b=new Set,S=[],A=y?y(_.internal.interaction):_.internal.interaction;for(let R=0;R<A.length;R++){const z=Rx(A[R]);z&&(z.raycaster.camera=void 0)}_.previousRoot||_.events.compute==null||_.events.compute(p,_);function P(R){const z=Rx(R);if(!z||!z.events.enabled||z.raycaster.camera===null)return[];if(z.raycaster.camera===void 0){var O;z.events.compute==null||z.events.compute(p,z,(O=z.previousRoot)==null?void 0:O.getState()),z.raycaster.camera===void 0&&(z.raycaster.camera=null)}return z.raycaster.camera?z.raycaster.intersectObject(R,!0):[]}let L=A.flatMap(P).sort((R,z)=>{const O=Rx(R.object),F=Rx(z.object);return!O||!F?R.distance-z.distance:F.events.priority-O.events.priority||R.distance-z.distance}).filter(R=>{const z=bE(R);return b.has(z)?!1:(b.add(z),!0)});_.events.filter&&(L=_.events.filter(L,_));for(const R of L){let z=R.object;for(;z;){var k;(k=z.__r3f)!=null&&k.eventCount&&S.push({...R,eventObject:z}),z=z.parent}}if("pointerId"in p&&_.internal.capturedMap.has(p.pointerId))for(let R of _.internal.capturedMap.get(p.pointerId).values())b.has(bE(R.intersection))||S.push(R.intersection);return S}function s(p,y,_,b){const S=n.getState();if(p.length){const A={stopped:!1};for(const P of p){const L=Rx(P.object)||S,{raycaster:k,pointer:R,camera:z,internal:O}=L,F=new We(R.x,R.y,0).unproject(z),H=Q=>{var he,pe;return(he=(pe=O.capturedMap.get(Q))==null?void 0:pe.has(P.eventObject))!=null?he:!1},$=Q=>{const he={intersection:P,target:y.target};O.capturedMap.has(Q)?O.capturedMap.get(Q).set(P.eventObject,he):O.capturedMap.set(Q,new Map([[P.eventObject,he]])),y.target.setPointerCapture(Q)},Y=Q=>{const he=O.capturedMap.get(Q);he&&JK(O.capturedMap,P.eventObject,he,Q)};let te={};for(let Q in y){let he=y[Q];typeof he!="function"&&(te[Q]=he)}let G={...P,...te,pointer:R,intersections:p,stopped:A.stopped,delta:_,unprojectedPoint:F,ray:k.ray,camera:z,stopPropagation(){const Q="pointerId"in y&&O.capturedMap.get(y.pointerId);if((!Q||Q.has(P.eventObject))&&(G.stopped=A.stopped=!0,O.hovered.size&&Array.from(O.hovered.values()).find(he=>he.eventObject===P.eventObject))){const he=p.slice(0,p.indexOf(P));l([...he,P])}},target:{hasPointerCapture:H,setPointerCapture:$,releasePointerCapture:Y},currentTarget:{hasPointerCapture:H,setPointerCapture:$,releasePointerCapture:Y},nativeEvent:y};if(b(G),A.stopped===!0)break}}return p}function l(p){const{internal:y}=n.getState();for(const _ of y.hovered.values())if(!p.length||!p.find(b=>b.object===_.object&&b.index===_.index&&b.instanceId===_.instanceId)){const S=_.eventObject.__r3f,A=S==null?void 0:S.handlers;if(y.hovered.delete(bE(_)),S!=null&&S.eventCount){const P={..._,intersections:p};A.onPointerOut==null||A.onPointerOut(P),A.onPointerLeave==null||A.onPointerLeave(P)}}}function d(p,y){for(let _=0;_<y.length;_++){const b=y[_].__r3f;b==null||b.handlers.onPointerMissed==null||b.handlers.onPointerMissed(p)}}function f(p){switch(p){case"onPointerLeave":case"onPointerCancel":return()=>l([]);case"onLostPointerCapture":return y=>{const{internal:_}=n.getState();"pointerId"in y&&_.capturedMap.has(y.pointerId)&&requestAnimationFrame(()=>{_.capturedMap.has(y.pointerId)&&(_.capturedMap.delete(y.pointerId),l([]))})}}return function(_){const{onPointerMissed:b,internal:S}=n.getState();S.lastEvent.current=_;const A=p==="onPointerMove",P=p==="onClick"||p==="onContextMenu"||p==="onDoubleClick",k=a(_,A?i:void 0),R=P?e(_):0;p==="onPointerDown"&&(S.initialClick=[_.offsetX,_.offsetY],S.initialHits=k.map(O=>O.eventObject)),P&&!k.length&&R<=2&&(d(_,S.interaction),b&&b(_)),A&&l(k);function z(O){const F=O.eventObject,H=F.__r3f,$=H==null?void 0:H.handlers;if(H!=null&&H.eventCount)if(A){if($.onPointerOver||$.onPointerEnter||$.onPointerOut||$.onPointerLeave){const Y=bE(O),te=S.hovered.get(Y);te?te.stopped&&O.stopPropagation():(S.hovered.set(Y,O),$.onPointerOver==null||$.onPointerOver(O),$.onPointerEnter==null||$.onPointerEnter(O))}$.onPointerMove==null||$.onPointerMove(O)}else{const Y=$[p];Y?(!P||S.initialHits.includes(F))&&(d(_,S.interaction.filter(te=>!S.initialHits.includes(te))),Y(O)):P&&S.initialHits.includes(F)&&d(_,S.interaction.filter(te=>!S.initialHits.includes(te)))}}s(k,_,R,z)}}return{handlePointer:f}}const QK=n=>!!(n!=null&&n.render),eJ=ne.createContext(null),_Te=(n,e)=>{const i=JMe((f,p)=>{const y=new We,_=new We,b=new We;function S(R=p().camera,z=_,O=p().size){const{width:F,height:H,top:$,left:Y}=O,te=F/H;z instanceof We?b.copy(z):b.set(...z);const G=R.getWorldPosition(y).distanceTo(b);if($K(R))return{width:F/R.zoom,height:H/R.zoom,top:$,left:Y,factor:1,distance:G,aspect:te};{const Q=R.fov*Math.PI/180,he=2*Math.tan(Q/2)*G,pe=he*(F/H);return{width:pe,height:he,top:$,left:Y,factor:F/pe,distance:G,aspect:te}}}let A;const P=R=>f(z=>({performance:{...z.performance,current:R}})),L=new tn;return{set:f,get:p,gl:null,camera:null,raycaster:null,events:{priority:1,enabled:!0,connected:!1},xr:null,scene:null,invalidate:(R=1)=>n(p(),R),advance:(R,z)=>e(R,z,p()),legacy:!1,linear:!1,flat:!1,controls:null,clock:new $z,pointer:L,mouse:L,frameloop:"always",onPointerMissed:void 0,performance:{current:1,min:.5,max:1,debounce:200,regress:()=>{const R=p();A&&clearTimeout(A),R.performance.current!==R.performance.min&&P(R.performance.min),A=setTimeout(()=>P(p().performance.max),R.performance.debounce)}},size:{width:0,height:0,top:0,left:0,updateStyle:!1},viewport:{initialDpr:0,dpr:0,width:0,height:0,top:0,left:0,aspect:0,distance:0,factor:0,getCurrentViewport:S},setEvents:R=>f(z=>({...z,events:{...z.events,...R}})),setSize:(R,z,O,F,H)=>{const $=p().camera,Y={width:R,height:z,top:F||0,left:H||0,updateStyle:O};f(te=>({size:Y,viewport:{...te.viewport,...S($,_,Y)}}))},setDpr:R=>f(z=>{const O=ZK(R);return{viewport:{...z.viewport,dpr:O,initialDpr:z.viewport.initialDpr||O}}}),setFrameloop:(R="always")=>{const z=p().clock;z.stop(),z.elapsedTime=0,R!=="never"&&(z.start(),z.elapsedTime=0),f(()=>({frameloop:R}))},previousRoot:void 0,internal:{active:!1,priority:0,frames:0,lastEvent:ne.createRef(),interaction:[],hovered:new Map,subscribers:[],initialClick:[0,0],initialHits:[],capturedMap:new Map,subscribe:(R,z,O)=>{const F=p().internal;return F.priority=F.priority+(z>0?1:0),F.subscribers.push({ref:R,priority:z,store:O}),F.subscribers=F.subscribers.sort((H,$)=>H.priority-$.priority),()=>{const H=p().internal;H!=null&&H.subscribers&&(H.priority=H.priority-(z>0?1:0),H.subscribers=H.subscribers.filter($=>$.ref!==R))}}}}}),a=i.getState();let s=a.size,l=a.viewport.dpr,d=a.camera;return i.subscribe(()=>{const{camera:f,size:p,viewport:y,gl:_,set:b}=i.getState();if(p.width!==s.width||p.height!==s.height||y.dpr!==l){var S;s=p,l=y.dpr,mTe(f,p),_.setPixelRatio(y.dpr);const A=(S=p.updateStyle)!=null?S:typeof HTMLCanvasElement<"u"&&_.domElement instanceof HTMLCanvasElement;_.setSize(p.width,p.height,A)}f!==d&&(d=f,b(A=>({viewport:{...A.viewport,...A.viewport.getCurrentViewport(f)}})))}),i.subscribe(f=>n(f)),i};let wE,xTe=new Set,bTe=new Set,wTe=new Set;function wL(n,e){if(n.size)for(const{callback:i}of n.values())i(e)}function Lx(n,e){switch(n){case"before":return wL(xTe,e);case"after":return wL(bTe,e);case"tail":return wL(wTe,e)}}let SL,EL;function ML(n,e,i){let a=e.clock.getDelta();for(e.frameloop==="never"&&typeof n=="number"&&(a=n-e.clock.elapsedTime,e.clock.oldTime=e.clock.elapsedTime,e.clock.elapsedTime=n),SL=e.internal.subscribers,wE=0;wE<SL.length;wE++)EL=SL[wE],EL.ref.current(EL.store.getState(),a,i);return!e.internal.priority&&e.gl.render&&e.gl.render(e.scene,e.camera),e.internal.frames=Math.max(0,e.internal.frames-1),e.frameloop==="always"?1:e.internal.frames}function STe(n){let e=!1,i,a,s;function l(p){a=requestAnimationFrame(l),e=!0,i=0,Lx("before",p);for(const _ of n.values()){var y;s=_.store.getState(),s.internal.active&&(s.frameloop==="always"||s.internal.frames>0)&&!((y=s.gl.xr)!=null&&y.isPresenting)&&(i+=ML(p,s))}if(Lx("after",p),i===0)return Lx("tail",p),e=!1,cancelAnimationFrame(a)}function d(p,y=1){var _;if(!p)return n.forEach(b=>d(b.store.getState()),y);(_=p.gl.xr)!=null&&_.isPresenting||!p.internal.active||p.frameloop==="never"||(p.internal.frames=Math.min(60,p.internal.frames+y),e||(e=!0,requestAnimationFrame(l)))}function f(p,y=!0,_,b){if(y&&Lx("before",p),_)ML(p,_,b);else for(const S of n.values())ML(p,S.store.getState());y&&Lx("after",p)}return{loop:l,invalidate:d,advance:f}}function tJ(){const n=ne.useContext(eJ);if(!n)throw new Error("R3F: Hooks can only be used within the Canvas component!");return n}function Eh(n=i=>i,e){return tJ()(n,e)}function Kz(n,e=0){const i=tJ(),a=i.getState().internal.subscribe,s=YK(n);return lS(()=>a(s,e,i),[e,a,i]),null}const _G=new WeakMap;function nJ(n,e){return function(i,...a){let s=_G.get(i);return s||(s=new i,_G.set(i,s)),n&&n(s),Promise.all(a.map(l=>new Promise((d,f)=>s.load(l,p=>{p.scene&&Object.assign(p,hTe(p.scene)),d(p)},e,p=>f(new Error(`Could not load ${l}: ${p==null?void 0:p.message}`)))))).finally(()=>s.dispose==null?void 0:s.dispose())}}function Jz(n,e,i,a){const s=Array.isArray(e)?e:[e],l=HK(nJ(i,a),[n,...s],{equal:da.equ});return Array.isArray(e)?l:l[0]}Jz.preload=function(n,e,i){const a=Array.isArray(e)?e:[e];return aTe(nJ(i),[n,...a])};Jz.clear=function(n,e){const i=Array.isArray(e)?e:[e];return oTe([n,...i])};const b_=new Map,{invalidate:xG,advance:bG}=STe(b_),{reconciler:xT,applyProps:c0}=lTe(b_,gTe),u0={objects:"shallow",strict:!1},ETe=(n,e)=>{const i=typeof n=="function"?n(e):n;return QK(i)?i:new Cz({powerPreference:"high-performance",canvas:e,antialias:!0,alpha:!0,...n})};function MTe(n,e){const i=typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement;if(e){const{width:a,height:s,top:l,left:d,updateStyle:f=i}=e;return{width:a,height:s,top:l,left:d,updateStyle:f}}else if(typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement&&n.parentElement){const{width:a,height:s,top:l,left:d}=n.parentElement.getBoundingClientRect();return{width:a,height:s,top:l,left:d,updateStyle:i}}else if(typeof OffscreenCanvas<"u"&&n instanceof OffscreenCanvas)return{width:n.width,height:n.height,top:0,left:0,updateStyle:i};return{width:0,height:0,top:0,left:0}}function TTe(n){const e=b_.get(n),i=e==null?void 0:e.fiber,a=e==null?void 0:e.store;e&&console.warn("R3F.createRoot should only be called once!");const s=typeof reportError=="function"?reportError:console.error,l=a||_Te(xG,bG),d=i||xT.createContainer(l,B0.ConcurrentRoot,null,!1,null,"",s,null);e||b_.set(n,{fiber:d,store:l});let f,p=!1,y;return{configure(_={}){let{gl:b,size:S,scene:A,events:P,onCreated:L,shadows:k=!1,linear:R=!1,flat:z=!1,legacy:O=!1,orthographic:F=!1,frameloop:H="always",dpr:$=[1,2],performance:Y,raycaster:te,camera:G,onPointerMissed:Q}=_,he=l.getState(),pe=he.gl;he.gl||he.set({gl:pe=ETe(b,n)});let ye=he.raycaster;ye||he.set({raycaster:ye=new OK});const{params:fe,...Ae}=te||{};if(da.equ(Ae,ye,u0)||c0(ye,{...Ae}),da.equ(fe,ye.params,u0)||c0(ye,{params:{...ye.params,...fe}}),!he.camera||he.camera===y&&!da.equ(y,G,u0)){y=G;const Te=G instanceof nS,Je=Te?G:F?new Oh(0,0,0,0,.1,1e3):new Za(75,0,.1,1e3);Te||(Je.position.z=5,G&&c0(Je,G),!he.camera&&!(G!=null&&G.rotation)&&Je.lookAt(0,0,0)),he.set({camera:Je}),ye.camera=Je}if(!he.scene){let Te;A instanceof vT?Te=A:(Te=new vT,A&&c0(Te,A)),he.set({scene:_0(Te)})}if(!he.xr){var Re;const Te=(Ze,Fe)=>{const ct=l.getState();ct.frameloop!=="never"&&bG(Ze,!0,ct,Fe)},Je=()=>{const Ze=l.getState();Ze.gl.xr.enabled=Ze.gl.xr.isPresenting,Ze.gl.xr.setAnimationLoop(Ze.gl.xr.isPresenting?Te:null),Ze.gl.xr.isPresenting||xG(Ze)},Xe={connect(){const Ze=l.getState().gl;Ze.xr.addEventListener("sessionstart",Je),Ze.xr.addEventListener("sessionend",Je)},disconnect(){const Ze=l.getState().gl;Ze.xr.removeEventListener("sessionstart",Je),Ze.xr.removeEventListener("sessionend",Je)}};typeof((Re=pe.xr)==null?void 0:Re.addEventListener)=="function"&&Xe.connect(),he.set({xr:Xe})}if(pe.shadowMap){const Te=pe.shadowMap.enabled,Je=pe.shadowMap.type;if(pe.shadowMap.enabled=!!k,da.boo(k))pe.shadowMap.type=vb;else if(da.str(k)){var Be;const Xe={basic:PX,percentage:YA,soft:vb,variance:uu};pe.shadowMap.type=(Be=Xe[k])!=null?Be:vb}else da.obj(k)&&Object.assign(pe.shadowMap,k);(Te!==pe.shadowMap.enabled||Je!==pe.shadowMap.type)&&(pe.shadowMap.needsUpdate=!0)}const le=jK();le&&("enabled"in le?le.enabled=!O:"legacyMode"in le&&(le.legacyMode=O)),c0(pe,{outputEncoding:R?3e3:3001,toneMapping:z?bd:uz}),he.legacy!==O&&he.set(()=>({legacy:O})),he.linear!==R&&he.set(()=>({linear:R})),he.flat!==z&&he.set(()=>({flat:z})),b&&!da.fun(b)&&!QK(b)&&!da.equ(b,pe,u0)&&c0(pe,b),P&&!he.events.handlers&&he.set({events:P(l)});const re=MTe(n,S);return da.equ(re,he.size,u0)||he.setSize(re.width,re.height,re.updateStyle,re.top,re.left),$&&he.viewport.dpr!==ZK($)&&he.setDpr($),he.frameloop!==H&&he.setFrameloop(H),he.onPointerMissed||he.set({onPointerMissed:Q}),Y&&!da.equ(Y,he.performance,u0)&&he.set(Te=>({performance:{...Te.performance,...Y}})),f=L,p=!0,this},render(_){return p||this.configure(),xT.updateContainer(ne.createElement(ATe,{store:l,children:_,onCreated:f,rootElement:n}),d,null,()=>{}),l},unmount(){iJ(n)}}}function ATe({store:n,children:e,onCreated:i,rootElement:a}){return lS(()=>{const s=n.getState();s.set(l=>({internal:{...l.internal,active:!0}})),i&&i(s),n.getState().events.connected||s.events.connect==null||s.events.connect(a)},[]),ne.createElement(eJ.Provider,{value:n},e)}function iJ(n,e){const i=b_.get(n),a=i==null?void 0:i.fiber;if(a){const s=i==null?void 0:i.store.getState();s&&(s.internal.active=!1),xT.updateContainer(null,a,null,()=>{s&&setTimeout(()=>{try{var l,d,f,p;s.events.disconnect==null||s.events.disconnect(),(l=s.gl)==null||(d=l.renderLists)==null||d.dispose==null||d.dispose(),(f=s.gl)==null||f.forceContextLoss==null||f.forceContextLoss(),(p=s.gl)!=null&&p.xr&&s.xr.disconnect(),fTe(s),b_.delete(n),e&&e(n)}catch{}},500)})}}xT.injectIntoDevTools({bundleType:0,rendererPackageName:"@react-three/fiber",version:ne.version});function Q5(n,e,i){var a,s,l,d,f;e==null&&(e=100);function p(){var _=Date.now()-d;_<e&&_>=0?a=setTimeout(p,e-_):(a=null,i||(f=n.apply(l,s),l=s=null))}var y=function(){l=this,s=arguments,d=Date.now();var _=i&&!a;return a||(a=setTimeout(p,e)),_&&(f=n.apply(l,s),l=s=null),f};return y.clear=function(){a&&(clearTimeout(a),a=null)},y.flush=function(){a&&(f=n.apply(l,s),l=s=null,clearTimeout(a),a=null)},y}Q5.debounce=Q5;var CTe=Q5;const wG=Nw(CTe);function PTe(n){let{debounce:e,scroll:i,polyfill:a,offsetSize:s}=n===void 0?{debounce:0,scroll:!1,offsetSize:!1}:n;const l=a||(typeof window>"u"?class{}:window.ResizeObserver);if(!l)throw new Error("This browser does not support ResizeObserver out of the box. See: https://github.com/react-spring/react-use-measure/#resize-observer-polyfills");const[d,f]=ne.useState({left:0,top:0,width:0,height:0,bottom:0,right:0,x:0,y:0}),p=ne.useRef({element:null,scrollContainers:null,resizeObserver:null,lastBounds:d}),y=e?typeof e=="number"?e:e.scroll:null,_=e?typeof e=="number"?e:e.resize:null,b=ne.useRef(!1);ne.useEffect(()=>(b.current=!0,()=>void(b.current=!1)));const[S,A,P]=ne.useMemo(()=>{const z=()=>{if(!p.current.element)return;const{left:O,top:F,width:H,height:$,bottom:Y,right:te,x:G,y:Q}=p.current.element.getBoundingClientRect(),he={left:O,top:F,width:H,height:$,bottom:Y,right:te,x:G,y:Q};p.current.element instanceof HTMLElement&&s&&(he.height=p.current.element.offsetHeight,he.width=p.current.element.offsetWidth),Object.freeze(he),b.current&&!kTe(p.current.lastBounds,he)&&f(p.current.lastBounds=he)};return[z,_?wG(z,_):z,y?wG(z,y):z]},[f,s,y,_]);function L(){p.current.scrollContainers&&(p.current.scrollContainers.forEach(z=>z.removeEventListener("scroll",P,!0)),p.current.scrollContainers=null),p.current.resizeObserver&&(p.current.resizeObserver.disconnect(),p.current.resizeObserver=null)}function k(){p.current.element&&(p.current.resizeObserver=new l(P),p.current.resizeObserver.observe(p.current.element),i&&p.current.scrollContainers&&p.current.scrollContainers.forEach(z=>z.addEventListener("scroll",P,{capture:!0,passive:!0})))}const R=z=>{!z||z===p.current.element||(L(),p.current.element=z,p.current.scrollContainers=rJ(z),k())};return RTe(P,!!i),ITe(A),ne.useEffect(()=>{L(),k()},[i,P,A]),ne.useEffect(()=>L,[]),[R,d,S]}function ITe(n){ne.useEffect(()=>{const e=n;return window.addEventListener("resize",e),()=>void window.removeEventListener("resize",e)},[n])}function RTe(n,e){ne.useEffect(()=>{if(e){const i=n;return window.addEventListener("scroll",i,{capture:!0,passive:!0}),()=>void window.removeEventListener("scroll",i,!0)}},[n,e])}function rJ(n){const e=[];if(!n||n===document.body)return e;const{overflow:i,overflowX:a,overflowY:s}=window.getComputedStyle(n);return[i,a,s].some(l=>l==="auto"||l==="scroll")&&e.push(n),[...e,...rJ(n.parentElement)]}const LTe=["x","y","top","bottom","left","right","width","height"],kTe=(n,e)=>LTe.every(i=>n[i]===e[i]);var DTe=Object.defineProperty,zTe=Object.defineProperties,OTe=Object.getOwnPropertyDescriptors,SG=Object.getOwnPropertySymbols,NTe=Object.prototype.hasOwnProperty,FTe=Object.prototype.propertyIsEnumerable,EG=(n,e,i)=>e in n?DTe(n,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):n[e]=i,MG=(n,e)=>{for(var i in e||(e={}))NTe.call(e,i)&&EG(n,i,e[i]);if(SG)for(var i of SG(e))FTe.call(e,i)&&EG(n,i,e[i]);return n},BTe=(n,e)=>zTe(n,OTe(e));function aJ(n,e,i){if(!n)return;if(i(n)===!0)return n;let a=e?n.return:n.child;for(;a;){const s=aJ(a,e,i);if(s)return s;a=e?null:a.sibling}}function oJ(n){try{return Object.defineProperties(n,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return n}}const Qz=oJ(ne.createContext(null));class sJ extends ne.Component{render(){return ne.createElement(Qz.Provider,{value:this._reactInternals},this.props.children)}}const{ReactCurrentOwner:TG,ReactCurrentDispatcher:AG}=ne.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;function UTe(){const n=ne.useContext(Qz);if(n===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const e=ne.useId();return ne.useMemo(()=>{for(const a of[TG==null?void 0:TG.current,n,n==null?void 0:n.alternate]){if(!a)continue;const s=aJ(a,!1,l=>{let d=l.memoizedState;for(;d;){if(d.memoizedState===e)return!0;d=d.next}});if(s)return s}},[n,e])}function WTe(){var n,e;const i=UTe(),[a]=ne.useState(()=>new Map);a.clear();let s=i;for(;s;){const l=(n=s.type)==null?void 0:n._context;l&&l!==Qz&&!a.has(l)&&a.set(l,(e=AG==null?void 0:AG.current)==null?void 0:e.readContext(oJ(l))),s=s.return}return a}function VTe(){const n=WTe();return ne.useMemo(()=>Array.from(n.keys()).reduce((e,i)=>a=>ne.createElement(e,null,ne.createElement(i.Provider,BTe(MG({},a),{value:n.get(i)}))),e=>ne.createElement(sJ,MG({},e))),[n])}const TL={onClick:["click",!1],onContextMenu:["contextmenu",!1],onDoubleClick:["dblclick",!1],onWheel:["wheel",!0],onPointerDown:["pointerdown",!0],onPointerUp:["pointerup",!0],onPointerLeave:["pointerleave",!0],onPointerMove:["pointermove",!0],onPointerCancel:["pointercancel",!0],onLostPointerCapture:["lostpointercapture",!0]};function GTe(n){const{handlePointer:e}=vTe(n);return{priority:1,enabled:!0,compute(i,a,s){a.pointer.set(i.offsetX/a.size.width*2-1,-(i.offsetY/a.size.height)*2+1),a.raycaster.setFromCamera(a.pointer,a.camera)},connected:void 0,handlers:Object.keys(TL).reduce((i,a)=>({...i,[a]:e(a)}),{}),update:()=>{var i;const{events:a,internal:s}=n.getState();(i=s.lastEvent)!=null&&i.current&&a.handlers&&a.handlers.onPointerMove(s.lastEvent.current)},connect:i=>{var a;const{set:s,events:l}=n.getState();l.disconnect==null||l.disconnect(),s(d=>({events:{...d.events,connected:i}})),Object.entries((a=l.handlers)!=null?a:[]).forEach(([d,f])=>{const[p,y]=TL[d];i.addEventListener(p,f,{passive:y})})},disconnect:()=>{const{set:i,events:a}=n.getState();if(a.connected){var s;Object.entries((s=a.handlers)!=null?s:[]).forEach(([l,d])=>{if(a&&a.connected instanceof HTMLElement){const[f]=TL[l];a.connected.removeEventListener(f,d)}}),i(l=>({events:{...l.events,connected:void 0}}))}}}}const HTe=ne.forwardRef(function({children:e,fallback:i,resize:a,style:s,gl:l,events:d=GTe,eventSource:f,eventPrefix:p,shadows:y,linear:_,flat:b,legacy:S,orthographic:A,frameloop:P,dpr:L,performance:k,raycaster:R,camera:z,scene:O,onPointerMissed:F,onCreated:H,...$},Y){ne.useMemo(()=>sTe(XMe),[]);const te=VTe(),[G,Q]=PTe({scroll:!0,debounce:{scroll:50,resize:0},...a}),he=ne.useRef(null),pe=ne.useRef(null);ne.useImperativeHandle(Y,()=>he.current);const ye=YK(F),[fe,Ae]=ne.useState(!1),[Re,Be]=ne.useState(!1);if(fe)throw fe;if(Re)throw Re;const le=ne.useRef(null);lS(()=>{const we=he.current;Q.width>0&&Q.height>0&&we&&(le.current||(le.current=TTe(we)),le.current.configure({gl:l,events:d,shadows:y,linear:_,flat:b,legacy:S,orthographic:A,frameloop:P,dpr:L,performance:k,raycaster:R,camera:z,scene:O,size:Q,onPointerMissed:(...re)=>ye.current==null?void 0:ye.current(...re),onCreated:re=>{re.events.connect==null||re.events.connect(f?cTe(f)?f.current:f:pe.current),p&&re.setEvents({compute:(Te,Je)=>{const Xe=Te[p+"X"],Ze=Te[p+"Y"];Je.pointer.set(Xe/Je.size.width*2-1,-(Ze/Je.size.height)*2+1),Je.raycaster.setFromCamera(Je.pointer,Je.camera)}}),H==null||H(re)}}),le.current.render(ne.createElement(te,null,ne.createElement(qK,{set:Be},ne.createElement(ne.Suspense,{fallback:ne.createElement(uTe,{set:Ae})},e)))))}),ne.useEffect(()=>{const we=he.current;if(we)return()=>iJ(we)},[]);const me=f?"none":"auto";return ne.createElement("div",Ge({ref:pe,style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",pointerEvents:me,...s}},$),ne.createElement("div",{ref:G,style:{width:"100%",height:"100%"}},ne.createElement("canvas",{ref:he,style:{display:"block"}},i)))}),jTe=ne.forwardRef(function(e,i){return ne.createElement(sJ,null,ne.createElement(HTe,Ge({},e,{ref:i})))});var $Te=Object.defineProperty,YTe=(n,e,i)=>e in n?$Te(n,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):n[e]=i,Ii=(n,e,i)=>(YTe(n,typeof e!="symbol"?e+"":e,i),i);const SE=new iy,CG=new Ph,qTe=Math.cos(70*(Math.PI/180)),PG=(n,e)=>(n%e+e)%e;let XTe=class extends Ld{constructor(e,i){super(),Ii(this,"object"),Ii(this,"domElement"),Ii(this,"enabled",!0),Ii(this,"target",new We),Ii(this,"minDistance",0),Ii(this,"maxDistance",1/0),Ii(this,"minZoom",0),Ii(this,"maxZoom",1/0),Ii(this,"minPolarAngle",0),Ii(this,"maxPolarAngle",Math.PI),Ii(this,"minAzimuthAngle",-1/0),Ii(this,"maxAzimuthAngle",1/0),Ii(this,"enableDamping",!1),Ii(this,"dampingFactor",.05),Ii(this,"enableZoom",!0),Ii(this,"zoomSpeed",1),Ii(this,"enableRotate",!0),Ii(this,"rotateSpeed",1),Ii(this,"enablePan",!0),Ii(this,"panSpeed",1),Ii(this,"screenSpacePanning",!0),Ii(this,"keyPanSpeed",7),Ii(this,"zoomToCursor",!1),Ii(this,"autoRotate",!1),Ii(this,"autoRotateSpeed",2),Ii(this,"reverseOrbit",!1),Ii(this,"reverseHorizontalOrbit",!1),Ii(this,"reverseVerticalOrbit",!1),Ii(this,"keys",{LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"}),Ii(this,"mouseButtons",{LEFT:sg.ROTATE,MIDDLE:sg.DOLLY,RIGHT:sg.PAN}),Ii(this,"touches",{ONE:lg.ROTATE,TWO:lg.DOLLY_PAN}),Ii(this,"target0"),Ii(this,"position0"),Ii(this,"zoom0"),Ii(this,"_domElementKeyEvents",null),Ii(this,"getPolarAngle"),Ii(this,"getAzimuthalAngle"),Ii(this,"setPolarAngle"),Ii(this,"setAzimuthalAngle"),Ii(this,"getDistance"),Ii(this,"listenToKeyEvents"),Ii(this,"stopListenToKeyEvents"),Ii(this,"saveState"),Ii(this,"reset"),Ii(this,"update"),Ii(this,"connect"),Ii(this,"dispose"),this.object=e,this.domElement=i,this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=()=>_.phi,this.getAzimuthalAngle=()=>_.theta,this.setPolarAngle=$e=>{let Pt=PG($e,2*Math.PI),qt=_.phi;qt<0&&(qt+=2*Math.PI),Pt<0&&(Pt+=2*Math.PI);let Ot=Math.abs(Pt-qt);2*Math.PI-Ot<Ot&&(Pt<qt?Pt+=2*Math.PI:qt+=2*Math.PI),b.phi=Pt-qt,a.update()},this.setAzimuthalAngle=$e=>{let Pt=PG($e,2*Math.PI),qt=_.theta;qt<0&&(qt+=2*Math.PI),Pt<0&&(Pt+=2*Math.PI);let Ot=Math.abs(Pt-qt);2*Math.PI-Ot<Ot&&(Pt<qt?Pt+=2*Math.PI:qt+=2*Math.PI),b.theta=Pt-qt,a.update()},this.getDistance=()=>a.object.position.distanceTo(a.target),this.listenToKeyEvents=$e=>{$e.addEventListener("keydown",lt),this._domElementKeyEvents=$e},this.stopListenToKeyEvents=()=>{this._domElementKeyEvents.removeEventListener("keydown",lt),this._domElementKeyEvents=null},this.saveState=()=>{a.target0.copy(a.target),a.position0.copy(a.object.position),a.zoom0=a.object.zoom},this.reset=()=>{a.target.copy(a.target0),a.object.position.copy(a.position0),a.object.zoom=a.zoom0,a.object.updateProjectionMatrix(),a.dispatchEvent(s),a.update(),p=f.NONE},this.update=(()=>{const $e=new We,Pt=new We(0,1,0),qt=new As().setFromUnitVectors(e.up,Pt),Ot=qt.clone().invert(),fn=new We,be=new As,Qe=2*Math.PI;return function(){const Ce=a.object.position;qt.setFromUnitVectors(e.up,Pt),Ot.copy(qt).invert(),$e.copy(Ce).sub(a.target),$e.applyQuaternion(qt),_.setFromVector3($e),a.autoRotate&&p===f.NONE&&fe(pe()),a.enableDamping?(_.theta+=b.theta*a.dampingFactor,_.phi+=b.phi*a.dampingFactor):(_.theta+=b.theta,_.phi+=b.phi);let Ne=a.minAzimuthAngle,et=a.maxAzimuthAngle;isFinite(Ne)&&isFinite(et)&&(Ne<-Math.PI?Ne+=Qe:Ne>Math.PI&&(Ne-=Qe),et<-Math.PI?et+=Qe:et>Math.PI&&(et-=Qe),Ne<=et?_.theta=Math.max(Ne,Math.min(et,_.theta)):_.theta=_.theta>(Ne+et)/2?Math.max(Ne,_.theta):Math.min(et,_.theta)),_.phi=Math.max(a.minPolarAngle,Math.min(a.maxPolarAngle,_.phi)),_.makeSafe(),a.enableDamping===!0?a.target.addScaledVector(A,a.dampingFactor):a.target.add(A),a.zoomToCursor&&G||a.object.isOrthographicCamera?_.radius=Te(_.radius):_.radius=Te(_.radius*S),$e.setFromSpherical(_),$e.applyQuaternion(Ot),Ce.copy(a.target).add($e),a.object.lookAt(a.target),a.enableDamping===!0?(b.theta*=1-a.dampingFactor,b.phi*=1-a.dampingFactor,A.multiplyScalar(1-a.dampingFactor)):(b.set(0,0,0),A.set(0,0,0));let tt=!1;if(a.zoomToCursor&&G){let vt=null;if(a.object instanceof Za&&a.object.isPerspectiveCamera){const ht=$e.length();vt=Te(ht*S);const dt=ht-vt;a.object.position.addScaledVector(Y,dt),a.object.updateMatrixWorld()}else if(a.object.isOrthographicCamera){const ht=new We(te.x,te.y,0);ht.unproject(a.object),a.object.zoom=Math.max(a.minZoom,Math.min(a.maxZoom,a.object.zoom/S)),a.object.updateProjectionMatrix(),tt=!0;const dt=new We(te.x,te.y,0);dt.unproject(a.object),a.object.position.sub(dt).add(ht),a.object.updateMatrixWorld(),vt=$e.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),a.zoomToCursor=!1;vt!==null&&(a.screenSpacePanning?a.target.set(0,0,-1).transformDirection(a.object.matrix).multiplyScalar(vt).add(a.object.position):(SE.origin.copy(a.object.position),SE.direction.set(0,0,-1).transformDirection(a.object.matrix),Math.abs(a.object.up.dot(SE.direction))<qTe?e.lookAt(a.target):(CG.setFromNormalAndCoplanarPoint(a.object.up,a.target),SE.intersectPlane(CG,a.target))))}else a.object instanceof Oh&&a.object.isOrthographicCamera&&(a.object.zoom=Math.max(a.minZoom,Math.min(a.maxZoom,a.object.zoom/S)),a.object.updateProjectionMatrix(),tt=!0);return S=1,G=!1,tt||fn.distanceToSquared(a.object.position)>y||8*(1-be.dot(a.object.quaternion))>y?(a.dispatchEvent(s),fn.copy(a.object.position),be.copy(a.object.quaternion),tt=!1,!0):!1}})(),this.connect=$e=>{$e===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),a.domElement=$e,a.domElement.style.touchAction="none",a.domElement.addEventListener("contextmenu",Wt),a.domElement.addEventListener("pointerdown",ze),a.domElement.addEventListener("pointercancel",ie),a.domElement.addEventListener("wheel",it)},this.dispose=()=>{var $e,Pt,qt,Ot,fn,be;($e=a.domElement)==null||$e.removeEventListener("contextmenu",Wt),(Pt=a.domElement)==null||Pt.removeEventListener("pointerdown",ze),(qt=a.domElement)==null||qt.removeEventListener("pointercancel",ie),(Ot=a.domElement)==null||Ot.removeEventListener("wheel",it),(fn=a.domElement)==null||fn.ownerDocument.removeEventListener("pointermove",st),(be=a.domElement)==null||be.ownerDocument.removeEventListener("pointerup",de),a._domElementKeyEvents!==null&&a._domElementKeyEvents.removeEventListener("keydown",lt)};const a=this,s={type:"change"},l={type:"start"},d={type:"end"},f={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let p=f.NONE;const y=1e-6,_=new Z5,b=new Z5;let S=1;const A=new We,P=new tn,L=new tn,k=new tn,R=new tn,z=new tn,O=new tn,F=new tn,H=new tn,$=new tn,Y=new We,te=new tn;let G=!1;const Q=[],he={};function pe(){return 2*Math.PI/60/60*a.autoRotateSpeed}function ye(){return Math.pow(.95,a.zoomSpeed)}function fe($e){a.reverseOrbit||a.reverseHorizontalOrbit?b.theta+=$e:b.theta-=$e}function Ae($e){a.reverseOrbit||a.reverseVerticalOrbit?b.phi+=$e:b.phi-=$e}const Re=(()=>{const $e=new We;return function(qt,Ot){$e.setFromMatrixColumn(Ot,0),$e.multiplyScalar(-qt),A.add($e)}})(),Be=(()=>{const $e=new We;return function(qt,Ot){a.screenSpacePanning===!0?$e.setFromMatrixColumn(Ot,1):($e.setFromMatrixColumn(Ot,0),$e.crossVectors(a.object.up,$e)),$e.multiplyScalar(qt),A.add($e)}})(),le=(()=>{const $e=new We;return function(qt,Ot){const fn=a.domElement;if(fn&&a.object instanceof Za&&a.object.isPerspectiveCamera){const be=a.object.position;$e.copy(be).sub(a.target);let Qe=$e.length();Qe*=Math.tan(a.object.fov/2*Math.PI/180),Re(2*qt*Qe/fn.clientHeight,a.object.matrix),Be(2*Ot*Qe/fn.clientHeight,a.object.matrix)}else fn&&a.object instanceof Oh&&a.object.isOrthographicCamera?(Re(qt*(a.object.right-a.object.left)/a.object.zoom/fn.clientWidth,a.object.matrix),Be(Ot*(a.object.top-a.object.bottom)/a.object.zoom/fn.clientHeight,a.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),a.enablePan=!1)}})();function me($e){a.object instanceof Za&&a.object.isPerspectiveCamera||a.object instanceof Oh&&a.object.isOrthographicCamera?S/=$e:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),a.enableZoom=!1)}function we($e){a.object instanceof Za&&a.object.isPerspectiveCamera||a.object instanceof Oh&&a.object.isOrthographicCamera?S*=$e:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),a.enableZoom=!1)}function re($e){if(!a.zoomToCursor||!a.domElement)return;G=!0;const Pt=a.domElement.getBoundingClientRect(),qt=$e.clientX-Pt.left,Ot=$e.clientY-Pt.top,fn=Pt.width,be=Pt.height;te.x=qt/fn*2-1,te.y=-(Ot/be)*2+1,Y.set(te.x,te.y,1).unproject(a.object).sub(a.object.position).normalize()}function Te($e){return Math.max(a.minDistance,Math.min(a.maxDistance,$e))}function Je($e){P.set($e.clientX,$e.clientY)}function Xe($e){re($e),F.set($e.clientX,$e.clientY)}function Ze($e){R.set($e.clientX,$e.clientY)}function Fe($e){L.set($e.clientX,$e.clientY),k.subVectors(L,P).multiplyScalar(a.rotateSpeed);const Pt=a.domElement;Pt&&(fe(2*Math.PI*k.x/Pt.clientHeight),Ae(2*Math.PI*k.y/Pt.clientHeight)),P.copy(L),a.update()}function ct($e){H.set($e.clientX,$e.clientY),$.subVectors(H,F),$.y>0?me(ye()):$.y<0&&we(ye()),F.copy(H),a.update()}function At($e){z.set($e.clientX,$e.clientY),O.subVectors(z,R).multiplyScalar(a.panSpeed),le(O.x,O.y),R.copy(z),a.update()}function kt($e){re($e),$e.deltaY<0?we(ye()):$e.deltaY>0&&me(ye()),a.update()}function Kt($e){let Pt=!1;switch($e.code){case a.keys.UP:le(0,a.keyPanSpeed),Pt=!0;break;case a.keys.BOTTOM:le(0,-a.keyPanSpeed),Pt=!0;break;case a.keys.LEFT:le(a.keyPanSpeed,0),Pt=!0;break;case a.keys.RIGHT:le(-a.keyPanSpeed,0),Pt=!0;break}Pt&&($e.preventDefault(),a.update())}function Et(){if(Q.length==1)P.set(Q[0].pageX,Q[0].pageY);else{const $e=.5*(Q[0].pageX+Q[1].pageX),Pt=.5*(Q[0].pageY+Q[1].pageY);P.set($e,Pt)}}function Ie(){if(Q.length==1)R.set(Q[0].pageX,Q[0].pageY);else{const $e=.5*(Q[0].pageX+Q[1].pageX),Pt=.5*(Q[0].pageY+Q[1].pageY);R.set($e,Pt)}}function pt(){const $e=Q[0].pageX-Q[1].pageX,Pt=Q[0].pageY-Q[1].pageY,qt=Math.sqrt($e*$e+Pt*Pt);F.set(0,qt)}function gt(){a.enableZoom&&pt(),a.enablePan&&Ie()}function _t(){a.enableZoom&&pt(),a.enableRotate&&Et()}function Ue($e){if(Q.length==1)L.set($e.pageX,$e.pageY);else{const qt=Xt($e),Ot=.5*($e.pageX+qt.x),fn=.5*($e.pageY+qt.y);L.set(Ot,fn)}k.subVectors(L,P).multiplyScalar(a.rotateSpeed);const Pt=a.domElement;Pt&&(fe(2*Math.PI*k.x/Pt.clientHeight),Ae(2*Math.PI*k.y/Pt.clientHeight)),P.copy(L)}function ue($e){if(Q.length==1)z.set($e.pageX,$e.pageY);else{const Pt=Xt($e),qt=.5*($e.pageX+Pt.x),Ot=.5*($e.pageY+Pt.y);z.set(qt,Ot)}O.subVectors(z,R).multiplyScalar(a.panSpeed),le(O.x,O.y),R.copy(z)}function se($e){const Pt=Xt($e),qt=$e.pageX-Pt.x,Ot=$e.pageY-Pt.y,fn=Math.sqrt(qt*qt+Ot*Ot);H.set(0,fn),$.set(0,Math.pow(H.y/F.y,a.zoomSpeed)),me($.y),F.copy(H)}function xe($e){a.enableZoom&&se($e),a.enablePan&&ue($e)}function Ye($e){a.enableZoom&&se($e),a.enableRotate&&Ue($e)}function ze($e){var Pt,qt;a.enabled!==!1&&(Q.length===0&&((Pt=a.domElement)==null||Pt.ownerDocument.addEventListener("pointermove",st),(qt=a.domElement)==null||qt.ownerDocument.addEventListener("pointerup",de)),Ht($e),$e.pointerType==="touch"?Mt($e):Oe($e))}function st($e){a.enabled!==!1&&($e.pointerType==="touch"?Ut($e):ut($e))}function de($e){var Pt,qt,Ot;Dt($e),Q.length===0&&((Pt=a.domElement)==null||Pt.releasePointerCapture($e.pointerId),(qt=a.domElement)==null||qt.ownerDocument.removeEventListener("pointermove",st),(Ot=a.domElement)==null||Ot.ownerDocument.removeEventListener("pointerup",de)),a.dispatchEvent(d),p=f.NONE}function ie($e){Dt($e)}function Oe($e){let Pt;switch($e.button){case 0:Pt=a.mouseButtons.LEFT;break;case 1:Pt=a.mouseButtons.MIDDLE;break;case 2:Pt=a.mouseButtons.RIGHT;break;default:Pt=-1}switch(Pt){case sg.DOLLY:if(a.enableZoom===!1)return;Xe($e),p=f.DOLLY;break;case sg.ROTATE:if($e.ctrlKey||$e.metaKey||$e.shiftKey){if(a.enablePan===!1)return;Ze($e),p=f.PAN}else{if(a.enableRotate===!1)return;Je($e),p=f.ROTATE}break;case sg.PAN:if($e.ctrlKey||$e.metaKey||$e.shiftKey){if(a.enableRotate===!1)return;Je($e),p=f.ROTATE}else{if(a.enablePan===!1)return;Ze($e),p=f.PAN}break;default:p=f.NONE}p!==f.NONE&&a.dispatchEvent(l)}function ut($e){if(a.enabled!==!1)switch(p){case f.ROTATE:if(a.enableRotate===!1)return;Fe($e);break;case f.DOLLY:if(a.enableZoom===!1)return;ct($e);break;case f.PAN:if(a.enablePan===!1)return;At($e);break}}function it($e){a.enabled===!1||a.enableZoom===!1||p!==f.NONE&&p!==f.ROTATE||($e.preventDefault(),a.dispatchEvent(l),kt($e),a.dispatchEvent(d))}function lt($e){a.enabled===!1||a.enablePan===!1||Kt($e)}function Mt($e){switch(wt($e),Q.length){case 1:switch(a.touches.ONE){case lg.ROTATE:if(a.enableRotate===!1)return;Et(),p=f.TOUCH_ROTATE;break;case lg.PAN:if(a.enablePan===!1)return;Ie(),p=f.TOUCH_PAN;break;default:p=f.NONE}break;case 2:switch(a.touches.TWO){case lg.DOLLY_PAN:if(a.enableZoom===!1&&a.enablePan===!1)return;gt(),p=f.TOUCH_DOLLY_PAN;break;case lg.DOLLY_ROTATE:if(a.enableZoom===!1&&a.enableRotate===!1)return;_t(),p=f.TOUCH_DOLLY_ROTATE;break;default:p=f.NONE}break;default:p=f.NONE}p!==f.NONE&&a.dispatchEvent(l)}function Ut($e){switch(wt($e),p){case f.TOUCH_ROTATE:if(a.enableRotate===!1)return;Ue($e),a.update();break;case f.TOUCH_PAN:if(a.enablePan===!1)return;ue($e),a.update();break;case f.TOUCH_DOLLY_PAN:if(a.enableZoom===!1&&a.enablePan===!1)return;xe($e),a.update();break;case f.TOUCH_DOLLY_ROTATE:if(a.enableZoom===!1&&a.enableRotate===!1)return;Ye($e),a.update();break;default:p=f.NONE}}function Wt($e){a.enabled!==!1&&$e.preventDefault()}function Ht($e){Q.push($e)}function Dt($e){delete he[$e.pointerId];for(let Pt=0;Pt<Q.length;Pt++)if(Q[Pt].pointerId==$e.pointerId){Q.splice(Pt,1);return}}function wt($e){let Pt=he[$e.pointerId];Pt===void 0&&(Pt=new tn,he[$e.pointerId]=Pt),Pt.set($e.pageX,$e.pageY)}function Xt($e){const Pt=$e.pointerId===Q[0].pointerId?Q[1]:Q[0];return he[Pt.pointerId]}i!==void 0&&this.connect(i),this.update()}};function ZTe(){var n=Object.create(null);function e(s,l){var d=s.id,f=s.name,p=s.dependencies;p===void 0&&(p=[]);var y=s.init;y===void 0&&(y=function(){});var _=s.getTransferables;if(_===void 0&&(_=null),!n[d])try{p=p.map(function(S){return S&&S.isWorkerModule&&(e(S,function(A){if(A instanceof Error)throw A}),S=n[S.id].value),S}),y=a("<"+f+">.init",y),_&&(_=a("<"+f+">.getTransferables",_));var b=null;typeof y=="function"?b=y.apply(void 0,p):console.error("worker module init function failed to rehydrate"),n[d]={id:d,value:b,getTransferables:_},l(b)}catch(S){S&&S.noLog||console.error(S),l(S)}}function i(s,l){var d,f=s.id,p=s.args;(!n[f]||typeof n[f].value!="function")&&l(new Error("Worker module "+f+": not found or its 'init' did not return a function"));try{var y=(d=n[f]).value.apply(d,p);y&&typeof y.then=="function"?y.then(_,function(b){return l(b instanceof Error?b:new Error(""+b))}):_(y)}catch(b){l(b)}function _(b){try{var S=n[f].getTransferables&&n[f].getTransferables(b);(!S||!Array.isArray(S)||!S.length)&&(S=void 0),l(b,S)}catch(A){console.error(A),l(A)}}}function a(s,l){var d=void 0;self.troikaDefine=function(p){return d=p};var f=URL.createObjectURL(new Blob(["/** "+s.replace(/\*/g,"")+` **/

troikaDefine(
`+l+`
)`],{type:"application/javascript"}));try{importScripts(f)}catch(p){console.error(p)}return URL.revokeObjectURL(f),delete self.troikaDefine,d}self.addEventListener("message",function(s){var l=s.data,d=l.messageId,f=l.action,p=l.data;try{f==="registerModule"&&e(p,function(y){y instanceof Error?postMessage({messageId:d,success:!1,error:y.message}):postMessage({messageId:d,success:!0,result:{isCallable:typeof y=="function"}})}),f==="callModule"&&i(p,function(y,_){y instanceof Error?postMessage({messageId:d,success:!1,error:y.message}):postMessage({messageId:d,success:!0,result:y},_||void 0)})}catch(y){postMessage({messageId:d,success:!1,error:y.stack})}})}function KTe(n){var e=function(){for(var i=[],a=arguments.length;a--;)i[a]=arguments[a];return e._getInitResult().then(function(s){if(typeof s=="function")return s.apply(void 0,i);throw new Error("Worker module function was called but `init` did not return a callable function")})};return e._getInitResult=function(){var i=n.dependencies,a=n.init;i=Array.isArray(i)?i.map(function(l){return l&&l._getInitResult?l._getInitResult():l}):[];var s=Promise.all(i).then(function(l){return a.apply(null,l)});return e._getInitResult=function(){return s},s},e}var lJ=function(){var n=!1;if(typeof window<"u"&&typeof window.document<"u")try{var e=new Worker(URL.createObjectURL(new Blob([""],{type:"application/javascript"})));e.terminate(),n=!0}catch(i){typeof process<"u",console.log("Troika createWorkerModule: web workers not allowed; falling back to main thread execution. Cause: ["+i.message+"]")}return lJ=function(){return n},n},JTe=0,QTe=0,AL=!1,Eb=Object.create(null),Mb=Object.create(null),eD=Object.create(null);function cS(n){if((!n||typeof n.init!="function")&&!AL)throw new Error("requires `options.init` function");var e=n.dependencies,i=n.init,a=n.getTransferables,s=n.workerId;if(!lJ())return KTe(n);s==null&&(s="#default");var l="workerModule"+ ++JTe,d=n.name||l,f=null;e=e&&e.map(function(y){return typeof y=="function"&&!y.workerModuleData&&(AL=!0,y=cS({workerId:s,name:"<"+d+"> function dependency: "+y.name,init:`function(){return (
`+xM(y)+`
)}`}),AL=!1),y&&y.workerModuleData&&(y=y.workerModuleData),y});function p(){for(var y=[],_=arguments.length;_--;)y[_]=arguments[_];if(!f){f=IG(s,"registerModule",p.workerModuleData);var b=function(){f=null,Mb[s].delete(b)};(Mb[s]||(Mb[s]=new Set)).add(b)}return f.then(function(S){var A=S.isCallable;if(A)return IG(s,"callModule",{id:l,args:y});throw new Error("Worker module function was called but `init` did not return a callable function")})}return p.workerModuleData={isWorkerModule:!0,id:l,name:d,dependencies:e,init:xM(i),getTransferables:a&&xM(a)},p}function eAe(n){Mb[n]&&Mb[n].forEach(function(e){e()}),Eb[n]&&(Eb[n].terminate(),delete Eb[n])}function xM(n){var e=n.toString();return!/^function/.test(e)&&/^\w+\s*\(/.test(e)&&(e="function "+e),e}function tAe(n){var e=Eb[n];if(!e){var i=xM(ZTe);e=Eb[n]=new Worker(URL.createObjectURL(new Blob(["/** Worker Module Bootstrap: "+n.replace(/\*/g,"")+` **/

;(`+i+")()"],{type:"application/javascript"}))),e.onmessage=function(a){var s=a.data,l=s.messageId,d=eD[l];if(!d)throw new Error("WorkerModule response with empty or unknown messageId");delete eD[l],d(s)}}return e}function IG(n,e,i){return new Promise(function(a,s){var l=++QTe;eD[l]=function(d){d.success?a(d.result):s(new Error("Error in worker "+e+" call: "+d.error))},tAe(n).postMessage({messageId:l,action:e,data:i})})}function cJ(){var n=function(e){function i(me,we,re,Te,Je,Xe,Ze,Fe){var ct=1-Ze;Fe.x=ct*ct*me+2*ct*Ze*re+Ze*Ze*Je,Fe.y=ct*ct*we+2*ct*Ze*Te+Ze*Ze*Xe}function a(me,we,re,Te,Je,Xe,Ze,Fe,ct,At){var kt=1-ct;At.x=kt*kt*kt*me+3*kt*kt*ct*re+3*kt*ct*ct*Je+ct*ct*ct*Ze,At.y=kt*kt*kt*we+3*kt*kt*ct*Te+3*kt*ct*ct*Xe+ct*ct*ct*Fe}function s(me,we){for(var re=/([MLQCZ])([^MLQCZ]*)/g,Te,Je,Xe,Ze,Fe;Te=re.exec(me);){var ct=Te[2].replace(/^\s*|\s*$/g,"").split(/[,\s]+/).map(function(At){return parseFloat(At)});switch(Te[1]){case"M":Ze=Je=ct[0],Fe=Xe=ct[1];break;case"L":(ct[0]!==Ze||ct[1]!==Fe)&&we("L",Ze,Fe,Ze=ct[0],Fe=ct[1]);break;case"Q":{we("Q",Ze,Fe,Ze=ct[2],Fe=ct[3],ct[0],ct[1]);break}case"C":{we("C",Ze,Fe,Ze=ct[4],Fe=ct[5],ct[0],ct[1],ct[2],ct[3]);break}case"Z":(Ze!==Je||Fe!==Xe)&&we("L",Ze,Fe,Je,Xe);break}}}function l(me,we,re){re===void 0&&(re=16);var Te={x:0,y:0};s(me,function(Je,Xe,Ze,Fe,ct,At,kt,Kt,Et){switch(Je){case"L":we(Xe,Ze,Fe,ct);break;case"Q":{for(var Ie=Xe,pt=Ze,gt=1;gt<re;gt++)i(Xe,Ze,At,kt,Fe,ct,gt/(re-1),Te),we(Ie,pt,Te.x,Te.y),Ie=Te.x,pt=Te.y;break}case"C":{for(var _t=Xe,Ue=Ze,ue=1;ue<re;ue++)a(Xe,Ze,At,kt,Kt,Et,Fe,ct,ue/(re-1),Te),we(_t,Ue,Te.x,Te.y),_t=Te.x,Ue=Te.y;break}}})}var d="precision highp float;attribute vec2 aUV;varying vec2 vUV;void main(){vUV=aUV;gl_Position=vec4(mix(vec2(-1.0),vec2(1.0),aUV),0.0,1.0);}",f="precision highp float;uniform sampler2D tex;varying vec2 vUV;void main(){gl_FragColor=texture2D(tex,vUV);}",p=new WeakMap,y={premultipliedAlpha:!1,preserveDrawingBuffer:!0,antialias:!1,depth:!1};function _(me,we){var re=me.getContext?me.getContext("webgl",y):me,Te=p.get(re);if(!Te){let _t=function(ze){var st=Xe[ze];if(!st&&(st=Xe[ze]=re.getExtension(ze),!st))throw new Error(ze+" not supported");return st},Ue=function(ze,st){var de=re.createShader(st);return re.shaderSource(de,ze),re.compileShader(de),de},ue=function(ze,st,de,ie){if(!Ze[ze]){var Oe={},ut={},it=re.createProgram();re.attachShader(it,Ue(st,re.VERTEX_SHADER)),re.attachShader(it,Ue(de,re.FRAGMENT_SHADER)),re.linkProgram(it),Ze[ze]={program:it,transaction:function(Mt){re.useProgram(it),Mt({setUniform:function(Wt,Ht){for(var Dt=[],wt=arguments.length-2;wt-- >0;)Dt[wt]=arguments[wt+2];var Xt=ut[Ht]||(ut[Ht]=re.getUniformLocation(it,Ht));re["uniform"+Wt].apply(re,[Xt].concat(Dt))},setAttribute:function(Wt,Ht,Dt,wt,Xt){var $e=Oe[Wt];$e||($e=Oe[Wt]={buf:re.createBuffer(),loc:re.getAttribLocation(it,Wt),data:null}),re.bindBuffer(re.ARRAY_BUFFER,$e.buf),re.vertexAttribPointer($e.loc,Ht,re.FLOAT,!1,0,0),re.enableVertexAttribArray($e.loc),Je?re.vertexAttribDivisor($e.loc,wt):_t("ANGLE_instanced_arrays").vertexAttribDivisorANGLE($e.loc,wt),Xt!==$e.data&&(re.bufferData(re.ARRAY_BUFFER,Xt,Dt),$e.data=Xt)}})}}}Ze[ze].transaction(ie)},se=function(ze,st){ct++;try{re.activeTexture(re.TEXTURE0+ct);var de=Fe[ze];de||(de=Fe[ze]=re.createTexture(),re.bindTexture(re.TEXTURE_2D,de),re.texParameteri(re.TEXTURE_2D,re.TEXTURE_MIN_FILTER,re.NEAREST),re.texParameteri(re.TEXTURE_2D,re.TEXTURE_MAG_FILTER,re.NEAREST)),re.bindTexture(re.TEXTURE_2D,de),st(de,ct)}finally{ct--}},xe=function(ze,st,de){var ie=re.createFramebuffer();At.push(ie),re.bindFramebuffer(re.FRAMEBUFFER,ie),re.activeTexture(re.TEXTURE0+st),re.bindTexture(re.TEXTURE_2D,ze),re.framebufferTexture2D(re.FRAMEBUFFER,re.COLOR_ATTACHMENT0,re.TEXTURE_2D,ze,0);try{de(ie)}finally{re.deleteFramebuffer(ie),re.bindFramebuffer(re.FRAMEBUFFER,At[--At.length-1]||null)}},Ye=function(){Xe={},Ze={},Fe={},ct=-1,At.length=0};var kt=_t,Kt=Ue,Et=ue,Ie=se,pt=xe,gt=Ye,Je=typeof WebGL2RenderingContext<"u"&&re instanceof WebGL2RenderingContext,Xe={},Ze={},Fe={},ct=-1,At=[];re.canvas.addEventListener("webglcontextlost",function(ze){Ye(),ze.preventDefault()},!1),p.set(re,Te={gl:re,isWebGL2:Je,getExtension:_t,withProgram:ue,withTexture:se,withTextureFramebuffer:xe,handleContextLoss:Ye})}we(Te)}function b(me,we,re,Te,Je,Xe,Ze,Fe){Ze===void 0&&(Ze=15),Fe===void 0&&(Fe=null),_(me,function(ct){var At=ct.gl,kt=ct.withProgram,Kt=ct.withTexture;Kt("copy",function(Et,Ie){At.texImage2D(At.TEXTURE_2D,0,At.RGBA,Je,Xe,0,At.RGBA,At.UNSIGNED_BYTE,we),kt("copy",d,f,function(pt){var gt=pt.setUniform,_t=pt.setAttribute;_t("aUV",2,At.STATIC_DRAW,0,new Float32Array([0,0,2,0,0,2])),gt("1i","image",Ie),At.bindFramebuffer(At.FRAMEBUFFER,Fe||null),At.disable(At.BLEND),At.colorMask(Ze&8,Ze&4,Ze&2,Ze&1),At.viewport(re,Te,Je,Xe),At.scissor(re,Te,Je,Xe),At.drawArrays(At.TRIANGLES,0,3)})})})}function S(me,we,re){var Te=me.width,Je=me.height;_(me,function(Xe){var Ze=Xe.gl,Fe=new Uint8Array(Te*Je*4);Ze.readPixels(0,0,Te,Je,Ze.RGBA,Ze.UNSIGNED_BYTE,Fe),me.width=we,me.height=re,b(Ze,Fe,0,0,Te,Je)})}var A=Object.freeze({__proto__:null,withWebGLContext:_,renderImageData:b,resizeWebGLCanvasWithoutClearing:S});function P(me,we,re,Te,Je,Xe){Xe===void 0&&(Xe=1);var Ze=new Uint8Array(me*we),Fe=Te[2]-Te[0],ct=Te[3]-Te[1],At=[];l(re,function(_t,Ue,ue,se){At.push({x1:_t,y1:Ue,x2:ue,y2:se,minX:Math.min(_t,ue),minY:Math.min(Ue,se),maxX:Math.max(_t,ue),maxY:Math.max(Ue,se)})}),At.sort(function(_t,Ue){return _t.maxX-Ue.maxX});for(var kt=0;kt<me;kt++)for(var Kt=0;Kt<we;Kt++){var Et=pt(Te[0]+Fe*(kt+.5)/me,Te[1]+ct*(Kt+.5)/we),Ie=Math.pow(1-Math.abs(Et)/Je,Xe)/2;Et<0&&(Ie=1-Ie),Ie=Math.max(0,Math.min(255,Math.round(Ie*255))),Ze[Kt*me+kt]=Ie}return Ze;function pt(_t,Ue){for(var ue=1/0,se=1/0,xe=At.length;xe--;){var Ye=At[xe];if(Ye.maxX+se<=_t)break;if(_t+se>Ye.minX&&Ue-se<Ye.maxY&&Ue+se>Ye.minY){var ze=R(_t,Ue,Ye.x1,Ye.y1,Ye.x2,Ye.y2);ze<ue&&(ue=ze,se=Math.sqrt(ue))}}return gt(_t,Ue)&&(se=-se),se}function gt(_t,Ue){for(var ue=0,se=At.length;se--;){var xe=At[se];if(xe.maxX<=_t)break;var Ye=xe.y1>Ue!=xe.y2>Ue&&_t<(xe.x2-xe.x1)*(Ue-xe.y1)/(xe.y2-xe.y1)+xe.x1;Ye&&(ue+=xe.y1<xe.y2?1:-1)}return ue!==0}}function L(me,we,re,Te,Je,Xe,Ze,Fe,ct,At){Xe===void 0&&(Xe=1),Fe===void 0&&(Fe=0),ct===void 0&&(ct=0),At===void 0&&(At=0),k(me,we,re,Te,Je,Xe,Ze,null,Fe,ct,At)}function k(me,we,re,Te,Je,Xe,Ze,Fe,ct,At,kt){Xe===void 0&&(Xe=1),ct===void 0&&(ct=0),At===void 0&&(At=0),kt===void 0&&(kt=0);for(var Kt=P(me,we,re,Te,Je,Xe),Et=new Uint8Array(Kt.length*4),Ie=0;Ie<Kt.length;Ie++)Et[Ie*4+kt]=Kt[Ie];b(Ze,Et,ct,At,me,we,1<<3-kt,Fe)}function R(me,we,re,Te,Je,Xe){var Ze=Je-re,Fe=Xe-Te,ct=Ze*Ze+Fe*Fe,At=ct?Math.max(0,Math.min(1,((me-re)*Ze+(we-Te)*Fe)/ct)):0,kt=me-(re+At*Ze),Kt=we-(Te+At*Fe);return kt*kt+Kt*Kt}var z=Object.freeze({__proto__:null,generate:P,generateIntoCanvas:L,generateIntoFramebuffer:k}),O="precision highp float;uniform vec4 uGlyphBounds;attribute vec2 aUV;attribute vec4 aLineSegment;varying vec4 vLineSegment;varying vec2 vGlyphXY;void main(){vLineSegment=aLineSegment;vGlyphXY=mix(uGlyphBounds.xy,uGlyphBounds.zw,aUV);gl_Position=vec4(mix(vec2(-1.0),vec2(1.0),aUV),0.0,1.0);}",F="precision highp float;uniform vec4 uGlyphBounds;uniform float uMaxDistance;uniform float uExponent;varying vec4 vLineSegment;varying vec2 vGlyphXY;float absDistToSegment(vec2 point,vec2 lineA,vec2 lineB){vec2 lineDir=lineB-lineA;float lenSq=dot(lineDir,lineDir);float t=lenSq==0.0 ? 0.0 : clamp(dot(point-lineA,lineDir)/lenSq,0.0,1.0);vec2 linePt=lineA+t*lineDir;return distance(point,linePt);}void main(){vec4 seg=vLineSegment;vec2 p=vGlyphXY;float dist=absDistToSegment(p,seg.xy,seg.zw);float val=pow(1.0-clamp(dist/uMaxDistance,0.0,1.0),uExponent)*0.5;bool crossing=(seg.y>p.y!=seg.w>p.y)&&(p.x<(seg.z-seg.x)*(p.y-seg.y)/(seg.w-seg.y)+seg.x);bool crossingUp=crossing&&vLineSegment.y<vLineSegment.w;gl_FragColor=vec4(crossingUp ? 1.0/255.0 : 0.0,crossing&&!crossingUp ? 1.0/255.0 : 0.0,0.0,val);}",H="precision highp float;uniform sampler2D tex;varying vec2 vUV;void main(){vec4 color=texture2D(tex,vUV);bool inside=color.r!=color.g;float val=inside ? 1.0-color.a : color.a;gl_FragColor=vec4(val);}",$=new Float32Array([0,0,2,0,0,2]),Y=null,te=!1,G={},Q=new WeakMap;function he(me){if(!te&&!Ae(me))throw new Error("WebGL generation not supported")}function pe(me,we,re,Te,Je,Xe,Ze){if(Xe===void 0&&(Xe=1),Ze===void 0&&(Ze=null),!Ze&&(Ze=Y,!Ze)){var Fe=typeof OffscreenCanvas=="function"?new OffscreenCanvas(1,1):typeof document<"u"?document.createElement("canvas"):null;if(!Fe)throw new Error("OffscreenCanvas or DOM canvas not supported");Ze=Y=Fe.getContext("webgl",{depth:!1})}he(Ze);var ct=new Uint8Array(me*we*4);_(Ze,function(Et){var Ie=Et.gl,pt=Et.withTexture,gt=Et.withTextureFramebuffer;pt("readable",function(_t,Ue){Ie.texImage2D(Ie.TEXTURE_2D,0,Ie.RGBA,me,we,0,Ie.RGBA,Ie.UNSIGNED_BYTE,null),gt(_t,Ue,function(ue){fe(me,we,re,Te,Je,Xe,Ie,ue,0,0,0),Ie.readPixels(0,0,me,we,Ie.RGBA,Ie.UNSIGNED_BYTE,ct)})})});for(var At=new Uint8Array(me*we),kt=0,Kt=0;kt<ct.length;kt+=4)At[Kt++]=ct[kt];return At}function ye(me,we,re,Te,Je,Xe,Ze,Fe,ct,At){Xe===void 0&&(Xe=1),Fe===void 0&&(Fe=0),ct===void 0&&(ct=0),At===void 0&&(At=0),fe(me,we,re,Te,Je,Xe,Ze,null,Fe,ct,At)}function fe(me,we,re,Te,Je,Xe,Ze,Fe,ct,At,kt){Xe===void 0&&(Xe=1),ct===void 0&&(ct=0),At===void 0&&(At=0),kt===void 0&&(kt=0),he(Ze);var Kt=[];l(re,function(Et,Ie,pt,gt){Kt.push(Et,Ie,pt,gt)}),Kt=new Float32Array(Kt),_(Ze,function(Et){var Ie=Et.gl,pt=Et.isWebGL2,gt=Et.getExtension,_t=Et.withProgram,Ue=Et.withTexture,ue=Et.withTextureFramebuffer,se=Et.handleContextLoss;if(Ue("rawDistances",function(xe,Ye){(me!==xe._lastWidth||we!==xe._lastHeight)&&Ie.texImage2D(Ie.TEXTURE_2D,0,Ie.RGBA,xe._lastWidth=me,xe._lastHeight=we,0,Ie.RGBA,Ie.UNSIGNED_BYTE,null),_t("main",O,F,function(ze){var st=ze.setAttribute,de=ze.setUniform,ie=!pt&&gt("ANGLE_instanced_arrays"),Oe=!pt&&gt("EXT_blend_minmax");st("aUV",2,Ie.STATIC_DRAW,0,$),st("aLineSegment",4,Ie.DYNAMIC_DRAW,1,Kt),de.apply(void 0,["4f","uGlyphBounds"].concat(Te)),de("1f","uMaxDistance",Je),de("1f","uExponent",Xe),ue(xe,Ye,function(ut){Ie.enable(Ie.BLEND),Ie.colorMask(!0,!0,!0,!0),Ie.viewport(0,0,me,we),Ie.scissor(0,0,me,we),Ie.blendFunc(Ie.ONE,Ie.ONE),Ie.blendEquationSeparate(Ie.FUNC_ADD,pt?Ie.MAX:Oe.MAX_EXT),Ie.clear(Ie.COLOR_BUFFER_BIT),pt?Ie.drawArraysInstanced(Ie.TRIANGLES,0,3,Kt.length/4):ie.drawArraysInstancedANGLE(Ie.TRIANGLES,0,3,Kt.length/4)})}),_t("post",d,H,function(ze){ze.setAttribute("aUV",2,Ie.STATIC_DRAW,0,$),ze.setUniform("1i","tex",Ye),Ie.bindFramebuffer(Ie.FRAMEBUFFER,Fe),Ie.disable(Ie.BLEND),Ie.colorMask(kt===0,kt===1,kt===2,kt===3),Ie.viewport(ct,At,me,we),Ie.scissor(ct,At,me,we),Ie.drawArrays(Ie.TRIANGLES,0,3)})}),Ie.isContextLost())throw se(),new Error("webgl context lost")})}function Ae(me){var we=!me||me===Y?G:me.canvas||me,re=Q.get(we);if(re===void 0){te=!0;var Te=null;try{var Je=[97,106,97,61,99,137,118,80,80,118,137,99,61,97,106,97],Xe=pe(4,4,"M8,8L16,8L24,24L16,24Z",[0,0,32,32],24,1,me);re=Xe&&Je.length===Xe.length&&Xe.every(function(Ze,Fe){return Ze===Je[Fe]}),re||(Te="bad trial run results",console.info(Je,Xe))}catch(Ze){re=!1,Te=Ze.message}Te&&console.warn("WebGL SDF generation not supported:",Te),te=!1,Q.set(we,re)}return re}var Re=Object.freeze({__proto__:null,generate:pe,generateIntoCanvas:ye,generateIntoFramebuffer:fe,isSupported:Ae});function Be(me,we,re,Te,Je,Xe){Je===void 0&&(Je=Math.max(Te[2]-Te[0],Te[3]-Te[1])/2),Xe===void 0&&(Xe=1);try{return pe.apply(Re,arguments)}catch(Ze){return console.info("WebGL SDF generation failed, falling back to JS",Ze),P.apply(z,arguments)}}function le(me,we,re,Te,Je,Xe,Ze,Fe,ct,At){Je===void 0&&(Je=Math.max(Te[2]-Te[0],Te[3]-Te[1])/2),Xe===void 0&&(Xe=1),Fe===void 0&&(Fe=0),ct===void 0&&(ct=0),At===void 0&&(At=0);try{return ye.apply(Re,arguments)}catch(kt){return console.info("WebGL SDF generation failed, falling back to JS",kt),L.apply(z,arguments)}}return e.forEachPathCommand=s,e.generate=Be,e.generateIntoCanvas=le,e.javascript=z,e.pathToLineSegments=l,e.webgl=Re,e.webglUtils=A,Object.defineProperty(e,"__esModule",{value:!0}),e}({});return n}function nAe(){var n=function(e){var i={R:"13k,1a,2,3,3,2+1j,ch+16,a+1,5+2,2+n,5,a,4,6+16,4+3,h+1b,4mo,179q,2+9,2+11,2i9+7y,2+68,4,3+4,5+13,4+3,2+4k,3+29,8+cf,1t+7z,w+17,3+3m,1t+3z,16o1+5r,8+30,8+mc,29+1r,29+4v,75+73",EN:"1c+9,3d+1,6,187+9,513,4+5,7+9,sf+j,175h+9,qw+q,161f+1d,4xt+a,25i+9",ES:"17,2,6dp+1,f+1,av,16vr,mx+1,4o,2",ET:"z+2,3h+3,b+1,ym,3e+1,2o,p4+1,8,6u,7c,g6,1wc,1n9+4,30+1b,2n,6d,qhx+1,h0m,a+1,49+2,63+1,4+1,6bb+3,12jj",AN:"16o+5,2j+9,2+1,35,ed,1ff2+9,87+u",CS:"18,2+1,b,2u,12k,55v,l,17v0,2,3,53,2+1,b",B:"a,3,f+2,2v,690",S:"9,2,k",WS:"c,k,4f4,1vk+a,u,1j,335",ON:"x+1,4+4,h+5,r+5,r+3,z,5+3,2+1,2+1,5,2+2,3+4,o,w,ci+1,8+d,3+d,6+8,2+g,39+1,9,6+1,2,33,b8,3+1,3c+1,7+1,5r,b,7h+3,sa+5,2,3i+6,jg+3,ur+9,2v,ij+1,9g+9,7+a,8m,4+1,49+x,14u,2+2,c+2,e+2,e+2,e+1,i+n,e+e,2+p,u+2,e+2,36+1,2+3,2+1,b,2+2,6+5,2,2,2,h+1,5+4,6+3,3+f,16+2,5+3l,3+81,1y+p,2+40,q+a,m+13,2r+ch,2+9e,75+hf,3+v,2+2w,6e+5,f+6,75+2a,1a+p,2+2g,d+5x,r+b,6+3,4+o,g,6+1,6+2,2k+1,4,2j,5h+z,1m+1,1e+f,t+2,1f+e,d+3,4o+3,2s+1,w,535+1r,h3l+1i,93+2,2s,b+1,3l+x,2v,4g+3,21+3,kz+1,g5v+1,5a,j+9,n+v,2,3,2+8,2+1,3+2,2,3,46+1,4+4,h+5,r+5,r+a,3h+2,4+6,b+4,78,1r+24,4+c,4,1hb,ey+6,103+j,16j+c,1ux+7,5+g,fsh,jdq+1t,4,57+2e,p1,1m,1m,1m,1m,4kt+1,7j+17,5+2r,d+e,3+e,2+e,2+10,m+4,w,1n+5,1q,4z+5,4b+rb,9+c,4+c,4+37,d+2g,8+b,l+b,5+1j,9+9,7+13,9+t,3+1,27+3c,2+29,2+3q,d+d,3+4,4+2,6+6,a+o,8+6,a+2,e+6,16+42,2+1i",BN:"0+8,6+d,2s+5,2+p,e,4m9,1kt+2,2b+5,5+5,17q9+v,7k,6p+8,6+1,119d+3,440+7,96s+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+75,6p+2rz,1ben+1,1ekf+1,1ekf+1",NSM:"lc+33,7o+6,7c+18,2,2+1,2+1,2,21+a,1d+k,h,2u+6,3+5,3+1,2+3,10,v+q,2k+a,1n+8,a,p+3,2+8,2+2,2+4,18+2,3c+e,2+v,1k,2,5+7,5,4+6,b+1,u,1n,5+3,9,l+1,r,3+1,1m,5+1,5+1,3+2,4,v+1,4,c+1,1m,5+4,2+1,5,l+1,n+5,2,1n,3,2+3,9,8+1,c+1,v,1q,d,1f,4,1m+2,6+2,2+3,8+1,c+1,u,1n,g+1,l+1,t+1,1m+1,5+3,9,l+1,u,21,8+2,2,2j,3+6,d+7,2r,3+8,c+5,23+1,s,2,2,1k+d,2+4,2+1,6+a,2+z,a,2v+3,2+5,2+1,3+1,q+1,5+2,h+3,e,3+1,7,g,jk+2,qb+2,u+2,u+1,v+1,1t+1,2+6,9,3+a,a,1a+2,3c+1,z,3b+2,5+1,a,7+2,64+1,3,1n,2+6,2,2,3+7,7+9,3,1d+g,1s+3,1d,2+4,2,6,15+8,d+1,x+3,3+1,2+2,1l,2+1,4,2+2,1n+7,3+1,49+2,2+c,2+6,5,7,4+1,5j+1l,2+4,k1+w,2db+2,3y,2p+v,ff+3,30+1,n9x+3,2+9,x+1,29+1,7l,4,5,q+1,6,48+1,r+h,e,13+7,q+a,1b+2,1d,3+3,3+1,14,1w+5,3+1,3+1,d,9,1c,1g,2+2,3+1,6+1,2,17+1,9,6n,3,5,fn5,ki+f,h+f,r2,6b,46+4,1af+2,2+1,6+3,15+2,5,4m+1,fy+3,as+1,4a+a,4x,1j+e,1l+2,1e+3,3+1,1y+2,11+4,2+7,1r,d+1,1h+8,b+3,3,2o+2,3,2+1,7,4h,4+7,m+1,1m+1,4,12+6,4+4,5g+7,3+2,2,o,2d+5,2,5+1,2+1,6n+3,7+1,2+1,s+1,2e+7,3,2+1,2z,2,3+5,2,2u+2,3+3,2+4,78+8,2+1,75+1,2,5,41+3,3+1,5,x+5,3+1,15+5,3+3,9,a+5,3+2,1b+c,2+1,bb+6,2+5,2d+l,3+6,2+1,2+1,3f+5,4,2+1,2+6,2,21+1,4,2,9o+1,f0c+4,1o+6,t5,1s+3,2a,f5l+1,43t+2,i+7,3+6,v+3,45+2,1j0+1i,5+1d,9,f,n+4,2+e,11t+6,2+g,3+6,2+1,2+4,7a+6,c6+3,15t+6,32+6,gzhy+6n",AL:"16w,3,2,e+1b,z+2,2+2s,g+1,8+1,b+m,2+t,s+2i,c+e,4h+f,1d+1e,1bwe+dp,3+3z,x+c,2+1,35+3y,2rm+z,5+7,b+5,dt+l,c+u,17nl+27,1t+27,4x+6n,3+d",LRO:"6ct",RLO:"6cu",LRE:"6cq",RLE:"6cr",PDF:"6cs",LRI:"6ee",RLI:"6ef",FSI:"6eg",PDI:"6eh"},a={},s={};a.L=1,s[1]="L",Object.keys(i).forEach(function(se,xe){a[se]=1<<xe+1,s[a[se]]=se}),Object.freeze(a);var l=a.LRI|a.RLI|a.FSI,d=a.L|a.R|a.AL,f=a.B|a.S|a.WS|a.ON|a.FSI|a.LRI|a.RLI|a.PDI,p=a.BN|a.RLE|a.LRE|a.RLO|a.LRO|a.PDF,y=a.S|a.WS|a.B|l|a.PDI|p,_=null;function b(){if(!_){_=new Map;var se=function(Ye){if(i.hasOwnProperty(Ye)){var ze=0;i[Ye].split(",").forEach(function(st){var de=st.split("+"),ie=de[0],Oe=de[1];ie=parseInt(ie,36),Oe=Oe?parseInt(Oe,36):0,_.set(ze+=ie,a[Ye]);for(var ut=0;ut<Oe;ut++)_.set(++ze,a[Ye])})}};for(var xe in i)se(xe)}}function S(se){return b(),_.get(se.codePointAt(0))||a.L}function A(se){return s[S(se)]}var P={pairs:"14>1,1e>2,u>2,2wt>1,1>1,1ge>1,1wp>1,1j>1,f>1,hm>1,1>1,u>1,u6>1,1>1,+5,28>1,w>1,1>1,+3,b8>1,1>1,+3,1>3,-1>-1,3>1,1>1,+2,1s>1,1>1,x>1,th>1,1>1,+2,db>1,1>1,+3,3>1,1>1,+2,14qm>1,1>1,+1,4q>1,1e>2,u>2,2>1,+1",canonical:"6f1>-6dx,6dy>-6dx,6ec>-6ed,6ee>-6ed,6ww>2jj,-2ji>2jj,14r4>-1e7l,1e7m>-1e7l,1e7m>-1e5c,1e5d>-1e5b,1e5c>-14qx,14qy>-14qx,14vn>-1ecg,1ech>-1ecg,1edu>-1ecg,1eci>-1ecg,1eda>-1ecg,1eci>-1ecg,1eci>-168q,168r>-168q,168s>-14ye,14yf>-14ye"};function L(se,xe){var Ye=36,ze=0,st=new Map,de=xe&&new Map,ie;return se.split(",").forEach(function Oe(ut){if(ut.indexOf("+")!==-1)for(var it=+ut;it--;)Oe(ie);else{ie=ut;var lt=ut.split(">"),Mt=lt[0],Ut=lt[1];Mt=String.fromCodePoint(ze+=parseInt(Mt,Ye)),Ut=String.fromCodePoint(ze+=parseInt(Ut,Ye)),st.set(Mt,Ut),xe&&de.set(Ut,Mt)}}),{map:st,reverseMap:de}}var k,R,z;function O(){if(!k){var se=L(P.pairs,!0),xe=se.map,Ye=se.reverseMap;k=xe,R=Ye,z=L(P.canonical,!1).map}}function F(se){return O(),k.get(se)||null}function H(se){return O(),R.get(se)||null}function $(se){return O(),z.get(se)||null}var Y=a.L,te=a.R,G=a.EN,Q=a.ES,he=a.ET,pe=a.AN,ye=a.CS,fe=a.B,Ae=a.S,Re=a.ON,Be=a.BN,le=a.NSM,me=a.AL,we=a.LRO,re=a.RLO,Te=a.LRE,Je=a.RLE,Xe=a.PDF,Ze=a.LRI,Fe=a.RLI,ct=a.FSI,At=a.PDI;function kt(se,xe){for(var Ye=125,ze=new Uint32Array(se.length),st=0;st<se.length;st++)ze[st]=S(se[st]);var de=new Map;function ie(Ua,Dr){var En=ze[Ua];ze[Ua]=Dr,de.set(En,de.get(En)-1),En&f&&de.set(f,de.get(f)-1),de.set(Dr,(de.get(Dr)||0)+1),Dr&f&&de.set(f,(de.get(f)||0)+1)}for(var Oe=new Uint8Array(se.length),ut=new Map,it=[],lt=null,Mt=0;Mt<se.length;Mt++)lt||it.push(lt={start:Mt,end:se.length-1,level:xe==="rtl"?1:xe==="ltr"?0:Cu(Mt,!1)}),ze[Mt]&fe&&(lt.end=Mt,lt=null);for(var Ut=Je|Te|re|we|l|At|Xe|fe,Wt=function(Ua){return Ua+(Ua&1?1:2)},Ht=function(Ua){return Ua+(Ua&1?2:1)},Dt=0;Dt<it.length;Dt++){lt=it[Dt];var wt=[{_level:lt.level,_override:0,_isolate:0}],Xt=void 0,$e=0,Pt=0,qt=0;de.clear();for(var Ot=lt.start;Ot<=lt.end;Ot++){var fn=ze[Ot];if(Xt=wt[wt.length-1],de.set(fn,(de.get(fn)||0)+1),fn&f&&de.set(f,(de.get(f)||0)+1),fn&Ut)if(fn&(Je|Te)){Oe[Ot]=Xt._level;var be=(fn===Je?Ht:Wt)(Xt._level);be<=Ye&&!$e&&!Pt?wt.push({_level:be,_override:0,_isolate:0}):$e||Pt++}else if(fn&(re|we)){Oe[Ot]=Xt._level;var Qe=(fn===re?Ht:Wt)(Xt._level);Qe<=Ye&&!$e&&!Pt?wt.push({_level:Qe,_override:fn&re?te:Y,_isolate:0}):$e||Pt++}else if(fn&l){fn&ct&&(fn=Cu(Ot+1,!0)===1?Fe:Ze),Oe[Ot]=Xt._level,Xt._override&&ie(Ot,Xt._override);var Se=(fn===Fe?Ht:Wt)(Xt._level);Se<=Ye&&$e===0&&Pt===0?(qt++,wt.push({_level:Se,_override:0,_isolate:1,_isolInitIndex:Ot})):$e++}else if(fn&At){if($e>0)$e--;else if(qt>0){for(Pt=0;!wt[wt.length-1]._isolate;)wt.pop();var Ce=wt[wt.length-1]._isolInitIndex;Ce!=null&&(ut.set(Ce,Ot),ut.set(Ot,Ce)),wt.pop(),qt--}Xt=wt[wt.length-1],Oe[Ot]=Xt._level,Xt._override&&ie(Ot,Xt._override)}else fn&Xe?($e===0&&(Pt>0?Pt--:!Xt._isolate&&wt.length>1&&(wt.pop(),Xt=wt[wt.length-1])),Oe[Ot]=Xt._level):fn&fe&&(Oe[Ot]=lt.level);else Oe[Ot]=Xt._level,Xt._override&&fn!==Be&&ie(Ot,Xt._override)}for(var Ne=[],et=null,tt=lt.start;tt<=lt.end;tt++){var vt=ze[tt];if(!(vt&p)){var ht=Oe[tt],dt=vt&l,Vt=vt===At;et&&ht===et._level?(et._end=tt,et._endsWithIsolInit=dt):Ne.push(et={_start:tt,_end:tt,_level:ht,_startsWithPDI:Vt,_endsWithIsolInit:dt})}}for(var It=[],Qt=0;Qt<Ne.length;Qt++){var mn=Ne[Qt];if(!mn._startsWithPDI||mn._startsWithPDI&&!ut.has(mn._start)){for(var en=[et=mn],_n=void 0;et&&et._endsWithIsolInit&&(_n=ut.get(et._end))!=null;)for(var Hn=Qt+1;Hn<Ne.length;Hn++)if(Ne[Hn]._start===_n){en.push(et=Ne[Hn]);break}for(var ni=[],Ei=0;Ei<en.length;Ei++)for(var Mi=en[Ei],gr=Mi._start;gr<=Mi._end;gr++)ni.push(gr);for(var sr=Oe[ni[0]],ke=lt.level,xt=ni[0]-1;xt>=0;xt--)if(!(ze[xt]&p)){ke=Oe[xt];break}var zt=ni[ni.length-1],Rt=Oe[zt],Nt=lt.level;if(!(ze[zt]&l)){for(var jt=zt+1;jt<=lt.end;jt++)if(!(ze[jt]&p)){Nt=Oe[jt];break}}It.push({_seqIndices:ni,_sosType:Math.max(ke,sr)%2?te:Y,_eosType:Math.max(Nt,Rt)%2?te:Y})}}for(var yn=0;yn<It.length;yn++){var Zn=It[yn],on=Zn._seqIndices,pi=Zn._sosType,_i=Zn._eosType,ui=Oe[on[0]]&1?te:Y;if(de.get(le))for(var cr=0;cr<on.length;cr++){var Ea=on[cr];if(ze[Ea]&le){for(var lr=pi,ea=cr-1;ea>=0;ea--)if(!(ze[on[ea]]&p)){lr=ze[on[ea]];break}ie(Ea,lr&(l|At)?Re:lr)}}if(de.get(G))for(var si=0;si<on.length;si++){var Dn=on[si];if(ze[Dn]&G)for(var fo=si-1;fo>=-1;fo--){var Oi=fo===-1?pi:ze[on[fo]];if(Oi&d){Oi===me&&ie(Dn,pe);break}}}if(de.get(me))for(var kr=0;kr<on.length;kr++){var Yo=on[kr];ze[Yo]&me&&ie(Yo,te)}if(de.get(Q)||de.get(ye))for(var Ma=1;Ma<on.length-1;Ma++){var ta=on[Ma];if(ze[ta]&(Q|ye)){for(var yr=0,Fa=0,Pn=Ma-1;Pn>=0&&(yr=ze[on[Pn]],!!(yr&p));Pn--);for(var Qn=Ma+1;Qn<on.length&&(Fa=ze[on[Qn]],!!(Fa&p));Qn++);yr===Fa&&(ze[ta]===Q?yr===G:yr&(G|pe))&&ie(ta,yr)}}if(de.get(G))for(var qr=0;qr<on.length;qr++){var Ta=on[qr];if(ze[Ta]&G){for(var Is=qr-1;Is>=0&&ze[on[Is]]&(he|p);Is--)ie(on[Is],G);for(qr++;qr<on.length&&ze[on[qr]]&(he|p|G);qr++)ze[on[qr]]!==G&&ie(on[qr],G)}}if(de.get(he)||de.get(Q)||de.get(ye))for(var Tu=0;Tu<on.length;Tu++){var Vp=on[Tu];if(ze[Vp]&(he|Q|ye)){ie(Vp,Re);for(var lc=Tu-1;lc>=0&&ze[on[lc]]&p;lc--)ie(on[lc],Re);for(var Rl=Tu+1;Rl<on.length&&ze[on[Rl]]&p;Rl++)ie(on[Rl],Re)}}if(de.get(G))for(var Ll=0,kl=pi;Ll<on.length;Ll++){var Dd=on[Ll],ef=ze[Dd];ef&G?kl===Y&&ie(Dd,Y):ef&d&&(kl=ef)}if(de.get(f)){var cc=te|G|pe,zd=cc|Y,Js=[];{for(var $t=[],bn=0;bn<on.length;bn++)if(ze[on[bn]]&f){var Vn=se[on[bn]],rt=void 0;if(F(Vn)!==null)if($t.length<63)$t.push({char:Vn,seqIndex:bn});else break;else if((rt=H(Vn))!==null)for(var cn=$t.length-1;cn>=0;cn--){var Qs=$t[cn].char;if(Qs===rt||Qs===H($(Vn))||F($(Qs))===Vn){Js.push([$t[cn].seqIndex,bn]),$t.length=cn;break}}}Js.sort(function(Ua,Dr){return Ua[0]-Dr[0]})}for(var Rs=0;Rs<Js.length;Rs++){for(var $r=Js[Rs],ur=$r[0],Od=$r[1],Ls=!1,To=0,Gp=ur+1;Gp<Od;Gp++){var el=on[Gp];if(ze[el]&zd){Ls=!0;var an=ze[el]&cc?te:Y;if(an===ui){To=an;break}}}if(Ls&&!To){To=pi;for(var xi=ur-1;xi>=0;xi--){var Ci=on[xi];if(ze[Ci]&zd){var na=ze[Ci]&cc?te:Y;na!==ui?To=na:To=ui;break}}}if(To){if(ze[on[ur]]=ze[on[Od]]=To,To!==ui){for(var Ba=ur+1;Ba<on.length;Ba++)if(!(ze[on[Ba]]&p)){S(se[on[Ba]])&le&&(ze[on[Ba]]=To);break}}if(To!==ui){for(var li=Od+1;li<on.length;li++)if(!(ze[on[li]]&p)){S(se[on[li]])&le&&(ze[on[li]]=To);break}}}}for(var qo=0;qo<on.length;qo++)if(ze[on[qo]]&f){for(var Bc=qo,Uc=qo,Fr=pi,vr=qo-1;vr>=0;vr--)if(ze[on[vr]]&p)Bc=vr;else{Fr=ze[on[vr]]&cc?te:Y;break}for(var Nd=_i,Dl=qo+1;Dl<on.length;Dl++)if(ze[on[Dl]]&(f|p))Uc=Dl;else{Nd=ze[on[Dl]]&cc?te:Y;break}for(var Ao=Bc;Ao<=Uc;Ao++)ze[on[Ao]]=Fr===Nd?Fr:ui;qo=Uc}}}for(var ga=lt.start;ga<=lt.end;ga++){var Au=Oe[ga],tl=ze[ga];if(Au&1?tl&(Y|G|pe)&&Oe[ga]++:tl&te?Oe[ga]++:tl&(pe|G)&&(Oe[ga]+=2),tl&p&&(Oe[ga]=ga===0?lt.level:Oe[ga-1]),ga===lt.end||S(se[ga])&(Ae|fe))for(var zl=ga;zl>=0&&S(se[zl])&y;zl--)Oe[zl]=lt.level}}return{levels:Oe,paragraphs:it};function Cu(Ua,Dr){for(var En=Ua;En<se.length;En++){var sa=ze[En];if(sa&(te|me))return 1;if(sa&(fe|Y)||Dr&&sa===At)return 0;if(sa&l){var Xo=Fd(En);En=Xo===-1?se.length:Xo}}return 0}function Fd(Ua){for(var Dr=1,En=Ua+1;En<se.length;En++){var sa=ze[En];if(sa&fe)break;if(sa&At){if(--Dr===0)return En}else sa&l&&Dr++}return-1}}var Kt="14>1,j>2,t>2,u>2,1a>g,2v3>1,1>1,1ge>1,1wd>1,b>1,1j>1,f>1,ai>3,-2>3,+1,8>1k0,-1jq>1y7,-1y6>1hf,-1he>1h6,-1h5>1ha,-1h8>1qi,-1pu>1,6>3u,-3s>7,6>1,1>1,f>1,1>1,+2,3>1,1>1,+13,4>1,1>1,6>1eo,-1ee>1,3>1mg,-1me>1mk,-1mj>1mi,-1mg>1mi,-1md>1,1>1,+2,1>10k,-103>1,1>1,4>1,5>1,1>1,+10,3>1,1>8,-7>8,+1,-6>7,+1,a>1,1>1,u>1,u6>1,1>1,+5,26>1,1>1,2>1,2>2,8>1,7>1,4>1,1>1,+5,b8>1,1>1,+3,1>3,-2>1,2>1,1>1,+2,c>1,3>1,1>1,+2,h>1,3>1,a>1,1>1,2>1,3>1,1>1,d>1,f>1,3>1,1a>1,1>1,6>1,7>1,13>1,k>1,1>1,+19,4>1,1>1,+2,2>1,1>1,+18,m>1,a>1,1>1,lk>1,1>1,4>1,2>1,f>1,3>1,1>1,+3,db>1,1>1,+3,3>1,1>1,+2,14qm>1,1>1,+1,6>1,4j>1,j>2,t>2,u>2,2>1,+1",Et;function Ie(){if(!Et){var se=L(Kt,!0),xe=se.map,Ye=se.reverseMap;Ye.forEach(function(ze,st){xe.set(st,ze)}),Et=xe}}function pt(se){return Ie(),Et.get(se)||null}function gt(se,xe,Ye,ze){var st=se.length;Ye=Math.max(0,Ye==null?0:+Ye),ze=Math.min(st-1,ze==null?st-1:+ze);for(var de=new Map,ie=Ye;ie<=ze;ie++)if(xe[ie]&1){var Oe=pt(se[ie]);Oe!==null&&de.set(ie,Oe)}return de}function _t(se,xe,Ye,ze){var st=se.length;Ye=Math.max(0,Ye==null?0:+Ye),ze=Math.min(st-1,ze==null?st-1:+ze);var de=[];return xe.paragraphs.forEach(function(ie){var Oe=Math.max(Ye,ie.start),ut=Math.min(ze,ie.end);if(Oe<ut){for(var it=xe.levels.slice(Oe,ut+1),lt=ut;lt>=Oe&&S(se[lt])&y;lt--)it[lt]=ie.level;for(var Mt=ie.level,Ut=1/0,Wt=0;Wt<it.length;Wt++){var Ht=it[Wt];Ht>Mt&&(Mt=Ht),Ht<Ut&&(Ut=Ht|1)}for(var Dt=Mt;Dt>=Ut;Dt--)for(var wt=0;wt<it.length;wt++)if(it[wt]>=Dt){for(var Xt=wt;wt+1<it.length&&it[wt+1]>=Dt;)wt++;wt>Xt&&de.push([Xt+Oe,wt+Oe])}}}),de}function Ue(se,xe,Ye,ze){var st=ue(se,xe,Ye,ze),de=[].concat(se);return st.forEach(function(ie,Oe){de[Oe]=(xe.levels[ie]&1?pt(se[ie]):null)||se[ie]}),de.join("")}function ue(se,xe,Ye,ze){for(var st=_t(se,xe,Ye,ze),de=[],ie=0;ie<se.length;ie++)de[ie]=ie;return st.forEach(function(Oe){for(var ut=Oe[0],it=Oe[1],lt=de.slice(ut,it+1),Mt=lt.length;Mt--;)de[it-Mt]=lt[Mt]}),de}return e.closingToOpeningBracket=H,e.getBidiCharType=S,e.getBidiCharTypeName=A,e.getCanonicalBracket=$,e.getEmbeddingLevels=kt,e.getMirroredCharacter=pt,e.getMirroredCharactersMap=gt,e.getReorderSegments=_t,e.getReorderedIndices=ue,e.getReorderedString=Ue,e.openingToClosingBracket=F,Object.defineProperty(e,"__esModule",{value:!0}),e}({});return n}const uJ=/\bvoid\s+main\s*\(\s*\)\s*{/g;function tD(n){const e=/^[ \t]*#include +<([\w\d./]+)>/gm;function i(a,s){let l=Bi[s];return l?tD(l):a}return n.replace(e,i)}const Qo=[];for(let n=0;n<256;n++)Qo[n]=(n<16?"0":"")+n.toString(16);function iAe(){const n=Math.random()*4294967295|0,e=Math.random()*4294967295|0,i=Math.random()*4294967295|0,a=Math.random()*4294967295|0;return(Qo[n&255]+Qo[n>>8&255]+Qo[n>>16&255]+Qo[n>>24&255]+"-"+Qo[e&255]+Qo[e>>8&255]+"-"+Qo[e>>16&15|64]+Qo[e>>24&255]+"-"+Qo[i&63|128]+Qo[i>>8&255]+"-"+Qo[i>>16&255]+Qo[i>>24&255]+Qo[a&255]+Qo[a>>8&255]+Qo[a>>16&255]+Qo[a>>24&255]).toUpperCase()}const Jm=Object.assign||function(){let n=arguments[0];for(let e=1,i=arguments.length;e<i;e++){let a=arguments[e];if(a)for(let s in a)Object.prototype.hasOwnProperty.call(a,s)&&(n[s]=a[s])}return n},rAe=Date.now(),RG=new WeakMap,LG=new Map;let aAe=1e10;function nD(n,e){const i=cAe(e);let a=RG.get(n);if(a||RG.set(n,a=Object.create(null)),a[i])return new a[i];const s=`_onBeforeCompile${i}`,l=function(y,_){n.onBeforeCompile.call(this,y,_);const b=this.customProgramCacheKey()+"|"+y.vertexShader+"|"+y.fragmentShader;let S=LG[b];if(!S){const A=oAe(this,y,e,i);S=LG[b]=A}y.vertexShader=S.vertexShader,y.fragmentShader=S.fragmentShader,Jm(y.uniforms,this.uniforms),e.timeUniform&&(y.uniforms[e.timeUniform]={get value(){return Date.now()-rAe}}),this[s]&&this[s](y)},d=function(){return f(e.chained?n:n.clone())},f=function(y){const _=Object.create(y,p);return Object.defineProperty(_,"baseMaterial",{value:n}),Object.defineProperty(_,"id",{value:aAe++}),_.uuid=iAe(),_.uniforms=Jm({},y.uniforms,e.uniforms),_.defines=Jm({},y.defines,e.defines),_.defines[`TROIKA_DERIVED_MATERIAL_${i}`]="",_.extensions=Jm({},y.extensions,e.extensions),_._listeners=void 0,_},p={constructor:{value:d},isDerivedMaterial:{value:!0},customProgramCacheKey:{writable:!0,configurable:!0,value:function(){return n.customProgramCacheKey()+"|"+i}},onBeforeCompile:{get(){return l},set(y){this[s]=y}},copy:{writable:!0,configurable:!0,value:function(y){return n.copy.call(this,y),!n.isShaderMaterial&&!n.isDerivedMaterial&&(Jm(this.extensions,y.extensions),Jm(this.defines,y.defines),Jm(this.uniforms,Tz.clone(y.uniforms))),this}},clone:{writable:!0,configurable:!0,value:function(){const y=new n.constructor;return f(y).copy(this)}},getDepthMaterial:{writable:!0,configurable:!0,value:function(){let y=this._depthMaterial;return y||(y=this._depthMaterial=nD(n.isDerivedMaterial?n.getDepthMaterial():new tC({depthPacking:xz}),e),y.defines.IS_DEPTH_MATERIAL="",y.uniforms=this.uniforms),y}},getDistanceMaterial:{writable:!0,configurable:!0,value:function(){let y=this._distanceMaterial;return y||(y=this._distanceMaterial=nD(n.isDerivedMaterial?n.getDistanceMaterial():new nC,e),y.defines.IS_DISTANCE_MATERIAL="",y.uniforms=this.uniforms),y}},dispose:{writable:!0,configurable:!0,value(){const{_depthMaterial:y,_distanceMaterial:_}=this;y&&y.dispose(),_&&_.dispose(),n.dispose.call(this)}}};return a[i]=d,new d}function oAe(n,{vertexShader:e,fragmentShader:i},a,s){let{vertexDefs:l,vertexMainIntro:d,vertexMainOutro:f,vertexTransform:p,fragmentDefs:y,fragmentMainIntro:_,fragmentMainOutro:b,fragmentColorTransform:S,customRewriter:A,timeUniform:P}=a;if(l=l||"",d=d||"",f=f||"",y=y||"",_=_||"",b=b||"",(p||A)&&(e=tD(e)),(S||A)&&(i=i.replace(/^[ \t]*#include <((?:tonemapping|encodings|fog|premultiplied_alpha|dithering)_fragment)>/gm,`
//!BEGIN_POST_CHUNK $1
$&
//!END_POST_CHUNK
`),i=tD(i)),A){let L=A({vertexShader:e,fragmentShader:i});e=L.vertexShader,i=L.fragmentShader}if(S){let L=[];i=i.replace(/^\/\/!BEGIN_POST_CHUNK[^]+?^\/\/!END_POST_CHUNK/gm,k=>(L.push(k),"")),b=`${S}
${L.join(`
`)}
${b}`}if(P){const L=`
uniform float ${P};
`;l=L+l,y=L+y}return p&&(e=`vec3 troika_position_${s};
vec3 troika_normal_${s};
vec2 troika_uv_${s};
${e}
`,l=`${l}
void troikaVertexTransform${s}(inout vec3 position, inout vec3 normal, inout vec2 uv) {
  ${p}
}
`,d=`
troika_position_${s} = vec3(position);
troika_normal_${s} = vec3(normal);
troika_uv_${s} = vec2(uv);
troikaVertexTransform${s}(troika_position_${s}, troika_normal_${s}, troika_uv_${s});
${d}
`,e=e.replace(/\b(position|normal|uv)\b/g,(L,k,R,z)=>/\battribute\s+vec[23]\s+$/.test(z.substr(0,R))?k:`troika_${k}_${s}`),n.map&&n.map.channel>0||(e=e.replace(/\bMAP_UV\b/g,`troika_uv_${s}`))),e=kG(e,s,l,d,f),i=kG(i,s,y,_,b),{vertexShader:e,fragmentShader:i}}function kG(n,e,i,a,s){return(a||s||i)&&(n=n.replace(uJ,`
${i}
void troikaOrigMain${e}() {`),n+=`
void main() {
  ${a}
  troikaOrigMain${e}();
  ${s}
}`),n}function sAe(n,e){return n==="uniforms"?void 0:typeof e=="function"?e.toString():e}let lAe=0;const DG=new Map;function cAe(n){const e=JSON.stringify(n,sAe);let i=DG.get(e);return i==null&&DG.set(e,i=++lAe),i}function uAe(n,e,i){const{defaultFontURL:a}=i,s=Object.create(null),l=1/0,d=/[\u00AD\u034F\u061C\u115F-\u1160\u17B4-\u17B5\u180B-\u180E\u200B-\u200F\u202A-\u202E\u2060-\u206F\u3164\uFE00-\uFE0F\uFEFF\uFFA0\uFFF0-\uFFF8]/,f="[^\\S\\u00A0]",p=new RegExp(`${f}|[\\-\\u007C\\u00AD\\u2010\\u2012-\\u2014\\u2027\\u2056\\u2E17\\u2E40]`);function y(z,O){function F(){const H=$=>{console.error(`Failure loading font ${z}${z===a?"":"; trying fallback"}`,$),z!==a&&(z=a,F())};try{const $=new XMLHttpRequest;$.open("get",z,!0),$.responseType="arraybuffer",$.onload=function(){if($.status>=400)H(new Error($.statusText));else if($.status>0)try{const Y=n($.response);O(Y)}catch(Y){H(Y)}},$.onerror=H,$.send()}catch($){H($)}}F()}function _(z,O){z||(z=a);let F=s[z];F?F.pending?F.pending.push(O):O(F):(s[z]={pending:[O]},y(z,H=>{let $=s[z].pending;s[z]=H,$.forEach(Y=>Y(H))}))}function b({text:z="",font:O=a,sdfGlyphSize:F=64,fontSize:H=1,letterSpacing:$=0,lineHeight:Y="normal",maxWidth:te=l,direction:G,textAlign:Q="left",textIndent:he=0,whiteSpace:pe="normal",overflowWrap:ye="normal",anchorX:fe=0,anchorY:Ae=0,includeCaretPositions:Re=!1,chunkedBoundsSize:Be=8192,colorRanges:le=null},me,we=!1){const re=L(),Te={fontLoad:0,typesetting:0};z.indexOf("\r")>-1&&(console.info("Typesetter: got text with \\r chars; normalizing to \\n"),z=z.replace(/\r\n/g,`
`).replace(/\r/g,`
`)),H=+H,$=+$,te=+te,Y=Y||"normal",he=+he,_(O,Je=>{const Xe=isFinite(te);let Ze=null,Fe=null,ct=null,At=null,kt=null,Kt=null,Et=null,Ie=0,pt=0,gt=pe!=="nowrap";const{ascender:_t,descender:Ue,unitsPerEm:ue,lineGap:se,capHeight:xe,xHeight:Ye}=Je;Te.fontLoad=L()-re;const ze=L(),st=H/ue;Y==="normal"&&(Y=(_t-Ue+se)/ue),Y=Y*H;const de=(Y-(_t-Ue)*st)/2,ie=-(_t*st+de),Oe=Math.min(Y,(_t-Ue)*st),ut=(_t+Ue)/2*st-Oe/2;let it=he,lt=new k;const Mt=[lt];Je.forEachGlyph(z,H,$,(Ht,Dt,wt)=>{const Xt=z.charAt(wt),$e=Ht.advanceWidth*st,Pt=lt.count;let qt;if("isEmpty"in Ht||(Ht.isWhitespace=!!Xt&&new RegExp(f).test(Xt),Ht.canBreakAfter=!!Xt&&p.test(Xt),Ht.isEmpty=Ht.xMin===Ht.xMax||Ht.yMin===Ht.yMax||d.test(Xt)),!Ht.isWhitespace&&!Ht.isEmpty&&pt++,gt&&Xe&&!Ht.isWhitespace&&Dt+$e+it>te&&Pt){if(lt.glyphAt(Pt-1).glyphObj.canBreakAfter)qt=new k,it=-Dt;else for(let fn=Pt;fn--;)if(fn===0&&ye==="break-word"){qt=new k,it=-Dt;break}else if(lt.glyphAt(fn).glyphObj.canBreakAfter){qt=lt.splitAt(fn+1);const be=qt.glyphAt(0).x;it-=be;for(let Qe=qt.count;Qe--;)qt.glyphAt(Qe).x-=be;break}qt&&(lt.isSoftWrapped=!0,lt=qt,Mt.push(lt),Ie=te)}let Ot=lt.glyphAt(lt.count);Ot.glyphObj=Ht,Ot.x=Dt+it,Ot.width=$e,Ot.charIndex=wt,Xt===`
`&&(lt=new k,Mt.push(lt),it=-(Dt+$e+$*H)+he)}),Mt.forEach(Ht=>{for(let Dt=Ht.count;Dt--;){let{glyphObj:wt,x:Xt,width:$e}=Ht.glyphAt(Dt);if(!wt.isWhitespace){Ht.width=Xt+$e,Ht.width>Ie&&(Ie=Ht.width);return}}});let Ut=0,Wt=0;if(fe&&(typeof fe=="number"?Ut=-fe:typeof fe=="string"&&(Ut=-Ie*(fe==="left"?0:fe==="center"?.5:fe==="right"?1:A(fe)))),Ae){if(typeof Ae=="number")Wt=-Ae;else if(typeof Ae=="string"){let Ht=Mt.length*Y;Wt=Ae==="top"?0:Ae==="top-baseline"?-ie:Ae==="top-cap"?-ie-xe*st:Ae==="top-ex"?-ie-Ye*st:Ae==="middle"?Ht/2:Ae==="bottom"?Ht:Ae==="bottom-baseline"?Ht-de+Ue*st:A(Ae)*Ht}}if(!we){const Ht=e.getEmbeddingLevels(z,G);Ze=new Uint16Array(pt),Fe=new Float32Array(pt*2),ct={},Kt=[l,l,-l,-l],Et=[];let Dt=ie;Re&&(kt=new Float32Array(z.length*3)),le&&(At=new Uint8Array(pt*3));let wt=0,Xt=-1,$e=-1,Pt,qt;if(Mt.forEach((Ot,fn)=>{let{count:be,width:Qe}=Ot;if(be>0){let Se=0;for(let ht=be;ht--&&Ot.glyphAt(ht).glyphObj.isWhitespace;)Se++;let Ce=0,Ne=0;if(Q==="center")Ce=(Ie-Qe)/2;else if(Q==="right")Ce=Ie-Qe;else if(Q==="justify"&&Ot.isSoftWrapped){let ht=0;for(let dt=be-Se;dt--;)Ot.glyphAt(dt).glyphObj.isWhitespace&&ht++;Ne=(Ie-Qe)/ht}if(Ne||Ce){let ht=0;for(let dt=0;dt<be;dt++){let Vt=Ot.glyphAt(dt);const It=Vt.glyphObj;Vt.x+=Ce+ht,Ne!==0&&It.isWhitespace&&dt<be-Se&&(ht+=Ne,Vt.width+=Ne)}}const et=e.getReorderSegments(z,Ht,Ot.glyphAt(0).charIndex,Ot.glyphAt(Ot.count-1).charIndex);for(let ht=0;ht<et.length;ht++){const[dt,Vt]=et[ht];let It=1/0,Qt=-1/0;for(let mn=0;mn<be;mn++)if(Ot.glyphAt(mn).charIndex>=dt){let en=mn,_n=mn;for(;_n<be;_n++){let Hn=Ot.glyphAt(_n);if(Hn.charIndex>Vt)break;_n<be-Se&&(It=Math.min(It,Hn.x),Qt=Math.max(Qt,Hn.x+Hn.width))}for(let Hn=en;Hn<_n;Hn++){const ni=Ot.glyphAt(Hn);ni.x=Qt-(ni.x+ni.width-It)}break}}let tt;const vt=ht=>tt=ht;for(let ht=0;ht<be;ht++){let dt=Ot.glyphAt(ht);tt=dt.glyphObj;const Vt=tt.index,It=Ht.levels[dt.charIndex]&1;if(It){const Qt=e.getMirroredCharacter(z[dt.charIndex]);Qt&&Je.forEachGlyph(Qt,0,0,vt)}if(Re){const{charIndex:Qt}=dt,mn=dt.x+Ut,en=dt.x+dt.width+Ut;kt[Qt*3]=It?en:mn,kt[Qt*3+1]=It?mn:en,kt[Qt*3+2]=Dt+ut+Wt;const _n=Qt-Xt;_n>1&&P(kt,Xt,_n),Xt=Qt}if(le){const{charIndex:Qt}=dt;for(;Qt>$e;)$e++,le.hasOwnProperty($e)&&(qt=le[$e])}if(!tt.isWhitespace&&!tt.isEmpty){const Qt=wt++;ct[Vt]||(ct[Vt]={path:tt.path,pathBounds:[tt.xMin,tt.yMin,tt.xMax,tt.yMax]});const mn=dt.x+Ut,en=Dt+Wt;Fe[Qt*2]=mn,Fe[Qt*2+1]=en;const _n=mn+tt.xMin*st,Hn=en+tt.yMin*st,ni=mn+tt.xMax*st,Ei=en+tt.yMax*st;_n<Kt[0]&&(Kt[0]=_n),Hn<Kt[1]&&(Kt[1]=Hn),ni>Kt[2]&&(Kt[2]=ni),Ei>Kt[3]&&(Kt[3]=Ei),Qt%Be===0&&(Pt={start:Qt,end:Qt,rect:[l,l,-l,-l]},Et.push(Pt)),Pt.end++;const Mi=Pt.rect;if(_n<Mi[0]&&(Mi[0]=_n),Hn<Mi[1]&&(Mi[1]=Hn),ni>Mi[2]&&(Mi[2]=ni),Ei>Mi[3]&&(Mi[3]=Ei),Ze[Qt]=Vt,le){const gr=Qt*3;At[gr]=qt>>16&255,At[gr+1]=qt>>8&255,At[gr+2]=qt&255}}}}Dt-=Y}),kt){const Ot=z.length-Xt;Ot>1&&P(kt,Xt,Ot)}}Te.typesetting=L()-ze,me({glyphIds:Ze,glyphPositions:Fe,glyphData:ct,caretPositions:kt,caretHeight:Oe,glyphColors:At,chunkedBounds:Et,fontSize:H,unitsPerEm:ue,ascender:_t*st,descender:Ue*st,capHeight:xe*st,xHeight:Ye*st,lineHeight:Y,topBaseline:ie,blockBounds:[Ut,Wt-Mt.length*Y,Ut+Ie,Wt],visibleBounds:Kt,timings:Te})})}function S(z,O){b(z,F=>{const[H,$,Y,te]=F.blockBounds;O({width:Y-H,height:te-$})},{metricsOnly:!0})}function A(z){let O=z.match(/^([\d.]+)%$/),F=O?parseFloat(O[1]):NaN;return isNaN(F)?0:F/100}function P(z,O,F){const H=z[O*3],$=z[O*3+1],Y=z[O*3+2],te=($-H)/F;for(let G=0;G<F;G++){const Q=(O+G)*3;z[Q]=H+te*G,z[Q+1]=H+te*(G+1),z[Q+2]=Y}}function L(){return(self.performance||Date).now()}function k(){this.data=[]}const R=["glyphObj","x","width","charIndex"];return k.prototype={width:0,isSoftWrapped:!1,get count(){return Math.ceil(this.data.length/R.length)},glyphAt(z){let O=k.flyweight;return O.data=this.data,O.index=z,O},splitAt(z){let O=new k;return O.data=this.data.splice(z*R.length),O}},k.flyweight=R.reduce((z,O,F,H)=>(Object.defineProperty(z,O,{get(){return this.data[this.index*R.length+F]},set($){this.data[this.index*R.length+F]=$}}),z),{data:null,index:0}),{typeset:b,measure:S,loadFont:_}}const kg=()=>(self.performance||Date).now(),SC=cJ();let zG;function dAe(n,e,i,a,s,l,d,f,p,y,_=!0){return _?fAe(n,e,i,a,s,l,d,f,p,y).then(null,b=>(zG||(console.warn("WebGL SDF generation failed, falling back to JS",b),zG=!0),NG(n,e,i,a,s,l,d,f,p,y))):NG(n,e,i,a,s,l,d,f,p,y)}const bM=[],hAe=5;let iD=0;function dJ(){const n=kg();for(;bM.length&&kg()-n<hAe;)bM.shift()();iD=bM.length?setTimeout(dJ,0):0}const fAe=(...n)=>new Promise((e,i)=>{bM.push(()=>{const a=kg();try{SC.webgl.generateIntoCanvas(...n),e({timing:kg()-a})}catch(s){i(s)}}),iD||(iD=setTimeout(dJ,0))}),pAe=4,mAe=2e3,OG={};let gAe=0;function NG(n,e,i,a,s,l,d,f,p,y){const _="TroikaTextSDFGenerator_JS_"+gAe++%pAe;let b=OG[_];return b||(b=OG[_]={workerModule:cS({name:_,workerId:_,dependencies:[cJ,kg],init(S,A){const P=S().javascript.generate;return function(...L){const k=A();return{textureData:P(...L),timing:A()-k}}},getTransferables(S){return[S.textureData.buffer]}}),requests:0,idleTimer:null}),b.requests++,clearTimeout(b.idleTimer),b.workerModule(n,e,i,a,s,l).then(({textureData:S,timing:A})=>{const P=kg(),L=new Uint8Array(S.length*4);for(let k=0;k<S.length;k++)L[k*4+y]=S[k];return SC.webglUtils.renderImageData(d,L,f,p,n,e,1<<3-y),A+=kg()-P,--b.requests===0&&(b.idleTimer=setTimeout(()=>{eAe(_)},mAe)),{timing:A}})}function yAe(n){n._warm||(SC.webgl.isSupported(n),n._warm=!0)}const vAe=SC.webglUtils.resizeWebGLCanvasWithoutClearing;/*!
Custom build of Typr.ts (https://github.com/fredli74/Typr.ts) for use in Troika text rendering.
Original MIT license applies: https://github.com/fredli74/Typr.ts/blob/master/LICENSE
*/function _Ae(){return typeof window>"u"&&(self.window=self),function(n){var e={parse:function(s){var l=e._bin,d=new Uint8Array(s);if(l.readASCII(d,0,4)=="ttcf"){var f=4;l.readUshort(d,f),f+=2,l.readUshort(d,f),f+=2;var p=l.readUint(d,f);f+=4;for(var y=[],_=0;_<p;_++){var b=l.readUint(d,f);f+=4,y.push(e._readFont(d,b))}return y}return[e._readFont(d,0)]},_readFont:function(s,l){var d=e._bin,f=l;d.readFixed(s,l),l+=4;var p=d.readUshort(s,l);l+=2,d.readUshort(s,l),l+=2,d.readUshort(s,l),l+=2,d.readUshort(s,l),l+=2;for(var y=["cmap","head","hhea","maxp","hmtx","name","OS/2","post","loca","glyf","kern","CFF ","GPOS","GSUB","SVG "],_={_data:s,_offset:f},b={},S=0;S<p;S++){var A=d.readASCII(s,l,4);l+=4,d.readUint(s,l),l+=4;var P=d.readUint(s,l);l+=4;var L=d.readUint(s,l);l+=4,b[A]={offset:P,length:L}}for(S=0;S<y.length;S++){var k=y[S];b[k]&&(_[k.trim()]=e[k.trim()].parse(s,b[k].offset,b[k].length,_))}return _},_tabOffset:function(s,l,d){for(var f=e._bin,p=f.readUshort(s,d+4),y=d+12,_=0;_<p;_++){var b=f.readASCII(s,y,4);y+=4,f.readUint(s,y),y+=4;var S=f.readUint(s,y);if(y+=4,f.readUint(s,y),y+=4,b==l)return S}return 0}};e._bin={readFixed:function(s,l){return(s[l]<<8|s[l+1])+(s[l+2]<<8|s[l+3])/65540},readF2dot14:function(s,l){return e._bin.readShort(s,l)/16384},readInt:function(s,l){return e._bin._view(s).getInt32(l)},readInt8:function(s,l){return e._bin._view(s).getInt8(l)},readShort:function(s,l){return e._bin._view(s).getInt16(l)},readUshort:function(s,l){return e._bin._view(s).getUint16(l)},readUshorts:function(s,l,d){for(var f=[],p=0;p<d;p++)f.push(e._bin.readUshort(s,l+2*p));return f},readUint:function(s,l){return e._bin._view(s).getUint32(l)},readUint64:function(s,l){return 4294967296*e._bin.readUint(s,l)+e._bin.readUint(s,l+4)},readASCII:function(s,l,d){for(var f="",p=0;p<d;p++)f+=String.fromCharCode(s[l+p]);return f},readUnicode:function(s,l,d){for(var f="",p=0;p<d;p++){var y=s[l++]<<8|s[l++];f+=String.fromCharCode(y)}return f},_tdec:typeof window<"u"&&window.TextDecoder?new window.TextDecoder:null,readUTF8:function(s,l,d){var f=e._bin._tdec;return f&&l==0&&d==s.length?f.decode(s):e._bin.readASCII(s,l,d)},readBytes:function(s,l,d){for(var f=[],p=0;p<d;p++)f.push(s[l+p]);return f},readASCIIArray:function(s,l,d){for(var f=[],p=0;p<d;p++)f.push(String.fromCharCode(s[l+p]));return f},_view:function(s){return s._dataView||(s._dataView=s.buffer?new DataView(s.buffer,s.byteOffset,s.byteLength):new DataView(new Uint8Array(s).buffer))}},e._lctf={},e._lctf.parse=function(s,l,d,f,p){var y=e._bin,_={},b=l;y.readFixed(s,l),l+=4;var S=y.readUshort(s,l);l+=2;var A=y.readUshort(s,l);l+=2;var P=y.readUshort(s,l);return l+=2,_.scriptList=e._lctf.readScriptList(s,b+S),_.featureList=e._lctf.readFeatureList(s,b+A),_.lookupList=e._lctf.readLookupList(s,b+P,p),_},e._lctf.readLookupList=function(s,l,d){var f=e._bin,p=l,y=[],_=f.readUshort(s,l);l+=2;for(var b=0;b<_;b++){var S=f.readUshort(s,l);l+=2;var A=e._lctf.readLookupTable(s,p+S,d);y.push(A)}return y},e._lctf.readLookupTable=function(s,l,d){var f=e._bin,p=l,y={tabs:[]};y.ltype=f.readUshort(s,l),l+=2,y.flag=f.readUshort(s,l),l+=2;var _=f.readUshort(s,l);l+=2;for(var b=y.ltype,S=0;S<_;S++){var A=f.readUshort(s,l);l+=2;var P=d(s,b,p+A,y);y.tabs.push(P)}return y},e._lctf.numOfOnes=function(s){for(var l=0,d=0;d<32;d++)s>>>d&1&&l++;return l},e._lctf.readClassDef=function(s,l){var d=e._bin,f=[],p=d.readUshort(s,l);if(l+=2,p==1){var y=d.readUshort(s,l);l+=2;var _=d.readUshort(s,l);l+=2;for(var b=0;b<_;b++)f.push(y+b),f.push(y+b),f.push(d.readUshort(s,l)),l+=2}if(p==2){var S=d.readUshort(s,l);for(l+=2,b=0;b<S;b++)f.push(d.readUshort(s,l)),l+=2,f.push(d.readUshort(s,l)),l+=2,f.push(d.readUshort(s,l)),l+=2}return f},e._lctf.getInterval=function(s,l){for(var d=0;d<s.length;d+=3){var f=s[d],p=s[d+1];if(s[d+2],f<=l&&l<=p)return d}return-1},e._lctf.readCoverage=function(s,l){var d=e._bin,f={};f.fmt=d.readUshort(s,l),l+=2;var p=d.readUshort(s,l);return l+=2,f.fmt==1&&(f.tab=d.readUshorts(s,l,p)),f.fmt==2&&(f.tab=d.readUshorts(s,l,3*p)),f},e._lctf.coverageIndex=function(s,l){var d=s.tab;if(s.fmt==1)return d.indexOf(l);if(s.fmt==2){var f=e._lctf.getInterval(d,l);if(f!=-1)return d[f+2]+(l-d[f])}return-1},e._lctf.readFeatureList=function(s,l){var d=e._bin,f=l,p=[],y=d.readUshort(s,l);l+=2;for(var _=0;_<y;_++){var b=d.readASCII(s,l,4);l+=4;var S=d.readUshort(s,l);l+=2;var A=e._lctf.readFeatureTable(s,f+S);A.tag=b.trim(),p.push(A)}return p},e._lctf.readFeatureTable=function(s,l){var d=e._bin,f=l,p={},y=d.readUshort(s,l);l+=2,y>0&&(p.featureParams=f+y);var _=d.readUshort(s,l);l+=2,p.tab=[];for(var b=0;b<_;b++)p.tab.push(d.readUshort(s,l+2*b));return p},e._lctf.readScriptList=function(s,l){var d=e._bin,f=l,p={},y=d.readUshort(s,l);l+=2;for(var _=0;_<y;_++){var b=d.readASCII(s,l,4);l+=4;var S=d.readUshort(s,l);l+=2,p[b.trim()]=e._lctf.readScriptTable(s,f+S)}return p},e._lctf.readScriptTable=function(s,l){var d=e._bin,f=l,p={},y=d.readUshort(s,l);l+=2,p.default=e._lctf.readLangSysTable(s,f+y);var _=d.readUshort(s,l);l+=2;for(var b=0;b<_;b++){var S=d.readASCII(s,l,4);l+=4;var A=d.readUshort(s,l);l+=2,p[S.trim()]=e._lctf.readLangSysTable(s,f+A)}return p},e._lctf.readLangSysTable=function(s,l){var d=e._bin,f={};d.readUshort(s,l),l+=2,f.reqFeature=d.readUshort(s,l),l+=2;var p=d.readUshort(s,l);return l+=2,f.features=d.readUshorts(s,l,p),f},e.CFF={},e.CFF.parse=function(s,l,d){var f=e._bin;(s=new Uint8Array(s.buffer,l,d))[l=0],s[++l],s[++l],s[++l],l++;var p=[];l=e.CFF.readIndex(s,l,p);for(var y=[],_=0;_<p.length-1;_++)y.push(f.readASCII(s,l+p[_],p[_+1]-p[_]));l+=p[p.length-1];var b=[];l=e.CFF.readIndex(s,l,b);var S=[];for(_=0;_<b.length-1;_++)S.push(e.CFF.readDict(s,l+b[_],l+b[_+1]));l+=b[b.length-1];var A=S[0],P=[];l=e.CFF.readIndex(s,l,P);var L=[];for(_=0;_<P.length-1;_++)L.push(f.readASCII(s,l+P[_],P[_+1]-P[_]));if(l+=P[P.length-1],e.CFF.readSubrs(s,l,A),A.CharStrings){l=A.CharStrings,P=[],l=e.CFF.readIndex(s,l,P);var k=[];for(_=0;_<P.length-1;_++)k.push(f.readBytes(s,l+P[_],P[_+1]-P[_]));A.CharStrings=k}if(A.ROS){l=A.FDArray;var R=[];for(l=e.CFF.readIndex(s,l,R),A.FDArray=[],_=0;_<R.length-1;_++){var z=e.CFF.readDict(s,l+R[_],l+R[_+1]);e.CFF._readFDict(s,z,L),A.FDArray.push(z)}l+=R[R.length-1],l=A.FDSelect,A.FDSelect=[];var O=s[l];if(l++,O!=3)throw O;var F=f.readUshort(s,l);for(l+=2,_=0;_<F+1;_++)A.FDSelect.push(f.readUshort(s,l),s[l+2]),l+=3}return A.Encoding&&(A.Encoding=e.CFF.readEncoding(s,A.Encoding,A.CharStrings.length)),A.charset&&(A.charset=e.CFF.readCharset(s,A.charset,A.CharStrings.length)),e.CFF._readFDict(s,A,L),A},e.CFF._readFDict=function(s,l,d){var f;for(var p in l.Private&&(f=l.Private[1],l.Private=e.CFF.readDict(s,f,f+l.Private[0]),l.Private.Subrs&&e.CFF.readSubrs(s,f+l.Private.Subrs,l.Private)),l)["FamilyName","FontName","FullName","Notice","version","Copyright"].indexOf(p)!=-1&&(l[p]=d[l[p]-426+35])},e.CFF.readSubrs=function(s,l,d){var f=e._bin,p=[];l=e.CFF.readIndex(s,l,p);var y,_=p.length;y=_<1240?107:_<33900?1131:32768,d.Bias=y,d.Subrs=[];for(var b=0;b<p.length-1;b++)d.Subrs.push(f.readBytes(s,l+p[b],p[b+1]-p[b]))},e.CFF.tableSE=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,0,111,112,113,114,0,115,116,117,118,119,120,121,122,0,123,0,124,125,126,127,128,129,130,131,0,132,133,0,134,135,136,137,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,138,0,139,0,0,0,0,140,141,142,143,0,0,0,0,0,144,0,0,0,145,0,0,146,147,148,149,0,0,0,0],e.CFF.glyphByUnicode=function(s,l){for(var d=0;d<s.charset.length;d++)if(s.charset[d]==l)return d;return-1},e.CFF.glyphBySE=function(s,l){return l<0||l>255?-1:e.CFF.glyphByUnicode(s,e.CFF.tableSE[l])},e.CFF.readEncoding=function(s,l,d){e._bin;var f=[".notdef"],p=s[l];if(l++,p!=0)throw"error: unknown encoding format: "+p;var y=s[l];l++;for(var _=0;_<y;_++)f.push(s[l+_]);return f},e.CFF.readCharset=function(s,l,d){var f=e._bin,p=[".notdef"],y=s[l];if(l++,y==0)for(var _=0;_<d;_++){var b=f.readUshort(s,l);l+=2,p.push(b)}else{if(y!=1&&y!=2)throw"error: format: "+y;for(;p.length<d;){b=f.readUshort(s,l),l+=2;var S=0;for(y==1?(S=s[l],l++):(S=f.readUshort(s,l),l+=2),_=0;_<=S;_++)p.push(b),b++}}return p},e.CFF.readIndex=function(s,l,d){var f=e._bin,p=f.readUshort(s,l)+1,y=s[l+=2];if(l++,y==1)for(var _=0;_<p;_++)d.push(s[l+_]);else if(y==2)for(_=0;_<p;_++)d.push(f.readUshort(s,l+2*_));else if(y==3)for(_=0;_<p;_++)d.push(16777215&f.readUint(s,l+3*_-1));else if(p!=1)throw"unsupported offset size: "+y+", count: "+p;return(l+=p*y)-1},e.CFF.getCharString=function(s,l,d){var f=e._bin,p=s[l],y=s[l+1];s[l+2],s[l+3],s[l+4];var _=1,b=null,S=null;p<=20&&(b=p,_=1),p==12&&(b=100*p+y,_=2),21<=p&&p<=27&&(b=p,_=1),p==28&&(S=f.readShort(s,l+1),_=3),29<=p&&p<=31&&(b=p,_=1),32<=p&&p<=246&&(S=p-139,_=1),247<=p&&p<=250&&(S=256*(p-247)+y+108,_=2),251<=p&&p<=254&&(S=256*-(p-251)-y-108,_=2),p==255&&(S=f.readInt(s,l+1)/65535,_=5),d.val=S??"o"+b,d.size=_},e.CFF.readCharString=function(s,l,d){for(var f=l+d,p=e._bin,y=[];l<f;){var _=s[l],b=s[l+1];s[l+2],s[l+3],s[l+4];var S=1,A=null,P=null;_<=20&&(A=_,S=1),_==12&&(A=100*_+b,S=2),_!=19&&_!=20||(A=_,S=2),21<=_&&_<=27&&(A=_,S=1),_==28&&(P=p.readShort(s,l+1),S=3),29<=_&&_<=31&&(A=_,S=1),32<=_&&_<=246&&(P=_-139,S=1),247<=_&&_<=250&&(P=256*(_-247)+b+108,S=2),251<=_&&_<=254&&(P=256*-(_-251)-b-108,S=2),_==255&&(P=p.readInt(s,l+1)/65535,S=5),y.push(P??"o"+A),l+=S}return y},e.CFF.readDict=function(s,l,d){for(var f=e._bin,p={},y=[];l<d;){var _=s[l],b=s[l+1];s[l+2],s[l+3],s[l+4];var S=1,A=null,P=null;if(_==28&&(P=f.readShort(s,l+1),S=3),_==29&&(P=f.readInt(s,l+1),S=5),32<=_&&_<=246&&(P=_-139,S=1),247<=_&&_<=250&&(P=256*(_-247)+b+108,S=2),251<=_&&_<=254&&(P=256*-(_-251)-b-108,S=2),_==255)throw P=f.readInt(s,l+1)/65535,S=5,"unknown number";if(_==30){var L=[];for(S=1;;){var k=s[l+S];S++;var R=k>>4,z=15&k;if(R!=15&&L.push(R),z!=15&&L.push(z),z==15)break}for(var O="",F=[0,1,2,3,4,5,6,7,8,9,".","e","e-","reserved","-","endOfNumber"],H=0;H<L.length;H++)O+=F[L[H]];P=parseFloat(O)}_<=21&&(A=["version","Notice","FullName","FamilyName","Weight","FontBBox","BlueValues","OtherBlues","FamilyBlues","FamilyOtherBlues","StdHW","StdVW","escape","UniqueID","XUID","charset","Encoding","CharStrings","Private","Subrs","defaultWidthX","nominalWidthX"][_],S=1,_==12&&(A=["Copyright","isFixedPitch","ItalicAngle","UnderlinePosition","UnderlineThickness","PaintType","CharstringType","FontMatrix","StrokeWidth","BlueScale","BlueShift","BlueFuzz","StemSnapH","StemSnapV","ForceBold",0,0,"LanguageGroup","ExpansionFactor","initialRandomSeed","SyntheticBase","PostScript","BaseFontName","BaseFontBlend",0,0,0,0,0,0,"ROS","CIDFontVersion","CIDFontRevision","CIDFontType","CIDCount","UIDBase","FDArray","FDSelect","FontName"][b],S=2)),A!=null?(p[A]=y.length==1?y[0]:y,y=[]):y.push(P),l+=S}return p},e.cmap={},e.cmap.parse=function(s,l,d){s=new Uint8Array(s.buffer,l,d),l=0;var f=e._bin,p={};f.readUshort(s,l),l+=2;var y=f.readUshort(s,l);l+=2;var _=[];p.tables=[];for(var b=0;b<y;b++){var S=f.readUshort(s,l);l+=2;var A=f.readUshort(s,l);l+=2;var P=f.readUint(s,l);l+=4;var L="p"+S+"e"+A,k=_.indexOf(P);if(k==-1){var R;k=p.tables.length,_.push(P);var z=f.readUshort(s,P);z==0?R=e.cmap.parse0(s,P):z==4?R=e.cmap.parse4(s,P):z==6?R=e.cmap.parse6(s,P):z==12?R=e.cmap.parse12(s,P):console.debug("unknown format: "+z,S,A,P),p.tables.push(R)}if(p[L]!=null)throw"multiple tables for one platform+encoding";p[L]=k}return p},e.cmap.parse0=function(s,l){var d=e._bin,f={};f.format=d.readUshort(s,l),l+=2;var p=d.readUshort(s,l);l+=2,d.readUshort(s,l),l+=2,f.map=[];for(var y=0;y<p-6;y++)f.map.push(s[l+y]);return f},e.cmap.parse4=function(s,l){var d=e._bin,f=l,p={};p.format=d.readUshort(s,l),l+=2;var y=d.readUshort(s,l);l+=2,d.readUshort(s,l),l+=2;var _=d.readUshort(s,l);l+=2;var b=_/2;p.searchRange=d.readUshort(s,l),l+=2,p.entrySelector=d.readUshort(s,l),l+=2,p.rangeShift=d.readUshort(s,l),l+=2,p.endCount=d.readUshorts(s,l,b),l+=2*b,l+=2,p.startCount=d.readUshorts(s,l,b),l+=2*b,p.idDelta=[];for(var S=0;S<b;S++)p.idDelta.push(d.readShort(s,l)),l+=2;for(p.idRangeOffset=d.readUshorts(s,l,b),l+=2*b,p.glyphIdArray=[];l<f+y;)p.glyphIdArray.push(d.readUshort(s,l)),l+=2;return p},e.cmap.parse6=function(s,l){var d=e._bin,f={};f.format=d.readUshort(s,l),l+=2,d.readUshort(s,l),l+=2,d.readUshort(s,l),l+=2,f.firstCode=d.readUshort(s,l),l+=2;var p=d.readUshort(s,l);l+=2,f.glyphIdArray=[];for(var y=0;y<p;y++)f.glyphIdArray.push(d.readUshort(s,l)),l+=2;return f},e.cmap.parse12=function(s,l){var d=e._bin,f={};f.format=d.readUshort(s,l),l+=2,l+=2,d.readUint(s,l),l+=4,d.readUint(s,l),l+=4;var p=d.readUint(s,l);l+=4,f.groups=[];for(var y=0;y<p;y++){var _=l+12*y,b=d.readUint(s,_+0),S=d.readUint(s,_+4),A=d.readUint(s,_+8);f.groups.push([b,S,A])}return f},e.glyf={},e.glyf.parse=function(s,l,d,f){for(var p=[],y=0;y<f.maxp.numGlyphs;y++)p.push(null);return p},e.glyf._parseGlyf=function(s,l){var d=e._bin,f=s._data,p=e._tabOffset(f,"glyf",s._offset)+s.loca[l];if(s.loca[l]==s.loca[l+1])return null;var y={};if(y.noc=d.readShort(f,p),p+=2,y.xMin=d.readShort(f,p),p+=2,y.yMin=d.readShort(f,p),p+=2,y.xMax=d.readShort(f,p),p+=2,y.yMax=d.readShort(f,p),p+=2,y.xMin>=y.xMax||y.yMin>=y.yMax)return null;if(y.noc>0){y.endPts=[];for(var _=0;_<y.noc;_++)y.endPts.push(d.readUshort(f,p)),p+=2;var b=d.readUshort(f,p);if(p+=2,f.length-p<b)return null;y.instructions=d.readBytes(f,p,b),p+=b;var S=y.endPts[y.noc-1]+1;for(y.flags=[],_=0;_<S;_++){var A=f[p];if(p++,y.flags.push(A),(8&A)!=0){var P=f[p];p++;for(var L=0;L<P;L++)y.flags.push(A),_++}}for(y.xs=[],_=0;_<S;_++){var k=(2&y.flags[_])!=0,R=(16&y.flags[_])!=0;k?(y.xs.push(R?f[p]:-f[p]),p++):R?y.xs.push(0):(y.xs.push(d.readShort(f,p)),p+=2)}for(y.ys=[],_=0;_<S;_++)k=(4&y.flags[_])!=0,R=(32&y.flags[_])!=0,k?(y.ys.push(R?f[p]:-f[p]),p++):R?y.ys.push(0):(y.ys.push(d.readShort(f,p)),p+=2);var z=0,O=0;for(_=0;_<S;_++)z+=y.xs[_],O+=y.ys[_],y.xs[_]=z,y.ys[_]=O}else{var F;y.parts=[];do{F=d.readUshort(f,p),p+=2;var H={m:{a:1,b:0,c:0,d:1,tx:0,ty:0},p1:-1,p2:-1};if(y.parts.push(H),H.glyphIndex=d.readUshort(f,p),p+=2,1&F){var $=d.readShort(f,p);p+=2;var Y=d.readShort(f,p);p+=2}else $=d.readInt8(f,p),p++,Y=d.readInt8(f,p),p++;2&F?(H.m.tx=$,H.m.ty=Y):(H.p1=$,H.p2=Y),8&F?(H.m.a=H.m.d=d.readF2dot14(f,p),p+=2):64&F?(H.m.a=d.readF2dot14(f,p),p+=2,H.m.d=d.readF2dot14(f,p),p+=2):128&F&&(H.m.a=d.readF2dot14(f,p),p+=2,H.m.b=d.readF2dot14(f,p),p+=2,H.m.c=d.readF2dot14(f,p),p+=2,H.m.d=d.readF2dot14(f,p),p+=2)}while(32&F);if(256&F){var te=d.readUshort(f,p);for(p+=2,y.instr=[],_=0;_<te;_++)y.instr.push(f[p]),p++}}return y},e.GPOS={},e.GPOS.parse=function(s,l,d,f){return e._lctf.parse(s,l,d,f,e.GPOS.subt)},e.GPOS.subt=function(s,l,d,f){var p=e._bin,y=d,_={};if(_.fmt=p.readUshort(s,d),d+=2,l==1||l==2||l==3||l==7||l==8&&_.fmt<=2){var b=p.readUshort(s,d);d+=2,_.coverage=e._lctf.readCoverage(s,b+y)}if(l==1&&_.fmt==1){var S=p.readUshort(s,d);d+=2;var A=e._lctf.numOfOnes(S);S!=0&&(_.pos=e.GPOS.readValueRecord(s,d,S))}else if(l==2&&_.fmt>=1&&_.fmt<=2){S=p.readUshort(s,d),d+=2;var P=p.readUshort(s,d);d+=2,A=e._lctf.numOfOnes(S);var L=e._lctf.numOfOnes(P);if(_.fmt==1){_.pairsets=[];var k=p.readUshort(s,d);d+=2;for(var R=0;R<k;R++){var z=y+p.readUshort(s,d);d+=2;var O=p.readUshort(s,z);z+=2;for(var F=[],H=0;H<O;H++){var $=p.readUshort(s,z);z+=2,S!=0&&(pe=e.GPOS.readValueRecord(s,z,S),z+=2*A),P!=0&&(ye=e.GPOS.readValueRecord(s,z,P),z+=2*L),F.push({gid2:$,val1:pe,val2:ye})}_.pairsets.push(F)}}if(_.fmt==2){var Y=p.readUshort(s,d);d+=2;var te=p.readUshort(s,d);d+=2;var G=p.readUshort(s,d);d+=2;var Q=p.readUshort(s,d);for(d+=2,_.classDef1=e._lctf.readClassDef(s,y+Y),_.classDef2=e._lctf.readClassDef(s,y+te),_.matrix=[],R=0;R<G;R++){var he=[];for(H=0;H<Q;H++){var pe=null,ye=null;S!=0&&(pe=e.GPOS.readValueRecord(s,d,S),d+=2*A),P!=0&&(ye=e.GPOS.readValueRecord(s,d,P),d+=2*L),he.push({val1:pe,val2:ye})}_.matrix.push(he)}}}else{if(l==9&&_.fmt==1){var fe=p.readUshort(s,d);d+=2;var Ae=p.readUint(s,d);if(d+=4,f.ltype==9)f.ltype=fe;else if(f.ltype!=fe)throw"invalid extension substitution";return e.GPOS.subt(s,f.ltype,y+Ae)}console.debug("unsupported GPOS table LookupType",l,"format",_.fmt)}return _},e.GPOS.readValueRecord=function(s,l,d){var f=e._bin,p=[];return p.push(1&d?f.readShort(s,l):0),l+=1&d?2:0,p.push(2&d?f.readShort(s,l):0),l+=2&d?2:0,p.push(4&d?f.readShort(s,l):0),l+=4&d?2:0,p.push(8&d?f.readShort(s,l):0),l+=8&d?2:0,p},e.GSUB={},e.GSUB.parse=function(s,l,d,f){return e._lctf.parse(s,l,d,f,e.GSUB.subt)},e.GSUB.subt=function(s,l,d,f){var p=e._bin,y=d,_={};if(_.fmt=p.readUshort(s,d),d+=2,l!=1&&l!=4&&l!=5&&l!=6)return null;if(l==1||l==4||l==5&&_.fmt<=2||l==6&&_.fmt<=2){var b=p.readUshort(s,d);d+=2,_.coverage=e._lctf.readCoverage(s,y+b)}if(l==1&&_.fmt>=1&&_.fmt<=2){if(_.fmt==1)_.delta=p.readShort(s,d),d+=2;else if(_.fmt==2){var S=p.readUshort(s,d);d+=2,_.newg=p.readUshorts(s,d,S),d+=2*_.newg.length}}else if(l==4){_.vals=[],S=p.readUshort(s,d),d+=2;for(var A=0;A<S;A++){var P=p.readUshort(s,d);d+=2,_.vals.push(e.GSUB.readLigatureSet(s,y+P))}}else if(l==5&&_.fmt==2){if(_.fmt==2){var L=p.readUshort(s,d);d+=2,_.cDef=e._lctf.readClassDef(s,y+L),_.scset=[];var k=p.readUshort(s,d);for(d+=2,A=0;A<k;A++){var R=p.readUshort(s,d);d+=2,_.scset.push(R==0?null:e.GSUB.readSubClassSet(s,y+R))}}}else if(l==6&&_.fmt==3){if(_.fmt==3){for(A=0;A<3;A++){S=p.readUshort(s,d),d+=2;for(var z=[],O=0;O<S;O++)z.push(e._lctf.readCoverage(s,y+p.readUshort(s,d+2*O)));d+=2*S,A==0&&(_.backCvg=z),A==1&&(_.inptCvg=z),A==2&&(_.ahedCvg=z)}S=p.readUshort(s,d),d+=2,_.lookupRec=e.GSUB.readSubstLookupRecords(s,d,S)}}else{if(l==7&&_.fmt==1){var F=p.readUshort(s,d);d+=2;var H=p.readUint(s,d);if(d+=4,f.ltype==9)f.ltype=F;else if(f.ltype!=F)throw"invalid extension substitution";return e.GSUB.subt(s,f.ltype,y+H)}console.debug("unsupported GSUB table LookupType",l,"format",_.fmt)}return _},e.GSUB.readSubClassSet=function(s,l){var d=e._bin.readUshort,f=l,p=[],y=d(s,l);l+=2;for(var _=0;_<y;_++){var b=d(s,l);l+=2,p.push(e.GSUB.readSubClassRule(s,f+b))}return p},e.GSUB.readSubClassRule=function(s,l){var d=e._bin.readUshort,f={},p=d(s,l),y=d(s,l+=2);l+=2,f.input=[];for(var _=0;_<p-1;_++)f.input.push(d(s,l)),l+=2;return f.substLookupRecords=e.GSUB.readSubstLookupRecords(s,l,y),f},e.GSUB.readSubstLookupRecords=function(s,l,d){for(var f=e._bin.readUshort,p=[],y=0;y<d;y++)p.push(f(s,l),f(s,l+2)),l+=4;return p},e.GSUB.readChainSubClassSet=function(s,l){var d=e._bin,f=l,p=[],y=d.readUshort(s,l);l+=2;for(var _=0;_<y;_++){var b=d.readUshort(s,l);l+=2,p.push(e.GSUB.readChainSubClassRule(s,f+b))}return p},e.GSUB.readChainSubClassRule=function(s,l){for(var d=e._bin,f={},p=["backtrack","input","lookahead"],y=0;y<p.length;y++){var _=d.readUshort(s,l);l+=2,y==1&&_--,f[p[y]]=d.readUshorts(s,l,_),l+=2*f[p[y]].length}return _=d.readUshort(s,l),l+=2,f.subst=d.readUshorts(s,l,2*_),l+=2*f.subst.length,f},e.GSUB.readLigatureSet=function(s,l){var d=e._bin,f=l,p=[],y=d.readUshort(s,l);l+=2;for(var _=0;_<y;_++){var b=d.readUshort(s,l);l+=2,p.push(e.GSUB.readLigature(s,f+b))}return p},e.GSUB.readLigature=function(s,l){var d=e._bin,f={chain:[]};f.nglyph=d.readUshort(s,l),l+=2;var p=d.readUshort(s,l);l+=2;for(var y=0;y<p-1;y++)f.chain.push(d.readUshort(s,l)),l+=2;return f},e.head={},e.head.parse=function(s,l,d){var f=e._bin,p={};return f.readFixed(s,l),l+=4,p.fontRevision=f.readFixed(s,l),l+=4,f.readUint(s,l),l+=4,f.readUint(s,l),l+=4,p.flags=f.readUshort(s,l),l+=2,p.unitsPerEm=f.readUshort(s,l),l+=2,p.created=f.readUint64(s,l),l+=8,p.modified=f.readUint64(s,l),l+=8,p.xMin=f.readShort(s,l),l+=2,p.yMin=f.readShort(s,l),l+=2,p.xMax=f.readShort(s,l),l+=2,p.yMax=f.readShort(s,l),l+=2,p.macStyle=f.readUshort(s,l),l+=2,p.lowestRecPPEM=f.readUshort(s,l),l+=2,p.fontDirectionHint=f.readShort(s,l),l+=2,p.indexToLocFormat=f.readShort(s,l),l+=2,p.glyphDataFormat=f.readShort(s,l),l+=2,p},e.hhea={},e.hhea.parse=function(s,l,d){var f=e._bin,p={};return f.readFixed(s,l),l+=4,p.ascender=f.readShort(s,l),l+=2,p.descender=f.readShort(s,l),l+=2,p.lineGap=f.readShort(s,l),l+=2,p.advanceWidthMax=f.readUshort(s,l),l+=2,p.minLeftSideBearing=f.readShort(s,l),l+=2,p.minRightSideBearing=f.readShort(s,l),l+=2,p.xMaxExtent=f.readShort(s,l),l+=2,p.caretSlopeRise=f.readShort(s,l),l+=2,p.caretSlopeRun=f.readShort(s,l),l+=2,p.caretOffset=f.readShort(s,l),l+=2,l+=8,p.metricDataFormat=f.readShort(s,l),l+=2,p.numberOfHMetrics=f.readUshort(s,l),l+=2,p},e.hmtx={},e.hmtx.parse=function(s,l,d,f){for(var p=e._bin,y={aWidth:[],lsBearing:[]},_=0,b=0,S=0;S<f.maxp.numGlyphs;S++)S<f.hhea.numberOfHMetrics&&(_=p.readUshort(s,l),l+=2,b=p.readShort(s,l),l+=2),y.aWidth.push(_),y.lsBearing.push(b);return y},e.kern={},e.kern.parse=function(s,l,d,f){var p=e._bin,y=p.readUshort(s,l);if(l+=2,y==1)return e.kern.parseV1(s,l-2,d,f);var _=p.readUshort(s,l);l+=2;for(var b={glyph1:[],rval:[]},S=0;S<_;S++){l+=2,d=p.readUshort(s,l),l+=2;var A=p.readUshort(s,l);l+=2;var P=A>>>8;if((P&=15)!=0)throw"unknown kern table format: "+P;l=e.kern.readFormat0(s,l,b)}return b},e.kern.parseV1=function(s,l,d,f){var p=e._bin;p.readFixed(s,l),l+=4;var y=p.readUint(s,l);l+=4;for(var _={glyph1:[],rval:[]},b=0;b<y;b++){p.readUint(s,l),l+=4;var S=p.readUshort(s,l);l+=2,p.readUshort(s,l),l+=2;var A=S>>>8;if((A&=15)!=0)throw"unknown kern table format: "+A;l=e.kern.readFormat0(s,l,_)}return _},e.kern.readFormat0=function(s,l,d){var f=e._bin,p=-1,y=f.readUshort(s,l);l+=2,f.readUshort(s,l),l+=2,f.readUshort(s,l),l+=2,f.readUshort(s,l),l+=2;for(var _=0;_<y;_++){var b=f.readUshort(s,l);l+=2;var S=f.readUshort(s,l);l+=2;var A=f.readShort(s,l);l+=2,b!=p&&(d.glyph1.push(b),d.rval.push({glyph2:[],vals:[]}));var P=d.rval[d.rval.length-1];P.glyph2.push(S),P.vals.push(A),p=b}return l},e.loca={},e.loca.parse=function(s,l,d,f){var p=e._bin,y=[],_=f.head.indexToLocFormat,b=f.maxp.numGlyphs+1;if(_==0)for(var S=0;S<b;S++)y.push(p.readUshort(s,l+(S<<1))<<1);if(_==1)for(S=0;S<b;S++)y.push(p.readUint(s,l+(S<<2)));return y},e.maxp={},e.maxp.parse=function(s,l,d){var f=e._bin,p={},y=f.readUint(s,l);return l+=4,p.numGlyphs=f.readUshort(s,l),l+=2,y==65536&&(p.maxPoints=f.readUshort(s,l),l+=2,p.maxContours=f.readUshort(s,l),l+=2,p.maxCompositePoints=f.readUshort(s,l),l+=2,p.maxCompositeContours=f.readUshort(s,l),l+=2,p.maxZones=f.readUshort(s,l),l+=2,p.maxTwilightPoints=f.readUshort(s,l),l+=2,p.maxStorage=f.readUshort(s,l),l+=2,p.maxFunctionDefs=f.readUshort(s,l),l+=2,p.maxInstructionDefs=f.readUshort(s,l),l+=2,p.maxStackElements=f.readUshort(s,l),l+=2,p.maxSizeOfInstructions=f.readUshort(s,l),l+=2,p.maxComponentElements=f.readUshort(s,l),l+=2,p.maxComponentDepth=f.readUshort(s,l),l+=2),p},e.name={},e.name.parse=function(s,l,d){var f=e._bin,p={};f.readUshort(s,l),l+=2;var y=f.readUshort(s,l);l+=2,f.readUshort(s,l);for(var _,b=["copyright","fontFamily","fontSubfamily","ID","fullName","version","postScriptName","trademark","manufacturer","designer","description","urlVendor","urlDesigner","licence","licenceURL","---","typoFamilyName","typoSubfamilyName","compatibleFull","sampleText","postScriptCID","wwsFamilyName","wwsSubfamilyName","lightPalette","darkPalette"],S=l+=2,A=0;A<y;A++){var P=f.readUshort(s,l);l+=2;var L=f.readUshort(s,l);l+=2;var k=f.readUshort(s,l);l+=2;var R=f.readUshort(s,l);l+=2;var z=f.readUshort(s,l);l+=2;var O=f.readUshort(s,l);l+=2;var F,H=b[R],$=S+12*y+O;if(P==0)F=f.readUnicode(s,$,z/2);else if(P==3&&L==0)F=f.readUnicode(s,$,z/2);else if(L==0)F=f.readASCII(s,$,z);else if(L==1)F=f.readUnicode(s,$,z/2);else if(L==3)F=f.readUnicode(s,$,z/2);else{if(P!=1)throw"unknown encoding "+L+", platformID: "+P;F=f.readASCII(s,$,z),console.debug("reading unknown MAC encoding "+L+" as ASCII")}var Y="p"+P+","+k.toString(16);p[Y]==null&&(p[Y]={}),p[Y][H!==void 0?H:R]=F,p[Y]._lang=k}for(var te in p)if(p[te].postScriptName!=null&&p[te]._lang==1033)return p[te];for(var te in p)if(p[te].postScriptName!=null&&p[te]._lang==0)return p[te];for(var te in p)if(p[te].postScriptName!=null&&p[te]._lang==3084)return p[te];for(var te in p)if(p[te].postScriptName!=null)return p[te];for(var te in p){_=te;break}return console.debug("returning name table with languageID "+p[_]._lang),p[_]},e["OS/2"]={},e["OS/2"].parse=function(s,l,d){var f=e._bin.readUshort(s,l);l+=2;var p={};if(f==0)e["OS/2"].version0(s,l,p);else if(f==1)e["OS/2"].version1(s,l,p);else if(f==2||f==3||f==4)e["OS/2"].version2(s,l,p);else{if(f!=5)throw"unknown OS/2 table version: "+f;e["OS/2"].version5(s,l,p)}return p},e["OS/2"].version0=function(s,l,d){var f=e._bin;return d.xAvgCharWidth=f.readShort(s,l),l+=2,d.usWeightClass=f.readUshort(s,l),l+=2,d.usWidthClass=f.readUshort(s,l),l+=2,d.fsType=f.readUshort(s,l),l+=2,d.ySubscriptXSize=f.readShort(s,l),l+=2,d.ySubscriptYSize=f.readShort(s,l),l+=2,d.ySubscriptXOffset=f.readShort(s,l),l+=2,d.ySubscriptYOffset=f.readShort(s,l),l+=2,d.ySuperscriptXSize=f.readShort(s,l),l+=2,d.ySuperscriptYSize=f.readShort(s,l),l+=2,d.ySuperscriptXOffset=f.readShort(s,l),l+=2,d.ySuperscriptYOffset=f.readShort(s,l),l+=2,d.yStrikeoutSize=f.readShort(s,l),l+=2,d.yStrikeoutPosition=f.readShort(s,l),l+=2,d.sFamilyClass=f.readShort(s,l),l+=2,d.panose=f.readBytes(s,l,10),l+=10,d.ulUnicodeRange1=f.readUint(s,l),l+=4,d.ulUnicodeRange2=f.readUint(s,l),l+=4,d.ulUnicodeRange3=f.readUint(s,l),l+=4,d.ulUnicodeRange4=f.readUint(s,l),l+=4,d.achVendID=[f.readInt8(s,l),f.readInt8(s,l+1),f.readInt8(s,l+2),f.readInt8(s,l+3)],l+=4,d.fsSelection=f.readUshort(s,l),l+=2,d.usFirstCharIndex=f.readUshort(s,l),l+=2,d.usLastCharIndex=f.readUshort(s,l),l+=2,d.sTypoAscender=f.readShort(s,l),l+=2,d.sTypoDescender=f.readShort(s,l),l+=2,d.sTypoLineGap=f.readShort(s,l),l+=2,d.usWinAscent=f.readUshort(s,l),l+=2,d.usWinDescent=f.readUshort(s,l),l+=2},e["OS/2"].version1=function(s,l,d){var f=e._bin;return l=e["OS/2"].version0(s,l,d),d.ulCodePageRange1=f.readUint(s,l),l+=4,d.ulCodePageRange2=f.readUint(s,l),l+=4},e["OS/2"].version2=function(s,l,d){var f=e._bin;return l=e["OS/2"].version1(s,l,d),d.sxHeight=f.readShort(s,l),l+=2,d.sCapHeight=f.readShort(s,l),l+=2,d.usDefault=f.readUshort(s,l),l+=2,d.usBreak=f.readUshort(s,l),l+=2,d.usMaxContext=f.readUshort(s,l),l+=2},e["OS/2"].version5=function(s,l,d){var f=e._bin;return l=e["OS/2"].version2(s,l,d),d.usLowerOpticalPointSize=f.readUshort(s,l),l+=2,d.usUpperOpticalPointSize=f.readUshort(s,l),l+=2},e.post={},e.post.parse=function(s,l,d){var f=e._bin,p={};return p.version=f.readFixed(s,l),l+=4,p.italicAngle=f.readFixed(s,l),l+=4,p.underlinePosition=f.readShort(s,l),l+=2,p.underlineThickness=f.readShort(s,l),l+=2,p},e==null&&(e={}),e.U==null&&(e.U={}),e.U.codeToGlyph=function(s,l){var d=s.cmap,f=-1;if(d.p0e4!=null?f=d.p0e4:d.p3e1!=null?f=d.p3e1:d.p1e0!=null?f=d.p1e0:d.p0e3!=null&&(f=d.p0e3),f==-1)throw"no familiar platform and encoding!";var p=d.tables[f];if(p.format==0)return l>=p.map.length?0:p.map[l];if(p.format==4){for(var y=-1,_=0;_<p.endCount.length;_++)if(l<=p.endCount[_]){y=_;break}return y==-1||p.startCount[y]>l?0:65535&(p.idRangeOffset[y]!=0?p.glyphIdArray[l-p.startCount[y]+(p.idRangeOffset[y]>>1)-(p.idRangeOffset.length-y)]:l+p.idDelta[y])}if(p.format==12){if(l>p.groups[p.groups.length-1][1])return 0;for(_=0;_<p.groups.length;_++){var b=p.groups[_];if(b[0]<=l&&l<=b[1])return b[2]+(l-b[0])}return 0}throw"unknown cmap table format "+p.format},e.U.glyphToPath=function(s,l){var d={cmds:[],crds:[]};if(s.SVG&&s.SVG.entries[l]){var f=s.SVG.entries[l];return f==null?d:(typeof f=="string"&&(f=e.SVG.toPath(f),s.SVG.entries[l]=f),f)}if(s.CFF){var p={x:0,y:0,stack:[],nStems:0,haveWidth:!1,width:s.CFF.Private?s.CFF.Private.defaultWidthX:0,open:!1},y=s.CFF,_=s.CFF.Private;if(y.ROS){for(var b=0;y.FDSelect[b+2]<=l;)b+=2;_=y.FDArray[y.FDSelect[b+1]].Private}e.U._drawCFF(s.CFF.CharStrings[l],p,y,_,d)}else s.glyf&&e.U._drawGlyf(l,s,d);return d},e.U._drawGlyf=function(s,l,d){var f=l.glyf[s];f==null&&(f=l.glyf[s]=e.glyf._parseGlyf(l,s)),f!=null&&(f.noc>-1?e.U._simpleGlyph(f,d):e.U._compoGlyph(f,l,d))},e.U._simpleGlyph=function(s,l){for(var d=0;d<s.noc;d++){for(var f=d==0?0:s.endPts[d-1]+1,p=s.endPts[d],y=f;y<=p;y++){var _=y==f?p:y-1,b=y==p?f:y+1,S=1&s.flags[y],A=1&s.flags[_],P=1&s.flags[b],L=s.xs[y],k=s.ys[y];if(y==f)if(S){if(!A){e.U.P.moveTo(l,L,k);continue}e.U.P.moveTo(l,s.xs[_],s.ys[_])}else A?e.U.P.moveTo(l,s.xs[_],s.ys[_]):e.U.P.moveTo(l,(s.xs[_]+L)/2,(s.ys[_]+k)/2);S?A&&e.U.P.lineTo(l,L,k):P?e.U.P.qcurveTo(l,L,k,s.xs[b],s.ys[b]):e.U.P.qcurveTo(l,L,k,(L+s.xs[b])/2,(k+s.ys[b])/2)}e.U.P.closePath(l)}},e.U._compoGlyph=function(s,l,d){for(var f=0;f<s.parts.length;f++){var p={cmds:[],crds:[]},y=s.parts[f];e.U._drawGlyf(y.glyphIndex,l,p);for(var _=y.m,b=0;b<p.crds.length;b+=2){var S=p.crds[b],A=p.crds[b+1];d.crds.push(S*_.a+A*_.b+_.tx),d.crds.push(S*_.c+A*_.d+_.ty)}for(b=0;b<p.cmds.length;b++)d.cmds.push(p.cmds[b])}},e.U._getGlyphClass=function(s,l){var d=e._lctf.getInterval(l,s);return d==-1?0:l[d+2]},e.U.getPairAdjustment=function(s,l,d){var f=!1;if(s.GPOS)for(var p=s.GPOS,y=p.lookupList,_=p.featureList,b=[],S=0;S<_.length;S++){var A=_[S];if(A.tag=="kern"){f=!0;for(var P=0;P<A.tab.length;P++)if(!b[A.tab[P]]){b[A.tab[P]]=!0;for(var L=y[A.tab[P]],k=0;k<L.tabs.length;k++)if(L.tabs[k]!=null){var R,z=L.tabs[k];if((!z.coverage||(R=e._lctf.coverageIndex(z.coverage,l))!=-1)&&L.ltype!=1){if(L.ltype==2){var O=null;if(z.fmt==1){var F=z.pairsets[R];for(S=0;S<F.length;S++)F[S].gid2==d&&(O=F[S])}else if(z.fmt==2){var H=e.U._getGlyphClass(l,z.classDef1),$=e.U._getGlyphClass(d,z.classDef2);O=z.matrix[H][$]}if(O){var Y=0;return O.val1&&O.val1[2]&&(Y+=O.val1[2]),O.val2&&O.val2[0]&&(Y+=O.val2[0]),Y}}}}}}}if(s.kern&&!f){var te=s.kern.glyph1.indexOf(l);if(te!=-1){var G=s.kern.rval[te].glyph2.indexOf(d);if(G!=-1)return s.kern.rval[te].vals[G]}}return 0},e.U._applySubs=function(s,l,d,f){for(var p=s.length-l-1,y=0;y<d.tabs.length;y++)if(d.tabs[y]!=null){var _,b=d.tabs[y];if(!b.coverage||(_=e._lctf.coverageIndex(b.coverage,s[l]))!=-1){if(d.ltype==1)s[l],b.fmt==1?s[l]=s[l]+b.delta:s[l]=b.newg[_];else if(d.ltype==4)for(var S=b.vals[_],A=0;A<S.length;A++){var P=S[A],L=P.chain.length;if(!(L>p)){for(var k=!0,R=0,z=0;z<L;z++){for(;s[l+R+(1+z)]==-1;)R++;P.chain[z]!=s[l+R+(1+z)]&&(k=!1)}if(k){for(s[l]=P.nglyph,z=0;z<L+R;z++)s[l+z+1]=-1;break}}}else if(d.ltype==5&&b.fmt==2)for(var O=e._lctf.getInterval(b.cDef,s[l]),F=b.cDef[O+2],H=b.scset[F],$=0;$<H.length;$++){var Y=H[$],te=Y.input;if(!(te.length>p)){for(k=!0,z=0;z<te.length;z++){var G=e._lctf.getInterval(b.cDef,s[l+1+z]);if(O==-1&&b.cDef[G+2]!=te[z]){k=!1;break}}if(k){var Q=Y.substLookupRecords;for(A=0;A<Q.length;A+=2)Q[A],Q[A+1]}}}else if(d.ltype==6&&b.fmt==3){if(!e.U._glsCovered(s,b.backCvg,l-b.backCvg.length)||!e.U._glsCovered(s,b.inptCvg,l)||!e.U._glsCovered(s,b.ahedCvg,l+b.inptCvg.length))continue;var he=b.lookupRec;for($=0;$<he.length;$+=2){O=he[$];var pe=f[he[$+1]];e.U._applySubs(s,l+O,pe,f)}}}}},e.U._glsCovered=function(s,l,d){for(var f=0;f<l.length;f++)if(e._lctf.coverageIndex(l[f],s[d+f])==-1)return!1;return!0},e.U.glyphsToPath=function(s,l,d){for(var f={cmds:[],crds:[]},p=0,y=0;y<l.length;y++){var _=l[y];if(_!=-1){for(var b=y<l.length-1&&l[y+1]!=-1?l[y+1]:0,S=e.U.glyphToPath(s,_),A=0;A<S.crds.length;A+=2)f.crds.push(S.crds[A]+p),f.crds.push(S.crds[A+1]);for(d&&f.cmds.push(d),A=0;A<S.cmds.length;A++)f.cmds.push(S.cmds[A]);d&&f.cmds.push("X"),p+=s.hmtx.aWidth[_],y<l.length-1&&(p+=e.U.getPairAdjustment(s,_,b))}}return f},e.U.P={},e.U.P.moveTo=function(s,l,d){s.cmds.push("M"),s.crds.push(l,d)},e.U.P.lineTo=function(s,l,d){s.cmds.push("L"),s.crds.push(l,d)},e.U.P.curveTo=function(s,l,d,f,p,y,_){s.cmds.push("C"),s.crds.push(l,d,f,p,y,_)},e.U.P.qcurveTo=function(s,l,d,f,p){s.cmds.push("Q"),s.crds.push(l,d,f,p)},e.U.P.closePath=function(s){s.cmds.push("Z")},e.U._drawCFF=function(s,l,d,f,p){for(var y=l.stack,_=l.nStems,b=l.haveWidth,S=l.width,A=l.open,P=0,L=l.x,k=l.y,R=0,z=0,O=0,F=0,H=0,$=0,Y=0,te=0,G=0,Q=0,he={val:0,size:0};P<s.length;){e.CFF.getCharString(s,P,he);var pe=he.val;if(P+=he.size,pe=="o1"||pe=="o18")y.length%2!=0&&!b&&(S=y.shift()+f.nominalWidthX),_+=y.length>>1,y.length=0,b=!0;else if(pe=="o3"||pe=="o23")y.length%2!=0&&!b&&(S=y.shift()+f.nominalWidthX),_+=y.length>>1,y.length=0,b=!0;else if(pe=="o4")y.length>1&&!b&&(S=y.shift()+f.nominalWidthX,b=!0),A&&e.U.P.closePath(p),k+=y.pop(),e.U.P.moveTo(p,L,k),A=!0;else if(pe=="o5")for(;y.length>0;)L+=y.shift(),k+=y.shift(),e.U.P.lineTo(p,L,k);else if(pe=="o6"||pe=="o7")for(var ye=y.length,fe=pe=="o6",Ae=0;Ae<ye;Ae++){var Re=y.shift();fe?L+=Re:k+=Re,fe=!fe,e.U.P.lineTo(p,L,k)}else if(pe=="o8"||pe=="o24"){ye=y.length;for(var Be=0;Be+6<=ye;)R=L+y.shift(),z=k+y.shift(),O=R+y.shift(),F=z+y.shift(),L=O+y.shift(),k=F+y.shift(),e.U.P.curveTo(p,R,z,O,F,L,k),Be+=6;pe=="o24"&&(L+=y.shift(),k+=y.shift(),e.U.P.lineTo(p,L,k))}else{if(pe=="o11")break;if(pe=="o1234"||pe=="o1235"||pe=="o1236"||pe=="o1237")pe=="o1234"&&(z=k,O=(R=L+y.shift())+y.shift(),Q=F=z+y.shift(),$=F,te=k,L=(Y=(H=(G=O+y.shift())+y.shift())+y.shift())+y.shift(),e.U.P.curveTo(p,R,z,O,F,G,Q),e.U.P.curveTo(p,H,$,Y,te,L,k)),pe=="o1235"&&(R=L+y.shift(),z=k+y.shift(),O=R+y.shift(),F=z+y.shift(),G=O+y.shift(),Q=F+y.shift(),H=G+y.shift(),$=Q+y.shift(),Y=H+y.shift(),te=$+y.shift(),L=Y+y.shift(),k=te+y.shift(),y.shift(),e.U.P.curveTo(p,R,z,O,F,G,Q),e.U.P.curveTo(p,H,$,Y,te,L,k)),pe=="o1236"&&(R=L+y.shift(),z=k+y.shift(),O=R+y.shift(),Q=F=z+y.shift(),$=F,Y=(H=(G=O+y.shift())+y.shift())+y.shift(),te=$+y.shift(),L=Y+y.shift(),e.U.P.curveTo(p,R,z,O,F,G,Q),e.U.P.curveTo(p,H,$,Y,te,L,k)),pe=="o1237"&&(R=L+y.shift(),z=k+y.shift(),O=R+y.shift(),F=z+y.shift(),G=O+y.shift(),Q=F+y.shift(),H=G+y.shift(),$=Q+y.shift(),Y=H+y.shift(),te=$+y.shift(),Math.abs(Y-L)>Math.abs(te-k)?L=Y+y.shift():k=te+y.shift(),e.U.P.curveTo(p,R,z,O,F,G,Q),e.U.P.curveTo(p,H,$,Y,te,L,k));else if(pe=="o14"){if(y.length>0&&!b&&(S=y.shift()+d.nominalWidthX,b=!0),y.length==4){var le=y.shift(),me=y.shift(),we=y.shift(),re=y.shift(),Te=e.CFF.glyphBySE(d,we),Je=e.CFF.glyphBySE(d,re);e.U._drawCFF(d.CharStrings[Te],l,d,f,p),l.x=le,l.y=me,e.U._drawCFF(d.CharStrings[Je],l,d,f,p)}A&&(e.U.P.closePath(p),A=!1)}else if(pe=="o19"||pe=="o20")y.length%2!=0&&!b&&(S=y.shift()+f.nominalWidthX),_+=y.length>>1,y.length=0,b=!0,P+=_+7>>3;else if(pe=="o21")y.length>2&&!b&&(S=y.shift()+f.nominalWidthX,b=!0),k+=y.pop(),L+=y.pop(),A&&e.U.P.closePath(p),e.U.P.moveTo(p,L,k),A=!0;else if(pe=="o22")y.length>1&&!b&&(S=y.shift()+f.nominalWidthX,b=!0),L+=y.pop(),A&&e.U.P.closePath(p),e.U.P.moveTo(p,L,k),A=!0;else if(pe=="o25"){for(;y.length>6;)L+=y.shift(),k+=y.shift(),e.U.P.lineTo(p,L,k);R=L+y.shift(),z=k+y.shift(),O=R+y.shift(),F=z+y.shift(),L=O+y.shift(),k=F+y.shift(),e.U.P.curveTo(p,R,z,O,F,L,k)}else if(pe=="o26")for(y.length%2&&(L+=y.shift());y.length>0;)R=L,z=k+y.shift(),L=O=R+y.shift(),k=(F=z+y.shift())+y.shift(),e.U.P.curveTo(p,R,z,O,F,L,k);else if(pe=="o27")for(y.length%2&&(k+=y.shift());y.length>0;)z=k,O=(R=L+y.shift())+y.shift(),F=z+y.shift(),L=O+y.shift(),k=F,e.U.P.curveTo(p,R,z,O,F,L,k);else if(pe=="o10"||pe=="o29"){var Xe=pe=="o10"?f:d;if(y.length==0)console.debug("error: empty stack");else{var Ze=y.pop(),Fe=Xe.Subrs[Ze+Xe.Bias];l.x=L,l.y=k,l.nStems=_,l.haveWidth=b,l.width=S,l.open=A,e.U._drawCFF(Fe,l,d,f,p),L=l.x,k=l.y,_=l.nStems,b=l.haveWidth,S=l.width,A=l.open}}else if(pe=="o30"||pe=="o31"){var ct=y.length,At=(Be=0,pe=="o31");for(Be+=ct-(ye=-3&ct);Be<ye;)At?(z=k,O=(R=L+y.shift())+y.shift(),k=(F=z+y.shift())+y.shift(),ye-Be==5?(L=O+y.shift(),Be++):L=O,At=!1):(R=L,z=k+y.shift(),O=R+y.shift(),F=z+y.shift(),L=O+y.shift(),ye-Be==5?(k=F+y.shift(),Be++):k=F,At=!0),e.U.P.curveTo(p,R,z,O,F,L,k),Be+=4}else{if((pe+"").charAt(0)=="o")throw console.debug("Unknown operation: "+pe,s),pe;y.push(pe)}}}l.x=L,l.y=k,l.nStems=_,l.haveWidth=b,l.width=S,l.open=A};var i=e,a={Typr:i};return n.Typr=i,n.default=a,Object.defineProperty(n,"__esModule",{value:!0}),n}({}).Typr}/*!
Custom bundle of woff2otf (https://github.com/arty-name/woff2otf) with fflate
(https://github.com/101arrowz/fflate) for use in Troika text rendering. 
Original licenses apply: 
- fflate: https://github.com/101arrowz/fflate/blob/master/LICENSE (MIT)
- woff2otf.js: https://github.com/arty-name/woff2otf/blob/master/woff2otf.js (Apache2)
*/function xAe(){return function(n){var e=Uint8Array,i=Uint16Array,a=Uint32Array,s=new e([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),l=new e([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),d=new e([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),f=function(pe,ye){for(var fe=new i(31),Ae=0;Ae<31;++Ae)fe[Ae]=ye+=1<<pe[Ae-1];var Re=new a(fe[30]);for(Ae=1;Ae<30;++Ae)for(var Be=fe[Ae];Be<fe[Ae+1];++Be)Re[Be]=Be-fe[Ae]<<5|Ae;return[fe,Re]},p=f(s,2),y=p[0],_=p[1];y[28]=258,_[258]=28;for(var b=f(l,0)[0],S=new i(32768),A=0;A<32768;++A){var P=(43690&A)>>>1|(21845&A)<<1;P=(61680&(P=(52428&P)>>>2|(13107&P)<<2))>>>4|(3855&P)<<4,S[A]=((65280&P)>>>8|(255&P)<<8)>>>1}var L=function(pe,ye,fe){for(var Ae=pe.length,Re=0,Be=new i(ye);Re<Ae;++Re)++Be[pe[Re]-1];var le,me=new i(ye);for(Re=0;Re<ye;++Re)me[Re]=me[Re-1]+Be[Re-1]<<1;if(fe){le=new i(1<<ye);var we=15-ye;for(Re=0;Re<Ae;++Re)if(pe[Re])for(var re=Re<<4|pe[Re],Te=ye-pe[Re],Je=me[pe[Re]-1]++<<Te,Xe=Je|(1<<Te)-1;Je<=Xe;++Je)le[S[Je]>>>we]=re}else for(le=new i(Ae),Re=0;Re<Ae;++Re)pe[Re]&&(le[Re]=S[me[pe[Re]-1]++]>>>15-pe[Re]);return le},k=new e(288);for(A=0;A<144;++A)k[A]=8;for(A=144;A<256;++A)k[A]=9;for(A=256;A<280;++A)k[A]=7;for(A=280;A<288;++A)k[A]=8;var R=new e(32);for(A=0;A<32;++A)R[A]=5;var z=L(k,9,1),O=L(R,5,1),F=function(pe){for(var ye=pe[0],fe=1;fe<pe.length;++fe)pe[fe]>ye&&(ye=pe[fe]);return ye},H=function(pe,ye,fe){var Ae=ye/8|0;return(pe[Ae]|pe[Ae+1]<<8)>>(7&ye)&fe},$=function(pe,ye){var fe=ye/8|0;return(pe[fe]|pe[fe+1]<<8|pe[fe+2]<<16)>>(7&ye)},Y=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],te=function(pe,ye,fe){var Ae=new Error(ye||Y[pe]);if(Ae.code=pe,Error.captureStackTrace&&Error.captureStackTrace(Ae,te),!fe)throw Ae;return Ae},G=function(pe,ye,fe){var Ae=pe.length;if(!Ae||fe&&!fe.l&&Ae<5)return ye||new e(0);var Re=!ye||fe,Be=!fe||fe.i;fe||(fe={}),ye||(ye=new e(3*Ae));var le,me=function(Xt){var $e=ye.length;if(Xt>$e){var Pt=new e(Math.max(2*$e,Xt));Pt.set(ye),ye=Pt}},we=fe.f||0,re=fe.p||0,Te=fe.b||0,Je=fe.l,Xe=fe.d,Ze=fe.m,Fe=fe.n,ct=8*Ae;do{if(!Je){fe.f=we=H(pe,re,1);var At=H(pe,re+1,3);if(re+=3,!At){var kt=pe[(Ye=((le=re)/8|0)+(7&le&&1)+4)-4]|pe[Ye-3]<<8,Kt=Ye+kt;if(Kt>Ae){Be&&te(0);break}Re&&me(Te+kt),ye.set(pe.subarray(Ye,Kt),Te),fe.b=Te+=kt,fe.p=re=8*Kt;continue}if(At==1)Je=z,Xe=O,Ze=9,Fe=5;else if(At==2){var Et=H(pe,re,31)+257,Ie=H(pe,re+10,15)+4,pt=Et+H(pe,re+5,31)+1;re+=14;for(var gt=new e(pt),_t=new e(19),Ue=0;Ue<Ie;++Ue)_t[d[Ue]]=H(pe,re+3*Ue,7);re+=3*Ie;var ue=F(_t),se=(1<<ue)-1,xe=L(_t,ue,1);for(Ue=0;Ue<pt;){var Ye,ze=xe[H(pe,re,se)];if(re+=15&ze,(Ye=ze>>>4)<16)gt[Ue++]=Ye;else{var st=0,de=0;for(Ye==16?(de=3+H(pe,re,3),re+=2,st=gt[Ue-1]):Ye==17?(de=3+H(pe,re,7),re+=3):Ye==18&&(de=11+H(pe,re,127),re+=7);de--;)gt[Ue++]=st}}var ie=gt.subarray(0,Et),Oe=gt.subarray(Et);Ze=F(ie),Fe=F(Oe),Je=L(ie,Ze,1),Xe=L(Oe,Fe,1)}else te(1);if(re>ct){Be&&te(0);break}}Re&&me(Te+131072);for(var ut=(1<<Ze)-1,it=(1<<Fe)-1,lt=re;;lt=re){var Mt=(st=Je[$(pe,re)&ut])>>>4;if((re+=15&st)>ct){Be&&te(0);break}if(st||te(2),Mt<256)ye[Te++]=Mt;else{if(Mt==256){lt=re,Je=null;break}var Ut=Mt-254;if(Mt>264){var Wt=s[Ue=Mt-257];Ut=H(pe,re,(1<<Wt)-1)+y[Ue],re+=Wt}var Ht=Xe[$(pe,re)&it],Dt=Ht>>>4;if(Ht||te(3),re+=15&Ht,Oe=b[Dt],Dt>3&&(Wt=l[Dt],Oe+=$(pe,re)&(1<<Wt)-1,re+=Wt),re>ct){Be&&te(0);break}Re&&me(Te+131072);for(var wt=Te+Ut;Te<wt;Te+=4)ye[Te]=ye[Te-Oe],ye[Te+1]=ye[Te+1-Oe],ye[Te+2]=ye[Te+2-Oe],ye[Te+3]=ye[Te+3-Oe];Te=wt}}fe.l=Je,fe.p=lt,fe.b=Te,Je&&(we=1,fe.m=Ze,fe.d=Xe,fe.n=Fe)}while(!we);return Te==ye.length?ye:function(Xt,$e,Pt){($e==null||$e<0)&&($e=0),(Pt==null||Pt>Xt.length)&&(Pt=Xt.length);var qt=new(Xt instanceof i?i:Xt instanceof a?a:e)(Pt-$e);return qt.set(Xt.subarray($e,Pt)),qt}(ye,0,Te)},Q=new e(0),he=typeof TextDecoder<"u"&&new TextDecoder;try{he.decode(Q,{stream:!0})}catch{}return n.convert_streams=function(pe){var ye=new DataView(pe),fe=0;function Ae(){var Et=ye.getUint16(fe);return fe+=2,Et}function Re(){var Et=ye.getUint32(fe);return fe+=4,Et}function Be(Et){kt.setUint16(Kt,Et),Kt+=2}function le(Et){kt.setUint32(Kt,Et),Kt+=4}for(var me={signature:Re(),flavor:Re(),length:Re(),numTables:Ae(),reserved:Ae(),totalSfntSize:Re(),majorVersion:Ae(),minorVersion:Ae(),metaOffset:Re(),metaLength:Re(),metaOrigLength:Re(),privOffset:Re(),privLength:Re()},we=0;Math.pow(2,we)<=me.numTables;)we++;we--;for(var re=16*Math.pow(2,we),Te=16*me.numTables-re,Je=12,Xe=[],Ze=0;Ze<me.numTables;Ze++)Xe.push({tag:Re(),offset:Re(),compLength:Re(),origLength:Re(),origChecksum:Re()}),Je+=16;var Fe,ct=new Uint8Array(12+16*Xe.length+Xe.reduce(function(Et,Ie){return Et+Ie.origLength+4},0)),At=ct.buffer,kt=new DataView(At),Kt=0;return le(me.flavor),Be(me.numTables),Be(re),Be(we),Be(Te),Xe.forEach(function(Et){le(Et.tag),le(Et.origChecksum),le(Je),le(Et.origLength),Et.outOffset=Je,(Je+=Et.origLength)%4!=0&&(Je+=4-Je%4)}),Xe.forEach(function(Et){var Ie,pt=pe.slice(Et.offset,Et.offset+Et.compLength);if(Et.compLength!=Et.origLength){var gt=new Uint8Array(Et.origLength);Ie=new Uint8Array(pt,2),G(Ie,gt)}else gt=new Uint8Array(pt);ct.set(gt,Et.outOffset);var _t=0;(Je=Et.outOffset+Et.origLength)%4!=0&&(_t=4-Je%4),ct.set(new Uint8Array(_t).buffer,Et.outOffset+Et.origLength),Fe=Je+_t}),At.slice(0,Fe)},Object.defineProperty(n,"__esModule",{value:!0}),n}({}).convert_streams}function bAe(n,e){const i={M:2,L:2,Q:4,C:6,Z:0},a={C:"18g,ca,368,1kz",D:"17k,6,2,2+4,5+c,2+6,2+1,10+1,9+f,j+11,2+1,a,2,2+1,15+2,3,j+2,6+3,2+8,2,2,2+1,w+a,4+e,3+3,2,3+2,3+5,23+w,2f+4,3,2+9,2,b,2+3,3,1k+9,6+1,3+1,2+2,2+d,30g,p+y,1,1+1g,f+x,2,sd2+1d,jf3+4,f+3,2+4,2+2,b+3,42,2,4+2,2+1,2,3,t+1,9f+w,2,el+2,2+g,d+2,2l,2+1,5,3+1,2+1,2,3,6,16wm+1v",R:"17m+3,2,2,6+3,m,15+2,2+2,h+h,13,3+8,2,2,3+1,2,p+1,x,5+4,5,a,2,2,3,u,c+2,g+1,5,2+1,4+1,5j,6+1,2,b,2+2,f,2+1,1s+2,2,3+1,7,1ez0,2,2+1,4+4,b,4,3,b,42,2+2,4,3,2+1,2,o+3,ae,ep,x,2o+2,3+1,3,5+1,6",L:"x9u,jff,a,fd,jv",T:"4t,gj+33,7o+4,1+1,7c+18,2,2+1,2+1,2,21+a,2,1b+k,h,2u+6,3+5,3+1,2+3,y,2,v+q,2k+a,1n+8,a,p+3,2+8,2+2,2+4,18+2,3c+e,2+v,1k,2,5+7,5,4+6,b+1,u,1n,5+3,9,l+1,r,3+1,1m,5+1,5+1,3+2,4,v+1,4,c+1,1m,5+4,2+1,5,l+1,n+5,2,1n,3,2+3,9,8+1,c+1,v,1q,d,1f,4,1m+2,6+2,2+3,8+1,c+1,u,1n,3,7,6+1,l+1,t+1,1m+1,5+3,9,l+1,u,21,8+2,2,2j,3+6,d+7,2r,3+8,c+5,23+1,s,2,2,1k+d,2+4,2+1,6+a,2+z,a,2v+3,2+5,2+1,3+1,q+1,5+2,h+3,e,3+1,7,g,jk+2,qb+2,u+2,u+1,v+1,1t+1,2+6,9,3+a,a,1a+2,3c+1,z,3b+2,5+1,a,7+2,64+1,3,1n,2+6,2,2,3+7,7+9,3,1d+d,1,1+1,1s+3,1d,2+4,2,6,15+8,d+1,x+3,3+1,2+2,1l,2+1,4,2+2,1n+7,3+1,49+2,2+c,2+6,5,7,4+1,5j+1l,2+4,ek,3+1,r+4,1e+4,6+5,2p+c,1+3,1,1+2,1+b,2db+2,3y,2p+v,ff+3,30+1,n9x,1+2,2+9,x+1,29+1,7l,4,5,q+1,6,48+1,r+h,e,13+7,q+a,1b+2,1d,3+3,3+1,14,1w+5,3+1,3+1,d,9,1c,1g,2+2,3+1,6+1,2,17+1,9,6n,3,5,fn5,ki+f,h+f,5s,6y+2,ea,6b,46+4,1af+2,2+1,6+3,15+2,5,4m+1,fy+3,as+1,4a+a,4x,1j+e,1l+2,1e+3,3+1,1y+2,11+4,2+7,1r,d+1,1h+8,b+3,3,2o+2,3,2+1,7,4h,4+7,m+1,1m+1,4,12+6,4+4,5g+7,3+2,2,o,2d+5,2,5+1,2+1,6n+3,7+1,2+1,s+1,2e+7,3,2+1,2z,2,3+5,2,2u+2,3+3,2+4,78+8,2+1,75+1,2,5,41+3,3+1,5,x+9,15+5,3+3,9,a+5,3+2,1b+c,2+1,bb+6,2+5,2,2b+l,3+6,2+1,2+1,3f+5,4,2+1,2+6,2,21+1,4,2,9o+1,470+8,at4+4,1o+6,t5,1s+3,2a,f5l+1,2+3,43o+2,a+7,1+7,3+6,v+3,45+2,1j0+1i,5+1d,9,f,n+4,2+e,11t+6,2+g,3+6,2+1,2+4,7a+6,c6+3,15t+6,32+6,1,gzau,v+2n,3l+6n"},s=1,l=2,d=4,f=8,p=16,y=32;let _;function b(H){if(!_){const $={R:l,L:s,D:d,C:p,U:y,T:f};_=new Map;for(let Y in a){let te=0;a[Y].split(",").forEach(G=>{let[Q,he]=G.split("+");Q=parseInt(Q,36),he=he?parseInt(he,36):0,_.set(te+=Q,$[Y]);for(let pe=he;pe--;)_.set(++te,$[Y])})}}return _.get(H)||y}const S=1,A=2,P=3,L=4,k=[null,"isol","init","fina","medi"];function R(H){const $=new Uint8Array(H.length);let Y=y,te=S,G=-1;for(let Q=0;Q<H.length;Q++){const he=H.codePointAt(Q);let pe=b(he)|0,ye=S;pe&f||(Y&(s|d|p)?pe&(l|d|p)?(ye=P,(te===S||te===P)&&$[G]++):pe&(s|y)&&(te===A||te===L)&&$[G]--:Y&(l|y)&&(te===A||te===L)&&$[G]--,te=$[Q]=ye,Y=pe,G=Q,he>65535&&Q++)}return $}function z(H,$){const Y=[];for(let G=0;G<$.length;G++){const Q=$.codePointAt(G);Q>65535&&G++,Y.push(n.U.codeToGlyph(H,Q))}const te=H.GSUB;if(te){const{lookupList:G,featureList:Q}=te;let he;const pe=/^(rlig|liga|mset|isol|init|fina|medi|half|pres|blws)$/,ye=[];Q.forEach(fe=>{if(pe.test(fe.tag))for(let Ae=0;Ae<fe.tab.length;Ae++){if(ye[fe.tab[Ae]])continue;ye[fe.tab[Ae]]=!0;const Re=G[fe.tab[Ae]],Be=/^(isol|init|fina|medi)$/.test(fe.tag);Be&&!he&&(he=R($));for(let le=0;le<Y.length;le++)(!he||!Be||k[he[le]]===fe.tag)&&n.U._applySubs(Y,le,Re,G)}})}return Y}function O(...H){for(let $=0;$<H.length;$++)if(typeof H[$]=="number")return H[$]}function F(H){const $=Object.create(null),Y=H["OS/2"],te=H.hhea,G=H.head.unitsPerEm,Q=O(Y&&Y.sTypoAscender,te&&te.ascender,G),he={unitsPerEm:G,ascender:Q,descender:O(Y&&Y.sTypoDescender,te&&te.descender,0),capHeight:O(Y&&Y.sCapHeight,Q),xHeight:O(Y&&Y.sxHeight,Q),lineGap:O(Y&&Y.sTypoLineGap,te&&te.lineGap),forEachGlyph(pe,ye,fe,Ae){let Re=0;const Be=1/he.unitsPerEm*ye,le=z(H,pe);let me=0,we=-1;return le.forEach((re,Te)=>{if(re!==-1){let Je=$[re];if(!Je){const{cmds:Xe,crds:Ze}=n.U.glyphToPath(H,re);let Fe="",ct=0;for(let Ie=0,pt=Xe.length;Ie<pt;Ie++){const gt=i[Xe[Ie]];Fe+=Xe[Ie];for(let _t=1;_t<=gt;_t++)Fe+=(_t>1?",":"")+Ze[ct++]}let At,kt,Kt,Et;if(Ze.length){At=kt=1/0,Kt=Et=-1/0;for(let Ie=0,pt=Ze.length;Ie<pt;Ie+=2){let gt=Ze[Ie],_t=Ze[Ie+1];gt<At&&(At=gt),_t<kt&&(kt=_t),gt>Kt&&(Kt=gt),_t>Et&&(Et=_t)}}else At=Kt=kt=Et=0;Je=$[re]={index:re,advanceWidth:H.hmtx.aWidth[re],xMin:At,yMin:kt,xMax:Kt,yMax:Et,path:Fe,pathCommandCount:Xe.length}}we!==-1&&(Re+=n.U.getPairAdjustment(H,we,re)*Be),Ae.call(null,Je,Re,me),Je.advanceWidth&&(Re+=Je.advanceWidth*Be),fe&&(Re+=fe*ye),we=re}me+=pe.codePointAt(me)>65535?2:1}),Re}};return he}return function($){const Y=new Uint8Array($,0,4),te=n._bin.readASCII(Y,0,4);if(te==="wOFF")$=e($);else if(te==="wOF2")throw new Error("woff2 fonts not supported");return F(n.parse($)[0])}}const wAe=cS({name:"Typr Font Parser",dependencies:[_Ae,xAe,bAe],init(n,e,i){const a=n(),s=e();return i(a,s)}}),U0={defaultFontURL:"https://fonts.gstatic.com/s/roboto/v18/KFOmCnqEu92Fr1Mu4mxM.woff",sdfGlyphSize:64,sdfMargin:1/16,sdfExponent:9,textureWidth:2048},SAe=new In;function d0(){return(self.performance||Date).now()}const FG=Object.create(null);function hJ(n,e){n=TAe({},n);const i=d0();if(n.font=AAe(n.font||U0.defaultFontURL),n.text=""+n.text,n.sdfGlyphSize=n.sdfGlyphSize||U0.sdfGlyphSize,n.colorRanges!=null){let b={};for(let S in n.colorRanges)if(n.colorRanges.hasOwnProperty(S)){let A=n.colorRanges[S];typeof A!="number"&&(A=SAe.set(A).getHex()),b[S]=A}n.colorRanges=b}Object.freeze(n);const{textureWidth:a,sdfExponent:s}=U0,{sdfGlyphSize:l}=n,d=a/l*4;let f=FG[l];if(!f){const b=document.createElement("canvas");b.width=a,b.height=l*256/d,f=FG[l]={glyphCount:0,sdfGlyphSize:l,sdfCanvas:b,sdfTexture:new Oa(b,void 0,void 0,void 0,ka,ka),contextLost:!1,glyphsByFont:new Map},f.sdfTexture.generateMipmaps=!1,EAe(f)}const{sdfTexture:p,sdfCanvas:y}=f;let _=f.glyphsByFont.get(n.font);_||f.glyphsByFont.set(n.font,_=new Map),PAe(n).then(b=>{const{glyphIds:S,glyphPositions:A,fontSize:P,unitsPerEm:L,timings:k}=b,R=[],z=new Float32Array(S.length*4),O=P/L;let F=0,H=0;const $=d0();S.forEach((he,pe)=>{let ye=_.get(he);if(!ye){const{path:Be,pathBounds:le}=b.glyphData[he],me=Math.max(le[2]-le[0],le[3]-le[1])/l*(U0.sdfMargin*l+.5),we=f.glyphCount++,re=[le[0]-me,le[1]-me,le[2]+me,le[3]+me];_.set(he,ye={path:Be,atlasIndex:we,sdfViewBox:re}),R.push(ye)}const{sdfViewBox:fe}=ye,Ae=A[H++],Re=A[H++];z[F++]=Ae+fe[0]*O,z[F++]=Re+fe[1]*O,z[F++]=Ae+fe[2]*O,z[F++]=Re+fe[3]*O,S[pe]=ye.atlasIndex}),k.quads=(k.quads||0)+(d0()-$);const Y=d0();k.sdf={};const te=y.height,G=Math.ceil(f.glyphCount/d),Q=Math.pow(2,Math.ceil(Math.log2(G*l)));Q>te&&(console.info(`Increasing SDF texture size ${te}->${Q}`),vAe(y,a,Q),p.dispose()),Promise.all(R.map(he=>fJ(he,f,n.gpuAccelerateSDF).then(({timing:pe})=>{k.sdf[he.atlasIndex]=pe}))).then(()=>{R.length&&!f.contextLost&&(pJ(f),p.needsUpdate=!0),k.sdfTotal=d0()-Y,k.total=d0()-i,e(Object.freeze({parameters:n,sdfTexture:p,sdfGlyphSize:l,sdfExponent:s,glyphBounds:z,glyphAtlasIndices:S,glyphColors:b.glyphColors,caretPositions:b.caretPositions,caretHeight:b.caretHeight,chunkedBounds:b.chunkedBounds,ascender:b.ascender,descender:b.descender,lineHeight:b.lineHeight,capHeight:b.capHeight,xHeight:b.xHeight,topBaseline:b.topBaseline,blockBounds:b.blockBounds,visibleBounds:b.visibleBounds,timings:b.timings}))})}),Promise.resolve().then(()=>{f.contextLost||yAe(y)})}function fJ({path:n,atlasIndex:e,sdfViewBox:i},{sdfGlyphSize:a,sdfCanvas:s,contextLost:l},d){if(l)return Promise.resolve({timing:-1});const{textureWidth:f,sdfExponent:p}=U0,y=Math.max(i[2]-i[0],i[3]-i[1]),_=Math.floor(e/4),b=_%(f/a)*a,S=Math.floor(_/(f/a))*a,A=e%4;return dAe(a,a,n,i,y,p,s,b,S,A,d)}function EAe(n){const e=n.sdfCanvas;e.addEventListener("webglcontextlost",i=>{console.log("Context Lost",i),i.preventDefault(),n.contextLost=!0}),e.addEventListener("webglcontextrestored",i=>{console.log("Context Restored",i),n.contextLost=!1;const a=[];n.glyphsByFont.forEach(s=>{s.forEach(l=>{a.push(fJ(l,n,!0))})}),Promise.all(a).then(()=>{pJ(n),n.sdfTexture.needsUpdate=!0})})}function MAe({font:n,characters:e,sdfGlyphSize:i},a){let s=Array.isArray(e)?e.join(`
`):""+e;hJ({font:n,sdfGlyphSize:i,text:s},a)}function TAe(n,e){for(let i in e)e.hasOwnProperty(i)&&(n[i]=e[i]);return n}let EE;function AAe(n){return EE||(EE=typeof document>"u"?{}:document.createElement("a")),EE.href=n,EE.href}function pJ(n){if(typeof createImageBitmap!="function"){console.info("Safari<15: applying SDF canvas workaround");const{sdfCanvas:e,sdfTexture:i}=n,{width:a,height:s}=e,l=n.sdfCanvas.getContext("webgl");let d=i.image.data;(!d||d.length!==a*s*4)&&(d=new Uint8Array(a*s*4),i.image={width:a,height:s,data:d},i.flipY=!1,i.isDataTexture=!0),l.readPixels(0,0,a,s,l.RGBA,l.UNSIGNED_BYTE,d)}}const CAe=cS({name:"Typesetter",dependencies:[U0,wAe,uAe,nAe],init(n,e,i,a){const{defaultFontURL:s}=n;return i(e,a(),{defaultFontURL:s})}}),PAe=cS({name:"Typesetter",dependencies:[CAe],init(n){return function(e){return new Promise(i=>{n.typeset(e,i)})}},getTransferables(n){const e=[n.glyphPositions.buffer,n.glyphIds.buffer];return n.caretPositions&&e.push(n.caretPositions.buffer),n.glyphColors&&e.push(n.glyphColors.buffer),e}}),BG={};function IAe(n){let e=BG[n];if(!e){const i=new Fp(1,1,n,n),a=i.clone(),s=i.attributes,l=a.attributes,d=new zi,f=s.uv.count;for(let p=0;p<f;p++)l.position.array[p*3]*=-1,l.normal.array[p*3+2]*=-1;["position","normal","uv"].forEach(p=>{d.setAttribute(p,new jn([...s[p].array,...l[p].array],s[p].itemSize))}),d.setIndex([...i.index.array,...a.index.array.map(p=>p+f)]),d.translate(.5,.5,0),e=BG[n]=d}return e}const RAe="aTroikaGlyphBounds",UG="aTroikaGlyphIndex",LAe="aTroikaGlyphColor";class kAe extends Hz{constructor(){super(),this.detail=1,this.curveRadius=0,this.groups=[{start:0,count:1/0,materialIndex:0},{start:0,count:1/0,materialIndex:1}],this.boundingSphere=new Fc,this.boundingBox=new Su}computeBoundingSphere(){}computeBoundingBox(){}setSide(e){const i=this.getIndex().count;this.setDrawRange(e===Ts?i/2:0,e===Xl?i:i/2)}set detail(e){if(e!==this._detail){this._detail=e,(typeof e!="number"||e<1)&&(e=1);let i=IAe(e);["position","normal","uv"].forEach(a=>{this.attributes[a]=i.attributes[a].clone()}),this.setIndex(i.getIndex().clone())}}get detail(){return this._detail}set curveRadius(e){e!==this._curveRadius&&(this._curveRadius=e,this._updateBounds())}get curveRadius(){return this._curveRadius}updateGlyphs(e,i,a,s,l){CL(this,RAe,e,4),CL(this,UG,i,1),CL(this,LAe,l,3),this._blockBounds=a,this._chunkedBounds=s,this.instanceCount=i.length,this._updateBounds()}_updateBounds(){const e=this._blockBounds;if(e){const{curveRadius:i,boundingBox:a}=this;if(i){const{PI:s,floor:l,min:d,max:f,sin:p,cos:y}=Math,_=s/2,b=s*2,S=Math.abs(i),A=e[0]/S,P=e[2]/S,L=l((A+_)/b)!==l((P+_)/b)?-S:d(p(A)*S,p(P)*S),k=l((A-_)/b)!==l((P-_)/b)?S:f(p(A)*S,p(P)*S),R=l((A+s)/b)!==l((P+s)/b)?S*2:f(S-y(A)*S,S-y(P)*S);a.min.set(L,e[1],i<0?-R:0),a.max.set(k,e[3],i<0?0:R)}else a.min.set(e[0],e[1],0),a.max.set(e[2],e[3],0);a.getBoundingSphere(this.boundingSphere)}}applyClipRect(e){let i=this.getAttribute(UG).count,a=this._chunkedBounds;if(a)for(let s=a.length;s--;){i=a[s].end;let l=a[s].rect;if(l[1]<e.w&&l[3]>e.y&&l[0]<e.z&&l[2]>e.x)break}this.instanceCount=i}}function CL(n,e,i,a){const s=n.getAttribute(e);i?s&&s.array.length===i.length?(s.array.set(i),s.needsUpdate=!0):(n.setAttribute(e,new Yg(i,a)),delete n._maxInstanceCount,n.dispose()):s&&n.deleteAttribute(e)}const DAe=`
uniform vec2 uTroikaSDFTextureSize;
uniform float uTroikaSDFGlyphSize;
uniform vec4 uTroikaTotalBounds;
uniform vec4 uTroikaClipRect;
uniform mat3 uTroikaOrient;
uniform bool uTroikaUseGlyphColors;
uniform float uTroikaDistanceOffset;
uniform float uTroikaBlurRadius;
uniform vec2 uTroikaPositionOffset;
uniform float uTroikaCurveRadius;
attribute vec4 aTroikaGlyphBounds;
attribute float aTroikaGlyphIndex;
attribute vec3 aTroikaGlyphColor;
varying vec2 vTroikaGlyphUV;
varying vec4 vTroikaTextureUVBounds;
varying float vTroikaTextureChannel;
varying vec3 vTroikaGlyphColor;
varying vec2 vTroikaGlyphDimensions;
`,zAe=`
vec4 bounds = aTroikaGlyphBounds;
bounds.xz += uTroikaPositionOffset.x;
bounds.yw -= uTroikaPositionOffset.y;

vec4 outlineBounds = vec4(
  bounds.xy - uTroikaDistanceOffset - uTroikaBlurRadius,
  bounds.zw + uTroikaDistanceOffset + uTroikaBlurRadius
);
vec4 clippedBounds = vec4(
  clamp(outlineBounds.xy, uTroikaClipRect.xy, uTroikaClipRect.zw),
  clamp(outlineBounds.zw, uTroikaClipRect.xy, uTroikaClipRect.zw)
);

vec2 clippedXY = (mix(clippedBounds.xy, clippedBounds.zw, position.xy) - bounds.xy) / (bounds.zw - bounds.xy);

position.xy = mix(bounds.xy, bounds.zw, clippedXY);

uv = (position.xy - uTroikaTotalBounds.xy) / (uTroikaTotalBounds.zw - uTroikaTotalBounds.xy);

float rad = uTroikaCurveRadius;
if (rad != 0.0) {
  float angle = position.x / rad;
  position.xz = vec2(sin(angle) * rad, rad - cos(angle) * rad);
  normal.xz = vec2(sin(angle), cos(angle));
}
  
position = uTroikaOrient * position;
normal = uTroikaOrient * normal;

vTroikaGlyphUV = clippedXY.xy;
vTroikaGlyphDimensions = vec2(bounds[2] - bounds[0], bounds[3] - bounds[1]);


float txCols = uTroikaSDFTextureSize.x / uTroikaSDFGlyphSize;
vec2 txUvPerSquare = uTroikaSDFGlyphSize / uTroikaSDFTextureSize;
vec2 txStartUV = txUvPerSquare * vec2(
  mod(floor(aTroikaGlyphIndex / 4.0), txCols),
  floor(floor(aTroikaGlyphIndex / 4.0) / txCols)
);
vTroikaTextureUVBounds = vec4(txStartUV, vec2(txStartUV) + txUvPerSquare);
vTroikaTextureChannel = mod(aTroikaGlyphIndex, 4.0);
`,OAe=`
uniform sampler2D uTroikaSDFTexture;
uniform vec2 uTroikaSDFTextureSize;
uniform float uTroikaSDFGlyphSize;
uniform float uTroikaSDFExponent;
uniform float uTroikaDistanceOffset;
uniform float uTroikaFillOpacity;
uniform float uTroikaOutlineOpacity;
uniform float uTroikaBlurRadius;
uniform vec3 uTroikaStrokeColor;
uniform float uTroikaStrokeWidth;
uniform float uTroikaStrokeOpacity;
uniform bool uTroikaSDFDebug;
varying vec2 vTroikaGlyphUV;
varying vec4 vTroikaTextureUVBounds;
varying float vTroikaTextureChannel;
varying vec2 vTroikaGlyphDimensions;

float troikaSdfValueToSignedDistance(float alpha) {
  // Inverse of exponential encoding in webgl-sdf-generator
  
  float maxDimension = max(vTroikaGlyphDimensions.x, vTroikaGlyphDimensions.y);
  float absDist = (1.0 - pow(2.0 * (alpha > 0.5 ? 1.0 - alpha : alpha), 1.0 / uTroikaSDFExponent)) * maxDimension;
  float signedDist = absDist * (alpha > 0.5 ? -1.0 : 1.0);
  return signedDist;
}

float troikaGlyphUvToSdfValue(vec2 glyphUV) {
  vec2 textureUV = mix(vTroikaTextureUVBounds.xy, vTroikaTextureUVBounds.zw, glyphUV);
  vec4 rgba = texture2D(uTroikaSDFTexture, textureUV);
  float ch = floor(vTroikaTextureChannel + 0.5); //NOTE: can't use round() in WebGL1
  return ch == 0.0 ? rgba.r : ch == 1.0 ? rgba.g : ch == 2.0 ? rgba.b : rgba.a;
}

float troikaGlyphUvToDistance(vec2 uv) {
  return troikaSdfValueToSignedDistance(troikaGlyphUvToSdfValue(uv));
}

float troikaGetAADist() {
  
  #if defined(GL_OES_standard_derivatives) || __VERSION__ >= 300
  return length(fwidth(vTroikaGlyphUV * vTroikaGlyphDimensions)) * 0.5;
  #else
  return vTroikaGlyphDimensions.x / 64.0;
  #endif
}

float troikaGetFragDistValue() {
  vec2 clampedGlyphUV = clamp(vTroikaGlyphUV, 0.5 / uTroikaSDFGlyphSize, 1.0 - 0.5 / uTroikaSDFGlyphSize);
  float distance = troikaGlyphUvToDistance(clampedGlyphUV);
 
  // Extrapolate distance when outside bounds:
  distance += clampedGlyphUV == vTroikaGlyphUV ? 0.0 : 
    length((vTroikaGlyphUV - clampedGlyphUV) * vTroikaGlyphDimensions);

  

  return distance;
}

float troikaGetEdgeAlpha(float distance, float distanceOffset, float aaDist) {
  #if defined(IS_DEPTH_MATERIAL) || defined(IS_DISTANCE_MATERIAL)
  float alpha = step(-distanceOffset, -distance);
  #else

  float alpha = smoothstep(
    distanceOffset + aaDist,
    distanceOffset - aaDist,
    distance
  );
  #endif

  return alpha;
}
`,NAe=`
float aaDist = troikaGetAADist();
float fragDistance = troikaGetFragDistValue();
float edgeAlpha = uTroikaSDFDebug ?
  troikaGlyphUvToSdfValue(vTroikaGlyphUV) :
  troikaGetEdgeAlpha(fragDistance, uTroikaDistanceOffset, max(aaDist, uTroikaBlurRadius));

#if !defined(IS_DEPTH_MATERIAL) && !defined(IS_DISTANCE_MATERIAL)
vec4 fillRGBA = gl_FragColor;
fillRGBA.a *= uTroikaFillOpacity;
vec4 strokeRGBA = uTroikaStrokeWidth == 0.0 ? fillRGBA : vec4(uTroikaStrokeColor, uTroikaStrokeOpacity);
if (fillRGBA.a == 0.0) fillRGBA.rgb = strokeRGBA.rgb;
gl_FragColor = mix(fillRGBA, strokeRGBA, smoothstep(
  -uTroikaStrokeWidth - aaDist,
  -uTroikaStrokeWidth + aaDist,
  fragDistance
));
gl_FragColor.a *= edgeAlpha;
#endif

if (edgeAlpha == 0.0) {
  discard;
}
`;function FAe(n){const e=nD(n,{chained:!0,extensions:{derivatives:!0},uniforms:{uTroikaSDFTexture:{value:null},uTroikaSDFTextureSize:{value:new tn},uTroikaSDFGlyphSize:{value:0},uTroikaSDFExponent:{value:0},uTroikaTotalBounds:{value:new Lr(0,0,0,0)},uTroikaClipRect:{value:new Lr(0,0,0,0)},uTroikaDistanceOffset:{value:0},uTroikaOutlineOpacity:{value:0},uTroikaFillOpacity:{value:1},uTroikaPositionOffset:{value:new tn},uTroikaCurveRadius:{value:0},uTroikaBlurRadius:{value:0},uTroikaStrokeWidth:{value:0},uTroikaStrokeColor:{value:new In},uTroikaStrokeOpacity:{value:1},uTroikaOrient:{value:new Vi},uTroikaUseGlyphColors:{value:!0},uTroikaSDFDebug:{value:!1}},vertexDefs:DAe,vertexTransform:zAe,fragmentDefs:OAe,fragmentColorTransform:NAe,customRewriter({vertexShader:i,fragmentShader:a}){let s=/\buniform\s+vec3\s+diffuse\b/;return s.test(a)&&(a=a.replace(s,"varying vec3 vTroikaGlyphColor").replace(/\bdiffuse\b/g,"vTroikaGlyphColor"),s.test(i)||(i=i.replace(uJ,`uniform vec3 diffuse;
$&
vTroikaGlyphColor = uTroikaUseGlyphColors ? aTroikaGlyphColor / 255.0 : diffuse;
`))),{vertexShader:i,fragmentShader:a}}});return e.transparent=!0,Object.defineProperties(e,{isTroikaTextMaterial:{value:!0},shadowSide:{get(){return this.side},set(){}}}),e}const eO=new Kh({color:16777215,side:Xl,transparent:!0}),WG=8421504,VG=new Di,ME=new We,PL=new We,kx=[],BAe=new We,IL="+x+y";function GG(n){return Array.isArray(n)?n[0]:n}let mJ=()=>{const n=new Eo(new Fp(1,1),eO);return mJ=()=>n,n},gJ=()=>{const n=new Eo(new Fp(1,1,32,1),eO);return gJ=()=>n,n};const UAe={type:"syncstart"},WAe={type:"synccomplete"},yJ=["font","fontSize","letterSpacing","lineHeight","maxWidth","overflowWrap","text","direction","textAlign","textIndent","whiteSpace","anchorX","anchorY","colorRanges","sdfGlyphSize"],VAe=yJ.concat("material","color","depthOffset","clipRect","curveRadius","orientation","glyphGeometryDetail");let vJ=class extends Eo{constructor(){const e=new kAe;super(e,null),this.text="",this.anchorX=0,this.anchorY=0,this.curveRadius=0,this.direction="auto",this.font=null,this.fontSize=.1,this.letterSpacing=0,this.lineHeight="normal",this.maxWidth=1/0,this.overflowWrap="normal",this.textAlign="left",this.textIndent=0,this.whiteSpace="normal",this.material=null,this.color=null,this.colorRanges=null,this.outlineWidth=0,this.outlineColor=0,this.outlineOpacity=1,this.outlineBlur=0,this.outlineOffsetX=0,this.outlineOffsetY=0,this.strokeWidth=0,this.strokeColor=WG,this.strokeOpacity=1,this.fillOpacity=1,this.depthOffset=0,this.clipRect=null,this.orientation=IL,this.glyphGeometryDetail=1,this.sdfGlyphSize=null,this.gpuAccelerateSDF=!0,this.debugSDF=!1}sync(e){this._needsSync&&(this._needsSync=!1,this._isSyncing?(this._queuedSyncs||(this._queuedSyncs=[])).push(e):(this._isSyncing=!0,this.dispatchEvent(UAe),hJ({text:this.text,font:this.font,fontSize:this.fontSize||.1,letterSpacing:this.letterSpacing||0,lineHeight:this.lineHeight||"normal",maxWidth:this.maxWidth,direction:this.direction||"auto",textAlign:this.textAlign,textIndent:this.textIndent,whiteSpace:this.whiteSpace,overflowWrap:this.overflowWrap,anchorX:this.anchorX,anchorY:this.anchorY,colorRanges:this.colorRanges,includeCaretPositions:!0,sdfGlyphSize:this.sdfGlyphSize,gpuAccelerateSDF:this.gpuAccelerateSDF},i=>{this._isSyncing=!1,this._textRenderInfo=i,this.geometry.updateGlyphs(i.glyphBounds,i.glyphAtlasIndices,i.blockBounds,i.chunkedBounds,i.glyphColors);const a=this._queuedSyncs;a&&(this._queuedSyncs=null,this._needsSync=!0,this.sync(()=>{a.forEach(s=>s&&s())})),this.dispatchEvent(WAe),e&&e()})))}onBeforeRender(e,i,a,s,l,d){this.sync(),l.isTroikaTextMaterial&&this._prepareForRender(l),l._hadOwnSide=l.hasOwnProperty("side"),this.geometry.setSide(l._actualSide=l.side),l.side=Ad}onAfterRender(e,i,a,s,l,d){l._hadOwnSide?l.side=l._actualSide:delete l.side}dispose(){this.geometry.dispose()}get textRenderInfo(){return this._textRenderInfo||null}get material(){let e=this._derivedMaterial;const i=this._baseMaterial||this._defaultMaterial||(this._defaultMaterial=eO.clone());if((!e||e.baseMaterial!==i)&&(e=this._derivedMaterial=FAe(i),i.addEventListener("dispose",function a(){i.removeEventListener("dispose",a),e.dispose()})),this.outlineWidth||this.outlineBlur||this.outlineOffsetX||this.outlineOffsetY){let a=e._outlineMtl;return a||(a=e._outlineMtl=Object.create(e,{id:{value:e.id+.1}}),a.isTextOutlineMaterial=!0,a.depthWrite=!1,a.map=null,e.addEventListener("dispose",function s(){e.removeEventListener("dispose",s),a.dispose()})),[a,e]}else return e}set material(e){e&&e.isTroikaTextMaterial?(this._derivedMaterial=e,this._baseMaterial=e.baseMaterial):this._baseMaterial=e}get glyphGeometryDetail(){return this.geometry.detail}set glyphGeometryDetail(e){this.geometry.detail=e}get curveRadius(){return this.geometry.curveRadius}set curveRadius(e){this.geometry.curveRadius=e}get customDepthMaterial(){return GG(this.material).getDepthMaterial()}get customDistanceMaterial(){return GG(this.material).getDistanceMaterial()}_prepareForRender(e){const i=e.isTextOutlineMaterial,a=e.uniforms,s=this.textRenderInfo;if(s){const{sdfTexture:f,blockBounds:p}=s;a.uTroikaSDFTexture.value=f,a.uTroikaSDFTextureSize.value.set(f.image.width,f.image.height),a.uTroikaSDFGlyphSize.value=s.sdfGlyphSize,a.uTroikaSDFExponent.value=s.sdfExponent,a.uTroikaTotalBounds.value.fromArray(p),a.uTroikaUseGlyphColors.value=!i&&!!s.glyphColors;let y=0,_=0,b=0,S,A,P,L=0,k=0;if(i){let{outlineWidth:z,outlineOffsetX:O,outlineOffsetY:F,outlineBlur:H,outlineOpacity:$}=this;y=this._parsePercent(z)||0,_=Math.max(0,this._parsePercent(H)||0),S=$,L=this._parsePercent(O)||0,k=this._parsePercent(F)||0}else b=Math.max(0,this._parsePercent(this.strokeWidth)||0),b&&(P=this.strokeColor,a.uTroikaStrokeColor.value.set(P??WG),A=this.strokeOpacity,A==null&&(A=1)),S=this.fillOpacity;a.uTroikaDistanceOffset.value=y,a.uTroikaPositionOffset.value.set(L,k),a.uTroikaBlurRadius.value=_,a.uTroikaStrokeWidth.value=b,a.uTroikaStrokeOpacity.value=A,a.uTroikaFillOpacity.value=S??1,a.uTroikaCurveRadius.value=this.curveRadius||0;let R=this.clipRect;if(R&&Array.isArray(R)&&R.length===4)a.uTroikaClipRect.value.fromArray(R);else{const z=(this.fontSize||.1)*100;a.uTroikaClipRect.value.set(p[0]-z,p[1]-z,p[2]+z,p[3]+z)}this.geometry.applyClipRect(a.uTroikaClipRect.value)}a.uTroikaSDFDebug.value=!!this.debugSDF,e.polygonOffset=!!this.depthOffset,e.polygonOffsetFactor=e.polygonOffsetUnits=this.depthOffset||0;const l=i?this.outlineColor||0:this.color;if(l==null)delete e.color;else{const f=e.hasOwnProperty("color")?e.color:e.color=new In;(l!==f._input||typeof l=="object")&&f.set(f._input=l)}let d=this.orientation||IL;if(d!==e._orientation){let f=a.uTroikaOrient.value;d=d.replace(/[^-+xyz]/g,"");let p=d!==IL&&d.match(/^([-+])([xyz])([-+])([xyz])$/);if(p){let[,y,_,b,S]=p;ME.set(0,0,0)[_]=y==="-"?1:-1,PL.set(0,0,0)[S]=b==="-"?-1:1,VG.lookAt(BAe,ME.cross(PL),PL),f.setFromMatrix4(VG)}else f.identity();e._orientation=d}}_parsePercent(e){if(typeof e=="string"){let i=e.match(/^(-?[\d.]+)%$/),a=i?parseFloat(i[1]):NaN;e=(isNaN(a)?0:a/100)*this.fontSize}return e}localPositionToTextCoords(e,i=new tn){i.copy(e);const a=this.curveRadius;return a&&(i.x=Math.atan2(e.x,Math.abs(a)-Math.abs(e.z))*Math.abs(a)),i}worldPositionToTextCoords(e,i=new tn){return ME.copy(e),this.localPositionToTextCoords(this.worldToLocal(ME),i)}raycast(e,i){const{textRenderInfo:a,curveRadius:s}=this;if(a){const l=a.blockBounds,d=s?gJ():mJ(),f=d.geometry,{position:p,uv:y}=f.attributes;for(let _=0;_<y.count;_++){let b=l[0]+y.getX(_)*(l[2]-l[0]);const S=l[1]+y.getY(_)*(l[3]-l[1]);let A=0;s&&(A=s-Math.cos(b/s)*s,b=Math.sin(b/s)*s),p.setXYZ(_,b,S,A)}f.boundingSphere=this.geometry.boundingSphere,f.boundingBox=this.geometry.boundingBox,d.matrixWorld=this.matrixWorld,d.material.side=this.material.side,kx.length=0,d.raycast(e,kx);for(let _=0;_<kx.length;_++)kx[_].object=this,i.push(kx[_])}}copy(e){const i=this.geometry;return super.copy(e),this.geometry=i,VAe.forEach(a=>{this[a]=e[a]}),this}clone(){return new this.constructor().copy(this)}};yJ.forEach(n=>{const e="_private_"+n;Object.defineProperty(vJ.prototype,n,{get(){return this[e]},set(i){i!==this[e]&&(this[e]=i,this._needsSync=!0)}})});const Tb=ne.forwardRef(({sdfGlyphSize:n=64,anchorX:e="center",anchorY:i="middle",font:a,fontSize:s=1,children:l,characters:d,onSync:f,...p},y)=>{const _=Eh(({invalidate:P})=>P),[b]=ne.useState(()=>new vJ),[S,A]=ne.useMemo(()=>{const P=[];let L="";return ne.Children.forEach(l,k=>{typeof k=="string"||typeof k=="number"?L+=k:P.push(k)}),[P,L]},[l]);return HK(()=>new Promise(P=>MAe({font:a,characters:d},P)),["troika-text",a,d]),ne.useLayoutEffect(()=>void b.sync(()=>{_(),f&&f(b)})),ne.useEffect(()=>()=>b.dispose(),[b]),ne.createElement("primitive",Ge({object:b,ref:y,font:a,text:A,anchorX:e,anchorY:i,fontSize:s,sdfGlyphSize:n},p),S)}),GAe=ne.forwardRef(({makeDefault:n,camera:e,regress:i,domElement:a,enableDamping:s=!0,keyEvents:l=!1,onChange:d,onStart:f,onEnd:p,...y},_)=>{const b=Eh($=>$.invalidate),S=Eh($=>$.camera),A=Eh($=>$.gl),P=Eh($=>$.events),L=Eh($=>$.setEvents),k=Eh($=>$.set),R=Eh($=>$.get),z=Eh($=>$.performance),O=e||S,F=a||P.connected||A.domElement,H=ne.useMemo(()=>new XTe(O),[O]);return Kz(()=>{H.enabled&&H.update()},-1),ne.useEffect(()=>(l&&H.connect(l===!0?F:l),H.connect(F),()=>void H.dispose()),[l,F,i,H,b]),ne.useEffect(()=>{const $=G=>{b(),i&&z.regress(),d&&d(G)},Y=G=>{f&&f(G)},te=G=>{p&&p(G)};return H.addEventListener("change",$),H.addEventListener("start",Y),H.addEventListener("end",te),()=>{H.removeEventListener("start",Y),H.removeEventListener("end",te),H.removeEventListener("change",$)}},[d,f,p,H,b,L]),ne.useEffect(()=>{if(n){const $=R().controls;return k({controls:H}),()=>k({controls:$})}},[n,H]),ne.createElement("primitive",Ge({ref:_,object:H,enableDamping:s},y))}),h0=({value:n,label:e,options:i,onChange:a})=>{const{classes:s}=cz(),[l,d]=ne.useState(!1),f=()=>{d(!1)};return _e(tX,{children:[U(oX,{children:e}),_e(pX,{className:s.filterSelect,open:l,value:n,onOpen:f,onChange:a,variant:"outlined",label:e,sx:{boxShadow:"none",".MuiOutlinedInput-notchedOutline":{border:0},"&.MuiOutlinedInput-root.Mui-focused .MuiOutlinedInput-notchedOutline":{border:0}},renderValue:p=>p.length===0?U("em",{children:e}):p,children:[U(Tp,{disabled:!0,value:"",children:U("em",{children:e})}),i.map(p=>U(Tp,{value:p,children:p},p))]})]})},HAe=()=>{const{classes:n}=cz(),[e,i]=ne.useState(!1),[a,s]=ne.useState("Country"),[l,d]=ne.useState("Climate"),[f,p]=ne.useState("Risk exposure"),[y,_]=ne.useState("Income group"),[b,S]=ne.useState("Population group"),[A,P]=ne.useState("Rating"),L=ne.useCallback(H=>{s(H.target.value)},[]),k=ne.useCallback(H=>{d(H.target.value)},[]),R=ne.useCallback(H=>{p(H.target.value)},[]),z=ne.useCallback(H=>{_(H.target.value)},[]),O=ne.useCallback(H=>{S(H.target.value)},[]),F=ne.useCallback(H=>{P(H.target.value)},[]);return U("div",{className:n.filterButtonsWrapper,children:e?_e("div",{children:[U("div",{onClick:()=>i(!1),className:n.blurAll}),U(h0,{value:a,label:"Country",options:["Country","Canada"],onChange:L}),U(h0,{value:l,label:"Climate",options:["Climate","Tropical"],onChange:k}),U(h0,{value:f,label:"Risk exposure",options:["Risk exposure","Low"],onChange:R}),U(h0,{value:y,label:"Income group",options:["Income group","High"],onChange:z}),U(h0,{value:b,label:"Population group",options:["Population group","High"],onChange:O}),U(h0,{value:A,label:"Rating",options:["Rating","High"],onChange:F}),_e(oi,{style:{color:"white",background:"#2D67FF",gap:"10px"},className:n.filterButton,variant:"outlined",onClick:()=>i(!1),children:["Close",U("img",{style:{height:"1.1vh"},src:"assets/closeIcon.svg",alt:"close"})]})]}):U(oi,{className:n.filterButton,variant:"outlined",onClick:()=>{i(!0)},children:"Filter by"})})},jAe={firstRow:"Choose a city and ",secondRow:"view its ",score:"score",howRatingWorks:"How rating works",map:"Map",graph:"Graph",filterBy:"Filter by",smallTextGraph1:"Urban Resilience Index (URI) is a tool to measure environmental (E), social (S), and governmental (G) performance of urban areas as well as their ability & willingness to achieve better practices.",smallTextGraph2:"URI shows whether the basic needs of residents are satisfied, how vulnerable the place is to crises and how it impacts the world around.",smallTextGraph3:"At the graph color represents the cities' overall ratings (see right scale) while position against E, S and G axes reflects respective component scoring."},$Ae=({map:n,currentView:e,setCurrentView:i,isZoomButtonsVisible:a})=>{const s=p=>jAe[p],{classes:l}=cz(),d=ne.useCallback(()=>{i("map")},[]),f=ne.useCallback(()=>{i("graph")},[]);return _e("div",{className:l.root,children:[U("div",{className:l.topLineWrapper,children:_e("div",{className:l.textAndToggleWrapper,children:[_e(nn,{className:l.bigText,children:[s("firstRow")," ",U("br",{}),s("secondRow"),U("span",{className:l.bigTextBlue,children:s("score")})]}),_e(cxe,{children:[U(OV,{value:"map",selected:e==="map",onClick:d,children:s("map")}),U(OV,{value:"graph",selected:e==="graph",onClick:f,children:s("graph")})]}),!a&&_e(nn,{className:l.bigTextSubtitle,children:[s("smallTextGraph1")," ",U("br",{}),U("br",{}),s("smallTextGraph2")," ",U("br",{}),U("br",{}),s("smallTextGraph3")]})]})}),U(HAe,{}),U("img",{className:l.legendLine,src:"/assets/legendLine.svg",alt:"legend"}),_e("div",{className:l.bottomWrapper,children:[_e("div",{className:l.smallTextWrapper,children:[U(nn,{className:l.smallText,children:s("howRatingWorks")}),U("img",{src:"/assets/hintQuestionIcon.svg",alt:"hint"})]}),a&&U(fxe,{map:n})]})]})},YAe=()=>{const n=[new We(0,0,0),new We(6,0,0)],e=[new We(0,0,0),new We(0,6,0)],i=[new We(0,0,0),new We(0,0,6)],a=new zi().setFromPoints(n),s=new zi().setFromPoints(e),l=new zi().setFromPoints(i),d=Jz(SK,"/textures/texture_cage_radial_fade_2.svg");return _e("group",{children:[U("mesh",{position:[4.5,.5,0],children:U(Tb,{fontSize:.5,color:"white",children:"Environmental"})}),U("mesh",{position:[.5,5,0],rotation:[0,0,Math.PI/2],children:U(Tb,{fontSize:.5,color:"white",children:"Social"})}),U("mesh",{position:[0,.5,4.5],rotation:[0,-Math.PI/2,0],children:U(Tb,{fontSize:.5,color:"white",children:"Governmental"})}),_e("group",{children:[U("line",{geometry:a,children:U("lineBasicMaterial",{color:"white"})}),_e("mesh",{position:[6,0,0],rotation:[0,0,-Math.PI/2],children:[U("coneGeometry",{args:[.1,.3,10]}),U("meshBasicMaterial",{color:"white"})]})]}),_e("group",{children:[U("line",{geometry:s,children:U("lineBasicMaterial",{color:"white"})}),_e("mesh",{position:[0,6,0],rotation:[0,0,0],children:[U("coneGeometry",{args:[.1,.3,10]}),U("meshBasicMaterial",{color:"white"})]})]}),_e("group",{children:[U("line",{geometry:l,children:U("lineBasicMaterial",{color:"white"})}),_e("mesh",{position:[0,0,6],rotation:[Math.PI/2,0,0],children:[U("coneGeometry",{args:[.1,.3,10]}),U("meshBasicMaterial",{color:"white"})]})]}),_e("mesh",{position:[0,-.02,0],rotation:[-Math.PI/2,0,0],children:[U("planeGeometry",{args:[16,16]}),U("meshStandardMaterial",{map:d,transparent:!0,opacity:.5,side:Xl})]})]})},qAe=([n,e,i])=>{const a=[],s=[],l=[],d=[];for(let p=0;p<=e;p+=.5)a.push({x:n,y:p,z:i});for(let p=0;p<=n;p+=.5)s.push({x:p,y:0,z:i});for(let p=0;p<=i;p+=.5)l.push({x:n,y:0,z:p});for(let p=0;p<=e;p+=.5)d.push({x:n-n/e*p,y:e,z:i-i/e*p});return _e(ko,{children:[a.map(p=>_e("mesh",{position:[p.x-n,p.y-e,p.z-i],children:[U("boxGeometry",{args:[.02,.2,.02]}),U("meshStandardMaterial",{transparent:!0,opacity:.8,color:"white"})]},p.y)),s.map(p=>_e("mesh",{position:[p.x-n,p.y-e,p.z-i],children:[U("boxGeometry",{args:[.2,.02,.02]}),U("meshStandardMaterial",{transparent:!0,opacity:.8,color:"white"})]},p.x)),l.map(p=>_e("mesh",{position:[p.x-n,p.y-e,p.z-i],children:[U("boxGeometry",{args:[.02,.02,.2]}),U("meshStandardMaterial",{transparent:!0,opacity:.8,color:"white"})]},p.z)),d.map(p=>_e("mesh",{rotation:[0,Math.atan2(p.x-n,p.z-i),0],position:[p.x-n,p.y-e,p.z-i],children:[U("boxGeometry",{args:[.02,.02,.2]}),U("meshStandardMaterial",{transparent:!0,opacity:.8,color:"white"})]},p.z))]})},XAe=({item:n,color:e,setSelectedCity:i})=>{const a=ne.useRef(),s=ne.useRef(),l=ne.useRef(),[d,f]=ne.useState(!1),[p,y]=ne.useState(!1);return Kz(_=>{s.current.lookAt(_.camera.position),l.current.lookAt(_.camera.position)}),_e("group",{ref:a,position:n.position,children:[_e("mesh",{ref:l,children:[U("torusGeometry",{args:p?[.32,.015,100,100]:[.35,.015,100,100]}),U("meshStandardMaterial",{color:e,transparent:!0,opacity:1})]}),_e("mesh",{onClick:()=>{f(!0),i(n.label)},onPointerMissed:()=>{f(!1)},onPointerOver:()=>{y(!0)},onPointerOut:()=>{y(!1)},children:[U("sphereGeometry",{args:[.2,100,100]}),U("meshStandardMaterial",{color:e})]}),_e("mesh",{ref:s,position:[0,1.5,0],children:[U(Tb,{fontSize:.45,color:"white",anchorX:"center",anchorY:"middle",children:p&&n.label}),U(Tb,{fontSize:.45,color:e,anchorX:"center",anchorY:"middle",position:[0,-.5,0],children:p&&n.status}),U("meshStandardMaterial",{color:"black"})]}),p&&qAe(n.position)]},n.label)},ZAe=({data:n,color:e,setSelectedCity:i})=>{const a=ne.useRef();return Kz(({camera:s})=>{s.lookAt(2,-6,0)}),_e("group",{ref:a,position:[2,-10,1],rotation:[0,1,0],children:[U(YAe,{}),n.map(s=>U(XAe,{item:s,color:s.color,setSelectedCity:i},s.label))]})},KAe=[{position:[3,5,5],label:"Dubai",color:"#B7DE86",status:"A-3"},{position:[4,5,5],label:"Expo City Dubai",color:"#75D652",status:"A-2"},{position:[2,2,1],label:"Valparaiso",color:"#FF9B3F",status:"C-1"},{position:[1,1,1],label:"Dar es Salaam",color:"#FF632F",status:"C-2"},{position:[4,1,4],label:"Adoni",color:"#FF632F",status:"C-2"},{position:[4,3,3],label:"Natal",color:"#FFD748",status:"B-2"},{position:[3,1,3],label:"Brazzaville",color:"#FF9B3F",status:"C-1"},{position:[3,2,2],label:"Almaty",color:"#D6E15A",status:"B-1"},{position:[3,3,4],label:"Cape Town",color:"#FFD748",status:"B-2"},{position:[2,2,2],label:"Mexico City",color:"#FF632F",status:"C-2"},{position:[2,3,3],label:"Jakarta",color:"#FFD748",status:"B-3"},{position:[3,4,3],label:"Panama City",color:"#ECE38E",status:"B-1"},{position:[2,4,4],label:"Amman",color:"#ECE38E",status:"B-1"},{position:[2,3,2],label:"Bangkok",color:"#FFD748",status:"B-3"},{position:[3,3,3],label:"Colombo",color:"#FFD748",status:"B-2"}],_J=({setSelectedCity:n,isMobile:e=!1})=>{const{classes:i}=lz();return U("div",{className:i.graph3dWrapper,style:{top:e?"-20%":"-30%",left:e?"0":"8%"},children:U(ne.Suspense,{fallback:null,children:_e(jTe,{style:{background:"transparent "},camera:{position:e?[16.5,16.5,16.5]:[11,11,11],fov:50},children:[U("ambientLight",{intensity:1,castShadow:!0}),U("directionalLight",{intensity:1,position:[10,10,0],castShadow:!0}),U(ZAe,{data:KAe,setSelectedCity:n}),U(GAe,{enableZoom:!1,makeDefault:!0,minPolarAngle:Math.PI/4,maxPolarAngle:Math.PI/2,minAzimuthAngle:Math.PI/4,maxAzimuthAngle:Math.PI/2})]})})})};var xJ={exports:{}};(function(n,e){(function(i,a){n.exports=a()})(Qoe,function(){var i,a,s;function l(f,p){if(!i)i=p;else if(!a)a=p;else{var y="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+i+")(sharedChunk); ("+a+")(sharedChunk); self.onerror = null;",_={};i(_),s=p(_),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(s.workerUrl=window.URL.createObjectURL(new Blob([y],{type:"text/javascript"})))}}l(["exports"],function(f){var p=typeof self<"u"?self:{},y="3.0.0-rc.2";let _;const b={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(_==null){const r=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{_={}.API_URL_REGEX!=null?new RegExp({}.API_URL_REGEX):r}catch{_=r}}return _},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!b.API_URL)return null;try{const r=new URL(b.API_URL);return r.hostname==="api.mapbox.cn"?"https://events.mapbox.cn/events/v2":r.hostname==="api.mapbox.com"?"https://events.mapbox.com/events/v2":null}catch{return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,DEFAULT_STYLE:"mapbox://styles/mapbox/standard",MAX_PARALLEL_IMAGE_REQUESTS:16,DRACO_URL:"https://api.mapbox.com/mapbox-gl-js/draco_decoder_gltf_v1.5.6.wasm",GLYPHS_URL:"mapbox://fonts/mapbox/{fontstack}/{range}.pbf"},S={supported:!1,testSupport:function(r){!L&&P&&(k?R(r):A=r)}};let A,P,L=!1,k=!1;function R(r){const t=r.createTexture();r.bindTexture(r.TEXTURE_2D,t);try{if(r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,P),r.isContextLost())return;S.supported=!0}catch{}r.deleteTexture(t),L=!0}p.document&&(P=p.document.createElement("img"),P.onload=function(){A&&R(A),A=null,k=!0},P.onerror=function(){L=!0,A=null},P.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const z="01";function O(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var F=H;function H(r,t,o,c){this.cx=3*r,this.bx=3*(o-r)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(c-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=r,this.p1y=t,this.p2x=o,this.p2y=c}H.prototype={sampleCurveX:function(r){return((this.ax*r+this.bx)*r+this.cx)*r},sampleCurveY:function(r){return((this.ay*r+this.by)*r+this.cy)*r},sampleCurveDerivativeX:function(r){return(3*this.ax*r+2*this.bx)*r+this.cx},solveCurveX:function(r,t){if(t===void 0&&(t=1e-6),r<0)return 0;if(r>1)return 1;for(var o=r,c=0;c<8;c++){var u=this.sampleCurveX(o)-r;if(Math.abs(u)<t)return o;var h=this.sampleCurveDerivativeX(o);if(Math.abs(h)<1e-6)break;o-=u/h}var m=0,g=1;for(o=r,c=0;c<20&&(u=this.sampleCurveX(o),!(Math.abs(u-r)<t));c++)r>u?m=o:g=o,o=.5*(g-m)+m;return o},solve:function(r,t){return this.sampleCurveY(this.solveCurveX(r,t))}};var $=O(F),Y=te;function te(r,t){this.x=r,this.y=t}te.prototype={clone:function(){return new te(this.x,this.y)},add:function(r){return this.clone()._add(r)},sub:function(r){return this.clone()._sub(r)},multByPoint:function(r){return this.clone()._multByPoint(r)},divByPoint:function(r){return this.clone()._divByPoint(r)},mult:function(r){return this.clone()._mult(r)},div:function(r){return this.clone()._div(r)},rotate:function(r){return this.clone()._rotate(r)},rotateAround:function(r,t){return this.clone()._rotateAround(r,t)},matMult:function(r){return this.clone()._matMult(r)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(r){return this.x===r.x&&this.y===r.y},dist:function(r){return Math.sqrt(this.distSqr(r))},distSqr:function(r){var t=r.x-this.x,o=r.y-this.y;return t*t+o*o},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(r){return Math.atan2(this.y-r.y,this.x-r.x)},angleWith:function(r){return this.angleWithSep(r.x,r.y)},angleWithSep:function(r,t){return Math.atan2(this.x*t-this.y*r,this.x*r+this.y*t)},_matMult:function(r){var t=r[2]*this.x+r[3]*this.y;return this.x=r[0]*this.x+r[1]*this.y,this.y=t,this},_add:function(r){return this.x+=r.x,this.y+=r.y,this},_sub:function(r){return this.x-=r.x,this.y-=r.y,this},_mult:function(r){return this.x*=r,this.y*=r,this},_div:function(r){return this.x/=r,this.y/=r,this},_multByPoint:function(r){return this.x*=r.x,this.y*=r.y,this},_divByPoint:function(r){return this.x/=r.x,this.y/=r.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var r=this.y;return this.y=this.x,this.x=-r,this},_rotate:function(r){var t=Math.cos(r),o=Math.sin(r),c=o*this.x+t*this.y;return this.x=t*this.x-o*this.y,this.y=c,this},_rotateAround:function(r,t){var o=Math.cos(r),c=Math.sin(r),u=t.y+c*(this.x-t.x)+o*(this.y-t.y);return this.x=t.x+o*(this.x-t.x)-c*(this.y-t.y),this.y=u,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},te.convert=function(r){return r instanceof te?r:Array.isArray(r)?new te(r[0],r[1]):r};var G=O(Y);function Q(r,t){if(Array.isArray(r)){if(!Array.isArray(t)||r.length!==t.length)return!1;for(let o=0;o<r.length;o++)if(!Q(r[o],t[o]))return!1;return!0}if(typeof r=="object"&&r!==null&&t!==null){if(typeof t!="object"||Object.keys(r).length!==Object.keys(t).length)return!1;for(const o in r)if(!Q(r[o],t[o]))return!1;return!0}return r===t}const he=Math.PI/180,pe=180/Math.PI;function ye(r){return r*he}function fe(r){return r*pe}const Ae=[[0,0],[1,0],[1,1],[0,1]];function Re(r){if(r<=0)return 0;if(r>=1)return 1;const t=r*r,o=t*r;return 4*(r<.5?o:3*(r-t)+o-.75)}function Be(r){let t=1/0,o=1/0,c=-1/0,u=-1/0;for(const h of r)t=Math.min(t,h.x),o=Math.min(o,h.y),c=Math.max(c,h.x),u=Math.max(u,h.y);return{min:new G(t,o),max:new G(c,u)}}function le(r,t,o=0,c=!0){const u=new G(o,o),h=r.sub(u),m=t.add(u),g=[h,new G(m.x,h.y),m,new G(h.x,m.y)];return c&&g.push(h.clone()),g}function me(r,t,o,c){const u=new $(r,t,o,c);return function(h){return u.solve(h)}}const we=me(.25,.1,.25,1);function re(r,t,o){return Math.min(o,Math.max(t,r))}function Te(r,t,o){return(o=re((o-r)/(t-r),0,1))*o*(3-2*o)}function Je(r,t,o){const c=o-t,u=((r-t)%c+c)%c+t;return u===t?o:u}function Xe(r,t,o){if(!r.length)return o(null,[]);let c=r.length;const u=new Array(r.length);let h=null;r.forEach((m,g)=>{t(m,(v,x)=>{v&&(h=v),u[g]=x,--c==0&&o(h,u)})})}function Ze(r){const t=[];for(const o in r)t.push(r[o]);return t}function Fe(r,...t){for(const o of t)for(const c in o)r[c]=o[c];return r}function ct(r,t){const o={};for(let c=0;c<t.length;c++){const u=t[c];u in r&&(o[u]=r[u])}return o}let At=1;function kt(){return At++}function Kt(){return function r(t){return t?(t^Math.random()*(16>>t/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,r)}()}function Et(r){return r<=1?1:Math.pow(2,Math.ceil(Math.log(r)/Math.LN2))}function Ie(r){return!!r&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(r)}function pt(r,t){r.forEach(o=>{t[o]&&(t[o]=t[o].bind(t))})}function gt(r,t){return r.indexOf(t,r.length-t.length)!==-1}function _t(r,t,o){const c={};for(const u in r)c[u]=t.call(o||this,r[u],u,r);return c}function Ue(r,t,o){const c={};for(const u in r)t.call(o||this,r[u],u,r)&&(c[u]=r[u]);return c}function ue(r){return Array.isArray(r)?r.map(ue):typeof r=="object"&&r?_t(r,ue):r}const se={};function xe(r){se[r]||(typeof console<"u"&&console.warn(r),se[r]=!0)}function Ye(r,t,o){return(o.y-r.y)*(t.x-r.x)>(t.y-r.y)*(o.x-r.x)}function ze(r){let t=0;for(let o,c,u=0,h=r.length,m=h-1;u<h;m=u++)o=r[u],c=r[m],t+=(c.x-o.x)*(o.y+c.y);return t}function st([r,t,o]){const c=ye(t+90),u=ye(o);return{x:r*Math.cos(c)*Math.sin(u),y:r*Math.sin(c)*Math.sin(u),z:r*Math.cos(u),azimuthal:t,polar:o}}function de(r,t,o){const c=Math.sqrt(r*r+t*t+o*o),u=c>0?Math.acos(o/c)*pe:0;let h=r!==0||t!==0?Math.atan2(-t,-r)*pe+90:0;return h<0&&(h+=360),[c,h,u]}function ie(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function Oe(r){const t={};if(r.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(o,c,u,h)=>{const m=u||h;return t[c]=!m||m.toLowerCase(),""}),t["max-age"]){const o=parseInt(t["max-age"],10);isNaN(o)?delete t["max-age"]:t["max-age"]=o}return t}let ut=null;function it(){return!!p.document.fullscreenElement||!!p.document.webkitFullscreenElement}function lt(r){try{const t=p[r];return t.setItem("_mapbox_test_",1),t.removeItem("_mapbox_test_"),!0}catch{return!1}}function Mt(r,t){return[r[4*t],r[4*t+1],r[4*t+2],r[4*t+3]]}function Ut(r,t,o){r[4*t+0]=o[0],r[4*t+1]=o[1],r[4*t+2]=o[2],r[4*t+3]=o[3]}function Wt(r,t){return[Math.pow(r[0],2.2)*t,Math.pow(r[1],2.2)*t,Math.pow(r[2],2.2)*t]}function Ht(r){return[Math.pow(r[0],1/2.2),Math.pow(r[1],1/2.2),Math.pow(r[2],1/2.2)]}const Dt="mapbox-tiles";let wt=500,Xt=50,$e,Pt;function qt(){try{return p.caches}catch{}}function Ot(){qt()&&!$e&&($e=p.caches.open(Dt))}function fn(r){const t=r.indexOf("?");if(t<0)return r;const o=function(u){const h=u.indexOf("?");return h>0?u.slice(h+1).split("&"):[]}(r),c=o.filter(u=>{const h=u.split("=");return h[0]==="language"||h[0]==="worldview"});return c.length?`${r.slice(0,t)}?${c.join("&")}`:r.slice(0,t)}let be=1/0;function Qe(r){be++,be>Xt&&(r.getActor().send("enforceCacheSizeLimit",wt),be=0)}const Se={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image",Model:"Model"};typeof Object.freeze=="function"&&Object.freeze(Se);class Ce extends Error{constructor(t,o,c){o===401&&Hn(c)&&(t+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(t),this.status=o,this.url=c}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const Ne=ie()?()=>self.worker&&self.worker.referrer:()=>(p.location.protocol==="blob:"?p.parent:p).location.href,et=function(r,t){if(!(/^file:/.test(o=r.url)||/^file:/.test(Ne())&&!/^\w+:/.test(o))){if(p.fetch&&p.Request&&p.AbortController&&p.Request.prototype.hasOwnProperty("signal"))return function(c,u){const h=new p.AbortController,m=new p.Request(c.url,{method:c.method||"GET",body:c.body,credentials:c.credentials,headers:c.headers,referrer:Ne(),referrerPolicy:c.referrerPolicy,signal:h.signal});let g=!1,v=!1;const x=(w=m.url).indexOf("sku=")>0&&Hn(w);var w;c.type==="json"&&m.headers.set("Accept","application/json");const E=(I,D,N)=>{if(v)return;if(I&&I.message!=="SecurityError"&&xe(I.toString()),D&&N)return C(D);const W=Date.now();p.fetch(m).then(V=>{if(V.ok){const q=x?V.clone():null;return C(V,q,W)}return u(new Ce(V.statusText,V.status,c.url))}).catch(V=>{V.name!=="AbortError"&&u(new Error(`${V.message} ${c.url}`))})},C=(I,D,N)=>{(c.type==="arrayBuffer"?I.arrayBuffer():c.type==="json"?I.json():I.text()).then(W=>{v||(D&&N&&function(V,q,Z){if(Ot(),!$e)return;const K={status:q.status,statusText:q.statusText,headers:new p.Headers};q.headers.forEach((ae,ce)=>K.headers.set(ce,ae));const X=Oe(q.headers.get("Cache-Control")||"");if(X["no-store"])return;X["max-age"]&&K.headers.set("Expires",new Date(Z+1e3*X["max-age"]).toUTCString());const J=K.headers.get("Expires");J&&(new Date(J).getTime()-Z<42e4||function(ae,ce){if(Pt===void 0)try{new Response(new ReadableStream),Pt=!0}catch{Pt=!1}Pt?ce(ae.body):ae.blob().then(ce)}(q,ae=>{const ce=new p.Response(ae,K);Ot(),$e&&$e.then(ge=>ge.put(fn(V.url),ce)).catch(ge=>xe(ge.message))}))}(m,D,N),g=!0,u(null,W,I.headers.get("Cache-Control"),I.headers.get("Expires")))}).catch(W=>{v||u(new Error(W.message))})};return x?function(I,D){if(Ot(),!$e)return D(null);const N=fn(I.url);$e.then(W=>{W.match(N).then(V=>{const q=function(Z){if(!Z)return!1;const K=new Date(Z.headers.get("Expires")||0),X=Oe(Z.headers.get("Cache-Control")||"");return K>Date.now()&&!X["no-cache"]}(V);W.delete(N),q&&W.put(N,V.clone()),D(null,V,q)}).catch(D)}).catch(D)}(m,E):E(null,null),{cancel:()=>{v=!0,g||h.abort()}}}(r,t);if(ie()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",r,t,void 0,!0)}var o;return function(c,u){const h=new p.XMLHttpRequest;h.open(c.method||"GET",c.url,!0),c.type==="arrayBuffer"&&(h.responseType="arraybuffer");for(const m in c.headers)h.setRequestHeader(m,c.headers[m]);return c.type==="json"&&(h.responseType="text",h.setRequestHeader("Accept","application/json")),h.withCredentials=c.credentials==="include",h.onerror=()=>{u(new Error(h.statusText))},h.onload=()=>{if((h.status>=200&&h.status<300||h.status===0)&&h.response!==null){let m=h.response;if(c.type==="json")try{m=JSON.parse(h.response)}catch(g){return u(g)}u(null,m,h.getResponseHeader("Cache-Control"),h.getResponseHeader("Expires"))}else u(new Ce(h.statusText,h.status,c.url))},h.send(c.body),{cancel:()=>h.abort()}}(r,t)},tt=function(r,t){return et(Fe(r,{type:"json"}),t)},vt=function(r,t){return et(Fe(r,{type:"arrayBuffer"}),t)};function ht(r){const t=p.document.createElement("a");return t.href=r,t.protocol===p.document.location.protocol&&t.host===p.document.location.host}const dt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let Vt,It;Vt=[],It=0;const Qt=function(r,t){if(S.supported&&(r.headers||(r.headers={}),r.headers.accept="image/webp,*/*"),It>=b.MAX_PARALLEL_IMAGE_REQUESTS){const h={requestParameters:r,callback:t,cancelled:!1,cancel(){this.cancelled=!0}};return Vt.push(h),h}It++;let o=!1;const c=()=>{if(!o)for(o=!0,It--;Vt.length&&It<b.MAX_PARALLEL_IMAGE_REQUESTS;){const h=Vt.shift(),{requestParameters:m,callback:g,cancelled:v}=h;v||(h.cancel=Qt(m,g).cancel)}},u=vt(r,(h,m,g,v)=>{c(),h?t(h):m&&(p.createImageBitmap?function(x,w){const E=new p.Blob([new Uint8Array(x)],{type:"image/png"});p.createImageBitmap(E).then(C=>{w(null,C)}).catch(C=>{w(new Error(`Could not load image because of ${C.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(m,(x,w)=>t(x,w,g,v)):function(x,w){const E=new p.Image,C=p.URL;E.onload=()=>{w(null,E),C.revokeObjectURL(E.src),E.onload=null,p.requestAnimationFrame(()=>{E.src=dt})},E.onerror=()=>w(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const I=new p.Blob([new Uint8Array(x)],{type:"image/png"});E.src=x.byteLength?C.createObjectURL(I):dt}(m,(x,w)=>t(x,w,g,v)))});return{cancel:()=>{u.cancel(),c()}}},mn="NO_ACCESS_TOKEN";class en{constructor(t,o,c){this._transformRequestFn=t,this._customAccessToken=o,this._silenceAuthErrors=!!c,this._createSkuToken()}_createSkuToken(){const t=function(){let o="";for(let c=0;c<10;c++)o+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",z,o].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=t.token,this._skuTokenExpiresAt=t.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(t,o){return this._transformRequestFn&&this._transformRequestFn(t,o)||{url:t}}normalizeStyleURL(t,o){if(!_n(t))return t;const c=sr(t);return c.params.push(`sdk=js-${y}`),c.path=`/styles/v1${c.path}`,this._makeAPIURL(c,this._customAccessToken||o)}normalizeGlyphsURL(t,o){if(!_n(t))return t;const c=sr(t);return c.path=`/fonts/v1${c.path}`,this._makeAPIURL(c,this._customAccessToken||o)}normalizeModelURL(t,o){if(!_n(t))return t;const c=sr(t);return c.path=`/models/v1${c.path}`,this._makeAPIURL(c,this._customAccessToken||o)}normalizeSourceURL(t,o,c,u){if(!_n(t))return t;const h=sr(t);return h.path=`/v4/${h.authority}.json`,h.params.push("secure"),c&&h.params.push(`language=${c}`),u&&h.params.push(`worldview=${u}`),this._makeAPIURL(h,this._customAccessToken||o)}normalizeSpriteURL(t,o,c,u){const h=sr(t);return _n(t)?(h.path=`/styles/v1${h.path}/sprite${o}${c}`,this._makeAPIURL(h,this._customAccessToken||u)):(h.path+=`${o}${c}`,ke(h))}normalizeTileURL(t,o,c){if(this._isSkuTokenExpired()&&this._createSkuToken(),t&&!_n(t))return t;const u=sr(t);u.path=u.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${o||c&&u.authority!=="raster"&&c===512?"@2x":""}${S.supported?".webp":"$1"}`),u.authority==="raster"?u.path=`/${b.RASTER_URL_PREFIX}${u.path}`:(u.path=u.path.replace(/^.+\/v4\//,"/"),u.path=`/${b.TILE_URL_VERSION}${u.path}`);const h=this._customAccessToken||function(m){for(const g of m){const v=g.match(/^access_token=(.*)$/);if(v)return v[1]}return null}(u.params)||b.ACCESS_TOKEN;return b.REQUIRE_ACCESS_TOKEN&&h&&this._skuToken&&u.params.push(`sku=${this._skuToken}`),this._makeAPIURL(u,h)}canonicalizeTileURL(t,o){const c=sr(t);if(!c.path.match(/^(\/v4\/|\/raster\/v1\/)/)||!c.path.match(/\.[\w]+$/))return t;let u="mapbox://";c.path.match(/^\/raster\/v1\//)?u+=`raster/${c.path.replace(`/${b.RASTER_URL_PREFIX}/`,"")}`:u+=`tiles/${c.path.replace(`/${b.TILE_URL_VERSION}/`,"")}`;let h=c.params;return o&&(h=h.filter(m=>!m.match(/^access_token=/))),h.length&&(u+=`?${h.join("&")}`),u}canonicalizeTileset(t,o){const c=!!o&&_n(o),u=[];for(const h of t.tiles||[])Hn(h)?u.push(this.canonicalizeTileURL(h,c)):u.push(h);return u}_makeAPIURL(t,o){const c="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",u=sr(b.API_URL);if(t.protocol=u.protocol,t.authority=u.authority,t.protocol==="http"){const h=t.params.indexOf("secure");h>=0&&t.params.splice(h,1)}if(u.path!=="/"&&(t.path=`${u.path}${t.path}`),!b.REQUIRE_ACCESS_TOKEN)return ke(t);if(o=o||b.ACCESS_TOKEN,!this._silenceAuthErrors){if(!o)throw new Error(`An API access token is required to use Mapbox GL. ${c}`);if(o[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${c}`)}return t.params=t.params.filter(h=>h.indexOf("access_token")===-1),t.params.push(`access_token=${o||""}`),ke(t)}}function _n(r){return r.indexOf("mapbox:")===0}function Hn(r){return b.API_URL_REGEX.test(r)}function ni(r){return b.API_CDN_URL_REGEX.test(r)}function Ei(r){return b.API_STYLE_REGEX.test(r)&&!Mi(r)}function Mi(r){return b.API_SPRITE_REGEX.test(r)}const gr=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function sr(r){const t=r.match(gr);if(!t)throw new Error("Unable to parse URL object");return{protocol:t[1],authority:t[2],path:t[3]||"/",params:t[4]?t[4].split("&"):[]}}function ke(r){const t=r.params.length?`?${r.params.join("&")}`:"";return`${r.protocol}://${r.authority}${r.path}${t}`}const xt="mapbox.eventData";function zt(r){if(!r)return null;const t=r.split(".");if(!t||t.length!==3)return null;try{return JSON.parse(decodeURIComponent(p.atob(t[1]).split("").map(o=>"%"+("00"+o.charCodeAt(0).toString(16)).slice(-2)).join("")))}catch{return null}}class Rt{constructor(t){this.type=t,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(t){const o=zt(b.ACCESS_TOKEN);let c="";return c=o&&o.u?p.btoa(encodeURIComponent(o.u).replace(/%([0-9A-F]{2})/g,(u,h)=>String.fromCharCode(+("0x"+h)))):b.ACCESS_TOKEN||"",t?`${xt}.${t}:${c}`:`${xt}:${c}`}fetchEventData(){const t=lt("localStorage"),o=this.getStorageKey(),c=this.getStorageKey("uuid");if(t)try{const u=p.localStorage.getItem(o);u&&(this.eventData=JSON.parse(u));const h=p.localStorage.getItem(c);h&&(this.anonId=h)}catch{xe("Unable to read from LocalStorage")}}saveEventData(){const t=lt("localStorage"),o=this.getStorageKey(),c=this.getStorageKey("uuid");if(t)try{p.localStorage.setItem(c,this.anonId),Object.keys(this.eventData).length>=1&&p.localStorage.setItem(o,JSON.stringify(this.eventData))}catch{xe("Unable to write to LocalStorage")}}processRequests(t){}postEvent(t,o,c,u){if(!b.EVENTS_URL)return;const h=sr(b.EVENTS_URL);h.params.push(`access_token=${u||b.ACCESS_TOKEN||""}`);const m={event:this.type,created:new Date(t).toISOString()},g=o?Fe(m,o):m,v={url:ke(h),headers:{"Content-Type":"text/plain"},body:JSON.stringify([g])};this.pendingRequest=function(x,w){return et(Fe(x,{method:"POST"}),w)}(v,x=>{this.pendingRequest=null,c(x),this.saveEventData(),this.processRequests(u)})}queueRequest(t,o){this.queue.push(t),this.processRequests(o)}}const Nt=new class extends Rt{constructor(r){super("appUserTurnstile"),this._customAccessToken=r}postTurnstileEvent(r,t){b.EVENTS_URL&&b.ACCESS_TOKEN&&Array.isArray(r)&&r.some(o=>_n(o)||Hn(o))&&this.queueRequest(Date.now(),t)}processRequests(r){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const t=zt(b.ACCESS_TOKEN),o=t?t.u:b.ACCESS_TOKEN;let c=o!==this.eventData.tokenU;Ie(this.anonId)||(this.anonId=Kt(),c=!0);const u=this.queue.shift();if(this.eventData.lastSuccess){const h=new Date(this.eventData.lastSuccess),m=new Date(u),g=(u-this.eventData.lastSuccess)/864e5;c=c||g>=1||g<-1||h.getDate()!==m.getDate()}else c=!0;c?this.postEvent(u,{sdkIdentifier:"mapbox-gl-js",sdkVersion:y,skuId:z,"enabled.telemetry":!1,userId:this.anonId},h=>{h||(this.eventData.lastSuccess=u,this.eventData.tokenU=o)},r):this.processRequests()}},jt=Nt.postTurnstileEvent.bind(Nt),yn=new class extends Rt{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(r,t,o,c){this.skuToken=t,this.errorCb=c,b.EVENTS_URL&&(o||b.ACCESS_TOKEN?this.queueRequest({id:r,timestamp:Date.now()},o):this.errorCb(new Error(mn)))}processRequests(r){if(this.pendingRequest||this.queue.length===0)return;const{id:t,timestamp:o}=this.queue.shift();t&&this.success[t]||(this.anonId||this.fetchEventData(),Ie(this.anonId)||(this.anonId=Kt()),this.postEvent(o,{sdkIdentifier:"mapbox-gl-js",sdkVersion:y,skuId:z,skuToken:this.skuToken,userId:this.anonId},c=>{c?this.errorCb(c):t&&(this.success[t]=!0)},r))}},Zn=yn.postMapLoadEvent.bind(yn),on=new class extends Rt{constructor(){super("gljs.performance")}postPerformanceEvent(r,t){b.EVENTS_URL&&(r||b.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:t},r)}processRequests(r){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:t,performanceData:o}=this.queue.shift(),c=function(u){const h=p.performance.getEntriesByType("resource"),m=p.performance.getEntriesByType("mark"),g=function(C){const I={};if(C){for(const D in C)if(D!=="other")for(const N of C[D]){const W=`${D}ResolveRangeMin`,V=`${D}ResolveRangeMax`,q=`${D}RequestCount`,Z=`${D}RequestCachedCount`;I[W]=Math.min(I[W]||1/0,N.startTime),I[V]=Math.max(I[V]||-1/0,N.responseEnd);const K=X=>{I[X]===void 0&&(I[X]=0),++I[X]};N.transferSize!==void 0&&N.transferSize===0&&K(Z),K(q)}}return I}(function(C,I){const D={};if(C)for(const N of C){const W=I(N);D[W]===void 0&&(D[W]=[]),D[W].push(N)}return D}(h,si)),v=p.devicePixelRatio,x=p.navigator.connection||p.navigator.mozConnection||p.navigator.webkitConnection,w={counters:[],metadata:[],attributes:[]},E=(C,I,D)=>{D!=null&&C.push({name:I,value:D.toString()})};for(const C in g)E(w.counters,C,g[C]);if(u.interactionRange[0]!==1/0&&u.interactionRange[1]!==-1/0&&(E(w.counters,"interactionRangeMin",u.interactionRange[0]),E(w.counters,"interactionRangeMax",u.interactionRange[1])),m)for(const C of Object.keys(lr)){const I=lr[C],D=m.find(N=>N.name===I);D&&E(w.counters,I,D.startTime)}return E(w.counters,"visibilityHidden",u.visibilityHidden),E(w.attributes,"style",function(C){if(C)for(const I of C){const D=I.name.split("?")[0];if(Ei(D)){const N=D.split("/").slice(-2);if(N.length===2)return`mapbox://styles/${N[0]}/${N[1]}`}}}(h)),E(w.attributes,"terrainEnabled",u.terrainEnabled?"true":"false"),E(w.attributes,"fogEnabled",u.fogEnabled?"true":"false"),E(w.attributes,"projection",u.projection),E(w.attributes,"zoom",u.zoom),E(w.metadata,"devicePixelRatio",v),E(w.metadata,"connectionEffectiveType",x?x.effectiveType:void 0),E(w.metadata,"navigatorUserAgent",p.navigator.userAgent),E(w.metadata,"screenWidth",p.screen.width),E(w.metadata,"screenHeight",p.screen.height),E(w.metadata,"windowWidth",p.innerWidth),E(w.metadata,"windowHeight",p.innerHeight),E(w.metadata,"mapWidth",u.width/v),E(w.metadata,"mapHeight",u.height/v),E(w.metadata,"webglRenderer",u.renderer),E(w.metadata,"webglVendor",u.vendor),E(w.metadata,"sdkVersion",y),E(w.metadata,"sdkIdentifier","mapbox-gl-js"),w}(o);for(const u of c.metadata);for(const u of c.counters);for(const u of c.attributes);this.postEvent(t,c,()=>{},r)}},pi=on.postPerformanceEvent.bind(on),_i=new class extends Rt{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(r,t,o,c){if(!b.API_URL||!b.SESSION_PATH)return;const u=sr(b.API_URL+b.SESSION_PATH);u.params.push(`sku=${t||""}`),u.params.push(`access_token=${c||b.ACCESS_TOKEN||""}`);const h={url:ke(u),headers:{"Content-Type":"text/plain"}};this.pendingRequest=function(m,g){return et(Fe(m,{method:"GET"}),g)}(h,m=>{this.pendingRequest=null,o(m),this.saveEventData(),this.processRequests(c)})}getSessionAPI(r,t,o,c){this.skuToken=t,this.errorCb=c,b.SESSION_PATH&&b.API_URL&&(o||b.ACCESS_TOKEN?this.queueRequest({id:r,timestamp:Date.now()},o):this.errorCb(new Error(mn)))}processRequests(r){if(this.pendingRequest||this.queue.length===0)return;const{id:t,timestamp:o}=this.queue.shift();t&&this.success[t]||this.getSession(o,this.skuToken,c=>{c?this.errorCb(c):t&&(this.success[t]=!0)},r)}},ui=_i.getSessionAPI.bind(_i),cr=new Set;function Ea(r,t){t?cr.add(r):cr.delete(r)}const lr={create:"create",load:"load",fullLoad:"fullLoad"},ea={mark(r){p.performance.mark(r)},measure(r,t,o){p.performance.measure(r,t,o)}};function si(r){const t=r.name.split("?")[0];return ni(t)&&t.includes("mapbox-gl.js")?"javascript":ni(t)&&t.includes("mapbox-gl.css")?"css":function(o){return b.API_FONTS_REGEX.test(o)}(t)?"fontRange":Mi(t)?"sprite":Ei(t)?"style":function(o){return b.API_TILEJSON_REGEX.test(o)}(t)?"tilejson":"other"}const Dn=p.performance;function fo(r){const t=r?r.url.toString():void 0;return Dn.getEntriesByName(t)}var Oi=kr;function kr(r){return!function(t){return typeof window>"u"||typeof document>"u"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var c,u,h=new Blob([""],{type:"text/javascript"}),m=URL.createObjectURL(h);try{u=new Worker(m),c=!0}catch{c=!1}return u&&u.terminate(),URL.revokeObjectURL(m),c}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var c=document.createElement("canvas");c.width=c.height=1;var u=c.getContext("2d");if(!u)return!1;var h=u.getImageData(0,0,1,1);return h&&h.width===c.width}()?(Yo[o=t&&t.failIfMajorPerformanceCaveat]===void 0&&(Yo[o]=function(c){var u,h=function(m){var g=document.createElement("canvas"),v=Object.create(kr.webGLContextAttributes);return v.failIfMajorPerformanceCaveat=m,g.getContext("webgl",v)||g.getContext("experimental-webgl",v)}(c);if(!h)return!1;try{u=h.createShader(h.VERTEX_SHADER)}catch{return!1}return!(!u||h.isContextLost())&&(h.shaderSource(u,"void main() {}"),h.compileShader(u),h.getShaderParameter(u,h.COMPILE_STATUS)===!0)}(o)),Yo[o]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var o}(r)}var Yo={};let Ma,ta,yr,Fa;kr.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const Pn={now:()=>yr!==void 0?yr:p.performance.now(),setNow(r){yr=r},restoreNow(){yr=void 0},frame(r){const t=p.requestAnimationFrame(r);return{cancel:()=>p.cancelAnimationFrame(t)}},getImageData(r,t=0){const{width:o,height:c}=r;Fa||(Fa=p.document.createElement("canvas"));const u=Fa.getContext("2d",{willReadFrequently:!0});if(!u)throw new Error("failed to create canvas 2d context");return(o>Fa.width||c>Fa.height)&&(Fa.width=o,Fa.height=c),u.clearRect(-t,-t,o+2*t,c+2*t),u.drawImage(r,0,0,o,c),u.getImageData(-t,-t,o+2*t,c+2*t)},resolveURL:r=>(Ma||(Ma=p.document.createElement("a")),Ma.href=r,Ma.href),get devicePixelRatio(){return p.devicePixelRatio},get prefersReducedMotion(){return!!p.matchMedia&&(ta==null&&(ta=p.matchMedia("(prefers-reduced-motion: reduce)")),ta.matches)}};function Qn(r,t,o){const c=p.document.createElement(r);return t!==void 0&&(c.className=t),o&&o.appendChild(c),c}function qr(r,t,o){const c=p.document.createElementNS("http://www.w3.org/2000/svg",r);for(const u of Object.keys(t))c.setAttributeNS(null,u,t[u]);return o&&o.appendChild(c),c}const Ta=p.document&&p.document.documentElement.style,Is=Ta&&Ta.userSelect!==void 0?"userSelect":"WebkitUserSelect";let Tu;function Vp(){Ta&&Is&&(Tu=Ta[Is],Ta[Is]="none")}function lc(){Ta&&Is&&(Ta[Is]=Tu)}function Rl(r){r.preventDefault(),r.stopPropagation(),p.removeEventListener("click",Rl,!0)}function Ll(){p.addEventListener("click",Rl,!0),p.setTimeout(()=>{p.removeEventListener("click",Rl,!0)},0)}function kl(r,t){const o=r.getBoundingClientRect();return cc(r,o,t)}function Dd(r,t){const o=r.getBoundingClientRect(),c=[];for(let u=0;u<t.length;u++)c.push(cc(r,o,t[u]));return c}function ef(r){return p.InstallTrigger!==void 0&&r.button===2&&r.ctrlKey&&p.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:r.button}function cc(r,t,o){const c=r.offsetWidth===t.width?1:r.offsetWidth/t.width;return new G((o.clientX-t.left)*c,(o.clientY-t.top)*c)}function zd(r,t,o){o[r]&&o[r].indexOf(t)!==-1||(o[r]=o[r]||[],o[r].push(t))}function Js(r,t,o){if(o&&o[r]){const c=o[r].indexOf(t);c!==-1&&o[r].splice(c,1)}}class $t{constructor(t,o={}){Fe(this,o),this.type=t}}class bn extends $t{constructor(t,o={}){super("error",Fe({error:t},o))}}class Vn{on(t,o){return this._listeners=this._listeners||{},zd(t,o,this._listeners),this}off(t,o){return Js(t,o,this._listeners),Js(t,o,this._oneTimeListeners),this}once(t,o){return o?(this._oneTimeListeners=this._oneTimeListeners||{},zd(t,o,this._oneTimeListeners),this):new Promise(c=>this.once(t,c))}fire(t,o){typeof t=="string"&&(t=new $t(t,o||{}));const c=t.type;if(this.listens(c)){t.target=this;const u=this._listeners&&this._listeners[c]?this._listeners[c].slice():[];for(const g of u)g.call(this,t);const h=this._oneTimeListeners&&this._oneTimeListeners[c]?this._oneTimeListeners[c].slice():[];for(const g of h)Js(c,g,this._oneTimeListeners),g.call(this,t);const m=this._eventedParent;m&&(Fe(t,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),m.fire(t))}else t instanceof bn&&console.error(t.error);return this}listens(t){return!!(this._listeners&&this._listeners[t]&&this._listeners[t].length>0||this._oneTimeListeners&&this._oneTimeListeners[t]&&this._oneTimeListeners[t].length>0||this._eventedParent&&this._eventedParent.listens(t))}setEventedParent(t,o){return this._eventedParent=t,this._eventedParentData=o,this}}var rt=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"fragment":{"type":"boolean"},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360},"pitch":{"type":"number","default":0},"light":{"type":"light"},"lights":{"required":false,"type":"array","value":"light-3d"},"terrain":{"type":"terrain"},"fog":{"type":"fog"},"camera":{"type":"camera"},"imports":{"type":"array","value":"import"},"schema":{"type":"schema"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string","default":"mapbox://fonts/mapbox/{fontstack}/{range}.pbf"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"},"models":{"type":"models"}},"model":{"type":"string","required":true},"import":{"id":{"type":"string","required":true},"url":{"type":"string","required":true},"config":{"type":"config"},"data":{"type":"$root"}},"config":{"*":{"type":"*"}},"schema":{"*":{"type":"option"}},"option":{"default":{"type":"*","required":true},"type":{"type":"enum","values":{"string":1,"number":1,"boolean":1,"color":1}},"array":{"type":"boolean"},"minValue":{"type":"number"},"maxValue":{"type":"number"},"stepValue":{"type":"number"},"values":{"type":"array","value":"*"},"metadata":{"type":"*"}},"models":{"*":{"type":"model"}},"light-3d":{"id":{"type":"string","required":true},"properties":{"type":"properties"},"type":{"type":"enum","values":{"ambient":{},"directional":{},"flat":{}}}},"properties":["properties_light_directional","properties_light_ambient","properties_light_flat"],"properties_light_directional":{"direction":{"type":"array","default":[210,30],"minimum":[0,0],"maximum":[360,90],"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"cast-shadows":{"type":"boolean","default":false,"expression":{},"property-type":"data-constant"},"shadow-intensity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_ambient":{"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_flat":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"property-type":"data-constant","expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image","source_model"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":1,"mapbox":1},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":1}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":1}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":1}},"url":{"required":false,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_model":{"type":{"required":true,"type":"enum","values":{"model":1,"batched-model":1}},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"tiles":{"type":"array","value":"string"}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"hillshade":{},"model":{},"background":{},"sky":{},"slot":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"slot":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky","layout_model"],"layout_background":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_model":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"model-id":{"type":"string","default":"","property-type":"data-driven","expression":{"parameters":["zoom","feature"]}}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":1,"round":1,"square":1},"default":"butt","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":1,"round":1,"miter":1},"default":"miter","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":1,"line":1,"line-center":1},"default":"point","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":1,"viewport-y":1,"source":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-z-elevate":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":1,"width":1,"height":1,"both":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":1,"left":1,"center":1,"right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","default":0,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":1,"vertical":1},"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":1,"uppercase":1,"lowercase":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":1,"!=":1,">":1,">=":1,"<":1,"<=":1,"in":1,"!in":1,"all":1,"any":1,"none":1,"has":1,"!has":1}},"geometry_type":{"type":"enum","values":{"Point":1,"LineString":1,"Polygon":1}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":1,"exponential":1,"interval":1,"categorical":1},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":1,"lab":1,"hcl":1},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vertical-range":{"type":"array","default":[0,0],"minimum":0,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}}},"camera":{"camera-projection":{"type":"enum","values":{"perspective":1,"orthographic":1},"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"default":"perspective","property-type":"data-constant"}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"property-type":"data-constant","expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":1,"equalEarth":1,"equirectangular":1,"lambertConformalConic":1,"mercator":1,"naturalEarth":1,"winkelTripel":1,"globe":1},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky","paint_model"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","private":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-wall-radius":{"property-type":"data-constant","type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-radius":{"property-type":"data-constant","type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-attenuation":{"property-type":"data-constant","type":"number","default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-flood-light-color":{"property-type":"data-constant","type":"color","default":"#ffffff","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-intensity":{"property-type":"data-constant","type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-wall-radius":{"property-type":"data-driven","type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-radius":{"property-type":"data-driven","type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-attenuation":{"property-type":"data-constant","type":"number","default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-vertical-scale":{"property-type":"data-constant","type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-rounded-roof":{"property-type":"data-constant","type":"boolean","default":true,"expression":{"parameters":["zoom"]}},"fill-extrusion-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"property-type":"constant"},"line-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-border-width":{"type":"number","private":true,"default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-border-color":{"type":"color","private":true,"default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-driven"},"text-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-image-cross-fade":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"transition":true},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-color":{"type":"color","expression":{"interpolated":true,"parameters":["raster-value"]},"property-type":"color-ramp"},"raster-color-mix":{"type":"array","default":[0.2126,0.7152,0.0722,0],"length":4,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-color-range":{"type":"array","default":[0,1],"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":1,"nearest":1},"default":"linear","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":1,"atmosphere":1},"default":"atmosphere","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","default":10,"minimum":0,"maximum":100,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","value":"number","default":[0,0],"length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","default":90,"minimum":0,"maximum":180,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_model":{"model-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"model-rotation":{"type":"array","value":"number","length":3,"default":[0,0,0],"period":360,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-scale":{"type":"array","value":"number","length":3,"default":[1,1,1],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-translation":{"type":"array","value":"number","length":3,"default":[0,0,0],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-color":{"type":"color","default":"#ffffff","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light","zoom"]},"transition":true},"model-color-mix-intensity":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-type":{"type":"enum","values":{"common-3d":1,"location-indicator":1},"default":"common-3d","property-type":"data-constant"},"model-cast-shadows":{"type":"boolean","default":true,"expression":{},"property-type":"data-constant"},"model-receive-shadows":{"type":"boolean","default":true,"expression":{},"property-type":"data-constant"},"model-ambient-occlusion-intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant","transition":true},"model-emissive-strength":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":5,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-roughness":{"type":"number","default":1,"minimum":0,"maximum":1,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state"]},"transition":true},"model-height-based-emissive-strength-multiplier":{"type":"array","default":[1,1,1,1,0],"length":5,"value":"number","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"}},"transition":{"duration":{"type":"number","default":300,"minimum":0},"delay":{"type":"number","default":0,"minimum":0}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');class cn{constructor(t,o,c,u){this.message=(t?`${t}: `:"")+c,u&&(this.identifier=u),o!=null&&o.__line__&&(this.line=o.__line__)}}class Qs extends cn{}function Rs(r,...t){for(const o of t)for(const c in o)r[c]=o[c];return r}function $r(r){return r instanceof Number||r instanceof String||r instanceof Boolean?r.valueOf():r}function ur(r){if(Array.isArray(r))return r.map(ur);if(r instanceof Object&&!(r instanceof Number||r instanceof String||r instanceof Boolean)){const t={};for(const o in r)t[o]=ur(r[o]);return t}return $r(r)}class Od extends Error{constructor(t,o){super(o),this.message=o,this.key=t}}var Ls=Od;class To{constructor(t,o=[]){this.parent=t,this.bindings={};for(const[c,u]of o)this.bindings[c]=u}concat(t){return new To(this,t)}get(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(`${t} not found in scope.`)}has(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)}}var Gp=To;const el={kind:"null"},an={kind:"number"},xi={kind:"string"},Ci={kind:"boolean"},na={kind:"color"},Ba={kind:"object"},li={kind:"value"},qo={kind:"collator"},Bc={kind:"formatted"},Uc={kind:"resolvedImage"};function Fr(r,t){return{kind:"array",itemType:r,N:t}}function vr(r){if(r.kind==="array"){const t=vr(r.itemType);return typeof r.N=="number"?`array<${t}, ${r.N}>`:r.itemType.kind==="value"?"array":`array<${t}>`}return r.kind}const Nd=[el,an,xi,Ci,na,Bc,Ba,Fr(li),Uc];function Dl(r,t){if(t.kind==="error")return null;if(r.kind==="array"){if(t.kind==="array"&&(t.N===0&&t.itemType.kind==="value"||!Dl(r.itemType,t.itemType))&&(typeof r.N!="number"||r.N===t.N))return null}else{if(r.kind===t.kind)return null;if(r.kind==="value"){for(const o of Nd)if(!Dl(o,t))return null}}return`Expected ${vr(r)} but found ${vr(t)} instead.`}function Ao(r,t){return t.some(o=>o.kind===r.kind)}function ga(r,t){return t.some(o=>o==="null"?r===null:o==="array"?Array.isArray(r):o==="object"?r&&!Array.isArray(r)&&typeof r=="object":o===typeof r)}var Au,tl={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function zl(r){return(r=Math.round(r))<0?0:r>255?255:r}function Cu(r){return zl(r[r.length-1]==="%"?parseFloat(r)/100*255:parseInt(r))}function Fd(r){return(t=r[r.length-1]==="%"?parseFloat(r)/100:parseFloat(r))<0?0:t>1?1:t;var t}function Ua(r,t,o){return o<0?o+=1:o>1&&(o-=1),6*o<1?r+(t-r)*o*6:2*o<1?t:3*o<2?r+(t-r)*(2/3-o)*6:r}try{Au={}.parseCSSColor=function(r){var t,o=r.replace(/ /g,"").toLowerCase();if(o in tl)return tl[o].slice();if(o[0]==="#")return o.length===4?(t=parseInt(o.substr(1),16))>=0&&t<=4095?[(3840&t)>>4|(3840&t)>>8,240&t|(240&t)>>4,15&t|(15&t)<<4,1]:null:o.length===7&&(t=parseInt(o.substr(1),16))>=0&&t<=16777215?[(16711680&t)>>16,(65280&t)>>8,255&t,1]:null;var c=o.indexOf("("),u=o.indexOf(")");if(c!==-1&&u+1===o.length){var h=o.substr(0,c),m=o.substr(c+1,u-(c+1)).split(","),g=1;switch(h){case"rgba":if(m.length!==4)return null;g=Fd(m.pop());case"rgb":return m.length!==3?null:[Cu(m[0]),Cu(m[1]),Cu(m[2]),g];case"hsla":if(m.length!==4)return null;g=Fd(m.pop());case"hsl":if(m.length!==3)return null;var v=(parseFloat(m[0])%360+360)%360/360,x=Fd(m[1]),w=Fd(m[2]),E=w<=.5?w*(x+1):w+x-w*x,C=2*w-E;return[zl(255*Ua(C,E,v+1/3)),zl(255*Ua(C,E,v)),zl(255*Ua(C,E,v-1/3)),g];default:return null}}return null}}catch{}class Dr{constructor(t,o,c,u=1){this.r=t,this.g=o,this.b=c,this.a=u}static parse(t){if(!t)return;if(t instanceof Dr)return t;if(typeof t!="string")return;const o=Au(t);return o?new Dr(o[0]/255*o[3],o[1]/255*o[3],o[2]/255*o[3],o[3]):void 0}toString(){const[t,o,c,u]=this.toArray();return`rgba(${Math.round(t)},${Math.round(o)},${Math.round(c)},${u})`}toArray(){const{r:t,g:o,b:c,a:u}=this;return u===0?[0,0,0,0]:[255*t/u,255*o/u,255*c/u,u]}toArray01(){const{r:t,g:o,b:c,a:u}=this;return u===0?[0,0,0,0]:[t/u,o/u,c/u,u]}toArray01Scaled(t){const{r:o,g:c,b:u,a:h}=this;return h===0?[0,0,0]:[o/h*t,c/h*t,u/h*t]}toArray01PremultipliedAlpha(){const{r:t,g:o,b:c,a:u}=this;return[t,o,c,u]}toArray01Linear(){const{r:t,g:o,b:c,a:u}=this;return u===0?[0,0,0,0]:[Math.pow(t/u,2.2),Math.pow(o/u,2.2),Math.pow(c/u,2.2),u]}}Dr.black=new Dr(0,0,0,1),Dr.white=new Dr(1,1,1,1),Dr.transparent=new Dr(0,0,0,0),Dr.red=new Dr(1,0,0,1),Dr.blue=new Dr(0,0,1,1);var En=Dr;class sa{constructor(t,o,c){this.sensitivity=t?o?"variant":"case":o?"accent":"base",this.locale=c,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(t,o){return this.collator.compare(t,o)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Xo{constructor(t,o,c,u,h){this.text=t.normalize?t.normalize():t,this.image=o,this.scale=c,this.fontStack=u,this.textColor=h}}class Aa{constructor(t){this.sections=t}static fromString(t){return new Aa([new Xo(t,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(t=>t.text.length!==0||t.image&&t.image.namePrimary.length!==0)}static factory(t){return t instanceof Aa?t:Aa.fromString(t)}toString(){return this.sections.length===0?"":this.sections.map(t=>t.text).join("")}serialize(){const t=["format"];for(const o of this.sections){if(o.image){t.push(["image",o.image.namePrimary]);continue}t.push(o.text);const c={};o.fontStack&&(c["text-font"]=["literal",o.fontStack.split(",")]),o.scale&&(c["font-scale"]=o.scale),o.textColor&&(c["text-color"]=["rgba"].concat(o.textColor.toArray())),t.push(c)}return t}}class as{constructor(t){this.namePrimary=t.namePrimary,t.nameSecondary&&(this.nameSecondary=t.nameSecondary),this.available=t.available}toString(){return this.nameSecondary?`[${this.namePrimary},${this.nameSecondary}]`:this.namePrimary}static fromString(t,o){return t?new as({namePrimary:t,nameSecondary:o,available:!1}):null}serialize(){return this.nameSecondary?["image",this.namePrimary,this.nameSecondary]:["image",this.namePrimary]}}function z_(r,t,o,c){return typeof r=="number"&&r>=0&&r<=255&&typeof t=="number"&&t>=0&&t<=255&&typeof o=="number"&&o>=0&&o<=255?c===void 0||typeof c=="number"&&c>=0&&c<=1?null:`Invalid rgba value [${[r,t,o,c].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof c=="number"?[r,t,o,c]:[r,t,o]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function os(r){if(r===null||typeof r=="string"||typeof r=="boolean"||typeof r=="number"||r instanceof En||r instanceof sa||r instanceof Aa||r instanceof as)return!0;if(Array.isArray(r)){for(const t of r)if(!os(t))return!1;return!0}if(typeof r=="object"){for(const t in r)if(!os(r[t]))return!1;return!0}return!1}function zr(r){if(r===null)return el;if(typeof r=="string")return xi;if(typeof r=="boolean")return Ci;if(typeof r=="number")return an;if(r instanceof En)return na;if(r instanceof sa)return qo;if(r instanceof Aa)return Bc;if(r instanceof as)return Uc;if(Array.isArray(r)){const t=r.length;let o;for(const c of r){const u=zr(c);if(o){if(o===u)continue;o=li;break}o=u}return Fr(o||li,t)}return Ba}function Pu(r){const t=typeof r;return r===null?"":t==="string"||t==="number"||t==="boolean"?String(r):r instanceof En||r instanceof Aa||r instanceof as?r.toString():JSON.stringify(r)}class cy{constructor(t,o){this.type=t,this.value=o}static parse(t,o){if(t.length!==2)return o.error(`'literal' expression requires exactly one argument, but found ${t.length-1} instead.`);if(!os(t[1]))return o.error("invalid value");const c=t[1];let u=zr(c);const h=o.expectedType;return u.kind!=="array"||u.N!==0||!h||h.kind!=="array"||typeof h.N=="number"&&h.N!==0||(u=h),new cy(u,c)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof En?["rgba"].concat(this.value.toArray()):this.value instanceof Aa?this.value.serialize():this.value}}var Iu=cy,Ca=class{constructor(r){this.name="ExpressionEvaluationError",this.message=r}toJSON(){return this.message}};const uy={string:xi,number:an,boolean:Ci,object:Ba};class Hp{constructor(t,o){this.type=t,this.args=o}static parse(t,o){if(t.length<2)return o.error("Expected at least one argument.");let c,u=1;const h=t[0];if(h==="array"){let g,v;if(t.length>2){const x=t[1];if(typeof x!="string"||!(x in uy)||x==="object")return o.error('The item type argument of "array" must be one of string, number, boolean',1);g=uy[x],u++}else g=li;if(t.length>3){if(t[2]!==null&&(typeof t[2]!="number"||t[2]<0||t[2]!==Math.floor(t[2])))return o.error('The length argument to "array" must be a positive integer literal',2);v=t[2],u++}c=Fr(g,v)}else c=uy[h];const m=[];for(;u<t.length;u++){const g=o.parse(t[u],u,li);if(!g)return null;m.push(g)}return new Hp(c,m)}evaluate(t){for(let o=0;o<this.args.length;o++){const c=this.args[o].evaluate(t);if(!Dl(this.type,zr(c)))return c;if(o===this.args.length-1)throw new Ca(`Expected value to be of type ${vr(this.type)}, but found ${vr(zr(c))} instead.`)}return null}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}serialize(){const t=this.type,o=[t.kind];if(t.kind==="array"){const c=t.itemType;if(c.kind==="string"||c.kind==="number"||c.kind==="boolean"){o.push(c.kind);const u=t.N;(typeof u=="number"||this.args.length>1)&&o.push(u)}}return o.concat(this.args.map(c=>c.serialize()))}}var nl=Hp;class tf{constructor(t){this.type=Bc,this.sections=t}static parse(t,o){if(t.length<2)return o.error("Expected at least one argument.");const c=t[1];if(!Array.isArray(c)&&typeof c=="object")return o.error("First argument must be an image or text section.");const u=[];let h=!1;for(let m=1;m<=t.length-1;++m){const g=t[m];if(h&&typeof g=="object"&&!Array.isArray(g)){h=!1;let v=null;if(g["font-scale"]&&(v=o.parse(g["font-scale"],1,an),!v))return null;let x=null;if(g["text-font"]&&(x=o.parse(g["text-font"],1,Fr(xi)),!x))return null;let w=null;if(g["text-color"]&&(w=o.parse(g["text-color"],1,na),!w))return null;const E=u[u.length-1];E.scale=v,E.font=x,E.textColor=w}else{const v=o.parse(t[m],1,li);if(!v)return null;const x=v.type.kind;if(x!=="string"&&x!=="value"&&x!=="null"&&x!=="resolvedImage")return o.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");h=!0,u.push({content:v,scale:null,font:null,textColor:null})}}return new tf(u)}evaluate(t){return new Aa(this.sections.map(o=>{const c=o.content.evaluate(t);return zr(c)===Uc?new Xo("",c,null,null,null):new Xo(Pu(c),null,o.scale?o.scale.evaluate(t):null,o.font?o.font.evaluate(t).join(","):null,o.textColor?o.textColor.evaluate(t):null)}))}eachChild(t){for(const o of this.sections)t(o.content),o.scale&&t(o.scale),o.font&&t(o.font),o.textColor&&t(o.textColor)}outputDefined(){return!1}serialize(){const t=["format"];for(const o of this.sections){t.push(o.content.serialize());const c={};o.scale&&(c["font-scale"]=o.scale.serialize()),o.font&&(c["text-font"]=o.font.serialize()),o.textColor&&(c["text-color"]=o.textColor.serialize()),t.push(c)}return t}}class nf{constructor(t,o){this.type=Uc,this.inputPrimary=t,this.inputSecondary=o}static parse(t,o){if(t.length<2)return o.error("Expected two or more arguments.");const c=o.parse(t[1],1,xi);if(!c)return o.error("No image name provided.");if(t.length===2)return new nf(c);const u=o.parse(t[2],1,xi);return u?new nf(c,u):o.error("Secondary image variant is not a string.")}evaluate(t){const o=as.fromString(this.inputPrimary.evaluate(t),this.inputSecondary?this.inputSecondary.evaluate(t):void 0);return o&&t.availableImages&&(o.available=t.availableImages.indexOf(o.namePrimary)>-1,o.nameSecondary&&o.available&&t.availableImages&&(o.available=t.availableImages.indexOf(o.nameSecondary)>-1)),o}eachChild(t){t(this.inputPrimary),this.inputSecondary&&t(this.inputSecondary)}outputDefined(){return!1}serialize(){return this.inputSecondary?["image",this.inputPrimary.serialize(),this.inputSecondary.serialize()]:["image",this.inputPrimary.serialize()]}}function Ni(r){return r instanceof Number?"number":r instanceof String?"string":r instanceof Boolean?"boolean":Array.isArray(r)?"array":r===null?"null":typeof r}const O_={"to-boolean":Ci,"to-color":na,"to-number":an,"to-string":xi};class Ru{constructor(t,o){this.type=t,this.args=o}static parse(t,o){if(t.length<2)return o.error("Expected at least one argument.");const c=t[0],u=[];let h=el;if(c==="to-array"){if(!Array.isArray(t[1]))return null;const m=t[1].length;if(o.expectedType){if(o.expectedType.kind!=="array")return o.error(`Expected ${o.expectedType.kind} but found array.`);h=Fr(o.expectedType.itemType,m)}else{if(!(m>0&&os(t[1][0])))return null;h=Fr(zr(t[1][0]),m)}for(let g=0;g<m;g++){const v=t[1][g];let x;if(Ni(v)==="array")x=o.parse(v,void 0,h.itemType);else{const w=Ni(v);if(w!==h.itemType.kind)return o.error(`Expected ${h.itemType.kind} but found ${w}.`);x=o.registry.literal.parse(["literal",v===void 0?null:v],o)}if(!x)return null;u.push(x)}}else{if((c==="to-boolean"||c==="to-string")&&t.length!==2)return o.error("Expected one argument.");h=O_[c];for(let m=1;m<t.length;m++){const g=o.parse(t[m],m,li);if(!g)return null;u.push(g)}}return new Ru(h,u)}evaluate(t){if(this.type.kind==="boolean")return!!this.args[0].evaluate(t);if(this.type.kind==="color"){let o,c;for(const u of this.args){if(o=u.evaluate(t),c=null,o instanceof En)return o;if(typeof o=="string"){const h=t.parseColor(o);if(h)return h}else if(Array.isArray(o)&&(c=o.length<3||o.length>4?`Invalid rbga value ${JSON.stringify(o)}: expected an array containing either three or four numeric values.`:z_(o[0],o[1],o[2],o[3]),!c))return new En(o[0]/255,o[1]/255,o[2]/255,o[3])}throw new Ca(c||`Could not parse color from value '${typeof o=="string"?o:String(JSON.stringify(o))}'`)}if(this.type.kind==="number"){let o=null;for(const c of this.args){if(o=c.evaluate(t),o===null)return 0;const u=Number(o);if(!isNaN(u))return u}throw new Ca(`Could not convert ${JSON.stringify(o)} to number.`)}return this.type.kind==="formatted"?Aa.fromString(Pu(this.args[0].evaluate(t))):this.type.kind==="resolvedImage"?as.fromString(Pu(this.args[0].evaluate(t))):this.type.kind==="array"?this.args.map(o=>o.evaluate(t)):Pu(this.args[0].evaluate(t))}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}serialize(){if(this.type.kind==="formatted")return new tf([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new nf(this.args[0]).serialize();const t=this.type.kind==="array"?[]:[`to-${this.type.kind}`];return this.eachChild(o=>{t.push(o.serialize())}),t}}var il=Ru;const dy=["Unknown","Point","LineString","Polygon"];var jp=class{constructor(r){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null,this.options=r}id(){return this.feature&&this.feature.id!==void 0?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?dy[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}measureLight(r){return this.globals.brightness||0}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const r=this.featureDistanceData.center,t=this.featureDistanceData.scale,{x:o,y:c}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(o*t-r[0])+this.featureDistanceData.bearing[1]*(c*t-r[1])}return 0}parseColor(r){let t=this._parseColorCache[r];return t||(t=this._parseColorCache[r]=En.parse(r)),t}getConfig(r){return this.options?this.options.get(r):null}};class Co{constructor(t,o,c,u){this.name=t,this.type=o,this._evaluate=c,this.args=u}evaluate(t){return this._evaluate(t,this.args)}eachChild(t){this.args.forEach(t)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(t=>t.serialize()))}static parse(t,o){const c=t[0],u=Co.definitions[c];if(!u)return o.error(`Unknown expression "${c}". If you wanted a literal array, use ["literal", [...]].`,0);const h=Array.isArray(u)?u[0]:u.type,m=Array.isArray(u)?[[u[1],u[2]]]:u.overloads,g=m.filter(([x])=>!Array.isArray(x)||x.length===t.length-1);let v=null;for(const[x,w]of g){v=new Sy(o.registry,o.path,null,o.scope,void 0,o.options);const E=[];let C=!1;for(let I=1;I<t.length;I++){const D=t[I],N=Array.isArray(x)?x[I-1]:x.type,W=v.parse(D,1+E.length,N);if(!W){C=!0;break}E.push(W)}if(!C)if(Array.isArray(x)&&x.length!==E.length)v.error(`Expected ${x.length} arguments, but found ${E.length} instead.`);else{for(let I=0;I<E.length;I++){const D=Array.isArray(x)?x[I]:x.type,N=E[I];v.concat(I+1).checkSubtype(D,N.type)}if(v.errors.length===0)return new Co(c,h,w,E)}}if(g.length===1)o.errors.push(...v.errors);else{const x=(g.length?g:m).map(([E])=>{return C=E,Array.isArray(C)?`(${C.map(vr).join(", ")})`:`(${vr(C.type)}...)`;var C}).join(" | "),w=[];for(let E=1;E<t.length;E++){const C=o.parse(t[E],1+w.length);if(!C)return null;w.push(vr(C.type))}o.error(`Expected arguments of type ${x}, but found (${w.join(", ")}) instead.`)}return null}static register(t,o){Co.definitions=o;for(const c in o)t[c]=Co}}var Pa=Co;class uc{constructor(t,o,c){this.type=qo,this.locale=c,this.caseSensitive=t,this.diacriticSensitive=o}static parse(t,o){if(t.length!==2)return o.error("Expected one argument.");const c=t[1];if(typeof c!="object"||Array.isArray(c))return o.error("Collator options argument must be an object.");const u=o.parse(c["case-sensitive"]!==void 0&&c["case-sensitive"],1,Ci);if(!u)return null;const h=o.parse(c["diacritic-sensitive"]!==void 0&&c["diacritic-sensitive"],1,Ci);if(!h)return null;let m=null;return c.locale&&(m=o.parse(c.locale,1,xi),!m)?null:new uc(u,h,m)}evaluate(t){return new sa(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)}eachChild(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)}outputDefined(){return!1}serialize(){const t={};return t["case-sensitive"]=this.caseSensitive.serialize(),t["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(t.locale=this.locale.serialize()),["collator",t]}}var dc={exports:{}};dc.exports=function(){function r(c,u,h,m,g){for(;m>h;){if(m-h>600){var v=m-h+1,x=u-h+1,w=Math.log(v),E=.5*Math.exp(2*w/3),C=.5*Math.sqrt(w*E*(v-E)/v)*(x-v/2<0?-1:1);r(c,u,Math.max(h,Math.floor(u-x*E/v+C)),Math.min(m,Math.floor(u+(v-x)*E/v+C)),g)}var I=c[u],D=h,N=m;for(t(c,h,u),g(c[m],I)>0&&t(c,h,m);D<N;){for(t(c,D,N),D++,N--;g(c[D],I)<0;)D++;for(;g(c[N],I)>0;)N--}g(c[h],I)===0?t(c,h,N):t(c,++N,m),N<=u&&(h=N+1),u<=N&&(m=N-1)}}function t(c,u,h){var m=c[u];c[u]=c[h],c[h]=m}function o(c,u){return c<u?-1:c>u?1:0}return function(c,u,h,m,g){r(c,u,h||0,m||c.length-1,g||o)}}();var Wc=O(dc.exports);function Bd(r){let t=0;for(let o,c,u=0,h=r.length,m=h-1;u<h;m=u++)o=r[u],c=r[m],t+=(c.x-o.x)*(o.y+c.y);return t}function rf(r,t){r[0]=Math.min(r[0],t[0]),r[1]=Math.min(r[1],t[1]),r[2]=Math.max(r[2],t[0]),r[3]=Math.max(r[3],t[1])}function Ud(r,t){return!(r[0]<=t[0]||r[2]>=t[2]||r[1]<=t[1]||r[3]>=t[3])}function N_(r,t,o){const c=r[0]-t[0],u=r[1]-t[1],h=r[0]-o[0],m=r[1]-o[1];return c*m-h*u==0&&c*h<=0&&u*m<=0}function po(r,t,o=!1){let c=!1;for(let g=0,v=t.length;g<v;g++){const x=t[g];for(let w=0,E=x.length,C=E-1;w<E;C=w++){const I=x[C],D=x[w];if(N_(r,I,D))return o;(h=I)[1]>(u=r)[1]!=(m=D)[1]>u[1]&&u[0]<(m[0]-h[0])*(u[1]-h[1])/(m[1]-h[1])+h[0]&&(c=!c)}}var u,h,m;return c}function ss(r,t,o,c){const u=c[0]-o[0],h=c[1]-o[1],m=(r[0]-o[0])*h-u*(r[1]-o[1]),g=(t[0]-o[0])*h-u*(t[1]-o[1]);return m>0&&g<0||m<0&&g>0}function Br(r,t,o,c){return(u=[c[0]-o[0],c[1]-o[1]])[0]*(h=[t[0]-r[0],t[1]-r[1]])[1]-u[1]*h[0]!=0&&!(!ss(r,t,o,c)||!ss(o,c,r,t));var u,h}const rl=8192;function Ol(r,t){const o=(180+r[0])/360,c=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+r[1]*Math.PI/360)))/360,u=Math.pow(2,t.z);return[Math.round(o*u*rl),Math.round(c*u*rl)]}function pS(r,t){for(let o=0;o<t.length;o++)if(po(r,t[o]))return!0;return!1}function mS(r,t,o){for(const c of o)for(let u=0,h=c.length,m=h-1;u<h;m=u++)if(Br(r,t,c[m],c[u]))return!0;return!1}function hy(r,t){for(let o=0;o<r.length;++o)if(!po(r[o],t))return!1;for(let o=0;o<r.length-1;++o)if(mS(r[o],r[o+1],t))return!1;return!0}function F_(r,t){for(let o=0;o<t.length;o++)if(hy(r,t[o]))return!0;return!1}function fy(r,t,o){const c=[];for(let u=0;u<r.length;u++){const h=[];for(let m=0;m<r[u].length;m++){const g=Ol(r[u][m],o);rf(t,g),h.push(g)}c.push(h)}return c}function af(r,t,o){const c=[];for(let u=0;u<r.length;u++){const h=fy(r[u],t,o);c.push(h)}return c}function Wd(r,t,o,c){if(r[0]<o[0]||r[0]>o[2]){const u=.5*c;let h=r[0]-o[0]>u?-c:o[0]-r[0]>u?c:0;h===0&&(h=r[0]-o[2]>u?-c:o[2]-r[0]>u?c:0),r[0]+=h}rf(t,r)}function py(r,t,o,c){const u=Math.pow(2,c.z)*rl,h=[c.x*rl,c.y*rl],m=[];if(!r)return m;for(const g of r)for(const v of g){const x=[v.x+h[0],v.y+h[1]];Wd(x,t,o,u),m.push(x)}return m}function of(r,t,o,c){const u=Math.pow(2,c.z)*rl,h=[c.x*rl,c.y*rl],m=[];if(!r)return m;for(const v of r){const x=[];for(const w of v){const E=[w.x+h[0],w.y+h[1]];rf(t,E),x.push(E)}m.push(x)}if(t[2]-t[0]<=u/2){(g=t)[0]=g[1]=1/0,g[2]=g[3]=-1/0;for(const v of m)for(const x of v)Wd(x,t,o,u)}var g;return m}class Lu{constructor(t,o){this.type=Ci,this.geojson=t,this.geometries=o}static parse(t,o){if(t.length!==2)return o.error(`'within' expression requires exactly one argument, but found ${t.length-1} instead.`);if(os(t[1])){const c=t[1];if(c.type==="FeatureCollection")for(let u=0;u<c.features.length;++u){const h=c.features[u].geometry.type;if(h==="Polygon"||h==="MultiPolygon")return new Lu(c,c.features[u].geometry)}else if(c.type==="Feature"){const u=c.geometry.type;if(u==="Polygon"||u==="MultiPolygon")return new Lu(c,c.geometry)}else if(c.type==="Polygon"||c.type==="MultiPolygon")return new Lu(c,c)}return o.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return function(o,c){const u=[1/0,1/0,-1/0,-1/0],h=[1/0,1/0,-1/0,-1/0],m=o.canonicalID();if(!m)return!1;if(c.type==="Polygon"){const g=fy(c.coordinates,h,m),v=py(o.geometry(),u,h,m);if(!Ud(u,h))return!1;for(const x of v)if(!po(x,g))return!1}if(c.type==="MultiPolygon"){const g=af(c.coordinates,h,m),v=py(o.geometry(),u,h,m);if(!Ud(u,h))return!1;for(const x of v)if(!pS(x,g))return!1}return!0}(t,this.geometries);if(t.geometryType()==="LineString")return function(o,c){const u=[1/0,1/0,-1/0,-1/0],h=[1/0,1/0,-1/0,-1/0],m=o.canonicalID();if(!m)return!1;if(c.type==="Polygon"){const g=fy(c.coordinates,h,m),v=of(o.geometry(),u,h,m);if(!Ud(u,h))return!1;for(const x of v)if(!hy(x,g))return!1}if(c.type==="MultiPolygon"){const g=af(c.coordinates,h,m),v=of(o.geometry(),u,h,m);if(!Ud(u,h))return!1;for(const x of v)if(!F_(x,g))return!1}return!0}(t,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}var my=Lu,B_={exports:{}};B_.exports=function(){var r={kilometers:1,miles:.621371192237334,nauticalmiles:.5399568034557235,meters:1e3,metres:1e3,yards:1093.6132983377079,feet:3280.839895013123,inches:39370.078740157485},t=1/298.257223563,o=t*(2-t),c=Math.PI/180,u=function(x,w){if(x===void 0)throw new Error("No latitude given.");if(w&&!r[w])throw new Error("Unknown unit "+w+". Use one of: "+Object.keys(r).join(", "));var E=6378.137*c*(w?r[w]:1),C=Math.cos(x*c),I=1/(1-o*(1-C*C)),D=Math.sqrt(I);this.kx=E*D*C,this.ky=E*D*I*(1-o)},h={units:{configurable:!0}};function m(x,w){return x[0]===w[0]&&x[1]===w[1]}function g(x,w,E){var C=v(w[0]-x[0]);return[x[0]+C*E,x[1]+(w[1]-x[1])*E]}function v(x){for(;x<-180;)x+=360;for(;x>180;)x-=360;return x}return u.fromTile=function(x,w,E){var C=Math.PI*(1-2*(x+.5)/Math.pow(2,w)),I=Math.atan(.5*(Math.exp(C)-Math.exp(-C)))/c;return new u(I,E)},h.units.get=function(){return r},u.prototype.distance=function(x,w){var E=v(x[0]-w[0])*this.kx,C=(x[1]-w[1])*this.ky;return Math.sqrt(E*E+C*C)},u.prototype.bearing=function(x,w){var E=v(w[0]-x[0])*this.kx;return Math.atan2(E,(w[1]-x[1])*this.ky)/c},u.prototype.destination=function(x,w,E){var C=E*c;return this.offset(x,Math.sin(C)*w,Math.cos(C)*w)},u.prototype.offset=function(x,w,E){return[x[0]+w/this.kx,x[1]+E/this.ky]},u.prototype.lineDistance=function(x){for(var w=0,E=0;E<x.length-1;E++)w+=this.distance(x[E],x[E+1]);return w},u.prototype.area=function(x){for(var w=0,E=0;E<x.length;E++)for(var C=x[E],I=0,D=C.length,N=D-1;I<D;N=I++)w+=v(C[I][0]-C[N][0])*(C[I][1]+C[N][1])*(E?-1:1);return Math.abs(w)/2*this.kx*this.ky},u.prototype.along=function(x,w){var E=0;if(w<=0)return x[0];for(var C=0;C<x.length-1;C++){var I=x[C],D=x[C+1],N=this.distance(I,D);if((E+=N)>w)return g(I,D,(w-(E-N))/N)}return x[x.length-1]},u.prototype.pointToSegmentDistance=function(x,w,E){var C=w[0],I=w[1],D=v(E[0]-C)*this.kx,N=(E[1]-I)*this.ky,W=0;return D===0&&N===0||((W=(v(x[0]-C)*this.kx*D+(x[1]-I)*this.ky*N)/(D*D+N*N))>1?(C=E[0],I=E[1]):W>0&&(C+=D/this.kx*W,I+=N/this.ky*W)),D=v(x[0]-C)*this.kx,N=(x[1]-I)*this.ky,Math.sqrt(D*D+N*N)},u.prototype.pointOnLine=function(x,w){for(var E,C,I,D,N=1/0,W=0;W<x.length-1;W++){var V=x[W][0],q=x[W][1],Z=v(x[W+1][0]-V)*this.kx,K=(x[W+1][1]-q)*this.ky,X=0;Z===0&&K===0||((X=(v(w[0]-V)*this.kx*Z+(w[1]-q)*this.ky*K)/(Z*Z+K*K))>1?(V=x[W+1][0],q=x[W+1][1]):X>0&&(V+=Z/this.kx*X,q+=K/this.ky*X));var J=(Z=v(w[0]-V)*this.kx)*Z+(K=(w[1]-q)*this.ky)*K;J<N&&(N=J,E=V,C=q,I=W,D=X)}return{point:[E,C],index:I,t:Math.max(0,Math.min(1,D))}},u.prototype.lineSlice=function(x,w,E){var C=this.pointOnLine(E,x),I=this.pointOnLine(E,w);if(C.index>I.index||C.index===I.index&&C.t>I.t){var D=C;C=I,I=D}var N=[C.point],W=C.index+1,V=I.index;!m(E[W],N[0])&&W<=V&&N.push(E[W]);for(var q=W+1;q<=V;q++)N.push(E[q]);return m(E[V],I.point)||N.push(I.point),N},u.prototype.lineSliceAlong=function(x,w,E){for(var C=0,I=[],D=0;D<E.length-1;D++){var N=E[D],W=E[D+1],V=this.distance(N,W);if((C+=V)>x&&I.length===0&&I.push(g(N,W,(x-(C-V))/V)),C>=w)return I.push(g(N,W,(w-(C-V))/V)),I;C>x&&I.push(W)}return I},u.prototype.bufferPoint=function(x,w){var E=w/this.ky,C=w/this.kx;return[x[0]-C,x[1]-E,x[0]+C,x[1]+E]},u.prototype.bufferBBox=function(x,w){var E=w/this.ky,C=w/this.kx;return[x[0]-C,x[1]-E,x[2]+C,x[3]+E]},u.prototype.insideBBox=function(x,w){return v(x[0]-w[0])>=0&&v(x[0]-w[2])<=0&&x[1]>=w[1]&&x[1]<=w[3]},Object.defineProperties(u,h),u}();var ku=O(B_.exports),U_={exports:{}};U_.exports=function(){var r=function(o,c){if(o===void 0&&(o=[]),c===void 0&&(c=t),this.data=o,this.length=this.data.length,this.compare=c,this.length>0)for(var u=(this.length>>1)-1;u>=0;u--)this._down(u)};function t(o,c){return o<c?-1:o>c?1:0}return r.prototype.push=function(o){this.data.push(o),this.length++,this._up(this.length-1)},r.prototype.pop=function(){if(this.length!==0){var o=this.data[0],c=this.data.pop();return this.length--,this.length>0&&(this.data[0]=c,this._down(0)),o}},r.prototype.peek=function(){return this.data[0]},r.prototype._up=function(o){for(var c=this.data,u=this.compare,h=c[o];o>0;){var m=o-1>>1,g=c[m];if(u(h,g)>=0)break;c[o]=g,o=m}c[o]=h},r.prototype._down=function(o){for(var c=this.data,u=this.compare,h=this.length>>1,m=c[o];o<h;){var g=1+(o<<1),v=c[g],x=g+1;if(x<this.length&&u(c[x],v)<0&&(g=x,v=c[x]),u(v,m)>=0)break;c[o]=v,o=g}c[o]=m},r}();var Vd=O(U_.exports),mt=8192;function sf(r,t){return t.dist-r.dist}const Du=100,al=50;function gy(r){const t=[1/0,1/0,-1/0,-1/0];if(t.length!==r.length)return!1;for(let o=0;o<t.length;o++)if(t[o]!==r[o])return!1;return!0}function Vc(r){return r[1]-r[0]+1}function hc(r,t){const o=r[1]>=r[0]&&r[1]<t;return o||console.warn("Distance Expression: Index is out of range"),o}function $p(r,t){if(r[0]>r[1])return[null,null];const o=Vc(r);if(t){if(o===2)return[r,null];const c=Math.floor(o/2);return[[r[0],r[0]+c],[r[0]+c,r[1]]]}{if(o===1)return[r,null];const c=Math.floor(o/2)-1;return[[r[0],r[0]+c],[r[0]+c+1,r[1]]]}}function Sr(r,t){const o=[1/0,1/0,-1/0,-1/0];if(!hc(t,r.length))return o;for(let c=t[0];c<=t[1];++c)rf(o,r[c]);return o}function Gd(r){const t=[1/0,1/0,-1/0,-1/0];for(let o=0;o<r.length;++o)for(let c=0;c<r[o].length;++c)rf(t,r[o][c]);return t}function zu(r,t,o){if(gy(r)||gy(t))return NaN;let c=0,u=0;return r[2]<t[0]&&(c=t[0]-r[2]),r[0]>t[2]&&(c=r[0]-t[2]),r[1]>t[3]&&(u=r[1]-t[3]),r[3]<t[1]&&(u=t[1]-r[3]),o.distance([0,0],[c,u])}function Yp(r,t){const o=Math.pow(2,t.z);return[(u=(r.x/mt+t.x)/o,360*u-180),(c=(r.y/mt+t.y)/o,360/Math.PI*Math.atan(Math.exp((180-360*c)*Math.PI/180))-90)];var c,u}function yy(r,t){const o=[];for(let c=0;c<r.length;++c)o.push(Yp(r[c],t));return o}function ks(r,t,o){const c=o.pointOnLine(t,r).point;return o.distance(r,c)}function Hd(r,t,o,c,u){const h=o.slice(c[0],c[1]+1);let m=1/0;for(let g=t[0];g<=t[1];++g)if((m=Math.min(m,ks(r[g],h,u)))===0)return 0;return m}function ia(r,t,o,c,u){const h=Math.min(u.pointToSegmentDistance(r,o,c),u.pointToSegmentDistance(t,o,c)),m=Math.min(u.pointToSegmentDistance(o,r,t),u.pointToSegmentDistance(c,r,t));return Math.min(h,m)}function Fo(r,t,o,c,u){if(!hc(t,r.length)||!hc(c,o.length))return NaN;let h=1/0;for(let m=t[0];m<t[1];++m)for(let g=c[0];g<c[1];++g){if(Br(r[m],r[m+1],o[g],o[g+1]))return 0;h=Math.min(h,ia(r[m],r[m+1],o[g],o[g+1],u))}return h}function mo(r,t,o,c,u){if(!hc(t,r.length)||!hc(c,o.length))return NaN;let h=1/0;for(let m=t[0];m<=t[1];++m)for(let g=c[0];g<=c[1];++g)if((h=Math.min(h,u.distance(r[m],o[g])))===0)return h;return h}function vy(r,t,o){if(po(r,t,!0))return 0;let c=1/0;for(const u of t){const h=u.length;if(h<2)return console.warn("Distance Expression: Invalid polygon!"),NaN;if(u[0]!==u[h-1]&&(c=Math.min(c,o.pointToSegmentDistance(r,u[h-1],u[0])))===0||(c=Math.min(c,ks(r,u,o)))===0)return c}return c}function qp(r,t,o,c){if(!hc(t,r.length))return NaN;for(let h=t[0];h<=t[1];++h)if(po(r[h],o,!0))return 0;let u=1/0;for(let h=t[0];h<t[1];++h)for(const m of o)for(let g=0,v=m.length,x=v-1;g<v;x=g++){if(Br(r[h],r[h+1],m[x],m[g]))return 0;u=Math.min(u,ia(r[h],r[h+1],m[x],m[g],c))}return u}function lf(r,t){for(const o of r)for(let c=0;c<=o.length-1;++c)if(po(o[c],t,!0))return!0;return!1}function LC(r,t,o,c=1/0){const u=Gd(r),h=Gd(t);if(c!==1/0&&zu(u,h,o)>=c)return c;if(Ud(u,h)){if(lf(r,t))return 0}else if(lf(t,r))return 0;let m=c;for(const g of r)for(let v=0,x=g.length,w=x-1;v<x;w=v++)for(const E of t)for(let C=0,I=E.length,D=I-1;C<I;D=C++){if(Br(g[w],g[v],E[D],E[C]))return 0;m=Math.min(m,ia(g[w],g[v],E[D],E[C],o))}return m}function Qa(r,t,o,c,u,h,m){if(h===null||m===null)return;const g=zu(Sr(c,h),Sr(u,m),o);g<t&&r.push({dist:g,range1:h,range2:m})}function W_(r,t,o,c,u=1/0){let h=Math.min(c.distance(r[0],o[0][0]),u);if(h===0)return h;const m=new Vd([{dist:0,range1:[0,r.length-1],range2:[0,0]}],sf),g=t?al:Du,v=Gd(o);for(;m.length;){const x=m.pop();if(x.dist>=h)continue;const w=x.range1;if(Vc(w)<=g){if(!hc(w,r.length))return NaN;if(t){const E=qp(r,w,o,c);if((h=Math.min(h,E))===0)return h}else for(let E=w[0];E<=w[1];++E){const C=vy(r[E],o,c);if((h=Math.min(h,C))===0)return h}}else{const E=$p(w,t);if(E[0]!==null){const C=zu(Sr(r,E[0]),v,c);C<h&&m.push({dist:C,range1:E[0],range2:[0,0]})}if(E[1]!==null){const C=zu(Sr(r,E[1]),v,c);C<h&&m.push({dist:C,range1:E[1],range2:[0,0]})}}}return h}function _y(r,t,o,c,u,h=1/0){let m=Math.min(h,u.distance(r[0],o[0]));if(m===0)return m;const g=new Vd([{dist:0,range1:[0,r.length-1],range2:[0,o.length-1]}],sf),v=t?al:Du,x=c?al:Du;for(;g.length;){const w=g.pop();if(w.dist>=m)continue;const E=w.range1,C=w.range2;if(Vc(E)<=v&&Vc(C)<=x){if(!hc(E,r.length)||!hc(C,o.length))return NaN;if(t&&c?m=Math.min(m,Fo(r,E,o,C,u)):t||c?t&&!c?m=Math.min(m,Hd(o,C,r,E,u)):!t&&c&&(m=Math.min(m,Hd(r,E,o,C,u))):m=Math.min(m,mo(r,E,o,C,u)),m===0)return m}else{const I=$p(E,t),D=$p(C,c);Qa(g,m,u,r,o,I[0],D[0]),Qa(g,m,u,r,o,I[0],D[1]),Qa(g,m,u,r,o,I[1],D[0]),Qa(g,m,u,r,o,I[1],D[1])}}return m}function Xp(r,t,o,c,u=1/0){let h=u;const m=Sr(r,[0,r.length-1]);for(const g of o)if(!(h!==1/0&&zu(m,Sr(g,[0,g.length-1]),c)>=h)&&(h=Math.min(h,_y(r,t,g,!0,c,h)),h===0))return h;return h}function ol(r,t,o,c,u=1/0){let h=u;const m=Sr(r,[0,r.length-1]);for(const g of o){if(h!==1/0&&zu(m,Gd(g),c)>=h)continue;const v=W_(r,t,g,c,h);if(isNaN(v))return v;if((h=Math.min(h,v))===0)return h}return h}function sl(r){return r==="Point"||r==="MultiPoint"||r==="LineString"||r==="MultiLineString"||r==="Polygon"||r==="MultiPolygon"}class Nl{constructor(t,o){this.type=an,this.geojson=t,this.geometries=o}static parse(t,o){if(t.length!==2)return o.error(`'distance' expression requires either one argument, but found ' ${t.length-1} instead.`);if(os(t[1])){const c=t[1];if(c.type==="FeatureCollection"){for(let u=0;u<c.features.length;++u)if(sl(c.features[u].geometry.type))return new Nl(c,c.features[u].geometry)}else if(c.type==="Feature"){if(sl(c.geometry.type))return new Nl(c,c.geometry)}else if(sl(c.type))return new Nl(c,c)}return o.error("'distance' expression needs to be an array with format ['Distance', GeoJSONObj].")}evaluate(t){const o=t.geometry(),c=t.canonicalID();if(o!=null&&c!=null){if(t.geometryType()==="Point")return function(u,h,m){const g=[];for(const x of u)for(const w of x)g.push(Yp(w,h));const v=new ku(g[0][1],"meters");return m.type==="Point"||m.type==="MultiPoint"||m.type==="LineString"?_y(g,!1,m.type==="Point"?[m.coordinates]:m.coordinates,m.type==="LineString",v):m.type==="MultiLineString"?Xp(g,!1,m.coordinates,v):m.type==="Polygon"||m.type==="MultiPolygon"?ol(g,!1,m.type==="Polygon"?[m.coordinates]:m.coordinates,v):null}(o,c,this.geometries);if(t.geometryType()==="LineString")return function(u,h,m){const g=[];for(const x of u){const w=[];for(const E of x)w.push(Yp(E,h));g.push(w)}const v=new ku(g[0][0][1],"meters");if(m.type==="Point"||m.type==="MultiPoint"||m.type==="LineString")return Xp(m.type==="Point"?[m.coordinates]:m.coordinates,m.type==="LineString",g,v);if(m.type==="MultiLineString"){let x=1/0;for(let w=0;w<m.coordinates.length;w++){const E=Xp(m.coordinates[w],!0,g,v,x);if(isNaN(E))return E;if((x=Math.min(x,E))===0)return x}return x}if(m.type==="Polygon"||m.type==="MultiPolygon"){let x=1/0;for(let w=0;w<g.length;w++){const E=ol(g[w],!0,m.type==="Polygon"?[m.coordinates]:m.coordinates,v,x);if(isNaN(E))return E;if((x=Math.min(x,E))===0)return x}return x}return null}(o,c,this.geometries);if(t.geometryType()==="Polygon")return function(u,h,m){const g=[];for(const x of function(w,E){const C=w.length;if(C<=1)return[w];const I=[];let D,N;for(let W=0;W<C;W++){const V=Bd(w[W]);V!==0&&(w[W].area=Math.abs(V),N===void 0&&(N=V<0),N===V<0?(D&&I.push(D),D=[w[W]]):D.push(w[W]))}return D&&I.push(D),I}(u)){const w=[];for(let E=0;E<x.length;++E)w.push(yy(x[E],h));g.push(w)}const v=new ku(g[0][0][0][1],"meters");if(m.type==="Point"||m.type==="MultiPoint"||m.type==="LineString")return ol(m.type==="Point"?[m.coordinates]:m.coordinates,m.type==="LineString",g,v);if(m.type==="MultiLineString"){let x=1/0;for(let w=0;w<m.coordinates.length;w++){const E=ol(m.coordinates[w],!0,g,v,x);if(isNaN(E))return E;if((x=Math.min(x,E))===0)return x}return x}return m.type==="Polygon"||m.type==="MultiPolygon"?function(x,w,E){let C=1/0;for(const I of x)for(const D of w){const N=LC(I,D,E,C);if(isNaN(N))return N;if((C=Math.min(C,N))===0)return C}return C}(m.type==="Polygon"?[m.coordinates]:m.coordinates,g,v):null}(o,c,this.geometries);console.warn("Distance Expression: currently only evaluates valid Point/LineString/Polygon geometries.")}else console.warn("Distance Expression: requirs valid feature and canonical information.");return null}eachChild(){}outputDefined(){return!0}serialize(){return["distance",this.geojson]}}var cf=Nl;function Ou(r){if(r instanceof Pa&&(r.name==="get"&&r.args.length===1||r.name==="feature-state"||r.name==="has"&&r.args.length===1||r.name==="properties"||r.name==="geometry-type"||r.name==="id"||/^filter-/.test(r.name))||r instanceof my||r instanceof cf)return!1;let t=!0;return r.eachChild(o=>{t&&!Ou(o)&&(t=!1)}),t}function Zp(r){if(r instanceof Pa&&r.name==="feature-state")return!1;let t=!0;return r.eachChild(o=>{t&&!Zp(o)&&(t=!1)}),t}function xy(r){if(r instanceof Pa&&r.name==="config")return!1;let t=!0;return r.eachChild(o=>{t&&!xy(o)&&(t=!1)}),t}function jd(r,t){if(r instanceof Pa&&t.indexOf(r.name)>=0)return!1;let o=!0;return r.eachChild(c=>{o&&!jd(c,t)&&(o=!1)}),o}class by{constructor(t,o){this.type=o.type,this.name=t,this.boundExpression=o}static parse(t,o){if(t.length!==2||typeof t[1]!="string")return o.error("'var' expression requires exactly one string literal argument.");const c=t[1];return o.scope.has(c)?new by(c,o.scope.get(c)):o.error(`Unknown variable "${c}". Make sure "${c}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(t){return this.boundExpression.evaluate(t)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}var V_=by;class wy{constructor(t,o=[],c,u=new Gp,h=[],m){this.registry=t,this.path=o,this.key=o.map(g=>`[${g}]`).join(""),this.scope=u,this.errors=h,this.expectedType=c,this.options=m}parse(t,o,c,u,h={}){return o||c?this.concat(o,c,u)._parse(t,h):this._parse(t,h)}_parse(t,o){function c(u,h,m){return m==="assert"?new nl(h,[u]):m==="coerce"?new il(h,[u]):u}if(t!==null&&typeof t!="string"&&typeof t!="boolean"&&typeof t!="number"||(t=["literal",t]),Array.isArray(t)){if(t.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const u=typeof t[0]=="string"?this.registry[t[0]]:void 0;if(u){let h=u.parse(t,this);if(!h)return null;if(this.expectedType){const m=this.expectedType,g=h.type;if(m.kind!=="string"&&m.kind!=="number"&&m.kind!=="boolean"&&m.kind!=="object"&&m.kind!=="array"||g.kind!=="value")if(m.kind!=="color"&&m.kind!=="formatted"&&m.kind!=="resolvedImage"||g.kind!=="value"&&g.kind!=="string"){if(this.checkSubtype(m,g))return null}else h=c(h,m,o.typeAnnotation||"coerce");else h=c(h,m,o.typeAnnotation||"assert")}if(!(h instanceof Iu)&&h.type.kind!=="resolvedImage"&&$d(h)){const m=new jp(this.options);try{h=new Iu(h.type,h.evaluate(m))}catch(g){return this.error(g.message),null}}return h}return il.parse(["to-array",t],this)}return this.error(t===void 0?"'undefined' value invalid. Use null instead.":typeof t=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof t} instead.`)}concat(t,o,c){const u=typeof t=="number"?this.path.concat(t):this.path,h=c?this.scope.concat(c):this.scope;return new wy(this.registry,u,o||null,h,this.errors,this.options)}error(t,...o){const c=`${this.key}${o.map(u=>`[${u}]`).join("")}`;this.errors.push(new Ls(c,t))}checkSubtype(t,o){const c=Dl(t,o);return c&&this.error(c),c}}var Sy=wy;function $d(r){if(r instanceof V_)return $d(r.boundExpression);if(r instanceof Pa&&r.name==="error"||r instanceof Pa&&r.name==="config"||r instanceof uc||r instanceof my||r instanceof cf)return!1;const t=r instanceof il||r instanceof nl;let o=!0;return r.eachChild(c=>{o=t?o&&$d(c):o&&c instanceof Iu}),!!o&&Ou(r)&&jd(r,["zoom","heatmap-density","line-progress","raster-value","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center","measure-light"])}function Kp(r,t){const o=r.length-1;let c,u,h=0,m=o,g=0;for(;h<=m;)if(g=Math.floor((h+m)/2),c=r[g],u=r[g+1],c<=t){if(g===o||t<u)return g;h=g+1}else{if(!(c>t))throw new Ca("Input is not a number.");m=g-1}return 0}class uf{constructor(t,o,c){this.type=t,this.input=o,this.labels=[],this.outputs=[];for(const[u,h]of c)this.labels.push(u),this.outputs.push(h)}static parse(t,o){if(t.length-1<4)return o.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return o.error("Expected an even number of arguments.");const c=o.parse(t[1],1,an);if(!c)return null;const u=[];let h=null;o.expectedType&&o.expectedType.kind!=="value"&&(h=o.expectedType);for(let m=1;m<t.length;m+=2){const g=m===1?-1/0:t[m],v=t[m+1],x=m,w=m+1;if(typeof g!="number")return o.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',x);if(u.length&&u[u.length-1][0]>=g)return o.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',x);const E=o.parse(v,w,h);if(!E)return null;h=h||E.type,u.push([g,E])}return new uf(h,c,u)}evaluate(t){const o=this.labels,c=this.outputs;if(o.length===1)return c[0].evaluate(t);const u=this.input.evaluate(t);if(u<=o[0])return c[0].evaluate(t);const h=o.length;return u>=o[h-1]?c[h-1].evaluate(t):c[Kp(o,u)].evaluate(t)}eachChild(t){t(this.input);for(const o of this.outputs)t(o)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}serialize(){const t=["step",this.input.serialize()];for(let o=0;o<this.labels.length;o++)o>0&&t.push(this.labels[o]),t.push(this.outputs[o].serialize());return t}}var df=uf;function kn(r,t,o){return r*(1-o)+t*o}function hf(r,t,o){return r.map((c,u)=>kn(c,t[u],o))}var Jp=Object.freeze({__proto__:null,array:hf,color:function(r,t,o){return new En(kn(r.r,t.r,o),kn(r.g,t.g,o),kn(r.b,t.b,o),kn(r.a,t.a,o))},number:kn});const G_=.95047,H_=1.08883,j_=4/29,Nu=6/29,$_=3*Nu*Nu,gS=Nu*Nu*Nu,kC=Math.PI/180,yS=180/Math.PI;function Y_(r){return r>gS?Math.pow(r,1/3):r/$_+j_}function q_(r){return r>Nu?r*r*r:$_*(r-j_)}function Ey(r){return 255*(r<=.0031308?12.92*r:1.055*Math.pow(r,1/2.4)-.055)}function My(r){return(r/=255)<=.04045?r/12.92:Math.pow((r+.055)/1.055,2.4)}function X_(r){const t=My(r.r),o=My(r.g),c=My(r.b),u=Y_((.4124564*t+.3575761*o+.1804375*c)/G_),h=Y_((.2126729*t+.7151522*o+.072175*c)/1);return{l:116*h-16,a:500*(u-h),b:200*(h-Y_((.0193339*t+.119192*o+.9503041*c)/H_)),alpha:r.a}}function Z_(r){let t=(r.l+16)/116,o=isNaN(r.a)?t:t+r.a/500,c=isNaN(r.b)?t:t-r.b/200;return t=1*q_(t),o=G_*q_(o),c=H_*q_(c),new En(Ey(3.2404542*o-1.5371385*t-.4985314*c),Ey(-.969266*o+1.8760108*t+.041556*c),Ey(.0556434*o-.2040259*t+1.0572252*c),r.alpha)}function Ty(r,t,o){const c=t-r;return r+o*(c>180||c<-180?c-360*Math.round(c/360):c)}const Qp={forward:X_,reverse:Z_,interpolate:function(r,t,o){return{l:kn(r.l,t.l,o),a:kn(r.a,t.a,o),b:kn(r.b,t.b,o),alpha:kn(r.alpha,t.alpha,o)}}},em={forward:function(r){const{l:t,a:o,b:c}=X_(r),u=Math.atan2(c,o)*yS;return{h:u<0?u+360:u,c:Math.sqrt(o*o+c*c),l:t,alpha:r.a}},reverse:function(r){const t=r.h*kC,o=r.c;return Z_({l:r.l,a:Math.cos(t)*o,b:Math.sin(t)*o,alpha:r.alpha})},interpolate:function(r,t,o){return{h:Ty(r.h,t.h,o),c:kn(r.c,t.c,o),l:kn(r.l,t.l,o),alpha:kn(r.alpha,t.alpha,o)}}};var vS=Object.freeze({__proto__:null,hcl:em,lab:Qp});class ff{constructor(t,o,c,u,h){this.type=t,this.operator=o,this.interpolation=c,this.input=u,this.labels=[],this.outputs=[];for(const[m,g]of h)this.labels.push(m),this.outputs.push(g)}static interpolationFactor(t,o,c,u){let h=0;if(t.name==="exponential")h=tm(o,t.base,c,u);else if(t.name==="linear")h=tm(o,1,c,u);else if(t.name==="cubic-bezier"){const m=t.controlPoints;h=new $(m[0],m[1],m[2],m[3]).solve(tm(o,1,c,u))}return h}static parse(t,o){let[c,u,h,...m]=t;if(!Array.isArray(u)||u.length===0)return o.error("Expected an interpolation type expression.",1);if(u[0]==="linear")u={name:"linear"};else if(u[0]==="exponential"){const x=u[1];if(typeof x!="number")return o.error("Exponential interpolation requires a numeric base.",1,1);u={name:"exponential",base:x}}else{if(u[0]!=="cubic-bezier")return o.error(`Unknown interpolation type ${String(u[0])}`,1,0);{const x=u.slice(1);if(x.length!==4||x.some(w=>typeof w!="number"||w<0||w>1))return o.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);u={name:"cubic-bezier",controlPoints:x}}}if(t.length-1<4)return o.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return o.error("Expected an even number of arguments.");if(h=o.parse(h,2,an),!h)return null;const g=[];let v=null;c==="interpolate-hcl"||c==="interpolate-lab"?v=na:o.expectedType&&o.expectedType.kind!=="value"&&(v=o.expectedType);for(let x=0;x<m.length;x+=2){const w=m[x],E=m[x+1],C=x+3,I=x+4;if(typeof w!="number")return o.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',C);if(g.length&&g[g.length-1][0]>=w)return o.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',C);const D=o.parse(E,I,v);if(!D)return null;v=v||D.type,g.push([w,D])}return v.kind==="number"||v.kind==="color"||v.kind==="array"&&v.itemType.kind==="number"&&typeof v.N=="number"?new ff(v,c,u,h,g):o.error(`Type ${vr(v)} is not interpolatable.`)}evaluate(t){const o=this.labels,c=this.outputs;if(o.length===1)return c[0].evaluate(t);const u=this.input.evaluate(t);if(u<=o[0])return c[0].evaluate(t);const h=o.length;if(u>=o[h-1])return c[h-1].evaluate(t);const m=Kp(o,u),g=ff.interpolationFactor(this.interpolation,u,o[m],o[m+1]),v=c[m].evaluate(t),x=c[m+1].evaluate(t);return this.operator==="interpolate"?Jp[this.type.kind.toLowerCase()](v,x,g):this.operator==="interpolate-hcl"?em.reverse(em.interpolate(em.forward(v),em.forward(x),g)):Qp.reverse(Qp.interpolate(Qp.forward(v),Qp.forward(x),g))}eachChild(t){t(this.input);for(const o of this.outputs)t(o)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}serialize(){let t;t=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const o=[this.operator,t,this.input.serialize()];for(let c=0;c<this.labels.length;c++)o.push(this.labels[c],this.outputs[c].serialize());return o}}function tm(r,t,o,c){const u=c-o,h=r-o;return u===0?0:t===1?h/u:(Math.pow(t,h)-1)/(Math.pow(t,u)-1)}var fc=ff;class Ay{constructor(t,o){this.type=t,this.args=o}static parse(t,o){if(t.length<2)return o.error("Expectected at least one argument.");let c=null;const u=o.expectedType;u&&u.kind!=="value"&&(c=u);const h=[];for(const g of t.slice(1)){const v=o.parse(g,1+h.length,c,void 0,{typeAnnotation:"omit"});if(!v)return null;c=c||v.type,h.push(v)}const m=u&&h.some(g=>Dl(u,g.type));return new Ay(m?li:c,h)}evaluate(t){let o,c=null,u=0;for(const h of this.args){if(u++,c=h.evaluate(t),c&&c instanceof as&&!c.available&&(o||(o=c),c=null,u===this.args.length))return o;if(c!==null)break}return c}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}serialize(){const t=["coalesce"];return this.eachChild(o=>{t.push(o.serialize())}),t}}var K_=Ay;class Cy{constructor(t,o){this.type=o.type,this.bindings=[].concat(t),this.result=o}evaluate(t){return this.result.evaluate(t)}eachChild(t){for(const o of this.bindings)t(o[1]);t(this.result)}static parse(t,o){if(t.length<4)return o.error(`Expected at least 3 arguments, but found ${t.length-1} instead.`);const c=[];for(let h=1;h<t.length-1;h+=2){const m=t[h];if(typeof m!="string")return o.error(`Expected string, but found ${typeof m} instead.`,h);if(/[^a-zA-Z0-9_]/.test(m))return o.error("Variable names must contain only alphanumeric characters or '_'.",h);const g=o.parse(t[h+1],h+1);if(!g)return null;c.push([m,g])}const u=o.parse(t[t.length-1],t.length-1,o.expectedType,c);return u?new Cy(c,u):null}outputDefined(){return this.result.outputDefined()}serialize(){const t=["let"];for(const[o,c]of this.bindings)t.push(o,c.serialize());return t.push(this.result.serialize()),t}}var J_=Cy;class Py{constructor(t,o,c){this.type=t,this.index=o,this.input=c}static parse(t,o){if(t.length!==3)return o.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const c=o.parse(t[1],1,an),u=o.parse(t[2],2,Fr(o.expectedType||li));return c&&u?new Py(u.type.itemType,c,u):null}evaluate(t){const o=this.index.evaluate(t),c=this.input.evaluate(t);if(o<0)throw new Ca(`Array index out of bounds: ${o} < 0.`);if(o>=c.length)throw new Ca(`Array index out of bounds: ${o} > ${c.length-1}.`);if(o!==Math.floor(o))throw new Ca(`Array index must be an integer, but found ${o} instead.`);return c[o]}eachChild(t){t(this.index),t(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}var pc=Py;class Iy{constructor(t,o){this.type=Ci,this.needle=t,this.haystack=o}static parse(t,o){if(t.length!==3)return o.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const c=o.parse(t[1],1,li),u=o.parse(t[2],2,li);return c&&u?Ao(c.type,[Ci,xi,an,el,li])?new Iy(c,u):o.error(`Expected first argument to be of type boolean, string, number or null, but found ${vr(c.type)} instead`):null}evaluate(t){const o=this.needle.evaluate(t),c=this.haystack.evaluate(t);if(c==null)return!1;if(!ga(o,["boolean","string","number","null"]))throw new Ca(`Expected first argument to be of type boolean, string, number or null, but found ${vr(zr(o))} instead.`);if(!ga(c,["string","array"]))throw new Ca(`Expected second argument to be of type array or string, but found ${vr(zr(c))} instead.`);return c.indexOf(o)>=0}eachChild(t){t(this.needle),t(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}var nm=Iy;class Fu{constructor(t,o,c){this.type=an,this.needle=t,this.haystack=o,this.fromIndex=c}static parse(t,o){if(t.length<=2||t.length>=5)return o.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const c=o.parse(t[1],1,li),u=o.parse(t[2],2,li);if(!c||!u)return null;if(!Ao(c.type,[Ci,xi,an,el,li]))return o.error(`Expected first argument to be of type boolean, string, number or null, but found ${vr(c.type)} instead`);if(t.length===4){const h=o.parse(t[3],3,an);return h?new Fu(c,u,h):null}return new Fu(c,u)}evaluate(t){const o=this.needle.evaluate(t),c=this.haystack.evaluate(t);if(!ga(o,["boolean","string","number","null"]))throw new Ca(`Expected first argument to be of type boolean, string, number or null, but found ${vr(zr(o))} instead.`);if(!ga(c,["string","array"]))throw new Ca(`Expected second argument to be of type array or string, but found ${vr(zr(c))} instead.`);if(this.fromIndex){const u=this.fromIndex.evaluate(t);return c.indexOf(o,u)}return c.indexOf(o)}eachChild(t){t(this.needle),t(this.haystack),this.fromIndex&&t(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const t=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),t]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}var Ry=Fu;class pf{constructor(t,o,c,u,h,m){this.inputType=t,this.type=o,this.input=c,this.cases=u,this.outputs=h,this.otherwise=m}static parse(t,o){if(t.length<5)return o.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if(t.length%2!=1)return o.error("Expected an even number of arguments.");let c,u;o.expectedType&&o.expectedType.kind!=="value"&&(u=o.expectedType);const h={},m=[];for(let x=2;x<t.length-1;x+=2){let w=t[x];const E=t[x+1];Array.isArray(w)||(w=[w]);const C=o.concat(x);if(w.length===0)return C.error("Expected at least one branch label.");for(const D of w){if(typeof D!="number"&&typeof D!="string")return C.error("Branch labels must be numbers or strings.");if(typeof D=="number"&&Math.abs(D)>Number.MAX_SAFE_INTEGER)return C.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof D=="number"&&Math.floor(D)!==D)return C.error("Numeric branch labels must be integer values.");if(c){if(C.checkSubtype(c,zr(D)))return null}else c=zr(D);if(h[String(D)]!==void 0)return C.error("Branch labels must be unique.");h[String(D)]=m.length}const I=o.parse(E,x,u);if(!I)return null;u=u||I.type,m.push(I)}const g=o.parse(t[1],1,li);if(!g)return null;const v=o.parse(t[t.length-1],t.length-1,u);return v?g.type.kind!=="value"&&o.concat(1).checkSubtype(c,g.type)?null:new pf(c,u,g,h,m,v):null}evaluate(t){const o=this.input.evaluate(t);return(zr(o)===this.inputType&&this.outputs[this.cases[o]]||this.otherwise).evaluate(t)}eachChild(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)}outputDefined(){return this.outputs.every(t=>t.outputDefined())&&this.otherwise.outputDefined()}serialize(){const t=["match",this.input.serialize()],o=Object.keys(this.cases).sort(),c=[],u={};for(const m of o){const g=u[this.cases[m]];g===void 0?(u[this.cases[m]]=c.length,c.push([this.cases[m],[m]])):c[g][1].push(m)}const h=m=>this.inputType.kind==="number"?Number(m):m;for(const[m,g]of c)t.push(g.length===1?h(g[0]):g.map(h)),t.push(this.outputs[m].serialize());return t.push(this.otherwise.serialize()),t}}var _S=pf;class Yd{constructor(t,o,c){this.type=t,this.branches=o,this.otherwise=c}static parse(t,o){if(t.length<4)return o.error(`Expected at least 3 arguments, but found only ${t.length-1}.`);if(t.length%2!=0)return o.error("Expected an odd number of arguments.");let c;o.expectedType&&o.expectedType.kind!=="value"&&(c=o.expectedType);const u=[];for(let m=1;m<t.length-1;m+=2){const g=o.parse(t[m],m,Ci);if(!g)return null;const v=o.parse(t[m+1],m+1,c);if(!v)return null;u.push([g,v]),c=c||v.type}const h=o.parse(t[t.length-1],t.length-1,c);return h?new Yd(c,u,h):null}evaluate(t){for(const[o,c]of this.branches)if(o.evaluate(t))return c.evaluate(t);return this.otherwise.evaluate(t)}eachChild(t){for(const[o,c]of this.branches)t(o),t(c);t(this.otherwise)}outputDefined(){return this.branches.every(([t,o])=>o.outputDefined())&&this.otherwise.outputDefined()}serialize(){const t=["case"];return this.eachChild(o=>{t.push(o.serialize())}),t}}var Bo=Yd;class Ly{constructor(t,o,c,u){this.type=t,this.input=o,this.beginIndex=c,this.endIndex=u}static parse(t,o){if(t.length<=2||t.length>=5)return o.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const c=o.parse(t[1],1,li),u=o.parse(t[2],2,an);if(!c||!u)return null;if(!Ao(c.type,[Fr(li),xi,li]))return o.error(`Expected first argument to be of type array or string, but found ${vr(c.type)} instead`);if(t.length===4){const h=o.parse(t[3],3,an);return h?new Ly(c.type,c,u,h):null}return new Ly(c.type,c,u)}evaluate(t){const o=this.input.evaluate(t),c=this.beginIndex.evaluate(t);if(!ga(o,["string","array"]))throw new Ca(`Expected first argument to be of type array or string, but found ${vr(zr(o))} instead.`);if(this.endIndex){const u=this.endIndex.evaluate(t);return o.slice(c,u)}return o.slice(c)}eachChild(t){t(this.input),t(this.beginIndex),this.endIndex&&t(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const t=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),t]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}var DC=Ly;function ls(r,t){return r==="=="||r==="!="?t.kind==="boolean"||t.kind==="string"||t.kind==="number"||t.kind==="null"||t.kind==="value":t.kind==="string"||t.kind==="number"||t.kind==="value"}function Uo(r,t,o,c){return c.compare(t,o)===0}function qd(r,t,o){const c=r!=="=="&&r!=="!=";return class bJ{constructor(h,m,g){this.type=Ci,this.lhs=h,this.rhs=m,this.collator=g,this.hasUntypedArgument=h.type.kind==="value"||m.type.kind==="value"}static parse(h,m){if(h.length!==3&&h.length!==4)return m.error("Expected two or three arguments.");const g=h[0];let v=m.parse(h[1],1,li);if(!v)return null;if(!ls(g,v.type))return m.concat(1).error(`"${g}" comparisons are not supported for type '${vr(v.type)}'.`);let x=m.parse(h[2],2,li);if(!x)return null;if(!ls(g,x.type))return m.concat(2).error(`"${g}" comparisons are not supported for type '${vr(x.type)}'.`);if(v.type.kind!==x.type.kind&&v.type.kind!=="value"&&x.type.kind!=="value")return m.error(`Cannot compare types '${vr(v.type)}' and '${vr(x.type)}'.`);c&&(v.type.kind==="value"&&x.type.kind!=="value"?v=new nl(x.type,[v]):v.type.kind!=="value"&&x.type.kind==="value"&&(x=new nl(v.type,[x])));let w=null;if(h.length===4){if(v.type.kind!=="string"&&x.type.kind!=="string"&&v.type.kind!=="value"&&x.type.kind!=="value")return m.error("Cannot use collator to compare non-string types.");if(w=m.parse(h[3],3,qo),!w)return null}return new bJ(v,x,w)}evaluate(h){const m=this.lhs.evaluate(h),g=this.rhs.evaluate(h);if(c&&this.hasUntypedArgument){const v=zr(m),x=zr(g);if(v.kind!==x.kind||v.kind!=="string"&&v.kind!=="number")throw new Ca(`Expected arguments for "${r}" to be (string, string) or (number, number), but found (${v.kind}, ${x.kind}) instead.`)}if(this.collator&&!c&&this.hasUntypedArgument){const v=zr(m),x=zr(g);if(v.kind!=="string"||x.kind!=="string")return t(h,m,g)}return this.collator?o(h,m,g,this.collator.evaluate(h)):t(h,m,g)}eachChild(h){h(this.lhs),h(this.rhs),this.collator&&h(this.collator)}outputDefined(){return!0}serialize(){const h=[r];return this.eachChild(m=>{h.push(m.serialize())}),h}}}const xS=qd("==",function(r,t,o){return t===o},Uo),bS=qd("!=",function(r,t,o){return t!==o},function(r,t,o,c){return!Uo(0,t,o,c)}),wS=qd("<",function(r,t,o){return t<o},function(r,t,o,c){return c.compare(t,o)<0}),SS=qd(">",function(r,t,o){return t>o},function(r,t,o,c){return c.compare(t,o)>0}),Q_=qd("<=",function(r,t,o){return t<=o},function(r,t,o,c){return c.compare(t,o)<=0}),ES=qd(">=",function(r,t,o){return t>=o},function(r,t,o,c){return c.compare(t,o)>=0});class im{constructor(t,o,c,u,h,m){this.type=xi,this.number=t,this.locale=o,this.currency=c,this.unit=u,this.minFractionDigits=h,this.maxFractionDigits=m}static parse(t,o){if(t.length!==3)return o.error("Expected two arguments.");const c=o.parse(t[1],1,an);if(!c)return null;const u=t[2];if(typeof u!="object"||Array.isArray(u))return o.error("NumberFormat options argument must be an object.");let h=null;if(u.locale&&(h=o.parse(u.locale,1,xi),!h))return null;let m=null;if(u.currency&&(m=o.parse(u.currency,1,xi),!m))return null;let g=null;if(u.unit&&(g=o.parse(u.unit,1,xi),!g))return null;let v=null;if(u["min-fraction-digits"]&&(v=o.parse(u["min-fraction-digits"],1,an),!v))return null;let x=null;return u["max-fraction-digits"]&&(x=o.parse(u["max-fraction-digits"],1,an),!x)?null:new im(c,h,m,g,v,x)}evaluate(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(t):void 0,unit:this.unit?this.unit.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))}eachChild(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.unit&&t(this.unit),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const t={};return this.locale&&(t.locale=this.locale.serialize()),this.currency&&(t.currency=this.currency.serialize()),this.unit&&(t.unit=this.unit.serialize()),this.minFractionDigits&&(t["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(t["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),t]}}class ky{constructor(t){this.type=an,this.input=t}static parse(t,o){if(t.length!==2)return o.error(`Expected 1 argument, but found ${t.length-1} instead.`);const c=o.parse(t[1],1);return c?c.type.kind!=="array"&&c.type.kind!=="string"&&c.type.kind!=="value"?o.error(`Expected argument of type string or array, but found ${vr(c.type)} instead.`):new ky(c):null}evaluate(t){const o=this.input.evaluate(t);if(typeof o=="string"||Array.isArray(o))return o.length;throw new Ca(`Expected value to be of type string or array, but found ${vr(zr(o))} instead.`)}eachChild(t){t(this.input)}outputDefined(){return!1}serialize(){const t=["length"];return this.eachChild(o=>{t.push(o.serialize())}),t}}function Dy(r){return function(){r=1831565813+(r|=0)|0;let t=Math.imul(r^r>>>15,1|r);return t=t+Math.imul(t^t>>>7,61|t)^t,((t^t>>>14)>>>0)/4294967296}}const rm={"==":xS,"!=":bS,">":SS,"<":wS,">=":ES,"<=":Q_,array:nl,at:pc,boolean:nl,case:Bo,coalesce:K_,collator:uc,format:tf,image:nf,in:nm,"index-of":Ry,interpolate:fc,"interpolate-hcl":fc,"interpolate-lab":fc,length:ky,let:J_,literal:Iu,match:_S,number:nl,"number-format":im,object:nl,slice:DC,step:df,string:nl,"to-boolean":il,"to-color":il,"to-number":il,"to-string":il,var:V_,within:my,distance:cf};function am(r,[t,o,c,u]){t=t.evaluate(r),o=o.evaluate(r),c=c.evaluate(r);const h=u?u.evaluate(r):1,m=z_(t,o,c,h);if(m)throw new Ca(m);return new En(t/255*h,o/255*h,c/255*h,h)}function e1(r,[t,o,c,u]){t=t.evaluate(r),o=o.evaluate(r),c=c.evaluate(r);const h=u?u.evaluate(r):1,m=function(x,w,E,C){return typeof x=="number"&&x>=0&&x<=360?typeof w=="number"&&w>=0&&w<=100&&typeof E=="number"&&E>=0&&E<=100?C===void 0||typeof C=="number"&&C>=0&&C<=1?null:`Invalid hsla value [${[x,w,E,C].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid hsla value [${(typeof C=="number"?[x,w,E,C]:[x,w,E]).join(", ")}]: 's', and 'l' must be between 0 and 100.`:`Invalid hsla value [${(typeof C=="number"?[x,w,E,C]:[x,w,E]).join(", ")}]: 'h' must be between 0 and 360.`}(t,o,c,h);if(m)throw new Ca(m);const g=`hsla(${t}, ${o}%, ${c}%, ${h})`,v=En.parse(g);if(!v)throw new Ca(`Failed to parse HSLA color: ${g}`);return v}function zy(r,t){return r in t}function Oy(r,t){const o=t[r];return o===void 0?null:o}function t1(r,t,o){o.length&&(t+=`${o}`);const c=r.getConfig(t);return c?c.evaluate(r):null}function mc(r){return{type:r}}Pa.register(rm,{error:[{kind:"error"},[xi],(r,[t])=>{throw new Ca(t.evaluate(r))}],typeof:[xi,[li],(r,[t])=>vr(zr(t.evaluate(r)))],"to-rgba":[Fr(an,4),[na],(r,[t])=>t.evaluate(r).toArray()],rgb:[na,[an,an,an],am],rgba:[na,[an,an,an,an],am],hsl:[na,[an,an,an],e1],hsla:[na,[an,an,an,an],e1],has:{type:Ci,overloads:[[[xi],(r,[t])=>zy(t.evaluate(r),r.properties())],[[xi,Ba],(r,[t,o])=>zy(t.evaluate(r),o.evaluate(r))]]},get:{type:li,overloads:[[[xi],(r,[t])=>Oy(t.evaluate(r),r.properties())],[[xi,Ba],(r,[t,o])=>Oy(t.evaluate(r),o.evaluate(r))]]},config:{type:li,overloads:[[[xi],(r,[t])=>t1(r,t.evaluate(r),"")],[[xi,xi],(r,[t,o])=>t1(r,t.evaluate(r),o.evaluate(r))]]},"feature-state":[li,[xi],(r,[t])=>Oy(t.evaluate(r),r.featureState||{})],properties:[Ba,[],r=>r.properties()],"geometry-type":[xi,[],r=>r.geometryType()],id:[li,[],r=>r.id()],zoom:[an,[],r=>r.globals.zoom],pitch:[an,[],r=>r.globals.pitch||0],"distance-from-center":[an,[],r=>r.distanceFromCenter()],"measure-light":[an,[xi],(r,[t])=>r.measureLight(t.evaluate(r))],"heatmap-density":[an,[],r=>r.globals.heatmapDensity||0],"line-progress":[an,[],r=>r.globals.lineProgress||0],"raster-value":[an,[],r=>r.globals.rasterValue||0],"sky-radial-progress":[an,[],r=>r.globals.skyRadialProgress||0],accumulated:[li,[],r=>r.globals.accumulated===void 0?null:r.globals.accumulated],"+":[an,mc(an),(r,t)=>{let o=0;for(const c of t)o+=c.evaluate(r);return o}],"*":[an,mc(an),(r,t)=>{let o=1;for(const c of t)o*=c.evaluate(r);return o}],"-":{type:an,overloads:[[[an,an],(r,[t,o])=>t.evaluate(r)-o.evaluate(r)],[[an],(r,[t])=>-t.evaluate(r)]]},"/":[an,[an,an],(r,[t,o])=>t.evaluate(r)/o.evaluate(r)],"%":[an,[an,an],(r,[t,o])=>t.evaluate(r)%o.evaluate(r)],ln2:[an,[],()=>Math.LN2],pi:[an,[],()=>Math.PI],e:[an,[],()=>Math.E],"^":[an,[an,an],(r,[t,o])=>Math.pow(t.evaluate(r),o.evaluate(r))],sqrt:[an,[an],(r,[t])=>Math.sqrt(t.evaluate(r))],log10:[an,[an],(r,[t])=>Math.log(t.evaluate(r))/Math.LN10],ln:[an,[an],(r,[t])=>Math.log(t.evaluate(r))],log2:[an,[an],(r,[t])=>Math.log(t.evaluate(r))/Math.LN2],sin:[an,[an],(r,[t])=>Math.sin(t.evaluate(r))],cos:[an,[an],(r,[t])=>Math.cos(t.evaluate(r))],tan:[an,[an],(r,[t])=>Math.tan(t.evaluate(r))],asin:[an,[an],(r,[t])=>Math.asin(t.evaluate(r))],acos:[an,[an],(r,[t])=>Math.acos(t.evaluate(r))],atan:[an,[an],(r,[t])=>Math.atan(t.evaluate(r))],min:[an,mc(an),(r,t)=>Math.min(...t.map(o=>o.evaluate(r)))],max:[an,mc(an),(r,t)=>Math.max(...t.map(o=>o.evaluate(r)))],abs:[an,[an],(r,[t])=>Math.abs(t.evaluate(r))],round:[an,[an],(r,[t])=>{const o=t.evaluate(r);return o<0?-Math.round(-o):Math.round(o)}],floor:[an,[an],(r,[t])=>Math.floor(t.evaluate(r))],ceil:[an,[an],(r,[t])=>Math.ceil(t.evaluate(r))],"filter-==":[Ci,[xi,li],(r,[t,o])=>r.properties()[t.value]===o.value],"filter-id-==":[Ci,[li],(r,[t])=>r.id()===t.value],"filter-type-==":[Ci,[xi],(r,[t])=>r.geometryType()===t.value],"filter-<":[Ci,[xi,li],(r,[t,o])=>{const c=r.properties()[t.value],u=o.value;return typeof c==typeof u&&c<u}],"filter-id-<":[Ci,[li],(r,[t])=>{const o=r.id(),c=t.value;return typeof o==typeof c&&o<c}],"filter->":[Ci,[xi,li],(r,[t,o])=>{const c=r.properties()[t.value],u=o.value;return typeof c==typeof u&&c>u}],"filter-id->":[Ci,[li],(r,[t])=>{const o=r.id(),c=t.value;return typeof o==typeof c&&o>c}],"filter-<=":[Ci,[xi,li],(r,[t,o])=>{const c=r.properties()[t.value],u=o.value;return typeof c==typeof u&&c<=u}],"filter-id-<=":[Ci,[li],(r,[t])=>{const o=r.id(),c=t.value;return typeof o==typeof c&&o<=c}],"filter->=":[Ci,[xi,li],(r,[t,o])=>{const c=r.properties()[t.value],u=o.value;return typeof c==typeof u&&c>=u}],"filter-id->=":[Ci,[li],(r,[t])=>{const o=r.id(),c=t.value;return typeof o==typeof c&&o>=c}],"filter-has":[Ci,[li],(r,[t])=>t.value in r.properties()],"filter-has-id":[Ci,[],r=>r.id()!==null&&r.id()!==void 0],"filter-type-in":[Ci,[Fr(xi)],(r,[t])=>t.value.indexOf(r.geometryType())>=0],"filter-id-in":[Ci,[Fr(li)],(r,[t])=>t.value.indexOf(r.id())>=0],"filter-in-small":[Ci,[xi,Fr(li)],(r,[t,o])=>o.value.indexOf(r.properties()[t.value])>=0],"filter-in-large":[Ci,[xi,Fr(li)],(r,[t,o])=>function(c,u,h,m){for(;h<=m;){const g=h+m>>1;if(u[g]===c)return!0;u[g]>c?m=g-1:h=g+1}return!1}(r.properties()[t.value],o.value,0,o.value.length-1)],all:{type:Ci,overloads:[[[Ci,Ci],(r,[t,o])=>t.evaluate(r)&&o.evaluate(r)],[mc(Ci),(r,t)=>{for(const o of t)if(!o.evaluate(r))return!1;return!0}]]},any:{type:Ci,overloads:[[[Ci,Ci],(r,[t,o])=>t.evaluate(r)||o.evaluate(r)],[mc(Ci),(r,t)=>{for(const o of t)if(o.evaluate(r))return!0;return!1}]]},"!":[Ci,[Ci],(r,[t])=>!t.evaluate(r)],"is-supported-script":[Ci,[xi],(r,[t])=>{const o=r.globals&&r.globals.isSupportedScript;return!o||o(t.evaluate(r))}],upcase:[xi,[xi],(r,[t])=>t.evaluate(r).toUpperCase()],downcase:[xi,[xi],(r,[t])=>t.evaluate(r).toLowerCase()],concat:[xi,mc(li),(r,t)=>t.map(o=>Pu(o.evaluate(r))).join("")],"resolved-locale":[xi,[qo],(r,[t])=>t.evaluate(r).resolvedLocale()],random:[an,[an,an,li],(r,t)=>{const[o,c,u]=t.map(m=>m.evaluate(r));if(o>c||o===c)return o;let h;if(typeof u=="string")h=function(m){let g=0;if(m.length===0)return g;for(let v=0;v<m.length;v++)g=(g<<5)-g+m.charCodeAt(v),g&=g;return g}(u);else{if(typeof u!="number")throw new Ca(`Invalid seed input: ${u}`);h=u}return o+Dy(h)()*(c-o)}]});var mf=rm;function Ny(r){return{result:"success",value:r}}function Bu(r){return{result:"error",value:r}}function gc(r,t){return!!r&&!!r.parameters&&r.parameters.indexOf(t)>-1}function Xd(r){return r["property-type"]==="data-driven"}function MS(r){return gc(r.expression,"measure-light")}function gf(r){return gc(r.expression,"zoom")}function Gc(r){return!!r.expression&&r.expression.interpolated}function Fy(r){return typeof r=="object"&&r!==null&&!Array.isArray(r)}function Mn(r){return r}function om(r,t){const o=t.type==="color",c=r.stops&&typeof r.stops[0][0]=="object",u=c||!(c||r.property!==void 0),h=r.type||(Gc(t)?"exponential":"interval");if(o&&((r=Rs({},r)).stops&&(r.stops=r.stops.map(x=>[x[0],En.parse(x[1])])),r.default=En.parse(r.default?r.default:t.default)),r.colorSpace&&r.colorSpace!=="rgb"&&!vS[r.colorSpace])throw new Error(`Unknown color space: ${r.colorSpace}`);let m,g,v;if(h==="exponential")m=Uu;else if(h==="interval")m=zC;else if(h==="categorical"){m=TS,g=Object.create(null);for(const x of r.stops)g[x[0]]=x[1];v=typeof r.stops[0][0]}else{if(h!=="identity")throw new Error(`Unknown function type "${h}"`);m=sm}if(c){const x={},w=[];for(let I=0;I<r.stops.length;I++){const D=r.stops[I],N=D[0].zoom;x[N]===void 0&&(x[N]={zoom:N,type:r.type,property:r.property,default:r.default,stops:[]},w.push(N)),x[N].stops.push([D[0].value,D[1]])}const E=[];for(const I of w)E.push([x[I].zoom,om(x[I],t)]);const C={name:"linear"};return{kind:"composite",interpolationType:C,interpolationFactor:fc.interpolationFactor.bind(void 0,C),zoomStops:E.map(I=>I[0]),evaluate:({zoom:I},D)=>Uu({stops:E,base:r.base},t,I).evaluate(I,D)}}if(u){const x=h==="exponential"?{name:"exponential",base:r.base!==void 0?r.base:1}:null;return{kind:"camera",interpolationType:x,interpolationFactor:fc.interpolationFactor.bind(void 0,x),zoomStops:r.stops.map(w=>w[0]),evaluate:({zoom:w})=>m(r,t,w,g,v)}}return{kind:"source",evaluate(x,w){const E=w&&w.properties?w.properties[r.property]:void 0;return E===void 0?Zd(r.default,t.default):m(r,t,E,g,v)}}}function Zd(r,t,o){return r!==void 0?r:t!==void 0?t:o!==void 0?o:void 0}function TS(r,t,o,c,u){return Zd(typeof o===u?c[o]:void 0,r.default,t.default)}function zC(r,t,o){if(Ni(o)!=="number")return Zd(r.default,t.default);const c=r.stops.length;if(c===1||o<=r.stops[0][0])return r.stops[0][1];if(o>=r.stops[c-1][0])return r.stops[c-1][1];const u=Kp(r.stops.map(h=>h[0]),o);return r.stops[u][1]}function Uu(r,t,o){const c=r.base!==void 0?r.base:1;if(Ni(o)!=="number")return Zd(r.default,t.default);const u=r.stops.length;if(u===1||o<=r.stops[0][0])return r.stops[0][1];if(o>=r.stops[u-1][0])return r.stops[u-1][1];const h=Kp(r.stops.map(w=>w[0]),o),m=function(w,E,C,I){const D=I-C,N=w-C;return D===0?0:E===1?N/D:(Math.pow(E,N)-1)/(Math.pow(E,D)-1)}(o,c,r.stops[h][0],r.stops[h+1][0]),g=r.stops[h][1],v=r.stops[h+1][1];let x=Jp[t.type]||Mn;if(r.colorSpace&&r.colorSpace!=="rgb"){const w=vS[r.colorSpace];x=(E,C)=>w.reverse(w.interpolate(w.forward(E),w.forward(C),m))}return typeof g.evaluate=="function"?{evaluate(...w){const E=g.evaluate.apply(void 0,w),C=v.evaluate.apply(void 0,w);if(E!==void 0&&C!==void 0)return x(E,C,m)}}:x(g,v,m)}function sm(r,t,o){return t.type==="color"?o=En.parse(o):t.type==="formatted"?o=Aa.fromString(o.toString()):t.type==="resolvedImage"?o=as.fromString(o.toString()):Ni(o)===t.type||t.type==="enum"&&t.values[o]||(o=void 0),Zd(o,r.default,t.default)}class lm{constructor(t,o,c){this.expression=t,this._warningHistory={},this._evaluator=new jp(c),this._defaultValue=o?function(u){return u.type==="color"&&(Fy(u.default)||Array.isArray(u.default))?new En(0,0,0,0):u.type==="color"?En.parse(u.default)||null:u.default===void 0?null:u.default}(o):null,this._enumValues=o&&o.type==="enum"?o.values:null}evaluateWithoutErrorHandling(t,o,c,u,h,m,g,v){return this._evaluator.globals=t,this._evaluator.feature=o,this._evaluator.featureState=c,this._evaluator.canonical=u||null,this._evaluator.availableImages=h||null,this._evaluator.formattedSection=m,this._evaluator.featureTileCoord=g||null,this._evaluator.featureDistanceData=v||null,this.expression.evaluate(this._evaluator)}evaluate(t,o,c,u,h,m,g,v){this._evaluator.globals=t,this._evaluator.feature=o||null,this._evaluator.featureState=c||null,this._evaluator.canonical=u||null,this._evaluator.availableImages=h||null,this._evaluator.formattedSection=m||null,this._evaluator.featureTileCoord=g||null,this._evaluator.featureDistanceData=v||null;try{const x=this.expression.evaluate(this._evaluator);if(x==null||typeof x=="number"&&x!=x)return this._defaultValue;if(this._enumValues&&!(x in this._enumValues))throw new Ca(`Expected value to be one of ${Object.keys(this._enumValues).map(w=>JSON.stringify(w)).join(", ")}, but found ${JSON.stringify(x)} instead.`);return x}catch(x){return this._warningHistory[x.message]||(this._warningHistory[x.message]=!0,typeof console<"u"&&console.warn(x.message)),this._defaultValue}}}function cm(r){return Array.isArray(r)&&r.length>0&&typeof r[0]=="string"&&r[0]in mf}function Hc(r,t,o){const c=new Sy(mf,[],t?function(h){const m={color:na,string:xi,number:an,enum:xi,boolean:Ci,formatted:Bc,resolvedImage:Uc};return h.type==="array"?Fr(m[h.value]||li,h.length):m[h.type]}(t):void 0,void 0,void 0,o),u=c.parse(r,void 0,void 0,void 0,t&&t.type==="string"?{typeAnnotation:"coerce"}:void 0);return u?Ny(new lm(u,t,o)):Bu(c.errors)}class By{constructor(t,o,c){this.kind=t,this._styleExpression=o,this.isLightConstant=c,this.isStateDependent=t!=="constant"&&!Zp(o.expression),this.isConfigDependent=!xy(o.expression)}evaluateWithoutErrorHandling(t,o,c,u,h,m){return this._styleExpression.evaluateWithoutErrorHandling(t,o,c,u,h,m)}evaluate(t,o,c,u,h,m){return this._styleExpression.evaluate(t,o,c,u,h,m)}}class jc{constructor(t,o,c,u,h){this.kind=t,this.zoomStops=c,this._styleExpression=o,this.isStateDependent=t!=="camera"&&!Zp(o.expression),this.isLightConstant=h,this.isConfigDependent=!xy(o.expression),this.interpolationType=u}evaluateWithoutErrorHandling(t,o,c,u,h,m){return this._styleExpression.evaluateWithoutErrorHandling(t,o,c,u,h,m)}evaluate(t,o,c,u,h,m){return this._styleExpression.evaluate(t,o,c,u,h,m)}interpolationFactor(t,o,c){return this.interpolationType?fc.interpolationFactor(this.interpolationType,t,o,c):0}}function Uy(r,t,o){if((r=Hc(r,t,o)).result==="error")return r;const c=r.value.expression,u=Ou(c);if(!u&&!Xd(t))return Bu([new Ls("","data expressions not supported")]);const h=jd(c,["zoom","pitch","distance-from-center"]);if(!h&&!gf(t))return Bu([new Ls("","zoom expressions not supported")]);const m=jd(c,["measure-light"]);if(!m&&!MS(t))return Bu([new Ls("","measure-light expression not supported")]);const g=t.expression&&t.expression.relaxZoomRestriction,v=yf(c);return v||h||g?v instanceof Ls?Bu([v]):v instanceof fc&&!Gc(t)?Bu([new Ls("",'"interpolate" expressions cannot be used with this property')]):Ny(v?new jc(u?"camera":"composite",r.value,v.labels,v instanceof fc?v.interpolation:void 0,m):new By(u?"constant":"source",r.value,m)):Bu([new Ls("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression, or in the properties of atmosphere.')])}class um{constructor(t,o){this._parameters=t,this._specification=o,Rs(this,om(this._parameters,this._specification))}static deserialize(t){return new um(t._parameters,t._specification)}static serialize(t){return{_parameters:t._parameters,_specification:t._specification}}}function yf(r){let t=null;if(r instanceof J_)t=yf(r.result);else if(r instanceof K_){for(const o of r.args)if(t=yf(o),t)break}else(r instanceof df||r instanceof fc)&&r.input instanceof Pa&&r.input.name==="zoom"&&(t=r);return t instanceof Ls||r.eachChild(o=>{const c=yf(o);c instanceof Ls?t=c:t&&c&&t!==c&&(t=new Ls("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),t}function cs(r){const t=r.key,o=r.value,c=r.valueSpec||{},u=r.objectElementValidators||{},h=r.style,m=r.styleSpec;let g=[];const v=Ni(o);if(v!=="object")return[new cn(t,o,`object expected, ${v} found`)];for(const x in o){const w=x.split(".")[0];let E;u[w]?E=u[w]:c[w]?E=la:u["*"]?E=u["*"]:c["*"]&&(E=la),E?g=g.concat(E({key:(t&&`${t}.`)+x,value:o[x],valueSpec:c[w]||c["*"],style:h,styleSpec:m,object:o,objectKey:x},o)):g.push(new Qs(t,o[x],`unknown property "${x}"`))}for(const x in c)u[x]||c[x].required&&c[x].default===void 0&&o[x]===void 0&&g.push(new cn(t,o,`missing required property "${x}"`));return g}function n1(r){const t=r.value,o=r.valueSpec,c=r.style,u=r.styleSpec,h=r.key,m=r.arrayElementValidator||la;if(Ni(t)!=="array")return[new cn(h,t,`array expected, ${Ni(t)} found`)];if(o.length&&t.length!==o.length)return[new cn(h,t,`array length ${o.length} expected, length ${t.length} found`)];if(o["min-length"]&&t.length<o["min-length"])return[new cn(h,t,`array length at least ${o["min-length"]} expected, length ${t.length} found`)];let g={type:o.value,values:o.values,minimum:o.minimum,maximum:o.maximum,function:void 0};u.$version<7&&(g.function=o.function),Ni(o.value)==="object"&&(g=o.value);let v=[];for(let x=0;x<t.length;x++)v=v.concat(m({array:t,arrayIndex:x,value:t[x],valueSpec:g,style:c,styleSpec:u,key:`${h}[${x}]`},!0));return v}function Wy(r){const t=r.key,o=r.value,c=r.valueSpec;let u=Ni(o);if(u==="number"&&o!=o&&(u="NaN"),u!=="number")return[new cn(t,o,`number expected, ${u} found`)];if("minimum"in c){let h=c.minimum;if(Ni(c.minimum)==="array"&&(h=c.minimum[r.arrayIndex]),o<h)return[new cn(t,o,`${o} is less than the minimum value ${h}`)]}if("maximum"in c){let h=c.maximum;if(Ni(c.maximum)==="array"&&(h=c.maximum[r.arrayIndex]),o>h)return[new cn(t,o,`${o} is greater than the maximum value ${h}`)]}return[]}function dm(r){const t=r.valueSpec,o=$r(r.value.type);let c,u,h,m={};const g=o!=="categorical"&&r.value.property===void 0,v=!g,x=Ni(r.value.stops)==="array"&&Ni(r.value.stops[0])==="array"&&Ni(r.value.stops[0][0])==="object",w=cs({key:r.key,value:r.value,valueSpec:r.styleSpec.function,style:r.style,styleSpec:r.styleSpec,objectElementValidators:{stops:function(I){if(o==="identity")return[new cn(I.key,I.value,'identity function may not have a "stops" property')];let D=[];const N=I.value;return D=D.concat(n1({key:I.key,value:N,valueSpec:I.valueSpec,style:I.style,styleSpec:I.styleSpec,arrayElementValidator:E})),Ni(N)==="array"&&N.length===0&&D.push(new cn(I.key,N,"array must have at least one stop")),D},default:function(I){return la({key:I.key,value:I.value,valueSpec:t,style:I.style,styleSpec:I.styleSpec})}}});return o==="identity"&&g&&w.push(new cn(r.key,r.value,'missing required property "property"')),o==="identity"||r.value.stops||w.push(new cn(r.key,r.value,'missing required property "stops"')),o==="exponential"&&r.valueSpec.expression&&!Gc(r.valueSpec)&&w.push(new cn(r.key,r.value,"exponential functions not supported")),r.styleSpec.$version>=8&&(v&&!Xd(r.valueSpec)?w.push(new cn(r.key,r.value,"property functions not supported")):g&&!gf(r.valueSpec)&&w.push(new cn(r.key,r.value,"zoom functions not supported"))),o!=="categorical"&&!x||r.value.property!==void 0||w.push(new cn(r.key,r.value,'"property" property is required')),w;function E(I){let D=[];const N=I.value,W=I.key;if(Ni(N)!=="array")return[new cn(W,N,`array expected, ${Ni(N)} found`)];if(N.length!==2)return[new cn(W,N,`array length 2 expected, length ${N.length} found`)];if(x){if(Ni(N[0])!=="object")return[new cn(W,N,`object expected, ${Ni(N[0])} found`)];if(N[0].zoom===void 0)return[new cn(W,N,"object stop key must have zoom")];if(N[0].value===void 0)return[new cn(W,N,"object stop key must have value")];const V=$r(N[0].zoom);if(typeof V!="number")return[new cn(W,N[0].zoom,"stop zoom values must be numbers")];if(h&&h>V)return[new cn(W,N[0].zoom,"stop zoom values must appear in ascending order")];V!==h&&(h=V,u=void 0,m={}),D=D.concat(cs({key:`${W}[0]`,value:N[0],valueSpec:{zoom:{}},style:I.style,styleSpec:I.styleSpec,objectElementValidators:{zoom:Wy,value:C}}))}else D=D.concat(C({key:`${W}[0]`,value:N[0],valueSpec:{},style:I.style,styleSpec:I.styleSpec},N));return cm(ur(N[1]))?D.concat([new cn(`${W}[1]`,N[1],"expressions are not allowed in function stops.")]):D.concat(la({key:`${W}[1]`,value:N[1],valueSpec:t,style:I.style,styleSpec:I.styleSpec}))}function C(I,D){const N=Ni(I.value),W=$r(I.value),V=I.value!==null?I.value:D;if(c){if(N!==c)return[new cn(I.key,V,`${N} stop domain type must match previous stop domain type ${c}`)]}else c=N;if(N!=="number"&&N!=="string"&&N!=="boolean"&&typeof W!="number"&&typeof W!="string"&&typeof W!="boolean")return[new cn(I.key,V,"stop domain value must be a number, string, or boolean")];if(N!=="number"&&o!=="categorical"){let q=`number expected, ${N} found`;return Xd(t)&&o===void 0&&(q+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new cn(I.key,V,q)]}return o!=="categorical"||N!=="number"||typeof W=="number"&&isFinite(W)&&Math.floor(W)===W?o!=="categorical"&&N==="number"&&typeof W=="number"&&typeof u=="number"&&u!==void 0&&W<u?[new cn(I.key,V,"stop domain values must appear in ascending order")]:(u=W,o==="categorical"&&W in m?[new cn(I.key,V,"stop domain values must be unique")]:(m[W]=!0,[])):[new cn(I.key,V,`integer expected, found ${String(W)}`)]}}function Kd(r){const t=(r.expressionContext==="property"?Uy:Hc)(ur(r.value),r.valueSpec);if(t.result==="error")return t.value.map(c=>new cn(`${r.key}${c.key}`,r.value,c.message));const o=t.value.expression||t.value._styleExpression.expression;if(r.expressionContext==="property"&&r.propertyKey==="text-font"&&!o.outputDefined())return[new cn(r.key,r.value,`Invalid data expression for "${r.propertyKey}". Output values must be contained as literals within the expression.`)];if(r.expressionContext==="property"&&r.propertyType==="layout"&&!Zp(o))return[new cn(r.key,r.value,'"feature-state" data expressions are not supported with layout properties.')];if(r.expressionContext==="filter")return AS(o,r);if(r.expressionContext&&r.expressionContext.indexOf("cluster")===0){if(!jd(o,["zoom","feature-state"]))return[new cn(r.key,r.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(r.expressionContext==="cluster-initial"&&!Ou(o))return[new cn(r.key,r.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function AS(r,t){const o=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(t.valueSpec&&t.valueSpec.expression)for(const u of t.valueSpec.expression.parameters)o.delete(u);if(o.size===0)return[];const c=[];return r instanceof Pa&&o.has(r.name)?[new cn(t.key,t.value,`["${r.name}"] expression is not supported in a filter for a ${t.object.type} layer with id: ${t.object.id}`)]:(r.eachChild(u=>{c.push(...AS(u,t))}),c)}function hm(r){const t=r.key,o=r.value,c=r.valueSpec,u=[];return Array.isArray(c.values)?c.values.indexOf($r(o))===-1&&u.push(new cn(t,o,`expected one of [${c.values.join(", ")}], ${JSON.stringify(o)} found`)):Object.keys(c.values).indexOf($r(o))===-1&&u.push(new cn(t,o,`expected one of [${Object.keys(c.values).join(", ")}], ${JSON.stringify(o)} found`)),u}function Vy(r){if(r===!0||r===!1)return!0;if(!Array.isArray(r)||r.length===0)return!1;switch(r[0]){case"has":return r.length>=2&&r[1]!=="$id"&&r[1]!=="$type";case"in":return r.length>=3&&(typeof r[1]!="string"||Array.isArray(r[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return r.length!==3||Array.isArray(r[1])||Array.isArray(r[2]);case"any":case"all":for(const t of r.slice(1))if(!Vy(t)&&typeof t!="boolean")return!1;return!0;default:return!0}}function fm(r,t="fill"){if(r==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};Vy(r)||(r=Wu(r));const o=r;let c=!0;try{c=function(x){if(!$c(x))return x;let w=ur(x);return pm(w),w=i1(w),w}(o)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(o,null,2)}
        `)}const u=rt[`filter_${t}`],h=Hc(c,u);let m=null;if(h.result==="error")throw new Error(h.value.map(x=>`${x.key}: ${x.message}`).join(", "));m=(x,w,E)=>h.value.evaluate(x,w,{},E);let g=null,v=null;if(c!==o){const x=Hc(o,u);if(x.result==="error")throw new Error(x.value.map(w=>`${w.key}: ${w.message}`).join(", "));g=(w,E,C,I,D)=>x.value.evaluate(w,E,{},C,void 0,void 0,I,D),v=!Ou(x.value.expression)}return{filter:m,dynamicFilter:g||void 0,needGeometry:mm(c),needFeature:!!v}}function i1(r){if(!Array.isArray(r))return r;const t=function(o){if(Gy.has(o[0])){for(let c=1;c<o.length;c++)if($c(o[c]))return!0}return o}(r);return t===!0?t:t.map(o=>i1(o))}function pm(r){let t=!1;const o=[];if(r[0]==="case"){for(let c=1;c<r.length-1;c+=2)t=t||$c(r[c]),o.push(r[c+1]);o.push(r[r.length-1])}else if(r[0]==="match"){t=t||$c(r[1]);for(let c=2;c<r.length-1;c+=2)o.push(r[c+1]);o.push(r[r.length-1])}else if(r[0]==="step"){t=t||$c(r[1]);for(let c=1;c<r.length-1;c+=2)o.push(r[c+1])}t&&(r.length=0,r.push("any",...o));for(let c=1;c<r.length;c++)pm(r[c])}function $c(r){if(!Array.isArray(r))return!1;if((t=r[0])==="pitch"||t==="distance-from-center")return!0;var t;for(let o=1;o<r.length;o++)if($c(r[o]))return!0;return!1}const Gy=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function Hy(r,t){return r<t?-1:r>t?1:0}function mm(r){if(!Array.isArray(r))return!1;if(r[0]==="within"||r[0]==="distance")return!0;for(let t=1;t<r.length;t++)if(mm(r[t]))return!0;return!1}function Wu(r){if(!r)return!0;const t=r[0];return r.length<=1?t!=="any":t==="=="?gm(r[1],r[2],"=="):t==="!="?ym(gm(r[1],r[2],"==")):t==="<"||t===">"||t==="<="||t===">="?gm(r[1],r[2],t):t==="any"?(o=r.slice(1),["any"].concat(o.map(Wu))):t==="all"?["all"].concat(r.slice(1).map(Wu)):t==="none"?["all"].concat(r.slice(1).map(Wu).map(ym)):t==="in"?jy(r[1],r.slice(2)):t==="!in"?ym(jy(r[1],r.slice(2))):t==="has"?$y(r[1]):t!=="!has"||ym($y(r[1]));var o}function gm(r,t,o){switch(r){case"$type":return[`filter-type-${o}`,t];case"$id":return[`filter-id-${o}`,t];default:return[`filter-${o}`,r,t]}}function jy(r,t){if(t.length===0)return!1;switch(r){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some(o=>typeof o!=typeof t[0])?["filter-in-large",r,["literal",t.sort(Hy)]]:["filter-in-small",r,["literal",t]]}}function $y(r){switch(r){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",r]}}function ym(r){return["!",r]}function vm(r){return Vy(ur(r.value))?Kd(Rs({},r,{expressionContext:"filter",valueSpec:r.styleSpec[`filter_${r.layerType||"fill"}`]})):CS(r)}function CS(r){const t=r.value,o=r.key;if(Ni(t)!=="array")return[new cn(o,t,`array expected, ${Ni(t)} found`)];const c=r.styleSpec;let u,h=[];if(t.length<1)return[new cn(o,t,"filter array must have at least 1 element")];switch(h=h.concat(hm({key:`${o}[0]`,value:t[0],valueSpec:c.filter_operator,style:r.style,styleSpec:r.styleSpec})),$r(t[0])){case"<":case"<=":case">":case">=":t.length>=2&&$r(t[1])==="$type"&&h.push(new cn(o,t,`"$type" cannot be use with operator "${t[0]}"`));case"==":case"!=":t.length!==3&&h.push(new cn(o,t,`filter array for operator "${t[0]}" must have 3 elements`));case"in":case"!in":t.length>=2&&(u=Ni(t[1]),u!=="string"&&h.push(new cn(`${o}[1]`,t[1],`string expected, ${u} found`)));for(let m=2;m<t.length;m++)u=Ni(t[m]),$r(t[1])==="$type"?h=h.concat(hm({key:`${o}[${m}]`,value:t[m],valueSpec:c.geometry_type,style:r.style,styleSpec:r.styleSpec})):u!=="string"&&u!=="number"&&u!=="boolean"&&h.push(new cn(`${o}[${m}]`,t[m],`string, number, or boolean expected, ${u} found`));break;case"any":case"all":case"none":for(let m=1;m<t.length;m++)h=h.concat(CS({key:`${o}[${m}]`,value:t[m],style:r.style,styleSpec:r.styleSpec}));break;case"has":case"!has":u=Ni(t[1]),t.length!==2?h.push(new cn(o,t,`filter array for "${t[0]}" operator must have 2 elements`)):u!=="string"&&h.push(new cn(`${o}[1]`,t[1],`string expected, ${u} found`))}return h}function _m(r,t){const o=r.key,c=r.style,u=r.layer,h=r.styleSpec,m=r.value,g=r.objectKey,v=h[`${t}_${r.layerType}`];if(!v)return[];const x=g.match(/^(.*)-transition$/);if(t==="paint"&&x&&v[x[1]]&&v[x[1]].transition)return la({key:o,value:m,valueSpec:h.transition,style:c,styleSpec:h});const w=r.valueSpec||v[g];if(!w)return[new Qs(o,m,`unknown property "${g}"`)];let E;if(Ni(m)==="string"&&Xd(w)&&!w.tokens&&(E=/^{([^}]+)}$/.exec(m))){const I=`\`{ "type": "identity", "property": ${E?JSON.stringify(E[1]):'"_"'} }\``;return[new cn(o,m,`"${g}" does not support interpolation syntax
Use an identity property function instead: ${I}.`)]}const C=[];if(r.layerType==="symbol")g!=="text-field"||!c||c.glyphs||c.imports||C.push(new cn(o,m,'use of "text-field" requires a style "glyphs" property')),g==="text-font"&&Fy(ur(m))&&$r(m.type)==="identity"&&C.push(new cn(o,m,'"text-font" does not support identity functions'));else if(r.layerType==="model"&&t==="paint"&&u&&u.layout&&u.layout.hasOwnProperty("model-id")&&Xd(w)&&(MS(w)||gf(w))){const I=Uy(ur(m),w),D=I.value.expression||I.value._styleExpression.expression;D&&!jd(D,["measure-light"])&&C.push(new cn(o,m,`${g} does not support measure-light expressions when the model layer source is vector tile or GeoJSON.`))}return C.concat(la({key:r.key,value:m,valueSpec:w,style:c,styleSpec:h,expressionContext:"property",propertyType:t,propertyKey:g}))}function Yy(r){return _m(r,"paint")}function ya(r){return _m(r,"layout")}function Fi(r){let t=[];const o=r.value,c=r.key,u=r.style,h=r.styleSpec;o.type||o.ref||t.push(new cn(c,o,'either "type" or "ref" is required'));let m=$r(o.type);const g=$r(o.ref);if(o.id){const v=$r(o.id);for(let x=0;x<r.arrayIndex;x++){const w=u.layers[x];$r(w.id)===v&&t.push(new cn(c,o.id,`duplicate layer id "${o.id}", previously used at line ${w.id.__line__}`))}}if("ref"in o){let v;["type","source","source-layer","filter","layout"].forEach(x=>{x in o&&t.push(new cn(c,o[x],`"${x}" is prohibited for ref layers`))}),u.layers.forEach(x=>{$r(x.id)===g&&(v=x)}),v?v.ref?t.push(new cn(c,o.ref,"ref cannot reference another ref layer")):m=$r(v.type):typeof g=="string"&&t.push(new cn(c,o.ref,`ref layer "${g}" not found`))}else if(m!=="background"&&m!=="sky"&&m!=="slot")if(o.source){const v=u.sources&&u.sources[o.source],x=v&&$r(v.type);v?x==="vector"&&m==="raster"?t.push(new cn(c,o.source,`layer "${o.id}" requires a raster source`)):x==="raster"&&m!=="raster"?t.push(new cn(c,o.source,`layer "${o.id}" requires a vector source`)):x!=="vector"||o["source-layer"]?x==="raster-dem"&&m!=="hillshade"?t.push(new cn(c,o.source,"raster-dem source can only be used with layer type 'hillshade'.")):m!=="line"||!o.paint||!o.paint["line-gradient"]&&!o.paint["line-trim-offset"]||x==="geojson"&&v.lineMetrics||t.push(new cn(c,o,`layer "${o.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):t.push(new cn(c,o,`layer "${o.id}" must specify a "source-layer"`)):t.push(new cn(c,o.source,`source "${o.source}" not found`))}else t.push(new cn(c,o,'missing required property "source"'));return t=t.concat(cs({key:c,value:o,valueSpec:h.layer,style:r.style,styleSpec:r.styleSpec,objectElementValidators:{"*":()=>[],type:()=>la({key:`${c}.type`,value:o.type,valueSpec:h.layer.type,style:r.style,styleSpec:r.styleSpec,object:o,objectKey:"type"}),filter:v=>vm(Rs({layerType:m},v)),layout:v=>cs({layer:o,key:v.key,value:v.value,valueSpec:{},style:v.style,styleSpec:v.styleSpec,objectElementValidators:{"*":x=>ya(Rs({layerType:m},x))}}),paint:v=>cs({layer:o,key:v.key,value:v.value,valueSpec:{},style:v.style,styleSpec:v.styleSpec,objectElementValidators:{"*":x=>Yy(Rs({layerType:m,layer:o},x))}})}})),t}function Xr(r){const t=r.value,o=r.key,c=Ni(t);return c!=="string"?[new cn(o,t,`string expected, ${c} found`)]:[]}const Ia={promoteId:function({key:r,value:t}){if(Ni(t)==="string")return Xr({key:r,value:t});{const o=[];for(const c in t)o.push(...Xr({key:`${r}.${c}`,value:t[c]}));return o}}};function go(r){const t=r.value,o=r.key,c=r.styleSpec,u=r.style;if(!t.type)return[new cn(o,t,'"type" is required')];const h=$r(t.type);let m;switch(h){case"vector":case"raster":case"raster-dem":return m=cs({key:o,value:t,valueSpec:c[`source_${h.replace("-","_")}`],style:r.style,styleSpec:c,objectElementValidators:Ia}),m;case"geojson":if(m=cs({key:o,value:t,valueSpec:c.source_geojson,style:u,styleSpec:c,objectElementValidators:Ia}),t.cluster)for(const g in t.clusterProperties){const[v,x]=t.clusterProperties[g],w=typeof v=="string"?[v,["accumulated"],["get",g]]:v;m.push(...Kd({key:`${o}.${g}.map`,value:x,expressionContext:"cluster-map"})),m.push(...Kd({key:`${o}.${g}.reduce`,value:w,expressionContext:"cluster-reduce"}))}return m;case"video":return cs({key:o,value:t,valueSpec:c.source_video,style:u,styleSpec:c});case"image":return cs({key:o,value:t,valueSpec:c.source_image,style:u,styleSpec:c});case"canvas":return[new cn(o,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return hm({key:`${o}.type`,value:t.type,valueSpec:{values:Ds(c)},style:u,styleSpec:c})}}function Ds(r){return r.source.reduce((t,o)=>{const c=r[o];return c.type.type==="enum"&&(t=t.concat(Object.keys(c.type.values))),t},[])}function Jd(r){const t=r.value;let o=[];if(!t)return o;const c=Ni(t);return c!=="string"?(o=o.concat([new cn(r.key,t,`string expected, "${c}" found`)]),o):(function(u){const h=u.indexOf("://")===-1;try{return new URL(u,h?"http://example.com":void 0),!0}catch{return!1}}(t)||(o=o.concat([new cn(r.key,t,`invalid url "${t}"`)])),o)}function Wa(r){const t=r.value,o=r.styleSpec,c=o.light,u=r.style;let h=[];const m=Ni(t);if(t===void 0)return h;if(m!=="object")return h=h.concat([new cn("light",t,`object expected, ${m} found`)]),h;for(const g in t){const v=g.match(/^(.*)-transition$/);h=h.concat(v&&c[v[1]]&&c[v[1]].transition?la({key:g,value:t[g],valueSpec:o.transition,style:u,styleSpec:o}):c[g]?la({key:g,value:t[g],valueSpec:c[g],style:u,styleSpec:o}):[new cn(g,t[g],`unknown property "${g}"`)])}return h}function vf(r){const t=r.value;let o=[];if(!t)return o;const c=Ni(t);if(c!=="object")return o=o.concat([new cn("light-3d",t,`object expected, ${c} found`)]),o;const u=r.styleSpec,h=u["light-3d"],m=r.key,g=r.style,v=r.style.lights;for(const E of["type","id"])if(!(E in t))return o=o.concat([new cn("light-3d",t,`missing property ${E} on light`)]),o;if(t.type&&v)for(let E=0;E<r.arrayIndex;E++){const C=$r(t.type),I=v[E];$r(I.type)===C&&o.push(new cn(m,t.id,`duplicate light type "${t.type}", previously defined at line ${I.id.__line__}`))}const x=`properties_light_${t.type}`;if(!(x in u))return o=o.concat([new cn("light-3d",t,`Invalid light type ${t.type}`)]),o;const w=u[x];for(const E in t)if(E==="properties"){const C=t[E],I=Ni(C);if(I!=="object")return o=o.concat([new cn("properties",C,`object expected, ${I} found`)]),o;for(const D in C)o=o.concat(w[D]?la({key:D,value:C[D],valueSpec:w[D],style:g,styleSpec:u}):[new Qs(r.key,C[D],`unknown property "${D}"`)])}else{const C=E.match(/^(.*)-transition$/);o=o.concat(C&&h[C[1]]&&h[C[1]].transition?la({key:E,value:t[E],valueSpec:u.transition,style:g,styleSpec:u}):h[E]?la({key:E,value:t[E],valueSpec:h[E],style:g,styleSpec:u}):[new Qs(E,t[E],`unknown property "${E}"`)])}return o}function Qd(r){const t=r.value,o=r.key,c=r.style,u=r.styleSpec,h=u.terrain;let m=[];const g=Ni(t);if(t===void 0)return m;if(g!=="object")return m=m.concat([new cn("terrain",t,`object expected, ${g} found`)]),m;for(const v in t){const x=v.match(/^(.*)-transition$/);m=m.concat(x&&h[x[1]]&&h[x[1]].transition?la({key:v,value:t[v],valueSpec:u.transition,style:c,styleSpec:u}):h[v]?la({key:v,value:t[v],valueSpec:h[v],style:c,styleSpec:u}):[new Qs(v,t[v],`unknown property "${v}"`)])}if(t.source){const v=c.sources&&c.sources[t.source],x=v&&$r(v.type);v?x!=="raster-dem"&&m.push(new cn(o,t.source,`terrain cannot be used with a source of type ${String(x)}, it only be used with a "raster-dem" source type`)):m.push(new cn(o,t.source,`source "${t.source}" not found`))}else m.push(new cn(o,t,'terrain is missing required property "source"'));return m}function xm(r){const t=r.value,o=r.style,c=r.styleSpec,u=c.fog;let h=[];const m=Ni(t);if(t===void 0)return h;if(m!=="object")return h=h.concat([new cn("fog",t,`object expected, ${m} found`)]),h;for(const g in t){const v=g.match(/^(.*)-transition$/);h=h.concat(v&&u[v[1]]&&u[v[1]].transition?la({key:g,value:t[g],valueSpec:c.transition,style:o,styleSpec:c}):u[g]?la({key:g,value:t[g],valueSpec:u[g],style:o,styleSpec:c}):[new Qs(g,t[g],`unknown property "${g}"`)])}return h}const qy={"*":()=>[],array:n1,boolean:function(r){const t=r.value,o=r.key,c=Ni(t);return c!=="boolean"?[new cn(o,t,`boolean expected, ${c} found`)]:[]},number:Wy,color:function(r){const t=r.key,o=r.value,c=Ni(o);return c!=="string"?[new cn(t,o,`color expected, ${c} found`)]:Au(o)===null?[new cn(t,o,`color expected, "${o}" found`)]:[]},enum:hm,filter:vm,function:dm,layer:Fi,object:cs,source:go,model:Jd,light:Wa,"light-3d":vf,terrain:Qd,fog:xm,string:Xr,formatted:function(r){return Xr(r).length===0?[]:Kd(r)},resolvedImage:function(r){return Xr(r).length===0?[]:Kd(r)},projection:function(r){const t=r.value,o=r.styleSpec,c=o.projection,u=r.style;let h=[];const m=Ni(t);if(m==="object")for(const g in t)h=h.concat(la({key:g,value:t[g],valueSpec:c[g],style:u,styleSpec:o}));else m!=="string"&&(h=h.concat([new cn("projection",t,`object or string expected, ${m} found`)]));return h},import:function(r){const{value:t,styleSpec:o}=r,{data:c,...u}=t;Object.defineProperty(u,"__line__",{value:t.__line__,enumerable:!1});let h=cs(Rs({},r,{value:u,valueSpec:o.import}));return $r(u.id)===""&&h.push(new cn(`${r.key}.id`,u,"import id can't be an empty string")),c&&(h=h.concat(Xy(c,o,{key:`${r.key}.data`}))),h}};function la(r,t=!1){const o=r.value,c=r.valueSpec,u=r.styleSpec;if(c.expression&&Fy($r(o)))return dm(r);if(c.expression&&cm(ur(o)))return Kd(r);if(c.type&&qy[c.type]){const h=qy[c.type](r);return t===!0&&h.length>0&&Ni(r.value)==="array"?Kd(r):h}return cs(Rs({},r,{valueSpec:c.type?u[c.type]:c}))}function us(r){const t=r.value,o=r.key,c=Xr(r);return c.length||(t.indexOf("{fontstack}")===-1&&c.push(new cn(o,t,'"glyphs" url must include a "{fontstack}" token')),t.indexOf("{range}")===-1&&c.push(new cn(o,t,'"glyphs" url must include a "{range}" token'))),c}function Xy(r,t=rt,o={}){return la({key:o.key||"",value:r,valueSpec:t.$root,styleSpec:t,style:r,objectElementValidators:{glyphs:us,"*":()=>[]}})}function Vu(r,t=rt){return ds(Xy(r,t))}const _f=r=>ds(go(r)),Zy=r=>ds(Wa(r)),r1=r=>ds(vf(r)),Gu=r=>ds(Qd(r)),Ky=r=>ds(xm(r)),Hu=r=>ds(Fi(r)),xf=r=>ds(vm(r)),bm=r=>ds(Yy(r)),a1=r=>ds(ya(r)),Jy=r=>ds(Jd(r));function ds(r){return r.slice().sort((t,o)=>t.line&&o.line?t.line-o.line:0)}function yo(r,t){let o=!1;if(t&&t.length)for(const c of t)c instanceof Qs?xe(c.message):(r.fire(new bn(new Error(c.message))),o=!0);return o}var ju=zs,eo=3;function zs(r,t,o){var c=this.cells=[];if(r instanceof ArrayBuffer){this.arrayBuffer=r;var u=new Int32Array(this.arrayBuffer);r=u[0],this.d=(t=u[1])+2*(o=u[2]);for(var h=0;h<this.d*this.d;h++){var m=u[eo+h],g=u[eo+h+1];c.push(m===g?null:u.subarray(m,g))}var v=u[eo+c.length+1];this.keys=u.subarray(u[eo+c.length],v),this.bboxes=u.subarray(v),this.insert=this._insertReadonly}else{this.d=t+2*o;for(var x=0;x<this.d*this.d;x++)c.push([]);this.keys=[],this.bboxes=[]}this.n=t,this.extent=r,this.padding=o,this.scale=t/r,this.uid=0;var w=o/t*r;this.min=-w,this.max=r+w}zs.prototype.insert=function(r,t,o,c,u){this._forEachCell(t,o,c,u,this._insertCell,this.uid++),this.keys.push(r),this.bboxes.push(t),this.bboxes.push(o),this.bboxes.push(c),this.bboxes.push(u)},zs.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},zs.prototype._insertCell=function(r,t,o,c,u,h){this.cells[u].push(h)},zs.prototype.query=function(r,t,o,c,u){var h=this.min,m=this.max;if(r<=h&&t<=h&&m<=o&&m<=c&&!u)return Array.prototype.slice.call(this.keys);var g=[];return this._forEachCell(r,t,o,c,this._queryCell,g,{},u),g},zs.prototype._queryCell=function(r,t,o,c,u,h,m,g){var v=this.cells[u];if(v!==null)for(var x=this.keys,w=this.bboxes,E=0;E<v.length;E++){var C=v[E];if(m[C]===void 0){var I=4*C;(g?g(w[I+0],w[I+1],w[I+2],w[I+3]):r<=w[I+2]&&t<=w[I+3]&&o>=w[I+0]&&c>=w[I+1])?(m[C]=!0,h.push(x[C])):m[C]=!1}}},zs.prototype._forEachCell=function(r,t,o,c,u,h,m,g){for(var v=this._convertToCellCoord(r),x=this._convertToCellCoord(t),w=this._convertToCellCoord(o),E=this._convertToCellCoord(c),C=v;C<=w;C++)for(var I=x;I<=E;I++){var D=this.d*I+C;if((!g||g(this._convertFromCellCoord(C),this._convertFromCellCoord(I),this._convertFromCellCoord(C+1),this._convertFromCellCoord(I+1)))&&u.call(this,r,t,o,c,D,h,m,g))return}},zs.prototype._convertFromCellCoord=function(r){return(r-this.padding)/this.scale},zs.prototype._convertToCellCoord=function(r){return Math.max(0,Math.min(this.d-1,Math.floor(r*this.scale)+this.padding))},zs.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var r=this.cells,t=eo+this.cells.length+1+1,o=0,c=0;c<this.cells.length;c++)o+=this.cells[c].length;var u=new Int32Array(t+o+this.keys.length+this.bboxes.length);u[0]=this.extent,u[1]=this.n,u[2]=this.padding;for(var h=t,m=0;m<r.length;m++){var g=r[m];u[eo+m]=h,u.set(g,h),h+=g.length}return u[eo+r.length]=h,u.set(this.keys,h),u[eo+r.length+1]=h+=this.keys.length,u.set(this.bboxes,h),h+=this.bboxes.length,u.buffer};var to=O(ju);const wm={};function dn(r,t,o={}){Object.defineProperty(r,"_classRegistryKey",{value:t,writeable:!1}),wm[t]={klass:r,omit:o.omit||[]}}dn(Object,"Object"),to.serialize=function(r,t){const o=r.toArrayBuffer();return t&&t.add(o),{buffer:o}},to.deserialize=function(r){return new to(r.buffer)},Object.defineProperty(to,"name",{value:"Grid"}),dn(to,"Grid"),dn(En,"Color"),dn(Error,"Error"),dn(Ce,"AJAXError"),dn(as,"ResolvedImage"),dn(um,"StylePropertyFunction"),dn(lm,"StyleExpression",{omit:["_evaluator"]}),dn(jc,"ZoomDependentExpression"),dn(By,"ZoomConstantExpression"),dn(Pa,"CompoundExpression",{omit:["_evaluate"]});for(const r in mf)wm[mf[r]._classRegistryKey]||dn(mf[r],`Expression${r}`);function Qy(r){return r&&typeof ArrayBuffer<"u"&&(r instanceof ArrayBuffer||r.constructor&&r.constructor.name==="ArrayBuffer")}function PS(r){return p.ImageBitmap&&r instanceof p.ImageBitmap}function Os(r,t){if(r==null||typeof r=="boolean"||typeof r=="number"||typeof r=="string"||r instanceof Boolean||r instanceof Number||r instanceof String||r instanceof Date||r instanceof RegExp)return r;if(Qy(r)||PS(r))return t&&t.add(r),r;if(ArrayBuffer.isView(r)){const o=r;return t&&t.add(o.buffer),o}if(r instanceof p.ImageData)return t&&t.add(r.data.buffer),r;if(Array.isArray(r)){const o=[];for(const c of r)o.push(Os(c,t));return o}if(r instanceof Map){const o={$name:"Map"};for(const[c,u]of r.entries())o[c]=Os(u);return o}if(typeof r=="object"){const o=r.constructor,c=o._classRegistryKey;if(!c)throw new Error(`can't serialize object of unregistered class ${c}`);const u=o.serialize?o.serialize(r,t):{};if(!o.serialize){for(const h in r)r.hasOwnProperty(h)&&(wm[c].omit.indexOf(h)>=0||(u[h]=Os(r[h],t)));r instanceof Error&&(u.message=r.message)}if(u.$name)throw new Error("$name property is reserved for worker serialization logic.");return c!=="Object"&&(u.$name=c),u}throw new Error("can't serialize object of type "+typeof r)}function eh(r){if(r==null||typeof r=="boolean"||typeof r=="number"||typeof r=="string"||r instanceof Boolean||r instanceof Number||r instanceof String||r instanceof Date||r instanceof RegExp||Qy(r)||PS(r)||ArrayBuffer.isView(r)||r instanceof p.ImageData)return r;if(Array.isArray(r))return r.map(eh);if(typeof r=="object"){const t=r.$name||"Object";if(t==="Map"){const u=new Map;for(const h of Object.keys(r))h!=="$name"&&u.set(h,eh(r[h]));return u}const{klass:o}=wm[t];if(!o)throw new Error(`can't deserialize unregistered class ${t}`);if(o.deserialize)return o.deserialize(r);const c=Object.create(o.prototype);for(const u of Object.keys(r))u!=="$name"&&(c[u]=eh(r[u]));return c}throw new Error("can't deserialize object of type "+typeof r)}const gn={"Latin-1 Supplement":r=>r>=128&&r<=255,Arabic:r=>r>=1536&&r<=1791,"Arabic Supplement":r=>r>=1872&&r<=1919,"Arabic Extended-A":r=>r>=2208&&r<=2303,"Hangul Jamo":r=>r>=4352&&r<=4607,"Unified Canadian Aboriginal Syllabics":r=>r>=5120&&r<=5759,Khmer:r=>r>=6016&&r<=6143,"Unified Canadian Aboriginal Syllabics Extended":r=>r>=6320&&r<=6399,"General Punctuation":r=>r>=8192&&r<=8303,"Letterlike Symbols":r=>r>=8448&&r<=8527,"Number Forms":r=>r>=8528&&r<=8591,"Miscellaneous Technical":r=>r>=8960&&r<=9215,"Control Pictures":r=>r>=9216&&r<=9279,"Optical Character Recognition":r=>r>=9280&&r<=9311,"Enclosed Alphanumerics":r=>r>=9312&&r<=9471,"Geometric Shapes":r=>r>=9632&&r<=9727,"Miscellaneous Symbols":r=>r>=9728&&r<=9983,"Miscellaneous Symbols and Arrows":r=>r>=11008&&r<=11263,"CJK Radicals Supplement":r=>r>=11904&&r<=12031,"Kangxi Radicals":r=>r>=12032&&r<=12255,"Ideographic Description Characters":r=>r>=12272&&r<=12287,"CJK Symbols and Punctuation":r=>r>=12288&&r<=12351,Hiragana:r=>r>=12352&&r<=12447,Katakana:r=>r>=12448&&r<=12543,Bopomofo:r=>r>=12544&&r<=12591,"Hangul Compatibility Jamo":r=>r>=12592&&r<=12687,Kanbun:r=>r>=12688&&r<=12703,"Bopomofo Extended":r=>r>=12704&&r<=12735,"CJK Strokes":r=>r>=12736&&r<=12783,"Katakana Phonetic Extensions":r=>r>=12784&&r<=12799,"Enclosed CJK Letters and Months":r=>r>=12800&&r<=13055,"CJK Compatibility":r=>r>=13056&&r<=13311,"CJK Unified Ideographs Extension A":r=>r>=13312&&r<=19903,"Yijing Hexagram Symbols":r=>r>=19904&&r<=19967,"CJK Unified Ideographs":r=>r>=19968&&r<=40959,"Yi Syllables":r=>r>=40960&&r<=42127,"Yi Radicals":r=>r>=42128&&r<=42191,"Hangul Jamo Extended-A":r=>r>=43360&&r<=43391,"Hangul Syllables":r=>r>=44032&&r<=55215,"Hangul Jamo Extended-B":r=>r>=55216&&r<=55295,"Private Use Area":r=>r>=57344&&r<=63743,"CJK Compatibility Ideographs":r=>r>=63744&&r<=64255,"Arabic Presentation Forms-A":r=>r>=64336&&r<=65023,"Vertical Forms":r=>r>=65040&&r<=65055,"CJK Compatibility Forms":r=>r>=65072&&r<=65103,"Small Form Variants":r=>r>=65104&&r<=65135,"Arabic Presentation Forms-B":r=>r>=65136&&r<=65279,"Halfwidth and Fullwidth Forms":r=>r>=65280&&r<=65519,"CJK Unified Ideographs Extension B":r=>r>=131072&&r<=173791};function Sm(r){for(const t of r)if(ev(t.charCodeAt(0)))return!0;return!1}function th(r){for(const t of r)if(!IS(t.charCodeAt(0)))return!1;return!0}function IS(r){return!(gn.Arabic(r)||gn["Arabic Supplement"](r)||gn["Arabic Extended-A"](r)||gn["Arabic Presentation Forms-A"](r)||gn["Arabic Presentation Forms-B"](r))}function ev(r){return!(r!==746&&r!==747&&(r<4352||!(gn["Bopomofo Extended"](r)||gn.Bopomofo(r)||gn["CJK Compatibility Forms"](r)&&!(r>=65097&&r<=65103)||gn["CJK Compatibility Ideographs"](r)||gn["CJK Compatibility"](r)||gn["CJK Radicals Supplement"](r)||gn["CJK Strokes"](r)||!(!gn["CJK Symbols and Punctuation"](r)||r>=12296&&r<=12305||r>=12308&&r<=12319||r===12336)||gn["CJK Unified Ideographs Extension A"](r)||gn["CJK Unified Ideographs"](r)||gn["Enclosed CJK Letters and Months"](r)||gn["Hangul Compatibility Jamo"](r)||gn["Hangul Jamo Extended-A"](r)||gn["Hangul Jamo Extended-B"](r)||gn["Hangul Jamo"](r)||gn["Hangul Syllables"](r)||gn.Hiragana(r)||gn["Ideographic Description Characters"](r)||gn.Kanbun(r)||gn["Kangxi Radicals"](r)||gn["Katakana Phonetic Extensions"](r)||gn.Katakana(r)&&r!==12540||!(!gn["Halfwidth and Fullwidth Forms"](r)||r===65288||r===65289||r===65293||r>=65306&&r<=65310||r===65339||r===65341||r===65343||r>=65371&&r<=65503||r===65507||r>=65512&&r<=65519)||!(!gn["Small Form Variants"](r)||r>=65112&&r<=65118||r>=65123&&r<=65126)||gn["Unified Canadian Aboriginal Syllabics"](r)||gn["Unified Canadian Aboriginal Syllabics Extended"](r)||gn["Vertical Forms"](r)||gn["Yijing Hexagram Symbols"](r)||gn["Yi Syllables"](r)||gn["Yi Radicals"](r))))}function tv(r){return!(ev(r)||function(t){return!!(gn["Latin-1 Supplement"](t)&&(t===167||t===169||t===174||t===177||t===188||t===189||t===190||t===215||t===247)||gn["General Punctuation"](t)&&(t===8214||t===8224||t===8225||t===8240||t===8241||t===8251||t===8252||t===8258||t===8263||t===8264||t===8265||t===8273)||gn["Letterlike Symbols"](t)||gn["Number Forms"](t)||gn["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||t===9003||t>=9085&&t<=9114||t>=9150&&t<=9165||t===9167||t>=9169&&t<=9179||t>=9186&&t<=9215)||gn["Control Pictures"](t)&&t!==9251||gn["Optical Character Recognition"](t)||gn["Enclosed Alphanumerics"](t)||gn["Geometric Shapes"](t)||gn["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||gn["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||gn["CJK Symbols and Punctuation"](t)||gn.Katakana(t)||gn["Private Use Area"](t)||gn["CJK Compatibility Forms"](t)||gn["Small Form Variants"](t)||gn["Halfwidth and Fullwidth Forms"](t)||t===8734||t===8756||t===8757||t>=9984&&t<=10087||t>=10102&&t<=10131||t===65532||t===65533)}(r))}function Em(r){return r>=1424&&r<=2303||gn["Arabic Presentation Forms-A"](r)||gn["Arabic Presentation Forms-B"](r)}function OC(r,t){return!(!t&&Em(r)||r>=2304&&r<=3583||r>=3840&&r<=4255||gn.Khmer(r))}function NC(r){for(const t of r)if(Em(t.charCodeAt(0)))return!0;return!1}const nv="deferred",iv="loading",Yc="loaded";let o1=null,Va="unavailable",qc=null;const Zo=function(r){r&&typeof r=="string"&&r.indexOf("NetworkError")>-1&&(Va="error"),o1&&o1(r)};function s1(){rv.fire(new $t("pluginStateChange",{pluginStatus:Va,pluginURL:qc}))}const rv=new Vn,l1=function(){return Va},RS=function(){if(Va!==nv||!qc)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Va=iv,s1(),qc&&vt({url:qc},r=>{r?Zo(r):(Va=Yc,s1())})},Ns={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>Va===Yc||Ns.applyArabicShaping!=null,isLoading:()=>Va===iv,setState(r){Va=r.pluginStatus,qc=r.pluginURL},isParsed:()=>Ns.applyArabicShaping!=null&&Ns.processBidirectionalText!=null&&Ns.processStyledBidirectionalText!=null,getPluginURL:()=>qc};class dr{constructor(t,o){this.zoom=t,o?(this.now=o.now,this.fadeDuration=o.fadeDuration,this.transition=o.transition,this.pitch=o.pitch,this.brightness=o.brightness):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0,this.brightness=0)}isSupportedScript(t){return function(o,c){for(const u of o)if(!OC(u.charCodeAt(0),c))return!1;return!0}(t,Ns.isLoaded())}}class av{constructor(t,o,c){this.property=t,this.value=o,this.expression=function(u,h,m){if(Fy(u))return new um(u,h);if(cm(u)||Array.isArray(u)&&u.length>0){const g=Uy(u,h,m);if(g.result==="error")throw new Error(g.value.map(v=>`${v.key}: ${v.message}`).join(", "));return g.value}{let g=u;return typeof u=="string"&&h.type==="color"&&(g=En.parse(u)),{kind:"constant",isConfigDependent:!1,evaluate:()=>g}}}(o===void 0?t.specification.default:o,t.specification,c)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(t,o,c){return this.property.possiblyEvaluate(this,t,o,c)}}class hs{constructor(t,o){this.property=t,this.value=new av(t,void 0,o)}transitioned(t,o){return new LS(this.property,this.value,o,Fe({},t.transition,this.transition),t.now)}untransitioned(){return new LS(this.property,this.value,null,{},0)}}class nh{constructor(t,o){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues),this._options=o,this.isConfigDependent=!1}getValue(t){return ue(this._values[t].value.value)}setValue(t,o){this._values.hasOwnProperty(t)||(this._values[t]=new hs(this._values[t].property,this._options)),this._values[t].value=new av(this._values[t].property,o===null?void 0:ue(o),this._options),this.isConfigDependent=this.isConfigDependent||this._values[t].value.expression.isConfigDependent}setTransitionOrValue(t,o){o&&(this._options=o);const c=this._properties.properties;if(t)for(const u in t){const h=t[u];if(gt(u,"-transition")){const m=u.slice(0,-11);c[m]&&this.setTransition(m,h)}else c[u]&&this.setValue(u,h)}}getTransition(t){return ue(this._values[t].transition)}setTransition(t,o){this._values.hasOwnProperty(t)||(this._values[t]=new hs(this._values[t].property)),this._values[t].transition=ue(o)||void 0}serialize(){const t={};for(const o of Object.keys(this._values)){const c=this.getValue(o);c!==void 0&&(t[o]=c);const u=this.getTransition(o);u!==void 0&&(t[`${o}-transition`]=u)}return t}transitioned(t,o){const c=new Xc(this._properties);for(const u of Object.keys(this._values))c._values[u]=this._values[u].transitioned(t,o._values[u]);return c}untransitioned(){const t=new Xc(this._properties);for(const o of Object.keys(this._values))t._values[o]=this._values[o].untransitioned();return t}}class LS{constructor(t,o,c,u,h){const m=u.delay||0,g=u.duration||0;h=h||0,this.property=t,this.value=o,this.begin=h+m,this.end=this.begin+g,t.specification.transition&&(u.delay||u.duration)&&(this.prior=c)}possiblyEvaluate(t,o,c){const u=t.now||0,h=this.value.possiblyEvaluate(t,o,c),m=this.prior;if(m){if(u>this.end)return this.prior=null,h;if(this.value.isDataDriven())return this.prior=null,h;if(u<this.begin)return m.possiblyEvaluate(t,o,c);{const g=(u-this.begin)/(this.end-this.begin);return this.property.interpolate(m.possiblyEvaluate(t,o,c),h,Re(g))}}return h}}class Xc{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)}possiblyEvaluate(t,o,c){const u=new $u(this._properties);for(const h of Object.keys(this._values))u._values[h]=this._values[h].possiblyEvaluate(t,o,c);return u}hasTransition(){for(const t of Object.keys(this._values))if(this._values[t].prior)return!0;return!1}}class ov{constructor(t,o){this._properties=t,this._values=Object.create(t.defaultPropertyValues),this._options=o,this.isConfigDependent=!1}getValue(t){return ue(this._values[t].value)}setValue(t,o){this._values[t]=new av(this._values[t].property,o===null?void 0:ue(o),this._options),this.isConfigDependent=this.isConfigDependent||this._values[t].expression.isConfigDependent}serialize(){const t={};for(const o of Object.keys(this._values)){const c=this.getValue(o);c!==void 0&&(t[o]=c)}return t}possiblyEvaluate(t,o,c){const u=new $u(this._properties);for(const h of Object.keys(this._values))u._values[h]=this._values[h].possiblyEvaluate(t,o,c);return u}}class ll{constructor(t,o,c){this.property=t,this.value=o,this.parameters=c}isConstant(){return this.value.kind==="constant"}constantOr(t){return this.value.kind==="constant"?this.value.value:t}evaluate(t,o,c,u){return this.property.evaluate(this.value,this.parameters,t,o,c,u)}}class $u{constructor(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)}get(t){return this._values[t]}}class Zt{constructor(t){this.specification=t}possiblyEvaluate(t,o){return t.expression.evaluate(o)}interpolate(t,o,c){const u=Jp[this.specification.type];return u?u(t,o,c):t}}class xn{constructor(t,o){this.specification=t,this.overrides=o}possiblyEvaluate(t,o,c,u){return new ll(this,t.expression.kind==="constant"||t.expression.kind==="camera"?{kind:"constant",value:t.expression.evaluate(o,null,{},c,u)}:t.expression,o)}interpolate(t,o,c){if(t.value.kind!=="constant"||o.value.kind!=="constant")return t;if(t.value.value===void 0||o.value.value===void 0)return new ll(this,{kind:"constant",value:void 0},t.parameters);const u=Jp[this.specification.type];return u?new ll(this,{kind:"constant",value:u(t.value.value,o.value.value,c)},t.parameters):t}evaluate(t,o,c,u,h,m){return t.kind==="constant"?t.value:t.evaluate(o,c,u,h,m)}}class Mm{constructor(t){this.specification=t}possiblyEvaluate(t,o,c,u){return!!t.expression.evaluate(o,null,{},c,u)}interpolate(){return!1}}class Er{constructor(t){this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const o=new dr(0,{});for(const c in t){const u=t[c];u.specification.overridable&&this.overridableProperties.push(c);const h=this.defaultPropertyValues[c]=new av(u,void 0),m=this.defaultTransitionablePropertyValues[c]=new hs(u);this.defaultTransitioningPropertyValues[c]=m.untransitioned(),this.defaultPossiblyEvaluatedValues[c]=h.possiblyEvaluate(o)}}}function Ko(r,t){return t?`${r}${t}`:r}function sv(r){const t=r.indexOf("");return t>=0?r.slice(0,t):r}dn(xn,"DataDrivenProperty"),dn(Zt,"DataConstantProperty"),dn(Mm,"ColorRampProperty");const c1="-transition";class Jo extends Vn{constructor(t,o,c){if(super(),this.id=t.id,this.type=t.type,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,this.isConfigDependent=!1,t.type!=="custom"&&(this.metadata=t.metadata,this.minzoom=t.minzoom,this.maxzoom=t.maxzoom,t.type!=="background"&&t.type!=="sky"&&t.type!=="slot"&&(this.source=t.source,this.sourceLayer=t["source-layer"],this.filter=t.filter),this.options=c,t.slot&&(this.slot=t.slot),o.layout&&(this._unevaluatedLayout=new ov(o.layout,c),this.isConfigDependent=this.isConfigDependent||this._unevaluatedLayout.isConfigDependent),o.paint)){this._transitionablePaint=new nh(o.paint,c);for(const u in t.paint)this.setPaintProperty(u,t.paint[u],{validate:!1});for(const u in t.layout)this.setLayoutProperty(u,t.layout[u],{validate:!1});this.isConfigDependent=this.isConfigDependent||this._transitionablePaint.isConfigDependent,this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new $u(o.paint)}}setScope(t){this.scope=t,this.fqid=Ko(this.id,t)}getLayoutProperty(t){return t==="visibility"?this.visibility:this._unevaluatedLayout.getValue(t)}setLayoutProperty(t,o,c={}){if(o!=null&&this._validate(a1,`layers.${this.id}.layout.${t}`,t,o,c))return;if(this.type==="custom"&&t==="visibility")return void(this.visibility=o);const u=this._unevaluatedLayout;u._properties.properties[t]&&(u.setValue(t,o),this.isConfigDependent=this.isConfigDependent||u.isConfigDependent,t==="visibility"&&this.possiblyEvaluateVisibility())}possiblyEvaluateVisibility(){this.visibility=this._unevaluatedLayout._values.visibility.possiblyEvaluate({zoom:0})}getPaintProperty(t){return gt(t,c1)?this._transitionablePaint.getTransition(t.slice(0,-11)):this._transitionablePaint.getValue(t)}setPaintProperty(t,o,c={}){if(o!=null&&this._validate(bm,`layers.${this.id}.paint.${t}`,t,o,c))return!1;const u=this._transitionablePaint,h=u._properties.properties;if(gt(t,c1)){const C=t.slice(0,-11);return h[C]&&u.setTransition(C,o||void 0),!1}if(!h[t])return!1;const m=u._values[t],g=m.value.isDataDriven(),v=m.value;u.setValue(t,o),this.isConfigDependent=this.isConfigDependent||u.isConfigDependent,this._handleSpecialPaintPropertyUpdate(t);const x=u._values[t].value,w=x.isDataDriven(),E=gt(t,"pattern")||t==="line-dasharray";return w||g||E||this._handleOverridablePaintPropertyUpdate(t,v,x)}_handleSpecialPaintPropertyUpdate(t){}getProgramIds(){return null}getDefaultProgramParams(t,o){return null}_handleOverridablePaintPropertyUpdate(t,o,c){return!1}isHidden(t){return!!(this.minzoom&&t<this.minzoom)||!!(this.maxzoom&&t>=this.maxzoom)||this.visibility==="none"}updateTransitions(t){this._transitioningPaint=this._transitionablePaint.transitioned(t,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(t,o){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(t,void 0,o)),this.paint=this._transitioningPaint.possiblyEvaluate(t,void 0,o)}serialize(){return Ue({id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()},(t,o)=>!(t===void 0||o==="layout"&&!Object.keys(t).length||o==="paint"&&!Object.keys(t).length))}_validate(t,o,c,u,h={}){return(!h||h.validate!==!1)&&yo(this,t.call(Vu,{key:o,layerType:this.type,objectKey:c,value:u,styleSpec:rt,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}hasShadowPass(){return!1}canCastShadows(){return!1}hasLightBeamPass(){return!1}cutoffRange(){return 0}resize(){}isStateDependent(){for(const t in this.paint._values){const o=this.paint.get(t);if(o instanceof ll&&Xd(o.property.specification)&&(o.value.kind==="source"||o.value.kind==="composite")&&o.value.isStateDependent)return!0}return!1}compileFilter(){this._filterCompiled||(this._featureFilter=fm(this.filter),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}}class FC{constructor(){this.changed=!1,this._updatedLayers={},this._removedLayers={},this.updatedSourceCaches={},this.updatedPaintProps=new Set,this.changedImages=new Set}updateLayer(t){const o=t.scope;this._updatedLayers[o]=this._updatedLayers[o]||new Set,this._updatedLayers[o].add(t.id)}removeLayer(t){const o=t.scope;this._removedLayers[o]=this._removedLayers[o]||{},this._updatedLayers[o]=this._updatedLayers[o]||new Set,this._removedLayers[o][t.id]=t,this._updatedLayers[o].delete(t.id),this.updatedPaintProps.delete(t.fqid)}getRemovedLayer(t){return this._removedLayers[t.scope]?this._removedLayers[t.scope][t.id]:null}discardLayerRemoval(t){this._removedLayers[t.scope]&&delete this._removedLayers[t.scope][t.id]}getLayerUpdatesByScope(){const t={};for(const o in this._updatedLayers)t[o]=t[o]||{},t[o].updatedIds=Array.from(this._updatedLayers[o].values());for(const o in this._removedLayers)t[o]=t[o]||{},t[o].removedIds=Object.keys(this._removedLayers[o]);return t}reset(){this.changed=!1,this._updatedLayers={},this._removedLayers={},this.updatedSourceCaches={},this.updatedPaintProps.clear(),this.changedImages.clear()}}const BC={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class M{constructor(t,o){this._structArray=t,this._pos1=o*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class T{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(t,o){return t._trim(),o&&(t.isTransferred=!0,o.add(t.arrayBuffer)),{length:t.length,arrayBuffer:t.arrayBuffer}}static deserialize(t){const o=Object.create(this.prototype);return o.arrayBuffer=t.arrayBuffer,o.length=t.length,o.capacity=t.arrayBuffer.byteLength/o.bytesPerElement,o._refreshViews(),o}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(t){this.reserve(t),this.length=t}reserve(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const o=this.uint8;this._refreshViews(),o&&this.uint8.set(o)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function B(r,t=1){let o=0,c=0;return{members:r.map(u=>{const h=BC[u.type].BYTES_PER_ELEMENT,m=o=j(o,Math.max(t,h)),g=u.components||1;return c=Math.max(c,h),o+=h*g,{name:u.name,type:u.type,components:g,offset:m}}),size:j(o,Math.max(c,t)),alignment:t}}function j(r,t){return Math.ceil(r/t)*t}class ee extends T{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,o){const c=this.length;return this.resize(c+1),this.emplace(c,t,o)}emplace(t,o,c){const u=2*t;return this.int16[u+0]=o,this.int16[u+1]=c,t}}ee.prototype.bytesPerElement=4,dn(ee,"StructArrayLayout2i4");class oe extends T{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,o,c){const u=this.length;return this.resize(u+1),this.emplace(u,t,o,c)}emplace(t,o,c,u){const h=3*t;return this.int16[h+0]=o,this.int16[h+1]=c,this.int16[h+2]=u,t}}oe.prototype.bytesPerElement=6,dn(oe,"StructArrayLayout3i6");class qe extends T{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,o,c,u){const h=this.length;return this.resize(h+1),this.emplace(h,t,o,c,u)}emplace(t,o,c,u,h){const m=4*t;return this.int16[m+0]=o,this.int16[m+1]=c,this.int16[m+2]=u,this.int16[m+3]=h,t}}qe.prototype.bytesPerElement=8,dn(qe,"StructArrayLayout4i8");class bt extends T{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,o,c,u,h){const m=this.length;return this.resize(m+1),this.emplace(m,t,o,c,u,h)}emplace(t,o,c,u,h,m){const g=5*t;return this.int16[g+0]=o,this.int16[g+1]=c,this.int16[g+2]=u,this.int16[g+3]=h,this.int16[g+4]=m,t}}bt.prototype.bytesPerElement=10,dn(bt,"StructArrayLayout5i10");class Yt extends T{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,o,c,u,h,m,g){const v=this.length;return this.resize(v+1),this.emplace(v,t,o,c,u,h,m,g)}emplace(t,o,c,u,h,m,g,v){const x=6*t,w=12*t,E=3*t;return this.int16[x+0]=o,this.int16[x+1]=c,this.uint8[w+4]=u,this.uint8[w+5]=h,this.uint8[w+6]=m,this.uint8[w+7]=g,this.float32[E+2]=v,t}}Yt.prototype.bytesPerElement=12,dn(Yt,"StructArrayLayout2i4ub1f12");class hn extends T{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,o,c,u){const h=this.length;return this.resize(h+1),this.emplace(h,t,o,c,u)}emplace(t,o,c,u,h){const m=4*t;return this.float32[m+0]=o,this.float32[m+1]=c,this.float32[m+2]=u,this.float32[m+3]=h,t}}hn.prototype.bytesPerElement=16,dn(hn,"StructArrayLayout4f16");class Cn extends T{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,o,c,u,h){const m=this.length;return this.resize(m+1),this.emplace(m,t,o,c,u,h)}emplace(t,o,c,u,h,m){const g=6*t,v=3*t;return this.uint16[g+0]=o,this.uint16[g+1]=c,this.uint16[g+2]=u,this.uint16[g+3]=h,this.float32[v+2]=m,t}}Cn.prototype.bytesPerElement=12,dn(Cn,"StructArrayLayout4ui1f12");class Ti extends T{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,o,c,u){const h=this.length;return this.resize(h+1),this.emplace(h,t,o,c,u)}emplace(t,o,c,u,h){const m=4*t;return this.uint16[m+0]=o,this.uint16[m+1]=c,this.uint16[m+2]=u,this.uint16[m+3]=h,t}}Ti.prototype.bytesPerElement=8,dn(Ti,"StructArrayLayout4ui8");class ii extends T{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,o,c,u,h,m){const g=this.length;return this.resize(g+1),this.emplace(g,t,o,c,u,h,m)}emplace(t,o,c,u,h,m,g){const v=6*t;return this.int16[v+0]=o,this.int16[v+1]=c,this.int16[v+2]=u,this.int16[v+3]=h,this.int16[v+4]=m,this.int16[v+5]=g,t}}ii.prototype.bytesPerElement=12,dn(ii,"StructArrayLayout6i12");class Mr extends T{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,o,c,u,h,m,g,v,x,w,E,C){const I=this.length;return this.resize(I+1),this.emplace(I,t,o,c,u,h,m,g,v,x,w,E,C)}emplace(t,o,c,u,h,m,g,v,x,w,E,C,I){const D=12*t;return this.int16[D+0]=o,this.int16[D+1]=c,this.int16[D+2]=u,this.int16[D+3]=h,this.uint16[D+4]=m,this.uint16[D+5]=g,this.uint16[D+6]=v,this.uint16[D+7]=x,this.int16[D+8]=w,this.int16[D+9]=E,this.int16[D+10]=C,this.int16[D+11]=I,t}}Mr.prototype.bytesPerElement=24,dn(Mr,"StructArrayLayout4i4ui4i24");class $n extends T{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,o,c,u,h,m){const g=this.length;return this.resize(g+1),this.emplace(g,t,o,c,u,h,m)}emplace(t,o,c,u,h,m,g){const v=10*t,x=5*t;return this.int16[v+0]=o,this.int16[v+1]=c,this.int16[v+2]=u,this.float32[x+2]=h,this.float32[x+3]=m,this.float32[x+4]=g,t}}$n.prototype.bytesPerElement=20,dn($n,"StructArrayLayout3i3f20");class vo extends T{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t){const o=this.length;return this.resize(o+1),this.emplace(o,t)}emplace(t,o){return this.uint32[1*t+0]=o,t}}vo.prototype.bytesPerElement=4,dn(vo,"StructArrayLayout1ul4");class no extends T{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,o){const c=this.length;return this.resize(c+1),this.emplace(c,t,o)}emplace(t,o,c){const u=2*t;return this.uint16[u+0]=o,this.uint16[u+1]=c,t}}no.prototype.bytesPerElement=4,dn(no,"StructArrayLayout2ui4");class Bt extends T{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,o,c,u,h,m,g,v,x,w,E,C,I){const D=this.length;return this.resize(D+1),this.emplace(D,t,o,c,u,h,m,g,v,x,w,E,C,I)}emplace(t,o,c,u,h,m,g,v,x,w,E,C,I,D){const N=20*t,W=10*t;return this.int16[N+0]=o,this.int16[N+1]=c,this.int16[N+2]=u,this.int16[N+3]=h,this.int16[N+4]=m,this.float32[W+3]=g,this.float32[W+4]=v,this.float32[W+5]=x,this.float32[W+6]=w,this.int16[N+14]=E,this.uint32[W+8]=C,this.uint16[N+18]=I,this.uint16[N+19]=D,t}}Bt.prototype.bytesPerElement=40,dn(Bt,"StructArrayLayout5i4f1i1ul2ui40");class Tt extends T{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,o,c,u,h,m,g){const v=this.length;return this.resize(v+1),this.emplace(v,t,o,c,u,h,m,g)}emplace(t,o,c,u,h,m,g,v){const x=8*t;return this.int16[x+0]=o,this.int16[x+1]=c,this.int16[x+2]=u,this.int16[x+4]=h,this.int16[x+5]=m,this.int16[x+6]=g,this.int16[x+7]=v,t}}Tt.prototype.bytesPerElement=16,dn(Tt,"StructArrayLayout3i2i2i16");class Gt extends T{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,o,c,u,h){const m=this.length;return this.resize(m+1),this.emplace(m,t,o,c,u,h)}emplace(t,o,c,u,h,m){const g=4*t,v=8*t;return this.float32[g+0]=o,this.float32[g+1]=c,this.float32[g+2]=u,this.int16[v+6]=h,this.int16[v+7]=m,t}}Gt.prototype.bytesPerElement=16,dn(Gt,"StructArrayLayout2f1f2i16");class Tn extends T{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,o,c,u){const h=this.length;return this.resize(h+1),this.emplace(h,t,o,c,u)}emplace(t,o,c,u,h){const m=12*t,g=3*t;return this.uint8[m+0]=o,this.uint8[m+1]=c,this.float32[g+1]=u,this.float32[g+2]=h,t}}Tn.prototype.bytesPerElement=12,dn(Tn,"StructArrayLayout2ub2f12");class On extends T{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,o,c){const u=this.length;return this.resize(u+1),this.emplace(u,t,o,c)}emplace(t,o,c,u){const h=3*t;return this.float32[h+0]=o,this.float32[h+1]=c,this.float32[h+2]=u,t}}On.prototype.bytesPerElement=12,dn(On,"StructArrayLayout3f12");class Un extends T{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,o,c){const u=this.length;return this.resize(u+1),this.emplace(u,t,o,c)}emplace(t,o,c,u){const h=3*t;return this.uint16[h+0]=o,this.uint16[h+1]=c,this.uint16[h+2]=u,t}}Un.prototype.bytesPerElement=6,dn(Un,"StructArrayLayout3ui6");class Pi extends T{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t,o,c,u,h,m,g,v,x,w,E,C,I,D,N,W,V,q,Z,K,X){const J=this.length;return this.resize(J+1),this.emplace(J,t,o,c,u,h,m,g,v,x,w,E,C,I,D,N,W,V,q,Z,K,X)}emplace(t,o,c,u,h,m,g,v,x,w,E,C,I,D,N,W,V,q,Z,K,X,J){const ae=30*t,ce=15*t,ge=60*t;return this.int16[ae+0]=o,this.int16[ae+1]=c,this.int16[ae+2]=u,this.float32[ce+2]=h,this.float32[ce+3]=m,this.uint16[ae+8]=g,this.uint16[ae+9]=v,this.uint32[ce+5]=x,this.uint32[ce+6]=w,this.uint32[ce+7]=E,this.uint16[ae+16]=C,this.uint16[ae+17]=I,this.uint16[ae+18]=D,this.float32[ce+10]=N,this.float32[ce+11]=W,this.uint8[ge+48]=V,this.uint8[ge+49]=q,this.uint8[ge+50]=Z,this.uint32[ce+13]=K,this.int16[ae+28]=X,this.uint8[ge+58]=J,t}}Pi.prototype.bytesPerElement=60,dn(Pi,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class tr extends T{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t,o,c,u,h,m,g,v,x,w,E,C,I,D,N,W,V,q,Z,K,X,J,ae,ce,ge,ve,Pe,Me,Le,Ee,He,Ke){const nt=this.length;return this.resize(nt+1),this.emplace(nt,t,o,c,u,h,m,g,v,x,w,E,C,I,D,N,W,V,q,Z,K,X,J,ae,ce,ge,ve,Pe,Me,Le,Ee,He,Ke)}emplace(t,o,c,u,h,m,g,v,x,w,E,C,I,D,N,W,V,q,Z,K,X,J,ae,ce,ge,ve,Pe,Me,Le,Ee,He,Ke,nt){const Ve=20*t,je=40*t,ot=80*t;return this.float32[Ve+0]=o,this.float32[Ve+1]=c,this.int16[je+4]=u,this.int16[je+5]=h,this.int16[je+6]=m,this.int16[je+7]=g,this.int16[je+8]=v,this.int16[je+9]=x,this.int16[je+10]=w,this.int16[je+11]=E,this.int16[je+12]=C,this.uint16[je+13]=I,this.uint16[je+14]=D,this.uint16[je+15]=N,this.uint16[je+16]=W,this.uint16[je+17]=V,this.uint16[je+18]=q,this.uint16[je+19]=Z,this.uint16[je+20]=K,this.uint16[je+21]=X,this.uint16[je+22]=J,this.uint16[je+23]=ae,this.uint16[je+24]=ce,this.uint16[je+25]=ge,this.uint16[je+26]=ve,this.uint16[je+27]=Pe,this.uint32[Ve+14]=Me,this.float32[Ve+15]=Le,this.float32[Ve+16]=Ee,this.float32[Ve+17]=He,this.float32[Ve+18]=Ke,this.uint8[ot+76]=nt,t}}tr.prototype.bytesPerElement=80,dn(tr,"StructArrayLayout2f9i15ui1ul4f1ub80");class va extends T{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t){const o=this.length;return this.resize(o+1),this.emplace(o,t)}emplace(t,o){return this.float32[1*t+0]=o,t}}va.prototype.bytesPerElement=4,dn(va,"StructArrayLayout1f4");class Hi extends T{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,o,c,u,h){const m=this.length;return this.resize(m+1),this.emplace(m,t,o,c,u,h)}emplace(t,o,c,u,h,m){const g=5*t;return this.float32[g+0]=o,this.float32[g+1]=c,this.float32[g+2]=u,this.float32[g+3]=h,this.float32[g+4]=m,t}}Hi.prototype.bytesPerElement=20,dn(Hi,"StructArrayLayout5f20");class yc extends T{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,o,c,u,h,m,g){const v=this.length;return this.resize(v+1),this.emplace(v,t,o,c,u,h,m,g)}emplace(t,o,c,u,h,m,g,v){const x=7*t;return this.float32[x+0]=o,this.float32[x+1]=c,this.float32[x+2]=u,this.float32[x+3]=h,this.float32[x+4]=m,this.float32[x+5]=g,this.float32[x+6]=v,t}}yc.prototype.bytesPerElement=28,dn(yc,"StructArrayLayout7f28");class u1 extends T{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,o,c,u){const h=this.length;return this.resize(h+1),this.emplace(h,t,o,c,u)}emplace(t,o,c,u,h){const m=6*t;return this.uint32[3*t+0]=o,this.uint16[m+2]=c,this.uint16[m+3]=u,this.uint16[m+4]=h,t}}u1.prototype.bytesPerElement=12,dn(u1,"StructArrayLayout1ul3ui12");class d1 extends T{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t){const o=this.length;return this.resize(o+1),this.emplace(o,t)}emplace(t,o){return this.uint16[1*t+0]=o,t}}d1.prototype.bytesPerElement=2,dn(d1,"StructArrayLayout1ui2");class h1 extends T{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,o){const c=this.length;return this.resize(c+1),this.emplace(c,t,o)}emplace(t,o,c){const u=2*t;return this.float32[u+0]=o,this.float32[u+1]=c,t}}h1.prototype.bytesPerElement=8,dn(h1,"StructArrayLayout2f8");class UC extends T{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,o,c,u,h,m,g,v,x,w,E,C,I,D,N,W){const V=this.length;return this.resize(V+1),this.emplace(V,t,o,c,u,h,m,g,v,x,w,E,C,I,D,N,W)}emplace(t,o,c,u,h,m,g,v,x,w,E,C,I,D,N,W,V){const q=16*t;return this.float32[q+0]=o,this.float32[q+1]=c,this.float32[q+2]=u,this.float32[q+3]=h,this.float32[q+4]=m,this.float32[q+5]=g,this.float32[q+6]=v,this.float32[q+7]=x,this.float32[q+8]=w,this.float32[q+9]=E,this.float32[q+10]=C,this.float32[q+11]=I,this.float32[q+12]=D,this.float32[q+13]=N,this.float32[q+14]=W,this.float32[q+15]=V,t}}UC.prototype.bytesPerElement=64,dn(UC,"StructArrayLayout16f64");class kS extends T{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,o,c,u,h,m,g){const v=this.length;return this.resize(v+1),this.emplace(v,t,o,c,u,h,m,g)}emplace(t,o,c,u,h,m,g,v){const x=10*t,w=5*t;return this.uint16[x+0]=o,this.uint16[x+1]=c,this.uint16[x+2]=u,this.uint16[x+3]=h,this.float32[w+2]=m,this.float32[w+3]=g,this.float32[w+4]=v,t}}kS.prototype.bytesPerElement=20,dn(kS,"StructArrayLayout4ui3f20");class WC extends T{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer)}emplaceBack(t){const o=this.length;return this.resize(o+1),this.emplace(o,t)}emplace(t,o){return this.uint8[1*t+0]=o,t}}WC.prototype.bytesPerElement=1,dn(WC,"StructArrayLayout1ub1");class CO extends M{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}CO.prototype.size=40;class VC extends Bt{get(t){return new CO(this,t)}}dn(VC,"CollisionBoxArray");class PO extends M{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(t){this._structArray.uint8[this._pos1+49]=t}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(t){this._structArray.uint8[this._pos1+50]=t}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(t){this._structArray.uint32[this._pos4+13]=t}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(t){this._structArray.uint8[this._pos1+58]=t}}PO.prototype.size=60;class IO extends Pi{get(t){return new PO(this,t)}}dn(IO,"PlacedSymbolArray");class RO extends M{get tileAnchorX(){return this._structArray.float32[this._pos4+0]}get tileAnchorY(){return this._structArray.float32[this._pos4+1]}get projectedAnchorX(){return this._structArray.int16[this._pos2+4]}get projectedAnchorY(){return this._structArray.int16[this._pos2+5]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+6]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+7]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+11]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get key(){return this._structArray.uint16[this._pos2+13]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+14]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+15]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+17]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+19]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+21]}get featureIndex(){return this._structArray.uint16[this._pos2+22]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+23]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numIconVertices(){return this._structArray.uint16[this._pos2+25]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+26]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+27]}get crossTileID(){return this._structArray.uint32[this._pos4+14]}set crossTileID(t){this._structArray.uint32[this._pos4+14]=t}get textOffset0(){return this._structArray.float32[this._pos4+15]}get textOffset1(){return this._structArray.float32[this._pos4+16]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+17]}get zOffset(){return this._structArray.float32[this._pos4+18]}set zOffset(t){this._structArray.float32[this._pos4+18]=t}get hasIconTextFit(){return this._structArray.uint8[this._pos1+76]}}RO.prototype.size=80;class LO extends tr{get(t){return new RO(this,t)}}dn(LO,"SymbolInstanceArray");class kO extends va{getoffsetX(t){return this.float32[1*t+0]}}dn(kO,"GlyphOffsetArray");class DO extends ee{getx(t){return this.int16[2*t+0]}gety(t){return this.int16[2*t+1]}}dn(DO,"SymbolLineVertexArray");class zO extends M{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}zO.prototype.size=12;class OO extends u1{get(t){return new zO(this,t)}}dn(OO,"FeatureIndexArray");class NO extends no{geta_centroid_pos0(t){return this.uint16[2*t+0]}geta_centroid_pos1(t){return this.uint16[2*t+1]}}dn(NO,"FillExtrusionCentroidArray");const XQ=B([{name:"a_pos",components:2,type:"Int16"}],4),ZQ=B([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class qi{constructor(t=[]){this.segments=t}_prepareSegment(t,o,c,u){let h=this.segments[this.segments.length-1];return t>qi.MAX_VERTEX_ARRAY_LENGTH&&xe(`Max vertices per segment is ${qi.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${t}`),(!h||h.vertexLength+t>qi.MAX_VERTEX_ARRAY_LENGTH||h.sortKey!==u)&&(h={vertexOffset:o,primitiveOffset:c,vertexLength:0,primitiveLength:0},u!==void 0&&(h.sortKey=u),this.segments.push(h)),h}prepareSegment(t,o,c,u){return this._prepareSegment(t,o.length,c.length,u)}get(){return this.segments}destroy(){for(const t of this.segments)for(const o in t.vaos)t.vaos[o].destroy()}static simpleSegment(t,o,c,u){return new qi([{vertexOffset:t,primitiveOffset:o,vertexLength:c,primitiveLength:u,vaos:{},sortKey:0}])}}function FO(r,t){return 256*(r=re(Math.floor(r),0,255))+re(Math.floor(t),0,255)}qi.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,dn(qi,"SegmentVector");const KQ=B([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),JQ=B([{name:"a_dash",components:4,type:"Uint16"}]);var DS={exports:{}},BO={exports:{}};(function(r){r.exports=function(t,o){var c,u,h,m,g,v,x,w;for(u=t.length-(c=3&t.length),h=o,g=3432918353,v=461845907,w=0;w<u;)x=255&t.charCodeAt(w)|(255&t.charCodeAt(++w))<<8|(255&t.charCodeAt(++w))<<16|(255&t.charCodeAt(++w))<<24,++w,h=27492+(65535&(m=5*(65535&(h=(h^=x=(65535&(x=(x=(65535&x)*g+(((x>>>16)*g&65535)<<16)&4294967295)<<15|x>>>17))*v+(((x>>>16)*v&65535)<<16)&4294967295)<<13|h>>>19))+((5*(h>>>16)&65535)<<16)&4294967295))+((58964+(m>>>16)&65535)<<16);switch(x=0,c){case 3:x^=(255&t.charCodeAt(w+2))<<16;case 2:x^=(255&t.charCodeAt(w+1))<<8;case 1:h^=x=(65535&(x=(x=(65535&(x^=255&t.charCodeAt(w)))*g+(((x>>>16)*g&65535)<<16)&4294967295)<<15|x>>>17))*v+(((x>>>16)*v&65535)<<16)&4294967295}return h^=t.length,h=2246822507*(65535&(h^=h>>>16))+((2246822507*(h>>>16)&65535)<<16)&4294967295,h=3266489909*(65535&(h^=h>>>13))+((3266489909*(h>>>16)&65535)<<16)&4294967295,(h^=h>>>16)>>>0}})(BO);var QQ=BO.exports,UO={exports:{}};(function(r){r.exports=function(t,o){for(var c,u=t.length,h=o^u,m=0;u>=4;)c=1540483477*(65535&(c=255&t.charCodeAt(m)|(255&t.charCodeAt(++m))<<8|(255&t.charCodeAt(++m))<<16|(255&t.charCodeAt(++m))<<24))+((1540483477*(c>>>16)&65535)<<16),h=1540483477*(65535&h)+((1540483477*(h>>>16)&65535)<<16)^(c=1540483477*(65535&(c^=c>>>24))+((1540483477*(c>>>16)&65535)<<16)),u-=4,++m;switch(u){case 3:h^=(255&t.charCodeAt(m+2))<<16;case 2:h^=(255&t.charCodeAt(m+1))<<8;case 1:h=1540483477*(65535&(h^=255&t.charCodeAt(m)))+((1540483477*(h>>>16)&65535)<<16)}return h=1540483477*(65535&(h^=h>>>13))+((1540483477*(h>>>16)&65535)<<16),(h^=h>>>15)>>>0}})(UO);var WO=QQ,eee=UO.exports;DS.exports=WO,DS.exports.murmur3=WO,DS.exports.murmur2=eee;var GC=O(DS.exports);class f1{constructor(){this.ids=[],this.uniqueIds=[],this.positions=[],this.indexed=!1}add(t,o,c,u){this.ids.push(VO(t)),this.positions.push(o,c,u)}eachPosition(t,o){const c=VO(t);let u=0,h=this.ids.length-1;for(;u<h;){const m=u+h>>1;this.ids[m]>=c?h=m:u=m+1}for(;this.ids[u]===c;)o(this.positions[3*u],this.positions[3*u+1],this.positions[3*u+2]),u++}static serialize(t,o){const c=new Float64Array(t.ids),u=new Uint32Array(t.positions);return HC(c,u,0,c.length-1),o&&(o.add(c.buffer),o.add(u.buffer)),{ids:c,positions:u}}static deserialize(t){const o=new f1;let c;o.ids=t.ids,o.positions=t.positions;for(const u of o.ids)u!==c&&o.uniqueIds.push(u),c=u;return o.indexed=!0,o}}function VO(r){const t=+r;return!isNaN(t)&&Number.MIN_SAFE_INTEGER<=t&&t<=Number.MAX_SAFE_INTEGER?t:GC(String(r))}function HC(r,t,o,c){for(;o<c;){const u=r[o+c>>1];let h=o-1,m=c+1;for(;;){do h++;while(r[h]<u);do m--;while(r[m]>u);if(h>=m)break;zS(r,h,m),zS(t,3*h,3*m),zS(t,3*h+1,3*m+1),zS(t,3*h+2,3*m+2)}m-o<c-m?(HC(r,t,o,m),o=m+1):(HC(r,t,m+1,c),c=m)}}function zS(r,t,o){const c=r[t];r[t]=r[o],r[o]=c}dn(f1,"FeaturePositionMap");class ih{constructor(t){this.gl=t.gl,this.initialized=!1}fetchUniformLocation(t,o){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(t,o),this.initialized=!0),!!this.location}}class di extends ih{constructor(t){super(t),this.current=0}set(t,o,c){this.fetchUniformLocation(t,o)&&this.current!==c&&(this.current=c,this.gl.uniform1i(this.location,c))}}class Jt extends ih{constructor(t){super(t),this.current=0}set(t,o,c){this.fetchUniformLocation(t,o)&&this.current!==c&&(this.current=c,this.gl.uniform1f(this.location,c))}}class gi extends ih{constructor(t){super(t),this.current=[0,0]}set(t,o,c){this.fetchUniformLocation(t,o)&&(c[0]===this.current[0]&&c[1]===this.current[1]||(this.current=c,this.gl.uniform2f(this.location,c[0],c[1])))}}class Kn extends ih{constructor(t){super(t),this.current=[0,0,0]}set(t,o,c){this.fetchUniformLocation(t,o)&&(c[0]===this.current[0]&&c[1]===this.current[1]&&c[2]===this.current[2]||(this.current=c,this.gl.uniform3f(this.location,c[0],c[1],c[2])))}}class cl extends ih{constructor(t){super(t),this.current=[0,0,0,0]}set(t,o,c){this.fetchUniformLocation(t,o)&&(c[0]===this.current[0]&&c[1]===this.current[1]&&c[2]===this.current[2]&&c[3]===this.current[3]||(this.current=c,this.gl.uniform4f(this.location,c[0],c[1],c[2],c[3])))}}class lv extends ih{constructor(t){super(t),this.current=En.transparent}set(t,o,c){this.fetchUniformLocation(t,o)&&(c.r===this.current.r&&c.g===this.current.g&&c.b===this.current.b&&c.a===this.current.a||(this.current=c,this.gl.uniform4f(this.location,c.r,c.g,c.b,c.a)))}}const tee=new Float32Array(16);class qn extends ih{constructor(t){super(t),this.current=tee}set(t,o,c){if(this.fetchUniformLocation(t,o)){if(c[12]!==this.current[12]||c[0]!==this.current[0])return this.current=c,void this.gl.uniformMatrix4fv(this.location,!1,c);for(let u=1;u<16;u++)if(c[u]!==this.current[u]){this.current=c,this.gl.uniformMatrix4fv(this.location,!1,c);break}}}}const nee=new Float32Array(9);class GO extends ih{constructor(t){super(t),this.current=nee}set(t,o,c){if(this.fetchUniformLocation(t,o)){for(let u=0;u<9;u++)if(c[u]!==this.current[u]){this.current=c,this.gl.uniformMatrix3fv(this.location,!1,c);break}}}}const iee=new Float32Array(4);class jC extends ih{constructor(t){super(t),this.current=iee}set(t,o,c){if(this.fetchUniformLocation(t,o)){for(let u=0;u<4;u++)if(c[u]!==this.current[u]){this.current=c,this.gl.uniformMatrix2fv(this.location,!1,c);break}}}}function $C(r){return[FO(255*r.r,255*r.g),FO(255*r.b,255*r.a)]}class p1{constructor(t,o,c){this.value=t,this.uniformNames=o.map(u=>`u_${u}`),this.type=c}setUniform(t,o,c,u,h){o.set(t,h,u.constantOr(this.value))}getBinding(t,o){return this.type==="color"?new lv(t):new Jt(t)}}class cv{constructor(t,o){this.uniformNames=o.map(c=>`u_${c}`),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(t){this.pixelRatio=t.pixelRatio||1,this.pattern=t.tl.concat(t.br)}setUniform(t,o,c,u,h){const m=h==="u_pattern"||h==="u_dash"?this.pattern:h==="u_pixel_ratio"?this.pixelRatio:null;m&&o.set(t,h,m)}getBinding(t,o){return o==="u_pattern"||o==="u_dash"?new cl(t):new Jt(t)}}class rh{constructor(t,o,c,u){this.expression=t,this.type=c,this.maxValue=0,this.paintVertexAttributes=o.map(h=>({name:`a_${h}`,type:"Float32",components:c==="color"?2:1,offset:0})),this.paintVertexArray=new u}populatePaintArray(t,o,c,u,h,m,g){const v=this.paintVertexArray.length,x=this.expression.evaluate(new dr(0,{brightness:m}),o,{},h,u,g);this.paintVertexArray.resize(t),this._setPaintValue(v,t,x)}updatePaintArray(t,o,c,u,h,m,g){const v=this.expression.evaluate({zoom:0,brightness:g},c,u,void 0,h);this._setPaintValue(t,o,v)}_setPaintValue(t,o,c){if(this.type==="color"){const u=$C(c);for(let h=t;h<o;h++)this.paintVertexArray.emplace(h,u[0],u[1])}else{for(let u=t;u<o;u++)this.paintVertexArray.emplace(u,c);this.maxValue=Math.max(this.maxValue,Math.abs(c))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Zc{constructor(t,o,c,u,h,m){this.expression=t,this.uniformNames=o.map(g=>`u_${g}_t`),this.type=c,this.useIntegerZoom=u,this.zoom=h,this.maxValue=0,this.paintVertexAttributes=o.map(g=>({name:`a_${g}`,type:"Float32",components:c==="color"?4:2,offset:0})),this.paintVertexArray=new m}populatePaintArray(t,o,c,u,h,m,g){const v=this.expression.evaluate(new dr(this.zoom,{brightness:m}),o,{},h,u,g),x=this.expression.evaluate(new dr(this.zoom+1,{brightness:m}),o,{},h,u,g),w=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValue(w,t,v,x)}updatePaintArray(t,o,c,u,h,m,g){const v=this.expression.evaluate({zoom:this.zoom,brightness:g},c,u,void 0,h),x=this.expression.evaluate({zoom:this.zoom+1,brightness:g},c,u,void 0,h);this._setPaintValue(t,o,v,x)}_setPaintValue(t,o,c,u){if(this.type==="color"){const h=$C(c),m=$C(u);for(let g=t;g<o;g++)this.paintVertexArray.emplace(g,h[0],h[1],m[0],m[1])}else{for(let h=t;h<o;h++)this.paintVertexArray.emplace(h,c,u);this.maxValue=Math.max(this.maxValue,Math.abs(c),Math.abs(u))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(t,o,c,u,h){const m=this.useIntegerZoom?Math.floor(c.zoom):c.zoom,g=re(this.expression.interpolationFactor(m,this.zoom,this.zoom+1),0,1);o.set(t,h,g)}getBinding(t,o){return new Jt(t)}}class bf{constructor(t,o,c,u,h){this.expression=t,this.layerId=h,this.paintVertexAttributes=(c==="array"?JQ:KQ).members;for(let m=0;m<o.length;++m);this.paintVertexArray=new u}populatePaintArray(t,o,c){const u=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValues(u,t,o.patterns&&o.patterns[this.layerId],c)}updatePaintArray(t,o,c,u,h,m,g){this._setPaintValues(t,o,c.patterns&&c.patterns[this.layerId],m)}_setPaintValues(t,o,c,u){if(!u||!c)return;const h=u[c];if(!h)return;const{tl:m,br:g,pixelRatio:v}=h;for(let x=t;x<o;x++)this.paintVertexArray.emplace(x,m[0],m[1],g[0],g[1],v)}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Tm{constructor(t,o,c=()=>!0){this.binders={},this._buffers=[];const u=[];for(const h in t.paint._values){const m=t.paint.get(h);if(!c(h)||!(m instanceof ll&&Xd(m.property.specification)))continue;const g=aee(h,t.type),v=m.value,x=m.property.specification.type,w=!!m.property.useIntegerZoom,E=h==="line-dasharray"||h.endsWith("pattern"),C=h==="line-dasharray"&&t.layout.get("line-cap").value.kind!=="constant";if(v.kind!=="constant"||C)if(v.kind==="source"||C||E){const I=HO(h,x,"source");this.binders[h]=E?new bf(v,g,x,I,t.id):new rh(v,g,x,I),u.push(`/a_${h}`)}else{const I=HO(h,x,"composite");this.binders[h]=new Zc(v,g,x,w,o,I),u.push(`/z_${h}`)}else this.binders[h]=E?new cv(v.value,g):new p1(v.value,g,x),u.push(`/u_${h}`)}this.cacheKey=u.sort().join("")}getMaxValue(t){const o=this.binders[t];return o instanceof rh||o instanceof Zc?o.maxValue:0}populatePaintArrays(t,o,c,u,h,m,g){for(const v in this.binders){const x=this.binders[v];(x instanceof rh||x instanceof Zc||x instanceof bf)&&x.populatePaintArray(t,o,c,u,h,m,g)}}setConstantPatternPositions(t){for(const o in this.binders){const c=this.binders[o];c instanceof cv&&c.setConstantPatternPositions(t)}}updatePaintArrays(t,o,c,u,h,m,g,v){let x=!1;const w=Object.keys(t),E=w.length!==0,C=E?w:o.uniqueIds;for(const I in this.binders){const D=this.binders[I];if((D instanceof rh||D instanceof Zc||D instanceof bf)&&(D.expression.isStateDependent===!0||D.expression.isLightConstant===!1)){const N=h.paint.get(I);D.expression=N.value;for(const W of C){const V=t[W.toString()];o.eachPosition(W,(q,Z,K)=>{const X=u.feature(q);D.updatePaintArray(Z,K,X,V,m,g,v)})}if(!E)for(const W of c.uniqueIds){const V=t[W.toString()];c.eachPosition(W,(q,Z,K)=>{const X=u.feature(q);D.updatePaintArray(Z,K,X,V,m,g,v)})}x=!0}}return x}defines(){const t=[];for(const o in this.binders){const c=this.binders[o];(c instanceof p1||c instanceof cv)&&t.push(...c.uniformNames.map(u=>`#define HAS_UNIFORM_${u}`))}return t}getBinderAttributes(){const t=[];for(const o in this.binders){const c=this.binders[o];if(c instanceof rh||c instanceof Zc||c instanceof bf)for(let u=0;u<c.paintVertexAttributes.length;u++)t.push(c.paintVertexAttributes[u].name)}return t}getBinderUniforms(){const t=[];for(const o in this.binders){const c=this.binders[o];if(c instanceof p1||c instanceof cv||c instanceof Zc)for(const u of c.uniformNames)t.push(u)}return t}getPaintVertexBuffers(){return this._buffers}getUniforms(t){const o=[];for(const c in this.binders){const u=this.binders[c];if(u instanceof p1||u instanceof cv||u instanceof Zc)for(const h of u.uniformNames)o.push({name:h,property:c,binding:u.getBinding(t,h)})}return o}setUniforms(t,o,c,u,h){for(const{name:m,property:g,binding:v}of c)this.binders[g].setUniform(t,v,h,u.get(g),m)}updatePaintBuffers(){this._buffers=[];for(const t in this.binders){const o=this.binders[t];(o instanceof rh||o instanceof Zc||o instanceof bf)&&o.paintVertexBuffer&&this._buffers.push(o.paintVertexBuffer)}}upload(t){for(const o in this.binders){const c=this.binders[o];(c instanceof rh||c instanceof Zc||c instanceof bf)&&c.upload(t)}this.updatePaintBuffers()}destroy(){for(const t in this.binders){const o=this.binders[t];(o instanceof rh||o instanceof Zc||o instanceof bf)&&o.destroy()}}}class wf{constructor(t,o,c=()=>!0){this.programConfigurations={};for(const u of t)this.programConfigurations[u.id]=new Tm(u,o,c);this.needsUpload=!1,this._featureMap=new f1,this._featureMapWithoutIds=new f1,this._bufferOffset=0,this._idlessCounter=0}populatePaintArrays(t,o,c,u,h,m,g,v){for(const x in this.programConfigurations)this.programConfigurations[x].populatePaintArrays(t,o,u,h,m,g,v);o.id!==void 0?this._featureMap.add(o.id,c,this._bufferOffset,t):(this._featureMapWithoutIds.add(this._idlessCounter,c,this._bufferOffset,t),this._idlessCounter+=1),this._bufferOffset=t,this.needsUpload=!0}updatePaintArrays(t,o,c,u,h,m){for(const g of c)this.needsUpload=this.programConfigurations[g.id].updatePaintArrays(t,this._featureMap,this._featureMapWithoutIds,o,g,u,h,m||0)||this.needsUpload}get(t){return this.programConfigurations[t]}upload(t){if(this.needsUpload){for(const o in this.programConfigurations)this.programConfigurations[o].upload(t);this.needsUpload=!1}}destroy(){for(const t in this.programConfigurations)this.programConfigurations[t].destroy()}}const ree={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-emissive-strength":["emissive_strength"],"icon-emissive-strength":["emissive_strength"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function aee(r,t){return ree[r]||[r.replace(`${t}-`,"").replace(/-/g,"_")]}const oee={"line-pattern":{source:Cn,composite:Cn},"fill-pattern":{source:Cn,composite:Cn},"fill-extrusion-pattern":{source:Cn,composite:Cn},"line-dasharray":{source:Ti,composite:Ti}},see={color:{source:h1,composite:hn},number:{source:va,composite:h1}};function HO(r,t,o){const c=oee[r];return c&&c[o]||see[t][o]}dn(p1,"ConstantBinder"),dn(cv,"PatternConstantBinder"),dn(rh,"SourceExpressionBinder"),dn(bf,"PatternCompositeBinder"),dn(Zc,"CompositeExpressionBinder"),dn(Tm,"ProgramConfiguration",{omit:["_buffers"]}),dn(wf,"ProgramConfigurationSet");class Fl{constructor(t,o){t&&(o?this.setSouthWest(t).setNorthEast(o):t.length===4?this.setSouthWest([t[0],t[1]]).setNorthEast([t[2],t[3]]):this.setSouthWest(t[0]).setNorthEast(t[1]))}setNorthEast(t){return this._ne=t instanceof Nn?new Nn(t.lng,t.lat):Nn.convert(t),this}setSouthWest(t){return this._sw=t instanceof Nn?new Nn(t.lng,t.lat):Nn.convert(t),this}extend(t){const o=this._sw,c=this._ne;let u,h;if(t instanceof Nn)u=t,h=t;else{if(!(t instanceof Fl))return Array.isArray(t)?t.length===4||t.every(Array.isArray)?this.extend(Fl.convert(t)):this.extend(Nn.convert(t)):typeof t=="object"&&t!==null&&t.hasOwnProperty("lat")&&(t.hasOwnProperty("lon")||t.hasOwnProperty("lng"))?this.extend(Nn.convert(t)):this;if(u=t._sw,h=t._ne,!u||!h)return this}return o||c?(o.lng=Math.min(u.lng,o.lng),o.lat=Math.min(u.lat,o.lat),c.lng=Math.max(h.lng,c.lng),c.lat=Math.max(h.lat,c.lat)):(this._sw=new Nn(u.lng,u.lat),this._ne=new Nn(h.lng,h.lat)),this}getCenter(){return new Nn((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new Nn(this.getWest(),this.getNorth())}getSouthEast(){return new Nn(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(t){const{lng:o,lat:c}=Nn.convert(t);let u=this._sw.lng<=o&&o<=this._ne.lng;return this._sw.lng>this._ne.lng&&(u=this._sw.lng>=o&&o>=this._ne.lng),this._sw.lat<=c&&c<=this._ne.lat&&u}static convert(t){return!t||t instanceof Fl?t:new Fl(t)}}var io={},ro={};Object.defineProperty(ro,"__esModule",{value:!0}),ro.setMatrixArrayType=function(r){ro.ARRAY_TYPE=$O=r},ro.toRadian=function(r){return r*cee},ro.equals=function(r,t){return Math.abs(r-t)<=jO*Math.max(1,Math.abs(r),Math.abs(t))},ro.RANDOM=ro.ARRAY_TYPE=ro.EPSILON=void 0;var jO=1e-6;ro.EPSILON=jO;var $O=typeof Float32Array<"u"?Float32Array:Array;ro.ARRAY_TYPE=$O;var lee=Math.random;ro.RANDOM=lee;var cee=Math.PI/180;Math.hypot||(Math.hypot=function(){for(var r=0,t=arguments.length;t--;)r+=arguments[t]*arguments[t];return Math.sqrt(r)});var Or={};function YC(r){return YC=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},YC(r)}Object.defineProperty(Or,"__esModule",{value:!0}),Or.create=function(){var r=new Sf.ARRAY_TYPE(4);return Sf.ARRAY_TYPE!=Float32Array&&(r[1]=0,r[2]=0),r[0]=1,r[3]=1,r},Or.clone=function(r){var t=new Sf.ARRAY_TYPE(4);return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t},Or.copy=function(r,t){return r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r},Or.identity=function(r){return r[0]=1,r[1]=0,r[2]=0,r[3]=1,r},Or.fromValues=function(r,t,o,c){var u=new Sf.ARRAY_TYPE(4);return u[0]=r,u[1]=t,u[2]=o,u[3]=c,u},Or.set=function(r,t,o,c,u){return r[0]=t,r[1]=o,r[2]=c,r[3]=u,r},Or.transpose=function(r,t){if(r===t){var o=t[1];r[1]=t[2],r[2]=o}else r[0]=t[0],r[1]=t[2],r[2]=t[1],r[3]=t[3];return r},Or.invert=function(r,t){var o=t[0],c=t[1],u=t[2],h=t[3],m=o*h-u*c;return m?(r[0]=h*(m=1/m),r[1]=-c*m,r[2]=-u*m,r[3]=o*m,r):null},Or.adjoint=function(r,t){var o=t[0];return r[0]=t[3],r[1]=-t[1],r[2]=-t[2],r[3]=o,r},Or.determinant=function(r){return r[0]*r[3]-r[2]*r[1]},Or.multiply=qO,Or.rotate=function(r,t,o){var c=t[0],u=t[1],h=t[2],m=t[3],g=Math.sin(o),v=Math.cos(o);return r[0]=c*v+h*g,r[1]=u*v+m*g,r[2]=c*-g+h*v,r[3]=u*-g+m*v,r},Or.scale=function(r,t,o){var c=t[1],u=t[2],h=t[3],m=o[0],g=o[1];return r[0]=t[0]*m,r[1]=c*m,r[2]=u*g,r[3]=h*g,r},Or.fromRotation=function(r,t){var o=Math.sin(t),c=Math.cos(t);return r[0]=c,r[1]=o,r[2]=-o,r[3]=c,r},Or.fromScaling=function(r,t){return r[0]=t[0],r[1]=0,r[2]=0,r[3]=t[1],r},Or.str=function(r){return"mat2("+r[0]+", "+r[1]+", "+r[2]+", "+r[3]+")"},Or.frob=function(r){return Math.hypot(r[0],r[1],r[2],r[3])},Or.LDU=function(r,t,o,c){return r[2]=c[2]/c[0],o[0]=c[0],o[1]=c[1],o[3]=c[3]-r[2]*o[1],[r,t,o]},Or.add=function(r,t,o){return r[0]=t[0]+o[0],r[1]=t[1]+o[1],r[2]=t[2]+o[2],r[3]=t[3]+o[3],r},Or.subtract=XO,Or.exactEquals=function(r,t){return r[0]===t[0]&&r[1]===t[1]&&r[2]===t[2]&&r[3]===t[3]},Or.equals=function(r,t){var o=r[0],c=r[1],u=r[2],h=r[3],m=t[0],g=t[1],v=t[2],x=t[3];return Math.abs(o-m)<=Sf.EPSILON*Math.max(1,Math.abs(o),Math.abs(m))&&Math.abs(c-g)<=Sf.EPSILON*Math.max(1,Math.abs(c),Math.abs(g))&&Math.abs(u-v)<=Sf.EPSILON*Math.max(1,Math.abs(u),Math.abs(v))&&Math.abs(h-x)<=Sf.EPSILON*Math.max(1,Math.abs(h),Math.abs(x))},Or.multiplyScalar=function(r,t,o){return r[0]=t[0]*o,r[1]=t[1]*o,r[2]=t[2]*o,r[3]=t[3]*o,r},Or.multiplyScalarAndAdd=function(r,t,o,c){return r[0]=t[0]+o[0]*c,r[1]=t[1]+o[1]*c,r[2]=t[2]+o[2]*c,r[3]=t[3]+o[3]*c,r},Or.sub=Or.mul=void 0;var Sf=function(r,t){if(r&&r.__esModule)return r;if(r===null||YC(r)!=="object"&&typeof r!="function")return{default:r};var o=YO(void 0);if(o&&o.has(r))return o.get(r);var c={},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var h in r)if(h!=="default"&&Object.prototype.hasOwnProperty.call(r,h)){var m=u?Object.getOwnPropertyDescriptor(r,h):null;m&&(m.get||m.set)?Object.defineProperty(c,h,m):c[h]=r[h]}return c.default=r,o&&o.set(r,c),c}(ro);function YO(r){if(typeof WeakMap!="function")return null;var t=new WeakMap,o=new WeakMap;return(YO=function(c){return c?o:t})(r)}function qO(r,t,o){var c=t[0],u=t[1],h=t[2],m=t[3],g=o[0],v=o[1],x=o[2],w=o[3];return r[0]=c*g+h*v,r[1]=u*g+m*v,r[2]=c*x+h*w,r[3]=u*x+m*w,r}function XO(r,t,o){return r[0]=t[0]-o[0],r[1]=t[1]-o[1],r[2]=t[2]-o[2],r[3]=t[3]-o[3],r}Or.mul=qO,Or.sub=XO;var Ur={};function qC(r){return qC=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qC(r)}Object.defineProperty(Ur,"__esModule",{value:!0}),Ur.create=function(){var r=new Yu.ARRAY_TYPE(6);return Yu.ARRAY_TYPE!=Float32Array&&(r[1]=0,r[2]=0,r[4]=0,r[5]=0),r[0]=1,r[3]=1,r},Ur.clone=function(r){var t=new Yu.ARRAY_TYPE(6);return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t},Ur.copy=function(r,t){return r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r[4]=t[4],r[5]=t[5],r},Ur.identity=function(r){return r[0]=1,r[1]=0,r[2]=0,r[3]=1,r[4]=0,r[5]=0,r},Ur.fromValues=function(r,t,o,c,u,h){var m=new Yu.ARRAY_TYPE(6);return m[0]=r,m[1]=t,m[2]=o,m[3]=c,m[4]=u,m[5]=h,m},Ur.set=function(r,t,o,c,u,h,m){return r[0]=t,r[1]=o,r[2]=c,r[3]=u,r[4]=h,r[5]=m,r},Ur.invert=function(r,t){var o=t[0],c=t[1],u=t[2],h=t[3],m=t[4],g=t[5],v=o*h-c*u;return v?(r[0]=h*(v=1/v),r[1]=-c*v,r[2]=-u*v,r[3]=o*v,r[4]=(u*g-h*m)*v,r[5]=(c*m-o*g)*v,r):null},Ur.determinant=function(r){return r[0]*r[3]-r[1]*r[2]},Ur.multiply=KO,Ur.rotate=function(r,t,o){var c=t[0],u=t[1],h=t[2],m=t[3],g=t[4],v=t[5],x=Math.sin(o),w=Math.cos(o);return r[0]=c*w+h*x,r[1]=u*w+m*x,r[2]=c*-x+h*w,r[3]=u*-x+m*w,r[4]=g,r[5]=v,r},Ur.scale=function(r,t,o){var c=t[1],u=t[2],h=t[3],m=t[4],g=t[5],v=o[0],x=o[1];return r[0]=t[0]*v,r[1]=c*v,r[2]=u*x,r[3]=h*x,r[4]=m,r[5]=g,r},Ur.translate=function(r,t,o){var c=t[0],u=t[1],h=t[2],m=t[3],g=t[4],v=t[5],x=o[0],w=o[1];return r[0]=c,r[1]=u,r[2]=h,r[3]=m,r[4]=c*x+h*w+g,r[5]=u*x+m*w+v,r},Ur.fromRotation=function(r,t){var o=Math.sin(t),c=Math.cos(t);return r[0]=c,r[1]=o,r[2]=-o,r[3]=c,r[4]=0,r[5]=0,r},Ur.fromScaling=function(r,t){return r[0]=t[0],r[1]=0,r[2]=0,r[3]=t[1],r[4]=0,r[5]=0,r},Ur.fromTranslation=function(r,t){return r[0]=1,r[1]=0,r[2]=0,r[3]=1,r[4]=t[0],r[5]=t[1],r},Ur.str=function(r){return"mat2d("+r[0]+", "+r[1]+", "+r[2]+", "+r[3]+", "+r[4]+", "+r[5]+")"},Ur.frob=function(r){return Math.hypot(r[0],r[1],r[2],r[3],r[4],r[5],1)},Ur.add=function(r,t,o){return r[0]=t[0]+o[0],r[1]=t[1]+o[1],r[2]=t[2]+o[2],r[3]=t[3]+o[3],r[4]=t[4]+o[4],r[5]=t[5]+o[5],r},Ur.subtract=JO,Ur.multiplyScalar=function(r,t,o){return r[0]=t[0]*o,r[1]=t[1]*o,r[2]=t[2]*o,r[3]=t[3]*o,r[4]=t[4]*o,r[5]=t[5]*o,r},Ur.multiplyScalarAndAdd=function(r,t,o,c){return r[0]=t[0]+o[0]*c,r[1]=t[1]+o[1]*c,r[2]=t[2]+o[2]*c,r[3]=t[3]+o[3]*c,r[4]=t[4]+o[4]*c,r[5]=t[5]+o[5]*c,r},Ur.exactEquals=function(r,t){return r[0]===t[0]&&r[1]===t[1]&&r[2]===t[2]&&r[3]===t[3]&&r[4]===t[4]&&r[5]===t[5]},Ur.equals=function(r,t){var o=r[0],c=r[1],u=r[2],h=r[3],m=r[4],g=r[5],v=t[0],x=t[1],w=t[2],E=t[3],C=t[4],I=t[5];return Math.abs(o-v)<=Yu.EPSILON*Math.max(1,Math.abs(o),Math.abs(v))&&Math.abs(c-x)<=Yu.EPSILON*Math.max(1,Math.abs(c),Math.abs(x))&&Math.abs(u-w)<=Yu.EPSILON*Math.max(1,Math.abs(u),Math.abs(w))&&Math.abs(h-E)<=Yu.EPSILON*Math.max(1,Math.abs(h),Math.abs(E))&&Math.abs(m-C)<=Yu.EPSILON*Math.max(1,Math.abs(m),Math.abs(C))&&Math.abs(g-I)<=Yu.EPSILON*Math.max(1,Math.abs(g),Math.abs(I))},Ur.sub=Ur.mul=void 0;var Yu=function(r,t){if(r&&r.__esModule)return r;if(r===null||qC(r)!=="object"&&typeof r!="function")return{default:r};var o=ZO(void 0);if(o&&o.has(r))return o.get(r);var c={},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var h in r)if(h!=="default"&&Object.prototype.hasOwnProperty.call(r,h)){var m=u?Object.getOwnPropertyDescriptor(r,h):null;m&&(m.get||m.set)?Object.defineProperty(c,h,m):c[h]=r[h]}return c.default=r,o&&o.set(r,c),c}(ro);function ZO(r){if(typeof WeakMap!="function")return null;var t=new WeakMap,o=new WeakMap;return(ZO=function(c){return c?o:t})(r)}function KO(r,t,o){var c=t[0],u=t[1],h=t[2],m=t[3],g=t[4],v=t[5],x=o[0],w=o[1],E=o[2],C=o[3],I=o[4],D=o[5];return r[0]=c*x+h*w,r[1]=u*x+m*w,r[2]=c*E+h*C,r[3]=u*E+m*C,r[4]=c*I+h*D+g,r[5]=u*I+m*D+v,r}function JO(r,t,o){return r[0]=t[0]-o[0],r[1]=t[1]-o[1],r[2]=t[2]-o[2],r[3]=t[3]-o[3],r[4]=t[4]-o[4],r[5]=t[5]-o[5],r}Ur.mul=KO,Ur.sub=JO;var Ki={};function XC(r){return XC=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},XC(r)}Object.defineProperty(Ki,"__esModule",{value:!0}),Ki.create=function(){var r=new Bl.ARRAY_TYPE(9);return Bl.ARRAY_TYPE!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[5]=0,r[6]=0,r[7]=0),r[0]=1,r[4]=1,r[8]=1,r},Ki.fromMat4=function(r,t){return r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[4],r[4]=t[5],r[5]=t[6],r[6]=t[8],r[7]=t[9],r[8]=t[10],r},Ki.clone=function(r){var t=new Bl.ARRAY_TYPE(9);return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],t},Ki.copy=function(r,t){return r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r[4]=t[4],r[5]=t[5],r[6]=t[6],r[7]=t[7],r[8]=t[8],r},Ki.fromValues=function(r,t,o,c,u,h,m,g,v){var x=new Bl.ARRAY_TYPE(9);return x[0]=r,x[1]=t,x[2]=o,x[3]=c,x[4]=u,x[5]=h,x[6]=m,x[7]=g,x[8]=v,x},Ki.set=function(r,t,o,c,u,h,m,g,v,x){return r[0]=t,r[1]=o,r[2]=c,r[3]=u,r[4]=h,r[5]=m,r[6]=g,r[7]=v,r[8]=x,r},Ki.identity=function(r){return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=1,r[5]=0,r[6]=0,r[7]=0,r[8]=1,r},Ki.transpose=function(r,t){if(r===t){var o=t[1],c=t[2],u=t[5];r[1]=t[3],r[2]=t[6],r[3]=o,r[5]=t[7],r[6]=c,r[7]=u}else r[0]=t[0],r[1]=t[3],r[2]=t[6],r[3]=t[1],r[4]=t[4],r[5]=t[7],r[6]=t[2],r[7]=t[5],r[8]=t[8];return r},Ki.invert=function(r,t){var o=t[0],c=t[1],u=t[2],h=t[3],m=t[4],g=t[5],v=t[6],x=t[7],w=t[8],E=w*m-g*x,C=-w*h+g*v,I=x*h-m*v,D=o*E+c*C+u*I;return D?(r[0]=E*(D=1/D),r[1]=(-w*c+u*x)*D,r[2]=(g*c-u*m)*D,r[3]=C*D,r[4]=(w*o-u*v)*D,r[5]=(-g*o+u*h)*D,r[6]=I*D,r[7]=(-x*o+c*v)*D,r[8]=(m*o-c*h)*D,r):null},Ki.adjoint=function(r,t){var o=t[0],c=t[1],u=t[2],h=t[3],m=t[4],g=t[5],v=t[6],x=t[7],w=t[8];return r[0]=m*w-g*x,r[1]=u*x-c*w,r[2]=c*g-u*m,r[3]=g*v-h*w,r[4]=o*w-u*v,r[5]=u*h-o*g,r[6]=h*x-m*v,r[7]=c*v-o*x,r[8]=o*m-c*h,r},Ki.determinant=function(r){var t=r[3],o=r[4],c=r[5],u=r[6],h=r[7],m=r[8];return r[0]*(m*o-c*h)+r[1]*(-m*t+c*u)+r[2]*(h*t-o*u)},Ki.multiply=eN,Ki.translate=function(r,t,o){var c=t[0],u=t[1],h=t[2],m=t[3],g=t[4],v=t[5],x=t[6],w=t[7],E=t[8],C=o[0],I=o[1];return r[0]=c,r[1]=u,r[2]=h,r[3]=m,r[4]=g,r[5]=v,r[6]=C*c+I*m+x,r[7]=C*u+I*g+w,r[8]=C*h+I*v+E,r},Ki.rotate=function(r,t,o){var c=t[0],u=t[1],h=t[2],m=t[3],g=t[4],v=t[5],x=t[6],w=t[7],E=t[8],C=Math.sin(o),I=Math.cos(o);return r[0]=I*c+C*m,r[1]=I*u+C*g,r[2]=I*h+C*v,r[3]=I*m-C*c,r[4]=I*g-C*u,r[5]=I*v-C*h,r[6]=x,r[7]=w,r[8]=E,r},Ki.scale=function(r,t,o){var c=o[0],u=o[1];return r[0]=c*t[0],r[1]=c*t[1],r[2]=c*t[2],r[3]=u*t[3],r[4]=u*t[4],r[5]=u*t[5],r[6]=t[6],r[7]=t[7],r[8]=t[8],r},Ki.fromTranslation=function(r,t){return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=1,r[5]=0,r[6]=t[0],r[7]=t[1],r[8]=1,r},Ki.fromRotation=function(r,t){var o=Math.sin(t),c=Math.cos(t);return r[0]=c,r[1]=o,r[2]=0,r[3]=-o,r[4]=c,r[5]=0,r[6]=0,r[7]=0,r[8]=1,r},Ki.fromScaling=function(r,t){return r[0]=t[0],r[1]=0,r[2]=0,r[3]=0,r[4]=t[1],r[5]=0,r[6]=0,r[7]=0,r[8]=1,r},Ki.fromMat2d=function(r,t){return r[0]=t[0],r[1]=t[1],r[2]=0,r[3]=t[2],r[4]=t[3],r[5]=0,r[6]=t[4],r[7]=t[5],r[8]=1,r},Ki.fromQuat=function(r,t){var o=t[0],c=t[1],u=t[2],h=t[3],m=o+o,g=c+c,v=u+u,x=o*m,w=c*m,E=c*g,C=u*m,I=u*g,D=u*v,N=h*m,W=h*g,V=h*v;return r[0]=1-E-D,r[3]=w-V,r[6]=C+W,r[1]=w+V,r[4]=1-x-D,r[7]=I-N,r[2]=C-W,r[5]=I+N,r[8]=1-x-E,r},Ki.normalFromMat4=function(r,t){var o=t[0],c=t[1],u=t[2],h=t[3],m=t[4],g=t[5],v=t[6],x=t[7],w=t[8],E=t[9],C=t[10],I=t[11],D=t[12],N=t[13],W=t[14],V=t[15],q=o*g-c*m,Z=o*v-u*m,K=o*x-h*m,X=c*v-u*g,J=c*x-h*g,ae=u*x-h*v,ce=w*N-E*D,ge=w*W-C*D,ve=w*V-I*D,Pe=E*W-C*N,Me=E*V-I*N,Le=C*V-I*W,Ee=q*Le-Z*Me+K*Pe+X*ve-J*ge+ae*ce;return Ee?(r[0]=(g*Le-v*Me+x*Pe)*(Ee=1/Ee),r[1]=(v*ve-m*Le-x*ge)*Ee,r[2]=(m*Me-g*ve+x*ce)*Ee,r[3]=(u*Me-c*Le-h*Pe)*Ee,r[4]=(o*Le-u*ve+h*ge)*Ee,r[5]=(c*ve-o*Me-h*ce)*Ee,r[6]=(N*ae-W*J+V*X)*Ee,r[7]=(W*K-D*ae-V*Z)*Ee,r[8]=(D*J-N*K+V*q)*Ee,r):null},Ki.projection=function(r,t,o){return r[0]=2/t,r[1]=0,r[2]=0,r[3]=0,r[4]=-2/o,r[5]=0,r[6]=-1,r[7]=1,r[8]=1,r},Ki.str=function(r){return"mat3("+r[0]+", "+r[1]+", "+r[2]+", "+r[3]+", "+r[4]+", "+r[5]+", "+r[6]+", "+r[7]+", "+r[8]+")"},Ki.frob=function(r){return Math.hypot(r[0],r[1],r[2],r[3],r[4],r[5],r[6],r[7],r[8])},Ki.add=function(r,t,o){return r[0]=t[0]+o[0],r[1]=t[1]+o[1],r[2]=t[2]+o[2],r[3]=t[3]+o[3],r[4]=t[4]+o[4],r[5]=t[5]+o[5],r[6]=t[6]+o[6],r[7]=t[7]+o[7],r[8]=t[8]+o[8],r},Ki.subtract=tN,Ki.multiplyScalar=function(r,t,o){return r[0]=t[0]*o,r[1]=t[1]*o,r[2]=t[2]*o,r[3]=t[3]*o,r[4]=t[4]*o,r[5]=t[5]*o,r[6]=t[6]*o,r[7]=t[7]*o,r[8]=t[8]*o,r},Ki.multiplyScalarAndAdd=function(r,t,o,c){return r[0]=t[0]+o[0]*c,r[1]=t[1]+o[1]*c,r[2]=t[2]+o[2]*c,r[3]=t[3]+o[3]*c,r[4]=t[4]+o[4]*c,r[5]=t[5]+o[5]*c,r[6]=t[6]+o[6]*c,r[7]=t[7]+o[7]*c,r[8]=t[8]+o[8]*c,r},Ki.exactEquals=function(r,t){return r[0]===t[0]&&r[1]===t[1]&&r[2]===t[2]&&r[3]===t[3]&&r[4]===t[4]&&r[5]===t[5]&&r[6]===t[6]&&r[7]===t[7]&&r[8]===t[8]},Ki.equals=function(r,t){var o=r[0],c=r[1],u=r[2],h=r[3],m=r[4],g=r[5],v=r[6],x=r[7],w=r[8],E=t[0],C=t[1],I=t[2],D=t[3],N=t[4],W=t[5],V=t[6],q=t[7],Z=t[8];return Math.abs(o-E)<=Bl.EPSILON*Math.max(1,Math.abs(o),Math.abs(E))&&Math.abs(c-C)<=Bl.EPSILON*Math.max(1,Math.abs(c),Math.abs(C))&&Math.abs(u-I)<=Bl.EPSILON*Math.max(1,Math.abs(u),Math.abs(I))&&Math.abs(h-D)<=Bl.EPSILON*Math.max(1,Math.abs(h),Math.abs(D))&&Math.abs(m-N)<=Bl.EPSILON*Math.max(1,Math.abs(m),Math.abs(N))&&Math.abs(g-W)<=Bl.EPSILON*Math.max(1,Math.abs(g),Math.abs(W))&&Math.abs(v-V)<=Bl.EPSILON*Math.max(1,Math.abs(v),Math.abs(V))&&Math.abs(x-q)<=Bl.EPSILON*Math.max(1,Math.abs(x),Math.abs(q))&&Math.abs(w-Z)<=Bl.EPSILON*Math.max(1,Math.abs(w),Math.abs(Z))},Ki.sub=Ki.mul=void 0;var Bl=function(r,t){if(r&&r.__esModule)return r;if(r===null||XC(r)!=="object"&&typeof r!="function")return{default:r};var o=QO(void 0);if(o&&o.has(r))return o.get(r);var c={},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var h in r)if(h!=="default"&&Object.prototype.hasOwnProperty.call(r,h)){var m=u?Object.getOwnPropertyDescriptor(r,h):null;m&&(m.get||m.set)?Object.defineProperty(c,h,m):c[h]=r[h]}return c.default=r,o&&o.set(r,c),c}(ro);function QO(r){if(typeof WeakMap!="function")return null;var t=new WeakMap,o=new WeakMap;return(QO=function(c){return c?o:t})(r)}function eN(r,t,o){var c=t[0],u=t[1],h=t[2],m=t[3],g=t[4],v=t[5],x=t[6],w=t[7],E=t[8],C=o[0],I=o[1],D=o[2],N=o[3],W=o[4],V=o[5],q=o[6],Z=o[7],K=o[8];return r[0]=C*c+I*m+D*x,r[1]=C*u+I*g+D*w,r[2]=C*h+I*v+D*E,r[3]=N*c+W*m+V*x,r[4]=N*u+W*g+V*w,r[5]=N*h+W*v+V*E,r[6]=q*c+Z*m+K*x,r[7]=q*u+Z*g+K*w,r[8]=q*h+Z*v+K*E,r}function tN(r,t,o){return r[0]=t[0]-o[0],r[1]=t[1]-o[1],r[2]=t[2]-o[2],r[3]=t[3]-o[3],r[4]=t[4]-o[4],r[5]=t[5]-o[5],r[6]=t[6]-o[6],r[7]=t[7]-o[7],r[8]=t[8]-o[8],r}Ki.mul=eN,Ki.sub=tN;var ei={};function ZC(r){return ZC=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ZC(r)}Object.defineProperty(ei,"__esModule",{value:!0}),ei.create=function(){var r=new Zr.ARRAY_TYPE(16);return Zr.ARRAY_TYPE!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=0,r[12]=0,r[13]=0,r[14]=0),r[0]=1,r[5]=1,r[10]=1,r[15]=1,r},ei.clone=function(r){var t=new Zr.ARRAY_TYPE(16);return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],t[9]=r[9],t[10]=r[10],t[11]=r[11],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15],t},ei.copy=function(r,t){return r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r[4]=t[4],r[5]=t[5],r[6]=t[6],r[7]=t[7],r[8]=t[8],r[9]=t[9],r[10]=t[10],r[11]=t[11],r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15],r},ei.fromValues=function(r,t,o,c,u,h,m,g,v,x,w,E,C,I,D,N){var W=new Zr.ARRAY_TYPE(16);return W[0]=r,W[1]=t,W[2]=o,W[3]=c,W[4]=u,W[5]=h,W[6]=m,W[7]=g,W[8]=v,W[9]=x,W[10]=w,W[11]=E,W[12]=C,W[13]=I,W[14]=D,W[15]=N,W},ei.set=function(r,t,o,c,u,h,m,g,v,x,w,E,C,I,D,N,W){return r[0]=t,r[1]=o,r[2]=c,r[3]=u,r[4]=h,r[5]=m,r[6]=g,r[7]=v,r[8]=x,r[9]=w,r[10]=E,r[11]=C,r[12]=I,r[13]=D,r[14]=N,r[15]=W,r},ei.identity=iN,ei.transpose=function(r,t){if(r===t){var o=t[1],c=t[2],u=t[3],h=t[6],m=t[7],g=t[11];r[1]=t[4],r[2]=t[8],r[3]=t[12],r[4]=o,r[6]=t[9],r[7]=t[13],r[8]=c,r[9]=h,r[11]=t[14],r[12]=u,r[13]=m,r[14]=g}else r[0]=t[0],r[1]=t[4],r[2]=t[8],r[3]=t[12],r[4]=t[1],r[5]=t[5],r[6]=t[9],r[7]=t[13],r[8]=t[2],r[9]=t[6],r[10]=t[10],r[11]=t[14],r[12]=t[3],r[13]=t[7],r[14]=t[11],r[15]=t[15];return r},ei.invert=function(r,t){var o=t[0],c=t[1],u=t[2],h=t[3],m=t[4],g=t[5],v=t[6],x=t[7],w=t[8],E=t[9],C=t[10],I=t[11],D=t[12],N=t[13],W=t[14],V=t[15],q=o*g-c*m,Z=o*v-u*m,K=o*x-h*m,X=c*v-u*g,J=c*x-h*g,ae=u*x-h*v,ce=w*N-E*D,ge=w*W-C*D,ve=w*V-I*D,Pe=E*W-C*N,Me=E*V-I*N,Le=C*V-I*W,Ee=q*Le-Z*Me+K*Pe+X*ve-J*ge+ae*ce;return Ee?(r[0]=(g*Le-v*Me+x*Pe)*(Ee=1/Ee),r[1]=(u*Me-c*Le-h*Pe)*Ee,r[2]=(N*ae-W*J+V*X)*Ee,r[3]=(C*J-E*ae-I*X)*Ee,r[4]=(v*ve-m*Le-x*ge)*Ee,r[5]=(o*Le-u*ve+h*ge)*Ee,r[6]=(W*K-D*ae-V*Z)*Ee,r[7]=(w*ae-C*K+I*Z)*Ee,r[8]=(m*Me-g*ve+x*ce)*Ee,r[9]=(c*ve-o*Me-h*ce)*Ee,r[10]=(D*J-N*K+V*q)*Ee,r[11]=(E*K-w*J-I*q)*Ee,r[12]=(g*ge-m*Pe-v*ce)*Ee,r[13]=(o*Pe-c*ge+u*ce)*Ee,r[14]=(N*Z-D*X-W*q)*Ee,r[15]=(w*X-E*Z+C*q)*Ee,r):null},ei.adjoint=function(r,t){var o=t[0],c=t[1],u=t[2],h=t[3],m=t[4],g=t[5],v=t[6],x=t[7],w=t[8],E=t[9],C=t[10],I=t[11],D=t[12],N=t[13],W=t[14],V=t[15];return r[0]=g*(C*V-I*W)-E*(v*V-x*W)+N*(v*I-x*C),r[1]=-(c*(C*V-I*W)-E*(u*V-h*W)+N*(u*I-h*C)),r[2]=c*(v*V-x*W)-g*(u*V-h*W)+N*(u*x-h*v),r[3]=-(c*(v*I-x*C)-g*(u*I-h*C)+E*(u*x-h*v)),r[4]=-(m*(C*V-I*W)-w*(v*V-x*W)+D*(v*I-x*C)),r[5]=o*(C*V-I*W)-w*(u*V-h*W)+D*(u*I-h*C),r[6]=-(o*(v*V-x*W)-m*(u*V-h*W)+D*(u*x-h*v)),r[7]=o*(v*I-x*C)-m*(u*I-h*C)+w*(u*x-h*v),r[8]=m*(E*V-I*N)-w*(g*V-x*N)+D*(g*I-x*E),r[9]=-(o*(E*V-I*N)-w*(c*V-h*N)+D*(c*I-h*E)),r[10]=o*(g*V-x*N)-m*(c*V-h*N)+D*(c*x-h*g),r[11]=-(o*(g*I-x*E)-m*(c*I-h*E)+w*(c*x-h*g)),r[12]=-(m*(E*W-C*N)-w*(g*W-v*N)+D*(g*C-v*E)),r[13]=o*(E*W-C*N)-w*(c*W-u*N)+D*(c*C-u*E),r[14]=-(o*(g*W-v*N)-m*(c*W-u*N)+D*(c*v-u*g)),r[15]=o*(g*C-v*E)-m*(c*C-u*E)+w*(c*v-u*g),r},ei.determinant=function(r){var t=r[0],o=r[1],c=r[2],u=r[3],h=r[4],m=r[5],g=r[6],v=r[7],x=r[8],w=r[9],E=r[10],C=r[11],I=r[12],D=r[13],N=r[14],W=r[15];return(t*m-o*h)*(E*W-C*N)-(t*g-c*h)*(w*W-C*D)+(t*v-u*h)*(w*N-E*D)+(o*g-c*m)*(x*W-C*I)-(o*v-u*m)*(x*N-E*I)+(c*v-u*g)*(x*D-w*I)},ei.multiply=rN,ei.translate=function(r,t,o){var c,u,h,m,g,v,x,w,E,C,I,D,N=o[0],W=o[1],V=o[2];return t===r?(r[12]=t[0]*N+t[4]*W+t[8]*V+t[12],r[13]=t[1]*N+t[5]*W+t[9]*V+t[13],r[14]=t[2]*N+t[6]*W+t[10]*V+t[14],r[15]=t[3]*N+t[7]*W+t[11]*V+t[15]):(u=t[1],h=t[2],m=t[3],g=t[4],v=t[5],x=t[6],w=t[7],E=t[8],C=t[9],I=t[10],D=t[11],r[0]=c=t[0],r[1]=u,r[2]=h,r[3]=m,r[4]=g,r[5]=v,r[6]=x,r[7]=w,r[8]=E,r[9]=C,r[10]=I,r[11]=D,r[12]=c*N+g*W+E*V+t[12],r[13]=u*N+v*W+C*V+t[13],r[14]=h*N+x*W+I*V+t[14],r[15]=m*N+w*W+D*V+t[15]),r},ei.scale=function(r,t,o){var c=o[0],u=o[1],h=o[2];return r[0]=t[0]*c,r[1]=t[1]*c,r[2]=t[2]*c,r[3]=t[3]*c,r[4]=t[4]*u,r[5]=t[5]*u,r[6]=t[6]*u,r[7]=t[7]*u,r[8]=t[8]*h,r[9]=t[9]*h,r[10]=t[10]*h,r[11]=t[11]*h,r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15],r},ei.rotate=function(r,t,o,c){var u,h,m,g,v,x,w,E,C,I,D,N,W,V,q,Z,K,X,J,ae,ce,ge,ve,Pe,Me=c[0],Le=c[1],Ee=c[2],He=Math.hypot(Me,Le,Ee);return He<Zr.EPSILON?null:(Me*=He=1/He,Le*=He,Ee*=He,u=Math.sin(o),h=Math.cos(o),v=t[1],x=t[2],w=t[3],C=t[5],I=t[6],D=t[7],W=t[9],V=t[10],q=t[11],J=Me*Le*(m=1-h)-Ee*u,ae=Le*Le*m+h,ce=Ee*Le*m+Me*u,ge=Me*Ee*m+Le*u,ve=Le*Ee*m-Me*u,Pe=Ee*Ee*m+h,r[0]=(g=t[0])*(Z=Me*Me*m+h)+(E=t[4])*(K=Le*Me*m+Ee*u)+(N=t[8])*(X=Ee*Me*m-Le*u),r[1]=v*Z+C*K+W*X,r[2]=x*Z+I*K+V*X,r[3]=w*Z+D*K+q*X,r[4]=g*J+E*ae+N*ce,r[5]=v*J+C*ae+W*ce,r[6]=x*J+I*ae+V*ce,r[7]=w*J+D*ae+q*ce,r[8]=g*ge+E*ve+N*Pe,r[9]=v*ge+C*ve+W*Pe,r[10]=x*ge+I*ve+V*Pe,r[11]=w*ge+D*ve+q*Pe,t!==r&&(r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15]),r)},ei.rotateX=function(r,t,o){var c=Math.sin(o),u=Math.cos(o),h=t[4],m=t[5],g=t[6],v=t[7],x=t[8],w=t[9],E=t[10],C=t[11];return t!==r&&(r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15]),r[4]=h*u+x*c,r[5]=m*u+w*c,r[6]=g*u+E*c,r[7]=v*u+C*c,r[8]=x*u-h*c,r[9]=w*u-m*c,r[10]=E*u-g*c,r[11]=C*u-v*c,r},ei.rotateY=function(r,t,o){var c=Math.sin(o),u=Math.cos(o),h=t[0],m=t[1],g=t[2],v=t[3],x=t[8],w=t[9],E=t[10],C=t[11];return t!==r&&(r[4]=t[4],r[5]=t[5],r[6]=t[6],r[7]=t[7],r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15]),r[0]=h*u-x*c,r[1]=m*u-w*c,r[2]=g*u-E*c,r[3]=v*u-C*c,r[8]=h*c+x*u,r[9]=m*c+w*u,r[10]=g*c+E*u,r[11]=v*c+C*u,r},ei.rotateZ=function(r,t,o){var c=Math.sin(o),u=Math.cos(o),h=t[0],m=t[1],g=t[2],v=t[3],x=t[4],w=t[5],E=t[6],C=t[7];return t!==r&&(r[8]=t[8],r[9]=t[9],r[10]=t[10],r[11]=t[11],r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15]),r[0]=h*u+x*c,r[1]=m*u+w*c,r[2]=g*u+E*c,r[3]=v*u+C*c,r[4]=x*u-h*c,r[5]=w*u-m*c,r[6]=E*u-g*c,r[7]=C*u-v*c,r},ei.fromTranslation=function(r,t){return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=t[0],r[13]=t[1],r[14]=t[2],r[15]=1,r},ei.fromScaling=function(r,t){return r[0]=t[0],r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=t[1],r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=t[2],r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r},ei.fromRotation=function(r,t,o){var c,u,h,m=o[0],g=o[1],v=o[2],x=Math.hypot(m,g,v);return x<Zr.EPSILON?null:(m*=x=1/x,g*=x,v*=x,c=Math.sin(t),u=Math.cos(t),r[0]=m*m*(h=1-u)+u,r[1]=g*m*h+v*c,r[2]=v*m*h-g*c,r[3]=0,r[4]=m*g*h-v*c,r[5]=g*g*h+u,r[6]=v*g*h+m*c,r[7]=0,r[8]=m*v*h+g*c,r[9]=g*v*h-m*c,r[10]=v*v*h+u,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r)},ei.fromXRotation=function(r,t){var o=Math.sin(t),c=Math.cos(t);return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=c,r[6]=o,r[7]=0,r[8]=0,r[9]=-o,r[10]=c,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r},ei.fromYRotation=function(r,t){var o=Math.sin(t),c=Math.cos(t);return r[0]=c,r[1]=0,r[2]=-o,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=o,r[9]=0,r[10]=c,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r},ei.fromZRotation=function(r,t){var o=Math.sin(t),c=Math.cos(t);return r[0]=c,r[1]=o,r[2]=0,r[3]=0,r[4]=-o,r[5]=c,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r},ei.fromRotationTranslation=aN,ei.fromQuat2=function(r,t){var o=new Zr.ARRAY_TYPE(3),c=-t[0],u=-t[1],h=-t[2],m=t[3],g=t[4],v=t[5],x=t[6],w=t[7],E=c*c+u*u+h*h+m*m;return E>0?(o[0]=2*(g*m+w*c+v*h-x*u)/E,o[1]=2*(v*m+w*u+x*c-g*h)/E,o[2]=2*(x*m+w*h+g*u-v*c)/E):(o[0]=2*(g*m+w*c+v*h-x*u),o[1]=2*(v*m+w*u+x*c-g*h),o[2]=2*(x*m+w*h+g*u-v*c)),aN(r,t,o),r},ei.getTranslation=function(r,t){return r[0]=t[12],r[1]=t[13],r[2]=t[14],r},ei.getScaling=oN,ei.getRotation=function(r,t){var o=new Zr.ARRAY_TYPE(3);oN(o,t);var c=1/o[0],u=1/o[1],h=1/o[2],m=t[0]*c,g=t[1]*u,v=t[2]*h,x=t[4]*c,w=t[5]*u,E=t[6]*h,C=t[8]*c,I=t[9]*u,D=t[10]*h,N=m+w+D,W=0;return N>0?(W=2*Math.sqrt(N+1),r[3]=.25*W,r[0]=(E-I)/W,r[1]=(C-v)/W,r[2]=(g-x)/W):m>w&&m>D?(W=2*Math.sqrt(1+m-w-D),r[3]=(E-I)/W,r[0]=.25*W,r[1]=(g+x)/W,r[2]=(C+v)/W):w>D?(W=2*Math.sqrt(1+w-m-D),r[3]=(C-v)/W,r[0]=(g+x)/W,r[1]=.25*W,r[2]=(E+I)/W):(W=2*Math.sqrt(1+D-m-w),r[3]=(g-x)/W,r[0]=(C+v)/W,r[1]=(E+I)/W,r[2]=.25*W),r},ei.fromRotationTranslationScale=function(r,t,o,c){var u=t[0],h=t[1],m=t[2],g=t[3],v=u+u,x=h+h,w=m+m,E=u*v,C=u*x,I=u*w,D=h*x,N=h*w,W=m*w,V=g*v,q=g*x,Z=g*w,K=c[0],X=c[1],J=c[2];return r[0]=(1-(D+W))*K,r[1]=(C+Z)*K,r[2]=(I-q)*K,r[3]=0,r[4]=(C-Z)*X,r[5]=(1-(E+W))*X,r[6]=(N+V)*X,r[7]=0,r[8]=(I+q)*J,r[9]=(N-V)*J,r[10]=(1-(E+D))*J,r[11]=0,r[12]=o[0],r[13]=o[1],r[14]=o[2],r[15]=1,r},ei.fromRotationTranslationScaleOrigin=function(r,t,o,c,u){var h=t[0],m=t[1],g=t[2],v=t[3],x=h+h,w=m+m,E=g+g,C=h*x,I=h*w,D=h*E,N=m*w,W=m*E,V=g*E,q=v*x,Z=v*w,K=v*E,X=c[0],J=c[1],ae=c[2],ce=u[0],ge=u[1],ve=u[2],Pe=(1-(N+V))*X,Me=(I+K)*X,Le=(D-Z)*X,Ee=(I-K)*J,He=(1-(C+V))*J,Ke=(W+q)*J,nt=(D+Z)*ae,Ve=(W-q)*ae,je=(1-(C+N))*ae;return r[0]=Pe,r[1]=Me,r[2]=Le,r[3]=0,r[4]=Ee,r[5]=He,r[6]=Ke,r[7]=0,r[8]=nt,r[9]=Ve,r[10]=je,r[11]=0,r[12]=o[0]+ce-(Pe*ce+Ee*ge+nt*ve),r[13]=o[1]+ge-(Me*ce+He*ge+Ve*ve),r[14]=o[2]+ve-(Le*ce+Ke*ge+je*ve),r[15]=1,r},ei.fromQuat=function(r,t){var o=t[0],c=t[1],u=t[2],h=t[3],m=o+o,g=c+c,v=u+u,x=o*m,w=c*m,E=c*g,C=u*m,I=u*g,D=u*v,N=h*m,W=h*g,V=h*v;return r[0]=1-E-D,r[1]=w+V,r[2]=C-W,r[3]=0,r[4]=w-V,r[5]=1-x-D,r[6]=I+N,r[7]=0,r[8]=C+W,r[9]=I-N,r[10]=1-x-E,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r},ei.frustum=function(r,t,o,c,u,h,m){var g=1/(o-t),v=1/(u-c),x=1/(h-m);return r[0]=2*h*g,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=2*h*v,r[6]=0,r[7]=0,r[8]=(o+t)*g,r[9]=(u+c)*v,r[10]=(m+h)*x,r[11]=-1,r[12]=0,r[13]=0,r[14]=m*h*2*x,r[15]=0,r},ei.perspectiveNO=sN,ei.perspectiveZO=function(r,t,o,c,u){var h,m=1/Math.tan(t/2);return r[0]=m/o,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=m,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=-1,r[12]=0,r[13]=0,r[15]=0,u!=null&&u!==1/0?(r[10]=u*(h=1/(c-u)),r[14]=u*c*h):(r[10]=-1,r[14]=-c),r},ei.perspectiveFromFieldOfView=function(r,t,o,c){var u=Math.tan(t.upDegrees*Math.PI/180),h=Math.tan(t.downDegrees*Math.PI/180),m=Math.tan(t.leftDegrees*Math.PI/180),g=Math.tan(t.rightDegrees*Math.PI/180),v=2/(m+g),x=2/(u+h);return r[0]=v,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=x,r[6]=0,r[7]=0,r[8]=-(m-g)*v*.5,r[9]=(u-h)*x*.5,r[10]=c/(o-c),r[11]=-1,r[12]=0,r[13]=0,r[14]=c*o/(o-c),r[15]=0,r},ei.orthoNO=lN,ei.orthoZO=function(r,t,o,c,u,h,m){var g=1/(t-o),v=1/(c-u),x=1/(h-m);return r[0]=-2*g,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=-2*v,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=x,r[11]=0,r[12]=(t+o)*g,r[13]=(u+c)*v,r[14]=h*x,r[15]=1,r},ei.lookAt=function(r,t,o,c){var u,h,m,g,v,x,w,E,C,I,D=t[0],N=t[1],W=t[2],V=c[0],q=c[1],Z=c[2],K=o[0],X=o[1],J=o[2];return Math.abs(D-K)<Zr.EPSILON&&Math.abs(N-X)<Zr.EPSILON&&Math.abs(W-J)<Zr.EPSILON?iN(r):(w=D-K,E=N-X,C=W-J,u=q*(C*=I=1/Math.hypot(w,E,C))-Z*(E*=I),h=Z*(w*=I)-V*C,m=V*E-q*w,(I=Math.hypot(u,h,m))?(u*=I=1/I,h*=I,m*=I):(u=0,h=0,m=0),g=E*m-C*h,v=C*u-w*m,x=w*h-E*u,(I=Math.hypot(g,v,x))?(g*=I=1/I,v*=I,x*=I):(g=0,v=0,x=0),r[0]=u,r[1]=g,r[2]=w,r[3]=0,r[4]=h,r[5]=v,r[6]=E,r[7]=0,r[8]=m,r[9]=x,r[10]=C,r[11]=0,r[12]=-(u*D+h*N+m*W),r[13]=-(g*D+v*N+x*W),r[14]=-(w*D+E*N+C*W),r[15]=1,r)},ei.targetTo=function(r,t,o,c){var u=t[0],h=t[1],m=t[2],g=c[0],v=c[1],x=c[2],w=u-o[0],E=h-o[1],C=m-o[2],I=w*w+E*E+C*C;I>0&&(w*=I=1/Math.sqrt(I),E*=I,C*=I);var D=v*C-x*E,N=x*w-g*C,W=g*E-v*w;return(I=D*D+N*N+W*W)>0&&(D*=I=1/Math.sqrt(I),N*=I,W*=I),r[0]=D,r[1]=N,r[2]=W,r[3]=0,r[4]=E*W-C*N,r[5]=C*D-w*W,r[6]=w*N-E*D,r[7]=0,r[8]=w,r[9]=E,r[10]=C,r[11]=0,r[12]=u,r[13]=h,r[14]=m,r[15]=1,r},ei.str=function(r){return"mat4("+r[0]+", "+r[1]+", "+r[2]+", "+r[3]+", "+r[4]+", "+r[5]+", "+r[6]+", "+r[7]+", "+r[8]+", "+r[9]+", "+r[10]+", "+r[11]+", "+r[12]+", "+r[13]+", "+r[14]+", "+r[15]+")"},ei.frob=function(r){return Math.hypot(r[0],r[1],r[2],r[3],r[4],r[5],r[6],r[7],r[8],r[9],r[10],r[11],r[12],r[13],r[14],r[15])},ei.add=function(r,t,o){return r[0]=t[0]+o[0],r[1]=t[1]+o[1],r[2]=t[2]+o[2],r[3]=t[3]+o[3],r[4]=t[4]+o[4],r[5]=t[5]+o[5],r[6]=t[6]+o[6],r[7]=t[7]+o[7],r[8]=t[8]+o[8],r[9]=t[9]+o[9],r[10]=t[10]+o[10],r[11]=t[11]+o[11],r[12]=t[12]+o[12],r[13]=t[13]+o[13],r[14]=t[14]+o[14],r[15]=t[15]+o[15],r},ei.subtract=cN,ei.multiplyScalar=function(r,t,o){return r[0]=t[0]*o,r[1]=t[1]*o,r[2]=t[2]*o,r[3]=t[3]*o,r[4]=t[4]*o,r[5]=t[5]*o,r[6]=t[6]*o,r[7]=t[7]*o,r[8]=t[8]*o,r[9]=t[9]*o,r[10]=t[10]*o,r[11]=t[11]*o,r[12]=t[12]*o,r[13]=t[13]*o,r[14]=t[14]*o,r[15]=t[15]*o,r},ei.multiplyScalarAndAdd=function(r,t,o,c){return r[0]=t[0]+o[0]*c,r[1]=t[1]+o[1]*c,r[2]=t[2]+o[2]*c,r[3]=t[3]+o[3]*c,r[4]=t[4]+o[4]*c,r[5]=t[5]+o[5]*c,r[6]=t[6]+o[6]*c,r[7]=t[7]+o[7]*c,r[8]=t[8]+o[8]*c,r[9]=t[9]+o[9]*c,r[10]=t[10]+o[10]*c,r[11]=t[11]+o[11]*c,r[12]=t[12]+o[12]*c,r[13]=t[13]+o[13]*c,r[14]=t[14]+o[14]*c,r[15]=t[15]+o[15]*c,r},ei.exactEquals=function(r,t){return r[0]===t[0]&&r[1]===t[1]&&r[2]===t[2]&&r[3]===t[3]&&r[4]===t[4]&&r[5]===t[5]&&r[6]===t[6]&&r[7]===t[7]&&r[8]===t[8]&&r[9]===t[9]&&r[10]===t[10]&&r[11]===t[11]&&r[12]===t[12]&&r[13]===t[13]&&r[14]===t[14]&&r[15]===t[15]},ei.equals=function(r,t){var o=r[0],c=r[1],u=r[2],h=r[3],m=r[4],g=r[5],v=r[6],x=r[7],w=r[8],E=r[9],C=r[10],I=r[11],D=r[12],N=r[13],W=r[14],V=r[15],q=t[0],Z=t[1],K=t[2],X=t[3],J=t[4],ae=t[5],ce=t[6],ge=t[7],ve=t[8],Pe=t[9],Me=t[10],Le=t[11],Ee=t[12],He=t[13],Ke=t[14],nt=t[15];return Math.abs(o-q)<=Zr.EPSILON*Math.max(1,Math.abs(o),Math.abs(q))&&Math.abs(c-Z)<=Zr.EPSILON*Math.max(1,Math.abs(c),Math.abs(Z))&&Math.abs(u-K)<=Zr.EPSILON*Math.max(1,Math.abs(u),Math.abs(K))&&Math.abs(h-X)<=Zr.EPSILON*Math.max(1,Math.abs(h),Math.abs(X))&&Math.abs(m-J)<=Zr.EPSILON*Math.max(1,Math.abs(m),Math.abs(J))&&Math.abs(g-ae)<=Zr.EPSILON*Math.max(1,Math.abs(g),Math.abs(ae))&&Math.abs(v-ce)<=Zr.EPSILON*Math.max(1,Math.abs(v),Math.abs(ce))&&Math.abs(x-ge)<=Zr.EPSILON*Math.max(1,Math.abs(x),Math.abs(ge))&&Math.abs(w-ve)<=Zr.EPSILON*Math.max(1,Math.abs(w),Math.abs(ve))&&Math.abs(E-Pe)<=Zr.EPSILON*Math.max(1,Math.abs(E),Math.abs(Pe))&&Math.abs(C-Me)<=Zr.EPSILON*Math.max(1,Math.abs(C),Math.abs(Me))&&Math.abs(I-Le)<=Zr.EPSILON*Math.max(1,Math.abs(I),Math.abs(Le))&&Math.abs(D-Ee)<=Zr.EPSILON*Math.max(1,Math.abs(D),Math.abs(Ee))&&Math.abs(N-He)<=Zr.EPSILON*Math.max(1,Math.abs(N),Math.abs(He))&&Math.abs(W-Ke)<=Zr.EPSILON*Math.max(1,Math.abs(W),Math.abs(Ke))&&Math.abs(V-nt)<=Zr.EPSILON*Math.max(1,Math.abs(V),Math.abs(nt))},ei.sub=ei.mul=ei.ortho=ei.perspective=void 0;var Zr=function(r,t){if(r&&r.__esModule)return r;if(r===null||ZC(r)!=="object"&&typeof r!="function")return{default:r};var o=nN(void 0);if(o&&o.has(r))return o.get(r);var c={},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var h in r)if(h!=="default"&&Object.prototype.hasOwnProperty.call(r,h)){var m=u?Object.getOwnPropertyDescriptor(r,h):null;m&&(m.get||m.set)?Object.defineProperty(c,h,m):c[h]=r[h]}return c.default=r,o&&o.set(r,c),c}(ro);function nN(r){if(typeof WeakMap!="function")return null;var t=new WeakMap,o=new WeakMap;return(nN=function(c){return c?o:t})(r)}function iN(r){return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function rN(r,t,o){var c=t[0],u=t[1],h=t[2],m=t[3],g=t[4],v=t[5],x=t[6],w=t[7],E=t[8],C=t[9],I=t[10],D=t[11],N=t[12],W=t[13],V=t[14],q=t[15],Z=o[0],K=o[1],X=o[2],J=o[3];return r[0]=Z*c+K*g+X*E+J*N,r[1]=Z*u+K*v+X*C+J*W,r[2]=Z*h+K*x+X*I+J*V,r[3]=Z*m+K*w+X*D+J*q,r[4]=(Z=o[4])*c+(K=o[5])*g+(X=o[6])*E+(J=o[7])*N,r[5]=Z*u+K*v+X*C+J*W,r[6]=Z*h+K*x+X*I+J*V,r[7]=Z*m+K*w+X*D+J*q,r[8]=(Z=o[8])*c+(K=o[9])*g+(X=o[10])*E+(J=o[11])*N,r[9]=Z*u+K*v+X*C+J*W,r[10]=Z*h+K*x+X*I+J*V,r[11]=Z*m+K*w+X*D+J*q,r[12]=(Z=o[12])*c+(K=o[13])*g+(X=o[14])*E+(J=o[15])*N,r[13]=Z*u+K*v+X*C+J*W,r[14]=Z*h+K*x+X*I+J*V,r[15]=Z*m+K*w+X*D+J*q,r}function aN(r,t,o){var c=t[0],u=t[1],h=t[2],m=t[3],g=c+c,v=u+u,x=h+h,w=c*g,E=c*v,C=c*x,I=u*v,D=u*x,N=h*x,W=m*g,V=m*v,q=m*x;return r[0]=1-(I+N),r[1]=E+q,r[2]=C-V,r[3]=0,r[4]=E-q,r[5]=1-(w+N),r[6]=D+W,r[7]=0,r[8]=C+V,r[9]=D-W,r[10]=1-(w+I),r[11]=0,r[12]=o[0],r[13]=o[1],r[14]=o[2],r[15]=1,r}function oN(r,t){var o=t[4],c=t[5],u=t[6],h=t[8],m=t[9],g=t[10];return r[0]=Math.hypot(t[0],t[1],t[2]),r[1]=Math.hypot(o,c,u),r[2]=Math.hypot(h,m,g),r}function sN(r,t,o,c,u){var h,m=1/Math.tan(t/2);return r[0]=m/o,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=m,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=-1,r[12]=0,r[13]=0,r[15]=0,u!=null&&u!==1/0?(r[10]=(u+c)*(h=1/(c-u)),r[14]=2*u*c*h):(r[10]=-1,r[14]=-2*c),r}function lN(r,t,o,c,u,h,m){var g=1/(t-o),v=1/(c-u),x=1/(h-m);return r[0]=-2*g,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=-2*v,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=2*x,r[11]=0,r[12]=(t+o)*g,r[13]=(u+c)*v,r[14]=(m+h)*x,r[15]=1,r}function cN(r,t,o){return r[0]=t[0]-o[0],r[1]=t[1]-o[1],r[2]=t[2]-o[2],r[3]=t[3]-o[3],r[4]=t[4]-o[4],r[5]=t[5]-o[5],r[6]=t[6]-o[6],r[7]=t[7]-o[7],r[8]=t[8]-o[8],r[9]=t[9]-o[9],r[10]=t[10]-o[10],r[11]=t[11]-o[11],r[12]=t[12]-o[12],r[13]=t[13]-o[13],r[14]=t[14]-o[14],r[15]=t[15]-o[15],r}ei.perspective=sN,ei.ortho=lN,ei.mul=rN,ei.sub=cN;var Yn={},Jn={};function KC(r){return KC=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},KC(r)}Object.defineProperty(Jn,"__esModule",{value:!0}),Jn.create=dN,Jn.clone=function(r){var t=new ah.ARRAY_TYPE(3);return t[0]=r[0],t[1]=r[1],t[2]=r[2],t},Jn.length=hN,Jn.fromValues=function(r,t,o){var c=new ah.ARRAY_TYPE(3);return c[0]=r,c[1]=t,c[2]=o,c},Jn.copy=function(r,t){return r[0]=t[0],r[1]=t[1],r[2]=t[2],r},Jn.set=function(r,t,o,c){return r[0]=t,r[1]=o,r[2]=c,r},Jn.add=function(r,t,o){return r[0]=t[0]+o[0],r[1]=t[1]+o[1],r[2]=t[2]+o[2],r},Jn.subtract=fN,Jn.multiply=pN,Jn.divide=mN,Jn.ceil=function(r,t){return r[0]=Math.ceil(t[0]),r[1]=Math.ceil(t[1]),r[2]=Math.ceil(t[2]),r},Jn.floor=function(r,t){return r[0]=Math.floor(t[0]),r[1]=Math.floor(t[1]),r[2]=Math.floor(t[2]),r},Jn.min=function(r,t,o){return r[0]=Math.min(t[0],o[0]),r[1]=Math.min(t[1],o[1]),r[2]=Math.min(t[2],o[2]),r},Jn.max=function(r,t,o){return r[0]=Math.max(t[0],o[0]),r[1]=Math.max(t[1],o[1]),r[2]=Math.max(t[2],o[2]),r},Jn.round=function(r,t){return r[0]=Math.round(t[0]),r[1]=Math.round(t[1]),r[2]=Math.round(t[2]),r},Jn.scale=function(r,t,o){return r[0]=t[0]*o,r[1]=t[1]*o,r[2]=t[2]*o,r},Jn.scaleAndAdd=function(r,t,o,c){return r[0]=t[0]+o[0]*c,r[1]=t[1]+o[1]*c,r[2]=t[2]+o[2]*c,r},Jn.distance=gN,Jn.squaredDistance=yN,Jn.squaredLength=vN,Jn.negate=function(r,t){return r[0]=-t[0],r[1]=-t[1],r[2]=-t[2],r},Jn.inverse=function(r,t){return r[0]=1/t[0],r[1]=1/t[1],r[2]=1/t[2],r},Jn.normalize=function(r,t){var o=t[0],c=t[1],u=t[2],h=o*o+c*c+u*u;return h>0&&(h=1/Math.sqrt(h)),r[0]=t[0]*h,r[1]=t[1]*h,r[2]=t[2]*h,r},Jn.dot=_N,Jn.cross=function(r,t,o){var c=t[0],u=t[1],h=t[2],m=o[0],g=o[1],v=o[2];return r[0]=u*v-h*g,r[1]=h*m-c*v,r[2]=c*g-u*m,r},Jn.lerp=function(r,t,o,c){var u=t[0],h=t[1],m=t[2];return r[0]=u+c*(o[0]-u),r[1]=h+c*(o[1]-h),r[2]=m+c*(o[2]-m),r},Jn.hermite=function(r,t,o,c,u,h){var m=h*h,g=m*(2*h-3)+1,v=m*(h-2)+h,x=m*(h-1),w=m*(3-2*h);return r[0]=t[0]*g+o[0]*v+c[0]*x+u[0]*w,r[1]=t[1]*g+o[1]*v+c[1]*x+u[1]*w,r[2]=t[2]*g+o[2]*v+c[2]*x+u[2]*w,r},Jn.bezier=function(r,t,o,c,u,h){var m=1-h,g=m*m,v=h*h,x=g*m,w=3*h*g,E=3*v*m,C=v*h;return r[0]=t[0]*x+o[0]*w+c[0]*E+u[0]*C,r[1]=t[1]*x+o[1]*w+c[1]*E+u[1]*C,r[2]=t[2]*x+o[2]*w+c[2]*E+u[2]*C,r},Jn.random=function(r,t){t=t||1;var o=2*ah.RANDOM()*Math.PI,c=2*ah.RANDOM()-1,u=Math.sqrt(1-c*c)*t;return r[0]=Math.cos(o)*u,r[1]=Math.sin(o)*u,r[2]=c*t,r},Jn.transformMat4=function(r,t,o){var c=t[0],u=t[1],h=t[2],m=o[3]*c+o[7]*u+o[11]*h+o[15];return r[0]=(o[0]*c+o[4]*u+o[8]*h+o[12])/(m=m||1),r[1]=(o[1]*c+o[5]*u+o[9]*h+o[13])/m,r[2]=(o[2]*c+o[6]*u+o[10]*h+o[14])/m,r},Jn.transformMat3=function(r,t,o){var c=t[0],u=t[1],h=t[2];return r[0]=c*o[0]+u*o[3]+h*o[6],r[1]=c*o[1]+u*o[4]+h*o[7],r[2]=c*o[2]+u*o[5]+h*o[8],r},Jn.transformQuat=function(r,t,o){var c=o[0],u=o[1],h=o[2],m=t[0],g=t[1],v=t[2],x=u*v-h*g,w=h*m-c*v,E=c*g-u*m,C=u*E-h*w,I=h*x-c*E,D=c*w-u*x,N=2*o[3];return w*=N,E*=N,I*=2,D*=2,r[0]=m+(x*=N)+(C*=2),r[1]=g+w+I,r[2]=v+E+D,r},Jn.rotateX=function(r,t,o,c){var u=[],h=[];return u[0]=t[0]-o[0],u[1]=t[1]-o[1],u[2]=t[2]-o[2],h[0]=u[0],h[1]=u[1]*Math.cos(c)-u[2]*Math.sin(c),h[2]=u[1]*Math.sin(c)+u[2]*Math.cos(c),r[0]=h[0]+o[0],r[1]=h[1]+o[1],r[2]=h[2]+o[2],r},Jn.rotateY=function(r,t,o,c){var u=[],h=[];return u[0]=t[0]-o[0],u[1]=t[1]-o[1],u[2]=t[2]-o[2],h[0]=u[2]*Math.sin(c)+u[0]*Math.cos(c),h[1]=u[1],h[2]=u[2]*Math.cos(c)-u[0]*Math.sin(c),r[0]=h[0]+o[0],r[1]=h[1]+o[1],r[2]=h[2]+o[2],r},Jn.rotateZ=function(r,t,o,c){var u=[],h=[];return u[0]=t[0]-o[0],u[1]=t[1]-o[1],u[2]=t[2]-o[2],h[0]=u[0]*Math.cos(c)-u[1]*Math.sin(c),h[1]=u[0]*Math.sin(c)+u[1]*Math.cos(c),h[2]=u[2],r[0]=h[0]+o[0],r[1]=h[1]+o[1],r[2]=h[2]+o[2],r},Jn.angle=function(r,t){var o=r[0],c=r[1],u=r[2],h=t[0],m=t[1],g=t[2],v=Math.sqrt(o*o+c*c+u*u)*Math.sqrt(h*h+m*m+g*g),x=v&&_N(r,t)/v;return Math.acos(Math.min(Math.max(x,-1),1))},Jn.zero=function(r){return r[0]=0,r[1]=0,r[2]=0,r},Jn.str=function(r){return"vec3("+r[0]+", "+r[1]+", "+r[2]+")"},Jn.exactEquals=function(r,t){return r[0]===t[0]&&r[1]===t[1]&&r[2]===t[2]},Jn.equals=function(r,t){var o=r[0],c=r[1],u=r[2],h=t[0],m=t[1],g=t[2];return Math.abs(o-h)<=ah.EPSILON*Math.max(1,Math.abs(o),Math.abs(h))&&Math.abs(c-m)<=ah.EPSILON*Math.max(1,Math.abs(c),Math.abs(m))&&Math.abs(u-g)<=ah.EPSILON*Math.max(1,Math.abs(u),Math.abs(g))},Jn.forEach=Jn.sqrLen=Jn.len=Jn.sqrDist=Jn.dist=Jn.div=Jn.mul=Jn.sub=void 0;var ah=function(r,t){if(r&&r.__esModule)return r;if(r===null||KC(r)!=="object"&&typeof r!="function")return{default:r};var o=uN(void 0);if(o&&o.has(r))return o.get(r);var c={},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var h in r)if(h!=="default"&&Object.prototype.hasOwnProperty.call(r,h)){var m=u?Object.getOwnPropertyDescriptor(r,h):null;m&&(m.get||m.set)?Object.defineProperty(c,h,m):c[h]=r[h]}return c.default=r,o&&o.set(r,c),c}(ro);function uN(r){if(typeof WeakMap!="function")return null;var t=new WeakMap,o=new WeakMap;return(uN=function(c){return c?o:t})(r)}function dN(){var r=new ah.ARRAY_TYPE(3);return ah.ARRAY_TYPE!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0),r}function hN(r){return Math.hypot(r[0],r[1],r[2])}function fN(r,t,o){return r[0]=t[0]-o[0],r[1]=t[1]-o[1],r[2]=t[2]-o[2],r}function pN(r,t,o){return r[0]=t[0]*o[0],r[1]=t[1]*o[1],r[2]=t[2]*o[2],r}function mN(r,t,o){return r[0]=t[0]/o[0],r[1]=t[1]/o[1],r[2]=t[2]/o[2],r}function gN(r,t){return Math.hypot(t[0]-r[0],t[1]-r[1],t[2]-r[2])}function yN(r,t){var o=t[0]-r[0],c=t[1]-r[1],u=t[2]-r[2];return o*o+c*c+u*u}function vN(r){var t=r[0],o=r[1],c=r[2];return t*t+o*o+c*c}function _N(r,t){return r[0]*t[0]+r[1]*t[1]+r[2]*t[2]}Jn.sub=fN,Jn.mul=pN,Jn.div=mN,Jn.dist=gN,Jn.sqrDist=yN,Jn.len=hN,Jn.sqrLen=vN;var oh,uee=(oh=dN(),function(r,t,o,c,u,h){var m,g;for(t||(t=3),o||(o=0),g=c?Math.min(c*t+o,r.length):r.length,m=o;m<g;m+=t)oh[0]=r[m],oh[1]=r[m+1],oh[2]=r[m+2],u(oh,oh,h),r[m]=oh[0],r[m+1]=oh[1],r[m+2]=oh[2];return r});Jn.forEach=uee;var yi={};function JC(r){return JC=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},JC(r)}Object.defineProperty(yi,"__esModule",{value:!0}),yi.create=bN,yi.clone=function(r){var t=new vc.ARRAY_TYPE(4);return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t},yi.fromValues=function(r,t,o,c){var u=new vc.ARRAY_TYPE(4);return u[0]=r,u[1]=t,u[2]=o,u[3]=c,u},yi.copy=function(r,t){return r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r},yi.set=function(r,t,o,c,u){return r[0]=t,r[1]=o,r[2]=c,r[3]=u,r},yi.add=function(r,t,o){return r[0]=t[0]+o[0],r[1]=t[1]+o[1],r[2]=t[2]+o[2],r[3]=t[3]+o[3],r},yi.subtract=wN,yi.multiply=SN,yi.divide=EN,yi.ceil=function(r,t){return r[0]=Math.ceil(t[0]),r[1]=Math.ceil(t[1]),r[2]=Math.ceil(t[2]),r[3]=Math.ceil(t[3]),r},yi.floor=function(r,t){return r[0]=Math.floor(t[0]),r[1]=Math.floor(t[1]),r[2]=Math.floor(t[2]),r[3]=Math.floor(t[3]),r},yi.min=function(r,t,o){return r[0]=Math.min(t[0],o[0]),r[1]=Math.min(t[1],o[1]),r[2]=Math.min(t[2],o[2]),r[3]=Math.min(t[3],o[3]),r},yi.max=function(r,t,o){return r[0]=Math.max(t[0],o[0]),r[1]=Math.max(t[1],o[1]),r[2]=Math.max(t[2],o[2]),r[3]=Math.max(t[3],o[3]),r},yi.round=function(r,t){return r[0]=Math.round(t[0]),r[1]=Math.round(t[1]),r[2]=Math.round(t[2]),r[3]=Math.round(t[3]),r},yi.scale=function(r,t,o){return r[0]=t[0]*o,r[1]=t[1]*o,r[2]=t[2]*o,r[3]=t[3]*o,r},yi.scaleAndAdd=function(r,t,o,c){return r[0]=t[0]+o[0]*c,r[1]=t[1]+o[1]*c,r[2]=t[2]+o[2]*c,r[3]=t[3]+o[3]*c,r},yi.distance=MN,yi.squaredDistance=TN,yi.length=AN,yi.squaredLength=CN,yi.negate=function(r,t){return r[0]=-t[0],r[1]=-t[1],r[2]=-t[2],r[3]=-t[3],r},yi.inverse=function(r,t){return r[0]=1/t[0],r[1]=1/t[1],r[2]=1/t[2],r[3]=1/t[3],r},yi.normalize=function(r,t){var o=t[0],c=t[1],u=t[2],h=t[3],m=o*o+c*c+u*u+h*h;return m>0&&(m=1/Math.sqrt(m)),r[0]=o*m,r[1]=c*m,r[2]=u*m,r[3]=h*m,r},yi.dot=function(r,t){return r[0]*t[0]+r[1]*t[1]+r[2]*t[2]+r[3]*t[3]},yi.cross=function(r,t,o,c){var u=o[0]*c[1]-o[1]*c[0],h=o[0]*c[2]-o[2]*c[0],m=o[0]*c[3]-o[3]*c[0],g=o[1]*c[2]-o[2]*c[1],v=o[1]*c[3]-o[3]*c[1],x=o[2]*c[3]-o[3]*c[2],w=t[0],E=t[1],C=t[2],I=t[3];return r[0]=E*x-C*v+I*g,r[1]=-w*x+C*m-I*h,r[2]=w*v-E*m+I*u,r[3]=-w*g+E*h-C*u,r},yi.lerp=function(r,t,o,c){var u=t[0],h=t[1],m=t[2],g=t[3];return r[0]=u+c*(o[0]-u),r[1]=h+c*(o[1]-h),r[2]=m+c*(o[2]-m),r[3]=g+c*(o[3]-g),r},yi.random=function(r,t){var o,c,u,h,m,g;t=t||1;do m=(o=2*vc.RANDOM()-1)*o+(c=2*vc.RANDOM()-1)*c;while(m>=1);do g=(u=2*vc.RANDOM()-1)*u+(h=2*vc.RANDOM()-1)*h;while(g>=1);var v=Math.sqrt((1-m)/g);return r[0]=t*o,r[1]=t*c,r[2]=t*u*v,r[3]=t*h*v,r},yi.transformMat4=function(r,t,o){var c=t[0],u=t[1],h=t[2],m=t[3];return r[0]=o[0]*c+o[4]*u+o[8]*h+o[12]*m,r[1]=o[1]*c+o[5]*u+o[9]*h+o[13]*m,r[2]=o[2]*c+o[6]*u+o[10]*h+o[14]*m,r[3]=o[3]*c+o[7]*u+o[11]*h+o[15]*m,r},yi.transformQuat=function(r,t,o){var c=t[0],u=t[1],h=t[2],m=o[0],g=o[1],v=o[2],x=o[3],w=x*c+g*h-v*u,E=x*u+v*c-m*h,C=x*h+m*u-g*c,I=-m*c-g*u-v*h;return r[0]=w*x+I*-m+E*-v-C*-g,r[1]=E*x+I*-g+C*-m-w*-v,r[2]=C*x+I*-v+w*-g-E*-m,r[3]=t[3],r},yi.zero=function(r){return r[0]=0,r[1]=0,r[2]=0,r[3]=0,r},yi.str=function(r){return"vec4("+r[0]+", "+r[1]+", "+r[2]+", "+r[3]+")"},yi.exactEquals=function(r,t){return r[0]===t[0]&&r[1]===t[1]&&r[2]===t[2]&&r[3]===t[3]},yi.equals=function(r,t){var o=r[0],c=r[1],u=r[2],h=r[3],m=t[0],g=t[1],v=t[2],x=t[3];return Math.abs(o-m)<=vc.EPSILON*Math.max(1,Math.abs(o),Math.abs(m))&&Math.abs(c-g)<=vc.EPSILON*Math.max(1,Math.abs(c),Math.abs(g))&&Math.abs(u-v)<=vc.EPSILON*Math.max(1,Math.abs(u),Math.abs(v))&&Math.abs(h-x)<=vc.EPSILON*Math.max(1,Math.abs(h),Math.abs(x))},yi.forEach=yi.sqrLen=yi.len=yi.sqrDist=yi.dist=yi.div=yi.mul=yi.sub=void 0;var vc=function(r,t){if(r&&r.__esModule)return r;if(r===null||JC(r)!=="object"&&typeof r!="function")return{default:r};var o=xN(void 0);if(o&&o.has(r))return o.get(r);var c={},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var h in r)if(h!=="default"&&Object.prototype.hasOwnProperty.call(r,h)){var m=u?Object.getOwnPropertyDescriptor(r,h):null;m&&(m.get||m.set)?Object.defineProperty(c,h,m):c[h]=r[h]}return c.default=r,o&&o.set(r,c),c}(ro);function xN(r){if(typeof WeakMap!="function")return null;var t=new WeakMap,o=new WeakMap;return(xN=function(c){return c?o:t})(r)}function bN(){var r=new vc.ARRAY_TYPE(4);return vc.ARRAY_TYPE!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0,r[3]=0),r}function wN(r,t,o){return r[0]=t[0]-o[0],r[1]=t[1]-o[1],r[2]=t[2]-o[2],r[3]=t[3]-o[3],r}function SN(r,t,o){return r[0]=t[0]*o[0],r[1]=t[1]*o[1],r[2]=t[2]*o[2],r[3]=t[3]*o[3],r}function EN(r,t,o){return r[0]=t[0]/o[0],r[1]=t[1]/o[1],r[2]=t[2]/o[2],r[3]=t[3]/o[3],r}function MN(r,t){return Math.hypot(t[0]-r[0],t[1]-r[1],t[2]-r[2],t[3]-r[3])}function TN(r,t){var o=t[0]-r[0],c=t[1]-r[1],u=t[2]-r[2],h=t[3]-r[3];return o*o+c*c+u*u+h*h}function AN(r){return Math.hypot(r[0],r[1],r[2],r[3])}function CN(r){var t=r[0],o=r[1],c=r[2],u=r[3];return t*t+o*o+c*c+u*u}yi.sub=wN,yi.mul=SN,yi.div=EN,yi.dist=MN,yi.sqrDist=TN,yi.len=AN,yi.sqrLen=CN;var dee=function(){var r=bN();return function(t,o,c,u,h,m){var g,v;for(o||(o=4),c||(c=0),v=u?Math.min(u*o+c,t.length):t.length,g=c;g<v;g+=o)r[0]=t[g],r[1]=t[g+1],r[2]=t[g+2],r[3]=t[g+3],h(r,r,m),t[g]=r[0],t[g+1]=r[1],t[g+2]=r[2],t[g+3]=r[3];return t}}();function QC(r){return QC=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},QC(r)}yi.forEach=dee,Object.defineProperty(Yn,"__esModule",{value:!0}),Yn.create=eP,Yn.identity=function(r){return r[0]=0,r[1]=0,r[2]=0,r[3]=1,r},Yn.setAxisAngle=IN,Yn.getAxisAngle=function(r,t){var o=2*Math.acos(t[3]),c=Math.sin(o/2);return c>Am.EPSILON?(r[0]=t[0]/c,r[1]=t[1]/c,r[2]=t[2]/c):(r[0]=1,r[1]=0,r[2]=0),o},Yn.getAngle=function(r,t){var o=ON(r,t);return Math.acos(2*o*o-1)},Yn.multiply=RN,Yn.rotateX=function(r,t,o){o*=.5;var c=t[0],u=t[1],h=t[2],m=t[3],g=Math.sin(o),v=Math.cos(o);return r[0]=c*v+m*g,r[1]=u*v+h*g,r[2]=h*v-u*g,r[3]=m*v-c*g,r},Yn.rotateY=function(r,t,o){o*=.5;var c=t[0],u=t[1],h=t[2],m=t[3],g=Math.sin(o),v=Math.cos(o);return r[0]=c*v-h*g,r[1]=u*v+m*g,r[2]=h*v+c*g,r[3]=m*v-u*g,r},Yn.rotateZ=function(r,t,o){o*=.5;var c=t[0],u=t[1],h=t[2],m=t[3],g=Math.sin(o),v=Math.cos(o);return r[0]=c*v+u*g,r[1]=u*v-c*g,r[2]=h*v+m*g,r[3]=m*v-h*g,r},Yn.calculateW=function(r,t){var o=t[0],c=t[1],u=t[2];return r[0]=o,r[1]=c,r[2]=u,r[3]=Math.sqrt(Math.abs(1-o*o-c*c-u*u)),r},Yn.exp=LN,Yn.ln=kN,Yn.pow=function(r,t,o){return kN(r,t),zN(r,r,o),LN(r,r),r},Yn.slerp=NS,Yn.random=function(r){var t=Am.RANDOM(),o=Am.RANDOM(),c=Am.RANDOM(),u=Math.sqrt(1-t),h=Math.sqrt(t);return r[0]=u*Math.sin(2*Math.PI*o),r[1]=u*Math.cos(2*Math.PI*o),r[2]=h*Math.sin(2*Math.PI*c),r[3]=h*Math.cos(2*Math.PI*c),r},Yn.invert=function(r,t){var o=t[0],c=t[1],u=t[2],h=t[3],m=o*o+c*c+u*u+h*h,g=m?1/m:0;return r[0]=-o*g,r[1]=-c*g,r[2]=-u*g,r[3]=h*g,r},Yn.conjugate=function(r,t){return r[0]=-t[0],r[1]=-t[1],r[2]=-t[2],r[3]=t[3],r},Yn.fromMat3=DN,Yn.fromEuler=function(r,t,o,c){var u=.5*Math.PI/180;t*=u,o*=u,c*=u;var h=Math.sin(t),m=Math.cos(t),g=Math.sin(o),v=Math.cos(o),x=Math.sin(c),w=Math.cos(c);return r[0]=h*v*w-m*g*x,r[1]=m*g*w+h*v*x,r[2]=m*v*x-h*g*w,r[3]=m*v*w+h*g*x,r},Yn.str=function(r){return"quat("+r[0]+", "+r[1]+", "+r[2]+", "+r[3]+")"},Yn.setAxes=Yn.sqlerp=Yn.rotationTo=Yn.equals=Yn.exactEquals=Yn.normalize=Yn.sqrLen=Yn.squaredLength=Yn.len=Yn.length=Yn.lerp=Yn.dot=Yn.scale=Yn.mul=Yn.add=Yn.set=Yn.copy=Yn.fromValues=Yn.clone=void 0;var Am=OS(ro),hee=OS(Ki),sh=OS(Jn),Ul=OS(yi);function PN(r){if(typeof WeakMap!="function")return null;var t=new WeakMap,o=new WeakMap;return(PN=function(c){return c?o:t})(r)}function OS(r,t){if(!t&&r&&r.__esModule)return r;if(r===null||QC(r)!=="object"&&typeof r!="function")return{default:r};var o=PN(t);if(o&&o.has(r))return o.get(r);var c={},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var h in r)if(h!=="default"&&Object.prototype.hasOwnProperty.call(r,h)){var m=u?Object.getOwnPropertyDescriptor(r,h):null;m&&(m.get||m.set)?Object.defineProperty(c,h,m):c[h]=r[h]}return c.default=r,o&&o.set(r,c),c}function eP(){var r=new Am.ARRAY_TYPE(4);return Am.ARRAY_TYPE!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0),r[3]=1,r}function IN(r,t,o){o*=.5;var c=Math.sin(o);return r[0]=c*t[0],r[1]=c*t[1],r[2]=c*t[2],r[3]=Math.cos(o),r}function RN(r,t,o){var c=t[0],u=t[1],h=t[2],m=t[3],g=o[0],v=o[1],x=o[2],w=o[3];return r[0]=c*w+m*g+u*x-h*v,r[1]=u*w+m*v+h*g-c*x,r[2]=h*w+m*x+c*v-u*g,r[3]=m*w-c*g-u*v-h*x,r}function LN(r,t){var o=t[0],c=t[1],u=t[2],h=t[3],m=Math.sqrt(o*o+c*c+u*u),g=Math.exp(h),v=m>0?g*Math.sin(m)/m:0;return r[0]=o*v,r[1]=c*v,r[2]=u*v,r[3]=g*Math.cos(m),r}function kN(r,t){var o=t[0],c=t[1],u=t[2],h=t[3],m=Math.sqrt(o*o+c*c+u*u),g=m>0?Math.atan2(m,h)/m:0;return r[0]=o*g,r[1]=c*g,r[2]=u*g,r[3]=.5*Math.log(o*o+c*c+u*u+h*h),r}function NS(r,t,o,c){var u,h,m,g,v,x=t[0],w=t[1],E=t[2],C=t[3],I=o[0],D=o[1],N=o[2],W=o[3];return(h=x*I+w*D+E*N+C*W)<0&&(h=-h,I=-I,D=-D,N=-N,W=-W),1-h>Am.EPSILON?(u=Math.acos(h),m=Math.sin(u),g=Math.sin((1-c)*u)/m,v=Math.sin(c*u)/m):(g=1-c,v=c),r[0]=g*x+v*I,r[1]=g*w+v*D,r[2]=g*E+v*N,r[3]=g*C+v*W,r}function DN(r,t){var o,c=t[0]+t[4]+t[8];if(c>0)o=Math.sqrt(c+1),r[3]=.5*o,r[0]=(t[5]-t[7])*(o=.5/o),r[1]=(t[6]-t[2])*o,r[2]=(t[1]-t[3])*o;else{var u=0;t[4]>t[0]&&(u=1),t[8]>t[3*u+u]&&(u=2);var h=(u+1)%3,m=(u+2)%3;o=Math.sqrt(t[3*u+u]-t[3*h+h]-t[3*m+m]+1),r[u]=.5*o,r[3]=(t[3*h+m]-t[3*m+h])*(o=.5/o),r[h]=(t[3*h+u]+t[3*u+h])*o,r[m]=(t[3*m+u]+t[3*u+m])*o}return r}Yn.clone=Ul.clone,Yn.fromValues=Ul.fromValues,Yn.copy=Ul.copy,Yn.set=Ul.set,Yn.add=Ul.add,Yn.mul=RN;var zN=Ul.scale;Yn.scale=zN;var ON=Ul.dot;Yn.dot=ON,Yn.lerp=Ul.lerp;var NN=Ul.length;Yn.length=NN,Yn.len=NN;var FN=Ul.squaredLength;Yn.squaredLength=FN,Yn.sqrLen=FN;var tP=Ul.normalize;Yn.normalize=tP,Yn.exactEquals=Ul.exactEquals,Yn.equals=Ul.equals;var Kc,BN,UN,fee=(Kc=sh.create(),BN=sh.fromValues(1,0,0),UN=sh.fromValues(0,1,0),function(r,t,o){var c=sh.dot(t,o);return c<-.999999?(sh.cross(Kc,BN,t),sh.len(Kc)<1e-6&&sh.cross(Kc,UN,t),sh.normalize(Kc,Kc),IN(r,Kc,Math.PI),r):c>.999999?(r[0]=0,r[1]=0,r[2]=0,r[3]=1,r):(sh.cross(Kc,t,o),r[0]=Kc[0],r[1]=Kc[1],r[2]=Kc[2],r[3]=1+c,tP(r,r))});Yn.rotationTo=fee;var nP,iP,pee=(nP=eP(),iP=eP(),function(r,t,o,c,u,h){return NS(nP,t,u,h),NS(iP,o,c,h),NS(r,nP,iP,2*h*(1-h)),r});Yn.sqlerp=pee;var Jc,mee=(Jc=hee.create(),function(r,t,o,c){return Jc[0]=o[0],Jc[3]=o[1],Jc[6]=o[2],Jc[1]=c[0],Jc[4]=c[1],Jc[7]=c[2],Jc[2]=-t[0],Jc[5]=-t[1],Jc[8]=-t[2],tP(r,DN(r,Jc))});Yn.setAxes=mee;var Si={};function rP(r){return rP=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rP(r)}Object.defineProperty(Si,"__esModule",{value:!0}),Si.create=function(){var r=new Fs.ARRAY_TYPE(8);return Fs.ARRAY_TYPE!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0,r[4]=0,r[5]=0,r[6]=0,r[7]=0),r[3]=1,r},Si.clone=function(r){var t=new Fs.ARRAY_TYPE(8);return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t},Si.fromValues=function(r,t,o,c,u,h,m,g){var v=new Fs.ARRAY_TYPE(8);return v[0]=r,v[1]=t,v[2]=o,v[3]=c,v[4]=u,v[5]=h,v[6]=m,v[7]=g,v},Si.fromRotationTranslationValues=function(r,t,o,c,u,h,m){var g=new Fs.ARRAY_TYPE(8);g[0]=r,g[1]=t,g[2]=o,g[3]=c;var v=.5*u,x=.5*h,w=.5*m;return g[4]=v*c+x*o-w*t,g[5]=x*c+w*r-v*o,g[6]=w*c+v*t-x*r,g[7]=-v*r-x*t-w*o,g},Si.fromRotationTranslation=GN,Si.fromTranslation=function(r,t){return r[0]=0,r[1]=0,r[2]=0,r[3]=1,r[4]=.5*t[0],r[5]=.5*t[1],r[6]=.5*t[2],r[7]=0,r},Si.fromRotation=function(r,t){return r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r[4]=0,r[5]=0,r[6]=0,r[7]=0,r},Si.fromMat4=function(r,t){var o=lh.create();WN.getRotation(o,t);var c=new Fs.ARRAY_TYPE(3);return WN.getTranslation(c,t),GN(r,o,c),r},Si.copy=HN,Si.identity=function(r){return r[0]=0,r[1]=0,r[2]=0,r[3]=1,r[4]=0,r[5]=0,r[6]=0,r[7]=0,r},Si.set=function(r,t,o,c,u,h,m,g,v){return r[0]=t,r[1]=o,r[2]=c,r[3]=u,r[4]=h,r[5]=m,r[6]=g,r[7]=v,r},Si.getDual=function(r,t){return r[0]=t[4],r[1]=t[5],r[2]=t[6],r[3]=t[7],r},Si.setDual=function(r,t){return r[4]=t[0],r[5]=t[1],r[6]=t[2],r[7]=t[3],r},Si.getTranslation=function(r,t){var o=t[4],c=t[5],u=t[6],h=t[7],m=-t[0],g=-t[1],v=-t[2],x=t[3];return r[0]=2*(o*x+h*m+c*v-u*g),r[1]=2*(c*x+h*g+u*m-o*v),r[2]=2*(u*x+h*v+o*g-c*m),r},Si.translate=function(r,t,o){var c=t[0],u=t[1],h=t[2],m=t[3],g=.5*o[0],v=.5*o[1],x=.5*o[2],w=t[4],E=t[5],C=t[6],I=t[7];return r[0]=c,r[1]=u,r[2]=h,r[3]=m,r[4]=m*g+u*x-h*v+w,r[5]=m*v+h*g-c*x+E,r[6]=m*x+c*v-u*g+C,r[7]=-c*g-u*v-h*x+I,r},Si.rotateX=function(r,t,o){var c=-t[0],u=-t[1],h=-t[2],m=t[3],g=t[4],v=t[5],x=t[6],w=t[7],E=g*m+w*c+v*h-x*u,C=v*m+w*u+x*c-g*h,I=x*m+w*h+g*u-v*c,D=w*m-g*c-v*u-x*h;return lh.rotateX(r,t,o),r[4]=E*(m=r[3])+D*(c=r[0])+C*(h=r[2])-I*(u=r[1]),r[5]=C*m+D*u+I*c-E*h,r[6]=I*m+D*h+E*u-C*c,r[7]=D*m-E*c-C*u-I*h,r},Si.rotateY=function(r,t,o){var c=-t[0],u=-t[1],h=-t[2],m=t[3],g=t[4],v=t[5],x=t[6],w=t[7],E=g*m+w*c+v*h-x*u,C=v*m+w*u+x*c-g*h,I=x*m+w*h+g*u-v*c,D=w*m-g*c-v*u-x*h;return lh.rotateY(r,t,o),r[4]=E*(m=r[3])+D*(c=r[0])+C*(h=r[2])-I*(u=r[1]),r[5]=C*m+D*u+I*c-E*h,r[6]=I*m+D*h+E*u-C*c,r[7]=D*m-E*c-C*u-I*h,r},Si.rotateZ=function(r,t,o){var c=-t[0],u=-t[1],h=-t[2],m=t[3],g=t[4],v=t[5],x=t[6],w=t[7],E=g*m+w*c+v*h-x*u,C=v*m+w*u+x*c-g*h,I=x*m+w*h+g*u-v*c,D=w*m-g*c-v*u-x*h;return lh.rotateZ(r,t,o),r[4]=E*(m=r[3])+D*(c=r[0])+C*(h=r[2])-I*(u=r[1]),r[5]=C*m+D*u+I*c-E*h,r[6]=I*m+D*h+E*u-C*c,r[7]=D*m-E*c-C*u-I*h,r},Si.rotateByQuatAppend=function(r,t,o){var c=o[0],u=o[1],h=o[2],m=o[3],g=t[0],v=t[1],x=t[2],w=t[3];return r[0]=g*m+w*c+v*h-x*u,r[1]=v*m+w*u+x*c-g*h,r[2]=x*m+w*h+g*u-v*c,r[3]=w*m-g*c-v*u-x*h,r[4]=(g=t[4])*m+(w=t[7])*c+(v=t[5])*h-(x=t[6])*u,r[5]=v*m+w*u+x*c-g*h,r[6]=x*m+w*h+g*u-v*c,r[7]=w*m-g*c-v*u-x*h,r},Si.rotateByQuatPrepend=function(r,t,o){var c=t[0],u=t[1],h=t[2],m=t[3],g=o[0],v=o[1],x=o[2],w=o[3];return r[0]=c*w+m*g+u*x-h*v,r[1]=u*w+m*v+h*g-c*x,r[2]=h*w+m*x+c*v-u*g,r[3]=m*w-c*g-u*v-h*x,r[4]=c*(w=o[7])+m*(g=o[4])+u*(x=o[6])-h*(v=o[5]),r[5]=u*w+m*v+h*g-c*x,r[6]=h*w+m*x+c*v-u*g,r[7]=m*w-c*g-u*v-h*x,r},Si.rotateAroundAxis=function(r,t,o,c){if(Math.abs(c)<Fs.EPSILON)return HN(r,t);var u=Math.hypot(o[0],o[1],o[2]);c*=.5;var h=Math.sin(c),m=h*o[0]/u,g=h*o[1]/u,v=h*o[2]/u,x=Math.cos(c),w=t[0],E=t[1],C=t[2],I=t[3];r[0]=w*x+I*m+E*v-C*g,r[1]=E*x+I*g+C*m-w*v,r[2]=C*x+I*v+w*g-E*m,r[3]=I*x-w*m-E*g-C*v;var D=t[4],N=t[5],W=t[6],V=t[7];return r[4]=D*x+V*m+N*v-W*g,r[5]=N*x+V*g+W*m-D*v,r[6]=W*x+V*v+D*g-N*m,r[7]=V*x-D*m-N*g-W*v,r},Si.add=function(r,t,o){return r[0]=t[0]+o[0],r[1]=t[1]+o[1],r[2]=t[2]+o[2],r[3]=t[3]+o[3],r[4]=t[4]+o[4],r[5]=t[5]+o[5],r[6]=t[6]+o[6],r[7]=t[7]+o[7],r},Si.multiply=jN,Si.scale=function(r,t,o){return r[0]=t[0]*o,r[1]=t[1]*o,r[2]=t[2]*o,r[3]=t[3]*o,r[4]=t[4]*o,r[5]=t[5]*o,r[6]=t[6]*o,r[7]=t[7]*o,r},Si.lerp=function(r,t,o,c){var u=1-c;return $N(t,o)<0&&(c=-c),r[0]=t[0]*u+o[0]*c,r[1]=t[1]*u+o[1]*c,r[2]=t[2]*u+o[2]*c,r[3]=t[3]*u+o[3]*c,r[4]=t[4]*u+o[4]*c,r[5]=t[5]*u+o[5]*c,r[6]=t[6]*u+o[6]*c,r[7]=t[7]*u+o[7]*c,r},Si.invert=function(r,t){var o=FS(t);return r[0]=-t[0]/o,r[1]=-t[1]/o,r[2]=-t[2]/o,r[3]=t[3]/o,r[4]=-t[4]/o,r[5]=-t[5]/o,r[6]=-t[6]/o,r[7]=t[7]/o,r},Si.conjugate=function(r,t){return r[0]=-t[0],r[1]=-t[1],r[2]=-t[2],r[3]=t[3],r[4]=-t[4],r[5]=-t[5],r[6]=-t[6],r[7]=t[7],r},Si.normalize=function(r,t){var o=FS(t);if(o>0){o=Math.sqrt(o);var c=t[0]/o,u=t[1]/o,h=t[2]/o,m=t[3]/o,g=t[4],v=t[5],x=t[6],w=t[7],E=c*g+u*v+h*x+m*w;r[0]=c,r[1]=u,r[2]=h,r[3]=m,r[4]=(g-c*E)/o,r[5]=(v-u*E)/o,r[6]=(x-h*E)/o,r[7]=(w-m*E)/o}return r},Si.str=function(r){return"quat2("+r[0]+", "+r[1]+", "+r[2]+", "+r[3]+", "+r[4]+", "+r[5]+", "+r[6]+", "+r[7]+")"},Si.exactEquals=function(r,t){return r[0]===t[0]&&r[1]===t[1]&&r[2]===t[2]&&r[3]===t[3]&&r[4]===t[4]&&r[5]===t[5]&&r[6]===t[6]&&r[7]===t[7]},Si.equals=function(r,t){var o=r[0],c=r[1],u=r[2],h=r[3],m=r[4],g=r[5],v=r[6],x=r[7],w=t[0],E=t[1],C=t[2],I=t[3],D=t[4],N=t[5],W=t[6],V=t[7];return Math.abs(o-w)<=Fs.EPSILON*Math.max(1,Math.abs(o),Math.abs(w))&&Math.abs(c-E)<=Fs.EPSILON*Math.max(1,Math.abs(c),Math.abs(E))&&Math.abs(u-C)<=Fs.EPSILON*Math.max(1,Math.abs(u),Math.abs(C))&&Math.abs(h-I)<=Fs.EPSILON*Math.max(1,Math.abs(h),Math.abs(I))&&Math.abs(m-D)<=Fs.EPSILON*Math.max(1,Math.abs(m),Math.abs(D))&&Math.abs(g-N)<=Fs.EPSILON*Math.max(1,Math.abs(g),Math.abs(N))&&Math.abs(v-W)<=Fs.EPSILON*Math.max(1,Math.abs(v),Math.abs(W))&&Math.abs(x-V)<=Fs.EPSILON*Math.max(1,Math.abs(x),Math.abs(V))},Si.sqrLen=Si.squaredLength=Si.len=Si.length=Si.dot=Si.mul=Si.setReal=Si.getReal=void 0;var Fs=aP(ro),lh=aP(Yn),WN=aP(ei);function VN(r){if(typeof WeakMap!="function")return null;var t=new WeakMap,o=new WeakMap;return(VN=function(c){return c?o:t})(r)}function aP(r,t){if(!t&&r&&r.__esModule)return r;if(r===null||rP(r)!=="object"&&typeof r!="function")return{default:r};var o=VN(t);if(o&&o.has(r))return o.get(r);var c={},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var h in r)if(h!=="default"&&Object.prototype.hasOwnProperty.call(r,h)){var m=u?Object.getOwnPropertyDescriptor(r,h):null;m&&(m.get||m.set)?Object.defineProperty(c,h,m):c[h]=r[h]}return c.default=r,o&&o.set(r,c),c}function GN(r,t,o){var c=.5*o[0],u=.5*o[1],h=.5*o[2],m=t[0],g=t[1],v=t[2],x=t[3];return r[0]=m,r[1]=g,r[2]=v,r[3]=x,r[4]=c*x+u*v-h*g,r[5]=u*x+h*m-c*v,r[6]=h*x+c*g-u*m,r[7]=-c*m-u*g-h*v,r}function HN(r,t){return r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r[4]=t[4],r[5]=t[5],r[6]=t[6],r[7]=t[7],r}function jN(r,t,o){var c=t[0],u=t[1],h=t[2],m=t[3],g=o[4],v=o[5],x=o[6],w=o[7],E=t[4],C=t[5],I=t[6],D=t[7],N=o[0],W=o[1],V=o[2],q=o[3];return r[0]=c*q+m*N+u*V-h*W,r[1]=u*q+m*W+h*N-c*V,r[2]=h*q+m*V+c*W-u*N,r[3]=m*q-c*N-u*W-h*V,r[4]=c*w+m*g+u*x-h*v+E*q+D*N+C*V-I*W,r[5]=u*w+m*v+h*g-c*x+C*q+D*W+I*N-E*V,r[6]=h*w+m*x+c*v-u*g+I*q+D*V+E*W-C*N,r[7]=m*w-c*g-u*v-h*x+D*q-E*N-C*W-I*V,r}Si.getReal=lh.copy,Si.setReal=lh.copy,Si.mul=jN;var $N=lh.dot;Si.dot=$N;var YN=lh.length;Si.length=YN,Si.len=YN;var FS=lh.squaredLength;Si.squaredLength=FS,Si.sqrLen=FS;var ci={};function oP(r){return oP=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},oP(r)}Object.defineProperty(ci,"__esModule",{value:!0}),ci.create=XN,ci.clone=function(r){var t=new Cm.ARRAY_TYPE(2);return t[0]=r[0],t[1]=r[1],t},ci.fromValues=function(r,t){var o=new Cm.ARRAY_TYPE(2);return o[0]=r,o[1]=t,o},ci.copy=function(r,t){return r[0]=t[0],r[1]=t[1],r},ci.set=function(r,t,o){return r[0]=t,r[1]=o,r},ci.add=function(r,t,o){return r[0]=t[0]+o[0],r[1]=t[1]+o[1],r},ci.subtract=ZN,ci.multiply=KN,ci.divide=JN,ci.ceil=function(r,t){return r[0]=Math.ceil(t[0]),r[1]=Math.ceil(t[1]),r},ci.floor=function(r,t){return r[0]=Math.floor(t[0]),r[1]=Math.floor(t[1]),r},ci.min=function(r,t,o){return r[0]=Math.min(t[0],o[0]),r[1]=Math.min(t[1],o[1]),r},ci.max=function(r,t,o){return r[0]=Math.max(t[0],o[0]),r[1]=Math.max(t[1],o[1]),r},ci.round=function(r,t){return r[0]=Math.round(t[0]),r[1]=Math.round(t[1]),r},ci.scale=function(r,t,o){return r[0]=t[0]*o,r[1]=t[1]*o,r},ci.scaleAndAdd=function(r,t,o,c){return r[0]=t[0]+o[0]*c,r[1]=t[1]+o[1]*c,r},ci.distance=QN,ci.squaredDistance=eF,ci.length=tF,ci.squaredLength=nF,ci.negate=function(r,t){return r[0]=-t[0],r[1]=-t[1],r},ci.inverse=function(r,t){return r[0]=1/t[0],r[1]=1/t[1],r},ci.normalize=function(r,t){var o=t[0],c=t[1],u=o*o+c*c;return u>0&&(u=1/Math.sqrt(u)),r[0]=t[0]*u,r[1]=t[1]*u,r},ci.dot=function(r,t){return r[0]*t[0]+r[1]*t[1]},ci.cross=function(r,t,o){var c=t[0]*o[1]-t[1]*o[0];return r[0]=r[1]=0,r[2]=c,r},ci.lerp=function(r,t,o,c){var u=t[0],h=t[1];return r[0]=u+c*(o[0]-u),r[1]=h+c*(o[1]-h),r},ci.random=function(r,t){t=t||1;var o=2*Cm.RANDOM()*Math.PI;return r[0]=Math.cos(o)*t,r[1]=Math.sin(o)*t,r},ci.transformMat2=function(r,t,o){var c=t[0],u=t[1];return r[0]=o[0]*c+o[2]*u,r[1]=o[1]*c+o[3]*u,r},ci.transformMat2d=function(r,t,o){var c=t[0],u=t[1];return r[0]=o[0]*c+o[2]*u+o[4],r[1]=o[1]*c+o[3]*u+o[5],r},ci.transformMat3=function(r,t,o){var c=t[0],u=t[1];return r[0]=o[0]*c+o[3]*u+o[6],r[1]=o[1]*c+o[4]*u+o[7],r},ci.transformMat4=function(r,t,o){var c=t[0],u=t[1];return r[0]=o[0]*c+o[4]*u+o[12],r[1]=o[1]*c+o[5]*u+o[13],r},ci.rotate=function(r,t,o,c){var u=t[0]-o[0],h=t[1]-o[1],m=Math.sin(c),g=Math.cos(c);return r[0]=u*g-h*m+o[0],r[1]=u*m+h*g+o[1],r},ci.angle=function(r,t){var o=r[0],c=r[1],u=t[0],h=t[1],m=Math.sqrt(o*o+c*c)*Math.sqrt(u*u+h*h);return Math.acos(Math.min(Math.max(m&&(o*u+c*h)/m,-1),1))},ci.zero=function(r){return r[0]=0,r[1]=0,r},ci.str=function(r){return"vec2("+r[0]+", "+r[1]+")"},ci.exactEquals=function(r,t){return r[0]===t[0]&&r[1]===t[1]},ci.equals=function(r,t){var o=r[0],c=r[1],u=t[0],h=t[1];return Math.abs(o-u)<=Cm.EPSILON*Math.max(1,Math.abs(o),Math.abs(u))&&Math.abs(c-h)<=Cm.EPSILON*Math.max(1,Math.abs(c),Math.abs(h))},ci.forEach=ci.sqrLen=ci.sqrDist=ci.dist=ci.div=ci.mul=ci.sub=ci.len=void 0;var Cm=function(r,t){if(r&&r.__esModule)return r;if(r===null||oP(r)!=="object"&&typeof r!="function")return{default:r};var o=qN(void 0);if(o&&o.has(r))return o.get(r);var c={},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var h in r)if(h!=="default"&&Object.prototype.hasOwnProperty.call(r,h)){var m=u?Object.getOwnPropertyDescriptor(r,h):null;m&&(m.get||m.set)?Object.defineProperty(c,h,m):c[h]=r[h]}return c.default=r,o&&o.set(r,c),c}(ro);function qN(r){if(typeof WeakMap!="function")return null;var t=new WeakMap,o=new WeakMap;return(qN=function(c){return c?o:t})(r)}function XN(){var r=new Cm.ARRAY_TYPE(2);return Cm.ARRAY_TYPE!=Float32Array&&(r[0]=0,r[1]=0),r}function ZN(r,t,o){return r[0]=t[0]-o[0],r[1]=t[1]-o[1],r}function KN(r,t,o){return r[0]=t[0]*o[0],r[1]=t[1]*o[1],r}function JN(r,t,o){return r[0]=t[0]/o[0],r[1]=t[1]/o[1],r}function QN(r,t){return Math.hypot(t[0]-r[0],t[1]-r[1])}function eF(r,t){var o=t[0]-r[0],c=t[1]-r[1];return o*o+c*c}function tF(r){return Math.hypot(r[0],r[1])}function nF(r){var t=r[0],o=r[1];return t*t+o*o}ci.len=tF,ci.sub=ZN,ci.mul=KN,ci.div=JN,ci.dist=QN,ci.sqrDist=eF,ci.sqrLen=nF;var gee=function(){var r=XN();return function(t,o,c,u,h,m){var g,v;for(o||(o=2),c||(c=0),v=u?Math.min(u*o+c,t.length):t.length,g=c;g<v;g+=o)r[0]=t[g],r[1]=t[g+1],h(r,r,m),t[g]=r[0],t[g+1]=r[1];return t}}();function sP(r){return sP=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sP(r)}ci.forEach=gee,Object.defineProperty(io,"__esModule",{value:!0});var Yi=io.vec4=De=io.vec3=io.vec2=io.quat2=Po=io.quat=at=io.mat4=Bs=io.mat3=io.mat2d=uv=io.mat2=io.glMatrix=void 0,yee=qu(ro);io.glMatrix=yee;var vee=qu(Or),uv=io.mat2=vee,_ee=qu(Ur);io.mat2d=_ee;var xee=qu(Ki),Bs=io.mat3=xee,bee=qu(ei),at=io.mat4=bee,wee=qu(Yn),Po=io.quat=wee,See=qu(Si);io.quat2=See;var Eee=qu(ci);io.vec2=Eee;var Mee=qu(Jn),De=io.vec3=Mee,Tee=qu(yi);function iF(r){if(typeof WeakMap!="function")return null;var t=new WeakMap,o=new WeakMap;return(iF=function(c){return c?o:t})(r)}function qu(r,t){if(!t&&r&&r.__esModule)return r;if(r===null||sP(r)!=="object"&&typeof r!="function")return{default:r};var o=iF(t);if(o&&o.has(r))return o.get(r);var c={},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var h in r)if(h!=="default"&&Object.prototype.hasOwnProperty.call(r,h)){var m=u?Object.getOwnPropertyDescriptor(r,h):null;m&&(m.get||m.set)?Object.defineProperty(c,h,m):c[h]=r[h]}return c.default=r,o&&o.set(r,c),c}Yi=io.vec4=Tee;const Aee=B([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:BS}=Aee,rF=B([{name:"a_pos_3",components:3,type:"Int16"}]);var Ef=B([{name:"a_pos",type:"Int16",components:2}]),aF={};(function(r,t){(function(o){function c(h,m,g){var v=u(256*h,256*(m=Math.pow(2,g)-m-1),g),x=u(256*(h+1),256*(m+1),g);return v[0]+","+v[1]+","+x[0]+","+x[1]}function u(h,m,g){var v=2*Math.PI*6378137/256/Math.pow(2,g);return[h*v-2*Math.PI*6378137/2,m*v-2*Math.PI*6378137/2]}o.getURL=function(h,m,g,v,x,w){return w=w||{},h+"?"+["bbox="+c(g,v,x),"format="+(w.format||"image/png"),"service="+(w.service||"WMS"),"version="+(w.version||"1.1.1"),"request="+(w.request||"GetMap"),"srs="+(w.srs||"EPSG:3857"),"width="+(w.width||256),"height="+(w.height||256),"layers="+m].join("&")},o.getTileBBox=c,o.getMercCoords=u,Object.defineProperty(o,"__esModule",{value:!0})})(t)})(0,aF);var Cee=aF;class Xu{constructor(t,o,c){this.z=t,this.x=o,this.y=c,this.key=m1(0,t,t,o,c)}equals(t){return this.z===t.z&&this.x===t.x&&this.y===t.y}url(t,o){const c=Cee.getTileBBox(this.x,this.y,this.z),u=function(h,m,g){let v,x="";for(let w=h;w>0;w--)v=1<<w-1,x+=(m&v?1:0)+(g&v?2:0);return x}(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(o==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",u).replace("{bbox-epsg-3857}",c)}toString(){return`${this.z}/${this.x}/${this.y}`}}class lP{constructor(t,o){this.wrap=t,this.canonical=o,this.key=m1(t,o.z,o.z,o.x,o.y)}}class ki{constructor(t,o,c,u,h){this.overscaledZ=t,this.wrap=o,this.canonical=new Xu(c,+u,+h),this.key=o===0&&t===c?this.canonical.key:m1(o,t,c,u,h)}equals(t){return this.overscaledZ===t.overscaledZ&&this.wrap===t.wrap&&this.canonical.equals(t.canonical)}scaledTo(t){const o=this.canonical.z-t;return t>this.canonical.z?new ki(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new ki(t,this.wrap,t,this.canonical.x>>o,this.canonical.y>>o)}calculateScaledKey(t,o=!0){if(this.overscaledZ===t&&o)return this.key;if(t>this.canonical.z)return m1(this.wrap*+o,t,this.canonical.z,this.canonical.x,this.canonical.y);{const c=this.canonical.z-t;return m1(this.wrap*+o,t,t,this.canonical.x>>c,this.canonical.y>>c)}}isChildOf(t){if(t.wrap!==this.wrap)return!1;const o=this.canonical.z-t.canonical.z;return t.overscaledZ===0||t.overscaledZ<this.overscaledZ&&t.canonical.z<this.canonical.z&&t.canonical.x===this.canonical.x>>o&&t.canonical.y===this.canonical.y>>o}children(t){if(this.overscaledZ>=t)return[new ki(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const o=this.canonical.z+1,c=2*this.canonical.x,u=2*this.canonical.y;return[new ki(o,this.wrap,o,c,u),new ki(o,this.wrap,o,c+1,u),new ki(o,this.wrap,o,c,u+1),new ki(o,this.wrap,o,c+1,u+1)]}isLessThan(t){return this.wrap<t.wrap||!(this.wrap>t.wrap)&&(this.overscaledZ<t.overscaledZ||!(this.overscaledZ>t.overscaledZ)&&(this.canonical.x<t.canonical.x||!(this.canonical.x>t.canonical.x)&&this.canonical.y<t.canonical.y))}wrapped(){return new ki(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(t){return new ki(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new lP(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function m1(r,t,o,c,u){const h=1<<Math.min(o,22);let m=h*(u%h)+c%h;return r&&o<22&&(m+=h*h*((r<0?-2*r-1:2*r)%(1<<2*(22-o)))),16*(32*m+o)+(t-o)}const oF=[r=>{let t=r.canonical.x-1,o=r.wrap;return t<0&&(t=(1<<r.canonical.z)-1,o--),new ki(r.overscaledZ,o,r.canonical.z,t,r.canonical.y)},r=>{let t=r.canonical.x+1,o=r.wrap;return t===1<<r.canonical.z&&(t=0,o++),new ki(r.overscaledZ,o,r.canonical.z,t,r.canonical.y)},r=>new ki(r.overscaledZ,r.wrap,r.canonical.z,r.canonical.x,(r.canonical.y===0?1<<r.canonical.z:r.canonical.y)-1),r=>new ki(r.overscaledZ,r.wrap,r.canonical.z,r.canonical.x,r.canonical.y===(1<<r.canonical.z)-1?0:r.canonical.y+1)];dn(Xu,"CanonicalTileID"),dn(ki,"OverscaledTileID",{omit:["projMatrix"]});class US{constructor(t,o){this.pos=t,this.dir=o}intersectsPlane(t,o,c){const u=De.dot(o,this.dir);if(Math.abs(u)<1e-6)return!1;const h=((t[0]-this.pos[0])*o[0]+(t[1]-this.pos[1])*o[1]+(t[2]-this.pos[2])*o[2])/u;return c[0]=this.pos[0]+this.dir[0]*h,c[1]=this.pos[1]+this.dir[1]*h,c[2]=this.pos[2]+this.dir[2]*h,!0}closestPointOnSphere(t,o,c){if(De.equals(this.pos,t)||o===0)return c[0]=c[1]=c[2]=0,!1;const[u,h,m]=this.dir,g=this.pos[0]-t[0],v=this.pos[1]-t[1],x=this.pos[2]-t[2],w=u*u+h*h+m*m,E=2*(g*u+v*h+x*m),C=E*E-4*w*(g*g+v*v+x*x-o*o);if(C<0){const I=Math.max(-E/2,0),D=g+u*I,N=v+h*I,W=x+m*I,V=Math.hypot(D,N,W);return c[0]=D*o/V,c[1]=N*o/V,c[2]=W*o/V,!1}{const I=(-E-Math.sqrt(C))/(2*w);if(I<0){const D=Math.hypot(g,v,x);return c[0]=g*o/D,c[1]=v*o/D,c[2]=x*o/D,!1}return c[0]=g+u*I,c[1]=v+h*I,c[2]=x+m*I,!0}}}class cP{constructor(t,o,c,u,h){this.TL=t,this.TR=o,this.BR=c,this.BL=u,this.horizon=h}static fromInvProjectionMatrix(t,o,c){const u=[-1,1,1],h=[1,1,1],m=[1,-1,1],g=[-1,-1,1],v=De.transformMat4(u,u,t),x=De.transformMat4(h,h,t),w=De.transformMat4(m,m,t),E=De.transformMat4(g,g,t);return new cP(v,x,w,E,o/c)}}function g1(r,t,o){let c=1/0,u=-1/0;const h=[];for(const m of r){De.sub(h,m,t);const g=De.dot(h,o);c=Math.min(c,g),u=Math.max(u,g)}return[c,u]}function sF(r,t){let o=!0;for(let c=0;c<r.planes.length;c++){const u=r.planes[c];let h=0;for(let m=0;m<t.length;m++)h+=De.dot(u,t[m])+u[3]>=0;if(h===0)return 0;h!==t.length&&(o=!1)}return o?2:1}function lF(r,t){for(const o of r.projections){const c=g1(t,r.points[0],o.axis);if(o.projection[1]<c[0]||o.projection[0]>c[1])return 0}return 1}function cF(r,t){let o=0;const c=[0,0,0,0];for(let u=0;u<r.length;u++)c[0]=r[u][0],c[1]=r[u][1],c[2]=r[u][2],c[3]=1,Yi.dot(c,t)>=0&&o++;return o}class ch{constructor(t,o){this.points=t||new Array(8).fill([0,0,0]),this.planes=o||new Array(6).fill([0,0,0,0]),this.bounds=_r.fromPoints(this.points),this.projections=[],this.frustumEdges=[De.sub([],this.points[2],this.points[3]),De.sub([],this.points[0],this.points[3]),De.sub([],this.points[4],this.points[0]),De.sub([],this.points[5],this.points[1]),De.sub([],this.points[6],this.points[2]),De.sub([],this.points[7],this.points[3])];for(const c of this.frustumEdges){const u=[0,-c[2],c[1]],h=[c[2],0,-c[0]];this.projections.push({axis:u,projection:g1(this.points,this.points[0],u)}),this.projections.push({axis:h,projection:g1(this.points,this.points[0],h)})}}static fromInvProjectionMatrix(t,o,c,u){const h=Math.pow(2,c),m=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(x=>{const w=Yi.transformMat4([],x,t),E=1/w[3]/o*h;return Yi.mul(w,w,[E,E,u?1/w[3]:E,E])}),g=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(x=>{const w=De.sub([],m[x[0]],m[x[1]]),E=De.sub([],m[x[2]],m[x[1]]),C=De.normalize([],De.cross([],w,E)),I=-De.dot(C,m[x[1]]);return C.concat(I)}),v=[];for(let x=0;x<m.length;x++)v.push([m[x][0],m[x][1],m[x][2]]);return new ch(v,g)}intersectsPrecise(t,o,c){for(let u=0;u<o.length;u++)if(!cF(t,o[u]))return 0;for(let u=0;u<this.planes.length;u++)if(!cF(t,this.planes[u]))return 0;for(const u of c)for(const h of this.frustumEdges){const m=De.cross([],u,h),g=De.length(m);if(g===0)continue;De.scale(m,m,1/g);const v=g1(this.points,this.points[0],m),x=g1(t,this.points[0],m);if(v[0]>x[1]||x[0]>v[1])return 0}return 1}}class _r{static fromPoints(t){const o=[1/0,1/0,1/0],c=[-1/0,-1/0,-1/0];for(const u of t)De.min(o,o,u),De.max(c,c,u);return new _r(o,c)}static fromTileIdAndHeight(t,o,c){const u=1<<t.canonical.z,h=t.canonical.x,m=t.canonical.y;return new _r([h/u,m/u,o],[(h+1)/u,(m+1)/u,c])}static applyTransform(t,o){const c=t.getCorners();for(let u=0;u<c.length;++u)De.transformMat4(c[u],c[u],o);return _r.fromPoints(c)}static projectAabbCorners(t,o){const c=t.getCorners();for(let u=0;u<c.length;++u)De.transformMat4(c[u],c[u],o);return c}constructor(t,o){this.min=t,this.max=o,this.center=De.scale([],De.add([],this.min,this.max),.5)}quadrant(t){const o=[t%2==0,t<2],c=De.clone(this.min),u=De.clone(this.max);for(let h=0;h<o.length;h++)c[h]=o[h]?this.min[h]:this.center[h],u[h]=o[h]?this.center[h]:this.max[h];return u[2]=this.max[2],new _r(c,u)}distanceX(t){return Math.max(Math.min(this.max[0],t[0]),this.min[0])-t[0]}distanceY(t){return Math.max(Math.min(this.max[1],t[1]),this.min[1])-t[1]}distanceZ(t){return Math.max(Math.min(this.max[2],t[2]),this.min[2])-t[2]}getCorners(){const t=this.min,o=this.max;return[[t[0],t[1],t[2]],[o[0],t[1],t[2]],[o[0],o[1],t[2]],[t[0],o[1],t[2]],[t[0],t[1],o[2]],[o[0],t[1],o[2]],[o[0],o[1],o[2]],[t[0],o[1],o[2]]]}intersects(t){return this.intersectsAabb(t.bounds)?sF(t,this.getCorners()):0}intersectsFlat(t){return this.intersectsAabb(t.bounds)?sF(t,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsPrecise(t,o){return o||this.intersects(t)?lF(t,this.getCorners()):0}intersectsPreciseFlat(t,o){return o||this.intersectsFlat(t)?lF(t,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsAabb(t){for(let o=0;o<3;++o)if(this.min[o]>t.max[o]||t.min[o]>this.max[o])return!1;return!0}intersectsAabbXY(t){return!(this.min[0]>t.max[0]||t.min[0]>this.max[0]||this.min[1]>t.max[1]||t.min[1]>this.max[1])}encapsulate(t){for(let o=0;o<3;o++)this.min[o]=Math.min(this.min[o],t.min[o]),this.max[o]=Math.max(this.max[o],t.max[o])}encapsulatePoint(t){for(let o=0;o<3;o++)this.min[o]=Math.min(this.min[o],t[o]),this.max[o]=Math.max(this.max[o],t[o])}closestPoint(t){return[Math.max(Math.min(this.max[0],t[0]),this.min[0]),Math.max(Math.min(this.max[1],t[1]),this.min[1]),Math.max(Math.min(this.max[2],t[2]),this.min[2])]}}dn(_r,"Aabb");const y1=5,Mf=6,fs=mt/Math.PI/2,Pee=16383,dv=64,uP=[dv,32,16],_c=-fs,xc=fs,Iee=[new _r([_c,_c,_c],[xc,xc,xc]),new _r([_c,_c,_c],[0,0,xc]),new _r([0,_c,_c],[xc,0,xc]),new _r([_c,0,_c],[0,xc,xc]),new _r([0,0,_c],[xc,xc,xc])];function WS(r){return r*fs/fv}function uF(r,t,o,c=!0){const u=De.scale([],r._camera.position,r.worldSize),h=[t,o,1,1];Yi.transformMat4(h,h,r.pixelMatrixInverse),Yi.scale(h,h,1/h[3]);const m=De.sub([],h,u),g=De.normalize([],m),v=r.globeMatrix,x=[v[12],v[13],v[14]],w=De.sub([],x,u),E=De.length(w),C=De.normalize([],w),I=r.worldSize/(2*Math.PI),D=De.dot(C,g),N=Math.asin(I/E);if(N<Math.acos(D)){if(!c)return null;const Pe=[],Me=[];De.scale(Pe,g,E/D),De.normalize(Me,De.sub(Me,Pe,w)),De.normalize(g,De.add(g,w,De.scale(g,Me,Math.tan(N)*E)))}const W=[];new US(u,g).closestPointOnSphere(x,I,W);const V=De.normalize([],Mt(v,0)),q=De.normalize([],Mt(v,1)),Z=De.normalize([],Mt(v,2)),K=De.dot(V,W),X=De.dot(q,W),J=De.dot(Z,W),ae=fe(Math.asin(-X/I));let ce=fe(Math.atan2(K,J));ce=r.center.lng+function(Pe,Me){const Le=(Me-Pe+180)%360-180;return Le<-180?Le+360:Le}(r.center.lng,ce);const ge=xo(ce),ve=re(Io(ae),0,1);return new bi(ge,ve)}class Ree{constructor(t,o,c){this.a=De.sub([],t,c),this.b=De.sub([],o,c),this.center=c;const u=De.normalize([],this.a),h=De.normalize([],this.b);this.angle=Math.acos(De.dot(u,h))}}function dP(r,t){if(r.angle===0)return null;let o;return o=r.a[t]===0?1/r.angle*.5*Math.PI:1/r.angle*Math.atan(r.b[t]/r.a[t]/Math.sin(r.angle)-1/Math.tan(r.angle)),o<0||o>1?null:function(c,u,h,m){const g=Math.sin(h);return c*(Math.sin((1-m)*h)/g)+u*(Math.sin(m*h)/g)}(r.a[t],r.b[t],r.angle,re(o,0,1))+r.center[t]}function bc(r){if(r.z<=1)return Iee[r.z+2*r.y+r.x];const t=fP(VS(r));return _r.fromPoints(t)}function uh(r,t,o){return De.scale(r,r,1-o),De.scaleAndAdd(r,r,t,o)}function dF(r,t){const o=_o(t.zoom);if(o===0)return bc(r);const c=VS(r),u=fP(c),h=xo(c.getWest())*t.worldSize,m=xo(c.getEast())*t.worldSize,g=Io(c.getNorth())*t.worldSize,v=Io(c.getSouth())*t.worldSize,x=[h,g,0],w=[m,g,0],E=[h,v,0],C=[m,v,0],I=at.invert([],t.globeMatrix);return De.transformMat4(x,x,I),De.transformMat4(w,w,I),De.transformMat4(E,E,I),De.transformMat4(C,C,I),u[0]=uh(u[0],E,o),u[1]=uh(u[1],C,o),u[2]=uh(u[2],w,o),u[3]=uh(u[3],x,o),_r.fromPoints(u)}function hF(r,t,o){for(const c of r)De.transformMat4(c,c,t),De.scale(c,c,o)}function hP(r,t,o,c){const u=t/r.worldSize,h=r.globeMatrix;if(o.z<=1){const ge=bc(o).getCorners();return hF(ge,h,u),_r.fromPoints(ge)}const m=VS(o,c),g=fP(m);hF(g,h,u);const v=Number.MAX_VALUE,x=[-v,-v,-v],w=[v,v,v];if(m.contains(r.center)){for(const Pe of g)De.min(w,w,Pe),De.max(x,x,Pe);x[2]=0;const ge=r.point,ve=[ge.x*u,ge.y*u,0];return De.min(w,w,ve),De.max(x,x,ve),new _r(w,x)}const E=[h[12]*u,h[13]*u,h[14]*u],C=m.getCenter(),I=re(r.center.lat,-Kr,Kr),D=re(C.lat,-Kr,Kr),N=xo(r.center.lng),W=Io(I);let V=N-xo(C.lng);const q=W-Io(D);V>.5?V-=1:V<-.5&&(V+=1);let Z=0;if(Math.abs(V)>Math.abs(q))Z=V>=0?1:3;else{Z=q>=0?0:2;const ge=[h[4]*u,h[5]*u,h[6]*u],ve=-Math.sin(ye(q>=0?m.getSouth():m.getNorth()))*fs;De.scaleAndAdd(E,E,ge,ve)}const K=g[Z],X=g[(Z+1)%4],J=new Ree(K,X,E),ae=[dP(J,0)||K[0],dP(J,1)||K[1],dP(J,2)||K[2]],ce=_o(r.zoom);if(ce>0){const ge=function({x:Pe,y:Me,z:Le},Ee,He,Ke,nt){const Ve=1/(1<<Le);let je=Pe*Ve,ot=je+Ve,yt=Me*Ve,ft=yt+Ve,Lt=0;const Ft=(je+ot)/2-Ke;return Ft>.5?Lt=-1:Ft<-.5&&(Lt=1),je=((je+Lt)*Ee-(Ke*=Ee))*He+Ke,ot=((ot+Lt)*Ee-Ke)*He+Ke,yt=(yt*Ee-(nt*=Ee))*He+nt,ft=(ft*Ee-nt)*He+nt,[[je,ft,0],[ot,ft,0],[ot,yt,0],[je,yt,0]]}(o,t,r._pixelsPerMercatorPixel,N,W);for(let Pe=0;Pe<g.length;Pe++)uh(g[Pe],ge[Pe],ce);const ve=De.add([],ge[Z],ge[(Z+1)%4]);De.scale(ve,ve,.5),uh(ae,ve,ce)}for(const ge of g)De.min(w,w,ge),De.max(x,x,ge);return w[2]=Math.min(K[2],X[2]),De.min(w,w,ae),De.max(x,x,ae),new _r(w,x)}function VS({x:r,y:t,z:o},c=!1){const u=1/(1<<o),h=new Nn(ul(r*u),t===(1<<o)-1&&c?-90:_a((t+1)*u)),m=new Nn(ul((r+1)*u),t===0&&c?90:_a(t*u));return new Fl(h,m)}function fP(r){const t=ye(r.getNorth()),o=ye(r.getSouth()),c=Math.cos(t),u=Math.cos(o),h=Math.sin(t),m=Math.sin(o),g=r.getWest(),v=r.getEast();return[hv(u,m,g),hv(u,m,v),hv(c,h,v),hv(c,h,g)]}function hv(r,t,o,c=fs){return o=ye(o),[r*Math.sin(o)*c,-t*c,r*Math.cos(o)*c]}function Us(r,t,o){return hv(Math.cos(ye(r)),Math.sin(ye(r)),t,o)}function v1(r,t,o,c){const u=1<<o.z,h=(r/mt+o.x)/u;return Us(_a((t/mt+o.y)/u),ul(h),c)}function GS({min:r,max:t}){return Pee/Math.max(t[0]-r[0],t[1]-r[1],t[2]-r[2])}const fF=new Float64Array(16);function Pm(r){const t=GS(r),o=at.fromScaling(fF,[t,t,t]);return at.translate(o,o,De.negate([],r.min))}function pP(r){const t=at.fromTranslation(fF,r.min),o=1/GS(r);return at.scale(t,t,[o,o,o])}function mP(r){const t=mt/(2*Math.PI);return r/(2*Math.PI)/t}function pF(r,t){return mt/(512*Math.pow(2,r))*GS(bc(t))}function mF(r,t,o,c,u){const h=mP(o),m=[r,t,-o/(2*Math.PI)],g=at.identity(new Float64Array(16));return at.translate(g,g,m),at.scale(g,g,[h,h,h]),at.rotateX(g,g,ye(-u)),at.rotateY(g,g,ye(-c)),g}function _o(r){return Te(y1,Mf,r)}function gF(r,t,o){const c=at.identity(new Float64Array(16)),u=(t/(1<<r)-.5)*Math.PI*2;return at.rotateY(c,o.globeMatrix,u),Float32Array.from(c)}function yF(r,t,o){const c=_o(o.zoom),u=r.style.map._antialias,h=t.extStandardDerivativesForceOff||r.terrain&&r.terrain.exaggeration()>0;return c===0&&!u&&!h}function Lee(r,t,o,c){const u=t.getNorth(),h=t.getSouth(),m=t.getWest(),g=t.getEast(),v=1<<r.z,x=g-m,w=u-h,E=x/dv,C=-w/uP[o],I=[0,E,0,C,0,0,u,m,0];if(r.z>0){const D=180/c;Bs.multiply(I,I,[D/x+1,0,0,0,D/w+1,0,-.5*D/E,.5*D/C,1])}return I[2]=v,I[5]=r.x,I[8]=r.y,I}function kee(r){const t=Kr-5;r=re(r,-t,t)/t*90;const o=Math.pow(Math.abs(Math.sin(ye(r))),3);return Math.round(o*(uP.length-1))}function vF(r){const t=[0,0,0],o=at.identity(new Float64Array(16));return at.multiply(o,r.pixelMatrix,r.globeMatrix),De.transformMat4(t,t,o),new G(t[0],t[1])}function _F(r,t){const o=Us(t.lat,t.lng),c=function(h){const m=Us(h._center.lat,h._center.lng),g=De.fromValues(0,1,0);let v=De.cross([],g,m);const x=at.fromRotation([],-h.angle,m);v=De.transformMat4(v,v,x),at.fromRotation(x,-h._pitch,v);const w=De.normalize([],m);return De.scale(w,w,WS(h.cameraToCenterDistance/h.pixelsPerMeter)),De.transformMat4(w,w,x),De.add([],m,w)}(r),u=De.subtract([],c,o);return De.angle(u,o)}function HS(r,t){return _F(r,t)>Math.PI/2*1.01}const xF=ye(85),Dee=Math.cos(xF),zee=Math.sin(xF);class Oee{constructor(t){this._createGrid(t),this._createPoles(t)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const t of this._poleSegments)t.destroy();for(const t of this._gridSegments)t.withSkirts.destroy(),t.withoutSkirts.destroy()}_fillGridMeshWithLods(t,o){const c=new ee,u=new Un,h=[],m=t+1+2,g=o[0]+1,v=o[0]+1+(1+o.length),x=(w,E,C)=>{let I=w===m-1?w-2:w===0?w:w-1;return I+=C?24575:0,[I,E]};for(let w=0;w<m;++w)c.emplaceBack(...x(w,0,!0));for(let w=0;w<g;++w)for(let E=0;E<m;++E)c.emplaceBack(...x(E,w,(E===0||E===m-1)&&!0));for(let w=0;w<o.length;++w){const E=o[w];for(let C=0;C<m;++C)c.emplaceBack(...x(C,E,!0))}for(let w=0;w<o.length;++w){const E=u.length,C=o[w]+1+2,I=new Un;for(let W=0;W<C-1;W++){const V=W===C-2,q=V?m*(v-o.length+w-W):m;for(let Z=0;Z<m-1;Z++){const K=W*m+Z;W===0||V||Z===0||Z===m-2?(I.emplaceBack(K+1,K,K+q),I.emplaceBack(K+q,K+q+1,K+1)):(u.emplaceBack(K+1,K,K+q),u.emplaceBack(K+q,K+q+1,K+1))}}const D=qi.simpleSegment(0,E,c.length,u.length-E);for(let W=0;W<I.uint16.length;W+=3)u.emplaceBack(I.uint16[W],I.uint16[W+1],I.uint16[W+2]);const N=qi.simpleSegment(0,E,c.length,u.length-E);h.push({withoutSkirts:D,withSkirts:N})}return{vertices:c,indices:u,segments:h}}_createGrid(t){const o=this._fillGridMeshWithLods(dv,uP);this._gridSegments=o.segments,this._gridBuffer=t.createVertexBuffer(o.vertices,Ef.members),this._gridIndexBuffer=t.createIndexBuffer(o.indices,!0)}_createPoles(t){const o=new Un;for(let g=0;g<=dv;g++)o.emplaceBack(0,g+1,g+2);this._poleIndexBuffer=t.createIndexBuffer(o,!0);const c=new Hi,u=new Hi,h=new Hi,m=new Hi;this._poleSegments=[];for(let g=0,v=0;g<y1;g++){const x=360/(1<<g);c.emplaceBack(0,-fs,0,.5,0),u.emplaceBack(0,-fs,0,.5,1),h.emplaceBack(0,-fs,0,.5,.5),m.emplaceBack(0,-fs,0,.5,.5);for(let w=0;w<=dv;w++){let E=w/dv,C=0;const I=kn(0,x,E),[D,N,W]=hv(Dee,zee,I,fs);c.emplaceBack(D,N,W,E,C),u.emplaceBack(D,N,W,E,1-C);const V=ye(I);E=.5+.5*Math.sin(V),C=.5+.5*Math.cos(V),h.emplaceBack(D,N,W,E,C),m.emplaceBack(D,N,W,E,1-C)}this._poleSegments.push(qi.simpleSegment(v,0,66,64)),v+=66}this._poleNorthVertexBuffer=t.createVertexBuffer(c,BS,!1),this._poleSouthVertexBuffer=t.createVertexBuffer(u,BS,!1),this._texturedPoleNorthVertexBuffer=t.createVertexBuffer(h,BS,!1),this._texturedPoleSouthVertexBuffer=t.createVertexBuffer(m,BS,!1)}getGridBuffers(t,o){return[this._gridBuffer,this._gridIndexBuffer,o?this._gridSegments[t].withSkirts:this._gridSegments[t].withoutSkirts]}getPoleBuffers(t,o){return[o?this._texturedPoleNorthVertexBuffer:this._poleNorthVertexBuffer,o?this._texturedPoleSouthVertexBuffer:this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[t]]}}const fv=63710088e-1,gP=2*Math.PI*fv;class Tf{constructor(t,o){if(isNaN(t)||isNaN(o))throw new Error(`Invalid LngLat object: (${t}, ${o})`);if(this.lng=+t,this.lat=+o,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Tf(Je(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(t){const o=Math.PI/180,c=this.lat*o,u=t.lat*o,h=Math.sin(c)*Math.sin(u)+Math.cos(c)*Math.cos(u)*Math.cos((t.lng-this.lng)*o);return fv*Math.acos(Math.min(h,1))}toBounds(t=0){const o=360*t/40075017,c=o/Math.cos(Math.PI/180*this.lat);return new Fl(new Tf(this.lng-c,this.lat-o),new Tf(this.lng+c,this.lat+o))}toEcef(t){const o=WS(t);return Us(this.lat,this.lng,fs+o)}static convert(t){if(t instanceof Tf)return t;if(Array.isArray(t)&&(t.length===2||t.length===3))return new Tf(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&typeof t=="object"&&t!==null)return new Tf(Number("lng"in t?t.lng:t.lon),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}var Nn=Tf;const Nee=0,Fee=25.5;function jS(r){return gP*Math.cos(r*Math.PI/180)}function xo(r){return(180+r)/360}function Io(r){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+r*Math.PI/360)))/360}function Xi(r,t){return r/jS(t)}function ul(r){return 360*r-180}function _a(r){return 360/Math.PI*Math.atan(Math.exp((180-360*r)*Math.PI/180))-90}function bF(r,t){return r*jS(_a(t))}const Kr=85.051129;function wF(r){return Math.cos(ye(re(r,-Kr,Kr)))}function Af(r,t){const o=re(t,Nee,Fee),c=Math.pow(2,o);return wF(r)*gP/(512*c)}function yP(r){return 1/Math.cos(r*Math.PI/180)}function _1(r,t=0){const o=Math.exp(Math.PI*(1-(r.y+t/mt)/(1<<r.z)*2));return 80150034*o/(o*o+1)/mt/(1<<r.z)}class bi{constructor(t,o,c=0){this.x=+t,this.y=+o,this.z=+c}static fromLngLat(t,o=0){const c=Nn.convert(t);return new bi(xo(c.lng),Io(c.lat),Xi(o,c.lat))}toLngLat(){return new Nn(ul(this.x),_a(this.y))}toAltitude(){return bF(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/gP*yP(_a(this.y))}}function vP(r,t,o,c,u,h,m,g,v){const x=(t+c)/2,w=(o+u)/2,E=new G(x,w);g(E),function(C,I,D,N,W,V){const q=D-W,Z=N-V;return Math.abs((N-I)*q-(D-C)*Z)/Math.hypot(q,Z)}(E.x,E.y,h.x,h.y,m.x,m.y)>=v?(vP(r,t,o,x,w,h,E,g,v),vP(r,x,w,c,u,E,m,g,v)):r.push(m)}function SF(r,t,o){let c=r[0],u=c.x,h=c.y;t(c);const m=[c];for(let g=1;g<r.length;g++){const v=r[g],{x,y:w}=v;t(v),vP(m,u,h,x,w,c,v,t,o),u=x,h=w,c=v}return m}function _P(r,t,o,c){if(c(t,o)){const u=t.add(o)._mult(.5);_P(r,t,u,c),_P(r,u,o,c)}else r.push(o)}function Bee(r,t){let o=r[0];const c=[o];for(let u=1;u<r.length;u++){const h=r[u];_P(c,o,h,t),o=h}return c}const xP=Math.pow(2,14)-1,EF=-xP-1;function Uee(r,t){const o=Math.round(r.x*t),c=Math.round(r.y*t);return r.x=re(o,EF,xP),r.y=re(c,EF,xP),(o<r.x||o>r.x+1||c<r.y||c>r.y+1)&&xe("Geometry exceeds allowed extent, reduce your vector tile buffer size"),r}function Zu(r,t,o){const c=r.loadGeometry(),u=r.extent,h=mt/u;if(t&&o&&o.projection.isReprojectedInTileSpace){const m=1<<t.z,{scale:g,x:v,y:x,projection:w}=o,E=C=>{const I=ul((t.x+C.x/u)/m),D=_a((t.y+C.y/u)/m),N=w.project(I,D);C.x=(N.x*g-v)*u,C.y=(N.y*g-x)*u};for(let C=0;C<c.length;C++)if(r.type!==1)c[C]=SF(c[C],E,1);else{const I=[];for(const D of c[C])D.x<0||D.x>=u||D.y<0||D.y>=u||(E(D),I.push(D));c[C]=I}}for(const m of c)for(const g of m)Uee(g,h);return c}function Cf(r,t){return{type:r.type,id:r.id,properties:r.properties,geometry:t?Zu(r):[]}}function $S(r,t,o,c,u){r.emplaceBack(2*t+(c+1)/2,2*o+(u+1)/2)}function YS(r,t,o){r.emplaceBack(t.x,t.y,t.z,o[0]*16384,o[1]*16384,o[2]*16384)}class bP{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(o=>o.fqid),this.index=t.index,this.hasPattern=!1,this.projection=t.projection,this.layoutVertexArray=new ee,this.indexArray=new Un,this.segments=new qi,this.programConfigurations=new wf(t.layers,t.zoom),this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id)}populate(t,o,c,u){const h=this.layers[0],m=[];let g=null;h.type==="circle"&&(g=h.layout.get("circle-sort-key"));for(const{feature:x,id:w,index:E,sourceLayerIndex:C}of t){const I=this.layers[0]._featureFilter.needGeometry,D=Cf(x,I);if(!this.layers[0]._featureFilter.filter(new dr(this.zoom),D,c))continue;const N=g?g.evaluate(D,{},c):void 0,W={id:w,properties:x.properties,type:x.type,sourceLayerIndex:C,index:E,geometry:I?D.geometry:Zu(x,c,u),patterns:{},sortKey:N};m.push(W)}g&&m.sort((x,w)=>x.sortKey-w.sortKey);let v=null;u.projection.name==="globe"&&(this.globeExtVertexArray=new ii,v=u.projection);for(const x of m){const{geometry:w,index:E,sourceLayerIndex:C}=x,I=t[E].feature;this.addFeature(x,w,E,o.availableImages,c,v,o.brightness),o.featureIndex.insert(I,w,E,C,this.index)}}update(t,o,c,u,h){const m=Object.keys(t).length!==0;m&&!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(t,o,m?this.stateDependentLayers:this.layers,c,u,h)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,XQ.members),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=t.createVertexBuffer(this.globeExtVertexArray,ZQ.members))),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(t,o,c,u,h,m,g){for(const v of o)for(const x of v){const w=x.x,E=x.y;if(w<0||w>=mt||E<0||E>=mt)continue;if(m){const D=m.projectTilePoint(w,E,h),N=m.upVector(h,w,E),W=this.globeExtVertexArray;YS(W,D,N),YS(W,D,N),YS(W,D,N),YS(W,D,N)}const C=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,t.sortKey),I=C.vertexLength;$S(this.layoutVertexArray,w,E,-1,-1),$S(this.layoutVertexArray,w,E,1,-1),$S(this.layoutVertexArray,w,E,1,1),$S(this.layoutVertexArray,w,E,-1,1),this.indexArray.emplaceBack(I,I+1,I+2),this.indexArray.emplaceBack(I,I+2,I+3),C.vertexLength+=4,C.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,c,{},u,h,g)}}function MF(r,t){for(let o=0;o<r.length;o++)if(Pf(t,r[o]))return!0;for(let o=0;o<t.length;o++)if(Pf(r,t[o]))return!0;return!!wP(r,t)}function Wee(r,t,o){return!!Pf(r,t)||!!SP(t,r,o)}function TF(r,t){if(r.length===1)return CF(t,r[0]);for(let o=0;o<t.length;o++){const c=t[o];for(let u=0;u<c.length;u++)if(Pf(r,c[u]))return!0}for(let o=0;o<r.length;o++)if(CF(t,r[o]))return!0;for(let o=0;o<t.length;o++)if(wP(r,t[o]))return!0;return!1}function Vee(r,t,o){if(r.length>1){if(wP(r,t))return!0;for(let c=0;c<t.length;c++)if(SP(t[c],r,o))return!0}for(let c=0;c<r.length;c++)if(SP(r[c],t,o))return!0;return!1}function wP(r,t){if(r.length===0||t.length===0)return!1;for(let o=0;o<r.length-1;o++){const c=r[o],u=r[o+1];for(let h=0;h<t.length-1;h++)if(Gee(c,u,t[h],t[h+1]))return!0}return!1}function Gee(r,t,o,c){return Ye(r,o,c)!==Ye(t,o,c)&&Ye(r,t,o)!==Ye(r,t,c)}function SP(r,t,o){const c=o*o;if(t.length===1)return r.distSqr(t[0])<c;for(let u=1;u<t.length;u++)if(AF(r,t[u-1],t[u])<c)return!0;return!1}function AF(r,t,o){const c=t.distSqr(o);if(c===0)return r.distSqr(t);const u=((r.x-t.x)*(o.x-t.x)+(r.y-t.y)*(o.y-t.y))/c;return r.distSqr(u<0?t:u>1?o:o.sub(t)._mult(u)._add(t))}function CF(r,t){let o,c,u,h=!1;for(let m=0;m<r.length;m++){o=r[m];for(let g=0,v=o.length-1;g<o.length;v=g++)c=o[g],u=o[v],c.y>t.y!=u.y>t.y&&t.x<(u.x-c.x)*(t.y-c.y)/(u.y-c.y)+c.x&&(h=!h)}return h}function Pf(r,t){let o=!1;for(let c=0,u=r.length-1;c<r.length;u=c++){const h=r[c],m=r[u];h.y>t.y!=m.y>t.y&&t.x<(m.x-h.x)*(t.y-h.y)/(m.y-h.y)+h.x&&(o=!o)}return o}function PF(r,t,o,c,u){for(const m of r)if(t<=m.x&&o<=m.y&&c>=m.x&&u>=m.y)return!0;const h=[new G(t,o),new G(t,u),new G(c,u),new G(c,o)];if(r.length>2){for(const m of h)if(Pf(r,m))return!0}for(let m=0;m<r.length-1;m++)if(Hee(r[m],r[m+1],h))return!0;return!1}function Hee(r,t,o){const c=o[0],u=o[2];if(r.x<c.x&&t.x<c.x||r.x>u.x&&t.x>u.x||r.y<c.y&&t.y<c.y||r.y>u.y&&t.y>u.y)return!1;const h=Ye(r,t,o[0]);return h!==Ye(r,t,o[1])||h!==Ye(r,t,o[2])||h!==Ye(r,t,o[3])}function pv(r,t,o,c,u,h){let m=t.y-r.y,g=r.x-t.x;if(h=h||0){const v=m*m+g*g;if(v===0)return!0;const x=Math.sqrt(v);m/=x,g/=x}return!((o.x-r.x)*m+(o.y-r.y)*g-h<0||(c.x-r.x)*m+(c.y-r.y)*g-h<0||(u.x-r.x)*m+(u.y-r.y)*g-h<0)}function EP(r,t,o,c,u,h,m){return!(pv(r,t,c,u,h,m)||pv(t,o,c,u,h,m)||pv(o,r,c,u,h,m)||pv(c,u,r,t,o,m)||pv(u,h,r,t,o,m)||pv(h,c,r,t,o,m))}function mv(r,t,o){const c=t.paint.get(r).value;return c.kind==="constant"?c.value:o.programConfigurations.get(t.id).getMaxValue(r)}function qS(r){return Math.sqrt(r[0]*r[0]+r[1]*r[1])}function IF(r,t,o,c,u){if(!t[0]&&!t[1])return r;const h=G.convert(t)._mult(u);o==="viewport"&&h._rotate(-c);const m=[];for(let g=0;g<r.length;g++)m.push(r[g].sub(h));return m}function RF(r,t,o,c){const u=G.convert(r)._mult(c);return t==="viewport"&&u._rotate(-o),u}dn(bP,"CircleBucket",{omit:["layers"]});const jee=new Er({"circle-sort-key":new xn(rt.layout_circle["circle-sort-key"]),visibility:new Zt(rt.layout_circle.visibility)});var $ee={paint:new Er({"circle-radius":new xn(rt.paint_circle["circle-radius"]),"circle-color":new xn(rt.paint_circle["circle-color"]),"circle-blur":new xn(rt.paint_circle["circle-blur"]),"circle-opacity":new xn(rt.paint_circle["circle-opacity"]),"circle-translate":new Zt(rt.paint_circle["circle-translate"]),"circle-translate-anchor":new Zt(rt.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Zt(rt.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Zt(rt.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new xn(rt.paint_circle["circle-stroke-width"]),"circle-stroke-color":new xn(rt.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new xn(rt.paint_circle["circle-stroke-opacity"]),"circle-emissive-strength":new Zt(rt.paint_circle["circle-emissive-strength"])}),layout:jee};const Yee=at.create(),qee=(r,t,o,c,u,h)=>{const m=r.transform,g=m.projection.name==="globe";let v;if(h.paint.get("circle-pitch-alignment")==="map")if(g){const w=pF(m.zoom,t.canonical)*m._pixelsPerMercatorPixel;v=Float32Array.from([w,0,0,w])}else v=m.calculatePixelsToTileUnitsMatrix(o);else v=new Float32Array([m.pixelsToGLUnits[0],0,0,m.pixelsToGLUnits[1]]);const x={u_camera_to_center_distance:r.transform.getCameraToCenterDistance(m.projection),u_matrix:r.translatePosMatrix(t.projMatrix,o,h.paint.get("circle-translate"),h.paint.get("circle-translate-anchor")),u_device_pixel_ratio:Pn.devicePixelRatio,u_extrude_scale:v,u_inv_rot_matrix:Yee,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0],u_emissive_strength:h.paint.get("circle-emissive-strength")};if(g){x.u_inv_rot_matrix=c,x.u_merc_center=u,x.u_tile_id=[t.canonical.x,t.canonical.y,1<<t.canonical.z],x.u_zoom_transition=_o(m.zoom);const w=u[0]*mt,E=u[1]*mt;x.u_up_dir=m.projection.upVector(new Xu(0,0,0),w,E)}return x},LF=r=>{const t=[];return r.paint.get("circle-pitch-alignment")==="map"&&t.push("PITCH_WITH_MAP"),r.paint.get("circle-pitch-scale")==="map"&&t.push("SCALE_WITH_MAP"),t};function kF(r,t,o,c,u,h,m,g,v){if(h&&r.queryGeometry.isAboveHorizon)return!1;h&&(v*=r.pixelToTileUnitsFactor);const x=r.tileID.canonical,w=o.projection.upVectorScale(x,o.center.lat,o.worldSize).metersToTile;for(const E of t)for(const C of E){const I=C.add(g),D=u&&o.elevation?o.elevation.exaggeration()*u.getElevationAt(I.x,I.y,!0):0,N=o.projection.projectTilePoint(I.x,I.y,x);if(D>0){const Z=o.projection.upVector(x,I.x,I.y);N.x+=Z[0]*w*D,N.y+=Z[1]*w*D,N.z+=Z[2]*w*D}const W=h?I:Xee(N.x,N.y,N.z,c),V=h?r.tilespaceRays.map(Z=>Kee(Z,D)):r.queryGeometry.screenGeometry,q=Yi.transformMat4([],[N.x,N.y,N.z,1],c);if(!m&&h?v*=q[3]/o.cameraToCenterDistance:m&&!h&&(v*=o.cameraToCenterDistance/q[3]),h){const Z=_a((C.y/mt+x.y)/(1<<x.z));v/=o.projection.pixelsPerMeter(Z,1)/Xi(1,Z)}if(Wee(V,W,v))return!0}return!1}function Xee(r,t,o,c){const u=Yi.transformMat4([],[r,t,o,1],c);return new G(u[0]/u[3],u[1]/u[3])}const DF=De.fromValues(0,0,0),Zee=De.fromValues(0,0,1);function Kee(r,t){const o=De.create();return DF[2]=t,r.intersectsPlane(DF,Zee,o),new G(o[0],o[1])}class zF extends bP{}function OF(r,{width:t,height:o},c,u){if(u){if(u instanceof Uint8ClampedArray)u=new Uint8Array(u.buffer);else if(u.length!==t*o*c)throw new RangeError("mismatched image size")}else u=new Uint8Array(t*o*c);return r.width=t,r.height=o,r.data=u,r}function NF(r,t,o){const{width:c,height:u}=t;c===r.width&&u===r.height||(MP(r,t,{x:0,y:0},{x:0,y:0},{width:Math.min(r.width,c),height:Math.min(r.height,u)},o),r.width=c,r.height=u,r.data=t.data)}function MP(r,t,o,c,u,h){if(u.width===0||u.height===0)return t;if(u.width>r.width||u.height>r.height||o.x>r.width-u.width||o.y>r.height-u.height)throw new RangeError("out of range source coordinates for image copy");if(u.width>t.width||u.height>t.height||c.x>t.width-u.width||c.y>t.height-u.height)throw new RangeError("out of range destination coordinates for image copy");const m=r.data,g=t.data;for(let v=0;v<u.height;v++){const x=((o.y+v)*r.width+o.x)*h,w=((c.y+v)*t.width+c.x)*h;for(let E=0;E<u.width*h;E++)g[w+E]=m[x+E]}return t}dn(zF,"HeatmapBucket",{omit:["layers"]});class dh{constructor(t,o){OF(this,t,1,o)}resize(t){NF(this,new dh(t),1)}clone(){return new dh({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,o,c,u,h){MP(t,o,c,u,h,1)}}class Jr{constructor(t,o){OF(this,t,4,o)}resize(t){NF(this,new Jr(t),4)}replace(t,o){o?this.data.set(t):this.data=t instanceof Uint8ClampedArray?new Uint8Array(t.buffer):t}clone(){return new Jr({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,o,c,u,h){MP(t,o,c,u,h,4)}}class FF{constructor(t,o){this.width=t.width,this.height=t.height,this.data=o instanceof Uint8Array?new Float32Array(o.buffer):o}}dn(dh,"AlphaImage"),dn(Jr,"RGBAImage");const Jee=new Er({visibility:new Zt(rt.layout_heatmap.visibility)});var Qee={paint:new Er({"heatmap-radius":new xn(rt.paint_heatmap["heatmap-radius"]),"heatmap-weight":new xn(rt.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Zt(rt.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Mm(rt.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Zt(rt.paint_heatmap["heatmap-opacity"])}),layout:Jee};function XS(r){const t={},o=r.resolution||256,c=r.clips?r.clips.length:1,u=r.image||new Jr({width:o,height:c}),h=(m,g,v)=>{t[r.evaluationKey]=v;const x=r.expression.evaluate(t);x&&(u.data[m+g+0]=Math.floor(255*x.r/x.a),u.data[m+g+1]=Math.floor(255*x.g/x.a),u.data[m+g+2]=Math.floor(255*x.b/x.a),u.data[m+g+3]=Math.floor(255*x.a))};if(r.clips)for(let m=0,g=0;m<c;++m,g+=4*o)for(let v=0,x=0;v<o;v++,x+=4){const w=v/(o-1),{start:E,end:C}=r.clips[m];h(g,x,E*(1-w)+C*w)}else for(let m=0,g=0;m<o;m++,g+=4)h(0,g,m/(o-1));return u}const ete=new Er({visibility:new Zt(rt.layout_hillshade.visibility)});var tte={paint:new Er({"hillshade-illumination-direction":new Zt(rt.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Zt(rt.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Zt(rt.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Zt(rt.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Zt(rt.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Zt(rt.paint_hillshade["hillshade-accent-color"]),"hillshade-emissive-strength":new Zt(rt.paint_hillshade["hillshade-emissive-strength"])}),layout:ete};const nte=B([{name:"a_pos",components:2,type:"Int16"}],4),{members:ite}=nte;var TP={exports:{}};function ZS(r,t,o){o=o||2;var c,u,h,m,g,v,x,w=t&&t.length,E=w?t[0]*o:r.length,C=BF(r,0,E,o,!0),I=[];if(!C||C.next===C.prev)return I;if(w&&(C=function(N,W,V,q){var Z,K,X,J=[];for(Z=0,K=W.length;Z<K;Z++)(X=BF(N,W[Z]*q,Z<K-1?W[Z+1]*q:N.length,q,!1))===X.next&&(X.steiner=!0),J.push(dte(X));for(J.sort(lte),Z=0;Z<J.length;Z++)V=cte(J[Z],V);return V}(r,t,C,o)),r.length>80*o){c=h=r[0],u=m=r[1];for(var D=o;D<E;D+=o)(g=r[D])<c&&(c=g),(v=r[D+1])<u&&(u=v),g>h&&(h=g),v>m&&(m=v);x=(x=Math.max(h-c,m-u))!==0?32767/x:0}return x1(C,I,o,c,u,x,0),I}function BF(r,t,o,c,u){var h,m;if(u===PP(r,t,o,c)>0)for(h=t;h<o;h+=c)m=VF(h,r[h],r[h+1],m);else for(h=o-c;h>=t;h-=c)m=VF(h,r[h],r[h+1],m);return m&&KS(m,m.next)&&(w1(m),m=m.next),m}function Im(r,t){if(!r)return r;t||(t=r);var o,c=r;do if(o=!1,c.steiner||!KS(c,c.next)&&Ra(c.prev,c,c.next)!==0)c=c.next;else{if(w1(c),(c=t=c.prev)===c.next)break;o=!0}while(o||c!==t);return t}function x1(r,t,o,c,u,h,m){if(r){!m&&h&&function(w,E,C,I){var D=w;do D.z===0&&(D.z=AP(D.x,D.y,E,C,I)),D.prevZ=D.prev,D.nextZ=D.next,D=D.next;while(D!==w);D.prevZ.nextZ=null,D.prevZ=null,function(N){var W,V,q,Z,K,X,J,ae,ce=1;do{for(V=N,N=null,K=null,X=0;V;){for(X++,q=V,J=0,W=0;W<ce&&(J++,q=q.nextZ);W++);for(ae=ce;J>0||ae>0&&q;)J!==0&&(ae===0||!q||V.z<=q.z)?(Z=V,V=V.nextZ,J--):(Z=q,q=q.nextZ,ae--),K?K.nextZ=Z:N=Z,Z.prevZ=K,K=Z;V=q}K.nextZ=null,ce*=2}while(X>1)}(D)}(r,c,u,h);for(var g,v,x=r;r.prev!==r.next;)if(g=r.prev,v=r.next,h?ate(r,c,u,h):rte(r))t.push(g.i/o|0),t.push(r.i/o|0),t.push(v.i/o|0),w1(r),r=v.next,x=v.next;else if((r=v)===x){m?m===1?x1(r=ote(Im(r),t,o),t,o,c,u,h,2):m===2&&ste(r,t,o,c,u,h):x1(Im(r),t,o,c,u,h,1);break}}}function rte(r){var t=r.prev,o=r,c=r.next;if(Ra(t,o,c)>=0)return!1;for(var u=t.x,h=o.x,m=c.x,g=t.y,v=o.y,x=c.y,w=u<h?u<m?u:m:h<m?h:m,E=g<v?g<x?g:x:v<x?v:x,C=u>h?u>m?u:m:h>m?h:m,I=g>v?g>x?g:x:v>x?v:x,D=c.next;D!==t;){if(D.x>=w&&D.x<=C&&D.y>=E&&D.y<=I&&gv(u,g,h,v,m,x,D.x,D.y)&&Ra(D.prev,D,D.next)>=0)return!1;D=D.next}return!0}function ate(r,t,o,c){var u=r.prev,h=r,m=r.next;if(Ra(u,h,m)>=0)return!1;for(var g=u.x,v=h.x,x=m.x,w=u.y,E=h.y,C=m.y,I=g<v?g<x?g:x:v<x?v:x,D=w<E?w<C?w:C:E<C?E:C,N=g>v?g>x?g:x:v>x?v:x,W=w>E?w>C?w:C:E>C?E:C,V=AP(I,D,t,o,c),q=AP(N,W,t,o,c),Z=r.prevZ,K=r.nextZ;Z&&Z.z>=V&&K&&K.z<=q;){if(Z.x>=I&&Z.x<=N&&Z.y>=D&&Z.y<=W&&Z!==u&&Z!==m&&gv(g,w,v,E,x,C,Z.x,Z.y)&&Ra(Z.prev,Z,Z.next)>=0||(Z=Z.prevZ,K.x>=I&&K.x<=N&&K.y>=D&&K.y<=W&&K!==u&&K!==m&&gv(g,w,v,E,x,C,K.x,K.y)&&Ra(K.prev,K,K.next)>=0))return!1;K=K.nextZ}for(;Z&&Z.z>=V;){if(Z.x>=I&&Z.x<=N&&Z.y>=D&&Z.y<=W&&Z!==u&&Z!==m&&gv(g,w,v,E,x,C,Z.x,Z.y)&&Ra(Z.prev,Z,Z.next)>=0)return!1;Z=Z.prevZ}for(;K&&K.z<=q;){if(K.x>=I&&K.x<=N&&K.y>=D&&K.y<=W&&K!==u&&K!==m&&gv(g,w,v,E,x,C,K.x,K.y)&&Ra(K.prev,K,K.next)>=0)return!1;K=K.nextZ}return!0}function ote(r,t,o){var c=r;do{var u=c.prev,h=c.next.next;!KS(u,h)&&UF(u,c,c.next,h)&&b1(u,h)&&b1(h,u)&&(t.push(u.i/o|0),t.push(c.i/o|0),t.push(h.i/o|0),w1(c),w1(c.next),c=r=h),c=c.next}while(c!==r);return Im(c)}function ste(r,t,o,c,u,h){var m=r;do{for(var g=m.next.next;g!==m.prev;){if(m.i!==g.i&&hte(m,g)){var v=WF(m,g);return m=Im(m,m.next),v=Im(v,v.next),x1(m,t,o,c,u,h,0),void x1(v,t,o,c,u,h,0)}g=g.next}m=m.next}while(m!==r)}function lte(r,t){return r.x-t.x}function cte(r,t){var o=function(u,h){var m,g=h,v=u.x,x=u.y,w=-1/0;do{if(x<=g.y&&x>=g.next.y&&g.next.y!==g.y){var E=g.x+(x-g.y)*(g.next.x-g.x)/(g.next.y-g.y);if(E<=v&&E>w&&(w=E,m=g.x<g.next.x?g:g.next,E===v))return m}g=g.next}while(g!==h);if(!m)return null;var C,I=m,D=m.x,N=m.y,W=1/0;g=m;do v>=g.x&&g.x>=D&&v!==g.x&&gv(x<N?v:w,x,D,N,x<N?w:v,x,g.x,g.y)&&(C=Math.abs(x-g.y)/(v-g.x),b1(g,u)&&(C<W||C===W&&(g.x>m.x||g.x===m.x&&ute(m,g)))&&(m=g,W=C)),g=g.next;while(g!==I);return m}(r,t);if(!o)return t;var c=WF(o,r);return Im(c,c.next),Im(o,o.next)}function ute(r,t){return Ra(r.prev,r,t.prev)<0&&Ra(t.next,r,r.next)<0}function AP(r,t,o,c,u){return(r=1431655765&((r=858993459&((r=252645135&((r=16711935&((r=(r-o)*u|0)|r<<8))|r<<4))|r<<2))|r<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-c)*u|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function dte(r){var t=r,o=r;do(t.x<o.x||t.x===o.x&&t.y<o.y)&&(o=t),t=t.next;while(t!==r);return o}function gv(r,t,o,c,u,h,m,g){return(u-m)*(t-g)>=(r-m)*(h-g)&&(r-m)*(c-g)>=(o-m)*(t-g)&&(o-m)*(h-g)>=(u-m)*(c-g)}function hte(r,t){return r.next.i!==t.i&&r.prev.i!==t.i&&!function(o,c){var u=o;do{if(u.i!==o.i&&u.next.i!==o.i&&u.i!==c.i&&u.next.i!==c.i&&UF(u,u.next,o,c))return!0;u=u.next}while(u!==o);return!1}(r,t)&&(b1(r,t)&&b1(t,r)&&function(o,c){var u=o,h=!1,m=(o.x+c.x)/2,g=(o.y+c.y)/2;do u.y>g!=u.next.y>g&&u.next.y!==u.y&&m<(u.next.x-u.x)*(g-u.y)/(u.next.y-u.y)+u.x&&(h=!h),u=u.next;while(u!==o);return h}(r,t)&&(Ra(r.prev,r,t.prev)||Ra(r,t.prev,t))||KS(r,t)&&Ra(r.prev,r,r.next)>0&&Ra(t.prev,t,t.next)>0)}function Ra(r,t,o){return(t.y-r.y)*(o.x-t.x)-(t.x-r.x)*(o.y-t.y)}function KS(r,t){return r.x===t.x&&r.y===t.y}function UF(r,t,o,c){var u=QS(Ra(r,t,o)),h=QS(Ra(r,t,c)),m=QS(Ra(o,c,r)),g=QS(Ra(o,c,t));return u!==h&&m!==g||!(u!==0||!JS(r,o,t))||!(h!==0||!JS(r,c,t))||!(m!==0||!JS(o,r,c))||!(g!==0||!JS(o,t,c))}function JS(r,t,o){return t.x<=Math.max(r.x,o.x)&&t.x>=Math.min(r.x,o.x)&&t.y<=Math.max(r.y,o.y)&&t.y>=Math.min(r.y,o.y)}function QS(r){return r>0?1:r<0?-1:0}function b1(r,t){return Ra(r.prev,r,r.next)<0?Ra(r,t,r.next)>=0&&Ra(r,r.prev,t)>=0:Ra(r,t,r.prev)<0||Ra(r,r.next,t)<0}function WF(r,t){var o=new CP(r.i,r.x,r.y),c=new CP(t.i,t.x,t.y),u=r.next,h=t.prev;return r.next=t,t.prev=r,o.next=u,u.prev=o,c.next=o,o.prev=c,h.next=c,c.prev=h,c}function VF(r,t,o,c){var u=new CP(r,t,o);return c?(u.next=c.next,u.prev=c,c.next.prev=u,c.next=u):(u.prev=u,u.next=u),u}function w1(r){r.next.prev=r.prev,r.prev.next=r.next,r.prevZ&&(r.prevZ.nextZ=r.nextZ),r.nextZ&&(r.nextZ.prevZ=r.prevZ)}function CP(r,t,o){this.i=r,this.x=t,this.y=o,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function PP(r,t,o,c){for(var u=0,h=t,m=o-c;h<o;h+=c)u+=(r[m]-r[h])*(r[h+1]+r[m+1]),m=h;return u}TP.exports=ZS,TP.exports.default=ZS,ZS.deviation=function(r,t,o,c){var u=t&&t.length,h=Math.abs(PP(r,0,u?t[0]*o:r.length,o));if(u)for(var m=0,g=t.length;m<g;m++)h-=Math.abs(PP(r,t[m]*o,m<g-1?t[m+1]*o:r.length,o));var v=0;for(m=0;m<c.length;m+=3){var x=c[m]*o,w=c[m+1]*o,E=c[m+2]*o;v+=Math.abs((r[x]-r[E])*(r[w+1]-r[x+1])-(r[x]-r[w])*(r[E+1]-r[x+1]))}return h===0&&v===0?0:Math.abs((v-h)/h)},ZS.flatten=function(r){for(var t=r[0][0].length,o={vertices:[],holes:[],dimensions:t},c=0,u=0;u<r.length;u++){for(var h=0;h<r[u].length;h++)for(var m=0;m<t;m++)o.vertices.push(r[u][h][m]);u>0&&o.holes.push(c+=r[u-1].length)}return o};var e2=O(TP.exports);function IP(r,t){const o=r.length;if(o<=1)return[r];const c=[];let u,h;for(let m=0;m<o;m++){const g=ze(r[m]);g!==0&&(r[m].area=Math.abs(g),h===void 0&&(h=g<0),h===g<0?(u&&c.push(u),u=[r[m]]):u.push(r[m]))}if(u&&c.push(u),t>1)for(let m=0;m<c.length;m++)c[m].length<=t||(Wc(c[m],t,1,c[m].length-1,fte),c[m]=c[m].slice(0,t));return c}function fte(r,t){return t.area-r.area}function RP(r,t,o){const c=o.patternDependencies;let u=!1;for(const h of t){const m=h.paint.get(`${r}-pattern`);m.isConstant()||(u=!0);const g=m.constantOr(null);g&&(u=!0,c[g]=!0)}return u}function LP(r,t,o,c,u){const h=u.patternDependencies;for(const m of t){const g=m.paint.get(`${r}-pattern`).value;if(g.kind!=="constant"){let v=g.evaluate({zoom:c},o,{},u.availableImages);v=v&&v.name?v.name:v,h[v]=!0,o.patterns[m.id]=v}}return o}class t2{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(o=>o.fqid),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new ee,this.indexArray=new Un,this.indexArray2=new no,this.programConfigurations=new wf(t.layers,t.zoom),this.segments=new qi,this.segments2=new qi,this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id),this.projection=t.projection}populate(t,o,c,u){this.hasPattern=RP("fill",this.layers,o);const h=this.layers[0].layout.get("fill-sort-key"),m=[];for(const{feature:g,id:v,index:x,sourceLayerIndex:w}of t){const E=this.layers[0]._featureFilter.needGeometry,C=Cf(g,E);if(!this.layers[0]._featureFilter.filter(new dr(this.zoom),C,c))continue;const I=h?h.evaluate(C,{},c,o.availableImages):void 0,D={id:v,properties:g.properties,type:g.type,sourceLayerIndex:w,index:x,geometry:E?C.geometry:Zu(g,c,u),patterns:{},sortKey:I};m.push(D)}h&&m.sort((g,v)=>g.sortKey-v.sortKey);for(const g of m){const{geometry:v,index:x,sourceLayerIndex:w}=g;if(this.hasPattern){const E=LP("fill",this.layers,g,this.zoom,o);this.patternFeatures.push(E)}else this.addFeature(g,v,x,c,{},o.availableImages,o.brightness);o.featureIndex.insert(t[x].feature,v,x,w,this.index)}}update(t,o,c,u,h){const m=Object.keys(t).length!==0;m&&!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(t,o,m?this.stateDependentLayers:this.layers,c,u,h)}addFeatures(t,o,c,u,h,m){for(const g of this.patternFeatures)this.addFeature(g,g.geometry,g.index,o,c,u,m)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,ite),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.indexBuffer2=t.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(t,o,c,u,h,m=[],g){for(const v of IP(o,500)){let x=0;for(const N of v)x+=N.length;const w=this.segments.prepareSegment(x,this.layoutVertexArray,this.indexArray),E=w.vertexLength,C=[],I=[];for(const N of v){if(N.length===0)continue;N!==v[0]&&I.push(C.length/2);const W=this.segments2.prepareSegment(N.length,this.layoutVertexArray,this.indexArray2),V=W.vertexLength;this.layoutVertexArray.emplaceBack(N[0].x,N[0].y),this.indexArray2.emplaceBack(V+N.length-1,V),C.push(N[0].x),C.push(N[0].y);for(let q=1;q<N.length;q++)this.layoutVertexArray.emplaceBack(N[q].x,N[q].y),this.indexArray2.emplaceBack(V+q-1,V+q),C.push(N[q].x),C.push(N[q].y);W.vertexLength+=N.length,W.primitiveLength+=N.length}const D=e2(C,I);for(let N=0;N<D.length;N+=3)this.indexArray.emplaceBack(E+D[N],E+D[N+1],E+D[N+2]);w.vertexLength+=x,w.primitiveLength+=D.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,c,h,m,u,g)}}dn(t2,"FillBucket",{omit:["layers","patternFeatures"]});const pte=new Er({"fill-sort-key":new xn(rt.layout_fill["fill-sort-key"]),visibility:new Zt(rt.layout_fill.visibility)});var mte={paint:new Er({"fill-antialias":new Zt(rt.paint_fill["fill-antialias"]),"fill-opacity":new xn(rt.paint_fill["fill-opacity"]),"fill-color":new xn(rt.paint_fill["fill-color"]),"fill-outline-color":new xn(rt.paint_fill["fill-outline-color"]),"fill-translate":new Zt(rt.paint_fill["fill-translate"]),"fill-translate-anchor":new Zt(rt.paint_fill["fill-translate-anchor"]),"fill-pattern":new xn(rt.paint_fill["fill-pattern"]),"fill-emissive-strength":new Zt(rt.paint_fill["fill-emissive-strength"])}),layout:pte};const gte=B([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),yte=B([{name:"a_pos_end",components:4,type:"Int16"},{name:"a_angular_offset_factor",components:1,type:"Int16"}]),vte=B([{name:"a_centroid_pos",components:2,type:"Uint16"}]),_te=B([{name:"a_hidden_by_landmark",components:1,type:"Uint8"}]),xte=B([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:bte}=gte;var n2={},wte=Y,GF=yv;function yv(r,t,o,c,u){this.properties={},this.extent=o,this.type=0,this._pbf=r,this._geometry=-1,this._keys=c,this._values=u,r.readFields(Ste,this,t)}function Ste(r,t,o){r==1?t.id=o.readVarint():r==2?function(c,u){for(var h=c.readVarint()+c.pos;c.pos<h;){var m=u._keys[c.readVarint()],g=u._values[c.readVarint()];u.properties[m]=g}}(o,t):r==3?t.type=o.readVarint():r==4&&(t._geometry=o.pos)}function Ete(r){for(var t,o,c=0,u=0,h=r.length,m=h-1;u<h;m=u++)c+=((o=r[m]).x-(t=r[u]).x)*(t.y+o.y);return c}yv.types=["Unknown","Point","LineString","Polygon"],yv.prototype.loadGeometry=function(){var r=this._pbf;r.pos=this._geometry;for(var t,o=r.readVarint()+r.pos,c=1,u=0,h=0,m=0,g=[];r.pos<o;){if(u<=0){var v=r.readVarint();c=7&v,u=v>>3}if(u--,c===1||c===2)h+=r.readSVarint(),m+=r.readSVarint(),c===1&&(t&&g.push(t),t=[]),t.push(new wte(h,m));else{if(c!==7)throw new Error("unknown command "+c);t&&t.push(t[0].clone())}}return t&&g.push(t),g},yv.prototype.bbox=function(){var r=this._pbf;r.pos=this._geometry;for(var t=r.readVarint()+r.pos,o=1,c=0,u=0,h=0,m=1/0,g=-1/0,v=1/0,x=-1/0;r.pos<t;){if(c<=0){var w=r.readVarint();o=7&w,c=w>>3}if(c--,o===1||o===2)(u+=r.readSVarint())<m&&(m=u),u>g&&(g=u),(h+=r.readSVarint())<v&&(v=h),h>x&&(x=h);else if(o!==7)throw new Error("unknown command "+o)}return[m,v,g,x]},yv.prototype.toGeoJSON=function(r,t,o){var c,u,h=this.extent*Math.pow(2,o),m=this.extent*r,g=this.extent*t,v=this.loadGeometry(),x=yv.types[this.type];function w(I){for(var D=0;D<I.length;D++){var N=I[D];I[D]=[360*(N.x+m)/h-180,360/Math.PI*Math.atan(Math.exp((180-360*(N.y+g)/h)*Math.PI/180))-90]}}switch(this.type){case 1:var E=[];for(c=0;c<v.length;c++)E[c]=v[c][0];w(v=E);break;case 2:for(c=0;c<v.length;c++)w(v[c]);break;case 3:for(v=function(I){var D=I.length;if(D<=1)return[I];for(var N,W,V=[],q=0;q<D;q++){var Z=Ete(I[q]);Z!==0&&(W===void 0&&(W=Z<0),W===Z<0?(N&&V.push(N),N=[I[q]]):N.push(I[q]))}return N&&V.push(N),V}(v),c=0;c<v.length;c++)for(u=0;u<v[c].length;u++)w(v[c][u])}v.length===1?v=v[0]:x="Multi"+x;var C={type:"Feature",geometry:{type:x,coordinates:v},properties:this.properties};return"id"in this&&(C.id=this.id),C};var Mte=GF,HF=jF;function jF(r,t){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=r,this._keys=[],this._values=[],this._features=[],r.readFields(Tte,this,t),this.length=this._features.length}function Tte(r,t,o){r===15?t.version=o.readVarint():r===1?t.name=o.readString():r===5?t.extent=o.readVarint():r===2?t._features.push(o.pos):r===3?t._keys.push(o.readString()):r===4&&t._values.push(function(c){for(var u=null,h=c.readVarint()+c.pos;c.pos<h;){var m=c.readVarint()>>3;u=m===1?c.readString():m===2?c.readFloat():m===3?c.readDouble():m===4?c.readVarint64():m===5?c.readVarint():m===6?c.readSVarint():m===7?c.readBoolean():null}return u}(o))}jF.prototype.feature=function(r){if(r<0||r>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[r];var t=this._pbf.readVarint()+this._pbf.pos;return new Mte(this._pbf,t,this.extent,this._keys,this._values)};var Ate=HF;function Cte(r,t,o){if(r===3){var c=new Ate(o,o.readVarint()+o.pos);c.length&&(t[c.name]=c)}}var kP=n2.VectorTile=function(r,t){this.layers=r.readFields(Cte,{},t)},i2=n2.VectorTileFeature=GF;function r2(r,t,o,c){const u=[],h=c===0?(m,g,v,x,w,E)=>{m.push(new G(E,v+(E-g)/(x-g)*(w-v)))}:(m,g,v,x,w,E)=>{m.push(new G(g+(E-v)/(w-v)*(x-g),E))};for(const m of r){const g=[];for(const v of m){if(v.length<=2)continue;const x=[];for(let C=0;C<v.length-1;C++){const I=v[C].x,D=v[C].y,N=v[C+1].x,W=v[C+1].y,V=c===0?I:D,q=c===0?N:W;V<t?q>t&&h(x,I,D,N,W,t):V>o?q<o&&h(x,I,D,N,W,o):x.push(v[C]),q<t&&V>=t&&h(x,I,D,N,W,t),q>o&&V<=o&&h(x,I,D,N,W,o)}let w=v[v.length-1];const E=c===0?w.x:w.y;E>=t&&E<=o&&x.push(w),x.length&&(w=x[x.length-1],x[0].x===w.x&&x[0].y===w.y||x.push(x[0]),g.push(x))}g.length&&u.push(g)}return u}n2.VectorTileLayer=HF;class $F{constructor(t){this._stringToNumber={},this._numberToString=[];for(let o=0;o<t.length;o++){const c=t[o];this._stringToNumber[c]=o,this._numberToString[o]=c}}encode(t){return this._stringToNumber[t]}decode(t){return this._numberToString[t]}}var Pte={read:function(r,t,o,c,u){var h,m,g=8*u-c-1,v=(1<<g)-1,x=v>>1,w=-7,E=o?u-1:0,C=o?-1:1,I=r[t+E];for(E+=C,h=I&(1<<-w)-1,I>>=-w,w+=g;w>0;h=256*h+r[t+E],E+=C,w-=8);for(m=h&(1<<-w)-1,h>>=-w,w+=c;w>0;m=256*m+r[t+E],E+=C,w-=8);if(h===0)h=1-x;else{if(h===v)return m?NaN:1/0*(I?-1:1);m+=Math.pow(2,c),h-=x}return(I?-1:1)*m*Math.pow(2,h-c)},write:function(r,t,o,c,u,h){var m,g,v,x=8*h-u-1,w=(1<<x)-1,E=w>>1,C=u===23?Math.pow(2,-24)-Math.pow(2,-77):0,I=c?0:h-1,D=c?1:-1,N=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(g=isNaN(t)?1:0,m=w):(m=Math.floor(Math.log(t)/Math.LN2),t*(v=Math.pow(2,-m))<1&&(m--,v*=2),(t+=m+E>=1?C/v:C*Math.pow(2,1-E))*v>=2&&(m++,v/=2),m+E>=w?(g=0,m=w):m+E>=1?(g=(t*v-1)*Math.pow(2,u),m+=E):(g=t*Math.pow(2,E-1)*Math.pow(2,u),m=0));u>=8;r[o+I]=255&g,I+=D,g/=256,u-=8);for(m=m<<u|g,x+=u;x>0;r[o+I]=255&m,I+=D,m/=256,x-=8);r[o+I-D]|=128*N}},YF=Tr,a2=Pte;function Tr(r){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(r)?r:new Uint8Array(r||0),this.pos=0,this.type=0,this.length=this.buf.length}Tr.Varint=0,Tr.Fixed64=1,Tr.Bytes=2,Tr.Fixed32=5;var DP=4294967296,qF=1/DP,XF=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function hh(r){return r.type===Tr.Bytes?r.readVarint()+r.pos:r.pos+1}function vv(r,t,o){return o?4294967296*t+(r>>>0):4294967296*(t>>>0)+(r>>>0)}function ZF(r,t,o){var c=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(7*Math.LN2));o.realloc(c);for(var u=o.pos-1;u>=r;u--)o.buf[u+c]=o.buf[u]}function Ite(r,t){for(var o=0;o<r.length;o++)t.writeVarint(r[o])}function Rte(r,t){for(var o=0;o<r.length;o++)t.writeSVarint(r[o])}function Lte(r,t){for(var o=0;o<r.length;o++)t.writeFloat(r[o])}function kte(r,t){for(var o=0;o<r.length;o++)t.writeDouble(r[o])}function Dte(r,t){for(var o=0;o<r.length;o++)t.writeBoolean(r[o])}function zte(r,t){for(var o=0;o<r.length;o++)t.writeFixed32(r[o])}function Ote(r,t){for(var o=0;o<r.length;o++)t.writeSFixed32(r[o])}function Nte(r,t){for(var o=0;o<r.length;o++)t.writeFixed64(r[o])}function Fte(r,t){for(var o=0;o<r.length;o++)t.writeSFixed64(r[o])}function o2(r,t){return(r[t]|r[t+1]<<8|r[t+2]<<16)+16777216*r[t+3]}function _v(r,t,o){r[o]=t,r[o+1]=t>>>8,r[o+2]=t>>>16,r[o+3]=t>>>24}function KF(r,t){return(r[t]|r[t+1]<<8|r[t+2]<<16)+(r[t+3]<<24)}Tr.prototype={destroy:function(){this.buf=null},readFields:function(r,t,o){for(o=o||this.length;this.pos<o;){var c=this.readVarint(),u=c>>3,h=this.pos;this.type=7&c,r(u,t,this),this.pos===h&&this.skip(c)}return t},readMessage:function(r,t){return this.readFields(r,t,this.readVarint()+this.pos)},readFixed32:function(){var r=o2(this.buf,this.pos);return this.pos+=4,r},readSFixed32:function(){var r=KF(this.buf,this.pos);return this.pos+=4,r},readFixed64:function(){var r=o2(this.buf,this.pos)+o2(this.buf,this.pos+4)*DP;return this.pos+=8,r},readSFixed64:function(){var r=o2(this.buf,this.pos)+KF(this.buf,this.pos+4)*DP;return this.pos+=8,r},readFloat:function(){var r=a2.read(this.buf,this.pos,!0,23,4);return this.pos+=4,r},readDouble:function(){var r=a2.read(this.buf,this.pos,!0,52,8);return this.pos+=8,r},readVarint:function(r){var t,o,c=this.buf;return t=127&(o=c[this.pos++]),o<128?t:(t|=(127&(o=c[this.pos++]))<<7,o<128?t:(t|=(127&(o=c[this.pos++]))<<14,o<128?t:(t|=(127&(o=c[this.pos++]))<<21,o<128?t:function(u,h,m){var g,v,x=m.buf;if(g=(112&(v=x[m.pos++]))>>4,v<128||(g|=(127&(v=x[m.pos++]))<<3,v<128)||(g|=(127&(v=x[m.pos++]))<<10,v<128)||(g|=(127&(v=x[m.pos++]))<<17,v<128)||(g|=(127&(v=x[m.pos++]))<<24,v<128)||(g|=(1&(v=x[m.pos++]))<<31,v<128))return vv(u,g,h);throw new Error("Expected varint not more than 10 bytes")}(t|=(15&(o=c[this.pos]))<<28,r,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var r=this.readVarint();return r%2==1?(r+1)/-2:r/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var r=this.readVarint()+this.pos,t=this.pos;return this.pos=r,r-t>=12&&XF?function(o,c,u){return XF.decode(o.subarray(c,u))}(this.buf,t,r):function(o,c,u){for(var h="",m=c;m<u;){var g,v,x,w=o[m],E=null,C=w>239?4:w>223?3:w>191?2:1;if(m+C>u)break;C===1?w<128&&(E=w):C===2?(192&(g=o[m+1]))==128&&(E=(31&w)<<6|63&g)<=127&&(E=null):C===3?(v=o[m+2],(192&(g=o[m+1]))==128&&(192&v)==128&&((E=(15&w)<<12|(63&g)<<6|63&v)<=2047||E>=55296&&E<=57343)&&(E=null)):C===4&&(v=o[m+2],x=o[m+3],(192&(g=o[m+1]))==128&&(192&v)==128&&(192&x)==128&&((E=(15&w)<<18|(63&g)<<12|(63&v)<<6|63&x)<=65535||E>=1114112)&&(E=null)),E===null?(E=65533,C=1):E>65535&&(E-=65536,h+=String.fromCharCode(E>>>10&1023|55296),E=56320|1023&E),h+=String.fromCharCode(E),m+=C}return h}(this.buf,t,r)},readBytes:function(){var r=this.readVarint()+this.pos,t=this.buf.subarray(this.pos,r);return this.pos=r,t},readPackedVarint:function(r,t){if(this.type!==Tr.Bytes)return r.push(this.readVarint(t));var o=hh(this);for(r=r||[];this.pos<o;)r.push(this.readVarint(t));return r},readPackedSVarint:function(r){if(this.type!==Tr.Bytes)return r.push(this.readSVarint());var t=hh(this);for(r=r||[];this.pos<t;)r.push(this.readSVarint());return r},readPackedBoolean:function(r){if(this.type!==Tr.Bytes)return r.push(this.readBoolean());var t=hh(this);for(r=r||[];this.pos<t;)r.push(this.readBoolean());return r},readPackedFloat:function(r){if(this.type!==Tr.Bytes)return r.push(this.readFloat());var t=hh(this);for(r=r||[];this.pos<t;)r.push(this.readFloat());return r},readPackedDouble:function(r){if(this.type!==Tr.Bytes)return r.push(this.readDouble());var t=hh(this);for(r=r||[];this.pos<t;)r.push(this.readDouble());return r},readPackedFixed32:function(r){if(this.type!==Tr.Bytes)return r.push(this.readFixed32());var t=hh(this);for(r=r||[];this.pos<t;)r.push(this.readFixed32());return r},readPackedSFixed32:function(r){if(this.type!==Tr.Bytes)return r.push(this.readSFixed32());var t=hh(this);for(r=r||[];this.pos<t;)r.push(this.readSFixed32());return r},readPackedFixed64:function(r){if(this.type!==Tr.Bytes)return r.push(this.readFixed64());var t=hh(this);for(r=r||[];this.pos<t;)r.push(this.readFixed64());return r},readPackedSFixed64:function(r){if(this.type!==Tr.Bytes)return r.push(this.readSFixed64());var t=hh(this);for(r=r||[];this.pos<t;)r.push(this.readSFixed64());return r},skip:function(r){var t=7&r;if(t===Tr.Varint)for(;this.buf[this.pos++]>127;);else if(t===Tr.Bytes)this.pos=this.readVarint()+this.pos;else if(t===Tr.Fixed32)this.pos+=4;else{if(t!==Tr.Fixed64)throw new Error("Unimplemented type: "+t);this.pos+=8}},writeTag:function(r,t){this.writeVarint(r<<3|t)},realloc:function(r){for(var t=this.length||16;t<this.pos+r;)t*=2;if(t!==this.length){var o=new Uint8Array(t);o.set(this.buf),this.buf=o,this.length=t}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(r){this.realloc(4),_v(this.buf,r,this.pos),this.pos+=4},writeSFixed32:function(r){this.realloc(4),_v(this.buf,r,this.pos),this.pos+=4},writeFixed64:function(r){this.realloc(8),_v(this.buf,-1&r,this.pos),_v(this.buf,Math.floor(r*qF),this.pos+4),this.pos+=8},writeSFixed64:function(r){this.realloc(8),_v(this.buf,-1&r,this.pos),_v(this.buf,Math.floor(r*qF),this.pos+4),this.pos+=8},writeVarint:function(r){(r=+r||0)>268435455||r<0?function(t,o){var c,u;if(t>=0?(c=t%4294967296|0,u=t/4294967296|0):(u=~(-t/4294967296),4294967295^(c=~(-t%4294967296))?c=c+1|0:(c=0,u=u+1|0)),t>=18446744073709552e3||t<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");o.realloc(10),function(h,m,g){g.buf[g.pos++]=127&h|128,h>>>=7,g.buf[g.pos++]=127&h|128,h>>>=7,g.buf[g.pos++]=127&h|128,h>>>=7,g.buf[g.pos++]=127&h|128,g.buf[g.pos]=127&(h>>>=7)}(c,0,o),function(h,m){var g=(7&h)<<4;m.buf[m.pos++]|=g|((h>>>=3)?128:0),h&&(m.buf[m.pos++]=127&h|((h>>>=7)?128:0),h&&(m.buf[m.pos++]=127&h|((h>>>=7)?128:0),h&&(m.buf[m.pos++]=127&h|((h>>>=7)?128:0),h&&(m.buf[m.pos++]=127&h|((h>>>=7)?128:0),h&&(m.buf[m.pos++]=127&h)))))}(u,o)}(r,this):(this.realloc(4),this.buf[this.pos++]=127&r|(r>127?128:0),r<=127||(this.buf[this.pos++]=127&(r>>>=7)|(r>127?128:0),r<=127||(this.buf[this.pos++]=127&(r>>>=7)|(r>127?128:0),r<=127||(this.buf[this.pos++]=r>>>7&127))))},writeSVarint:function(r){this.writeVarint(r<0?2*-r-1:2*r)},writeBoolean:function(r){this.writeVarint(!!r)},writeString:function(r){r=String(r),this.realloc(4*r.length),this.pos++;var t=this.pos;this.pos=function(c,u,h){for(var m,g,v=0;v<u.length;v++){if((m=u.charCodeAt(v))>55295&&m<57344){if(!g){m>56319||v+1===u.length?(c[h++]=239,c[h++]=191,c[h++]=189):g=m;continue}if(m<56320){c[h++]=239,c[h++]=191,c[h++]=189,g=m;continue}m=g-55296<<10|m-56320|65536,g=null}else g&&(c[h++]=239,c[h++]=191,c[h++]=189,g=null);m<128?c[h++]=m:(m<2048?c[h++]=m>>6|192:(m<65536?c[h++]=m>>12|224:(c[h++]=m>>18|240,c[h++]=m>>12&63|128),c[h++]=m>>6&63|128),c[h++]=63&m|128)}return h}(this.buf,r,this.pos);var o=this.pos-t;o>=128&&ZF(t,o,this),this.pos=t-1,this.writeVarint(o),this.pos+=o},writeFloat:function(r){this.realloc(4),a2.write(this.buf,r,this.pos,!0,23,4),this.pos+=4},writeDouble:function(r){this.realloc(8),a2.write(this.buf,r,this.pos,!0,52,8),this.pos+=8},writeBytes:function(r){var t=r.length;this.writeVarint(t),this.realloc(t);for(var o=0;o<t;o++)this.buf[this.pos++]=r[o]},writeRawMessage:function(r,t){this.pos++;var o=this.pos;r(t,this);var c=this.pos-o;c>=128&&ZF(o,c,this),this.pos=o-1,this.writeVarint(c),this.pos+=c},writeMessage:function(r,t,o){this.writeTag(r,Tr.Bytes),this.writeRawMessage(t,o)},writePackedVarint:function(r,t){t.length&&this.writeMessage(r,Ite,t)},writePackedSVarint:function(r,t){t.length&&this.writeMessage(r,Rte,t)},writePackedBoolean:function(r,t){t.length&&this.writeMessage(r,Dte,t)},writePackedFloat:function(r,t){t.length&&this.writeMessage(r,Lte,t)},writePackedDouble:function(r,t){t.length&&this.writeMessage(r,kte,t)},writePackedFixed32:function(r,t){t.length&&this.writeMessage(r,zte,t)},writePackedSFixed32:function(r,t){t.length&&this.writeMessage(r,Ote,t)},writePackedFixed64:function(r,t){t.length&&this.writeMessage(r,Nte,t)},writePackedSFixed64:function(r,t){t.length&&this.writeMessage(r,Fte,t)},writeBytesField:function(r,t){this.writeTag(r,Tr.Bytes),this.writeBytes(t)},writeFixed32Field:function(r,t){this.writeTag(r,Tr.Fixed32),this.writeFixed32(t)},writeSFixed32Field:function(r,t){this.writeTag(r,Tr.Fixed32),this.writeSFixed32(t)},writeFixed64Field:function(r,t){this.writeTag(r,Tr.Fixed64),this.writeFixed64(t)},writeSFixed64Field:function(r,t){this.writeTag(r,Tr.Fixed64),this.writeSFixed64(t)},writeVarintField:function(r,t){this.writeTag(r,Tr.Varint),this.writeVarint(t)},writeSVarintField:function(r,t){this.writeTag(r,Tr.Varint),this.writeSVarint(t)},writeStringField:function(r,t){this.writeTag(r,Tr.Bytes),this.writeString(t)},writeFloatField:function(r,t){this.writeTag(r,Tr.Fixed32),this.writeFloat(t)},writeDoubleField:function(r,t){this.writeTag(r,Tr.Fixed64),this.writeDouble(t)},writeBooleanField:function(r,t){this.writeVarintField(r,!!t)}};var s2=O(YF);const Bte=["tile","layer","source","sourceLayer","state"];class JF{constructor(t,o,c,u,h){this.type="Feature",this._vectorTileFeature=t,this._z=o,this._x=c,this._y=u,this.properties=t.properties,this.id=h}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(t){this._geometry=t}toJSON(){const t={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};this.id!==void 0&&(t.id=this.id);for(const o of Bte)this[o]!==void 0&&(t[o]=this[o]);return t}}class Ute{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(t,o,c){const u=String(o);if(this.stateChanges[t]=this.stateChanges[t]||{},this.stateChanges[t][u]=this.stateChanges[t][u]||{},Fe(this.stateChanges[t][u],c),this.deletedStates[t]===null){this.deletedStates[t]={};for(const h in this.state[t])h!==u&&(this.deletedStates[t][h]=null)}else if(this.deletedStates[t]&&this.deletedStates[t][u]===null){this.deletedStates[t][u]={};for(const h in this.state[t][u])c[h]||(this.deletedStates[t][u][h]=null)}else for(const h in c)this.deletedStates[t]&&this.deletedStates[t][u]&&this.deletedStates[t][u][h]===null&&delete this.deletedStates[t][u][h]}removeFeatureState(t,o,c){if(this.deletedStates[t]===null)return;const u=String(o);if(this.deletedStates[t]=this.deletedStates[t]||{},c&&o!==void 0)this.deletedStates[t][u]!==null&&(this.deletedStates[t][u]=this.deletedStates[t][u]||{},this.deletedStates[t][u][c]=null);else if(o!==void 0)if(this.stateChanges[t]&&this.stateChanges[t][u])for(c in this.deletedStates[t][u]={},this.stateChanges[t][u])this.deletedStates[t][u][c]=null;else this.deletedStates[t][u]=null;else this.deletedStates[t]=null}getState(t,o){const c=String(o),u=Fe({},(this.state[t]||{})[c],(this.stateChanges[t]||{})[c]);if(this.deletedStates[t]===null)return{};if(this.deletedStates[t]){const h=this.deletedStates[t][o];if(h===null)return{};for(const m in h)delete u[m]}return u}initializeTileState(t,o){t.setFeatureState(this.state,o)}coalesceChanges(t,o){const c={};for(const u in this.stateChanges){this.state[u]=this.state[u]||{};const h={};for(const m in this.stateChanges[u])this.state[u][m]||(this.state[u][m]={}),Fe(this.state[u][m],this.stateChanges[u][m]),h[m]=this.state[u][m];c[u]=h}for(const u in this.deletedStates){this.state[u]=this.state[u]||{};const h={};if(this.deletedStates[u]===null)for(const m in this.state[u])h[m]={},this.state[u][m]={};else for(const m in this.deletedStates[u]){if(this.deletedStates[u][m]===null)this.state[u][m]={};else if(this.state[u][m])for(const g of Object.keys(this.deletedStates[u][m]))delete this.state[u][m][g];h[m]=this.state[u][m]}c[u]=c[u]||{},Fe(c[u],h)}if(this.stateChanges={},this.deletedStates={},Object.keys(c).length!==0)for(const u in t)t[u].setFeatureState(c,o)}}class QF{constructor(t){this.size=t,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(t,o){const c=this.toIdx(t,o);return{min:this.minimums[c],max:this.maximums[c]}}isLeaf(t,o){return this.leaves[this.toIdx(t,o)]}toIdx(t,o){return o*this.size+t}}function eB(r,t,o,c){let u=0,h=Number.MAX_VALUE;for(let m=0;m<3;m++)if(Math.abs(c[m])<1e-15){if(o[m]<r[m]||o[m]>t[m])return null}else{const g=1/c[m];let v=(r[m]-o[m])*g,x=(t[m]-o[m])*g;if(v>x){const w=v;v=x,x=w}if(v>u&&(u=v),x<h&&(h=x),u>h)return null}return u}function tB(r,t,o,c,u,h,m,g,v,x,w){const E=c-r,C=u-t,I=h-o,D=m-r,N=g-t,W=v-o,V=w[1]*W-w[2]*N,q=w[2]*D-w[0]*W,Z=w[0]*N-w[1]*D,K=E*V+C*q+I*Z;if(Math.abs(K)<1e-15)return null;const X=1/K,J=x[0]-r,ae=x[1]-t,ce=x[2]-o,ge=(J*V+ae*q+ce*Z)*X;if(ge<0||ge>1)return null;const ve=ae*I-ce*C,Pe=ce*E-J*I,Me=J*C-ae*E,Le=(w[0]*ve+w[1]*Pe+w[2]*Me)*X;return Le<0||ge+Le>1?null:(D*ve+N*Pe+W*Me)*X}function nB(r,t,o){return(r-t)/(o-t)}function iB(r,t,o,c,u,h,m,g,v){const x=1<<o,w=h-c,E=m-u,C=(r+1)/x*w+c,I=(t+0)/x*E+u,D=(t+1)/x*E+u;g[0]=(r+0)/x*w+c,g[1]=I,v[0]=C,v[1]=D}class rB{constructor(t){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=t,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const o=function(h){const m=Math.ceil(Math.log2(h.dim/8)),g=[];let v=Math.ceil(Math.pow(2,m));const x=1/v,w=(I,D,N,W,V)=>{const q=W?1:0,Z=(I+1)*N-q,K=D*N,X=(D+1)*N-q;V[0]=I*N,V[1]=K,V[2]=Z,V[3]=X};let E=new QF(v);const C=[];for(let I=0;I<v*v;I++){w(I%v,Math.floor(I/v),x,!1,C);const D=If(C[0],C[1],h),N=If(C[2],C[1],h),W=If(C[2],C[3],h),V=If(C[0],C[3],h);E.minimums.push(Math.min(D,N,W,V)),E.maximums.push(Math.max(D,N,W,V)),E.leaves.push(1)}for(g.push(E),v/=2;v>=1;v/=2){const I=g[g.length-1];E=new QF(v);for(let D=0;D<v*v;D++){w(D%v,Math.floor(D/v),2,!0,C);const N=I.getElevation(C[0],C[1]),W=I.getElevation(C[2],C[1]),V=I.getElevation(C[2],C[3]),q=I.getElevation(C[0],C[3]),Z=I.isLeaf(C[0],C[1]),K=I.isLeaf(C[2],C[1]),X=I.isLeaf(C[2],C[3]),J=I.isLeaf(C[0],C[3]),ae=Math.min(N.min,W.min,V.min,q.min),ce=Math.max(N.max,W.max,V.max,q.max),ge=Z&&K&&X&&J;E.maximums.push(ce),E.minimums.push(ae),E.leaves.push(ce-ae<=5&&ge?1:0)}g.push(E)}return g}(this.dem),c=o.length-1,u=o[c];this._addNode(u.minimums[0],u.maximums[0],u.leaves[0]),this._construct(o,0,0,c,0)}raycastRoot(t,o,c,u,h,m,g=1){return eB([t,o,-100],[c,u,this.maximums[0]*g],h,m)}raycast(t,o,c,u,h,m,g=1){if(!this.nodeCount)return null;const v=this.raycastRoot(t,o,c,u,h,m,g);if(v==null)return null;const x=[],w=[],E=[],C=[],I=[{idx:0,t:v,nodex:0,nodey:0,depth:0}];for(;I.length>0;){const{idx:D,t:N,nodex:W,nodey:V,depth:q}=I.pop();if(this.leaves[D]){iB(W,V,q,t,o,c,u,E,C);const K=1<<q,X=(W+0)/K,J=(W+1)/K,ae=(V+0)/K,ce=(V+1)/K,ge=If(X,ae,this.dem)*g,ve=If(J,ae,this.dem)*g,Pe=If(J,ce,this.dem)*g,Me=If(X,ce,this.dem)*g,Le=tB(E[0],E[1],ge,C[0],E[1],ve,C[0],C[1],Pe,h,m),Ee=tB(C[0],C[1],Pe,E[0],C[1],Me,E[0],E[1],ge,h,m),He=Math.min(Le!==null?Le:Number.MAX_VALUE,Ee!==null?Ee:Number.MAX_VALUE);if(He!==Number.MAX_VALUE)return He;{const Ke=De.scaleAndAdd([],h,m,N);if(aB(ge,ve,Me,Pe,nB(Ke[0],E[0],C[0]),nB(Ke[1],E[1],C[1]))>=Ke[2])return N}continue}let Z=0;for(let K=0;K<this._siblingOffset.length;K++){iB((W<<1)+this._siblingOffset[K][0],(V<<1)+this._siblingOffset[K][1],q+1,t,o,c,u,E,C),E[2]=-100,C[2]=this.maximums[this.childOffsets[D]+K]*g;const X=eB(E,C,h,m);if(X!=null){const J=X;x[K]=J;let ae=!1;for(let ce=0;ce<Z&&!ae;ce++)J>=x[w[ce]]&&(w.splice(ce,0,K),ae=!0);ae||(w[Z]=K),Z++}}for(let K=0;K<Z;K++){const X=w[K];I.push({idx:this.childOffsets[D]+X,t:x[X],nodex:(W<<1)+this._siblingOffset[X][0],nodey:(V<<1)+this._siblingOffset[X][1],depth:q+1})}}return null}_addNode(t,o,c){return this.minimums.push(t),this.maximums.push(o),this.leaves.push(c),this.childOffsets.push(0),this.nodeCount++}_construct(t,o,c,u,h){if(t[u].isLeaf(o,c)===1)return;this.childOffsets[h]||(this.childOffsets[h]=this.nodeCount);const m=u-1,g=t[m];let v=0,x=0;for(let w=0;w<this._siblingOffset.length;w++){const E=2*o+this._siblingOffset[w][0],C=2*c+this._siblingOffset[w][1],I=g.getElevation(E,C),D=g.isLeaf(E,C),N=this._addNode(I.min,I.max,D);D&&(v|=1<<w),x||(x=N)}for(let w=0;w<this._siblingOffset.length;w++)v&1<<w||this._construct(t,2*o+this._siblingOffset[w][0],2*c+this._siblingOffset[w][1],m,x+w)}}function aB(r,t,o,c,u,h){return kn(kn(r,o,h),kn(t,c,h),u)}function If(r,t,o){const c=o.dim,u=re(r*c-.5,0,c-1),h=re(t*c-.5,0,c-1),m=Math.floor(u),g=Math.floor(h),v=Math.min(m+1,c-1),x=Math.min(g+1,c-1);return aB(o.get(m,g),o.get(v,g),o.get(m,x),o.get(v,x),u-m,h-g)}const oB={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768],float:[1,1,1,1]};function zP(r,t,o){return(256*r*256+256*t+o)/10-1e4}function OP(r,t,o){return 256*r+t+o/256-32768}class Rm{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(t,o,c,u,h=!1){if(this.uid=t,o.height!==o.width)throw new RangeError("DEM tiles must be square");if(c&&c!=="mapbox"&&c!=="terrarium")return xe(`"${c}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=o.height;const m=this.dim=o.height-2,g=new Uint32Array(o.data.buffer);if(this.pixels=new Uint8Array(o.data.buffer),this.encoding=c||"mapbox",this.borderReady=h,this._modifiedForSources={},!h){for(let v=0;v<m;v++)g[this._idx(-1,v)]=g[this._idx(0,v)],g[this._idx(m,v)]=g[this._idx(m-1,v)],g[this._idx(v,-1)]=g[this._idx(v,0)],g[this._idx(v,m)]=g[this._idx(v,m-1)];g[this._idx(-1,-1)]=g[this._idx(0,0)],g[this._idx(m,-1)]=g[this._idx(m-1,0)],g[this._idx(-1,m)]=g[this._idx(0,m-1)],g[this._idx(m,m)]=g[this._idx(m-1,m-1)]}if(u){const v=new Float32Array(o.data.buffer),x=this.encoding==="terrarium"?OP:zP;for(let w=0;w<g.length;++w){const E=4*w;v[w]=x(this.pixels[E],this.pixels[E+1],this.pixels[E+2])}this.encoding="float"}this._timestamp=Pn.now()}_buildQuadTree(){this._tree=new rB(this)}get(t,o,c=!1){c&&(t=re(t,-1,this.dim),o=re(o,-1,this.dim));const u=this._idx(t,o);if(this.encoding==="float")return this.floatView||(this.floatView=new Float32Array(this.pixels.buffer)),this.floatView[u];const h=4*u;return(this.encoding==="terrarium"?OP:zP)(this.pixels[h],this.pixels[h+1],this.pixels[h+2])}set(t,o,c){const u=this._idx(t,o);if(this.encoding==="float"){this.floatView||(this.floatView=new Float32Array(this.pixels.buffer));const v=this.floatView[u];return this.floatView[u]=c,c-v}const h=4*u,m=(this.encoding==="terrarium"?OP:zP)(this.pixels[h],this.pixels[h+1],this.pixels[h+2]),g=Rm.pack(c,this.encoding==="terrarium"?"terrarium":"mapbox");return this.pixels[h]=g[0],this.pixels[h+1]=g[1],this.pixels[h+2]=g[2],c-m}static getUnpackVector(t){return oB[t]}get unpackVector(){return oB[this.encoding]}_idx(t,o){if(t<-1||t>=this.dim+1||o<-1||o>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(o+1)*this.stride+(t+1)}static pack(t,o){const c=[0,0,0,0],u=Rm.getUnpackVector(o);let h=Math.floor((t+u[3])/u[2]);return c[2]=h%256,h=Math.floor(h/256),c[1]=h%256,h=Math.floor(h/256),c[0]=h,c}getPixels(){return this.encoding==="float"?new FF({width:this.stride,height:this.stride},this.pixels):new Jr({width:this.stride,height:this.stride},this.pixels)}backfillBorder(t,o,c){if(this.dim!==t.dim)throw new Error("dem dimension mismatch");let u=o*this.dim,h=o*this.dim+this.dim,m=c*this.dim,g=c*this.dim+this.dim;switch(o){case-1:u=h-1;break;case 1:h=u+1}switch(c){case-1:m=g-1;break;case 1:g=m+1}const v=-o*this.dim,x=-c*this.dim;for(let w=m;w<g;w++)for(let E=u;E<h;E++){const C=4*this._idx(E,w),I=4*this._idx(E+v,w+x);this.pixels[C+0]=t.pixels[I+0],this.pixels[C+1]=t.pixels[I+1],this.pixels[C+2]=t.pixels[I+2],this.pixels[C+3]=t.pixels[I+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}dn(Rm,"DEMData"),dn(rB,"DemMinMaxQuadTree",{omit:["dem"]});class Wte{isDataAvailableAtPoint(t){const o=this._source();if(this.isUsingMockSource()||!o||t.y<0||t.y>1)return!1;const c=o.getSource().maxzoom,u=1<<c,h=Math.floor(t.x),m=Math.floor((t.x-h)*u),g=Math.floor(t.y*u),v=this.findDEMTileFor(new ki(c,h,c,m,g));return!(!v||!v.dem)}getAtPointOrZero(t,o=0){return this.getAtPoint(t,o)||0}getAtPoint(t,o,c=!0){if(this.isUsingMockSource())return null;o==null&&(o=null);const u=this._source();if(!u||t.y<0||t.y>1)return o;const h=u.getSource().maxzoom,m=1<<h,g=Math.floor(t.x),v=t.x-g,x=new ki(h,g,h,Math.floor(v*m),Math.floor(t.y*m)),w=this.findDEMTileFor(x);if(!w||!w.dem)return o;const E=w.dem,C=1<<w.tileID.canonical.z,I=(v*C-w.tileID.canonical.x)*E.dim,D=(t.y*C-w.tileID.canonical.y)*E.dim,N=Math.floor(I),W=Math.floor(D);return(c?this.exaggeration():1)*kn(kn(E.get(N,W),E.get(N,W+1),D-W),kn(E.get(N+1,W),E.get(N+1,W+1),D-W),I-N)}getAtTileOffset(t,o,c){const u=1<<t.canonical.z;return this.getAtPointOrZero(new bi(t.wrap+(t.canonical.x+o/mt)/u,(t.canonical.y+c/mt)/u))}getAtTileOffsetFunc(t,o,c,u){return h=>{const m=this.getAtTileOffset(t,h.x,h.y),g=u.upVector(t.canonical,h.x,h.y),v=u.upVectorScale(t.canonical,o,c).metersToTile;return De.scale(g,g,m*v),g}}getForTilePoints(t,o,c,u){if(this.isUsingMockSource())return!1;const h=xv.create(this,t,u);return!!h&&(o.forEach(m=>{m[2]=this.exaggeration()*h.getElevationAt(m[0],m[1],c)}),!0)}getMinMaxForTile(t){if(this.isUsingMockSource())return null;const o=this.findDEMTileFor(t);if(!o||!o.dem)return null;const c=o.dem.tree,u=o.tileID,h=1<<t.canonical.z-u.canonical.z;let m=t.canonical.x/h-u.canonical.x,g=t.canonical.y/h-u.canonical.y,v=0;for(let x=0;x<t.canonical.z-u.canonical.z&&!c.leaves[v];x++){m*=2,g*=2;const w=2*Math.floor(g)+Math.floor(m);v=c.childOffsets[v]+w,m%=1,g%=1}return{min:this.exaggeration()*c.minimums[v],max:this.exaggeration()*c.maximums[v]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(t,o,c){throw new Error("Pure virtual method called.")}pointCoordinate(t){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(t){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}}class xv{constructor(t,o,c){this._demTile=t,this._dem=this._demTile.dem,this._scale=o,this._offset=c}static create(t,o,c){const u=c||t.findDEMTileFor(o);if(!u||!u.dem)return;const h=u.dem,m=u.tileID,g=1<<o.canonical.z-m.canonical.z;return new xv(u,h.dim/mt/g,[(o.canonical.x/g-m.canonical.x)*h.dim,(o.canonical.y/g-m.canonical.y)*h.dim])}tileCoordToPixel(t,o){const c=o*this._scale+this._offset[1],u=Math.floor(t*this._scale+this._offset[0]),h=Math.floor(c);return new G(u,h)}getElevationAt(t,o,c,u){const h=t*this._scale+this._offset[0],m=o*this._scale+this._offset[1],g=Math.floor(h),v=Math.floor(m),x=this._dem;return u=!!u,c?kn(kn(x.get(g,v,u),x.get(g,v+1,u),m-v),kn(x.get(g+1,v,u),x.get(g+1,v+1,u),m-v),h-g):x.get(g,v,u)}getElevationAtPixel(t,o,c){return this._dem.get(t,o,!!c)}getMeterToDEM(t){return(1<<this._demTile.tileID.canonical.z)*Xi(1,t)*this._dem.stride}}class NP{constructor(t,o){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new to(mt,16,0),this.featureIndexArray=new OO,this.promoteId=o}insert(t,o,c,u,h,m=0){const g=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(c,u,h,m);const v=this.grid;for(let x=0;x<o.length;x++){const w=o[x],E=[1/0,1/0,-1/0,-1/0];for(let C=0;C<w.length;C++){const I=w[C];E[0]=Math.min(E[0],I.x),E[1]=Math.min(E[1],I.y),E[2]=Math.max(E[2],I.x),E[3]=Math.max(E[3],I.y)}E[0]<mt&&E[1]<mt&&E[2]>=0&&E[3]>=0&&v.insert(g,E[0],E[1],E[2],E[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new kP(new s2(this.rawTileData)).layers,this.sourceLayerCoder=new $F(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const t in this.vtLayers)this.vtFeatures[t]=[]}return this.vtLayers}query(t,o,c,u){this.loadVTLayers();const h=t.params||{},m=fm(h.filter),g=t.tileResult,v=t.transform,x=g.bufferedTilespaceBounds,w=this.grid.query(x.min.x,x.min.y,x.max.x,x.max.y,(D,N,W,V)=>PF(g.bufferedTilespaceGeometry,D,N,W,V));w.sort(Vte);let E=null;v.elevation&&w.length>0&&(E=xv.create(v.elevation,this.tileID));const C={};let I;for(let D=0;D<w.length;D++){const N=w[D];if(N===I)continue;I=N;const W=this.featureIndexArray.get(N);let V=null;this.loadMatchingFeature(C,W,m,h.layers,h.availableImages,o,c,u,(q,Z,K,X=0)=>(V||(V=Zu(q,this.tileID.canonical,t.tileTransform)),Z.queryIntersectsFeature(g,q,K,V,this.z,t.transform,t.pixelPosMatrix,E,X)))}return C}loadMatchingFeature(t,o,c,u,h,m,g,v,x){const{featureIndex:w,bucketIndex:E,sourceLayerIndex:C,layoutVertexArrayOffset:I}=o,D=this.bucketLayerIDs[E];if(u&&!function(q,Z){for(let K=0;K<q.length;K++)if(Z.indexOf(q[K])>=0)return!0;return!1}(u,D))return;const N=this.sourceLayerCoder.decode(C),W=this.vtLayers[N].feature(w);if(c.needGeometry){const q=Cf(W,!0);if(!c.filter(new dr(this.tileID.overscaledZ),q,this.tileID.canonical))return}else if(!c.filter(new dr(this.tileID.overscaledZ),W))return;const V=this.getId(W,N);for(let q=0;q<D.length;q++){const Z=D[q];if(u&&u.indexOf(Z)<0)continue;const K=m[Z];if(!K)continue;let X={};V!==void 0&&v&&(X=v.getState(K.sourceLayer||"_geojsonTileLayer",V));const J=Fe({},g[Z]);J.paint=sB(J.paint,K.paint,W,X,h),J.layout=sB(J.layout,K.layout,W,X,h);const ae=!x||x(W,K,X,I);if(!ae)continue;const ce=new JF(W,this.z,this.x,this.y,V);ce.layer=J;let ge=t[Z];ge===void 0&&(ge=t[Z]=[]),ge.push({featureIndex:w,feature:ce,intersectionZ:ae})}}lookupSymbolFeatures(t,o,c,u,h,m,g,v){const x={};this.loadVTLayers();const w=fm(h);for(const E of t)this.loadMatchingFeature(x,{bucketIndex:c,sourceLayerIndex:u,featureIndex:E,layoutVertexArrayOffset:0},w,m,g,v,o);return x}loadFeature(t){const{featureIndex:o,sourceLayerIndex:c}=t;this.loadVTLayers();const u=this.sourceLayerCoder.decode(c),h=this.vtFeatures[u];if(h[o])return h[o];const m=this.vtLayers[u].feature(o);return h[o]=m,m}hasLayer(t){for(const o of this.bucketLayerIDs)for(const c of o)if(t===c)return!0;return!1}getId(t,o){let c=t.id;if(this.promoteId){const u=typeof this.promoteId=="string"?this.promoteId:this.promoteId[o];u!=null&&(c=t.properties[u]),typeof c=="boolean"&&(c=Number(c))}return c}}function sB(r,t,o,c,u){return _t(r,(h,m)=>{const g=t instanceof $u?t.get(m):null;return g&&g.evaluate?g.evaluate(o,c,u):g})}function Vte(r,t){return t-r}dn(NP,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});const Gte=B([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Hte=B([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),jte=B([{name:"a_projected_pos",components:4,type:"Float32"}],4);B([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const $te=B([{name:"a_z_offset",components:1,type:"Float32"}],4),Yte=B([{name:"a_texb",components:2,type:"Uint16"}]),qte=B([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),Xte=B([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"}]);B([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const lB=B([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),Zte=B([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);B([{name:"triangle",components:3,type:"Uint16"}]),B([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),B([{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Float32",name:"zOffset"},{type:"Uint8",name:"hasIconTextFit"}]),B([{type:"Float32",name:"offsetX"}]),B([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var ao=24;const Qc=128;function FP(r,t){const{expression:o}=t;if(o.kind==="constant")return{kind:"constant",layoutSize:o.evaluate(new dr(r+1))};if(o.kind==="source")return{kind:"source"};{const{zoomStops:c,interpolationType:u}=o;let h=0;for(;h<c.length&&c[h]<=r;)h++;h=Math.max(0,h-1);let m=h;for(;m<c.length&&c[m]<r+1;)m++;m=Math.min(c.length-1,m);const g=c[h],v=c[m];return o.kind==="composite"?{kind:"composite",minZoom:g,maxZoom:v,interpolationType:u}:{kind:"camera",minZoom:g,maxZoom:v,minSize:o.evaluate(new dr(g)),maxSize:o.evaluate(new dr(v)),interpolationType:u}}}function S1(r,{uSize:t,uSizeT:o},{lowerSize:c,upperSize:u}){return r.kind==="source"?c/Qc:r.kind==="composite"?kn(c/Qc,u/Qc,o):t}function Ku(r,t){let o=0,c=0;if(r.kind==="constant")c=r.layoutSize;else if(r.kind!=="source"){const{interpolationType:u,minZoom:h,maxZoom:m}=r,g=u?re(fc.interpolationFactor(u,t,h,m),0,1):0;r.kind==="camera"?c=kn(r.minSize,r.maxSize,g):o=g}return{uSizeT:o,uSize:c}}var Kte=Object.freeze({__proto__:null,SIZE_PACK_FACTOR:Qc,evaluateSizeForFeature:S1,evaluateSizeForZoom:Ku,getSizeData:FP});function Jte(r,t,o){return r.sections.forEach(c=>{c.text=function(u,h,m){const g=h.layout.get("text-transform").evaluate(m,{});return g==="uppercase"?u=u.toLocaleUpperCase():g==="lowercase"&&(u=u.toLocaleLowerCase()),Ns.applyArabicShaping&&(u=Ns.applyArabicShaping(u)),u}(c.text,t,o)}),r}const E1={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};function Qte(r){return r===""||r===""||r===""||r===""||r===""||r===""||r===""||r===""||r===""||r===""||r===""||r===""||r===""||r===""||r===""||r===""||r===""}function ene(r){return r===""||r===""||r===""||r===""||r===""||r===""||r===""||r===""||r===""||r===""}const BP=3;function tne(r,t,o){t.glyphs=[],r===1&&o.readMessage(nne,t)}function nne(r,t,o){if(r===3){const{id:c,bitmap:u,width:h,height:m,left:g,top:v,advance:x}=o.readMessage(ine,{});t.glyphs.push({id:c,bitmap:new dh({width:h+2*BP,height:m+2*BP},u),metrics:{width:h,height:m,left:g,top:v,advance:x}})}else r===4?t.ascender=o.readSVarint():r===5&&(t.descender=o.readSVarint())}function ine(r,t,o){r===1?t.id=o.readVarint():r===2?t.bitmap=o.readBytes():r===3?t.width=o.readVarint():r===4?t.height=o.readVarint():r===5?t.left=o.readSVarint():r===6?t.top=o.readSVarint():r===7&&(t.advance=o.readVarint())}const cB=BP;function UP(r){let t=0,o=0;for(const m of r)t+=m.w*m.h,o=Math.max(o,m.w);r.sort((m,g)=>g.h-m.h);const c=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),o),h:1/0}];let u=0,h=0;for(const m of r)for(let g=c.length-1;g>=0;g--){const v=c[g];if(!(m.w>v.w||m.h>v.h)){if(m.x=v.x,m.y=v.y,h=Math.max(h,m.y+m.h),u=Math.max(u,m.x+m.w),m.w===v.w&&m.h===v.h){const x=c.pop();g<c.length&&(c[g]=x)}else m.h===v.h?(v.x+=m.w,v.w-=m.w):m.w===v.w?(v.y+=m.h,v.h-=m.h):(c.push({x:v.x+m.w,y:v.y,w:v.w-m.w,h:m.h}),v.y+=m.h,v.h-=m.h);break}}return{w:u,h,fill:t/(u*h)||0}}const Ws=1;class WP{constructor(t,{pixelRatio:o,version:c,stretchX:u,stretchY:h,content:m}){this.paddedRect=t,this.pixelRatio=o,this.stretchX=u,this.stretchY=h,this.content=m,this.version=c}get tl(){return[this.paddedRect.x+Ws,this.paddedRect.y+Ws]}get br(){return[this.paddedRect.x+this.paddedRect.w-Ws,this.paddedRect.y+this.paddedRect.h-Ws]}get displaySize(){return[(this.paddedRect.w-2*Ws)/this.pixelRatio,(this.paddedRect.h-2*Ws)/this.pixelRatio]}}class uB{constructor(t,o){const c={},u={};this.haveRenderCallbacks=[];const h=[];this.addImages(t,c,h),this.addImages(o,u,h);const{w:m,h:g}=UP(h),v=new Jr({width:m||1,height:g||1});for(const x in t){const w=t[x],E=c[x].paddedRect;Jr.copy(w.data,v,{x:0,y:0},{x:E.x+Ws,y:E.y+Ws},w.data)}for(const x in o){const w=o[x],E=u[x].paddedRect,C=E.x+Ws,I=E.y+Ws,D=w.data.width,N=w.data.height;Jr.copy(w.data,v,{x:0,y:0},{x:C,y:I},w.data),Jr.copy(w.data,v,{x:0,y:N-1},{x:C,y:I-1},{width:D,height:1}),Jr.copy(w.data,v,{x:0,y:0},{x:C,y:I+N},{width:D,height:1}),Jr.copy(w.data,v,{x:D-1,y:0},{x:C-1,y:I},{width:1,height:N}),Jr.copy(w.data,v,{x:0,y:0},{x:C+D,y:I},{width:1,height:N})}this.image=v,this.iconPositions=c,this.patternPositions=u}addImages(t,o,c){for(const u in t){const h=t[u],m={x:0,y:0,w:h.data.width+2*Ws,h:h.data.height+2*Ws};c.push(m),o[u]=new WP(m,h),h.hasRenderCallback&&this.haveRenderCallbacks.push(u)}}patchUpdatedImages(t,o,c){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(u=>t.hasImage(u,c)),t.dispatchRenderCallbacks(this.haveRenderCallbacks,c);for(const u in t.getUpdatedImages(c))this.patchUpdatedImage(this.iconPositions[u],t.getImage(u,c),o),this.patchUpdatedImage(this.patternPositions[u],t.getImage(u,c),o)}patchUpdatedImage(t,o,c){if(!t||!o||t.version===o.version)return;t.version=o.version;const[u,h]=t.tl;c.update(o.data,void 0,{x:u,y:h})}}dn(WP,"ImagePosition"),dn(uB,"ImageAtlas");const Ar={horizontal:1,vertical:2,horizontalOnly:3},dB=-17;class M1{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(t,o){const c=new M1;return c.scale=t||1,c.fontStack=o,c}static forImage(t){const o=new M1;return o.imageName=t,o}}class bv{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(t,o){const c=new bv;for(let u=0;u<t.sections.length;u++){const h=t.sections[u];h.image?c.addImageSection(h):c.addTextSection(h,o)}return c}length(){return this.text.length}getSection(t){return this.sections[this.sectionIndex[t]]}getSections(){return this.sections}getSectionIndex(t){return this.sectionIndex[t]}getCodePoint(t){return this.text.codePointAt(t)}verticalizePunctuation(t){this.text=function(o,c){let u="";for(let h=0;h<o.length;h++){const m=o.charCodeAt(h+1)||null,g=o.charCodeAt(h-1)||null;u+=!c&&(m&&tv(m)&&!E1[o[h+1]]||g&&tv(g)&&!E1[o[h-1]])||!E1[o[h]]?o[h]:E1[o[h]]}return u}(this.text,t)}trim(){let t=0;for(let c=0;c<this.text.length&&l2[this.text.charCodeAt(c)];c++)t++;let o=this.text.length;for(let c=this.text.length-1;c>=0&&c>=t&&l2[this.text.charCodeAt(c)];c--)o--;this.text=this.text.substring(t,o),this.sectionIndex=this.sectionIndex.slice(t,o)}substring(t,o){const c=new bv;return c.text=this.text.substring(t,o),c.sectionIndex=this.sectionIndex.slice(t,o),c.sections=this.sections,c}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((t,o)=>Math.max(t,this.sections[o].scale),0)}addTextSection(t,o){this.text+=t.text,this.sections.push(M1.forText(t.scale,t.fontStack||o));const c=this.sections.length-1;for(let u=0;u<t.text.length;++u)this.sectionIndex.push(c)}addImageSection(t){const o=t.image?t.image.namePrimary:"";if(o.length===0)return void xe("Can't add FormattedSection with an empty image.");const c=this.getNextImageSectionCharCode();c?(this.text+=String.fromCodePoint(c),this.sections.push(M1.forImage(o)),this.sectionIndex.push(this.sections.length-1)):xe("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function VP(r,t,o,c,u,h,m,g,v,x,w,E,C,I,D){const N=bv.fromFeature(r,u);E===Ar.vertical&&N.verticalizePunctuation(C);let W=[];const V=function(J,ae,ce,ge,ve,Pe){if(!J)return[];const Me=[],Le=function(nt,Ve,je,ot,yt,ft){let Lt=0;for(let Ft=0;Ft<nt.length();Ft++){const St=nt.getSection(Ft);Lt+=hB(nt.getCodePoint(Ft),St,ot,yt,Ve,ft)}return Lt/Math.max(1,Math.ceil(Lt/je))}(J,ae,ce,ge,ve,Pe),Ee=J.text.indexOf("")>=0;let He=0;for(let nt=0;nt<J.length();nt++){const Ve=J.getSection(nt),je=J.getCodePoint(nt);if(l2[je]||(He+=hB(je,Ve,ge,ve,ae,Pe)),nt<J.length()-1){const ot=!((Ke=je)<11904||!(gn["Bopomofo Extended"](Ke)||gn.Bopomofo(Ke)||gn["CJK Compatibility Forms"](Ke)||gn["CJK Compatibility Ideographs"](Ke)||gn["CJK Compatibility"](Ke)||gn["CJK Radicals Supplement"](Ke)||gn["CJK Strokes"](Ke)||gn["CJK Symbols and Punctuation"](Ke)||gn["CJK Unified Ideographs Extension A"](Ke)||gn["CJK Unified Ideographs"](Ke)||gn["Enclosed CJK Letters and Months"](Ke)||gn["Halfwidth and Fullwidth Forms"](Ke)||gn.Hiragana(Ke)||gn["Ideographic Description Characters"](Ke)||gn["Kangxi Radicals"](Ke)||gn["Katakana Phonetic Extensions"](Ke)||gn.Katakana(Ke)||gn["Vertical Forms"](Ke)||gn["Yi Radicals"](Ke)||gn["Yi Syllables"](Ke)));(rne[je]||ot||Ve.imageName)&&Me.push(pB(nt+1,He,Le,Me,ane(je,J.getCodePoint(nt+1),ot&&Ee),!1))}}var Ke;return mB(pB(J.length(),He,Le,Me,0,!0))}(N,x,h,t,c,I),{processBidirectionalText:q,processStyledBidirectionalText:Z}=Ns;if(q&&N.sections.length===1){const J=q(N.toString(),V);for(const ae of J){const ce=new bv;ce.text=ae,ce.sections=N.sections;for(let ge=0;ge<ae.length;ge++)ce.sectionIndex.push(0);W.push(ce)}}else if(Z){const J=Z(N.text,N.sectionIndex,V);for(const ae of J){const ce=new bv;ce.text=ae[0],ce.sectionIndex=ae[1],ce.sections=N.sections,W.push(ce)}}else W=function(J,ae){const ce=[],ge=J.text;let ve=0;for(const Pe of ae)ce.push(J.substring(ve,Pe)),ve=Pe;return ve<ge.length&&ce.push(J.substring(ve,ge.length)),ce}(N,V);const K=[],X={positionedLines:K,text:N.toString(),top:w[1],bottom:w[1],left:w[0],right:w[0],writingMode:E,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(J,ae,ce,ge,ve,Pe,Me,Le,Ee,He,Ke,nt){let Ve=0,je=0,ot=0;const yt=Le==="right"?1:Le==="left"?0:.5;let ft=!1;for(const ln of ve){const sn=ln.getSections();for(const un of sn){if(un.imageName)continue;const vn=ae[un.fontStack];if(vn&&(ft=vn.ascender!==void 0&&vn.descender!==void 0,!ft))break}if(!ft)break}let Lt=0;for(const ln of ve){ln.trim();const sn=ln.getMaxScale(),un=(sn-1)*ao,vn={positionedGlyphs:[],lineOffset:0};J.positionedLines[Lt]=vn;const zn=vn.positionedGlyphs;let ai=0;if(!ln.length()){je+=Pe,++Lt;continue}let Ai=0,Xn=0;for(let Ln=0;Ln<ln.length();Ln++){const An=ln.getSection(Ln),vi=ln.getSectionIndex(Ln),Li=ln.getCodePoint(Ln);let ri=An.scale,Ji=null,Cr=null,hr=null,or=ao,ca=0;const Pr=!(Ee===Ar.horizontal||!Ke&&!ev(Li)||Ke&&(l2[Li]||(Ft=Li,gn.Arabic(Ft)||gn["Arabic Supplement"](Ft)||gn["Arabic Extended-A"](Ft)||gn["Arabic Presentation Forms-A"](Ft)||gn["Arabic Presentation Forms-B"](Ft))));if(An.imageName){const Wr=ge[An.imageName];if(!Wr)continue;hr=An.imageName,J.iconsInText=J.iconsInText||!0,Cr=Wr.paddedRect;const Qi=Wr.displaySize;ri=ri*ao/nt,Ji={width:Qi[0],height:Qi[1],left:Ws,top:-cB,advance:Pr?Qi[1]:Qi[0],localGlyph:!1},ca=ft?-Ji.height*ri:dB+sn*ao-Qi[1]*ri,or=Ji.advance;const ps=(Pr?Qi[0]:Qi[1])*ri-ao*sn;ps>0&&ps>ai&&(ai=ps)}else{const Wr=ce[An.fontStack];if(!Wr)continue;Wr[Li]&&(Cr=Wr[Li]);const Qi=ae[An.fontStack];if(!Qi)continue;const ps=Qi.glyphs[Li];if(!ps)continue;if(Ji=ps.metrics,or=Li!==8203?ao:0,ft){const rd=Qi.ascender!==void 0?Math.abs(Qi.ascender):0,ph=Qi.descender!==void 0?Math.abs(Qi.descender):0,mh=(rd+ph)*ri;Ai<mh&&(Ai=mh,Xn=(rd-ph)/2*ri),ca=-rd*ri}else ca=dB+(sn-ri)*ao}Pr?(J.verticalizable=!0,zn.push({glyph:Li,imageName:hr,x:Ve,y:je+ca,vertical:Pr,scale:ri,localGlyph:Ji.localGlyph,fontStack:An.fontStack,sectionIndex:vi,metrics:Ji,rect:Cr}),Ve+=or*ri+He):(zn.push({glyph:Li,imageName:hr,x:Ve,y:je+ca,vertical:Pr,scale:ri,localGlyph:Ji.localGlyph,fontStack:An.fontStack,sectionIndex:vi,metrics:Ji,rect:Cr}),Ve+=Ji.advance*ri+He)}zn.length!==0&&(ot=Math.max(Ve-He,ot),ft?gB(zn,yt,ai,Xn,Pe*sn/2):gB(zn,yt,ai,0,Pe/2)),Ve=0;const Gn=Pe*sn+ai;vn.lineOffset=Math.max(ai,un),je+=Gn,++Lt}var Ft;const St=je,{horizontalAlign:Ct,verticalAlign:rn}=c2(Me);(function(ln,sn,un,vn,zn,ai){const Ai=(sn-un)*zn,Xn=-ai*vn;for(const Gn of ln)for(const Ln of Gn.positionedGlyphs)Ln.x+=Ai,Ln.y+=Xn})(J.positionedLines,yt,Ct,rn,ot,St),J.top+=-rn*St,J.bottom=J.top+St,J.left+=-Ct*ot,J.right=J.left+ot,J.hasBaseline=ft}(X,t,o,c,W,m,g,v,E,x,C,D),!function(J){for(const ae of J)if(ae.positionedGlyphs.length!==0)return!1;return!0}(K)&&X}const l2={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},rne={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function hB(r,t,o,c,u,h){if(t.imageName){const m=c[t.imageName];return m?m.displaySize[0]*t.scale*ao/h+u:0}{const m=o[t.fontStack],g=m&&m.glyphs[r];return g?g.metrics.advance*t.scale+u:0}}function fB(r,t,o,c){const u=Math.pow(r-t,2);return c?r<t?u/2:2*u:u+Math.abs(o)*o}function ane(r,t,o){let c=0;return r===10&&(c-=1e4),o&&(c+=150),r!==40&&r!==65288||(c+=50),t!==41&&t!==65289||(c+=50),c}function pB(r,t,o,c,u,h){let m=null,g=fB(t,o,u,h);for(const v of c){const x=fB(t-v.x,o,u,h)+v.badness;x<=g&&(m=v,g=x)}return{index:r,x:t,priorBreak:m,badness:g}}function mB(r){return r?mB(r.priorBreak).concat(r.index):[]}function c2(r){let t=.5,o=.5;switch(r){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(r){case"bottom":case"bottom-right":case"bottom-left":o=1;break;case"top":case"top-right":case"top-left":o=0}return{horizontalAlign:t,verticalAlign:o}}function gB(r,t,o,c,u){if(!(t||o||c||u))return;const h=r.length-1,m=r[h],g=(m.x+m.metrics.advance*m.scale)*t;for(let v=0;v<=h;v++)r[v].x-=g,r[v].y+=o+c+u}function one(r,t,o,c){const{horizontalAlign:u,verticalAlign:h}=c2(c),m=o[0]-r.displaySize[0]*u,g=o[1]-r.displaySize[1]*h;return{imagePrimary:r,imageSecondary:t,top:g,bottom:g+r.displaySize[1],left:m,right:m+r.displaySize[0]}}function yB(r,t,o,c,u,h){const m=r.imagePrimary;let g;if(m.content){const W=m.content,V=m.pixelRatio||1;g=[W[0]/V,W[1]/V,m.displaySize[0]-W[2]/V,m.displaySize[1]-W[3]/V]}const v=t.left*h,x=t.right*h;let w,E,C,I;o==="width"||o==="both"?(I=u[0]+v-c[3],E=u[0]+x+c[1]):(I=u[0]+(v+x-m.displaySize[0])/2,E=I+m.displaySize[0]);const D=t.top*h,N=t.bottom*h;return o==="height"||o==="both"?(w=u[1]+D-c[0],C=u[1]+N+c[2]):(w=u[1]+(D+N-m.displaySize[1])/2,C=w+m.displaySize[1]),{imagePrimary:m,imageSecondary:void 0,top:w,right:E,bottom:C,left:I,collisionPadding:g}}class fh extends G{constructor(t,o,c,u,h){super(t,o),this.angle=u,this.z=c,h!==void 0&&(this.segment=h)}clone(){return new fh(this.x,this.y,this.z,this.angle,this.segment)}}function vB(r,t,o,c,u){if(t.segment===void 0)return!0;let h=t,m=t.segment+1,g=0;for(;g>-o/2;){if(m--,m<0)return!1;g-=r[m].dist(h),h=r[m]}g+=r[m].dist(r[m+1]),m++;const v=[];let x=0;for(;g<o/2;){const w=r[m],E=r[m+1];if(!E)return!1;let C=r[m-1].angleTo(w)-w.angleTo(E);for(C=Math.abs((C+3*Math.PI)%(2*Math.PI)-Math.PI),v.push({distance:g,angleDelta:C}),x+=C;g-v[0].distance>c;)x-=v.shift().angleDelta;if(x>u)return!1;m++,g+=w.dist(E)}return!0}function _B(r){let t=0;for(let o=0;o<r.length-1;o++)t+=r[o].dist(r[o+1]);return t}function xB(r,t,o){return r?.6*t*o:0}function bB(r,t){return Math.max(r?r.right-r.left:0,t?t.right-t.left:0)}function sne(r,t,o,c,u,h){const m=xB(o,u,h),g=bB(o,c)*h;let v=0;const x=_B(r)/2;for(let w=0;w<r.length-1;w++){const E=r[w],C=r[w+1],I=E.dist(C);if(v+I>x){const D=(x-v)/I,N=kn(E.x,C.x,D),W=kn(E.y,C.y,D),V=new fh(N,W,0,C.angleTo(E),w);return!m||vB(r,V,g,m,t)?V:void 0}v+=I}}function lne(r,t,o,c,u,h,m,g,v){const x=xB(c,h,m),w=bB(c,u),E=w*m,C=r[0].x===0||r[0].x===v||r[0].y===0||r[0].y===v;return t-E<t/4&&(t=E+t/4),wB(r,C?t/2*g%t:(w/2+2*h)*m*g%t,t,x,o,E,C,!1,v)}function wB(r,t,o,c,u,h,m,g,v){const x=h/2,w=_B(r);let E=0,C=t-o,I=[];for(let D=0;D<r.length-1;D++){const N=r[D],W=r[D+1],V=N.dist(W),q=W.angleTo(N);for(;C+o<E+V;){C+=o;const Z=(C-E)/V,K=kn(N.x,W.x,Z),X=kn(N.y,W.y,Z);if(K>=0&&K<v&&X>=0&&X<v&&C-x>=0&&C+x<=w){const J=new fh(K,X,0,q,D);c&&!vB(r,J,h,c,u)||I.push(J)}}E+=V}return g||I.length||m||(I=wB(r,E/2,o,c,u,h,m,!0,v)),I}function SB(r,t,o,c,u){const h=[];for(let m=0;m<r.length;m++){const g=r[m];let v;for(let x=0;x<g.length-1;x++){let w=g[x],E=g[x+1];w.x<t&&E.x<t||(w.x<t?w=new G(t,w.y+(t-w.x)/(E.x-w.x)*(E.y-w.y))._round():E.x<t&&(E=new G(t,w.y+(t-w.x)/(E.x-w.x)*(E.y-w.y))._round()),w.y<o&&E.y<o||(w.y<o?w=new G(w.x+(o-w.y)/(E.y-w.y)*(E.x-w.x),o)._round():E.y<o&&(E=new G(w.x+(o-w.y)/(E.y-w.y)*(E.x-w.x),o)._round()),w.x>=c&&E.x>=c||(w.x>=c?w=new G(c,w.y+(c-w.x)/(E.x-w.x)*(E.y-w.y))._round():E.x>=c&&(E=new G(c,w.y+(c-w.x)/(E.x-w.x)*(E.y-w.y))._round()),w.y>=u&&E.y>=u||(w.y>=u?w=new G(w.x+(u-w.y)/(E.y-w.y)*(E.x-w.x),u)._round():E.y>=u&&(E=new G(w.x+(u-w.y)/(E.y-w.y)*(E.x-w.x),u)._round()),v&&w.equals(v[v.length-1])||(v=[w],h.push(v)),v.push(E)))))}}return h}dn(fh,"Anchor");const T1=1e20;function EB(r,t,o,c,u,h,m,g,v){for(let x=t;x<t+c;x++)MB(r,o*h+x,h,u,m,g,v);for(let x=o;x<o+u;x++)MB(r,x*h+t,1,c,m,g,v)}function MB(r,t,o,c,u,h,m){h[0]=0,m[0]=-T1,m[1]=T1,u[0]=r[t];for(let g=1,v=0,x=0;g<c;g++){u[g]=r[t+g*o];const w=g*g;do{const E=h[v];x=(u[g]-u[E]+w-E*E)/(g-E)/2}while(x<=m[v]&&--v>-1);v++,h[v]=g,m[v]=x,m[v+1]=T1}for(let g=0,v=0;g<c;g++){for(;m[v+1]<g;)v++;const x=h[v],w=g-x;r[t+g*o]=u[x]+w*w}}const eu=2;class wv{constructor(t,o,c){this.requestManager=t,this.localGlyphMode=o,this.localFontFamily=c,this.urls={},this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(t,o){this.urls[o]=t}getGlyphs(t,o,c){const u=[],h=this.urls[o]||b.GLYPHS_URL;for(const m in t)for(const g of t[m])u.push({stack:m,id:g});Xe(u,({stack:m,id:g},v)=>{let x=this.entries[m];x||(x=this.entries[m]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let w=x.glyphs[g];if(w!==void 0)return void v(null,{stack:m,id:g,glyph:w});if(w=this._tinySDF(x,m,g),w)return x.glyphs[g]=w,void v(null,{stack:m,id:g,glyph:w});const E=Math.floor(g/256);if(256*E>65535)return void v(new Error("glyphs > 65535 not supported"));if(x.ranges[E])return void v(null,{stack:m,id:g,glyph:w});let C=x.requests[E];C||(C=x.requests[E]=[],wv.loadGlyphRange(m,E,h,this.requestManager,(I,D)=>{if(D){x.ascender=D.ascender,x.descender=D.descender;for(const N in D.glyphs)this._doesCharSupportLocalGlyph(+N)||(x.glyphs[+N]=D.glyphs[+N]);x.ranges[E]=!0}for(const N of C)N(I,D);delete x.requests[E]})),C.push((I,D)=>{I?v(I):D&&v(null,{stack:m,id:g,glyph:D.glyphs[g]||null})})},(m,g)=>{if(m)c(m);else if(g){const v={};for(const{stack:x,id:w,glyph:E}of g)v[x]===void 0&&(v[x]={}),v[x].glyphs===void 0&&(v[x].glyphs={}),v[x].glyphs[w]=E&&{id:E.id,bitmap:E.bitmap.clone(),metrics:E.metrics},v[x].ascender=this.entries[x].ascender,v[x].descender=this.entries[x].descender;c(null,v)}})}_doesCharSupportLocalGlyph(t){return this.localGlyphMode!==0&&(this.localGlyphMode===2?!!this.localFontFamily:!!this.localFontFamily&&(gn["CJK Unified Ideographs"](t)||gn["Hangul Syllables"](t)||gn.Hiragana(t)||gn.Katakana(t)||gn["CJK Symbols and Punctuation"](t)||gn["CJK Unified Ideographs Extension A"](t)||gn["CJK Unified Ideographs Extension B"](t)))}_tinySDF(t,o,c){const u=this.localFontFamily;if(!u||!this._doesCharSupportLocalGlyph(c))return;let h=t.tinySDF;if(!h){let N="400";/bold/i.test(o)?N="900":/medium/i.test(o)?N="500":/light/i.test(o)&&(N="200"),h=t.tinySDF=new wv.TinySDF({fontFamily:u,fontWeight:N,fontSize:24*eu,buffer:3*eu,radius:8*eu}),h.fontWeight=N}if(this.localGlyphs[h.fontWeight][c])return this.localGlyphs[h.fontWeight][c];const m=String.fromCodePoint(c),{data:g,width:v,height:x,glyphWidth:w,glyphHeight:E,glyphLeft:C,glyphTop:I,glyphAdvance:D}=h.draw(m);return this.localGlyphs[h.fontWeight][c]={id:c,bitmap:new dh({width:v,height:x},g),metrics:{width:w/eu,height:E/eu,left:C/eu,top:I/eu-27,advance:D/eu,localGlyph:!0}}}}wv.loadGlyphRange=function(r,t,o,c,u){const h=256*t,m=h+255,g=c.transformRequest(c.normalizeGlyphsURL(o).replace("{fontstack}",r).replace("{range}",`${h}-${m}`),Se.Glyphs);vt(g,(v,x)=>{if(v)u(v);else if(x){const w={},E=function(C){return new s2(C).readFields(tne,{})}(x);for(const C of E.glyphs)w[C.id]=C;u(null,{glyphs:w,ascender:E.ascender,descender:E.descender})}})},wv.TinySDF=class{constructor({fontSize:r=24,buffer:t=3,radius:o=8,cutoff:c=.25,fontFamily:u="sans-serif",fontWeight:h="normal",fontStyle:m="normal"}={}){this.buffer=t,this.cutoff=c,this.radius=o;const g=this.size=r+4*t,v=this._createCanvas(g),x=this.ctx=v.getContext("2d",{willReadFrequently:!0});x.font=`${m} ${h} ${r}px ${u}`,x.textBaseline="alphabetic",x.textAlign="left",x.fillStyle="black",this.gridOuter=new Float64Array(g*g),this.gridInner=new Float64Array(g*g),this.f=new Float64Array(g),this.z=new Float64Array(g+1),this.v=new Uint16Array(g)}_createCanvas(r){const t=document.createElement("canvas");return t.width=t.height=r,t}draw(r){const{width:t,actualBoundingBoxAscent:o,actualBoundingBoxDescent:c,actualBoundingBoxLeft:u,actualBoundingBoxRight:h}=this.ctx.measureText(r),m=Math.ceil(o),g=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(h-u))),v=Math.min(this.size-this.buffer,m+Math.ceil(c)),x=g+2*this.buffer,w=v+2*this.buffer,E=Math.max(x*w,0),C=new Uint8ClampedArray(E),I={data:C,width:x,height:w,glyphWidth:g,glyphHeight:v,glyphTop:m,glyphLeft:0,glyphAdvance:t};if(g===0||v===0)return I;const{ctx:D,buffer:N,gridInner:W,gridOuter:V}=this;D.clearRect(N,N,g,v),D.fillText(r,N,N+m);const q=D.getImageData(N,N,g,v);V.fill(T1,0,E),W.fill(0,0,E);for(let Z=0;Z<v;Z++)for(let K=0;K<g;K++){const X=q.data[4*(Z*g+K)+3]/255;if(X===0)continue;const J=(Z+N)*x+K+N;if(X===1)V[J]=0,W[J]=T1;else{const ae=.5-X;V[J]=ae>0?ae*ae:0,W[J]=ae<0?ae*ae:0}}EB(V,0,0,x,w,x,this.f,this.v,this.z),EB(W,N,N,g,v,x,this.f,this.v,this.z);for(let Z=0;Z<E;Z++){const K=Math.sqrt(V[Z])-Math.sqrt(W[Z]);C[Z]=Math.round(255-255*(K/this.radius+this.cutoff))}return I}};const Rf=Ws;function TB(r,t,o,c){const u=[],h=r.imagePrimary,m=h.pixelRatio,g=h.paddedRect.w-2*Rf,v=h.paddedRect.h-2*Rf,x=r.right-r.left,w=r.bottom-r.top,E=h.stretchX||[[0,g]],C=h.stretchY||[[0,v]],I=(Pe,Me)=>Pe+Me[1]-Me[0],D=E.reduce(I,0),N=C.reduce(I,0),W=g-D,V=v-N;let q=0,Z=D,K=0,X=N,J=0,ae=W,ce=0,ge=V;if(h.content&&c){const Pe=h.content;q=u2(E,0,Pe[0]),K=u2(C,0,Pe[1]),Z=u2(E,Pe[0],Pe[2]),X=u2(C,Pe[1],Pe[3]),J=Pe[0]-q,ce=Pe[1]-K,ae=Pe[2]-Pe[0]-Z,ge=Pe[3]-Pe[1]-X}const ve=(Pe,Me,Le,Ee)=>{const He=d2(Pe.stretch-q,Z,x,r.left),Ke=h2(Pe.fixed-J,ae,Pe.stretch,D),nt=d2(Me.stretch-K,X,w,r.top),Ve=h2(Me.fixed-ce,ge,Me.stretch,N),je=d2(Le.stretch-q,Z,x,r.left),ot=h2(Le.fixed-J,ae,Le.stretch,D),yt=d2(Ee.stretch-K,X,w,r.top),ft=h2(Ee.fixed-ce,ge,Ee.stretch,N),Lt=new G(He,nt),Ft=new G(je,nt),St=new G(je,yt),Ct=new G(He,yt),rn=new G(Ke/m,Ve/m),ln=new G(ot/m,ft/m),sn=t*Math.PI/180;if(sn){const Xn=Math.sin(sn),Gn=Math.cos(sn),Ln=[Gn,-Xn,Xn,Gn];Lt._matMult(Ln),Ft._matMult(Ln),Ct._matMult(Ln),St._matMult(Ln)}const un=Pe.stretch+Pe.fixed,vn=Le.stretch+Le.fixed,zn=Me.stretch+Me.fixed,ai=Ee.stretch+Ee.fixed,Ai=r.imageSecondary;return{tl:Lt,tr:Ft,bl:Ct,br:St,texPrimary:{x:h.paddedRect.x+Rf+un,y:h.paddedRect.y+Rf+zn,w:vn-un,h:ai-zn},texSecondary:Ai?{x:Ai.paddedRect.x+Rf+un,y:Ai.paddedRect.y+Rf+zn,w:vn-un,h:ai-zn}:void 0,writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:rn,pixelOffsetBR:ln,minFontScaleX:ae/m/x,minFontScaleY:ge/m/w,isSDF:o}};if(c&&(h.stretchX||h.stretchY)){const Pe=AB(E,W,D),Me=AB(C,V,N);for(let Le=0;Le<Pe.length-1;Le++){const Ee=Pe[Le],He=Pe[Le+1];for(let Ke=0;Ke<Me.length-1;Ke++)u.push(ve(Ee,Me[Ke],He,Me[Ke+1]))}}else u.push(ve({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:g+1},{fixed:0,stretch:v+1}));return u}function u2(r,t,o){let c=0;for(const u of r)c+=Math.max(t,Math.min(o,u[1]))-Math.max(t,Math.min(o,u[0]));return c}function AB(r,t,o){const c=[{fixed:-Rf,stretch:0}];for(const[u,h]of r){const m=c[c.length-1];c.push({fixed:u-m.stretch,stretch:m.stretch}),c.push({fixed:u-m.stretch,stretch:m.stretch+(h-u)})}return c.push({fixed:t+Rf,stretch:o}),c}function d2(r,t,o,c){return r/t*o+c}function h2(r,t,o,c){return r-t*o/c}function cne(r,t,o,c){const u=t+r.positionedLines[c].lineOffset;return c===0?o+u/2:o+(u+(t+r.positionedLines[c-1].lineOffset))/2}function une(r,t=1,o=!1){let c=1/0,u=1/0,h=-1/0,m=-1/0;const g=r[0];for(let I=0;I<g.length;I++){const D=g[I];(!I||D.x<c)&&(c=D.x),(!I||D.y<u)&&(u=D.y),(!I||D.x>h)&&(h=D.x),(!I||D.y>m)&&(m=D.y)}const v=Math.min(h-c,m-u);let x=v/2;const w=new Vd([],dne);if(v===0)return new G(c,u);for(let I=c;I<h;I+=v)for(let D=u;D<m;D+=v)w.push(new Sv(I+x,D+x,x,r));let E=function(I){let D=0,N=0,W=0;const V=I[0];for(let q=0,Z=V.length,K=Z-1;q<Z;K=q++){const X=V[q],J=V[K],ae=X.x*J.y-J.x*X.y;N+=(X.x+J.x)*ae,W+=(X.y+J.y)*ae,D+=3*ae}return new Sv(N/D,W/D,0,I)}(r),C=w.length;for(;w.length;){const I=w.pop();(I.d>E.d||!E.d)&&(E=I,o&&console.log("found best %d after %d probes",Math.round(1e4*I.d)/1e4,C)),I.max-E.d<=t||(x=I.h/2,w.push(new Sv(I.p.x-x,I.p.y-x,x,r)),w.push(new Sv(I.p.x+x,I.p.y-x,x,r)),w.push(new Sv(I.p.x-x,I.p.y+x,x,r)),w.push(new Sv(I.p.x+x,I.p.y+x,x,r)),C+=4)}return o&&(console.log(`num probes: ${C}`),console.log(`best distance: ${E.d}`)),E.p}function dne(r,t){return t.max-r.max}class Sv{constructor(t,o,c,u){this.p=new G(t,o),this.h=c,this.d=function(h,m){let g=!1,v=1/0;for(let x=0;x<m.length;x++){const w=m[x];for(let E=0,C=w.length,I=C-1;E<C;I=E++){const D=w[E],N=w[I];D.y>h.y!=N.y>h.y&&h.x<(N.x-D.x)*(h.y-D.y)/(N.y-D.y)+D.x&&(g=!g),v=Math.min(v,AF(h,D,N))}}return(g?1:-1)*Math.sqrt(v)}(this.p,u),this.max=this.d+this.h*Math.SQRT2}}const Ev=7,GP=Number.POSITIVE_INFINITY,hne=Math.sqrt(2);function HP(r,[t,o]){let c=0,u=0;if(o===GP){t<0&&(t=0);const h=t/hne;switch(r){case"top-right":case"top-left":u=h-Ev;break;case"bottom-right":case"bottom-left":u=-h+Ev;break;case"bottom":u=-t+Ev;break;case"top":u=t-Ev}switch(r){case"top-right":case"bottom-right":c=-h;break;case"top-left":case"bottom-left":c=h;break;case"left":c=t;break;case"right":c=-t}}else{switch(t=Math.abs(t),o=Math.abs(o),r){case"top-right":case"top-left":case"top":u=o-Ev;break;case"bottom-right":case"bottom-left":case"bottom":u=-o+Ev}switch(r){case"top-right":case"bottom-right":case"right":c=-t;break;case"top-left":case"bottom-left":case"left":c=t}}return[c,u]}function fne(r,t,o,c,u,h,m,g,v,x,w){r.createArrays(),r.tilePixelRatio=mt/(512*r.overscaling),r.compareText={},r.iconsNeedLinear=!1;const E=r.layers[0].layout,C=r.layers[0]._unevaluatedLayout._values,I={};if(r.textSizeData.kind==="composite"){const{minZoom:V,maxZoom:q}=r.textSizeData;I.compositeTextSizes=[C["text-size"].possiblyEvaluate(new dr(V),g),C["text-size"].possiblyEvaluate(new dr(q),g)]}if(r.iconSizeData.kind==="composite"){const{minZoom:V,maxZoom:q}=r.iconSizeData;I.compositeIconSizes=[C["icon-size"].possiblyEvaluate(new dr(V),g),C["icon-size"].possiblyEvaluate(new dr(q),g)]}I.layoutTextSize=C["text-size"].possiblyEvaluate(new dr(v+1),g),I.layoutIconSize=C["icon-size"].possiblyEvaluate(new dr(v+1),g),I.textMaxSize=C["text-size"].possiblyEvaluate(new dr(18),g);const D=E.get("text-rotation-alignment")==="map"&&E.get("symbol-placement")!=="point",N=E.get("text-size");let W=!1;for(const V of r.features)if(V.icon&&V.icon.nameSecondary){W=!0;break}for(const V of r.features){const q=E.get("text-font").evaluate(V,{},g).join(","),Z=N.evaluate(V,{},g),K=I.layoutTextSize.evaluate(V,{},g),X=(I.layoutIconSize.evaluate(V,{},g),{horizontal:{},vertical:void 0}),J=V.text;let ae,ce=[0,0];if(J){const Pe=J.toString(),Me=E.get("text-letter-spacing").evaluate(V,{},g)*ao,Le=E.get("text-line-height").evaluate(V,{},g)*ao,Ee=th(Pe)?Me:0,He=E.get("text-anchor").evaluate(V,{},g),Ke=E.get("text-variable-anchor");if(!Ke){const yt=E.get("text-radial-offset").evaluate(V,{},g);ce=yt?HP(He,[yt*ao,GP]):E.get("text-offset").evaluate(V,{},g).map(ft=>ft*ao)}let nt=D?"center":E.get("text-justify").evaluate(V,{},g);const Ve=E.get("symbol-placement")==="point",je=Ve?E.get("text-max-width").evaluate(V,{},g)*ao:1/0,ot=yt=>{r.allowVerticalPlacement&&Sm(Pe)&&(X.vertical=VP(J,t,o,u,q,je,Le,He,yt,Ee,ce,Ar.vertical,!0,K,Z))};if(!D&&Ke){const yt=nt==="auto"?Ke.map(Lt=>jP(Lt)):[nt];let ft=!1;for(let Lt=0;Lt<yt.length;Lt++){const Ft=yt[Lt];if(!X.horizontal[Ft])if(ft)X.horizontal[Ft]=X.horizontal[0];else{const St=VP(J,t,o,u,q,je,Le,"center",Ft,Ee,ce,Ar.horizontal,!1,K,Z);St&&(X.horizontal[Ft]=St,ft=St.positionedLines.length===1)}}ot("left")}else{if(nt==="auto"&&(nt=jP(He)),Ve||E.get("text-writing-mode").indexOf("horizontal")>=0||!Sm(Pe)){const yt=VP(J,t,o,u,q,je,Le,He,nt,Ee,ce,Ar.horizontal,!1,K,Z);yt&&(X.horizontal[nt]=yt)}ot(Ve?"left":nt)}}let ge=!1;if(V.icon&&V.icon.namePrimary){const Pe=c[V.icon.namePrimary];Pe&&(ae=one(u[V.icon.namePrimary],V.icon.nameSecondary?u[V.icon.nameSecondary]:void 0,E.get("icon-offset").evaluate(V,{},g),E.get("icon-anchor").evaluate(V,{},g)),ge=Pe.sdf,r.sdfIcons===void 0?r.sdfIcons=Pe.sdf:r.sdfIcons!==Pe.sdf&&xe("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Pe.pixelRatio!==r.pixelRatio||E.get("icon-rotate").constantOr(1)!==0)&&(r.iconsNeedLinear=!0))}const ve=PB(X.horizontal)||X.vertical;r.iconsInText||(r.iconsInText=!!ve&&ve.iconsInText),(ve||ae)&&pne(r,V,X,ae,c,I,K,0,ce,ge,m,g,x,w,W)}h&&r.generateCollisionDebugBuffers(v,r.collisionBoxArray)}function jP(r){switch(r){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function pne(r,t,o,c,u,h,m,g,v,x,w,E,C,I,D){let N=h.textMaxSize.evaluate(t,{},E);N===void 0&&(N=m);const W=r.layers[0].layout,V=W.get("icon-offset").evaluate(t,{},E),q=PB(o.horizontal)||o.vertical,Z=C.name==="globe",K=ao,X=m/K,J=r.tilePixelRatio*N/K,ae=(He=r.overscaling,r.zoom>18&&He>2&&(He>>=1),Math.max(mt/(512*He),1)*W.get("symbol-spacing")),ce=W.get("text-padding")*r.tilePixelRatio,ge=W.get("icon-padding")*r.tilePixelRatio,ve=ye(W.get("text-max-angle")),Pe=W.get("text-rotation-alignment")==="map"&&W.get("symbol-placement")!=="point",Me=W.get("icon-rotation-alignment")==="map"&&W.get("symbol-placement")!=="point",Le=W.get("symbol-placement"),Ee=ae/2;var He;const Ke=W.get("icon-text-fit").evaluate(t,{},E),nt=W.get("icon-text-fit-padding").evaluate(t,{},E),Ve=Ke!=="none";let je;r.hasAnyIconTextFit===!1&&Ve&&(r.hasAnyIconTextFit=!0),c&&Ve&&(r.allowVerticalPlacement&&o.vertical&&(je=yB(c,o.vertical,Ke,nt,V,X)),q&&(c=yB(c,q,Ke,nt,V,X)));const ot=(yt,ft,Lt)=>{if(ft.x<0||ft.x>=mt||ft.y<0||ft.y>=mt)return;let Ft=null;if(Z){const{x:St,y:Ct,z:rn}=C.projectTilePoint(ft.x,ft.y,Lt);Ft={anchor:new fh(St,Ct,rn,0,void 0),up:C.upVector(Lt,ft.x,ft.y)}}(function(St,Ct,rn,ln,sn,un,vn,zn,ai,Ai,Xn,Gn,Ln,An,vi,Li,ri,Ji,Cr,hr,or,ca,Pr,Wr,Qi,ps,rd){const ph=St.addToLineVertexArray(Ct,ln);let mh,Z1,K1,o3,z8,O8,N8,F8=0,B8=0,U8=0,W8=0,jI=-1,$I=-1;const ad={};let V8=GC("");const Um=rn?rn.anchor:Ct,YI=ai.layout.get("icon-text-fit").evaluate(or,{},Qi)!=="none";let qI=0,XI=0;if(ai._unevaluatedLayout.getValue("text-radial-offset")===void 0?[qI,XI]=ai.layout.get("text-offset").evaluate(or,{},Qi).map(hl=>hl*ao):(qI=ai.layout.get("text-radial-offset").evaluate(or,{},Qi)*ao,XI=GP),St.allowVerticalPlacement&&sn.vertical){const hl=sn.vertical;if(vi)O8=$P(hl),zn&&(N8=$P(zn));else{const fl=ai.layout.get("text-rotate").evaluate(or,{},Qi)+90;K1=f2(Ai,Um,Ct,Xn,Gn,Ln,hl,An,fl,Li),zn&&(o3=f2(Ai,Um,Ct,Xn,Gn,Ln,zn,Ji,fl))}}if(un){const hl=ai.layout.get("icon-rotate").evaluate(or,{},Qi),fl=TB(un,hl,Pr,YI),zv=zn?TB(zn,hl,Pr,YI):void 0;Z1=f2(Ai,Um,Ct,Xn,Gn,Ln,un,Ji,hl),F8=4*fl.length;const G8=St.iconSizeData;let Wm=null;G8.kind==="source"?(Wm=[Qc*ai.layout.get("icon-size").evaluate(or,{},Qi)],Wm[0]>Lf&&xe(`${St.layerIds[0]}: Value for "icon-size" is >= ${A1}. Reduce your "icon-size".`)):G8.kind==="composite"&&(Wm=[Qc*ca.compositeIconSizes[0].evaluate(or,{},Qi),Qc*ca.compositeIconSizes[1].evaluate(or,{},Qi)],(Wm[0]>Lf||Wm[1]>Lf)&&xe(`${St.layerIds[0]}: Value for "icon-size" is >= ${A1}. Reduce your "icon-size".`)),St.addSymbols(St.icon,fl,Wm,hr,Cr,or,!1,rn,Ct,ph.lineStartIndex,ph.lineLength,-1,Wr,Qi,ps,rd),jI=St.icon.placedSymbolArray.length-1,zv&&(B8=4*zv.length,St.addSymbols(St.icon,zv,Wm,hr,Cr,or,Ar.vertical,rn,Ct,ph.lineStartIndex,ph.lineLength,-1,Wr,Qi,ps,rd),$I=St.icon.placedSymbolArray.length-1)}for(const hl in sn.horizontal){const fl=sn.horizontal[hl];mh||(V8=GC(fl.text),vi?z8=$P(fl):mh=f2(Ai,Um,Ct,Xn,Gn,Ln,fl,An,ai.layout.get("text-rotate").evaluate(or,{},Qi),Li));const zv=fl.positionedLines.length===1;if(U8+=CB(St,rn,Ct,fl,vn,ai,vi,or,Li,ph,sn.vertical?Ar.horizontal:Ar.horizontalOnly,zv?Object.keys(sn.horizontal):[hl],ad,jI,ca,Wr,Qi,ps),zv)break}sn.vertical&&(W8+=CB(St,rn,Ct,sn.vertical,vn,ai,vi,or,Li,ph,Ar.vertical,["vertical"],ad,$I,ca,Wr,Qi,ps));let Uf=-1;const ZI=(hl,fl)=>hl?Math.max(hl,fl):fl;Uf=ZI(z8,Uf),Uf=ZI(O8,Uf),Uf=ZI(N8,Uf);const Zoe=Uf>-1?1:0;St.glyphOffsetArray.length>=L1.MAX_GLYPHS&&xe("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),or.sortKey!==void 0&&St.addToSortKeyRanges(St.symbolInstances.length,or.sortKey),St.symbolInstances.emplaceBack(Ct.x,Ct.y,Um.x,Um.y,Um.z,ad.right>=0?ad.right:-1,ad.center>=0?ad.center:-1,ad.left>=0?ad.left:-1,ad.vertical>=0?ad.vertical:-1,jI,$I,V8,mh!==void 0?mh:St.collisionBoxArray.length,mh!==void 0?mh+1:St.collisionBoxArray.length,K1!==void 0?K1:St.collisionBoxArray.length,K1!==void 0?K1+1:St.collisionBoxArray.length,Z1!==void 0?Z1:St.collisionBoxArray.length,Z1!==void 0?Z1+1:St.collisionBoxArray.length,o3||St.collisionBoxArray.length,o3?o3+1:St.collisionBoxArray.length,Xn,U8,W8,F8,B8,Zoe,0,qI,XI,Uf,0,YI?1:0)})(r,ft,Ft,yt,o,c,u,je,r.layers[0],r.collisionBoxArray,t.index,t.sourceLayerIndex,r.index,ce,Pe,v,0,ge,Me,V,t,h,x,w,E,I,D)};if(Le==="line")for(const yt of SB(t.geometry,0,0,mt,mt)){const ft=lne(yt,ae,ve,o.vertical||q,c,K,J,r.overscaling,mt);for(const Lt of ft)q&&mne(r,q.text,Ee,Lt)||ot(yt,Lt,E)}else if(Le==="line-center"){for(const yt of t.geometry)if(yt.length>1){const ft=sne(yt,ve,o.vertical||q,c,K,J);ft&&ot(yt,ft,E)}}else if(t.type==="Polygon")for(const yt of IP(t.geometry,0)){const ft=une(yt,16);ot(yt[0],new fh(ft.x,ft.y,0,0,void 0),E)}else if(t.type==="LineString")for(const yt of t.geometry)ot(yt,new fh(yt[0].x,yt[0].y,0,0,void 0),E);else if(t.type==="Point")for(const yt of t.geometry)for(const ft of yt)ot([ft],new fh(ft.x,ft.y,0,0,void 0),E)}const A1=255,Lf=A1*Qc;function CB(r,t,o,c,u,h,m,g,v,x,w,E,C,I,D,N,W,V){const q=function(X,J,ae,ce,ge,ve,Pe,Me){const Le=[];if(J.positionedLines.length===0)return Le;const Ee=ce.layout.get("text-rotate").evaluate(ve,{})*Math.PI/180,He=function(ot){const yt=ot[0],ft=ot[1],Lt=yt*ft;return Lt>0?[yt,-ft]:Lt<0?[-yt,ft]:yt===0?[ft,yt]:[ft,-yt]}(ae);let Ke=Math.abs(J.top-J.bottom);for(const ot of J.positionedLines)Ke-=ot.lineOffset;const nt=J.positionedLines.length,Ve=Ke/nt;let je=J.top-ae[1];for(let ot=0;ot<nt;++ot){const yt=J.positionedLines[ot];je=cne(J,Ve,je,ot);for(const ft of yt.positionedGlyphs){if(!ft.rect)continue;const Lt=ft.rect||{};let Ft=cB+1,St=!0,Ct=1,rn=0;if(ft.imageName){const hr=Pe[ft.imageName];if(!hr)continue;if(hr.sdf){xe("SDF images are not supported in formatted text and will be ignored.");continue}St=!1,Ct=hr.pixelRatio,Ft=Ws/Ct}const ln=(ge||Me)&&ft.vertical,sn=ft.metrics.advance*ft.scale/2,un=ft.metrics,vn=ft.rect;if(vn===null)continue;Me&&J.verticalizable&&(rn=ft.imageName?sn-ft.metrics.width*ft.scale/2:0);const zn=ge?[ft.x+sn,ft.y]:[0,0];let ai=[0,0],Ai=[0,0],Xn=!1;ge||(ln?(Ai=[ft.x+sn+He[0],ft.y+He[1]-rn],Xn=!0):ai=[ft.x+sn+ae[0],ft.y+ae[1]-rn]);const Gn=vn.w*ft.scale/(Ct*(ft.localGlyph?eu:1)),Ln=vn.h*ft.scale/(Ct*(ft.localGlyph?eu:1));let An,vi,Li,ri;if(ln){const hr=ft.y-je,or=new G(-sn,sn-hr),ca=-Math.PI/2,Pr=new G(...Ai);An=new G(-sn+ai[0],ai[1]),An._rotateAround(ca,or)._add(Pr),An.x+=-hr+sn,An.y-=(un.left-Ft)*ft.scale;const Wr=ft.imageName?un.advance*ft.scale:ao*ft.scale,Qi=String.fromCodePoint(ft.glyph);Qte(Qi)?An.x+=(1-Ft)*ft.scale:ene(Qi)?An.x+=Wr-un.height*ft.scale+(-Ft-1)*ft.scale:An.x+=ft.imageName||un.width+2*Ft===vn.w&&un.height+2*Ft===vn.h?(Wr-Ln)/2:(Wr-(un.height+2*Ft)*ft.scale)/2,vi=new G(An.x,An.y-Gn),Li=new G(An.x+Ln,An.y),ri=new G(An.x+Ln,An.y-Gn)}else{const hr=(un.left-Ft)*ft.scale-sn+ai[0],or=(-un.top-Ft)*ft.scale+ai[1],ca=hr+Gn,Pr=or+Ln;An=new G(hr,or),vi=new G(ca,or),Li=new G(hr,Pr),ri=new G(ca,Pr)}if(Ee){let hr;hr=ge?new G(0,0):Xn?new G(He[0],He[1]):new G(ae[0],ae[1]),An._rotateAround(Ee,hr),vi._rotateAround(Ee,hr),Li._rotateAround(Ee,hr),ri._rotateAround(Ee,hr)}const Ji=new G(0,0),Cr=new G(0,0);Le.push({tl:An,tr:vi,bl:Li,br:ri,texPrimary:Lt,texSecondary:void 0,writingMode:J.writingMode,glyphOffset:zn,sectionIndex:ft.sectionIndex,isSDF:St,pixelOffsetTL:Ji,pixelOffsetBR:Cr,minFontScaleX:0,minFontScaleY:0})}}return Le}(0,c,v,h,m,g,u,r.allowVerticalPlacement),Z=r.textSizeData;let K=null;Z.kind==="source"?(K=[Qc*h.layout.get("text-size").evaluate(g,{},W)],K[0]>Lf&&xe(`${r.layerIds[0]}: Value for "text-size" is >= ${A1}. Reduce your "text-size".`)):Z.kind==="composite"&&(K=[Qc*D.compositeTextSizes[0].evaluate(g,{},W),Qc*D.compositeTextSizes[1].evaluate(g,{},W)],(K[0]>Lf||K[1]>Lf)&&xe(`${r.layerIds[0]}: Value for "text-size" is >= ${A1}. Reduce your "text-size".`)),r.addSymbols(r.text,q,K,v,m,g,w,t,o,x.lineStartIndex,x.lineLength,I,N,W,V,!1);for(const X of E)C[X]=r.text.placedSymbolArray.length-1;return 4*q.length}function PB(r){for(const t in r)return r[t];return null}function f2(r,t,o,c,u,h,m,g,v,x){let w=m.top,E=m.bottom,C=m.left,I=m.right;const D=m.collisionPadding;if(D&&(C-=D[0],w-=D[1],I+=D[2],E+=D[3]),v){const N=new G(C,w),W=new G(I,w),V=new G(C,E),q=new G(I,E),Z=ye(v);let K=new G(0,0);x&&(K=new G(x[0],x[1])),N._rotateAround(Z,K),W._rotateAround(Z,K),V._rotateAround(Z,K),q._rotateAround(Z,K),C=Math.min(N.x,W.x,V.x,q.x),I=Math.max(N.x,W.x,V.x,q.x),w=Math.min(N.y,W.y,V.y,q.y),E=Math.max(N.y,W.y,V.y,q.y)}return r.emplaceBack(t.x,t.y,t.z,o.x,o.y,C,w,I,E,g,c,u,h),r.length-1}function $P(r){r.collisionPadding&&(r.top-=r.collisionPadding[1],r.bottom+=r.collisionPadding[3]);const t=r.bottom-r.top;return t>0?Math.max(10,t):null}function mne(r,t,o,c){const u=r.compareText;if(t in u){const h=u[t];for(let m=h.length-1;m>=0;m--)if(c.dist(h[m])<o)return!0}else u[t]=[];return u[t].push(c),!1}function IB(r,t){const o=r.fovAboveCenter,c=r.elevation?r.elevation.getMinElevationBelowMSL()*t:0,u=(r._camera.position[2]*r.worldSize-c)/Math.cos(r._pitch),h=Math.sin(o)*u/Math.sin(Math.max(Math.PI/2-r._pitch-o,.01)),m=Math.sin(r._pitch)*h+u;return Math.min(1.01*m,u*(1/r._horizonShift))}function Lm(r,t){if(!t.isReprojectedInTileSpace)return{scale:1<<r.z,x:r.x,y:r.y,x2:r.x+1,y2:r.y+1,projection:t};const o=Math.pow(2,-r.z),c=r.x*o,u=(r.x+1)*o,h=r.y*o,m=(r.y+1)*o,g=ul(c),v=ul(u),x=_a(h),w=_a(m),E=t.project(g,x),C=t.project(v,x),I=t.project(v,w),D=t.project(g,w);let N=Math.min(E.x,C.x,I.x,D.x),W=Math.min(E.y,C.y,I.y,D.y),V=Math.max(E.x,C.x,I.x,D.x),q=Math.max(E.y,C.y,I.y,D.y);const Z=o/16;function K(J,ae,ce,ge,ve,Pe){const Me=(ce+ve)/2,Le=(ge+Pe)/2,Ee=t.project(ul(Me),_a(Le)),He=Math.max(0,N-Ee.x,W-Ee.y,Ee.x-V,Ee.y-q);N=Math.min(N,Ee.x),V=Math.max(V,Ee.x),W=Math.min(W,Ee.y),q=Math.max(q,Ee.y),He>Z&&(K(J,Ee,ce,ge,Me,Le),K(Ee,ae,Me,Le,ve,Pe))}K(E,C,c,h,u,h),K(C,I,u,h,u,m),K(I,D,u,m,c,m),K(D,E,c,m,c,h),N-=Z,W-=Z,V+=Z,q+=Z;const X=1/Math.max(V-N,q-W);return{scale:X,x:N*X,y:W*X,x2:V*X,y2:q*X,projection:t}}function RB(r,t,o,c,u,h,m,g,v){if(v.name==="globe")return hP(r,t,new Xu(o,c,u),!1);const x=Lm({z:o,x:c,y:u},v);return new _r([(h+x.x/x.scale)*t,t*(x.y/x.scale),m],[(h+x.x2/x.scale)*t,t*(x.y2/x.scale),g])}function LB(r,{x:t,y:o},c=0){return new G(((t-c)*r.scale-r.x)*mt,(o*r.scale-r.y)*mt)}function kB(r,t,o=0){return De.fromValues(((t.x-o)*r.scale-r.x)*mt,(t.y*r.scale-r.y)*mt,bF(t.z,t.y))}const gne=at.identity(new Float32Array(16));class kf{constructor(t){this.spec=t,this.name=t.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(t,o){return{x:0,y:0,z:0}}unproject(t,o){return new Nn(0,0)}projectTilePoint(t,o,c){return{x:t,y:o,z:0}}locationPoint(t,o,c=!0){return t._coordinatePoint(t.locationCoordinate(o),c)}pixelsPerMeter(t,o){return Xi(1,t)*o}pixelSpaceConversion(t,o,c){return 1}farthestPixelDistance(t){return IB(t,t.pixelsPerMeter)}pointCoordinate(t,o,c,u){const h=t.horizonLineFromTop(!1),m=new G(o,Math.max(h,c));return t.rayIntersectionCoordinate(t.pointRayIntersection(m,u))}pointCoordinate3D(t,o,c){const u=new G(o,c);if(t.elevation)return t.elevation.pointCoordinate(u);{const h=this.pointCoordinate(t,u.x,u.y,0);return[h.x,h.y,h.z]}}isPointAboveHorizon(t,o){if(t.elevation)return!this.pointCoordinate3D(t,o.x,o.y);const c=t.horizonLineFromTop();return o.y<c}createInversionMatrix(t,o){return gne}createTileMatrix(t,o,c){let u,h,m;const g=c.canonical,v=at.identity(new Float64Array(16));if(this.isReprojectedInTileSpace){const x=Lm(g,this);u=1,h=x.x+c.wrap*x.scale,m=x.y,at.scale(v,v,[u/x.scale,u/x.scale,t.pixelsPerMeter/o])}else u=o/t.zoomScale(g.z),h=(g.x+Math.pow(2,g.z)*c.wrap)*u,m=g.y*u;return at.translate(v,v,[h,m,0]),at.scale(v,v,[u/mt,u/mt,1]),v}upVector(t,o,c){return[0,0,1]}upVectorScale(t,o,c){return{metersToTile:1}}}class yne extends kf{constructor(t){super(t),this.range=[4,7],this.center=t.center||[-96,37.5];const[o,c]=this.parallels=t.parallels||[29.5,45.5],u=Math.sin(ye(o));this.n=(u+Math.sin(ye(c)))/2,this.c=1+u*(2*this.n-u),this.r0=Math.sqrt(this.c)/this.n}project(t,o){const{n:c,c:u,r0:h}=this,m=ye(t-this.center[0]),g=ye(o),v=Math.sqrt(u-2*c*Math.sin(g))/c;return{x:v*Math.sin(m*c),y:v*Math.cos(m*c)-h,z:0}}unproject(t,o){const{n:c,c:u,r0:h}=this,m=h+o;let g=Math.atan2(t,Math.abs(m))*Math.sign(m);m*c<0&&(g-=Math.PI*Math.sign(t)*Math.sign(m));const v=ye(this.center[0])*c;g=Je(g,-Math.PI-v,Math.PI-v);const x=re(fe(g/c)+this.center[0],-180,180),w=Math.asin(re((u-(t*t+m*m)*c*c)/(2*c),-1,1)),E=re(fe(w),-Kr,Kr);return new Nn(x,E)}}const C1=1.340264,P1=-.081106,I1=893e-6,R1=.003796,p2=Math.sqrt(3)/2;class vne extends kf{project(t,o){o=o/180*Math.PI,t=t/180*Math.PI;const c=Math.asin(p2*Math.sin(o)),u=c*c,h=u*u*u;return{x:.5*(t*Math.cos(c)/(p2*(C1+3*P1*u+h*(7*I1+9*R1*u)))/Math.PI+.5),y:1-.5*(c*(C1+P1*u+h*(I1+R1*u))/Math.PI+1),z:0}}unproject(t,o){t=(2*t-.5)*Math.PI;let c=o=(2*(1-o)-1)*Math.PI,u=c*c,h=u*u*u;for(let w,E,C,I=0;I<12&&(E=c*(C1+P1*u+h*(I1+R1*u))-o,C=C1+3*P1*u+h*(7*I1+9*R1*u),w=E/C,c=re(c-w,-Math.PI/3,Math.PI/3),u=c*c,h=u*u*u,!(Math.abs(w)<1e-12));++I);const m=p2*t*(C1+3*P1*u+h*(7*I1+9*R1*u))/Math.cos(c),g=Math.asin(Math.sin(c)/p2),v=re(180*m/Math.PI,-180,180),x=re(180*g/Math.PI,-Kr,Kr);return new Nn(v,x)}}class _ne extends kf{constructor(t){super(t),this.wrap=!0,this.supportsWorldCopies=!0}project(t,o){return{x:.5+t/360,y:.5-o/360,z:0}}unproject(t,o){const c=360*(t-.5),u=re(360*(.5-o),-Kr,Kr);return new Nn(c,u)}}const Mv=Math.PI/2;function m2(r){return Math.tan((Mv+r)/2)}class xne extends kf{constructor(t){super(t),this.center=t.center||[0,30];const[o,c]=this.parallels=t.parallels||[30,30];let u=ye(o),h=ye(c);this.southernCenter=u+h<0,this.southernCenter&&(u=-u,h=-h);const m=Math.cos(u),g=m2(u);this.n=u===h?Math.sin(u):Math.log(m/Math.cos(h))/Math.log(m2(h)/g),this.f=m*Math.pow(m2(u),this.n)/this.n}project(t,o){o=ye(o),this.southernCenter&&(o=-o),t=ye(t-this.center[0]);const c=1e-6,{n:u,f:h}=this;h>0?o<-Mv+c&&(o=-Mv+c):o>Mv-c&&(o=Mv-c);const m=h/Math.pow(m2(o),u);let g=m*Math.sin(u*t),v=h-m*Math.cos(u*t);return g=.5*(g/Math.PI+.5),v=.5*(v/Math.PI+.5),{x:g,y:this.southernCenter?v:1-v,z:0}}unproject(t,o){t=(2*t-.5)*Math.PI,this.southernCenter&&(o=1-o),o=(2*(1-o)-.5)*Math.PI;const{n:c,f:u}=this,h=u-o,m=Math.sign(h),g=Math.sign(c)*Math.sqrt(t*t+h*h);let v=Math.atan2(t,Math.abs(h))*m;h*c<0&&(v-=Math.PI*Math.sign(t)*m);const x=re(fe(v/c)+this.center[0],-180,180),w=re(fe(2*Math.atan(Math.pow(u/g,1/c))-Mv),-Kr,Kr);return new Nn(x,this.southernCenter?-w:w)}}class DB extends kf{constructor(t){super(t),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(t,o){return{x:xo(t),y:Io(o),z:0}}unproject(t,o){const c=ul(t),u=_a(o);return new Nn(c,u)}}const zB=ye(Kr);class bne extends kf{project(t,o){const c=(o=ye(o))*o,u=c*c;return{x:.5*((t=ye(t))*(.8707-.131979*c+u*(u*(.003971*c-.001529*u)-.013791))/Math.PI+.5),y:1-.5*(o*(1.007226+c*(.015085+u*(.028874*c-.044475-.005916*u)))/Math.PI+1),z:0}}unproject(t,o){t=(2*t-.5)*Math.PI;let c=o=(2*(1-o)-1)*Math.PI,u=25,h=0,m=c*c;do{m=c*c;const x=m*m;h=(c*(1.007226+m*(.015085+x*(.028874*m-.044475-.005916*x)))-o)/(1.007226+m*(.045255+x*(.259866*m-.311325-.005916*11*x))),c=re(c-h,-zB,zB)}while(Math.abs(h)>1e-6&&--u>0);m=c*c;const g=re(fe(t/(.8707+m*(m*(m*m*m*(.003971-.001529*m)-.013791)-.131979))),-180,180),v=fe(c);return new Nn(g,v)}}const OB=ye(Kr);class wne extends kf{project(t,o){o=ye(o),t=ye(t);const c=Math.cos(o),u=2/Math.PI,h=Math.acos(c*Math.cos(t/2)),m=Math.sin(h)/h,g=.5*(t*u+2*c*Math.sin(t/2)/m)||0,v=.5*(o+Math.sin(o)/m)||0;return{x:.5*(g/Math.PI+.5),y:1-.5*(v/Math.PI+1),z:0}}unproject(t,o){let c=t=(2*t-.5)*Math.PI,u=o=(2*(1-o)-1)*Math.PI,h=25;const m=1e-6;let g=0,v=0;do{const x=Math.cos(u),w=Math.sin(u),E=2*w*x,C=w*w,I=x*x,D=Math.cos(c/2),N=Math.sin(c/2),W=2*D*N,V=N*N,q=1-I*D*D,Z=q?1/q:0,K=q?Math.acos(x*D)*Math.sqrt(1/q):0,X=.5*(2*K*x*N+2*c/Math.PI)-t,J=.5*(K*w+u)-o,ae=.5*Z*(I*V+K*x*D*C)+1/Math.PI,ce=Z*(W*E/4-K*w*N),ge=.125*Z*(E*N-K*w*I*W),ve=.5*Z*(C*D+K*V*x)+.5,Pe=ce*ge-ve*ae;g=(J*ce-X*ve)/Pe,v=(X*ge-J*ae)/Pe,c=re(c-g,-Math.PI,Math.PI),u=re(u-v,-OB,OB)}while((Math.abs(g)>m||Math.abs(v)>m)&&--h>0);return new Nn(fe(c),fe(u))}}class NB extends kf{constructor(t){super(t),this.center=t.center||[0,0],this.parallels=t.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(ye(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(t,o){const{scale:c,cosPhi:u}=this;return{x:ye(t)*u*c+.5,y:-Math.sin(ye(o))/u*c+.5,z:0}}unproject(t,o){const{scale:c,cosPhi:u}=this,h=-(o-.5)/c,m=re(fe((t-.5)/c)/u,-180,180),g=Math.asin(re(h*u,-1,1)),v=re(fe(g),-Kr,Kr);return new Nn(m,v)}}class Sne extends DB{constructor(t){super(t),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(t,o,c){const u=v1(t,o,c),h=Pm(bc(c));return De.transformMat4(u,u,h),{x:u[0],y:u[1],z:u[2]}}locationPoint(t,o){const c=Us(o.lat,o.lng),u=De.normalize([],c),h=t.elevation?t.elevation.getAtPointOrZero(t.locationCoordinate(o),t._centerAltitude):t._centerAltitude,m=Xi(1,0)*mt*h;De.scaleAndAdd(c,c,u,m);const g=at.identity(new Float64Array(16));return at.multiply(g,t.pixelMatrix,t.globeMatrix),De.transformMat4(c,c,g),new G(c[0],c[1])}pixelsPerMeter(t,o){return Xi(1,0)*o}pixelSpaceConversion(t,o,c){const u=Xi(1,t)*o,h=kn(Xi(1,45)*o,u,c);return this.pixelsPerMeter(t,o)/h}createTileMatrix(t,o,c){const u=pP(bc(c.canonical));return at.multiply(new Float64Array(16),t.globeMatrix,u)}createInversionMatrix(t,o){const{center:c}=t,u=Pm(bc(o));return at.rotateY(u,u,ye(c.lng)),at.rotateX(u,u,ye(c.lat)),at.scale(u,u,[t._pixelsPerMercatorPixel,t._pixelsPerMercatorPixel,1]),Float32Array.from(u)}pointCoordinate(t,o,c,u){return uF(t,o,c,!0)||new bi(0,0)}pointCoordinate3D(t,o,c){const u=this.pointCoordinate(t,o,c,0);return[u.x,u.y,u.z]}isPointAboveHorizon(t,o){return!uF(t,o.x,o.y,!1)}farthestPixelDistance(t){const o=function(u,h){const m=u.cameraToCenterDistance,g=u._centerAltitude*h,v=u._camera,x=u._camera.forward(),w=De.add([],De.scale([],x,-m),[0,0,g]),E=u.worldSize/(2*Math.PI),C=[0,0,-E],I=u.width/u.height,D=Math.tan(u.fovAboveCenter),N=De.scale([],v.up(),D),W=De.scale([],v.right(),D*I),V=De.normalize([],De.add([],De.add([],x,N),W)),q=[];let Z;if(new US(w,V).closestPointOnSphere(C,E,q)){const K=De.add([],q,C),X=De.sub([],K,w);Z=Math.cos(u.fovAboveCenter)*De.length(X)}else{const K=De.sub([],w,C),X=De.sub([],C,w);De.normalize(X,X);const J=De.length(K)-E;Z=Math.sqrt(J*(J+2*E));const ae=Math.acos(Z/(E+J))-Math.acos(De.dot(x,X));Z*=Math.cos(ae)}return 1.01*Z}(t,this.pixelsPerMeter(t.center.lat,t.worldSize)),c=_o(t.zoom);if(c>0){const u=IB(t,Xi(1,t.center.lat)*t.worldSize),h=t.worldSize/(2*Math.PI),m=Math.max(t.width,t.height)/t.worldSize*Math.PI;return kn(o,u+h*(1-Math.cos(m)),Math.pow(c,10))}return o}upVector(t,o,c){return v1(o,c,t,1)}upVectorScale(t){return{metersToTile:WS(GS(bc(t)))}}}function g2(r){const t=r.parallels,o=!!t&&Math.abs(t[0]+t[1])<.01;switch(r.name){case"mercator":return new DB(r);case"equirectangular":return new _ne(r);case"naturalEarth":return new bne(r);case"equalEarth":return new vne(r);case"winkelTripel":return new wne(r);case"albers":return o?new NB(r):new yne(r);case"lambertConformalConic":return o?new NB(r):new xne(r);case"globe":return new Sne(r)}throw new Error(`Invalid projection name: ${r.name}`)}const Ene=new Er({"symbol-placement":new Zt(rt.layout_symbol["symbol-placement"]),"symbol-spacing":new Zt(rt.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Zt(rt.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new xn(rt.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Zt(rt.layout_symbol["symbol-z-order"]),"symbol-z-elevate":new Zt(rt.layout_symbol["symbol-z-elevate"]),"icon-allow-overlap":new Zt(rt.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Zt(rt.layout_symbol["icon-ignore-placement"]),"icon-optional":new Zt(rt.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Zt(rt.layout_symbol["icon-rotation-alignment"]),"icon-size":new xn(rt.layout_symbol["icon-size"]),"icon-text-fit":new xn(rt.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new xn(rt.layout_symbol["icon-text-fit-padding"]),"icon-image":new xn(rt.layout_symbol["icon-image"]),"icon-rotate":new xn(rt.layout_symbol["icon-rotate"]),"icon-padding":new Zt(rt.layout_symbol["icon-padding"]),"icon-keep-upright":new Zt(rt.layout_symbol["icon-keep-upright"]),"icon-offset":new xn(rt.layout_symbol["icon-offset"]),"icon-anchor":new xn(rt.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Zt(rt.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Zt(rt.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Zt(rt.layout_symbol["text-rotation-alignment"]),"text-field":new xn(rt.layout_symbol["text-field"]),"text-font":new xn(rt.layout_symbol["text-font"]),"text-size":new xn(rt.layout_symbol["text-size"]),"text-max-width":new xn(rt.layout_symbol["text-max-width"]),"text-line-height":new xn(rt.layout_symbol["text-line-height"]),"text-letter-spacing":new xn(rt.layout_symbol["text-letter-spacing"]),"text-justify":new xn(rt.layout_symbol["text-justify"]),"text-radial-offset":new xn(rt.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Zt(rt.layout_symbol["text-variable-anchor"]),"text-anchor":new xn(rt.layout_symbol["text-anchor"]),"text-max-angle":new Zt(rt.layout_symbol["text-max-angle"]),"text-writing-mode":new Zt(rt.layout_symbol["text-writing-mode"]),"text-rotate":new xn(rt.layout_symbol["text-rotate"]),"text-padding":new Zt(rt.layout_symbol["text-padding"]),"text-keep-upright":new Zt(rt.layout_symbol["text-keep-upright"]),"text-transform":new xn(rt.layout_symbol["text-transform"]),"text-offset":new xn(rt.layout_symbol["text-offset"]),"text-allow-overlap":new Zt(rt.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Zt(rt.layout_symbol["text-ignore-placement"]),"text-optional":new Zt(rt.layout_symbol["text-optional"]),visibility:new Zt(rt.layout_symbol.visibility)});var YP={paint:new Er({"icon-opacity":new xn(rt.paint_symbol["icon-opacity"]),"icon-emissive-strength":new xn(rt.paint_symbol["icon-emissive-strength"]),"text-emissive-strength":new xn(rt.paint_symbol["text-emissive-strength"]),"icon-color":new xn(rt.paint_symbol["icon-color"]),"icon-halo-color":new xn(rt.paint_symbol["icon-halo-color"]),"icon-halo-width":new xn(rt.paint_symbol["icon-halo-width"]),"icon-halo-blur":new xn(rt.paint_symbol["icon-halo-blur"]),"icon-translate":new Zt(rt.paint_symbol["icon-translate"]),"icon-translate-anchor":new Zt(rt.paint_symbol["icon-translate-anchor"]),"icon-image-cross-fade":new xn(rt.paint_symbol["icon-image-cross-fade"]),"text-opacity":new xn(rt.paint_symbol["text-opacity"]),"text-color":new xn(rt.paint_symbol["text-color"],{runtimeType:na,getOverride:r=>r.textColor,hasOverride:r=>!!r.textColor}),"text-halo-color":new xn(rt.paint_symbol["text-halo-color"]),"text-halo-width":new xn(rt.paint_symbol["text-halo-width"]),"text-halo-blur":new xn(rt.paint_symbol["text-halo-blur"]),"text-translate":new Zt(rt.paint_symbol["text-translate"]),"text-translate-anchor":new Zt(rt.paint_symbol["text-translate-anchor"])}),layout:Ene};class FB{constructor(t){this.type=t.property.overrides?t.property.overrides.runtimeType:el,this.defaultValue=t}evaluate(t){if(t.formattedSection){const o=this.defaultValue.property.overrides;if(o&&o.hasOverride(t.formattedSection))return o.getOverride(t.formattedSection)}return t.feature&&t.featureState?this.defaultValue.evaluate(t.feature,t.featureState):this.defaultValue.property.specification.default}eachChild(t){this.defaultValue.isConstant()||t(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}dn(FB,"FormatSectionOverride",{omit:["defaultValue"]});class y2 extends Jo{constructor(t,o){super(t,YP,o)}recalculate(t,o){super.recalculate(t,o),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const c=this.layout.get("text-writing-mode");if(c){const u=[];for(const h of c)u.indexOf(h)<0&&u.push(h);this.layout._values["text-writing-mode"]=u}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getValueAndResolveTokens(t,o,c,u){const h=this.layout.get(t).evaluate(o,{},c,u),m=this._unevaluatedLayout._values[t];return m.isDataDriven()||cm(m.value)||!h?h:function(g,v){return v.replace(/{([^{}]+)}/g,(x,w)=>w in g?String(g[w]):"")}(o.properties,h)}createBucket(t){return new L1(t)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const t of YP.paint.overridableProperties){if(!y2.hasPaintOverride(this.layout,t))continue;const o=this.paint.get(t),c=new FB(o),u=new lm(c,o.property.specification);let h=null;h=o.value.kind==="constant"||o.value.kind==="source"?new By("source",u):new jc("composite",u,o.value.zoomStops,o.value._interpolationType),this.paint._values[t]=new ll(o.property,h,o.parameters)}}_handleOverridablePaintPropertyUpdate(t,o,c){return!(!this.layout||o.isDataDriven()||c.isDataDriven())&&y2.hasPaintOverride(this.layout,t)}static hasPaintOverride(t,o){const c=t.get("text-field"),u=YP.paint.properties[o];let h=!1;const m=g=>{for(const v of g)if(u.overrides&&u.overrides.hasOverride(v))return void(h=!0)};if(c.value.kind==="constant"&&c.value.value instanceof Aa)m(c.value.value.sections);else if(c.value.kind==="source"){const g=x=>{h||(x instanceof Iu&&zr(x.value)===Bc?m(x.value.sections):x instanceof tf?m(x.sections):x.eachChild(g))},v=c.value;v._styleExpression&&g(v._styleExpression.expression)}return h}getProgramIds(){const t=this.paint.get("icon-opacity").constantOr(1)!==0,o=this.paint.get("text-opacity").constantOr(1)!==0,c=[];return t&&c.push("symbolIcon"),o&&c.push("symbolSDF"),c}getDefaultProgramParams(t,o){return{config:new Tm(this,o),overrideFog:!1}}}const Mne=i2.types,Tne=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function v2(r,t,o,c,u,h,m,g,v,x,w,E,C){const I=g?Math.min(Lf,Math.round(g[0])):0,D=g?Math.min(Lf,Math.round(g[1])):0;r.emplaceBack(t,o,Math.round(32*c),Math.round(32*u),h,m,(I<<1)+(v?1:0),D,16*x,16*w,256*E,256*C)}function _2(r,t,o){r.emplaceBack(t,o)}function x2(r,t,o,c,u,h,m){r.emplaceBack(t,o,c,u,h,m)}function b2(r,t,o,c,u){const h=5*t+2;r.float32[h+0]=o,r.float32[h+1]=c,r.float32[h+2]=u}function Tv(r,t,o,c,u){r.emplaceBack(t,o,c,u),r.emplaceBack(t,o,c,u),r.emplaceBack(t,o,c,u),r.emplaceBack(t,o,c,u)}function Ane(r){for(const t of r.sections)if(NC(t.text))return!0;return!1}class qP{constructor(t){this.layoutVertexArray=new Mr,this.indexArray=new Un,this.programConfigurations=t,this.segments=new qi,this.dynamicLayoutVertexArray=new hn,this.opacityVertexArray=new vo,this.placedSymbolArray=new IO,this.iconTransitioningVertexArray=new no,this.globeExtVertexArray=new $n,this.zOffsetVertexArray=new va}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0&&this.iconTransitioningVertexArray.length===0}upload(t,o,c,u,h){this.isEmpty()||(c&&(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Gte.members),this.indexBuffer=t.createIndexBuffer(this.indexArray,o),this.dynamicLayoutVertexBuffer=t.createVertexBuffer(this.dynamicLayoutVertexArray,jte.members,!0),this.opacityVertexBuffer=t.createVertexBuffer(this.opacityVertexArray,Tne,!0),this.iconTransitioningVertexArray.length>0&&(this.iconTransitioningVertexBuffer=t.createVertexBuffer(this.iconTransitioningVertexArray,Yte.members,!0)),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=t.createVertexBuffer(this.globeExtVertexArray,Hte.members,!0)),!this.zOffsetVertexBuffer&&(this.zOffsetVertexArray.length>0||h)&&(this.zOffsetVertexBuffer=t.createVertexBuffer(this.zOffsetVertexArray,$te.members,!0)),this.opacityVertexBuffer.itemSize=1),(c||u)&&this.programConfigurations.upload(t))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.iconTransitioningVertexBuffer&&this.iconTransitioningVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy(),this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy())}}dn(qP,"SymbolBuffers");class XP{constructor(t,o,c){this.layoutVertexArray=new t,this.layoutAttributes=o,this.indexArray=new c,this.segments=new qi,this.collisionVertexArray=new Tn,this.collisionVertexArrayExt=new On}upload(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,qte.members,!0),this.collisionVertexBufferExt=t.createVertexBuffer(this.collisionVertexArrayExt,Xte.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}dn(XP,"CollisionBuffers");class w2{constructor(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(m=>m.fqid),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.hasAnyIconTextFit=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=at.identity([]),this.placementViewportMatrix=at.identity([]);const o=this.layers[0]._unevaluatedLayout._values;this.textSizeData=FP(this.zoom,o["text-size"]),this.iconSizeData=FP(this.zoom,o["icon-size"]);const c=this.layers[0].layout,u=c.get("symbol-sort-key"),h=c.get("symbol-z-order");this.canOverlap=c.get("text-allow-overlap")||c.get("icon-allow-overlap")||c.get("text-ignore-placement")||c.get("icon-ignore-placement"),this.sortFeaturesByKey=h!=="viewport-y"&&u.constantOr(1)!==void 0,this.sortFeaturesByY=(h==="viewport-y"||h==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=c.get("text-writing-mode").map(m=>Ar[m]),this.stateDependentLayerIds=this.layers.filter(m=>m.isStateDependent()).map(m=>m.id),this.sourceID=t.sourceID,this.projection=t.projection,this.hasAnyZOffset=!1,this.zOffsetSortDirty=!1,this.zOffsetBuffersNeedUpload=c.get("symbol-z-elevate")}createArrays(){this.text=new qP(new wf(this.layers,this.zoom,t=>/^text/.test(t))),this.icon=new qP(new wf(this.layers,this.zoom,t=>/^icon/.test(t))),this.glyphOffsetArray=new kO,this.lineVertexArray=new DO,this.symbolInstances=new LO}calculateGlyphDependencies(t,o,c,u,h){for(let m=0;m<t.length;m++){const g=t.codePointAt(m);if(g===void 0)break;if(o[g]=!0,u&&h&&g<=65535){const v=E1[t.charAt(m)];v&&(o[v.charCodeAt(0)]=!0)}}}populate(t,o,c,u){const h=this.layers[0],m=h.layout,g=this.projection.name==="globe",v=m.get("text-font"),x=m.get("text-field"),w=m.get("icon-image"),E=(x.value.kind!=="constant"||x.value.value instanceof Aa&&!x.value.value.isEmpty()||x.value.value.toString().length>0)&&(v.value.kind!=="constant"||v.value.value.length>0),C=w.value.kind!=="constant"||!!w.value.value||Object.keys(w.parameters).length>0,I=m.get("symbol-sort-key");if(this.features=[],!E&&!C)return;const D=o.iconDependencies,N=o.glyphDependencies,W=o.availableImages,V=new dr(this.zoom);for(const{feature:q,id:Z,index:K,sourceLayerIndex:X}of t){const J=h._featureFilter.needGeometry,ae=Cf(q,J);if(!h._featureFilter.filter(V,ae,c))continue;if(J||(ae.geometry=Zu(q,c,u)),g&&q.type!==1&&c.z<=5){const Pe=ae.geometry,Me=.98078528056,Le=(Ee,He)=>{const Ke=v1(Ee.x,Ee.y,c,1),nt=v1(He.x,He.y,c,1);return De.dot(Ke,nt)<Me};for(let Ee=0;Ee<Pe.length;Ee++)Pe[Ee]=Bee(Pe[Ee],Le)}let ce,ge;if(E){const Pe=h.getValueAndResolveTokens("text-field",ae,c,W),Me=Aa.factory(Pe);Ane(Me)&&(this.hasRTLText=!0),(!this.hasRTLText||l1()==="unavailable"||this.hasRTLText&&Ns.isParsed())&&(ce=Jte(Me,h,ae))}if(C){const Pe=h.getValueAndResolveTokens("icon-image",ae,c,W);ge=Pe instanceof as?Pe:as.fromString(Pe)}if(!ce&&!ge)continue;const ve=this.sortFeaturesByKey?I.evaluate(ae,{},c):void 0;if(this.features.push({id:Z,text:ce,icon:ge,index:K,sourceLayerIndex:X,geometry:ae.geometry,properties:q.properties,type:Mne[q.type],sortKey:ve}),ge&&(D[ge.namePrimary]=!0,ge.nameSecondary&&(D[ge.nameSecondary]=!0)),ce){const Pe=v.evaluate(ae,{},c).join(","),Me=m.get("text-rotation-alignment")==="map"&&m.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Ar.vertical)>=0;for(const Le of ce.sections)if(Le.image)D[Le.image.namePrimary]=!0;else{const Ee=Sm(ce.toString()),He=Le.fontStack||Pe,Ke=N[He]=N[He]||{};this.calculateGlyphDependencies(Le.text,Ke,Me,this.allowVerticalPlacement,Ee)}}}m.get("symbol-placement")==="line"&&(this.features=function(q){const Z={},K={},X=[];let J=0;function ae(Pe){X.push(q[Pe]),J++}function ce(Pe,Me,Le){const Ee=K[Pe];return delete K[Pe],K[Me]=Ee,X[Ee].geometry[0].pop(),X[Ee].geometry[0]=X[Ee].geometry[0].concat(Le[0]),Ee}function ge(Pe,Me,Le){const Ee=Z[Me];return delete Z[Me],Z[Pe]=Ee,X[Ee].geometry[0].shift(),X[Ee].geometry[0]=Le[0].concat(X[Ee].geometry[0]),Ee}function ve(Pe,Me,Le){const Ee=Le?Me[0][Me[0].length-1]:Me[0][0];return`${Pe}:${Ee.x}:${Ee.y}`}for(let Pe=0;Pe<q.length;Pe++){const Me=q[Pe],Le=Me.geometry,Ee=Me.text?Me.text.toString():null;if(!Ee){ae(Pe);continue}const He=ve(Ee,Le),Ke=ve(Ee,Le,!0);if(He in K&&Ke in Z&&K[He]!==Z[Ke]){const nt=ge(He,Ke,Le),Ve=ce(He,Ke,X[nt].geometry);delete Z[He],delete K[Ke],K[ve(Ee,X[Ve].geometry,!0)]=Ve,X[nt].geometry=null}else He in K?ce(He,Ke,Le):Ke in Z?ge(He,Ke,Le):(ae(Pe),Z[He]=J-1,K[Ke]=J-1)}return X.filter(Pe=>Pe.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((q,Z)=>q.sortKey-Z.sortKey)}update(t,o,c,u,h){const m=Object.keys(t).length!==0;if(m&&!this.stateDependentLayers.length)return;const g=m?this.stateDependentLayers:this.layers;this.text.programConfigurations.updatePaintArrays(t,o,g,c,u,h),this.icon.programConfigurations.updatePaintArrays(t,o,g,c,u,h)}updateZOffset(){const t=(h,m,g)=>{c+=m,c>h.length&&h.resize(c);for(let v=-m;v<0;v++)h.emplace(v+c,g)},o=(h,m,g)=>{u+=m,u>h.length&&h.resize(u);for(let v=-m;v<0;v++)h.emplace(v+u,g)};if(!this.zOffsetBuffersNeedUpload)return;this.zOffsetBuffersNeedUpload=!1;let c=0,u=0;for(let h=0;h<this.symbolInstances.length;h++){const m=this.symbolInstances.get(h),{numHorizontalGlyphVertices:g,numVerticalGlyphVertices:v,numIconVertices:x}=m,w=m.zOffset,E=x>0;if((g>0||v>0)&&(t(this.text.zOffsetVertexArray,g,w),t(this.text.zOffsetVertexArray,v,w)),E){const{placedIconSymbolIndex:C,verticalPlacedIconSymbolIndex:I}=m;C>=0&&o(this.icon.zOffsetVertexArray,x,w),I>=0&&o(this.icon.zOffsetVertexArray,m.numVerticalIconVertices,w)}}this.text.zOffsetVertexBuffer&&this.text.zOffsetVertexBuffer.updateData(this.text.zOffsetVertexArray),this.icon.zOffsetVertexBuffer&&this.icon.zOffsetVertexBuffer.updateData(this.icon.zOffsetVertexArray)}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(t){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(t),this.iconCollisionBox.upload(t)),this.text.upload(t,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.icon.upload(t,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=g2(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(t,o){const c=this.lineVertexArray.length;if(t.segment!==void 0)for(const{x:u,y:h}of o)this.lineVertexArray.emplaceBack(u,h);return{lineStartIndex:c,lineLength:this.lineVertexArray.length-c}}addSymbols(t,o,c,u,h,m,g,v,x,w,E,C,I,D,N,W){const V=t.indexArray,q=t.layoutVertexArray,Z=t.globeExtVertexArray,K=t.segments.prepareSegment(4*o.length,q,V,this.canOverlap?m.sortKey:void 0),X=this.glyphOffsetArray.length,J=K.vertexLength,ae=this.allowVerticalPlacement&&g===Ar.vertical?Math.PI/2:0,ce=m.text&&m.text.sections;for(let ve=0;ve<o.length;ve++){const{tl:Pe,tr:Me,bl:Le,br:Ee,texPrimary:He,texSecondary:Ke,pixelOffsetTL:nt,pixelOffsetBR:Ve,minFontScaleX:je,minFontScaleY:ot,glyphOffset:yt,isSDF:ft,sectionIndex:Lt}=o[ve],Ft=K.vertexLength,St=yt[1];if(v2(q,x.x,x.y,Pe.x,St+Pe.y,He.x,He.y,c,ft,nt.x,nt.y,je,ot),v2(q,x.x,x.y,Me.x,St+Me.y,He.x+He.w,He.y,c,ft,Ve.x,nt.y,je,ot),v2(q,x.x,x.y,Le.x,St+Le.y,He.x,He.y+He.h,c,ft,nt.x,Ve.y,je,ot),v2(q,x.x,x.y,Ee.x,St+Ee.y,He.x+He.w,He.y+He.h,c,ft,Ve.x,Ve.y,je,ot),v){const{x:Ct,y:rn,z:ln}=v.anchor,[sn,un,vn]=v.up;x2(Z,Ct,rn,ln,sn,un,vn),x2(Z,Ct,rn,ln,sn,un,vn),x2(Z,Ct,rn,ln,sn,un,vn),x2(Z,Ct,rn,ln,sn,un,vn),Tv(t.dynamicLayoutVertexArray,Ct,rn,ln,ae)}else Tv(t.dynamicLayoutVertexArray,x.x,x.y,x.z,ae);if(W){const Ct=Ke||He;_2(t.iconTransitioningVertexArray,Ct.x,Ct.y),_2(t.iconTransitioningVertexArray,Ct.x+Ct.w,Ct.y),_2(t.iconTransitioningVertexArray,Ct.x,Ct.y+Ct.h),_2(t.iconTransitioningVertexArray,Ct.x+Ct.w,Ct.y+Ct.h)}V.emplaceBack(Ft,Ft+1,Ft+2),V.emplaceBack(Ft+1,Ft+2,Ft+3),K.vertexLength+=4,K.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(yt[0]),ve!==o.length-1&&Lt===o[ve+1].sectionIndex||t.programConfigurations.populatePaintArrays(q.length,m,m.index,{},I,D,N,ce&&ce[Lt])}const ge=v?v.anchor:x;t.placedSymbolArray.emplaceBack(ge.x,ge.y,ge.z,x.x,x.y,X,this.glyphOffsetArray.length-X,J,w,E,x.segment,c?c[0]:0,c?c[1]:0,u[0],u[1],g,0,!1,0,C,0)}_commitLayoutVertex(t,o,c,u,h,m,g){t.emplaceBack(o,c,u,h,m,Math.round(g.x),Math.round(g.y))}_addCollisionDebugVertices(t,o,c,u,h,m,g){const v=c.segments.prepareSegment(4,c.layoutVertexArray,c.indexArray),x=v.vertexLength,w=g.tileAnchorX,E=g.tileAnchorY;for(let I=0;I<4;I++)c.collisionVertexArray.emplaceBack(0,0,0,0);c.collisionVertexArrayExt.emplaceBack(o,-t.padding,-t.padding),c.collisionVertexArrayExt.emplaceBack(o,t.padding,-t.padding),c.collisionVertexArrayExt.emplaceBack(o,t.padding,t.padding),c.collisionVertexArrayExt.emplaceBack(o,-t.padding,t.padding),this._commitLayoutVertex(c.layoutVertexArray,u,h,m,w,E,new G(t.x1,t.y1)),this._commitLayoutVertex(c.layoutVertexArray,u,h,m,w,E,new G(t.x2,t.y1)),this._commitLayoutVertex(c.layoutVertexArray,u,h,m,w,E,new G(t.x2,t.y2)),this._commitLayoutVertex(c.layoutVertexArray,u,h,m,w,E,new G(t.x1,t.y2)),v.vertexLength+=4;const C=c.indexArray;C.emplaceBack(x,x+1),C.emplaceBack(x+1,x+2),C.emplaceBack(x+2,x+3),C.emplaceBack(x+3,x),v.primitiveLength+=4}_addTextDebugCollisionBoxes(t,o,c,u,h,m){for(let g=u;g<h;g++){const v=c.get(g),x=this.getSymbolInstanceTextSize(t,m,o,g);this._addCollisionDebugVertices(v,x,this.textCollisionBox,v.projectedAnchorX,v.projectedAnchorY,v.projectedAnchorZ,m)}}_addIconDebugCollisionBoxes(t,o,c,u,h,m){for(let g=u;g<h;g++){const v=c.get(g),x=this.getSymbolInstanceIconSize(t,o,m.placedIconSymbolIndex);this._addCollisionDebugVertices(v,x,this.iconCollisionBox,v.projectedAnchorX,v.projectedAnchorY,v.projectedAnchorZ,m)}}generateCollisionDebugBuffers(t,o){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new XP(Tt,lB.members,no),this.iconCollisionBox=new XP(Tt,lB.members,no);const c=Ku(this.iconSizeData,t),u=Ku(this.textSizeData,t);for(let h=0;h<this.symbolInstances.length;h++){const m=this.symbolInstances.get(h);this._addTextDebugCollisionBoxes(u,t,o,m.textBoxStartIndex,m.textBoxEndIndex,m),this._addTextDebugCollisionBoxes(u,t,o,m.verticalTextBoxStartIndex,m.verticalTextBoxEndIndex,m),this._addIconDebugCollisionBoxes(c,t,o,m.iconBoxStartIndex,m.iconBoxEndIndex,m),this._addIconDebugCollisionBoxes(c,t,o,m.verticalIconBoxStartIndex,m.verticalIconBoxEndIndex,m)}}getSymbolInstanceTextSize(t,o,c,u){const h=this.text.placedSymbolArray.get(o.rightJustifiedTextSymbolIndex>=0?o.rightJustifiedTextSymbolIndex:o.centerJustifiedTextSymbolIndex>=0?o.centerJustifiedTextSymbolIndex:o.leftJustifiedTextSymbolIndex>=0?o.leftJustifiedTextSymbolIndex:o.verticalPlacedTextSymbolIndex>=0?o.verticalPlacedTextSymbolIndex:u),m=S1(this.textSizeData,t,h)/ao;return this.tilePixelRatio*m}getSymbolInstanceIconSize(t,o,c){const u=this.icon.placedSymbolArray.get(c),h=S1(this.iconSizeData,t,u);return this.tilePixelRatio*h}_commitDebugCollisionVertexUpdate(t,o,c){t.emplaceBack(o,-c,-c),t.emplaceBack(o,c,-c),t.emplaceBack(o,c,c),t.emplaceBack(o,-c,c)}_updateTextDebugCollisionBoxes(t,o,c,u,h,m){for(let g=u;g<h;g++){const v=c.get(g),x=this.getSymbolInstanceTextSize(t,m,o,g);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,x,v.padding)}}_updateIconDebugCollisionBoxes(t,o,c,u,h,m){for(let g=u;g<h;g++){const v=c.get(g),x=this.getSymbolInstanceIconSize(t,o,m);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,x,v.padding)}}updateCollisionDebugBuffers(t,o){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const c=Ku(this.iconSizeData,t),u=Ku(this.textSizeData,t);for(let h=0;h<this.symbolInstances.length;h++){const m=this.symbolInstances.get(h);this._updateTextDebugCollisionBoxes(u,t,o,m.textBoxStartIndex,m.textBoxEndIndex,m),this._updateTextDebugCollisionBoxes(u,t,o,m.verticalTextBoxStartIndex,m.verticalTextBoxEndIndex,m),this._updateIconDebugCollisionBoxes(c,t,o,m.iconBoxStartIndex,m.iconBoxEndIndex,m.placedIconSymbolIndex),this._updateIconDebugCollisionBoxes(c,t,o,m.verticalIconBoxStartIndex,m.verticalIconBoxEndIndex,m.placedIconSymbolIndex)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(t,o,c,u,h,m,g,v,x){const w={};if(o<c){const{x1:E,y1:C,x2:I,y2:D,padding:N,projectedAnchorX:W,projectedAnchorY:V,projectedAnchorZ:q,tileAnchorX:Z,tileAnchorY:K,featureIndex:X}=t.get(o);w.textBox={x1:E,y1:C,x2:I,y2:D,padding:N,projectedAnchorX:W,projectedAnchorY:V,projectedAnchorZ:q,tileAnchorX:Z,tileAnchorY:K},w.textFeatureIndex=X}if(u<h){const{x1:E,y1:C,x2:I,y2:D,padding:N,projectedAnchorX:W,projectedAnchorY:V,projectedAnchorZ:q,tileAnchorX:Z,tileAnchorY:K,featureIndex:X}=t.get(u);w.verticalTextBox={x1:E,y1:C,x2:I,y2:D,padding:N,projectedAnchorX:W,projectedAnchorY:V,projectedAnchorZ:q,tileAnchorX:Z,tileAnchorY:K},w.verticalTextFeatureIndex=X}if(m<g){const{x1:E,y1:C,x2:I,y2:D,padding:N,projectedAnchorX:W,projectedAnchorY:V,projectedAnchorZ:q,tileAnchorX:Z,tileAnchorY:K,featureIndex:X}=t.get(m);w.iconBox={x1:E,y1:C,x2:I,y2:D,padding:N,projectedAnchorX:W,projectedAnchorY:V,projectedAnchorZ:q,tileAnchorX:Z,tileAnchorY:K},w.iconFeatureIndex=X}if(v<x){const{x1:E,y1:C,x2:I,y2:D,padding:N,projectedAnchorX:W,projectedAnchorY:V,projectedAnchorZ:q,tileAnchorX:Z,tileAnchorY:K,featureIndex:X}=t.get(v);w.verticalIconBox={x1:E,y1:C,x2:I,y2:D,padding:N,projectedAnchorX:W,projectedAnchorY:V,projectedAnchorZ:q,tileAnchorX:Z,tileAnchorY:K},w.verticalIconFeatureIndex=X}return w}deserializeCollisionBoxes(t){this.collisionArrays=[];for(let o=0;o<this.symbolInstances.length;o++){const c=this.symbolInstances.get(o);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t,c.textBoxStartIndex,c.textBoxEndIndex,c.verticalTextBoxStartIndex,c.verticalTextBoxEndIndex,c.iconBoxStartIndex,c.iconBoxEndIndex,c.verticalIconBoxStartIndex,c.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}hasIconTextFit(){return this.hasAnyIconTextFit}addIndicesForPlacedSymbol(t,o){const c=t.placedSymbolArray.get(o),u=c.vertexStartIndex+4*c.numGlyphs;for(let h=c.vertexStartIndex;h<u;h+=4)t.indexArray.emplaceBack(h,h+1,h+2),t.indexArray.emplaceBack(h+1,h+2,h+3)}getSortedSymbolIndexes(t){if(this.sortedAngle===t&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const o=Math.sin(t),c=Math.cos(t),u=[],h=[],m=[];for(let g=0;g<this.symbolInstances.length;++g){m.push(g);const v=this.symbolInstances.get(g);u.push(0|Math.round(o*v.tileAnchorX+c*v.tileAnchorY)),h.push(v.featureIndex)}return m.sort((g,v)=>u[g]-u[v]||h[v]-h[g]),m}getSortedIndexesByZOffset(){if(!this.zOffsetSortDirty)return this.symbolInstanceIndexesSortedZOffset;if(!this.symbolInstanceIndexesSortedZOffset){this.symbolInstanceIndexesSortedZOffset=[];for(let t=0;t<this.symbolInstances.length;++t)this.symbolInstanceIndexesSortedZOffset.push(t)}return this.zOffsetSortDirty=!1,this.symbolInstanceIndexesSortedZOffset.sort((t,o)=>this.symbolInstances.get(o).zOffset-this.symbolInstances.get(t).zOffset)}addToSortKeyRanges(t,o){const c=this.sortKeyRanges[this.sortKeyRanges.length-1];c&&c.sortKey===o?c.symbolInstanceEnd=t+1:this.sortKeyRanges.push({sortKey:o,symbolInstanceStart:t,symbolInstanceEnd:t+1})}sortFeatures(t){if(this.sortFeaturesByY&&this.sortedAngle!==t&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(t),this.sortedAngle=t,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const o of this.symbolInstanceIndexes){const c=this.symbolInstances.get(o);this.featureSortOrder.push(c.featureIndex);const{rightJustifiedTextSymbolIndex:u,centerJustifiedTextSymbolIndex:h,leftJustifiedTextSymbolIndex:m,verticalPlacedTextSymbolIndex:g,placedIconSymbolIndex:v,verticalPlacedIconSymbolIndex:x}=c;u>=0&&this.addIndicesForPlacedSymbol(this.text,u),h>=0&&h!==u&&this.addIndicesForPlacedSymbol(this.text,h),m>=0&&m!==h&&m!==u&&this.addIndicesForPlacedSymbol(this.text,m),g>=0&&this.addIndicesForPlacedSymbol(this.text,g),v>=0&&this.addIndicesForPlacedSymbol(this.icon,v),x>=0&&this.addIndicesForPlacedSymbol(this.icon,x)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}dn(w2,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),w2.MAX_GLYPHS=65535,w2.addDynamicAttributes=Tv;var L1=w2;const Cne=B([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:Pne}=Cne,Ine=B([{name:"a_packed",components:4,type:"Float32"}]),{members:Rne}=Ine,Lne=i2.types,kne=Math.cos(Math.PI/180*37.5);class S2{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(o=>o.fqid),this.index=t.index,this.projection=t.projection,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(o=>{this.gradients[o.id]={}}),this.layoutVertexArray=new Yt,this.layoutVertexArray2=new hn,this.indexArray=new Un,this.programConfigurations=new wf(t.layers,t.zoom),this.segments=new qi,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id)}populate(t,o,c,u){this.hasPattern=RP("line",this.layers,o);const h=this.layers[0].layout.get("line-sort-key"),m=[];for(const{feature:w,id:E,index:C,sourceLayerIndex:I}of t){const D=this.layers[0]._featureFilter.needGeometry,N=Cf(w,D);if(!this.layers[0]._featureFilter.filter(new dr(this.zoom),N,c))continue;const W=h?h.evaluate(N,{},c):void 0,V={id:E,properties:w.properties,type:w.type,sourceLayerIndex:I,index:C,geometry:D?N.geometry:Zu(w,c,u),patterns:{},sortKey:W};m.push(V)}h&&m.sort((w,E)=>w.sortKey-E.sortKey);const{lineAtlas:g,featureIndex:v}=o,x=this.addConstantDashes(g);for(const w of m){const{geometry:E,index:C,sourceLayerIndex:I}=w;if(x&&this.addFeatureDashes(w,g),this.hasPattern){const D=LP("line",this.layers,w,this.zoom,o);this.patternFeatures.push(D)}else this.addFeature(w,E,C,c,g.positions,o.availableImages,o.brightness);v.insert(t[C].feature,E,C,I,this.index)}}addConstantDashes(t){let o=!1;for(const c of this.layers){const u=c.paint.get("line-dasharray").value,h=c.layout.get("line-cap").value;if(u.kind!=="constant"||h.kind!=="constant")o=!0;else{const m=h.value,g=u.value;if(!g)continue;t.addDash(g,m)}}return o}addFeatureDashes(t,o){const c=this.zoom;for(const u of this.layers){const h=u.paint.get("line-dasharray").value,m=u.layout.get("line-cap").value;if(h.kind==="constant"&&m.kind==="constant")continue;let g,v;if(h.kind==="constant"){if(g=h.value,!g)continue}else g=h.evaluate({zoom:c},t);v=m.kind==="constant"?m.value:m.evaluate({zoom:c},t),o.addDash(g,v),t.patterns[u.id]=o.getKey(g,v)}}update(t,o,c,u,h){const m=Object.keys(t).length!==0;m&&!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(t,o,m?this.stateDependentLayers:this.layers,c,u,h)}addFeatures(t,o,c,u,h,m){for(const g of this.patternFeatures)this.addFeature(g,g.geometry,g.index,o,c,u,m)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=t.createVertexBuffer(this.layoutVertexArray2,Rne)),this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Pne),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(t){if(t.properties&&t.properties.hasOwnProperty("mapbox_clip_start")&&t.properties.hasOwnProperty("mapbox_clip_end"))return{start:+t.properties.mapbox_clip_start,end:+t.properties.mapbox_clip_end}}addFeature(t,o,c,u,h,m,g){const v=this.layers[0].layout,x=v.get("line-join").evaluate(t,{}),w=v.get("line-cap").evaluate(t,{}),E=v.get("line-miter-limit"),C=v.get("line-round-limit");this.lineClips=this.lineFeatureClips(t);for(const I of o)this.addLine(I,t,x,w,E,C);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,c,h,m,u,g)}addLine(t,o,c,u,h,m){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let V=0;V<t.length-1;V++)this.totalDistance+=t[V].dist(t[V+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const g=Lne[o.type]==="Polygon";let v=t.length;for(;v>=2&&t[v-1].equals(t[v-2]);)v--;let x=0;for(;x<v-1&&t[x].equals(t[x+1]);)x++;if(v<(g?3:2))return;c==="bevel"&&(h=1.05);const w=this.overscaling<=16?15*mt/(512*this.overscaling):0,E=this.segments.prepareSegment(10*v,this.layoutVertexArray,this.indexArray);let C,I,D,N,W;this.e1=this.e2=-1,g&&(C=t[v-2],W=t[x].sub(C)._unit()._perp());for(let V=x;V<v;V++){if(D=V===v-1?g?t[x+1]:void 0:t[V+1],D&&t[V].equals(D))continue;W&&(N=W),C&&(I=C),C=t[V],W=D?D.sub(C)._unit()._perp():N,N=N||W;let q=N.add(W);q.x===0&&q.y===0||q._unit();const Z=N.x*W.x+N.y*W.y,K=q.x*W.x+q.y*W.y,X=K!==0?1/K:1/0,J=2*Math.sqrt(2-2*K),ae=K<kne&&I&&D,ce=N.x*W.y-N.y*W.x>0;if(ae&&V>x){const Pe=C.dist(I);if(Pe>2*w){const Me=C.sub(C.sub(I)._mult(w/Pe)._round());this.updateDistance(I,Me),this.addCurrentVertex(Me,N,0,0,E),I=Me}}const ge=I&&D;let ve=ge?c:g?"butt":u;if(ge&&ve==="round"&&(X<m?ve="miter":X<=2&&(ve="fakeround")),ve==="miter"&&X>h&&(ve="bevel"),ve==="bevel"&&(X>2&&(ve="flipbevel"),X<h&&(ve="miter")),I&&this.updateDistance(I,C),ve==="miter")q._mult(X),this.addCurrentVertex(C,q,0,0,E);else if(ve==="flipbevel"){if(X>100)q=W.mult(-1);else{const Pe=X*N.add(W).mag()/N.sub(W).mag();q._perp()._mult(Pe*(ce?-1:1))}this.addCurrentVertex(C,q,0,0,E),this.addCurrentVertex(C,q.mult(-1),0,0,E)}else if(ve==="bevel"||ve==="fakeround"){const Pe=-Math.sqrt(X*X-1),Me=ce?Pe:0,Le=ce?0:Pe;if(I&&this.addCurrentVertex(C,N,Me,Le,E),ve==="fakeround"){const Ee=Math.round(180*J/Math.PI/20);for(let He=1;He<Ee;He++){let Ke=He/Ee;if(Ke!==.5){const Ve=Ke-.5;Ke+=Ke*Ve*(Ke-1)*((1.0904+Z*(Z*(3.55645-1.43519*Z)-3.2452))*Ve*Ve+(.848013+Z*(.215638*Z-1.06021)))}const nt=W.sub(N)._mult(Ke)._add(N)._unit()._mult(ce?-1:1);this.addHalfVertex(C,nt.x,nt.y,!1,ce,0,E)}}D&&this.addCurrentVertex(C,W,-Me,-Le,E)}else if(ve==="butt")this.addCurrentVertex(C,q,0,0,E);else if(ve==="square"){const Pe=I?1:-1;I||this.addCurrentVertex(C,q,Pe,Pe,E),this.addCurrentVertex(C,q,0,0,E),I&&this.addCurrentVertex(C,q,Pe,Pe,E)}else ve==="round"&&(I&&(this.addCurrentVertex(C,N,0,0,E),this.addCurrentVertex(C,N,1,1,E,!0)),D&&(this.addCurrentVertex(C,W,-1,-1,E,!0),this.addCurrentVertex(C,W,0,0,E)));if(ae&&V<v-1){const Pe=C.dist(D);if(Pe>2*w){const Me=C.add(D.sub(C)._mult(w/Pe)._round());this.updateDistance(C,Me),this.addCurrentVertex(Me,W,0,0,E),C=Me}}}}addCurrentVertex(t,o,c,u,h,m=!1){const g=o.y*u-o.x,v=-o.y-o.x*u;this.addHalfVertex(t,o.x+o.y*c,o.y-o.x*c,m,!1,c,h),this.addHalfVertex(t,g,v,m,!0,-u,h)}addHalfVertex({x:t,y:o},c,u,h,m,g,v){this.layoutVertexArray.emplaceBack((t<<1)+(h?1:0),(o<<1)+(m?1:0),Math.round(63*c)+128,Math.round(63*u)+128,1+(g===0?0:g<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);const x=v.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,x),v.primitiveLength++),m?this.e2=x:this.e1=x}updateScaledDistance(){if(this.lineClips){const t=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=t*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(t,o){this.distance+=t.dist(o),this.updateScaledDistance()}}dn(S2,"LineBucket",{omit:["layers","patternFeatures"]});class xa{constructor(t,o,c,u){this.context=t,this.format=c,this.texture=t.gl.createTexture(),this.update(o,u)}update(t,o,c){const{width:u,height:h}=t,{context:m}=this,{gl:g}=m,{HTMLImageElement:v,HTMLCanvasElement:x,HTMLVideoElement:w,ImageData:E,ImageBitmap:C}=p;if(g.bindTexture(g.TEXTURE_2D,this.texture),m.pixelStoreUnpackFlipY.set(!1),m.pixelStoreUnpack.set(1),m.pixelStoreUnpackPremultiplyAlpha.set(this.format===g.RGBA&&(!o||o.premultiply!==!1)),c||this.size&&this.size[0]===u&&this.size[1]===h){const{x:I,y:D}=c||{x:0,y:0};if(t instanceof v||t instanceof x||t instanceof w||t instanceof E||C&&t instanceof C)g.texSubImage2D(g.TEXTURE_2D,0,I,D,g.RGBA,g.UNSIGNED_BYTE,t);else{let N=this.format,W=g.UNSIGNED_BYTE;this.format===g.R32F&&(N=g.RED,W=g.FLOAT),g.texSubImage2D(g.TEXTURE_2D,0,I,D,u,h,N,W,t.data)}}else if(this.size=[u,h],t instanceof v||t instanceof x||t instanceof w||t instanceof E||C&&t instanceof C){let I=this.format;this.format===g.R8&&(I=g.RED),g.texImage2D(g.TEXTURE_2D,0,this.format,I,g.UNSIGNED_BYTE,t)}else{let I=this.format,D=this.format,N=g.UNSIGNED_BYTE;this.format===g.DEPTH_COMPONENT&&(I=g.DEPTH_COMPONENT16,N=g.UNSIGNED_SHORT),this.format===g.R32F&&(N=g.FLOAT,D=g.RED),g.texImage2D(g.TEXTURE_2D,0,I,u,h,0,D,N,t.data)}this.useMipmap=!!(o&&o.useMipmap),this.useMipmap&&g.generateMipmap(g.TEXTURE_2D)}bind(t,o){const{context:c}=this,{gl:u}=c;u.bindTexture(u.TEXTURE_2D,this.texture),t!==this.minFilter&&(u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MAG_FILTER,t),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MIN_FILTER,this.useMipmap?t===u.NEAREST?u.NEAREST_MIPMAP_NEAREST:u.LINEAR_MIPMAP_NEAREST:t),this.minFilter=t),o!==this.wrapS&&(u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_S,o),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_T,o),this.wrapS=o)}bindExtraParam(t,o,c,u){const{context:h}=this,{gl:m}=h;m.bindTexture(m.TEXTURE_2D,this.texture),o!==this.magFilter&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MAG_FILTER,o),this.magFilter=o),t!==this.minFilter&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MIN_FILTER,this.useMipmap?t===m.NEAREST?m.NEAREST_MIPMAP_NEAREST:m.LINEAR_MIPMAP_NEAREST:t),this.minFilter=t),c!==this.wrapS&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_S,c),this.wrapS=c),u!==this.wrapT&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_T,u),this.wrapT=u)}destroy(){const{gl:t}=this.context;t.deleteTexture(this.texture),this.texture=null}}class E2{constructor(t,o){this.context=t,this.texture=o}bind(t,o){const{context:c}=this,{gl:u}=c;u.bindTexture(u.TEXTURE_2D,this.texture),t!==this.minFilter&&(u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MAG_FILTER,t),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MIN_FILTER,t),this.minFilter=t),o!==this.wrapS&&(u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_S,o),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_T,o),this.wrapS=o)}}const wc=32,Ju=33,Df=new Uint16Array(8184);for(let r=0;r<2046;r++){let t=r+2,o=0,c=0,u=0,h=0,m=0,g=0;for(1&t?u=h=m=wc:o=c=g=wc;(t>>=1)>1;){const x=o+u>>1,w=c+h>>1;1&t?(u=o,h=c,o=m,c=g):(o=u,c=h,u=m,h=g),m=x,g=w}const v=4*r;Df[v+0]=o,Df[v+1]=c,Df[v+2]=u,Df[v+3]=h}const Qu=new Uint16Array(2178),zf=new Uint8Array(1089),M2=new Uint16Array(1089);function BB(r){return r===0?-.03125:r===32?.03125:0}var ZP=B([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);const UB={type:2,extent:mt,loadGeometry:()=>[[new G(0,0),new G(mt+1,0),new G(mt+1,mt+1),new G(0,mt+1),new G(0,0)]]};class k1{constructor(t,o,c,u,h){this.tileID=t,this.uid=kt(),this.uses=0,this.tileSize=o,this.tileZoom=c,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=h,u&&u.style&&(this._lastUpdatedBrightness=u.style.getBrightness()),this.expiredRequestCount=0,this.state="loading",u&&u.transform&&(this.projection=u.transform.projection)}registerFadeDuration(t){const o=t+this.timeAdded;o<Pn.now()||this.fadeEndTime&&o<this.fadeEndTime||(this.fadeEndTime=o)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}get tileTransform(){return this._tileTransform||(this._tileTransform=Lm(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(t,o,c){if(this.unloadVectorData(),this.state="loaded",t){t.featureIndex&&(this.latestFeatureIndex=t.featureIndex,t.rawTileData?(this.latestRawTileData=t.rawTileData,this.latestFeatureIndex.rawTileData=t.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=t.collisionBoxArray,this.buckets=function(u,h){const m={};if(!h)return m;for(const g of u){const v=g.layerIds.map(x=>h.getLayer(x)).filter(Boolean);if(v.length!==0){g.layers=v,g.stateDependentLayerIds&&(g.stateDependentLayers=g.stateDependentLayerIds.map(x=>v.filter(w=>w.id===x)[0]));for(const x of v)m[x.fqid]=g}}return m}(t.buckets,o.style),this.hasSymbolBuckets=!1;for(const u in this.buckets){const h=this.buckets[u];if(h instanceof L1){if(this.hasSymbolBuckets=!0,!c)break;h.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const u in this.buckets){const h=this.buckets[u];if(h instanceof L1&&h.hasRTLText){this.hasRTLText=!0,Ns.isLoading()||Ns.isLoaded()||l1()!=="deferred"||RS();break}}this.queryPadding=0;for(const u in this.buckets){const h=this.buckets[u],m=o.style.getOwnLayer(u);if(!m)continue;const g=m.queryRadius(h);this.queryPadding=Math.max(this.queryPadding,g)}t.imageAtlas&&(this.imageAtlas=t.imageAtlas),t.glyphAtlasImage&&(this.glyphAtlasImage=t.glyphAtlasImage),t.lineAtlas&&(this.lineAtlas=t.lineAtlas),this._lastUpdatedBrightness=t.brightness}else this.collisionBoxArray=new VC}unloadVectorData(){if(this.hasData()){for(const t in this.buckets)this.buckets[t].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(t){return this.buckets[t.fqid]}upload(t){for(const c in this.buckets){const u=this.buckets[c];u.uploadPending()&&u.upload(t)}const o=t.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new xa(t,this.imageAtlas.image,o.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new xa(t,this.glyphAtlasImage,o.ALPHA),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new xa(t,this.lineAtlas.image,o.ALPHA),this.lineAtlas.uploaded=!0)}prepare(t,o,c){if(this.imageAtlas&&this.imageAtlas.patchUpdatedImages(t,this.imageAtlasTexture,c),!o||!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData)return;const u=o.style.getBrightness();(this._lastUpdatedBrightness||u)&&(this._lastUpdatedBrightness&&u&&Math.abs(this._lastUpdatedBrightness-u)<.001||(this._lastUpdatedBrightness=u,this.updateBuckets(void 0,o)))}queryRenderedFeatures(t,o,c,u,h,m,g,v){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({tileResult:u,pixelPosMatrix:g,transform:m,params:h,tileTransform:this.tileTransform},t,o,c):{}}querySourceFeatures(t,o){const c=this.latestFeatureIndex;if(!c||!c.rawTileData)return;const u=c.loadVTLayers(),h=o?o.sourceLayer:"",m=u._geojsonTileLayer||u[h];if(!m)return;const g=fm(o&&o.filter),{z:v,x,y:w}=this.tileID.canonical,E={z:v,x,y:w};for(let C=0;C<m.length;C++){const I=m.feature(C);if(g.needGeometry){const W=Cf(I,!0);if(!g.filter(new dr(this.tileID.overscaledZ),W,this.tileID.canonical))continue}else if(!g.filter(new dr(this.tileID.overscaledZ),I))continue;const D=c.getId(I,h),N=new JF(I,v,x,w,D);N.tile=E,t.push(N)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}bucketsLoaded(){for(const t in this.buckets)if(this.buckets[t].uploadPending())return!1;return!0}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(t){const o=this.expirationTime;if(t.cacheControl){const c=Oe(t.cacheControl);c["max-age"]&&(this.expirationTime=Date.now()+1e3*c["max-age"])}else t.expires&&(this.expirationTime=new Date(t.expires).getTime());if(this.expirationTime){const c=Date.now();let u=!1;if(this.expirationTime>c)u=!1;else if(o)if(this.expirationTime<o)u=!0;else{const h=this.expirationTime-o;h?this.expirationTime=c+Math.max(h,3e4):u=!0}else u=!0;u?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(t,o){this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&Object.keys(t).length!==0&&o&&this.updateBuckets(t,o)}updateBuckets(t,o){if(!this.latestFeatureIndex)return;const c=this.latestFeatureIndex.loadVTLayers(),u=o.style.listImages(),h=o.style.getBrightness();for(const m in this.buckets){if(!o.style.hasLayer(m))continue;const g=this.buckets[m],v=g.layers[0].sourceLayer||"_geojsonTileLayer",x=c[v];let w={};if(t&&(w=t[v],!x||!w||Object.keys(w).length===0))continue;if(g.update(w,x,u,this.imageAtlas&&this.imageAtlas.patternPositions||{},h),g instanceof S2||g instanceof t2){const C=o.style.getOwnSourceCache(g.layers[0].source);o._terrain&&o._terrain.enabled&&C&&g.programConfigurations.needsUpload&&o._terrain._clearRenderCacheForTile(C.id,this.tileID)}const E=o&&o.style&&o.style.getOwnLayer(m);E&&(this.queryPadding=Math.max(this.queryPadding,E.queryRadius(g)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<Pn.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(t){this.symbolFadeHoldUntil=Pn.now()+t}setTexture(t,o){const c=o.context,u=c.gl;this.texture=this.texture||o.getTileTexture(t.width),this.texture?this.texture.update(t,{useMipmap:!0}):(this.texture=new xa(c,t,u.RGBA,{useMipmap:!0}),this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE))}setDependencies(t,o){const c={};for(const u of o)c[u]=!0;this.dependencies[t]=c}hasDependency(t,o){for(const c of t){const u=this.dependencies[c];if(u){for(const h of o)if(u[h])return!0}}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(t,o){if(!o||o.name==="mercator"||this._tileDebugBuffer)return;const c=Zu(UB,this.tileID.canonical,this.tileTransform)[0],u=new ee,h=new d1;for(let m=0;m<c.length;m++){const{x:g,y:v}=c[m];u.emplaceBack(g,v),h.emplaceBack(m)}h.emplaceBack(0),this._tileDebugIndexBuffer=t.createIndexBuffer(h),this._tileDebugBuffer=t.createVertexBuffer(u,Ef.members),this._tileDebugSegments=qi.simpleSegment(0,0,u.length,h.length)}_makeTileBoundsBuffers(t,o){if(this._tileBoundsBuffer||!o||o.name==="mercator")return;const c=Zu(UB,this.tileID.canonical,this.tileTransform)[0];let u,h;if(this.isRaster){const m=function(g,v){const x=Lm(g,v),w=Math.pow(2,g.z);for(let W=0;W<Ju;W++)for(let V=0;V<Ju;V++){const q=ul((g.x+(V+BB(V))/wc)/w),Z=_a((g.y+(W+BB(W))/wc)/w),K=v.project(q,Z),X=W*Ju+V;Qu[2*X+0]=Math.round((K.x*x.scale-x.x)*mt),Qu[2*X+1]=Math.round((K.y*x.scale-x.y)*mt)}zf.fill(0),M2.fill(0);for(let W=2045;W>=0;W--){const V=4*W,q=Df[V+0],Z=Df[V+1],K=Df[V+2],X=Df[V+3],J=q+K>>1,ae=Z+X>>1,ce=J+ae-Z,ge=ae+q-J,ve=Z*Ju+q,Pe=X*Ju+K,Me=ae*Ju+J,Le=Math.hypot((Qu[2*ve+0]+Qu[2*Pe+0])/2-Qu[2*Me+0],(Qu[2*ve+1]+Qu[2*Pe+1])/2-Qu[2*Me+1])>=16;zf[Me]=zf[Me]||(Le?1:0),W<1022&&(zf[Me]=zf[Me]||zf[(Z+ge>>1)*Ju+(q+ce>>1)]||zf[(X+ge>>1)*Ju+(K+ce>>1)])}const E=new qe,C=new Un;let I=0;function D(W,V){const q=V*Ju+W;return M2[q]===0&&(E.emplaceBack(Qu[2*q+0],Qu[2*q+1],W*mt/wc,V*mt/wc),M2[q]=++I),M2[q]-1}function N(W,V,q,Z,K,X){const J=W+q>>1,ae=V+Z>>1;if(Math.abs(W-K)+Math.abs(V-X)>1&&zf[ae*Ju+J])N(K,X,W,V,J,ae),N(q,Z,K,X,J,ae);else{const ce=D(W,V),ge=D(q,Z),ve=D(K,X);C.emplaceBack(ce,ge,ve)}}return N(0,0,wc,wc,wc,0),N(wc,wc,0,0,0,wc),{vertices:E,indices:C}}(this.tileID.canonical,o);u=m.vertices,h=m.indices}else{u=new qe,h=new Un;for(const{x:g,y:v}of c)u.emplaceBack(g,v,0,0);const m=e2(u.int16,void 0,4);for(let g=0;g<m.length;g+=3)h.emplaceBack(m[g],m[g+1],m[g+2])}this._tileBoundsBuffer=t.createVertexBuffer(u,ZP.members),this._tileBoundsIndexBuffer=t.createIndexBuffer(h),this._tileBoundsSegments=qi.simpleSegment(0,0,u.length,h.length)}_makeGlobeTileDebugBuffers(t,o){const c=o.projection;if(!c||c.name!=="globe"||o.freezeTileCoverage)return;const u=this.tileID.canonical,h=Pm(dF(u,o)),m=_o(o.zoom);let g;m>0&&(g=at.invert(new Float64Array(16),o.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(t,u,o,h,g,m),this._makeGlobeTileDebugTextBuffer(t,u,o,h,g,m)}_globePoint(t,o,c,u,h,m,g){let v=v1(t,o,c);if(m){const x=1<<c.z,w=xo(u.center.lng),E=Io(u.center.lat),C=(c.x+.5)/x-w;let I=0;C>.5?I=-1:C<-.5&&(I=1);let D=(t/mt+c.x)/x+I,N=(o/mt+c.y)/x;D=(D-w)*u._pixelsPerMercatorPixel+w,N=(N-E)*u._pixelsPerMercatorPixel+E;const W=[D*u.worldSize,N*u.worldSize,0];De.transformMat4(W,W,m),v=uh(v,W,g)}return De.transformMat4(v,v,h)}_makeGlobeTileDebugBorderBuffer(t,o,c,u,h,m){const g=new ee,v=new d1,x=new oe,w=(C,I,D,N,W)=>{const V=(D-C)/(W-1),q=(N-I)/(W-1),Z=g.length;for(let K=0;K<W;K++){const X=C+K*V,J=I+K*q;g.emplaceBack(X,J);const ae=this._globePoint(X,J,o,c,u,h,m);x.emplaceBack(ae[0],ae[1],ae[2]),v.emplaceBack(Z+K)}},E=mt;w(0,0,E,0,16),w(E,0,E,E,16),w(E,E,0,E,16),w(0,E,0,0,16),this._tileDebugIndexBuffer=t.createIndexBuffer(v),this._tileDebugBuffer=t.createVertexBuffer(g,Ef.members),this._globeTileDebugBorderBuffer=t.createVertexBuffer(x,rF.members),this._tileDebugSegments=qi.simpleSegment(0,0,g.length,v.length)}_makeGlobeTileDebugTextBuffer(t,o,c,u,h,m){const g=mt/4,v=new ee,x=new Un,w=new oe,E=25;x.reserve(32),v.reserve(E),w.reserve(E);const C=(I,D)=>E*I+D;for(let I=0;I<E;I++){const D=I*g;for(let N=0;N<E;N++){const W=N*g;v.emplaceBack(W,D);const V=this._globePoint(W,D,o,c,u,h,m);w.emplaceBack(V[0],V[1],V[2])}}for(let I=0;I<4;I++)for(let D=0;D<4;D++){const N=C(I,D),W=C(I,D+1),V=C(I+1,D),q=C(I+1,D+1);x.emplaceBack(N,W,V),x.emplaceBack(V,W,q)}this._tileDebugTextIndexBuffer=t.createIndexBuffer(x),this._tileDebugTextBuffer=t.createVertexBuffer(v,Ef.members),this._globeTileDebugTextBuffer=t.createVertexBuffer(w,rF.members),this._tileDebugTextSegments=qi.simpleSegment(0,0,E,32)}}class Dne{constructor(t,o){this.max=t,this.onRemove=o,this.reset()}reset(){for(const t in this.data)for(const o of this.data[t])o.timeout&&clearTimeout(o.timeout),this.onRemove(o.value);return this.data={},this.order=[],this}add(t,o,c){const u=t.wrapped().key;this.data[u]===void 0&&(this.data[u]=[]);const h={value:o,timeout:void 0};if(c!==void 0&&(h.timeout=setTimeout(()=>{this.remove(t,h)},c)),this.data[u].push(h),this.order.push(u),this.order.length>this.max){const m=this._getAndRemoveByKey(this.order[0]);m&&this.onRemove(m)}return this}has(t){return t.wrapped().key in this.data}getAndRemove(t){return this.has(t)?this._getAndRemoveByKey(t.wrapped().key):null}_getAndRemoveByKey(t){const o=this.data[t].shift();return o.timeout&&clearTimeout(o.timeout),this.data[t].length===0&&delete this.data[t],this.order.splice(this.order.indexOf(t),1),o.value}getByKey(t){const o=this.data[t];return o?o[0].value:null}get(t){return this.has(t)?this.data[t.wrapped().key][0].value:null}remove(t,o){if(!this.has(t))return this;const c=t.wrapped().key,u=o===void 0?0:this.data[c].indexOf(o),h=this.data[c][u];return this.data[c].splice(u,1),h.timeout&&clearTimeout(h.timeout),this.data[c].length===0&&delete this.data[c],this.onRemove(h.value),this.order.splice(this.order.indexOf(c),1),this}setMaxSize(t){for(this.max=t;this.order.length>this.max;){const o=this._getAndRemoveByKey(this.order[0]);o&&this.onRemove(o)}return this}filter(t){const o=[];for(const c in this.data)for(const u of this.data[c])t(u.value)||o.push(u);for(const c of o)this.remove(c.value.tileID,c)}}class Of{constructor(t,o,c,u){this.id=Of.uniqueIdxCounter,Of.uniqueIdxCounter++,this.context=t;const h=t.gl;this.buffer=h.createBuffer(),this.dynamicDraw=!!c,this.context.unbindVAO(),t.bindElementBuffer.set(this.buffer),h.bufferData(h.ELEMENT_ARRAY_BUFFER,o.arrayBuffer,this.dynamicDraw?h.DYNAMIC_DRAW:h.STATIC_DRAW),this.dynamicDraw||u||o.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(t){this.id=Of.uniqueIdxCounter,Of.uniqueIdxCounter++;const o=this.context.gl;this.context.unbindVAO(),this.bind(),o.bufferSubData(o.ELEMENT_ARRAY_BUFFER,0,t.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}Of.uniqueIdxCounter=0;const zne={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class One{constructor(t,o,c,u,h,m){this.length=o.length,this.attributes=c,this.itemSize=o.bytesPerElement,this.dynamicDraw=u,this.instanceCount=m,this.context=t;const g=t.gl;this.buffer=g.createBuffer(),t.bindVertexBuffer.set(this.buffer),g.bufferData(g.ARRAY_BUFFER,o.arrayBuffer,this.dynamicDraw?g.DYNAMIC_DRAW:g.STATIC_DRAW),this.dynamicDraw||h||o.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(t){const o=this.context.gl;this.bind(),o.bufferSubData(o.ARRAY_BUFFER,0,t.arrayBuffer)}enableAttributes(t,o){for(let c=0;c<this.attributes.length;c++){const u=o.attributes[this.attributes[c].name];u!==void 0&&t.enableVertexAttribArray(u)}}setVertexAttribPointers(t,o,c){for(let u=0;u<this.attributes.length;u++){const h=this.attributes[u],m=o.attributes[h.name];m!==void 0&&t.vertexAttribPointer(m,h.components,t[zne[h.type]],!1,this.itemSize,h.offset+this.itemSize*(c||0))}}setVertexAttribDivisor(t,o,c){for(let u=0;u<this.attributes.length;u++){const h=o.attributes[this.attributes[u].name];h!==void 0&&this.instanceCount&&this.instanceCount>0&&t.vertexAttribDivisor(h,c)}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class xr{constructor(t){this.gl=t.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(t){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Nne extends xr{getDefault(){return En.transparent}set(t){const o=this.current;(t.r!==o.r||t.g!==o.g||t.b!==o.b||t.a!==o.a||this.dirty)&&(this.gl.clearColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class Fne extends xr{getDefault(){return 1}set(t){(t!==this.current||this.dirty)&&(this.gl.clearDepth(t),this.current=t,this.dirty=!1)}}class Bne extends xr{getDefault(){return 0}set(t){(t!==this.current||this.dirty)&&(this.gl.clearStencil(t),this.current=t,this.dirty=!1)}}class Une extends xr{getDefault(){return[!0,!0,!0,!0]}set(t){const o=this.current;(t[0]!==o[0]||t[1]!==o[1]||t[2]!==o[2]||t[3]!==o[3]||this.dirty)&&(this.gl.colorMask(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class Wne extends xr{getDefault(){return!0}set(t){(t!==this.current||this.dirty)&&(this.gl.depthMask(t),this.current=t,this.dirty=!1)}}class Vne extends xr{getDefault(){return 255}set(t){(t!==this.current||this.dirty)&&(this.gl.stencilMask(t),this.current=t,this.dirty=!1)}}class Gne extends xr{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(t){const o=this.current;(t.func!==o.func||t.ref!==o.ref||t.mask!==o.mask||this.dirty)&&(this.gl.stencilFunc(t.func,t.ref,t.mask),this.current=t,this.dirty=!1)}}class Hne extends xr{getDefault(){const t=this.gl;return[t.KEEP,t.KEEP,t.KEEP]}set(t){const o=this.current;(t[0]!==o[0]||t[1]!==o[1]||t[2]!==o[2]||this.dirty)&&(this.gl.stencilOp(t[0],t[1],t[2]),this.current=t,this.dirty=!1)}}class jne extends xr{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const o=this.gl;t?o.enable(o.STENCIL_TEST):o.disable(o.STENCIL_TEST),this.current=t,this.dirty=!1}}class $ne extends xr{getDefault(){return[0,1]}set(t){const o=this.current;(t[0]!==o[0]||t[1]!==o[1]||this.dirty)&&(this.gl.depthRange(t[0],t[1]),this.current=t,this.dirty=!1)}}class Yne extends xr{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const o=this.gl;t?o.enable(o.DEPTH_TEST):o.disable(o.DEPTH_TEST),this.current=t,this.dirty=!1}}class qne extends xr{getDefault(){return this.gl.LESS}set(t){(t!==this.current||this.dirty)&&(this.gl.depthFunc(t),this.current=t,this.dirty=!1)}}class Xne extends xr{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const o=this.gl;t?o.enable(o.BLEND):o.disable(o.BLEND),this.current=t,this.dirty=!1}}class Zne extends xr{getDefault(){const t=this.gl;return[t.ONE,t.ZERO,t.ONE,t.ZERO]}set(t){const o=this.current;(t[0]!==o[0]||t[1]!==o[1]||t[2]!==o[2]||t[3]!==o[3]||this.dirty)&&(this.gl.blendFuncSeparate(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class Kne extends xr{getDefault(){return En.transparent}set(t){const o=this.current;(t.r!==o.r||t.g!==o.g||t.b!==o.b||t.a!==o.a||this.dirty)&&(this.gl.blendColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class Jne extends xr{getDefault(){return this.gl.FUNC_ADD}set(t){(t!==this.current||this.dirty)&&(this.gl.blendEquationSeparate(t,t),this.current=t,this.dirty=!1)}}class Qne extends xr{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const o=this.gl;t?o.enable(o.CULL_FACE):o.disable(o.CULL_FACE),this.current=t,this.dirty=!1}}class eie extends xr{getDefault(){return this.gl.BACK}set(t){(t!==this.current||this.dirty)&&(this.gl.cullFace(t),this.current=t,this.dirty=!1)}}class tie extends xr{getDefault(){return this.gl.CCW}set(t){(t!==this.current||this.dirty)&&(this.gl.frontFace(t),this.current=t,this.dirty=!1)}}let nie=class extends xr{getDefault(){return null}set(r){(r!==this.current||this.dirty)&&(this.gl.useProgram(r),this.current=r,this.dirty=!1)}};class iie extends xr{getDefault(){return this.gl.TEXTURE0}set(t){(t!==this.current||this.dirty)&&(this.gl.activeTexture(t),this.current=t,this.dirty=!1)}}class rie extends xr{getDefault(){const t=this.gl;return[0,0,t.drawingBufferWidth,t.drawingBufferHeight]}set(t){const o=this.current;(t[0]!==o[0]||t[1]!==o[1]||t[2]!==o[2]||t[3]!==o[3]||this.dirty)&&(this.gl.viewport(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class aie extends xr{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const o=this.gl;o.bindFramebuffer(o.FRAMEBUFFER,t),this.current=t,this.dirty=!1}}class oie extends xr{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const o=this.gl;o.bindRenderbuffer(o.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class sie extends xr{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const o=this.gl;o.bindTexture(o.TEXTURE_2D,t),this.current=t,this.dirty=!1}}class lie extends xr{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const o=this.gl;o.bindBuffer(o.ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class cie extends xr{getDefault(){return null}set(t){const o=this.gl;o.bindBuffer(o.ELEMENT_ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class uie extends xr{getDefault(){return null}set(t){this.gl&&(t!==this.current||this.dirty)&&(this.gl.bindVertexArray(t),this.current=t,this.dirty=!1)}}class die extends xr{getDefault(){return 4}set(t){if(t===this.current&&!this.dirty)return;const o=this.gl;o.pixelStorei(o.UNPACK_ALIGNMENT,t),this.current=t,this.dirty=!1}}class hie extends xr{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const o=this.gl;o.pixelStorei(o.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t),this.current=t,this.dirty=!1}}class fie extends xr{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const o=this.gl;o.pixelStorei(o.UNPACK_FLIP_Y_WEBGL,t),this.current=t,this.dirty=!1}}class KP extends xr{constructor(t,o){super(t),this.context=t,this.parent=o}getDefault(){return null}}class pie extends KP{setDirty(){this.dirty=!0}set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const o=this.gl;o.framebufferTexture2D(o.FRAMEBUFFER,o.COLOR_ATTACHMENT0,o.TEXTURE_2D,t,0),this.current=t,this.dirty=!1}}class WB extends KP{attachment(){return this.gl.DEPTH_ATTACHMENT}set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const o=this.gl;o.framebufferRenderbuffer(o.FRAMEBUFFER,this.attachment(),o.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class mie extends KP{attachment(){return this.gl.DEPTH_ATTACHMENT}set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const o=this.gl;o.framebufferTexture2D(o.FRAMEBUFFER,this.attachment(),o.TEXTURE_2D,t,0),this.current=t,this.dirty=!1}}class gie extends WB{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class yie{constructor(t,o,c,u,h){this.context=t,this.width=o,this.height=c;const m=this.framebuffer=t.gl.createFramebuffer();u&&(this.colorAttachment=new pie(t,m)),h&&(this.depthAttachmentType=h,this.depthAttachment=h==="renderbuffer"?new WB(t,m):new mie(t,m))}destroy(){const t=this.context.gl;if(this.colorAttachment){const o=this.colorAttachment.get();o&&t.deleteTexture(o)}if(this.depthAttachment&&this.depthAttachmentType)if(this.depthAttachmentType==="renderbuffer"){const o=this.depthAttachment.get();o&&t.deleteRenderbuffer(o)}else{const o=this.depthAttachment.get();o&&t.deleteTexture(o)}t.deleteFramebuffer(this.framebuffer)}}class Fn{constructor(t,o,c){this.func=t,this.mask=o,this.range=c}}Fn.ReadOnly=!1,Fn.ReadWrite=!0,Fn.disabled=new Fn(519,Fn.ReadOnly,[0,1]);const JP=7680;class hi{constructor(t,o,c,u,h,m){this.test=t,this.ref=o,this.mask=c,this.fail=u,this.depthFail=h,this.pass=m}}hi.disabled=new hi({func:519,mask:0},0,0,JP,JP,JP);const T2=771;class Ri{constructor(t,o,c,u){this.blendFunction=t,this.blendColor=o,this.mask=c,this.blendEquation=u}}Ri.Replace=[1,0,1,0],Ri.disabled=new Ri(Ri.Replace,En.transparent,[!1,!1,!1,!1]),Ri.unblended=new Ri(Ri.Replace,En.transparent,[!0,!0,!0,!0]),Ri.alphaBlended=new Ri([1,T2,1,T2],En.transparent,[!0,!0,!0,!0]),Ri.multiply=new Ri([774,0,774,0],En.transparent,[!0,!0,!0,!0]);const QP=1029,eI=2305;class mi{constructor(t,o,c){this.enable=t,this.mode=o,this.frontFace=c}}mi.disabled=new mi(!1,QP,eI),mi.backCCW=new mi(!0,QP,eI),mi.backCW=new mi(!0,QP,2304),mi.frontCW=new mi(!0,1028,2304),mi.frontCCW=new mi(!0,1028,eI);class vie{constructor(t){this.gl=t,this.clearColor=new Nne(this),this.clearDepth=new Fne(this),this.clearStencil=new Bne(this),this.colorMask=new Une(this),this.depthMask=new Wne(this),this.stencilMask=new Vne(this),this.stencilFunc=new Gne(this),this.stencilOp=new Hne(this),this.stencilTest=new jne(this),this.depthRange=new $ne(this),this.depthTest=new Yne(this),this.depthFunc=new qne(this),this.blend=new Xne(this),this.blendFunc=new Zne(this),this.blendColor=new Kne(this),this.blendEquation=new Jne(this),this.cullFace=new Qne(this),this.cullFaceSide=new eie(this),this.frontFace=new tie(this),this.program=new nie(this),this.activeTexture=new iie(this),this.viewport=new rie(this),this.bindFramebuffer=new aie(this),this.bindRenderbuffer=new oie(this),this.bindTexture=new sie(this),this.bindVertexBuffer=new lie(this),this.bindElementBuffer=new cie(this),this.bindVertexArrayOES=new uie(this),this.pixelStoreUnpack=new die(this),this.pixelStoreUnpackPremultiplyAlpha=new hie(this),this.pixelStoreUnpackFlipY=new fie(this),this.extTextureFilterAnisotropic=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=t.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureFilterAnisotropicForceOff=!1,this.extStandardDerivativesForceOff=!1,this.extDebugRendererInfo=t.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=t.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=t.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),this.extTextureFloatLinear=t.getExtension("OES_texture_float_linear"),this.extRenderToTextureHalfFloat=t.getExtension("EXT_color_buffer_half_float"),this.extTimerQuery=t.getExtension("EXT_disjoint_timer_query_webgl2"),this.maxTextureSize=t.getParameter(t.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArrayOES.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(t,o,c){return new Of(this,t,o,c)}createVertexBuffer(t,o,c,u,h){return new One(this,t,o,c,u,h)}createRenderbuffer(t,o,c){const u=this.gl,h=u.createRenderbuffer();return this.bindRenderbuffer.set(h),u.renderbufferStorage(u.RENDERBUFFER,t,o,c),this.bindRenderbuffer.set(null),h}createFramebuffer(t,o,c,u){return new yie(this,t,o,c,u)}clear({color:t,depth:o,stencil:c,colorMask:u}){const h=this.gl;let m=0;t&&(m|=h.COLOR_BUFFER_BIT,this.clearColor.set(t),this.colorMask.set(u||[!0,!0,!0,!0])),o!==void 0&&(m|=h.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(o),this.depthMask.set(!0)),c!==void 0&&(m|=h.STENCIL_BUFFER_BIT,this.clearStencil.set(c),this.stencilMask.set(255)),h.clear(m)}setCullFace(t){t.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(t.mode),this.frontFace.set(t.frontFace))}setDepthMode(t){t.func!==this.gl.ALWAYS||t.mask?(this.depthTest.set(!0),this.depthFunc.set(t.func),this.depthMask.set(t.mask),this.depthRange.set(t.range)):this.depthTest.set(!1)}setStencilMode(t){t.test.func!==this.gl.ALWAYS||t.mask?(this.stencilTest.set(!0),this.stencilMask.set(t.mask),this.stencilOp.set([t.fail,t.depthFail,t.pass]),this.stencilFunc.set({func:t.test.func,ref:t.ref,mask:t.test.mask})):this.stencilTest.set(!1)}setColorMode(t){Q(t.blendFunction,Ri.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(t.blendFunction),this.blendColor.set(t.blendColor),t.blendEquation?this.blendEquation.set(t.blendEquation):this.blendEquation.setDefault()),this.colorMask.set(t.mask)}unbindVAO(){this.bindVertexArrayOES.set(null)}}class tu extends Vn{constructor(t,o,c){super(),this.id=t,this._onlySymbols=c,o.on("data",u=>{u.dataType==="source"&&u.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&u.dataType==="source"&&u.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))}),o.on("error",()=>{this._sourceErrored=!0}),this._source=o,this._tiles={},this._cache=new Dne(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=o.minTileCacheSize,this._maxTileCacheSize=o.maxTileCacheSize,this._loadedParentTiles={},this.castsShadows=!1,this._coveredTiles={},this._shadowCasterTiles={},this._state=new Ute,this._isRaster=this._source.type==="raster"||this._source.type==="raster-dem"||this._source.type==="custom"&&this._source._dataType==="raster"}onAdd(t){this.map=t,this._minTileCacheSize=this._minTileCacheSize===void 0&&t?t._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=this._maxTileCacheSize===void 0&&t?t._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const t in this._tiles){const o=this._tiles[t];if(o.state!=="errored"&&(o.state!=="loaded"||!o.bucketsLoaded()))return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const t=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,t&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(t,o){return t.isSymbolTile=this._onlySymbols,t.isExtraShadowCaster=this._shadowCasterTiles[t.tileID.key],this._source.loadTile(t,o)}_unloadTile(t){if(this._source.unloadTile)return this._source.unloadTile(t,()=>{})}_abortTile(t){if(this._source.abortTile)return this._source.abortTile(t,()=>{})}serialize(){return this._source.serialize()}prepare(t){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const o in this._tiles){const c=this._tiles[o];c.upload(t),c.prepare(this.map.style.imageManager,this.map?this.map.painter:null,this._source.scope)}}getIds(){return Ze(this._tiles).map(t=>t.tileID).sort(VB).map(t=>t.key)}getRenderableIds(t,o){const c=[];for(const u in this._tiles)this._isIdRenderable(+u,t,o)&&c.push(this._tiles[u]);return t?c.sort((u,h)=>{const m=u.tileID,g=h.tileID,v=new G(m.canonical.x,m.canonical.y)._rotate(this.transform.angle),x=new G(g.canonical.x,g.canonical.y)._rotate(this.transform.angle);return m.overscaledZ-g.overscaledZ||x.y-v.y||x.x-v.x}).map(u=>u.tileID.key):c.map(u=>u.tileID).sort(VB).map(u=>u.key)}hasRenderableParent(t){const o=this.findLoadedParent(t,0);return!!o&&this._isIdRenderable(o.tileID.key)}_isIdRenderable(t,o,c){return this._tiles[t]&&this._tiles[t].hasData()&&!this._coveredTiles[t]&&(o||!this._tiles[t].holdingForFade())&&(c||!this._shadowCasterTiles[t])}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const t in this._tiles)this._tiles[t].state!=="errored"&&this._reloadTile(+t,"reloading")}}_reloadTile(t,o){const c=this._tiles[t];c&&(c.state!=="loading"&&(c.state=o),this._loadTile(c,this._tileLoaded.bind(this,c,t,o)))}_tileLoaded(t,o,c,u){if(u)if(t.state="errored",u.status!==404)this._source.fire(new bn(u,{tile:t}));else if(this._source.type==="raster-dem"&&this.usedForTerrain&&this.map.painter.terrain){const h=this.map.painter.terrain;this.update(this.transform,h.getScaledDemTileSize(),!0),h.resetTileLookupCache(this.id)}else this.update(this.transform);else t.timeAdded=Pn.now(),c==="expired"&&(t.refreshedUponExpiration=!0),this._setTileReloadTimer(o,t),this._source.type==="raster-dem"&&t.dem&&this._backfillDEM(t),this._state.initializeTileState(t,this.map?this.map.painter:null),this._source.fire(new $t("data",{dataType:"source",tile:t,coord:t.tileID,sourceCacheId:this.id}))}_backfillDEM(t){const o=this.getRenderableIds();for(let u=0;u<o.length;u++){const h=o[u];if(t.neighboringTiles&&t.neighboringTiles[h]){const m=this.getTileByID(h);c(t,m),c(m,t)}}function c(u,h){if(!u.dem||u.dem.borderReady)return;u.needsHillshadePrepare=!0,u.needsDEMTextureUpload=!0;let m=h.tileID.canonical.x-u.tileID.canonical.x;const g=h.tileID.canonical.y-u.tileID.canonical.y,v=Math.pow(2,u.tileID.canonical.z),x=h.tileID.key;m===0&&g===0||Math.abs(g)>1||(Math.abs(m)>1&&(Math.abs(m+v)===1?m+=v:Math.abs(m-v)===1&&(m-=v)),h.dem&&u.dem&&(u.dem.backfillBorder(h.dem,m,g),u.neighboringTiles&&u.neighboringTiles[x]&&(u.neighboringTiles[x].backfilled=!0)))}}getTile(t){return this.getTileByID(t.key)}getTileByID(t){return this._tiles[t]}_retainLoadedChildren(t,o,c,u){for(const h in this._tiles){let m=this._tiles[h];if(u[h]||!m.hasData()||m.tileID.overscaledZ<=o||m.tileID.overscaledZ>c)continue;let g=m.tileID;for(;m&&m.tileID.overscaledZ>o+1;){const x=m.tileID.scaledTo(m.tileID.overscaledZ-1);m=this._tiles[x.key],m&&m.hasData()&&(g=x)}let v=g;for(;v.overscaledZ>o;)if(v=v.scaledTo(v.overscaledZ-1),t[v.key]){u[g.key]=g;break}}}findLoadedParent(t,o){if(t.key in this._loadedParentTiles){const c=this._loadedParentTiles[t.key];return c&&c.tileID.overscaledZ>=o?c:null}for(let c=t.overscaledZ-1;c>=o;c--){const u=t.scaledTo(c),h=this._getLoadedTile(u);if(h)return h}}_getLoadedTile(t){const o=this._tiles[t.key];return o&&o.hasData()?o:this._cache.getByKey(this._source.reparseOverscaled?t.wrapped().key:t.canonical.key)}updateCacheSize(t,o){o=o||this._source.tileSize;const c=Math.ceil(t.width/o)+1,u=Math.ceil(t.height/o)+1,h=Math.floor(c*u*5),m=typeof this._minTileCacheSize=="number"?Math.max(this._minTileCacheSize,h):h,g=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,m):m;this._cache.setMaxSize(g)}handleWrapJump(t){const o=Math.round((t-(this._prevLng===void 0?t:this._prevLng))/360);if(this._prevLng=t,o){const c={};for(const u in this._tiles){const h=this._tiles[u];h.tileID=h.tileID.unwrapTo(h.tileID.wrap+o),c[h.tileID.key]=h}this._tiles=c;for(const u in this._timers)clearTimeout(this._timers[u]),delete this._timers[u];for(const u in this._tiles)this._setTileReloadTimer(+u,this._tiles[u])}}update(t,o,c,u){if(this.transform=t,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!c)return;let h;if(this.updateCacheSize(t,o),this.transform.projection.name!=="globe"&&this.handleWrapJump(this.transform.center.lng),this._shadowCasterTiles={},this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?h=t.getVisibleUnwrappedCoordinates(this._source.tileID).map(v=>new ki(v.canonical.z,v.wrap,v.canonical.z,v.canonical.x,v.canonical.y)):(h=t.coveringTiles({tileSize:o||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!c,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(h=h.filter(v=>this._source.hasTile(v)))):h=[],h.length>0&&this.castsShadows&&u&&this.transform.projection.name!=="globe"&&!this.usedForTerrain&&!tI(this._source.type)){const v=t.coveringZoomLevel({tileSize:o||this._source.tileSize,roundZoom:this._source.roundZoom&&!c}),x=Math.min(v,this._source.maxzoom),w=t.extendTileCoverForShadows(h,u,x);for(const E of w)this._shadowCasterTiles[E.key]=!0,h.push(E)}const m=this._updateRetainedTiles(h);if(tI(this._source.type)&&h.length!==0){const v={},x={},w=Object.keys(m);for(const C of w){const I=m[C],D=this._tiles[C];if(!D||D.fadeEndTime&&D.fadeEndTime<=Pn.now())continue;const N=this.findLoadedParent(I,Math.max(I.overscaledZ-tu.maxOverzooming,this._source.minzoom));N&&(this._addTile(N.tileID),v[N.tileID.key]=N.tileID),x[C]=I}const E=h[h.length-1].overscaledZ;for(const C in this._tiles){const I=this._tiles[C];if(m[C]||!I.hasData())continue;let D=I.tileID;for(;D.overscaledZ>E;){D=D.scaledTo(D.overscaledZ-1);const N=this._tiles[D.key];if(N&&N.hasData()&&x[D.key]){m[C]=I.tileID;break}}}for(const C in v)m[C]||(this._coveredTiles[C]=!0,m[C]=v[C])}for(const v in m)this._tiles[v].clearFadeHold();const g=function(v,x){const w=[];for(const E in v)E in x||w.push(E);return w}(this._tiles,m);for(const v of g){const x=this._tiles[v];x.hasSymbolBuckets&&!x.holdingForFade()?x.setHoldDuration(this.map._fadeDuration):x.hasSymbolBuckets&&!x.symbolFadeFinished()||this._removeTile(+v)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const t in this._tiles)this._tiles[t].holdingForFade()&&this._removeTile(+t)}_updateRetainedTiles(t){const o={};if(t.length===0)return o;const c={},u=t.reduce((x,w)=>Math.min(x,w.overscaledZ),1/0),h=t[0].overscaledZ,m=Math.max(h-tu.maxOverzooming,this._source.minzoom),g=Math.max(h+tu.maxUnderzooming,this._source.minzoom),v={};for(const x of t){const w=this._addTile(x);o[x.key]=x,w.hasData()||u<this._source.maxzoom&&(v[x.key]=x)}this._retainLoadedChildren(v,u,g,o);for(const x of t){let w=this._tiles[x.key];if(w.hasData())continue;if(x.canonical.z>=this._source.maxzoom){const C=x.children(this._source.maxzoom)[0],I=this.getTile(C);if(I&&I.hasData()){o[C.key]=C;continue}}else{const C=x.children(this._source.maxzoom);if(o[C[0].key]&&o[C[1].key]&&o[C[2].key]&&o[C[3].key])continue}let E=w.wasRequested();for(let C=x.overscaledZ-1;C>=m;--C){const I=x.scaledTo(C);if(c[I.key]||(c[I.key]=!0,w=this.getTile(I),!w&&E&&(w=this._addTile(I)),w&&(o[I.key]=I,E=w.wasRequested(),w.hasData())))break}}return o}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const t in this._tiles){const o=[];let c,u=this._tiles[t].tileID;for(;u.overscaledZ>0;){if(u.key in this._loadedParentTiles){c=this._loadedParentTiles[u.key];break}o.push(u.key);const h=u.scaledTo(u.overscaledZ-1);if(c=this._getLoadedTile(h),c)break;u=h}for(const h of o)this._loadedParentTiles[h]=c}}_addTile(t){let o=this._tiles[t.key];if(o)return o.isExtraShadowCaster!==!0||this._shadowCasterTiles[t.key]||this._reloadTile(t.key,"reloading"),o;o=this._cache.getAndRemove(t),o&&(this._setTileReloadTimer(t.key,o),o.tileID=t,this._state.initializeTileState(o,this.map?this.map.painter:null),this._cacheTimers[t.key]&&(clearTimeout(this._cacheTimers[t.key]),delete this._cacheTimers[t.key],this._setTileReloadTimer(t.key,o)));const c=!!o;if(!c){const u=this.map?this.map.painter:null;o=new k1(t,this._source.tileSize*t.overscaleFactor(),this.transform.tileZoom,u,this._isRaster),this._loadTile(o,this._tileLoaded.bind(this,o,t.key,o.state))}return o?(o.uses++,this._tiles[t.key]=o,c||this._source.fire(new $t("dataloading",{tile:o,coord:o.tileID,dataType:"source"})),o):null}_setTileReloadTimer(t,o){t in this._timers&&(clearTimeout(this._timers[t]),delete this._timers[t]);const c=o.getExpiryTimeout();c&&(this._timers[t]=setTimeout(()=>{this._reloadTile(t,"expired"),delete this._timers[t]},c))}_removeTile(t){const o=this._tiles[t];o&&(o.uses--,delete this._tiles[t],this._timers[t]&&(clearTimeout(this._timers[t]),delete this._timers[t]),o.uses>0||(o.hasData()&&o.state!=="reloading"?this._cache.add(o.tileID,o,o.getExpiryTimeout()):(o.aborted=!0,this._abortTile(o),this._unloadTile(o))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const t in this._tiles)this._removeTile(+t);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(t,o,c){const u=[],h=this.transform;if(!h)return u;const m=h.projection.name==="globe",g=xo(h.center.lng);for(const v in this._tiles){const x=this._tiles[v];if(c&&x.clearQueryDebugViz(),x.holdingForFade())continue;let w;if(m){const E=x.tileID.canonical;if(E.z===0){const C=[Math.abs(re(g,...D1(E,-1))-g),Math.abs(re(g,...D1(E,1))-g)];w=[0,2*C.indexOf(Math.min(...C))-1]}else{const C=[Math.abs(re(g,...D1(E,-1))-g),Math.abs(re(g,...D1(E,0))-g),Math.abs(re(g,...D1(E,1))-g)];w=[C.indexOf(Math.min(...C))-1]}}else w=[0];for(const E of w){const C=t.containsTile(x,h,o,E);C&&u.push(C)}}return u}getShadowCasterCoordinates(){return this._getRenderableCoordinates(!1,!0)}getVisibleCoordinates(t){return this._getRenderableCoordinates(t)}_getRenderableCoordinates(t,o){const c=this.getRenderableIds(t,o).map(u=>this._tiles[u].tileID);for(const u of c)u.projMatrix=this.transform.calculateProjMatrix(u.toUnwrapped());return c}sortCoordinatesByDistance(t){const o=t.slice(),c=this.transform._camera.position,u=this.transform._camera.forward(),h={};for(const m of o){const g=1/(1<<m.canonical.z);h[m.key]=((m.canonical.x+.5)*g+m.wrap-c[0])*u[0]+((m.canonical.y+.5)*g-c[1])*u[1]-c[2]*u[2]}return o.sort((m,g)=>h[m.key]-h[g.key]),o}hasTransition(){if(this._source.hasTransition())return!0;if(tI(this._source.type))for(const t in this._tiles){const o=this._tiles[t];if(o.fadeEndTime!==void 0&&o.fadeEndTime>=Pn.now())return!0}return!1}setFeatureState(t,o,c){this._state.updateState(t=t||"_geojsonTileLayer",o,c)}removeFeatureState(t,o,c){this._state.removeFeatureState(t=t||"_geojsonTileLayer",o,c)}getFeatureState(t,o){return this._state.getState(t=t||"_geojsonTileLayer",o)}setDependencies(t,o,c){const u=this._tiles[t];u&&u.setDependencies(o,c)}reloadTilesForDependencies(t,o){for(const c in this._tiles)this._tiles[c].hasDependency(t,o)&&this._reloadTile(+c,"reloading");this._cache.filter(c=>!c.hasDependency(t,o))}_preloadTiles(t,o){if(!this._sourceLoaded){const g=()=>{this._sourceLoaded&&(this._source.off("data",g),this._preloadTiles(t,o))};return void this._source.on("data",g)}const c=new Map,u=Array.isArray(t)?t:[t],h=this.map.painter.terrain,m=this.usedForTerrain&&h?h.getScaledDemTileSize():this._source.tileSize;for(const g of u){const v=g.coveringTiles({tileSize:m,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const x of v)c.set(x.key,x);this.usedForTerrain&&g.updateElevation(!1)}Xe(Array.from(c.values()),(g,v)=>{const x=new k1(g,this._source.tileSize*g.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(x,w=>{this._source.type==="raster-dem"&&x.dem&&this._backfillDEM(x),v(w,x)})},o)}}function VB(r,t){const o=Math.abs(2*r.wrap)-+(r.wrap<0),c=Math.abs(2*t.wrap)-+(t.wrap<0);return r.overscaledZ-t.overscaledZ||c-o||t.canonical.y-r.canonical.y||t.canonical.x-r.canonical.x}function tI(r){return r==="raster"||r==="image"||r==="video"||r==="custom"}function D1(r,t){const o=1<<r.z;return[r.x/o+t,(r.x+1)/o+t]}tu.maxOverzooming=10,tu.maxUnderzooming=3;const _ie=B([{name:"a_pos_3f",components:3,type:"Float32"}]),xie=B([{name:"a_color_3f",components:3,type:"Float32"}]),bie=B([{name:"a_color_4f",components:4,type:"Float32"}]),wie=B([{name:"a_uv_2f",components:2,type:"Float32"}]),Sie=B([{name:"a_normal_3f",components:3,type:"Float32"}]),Eie=B([{name:"a_normal_matrix0",components:4,type:"Float32"},{name:"a_normal_matrix1",components:4,type:"Float32"},{name:"a_normal_matrix2",components:4,type:"Float32"},{name:"a_normal_matrix3",components:4,type:"Float32"}]),Mie=B([{name:"a_pbr",components:4,type:"Uint16"},{name:"a_heightBasedEmissiveStrength",components:3,type:"Float32"}]);class nI{constructor(t=0,o=0,c=0,u=0){if(isNaN(t)||t<0||isNaN(o)||o<0||isNaN(c)||c<0||isNaN(u)||u<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=t,this.bottom=o,this.left=c,this.right=u}interpolate(t,o,c){return o.top!=null&&t.top!=null&&(this.top=kn(t.top,o.top,c)),o.bottom!=null&&t.bottom!=null&&(this.bottom=kn(t.bottom,o.bottom,c)),o.left!=null&&t.left!=null&&(this.left=kn(t.left,o.left,c)),o.right!=null&&t.right!=null&&(this.right=kn(t.right,o.right,c)),this}getCenter(t,o){const c=re((this.left+t-this.right)/2,0,t),u=re((this.top+o-this.bottom)/2,0,o);return new G(c,u)}equals(t){return this.top===t.top&&this.bottom===t.bottom&&this.left===t.left&&this.right===t.right}clone(){return new nI(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function GB(r,t){const o=Mt(r,3);at.fromQuat(r,t),Ut(r,3,o)}function iI(r,t){const o=Po.identity([]);return Po.rotateZ(o,o,-t),Po.rotateX(o,o,-r),o}function HB(r,t){const o=[r[0],r[1],0],c=[t[0],t[1],0];if(De.length(o)>=1e-15){const m=De.normalize([],o);De.scale(c,m,De.dot(c,m)),t[0]=c[0],t[1]=c[1]}const u=De.cross([],t,r);if(De.len(u)<1e-15)return null;const h=Math.atan2(-u[1],u[0]);return iI(Math.atan2(Math.sqrt(r[0]*r[0]+r[1]*r[1]),-r[2]),h)}class jB{constructor(t,o){this.position=t,this.orientation=o}get position(){return this._position}set position(t){if(t){const o=t instanceof bi?t:new bi(t[0],t[1],t[2]);this._renderWorldCopies&&(o.x=Je(o.x,0,1)),this._position=o}else this._position=null}lookAtPoint(t,o){if(this.orientation=null,!this.position)return;const c=this.position,u=this._elevation?this._elevation.getAtPointOrZero(bi.fromLngLat(t)):0,h=bi.fromLngLat(t,u),m=[h.x-c.x,h.y-c.y,h.z-c.z];o||(o=[0,0,1]),o[2]=Math.abs(o[2]),this.orientation=HB(m,o)}setPitchBearing(t,o){this.orientation=iI(ye(t),ye(-o))}}class A2{constructor(t,o){this._transform=at.identity([]),this.orientation=o,this.position=t}get mercatorPosition(){const t=this.position;return new bi(t[0],t[1],t[2])}get position(){const t=Mt(this._transform,3);return[t[0],t[1],t[2]]}set position(t){var o;t&&Ut(this._transform,3,[(o=t)[0],o[1],o[2],1])}get orientation(){return this._orientation}set orientation(t){this._orientation=t||Po.identity([]),t&&GB(this._transform,this._orientation)}getPitchBearing(){const t=this.forward(),o=this.right();return{bearing:Math.atan2(-o[1],o[0]),pitch:Math.atan2(Math.sqrt(t[0]*t[0]+t[1]*t[1]),-t[2])}}setPitchBearing(t,o){this._orientation=iI(t,o),GB(this._transform,this._orientation)}forward(){const t=Mt(this._transform,2);return[-t[0],-t[1],-t[2]]}up(){const t=Mt(this._transform,1);return[-t[0],-t[1],-t[2]]}right(){const t=Mt(this._transform,0);return[t[0],t[1],t[2]]}getCameraToWorld(t,o){const c=new Float64Array(16);return at.invert(c,this.getWorldToCamera(t,o)),c}getCameraToWorldMercator(){return this._transform}getWorldToCameraPosition(t,o,c){const u=this.position;De.scale(u,u,-t);const h=new Float64Array(16);return at.fromScaling(h,[c,c,c]),at.translate(h,h,u),h[10]*=o,h}getWorldToCamera(t,o){const c=new Float64Array(16),u=new Float64Array(4),h=this.position;return Po.conjugate(u,this._orientation),De.scale(h,h,-t),at.fromQuat(c,u),at.translate(c,c,h),c[1]*=-1,c[5]*=-1,c[9]*=-1,c[13]*=-1,c[8]*=o,c[9]*=o,c[10]*=o,c[11]*=o,c}getCameraToClipPerspective(t,o,c,u){const h=new Float64Array(16);return at.perspective(h,t,o,c,u),h}getCameraToClipOrthographic(t,o,c,u,h,m){const g=new Float64Array(16);return at.ortho(g,t,o,c,u,h,m),g}getDistanceToElevation(t,o=!1){const c=t===0?0:Xi(t,o?_a(this.position[1]):this.position[1]),u=this.forward();return(c-this.position[2])/u[2]}clone(){return new A2([...this.position],[...this.orientation])}}function $B(r,t){const o=z1(r.projection,r.zoom,r.width,r.height),c=function(h,m,g,v,x){const w=new Nn(g.lng-180*Nf,g.lat),E=new Nn(g.lng+180*Nf,g.lat),C=h.project(w.lng,w.lat),I=h.project(E.lng,E.lat),D=-Math.atan2(I.y-C.y,I.x-C.x),N=bi.fromLngLat(g);N.y=re(N.y,-1+Nf,1-Nf);const W=N.toLngLat(),V=h.project(W.lng,W.lat),q=bi.fromLngLat(W);q.x+=Nf;const Z=q.toLngLat(),K=h.project(Z.lng,Z.lat),X=XB(K.x-V.x,K.y-V.y,D),J=bi.fromLngLat(W);J.y+=Nf;const ae=J.toLngLat(),ce=h.project(ae.lng,ae.lat),ge=XB(ce.x-V.x,ce.y-V.y,D),ve=Math.abs(X.x)/Math.abs(ge.y),Pe=at.identity([]);at.rotateZ(Pe,Pe,-D*(1-(x?0:v)));const Me=at.identity([]);return at.scale(Me,Me,[1,1-(1-ve)*v,1]),Me[4]=-ge.x/ge.y*v,at.rotateZ(Me,Me,D),at.multiply(Me,Pe,Me),Me}(r.projection,0,r.center,o,t),u=YB(r);return at.scale(c,c,[u,u,1]),c}function YB(r){const t=r.projection,o=z1(r.projection,r.zoom,r.width,r.height),c=qB(t,r.center),u=qB(t,Nn.convert(t.center));return Math.pow(2,c*o+(1-o)*u)}function z1(r,t,o,c,u=1/0){const h=r.range;if(!h)return 0;const m=Math.min(u,Math.max(o,c)),g=Math.log(m/1024)/Math.LN2;return Te(h[0]+g,h[1]+g,t)}const Nf=1/4e4;function qB(r,t){const o=re(t.lat,-Kr,Kr),c=new Nn(t.lng-180*Nf,o),u=new Nn(t.lng+180*Nf,o),h=r.project(c.lng,o),m=r.project(u.lng,o),g=bi.fromLngLat(c),v=bi.fromLngLat(u),x=m.x-h.x,w=m.y-h.y,E=v.x-g.x,C=v.y-g.y,I=Math.sqrt((E*E+C*C)/(x*x+w*w));return Math.log(I)/Math.LN2}function XB(r,t,o){const c=Math.cos(o),u=Math.sin(o);return{x:r*c-t*u,y:r*u+t*c}}function km(r,t,o){return t*(mt/(r.tileSize*Math.pow(2,o-r.tileID.overscaledZ)))}const Av={unknown:0,flipRequired:1,flipNotRequired:2},Tie=Math.tan(85*Math.PI/180);function C2(r,t,o,c,u,h,m){const g=at.create();if(o)if(h.name==="globe"){const v=function(x,w){const{x:E,y:C}=x.point,I=mF(E,C,x.worldSize/x._pixelsPerMercatorPixel,0,0);return at.multiply(I,I,pP(bc(w)))}(u,t);at.multiply(g,g,v)}else{const v=uv.invert([],m);g[0]=v[0],g[1]=v[1],g[4]=v[2],g[5]=v[3],c||at.rotateZ(g,g,u.angle)}else at.multiply(g,u.labelPlaneMatrix,r);return g}function ZB(r,t,o,c,u,h,m){const g=C2(r,t,o,c,u,h,m);return h.name==="globe"&&o||(g[2]=g[6]=g[10]=g[14]=0),g}function KB(r,t,o,c,u,h,m){if(o){if(h.name==="globe"){const g=C2(r,t,o,c,u,h,m);return at.invert(g,g),at.multiply(g,r,g),g}{const g=at.clone(r),v=at.identity([]);return v[0]=m[0],v[1]=m[1],v[4]=m[2],v[5]=m[3],at.multiply(g,g,v),c||at.rotateZ(g,g,-u.angle),g}}return u.glCoordMatrix}function nu(r,t,o,c){const u=[r,t,o,1];o?Yi.transformMat4(u,u,c):r6(u,u,c);const h=u[3];return u[0]/=h,u[1]/=h,u[2]/=h,u}function JB(r,t){return Math.min(.5+r/t*.5,1.5)}function Aie(r,t){const o=r[0]/r[3],c=r[1]/r[3];return o>=-t[0]&&o<=t[0]&&c>=-t[1]&&c<=t[1]}function Cie(r,t,o,c,u,h,m,g,v,x){const w=o.transform,E=c?r.textSizeData:r.iconSizeData,C=Ku(E,o.transform.zoom),I=w.projection.name==="globe",D=[256/o.width*2+1,256/o.height*2+1],N=c?r.text.dynamicLayoutVertexArray:r.icon.dynamicLayoutVertexArray;N.clear();let W=null;I&&(W=c?r.text.globeExtVertexArray:r.icon.globeExtVertexArray);const V=r.lineVertexArray,q=c?r.text.placedSymbolArray:r.icon.placedSymbolArray,Z=o.transform.width/o.transform.height;let K,X=!1;for(let J=0;J<q.length;J++){const ae=q.get(J),{numGlyphs:ce,writingMode:ge}=ae;if(ge!==Ar.vertical||X||K===Ar.horizontal||(X=!0),K=ge,(ae.hidden||ge===Ar.vertical)&&!X){Cv(ce,N);continue}X=!1;const ve=new G(ae.tileAnchorX,ae.tileAnchorY);let{x:Pe,y:Me,z:Le}=w.projection.projectTilePoint(ve.x,ve.y,x.canonical);if(v){const[Lt,Ft,St]=v(ve);Pe+=Lt,Me+=Ft,Le+=St}const Ee=[Pe,Me,Le,1];if(Yi.transformMat4(Ee,Ee,t),!Aie(Ee,D)){Cv(ce,N);continue}const He=Ee[3],Ke=JB(o.transform.getCameraToCenterDistance(w.projection),He),nt=S1(E,C,ae),Ve=m?nt/Ke:nt*Ke,je=nu(Pe,Me,Le,u);if(je[3]<=0){Cv(ce,N);continue}let ot={};const yt=m?null:v,ft=t6(ae,Ve,!1,g,t,u,h,r.glyphOffsetArray,V,N,W,je,ve,ot,Z,yt,w.projection,x,m);X=ft.useVertical,yt&&ft.needsFlipping&&(ot={}),(ft.notEnoughRoom||X||ft.needsFlipping&&t6(ae,Ve,!0,g,t,u,h,r.glyphOffsetArray,V,N,W,je,ve,ot,Z,yt,w.projection,x,m).notEnoughRoom)&&Cv(ce,N)}c?(r.text.dynamicLayoutVertexBuffer.updateData(N),W&&r.text.globeExtVertexBuffer&&r.text.globeExtVertexBuffer.updateData(W)):(r.icon.dynamicLayoutVertexBuffer.updateData(N),W&&r.icon.globeExtVertexBuffer&&r.icon.globeExtVertexBuffer.updateData(W))}function QB(r,t,o,c,u,h,m,g,v,x,w,E,C,I,D,N){const{lineStartIndex:W,glyphStartIndex:V,segment:q}=g,Z=V+g.numGlyphs,K=W+g.lineLength,X=t.getoffsetX(V),J=t.getoffsetX(Z-1),ae=P2(r*X,o,c,u,h,m,q,W,K,v,x,w,E,C,!0,I,D,N);if(!ae)return null;const ce=P2(r*J,o,c,u,h,m,q,W,K,v,x,w,E,C,!0,I,D,N);return ce?{first:ae,last:ce}:null}function e6(r,t,o,c){return r===Ar.horizontal&&Math.abs(c)>Math.abs(o)?{useVertical:!0}:r===Ar.vertical?c>0?{needsFlipping:!0}:null:t!==Av.unknown&&function(u,h){return u===0||Math.abs(h/u)>Tie}(o,c)?t===Av.flipRequired?{needsFlipping:!0}:null:o<0?{needsFlipping:!0}:null}function t6(r,t,o,c,u,h,m,g,v,x,w,E,C,I,D,N,W,V,q){const Z=t/24,K=r.lineOffsetX*Z,X=r.lineOffsetY*Z,{lineStartIndex:J,glyphStartIndex:ae,numGlyphs:ce,segment:ge,writingMode:ve,flipState:Pe}=r,Me=J+r.lineLength,Le=Ee=>{if(w){const[Ve,je,ot]=Ee.up,yt=x.length;b2(w,yt+0,Ve,je,ot),b2(w,yt+1,Ve,je,ot),b2(w,yt+2,Ve,je,ot),b2(w,yt+3,Ve,je,ot)}const[He,Ke,nt]=Ee.point;Tv(x,He,Ke,nt,Ee.angle)};if(ce>1){const Ee=QB(Z,g,K,X,o,E,C,r,v,h,I,N,!1,W,V,q);if(!Ee)return{notEnoughRoom:!0};if(c&&!o){let[He,Ke,nt]=Ee.first.point,[Ve,je,ot]=Ee.last.point;[He,Ke]=nu(He,Ke,nt,m),[Ve,je]=nu(Ve,je,ot,m);const yt=e6(ve,Pe,(Ve-He)*D,je-Ke);if(r.flipState=yt&&yt.needsFlipping?Av.flipRequired:Av.flipNotRequired,yt)return yt}Le(Ee.first);for(let He=ae+1;He<ae+ce-1;He++){const Ke=P2(Z*g.getoffsetX(He),K,X,o,E,C,ge,J,Me,v,h,I,N,!1,!1,W,V,q);if(!Ke)return x.length-=4*(He-ae),{notEnoughRoom:!0};Le(Ke)}Le(Ee.last)}else{if(c&&!o){const He=nu(C.x,C.y,0,u),Ke=J+ge+1,nt=new G(v.getx(Ke),v.gety(Ke)),Ve=nu(nt.x,nt.y,0,u),je=Ve[3]>0?Ve:i6(C,nt,He,1,u,void 0,W,V.canonical),ot=e6(ve,Pe,(je[0]-He[0])*D,je[1]-He[1]);if(r.flipState=ot&&ot.needsFlipping?Av.flipRequired:Av.flipNotRequired,ot)return ot}const Ee=P2(Z*g.getoffsetX(ae),K,X,o,E,C,ge,J,Me,v,h,I,N,!1,!1,W,V,q);if(!Ee)return{notEnoughRoom:!0};Le(Ee)}return{}}function n6(r,t,o,c,u){const{x:h,y:m,z:g}=c.projectTilePoint(r.x,r.y,t);if(!u)return nu(h,m,g,o);const[v,x,w]=u(r);return nu(h+v,m+x,g+w,o)}function i6(r,t,o,c,u,h,m,g){const v=n6(r.sub(t)._unit()._add(r),g,u,m,h);return De.sub(v,o,v),De.normalize(v,v),De.scaleAndAdd(v,o,v,c)}function P2(r,t,o,c,u,h,m,g,v,x,w,E,C,I,D,N,W,V){const q=c?r-t:r+t;let Z=q>0?1:-1,K=0;c&&(Z*=-1,K=Math.PI),Z<0&&(K+=Math.PI);let X=g+m+(Z>0?0:1)|0,J=u,ae=u,ce=0,ge=0;const ve=Math.abs(q),Pe=[],Me=[];let Le=h,Ee=Le;const He=()=>i6(Ee,Le,ae,ve-ce+1,w,C,N,W.canonical);for(;ce+ge<=ve;){if(X+=Z,X<g||X>=v)return null;if(ae=J,Ee=Le,Pe.push(ae),I&&Me.push(Ee),Le=new G(x.getx(X),x.gety(X)),J=E[X],!J){const Ft=n6(Le,W.canonical,w,N,C);J=Ft[3]>0?E[X]=Ft:He()}ce+=ge,ge=De.distance(ae,J)}D&&C&&(E[X]&&(J=He(),ge=De.distance(ae,J)),E[X]=J);const Ke=(ve-ce)/ge,nt=Le.sub(Ee)._mult(Ke)._add(Ee),Ve=De.sub([],J,ae),je=De.scaleAndAdd([],ae,Ve,Ke);let ot=[0,0,1],yt=Ve[0],ft=Ve[1];if(V&&(ot=N.upVector(W.canonical,nt.x,nt.y),ot[0]!==0||ot[1]!==0||ot[2]!==1)){const Ft=[ot[2],0,-ot[0]],St=De.cross([],ot,Ft);De.normalize(Ft,Ft),De.normalize(St,St),yt=De.dot(Ve,Ft),ft=De.dot(Ve,St)}if(o){const Ft=De.cross([],ot,Ve);De.normalize(Ft,Ft),De.scaleAndAdd(je,je,Ft,o*Z)}const Lt=K+Math.atan2(ft,yt);return Pe.push(je),I&&Me.push(nt),{point:je,angle:Lt,path:Pe,tilePath:Me,up:ot}}function Cv(r,t){const o=t.length,c=o+4*r;t.resize(c),t.float32.fill(-1/0,4*o,4*c)}function r6(r,t,o){const c=t[0],u=t[1];return r[0]=o[0]*c+o[4]*u+o[12],r[1]=o[1]*c+o[5]*u+o[13],r[3]=o[3]*c+o[7]*u+o[15],r}const a6=(r,t,o)=>(1-o)*r+o*t,o6=r=>r*r*r*r*r;class rI{constructor(t,o,c,u,h,m,g){this.tileSize=512,this._renderWorldCopies=h===void 0||h,this._minZoom=t||0,this._maxZoom=o||22,this._minPitch=c??0,this._maxPitch=u??60,this.setProjection(m),this.setMaxBounds(g),this.width=0,this.height=0,this._center=new Nn(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new nI,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._distanceTileDataCache={},this._camera=new A2,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._horizonShift=.1,this._orthographicProjectionAtLowPitch=!1}clone(){const t=new rI(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return t._elevation=this._elevation,t._centerAltitude=this._centerAltitude,t._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,t.tileSize=this.tileSize,t.mercatorFromTransition=this.mercatorFromTransition,t.width=this.width,t.height=this.height,t.cameraElevationReference=this.cameraElevationReference,t._center=this._center,t._setZoom(this.zoom),t._seaLevelZoom=this._seaLevelZoom,t.angle=this.angle,t._fov=this._fov,t._pitch=this._pitch,t._nearZ=this._nearZ,t._farZ=this._farZ,t._averageElevation=this._averageElevation,t._unmodified=this._unmodified,t._edgeInsets=this._edgeInsets.clone(),t._camera=this._camera.clone(),t._calcMatrices(),t.freezeTileCoverage=this.freezeTileCoverage,t.frustumCorners=this.frustumCorners,t}get isOrthographic(){return this.projection.name!=="globe"&&this._orthographicProjectionAtLowPitch&&this.pitch<15}get elevation(){return this._elevation}set elevation(t){this._elevation!==t&&(this._elevation=t,this._updateCameraOnTerrain(),this._calcMatrices())}updateElevation(t,o=!1){const c=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(this._seaLevelZoom==null||c)&&this._updateCameraOnTerrain(),(t||c)&&this._constrainCamera(o),this._calcMatrices()}getProjection(){return ct(this.projection,["name","center","parallels"])}setProjection(t){this.projectionOptions=t||{name:"mercator"};const o=this.projection?this.getProjection():void 0;this.projection=g2(this.projectionOptions);const c=!Q(o,this.getProjection());return c&&this._calcMatrices(),this.mercatorFromTransition=!1,c}setOrthographicProjectionAtLowPitch(t){return this._orthographicProjectionAtLowPitch!==t&&(this._orthographicProjectionAtLowPitch=t,this._calcMatrices(),!0)}setMercatorFromTransition(){const t=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=g2({name:"mercator"});const o=t!==this.projection.name;return o&&this._calcMatrices(),o}get minZoom(){return this._minZoom}set minZoom(t){this._minZoom!==t&&(this._minZoom=t,this.zoom=Math.max(this.zoom,t))}get maxZoom(){return this._maxZoom}set maxZoom(t){this._maxZoom!==t&&(this._maxZoom=t,this.zoom=Math.min(this.zoom,t))}get minPitch(){return this._minPitch}set minPitch(t){this._minPitch!==t&&(this._minPitch=t,this.pitch=Math.max(this.pitch,t))}get maxPitch(){return this._maxPitch}set maxPitch(t){this._maxPitch!==t&&(this._maxPitch=t,this.pitch=Math.min(this.pitch,t))}get renderWorldCopies(){return this._renderWorldCopies&&this.projection.supportsWorldCopies===!0}set renderWorldCopies(t){t===void 0?t=!0:t===null&&(t=!1),this._renderWorldCopies=t}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const t=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(t))}get cameraWorldSize(){const t=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(t))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return Xi(1,this.center.lat)*this.cameraWorldSizeForFog}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new G(this.width,this.height)}get bearing(){return Je(this.rotation,-180,180)}set bearing(t){this.rotation=t}get rotation(){return-this.angle/Math.PI*180}set rotation(t){const o=-t*Math.PI/180;this.angle!==o&&(this._unmodified=!1,this.angle=o,this._calcMatrices(),this.rotationMatrix=uv.create(),uv.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(t){const o=re(t,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==o&&(this._unmodified=!1,this._pitch=o,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}get fovX(){return this._fov}get fovY(){const t=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/t)}set fov(t){t=Math.max(.01,Math.min(60,t)),this._fov!==t&&(this._unmodified=!1,this._fov=ye(t),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(t){this._averageElevation=t,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(t){const o=Math.min(Math.max(t,this.minZoom),this.maxZoom);this._zoom!==o&&(this._unmodified=!1,this._setZoom(o),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(t){this._zoom=t,this.scale=this.zoomScale(t),this.tileZoom=Math.floor(t),this.zoomFraction=t-this.tileZoom}_updateCameraOnTerrain(){const t=this.elevation?this.elevation.getAtPoint(this.locationCoordinate(this.center),Number.NEGATIVE_INFINITY):Number.NEGATIVE_INFINITY,o=this.elevation&&t===Number.NEGATIVE_INFINITY&&this.elevation.visibleDemTiles.length>0&&this.elevation.exaggeration()>0&&this._centerAltitudeValidForExaggeration;if(!this._elevation||t===Number.NEGATIVE_INFINITY&&(!o||!this._centerAltitude))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const c=this._elevation;o||this._centerAltitude&&this._centerAltitudeValidForExaggeration&&c.exaggeration()&&this._centerAltitudeValidForExaggeration!==c.exaggeration()?(this._centerAltitude=this._centerAltitude/this._centerAltitudeValidForExaggeration*c.exaggeration(),this._centerAltitudeValidForExaggeration=c.exaggeration()):(this._centerAltitude=t||0,this._centerAltitudeValidForExaggeration=c.exaggeration()),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){this._centerAltitudeValidForExaggeration!==void 0&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const t=this._elevation,o=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],c=this.horizonLineFromTop();let u=0,h=0;for(let m=0;m<o.length;m++){const g=new G(o[m][0]*this.width,c+o[m][1]*(this.height-c)),v=t.pointCoordinate(g);if(!v)continue;const x=1/Math.hypot(v[0]-this._camera.position[0],v[1]-this._camera.position[1]);u+=v[3]*x,h+=x}return h===0?NaN:u/h}get center(){return this._center}set center(t){t.lat===this._center.lat&&t.lng===this._center.lng||(this._unmodified=!1,this._center=t,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._seaLevelZoom==null||!this._elevation)return;const t=this._seaLevelZoom,o=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),c=this.pixelsPerMeter/this.worldSize*o,u=this._mercatorZfromZoom(t),h=this._mercatorZfromZoom(this._maxZoom),m=Math.max(u-c,h);this._setZoom(this._zoomFromMercatorZ(m))}get padding(){return this._edgeInsets.toJSON()}set padding(t){this._edgeInsets.equals(t)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,t,1),this._calcMatrices())}computeZoomRelativeTo(t){const o=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,t.toAltitude()));let c;c=t.z<this._camera.position[2]?[o.x,o.y,o.z]:[t.x,t.y,t.z];const u=De.length(De.sub([],this._camera.position,c));return re(this._zoomFromMercatorZ(u),this._minZoom,this._maxZoom)}setFreeCameraOptions(t){if(!this.height||!t.position&&!t.orientation)return;this._updateCameraState();let o=!1;if(t.orientation&&!Po.exactEquals(t.orientation,this._camera.orientation)&&(o=this._setCameraOrientation(t.orientation)),t.position){const c=[t.position.x,t.position.y,t.position.z];De.exactEquals(c,this._camera.position)||(this._setCameraPosition(c),o=!0)}o&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const t=this._camera.position,o=new jB;return o.position=new bi(t[0],t[1],t[2]),o.orientation=this._camera.orientation,o._elevation=this.elevation,o._renderWorldCopies=this.renderWorldCopies,o}_setCameraOrientation(t){if(!Po.length(t))return!1;Po.normalize(t,t);const o=De.transformQuat([],[0,0,-1],t),c=De.transformQuat([],[0,-1,0],t);if(c[2]<0)return!1;const u=HB(o,c);return!!u&&(this._camera.orientation=u,!0)}_setCameraPosition(t){const o=this.zoomScale(this.minZoom)*this.tileSize,c=this.zoomScale(this.maxZoom)*this.tileSize,u=this.cameraToCenterDistance;t[2]=re(t[2],u/c,u/o),this._camera.position=t}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(t){return this._edgeInsets.equals(t)}interpolatePadding(t,o,c){this._unmodified=!1,this._edgeInsets.interpolate(t,o,c),this._constrain(),this._calcMatrices()}coveringZoomLevel(t){const o=(t.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/t.tileSize));return Math.max(0,o)}getVisibleUnwrappedCoordinates(t){const o=[new lP(0,t)];if(this.renderWorldCopies){const c=this.pointCoordinate(new G(0,0)),u=this.pointCoordinate(new G(this.width,0)),h=this.pointCoordinate(new G(this.width,this.height)),m=this.pointCoordinate(new G(0,this.height)),g=Math.floor(Math.min(c.x,u.x,h.x,m.x)),v=Math.floor(Math.max(c.x,u.x,h.x,m.x)),x=1;for(let w=g-x;w<=v+x;w++)w!==0&&o.push(new lP(w,t))}return o}isLODDisabled(t){return(!t||this.pitch<=60)&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace}extendTileCoverForShadows(t,o,c){let u=[];if(o[0]===0&&o[1]===0)return u;for(const m of t){const g=m.canonical,v=m.overscaledZ,x=m.wrap,w=1<<g.z,E=g.x+1<w,C=g.x>0,I=g.y+1<w,D=g.y>0,N=m.wrap-(C?0:1),W=m.wrap+(E?0:1),V=C?g.x-1:w-1,q=E?g.x+1:0;o[0]<0?(u.push(new ki(v,W,g.z,q,g.y)),o[1]<0&&I&&(u.push(new ki(v,x,g.z,g.x,g.y+1)),u.push(new ki(v,W,g.z,q,g.y+1))),o[1]>0&&D&&(u.push(new ki(v,x,g.z,g.x,g.y-1)),u.push(new ki(v,W,g.z,q,g.y-1)))):o[0]>0?(u.push(new ki(v,N,g.z,V,g.y)),o[1]<0&&I&&(u.push(new ki(v,x,g.z,g.x,g.y+1)),u.push(new ki(v,N,g.z,V,g.y+1))),o[1]>0&&D&&(u.push(new ki(v,x,g.z,g.x,g.y-1)),u.push(new ki(v,N,g.z,V,g.y-1)))):o[1]<0&&I?u.push(new ki(v,x,g.z,g.x,g.y+1)):D&&u.push(new ki(v,x,g.z,g.x,g.y-1))}if(u.length>1){u.sort((v,x)=>v.overscaledZ-x.overscaledZ||v.wrap-x.wrap||v.canonical.z-x.canonical.z||v.canonical.x-x.canonical.x||v.canonical.y-x.canonical.y);let m=0,g=0;for(;g<u.length;)u[g].equals(u[m])?++g:u[++m]=u[g++];u.length=m+1}const h=[];for(const m of u)u.some(g=>m.isChildOf(g))||h.push(m);return u=h.filter(m=>!t.some(g=>!!(m.overscaledZ<c&&g.isChildOf(m))||m.equals(g)||m.isChildOf(g))),u}coveringTiles(t){let o=this.coveringZoomLevel(t);const c=o,u=this.elevation&&this.elevation.exaggeration(),h=u&&!t.isTerrainDEM,m=this.projection.name==="mercator";if(t.minzoom!==void 0&&o<t.minzoom)return[];t.maxzoom!==void 0&&o>t.maxzoom&&(o=t.maxzoom);const g=this.locationCoordinate(this.center),v=this.center.lat,x=1<<o,w=[x*g.x,x*g.y,0],E=this.projection.name==="globe",C=!E,I=ch.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,o,C),D=E?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),N=x*Xi(1,this.center.lat),W=this._camera.position[2]/Xi(1,this.center.lat),V=[x*D.x,x*D.y,W*(C?1:N)],q=E||u,Z=this.cameraToCenterDistance/t.tileSize*(t.roundZoom?1:.502),K=this.isLODDisabled(!0)?o:0,X=t.isTerrainDEM&&this._elevation?1e4*this._elevation.exaggeration():this._centerAltitude,J=t.isTerrainDEM?-X:this._elevation?this._elevation.getMinElevationBelowMSL():0,ae=this.projection.isReprojectedInTileSpace?YB(this):1,ce=Ve=>{const ot=new bi(Ve.x+25e-6,Ve.y,Ve.z),yt=new bi(Ve.x,Ve.y+25e-6,Ve.z),ft=Ve.toLngLat(),Lt=ot.toLngLat(),Ft=yt.toLngLat(),St=this.locationCoordinate(ft),Ct=this.locationCoordinate(Lt),rn=this.locationCoordinate(Ft),ln=Math.hypot(Ct.x-St.x,Ct.y-St.y),sn=Math.hypot(rn.x-St.x,rn.y-St.y);return Math.sqrt(ln*sn)*ae/25e-6},ge=Ve=>{const je=X,ot=J;return{aabb:RB(this,x,0,0,0,Ve,ot,je,this.projection),zoom:0,x:0,y:0,minZ:ot,maxZ:je,wrap:Ve,fullyVisible:!1}},ve=[];let Pe=[];const Me=o,Le=t.reparseOverscaled?c:o,Ee=Ve=>Ve*Ve,He=Ee((W-this._centerAltitude)*N),Ke=Ve=>{if(!this._elevation||!Ve.tileID||!m)return;const je=this._elevation.getMinMaxForTile(Ve.tileID),ot=Ve.aabb;je?(ot.min[2]=je.min,ot.max[2]=je.max,ot.center[2]=(ot.min[2]+ot.max[2])/2):(Ve.shouldSplit=nt(Ve),Ve.shouldSplit||(ot.min[2]=ot.max[2]=ot.center[2]=this._centerAltitude))},nt=Ve=>{if(Ve.zoom<K)return!0;if(Ve.zoom===Me)return!1;if(Ve.shouldSplit!=null)return Ve.shouldSplit;const je=Ve.aabb.distanceX(V),ot=Ve.aabb.distanceY(V);let yt=He,ft=1;if(E){yt=Ee(Ve.aabb.distanceZ(V));const St=Math.pow(2,Ve.zoom),Ct=_a((Ve.y+1)/St),rn=_a(Ve.y/St),ln=Math.min(Math.max(v,Ct),rn),sn=jS(ln)/jS(v);if(ft=ln===v?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,sn/this._mercatorScaleRatio),this.zoom<=y1&&Ve.zoom===Me-1&&sn>=.9)return!0}else if(h&&(yt=Ee(Ve.aabb.distanceZ(V)*N)),this.projection.isReprojectedInTileSpace&&c<=5){const St=Math.pow(2,Ve.zoom),Ct=ce(new bi((Ve.x+.5)/St,(Ve.y+.5)/St));ft=Ct>.85?1:Ct}const Lt=je*je+ot*ot+yt,Ft=Ee((1<<Me-Ve.zoom)*Z*ft*((St,Ct)=>{if(Ct*Ee(.707)<St)return 1;const rn=Math.sqrt(Ct/St);return rn/(1.4144271570014144+(Math.pow(1.1,rn-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(yt,He),Lt));return Lt<Ft};if(this.renderWorldCopies)for(let Ve=1;Ve<=3;Ve++)ve.push(ge(-Ve)),ve.push(ge(Ve));for(ve.push(ge(0));ve.length>0;){const Ve=ve.pop(),je=Ve.x,ot=Ve.y;let yt=Ve.fullyVisible;const ft=()=>this.projection.name==="globe"&&(Ve.y===0||Ve.y===(1<<Ve.zoom)-1);if(!yt){let Lt=q?Ve.aabb.intersects(I):Ve.aabb.intersectsFlat(I);if(Lt===0&&ft()){const Ft=new Xu(Ve.zoom,je,ot);Lt=hP(this,x,Ft,!0).intersects(I)}if(Lt===0)continue;yt=Lt===2}if(Ve.zoom!==Me&&nt(Ve))for(let Lt=0;Lt<4;Lt++){const Ft=(je<<1)+Lt%2,St=(ot<<1)+(Lt>>1),Ct={aabb:m?Ve.aabb.quadrant(Lt):RB(this,x,Ve.zoom+1,Ft,St,Ve.wrap,Ve.minZ,Ve.maxZ,this.projection),zoom:Ve.zoom+1,x:Ft,y:St,wrap:Ve.wrap,fullyVisible:yt,tileID:void 0,shouldSplit:void 0,minZ:Ve.minZ,maxZ:Ve.maxZ};h&&!E&&(Ct.tileID=new ki(Ve.zoom+1===Me?Le:Ve.zoom+1,Ve.wrap,Ve.zoom+1,Ft,St),Ke(Ct)),ve.push(Ct)}else{const Lt=Ve.zoom===Me?Le:Ve.zoom;if(t.minzoom&&t.minzoom>Lt)continue;if(!yt){let rn=q?Ve.aabb.intersectsPrecise(I):Ve.aabb.intersectsPreciseFlat(I);if(rn===0&&ft()){const ln=new Xu(Ve.zoom,je,ot);rn=hP(this,x,ln,!0).intersectsPrecise(I)}if(rn===0)continue}const Ft=w[0]-(.5+je+(Ve.wrap<<Ve.zoom))*(1<<o-Ve.zoom),St=w[1]-.5-ot,Ct=Ve.tileID?Ve.tileID:new ki(Lt,Ve.wrap,Ve.zoom,je,ot);Pe.push({tileID:Ct,distanceSq:Ft*Ft+St*St})}}if(this.fogCullDistSq){const Ve=this.fogCullDistSq,je=this.horizonLineFromTop();Pe=Pe.filter(ot=>{const yt=[0,0,0,1],ft=[mt,mt,0,1],Lt=this.calculateFogTileMatrix(ot.tileID.toUnwrapped());Yi.transformMat4(yt,yt,Lt),Yi.transformMat4(ft,ft,Lt);const Ft=function(rn,ln,sn){let un=0;for(let vn=0;vn<2;++vn)rn[vn]>0&&(un+=(rn[vn]-0)*(rn[vn]-0)),ln[vn]<0&&(un+=(0-ln[vn])*(0-ln[vn]));return un}(Yi.min([],yt,ft),Yi.max([],yt,ft));if(Ft===0)return!0;let St=!1;const Ct=this._elevation;if(Ct&&Ft>Ve&&je!==0){const rn=this.calculateProjMatrix(ot.tileID.toUnwrapped());let ln;t.isTerrainDEM||(ln=Ct.getMinMaxForTile(ot.tileID)),ln||(ln={min:J,max:X});const sn=function(vn){const zn=Math.round((vn+45+360)%360/90)%4;return Ae[zn]}(this.rotation),un=[sn[0]*mt,sn[1]*mt,ln.max];De.transformMat4(un,un,rn),St=(1-un[1])*this.height*.5<je}return Ft<Ve||St})}return Pe.sort((Ve,je)=>Ve.distanceSq-je.distanceSq).map(Ve=>Ve.tileID)}resize(t,o){this.width=t,this.height=o,this.pixelsToGLUnits=[2/t,-2/o],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(t){return Math.pow(2,t)}scaleZoom(t){return Math.log(t)/Math.LN2}project(t){const o=re(t.lat,-Kr,Kr),c=this.projection.project(t.lng,o);return new G(c.x*this.worldSize,c.y*this.worldSize)}unproject(t){return this.projection.unproject(t.x/this.worldSize,t.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/Xi(1,this.center.lat)/this.worldSize}setLocationAtPoint(t,o){let c,u;const h=this.centerPoint;if(this.projection.name==="globe"){const g=this.worldSize;c=(o.x-h.x)/g,u=(o.y-h.y)/g}else{const g=this.pointCoordinate(o),v=this.pointCoordinate(h);c=g.x-v.x,u=g.y-v.y}const m=this.locationCoordinate(t);this.setLocation(new bi(m.x-c,m.y-u))}setLocation(t){this.center=this.coordinateLocation(t),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(t){return this.projection.locationPoint(this,t)}locationPoint3D(t){return this.projection.locationPoint(this,t,!0)}pointLocation(t){return this.coordinateLocation(this.pointCoordinate(t))}pointLocation3D(t){return this.coordinateLocation(this.pointCoordinate3D(t))}locationCoordinate(t,o){const c=o?Xi(o,t.lat):void 0,u=this.projection.project(t.lng,t.lat);return new bi(u.x,u.y,c)}coordinateLocation(t){return this.projection.unproject(t.x,t.y)}pointRayIntersection(t,o){const c=o??this._centerAltitude,u=[t.x,t.y,0,1],h=[t.x,t.y,1,1];Yi.transformMat4(u,u,this.pixelMatrixInverse),Yi.transformMat4(h,h,this.pixelMatrixInverse);const m=h[3];Yi.scale(u,u,1/u[3]),Yi.scale(h,h,1/m);const g=u[2],v=h[2];return{p0:u,p1:h,t:g===v?0:(c-g)/(v-g)}}screenPointToMercatorRay(t){const o=[t.x,t.y,0,1],c=[t.x,t.y,1,1];return Yi.transformMat4(o,o,this.pixelMatrixInverse),Yi.transformMat4(c,c,this.pixelMatrixInverse),Yi.scale(o,o,1/o[3]),Yi.scale(c,c,1/c[3]),o[2]=Xi(o[2],this._center.lat)*this.worldSize,c[2]=Xi(c[2],this._center.lat)*this.worldSize,Yi.scale(o,o,1/this.worldSize),Yi.scale(c,c,1/this.worldSize),new US([o[0],o[1],o[2]],De.normalize([],De.sub([],c,o)))}rayIntersectionCoordinate(t){const{p0:o,p1:c,t:u}=t,h=Xi(o[2],this._center.lat),m=Xi(c[2],this._center.lat);return new bi(kn(o[0],c[0],u)/this.worldSize,kn(o[1],c[1],u)/this.worldSize,kn(h,m,u))}pointCoordinate(t,o=this._centerAltitude){return this.projection.pointCoordinate(this,t.x,t.y,o)}pointCoordinate3D(t){if(!this.elevation)return this.pointCoordinate(t);let o=this.projection.pointCoordinate3D(this,t.x,t.y);if(o)return new bi(o[0],o[1],o[2]);let c=0,u=this.horizonLineFromTop();if(t.y>u)return this.pointCoordinate(t);const h=.02*u,m=t.clone();for(let g=0;g<10&&u-c>h;g++){m.y=kn(c,u,.66);const v=this.projection.pointCoordinate3D(this,m.x,m.y);v?(u=m.y,o=v):c=m.y}return o?new bi(o[0],o[1],o[2]):this.pointCoordinate(t)}isPointAboveHorizon(t){return this.projection.isPointAboveHorizon(this,t)}isPointOnSurface(t){if(t.y<0||t.y>this.height||t.x<0||t.x>this.width)return!1;if(this.elevation||this.zoom>=Mf)return!this.isPointAboveHorizon(t);const o=this.pointCoordinate(t);return o.y>=0&&o.y<=1}_coordinatePoint(t,o){const c=o&&this.elevation?this.elevation.getAtPointOrZero(t,this._centerAltitude):this._centerAltitude,u=[t.x*this.worldSize,t.y*this.worldSize,c+t.toAltitude(),1];return Yi.transformMat4(u,u,this.pixelMatrix),u[3]>0?new G(u[0]/u[3],u[1]/u[3]):new G(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:t,left:o}=this._edgeInsets,c=this.height-this._edgeInsets.bottom,u=this.width-this._edgeInsets.right,h=this.pointLocation3D(new G(o,t)),m=this.pointLocation3D(new G(u,t)),g=this.pointLocation3D(new G(u,c)),v=this.pointLocation3D(new G(o,c));let x=Math.min(h.lng,m.lng,g.lng,v.lng),w=Math.max(h.lng,m.lng,g.lng,v.lng),E=Math.min(h.lat,m.lat,g.lat,v.lat),C=Math.max(h.lat,m.lat,g.lat,v.lat);const I=Math.pow(2,-this.zoom)/16*270,D=this.projection.name==="globe"?1:4,N=(W,V,q,Z,K)=>{const X=(W+q)/2,J=(V+Z)/2,ae=new G(X,J),{lng:ce,lat:ge}=this.pointLocation3D(ae),ve=Math.max(0,x-ce,E-ge,ce-w,ge-C);x=Math.min(x,ce),w=Math.max(w,ce),E=Math.min(E,ge),C=Math.max(C,ge),(K<D||ve>I)&&(N(W,V,X,J,K+1),N(X,J,q,Z,K+1))};if(N(o,t,u,t,1),N(u,t,u,c,1),N(u,c,o,c,1),N(o,c,o,t,1),this.projection.name==="globe"){const[W,V]=function(q){const Z=at.identity(new Float64Array(16));at.multiply(Z,q.pixelMatrix,q.globeMatrix);const K=[0,_c,0],X=[0,xc,0];return De.transformMat4(K,K,Z),De.transformMat4(X,X,Z),[K[0]>0&&K[0]<=q.width&&K[1]>0&&K[1]<=q.height&&!HS(q,new Nn(q.center.lat,90)),X[0]>0&&X[0]<=q.width&&X[1]>0&&X[1]<=q.height&&!HS(q,new Nn(q.center.lat,-90))]}(this);W?(C=90,w=180,x=-180):V&&(E=-90,w=180,x=-180)}return new Fl(new Nn(x,E),new Nn(w,C))}_getBoundsRectangular(t,o){const{top:c,left:u}=this._edgeInsets,h=this.height-this._edgeInsets.bottom,m=this.width-this._edgeInsets.right,g=new G(u,c),v=new G(m,c),x=new G(m,h),w=new G(u,h);let E=this.pointCoordinate(g,t),C=this.pointCoordinate(v,t);const I=this.pointCoordinate(x,o),D=this.pointCoordinate(w,o),N=(W,V)=>(V.y-W.y)/(V.x-W.x);return E.y>1&&C.y>=0?E=new bi((1-D.y)/N(D,E)+D.x,1):E.y<0&&C.y<=1&&(E=new bi(-D.y/N(D,E)+D.x,0)),C.y>1&&E.y>=0?C=new bi((1-I.y)/N(I,C)+I.x,1):C.y<0&&E.y<=1&&(C=new bi(-I.y/N(I,C)+I.x,0)),new Fl().extend(this.coordinateLocation(E)).extend(this.coordinateLocation(C)).extend(this.coordinateLocation(D)).extend(this.coordinateLocation(I))}_getBoundsRectangularTerrain(){const t=this.elevation;if(!t.visibleDemTiles.length||t.isUsingMockSource())return this._getBoundsRectangular(0,0);const o=t.visibleDemTiles.reduce((c,u)=>{if(u.dem){const h=u.dem.tree;c.min=Math.min(c.min,h.minimums[0]),c.max=Math.max(c.max,h.maximums[0])}return c},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(o.min*t.exaggeration(),o.max*t.exaggeration())}getBounds(){return this.projection.name==="mercator"||this.projection.name==="equirectangular"?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(t=!0){const o=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))-this.centerOffset.y,c=this.height/2-o*(1-this._horizonShift);return t?Math.max(0,c):c}getMaxBounds(){return this.maxBounds}setMaxBounds(t){this.maxBounds=t,this.minLat=-Kr,this.maxLat=Kr,this.minLng=-180,this.maxLng=180,t&&(this.minLat=t.getSouth(),this.maxLat=t.getNorth(),this.minLng=t.getWest(),this.maxLng=t.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=xo(this.minLng)*this.tileSize,this.worldMaxX=xo(this.maxLng)*this.tileSize,this.worldMinY=Io(this.maxLat)*this.tileSize,this.worldMaxY=Io(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(t,o){return this.projection.createTileMatrix(this,o,t)}calculateDistanceTileData(t){const o=t.key,c=this._distanceTileDataCache;if(c[o])return c[o];const u=t.canonical,h=1/this.height,m=this.cameraWorldSize,g=m/this.zoomScale(u.z),v=(u.x+Math.pow(2,u.z)*t.wrap)*g,x=u.y*g,w=this.point;w.x*=m/this.worldSize,w.y*=m/this.worldSize;const E=this.angle,C=Math.sin(-E),I=-Math.cos(-E);return c[o]={bearing:[C,I],center:[(w.x-v)*h,(w.y-x)*h],scale:g/mt*h},c[o]}calculateFogTileMatrix(t){const o=t.key,c=this._fogTileMatrixCache;if(c[o])return c[o];const u=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,t);return at.multiply(u,this.worldToFogMatrix,u),c[o]=new Float32Array(u),c[o]}calculateProjMatrix(t,o=!1){const c=t.key,u=o?this._alignedProjMatrixCache:this._projMatrixCache;if(u[c])return u[c];const h=this.calculatePosMatrix(t,this.worldSize);return at.multiply(h,this.projection.isReprojectedInTileSpace?this.mercatorMatrix:o?this.alignedProjMatrix:this.projMatrix,h),u[c]=new Float32Array(h),u[c]}calculatePixelsToTileUnitsMatrix(t){const o=t.tileID.key,c=this._pixelsToTileUnitsCache;if(c[o])return c[o];const u=function(h,m){const{scale:g}=h.tileTransform,v=g*mt/(h.tileSize*Math.pow(2,m.zoom-h.tileID.overscaledZ+h.tileID.canonical.z));return uv.scale(new Float32Array(4),m.inverseAdjustmentMatrix,[v,v])}(t,this);return c[o]=u,c[o]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if(this.projection.name==="globe"){const t=1/this.worldSize,o=at.fromScaling([],[t,t,t]);return at.multiply(o,o,this.globeMatrix),o}}recenterOnTerrain(){if(!this._elevation||this.projection.name==="globe")return;const t=this._elevation;this._updateCameraState();const o=Xi(1,this._center.lat)*this.worldSize,c=this._computeCameraPosition(o),u=this._camera.forward(),h=Xi(1,this._center.lat);c[2]/=h,u[2]/=h,De.normalize(u,u);const m=t.raycast(c,u,t.exaggeration());if(m){const g=De.scaleAndAdd([],c,u,m),v=new bi(g[0],g[1],Xi(g[2],_a(g[1]))),x=(v.z+De.length([v.x-c[0],v.y-c[1],v.z-c[2]*h]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(x),this._centerAltitude=v.toAltitude(),this._center=this.coordinateLocation(v),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(t=!1){if(!this._elevation)return;const o=this._elevation,c=Xi(1,this._center.lat)*this.worldSize,u=this._computeCameraPosition(c),h=o.getAtPointOrZero(new bi(...u)),m=this.pixelsPerMeter/this.worldSize*h,g=this._minimumHeightOverTerrain(),v=u[2]-m;if(v<=g)if(v<0||t){const x=this.locationCoordinate(this._center,this._centerAltitude),w=[u[0],u[1],x.z-u[2]],E=De.length(w);w[2]-=(g-v)/this._pixelsPerMercatorPixel;const C=De.length(w);if(C===0)return;De.scale(w,w,E/C*this._pixelsPerMercatorPixel),this._camera.position=[u[0],u[1],x.z*this._pixelsPerMercatorPixel-w[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const t=this.projection.name==="globe"||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||t){const C=this.center;return C.lat=re(C.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!t)&&(C.lng=re(C.lng,this.minLng,this.maxLng)),this.center=C,void(this._constraining=!1)}const o=this._unmodified,{x:c,y:u}=this.point;let h=0,m=c,g=u;const v=this.width/2,x=this.height/2,w=this.worldMinY*this.scale,E=this.worldMaxY*this.scale;if(u-x<w&&(g=w+x),u+x>E&&(g=E-x),E-w<this.height&&(h=Math.max(h,this.height/(E-w)),g=(E+w)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const C=this.worldMinX*this.scale,I=this.worldMaxX*this.scale,D=this.worldSize/2-(C+I)/2;m=(c+D+this.worldSize)%this.worldSize-D,m-v<C&&(m=C+v),m+v>I&&(m=I-v),I-C<this.width&&(h=Math.max(h,this.width/(I-C)),m=(I+C)/2)}m===c&&g===u||(this.center=this.unproject(new G(m,g))),h&&(this.zoom+=this.scaleZoom(h)),this._constrainCamera(),this._unmodified=o,this._constraining=!1}_minZoomForBounds(){let t=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(t=Math.max(t,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),t}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const t=this.centerOffset,o=this.projection.name==="globe",c=this.pixelsPerMeter;this.projection.name==="globe"&&(this._mercatorScaleRatio=Xi(1,this.center.lat)/Xi(1,45));const u=z1(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,u),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const h=this.projection.zAxisUnit==="meters"?c:1,m=this._camera.getWorldToCamera(this.worldSize,h);let g;const v=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);if(v[8]=2*-t.x/this.width,v[9]=2*t.y/this.height,this.isOrthographic){let ge=.5*this.height/Math.tan(this._fov/2)*1*Math.tan(.5*this._fov),ve=ge*this.aspect,Pe=-ve,Me=-ge;ve-=t.x,Pe-=t.x,ge+=t.y,Me+=t.y,g=this._camera.getCameraToClipOrthographic(Pe,ve,Me,ge,this._nearZ,this._farZ),((Le,Ee,He,Ke)=>{for(let nt=0;nt<16;nt++)Le[nt]=a6(Ee[nt],He[nt],Ke)})(g,g,v,o6(this.pitch>=15?1:this.pitch/15))}else g=v;const x=at.mul([],v,m);let w=at.mul([],g,m);if(this.projection.isReprojectedInTileSpace){const ge=this.locationCoordinate(this.center),ve=at.identity([]);at.translate(ve,ve,[ge.x*this.worldSize,ge.y*this.worldSize,0]),at.multiply(ve,ve,$B(this)),at.translate(ve,ve,[-ge.x*this.worldSize,-ge.y*this.worldSize,0]),at.multiply(w,w,ve),at.multiply(x,x,ve),this.inverseAdjustmentMatrix=function(Pe){const Me=$B(Pe,!0);return uv.invert([],[Me[0],Me[1],Me[4],Me[5]])}(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];this.mercatorMatrix=at.scale([],w,[this.worldSize,this.worldSize,this.worldSize/h,1]),this.projMatrix=w,this.invProjMatrix=at.invert(new Float64Array(16),this.projMatrix);const E=at.invert([],g);this.frustumCorners=cP.fromInvProjectionMatrix(E,this.horizonLineFromTop(),this.height),this.cameraFrustum=ch.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,0,!o);const C=new Float32Array(16);at.identity(C),at.scale(C,C,[1,-1,1]),at.rotateX(C,C,this._pitch),at.rotateZ(C,C,this.angle);const I=at.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ);this.starsProjMatrix=at.clone(I);const D=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;I[8]=2*-t.x/this.width,I[9]=2*(t.y+D)/this.height,this.skyboxMatrix=at.multiply(C,I,C);const N=this.point,W=N.x,V=N.y,q=this.width%2/2,Z=this.height%2/2,K=Math.cos(this.angle),X=Math.sin(this.angle),J=W-Math.round(W)+K*q+X*Z,ae=V-Math.round(V)+K*Z+X*q,ce=new Float64Array(w);if(at.translate(ce,ce,[J>.5?J-1:J,ae>.5?ae-1:ae,0]),this.alignedProjMatrix=ce,w=at.create(),at.scale(w,w,[this.width/2,-this.height/2,1]),at.translate(w,w,[1,-1,0]),this.labelPlaneMatrix=w,w=at.create(),at.scale(w,w,[1,-1,1]),at.translate(w,w,[-1,-1,0]),at.scale(w,w,[2/this.width,2/this.height,1]),this.glCoordMatrix=w,this.pixelMatrix=at.multiply(new Float64Array(16),this.labelPlaneMatrix,x),this._calcFogMatrices(),this._distanceTileDataCache={},w=at.invert(new Float64Array(16),this.pixelMatrix),!w)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=w,this.projection.name==="globe"||this.mercatorFromTransition){this.globeMatrix=function(ve){const{x:Pe,y:Me}=ve.point,{lng:Le,lat:Ee}=ve._center;return mF(Pe,Me,ve.worldSize,Le,Ee)}(this);const ge=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=De.transformMat4(ge,ge,m),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=w;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const t=this.cameraWorldSizeForFog,o=this.cameraPixelsPerMeter,c=this._camera.position,u=1/this.height/this._pixelsPerMercatorPixel,h=[t,t,o];De.scale(h,h,u),De.scale(c,c,-1),De.multiply(c,c,h);const m=at.create();at.translate(m,m,c),at.scale(m,m,h),this.mercatorFogMatrix=m,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(t,o,u)}_computeCameraPosition(t){const o=(t=t||this.pixelsPerMeter)/this.pixelsPerMeter,c=this._camera.forward(),u=this.point,h=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*o-t/this.worldSize*this._centerAltitude;return[u.x/this.worldSize-c[0]*h,u.y/this.worldSize-c[1]*h,t/this.worldSize*this._centerAltitude-c[2]*h]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(t){const o=this._maxCameraBoundsDistance()*Math.cos(this._pitch),c=this._camera.position[2],u=t[2];let h=1;this.projection.wrap&&(this.center=this.center.wrap()),u>0&&(h=Math.min((o-c)/u,1)),this._camera.position=De.scaleAndAdd([],this._camera.position,t,h),this._updateStateFromCamera()}_updateStateFromCamera(){const t=this._camera.position,o=this._camera.forward(),{pitch:c,bearing:u}=this._camera.getPitchBearing(),h=Xi(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,m=this._mercatorZfromZoom(this._maxZoom)*Math.cos(ye(this._maxPitch)),g=Math.max((t[2]-h)/Math.cos(c),m),v=this._zoomFromMercatorZ(g);De.scaleAndAdd(t,t,o,g),this._pitch=re(c,ye(this.minPitch),ye(this.maxPitch)),this.angle=Je(u,-Math.PI,Math.PI),this._setZoom(re(v,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new bi(t[0],t[1],t[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(t){return Math.pow(2,t)*this.tileSize}_mercatorZfromZoom(t){return this.cameraToCenterDistance/this._worldSizeFromZoom(t)}_minimumHeightOverTerrain(){const t=Math.min((this._seaLevelZoom!=null?this._seaLevelZoom:this._zoom)+4,this._maxZoom);return this._mercatorZfromZoom(t)}_zoomFromMercatorZ(t){return this.scaleZoom(this.cameraToCenterDistance/(t*this.tileSize))}zoomFromMercatorZAdjusted(t){let o=0,c=Mf,u=0,h=1/0;for(;c-o>1e-6&&c>o;){const m=o+.5*(c-o),g=this.tileSize*Math.pow(2,m),v=this.getCameraToCenterDistance(this.projection,m,g),x=this.scaleZoom(v/(t*this.tileSize)),w=Math.abs(m-x);w<h&&(h=w,u=m),m<x?o=m:c=m}return u}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(xe("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(t,o){const c=Math.min(t.x,o.x),u=Math.max(t.x,o.x),h=Math.min(t.y,o.y),m=Math.max(t.y,o.y);if(h<this.horizonLineFromTop(!1))return!0;if(this.projection.name!=="mercator")return!1;const g=[new G(c,h),new G(u,m),new G(c,m),new G(u,h)],v=this.renderWorldCopies?-3:0,x=this.renderWorldCopies?4:1;for(const w of g){const E=this.pointRayIntersection(w);if(E.t<0)return!0;const C=this.rayIntersectionCoordinate(E);if(C.x<v||C.y<0||C.x>x||C.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+fe(this.fovAboveCenter)>88||this.anyCornerOffEdge(new G(0,0),new G(this.width,this.height))}zoomDeltaToMovement(t,o){const c=De.length(De.sub([],this._camera.position,t)),u=this._zoomFromMercatorZ(c)+o;return c-this._mercatorZfromZoom(u)}getCameraPoint(){if(this.projection.name==="globe"){const t=function([o,c,u],h){const m=[o,c,u,1];Yi.transformMat4(m,m,h);const g=m[3]=Math.max(m[3],1e-6);return m[0]/=g,m[1]/=g,m[2]/=g,m}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new G(t[0],t[1])}{const t=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new G(0,t))}}getCameraToCenterDistance(t,o=this.zoom,c=this.worldSize){const u=z1(t,o,this.width,this.height,1024),h=t.pixelSpaceConversion(this.center.lat,c,u);let m=.5/Math.tan(.5*this._fov)*this.height*h;return this.isOrthographic&&(m=a6(1,m,o6(this.pitch>=15?1:this.pitch/15))),m}getWorldToCameraMatrix(){const t=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?this.pixelsPerMeter:1);return this.projection.name==="globe"&&at.multiply(t,t,this.globeMatrix),t}getFrustum(t){return ch.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,t,this.projection.zAxisUnit==="meters")}}function s6(r,t,o){at.identity(r),at.rotateZ(r,r,ye(t[2])),at.rotateX(r,r,ye(t[0])),at.rotateY(r,r,ye(t[1])),at.scale(r,r,o),at.multiply(r,r,[1,0,0,0,0,0,1,0,0,1,0,0,0,0,0,1])}function I2(r,t,o,c,u,h,m,g){const v=[o[0]-t[0],o[1]-t[1],0],x=[c[0]-t[0],c[1]-t[1],0];if(De.length(v)<1e-12||De.length(x)<1e-12)return Po.identity(r);const w=De.cross([],v,x);De.normalize(w,w),De.subtract(x,c,t),v[2]=(h-u)*g,x[2]=(m-u)*g;const E=v;return De.cross(E,v,x),De.normalize(E,E),Po.rotationTo(r,w,E)}function l6(r,t,o=!1){const c=_o(t.zoom),u=function(h,m,g){const v=m.worldSize,x=[h[12],h[13],h[14]],w=_a(x[1]/v),E=ul(x[0]/v),C=at.identity([]),I=Xi(1,w)*v,D=Xi(1,0)*v*Af(w,m.zoom),N=1/mP(v);let W=D*N;if(g){const K=z1(m.projection,m.zoom,m.width,m.height,1024);W=N*m.projection.pixelSpaceConversion(m.center.lat,v,K)}const V=Us(w,E);De.add(V,V,De.scale([],De.normalize([],V),I*W*x[2]));const q=function(K){const X=[K[0],K[1],K[2]];let J=[0,1,0];const ae=De.cross([],J,X);return De.cross(J,X,ae),De.squaredLength(J)===0&&(J=[0,1,0],De.cross(ae,X,J)),De.normalize(ae,ae),De.normalize(J,J),De.normalize(X,X),[ae[0],ae[1],ae[2],0,J[0],J[1],J[2],0,X[0],X[1],X[2],0,K[0],K[1],K[2],1]}(V);at.scale(C,C,[W,W,W*I]),at.translate(C,C,[-x[0],-x[1],-x[2]]);const Z=at.multiply([],m.globeMatrix,q);return at.multiply(Z,Z,C),at.multiply(Z,Z,h),Z}(r,t,o);if(c>0){const h=function(m,g){const v=g.worldSize,x=Xi(1,0)*v*Af(g.center.lat,g.zoom)/mP(v),w=Xi(1,g.center.lat)*v,E=at.identity([]);return at.rotateY(E,E,ye(g.center.lng)),at.rotateX(E,E,ye(g.center.lat)),at.translate(E,E,[0,0,fs]),at.scale(E,E,[x,x,x*w]),at.translate(E,E,[g.point.x-.5*v,g.point.y-.5*v,0]),at.multiply(E,E,m),at.multiply(E,g.globeMatrix,E)}(r,t);return function(m,g,v){const x=(D,N,W)=>{const V=De.length(D),q=De.length(N),Z=uh(D,N,W);return De.scale(Z,Z,1/De.length(Z)*kn(V,q,W))},w=x([m[0],m[1],m[2]],[g[0],g[1],g[2]],v),E=x([m[4],m[5],m[6]],[g[4],g[5],g[6]],v),C=x([m[8],m[9],m[10]],[g[8],g[9],g[10]],v),I=uh([m[12],m[13],m[14]],[g[12],g[13],g[14]],v);return[w[0],w[1],w[2],0,E[0],E[1],E[2],0,C[0],C[1],C[2],0,I[0],I[1],I[2],1]}(u,h,c)}return u}const Dm=64,Pie=[1,1,1];class c6{constructor(t,o,c,u){this.id=t,this.position=o!=null?new Nn(o[0],o[1]):new Nn(0,0),this.orientation=c??[0,0,0],this.nodes=u,this.uploaded=!1,this.aabb=new _r([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),this.matrix=[]}_applyTransformations(t,o){if(at.multiply(t.matrix,o,t.matrix),t.meshes)for(const c of t.meshes){const u=_r.applyTransform(c.aabb,t.matrix);this.aabb.encapsulate(u)}if(t.children)for(const c of t.children)this._applyTransformations(c,t.matrix)}computeBoundsAndApplyParent(){const t=at.identity([]);for(const o of this.nodes)this._applyTransformations(o,t)}_positionModelOnTerrain(t,o){const c=t.elevation;if(!c)return 0;const u=_r.projectAabbCorners(this.aabb,this.matrix),h=Xi(1,this.position.lat)*t.worldSize,m=function(V,q){const Z=[0,0,1],K=[{corners:[0,1,3,2],dotProductWithUp:0},{corners:[1,5,2,6],dotProductWithUp:0},{corners:[0,4,1,5],dotProductWithUp:0},{corners:[2,6,3,7],dotProductWithUp:0},{corners:[4,7,5,6],dotProductWithUp:0},{corners:[0,3,4,7],dotProductWithUp:0}];for(const X of K){const J=V[X.corners[0]],ae=V[X.corners[1]],ce=V[X.corners[2]],ge=[ae[0]-J[0],ae[1]-J[1],q*(ae[2]-J[2])],ve=De.cross(ge,ge,[ce[0]-J[0],ce[1]-J[1],q*(ce[2]-J[2])]);De.normalize(ve,ve),X.dotProductWithUp=De.dot(ve,Z)}return K.sort((X,J)=>X.dotProductWithUp-J.dotProductWithUp),K[0].corners}(u,h),g=u[m[0]],v=u[m[1]],x=u[m[2]],w=u[m[3]],E=c.getAtPointOrZero(new bi(g[0]/t.worldSize,g[1]/t.worldSize),0),C=c.getAtPointOrZero(new bi(v[0]/t.worldSize,v[1]/t.worldSize),0),I=c.getAtPointOrZero(new bi(x[0]/t.worldSize,x[1]/t.worldSize),0),D=c.getAtPointOrZero(new bi(w[0]/t.worldSize,w[1]/t.worldSize),0),N=(E+D)/2,W=(C+I)/2;return N>W?C<I?I2(o,v,w,g,C,D,E,h):I2(o,x,g,w,I,E,D,h):E<D?I2(o,g,v,x,E,C,I,h):I2(o,w,x,v,D,I,C,h),Math.max(N,W)}computeModelMatrix(t,o,c,u,h,m,g=!1){const v=t.transform,x=v.zoom,w=v.project(this.position),E=Af(this.position.lat,x),C=1/E;at.identity(this.matrix),at.translate(this.matrix,this.matrix,[w.x+u[0]*C,w.y+u[1]*C,u[2]]);let I=1,D=1;const N=v.worldSize;if(g){if(v.projection.name==="mercator"){let Z=0;v.elevation&&(Z=v.elevation.getAtPointOrZero(new bi(w.x/N,w.y/N),0));const K=Yi.transformMat4([],[w.x,w.y,Z,1],v.projMatrix)[3]/v.cameraToCenterDistance;I=K,D=K*Af(v.center.lat,x)}else if(v.projection.name==="globe"){const Z=l6(this.matrix,v),K=at.multiply([],v.projMatrix,Z),X=[0,0,0,1];Yi.transformMat4(X,X,K);const J=X[3]/v.cameraToCenterDistance,ae=_o(x),ce=v.projection.pixelsPerMeter(this.position.lat,N)*Af(this.position.lat,x),ge=v.projection.pixelsPerMeter(v.center.lat,N)*Af(v.center.lat,x);I=J/kn(ce,wF(v.center.lat),ae),D=J*E/ce,I*=ge,D*=ge}}else I=C;at.scale(this.matrix,this.matrix,[I,I,D]);const W=[...this.matrix],V=this.orientation,q=[];if(s6(q,[V[0]+o[0],V[1]+o[1],V[2]+o[2]],c),at.multiply(this.matrix,W,q),h&&v.elevation){let Z=0;const K=[];if(m&&v.elevation){Z=this._positionModelOnTerrain(v,K);const X=at.fromQuat([],K),J=at.multiply([],X,q);at.multiply(this.matrix,W,J)}else Z=v.elevation.getAtPointOrZero(new bi(w.x/N,w.y/N),0);Z!==0&&(this.matrix[14]+=Z)}}upload(t){if(!this.uploaded){for(const o of this.nodes)aI(o,t);for(const o of this.nodes)R2(o);this.uploaded=!0}}destroy(){for(const t of this.nodes)L2(t)}}function O1(r,t,o=!1){r.uploaded||(r.gfxTexture=new xa(t,r.image,o?t.gl.R8:t.gl.RGBA,{useMipmap:r.sampler.minFilter>=t.gl.NEAREST_MIPMAP_NEAREST}),r.uploaded=!0,r.image=null)}function Iie(r,t,o){r.indexBuffer=t.createIndexBuffer(r.indexArray,!1,!0),r.vertexBuffer=t.createVertexBuffer(r.vertexArray,_ie.members,!1,!0),r.normalArray&&(r.normalBuffer=t.createVertexBuffer(r.normalArray,Sie.members,!1,!0)),r.texcoordArray&&(r.texcoordBuffer=t.createVertexBuffer(r.texcoordArray,wie.members,!1,!0)),r.colorArray&&(r.colorBuffer=t.createVertexBuffer(r.colorArray,(r.colorArray.bytesPerElement===12?xie:bie).members,!1,!0)),r.featureArray&&(r.pbrBuffer=t.createVertexBuffer(r.featureArray,Mie.members,!0)),r.segments=qi.simpleSegment(0,0,r.vertexArray.length,r.indexArray.length);const c=r.material;c.pbrMetallicRoughness.baseColorTexture&&O1(c.pbrMetallicRoughness.baseColorTexture,t),c.pbrMetallicRoughness.metallicRoughnessTexture&&O1(c.pbrMetallicRoughness.metallicRoughnessTexture,t),c.normalTexture&&O1(c.normalTexture,t),c.occlusionTexture&&O1(c.occlusionTexture,t,o),c.emissionTexture&&O1(c.emissionTexture,t)}function aI(r,t,o){if(r.meshes)for(const c of r.meshes)Iie(c,t,o);if(r.children)for(const c of r.children)aI(c,t,o)}function R2(r){if(r.meshes)for(const t of r.meshes)t.indexArray.destroy(),t.vertexArray.destroy(),t.colorArray&&t.colorArray.destroy(),t.normalArray&&t.normalArray.destroy(),t.texcoordArray&&t.texcoordArray.destroy(),t.featureArray&&t.featureArray.destroy();if(r.children)for(const t of r.children)R2(t)}function L2(r){if(r.meshes)for(const o of r.meshes)o.vertexBuffer&&(o.vertexBuffer.destroy(),o.indexBuffer.destroy(),o.normalBuffer&&o.normalBuffer.destroy(),o.texcoordBuffer&&o.texcoordBuffer.destroy(),o.colorBuffer&&o.colorBuffer.destroy(),o.pbrBuffer&&o.pbrBuffer.destroy(),o.segments.destroy(),o.material&&((t=o.material).pbrMetallicRoughness.baseColorTexture&&t.pbrMetallicRoughness.baseColorTexture.gfxTexture&&t.pbrMetallicRoughness.baseColorTexture.gfxTexture.destroy(),t.pbrMetallicRoughness.metallicRoughnessTexture&&t.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture&&t.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture.destroy(),t.normalTexture&&t.normalTexture.gfxTexture&&t.normalTexture.gfxTexture.destroy(),t.emissionTexture&&t.emissionTexture.gfxTexture&&t.emissionTexture.gfxTexture.destroy(),t.occlusionTexture&&t.occlusionTexture.gfxTexture&&t.occlusionTexture.gfxTexture.destroy()));var t;if(r.children)for(const o of r.children)L2(o)}class u6{constructor(t,o){this.feature=t,this.instancedDataOffset=o,this.instancedDataCount=0,this.rotation=[0,0,0],this.scale=[1,1,1],this.translation=[0,0,0]}}class d6{constructor(){this.instancedDataArray=new UC,this.instancesEvaluatedElevation=[],this.features=[],this.idToFeaturesIndex={}}}class h6{constructor(t){this.zoom=t.zoom,this.canonical=t.canonical,this.layers=t.layers,this.layerIds=this.layers.map(o=>o.fqid),this.projection=t.projection,this.index=t.index,this.hasZoomDependentProperties=this.layers[0].isZoomDependent(),this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id),this.hasPattern=!1,this.instancesPerModel={},this.validForExaggeration=0,this.maxVerticalOffset=0,this.maxScale=0,this.maxHeight=0,this.lookupDim=this.zoom>this.canonical.z?256:this.zoom>15?75:100,this.instanceCount=0,this.terrainElevationMin=0,this.terrainElevationMax=0,this.validForDEMTile={id:null,timestamp:0}}populate(t,o,c,u){this.tileToMeter=_1(c);const h=this.layers[0]._featureFilter.needGeometry;this.lookup=new Uint8Array(this.lookupDim*this.lookupDim);for(const{feature:m,id:g,index:v,sourceLayerIndex:x}of t){const w=Cf(m,h);if(!this.layers[0]._featureFilter.filter(new dr(this.zoom),w,c))continue;const E={id:g,sourceLayerIndex:x,index:v,geometry:h?w.geometry:Zu(m,c,u),properties:m.properties,type:m.type,patterns:{}},C=this.addFeature(E,E.geometry,w);C&&o.featureIndex.insert(m,E.geometry,v,x,this.index,this.instancesPerModel[C].instancedDataArray.length)}this.lookup=null}update(t,o,c,u){for(const h in this.instancesPerModel){const m=this.instancesPerModel[h];for(const g in t)m.idToFeaturesIndex.hasOwnProperty(g)&&this.evaluate(m.features[m.idToFeaturesIndex[g]],t[g],m,!0)}this.maxHeight=0}updateZoomBasedPaintProperties(){if(!this.hasZoomDependentProperties)return!1;let t=!1;for(const o in this.instancesPerModel){const c=this.instancesPerModel[o];for(const u of c.features){const h=this.layers[0],m=u.feature,g=this.canonical,v=h.paint.get("model-rotation").evaluate(m,{},g),x=h.paint.get("model-scale").evaluate(m,{},g),w=h.paint.get("model-translation").evaluate(m,{},g);De.exactEquals(u.rotation,v)&&De.exactEquals(u.scale,x)&&De.exactEquals(u.translation,w)||(this.evaluate(u,u.featureStates,c,!0),t=!0)}}return t}isEmpty(){for(const t in this.instancesPerModel)if(this.instancesPerModel[t].instancedDataArray.length!==0)return!1;return!0}uploadPending(){return!this.uploaded}upload(t){if(!this.uploaded)for(const o in this.instancesPerModel){const c=this.instancesPerModel[o];c.instancedDataArray.length<0||c.instancedDataArray.length===0||(c.instancedDataBuffer?c.instancedDataBuffer.updateData(c.instancedDataArray):c.instancedDataBuffer=t.createVertexBuffer(c.instancedDataArray,Eie.members,!0,void 0,this.instanceCount))}this.uploaded=!0}destroy(){for(const t in this.instancesPerModel){const o=this.instancesPerModel[t];o.instancedDataArray.length!==0&&o.instancedDataBuffer&&o.instancedDataBuffer.destroy()}}addFeature(t,o,c){const u=this.layers[0],h=u.layout.get("model-id").evaluate(c,{},this.canonical);if(!h)return xe(`modelId is not evaluated for layer ${u.id} and it is not going to get rendered.`),h;this.instancesPerModel[h]||(this.instancesPerModel[h]=new d6);const m=this.instancesPerModel[h],g=m.instancedDataArray,v=new u6(c,g.length);for(const x of o)for(const w of x){if(w.x<0||w.x>=mt||w.y<0||w.y>=mt)continue;const E=(this.lookupDim-1)/mt,C=this.lookupDim*(w.y*E|0)+w.x*E|0;if(this.lookup){if(this.lookup[C]!==0)continue;this.lookup[C]=1}this.instanceCount++;const I=g.length;g.resize(I+1),m.instancesEvaluatedElevation.push(0),g.float32[16*I]=w.x,g.float32[16*I+1]=w.y}return v.instancedDataCount=m.instancedDataArray.length-v.instancedDataOffset,v.instancedDataCount>0&&(t.id&&(m.idToFeaturesIndex[t.id]=m.features.length),m.features.push(v),this.evaluate(v,{},m,!1)),h}evaluate(t,o,c,u){const h=this.layers[0],m=t.feature,g=this.canonical,v=t.rotation=h.paint.get("model-rotation").evaluate(m,o,g),x=t.scale=h.paint.get("model-scale").evaluate(m,o,g),w=t.translation=h.paint.get("model-translation").evaluate(m,o,g),E=h.paint.get("model-color").evaluate(m,o,g);E.a=h.paint.get("model-color-mix-intensity").evaluate(m,o,g);const C=[];this.maxVerticalOffset<w[2]&&(this.maxVerticalOffset=w[2]),this.maxScale=Math.max(Math.max(this.maxScale,x[0]),Math.max(x[1],x[2])),s6(C,v,x);const I=Math.round(100*E.a)+E.b/1.05;for(let D=0;D<t.instancedDataCount;++D){const N=t.instancedDataOffset+D,W=16*N,V=c.instancedDataArray.float32;let q=0;u&&(q=V[W+6]-c.instancesEvaluatedElevation[N]);const Z=0|V[W+1];V[W]=(0|V[W])+E.r/1.05,V[W+1]=Z+E.g/1.05,V[W+2]=I,V[W+3]=1/(g.z>10?this.tileToMeter:_1(g,Z)),V[W+4]=w[0],V[W+5]=w[1],V[W+6]=w[2]+q,V[W+7]=C[0],V[W+8]=C[1],V[W+9]=C[2],V[W+10]=C[4],V[W+11]=C[5],V[W+12]=C[6],V[W+13]=C[8],V[W+14]=C[9],V[W+15]=C[10],c.instancesEvaluatedElevation[N]=w[2]}}}dn(h6,"ModelBucket",{omit:["layers"]}),dn(d6,"PerModelAttributes"),dn(u6,"ModelFeature");const Rie=new Er({visibility:new Zt(rt.layout_model.visibility),"model-id":new xn(rt.layout_model["model-id"])});var Lie={paint:new Er({"model-opacity":new Zt(rt.paint_model["model-opacity"]),"model-rotation":new xn(rt.paint_model["model-rotation"]),"model-scale":new xn(rt.paint_model["model-scale"]),"model-translation":new xn(rt.paint_model["model-translation"]),"model-color":new xn(rt.paint_model["model-color"]),"model-color-mix-intensity":new xn(rt.paint_model["model-color-mix-intensity"]),"model-type":new Zt(rt.paint_model["model-type"]),"model-cast-shadows":new Zt(rt.paint_model["model-cast-shadows"]),"model-receive-shadows":new Zt(rt.paint_model["model-receive-shadows"]),"model-ambient-occlusion-intensity":new Zt(rt.paint_model["model-ambient-occlusion-intensity"]),"model-emissive-strength":new xn(rt.paint_model["model-emissive-strength"]),"model-roughness":new xn(rt.paint_model["model-roughness"]),"model-height-based-emissive-strength-multiplier":new xn(rt.paint_model["model-height-based-emissive-strength-multiplier"]),"model-cutoff-fade-range":new Zt(rt.paint_model["model-cutoff-fade-range"])}),layout:Rie};const oI=new Float32Array(262144),zm=new Uint8Array(262144);function f6(r){let t=0;if(r.meshes)for(const o of r.meshes)t=Math.max(t,o.aabb.max[2]);if(r.children)for(const o of r.children)t=Math.max(t,f6(o));return t}const p6=["","wall","door","roof","window","lamp","logo"];class m6{constructor(t){this.node=t,this.evaluatedRMEA=[[1,0,0,1],[1,0,0,1],[1,0,0,1],[1,0,0,1],[.4,1,0,1],[1,0,0,1],[1,0,0,1]],this.hiddenByReplacement=!1,this.evaluatedScale=[1,1,1],this.evaluatedColor=[],this.emissionHeightBasedParams=[],this.feature={type:"Point",id:t.id,geometry:[],properties:{height:f6(t)}}}}class g6{constructor(t,o,c,u){this.nodes=t,this.id=o,this.modelTraits|=1,this.uploaded=!1,this.hasPattern=!1,c&&(this.modelTraits|=4),this.zoom=-1,this.terrainExaggeration=1,this.projection={name:"mercator"},this.replacementUpdateTime=0,this.elevationReadFromZ=255,this.brightness=u,this.dirty=!0,this.needsUpload=!1}update(){console.log("Update 3D model bucket")}populate(){console.log("populate 3D model bucket")}uploadPending(){return!this.uploaded||this.needsUpload}upload(t){if(!this.needsUpload)return;const o=this.getNodesInfo();for(const c of o){const u=c.node;this.uploaded?this.updatePbrBuffer(u):aI(u,t,!0)}for(const c of o)R2(c.node);this.uploaded=!0,this.needsUpload=!1}updatePbrBuffer(t){let o=!1;if(!t.meshes)return o;for(const c of t.meshes)c.pbrBuffer&&(c.pbrBuffer.updateData(c.featureArray),o=!0);return o}needsReEvaluation(t,o,c){const u=t.transform.projectionOptions,h=t.style.getBrightness(),m=this.brightness!==h;return!!(!this.uploaded||this.dirty||u.name!==this.projection.name||N1(c.paint.get("model-color").value,m)||N1(c.paint.get("model-color-mix-intensity").value,m)||N1(c.paint.get("model-roughness").value,m)||N1(c.paint.get("model-emissive-strength").value,m)||N1(c.paint.get("model-height-based-emissive-strength-multiplier").value,m))&&(this.projection=u,this.brightness=h,!0)}evaluateScale(t,o){if(t.transform.zoom===this.zoom)return;this.zoom=t.transform.zoom;const c=this.getNodesInfo(),u=this.id.canonical;for(const h of c){const m=h.feature;h.evaluatedScale=o.paint.get("model-scale").evaluate(m,{},u)}}evaluate(t){const o=this.getNodesInfo();for(const c of o){if(!c.node.meshes)continue;const u=c.feature,h=c.node.meshes&&c.node.meshes[0].featureData,m=c.evaluatedColor[2],g=c.evaluatedRMEA[2],v=this.id.canonical;if(c.hasTranslucentParts=!1,h){for(let x=0;x<p6.length;x++){const w=p6[x];w.length&&(u.properties.part=w);const E=t.paint.get("model-color").evaluate(u,{},v),C=t.paint.get("model-color-mix-intensity").evaluate(u,{},v);c.evaluatedColor[x]=[E.r,E.g,E.b,C],c.evaluatedRMEA[x][0]=t.paint.get("model-roughness").evaluate(u,{},v),c.evaluatedRMEA[x][2]=t.paint.get("model-emissive-strength").evaluate(u,{},v),c.evaluatedRMEA[x][3]=E.a,c.emissionHeightBasedParams[x]=t.paint.get("model-height-based-emissive-strength-multiplier").evaluate(u,{},v),!c.hasTranslucentParts&&E.a<1&&(c.hasTranslucentParts=!0)}delete u.properties.part,Die(c,m!==c.evaluatedColor[2]||g!==c.evaluatedRMEA[2])}c.evaluatedScale=t.paint.get("model-scale").evaluate(u,{},v),this.updatePbrBuffer(c.node)||(this.needsUpload=!0)}this.dirty=!1}elevationUpdate(t,o,c,u){const h=t.findDEMTileFor(c);if(h&&(h.tileID.canonical!==this.terrainTile||o!==this.terrainExaggeration)){if(h.dem&&h.tileID.overscaledZ!==this.elevationReadFromZ){this.elevationReadFromZ=h.tileID.overscaledZ;const m=xv.create(t,c,h);if(!m)return;4&this.modelTraits&&this.updateDEM(t,m,c,u);for(const g of this.getNodesInfo()){const v=g.node;if(!v.footprint||!v.footprint.vertices||!v.footprint.vertices.length)continue;const x=v.footprint.vertices;let w=m.getElevationAt(x[0].x,x[0].y,!0,!0);for(let E=1;E<x.length;E++)w=Math.min(w,m.getElevationAt(x[E].x,x[E].y,!0,!0));v.elevation=w}}this.terrainTile=h.tileID.canonical,this.terrainExaggeration=o}}updateDEM(t,o,c,u){let h=o._dem._modifiedForSources[u];if(h===void 0&&(o._dem._modifiedForSources[u]=[],h=o._dem._modifiedForSources[u]),h.includes(c.canonical))return;const m=o._dem.dim;h.push(c.canonical);let g=!1;for(const v of this.getNodesInfo()){const x=v.node;if(!x.footprint||!x.footprint.grid)continue;const w=x.footprint.grid,E=o.tileCoordToPixel(w.min.x,w.min.y),C=o.tileCoordToPixel(w.max.x,w.max.y),I=Math.min(Math.min(m-C.y,E.x),Math.min(E.y,m-C.x));if(I<0)continue;const D=re(I,2,5);let N=Math.max(0,E.x-D),W=Math.max(0,E.y-D),V=Math.min(C.x+D,m-1),q=Math.min(C.y+D,m-1);for(let J=W;J<=q;++J)for(let ae=N;ae<=V;++ae)zm[J*m+ae]=255;let Z=0,K=0;for(let J=0;J<w.cellsY;++J)for(let ae=0;ae<w.cellsX;++ae){if(!w.cells[J*w.cellsX+ae])continue;const ce=o.tileCoordToPixel(w.min.x+ae/w.xScale,w.min.y+J/w.yScale),ge=o.tileCoordToPixel(w.min.x+(ae+1)/w.xScale,w.min.y+(J+1)/w.yScale);for(let ve=ce.y;ve<=Math.min(ge.y+1,m-1);++ve)for(let Pe=ce.x;Pe<=Math.min(ge.x+1,m-1);++Pe)zm[ve*m+Pe]===255&&(zm[ve*m+Pe]=0,Z+=o.getElevationAtPixel(Pe,ve),K++)}const X=Z/K;N=Math.max(1,E.x-D),W=Math.max(1,E.y-D),V=Math.min(C.x+D,m-2),q=Math.min(C.y+D,m-2),g=!0;for(let J=W;J<=q;++J)for(let ae=N;ae<=V;++ae)zm[J*m+ae]===0&&(oI[J*m+ae]=o._dem.set(ae,J,X));for(let J=1;J<D;++J){N=Math.max(1,E.x-J),W=Math.max(1,E.y-J),V=Math.min(C.x+J,m-2),q=Math.min(C.y+J,m-2);for(let ae=W;ae<=q;++ae)for(let ce=N;ce<=V;++ce){const ge=ae*m+ce;if(zm[ge]===255){let ve=0,Pe=0,Me=-1,Le=-1;for(let Ee=-1;Ee<=1;++Ee)for(let He=-1;He<=1;++He){const Ke=(ae+Ee)*m+ce+He;if(zm[Ke]>=J)continue;const nt=oI[Ke],Ve=Math.abs(nt);Ve>Pe&&(ve=nt,Pe=Ve,Me=He,Le=Ee)}if(Pe>.1){const Ee=1-(J+.5*Math.abs(Me*Le))/D;let He=o._dem.get(ce,ae)+ve*Ee;const Ke=o._dem.get(ce+Me,ae+Le),nt=o._dem.get(ce-Me,ae-Le,!0);(He-Ke)*(He-nt)>0&&(He=(Ke+nt)/2),oI[ge]=o._dem.set(ce,ae,He),zm[ge]=J}}}}}g&&(o._demTile.needsDEMTextureUpload=!0,o._dem._timestamp=Pn.now())}getNodesInfo(){if(!this.nodesInfo){this.nodesInfo=[];for(const t of this.nodes)this.nodesInfo.push(new m6(t));this.freeNodes()}return this.nodesInfo}freeNodes(){if(this.nodes){for(const t of this.nodes)L2(t);this.nodes.splice(0,this.nodes.length)}}destroy(){this.freeNodes();const t=this.getNodesInfo();for(const o of t)R2(o.node),L2(o.node)}isEmpty(){return!this.nodes.length}updateReplacement(t,o){if(o.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=o.updateTime;const c=o.getReplacementRegionsForTile(t.toUnwrapped()),u=this.getNodesInfo();for(let h=0;h<this.nodesInfo.length;h++){const m=u[h].node;u[h].hiddenByReplacement=!!m.footprint&&!c.find(g=>g.footprint===m.footprint)}}getHeightAtTileCoord(t,o){const c=this.getNodesInfo(),u=[];for(let h=0;h<this.nodesInfo.length;h++){const m=c[h],g=m.node.meshes[0];if(t<g.aabb.min[0]||o<g.aabb.min[1]||t>g.aabb.max[0]||o>g.aabb.max[1])continue;const v=(t-g.aabb.min[0])/(g.aabb.max[0]-g.aabb.min[0])*Dm|0,x=Math.min(63,(o-g.aabb.min[1])/(g.aabb.max[1]-g.aabb.min[1])*Dm|0)*Dm+Math.min(63,v);if(!(g.heightmap[x]<0&&m.node.footprint))return m.hiddenByReplacement?void 0:{height:g.heightmap[x],maxHeight:m.feature.properties.height,hidden:!1,verticalScale:m.evaluatedScale[2]};if(m.node.footprint.grid.query(new G(t,o),new G(t,o),u),u.length>0)return{height:void 0,maxHeight:m.feature.properties.height,hidden:m.hiddenByReplacement,verticalScale:m.evaluatedScale[2]}}}}function N1(r,t){return!r.isLightConstant&&t}function kie(r,t,o,c,u,h,m,g){let v=(61440&t|(61440&t)>>4)>>8,x=(3840&t|(3840&t)>>4)>>4,w=240&t|(240&t)>>4;o[3]>0&&(v=kn(v,255*o[0],o[3]),x=kn(x,255*o[1],o[3]),w=kn(w,255*o[2],o[3]));const E=v<<8|x,C=w<<8|Math.floor(255*c[3]),I=function(J){const ae=re(J,0,2);return Math.min(Math.round(.5*ae*255),255)}(c[2])<<8|15*c[0]<<4|15*c[1],D=re(u[0],0,1),N=re(u[1],0,1),W=re(u[2],0,1),V=re(u[3],0,1);let q,Z,K,X;if(D!==N&&m!==h&&N!==D){const J=m-h;Z=1/(J*(N-D)),K=-(h+J*D)/(J*(N-D));const ae=re(u[4],-1,1);X=Math.pow(10,ae),q=255*W<<8|255*V}else q=65535,Z=0,K=1,X=1;if(r.emplaceBack(E,C,I,q,Z,K,X),g){const J=g.length;g.clear();for(let ae=0;ae<J;ae++)g.emplaceBack(E,C,I,q,Z,K,X)}}function Die(r,t){const o=r.node;let c=0;for(const u of o.meshes){if(o.lights&&o.lightMeshIndex===c||!u.featureData)continue;u.featureArray=new kS,u.featureArray.reserve(u.featureData.length);let h=t;for(const m of u.featureData){let g;const v=65535&m,x=(15&v)<8?15&v:0,w=m>>16&65535,E=r.evaluatedRMEA[x],C=r.evaluatedColor[x],I=r.emissionHeightBasedParams[x];if(h&&x===2&&o.lights&&(g=new kS,g.resize(10*o.lights.length)),kie(u.featureArray,w,C,E,I,u.aabb.min[2],u.aabb.max[2],g),g&&h){h=!1;const D=o.meshes[o.lightMeshIndex];D.featureArray=g,D.featureArray._trim()}}u.featureArray._trim(),c++}}dn(g6,"Tiled3dModelBucket",{omit:["layers"]}),dn(m6,"Tiled3dModelFeature");class zie{constructor(){this._updateTime=0,this._sourceIds=[],this._activeRegions=[],this._prevRegions=[]}clear(){this._activeRegions.length>0&&++this._updateTime,this._activeRegions=[],this._prevRegions=[]}get updateTime(){return this._updateTime}getReplacementRegionsForTile(t){const o=_6(new G(0,0),new G(mt,mt),t),c=[];for(const u of this._activeRegions){if(u.hiddenByOverlap||!v6(o,u))continue;const h=Oie(u.min,u.max,t);c.push({min:h.min,max:h.max,sourceId:this._sourceIds[u.priority],footprint:u.footprint,footprintTileId:u.tileId})}return c}setSources(t){this._setSources(t.map(o=>({getSourceId:()=>o.cache.id,getFootprints:()=>{const c=[];for(const u of o.cache.getVisibleCoordinates()){const h=o.cache.getTile(u).buckets[o.layer];if(h)for(const m of h.getNodesInfo()){const g=m.node;g.footprint&&c.push({footprint:g.footprint,id:u.toUnwrapped()})}}return c}})))}_addSource(t){const o=t.getFootprints();if(o.length!==0){for(const c of o){if(!c.footprint)continue;const u=_6(c.footprint.min,c.footprint.max,c.id);this._activeRegions.push({min:u.min,max:u.max,hiddenByOverlap:!1,priority:this._sourceIds.length,tileId:c.id,footprint:c.footprint})}this._sourceIds.push(t.getSourceId())}}_computeReplacement(){this._activeRegions.sort((o,c)=>o.priority-c.priority||k2(o.min,c.min)||k2(o.max,c.max));let t=this._activeRegions.length!==this._prevRegions.length;if(!t){let o=0,c=0;for(;!t&&o!==this._activeRegions.length;){const u=this._activeRegions[o],h=this._prevRegions[c];t=u.priority!==h.priority||!y6(u,h),++o,++c}}if(t){++this._updateTime;const o=c=>{const u=this._activeRegions;if(c>=u.length)return c;const h=u[c].priority;for(;c<u.length&&u[c].priority===h;)++c;return c};if(this._sourceIds.length>1){let c=0,u=o(c);for(;c!==u;){let h=c;const m=c;for(;h!==u;){const g=this._activeRegions[h];g.hiddenByOverlap=!1;for(let v=0;v<m;v++){const x=this._activeRegions[v];if(!x.hiddenByOverlap&&v6(g,x)&&(g.hiddenByOverlap=b6(g.footprint,g.tileId,x.footprint,x.tileId),g.hiddenByOverlap))break}++h}c=u,u=o(c)}}}}_setSources(t){[this._prevRegions,this._activeRegions]=[this._activeRegions,[]],this._sourceIds=[];for(let o=t.length-1;o>=0;o--)this._addSource(t[o]);this._computeReplacement()}}function k2(r,t){return r.x-t.x||r.y-t.y}function y6(r,t){return k2(r.min,t.min)===0&&k2(r.max,t.max)===0}function v6(r,t){return!(r.min.x>t.max.x||r.max.x<t.min.x||r.min.y>t.max.y||r.max.y<t.min.y)}function _6(r,t,o){const c=1/mt,u=1/(1<<o.canonical.z),h=(t.x*c+o.canonical.x)*u+o.wrap,m=(t.y*c+o.canonical.y)*u;return{min:new G((r.x*c+o.canonical.x)*u+o.wrap,(r.y*c+o.canonical.y)*u),max:new G(h,m)}}function Oie(r,t,o){const c=1<<o.canonical.z,u=((t.x-o.wrap)*c-o.canonical.x)*mt,h=(t.y*c-o.canonical.y)*mt;return{min:new G(((r.x-o.wrap)*c-o.canonical.x)*mt,(r.y*c-o.canonical.y)*mt),max:new G(u,h)}}function x6(r,t,o,c,u,h,m){const g=r.indices,v=r.vertices,x=[];for(let w=c;w<c+u;w+=3){const E=t[o[w+0]+h],C=t[o[w+1]+h],I=t[o[w+2]+h],D=Math.min(E.x,C.x,I.x),N=Math.max(E.x,C.x,I.x),W=Math.min(E.y,C.y,I.y),V=Math.max(E.y,C.y,I.y);x.length=0,r.grid.query(new G(D,W),new G(N,V),x);for(let q=0;q<x.length;q++){const Z=x[q];if(EP(v[g[3*Z+0]],v[g[3*Z+1]],v[g[3*Z+2]],E,C,I,m))return!0}}return!1}function b6(r,t,o,c){if(!r||!o)return!1;let u=r.vertices;if(!t.canonical.equals(c.canonical)||t.wrap!==c.wrap){if(o.vertices.length<r.vertices.length)return b6(o,c,r,t);const h=t.canonical,m=c.canonical,g=Math.pow(2,m.z-h.z);u=r.vertices.map(v=>new G(v.x*h.x*mt*g-m.x*mt,v.y*h.y*mt*g-m.y*mt))}return x6(o,u,r.indices,0,r.indices.length,0,0)}const Nie=i2.types,Fie=["fill-extrusion-base","fill-extrusion-height","fill-extrusion-color","fill-extrusion-pattern","fill-extrusion-flood-light-wall-radius"],Bie=["fill-extrusion-flood-light-ground-radius"],Uie=Math.pow(2,13),Wie=Math.pow(2,15)-1,w6=new G(0,1),ed=2147483648;function F1(r,t,o,c,u,h,m,g){r.emplaceBack((t<<1)+m,(o<<1)+h,(Math.floor(c*Uie)<<1)+u,Math.round(g))}function D2(r,t,o,c,u,h){r.emplaceBack(t.x,t.y,(o.x<<1)+c,(o.y<<1)+u,h)}function B1(r,t,o){r.emplaceBack(t.x,t.y,t.z,o[0]*16384,o[1]*16384,o[2]*16384)}class S6{constructor(){this.vertexOffset=0,this.vertexCount=0,this.indexOffset=0,this.indexCount=0}}class E6{constructor(){this.centroidXY=new G(0,0),this.vertexArrayOffset=0,this.vertexCount=0,this.groundVertexArrayOffset=0,this.groundVertexCount=0,this.flags=0,this.footprintSegIdx=-1,this.footprintSegLen=0,this.min=new G(Number.MAX_VALUE,Number.MAX_VALUE),this.max=new G(-Number.MAX_VALUE,-Number.MAX_VALUE),this.height=0}span(){return new G(this.max.x-this.min.x,this.max.y-this.min.y)}}class M6{constructor(){this.acc=new G(0,0),this.accCount=0,this.centroidDataIndex=0}startRing(t,o){t.min.x===Number.MAX_VALUE&&(t.min.x=t.max.x=o.x,t.min.y=t.max.y=o.y)}appendEdge(t,o,c){this.accCount++,this.acc._add(o);let u=!!this.borders;o.x<t.min.x?(t.min.x=o.x,u=!0):o.x>t.max.x&&(t.max.x=o.x,u=!0),o.y<t.min.y?(t.min.y=o.y,u=!0):o.y>t.max.y&&(t.max.y=o.y,u=!0),((o.x===0||o.x===mt)&&o.x===c.x)!=((o.y===0||o.y===mt)&&o.y===c.y)&&this.processBorderOverlap(o,c),u&&this.checkBorderIntersection(o,c)}checkBorderIntersection(t,o){o.x<0!=t.x<0&&this.addBorderIntersection(0,kn(o.y,t.y,(0-o.x)/(t.x-o.x))),o.x>mt!=t.x>mt&&this.addBorderIntersection(1,kn(o.y,t.y,(mt-o.x)/(t.x-o.x))),o.y<0!=t.y<0&&this.addBorderIntersection(2,kn(o.x,t.x,(0-o.y)/(t.y-o.y))),o.y>mt!=t.y>mt&&this.addBorderIntersection(3,kn(o.x,t.x,(mt-o.y)/(t.y-o.y)))}addBorderIntersection(t,o){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const c=this.borders[t];o<c[0]&&(c[0]=o),o>c[1]&&(c[1]=o)}processBorderOverlap(t,o){if(t.x===o.x){if(t.y===o.y)return;const c=t.x===0?0:1;this.addBorderIntersection(c,o.y),this.addBorderIntersection(c,t.y)}else{const c=t.y===0?2:3;this.addBorderIntersection(c,o.x),this.addBorderIntersection(c,t.x)}}centroid(){return this.accCount===0?new G(0,0):new G(Math.floor(Math.max(0,this.acc.x)/this.accCount),Math.floor(Math.max(0,this.acc.y)/this.accCount))}intersectsCount(){return this.borders?this.borders.reduce((t,o)=>t+ +(o[0]!==Number.MAX_VALUE),0):0}}function T6(r,t){const o=r.add(t)._unit(),c=re(r.x*o.x+r.y*o.y,-1,1);var u,h,m;return u=Math.acos(c),Math.min(4,Math.max(-4,Math.tan(u)))/4*Wie*((h=r).x*(m=t).y-h.y*m.x<0?-1:1)}const Vie=[r=>r.x<0,r=>r.x>mt,r=>r.y<0,r=>r.y>mt];function Gie(r,t,o,c){const u=[4];if(c===0)return u;o._mult(c);const h=r.sub(o),m=t.sub(o),g=[r,t,h,m];for(let v=0;v<4;v++)for(const x of g)if(Vie[v](x)){u.push(v);break}return u}class A6{constructor(t){this.vertexArray=new bt,this.indexArray=new Un,this.programConfigurations=new wf(t.layers,t.zoom,o=>Bie.includes(o)),this._segments=new qi,this.hiddenByLandmarkVertexArray=new WC,this._segmentToGroundQuads={},this._segmentToGroundQuads[0]=[],this._segmentToRegionTriCounts={},this._segmentToRegionTriCounts[0]=[0,0,0,0,0],this.regionSegments={},this.regionSegments[4]=new qi}getDefaultSegment(){return this.regionSegments[4]}hasData(){return this.vertexArray.length!==0}addData(t,o,c){const u=t.length;if(u>2){let h=Math.max(0,this._segments.get().length-1);const m=this._segments._prepareSegment(4*u,this.vertexArray.length,2*this._segmentToGroundQuads[h].length);let g;h!==this._segments.get().length-1&&(h++,this._segmentToGroundQuads[h]=[],this._segmentToRegionTriCounts[h]=[0,0,0,0,0]);{const v=t[0],x=t[1];g=T6(v.sub(t[u-1])._perp()._unit(),x.sub(v)._perp()._unit())}for(let v=0;v<u;v++){const x=v===u-1?0:v+1,w=t[v],E=t[x],C=t[x===u-1?0:x+1],I=E.sub(w)._perp()._unit(),D=T6(I,C.sub(E)._perp()._unit()),N=g,W=D;if(sI(w,E,o)||I6(w,o)&&I6(E,o)){g=D;continue}const V=m.vertexLength;D2(this.vertexArray,w,E,1,1,N),D2(this.vertexArray,w,E,1,0,N),D2(this.vertexArray,w,E,0,1,W),D2(this.vertexArray,w,E,0,0,W),m.vertexLength+=4;const q=Gie(w,E,I,c);for(const Z of q)this._segmentToGroundQuads[h].push({id:V,region:Z}),this._segmentToRegionTriCounts[h][Z]+=2,m.primitiveLength+=2;g=D}}}prepareBorderSegments(){if(!this.hasData())return;const t=this._segments.get(),o=t.length;for(let c=0;c<o;c++)this._segmentToGroundQuads[c].sort((u,h)=>u.region-h.region);for(let c=0;c<o;c++){const u=this._segmentToGroundQuads[c],h=t[c],m=this._segmentToRegionTriCounts[c];m.reduce((v,x)=>v+x,0);let g=0;for(let v=0;v<=4;v++){const x=m[v];if(x!==0){let w=this.regionSegments[v];w||(w=this.regionSegments[v]=new qi);const E={vertexOffset:h.vertexOffset,primitiveOffset:h.primitiveOffset+g,vertexLength:h.vertexLength,primitiveLength:x};w.get().push(E)}g+=x}for(let v=0;v<u.length;v++){const x=u[v].id;this.indexArray.emplaceBack(x,x+1,x+3),this.indexArray.emplaceBack(x,x+3,x+2)}}this._segmentToGroundQuads=null,this._segmentToRegionTriCounts=null,this._segments.destroy(),this._segments=null}addPaintPropertiesData(t,o,c,u,h,m){this.hasData()&&this.programConfigurations.populatePaintArrays(this.vertexArray.length,t,o,c,u,h,m)}upload(t){this.hasData()&&(this.vertexBuffer=t.createVertexBuffer(this.vertexArray,yte.members),this.indexBuffer=t.createIndexBuffer(this.indexArray))}uploadPaintProperties(t){this.hasData()&&this.programConfigurations.upload(t)}update(t,o,c,u,h,m){this.hasData()&&this.programConfigurations.updatePaintArrays(t,o,c,u,h,m)}updateHiddenByLandmark(t){if(!this.hasData())return;const o=t.groundVertexCount+t.groundVertexArrayOffset;if(t.groundVertexCount===0)return;const c=t.flags&ed?1:0;for(let u=t.groundVertexArrayOffset;u<o;++u)this.hiddenByLandmarkVertexArray.emplace(u,c);this._needsHiddenByLandmarkUpdate=!0}uploadHiddenByLandmark(t){this.hasData()&&this._needsHiddenByLandmarkUpdate&&(!this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexArray.length>0?this.hiddenByLandmarkVertexBuffer=t.createVertexBuffer(this.hiddenByLandmarkVertexArray,_te.members,!0):this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.updateData(this.hiddenByLandmarkVertexArray),this._needsHiddenByLandmarkUpdate=!1)}destroy(){if(this.vertexBuffer){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.destroy(),this._segments&&this._segments.destroy(),this.programConfigurations.destroy();for(let t=0;t<=4;t++){const o=this.regionSegments[t];o&&o.destroy()}}}}class U1{constructor(t){this.zoom=t.zoom,this.canonical=t.canonical,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(o=>o.fqid),this.index=t.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=t.projection,this.activeReplacements=[],this.replacementUpdateTime=0,this.centroidData=[],this.footprintIndices=new Un,this.footprintVertices=new ee,this.footprintSegments=[],this.layoutVertexArray=new qe,this.centroidVertexArray=new NO,this.indexArray=new Un,this.programConfigurations=new wf(t.layers,t.zoom,o=>Fie.includes(o)),this.segments=new qi,this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id),this.groundEffect=new A6(t),this.maxHeight=0,this.partLookup={}}populate(t,o,c,u){this.features=[],this.hasPattern=RP("fill-extrusion",this.layers,o),this.featuresOnBorder=[],this.borderFeatureIndices=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=_1(c),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter;for(const{feature:h,id:m,index:g,sourceLayerIndex:v}of t){const x=this.layers[0]._featureFilter.needGeometry,w=Cf(h,x);if(!this.layers[0]._featureFilter.filter(new dr(this.zoom),w,c))continue;const E={id:m,sourceLayerIndex:v,index:g,geometry:x?w.geometry:Zu(h,c,u),properties:h.properties,type:h.type,patterns:{}},C=this.layoutVertexArray.length;this.hasPattern?this.features.push(LP("fill-extrusion",this.layers,E,this.zoom,o)):this.addFeature(E,E.geometry,g,c,{},o.availableImages,u,o.brightness),o.featureIndex.insert(h,E.geometry,g,v,this.index,C)}this.sortBorders(),this.groundEffect.prepareBorderSegments()}addFeatures(t,o,c,u,h,m){for(const g of this.features){const{geometry:v}=g;this.addFeature(g,v,g.index,o,c,u,h,m)}this.sortBorders()}update(t,o,c,u,h){const m=Object.keys(t).length!==0;if(m&&!this.stateDependentLayers.length)return;const g=m?this.stateDependentLayers:this.layers;this.programConfigurations.updatePaintArrays(t,o,g,c,u,h),this.groundEffect.update(t,o,g,c,u,h)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload||this.groundEffect.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,bte),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=t.createVertexBuffer(this.layoutVertexExtArray,xte.members,!0)),this.groundEffect.upload(t)),this.groundEffect.uploadPaintProperties(t),this.programConfigurations.upload(t),this.uploaded=!0}uploadCentroid(t){this.groundEffect.uploadHiddenByLandmark(t),this.needsCentroidUpdate&&(!this.centroidVertexBuffer&&this.centroidVertexArray.length>0?this.centroidVertexBuffer=t.createVertexBuffer(this.centroidVertexArray,vte.members,!0):this.centroidVertexBuffer&&this.centroidVertexBuffer.updateData(this.centroidVertexArray),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.groundEffect.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(t,o,c,u,h,m,g,v){const x=this.layers[0].paint.get("fill-extrusion-flood-light-ground-radius").evaluate(t,{})/this.tileToMeter,w=[new G(0,0),new G(mt,mt)],E=g.projection,C=E.name==="globe",I=Nie[t.type]==="Polygon",D=new M6;D.centroidDataIndex=this.centroidData.length;const N=new E6,W=this.layers[0].paint.get("fill-extrusion-base").evaluate(t,{},u)<=0,V=this.layers[0].paint.get("fill-extrusion-height").evaluate(t,{},u);N.height=V,N.vertexArrayOffset=this.layoutVertexArray.length,N.groundVertexArrayOffset=this.groundEffect.vertexArray.length,C&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new ii);const q=IP(o,500);for(let ce=q.length-1;ce>=0;ce--){const ge=q[ce];(ge.length===0||(Z=ge[0]).every(ve=>ve.x<=0)||Z.every(ve=>ve.x>=mt)||Z.every(ve=>ve.y<=0)||Z.every(ve=>ve.y>=mt))&&q.splice(ce,1)}var Z;let K;if(C)K=D6(q,w,u);else{K=[];for(const ce of q)K.push({polygon:ce,bounds:w})}const X=I?this.edgeRadius:0,J=X>0&&this.zoom<17,ae=(ce,ge)=>{if(ce.length===0)return!1;const ve=ce[ce.length-1];return ge.x===ve.x&&ge.y===ve.y};for(const{polygon:ce,bounds:ge}of K){let ve=0,Pe=0;for(const Ee of ce)I&&!Ee[0].equals(Ee[Ee.length-1])&&Ee.push(Ee[0]),Pe+=I?Ee.length-1:Ee.length;const Me=this.segments.prepareSegment((I?5:4)*Pe,this.layoutVertexArray,this.indexArray);N.footprintSegIdx<0&&(N.footprintSegIdx=this.footprintSegments.length);const Le=new S6;if(Le.vertexOffset=this.footprintVertices.length,Le.indexOffset=3*this.footprintIndices.length,Le.ringIndices=[],I){const Ee=[],He=[];ve=Me.vertexLength;for(let nt=0;nt<ce.length;nt++){const Ve=ce[nt];Ve.length&&nt!==0&&He.push(Ee.length/2);const je=[];let ot,yt;ot=Ve[1].sub(Ve[0])._perp()._unit(),Le.ringIndices.push(Ve.length-1);for(let ft=1;ft<Ve.length;ft++){const Lt=Ve[ft],Ft=Ve[ft===Ve.length-1?1:ft+1],St=Lt.clone();if(X){yt=Ft.sub(Lt)._perp()._unit();const Ct=ot.add(yt)._unit(),rn=X*Math.min(4,1/(ot.x*Ct.x+ot.y*Ct.y));St.x+=rn*Ct.x,St.y+=rn*Ct.y,St.x=Math.round(St.x),St.y=Math.round(St.y),ot=yt}!W||X!==0&&!J||ae(je,St)||je.push(St),F1(this.layoutVertexArray,St.x,St.y,0,0,1,1,0),Me.vertexLength++,this.footprintVertices.emplaceBack(Lt.x,Lt.y),Ee.push(Lt.x,Lt.y),C&&B1(this.layoutVertexExtArray,E.projectTilePoint(St.x,St.y,u),E.upVector(u,St.x,St.y))}W&&(X===0||J)&&(je.length!==0&&ae(je,je[0])&&je.pop(),this.groundEffect.addData(je,ge,x))}const Ke=e2(Ee,He);for(let nt=0;nt<Ke.length;nt+=3)this.footprintIndices.emplaceBack(Le.vertexOffset+Ke[nt+0],Le.vertexOffset+Ke[nt+1],Le.vertexOffset+Ke[nt+2]),this.indexArray.emplaceBack(ve+Ke[nt],ve+Ke[nt+2],ve+Ke[nt+1]),Me.primitiveLength++;Le.indexCount+=Ke.length,Le.vertexCount+=this.footprintVertices.length-Le.vertexOffset}for(let Ee=0;Ee<ce.length;Ee++){const He=ce[Ee];D.startRing(N,He[0]);let Ke=He.length>4&&R6(He[He.length-2],He[0],He[1]),nt=X?Hie(He[He.length-2],He[0],He[1],X):0;const Ve=[];let je,ot,yt;ot=He[1].sub(He[0])._perp()._unit();let ft=!0;for(let Lt=1,Ft=0;Lt<He.length;Lt++){let St=He[Lt-1],Ct=He[Lt];const rn=He[Lt===He.length-1?1:Lt+1];if(D.appendEdge(N,Ct,St),sI(Ct,St,ge)){X&&(ot=rn.sub(Ct)._perp()._unit(),ft=!ft);continue}const ln=Ct.sub(St)._perp(),sn=ln.x/(Math.abs(ln.x)+Math.abs(ln.y)),un=ln.y>0?1:0,vn=St.dist(Ct);if(Ft+vn>32768&&(Ft=0),X){yt=rn.sub(Ct)._perp()._unit();let Xn=P6(St,Ct,rn,C6(ot,yt),X);isNaN(Xn)&&(Xn=0);const Gn=Ct.sub(St)._unit();St=St.add(Gn.mult(nt))._round(),Ct=Ct.add(Gn.mult(-Xn))._round(),nt=Xn,ot=yt,W&&this.zoom>=17&&(ae(Ve,St)||Ve.push(St),ae(Ve,Ct)||Ve.push(Ct))}const zn=Me.vertexLength,ai=He.length>4&&R6(St,Ct,rn);let Ai=L6(Ft,Ke,ft);if(F1(this.layoutVertexArray,St.x,St.y,sn,un,0,0,Ai),F1(this.layoutVertexArray,St.x,St.y,sn,un,0,1,Ai),Ft+=vn,Ai=L6(Ft,ai,!ft),Ke=ai,F1(this.layoutVertexArray,Ct.x,Ct.y,sn,un,0,0,Ai),F1(this.layoutVertexArray,Ct.x,Ct.y,sn,un,0,1,Ai),Me.vertexLength+=4,this.indexArray.emplaceBack(zn+0,zn+1,zn+2),this.indexArray.emplaceBack(zn+1,zn+3,zn+2),Me.primitiveLength+=2,X){const Xn=ve+(Lt===1?He.length-2:Lt-2),Gn=Lt===1?ve:Xn+1;if(this.indexArray.emplaceBack(zn+1,Xn,zn+3),this.indexArray.emplaceBack(Xn,Gn,zn+3),Me.primitiveLength+=2,je===void 0&&(je=zn),!sI(rn,He[Lt],ge)){const Ln=Lt===He.length-1?je:Me.vertexLength;this.indexArray.emplaceBack(zn+2,zn+3,Ln),this.indexArray.emplaceBack(zn+3,Ln+1,Ln),this.indexArray.emplaceBack(zn+3,Gn,Ln+1),Me.primitiveLength+=3}ft=!ft}if(C){const Xn=this.layoutVertexExtArray,Gn=E.projectTilePoint(St.x,St.y,u),Ln=E.projectTilePoint(Ct.x,Ct.y,u),An=E.upVector(u,St.x,St.y),vi=E.upVector(u,Ct.x,Ct.y);B1(Xn,Gn,An),B1(Xn,Gn,An),B1(Xn,Ln,vi),B1(Xn,Ln,vi)}}I&&(ve+=He.length-1),W&&X&&this.zoom>=17&&(Ve.length!==0&&ae(Ve,Ve[0])&&Ve.pop(),this.groundEffect.addData(Ve,ge,x))}this.footprintSegments.push(Le),++N.footprintSegLen}if(N.vertexCount=this.layoutVertexArray.length-N.vertexArrayOffset,N.groundVertexCount=this.groundEffect.vertexArray.length-N.groundVertexArrayOffset,N.vertexCount!==0){if(N.centroidXY=D.borders?w6:this.encodeCentroid(D,N),this.centroidData.push(N),D.borders){this.featuresOnBorder.push(D);const ce=this.featuresOnBorder.length-1;for(let ge=0;ge<D.borders.length;ge++)D.borders[ge][0]!==Number.MAX_VALUE&&this.borderFeatureIndices[ge].push(ce)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,c,h,m,u,v),this.groundEffect.addPaintPropertiesData(t,c,h,m,u,v),this.maxHeight=Math.max(this.maxHeight,V)}}sortBorders(){for(let t=0;t<this.borderFeatureIndices.length;t++)this.borderFeatureIndices[t].sort((o,c)=>this.featuresOnBorder[o].borders[t][0]-this.featuresOnBorder[c].borders[t][0])}encodeCentroid(t,o){const c=t.centroid(),u=o.span(),h=Math.min(7,Math.round(u.x*this.tileToMeter/10)),m=Math.min(7,Math.round(u.y*this.tileToMeter/10));return new G(re(c.x,1,mt-1)<<3|h,re(c.y,1,mt-1)<<3|m)}showCentroid(t){const o=this.centroidData[t.centroidDataIndex];o.flags&=ed,o.centroidXY.x=0,o.centroidXY.y=0,this.writeCentroidToBuffer(o)}writeCentroidToBuffer(t){this.groundEffect.updateHiddenByLandmark(t);const o=t.vertexArrayOffset,c=t.vertexCount+t.vertexArrayOffset,u=t.flags&ed?w6:t.centroidXY,h=this.centroidVertexArray.geta_centroid_pos0(o);if(this.centroidVertexArray.geta_centroid_pos1(o)!==u.y||h!==u.x){for(let m=o;m<c;++m)this.centroidVertexArray.emplace(m,u.x,u.y);this.needsCentroidUpdate=!0}}createCentroidsBuffer(){this.centroidVertexArray.resize(this.layoutVertexArray.length),this.groundEffect.hiddenByLandmarkVertexArray.resize(this.groundEffect.vertexArray.length);for(const t of this.centroidData)this.writeCentroidToBuffer(t)}updateReplacement(t,o){if(o.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=o.updateTime;const c=o.getReplacementRegionsForTile(t.toUnwrapped());if(function(h,m){if(h.length!==m.length)return!1;for(let g=0;g<h.length;g++)if(h[g].sourceId!==m[g].sourceId||!y6(h[g],m[g]))return!1;return!0}(this.activeReplacements,c))return;if(this.activeReplacements=c,this.centroidVertexArray.length===0)this.createCentroidsBuffer();else for(const h of this.centroidData)h.flags&=2147483647;const u=[];for(const h of this.activeReplacements){const m=Math.pow(2,h.footprintTileId.canonical.z-t.canonical.z);for(const g of this.centroidData)if(!(g.flags&ed||h.min.x>g.max.x||g.min.x>h.max.x||h.min.y>g.max.y||g.min.y>h.max.y))for(let v=0;v<g.footprintSegLen;v++){const x=this.footprintSegments[g.footprintSegIdx+v];if(u.length=0,jie(this.footprintVertices,x.vertexOffset,x.vertexCount,h.footprintTileId.canonical,t.canonical,u),x6(h.footprint,u,this.footprintIndices.uint16,x.indexOffset,x.indexCount,-x.vertexOffset,-m)){g.flags|=ed;break}}}for(const h of this.centroidData)this.writeCentroidToBuffer(h);this.borderDoneWithNeighborZ=[-1,-1,-1,-1]}footprintContainsPoint(t,o,c){let u=!1;for(let h=0;h<c.footprintSegLen;h++){const m=this.footprintSegments[c.footprintSegIdx+h];let g=0;for(const v of m.ringIndices){for(let x=g,w=v+g-1;x<v+g;w=x++){const E=this.footprintVertices.int16[2*(x+m.vertexOffset)+0],C=this.footprintVertices.int16[2*(x+m.vertexOffset)+1],I=this.footprintVertices.int16[2*(w+m.vertexOffset)+1];C>o!=I>o&&t<(this.footprintVertices.int16[2*(w+m.vertexOffset)+0]-E)*(o-C)/(I-C)+E&&(u=!u)}g=v}}return u}getHeightAtTileCoord(t,o){let c=Number.NEGATIVE_INFINITY,u=!0;const h=4*(t+mt)*mt+(o+mt);if(this.partLookup.hasOwnProperty(h)){const m=this.partLookup[h];return m?{height:m.height,hidden:!!(m.flags&ed)}:void 0}for(const m of this.centroidData)t>m.max.x||m.min.x>t||o>m.max.y||m.min.y>o||this.footprintContainsPoint(t,o,m)&&m&&m.height>c&&(c=m.height,this.partLookup[h]=m,u=!!(m.flags&ed));if(c!==Number.NEGATIVE_INFINITY)return{height:c,hidden:u};this.partLookup[h]=void 0}}function C6(r,t){const o=r.add(t)._unit();return r.x*o.x+r.y*o.y}function Hie(r,t,o,c){const u=t.sub(r)._perp()._unit(),h=o.sub(t)._perp()._unit();return P6(r,t,o,C6(u,h),c)}function P6(r,t,o,c,u){const h=Math.sqrt(1-c*c);return Math.min(r.dist(t)/3,t.dist(o)/3,u*h/c)}function sI(r,t,o){return r.x<o[0].x&&t.x<o[0].x||r.x>o[1].x&&t.x>o[1].x||r.y<o[0].y&&t.y<o[0].y||r.y>o[1].y&&t.y>o[1].y}function I6(r,t){return r.x<t[0].x||r.x>t[1].x||r.y<t[0].y||r.y>t[1].y}function R6(r,t,o){if(r.x<0||r.x>=mt||t.x<0||t.x>=mt||o.x<0||o.x>=mt)return!1;const c=o.sub(t),u=c.perp(),h=r.sub(t);return(c.x*h.x+c.y*h.y)/Math.sqrt((c.x*c.x+c.y*c.y)*(h.x*h.x+h.y*h.y))>-.866&&u.x*h.x+u.y*h.y<0}function L6(r,t,o){const c=t?2|r:-3&r;return o?1|c:-2&c}function k6(){const r=Math.PI/32,t=Math.tan(r),o=fv;return o*Math.sqrt(1+2*t*t)-o}function D6(r,t,o){const c=1<<o.z,u=ul(o.x/c),h=ul((o.x+1)/c),m=_a(o.y/c),g=_a((o.y+1)/c);return function(v,x,w,E,C=0,I){const D=[];if(!v.length||!w||!E)return D;const N=(J,ae)=>{for(const ce of J)D.push({polygon:ce,bounds:ae})},W=Math.ceil(Math.log2(w)),V=Math.ceil(Math.log2(E)),q=W-V,Z=[];for(let J=0;J<Math.abs(q);J++)Z.push(q>0?0:1);for(let J=0;J<Math.min(W,V);J++)Z.push(0),Z.push(1);let K=v;if(K=r2(K,x[0].y-C,x[1].y+C,1),K=r2(K,x[0].x-C,x[1].x+C,0),!K.length)return D;const X=[];for(Z.length?X.push({polygons:K,bounds:x,depth:0}):N(K,x);X.length;){const J=X.pop(),ae=J.depth,ce=Z[ae],ge=J.bounds[0],ve=J.bounds[1],Pe=ce===0?ge.x:ge.y,Me=ce===0?ve.x:ve.y,Le=I?I(ce,Pe,Me):.5*(Pe+Me),Ee=r2(J.polygons,Pe-C,Le+C,ce),He=r2(J.polygons,Le-C,Me+C,ce);if(Ee.length){const Ke=[ge,new G(ce===0?Le:ve.x,ce===1?Le:ve.y)];Z.length>ae+1?X.push({polygons:Ee,bounds:Ke,depth:ae+1}):N(Ee,Ke)}if(He.length){const Ke=[new G(ce===0?Le:ge.x,ce===1?Le:ge.y),ve];Z.length>ae+1?X.push({polygons:He,bounds:Ke,depth:ae+1}):N(He,Ke)}}return D}(r,t,Math.ceil((h-u)/11.25),Math.ceil((m-g)/11.25),1,(v,x,w)=>{if(v===0)return .5*(x+w);{const E=_a((o.y+x/mt)/c);return(Io(.5*(_a((o.y+w/mt)/c)+E))*c-o.y)*mt}})}function jie(r,t,o,c,u,h){const m=Math.pow(2,c.z-u.z);for(let g=0;g<o;g++){let v=r.int16[2*(g+t)+0],x=r.int16[2*(g+t)+1];v=(v+u.x*mt)*m-c.x*mt,x=(x+u.y*mt)*m-c.y*mt,h.push(new G(v,x))}}dn(U1,"FillExtrusionBucket",{omit:["layers","features"]}),dn(E6,"PartData"),dn(S6,"FootprintSegment"),dn(M6,"BorderCentroidData"),dn(A6,"GroundEffect");const $ie=new Er({visibility:new Zt(rt["layout_fill-extrusion"].visibility),"fill-extrusion-edge-radius":new Zt(rt["layout_fill-extrusion"]["fill-extrusion-edge-radius"])});var Yie={paint:new Er({"fill-extrusion-opacity":new Zt(rt["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new xn(rt["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Zt(rt["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Zt(rt["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new xn(rt["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new xn(rt["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new xn(rt["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Zt(rt["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new Zt(rt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new Zt(rt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-ambient-occlusion-wall-radius":new Zt(rt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-wall-radius"]),"fill-extrusion-ambient-occlusion-ground-radius":new Zt(rt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-radius"]),"fill-extrusion-ambient-occlusion-ground-attenuation":new Zt(rt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-attenuation"]),"fill-extrusion-flood-light-color":new Zt(rt["paint_fill-extrusion"]["fill-extrusion-flood-light-color"]),"fill-extrusion-flood-light-intensity":new Zt(rt["paint_fill-extrusion"]["fill-extrusion-flood-light-intensity"]),"fill-extrusion-flood-light-wall-radius":new xn(rt["paint_fill-extrusion"]["fill-extrusion-flood-light-wall-radius"]),"fill-extrusion-flood-light-ground-radius":new xn(rt["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-radius"]),"fill-extrusion-flood-light-ground-attenuation":new Zt(rt["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-attenuation"]),"fill-extrusion-vertical-scale":new Zt(rt["paint_fill-extrusion"]["fill-extrusion-vertical-scale"]),"fill-extrusion-rounded-roof":new Zt(rt["paint_fill-extrusion"]["fill-extrusion-rounded-roof"]),"fill-extrusion-cutoff-fade-range":new Zt(rt["paint_fill-extrusion"]["fill-extrusion-cutoff-fade-range"])}),layout:$ie};class Pv extends G{constructor(t,o,c){super(t,o),this.z=c}}function W1(r,t){return r.x*t.x+r.y*t.y}function z6(r,t){if(r.length===1){let o=0;const c=t[o++];let u;for(;!u||c.equals(u);)if(u=t[o++],!u)return 1/0;for(;o<t.length;o++){const h=t[o],m=r[0],g=u.sub(c),v=h.sub(c),x=m.sub(c),w=W1(g,g),E=W1(g,v),C=W1(v,v),I=W1(x,g),D=W1(x,v),N=w*C-E*E,W=(C*I-E*D)/N,V=(w*D-E*I)/N,q=c.z*(1-W-V)+u.z*W+h.z*V;if(isFinite(q))return q}return 1/0}{let o=1/0;for(const c of t)o=Math.min(o,c.z);return o}}function O6(r,t,o,c,u,h,m,g){const v=m*u.getElevationAt(r,t,!0,!0),x=h[0]!==0,w=x?h[1]===0?m*(h[0]/7-450):m*function(E,C,I){const D=Math.floor(C[0]/8),N=Math.floor(C[1]/8),W=10*(C[0]-8*D),V=10*(C[1]-8*N),q=E.getElevationAt(D,N,!0,!0),Z=E.getMeterToDEM(I),K=Math.floor(.5*(W*Z-1)),X=Math.floor(.5*(V*Z-1)),J=E.tileCoordToPixel(D,N),ae=2*K+1,ce=2*X+1,ge=function(He,Ke,nt,Ve,je){return[He.getElevationAtPixel(Ke,nt,!0),He.getElevationAtPixel(Ke+je,nt,!0),He.getElevationAtPixel(Ke,nt+je,!0),He.getElevationAtPixel(Ke+Ve,nt+je,!0)]}(E,J.x-K,J.y-X,ae,ce),ve=Math.abs(ge[0]-ge[1]),Pe=Math.abs(ge[2]-ge[3]),Me=Math.abs(ge[0]-ge[2])+Math.abs(ge[1]-ge[3]),Le=Math.min(.25,.5*Z*(ve+Pe)/ae),Ee=Math.min(.25,.5*Z*Me/ce);return q+Math.max(Le*W,Ee*V)}(u,h,g):v;return{base:v+(o===0)?-1:o,top:x?Math.max(w+c,v+o+2):v+c}}const qie=new Er({"line-cap":new xn(rt.layout_line["line-cap"]),"line-join":new xn(rt.layout_line["line-join"]),"line-miter-limit":new Zt(rt.layout_line["line-miter-limit"]),"line-round-limit":new Zt(rt.layout_line["line-round-limit"]),"line-sort-key":new xn(rt.layout_line["line-sort-key"]),visibility:new Zt(rt.layout_line.visibility)});var N6={paint:new Er({"line-opacity":new xn(rt.paint_line["line-opacity"]),"line-color":new xn(rt.paint_line["line-color"]),"line-translate":new Zt(rt.paint_line["line-translate"]),"line-translate-anchor":new Zt(rt.paint_line["line-translate-anchor"]),"line-width":new xn(rt.paint_line["line-width"]),"line-gap-width":new xn(rt.paint_line["line-gap-width"]),"line-offset":new xn(rt.paint_line["line-offset"]),"line-blur":new xn(rt.paint_line["line-blur"]),"line-dasharray":new xn(rt.paint_line["line-dasharray"]),"line-pattern":new xn(rt.paint_line["line-pattern"]),"line-gradient":new Mm(rt.paint_line["line-gradient"]),"line-trim-offset":new Zt(rt.paint_line["line-trim-offset"]),"line-emissive-strength":new Zt(rt.paint_line["line-emissive-strength"]),"line-border-width":new xn(rt.paint_line["line-border-width"]),"line-border-color":new xn(rt.paint_line["line-border-color"])}),layout:qie};const Xie=(r,t,o,c,u,h,m)=>{const g=r.transform,v=g.calculatePixelsToTileUnitsMatrix(t);return{u_matrix:B6(r,t,o,c),u_pixels_to_tile_units:v,u_device_pixel_ratio:h,u_units_to_pixels:[1/g.pixelsToGLUnits[0],1/g.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:u,u_texsize:W6(o)?t.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:F6(t,r.transform),u_alpha_discard_threshold:0,u_trim_offset:m,u_emissive_strength:o.paint.get("line-emissive-strength")}},Zie=(r,t,o,c,u)=>{const h=r.transform;return{u_matrix:B6(r,t,o,c),u_texsize:t.imageAtlasTexture.size,u_pixels_to_tile_units:h.calculatePixelsToTileUnitsMatrix(t),u_device_pixel_ratio:u,u_image:0,u_tile_units_to_pixels:F6(t,h),u_units_to_pixels:[1/h.pixelsToGLUnits[0],1/h.pixelsToGLUnits[1]],u_alpha_discard_threshold:0}};function F6(r,t){return 1/km(r,1,t.tileZoom)}function B6(r,t,o,c){return r.translatePosMatrix(c||t.tileID.projMatrix,t,o.paint.get("line-translate"),o.paint.get("line-translate-anchor"))}const U6=r=>{const t=[];W6(r)&&t.push("RENDER_LINE_DASH"),r.paint.get("line-gradient")&&t.push("RENDER_LINE_GRADIENT");const o=r.paint.get("line-trim-offset");return o[0]===0&&o[1]===0||t.push("RENDER_LINE_TRIM_OFFSET"),r.paint.get("line-border-width").constantOr(1)!==0&&t.push("RENDER_LINE_BORDER"),t};function W6(r){const t=r.paint.get("line-dasharray").value;return t.value||t.kind!=="constant"}const V6=new class extends xn{possiblyEvaluate(r,t){return t=new dr(Math.floor(t.zoom),{now:t.now,fadeDuration:t.fadeDuration,transition:t.transition}),super.possiblyEvaluate(r,t)}evaluate(r,t,o,c){return t=Fe({},t,{zoom:Math.floor(t.zoom)}),super.evaluate(r,t,o,c)}}(N6.paint.properties["line-width"].specification);function G6(r,t){return t>0?t+2*r:r}V6.useIntegerZoom=!0;const Kie=new Er({visibility:new Zt(rt.layout_background.visibility)});var Jie={paint:new Er({"background-color":new Zt(rt.paint_background["background-color"]),"background-pattern":new Zt(rt.paint_background["background-pattern"]),"background-opacity":new Zt(rt.paint_background["background-opacity"]),"background-emissive-strength":new Zt(rt.paint_background["background-emissive-strength"])}),layout:Kie};const Qie=new Er({visibility:new Zt(rt.layout_raster.visibility)});var ere={paint:new Er({"raster-opacity":new Zt(rt.paint_raster["raster-opacity"]),"raster-color":new Mm(rt.paint_raster["raster-color"]),"raster-color-mix":new Zt(rt.paint_raster["raster-color-mix"]),"raster-color-range":new Zt(rt.paint_raster["raster-color-range"]),"raster-hue-rotate":new Zt(rt.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Zt(rt.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Zt(rt.paint_raster["raster-brightness-max"]),"raster-saturation":new Zt(rt.paint_raster["raster-saturation"]),"raster-contrast":new Zt(rt.paint_raster["raster-contrast"]),"raster-resampling":new Zt(rt.paint_raster["raster-resampling"]),"raster-fade-duration":new Zt(rt.paint_raster["raster-fade-duration"])}),layout:Qie};function H6(r,t,o,c,u,h,m,g){const v=[r,o,u,t,c,h,1,1,1],x=[m,g,1],w=Bs.adjoint([],v),[E,C,I]=De.transformMat3(x,x,Bs.transpose(w,w));return Bs.multiply(v,[E,0,0,0,C,0,0,0,I],v)}class td extends Vn{constructor(t,o,c,u){super(),this.id=t,this.dispatcher=c,this.coordinates=o.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.onNorthPole=!1,this.onSouthPole=!1,this.setEventedParent(u),this.options=o,this._dirty=!1}load(t,o){if(this._loaded=o||!1,this.fire(new $t("dataloading",{dataType:"source"})),this.url=this.options.url,!this.url)return t&&(this.coordinates=t),this._loaded=!0,void this._finishLoading();this._imageRequest=Qt(this.map._requestManager.transformRequest(this.url,Se.Image),(c,u)=>{if(this._imageRequest=null,this._loaded=!0,c)this.fire(new bn(c));else if(u){const{HTMLImageElement:h}=p;this.image=u instanceof h?Pn.getImageData(u):u,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,t&&(this.coordinates=t),this._finishLoading()}})}loaded(){return this._loaded}updateImage(t){return this.image&&t.url?(this._imageRequest&&t.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=t.url,this.load(t.coordinates,this._loaded),this):this}setTexture(t){if(!(t.handle instanceof WebGLTexture))throw new Error("The provided handle is not a WebGLTexture instance");return this.texture=new E2(this.map.painter.context,t.handle),this.width=t.dimensions[0],this.height=t.dimensions[1],this._dirty=!1,this._loaded=!0,this._finishLoading(),this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new $t("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(t){this.map=t,this.load()}onRemove(){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),!this.texture||this.texture instanceof E2||this.texture.destroy()}setCoordinates(t){if(this.coordinates=t,this._boundsArray=void 0,!t.length)return this;this.onNorthPole=!1,this.onSouthPole=!1;let o=t[0][1],c=t[0][1];for(const h of t)h[1]>c&&(c=h[1]),h[1]<o&&(o=h[1]);const u=(c+o)/2;if(u>Kr?this.onNorthPole=!0:u<-Kr&&(this.onSouthPole=!0),!this.onNorthPole&&!this.onSouthPole){const h=t.map(bi.fromLngLat);this.tileID=function(m){let g=1/0,v=1/0,x=-1/0,w=-1/0;for(const D of m)g=Math.min(g,D.x),v=Math.min(v,D.y),x=Math.max(x,D.x),w=Math.max(w,D.y);const E=Math.max(x-g,w-v),C=Math.max(0,Math.floor(-Math.log(E)/Math.LN2)),I=Math.pow(2,C);return new Xu(C,Math.floor((g+x)/2*I),Math.floor((v+w)/2*I))}(h),this.minzoom=this.maxzoom=this.tileID.z}return this.fire(new $t("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0}_prepareData(t){for(const v in this.tiles){const x=this.tiles[v];x.state!=="loaded"&&(x.state="loaded",x.texture=this.texture)}if(this._boundsArray)return;const o=Lm(this.tileID,this.map.transform.projection),[c,u,h,m]=this.coordinates.map(v=>{const x=o.projection.project(v[0],v[1]);return LB(o,x)._round()});this.perspectiveTransform=function(v,x,w,E,C,I,D,N,W,V){const q=H6(0,0,v,0,0,x,v,x),Z=H6(w,E,C,I,D,N,W,V);return Bs.multiply(Z,Bs.adjoint(q,q),Z),[Z[6]/Z[8]*v/mt,Z[7]/Z[8]*x/mt]}(this.width,this.height,c.x,c.y,u.x,u.y,m.x,m.y,h.x,h.y);const g=this._boundsArray=new qe;g.emplaceBack(c.x,c.y,0,0),g.emplaceBack(u.x,u.y,mt,0),g.emplaceBack(m.x,m.y,0,mt),g.emplaceBack(h.x,h.y,mt,mt),this.boundsBuffer&&this.boundsBuffer.destroy(),this.boundsBuffer=t.createVertexBuffer(g,ZP.members),this.boundsSegments=qi.simpleSegment(0,0,4,2)}prepare(){const t=Object.keys(this.tiles).length!==0;if(this.tileID&&!t)return;const o=this.map.painter.context,c=o.gl;!this._dirty||this.texture instanceof E2||(this.texture?this.texture.update(this.image):(this.texture=new xa(o,this.image,c.RGBA),this.texture.bind(c.LINEAR,c.CLAMP_TO_EDGE)),this._dirty=!1),t&&this._prepareData(o)}loadTile(t,o){this.tileID&&this.tileID.equals(t.tileID.canonical)?(this.tiles[String(t.tileID.wrap)]=t,t.buckets={},o(null)):(t.state="errored",o(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}class tre extends Jo{constructor(t){super(t,{}),this.implementation=t,t.slot&&(this.slot=t.slot)}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}isLayerDraped(t){return this.implementation.renderToTile!==void 0}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(t){this.implementation.onAdd&&this.implementation.onAdd(t,t.painter.context.gl)}onRemove(t){this.implementation.onRemove&&this.implementation.onRemove(t,t.painter.context.gl)}}const nre=new Er({visibility:new Zt(rt.layout_sky.visibility)});var ire={paint:new Er({"sky-type":new Zt(rt.paint_sky["sky-type"]),"sky-atmosphere-sun":new Zt(rt.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new Zt(rt.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new Zt(rt.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new Zt(rt.paint_sky["sky-gradient-radius"]),"sky-gradient":new Mm(rt.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new Zt(rt.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new Zt(rt.paint_sky["sky-atmosphere-color"]),"sky-opacity":new Zt(rt.paint_sky["sky-opacity"])}),layout:nre};function lI(r,t,o){const c=[0,0,1],u=Po.identity([]);return Po.rotateY(u,u,o?-ye(r)+Math.PI:ye(r)),Po.rotateX(u,u,-ye(t)),De.transformQuat(c,c,u),De.normalize(c,c)}var rre={paint:new Er({})};const are={circle:class extends Jo{constructor(r,t){super(r,$ee,t)}createBucket(r){return new bP(r)}queryRadius(r){const t=r;return mv("circle-radius",this,t)+mv("circle-stroke-width",this,t)+qS(this.paint.get("circle-translate"))}queryIntersectsFeature(r,t,o,c,u,h,m,g){const v=RF(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),h.angle,r.pixelToTileUnitsFactor),x=this.paint.get("circle-radius").evaluate(t,o)+this.paint.get("circle-stroke-width").evaluate(t,o);return kF(r,c,h,m,g,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",v,x)}getProgramIds(){return["circle"]}getDefaultProgramParams(r,t){const o=LF(this);return{config:new Tm(this,t),defines:o,overrideFog:!1}}},heatmap:class extends Jo{createBucket(r){return new zF(r)}constructor(r,t){super(r,Qee,t),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(r){r==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=XS({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(r){return mv("heatmap-radius",this,r)}queryIntersectsFeature(r,t,o,c,u,h,m,g){const v=this.paint.get("heatmap-radius").evaluate(t,o);return kF(r,c,h,m,g,!0,!0,new G(0,0),v)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getDefaultProgramParams(r,t){return r==="heatmap"?{config:new Tm(this,t),overrideFog:!1}:{}}},hillshade:class extends Jo{constructor(r,t){super(r,tte,t)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}getDefaultProgramParams(r,t){return{overrideFog:!1}}},fill:class extends Jo{constructor(r,t){super(r,mte,t)}getProgramIds(){const r=this.paint.get("fill-pattern"),t=r&&r.constantOr(1),o=[t?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&o.push(t&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),o}getDefaultProgramParams(r,t){return{config:new Tm(this,t),overrideFog:!1}}recalculate(r,t){super.recalculate(r,t);const o=this.paint._values["fill-outline-color"];o.value.kind==="constant"&&o.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(r){return new t2(r)}queryRadius(){return qS(this.paint.get("fill-translate"))}queryIntersectsFeature(r,t,o,c,u,h){return!r.queryGeometry.isAboveHorizon&&TF(IF(r.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),h.angle,r.pixelToTileUnitsFactor),c)}isTileClipped(){return!0}},"fill-extrusion":class extends Jo{constructor(r,t){super(r,Yie,t)}createBucket(r){return new U1(r)}queryRadius(){return qS(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}hasShadowPass(){return!0}cutoffRange(){return this.paint.get("fill-extrusion-cutoff-fade-range")}canCastShadows(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}queryIntersectsFeature(r,t,o,c,u,h,m,g,v){const x=RF(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),h.angle,r.pixelToTileUnitsFactor),w=this.paint.get("fill-extrusion-height").evaluate(t,o),E=this.paint.get("fill-extrusion-base").evaluate(t,o),C=[0,0],I=g&&h.elevation,D=h.elevation?h.elevation.exaggeration():1,N=r.tile.getBucket(this);if(I&&N instanceof U1){const K=N.centroidVertexArray,X=v+1;X<K.length&&(C[0]=K.geta_centroid_pos0(X),C[1]=K.geta_centroid_pos1(X))}if(C[0]===0&&C[1]===1)return!1;h.projection.name==="globe"&&(c=D6([c],[new G(0,0),new G(mt,mt)],r.tileID.canonical).map(K=>K.polygon).flat());const W=I?g:null,[V,q]=function(K,X,J,ae,ce,ge,ve,Pe,Me,Le,Ee){return K.projection.name==="globe"?function(He,Ke,nt,Ve,je,ot,yt,ft,Lt,Ft,St){const Ct=[],rn=[],ln=He.projection.upVectorScale(St,He.center.lat,He.worldSize).metersToTile,sn=[0,0,0,1],un=[0,0,0,1],vn=(ai,Ai,Xn,Gn)=>{ai[0]=Ai,ai[1]=Xn,ai[2]=Gn,ai[3]=1},zn=k6();nt>0&&(nt+=zn),Ve+=zn;for(const ai of Ke){const Ai=[],Xn=[];for(const Gn of ai){const Ln=Gn.x+je.x,An=Gn.y+je.y,vi=He.projection.projectTilePoint(Ln,An,St),Li=He.projection.upVector(St,Gn.x,Gn.y);let ri=nt,Ji=Ve;if(yt){const Cr=O6(Ln,An,nt,Ve,yt,ft,Lt,Ft);ri+=Cr.base,Ji+=Cr.top}nt!==0?vn(sn,vi.x+Li[0]*ln*ri,vi.y+Li[1]*ln*ri,vi.z+Li[2]*ln*ri):vn(sn,vi.x,vi.y,vi.z),vn(un,vi.x+Li[0]*ln*Ji,vi.y+Li[1]*ln*Ji,vi.z+Li[2]*ln*Ji),De.transformMat4(sn,sn,ot),De.transformMat4(un,un,ot),Ai.push(new Pv(sn[0],sn[1],sn[2])),Xn.push(new Pv(un[0],un[1],un[2]))}Ct.push(Ai),rn.push(Xn)}return[Ct,rn]}(K,X,J,ae,ce,ge,ve,Pe,Me,Le,Ee):ve?function(He,Ke,nt,Ve,je,ot,yt,ft,Lt){const Ft=[],St=[],Ct=[0,0,0,1];for(const rn of He){const ln=[],sn=[];for(const un of rn){const vn=un.x+Ve.x,zn=un.y+Ve.y,ai=O6(vn,zn,Ke,nt,ot,yt,ft,Lt);Ct[0]=vn,Ct[1]=zn,Ct[2]=ai.base,Ct[3]=1,Yi.transformMat4(Ct,Ct,je),Ct[3]=Math.max(Ct[3],1e-5);const Ai=new Pv(Ct[0]/Ct[3],Ct[1]/Ct[3],Ct[2]/Ct[3]);Ct[0]=vn,Ct[1]=zn,Ct[2]=ai.top,Ct[3]=1,Yi.transformMat4(Ct,Ct,je),Ct[3]=Math.max(Ct[3],1e-5);const Xn=new Pv(Ct[0]/Ct[3],Ct[1]/Ct[3],Ct[2]/Ct[3]);ln.push(Ai),sn.push(Xn)}Ft.push(ln),St.push(sn)}return[Ft,St]}(X,J,ae,ce,ge,ve,Pe,Me,Le):function(He,Ke,nt,Ve,je){const ot=[],yt=[],ft=je[8]*Ke,Lt=je[9]*Ke,Ft=je[10]*Ke,St=je[11]*Ke,Ct=je[8]*nt,rn=je[9]*nt,ln=je[10]*nt,sn=je[11]*nt;for(const un of He){const vn=[],zn=[];for(const ai of un){const Ai=ai.x+Ve.x,Xn=ai.y+Ve.y,Gn=je[0]*Ai+je[4]*Xn+je[12],Ln=je[1]*Ai+je[5]*Xn+je[13],An=je[2]*Ai+je[6]*Xn+je[14],vi=je[3]*Ai+je[7]*Xn+je[15],Li=Gn+ft,ri=Ln+Lt,Ji=An+Ft,Cr=Math.max(vi+St,1e-5),hr=Gn+Ct,or=Ln+rn,ca=An+ln,Pr=Math.max(vi+sn,1e-5);vn.push(new Pv(Li/Cr,ri/Cr,Ji/Cr)),zn.push(new Pv(hr/Pr,or/Pr,ca/Pr))}ot.push(vn),yt.push(zn)}return[ot,yt]}(X,J,ae,ce,ge)}(h,c,E,w,x,m,W,C,D,h.center.lat,r.tileID.canonical),Z=r.queryGeometry;return function(K,X,J){let ae=1/0;TF(J,X)&&(ae=z6(J,X[0]));for(let ce=0;ce<X.length;ce++){const ge=X[ce],ve=K[ce];for(let Pe=0;Pe<ge.length-1;Pe++){const Me=ge[Pe],Le=[Me,ge[Pe+1],ve[Pe+1],ve[Pe],Me];MF(J,Le)&&(ae=Math.min(ae,z6(J,Le)))}}return ae!==1/0&&ae}(V,q,Z.isPointQuery()?Z.screenBounds:Z.screenGeometry)}},line:class extends Jo{constructor(r,t){super(r,N6,t),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(r){if(r==="line-gradient"){const t=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=t._styleExpression&&t._styleExpression.expression instanceof df,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(r,t){super.recalculate(r,t),this.paint._values["line-floorwidth"]=V6.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,r)}createBucket(r){return new S2(r)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getDefaultProgramParams(r,t){const o=U6(this);return{config:new Tm(this,t),defines:o,overrideFog:!1}}queryRadius(r){const t=r,o=G6(mv("line-width",this,t),mv("line-gap-width",this,t)),c=mv("line-offset",this,t);return o/2+Math.abs(c)+qS(this.paint.get("line-translate"))}queryIntersectsFeature(r,t,o,c,u,h){if(r.queryGeometry.isAboveHorizon)return!1;const m=IF(r.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),h.angle,r.pixelToTileUnitsFactor),g=r.pixelToTileUnitsFactor/2*G6(this.paint.get("line-width").evaluate(t,o),this.paint.get("line-gap-width").evaluate(t,o)),v=this.paint.get("line-offset").evaluate(t,o);return v&&(c=function(x,w){const E=[],C=new G(0,0);for(let I=0;I<x.length;I++){const D=x[I],N=[];for(let W=0;W<D.length;W++){const V=D[W],q=D[W+1],Z=W===0?C:V.sub(D[W-1])._unit()._perp(),K=W===D.length-1?C:q.sub(V)._unit()._perp(),X=Z._add(K)._unit();X._mult(1/(X.x*K.x+X.y*K.y)),N.push(X._mult(w)._add(V))}E.push(N)}return E}(c,v*r.pixelToTileUnitsFactor)),function(x,w,E){for(let C=0;C<w.length;C++){const I=w[C];if(x.length>=3){for(let D=0;D<I.length;D++)if(Pf(x,I[D]))return!0}if(Vee(x,I,E))return!0}return!1}(m,c,g)}isTileClipped(){return!0}},symbol:y2,background:class extends Jo{constructor(r,t){super(r,Jie,t)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}getDefaultProgramParams(r,t){return{overrideFog:!1}}},raster:class extends Jo{constructor(r,t){super(r,ere,t),this._updateColorRamp()}getProgramIds(){return["raster"]}hasColorMap(){return!!this._transitionablePaint._values["raster-color"].value.value}isLayerDraped(r){return!(r&&r._source instanceof td&&(r._source.onNorthPole||r._source.onSouthPole))}_handleSpecialPaintPropertyUpdate(r){r!=="raster-color"&&r!=="raster-color-range"||this._updateColorRamp()}_updateColorRamp(){if(!this.hasColorMap())return;const r=this._transitionablePaint._values["raster-color"].value.expression,[t,o]=this._transitionablePaint._values["raster-color-range"].value.expression.evaluate({zoom:0});this.colorRamp=XS({expression:r,evaluationKey:"rasterValue",image:this.colorRamp,clips:[{start:t,end:o}],resolution:256}),this.colorRampTexture=null}},sky:class extends Jo{constructor(r,t){super(r,ire,t),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(r){r==="sky-gradient"?this._updateColorRamp():r!=="sky-atmosphere-sun"&&r!=="sky-atmosphere-halo-color"&&r!=="sky-atmosphere-color"&&r!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=XS({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(r){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const t=r.style.light.properties.get("position");return this._lightPosition.azimuthal!==t.azimuthal||this._lightPosition.polar!==t.polar}return!1}getCenter(r,t){if(this.paint.get("sky-type")==="atmosphere"){const c=this.paint.get("sky-atmosphere-sun"),u=!c,h=r.style.light,m=h.properties.get("position");return u&&h.properties.get("anchor")==="viewport"&&xe("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),u?lI(m.azimuthal,90-m.polar,t):lI(c[0],90-c[1],t)}const o=this.paint.get("sky-gradient-center");return lI(o[0],90-o[1],t)}isSky(){return!0}markSkyboxValid(r){this._skyboxInvalidated=!1,this._lightPosition=r.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const r=this.paint.get("sky-type");return r==="atmosphere"?["skyboxCapture","skybox"]:r==="gradient"?["skyboxGradient"]:null}},slot:class extends Jo{constructor(r,t){super(r,rre)}},model:class extends Jo{constructor(r,t){super(r,Lie,t)}createBucket(r){return new h6(r)}getProgramIds(){return["model"]}is3D(){return!0}hasShadowPass(){return!0}canCastShadows(){return!0}hasLightBeamPass(){return!0}cutoffRange(){return this.paint.get("model-cutoff-fade-range")}queryRadius(){return 0}_handleOverridablePaintPropertyUpdate(r,t,o){return!(!this.layout||t.isDataDriven()||o.isDataDriven()||r!=="model-color"&&r!=="model-color-mix-intensity"&&r!=="model-rotation"&&r!=="model-scale"&&r!=="model-translation"&&r!=="model-emissive-strength")}_isPropertyZoomDependent(r){const t=this._transitionablePaint._values[r];return t!=null&&t.value!=null&&t.value.expression!=null&&t.value.expression instanceof jc}isZoomDependent(){return this._isPropertyZoomDependent("model-scale")||this._isPropertyZoomDependent("model-rotation")||this._isPropertyZoomDependent("model-translation")}}};function z2(r,t){return r.type==="custom"?new tre(r):new are[r.type](r,t)}function ore(r){const{userImage:t}=r;return!!(t&&t.render&&t.render())&&(r.data.replace(new Uint8Array(t.data.buffer)),!0)}class sre extends Vn{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded={},this.requestors=[],this.patterns={},this.atlasImage={},this.atlasTexture={},this.dirty=!0}createScope(t){this.images[t]={},this.loaded[t]=!1,this.updatedImages[t]={},this.patterns[t]={},this.callbackDispatchedThisFrame[t]={},this.atlasImage[t]=new Jr({width:1,height:1})}isLoaded(){for(const t in this.loaded)if(!this.loaded[t])return!1;return!0}setLoaded(t,o){if(this.loaded[o]!==t&&(this.loaded[o]=t,t)){for(const{ids:c,callback:u}of this.requestors)this._notify(c,o,u);this.requestors=[]}}hasImage(t,o){return!!this.getImage(t,o)}getImage(t,o){return this.images[o][t]}addImage(t,o,c){this._validate(t,c)&&(this.images[o][t]=c)}_validate(t,o){let c=!0;return this._validateStretch(o.stretchX,o.data&&o.data.width)||(this.fire(new bn(new Error(`Image "${t}" has invalid "stretchX" value`))),c=!1),this._validateStretch(o.stretchY,o.data&&o.data.height)||(this.fire(new bn(new Error(`Image "${t}" has invalid "stretchY" value`))),c=!1),this._validateContent(o.content,o)||(this.fire(new bn(new Error(`Image "${t}" has invalid "content" value`))),c=!1),c}_validateStretch(t,o){if(!t)return!0;let c=0;for(const u of t){if(u[0]<c||u[1]<u[0]||o<u[1])return!1;c=u[1]}return!0}_validateContent(t,o){return!(t&&(t.length!==4||t[0]<0||o.data.width<t[0]||t[1]<0||o.data.height<t[1]||t[2]<0||o.data.width<t[2]||t[3]<0||o.data.height<t[3]||t[2]<t[0]||t[3]<t[1]))}updateImage(t,o,c){c.version=this.images[o][t].version+1,this.images[o][t]=c,this.updatedImages[o][t]=!0}removeImage(t,o){const c=this.images[o][t];delete this.images[o][t],delete this.patterns[o][t],c.userImage&&c.userImage.onRemove&&c.userImage.onRemove()}listImages(t){return Object.keys(this.images[t])}getImages(t,o,c){let u=!0;const h=!!this.loaded[o];if(!h)for(const m of t)this.images[o][m]||(u=!1);h||u?this._notify(t,o,c):this.requestors.push({ids:t,scope:o,callback:c})}getUpdatedImages(t){return this.updatedImages[t]}_notify(t,o,c){const u={};for(const h of t){this.images[o][h]||this.fire(new $t("styleimagemissing",{id:h}));const m=this.images[o][h];m?u[h]={data:m.data.clone(),pixelRatio:m.pixelRatio,sdf:m.sdf,version:m.version,stretchX:m.stretchX,stretchY:m.stretchY,content:m.content,hasRenderCallback:!!(m.userImage&&m.userImage.render)}:xe(`Image "${h}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}c(null,u)}getPixelSize(t){const{width:o,height:c}=this.atlasImage[t];return{width:o,height:c}}getPattern(t,o){const c=this.patterns[o][t],u=this.getImage(t,o);if(!u)return null;if(c&&c.position.version===u.version)return c.position;if(c)c.position.version=u.version;else{const h={w:u.data.width+2,h:u.data.height+2,x:0,y:0},m=new WP(h,u);this.patterns[o][t]={bin:h,position:m}}return this._updatePatternAtlas(o),this.patterns[o][t].position}bind(t,o){const c=t.gl;let u=this.atlasTexture[o];u?this.dirty&&(u.update(this.atlasImage[o]),this.dirty=!1):(u=new xa(t,this.atlasImage[o],c.RGBA),this.atlasTexture[o]=u),u.bind(c.LINEAR,c.CLAMP_TO_EDGE)}_updatePatternAtlas(t){const o=[];for(const m in this.patterns[t])o.push(this.patterns[t][m].bin);const{w:c,h:u}=UP(o),h=this.atlasImage[t];h.resize({width:c||1,height:u||1});for(const m in this.patterns[t]){const{bin:g}=this.patterns[t][m],v=g.x+1,x=g.y+1,w=this.images[t][m].data,E=w.width,C=w.height;Jr.copy(w,h,{x:0,y:0},{x:v,y:x},{width:E,height:C}),Jr.copy(w,h,{x:0,y:C-1},{x:v,y:x-1},{width:E,height:1}),Jr.copy(w,h,{x:0,y:0},{x:v,y:x+C},{width:E,height:1}),Jr.copy(w,h,{x:E-1,y:0},{x:v-1,y:x},{width:1,height:C}),Jr.copy(w,h,{x:0,y:0},{x:v+E,y:x},{width:1,height:C})}this.dirty=!0}beginFrame(){for(const t in this.images)this.callbackDispatchedThisFrame[t]={}}dispatchRenderCallbacks(t,o){for(const c of t){if(this.callbackDispatchedThisFrame[o][c])continue;this.callbackDispatchedThisFrame[o][c]=!0;const u=this.images[o][c];ore(u)&&this.updateImage(c,o,u)}}}const lre=new Er({anchor:new Zt(rt.light.anchor),position:new class{constructor(r){this.specification=r}possiblyEvaluate(r,t){return st(r.expression.evaluate(t))}interpolate(r,t,o){return{x:kn(r.x,t.x,o),y:kn(r.y,t.y,o),z:kn(r.z,t.z,o),azimuthal:kn(r.azimuthal,t.azimuthal,o),polar:kn(r.polar,t.polar,o)}}}(rt.light.position),color:new Zt(rt.light.color),intensity:new Zt(rt.light.intensity)});class j6 extends Vn{constructor(t,o="flat"){super(),this._transitionable=new nh(lre),this.setLight(t,o),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(t,o,c={}){this._validate(Zy,t,c)||(this._transitionable.setTransitionOrValue(t),this.id=o)}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}_validate(t,o,c){return(!c||c.validate!==!1)&&yo(this,t.call(Vu,Fe({value:o,style:{glyphs:!0,sprite:!0},styleSpec:rt})))}}const cre=new Er({source:new Zt(rt.terrain.source),exaggeration:new Zt(rt.terrain.exaggeration)});let ure=class extends Vn{constructor(r,t){super(),this._transitionable=new nh(cre),this.set(r),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=t}setScope(r){this.scope=r}get(){return this._transitionable.serialize()}set(r){this._transitionable.setTransitionOrValue(r)}updateTransitions(r){this._transitioning=this._transitionable.transitioned(r,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(r){this.properties=this._transitioning.possiblyEvaluate(r)}getExaggeration(r){return this._transitioning.possiblyEvaluate(new dr(r)).get("exaggeration")}isZoomDependent(){const r=this._transitionable._values.exaggeration;return r!=null&&r.value!=null&&r.value.expression!=null&&r.value.expression instanceof jc}};const $6=45,Y6=65,Om=.05;function O2(r,t,o,c){const u=Te($6,Y6,o),[h,m]=q6(r,c);let g=1-Math.min(1,Math.exp((t-h)/(m-h)*-6));return g*=g*g,g=Math.min(1,1.00747*g),g*u*r.alpha}function q6(r,t){const o=.5/Math.tan(.5*t);return[r.range[0]+o,r.range[1]+o]}function X6(r,t,o,c,u){const h=De.transformMat4([],[t,o,c],u.mercatorFogMatrix);return O2(r,De.length(h),u.pitch,u._fov)}function Z6(r,t,o,c,u,h,m){const g=[[o,c,0],[u,c,0],[u,h,0],[o,h,0]];let v=Number.MAX_VALUE,x=-Number.MAX_VALUE;for(const w of g){const E=De.transformMat4([],w,t),C=De.length(E);v=Math.min(v,C),x=Math.max(x,C)}return[O2(r,v,m.pitch,m._fov),O2(r,x,m.pitch,m._fov)]}const dre=new Er({range:new Zt(rt.fog.range),color:new Zt(rt.fog.color),"high-color":new Zt(rt.fog["high-color"]),"space-color":new Zt(rt.fog["space-color"]),"horizon-blend":new Zt(rt.fog["horizon-blend"]),"star-intensity":new Zt(rt.fog["star-intensity"]),"vertical-range":new Zt(rt.fog["vertical-range"])});class hre extends Vn{constructor(t,o){super(),this._transitionable=new nh(dre),this.set(t),this._transitioning=this._transitionable.untransitioned(),this._transform=o}get state(){const t=this._transform,o=t.projection.name==="globe",c=_o(t.zoom),u=this.properties.get("range"),h=[.5,3];return{range:o?[kn(h[0],u[0],c),kn(h[1],u[1],c)]:u,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(t,o={}){if(this._validate(Ky,t,o))return;const c=Fe({},t);for(const u of Object.keys(rt.fog))c[u]===void 0&&(c[u]=rt.fog[u].default);this._transitionable.setTransitionOrValue(c)}getOpacity(t){if(!this._transform.projection.supportsFog)return 0;const o=this.properties&&this.properties.get("color")||1;return(this._transform.projection.name==="globe"?1:Te($6,Y6,t))*o.a}getOpacityAtLatLng(t,o){return this._transform.projection.supportsFog?function(c,u,h){const m=bi.fromLngLat(u),g=h.elevation?h.elevation.getAtPointOrZero(m):0;return X6(c,m.x,m.y,g,h)}(this.state,t,o):0}getOpacityForTile(t){if(!this._transform.projection.supportsFog)return[1,1];const o=this._transform.calculateFogTileMatrix(t.toUnwrapped());return Z6(this.state,o,0,0,mt,mt,this._transform)}getOpacityForBounds(t,o,c,u,h){return this._transform.projection.supportsFog?Z6(this.state,t,o,c,u,h,this._transform):[1,1]}getFovAdjustedRange(t){return this._transform.projection.supportsFog?q6(this.state,t):[0,1]}isVisibleOnFrustum(t){if(!this._transform.projection.supportsFog)return!1;const o=[4,5,6,7];for(const c of o){const u=t.points[c];let h;if(u[2]>=0)h=u;else{const m=t.points[c-4];h=hf(m,u,m[2]/(m[2]-u[2]))}if(X6(this.state,h[0],h[1],0,this._transform)>=Om)return!0}return!1}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}_validate(t,o,c){return(!c||c.validate!==!1)&&yo(this,t.call(Vu,Fe({value:o,style:{glyphs:!0,sprite:!0},styleSpec:rt})))}}class fre{constructor(t){this._callback=t,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class pre{constructor(){this.tasks={},this.taskQueue=[],pt(["process"],this),this.invoker=new fre(this.process),this.nextId=0}add(t,o){const c=this.nextId++,u=function({type:h,isSymbolTile:m,zoom:g}){return g=g||0,h==="message"?0:h!=="maybePrepare"||m?h!=="parseTile"||m?h==="parseTile"&&m?300-g:h==="maybePrepare"&&m?400-g:500:200-g:100-g}(o);if(u===0){ie();try{t()}finally{}return{cancel:()=>{}}}return this.tasks[c]={fn:t,metadata:o,priority:u,id:c},this.taskQueue.push(c),this.invoker.trigger(),{cancel:()=>{delete this.tasks[c]}}}process(){ie();try{if(this.taskQueue=this.taskQueue.filter(c=>!!this.tasks[c]),!this.taskQueue.length)return;const t=this.pick();if(t===null)return;const o=this.tasks[t];if(delete this.tasks[t],this.taskQueue.length&&this.invoker.trigger(),!o)return;o.fn()}finally{}}pick(){let t=null,o=1/0;for(let u=0;u<this.taskQueue.length;u++){const h=this.tasks[this.taskQueue[u]];h.priority<o&&(o=h.priority,t=u)}if(t===null)return null;const c=this.taskQueue[t];return this.taskQueue.splice(t,1),c}remove(){this.invoker.remove()}}class K6{constructor(t,o,c){this.target=t,this.parent=o,this.mapId=c,this.callbacks={},this.cancelCallbacks={},pt(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.scheduler=new pre}send(t,o,c,u,h=!1,m){const g=Math.round(1e18*Math.random()).toString(36).substring(0,10);c&&(c.metadata=m,this.callbacks[g]=c);const v=new Set;return this.target.postMessage({id:g,type:t,hasCallback:!!c,targetMapId:u,mustQueue:h,sourceMapId:this.mapId,data:Os(o,v)},v),{cancel:()=>{c&&delete this.callbacks[g],this.target.postMessage({id:g,type:"<cancel>",targetMapId:u,sourceMapId:this.mapId})}}}receive(t){const o=t.data,c=o.id;if(c&&(!o.targetMapId||this.mapId===o.targetMapId))if(o.type==="<cancel>"){const u=this.cancelCallbacks[c];delete this.cancelCallbacks[c],u&&u.cancel()}else if(o.mustQueue||ie()){const u=this.callbacks[c];this.cancelCallbacks[c]=this.scheduler.add(()=>this.processTask(c,o),u&&u.metadata||{type:"message"})}else this.processTask(c,o)}processTask(t,o){if(o.type==="<response>"){const c=this.callbacks[t];delete this.callbacks[t],c&&(o.error?c(eh(o.error)):c(null,eh(o.data)))}else{const c=new Set,u=o.hasCallback?(m,g)=>{delete this.cancelCallbacks[t],this.target.postMessage({id:t,type:"<response>",sourceMapId:this.mapId,error:m?Os(m):null,data:Os(g,c)},c)}:m=>{},h=eh(o.data);if(this.parent[o.type])this.parent[o.type](o.sourceMapId,h,u);else if(this.parent.getWorkerSource){const m=o.type.split(".");this.parent.getWorkerSource(o.sourceMapId,m[0],h.source,h.scope)[m[1]](h,u)}else u(new Error(`Could not find function ${o.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}}class Nm{constructor(t,o){this.workerPool=t,this.actors=[],this.currentActor=0,this.id=kt();const c=this.workerPool.acquire(this.id);for(let u=0;u<c.length;u++){const h=new Nm.Actor(c[u],o,this.id);h.name=`Worker ${u}`,this.actors.push(h)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(t,o,c){Xe(this.actors,(u,h)=>{u.send(t,o,h)},c=c||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(t=>{t.remove()}),this.actors=[],this.workerPool.release(this.id)}}Nm.Actor=K6;class J6 extends Vn{constructor(t,o,c,u){super(),this.scope=c,this._options=t,this.properties=new $u(o),this._transitionable=new nh(o,new Map(u)),this._transitionable.setTransitionOrValue(t.properties),this._transitioning=this._transitionable.untransitioned()}updateConfig(t){this._transitionable.setTransitionOrValue(this._options.properties,new Map(t))}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}get(){return this._options.properties=this._transitionable.serialize(),this._options}set(t,o){this._options=t,this._transitionable.setTransitionOrValue(t.properties,o)}shadowsEnabled(){return!!this.properties&&this.properties.get("cast-shadows")===!0}}const mre=new Er({color:new Zt(rt.properties_light_ambient.color),intensity:new Zt(rt.properties_light_ambient.intensity)}),gre=new Er({direction:new class{constructor(r){this.specification=r}possiblyEvaluate(r,t){return function([o,c]){const u=st([1,o,c]);return{x:u.x,y:u.y,z:u.z}}(r.expression.evaluate(t))}interpolate(r,t,o){return{x:kn(r.x,t.x,o),y:kn(r.y,t.y,o),z:kn(r.z,t.z,o)}}}(rt.properties_light_directional.direction),color:new Zt(rt.properties_light_directional.color),intensity:new Zt(rt.properties_light_directional.intensity),"cast-shadows":new Zt(rt.properties_light_directional["cast-shadows"]),"shadow-intensity":new Zt(rt.properties_light_directional["shadow-intensity"])});class cI{constructor(t,o,c,u){this.screenBounds=t,this.cameraPoint=o,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=c,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,u)}static createFromScreenPoints(t,o){let c,u;if(t instanceof G||typeof t[0]=="number"){const h=G.convert(t);c=[h],u=o.isPointAboveHorizon(h)}else{const h=G.convert(t[0]),m=G.convert(t[1]);c=[h,m],u=le(h,m).every(g=>o.isPointAboveHorizon(g))}return new cI(c,o.getCameraPoint(),u,o)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(t){return le(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],t)}bufferedCameraGeometry(t){const o=this.screenBounds[0],c=this.screenBounds.length===1?this.screenBounds[0].add(new G(1,1)):this.screenBounds[1],u=le(o,c,0,!1);return this.cameraPoint.y>c.y&&(this.cameraPoint.x>o.x&&this.cameraPoint.x<c.x?u.splice(3,0,this.cameraPoint):this.cameraPoint.x>=c.x?u[2]=this.cameraPoint:this.cameraPoint.x<=o.x&&(u[3]=this.cameraPoint)),function(h,m){const g=[];for(let v=0;v<h.length;v++){const x=Je(v-1,-1,h.length-1),w=Je(v+1,-1,h.length-1),E=h[v],C=h[w],I=h[x].sub(E).unit(),D=C.sub(E).unit(),N=D.angleWithSep(I.x,I.y),W=I.add(D).unit().mult(-1*m/Math.sin(N/2));g.push(E.add(W))}return g}(u,t)}bufferedCameraGeometryGlobe(t){const o=this.screenBounds[0],c=this.screenBounds.length===1?this.screenBounds[0].add(new G(1,1)):this.screenBounds[1],u=le(o,c,t),h=this.cameraPoint.clone();switch(3*((h.y>o.y)+(h.y>c.y))+((h.x>o.x)+(h.x>c.x))){case 0:u[0]=h,u[4]=h.clone();break;case 1:u.splice(1,0,h);break;case 2:u[1]=h;break;case 3:u.splice(4,0,h);break;case 5:u.splice(2,0,h);break;case 6:u[3]=h;break;case 7:u.splice(3,0,h);break;case 8:u[2]=h}return u}containsTile(t,o,c,u=0){const h=t.queryPadding/o._pixelsPerMercatorPixel+1,m=c?this._bufferedCameraMercator(h,o):this._bufferedScreenMercator(h,o);let g=t.tileID.wrap+(m.unwrapped?u:0);const v=m.polygon.map(W=>LB(t.tileTransform,W,g));if(!PF(v,0,0,mt,mt))return;g=t.tileID.wrap+(this.screenGeometryMercator.unwrapped?u:0);const x=this.screenGeometryMercator.polygon.map(W=>kB(t.tileTransform,W,g)),w=x.map(W=>new G(W[0],W[1])),E=o.getFreeCameraOptions().position||new bi(0,0,0),C=kB(t.tileTransform,E,g),I=x.map(W=>{const V=De.sub(W,W,C);return De.normalize(V,V),new US(C,V)}),D=km(t,1,o.zoom)*o._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:w,tilespaceRays:I,bufferedTilespaceGeometry:v,bufferedTilespaceBounds:(N=Be(v),N.min.x=re(N.min.x,0,mt),N.min.y=re(N.min.y,0,mt),N.max.x=re(N.max.x,0,mt),N.max.y=re(N.max.y,0,mt),N),tile:t,tileID:t.tileID,pixelToTileUnitsFactor:D};var N}_bufferedScreenMercator(t,o){const c=Q6(t);if(this._screenRaycastCache[c])return this._screenRaycastCache[c];{let u;return u=o.projection.name==="globe"?this._projectAndResample(this.bufferedScreenGeometry(t),o):{polygon:this.bufferedScreenGeometry(t).map(h=>o.pointCoordinate3D(h)),unwrapped:!0},this._screenRaycastCache[c]=u,u}}_bufferedCameraMercator(t,o){const c=Q6(t);if(this._cameraRaycastCache[c])return this._cameraRaycastCache[c];{let u;return u=o.projection.name==="globe"?this._projectAndResample(this.bufferedCameraGeometryGlobe(t),o):{polygon:this.bufferedCameraGeometry(t).map(h=>o.pointCoordinate3D(h)),unwrapped:!0},this._cameraRaycastCache[c]=u,u}}_projectAndResample(t,o){const c=function(h,m){const g=at.multiply([],m.pixelMatrix,m.globeMatrix),v=[0,-fs,0,1],x=[0,fs,0,1],w=[0,0,0,1];Yi.transformMat4(v,v,g),Yi.transformMat4(x,x,g),Yi.transformMat4(w,w,g);const E=new G(v[0]/v[3],v[1]/v[3]),C=new G(x[0]/x[3],x[1]/x[3]),I=Pf(h,E)&&v[3]<w[3],D=Pf(h,C)&&x[3]<w[3];if(!I&&!D)return null;const N=function(ae,ce,ge){for(let ve=1;ve<ae.length;ve++){const Pe=V1(ce.pointCoordinate3D(ae[ve-1]).x),Me=V1(ce.pointCoordinate3D(ae[ve]).x);if(ge<0){if(Pe<Me)return{idx:ve,t:-Pe/(Me-1-Pe)}}else if(Me<Pe)return{idx:ve,t:(1-Pe)/(Me+1-Pe)}}return null}(h,m,I?-1:1);if(!N)return null;const{idx:W,t:V}=N;let q=W>1?uI(h.slice(0,W),m):[],Z=W<h.length?uI(h.slice(W),m):[];q=q.map(ae=>new G(V1(ae.x),ae.y)),Z=Z.map(ae=>new G(V1(ae.x),ae.y));const K=[...q];K.length===0&&K.push(Z[Z.length-1]);const X=kn(K[K.length-1].y,(Z.length===0?q[0]:Z[0]).y,V);let J;return J=I?[new G(0,X),new G(0,0),new G(1,0),new G(1,X)]:[new G(1,X),new G(1,1),new G(0,1),new G(0,X)],K.push(...J),Z.length===0?K.push(q[0]):K.push(...Z),{polygon:K.map(ae=>new bi(ae.x,ae.y)),unwrapped:!1}}(t,o);if(c)return c;const u=function(h,m){let g=!1,v=-1/0,x=0;for(let E=0;E<h.length-1;E++)h[E].x>v&&(v=h[E].x,x=E);for(let E=0;E<h.length-1;E++){const C=(x+E)%(h.length-1),I=h[C],D=h[C+1];Math.abs(I.x-D.x)>.5&&(I.x<D.x?(I.x+=1,C===0&&(h[h.length-1].x+=1)):(D.x+=1,C+1===h.length-1&&(h[0].x+=1)),g=!0)}const w=xo(m.center.lng);return g&&w<Math.abs(w-1)&&h.forEach(E=>{E.x-=1}),{polygon:h,unwrapped:g}}(uI(t,o).map(h=>new G(V1(h.x),h.y)),o);return{polygon:u.polygon.map(h=>new bi(h.x,h.y)),unwrapped:u.unwrapped}}}function uI(r,t){return SF(r,o=>{const c=t.pointCoordinate3D(o);o.x=c.x,o.y=c.y},1/256)}function V1(r){return r<0?1+r%1:r%1}function Q6(r){return 100*r|0}function dI(r,t,o,c,u){const h=function(m,g){if(m)return u(m);if(g){r.url&&g.tiles&&r.tiles&&delete r.tiles;const v=ct(Fe(g,r),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);g.vector_layers&&(v.vectorLayers=g.vector_layers,v.vectorLayerIds=v.vectorLayers.map(x=>x.id)),v.tiles=t.canonicalizeTileset(v,r.url),u(null,v)}};return r.url?tt(t.transformRequest(t.normalizeSourceURL(r.url,null,o,c),Se.Source),h):Pn.frame(()=>h(null,r))}class N2{constructor(t,o,c){this.bounds=Fl.convert(this.validateBounds(t)),this.minzoom=o||0,this.maxzoom=c||24}validateBounds(t){return Array.isArray(t)&&t.length===4?[Math.max(-180,t[0]),Math.max(-90,t[1]),Math.min(180,t[2]),Math.min(90,t[3])]:[-180,-90,180,90]}contains(t){const o=Math.pow(2,t.z),c=Math.floor(xo(this.bounds.getWest())*o),u=Math.floor(Io(this.bounds.getNorth())*o),h=Math.ceil(xo(this.bounds.getEast())*o),m=Math.ceil(Io(this.bounds.getSouth())*o);return t.x>=c&&t.x<h&&t.y>=u&&t.y<m}}class eU{constructor(t,o){this.width=t,this.height=o,this.nextRow=0,this.image=new dh({width:t,height:o}),this.positions={},this.uploaded=!1}getDash(t,o){const c=this.getKey(t,o);return this.positions[c]}trim(){const t=this.width,o=this.height=Et(this.nextRow);this.image.resize({width:t,height:o})}getKey(t,o){return t.join(",")+o}getDashRanges(t,o,c){const u=[];let h=t.length%2==1?-t[t.length-1]*c:0,m=t[0]*c,g=!0;u.push({left:h,right:m,isDash:g,zeroLength:t[0]===0});let v=t[0];for(let x=1;x<t.length;x++){g=!g;const w=t[x];h=v*c,v+=w,m=v*c,u.push({left:h,right:m,isDash:g,zeroLength:w===0})}return u}addRoundDash(t,o,c){const u=o/2;for(let h=-c;h<=c;h++){const m=this.width*(this.nextRow+c+h);let g=0,v=t[g];for(let x=0;x<this.width;x++){x/v.right>1&&(v=t[++g]);const w=Math.abs(x-v.left),E=Math.abs(x-v.right),C=Math.min(w,E);let I;const D=h/c*(u+1);if(v.isDash){const N=u-Math.abs(D);I=Math.sqrt(C*C+N*N)}else I=u-Math.sqrt(C*C+D*D);this.image.data[m+x]=Math.max(0,Math.min(255,I+128))}}}addRegularDash(t,o){for(let v=t.length-1;v>=0;--v){const x=t[v],w=t[v+1];x.zeroLength?t.splice(v,1):w&&w.isDash===x.isDash&&(w.left=x.left,t.splice(v,1))}const c=t[0],u=t[t.length-1];c.isDash===u.isDash&&(c.left=u.left-this.width,u.right=c.right+this.width);const h=this.width*this.nextRow;let m=0,g=t[m];for(let v=0;v<this.width;v++){v/g.right>1&&(g=t[++m]);const x=Math.abs(v-g.left),w=Math.abs(v-g.right),E=Math.min(x,w);this.image.data[h+v]=Math.max(0,Math.min(255,(g.isDash?E:-E)+o+128))}}addDash(t,o){const c=this.getKey(t,o);if(this.positions[c])return this.positions[c];const u=o==="round",h=u?7:0,m=2*h+1;if(this.nextRow+m>this.height)return xe("LineAtlas out of space"),null;t.length===0&&t.push(1);let g=0;for(let w=0;w<t.length;w++)t[w]<0&&(xe("Negative value is found in line dasharray, replacing values with 0"),t[w]=0),g+=t[w];if(g!==0){const w=this.width/g,E=this.getDashRanges(t,this.width,w);u?this.addRoundDash(E,w,h):this.addRegularDash(E,o==="square"?.5*w:0)}const v=this.nextRow+h;this.nextRow+=m;const x={tl:[v,h],br:[g,0]};return this.positions[c]=x,x}}dn(eU,"LineAtlas");const tU=1*eu;class nU{constructor(t){const o={},c=[];for(const g in t){const v=t[g],x=o[g]={};for(const w in v.glyphs){const E=v.glyphs[+w];if(!E||E.bitmap.width===0||E.bitmap.height===0)continue;const C=E.metrics.localGlyph?tU:1,I={x:0,y:0,w:E.bitmap.width+2*C,h:E.bitmap.height+2*C};c.push(I),x[w]=I}}const{w:u,h}=UP(c),m=new dh({width:u||1,height:h||1});for(const g in t){const v=t[g];for(const x in v.glyphs){const w=v.glyphs[+x];if(!w||w.bitmap.width===0||w.bitmap.height===0)continue;const E=o[g][x],C=w.metrics.localGlyph?tU:1;dh.copy(w.bitmap,m,{x:0,y:0},{x:E.x+C,y:E.y+C},w.bitmap)}}this.image=m,this.positions=o}}dn(nU,"GlyphAtlas");class yre{constructor(t){this.tileID=new ki(t.tileID.overscaledZ,t.tileID.wrap,t.tileID.canonical.z,t.tileID.canonical.x,t.tileID.canonical.y),this.tileZoom=t.tileZoom,this.uid=t.uid,this.zoom=t.zoom,this.canonical=t.tileID.canonical,this.pixelRatio=t.pixelRatio,this.tileSize=t.tileSize,this.source=t.source,this.scope=t.scope,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=t.showCollisionBoxes,this.collectResourceTiming=!!t.collectResourceTiming,this.promoteId=t.promoteId,this.isSymbolTile=t.isSymbolTile,this.tileTransform=Lm(t.tileID.canonical,t.projection),this.projection=t.projection,this.brightness=t.brightness,this.extraShadowCaster=!!t.extraShadowCaster}parse(t,o,c,u,h){this.status="parsing",this.data=t,this.collisionBoxArray=new VC;const m=new $F(Object.keys(t.layers).sort()),g=new NP(this.tileID,this.promoteId);g.bucketLayerIDs=[];const v={},x=new eU(256,256),w={featureIndex:g,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:x,availableImages:c,brightness:this.brightness},E=o.familiesBySource[this.source];for(const q in E){const Z=t.layers[q];if(!Z)continue;let K=!1,X=!1,J=!1;for(const ge of E[q])ge[0].type==="symbol"?K=!0:X=!0,ge[0].is3D()&&ge[0].type!=="model"&&(J=!0);if(this.extraShadowCaster&&!J||this.isSymbolTile===!0&&!K||this.isSymbolTile===!1&&!X)continue;Z.version===1&&xe(`Vector tile source "${this.source}" layer "${q}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const ae=m.encode(q),ce=[];for(let ge=0;ge<Z.length;ge++){const ve=Z.feature(ge),Pe=g.getId(ve,q);ce.push({feature:ve,id:Pe,index:ge,sourceLayerIndex:ae})}for(const ge of E[q]){const ve=ge[0];(!this.extraShadowCaster||ve.is3D()&&ve.type!=="model")&&(this.isSymbolTile!==void 0&&ve.type==="symbol"!==this.isSymbolTile||ve.minzoom&&this.zoom<Math.floor(ve.minzoom)||ve.maxzoom&&this.zoom>=ve.maxzoom||ve.visibility!=="none"&&(hI(ge,this.zoom,w.brightness,c),(v[ve.id]=ve.createBucket({index:g.bucketLayerIDs.length,layers:ge,zoom:this.zoom,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:ae,sourceID:this.source,projection:this.projection.spec})).populate(ce,w,this.tileID.canonical,this.tileTransform),g.bucketLayerIDs.push(ge.map(Pe=>Pe.id))))}}let C,I,D,N;x.trim();const W={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},V=()=>{if(C)return h(C);if(this.extraShadowCaster)this.status="done",h(null,{buckets:Ze(v).filter(q=>!q.isEmpty()),featureIndex:g,collisionBoxArray:null,glyphAtlasImage:null,lineAtlas:null,imageAtlas:null,brightness:w.brightness,glyphMap:null,iconMap:null,glyphPositions:null});else if(I&&D&&N){const q=new nU(I),Z=new uB(D,N);for(const K in v){const X=v[K];X instanceof L1?(hI(X.layers,this.zoom,w.brightness,c),fne(X,I,q.positions,D,Z.iconPositions,this.showCollisionBoxes,c,this.tileID.canonical,this.tileZoom,this.projection,this.brightness)):X.hasPattern&&(X instanceof S2||X instanceof t2||X instanceof U1)&&(hI(X.layers,this.zoom,w.brightness,c),X.addFeatures(w,this.tileID.canonical,Z.patternPositions,c,this.tileTransform,this.brightness))}this.status="done",h(null,{buckets:Ze(v).filter(K=>!K.isEmpty()),featureIndex:g,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:q.image,lineAtlas:x,imageAtlas:Z,brightness:w.brightness})}};if(!this.extraShadowCaster){const q=_t(w.glyphDependencies,X=>Object.keys(X).map(Number));Object.keys(q).length?u.send("getGlyphs",{uid:this.uid,stacks:q,scope:this.scope},(X,J)=>{C||(C=X,I=J,V())},void 0,!1,W):I={};const Z=Object.keys(w.iconDependencies);Z.length?u.send("getImages",{icons:Z,source:this.source,scope:this.scope,tileID:this.tileID,type:"icons"},(X,J)=>{C||(C=X,D=J,V())},void 0,!1,W):D={};const K=Object.keys(w.patternDependencies);K.length?u.send("getImages",{icons:K,source:this.source,scope:this.scope,tileID:this.tileID,type:"patterns"},(X,J)=>{C||(C=X,N=J,V())},void 0,!1,W):N={}}V()}}function hI(r,t,o,c){const u=new dr(t,{brightness:o});for(const h of r)h.recalculate(u,c)}class iU{constructor(t){this.entries={},this.scheduler=t}request(t,o,c,u){const h=this.entries[t]=this.entries[t]||{callbacks:[]};if(h.result){const[m,g]=h.result;return this.scheduler?this.scheduler.add(()=>{u(m,g)},o):u(m,g),()=>{}}return h.callbacks.push(u),h.cancel||(h.cancel=c((m,g)=>{h.result=[m,g];for(const v of h.callbacks)this.scheduler?this.scheduler.add(()=>{v(m,g)},o):v(m,g);setTimeout(()=>delete this.entries[t],3e3)})),()=>{h.result||(h.callbacks=h.callbacks.filter(m=>m!==u),h.callbacks.length||(h.cancel(),delete this.entries[t]))}}}function rU(r,t,o){const c=JSON.stringify(r.request);return r.data&&(this.deduped.entries[c]={result:[null,r.data]}),this.deduped.request(c,{type:"parseTile",isSymbolTile:r.isSymbolTile,zoom:r.tileZoom},u=>{const h=vt(r.request,(m,g,v,x)=>{m?u(m):g&&u(null,{vectorTile:o?void 0:new kP(new s2(g)),rawData:g,cacheControl:v,expires:x})});return()=>{h.cancel(),u()}},t)}class aU extends Vn{constructor(t,o,c,u){if(super(),this.id=t,this.dispatcher=c,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,Fe(this,ct(o,["url","scheme","tileSize","promoteId"])),this._options=Fe({type:"vector"},o),this._collectResourceTiming=!!o.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(u),this._tileWorkers={},this._deduped=new iU}load(t){this._loaded=!1,this.fire(new $t("dataloading",{dataType:"source"}));const o=Array.isArray(this.map._language)?this.map._language.join():this.map._language,c=this.map._worldview;this._tileJSONRequest=dI(this._options,this.map._requestManager,o,c,(u,h)=>{this._tileJSONRequest=null,this._loaded=!0,u?(o&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${o}`),c&&c.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${c}`),this.fire(new bn(u))):h&&(Fe(this,h),h.bounds&&(this.tileBounds=new N2(h.bounds,this.minzoom,this.maxzoom)),jt(h.tiles,this.map._requestManager._customAccessToken),this.fire(new $t("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new $t("data",{dataType:"source",sourceDataType:"content"}))),t&&t(u)})}loaded(){return this._loaded}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}onAdd(t){this.map=t,this.load()}reload(){this.cancelTileJSONRequest();const t=Ko(this.id,this.scope);this.load(()=>this.map.style.clearSource(t))}setTiles(t){return this._options.tiles=t,this.reload(),this}setUrl(t){return this.url=t,this._options.url=t,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return Fe({},this._options)}loadTile(t,o){const c=this.map._requestManager.normalizeTileURL(t.tileID.canonical.url(this.tiles,this.scheme)),u={request:this.map._requestManager.transformRequest(c,Se.Tile),data:void 0,uid:t.uid,tileID:t.tileID,tileZoom:t.tileZoom,zoom:t.tileID.overscaledZ,tileSize:this.tileSize*t.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,pixelRatio:Pn.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:t.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0,extraShadowCaster:t.isExtraShadowCaster};if(u.request.collectResourceTiming=this._collectResourceTiming,t.actor&&t.state!=="expired")t.state==="loading"?t.reloadCallback=o:t.request=t.actor.send("reloadTile",u,h.bind(this));else if(t.actor=this._tileWorkers[c]=this._tileWorkers[c]||this.dispatcher.getActor(),this.dispatcher.ready)t.request=t.actor.send("loadTile",u,h.bind(this),void 0,!0);else{const m=rU.call({deduped:this._deduped},u,(g,v)=>{g||!v?h.call(this,g):(u.data={cacheControl:v.cacheControl,expires:v.expires,rawData:v.rawData.slice(0)},t.actor&&t.actor.send("loadTile",u,h.bind(this),void 0,!0))},!0);t.request={cancel:m}}function h(m,g){return delete t.request,t.aborted?o(null):m&&m.status!==404?o(m):(g&&g.resourceTiming&&(t.resourceTiming=g.resourceTiming),this.map._refreshExpiredTiles&&g&&t.setExpiryData(g),t.loadVectorData(g,this.map.painter),Qe(this.dispatcher),o(null),void(t.reloadCallback&&(this.loadTile(t,t.reloadCallback),t.reloadCallback=null)))}}abortTile(t){t.request&&(t.request.cancel(),delete t.request),t.actor&&t.actor.send("abortTile",{uid:t.uid,type:this.type,source:this.id,scope:this.scope})}unloadTile(t){t.unloadVectorData(),t.actor&&t.actor.send("removeTile",{uid:t.uid,type:this.type,source:this.id,scope:this.scope})}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class G1 extends Vn{constructor(t,o,c,u){super(),this.id=t,this.dispatcher=c,this.setEventedParent(u),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=Fe({type:"raster"},o),Fe(this,ct(o,["url","scheme","tileSize"]))}load(t){this._loaded=!1,this.fire(new $t("dataloading",{dataType:"source"})),this._tileJSONRequest=dI(this._options,this.map._requestManager,null,null,(o,c)=>{this._tileJSONRequest=null,this._loaded=!0,o?this.fire(new bn(o)):c&&(Fe(this,c),c.bounds&&(this.tileBounds=new N2(c.bounds,this.minzoom,this.maxzoom)),jt(c.tiles),this.fire(new $t("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new $t("data",{dataType:"source",sourceDataType:"content"}))),t&&t(o)})}loaded(){return this._loaded}onAdd(t){this.map=t,this.load()}reload(){this.cancelTileJSONRequest();const t=Ko(this.id,this.scope);this.load(()=>this.map.style.clearSource(t))}setTiles(t){return this._options.tiles=t,this.reload(),this}setUrl(t){return this.url=t,this._options.url=t,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return Fe({},this._options)}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}loadTile(t,o){const c=Pn.devicePixelRatio>=2,u=this.map._requestManager.normalizeTileURL(t.tileID.canonical.url(this.tiles,this.scheme),c,this.tileSize);t.request=Qt(this.map._requestManager.transformRequest(u,Se.Tile),(h,m,g,v)=>(delete t.request,t.aborted?(t.state="unloaded",o(null)):h?(t.state="errored",o(h)):m?(this.map._refreshExpiredTiles&&t.setExpiryData({cacheControl:g,expires:v}),t.setTexture(m,this.map.painter),t.state="loaded",Qe(this.dispatcher),void o(null)):o(null)))}static loadTileData(t,o,c){t.setTexture(o,c)}static unloadTileData(t,o){t.texture&&o.saveTileTexture(t.texture)}abortTile(t,o){t.request&&(t.request.cancel(),delete t.request),o()}unloadTile(t,o){t.texture&&this.map.painter.saveTileTexture(t.texture),o()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}let fI;function vre(){return a3.workerClass!=null?new a3.workerClass:new p.Worker(a3.workerUrl)}const pI="mapboxgl_preloaded_worker_pool";class Iv{constructor(){this.active={}}acquire(t){if(!this.workers)for(this.workers=[];this.workers.length<Iv.workerCount;)this.workers.push(new vre);return this.active[t]=!0,this.workers.slice()}release(t){delete this.active[t],this.workers&&this.numActive()===0&&(this.workers.forEach(o=>{o.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[pI]}numActive(){return Object.keys(this.active).length}}let H1;function j1(){return H1||(H1=new Iv),H1}Iv.workerCount=2;let $1,mI,iu,gI=null;function oU(){return ie()&&self.worker&&self.worker.dracoUrl?self.worker.dracoUrl:mI||b.DRACO_URL}const yI=5123,vI=5126,_I={5120:Int8Array,5121:Uint8Array,5122:Int16Array,[yI]:Uint16Array,5125:Uint32Array,[vI]:Float32Array},_re={5120:"DT_INT8",5121:"DT_UINT8",5122:"DT_INT16",[yI]:"DT_UINT16",5125:"DT_UINT32",[vI]:"DT_FLOAT32"},xI={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16};function sU(r,t,o){const c=o.json.bufferViews.length,u=o.buffers.length;t.bufferView=c,o.json.bufferViews[c]={buffer:u,byteLength:r.byteLength},o.buffers[u]=r}const bI="KHR_draco_mesh_compression";function xre(r,t){const o=r.extensions&&r.extensions[bI];if(!o)return;const c=new iu.Decoder,u=dU(t,o.bufferView),h=new iu.Mesh;if(!c.DecodeArrayToMesh(u,u.byteLength,h))throw new Error("Failed to decode Draco mesh");const m=t.json.accessors[r.indices],g=_I[m.componentType],v=m.count*g.BYTES_PER_ELEMENT,x=iu._malloc(v);g===Uint16Array?c.GetTrianglesUInt16Array(h,v,x):c.GetTrianglesUInt32Array(h,v,x),sU(iu.memory.buffer.slice(x,x+v),m,t),iu._free(x);for(const w of Object.keys(o.attributes)){const E=c.GetAttributeByUniqueId(h,o.attributes[w]),C=t.json.accessors[r.attributes[w]],I=_re[C.componentType],D=C.count*xI[C.type]*_I[C.componentType].BYTES_PER_ELEMENT,N=iu._malloc(D);c.GetAttributeDataArrayForAllPoints(h,E,iu[I],D,N),sU(iu.memory.buffer.slice(N,N+D),C,t),iu._free(N)}c.destroy(),h.destroy(),delete r.extensions[bI]}const lU=1179937895,cU=new TextDecoder("utf8");function uU(r,t){return new URL(r,t).href}async function bre(r,t,o,c){const u=await fetch(uU(r.uri,c)),h=await u.arrayBuffer();t.buffers[o]=h}function dU(r,t){const o=r.json.bufferViews[t];return new Uint8Array(r.buffers[o.buffer],o.byteOffset||0,o.byteLength)}async function wre(r,t,o,c){if(r.uri){const u=uU(r.uri,c),h=await fetch(u),m=await h.blob();t.images[o]=await p.createImageBitmap(m)}else if(r.bufferView!==void 0){const u=dU(t,r.bufferView),h=new p.Blob([u],{type:r.mimeType});t.images[o]=await p.createImageBitmap(h)}}async function hU(r,t=0,o){const c={json:null,images:[],buffers:[]};if(new Uint32Array(r,t,1)[0]===lU){const w=new Uint32Array(r,t);let E=2;const C=(w[E++]>>2)-3,I=w[E++]>>2;if(E++,c.json=JSON.parse(cU.decode(w.subarray(E,E+I))),E+=I,E<C){const D=w[E++];E++;const N=t+(E<<2);c.buffers[0]=r.slice(N,N+D)}}else c.json=JSON.parse(cU.decode(new Uint8Array(r,t)));const{buffers:u,images:h,meshes:m,extensionsUsed:g}=c.json;if(u){const w=[];for(let E=0;E<u.length;E++){const C=u[E];C.uri?w.push(bre(C,c,E,o)):c.buffers[E]||(c.buffers[E]=null)}await Promise.all(w)}const v=[],x=g&&g.includes(bI);if(x&&v.push(async function(){if(!iu){if($1)return $1;$1=async function(w){let E,C=null;function I(){E=new Uint8Array(C.buffer)}function D(){throw new Error("Unexpected Draco error.")}const N={a:{a:D,d:function(ft,Lt,Ft){return E.copyWithin(ft,Lt,Lt+Ft)},c:function(ft){const Lt=E.length,Ft=Math.max(ft>>>0,Math.ceil(1.2*Lt)),St=Math.ceil((Ft-Lt)/65536);try{return C.grow(St),I(),!0}catch{return!1}},b:D}},W=await(WebAssembly.instantiateStreaming?WebAssembly.instantiateStreaming(w,N):WebAssembly.instantiate(await(await w).arrayBuffer(),N)),{Rb:V,Qb:q,P:Z,T:K,X,Ja:J,La:ae,Qa:ce,Va:ge,Wa:ve,eb:Pe,jb:Me,f:Le,e:Ee,yb:He,zb:Ke,Ab:nt,Bb:Ve,Db:je,Gb:ot}=W.instance.exports;C=Ee;const yt=(()=>{let ft=0,Lt=0,Ft=0,St=0;return Ct=>{Ft&&(V(St),V(ft),Lt+=Ft,Ft=ft=0),ft||(Lt+=128,ft=q(Lt));const rn=Ct.length+7&-8;let ln=ft;rn>=Lt&&(Ft=rn,ln=St=q(rn));for(let sn=0;sn<Ct.length;sn++)E[ln+sn]=Ct[sn];return ln}})();return I(),Le(),{memory:Ee,_free:V,_malloc:q,Mesh:class{constructor(){this.ptr=Z()}destroy(){K(this.ptr)}},Decoder:class{constructor(){this.ptr=J()}destroy(){Me(this.ptr)}DecodeArrayToMesh(ft,Lt,Ft){const St=yt(ft),Ct=ae(this.ptr,St,Lt,Ft.ptr);return!!X(Ct)}GetAttributeByUniqueId(ft,Lt){return{ptr:ce(this.ptr,ft.ptr,Lt)}}GetTrianglesUInt16Array(ft,Lt,Ft){ge(this.ptr,ft.ptr,Lt,Ft)}GetTrianglesUInt32Array(ft,Lt,Ft){ve(this.ptr,ft.ptr,Lt,Ft)}GetAttributeDataArrayForAllPoints(ft,Lt,Ft,St,Ct){Pe(this.ptr,ft.ptr,Lt.ptr,Ft,St,Ct)}},DT_INT8:He(),DT_UINT8:Ke(),DT_INT16:nt(),DT_UINT16:Ve(),DT_UINT32:je(),DT_FLOAT32:ot()}}(fetch(oU())),iu=await $1,$1=void 0}}()),h)for(let w=0;w<h.length;w++)v.push(wre(h[w],c,w,o));if(v.length&&await Promise.all(v),x&&m)for(const{primitives:w}of m)for(const E of w)xre(E,c);return c}async function fU(r){const t=await fetch(r);return hU(await t.arrayBuffer(),0,r)}class pU{constructor(t,o,c){if(this.triangleCount=o.length/3,this.min=new G(0,0),this.max=new G(0,0),this.xScale=0,this.yScale=0,this.cellsX=0,this.cellsY=0,this.cells=[],this.payload=[],this.triangleCount===0||t.length===0||c===0)return;const u=t.map(w=>w.x),h=t.map(w=>w.y);this.min=new G(Math.min(...u),Math.min(...h)),this.max=new G(Math.max(...u),Math.max(...h));const m=this.max.sub(this.min);m.x=Math.max(m.x,1),m.y=Math.max(m.y,1);const g=Math.max(m.x,m.y)/c;this.cellsX=Math.max(1,Math.ceil(m.x/g)),this.cellsY=Math.max(1,Math.ceil(m.y/g)),this.xScale=1/g,this.yScale=1/g;const v=[];for(let w=0;w<this.triangleCount;w++){const E=t[o[3*w+0]].sub(this.min),C=t[o[3*w+1]].sub(this.min),I=t[o[3*w+2]].sub(this.min),D=Ff(Math.floor(Math.min(E.x,C.x,I.x)),this.xScale,this.cellsX),N=Ff(Math.floor(Math.max(E.x,C.x,I.x)),this.xScale,this.cellsX),W=Ff(Math.floor(Math.min(E.y,C.y,I.y)),this.yScale,this.cellsY),V=Ff(Math.floor(Math.max(E.y,C.y,I.y)),this.yScale,this.cellsY),q=new G(0,0),Z=new G(0,0),K=new G(0,0),X=new G(0,0);for(let J=W;J<=V;++J){q.y=Z.y=J*g,K.y=X.y=(J+1)*g;for(let ae=D;ae<=N;++ae)q.x=K.x=ae*g,Z.x=X.x=(ae+1)*g,(EP(E,C,I,q,Z,X)||EP(E,C,I,q,X,K))&&v.push({cellIdx:J*this.cellsX+ae,triIdx:w})}}if(v.length===0)return;v.sort((w,E)=>w.cellIdx-E.cellIdx||w.triIdx-E.triIdx);let x=0;for(;x<v.length;){const w=v[x].cellIdx,E={start:this.payload.length,len:0};for(;x<v.length&&v[x].cellIdx===w;)++E.len,this.payload.push(v[x++].triIdx);this.cells[w]=E}}query(t,o,c){if(this.triangleCount===0||this.cells.length===0||t.x>this.max.x||this.min.x>o.x||t.y>this.max.y||this.min.y>o.y)return;this.lookup||(this.lookup=new Uint8Array(Math.ceil(this.triangleCount/8)));for(let v=0;v<this.lookup.length;v++)this.lookup[v]=0;const u=Ff(t.x-this.min.x,this.xScale,this.cellsX),h=Ff(o.x-this.min.x,this.xScale,this.cellsX),m=Ff(t.y-this.min.y,this.yScale,this.cellsY),g=Ff(o.y-this.min.y,this.yScale,this.cellsY);for(let v=m;v<=g;v++)for(let x=u;x<=h;x++){const w=this.cells[v*this.cellsX+x];if(w)for(let E=0;E<w.len;E++){const C=this.payload[w.start+E],I=Math.floor(C/8),D=1<<C%8;if(!(this.lookup[I]&D)&&(this.lookup[I]|=D,c.push(C),c.length===this.triangleCount))return}}}}function Ff(r,t,o){return Math.max(0,Math.min(o-1,Math.floor(r*t)))}function Fm(r,t){const o=r.json.bufferViews[t.bufferView];return new _I[t.componentType](r.buffers[o.buffer],(t.byteOffset||0)+(o.byteOffset||0),t.count*xI[t.type])}function Sre(r,t,o){const c=r.indices,u=r.attributes,h={};h.indexArray=new Un;const m=t.json.accessors[c],g=m.count/3;h.indexArray.reserve(g);const v=Fm(t,m);for(let C=0;C<g;C++)h.indexArray.emplaceBack(v[3*C],v[3*C+1],v[3*C+2]);h.indexArray._trim(),h.vertexArray=new On;const x=t.json.accessors[u.POSITION];h.vertexArray.reserve(x.count);const w=Fm(t,x);for(let C=0;C<x.count;C++)h.vertexArray.emplaceBack(w[3*C],w[3*C+1],w[3*C+2]);if(h.vertexArray._trim(),h.aabb=new _r(x.min,x.max),h.centroid=function(C,I){const D=[0,0,0],N=C.length;if(N>0){for(let W=0;W<N;W++){const V=3*C[W];D[0]+=I[V],D[1]+=I[V+1],D[2]+=I[V+2]}D[0]/=N,D[1]/=N,D[2]/=N}return D}(v,w),u.COLOR_0!==void 0){const C=t.json.accessors[u.COLOR_0],I=xI[C.type];if(C.componentType===vI){h.colorArray=I===3?new On:new hn,h.colorArray.reserve(C.count);const D=Fm(t,C);if(I===3)for(let N=0;N<C.count;N++)h.colorArray.emplaceBack(D[3*N],D[3*N+1],D[3*N+2]);else for(let N=0;N<C.count;N++)h.colorArray.emplaceBack(D[4*N],D[4*N+1],D[4*N+2],D[4*N+3]);h.colorArray._trim()}else if(C.componentType===yI&&I===4){h.colorArray=new hn,h.colorArray.resize(C.count);const D=Fm(t,C),N=1/65535,W=h.colorArray.float32;for(let V=0;V<4*D.length;++V)W[V]=D[V]*N}else xe(`glTF color buffer parsing for accessor ${JSON.stringify(C)} is not supported`)}if(u.NORMAL!==void 0){h.normalArray=new On;const C=t.json.accessors[u.NORMAL];h.normalArray.reserve(C.count);const I=Fm(t,C);for(let D=0;D<C.count;D++)h.normalArray.emplaceBack(I[3*D],I[3*D+1],I[3*D+2]);h.normalArray._trim()}if(u.TEXCOORD_0!==void 0&&o.length>0){h.texcoordArray=new h1;const C=t.json.accessors[u.TEXCOORD_0];h.texcoordArray.reserve(C.count);const I=Fm(t,C);for(let D=0;D<C.count;D++)h.texcoordArray.emplaceBack(I[2*D],I[2*D+1]);h.texcoordArray._trim()}const E=r.material;return h.material=function(C,I){const{emissiveFactor:D=[0,0,0],alphaMode:N="OPAQUE",alphaCutoff:W=.5,normalTexture:V,occlusionTexture:q,emissiveTexture:Z,doubleSided:K}=C,{baseColorFactor:X=[1,1,1,1],metallicFactor:J=1,roughnessFactor:ae=1,baseColorTexture:ce,metallicRoughnessTexture:ge}=C.pbrMetallicRoughness||{};return{pbrMetallicRoughness:{baseColorFactor:new En(...X),metallicFactor:J,roughnessFactor:ae,baseColorTexture:ce?I[ce.index]:void 0,metallicRoughnessTexture:ge?I[ge.index]:void 0},doubleSided:K,emissiveFactor:D,alphaMode:N,alphaCutoff:W,normalTexture:V?I[V.index]:void 0,occlusionTexture:q?I[q.index]:void 0,emissionTexture:Z?I[Z.index]:void 0,defined:C.defined===void 0}}(E!==void 0?t.json.materials[E]:{defined:!1},o),u._FEATURE_RGBA4444!==void 0&&(h.featureData=new Uint32Array(Fm(t,t.json.accessors[u._FEATURE_RGBA4444]).buffer)),h}function mU(r,t,o){const{matrix:c,rotation:u,translation:h,scale:m,mesh:g,extras:v,children:x}=r,w={};if(w.matrix=c||at.fromRotationTranslationScale([],u||[0,0,0,1],h||[0,0,0],m||[1,1,1]),g!==void 0){w.meshes=o[g];const E=w.anchor=[0,0];for(const C of w.meshes){const{min:I,max:D}=C.aabb;E[0]+=I[0]+D[0],E[1]+=I[1]+D[1]}E[0]=Math.floor(E[0]/w.meshes.length/2),E[1]=Math.floor(E[1]/w.meshes.length/2)}if(v&&(v.id&&(w.id=v.id),v.lights&&(w.lights=function(E){if(!E.length)return[];const C=function(V){const q=atob(V),Z=new Uint8Array(q.length);for(let K=0;K<q.length;K++)Z[K]=q.codePointAt(K);return Z}(E),I=[],D=C.length/24,N=new Uint16Array(C.buffer),W=new Float32Array(C.buffer);for(let V=0;V<D;V++){const q=N[2*V*6]/30,Z=N[2*V*6+1]/30,K=N[2*V*6+10]/100,X=W[6*V+1],J=W[6*V+2],ae=W[6*V+3],ce=W[6*V+4],ge=ae-X,ve=ce-J,Pe=Math.hypot(ge,ve);I.push({pos:[X+.5*ge,J+.5*ve,Z],normal:[ve/Pe,-ge/Pe,0],width:Pe,height:q,depth:K,points:[X,J,ae,ce]})}return I}(v.lights))),x){const E=[];for(const C of x)E.push(mU(t.json.nodes[C],t,o));w.children=E}return w}function Ere(r){if(r.vertices.length===0||r.indices.length===0)return null;const[t,o]=[r.vertices[0].clone(),r.vertices[0].clone()];for(let m=1;m<r.vertices.length;++m){const g=r.vertices[m];t.x=Math.min(t.x,g.x),t.y=Math.min(t.y,g.y),o.x=Math.max(o.x,g.x),o.y=Math.max(o.y,g.y)}const c=Math.ceil(Math.max(o.x-t.x,o.y-t.y)/256),u=Math.max(8,c),h=new pU(r.vertices,r.indices,u);return{vertices:r.vertices,indices:r.indices,grid:h,min:t,max:o}}function Mre(r){if(!r.extras||!r.extras.ground)return null;const t=r.extras.ground;if(!t||!Array.isArray(t)||t.length===0)return null;const o=t[0];if(!o||!Array.isArray(o)||o.length===0)return null;const c=[];for(const m of o){if(!Array.isArray(m)||m.length!==2)continue;const g=m[0],v=m[1];typeof g=="number"&&typeof v=="number"&&c.push(new G(g,v))}if(c.length<3)return null;c.length>1&&c[c.length-1].equals(c[0])&&c.pop();let u=0;for(let m=0;m<c.length;m++){const g=c[m],v=c[(m+1)%c.length],x=c[(m+2)%c.length];u+=(g.x-v.x)*(x.y-v.y)-(x.x-v.x)*(g.y-v.y)}u>0&&c.reverse();const h=e2(c.flatMap(m=>[m.x,m.y]),[]);return h.length===0?null:{vertices:c,indices:h}}function Tre(r){const t=[],o=[];let c=0;for(const u of r){c=t.length;const h=u.vertexArray.float32,m=u.indexArray.uint16;for(let g=0;g<u.vertexArray.length;g++)t.push(new G(h[3*g+0],h[3*g+1]));for(let g=0;g<3*u.indexArray.length;g++)o.push(m[g]+c)}if(o.length%3!=0)return null;for(let u=0;u<o.length;u+=3){const h=t[o[u+0]],m=t[o[u+1]],g=t[o[u+2]];(h.x-m.x)*(g.y-m.y)-(g.x-m.x)*(h.y-m.y)>0&&([o[u+1],o[u+2]]=[o[u+2],o[u+1]])}return{vertices:t,indices:o}}function wI(r){const t=function(v,x){const w=[],E=p.WebGL2RenderingContext;if(v.json.textures)for(const C of v.json.textures){const I={magFilter:E.LINEAR,minFilter:E.NEAREST,wrapS:E.REPEAT,wrapT:E.REPEAT};C.sampler!==void 0&&Object.assign(I,v.json.samplers[C.sampler]),w.push({image:x[C.source],sampler:I,uploaded:!1})}return w}(r,r.images),o=function(v,x){const w=[];for(const E of v.json.meshes){const C=[];for(const I of E.primitives)C.push(Sre(I,v,x));w.push(C)}return w}(r,t),{scenes:c,scene:u,nodes:h}=r.json,m=c?c[u||0].nodes:h,g=[];for(const v of m)g.push(mU(h[v],r,o));return function(v,x,w){const E={},C=new Set;for(let I=0;I<v.length;I++){const D=w[x[I]];if(!D.extras)continue;const N=D.extras["mapbox:footprint:version"],W=D.extras["mapbox:footprint:id"];(N||W)&&C.add(I),N==="1.0.0"&&W&&(E[W]=I)}for(let I=0;I<v.length;I++){if(C.has(I))continue;const D=v[I],N=w[x[I]];if(!N.extras)continue;let W=null;D.id in E&&(W=Tre(v[E[D.id]].meshes)),W||(W=Mre(N)),W&&(D.footprint=Ere(W))}if(C.size>0){const I=Array.from(C.values()).sort((D,N)=>D-N);for(let D=I.length-1;D>=0;D--)v.splice(I[D],1)}}(g,m,r.json.nodes),g}function Are(r){r.heightmap=new Float32Array(4096),r.heightmap.fill(-1);const t=r.vertexArray.float32,o=r.aabb.min[0]-1,c=r.aabb.min[1]-1,u=Dm/(r.aabb.max[0]-o+2),h=Dm/(r.aabb.max[1]-c+2);for(let m=0;m<t.length;m+=3){const g=t[m+2],v=(t[m+0]-o)*u|0,x=(t[m+1]-c)*h|0;g>r.heightmap[x*Dm+v]&&(r.heightmap[x*Dm+v]=g)}}function Cre(r,t){const o={};o.indexArray=new Un,o.indexArray.reserve(4*r.length),o.vertexArray=new On,o.vertexArray.reserve(10*r.length),o.colorArray=new hn,o.vertexArray.reserve(10*r.length);let c=0;for(const m of r){const g=Math.min(10,Math.max(4,1.3*m.height))*t,v=[-m.normal[1],m.normal[0],0],x=Math.min(.29,.1*m.width/m.depth),w=m.width-2*m.depth*t*(x+.01),E=De.scaleAndAdd([],m.pos,v,w/2),C=De.scaleAndAdd([],m.pos,v,-w/2),I=[E[0],E[1],E[2]+m.height],D=[C[0],C[1],C[2]+m.height],N=De.scaleAndAdd([],m.normal,v,x);De.scale(N,N,g);const W=De.scaleAndAdd([],m.normal,v,-x);De.scale(W,W,g),De.add(N,E,N),De.add(W,C,W),E[2]+=.1,C[2]+=.1,o.vertexArray.emplaceBack(N[0],N[1],N[2]),o.vertexArray.emplaceBack(W[0],W[1],W[2]),o.vertexArray.emplaceBack(E[0],E[1],E[2]),o.vertexArray.emplaceBack(C[0],C[1],C[2]),o.vertexArray.emplaceBack(I[0],I[1],I[2]),o.vertexArray.emplaceBack(D[0],D[1],D[2]),o.vertexArray.emplaceBack(E[0],E[1],E[2]),o.vertexArray.emplaceBack(C[0],C[1],C[2]),o.vertexArray.emplaceBack(N[0],N[1],N[2]),o.vertexArray.emplaceBack(W[0],W[1],W[2]);const V=w/g/2;o.colorArray.emplaceBack(-V-x,-1,V,.8),o.colorArray.emplaceBack(V+x,-1,V,.8),o.colorArray.emplaceBack(-V,0,V,1.3),o.colorArray.emplaceBack(V,0,V,1.3),o.colorArray.emplaceBack(V+x,-.8,V,.7),o.colorArray.emplaceBack(V+x,-.8,V,.7),o.colorArray.emplaceBack(0,0,V,1.3),o.colorArray.emplaceBack(0,0,V,1.3),o.colorArray.emplaceBack(V+x,-1.2,V,.8),o.colorArray.emplaceBack(V+x,-1.2,V,.8),o.indexArray.emplaceBack(6+c,4+c,8+c),o.indexArray.emplaceBack(7+c,9+c,5+c),o.indexArray.emplaceBack(0+c,1+c,2+c),o.indexArray.emplaceBack(1+c,3+c,2+c),c+=10}const u={defined:!0,emissiveFactor:[0,0,0]},h={};return h.baseColorFactor=En.white,u.pbrMetallicRoughness=h,o.material=u,o.aabb=new _r([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),o}dn(pU,"TriangleGridIndex");const SI={vector:aU,raster:G1,"raster-dem":class extends G1{constructor(r,t,o,c){super(r,t,o,c),this.type="raster-dem",this.maxzoom=22,this._options=Fe({type:"raster-dem"},t),this.encoding=t.encoding||"mapbox"}loadTile(r,t){var h,m;const o=this.map._requestManager.normalizeTileURL(r.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);r.request=Qt(this.map._requestManager.transformRequest(o,Se.Tile),(function(g,v,x,w){if(delete r.request,r.aborted)r.state="unloaded",t(null);else if(g)r.state="errored",t(g);else if(v){this.map._refreshExpiredTiles&&r.setExpiryData({cacheControl:x,expires:w});const C=p.ImageBitmap&&v instanceof p.ImageBitmap&&(fI==null&&(fI=p.OffscreenCanvas&&new p.OffscreenCanvas(1,1).getContext("2d")&&typeof p.createImageBitmap=="function"),fI),I=1-(v.width-((E=v.width)<=1?1:Math.pow(2,Math.floor(Math.log(E)/Math.LN2))))/2;I<1||r.neighboringTiles||(r.neighboringTiles=this._getNeighboringTiles(r.tileID));const D=C?v:Pn.getImageData(v,I),N={uid:r.uid,coord:r.tileID,source:this.id,scope:this.scope,rawImageData:D,encoding:this.encoding,padding:I,convertToFloat:c};r.actor&&r.state!=="expired"||(r.actor=this.dispatcher.getActor(),r.actor.send("loadDEMTile",N,u.bind(this),void 0,!0))}var E}).bind(this));const c=(m=(h=this.map)==null?void 0:h.painter)==null?void 0:m.terrainUseFloatDEM();function u(g,v){g&&(r.state="errored",t(g)),v&&(r.dem=v,r.dem.onDeserialize(),r.needsHillshadePrepare=!0,r.needsDEMTextureUpload=!0,r.state="loaded",t(null))}}_getNeighboringTiles(r){const t=r.canonical,o=Math.pow(2,t.z),c=(t.x-1+o)%o,u=t.x===0?r.wrap-1:r.wrap,h=(t.x+1+o)%o,m=t.x+1===o?r.wrap+1:r.wrap,g={};return g[new ki(r.overscaledZ,u,t.z,c,t.y).key]={backfilled:!1},g[new ki(r.overscaledZ,m,t.z,h,t.y).key]={backfilled:!1},t.y>0&&(g[new ki(r.overscaledZ,u,t.z,c,t.y-1).key]={backfilled:!1},g[new ki(r.overscaledZ,r.wrap,t.z,t.x,t.y-1).key]={backfilled:!1},g[new ki(r.overscaledZ,m,t.z,h,t.y-1).key]={backfilled:!1}),t.y+1<o&&(g[new ki(r.overscaledZ,u,t.z,c,t.y+1).key]={backfilled:!1},g[new ki(r.overscaledZ,r.wrap,t.z,t.x,t.y+1).key]={backfilled:!1},g[new ki(r.overscaledZ,m,t.z,h,t.y+1).key]={backfilled:!1}),g}unloadTile(r){r.demTexture&&this.map.painter.saveTileTexture(r.demTexture),r.hillshadeFBO&&(r.hillshadeFBO.destroy(),delete r.hillshadeFBO),r.dem&&delete r.dem,delete r.neighboringTiles,r.state="unloaded"}},geojson:class extends Vn{constructor(r,t,o,c){super(),this.id=r,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=o.getActor(),this.setEventedParent(c),this._data=t.data,this._options=Fe({},t),this._collectResourceTiming=t.collectResourceTiming,t.maxzoom!==void 0&&(this.maxzoom=t.maxzoom),t.type&&(this.type=t.type),t.attribution&&(this.attribution=t.attribution),this.promoteId=t.promoteId;const u=mt/this.tileSize;this.workerOptions=Fe({source:this.id,scope:this.scope,cluster:t.cluster||!1,geojsonVtOptions:{buffer:(t.buffer!==void 0?t.buffer:128)*u,tolerance:(t.tolerance!==void 0?t.tolerance:.375)*u,extent:mt,maxZoom:this.maxzoom,lineMetrics:t.lineMetrics||!1,generateId:t.generateId||!1},superclusterOptions:{maxZoom:t.clusterMaxZoom!==void 0?t.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,t.clusterMinPoints||2),extent:mt,radius:(t.clusterRadius!==void 0?t.clusterRadius:50)*u,log:!1,generateId:t.generateId||!1},clusterProperties:t.clusterProperties,filter:t.filter},t.workerOptions)}onAdd(r){this.map=r,this.setData(this._data)}setData(r){return this._data=r,this._updateWorkerData(),this}getClusterExpansionZoom(r,t){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:r,source:this.id,scope:this.scope},t),this}getClusterChildren(r,t){return this.actor.send("geojson.getClusterChildren",{clusterId:r,source:this.id,scope:this.scope},t),this}getClusterLeaves(r,t,o,c){return this.actor.send("geojson.getClusterLeaves",{source:this.id,scope:this.scope,clusterId:r,limit:t,offset:o},c),this}_updateWorkerData(){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new $t("dataloading",{dataType:"source"})),this._loaded=!1;const r=Fe({},this.workerOptions);r.scope=this.scope;const t=this._data;typeof t=="string"?(r.request=this.map._requestManager.transformRequest(Pn.resolveURL(t),Se.Source),r.request.collectResourceTiming=this._collectResourceTiming):r.data=JSON.stringify(t),this._pendingLoad=this.actor.send(`${this.type}.loadData`,r,(o,c)=>{if(this._loaded=!0,this._pendingLoad=null,o)this.fire(new bn(o));else{const u={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&c&&c.resourceTiming&&c.resourceTiming[this.id]&&(u.resourceTiming=c.resourceTiming[this.id]),this.fire(new $t("data",u)),this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(r,t){const o=r.actor?"reloadTile":"loadTile";r.actor=this.actor;const c={type:this.type,uid:r.uid,tileID:r.tileID,tileZoom:r.tileZoom,zoom:r.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,scope:this.scope,pixelRatio:Pn.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,brightness:this.map.style&&this.map.style.getBrightness()||0};r.request=this.actor.send(o,c,(u,h)=>(delete r.request,r.unloadVectorData(),r.aborted?t(null):u?t(u):(r.loadVectorData(h,this.map.painter,o==="reloadTile"),t(null))),void 0,o==="loadTile")}abortTile(r){r.request&&(r.request.cancel(),delete r.request),r.aborted=!0}unloadTile(r){r.unloadVectorData(),this.actor.send("removeTile",{uid:r.uid,type:this.type,source:this.id,scope:this.scope})}onRemove(){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return Fe({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends td{constructor(r,t,o,c){super(r,t,o,c),this.roundZoom=!0,this.type="video",this.options=t}load(){this._loaded=!1;const r=this.options;this.urls=[];for(const t of r.urls)this.urls.push(this.map._requestManager.transformRequest(t,Se.Source).url);(function(t,o){const c=p.document.createElement("video");c.muted=!0,c.onloadstart=function(){o(null,c)};for(let u=0;u<t.length;u++){const h=p.document.createElement("source");ht(t[u])||(c.crossOrigin="Anonymous"),h.src=t[u],c.appendChild(h)}})(this.urls,(t,o)=>{this._loaded=!0,t?this.fire(new bn(t)):o&&(this.video=o,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(r){if(this.video){const t=this.video.seekable;r<t.start(0)||r>t.end(0)?this.fire(new bn(new cn(`sources.${this.id}`,null,`Playback for this video can be set only between the ${t.start(0)} and ${t.end(0)}-second mark.`))):this.video.currentTime=r}}getVideo(){return this.video}onAdd(r){this.map||(this.map=r,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const r=this.map.painter.context,t=r.gl;this.texture?this.video.paused||(this.texture.bind(t.LINEAR,t.CLAMP_TO_EDGE),t.texSubImage2D(t.TEXTURE_2D,0,0,0,t.RGBA,t.UNSIGNED_BYTE,this.video)):(this.texture=new xa(r,this.video,t.RGBA),this.texture.bind(t.LINEAR,t.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(r)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:td,model:class extends Vn{constructor(r,t,o,c){super(),this.id=r,this.type="model",this.models=[],this._loaded=!1,this._options=t}async load(){for(const r in this._options.models){const t=this._options.models[r],o=await fU(this.map._requestManager.transformRequest(t.uri,Se.Model).url).catch(h=>{this.fire(new bn(new Error(`Could not load model ${r} from ${t.uri}: ${h.message}`)))});if(!o)continue;const c=wI(o),u=new c6(r,t.position,t.orientation,c);u.computeBoundsAndApplyParent(),this.models.push(u)}this._loaded=!0,this.fire(new $t("data",{dataType:"source",sourceDataType:"metadata"}))}onAdd(r){this.map=r,this.load()}hasTransition(){return!1}loaded(){return this._loaded}getModels(){return this.models}loadTile(r,t){}serialize(){return{type:"model"}}},"batched-model":class extends Vn{constructor(r,t,o,c){super(),this.type="batched-model",this.id=r,this.tileSize=512,this._options=t,this.tiles=this._options.tiles,this.maxzoom=t.maxzoom||19,this.minzoom=t.minzoom||0,this.roundZoom=!0,this.usedInConflation=!0,this.dispatcher=o,this.reparseOverscaled=!1,this.scheme="xyz",this._loaded=!1,this.setEventedParent(c)}onAdd(r){this.map=r,this.load()}load(r){this._loaded=!1,this.fire(new $t("dataloading",{dataType:"source"}));const t=Array.isArray(this.map._language)?this.map._language.join():this.map._language,o=this.map._worldview;this._tileJSONRequest=dI(this._options,this.map._requestManager,t,o,(c,u)=>{this._tileJSONRequest=null,this._loaded=!0,c?(t&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${t}`),o&&o.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${o}`),this.fire(new bn(c))):u&&(Fe(this,u),u.bounds&&(this.tileBounds=new N2(u.bounds,this.minzoom,this.maxzoom)),jt(u.tiles,this.map._requestManager._customAccessToken),this.fire(new $t("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new $t("data",{dataType:"source",sourceDataType:"content"}))),r&&r(c)})}hasTransition(){return!1}hasTile(r){return!this.tileBounds||this.tileBounds.contains(r.canonical)}loaded(){return this._loaded}loadTile(r,t){const o=this.map._requestManager.normalizeTileURL(r.tileID.canonical.url(this.tiles,this.scheme)),c={request:this.map._requestManager.transformRequest(o,Se.Tile),data:void 0,uid:r.uid,tileID:r.tileID,tileZoom:r.tileZoom,zoom:r.tileID.overscaledZ,tileSize:this.tileSize*r.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,showCollisionBoxes:this.map.showCollisionBoxes,isSymbolTile:r.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0};if(r.actor&&r.state!=="expired")if(r.state==="loading")r.reloadCallback=t;else{if(r.buckets){const h=Object.values(r.buckets);for(const m of h)m.dirty=!0;return void(r.state="loaded")}r.request=r.actor.send("reloadTile",c,u.bind(this))}else r.actor=this.dispatcher.getActor(),r.request=r.actor.send("loadTile",c,u.bind(this),void 0,!0);function u(h,m){return r.aborted?t(null):h&&h.status!==404?t(h):(m&&(m.resourceTiming&&(r.resourceTiming=m.resourceTiming),this.map._refreshExpiredTiles&&r.setExpiryData(m),r.buckets={...r.buckets,...m.buckets}),r.state="loaded",void t(null))}}serialize(){return Fe({},this._options)}},canvas:class extends td{constructor(r,t,o,c){super(r,t,o,c),t.coordinates?Array.isArray(t.coordinates)&&t.coordinates.length===4&&!t.coordinates.some(u=>!Array.isArray(u)||u.length!==2||u.some(h=>typeof h!="number"))||this.fire(new bn(new cn(`sources.${r}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new bn(new cn(`sources.${r}`,null,'missing required property "coordinates"'))),t.animate&&typeof t.animate!="boolean"&&this.fire(new bn(new cn(`sources.${r}`,null,'optional "animate" property must be a boolean value'))),t.canvas?typeof t.canvas=="string"||t.canvas instanceof p.HTMLCanvasElement||this.fire(new bn(new cn(`sources.${r}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new bn(new cn(`sources.${r}`,null,'missing required property "canvas"'))),this.options=t,this.animate=t.animate===void 0||t.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof p.HTMLCanvasElement?this.options.canvas:p.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new bn(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(r){this.map=r,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let r=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,r=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,r=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const t=this.map.painter.context;this.texture?!r&&!this._playing||this.texture instanceof E2||this.texture.update(this.canvas,{premultiply:!0}):this.texture=new xa(t,this.canvas,t.gl.RGBA,{premultiply:!0}),this._prepareData(t)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const r of[this.canvas.width,this.canvas.height])if(isNaN(r)||r<=0)return!0;return!1}},custom:class extends Vn{constructor(r,t,o,c){super(),this.id=r,this.type="custom",this._dataType="raster",this._dispatcher=o,this._implementation=t,this.setEventedParent(c),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new bn(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new bn(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new N2(this._implementation.bounds,this.minzoom,this.maxzoom)),t.update=this._update.bind(this),t.clearTiles=this._clearTiles.bind(this),t.coveringTiles=this._coveringTiles.bind(this),Fe(this,ct(t,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return ct(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new $t("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new $t("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(r){this._map=r,this._loaded=!1,this.fire(new $t("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(r),this.load()}onRemove(r){this._implementation.onRemove&&this._implementation.onRemove(r)}hasTile(r){if(this._implementation.hasTile){const{x:t,y:o,z:c}=r.canonical;return this._implementation.hasTile({x:t,y:o,z:c})}return!this.tileBounds||this.tileBounds.contains(r.canonical)}loadTile(r,t){const{x:o,y:c,z:u}=r.tileID.canonical,h=new p.AbortController;r.request=Promise.resolve(this._implementation.loadTile({x:o,y:c,z:u},{signal:h.signal})).then((function(m){return delete r.request,r.aborted?(r.state="unloaded",t(null)):m===void 0?(r.state="errored",t(null)):m===null?(this.loadTileData(r,{width:this.tileSize,height:this.tileSize,data:null}),r.state="loaded",t(null)):function(g){return g instanceof p.ImageData||g instanceof p.HTMLCanvasElement||g instanceof p.ImageBitmap||g instanceof p.HTMLImageElement}(m)?(this.loadTileData(r,m),r.state="loaded",void t(null)):(r.state="errored",t(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)))}).bind(this)).catch(m=>{m.code!==20&&(r.state="errored",t(m))}),r.request.cancel=()=>h.abort()}loadTileData(r,t){G1.loadTileData(r,t,this._map.painter)}unloadTileData(r){G1.unloadTileData(r,this._map.painter)}unloadTile(r,t){if(this.unloadTileData(r),this._implementation.unloadTile){const{x:o,y:c,z:u}=r.tileID.canonical;this._implementation.unloadTile({x:o,y:c,z:u})}t()}abortTile(r,t){r.request&&r.request.cancel&&(r.request.cancel(),delete r.request),t()}hasTransition(){return!1}_coveringTiles(){return this._map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(r=>({x:r.canonical.x,y:r.canonical.y,z:r.canonical.z}))}_clearTiles(){const r=Ko(this.id,this.scope);this._map.style.clearSource(r)}_update(){this.fire(new $t("data",{dataType:"source",sourceDataType:"content"}))}}},EI=function(r,t,o,c){const u=new SI[t.type](r,t,o,c);if(u.id!==r)throw new Error(`Expected Source id to be ${r} instead of ${u.id}`);return pt(["load","abort","unload","serialize","prepare"],u),u};function Pre(r,t){const o=at.identity([]);return at.scale(o,o,[.5*r.width,.5*-r.height,1]),at.translate(o,o,[1,-1,0]),at.multiply(o,o,r.calculateProjMatrix(t.toUnwrapped())),Float32Array.from(o)}function Ire(r,t,o,c,u,h,m,g=!1){const v=r.tilesIn(c,m,g);v.sort(gU);const x=[];for(const E of v)x.push({wrappedTileID:E.tile.tileID.wrapped().key,queryResults:E.tile.queryRenderedFeatures(t,o,r._state,E,u,h,Pre(r.transform,E.tile.tileID),g)});const w=function(E){const C={},I={};for(const D of E){const N=D.queryResults,W=D.wrappedTileID,V=I[W]=I[W]||{};for(const q in N){const Z=N[q],K=V[q]=V[q]||{},X=C[q]=C[q]||[];for(const J of Z)K[J.featureIndex]||(K[J.featureIndex]=!0,X.push(J))}}return C}(x);for(const E in w)w[E].forEach(C=>{const I=C.feature,D=I.layer;D&&D.type!=="background"&&D.type!=="sky"&&D.type!=="slot"&&(I.source=D.source,D["source-layer"]&&(I.sourceLayer=D["source-layer"]),I.state=I.id!==void 0?r.getFeatureState(D["source-layer"],I.id):{})});return w}function Rre(r,t){const o=r.getRenderableIds().map(h=>r.getTileByID(h)),c=[],u={};for(let h=0;h<o.length;h++){const m=o[h],g=m.tileID.canonical.key;u[g]||(u[g]=!0,m.querySourceFeatures(c,t))}return c}function gU(r,t){const o=r.tileID,c=t.tileID;return o.overscaledZ-c.overscaledZ||o.canonical.y-c.canonical.y||o.wrap-c.wrap||o.canonical.x-c.canonical.x}class Lre{constructor(t){this.style=t}processLayersChanged(){this.layers=[];for(const t in this.style._mergedLayers){const o=this.style._mergedLayers[t];if(o.type==="fill-extrusion")this.layers.push(o);else if(o.type==="model"){const c=this.style.getLayerSource(o);c&&c.type==="batched-model"&&this.layers.push(o)}}}updateZOffset(t,o){this.currentBuildingBuckets=[];for(let u=0;u<this.layers.length;++u){const h=this.layers[u],m=this.style.getLayerSourceCache(h);let g=1;h.type==="fill-extrusion"&&(g=h.paint.get("fill-extrusion-opacity")>0?h.paint.get("fill-extrusion-vertical-scale"):0);let v=m?m.getTile(o):null;if(!v&&m&&o.canonical.z>m.getSource().minzoom){let x=o.scaledTo(Math.min(m.getSource().maxzoom,o.overscaledZ-1));for(;x.overscaledZ>=m.getSource().minzoom&&(v=m.getTile(x),!v&&x.overscaledZ!==0);)x=x.scaledTo(x.overscaledZ-1)}this.currentBuildingBuckets.push({bucket:v?v.getBucket(h):null,tileID:v?v.tileID:o,verticalScale:g})}t.hasAnyZOffset=!1;let c=!1;for(let u=0;u<t.symbolInstances.length;u++){const h=t.symbolInstances.get(u),m=h.zOffset,g=this._getHeightAtTileOffset(o,h.tileAnchorX,h.tileAnchorY);h.zOffset=g!==-1?g:m,c||m===h.zOffset||(c=!0),t.hasAnyZOffset||h.zOffset===0||(t.hasAnyZOffset=!0)}c&&(t.zOffsetBuffersNeedUpload=!0,t.zOffsetSortDirty=!0)}_mapCoordToOverlappingTile(t,o,c,u){let h=o,m=c;if(t.canonical.z!==u.canonical.z){const g=u.canonical,v=1/(1<<t.canonical.z-g.z);h=(o+t.canonical.x*mt)*v-g.x*mt|0,m=(c+t.canonical.y*mt)*v-g.y*mt|0}return{tileX:h,tileY:m}}_getHeightAtTileOffset(t,o,c){let u;for(let h=0;h<this.layers.length;++h){if(this.layers[h].type!=="fill-extrusion")continue;const{bucket:m,tileID:g,verticalScale:v}=this.currentBuildingBuckets[h];if(!m)continue;const{tileX:x,tileY:w}=this._mapCoordToOverlappingTile(t,o,c,g),E=m.getHeightAtTileCoord(x,w);if(E&&E.height!==void 0){if(!E.hidden)return E.height*v;u=E.height}}for(let h=0;h<this.layers.length;++h){if(this.layers[h].type!=="model")continue;const{bucket:m,tileID:g}=this.currentBuildingBuckets[h];if(!m)continue;const{tileX:v,tileY:x}=this._mapCoordToOverlappingTile(t,o,c,g),w=m.getHeightAtTileCoord(v,x);if(w&&!w.hidden)return w.height===void 0&&u!==void 0?Math.min(w.maxHeight,u)*w.verticalScale:(w.height||0)*w.verticalScale}return-1}}var yU=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function kre(r,t){const o={};for(const c in r)c!=="ref"&&(o[c]=r[c]);return yU.forEach(c=>{c in t&&(o[c]=t[c])}),o}function vU(r){r=r.slice();const t=Object.create(null);for(let o=0;o<r.length;o++)t[r[o].id]=r[o];for(let o=0;o<r.length;o++)"ref"in r[o]&&(r[o]=kre(r[o],t[r[o].ref]));return r}const Wi={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setCamera:"setCamera",setLights:"setLights",setProjection:"setProjection",addImport:"addImport",removeImport:"removeImport",setImportUrl:"setImportUrl",setImportData:"setImportData"};function _U(r,t,o){o.push({command:Wi.addSource,args:[r,t[r]]})}function xU(r,t,o){t.push({command:Wi.removeSource,args:[r]}),o[r]=!0}function Dre(r,t,o,c){xU(r,o,c),_U(r,t,o)}function zre(r,t,o){let c;for(c in r[o])if(r[o].hasOwnProperty(c)&&c!=="data"&&!Q(r[o][c],t[o][c]))return!1;for(c in t[o])if(t[o].hasOwnProperty(c)&&c!=="data"&&!Q(r[o][c],t[o][c]))return!1;return!0}function F2(r,t,o,c,u,h){let m;for(m in t=t||{},r=r||{})r.hasOwnProperty(m)&&(Q(r[m],t[m])||o.push({command:h,args:[c,m,t[m],u]}));for(m in t)t.hasOwnProperty(m)&&!r.hasOwnProperty(m)&&(Q(r[m],t[m])||o.push({command:h,args:[c,m,t[m],u]}))}function B2(r){return r.id}function U2(r,t){return r[t.id]=t,r}class Ore{constructor(t,o){this.reset(t,o)}reset(t,o){this.points=t||[],this._distances=[0];for(let c=1;c<this.points.length;c++)this._distances[c]=this._distances[c-1]+this.points[c].dist(this.points[c-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(o||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(t){if(this.points.length===1)return this.points[0];t=re(t,0,1);let o=1,c=this._distances[o];const u=t*this.paddedLength+this.padding;for(;c<u&&o<this._distances.length;)c=this._distances[++o];const h=o-1,m=this._distances[h],g=c-m,v=g>0?(u-m)/g:0;return this.points[h].mult(1-v).add(this.points[o].mult(v))}}class bU{constructor(t,o,c){const u=this.boxCells=[],h=this.circleCells=[];this.xCellCount=Math.ceil(t/c),this.yCellCount=Math.ceil(o/c);for(let m=0;m<this.xCellCount*this.yCellCount;m++)u.push([]),h.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=t,this.height=o,this.xScale=this.xCellCount/t,this.yScale=this.yCellCount/o,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(t,o,c,u,h){this._forEachCell(o,c,u,h,this._insertBoxCell,this.boxUid++),this.boxKeys.push(t),this.bboxes.push(o),this.bboxes.push(c),this.bboxes.push(u),this.bboxes.push(h)}insertCircle(t,o,c,u){this._forEachCell(o-u,c-u,o+u,c+u,this._insertCircleCell,this.circleUid++),this.circleKeys.push(t),this.circles.push(o),this.circles.push(c),this.circles.push(u)}_insertBoxCell(t,o,c,u,h,m){this.boxCells[h].push(m)}_insertCircleCell(t,o,c,u,h,m){this.circleCells[h].push(m)}_query(t,o,c,u,h,m){if(c<0||t>this.width||u<0||o>this.height)return!h&&[];const g=[];if(t<=0&&o<=0&&this.width<=c&&this.height<=u){if(h)return!0;for(let v=0;v<this.boxKeys.length;v++)g.push({key:this.boxKeys[v],x1:this.bboxes[4*v],y1:this.bboxes[4*v+1],x2:this.bboxes[4*v+2],y2:this.bboxes[4*v+3]});for(let v=0;v<this.circleKeys.length;v++){const x=this.circles[3*v],w=this.circles[3*v+1],E=this.circles[3*v+2];g.push({key:this.circleKeys[v],x1:x-E,y1:w-E,x2:x+E,y2:w+E})}return m?g.filter(m):g}return this._forEachCell(t,o,c,u,this._queryCell,g,{hitTest:h,seenUids:{box:{},circle:{}}},m),h?g.length>0:g}_queryCircle(t,o,c,u,h){const m=t-c,g=t+c,v=o-c,x=o+c;if(g<0||m>this.width||x<0||v>this.height)return!u&&[];const w=[];return this._forEachCell(m,v,g,x,this._queryCellCircle,w,{hitTest:u,circle:{x:t,y:o,radius:c},seenUids:{box:{},circle:{}}},h),u?w.length>0:w}query(t,o,c,u,h){return this._query(t,o,c,u,!1,h)}hitTest(t,o,c,u,h){return this._query(t,o,c,u,!0,h)}hitTestCircle(t,o,c,u){return this._queryCircle(t,o,c,!0,u)}_queryCell(t,o,c,u,h,m,g,v){const x=g.seenUids,w=this.boxCells[h];if(w!==null){const C=this.bboxes;for(const I of w)if(!x.box[I]){x.box[I]=!0;const D=4*I;if(t<=C[D+2]&&o<=C[D+3]&&c>=C[D+0]&&u>=C[D+1]&&(!v||v(this.boxKeys[I]))){if(g.hitTest)return m.push(!0),!0;m.push({key:this.boxKeys[I],x1:C[D],y1:C[D+1],x2:C[D+2],y2:C[D+3]})}}}const E=this.circleCells[h];if(E!==null){const C=this.circles;for(const I of E)if(!x.circle[I]){x.circle[I]=!0;const D=3*I;if(this._circleAndRectCollide(C[D],C[D+1],C[D+2],t,o,c,u)&&(!v||v(this.circleKeys[I]))){if(g.hitTest)return m.push(!0),!0;{const N=C[D],W=C[D+1],V=C[D+2];m.push({key:this.circleKeys[I],x1:N-V,y1:W-V,x2:N+V,y2:W+V})}}}}}_queryCellCircle(t,o,c,u,h,m,g,v){const x=g.circle,w=g.seenUids,E=this.boxCells[h];if(E!==null){const I=this.bboxes;for(const D of E)if(!w.box[D]){w.box[D]=!0;const N=4*D;if(this._circleAndRectCollide(x.x,x.y,x.radius,I[N+0],I[N+1],I[N+2],I[N+3])&&(!v||v(this.boxKeys[D])))return m.push(!0),!0}}const C=this.circleCells[h];if(C!==null){const I=this.circles;for(const D of C)if(!w.circle[D]){w.circle[D]=!0;const N=3*D;if(this._circlesCollide(I[N],I[N+1],I[N+2],x.x,x.y,x.radius)&&(!v||v(this.circleKeys[D])))return m.push(!0),!0}}}_forEachCell(t,o,c,u,h,m,g,v){const x=this._convertToXCellCoord(t),w=this._convertToYCellCoord(o),E=this._convertToXCellCoord(c),C=this._convertToYCellCoord(u);for(let I=x;I<=E;I++)for(let D=w;D<=C;D++)if(h.call(this,t,o,c,u,this.xCellCount*D+I,m,g,v))return}_convertToXCellCoord(t){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(t*this.xScale)))}_convertToYCellCoord(t){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(t*this.yScale)))}_circlesCollide(t,o,c,u,h,m){const g=u-t,v=h-o,x=c+m;return x*x>g*g+v*v}_circleAndRectCollide(t,o,c,u,h,m,g){const v=(m-u)/2,x=Math.abs(t-(u+v));if(x>v+c)return!1;const w=(g-h)/2,E=Math.abs(o-(h+w));if(E>w+c)return!1;if(x<=v||E<=w)return!0;const C=x-v,I=E-w;return C*C+I*I<=c*c}}const nd=100;class Nre{constructor(t,o,c=new bU(t.width+200,t.height+200,25),u=new bU(t.width+200,t.height+200,25)){this.transform=t,this.grid=c,this.ignoredGrid=u,this.pitchfactor=Math.cos(t._pitch)*t.cameraToCenterDistance,this.screenRightBoundary=t.width+nd,this.screenBottomBoundary=t.height+nd,this.gridRightBoundary=t.width+200,this.gridBottomBoundary=t.height+200,this.fogState=o}placeCollisionBox(t,o,c,u,h,m,g,v){let x=c.projectedAnchorX,w=c.projectedAnchorY,E=c.projectedAnchorZ;const C=c.elevation,I=c.tileID,D=t.getProjection();if(C&&I){const[J,ae,ce]=D.upVector(I.canonical,c.tileAnchorX,c.tileAnchorY),ge=D.upVectorScale(I.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;x+=J*C*ge,w+=ae*C*ge,E+=ce*C*ge}const N=this.projectAndGetPerspectiveRatio(g,x,w,E,c.tileID,D.name==="globe"||!!C||this.transform.pitch>0,D),W=m*N.perspectiveRatio,V=(c.x1*o+u.x-c.padding)*W+N.point.x,q=(c.y1*o+u.y-c.padding)*W+N.point.y,Z=(c.x2*o+u.x+c.padding)*W+N.point.x,K=(c.y2*o+u.y+c.padding)*W+N.point.y,X=N.perspectiveRatio<=.55||N.occluded;return!this.isInsideGrid(V,q,Z,K)||!h&&this.grid.hitTest(V,q,Z,K,v)||X?{box:[],offscreen:!1,occluded:N.occluded}:{box:[V,q,Z,K],offscreen:this.isOffscreen(V,q,Z,K),occluded:!1}}placeCollisionCircles(t,o,c,u,h,m,g,v,x,w,E,C,I,D,N){const W=[],V=this.transform.elevation,q=t.getProjection(),Z=V?V.getAtTileOffsetFunc(N,this.transform.center.lat,this.transform.worldSize,q):null,K=new G(c.tileAnchorX,c.tileAnchorY);let{x:X,y:J,z:ae}=q.projectTilePoint(K.x,K.y,N.canonical);if(Z){const[nt,Ve,je]=Z(K);X+=nt,J+=Ve,ae+=je}const ce=q.name==="globe",ge=this.projectAndGetPerspectiveRatio(g,X,J,ae,N,ce||!!V||this.transform.pitch>0,q),{perspectiveRatio:ve}=ge,Pe=(E?m/ve:m*ve)/ao,Me=nu(X,J,ae,v),Le=ge.signedDistanceFromCamera>0?QB(Pe,h,c.lineOffsetX*Pe,c.lineOffsetY*Pe,!1,Me,K,c,u,v,{},V&&!E?Z:null,E&&!!V,q,N,E):null;let Ee=!1,He=!1,Ke=!0;if(Le&&!ge.occluded){const nt=.5*I*ve+D,Ve=new G(-100,-100),je=new G(this.screenRightBoundary,this.screenBottomBoundary),ot=new Ore,{first:yt,last:ft}=Le,Lt=yt.path.length;let Ft=[];for(let rn=Lt-1;rn>=1;rn--)Ft.push(yt.path[rn]);for(let rn=1;rn<ft.path.length;rn++)Ft.push(ft.path[rn]);const St=2.5*nt;x&&(Ft=Ft.map(([rn,ln,sn],un)=>(Z&&!ce&&(sn=Z(un<Lt-1?yt.tilePath[Lt-1-un]:ft.tilePath[un-Lt+2])[2]),nu(rn,ln,sn,x))),Ft.some(rn=>rn[3]<=0)&&(Ft=[]));let Ct=[];if(Ft.length>0){let rn=1/0,ln=-1/0,sn=1/0,un=-1/0;for(const vn of Ft)rn=Math.min(rn,vn[0]),sn=Math.min(sn,vn[1]),ln=Math.max(ln,vn[0]),un=Math.max(un,vn[1]);ln>=Ve.x&&rn<=je.x&&un>=Ve.y&&sn<=je.y&&(Ct=[Ft.map(vn=>new G(vn[0],vn[1]))],(rn<Ve.x||ln>je.x||sn<Ve.y||un>je.y)&&(Ct=SB(Ct,Ve.x,Ve.y,je.x,je.y)))}for(const rn of Ct){ot.reset(rn,.25*nt);let ln=0;ln=ot.length<=.5*nt?1:Math.ceil(ot.paddedLength/St)+1;for(let sn=0;sn<ln;sn++){const un=sn/Math.max(ln-1,1),vn=ot.lerp(un),zn=vn.x+nd,ai=vn.y+nd;W.push(zn,ai,nt,0);const Ai=zn-nt,Xn=ai-nt,Gn=zn+nt,Ln=ai+nt;if(Ke=Ke&&this.isOffscreen(Ai,Xn,Gn,Ln),He=He||this.isInsideGrid(Ai,Xn,Gn,Ln),!o&&this.grid.hitTestCircle(zn,ai,nt,C)&&(Ee=!0,!w))return{circles:[],offscreen:!1,collisionDetected:Ee,occluded:!1}}}}return{circles:!w&&Ee||!He?[]:W,offscreen:Ke,collisionDetected:Ee,occluded:ge.occluded}}queryRenderedSymbols(t){if(t.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const o=[];let c=1/0,u=1/0,h=-1/0,m=-1/0;for(const w of t){const E=new G(w.x+nd,w.y+nd);c=Math.min(c,E.x),u=Math.min(u,E.y),h=Math.max(h,E.x),m=Math.max(m,E.y),o.push(E)}const g=this.grid.query(c,u,h,m).concat(this.ignoredGrid.query(c,u,h,m)),v={},x={};for(const w of g){const E=w.key;v[E.bucketInstanceId]===void 0&&(v[E.bucketInstanceId]={}),v[E.bucketInstanceId][E.featureIndex]||MF(o,[new G(w.x1,w.y1),new G(w.x2,w.y1),new G(w.x2,w.y2),new G(w.x1,w.y2)])&&(v[E.bucketInstanceId][E.featureIndex]=!0,x[E.bucketInstanceId]===void 0&&(x[E.bucketInstanceId]=[]),x[E.bucketInstanceId].push(E.featureIndex))}return x}insertCollisionBox(t,o,c,u,h){(o?this.ignoredGrid:this.grid).insert({bucketInstanceId:c,featureIndex:u,collisionGroupID:h},t[0],t[1],t[2],t[3])}insertCollisionCircles(t,o,c,u,h){const m=o?this.ignoredGrid:this.grid,g={bucketInstanceId:c,featureIndex:u,collisionGroupID:h};for(let v=0;v<t.length;v+=4)m.insertCircle(g,t[v],t[v+1],t[v+2])}projectAndGetPerspectiveRatio(t,o,c,u,h,m,g){const v=[o,c,u,1];let x=!1;u||this.transform.pitch>0?(Yi.transformMat4(v,v,t),this.fogState&&h&&g.name!=="globe"&&(x=function(C,I,D,N,W,V){const q=V.calculateFogTileMatrix(W),Z=[I,D,N];return De.transformMat4(Z,Z,q),O2(C,De.length(Z),V.pitch,V._fov)}(this.fogState,o,c,u,h.toUnwrapped(),this.transform)>.9)):r6(v,v,t);const w=v[3];return{point:new G((v[0]/w+1)/2*this.transform.width+nd,(-v[1]/w+1)/2*this.transform.height+nd),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(g)/w*.5,1.5),signedDistanceFromCamera:w,occluded:m&&v[2]>w||x}}isOffscreen(t,o,c,u){return c<nd||t>=this.screenRightBoundary||u<nd||o>this.screenBottomBoundary}isInsideGrid(t,o,c,u){return c>=0&&t<this.gridRightBoundary&&u>=0&&o<this.gridBottomBoundary}getViewportMatrix(){const t=at.identity([]);return at.translate(t,t,[-100,-100,0]),t}}function MI(r,t,o){const c=t.createTileMatrix(r,r.worldSize,o.toUnwrapped());return at.multiply(new Float32Array(16),r.projMatrix,c)}function Fre(r,t,o){if(t.projection.name===o.projection.name)return r.projMatrix;const c=o.clone();return c.setProjection(t.projection),MI(c,t.getProjection(),r)}function TI(r,t,o){return t.name===o.projection.name?r.projMatrix:MI(o,t,r)}class wU{constructor(t,o,c,u){this.opacity=t?Math.max(0,Math.min(1,t.opacity+(t.placed?o:-o))):u&&c?1:0,this.placed=c}isHidden(){return this.opacity===0&&!this.placed}}class Y1{constructor(t,o,c,u,h,m=!1){this.text=new wU(t?t.text:null,o,c,h),this.icon=new wU(t?t.icon:null,o,u,h),this.clipped=m}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class AI{constructor(t,o,c,u=!1){this.text=t,this.icon=o,this.skipFade=c,this.clipped=u}}class Bre{constructor(){this.invProjMatrix=at.create(),this.viewportMatrix=at.create(),this.circles=[]}}class Ure{constructor(t,o,c,u,h){this.bucketInstanceId=t,this.featureIndex=o,this.sourceLayerIndex=c,this.bucketIndex=u,this.tileID=h}}class Wre{constructor(t){this.crossSourceCollisions=t,this.maxGroupID=0,this.collisionGroups={}}get(t){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[t]){const o=++this.maxGroupID;this.collisionGroups[t]={ID:o,predicate:c=>c.collisionGroupID===o}}return this.collisionGroups[t]}}function SU(r,t,o,c,u){const{horizontalAlign:h,verticalAlign:m}=c2(r),g=-(h-.5)*t,v=-(m-.5)*o,x=HP(r,c);return new G(g+x[0]*u,v+x[1]*u)}function CI(r,t,o,c,u){const h=new G(r,t);return o&&h._rotate(c?u:-u),h}class Vre{constructor(t,o,c,u,h,m){this.transform=t.clone(),this.projection=t.projection.name,this.collisionIndex=new Nre(this.transform,h),this.buildingIndex=m,this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=o,this.retainedQueryData={},this.collisionGroups=new Wre(c),this.collisionCircleArrays={},this.prevPlacement=u,u&&(u.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(t,o,c,u){const h=c.getBucket(o),m=c.latestFeatureIndex;if(!h||!m||o.fqid!==h.layerIds[0])return;const g=h.layers[0].layout,v=c.collisionBoxArray,x=Math.pow(2,this.transform.zoom-c.tileID.overscaledZ),w=c.tileSize/mt,E=c.tileID.toUnwrapped();this.transform.setProjection(h.projection);const C=(I=c.tileID,D=h.getProjection(),N=this.transform,D.name===this.projection?N.calculateProjMatrix(I.toUnwrapped()):MI(N,D,I));var I,D,N;const W=g.get("text-pitch-alignment")==="map",V=g.get("text-rotation-alignment")==="map";o.compileFilter();const q=o.dynamicFilter(),Z=o.dynamicFilterNeedsFeature(),K=this.transform.calculatePixelsToTileUnitsMatrix(c),X=ZB(C,c.tileID.canonical,W,V,this.transform,h.getProjection(),K);let J=null;if(W){const ge=KB(C,c.tileID.canonical,W,V,this.transform,h.getProjection(),K);J=at.multiply([],this.transform.labelPlaneMatrix,ge)}let ae=null;q&&c.latestFeatureIndex&&(ae={unwrappedTileID:E,dynamicFilter:q,dynamicFilterNeedsFeature:Z,featureIndex:c.latestFeatureIndex}),this.retainedQueryData[h.bucketInstanceId]=new Ure(h.bucketInstanceId,m,h.sourceLayerIndex,h.index,c.tileID);const ce={bucket:h,layout:g,posMatrix:C,textLabelPlaneMatrix:X,labelToScreenMatrix:J,clippingData:ae,scale:x,textPixelRatio:w,holdingForFade:c.holdingForFade(),collisionBoxArray:v,partiallyEvaluatedTextSize:Ku(h.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:Ku(h.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(h.sourceID)};if(u)for(const ge of h.sortKeyRanges){const{sortKey:ve,symbolInstanceStart:Pe,symbolInstanceEnd:Me}=ge;t.push({sortKey:ve,symbolInstanceStart:Pe,symbolInstanceEnd:Me,parameters:ce})}else t.push({symbolInstanceStart:0,symbolInstanceEnd:h.symbolInstances.length,parameters:ce})}attemptAnchorPlacement(t,o,c,u,h,m,g,v,x,w,E,C,I,D,N,W,V,q){const{textOffset0:Z,textOffset1:K,crossTileID:X}=C,J=[Z,K],ae=SU(t,c,u,J,h),ce=this.collisionIndex.placeCollisionBox(D,h,o,CI(ae.x,ae.y,m,g,this.transform.angle),E,v,x,w.predicate);if(W){const ge=D.getSymbolInstanceIconSize(q,this.transform.zoom,C.placedIconSymbolIndex);if(this.collisionIndex.placeCollisionBox(D,ge,W,CI(ae.x,ae.y,m,g,this.transform.angle),E,v,x,w.predicate).box.length===0)return}if(ce.box.length>0){let ge;return this.prevPlacement&&this.prevPlacement.variableOffsets[X]&&this.prevPlacement.placements[X]&&this.prevPlacement.placements[X].text&&(ge=this.prevPlacement.variableOffsets[X].anchor),this.variableOffsets[X]={textOffset:J,width:c,height:u,anchor:t,textScale:h,prevAnchor:ge},this.markUsedJustification(D,t,C,N),D.allowVerticalPlacement&&(this.markUsedOrientation(D,N,C),this.placedOrientations[X]=N),{shift:ae,placedGlyphBoxes:ce}}}placeLayerBucketPart(t,o,c,u){const{bucket:h,layout:m,posMatrix:g,textLabelPlaneMatrix:v,labelToScreenMatrix:x,clippingData:w,textPixelRatio:E,holdingForFade:C,collisionBoxArray:I,partiallyEvaluatedTextSize:D,partiallyEvaluatedIconSize:N,collisionGroup:W}=t.parameters,V=m.get("text-optional"),q=m.get("icon-optional"),Z=m.get("text-allow-overlap"),K=m.get("icon-allow-overlap"),X=m.get("text-rotation-alignment")==="map",J=m.get("text-pitch-alignment")==="map",ae=m.get("symbol-z-order")==="viewport-y",ce=m.get("symbol-z-elevate");this.transform.setProjection(h.projection);let ge=Z&&(K||!h.hasIconData()||q),ve=K&&(Z||!h.hasTextData()||V);!h.collisionArrays&&I&&h.deserializeCollisionBoxes(I),c&&u&&h.updateCollisionDebugBuffers(this.transform.zoom,I);const Pe=(Me,Le,Ee)=>{const{crossTileID:He,numVerticalGlyphVertices:Ke}=Me;if(w){const Gn={zoom:this.transform.zoom,pitch:this.transform.pitch};let Ln=null;if(w.dynamicFilterNeedsFeature){const An=this.retainedQueryData[h.bucketInstanceId];Ln=w.featureIndex.loadFeature({featureIndex:Me.featureIndex,bucketIndex:An.bucketIndex,sourceLayerIndex:An.sourceLayerIndex,layoutVertexArrayOffset:0})}if(!(0,w.dynamicFilter)(Gn,Ln,this.retainedQueryData[h.bucketInstanceId].tileID.canonical,new G(Me.tileAnchorX,Me.tileAnchorY),this.transform.calculateDistanceTileData(w.unwrappedTileID)))return this.placements[He]=new AI(!1,!1,!1,!0),void o.add(He)}if(o.has(He))return;if(C)return void(this.placements[He]=new AI(!1,!1,!1));let nt=!1,Ve=!1,je=!0,ot=!1,yt=!1,ft=null,Lt={box:null,offscreen:null,occluded:null},Ft={box:null,offscreen:null,occluded:null},St=null,Ct=null,rn=null,ln=0,sn=0,un=0;Ee.textFeatureIndex?ln=Ee.textFeatureIndex:Me.useRuntimeCollisionCircles&&(ln=Me.featureIndex),Ee.verticalTextFeatureIndex&&(sn=Ee.verticalTextFeatureIndex);const vn=Gn=>{Gn.tileID=this.retainedQueryData[h.bucketInstanceId].tileID;const Ln=this.transform.elevation;Gn.elevation=Me.zOffset+(Ln?Ln.getAtTileOffset(Gn.tileID,Gn.tileAnchorX,Gn.tileAnchorY):0)},zn=Ee.textBox;if(zn){vn(zn);const Gn=An=>{let vi=Ar.horizontal;if(h.allowVerticalPlacement&&!An&&this.prevPlacement){const Li=this.prevPlacement.placedOrientations[He];Li&&(this.placedOrientations[He]=Li,vi=Li,this.markUsedOrientation(h,vi,Me))}return vi},Ln=(An,vi)=>{if(h.allowVerticalPlacement&&Ke>0&&Ee.verticalTextBox){for(const Li of h.writingModes)if(Li===Ar.vertical?(Lt=vi(),Ft=Lt):Lt=An(),Lt&&Lt.box&&Lt.box.length)break}else Lt=An()};if(m.get("text-variable-anchor")){let An=m.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[He]){const ri=this.prevPlacement.variableOffsets[He];An.indexOf(ri.anchor)>0&&(An=An.filter(Ji=>Ji!==ri.anchor),An.unshift(ri.anchor))}const vi=(ri,Ji,Cr)=>{const hr=h.getSymbolInstanceTextSize(D,Me,this.transform.zoom,Le),or=(ri.x2-ri.x1)*hr+2*ri.padding,ca=(ri.y2-ri.y1)*hr+2*ri.padding,Pr=Me.hasIconTextFit&&!K?Ji:null;Pr&&vn(Pr);let Wr={box:[],offscreen:!1,occluded:!1};const Qi=Z?2*An.length:An.length;for(let ps=0;ps<Qi;++ps){const rd=this.attemptAnchorPlacement(An[ps%An.length],ri,or,ca,hr,X,J,E,g,W,ps>=An.length,Me,Le,h,Cr,Pr,D,N);if(rd&&(Wr=rd.placedGlyphBoxes,Wr&&Wr.box&&Wr.box.length)){nt=!0,ft=rd.shift;break}}return Wr};Ln(()=>vi(zn,Ee.iconBox,Ar.horizontal),()=>{const ri=Ee.verticalTextBox;return ri&&vn(ri),h.allowVerticalPlacement&&!(Lt&&Lt.box&&Lt.box.length)&&Ke>0&&ri?vi(ri,Ee.verticalIconBox,Ar.vertical):{box:null,offscreen:null,occluded:null}}),Lt&&(nt=Lt.box,je=Lt.offscreen,ot=Lt.occluded);const Li=Gn(!(!Lt||!Lt.box));if(!nt&&this.prevPlacement){const ri=this.prevPlacement.variableOffsets[He];ri&&(this.variableOffsets[He]=ri,this.markUsedJustification(h,ri.anchor,Me,Li))}}else{const An=(vi,Li)=>{const ri=h.getSymbolInstanceTextSize(D,Me,this.transform.zoom,Le),Ji=this.collisionIndex.placeCollisionBox(h,ri,vi,new G(0,0),Z,E,g,W.predicate);return Ji&&Ji.box&&Ji.box.length&&(this.markUsedOrientation(h,Li,Me),this.placedOrientations[He]=Li),Ji};Ln(()=>An(zn,Ar.horizontal),()=>{const vi=Ee.verticalTextBox;return h.allowVerticalPlacement&&Ke>0&&vi?(vn(vi),An(vi,Ar.vertical)):{box:null,offscreen:null,occluded:null}}),Gn(!!(Lt&&Lt.box&&Lt.box.length))}}if(St=Lt,nt=St&&St.box&&St.box.length>0,je=St&&St.offscreen,ot=St&&St.occluded,Me.useRuntimeCollisionCircles){const Gn=h.text.placedSymbolArray.get(Me.centerJustifiedTextSymbolIndex>=0?Me.centerJustifiedTextSymbolIndex:Me.verticalPlacedTextSymbolIndex),Ln=S1(h.textSizeData,D,Gn),An=m.get("text-padding");Ct=this.collisionIndex.placeCollisionCircles(h,Z,Gn,h.lineVertexArray,h.glyphOffsetArray,Ln,g,v,x,c,J,W.predicate,Me.collisionCircleDiameter*Ln/ao,An,this.retainedQueryData[h.bucketInstanceId].tileID),nt=Z||Ct.circles.length>0&&!Ct.collisionDetected,je=je&&Ct.offscreen,ot=Ct.occluded}if(Ee.iconFeatureIndex&&(un=Ee.iconFeatureIndex),Ee.iconBox){const Gn=Ln=>{vn(Ln);const An=Me.hasIconTextFit&&ft?CI(ft.x,ft.y,X,J,this.transform.angle):new G(0,0),vi=h.getSymbolInstanceIconSize(N,this.transform.zoom,Me.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(h,vi,Ln,An,K,E,g,W.predicate)};Ft&&Ft.box&&Ft.box.length&&Ee.verticalIconBox?(rn=Gn(Ee.verticalIconBox),Ve=rn.box.length>0):(rn=Gn(Ee.iconBox),Ve=rn.box.length>0),je=je&&rn.offscreen,yt=rn.occluded}const ai=V||Me.numHorizontalGlyphVertices===0&&Ke===0,Ai=q||Me.numIconVertices===0;if(ai||Ai?Ai?ai||(Ve=Ve&&nt):nt=Ve&&nt:Ve=nt=Ve&&nt,nt&&St&&St.box&&this.collisionIndex.insertCollisionBox(St.box,m.get("text-ignore-placement"),h.bucketInstanceId,Ft&&Ft.box&&sn?sn:ln,W.ID),Ve&&rn&&this.collisionIndex.insertCollisionBox(rn.box,m.get("icon-ignore-placement"),h.bucketInstanceId,un,W.ID),Ct&&(nt&&this.collisionIndex.insertCollisionCircles(Ct.circles,m.get("text-ignore-placement"),h.bucketInstanceId,ln,W.ID),c)){const Gn=h.bucketInstanceId;let Ln=this.collisionCircleArrays[Gn];Ln===void 0&&(Ln=this.collisionCircleArrays[Gn]=new Bre);for(let An=0;An<Ct.circles.length;An+=4)Ln.circles.push(Ct.circles[An+0]),Ln.circles.push(Ct.circles[An+1]),Ln.circles.push(Ct.circles[An+2]),Ln.circles.push(Ct.collisionDetected?1:0)}const Xn=h.projection.name!=="globe";ge=ge&&(Xn||!ot),ve=ve&&(Xn||!yt),this.placements[He]=new AI(nt||ge,Ve||ve,je||h.justReloaded),o.add(He)};if(ce&&this.buildingIndex&&(this.buildingIndex.updateZOffset(h,this.retainedQueryData[h.bucketInstanceId].tileID),h.updateZOffset()),ae){const Me=h.getSortedSymbolIndexes(this.transform.angle);for(let Le=Me.length-1;Le>=0;--Le){const Ee=Me[Le];Pe(h.symbolInstances.get(Ee),Ee,h.collisionArrays[Ee])}h.hasAnyZOffset&&xe(`${h.layerIds[0]} layer symbol-z-elevate: symbols are not sorted by elevation if symbol-z-order is evaluated to viewport-y`)}else if(h.hasAnyZOffset){const Me=h.getSortedIndexesByZOffset();for(let Le=0;Le<Me.length;++Le){const Ee=Me[Le];Pe(h.symbolInstances.get(Ee),Ee,h.collisionArrays[Ee])}}else for(let Me=t.symbolInstanceStart;Me<t.symbolInstanceEnd;Me++)Pe(h.symbolInstances.get(Me),Me,h.collisionArrays[Me]);if(c&&h.bucketInstanceId in this.collisionCircleArrays){const Me=this.collisionCircleArrays[h.bucketInstanceId];at.invert(Me.invProjMatrix,g),Me.viewportMatrix=this.collisionIndex.getViewportMatrix()}h.justReloaded=!1}markUsedJustification(t,o,c,u){const{leftJustifiedTextSymbolIndex:h,centerJustifiedTextSymbolIndex:m,rightJustifiedTextSymbolIndex:g,verticalPlacedTextSymbolIndex:v,crossTileID:x}=c,w=jP(o),E=u===Ar.vertical?v:w==="left"?h:w==="center"?m:w==="right"?g:-1;h>=0&&(t.text.placedSymbolArray.get(h).crossTileID=E>=0&&h!==E?0:x),m>=0&&(t.text.placedSymbolArray.get(m).crossTileID=E>=0&&m!==E?0:x),g>=0&&(t.text.placedSymbolArray.get(g).crossTileID=E>=0&&g!==E?0:x),v>=0&&(t.text.placedSymbolArray.get(v).crossTileID=E>=0&&v!==E?0:x)}markUsedOrientation(t,o,c){const u=o===Ar.horizontal||o===Ar.horizontalOnly?o:0,h=o===Ar.vertical?o:0,{leftJustifiedTextSymbolIndex:m,centerJustifiedTextSymbolIndex:g,rightJustifiedTextSymbolIndex:v,verticalPlacedTextSymbolIndex:x}=c,w=t.text.placedSymbolArray;m>=0&&(w.get(m).placedOrientation=u),g>=0&&(w.get(g).placedOrientation=u),v>=0&&(w.get(v).placedOrientation=u),x>=0&&(w.get(x).placedOrientation=h)}commit(t){this.commitTime=t,this.zoomAtLastRecencyCheck=this.transform.zoom;const o=this.prevPlacement;let c=!1;this.prevZoomAdjustment=o?o.zoomAdjustment(this.transform.zoom):0;const u=o?o.symbolFadeChange(t):1,h=o?o.opacities:{},m=o?o.variableOffsets:{},g=o?o.placedOrientations:{};for(const v in this.placements){const x=this.placements[v],w=h[v];w?(this.opacities[v]=new Y1(w,u,x.text,x.icon,null,x.clipped),c=c||x.text!==w.text.placed||x.icon!==w.icon.placed):(this.opacities[v]=new Y1(null,u,x.text,x.icon,x.skipFade,x.clipped),c=c||x.text||x.icon)}for(const v in h){const x=h[v];if(!this.opacities[v]){const w=new Y1(x,u,!1,!1);w.isHidden()||(this.opacities[v]=w,c=c||x.text.placed||x.icon.placed)}}for(const v in m)this.variableOffsets[v]||!this.opacities[v]||this.opacities[v].isHidden()||(this.variableOffsets[v]=m[v]);for(const v in g)this.placedOrientations[v]||!this.opacities[v]||this.opacities[v].isHidden()||(this.placedOrientations[v]=g[v]);c?this.lastPlacementChangeTime=t:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=o?o.lastPlacementChangeTime:t)}updateLayerOpacities(t,o){const c=new Set;for(const u of o){const h=u.getBucket(t);h&&u.latestFeatureIndex&&t.fqid===h.layerIds[0]&&(this.updateBucketOpacities(h,c,u.collisionBoxArray),h.layers[0].layout.get("symbol-z-elevate")&&this.buildingIndex&&(this.buildingIndex.updateZOffset(h,u.tileID),h.updateZOffset()))}}updateBucketOpacities(t,o,c){t.hasTextData()&&t.text.opacityVertexArray.clear(),t.hasIconData()&&t.icon.opacityVertexArray.clear(),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexArray.clear(),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexArray.clear();const u=t.layers[0].layout,h=!!t.layers[0].dynamicFilter(),m=new Y1(null,0,!1,!1,!0),g=u.get("text-allow-overlap"),v=u.get("icon-allow-overlap"),x=u.get("text-variable-anchor"),w=u.get("text-rotation-alignment")==="map",E=u.get("text-pitch-alignment")==="map",C=new Y1(null,0,g&&(v||!t.hasIconData()||u.get("icon-optional")),v&&(g||!t.hasTextData()||u.get("text-optional")),!0);!t.collisionArrays&&c&&(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData())&&t.deserializeCollisionBoxes(c);const I=(N,W,V)=>{for(let q=0;q<W/4;q++)N.opacityVertexArray.emplaceBack(V)};let D=0;for(let N=0;N<t.symbolInstances.length;N++){const W=t.symbolInstances.get(N),{numHorizontalGlyphVertices:V,numVerticalGlyphVertices:q,crossTileID:Z,numIconVertices:K}=W,X=o.has(Z);let J=this.opacities[Z];X?J=m:J||(J=C,this.opacities[Z]=J),o.add(Z);const ae=V>0||q>0,ce=K>0,ge=this.placedOrientations[Z],ve=ge===Ar.vertical,Pe=ge===Ar.horizontal||ge===Ar.horizontalOnly;if(!ae&&!ce||J.isHidden()||D++,ae){const Me=EU(J.text);I(t.text,V,ve?V2:Me),I(t.text,q,Pe?V2:Me);const Le=J.text.isHidden(),{leftJustifiedTextSymbolIndex:Ee,centerJustifiedTextSymbolIndex:He,rightJustifiedTextSymbolIndex:Ke,verticalPlacedTextSymbolIndex:nt}=W,Ve=t.text.placedSymbolArray,je=Le||ve?1:0;Ee>=0&&(Ve.get(Ee).hidden=je),He>=0&&(Ve.get(He).hidden=je),Ke>=0&&(Ve.get(Ke).hidden=je),nt>=0&&(Ve.get(nt).hidden=Le||Pe?1:0);const ot=this.variableOffsets[Z];ot&&this.markUsedJustification(t,ot.anchor,W,ge);const yt=this.placedOrientations[Z];yt&&(this.markUsedJustification(t,"left",W,yt),this.markUsedOrientation(t,yt,W))}if(ce){const Me=EU(J.icon),{placedIconSymbolIndex:Le,verticalPlacedIconSymbolIndex:Ee}=W,He=t.icon.placedSymbolArray,Ke=J.icon.isHidden()?1:0;Le>=0&&(I(t.icon,K,ve?V2:Me),He.get(Le).hidden=Ke),Ee>=0&&(I(t.icon,W.numVerticalIconVertices,Pe?V2:Me),He.get(Ee).hidden=Ke)}if(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData()){const Me=t.collisionArrays[N];if(Me){let Le=new G(0,0),Ee=!0;if(Me.textBox||Me.verticalTextBox){if(x){const Ke=this.variableOffsets[Z];Ke?(Le=SU(Ke.anchor,Ke.width,Ke.height,Ke.textOffset,Ke.textScale),w&&Le._rotate(E?this.transform.angle:-this.transform.angle)):Ee=!1}h&&(Ee=!J.clipped),Me.textBox&&W2(t.textCollisionBox.collisionVertexArray,J.text.placed,!Ee||ve,Le.x,Le.y),Me.verticalTextBox&&W2(t.textCollisionBox.collisionVertexArray,J.text.placed,!Ee||Pe,Le.x,Le.y)}const He=Ee&&!!(!Pe&&Me.verticalIconBox);Me.iconBox&&W2(t.iconCollisionBox.collisionVertexArray,J.icon.placed,He,W.hasIconTextFit?Le.x:0,W.hasIconTextFit?Le.y:0),Me.verticalIconBox&&W2(t.iconCollisionBox.collisionVertexArray,J.icon.placed,!He,W.hasIconTextFit?Le.x:0,W.hasIconTextFit?Le.y:0)}}}if(t.fullyClipped=D===0,t.sortFeatures(this.transform.angle),this.retainedQueryData[t.bucketInstanceId]&&(this.retainedQueryData[t.bucketInstanceId].featureSortOrder=t.featureSortOrder),t.hasTextData()&&t.text.opacityVertexBuffer&&t.text.opacityVertexBuffer.updateData(t.text.opacityVertexArray),t.hasIconData()&&t.icon.opacityVertexBuffer&&t.icon.opacityVertexBuffer.updateData(t.icon.opacityVertexArray),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexBuffer&&t.iconCollisionBox.collisionVertexBuffer.updateData(t.iconCollisionBox.collisionVertexArray),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexBuffer&&t.textCollisionBox.collisionVertexBuffer.updateData(t.textCollisionBox.collisionVertexArray),t.bucketInstanceId in this.collisionCircleArrays){const N=this.collisionCircleArrays[t.bucketInstanceId];t.placementInvProjMatrix=N.invProjMatrix,t.placementViewportMatrix=N.viewportMatrix,t.collisionCircleArray=N.circles,delete this.collisionCircleArrays[t.bucketInstanceId]}}symbolFadeChange(t){return this.fadeDuration===0?1:(t-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(t){return Math.max(0,(this.transform.zoom-t)/1.5)}hasTransitions(t){return this.stale||t-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(t,o){const c=this.zoomAtLastRecencyCheck===o?1-this.zoomAdjustment(o):1;return this.zoomAtLastRecencyCheck=o,this.commitTime+this.fadeDuration*c>t}setStale(){this.stale=!0}}function W2(r,t,o,c,u){r.emplaceBack(t?1:0,o?1:0,c||0,u||0),r.emplaceBack(t?1:0,o?1:0,c||0,u||0),r.emplaceBack(t?1:0,o?1:0,c||0,u||0),r.emplaceBack(t?1:0,o?1:0,c||0,u||0)}const Gre=Math.pow(2,25),Hre=Math.pow(2,24),jre=Math.pow(2,17),$re=Math.pow(2,16),Yre=Math.pow(2,9),qre=Math.pow(2,8),Xre=Math.pow(2,1);function EU(r){if(r.opacity===0&&!r.placed)return 0;if(r.opacity===1&&r.placed)return 4294967295;const t=r.placed?1:0,o=Math.floor(127*r.opacity);return o*Gre+t*Hre+o*jre+t*$re+o*Yre+t*qre+o*Xre+t}const V2=0;class Zre{constructor(t){this._sortAcrossTiles=t.layout.get("symbol-z-order")!=="viewport-y"&&t.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(t,o,c,u,h){const m=this._bucketParts;for(;this._currentTileIndex<t.length;)if(o.getBucketParts(m,u,t[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,h())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,m.sort((g,v)=>g.sortKey-v.sortKey));this._currentPartIndex<m.length;){const g=m[this._currentPartIndex];if(o.placeLayerBucketPart(g,this._seenCrossTileIDs,c,g.symbolInstanceStart===0),this._currentPartIndex++,h())return!0}return!1}}class Kre{constructor(t,o,c,u,h,m,g,v,x){this.placement=new Vre(t,h,m,g,v,x),this._currentPlacementIndex=o.length-1,this._forceFullPlacement=c,this._showCollisionBoxes=u,this._done=!1}isDone(){return this._done}continuePlacement(t,o,c,u){const h=Pn.now(),m=()=>{const g=Pn.now()-h;return!this._forceFullPlacement&&g>2};for(;this._currentPlacementIndex>=0;){const g=o[t[this._currentPlacementIndex]],v=this.placement.collisionIndex.transform.zoom;if(g.type==="symbol"&&(!g.minzoom||g.minzoom<=v)&&(!g.maxzoom||g.maxzoom>v)){const x=g,w=x.layout.get("symbol-z-elevate");if(this._inProgressLayer||(this._inProgressLayer=new Zre(x)),this._inProgressLayer.continuePlacement(w?u[g.source]:c[g.source],this.placement,this._showCollisionBoxes,g,m))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(t){return this.placement.commit(t),this.placement}}const MU=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class G2{static from(t){if(!(t instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[o,c]=new Uint8Array(t,0,2);if(o!==219)throw new Error("Data does not appear to be in a KDBush format.");const u=c>>4;if(u!==1)throw new Error(`Got v${u} data when expected v1.`);const h=MU[15&c];if(!h)throw new Error("Unrecognized array type.");const[m]=new Uint16Array(t,2,1),[g]=new Uint32Array(t,4,1);return new G2(g,m,h,t)}constructor(t,o=64,c=Float64Array,u){if(isNaN(t)||t<0)throw new Error(`Unpexpected numItems value: ${t}.`);this.numItems=+t,this.nodeSize=Math.min(Math.max(+o,2),65535),this.ArrayType=c,this.IndexArrayType=t<65536?Uint16Array:Uint32Array;const h=MU.indexOf(this.ArrayType),m=2*t*this.ArrayType.BYTES_PER_ELEMENT,g=t*this.IndexArrayType.BYTES_PER_ELEMENT,v=(8-g%8)%8;if(h<0)throw new Error(`Unexpected typed array class: ${c}.`);u&&u instanceof ArrayBuffer?(this.data=u,this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+g+v,2*t),this._pos=2*t,this._finished=!0):(this.data=new ArrayBuffer(8+m+g+v),this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+g+v,2*t),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+h]),new Uint16Array(this.data,2,1)[0]=o,new Uint32Array(this.data,4,1)[0]=t)}add(t,o){const c=this._pos>>1;return this.ids[c]=c,this.coords[this._pos++]=t,this.coords[this._pos++]=o,c}finish(){const t=this._pos>>1;if(t!==this.numItems)throw new Error(`Added ${t} items when expected ${this.numItems}.`);return PI(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(t,o,c,u){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:h,coords:m,nodeSize:g}=this,v=[0,h.length-1,0],x=[];for(;v.length;){const w=v.pop()||0,E=v.pop()||0,C=v.pop()||0;if(E-C<=g){for(let W=C;W<=E;W++){const V=m[2*W],q=m[2*W+1];V>=t&&V<=c&&q>=o&&q<=u&&x.push(h[W])}continue}const I=C+E>>1,D=m[2*I],N=m[2*I+1];D>=t&&D<=c&&N>=o&&N<=u&&x.push(h[I]),(w===0?t<=D:o<=N)&&(v.push(C),v.push(I-1),v.push(1-w)),(w===0?c>=D:u>=N)&&(v.push(I+1),v.push(E),v.push(1-w))}return x}within(t,o,c){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:u,coords:h,nodeSize:m}=this,g=[0,u.length-1,0],v=[],x=c*c;for(;g.length;){const w=g.pop()||0,E=g.pop()||0,C=g.pop()||0;if(E-C<=m){for(let W=C;W<=E;W++)AU(h[2*W],h[2*W+1],t,o)<=x&&v.push(u[W]);continue}const I=C+E>>1,D=h[2*I],N=h[2*I+1];AU(D,N,t,o)<=x&&v.push(u[I]),(w===0?t-c<=D:o-c<=N)&&(g.push(C),g.push(I-1),g.push(1-w)),(w===0?t+c>=D:o+c>=N)&&(g.push(I+1),g.push(E),g.push(1-w))}return v}}function PI(r,t,o,c,u,h){if(u-c<=o)return;const m=c+u>>1;TU(r,t,m,c,u,h),PI(r,t,o,c,m-1,1-h),PI(r,t,o,m+1,u,1-h)}function TU(r,t,o,c,u,h){for(;u>c;){if(u-c>600){const x=u-c+1,w=o-c+1,E=Math.log(x),C=.5*Math.exp(2*E/3),I=.5*Math.sqrt(E*C*(x-C)/x)*(w-x/2<0?-1:1);TU(r,t,o,Math.max(c,Math.floor(o-w*C/x+I)),Math.min(u,Math.floor(o+(x-w)*C/x+I)),h)}const m=t[2*o+h];let g=c,v=u;for(q1(r,t,c,o),t[2*u+h]>m&&q1(r,t,c,u);g<v;){for(q1(r,t,g,v),g++,v--;t[2*g+h]<m;)g++;for(;t[2*v+h]>m;)v--}t[2*c+h]===m?q1(r,t,c,v):(v++,q1(r,t,v,u)),v<=o&&(c=v+1),o<=v&&(u=v-1)}}function q1(r,t,o,c){II(r,o,c),II(t,2*o,2*c),II(t,2*o+1,2*c+1)}function II(r,t,o){const c=r[t];r[t]=r[o],r[o]=c}function AU(r,t,o,c){const u=r-o,h=t-c;return u*u+h*h}const RI=512/mt/2;class Jre{constructor(t,o,c){this.tileID=t,this.bucketInstanceId=c,this.index=new G2(o.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];const u=t.canonical.x*mt,h=t.canonical.y*mt;for(let m=0;m<o.length;m++){const{key:g,crossTileID:v,tileAnchorX:x,tileAnchorY:w}=o.get(m),E=Math.floor((u+x)*RI),C=Math.floor((h+w)*RI);this.index.add(E,C),this.keys.push(g),this.crossTileIDs.push(v)}this.index.finish()}findMatches(t,o,c){const u=this.tileID.canonical.z<o.canonical.z?1:Math.pow(2,this.tileID.canonical.z-o.canonical.z),h=RI/Math.pow(2,o.canonical.z-this.tileID.canonical.z),m=o.canonical.x*mt,g=o.canonical.y*mt;for(let v=0;v<t.length;v++){const x=t.get(v);if(x.crossTileID)continue;const{key:w,tileAnchorX:E,tileAnchorY:C}=x,I=Math.floor((m+E)*h),D=Math.floor((g+C)*h),N=this.index.range(I-u,D-u,I+u,D+u);for(const W of N){const V=this.crossTileIDs[W];if(this.keys[W]===w&&!c.has(V)){c.add(V),x.crossTileID=V;break}}}}}class Qre{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class eae{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(t){const o=Math.round((t-this.lng)/360);if(o!==0)for(const c in this.indexes){const u=this.indexes[c],h={};for(const m in u){const g=u[m];g.tileID=g.tileID.unwrapTo(g.tileID.wrap+o),h[g.tileID.key]=g}this.indexes[c]=h}this.lng=t}addBucket(t,o,c){if(this.indexes[t.overscaledZ]&&this.indexes[t.overscaledZ][t.key]){if(this.indexes[t.overscaledZ][t.key].bucketInstanceId===o.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(t.overscaledZ,this.indexes[t.overscaledZ][t.key])}for(let h=0;h<o.symbolInstances.length;h++)o.symbolInstances.get(h).crossTileID=0;this.usedCrossTileIDs[t.overscaledZ]||(this.usedCrossTileIDs[t.overscaledZ]=new Set);const u=this.usedCrossTileIDs[t.overscaledZ];for(const h in this.indexes){const m=this.indexes[h];if(Number(h)>t.overscaledZ)for(const g in m){const v=m[g];v.tileID.isChildOf(t)&&v.findMatches(o.symbolInstances,t,u)}else{const g=m[t.scaledTo(Number(h)).key];g&&g.findMatches(o.symbolInstances,t,u)}}for(let h=0;h<o.symbolInstances.length;h++){const m=o.symbolInstances.get(h);m.crossTileID||(m.crossTileID=c.generate(),u.add(m.crossTileID))}return this.indexes[t.overscaledZ]===void 0&&(this.indexes[t.overscaledZ]={}),this.indexes[t.overscaledZ][t.key]=new Jre(t,o.symbolInstances,o.bucketInstanceId),!0}removeBucketCrossTileIDs(t,o){for(const c of o.crossTileIDs)this.usedCrossTileIDs[t].delete(c)}removeStaleBuckets(t){let o=!1;for(const c in this.indexes){const u=this.indexes[c];for(const h in u)t[u[h].bucketInstanceId]||(this.removeBucketCrossTileIDs(c,u[h]),delete u[h],o=!0)}return o}}class tae{constructor(){this.layerIndexes={},this.crossTileIDs=new Qre,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(t,o,c,u){let h=this.layerIndexes[t.fqid];h===void 0&&(h=this.layerIndexes[t.fqid]=new eae);let m=!1;const g={};u.name!=="globe"&&h.handleWrapJump(c);for(const v of o){const x=v.getBucket(t);x&&t.fqid===x.layerIds[0]&&(x.bucketInstanceId||(x.bucketInstanceId=++this.maxBucketInstanceId),h.addBucket(v.tileID,x,this.crossTileIDs)&&(m=!0),g[x.bucketInstanceId]=!0)}return h.removeStaleBuckets(g)&&(m=!0),m}pruneUnusedLayers(t){const o={};t.forEach(c=>{o[c]=!0});for(const c in this.layerIndexes)o[c]||delete this.layerIndexes[c]}}var CU=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#define EXTENT 8192.0
#define HALF_PI PI/2.0
#define QUARTER_PI PI/4.0
#define RAD_TO_DEG 180.0/PI
#define DEG_TO_RAD PI/180.0
#define GLOBE_RADIUS EXTENT/PI/2.0
vec3 linearTosRGB(vec3 color)
{return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn)
{return pow(srgbIn,vec3(2.2));}vec3 linearProduct(vec3 srgbIn,vec3 k)
{return srgbIn*pow(k,vec3(1./2.2));}
#if __VERSION__ >=300
#define _HANDLE_WIREFRAME_DEPTH gl_FragDepth=gl_FragCoord.z-0.0001;
#else
#define _HANDLE_WIREFRAME_DEPTH
#endif
#ifdef DEBUG_WIREFRAME
#define HANDLE_WIREFRAME_DEBUG \\
gl_FragColor=vec4(0.7,0.0,0.0,0.7); \\
_HANDLE_WIREFRAME_DEPTH;
#else
#define HANDLE_WIREFRAME_DEBUG
#endif
#ifdef RENDER_CUTOFF
float cutoff_opacity(vec4 cutoff_params,float depth) {float near=cutoff_params.x;float far=cutoff_params.y;float cutoffStart=cutoff_params.z;float cutoffEnd=cutoff_params.w-0.0001;float linearDepth=(depth-near)/(far-near);return clamp((linearDepth-cutoffStart)/(cutoffEnd-cutoffStart),0.0,1.0);}
#endif`,PU="attribute highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;varying highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",IU=`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}
#else
vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif
const float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)
{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}
#ifdef TERRAIN
#ifdef TERRAIN_DEM_FLOAT_FORMAT
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;
#else
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;
#endif
uniform vec4 u_dem_unpack;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float decodeElevation(vec4 v) {return dot(vec4(v.xyz*255.0,-1.0),u_dem_unpack);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem,pos));float tr=decodeElevation(texture2D(u_dem,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem_prev,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem_prev,pos));float tr=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem_prev,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
return currentElevation(apos);}
#endif
highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture2D(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(
unpack_depth(texture2D(u_depth,uv-df.xz)),unpack_depth(texture2D(u_depth,uv+df.xz)),unpack_depth(texture2D(u_depth,uv-df.zy)),unpack_depth(texture2D(u_depth,uv+df.zy))
);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(off.x,0.0)).r;float bl=texture(u_dem,pos+vec2(0.0,off.y)).r;float br=texture(u_dem,pos+off).r;
#else
vec4 demtl=vec4(texture2D(u_dem,pos).xyz*255.0,-1.0);float tl=dot(demtl,u_dem_unpack);vec4 demtr=vec4(texture2D(u_dem,pos+vec2(off.x,0.0)).xyz*255.0,-1.0);float tr=dot(demtr,u_dem_unpack);vec4 dembl=vec4(texture2D(u_dem,pos+vec2(0.0,off.y)).xyz*255.0,-1.0);float bl=dot(dembl,u_dem_unpack);vec4 dembr=vec4(texture2D(u_dem,pos+off).xyz*255.0,-1.0);float br=dot(dembr,u_dem_unpack);
#endif
return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }
#endif`,RU=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;varying vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,LU=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump vec2 u_fog_vertical_limit;uniform mediump float u_fog_temporal_offset;varying vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,opacity);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec4 fog_apply_premultiplied(vec4 color,vec3 pos,float heightMeters) {float verticalProgress=(u_fog_vertical_limit.x > 0.0 || u_fog_vertical_limit.y > 0.0) ? smoothstep(u_fog_vertical_limit.x,u_fog_vertical_limit.y,heightMeters) : 0.0;float opacityLimit=1.0-smoothstep(0.9,1.0,fog_opacity(pos));return mix(fog_apply_premultiplied(color,pos),color,min(verticalProgress,opacityLimit));}vec3 fog_dither(vec3 color) {
#ifdef FOG_DITHERING
vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);
#else
return color;
#endif
}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`,kU=`#ifdef RENDER_SHADOWS
uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_normal_offset;vec3 shadow_normal_offset(vec3 normal) {float tileInMeters=u_shadow_normal_offset[0];vec3 n=vec3(-normal.xy,tileInMeters*normal.z);float dotScale=min(1.0-dot(normal,u_shadow_direction),1.0)*0.5+0.5;return n*dotScale;}vec3 shadow_normal_offset_model(vec3 normal) {float dotScale=min(1.0-dot(normal,u_shadow_direction),1.0)*0.5+0.5;return normal*dotScale;}float shadow_normal_offset_multiplier0() {return u_shadow_normal_offset[1];}float shadow_normal_offset_multiplier1() {return u_shadow_normal_offset[2];}
#endif//RENDER_SHADOWS`,DU=`#ifdef RENDER_SHADOWS
#if defined(NATIVE) && __VERSION__ >=300
#define TEXTURE_GATHER
#endif
#ifdef DEPTH_TEXTURE
uniform highp sampler2D u_shadowmap_0;uniform highp sampler2D u_shadowmap_1;
#else
uniform sampler2D u_shadowmap_0;uniform sampler2D u_shadowmap_1;
#endif
uniform float u_shadow_intensity;uniform float u_shadow_map_resolution;uniform float u_shadow_texel_size;uniform highp vec3 u_shadow_normal_offset;uniform vec2 u_fade_range;uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_bias;highp float shadow_sample_1(highp vec2 uv,highp float compare) {highp float shadow_depth;
#ifdef DEPTH_TEXTURE
shadow_depth=texture2D(u_shadowmap_1,uv).r;
#else
shadow_depth=unpack_depth(texture2D(u_shadowmap_1,uv))*0.5+0.5;
#endif
return step(shadow_depth,compare);}highp float shadow_sample_0(highp vec2 uv,highp float compare) {highp float shadow_depth;
#ifdef DEPTH_TEXTURE
shadow_depth=texture2D(u_shadowmap_0,uv).r;
#else
shadow_depth=unpack_depth(texture2D(u_shadowmap_0,uv))*0.5+0.5;
#endif
return step(shadow_depth,compare);}float shadow_occlusion_1(highp vec4 pos,highp float bias) {highp vec2 uv=pos.xy;return shadow_sample_1(uv,pos.z-bias);}float shadow_occlusion_0(highp vec4 pos,highp float bias) {highp float compare0=pos.z-bias;
#ifdef TEXTURE_GATHER
highp vec2 uv=pos.xy;highp vec4 samples=textureGather(u_shadowmap_0,uv,0);lowp vec4 stepSamples=step(samples,vec4(compare0));
#else
highp vec2 uv00=pos.xy-vec2(0.5*u_shadow_texel_size);highp vec2 uv10=uv00+vec2(u_shadow_texel_size,0.0);highp vec2 uv01=uv00+vec2(0.0,u_shadow_texel_size);highp vec2 uv11=uv01+vec2(u_shadow_texel_size,0.0);lowp vec4 stepSamples=vec4(
shadow_sample_0(uv01,compare0),shadow_sample_0(uv11,compare0),shadow_sample_0(uv10,compare0),shadow_sample_0(uv00,compare0)
);
#endif
vec2 f=fract(pos.xy*u_shadow_map_resolution-vec2(0.5));lowp vec2 lerpx=mix(stepSamples.wx,stepSamples.zy,f.xx);return mix(lerpx.x,lerpx.y,f.y);}float shadow_occlusion(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,highp float bias) {
#ifdef SHADOWS_SINGLE_CASCADE
light_view_pos0.xyz=light_view_pos0.xyz/light_view_pos0.w*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);
#else
light_view_pos0.xyz/=light_view_pos0.w;light_view_pos1.xyz/=light_view_pos1.w;vec4 uv=vec4(light_view_pos0.xy,light_view_pos1.xy);vec4 abs_bounds=abs(uv);if (abs_bounds.x < 1.0 && abs_bounds.y < 1.0) {light_view_pos0.xyz=light_view_pos0.xyz*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);}if (abs_bounds.z >=1.0 || abs_bounds.w >=1.0) {return 0.0;}light_view_pos1.xyz=light_view_pos1.xyz*0.5+0.5;float occlusion1=shadow_occlusion_1(light_view_pos1,bias);return mix(occlusion1,0.0,smoothstep(u_fade_range.x,u_fade_range.y,view_depth));
#endif
}highp float calculate_shadow_bias(float NDotL) {
#ifdef NORMAL_OFFSET
return 0.5*u_shadow_bias.x;
#else
return 0.5*(u_shadow_bias.x+clamp(u_shadow_bias.y*tan(acos(NDotL)),0.0,u_shadow_bias.z));
#endif
}float shadowed_light_factor_normal(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_unbiased(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return 1.0-(u_shadow_intensity*occlusion);}float shadow_occlusion(float ndotl,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=calculate_shadow_bias(ndotl);return shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);}
#endif`;const zU=[];$2(CU,zU);const H2={"_prelude_fog.vertex.glsl":RU,"_prelude_terrain.vertex.glsl":IU,"_prelude_shadow.vertex.glsl":kU,"_prelude_fog.fragment.glsl":LU,"_prelude_shadow.fragment.glsl":DU,"_prelude_lighting.glsl":`
#ifdef LIGHTING_3D_MODE
uniform mediump vec3 u_lighting_ambient_color;uniform mediump vec3 u_lighting_directional_dir;uniform mediump vec3 u_lighting_directional_color;uniform mediump vec3 u_ground_radiance;float calculate_ambient_directional_factor(vec3 normal) {float NdotL=dot(normal,u_lighting_directional_dir);const float factor_reduction_max=0.3;float dir_luminance=dot(u_lighting_directional_color,vec3(0.2126,0.7152,0.0722));float directional_factor_min=1.0-factor_reduction_max*min(dir_luminance,1.0);float ambient_directional_factor=mix(directional_factor_min,1.0,min((NdotL+1.0),1.0));const float vertical_factor_min=0.92;float vertical_factor=mix(vertical_factor_min,1.0,normal.z*0.5+0.5);return vertical_factor*ambient_directional_factor;}vec3 apply_lighting(vec3 color,vec3 normal,float dir_factor) {float ambient_directional_factor=calculate_ambient_directional_factor(normal);vec3 ambient_contrib=ambient_directional_factor*u_lighting_ambient_color;vec3 directional_contrib=u_lighting_directional_color*dir_factor;return linearProduct(color,ambient_contrib+directional_contrib);}vec4 apply_lighting(vec4 color,vec3 normal,float dir_factor) {return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting(vec3 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return apply_lighting(color.rgb,normal,dir_factor);}vec4 apply_lighting(vec4 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting_ground(vec3 color) {return color*u_ground_radiance;}vec4 apply_lighting_ground(vec4 color) {return vec4(apply_lighting_ground(color.rgb),color.a);}float calculate_NdotL(vec3 normal) {const float ext=0.70710678118;return (clamp(dot(normal,u_lighting_directional_dir),-ext,1.0)+ext)/(1.0+ext);}vec4 apply_lighting_with_emission_ground(vec4 color,float emissive_strength) {return mix(apply_lighting_ground(color),color,emissive_strength);}vec3 compute_flood_lighting(vec3 flood_light_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=flood_light_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);float occlusion_ramp=smoothstep(0.0,0.2,1.0-occlusion);return mix(fully_occluded_color,flood_light_color,occlusion_ramp);}vec3 compute_emissive_draped(vec3 unlit_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=unlit_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);return mix(fully_occluded_color,unlit_color,1.0-occlusion);}
#endif//LIGHTING_3D_MODE`},j2={};ji("",IU),ji(LU,RU),ji(DU,kU);const OU=ji(`
#if __VERSION__ >=300
#define varying in
#define gl_FragColor glFragColor
#define texture2D texture
#define textureCube texture
out vec4 glFragColor;
#endif
highp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}
#ifdef INDICATOR_CUTOUT
uniform vec2 u_indicator_cutout_centers;uniform vec4 u_indicator_cutout_params;
#endif
vec4 applyCutout(vec4 color) {
#ifdef INDICATOR_CUTOUT
float holeMinOpacity=u_indicator_cutout_params.x;float holeRadius=max(u_indicator_cutout_params.y,0.0);float holeAspectRatio=u_indicator_cutout_params.z;float fadeStart=u_indicator_cutout_params.w;float distA=distance(vec2(gl_FragCoord.x,gl_FragCoord.y*holeAspectRatio),vec2(u_indicator_cutout_centers[0],u_indicator_cutout_centers[1]*holeAspectRatio));return color*min(smoothstep(fadeStart,holeRadius,distA)+holeMinOpacity,1.0);
#else
return color;
#endif
}
#ifdef RENDER_CUTOFF
uniform highp vec4 u_cutoff_params;varying float v_cutoff_opacity;
#endif`,`
#if __VERSION__ >=300
#define attribute in
#define varying out
#define texture2D texture
#endif
float wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {
#ifndef PROJECTED_POS_ON_VIEWPORT
float tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;
#else
return vec3(0.0);
#endif
}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}
#ifdef RENDER_CUTOFF
uniform vec4 u_cutoff_params;varying float v_cutoff_opacity;
#endif
const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);//Normalized device coordinate that is not rendered.`),NU=CU,FU=`
#ifdef GL_ES
precision mediump float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`;var BU={background:ji(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec4 u_color;uniform float u_opacity;
#ifdef LIGHTING_3D_MODE
varying vec4 v_color;
#endif
void main() {vec4 out_color;
#ifdef LIGHTING_3D_MODE
out_color=v_color;
#else
out_color=u_color;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_lighting.glsl"
attribute vec2 a_pos;uniform mat4 u_matrix;
#ifdef LIGHTING_3D_MODE
uniform mediump vec4 u_color;varying vec4 v_color;uniform float u_emissive_strength;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting_with_emission_ground(u_color,u_emissive_strength);
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:ji(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform float u_emissive_strength;uniform sampler2D u_image;varying vec2 v_pos;void main() {vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),circle:ji(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
uniform float u_emissive_strength;void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
gl_FragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
#ifdef PROJECTION_GLOBE_VIEW
return u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );
#else
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#endif
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);
#else 
surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);
#endif
vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;
#else
occlusion_world_center=world_center;occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
#ifdef PROJECTION_GLOBE_VIEW
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:ji("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:ji(`#include "_prelude_fog.fragment.glsl"
uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
if (u_is_globe==0) {gl_FragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#else
pos=vec3(tilePos+extrude,elevation(tilePos));
#endif
gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:ji(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,"attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:ji("varying float v_placed;varying float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);gl_FragColor =mix(red,blue,step(0.5,v_placed))*0.5;gl_FragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`#include "_prelude_terrain.vertex.glsl"
attribute vec3 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;attribute float a_size_scale;attribute vec2 a_padding;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*elevation(a_anchor_pos),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:ji("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}",`attribute vec2 a_pos_2f;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:ji("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}",`#include "_prelude_terrain.vertex.glsl"
attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;
#endif
varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);
#else
gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);
#endif
}`),fill:ji(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
uniform float u_emissive_strength;void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutline:ji(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
varying vec2 v_pos;uniform float u_emissive_strength;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:ji(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_emissive_strength;varying vec2 v_pos;varying vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;varying vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:ji(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;uniform float u_emissive_strength;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:ji(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
varying vec4 v_color;
#ifdef RENDER_SHADOWS
varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;
#endif
uniform lowp float u_opacity;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec2 v_ao;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
varying vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
varying highp vec3 v_normal;
#endif
uniform vec3 u_flood_light_color;uniform highp float u_vertical_scale;uniform float u_flood_light_intensity;uniform vec3 u_ground_shadow_factor;
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
varying float v_flood_radius;varying float v_has_floodlight;
#endif
varying float v_height;void main() {
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
vec3 normal=normalize(v_normal);
#endif
float z;vec4 color=v_color;
#ifdef ZERO_ROOF_RADIUS
z=float(normal.z > 0.00001);
#ifdef LIGHTING_3D_MODE
normal=mix(normal,vec3(0.0,0.0,1.0),z);
#else
color=mix(v_color,v_roof_color,z);
#endif
#endif
float h=max(0.0,v_height);float ao_shade=1.0;
#ifdef FAUX_AO
float intensity=u_ao[0];float h_floors=h/(u_ao[1]*u_vertical_scale);float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);ao_shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;
#ifdef ZERO_ROOF_RADIUS
concave*=(1.0-z);
#endif
float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);ao_shade*=mix(1.0,x_shade*x_shade*x_shade,concave);
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
color.rgb*=mix(ao_shade,1.0,v_has_floodlight);
#else
color.rgb*=ao_shade;
#endif
#else
color.rgb*=ao_shade;
#endif
#endif
#ifdef LIGHTING_3D_MODE
float flood_radiance=0.0;
#ifdef FLOOD_LIGHT
flood_radiance=(1.0-min(h/v_flood_radius,1.0))*u_flood_light_intensity*v_has_floodlight;
#endif
#ifdef RENDER_SHADOWS
#ifdef FLOOD_LIGHT
float ndotl_unclamped=dot(normal,u_shadow_direction);float ndotl=max(0.0,ndotl_unclamped);float occlusion=ndotl_unclamped < 0.0 ? 1.0 : shadow_occlusion(ndotl,v_pos_light_view_0,v_pos_light_view_1,v_depth);vec3 litColor=apply_lighting(color.rgb,normal,(1.0-u_shadow_intensity*occlusion)*ndotl);vec3 floodLitColor=compute_flood_lighting(u_flood_light_color*u_opacity,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=mix(litColor,floodLitColor,flood_radiance);
#else
float shadowed_lighting_factor=shadowed_light_factor_normal(normal,v_pos_light_view_0,v_pos_light_view_1,v_depth);color.rgb=apply_lighting(color.rgb,normal,shadowed_lighting_factor);
#endif
#else
color.rgb=apply_lighting(color.rgb,normal);
#ifdef FLOOD_LIGHT
color.rgb=mix(color.rgb,u_flood_light_color*u_opacity,flood_radiance);
#endif
#endif
color*=u_opacity;
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos,h));
#endif
#ifdef RENDER_CUTOFF
color*=v_cutoff_opacity;
#endif
#ifdef INDICATOR_CUTOUT
color=applyCutout(color);
#endif
gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_lighting.glsl"
#if __VERSION__ >=300
#ifdef RENDER_CUTOFF
invariant gl_Position;
#endif
#endif
uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
uniform highp float u_vertical_scale;varying vec4 v_color;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
varying vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
varying highp vec3 v_normal;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec2 v_ao;
#endif
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
varying float v_flood_radius;varying float v_has_floodlight;
#endif
varying float v_height;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
#pragma mapbox: define highp float flood_light_wall_radius
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize highp float flood_light_wall_radius
base*=u_vertical_scale;height*=u_vertical_scale;vec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
v_normal=normal;
#endif
base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=0.0;float c_ele;vec3 pos;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);pos=vec3(pos_nx.xy,h);
#else
h=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);h=h-ele;v_height=h;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=pos;vec3 shd_pos1=pos;
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(normal);shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
float NdotL=0.0;float colorvalue=0.0;
#ifndef LIGHTING_3D_MODE
colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);if (normal.y !=0.0) {float r=0.84;r=mix(0.7,0.98,1.0-u_lightintensity);NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#endif
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec2(mix(concave,-concave,start),y_ground);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
float is_wall=1.0-float(t > 0.0 && top_up_ny.y > 0.0);v_has_floodlight=float(flood_light_wall_radius > 0.0 && is_wall > 0.0);v_flood_radius=flood_light_wall_radius*u_vertical_scale;
#endif
v_color=vec4(color.rgb,1.0);
#else
v_color=vec4(0.0,0.0,0.0,1.0);v_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_color*=u_opacity;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
float roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color=vec4(0.0,0.0,0.0,1.0);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_roof_color*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
}`),fillExtrusionDepth:ji(`varying highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
gl_FragColor=pack_depth(v_depth);
#endif
}`,`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_edge_radius;uniform float u_vertical_scale;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
varying highp float v_depth;void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
base*=u_vertical_scale;height*=u_vertical_scale;vec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
vec3 pos;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;float ele=elevation(pos_nx.xy);float c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;float h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base);pos=vec3(pos_nx.xy,h);
#else
pos=vec3(pos_nx.xy,t > 0.0 ? height : base);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);v_depth=gl_Position.z/gl_Position.w;}`),fillExtrusionPattern:ji(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
varying vec3 v_normal;
#endif
varying vec2 v_pos;varying vec4 v_lighting;uniform lowp float u_opacity;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define highp float pixel_ratio
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize highp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color,normalize(v_normal))*u_opacity;
#else
out_color=out_color*v_lighting;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color);
#endif
gl_FragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_lighting.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
varying vec2 v_pos;varying vec4 v_lighting;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
varying vec3 v_normal;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define highp float pixel_ratio
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize highp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=z;vec3 p;float c_ele;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);p=vec3(pos_nx.xy,h);
#else
p=vec3(pos_nx.xy,z);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_normal=normal;
#else
v_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#endif 
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),groundShadow:ji(`#include "_prelude_shadow.fragment.glsl"
#ifdef GL_ES
precision highp float;
#endif
uniform vec3 u_ground_shadow_factor;varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;
#ifdef FOG
varying float v_fog_opacity;
#endif
void main() {float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);vec3 shadow=mix(u_ground_shadow_factor,vec3(1.0),light);
#ifdef RENDER_CUTOFF
shadow=mix(vec3(1.0),shadow,cutoff_opacity(u_cutoff_params,v_depth));
#endif
#ifdef FOG
shadow=mix(shadow,vec3(1.0),v_fog_opacity);
#endif
#ifdef INDICATOR_CUTOUT
shadow=mix(shadow,vec3(1.0),1.0-applyCutout(vec4(1.0)).r);
#endif
gl_FragColor=vec4(shadow,1.0);}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;attribute vec2 a_pos;varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;
#ifdef FOG
varying float v_fog_opacity;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0.0,1.0);v_pos_light_view_0=u_light_matrix_0*vec4(a_pos,0.0,1.0);v_pos_light_view_1=u_light_matrix_1*vec4(a_pos,0.0,1.0);v_depth=gl_Position.w;
#ifdef FOG
v_fog_pos=fog_position(a_pos);v_fog_opacity=fog(v_fog_pos);
#endif
}`),fillExtrusionGroundEffect:ji(`uniform highp float u_ao_pass;uniform highp float u_opacity;uniform highp float u_flood_light_intensity;uniform highp vec3 u_flood_light_color;uniform highp float u_attenuation;uniform sampler2D u_fb;uniform float u_fb_size;
#ifdef SDF_SUBPASS
varying highp vec2 v_pos;varying highp vec4 v_line_segment;varying highp float v_flood_light_radius_tile;varying highp vec2 v_ao;float line_df(highp vec2 a,highp vec2 b,highp vec2 p) {highp vec2 ba=b-a;highp vec2 pa=p-a;highp float r=clamp(dot(pa,ba)/dot(ba,ba),0.0,1.0);return length(pa-r*ba);}
#ifdef FOG
varying highp float v_fog;
#endif
#endif
void main() {
#ifdef CLEAR_SUBPASS
vec4 color=vec4(1.0);
#ifdef CLEAR_FROM_TEXTURE
color=texture2D(u_fb,gl_FragCoord.xy/vec2(u_fb_size));
#endif
gl_FragColor=color;
#else
#ifdef SDF_SUBPASS
highp float d=line_df(v_line_segment.xy,v_line_segment.zw,v_pos);highp float effect_radius=mix(v_flood_light_radius_tile,v_ao.y,u_ao_pass);d/=effect_radius;d=min(d,1.0);d=1.0-pow(1.0-d,u_attenuation);highp float effect_intensity=mix(u_flood_light_intensity,v_ao.x,u_ao_pass);highp float fog=1.0;
#ifdef FOG
fog=v_fog;
#endif
#ifdef RENDER_CUTOFF
fog*=v_cutoff_opacity;
#endif
gl_FragColor=vec4(vec3(0.0),mix(1.0,d,effect_intensity*u_opacity*fog));
#else
vec4 color=mix(vec4(u_flood_light_color,1.0),vec4(vec3(0.0),1.0),u_ao_pass);
#ifdef OVERDRAW_INSPECTOR
color=vec4(1.0);
#endif
gl_FragColor=color;HANDLE_WIREFRAME_DEBUG;
#endif
#endif
}`,`#include "_prelude_fog.vertex.glsl"
attribute highp vec4 a_pos_end;attribute highp float a_angular_offset_factor;attribute highp float a_hidden_by_landmark;
#ifdef SDF_SUBPASS
varying highp vec2 v_pos;varying highp vec4 v_line_segment;varying highp float v_flood_light_radius_tile;varying highp vec2 v_ao;
#ifdef FOG
varying highp float v_fog;
#endif
#endif
uniform highp float u_flood_light_intensity;uniform highp mat4 u_matrix;uniform highp float u_ao_pass;uniform highp float u_meter_to_tile;uniform highp float u_edge_radius;uniform highp vec2 u_ao;
#pragma mapbox: define highp float flood_light_ground_radius
const float TANGENT_CUTOFF=4.0;const float NORM=32767.0;void main() {
#pragma mapbox: initialize highp float flood_light_ground_radius
vec2 p=a_pos_end.xy;vec2 q=floor(a_pos_end.zw*0.5);vec2 start_bottom=a_pos_end.zw-q*2.0;float fl_ground_radius=flood_light_ground_radius;
#ifdef FORCE_ABS_FL_GROUND_RADIUS
fl_ground_radius=abs(flood_light_ground_radius);
#endif
float flood_radius_tile=fl_ground_radius*u_meter_to_tile;vec2 v=normalize(q-p);float ao_radius=u_ao.y/3.5;float effect_radius=mix(flood_radius_tile,ao_radius,u_ao_pass)+u_edge_radius;float angular_offset_factor=a_angular_offset_factor/NORM*TANGENT_CUTOFF;float angular_offset=angular_offset_factor*effect_radius;float top=1.0-start_bottom.y;float side=(0.5-start_bottom.x)*2.0;vec2 extrusion_parallel=v*side*mix(1.0,angular_offset,top);vec2 perp=vec2(v.y,-v.x);vec2 extrusion_perp=perp*effect_radius*top;vec3 pos=vec3(mix(q,p,start_bottom.x),0.0);pos.xy+=extrusion_parallel+extrusion_perp;
#ifdef SDF_SUBPASS
v_pos=pos.xy;v_line_segment=vec4(p,q)+perp.xyxy*u_edge_radius;v_flood_light_radius_tile=flood_radius_tile;v_ao=vec2(u_ao.x,ao_radius);
#ifdef FOG
v_fog_pos=fog_position(pos);v_fog=1.0-fog(v_fog_pos);
#endif
#endif
float hidden_by_landmark=0.0;
#ifdef HAS_CENTROID
hidden_by_landmark=a_hidden_by_landmark;
#endif
float isFloodlit=float(fl_ground_radius > 0.0 && u_flood_light_intensity > 0.0);float hidden=mix(1.0-isFloodlit,isFloodlit,u_ao_pass);hidden+=hidden_by_landmark;gl_Position=mix(u_matrix*vec4(pos,1.0),AWAY,float(hidden > 0.0));
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
}`),hillshadePrepare:ji(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
return texture(u_image,coord).r/4.0;
#else
vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;
#endif
}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:ji(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;uniform float u_emissive_strength;void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef LIGHTING_3D_MODE
gl_FragColor=apply_lighting_with_emission_ground(gl_FragColor,u_emissive_strength);
#endif
#ifdef FOG
gl_FragColor=fog_dither(fog_apply_premultiplied(gl_FragColor,v_fog_pos));
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:ji(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;varying vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;
#endif
float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}uniform float u_emissive_strength;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
float linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef RENDER_LINE_DASH
float sdfdist=texture2D(u_dash_image,v_tex).a;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;alpha*=linearstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);
#endif
highp vec4 out_color;
#ifdef RENDER_LINE_GRADIENT
out_color=texture2D(u_gradient_image,v_uv.xy);
#else
out_color=color;
#endif
float trimmed=1.0;
#ifdef RENDER_LINE_TRIM_OFFSET
highp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {out_color=vec4(0,0,0,0);trimmed=0.0;}}
#endif
if (u_alpha_discard_threshold !=0.0) {if (alpha < u_alpha_discard_threshold) {discard;}}
#ifdef RENDER_LINE_BORDER
float edgeBlur=(border_width+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);if (border_color.a==0.0) {    
float Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}} else {out_color.rgb=mix(border_color.rgb*border_color.a*trimmed,out_color.rgb,smoothAlpha);}}
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
out_color*=(alpha*opacity);
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color);
#endif
gl_FragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#define EXTRUDE_SCALE 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
attribute highp vec4 a_packed;
#endif
#ifdef RENDER_LINE_DASH
attribute float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;varying vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
float a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];
#ifdef RENDER_LINE_GRADIENT
highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);
#else
v_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);
#endif
#endif
#ifdef RENDER_LINE_DASH
float scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/floorwidth,(-normal.y*height+dash.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),linePattern:ji(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;vec2 pattern_size=vec2(display_size.x/u_tile_units_to_pixels,display_size.y);float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x=mod(v_linesofar/pattern_size.x*aspect,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));vec4 color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
color=apply_lighting_ground(color);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=(alpha*opacity);
#ifdef INDICATOR_CUTOUT
color=applyCutout(color);
#endif
gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),raster:ji(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;
#ifdef RASTER_COLOR
uniform sampler2D u_color_ramp;uniform highp vec2 u_colorization_scale;uniform highp vec4 u_colorization_mix;highp vec4 colormap (highp float value) {highp float scaled_value=value*u_colorization_scale.y+u_colorization_scale.x;highp vec2 coords=vec2(scaled_value,0.5);return texture2D(u_color_ramp,coords);}
#endif
void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);vec4 color;
#ifdef RASTER_COLOR
highp vec4 fadedColor=mix(color0,color1,u_fade_t);color=colormap(dot(vec4(fadedColor.rgb,1),u_colorization_mix));color.a*=fadedColor.a;if (color.a > 0.0) {color.rgb/=color.a;}
#else
if (color0.a > 0.0) {color0.rgb/=color0.a;}if (color1.a > 0.0) {color1.rgb/=color1.a;}color=mix(color0,color1,u_fade_t);
#endif
color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_ground(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply(out_color,v_fog_pos));
#endif
gl_FragColor=vec4(out_color*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_pos;attribute vec2 a_uv;
#else
attribute vec2 a_pos;attribute vec2 a_texture_pos;
#endif
varying vec2 v_pos0;varying vec2 v_pos1;void main() {vec2 uv;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*u_globe_matrix*vec4(a_globe_pos,1.0);uv=a_uv;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(a_globe_pos,1.0)).xyz);
#endif
#else
float w=1.0+dot(a_texture_pos,u_perspective_transform);gl_Position=u_matrix*vec4(a_pos*w,0,w);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
uv=a_texture_pos/8192.0;
#endif
v_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),symbolIcon:ji(`#include "_prelude_lighting.glsl"
uniform sampler2D u_texture;
#ifdef ICON_TRANSITION
uniform float u_icon_transition;
#endif
varying float v_fade_opacity;varying vec2 v_tex_a;
#ifdef ICON_TRANSITION
varying vec2 v_tex_b;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float emissive_strength
lowp float alpha=opacity*v_fade_opacity;vec4 out_color;
#ifdef ICON_TRANSITION
vec4 a=texture2D(u_texture,v_tex_a)*(1.0-u_icon_transition);vec4 b=texture2D(u_texture,v_tex_b)*u_icon_transition;out_color=(a+b)*alpha;
#else
out_color=texture2D(u_texture,v_tex_a)*alpha;
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,emissive_strength);
#endif
gl_FragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef Z_OFFSET
attribute float a_z_offset;
#endif
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
#ifdef ICON_TRANSITION
attribute vec2 a_texb;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform vec3 u_up_vector;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec2 v_tex_a;
#ifdef ICON_TRANSITION
varying vec2 v_tex_b;
#endif
varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float emissive_strength
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=elevation(tile_anchor);
#ifdef Z_OFFSET
e+=a_z_offset;
#endif
vec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjected_point;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetProjected_point=u_matrix*vec4(a_globe_anchor+displacement,1);
#else
offsetProjected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);
#endif
vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetProjected_point.xy/offsetProjected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float out_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,hidden);
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,hidden);
#endif
v_tex_a=a_tex/u_texsize;
#ifdef ICON_TRANSITION
v_tex_b=a_texb/u_texsize;
#endif
v_fade_opacity=out_fade_opacity;}`),symbolSDF:ji(`#include "_prelude_lighting.glsl"
#define SDF_PX 8.0
uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;uniform bool u_is_halo;
#if __VERSION__ >=300
flat varying float v_draw_halo;
#endif
varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;bool draw_halo;
#if __VERSION__ >=300
draw_halo=v_draw_halo > 0.0;
#else
draw_halo=u_is_halo;
#endif
if (draw_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);vec4 out_color=color*(alpha*opacity*fade_opacity);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,emissive_strength);
#endif
gl_FragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef Z_OFFSET
attribute float a_z_offset;
#endif
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform bool u_is_halo;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
#if __VERSION__ >=300
flat varying float v_draw_halo;
#endif
varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=elevation(tile_anchor);
#ifdef Z_OFFSET
e+=a_z_offset;
#endif
vec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);
#else
offsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);
#endif
vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float out_fade_opacity=interpolated_fade_opacity*projection_transition_fade;float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,hidden);
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,hidden);
#endif
float gamma_scale=gl_Position.w;
#if __VERSION__ >=300
v_draw_halo=(u_is_halo && float(gl_InstanceID)==0.0) ? 1.0 : 0.0;
#endif
v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,out_fade_opacity);}`),symbolTextAndIcon:ji(`#include "_prelude_lighting.glsl"
#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_halo;
#if __VERSION__ >=300
flat varying float v_draw_halo;
#endif
varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;bool draw_halo;
#if __VERSION__ >=300
draw_halo=v_draw_halo > 0.0;
#else
draw_halo=u_is_halo;
#endif
if (draw_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);vec4 out_color=color*(alpha*opacity*fade_opacity);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,emissive_strength);
#endif
gl_FragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef Z_OFFSET
attribute float a_z_offset;
#endif
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;uniform bool u_is_halo;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
#if __VERSION__ >=300
flat varying float v_draw_halo;
#endif
varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=elevation(tile_anchor);
#ifdef Z_OFFSET
e+=a_z_offset;
#endif
vec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offset_projected_point=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offset_projected_point.xy/offset_projected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*font_scale);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
float out_fade_opacity=interpolated_fade_opacity*projection_transition_fade;float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,hidden);
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,hidden);
#endif
float gamma_scale=gl_Position.w;
#if __VERSION__ >=300
v_draw_halo=(u_is_halo && float(gl_InstanceID)==0.0) ? 1.0 : 0.0;
#endif
v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,out_fade_opacity,is_sdf);}`),terrainRaster:ji(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;
#endif
uniform vec3 u_ground_shadow_factor;void main() {vec4 image_color=texture2D(u_image0,v_pos0);vec4 color;
#ifdef LIGHTING_3D_MODE
const vec3 normal=vec3(0.0,0.0,1.0);
#ifdef RENDER_SHADOWS
float cutoffOpacity=1.0;
#ifdef RENDER_CUTOFF
cutoffOpacity=cutoff_opacity(u_cutoff_params,v_depth);
#endif
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
vec3 unlit_base=image_color.rgb*(1.0-image_color.a);vec3 emissive_base=image_color.rgb*image_color.a;float ndotl=u_shadow_direction.z;float occlusion=ndotl < 0.0 ? 1.0 : shadow_occlusion(v_pos_light_view_0,v_pos_light_view_1,v_depth,0.0);ndotl=max(0.0,ndotl);vec3 lit=apply_lighting(unlit_base,normal,mix(1.0,(1.0-(u_shadow_intensity*occlusion))*ndotl,cutoffOpacity));vec3 emissive=compute_emissive_draped(emissive_base,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=lit+emissive;color.a=1.0;
#else
float lighting_factor=shadowed_light_factor_normal_unbiased(normal,v_pos_light_view_0,v_pos_light_view_1,v_depth);color=apply_lighting(image_color,normal,mix(1.0,lighting_factor,cutoffOpacity));
#endif
#else
float lighting_factor=u_lighting_directional_dir.z;color=apply_lighting(image_color,normal,lighting_factor);
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color.rgb=mix(color.rgb,image_color.rgb,image_color.a);color.a=1.0;
#endif
#endif
#else
color=image_color;
#endif
#ifdef FOG
#ifdef ZERO_EXAGGERATION
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#else
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
#endif
gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_skirt_height;attribute vec2 a_pos;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;
#endif
void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;v_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
#ifdef ZERO_EXAGGERATION
v_fog_pos=fog_position(decodedPos);
#else
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
#endif
#ifdef RENDER_SHADOWS
vec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);v_depth=gl_Position.w;
#endif
}`),terrainDepth:ji(`#ifdef GL_ES
precision highp float;
#endif
varying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}`,`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;attribute vec2 a_pos;varying float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}`),skybox:ji(`#include "_prelude_fog.fragment.glsl"
varying lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=textureCube(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);gl_FragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,PU),skyboxGradient:ji(`#include "_prelude_fog.fragment.glsl"
varying highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture2D(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,PU),skyboxCapture:ji(`
varying highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;
#ifdef GL_ES
precision highp float;
#endif
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;gl_FragColor=vec4(color,1.0);}`,"attribute highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;varying highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:ji(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;varying vec2 v_pos0;
#ifndef FOG
uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;
#endif
void main() {vec4 color;
#ifdef CUSTOM_ANTIALIASING
vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture2D(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
raster=apply_lighting_with_emission_ground(raster,raster.a);color=vec4(raster.rgb*antialias,antialias);
#else
raster=apply_lighting_ground(raster);color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=texture2D(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color=apply_lighting_with_emission_ground(color,color.a);color.a=1.0;
#else
color=apply_lighting_ground(color);
#endif
#endif
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;
#ifdef GLOBE_POLES
attribute vec3 a_globe_pos;attribute vec2 a_uv;
#else
attribute vec2 a_pos;
#endif
varying vec2 v_pos0;float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(QUARTER_PI+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}void main() {
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;vec2 uv=a_uv;
#else
float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);
#endif
v_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;
#ifdef GLOBE_POLES
vec3 up_vector=globe_derived_up_vector;
#else
vec3 up_vector=elevationVector(tile_pos);
#endif
float height=elevation(tile_pos);globe_pos+=up_vector*height;
#ifndef GLOBE_POLES
globe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;
#endif
#ifdef GLOBE_POLES
vec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);
#else
vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);
#endif
gl_Position=u_proj_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
}`),globeAtmosphere:ji(`#include "_prelude_fog.fragment.glsl"
uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec4 u_color;uniform vec4 u_high_color;uniform vec4 u_space_color;uniform float u_horizon_angle;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;
#ifdef PROJECTION_GLOBE_VIEW
globe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {
#ifdef ALPHA_PASS
gl_FragColor=vec4(0,0,0,0);return;
#else
#ifdef NATIVE
gl_FragColor=vec4(1,1,1,1);
#else
gl_FragColor=vec4(0,0,0,1);
#endif
return;
#endif
}
#endif
highp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?
0.0 : max(acos(clamp(dot(dir,horizon_dir),-1.0,1.0)),0.0);float horizon_angle;
#ifdef PROJECTION_GLOBE_VIEW
highp vec3 closest_point=globe_pos_dot_dir*dir;highp float closest_point_to_center=length(closest_point-u_globe_pos);highp float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?
PI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);
#else
horizon_angle=horizon_angle_mercator;
#endif
horizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;
#ifdef ALPHA_PASS
float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);gl_FragColor=vec4(1.0,1.0,1.0,a);
#else
vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c=c2;
#ifndef NATIVE
c=dither(c,gl_FragCoord.xy+u_temporal_offset);
#endif
gl_FragColor=vec4(c*t,t);
#endif
}`,`attribute vec3 a_pos;attribute vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(
mix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}`),model:ji(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_opacity;uniform vec3 u_lightcolor;uniform vec3 u_lightpos;uniform float u_lightintensity;uniform vec4 u_baseColorFactor;uniform vec4 u_emissiveFactor;uniform float u_metallicFactor;uniform float u_roughnessFactor;uniform float u_emissive_strength;varying highp vec4 v_position_height;varying lowp vec4 v_color_mix;
#ifdef RENDER_SHADOWS
varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth_shadows;
#endif
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#ifdef HAS_ATTRIBUTE_a_pbr
varying lowp vec4 v_roughness_metallic_emissive_alpha;varying mediump vec4 v_height_based_emission_params;
#endif
#ifdef HAS_TEXTURE_u_baseColorTexture
uniform sampler2D u_baseColorTexture;uniform bool u_baseTextureIsAlpha;uniform bool u_alphaMask;uniform float u_alphaCutoff;
#endif
#ifdef HAS_TEXTURE_u_metallicRoughnessTexture
uniform sampler2D u_metallicRoughnessTexture;
#endif
#ifdef HAS_TEXTURE_u_occlusionTexture
uniform sampler2D u_occlusionTexture;uniform float u_aoIntensity;
#endif
#ifdef HAS_TEXTURE_u_normalTexture
uniform sampler2D u_normalTexture;
#endif
#ifdef HAS_TEXTURE_u_emissionTexture
uniform sampler2D u_emissionTexture;
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
varying highp float v_depth;uniform sampler2D u_depthTexture;uniform vec2 u_inv_depth_size;bool isOccluded() {vec2 coord=gl_FragCoord.xy*u_inv_depth_size;highp float depth=unpack_depth(texture2D(u_depthTexture,coord));return v_depth > depth+0.0005;}
#endif
const float M_PI=3.141592653589793;
#define saturate(_x) clamp(_x,0.,1.)
float calculate_NdotL(vec3 normal,vec3 lightDir) {const float ext=0.70710678118;return (clamp(dot(normal,lightDir),-ext,1.0)+ext)/(1.0+ext);}vec3 getDiffuseShadedColor(vec3 albedo,vec3 normal,vec3 lightDir,vec3 lightColor)
{
#ifdef LIGHTING_3D_MODE
vec3 transformed_normal=vec3(-normal.xy,normal.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=saturate(dot(transformed_normal,u_lighting_directional_dir));
#endif
return apply_lighting(albedo,transformed_normal,lighting_factor);
#else
vec3 n=normal;float colorvalue=((albedo.x*0.2126)+(albedo.y*0.7152))+(albedo.z*0.0722);vec3 c=vec3(0.03,0.03,0.03);float directional=clamp(dot(n,vec3(lightDir)),0.0,1.0);directional=mix(1.0-u_lightintensity,max((1.0-colorvalue)+u_lightintensity,1.0),directional);vec3 c3=c+clamp((albedo*directional)*lightColor,mix(vec3(0.0),vec3(0.3),vec3(1.0)-lightColor),vec3(1.0));return c3;
#endif
}vec4 getBaseColor() {vec4 albedo=u_baseColorFactor;
#ifdef HAS_ATTRIBUTE_a_color_3f
albedo*=vec4(color_3f,1.0);
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#else
#ifdef HAS_ATTRIBUTE_a_color_4f
albedo*=color_4f;
#endif
#endif
#if defined (HAS_TEXTURE_u_baseColorTexture) && defined (HAS_ATTRIBUTE_a_uv_2f)
vec4 texColor=texture2D(u_baseColorTexture,uv_2f);if(u_alphaMask) {if (texColor.w < u_alphaCutoff) {discard;}}
#ifdef UNPREMULT_TEXTURE_IN_SHADER
if(texColor.w > 0.0) {texColor.rgb/=texColor.w;}texColor.w=1.0;
#endif
texColor.rgb=sRGBToLinear(texColor.rgb);if(u_baseTextureIsAlpha) {if (texColor.w < 0.5) {discard;}albedo*=mix(vec4(texColor.rgb,texColor.a),vec4(texColor.a),float(u_baseTextureIsAlpha));} else {albedo*=texColor;}
#endif
return vec4(mix(albedo.rgb,v_color_mix.rgb,v_color_mix.a),albedo.a);}highp mat3 cotangentFrame(highp vec3 N,highp vec3 p,highp vec2 uv ) {
#ifdef HAS_TEXTURE_u_normalTexture
highp vec3 dp1=vec3(dFdx(p.x),dFdx(p.y),dFdx(p.z));highp vec3 dp2=vec3(dFdy(p.x),dFdy(p.y),dFdy(p.z));highp vec2 duv1=vec2(dFdx(uv.x),dFdx(uv.y));highp vec2 duv2=vec2(dFdy(uv.x),dFdy(uv.y));highp vec3 dp2perp=cross( dp2,N );highp vec3 dp1perp=cross( N,dp1 );highp vec3 T=dp2perp*duv1.x+dp1perp*duv2.x;highp vec3 B=dp2perp*duv1.y+dp1perp*duv2.y;highp float lengthT=dot(T,T);highp float lengthB=dot(B,B);highp float maxLength=max(lengthT,lengthB);highp float invmax=inversesqrt( maxLength );highp mat3 res=mat3( T*invmax,B*invmax,N );return res;
#else
return mat3(1.0);
#endif
}highp vec3 getNormal(){highp vec3 n;
#ifdef HAS_ATTRIBUTE_a_normal_3f
n=normalize(normal_3f);
#else
highp vec3 fdx=vec3(dFdx(v_position_height.x),dFdx(v_position_height.y),dFdx(v_position_height.z));highp vec3 fdy=vec3(dFdy(v_position_height.x),dFdy(v_position_height.y),dFdy(v_position_height.z));n=normalize(cross(fdx,fdy))*-1.0;
#endif
#if defined(HAS_TEXTURE_u_normalTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
vec3 nMap=texture2D( u_normalTexture,uv_2f).xyz;nMap=normalize(2.0*nMap-vec3(1.0));highp vec3 v=normalize(-v_position_height.xyz);highp mat3 TBN=cotangentFrame(n,v,uv_2f);n=normalize(TBN*nMap);
#endif
return n;}struct Material {float perceptualRoughness;float alphaRoughness;float metallic;vec3 f90;vec4 baseColor;vec3 diffuseColor;vec3 specularColor;highp vec3 normal;};Material getPBRMaterial() {Material mat;mat.baseColor=getBaseColor();mat.perceptualRoughness=u_roughnessFactor;mat.metallic=u_metallicFactor;
#ifdef HAS_ATTRIBUTE_a_pbr
mat.perceptualRoughness=v_roughness_metallic_emissive_alpha.x;mat.metallic=v_roughness_metallic_emissive_alpha.y;mat.baseColor.w*=v_roughness_metallic_emissive_alpha.w;
#endif
#if defined(HAS_TEXTURE_u_metallicRoughnessTexture) && defined(HAS_ATTRIBUTE_a_uv_2f) 
vec4 mrSample=texture2D(u_metallicRoughnessTexture,uv_2f);mat.perceptualRoughness*=mrSample.g;mat.metallic*=mrSample.b;
#endif
const float c_minRoughness=0.04;mat.perceptualRoughness=clamp(mat.perceptualRoughness,c_minRoughness,1.0);mat.metallic=saturate(mat.metallic);mat.alphaRoughness=mat.perceptualRoughness*mat.perceptualRoughness;const vec3 f0=vec3(0.04);mat.diffuseColor=mat.baseColor.rgb*(vec3(1.0)-f0);mat.diffuseColor*=1.0-mat.metallic;mat.specularColor=mix(f0,mat.baseColor.rgb,mat.metallic);highp float reflectance=max(max(mat.specularColor.r,mat.specularColor.g),mat.specularColor.b);highp float reflectance90=saturate(reflectance*25.0);mat.f90=vec3(reflectance90);mat.normal=getNormal();return mat;}float V_GGX(float NdotL,float NdotV,float roughness)
{float a2=roughness*roughness;float GGXV=NdotL*sqrt(NdotV*NdotV*(1.0-a2)+a2);float GGXL=NdotV*sqrt(NdotL*NdotL*(1.0-a2)+a2);return 0.5/(GGXV+GGXL);}float V_GGXFast(float NdotL,float NdotV,float roughness) {float a=roughness;float GGXV=NdotL*(NdotV*(1.0-a)+a);float GGXL=NdotV*(NdotL*(1.0-a)+a);return 0.5/(GGXV+GGXL);}vec3 F_Schlick(vec3 specularColor,vec3 f90,float VdotH)
{return specularColor+(f90-specularColor)*pow(clamp(1.0-VdotH,0.0,1.0),5.0);}vec3 F_SchlickFast(vec3 specularColor,float VdotH)
{float x=1.0-VdotH;float x4=x*x*x*x;return specularColor+(1.0-specularColor)*x4*x;}float D_GGX(highp float NdotH,float alphaRoughness)
{highp float a4=alphaRoughness*alphaRoughness;highp float f=(NdotH*a4-NdotH)*NdotH+1.0;return a4/(M_PI*f*f);}vec3 diffuseBurley(Material mat,float LdotH,float NdotL,float NdotV)
{float f90=2.0*LdotH*LdotH*mat.alphaRoughness-0.5;return (mat.diffuseColor/M_PI)*(1.0+f90*pow((1.0-NdotL),5.0))*(1.0+f90*pow((1.0-NdotV),5.0));}vec3 diffuseLambertian(Material mat)
{
#ifdef LIGHTING_3D_MODE
return mat.diffuseColor;
#else
return mat.diffuseColor/M_PI;
#endif
}vec3 EnvBRDFApprox(vec3 specularColor,float roughness,highp float NdotV)
{vec4 c0=vec4(-1,-0.0275,-0.572,0.022);vec4 c1=vec4(1,0.0425,1.04,-0.04);highp vec4 r=roughness*c0+c1;highp float a004=min(r.x*r.x,exp2(-9.28*NdotV))*r.x+r.y;vec2 AB=vec2(-1.04,1.04)*a004+r.zw;return specularColor*AB.x+AB.y;}vec3 computeIndirectLightContribution(Material mat,float NdotV,vec3 normal)
{vec3 env_light=vec3(0.65,0.65,0.65);
#ifdef LIGHTING_3D_MODE
float ambient_factor=calculate_ambient_directional_factor(normal);env_light=u_lighting_ambient_color*ambient_factor;
#endif
vec3 envBRDF=EnvBRDFApprox(mat.specularColor,mat.perceptualRoughness,NdotV);vec3 indirectSpecular= envBRDF*env_light;vec3 indirectDiffuse=mat.diffuseColor*env_light;return indirectSpecular+indirectDiffuse;}vec3 computeLightContribution(Material mat,vec3 lightPosition,vec3 lightColor)
{highp vec3 n=mat.normal;highp vec3 v=normalize(-v_position_height.xyz);highp vec3 l=normalize(lightPosition);highp vec3 h=normalize(v+l);float NdotV=clamp(abs(dot(n,v)),0.001,1.0);float NdotL=saturate(dot(n,l));highp float NdotH=saturate(dot(n,h));float VdotH=saturate(dot(v,h));vec3 f=F_SchlickFast(mat.specularColor,VdotH);float g=V_GGXFast(NdotL,NdotV,mat.alphaRoughness);float d=D_GGX(NdotH,mat.alphaRoughness);vec3 diffuseTerm=(1.0-f)*diffuseLambertian(mat);vec3 specularTerm=f*g*d;vec3 transformed_normal=vec3(-n.xy,n.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=NdotL;
#endif
vec3 directLightColor=(specularTerm+diffuseTerm)*lighting_factor*lightColor;vec3 indirectLightColor=computeIndirectLightContribution(mat,NdotV,transformed_normal);vec3 color=(saturate(directLightColor)+indirectLightColor);float intensityFactor=1.0;
#if !defined(LIGHTING_3D_MODE)
const vec3 luminosityFactor=vec3(0.2126,0.7152,0.0722);float luminance=dot(diffuseTerm,luminosityFactor);intensityFactor=mix((1.0-u_lightintensity),max((1.0-luminance+u_lightintensity),1.0),NdotL);
#endif
color*=intensityFactor;return color;}void main() {
#ifdef TERRAIN_FRAGMENT_OCCLUSION
if (isOccluded()) {discard;}
#endif
vec3 lightDir=u_lightpos;vec3 lightColor=u_lightcolor;
#ifdef LIGHTING_3D_MODE
lightDir=u_lighting_directional_dir;lightDir.xy=-lightDir.xy;lightColor=u_lighting_directional_color;
#endif
vec4 finalColor;
#ifdef DIFFUSE_SHADED
vec3 N=getNormal();vec3 diffuse=getDiffuseShadedColor(getBaseColor().rgb,N,lightDir,lightColor);
#ifdef HAS_TEXTURE_u_occlusionTexture
float ao=(texture2D(u_occlusionTexture,uv_2f).r-1.0)*u_aoIntensity+1.0;diffuse*=ao;
#endif
finalColor=vec4(diffuse,1.0)*u_opacity;
#else
Material mat=getPBRMaterial();vec3 color=computeLightContribution(mat,lightDir,lightColor);
#if defined (HAS_TEXTURE_u_occlusionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
float ao=(texture2D(u_occlusionTexture,uv_2f).x-1.0)*u_aoIntensity+1.0;color*=ao;
#endif
vec4 emissive=u_emissiveFactor;
#if defined(HAS_TEXTURE_u_emissionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
emissive.rgb*=sRGBToLinear(texture2D(u_emissionTexture,uv_2f).rgb);
#endif
color+=emissive.rgb;float opacity=mat.baseColor.w*u_opacity;
#ifdef HAS_ATTRIBUTE_a_pbr
float resEmission=v_roughness_metallic_emissive_alpha.z;resEmission*=v_height_based_emission_params.z+v_height_based_emission_params.w*pow(clamp(v_height_based_emission_params.x,0.0,1.0),v_height_based_emission_params.y);color=mix(color,v_color_mix.rgb,min(1.0,resEmission));
#ifdef HAS_ATTRIBUTE_a_color_4f
float distance=length(vec2(1.3*max(0.0,abs(color_4f.x)-color_4f.z),color_4f.y));distance+= mix(0.5,0.0,clamp(resEmission-1.0,0.0,1.0));opacity*=v_roughness_metallic_emissive_alpha.w*saturate(1.0-distance*distance);
#endif
#endif
color=mix(color,mat.baseColor.rgb,u_emissive_strength);color=linearTosRGB(color);color*=opacity;finalColor=vec4(color,opacity);
#endif
#ifdef FOG
finalColor=fog_dither(fog_apply_premultiplied(finalColor,v_fog_pos,v_position_height.w));
#endif
#ifdef RENDER_CUTOFF
finalColor*=v_cutoff_opacity;
#endif
#ifdef INDICATOR_CUTOUT
finalColor=applyCutout(finalColor);
#endif
gl_FragColor=finalColor;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
attribute vec3 a_pos_3f;
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute-vertex-shader-only highp vec4 pbr
#pragma mapbox: define-attribute-vertex-shader-only highp vec3 heightBasedEmissiveStrength
uniform mat4 u_matrix;uniform mat4 u_lighting_matrix;uniform vec3 u_camera_pos;uniform vec4 u_color_mix;
#ifdef INSTANCED_ARRAYS
attribute vec4 a_normal_matrix0;attribute vec4 a_normal_matrix1;attribute vec4 a_normal_matrix2;attribute vec4 a_normal_matrix3;
#else
uniform highp mat4 u_normal_matrix;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth_shadows;
#endif
varying vec4 v_position_height;varying lowp vec4 v_color_mix;
#ifdef TERRAIN_FRAGMENT_OCCLUSION
varying highp float v_depth;
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
varying lowp vec4 v_roughness_metallic_emissive_alpha;varying mediump vec4 v_height_based_emission_params;
#endif
void main() {
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute-custom highp vec4 pbr
#pragma mapbox: initialize-attribute-custom highp vec3 heightBasedEmissiveStrength
highp mat4 normal_matrix;
#ifdef INSTANCED_ARRAYS
normal_matrix=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
normal_matrix=u_normal_matrix;
#endif
vec3 local_pos;mat3 rs;
#ifdef MODEL_POSITION_ON_GPU
vec3 pos_color=normal_matrix[0].xyz;vec4 translate=normal_matrix[1];vec3 pos_a=floor(pos_color);vec3 rgb=1.05*(pos_color-pos_a);float color_mix=pos_a.z/100.0;v_color_mix=vec4(sRGBToLinear(rgb),color_mix);float meter_to_tile=normal_matrix[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);rs[0].x=normal_matrix[1].w;rs[0].yz=normal_matrix[2].xy;rs[1].xy=normal_matrix[2].zw;rs[1].z=normal_matrix[3].x;rs[2].xyz=normal_matrix[3].yzw;vec4 pos_node=u_lighting_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;local_pos=pos.xyz;gl_Position=u_matrix*pos;pos.z*=meter_to_tile;v_position_height.xyz=pos.xyz-u_camera_pos;
#else
local_pos=a_pos_3f;gl_Position=u_matrix*vec4(a_pos_3f,1);v_position_height.xyz=vec3(u_lighting_matrix*vec4(a_pos_3f,1));v_color_mix=vec4(sRGBToLinear(u_color_mix.rgb),u_color_mix.a);
#endif
v_position_height.w=a_pos_3f.z;
#ifdef HAS_ATTRIBUTE_a_pbr
vec4 albedo_c=decode_color(pbr.xy);vec2 e_r_m=unpack_float(pbr.z);vec2 r_m= unpack_float(e_r_m.y*16.0);r_m.r=r_m.r*16.0;v_color_mix=vec4(albedo_c.rgb,1.0);v_roughness_metallic_emissive_alpha=vec4(vec3(r_m,e_r_m.x)/255.0,albedo_c.a);v_roughness_metallic_emissive_alpha.z*=2.0;float heightBasedRelativeIntepolation=a_pos_3f.z*heightBasedEmissiveStrength.x+heightBasedEmissiveStrength.y;v_height_based_emission_params.x=heightBasedRelativeIntepolation;v_height_based_emission_params.y=heightBasedEmissiveStrength.z;vec2 emissionMultiplierValues=unpack_float(pbr.w)/256.0;v_height_based_emission_params.z=emissionMultiplierValues.x;v_height_based_emission_params.w=emissionMultiplierValues.y-emissionMultiplierValues.x;
#endif
#ifdef FOG
v_fog_pos=fog_position(local_pos);
#endif
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
float x_squared_scale=dot(rs[0],rs[0]);float y_squared_scale=dot(rs[1],rs[1]);float z_squared_scale=dot(rs[2],rs[2]);vec3 squared_scale=vec3(x_squared_scale,y_squared_scale,z_squared_scale);normal_3f=rs*((u_lighting_matrix*vec4(normal_3f,0.0)).xyz/squared_scale);normal_3f=normalize(normal_3f);
#else
normal_3f=vec3(normal_matrix*vec4(normal_3f,0));
#endif
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#ifdef HAS_ATTRIBUTE_a_color_4f
v_roughness_metallic_emissive_alpha.w=clamp(color_4f.a*v_roughness_metallic_emissive_alpha.w*(v_roughness_metallic_emissive_alpha.z-1.0),0.0,1.0);
#endif
#endif
#ifdef RENDER_SHADOWS
vec3 shadow_pos=local_pos;
#ifdef NORMAL_OFFSET
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
vec3 offset=shadow_normal_offset(vec3(-normal_3f.xy,normal_3f.z));shadow_pos+=offset*shadow_normal_offset_multiplier0();
#else
vec3 offset=shadow_normal_offset_model(normalize(normal_3f));shadow_pos+=offset*shadow_normal_offset_multiplier0();
#endif
#endif
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shadow_pos,1);v_pos_light_view_1=u_light_matrix_1*vec4(shadow_pos,1);v_depth_shadows=gl_Position.w;
#endif
}`),modelDepth:ji(`varying highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
gl_FragColor=pack_depth(v_depth);
#endif
}`,`attribute vec3 a_pos_3f;uniform mat4 u_matrix;varying highp float v_depth;
#ifdef MODEL_POSITION_ON_GPU
#ifdef INSTANCED_ARRAYS
attribute vec4 a_normal_matrix0;attribute vec4 a_normal_matrix1;attribute vec4 a_normal_matrix2;attribute vec4 a_normal_matrix3;
#else
uniform highp mat4 u_instance;
#endif
uniform highp mat4 u_node_matrix;
#endif
void main() {
#ifdef MODEL_POSITION_ON_GPU
highp mat4 instance;
#ifdef INSTANCED_ARRAYS
instance=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
instance=u_instance;
#endif
vec3 pos_color=instance[0].xyz;vec4 translate=instance[1];vec3 pos_a=floor(pos_color);float meter_to_tile=instance[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);mat3 rs;rs[0].x=instance[1].w;rs[0].yz=instance[2].xy;rs[1].xy=instance[2].zw;rs[1].z=instance[3].x;rs[2].xyz=instance[3].yzw;vec4 pos_node=u_node_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;gl_Position=u_matrix*pos;
#else
gl_Position=u_matrix*vec4(a_pos_3f,1);
#endif
v_depth=gl_Position.z/gl_Position.w;}`),stars:ji(`varying highp vec2 v_uv;varying mediump float v_intensity;float shapeCircle(in vec2 uv)
{float beginFade=0.6;float lengthFromCenter=length(v_uv);return 1.0-clamp((lengthFromCenter-beginFade)/(1.0-beginFade),0.0,1.0);}void main() {float alpha=shapeCircle(v_uv);vec3 color=vec3(1.0,1.0,1.0);alpha*=v_intensity;gl_FragColor=vec4(color*alpha,alpha);HANDLE_WIREFRAME_DEBUG;}`,`
attribute vec3 a_pos_3f;attribute vec2 a_uv;attribute float a_size_scale;attribute float a_fade_opacity;uniform mat4 u_matrix;uniform vec3 u_up;uniform vec3 u_right;uniform float u_intensity_multiplier;varying highp vec2 v_uv;varying mediump float v_intensity;void main() {v_uv=a_uv;v_intensity=a_fade_opacity*u_intensity_multiplier;vec3 pos=a_pos_3f;pos+=a_uv.x*u_right*a_size_scale;pos+=a_uv.y*u_up*a_size_scale;gl_Position=u_matrix*vec4(pos,1.0);}`)};function $2(r,t){const o=r.replace(/\s*\/\/[^\n]*\n/g,`
`).split(`
`);for(let c of o)if(c=c.trim(),c[0]==="#"&&c.includes("if")&&!c.includes("endif")){c=c.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const u=c.split(" ");for(const h of u)t.includes(h)||t.push(h)}}function ji(r,t){const o=/#include\s+"([^"]+)"/g,c=/#pragma mapbox: ([\w\-]+) ([\w]+) ([\w]+) ([\w]+)/g;let u=t.match(/attribute(\S*) (highp |mediump |lowp )?([\w]+) ([\w]+)/g);u&&(u=u.filter((x,w)=>u.indexOf(x)===w));const h={},m=[],g=[];r=r.replace(o,(x,w)=>(g.push(w),"")),t=t.replace(o,(x,w)=>(m.push(w),""));let v=[...zU];$2(r,v),$2(t,v);for(const x of[...m,...g])H2[x]||console.error(`Undefined include: ${x}`),j2[x]||(j2[x]=[],$2(H2[x],j2[x])),v=[...v,...j2[x]];return{fragmentSource:r=r.replace(c,(x,w,E,C,I)=>(h[I]=!0,w==="define"?`
#ifndef HAS_UNIFORM_u_${I}
varying ${E} ${C} ${I};
#else
uniform ${E} ${C} u_${I};
#endif
`:w==="initialize"?`
#ifdef HAS_UNIFORM_u_${I}
    ${E} ${C} ${I} = u_${I};
#endif
`:w==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${I}
    varying ${E} ${C} ${I};
#endif
`:w==="initialize-attribute"?"":void 0)),vertexSource:t=t.replace(c,(x,w,E,C,I)=>{const D=C==="float"?"vec2":C,N=I.match(/color/)?"color":D;return w==="define-attribute-vertex-shader-only"?`
#ifdef HAS_ATTRIBUTE_a_${I}
attribute ${E} ${C} a_${I};
#endif
`:h[I]?w==="define"?`
#ifndef HAS_UNIFORM_u_${I}
uniform lowp float u_${I}_t;
attribute ${E} ${D} a_${I};
varying ${E} ${C} ${I};
#else
uniform ${E} ${C} u_${I};
#endif
`:w==="initialize"?N==="vec4"?`
#ifndef HAS_UNIFORM_u_${I}
    ${I} = a_${I};
#else
    ${E} ${C} ${I} = u_${I};
#endif
`:`
#ifndef HAS_UNIFORM_u_${I}
    ${I} = unpack_mix_${N}(a_${I}, u_${I}_t);
#else
    ${E} ${C} ${I} = u_${I};
#endif
`:w==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${I}
    attribute ${E} ${C} a_${I};
    varying ${E} ${C} ${I};
#endif
`:w==="initialize-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${I}
    ${I} = a_${I};
#endif
`:void 0:w==="define"?`
#ifndef HAS_UNIFORM_u_${I}
uniform lowp float u_${I}_t;
attribute ${E} ${D} a_${I};
#else
uniform ${E} ${C} u_${I};
#endif
`:w==="define-instanced"?N==="mat4"?`
#ifdef INSTANCED_ARRAYS
attribute vec4 a_${I}0;
attribute vec4 a_${I}1;
attribute vec4 a_${I}2;
attribute vec4 a_${I}3;
#else
uniform ${E} ${C} u_${I};
#endif
`:`
#ifdef INSTANCED_ARRAYS
attribute ${E} ${D} a_${I};
#else
uniform ${E} ${C} u_${I};
#endif
`:w==="initialize-attribute-custom"?`
#ifdef HAS_ATTRIBUTE_a_${I}
    ${E} ${C} ${I} = a_${I};
#endif
`:N==="vec4"?`
#ifndef HAS_UNIFORM_u_${I}
    ${E} ${C} ${I} = a_${I};
#else
    ${E} ${C} ${I} = u_${I};
#endif
`:`
#ifndef HAS_UNIFORM_u_${I}
    ${E} ${C} ${I} = unpack_mix_${N}(a_${I}, u_${I}_t);
#else
    ${E} ${C} ${I} = u_${I};
#endif
`}),staticAttributes:u,usedDefines:v,vertexIncludes:m,fragmentIncludes:g}}class nae{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(t,o,c,u,h,m,g,v){this.context=t;let x=this.boundPaintVertexBuffers.length!==u.length;for(let E=0;!x&&E<u.length;E++)this.boundPaintVertexBuffers[E]!==u[E]&&(x=!0);let w=this.boundDynamicVertexBuffers.length!==g.length;for(let E=0;!w&&E<g.length;E++)this.boundDynamicVertexBuffers[E]!==g[E]&&(w=!0);if(!this.vao||this.boundProgram!==o||this.boundLayoutVertexBuffer!==c||x||w||this.boundIndexBuffer!==h||this.boundVertexOffset!==m)this.freshBind(o,c,u,h,m,g,v);else{t.bindVertexArrayOES.set(this.vao);for(const E of g)E&&(E.bind(),v&&E.instanceCount&&E.setVertexAttribDivisor(t.gl,o,v));h&&h.dynamicDraw&&h.bind()}}freshBind(t,o,c,u,h,m,g){const v=t.numAttributes,x=this.context,w=x.gl;this.vao&&this.destroy(),this.vao=x.gl.createVertexArray(),x.bindVertexArrayOES.set(this.vao),this.boundProgram=t,this.boundLayoutVertexBuffer=o,this.boundPaintVertexBuffers=c,this.boundIndexBuffer=u,this.boundVertexOffset=h,this.boundDynamicVertexBuffers=m,o.enableAttributes(w,t),o.bind(),o.setVertexAttribPointers(w,t,h);for(const E of c)E.enableAttributes(w,t),E.bind(),E.setVertexAttribPointers(w,t,h);for(const E of m)E&&(E.enableAttributes(w,t),E.bind(),E.setVertexAttribPointers(w,t,h),g&&E.instanceCount&&E.setVertexAttribDivisor(w,t,g));u&&u.bind(),x.currentNumAttributes=v}destroy(){this.vao&&(this.context.gl.deleteVertexArray(this.vao),this.vao=null)}}function iae(r,t){const o=Math.pow(2,t.canonical.z),c=t.canonical.y;return[new bi(0,c/o).toLngLat().lat,new bi(0,(c+1)/o).toLngLat().lat]}function rae(r,t,o,c,u,h,m){const g=r.context,v=g.gl,x=o.hillshadeFBO;if(!x)return;r.prepareDrawTile();const w=r.isTileAffectedByFog(t),E=r.getOrCreateProgram("hillshade",{overrideFog:w});g.activeTexture.set(v.TEXTURE0),v.bindTexture(v.TEXTURE_2D,x.colorAttachment.get());const C=((W,V,q,Z)=>{const K=q.paint.get("hillshade-shadow-color"),X=q.paint.get("hillshade-highlight-color"),J=q.paint.get("hillshade-accent-color"),ae=q.paint.get("hillshade-emissive-strength");let ce=ye(q.paint.get("hillshade-illumination-direction"));if(q.paint.get("hillshade-illumination-anchor")==="viewport")ce-=W.transform.angle;else if(W.style&&W.style.enable3dLights()&&W.style.directionalLight){const ve=W.style.directionalLight.properties.get("direction");ce=ye(de(ve.x,ve.y,ve.z)[1])}const ge=!W.options.moving;return{u_matrix:Z||W.transform.calculateProjMatrix(V.tileID.toUnwrapped(),ge),u_image:0,u_latrange:iae(0,V.tileID),u_light:[q.paint.get("hillshade-exaggeration"),ce],u_shadow:K,u_highlight:X,u_emissive_strength:ae,u_accent:J}})(r,o,c,r.terrain?t.projMatrix:null);r.uploadCommonUniforms(g,E,t.toUnwrapped());const{tileBoundsBuffer:I,tileBoundsIndexBuffer:D,tileBoundsSegments:N}=r.getTileBoundsBuffers(o);E.draw(r,v.TRIANGLES,u,h,m,mi.disabled,C,c.id,I,D,N)}function UU(r,t,o){if(!t.needsDEMTextureUpload)return;const c=r.context,u=c.gl;c.pixelStoreUnpackPremultiplyAlpha.set(!1),t.demTexture=t.demTexture||r.getTileTexture(o.stride);const h=o.getPixels();t.demTexture?t.demTexture.update(h,{premultiply:!1}):t.demTexture=new xa(c,h,r.terrainUseFloatDEM()?u.R32F:u.RGBA,{premultiply:!1}),t.needsDEMTextureUpload=!1}function aae(r,t,o){const c=r.context,u=c.gl;if(!t.dem)return;const h=t.dem;if(c.activeTexture.set(u.TEXTURE1),UU(r,t,h),!t.demTexture)return;t.demTexture.bind(u.NEAREST,u.CLAMP_TO_EDGE);const m=h.dim;c.activeTexture.set(u.TEXTURE0);let g=t.hillshadeFBO;if(!g){const C=new xa(c,{width:m,height:m,data:null},u.RGBA);C.bind(u.LINEAR,u.CLAMP_TO_EDGE),g=t.hillshadeFBO=c.createFramebuffer(m,m,!0,"renderbuffer"),g.colorAttachment.set(C.texture)}c.bindFramebuffer.set(g.framebuffer),c.viewport.set([0,0,m,m]);const{tileBoundsBuffer:v,tileBoundsIndexBuffer:x,tileBoundsSegments:w}=r.getMercatorTileBoundsBuffers(),E=[];r.terrainUseFloatDEM()&&E.push("TERRAIN_DEM_FLOAT_FORMAT"),r.getOrCreateProgram("hillshadePrepare",{defines:E}).draw(r,u.TRIANGLES,Fn.disabled,hi.disabled,Ri.unblended,mi.disabled,((C,I)=>{const D=I.stride,N=at.create();return at.ortho(N,0,mt,-mt,0,0,1),at.translate(N,N,[0,-mt,0]),{u_matrix:N,u_image:1,u_dimension:[D,D],u_zoom:C.overscaledZ,u_unpack:I.unpackVector}})(t.tileID,h),o.id,v,x,w),t.needsHillshadePrepare=!1}const WU=r=>({u_matrix:new qn(r),u_image0:new di(r),u_skirt_height:new Jt(r),u_ground_shadow_factor:new Kn(r)}),VU=(r,t,o)=>({u_matrix:r,u_image0:0,u_skirt_height:t,u_ground_shadow_factor:o}),GU=(r,t,o,c,u,h,m,g,v,x,w,E,C,I,D)=>({u_proj_matrix:Float32Array.from(r),u_globe_matrix:t,u_normalize_matrix:Float32Array.from(c),u_merc_matrix:o,u_zoom_transition:u,u_merc_center:h,u_image0:0,u_frustum_tl:m,u_frustum_tr:g,u_frustum_br:v,u_frustum_bl:x,u_globe_pos:w,u_globe_radius:E,u_viewport:C,u_grid_matrix:D?Float32Array.from(D):new Float32Array(9),u_skirt_height:I}),Rv=(r,t)=>{if(t>0&&r.terrain&&xe("Cutoff is currently disabled on terrain"),t<=0||r.terrain)return{shouldRenderCutoff:!1,uniformValues:{u_cutoff_params:[0,0,0,0]}};const o=r.transform,c=Math.max(Math.abs(o._zoom-(r.minCutoffZoom-1)),1),u=o.isLODDisabled(!1)?Te(60,45,o.pitch):Te(30,15,o.pitch),h=o._farZ-o._nearZ,m=t*o.height,g=((1-(v=u))*(.75*o.cameraToCenterDistance)+v*(o._farZ+m))*c;var v;return{shouldRenderCutoff:u<1,uniformValues:{u_cutoff_params:[o._nearZ,o._farZ,(g-o._nearZ)/h,(g-m-o._nearZ)/h]}}};function HU(r,t){return r!=null&&t!=null&&!(!r.hasData()||!t.hasData())&&r.demTexture!=null&&t.demTexture!=null&&r.tileID.key!==t.tileID.key}const Lv=new class{constructor(){this.operations={}}newMorphing(r,t,o,c,u){if(r in this.operations){const h=this.operations[r];h.to.tileID.key!==o.tileID.key&&(h.queued=o)}else this.operations[r]={startTime:c,phase:0,duration:u,from:t,to:o,queued:null}}getMorphValuesForProxy(r){if(!(r in this.operations))return null;const t=this.operations[r];return{from:t.from,to:t.to,phase:t.phase}}update(r){for(const t in this.operations){const o=this.operations[t];for(o.phase=(r-o.startTime)/o.duration;o.phase>=1||!this._validOp(o);)if(!this._nextOp(o,r)){delete this.operations[t];break}}}_nextOp(r,t){return!!r.queued&&(r.from=r.to,r.to=r.queued,r.queued=null,r.phase=0,r.startTime=t,!0)}_validOp(r){return r.from.hasData()&&r.to.hasData()}},jU={0:null,1:"TERRAIN_VERTEX_MORPHING"};function $U(r,t,o){if(t===0)return 0;const c=t<1&&o===514?.25/t:1;return 6*Math.pow(1.5,22-r)*Math.max(t,1)*c}function oae(r,t){const o=1<<r.z;return!t&&(r.x===0||r.x===o-1)||r.y===0||r.y===o-1}const LI=r=>({u_matrix:r});function YU(r,t,o,c,u){if(u>0){const h=Pn.now(),m=(h-r.timeAdded)/u,g=t?(h-t.timeAdded)/u:-1,v=o.getSource(),x=c.coveringZoomLevel({tileSize:v.tileSize,roundZoom:v.roundZoom}),w=!t||Math.abs(t.tileID.overscaledZ-x)>Math.abs(r.tileID.overscaledZ-x),E=w&&r.refreshedUponExpiration?1:re(w?m:1-g,0,1);return r.refreshedUponExpiration&&m>=1&&(r.refreshedUponExpiration=!1),t?{opacity:1,mix:1-E}:{opacity:E,mix:0}}return{opacity:1,mix:0}}class sae extends tu{constructor(t){const o={type:"raster-dem",maxzoom:t.transform.maxZoom},c=new Nm(j1(),null),u=EI("mock-dem",o,c,t.style);super("mock-dem",u,!1),u.setEventedParent(this),this._sourceLoaded=!0}_loadTile(t,o){t.state="loaded",o(null)}}class lae extends tu{constructor(t){const o=EI("proxy",{type:"geojson",maxzoom:t.transform.maxZoom},new Nm(j1(),null),t.style);super("proxy",o,!1),o.setEventedParent(this),this.map=this.getSource().map=t,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(t,o,c){if(t.freezeTileCoverage)return;this.transform=t;const u=t.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((h,m)=>{if(h[m.key]="",!this._tiles[m.key]){const g=new k1(m,this._source.tileSize*m.overscaleFactor(),t.tileZoom);g.state="loaded",this._tiles[m.key]=g}return h},{});for(const h in this._tiles)h in u||(this.freeFBO(h),this._tiles[h].unloadVectorData(),delete this._tiles[h])}freeFBO(t){const o=this.proxyCachedFBO[t];if(o!==void 0){const c=Object.values(o);this.renderCachePool.push(...c),delete this.proxyCachedFBO[t]}}deallocRenderCache(){this.renderCache.forEach(t=>t.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class qU extends ki{constructor(t,o,c){super(t.overscaledZ,t.wrap,t.canonical.z,t.canonical.x,t.canonical.y),this.proxyTileKey=o,this.projMatrix=c}}class cae extends Wte{constructor(t,o){super(),this.painter=t,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[c,u,h]=function(v){const x=new ee,w=new Un,E=131;x.reserve(17161),w.reserve(33800);const C=mt/128,I=mt+C/2,D=I+C;for(let W=-C;W<D;W+=C)for(let V=-C;V<D;V+=C){const q=V<0||V>I||W<0||W>I?24575:0,Z=re(Math.round(V),0,mt),K=re(Math.round(W),0,mt);x.emplaceBack(Z+q,K)}const N=(W,V)=>{const q=V*E+W;w.emplaceBack(q+1,q,q+E),w.emplaceBack(q+E,q+E+1,q+1)};for(let W=1;W<129;W++)for(let V=1;V<129;V++)N(V,W);return[0,129].forEach(W=>{for(let V=0;V<130;V++)N(V,W),N(W,V)}),[x,w,32768]}(),m=t.context;this.gridBuffer=m.createVertexBuffer(c,Ef.members),this.gridIndexBuffer=m.createIndexBuffer(u),this.gridSegments=qi.simpleSegment(0,0,c.length,u.length),this.gridNoSkirtSegments=qi.simpleSegment(0,0,c.length,h),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new lae(o.map),this.orthoMatrix=at.create(),at.ortho(this.orthoMatrix,this.painter.transform.projection.name==="globe"?.015:0,mt,0,mt,0,1);const g=m.gl;this._overlapStencilMode=new hi({func:g.GEQUAL,mask:255},0,255,g.KEEP,g.KEEP,g.REPLACE),this._previousZoom=t.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=o,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new sae(o.map),this._pendingGroundEffectLayers=[]}set style(t){t.on("data",this._onStyleDataEvent.bind(this)),this._style=t,this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(t,o,c){if(t&&t.terrain){this._style!==t&&(this.style=t,this._evaluationZoom=void 0);const u=t.terrain.properties,h=t.terrain.drapeRenderMode===0,m=t.terrain.isZoomDependent();this._previousUpdateTimestamp=this.enabled?this._updateTimestamp:void 0,this._updateTimestamp=Pn.now();const g=t.terrain&&t.terrain.scope,v=u.get("source"),x=h?this._mockSourceCache:t.getSourceCache(v,g);if(!x)return void xe(`Couldn't find terrain source "${v}".`);if(this.sourceCache=x,this._exaggeration=m?this.calculateExaggeration(o):u.get("exaggeration"),!o.projection.requiresDraping&&m&&this._exaggeration===0)return void this._disable();this.enabled=!0;const w=()=>{this.sourceCache.used&&xe(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const E=this.getScaledDemTileSize();this.sourceCache.update(o,E,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,w(),this._initializing=!0),w(),o.updateElevation(!0,c),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(o),this._emptyDEMTextureDirty=!0,this._previousZoom=o.zoom}else this._disable()}calculateExaggeration(t){const o=this._previousCameraAltitude,c=t.getFreeCameraOptions().position.z/t.pixelsPerMeter*t.worldSize;this._previousCameraAltitude=c;const u=o!=null?c-o:Number.MAX_VALUE;if(Math.abs(u)<2)return this._exaggeration;const h=t.zoom,m=this._style.terrain;if(!this._previousUpdateTimestamp)return m.getExaggeration(h);let g=h-this._previousZoom;const v=this._previousUpdateTimestamp;let x=h;this._evaluationZoom!=null&&(x=this._evaluationZoom,Math.abs(h-x)>.5&&(g=.5*(h-x+g)),g*u<0&&(x+=g)),this._evaluationZoom=x;const w=m.getExaggeration(x),E=w===m.getExaggeration(Math.max(0,x-.1));if(E&&Math.abs(w-this._exaggeration)<.01)return w;let C=Math.min(.1,.00375*(this._updateTimestamp-v));return(E||w<.1||Math.abs(g)<1e-4)&&(C=Math.min(.2,4*C)),kn(this._exaggeration,w,C)}resetTileLookupCache(t){this._findCoveringTileCache[t]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_onStyleDataEvent(t){t.coord&&t.dataType==="source"?this._clearRenderCacheForTile(t.sourceCacheId,t.coord):t.dataType==="style"&&(this.invalidateRenderCache=!0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this._previousCameraAltitude=void 0)}_disable(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const t in this._style._mergedSourceCaches)this._style._mergedSourceCaches[t].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this._emptyDepthBufferTexture&&this._emptyDepthBufferTexture.destroy(),this.pool.forEach(t=>t.fb.destroy()),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),this.framebufferCopyTexture&&this.framebufferCopyTexture.destroy()}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this._exaggeration}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const t=2*this.proxySourceCache.getSource().tileSize;return[t,t]}set useVertexMorphing(t){this._useVertexMorphing=t}updateTileBinding(t){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const o=this.proxySourceCache,c=this.painter.transform;this._initializing&&(this._initializing=c._centerAltitude===0&&this.getAtPointOrZero(bi.fromLngLat(c.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);const u=this.proxyCoords=o.getIds().map(v=>{const x=o.getTileByID(v).tileID;return x.projMatrix=c.calculateProjMatrix(x.toUnwrapped()),x});(function(v,x){const w=x.transform.pointCoordinate(x.transform.getCameraPoint()),E=new G(w.x,w.y);v.sort((C,I)=>{if(I.overscaledZ-C.overscaledZ)return I.overscaledZ-C.overscaledZ;const D=new G(C.canonical.x+(1<<C.canonical.z)*C.wrap,C.canonical.y),N=new G(I.canonical.x+(1<<I.canonical.z)*I.wrap,I.canonical.y),W=E.mult(1<<C.canonical.z);return W.x-=.5,W.y-=.5,W.distSqr(D)-W.distSqr(N)})})(u,this.painter);const h=this.proxyToSource||{};this.proxyToSource={},u.forEach(v=>{this.proxyToSource[v.key]={}}),this.terrainTileForTile={};const m=this._style._mergedSourceCaches;for(const v in m){const x=m[v];if(!x.used||(x!==this.sourceCache&&this.resetTileLookupCache(x.id),this._setupProxiedCoordsForOrtho(x,t[v],h),x.usedForTerrain))continue;const w=t[v];x.getSource().reparseOverscaled&&this._assignTerrainTiles(w)}this.proxiedCoords[o.id]=u.map(v=>new qU(v,v.key,this.orthoMatrix)),this._assignTerrainTiles(u),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(h),this.renderingToTexture=!1;const g={};this._visibleDemTiles=[];for(const v of this.proxyCoords){const x=this.terrainTileForTile[v.key];if(!x)continue;const w=x.tileID.key;w in g||(this._visibleDemTiles.push(x),g[w]=w)}}_assignTerrainTiles(t){this._initializing||t.forEach(o=>{if(this.terrainTileForTile[o.key])return;const c=this._findTileCoveringTileID(o,this.sourceCache);c&&(this.terrainTileForTile[o.key]=c)})}_prepareDEMTextures(){const t=this.painter.context,o=t.gl;for(const c in this.terrainTileForTile){const u=this.terrainTileForTile[c],h=u.dem;!h||u.demTexture&&!u.needsDEMTextureUpload||(t.activeTexture.set(o.TEXTURE1),UU(this.painter,u,h))}}_prepareDemTileUniforms(t,o,c,u){if(!o||o.demTexture==null)return!1;const h=t.tileID.canonical,m=Math.pow(2,o.tileID.canonical.z-h.z),g=u||"";return c[`u_dem_tl${g}`]=[h.x*m%1,h.y*m%1],c[`u_dem_scale${g}`]=m,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}get emptyDepthBufferTexture(){const t=this.painter.context,o=t.gl;if(!this._emptyDepthBufferTexture){const c=new Jr({width:1,height:1},Uint8Array.of(255,255,255,255));this._emptyDepthBufferTexture=new xa(t,c,o.RGBA,{premultiply:!1})}return this._emptyDepthBufferTexture}_getLoadedAreaMinimum(){let t=0;const o=this._visibleDemTiles.reduce((c,u)=>{if(!u.dem)return c;const h=u.dem.tree.minimums[0];return h>0&&t++,c+h},0);return t?o/t:0}_updateEmptyDEMTexture(){const t=this.painter.context,o=t.gl;t.activeTexture.set(o.TEXTURE2);const c=this._getLoadedAreaMinimum(),[u,h]=(()=>{if(this.painter.terrainUseFloatDEM()){const g=new FF({width:1,height:1},new Float32Array([c]));return[o.R32F,g]}{const g=new Jr({width:1,height:1},new Uint8Array(Rm.pack(c,this.sourceCache.getSource().encoding)));return[o.RGBA,g]}})();this._emptyDEMTextureDirty=!1;let m=this._emptyDEMTexture;return m?m.update(h,{premultiply:!1}):m=this._emptyDEMTexture=new xa(t,h,u,{premultiply:!1}),m}setupElevationDraw(t,o,c){const u=this.painter.context,h=u.gl,m=(g=this.sourceCache.getSource().encoding,{u_dem:2,u_dem_prev:4,u_dem_unpack:Rm.getUnpackVector(g),u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0});var g;m.u_exaggeration=this.exaggeration();let v=null,x=null,w=1;if(c&&c.morphing&&this._useVertexMorphing){const I=c.morphing.srcDemTile,D=c.morphing.dstDemTile;w=c.morphing.phase,I&&D&&(this._prepareDemTileUniforms(t,I,m,"_prev")&&(x=I),this._prepareDemTileUniforms(t,D,m)&&(v=D))}const E=I=>I&&I.demTexture&&this.painter.terrainUseFloatDEM()?h.LINEAR:h.NEAREST,C=I=>{m.u_dem_size=I.size[0]===1?1:I.size[0]-2};if(x&&v)u.activeTexture.set(h.TEXTURE2),v.demTexture.bind(E(v),h.CLAMP_TO_EDGE),u.activeTexture.set(h.TEXTURE4),x.demTexture.bind(E(x),h.CLAMP_TO_EDGE),v.demTexture&&C(v.demTexture),m.u_dem_lerp=w;else{v=this.terrainTileForTile[t.tileID.key],u.activeTexture.set(h.TEXTURE2);const I=this._prepareDemTileUniforms(t,v,m)?v.demTexture:this.emptyDEMTexture;I.bind(E(v),h.CLAMP_TO_EDGE),C(I)}if(u.activeTexture.set(h.TEXTURE3),c&&c.useDepthForOcclusion?(this._depthTexture&&this._depthTexture.bind(h.NEAREST,h.CLAMP_TO_EDGE),this._depthFBO&&(m.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height])):(this.emptyDepthBufferTexture.bind(h.NEAREST,h.CLAMP_TO_EDGE),m.u_depth_size_inv=[1,1]),c&&c.useMeterToDem&&v){const I=(1<<v.tileID.canonical.z)*Xi(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;m.u_meter_to_dem=I}if(c&&c.labelPlaneMatrixInv&&(m.u_label_plane_matrix_inv=c.labelPlaneMatrixInv),o.setTerrainUniformValues(u,m),this.painter.transform.projection.name==="globe"){const I=this.globeUniformValues(this.painter.transform,t.tileID.canonical,c&&c.useDenormalizedUpVectorScale);o.setGlobeUniformValues(u,I)}}globeUniformValues(t,o,c){const u=t.projection;return{u_tile_tl_up:u.upVector(o,0,0),u_tile_tr_up:u.upVector(o,mt,0),u_tile_br_up:u.upVector(o,mt,mt),u_tile_bl_up:u.upVector(o,0,mt),u_tile_up_scale:c?WS(1):u.upVectorScale(o,t.center.lat,t.worldSize).metersToTile}}renderToBackBuffer(t){const o=this.painter,c=this.painter.context;t.length!==0&&(c.bindFramebuffer.set(null),c.viewport.set([0,0,o.width,o.height]),o.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(u,h,m,g,v){if(u.transform.projection.name==="globe")(function(x,w,E,C,I){const D=x.context,N=D.gl;let W,V;const q=x.transform,Z=yF(x,D,q),K=(Le,Ee)=>{if(V===Ee)return;const He=[jU[Ee],"PROJECTION_GLOBE_VIEW"];Z&&He.push("CUSTOM_ANTIALIASING");const Ke=x.isTileAffectedByFog(Le);W=x.getOrCreateProgram("globeRaster",{defines:He,overrideFog:Ke}),V=Ee},X=x.colorModeForRenderPass(),J=new Fn(N.LEQUAL,Fn.ReadWrite,x.depthRangeFor3D);Lv.update(I);const ae=function(Le){const Ee=Le.pixelsPerMeter,He=Ee/Xi(1,Le.center.lat),Ke=at.identity(new Float64Array(16));return at.translate(Ke,Ke,[Le.point.x,Le.point.y,0]),at.scale(Ke,Ke,[He,He,Ee]),Float32Array.from(Ke)}(q),ce=[xo(q.center.lng),Io(q.center.lat)],ge=x.globeSharedBuffers,ve=[q.width*Pn.devicePixelRatio,q.height*Pn.devicePixelRatio],Pe=Float32Array.from(q.globeMatrix),Me={useDenormalizedUpVectorScale:!0};{const Le=x.transform,Ee=$U(Le.zoom,w.exaggeration(),w.sourceCache._source.tileSize);V=-1;const He=N.TRIANGLES;for(const Ke of C){const nt=E.getTile(Ke),Ve=hi.disabled,je=w.prevTerrainTileForTile[Ke.key],ot=w.terrainTileForTile[Ke.key];HU(je,ot)&&Lv.newMorphing(Ke.key,je,ot,I,250),D.activeTexture.set(N.TEXTURE0),nt.texture.bind(N.LINEAR,N.CLAMP_TO_EDGE);const yt=Lv.getMorphValuesForProxy(Ke.key),ft=yt?1:0;yt&&Rs(Me,{morphing:{srcDemTile:yt.from,dstDemTile:yt.to,phase:Re(yt.phase)}});const Lt=VS(Ke.canonical),Ft=kee(Lt.getCenter().lat),St=Lee(Ke.canonical,Lt,Ft,Le.worldSize/Le._pixelsPerMercatorPixel),Ct=Pm(bc(Ke.canonical)),rn=GU(Le.projMatrix,Pe,ae,Ct,_o(Le.zoom),ce,Le.frustumCorners.TL,Le.frustumCorners.TR,Le.frustumCorners.BR,Le.frustumCorners.BL,Le.globeCenterInViewSpace,Le.globeRadius,ve,Ee,St);if(K(Ke,ft),W&&(w.setupElevationDraw(nt,W,Me),x.uploadCommonUniforms(D,W,Ke.toUnwrapped()),ge)){const[ln,sn,un]=ge.getGridBuffers(Ft,Ee!==0);W.draw(x,He,J,Ve,X,mi.backCCW,rn,"globe_raster",ln,sn,un)}}}if(ge&&(x.renderDefaultNorthPole||x.renderDefaultSouthPole)){const Le=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];Z&&Le.push("CUSTOM_ANTIALIASING"),W=x.getOrCreateProgram("globeRaster",{defines:Le});for(const Ee of C){const{x:He,y:Ke,z:nt}=Ee.canonical,Ve=Ke===0,je=Ke===(1<<nt)-1,[ot,yt,ft,Lt]=ge.getPoleBuffers(nt,!1);if(Lt&&(Ve||je)){const Ft=E.getTile(Ee);D.activeTexture.set(N.TEXTURE0),Ft.texture.bind(N.LINEAR,N.CLAMP_TO_EDGE);let St=gF(nt,He,q);const Ct=Pm(bc(Ee.canonical)),rn=(ln,sn)=>ln.draw(x,N.TRIANGLES,J,hi.disabled,X,mi.disabled,GU(q.projMatrix,St,St,Ct,0,ce,q.frustumCorners.TL,q.frustumCorners.TR,q.frustumCorners.BR,q.frustumCorners.BL,q.globeCenterInViewSpace,q.globeRadius,ve,0),"globe_pole_raster",sn,ft,Lt);w.setupElevationDraw(Ft,W,Me),x.uploadCommonUniforms(D,W,Ee.toUnwrapped()),Ve&&x.renderDefaultNorthPole&&rn(W,ot),je&&x.renderDefaultSouthPole&&(St=at.scale(at.create(),St,[1,-1,1]),rn(W,yt))}}}})(u,h,m,g,v);else{const x=u.context,w=x.gl;let E,C;const I=u.shadowRenderer,D=Rv(u,u.longestCutoffRange),N=X=>{if(C===X)return;const J=[];J.push(jU[X]),D.shouldRenderCutoff&&J.push("RENDER_CUTOFF"),E=u.getOrCreateProgram("terrainRaster",{defines:J}),C=X},W=u.colorModeForRenderPass(),V=new Fn(w.LEQUAL,Fn.ReadWrite,u.depthRangeFor3D);Lv.update(v);const q=u.transform,Z=$U(q.zoom,h.exaggeration(),h.sourceCache._source.tileSize);let K=[0,0,0];if(I){const X=u.style.directionalLight,J=u.style.ambientLight;X&&J&&(K=NI(X,J))}{C=-1;const X=w.TRIANGLES,[J,ae]=[h.gridIndexBuffer,h.gridSegments];for(const ce of g){const ge=m.getTile(ce),ve=hi.disabled,Pe=h.prevTerrainTileForTile[ce.key],Me=h.terrainTileForTile[ce.key];HU(Pe,Me)&&Lv.newMorphing(ce.key,Pe,Me,v,250),x.activeTexture.set(w.TEXTURE0),ge.texture.bind(w.LINEAR,w.CLAMP_TO_EDGE,w.LINEAR_MIPMAP_NEAREST);const Le=Lv.getMorphValuesForProxy(ce.key),Ee=Le?1:0;let He;Le&&(He={morphing:{srcDemTile:Le.from,dstDemTile:Le.to,phase:Re(Le.phase)}});const Ke=VU(ce.projMatrix,oae(ce.canonical,q.renderWorldCopies)?Z/10:Z,K);if(N(Ee),!E)continue;h.setupElevationDraw(ge,E,He);const nt=ce.toUnwrapped();I&&I.setupShadows(nt,E),u.uploadCommonUniforms(x,E,nt,null,D),E.draw(u,X,V,ve,W,mi.backCCW,Ke,"terrain_raster",h.gridBuffer,J,ae)}}}}(o,this,this.proxySourceCache,t,this._updateTimestamp),this.renderingToTexture=!0,o.gpuTimingDeferredRenderEnd(),t.splice(0,t.length))}renderBatch(t){if(this._drapedRenderBatches.length===0)return t+1;this.renderingToTexture=!0;const o=this.painter,c=this.painter.context,u=this.proxySourceCache,h=this.proxiedCoords[u.id],m=this._drapedRenderBatches.shift(),g=o.style.order,v=[];let x=0;for(const w of h){const E=u.getTileByID(w.proxyTileKey),C=u.proxyCachedFBO[w.key]?u.proxyCachedFBO[w.key][t]:void 0,I=C!==void 0?u.renderCache[C]:this.pool[x++],D=C!==void 0;if(E.texture=I.tex,D&&!I.dirty){v.push(E.tileID);continue}let N;c.bindFramebuffer.set(I.fb.framebuffer),this.renderedToTile=!1,I.dirty&&(c.clear({color:En.transparent,stencil:0}),I.dirty=!1);for(let W=m.start;W<=m.end;++W){const V=o.style._mergedLayers[g[W]];if(V.isHidden(o.transform.zoom))continue;const q=o.style.getLayerSourceCache(V),Z=q?this.proxyToSource[w.key][q.id]:[w];if(!Z)continue;const K=Z;c.viewport.set([0,0,I.fb.width,I.fb.height]),N!==(q?q.id:null)&&(this._setupStencil(I,Z,V,q),N=q?q.id:null),o.renderLayer(o,q,V,K)}if(this._drapedRenderBatches.length===0)for(const W of this._pendingGroundEffectLayers){const V=o.style._mergedLayers[g[W]];if(V.isHidden(o.transform.zoom))continue;const q=o.style.getLayerSourceCache(V),Z=q?this.proxyToSource[w.key][q.id]:[w];if(!Z)continue;const K=Z;c.viewport.set([0,0,I.fb.width,I.fb.height]),N!==(q?q.id:null)&&(this._setupStencil(I,Z,V,q),N=q?q.id:null),o.renderLayer(o,q,V,K)}this.renderedToTile?(I.dirty=!0,v.push(E.tileID)):D||--x,x===5&&(x=0,this.renderToBackBuffer(v))}return this.renderToBackBuffer(v),this.renderingToTexture=!1,c.bindFramebuffer.set(null),c.viewport.set([0,0,o.width,o.height]),m.end+1}postRender(){}isLayerOrderingCorrect(t){const o=t.order.length;let c=-1,u=o;for(let h=0;h<o;++h)this._style.isLayerDraped(t._mergedLayers[t.order[h]])?c=Math.max(c,h):u=Math.min(u,h);return u>c}getMinElevationBelowMSL(){let t=0;return this._visibleDemTiles.filter(o=>o.dem).forEach(o=>{t=Math.min(t,o.dem.tree.minimums[0])}),t===0?t:(t-30)*this._exaggeration}raycast(t,o,c){if(!this._visibleDemTiles)return null;const u=this._visibleDemTiles.filter(h=>h.dem).map(h=>{const m=h.tileID,g=1<<m.overscaledZ,{x:v,y:x}=m.canonical,w=v/g,E=(v+1)/g,C=x/g,I=(x+1)/g;return{minx:w,miny:C,maxx:E,maxy:I,t:h.dem.tree.raycastRoot(w,C,E,I,t,o,c),tile:h}});u.sort((h,m)=>(h.t!==null?h.t:Number.MAX_VALUE)-(m.t!==null?m.t:Number.MAX_VALUE));for(const h of u){if(h.t==null)return null;const m=h.tile.dem.tree.raycast(h.minx,h.miny,h.maxx,h.maxy,t,o,c);if(m!=null)return m}return null}_createFBO(){const t=this.painter.context,o=t.gl,c=this.drapeBufferSize;t.activeTexture.set(o.TEXTURE0);const u=new xa(t,{width:c[0],height:c[1],data:null},o.RGBA);u.bind(o.LINEAR,o.CLAMP_TO_EDGE);const h=t.createFramebuffer(c[0],c[1],!0,null);return h.colorAttachment.set(u.texture),h.depthAttachment=new gie(t,h.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=t.createRenderbuffer(t.gl.DEPTH_STENCIL,c[0],c[1]),this._stencilRef=0,h.depthAttachment.set(this._sharedDepthStencil),t.clear({stencil:0})):h.depthAttachment.set(this._sharedDepthStencil),t.extTextureFilterAnisotropic&&!t.extTextureFilterAnisotropicForceOff&&o.texParameterf(o.TEXTURE_2D,t.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,t.extTextureFilterAnisotropicMax),{fb:h,tex:u,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._style.hasLightTransitions())return!0;for(const t in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[t].hasTransition())return!0;return this._style.order.some(t=>{const o=this._style._mergedLayers[t],c=o.isHidden(this.painter.transform.zoom);return o.type==="custom"?!c&&o.shouldRedrape():!c&&o.hasTransition()})}_clearLineLayersFromRenderCache(){let t=!1;for(const c of this._style.getSources())if(c instanceof aU){t=!0;break}if(!t)return;const o={};for(let c=0;c<this._style.order.length;++c){const u=this._style._mergedLayers[this._style.order[c]],h=this._style.getLayerSourceCache(u);if(h&&!o[h.id]&&!u.isHidden(this.painter.transform.zoom)&&u.type==="line"&&u.widthExpression()instanceof jc){o[h.id]=!0;for(const m of this.proxyCoords){const g=this.proxyToSource[m.key][h.id];if(g)for(const v of g)this._clearRenderCacheForTile(h.id,v)}}}}_clearRasterLayersFromRenderCache(){let t=!1;for(const c in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[c]._source instanceof G1){t=!0;break}if(!t)return;const o={};for(let c=0;c<this._style.order.length;++c){const u=this._style._mergedLayers[this._style.order[c]],h=this._style.getLayerSourceCache(u);if(!h||o[h.id]||u.isHidden(this.painter.transform.zoom)||u.type!=="raster")continue;const m=u.paint.get("raster-fade-duration");for(const g of this.proxyCoords){const v=this.proxyToSource[g.key][h.id];if(v)for(const x of v){const w=YU(h.getTile(x),h.findLoadedParent(x,0),h,this.painter.transform,m);(w.opacity!==1||w.mix!==0)&&this._clearRenderCacheForTile(h.id,x)}}}}_setupDrapedRenderBatches(){const t=this._style.order,o=t.length;if(o===0)return;const c=[];this._pendingGroundEffectLayers=[];let u,h=0,m=this._style._mergedLayers[t[h]];for(;!this._style.isLayerDraped(m)&&m.isHidden(this.painter.transform.zoom)&&++h<o;)m=this._style._mergedLayers[t[h]];for(;h<o;++h){const g=this._style._mergedLayers[t[h]];g.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(g)?u===void 0&&(u=h):(g.type==="fill-extrusion"&&this._pendingGroundEffectLayers.push(h),u!==void 0&&(c.push({start:u,end:h-1}),u=void 0)))}if(u!==void 0&&c.push({start:u,end:h-1}),c.length!==0){const g=c[c.length-1];this._pendingGroundEffectLayers.every(x=>x>g.end)||xe("fill-extrusion with flood lighting and/or ground ambient occlusion should be moved to be on top of all draped layers.")}this._drapedRenderBatches=c}_setupRenderCache(t){const o=this.proxySourceCache;if(this._shouldDisableRenderCache()||this.invalidateRenderCache){if(this.invalidateRenderCache=!1,o.renderCache.length>o.renderCachePool.length){const m=Object.values(o.proxyCachedFBO);o.proxyCachedFBO={};for(let g=0;g<m.length;++g){const v=Object.values(m[g]);o.renderCachePool.push(...v)}}return}this._clearRasterLayersFromRenderCache();const c=this.proxyCoords,u=this._tilesDirty;for(let m=c.length-1;m>=0;m--){const g=c[m];if(o.getTileByID(g.key),o.proxyCachedFBO[g.key]!==void 0){const v=t[g.key],x=this.proxyToSource[g.key];let w=0;for(const E in x){const C=x[E],I=v[E];if(!I||I.length!==C.length||C.some((D,N)=>D!==I[N]||u[E]&&u[E].hasOwnProperty(D.key))){w=-1;break}++w}for(const E in o.proxyCachedFBO[g.key])o.renderCache[o.proxyCachedFBO[g.key][E]].dirty=w<0||w!==Object.values(v).length}}const h=[...this._drapedRenderBatches];h.sort((m,g)=>g.end-g.start-(m.end-m.start));for(const m of h)for(const g of c){if(o.proxyCachedFBO[g.key])continue;let v=o.renderCachePool.pop();v===void 0&&o.renderCache.length<50&&(v=o.renderCache.length,o.renderCache.push(this._createFBO())),v!==void 0&&(o.proxyCachedFBO[g.key]={},o.proxyCachedFBO[g.key][m.start]=v,o.renderCache[v].dirty=!0)}this._tilesDirty={}}_setupStencil(t,o,c,u){if(!u||!this._sourceTilesOverlap[u.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const h=this.painter.context,m=h.gl;if(o.length<=1)return void(this._overlapStencilType=!1);let g;if(c.isTileClipped())g=o.length,this._overlapStencilMode.test={func:m.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(o[0].overscaledZ>o[o.length-1].overscaledZ))return void(this._overlapStencilType=!1);g=1,this._overlapStencilMode.test={func:m.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+g>255&&(h.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=g,this._overlapStencilMode.ref=this._stencilRef,c.isTileClipped()&&this._renderTileClippingMasks(o,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return this._overlapStencilType==="Clip"||this._overlapStencilType==="Mask"}stencilModeForRTTOverlap(t){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[t.key]),this._overlapStencilMode):hi.disabled}_renderTileClippingMasks(t,o){const c=this.painter,u=this.painter.context,h=u.gl;c._tileClippingMaskIDs={},u.setColorMode(Ri.disabled),u.setDepthMode(Fn.disabled);const m=c.getOrCreateProgram("clippingMask");for(const g of t){const v=c._tileClippingMaskIDs[g.key]=--o;m.draw(c,h.TRIANGLES,Fn.disabled,new hi({func:h.ALWAYS,mask:0},v,255,h.KEEP,h.KEEP,h.REPLACE),Ri.disabled,mi.disabled,LI(g.projMatrix),"$clipping",c.tileExtentBuffer,c.quadTriangleIndexBuffer,c.tileExtentSegments)}}pointCoordinate(t){const o=this.painter.transform;if(t.x<0||t.x>o.width||t.y<0||t.y>o.height)return null;const c=[t.x,t.y,1,1];Yi.transformMat4(c,c,o.pixelMatrixInverse),Yi.scale(c,c,1/c[3]),c[0]/=o.worldSize,c[1]/=o.worldSize;const u=o._camera.position,h=Xi(1,o.center.lat),m=[u[0],u[1],u[2]/h,0],g=De.subtract([],c.slice(0,3),m);De.normalize(g,g);const v=this.raycast(m,g,this._exaggeration);return v!==null&&v?(De.scaleAndAdd(m,m,g,v),m[3]=m[2],m[2]*=h,m):null}drawDepth(){const t=this.painter,o=t.context,c=this.proxySourceCache,u=Math.ceil(t.width),h=Math.ceil(t.height);if(!this._depthFBO||this._depthFBO.width===u&&this._depthFBO.height===h||(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),!this._depthFBO){const m=o.gl,g=o.createFramebuffer(u,h,!0,"renderbuffer");o.activeTexture.set(m.TEXTURE0);const v=new xa(o,{width:u,height:h,data:null},m.RGBA);v.bind(m.NEAREST,m.CLAMP_TO_EDGE),g.colorAttachment.set(v.texture);const x=o.createRenderbuffer(o.gl.DEPTH_COMPONENT16,u,h);g.depthAttachment.set(x),this._depthFBO=g,this._depthTexture=v}o.bindFramebuffer.set(this._depthFBO.framebuffer),o.viewport.set([0,0,u,h]),function(m,g,v,x){if(m.transform.projection.name==="globe")return;const w=m.context,E=w.gl;w.clear({depth:1});const C=m.getOrCreateProgram("terrainDepth"),I=new Fn(E.LESS,Fn.ReadWrite,m.depthRangeFor3D);for(const D of x){const N=v.getTile(D),W=VU(D.projMatrix,0,[0,0,0]);g.setupElevationDraw(N,C),C.draw(m,E.TRIANGLES,I,hi.disabled,Ri.unblended,mi.backCCW,W,"terrain_depth",g.gridBuffer,g.gridIndexBuffer,g.gridNoSkirtSegments)}}(t,this,c,this.proxyCoords)}_setupProxiedCoordsForOrtho(t,o,c){if(t.getSource()instanceof td)return this._setupProxiedCoordsForImageSource(t,o,c);this._findCoveringTileCache[t.id]=this._findCoveringTileCache[t.id]||{};const u=this.proxiedCoords[t.id]=[],h=this.proxyCoords;for(let g=0;g<h.length;g++){const v=h[g],x=this._findTileCoveringTileID(v,t);if(x){const w=this._createProxiedId(v,x,c[v.key]&&c[v.key][t.id]);u.push(w),this.proxyToSource[v.key][t.id]=[w]}}let m=!1;for(let g=0;g<o.length;g++){const v=t.getTile(o[g]);if(!v||!v.hasData())continue;const x=this._findTileCoveringTileID(v.tileID,this.proxySourceCache);if(x&&x.tileID.canonical.z!==v.tileID.canonical.z){const w=this.proxyToSource[x.tileID.key][t.id],E=this._createProxiedId(x.tileID,v,c[x.tileID.key]&&c[x.tileID.key][t.id]);w?w.splice(w.length-1,0,E):this.proxyToSource[x.tileID.key][t.id]=[E],u.push(E),m=!0}}this._sourceTilesOverlap[t.id]=m}_setupProxiedCoordsForImageSource(t,o,c){if(!t.getSource().loaded())return;const u=this.proxiedCoords[t.id]=[],h=this.proxyCoords,m=t.getSource(),g=m.tileID;if(!g)return;const v=new G(g.x,g.y)._div(1<<g.z),x=m.coordinates.map(bi.fromLngLat).reduce((E,C)=>(E.min.x=Math.min(E.min.x,C.x-v.x),E.min.y=Math.min(E.min.y,C.y-v.y),E.max.x=Math.max(E.max.x,C.x-v.x),E.max.y=Math.max(E.max.y,C.y-v.y),E),{min:new G(Number.MAX_VALUE,Number.MAX_VALUE),max:new G(-Number.MAX_VALUE,-Number.MAX_VALUE)}),w=(E,C)=>{const I=E.wrap+E.canonical.x/(1<<E.canonical.z),D=E.canonical.y/(1<<E.canonical.z),N=mt/(1<<E.canonical.z),W=C.wrap+C.canonical.x/(1<<C.canonical.z),V=C.canonical.y/(1<<C.canonical.z);return I+N<W+x.min.x||I>W+x.max.x||D+N<V+x.min.y||D>V+x.max.y};for(let E=0;E<h.length;E++){const C=h[E];for(let I=0;I<o.length;I++){const D=t.getTile(o[I]);if(!D||!D.hasData()||w(C,D.tileID))continue;const N=this._createProxiedId(C,D,c[C.key]&&c[C.key][t.id]),W=this.proxyToSource[C.key][t.id];W?W.push(N):this.proxyToSource[C.key][t.id]=[N],u.push(N)}}}_createProxiedId(t,o,c){let u=this.orthoMatrix;if(c){const h=c.find(m=>m.key===o.tileID.key);if(h)return h}if(o.tileID.key!==t.key){const h=t.canonical.z-o.tileID.canonical.z;let m,g,v;u=at.create();const x=o.tileID.wrap-t.wrap<<t.overscaledZ;h>0?(m=mt>>h,g=m*((o.tileID.canonical.x<<h)-t.canonical.x+x),v=m*((o.tileID.canonical.y<<h)-t.canonical.y)):(m=mt<<-h,g=mt*(o.tileID.canonical.x-(t.canonical.x+x<<-h)),v=mt*(o.tileID.canonical.y-(t.canonical.y<<-h))),at.ortho(u,0,m,0,m,0,1),at.translate(u,u,[g,v,0])}return new qU(o.tileID,t.key,u)}_findTileCoveringTileID(t,o){let c=o.getTile(t);if(c&&c.hasData())return c;const u=this._findCoveringTileCache[o.id],h=u[t.key];if(c=h?o.getTileByID(h):null,c&&c.hasData()||h===null)return c;let m=c?c.tileID:t,g=m.overscaledZ;const v=o.getSource().minzoom,x=[];if(!h){const E=o.getSource().maxzoom;if(t.canonical.z>=E){const C=t.canonical.z-E;o.getSource().reparseOverscaled?(g=Math.max(t.canonical.z+2,o.transform.tileZoom),m=new ki(g,t.wrap,E,t.canonical.x>>C,t.canonical.y>>C)):C!==0&&(g=E,m=new ki(g,t.wrap,E,t.canonical.x>>C,t.canonical.y>>C))}m.key!==t.key&&(x.push(m.key),c=o.getTile(m))}const w=E=>{x.forEach(C=>{u[C]=E}),x.length=0};for(g-=1;g>=v&&(!c||!c.hasData());g--){c&&w(c.tileID.key);const E=m.calculateScaledKey(g);if(c=o.getTileByID(E),c&&c.hasData())break;const C=u[E];if(C===null)break;C===void 0?x.push(E):c=o.getTileByID(C)}return w(c?c.tileID.key:null),c&&c.hasData()?c:null}findDEMTileFor(t){return this.enabled?this._findTileCoveringTileID(t,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(t,o){let c=this._tilesDirty[t];c||(c=this._tilesDirty[t]={}),c[o.key]=!0}}function uae(r,t,o){const c=function(g,v,x){const w=De.dot(v,g),E=De.dot(x,[.2126,.7152,.0722]),C=(D,N,W)=>(1-W)*D+W*N,I=C(1-.3*Math.min(E,1),1,Math.min(w+1,1));return C(.92,1,Math.asin(re(v[2],-1,1))/Math.PI+.5)*I}(r,[0,0,1],t),u=[0,0,0];De.scale(u,o.slice(0,3),c);const h=[0,0,0];De.scale(h,t.slice(0,3),r[2]);const m=[0,0,0];return De.add(m,u,h),Ht(m)}const dae=["fill","fillOutline","fillPattern","line","linePattern","background","backgroundPattern","hillshade","raster"],hae=["stars","fillExtrusion","fillExtrusionGroundEffect","model","symbolSDF","symbolIcon","symbolTextAndIcon"];class XU{static cacheKey(t,o,c,u){let h=`${o}${u?u.cacheKey:""}`;for(const m of c)t.usedDefines.includes(m)&&(h+=`/${m}`);return h}constructor(t,o,c,u,h,m){const g=t.gl;this.program=g.createProgram(),this.configuration=u,this.name=o,this.fixedDefines=[...m];const v=function(V){const q=[];for(let Z=0;Z<V.length;Z++){if(V[Z]===null)continue;const K=V[Z].split(" ");q.push(K.pop())}return q}(c.staticAttributes),x=u?u.getBinderAttributes():[],w=v.concat(x);let E=u?u.defines():[];E=E.concat(m.map(V=>`#define ${V}`));const C=`#version 300 es
`;let I=C+E.concat(FU,FU,NU,OU.fragmentSource).join(`
`);for(const V of c.fragmentIncludes)I+=`
${H2[V]}`;I+=`
${c.fragmentSource}`;let D=C+E.concat(`
#ifdef GL_ES
precision highp float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`,NU,OU.vertexSource).join(`
`);for(const V of c.vertexIncludes)D+=`
${H2[V]}`;D+=`
${c.vertexSource}`;const N=g.createShader(g.FRAGMENT_SHADER);if(g.isContextLost())return void(this.failedToCreate=!0);g.shaderSource(N,I),g.compileShader(N),g.attachShader(this.program,N);const W=g.createShader(g.VERTEX_SHADER);if(g.isContextLost())this.failedToCreate=!0;else{g.shaderSource(W,D),g.compileShader(W),g.attachShader(this.program,W),this.attributes={},this.numAttributes=w.length;for(let V=0;V<this.numAttributes;V++)if(w[V]){const q=w[V].startsWith("a_")?w[V]:`a_${w[V]}`;g.bindAttribLocation(this.program,V,q),this.attributes[q]=V}g.linkProgram(this.program),g.deleteShader(W),g.deleteShader(N),this.fixedUniforms=h(t),this.binderUniforms=u?u.getUniforms(t):[],m.includes("TERRAIN")&&(this.terrainUniforms=(V=>({u_dem:new di(V),u_dem_prev:new di(V),u_dem_unpack:new cl(V),u_dem_tl:new gi(V),u_dem_scale:new Jt(V),u_dem_tl_prev:new gi(V),u_dem_scale_prev:new Jt(V),u_dem_size:new Jt(V),u_dem_lerp:new Jt(V),u_exaggeration:new Jt(V),u_depth:new di(V),u_depth_size_inv:new gi(V),u_meter_to_dem:new Jt(V),u_label_plane_matrix_inv:new qn(V)}))(t)),m.includes("GLOBE")&&(this.globeUniforms=(V=>({u_tile_tl_up:new Kn(V),u_tile_tr_up:new Kn(V),u_tile_br_up:new Kn(V),u_tile_bl_up:new Kn(V),u_tile_up_scale:new Jt(V)}))(t)),m.includes("FOG")&&(this.fogUniforms=(V=>({u_fog_matrix:new qn(V),u_fog_range:new gi(V),u_fog_color:new cl(V),u_fog_horizon_blend:new Jt(V),u_fog_vertical_limit:new gi(V),u_fog_temporal_offset:new Jt(V),u_frustum_tl:new Kn(V),u_frustum_tr:new Kn(V),u_frustum_br:new Kn(V),u_frustum_bl:new Kn(V),u_globe_pos:new Kn(V),u_globe_radius:new Jt(V),u_globe_transition:new Jt(V),u_is_globe:new di(V),u_viewport:new gi(V)}))(t)),m.includes("RENDER_CUTOFF")&&(this.cutoffUniforms=(V=>({u_cutoff_params:new cl(V)}))(t)),m.includes("LIGHTING_3D_MODE")&&(this.lightsUniforms=(V=>({u_lighting_ambient_color:new Kn(V),u_lighting_directional_dir:new Kn(V),u_lighting_directional_color:new Kn(V),u_ground_radiance:new Kn(V)}))(t)),m.includes("RENDER_SHADOWS")&&(this.shadowUniforms=(V=>({u_light_matrix_0:new qn(V),u_light_matrix_1:new qn(V),u_fade_range:new gi(V),u_shadow_normal_offset:new Kn(V),u_shadow_intensity:new Jt(V),u_shadow_texel_size:new Jt(V),u_shadow_map_resolution:new Jt(V),u_shadow_direction:new Kn(V),u_shadow_bias:new Kn(V),u_shadowmap_0:new di(V),u_shadowmap_1:new di(V)}))(t))}}setTerrainUniformValues(t,o){if(!this.terrainUniforms)return;const c=this.terrainUniforms;if(!this.failedToCreate){t.program.set(this.program);for(const u in o)c[u]&&c[u].set(this.program,u,o[u])}}setGlobeUniformValues(t,o){if(!this.globeUniforms)return;const c=this.globeUniforms;if(!this.failedToCreate){t.program.set(this.program);for(const u in o)c[u]&&c[u].set(this.program,u,o[u])}}setFogUniformValues(t,o){if(!this.fogUniforms)return;const c=this.fogUniforms;if(!this.failedToCreate){t.program.set(this.program);for(const u in o)c[u].set(this.program,u,o[u])}}setCutoffUniformValues(t,o){if(!this.cutoffUniforms)return;const c=this.cutoffUniforms;if(!this.failedToCreate){t.program.set(this.program);for(const u in o)c[u].set(this.program,u,o[u])}}setLightsUniformValues(t,o){if(!this.lightsUniforms)return;const c=this.lightsUniforms;if(!this.failedToCreate){t.program.set(this.program);for(const u in o)c[u].set(this.program,u,o[u])}}setShadowUniformValues(t,o){if(this.failedToCreate||!this.shadowUniforms)return;const c=this.shadowUniforms;t.program.set(this.program);for(const u in o)c[u].set(this.program,u,o[u])}_drawDebugWireframe(t,o,c,u,h,m,g,v,x,w){const E=t.options.wireframe;if(E.terrain===!1&&E.layers2D===!1&&E.layers3D===!1)return;const C=t.context;if(!(()=>!(!E.terrain||this.name!=="terrainRaster"&&this.name!=="globeRaster")||!(!E.layers2D||t._terrain&&t._terrain.renderingToTexture||!dae.includes(this.name))||!(!E.layers3D||!hae.includes(this.name)))())return;const I=C.gl,D=t.wireframeDebugCache.getLinesFromTrianglesBuffer(t.frameCounter,h,C);if(!D)return;const N=[...this.fixedDefines];N.push("DEBUG_WIREFRAME");const W=t.getOrCreateProgram(this.name,{config:this.configuration,defines:N});C.program.set(W.program);const V=(K,X,J)=>{if(X[K]&&J[K])for(const ae in X[K])J[K][ae]&&J[K][ae].set(J.program,ae,X[K][ae].current)};x&&x.setUniforms(W.program,C,W.binderUniforms,g,{zoom:v}),V("fixedUniforms",this,W),V("terrainUniforms",this,W),V("globeUniforms",this,W),V("fogUniforms",this,W),V("lightsUniforms",this,W),V("shadowUniforms",this,W),D.bind(),C.setColorMode(new Ri([I.ONE,I.ONE_MINUS_SRC_ALPHA,I.ZERO,I.ONE],En.transparent,[!0,!0,!0,!1])),C.setDepthMode(new Fn(o.func===I.LESS?I.LEQUAL:o.func,Fn.ReadOnly,o.range)),C.setStencilMode(hi.disabled);const q=3*m.primitiveLength*2,Z=3*m.primitiveOffset*2*2;w&&w>1?I.drawElementsInstanced(I.LINES,q,I.UNSIGNED_SHORT,Z,w):I.drawElements(I.LINES,q,I.UNSIGNED_SHORT,Z),h.bind(),C.program.set(this.program),C.setDepthMode(o),C.setStencilMode(c),C.setColorMode(u)}draw(t,o,c,u,h,m,g,v,x,w,E,C,I,D,N,W){const V=t.context,q=V.gl;if(this.failedToCreate)return;V.program.set(this.program),V.setDepthMode(c),V.setStencilMode(u),V.setColorMode(h),V.setCullFace(m);for(const X of Object.keys(this.fixedUniforms))this.fixedUniforms[X].set(this.program,X,g[X]);D&&D.setUniforms(this.program,V,this.binderUniforms,C,{zoom:I});const Z={[q.LINES]:2,[q.TRIANGLES]:3,[q.LINE_STRIP]:1}[o],K=W&&W>0?1:void 0;for(const X of E.get()){const J=X.vaos||(X.vaos={});(J[v]||(J[v]=new nae)).bind(V,this,x,D?D.getPaintVertexBuffers():[],w,X.vertexOffset,N||[],K),W&&W>1?q.drawElementsInstanced(o,X.primitiveLength*Z,q.UNSIGNED_SHORT,X.primitiveOffset*Z*2,W):q.drawElements(o,X.primitiveLength*Z,q.UNSIGNED_SHORT,X.primitiveOffset*Z*2),o===q.TRIANGLES&&this._drawDebugWireframe(t,c,u,h,w,X,C,I,D,W)}}}function ZU(r,t){const o=Math.pow(2,t.tileID.overscaledZ),c=t.tileSize*Math.pow(2,r.transform.tileZoom)/o,u=c*(t.tileID.canonical.x+t.tileID.wrap*o),h=c*t.tileID.canonical.y;return{u_image:0,u_texsize:t.imageAtlasTexture.size,u_tile_units_to_pixels:1/km(t,1,r.transform.tileZoom),u_pixel_coord_upper:[u>>16,h>>16],u_pixel_coord_lower:[65535&u,65535&h]}}const fae=at.create(),KU=(r,t,o,c,u,h,m,g,v,x,w,E,C,I,D)=>{const N=t.style.light,W=N.properties.get("position"),V=[W.x,W.y,W.z],q=Bs.create();N.properties.get("anchor")==="viewport"&&(Bs.fromRotation(q,-t.transform.angle),De.transformMat3(V,V,q));const Z=N.properties.get("color"),K=t.transform,X={u_matrix:r,u_lightpos:V,u_lightintensity:N.properties.get("intensity"),u_lightcolor:[Z.r,Z.g,Z.b],u_vertical_gradient:+o,u_opacity:c,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:fae,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_ao:u,u_edge_radius:h,u_flood_light_color:E,u_vertical_scale:C,u_flood_light_intensity:I,u_ground_shadow_factor:D};return K.projection.name==="globe"&&(X.u_tile_id=[m.canonical.x,m.canonical.y,1<<m.canonical.z],X.u_zoom_transition=v,X.u_inv_rot_matrix=w,X.u_merc_center=x,X.u_up_dir=K.projection.upVector(new Xu(0,0,0),x[0]*mt,x[1]*mt),X.u_height_lift=g),X},pae=(r,t,o)=>({u_matrix:r,u_edge_radius:t,u_vertical_scale:o}),mae=(r,t,o,c,u,h,m,g,v,x,w,E,C,I)=>{const D=KU(r,t,o,c,u,h,m,v,x,w,E,C,I,1,[0,0,0]),N={u_height_factor:-Math.pow(2,m.overscaledZ)/g.tileSize/8};return Fe(D,ZU(t,g),N)},JU=(r,t)=>({u_matrix:r,u_emissive_strength:t}),QU=(r,t,o,c)=>Fe(JU(r,t),ZU(o,c)),gae=(r,t,o)=>({u_matrix:r,u_world:o,u_emissive_strength:t}),yae=(r,t,o,c,u)=>Fe(QU(r,t,o,c),{u_world:u}),vae=(r,t,o,c)=>{const u=mt/o.tileSize;return{u_matrix:r,u_camera_to_center_distance:t.getCameraToCenterDistance(c),u_extrude_scale:[t.pixelsToGLUnits[0]/u,t.pixelsToGLUnits[1]/u]}},e8=(r,t,o=1)=>({u_matrix:r,u_color:t,u_overlay:0,u_overlay_scale:o}),_ae=at.create(),xae=(r,t,o,c,u,h,m)=>{const g=r.transform,v=g.projection.name==="globe",x=v?pF(g.zoom,t.canonical)*g._pixelsPerMercatorPixel:km(o,1,h),w={u_matrix:t.projMatrix,u_extrude_scale:x,u_intensity:m,u_inv_rot_matrix:_ae,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(v){w.u_inv_rot_matrix=c,w.u_merc_center=u,w.u_tile_id=[t.canonical.x,t.canonical.y,1<<t.canonical.z],w.u_zoom_transition=_o(g.zoom);const E=u[0]*mt,C=u[1]*mt;w.u_up_dir=g.projection.upVector(new Xu(0,0,0),E,C)}return w},t8=(r,t,o,c,u,h,m,g,v,x,w)=>{return{u_matrix:r,u_normalize_matrix:t,u_globe_matrix:o,u_tl_parent:c,u_scale_parent:u,u_fade_t:h.mix,u_opacity:h.opacity*m.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:m.paint.get("raster-brightness-min"),u_brightness_high:m.paint.get("raster-brightness-max"),u_saturation_factor:(C=m.paint.get("raster-saturation"),C>0?1-1/(1.001-C):-C),u_contrast_factor:(E=m.paint.get("raster-contrast"),E>0?1/(1-E):1+E),u_spin_weights:bae(m.paint.get("raster-hue-rotate")),u_perspective_transform:g,u_colorization_mix:x,u_colorization_scale:wae(w),u_color_ramp:v};var E,C};function bae(r){r*=Math.PI/180;const t=Math.sin(r),o=Math.cos(r);return[(2*o+1)/3,(-Math.sqrt(3)*t-o+1)/3,(Math.sqrt(3)*t-o+1)/3]}function wae([r,t]){if(r===t)return[r,t];const o=(t+r)/2,c=(t-r)/2*256/255;return[-(r=o-c)/((t=o+c)-r),1/(t-r)]}const n8=at.create(),i8=(r,t,o,c,u,h,m,g,v,x,w,E,C,I,D,N,W)=>{const V=u.transform,q={u_is_size_zoom_constant:+(r==="constant"||r==="source"),u_is_size_feature_constant:+(r==="constant"||r==="camera"),u_size_t:t?t.uSizeT:0,u_size:t?t.uSize:0,u_camera_to_center_distance:V.getCameraToCenterDistance(N),u_rotate_symbol:+o,u_aspect_ratio:V.width/V.height,u_fade_change:u.options.fadeDuration?u.symbolFadeChange:1,u_matrix:h,u_label_plane_matrix:m,u_coord_matrix:g,u_is_text:+v,u_pitch_with_map:+c,u_texsize:x,u_texture:0,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:n8,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:n8,u_up_vector:[0,-1,0],u_icon_transition:W||0};return N.name==="globe"&&(q.u_tile_id=[w.canonical.x,w.canonical.y,1<<w.canonical.z],q.u_zoom_transition=E,q.u_inv_rot_matrix=I,q.u_merc_center=C,q.u_camera_forward=V._camera.forward(),q.u_ecef_origin=function(Z,K){const X=[0,0,0],J=Pm(bc(K.canonical));return De.transformMat4(X,X,J),De.transformMat4(X,X,Z),X}(V.globeMatrix,w.toUnwrapped()),q.u_tile_matrix=Float32Array.from(V.globeMatrix),q.u_up_vector=D),q},r8=(r,t,o,c,u,h,m,g,v,x,w,E,C,I,D,N,W)=>Fe(i8(r,t,o,c,u,h,m,g,v,x,E,C,I,D,N,W),{u_gamma_scale:c?u.transform.getCameraToCenterDistance(W)*Math.cos(u.terrain?0:u.transform._pitch):1,u_device_pixel_ratio:Pn.devicePixelRatio,u_is_halo:+w,undefined:void 0}),Sae=(r,t,o,c,u,h,m,g,v,x,w,E,C,I,D,N)=>Fe(r8(r,t,o,c,u,h,m,g,!0,v,!0,w,E,C,I,D,N),{u_texsize_icon:x,u_texture_icon:1}),Eae=(r,t,o,c)=>({u_matrix:r,u_emissive_strength:t,u_opacity:o,u_color:c}),Mae=(r,t,o,c,u,h,m)=>Fe(function(g,v,x,w){const E=x.imageManager.getPattern(g.toString(),v),{width:C,height:I}=x.imageManager.getPixelSize(v),D=Math.pow(2,w.tileID.overscaledZ),N=w.tileSize*Math.pow(2,x.transform.tileZoom)/D,W=N*(w.tileID.canonical.x+w.tileID.wrap*D),V=N*w.tileID.canonical.y;return{u_image:0,u_pattern_tl:E.tl,u_pattern_br:E.br,u_texsize:[C,I],u_pattern_size:E.displaySize,u_tile_units_to_pixels:1/km(w,1,x.transform.tileZoom),u_pixel_coord_upper:[W>>16,V>>16],u_pixel_coord_lower:[65535&W,65535&V]}}(u,h,c,m),{u_matrix:r,u_emissive_strength:t,u_opacity:o}),dl={BaseColor:5,MetallicRoughness:6,Normal:7,Occlusion:8,Emission:9,ShadowMap0:10},kI=(r,t,o,c,u,h,m,g,v,x,w,E=[0,0,0])=>{const C=c.style.light,I=C.properties.get("position"),D=[-I.x,-I.y,I.z],N=Bs.create();C.properties.get("anchor")==="viewport"&&(Bs.fromRotation(N,-c.transform.angle),De.transformMat3(D,D,N));const W=x.alphaMode==="MASK",V=C.properties.get("color"),q=w.paint.get("model-ambient-occlusion-intensity"),Z=w.paint.get("model-color").constantOr(En.white),K=w.paint.get("model-color-mix-intensity").constantOr(0);return{u_matrix:r,u_lighting_matrix:t,u_normal_matrix:o,u_lightpos:D,u_lightintensity:C.properties.get("intensity"),u_lightcolor:[V.r,V.g,V.b],u_camera_pos:E,u_opacity:u,u_baseTextureIsAlpha:0,u_alphaMask:+W,u_alphaCutoff:x.alphaCutoff,u_baseColorFactor:[h.r,h.g,h.b,h.a],u_emissiveFactor:[m[0],m[1],m[2],1],u_metallicFactor:g,u_roughnessFactor:v,u_baseColorTexture:dl.BaseColor,u_metallicRoughnessTexture:dl.MetallicRoughness,u_normalTexture:dl.Normal,u_occlusionTexture:dl.Occlusion,u_emissionTexture:dl.Emission,u_color_mix:[Z.r,Z.g,Z.b,K],u_aoIntensity:q}},a8=new Float32Array(16),o8=(r,t=a8,o=a8)=>({u_matrix:r,u_instance:t,u_node_matrix:o}),Tae={fillExtrusion:r=>({u_matrix:new qn(r),u_lightpos:new Kn(r),u_lightintensity:new Jt(r),u_lightcolor:new Kn(r),u_vertical_gradient:new Jt(r),u_opacity:new Jt(r),u_edge_radius:new Jt(r),u_ao:new gi(r),u_tile_id:new Kn(r),u_zoom_transition:new Jt(r),u_inv_rot_matrix:new qn(r),u_merc_center:new gi(r),u_up_dir:new Kn(r),u_height_lift:new Jt(r),u_flood_light_color:new Kn(r),u_vertical_scale:new Jt(r),u_flood_light_intensity:new Jt(r),u_ground_shadow_factor:new Kn(r)}),fillExtrusionDepth:r=>({u_matrix:new qn(r),u_edge_radius:new Jt(r),u_vertical_scale:new Jt(r)}),fillExtrusionPattern:r=>({u_matrix:new qn(r),u_lightpos:new Kn(r),u_lightintensity:new Jt(r),u_lightcolor:new Kn(r),u_vertical_gradient:new Jt(r),u_height_factor:new Jt(r),u_edge_radius:new Jt(r),u_ao:new gi(r),u_tile_id:new Kn(r),u_zoom_transition:new Jt(r),u_inv_rot_matrix:new qn(r),u_merc_center:new gi(r),u_up_dir:new Kn(r),u_height_lift:new Jt(r),u_image:new di(r),u_texsize:new gi(r),u_pixel_coord_upper:new gi(r),u_pixel_coord_lower:new gi(r),u_tile_units_to_pixels:new Jt(r),u_opacity:new Jt(r)}),fillExtrusionGroundEffect:r=>({u_matrix:new qn(r),u_opacity:new Jt(r),u_ao_pass:new Jt(r),u_meter_to_tile:new Jt(r),u_ao:new gi(r),u_flood_light_intensity:new Jt(r),u_flood_light_color:new Kn(r),u_attenuation:new Jt(r),u_edge_radius:new Jt(r),u_fb:new di(r),u_fb_size:new Jt(r)}),fill:r=>({u_matrix:new qn(r),u_emissive_strength:new Jt(r)}),fillPattern:r=>({u_matrix:new qn(r),u_emissive_strength:new Jt(r),u_image:new di(r),u_texsize:new gi(r),u_pixel_coord_upper:new gi(r),u_pixel_coord_lower:new gi(r),u_tile_units_to_pixels:new Jt(r)}),fillOutline:r=>({u_matrix:new qn(r),u_emissive_strength:new Jt(r),u_world:new gi(r)}),fillOutlinePattern:r=>({u_matrix:new qn(r),u_emissive_strength:new Jt(r),u_world:new gi(r),u_image:new di(r),u_texsize:new gi(r),u_pixel_coord_upper:new gi(r),u_pixel_coord_lower:new gi(r),u_tile_units_to_pixels:new Jt(r)}),circle:r=>({u_camera_to_center_distance:new Jt(r),u_extrude_scale:new jC(r),u_device_pixel_ratio:new Jt(r),u_matrix:new qn(r),u_inv_rot_matrix:new qn(r),u_merc_center:new gi(r),u_tile_id:new Kn(r),u_zoom_transition:new Jt(r),u_up_dir:new Kn(r),u_emissive_strength:new Jt(r)}),collisionBox:r=>({u_matrix:new qn(r),u_camera_to_center_distance:new Jt(r),u_extrude_scale:new gi(r)}),collisionCircle:r=>({u_matrix:new qn(r),u_inv_matrix:new qn(r),u_camera_to_center_distance:new Jt(r),u_viewport_size:new gi(r)}),debug:r=>({u_color:new lv(r),u_matrix:new qn(r),u_overlay:new di(r),u_overlay_scale:new Jt(r)}),clippingMask:r=>({u_matrix:new qn(r)}),heatmap:r=>({u_extrude_scale:new Jt(r),u_intensity:new Jt(r),u_matrix:new qn(r),u_inv_rot_matrix:new qn(r),u_merc_center:new gi(r),u_tile_id:new Kn(r),u_zoom_transition:new Jt(r),u_up_dir:new Kn(r)}),heatmapTexture:r=>({u_image:new di(r),u_color_ramp:new di(r),u_opacity:new Jt(r)}),hillshade:r=>({u_matrix:new qn(r),u_image:new di(r),u_latrange:new gi(r),u_light:new gi(r),u_shadow:new lv(r),u_highlight:new lv(r),u_emissive_strength:new Jt(r),u_accent:new lv(r)}),hillshadePrepare:r=>({u_matrix:new qn(r),u_image:new di(r),u_dimension:new gi(r),u_zoom:new Jt(r),u_unpack:new cl(r)}),line:r=>({u_matrix:new qn(r),u_pixels_to_tile_units:new jC(r),u_device_pixel_ratio:new Jt(r),u_units_to_pixels:new gi(r),u_dash_image:new di(r),u_gradient_image:new di(r),u_image_height:new Jt(r),u_texsize:new gi(r),u_tile_units_to_pixels:new Jt(r),u_alpha_discard_threshold:new Jt(r),u_trim_offset:new gi(r),u_emissive_strength:new Jt(r)}),linePattern:r=>({u_matrix:new qn(r),u_texsize:new gi(r),u_pixels_to_tile_units:new jC(r),u_device_pixel_ratio:new Jt(r),u_image:new di(r),u_units_to_pixels:new gi(r),u_tile_units_to_pixels:new Jt(r),u_alpha_discard_threshold:new Jt(r)}),raster:r=>({u_matrix:new qn(r),u_normalize_matrix:new qn(r),u_globe_matrix:new qn(r),u_tl_parent:new gi(r),u_scale_parent:new Jt(r),u_fade_t:new Jt(r),u_opacity:new Jt(r),u_image0:new di(r),u_image1:new di(r),u_brightness_low:new Jt(r),u_brightness_high:new Jt(r),u_saturation_factor:new Jt(r),u_contrast_factor:new Jt(r),u_spin_weights:new Kn(r),u_perspective_transform:new gi(r),u_colorization_mix:new cl(r),u_colorization_scale:new gi(r),u_color_ramp:new di(r)}),symbolIcon:r=>({u_is_size_zoom_constant:new di(r),u_is_size_feature_constant:new di(r),u_size_t:new Jt(r),u_size:new Jt(r),u_camera_to_center_distance:new Jt(r),u_rotate_symbol:new di(r),u_aspect_ratio:new Jt(r),u_fade_change:new Jt(r),u_matrix:new qn(r),u_label_plane_matrix:new qn(r),u_coord_matrix:new qn(r),u_is_text:new di(r),u_pitch_with_map:new di(r),u_texsize:new gi(r),u_tile_id:new Kn(r),u_zoom_transition:new Jt(r),u_inv_rot_matrix:new qn(r),u_merc_center:new gi(r),u_camera_forward:new Kn(r),u_tile_matrix:new qn(r),u_up_vector:new Kn(r),u_ecef_origin:new Kn(r),u_texture:new di(r),u_icon_transition:new Jt(r)}),symbolSDF:r=>({u_is_size_zoom_constant:new di(r),u_is_size_feature_constant:new di(r),u_size_t:new Jt(r),u_size:new Jt(r),u_camera_to_center_distance:new Jt(r),u_rotate_symbol:new di(r),u_aspect_ratio:new Jt(r),u_fade_change:new Jt(r),u_matrix:new qn(r),u_label_plane_matrix:new qn(r),u_coord_matrix:new qn(r),u_is_text:new di(r),u_pitch_with_map:new di(r),u_texsize:new gi(r),u_texture:new di(r),u_gamma_scale:new Jt(r),u_device_pixel_ratio:new Jt(r),u_tile_id:new Kn(r),u_zoom_transition:new Jt(r),u_inv_rot_matrix:new qn(r),u_merc_center:new gi(r),u_camera_forward:new Kn(r),u_tile_matrix:new qn(r),u_up_vector:new Kn(r),u_ecef_origin:new Kn(r),u_is_halo:new di(r)}),symbolTextAndIcon:r=>({u_is_size_zoom_constant:new di(r),u_is_size_feature_constant:new di(r),u_size_t:new Jt(r),u_size:new Jt(r),u_camera_to_center_distance:new Jt(r),u_rotate_symbol:new di(r),u_aspect_ratio:new Jt(r),u_fade_change:new Jt(r),u_matrix:new qn(r),u_label_plane_matrix:new qn(r),u_coord_matrix:new qn(r),u_is_text:new di(r),u_pitch_with_map:new di(r),u_texsize:new gi(r),u_texsize_icon:new gi(r),u_texture:new di(r),u_texture_icon:new di(r),u_gamma_scale:new Jt(r),u_device_pixel_ratio:new Jt(r),u_is_halo:new di(r)}),background:r=>({u_matrix:new qn(r),u_emissive_strength:new Jt(r),u_opacity:new Jt(r),u_color:new lv(r)}),backgroundPattern:r=>({u_matrix:new qn(r),u_emissive_strength:new Jt(r),u_opacity:new Jt(r),u_image:new di(r),u_pattern_tl:new gi(r),u_pattern_br:new gi(r),u_texsize:new gi(r),u_pattern_size:new gi(r),u_pixel_coord_upper:new gi(r),u_pixel_coord_lower:new gi(r),u_tile_units_to_pixels:new Jt(r)}),terrainRaster:WU,terrainDepth:WU,skybox:r=>({u_matrix:new qn(r),u_sun_direction:new Kn(r),u_cubemap:new di(r),u_opacity:new Jt(r),u_temporal_offset:new Jt(r)}),skyboxGradient:r=>({u_matrix:new qn(r),u_color_ramp:new di(r),u_center_direction:new Kn(r),u_radius:new Jt(r),u_opacity:new Jt(r),u_temporal_offset:new Jt(r)}),skyboxCapture:r=>({u_matrix_3f:new GO(r),u_sun_direction:new Kn(r),u_sun_intensity:new Jt(r),u_color_tint_r:new cl(r),u_color_tint_m:new cl(r),u_luminance:new Jt(r)}),globeRaster:r=>({u_proj_matrix:new qn(r),u_globe_matrix:new qn(r),u_normalize_matrix:new qn(r),u_merc_matrix:new qn(r),u_zoom_transition:new Jt(r),u_merc_center:new gi(r),u_image0:new di(r),u_grid_matrix:new GO(r),u_skirt_height:new Jt(r),u_frustum_tl:new Kn(r),u_frustum_tr:new Kn(r),u_frustum_br:new Kn(r),u_frustum_bl:new Kn(r),u_globe_pos:new Kn(r),u_globe_radius:new Jt(r),u_viewport:new gi(r)}),globeAtmosphere:r=>({u_frustum_tl:new Kn(r),u_frustum_tr:new Kn(r),u_frustum_br:new Kn(r),u_frustum_bl:new Kn(r),u_horizon:new Jt(r),u_transition:new Jt(r),u_fadeout_range:new Jt(r),u_color:new cl(r),u_high_color:new cl(r),u_space_color:new cl(r),u_temporal_offset:new Jt(r),u_horizon_angle:new Jt(r)}),model:r=>({u_matrix:new qn(r),u_lighting_matrix:new qn(r),u_normal_matrix:new qn(r),u_lightpos:new Kn(r),u_lightintensity:new Jt(r),u_lightcolor:new Kn(r),u_camera_pos:new Kn(r),u_opacity:new Jt(r),u_baseColorFactor:new cl(r),u_emissiveFactor:new cl(r),u_metallicFactor:new Jt(r),u_roughnessFactor:new Jt(r),u_baseTextureIsAlpha:new di(r),u_alphaMask:new di(r),u_alphaCutoff:new Jt(r),u_baseColorTexture:new di(r),u_metallicRoughnessTexture:new di(r),u_normalTexture:new di(r),u_occlusionTexture:new di(r),u_emissionTexture:new di(r),u_color_mix:new cl(r),u_aoIntensity:new Jt(r)}),modelDepth:r=>({u_matrix:new qn(r),u_instance:new qn(r),u_node_matrix:new qn(r)}),groundShadow:r=>({u_matrix:new qn(r),u_ground_shadow_factor:new Kn(r)}),stars:r=>({u_matrix:new qn(r),u_up:new Kn(r),u_right:new Kn(r),u_intensity_multiplier:new Jt(r)})};let Y2;function s8(r,t,o,c,u,h,m){const g=r.context,v=g.gl,x=r.transform,w=r.getOrCreateProgram("collisionBox"),E=[];let C=0,I=0;for(let K=0;K<c.length;K++){const X=c[K],J=t.getTile(X),ae=J.getBucket(o);if(!ae)continue;const ce=Fre(X,ae,x);let ge=ce;u[0]===0&&u[1]===0||(ge=r.translatePosMatrix(ce,J,u,h));const ve=m?ae.textCollisionBox:ae.iconCollisionBox,Pe=ae.collisionCircleArray;if(Pe.length>0){const Me=at.create(),Le=ge;at.mul(Me,ae.placementInvProjMatrix,x.glCoordMatrix),at.mul(Me,Me,ae.placementViewportMatrix),E.push({circleArray:Pe,circleOffset:I,transform:Le,invTransform:Me,projection:ae.getProjection()}),C+=Pe.length/4,I=C}ve&&(r.terrain&&r.terrain.setupElevationDraw(J,w),w.draw(r,v.LINES,Fn.disabled,hi.disabled,r.colorModeForRenderPass(),mi.disabled,vae(ge,x,J,ae.getProjection()),o.id,ve.layoutVertexBuffer,ve.indexBuffer,ve.segments,null,x.zoom,null,[ve.collisionVertexBuffer,ve.collisionVertexBufferExt]))}if(!m||!E.length)return;const D=r.getOrCreateProgram("collisionCircle"),N=new Gt;N.resize(4*C),N._trim();let W=0;for(const K of E)for(let X=0;X<K.circleArray.length/4;X++){const J=4*X,ae=K.circleArray[J+0],ce=K.circleArray[J+1],ge=K.circleArray[J+2],ve=K.circleArray[J+3];N.emplace(W++,ae,ce,ge,ve,0),N.emplace(W++,ae,ce,ge,ve,1),N.emplace(W++,ae,ce,ge,ve,2),N.emplace(W++,ae,ce,ge,ve,3)}(!Y2||Y2.length<2*C)&&(Y2=function(K){const X=2*K,J=new Un;J.resize(X),J._trim();for(let ae=0;ae<X;ae++){const ce=6*ae;J.uint16[ce+0]=4*ae+0,J.uint16[ce+1]=4*ae+1,J.uint16[ce+2]=4*ae+2,J.uint16[ce+3]=4*ae+2,J.uint16[ce+4]=4*ae+3,J.uint16[ce+5]=4*ae+0}return J}(C));const V=g.createIndexBuffer(Y2,!0),q=g.createVertexBuffer(N,Zte.members,!0);for(const K of E){const X={u_matrix:K.transform,u_inv_matrix:K.invTransform,u_camera_to_center_distance:(Z=x).getCameraToCenterDistance(K.projection),u_viewport_size:[Z.width,Z.height]};D.draw(r,v.TRIANGLES,Fn.disabled,hi.disabled,r.colorModeForRenderPass(),mi.disabled,X,o.id,q,V,qi.simpleSegment(0,2*K.circleOffset,K.circleArray.length,K.circleArray.length/2),null,x.zoom)}var Z;q.destroy(),V.destroy()}const l8=at.create();function Aae({width:r,height:t,anchor:o,textOffset:c,textScale:u},h){const{horizontalAlign:m,verticalAlign:g}=c2(o),v=-(m-.5)*r,x=-(g-.5)*t,w=HP(o,c);return new G((v/u+w[0])*h,(x/u+w[1])*h)}function Cae(r,t,o,c,u,h,m,g,v,x,w){const E=r.text.placedSymbolArray,C=r.text.dynamicLayoutVertexArray,I=r.icon.dynamicLayoutVertexArray,D={},N=r.getProjection(),W=TI(g,N,h),V=h.elevation,q=N.upVectorScale(g.canonical,h.center.lat,h.worldSize).metersToTile;C.clear();for(let Z=0;Z<E.length;Z++){const K=E.get(Z),{tileAnchorX:X,tileAnchorY:J,numGlyphs:ae}=K,ce=K.hidden||!K.crossTileID||r.allowVerticalPlacement&&!K.placedOrientation?null:c[K.crossTileID];if(ce){let ge=0,ve=0,Pe=0;if(V){const ot=V?V.getAtTileOffset(g,X,J):0,[yt,ft,Lt]=N.upVector(g.canonical,X,J);ge=ot*yt*q,ve=ot*ft*q,Pe=ot*Lt*q}let[Me,Le,Ee,He]=nu(K.projectedAnchorX+ge,K.projectedAnchorY+ve,K.projectedAnchorZ+Pe,o?W:m);const Ke=JB(h.getCameraToCenterDistance(N),He);let nt=u.evaluateSizeForFeature(r.textSizeData,x,K)*Ke/ao;o&&(nt*=r.tilePixelRatio/v);const Ve=Aae(ce,nt);o?({x:Me,y:Le,z:Ee}=N.projectTilePoint(X+Ve.x,J+Ve.y,g.canonical),[Me,Le,Ee]=nu(Me+ge,Le+ve,Ee+Pe,m)):(t&&Ve._rotate(-h.angle),Me+=Ve.x,Le+=Ve.y,Ee=0);const je=r.allowVerticalPlacement&&K.placedOrientation===Ar.vertical?Math.PI/2:0;for(let ot=0;ot<ae;ot++)Tv(C,Me,Le,Ee,je);w&&K.associatedIconIndex>=0&&(D[K.associatedIconIndex]={x:Me,y:Le,z:Ee,angle:je})}else Cv(ae,C)}if(w){I.clear();const Z=r.icon.placedSymbolArray;for(let K=0;K<Z.length;K++){const X=Z.get(K),{numGlyphs:J}=X,ae=D[K];if(X.hidden||!ae)Cv(J,I);else{const{x:ce,y:ge,z:ve,angle:Pe}=ae;for(let Me=0;Me<J;Me++)Tv(I,ce,ge,ve,Pe)}}r.icon.dynamicLayoutVertexBuffer.updateData(I)}r.text.dynamicLayoutVertexBuffer.updateData(C)}function Pae(r,t,o){return o.iconsInText&&t?"symbolTextAndIcon":r?"symbolSDF":"symbolIcon"}function c8(r,t,o,c,u,h,m,g,v,x,w,E){const C=r.context,I=C.gl,D=r.transform,N=g==="map",W=v==="map",V=N&&o.layout.get("symbol-placement")!=="point",q=N&&!W&&!V,Z=o.layout.get("symbol-sort-key").constantOr(1)!==void 0;let K=!1;const X=r.depthModeForSublayer(0,Fn.ReadOnly),J=[xo(D.center.lng),Io(D.center.lat)],ae=o.layout.get("text-variable-anchor"),ce=D.projection.name==="globe",ge=[],ve=[0,-1,0];let Pe=ve;!ce&&!D.mercatorFromTransition||N||(Pe=function(Me){const Le=Me._camera.getWorldToCamera(Me.worldSize,1),Ee=at.multiply([],Le,Me.globeMatrix);at.invert(Ee,Ee);const He=[0,0,0],Ke=[0,1,0,0];return Yi.transformMat4(Ke,Ke,Ee),He[0]=Ke[0],He[1]=Ke[1],He[2]=Ke[2],De.normalize(He,He),He}(D));for(const Me of c){const Le=t.getTile(Me),Ee=Le.getBucket(o);if(!Ee||Ee.projection.name==="mercator"&&ce)continue;const He=u?Ee.text:Ee.icon;if(!He||Ee.fullyClipped||!He.segments.get().length)continue;const Ke=He.programConfigurations.get(o.id),nt=u||Ee.sdfIcons,Ve=u?Ee.textSizeData:Ee.iconSizeData,je=W||D.pitch!==0,ot=Ku(Ve,D.zoom);let yt,ft,Lt,Ft,St=[0,0],Ct=null;if(u)ft=Le.glyphAtlasTexture,Lt=I.LINEAR,yt=Le.glyphAtlasTexture.size,Ee.iconsInText&&(St=Le.imageAtlasTexture.size,Ct=Le.imageAtlasTexture,Ft=je||r.options.rotating||r.options.zooming||Ve.kind==="composite"||Ve.kind==="camera"?I.LINEAR:I.NEAREST);else{const Pr=o.layout.get("icon-size").constantOr(0)!==1||Ee.iconsNeedLinear;ft=Le.imageAtlasTexture,Lt=nt||r.options.rotating||r.options.zooming||Pr||je?I.LINEAR:I.NEAREST,yt=Le.imageAtlasTexture.size}const rn=Ee.projection.name==="globe",ln=rn?Pe:ve,sn=rn?_o(D.zoom):0,un=TI(Me,Ee.getProjection(),D),vn=D.calculatePixelsToTileUnitsMatrix(Le),zn=C2(un,Le.tileID.canonical,W,N,D,Ee.getProjection(),vn),ai=r.terrain&&W&&V?at.invert(at.create(),zn):l8,Ai=KB(un,Le.tileID.canonical,W,N,D,Ee.getProjection(),vn),Xn=ae&&Ee.hasTextData(),Gn=Ee.hasIconTextFit()&&Xn&&Ee.hasIconData();if(V){const Pr=D.elevation,Wr=Pr?Pr.getAtTileOffsetFunc(Me,D.center.lat,D.worldSize,Ee.getProjection()):null,Qi=ZB(un,Le.tileID.canonical,W,N,D,Ee.getProjection(),vn);Cie(Ee,un,r,u,Qi,Ai,W,x,Wr,Me)}const Ln=V||u&&ae||Gn,An=r.translatePosMatrix(un,Le,h,m),vi=Ln?l8:zn,Li=r.translatePosMatrix(Ai,Le,h,m,!0),ri=Ee.getProjection().createInversionMatrix(D,Me.canonical),Ji=o.paint.get("icon-image-cross-fade").constantOr(0),Cr=[];r.terrainRenderModeElevated()&&W&&Cr.push("PITCH_WITH_MAP_TERRAIN"),rn&&(Cr.push("PROJECTION_GLOBE_VIEW"),Ln&&Cr.push("PROJECTED_POS_ON_VIEWPORT")),Ji>0&&Cr.push("ICON_TRANSITION"),He.zOffsetVertexBuffer&&Cr.push("Z_OFFSET");const hr=nt&&o.paint.get(u?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let or;or=nt?Ee.iconsInText?Sae(Ve.kind,ot,q,W,r,An,vi,Li,yt,St,Me,sn,J,ri,ln,Ee.getProjection()):r8(Ve.kind,ot,q,W,r,An,vi,Li,u,yt,!0,Me,sn,J,ri,ln,Ee.getProjection()):i8(Ve.kind,ot,q,W,r,An,vi,Li,u,yt,Me,sn,J,ri,ln,Ee.getProjection(),Ji);const ca={program:r.getOrCreateProgram(Pae(nt,u,Ee),{config:Ke,defines:Cr}),buffers:He,uniformValues:or,atlasTexture:ft,atlasTextureIcon:Ct,atlasInterpolation:Lt,atlasInterpolationIcon:Ft,isSDF:nt,hasHalo:hr,tile:Le,labelPlaneMatrixInv:ai};if(Z&&Ee.canOverlap){K=!0;const Pr=He.segments.get();for(const Wr of Pr)ge.push({segments:new qi([Wr]),sortKey:Wr.sortKey,state:ca})}else ge.push({segments:He.segments,sortKey:0,state:ca})}K&&ge.sort((Me,Le)=>Me.sortKey-Le.sortKey);for(const Me of ge){const Le=Me.state;if(r.terrain&&r.terrain.setupElevationDraw(Le.tile,Le.program,{useDepthForOcclusion:!ce&&!D.isOrthographic,labelPlaneMatrixInv:Le.labelPlaneMatrixInv}),C.activeTexture.set(I.TEXTURE0),Le.atlasTexture.bind(Le.atlasInterpolation,I.CLAMP_TO_EDGE),Le.atlasTextureIcon&&(C.activeTexture.set(I.TEXTURE1),Le.atlasTextureIcon&&Le.atlasTextureIcon.bind(Le.atlasInterpolationIcon,I.CLAMP_TO_EDGE)),r.uploadCommonLightUniforms(r.context,Le.program),Le.hasHalo){const Ee=Le.uniformValues;Ee.u_is_halo=1,DI(Le.buffers,Me.segments,o,r,Le.program,X,w,E,Ee,2),Ee.u_is_halo=0}else{if(Le.isSDF){const Ee=Le.uniformValues;Le.hasHalo&&(Ee.u_is_halo=1,DI(Le.buffers,Me.segments,o,r,Le.program,X,w,E,Ee,1)),Ee.u_is_halo=0}DI(Le.buffers,Me.segments,o,r,Le.program,X,w,E,Le.uniformValues,1)}}}function DI(r,t,o,c,u,h,m,g,v,x){const w=[r.dynamicLayoutVertexBuffer,r.opacityVertexBuffer,r.iconTransitioningVertexBuffer,r.globeExtVertexBuffer,r.zOffsetVertexBuffer];u.draw(c,c.context.gl.TRIANGLES,h,m,g,mi.disabled,v,o.id,r.layoutVertexBuffer,r.indexBuffer,t,o.paint,c.transform.zoom,r.programConfigurations.get(o.id),w,x)}function u8(r,t,o,c,u,h,m){const g=r.context.gl,v=o.paint.get("fill-pattern"),x=v&&v.constantOr(1);let w,E,C,I,D;m?(E=x&&!o.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",w=g.LINES):(E=x?"fillPattern":"fill",w=g.TRIANGLES);for(const N of c){const W=t.getTile(N);if(x&&!W.patternsLoaded())continue;const V=W.getBucket(o);if(!V)continue;r.prepareDrawTile();const q=V.programConfigurations.get(o.id),Z=r.isTileAffectedByFog(N),K=r.getOrCreateProgram(E,{config:q,overrideFog:Z});x&&(r.context.activeTexture.set(g.TEXTURE0),W.imageAtlasTexture.bind(g.LINEAR,g.CLAMP_TO_EDGE),q.updatePaintBuffers());const X=v.constantOr(null);if(X&&W.imageAtlas){const ce=W.imageAtlas.patternPositions[X.toString()];ce&&q.setConstantPatternPositions(ce)}const J=r.translatePosMatrix(N.projMatrix,W,o.paint.get("fill-translate"),o.paint.get("fill-translate-anchor")),ae=o.paint.get("fill-emissive-strength");if(m){I=V.indexBuffer2,D=V.segments2;const ce=r.terrain&&r.terrain.renderingToTexture?r.terrain.drapeBufferSize:[g.drawingBufferWidth,g.drawingBufferHeight];C=E==="fillOutlinePattern"&&x?yae(J,ae,r,W,ce):gae(J,ae,ce)}else I=V.indexBuffer,D=V.segments,C=x?QU(J,ae,r,W):JU(J,ae);r.uploadCommonUniforms(r.context,K,N.toUnwrapped()),K.draw(r,w,u,r.stencilModeForClipping(N),h,mi.disabled,C,o.id,V.layoutVertexBuffer,I,D,o.paint,r.transform.zoom,q,void 0)}}function q2(r,t,o,c,u,h,m,g){const v=r.context,x=v.gl,w=r.transform,E=o.paint.get("fill-extrusion-pattern"),C=E.constantOr(1),I=o.paint.get("fill-extrusion-opacity"),D=r.style.enable3dLights(),N=o.paint.get(D&&!C?"fill-extrusion-ambient-occlusion-wall-radius":"fill-extrusion-ambient-occlusion-radius"),W=[o.paint.get("fill-extrusion-ambient-occlusion-intensity"),N],V=o.layout.get("fill-extrusion-edge-radius"),q=V>0&&!o.paint.get("fill-extrusion-rounded-roof"),Z=q?0:V,K=w.projection.name==="globe"?k6():0,X=w.projection.name==="globe",J=X?_o(w.zoom):0,ae=[xo(w.center.lng),Io(w.center.lat)],ce=o.paint.get("fill-extrusion-flood-light-color").toArray01().slice(0,3),ge=o.paint.get("fill-extrusion-flood-light-intensity"),ve=o.paint.get("fill-extrusion-vertical-scale"),Pe=Rv(r,o.paint.get("fill-extrusion-cutoff-fade-range")),Me=[];let Le;X&&Me.push("PROJECTION_GLOBE_VIEW"),W[0]>0&&Me.push("FAUX_AO"),q&&Me.push("ZERO_ROOF_RADIUS"),g&&Me.push("HAS_CENTROID"),ge>0&&Me.push("FLOOD_LIGHT"),Pe.shouldRenderCutoff&&Me.push("RENDER_CUTOFF");const Ee=r.renderPass==="shadow",He=r.shadowRenderer,Ke=Ee&&!!He;r.shadowRenderer&&(r.shadowRenderer.useNormalOffset=!0);let nt=[0,0,0];if(He){const je=r.style.directionalLight,ot=r.style.ambientLight;je&&ot&&(nt=NI(je,ot)),Le=Me.concat(["SHADOWS_SINGLE_CASCADE"])}const Ve=Ke?"fillExtrusionDepth":C?"fillExtrusionPattern":"fillExtrusion";for(const je of c){const ot=t.getTile(je),yt=ot.getBucket(o);if(!yt||yt.projection.name!==w.projection.name)continue;let ft=!1;He&&(ft=He.getMaxCascadeForTile(je.toUnwrapped())===0);const Lt=r.isTileAffectedByFog(je),Ft=yt.programConfigurations.get(o.id),St=r.getOrCreateProgram(Ve,{config:Ft,defines:ft?Le:Me,overrideFog:Lt});if(r.terrain){const un=r.terrain;r.style.terrainSetForDrapingOnly(),un.setupElevationDraw(ot,St,{useMeterToDem:!0})}if(!yt.centroidVertexBuffer){const un=St.attributes.a_centroid_pos;un!==void 0&&x.vertexAttrib2f(un,0,0)}!Ee&&He&&He.setupShadows(ot.tileID.toUnwrapped(),St,"vector-tile",ot.tileID.overscaledZ),C&&(r.context.activeTexture.set(x.TEXTURE0),ot.imageAtlasTexture.bind(x.LINEAR,x.CLAMP_TO_EDGE),Ft.updatePaintBuffers());const Ct=E.constantOr(null);if(Ct&&ot.imageAtlas){const un=ot.imageAtlas.patternPositions[Ct.toString()];un&&Ft.setConstantPatternPositions(un)}const rn=o.paint.get("fill-extrusion-vertical-gradient");let ln;if(Ee&&He){if(Dae(ot.tileID,yt,r))continue;const un=He.calculateShadowPassMatrixFromTile(ot.tileID.toUnwrapped());ln=pae(un,Z,ve)}else{const un=r.translatePosMatrix(je.projMatrix,ot,o.paint.get("fill-extrusion-translate"),o.paint.get("fill-extrusion-translate-anchor")),vn=w.projection.createInversionMatrix(w,je.canonical);ln=C?mae(un,r,rn,I,W,Z,je,ot,K,J,ae,vn,ce,ve):KU(un,r,rn,I,W,Z,je,K,J,ae,vn,ce,ve,ge,nt)}r.uploadCommonUniforms(v,St,je.toUnwrapped(),null,Pe);const sn=[];(r.terrain||g)&&sn.push(yt.centroidVertexBuffer),X&&sn.push(yt.layoutVertexExtBuffer),St.draw(r,v.gl.TRIANGLES,u,h,m,mi.backCCW,ln,o.id,yt.layoutVertexBuffer,yt.indexBuffer,yt.segments,o.paint,r.transform.zoom,Ft,sn)}r.shadowRenderer&&(r.shadowRenderer.useNormalOffset=!1)}function kv(r,t,o,c,u,h,m,g,v,x,w,E,C,I,D,N,W,V,q){const Z=r.context,K=Z.gl,X=r.transform,J=r.transform.zoom,ae=[],ce=Rv(r,o.paint.get("fill-extrusion-cutoff-fade-range"));x==="clear"?(ae.push("CLEAR_SUBPASS"),q&&(ae.push("CLEAR_FROM_TEXTURE"),Z.activeTexture.set(K.TEXTURE0),q.bind(K.LINEAR,K.CLAMP_TO_EDGE))):x==="sdf"&&ae.push("SDF_SUBPASS"),W&&ae.push("HAS_CENTROID"),ce.shouldRenderCutoff&&ae.push("RENDER_CUTOFF");const ge=o.layout.get("fill-extrusion-edge-radius"),ve=(Pe,Me,Le,Ee,He)=>{const Ke=Me.programConfigurations.get(o.id),nt=r.isTileAffectedByFog(Pe),Ve=r.getOrCreateProgram("fillExtrusionGroundEffect",{config:Ke,defines:ae,overrideFog:nt}),je=((yt,ft,Lt,Ft,St,Ct,rn,ln,sn,un,vn)=>({u_matrix:ft,u_opacity:Lt,u_ao_pass:Ft?1:0,u_meter_to_tile:St,u_ao:Ct,u_flood_light_intensity:rn,u_flood_light_color:ln,u_attenuation:sn,u_edge_radius:un,u_fb:0,u_fb_size:vn}))(0,Ee,w,v,He,[E,C*He],I,D,N,J>=17?0:ge*He,q?q.size[0]:0),ot=[];W&&ot.push(Me.hiddenByLandmarkVertexBuffer),r.uploadCommonUniforms(Z,Ve,Pe.toUnwrapped(),null,ce),Ve.draw(r,Z.gl.TRIANGLES,u,h,m,g,je,o.id,Me.vertexBuffer,Me.indexBuffer,Le,o.paint,J,Ke,ot)};for(const Pe of c){const Me=t.getTile(Pe),Le=Me.getBucket(o);if(!Le||Le.projection.name!==X.projection.name||!Le.groundEffect||Le.groundEffect&&!Le.groundEffect.hasData())continue;const Ee=Le.groundEffect,He=1/Le.tileToMeter;{const Ke=r.translatePosMatrix(Pe.projMatrix,Me,o.paint.get("fill-extrusion-translate"),o.paint.get("fill-extrusion-translate-anchor")),nt=Ee.getDefaultSegment();ve(Pe,Ee,nt,Ke,He)}if(V)for(let Ke=0;Ke<4;Ke++){const nt=oF[Ke](Pe),Ve=t.getTile(nt);if(!Ve)continue;const je=Ve.getBucket(o);if(!je||je.projection.name!==X.projection.name||!je.groundEffect||je.groundEffect&&!je.groundEffect.hasData())continue;const ot=je.groundEffect;let yt,ft;Ke===0?(yt=[-mt,0,0],ft=1):Ke===1?(yt=[mt,0,0],ft=0):Ke===2?(yt=[0,-mt,0],ft=3):(yt=[0,mt,0],ft=2);const Lt=ot.regionSegments[ft];if(!Lt)continue;const Ft=new Float32Array(16);at.translate(Ft,Pe.projMatrix,yt),ve(Pe,ot,Lt,r.translatePosMatrix(Ft,Me,o.paint.get("fill-extrusion-translate"),o.paint.get("fill-extrusion-translate-anchor")),He)}}}function Iae(r,t,o,c,u,h,m){c.centroidVertexArray.length===0&&c.createCentroidsBuffer();const g=h?h.findDEMTileFor(o):null;if(!(g&&g.dem||m))return;const v=V=>{const q=t.getSource().minzoom,Z=X=>{const J=t.getTileByID(X);if(J&&J.hasData())return J.getBucket(u)},K=[0,-1,1];for(const X of K){if(V.overscaledZ+X<q)continue;const J=Z(V.calculateScaledKey(V.overscaledZ+X));if(J)return J}},x=[0,0,0],w=(V,q)=>(x[0]=Math.min(V.min.y,q.min.y),x[1]=Math.max(V.max.y,q.max.y),x[2]=mt-q.min.x>V.max.x?q.min.x-mt:V.max.x,x),E=(V,q)=>(x[0]=Math.min(V.min.x,q.min.x),x[1]=Math.max(V.max.x,q.max.x),x[2]=mt-q.min.y>V.max.y?q.min.y-mt:V.max.y,x),C=[(V,q)=>w(V,q),(V,q)=>w(q,V),(V,q)=>E(V,q),(V,q)=>E(q,V)],I=(V,q,Z,K,X,J,ae)=>{if(!h)return 0;const ce=[[J?Z:V,J?V:Z,0],[J?Z:q,J?q:Z,0]],ge=ae<0?mt+ae:ae,ve=[J?ge:(V+q)/2,J?(V+q)/2:ge,0];return Z===0&&ae<0||Z!==0&&ae>0?h.getForTilePoints(X,[ve],!0,K):ce.push(ve),h.getForTilePoints(o,ce,!0,g),Math.max(ce[0][2],ce[1][2],ve[2])/h.exaggeration()};for(let V=0;V<4;V++){const q=c.borderFeatureIndices[V];if(q.length===0)continue;const Z=oF[V](o),K=v(Z);if(!(K&&K instanceof U1)||c.borderDoneWithNeighborZ[V]===K.canonical.z)continue;K.centroidVertexArray.length===0&&K.createCentroidsBuffer();const X=h?h.findDEMTileFor(Z):null;if(!(X&&X.dem||m))continue;const J=(V<2?1:5)-V,ae=K.borderDoneWithNeighborZ[J]!==c.canonical.z,ce=K.borderFeatureIndices[J];let ge=0;if(c.canonical.z!==K.canonical.z){for(const ve of q)c.showCentroid(c.featuresOnBorder[ve]);if(ae)for(const ve of ce)K.showCentroid(K.featuresOnBorder[ve]);c.borderDoneWithNeighborZ[V]=K.canonical.z,K.borderDoneWithNeighborZ[J]=c.canonical.z}for(const ve of q){const Pe=c.featuresOnBorder[ve],Me=c.centroidData[Pe.centroidDataIndex],Le=Pe.borders[V];let Ee;for(;ge<ce.length;){Ee=K.featuresOnBorder[ce[ge]];const He=Ee.borders[J];if(He[1]>Le[0]+3||He[0]>Le[0]-3)break;K.showCentroid(Ee),ge++}if(Ee&&ge<ce.length){const He=ge;let Ke=0;for(;!(Ee.borders[J][0]>Le[1]-3)&&(Ke++,++ge!==ce.length);)Ee=K.featuresOnBorder[ce[ge]];if(Ee=K.featuresOnBorder[ce[He]],Ke>1){const je=Ee.borders[J];Math.abs(Le[0]-je[0])<3&&Math.abs(Le[1]-je[1])<3&&(Ke=1,ge=He+1)}else if(Ke===0){c.showCentroid(Pe);continue}const nt=K.centroidData[Ee.centroidDataIndex];m&&Ke===1&&(((N=Me).flags|(W=nt).flags)&ed?(N.flags|=ed,W.flags|=ed):(N.flags&=2147483647,W.flags&=2147483647));let Ve=new G(0,0);if(Ke>1)ge=He;else if(X&&X.dem&&!(Pe.intersectsCount()>1||Ee.intersectsCount()>1)){const je=C[V](Me,nt),ot=V%2?mt-1:0;D=I(je[0],Math.min(mt-1,je[1]),ot,X,Z,V<2,je[2]),Ve=new G(Math.ceil(7*(D+450)),0)}Me.centroidXY=nt.centroidXY=Ve,c.writeCentroidToBuffer(Me),K.writeCentroidToBuffer(nt)}else c.showCentroid(Pe)}c.borderDoneWithNeighborZ[V]=K.canonical.z,K.borderDoneWithNeighborZ[J]=c.canonical.z}var D,N,W;(c.needsCentroidUpdate||!c.centroidVertexBuffer&&c.centroidVertexArray.length!==0)&&c.uploadCentroid(r)}const Rae=[1,0,0],Lae=[0,1,0],kae=[0,0,1];function Dae(r,t,o){const c=o.transform,u=o.shadowRenderer;if(!u)return!0;const h=r.toUnwrapped(),m=c.tileSize*u._cascades[o.currentShadowCascade].scale;let g=t.maxHeight;if(c.elevation){const N=c.elevation.getMinMaxForTile(r);N&&(g+=N.max)}const v=[...u.shadowDirection];v[2]=-v[2];const x=u.computeSimplifiedTileShadowVolume(h,g,m,v);if(!x)return!1;const w=[Rae,Lae,kae,v,[v[0],0,v[2]],[0,v[1],v[2]]],E=c.projection.name==="globe",C=c.scaleZoom(m),I=ch.fromInvProjectionMatrix(c.invProjMatrix,c.worldSize,C,!E),D=u.getCurrentCascadeFrustum();return I.intersectsPrecise(x.vertices,x.planes,w)===0||D.intersectsPrecise(x.vertices,x.planes,w)===0}const zae=new En(1,0,0,1),Oae=new En(0,1,0,1),Nae=new En(0,0,1,1),Fae=new En(1,0,1,1),Bae=new En(0,1,1,1);function Uae(r,t,o){const c=r.context,u=r.transform,h=c.gl,m=u.projection.name==="globe",g=m?["PROJECTION_GLOBE_VIEW"]:[];let v=o.projMatrix;if(m&&_o(u.zoom)>0){const ve=pP(dF(o.canonical,u));v=at.multiply(new Float32Array(16),u.globeMatrix,ve),at.multiply(v,u.projMatrix,v)}const x=r.getOrCreateProgram("debug",{defines:g}),w=t.getTileByID(o.key);r.terrain&&r.terrain.setupElevationDraw(w,x);const E=Fn.disabled,C=hi.disabled,I=r.colorModeForRenderPass(),D="$debug";c.activeTexture.set(h.TEXTURE0),r.emptyTexture.bind(h.LINEAR,h.CLAMP_TO_EDGE),m?w._makeGlobeTileDebugBuffers(r.context,u):w._makeDebugTileBoundsBuffers(r.context,u.projection);const N=w._tileDebugBuffer||r.debugBuffer,W=w._tileDebugIndexBuffer||r.debugIndexBuffer,V=w._tileDebugSegments||r.debugSegments;x.draw(r,h.LINE_STRIP,E,C,I,mi.disabled,e8(v,En.red),D,N,W,V,null,null,null,[w._globeTileDebugBorderBuffer]);const q=w.latestRawTileData,Z=Math.floor((q&&q.byteLength||0)/1024),K=t.getTile(o).tileSize,X=512/Math.min(K,512)*(o.overscaledZ/u.zoom)*.5;let J=o.canonical.toString();o.overscaledZ!==o.canonical.z&&(J+=` => ${o.overscaledZ}`),J+=` ${Z}kb`,function(ve,Pe){ve.initDebugOverlayCanvas();const Me=ve.debugOverlayCanvas,Le=ve.context.gl,Ee=ve.debugOverlayCanvas.getContext("2d");Ee.clearRect(0,0,Me.width,Me.height),Ee.shadowColor="white",Ee.shadowBlur=2,Ee.lineWidth=1.5,Ee.strokeStyle="white",Ee.textBaseline="top",Ee.font="bold 36px Open Sans, sans-serif",Ee.fillText(Pe,5,5),Ee.strokeText(Pe,5,5),ve.debugOverlayTexture.update(Me),ve.debugOverlayTexture.bind(Le.LINEAR,Le.CLAMP_TO_EDGE)}(r,J);const ae=w._tileDebugTextBuffer||r.debugBuffer,ce=w._tileDebugTextIndexBuffer||r.quadTriangleIndexBuffer,ge=w._tileDebugTextSegments||r.debugSegments;x.draw(r,h.TRIANGLES,E,C,Ri.alphaBlended,mi.disabled,e8(v,En.transparent,X),D,ae,ce,ge,null,null,null,[w._globeTileDebugTextBuffer])}function d8(r,t,o,c){X2(r,0,t+o/2,r.transform.width,o,c)}function h8(r,t,o,c){X2(r,t-o/2,0,o,r.transform.height,c)}function X2(r,t,o,c,u,h){const m=r.context,g=m.gl;g.enable(g.SCISSOR_TEST),g.scissor(t*Pn.devicePixelRatio,o*Pn.devicePixelRatio,c*Pn.devicePixelRatio,u*Pn.devicePixelRatio),m.clear({color:h}),g.disable(g.SCISSOR_TEST)}const Wae=B([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:Vae}=Wae;function Bf(r,t,o,c){r.emplaceBack(t,o,c)}class f8{constructor(t){this.vertexArray=new On,this.indices=new Un,Bf(this.vertexArray,-1,-1,1),Bf(this.vertexArray,1,-1,1),Bf(this.vertexArray,-1,1,1),Bf(this.vertexArray,1,1,1),Bf(this.vertexArray,-1,-1,-1),Bf(this.vertexArray,1,-1,-1),Bf(this.vertexArray,-1,1,-1),Bf(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=t.createVertexBuffer(this.vertexArray,Vae),this.indexBuffer=t.createIndexBuffer(this.indices),this.segment=qi.simpleSegment(0,0,36,12)}}function Dv(r,t,o,c,u,h){const m=r.context.gl,g=t.paint.get("sky-atmosphere-color"),v=t.paint.get("sky-atmosphere-halo-color"),x=t.paint.get("sky-atmosphere-sun-intensity"),w=((E,C,I,D,N)=>({u_matrix_3f:E,u_sun_direction:C,u_sun_intensity:I,u_color_tint_r:[D.r,D.g,D.b,D.a],u_color_tint_m:[N.r,N.g,N.b,N.a],u_luminance:5e-5}))(Bs.fromMat4(Bs.create(),c),u,x,g,v);m.framebufferTexture2D(m.FRAMEBUFFER,m.COLOR_ATTACHMENT0,m.TEXTURE_CUBE_MAP_POSITIVE_X+h,t.skyboxTexture,0),o.draw(r,m.TRIANGLES,Fn.disabled,hi.disabled,Ri.unblended,mi.frontCW,w,"skyboxCapture",t.skyboxGeometry.vertexBuffer,t.skyboxGeometry.indexBuffer,t.skyboxGeometry.segment)}const Gae=B([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class Hae{constructor(t){const o=new Hi;o.emplaceBack(-1,1,1,0,0),o.emplaceBack(1,1,1,1,0),o.emplaceBack(1,-1,1,1,1),o.emplaceBack(-1,-1,1,0,1);const c=new Un;c.emplaceBack(0,1,2),c.emplaceBack(2,3,0),this.vertexBuffer=t.createVertexBuffer(o,Gae.members),this.indexBuffer=t.createIndexBuffer(c),this.segments=qi.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const jae=B([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_size_scale",components:1},{type:"Float32",name:"a_fade_opacity",components:1}]);class $ae{constructor(){this.colorModeAlphaBlendedWriteRGB=new Ri([1,T2,1,T2],En.transparent,[!0,!0,!0,!1]),this.colorModeWriteAlpha=new Ri([1,0,1,0],En.transparent,[!1,!1,!1,!0])}update(t){const o=t.context;if(!this.atmosphereBuffer){this.atmosphereBuffer=new Hae(o);const c=100,u=200,h=function(w){const E=Dy(30),C=[];for(let I=0;I<16e3;++I){const D=2*Math.PI*E(),N=Math.acos(1-2*E())-.5*Math.PI;C.push(De.fromValues(Math.cos(N)*Math.cos(D),Math.cos(N)*Math.sin(D),Math.sin(N)))}return C}(),m=Dy(300),g=new yc,v=new Un;let x=0;for(let w=0;w<h.length;++w){const E=De.scale([],h[w],200),C=Math.max(0,1+.01*c*(1*m()-.5)),I=Math.max(0,1+.01*u*(1*m()-.5));g.emplaceBack(E[0],E[1],E[2],-1,-1,C,I),g.emplaceBack(E[0],E[1],E[2],1,-1,C,I),g.emplaceBack(E[0],E[1],E[2],1,1,C,I),g.emplaceBack(E[0],E[1],E[2],-1,1,C,I),v.emplaceBack(x+0,x+1,x+2),v.emplaceBack(x+0,x+2,x+3),x+=4}this.starsVx=o.createVertexBuffer(g,jae.members),this.starsIdx=o.createIndexBuffer(v),this.starsSegments=qi.simpleSegment(0,0,g.length,v.length)}}destroy(){this.atmosphereBuffer&&this.atmosphereBuffer.destroy(),this.starsVx&&this.starsVx.destroy(),this.starsIdx&&this.starsIdx.destroy()}drawAtmosphereGlow(t,o){const c=t.context,u=c.gl,h=t.transform,m=new Fn(u.LEQUAL,Fn.ReadOnly,[0,1]),g=_o(h.zoom),v=o.properties.get("color").toArray01(),x=o.properties.get("high-color").toArray01(),w=o.properties.get("space-color").toArray01PremultipliedAlpha(),E=5e-4,C=re((o.properties.get("horizon-blend")-0)/1*.2495+E,5e-4,.25),I=yF(t,c,h)&&C===E?h.worldSize/(2*Math.PI*1.025)-1:h.globeRadius,D=t.frameCounter/1e3%1,N=De.length(h.globeCenterInViewSpace),W=Math.sqrt(Math.pow(N,2)-Math.pow(I,2)),V=Math.acos(W/N),q=Z=>{const K=h.projection.name==="globe"?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"];Z&&K.push("ALPHA_PASS");const X=t.getOrCreateProgram("globeAtmosphere",{defines:K}),J=((ce,ge,ve,Pe,Me,Le,Ee,He,Ke,nt,Ve,je)=>({u_frustum_tl:ce,u_frustum_tr:ge,u_frustum_br:ve,u_frustum_bl:Pe,u_horizon:Me,u_transition:Le,u_fadeout_range:Ee,u_color:He,u_high_color:Ke,u_space_color:nt,u_temporal_offset:Ve,u_horizon_angle:je}))(h.frustumCorners.TL,h.frustumCorners.TR,h.frustumCorners.BR,h.frustumCorners.BL,h.frustumCorners.horizon,g,C,v,x,w,D,V);t.uploadCommonUniforms(c,X);const ae=this.atmosphereBuffer;ae&&X.draw(t,u.TRIANGLES,m,hi.disabled,Z?this.colorModeWriteAlpha:this.colorModeAlphaBlendedWriteRGB,mi.backCW,J,Z?"atmosphere_glow_alpha":"atmosphere_glow",ae.vertexBuffer,ae.indexBuffer,ae.segments)};q(!1),q(!0)}drawStars(t,o){const c=re(o.properties.get("star-intensity"),0,1);if(c===0)return;const u=t.context,h=u.gl,m=t.transform,g=t.getOrCreateProgram("stars"),v=Po.identity([]);Po.rotateX(v,v,-m._pitch),Po.rotateZ(v,v,-m.angle),Po.rotateX(v,v,ye(m._center.lat)),Po.rotateY(v,v,-ye(m._center.lng));const x=at.fromQuat(new Float32Array(16),v),w=at.multiply([],m.starsProjMatrix,x),E=Bs.fromMat4([],x),C=Bs.invert([],E),I=[0,1,0];De.transformMat3(I,I,C),De.scale(I,I,.15);const D=[1,0,0];De.transformMat3(D,D,C),De.scale(D,D,.15);const N=((W,V,q,Z)=>({u_matrix:Float32Array.from(W),u_up:V,u_right:q,u_intensity_multiplier:Z}))(w,I,D,c);t.uploadCommonUniforms(u,g),this.starsVx&&this.starsIdx&&g.draw(t,h.TRIANGLES,Fn.disabled,hi.disabled,this.colorModeAlphaBlendedWriteRGB,mi.disabled,N,"atmosphere_stars",this.starsVx,this.starsIdx,this.starsSegments)}}function p8(r,t){const o=[...r],c=t.cameraWorldSizeForFog/t.worldSize,u=at.identity([]);return at.scale(u,u,[c,c,1]),at.multiply(o,u,o),at.multiply(o,t.worldToFogMatrix,o),o}function zI(r,t,o,c){const u=o.material,h=c.context,{baseColorTexture:m,metallicRoughnessTexture:g}=u.pbrMetallicRoughness,{normalTexture:v,occlusionTexture:x,emissionTexture:w}=u;function E(C,I,D){if(C&&(r.push(I),h.activeTexture.set(h.gl.TEXTURE0+D),C.gfxTexture)){const{minFilter:N,magFilter:W,wrapS:V,wrapT:q}=C.sampler;C.gfxTexture.bindExtraParam(N,W,V,q)}}E(m,"HAS_TEXTURE_u_baseColorTexture",dl.BaseColor),E(g,"HAS_TEXTURE_u_metallicRoughnessTexture",dl.MetallicRoughness),E(v,"HAS_TEXTURE_u_normalTexture",dl.Normal),E(x,"HAS_TEXTURE_u_occlusionTexture",dl.Occlusion),E(w,"HAS_TEXTURE_u_emissionTexture",dl.Emission),o.texcoordBuffer&&(r.push("HAS_ATTRIBUTE_a_uv_2f"),t.push(o.texcoordBuffer)),o.colorBuffer&&(r.push(o.colorBuffer.itemSize===12?"HAS_ATTRIBUTE_a_color_3f":"HAS_ATTRIBUTE_a_color_4f"),t.push(o.colorBuffer)),o.normalBuffer&&(r.push("HAS_ATTRIBUTE_a_normal_3f"),t.push(o.normalBuffer)),o.pbrBuffer&&(r.push("HAS_ATTRIBUTE_a_pbr"),r.push("HAS_ATTRIBUTE_a_heightBasedEmissiveStrength"),t.push(o.pbrBuffer)),u.alphaMode!=="OPAQUE"&&u.alphaMode!=="MASK"||r.push("UNPREMULT_TEXTURE_IN_SHADER"),u.defined||r.push("DIFFUSE_SHADED"),r.push("USE_STANDARD_DERIVATIVES")}function Z2(r,t,o,c,u,h){const m=o.paint.get("model-opacity"),g=t.context,v=new Fn(t.context.gl.LEQUAL,Fn.ReadWrite,t.depthRangeFor3D),x=t.transform,w=r.mesh,E=w.material,C=E.pbrMetallicRoughness,I=t.style.fog;let D;D=t.transform.projection.zAxisUnit==="pixels"?[...r.nodeModelMatrix]:at.multiply([],c.zScaleMatrix,r.nodeModelMatrix),at.multiply(D,c.negCameraPosMatrix,D);const N=at.invert([],D);at.transpose(N,N);const W=kI(new Float32Array(r.worldViewProjection),new Float32Array(D),new Float32Array(N),t,m,C.baseColorFactor,E.emissiveFactor,C.metallicFactor,C.roughnessFactor,E,o),V={defines:[]},q=[];zI(V.defines,q,w,t);const Z=t.shadowRenderer;Z&&(Z.useNormalOffset=!1);let K=null;if(I){const ae=p8(r.nodeModelMatrix,t.transform);if(K=new Float32Array(ae),x.projection.name!=="globe"){const ce=w.aabb.min,ge=w.aabb.max,[ve,Pe]=I.getOpacityForBounds(ae,ce[0],ce[1],ge[0],ge[1]);V.overrideFog=ve>=Om||Pe>=Om}}const X=Rv(t,o.paint.get("model-cutoff-fade-range"));X.shouldRenderCutoff&&V.defines.push("RENDER_CUTOFF");const J=t.getOrCreateProgram("model",V);t.uploadCommonUniforms(g,J,null,K,X),t.renderPass!=="shadow"&&Z&&Z.setupShadowsFromMatrix(r.nodeModelMatrix,J),J.draw(t,g.gl.TRIANGLES,v,u,h,w.material.doubleSided?mi.disabled:mi.backCCW,W,o.id,w.vertexBuffer,w.indexBuffer,w.segments,o.paint,t.transform.zoom,void 0,q)}function m8(r,t,o,c,u,h,m){let g;g=r.projection.name==="globe"?l6(o,r):[...o],at.multiply(g,g,t.matrix);const v=at.multiply([],c,g);if(t.meshes)for(const x of t.meshes){if(x.material.alphaMode!=="BLEND"){m.push({mesh:x,depth:0,modelIndex:u,worldViewProjection:v,nodeModelMatrix:g});continue}const w=De.transformMat4([],x.centroid,v);w[2]>0&&h.push({mesh:x,depth:w[2],modelIndex:u,worldViewProjection:v,nodeModelMatrix:g})}if(t.children)for(const x of t.children)m8(r,x,o,c,u,h,m)}function OI(r,t,o,c){const u=o.shadowRenderer;if(!u)return;const h=u.getShadowPassDepthMode(),m=u.getShadowPassColorMode(),g=u.calculateShadowPassMatrixFromMatrix(t),v=o8(g);o.getOrCreateProgram("modelDepth",{defines:["DEPTH_TEXTURE"]}).draw(o,o.context.gl.TRIANGLES,h,hi.disabled,m,mi.backCCW,v,c.id,r.vertexBuffer,r.indexBuffer,r.segments,c.paint,o.transform.zoom,void 0,void 0)}function Yae(r,t,o){const c=t.updateZoomBasedPaintProperties(),u=function(h,m,g){let v,x,w,E=h.terrain?h.terrain.exaggeration():0;if(h.terrain&&E>0){const C=h.terrain,I=C.findDEMTileFor(g);I&&I.dem?v=xv.create(C,g,I):E=0}if(E===0&&(m.terrainElevationMin=0,m.terrainElevationMax=0),E===m.validForExaggeration&&(E===0||v&&v._demTile&&v._demTile.tileID===m.validForDEMTile.id&&v._dem._timestamp===m.validForDEMTile.timestamp))return!1;for(const C in m.instancesPerModel){const I=m.instancesPerModel[C];for(let D=0;D<I.instancedDataArray.length;++D){const N=(v?E*v.getElevationAt(0|I.instancedDataArray.float32[16*D],0|I.instancedDataArray.float32[16*D+1],!0,!0):0)+I.instancesEvaluatedElevation[D];I.instancedDataArray.float32[16*D+6]=N,x=x?Math.min(m.terrainElevationMin,N):N,w=w?Math.max(m.terrainElevationMax,N):N}}return m.terrainElevationMin=x||0,m.terrainElevationMax=w||0,m.validForExaggeration=E,m.validForDEMTile=v&&v._demTile?{id:v._demTile.tileID,timestamp:v._dem._timestamp}:{id:void 0,timestamp:0},!0}(r,t,o);(c||u)&&(t.uploaded=!1,t.upload(r.context))}const id={shadowUniformsInitialized:!1,useSingleShadowCascade:!1,tileMatrix:new Float64Array(16),shadowTileMatrix:new Float32Array(16),aabb:new _r([0,0,0],[mt,mt,0])};function qae(r,t){const o=1<<r.canonical.z,c=t.getFreeCameraOptions().position,u=t.elevation,h=r.canonical.x/o,m=(r.canonical.x+1)/o,g=r.canonical.y/o,v=(r.canonical.y+1)/o;let x=t._centerAltitude;if(u){const I=u.getMinMaxForTile(r);I&&I.max>x&&(x=I.max)}const w=re(c.x,h,m)-c.x,E=re(c.y,g,v)-c.y,C=Xi(x,t.center.lat)-c.z;return t._zoomFromMercatorZ(Math.sqrt(w*w+E*E+C*C))}function g8(r,t,o,c,u,h,m){const g=r.context,v=r.renderPass==="shadow",x=r.shadowRenderer,w=v&&x?x.getShadowPassDepthMode():new Fn(g.gl.LEQUAL,Fn.ReadWrite,r.depthRangeFor3D),E=r.isTileAffectedByFog(h);if(o.meshes)for(const C of o.meshes){const I=["MODEL_POSITION_ON_GPU"],D=[];let N,W,V;c.instancedDataArray.length>20&&I.push("INSTANCED_ARRAYS");const q=Rv(r,t.paint.get("model-cutoff-fade-range"));if(q.shouldRenderCutoff&&I.push("RENDER_CUTOFF"),v&&x)N=r.getOrCreateProgram("modelDepth",{defines:I}),W=o8(m.shadowTileMatrix,m.shadowTileMatrix,Float32Array.from(o.matrix)),V=x.getShadowPassColorMode();else{zI(I,D,C,r),N=r.getOrCreateProgram("model",{defines:I,overrideFog:E});const K=C.material,X=K.pbrMetallicRoughness,J=t.paint.get("model-opacity");W=kI(h.projMatrix,Float32Array.from(o.matrix),new Float32Array(16),r,J,X.baseColorFactor,K.emissiveFactor,X.metallicFactor,X.roughnessFactor,K,t,u),x&&(m.shadowUniformsInitialized?N.setShadowUniformValues(g,x.getShadowUniformValues()):(x.setupShadows(h.toUnwrapped(),N,"model-tile",h.overscaledZ),m.shadowUniformsInitialized=!0)),V=q.shouldRenderCutoff||J<1||K.alphaMode!=="OPAQUE"?Ri.alphaBlended:Ri.unblended}r.uploadCommonUniforms(g,N,h.toUnwrapped(),null,q);const Z=C.material.doubleSided?mi.disabled:mi.backCCW;if(c.instancedDataArray.length>20)D.push(c.instancedDataBuffer),N.draw(r,g.gl.TRIANGLES,w,hi.disabled,V,Z,W,t.id,C.vertexBuffer,C.indexBuffer,C.segments,t.paint,r.transform.zoom,void 0,D,c.instancedDataArray.length);else{const K=v?"u_instance":"u_normal_matrix";for(let X=0;X<c.instancedDataArray.length;++X)W[K]=new Float32Array(c.instancedDataArray.arrayBuffer,64*X,16),N.draw(r,g.gl.TRIANGLES,w,hi.disabled,V,Z,W,t.id,C.vertexBuffer,C.indexBuffer,C.segments,t.paint,r.transform.zoom,void 0,D)}}if(o.children)for(const C of o.children)g8(r,t,C,c,u,h,m)}const Xae=[1,-1,1];function Zae(r,t,o,c){if(!o.modelManager)return!0;const u=o.modelManager;if(!o.shadowRenderer)return!0;const h=o.shadowRenderer,m=t.aabb;let g=!0,v=r.maxHeight;if(v===0){let w=0;for(const E in r.instancesPerModel){const C=u.getModel(E,c);C?w=Math.max(w,Math.max(Math.max(C.aabb.max[0],C.aabb.max[1]),C.aabb.max[2])):g=!1}v=r.maxScale*w*1.41+r.maxVerticalOffset,g&&(r.maxHeight=v)}m.max[2]=v,m.min[2]+=r.terrainElevationMin,m.max[2]+=r.terrainElevationMax,De.transformMat4(m.min,m.min,t.tileMatrix),De.transformMat4(m.max,m.max,t.tileMatrix);const x=m.intersects(h.getCurrentCascadeFrustum());return o.currentShadowCascade===0&&(r.isInsideFirstShadowMapFrustum=x===2),x===0}class Kae{}class Jae{constructor(){this._storage=new Map}getLinesFromTrianglesBuffer(t,o,c){{const E=this._storage.get(o.id);if(E)return E.lastUsedFrameIdx=t,E.buf}const u=c.gl,h=u.getBufferParameter(u.ELEMENT_ARRAY_BUFFER,u.BUFFER_SIZE),m=new ArrayBuffer(h),g=new Int16Array(m);u.getBufferSubData(u.ELEMENT_ARRAY_BUFFER,0,new Int16Array(m));const v=new no;for(let E=0;E<h/2;E+=3){const C=g[E],I=g[E+1],D=g[E+2];v.emplaceBack(C,I),v.emplaceBack(I,D),v.emplaceBack(D,C)}const x=c.bindVertexArrayOES.current,w=new Kae;return w.buf=new Of(c,v),w.lastUsedFrameIdx=t,this._storage.set(o.id,w),c.bindVertexArrayOES.set(x),w.buf}update(t){for(const[o,c]of this._storage)t-c.lastUsedFrameIdx>30&&(c.buf.destroy(),this._storage.delete(o))}destroy(){for(const[t,o]of this._storage)o.buf.destroy(),this._storage.delete(t)}}const y8={symbol:function(r,t,o,c,u){if(r.renderPass!=="translucent")return;const h=hi.disabled,m=r.colorModeForRenderPass();o.layout.get("text-variable-anchor")&&function(g,v,x,w,E,C,I){const D=v.transform,N=E==="map",W=C==="map";for(const V of g){const q=w.getTile(V),Z=q.getBucket(x);if(!Z||!Z.text||!Z.text.segments.get().length)continue;const K=Ku(Z.textSizeData,D.zoom),X=TI(V,Z.getProjection(),D),J=D.calculatePixelsToTileUnitsMatrix(q),ae=C2(X,q.tileID.canonical,W,N,D,Z.getProjection(),J),ce=Z.hasIconTextFit()&&Z.hasIconData();if(K){const ge=Math.pow(2,D.zoom-q.tileID.overscaledZ);Cae(Z,N,W,I,Kte,D,ae,V,ge,K,ce)}}}(c,r,o,t,o.layout.get("text-rotation-alignment"),o.layout.get("text-pitch-alignment"),u),o.paint.get("icon-opacity").constantOr(1)!==0&&c8(r,t,o,c,!1,o.paint.get("icon-translate"),o.paint.get("icon-translate-anchor"),o.layout.get("icon-rotation-alignment"),o.layout.get("icon-pitch-alignment"),o.layout.get("icon-keep-upright"),h,m),o.paint.get("text-opacity").constantOr(1)!==0&&c8(r,t,o,c,!0,o.paint.get("text-translate"),o.paint.get("text-translate-anchor"),o.layout.get("text-rotation-alignment"),o.layout.get("text-pitch-alignment"),o.layout.get("text-keep-upright"),h,m),t.map.showCollisionBoxes&&(s8(r,t,o,c,o.paint.get("text-translate"),o.paint.get("text-translate-anchor"),!0),s8(r,t,o,c,o.paint.get("icon-translate"),o.paint.get("icon-translate-anchor"),!1))},circle:function(r,t,o,c){if(r.renderPass!=="translucent")return;const u=o.paint.get("circle-opacity"),h=o.paint.get("circle-stroke-width"),m=o.paint.get("circle-stroke-opacity"),g=o.layout.get("circle-sort-key").constantOr(1)!==void 0,v=o.paint.get("circle-emissive-strength");if(u.constantOr(1)===0&&(h.constantOr(1)===0||m.constantOr(1)===0))return;const x=r.context,w=x.gl,E=r.transform,C=r.depthModeForSublayer(0,Fn.ReadOnly),I=hi.disabled,D=r.colorModeForDrapableLayerRenderPass(v),N=E.projection.name==="globe",W=[xo(E.center.lng),Io(E.center.lat)],V=[];for(let Z=0;Z<c.length;Z++){const K=c[Z],X=t.getTile(K),J=X.getBucket(o);if(!J||J.projection.name!==E.projection.name)continue;const ae=J.programConfigurations.get(o.id),ce=LF(o),ge=r.isTileAffectedByFog(K);N&&ce.push("PROJECTION_GLOBE_VIEW");const ve=r.getOrCreateProgram("circle",{config:ae,defines:ce,overrideFog:ge}),Pe=J.layoutVertexBuffer,Me=J.globeExtVertexBuffer,Le=J.indexBuffer,Ee=E.projection.createInversionMatrix(E,K.canonical),He={programConfiguration:ae,program:ve,layoutVertexBuffer:Pe,globeExtVertexBuffer:Me,indexBuffer:Le,uniformValues:qee(r,K,X,Ee,W,o),tile:X};if(g){const Ke=J.segments.get();for(const nt of Ke)V.push({segments:new qi([nt]),sortKey:nt.sortKey,state:He})}else V.push({segments:J.segments,sortKey:0,state:He})}g&&V.sort((Z,K)=>Z.sortKey-K.sortKey);const q={useDepthForOcclusion:!N};for(const Z of V){const{programConfiguration:K,program:X,layoutVertexBuffer:J,globeExtVertexBuffer:ae,indexBuffer:ce,uniformValues:ge,tile:ve}=Z.state,Pe=Z.segments;r.terrain&&r.terrain.setupElevationDraw(ve,X,q),r.uploadCommonUniforms(x,X,ve.tileID.toUnwrapped()),X.draw(r,w.TRIANGLES,C,I,D,mi.disabled,ge,o.id,J,ce,Pe,o.paint,E.zoom,K,[ae])}},heatmap:function(r,t,o,c){if(o.paint.get("heatmap-opacity")!==0)if(r.renderPass==="offscreen"){const u=r.context,h=u.gl,m=hi.disabled,g=new Ri([h.ONE,h.ONE,h.ONE,h.ONE],En.transparent,[!0,!0,!0,!0]);(function(I,D,N,W){const V=I.gl,q=D.width*W,Z=D.height*W;I.activeTexture.set(V.TEXTURE1),I.viewport.set([0,0,q,Z]);let K=N.heatmapFbo;if(!K||K&&(K.width!==q||K.height!==Z)){K&&K.destroy();const X=V.createTexture();V.bindTexture(V.TEXTURE_2D,X),V.texParameteri(V.TEXTURE_2D,V.TEXTURE_WRAP_S,V.CLAMP_TO_EDGE),V.texParameteri(V.TEXTURE_2D,V.TEXTURE_WRAP_T,V.CLAMP_TO_EDGE),V.texParameteri(V.TEXTURE_2D,V.TEXTURE_MIN_FILTER,V.LINEAR),V.texParameteri(V.TEXTURE_2D,V.TEXTURE_MAG_FILTER,V.LINEAR),K=N.heatmapFbo=I.createFramebuffer(q,Z,!0,null),function(J,ae,ce,ge,ve,Pe){const Me=J.gl;Me.texImage2D(Me.TEXTURE_2D,0,J.extRenderToTextureHalfFloat?Me.RGBA16F:Me.RGBA,ve,Pe,0,Me.RGBA,J.extRenderToTextureHalfFloat?Me.HALF_FLOAT:Me.UNSIGNED_BYTE,null),ge.colorAttachment.set(ce)}(I,0,X,K,q,Z)}else V.bindTexture(V.TEXTURE_2D,K.colorAttachment.get()),I.bindFramebuffer.set(K.framebuffer)})(u,r,o,r.transform.projection.name==="globe"?.5:.25),u.clear({color:En.transparent});const v=r.transform,x=v.projection.name==="globe",w=x?["PROJECTION_GLOBE_VIEW"]:[],E=x?mi.frontCCW:mi.disabled,C=[xo(v.center.lng),Io(v.center.lat)];for(let I=0;I<c.length;I++){const D=c[I];if(t.hasRenderableParent(D))continue;const N=t.getTile(D),W=N.getBucket(o);if(!W||W.projection.name!==v.projection.name)continue;const V=r.isTileAffectedByFog(D),q=W.programConfigurations.get(o.id),Z=r.getOrCreateProgram("heatmap",{config:q,defines:w,overrideFog:V}),{zoom:K}=r.transform;r.terrain&&r.terrain.setupElevationDraw(N,Z),r.uploadCommonUniforms(u,Z,D.toUnwrapped());const X=v.projection.createInversionMatrix(v,D.canonical);Z.draw(r,h.TRIANGLES,Fn.disabled,m,g,E,xae(r,D,N,X,C,K,o.paint.get("heatmap-intensity")),o.id,W.layoutVertexBuffer,W.indexBuffer,W.segments,o.paint,r.transform.zoom,q,x?[W.globeExtVertexBuffer]:null)}u.viewport.set([0,0,r.width,r.height])}else r.renderPass==="translucent"&&(r.context.setColorMode(r.colorModeForRenderPass()),function(u,h){const m=u.context,g=m.gl,v=h.heatmapFbo;if(!v)return;m.activeTexture.set(g.TEXTURE0),g.bindTexture(g.TEXTURE_2D,v.colorAttachment.get()),m.activeTexture.set(g.TEXTURE1);let x=h.colorRampTexture;x||(x=h.colorRampTexture=new xa(m,h.colorRamp,g.RGBA)),x.bind(g.LINEAR,g.CLAMP_TO_EDGE),u.getOrCreateProgram("heatmapTexture").draw(u,g.TRIANGLES,Fn.disabled,hi.disabled,u.colorModeForRenderPass(),mi.disabled,((w,E,C,I)=>({u_image:0,u_color_ramp:1,u_opacity:E.paint.get("heatmap-opacity")}))(0,h),h.id,u.viewportBuffer,u.quadTriangleIndexBuffer,u.viewportSegments,h.paint,u.transform.zoom)}(r,o))},line:function(r,t,o,c){if(r.renderPass!=="translucent")return;const u=o.paint.get("line-opacity"),h=o.paint.get("line-width");if(u.constantOr(1)===0||h.constantOr(1)===0)return;const m=o.paint.get("line-emissive-strength"),g=r.depthModeForSublayer(0,Fn.ReadOnly),v=r.colorModeForDrapableLayerRenderPass(m),x=r.terrain&&r.terrain.renderingToTexture?1:Pn.devicePixelRatio,w=o.paint.get("line-dasharray"),E=w.constantOr(1),C=o.layout.get("line-cap"),I=o.paint.get("line-pattern"),D=I.constantOr(1),N=o.paint.get("line-pattern").constantOr(1),W=o.paint.get("line-opacity").constantOr(1)!==1;let V=!N&&W;const q=o.paint.get("line-gradient"),Z=D?"linePattern":"line",K=r.context,X=K.gl,J=U6(o);r.terrain&&r.terrain.clipOrMaskOverlapStencilType()&&(V=!1);for(const ae of c){const ce=t.getTile(ae);if(D&&!ce.patternsLoaded())continue;const ge=ce.getBucket(o);if(!ge)continue;r.prepareDrawTile();const ve=ge.programConfigurations.get(o.id),Pe=r.isTileAffectedByFog(ae),Me=r.getOrCreateProgram(Z,{config:ve,defines:J,overrideFog:Pe}),Le=I.constantOr(null);if(Le&&ce.imageAtlas){const yt=ce.imageAtlas.patternPositions[Le.toString()];yt&&ve.setConstantPatternPositions(yt)}const Ee=w.constantOr(null),He=C.constantOr(null);if(!D&&Ee&&He&&ce.lineAtlas){const yt=ce.lineAtlas.getDash(Ee,He);yt&&ve.setConstantPatternPositions(yt)}let[Ke,nt]=o.paint.get("line-trim-offset");(He==="round"||He==="square")&&Ke!==nt&&(Ke===0&&(Ke-=1),nt===1&&(nt+=1));const Ve=r.terrain?ae.projMatrix:null,je=D?Zie(r,ce,o,Ve,x):Xie(r,ce,o,Ve,ge.lineClipsArray.length,x,[Ke,nt]);if(q){const yt=ge.gradients[o.id];let ft=yt.texture;if(o.gradientVersion!==yt.version){let Lt=256;if(o.stepInterpolant){const Ft=t.getSource().maxzoom,St=ae.canonical.z===Ft?Math.ceil(1<<r.transform.maxZoom-ae.canonical.z):1;Lt=re(Et(ge.maxLineLength/mt*1024*St),256,K.maxTextureSize)}yt.gradient=XS({expression:o.gradientExpression(),evaluationKey:"lineProgress",resolution:Lt,image:yt.gradient||void 0,clips:ge.lineClipsArray}),yt.texture?yt.texture.update(yt.gradient):yt.texture=new xa(K,yt.gradient,X.RGBA),yt.version=o.gradientVersion,ft=yt.texture}K.activeTexture.set(X.TEXTURE1),ft.bind(o.stepInterpolant?X.NEAREST:X.LINEAR,X.CLAMP_TO_EDGE)}E&&(K.activeTexture.set(X.TEXTURE0),ce.lineAtlasTexture.bind(X.LINEAR,X.REPEAT),ve.updatePaintBuffers()),D&&(K.activeTexture.set(X.TEXTURE0),ce.imageAtlasTexture.bind(X.LINEAR,X.CLAMP_TO_EDGE),ve.updatePaintBuffers()),r.uploadCommonUniforms(K,Me,ae.toUnwrapped());const ot=yt=>{Me.draw(r,X.TRIANGLES,g,yt,v,mi.disabled,je,o.id,ge.layoutVertexBuffer,ge.indexBuffer,ge.segments,o.paint,r.transform.zoom,ve,[ge.layoutVertexBuffer2])};if(V){const yt=r.stencilModeForClipping(ae).ref;yt===0&&r.terrain&&K.clear({stencil:0});const ft={func:X.EQUAL,mask:255};je.u_alpha_discard_threshold=.8,ot(new hi(ft,yt,255,X.KEEP,X.KEEP,X.INVERT)),je.u_alpha_discard_threshold=0,ot(new hi(ft,yt,255,X.KEEP,X.KEEP,X.KEEP))}else ot(r.stencilModeForClipping(ae))}V&&(r.resetStencilClippingMasks(),r.terrain&&K.clear({stencil:0}))},fill:function(r,t,o,c){const u=o.paint.get("fill-color"),h=o.paint.get("fill-opacity");if(h.constantOr(1)===0)return;const m=o.paint.get("fill-emissive-strength"),g=r.colorModeForDrapableLayerRenderPass(m),v=o.paint.get("fill-pattern"),x=r.opaquePassEnabledForLayer()&&!v.constantOr(1)&&u.constantOr(En.transparent).a===1&&h.constantOr(0)===1?"opaque":"translucent";if(r.renderPass===x){const w=r.depthModeForSublayer(1,r.renderPass==="opaque"?Fn.ReadWrite:Fn.ReadOnly);u8(r,t,o,c,w,g,!1)}if(r.renderPass==="translucent"&&o.paint.get("fill-antialias")){const w=r.depthModeForSublayer(o.getPaintProperty("fill-outline-color")?2:0,Fn.ReadOnly);u8(r,t,o,c,w,g,!0)}},"fill-extrusion":function(r,t,o,c){const u=o.paint.get("fill-extrusion-opacity"),h=r.context,m=h.gl,g=r.terrain,v=g&&g.renderingToTexture,x=o.paint.get("fill-extrusion-cutoff-fade-range");if(u===0)return;const w=r.conflationActive&&r.layerUsedInConflation(o,t.getSource());if(w&&function(E,C,I,D){for(const N of D){const W=C.getTile(N).getBucket(I);W&&(W.updateReplacement(N,E.replacementSource),W.uploadCentroid(E.context))}}(r,t,o,c),g||w)for(const E of c){const C=t.getTile(E).getBucket(o);C&&Iae(r.context,t,E,C,o,g,w)}if(r.renderPass==="shadow"&&r.shadowRenderer){const E=r.shadowRenderer;if(g&&u<.65&&o._transitionablePaint._values["fill-extrusion-opacity"].value.expression instanceof jc)return;const C=E.getShadowPassDepthMode(),I=E.getShadowPassColorMode();q2(r,t,o,c,C,hi.disabled,I,w)}else if(r.renderPass==="translucent"){const E=!o.paint.get("fill-extrusion-pattern").constantOr(1);if(!v){const C=new Fn(r.context.gl.LEQUAL,Fn.ReadWrite,r.depthRangeFor3D);x===0&&u===1&&E?q2(r,t,o,c,C,hi.disabled,Ri.unblended,w):(q2(r,t,o,c,C,hi.disabled,Ri.disabled,w),q2(r,t,o,c,C,r.stencilModeFor3D(),r.colorModeForRenderPass(),w),r.resetStencilClippingMasks())}if(r.style.enable3dLights()&&E&&(!g&&r.transform.projection.name!=="globe"||v)){const C=o.paint.get("fill-extrusion-opacity"),I=o.paint.get("fill-extrusion-ambient-occlusion-intensity"),D=o.paint.get("fill-extrusion-ambient-occlusion-ground-radius"),N=o.paint.get("fill-extrusion-flood-light-intensity"),W=o.paint.get("fill-extrusion-flood-light-color").toArray01().slice(0,3),V=I>0&&D>0,q=N>0,Z=(X,J,ae)=>(1-ae)*X+ae*J,K=X=>{const J=r.depthModeForSublayer(1,Fn.ReadOnly,m.LEQUAL,!0),ae=o.paint.get(X?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),ce=Z(.1,3,ae),ge=r._showOverdrawInspector;if(!ge){const ve=new hi({func:m.ALWAYS,mask:255},255,255,m.KEEP,m.KEEP,m.REPLACE),Pe=new Ri([m.ONE,m.ONE,m.ONE,m.ONE],En.transparent,[!1,!1,!1,!0],m.MIN);kv(r,t,o,c,J,ve,Pe,mi.disabled,X,"sdf",C,I,D,N,W,ce,w,!1)}{const ve=ge?hi.disabled:new hi({func:m.EQUAL,mask:255},255,255,m.KEEP,m.DECR,m.DECR),Pe=ge?r.colorModeForRenderPass():new Ri([m.ONE_MINUS_DST_ALPHA,m.DST_ALPHA,m.ONE,m.ONE],En.transparent,[!0,!0,!0,!0]);kv(r,t,o,c,J,ve,Pe,mi.disabled,X,"color",C,I,D,N,W,ce,w,!1)}};if(v){const X=(J,ae,ce)=>{const ge=r.depthModeForSublayer(1,Fn.ReadOnly,m.LEQUAL,!1),ve=o.paint.get(J?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),Pe=Z(.1,3,ve);{const Me=new Ri([m.ONE,m.ONE,m.ONE,m.ONE],En.transparent,[!1,!1,!1,!0]);kv(r,t,o,c,ge,hi.disabled,Me,mi.disabled,J,"clear",C,I,D,N,W,Pe,w,ae)}{const Me=new hi({func:m.ALWAYS,mask:255},255,255,m.KEEP,m.KEEP,m.REPLACE),Le=new Ri([m.ONE,m.ONE,m.ONE,m.ONE],En.transparent,[!1,!1,!1,!0],m.MIN);kv(r,t,o,c,ge,Me,Le,mi.disabled,J,"sdf",C,I,D,N,W,Pe,w,ae)}{const Me=J?m.ZERO:m.ONE_MINUS_DST_ALPHA,Le=new hi({func:m.EQUAL,mask:255},255,255,m.KEEP,m.DECR,m.DECR),Ee=new Ri([Me,m.DST_ALPHA,m.ONE_MINUS_DST_ALPHA,m.ZERO],En.transparent,[!0,!0,!0,!0]);kv(r,t,o,c,ge,Le,Ee,mi.disabled,J,"color",C,I,D,N,W,Pe,w,ae)}{const Me=new Ri([m.ONE,m.ONE,m.ONE,J?m.ZERO:m.ONE],En.transparent,[!1,!1,!1,!0],J?m.FUNC_ADD:m.MAX);kv(r,t,o,c,ge,hi.disabled,Me,mi.disabled,J,"clear",C,I,D,N,W,Pe,w,ae,ce)}};if(V||q){let J;if(r.prepareDrawTile(),g){const ae=g.drapeBufferSize[0],ce=g.drapeBufferSize[1];J=g.framebufferCopyTexture,J&&(!J||J.size[0]===ae&&J.size[1]===ce)||(J&&J.destroy(),J=g.framebufferCopyTexture=new xa(h,new Jr({width:ae,height:ce}),m.RGBA)),J.bind(m.LINEAR,m.CLAMP_TO_EDGE),m.copyTexImage2D(m.TEXTURE_2D,0,m.RGBA,0,0,ae,ce,0)}V&&X(!0,!1,J),q&&X(!1,!0,J)}}else V&&K(!0),q&&K(!1)}}},hillshade:function(r,t,o,c){if(r.renderPass!=="offscreen"&&r.renderPass!=="translucent")return;const u=r.context,h=r.terrain&&r.terrain.renderingToTexture,[m,g]=r.renderPass!=="translucent"||h?[{},c]:r.stencilConfigForOverlap(c);for(const v of g){const x=t.getTile(v);if(x.needsHillshadePrepare&&r.renderPass==="offscreen")aae(r,x,o);else if(r.renderPass==="translucent"){const w=r.depthModeForSublayer(0,Fn.ReadOnly),E=o.paint.get("hillshade-emissive-strength"),C=r.colorModeForDrapableLayerRenderPass(E),I=h&&r.terrain?r.terrain.stencilModeForRTTOverlap(v):m[v.overscaledZ];rae(r,v,x,o,w,I,C)}}u.viewport.set([0,0,r.width,r.height]),r.resetStencilClippingMasks()},raster:function(r,t,o,c,u,h){if(r.renderPass!=="translucent"||o.paint.get("raster-opacity")===0)return;const m=r.context,g=m.gl,v=t.getSource(),x=function(Z,K,X){const J=[];let ae,ce;if(Z.paint.get("raster-color")){J.push("RASTER_COLOR"),ae=Z.paint.get("raster-color-mix"),ce=Z.paint.get("raster-color-range"),K.activeTexture.set(X.TEXTURE2);let ge=Z.colorRampTexture;ge||(ge=Z.colorRampTexture=new xa(K,Z.colorRamp,X.RGBA)),ge.bind(X.LINEAR,X.CLAMP_TO_EDGE)}return{mix:ae,range:ce,defines:J}}(o,m,g),w=x.defines;let E=!1;if(v instanceof td&&!c.length){if(r.transform.projection.name!=="globe")return;if(v.onNorthPole)E=!0,w.push("PROJECTION_GLOBE_VIEW");else{if(!v.onSouthPole)return;E=!0,w.push("PROJECTION_GLOBE_VIEW")}}const C=r.colorModeForDrapableLayerRenderPass(),I=r.terrain&&r.terrain.renderingToTexture,D=!r.options.moving,N=o.paint.get("raster-resampling")==="nearest"?g.NEAREST:g.LINEAR;if(E){const Z=t.getSource();if(!(Z instanceof td))return;const K=Z.texture;if(!K)return;const X=r.globeSharedBuffers;if(!X)return;const J=new Fn(g.LEQUAL,Fn.ReadWrite,r.depthRangeFor3D),ae=Float32Array.from(r.transform.projMatrix);let ce=gF(0,0,r.transform);const ge=Float32Array.from(Pm(bc(new Xu(0,0,0)))),ve={opacity:1,mix:0};r.terrain&&r.terrain.prepareDrawTile(),m.activeTexture.set(g.TEXTURE0),K.bind(N,g.CLAMP_TO_EDGE),m.activeTexture.set(g.TEXTURE1),K.bind(N,g.CLAMP_TO_EDGE),K.useMipmap&&m.extTextureFilterAnisotropic&&r.transform.pitch>20&&g.texParameterf(g.TEXTURE_2D,m.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,m.extTextureFilterAnisotropicMax);const[Pe,Me,Le,Ee]=X.getPoleBuffers(0,!0);let He;Z.onNorthPole?(He=Pe,r.renderDefaultNorthPole=!1):(ce=at.scale(at.create(),ce,[1,-1,1]),He=Me,r.renderDefaultSouthPole=!1);const Ke=t8(ae,ge,ce,[0,0],1,ve,o,Z.perspectiveTransform||[0,0],2,x.mix||[0,0,0,0],x.range||[0,0]),nt=r.getOrCreateProgram("raster",{defines:x.defines});return r.uploadCommonUniforms(m,nt,null),void nt.draw(r,g.TRIANGLES,J,hi.disabled,C,mi.disabled,Ke,o.id,He,Le,Ee)}if(!c.length)return;const[W,V]=v instanceof td||I?[{},c]:r.stencilConfigForOverlap(c),q=V[V.length-1].overscaledZ;for(const Z of V){const K=I?Fn.disabled:r.depthModeForSublayer(Z.overscaledZ-q,o.paint.get("raster-opacity")===1?Fn.ReadWrite:Fn.ReadOnly,g.LESS),X=Z.toUnwrapped(),J=t.getTile(Z);if(I&&(!J||!J.hasData())||!J.texture)continue;const ae=I?Z.projMatrix:r.transform.calculateProjMatrix(X,D),ce=r.terrain&&I?r.terrain.stencilModeForRTTOverlap(Z):W[Z.overscaledZ],ge=h?0:o.paint.get("raster-fade-duration");J.registerFadeDuration(ge);const ve=t.findLoadedParent(Z,0),Pe=YU(J,ve,t,r.transform,ge);let Me,Le;r.terrain&&r.terrain.prepareDrawTile(),m.activeTexture.set(g.TEXTURE0),J.texture.bind(N,g.CLAMP_TO_EDGE),m.activeTexture.set(g.TEXTURE1),ve?(ve.texture.bind(N,g.CLAMP_TO_EDGE),Me=Math.pow(2,ve.tileID.overscaledZ-J.tileID.overscaledZ),Le=[J.tileID.canonical.x*Me%1,J.tileID.canonical.y*Me%1]):J.texture.bind(N,g.CLAMP_TO_EDGE),J.texture.useMipmap&&m.extTextureFilterAnisotropic&&r.transform.pitch>20&&g.texParameterf(g.TEXTURE_2D,m.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,m.extTextureFilterAnisotropicMax);const Ee=v instanceof td?v.perspectiveTransform:[0,0],He=new Float32Array(16),Ke=t8(ae,He,He,Le||[0,0],Me||1,Pe,o,Ee,2,x.mix||[0,0,0,0],x.range||[0,0]),nt=r.isTileAffectedByFog(Z),Ve=r.getOrCreateProgram("raster",{defines:x.defines,overrideFog:nt});if(r.uploadCommonUniforms(m,Ve,X),v instanceof td)v.boundsBuffer&&v.boundsSegments&&Ve.draw(r,g.TRIANGLES,K,hi.disabled,C,mi.disabled,Ke,o.id,v.boundsBuffer,r.quadTriangleIndexBuffer,v.boundsSegments);else{const{tileBoundsBuffer:je,tileBoundsIndexBuffer:ot,tileBoundsSegments:yt}=r.getTileBoundsBuffers(J);Ve.draw(r,g.TRIANGLES,K,ce,C,mi.disabled,Ke,o.id,je,ot,yt)}}r.resetStencilClippingMasks()},background:function(r,t,o,c){const u=o.paint.get("background-color"),h=o.paint.get("background-opacity"),m=o.paint.get("background-emissive-strength");if(h===0)return;const g=r.context,v=g.gl,x=r.transform,w=x.tileSize,E=o.paint.get("background-pattern");if(r.isPatternMissing(E,o.scope))return;const C=!E&&u.a===1&&h===1&&r.opaquePassEnabledForLayer()?"opaque":"translucent";if(r.renderPass!==C)return;const I=hi.disabled,D=r.depthModeForSublayer(0,C==="opaque"?Fn.ReadWrite:Fn.ReadOnly),N=r.colorModeForDrapableLayerRenderPass(m),W=E?"backgroundPattern":"background";let V,q=c;q||(V=r.getBackgroundTiles(),q=Object.values(V).map(Z=>Z.tileID)),E&&(g.activeTexture.set(v.TEXTURE0),r.imageManager.bind(r.context,o.scope));for(const Z of q){const K=r.isTileAffectedByFog(Z),X=r.getOrCreateProgram(W,{overrideFog:K}),J=Z.toUnwrapped(),ae=c?Z.projMatrix:r.transform.calculateProjMatrix(J);r.prepareDrawTile();const ce=t?t.getTile(Z):V?V[Z.key]:new k1(Z,w,x.zoom,r),ge=E?Mae(ae,m,h,r,E,o.scope,{tileID:Z,tileSize:w}):Eae(ae,m,h,u);r.uploadCommonUniforms(g,X,J);const{tileBoundsBuffer:ve,tileBoundsIndexBuffer:Pe,tileBoundsSegments:Me}=r.getTileBoundsBuffers(ce);X.draw(r,v.TRIANGLES,D,I,N,mi.disabled,ge,o.id,ve,Pe,Me)}},sky:function(r,t,o){const c=r._atmosphere?_o(r.transform.zoom):1,u=o.paint.get("sky-opacity")*c;if(u===0)return;const h=r.context,m=o.paint.get("sky-type"),g=new Fn(h.gl.LEQUAL,Fn.ReadOnly,[0,1]),v=r.frameCounter/1e3%1;m==="atmosphere"?r.renderPass==="offscreen"?o.needsSkyboxCapture(r)&&(function(x,w,E,C){const I=x.context,D=I.gl;let N=w.skyboxFbo;if(!N){N=w.skyboxFbo=I.createFramebuffer(32,32,!0,null),w.skyboxGeometry=new f8(I),w.skyboxTexture=I.gl.createTexture(),D.bindTexture(D.TEXTURE_CUBE_MAP,w.skyboxTexture),D.texParameteri(D.TEXTURE_CUBE_MAP,D.TEXTURE_WRAP_S,D.CLAMP_TO_EDGE),D.texParameteri(D.TEXTURE_CUBE_MAP,D.TEXTURE_WRAP_T,D.CLAMP_TO_EDGE),D.texParameteri(D.TEXTURE_CUBE_MAP,D.TEXTURE_MIN_FILTER,D.LINEAR),D.texParameteri(D.TEXTURE_CUBE_MAP,D.TEXTURE_MAG_FILTER,D.LINEAR);for(let Z=0;Z<6;++Z)D.texImage2D(D.TEXTURE_CUBE_MAP_POSITIVE_X+Z,0,D.RGBA,32,32,0,D.RGBA,D.UNSIGNED_BYTE,null)}I.bindFramebuffer.set(N.framebuffer),I.viewport.set([0,0,32,32]);const W=w.getCenter(x,!0),V=x.getOrCreateProgram("skyboxCapture"),q=new Float64Array(16);at.identity(q),at.rotateY(q,q,.5*-Math.PI),Dv(x,w,V,q,W,0),at.identity(q),at.rotateY(q,q,.5*Math.PI),Dv(x,w,V,q,W,1),at.identity(q),at.rotateX(q,q,.5*-Math.PI),Dv(x,w,V,q,W,2),at.identity(q),at.rotateX(q,q,.5*Math.PI),Dv(x,w,V,q,W,3),at.identity(q),Dv(x,w,V,q,W,4),at.identity(q),at.rotateY(q,q,Math.PI),Dv(x,w,V,q,W,5),I.viewport.set([0,0,x.width,x.height])}(r,o),o.markSkyboxValid(r)):r.renderPass==="sky"&&function(x,w,E,C,I){const D=x.context,N=D.gl,W=x.transform,V=x.getOrCreateProgram("skybox");D.activeTexture.set(N.TEXTURE0),N.bindTexture(N.TEXTURE_CUBE_MAP,w.skyboxTexture);const q=((Z,K,X,J,ae)=>({u_matrix:Z,u_sun_direction:K,u_cubemap:0,u_opacity:J,u_temporal_offset:ae}))(W.skyboxMatrix,w.getCenter(x,!1),0,C,I);x.uploadCommonUniforms(D,V),V.draw(x,N.TRIANGLES,E,hi.disabled,x.colorModeForRenderPass(),mi.backCW,q,"skybox",w.skyboxGeometry.vertexBuffer,w.skyboxGeometry.indexBuffer,w.skyboxGeometry.segment)}(r,o,g,u,v):m==="gradient"&&r.renderPass==="sky"&&function(x,w,E,C,I){const D=x.context,N=D.gl,W=x.transform,V=x.getOrCreateProgram("skyboxGradient");w.skyboxGeometry||(w.skyboxGeometry=new f8(D)),D.activeTexture.set(N.TEXTURE0);let q=w.colorRampTexture;q||(q=w.colorRampTexture=new xa(D,w.colorRamp,N.RGBA)),q.bind(N.LINEAR,N.CLAMP_TO_EDGE);const Z=((K,X,J,ae,ce)=>({u_matrix:K,u_color_ramp:0,u_center_direction:X,u_radius:ye(J),u_opacity:ae,u_temporal_offset:ce}))(W.skyboxMatrix,w.getCenter(x,!1),w.paint.get("sky-gradient-radius"),C,I);x.uploadCommonUniforms(D,V),V.draw(x,N.TRIANGLES,E,hi.disabled,x.colorModeForRenderPass(),mi.backCW,Z,"skyboxGradient",w.skyboxGeometry.vertexBuffer,w.skyboxGeometry.indexBuffer,w.skyboxGeometry.segment)}(r,o,g,u,v)},debug:function(r,t,o){for(let c=0;c<o.length;c++)Uae(r,t,o[c])},custom:function(r,t,o,c){const u=r.context,h=o.implementation;if(!r.transform.projection.unsupportedLayers||!r.transform.projection.unsupportedLayers.includes("custom")||r.terrain&&(r.terrain.renderingToTexture||r.renderPass==="offscreen")&&o.isLayerDraped(t)){if(r.renderPass==="offscreen"){const m=h.prerender;if(m){if(r.setCustomLayerDefaults(),u.setColorMode(r.colorModeForRenderPass()),r.transform.projection.name==="globe"){const g=r.transform.pointMerc;m.call(h,u.gl,r.transform.customLayerMatrix(),r.transform.getProjection(),r.transform.globeToMercatorMatrix(),_o(r.transform.zoom),[g.x,g.y],r.transform.pixelsPerMeterRatio)}else m.call(h,u.gl,r.transform.customLayerMatrix());u.setDirty(),r.setBaseState()}}else if(r.renderPass==="translucent"){if(r.terrain&&r.terrain.renderingToTexture){const g=h.renderToTile;if(g){const v=c[0].canonical,x=new bi(v.x+c[0].wrap*(1<<v.z),v.y,v.z);u.setDepthMode(Fn.disabled),u.setStencilMode(hi.disabled),u.setColorMode(r.colorModeForRenderPass()),r.setCustomLayerDefaults(),g.call(h,u.gl,x),u.setDirty(),r.setBaseState()}return}r.setCustomLayerDefaults(),u.setColorMode(r.colorModeForRenderPass()),u.setStencilMode(hi.disabled);const m=h.renderingMode==="3d"?new Fn(r.context.gl.LEQUAL,Fn.ReadWrite,r.depthRangeFor3D):r.depthModeForSublayer(0,Fn.ReadOnly);if(u.setDepthMode(m),r.transform.projection.name==="globe"){const g=r.transform.pointMerc;h.render(u.gl,r.transform.customLayerMatrix(),r.transform.getProjection(),r.transform.globeToMercatorMatrix(),_o(r.transform.zoom),[g.x,g.y],r.transform.pixelsPerMeterRatio)}else h.render(u.gl,r.transform.customLayerMatrix());u.setDirty(),r.setBaseState(),u.bindFramebuffer.set(null)}}else xe("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")},model:function(r,t,o,c){if(r.renderPass==="opaque")return;const u=o.paint.get("model-opacity");if(u===0)return;const h=o.paint.get("model-cast-shadows");if(r.renderPass==="shadow"&&(!h||r.terrain&&u<.65&&o._transitionablePaint._values["model-opacity"].value.expression instanceof jc))return;const m=r.shadowRenderer,g=o.paint.get("model-receive-shadows");m&&(m.useNormalOffset=!0,g||(m.enabled=!1));const v=()=>{m&&(m.useNormalOffset=!0,g||(m.enabled=!0))},x=t.getSource();if(r.renderPass==="light-beam"&&x.type!=="batched-model")return;if(x.type==="vector"||x.type==="geojson")return function(V,q,Z,K){const X=V.transform;if(X.projection.name!=="mercator")return void xe(`Drawing 3D models for ${X.projection.name} projection is not yet implemented`);const J=X.getFreeCameraOptions().position;if(!V.modelManager)return;const ae=V.modelManager,ce=V.shadowRenderer;if(!Z._unevaluatedLayout._values.hasOwnProperty("model-id"))return;const ge=Z._unevaluatedLayout._values["model-id"],ve={...Z.layout.get("model-id").parameters};for(const Pe of K){const Me=q.getTile(Pe).getBucket(Z);if(!Me||Me.projection.name!==X.projection.name)continue;const Le=qae(Pe,X);ve.zoom=Le;const Ee=ge.possiblyEvaluate(ve);if(Yae(V,Me,Pe),id.shadowUniformsInitialized=!1,id.useSingleShadowCascade=!!ce&&ce.getMaxCascadeForTile(Pe.toUnwrapped())===0,V.renderPass==="shadow"&&ce){if(V.currentShadowCascade===1&&Me.isInsideFirstShadowMapFrustum)continue;const nt=X.calculatePosMatrix(Pe.toUnwrapped(),X.worldSize);if(id.tileMatrix.set(nt),id.shadowTileMatrix=Float32Array.from(ce.calculateShadowPassMatrixFromMatrix(nt)),id.aabb.min.fill(0),id.aabb.max[0]=id.aabb.max[1]=mt,id.aabb.max[2]=0,Zae(Me,id,V,Z.scope))continue}const He=1<<Pe.canonical.z,Ke=[((J.x-Pe.wrap)*He-Pe.canonical.x)*mt,(J.y*He-Pe.canonical.y)*mt,J.z*He*mt];for(let nt in Me.instancesPerModel){const Ve=Me.instancesPerModel[nt];Ve.features.length>0&&(nt=Ee.evaluate(Ve.features[0].feature,{}));const je=ae.getModel(nt,Z.scope);if(je&&je.uploaded)for(const ot of je.nodes)g8(V,Z,ot,Ve,Ke,Pe,id)}}}(r,t,o,c),void v();if(!x.loaded())return;if(x.type==="batched-model")return function(V,q,Z,K){const X=V.context,J=V.transform,ae=V.style.fog,ce=V.shadowRenderer;if(J.projection.name!=="mercator")return void xe(`Drawing 3D landmark models for ${J.projection.name} projection is not yet implemented`);const ge=V.transform.getFreeCameraOptions().position,ve=De.scale([],[ge.x,ge.y,ge.z],V.transform.worldSize);De.negate(ve,ve);const Pe=at.identity([]),Me=Af(J.center.lat,J.zoom),Le=at.fromScaling([],[1,1,1/Me]);at.translate(Pe,Pe,ve);const Ee=Z.paint.get("model-opacity"),He=new Fn(X.gl.LEQUAL,Fn.ReadWrite,V.depthRangeFor3D),Ke=new Fn(X.gl.LEQUAL,Fn.ReadOnly,V.depthRangeFor3D),nt=function(Ve,je){for(const ot of K){const yt=q.getTile(ot).getBucket(Z);if(!yt||!yt.uploaded)continue;let ft=!1;ce&&(ft=ce.getMaxCascadeForTile(ot.toUnwrapped())===0);const Lt=J.calculatePosMatrix(ot.toUnwrapped(),J.worldSize),Ft=yt.modelTraits;for(const St of yt.getNodesInfo()){if(St.hiddenByReplacement||!St.node.meshes)continue;const Ct=St.node,rn=V.renderPass==="light-beam",ln=[...Lt],sn=St.evaluatedScale;let un=0;V.terrain&&Ct.elevation&&(un=Ct.elevation*V.terrain.exaggeration()),at.translate(ln,ln,[(Ct.anchor?Ct.anchor[0]:0)*(sn[0]-1),(Ct.anchor?Ct.anchor[1]:0)*(sn[1]-1),un]),sn!==Pie&&at.scale(ln,ln,sn),at.multiply(ln,ln,Ct.matrix);const vn=at.multiply([],Le,ln);at.multiply(vn,Pe,vn);const zn=at.invert([],vn);at.transpose(zn,zn),at.scale(zn,zn,Xae);const ai=at.multiply([],J.projMatrix,ln);for(let Ai=0;Ai<Ct.meshes.length;++Ai){const Xn=Ct.meshes[Ai],Gn=Ai===Ct.lightMeshIndex;if(Gn){if(!rn&&!V.terrain&&V.shadowRenderer){V.currentLayer<V.firstLightBeamLayer&&(V.firstLightBeamLayer=V.currentLayer);continue}}else if(rn)continue;const Ln={defines:[]},An=[];zI(Ln.defines,An,Xn,V),4&Ft||Ln.defines.push("DIFFUSE_SHADED"),ft&&Ln.defines.push("SHADOWS_SINGLE_CASCADE");const vi=V.renderPass==="shadow";if(vi){OI(Xn,ln,V,Z);continue}let Li=null;if(ae){const or=p8(ln,V.transform);if(Li=new Float32Array(or),J.projection.name!=="globe"){const ca=Xn.aabb.min,Pr=Xn.aabb.max,[Wr,Qi]=ae.getOpacityForBounds(or,ca[0],ca[1],Pr[0],Pr[1]);Ln.overrideFog=Wr>=Om||Qi>=Om}}const ri=V.getOrCreateProgram("model",Ln);!vi&&ce&&(ce.useNormalOffset=!!Xn.normalBuffer,ce.setupShadowsFromMatrix(ln,ri,ce.useNormalOffset)),V.uploadCommonUniforms(X,ri,ot.toUnwrapped(),Li);const Ji=Xn.material,Cr=Ji.pbrMetallicRoughness;Cr.metallicFactor=.9,Cr.roughnessFactor=.5;const hr=kI(new Float32Array(ai),new Float32Array(vn),new Float32Array(zn),V,Ee,Cr.baseColorFactor,Ji.emissiveFactor,Cr.metallicFactor,Cr.roughnessFactor,Ji,Z);ri.draw(V,X.gl.TRIANGLES,je&&!Gn?He:Ke,hi.disabled,Ve?Gn||Ee<1||St.hasTranslucentParts?Ri.alphaBlended:Ri.unblended:Ri.disabled,mi.backCCW,hr,Z.id,Xn.vertexBuffer,Xn.indexBuffer,Xn.segments,Z.paint,V.transform.zoom,void 0,An)}}}};(function(Ve,je,ot,yt){const ft=Ve.terrain?Ve.terrain.exaggeration():0,Lt=Ve.transform.zoom;for(const Ft of yt){const St=je.getTile(Ft).getBucket(ot);St&&(Ve.conflationActive&&St.updateReplacement(Ft,Ve.replacementSource),St.evaluateScale(Ve,ot),Ve.terrain&&ft>0&&St.elevationUpdate(Ve.terrain,ft,Ft,ot.source),St.needsReEvaluation(Ve,Lt,ot)&&St.evaluate(ot))}})(V,q,Z,K),Ee===1?nt(!0,!0):(nt(!1,!0),nt(!0,!1))}(r,t,o,c),void v();const w=x.getModels(),E=[],C=r.transform.getFreeCameraOptions().position,I=De.scale([],[C.x,C.y,C.z],r.transform.worldSize);De.negate(I,I);const D=[],N=[];let W=0;for(const V of w){const q=o.paint.get("model-rotation").constantOr(null),Z=o.paint.get("model-scale").constantOr(null),K=o.paint.get("model-translation").constantOr(null);V.computeModelMatrix(r,q,Z,K,!0,!0,!1);const X=at.identity([]),J=Af(V.position.lat,r.transform.zoom),ae=at.fromScaling([],[1,1,1/J]);at.translate(X,X,I),E.push({zScaleMatrix:ae,negCameraPosMatrix:X});for(const ce of V.nodes)m8(r.transform,ce,V.matrix,r.transform.projMatrix,W,D,N);W++}if(D.sort((V,q)=>q.depth-V.depth),r.renderPass!=="shadow"){if(u===1)for(const V of N)Z2(V,r,o,E[V.modelIndex],hi.disabled,r.colorModeForRenderPass());else{for(const V of N)Z2(V,r,o,E[V.modelIndex],hi.disabled,Ri.disabled);for(const V of N)Z2(V,r,o,E[V.modelIndex],r.stencilModeFor3D(),r.colorModeForRenderPass());r.resetStencilClippingMasks()}for(const V of D)Z2(V,r,o,E[V.modelIndex],hi.disabled,r.colorModeForRenderPass());v()}else{for(const V of N)OI(V.mesh,V.nodeModelMatrix,r,o);for(const V of D)OI(V.mesh,V.nodeModelMatrix,r,o);v()}}},v8={modelUpload:function(r,t,o){const c=t.getSource();if(!c.loaded())return;if(c.type==="vector"||c.type==="geojson")return void(r.modelManager&&r.modelManager.upload(r,o));if(c.type==="batched-model")return;const u=c.getModels();for(const h of u)h.upload(r.context)}};class Qae{constructor(t,o){this.context=new vie(t),this.transform=o,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.setup(),this.numSublayers=tu.maxUnderzooming+tu.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={},this.conflationActive=!1,this.replacementSource=new zie,this.longestCutoffRange=0,this.minCutoffZoom=0,this._fogVisible=!1,this._cachedTileFogOpacities={},this._shadowRenderer=new noe(this),this._wireframeDebugCache=new Jae,this.renderDefaultNorthPole=!0,this.renderDefaultSouthPole=!0}updateTerrain(t,o){const c=!!t&&!!t.terrain&&this.transform.projection.supportsTerrain;if(!(c||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new cae(this,t));const u=this._terrain;this.transform.elevation=c?u:null,u.update(t,this.transform,o),this.transform.elevation&&!u.enabled&&(this.transform.elevation=null)}_updateFog(t){const o=t.fog;if(!o||this.transform.projection.name==="globe"||o.getOpacity(this.transform.pitch)<1||o.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[c,u]=o.getFovAdjustedRange(this.transform._fov);if(c>u)return void(this.transform.fogCullDistSq=null);const h=c+.78*(u-c);this.transform.fogCullDistSq=h*h}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled?this._terrain:null}get shadowRenderer(){return this._shadowRenderer&&this._shadowRenderer.enabled?this._shadowRenderer:null}get wireframeDebugCache(){return this._wireframeDebugCache}resize(t,o){if(this.width=t*Pn.devicePixelRatio,this.height=o*Pn.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const c of this.style.order)this.style._mergedLayers[c].resize()}setup(){const t=this.context,o=new ee;o.emplaceBack(0,0),o.emplaceBack(mt,0),o.emplaceBack(0,mt),o.emplaceBack(mt,mt),this.tileExtentBuffer=t.createVertexBuffer(o,Ef.members),this.tileExtentSegments=qi.simpleSegment(0,0,4,2);const c=new ee;c.emplaceBack(0,0),c.emplaceBack(mt,0),c.emplaceBack(0,mt),c.emplaceBack(mt,mt),this.debugBuffer=t.createVertexBuffer(c,Ef.members),this.debugSegments=qi.simpleSegment(0,0,4,5);const u=new ee;u.emplaceBack(-1,-1),u.emplaceBack(1,-1),u.emplaceBack(-1,1),u.emplaceBack(1,1),this.viewportBuffer=t.createVertexBuffer(u,Ef.members),this.viewportSegments=qi.simpleSegment(0,0,4,2);const h=new qe;h.emplaceBack(0,0,0,0),h.emplaceBack(mt,0,mt,0),h.emplaceBack(0,mt,0,mt),h.emplaceBack(mt,mt,mt,mt),this.mercatorBoundsBuffer=t.createVertexBuffer(h,ZP.members),this.mercatorBoundsSegments=qi.simpleSegment(0,0,4,2);const m=new Un;m.emplaceBack(0,1,2),m.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=t.createIndexBuffer(m);const g=new d1;for(const x of[0,1,3,2,0])g.emplaceBack(x);this.debugIndexBuffer=t.createIndexBuffer(g),this.emptyTexture=new xa(t,new Jr({width:1,height:1},Uint8Array.of(0,0,0,0)),t.gl.RGBA),this.identityMat=at.create();const v=this.context.gl;this.stencilClearMode=new hi({func:v.ALWAYS,mask:0},0,255,v.ZERO,v.ZERO,v.ZERO),this.loadTimeStamps.push(p.performance.now())}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(t){return t._makeTileBoundsBuffers(this.context,this.transform.projection),t._tileBoundsBuffer?{tileBoundsBuffer:t._tileBoundsBuffer,tileBoundsIndexBuffer:t._tileBoundsIndexBuffer,tileBoundsSegments:t._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const t=this.context.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.getOrCreateProgram("clippingMask").draw(this,t.TRIANGLES,Fn.disabled,this.stencilClearMode,Ri.disabled,mi.disabled,LI(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(t,o,c){if(!o||this.currentStencilSource===o.id||!t.isTileClipped()||!c||c.length===0)return;if(this._tileClippingMaskIDs&&!this.terrain){let g=!1;for(const v of c)if(this._tileClippingMaskIDs[v.key]===void 0){g=!0;break}if(!g)return}this.currentStencilSource=o.id;const u=this.context,h=u.gl;this.nextStencilID+c.length>256&&this.clearStencil(),u.setColorMode(Ri.disabled),u.setDepthMode(Fn.disabled);const m=this.getOrCreateProgram("clippingMask");this._tileClippingMaskIDs={};for(const g of c){const v=o.getTile(g),x=this._tileClippingMaskIDs[g.key]=this.nextStencilID++,{tileBoundsBuffer:w,tileBoundsIndexBuffer:E,tileBoundsSegments:C}=this.getTileBoundsBuffers(v);m.draw(this,h.TRIANGLES,Fn.disabled,new hi({func:h.ALWAYS,mask:0},x,255,h.KEEP,h.KEEP,h.REPLACE),Ri.disabled,mi.disabled,LI(g.projMatrix),"$clipping",w,E,C)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const t=this.nextStencilID++,o=this.context.gl;return new hi({func:o.NOTEQUAL,mask:255},t,255,o.KEEP,o.KEEP,o.REPLACE)}stencilModeForClipping(t){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(t);const o=this.context.gl;return new hi({func:o.EQUAL,mask:255},this._tileClippingMaskIDs[t.key],0,o.KEEP,o.KEEP,o.REPLACE)}stencilConfigForOverlap(t){const o=this.context.gl,c=t.sort((m,g)=>g.overscaledZ-m.overscaledZ),u=c[c.length-1].overscaledZ,h=c[0].overscaledZ-u+1;if(h>1){this.currentStencilSource=void 0,this.nextStencilID+h>256&&this.clearStencil();const m={};for(let g=0;g<h;g++)m[g+u]=new hi({func:o.GEQUAL,mask:255},g+this.nextStencilID,255,o.KEEP,o.KEEP,o.REPLACE);return this.nextStencilID+=h,[m,c]}return[{[u]:hi.disabled},c]}colorModeForRenderPass(){const t=this.context.gl;return this._showOverdrawInspector?new Ri([t.CONSTANT_COLOR,t.ONE,t.CONSTANT_COLOR,t.ONE],new En(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Ri.unblended:Ri.alphaBlended}colorModeForDrapableLayerRenderPass(t){const o=this.context.gl;return(()=>this.style&&this.style.enable3dLights()&&this.terrain&&this.terrain.renderingToTexture)()&&this.renderPass==="translucent"?new Ri([o.ONE,o.ONE_MINUS_SRC_ALPHA,o.CONSTANT_ALPHA,o.ONE_MINUS_SRC_ALPHA],new En(0,0,0,t===void 0?0:t),[!0,!0,!0,!0]):this.colorModeForRenderPass()}depthModeForSublayer(t,o,c,u=!1){if(!this.opaquePassEnabledForLayer()&&!u)return Fn.disabled;const h=1-((1+this.currentLayer)*this.numSublayers+t)*this.depthEpsilon;return new Fn(c||this.context.gl.LEQUAL,o,[h,h])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(t,o){this._wireframeDebugCache.update(this.frameCounter),this.style=t,this.options=o;const c=this.style._mergedLayers,u=this.style.order,h=u.map(X=>c[X]),m=this.style._mergedSourceCaches;this.imageManager=t.imageManager,this.modelManager=t.modelManager,this.symbolFadeChange=t.placement.symbolFadeChange(Pn.now()),this.imageManager.beginFrame();let g=0,v=!1;for(const X in m){const J=m[X];J.used&&(J.prepare(this.context),J.getSource().usedInConflation&&++g)}const x={},w={},E={},C={},I={};for(const X in m){const J=m[X];x[X]=J.getVisibleCoordinates(),w[X]=x[X].slice().reverse(),E[X]=J.getVisibleCoordinates(!0).reverse(),C[X]=J.getShadowCasterCoordinates(),I[X]=J.sortCoordinatesByDistance(x[X])}const D=X=>{const J=this.style.getLayerSourceCache(X);return J&&J.used?J.getSource():null};if(g){const X=[];for(const J of h)this.layerUsedInConflation(J,D(J))&&X.push(J);if(X&&X.length>1){const J=[];for(const ae of X){const ce=this.style.getLayerSourceCache(ae);ce&&ce.used&&ce.getSource().usedInConflation&&J.push({layer:ae.fqid,cache:ce})}this.replacementSource.setSources(J),v=!0}}v||this.replacementSource.clear(),this.conflationActive=v,this.minCutoffZoom=0,this.longestCutoffRange=0;for(const X of h){const J=X.cutoffRange();if(this.longestCutoffRange=Math.max(J,this.longestCutoffRange),J>0){const ae=D(X);ae&&(this.minCutoffZoom=Math.max(ae.minzoom,this.minCutoffZoom)),X.minzoom&&(this.minCutoffZoom=Math.max(X.minzoom,this.minCutoffZoom))}}this.opaquePassCutoff=1/0;for(let X=0;X<h.length;X++)if(h[X].is3D()){this.opaquePassCutoff=X;break}const N=this.style&&this.style.fog;N?(this._fogVisible=N.getOpacity(this.transform.pitch)!==0,this._fogVisible&&this.transform.projection.name!=="globe"&&(this._fogVisible=N.isVisibleOnFrustum(this.transform.cameraFrustum))):this._fogVisible=!1,this._cachedTileFogOpacities={},this.terrain&&(this.terrain.updateTileBinding(E),this.opaquePassCutoff=0);const W=this._shadowRenderer;if(W){W.updateShadowParameters(this.transform,this.style.directionalLight);for(const X in m)for(const J of x[X]){let ae={min:0,max:0};this.terrain&&(ae=this.terrain.getMinMaxForTile(J)||ae),W.addShadowReceiver(J.toUnwrapped(),ae.min,ae.max)}}this.transform.projection.name!=="globe"||this.globeSharedBuffers||(this.globeSharedBuffers=new Oee(this.context));for(const X of h){if(X.isHidden(this.transform.zoom))continue;const J=t.getLayerSourceCache(X);this.uploadLayer(this,X,J)}if(this.style.fog&&this.transform.projection.supportsFog?(this._atmosphere||(this._atmosphere=new $ae),this._atmosphere.update(this)):this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0),!cr.has(this.context.gl))return;this.renderPass="offscreen";for(const X of h){const J=t.getLayerSourceCache(X);if(!X.hasOffscreenPass()||X.isHidden(this.transform.zoom))continue;const ae=J?w[J.id]:void 0;(X.type==="custom"||X.type==="raster"||X.isSky()||ae&&ae.length)&&this.renderLayer(this,J,X,ae)}this.depthRangeFor3D=[0,1-(h.length+2)*this.numSublayers*this.depthEpsilon];const V=this.terrain;V&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&!this.transform.isOrthographic&&V.drawDepth(),this._shadowRenderer&&(this.renderPass="shadow",this._shadowRenderer.drawShadowPass(this.style,C)),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]);const q=this.transform.projection.name==="globe"||this.transform.isHorizonVisible(),Z=(()=>{if(o.showOverdrawInspector)return En.black;if(this.style.fog&&this.transform.projection.supportsFog&&!q){const X=this.style.fog.properties.get("color").toArray01();return new En(...X)}if(this.style.fog&&this.transform.projection.supportsFog&&q){const X=this.style.fog.properties.get("space-color").toArray01();return new En(...X)}return En.transparent})();if(this.context.clear({color:Z,depth:1}),this.clearStencil(),this._showOverdrawInspector=o.showOverdrawInspector,this.renderPass="opaque",this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&q&&this._atmosphere.drawStars(this,this.style.fog),!this.terrain)for(this.currentLayer=u.length-1;this.currentLayer>=0;this.currentLayer--){const X=h[this.currentLayer],J=t.getLayerSourceCache(X);if(X.isSky())continue;const ae=J?(X.is3D()?I:w)[J.id]:void 0;this._renderTileClippingMasks(X,J,ae),this.renderLayer(this,J,X,ae)}if(this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&q&&this._atmosphere.drawAtmosphereGlow(this,this.style.fog),this.renderPass="sky",(!this._atmosphere||_o(this.transform.zoom)>0)&&(this.transform.projection.name==="globe"||this.transform.isHorizonVisible()))for(this.currentLayer=0;this.currentLayer<u.length;this.currentLayer++){const X=h[this.currentLayer],J=t.getLayerSourceCache(X);X.isSky()&&this.renderLayer(this,J,X,J?w[J.id]:void 0)}this.renderPass="translucent",this.currentLayer=0,this.firstLightBeamLayer=Number.MAX_SAFE_INTEGER;let K=0;for(W&&(K=W.getShadowCastingLayerCount());this.currentLayer<u.length;){const X=h[this.currentLayer],J=t.getLayerSourceCache(X);if(X.isSky()){++this.currentLayer;continue}if(V&&this.style.isLayerDraped(X)){if(X.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=V.renderBatch(this.currentLayer);continue}let ae;if(J&&(ae=(X.type==="symbol"?E:X.is3D()?I:w)[J.id]),this._renderTileClippingMasks(X,J,J?x[J.id]:void 0),this.renderLayer(this,J,X,ae),!V&&W&&K>0&&X.hasShadowPass()&&--K==0&&(W.drawGroundShadows(),this.firstLightBeamLayer<=this.currentLayer)){const ce=this.currentLayer;for(this.renderPass="light-beam",this.currentLayer=this.firstLightBeamLayer;this.currentLayer<=ce;this.currentLayer++){const ge=h[this.currentLayer];if(!ge.hasLightBeamPass())continue;const ve=t.getLayerSourceCache(ge);this.renderLayer(this,ve,ge,ve?w[ve.id]:void 0)}this.currentLayer=ce,this.renderPass="translucent"}++this.currentLayer}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let X=null;h.forEach(J=>{const ae=t.getLayerSourceCache(J);ae&&!J.isHidden(this.transform.zoom)&&ae.getVisibleCoordinates().length&&(!X||X.getSource().maxzoom<ae.getSource().maxzoom)&&(X=ae)}),X&&this.options.showTileBoundaries&&y8.debug(this,X,X.getVisibleCoordinates())}this.options.showPadding&&function(X){const J=X.transform.padding;d8(X,X.transform.height-(J.top||0),3,zae),d8(X,J.bottom||0,3,Oae),h8(X,J.left||0,3,Nae),h8(X,X.transform.width-(J.right||0),3,Fae);const ae=X.transform.centerPoint;(function(ce,ge,ve,Pe){X2(ce,ge-1,ve-10,2,20,Pe),X2(ce,ge-10,ve-1,20,2,Pe)})(X,ae.x,X.transform.height-ae.y,Bae)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(p.performance.now()),this.saveCanvasCopy()),v||(this.conflationActive=!1)}uploadLayer(t,o,c){this.gpuTimingStart(o),(!t.transform.projection.unsupportedLayers||!t.transform.projection.unsupportedLayers.includes(o.type)||t.terrain&&o.type==="custom")&&v8[`${o.type}Upload`]&&v8[`${o.type}Upload`](t,c,o.scope),this.gpuTimingEnd()}renderLayer(t,o,c,u){c.isHidden(this.transform.zoom)||(c.type==="background"||c.type==="sky"||c.type==="custom"||c.type==="model"||c.type==="raster"||u&&u.length)&&(this.id=c.id,this.gpuTimingStart(c),(!t.transform.projection.unsupportedLayers||!t.transform.projection.unsupportedLayers.includes(c.type)||t.terrain&&c.type==="custom")&&y8[c.type](t,o,c,u,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(t){if(!this.options.gpuTiming)return;const o=this.context.extTimerQuery,c=this.context.gl;let u=this.gpuTimers[t.id];u||(u=this.gpuTimers[t.id]={calls:0,cpuTime:0,query:c.createQuery()}),u.calls++,c.beginQuery(o.TIME_ELAPSED_EXT,u.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const t=this.context.extTimerQuery,o=this.context.gl,c=o.createQuery();this.deferredRenderGpuTimeQueries.push(c),o.beginQuery(t.TIME_ELAPSED_EXT,c)}}gpuTimingDeferredRenderEnd(){this.options.gpuTimingDeferredRender&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}gpuTimingEnd(){this.options.gpuTiming&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}collectGpuTimers(){const t=this.gpuTimers;return this.gpuTimers={},t}collectDeferredRenderGpuQueries(){const t=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],t}queryGpuTimers(t){const o={};for(const c in t){const u=t[c],h=this.context.extTimerQuery,m=h.getQueryParameter(u.query,this.context.gl.QUERY_RESULT)/1e6;h.deleteQueryEXT(u.query),o[c]=m}return o}queryGpuTimeDeferredRender(t){if(!this.options.gpuTimingDeferredRender)return 0;const o=this.context.extTimerQuery,c=this.context.gl;let u=0;for(const h of t)u+=o.getQueryParameter(h,c.QUERY_RESULT)/1e6,o.deleteQueryEXT(h);return u}translatePosMatrix(t,o,c,u,h){if(!c[0]&&!c[1])return t;const m=h?u==="map"?this.transform.angle:0:u==="viewport"?-this.transform.angle:0;if(m){const x=Math.sin(m),w=Math.cos(m);c=[c[0]*w-c[1]*x,c[0]*x+c[1]*w]}const g=[h?c[0]:km(o,c[0],this.transform.zoom),h?c[1]:km(o,c[1],this.transform.zoom),0],v=new Float32Array(16);return at.translate(v,t,g),v}saveTileTexture(t){const o=this._tileTextures[t.size[0]];o?o.push(t):this._tileTextures[t.size[0]]=[t]}getTileTexture(t){const o=this._tileTextures[t];return o&&o.length>0?o.pop():null}isPatternMissing(t,o){return t===null||t!==void 0&&!this.imageManager.getPattern(t.toString(),o)}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture}terrainUseFloatDEM(){return this.context.extTextureFloatLinear!=null}currentGlobalDefines(t,o,c){const u=c===void 0?this.terrain&&this.terrain.renderingToTexture:c,h=this.terrain&&this.terrain.exaggeration()===0,m=[];return this.style&&this.style.enable3dLights()&&(t==="globeRaster"||t==="terrainRaster"?(m.push("LIGHTING_3D_MODE"),m.push("LIGHTING_3D_ALPHA_EMISSIVENESS")):u||m.push("LIGHTING_3D_MODE")),this.renderPass==="shadow"?this._shadowMapDebug||m.push("DEPTH_TEXTURE"):this.shadowRenderer&&(this.shadowRenderer.useNormalOffset?m.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET"):m.push("RENDER_SHADOWS","DEPTH_TEXTURE")),this.terrainRenderModeElevated()&&(m.push("TERRAIN"),this.terrainUseFloatDEM()&&m.push("TERRAIN_DEM_FLOAT_FORMAT"),h&&m.push("ZERO_EXAGGERATION")),this.transform.projection.name==="globe"&&m.push("GLOBE"),!this._fogVisible||u||o!==void 0&&!o||m.push("FOG","FOG_DITHERING"),u&&m.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&m.push("OVERDRAW_INSPECTOR"),m}getOrCreateProgram(t,o){this.cache=this.cache||{};const c=o&&o.defines||[],u=o&&o.config,h=this.currentGlobalDefines(t,o&&o.overrideFog,o&&o.overrideRtt).concat(c),m=XU.cacheKey(BU[t],t,h,u);return this.cache[m]||(this.cache[m]=new XU(this.context,t,BU[t],u,Tae[t],h)),this.cache[m]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const t=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(t.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=p.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new xa(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this._wireframeDebugCache.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}uploadCommonLightUniforms(t,o){if(this.style.enable3dLights()){const c=this.style.directionalLight,u=this.style.ambientLight;if(c&&u){const h=((m,g)=>{const v=m.properties.get("direction"),x=m.properties.get("color").toArray01(),w=m.properties.get("intensity"),E=g.properties.get("color").toArray01(),C=g.properties.get("intensity"),I=[v.x,v.y,v.z],D=Wt(E,C),N=Wt(x,w);return{u_lighting_ambient_color:D,u_lighting_directional_dir:I,u_lighting_directional_color:N,u_ground_radiance:uae(I,N,D)}})(c,u);o.setLightsUniformValues(t,h)}}}uploadCommonUniforms(t,o,c,u,h){if(this.uploadCommonLightUniforms(t,o),this.terrain&&this.terrain.renderingToTexture)return;const m=this.style.fog;if(m){const g=m.getOpacity(this.transform.pitch),v=((x,w,E,C,I,D,N,W,V,q,Z,K)=>{const X=x.transform,J=w.properties.get("color").toArray01();J[3]=C;const ae=x.frameCounter/1e3%1,[ce,ge]=w.properties.get("vertical-range");return{u_fog_matrix:E?X.calculateFogTileMatrix(E):K||x.identityMat,u_fog_range:w.getFovAdjustedRange(X._fov),u_fog_color:J,u_fog_horizon_blend:w.properties.get("horizon-blend"),u_fog_vertical_limit:[Math.min(ce,ge),ge],u_fog_temporal_offset:ae,u_frustum_tl:I,u_frustum_tr:D,u_frustum_br:N,u_frustum_bl:W,u_globe_pos:V,u_globe_radius:q,u_viewport:Z,u_globe_transition:_o(X.zoom),u_is_globe:+(X.projection.name==="globe")}})(this,m,c,g,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*Pn.devicePixelRatio,this.transform.height*Pn.devicePixelRatio],u);o.setFogUniformValues(t,v)}h&&o.setCutoffUniformValues(t,h.uniformValues)}setTileLoadedFlag(t){this.tileLoaded=t}saveCanvasCopy(){const t=this.canvasCopy();t&&(this.frameCopies.push(t),this.tileLoaded=!1)}canvasCopy(){const t=this.context.gl,o=t.createTexture();return t.bindTexture(t.TEXTURE_2D,o),t.copyTexImage2D(t.TEXTURE_2D,0,t.RGBA,0,0,t.drawingBufferWidth,t.drawingBufferHeight,0),o}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const t=this.style&&this.style.fog;return!!t&&t.getOpacity(this.transform.pitch)!==0}getBackgroundTiles(){const t=this._backgroundTiles,o=this._backgroundTiles={},c=this.transform.coveringTiles({tileSize:512});for(const u of c)o[u.key]=t[u.key]||new k1(u,512,this.transform.tileZoom,this);return o}clearBackgroundTiles(){this._backgroundTiles={}}layerUsedInConflation(t,o){return!(!t.is3D()||t.minzoom&&t.minzoom>this.transform.zoom||t.sourceLayer!=="building"&&(!o||o.type!=="batched-model"))}isTileAffectedByFog(t){if(!this.style||!this.style.fog)return!1;if(this.transform.projection.name==="globe")return!0;let o=this._cachedTileFogOpacities[t.key];return o||(this._cachedTileFogOpacities[t.key]=o=this.style.fog.getOpacityForTile(t)),o[0]>=Om||o[1]>=Om}}const Bm=2048;class eoe{constructor(t,o){this.aabb=t,this.lastCascade=o}}class toe{add(t,o){const c=this.receivers[t.key];c!==void 0?(c.aabb.min[0]=Math.min(c.aabb.min[0],o.min[0]),c.aabb.min[1]=Math.min(c.aabb.min[1],o.min[1]),c.aabb.min[2]=Math.min(c.aabb.min[2],o.min[2]),c.aabb.max[0]=Math.max(c.aabb.max[0],o.max[0]),c.aabb.max[1]=Math.max(c.aabb.max[1],o.max[1]),c.aabb.max[2]=Math.max(c.aabb.max[2],o.max[2])):this.receivers[t.key]=new eoe(o,null)}clear(){this.receivers={}}get(t){return this.receivers[t.key]}computeRequiredCascades(t,o,c){const u=_r.fromPoints(t.points);let h=0;for(const m in this.receivers){const g=this.receivers[m];if(!g||!u.intersectsAabb(g.aabb))continue;g.aabb.min=u.closestPoint(g.aabb.min),g.aabb.max=u.closestPoint(g.aabb.max);const v=g.aabb.getCorners();for(let x=0;x<c.length;x++){let w=!0;for(const E of v){const C=[E[0]*o,E[1]*o,E[2]];if(De.transformMat4(C,C,c[x].matrix),C[0]<-1||C[0]>1||C[1]<-1||C[1]>1){w=!1;break}}if(g.lastCascade=x,h=Math.max(h,x),w)break}}return h+1}}class noe{constructor(t){this.painter=t,this._enabled=!1,this._shadowLayerCount=0,this._numCascadesToRender=0,this._cascades=[],this._groundShadowTiles=[],this._receivers=new toe,this._depthMode=new Fn(t.context.gl.LEQUAL,Fn.ReadWrite,[0,1]),this._uniformValues={u_light_matrix_0:new Float32Array(16),u_light_matrix_1:new Float32Array(16),u_shadow_intensity:0,u_fade_range:[0,0],u_shadow_normal_offset:[1,1,1],u_shadow_texel_size:1,u_shadow_map_resolution:1,u_shadow_direction:[0,0,1],u_shadow_bias:[36e-5,.0012,.012],u_shadowmap_0:0,u_shadowmap_1:0},this.useNormalOffset=!1}destroy(){for(const t of this._cascades)t.texture.destroy(),t.framebuffer.destroy();this._cascades=[]}updateShadowParameters(t,o){const c=this.painter;if(this._enabled=!1,this._shadowLayerCount=0,this._receivers.clear(),!o||!o.properties)return;const u=o.properties.get("shadow-intensity");if(!o.shadowsEnabled()||u<=0||(this._shadowLayerCount=c.style.order.reduce((I,D)=>{const N=c.style._mergedLayers[D];return I+(N.hasShadowPass()&&!N.isHidden(t.zoom)?1:0)},0),this._enabled=this._shadowLayerCount>0,!this._enabled))return;const h=c.context,m=Bm,g=Bm;if(this._cascades.length===0)for(let I=0;I<2;++I){const D=c._shadowMapDebug,N=h.gl,W=h.createFramebuffer(m,g,D,"texture"),V=new xa(h,{width:m,height:g,data:null},N.DEPTH_COMPONENT);if(W.depthAttachment.set(V.texture),D){const q=new xa(h,{width:m,height:g,data:null},N.RGBA);W.colorAttachment.set(q.texture)}this._cascades.push({framebuffer:W,texture:V,matrix:[],far:0,boundingSphereRadius:0,frustum:new ch,scale:0})}this.shadowDirection=_8(o);let v=0;if(t.elevation){const I=t.elevation,D=[1e4,-1e4];I.visibleDemTiles.filter(N=>N.dem).forEach(N=>{const W=N.dem.tree;D[0]=Math.min(D[0],W.minimums[0]),D[1]=Math.max(D[1],W.maximums[0])}),D[0]!==1e4&&(v=(D[1]-D[0])*I.exaggeration())}const x=1.5*t.cameraToCenterDistance,w=3*x,E=new Float64Array(16);for(let I=0;I<2;++I){const D=this._cascades[I];let N=t.height/50,W=1;I===0?W=x:(N=x,W=w);const[V,q]=ioe(t,this.shadowDirection,N,W,Bm,v);D.scale=t.scale,D.matrix=V,D.boundingSphereRadius=q,at.invert(E,D.matrix),D.frustum=ch.fromInvProjectionMatrix(E,1,0,!0),D.far=W}this._uniformValues.u_fade_range=[.75*this._cascades[1].far,this._cascades[1].far],this._uniformValues.u_shadow_intensity=u,this._uniformValues.u_shadow_direction=[this.shadowDirection[0],this.shadowDirection[1],this.shadowDirection[2]],this._uniformValues.u_shadow_texel_size=.00048828125,this._uniformValues.u_shadow_map_resolution=Bm,this._uniformValues.u_shadowmap_0=dl.ShadowMap0,this._uniformValues.u_shadowmap_1=dl.ShadowMap0+1,this._groundShadowTiles=c.transform.coveringTiles({tileSize:512,renderWorldCopies:!0});const C=c.transform.elevation;for(const I of this._groundShadowTiles){let D={min:0,max:0};if(C){const N=C.getMinMaxForTile(I);N&&(D=N)}this.addShadowReceiver(I.toUnwrapped(),D.min,D.max)}}get enabled(){return this._enabled}set enabled(t){this._enabled=t}drawShadowPass(t,o){if(!this._enabled)return;const c=this.painter,u=c.context;this._numCascadesToRender=this._receivers.computeRequiredCascades(c.transform.getFrustum(0),c.transform.worldSize,this._cascades),u.viewport.set([0,0,Bm,Bm]);for(let h=0;h<this._numCascadesToRender;++h){c.currentShadowCascade=h,u.bindFramebuffer.set(this._cascades[h].framebuffer.framebuffer),u.clear({color:En.white,depth:1});for(const m of t.order){const g=t._mergedLayers[m];if(!g.hasShadowPass()||g.isHidden(c.transform.zoom))continue;const v=t.getLayerSourceCache(g),x=v?o[v.id]:void 0;(g.type==="model"||x&&x.length)&&c.renderLayer(c,v,g,x)}}c.currentShadowCascade=0}drawGroundShadows(){if(!this._enabled)return;const t=this.painter,o=t.style,c=t.context,u=o.directionalLight,h=o.ambientLight;if(!u||!h)return;const m=[],g=Rv(t,t.longestCutoffRange);g.shouldRenderCutoff&&m.push("RENDER_CUTOFF");const v=NI(u,h),x=new Fn(c.gl.LEQUAL,Fn.ReadOnly,t.depthRangeFor3D);for(const w of this._groundShadowTiles){const E=w.toUnwrapped(),C=t.isTileAffectedByFog(w),I=t.getOrCreateProgram("groundShadow",{defines:m,overrideFog:C});this.setupShadows(E,I),t.uploadCommonUniforms(c,I,E,null,g);const D={u_matrix:t.transform.calculateProjMatrix(E),u_ground_shadow_factor:v};I.draw(t,c.gl.TRIANGLES,x,hi.disabled,Ri.multiply,mi.disabled,D,"ground_shadow",t.tileExtentBuffer,t.quadTriangleIndexBuffer,t.tileExtentSegments,{},t.transform.zoom,null,null)}}getShadowPassColorMode(){return this.painter._shadowMapDebug?Ri.unblended:Ri.disabled}getShadowPassDepthMode(){return this._depthMode}getShadowCastingLayerCount(){return this._shadowLayerCount}calculateShadowPassMatrixFromTile(t){const o=this.painter.transform,c=o.calculatePosMatrix(t,o.worldSize);return at.multiply(c,this._cascades[this.painter.currentShadowCascade].matrix,c),Float32Array.from(c)}calculateShadowPassMatrixFromMatrix(t){return at.multiply(t,this._cascades[this.painter.currentShadowCascade].matrix,t),Float32Array.from(t)}setupShadows(t,o,c,u=0){if(!this._enabled)return;const h=this.painter.transform,m=this.painter.context,g=m.gl,v=this._uniformValues,x=new Float64Array(16),w=h.calculatePosMatrix(t,h.worldSize);for(let E=0;E<2;E++)at.multiply(x,this._cascades[E].matrix,w),v[E===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(x),m.activeTexture.set(g.TEXTURE0+dl.ShadowMap0+E),this._cascades[E].texture.bind(g.NEAREST,g.CLAMP_TO_EDGE);if(this.useNormalOffset=!!c,this.useNormalOffset){const E=_1(t.canonical),C=2/h.tileSize*mt/Bm,I=C*this._cascades[0].boundingSphereRadius,D=C*this._cascades[1].boundingSphereRadius,N=(c==="vector-tile"?1:3)/Math.pow(2,u-t.canonical.z-(1-h.zoom+Math.floor(h.zoom)));v.u_shadow_normal_offset=[E,I*N,D*N],v.u_shadow_bias=[6e-5,.0012,.012]}else v.u_shadow_bias=[36e-5,.0012,.012];o.setShadowUniformValues(m,v)}setupShadowsFromMatrix(t,o,c=!1){if(!this._enabled)return;const u=this.painter.context,h=u.gl,m=this._uniformValues,g=new Float64Array(16);for(let v=0;v<2;v++)at.multiply(g,this._cascades[v].matrix,t),m[v===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(g),u.activeTexture.set(h.TEXTURE0+dl.ShadowMap0+v),this._cascades[v].texture.bind(h.NEAREST,h.CLAMP_TO_EDGE);this.useNormalOffset=c,c?(m.u_shadow_normal_offset=[1,5,5],m.u_shadow_bias=[6e-5,.0012,.012]):m.u_shadow_bias=[36e-5,.0012,.012],o.setShadowUniformValues(u,m)}getShadowUniformValues(){return this._uniformValues}getCurrentCascadeFrustum(){return this._cascades[this.painter.currentShadowCascade].frustum}computeSimplifiedTileShadowVolume(t,o,c,u){if(u[2]>=0)return{};const h=function(v,x,w){const E=w/(1<<v.canonical.z);return new _r([v.canonical.x*E+v.wrap*w,v.canonical.y*E+v.wrap*w,0],[(v.canonical.x+1)*E+v.wrap*w,(v.canonical.y+1)*E+v.wrap*w,x])}(t,o,c).getCorners(),m=o/-u[2];u[0]<0?(De.add(h[0],h[0],[u[0]*m,0,0]),De.add(h[3],h[3],[u[0]*m,0,0])):u[0]>0&&(De.add(h[1],h[1],[u[0]*m,0,0]),De.add(h[2],h[2],[u[0]*m,0,0])),u[1]<0?(De.add(h[0],h[0],[0,u[1]*m,0]),De.add(h[1],h[1],[0,u[1]*m,0])):u[1]>0&&(De.add(h[2],h[2],[0,u[1]*m,0]),De.add(h[3],h[3],[0,u[1]*m,0]));const g={};return g.vertices=h,g.planes=[K2(h[1],h[0],h[4]),K2(h[2],h[1],h[5]),K2(h[3],h[2],h[6]),K2(h[0],h[3],h[7])],g}addShadowReceiver(t,o,c){this._receivers.add(t,_r.fromTileIdAndHeight(t,o,c))}getMaxCascadeForTile(t){const o=this._receivers.get(t);return o&&o.lastCascade?o.lastCascade:0}}function K2(r,t,o){const c=De.sub([],o,t),u=De.sub([],r,t),h=De.cross([],c,u),m=De.length(h);return m===0?[0,0,1,0]:(De.scale(h,h,1/m),[h[0],h[1],h[2],-De.dot(h,t)])}function _8(r){const t=r.properties.get("direction"),o=de(t.x,t.y,t.z);o[2]=re(o[2],0,75);const c=st([o[0],o[1],o[2]]);return De.fromValues(c.x,c.y,c.z)}function NI(r,t){const o=r.properties.get("color"),c=r.properties.get("intensity"),u=r.properties.get("direction"),h=[u.x,u.y,u.z],m=t.properties.get("color"),g=t.properties.get("intensity"),v=Math.max(De.dot([0,0,1],h),0),x=[0,0,0];De.scale(x,m.toArray01Linear().slice(0,3),g);const w=[0,0,0];return De.scale(w,o.toArray01Linear().slice(0,3),v*c),Ht([x[0]>0?x[0]/(x[0]+w[0]):0,x[1]>0?x[1]/(x[1]+w[1]):0,x[2]>0?x[2]/(x[2]+w[2]):0])}function ioe(r,t,o,c,u,h){const m=r.zoom,g=r.scale,v=r.worldSize,x=1/v,w=r.aspect,E=Math.sqrt(1+w*w)*Math.tan(.5*r.fovX),C=E*E,I=c-o,D=c+o;let N,W;C>I/D?(N=c,W=c*E):(N=.5*D*(1+C),W=.5*Math.sqrt(I*I+2*(c*c+o*o)*C+D*D*C*C));const V=r.projection.pixelsPerMeter(r.center.lat,v),q=r._camera.getCameraToWorldMercator(),Z=[0,0,-N*x];De.transformMat4(Z,Z,q);let K=W*x;const X=r._edgeInsets;if(!(X.left===0&&X.top===0&&X.right===0&&X.bottom===0||X.left===X.right&&X.top===X.bottom)){const yt=r._camera.getWorldToCamera(r.worldSize,r.projection.zAxisUnit==="meters"?V:1),ft=r._camera.getCameraToClipPerspective(r._fov,r.width/r.height,o,c);ft[8]=2*-r.centerOffset.x/r.width,ft[9]=2*r.centerOffset.y/r.height;const Lt=new Float64Array(16);at.mul(Lt,ft,yt);const Ft=new Float64Array(16);at.invert(Ft,Lt);const St=ch.fromInvProjectionMatrix(Ft,v,m,!0);for(const Ct of St.points){const rn=((J=Ct)[0]/=g,J[1]/=g,J[2]=Xi(J[2],r._center.lat),J);K=Math.max(K,De.len(De.subtract([],Z,rn)))}}var J;K*=u/(u-1);const ae=Math.acos(t[2]),ce=Math.atan2(-t[0],-t[1]),ge=new A2;ge.position=Z,ge.setPitchBearing(ae,ce);const ve=ge.getWorldToCamera(v,V),Pe=K*v,Me=Math.min(r._mercatorZfromZoom(17)*v*-2,-2*Pe),Le=ge.getCameraToClipOrthographic(-Pe,Pe,-Pe,Pe,Me,(Pe+h*V)/t[2]),Ee=new Float64Array(16);at.multiply(Ee,Le,ve);const He=De.fromValues(Math.floor(1e6*Z[0])/1e6*v,Math.floor(1e6*Z[1])/1e6*v,0),Ke=.5*u,nt=[0,0,0];De.transformMat4(nt,He,Ee),De.scale(nt,nt,Ke);const Ve=[Math.floor(nt[0]),Math.floor(nt[1]),Math.floor(nt[2])],je=[0,0,0];De.sub(je,nt,Ve),De.scale(je,je,-1/Ke);const ot=new Float64Array(16);return at.identity(ot),at.translate(ot,ot,je),at.multiply(Ee,ot,Ee),[Ee,Pe]}class roe extends Vn{constructor(t){super(),this.requestManager=t,this.models={"":{}},this.numModelsLoading={}}async loadModel(t,o){const c=await fU(this.requestManager.transformRequest(o,Se.Model).url).catch(m=>{this.fire(new bn(new Error(`Could not load model ${t} from ${o}: ${m.message}`)))});if(!c)return;const u=wI(c),h=new c6(t,void 0,void 0,u);return h.computeBoundsAndApplyParent(),h}async load(t,o){this.models[o]||(this.models[o]={});const c=Object.keys(t);this.numModelsLoading[o]=(this.numModelsLoading[o]||0)+c.length;const u=[];for(const m of c)u.push(this.loadModel(m,t[m]));const h=await Promise.allSettled(u);for(let m=0;m<h.length;m++){const{status:g,value:v}=h[m];g==="fulfilled"&&v&&(this.models[o][c[m]]=v)}this.numModelsLoading[o]-=c.length,this.fire(new $t("data",{dataType:"style"}))}isLoaded(){for(const t in this.numModelsLoading)if(this.numModelsLoading[t]>0)return!1;return!0}hasModel(t,o){return!!this.getModel(t,o)}getModel(t,o){return this.models[o]||(this.models[o]={}),this.models[o][t]}async addModel(t,o,c){this.models[c]||(this.models[c]={}),this.hasModel(t,c)&&this.removeModel(t,c),this.load({[t]:this.requestManager.normalizeModelURL(o)},c)}addModels(t,o){const c={};for(const u in t)c[u]=this.requestManager.normalizeModelURL(t[u]);this.load(c,o)}removeModel(t,o){this.models[o]||(this.models[o]={});const c=this.models[o][t];delete this.models[o][t],c.destroy()}listModels(t){return this.models[t]||(this.models[t]={}),Object.keys(this.models[t])}upload(t,o){this.models[o]||(this.models[o]={});for(const c in this.models[o])this.models[o][c].upload(t.context)}}const X1=(r,t)=>yo(r,t&&t.filter(o=>o.identifier!=="source.canvas")),aoe=ct(Wi,["addLayer","removeLayer","setLights","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection","setCamera","addImport","removeImport","setImportUrl","setImportData"]),ooe=ct(Wi,["setCenter","setZoom","setBearing","setPitch"]),x8={version:8,layers:[],sources:{}},b8={duration:300,delay:0},soe=new Set(["fill","line","background","hillshade","raster"]);class ru extends Vn{constructor(t,o={}){super(),this.map=t,this.scope=o.scope||"",this.fragments=[],this.importDepth=o.importDepth||0,this.importsCache=o.importsCache||new Map,this.resolvedImports=o.resolvedImports||new Set,this.transition=Fe({},b8),this._buildingIndex=new Lre(this),this.crossTileSymbolIndex=new tae,this._mergedOrder=[],this._drapedFirstOrder=[],this._mergedLayers={},this._mergedSourceCaches={},this._mergedOtherSourceCaches={},this._mergedSymbolSourceCaches={},this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this._changes=o.styleChanges||new FC,this.dispatcher=o.dispatcher?o.dispatcher:new Nm(j1(),this),o.imageManager?this.imageManager=o.imageManager:(this.imageManager=new sre,this.imageManager.setEventedParent(this)),this.imageManager.createScope(this.scope),this.glyphManager=o.glyphManager?o.glyphManager:new wv(t._requestManager,o.localFontFamily?2:o.localIdeographFontFamily?1:0,o.localFontFamily||o.localIdeographFontFamily),o.modelManager?this.modelManager=o.modelManager:(this.modelManager=new roe(t._requestManager),this.modelManager.setEventedParent(this)),this._layers={},this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._precompileDone=!1,this._shouldPrecompile=!1,this._availableImages=[],this._order=[],this._markersNeedUpdate=!1,this.options=o.config||new Map,this._configDependentLayers=new Set,this._changes.reset(),this.dispatcher.broadcast("setReferrer",Ne());const c=this;this._rtlTextPluginCallback=ru.registerForPluginStateChange(u=>{c.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:u.pluginStatus,pluginURL:u.pluginURL},(h,m)=>{if(Zo(h),m&&m.every(g=>g))for(const g in c._sourceCaches){const v=c._sourceCaches[g],x=v.getSource().type;x!=="vector"&&x!=="geojson"||v.reload()}})}),this.on("data",u=>{if(u.dataType!=="source"||u.sourceDataType!=="metadata")return;const h=this.getOwnSource(u.sourceId);if(h&&h.vectorLayerIds)for(const m in this._layers){const g=this._layers[m];g.source===h.id&&this._validateLayer(g)}})}loadURL(t,o={}){this.fire(new $t("dataloading",{dataType:"style"}));const c=typeof o.validate=="boolean"?o.validate:!_n(t);t=this.map._requestManager.normalizeStyleURL(t,o.accessToken),this.resolvedImports.add(t);const u=this.importsCache.get(t);if(u)return this._load(u,c);const h=this.map._requestManager.transformRequest(t,Se.Style);this._request=tt(h,(m,g)=>{if(this._request=null,m)this.fire(new bn(m));else if(g)return this.importsCache.set(t,g),this._load(g,c)})}loadJSON(t,o={}){this.fire(new $t("dataloading",{dataType:"style"})),this._request=Pn.frame(()=>{this._request=null,this._load(t,o.validate!==!1)})}loadEmpty(){this.fire(new $t("dataloading",{dataType:"style"})),this._load(x8,!1)}_loadImports(t,o){if(this.importDepth>=4)return xe("Style doesn't support nesting deeper than 5"),this._reloadImports();const c=[];for(const u of t){const h=this._createFragmentStyle(u),m=new Promise(v=>h.on("style.import.load",v));if(c.push(m),this.resolvedImports.has(u.url)){h.loadEmpty();continue}const g=u.data||this.importsCache.get(u.url);g?h.loadJSON(g,{validate:o}):u.url?h.loadURL(u.url,{validate:o}):h.loadEmpty(),this.fragments.push({style:h,id:u.id,config:u.config})}Promise.all(c).then(()=>this._reloadImports())}_createFragmentStyle(t){const o=this.scope?Ko(t.id,this.scope):t.id,c=new Map,u=t.config;if(u)for(const m of Object.keys(u)){const g=Hc(u[m]);g.result==="success"&&c.set(m,g.value.expression)}const h=new ru(this.map,{scope:o,config:c,styleChanges:this._changes,importDepth:this.importDepth+1,importsCache:this.importsCache,resolvedImports:new Set(this.resolvedImports),dispatcher:this.dispatcher,imageManager:this.imageManager,glyphManager:this.glyphManager,modelManager:this.modelManager});return h.setEventedParent(this.map,{style:h}),h}_reloadImports(){this.mergeAll(),this._updateMapProjection(),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),this._shouldPrecompile=this.importDepth===0,this.fire(new $t("data",{dataType:"style"})),this.fire(new $t(this.importDepth===0?"style.load":"style.import.load"))}_load(t,o){const c=t.schema;if(this.importDepth===0&&(t.fragment||c&&t.fragment!==!1)){const m=Fe({},x8,{imports:[{id:"basemap",data:t,url:""}]});return void this._load(m,o)}if(c)for(const m of Object.keys(c)){if(this.options.has(m))continue;const g=Hc(c[m].default);g.result==="success"&&this.options.set(m,g.value.expression)}if(o&&X1(this,Vu(t)))return;this._loaded=!0,this.stylesheet=ue(t);for(const m in t.sources)this.addSource(m,t.sources[m],{validate:!1});this._changes.changed=!1,t.sprite?this._loadSprite(t.sprite):(this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0})),this.glyphManager.setURL(t.glyphs,this.scope);const u=vU(this.stylesheet.layers);if(this._order=u.map(m=>m.id),this.stylesheet.light&&xe("The `light` root property is deprecated, prefer using `lights` with `flat` light type instead."),this.stylesheet.lights)if(this.stylesheet.lights.length===1&&this.stylesheet.lights[0].type==="flat"){const m=this.stylesheet.lights[0];this.light=new j6(m.properties,m.id)}else this.setLights(this.stylesheet.lights);this.light||(this.light=new j6(this.stylesheet.light)),this._layers={},this._serializedLayers={};for(const m of u){const g=z2(m,this.options);g.setScope(this.scope),g.isConfigDependent&&this._configDependentLayers.add(g.fqid),g.setEventedParent(this,{layer:{id:g.id}}),this._layers[g.id]=g,this._layers[g.id]=g,this._serializedLayers[g.id]=g.serialize();const v=this.getOwnLayerSourceCache(g),x=!!this.directionalLight&&this.directionalLight.shadowsEnabled();v&&g.canCastShadows()&&x&&(v.castsShadows=!0)}this.stylesheet.models&&this.modelManager.addModels(this.stylesheet.models,this.scope);const h=this.stylesheet.terrain;h&&!this.terrainSetForDrapingOnly()&&this._createTerrain(h,1),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this.stylesheet.transition&&this.setTransition(this.stylesheet.transition),this.mergeAll(),this._updateMapProjection(),this.map._triggerCameraUpdate(this.camera),this.fire(new $t("data",{dataType:"style"})),t.imports?this._loadImports(t.imports,o):(this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),this._shouldPrecompile=this.importDepth===0,this.fire(new $t(this.importDepth===0?"style.load":"style.import.load")))}mergeAll(){let t,o,c,u,h,m,g,v;this.forEachFragmentStyle(x=>{x.light!=null&&(t=x.light),x.ambientLight!=null&&(o=x.ambientLight),x.directionalLight!=null&&(c=x.directionalLight),x.terrain!=null&&(!u||u&&u.drapeRenderMode===0||x.terrain.drapeRenderMode===1)&&(u=x.terrain),x.fog!=null&&(h=x.fog),x.stylesheet&&(x.stylesheet.camera!=null&&(v=x.stylesheet.camera),x.stylesheet.projection!=null&&(m=x.stylesheet.projection),x.stylesheet.transition!=null&&(g=x.stylesheet.transition))}),this.light=t,this.ambientLight=o,this.directionalLight=c,this.terrain=u,this.fog=h,this.camera=v||{"camera-projection":"perspective"},this.projection=m||{name:"mercator"},this.transition=Fe({},b8,g),this.mergeSources(),this.mergeLayers()}forEachFragmentStyle(t){const o=c=>{for(const u of c.fragments)o(u.style);t(c)};o(this)}mergeTerrain(){let t;this.forEachFragmentStyle(o=>{o.terrain!=null&&(!t||t&&t.drapeRenderMode===0||o.terrain.drapeRenderMode===1)&&(t=o.terrain)}),this.terrain=t}mergeProjection(){let t;this.forEachFragmentStyle(o=>{o.stylesheet.projection!=null&&(t=o.stylesheet.projection)}),this.projection=t||{name:"mercator"}}mergeSources(){const t={},o={},c={};this.forEachFragmentStyle(u=>{for(const h in u._sourceCaches){const m=Ko(h,u.scope);t[m]=u._sourceCaches[h]}for(const h in u._otherSourceCaches){const m=Ko(h,u.scope);o[m]=u._otherSourceCaches[h]}for(const h in u._symbolSourceCaches){const m=Ko(h,u.scope);c[m]=u._symbolSourceCaches[h]}}),this._mergedSourceCaches=t,this._mergedOtherSourceCaches=o,this._mergedSymbolSourceCaches=c}mergeLayers(){const t={},o=[],c={};this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this.forEachFragmentStyle(h=>{for(const m of h._order){const g=h._layers[m];if(g.type==="slot"){const v=sv(m);if(t[v])continue;t[v]=[]}g.slot&&t[g.slot]?t[g.slot].push(g):o.push(g)}}),this._mergedOrder=[];const u=(h=[])=>{for(const m of h)if(m.type==="slot"){const g=sv(m.id);t[g]&&u(t[g])}else{const g=Ko(m.id,m.scope);this._mergedOrder.push(g),c[g]=m,m.is3D()&&(this._has3DLayers=!0),m.type==="circle"&&(this._hasCircleLayers=!0),m.type==="symbol"&&(this._hasSymbolLayers=!0)}};u(o),this._mergedLayers=c,this.updateDrapeFirstLayers(),this._buildingIndex.processLayersChanged()}terrainSetForDrapingOnly(){return!!this.terrain&&this.terrain.drapeRenderMode===0}getCamera(){return this.stylesheet.camera}setCamera(t){return this.stylesheet.camera=Fe({},this.stylesheet.camera,t),this.camera=this.stylesheet.camera,this}setProjection(t){t?this.stylesheet.projection=t:delete this.stylesheet.projection,this.mergeProjection(),this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?this.getTerrain()||this.stylesheet.terrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null))}_updateMapProjection(){this.importDepth>0||(this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.projection))}_loadSprite(t){this._spriteRequest=function(o,c,u){let h,m,g;const v=Pn.devicePixelRatio>1?"@2x":"";let x=tt(c.transformRequest(c.normalizeSpriteURL(o,v,".json"),Se.SpriteJSON),(C,I)=>{x=null,g||(g=C,h=I,E())}),w=Qt(c.transformRequest(c.normalizeSpriteURL(o,v,".png"),Se.SpriteImage),(C,I)=>{w=null,g||(g=C,m=I,E())});function E(){if(g)u(g);else if(h&&m){const C=Pn.getImageData(m),I={};for(const D in h){const{width:N,height:W,x:V,y:q,sdf:Z,pixelRatio:K,stretchX:X,stretchY:J,content:ae}=h[D],ce=new Jr({width:N,height:W});Jr.copy(C,ce,{x:V,y:q},{x:0,y:0},{width:N,height:W}),I[D]={data:ce,pixelRatio:K,sdf:Z,stretchX:X,stretchY:J,content:ae}}u(null,I)}}return{cancel(){x&&(x.cancel(),x=null),w&&(w.cancel(),w=null)}}}(t,this.map._requestManager,(o,c)=>{if(this._spriteRequest=null,o)this.fire(new bn(o));else if(c)for(const u in c)this.imageManager.addImage(u,this.scope,c[u]);this.imageManager.setLoaded(!0,this.scope),this._availableImages=this.imageManager.listImages(this.scope),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages}),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0}),this.fire(new $t("data",{dataType:"style"}))})}_validateLayer(t){const o=this.getOwnSource(t.source);if(!o)return;const c=t.sourceLayer;c&&(o.type==="geojson"||o.vectorLayerIds&&o.vectorLayerIds.indexOf(c)===-1)&&this.fire(new bn(new Error(`Source layer "${c}" does not exist on source "${o.id}" as specified by style layer "${t.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._changes.updatedSourceCaches).length)return!1;for(const t in this._sourceCaches)if(!this._sourceCaches[t].loaded())return!1;if(!this.imageManager.isLoaded()||!this.modelManager.isLoaded())return!1;for(const{style:t}of this.fragments)if(!t.loaded())return!1;return!0}_serializeImports(){if(this.stylesheet.imports)return this.stylesheet.imports.map((t,o)=>{const c=this.fragments[o];return c&&c.style&&(t.data=c.style.serialize()),t})}_serializeSources(){const t={};for(const o in this._sourceCaches){const c=this._sourceCaches[o].getSource();t[c.id]||(t[c.id]=c.serialize())}return t}_serializeLayers(t){const o=[];for(const c of t){const u=this._layers[c];u&&u.type!=="custom"&&o.push(u.serialize())}return o}hasLightTransitions(){return!(!this.light||!this.light.hasTransition())||!(!this.ambientLight||!this.ambientLight.hasTransition())||!(!this.directionalLight||!this.directionalLight.hasTransition())}hasFogTransition(){return!!this.fog&&this.fog.hasTransition()}hasTransitions(){if(this.hasLightTransitions()||this.hasFogTransition())return!0;for(const t in this._sourceCaches)if(this._sourceCaches[t].hasTransition())return!0;for(const t in this._layers)if(this._layers[t].hasTransition())return!0;return!1}get order(){return this.terrain?this._drapedFirstOrder:this._mergedOrder}isLayerDraped(t){return!!this.terrain&&(typeof t.isLayerDraped=="function"?t.isLayerDraped(this.getLayerSourceCache(t)):soe.has(t.type))}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}update(t){if(!this._loaded)return;this.ambientLight&&this.ambientLight.recalculate(t),this.directionalLight&&this.directionalLight.recalculate(t);const o=this.calculateLightsBrightness();t.brightness=o||0,o!==this._brightness&&(this._brightness=o,this.dispatcher.broadcast("setBrightness",o));const c=this._changes.changed;if(this._changes.changed){const h=this._changes.getLayerUpdatesByScope();for(const m in h){const{updatedIds:g,removedIds:v}=h[m];(g||v)&&this._updateWorkerLayers(m,g,v)}this.updateSourceCaches(),this._updateTilesForChangedImages(),this.updateLayers(t),this.light&&this.light.updateTransitions(t),this.ambientLight&&this.ambientLight.updateTransitions(t),this.directionalLight&&this.directionalLight.updateTransitions(t),this.fog&&this.fog.updateTransitions(t),this._changes.reset()}const u={};for(const h in this._mergedSourceCaches){const m=this._mergedSourceCaches[h];u[h]=m.used,m.used=!1}for(const h of this._mergedOrder){const m=this._mergedLayers[h];if(m.recalculate(t,this._availableImages),!m.isHidden(t.zoom)){const g=this.getOwnLayerSourceCache(m);g&&(g.used=!0)}if(!this._precompileDone&&this._shouldPrecompile)for(let g=m.minzoom||0;g<(m.maxzoom||25.5);g++){const v=this.map.painter;if(v){const x=m.getProgramIds();if(!x)continue;for(const w of x){const E=m.getDefaultProgramParams(w,t.zoom);E&&(v.style=this,this.fog&&(v._fogVisible=!0,E.overrideFog=!0,v.getOrCreateProgram(w,E)),v._fogVisible=!1,E.overrideFog=!1,v.getOrCreateProgram(w,E),(this.stylesheet.terrain||this.stylesheet.projection&&this.stylesheet.projection.name==="globe")&&(E.overrideRtt=!0,v.getOrCreateProgram(w,E)))}}}}this._shouldPrecompile&&(this._precompileDone=!0);for(const h in u){const m=this._mergedSourceCaches[h];u[h]!==m.used&&m.getSource().fire(new $t("data",{sourceDataType:"visibility",dataType:"source",sourceId:m.getSource().id}))}this.light&&this.light.recalculate(t),this.terrain&&this.terrain.recalculate(t),this.fog&&this.fog.recalculate(t),this.z=t.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),c&&this.fire(new $t("data",{dataType:"style"}));for(const{style:h}of this.fragments)h.update(t)}_updateTilesForChangedImages(){const t=Array.from(this._changes.changedImages.keys());if(t.length){for(const o in this._sourceCaches)this._sourceCaches[o].reloadTilesForDependencies(["icons","patterns"],t);this._changes.changedImages.clear()}}_updateWorkerLayers(t,o,c){const u=this.getFragmentStyle(t);this.dispatcher.broadcast("updateLayers",{layers:o?u._serializeLayers(o):[],scope:t,removedIds:c||[],options:u.options})}setState(t){if(this._checkLoaded(),X1(this,Vu(t)))return!1;(t=ue(t)).layers=vU(t.layers);const o=function(u,h){if(!u)return[{command:Wi.setStyle,args:[h]}];let m=[];try{if(!Q(u.version,h.version))return[{command:Wi.setStyle,args:[h]}];Q(u.center,h.center)||m.push({command:Wi.setCenter,args:[h.center]}),Q(u.zoom,h.zoom)||m.push({command:Wi.setZoom,args:[h.zoom]}),Q(u.bearing,h.bearing)||m.push({command:Wi.setBearing,args:[h.bearing]}),Q(u.pitch,h.pitch)||m.push({command:Wi.setPitch,args:[h.pitch]}),Q(u.sprite,h.sprite)||m.push({command:Wi.setSprite,args:[h.sprite]}),Q(u.glyphs,h.glyphs)||m.push({command:Wi.setGlyphs,args:[h.glyphs]}),Q(u.transition,h.transition)||m.push({command:Wi.setTransition,args:[h.transition]}),Q(u.light,h.light)||m.push({command:Wi.setLight,args:[h.light]}),Q(u.fog,h.fog)||m.push({command:Wi.setFog,args:[h.fog]}),Q(u.projection,h.projection)||m.push({command:Wi.setProjection,args:[h.projection]}),Q(u.lights,h.lights)||m.push({command:Wi.setLights,args:[h.lights]}),Q(u.camera,h.camera)||m.push({command:Wi.setCamera,args:[h.camera]});const g={},v=[];(function(E,C,I,D){let N;for(N in C=C||{},E=E||{})E.hasOwnProperty(N)&&(C.hasOwnProperty(N)||xU(N,I,D));for(N in C){if(!C.hasOwnProperty(N))continue;const W=C[N];E.hasOwnProperty(N)?Q(E[N],W)||(E[N].type==="geojson"&&W.type==="geojson"&&zre(E,C,N)?I.push({command:Wi.setGeoJSONSourceData,args:[N,W.data]}):Dre(N,C,I,D)):_U(N,C,I)}})(u.sources,h.sources,v,g);const x=[];u.layers&&u.layers.forEach(E=>{E.source&&g[E.source]?m.push({command:Wi.removeLayer,args:[E.id]}):x.push(E)});let w=u.terrain;w&&g[w.source]&&(m.push({command:Wi.setTerrain,args:[void 0]}),w=void 0),m=m.concat(v),Q(w,h.terrain)||m.push({command:Wi.setTerrain,args:[h.terrain]}),function(E,C,I){C=C||[];const D=(E=E||[]).map(B2),N=C.map(B2),W=E.reduce(U2,{}),V=C.reduce(U2,{}),q=D.slice(),Z=Object.create(null);let K,X,J,ae,ce,ge,ve;for(K=0,X=0;K<D.length;K++)J=D[K],V.hasOwnProperty(J)?X++:(I.push({command:Wi.removeLayer,args:[J]}),q.splice(q.indexOf(J,X),1));for(K=0,X=0;K<N.length;K++)J=N[N.length-1-K],q[q.length-1-K]!==J&&(W.hasOwnProperty(J)?(I.push({command:Wi.removeLayer,args:[J]}),q.splice(q.lastIndexOf(J,q.length-X),1)):X++,ge=q[q.length-K],I.push({command:Wi.addLayer,args:[V[J],ge]}),q.splice(q.length-K,0,J),Z[J]=!0);for(K=0;K<N.length;K++)if(J=N[K],ae=W[J],ce=V[J],!Z[J]&&!Q(ae,ce))if(Q(ae.source,ce.source)&&Q(ae["source-layer"],ce["source-layer"])&&Q(ae.type,ce.type)){for(ve in F2(ae.layout,ce.layout,I,J,null,Wi.setLayoutProperty),F2(ae.paint,ce.paint,I,J,null,Wi.setPaintProperty),Q(ae.filter,ce.filter)||I.push({command:Wi.setFilter,args:[J,ce.filter]}),Q(ae.minzoom,ce.minzoom)&&Q(ae.maxzoom,ce.maxzoom)||I.push({command:Wi.setLayerZoomRange,args:[J,ce.minzoom,ce.maxzoom]}),ae)ae.hasOwnProperty(ve)&&ve!=="layout"&&ve!=="paint"&&ve!=="filter"&&ve!=="metadata"&&ve!=="minzoom"&&ve!=="maxzoom"&&(ve.indexOf("paint.")===0?F2(ae[ve],ce[ve],I,J,ve.slice(6),Wi.setPaintProperty):Q(ae[ve],ce[ve])||I.push({command:Wi.setLayerProperty,args:[J,ve,ce[ve]]}));for(ve in ce)ce.hasOwnProperty(ve)&&!ae.hasOwnProperty(ve)&&ve!=="layout"&&ve!=="paint"&&ve!=="filter"&&ve!=="metadata"&&ve!=="minzoom"&&ve!=="maxzoom"&&(ve.indexOf("paint.")===0?F2(ae[ve],ce[ve],I,J,ve.slice(6),Wi.setPaintProperty):Q(ae[ve],ce[ve])||I.push({command:Wi.setLayerProperty,args:[J,ve,ce[ve]]}))}else I.push({command:Wi.removeLayer,args:[J]}),ge=q[q.lastIndexOf(J)+1],I.push({command:Wi.addLayer,args:[ce,ge]})}(x,h.layers,m),function(E=[],C=[],I){C=C||[];const D=(E=E||[]).map(B2),N=C.map(B2),W=E.reduce(U2,{}),V=C.reduce(U2,{}),q=D.slice();let Z,K,X,J;for(Z=0,K=0;Z<D.length;Z++)X=D[Z],V.hasOwnProperty(X)?K++:(I.push({command:Wi.removeImport,args:[X]}),q.splice(q.indexOf(X,K),1));for(Z=0,K=0;Z<N.length;Z++)X=N[N.length-1-Z],q[q.length-1-Z]!==X&&(W.hasOwnProperty(X)?(I.push({command:Wi.removeImport,args:[X]}),q.splice(q.lastIndexOf(X,q.length-K),1)):K++,J=q[q.length-Z],I.push({command:Wi.addImport,args:[V[X],J]}),q.splice(q.length-Z,0,X));for(const ae of C){const ce=W[ae.id];if(!ce||Q(ce,ae))continue;Q(ce.url,ae.url)||I.push({command:Wi.setImportUrl,args:[ae.id,ae.url]});const ge=ae.data;Q(ce&&ce.data,ge)||I.push({command:Wi.setImportData,args:[ae.id,ge]})}}(u.imports,h.imports,m)}catch(g){console.warn("Unable to compute style diff:",g),m=[{command:Wi.setStyle,args:[h]}]}return m}(this.serialize(),t).filter(u=>!(u.command in ooe));if(o.length===0)return!1;const c=o.filter(u=>!(u.command in aoe));if(c.length>0)throw new Error(`Unimplemented: ${c.map(u=>u.command).join(", ")}.`);return o.forEach(u=>{this[u.command].apply(this,u.args)}),this.stylesheet=t,this.mergeAll(),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),!0}addImage(t,o){return this.getImage(t)?this.fire(new bn(new Error("An image with this name already exists."))):(this.imageManager.addImage(t,this.scope,o),this._afterImageUpdated(t),this)}updateImage(t,o){this.imageManager.updateImage(t,this.scope,o)}getImage(t){return this.imageManager.getImage(t,this.scope)}removeImage(t){return this.getImage(t)?(this.imageManager.removeImage(t,this.scope),this._afterImageUpdated(t),this):this.fire(new bn(new Error("No image with this name exists.")))}_afterImageUpdated(t){this._availableImages=this.imageManager.listImages(this.scope),this._changes.changedImages.add(t),this._changes.changed=!0,this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages}),this.fire(new $t("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addModel(t,o,c={}){return this._checkLoaded(),this._validate(Jy,`models.${t}`,o,null,c)||(this.modelManager.addModel(t,o,this.scope),this._changes.changed=!0),this}hasModel(t){return this.modelManager.hasModel(t,this.scope)}removeModel(t){return this.hasModel(t)?(this.modelManager.removeModel(t,this.scope),this):this.fire(new bn(new Error("No model with this ID exists.")))}listModels(){return this._checkLoaded(),this.modelManager.listModels(this.scope)}addSource(t,o,c={}){if(this._checkLoaded(),this.getOwnSource(t)!==void 0)throw new Error(`There is already a source with ID "${t}".`);if(!o.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(o).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(o.type)>=0&&this._validate(_f,`sources.${t}`,o,null,c))return;this.map&&this.map._collectResourceTiming&&(o.collectResourceTiming=!0);const u=EI(t,o,this.dispatcher,this);u.scope=this.scope,u.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(u.id),source:u.serialize(),sourceId:u.id}));const h=m=>{const g=(m?"symbol:":"other:")+u.id,v=Ko(g,this.scope),x=this._sourceCaches[g]=new tu(v,u,m);(m?this._symbolSourceCaches:this._otherSourceCaches)[u.id]=x,x.onAdd(this.map)};h(!1),o.type!=="vector"&&o.type!=="geojson"||h(!0),u.onAdd&&u.onAdd(this.map),this.mergeSources(),this._changes.changed=!0}removeSource(t){this._checkLoaded();const o=this.getOwnSource(t);if(!o)throw new Error("There is no source with this ID");for(const u in this._layers)if(this._layers[u].source===t)return this.fire(new bn(new Error(`Source "${t}" cannot be removed while layer "${u}" is using it.`)));if(this.terrain&&this.terrain.get().source===t)return this.fire(new bn(new Error(`Source "${t}" cannot be removed while terrain is using it.`)));const c=this.getOwnSourceCaches(t);for(const u of c){const h=sv(u.id);delete this._sourceCaches[h],delete this._changes.updatedSourceCaches[u.id],u.fire(new $t("data",{sourceDataType:"metadata",dataType:"source",sourceId:u.getSource().id})),u.setEventedParent(null),u.clearTiles()}return delete this._otherSourceCaches[t],delete this._symbolSourceCaches[t],this.mergeSources(),o.setEventedParent(null),o.onRemove&&o.onRemove(this.map),this._changes.changed=!0,this}setGeoJSONSourceData(t,o){this._checkLoaded(),this.getOwnSource(t).setData(o),this._changes.changed=!0}getOwnSource(t){const o=this.getOwnSourceCache(t);return o&&o.getSource()}getOwnSources(){const t=[];for(const o in this._otherSourceCaches){const c=this.getOwnSourceCache(o);c&&t.push(c.getSource())}return t}setLights(t){if(this._checkLoaded(),!t)return delete this.ambientLight,void delete this.directionalLight;const o=this._getTransitionParameters();for(const u of t){if(this._validate(r1,"lights",u))return;switch(u.type){case"ambient":if(this.ambientLight){const h=this.ambientLight;h.set(u),h.updateTransitions(o)}else this.ambientLight=new J6(u,mre,this.scope,this.options);break;case"directional":if(this.directionalLight){const h=this.directionalLight;h.set(u),h.updateTransitions(o)}else this.directionalLight=new J6(u,gre,this.scope,this.options)}}const c=new dr(this.z||0,o);this.ambientLight&&this.ambientLight.recalculate(c),this.directionalLight&&this.directionalLight.recalculate(c),this._brightness=this.calculateLightsBrightness(),this.dispatcher.broadcast("setBrightness",this._brightness)}calculateLightsBrightness(){const t=this.directionalLight,o=this.ambientLight;if(!t||!o)return;const c=E=>.2126*(E[0]<=.03928?E[0]/12.92:Math.pow((E[0]+.055)/1.055,2.4))+.7152*(E[1]<=.03928?E[1]/12.92:Math.pow((E[1]+.055)/1.055,2.4))+.0722*(E[2]<=.03928?E[2]/12.92:Math.pow((E[2]+.055)/1.055,2.4)),u=t.properties.get("color").toArray01(),h=t.properties.get("intensity"),m=t.properties.get("direction"),g=1-de(m.x,m.y,m.z)[2]/90,v=c(u)*h*g,x=o.properties.get("color").toArray01(),w=o.properties.get("intensity");return(v+c(x)*w)/2}getBrightness(){return this._brightness}getLights(){if(!this.enable3dLights())return null;const t=[];return this.directionalLight&&t.push(this.directionalLight.get()),this.ambientLight&&t.push(this.ambientLight.get()),t}enable3dLights(){return!!this.ambientLight&&!!this.directionalLight}getFragmentStyle(t){if(!t)return this;const o=this.fragments.find(({id:c})=>c===t);if(!o)throw new Error(`Style import not found: ${t}`);return o.style}setConfigProperty(t,o,c){const u=Hc(c);if(u.result!=="success")return void X1(this,u.value);const h=u.value.expression,m=this.getFragmentStyle(t);m.options.set(o,h);for(const g of m._configDependentLayers){const v=this.getLayer(g);v&&(v.possiblyEvaluateVisibility(),this._updateLayer(v))}this.ambientLight&&this.ambientLight.scope===t&&this.ambientLight.updateConfig(m.options),this.directionalLight&&this.directionalLight.scope===t&&this.directionalLight.updateConfig(m.options),this._changes.changed=!0}addLayer(t,o,c={}){this._checkLoaded();const u=t.id;if(this._layers[u])return void this.fire(new bn(new Error(`Layer with id "${u}" already exists on this map`)));let h;if(t.type==="custom"){if(X1(this,function(w){const E=[],C=w.id;return C===void 0&&E.push({message:`layers.${C}: missing required property "id"`}),w.render===void 0&&E.push({message:`layers.${C}: missing required method "render"`}),w.renderingMode&&w.renderingMode!=="2d"&&w.renderingMode!=="3d"&&E.push({message:`layers.${C}: property "renderingMode" must be either "2d" or "3d"`}),E}(t)))return;h=z2(t,this.options)}else{if(typeof t.source=="object"&&(this.addSource(u,t.source),t=Fe(t=ue(t),{source:u})),this._validate(Hu,`layers.${u}`,t,{arrayIndex:-1},c))return;h=z2(t,this.options),this._validateLayer(h),h.setEventedParent(this,{layer:{id:u}}),this._serializedLayers[h.id]=h.serialize()}h.isConfigDependent&&this._configDependentLayers.add(h.fqid),h.setScope(this.scope);const m=o?this._order.indexOf(o):this._order.length;if(o&&m===-1)return void this.fire(new bn(new Error(`Layer with id "${o}" does not exist on this map.`)));this._order.splice(m,0,u),this._layerOrderChanged=!0,this._layers[u]=h;const g=this.getOwnLayerSourceCache(h),v=!!this.directionalLight&&this.directionalLight.shadowsEnabled();g&&h.canCastShadows()&&v&&(g.castsShadows=!0);const x=this._changes.getRemovedLayer(h);if(x&&h.source&&g&&h.type!=="custom"){this._changes.discardLayerRemoval(h);const w=Ko(h.source,h.scope);x.type!==h.type?this._changes.updatedSourceCaches[w]="clear":(this._changes.updatedSourceCaches[w]="reload",g.pause())}this._updateLayer(h),h.onAdd&&h.onAdd(this.map),h.scope=this.scope,this.mergeLayers()}moveLayer(t,o){if(this._checkLoaded(),this._changes.changed=!0,!this._layers[t])return void this.fire(new bn(new Error(`The layer '${t}' does not exist in the map's style and cannot be moved.`)));if(t===o)return;const c=this._order.indexOf(t);this._order.splice(c,1);const u=o?this._order.indexOf(o):this._order.length;o&&u===-1?this.fire(new bn(new Error(`Layer with id "${o}" does not exist on this map.`))):(this._order.splice(u,0,t),this._layerOrderChanged=!0,this.mergeLayers())}removeLayer(t){this._checkLoaded();const o=this._layers[t];if(!o)return void this.fire(new bn(new Error(`The layer '${t}' does not exist in the map's style and cannot be removed.`)));o.setEventedParent(null);const c=this._order.indexOf(t);this._order.splice(c,1),delete this._layers[t],delete this._serializedLayers[t],this._changes.changed=!0,this._layerOrderChanged=!0,this._configDependentLayers.delete(o.fqid),this._changes.removeLayer(o);const u=this.getOwnLayerSourceCache(o);if(u&&u.castsShadows){let h=!1;for(const m in this._layers)if(this._layers[m].source===o.source&&this._layers[m].canCastShadows()){h=!0;break}u.castsShadows=h}o.onRemove&&o.onRemove(this.map),this.mergeLayers()}getOwnLayer(t){return this._layers[t]}hasLayer(t){return t in this._mergedLayers}hasLayerType(t){for(const o in this._layers)if(this._layers[o].type===t)return!0;return!1}setLayerZoomRange(t,o,c){this._checkLoaded();const u=this.getOwnLayer(t);u?u.minzoom===o&&u.maxzoom===c||(o!=null&&(u.minzoom=o),c!=null&&(u.maxzoom=c),this._updateLayer(u)):this.fire(new bn(new Error(`The layer '${t}' does not exist in the map's style and cannot have zoom extent.`)))}setFilter(t,o,c={}){this._checkLoaded();const u=this.getOwnLayer(t);if(u){if(!Q(u.filter,o))return o==null?(u.filter=void 0,void this._updateLayer(u)):void(this._validate(xf,`layers.${u.id}.filter`,o,{layerType:u.type},c)||(u.filter=ue(o),this._updateLayer(u)))}else this.fire(new bn(new Error(`The layer '${t}' does not exist in the map's style and cannot be filtered.`)))}getFilter(t){const o=this.getOwnLayer(t);if(o)return ue(o.filter);this.fire(new bn(new Error(`The layer '${t}' does not exist in the map's style and cannot be filtered.`)))}setLayoutProperty(t,o,c,u={}){this._checkLoaded();const h=this.getOwnLayer(t);h?Q(h.getLayoutProperty(o),c)||(h.setLayoutProperty(o,c,u),h.isConfigDependent&&this._configDependentLayers.add(h.fqid),this._updateLayer(h)):this.fire(new bn(new Error(`The layer '${t}' does not exist in the map's style and cannot be styled.`)))}getLayoutProperty(t,o){const c=this.getOwnLayer(t);if(c)return c.getLayoutProperty(o);this.fire(new bn(new Error(`The layer '${t}' does not exist in the map's style.`)))}setPaintProperty(t,o,c,u={}){this._checkLoaded();const h=this.getOwnLayer(t);if(!h)return void this.fire(new bn(new Error(`The layer '${t}' does not exist in the map's style and cannot be styled.`)));if(Q(h.getPaintProperty(o),c))return;const m=h.setPaintProperty(o,c,u);h.isConfigDependent&&this._configDependentLayers.add(h.fqid),m&&this._updateLayer(h),this._changes.changed=!0,this._changes.updatedPaintProps.add(h.fqid)}getPaintProperty(t,o){const c=this.getOwnLayer(t);if(c)return c.getPaintProperty(o);this.fire(new bn(new Error(`The layer '${t}' does not exist in the map's style and cannot be styled.`)))}setFeatureState(t,o){this._checkLoaded();const c=t.source,u=t.sourceLayer,h=this.getOwnSource(c);if(!h)return void this.fire(new bn(new Error(`The source '${c}' does not exist in the map's style.`)));const m=h.type;if(m==="geojson"&&u)return void this.fire(new bn(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if(m==="vector"&&!u)return void this.fire(new bn(new Error("The sourceLayer parameter must be provided for vector source types.")));t.id===void 0&&this.fire(new bn(new Error("The feature id parameter must be provided.")));const g=this.getOwnSourceCaches(c);for(const v of g)v.setFeatureState(u,t.id,o)}removeFeatureState(t,o){this._checkLoaded();const c=t.source,u=this.getOwnSource(c);if(!u)return void this.fire(new bn(new Error(`The source '${c}' does not exist in the map's style.`)));const h=u.type,m=h==="vector"?t.sourceLayer:void 0;if(h==="vector"&&!m)return void this.fire(new bn(new Error("The sourceLayer parameter must be provided for vector source types.")));if(o&&typeof t.id!="string"&&typeof t.id!="number")return void this.fire(new bn(new Error("A feature id is required to remove its specific state property.")));const g=this.getOwnSourceCaches(c);for(const v of g)v.removeFeatureState(m,t.id,o)}getFeatureState(t){this._checkLoaded();const o=t.source,c=t.sourceLayer,u=this.getOwnSource(o);if(u){if(u.type!=="vector"||c)return t.id===void 0&&this.fire(new bn(new Error("The feature id parameter must be provided."))),this.getOwnSourceCaches(o)[0].getFeatureState(c,t.id);this.fire(new bn(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new bn(new Error(`The source '${o}' does not exist in the map's style.`)))}setTransition(t){return this.stylesheet.transition=Fe({},this.stylesheet.transition,t),this.transition=this.stylesheet.transition,this}getTransition(){return Fe({},this.stylesheet.transition)}serialize(){this._checkLoaded();const t=this.getTerrain(),o=t&&this.terrain&&this.terrain.scope===this.scope?t:void 0;return Ue({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,imports:this._serializeImports(),schema:this.stylesheet.schema,camera:this.stylesheet.camera,light:this.stylesheet.light,lights:this.stylesheet.lights,terrain:o,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:this._serializeSources(),layers:this._serializeLayers(this._order)},c=>c!==void 0)}_updateLayer(t){this._changes.updateLayer(t);const o=this.getLayerSourceCache(t),c=Ko(t.source,t.scope);t.source&&!this._changes.updatedSourceCaches[c]&&o&&o.getSource().type!=="raster"&&(this._changes.updatedSourceCaches[c]="reload",o.pause()),this._changes.changed=!0,t.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(t){const o=g=>this._mergedLayers[g].type==="fill-extrusion",c=this.order,u={},h=[];for(let g=c.length-1;g>=0;g--){const v=c[g];if(o(v)){u[v]=g;for(const x of t){const w=x[v];if(w)for(const E of w)h.push(E)}}}h.sort((g,v)=>v.intersectionZ-g.intersectionZ);const m=[];for(let g=c.length-1;g>=0;g--){const v=c[g];if(o(v))for(let x=h.length-1;x>=0;x--){const w=h[x].feature;if(u[w.layer.id]<g)break;m.push(w),h.pop()}else for(const x of t){const w=x[v];if(w)for(const E of w)m.push(E.feature)}}return m}queryRenderedFeatures(t,o,c){o&&o.filter&&this._validate(xf,"queryRenderedFeatures.filter",o.filter,null,o),o.scope=this.scope,o.availableImages=this._availableImages,o.serializedLayers=this._serializedLayers;const u={};if(o&&o.layers){if(!Array.isArray(o.layers))return this.fire(new bn(new Error("parameters.layers must be an Array."))),[];for(const x of o.layers){const w=this._mergedLayers[x];if(!w)return this.fire(new bn(new Error(`The layer '${x}' does not exist in the map's style and cannot be queried for features.`))),[];u[w.source]=!0}}const h=[],m=o.serializedLayers||{},g=o&&o.layers?o.layers.some(x=>{const w=this.getLayer(x);return w&&w.is3D()}):this.has3DLayers(),v=cI.createFromScreenPoints(t,c);for(const x in this._mergedSourceCaches){const w=this._mergedSourceCaches[x].getSource();if(!w||w.scope!==o.scope)continue;const E=this._mergedSourceCaches[x].getSource().id;o.layers&&!u[E]||h.push(Ire(this._mergedSourceCaches[x],this._mergedLayers,m,v,o,c,g,!!this.map._showQueryGeometry))}return this.placement&&h.push(function(x,w,E,C,I,D,N){const W={},V=D.queryRenderedSymbols(C),q=[];for(const Z of Object.keys(V).map(Number))q.push(N[Z]);q.sort(gU);for(const Z of q){const K=Z.featureIndex.lookupSymbolFeatures(V[Z.bucketInstanceId],w,Z.bucketIndex,Z.sourceLayerIndex,I.filter,I.layers,I.availableImages,x);for(const X in K){const J=W[X]=W[X]||[],ae=K[X];ae.sort((ce,ge)=>{const ve=Z.featureSortOrder;if(ve){const Pe=ve.indexOf(ce.featureIndex);return ve.indexOf(ge.featureIndex)-Pe}return ge.featureIndex-ce.featureIndex});for(const ce of ae)J.push(ce)}}for(const Z in W)W[Z].forEach(K=>{const X=K.feature,J=E(x[Z]);if(!J)return;const ae=J.getFeatureState(X.layer["source-layer"],X.id);X.source=X.layer.source,X.layer["source-layer"]&&(X.sourceLayer=X.layer["source-layer"]),X.state=ae});return W}(this._mergedLayers,m,this.getLayerSourceCache.bind(this),v.screenGeometry,o,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(h)}querySourceFeatures(t,o){o&&o.filter&&this._validate(xf,"querySourceFeatures.filter",o.filter,null,o);const c=this.getOwnSourceCaches(t);let u=[];for(const h of c)u=u.concat(Rre(h,o));return u}addSourceType(t,o,c){return ru.getSourceType(t)?c(new Error(`A source type called "${t}" already exists.`)):(ru.setSourceType(t,o),o.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:t,url:o.workerSourceURL},c):c(null,null))}getFlatLight(){return this.light.getLight()}setFlatLight(t,o,c={}){this._checkLoaded();const u=this.light.getLight();let h=!1;for(const g in t)if(!Q(t[g],u[g])){h=!0;break}if(!h)return;const m=this._getTransitionParameters();this.light.setLight(t,o,c),this.light.updateTransitions(m)}getTerrain(){return this.terrain&&this.terrain.drapeRenderMode===1?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}setTerrain(t,o=1){if(this._checkLoaded(),!t)return delete this.terrain,delete this.stylesheet.terrain,this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);let c=t;if(o===1){if(typeof c.source=="object"){const u="terrain-dem-src";this.addSource(u,c.source),c=ue(c),c=Fe(c,{source:u})}if(this._validate(Gu,"terrain",c))return}if(!this.terrain||this.terrain&&o!==this.terrain.drapeRenderMode){if(!c)return;this._createTerrain(c,o),this.fire(new $t("data",{dataType:"style"}))}else{const u=this.terrain,h=u.get();for(const m of Object.keys(rt.terrain))!c.hasOwnProperty(m)&&rt.terrain[m].default&&(c[m]=rt.terrain[m].default);for(const m in t)if(!Q(t[m],h[m])){u.set(t),this.stylesheet.terrain=t;const g=this._getTransitionParameters({duration:0});u.updateTransitions(g),this.fire(new $t("data",{dataType:"style"}));break}}this.mergeTerrain(),this.updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(t){const o=this.fog=new hre(t,this.map.transform);this.stylesheet.fog=o.get();const c=this._getTransitionParameters({duration:0});o.updateTransitions(c)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask(()=>{for(const t of this.map._markers)t._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(t){if(this._checkLoaded(),!t)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const o=this.fog;if(!Q(o.get(),t)){o.set(t),this.stylesheet.fog=o.get();const c=this._getTransitionParameters({duration:0});o.updateTransitions(c)}}else this._createFog(t);this._markersNeedUpdate=!0}_getTransitionParameters(t){return{now:Pn.now(),transition:Fe(this.transition,t)}}updateDrapeFirstLayers(){if(!this.terrain)return;const t=[],o=[];for(const c in this._mergedLayers)this.isLayerDraped(this._mergedLayers[c])?t.push(c):o.push(c);this._drapedFirstOrder=[],this._drapedFirstOrder.push(...t),this._drapedFirstOrder.push(...o)}_createTerrain(t,o){const c=this.terrain=new ure(t,o);c.setScope(this.scope),this.stylesheet.terrain=t,this.mergeTerrain(),this.updateDrapeFirstLayers(),this._force3DLayerUpdate();const u=this._getTransitionParameters({duration:0});c.updateTransitions(u)}_force3DLayerUpdate(){for(const t in this._layers){const o=this._layers[t];o.type==="fill-extrusion"&&this._updateLayer(o)}}_forceSymbolLayerUpdate(){for(const t in this._layers){const o=this._layers[t];o.type==="symbol"&&this._updateLayer(o)}}_validate(t,o,c,u,h={}){if(h&&h.validate===!1)return!1;const m=Fe({},this.serialize());return X1(this,t.call(Vu,Fe({key:o,style:m,value:c,styleSpec:rt},u)))}_remove(){for(const{style:t}of this.fragments)t._remove();this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),rv.off("pluginStateChange",this._rtlTextPluginCallback),this.mergeLayers(),this.mergeSources();for(const t in this._layers)this._layers[t].setEventedParent(null);for(const t in this._sourceCaches)this._sourceCaches[t].clearTiles(),this._sourceCaches[t].setEventedParent(null);this.setEventedParent(null),delete this.ambientLight,delete this.directionalLight,this.importDepth===0&&(this.imageManager.setEventedParent(null),this.modelManager.setEventedParent(null),this.dispatcher.remove())}clearSource(t){const o=this.getSourceCaches(t);for(const c of o)c.clearTiles()}reloadSource(t){const o=this.getSourceCaches(t);for(const c of o)c.resume(),c.reload()}reloadSources(){for(const t of this.getSources())t.reload&&t.reload()}updateSources(t){let o;this.directionalLight&&(o=_8(this.directionalLight));for(const c in this._mergedSourceCaches)this._mergedSourceCaches[c].update(t,void 0,void 0,o)}_generateCollisionBoxes(){for(const t in this._sourceCaches){const o=this._sourceCaches[t];o.resume(),o.reload()}}_updatePlacement(t,o,c,u,h=!1){let m=!1,g=!1;const v={},x={};for(const w of this._mergedOrder){const E=this._mergedLayers[w];if(E.type!=="symbol")continue;if(!v[E.source]){const I=this.getLayerSourceCache(E);if(!I)continue;const D=I.getRenderableIds(!0).map(N=>I.getTileByID(N));x[E.source]=D.slice(),v[E.source]=D.sort((N,W)=>W.tileID.overscaledZ-N.tileID.overscaledZ||(N.tileID.isLessThan(W.tileID)?-1:1))}const C=this.crossTileSymbolIndex.addLayer(E,v[E.source],t.center.lng,t.projection);m=m||C}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._mergedOrder),h=h||this._layerOrderChanged||c===0,this._layerOrderChanged&&this.fire(new $t("neworder")),(h||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(Pn.now(),t.zoom))&&(this.pauseablePlacement=new Kre(t,this._mergedOrder,h,o,c,u,this.placement,this.fog&&t.projection.supportsFog?this.fog.state:null,this._buildingIndex),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._mergedOrder,this._mergedLayers,v,x),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(Pn.now()),g=!0),m&&this.pauseablePlacement.placement.setStale()),g||m)for(const w of this._mergedOrder){const E=this._mergedLayers[w];E.type==="symbol"&&this.placement.updateLayerOpacities(E,v[E.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(Pn.now())}_releaseSymbolFadeTiles(){for(const t in this._sourceCaches)this._sourceCaches[t].releaseSymbolFadeTiles()}addImport(t){this._checkLoaded();const o=this.stylesheet.imports;return o?o.findIndex(({id:u})=>u===t.id)!==-1?(this.fire(new bn(new Error(`Import with id '${t.id}' already exists in the map's style.`))),this):(this.stylesheet.imports?this.stylesheet.imports.push(t):this.stylesheet.imports=[t],this._loadImports([t],!0),this):this}setImportUrl(t,o){this._checkLoaded();const c=this.stylesheet.imports;if(!c)return this;const u=this.getImportIndex(t);if(u===-1)return this;c[u].url=o;const h=this.fragments[u];h.style=this._createFragmentStyle({id:t,url:o});const m=new Promise(g=>h.style.on("style.import.load",g));return h.style.loadURL(o),m.then(()=>this._reloadImports()),this}setImportData(t,o){this._checkLoaded();const c=this.stylesheet.imports;if(!c)return this;const u=this.getImportIndex(t);return u===-1?this:o?(this.fragments[u].style.setState(o),this._reloadImports(),this):(delete c[u].data,this.setImportUrl(t,c[u].url))}removeImport(t){this._checkLoaded();const o=this.stylesheet.imports;if(!o)return this;const c=this.getImportIndex(t);return c===-1||(o.splice(c,1),this.fragments[c].style._remove(),this.fragments.splice(c,1),this._reloadImports()),this}getImportIndex(t){const o=this.stylesheet.imports;if(!o)return-1;const c=o.findIndex(u=>u.id===t);return c===-1&&this.fire(new bn(new Error(`Import '${t}' does not exist in the map's style and cannot be updated.`))),c}getLayer(t){return this._mergedLayers[t]}getSources(){const t=[];for(const o in this._mergedOtherSourceCaches){const c=this._mergedOtherSourceCaches[o];c&&t.push(c.getSource())}return t}getSource(t,o){const c=this.getSourceCache(t,o);return c&&c.getSource()}getLayerSource(t){const o=this.getLayerSourceCache(t);return o&&o.getSource()}getSourceCache(t,o){const c=Ko(t,o);return this._mergedOtherSourceCaches[c]}getLayerSourceCache(t){const o=Ko(t.source,t.scope);return t.type==="symbol"?this._mergedSymbolSourceCaches[o]:this._mergedOtherSourceCaches[o]}getSourceCaches(t){const o=[];return this._mergedOtherSourceCaches[t]&&o.push(this._mergedOtherSourceCaches[t]),this._mergedSymbolSourceCaches[t]&&o.push(this._mergedSymbolSourceCaches[t]),o}updateSourceCaches(){for(const t in this._changes.updatedSourceCaches){const o=this._changes.updatedSourceCaches[t];o==="reload"?this.reloadSource(t):o==="clear"&&this.clearSource(t)}}updateLayers(t){for(const o of this._changes.updatedPaintProps){const c=this.getLayer(o);c&&c.updateTransitions(t)}}getImages(t,o,c){this.imageManager.getImages(o.icons,o.scope,c),this._updateTilesForChangedImages();const u=h=>{h&&h.setDependencies(o.tileID.key,o.type,o.icons)};u(this._otherSourceCaches[o.source]),u(this._symbolSourceCaches[o.source])}getGlyphs(t,o,c){this.glyphManager.getGlyphs(o.stacks,o.scope,c)}getResource(t,o,c){return et(o,c)}getOwnSourceCache(t){return this._otherSourceCaches[t]}getOwnLayerSourceCache(t){return t.type==="symbol"?this._symbolSourceCaches[t.source]:this._otherSourceCaches[t.source]}getOwnSourceCaches(t){const o=[];return this._otherSourceCaches[t]&&o.push(this._otherSourceCaches[t]),this._symbolSourceCaches[t]&&o.push(this._symbolSourceCaches[t]),o}_isSourceCacheLoaded(t){const o=this.getOwnSourceCaches(t);return o.length===0?(this.fire(new bn(new Error(`There is no source with ID '${t}'`))),!1):o.every(c=>c.loaded())}has3DLayers(){return this._has3DLayers}hasSymbolLayers(){return this._hasSymbolLayers}hasCircleLayers(){return this._hasCircleLayers}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}function w8(r,t){let o=!1,c=null;const u=()=>{c=null,o&&(r(),c=setTimeout(u,t),o=!1)};return()=>(o=!0,c||u(),c)}ru.getSourceType=function(r){return SI[r]},ru.setSourceType=function(r,t){SI[r]=t},ru.registerForPluginStateChange=function(r){return r({pluginStatus:Va,pluginURL:qc}),rv.on("pluginStateChange",r),r};class loe{constructor(t){this._hashName=t&&encodeURIComponent(t),pt(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=w8(this._updateHashUnthrottled.bind(this),300)}addTo(t){return this._map=t,p.addEventListener("hashchange",this._onHashChange,!1),t.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),p.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const t=this._map;if(!t)return"";const o=S8(t);if(this._hashName){const c=this._hashName;let u=!1;const h=p.location.hash.slice(1).split("&").map(m=>{const g=m.split("=")[0];return g===c?(u=!0,`${g}=${o}`):m}).filter(m=>m);return u||h.push(`${c}=${o}`),`#${h.join("&")}`}return`#${o}`}_getCurrentHash(){const t=p.location.hash.replace("#","");if(this._hashName){let o;return t.split("&").map(c=>c.split("=")).forEach(c=>{c[0]===this._hashName&&(o=c)}),(o&&o[1]||"").split("/")}return t.split("/")}_onHashChange(){const t=this._map;if(!t)return!1;const o=this._getCurrentHash();if(o.length>=3&&!o.some(c=>isNaN(c))){const c=t.dragRotate.isEnabled()&&t.touchZoomRotate.isEnabled()?+(o[3]||0):t.getBearing();return t.jumpTo({center:[+o[2],+o[1]],zoom:+o[0],bearing:c,pitch:+(o[4]||0)}),!0}return!1}_updateHashUnthrottled(){const t=p.location.href.replace(/(#.+)?$/,this.getHashString());p.history.replaceState(p.history.state,null,t)}}function S8(r,t){const o=r.getCenter(),c=Math.round(100*r.getZoom())/100,u=Math.ceil((c*Math.LN2+Math.log(512/360/.5))/Math.LN10),h=Math.pow(10,u),m=Math.round(o.lng*h)/h,g=Math.round(o.lat*h)/h,v=r.getBearing(),x=r.getPitch();let w=t?`/${m}/${g}/${c}`:`${c}/${g}/${m}`;return(v||x)&&(w+="/"+Math.round(10*v)/10),x&&(w+=`/${Math.round(x)}`),w}const J2={linearity:.3,easing:me(0,0,.3,1)},coe=Fe({deceleration:2500,maxSpeed:1400},J2),uoe=Fe({deceleration:20,maxSpeed:1400},J2),doe=Fe({deceleration:1e3,maxSpeed:360},J2),hoe=Fe({deceleration:1e3,maxSpeed:90},J2);class foe{constructor(t){this._map=t,this.clear()}clear(){this._inertiaBuffer=[]}record(t){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:Pn.now(),settings:t})}_drainInertiaBuffer(){const t=this._inertiaBuffer,o=Pn.now();for(;t.length>0&&o-t[0].time>160;)t.shift()}_onMoveEnd(t){if(this._map._prefersReducedMotion()||(this._drainInertiaBuffer(),this._inertiaBuffer.length<2))return;const o={zoom:0,bearing:0,pitch:0,pan:new G(0,0),pinchAround:void 0,around:void 0};for(const{settings:h}of this._inertiaBuffer)o.zoom+=h.zoomDelta||0,o.bearing+=h.bearingDelta||0,o.pitch+=h.pitchDelta||0,h.panDelta&&o.pan._add(h.panDelta),h.around&&(o.around=h.around),h.pinchAround&&(o.pinchAround=h.pinchAround);const c=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,u={};if(o.pan.mag()){const h=e3(o.pan.mag(),c,Fe({},coe,t||{}));u.offset=o.pan.mult(h.amount/o.pan.mag()),u.center=this._map.transform.center,Q2(u,h)}if(o.zoom){const h=e3(o.zoom,c,uoe);u.zoom=this._map.transform.zoom+h.amount,Q2(u,h)}if(o.bearing){const h=e3(o.bearing,c,doe);u.bearing=this._map.transform.bearing+re(h.amount,-179,179),Q2(u,h)}if(o.pitch){const h=e3(o.pitch,c,hoe);u.pitch=this._map.transform.pitch+h.amount,Q2(u,h)}if(u.zoom||u.bearing){const h=o.pinchAround===void 0?o.around:o.pinchAround;u.around=h?this._map.unproject(h):this._map.getCenter()}return this.clear(),u.noMoveStart=!0,u}}function Q2(r,t){(!r.duration||r.duration<t.duration)&&(r.duration=t.duration,r.easing=t.easing)}function e3(r,t,o){const{maxSpeed:c,linearity:u,deceleration:h}=o,m=re(r*u/(t/1e3),-c,c),g=Math.abs(m)/(h*u);return{easing:o.easing,duration:1e3*g,amount:m*(g/2)}}class Wl extends $t{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,o,c,u={}){const h=kl(o.getCanvasContainer(),c);super(t,Fe({point:h,lngLat:o.unproject(h),originalEvent:c},u)),this._defaultPrevented=!1,this.target=o}}class t3 extends $t{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,o,c){const u=t==="touchend"?c.changedTouches:c.touches,h=Dd(o.getCanvasContainer(),u),m=h.map(v=>o.unproject(v)),g=h.reduce((v,x,w,E)=>v.add(x.div(E.length)),new G(0,0));super(t,{points:h,point:g,lngLats:m,lngLat:o.unproject(g),originalEvent:c}),this._defaultPrevented=!1}}class poe extends $t{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,o,c){super(t,{originalEvent:c}),this._defaultPrevented=!1}}class moe{constructor(t,o){this._map=t,this._clickTolerance=o.clickTolerance}reset(){this._mousedownPos=void 0}wheel(t){return this._firePreventable(new poe(t.type,this._map,t))}mousedown(t,o){return this._mousedownPos=o,this._firePreventable(new Wl(t.type,this._map,t))}mouseup(t){this._map.fire(new Wl(t.type,this._map,t))}preclick(t){const o=Fe({},t);o.type="preclick",this._map.fire(new Wl(o.type,this._map,o))}click(t,o){this._mousedownPos&&this._mousedownPos.dist(o)>=this._clickTolerance||(this.preclick(t),this._map.fire(new Wl(t.type,this._map,t)))}dblclick(t){return this._firePreventable(new Wl(t.type,this._map,t))}mouseover(t){this._map.fire(new Wl(t.type,this._map,t))}mouseout(t){this._map.fire(new Wl(t.type,this._map,t))}touchstart(t){return this._firePreventable(new t3(t.type,this._map,t))}touchmove(t){this._map.fire(new t3(t.type,this._map,t))}touchend(t){this._map.fire(new t3(t.type,this._map,t))}touchcancel(t){this._map.fire(new t3(t.type,this._map,t))}_firePreventable(t){if(this._map.fire(t),t.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class goe{constructor(t){this._map=t}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(t){this._map.fire(new Wl(t.type,this._map,t))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Wl("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(t){this._delayContextMenu?this._contextMenuEvent=t:this._map.fire(new Wl(t.type,this._map,t)),this._map.listens("contextmenu")&&t.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class yoe{constructor(t,o){this._map=t,this._el=t.getCanvasContainer(),this._container=t.getContainer(),this._clickTolerance=o.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(t,o){this.isEnabled()&&t.shiftKey&&t.button===0&&(Vp(),this._startPos=this._lastPos=o,this._active=!0)}mousemoveWindow(t,o){if(!this._active)return;const c=o,u=this._startPos,h=this._lastPos;if(!u||!h||h.equals(c)||!this._box&&c.dist(u)<this._clickTolerance)return;this._lastPos=c,this._box||(this._box=Qn("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",t));const m=Math.min(u.x,c.x),g=Math.max(u.x,c.x),v=Math.min(u.y,c.y),x=Math.max(u.y,c.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${m}px,${v}px)`,this._box.style.width=g-m+"px",this._box.style.height=x-v+"px")})}mouseupWindow(t,o){if(!this._active)return;const c=this._startPos,u=o;if(c&&t.button===0){if(this.reset(),Ll(),c.x!==u.x||c.y!==u.y)return this._map.fire(new $t("boxzoomend",{originalEvent:t})),{cameraAnimation:h=>h.fitScreenCoordinates(c,u,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",t)}}keydown(t){this._active&&t.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",t))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),lc(),delete this._startPos,delete this._lastPos}_fireEvent(t,o){return this._map.fire(new $t(t,{originalEvent:o}))}}function FI(r,t){const o={};for(let c=0;c<r.length;c++)o[r[c].identifier]=t[c];return o}class voe{constructor(t){this.reset(),this.numTouches=t.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(t,o,c){(this.centroid||c.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===0&&(this.startTime=t.timeStamp),c.length===this.numTouches&&(this.centroid=function(u){const h=new G(0,0);for(const m of u)h._add(m);return h.div(u.length)}(o),this.touches=FI(c,o)))}touchmove(t,o,c){if(this.aborted||!this.centroid)return;const u=FI(c,o);for(const h in this.touches){const m=u[h];(!m||m.dist(this.touches[h])>30)&&(this.aborted=!0)}}touchend(t,o,c){if((!this.centroid||t.timeStamp-this.startTime>500)&&(this.aborted=!0),c.length===0){const u=!this.aborted&&this.centroid;if(this.reset(),u)return u}}}class BI{constructor(t){this.singleTap=new voe(t),this.numTaps=t.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(t,o,c){this.singleTap.touchstart(t,o,c)}touchmove(t,o,c){this.singleTap.touchmove(t,o,c)}touchend(t,o,c){const u=this.singleTap.touchend(t,o,c);if(u){const h=t.timeStamp-this.lastTime<500,m=!this.lastTap||this.lastTap.dist(u)<30;if(h&&m||this.reset(),this.count++,this.lastTime=t.timeStamp,this.lastTap=u,this.count===this.numTaps)return this.reset(),u}}}class _oe{constructor(){this._zoomIn=new BI({numTouches:1,numTaps:2}),this._zoomOut=new BI({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(t,o,c){this._zoomIn.touchstart(t,o,c),this._zoomOut.touchstart(t,o,c)}touchmove(t,o,c){this._zoomIn.touchmove(t,o,c),this._zoomOut.touchmove(t,o,c)}touchend(t,o,c){const u=this._zoomIn.touchend(t,o,c),h=this._zoomOut.touchend(t,o,c);return u?(this._active=!0,t.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:m=>m.easeTo({duration:300,zoom:m.getZoom()+1,around:m.unproject(u)},{originalEvent:t})}):h?(this._active=!0,t.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:m=>m.easeTo({duration:300,zoom:m.getZoom()-1,around:m.unproject(h)},{originalEvent:t})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const xoe={0:1,2:2};class UI{constructor(t){this.reset(),this._clickTolerance=t.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(t,o){return!1}_move(t,o){return{}}mousedown(t,o){if(this._lastPoint)return;const c=ef(t);this._correctButton(t,c)&&(this._lastPoint=o,this._eventButton=c)}mousemoveWindow(t,o){const c=this._lastPoint;if(c){if(t.preventDefault(),this._eventButton!=null&&function(u,h){const m=xoe[h];return u.buttons===void 0||(u.buttons&m)!==m}(t,this._eventButton))this.reset();else if(this._moved||!(o.dist(c)<this._clickTolerance))return this._moved=!0,this._lastPoint=o,this._move(c,o)}}mouseupWindow(t){this._lastPoint&&ef(t)===this._eventButton&&(this._moved&&Ll(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class boe extends UI{mousedown(t,o){super.mousedown(t,o),this._lastPoint&&(this._active=!0)}_correctButton(t,o){return o===0&&!t.ctrlKey}_move(t,o){return{around:o,panDelta:o.sub(t)}}}class E8 extends UI{_correctButton(t,o){return o===0&&t.ctrlKey||o===2}_move(t,o){const c=.8*(o.x-t.x);if(c)return this._active=!0,{bearingDelta:c}}contextmenu(t){t.preventDefault()}}class M8 extends UI{_correctButton(t,o){return o===0&&t.ctrlKey||o===2}_move(t,o){const c=-.5*(o.y-t.y);if(c)return this._active=!0,{pitchDelta:c}}contextmenu(t){t.preventDefault()}}class woe{constructor(t,o){this._map=t,this._el=t.getCanvasContainer(),this._minTouches=1,this._clickTolerance=o.clickTolerance||1,this.reset(),pt(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new G(0,0)}touchstart(t,o,c){return this._calculateTransform(t,o,c)}touchmove(t,o,c){if(this._active&&!(c.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(c.length===1&&!it())return void this._showTouchPanBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return t.cancelable&&t.preventDefault(),this._calculateTransform(t,o,c)}}touchend(t,o,c){this._calculateTransform(t,o,c),this._active&&c.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(t,o,c){c.length>0&&(this._active=!0);const u=FI(c,o),h=new G(0,0),m=new G(0,0);let g=0;for(const x in u){const w=u[x],E=this._touches[x];E&&(h._add(w),m._add(w.sub(E)),g++,u[x]=w)}if(this._touches=u,g<this._minTouches||!m.mag())return;const v=m.div(g);return this._sum._add(v),this._sum.mag()<this._clickTolerance?void 0:{around:h.div(g),panDelta:v}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=Qn("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","null")},500)}}class WI{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(t){}_move(t,o,c){return{}}touchstart(t,o,c){this._firstTwoTouches||c.length<2||(this._firstTwoTouches=[c[0].identifier,c[1].identifier],this._start([o[0],o[1]]))}touchmove(t,o,c){const u=this._firstTwoTouches;if(!u)return;t.preventDefault();const[h,m]=u,g=n3(c,o,h),v=n3(c,o,m);if(!g||!v)return;const x=this._aroundCenter?null:g.add(v).div(2);return this._move([g,v],x,t)}touchend(t,o,c){if(!this._firstTwoTouches)return;const[u,h]=this._firstTwoTouches,m=n3(c,o,u),g=n3(c,o,h);m&&g||(this._active&&Ll(),this.reset())}touchcancel(){this.reset()}enable(t){this._enabled=!0,this._aroundCenter=!!t&&t.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function n3(r,t,o){for(let c=0;c<r.length;c++)if(r[c].identifier===o)return t[c]}function T8(r,t){return Math.log(r/t)/Math.LN2}class Soe extends WI{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(t){this._startDistance=this._distance=t[0].dist(t[1])}_move(t,o){const c=this._distance;if(this._distance=t[0].dist(t[1]),this._active||!(Math.abs(T8(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:T8(this._distance,c),pinchAround:o}}}function A8(r,t){return 180*r.angleWith(t)/Math.PI}class Eoe extends WI{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(t){this._startVector=this._vector=t[0].sub(t[1]),this._minDiameter=t[0].dist(t[1])}_move(t,o){const c=this._vector;if(this._vector=t[0].sub(t[1]),c&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:A8(this._vector,c),pinchAround:o}}_isBelowThreshold(t){this._minDiameter=Math.min(this._minDiameter,t.mag());const o=25/(Math.PI*this._minDiameter)*360,c=this._startVector;if(!c)return!1;const u=A8(t,c);return Math.abs(u)<o}}function VI(r){return Math.abs(r.y)>Math.abs(r.x)}class Moe extends WI{constructor(t){super(),this._map=t}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(t){this._lastPoints=t,VI(t[0].sub(t[1]))&&(this._valid=!1)}_move(t,o,c){const u=this._lastPoints;if(!u)return;const h=t[0].sub(u[0]),m=t[1].sub(u[1]);return this._map._cooperativeGestures&&!it()&&c.touches.length<3||(this._valid=this.gestureBeginsVertically(h,m,c.timeStamp),!this._valid)?void 0:(this._lastPoints=t,this._active=!0,{pitchDelta:(h.y+m.y)/2*-.5})}gestureBeginsVertically(t,o,c){if(this._valid!==void 0)return this._valid;const u=t.mag()>=2,h=o.mag()>=2;if(!u&&!h)return;if(!u||!h)return this._firstMove==null&&(this._firstMove=c),c-this._firstMove<100&&void 0;const m=t.y>0==o.y>0;return VI(t)&&VI(o)&&m}}const Toe={panStep:100,bearingStep:15,pitchStep:10};class Aoe{constructor(){const t=Toe;this._panStep=t.panStep,this._bearingStep=t.bearingStep,this._pitchStep=t.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(t){if(t.altKey||t.ctrlKey||t.metaKey)return;let o=0,c=0,u=0,h=0,m=0;switch(t.keyCode){case 61:case 107:case 171:case 187:o=1;break;case 189:case 109:case 173:o=-1;break;case 37:t.shiftKey?c=-1:(t.preventDefault(),h=-1);break;case 39:t.shiftKey?c=1:(t.preventDefault(),h=1);break;case 38:t.shiftKey?u=1:(t.preventDefault(),m=-1);break;case 40:t.shiftKey?u=-1:(t.preventDefault(),m=1);break;default:return}return this._rotationDisabled&&(c=0,u=0),{cameraAnimation:g=>{const v=g.getZoom();g.easeTo({duration:300,easeId:"keyboardHandler",easing:Coe,zoom:o?Math.round(v)+o*(t.shiftKey?2:1):v,bearing:g.getBearing()+c*this._bearingStep,pitch:g.getPitch()+u*this._pitchStep,offset:[-h*this._panStep,-m*this._panStep],center:g.getCenter()},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Coe(r){return r*(2-r)}const C8=4.000244140625;class Poe{constructor(t,o){this._map=t,this._el=t.getCanvasContainer(),this._handler=o,this._delta=0,this._lastDelta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,pt(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(t){this._defaultZoomRate=t}setWheelZoomRate(t){this._wheelZoomRate=t}isEnabled(){return!!this._enabled}isActive(){return this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(t){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!t&&t.around==="center",this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(t){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(t.ctrlKey||t.metaKey||this.isZooming()||it()))return void this._showBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let o=t.deltaMode===p.WheelEvent.DOM_DELTA_LINE?40*t.deltaY:t.deltaY;const c=Pn.now(),u=c-(this._lastWheelEventTime||0);this._lastWheelEventTime=c,o!==0&&o%C8==0?this._type="wheel":o!==0&&Math.abs(o)<4?this._type="trackpad":u>400?(this._type=null,this._lastValue=o,this._timeout=setTimeout(this._onTimeout,40,t)):this._type||(this._type=Math.abs(u*o)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,o+=this._lastValue)),t.shiftKey&&o&&(o/=4),this._type&&(this._lastWheelEvent=t,this._delta-=o,this._active||this._start(t)),t.preventDefault()}_onTimeout(t){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(t)}_start(t){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const o=kl(this._el,t);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:o,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const t=this._map.transform;this._type==="wheel"&&t.projection.wrap&&(t._center.lng>=180||t._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const o=()=>t._terrainEnabled()&&this._aroundCoord?t.computeZoomRelativeTo(this._aroundCoord):t.zoom;if(this._delta!==0){const x=this._type==="wheel"&&Math.abs(this._delta)>C8?this._wheelZoomRate:this._defaultZoomRate;let w=2/(1+Math.exp(-Math.abs(this._delta*x)));this._delta<0&&w!==0&&(w=1/w);const E=o(),C=Math.pow(2,E),I=typeof this._targetZoom=="number"?t.zoomScale(this._targetZoom):C;this._targetZoom=Math.min(t.maxZoom,Math.max(t.minZoom,t.scaleZoom(I*w))),this._type==="wheel"&&(this._startZoom=E,this._easing=this._smoothOutEasing(200)),this._lastDelta=this._delta,this._delta=0}const c=typeof this._targetZoom=="number"?this._targetZoom:o(),u=this._startZoom,h=this._easing;let m,g=!1;if(this._type==="wheel"&&u&&h){const x=Math.min((Pn.now()-this._lastWheelEventTime)/200,1);m=kn(u,c,h(x)),x<1?this._frameId||(this._frameId=!0):g=!0}else m=c,g=!0;this._active=!0,g&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200));let v=m-o();return v*this._lastDelta<0&&(v=0),{noInertia:!0,needsRenderFrame:!g,zoomDelta:v,around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(t){let o=we;if(this._prevEase){const c=this._prevEase,u=(Pn.now()-c.start)/c.duration,h=c.easing(u+.01)-c.easing(u),m=.27/Math.sqrt(h*h+1e-4)*.01;o=me(m,Math.sqrt(.0729-m*m),.25,1)}return this._prevEase={start:Pn.now(),duration:t,easing:o},o}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=Qn("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(p.navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","null")},200)}}class Ioe{constructor(t,o){this._clickZoom=t,this._tapZoom=o}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Roe{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(t,o){return t.preventDefault(),{cameraAnimation:c=>{c.easeTo({duration:300,zoom:c.getZoom()+(t.shiftKey?-1:1),around:c.unproject(o)},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Loe{constructor(){this._tap=new BI({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(t,o,c){this._swipePoint||(this._tapTime&&t.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?c.length>0&&(this._swipePoint=o[0],this._swipeTouch=c[0].identifier):this._tap.touchstart(t,o,c))}touchmove(t,o,c){if(this._tapTime){if(this._swipePoint){if(c[0].identifier!==this._swipeTouch)return;const u=o[0],h=u.y-this._swipePoint.y;return this._swipePoint=u,t.preventDefault(),this._active=!0,{zoomDelta:h/128}}}else this._tap.touchmove(t,o,c)}touchend(t,o,c){this._tapTime?this._swipePoint&&c.length===0&&this.reset():this._tap.touchend(t,o,c)&&(this._tapTime=t.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class koe{constructor(t,o,c){this._el=t,this._mousePan=o,this._touchPan=c}enable(t){this._inertiaOptions=t||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Doe{constructor(t,o,c){this._pitchWithRotate=t.pitchWithRotate,this._mouseRotate=o,this._mousePitch=c}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class zoe{constructor(t,o,c,u){this._el=t,this._touchZoom=o,this._touchRotate=c,this._tapDragZoom=u,this._rotationDisabled=!1,this._enabled=!0}enable(t){this._touchZoom.enable(t),this._rotationDisabled||this._touchRotate.enable(t),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const i3=r=>r.zoom||r.drag||r.pitch||r.rotate;class Ooe extends $t{}class Noe{constructor(){this.constants=[1,1,.01],this.radius=0}setup(t,o){const c=De.sub([],o,t);this.radius=De.length(c[2]<0?De.div([],c,this.constants):[c[0],c[1],0])}projectRay(t){De.div(t,t,this.constants),De.normalize(t,t),De.mul(t,t,this.constants);const o=De.scale([],t,this.radius);if(o[2]>0){const c=De.scale([],[0,0,1],De.dot(o,[0,0,1])),u=De.scale([],De.normalize([],[o[0],o[1],0]),this.radius),h=De.add([],o,De.scale([],De.sub([],De.add([],u,c),o),2));o[0]=h[0],o[1]=h[1]}return o}}function r3(r){return r.panDelta&&r.panDelta.mag()||r.zoomDelta||r.bearingDelta||r.pitchDelta}class Foe{constructor(t,o){this._map=t,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new foe(t),this._bearingSnap=o.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new Noe,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(o),pt(["handleEvent","handleWindowEvent"],this);const c=this._el;this._listeners=[[c,"touchstart",{passive:!0}],[c,"touchmove",{passive:!1}],[c,"touchend",void 0],[c,"touchcancel",void 0],[c,"mousedown",void 0],[c,"mousemove",void 0],[c,"mouseup",void 0],[p.document,"mousemove",{capture:!0}],[p.document,"mouseup",void 0],[c,"mouseover",void 0],[c,"mouseout",void 0],[c,"dblclick",void 0],[c,"click",void 0],[c,"keydown",{capture:!1}],[c,"keyup",void 0],[c,"wheel",{passive:!1}],[c,"contextmenu",void 0],[p,"blur",void 0]];for(const[u,h,m]of this._listeners)u.addEventListener(h,u===p.document?this.handleWindowEvent:this.handleEvent,m)}destroy(){for(const[t,o,c]of this._listeners)t.removeEventListener(o,t===p.document?this.handleWindowEvent:this.handleEvent,c)}_addDefaultHandlers(t){const o=this._map,c=o.getCanvasContainer();this._add("mapEvent",new moe(o,t));const u=o.boxZoom=new yoe(o,t);this._add("boxZoom",u);const h=new _oe,m=new Roe;o.doubleClickZoom=new Ioe(m,h),this._add("tapZoom",h),this._add("clickZoom",m);const g=new Loe;this._add("tapDragZoom",g);const v=o.touchPitch=new Moe(o);this._add("touchPitch",v);const x=new E8(t),w=new M8(t);o.dragRotate=new Doe(t,x,w),this._add("mouseRotate",x,["mousePitch"]),this._add("mousePitch",w,["mouseRotate"]);const E=new boe(t),C=new woe(o,t);o.dragPan=new koe(c,E,C),this._add("mousePan",E),this._add("touchPan",C,["touchZoom","touchRotate"]);const I=new Eoe,D=new Soe;o.touchZoomRotate=new zoe(c,D,I,g),this._add("touchRotate",I,["touchPan","touchZoom"]),this._add("touchZoom",D,["touchPan","touchRotate"]),this._add("blockableMapEvent",new goe(o));const N=o.scrollZoom=new Poe(o,this);this._add("scrollZoom",N,["mousePan"]);const W=o.keyboard=new Aoe;this._add("keyboard",W);for(const V of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])t.interactive&&t[V]&&o[V].enable(t[V])}_add(t,o,c){this._handlers.push({handlerName:t,handler:o,allowed:c}),this._handlersById[t]=o}stop(t){if(!this._updatingCamera){for(const{handler:o}of this._handlers)o.reset();this._inertia.clear(),this._fireEvents({},{},t),this._changes=[],this._originalZoom=void 0}}isActive(){for(const{handler:t}of this._handlers)if(t.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!i3(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(t,o,c){for(const u in t)if(u!==c&&(!o||o.indexOf(u)<0))return!0;return!1}handleWindowEvent(t){this.handleEvent(t,`${t.type}Window`)}_getMapTouches(t){const o=[];for(const c of t)this._el.contains(c.target)&&o.push(c);return o}handleEvent(t,o){this._updatingCamera=!0;const c=t.type==="renderFrame",u=c?void 0:t,h={needsRenderFrame:!1},m={},g={},v=t.touches?this._getMapTouches(t.touches):void 0,x=v?Dd(this._el,v):c?void 0:kl(this._el,t);for(const{handlerName:C,handler:I,allowed:D}of this._handlers){if(!I.isEnabled())continue;let N;this._blockedByActive(g,D,C)?I.reset():I[o||t.type]&&(N=I[o||t.type](t,x,v),this.mergeHandlerResult(h,m,N,C,u),N&&N.needsRenderFrame&&this._triggerRenderFrame()),(N||I.isActive())&&(g[C]=I)}const w={};for(const C in this._previousActiveHandlers)g[C]||(w[C]=u);this._previousActiveHandlers=g,(Object.keys(w).length||r3(h))&&(this._changes.push([h,m,w]),this._triggerRenderFrame()),(Object.keys(g).length||r3(h))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:E}=h;E&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],E(this._map))}mergeHandlerResult(t,o,c,u,h){if(!c)return;Fe(t,c);const m={handlerName:u,originalEvent:c.originalEvent||h};c.zoomDelta!==void 0&&(o.zoom=m),c.panDelta!==void 0&&(o.drag=m),c.pitchDelta!==void 0&&(o.pitch=m),c.bearingDelta!==void 0&&(o.rotate=m)}_applyChanges(){const t={},o={},c={};for(const[u,h,m]of this._changes)u.panDelta&&(t.panDelta=(t.panDelta||new G(0,0))._add(u.panDelta)),u.zoomDelta&&(t.zoomDelta=(t.zoomDelta||0)+u.zoomDelta),u.bearingDelta&&(t.bearingDelta=(t.bearingDelta||0)+u.bearingDelta),u.pitchDelta&&(t.pitchDelta=(t.pitchDelta||0)+u.pitchDelta),u.around!==void 0&&(t.around=u.around),u.aroundCoord!==void 0&&(t.aroundCoord=u.aroundCoord),u.pinchAround!==void 0&&(t.pinchAround=u.pinchAround),u.noInertia&&(t.noInertia=u.noInertia),Fe(o,h),Fe(c,m);this._updateMapTransform(t,o,c),this._changes=[]}_updateMapTransform(t,o,c){const u=this._map,h=u.transform,m=q=>[q.x,q.y,q.z];if((q=>{const Z=this._eventsInProgress.drag;return Z&&!this._handlersById[Z.handlerName].isActive()})()&&!r3(t)){const q=h.zoom;h.cameraElevationReference="sea",this._originalZoom!=null&&h._orthographicProjectionAtLowPitch&&h.projection.name!=="globe"&&h.pitch===0?(h.cameraElevationReference="ground",h.zoom=this._originalZoom):(h.recenterOnTerrain(),h.cameraElevationReference="ground"),q!==h.zoom&&this._map._update(!0)}if(h._isCameraConstrained&&u._stop(!0),!r3(t))return void this._fireEvents(o,c,!0);let{panDelta:g,zoomDelta:v,bearingDelta:x,pitchDelta:w,around:E,aroundCoord:C,pinchAround:I}=t;h._isCameraConstrained&&(v>0&&(v=0),h._isCameraConstrained=!1),I!==void 0&&(E=I),(v||(q=>o[q]&&!this._eventsInProgress[q])("drag"))&&E&&(this._dragOrigin=m(h.pointCoordinate3D(E)),this._originalZoom=h.zoom,this._trackingEllipsoid.setup(h._camera.position,this._dragOrigin)),h.cameraElevationReference="sea",u._stop(!0),E=E||u.transform.centerPoint,x&&(h.bearing+=x),w&&(h.pitch+=w),h._updateCameraState();const D=[0,0,0];if(g)if(h.projection.name==="mercator"){const q=this._trackingEllipsoid.projectRay(h.screenPointToMercatorRay(E).dir),Z=this._trackingEllipsoid.projectRay(h.screenPointToMercatorRay(E.sub(g)).dir);D[0]=Z[0]-q[0],D[1]=Z[1]-q[1]}else{const q=h.pointCoordinate(E);if(h.projection.name==="globe"){g=g.rotate(-h.angle);const Z=h._pixelsPerMercatorPixel/h.worldSize;D[0]=-g.x*yP(_a(q.y))*Z,D[1]=-g.y*yP(h.center.lat)*Z}else{const Z=h.pointCoordinate(E.sub(g));q&&Z&&(D[0]=Z.x-q.x,D[1]=Z.y-q.y)}}const N=h.zoom,W=[0,0,0];if(v){const q=m(C||h.pointCoordinate3D(E)),Z={dir:De.normalize([],De.sub([],q,h._camera.position))};if(Z.dir[2]<0){const K=h.zoomDeltaToMovement(q,v);De.scale(W,Z.dir,K)}}const V=De.add(D,D,W);h._translateCameraConstrained(V),v&&Math.abs(h.zoom-N)>1e-4&&h.recenterOnTerrain(),h.cameraElevationReference="ground",this._map._update(),t.noInertia||this._inertia.record(t),this._fireEvents(o,c,!0)}_fireEvents(t,o,c){const u=i3(this._eventsInProgress),h=i3(t),m={};for(const w in t){const{originalEvent:E}=t[w];this._eventsInProgress[w]||(m[`${w}start`]=E),this._eventsInProgress[w]=t[w]}!u&&h&&this._fireEvent("movestart",h.originalEvent);for(const w in m)this._fireEvent(w,m[w]);h&&this._fireEvent("move",h.originalEvent);for(const w in t){const{originalEvent:E}=t[w];this._fireEvent(w,E)}const g={};let v;for(const w in this._eventsInProgress){const{handlerName:E,originalEvent:C}=this._eventsInProgress[w];this._handlersById[E].isActive()||(delete this._eventsInProgress[w],v=o[E]||C,g[`${w}end`]=v)}for(const w in g)this._fireEvent(w,g[w]);const x=i3(this._eventsInProgress);if(c&&(u||h)&&!x){this._updatingCamera=!0;const w=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),E=C=>C!==0&&-this._bearingSnap<C&&C<this._bearingSnap;w?(E(w.bearing||this._map.getBearing())&&(w.bearing=0),this._map.easeTo(w,{originalEvent:v})):(this._map.fire(new $t("moveend",{originalEvent:v})),E(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(t,o){this._map.fire(new $t(t,o?{originalEvent:o}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(t=>{this._frameId=void 0,this.handleEvent(new Ooe("renderFrame",{timeStamp:t})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const P8="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class Boe extends Vn{constructor(t,o){super(),this._moving=!1,this._zooming=!1,this.transform=t,this._bearingSnap=o.bearingSnap,this._respectPrefersReducedMotion=o.respectPrefersReducedMotion!==!1,pt(["_renderFrameCallback"],this)}getCenter(){return new Nn(this.transform.center.lng,this.transform.center.lat)}setCenter(t,o){return this.jumpTo({center:t},o)}panBy(t,o,c){return t=G.convert(t).mult(-1),this.panTo(this.transform.center,Fe({offset:t},o),c)}panTo(t,o,c){return this.easeTo(Fe({center:t},o),c)}getZoom(){return this.transform.zoom}setZoom(t,o){return this.jumpTo({zoom:t},o),this}zoomTo(t,o,c){return this.easeTo(Fe({zoom:t},o),c)}zoomIn(t,o){return this.zoomTo(this.getZoom()+1,t,o),this}zoomOut(t,o){return this.zoomTo(this.getZoom()-1,t,o),this}getBearing(){return this.transform.bearing}setBearing(t,o){return this.jumpTo({bearing:t},o),this}getPadding(){return this.transform.padding}setPadding(t,o){return this.jumpTo({padding:t},o),this}rotateTo(t,o,c){return this.easeTo(Fe({bearing:t},o),c)}resetNorth(t,o){return this.rotateTo(0,Fe({duration:1e3},t),o),this}resetNorthPitch(t,o){return this.easeTo(Fe({bearing:0,pitch:0,duration:1e3},t),o),this}snapToNorth(t,o){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(t,o):this}getPitch(){return this.transform.pitch}setPitch(t,o){return this.jumpTo({pitch:t},o),this}cameraForBounds(t,o){t=Fl.convert(t);const c=o&&o.bearing||0,u=o&&o.pitch||0,h=t.getNorthWest(),m=t.getSouthEast();return this._cameraForBounds(this.transform,h,m,c,u,o)}_extendCameraOptions(t){const o={top:0,bottom:0,right:0,left:0};if(typeof(t=Fe({padding:o,offset:[0,0],maxZoom:this.transform.maxZoom},t)).padding=="number"){const c=t.padding;t.padding={top:c,bottom:c,right:c,left:c}}return t.padding=Fe(o,t.padding),t}_minimumAABBFrustumDistance(t,o){const c=o.max[0]-o.min[0],u=o.max[1]-o.min[1];return c/u>t.aspect?c/(2*Math.tan(.5*t.fovX)*t.aspect):u/(2*Math.tan(.5*t.fovY)*t.aspect)}_cameraForBoundsOnGlobe(t,o,c,u,h,m){const g=t.clone(),v=this._extendCameraOptions(m);g.bearing=u,g.pitch=h;const x=Nn.convert(o),w=Nn.convert(c),E=.5*(x.lat+w.lat),C=.5*(x.lng+w.lng),I=Us(E,C),D=De.normalize([],I),N=De.normalize([],De.cross([],D,[0,1,0])),W=De.cross([],N,D),V=[N[0],N[1],N[2],0,W[0],W[1],W[2],0,D[0],D[1],D[2],0,0,0,0,1],q=[I,Us(x.lat,x.lng),Us(w.lat,x.lng),Us(w.lat,w.lng),Us(x.lat,w.lng),Us(E,x.lng),Us(E,w.lng),Us(x.lat,C),Us(w.lat,C)];let Z=_r.fromPoints(q.map(je=>[De.dot(N,je),De.dot(W,je),De.dot(D,je)]));const K=De.transformMat4([],Z.center,V);De.squaredLength(K)===0&&De.set(K,0,0,1),De.normalize(K,K),De.scale(K,K,fs),g.center=function([je,ot,yt]){const ft=Math.hypot(je,ot,yt),Lt=Math.atan2(je,yt),Ft=.5*Math.PI-Math.acos(-ot/ft);return new Nn(fe(Lt),fe(Ft))}(K);const X=g.getWorldToCameraMatrix(),J=at.invert(new Float64Array(16),X);Z=_r.applyTransform(Z,at.multiply([],X,V)),De.transformMat4(K,K,X);const ae=.5*(Z.max[2]-Z.min[2]),ce=this._minimumAABBFrustumDistance(g,Z),ge=De.scale([],[0,0,1],ae),ve=De.add(ge,K,ge),Pe=ce+(g.pitch===0?0:De.distance(K,ve)),Me=g.globeCenterInViewSpace,Le=De.sub([],K,[Me[0],Me[1],Me[2]]);De.normalize(Le,Le),De.scale(Le,Le,Pe);const Ee=De.add([],K,Le);De.transformMat4(Ee,Ee,J);const He=fv/fs,Ke=De.length(Ee),nt=Xi(Math.max(Ke*He-fv,Number.EPSILON),0),Ve=Math.min(g.zoomFromMercatorZAdjusted(nt),v.maxZoom);return Ve>.5*(y1+Mf)?(g.setProjection({name:"mercator"}),g.zoom=Ve,this._cameraForBounds(g,o,c,u,h,m)):{center:g.center,zoom:Ve,bearing:u,pitch:h}}queryTerrainElevation(t,o){const c=this.transform.elevation;return c?(o=Fe({},{exaggerated:!0},o),c.getAtPoint(bi.fromLngLat(t),null,o.exaggerated)):null}_cameraForBounds(t,o,c,u,h,m){if(t.projection.name==="globe")return this._cameraForBoundsOnGlobe(t,o,c,u,h,m);const g=t.clone(),v=this._extendCameraOptions(m),x=g.padding;g.bearing=u,g.pitch=h;const w=Nn.convert(o),E=Nn.convert(c),C=new Nn(w.lng,E.lat),I=new Nn(E.lng,w.lat),D=g.project(w),N=g.project(E),W=this.queryTerrainElevation(w),V=this.queryTerrainElevation(E),q=this.queryTerrainElevation(C),Z=this.queryTerrainElevation(I),K=[[D.x,D.y,Math.min(W||0,V||0,q||0,Z||0)],[N.x,N.y,Math.max(W||0,V||0,q||0,Z||0)]];let X=_r.fromPoints(K);const J=g.getWorldToCameraMatrix(),ae=at.invert(new Float64Array(16),J);X=_r.applyTransform(X,J);const ce=De.sub([],X.max,X.min),ge=x.left||0,ve=x.right||0,Pe=x.bottom||0,Me=x.top||0,{left:Le,right:Ee,top:He,bottom:Ke}=v.padding,nt=.5*(ge+ve),Ve=.5*(Me+Pe),je=Math.min(g.scaleZoom(g.scale*Math.min((g.width-(ge+ve+Le+Ee))/ce[0],(g.height-(Pe+Me+Ke+He))/ce[1])),v.maxZoom),ot=g.scale/g.zoomScale(je);X=new _r([X.min[0]-(Le+nt)*ot,X.min[1]-(Ke+Ve)*ot,X.min[2]],[X.max[0]+(Ee+nt)*ot,X.max[1]+(He+Ve)*ot,X.max[2]]);const yt=.5*ce[2],ft=this._minimumAABBFrustumDistance(g,X),Lt=[0,0,1,0];Yi.transformMat4(Lt,Lt,J),Yi.normalize(Lt,Lt);const Ft=De.scale([],Lt,ft+yt),St=De.add([],X.center,Ft),Ct=(typeof v.offset.x=="number"&&typeof v.offset.y=="number"?new G(v.offset.x,v.offset.y):G.convert(v.offset)).rotate(-ye(u));X.center[0]-=Ct.x*ot,X.center[1]+=Ct.y*ot,De.transformMat4(X.center,X.center,ae),De.transformMat4(St,St,ae);const rn=[X.center[0],X.center[1],St[2]*g.pixelsPerMeter];De.scale(rn,rn,1/g.worldSize);const ln=ul(rn[0]),sn=_a(rn[1]),un=Math.min(g._zoomFromMercatorZ(rn[2]),v.maxZoom),vn=new Nn(ln,sn);return g.mercatorFromTransition&&un<.5*(y1+Mf)?(g.setProjection({name:"globe"}),g.zoom=un,this._cameraForBounds(g,o,c,u,h,m)):{center:vn,zoom:un,bearing:u,pitch:h}}fitBounds(t,o,c){const u=this.cameraForBounds(t,o);return this._fitInternal(u,o,c)}fitScreenCoordinates(t,o,c,u,h){const m=G.convert(t),g=G.convert(o),v=new G(Math.min(m.x,g.x),Math.min(m.y,g.y)),x=new G(Math.max(m.x,g.x),Math.max(m.y,g.y));if(this.transform.projection.name==="mercator"&&this.transform.anyCornerOffEdge(m,g))return this;const w=this.transform.pointLocation3D(v),E=this.transform.pointLocation3D(x),C=this.transform.pointLocation3D(new G(v.x,x.y)),I=this.transform.pointLocation3D(new G(x.x,v.y)),D=[Math.min(w.lng,E.lng,C.lng,I.lng),Math.min(w.lat,E.lat,C.lat,I.lat)],N=[Math.max(w.lng,E.lng,C.lng,I.lng),Math.max(w.lat,E.lat,C.lat,I.lat)],W=u&&u.pitch?u.pitch:this.getPitch(),V=this._cameraForBounds(this.transform,D,N,c,W,u);return this._fitInternal(V,u,h)}_fitInternal(t,o,c){return t?(delete(o=Fe(t,o)).padding,o.linear?this.easeTo(o,c):this.flyTo(o,c)):this}jumpTo(t,o){this.stop();const c=t.preloadOnly?this.transform.clone():this.transform;let u=!1,h=!1,m=!1;return"zoom"in t&&c.zoom!==+t.zoom&&(u=!0,c.zoom=+t.zoom),t.center!==void 0&&(c.center=Nn.convert(t.center)),"bearing"in t&&c.bearing!==+t.bearing&&(h=!0,c.bearing=+t.bearing),"pitch"in t&&c.pitch!==+t.pitch&&(m=!0,c.pitch=+t.pitch),t.padding==null||c.isPaddingEqual(t.padding)||(c.padding=t.padding),t.preloadOnly?(this._preloadTiles(c),this):(this.fire(new $t("movestart",o)).fire(new $t("move",o)),u&&this.fire(new $t("zoomstart",o)).fire(new $t("zoom",o)).fire(new $t("zoomend",o)),h&&this.fire(new $t("rotatestart",o)).fire(new $t("rotate",o)).fire(new $t("rotateend",o)),m&&this.fire(new $t("pitchstart",o)).fire(new $t("pitch",o)).fire(new $t("pitchend",o)),this.fire(new $t("moveend",o)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||xe(P8),this.transform.getFreeCameraOptions()}setFreeCameraOptions(t,o){const c=this.transform;if(!c.projection.supportsFreeCamera)return xe(P8),this;this.stop();const u=c.zoom,h=c.pitch,m=c.bearing;c.setFreeCameraOptions(t);const g=u!==c.zoom,v=h!==c.pitch,x=m!==c.bearing;return this.fire(new $t("movestart",o)).fire(new $t("move",o)),g&&this.fire(new $t("zoomstart",o)).fire(new $t("zoom",o)).fire(new $t("zoomend",o)),x&&this.fire(new $t("rotatestart",o)).fire(new $t("rotate",o)).fire(new $t("rotateend",o)),v&&this.fire(new $t("pitchstart",o)).fire(new $t("pitch",o)).fire(new $t("pitchend",o)),this.fire(new $t("moveend",o)),this}easeTo(t,o){this._stop(!1,t.easeId),((t=Fe({offset:[0,0],duration:500,easing:we},t)).animate===!1||this._prefersReducedMotion(t))&&(t.duration=0);const c=this.transform,u=this.getZoom(),h=this.getBearing(),m=this.getPitch(),g=this.getPadding(),v="zoom"in t?+t.zoom:u,x="bearing"in t?this._normalizeBearing(t.bearing,h):h,w="pitch"in t?+t.pitch:m,E="padding"in t?t.padding:c.padding,C=G.convert(t.offset);let I,D,N;if(c.projection.name==="globe"){const ge=bi.fromLngLat(c.center),ve=C.rotate(-c.angle);ge.x+=ve.x/c.worldSize,ge.y+=ve.y/c.worldSize;const Pe=ge.toLngLat(),Me=Nn.convert(t.center||Pe);this._normalizeCenter(Me),I=c.centerPoint.add(ve),D=new G(ge.x,ge.y).mult(c.worldSize),N=new G(xo(Me.lng),Io(Me.lat)).mult(c.worldSize).sub(D)}else{I=c.centerPoint.add(C);const ge=c.pointLocation(I),ve=Nn.convert(t.center||ge);this._normalizeCenter(ve),D=c.project(ge),N=c.project(ve).sub(D)}const W=c.zoomScale(v-u);let V,q;t.around&&(V=Nn.convert(t.around),q=c.locationPoint(V));const Z=this._zooming||v!==u,K=this._rotating||h!==x,X=this._pitching||w!==m,J=!c.isPaddingEqual(E),ae=ge=>ve=>{if(Z&&(ge.zoom=kn(u,v,ve)),K&&(ge.bearing=kn(h,x,ve)),X&&(ge.pitch=kn(m,w,ve)),J&&(ge.interpolatePadding(g,E,ve),I=ge.centerPoint.add(C)),V)ge.setLocationAtPoint(V,q);else{const Pe=ge.zoomScale(ge.zoom-u),Me=v>u?Math.min(2,W):Math.max(.5,W),Le=Math.pow(Me,1-ve),Ee=ge.unproject(D.add(N.mult(ve*Le)).mult(Pe));ge.setLocationAtPoint(ge.renderWorldCopies?Ee.wrap():Ee,I)}return t.preloadOnly||this._fireMoveEvents(o),ge};if(t.preloadOnly){const ge=this._emulate(ae,t.duration,c);return this._preloadTiles(ge),this}const ce={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=Z,this._rotating=K,this._pitching=X,this._padding=J,this._easeId=t.easeId,this._prepareEase(o,t.noMoveStart,ce),this._ease(ae(c),ge=>{c.cameraElevationReference==="sea"&&c.recenterOnTerrain(),this._afterEase(o,ge)},t),this}_prepareEase(t,o,c={}){this._moving=!0,this.transform.cameraElevationReference="sea",this.transform._orthographicProjectionAtLowPitch&&this.transform.pitch===0&&this.transform.projection.name!=="globe"&&(this.transform.cameraElevationReference="ground"),o||c.moving||this.fire(new $t("movestart",t)),this._zooming&&!c.zooming&&this.fire(new $t("zoomstart",t)),this._rotating&&!c.rotating&&this.fire(new $t("rotatestart",t)),this._pitching&&!c.pitching&&this.fire(new $t("pitchstart",t))}_fireMoveEvents(t){this.fire(new $t("move",t)),this._zooming&&this.fire(new $t("zoom",t)),this._rotating&&this.fire(new $t("rotate",t)),this._pitching&&this.fire(new $t("pitch",t))}_afterEase(t,o){if(this._easeId&&o&&this._easeId===o)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const c=this._zooming,u=this._rotating,h=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,c&&this.fire(new $t("zoomend",t)),u&&this.fire(new $t("rotateend",t)),h&&this.fire(new $t("pitchend",t)),this.fire(new $t("moveend",t))}flyTo(t,o){if(this._prefersReducedMotion(t)){const je=ct(t,["center","zoom","bearing","pitch","around"]);return this.jumpTo(je,o)}this.stop(),t=Fe({offset:[0,0],speed:1.2,curve:1.42,easing:we},t);const c=this.transform,u=this.getZoom(),h=this.getBearing(),m=this.getPitch(),g=this.getPadding(),v="zoom"in t?re(+t.zoom,c.minZoom,c.maxZoom):u,x="bearing"in t?this._normalizeBearing(t.bearing,h):h,w="pitch"in t?+t.pitch:m,E="padding"in t?t.padding:c.padding,C=c.zoomScale(v-u),I=G.convert(t.offset);let D=c.centerPoint.add(I);const N=c.pointLocation(D),W=Nn.convert(t.center||N);this._normalizeCenter(W);const V=c.project(N),q=c.project(W).sub(V);let Z=t.curve;const K=Math.max(c.width,c.height),X=K/C,J=q.mag();if("minZoom"in t){const je=re(Math.min(t.minZoom,u,v),c.minZoom,c.maxZoom),ot=K/c.zoomScale(je-u);Z=Math.sqrt(ot/J*2)}const ae=Z*Z;function ce(je){const ot=(X*X-K*K+(je?-1:1)*ae*ae*J*J)/(2*(je?X:K)*ae*J);return Math.log(Math.sqrt(ot*ot+1)-ot)}function ge(je){return(Math.exp(je)-Math.exp(-je))/2}function ve(je){return(Math.exp(je)+Math.exp(-je))/2}const Pe=ce(0);let Me=function(je){return ve(Pe)/ve(Pe+Z*je)},Le=function(je){return K*((ve(Pe)*(ge(ot=Pe+Z*je)/ve(ot))-ge(Pe))/ae)/J;var ot},Ee=(ce(1)-Pe)/Z;if(Math.abs(J)<1e-6||!isFinite(Ee)){if(Math.abs(K-X)<1e-6)return this.easeTo(t,o);const je=X<K?-1:1;Ee=Math.abs(Math.log(X/K))/Z,Le=function(){return 0},Me=function(ot){return Math.exp(je*Z*ot)}}t.duration="duration"in t?+t.duration:1e3*Ee/("screenSpeed"in t?+t.screenSpeed/Z:+t.speed),t.maxDuration&&t.duration>t.maxDuration&&(t.duration=0);const He=h!==x,Ke=w!==m,nt=!c.isPaddingEqual(E),Ve=je=>ot=>{const yt=ot*Ee,ft=1/Me(yt);je.zoom=ot===1?v:u+je.scaleZoom(ft),He&&(je.bearing=kn(h,x,ot)),Ke&&(je.pitch=kn(m,w,ot)),nt&&(je.interpolatePadding(g,E,ot),D=je.centerPoint.add(I));const Lt=ot===1?W:je.unproject(V.add(q.mult(Le(yt))).mult(ft));return je.setLocationAtPoint(je.renderWorldCopies?Lt.wrap():Lt,D),je._updateCameraOnTerrain(),t.preloadOnly||this._fireMoveEvents(o),je};if(t.preloadOnly){const je=this._emulate(Ve,t.duration,c);return this._preloadTiles(je),this}return this._zooming=!0,this._rotating=He,this._pitching=Ke,this._padding=nt,this._prepareEase(o,!1),this._ease(Ve(c),()=>this._afterEase(o),t),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(t,o){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const c=this._onEaseEnd;this._onEaseEnd=void 0,c.call(this,o)}if(!t){const c=this.handlers;c&&c.stop(!1)}return this}_ease(t,o,c){c.animate===!1||c.duration===0?(t(1),o()):(this._easeStart=Pn.now(),this._easeOptions=c,this._onEaseFrame=t,this._onEaseEnd=o,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const t=Math.min((Pn.now()-this._easeStart)/this._easeOptions.duration,1),o=this._onEaseFrame;o&&o(this._easeOptions.easing(t)),t<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(t,o){t=Je(t,-180,180);const c=Math.abs(t-o);return Math.abs(t-360-o)<c&&(t-=360),Math.abs(t+360-o)<c&&(t+=360),t}_normalizeCenter(t){const o=this.transform;if(!o.renderWorldCopies||o.maxBounds)return;const c=t.lng-o.center.lng;t.lng+=c>180?-360:c<-180?360:0}_prefersReducedMotion(t){return this._respectPrefersReducedMotion&&Pn.prefersReducedMotion&&!(t&&t.essential)}_emulate(t,o,c){const u=Math.ceil(15*o/1e3),h=[],m=t(c.clone());for(let g=0;g<=u;g++){const v=m(g/u);h.push(v.clone())}return h}}class I8{constructor(t={}){this.options=t,pt(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(t){const o=this.options&&this.options.compact;return this._map=t,this._container=Qn("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=Qn("button","mapboxgl-ctrl-attrib-button",this._container),Qn("span","mapboxgl-ctrl-icon",this._compactButton).setAttribute("aria-hidden","true"),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=Qn("div","mapboxgl-ctrl-attrib-inner",this._container),o&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),o===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(t,o){const c=this._map._getUIString(`AttributionControl.${o}`);t.setAttribute("aria-label",c),t.removeAttribute("title"),t.firstElementChild&&t.firstElementChild.setAttribute("title",c)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let t=this._editLink;t||(t=this._editLink=this._container.querySelector(".mapbox-improve-map"));const o=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||b.ACCESS_TOKEN}];if(t){const c=o.reduce((u,h,m)=>(h.value&&(u+=`${h.key}=${h.value}${m<o.length-1?"&":""}`),u),"?");t.href=`${b.FEEDBACK_URL}/${c}#${S8(this._map,!0)}`,t.rel="noopener nofollow",this._setElementTitle(t,"MapFeedback")}}_updateData(t){!t||t.sourceDataType!=="metadata"&&t.sourceDataType!=="visibility"&&t.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let t=[];if(this._map.style.stylesheet){const u=this._map.style.stylesheet;this.styleOwner=u.owner,this.styleId=u.id}const o=this._map.style._sourceCaches;for(const u in o){const h=o[u];if(h.used){const m=h.getSource();m.attribution&&t.indexOf(m.attribution)<0&&t.push(m.attribution)}}t.sort((u,h)=>u.length-h.length),t=t.filter((u,h)=>{for(let m=h+1;m<t.length;m++)if(t[m].indexOf(u)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?t=[...this.options.customAttribution,...t]:t.unshift(this.options.customAttribution));const c=t.join(" | ");c!==this._attribHTML&&(this._attribHTML=c,t.length?(this._innerContainer.innerHTML=c,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class R8{constructor(){pt(["_updateLogo","_updateCompact"],this)}onAdd(t){this._map=t,this._container=Qn("div","mapboxgl-ctrl");const o=Qn("a","mapboxgl-ctrl-logo");return o.target="_blank",o.rel="noopener nofollow",o.href="https://www.mapbox.com/",o.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),o.setAttribute("rel","noopener nofollow"),this._container.appendChild(o),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(t){t&&t.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const t=this._map.style._sourceCaches;if(Object.entries(t).length===0)return!0;for(const o in t){const c=t[o].getSource();if(c.hasOwnProperty("mapbox_logo")&&!c.mapbox_logo)return!1}return!0}_updateCompact(){const t=this._container.children;if(t.length){const o=t[0];this._map.getCanvasContainer().offsetWidth<250?o.classList.add("mapboxgl-compact"):o.classList.remove("mapboxgl-compact")}}}class L8{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(t){const o=++this._id;return this._queue.push({callback:t,id:o,cancelled:!1}),o}remove(t){const o=this._currentlyRunning,c=o?this._queue.concat(o):this._queue;for(const u of c)if(u.id===t)return void(u.cancelled=!0)}run(t=0){const o=this._currentlyRunning=this._queue;this._queue=[];for(const c of o)if(!c.cancelled&&(c.callback(t),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function k8(r,t,o){if(r=new Nn(r.lng,r.lat),t){const c=new Nn(r.lng-360,r.lat),u=new Nn(r.lng+360,r.lat),h=360*Math.ceil(Math.abs(r.lng-o.center.lng)/360),m=o.locationPoint(r).distSqr(t),g=t.x<0||t.y<0||t.x>o.width||t.y>o.height;o.locationPoint(c).distSqr(t)<m&&(g||Math.abs(c.lng-o.center.lng)<h)?r=c:o.locationPoint(u).distSqr(t)<m&&(g||Math.abs(u.lng-o.center.lng)<h)&&(r=u)}for(;Math.abs(r.lng-o.center.lng)>180;){const c=o.locationPoint(r);if(c.x>=0&&c.y>=0&&c.x<=o.width&&c.y<=o.height)break;r.lng>o.center.lng?r.lng-=360:r.lng+=360}return r}const GI={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class HI extends Vn{constructor(t,o){if(super(),(t instanceof p.HTMLElement||o)&&(t=Fe({element:t},o)),pt(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=t&&t.anchor||"center",this._color=t&&t.color||"#3FB1CE",this._scale=t&&t.scale||1,this._draggable=t&&t.draggable||!1,this._clickTolerance=t&&t.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=t&&t.rotation||0,this._rotationAlignment=t&&t.rotationAlignment||"auto",this._pitchAlignment=t&&t.pitchAlignment&&t.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=t&&t.occludedOpacity||.2,t&&t.element)this._element=t.element,this._offset=G.convert(t&&t.offset||[0,0]);else{this._defaultMarker=!0,this._element=Qn("div");const h=41,m=27,g=qr("svg",{display:"block",height:h*this._scale+"px",width:m*this._scale+"px",viewBox:`0 0 ${m} ${h}`},this._element),v=qr("radialGradient",{id:"shadowGradient"},qr("defs",{},g));qr("stop",{offset:"10%","stop-opacity":.4},v),qr("stop",{offset:"100%","stop-opacity":.05},v),qr("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},g),qr("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},g),qr("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},g),qr("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},g),this._offset=G.convert(t&&t.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.hasAttribute("role")||this._element.setAttribute("role","img"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",h=>{h.preventDefault()}),this._element.addEventListener("mousedown",h=>{h.preventDefault()});const c=this._element.classList;for(const h in GI)c.remove(`mapboxgl-marker-anchor-${h}`);c.add(`mapboxgl-marker-anchor-${this._anchor}`);const u=t&&t.className?t.className.trim().split(/\s+/):[];c.add(...u),this._popup=null}addTo(t){return t===this._map||(this.remove(),this._map=t,t.getCanvasContainer().appendChild(this._element),t.on("move",this._updateMoving),t.on("moveend",this._update),t.on("remove",this._clearFadeTimer),t._addMarker(this),this.setDraggable(this._draggable),this._update(),t.on("click",this._onMapClick)),this}remove(){const t=this._map;return t&&(t.off("click",this._onMapClick),t.off("move",this._updateMoving),t.off("moveend",this._update),t.off("mousedown",this._addDragHandler),t.off("touchstart",this._addDragHandler),t.off("mouseup",this._onUp),t.off("touchend",this._onUp),t.off("mousemove",this._onMove),t.off("touchmove",this._onMove),t.off("remove",this._clearFadeTimer),t._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(t){return this._lngLat=Nn.convert(t),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(t){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),t){if(!("offset"in t.options)){const u=Math.sqrt(Math.pow(13.5,2)/2);t.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[u,-1*(38.1-13.5+u)],"bottom-right":[-u,-1*(38.1-13.5+u)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=t,t._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(t){const o=t.code,c=t.charCode||t.keyCode;o!=="Space"&&o!=="Enter"&&c!==32&&c!==13||this.togglePopup()}_onMapClick(t){const o=t.originalEvent.target,c=this._element;this._popup&&(o===c||c.contains(o))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const t=this._popup;return t?(t.isOpen()?(t.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(t.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const t=this._map,o=this._pos;if(!t||!o)return!1;const c=t.unproject(o),u=t.getFreeCameraOptions();if(!u.position)return!1;const h=u.position.toLngLat();return h.distanceTo(c)<.9*h.distanceTo(this._lngLat)}_evaluateOpacity(){const t=this._map;if(!t)return;const o=this._pos;if(!o||o.x<0||o.x>t.transform.width||o.y<0||o.y>t.transform.height)return void this._clearFadeTimer();const c=t.unproject(o);let u;t._showingGlobe()&&HS(t.transform,this._lngLat)?u=0:(u=1-t._queryFogOpacity(c),t.transform._terrainEnabled()&&t.getTerrain()&&this._behindTerrain()&&(u*=this._occludedOpacity)),this._element.style.opacity=`${u}`,this._element.style.pointerEvents=u>0?"auto":"none",this._popup&&this._popup._setOpacity(u),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const t=this._pos;if(!t||!this._map)return;const o=this._offset.mult(this._scale);this._element.style.transform=`
            translate(${t.x}px,${t.y}px)
            ${GI[this._anchor]}
            ${this._calculateXYTransform()} ${this._calculateZTransform()}
            translate(${o.x}px,${o.y}px)
        `}_calculateXYTransform(){const t=this._pos,o=this._map,c=this.getPitchAlignment();if(!o||!t||c!=="map")return"";if(!o._showingGlobe()){const v=o.getPitch();return v?`rotateX(${v}deg)`:""}const u=fe(_F(o.transform,this._lngLat)),h=t.sub(vF(o.transform)),m=Math.abs(h.x)+Math.abs(h.y);if(m===0)return"";const g=u/m;return`rotateX(${-h.y*g}deg) rotateY(${h.x*g}deg)`}_calculateZTransform(){const t=this._pos,o=this._map;if(!o||!t)return"";let c=0;const u=this.getRotationAlignment();if(u==="map")if(o._showingGlobe()){const h=o.project(new Nn(this._lngLat.lng,this._lngLat.lat+.001)),m=o.project(new Nn(this._lngLat.lng,this._lngLat.lat-.001)).sub(h);c=fe(Math.atan2(m.y,m.x))-90}else c=-o.getBearing();else if(u==="horizon"){const h=Te(4,6,o.getZoom()),m=vF(o.transform);m.y+=h*o.transform.height;const g=t.sub(m),v=fe(Math.atan2(g.y,g.x));c=(v>90?v-270:v+90)*(1-h)}return c+=this._rotation,c?`rotateZ(${c}deg)`:""}_update(t){p.cancelAnimationFrame(this._updateFrameId);const o=this._map;o&&(o.transform.renderWorldCopies&&(this._lngLat=k8(this._lngLat,this._pos,o.transform)),this._pos=o.project(this._lngLat),t===!0?this._updateFrameId=p.requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),o._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(o._showingGlobe()||o.getTerrain()||o.getFog())&&!this._fadeTimer&&(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(t){return this._offset=G.convert(t),this._update(),this}addClassName(t){return this._element.classList.add(t),this}removeClassName(t){return this._element.classList.remove(t),this}toggleClassName(t){return this._element.classList.toggle(t)}_onMove(t){const o=this._map;if(!o)return;const c=this._pointerdownPos,u=this._positionDelta;if(c&&u){if(!this._isDragging){const h=this._clickTolerance||o._clickTolerance;if(t.point.dist(c)<h)return;this._isDragging=!0}this._pos=t.point.sub(u),this._lngLat=o.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new $t("dragstart"))),this.fire(new $t("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const t=this._map;t&&(t.off("mousemove",this._onMove),t.off("touchmove",this._onMove)),this._state==="active"&&this.fire(new $t("dragend")),this._state="inactive"}_addDragHandler(t){const o=this._map,c=this._pos;o&&c&&this._element.contains(t.originalEvent.target)&&(t.preventDefault(),this._positionDelta=t.point.sub(c),this._pointerdownPos=t.point,this._state="pending",o.on("mousemove",this._onMove),o.on("touchmove",this._onMove),o.once("mouseup",this._onUp),o.once("touchend",this._onUp))}setDraggable(t){this._draggable=!!t;const o=this._map;return o&&(t?(o.on("mousedown",this._addDragHandler),o.on("touchstart",this._addDragHandler)):(o.off("mousedown",this._addDragHandler),o.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(t){return this._rotation=t||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(t){return this._rotationAlignment=t||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment==="auto"||this._rotationAlignment==="horizon"&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(t){return this._pitchAlignment=t||"auto",this._update(),this}getPitchAlignment(){return this._pitchAlignment==="auto"?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(t){return this._occludedOpacity=t||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const Uoe={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},Woe=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function D8(r=new G(0,0),t="bottom"){if(typeof r=="number"){const o=Math.round(Math.sqrt(.5*Math.pow(r,2)));switch(t){case"top":return new G(0,r);case"top-left":return new G(o,o);case"top-right":return new G(-o,o);case"bottom":return new G(0,-r);case"bottom-left":return new G(o,-o);case"bottom-right":return new G(-o,-o);case"left":return new G(r,0);case"right":return new G(-r,0)}return new G(0,0)}return r instanceof G||Array.isArray(r)?G.convert(r):G.convert(r[t]||[0,0])}class Voe{constructor(t){this.jumpTo(t)}getValue(t){if(t<=this._startTime)return this._start;if(t>=this._endTime)return this._end;const o=Re((t-this._startTime)/(this._endTime-this._startTime));return this._start*(1-o)+this._end*o}isEasing(t){return t>=this._startTime&&t<=this._endTime}jumpTo(t){this._startTime=-1/0,this._endTime=-1/0,this._start=t,this._end=t}easeTo(t,o,c){this._start=this.getValue(o),this._end=t,this._startTime=o,this._endTime=o+c}}const Goe={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use  + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},Hoe={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,antialias:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0,collectResourceTiming:!1,testMode:!1},joe={showCompass:!0,showZoom:!0,visualizePitch:!1};class $oe{constructor(t,o,c=!1){this._clickTolerance=10,this.element=o,this.mouseRotate=new E8({clickTolerance:t.dragRotate._mouseRotate._clickTolerance}),this.map=t,c&&(this.mousePitch=new M8({clickTolerance:t.dragRotate._mousePitch._clickTolerance})),pt(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),o.addEventListener("mousedown",this.mousedown),o.addEventListener("touchstart",this.touchstart,{passive:!1}),o.addEventListener("touchmove",this.touchmove),o.addEventListener("touchend",this.touchend),o.addEventListener("touchcancel",this.reset)}down(t,o){this.mouseRotate.mousedown(t,o),this.mousePitch&&this.mousePitch.mousedown(t,o),Vp()}move(t,o){const c=this.map,u=this.mouseRotate.mousemoveWindow(t,o),h=u&&u.bearingDelta;if(h&&c.setBearing(c.getBearing()+h),this.mousePitch){const m=this.mousePitch.mousemoveWindow(t,o),g=m&&m.pitchDelta;g&&c.setPitch(c.getPitch()+g)}}off(){const t=this.element;t.removeEventListener("mousedown",this.mousedown),t.removeEventListener("touchstart",this.touchstart,{passive:!1}),t.removeEventListener("touchmove",this.touchmove),t.removeEventListener("touchend",this.touchend),t.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){lc(),p.removeEventListener("mousemove",this.mousemove),p.removeEventListener("mouseup",this.mouseup)}mousedown(t){this.down(Fe({},t,{ctrlKey:!0,preventDefault:()=>t.preventDefault()}),kl(this.element,t)),p.addEventListener("mousemove",this.mousemove),p.addEventListener("mouseup",this.mouseup)}mousemove(t){this.move(t,kl(this.element,t))}mouseup(t){this.mouseRotate.mouseupWindow(t),this.mousePitch&&this.mousePitch.mouseupWindow(t),this.offTemp()}touchstart(t){t.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=Dd(this.element,t.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>t.preventDefault()},this._startPos))}touchmove(t){t.targetTouches.length!==1?this.reset():(this._lastPos=Dd(this.element,t.targetTouches)[0],this.move({preventDefault:()=>t.preventDefault()},this._lastPos))}touchend(t){t.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const Yoe={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},qoe={maxWidth:100,unit:"metric"},Xoe={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"},a3={version:y,supported:Oi,setRTLTextPlugin:function(r,t,o=!1){if(Va===nv||Va===iv||Va===Yc)throw new Error("setRTLTextPlugin cannot be called multiple times.");qc=Pn.resolveURL(r),Va=nv,o1=t,s1(),o||RS()},getRTLTextPluginStatus:l1,Map:class extends Boe{constructor(r){if(ea.mark(lr.create),(r=Fe({},Hoe,r)).minZoom!=null&&r.maxZoom!=null&&r.minZoom>r.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(r.minPitch!=null&&r.maxPitch!=null&&r.minPitch>r.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(r.minPitch!=null&&r.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(r.maxPitch!=null&&r.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(r.antialias&&function(t){const o=t.navigator?t.navigator.userAgent:null;return!!function(c){if(ut==null){const u=c.navigator?c.navigator.userAgent:null;ut=!!c.safari||!(!u||!(/\b(iPad|iPhone|iPod)\b/.test(u)||u.match("Safari")&&!u.match("Chrome")))}return ut}(t)&&o&&(o.match("Version/15.4")||o.match("Version/15.5")||o.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))}(p)&&(r.antialias=!1,xe("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new rI(r.minZoom,r.maxZoom,r.minPitch,r.maxPitch,r.renderWorldCopies),r),this._interactive=r.interactive,this._minTileCacheSize=r.minTileCacheSize,this._maxTileCacheSize=r.maxTileCacheSize,this._failIfMajorPerformanceCaveat=r.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=r.preserveDrawingBuffer,this._antialias=r.antialias,this._trackResize=r.trackResize,this._bearingSnap=r.bearingSnap,this._refreshExpiredTiles=r.refreshExpiredTiles,this._fadeDuration=r.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=r.crossSourceCollisions,this._collectResourceTiming=r.collectResourceTiming,this._language=this._parseLanguage(r.language),this._worldview=r.worldview,this._renderTaskQueue=new L8,this._domRenderTaskQueue=new L8,this._controls=[],this._markers=[],this._popups=[],this._mapId=kt(),this._locale=Fe({},Goe,r.locale),this._clickTolerance=r.clickTolerance,this._cooperativeGestures=r.cooperativeGestures,this._performanceMetricsCollection=r.performanceMetricsCollection,this._containerWidth=0,this._containerHeight=0,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new Voe(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._requestManager=new en(r.transformRequest,r.accessToken,r.testMode),this._silenceAuthErrors=!!r.testMode,typeof r.container=="string"){if(this._container=p.document.getElementById(r.container),!this._container)throw new Error(`Container '${r.container.toString()}' not found.`)}else{if(!(r.container instanceof p.HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=r.container}if(this._container.childNodes.length>0&&xe("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),r.maxBounds&&this.setMaxBounds(r.maxBounds),pt(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");if(this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),p!==void 0&&(this._fullscreenchangeEvent="onfullscreenchange"in p.document?"fullscreenchange":"webkitfullscreenchange",p.addEventListener("online",this._onWindowOnline,!1),p.addEventListener("resize",this._onWindowResize,!1),p.addEventListener("orientationchange",this._onWindowResize,!1),p.addEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),p.addEventListener("visibilitychange",this._onVisibilityChange,!1)),this.handlers=new Foe(this,r),this._localFontFamily=r.localFontFamily,this._localIdeographFontFamily=r.localIdeographFontFamily,(r.style||!r.testMode)&&this.setStyle(r.style||b.DEFAULT_STYLE,{localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),r.projection&&this.setProjection(r.projection),r.hash&&(this._hash=new loe(typeof r.hash=="string"&&r.hash||void 0).addTo(this)),!this._hash||!this._hash._onHashChange()){this.jumpTo({center:r.center,zoom:r.zoom,bearing:r.bearing,pitch:r.pitch});const t=r.bounds;t&&(this.resize(),this.fitBounds(t,Fe({},r.fitBoundsOptions,{duration:0})))}this.resize(),r.attributionControl&&this.addControl(new I8({customAttribution:r.customAttribution})),this._logoControl=new R8,this.addControl(this._logoControl,r.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",t=>{this._update(t.dataType==="style"),this.fire(new $t(`${t.dataType}data`,t))}),this.on("dataloading",t=>{this.fire(new $t(`${t.dataType}dataloading`,t))})}_getMapId(){return this._mapId}addControl(r,t){if(t===void 0&&(t=r.getDefaultPosition?r.getDefaultPosition():"top-right"),!r||!r.onAdd)return this.fire(new bn(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const o=r.onAdd(this);this._controls.push(r);const c=this._controlPositions[t];return t.indexOf("bottom")!==-1?c.insertBefore(o,c.firstChild):c.appendChild(o),this}removeControl(r){if(!r||!r.onRemove)return this.fire(new bn(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const t=this._controls.indexOf(r);return t>-1&&this._controls.splice(t,1),r.onRemove(this),this}hasControl(r){return this._controls.indexOf(r)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(r){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const t=!this._moving;return t&&this.fire(new $t("movestart",r)).fire(new $t("move",r)),this.fire(new $t("resize",r)),t&&this.fire(new $t("moveend",r)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(r){return this.transform.setMaxBounds(Fl.convert(r)),this._update()}setMinZoom(r){if((r=r??-2)>=-2&&r<=this.transform.maxZoom)return this.transform.minZoom=r,this._update(),this.getZoom()<r?this.setZoom(r):this.fire(new $t("zoomstart")).fire(new $t("zoom")).fire(new $t("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(r){if((r=r??22)>=this.transform.minZoom)return this.transform.maxZoom=r,this._update(),this.getZoom()>r?this.setZoom(r):this.fire(new $t("zoomstart")).fire(new $t("zoom")).fire(new $t("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(r){if((r=r??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(r>=0&&r<=this.transform.maxPitch)return this.transform.minPitch=r,this._update(),this.getPitch()<r?this.setPitch(r):this.fire(new $t("pitchstart")).fire(new $t("pitch")).fire(new $t("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(r){if((r=r??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(r>=this.transform.minPitch)return this.transform.maxPitch=r,this._update(),this.getPitch()>r?this.setPitch(r):this.fire(new $t("pitchstart")).fire(new $t("pitch")).fire(new $t("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(r){return this.transform.renderWorldCopies=r,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(r){return r==="auto"?p.navigator.language:Array.isArray(r)?r.length===0?void 0:r.map(t=>t==="auto"?p.navigator.language:t):r}setLanguage(r){const t=this._parseLanguage(r);if(!this.style||t===this._language)return this;this._language=t,this.style.reloadSources();for(const o of this._controls)o._setLanguage&&o._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(r){return this.style&&r!==this._worldview?(this._worldview=r,this.style.reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return this.transform.projection.name==="globe"}setProjection(r){return this._lazyInitEmptyStyle(),r?typeof r=="string"&&(r={name:r}):r=null,this._useExplicitProjection=!!r,this._prioritizeAndUpdateProjection(r,this.style.projection)}_updateProjectionTransition(){if(this.getProjection().name!=="globe")return;const r=this.transform,t=r.projection.name;let o;t==="globe"&&r.zoom>=Mf?(r.setMercatorFromTransition(),o=!0):t==="mercator"&&r.zoom<Mf&&(r.setProjection({name:"globe"}),o=!0),o&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(r,t){return this._updateProjection(r||t||{name:"mercator"})}_updateProjection(r){let t;if(t=r.name==="globe"&&this.transform.zoom>=Mf?this.transform.setMercatorFromTransition():this.transform.setProjection(r),this.style.applyProjectionUpdate(),t){this.painter.clearBackgroundTiles();for(const o in this.style._sourceCaches)this.style._sourceCaches[o].clearTiles();this._update(!0),this._forceMarkerAndPopupUpdate(!0)}return this}project(r){return this.transform.locationPoint3D(Nn.convert(r))}unproject(r){return this.transform.pointLocation3D(G.convert(r))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(r,t,o){if(r==="mouseenter"||r==="mouseover"){let c=!1;const u=m=>{const g=t.filter(x=>this.getLayer(x)),v=g.length?this.queryRenderedFeatures(m.point,{layers:g}):[];v.length?c||(c=!0,o.call(this,new Wl(r,this,m.originalEvent,{features:v}))):c=!1},h=()=>{c=!1};return{layers:new Set(t),listener:o,delegates:{mousemove:u,mouseout:h}}}if(r==="mouseleave"||r==="mouseout"){let c=!1;const u=m=>{const g=t.filter(v=>this.getLayer(v));(g.length?this.queryRenderedFeatures(m.point,{layers:g}):[]).length?c=!0:c&&(c=!1,o.call(this,new Wl(r,this,m.originalEvent)))},h=m=>{c&&(c=!1,o.call(this,new Wl(r,this,m.originalEvent)))};return{layers:new Set(t),listener:o,delegates:{mousemove:u,mouseout:h}}}{const c=u=>{const h=t.filter(g=>this.getLayer(g)),m=h.length?this.queryRenderedFeatures(u.point,{layers:h}):[];m.length&&(u.features=m,o.call(this,u),delete u.features)};return{layers:new Set(t),listener:o,delegates:{[r]:c}}}}on(r,t,o){if(o===void 0)return super.on(r,t);if(Array.isArray(t)||(t=[t]),t){for(const u of t)if(!this._isValidId(u))return this}const c=this._createDelegatedListener(r,t,o);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[r]=this._delegatedListeners[r]||[],this._delegatedListeners[r].push(c);for(const u in c.delegates)this.on(u,c.delegates[u]);return this}once(r,t,o){if(o===void 0)return super.once(r,t);if(Array.isArray(t)||(t=[t]),t){for(const u of t)if(!this._isValidId(u))return this}const c=this._createDelegatedListener(r,t,o);for(const u in c.delegates)this.once(u,c.delegates[u]);return this}off(r,t,o){if(o===void 0)return super.off(r,t);t=new Set(Array.isArray(t)?t:[t]);for(const h of t)if(!this._isValidId(h))return this;const c=(h,m)=>{if(h.size!==m.size)return!1;for(const g of h)if(!m.has(g))return!1;return!0},u=this._delegatedListeners?this._delegatedListeners[r]:void 0;return u&&(h=>{for(let m=0;m<h.length;m++){const g=h[m];if(g.listener===o&&c(g.layers,t)){for(const v in g.delegates)this.off(v,g.delegates[v]);return h.splice(m,1),this}}})(u),this}queryRenderedFeatures(r,t){if(!this.style)return[];if(t!==void 0||r===void 0||r instanceof G||Array.isArray(r)||(t=r,r=void 0),r=r||[[0,0],[this.transform.width,this.transform.height]],(t=t||{}).layers&&Array.isArray(t.layers)){for(const o of t.layers)if(!this._isValidId(o))return[]}return this.style.queryRenderedFeatures(r,t,this.transform)}querySourceFeatures(r,t){return this._isValidId(r)?this.style.querySourceFeatures(r,t):[]}isPointOnSurface(r){const{name:t}=this.transform.projection;return t!=="globe"&&t!=="mercator"&&xe(`${t} projection does not support isPointOnSurface, this API may behave unexpectedly.`),this.transform.isPointOnSurface(G.convert(r))}setStyle(r,t){return(t=Fe({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},t)).diff!==!1&&t.localIdeographFontFamily===this._localIdeographFontFamily&&t.localFontFamily===this._localFontFamily&&this.style&&r?(this._diffStyle(r,t),this):(this._localIdeographFontFamily=t.localIdeographFontFamily,this._localFontFamily=t.localFontFamily,this._updateStyle(r,t))}_getUIString(r){const t=this._locale[r];if(t==null)throw new Error(`Missing UI string '${r}'`);return t}_updateStyle(r,t){return this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),r&&(this.style=new ru(this,t||{}),this.style.setEventedParent(this,{style:this.style}),typeof r=="string"?this.style.loadURL(r):this.style.loadJSON(r)),this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new ru(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(r,t){if(typeof r=="string"){const o=this._requestManager.normalizeStyleURL(r),c=this._requestManager.transformRequest(o,Se.Style);tt(c,(u,h)=>{u?this.fire(new bn(u)):h&&this._updateDiff(h,t)})}else typeof r=="object"&&this._updateDiff(r,t)}_updateDiff(r,t){try{this.style.setState(r)&&this._update(!0)}catch(o){xe(`Unable to perform style diff: ${o.message||o.error||o}.  Rebuilding the style from scratch.`),this._updateStyle(r,t)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(xe("There is no style added to the map."),!1)}_isValidId(r){return!function(t){return t.indexOf("")>=0}(r)||(this.fire(new bn(new Error(`IDs can't contain special symbols: "${r}".`))),!1)}addSource(r,t){return this._isValidId(r)?(this._lazyInitEmptyStyle(),this.style.addSource(r,t),this._update(!0)):this}isSourceLoaded(r){return!!this._isValidId(r)&&!!this.style&&this.style._isSourceCacheLoaded(r)}areTilesLoaded(){const r=this.style&&this.style._sourceCaches;for(const t in r){const o=r[t]._tiles;for(const c in o){const u=o[c];if(u.state!=="loaded"&&u.state!=="errored")return!1}}return!0}addSourceType(r,t,o){this._lazyInitEmptyStyle(),this.style.addSourceType(r,t,o)}removeSource(r){return this._isValidId(r)?(this.style.removeSource(r),this._updateTerrain(),this._update(!0)):this}getSource(r){return this._isValidId(r)?this.style.getOwnSource(r):null}addImage(r,t,{pixelRatio:o=1,sdf:c=!1,stretchX:u,stretchY:h,content:m}={}){if(this._lazyInitEmptyStyle(),t instanceof p.HTMLImageElement||p.ImageBitmap&&t instanceof p.ImageBitmap){const{width:g,height:v,data:x}=Pn.getImageData(t);this.style.addImage(r,{data:new Jr({width:g,height:v},x),pixelRatio:o,stretchX:u,stretchY:h,content:m,sdf:c,version:0})}else if(t.width===void 0||t.height===void 0)this.fire(new bn(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:g,height:v}=t,x=t;this.style.addImage(r,{data:new Jr({width:g,height:v},new Uint8Array(x.data)),pixelRatio:o,stretchX:u,stretchY:h,content:m,sdf:c,version:0,userImage:x}),x.onAdd&&x.onAdd(this,r)}}updateImage(r,t){this._lazyInitEmptyStyle();const o=this.style.getImage(r);if(!o)return void this.fire(new bn(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const c=t instanceof p.HTMLImageElement||p.ImageBitmap&&t instanceof p.ImageBitmap?Pn.getImageData(t):t,{width:u,height:h}=c;u!==void 0&&h!==void 0?u===o.data.width&&h===o.data.height?(o.data.replace(c.data,!(t instanceof p.HTMLImageElement||p.ImageBitmap&&t instanceof p.ImageBitmap)),this.style.updateImage(r,o)):this.fire(new bn(new Error(`The width and height of the updated image (${u}, ${h})
                must be that same as the previous version of the image
                (${o.data.width}, ${o.data.height})`))):this.fire(new bn(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")))}hasImage(r){return r?!!this.style&&!!this.style.getImage(r):(this.fire(new bn(new Error("Missing required image id"))),!1)}removeImage(r){this.style.removeImage(r)}loadImage(r,t){Qt(this._requestManager.transformRequest(r,Se.Image),(o,c)=>{t(o,c instanceof p.HTMLImageElement?Pn.getImageData(c):c)})}listImages(){return this.style.listImages()}addModel(r,t){this._lazyInitEmptyStyle(),this.style.addModel(r,t)}hasModel(r){return r?this.style.hasModel(r):(this.fire(new bn(new Error("Missing required model id"))),!1)}removeModel(r){this.style.removeModel(r)}listModels(){return this.style.listModels()}addLayer(r,t){return this._isValidId(r.id)?(this._lazyInitEmptyStyle(),this.style.addLayer(r,t),this._update(!0)):this}moveLayer(r,t){return this._isValidId(r)?(this.style.moveLayer(r,t),this._update(!0)):this}removeLayer(r){return this._isValidId(r)?(this.style.removeLayer(r),this._update(!0)):this}setLights(r){if(this._lazyInitEmptyStyle(),r&&r.length===1&&r[0].type==="flat"){const t=r[0];t.properties?this.style.setFlatLight(t.properties,t.id,{}):this.style.setFlatLight({},"flat")}else this.style.setLights(r),this.painter.terrain&&(this.painter.terrain.invalidateRenderCache=!0);return this._update(!0)}getLights(){const r=this.style.getLights()||[];return r.length===0&&r.push({id:this.style.light.id,type:"flat",properties:this.style.getFlatLight()}),r}getLayer(r){return this._isValidId(r)?this.style.getOwnLayer(r):null}setLayerZoomRange(r,t,o){return this._isValidId(r)?(this.style.setLayerZoomRange(r,t,o),this._update(!0)):this}setFilter(r,t,o={}){return this._isValidId(r)?(this.style.setFilter(r,t,o),this._update(!0)):this}getFilter(r){return this._isValidId(r)?this.style.getFilter(r):null}setPaintProperty(r,t,o,c={}){return this._isValidId(r)?(this.style.setPaintProperty(r,t,o,c),this._update(!0)):this}getPaintProperty(r,t){return this._isValidId(r)?this.style.getPaintProperty(r,t):null}setLayoutProperty(r,t,o,c={}){return this._isValidId(r)?(this.style.setLayoutProperty(r,t,o,c),this._update(!0)):this}getLayoutProperty(r,t){return this._isValidId(r)?this.style.getLayoutProperty(r,t):null}setConfigProperty(r,t,o){return this.style.setConfigProperty(r,t,o),this._update(!0)}setLight(r,t={}){return console.log("The `map.setLight` function is deprecated, prefer using `map.setLights` with `flat` light type instead."),this.setLights([{id:"flat",type:"flat",properties:r}])}getLight(){return console.log("The `map.getLight` function is deprecated, prefer using `map.getLights` instead."),this.style.getFlatLight()}setTerrain(r){return this._lazyInitEmptyStyle(),!r&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(r),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(r){return this._lazyInitEmptyStyle(),this.style.setFog(r),this._update(!0)}getFog(){return this.style?this.style.getFog():null}setCamera(r){return this.style.setCamera(r),this._triggerCameraUpdate(r)}_triggerCameraUpdate(r){return this._update(this.transform.setOrthographicProjectionAtLowPitch(r["camera-projection"]==="orthographic"))}getCamera(){return this.style.camera}_queryFogOpacity(r){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(Nn.convert(r),this.transform):0}setFeatureState(r,t){return this._isValidId(r.source)?(this.style.setFeatureState(r,t),this._update()):this}removeFeatureState(r,t){return this._isValidId(r.source)?(this.style.removeFeatureState(r,t),this._update()):this}getFeatureState(r){return this._isValidId(r.source)?this.style.getFeatureState(r):null}_updateContainerDimensions(){if(!this._container)return;const r=this._container.getBoundingClientRect().width||400,t=this._container.getBoundingClientRect().height||300;let o,c,u,h=this._container;for(;h&&(!c||!u);){const m=p.getComputedStyle(h).transform;m&&m!=="none"&&(o=m.match(/matrix.*\((.+)\)/)[1].split(", "),o[0]&&o[0]!=="0"&&o[0]!=="1"&&(c=o[0]),o[3]&&o[3]!=="0"&&o[3]!=="1"&&(u=o[3])),h=h.parentElement}this._containerWidth=c?Math.abs(r/c):r,this._containerHeight=u?Math.abs(t/u):t}_detectMissingCSS(){p.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&xe("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const r=this._container;r.classList.add("mapboxgl-map"),(this._missingCSSCanary=Qn("div","mapboxgl-canary",r)).style.visibility="hidden",this._detectMissingCSS();const t=this._canvasContainer=Qn("div","mapboxgl-canvas-container",r);this._canvas=Qn("canvas","mapboxgl-canvas",t),this._interactive&&(t.classList.add("mapboxgl-interactive"),this._canvas.setAttribute("tabindex","0")),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const o=this._controlContainer=Qn("div","mapboxgl-control-container",r),c=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(u=>{c[u]=Qn("div",`mapboxgl-ctrl-${u}`,o)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(r,t){const o=Pn.devicePixelRatio||1;this._canvas.width=o*Math.ceil(r),this._canvas.height=o*Math.ceil(t),this._canvas.style.width=`${r}px`,this._canvas.style.height=`${t}px`}_addMarker(r){this._markers.push(r)}_removeMarker(r){const t=this._markers.indexOf(r);t!==-1&&this._markers.splice(t,1)}_addPopup(r){this._popups.push(r)}_removePopup(r){const t=this._popups.indexOf(r);t!==-1&&this._popups.splice(t,1)}_setupPainter(){const r=Fe({},Oi.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),t=this._canvas.getContext("webgl2",r);t?(Ea(t,!0),this.painter=new Qae(t,this.transform),this.on("data",o=>{o.dataType==="source"&&this.painter.setTileLoadedFlag(!0)}),S.testSupport(t)):this.fire(new bn(new Error("Failed to initialize WebGL")))}_contextLost(r){r.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new $t("webglcontextlost",{originalEvent:r}))}_contextRestored(r){this._setupPainter(),this.resize(),this._update(),this.fire(new $t("webglcontextrestored",{originalEvent:r}))}_onMapScroll(r){if(r.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(r){return this.style?(this._styleDirty=this._styleDirty||r,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(r){return this._update(),this._renderTaskQueue.add(r)}_cancelRenderFrame(r){this._renderTaskQueue.remove(r)}_requestDomTask(r){!this.loaded()||this.loaded()&&!this.isMoving()?r():this._domRenderTaskQueue.add(r)}_render(r){let t;this.fire(new $t("renderstart"));const o=this.painter.context.extTimerQuery,c=Pn.now(),u=this.painter.context.gl;if(this.listens("gpu-timing-frame")&&(t=u.createQuery(),u.beginQuery(o.TIME_ELAPSED_EXT,t)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],p.performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],p.performance.now())),this._renderTaskQueue.run(r),this._domRenderTaskQueue.run(r),this._removed)return;this._updateProjectionTransition();const h=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const v=this.transform.zoom,x=this.transform.pitch,w=Pn.now(),E=new dr(v,{now:w,fadeDuration:h,pitch:x,transition:this.style.transition});this.style.update(E)}this.style&&this.style.hasFogTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let m=!1;if(this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),m=this._updateAverageElevation(c),this.style.updateSources(this.transform),this._forceMarkerAndPopupUpdate()):m=this._updateAverageElevation(c),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,h,this._crossSourceCollisions),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,wireframe:{terrain:this.showTerrainWireframe,layers2D:this.showLayers2DWireframe,layers3D:this.showLayers3DWireframe},showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:h,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new $t("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new $t("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),t){const v=Pn.now()-c;u.endQuery(o.TIME_ELAPSED_EXT),setTimeout(()=>{const x=u.getQueryParameter(t,u.QUERY_RESULT)/1e6;u.deleteQuery(t),this.fire(new $t("gpu-timing-frame",{cpuTime:v,gpuTime:x})),p.performance.mark("frame-gpu",{startTime:c,detail:{gpuTime:x}})},50)}if(this.listens("gpu-timing-layer")){const v=this.painter.collectGpuTimers();setTimeout(()=>{const x=this.painter.queryGpuTimers(v);this.fire(new $t("gpu-timing-layer",{layerTimes:x}))},50)}if(this.listens("gpu-timing-deferred-render")){const v=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const x=this.painter.queryGpuTimeDeferredRender(v);this.fire(new $t("gpu-timing-deferred-render",{gpuTime:x}))},50)}const g=this._sourcesDirty||this._styleDirty||this._placementDirty||m;if(g||this._repaint)this.triggerRepaint();else{const v=!this.isMoving()&&this.loaded();if(v&&(m=this._updateAverageElevation(c,!0)),m)this.triggerRepaint();else if(this._triggerFrame(!1),v&&(this.fire(new $t("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const x=this._calculateSpeedIndex();this.fire(new $t("speedindexcompleted",{speedIndex:x})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||g||(this._fullyLoaded=!0,ea.mark(lr.fullLoad),this._performanceMetricsCollection&&pi(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(r){for(const t of this._markers)r&&!this.getRenderWorldCopies()&&(t._lngLat=t._lngLat.wrap()),t._update();for(const t of this._popups)!r||this.getRenderWorldCopies()||t._trackPointer||(t._lngLat=t._lngLat.wrap()),t._update()}_updateAverageElevation(r,t=!1){const o=u=>(this.transform.averageElevation=u,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&o(0);const c=this.transform.elevation&&this.transform.elevation.exaggeration()!==this._averageElevationExaggeration;if(c||(t||r-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(r)){const u=this.transform.averageElevation;let h=this.transform.sampleAverageElevation();this.transform.elevation&&(this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(h)?h=0:this._averageElevationLastSampledAt=r;const m=Math.abs(u-h);if(m>1){if(this._isInitialLoad||c)return this._averageElevation.jumpTo(h),o(h);this._averageElevation.easeTo(h,r,300)}else if(m>1e-4)return this._averageElevation.jumpTo(h),o(h)}return!!this._averageElevation.isEasing(r)&&o(this._averageElevation.getValue(r))}_authenticate(){ui(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,r=>{if(r&&(r.message===mn||r.status===401)){const t=this.painter.context.gl;Ea(t,!1),this._logoControl instanceof R8&&this._logoControl._updateLogo(),t&&t.clear(t.DEPTH_BUFFER_BIT|t.COLOR_BUFFER_BIT|t.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new bn(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),Zn(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_updateTerrain(){const r=this._isDragging();this.painter.updateTerrain(this.style,r)}_calculateSpeedIndex(){const r=this.painter.canvasCopy(),t=this.painter.getCanvasCopiesAndTimestamps();t.timeStamps.push(performance.now());const o=this.painter.context.gl,c=o.createFramebuffer();function u(h){o.framebufferTexture2D(o.FRAMEBUFFER,o.COLOR_ATTACHMENT0,o.TEXTURE_2D,h,0);const m=new Uint8Array(o.drawingBufferWidth*o.drawingBufferHeight*4);return o.readPixels(0,0,o.drawingBufferWidth,o.drawingBufferHeight,o.RGBA,o.UNSIGNED_BYTE,m),m}return o.bindFramebuffer(o.FRAMEBUFFER,c),this._canvasPixelComparison(u(r),t.canvasCopies.map(u),t.timeStamps)}_canvasPixelComparison(r,t,o){let c=o[1]-o[0];const u=r.length/4;for(let h=0;h<t.length;h++){const m=t[h];let g=0;for(let v=0;v<m.length;v+=4)m[v]===r[v]&&m[v+1]===r[v+1]&&m[v+2]===r[v+2]&&m[v+3]===r[v+3]&&(g+=1);c+=(o[h+2]-o[h+1])*(1-g/u)}return c}remove(){this._hash&&this._hash.remove();for(const t of this._controls)t.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),p!==void 0&&(p.removeEventListener("resize",this._onWindowResize,!1),p.removeEventListener("orientationchange",this._onWindowResize,!1),p.removeEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),p.removeEventListener("online",this._onWindowOnline,!1),p.removeEventListener("visibilitychange",this._onVisibilityChange,!1));const r=this.painter.context.gl.getExtension("WEBGL_lose_context");r&&r.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),cr.delete(this.painter.context.gl),this._removed=!0,this.fire(new $t("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(r){this._renderNextFrame=this._renderNextFrame||r,this.style&&!this._frame&&(this._frame=Pn.frame(t=>{const o=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,o&&this._render(t)}))}_preloadTiles(r){return Xe(this.style?Object.values(this.style._sourceCaches):[],(t,o)=>t._preloadTiles(r,o),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(r){this._trackResize&&this.resize({originalEvent:r})._update()}_onVisibilityChange(){p.document.visibilityState==="hidden"&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(r){this._showTileBoundaries!==r&&(this._showTileBoundaries=r,this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(r){this._showTerrainWireframe!==r&&(this._showTerrainWireframe=r,this._update())}get showLayers2DWireframe(){return!!this._showLayers2DWireframe}set showLayers2DWireframe(r){this._showLayers2DWireframe!==r&&(this._showLayers2DWireframe=r,this._update())}get showLayers3DWireframe(){return!!this._showLayers3DWireframe}set showLayers3DWireframe(r){this._showLayers3DWireframe!==r&&(this._showLayers3DWireframe=r,this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(r){this._speedIndexTiming!==r&&(this._speedIndexTiming=r,this._update())}get showPadding(){return!!this._showPadding}set showPadding(r){this._showPadding!==r&&(this._showPadding=r,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(r){this._showCollisionBoxes!==r&&(this._showCollisionBoxes=r,r?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(r){this._showOverdrawInspector!==r&&(this._showOverdrawInspector=r,this._update())}get repaint(){return!!this._repaint}set repaint(r){this._repaint!==r&&(this._repaint=r,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(r){this._vertices=r,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(r){this._showTileAABBs!==r&&(this._showTileAABBs=r,r&&this._update())}_setCacheLimits(r,t){(function(o,c){wt=o,Xt=c})(r,t)}get version(){return y}},NavigationControl:class{constructor(r){this.options=Fe({},joe,r),this._container=Qn("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",t=>t.preventDefault()),this.options.showZoom&&(pt(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",t=>{this._map&&this._map.zoomIn({},{originalEvent:t})}),Qn("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",t=>{this._map&&this._map.zoomOut({},{originalEvent:t})}),Qn("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(pt(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",t=>{const o=this._map;o&&(this.options.visualizePitch?o.resetNorthPitch({},{originalEvent:t}):o.resetNorth({},{originalEvent:t}))}),this._compassIcon=Qn("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const r=this._map;if(!r)return;const t=r.getZoom(),o=t===r.getMaxZoom(),c=t===r.getMinZoom();this._zoomInButton.disabled=o,this._zoomOutButton.disabled=c,this._zoomInButton.setAttribute("aria-disabled",o.toString()),this._zoomOutButton.setAttribute("aria-disabled",c.toString())}_rotateCompassArrow(){const r=this._map;if(!r)return;const t=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(r.transform.pitch*(Math.PI/180)),.5)}) rotateX(${r.transform.pitch}deg) rotateZ(${r.transform.angle*(180/Math.PI)}deg)`:`rotate(${r.transform.angle*(180/Math.PI)}deg)`;r._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=t)})}onAdd(r){return this._map=r,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),r.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&r.on("pitch",this._rotateCompassArrow),r.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new $oe(r,this._compass,this.options.visualizePitch)),this._container}onRemove(){const r=this._map;r&&(this._container.remove(),this.options.showZoom&&r.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&r.off("pitch",this._rotateCompassArrow),r.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(r,t){const o=Qn("button",r,this._container);return o.type="button",o.addEventListener("click",t),o}_setButtonTitle(r,t){if(!this._map)return;const o=this._map._getUIString(`NavigationControl.${t}`);r.setAttribute("aria-label",o),r.firstElementChild&&r.firstElementChild.setAttribute("title",o)}},GeolocateControl:class extends Vn{constructor(r){super(),this.options=Fe({geolocation:p.navigator.geolocation},Yoe,r),pt(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=w8(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(r){return this._map=r,this._container=Qn("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(r){const t=(o=!!this.options.geolocation)=>{this._supportsGeolocation=o,r(o)};this._supportsGeolocation!==void 0?r(this._supportsGeolocation):p.navigator.permissions!==void 0?p.navigator.permissions.query({name:"geolocation"}).then(o=>t(o.state!=="denied")).catch(()=>t()):t()}_isOutOfMapMaxBounds(r){const t=this._map.getMaxBounds(),o=r.coords;return!!t&&(o.longitude<t.getWest()||o.longitude>t.getEast()||o.latitude<t.getSouth()||o.latitude>t.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(r){if(this._map){if(this._isOutOfMapMaxBounds(r))return this._setErrorState(),this.fire(new $t("outofmaxbounds",r)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=r,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(r),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(r),this.options.showUserLocation&&this._userLocationDotMarker.removeClassName("mapboxgl-user-location-dot-stale"),this.fire(new $t("geolocate",r)),this._finish()}}_updateCamera(r){const t=new Nn(r.coords.longitude,r.coords.latitude),o=r.coords.accuracy,c=Fe({bearing:this._map.getBearing()},this.options.fitBoundsOptions);this._map.fitBounds(t.toBounds(o),c,{geolocateSource:!0})}_updateMarker(r){if(r){const t=new Nn(r.coords.longitude,r.coords.latitude);this._accuracyCircleMarker.setLngLat(t).addTo(this._map),this._userLocationDotMarker.setLngLat(t).addTo(this._map),this._accuracy=r.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const r=this._map.transform,t=Xi(1,r._center.lat)*r.worldSize,o=Math.ceil(2*this._accuracy*t);this._circleElement.style.width=`${o}px`,this._circleElement.style.height=`${o}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._userLocationDotMarker.addClassName("mapboxgl-user-location-show-heading")):(this._userLocationDotMarker.removeClassName("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(r){if(this._map){if(this.options.trackUserLocation)if(r.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const t=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",t),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",t),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(r.code===3&&this._noTimeout)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._userLocationDotMarker.addClassName("mapboxgl-user-location-dot-stale"),this.fire(new $t("error",r)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(r){if(this._map!==void 0){if(this._container.addEventListener("contextmenu",t=>t.preventDefault()),this._geolocateButton=Qn("button","mapboxgl-ctrl-geolocate",this._container),Qn("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",r===!1){xe("Geolocation support is not available so the GeolocateControl will be disabled.");const t=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",t),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",t)}else{const t=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",t),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",t)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=Qn("div","mapboxgl-user-location"),this._dotElement.appendChild(Qn("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(Qn("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new HI({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=Qn("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new HI({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",t=>{t.geolocateSource||this._watchState!=="ACTIVE_LOCK"||t.originalEvent&&t.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new $t("trackuserlocationend")))})}}_onDeviceOrientation(r){this._userLocationDotMarker&&(r.webkitCompassHeading?this._heading=r.webkitCompassHeading:r.absolute===!0&&(this._heading=-1*r.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return xe("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new $t("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new $t("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new $t("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let r;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(r={maximumAge:6e5,timeout:0},this._noTimeout=!0):(r=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,r),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const r=()=>{p.addEventListener("ondeviceorientationabsolute"in p?"deviceorientationabsolute":"deviceorientation",this._onDeviceOrientation)};p.DeviceMotionEvent!==void 0&&typeof p.DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(t=>{t==="granted"&&r()}).catch(console.error):r()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),p.removeEventListener("deviceorientation",this._onDeviceOrientation),p.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:I8,ScaleControl:class{constructor(r){this.options=Fe({},qoe,r),this._isNumberFormatSupported=function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch{return!1}}(),pt(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const r=this.options.maxWidth||100,t=this._map,o=t._containerHeight/2,c=t._containerWidth/2-r/2,u=t.unproject([c,o]),h=t.unproject([c+r,o]),m=u.distanceTo(h);if(this.options.unit==="imperial"){const g=3.2808*m;g>5280?this._setScale(r,g/5280,"mile"):this._setScale(r,g,"foot")}else this.options.unit==="nautical"?this._setScale(r,m/1852,"nautical-mile"):m>=1e3?this._setScale(r,m/1e3,"kilometer"):this._setScale(r,m,"meter")}_setScale(r,t,o){this._map._requestDomTask(()=>{const c=function(h){const m=Math.pow(10,`${Math.floor(h)}`.length-1);let g=h/m;return g=g>=10?10:g>=5?5:g>=3?3:g>=2?2:g>=1?1:function(v){const x=Math.pow(10,Math.ceil(-Math.log(v)/Math.LN10));return Math.round(v*x)/x}(g),m*g}(t),u=c/t;this._container.innerHTML=this._isNumberFormatSupported&&o!=="nautical-mile"?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:o}).format(c):`${c}&nbsp;${Xoe[o]}`,this._container.style.width=r*u+"px"})}onAdd(r){return this._map=r,this._language=r.getLanguage(),this._container=Qn("div","mapboxgl-ctrl mapboxgl-ctrl-scale",r.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(r){this._language=r,this._update()}setUnit(r){this.options.unit=r,this._update()}},FullscreenControl:class{constructor(r){this._fullscreen=!1,r&&r.container&&(r.container instanceof p.HTMLElement?this._container=r.container:xe("Full screen control 'container' must be a DOM element.")),pt(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in p.document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in p.document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(r){return this._map=r,this._container||(this._container=this._map.getContainer()),this._controlContainer=Qn("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",xe("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,p.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!p.document.fullscreenEnabled&&!p.document.webkitFullscreenEnabled)}_setupUI(){const r=this._fullscreenButton=Qn("button","mapboxgl-ctrl-fullscreen",this._controlContainer);Qn("span","mapboxgl-ctrl-icon",r).setAttribute("aria-hidden","true"),r.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),p.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const r=this._getTitle();this._fullscreenButton.setAttribute("aria-label",r),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",r)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(p.document.fullscreenElement||p.document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?p.document.exitFullscreen?p.document.exitFullscreen():p.document.webkitCancelFullScreen&&p.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends Vn{constructor(r){super(),this.options=Fe(Object.create(Uoe),r),pt(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(r&&r.className?r.className.trim().split(/\s+/):[])}addTo(r){return this._map&&this.remove(),this._map=r,this.options.closeOnClick&&r.on("preclick",this._onClose),this.options.closeOnMove&&r.on("move",this._onClose),r.on("remove",this.remove),this._update(),r._addPopup(this),this._focusFirstElement(),this._trackPointer?(r.on("mousemove",this._onMouseEvent),r.on("mouseup",this._onMouseEvent),r._canvasContainer.classList.add("mapboxgl-track-pointer")):r.on("move",this._update),this.fire(new $t("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const r=this._map;return r&&(r.off("move",this._update),r.off("move",this._onClose),r.off("preclick",this._onClose),r.off("click",this._onClose),r.off("remove",this.remove),r.off("mousemove",this._onMouseEvent),r.off("mouseup",this._onMouseEvent),r.off("drag",this._onMouseEvent),r._canvasContainer&&r._canvasContainer.classList.remove("mapboxgl-track-pointer"),r._removePopup(this),this._map=void 0),this.fire(new $t("close")),this}getLngLat(){return this._lngLat}setLngLat(r){this._lngLat=Nn.convert(r),this._pos=null,this._trackPointer=!1,this._update();const t=this._map;return t&&(t.on("move",this._update),t.off("mousemove",this._onMouseEvent),t._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const r=this._map;return r&&(r.off("move",this._update),r.on("mousemove",this._onMouseEvent),r.on("drag",this._onMouseEvent),r._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(r){return this.setDOMContent(p.document.createTextNode(r))}setHTML(r){const t=p.document.createDocumentFragment(),o=p.document.createElement("body");let c;for(o.innerHTML=r;c=o.firstChild,c;)t.appendChild(c);return this.setDOMContent(t)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(r){return this.options.maxWidth=r,this._update(),this}setDOMContent(r){let t=this._content;if(t)for(;t.hasChildNodes();)t.firstChild&&t.removeChild(t.firstChild);else t=this._content=Qn("div","mapboxgl-popup-content",this._container||void 0);if(t.appendChild(r),this.options.closeButton){const o=this._closeButton=Qn("button","mapboxgl-popup-close-button",t);o.type="button",o.setAttribute("aria-label","Close popup"),o.setAttribute("aria-hidden","true"),o.innerHTML="&#215;",o.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(r){return this._classList.add(r),this._updateClassList(),this}removeClassName(r){return this._classList.delete(r),this._updateClassList(),this}setOffset(r){return this.options.offset=r,this._update(),this}toggleClassName(r){let t;return this._classList.delete(r)?t=!1:(this._classList.add(r),t=!0),this._updateClassList(),t}_onMouseEvent(r){this._update(r.point)}_getAnchor(r){if(this.options.anchor)return this.options.anchor;const t=this._map,o=this._container,c=this._pos;if(!t||!o||!c)return"bottom";const u=o.offsetWidth,h=o.offsetHeight,m=c.x<u/2,g=c.x>t.transform.width-u/2;if(c.y+r<h)return m?"top-left":g?"top-right":"top";if(c.y>t.transform.height-h){if(m)return"bottom-left";if(g)return"bottom-right"}return m?"left":g?"right":"bottom"}_updateClassList(){const r=this._container;if(!r)return;const t=[...this._classList];t.push("mapboxgl-popup"),this._anchor&&t.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&t.push("mapboxgl-popup-track-pointer"),r.className=t.join(" ")}_update(r){const t=this._map,o=this._content;if(!t||!this._lngLat&&!this._trackPointer||!o)return;let c=this._container;if(c||(c=this._container=Qn("div","mapboxgl-popup",t.getContainer()),this._tip=Qn("div","mapboxgl-popup-tip",c),c.appendChild(o)),this.options.maxWidth&&c.style.maxWidth!==this.options.maxWidth&&(c.style.maxWidth=this.options.maxWidth),t.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=k8(this._lngLat,this._pos,t.transform)),!this._trackPointer||r){const u=this._pos=this._trackPointer&&r?r:t.project(this._lngLat),h=D8(this.options.offset),m=this._anchor=this._getAnchor(h.y),g=D8(this.options.offset,m),v=u.add(g).round();t._requestDomTask(()=>{this._container&&m&&(this._container.style.transform=`${GI[m]} translate(${v.x}px,${v.y}px)`)})}if(!this._marker&&t._showingGlobe()){const u=HS(t.transform,this._lngLat)?0:1;this._setOpacity(u)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const r=this._container.querySelector(Woe);r&&r.focus()}_onClose(){this.remove()}_setOpacity(r){this._container&&(this._container.style.opacity=`${r}`),this._content&&(this._content.style.pointerEvents=r?"auto":"none")}},Marker:HI,Style:ru,LngLat:Nn,LngLatBounds:Fl,Point:G,MercatorCoordinate:bi,FreeCameraOptions:jB,Evented:Vn,config:b,prewarm:function(){j1().acquire(pI)},clearPrewarmedResources:function(){const r=H1;r&&(r.isPreloaded()&&r.numActive()===1?(r.release(pI),H1=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return b.ACCESS_TOKEN},set accessToken(r){b.ACCESS_TOKEN=r},get baseApiUrl(){return b.API_URL},set baseApiUrl(r){b.API_URL=r},get workerCount(){return Iv.workerCount},set workerCount(r){Iv.workerCount=r},get maxParallelImageRequests(){return b.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(r){b.MAX_PARALLEL_IMAGE_REQUESTS=r},clearStorage(r){(function(t){if(!qt())return;const o=p.caches.delete(Dt);t&&o.catch(t).then(()=>t())})(r)},workerUrl:"",workerClass:null,get dracoUrl(){return oU()},set dracoUrl(r){(function(t){mI=Pn.resolveURL(t),gI||(gI=new Nm(j1(),new Vn)),gI.broadcast("setDracoUrl",mI)})(r)},setNow:Pn.setNow,restoreNow:Pn.restoreNow};f.A=K6,f.D=Rm,f.E=mt,f.F=NP,f.K=G2,f.O=ki,f.P=G,f.T=g6,f.V=i2,f.a=n2,f.b=YF,f.c=z2,f.d=class extends Vn{constructor(r,t,o,c,u,h){super(),this.actor=r,this.layerIndex=t,this.availableImages=o,this.loadVectorData=u||rU,this.loading={},this.loaded={},this.deduped=new iU(r.scheduler),this.isSpriteLoaded=c,this.scheduler=r.scheduler,this.brightness=h}loadTile(r,t){const o=r.uid,c=r&&r.request,u=c&&c.collectResourceTiming,h=this.loading[o]=new yre(r);h.abort=this.loadVectorData(r,(m,g)=>{const v=!this.loading[o];if(delete this.loading[o],v||m||!g)return h.status="done",v||(this.loaded[o]=h),t(m);const x=g.rawData,w={};g.expires&&(w.expires=g.expires),g.cacheControl&&(w.cacheControl=g.cacheControl),h.vectorTile=g.vectorTile||new kP(new s2(x));const E=()=>{h.parse(h.vectorTile,this.layerIndex,this.availableImages,this.actor,(C,I)=>{if(C||!I)return t(C);const D={};if(u){const N=fo(c);N.length>0&&(D.resourceTiming=JSON.parse(JSON.stringify(N)))}t(null,Fe({rawTileData:x.slice(0)},I,w,D))})};this.isSpriteLoaded?E():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(E,{type:"parseTile",isSymbolTile:r.isSymbolTile,zoom:r.tileZoom}):E()}),this.loaded=this.loaded||{},this.loaded[o]=h})}reloadTile(r,t){const o=this.loaded,c=r.uid,u=this;if(o&&o[c]){const h=o[c];h.showCollisionBoxes=r.showCollisionBoxes,h.projection=r.projection,h.brightness=r.brightness,h.tileTransform=Lm(r.tileID.canonical,r.projection),h.extraShadowCaster=r.extraShadowCaster;const m=(g,v)=>{const x=h.reloadCallback;x&&(delete h.reloadCallback,h.parse(h.vectorTile,u.layerIndex,this.availableImages,u.actor,x)),t(g,v)};h.status==="parsing"?h.reloadCallback=m:h.status==="done"&&(h.vectorTile?h.parse(h.vectorTile,this.layerIndex,this.availableImages,this.actor,m):m())}}abortTile(r,t){const o=r.uid,c=this.loading[o];c&&(c.abort&&c.abort(),delete this.loading[o]),t()}removeTile(r,t){const o=this.loaded,c=r.uid;o&&o[c]&&delete o[c],t()}},f.e=Hc,f.f=fo,f.g=O,f.h=tt,f.i=vt,f.j=function(r,t){const o=wI(r);for(const c of o){for(const u of c.meshes)Are(u);c.lights&&(c.lightMeshIndex=c.meshes.length,c.meshes.push(Cre(c.lights,t)))}return o},f.k=dr,f.l=async function(r){let t=0;if(new Uint32Array(r,0,1)[0]!==lU){const o=new Uint32Array(r,0,7),[,,c,u,h,m]=o;t=o.byteLength+u+h+m+h,(c!==r.byteLength||t>=r.byteLength)&&xe("Invalid b3dm header information.")}return hU(r,t)},f.m=g2,f.n=Ns,f.o=$t,f.p=Y,f.q=function(r){Ot(),$e&&$e.then(t=>{t.keys().then(o=>{for(let c=0;c<o.length-r;c++)t.delete(o[c])})})},f.r=yU,f.s=a3,f.t=_1,f.v=Ze,f.w=p}),l(["./shared"],function(f){function p(Ue){if(typeof Ue=="number"||typeof Ue=="boolean"||typeof Ue=="string"||Ue==null)return JSON.stringify(Ue);if(Array.isArray(Ue)){let se="[";for(const xe of Ue)se+=`${p(xe)},`;return`${se}]`}let ue="{";for(const se of Object.keys(Ue).sort())ue+=`${se}:${p(Ue[se])},`;return`${ue}}`}function y(Ue){let ue="";for(const se of f.r)ue+=`/${p(Ue[se])}`;return ue}class _{constructor(ue){this.keyCache={},ue&&this.replace(ue)}replace(ue,se){this._layerConfigs={},this._layers={},this.update(ue,[],se)}update(ue,se,xe){this._options=xe;for(const ze of ue){this._layerConfigs[ze.id]=ze;const st=this._layers[ze.id]=f.c(ze,this._options);st.setScope(this.scope),st.compileFilter(),this.keyCache[ze.id]&&delete this.keyCache[ze.id]}for(const ze of se)delete this.keyCache[ze],delete this._layerConfigs[ze],delete this._layers[ze];this.familiesBySource={};const Ye=function(ze,st){const de={};for(let Oe=0;Oe<ze.length;Oe++){const ut=st&&st[ze[Oe].id]||y(ze[Oe]);st&&(st[ze[Oe].id]=ut);let it=de[ut];it||(it=de[ut]=[]),it.push(ze[Oe])}const ie=[];for(const Oe in de)ie.push(de[Oe]);return ie}(f.v(this._layerConfigs),this.keyCache);for(const ze of Ye){const st=ze.map(lt=>this._layers[lt.id]),de=st[0];if(de.visibility==="none")continue;const ie=de.source||"";let Oe=this.familiesBySource[ie];Oe||(Oe=this.familiesBySource[ie]={});const ut=de.sourceLayer||"_geojsonTileLayer";let it=Oe[ut];it||(it=Oe[ut]=[]),it.push(st)}}}class b{loadTile(ue,se){const{uid:xe,encoding:Ye,rawImageData:ze,padding:st}=ue,de=f.w.ImageBitmap&&ze instanceof f.w.ImageBitmap?this.getImageData(ze,st):ze;se(null,new f.D(xe,de,Ye,ue.convertToFloat,st<1))}getImageData(ue,se){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(ue.width,ue.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=ue.width,this.offscreenCanvas.height=ue.height,this.offscreenCanvasContext.drawImage(ue,0,0,ue.width,ue.height);const xe=this.offscreenCanvasContext.getImageData(-se,-se,ue.width+2*se,ue.height+2*se);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),xe}}function S(Ue,ue){if(Ue.length!==0){A(Ue[0],ue);for(var se=1;se<Ue.length;se++)A(Ue[se],!ue)}}function A(Ue,ue){for(var se=0,xe=0,Ye=0,ze=Ue.length,st=ze-1;Ye<ze;st=Ye++){var de=(Ue[Ye][0]-Ue[st][0])*(Ue[st][1]+Ue[Ye][1]),ie=se+de;xe+=Math.abs(se)>=Math.abs(de)?se-ie+de:de-ie+se,se=ie}se+xe>=0!=!!ue&&Ue.reverse()}var P=f.g(function Ue(ue,se){var xe,Ye=ue&&ue.type;if(Ye==="FeatureCollection")for(xe=0;xe<ue.features.length;xe++)Ue(ue.features[xe],se);else if(Ye==="GeometryCollection")for(xe=0;xe<ue.geometries.length;xe++)Ue(ue.geometries[xe],se);else if(Ye==="Feature")Ue(ue.geometry,se);else if(Ye==="Polygon")S(ue.coordinates,se);else if(Ye==="MultiPolygon")for(xe=0;xe<ue.coordinates.length;xe++)S(ue.coordinates[xe],se);return ue});const L=f.V.prototype.toGeoJSON;var k={exports:{}},R=f.p,z=f.a.VectorTileFeature,O=F;function F(Ue,ue){this.options=ue||{},this.features=Ue,this.length=Ue.length}function H(Ue,ue){this.id=typeof Ue.id=="number"?Ue.id:void 0,this.type=Ue.type,this.rawGeometry=Ue.type===1?[Ue.geometry]:Ue.geometry,this.properties=Ue.tags,this.extent=ue||4096}F.prototype.feature=function(Ue){return new H(this.features[Ue],this.options.extent)},H.prototype.loadGeometry=function(){var Ue=this.rawGeometry;this.geometry=[];for(var ue=0;ue<Ue.length;ue++){for(var se=Ue[ue],xe=[],Ye=0;Ye<se.length;Ye++)xe.push(new R(se[Ye][0],se[Ye][1]));this.geometry.push(xe)}return this.geometry},H.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var Ue=this.geometry,ue=1/0,se=-1/0,xe=1/0,Ye=-1/0,ze=0;ze<Ue.length;ze++)for(var st=Ue[ze],de=0;de<st.length;de++){var ie=st[de];ue=Math.min(ue,ie.x),se=Math.max(se,ie.x),xe=Math.min(xe,ie.y),Ye=Math.max(Ye,ie.y)}return[ue,xe,se,Ye]},H.prototype.toGeoJSON=z.prototype.toGeoJSON;var $=f.b,Y=O;function te(Ue){var ue=new $;return function(se,xe){for(var Ye in se.layers)xe.writeMessage(3,G,se.layers[Ye])}(Ue,ue),ue.finish()}function G(Ue,ue){var se;ue.writeVarintField(15,Ue.version||1),ue.writeStringField(1,Ue.name||""),ue.writeVarintField(5,Ue.extent||4096);var xe={keys:[],values:[],keycache:{},valuecache:{}};for(se=0;se<Ue.length;se++)xe.feature=Ue.feature(se),ue.writeMessage(2,Q,xe);var Ye=xe.keys;for(se=0;se<Ye.length;se++)ue.writeStringField(3,Ye[se]);var ze=xe.values;for(se=0;se<ze.length;se++)ue.writeMessage(4,Ae,ze[se])}function Q(Ue,ue){var se=Ue.feature;se.id!==void 0&&ue.writeVarintField(1,se.id),ue.writeMessage(2,he,Ue),ue.writeVarintField(3,se.type),ue.writeMessage(4,fe,se)}function he(Ue,ue){var se=Ue.feature,xe=Ue.keys,Ye=Ue.values,ze=Ue.keycache,st=Ue.valuecache;for(var de in se.properties){var ie=se.properties[de],Oe=ze[de];if(ie!==null){Oe===void 0&&(xe.push(de),ze[de]=Oe=xe.length-1),ue.writeVarint(Oe);var ut=typeof ie;ut!=="string"&&ut!=="boolean"&&ut!=="number"&&(ie=JSON.stringify(ie));var it=ut+":"+ie,lt=st[it];lt===void 0&&(Ye.push(ie),st[it]=lt=Ye.length-1),ue.writeVarint(lt)}}}function pe(Ue,ue){return(ue<<3)+(7&Ue)}function ye(Ue){return Ue<<1^Ue>>31}function fe(Ue,ue){for(var se=Ue.loadGeometry(),xe=Ue.type,Ye=0,ze=0,st=se.length,de=0;de<st;de++){var ie=se[de],Oe=1;xe===1&&(Oe=ie.length),ue.writeVarint(pe(1,Oe));for(var ut=xe===3?ie.length-1:ie.length,it=0;it<ut;it++){it===1&&xe!==1&&ue.writeVarint(pe(2,ut-1));var lt=ie[it].x-Ye,Mt=ie[it].y-ze;ue.writeVarint(ye(lt)),ue.writeVarint(ye(Mt)),Ye+=lt,ze+=Mt}xe===3&&ue.writeVarint(pe(7,1))}}function Ae(Ue,ue){var se=typeof Ue;se==="string"?ue.writeStringField(1,Ue):se==="boolean"?ue.writeBooleanField(7,Ue):se==="number"&&(Ue%1!=0?ue.writeDoubleField(3,Ue):Ue<0?ue.writeSVarintField(6,Ue):ue.writeVarintField(5,Ue))}k.exports=te,k.exports.fromVectorTileJs=te,k.exports.fromGeojsonVt=function(Ue,ue){ue=ue||{};var se={};for(var xe in Ue)se[xe]=new Y(Ue[xe].features,ue),se[xe].name=xe,se[xe].version=ue.version,se[xe].extent=ue.extent;return te({layers:se})},k.exports.GeoJSONWrapper=Y;var Re=f.g(k.exports);const Be={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:Ue=>Ue},le=Math.fround||(me=new Float32Array(1),Ue=>(me[0]=+Ue,me[0]));var me;const we=3,re=5,Te=6;class Je{constructor(ue){this.options=Object.assign(Object.create(Be),ue),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(ue){const{log:se,minZoom:xe,maxZoom:Ye}=this.options;se&&console.time("total time");const ze=`prepare ${ue.length} points`;se&&console.time(ze),this.points=ue;const st=[];for(let ie=0;ie<ue.length;ie++){const Oe=ue[ie];if(!Oe.geometry)continue;const[ut,it]=Oe.geometry.coordinates,lt=le(Fe(ut)),Mt=le(ct(it));st.push(lt,Mt,1/0,ie,-1,1),this.options.reduce&&st.push(0)}let de=this.trees[Ye+1]=this._createTree(st);se&&console.timeEnd(ze);for(let ie=Ye;ie>=xe;ie--){const Oe=+Date.now();de=this.trees[ie]=this._createTree(this._cluster(de,ie)),se&&console.log("z%d: %d clusters in %dms",ie,de.numItems,+Date.now()-Oe)}return se&&console.timeEnd("total time"),this}getClusters(ue,se){let xe=((ue[0]+180)%360+360)%360-180;const Ye=Math.max(-90,Math.min(90,ue[1]));let ze=ue[2]===180?180:((ue[2]+180)%360+360)%360-180;const st=Math.max(-90,Math.min(90,ue[3]));if(ue[2]-ue[0]>=360)xe=-180,ze=180;else if(xe>ze){const it=this.getClusters([xe,Ye,180,st],se),lt=this.getClusters([-180,Ye,ze,st],se);return it.concat(lt)}const de=this.trees[this._limitZoom(se)],ie=de.range(Fe(xe),ct(st),Fe(ze),ct(Ye)),Oe=de.data,ut=[];for(const it of ie){const lt=this.stride*it;ut.push(Oe[lt+re]>1?Xe(Oe,lt,this.clusterProps):this.points[Oe[lt+we]])}return ut}getChildren(ue){const se=this._getOriginId(ue),xe=this._getOriginZoom(ue),Ye="No cluster with the specified id.",ze=this.trees[xe];if(!ze)throw new Error(Ye);const st=ze.data;if(se*this.stride>=st.length)throw new Error(Ye);const de=this.options.radius/(this.options.extent*Math.pow(2,xe-1)),ie=ze.within(st[se*this.stride],st[se*this.stride+1],de),Oe=[];for(const ut of ie){const it=ut*this.stride;st[it+4]===ue&&Oe.push(st[it+re]>1?Xe(st,it,this.clusterProps):this.points[st[it+we]])}if(Oe.length===0)throw new Error(Ye);return Oe}getLeaves(ue,se,xe){const Ye=[];return this._appendLeaves(Ye,ue,se=se||10,xe=xe||0,0),Ye}getTile(ue,se,xe){const Ye=this.trees[this._limitZoom(ue)],ze=Math.pow(2,ue),{extent:st,radius:de}=this.options,ie=de/st,Oe=(xe-ie)/ze,ut=(xe+1+ie)/ze,it={features:[]};return this._addTileFeatures(Ye.range((se-ie)/ze,Oe,(se+1+ie)/ze,ut),Ye.data,se,xe,ze,it),se===0&&this._addTileFeatures(Ye.range(1-ie/ze,Oe,1,ut),Ye.data,ze,xe,ze,it),se===ze-1&&this._addTileFeatures(Ye.range(0,Oe,ie/ze,ut),Ye.data,-1,xe,ze,it),it.features.length?it:null}getClusterExpansionZoom(ue){let se=this._getOriginZoom(ue)-1;for(;se<=this.options.maxZoom;){const xe=this.getChildren(ue);if(se++,xe.length!==1)break;ue=xe[0].properties.cluster_id}return se}_appendLeaves(ue,se,xe,Ye,ze){const st=this.getChildren(se);for(const de of st){const ie=de.properties;if(ie&&ie.cluster?ze+ie.point_count<=Ye?ze+=ie.point_count:ze=this._appendLeaves(ue,ie.cluster_id,xe,Ye,ze):ze<Ye?ze++:ue.push(de),ue.length===xe)break}return ze}_createTree(ue){const se=new f.K(ue.length/this.stride|0,this.options.nodeSize,Float32Array);for(let xe=0;xe<ue.length;xe+=this.stride)se.add(ue[xe],ue[xe+1]);return se.finish(),se.data=ue,se}_addTileFeatures(ue,se,xe,Ye,ze,st){for(const de of ue){const ie=de*this.stride,Oe=se[ie+re]>1;let ut,it,lt;if(Oe)ut=Ze(se,ie,this.clusterProps),it=se[ie],lt=se[ie+1];else{const Wt=this.points[se[ie+we]];ut=Wt.properties;const[Ht,Dt]=Wt.geometry.coordinates;it=Fe(Ht),lt=ct(Dt)}const Mt={type:1,geometry:[[Math.round(this.options.extent*(it*ze-xe)),Math.round(this.options.extent*(lt*ze-Ye))]],tags:ut};let Ut;Ut=Oe||this.options.generateId?se[ie+we]:this.points[se[ie+we]].id,Ut!==void 0&&(Mt.id=Ut),st.features.push(Mt)}}_limitZoom(ue){return Math.max(this.options.minZoom,Math.min(Math.floor(+ue),this.options.maxZoom+1))}_cluster(ue,se){const{radius:xe,extent:Ye,reduce:ze,minPoints:st}=this.options,de=xe/(Ye*Math.pow(2,se)),ie=ue.data,Oe=[],ut=this.stride;for(let it=0;it<ie.length;it+=ut){if(ie[it+2]<=se)continue;ie[it+2]=se;const lt=ie[it],Mt=ie[it+1],Ut=ue.within(ie[it],ie[it+1],de),Wt=ie[it+re];let Ht=Wt;for(const Dt of Ut){const wt=Dt*ut;ie[wt+2]>se&&(Ht+=ie[wt+re])}if(Ht>Wt&&Ht>=st){let Dt,wt=lt*Wt,Xt=Mt*Wt,$e=-1;const Pt=((it/ut|0)<<5)+(se+1)+this.points.length;for(const qt of Ut){const Ot=qt*ut;if(ie[Ot+2]<=se)continue;ie[Ot+2]=se;const fn=ie[Ot+re];wt+=ie[Ot]*fn,Xt+=ie[Ot+1]*fn,ie[Ot+4]=Pt,ze&&(Dt||(Dt=this._map(ie,it,!0),$e=this.clusterProps.length,this.clusterProps.push(Dt)),ze(Dt,this._map(ie,Ot)))}ie[it+4]=Pt,Oe.push(wt/Ht,Xt/Ht,1/0,Pt,-1,Ht),ze&&Oe.push($e)}else{for(let Dt=0;Dt<ut;Dt++)Oe.push(ie[it+Dt]);if(Ht>1)for(const Dt of Ut){const wt=Dt*ut;if(!(ie[wt+2]<=se)){ie[wt+2]=se;for(let Xt=0;Xt<ut;Xt++)Oe.push(ie[wt+Xt])}}}}return Oe}_getOriginId(ue){return ue-this.points.length>>5}_getOriginZoom(ue){return(ue-this.points.length)%32}_map(ue,se,xe){if(ue[se+re]>1){const st=this.clusterProps[ue[se+Te]];return xe?Object.assign({},st):st}const Ye=this.points[ue[se+we]].properties,ze=this.options.map(Ye);return xe&&ze===Ye?Object.assign({},ze):ze}}function Xe(Ue,ue,se){return{type:"Feature",id:Ue[ue+we],properties:Ze(Ue,ue,se),geometry:{type:"Point",coordinates:[(xe=Ue[ue],360*(xe-.5)),At(Ue[ue+1])]}};var xe}function Ze(Ue,ue,se){const xe=Ue[ue+re],Ye=xe>=1e4?`${Math.round(xe/1e3)}k`:xe>=1e3?Math.round(xe/100)/10+"k":xe,ze=Ue[ue+Te],st=ze===-1?{}:Object.assign({},se[ze]);return Object.assign(st,{cluster:!0,cluster_id:Ue[ue+we],point_count:xe,point_count_abbreviated:Ye})}function Fe(Ue){return Ue/360+.5}function ct(Ue){const ue=Math.sin(Ue*Math.PI/180),se=.5-.25*Math.log((1+ue)/(1-ue))/Math.PI;return se<0?0:se>1?1:se}function At(Ue){const ue=(180-360*Ue)*Math.PI/180;return 360*Math.atan(Math.exp(ue))/Math.PI-90}var kt={exports:{}};kt.exports=function(){function Ue(Se,Ce,Ne,et){for(var tt,vt=et,ht=Ne-Ce>>1,dt=Ne-Ce,Vt=Se[Ce],It=Se[Ce+1],Qt=Se[Ne],mn=Se[Ne+1],en=Ce+3;en<Ne;en+=3){var _n=ue(Se[en],Se[en+1],Vt,It,Qt,mn);if(_n>vt)tt=en,vt=_n;else if(_n===vt){var Hn=Math.abs(en-ht);Hn<dt&&(tt=en,dt=Hn)}}vt>et&&(tt-Ce>3&&Ue(Se,Ce,tt,et),Se[tt+2]=vt,Ne-tt>3&&Ue(Se,tt,Ne,et))}function ue(Se,Ce,Ne,et,tt,vt){var ht=tt-Ne,dt=vt-et;if(ht!==0||dt!==0){var Vt=((Se-Ne)*ht+(Ce-et)*dt)/(ht*ht+dt*dt);Vt>1?(Ne=tt,et=vt):Vt>0&&(Ne+=ht*Vt,et+=dt*Vt)}return(ht=Se-Ne)*ht+(dt=Ce-et)*dt}function se(Se,Ce,Ne,et){var tt={id:Se===void 0?null:Se,type:Ce,geometry:Ne,tags:et,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(vt){var ht=vt.geometry,dt=vt.type;if(dt==="Point"||dt==="MultiPoint"||dt==="LineString")xe(vt,ht);else if(dt==="Polygon"||dt==="MultiLineString")for(var Vt=0;Vt<ht.length;Vt++)xe(vt,ht[Vt]);else if(dt==="MultiPolygon")for(Vt=0;Vt<ht.length;Vt++)for(var It=0;It<ht[Vt].length;It++)xe(vt,ht[Vt][It])}(tt),tt}function xe(Se,Ce){for(var Ne=0;Ne<Ce.length;Ne+=3)Se.minX=Math.min(Se.minX,Ce[Ne]),Se.minY=Math.min(Se.minY,Ce[Ne+1]),Se.maxX=Math.max(Se.maxX,Ce[Ne]),Se.maxY=Math.max(Se.maxY,Ce[Ne+1])}function Ye(Se,Ce,Ne,et){if(Ce.geometry){var tt=Ce.geometry.coordinates,vt=Ce.geometry.type,ht=Math.pow(Ne.tolerance/((1<<Ne.maxZoom)*Ne.extent),2),dt=[],Vt=Ce.id;if(Ne.promoteId?Vt=Ce.properties[Ne.promoteId]:Ne.generateId&&(Vt=et||0),vt==="Point")ze(tt,dt);else if(vt==="MultiPoint")for(var It=0;It<tt.length;It++)ze(tt[It],dt);else if(vt==="LineString")st(tt,dt,ht,!1);else if(vt==="MultiLineString"){if(Ne.lineMetrics){for(It=0;It<tt.length;It++)st(tt[It],dt=[],ht,!1),Se.push(se(Vt,"LineString",dt,Ce.properties));return}de(tt,dt,ht,!1)}else if(vt==="Polygon")de(tt,dt,ht,!0);else{if(vt!=="MultiPolygon"){if(vt==="GeometryCollection"){for(It=0;It<Ce.geometry.geometries.length;It++)Ye(Se,{id:Vt,geometry:Ce.geometry.geometries[It],properties:Ce.properties},Ne,et);return}throw new Error("Input data is not a valid GeoJSON object.")}for(It=0;It<tt.length;It++){var Qt=[];de(tt[It],Qt,ht,!0),dt.push(Qt)}}Se.push(se(Vt,vt,dt,Ce.properties))}}function ze(Se,Ce){Ce.push(ie(Se[0])),Ce.push(Oe(Se[1])),Ce.push(0)}function st(Se,Ce,Ne,et){for(var tt,vt,ht=0,dt=0;dt<Se.length;dt++){var Vt=ie(Se[dt][0]),It=Oe(Se[dt][1]);Ce.push(Vt),Ce.push(It),Ce.push(0),dt>0&&(ht+=et?(tt*It-Vt*vt)/2:Math.sqrt(Math.pow(Vt-tt,2)+Math.pow(It-vt,2))),tt=Vt,vt=It}var Qt=Ce.length-3;Ce[2]=1,Ue(Ce,0,Qt,Ne),Ce[Qt+2]=1,Ce.size=Math.abs(ht),Ce.start=0,Ce.end=Ce.size}function de(Se,Ce,Ne,et){for(var tt=0;tt<Se.length;tt++){var vt=[];st(Se[tt],vt,Ne,et),Ce.push(vt)}}function ie(Se){return Se/360+.5}function Oe(Se){var Ce=Math.sin(Se*Math.PI/180),Ne=.5-.25*Math.log((1+Ce)/(1-Ce))/Math.PI;return Ne<0?0:Ne>1?1:Ne}function ut(Se,Ce,Ne,et,tt,vt,ht,dt){if(et/=Ce,vt>=(Ne/=Ce)&&ht<et)return Se;if(ht<Ne||vt>=et)return null;for(var Vt=[],It=0;It<Se.length;It++){var Qt=Se[It],mn=Qt.geometry,en=Qt.type,_n=tt===0?Qt.minX:Qt.minY,Hn=tt===0?Qt.maxX:Qt.maxY;if(_n>=Ne&&Hn<et)Vt.push(Qt);else if(!(Hn<Ne||_n>=et)){var ni=[];if(en==="Point"||en==="MultiPoint")it(mn,ni,Ne,et,tt);else if(en==="LineString")lt(mn,ni,Ne,et,tt,!1,dt.lineMetrics);else if(en==="MultiLineString")Ut(mn,ni,Ne,et,tt,!1);else if(en==="Polygon")Ut(mn,ni,Ne,et,tt,!0);else if(en==="MultiPolygon")for(var Ei=0;Ei<mn.length;Ei++){var Mi=[];Ut(mn[Ei],Mi,Ne,et,tt,!0),Mi.length&&ni.push(Mi)}if(ni.length){if(dt.lineMetrics&&en==="LineString"){for(Ei=0;Ei<ni.length;Ei++)Vt.push(se(Qt.id,en,ni[Ei],Qt.tags));continue}en!=="LineString"&&en!=="MultiLineString"||(ni.length===1?(en="LineString",ni=ni[0]):en="MultiLineString"),en!=="Point"&&en!=="MultiPoint"||(en=ni.length===3?"Point":"MultiPoint"),Vt.push(se(Qt.id,en,ni,Qt.tags))}}}return Vt.length?Vt:null}function it(Se,Ce,Ne,et,tt){for(var vt=0;vt<Se.length;vt+=3){var ht=Se[vt+tt];ht>=Ne&&ht<=et&&(Ce.push(Se[vt]),Ce.push(Se[vt+1]),Ce.push(Se[vt+2]))}}function lt(Se,Ce,Ne,et,tt,vt,ht){for(var dt,Vt,It=Mt(Se),Qt=tt===0?Ht:Dt,mn=Se.start,en=0;en<Se.length-3;en+=3){var _n=Se[en],Hn=Se[en+1],ni=Se[en+2],Ei=Se[en+3],Mi=Se[en+4],gr=tt===0?_n:Hn,sr=tt===0?Ei:Mi,ke=!1;ht&&(dt=Math.sqrt(Math.pow(_n-Ei,2)+Math.pow(Hn-Mi,2))),gr<Ne?sr>Ne&&(Vt=Qt(It,_n,Hn,Ei,Mi,Ne),ht&&(It.start=mn+dt*Vt)):gr>et?sr<et&&(Vt=Qt(It,_n,Hn,Ei,Mi,et),ht&&(It.start=mn+dt*Vt)):Wt(It,_n,Hn,ni),sr<Ne&&gr>=Ne&&(Vt=Qt(It,_n,Hn,Ei,Mi,Ne),ke=!0),sr>et&&gr<=et&&(Vt=Qt(It,_n,Hn,Ei,Mi,et),ke=!0),!vt&&ke&&(ht&&(It.end=mn+dt*Vt),Ce.push(It),It=Mt(Se)),ht&&(mn+=dt)}var xt=Se.length-3;_n=Se[xt],Hn=Se[xt+1],ni=Se[xt+2],(gr=tt===0?_n:Hn)>=Ne&&gr<=et&&Wt(It,_n,Hn,ni),xt=It.length-3,vt&&xt>=3&&(It[xt]!==It[0]||It[xt+1]!==It[1])&&Wt(It,It[0],It[1],It[2]),It.length&&Ce.push(It)}function Mt(Se){var Ce=[];return Ce.size=Se.size,Ce.start=Se.start,Ce.end=Se.end,Ce}function Ut(Se,Ce,Ne,et,tt,vt){for(var ht=0;ht<Se.length;ht++)lt(Se[ht],Ce,Ne,et,tt,vt,!1)}function Wt(Se,Ce,Ne,et){Se.push(Ce),Se.push(Ne),Se.push(et)}function Ht(Se,Ce,Ne,et,tt,vt){var ht=(vt-Ce)/(et-Ce);return Se.push(vt),Se.push(Ne+(tt-Ne)*ht),Se.push(1),ht}function Dt(Se,Ce,Ne,et,tt,vt){var ht=(vt-Ne)/(tt-Ne);return Se.push(Ce+(et-Ce)*ht),Se.push(vt),Se.push(1),ht}function wt(Se,Ce){for(var Ne=[],et=0;et<Se.length;et++){var tt,vt=Se[et],ht=vt.type;if(ht==="Point"||ht==="MultiPoint"||ht==="LineString")tt=Xt(vt.geometry,Ce);else if(ht==="MultiLineString"||ht==="Polygon"){tt=[];for(var dt=0;dt<vt.geometry.length;dt++)tt.push(Xt(vt.geometry[dt],Ce))}else if(ht==="MultiPolygon")for(tt=[],dt=0;dt<vt.geometry.length;dt++){for(var Vt=[],It=0;It<vt.geometry[dt].length;It++)Vt.push(Xt(vt.geometry[dt][It],Ce));tt.push(Vt)}Ne.push(se(vt.id,ht,tt,vt.tags))}return Ne}function Xt(Se,Ce){var Ne=[];Ne.size=Se.size,Se.start!==void 0&&(Ne.start=Se.start,Ne.end=Se.end);for(var et=0;et<Se.length;et+=3)Ne.push(Se[et]+Ce,Se[et+1],Se[et+2]);return Ne}function $e(Se,Ce){if(Se.transformed)return Se;var Ne,et,tt,vt=1<<Se.z,ht=Se.x,dt=Se.y;for(Ne=0;Ne<Se.features.length;Ne++){var Vt=Se.features[Ne],It=Vt.geometry,Qt=Vt.type;if(Vt.geometry=[],Qt===1)for(et=0;et<It.length;et+=2)Vt.geometry.push(Pt(It[et],It[et+1],Ce,vt,ht,dt));else for(et=0;et<It.length;et++){var mn=[];for(tt=0;tt<It[et].length;tt+=2)mn.push(Pt(It[et][tt],It[et][tt+1],Ce,vt,ht,dt));Vt.geometry.push(mn)}}return Se.transformed=!0,Se}function Pt(Se,Ce,Ne,et,tt,vt){return[Math.round(Ne*(Se*et-tt)),Math.round(Ne*(Ce*et-vt))]}function qt(Se,Ce,Ne,et,tt){for(var vt=Ce===tt.maxZoom?0:tt.tolerance/((1<<Ce)*tt.extent),ht={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:Ne,y:et,z:Ce,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},dt=0;dt<Se.length;dt++){ht.numFeatures++,Ot(ht,Se[dt],vt,tt);var Vt=Se[dt].minX,It=Se[dt].minY,Qt=Se[dt].maxX,mn=Se[dt].maxY;Vt<ht.minX&&(ht.minX=Vt),It<ht.minY&&(ht.minY=It),Qt>ht.maxX&&(ht.maxX=Qt),mn>ht.maxY&&(ht.maxY=mn)}return ht}function Ot(Se,Ce,Ne,et){var tt=Ce.geometry,vt=Ce.type,ht=[];if(vt==="Point"||vt==="MultiPoint")for(var dt=0;dt<tt.length;dt+=3)ht.push(tt[dt]),ht.push(tt[dt+1]),Se.numPoints++,Se.numSimplified++;else if(vt==="LineString")fn(ht,tt,Se,Ne,!1,!1);else if(vt==="MultiLineString"||vt==="Polygon")for(dt=0;dt<tt.length;dt++)fn(ht,tt[dt],Se,Ne,vt==="Polygon",dt===0);else if(vt==="MultiPolygon")for(var Vt=0;Vt<tt.length;Vt++){var It=tt[Vt];for(dt=0;dt<It.length;dt++)fn(ht,It[dt],Se,Ne,!0,dt===0)}if(ht.length){var Qt=Ce.tags||null;if(vt==="LineString"&&et.lineMetrics){for(var mn in Qt={},Ce.tags)Qt[mn]=Ce.tags[mn];Qt.mapbox_clip_start=tt.start/tt.size,Qt.mapbox_clip_end=tt.end/tt.size}var en={geometry:ht,type:vt==="Polygon"||vt==="MultiPolygon"?3:vt==="LineString"||vt==="MultiLineString"?2:1,tags:Qt};Ce.id!==null&&(en.id=Ce.id),Se.features.push(en)}}function fn(Se,Ce,Ne,et,tt,vt){var ht=et*et;if(et>0&&Ce.size<(tt?ht:et))Ne.numPoints+=Ce.length/3;else{for(var dt=[],Vt=0;Vt<Ce.length;Vt+=3)(et===0||Ce[Vt+2]>ht)&&(Ne.numSimplified++,dt.push(Ce[Vt]),dt.push(Ce[Vt+1])),Ne.numPoints++;tt&&function(It,Qt){for(var mn=0,en=0,_n=It.length,Hn=_n-2;en<_n;Hn=en,en+=2)mn+=(It[en]-It[Hn])*(It[en+1]+It[Hn+1]);if(mn>0===Qt)for(en=0,_n=It.length;en<_n/2;en+=2){var ni=It[en],Ei=It[en+1];It[en]=It[_n-2-en],It[en+1]=It[_n-1-en],It[_n-2-en]=ni,It[_n-1-en]=Ei}}(dt,vt),Se.push(dt)}}function be(Se,Ce){var Ne=(Ce=this.options=function(tt,vt){for(var ht in vt)tt[ht]=vt[ht];return tt}(Object.create(this.options),Ce)).debug;if(Ne&&console.time("preprocess data"),Ce.maxZoom<0||Ce.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(Ce.promoteId&&Ce.generateId)throw new Error("promoteId and generateId cannot be used together.");var et=function(tt,vt){var ht=[];if(tt.type==="FeatureCollection")for(var dt=0;dt<tt.features.length;dt++)Ye(ht,tt.features[dt],vt,dt);else Ye(ht,tt.type==="Feature"?tt:{geometry:tt},vt);return ht}(Se,Ce);this.tiles={},this.tileCoords=[],Ne&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",Ce.indexMaxZoom,Ce.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(et=function(tt,vt){var ht=vt.buffer/vt.extent,dt=tt,Vt=ut(tt,1,-1-ht,ht,0,-1,2,vt),It=ut(tt,1,1-ht,2+ht,0,-1,2,vt);return(Vt||It)&&(dt=ut(tt,1,-ht,1+ht,0,-1,2,vt)||[],Vt&&(dt=wt(Vt,1).concat(dt)),It&&(dt=dt.concat(wt(It,-1)))),dt}(et,Ce)).length&&this.splitTile(et,0,0,0),Ne&&(et.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function Qe(Se,Ce,Ne){return 32*((1<<Se)*Ne+Ce)+Se}return be.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},be.prototype.splitTile=function(Se,Ce,Ne,et,tt,vt,ht){for(var dt=[Se,Ce,Ne,et],Vt=this.options,It=Vt.debug;dt.length;){et=dt.pop(),Ne=dt.pop(),Ce=dt.pop(),Se=dt.pop();var Qt=1<<Ce,mn=Qe(Ce,Ne,et),en=this.tiles[mn];if(!en&&(It>1&&console.time("creation"),en=this.tiles[mn]=qt(Se,Ce,Ne,et,Vt),this.tileCoords.push({z:Ce,x:Ne,y:et}),It)){It>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",Ce,Ne,et,en.numFeatures,en.numPoints,en.numSimplified),console.timeEnd("creation"));var _n="z"+Ce;this.stats[_n]=(this.stats[_n]||0)+1,this.total++}if(en.source=Se,tt){if(Ce===Vt.maxZoom||Ce===tt)continue;var Hn=1<<tt-Ce;if(Ne!==Math.floor(vt/Hn)||et!==Math.floor(ht/Hn))continue}else if(Ce===Vt.indexMaxZoom||en.numPoints<=Vt.indexMaxPoints)continue;if(en.source=null,Se.length!==0){It>1&&console.time("clipping");var ni,Ei,Mi,gr,sr,ke,xt=.5*Vt.buffer/Vt.extent,zt=.5-xt,Rt=.5+xt,Nt=1+xt;ni=Ei=Mi=gr=null,sr=ut(Se,Qt,Ne-xt,Ne+Rt,0,en.minX,en.maxX,Vt),ke=ut(Se,Qt,Ne+zt,Ne+Nt,0,en.minX,en.maxX,Vt),Se=null,sr&&(ni=ut(sr,Qt,et-xt,et+Rt,1,en.minY,en.maxY,Vt),Ei=ut(sr,Qt,et+zt,et+Nt,1,en.minY,en.maxY,Vt),sr=null),ke&&(Mi=ut(ke,Qt,et-xt,et+Rt,1,en.minY,en.maxY,Vt),gr=ut(ke,Qt,et+zt,et+Nt,1,en.minY,en.maxY,Vt),ke=null),It>1&&console.timeEnd("clipping"),dt.push(ni||[],Ce+1,2*Ne,2*et),dt.push(Ei||[],Ce+1,2*Ne,2*et+1),dt.push(Mi||[],Ce+1,2*Ne+1,2*et),dt.push(gr||[],Ce+1,2*Ne+1,2*et+1)}}},be.prototype.getTile=function(Se,Ce,Ne){var et=this.options,tt=et.extent,vt=et.debug;if(Se<0||Se>24)return null;var ht=1<<Se,dt=Qe(Se,Ce=(Ce%ht+ht)%ht,Ne);if(this.tiles[dt])return $e(this.tiles[dt],tt);vt>1&&console.log("drilling down to z%d-%d-%d",Se,Ce,Ne);for(var Vt,It=Se,Qt=Ce,mn=Ne;!Vt&&It>0;)It--,Qt=Math.floor(Qt/2),mn=Math.floor(mn/2),Vt=this.tiles[Qe(It,Qt,mn)];return Vt&&Vt.source?(vt>1&&console.log("found parent tile z%d-%d-%d",It,Qt,mn),vt>1&&console.time("drilling down"),this.splitTile(Vt.source,It,Qt,mn,Se,Ce,Ne),vt>1&&console.timeEnd("drilling down"),this.tiles[dt]?$e(this.tiles[dt],tt):null):null},function(Se,Ce){return new be(Se,Ce)}}();var Kt=f.g(kt.exports);function Et(Ue,ue){const se=Ue.tileID.canonical;if(!this._geoJSONIndex)return ue(null,null);const xe=this._geoJSONIndex.getTile(se.z,se.x,se.y);if(!xe)return ue(null,null);const Ye=new class{constructor(st){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=f.E,this.length=st.length,this._features=st}feature(st){return new class{constructor(de){this._feature=de,this.extent=f.E,this.type=de.type,this.properties=de.tags,"id"in de&&!isNaN(de.id)&&(this.id=parseInt(de.id,10))}loadGeometry(){if(this._feature.type===1){const de=[];for(const ie of this._feature.geometry)de.push([new f.P(ie[0],ie[1])]);return de}{const de=[];for(const ie of this._feature.geometry){const Oe=[];for(const ut of ie)Oe.push(new f.P(ut[0],ut[1]));de.push(Oe)}return de}}toGeoJSON(de,ie,Oe){return L.call(this,de,ie,Oe)}}(this._features[st])}}(xe.features);let ze=Re(Ye);ze.byteOffset===0&&ze.byteLength===ze.buffer.byteLength||(ze=new Uint8Array(ze)),ue(null,{vectorTile:Ye,rawData:ze.buffer})}class Ie extends f.d{constructor(ue,se,xe,Ye,ze,st){super(ue,se,xe,Ye,Et,st),ze&&(this.loadGeoJSON=ze)}loadData(ue,se){const xe=ue&&ue.request,Ye=xe&&xe.collectResourceTiming;this.loadGeoJSON(ue,(ze,st)=>{if(ze||!st)return se(ze);if(typeof st!="object")return se(new Error(`Input data given to '${ue.source}' is not a valid GeoJSON object.`));{P(st,!0);try{if(ue.filter){const ie=f.e(ue.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(ie.result==="error")throw new Error(ie.value.map(ut=>`${ut.key}: ${ut.message}`).join(", "));st={type:"FeatureCollection",features:st.features.filter(ut=>ie.value.evaluate({zoom:0},ut))}}this._geoJSONIndex=ue.cluster?new Je(function({superclusterOptions:ie,clusterProperties:Oe}){if(!Oe||!ie)return ie;const ut={},it={},lt={accumulated:null,zoom:0},Mt={properties:null},Ut=Object.keys(Oe);for(const Wt of Ut){const[Ht,Dt]=Oe[Wt],wt=f.e(Dt),Xt=f.e(typeof Ht=="string"?[Ht,["accumulated"],["get",Wt]]:Ht);ut[Wt]=wt.value,it[Wt]=Xt.value}return ie.map=Wt=>{Mt.properties=Wt;const Ht={};for(const Dt of Ut)Ht[Dt]=ut[Dt].evaluate(lt,Mt);return Ht},ie.reduce=(Wt,Ht)=>{Mt.properties=Ht;for(const Dt of Ut)lt.accumulated=Wt[Dt],Wt[Dt]=it[Dt].evaluate(lt,Mt)},ie}(ue)).load(st.features):Kt(st,ue.geojsonVtOptions)}catch(ie){return se(ie)}this.loaded={};const de={};if(Ye){const ie=f.f(xe);ie&&(de.resourceTiming={},de.resourceTiming[ue.source]=JSON.parse(JSON.stringify(ie)))}se(null,de)}})}reloadTile(ue,se){const xe=this.loaded;return xe&&xe[ue.uid]?super.reloadTile(ue,se):this.loadTile(ue,se)}loadGeoJSON(ue,se){if(ue.request)f.h(ue.request,se);else{if(typeof ue.data!="string")return se(new Error(`Input data given to '${ue.source}' is not a valid GeoJSON object.`));try{return se(null,JSON.parse(ue.data))}catch{return se(new Error(`Input data given to '${ue.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(ue,se){try{se(null,this._geoJSONIndex.getClusterExpansionZoom(ue.clusterId))}catch(xe){se(xe)}}getClusterChildren(ue,se){try{se(null,this._geoJSONIndex.getChildren(ue.clusterId))}catch(xe){se(xe)}}getClusterLeaves(ue,se){try{se(null,this._geoJSONIndex.getLeaves(ue.clusterId,ue.limit,ue.offset))}catch(xe){se(xe)}}}class pt{constructor(ue,se){this.tileID=new f.O(ue.tileID.overscaledZ,ue.tileID.wrap,ue.tileID.canonical.z,ue.tileID.canonical.x,ue.tileID.canonical.y),this.tileZoom=ue.tileZoom,this.uid=ue.uid,this.zoom=ue.zoom,this.canonical=ue.tileID.canonical,this.pixelRatio=ue.pixelRatio,this.tileSize=ue.tileSize,this.source=ue.source,this.overscaling=this.tileID.overscaleFactor(),this.projection=ue.projection,this.brightness=se}async parse(ue,se,xe,Ye){this.status="parsing";const ze=new f.O(xe.tileID.overscaledZ,xe.tileID.wrap,xe.tileID.canonical.z,xe.tileID.canonical.x,xe.tileID.canonical.y),st={},de=se.familiesBySource[xe.source],ie=new f.F(ze,xe.promoteId);ie.bucketLayerIDs=[];const Oe=await f.l(ue).catch(Mt=>Ye(new Error(Mt.message)));if(!Oe)return Ye(new Error("Could not parse tile"));const ut=f.j(Oe,1/f.t(xe.tileID.canonical)),it=Oe.json.extensionsUsed&&Oe.json.extensionsUsed.includes("MAPBOX_mesh_features"),lt=new f.k(this.zoom,{brightness:this.brightness});for(const Mt in de)for(const Ut of de[Mt]){const Wt=Ut[0],Ht=Oe.json.extensionsUsed;Wt.recalculate(lt,[]);const Dt=new f.T(ut,ze,Ht&&Ht.includes("MAPBOX_mesh_features"),this.brightness);it||(Dt.needsUpload=!0),st[Wt.fqid]=Dt,Dt.evaluate(Wt)}this.status="done",Ye(null,{buckets:st,featureIndex:ie})}}class gt{constructor(ue,se,xe,Ye,ze,st){this.actor=ue,this.layerIndex=se,this.brightness=st,this.loading={},this.loaded={}}loadTile(ue,se){const xe=ue.uid,Ye=this.loading[xe]=new pt(ue,this.brightness);f.i(ue.request,(ze,st)=>{const de=!this.loading[xe];return delete this.loading[xe],de||ze?(Ye.status="done",de||(this.loaded[xe]=Ye),se(ze)):st&&st.byteLength!==0?void Ye.parse(st,this.layerIndex,ue,(ie,Oe)=>{Ye.status="done",this.loaded=this.loaded||{},this.loaded[xe]=Ye,ie||!Oe?se(ie):se(null,Oe)}):(Ye.status="done",this.loaded[xe]=Ye,se())})}reloadTile(ue,se){const xe=this.loaded,Ye=ue.uid;if(xe&&xe[Ye]){const ze=xe[Ye];ze.projection=ue.projection,ze.brightness=ue.brightness;const st=(de,ie)=>{ze.reloadCallback&&(delete ze.reloadCallback,this.loadTile(ue,se)),se(de,ie)};ze.status==="parsing"?ze.reloadCallback=st:ze.status==="done"&&this.loadTile(ue,se)}}abortTile(ue,se){const xe=ue.uid;this.loading[xe]&&delete this.loading[xe],se()}removeTile(ue,se){const xe=this.loaded,Ye=ue.uid;xe&&xe[Ye]&&delete xe[Ye],se()}}class _t{constructor(ue){this.self=ue,this.actor=new f.A(ue,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=f.m({name:"mercator"}),this.workerSourceTypes={vector:f.d,geojson:Ie,"batched-model":gt},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(se,xe)=>{if(this.workerSourceTypes[se])throw new Error(`Worker source with name "${se}" already registered.`);this.workerSourceTypes[se]=xe},this.self.registerRTLTextPlugin=se=>{if(f.n.isParsed())throw new Error("RTL text plugin already registered.");f.n.applyArabicShaping=se.applyArabicShaping,f.n.processBidirectionalText=se.processBidirectionalText,f.n.processStyledBidirectionalText=se.processStyledBidirectionalText}}clearCaches(ue,se,xe){delete this.layerIndexes[ue],delete this.availableImages[ue],delete this.workerSources[ue],delete this.demWorkerSources[ue],xe()}checkIfReady(ue,se,xe){xe()}setReferrer(ue,se){this.referrer=se}spriteLoaded(ue,{scope:se,isLoaded:xe}){if(this.isSpriteLoaded[ue]||(this.isSpriteLoaded[ue]={}),this.isSpriteLoaded[ue][se]=xe,this.workerSources[ue]&&this.workerSources[ue][se])for(const Ye in this.workerSources[ue][se]){const ze=this.workerSources[ue][se][Ye];for(const st in ze)ze[st]instanceof f.d&&(ze[st].isSpriteLoaded=xe,ze[st].fire(new f.o("isSpriteLoaded")))}}setImages(ue,{scope:se,images:xe},Ye){if(this.availableImages[ue]||(this.availableImages[ue]={}),this.availableImages[ue][se]=xe,this.workerSources[ue]&&this.workerSources[ue][se]){for(const ze in this.workerSources[ue][se]){const st=this.workerSources[ue][se][ze];for(const de in st)st[de].availableImages=xe}Ye()}else Ye()}setProjection(ue,se){this.projections[ue]=f.m(se)}setBrightness(ue,se,xe){this.brightness=se,xe()}setLayers(ue,se,xe){this.getLayerIndex(ue,se.scope).replace(se.layers,se.options),xe()}updateLayers(ue,se,xe){this.getLayerIndex(ue,se.scope).update(se.layers,se.removedIds,se.options),xe()}loadTile(ue,se,xe){se.projection=this.projections[ue]||this.defaultProjection,this.getWorkerSource(ue,se.type,se.source,se.scope).loadTile(se,xe)}loadDEMTile(ue,se,xe){this.getDEMWorkerSource(ue,se.source,se.scope).loadTile(se,xe)}reloadTile(ue,se,xe){se.projection=this.projections[ue]||this.defaultProjection,this.getWorkerSource(ue,se.type,se.source,se.scope).reloadTile(se,xe)}abortTile(ue,se,xe){this.getWorkerSource(ue,se.type,se.source,se.scope).abortTile(se,xe)}removeTile(ue,se,xe){this.getWorkerSource(ue,se.type,se.source,se.scope).removeTile(se,xe)}removeSource(ue,se,xe){if(!(this.workerSources[ue]&&this.workerSources[ue][se.scope]&&this.workerSources[ue][se.scope][se.type]&&this.workerSources[ue][se.scope][se.type][se.source]))return;const Ye=this.workerSources[ue][se.scope][se.type][se.source];delete this.workerSources[ue][se.scope][se.type][se.source],Ye.removeSource!==void 0?Ye.removeSource(se,xe):xe()}loadWorkerSource(ue,se,xe){try{this.self.importScripts(se.url),xe()}catch(Ye){xe(Ye.toString())}}syncRTLPluginState(ue,se,xe){try{f.n.setState(se);const Ye=f.n.getPluginURL();if(f.n.isLoaded()&&!f.n.isParsed()&&Ye!=null){this.self.importScripts(Ye);const ze=f.n.isParsed();xe(ze?void 0:new Error(`RTL Text Plugin failed to import scripts from ${Ye}`),ze)}}catch(Ye){xe(Ye.toString())}}setDracoUrl(ue,se){this.dracoUrl=se}getAvailableImages(ue,se){this.availableImages[ue]||(this.availableImages[ue]={});let xe=this.availableImages[ue][se];return xe||(xe=[]),xe}getLayerIndex(ue,se){this.layerIndexes[ue]||(this.layerIndexes[ue]={});let xe=this.layerIndexes[ue][se];return xe||(xe=this.layerIndexes[ue][se]=new _,xe.scope=se),xe}getWorkerSource(ue,se,xe,Ye){if(this.workerSources[ue]||(this.workerSources[ue]={}),this.workerSources[ue][Ye]||(this.workerSources[ue][Ye]={}),this.workerSources[ue][Ye][se]||(this.workerSources[ue][Ye][se]={}),this.isSpriteLoaded[ue]||(this.isSpriteLoaded[ue]={}),!this.workerSources[ue][Ye][se][xe]){const ze={send:(st,de,ie,Oe,ut,it)=>{this.actor.send(st,de,ie,ue,ut,it)},scheduler:this.actor.scheduler};this.workerSources[ue][Ye][se][xe]=new this.workerSourceTypes[se](ze,this.getLayerIndex(ue,Ye),this.getAvailableImages(ue,Ye),this.isSpriteLoaded[ue][Ye],void 0,this.brightness)}return this.workerSources[ue][Ye][se][xe]}getDEMWorkerSource(ue,se,xe){return this.demWorkerSources[ue]||(this.demWorkerSources[ue]={}),this.demWorkerSources[ue][xe]||(this.demWorkerSources[ue][xe]={}),this.demWorkerSources[ue][xe][se]||(this.demWorkerSources[ue][xe][se]=new b),this.demWorkerSources[ue][xe][se]}enforceCacheSizeLimit(ue,se){f.q(se)}getWorkerPerformanceMetrics(ue,se,xe){xe(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new _t(self)),_t}),l(["./shared"],function(f){return f.s});var d=s;return d})})(xJ);var JAe=xJ.exports;const Id=Nw(JAe);const wJ=({setMap:n,setSelectedCity:e})=>{Id.accessToken="pk.eyJ1Ijoic3RhbnJvbnpoaW4iLCJhIjoiY2xvaGF3ZmFzMWdodDJxbjByeHMzanE2dCJ9.3uz_EG8N_d7isS1h5wV46w";const i=ne.useRef(null),a=ne.useRef(null),[s,l]=ne.useState(!1);let d=null;return ne.useEffect(()=>{a.current||!i.current||(a.current=new Id.Map({attributionControl:!1,container:i.current,style:"mapbox://styles/stanronzhin/clok1b9my006901o4gkfc25b2",center:[30,40],zoom:2,pitch:25}),a.current.on("load",()=>{a.current&&(a.current.addSource("city_points",{type:"geojson",data:"data/esg_city_points.geojson",cluster:!0,clusterMaxZoom:7,clusterRadius:20}).addSource("city_clusters",{type:"geojson",data:"data/esg_urban_clusters.geojson"}),a.current.addLayer({id:"city_point_clusters",type:"circle",source:"city_points",filter:["has","point_count"],paint:{"circle-color":["step",["get","point_count"],"#f7f7f7",100,"#f1f075",750,"#f28cb1"],"circle-radius":["step",["get","point_count"],15,100,30,750,40]}}),a.current.addLayer({id:"city_point_cluster-count",type:"symbol",source:"city_points",filter:["has","point_count"],layout:{"text-field":["get","point_count_abbreviated"],"text-font":["Suisse Intl Regular","Arial Unicode MS Bold"],"text-size":20}}),a.current.addLayer({id:"city_point_points",type:"symbol",source:"city_points",paint:{},layout:{"icon-image":["match",["get","Category"],["C1"],"esg_point_C1",["C3"],"esg_point_C3",["B2"],"esg_point_B2",["B3"],"esg_point_B3",["C2"],"esg_point_C2",["A1"],"esg_point_A1",["A2"],"esg_point_A2",["A3"],"esg_point_A3",["B1"],"esg_point_B1","esg_point_new"],"icon-size":["interpolate",["linear"],["zoom"],1,.35,2,.5,3,.6,6,.7,10,.8,22,.7]},filter:["!",["has","point_count"]]},"city_point_cluster-count"),a.current.addLayer({id:"city_point_labels",type:"symbol",source:"city_points",layout:{"text-line-height":0,"text-size":["interpolate",["linear"],["zoom"],0,12,1,15,2,20,3,25,6,30,10,35,22,25],"text-radial-offset":0,"symbol-avoid-edges":!0,"text-font":["Suisse Intl Regular","Arial Unicode MS Regular"],"text-offset":[0,-1.2],"text-anchor":"bottom","text-field":["to-string",["get","City_Name"]]},paint:{"text-color":"#ffffff"}}),a.current.addLayer({id:"city_cluster_hover",source:"city_clusters",type:"fill",paint:{"fill-color":"#ffffff","fill-opacity":["case",["boolean",["feature-state","hover"],!1],0,.07]}}),a.current.addLayer({id:"city_cluster_line",source:"city_clusters",type:"line",paint:{"line-color":"#ffffff","line-opacity":["interpolate",["linear"],["zoom"],0,0,8,0,10,1,22,1]}}),a.current.on("click","city_point_clusters",f=>{const p=a.current.queryRenderedFeatures(f.point,{layers:["city_point_clusters"]}),y=p[0].properties.cluster_id;f.features[0].properties.City_Name,a.current.getSource("city_points").getClusterExpansionZoom(y,(_,b)=>{_||a.current.easeTo({center:p[0].geometry.coordinates,zoom:b+3.2,duration:3e3})})}),a.current.on("click","city_point_labels",f=>{a.current&&a.current.flyTo({center:JSON.parse(f.features[0].properties.center),zoom:f.features[0].properties.zoom,bearing:f.features[0].properties.bearing,pitch:f.features[0].properties.pitch,essential:!0})}),a.current.on("click","city_point_points",f=>{if(!a.current)return;const p=f.features[0].properties.City_Name;e(p),a.current.flyTo({center:JSON.parse(f.features[0].properties.center),zoom:f.features[0].properties.zoom,bearing:f.features[0].properties.bearing,pitch:f.features[0].properties.pitch,essential:!0})}),a.current.on("mouseenter","city_point_labels",()=>{a.current&&(a.current.getCanvas().style.cursor="pointer")}),a.current.on("mouseenter","city_point_points",()=>{a.current&&(a.current.getCanvas().style.cursor="pointer")}),a.current.on("mouseleave","city_point_labels",()=>{a.current&&(a.current.getCanvas().style.cursor="")}),a.current.on("mouseleave","city_point_points",()=>{a.current&&(a.current.getCanvas().style.cursor="")}),a.current.on("mouseenter","city_point_clusters",()=>{a.current&&(a.current.getCanvas().style.cursor="pointer")}),a.current.on("mouseleave","city_point_clusters",()=>{a.current&&(a.current.getCanvas().style.cursor="")}),a.current.on("click","city_cluster_hover",f=>{a.current&&f.features[0].properties.City_Name}),a.current.on("mousemove","city_cluster_hover",f=>{if(f.features.length>0){if(!a.current)return;d!==null&&a.current.setFeatureState({source:"city_clusters",id:d},{hover:!1}),d=f.features[0].id,a.current.setFeatureState({source:"city_clusters",id:d},{hover:!0})}}),a.current.on("mouseleave","city_cluster_hover",()=>{if(d!==null){if(!a.current)return;a.current.setFeatureState({source:"city_clusters",id:d},{hover:!1})}d=null}))}),n(a.current))},[]),ne.useEffect(()=>{a.current&&a.current.easeTo({center:[55,25],duration:5e3,zoom:2.5,pitch:15,easing:f=>f})},[s]),U("div",{ref:i,style:{position:"absolute",top:0,left:0,width:"100%",height:"100%"}})},RL=({color:n,title:e,value:i,status:a})=>{const{classes:s}=jA();return _e("div",{className:s.statItem,children:[U("div",{className:s.statTitle,children:e}),U("div",{className:s.statValue,children:i}),U("div",{className:s.statStatus,style:{color:n,borderColor:`${n}30`},children:a})]})},Ys={VERY_LOW:"#FF3B29",LOW:"#FF632F",AVERAGE:"#FF9B3F",STRONG:"#A0DA8B",VERY_STRONG:"#35CB00"},mu=({label:n,status:e,style:i})=>{const{classes:a}=jA();return e?_e("div",{className:a.smallRowWrapper,children:[_e("div",{style:{display:"block",float:"left",height:"100%",padding:"8px 0",marginRight:"3vh",width:"14vh"},children:[" ",U("div",{className:a.statsSmallText,style:i,children:n})]}),U("div",{style:{flex:1,display:"flex",justifyContent:"flex-start"},children:U("div",{className:a.statStatus,style:{color:Ys[e.toUpperCase()],borderColor:`${Ys[e.toUpperCase()]}30`},children:e})})]}):null},bT={A1:"#35CB00",A2:"#75D652",A3:"#B7DE86",B1:"#ECE38E",B2:"#FFD748",B3:"#FFC700",C1:"#FF9B3F",C2:"#FF632F",C3:"#F74B3C"},b0=({label:n,subLabel:e,status:i,isFirst:a})=>{const{classes:s}=jA();if(!i)return null;const l=i.replace("-","").toUpperCase();return _e("div",{style:{display:"flex",flexDirection:"column",gap:"1.3vh",alignItems:a?"flex-start":"center"},children:[U("div",{className:s.statsBigText,style:{textAlign:a?"left":"center"},children:n==="Urban resilience index"?_e("div",{children:["Urban",U("br",{}),"resilience index"]}):n}),e&&U("div",{className:s.lowOpacityLabel,style:{marginTop:"-.6vh"},children:e}),U("div",{className:s.statStatusBig,style:{color:"#fff",marginTop:a?"0":"1.5vh",padding:"1vh 3vh",backgroundColor:a?bT[l]:"rgba(255, 255, 255, 0.07)"},children:i})]})},SJ=[{type:"Feature",properties:{fid:76,City_Name:"Amman",center:[35.96718879043169,32.00280698304451],zoom:10.000000000000009,bearing:101.60000000000173,pitch:49.99999999999967,vscale:.7},geometry:{type:"Point",coordinates:[35.91933631448545,31.951386464751504]}},{type:"Feature",properties:{fid:336,City_Name:"Mexico City",center:[-99.09309081576346,19.34983411479375],zoom:9.867175623863696,bearing:0,pitch:38.1352704054439,vscale:.9},geometry:{type:"Point",coordinates:[-99.1010915812256,19.457659604398632]}},{type:"Feature",properties:{fid:799,City_Name:"Bangkok",center:[100.50324135863775,13.719555607290715],zoom:9.818587811931847,bearing:0,pitch:50,vscale:1},geometry:{type:"Point",coordinates:[100.56813228239119,13.778801078899539]}},{type:"Feature",properties:{fid:892,City_Name:"Panama City",center:[-79.48226179199627,9.083198866519695],zoom:10.591526871591094,bearing:-20.799999999999727,pitch:47.51373809516402,vscale:.7},geometry:{type:"Point",coordinates:[-79.49751526014956,9.013829150641525]}},{type:"Feature",properties:{fid:1165,City_Name:"Colombo",center:[80.07050699310525,6.823336439561302],zoom:9.81,bearing:-20.000000000000114,pitch:62,vscale:.9},geometry:{type:"Point",coordinates:[79.9583239444924,6.932357722680249]}},{type:"Feature",properties:{fid:2311,City_Name:"Jakarta",center:[106.82667518481037,-6.350464399947057],zoom:9.099467639422393,bearing:-153.5999999999998,pitch:46.99999999999997,vscale:1},geometry:{type:"Point",coordinates:[106.81547517179841,-6.172653326038387]}},{type:"Feature",properties:{fid:2873,City_Name:"Cape Town",center:[18.579160832283065,-33.973034474213975],zoom:10.174985293257919,bearing:0,pitch:39.98000000000012,vscale:.8},geometry:{type:"Point",coordinates:[18.600086702400798,-33.98288982976307]}},{type:"Feature",properties:{fid:10,City_Name:"Valparaiso",center:[-71.48427166516629,-33.02603685224794],zoom:10.663321631643026,bearing:167.86383725437076,pitch:41.000000000000135,vscale:1.5,Category:"C1"},geometry:{type:"Point",coordinates:[-71.62739583920451,-33.0425755449797]}},{type:"Feature",properties:{fid:11,City_Name:"Natal",center:[-35.25026461835907,-5.795680924221671],zoom:11.194733819711187,bearing:-151.19999999999965,pitch:43.980000000000125,vscale:.7,Category:"B2"},geometry:{type:"Point",coordinates:[-35.21222333226075,-5.814877064286144]}},{type:"Feature",properties:{fid:12,City_Name:"Dar es Salaam",center:[39.179162094870094,-6.884904593781215],zoom:9.51190944357489,bearing:0,pitch:52,vscale:.6,Category:"C2"},geometry:{type:"Point",coordinates:[39.21870804117781,-6.825200004764525]}},{type:"Feature",properties:{fid:13,City_Name:"Brazzaville",center:[15.286496264601823,-4.2411132990048515],zoom:11.378416402173768,bearing:-76.7999999999999,pitch:47.499999999999844,vscale:.15,Category:"C1"},geometry:{type:"Point",coordinates:[15.268282806301356,-4.253046135825453]}},{type:"Feature",properties:{fid:14,City_Name:"Dubai",center:[55.33641246251963,25.078748811928463],zoom:9.591526871591089,bearing:0,pitch:56.98,vscale:1,Category:"A2"},geometry:{type:"Point",coordinates:[55.23468568314278,25.177065811310452]}},{type:"Feature",properties:{fid:15,City_Name:"Expo City Dubai",center:[55.33641246251963,25.078748811928463],zoom:9.591526871591089,bearing:0,pitch:56.98,vscale:1,Category:"A3"},geometry:{type:"Point",coordinates:[55.15094645583921,24.96152906476464]}},{type:"Feature",properties:{fid:16,City_Name:"Almaty",center:[76.88647818381759,43.256008733418724],zoom:10.249467639422363,bearing:0,pitch:44.97999999999996,vscale:1.5,Category:"B1"},geometry:{type:"Point",coordinates:[76.8984883098032,43.26555910249282]}},{type:"Feature",properties:{fid:17,City_Name:"Adoni",center:[77.2747162313259,15.633478866808957],zoom:11.643190533205994,bearing:0,pitch:44.94535508727158,vscale:.35,Category:"C2"},geometry:{type:"Point",coordinates:[77.27318970081716,15.62514604003816]}}],tO=({selectedCityName:n,isMobile:e})=>{Id.accessToken="pk.eyJ1Ijoic3RhbnJvbnpoaW4iLCJhIjoiY2xvaGF3ZmFzMWdodDJxbjByeHMzanE2dCJ9.3uz_EG8N_d7isS1h5wV46w";const i=ne.useRef(null),a=ne.useRef(null);return ne.useEffect(()=>{var l;if(a.current||!i.current)return;const s=(l=SJ.find(d=>d.properties.City_Name===n))==null?void 0:l.properties;a.current=new Id.Map({attributionControl:!1,container:i.current,style:"mapbox://styles/stanronzhin/clpdlsmlk00bt01p9e53lgin4",center:s==null?void 0:s.center,zoom:e?(s==null?void 0:s.zoom)-1.8:s==null?void 0:s.zoom,bearing:s==null?void 0:s.bearing,pitch:s==null?void 0:s.pitch}),a.current.on("load",()=>{if(!a.current)return;a.current.resize();let d,f,p=!1;function y(_){d===void 0&&(d=_);const b=_-d;if(f!==_){const S=Math.min((s==null?void 0:s.vscale)/2500*b,s==null?void 0:s.vscale);a.current.setPaintProperty("bars-14-cities-shp-8gys15","fill-extrusion-vertical-scale",S),S===1&&(p=!0)}b<2500&&(f=_,p||requestAnimationFrame(y))}y(0)})},[]),U("div",{ref:i,style:{pointerEvents:"none",position:e?"relative":"absolute",top:e?"0":"20vh",right:"0",width:e?"100%":"60%",height:e?"40vh":"80vh"}})},Gs={Adoni:"Adoni_IEC_A&S_Report.pdf",Almaty:"Almaty_IEC_A&S_Report.pdf",Brazzaville:"Brazzaville_IEC_A&S_Report.pdf",DarEsSalaam:"Dar es Salaam_IEC_A&S_Report.pdf",DubaiExpo:"Dubai_Expo_IEC_A&S_Report.pdf",Dubai:"Dubai_IEC_A&S_Report.pdf",Natal:"Natal_IEC_A&S_Report.pdf",Valparaiso:"Valparaiso_IEC_A&S_Report.pdf"},w_=[{City:"Dubai",Country:"UAE","Text description":"Largest city of the UAE, one of the main global cities",Population:"4 865 222","Population description":"large","Population density":40.6,"Population density description":"medium","Population city proper":"3 549 900","Population density city proper":22.049068322981366,Climate:"28C, 14 kph, 68 mm ","Climate description":"Arid, desert, hot","Urban Resilience Index":"A-3",Environmental:"Strong",Social:"Strong",Governmental:"Strong","Current state":"Very strong","Ability & Willingness":"Average","Basic needs Scope":"A-2","Natural Risk Exposure":"Strong","Transport Resilience Index":"Strong","Urban Sentiment Index":"Average","Poverty headcount ratio at national poverty lines":.053,"Poverty headcount ratio at national poverty lines description":"strong","Mean salary":"7 854","Mean salary description":"very strong","Literacy rate among population":.97,"Literacy rate among population description":"very strong","Air pollution":"Low","Water pollution":"Strong","Land use and waste":"Very strong","Natural disaster hazards":"Very strong","Water availability":"Strong","Food availability":"Very strong","Energy availability":"Strong",Health:"Strong",Education:"Very strong",Wealth:"Very strong",Safety:"Very strong",Livability:"Very strong",Transport:"Very strong",Inclusion:"Low",Accountability:"Very strong","City budget":"Strong",SME:"Strong","Public services":"Very strong","Sustainability commitment":"Very strong",Satisfaction:"Average",Efficiency:"Strong",Accessibility:"Strong",Safety_1:"Very strong",Affordability:"Low","Environmental impact":"Very low",tr_graph:{Satisfaction:3,Efficiency:4,Accessibility:4,Safety:5,Affordability:2,"Environmental impact":1},images:["/assets/Dubai/1.jpg","/assets/Dubai/2.jpg","/assets/Dubai/3.jpg","/assets/Dubai/4.jpg","/assets/Dubai/5.jpg"],pdfName:Gs.Dubai},{City:"Expo City Dubai",Country:"UAE","Text description":"New city of innovation and advanced technologies",Population:"2 275","Population description":"small","Population density":8.8,"Population density description":"small","Population city proper":"2 275","Population density city proper":8.8,Climate:"28C, 14 kph, 68 mm ","Climate description":"Arid, desert, hot","Urban Resilience Index":"A-2",Environmental:"Strong",Social:"Strong",Governmental:"Strong","Current state":"Very strong","Ability & Willingness":"Average","Basic needs Scope":"A-2","Natural Risk Exposure":"Strong","Transport Resilience Index":"Very strong","Urban Sentiment Index":"Strong","Poverty headcount ratio at national poverty lines":0,"Poverty headcount ratio at national poverty lines description":"very strong","Mean salary":"7 854","Mean salary description":"very strong","Literacy rate among population":.97,"Literacy rate among population description":"very strong","Air pollution":"Low","Water pollution":"Strong","Land use and waste":"Strong","Natural disaster hazards":"Very strong","Water availability":"Strong","Food availability":"Very strong","Energy availability":"Strong",Health:"Strong",Education:"Very strong",Wealth:"Very strong",Safety:"Very strong",Livability:"Very strong",Transport:"Very strong",Inclusion:"Low",Accountability:"Very strong","City budget":"Strong",SME:"Strong","Public services":"Very strong","Sustainability commitment":"Very strong",Satisfaction:"Very strong",Efficiency:"Very strong",Accessibility:"Strong",Safety_1:"Very strong",Affordability:"Low","Environmental impact":"Very low",tr_graph:{Satisfaction:5,Efficiency:5,Accessibility:4,Safety:5,Affordability:2,"Environmental impact":1},images:["/assets/Expo/1.jpg","/assets/Expo/2.jpg","/assets/Expo/3.jpg","/assets/Expo/4.jpg","/assets/Expo/5.jpg"],pdfName:Gs.DubaiExpo},{City:"Valparaiso",Country:"Chile","Text description":"Second largest city of the country, the major Chile's port",Population:"965 937","Population description":"large","Population density":41.7,"Population density description":"medium","Population city proper":"252 888","Population density city proper":52.739937434827944,Climate:"14C, 16 kph, 345 mm ","Climate description":"Temperate, dry and warm summer","Urban Resilience Index":"C-1",Environmental:"Low",Social:"Low",Governmental:"Low","Current state":"Very low","Ability & Willingness":"Average","Basic needs Scope":"B-2","Natural Risk Exposure":"Average","Transport Resilience Index":"Strong","Urban Sentiment Index":"Very strong","Poverty headcount ratio at national poverty lines":.21,"Poverty headcount ratio at national poverty lines description":"low","Mean salary":"11 082","Mean salary description":"very strong","Literacy rate among population":.992,"Literacy rate among population description":"very strong","Air pollution":"Low","Water pollution":"Strong","Land use and waste":"Average","Natural disaster hazards":"Very strong","Water availability":"Average","Food availability":"Strong","Energy availability":"Very strong",Health:"Average",Education:"Average",Wealth:"Average",Safety:"Low",Livability:"Low",Transport:"Low",Inclusion:"Strong",Accountability:"Very low","City budget":"Average",SME:"Very low","Public services":"Very strong","Sustainability commitment":"Very strong",Satisfaction:"Strong",Efficiency:"Low",Accessibility:"Average",Safety_1:"Strong",Affordability:"Average","Environmental impact":"Low",tr_graph:{Satisfaction:4,Efficiency:2,Accessibility:3,Safety:4,Affordability:3,"Environmental impact":2},images:["/assets/Valparaiso/1.jpg","/assets/Valparaiso/2.jpg","/assets/Valparaiso/3.jpg","/assets/Valparaiso/4.jpg","/assets/Valparaiso/5.jpg"],pdfName:Gs.Valparaiso},{City:"Dar es Salaam",Country:"Tanzania","Text description":"Largest city of the country, one of the Africa's main centres",Population:"9 314 731","Population description":"very large","Population density":71.9,"Population density description":"large","Population city proper":"5 383 728","Population density city proper":163.14327272727272,Climate:"27C, 17 kph, 1 114 mm ","Climate description":"Tropical, dry winter","Urban Resilience Index":"C-2",Environmental:"Low",Social:"Low",Governmental:"Low","Current state":"Very low","Ability & Willingness":"Very low","Basic needs Scope":"C-1","Natural Risk Exposure":"Average","Transport Resilience Index":"Very low","Urban Sentiment Index":"Low","Poverty headcount ratio at national poverty lines":.333,"Poverty headcount ratio at national poverty lines description":"very low","Mean salary":199,"Mean salary description":"very low","Literacy rate among population":.867,"Literacy rate among population description":"strong","Air pollution":"Average","Water pollution":"Very low","Land use and waste":"Low","Natural disaster hazards":"Strong","Water availability":"Low","Food availability":"Strong","Energy availability":"Average",Health:"Low",Education:"Low",Wealth:"Low",Safety:"Low",Livability:"Low",Transport:"Low",Inclusion:"Strong",Accountability:"Average","City budget":"Average",SME:"Low","Public services":"Average","Sustainability commitment":"Average",Satisfaction:"Average",Efficiency:"Average",Accessibility:"Low",Safety_1:"Very low",Affordability:"Strong","Environmental impact":"Very strong",tr_graph:{Satisfaction:3,Efficiency:3,Accessibility:2,Safety:1,Affordability:4,"Environmental impact":5},images:["/assets/DarEsSalaam/1.jpg","/assets/DarEsSalaam/2.jpg","/assets/DarEsSalaam/3.jpg","/assets/DarEsSalaam/4.jpg","/assets/DarEsSalaam/5.jpg"],pdfName:Gs.DarEsSalaam},{City:"Adoni",Country:"India","Text description":"A historical city and an agricultural centre in Andhra Pradesh",Population:"232 552","Population description":"medium","Population density":64.4,"Population density description":"large","Population city proper":"184 625","Population density city proper":93.71827411167513,Climate:"27C, 17 kph, 691 mm ","Climate description":"Temperate, desert, hot summer","Urban Resilience Index":"C-2",Environmental:"Low",Social:"Very low",Governmental:"Low","Current state":"Very low","Ability & Willingness":"Very low","Basic needs Scope":"B-3","Natural Risk Exposure":"Average","Transport Resilience Index":"Strong","Urban Sentiment Index":"Very low","Poverty headcount ratio at national poverty lines":.273,"Poverty headcount ratio at national poverty lines description":"low","Mean salary":"2 769","Mean salary description":"average","Literacy rate among population":.774,"Literacy rate among population description":"average","Air pollution":"Average","Water pollution":"Low","Land use and waste":"Strong","Natural disaster hazards":"Strong","Water availability":"Strong","Food availability":"Average","Energy availability":"Strong",Health:"Low",Education:"Low",Wealth:"Low",Safety:"Very low",Livability:"Low",Transport:"Low",Inclusion:"Strong",Accountability:"Very low","City budget":"Strong",SME:"Low","Public services":"Very strong","Sustainability commitment":"Very strong",Satisfaction:"Low",Efficiency:"Strong",Accessibility:"Average",Safety_1:"Strong",Affordability:"Average","Environmental impact":"Strong",tr_graph:{Satisfaction:2,Efficiency:4,Accessibility:3,Safety:4,Affordability:3,"Environmental impact":4},images:["/assets/Adoni/1.jpg","/assets/Adoni/2.jpeg","/assets/Adoni/3.jpeg","/assets/Adoni/4.jpg","/assets/Adoni/5.jpeg","/assets/Adoni/6.png"],pdfName:Gs.Adoni},{City:"Natal",Country:"Brazil","Text description":"Regional centre of the Rio Grande do Norte",Population:"1 318 291","Population description":"large","Population density":53,"Population density description":"large","Population city proper":"896 710","Population density city proper":52.74764705882353,Climate:"26C, 23 kph, 1 225 mm ","Climate description":"Tropical, dry summer","Urban Resilience Index":"B-2",Environmental:"Average",Social:"Average",Governmental:"Average","Current state":"Average","Ability & Willingness":"Average","Basic needs Scope":"B-2","Natural Risk Exposure":"Low","Transport Resilience Index":"Strong","Urban Sentiment Index":"Strong","Poverty headcount ratio at national poverty lines":.15,"Poverty headcount ratio at national poverty lines description":"average","Mean salary":"1 794","Mean salary description":"average","Literacy rate among population":.993,"Literacy rate among population description":"very strong","Air pollution":"Strong","Water pollution":"Average","Land use and waste":"Very strong","Natural disaster hazards":"Strong","Water availability":"Average","Food availability":"Average","Energy availability":"Average",Health:"Average",Education:"Average",Wealth:"Average",Safety:"Very low",Livability:"Average",Transport:"Average",Inclusion:"Average",Accountability:"Very low","City budget":"Strong",SME:"Low","Public services":"Average","Sustainability commitment":"Average",Satisfaction:"Strong",Efficiency:"Low",Accessibility:"Average",Safety_1:"Low",Affordability:"Strong","Environmental impact":"Very strong",tr_graph:{Satisfaction:4,Efficiency:2,Accessibility:3,Safety:2,Affordability:4,"Environmental impact":5},images:["/assets/Natal/1.png","/assets/Natal/2.png","/assets/Natal/3.jpeg","/assets/Natal/4.jpeg"],pdfName:Gs.Natal},{City:"Brazzaville",Country:"Congo","Text description":"Capital and largest city of the Republic of the Congo",Population:"3 186 838","Population description":"large","Population density":374,"Population density description":"very large","Population city proper":"1 932 610","Population density city proper":193.261,Climate:"25C, 8 kph, 1 095 mm ","Climate description":"Tropical, dry winter","Urban Resilience Index":"C-1",Environmental:"Average",Social:"Very low",Governmental:"Average","Current state":"Average","Ability & Willingness":"Very low","Basic needs Scope":"B-3","Natural Risk Exposure":"Strong","Transport Resilience Index":"Low","Urban Sentiment Index":"Very strong","Poverty headcount ratio at national poverty lines":.193,"Poverty headcount ratio at national poverty lines description":"low","Mean salary":"1 282","Mean salary description":"average","Literacy rate among population":.818,"Literacy rate among population description":"average","Air pollution":"Strong","Water pollution":"Very low","Land use and waste":"Average","Natural disaster hazards":"Strong","Water availability":"Strong","Food availability":"Low","Energy availability":"Average",Health:"Very low",Education:"Average",Wealth:"Low",Safety:"Very low",Livability:"Average",Transport:"Average",Inclusion:"Very low",Accountability:"Very low","City budget":"Very low",SME:"Very low","Public services":"Average","Sustainability commitment":"Average",Satisfaction:"Strong",Efficiency:"Very low",Accessibility:"Low",Safety_1:"Average",Affordability:"Strong","Environmental impact":"Strong",tr_graph:{Satisfaction:4,Efficiency:1,Accessibility:2,Safety:3,Affordability:4,"Environmental impact":4},images:["/assets/Brazzaville/1.jpeg","/assets/Brazzaville/2.jpg","/assets/Brazzaville/3.jpeg","/assets/Brazzaville/4.jpeg"],pdfName:Gs.Brazzaville},{City:"Almaty",Country:"Kazakhstan","Text description":"Largest city in the country",Population:"2 539 108","Population description":"large","Population density":37.7,"Population density description":"medium","Population city proper":"2 211 198","Population density city proper":32.35110460863204,Climate:"7C, 10 kph, 891 mm ","Climate description":"Continental, humid, warm summer","Urban Resilience Index":"B-1",Environmental:"Average",Social:"Strong",Governmental:"Average","Current state":"Average","Ability & Willingness":"Average","Basic needs Scope":"A-3","Natural Risk Exposure":"Strong","Transport Resilience Index":"Strong","Urban Sentiment Index":"Low","Poverty headcount ratio at national poverty lines":.187,"Poverty headcount ratio at national poverty lines description":"average","Mean salary":"2 901","Mean salary description":"average","Literacy rate among population":.999,"Literacy rate among population description":"very strong","Air pollution":"Strong","Water pollution":"Average","Land use and waste":"Very strong","Natural disaster hazards":"Very strong","Water availability":"Very strong","Food availability":"Strong","Energy availability":"Strong",Health:"Very strong",Education:"Strong",Wealth:"Strong",Safety:"Strong",Livability:"Strong",Transport:"Strong",Inclusion:"Low",Accountability:"Average","City budget":"Strong",SME:"Strong","Public services":"Very strong","Sustainability commitment":"Very strong",Satisfaction:"Very low",Efficiency:"Low",Accessibility:"Average",Safety_1:"Strong",Affordability:"Low","Environmental impact":"Strong",tr_graph:{Satisfaction:1,Efficiency:2,Accessibility:3,Safety:4,Affordability:2,"Environmental impact":4},images:["/assets/Almaty/1.jpg","/assets/Almaty/2.jpg","/assets/Almaty/3.jpg","/assets/Almaty/4.jpg"],pdfName:Gs.Almaty},{City:"Cape Town",Country:"South Africa","Text description":"Second largest city of the country, the regional centre of the Western Cape",Population:"4 293 836","Population description":"large","Population density":67.7,"Population density description":"large","Population city proper":"4 005 016","Population density city proper":16.38043353783231,Climate:"16C, 20 kph, 621 mm ","Climate description":"Temperate, dry and warm summer","Urban Resilience Index":"B-2",Environmental:"Average",Social:"Average",Governmental:"Strong","Current state":"Strong","Ability & Willingness":"Average","Basic needs Scope":"B-1","Natural Risk Exposure":"Strong","Transport Resilience Index":"Low","Urban Sentiment Index":"Strong","Poverty headcount ratio at national poverty lines":.555,"Poverty headcount ratio at national poverty lines description":"very low","Mean salary":"1 686","Mean salary description":"average","Literacy rate among population":.971,"Literacy rate among population description":"very strong","Air pollution":"Strong","Water pollution":"Low","Land use and waste":"Low","Natural disaster hazards":"Strong","Water availability":"Low","Food availability":"Low","Energy availability":"Low",Health:"Very low",Education:"Average",Wealth:"Average",Safety:"Low",Livability:"Average",Transport:"Strong",Inclusion:"Strong",Accountability:"Strong","City budget":"Low",SME:"Average","Public services":"Strong","Sustainability commitment":"Very strong",Satisfaction:"Average",Efficiency:"Average",Accessibility:"Average",Safety_1:"Average",Affordability:"Average","Environmental impact":"Average",tr_graph:{Satisfaction:3,Efficiency:3,Accessibility:3,Safety:3,Affordability:3,"Environmental impact":3},images:["/assets/CapeTown/1.jpg","/assets/CapeTown/2.jpg","/assets/CapeTown/3.jpg","/assets/CapeTown/4.jpg"],pdfName:Gs.Dubai},{City:"Mexico City",Country:"Mexico","Text description":"Capital and the largest city of Mexico, one of the largest urban areas in the World",Population:"17 317 588","Population description":"very large","Population density":88.5,"Population density description":"large","Population city proper":"8 843 706","Population density city proper":120.3225306122449,Climate:"16C, 8 kph, 1 058 mm ","Climate description":"Temperate, dry winter, hot summmer","Urban Resilience Index":"C-2",Environmental:"Low",Social:"Low",Governmental:"Low","Current state":"Low","Ability & Willingness":"Low","Basic needs Scope":"C-2","Natural Risk Exposure":"Average","Transport Resilience Index":"Strong","Urban Sentiment Index":"Low","Poverty headcount ratio at national poverty lines":.363,"Poverty headcount ratio at national poverty lines description":"very low","Mean salary":891,"Mean salary description":"low","Literacy rate among population":.991,"Literacy rate among population description":"very strong","Air pollution":"Very low","Water pollution":"Very low","Land use and waste":"Average","Natural disaster hazards":"Low","Water availability":"Average","Food availability":"Very low","Energy availability":"Average",Health:"Average",Education:"Average",Wealth:"Average",Safety:"Very low",Livability:"Low",Transport:"Low",Inclusion:"Very low",Accountability:"Low","City budget":"Low",SME:"Low","Public services":"Average","Sustainability commitment":"Low",Satisfaction:"Low",Efficiency:"Very low",Accessibility:"Average",Safety_1:"Strong",Affordability:"Strong","Environmental impact":"Low",tr_graph:{Satisfaction:2,Efficiency:1,Accessibility:3,Safety:4,Affordability:4,"Environmental impact":2},images:["/assets/Mexico/1.jpg","/assets/Mexico/2.png","/assets/Mexico/3.jpeg","/assets/Mexico/4.jpg","/assets/Mexico/5.jpeg","/assets/Mexico/6.jpeg"],pdfName:Gs.Dubai},{City:"Jakarta",Country:"Indonesia","Text description":"Capital and the largest city of Indonesia, one of the largest urban areas in the World",Population:"38 758 456","Population description":"very large","Population density":91.8,"Population density description":"very large","Population city proper":"10 679 951","Population density city proper":161.51643149887332,Climate:"26C, 10 kph, 2 097 mm ","Climate description":"Tropical, humid","Urban Resilience Index":"B-3",Environmental:"Low",Social:"Average",Governmental:"Average","Current state":"Average","Ability & Willingness":"Average","Basic needs Scope":"B-2","Natural Risk Exposure":"Low","Transport Resilience Index":"Low","Urban Sentiment Index":"Average","Poverty headcount ratio at national poverty lines":.047,"Poverty headcount ratio at national poverty lines description":"strong","Mean salary":554,"Mean salary description":"low","Literacy rate among population":.999,"Literacy rate among population description":"very strong","Air pollution":"Very low","Water pollution":"Average","Land use and waste":"Average","Natural disaster hazards":"Low","Water availability":"Average","Food availability":"Low","Energy availability":"Average",Health:"Low",Education:"Low",Wealth:"Low",Safety:"Strong",Livability:"Average",Transport:"Average",Inclusion:"Low",Accountability:"Very strong","City budget":"Low",SME:"Strong","Public services":"Average","Sustainability commitment":"Average",Satisfaction:"Average",Efficiency:"Low",Accessibility:"Average",Safety_1:"Strong",Affordability:"Strong","Environmental impact":"Low",tr_graph:{Satisfaction:3,Efficiency:2,Accessibility:3,Safety:4,Affordability:4,"Environmental impact":2},images:["/assets/Jakarta/1.jpg","/assets/Jakarta/2.jpg","/assets/Jakarta/3.jpg","/assets/Jakarta/4.jpeg","/assets/Jakarta/5.jpeg","/assets/Jakarta/6.jpeg"],pdfName:Gs.Dubai},{City:"Panama City",Country:"Panama","Text description":"Capital and the largest city of Panama",Population:"1 584 643","Population description":"large","Population density":66.6,"Population density description":"large","Population city proper":"1 367 767","Population density city proper":47.40302904276703,Climate:"26C, 17 kph, 2 088 mm ","Climate description":"Tropical, monsoonal","Urban Resilience Index":"B-1",Environmental:"Average",Social:"Strong",Governmental:"Average","Current state":"Average","Ability & Willingness":"Average","Basic needs Scope":"B-1","Natural Risk Exposure":"Average","Transport Resilience Index":"Strong","Urban Sentiment Index":"Average","Poverty headcount ratio at national poverty lines":.046,"Poverty headcount ratio at national poverty lines description":"strong","Mean salary":"1 279","Mean salary description":"average","Literacy rate among population":.988,"Literacy rate among population description":"very strong","Air pollution":"Average","Water pollution":"Strong","Land use and waste":"Strong","Natural disaster hazards":"Average","Water availability":"Strong","Food availability":"Strong","Energy availability":"Very strong",Health:"Strong",Education:"Very low",Wealth:"Low",Safety:"Strong",Livability:"Low",Transport:"Average",Inclusion:"Average",Accountability:"Average","City budget":"Average",SME:"Low","Public services":"Strong","Sustainability commitment":"Strong",Satisfaction:"Low",Efficiency:"Low",Accessibility:"Average",Safety_1:"Strong",Affordability:"Strong","Environmental impact":"Strong",tr_graph:{Satisfaction:2,Efficiency:2,Accessibility:3,Safety:4,Affordability:4,"Environmental impact":4},images:["/assets/Panama/1.jpg","/assets/Panama/2.jpeg","/assets/Panama/3.jpeg","/assets/Panama/4.jpg","/assets/Panama/5.jpeg","/assets/Panama/6.jpeg","/assets/Panama/7.jpg"],pdfName:Gs.Dubai},{City:"Amman",Country:"Jordan","Text description":"Capital and the largest city of Jordan",Population:"6 366 731","Population description":"very large","Population density":137.1,"Population density description":"very large","Population city proper":"1 812 059","Population density city proper":119.68685601056804,Climate:"17C, 13 kph, 187 mm ","Climate description":"Arid, dry summer, cold","Urban Resilience Index":"B-1",Environmental:"Low",Social:"Strong",Governmental:"Strong","Current state":"Average","Ability & Willingness":"Average","Basic needs Scope":"B-1","Natural Risk Exposure":"Average","Transport Resilience Index":"Low","Urban Sentiment Index":"Low","Poverty headcount ratio at national poverty lines":.157,"Poverty headcount ratio at national poverty lines description":"average","Mean salary":"2 284","Mean salary description":"average","Literacy rate among population":.994,"Literacy rate among population description":"very strong","Air pollution":"Low","Water pollution":"Low","Land use and waste":"Average","Natural disaster hazards":"Average","Water availability":"Strong","Food availability":"Strong","Energy availability":"Average",Health:"Average",Education:"Average",Wealth:"Strong",Safety:"Strong",Livability:"Strong",Transport:"Average",Inclusion:"Low",Accountability:"Very strong","City budget":"Average",SME:"Average","Public services":"Average","Sustainability commitment":"Average",Satisfaction:"Strong",Efficiency:"Low",Accessibility:"Average",Safety_1:"Low",Affordability:"Average","Environmental impact":"Low",tr_graph:{Satisfaction:4,Efficiency:2,Accessibility:3,Safety:2,Affordability:3,"Environmental impact":2},images:["/assets/Amman/1.jpg","/assets/Amman/2.jpeg","/assets/Amman/3.jpeg","/assets/Amman/4.jpeg","/assets/Amman/5.jpeg"],pdfName:Gs.Dubai},{City:"Bangkok",Country:"Thailand","Text description":"Capital and the largest city of Thailand",Population:"19 005 476","Population description":"very large","Population density":70.8,"Population density description":"large","Population city proper":"5 666 264","Population density city proper":36.11385595920969,Climate:"28C, 10 kph, 1 207 mm ","Climate description":"Tropical, dry winter","Urban Resilience Index":"B-3",Environmental:"Low",Social:"Average",Governmental:"Low","Current state":"Low","Ability & Willingness":"Average","Basic needs Scope":"B-3","Natural Risk Exposure":"Average","Transport Resilience Index":"Low","Urban Sentiment Index":"Strong","Poverty headcount ratio at national poverty lines":.063,"Poverty headcount ratio at national poverty lines description":"strong","Mean salary":421,"Mean salary description":"low","Literacy rate among population":.988,"Literacy rate among population description":"very strong","Air pollution":"Low","Water pollution":"Low","Land use and waste":"Low","Natural disaster hazards":"Low","Water availability":"Strong","Food availability":"Low","Energy availability":"Strong",Health:"Strong",Education:"Low",Wealth:"Average",Safety:"Very strong",Livability:"Average",Transport:"Low",Inclusion:"Strong",Accountability:"Low","City budget":"Very low",SME:"Very strong","Public services":"Low","Sustainability commitment":"Strong",Satisfaction:"Average",Efficiency:"Very low",Accessibility:"Average",Safety_1:"Low",Affordability:"Average","Environmental impact":"Average",tr_graph:{Satisfaction:3,Efficiency:1,Accessibility:3,Safety:2,Affordability:3,"Environmental impact":3},images:["/assets/Bangkok/1.jpg","/assets/Bangkok/2.jpg","/assets/Bangkok/3.jpg","/assets/Bangkok/4.jpg","/assets/Bangkok/5.jpg"],pdfName:Gs.Dubai},{City:"Colombo",Country:"Sri Lanka","Text description":"Largest city and commercial capital of Sri Lanka",Population:"4 938 510","Population description":"large","Population density":38,"Population density description":"medium","Population city proper":"2 324 349","Population density city proper":33.25248927038626,Climate:"26C, 16 kph, 2 387 mm ","Climate description":"Tropical, humid","Urban Resilience Index":"B-2",Environmental:"Average",Social:"Average",Governmental:"Average","Current state":"Average","Ability & Willingness":"Low","Basic needs Scope":"B-2","Natural Risk Exposure":"Average","Transport Resilience Index":"Average","Urban Sentiment Index":"Average","Poverty headcount ratio at national poverty lines":.143,"Poverty headcount ratio at national poverty lines description":"average","Mean salary":183,"Mean salary description":"very low","Literacy rate among population":.99,"Literacy rate among population description":"very strong","Air pollution":"Average","Water pollution":"Strong","Land use and waste":"Low","Natural disaster hazards":"Strong","Water availability":"Average","Food availability":"Low","Energy availability":"Very strong",Health:"Strong",Education:"Very low",Wealth:"Low",Safety:"Strong",Livability:"Low",Transport:"Strong",Inclusion:"Average",Accountability:"Very low","City budget":"Low",SME:"Average","Public services":"Average","Sustainability commitment":"Low",Satisfaction:"Low",Efficiency:"Low",Accessibility:"Average",Safety_1:"Average",Affordability:"Average","Environmental impact":"Average",tr_graph:{Satisfaction:2,Efficiency:2,Accessibility:3,Safety:3,Affordability:3,"Environmental impact":3},images:["/assets/Colombo/1.jpg","/assets/Colombo/2.jpg","/assets/Colombo/3.jpg","/assets/Colombo/4.jpg"],pdfName:Gs.Dubai}],QAe=[{city:"Dubai",E:`Mitigate effects of air pollution, especially SO2, NO2:\r
- promoting electric vehicles,\r
- implementation of urban planning policies aimed at reducing long-distance travel within the city, providing new communities with the leisure, and social infrastructure.\r
\r
Introduction of modern technologies for construction waste.`,S:"Strengthen social policy eradicating poverty and ensuring equality in a city (poverty headcount ratio at national poverty lines is still around 5%).",G:`Gender-balancing of bureaucratic procedures.\r
\r
Strengthening labor conditions regulation, primarily for low-skilled personnel (relatively high slavery index  40% vulnerability to modern slavery).`},{city:"Expo City Dubai",E:`Mitigate the effects of pollution, especially particulate matter.\r
- For instance, expand the deployment of regenerative-air vacuum sweepers for both streets and sidewalks. Introduce technologies for indoor air purification in buildings.\r
- Continue planting trees.`,S:"Develop healthcare policies aimed to expand hospital capacity and training of doctors.",G:`Streamline SME access to become ECD residents by minimizing obstacles to renting and launching an entrepreneurship support program.\r
\r
Establish one-stop shop platform for all municipal and state services, creating a one-stop-shop approach.`},{city:"Valparaiso",E:"Strengthening control over SO2 emissions, increasing environmental requirements for ships entering the port.",S:"A programme for the development of public spaces in the city, involving the creation of leisure facilities.",G:"Creation of an ecosystem for start-ups and entrepreneurship (low level of officially registered small businesses per 1 inhabitant  383,7)."},{city:"Dar es Salaam",E:"Policy on treatment of drinking water sources (high average of pH concentration in water (8,5) and high toxins metrics), including modernisation of sewerage and construction of treatment plants, improvement of financial management. Attracting investments of development institutions in water supply and sewage systems.",S:`Community Literacy Programme (literacy rate  76,8%). Development of teacher training system, development of online education with the involvement of teachers from swahili and english speaking countries.\r
\r
 Remote employment promotion.`,G:"Statistics and accounting quality improvement."},{city:"Adoni",E:"Policy on reclamation of landfills and degraded lands. Construction of waste incineration plants, which will also improve energy supply to certain areas.",S:"A programme to improve road safety (+20,8% road fatalities in 2019-2022). Attracting investment to improve the quality of roads. ",G:"Development of mobile communication infrastructure."},{city:"Natal",E:"Natural disasters mitigation policy (increasing frequency of hurricanes and the rise on the sea level).",S:`Social inclusion policy as a response for high number of violence crimes (violent crime rate  31,9 per 1,000 population), including those aimed at the integration of residents of favelas into the labour market, entrepreneurship and social support.\r
\r
Development of social and communal infrastructure outside the administrative boundaries of the city in areas of active housing construction.\r
\r
Organisation of volunteer programmes (the lowest volunteerism rate among the cities  less than 0,1 volunteer per capita).`,G:"Increasing transparency of city finances and reporting."},{city:"Brazzaville",E:`Strengthen waste management strategy due to relatively low levels of waste recycling.\r
\r
Extensive urban sprawl requires urgent measures to preserve green areas.`,S:`Expansion of hospital capacity and training of doctors. \r
\r
Providing slums with basic infrastructure (energy, clean water, waste collection).\r
\r
Establishment of a programme to support micro-enterprises and trade infrastructure development projects.`,G:"Mandatory publication of the city budget and its discussion with stakeholders."},{city:"Almaty",E:"Replacing coal with gas as the main source of energy.",S:"Transport policy aimed at making public transport more attractive, implementation of LRT and BRT projects; polycentric urban development.",G:"Strengthening controls over financial flows and anti-corruption policies (high number of news on bribery scandals)."},{city:"Cape Town",E:"Strengthen waste management strategy due to relatively low levels of waste recycling.",S:`Develop complex programs to decrease child mortality rate (womens healthcare programs, trainings of doctors, hospital equipment).\r
\r
Country-level system to increase literacy rate. Training programs for teachers which will also allow to decrease average number of pupils in the class.\r
\r
Social inclusion policy as a response to high violent crime rates.`,G:"Develop city policies to increase small and medium enterprises activity."},{city:"Mexico City",E:"Mitigate effects of air pollution. Especially SO2, NO2.",S:"Reform healthcare system paying special attention to implementation of effective city ambulance system. Develop plan aimed at increasing life expectancy at birth. ",G:`Pay attention to ESG planning and reporting as currently no policies are implemented.\r
\r
Increase transparency of city finance and reporting.`},{city:"Jakarta",E:`Mitigate effects of high CO2 emissions and concentrations.\r
\r
Increase parks and green zones ares.`,S:`Develop programs aimed at transport system transformation (decrease of heavy traffic).\r
\r
Diversify importers of cereal and food to decrease risks implemented by high level of dependency on imports.`,G:"Increase transparency of city finance and reporting."},{city:"Panama City",E:"Improve policy on reclamation of landfills and degraded lands.",S:`Develop special programs aimed at increase in school attendance. Develop trainings of teachers.\r
\r
Strengthen inclusion policies, especially  for women and refugees.`,G:`Increase financial transparency of city government companies.\r
\r
Build up government system to intensify e-gov services provision.`},{city:"Amman",E:`Mitigate effects of high NO2 concentrations.\r
\r
Strengthen construction waste management strategy.`,S:"Develop measures that will allow to decrease number of road fatalities.",G:"Develop system that will allow to implement free phone to call the police, ambulance, firefighters at least for citizens."},{city:"Bangkok",E:"Improve waste management system and introduce more effective natural disaster mitigation measures.",S:`Reform system of ambulance due to extremely long time needed.\r
\r
Increase investments in the compulsory education system.`,G:"Despite strong SME support measures public services system needs to be reshaped in order to standardize procedures and reduce waiting times"},{city:"Colombo",E:"While significant improvements have been made in natural disaster risk mitigation, the city still needs to turn its attention to air and water pollution where policies lag behind.",S:"Introduction of new social welfare policies to combat poverty. Despite relatively high levels of safety and healthcare the city is still behind its peers in terms of food availability and wealth.",G:`Strengthen budget policies and regulations to be able to plan long term measures.\r
\r
The city needs to invest into ESG strategies and reporting.`}],eCe=({selectedCityName:n})=>{const{classes:e}=jA(),i=oc(),a=w_.find(s=>s.City===n);return _e(ko,{children:[a&&_e("div",{className:e.root,children:[_e("div",{className:e.titleWrapper,children:[_e("div",{className:e.cityNameAndCountryNameWrapper,children:[U("div",{className:e.cityName,children:n}),U("div",{className:e.countryName,children:a.Country})]}),_e("div",{className:e.cityDescription,children:["Largest city in the",U("br",{}),"country, centre ",U("br",{}),"of region",U("br",{})]})]}),_e("div",{className:e.statWrapper,children:[U(RL,{color:"#FF3B29",title:"Population",value:a.Population,status:a["Population description"]}),U(RL,{color:"#FF3B29",title:"Population density",value:a["Population density"]+" people/ha",status:a["Population density description"]}),U(RL,{color:"#2D67FF",title:"Climate",value:a.Climate,status:a["Climate description"]})]}),_e("div",{style:{display:"flex",marginTop:"3.7vh",marginLeft:"-2.1vh",paddingLeft:"2vh",borderLeft:"1px solid #fff",height:"auto"},children:[_e("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",height:"auto"},children:[U(b0,{label:"Urban resilience index",status:a["Urban Resilience Index"],isFirst:!0}),_e("div",{className:e.smallItemsListWrapper,children:[U(mu,{label:"Environmental",status:a.Environmental}),U(mu,{label:"Social",status:a.Social}),U(mu,{label:"Governmental",status:a.Governmental})]}),U("div",{className:e.smallItemsListWrapper,style:{marginTop:"2.7vh"},children:U(mu,{label:"Ability & Willingness",status:a["Ability & Willingness"]})})]}),_e("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",height:"auto",marginLeft:"1.5vh",gap:"3.2vh"},children:[U(b0,{label:"Basic needs",subLabel:"Scope 0",status:a["Basic needs Scope"]}),U(b0,{label:"Transport resilience index",status:a["Transport Resilience Index"]})]}),_e("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",height:"auto",marginLeft:"1.5vh",gap:"3.2vh"},children:[U(b0,{label:"Natural risk exposure",status:a["Natural Risk Exposure"]}),U(b0,{label:"Urban sentiment index",status:a["Urban Sentiment Index"]})]})]})]}),U(tO,{selectedCityName:n}),U(oi,{onClick:()=>{i("/city/"+n)},style:{position:"absolute",bottom:"9vh",right:"10vh",width:"20vh",height:"6.5vh",borderRadius:50,zIndex:1e3,background:"#2D67FF",color:"#fff",fontFamily:"SuisseIntl-Regular",fontSize:"3vh",fontWeight:100,textTransform:"none"},children:"Dashboard"}),U("div",{className:e.bottomWrapper,style:{position:"absolute",margin:"unset",bottom:"3vh"},children:_e("div",{className:e.smallTextWrapper,onClick:()=>{const s="Methodology_v05_AP_BK_v2.pdf",l=document.createElement("a");l.href=`/pdf/${s}`,l.download=s,l.click()},children:[U(nn,{className:e.smallText,children:"How the rating works"}),U("img",{src:"/assets/questionGray.svg",alt:"hint",style:{opacity:.6}})]})}),U("div",{style:{position:"absolute",fontFamily:"SuisseIntl-Light",fontWeight:100,fontSize:"1.4vh",color:"rgba(255, 255, 255, 0.4)",bottom:"15vh",right:"30%",transform:"translateX(65%)",width:"30%"},children:"The height of a bar represents the total number of people in a grid cell."})]})},tCe=[{name:"Mainpage",link:"/"},{name:"Urban Rating & Monitoring",link:"/urban"},{name:"Corporate Rating & Monitoring",link:"/",disabled:!0},{name:"Project Marketplace",link:"/marketplace"},{name:"Expo City Dubai",link:"/expo_city_dubai"},{name:"Governance"},{name:"Data & Insights"},{name:"Resilience News",link:"/resilience_news"}],Jh=({setVisible:n,isMobile:e=!1})=>_e("div",{children:[U("div",{style:{position:"absolute",width:"100%",height:"100%",top:0,left:0,zIndex:9999,background:"rgba(0, 0, 0, 0.3)",backdropFilter:"blur(30px)"}}),_e("div",{style:{position:"absolute",width:"100%",height:"100%",backgroundColor:"rgba(0,0,0,0.5)",zIndex:9999,paddingLeft:e?"16px":"15vh",paddingTop:e?"16px":"4vh"},children:[_e("div",{onClick:()=>n(!1),style:{cursor:"pointer",display:"flex",alignItems:"center",gap:"2vh",color:"#FFFFFF",fontSize:"3vh",fontFamily:"SuisseIntl-Light",fontWeight:600,marginBottom:e?"16px":"10vh"},children:[U("img",{src:"/assets/closeBtn.svg",alt:"close"}),"Close menu"]}),U("div",{style:{display:"flex",flexDirection:"column",gap:e?"3vh":"unset"},children:tCe.map(i=>U(nCe,{name:i.name,link:i.link,isDisabled:i.disabled,isMobile:e},i.name))})]})]}),nCe=({name:n,link:e,isDisabled:i,isMobile:a=!1})=>{const s=oc(),[l,d]=ne.useState(!1);return _e("div",{onMouseEnter:()=>d(!0),onMouseLeave:()=>d(!1),onClick:()=>{e&&s(e)},style:{pointerEvents:i?"none":"auto",userSelect:"none",cursor:"pointer",fontFamily:"SuisseIntl-Light",fontWeight:400,color:l?"#2D67FF":"#FFFFFF",fontSize:a?"5vh":"8vh",display:"flex",alignItems:"center",flexDirection:"row",gap:"2vh"},children:[_e("div",{style:{opacity:i?.1:1},children:[l&&U("img",{src:"/assets/menuArrow.svg",alt:"arrow",style:{marginRight:"2vh"}}),n]}),i&&U("div",{style:{fontFamily:"SuisseIntl-Light",fontWeight:600,color:"#FFFFFF",fontSize:"2vh",opacity:1,width:"fit-content",borderRadius:"4vh",backgroundColor:"rgba(255,255,255,0.1)",padding:"1vh 2vh"},children:"Coming soon"})]})},iCe=()=>{const[n,e]=ne.useState("map"),[i,a]=ne.useState(null),[s,l]=ne.useState(null),[d,f]=ne.useState(!1);return _e("div",{children:[d&&U(Jh,{setVisible:f}),_e(uxe,{backgroundColor:"#2429B5",children:[U(hxe,{isCitySelected:!!s,setSelectedCity:l,setMenuVisible:f}),s?U(eCe,{selectedCityName:s}):U($Ae,{map:i,currentView:n,setCurrentView:e,isZoomButtonsVisible:n==="map"}),n==="graph"&&!s&&U(_J,{setSelectedCity:l}),n==="map"&&!s&&U(wJ,{setMap:a,setSelectedCity:l})]})]})},EJ=wr()({root:{position:"absolute",overflowY:"scroll",backgroundColor:"#203CBF",width:"100vw",height:"100vh","&::-webkit-scrollbar":{width:"0em"}},sectionWrapper:{position:"relative",height:"100%",width:"100%"},sticky:{position:"sticky",top:0,left:0,right:0,zIndex:1}}),rCe={menu:"Menu",login:"Log in",signup:"Sign up",back:"Back to globe"},MJ=({invertColors:n,setMenuVisible:e,displayBackButton:i,marginLogo:a})=>{const s=f=>rCe[f],{classes:l}=Jw(),d=oc();return _e("div",{className:l.root,style:{margin:"0 10vh 0 10vh",borderBottom:n?"1px solid #000":"1px solid #fff"},children:[U("div",{style:{display:"flex",gap:"2.5vh",alignItems:"center"},children:_e("div",{className:l.menuIconWrapper,children:[!i&&_e("div",{onClick:()=>{d("/urban")},style:{display:"flex",gap:"1vh",alignItems:"center",cursor:"pointer",marginRight:"2vh"},children:[U("img",{style:{width:"4.7vh"},src:"/assets/backToGlobeIcon.svg",width:45,alt:"logo"}),U(nn,{className:l.whiteText,style:{color:n?"#000":"#fff"},children:s("back")})]}),_e("div",{onClick:()=>e(!0),style:{display:"flex",gap:"1vh",flexDirection:"row",alignItems:"center"},children:[n?U("img",{style:{width:"4.7vh"},src:"/assets/blackMenuIcon.svg",width:45,alt:"logo"}):U("img",{style:{width:"4.7vh"},src:"/assets/menuIcon.svg",width:45,alt:"logo"}),U(nn,{className:l.whiteText,style:{color:n?"#000":"#fff"},children:s("menu")})]})]})}),n?U("img",{style:{width:"7.8vh",marginLeft:a||"0"},src:"/assets/blackLogo.svg",alt:"logo"}):U("img",{style:{width:"7.8vh",marginLeft:a||"0"},src:"/assets/logo.svg",alt:"logo"}),_e("div",{className:l.buttonsWrapper,children:[U("div",{style:{width:"19vh"}}),n?U("img",{src:"/assets/blackAvatarIcon.svg",alt:"user icon"}):U("div",{style:{fontFamily:"SuisseIntl-Light",fontWeight:600,color:"#fff",textTransform:"none",fontSize:"1.8vh",height:"4.6vh",width:"fit-content",padding:"0 1.5vh",backgroundColor:"#fff",borderRadius:"50px",display:"flex",alignItems:"center"},children:U("img",{src:"/assets/avatarIcon.svg",alt:"user icon",style:{width:"2.5vh"}})})]})]})},Dx=({children:n,isActive:e})=>{const{classes:i}=EJ();return U("div",{className:`${i.sectionWrapper} `,children:n})},TJ=wr()({root:{padding:0,margin:0,backgroundColor:"#1433AE",color:"#fff",height:"100vh"},contentWrapper:{height:"100%",width:"100%",margin:"0 auto",padding:"0 5%",boxSizing:"border-box"},pageContainer:{position:"relative",display:"block",float:"left",width:"100%",height:"100vh"},titleWrapper:{position:"absolute",top:"11vh",textAlign:"center",width:"100%"},bigText:{paddingTop:"18px",fontFamily:"SuisseIntl-Light",fontWeight:300,lineHeight:"9vh",letterSpacing:"-0.5vh",fontSize:"10.7vh",color:"#fff"},bigTextSubtitle:{paddingTop:"18px",fontFamily:"SuisseIntl-Light",fontWeight:400,lineHeight:"2",letterSpacing:"0",fontSize:"2vh",color:"#fff"},smallItemsListWrapper:{marginTop:"4vh",display:"flex",flexDirection:"column",gap:"1.1vh"},bottomWrapper:{position:"absolute",bottom:"0",zIndex:1,display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:"4vh",pointerEvents:"none",width:"100%"},smallTextWrapper:{pointerEvents:"all",display:"flex",flexDirection:"row",gap:"10px"},smallText:{fontFamily:"SuisseIntl-Light",fontSize:"1.8vh",color:"#fff",opacity:"0.6",cursor:"pointer"}}),aCe=({children:n})=>{const{classes:e}=lz();return U("div",{className:e.root,children:U("div",{className:e.contentWrapper,children:n})})},oCe=({cityName:n,countryName:e})=>{const{classes:i}=TJ();return _e("div",{className:i.titleWrapper,children:[_e(nn,{className:i.bigText,children:[n," ",U("span",{style:{color:"#fff",opacity:.5,letterSpacing:"-0.1vh",fontSize:"6vh"},children:"in indices"})]}),U(nn,{className:i.bigTextSubtitle,children:e})]})},TE=({label:n,subLabel:e,status:i,isFirst:a,filled:s})=>{const l=i.replace("-","");return U(ko,{children:a?_e("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"},children:[U("div",{style:{fontFamily:"SuisseIntl-Light",fontWeight:100,fontSize:"2.4vh",textAlign:"center"},children:n}),U("div",{style:{fontFamily:"SuisseIntl-Light",fontWeight:200,fontSize:"1.8vh",opacity:.6},children:e}),U("div",{style:{fontFamily:"SuisseIntl-Light",fontWeight:200,fontSize:"1.5vh",border:"1px solid #fff",borderRadius:50,padding:"1vh 3vh",marginTop:"1.4vh",color:bT[l],borderColor:`${bT[l]}30`},children:i})]}):_e("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"},children:[U("div",{style:{fontFamily:"SuisseIntl-Light",fontWeight:100,fontSize:"2.4vh",textAlign:"center"},children:n}),U("div",{style:{fontFamily:"SuisseIntl-Light",fontWeight:200,fontSize:"1.8vh",border:"1px solid #fff",borderRadius:50,padding:"1vh 3vh",marginTop:"1.4vh",color:Ys[i.toUpperCase().replace(" ","_")],borderColor:`${Ys[i.toUpperCase().replace(" ","_")]}30`,borderWidth:1,backgroundColor:s?`${Ys[i.toUpperCase()]}30`:"transparent"},children:i})]})})},AJ=ne.createContext(void 0),jo=()=>{const n=ne.useContext(AJ);if(!n)throw new Error("useSelectedCityData must be used within a CityDataProvider");return n},sCe=({selectedCityName:n,setMap:e})=>{Id.accessToken="pk.eyJ1Ijoic3RhbnJvbnpoaW4iLCJhIjoiY2xvaGF3ZmFzMWdodDJxbjByeHMzanE2dCJ9.3uz_EG8N_d7isS1h5wV46w";const i=ne.useRef(null),a=ne.useRef(null);return ne.useEffect(()=>{var l;if(a.current||!i.current)return;const s=(l=SJ.find(d=>d.properties.City_Name===n))==null?void 0:l.properties;a.current=new Id.Map({attributionControl:!0,container:i.current,style:"mapbox://styles/stanronzhin/clpdlsmlk00bt01p9e53lgin4",center:s==null?void 0:s.center,zoom:(s==null?void 0:s.zoom)-.5,bearing:s==null?void 0:s.bearing,pitch:s==null?void 0:s.pitch}),a.current.on("load",()=>{if(!a.current)return;a.current.resize();let d,f,p=!1;function y(_){d===void 0&&(d=_);const b=_-d;if(f!==_){const S=Math.min((s==null?void 0:s.vscale)/2500*b,s==null?void 0:s.vscale);a.current.setPaintProperty("bars-14-cities-shp-8gys15","fill-extrusion-vertical-scale",S),S===1&&(p=!0)}b<2500&&(f=_,p||requestAnimationFrame(y))}y(0)}),e(a.current)},[]),U("div",{ref:i,style:{pointerEvents:"none",position:"absolute",top:"10vh",right:"0",width:"100%",height:"90vh"}})},lCe=({map:n})=>_e("div",{style:{userSelect:"none",position:"absolute",right:"40vh",bottom:"3vh",zIndex:2,marginRight:"15px",height:"10.5vh",width:"4.7vh",display:"flex",flexDirection:"column",backgroundColor:"#fff",borderRadius:"50px",overflow:"hidden",padding:0,margin:0,pointerEvents:"all"},children:[U("div",{onClick:()=>{n&&n.zoomIn()},style:{userSelect:"none",cursor:"pointer",height:"50%",display:"flex",justifyContent:"center",alignItems:"center",backgroundColor:"#fff",borderRadius:"50px",overflow:"hidden",padding:0,margin:0},children:U("img",{style:{userSelect:"none"},src:"/assets/plusIcon.svg",width:"45%",alt:"zoom in"})}),U("div",{onClick:()=>{if(!n)return;n.getZoom()>10.5&&n.zoomOut()},style:{cursor:"pointer",height:"50%",display:"flex",justifyContent:"center",alignItems:"center",backgroundColor:"#fff",borderRadius:"50px",overflow:"hidden",padding:0,margin:0,userSelect:"none"},children:U("img",{src:"/assets/minusIcon.svg",width:"45%",alt:"zoom out"})})]}),cCe=({setActiveSection:n})=>{const{classes:e}=TJ(),[i,a]=ne.useState(null),s=jo();return _e("div",{style:{position:"relative"},children:[U(sCe,{setMap:a,selectedCityName:s.City}),_e(aCe,{children:[_e("div",{className:e.pageContainer,children:[U(oCe,{cityName:s.City,countryName:s.Country}),_e("div",{style:{position:"absolute",top:"30%",left:"2vh",borderLeft:"1px solid #fff",paddingLeft:"2vh",height:"auto",transform:"scale(1.2)"},children:[U("div",{style:{cursor:"pointer"},onClick:()=>{const l=document.getElementById("landing");l.scrollTo({top:l.clientHeight*2,behavior:"smooth"})},children:U(b0,{label:"Urban resilience index",status:s["Urban Resilience Index"],isFirst:!0})}),_e("div",{className:e.smallItemsListWrapper,children:[U(mu,{label:"Environmental",status:s.Environmental,style:{fontSize:"2.1vh"}}),U(mu,{label:"Social",status:s.Social,style:{fontSize:"2.1vh"}}),U(mu,{label:"Governmental",status:s.Governmental,style:{fontSize:"2.1vh"}})]}),U("div",{className:e.smallItemsListWrapper,style:{marginTop:"2.7vh"},children:U(mu,{label:"Ability & Willingness",status:s["Ability & Willingness"],style:{fontSize:"2.1vh"}})})]}),_e("div",{style:{position:"absolute",top:"27%",right:"9vh",display:"flex",flexDirection:"column",gap:"3.2vh",height:"43.5vh"},children:[U("div",{style:{fontFamily:"SuisseIntl-Light",fontWeight:100,fontSize:"3vh",textAlign:"center"},children:"Related indices"}),U("div",{children:U(TE,{isFirst:!0,label:"Basic needs index",subLabel:"Scope 0",status:s["Basic needs Scope"]})}),U(TE,{label:"Social sentiment index",status:s["Urban Sentiment Index"],filled:!0}),U(TE,{label:"Natural risk exposure index",status:s["Natural Risk Exposure"]}),U("div",{onClick:()=>{const l=document.getElementById("landing");l.scrollTo({top:l.clientHeight*3,behavior:"smooth"})},style:{cursor:"pointer"},children:U(TE,{label:"Transport resilience index",status:s["Transport Resilience Index"],filled:!0})})]}),_e("div",{className:e.bottomWrapper,children:[_e("div",{className:e.smallTextWrapper,onClick:()=>{const l="Methodology_v05_AP_BK_v2.pdf",d=document.createElement("a");d.href=`/pdf/${l}`,d.download=l,d.click()},children:[U(nn,{className:e.smallText,children:"How the rating works"}),U("img",{src:"/assets/questionGray.svg",alt:"hint",style:{opacity:.6}})]}),_e("div",{children:[(s.City==="Dubai"||s.City==="Dar es Salaam")&&U(oi,{onClick:()=>{const l=document.getElementById("landing");l.scrollTo({top:l.clientHeight*5,behavior:"smooth"})},style:{marginBottom:"5vh",backgroundColor:"#3752BA",color:"#fff",borderRadius:50,padding:"1vh 2.5vh",textTransform:"none",pointerEvents:"all",cursor:"pointer",fontFamily:"SuisseIntl-Light",fontSize:"1.7vh",alignItems:"center"},children:"Geoanalytics"}),_e("div",{onClick:()=>{const l=document.getElementById("landing");l.scrollTo({top:l.clientHeight,behavior:"smooth"})},style:{pointerEvents:"all",cursor:"pointer",fontFamily:"SuisseIntl-Light",fontSize:"1.7vh",display:"flex",flexDirection:"column",gap:"1.2vh",alignItems:"center"},children:[U("div",{children:"Scroll down"}),U("img",{src:"/assets/arrowDown.svg",alt:"arrow down",style:{animation:"bounce 2s infinite"}})]})]}),_e(oi,{style:{pointerEvents:"all",color:"#fff",backgroundColor:"#2D67FF",borderRadius:50,padding:"1vh 2.5vh",textTransform:"none",fontFamily:"SuisseIntl-Light",fontSize:"1.7vh",display:"flex",flexDirection:"row",gap:"1.2vh"},onClick:()=>{const l=s.pdfName,d=document.createElement("a");d.href=`/pdf/${l}`,d.download=l,d.click()},children:[U("div",{children:"Download report"}),U("img",{src:"/assets/downloadIcon.svg",alt:"arrow down"})]})]})]}),U("div",{style:{position:"absolute",fontFamily:"SuisseIntl-Light",fontWeight:100,fontSize:"1.4vh",color:"rgba(255, 255, 255, 0.4)",bottom:"22vh",right:"50%",transform:"translateX(65%)",width:"30%"},children:"The height of a bar represents the total number of people in a grid cell."}),U(lCe,{map:i})]})]})},uS=wr()({root:{padding:0,margin:0,color:"#fff",height:"100vh"},contentWrapper:{height:"100%",width:"100%",margin:"0 auto",padding:"0 5%",boxSizing:"border-box"},pageContainer:{position:"relative",display:"block",float:"left",width:"100%",height:"100vh"},titleWrapper:{position:"absolute",top:"11vh",textAlign:"center",width:"100%"},bigText:{paddingTop:"18px",fontFamily:"SuisseIntl-Light",fontWeight:300,lineHeight:"9vh",letterSpacing:"-0.5vh",fontSize:"10.7vh",color:"#fff"},bigTextSubtitle:{paddingTop:"18px",fontFamily:"SuisseIntl-Light",fontWeight:400,lineHeight:"2",letterSpacing:"0",fontSize:"2vh",color:"#fff"},smallItemsListWrapper:{marginTop:"4vh",display:"flex",flexDirection:"column",gap:"1.1vh"},bottomWrapper:{position:"absolute",bottom:"0",zIndex:1,display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:"4vh",pointerEvents:"none",width:"100%"},smallTextWrapper:{pointerEvents:"all",display:"flex",flexDirection:"row",gap:"10px"},smallText:{fontFamily:"SuisseIntl-Light",fontSize:"1.8vh",color:"#fff",opacity:"0.6",cursor:"pointer"}}),f0=({label:n,value:e,status:i,color:a})=>_e("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"flex-end"},children:[U("div",{style:{fontFamily:"SuisseIntl-Light",fontSize:"2vh",textAlign:"center"},children:n}),U("div",{style:{fontFamily:"SuisseIntl-Light",fontSize:"2.5vh",marginTop:".7vh",textAlign:"center"},children:e}),U("div",{style:{fontFamily:"SuisseIntl-Light",fontSize:"2vh",fontWeight:600,marginTop:"1.45vh",textAlign:"center",padding:"1vh 3vh",backgroundColor:"#fff",color:a,borderRadius:50,width:"fit-content"},children:i})]}),nO=({bgUrl:n,isActive:e,onClick:i})=>U("div",{onClick:i,style:{pointerEvents:"all",cursor:"pointer",height:"4.5vh",width:"4.5vh",borderRadius:"50%",border:"1px solid #fff",backgroundImage:e?"none":`url(${n})`,backgroundSize:"cover",backgroundPosition:"center",display:"flex",justifyContent:"center",alignItems:"center"},children:e&&U("div",{style:{height:"10px",width:"10px",borderRadius:"50%",backgroundColor:"#fff"}})}),iO=({imagesUrls:n,activeImageIndex:e})=>U("div",{style:{position:"absolute",width:"100%",height:"100%"},children:n.map((i,a)=>U("div",{style:{position:"absolute",width:"100%",height:"100%",backgroundImage:`url(${i})`,backgroundSize:"cover",backgroundPosition:"center",opacity:e===a?1:0,transition:"opacity 0.5s ease"}},a))}),uCe=({setActiveSection:n})=>{const[e,i]=ne.useState(0),{classes:a}=uS(),s=jo(),l=s.Climate.replace(/,/g,"/"),d=(s["Poverty headcount ratio at national poverty lines"]*100).toFixed(1)+"% ",f=(s["Literacy rate among population"]*100).toFixed(1)+"% ";return _e("div",{style:{position:"relative"},children:[U(iO,{imagesUrls:s.images,activeImageIndex:e}),_e("div",{className:a.root,children:[U("div",{style:{position:"absolute",top:"0",left:"0",width:"100%",height:"100%",background:"linear-gradient(180deg, rgba(0,0,0,0.5) 90%, rgba(0,0,0,0.5))"}}),U("div",{className:a.contentWrapper,children:_e("div",{className:a.pageContainer,children:[_e("div",{style:{position:"absolute",top:"15vh",justifyContent:"center",width:"100%",margin:"0 auto",gap:"4vh",textAlign:"center",fontFamily:"SuisseIntl-Light",fontWeight:300,lineHeight:"9vh",letterSpacing:"-0.5vh",fontSize:"8vh",color:"#fff"},children:[s.City," in Pictures and Numbers"]}),_e("div",{style:{position:"absolute",top:"28vh",display:"flex",flexDirection:"row",justifyContent:"center",width:"100%",margin:"0 auto",gap:"4vh"},children:[U(f0,{label:U("div",{children:"Population"}),value:s.Population,status:s["Population description"],color:"#FF3B29"}),U(f0,{label:U("div",{children:"Population density"}),value:s["Population density"]+" people/ha",status:s["Population density description"],color:"#FF3B29"}),U(f0,{label:U("div",{children:"Mean salary"}),value:s["Mean salary"]+" PPP$",status:s["Mean salary description"],color:"#FF3B29"}),U(f0,{label:_e("div",{children:["Poverty headcount ratio ",U("br",{})," at national poverty lines"]}),value:d+"of population",status:s["Poverty headcount ratio at national poverty lines description"],color:"#A0DA8B"}),U(f0,{label:_e("div",{children:["Literacy rate among ",U("br",{}),"population (15-24 Years)"]}),value:f,status:s["Literacy rate among population description"],color:"#A0DA8B"}),U(f0,{label:U("div",{children:"Climate"}),value:l,status:s["Climate description"],color:"#2D67FF"})]}),_e("div",{className:a.bottomWrapper,children:[U("div",{}),U("div",{style:{position:"absolute",width:"100%",display:"flex",flexDirection:"row",justifyContent:"center",gap:"1.6vh"},children:s.images.map((p,y)=>U(nO,{bgUrl:p,onClick:()=>{i(y)},isActive:e===y},y))}),_e("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",gap:"10vh",fontSize:"1.7vh",fontFamily:"SuisseIntl-Light"},children:[U("a",{children:_e("div",{style:{pointerEvents:"all",color:"#fff",cursor:"pointer",textDecoration:"underline"},children:["Become our reporter",U("br",{}),"Suggest another image"]})}),_e(oi,{style:{pointerEvents:"all",color:"#fff",backgroundColor:"#2D67FF",borderRadius:50,padding:"1vh 2.5vh",textTransform:"none",fontFamily:"SuisseIntl-Light",fontSize:"1.7vh",display:"flex",flexDirection:"row",justifyContent:"center",gap:"1.2vh"},onClick:()=>{const p=s.pdfName,y=document.createElement("a");y.href=`/pdf/${p}`,y.download=p,y.click()},children:[U("div",{children:"Download report"}),U("img",{src:"/assets/downloadIcon.svg",alt:"arrow down"})]})]})]})]})})]})]})},LL=({children:n,side:e,setHoveredSide:i,setClickedCategory:a})=>{const[s,l]=ne.useState(!1);return _e("div",{onMouseEnter:()=>{l(!0),i(e)},onMouseLeave:()=>{l(!1),i(null)},style:{border:s?"1px solid #fff":"1px solid transparent",position:"absolute",backgroundImage:"url(/assets/cube_solid_bg.png)",backgroundRepeat:"no-repeat",backgroundSize:"cover",backgroundPosition:"center",height:e==="top"?"404px":"448px",width:e==="top"?"456px":"448px",padding:"20px 10px",boxSizing:"border-box",top:e==="left"?"247px":e==="right"?"248px":"11px",right:e==="left"?"226px":e==="right"?"-74px":"71px",transform:e==="left"?"skew(0deg, 35.5deg) scale(0.67)":e==="right"?"skew(0deg, -35.5deg) scale(0.67)":"rotate3d(1.1, 0.7, 1.2, -63.7deg)"},children:[n,U("div",{style:{position:"absolute",bottom:"20px",right:"20px",fontFamily:"SuisseIntl-Light",fontSize:"25px",opacity:s?1:.7,color:"#fff"},children:e==="left"?"Environment":e==="right"?"Governmental":"Social"})]})},kL=({title:n,color:e,setClickedCategory:i})=>{const[a,s]=ne.useState(!1);return U("div",{onClick:()=>{i(n)},onMouseOver:()=>{s(!0)},onMouseOut:()=>{s(!1)},style:{cursor:"pointer",fontFamily:"SuisseIntl-Light",fontSize:"21px",color:"#fff"},children:_e("div",{style:{width:"fit-content",height:"fit-content",backgroundColor:a?e:"transparent",borderRadius:"32px",display:"flex",alignItems:"center",flexDirection:"row",padding:".6vh 2vh",gap:"15px"},children:[U("div",{children:n}),U("div",{style:{width:"2vh",height:"2vh",backgroundColor:a?"#fff":e,borderRadius:"50%"}})]})})},DL=[{City:"Dubai",Country:"UAE","Urban Resilience Index":"A-3",Environmental:4,Social:4,Governmental:4,"Air pollution":2,"Water pollution":4,"Land use and waste":5,"Natural disaster hazards":5,"Water availability":4,"Food availability":5,"Energy availability":4,Health:4,Education:5,Wealth:5,Safety:5,Livability:5,Transport:5,Inclusion:2,Accountability:5,"City budget":4,SME:4,"Public services":5,"Sustainability commitment":5},{City:"Expo City Dubai",Country:"UAE","Urban Resilience Index":"A-2",Environmental:4,Social:4,Governmental:4,"Air pollution":2,"Water pollution":4,"Land use and waste":4,"Natural disaster hazards":5,"Water availability":4,"Food availability":5,"Energy availability":4,Health:4,Education:5,Wealth:5,Safety:5,Livability:5,Transport:5,Inclusion:2,Accountability:5,"City budget":4,SME:4,"Public services":5,"Sustainability commitment":5},{City:"Valparaiso",Country:"Chile","Urban Resilience Index":"C-1",Environmental:2,Social:2,Governmental:2,"Air pollution":2,"Water pollution":4,"Land use and waste":3,"Natural disaster hazards":5,"Water availability":3,"Food availability":4,"Energy availability":5,Health:3,Education:3,Wealth:3,Safety:2,Livability:2,Transport:2,Inclusion:4,Accountability:1,"City budget":3,SME:1,"Public services":5,"Sustainability commitment":5},{City:"Dar es Salaam",Country:"Tanzania","Urban Resilience Index":"C-2",Environmental:2,Social:2,Governmental:2,"Air pollution":3,"Water pollution":1,"Land use and waste":2,"Natural disaster hazards":4,"Water availability":2,"Food availability":4,"Energy availability":3,Health:2,Education:2,Wealth:2,Safety:2,Livability:2,Transport:2,Inclusion:4,Accountability:3,"City budget":3,SME:2,"Public services":3,"Sustainability commitment":3},{City:"Adoni",Country:"India","Urban Resilience Index":"C-2",Environmental:2,Social:1,Governmental:2,"Air pollution":3,"Water pollution":2,"Land use and waste":4,"Natural disaster hazards":4,"Water availability":4,"Food availability":3,"Energy availability":4,Health:2,Education:2,Wealth:2,Safety:1,Livability:2,Transport:2,Inclusion:4,Accountability:1,"City budget":4,SME:2,"Public services":5,"Sustainability commitment":5},{City:"Natal",Country:"Brazil","Urban Resilience Index":"B-2",Environmental:3,Social:3,Governmental:3,"Air pollution":4,"Water pollution":3,"Land use and waste":5,"Natural disaster hazards":4,"Water availability":3,"Food availability":3,"Energy availability":3,Health:3,Education:3,Wealth:3,Safety:1,Livability:3,Transport:3,Inclusion:3,Accountability:1,"City budget":4,SME:2,"Public services":3,"Sustainability commitment":3},{City:"Brazzaville",Country:"Congo","Urban Resilience Index":"C-1",Environmental:3,Social:1,Governmental:3,"Air pollution":4,"Water pollution":1,"Land use and waste":3,"Natural disaster hazards":4,"Water availability":4,"Food availability":2,"Energy availability":3,Health:1,Education:3,Wealth:2,Safety:1,Livability:3,Transport:3,Inclusion:1,Accountability:1,"City budget":1,SME:1,"Public services":3,"Sustainability commitment":3},{City:"Almaty",Country:"Kazakhstan","Urban Resilience Index":"B-1",Environmental:3,Social:4,Governmental:3,"Air pollution":4,"Water pollution":3,"Land use and waste":5,"Natural disaster hazards":5,"Water availability":5,"Food availability":4,"Energy availability":4,Health:5,Education:4,Wealth:4,Safety:4,Livability:4,Transport:4,Inclusion:2,Accountability:3,"City budget":4,SME:4,"Public services":5,"Sustainability commitment":5},{City:"Cape Town",Country:"South Africa","Urban Resilience Index":"B-2",Environmental:3,Social:3,Governmental:4,"Air pollution":4,"Water pollution":2,"Land use and waste":2,"Natural disaster hazards":4,"Water availability":2,"Food availability":2,"Energy availability":2,Health:1,Education:3,Wealth:3,Safety:2,Livability:3,Transport:4,Inclusion:4,Accountability:4,"City budget":2,SME:3,"Public services":4,"Sustainability commitment":5},{City:"Mexico City",Country:"Mexico","Urban Resilience Index":"C-2",Environmental:2,Social:2,Governmental:2,"Air pollution":1,"Water pollution":1,"Land use and waste":3,"Natural disaster hazards":"Low","Water availability":3,"Food availability":1,"Energy availability":3,Health:3,Education:3,Wealth:3,Safety:1,Livability:2,Transport:2,Inclusion:1,Accountability:2,"City budget":2,SME:2,"Public services":3,"Sustainability commitment":2},{City:"Jakarta",Country:"Indonesia","Urban Resilience Index":"B-3",Environmental:2,Social:3,Governmental:3,"Air pollution":1,"Water pollution":3,"Land use and waste":3,"Natural disaster hazards":"Low","Water availability":3,"Food availability":2,"Energy availability":3,Health:2,Education:2,Wealth:2,Safety:4,Livability:3,Transport:3,Inclusion:2,Accountability:5,"City budget":2,SME:4,"Public services":3,"Sustainability commitment":3},{City:"Panama City",Country:"Panama","Urban Resilience Index":"B-1",Environmental:3,Social:4,Governmental:3,"Air pollution":3,"Water pollution":4,"Land use and waste":4,"Natural disaster hazards":3,"Water availability":4,"Food availability":4,"Energy availability":5,Health:4,Education:1,Wealth:2,Safety:4,Livability:2,Transport:3,Inclusion:3,Accountability:3,"City budget":3,SME:2,"Public services":4,"Sustainability commitment":4},{City:"Amman",Country:"Jordan","Urban Resilience Index":"B-1",Environmental:2,Social:4,Governmental:4,"Air pollution":2,"Water pollution":2,"Land use and waste":3,"Natural disaster hazards":3,"Water availability":4,"Food availability":4,"Energy availability":3,Health:3,Education:3,Wealth:4,Safety:4,Livability:4,Transport:3,Inclusion:2,Accountability:5,"City budget":3,SME:3,"Public services":3,"Sustainability commitment":3},{City:"Bangkok",Country:"Thailand","Urban Resilience Index":"B-3",Environmental:2,Social:3,Governmental:2,"Air pollution":2,"Water pollution":2,"Land use and waste":2,"Natural disaster hazards":2,"Water availability":4,"Food availability":2,"Energy availability":4,Health:4,Education:2,Wealth:3,Safety:5,Livability:3,Transport:2,Inclusion:4,Accountability:2,"City budget":1,SME:5,"Public services":2,"Sustainability commitment":4},{City:"Colombo",Country:"Sri Lanka","Urban Resilience Index":"B-2",Environmental:3,Social:3,Governmental:3,"Air pollution":3,"Water pollution":4,"Land use and waste":2,"Natural disaster hazards":4,"Water availability":3,"Food availability":2,"Energy availability":5,Health:4,Education:1,Wealth:2,Safety:4,Livability:2,Transport:4,Inclusion:3,Accountability:1,"City budget":2,SME:3,"Public services":3,"Sustainability commitment":2}],AE=["#FF3B29","#FF632F","#FF9B3F","#A0DA8B","#35CB00"],zL={left:["Air pollution","Water pollution","Land use and waste","Natural disaster hazards"],right:["Accountability","City budget","SME","Public services","Sustainability commitment"],top:["Water availability","Food availability","Energy availability","Health","Education","Wealth","Safety","Livability","Transport","Inclusion"]},CJ=({setHoveredSide:n,setClickedCategory:e,isMobile:i,setCubeHeight:a})=>{const[s,l]=ne.useState(i?Math.min(Math.min(window.innerHeight/950,window.innerWidth/650),.78):Math.min(window.innerHeight/950,window.innerWidth/650));return ne.useEffect(()=>{var d;if(i){const f=(d=document.getElementById("cube"))==null?void 0:d.getBoundingClientRect().height;a(f)}},[]),ne.useEffect(()=>{window.addEventListener("resize",()=>{const d=window.innerHeight;let f=Math.min(d/950,window.innerWidth/650);i&&(f=Math.min(f,.78)),l(f)})},[window.innerHeight&&window.innerWidth]),_e("div",{id:"cube",style:{zIndex:1,width:"600px",height:"728px",position:"absolute",display:"flex",top:"50%",left:"50%",transform:"translate(-50%, -50%) scale("+s+")"},children:[U(LL,{side:"left",setHoveredSide:n,children:U("div",{style:{display:"flex",flexDirection:"column",gap:"2vh"},children:zL.left.map(d=>{const p=jo().City,_=DL.find(S=>S.City===p)[d],b=AE[_-1]?AE[_-1]:"#FF632F";return U(kL,{title:d,color:b,setClickedCategory:e},d)})})}),U(LL,{side:"right",setHoveredSide:n,setClickedCategory:e,children:U("div",{style:{display:"flex",flexDirection:"column",gap:"2vh"},children:zL.right.map(d=>{const p=jo().City,_=DL.find(b=>b.City===p)[d];return U(kL,{title:d,color:AE[_-1],setClickedCategory:e},d)})})}),U(LL,{side:"top",setHoveredSide:n,setClickedCategory:e,children:U("div",{style:{display:"flex",flexDirection:"column",gap:"-1vh"},children:zL.top.map(d=>{const p=jo().City,_=DL.find(b=>b.City===p)[d];return U(kL,{title:d,color:AE[_-1],setClickedCategory:e},d)})})})]})},dCe=({clickedCategory:n,setClickedCategory:e,setTablePopupOpen:i})=>{const{classes:a}=uS(),[s,l]=ne.useState(null),[d,f]=ne.useState(null),p=jo();return ne.useEffect(()=>{const y=QAe.find(A=>A.city===p.City),_=y.E,b=y.S,S=y.G;f(s==="left"?_:s==="top"?b:s==="right"?S:null)},[s]),U(ko,{children:U("div",{style:{position:"relative",backgroundImage:"url(/assets/new_bg_cube.png)",backgroundSize:"cover",backgroundRepeat:"no-repeat",backgroundPosition:"center"},children:_e("div",{className:a.root,children:[U(CJ,{setHoveredSide:l,setClickedCategory:e}),_e("div",{className:a.contentWrapper,children:[_e("div",{style:{position:"absolute",top:"15.5%",left:"9vh",display:"flex",flexDirection:"column"},children:[_e("div",{style:{fontFamily:"SuisseIntl-Light",fontSize:"6.25vh",color:"#fff",zIndex:1},children:[p.City,": ","",U("br",{}),"Urban ",U("b",{children:"resilience"}),U("br",{}),"index",U("span",{style:{paddingTop:"-1.5vh",verticalAlign:"middle",marginLeft:"1.2vh",fontFamily:"SuisseIntl-Light",fontSize:"3vh",fontWeight:400,marginTop:"1.45vh",textAlign:"center",padding:"1vh 3vh",backgroundColor:bT[p["Urban Resilience Index"].replace("-","")],color:"#fff",borderRadius:50,width:"fit-content"},children:p["Urban Resilience Index"]})]}),U("div",{style:{position:"absolute",top:"25vh",paddingLeft:"2vh",height:"auto",transform:"scale(1.2)"},children:_e("div",{className:a.smallItemsListWrapper,children:[U(mu,{label:"Environmental",status:p.Environmental,style:{fontSize:"2.1vh"}}),U(mu,{label:"Social",status:p.Social,style:{fontSize:"2.1vh"}}),U(mu,{label:"Governmental",status:p.Governmental,style:{fontSize:"2.1vh"}})]})})]}),_e("div",{style:{position:"absolute",top:"33%",lineHeight:"1.5",right:"5vh",width:"30vh",fontFamily:"SuisseIntl-Light",fontSize:"2.1vh"},children:[s==="left"||s==="top"||s==="right"?"Policy hints":"",U("br",{}),U("br",{}),d]}),U("div",{className:a.pageContainer,children:_e("div",{className:a.bottomWrapper,children:[_e("div",{className:a.smallTextWrapper,onClick:()=>{const y="Methodology_v05_AP_BK_v2.pdf",_=document.createElement("a");_.href=`/pdf/${y}`,_.download=y,_.click()},children:[U(nn,{className:a.smallText,children:"How the rating works"}),U("img",{src:"/assets/questionGray.svg",alt:"hint",style:{opacity:.6}})]}),U(oi,{onClick:()=>{i(!0)},style:{pointerEvents:"all",color:"#fff",backgroundColor:"transparent",border:"1px solid rgba(255, 255, 255, 0.3)",borderRadius:50,padding:"1vh 2.5vh",textTransform:"none",fontFamily:"SuisseIntl-Light",fontSize:"1.7vh",display:"flex",flexDirection:"row",gap:"1.2vh"},children:U("div",{children:"Table view"})}),_e(oi,{style:{pointerEvents:"all",color:"#fff",backgroundColor:"#2D67FF",borderRadius:50,padding:"1vh 2.5vh",textTransform:"none",fontFamily:"SuisseIntl-Light",fontSize:"1.7vh",display:"flex",flexDirection:"row",gap:"1.2vh"},onClick:()=>{const y=p.pdfName,_=document.createElement("a");_.href=`/pdf/${y}`,_.download=y,_.click()},children:[U("div",{children:"Download report"}),U("img",{src:"/assets/downloadIcon.svg",alt:"arrow down"})]})]})})]})]})})})},PJ=({cityData:n,children:e})=>U(AJ.Provider,{value:n,children:e}),IJ=({setMap:n,isMobile:e})=>{Id.accessToken="pk.eyJ1Ijoic3RhbnJvbnpoaW4iLCJhIjoiY2xvaGF3ZmFzMWdodDJxbjByeHMzanE2dCJ9.3uz_EG8N_d7isS1h5wV46w";const i=ne.useRef(null),a=ne.useRef(null);return ne.useEffect(()=>{a.current||!i.current||(a.current=new Id.Map({attributionControl:!1,container:i.current,style:"mapbox://styles/stanronzhin/cloycy6uc012f01qye3qz7lc4",center:[55.28314923749909,25.02940197161118],zoom:e?9:10.5,bearing:0,pitch:60}),a.current.on("load",()=>{a.current.scrollZoom.disable(),a.current.addSource("build_up",{type:"raster",url:"mapbox://stanronzhin.bly9vkw2"}),a.current.addLayer({id:"Build up",source:"build_up",type:"raster",paint:{"raster-opacity":.8,"raster-fade-duration":500},layout:{visibility:"none"}},"land-structure-line"),a.current.addSource("pop_raster",{type:"raster",url:"mapbox://stanronzhin.3wcn7mfu"}),a.current.addLayer({id:"Population 2D",source:"pop_raster",type:"raster",paint:{"raster-opacity":1,"raster-fade-duration":500},layout:{visibility:"none"}},"land-structure-line"),a.current.addSource("pop_bars",{type:"vector",url:"mapbox://stanronzhin.6j7olk89"}),a.current.addLayer({id:"Population 3D",type:"fill-extrusion",source:"pop_bars","source-layer":"Dubai_Population_Bars_NO2_SO2-cpdzjb",layout:{visibility:"none"},paint:{"fill-extrusion-height":["get","Population"],"fill-extrusion-vertical-scale":2,"fill-extrusion-color":["interpolate",["linear"],["get","Population"],1,"#fefefe",12196,"#828282"],"fill-extrusion-opacity":.9}},"expo-city-dubai-label"),a.current.addLayer({id:"Population 3D x SO2",type:"fill-extrusion",source:"pop_bars","source-layer":"Dubai_Population_Bars_NO2_SO2-cpdzjb",layout:{visibility:"none"},paint:{"fill-extrusion-height":["get","Population"],"fill-extrusion-vertical-scale":2,"fill-extrusion-color":["interpolate",["linear"],["get","SO2_mean"],2.109820365905762,"#000004",5.94,"#50127b",9.78,"#b6377a",13.62,"#fb8761",17.892879486083984,"#fcfdbf"],"fill-extrusion-opacity":.9}},"expo-city-dubai-label"),a.current.addLayer({id:"Population 3D x NO2",type:"fill-extrusion",source:"pop_bars","source-layer":"Dubai_Population_Bars_NO2_SO2-cpdzjb",layout:{visibility:"none"},paint:{"fill-extrusion-height":["get","Population"],"fill-extrusion-vertical-scale":2,"fill-extrusion-color":["interpolate",["linear"],["get","No2_mean"],1.002105474472046,"#440154",4,"#3b528b",7,"#21908d",10,"#5dc963",12.314108322964207,"#fde725"],"fill-extrusion-opacity":.9}},"expo-city-dubai-label"),a.current.addLayer({id:"Population 3D x O3",type:"fill-extrusion",source:"pop_bars","source-layer":"Dubai_Population_Bars_NO2_SO2-cpdzjb",layout:{visibility:"none"},paint:{"fill-extrusion-height":["get","Population"],"fill-extrusion-vertical-scale":2,"fill-extrusion-color":["interpolate",["linear"],["get","O3_mean"],5989.198242187499,"#edf8fb",6005,"#b2e2e2",6021,"#66c2a4",6037.02,"#2ca25f",6053.04296875,"#006d2c"],"fill-extrusion-opacity":.9}},"expo-city-dubai-label"),a.current.addLayer({id:"Population 3D x CO",type:"fill-extrusion",source:"pop_bars","source-layer":"Dubai_Population_Bars_NO2_SO2-cpdzjb",layout:{visibility:"none"},paint:{"fill-extrusion-height":["get","Population"],"fill-extrusion-vertical-scale":2,"fill-extrusion-color":["interpolate",["linear"],["get","CO_mean"],781,"#f6eff7",862.3,"#d0d6e8",925.4,"#a0bedb",939,"#67a9cf",953,"#3598ab",965,"#138484",998.3495483398436,"#016c59"],"fill-extrusion-opacity":.9}},"expo-city-dubai-label"),a.current.addLayer({id:"Population 3D x PM10",type:"fill-extrusion",source:"pop_bars","source-layer":"Dubai_Population_Bars_NO2_SO2-cpdzjb",layout:{visibility:"none"},paint:{"fill-extrusion-height":["get","Population"],"fill-extrusion-vertical-scale":2,"fill-extrusion-color":["interpolate",["linear"],["get","UV_mean"],.703,"#cfcfcf",.85,"#b1b0af",1.1,"#a79e75",1.16,"#c5b56c",1.32,"#e5d05a",1.479856308970643,"#ffea46"],"fill-extrusion-opacity":.9}},"expo-city-dubai-label"),a.current.addSource("SO2",{type:"raster",url:"mapbox://stanronzhin.45878sao"}),a.current.addLayer({id:"SO2 2D",type:"raster",paint:{"raster-opacity":.8,"raster-fade-duration":500},layout:{visibility:"none"},source:"SO2"},"land-structure-line"),a.current.addSource("NO2",{type:"raster",url:"mapbox://stanronzhin.cazbwhrj"}),a.current.addLayer({id:"NO2 2D",type:"raster",paint:{"raster-opacity":.8,"raster-fade-duration":500},layout:{visibility:"none"},source:"NO2"},"land-structure-line"),a.current.addSource("O3",{type:"raster",url:"mapbox://stanronzhin.cbntwjd4"}),a.current.addLayer({id:"O3 2D",type:"raster",paint:{"raster-opacity":.8,"raster-fade-duration":500},layout:{visibility:"none"},source:"O3"},"land-structure-line"),a.current.addSource("CO",{type:"raster",url:"mapbox://stanronzhin.446ij1ot"}),a.current.addLayer({id:"CO 2D",type:"raster",paint:{"raster-opacity":.8,"raster-fade-duration":500},layout:{visibility:"none"},source:"CO"},"land-structure-line"),a.current.addSource("PM10",{type:"raster",url:"mapbox://stanronzhin.a1bmhhk8"}),a.current.addLayer({id:"PM10 2D",type:"raster",paint:{"raster-opacity":.8,"raster-fade-duration":500},layout:{visibility:"none"},source:"PM10"},"land-structure-line"),a.current.addSource("schools",{type:"vector",url:"mapbox://stanronzhin.862v1tre"}),a.current.addLayer({id:"Schools",source:"schools","source-layer":"Schools_Dubai_DarEsSalaam_shp-2dp8hn",minzoom:0,maxzoom:22,type:"circle",layout:{visibility:"none"},paint:{"circle-color":"#00ff91","circle-radius":2,"circle-stroke-color":"#75ffd6","circle-stroke-width":1}}),a.current.addSource("sa_schools",{type:"vector",url:"mapbox://stanronzhin.db4zco7s"}),a.current.addLayer({id:"School service areas",source:"sa_schools","source-layer":"Schools_Service_Areas_Dubai_D-dcr4b6",minzoom:0,maxzoom:22,type:"fill",paint:{"fill-outline-color":"rgba(255, 255, 255, 0)","fill-color":"#00ffda","fill-opacity":.5},layout:{visibility:"none"}},"Schools"),a.current.addSource("transport_stops",{type:"vector",url:"mapbox://stanronzhin.baw4ssp1"}),a.current.addLayer({id:"Transport stops",source:"transport_stops","source-layer":"Transport_stops_Dubai_DarEsSa-2e5jzv",minzoom:0,maxzoom:22,type:"circle",layout:{visibility:"none"},paint:{"circle-color":"#ff00f6","circle-radius":2,"circle-stroke-color":"#ffffff","circle-stroke-width":1}}),a.current.addSource("sa_transport",{type:"vector",url:"mapbox://stanronzhin.ayut4ft2"}),a.current.addLayer({id:"Transport service areas",source:"sa_transport","source-layer":"Transport_Service_Areas_Dubai-8rypml",minzoom:0,maxzoom:22,type:"fill",paint:{"fill-outline-color":"rgba(255, 255, 255, 0)","fill-color":"#e684dc","fill-opacity":.5},layout:{visibility:"none"}}),a.current.addSource("parks",{type:"vector",url:"mapbox://stanronzhin.bberinf0"}),a.current.addLayer({id:"Parks",source:"parks","source-layer":"Parks_Dubai_DarEsSalaam_shp-4ar5jy",minzoom:0,maxzoom:22,type:"fill",paint:{"fill-color":"#00db63"},layout:{visibility:"none"}}),a.current.addSource("sa_parks",{type:"vector",url:"mapbox://stanronzhin.5g64w2gy"}),a.current.addLayer({id:"Parks service area",source:"sa_parks","source-layer":"Parks_Service_Areas_Dubai_Dar-3u1qpp",minzoom:0,maxzoom:22,type:"fill",paint:{"fill-color":"#00ddd0"},layout:{visibility:"none"}},"Parks"),a.current.addSource("water",{type:"raster",url:"mapbox://stanronzhin.87imwe7u"}),a.current.addLayer({id:"Fresh water",source:"water",type:"raster",paint:{"raster-opacity":.8,"raster-fade-duration":500},layout:{visibility:"none"}}),a.current.addSource("damagedLand",{type:"raster",url:"mapbox://stanronzhin.ddx873qu"}),a.current.addLayer({id:"Damaged land",source:"damagedLand",type:"raster",paint:{"raster-opacity":.8,"raster-fade-duration":500},layout:{visibility:"none"}}),a.current.addSource("green_areas",{type:"raster",url:"mapbox://stanronzhin.d77lnwg2"}),a.current.addLayer({id:"Green areas",type:"raster",paint:{"raster-opacity":.8,"raster-fade-duration":500},layout:{visibility:"none"},source:"green_areas"},"land-structure-line")}),a.current.on("idle",()=>{if(!a.current.getLayer("Build up")||!a.current.getLayer("Population 2D")||!a.current.getLayer("Population 3D x SO2")||!a.current.getLayer("Population 3D x NO2")||!a.current.getLayer("Population 3D x O3")||!a.current.getLayer("Population 3D x CO")||!a.current.getLayer("Population 3D x PM10")||!a.current.getLayer("SO2 2D")||!a.current.getLayer("NO2 2D")||!a.current.getLayer("O3 2D")||!a.current.getLayer("CO 2D")||!a.current.getLayer("PM10 2D")||!a.current.getLayer("Schools")||!a.current.getLayer("School service areas")||!a.current.getLayer("Transport stops")||!a.current.getLayer("Transport service areas")||!a.current.getLayer("Parks")||!a.current.getLayer("Parks service area")||!a.current.getLayer("Fresh water")||!a.current.getLayer("Damaged land")||!a.current.getLayer("Green areas")||!a.current.getLayer("urban cluster")||!a.current.getLayer("Population 3D"))return;const s=["Build up","Population 2D","Population 3D","Population 3D x SO2","Population 3D x NO2","Population 3D x O3","Population 3D x CO","Population 3D x PM10","SO2 2D","NO2 2D","O3 2D","CO 2D","PM10 2D","Schools","School service areas","Transport stops","Transport service areas","Parks","Parks service area","Fresh water","Damaged land","Green areas","urban cluster"];for(const l of s){if(document.getElementById(l))continue;const d=document.createElement("a");d.id=l,d.href="#",d.textContent=l,d.className="active",d.onclick=function(p){const y=this.textContent;p.preventDefault(),p.stopPropagation(),a.getLayoutProperty(y,"visibility")==="none"?(a.current.setLayoutProperty(y,"visibility","visible"),this.className=""):(this.className="active",a.current.setLayoutProperty(y,"visibility","none"))},document.getElementById("menu").appendChild(d)}}),n(a.current))},[]),U("div",{ref:i,style:{position:"absolute",top:0,left:0,width:"100%",height:"100%"}})},hCe=({children:n})=>U("div",{style:{position:"relative",height:"100%",width:"100%",backgroundColor:"#fff"},children:n}),fCe=({children:n})=>U("div",{style:{position:"absolute",left:"10vh",top:"15vh",zIndex:1},children:n}),pCe=wr()({title:{fontFamily:"SuisseIntl-Light",fontSize:"6.25vh",color:"#000"},subTitle:{fontFamily:"SuisseIntl-Light",fontSize:"2vh",color:"#000",maxWidth:"30vh",marginTop:"3vh"}}),mCe=wr()({root:{backgroundColor:"#fff",padding:"2vh 2vh",borderRadius:20,marginTop:"3vh",gap:"2vh",width:"245px"},columnWrapper:{position:"relative",display:"flex",gap:8,flexDirection:"column"},column:{display:"flex",flexDirection:"column",gap:"1vh"},populationWrapper:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between"}}),gCe=({label:n,isTitle:e,isActive:i,disabled:a,isMobile:s,onClick:l})=>{const[d,f]=ne.useState(!1);return U("button",{disabled:a,onClick:()=>{l&&l()},onMouseOut:()=>!e&&f(!1),onMouseOver:()=>!e&&!a&&f(!0),style:{cursor:d?"pointer":"default",fontFamily:d||i?"SuisseIntl-Regular":"SuisseIntl-Light",fontWeight:d||i?600:400,backgroundColor:"#fff",color:i?"#2D67FF":"#000",border:"none",textAlign:"left",opacity:a?.5:1,display:"inline-block",textWrap:"nowrap",width:s?n==="Population"?"100%":"40%":"fit-content"},children:U("div",{style:{pointerEvents:"all",position:"relative",fontSize:"1.8vh",width:"100%"},children:n})})},yCe={population:{label:"Population","2d":{mapboxId:"Population 2D",legendSvgUrl:"/legends/population2d.svg"},"3d":{mapboxId:"Population 3D"}},so2:{label:"SO2","2d":{mapboxId:"SO2 2D",legendSvgUrl:"/legends/so2.svg"},"3d":{mapboxId:"Population 3D x SO2",legendSvgUrl:"/legends/population3dxso2.svg"}},no2:{label:"NO2","2d":{mapboxId:"NO2 2D",legendSvgUrl:"/legends/no2.svg"},"3d":{mapboxId:"Population 3D x NO2",legendSvgUrl:"/legends/population3dxno2.svg"}},o3:{label:"O3","2d":{mapboxId:"O3 2D",legendSvgUrl:"/legends/o3.svg"},"3d":{mapboxId:"Population 3D x O3",legendSvgUrl:"/legends/population3dxo3.svg"}},co:{label:"CO","2d":{mapboxId:"CO 2D",legendSvgUrl:"/legends/co.svg"},"3d":{mapboxId:"Population 3D x CO",legendSvgUrl:"/legends/population3dxco.svg"}},pm10:{label:"PM10","2d":{mapboxId:"PM10 2D",legendSvgUrl:"/legends/pm10.svg"},"3d":{mapboxId:"Population 3D x PM10",legendSvgUrl:"/legends/population3dxpm10.svg"}},buildUp:{label:"Build up","2d":{mapboxId:"Build up",legendSvgUrl:"/legends/buildUp.svg"}},schools:{label:"Schools","2d":{mapboxId:"Schools"}},schoolsServiceAreas:{label:"School service areas","2d":{mapboxId:"School service areas",legendText:"The 1 kilometre service area is an area where at least one park can be reached in a distance of less than one kilometre."}},transportStops:{label:"Transport stops","2d":{mapboxId:"Transport stops"}},transportServiceAreas:{label:"Transport service areas","2d":{mapboxId:"Transport service areas",legendText:"The 1 kilometre service area is an area where at least one transport stop can be reached in a distance of less than one kilometre."}},parks:{label:"Parks","2d":{mapboxId:"Parks"}},parksServiceArea:{label:"Parks service area","2d":{mapboxId:"Parks service area",legendText:"The 1 kilometre service area is an area where at least one park can be reached in a distance of less than one kilometre."}},freshWater:{label:"Fresh water","2d":{mapboxId:"Fresh water"}},damagedLand:{label:"Damaged land","2d":{mapboxId:"Damaged land"}},greenAreas:{label:"Green areas","2d":{mapboxId:"Green areas"}}},vCe={population:{label:"Population","2d":{mapboxId:"Population 2D",legendSvgUrl:"/legends/population2dDarEsSalam.svg"},"3d":{mapboxId:"Population 3D"}},so2:{label:"SO2","2d":{mapboxId:"SO2 2D",legendSvgUrl:"/legends/so2DarEsSalam.svg"},"3d":{mapboxId:"Population 3D x SO2",legendSvgUrl:"/legends/population3dxso2DarEsSalam.svg"}},no2:{label:"NO2","2d":{mapboxId:"NO2 2D",legendSvgUrl:"/legends/no2DarEsSalam.svg"},"3d":{mapboxId:"Population 3D x NO2",legendSvgUrl:"/legends/population3dxno2DarEsSalam.svg"}},o3:{label:"O3","2d":{mapboxId:"O3 2D",legendSvgUrl:"/legends/o3DarEsSalam.svg"},"3d":{mapboxId:"Population 3D x O3",legendSvgUrl:"/legends/population3dxo3DarEsSalam.svg"}},co:{label:"CO","2d":{mapboxId:"CO 2D",legendSvgUrl:"/legends/coDarEsSalam.svg"},"3d":{mapboxId:"Population 3D x CO",legendSvgUrl:"/legends/population3dxcoDarEsSalam.svg"}},pm10:{label:"PM10","2d":{mapboxId:"PM10 2D",legendSvgUrl:"/legends/pm10DarEsSalam.svg"},"3d":{mapboxId:"Population 3D x PM10",legendSvgUrl:"/legends/population3dxpm10DarEsSalam.svg"}},buildUp:{label:"Build up","2d":{mapboxId:"Build up",legendSvgUrl:"/legends/buildupAreasDarEsSalaam.svg"}},schools:{label:"Schools","2d":{mapboxId:"Schools"}},schoolsServiceAreas:{label:"School service areas","2d":{mapboxId:"School service areas",legendText:"The 1 kilometre service area is an area where at least one park can be reached in a distance of less than one kilometre."}},transportStops:{label:"Transport stops","2d":{mapboxId:"Transport stops"}},transportServiceAreas:{label:"Transport service areas","2d":{mapboxId:"Transport service areas",legendText:"The 1 kilometre service area is an area where at least one transport stop can be reached in a distance of less than one kilometre."}},parks:{label:"Parks","2d":{mapboxId:"Parks"}},parksServiceArea:{label:"Parks service area","2d":{mapboxId:"Parks service area",legendText:"The 1 kilometre service area is an area where at least one park can be reached in a distance of less than one kilometre."}},freshWater:{label:"Fresh water","2d":{mapboxId:"Fresh water"}},damagedLand:{label:"Damaged land","2d":{mapboxId:"Damaged land"}},greenAreas:{label:"Green areas","2d":{mapboxId:"Green areas"}}},_Ce=n=>{switch(n){case"Dubai":return yCe;case"Dar es Salaam":return vCe;default:throw new Error(`Unknown city: ${n}`)}},p0=(n,e)=>{switch(e){case"2d":return n["2d"];case"3d":return n["3d"];default:throw new Error(`Unknown mode: ${e}`)}},RJ=({map:n,isMobile:e,setLegend:i})=>{const a=jo(),s=_Ce(a.City),{classes:l}=mCe(),[d,f]=ne.useState("2d"),[p,y]=ne.useState(),_=()=>{if(n)if(d==="3d"){if(f("2d"),!p)return;const P=p0(s[p],"3d");n.setLayoutProperty(P.mapboxId,"visibility","none");const L=p0(s[p],"2d");n.setLayoutProperty(L.mapboxId,"visibility","visible"),i(L.legendSvgUrl?L.legendSvgUrl:L.legendText?L.legendText:null)}else{if(f("3d"),!p)return;const P=p0(s[p],"2d");n.setLayoutProperty(P.mapboxId,"visibility","none");const L=p0(s[p],"3d");L?(n.setLayoutProperty(L.mapboxId,"visibility","visible"),i(L.legendSvgUrl?L.legendSvgUrl:L.legendText?L.legendText:null)):(i(null),y(void 0))}},b=P=>{if(!n)return;if(p){const k=p0(s[p],d);n.setLayoutProperty(k.mapboxId,"visibility","none")}const L=p0(s[P],d);n.setLayoutProperty(L.mapboxId,"visibility","visible"),y(P),i(L.legendSvgUrl?L.legendSvgUrl:L.legendText?L.legendText:null)},S={width:"100%",boxSizing:"border-box",height:"auto"},A={display:"flex",flexDirection:"row",flexWrap:"wrap",rowGap:"8px",textAlign:"left"};return U("div",{className:l.root,style:e?S:{},children:_e("div",{className:l.columnWrapper,style:e?A:{},children:[U("div",{style:{position:"absolute",top:-8,right:0,zIndex:1},children:U(gX,{checked:d==="3d",onClick:_})}),Object.entries(s).map(([P,L])=>U(gCe,{label:L.label,isActive:P===p,disabled:d==="3d"&&!L["3d"],isMobile:e,onClick:()=>{b(P)}},P))]})})},xCe=({map:n})=>_e("div",{style:{userSelect:"none",position:"relative",zIndex:2,height:"10.5vh",width:"4.7vh",display:"flex",flexDirection:"column",backgroundColor:"#fff",borderRadius:"50px",overflow:"hidden",padding:0,margin:0,pointerEvents:"all"},children:[U("div",{onClick:()=>{n&&n.zoomIn()},style:{userSelect:"none",cursor:"pointer",height:"50%",display:"flex",justifyContent:"center",alignItems:"center",backgroundColor:"#fff",borderRadius:"50px",overflow:"hidden",padding:0,margin:0},children:U("img",{style:{userSelect:"none"},src:"/assets/plusIcon.svg",width:"45%",alt:"zoom in"})}),U("div",{onClick:()=>{if(!n)return;n.getZoom()>10.5&&n.zoomOut()},style:{cursor:"pointer",height:"50%",display:"flex",justifyContent:"center",alignItems:"center",backgroundColor:"#fff",borderRadius:"50px",overflow:"hidden",padding:0,margin:0,userSelect:"none"},children:U("img",{src:"/assets/minusIcon.svg",width:"45%",alt:"zoom out"})})]}),LJ=({setMap:n,isMobile:e})=>{Id.accessToken="pk.eyJ1Ijoic3RhbnJvbnpoaW4iLCJhIjoiY2xvaGF3ZmFzMWdodDJxbjByeHMzanE2dCJ9.3uz_EG8N_d7isS1h5wV46w";const i=ne.useRef(null),a=ne.useRef(null);return ne.useEffect(()=>{a.current||!i.current||(a.current=new Id.Map({attributionControl:!1,container:i.current,style:"mapbox://styles/stanronzhin/cloycy6uc012f01qye3qz7lc4",center:[39.11395379366985,-6.795093628568665],zoom:e?9:9.8,bearing:0,pitch:63}),a.current.on("load",()=>{a.current.scrollZoom.disable(),a.current.addSource("build_up",{type:"raster",url:"mapbox://stanronzhin.dpou9n43"}),a.current.addLayer({id:"Build up",source:"build_up",type:"raster",paint:{"raster-opacity":.8,"raster-fade-duration":500},layout:{visibility:"none"}},"land-structure-line"),a.current.addSource("pop_raster",{type:"raster",url:"mapbox://stanronzhin.8brf2wm2"}),a.current.addLayer({id:"Population 2D",source:"pop_raster",type:"raster",paint:{"raster-opacity":1,"raster-fade-duration":500},layout:{visibility:"none"}},"land-structure-line"),a.current.addSource("pop_bars",{type:"vector",url:"mapbox://stanronzhin.2xkqu3zj"}),a.current.addLayer({id:"Population 3D",type:"fill-extrusion",source:"pop_bars","source-layer":"DarEsSalaam_Population_Bars_N-bf9acs",layout:{visibility:"none"},paint:{"fill-extrusion-height":["get","Population"],"fill-extrusion-vertical-scale":1,"fill-extrusion-color":["interpolate",["linear"],["get","Population"],1,"#fefefe",21877,"#828282"],"fill-extrusion-opacity":.9}},"expo-city-dubai-label"),a.current.addLayer({id:"Population 3D x SO2",type:"fill-extrusion",source:"pop_bars","source-layer":"DarEsSalaam_Population_Bars_N-bf9acs",layout:{visibility:"none"},paint:{"fill-extrusion-height":["get","Population"],"fill-extrusion-vertical-scale":1,"fill-extrusion-color":["interpolate",["linear"],["get","SO2_mean"],0,"#ffffff",1.35,"#570f6e",2.7,"#bb3755",4.05,"#f98d0a",5.358946323394775,"#fcffa4"],"fill-extrusion-opacity":.9}},"expo-city-dubai-label"),a.current.addLayer({id:"Population 3D x NO2",type:"fill-extrusion",source:"pop_bars","source-layer":"DarEsSalaam_Population_Bars_N-bf9acs",layout:{visibility:"none"},paint:{"fill-extrusion-height":["get","Population"],"fill-extrusion-vertical-scale":1,"fill-extrusion-color":["interpolate",["linear"],["get","NO2_mean"],2.05233907699585,"#440154",2.2,"#3b528b",2.4,"#21908d",2.6,"#5dc962",2.772989511489868,"#fde725"],"fill-extrusion-opacity":.9}},"expo-city-dubai-label"),a.current.addLayer({id:"Population 3D x O3",type:"fill-extrusion",source:"pop_bars","source-layer":"DarEsSalaam_Population_Bars_N-bf9acs",layout:{visibility:"none"},paint:{"fill-extrusion-height":["get","Population"],"fill-extrusion-vertical-scale":1,"fill-extrusion-color":["interpolate",["linear"],["get","O3_mean"],5762.0478515625,"#edf8fb",5771.03,"#b2e2e2",5780.02,"#66c2a4",5789.01,"#2ca25f",5797.997504716548,"#006d2c"],"fill-extrusion-opacity":.9}},"expo-city-dubai-label"),a.current.addLayer({id:"Population 3D x CO",type:"fill-extrusion",source:"pop_bars","source-layer":"DarEsSalaam_Population_Bars_N-bf9acs",layout:{visibility:"none"},paint:{"fill-extrusion-height":["get","Population"],"fill-extrusion-vertical-scale":1,"fill-extrusion-color":["interpolate",["linear"],["get","CO_mean"],802.5854707726206,"#f6eff7",821,"#bdc9e1",836,"#67a9cf",851.48,"#1c9099",867.7780797321312,"#016c59"],"fill-extrusion-opacity":.9}},"expo-city-dubai-label"),a.current.addLayer({id:"Population 3D x PM10",type:"fill-extrusion",source:"pop_bars","source-layer":"DarEsSalaam_Population_Bars_N-bf9acs",layout:{visibility:"none"},paint:{"fill-extrusion-height":["get","Population"],"fill-extrusion-vertical-scale":1,"fill-extrusion-color":["interpolate",["linear"],["get","PM10_mean"],-.560415429762831,"#ffffff",-.463,"#f0f0f0",-.365,"#7d7c78",-.268,"#beaf6f",-.170282865193472,"#ffea46"],"fill-extrusion-opacity":.9}},"expo-city-dubai-label"),a.current.addSource("SO2",{type:"raster",url:"mapbox://stanronzhin.8z6owmcr"}),a.current.addLayer({id:"SO2 2D",type:"raster",paint:{"raster-opacity":.8,"raster-fade-duration":500},layout:{visibility:"none"},source:"SO2"},"land-structure-line"),a.current.addSource("NO2",{type:"raster",url:"mapbox://stanronzhin.20jvy6c8"}),a.current.addLayer({id:"NO2 2D",type:"raster",paint:{"raster-opacity":.8,"raster-fade-duration":500},layout:{visibility:"none"},source:"NO2"},"land-structure-line"),a.current.addSource("O3",{type:"raster",url:"mapbox://stanronzhin.76qo6b2w"}),a.current.addLayer({id:"O3 2D",type:"raster",paint:{"raster-opacity":.8,"raster-fade-duration":500},layout:{visibility:"none"},source:"O3"},"land-structure-line"),a.current.addSource("CO",{type:"raster",url:"mapbox://stanronzhin.co2x6sdc"}),a.current.addLayer({id:"CO 2D",type:"raster",paint:{"raster-opacity":.8,"raster-fade-duration":500},layout:{visibility:"none"},source:"CO"},"land-structure-line"),a.current.addSource("PM10",{type:"raster",url:"mapbox://stanronzhin.couih9de"}),a.current.addLayer({id:"PM10 2D",type:"raster",paint:{"raster-opacity":.8,"raster-fade-duration":500},layout:{visibility:"none"},source:"PM10"},"land-structure-line"),a.current.addSource("schools",{type:"vector",url:"mapbox://stanronzhin.862v1tre"}),a.current.addLayer({id:"Schools",source:"schools","source-layer":"Schools_Dubai_DarEsSalaam_shp-2dp8hn",minzoom:0,maxzoom:22,type:"circle",layout:{visibility:"none"},paint:{"circle-color":"#00ff91","circle-radius":2,"circle-stroke-color":"#75ffd6","circle-stroke-width":1}}),a.current.addSource("sa_schools",{type:"vector",url:"mapbox://stanronzhin.db4zco7s"}),a.current.addLayer({id:"School service areas",source:"sa_schools","source-layer":"Schools_Service_Areas_Dubai_D-dcr4b6",minzoom:0,maxzoom:22,type:"fill",paint:{"fill-outline-color":"rgba(255, 255, 255, 0)","fill-color":"#00ffda","fill-opacity":.5},layout:{visibility:"none"}},"Schools"),a.current.addSource("transport_stops",{type:"vector",url:"mapbox://stanronzhin.baw4ssp1"}),a.current.addLayer({id:"Transport stops",source:"transport_stops","source-layer":"Transport_stops_Dubai_DarEsSa-2e5jzv",minzoom:0,maxzoom:22,type:"circle",layout:{visibility:"none"},paint:{"circle-color":"#ff00f6","circle-radius":2,"circle-stroke-color":"#ffffff","circle-stroke-width":1}}),a.current.addSource("sa_transport",{type:"vector",url:"mapbox://stanronzhin.ayut4ft2"}),a.current.addLayer({id:"Transport service areas",source:"sa_transport","source-layer":"Transport_Service_Areas_Dubai-8rypml",minzoom:0,maxzoom:22,type:"fill",paint:{"fill-outline-color":"rgba(255, 255, 255, 0)","fill-color":"#e684dc","fill-opacity":.5},layout:{visibility:"none"}}),a.current.addSource("parks",{type:"vector",url:"mapbox://stanronzhin.bberinf0"}),a.current.addLayer({id:"Parks",source:"parks","source-layer":"Parks_Dubai_DarEsSalaam_shp-4ar5jy",minzoom:0,maxzoom:22,type:"fill",paint:{"fill-color":"#00db63"},layout:{visibility:"none"}}),a.current.addSource("sa_parks",{type:"vector",url:"mapbox://stanronzhin.5g64w2gy"}),a.current.addLayer({id:"Parks service area",source:"sa_parks","source-layer":"Parks_Service_Areas_Dubai_Dar-3u1qpp",minzoom:0,maxzoom:22,type:"fill",paint:{"fill-color":"#00ddd0"},layout:{visibility:"none"}},"Parks"),a.current.addSource("water",{type:"raster",url:"mapbox://stanronzhin.2vtfxzn2"}),a.current.addLayer({id:"Fresh water",source:"water",type:"raster",paint:{"raster-opacity":.8,"raster-fade-duration":500},layout:{visibility:"none"}}),a.current.addSource("damagedLand",{type:"raster",url:"mapbox://stanronzhin.cxu2vccw"}),a.current.addLayer({id:"Damaged land",source:"damagedLand",type:"raster",paint:{"raster-opacity":.8,"raster-fade-duration":500},layout:{visibility:"none"}}),a.current.addSource("green_areas",{type:"raster",url:"mapbox://stanronzhin.8u6mbzcw"}),a.current.addLayer({id:"Green areas",type:"raster",paint:{"raster-opacity":.8,"raster-fade-duration":500},layout:{visibility:"none"},source:"green_areas"},"land-structure-line")}),a.current.on("idle",()=>{if(!a.current.getLayer("Build up")||!a.current.getLayer("Population 2D")||!a.current.getLayer("Population 3D x SO2")||!a.current.getLayer("Population 3D x NO2")||!a.current.getLayer("Population 3D x O3")||!a.current.getLayer("Population 3D x CO")||!a.current.getLayer("Population 3D x PM10")||!a.current.getLayer("SO2 2D")||!a.current.getLayer("NO2 2D")||!a.current.getLayer("O3 2D")||!a.current.getLayer("CO 2D")||!a.current.getLayer("PM10 2D")||!a.current.getLayer("Schools")||!a.current.getLayer("School service areas")||!a.current.getLayer("Transport stops")||!a.current.getLayer("Transport service areas")||!a.current.getLayer("Parks")||!a.current.getLayer("Parks service area")||!a.current.getLayer("Fresh water")||!a.current.getLayer("Damaged land")||!a.current.getLayer("Green areas")||!a.current.getLayer("Population 3D"))return;const s=["Build up","Population 2D","Population 3D","Population 3D x SO2","Population 3D x NO2","Population 3D x O3","Population 3D x CO","Population 3D x PM10","SO2 2D","NO2 2D","O3 2D","CO 2D","PM10 2D","Schools","School service areas","Transport stops","Transport service areas","Parks","Parks service area","Fresh water","Damaged land","Green areas"];for(const l of s){if(document.getElementById(l))continue;const d=document.createElement("a");d.id=l,d.href="#",d.textContent=l,d.className="active",d.onclick=function(p){const y=this.textContent;p.preventDefault(),p.stopPropagation(),a.current.getLayoutProperty(y,"visibility")==="none"?(a.current.setLayoutProperty(y,"visibility","visible"),this.className=""):(this.className="active",a.current.setLayoutProperty(y,"visibility","none"))},document.getElementById("menu").appendChild(d)}}),n(a.current))},[]),U("div",{ref:i,style:{position:"absolute",top:0,left:0,width:"100%",height:"100%"}})},bCe=()=>{const{classes:n}=pCe(),e=jo(),[i,a]=ne.useState(null),[s,l]=ne.useState(null),f=jo().City;return ne.useEffect(()=>{},[s]),_e(hCe,{children:[_e(fCe,{children:[_e("div",{className:n.title,children:[e==null?void 0:e.City,": Geoanalytics"]}),U("img",{src:"/legends/bordersLegend.svg",style:{marginTop:"3vh",width:"30vh"}}),U(RJ,{map:i,setLegend:l})]}),f==="Dubai"&&U(IJ,{setMap:a}),f==="Dar es Salaam"&&U(LJ,{setMap:a}),_e("div",{style:{position:"absolute",bottom:"5vh",right:"5vh",zIndex:1e3,display:"flex",flexDirection:"row",width:"fit-content",gap:"4vh",alignItems:"center"},children:[U(xCe,{map:i}),s&&s.includes("/")?U("img",{src:s}):s&&U("div",{style:{fontFamily:"SuisseIntl-Light",fontSize:"1.8vh",width:"10vw"},children:s})]})]})},wCe=wr()({backgroundWrapper:{position:"absolute",top:0,left:0,backgroundColor:"#0C1F68",width:"100vw",height:"100vh",overflowY:"scroll","&::-webkit-scrollbar":{width:"0em"},zIndex:"1200"},content:{position:"relative",width:"90%",margin:"12vh 5% 5vh",borderRadius:"3vh",overflow:"hidden"},blueSection:{position:"relative",display:"box",width:"100%",height:"100vh",float:"left",background:"#1433AE"},whiteSection:{position:"relative",display:"box",width:"100%",height:"100vh",float:"left",background:"#ffffff"},blackSection:{position:"relative",display:"box",width:"100%",height:"100vh",float:"left",background:"#000000"},returnBack:{position:"absolute",top:"4vh",left:"5%",display:"flex",flexDirection:"row",alignItems:"center",gap:"1vh",cursor:"pointer"},returnBackIcon:{height:"4vh"},returnBackText:{fontFamily:"SuisseIntl-Light",fontWeight:400,color:"#fff",textTransform:"none",fontSize:"1.8vh","&:hover":{backgroundColor:"inherit"}},title:{fontFamily:"SuisseIntl-Regular",fontWeight:400,lineHeight:"9vh",letterSpacing:"-0.2vh",fontSize:"8vh",color:"#fff",width:"100%"}}),SCe=wr()({wrapper:{display:"flex",flexDirection:"row",justifyContent:"space-between",width:"100%",padding:"4vh 8vh",boxSizing:"border-box"},titleWrapper:{width:"50%"},title:{fontFamily:"SuisseIntl-Regular",fontWeight:400,lineHeight:"9vh",letterSpacing:"-0.2vh",fontSize:"8vh",color:"#fff",width:"100%"},subTitle:{fontFamily:"SuisseIntl-Light",fontWeight:200,lineHeight:"9vh",letterSpacing:"-0.2vh",fontSize:"6vh",color:"#fff",width:"100%"},text:{fontFamily:"SuisseIntl-Light",fontWeight:400,lineHeight:"3vh",letterSpacing:"0vh",fontSize:"2vh",color:"#fff",width:"55%",paddingTop:"3vh"}}),ECe=({title:n,text:e})=>{const{classes:i}=SCe();return _e("div",{className:i.wrapper,children:[U("div",{className:i.titleWrapper,children:U(nn,{className:i.title,children:n})}),U(nn,{className:i.text,children:e})]})};/*!
 * @kurkle/color v0.3.2
 * https://github.com/kurkle/color#readme
 * (c) 2023 Jukka Kurkela
 * Released under the MIT License
 */function dS(n){return n+.5|0}const ap=(n,e,i)=>Math.max(Math.min(n,i),e);function Xx(n){return ap(dS(n*2.55),0,255)}function bp(n){return ap(dS(n*255),0,255)}function Ih(n){return ap(dS(n/2.55)/100,0,1)}function HG(n){return ap(dS(n*100),0,100)}const Ec={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},rD=[..."0123456789ABCDEF"],MCe=n=>rD[n&15],TCe=n=>rD[(n&240)>>4]+rD[n&15],CE=n=>(n&240)>>4===(n&15),ACe=n=>CE(n.r)&&CE(n.g)&&CE(n.b)&&CE(n.a);function CCe(n){var e=n.length,i;return n[0]==="#"&&(e===4||e===5?i={r:255&Ec[n[1]]*17,g:255&Ec[n[2]]*17,b:255&Ec[n[3]]*17,a:e===5?Ec[n[4]]*17:255}:(e===7||e===9)&&(i={r:Ec[n[1]]<<4|Ec[n[2]],g:Ec[n[3]]<<4|Ec[n[4]],b:Ec[n[5]]<<4|Ec[n[6]],a:e===9?Ec[n[7]]<<4|Ec[n[8]]:255})),i}const PCe=(n,e)=>n<255?e(n):"";function ICe(n){var e=ACe(n)?MCe:TCe;return n?"#"+e(n.r)+e(n.g)+e(n.b)+PCe(n.a,e):void 0}const RCe=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function kJ(n,e,i){const a=e*Math.min(i,1-i),s=(l,d=(l+n/30)%12)=>i-a*Math.max(Math.min(d-3,9-d,1),-1);return[s(0),s(8),s(4)]}function LCe(n,e,i){const a=(s,l=(s+n/60)%6)=>i-i*e*Math.max(Math.min(l,4-l,1),0);return[a(5),a(3),a(1)]}function kCe(n,e,i){const a=kJ(n,1,.5);let s;for(e+i>1&&(s=1/(e+i),e*=s,i*=s),s=0;s<3;s++)a[s]*=1-e-i,a[s]+=e;return a}function DCe(n,e,i,a,s){return n===s?(e-i)/a+(e<i?6:0):e===s?(i-n)/a+2:(n-e)/a+4}function rO(n){const i=n.r/255,a=n.g/255,s=n.b/255,l=Math.max(i,a,s),d=Math.min(i,a,s),f=(l+d)/2;let p,y,_;return l!==d&&(_=l-d,y=f>.5?_/(2-l-d):_/(l+d),p=DCe(i,a,s,_,l),p=p*60+.5),[p|0,y||0,f]}function aO(n,e,i,a){return(Array.isArray(e)?n(e[0],e[1],e[2]):n(e,i,a)).map(bp)}function oO(n,e,i){return aO(kJ,n,e,i)}function zCe(n,e,i){return aO(kCe,n,e,i)}function OCe(n,e,i){return aO(LCe,n,e,i)}function DJ(n){return(n%360+360)%360}function NCe(n){const e=RCe.exec(n);let i=255,a;if(!e)return;e[5]!==a&&(i=e[6]?Xx(+e[5]):bp(+e[5]));const s=DJ(+e[2]),l=+e[3]/100,d=+e[4]/100;return e[1]==="hwb"?a=zCe(s,l,d):e[1]==="hsv"?a=OCe(s,l,d):a=oO(s,l,d),{r:a[0],g:a[1],b:a[2],a:i}}function FCe(n,e){var i=rO(n);i[0]=DJ(i[0]+e),i=oO(i),n.r=i[0],n.g=i[1],n.b=i[2]}function BCe(n){if(!n)return;const e=rO(n),i=e[0],a=HG(e[1]),s=HG(e[2]);return n.a<255?`hsla(${i}, ${a}%, ${s}%, ${Ih(n.a)})`:`hsl(${i}, ${a}%, ${s}%)`}const jG={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},$G={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function UCe(){const n={},e=Object.keys($G),i=Object.keys(jG);let a,s,l,d,f;for(a=0;a<e.length;a++){for(d=f=e[a],s=0;s<i.length;s++)l=i[s],f=f.replace(l,jG[l]);l=parseInt($G[d],16),n[f]=[l>>16&255,l>>8&255,l&255]}return n}let PE;function WCe(n){PE||(PE=UCe(),PE.transparent=[0,0,0,0]);const e=PE[n.toLowerCase()];return e&&{r:e[0],g:e[1],b:e[2],a:e.length===4?e[3]:255}}const VCe=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function GCe(n){const e=VCe.exec(n);let i=255,a,s,l;if(e){if(e[7]!==a){const d=+e[7];i=e[8]?Xx(d):ap(d*255,0,255)}return a=+e[1],s=+e[3],l=+e[5],a=255&(e[2]?Xx(a):ap(a,0,255)),s=255&(e[4]?Xx(s):ap(s,0,255)),l=255&(e[6]?Xx(l):ap(l,0,255)),{r:a,g:s,b:l,a:i}}}function HCe(n){return n&&(n.a<255?`rgba(${n.r}, ${n.g}, ${n.b}, ${Ih(n.a)})`:`rgb(${n.r}, ${n.g}, ${n.b})`)}const OL=n=>n<=.0031308?n*12.92:Math.pow(n,1/2.4)*1.055-.055,m0=n=>n<=.04045?n/12.92:Math.pow((n+.055)/1.055,2.4);function jCe(n,e,i){const a=m0(Ih(n.r)),s=m0(Ih(n.g)),l=m0(Ih(n.b));return{r:bp(OL(a+i*(m0(Ih(e.r))-a))),g:bp(OL(s+i*(m0(Ih(e.g))-s))),b:bp(OL(l+i*(m0(Ih(e.b))-l))),a:n.a+i*(e.a-n.a)}}function IE(n,e,i){if(n){let a=rO(n);a[e]=Math.max(0,Math.min(a[e]+a[e]*i,e===0?360:1)),a=oO(a),n.r=a[0],n.g=a[1],n.b=a[2]}}function zJ(n,e){return n&&Object.assign(e||{},n)}function YG(n){var e={r:0,g:0,b:0,a:255};return Array.isArray(n)?n.length>=3&&(e={r:n[0],g:n[1],b:n[2],a:255},n.length>3&&(e.a=bp(n[3]))):(e=zJ(n,{r:0,g:0,b:0,a:1}),e.a=bp(e.a)),e}function $Ce(n){return n.charAt(0)==="r"?GCe(n):NCe(n)}class Pw{constructor(e){if(e instanceof Pw)return e;const i=typeof e;let a;i==="object"?a=YG(e):i==="string"&&(a=CCe(e)||WCe(e)||$Ce(e)),this._rgb=a,this._valid=!!a}get valid(){return this._valid}get rgb(){var e=zJ(this._rgb);return e&&(e.a=Ih(e.a)),e}set rgb(e){this._rgb=YG(e)}rgbString(){return this._valid?HCe(this._rgb):void 0}hexString(){return this._valid?ICe(this._rgb):void 0}hslString(){return this._valid?BCe(this._rgb):void 0}mix(e,i){if(e){const a=this.rgb,s=e.rgb;let l;const d=i===l?.5:i,f=2*d-1,p=a.a-s.a,y=((f*p===-1?f:(f+p)/(1+f*p))+1)/2;l=1-y,a.r=255&y*a.r+l*s.r+.5,a.g=255&y*a.g+l*s.g+.5,a.b=255&y*a.b+l*s.b+.5,a.a=d*a.a+(1-d)*s.a,this.rgb=a}return this}interpolate(e,i){return e&&(this._rgb=jCe(this._rgb,e._rgb,i)),this}clone(){return new Pw(this.rgb)}alpha(e){return this._rgb.a=bp(e),this}clearer(e){const i=this._rgb;return i.a*=1-e,this}greyscale(){const e=this._rgb,i=dS(e.r*.3+e.g*.59+e.b*.11);return e.r=e.g=e.b=i,this}opaquer(e){const i=this._rgb;return i.a*=1+e,this}negate(){const e=this._rgb;return e.r=255-e.r,e.g=255-e.g,e.b=255-e.b,this}lighten(e){return IE(this._rgb,2,e),this}darken(e){return IE(this._rgb,2,-e),this}saturate(e){return IE(this._rgb,1,e),this}desaturate(e){return IE(this._rgb,1,-e),this}rotate(e){return FCe(this._rgb,e),this}}/*!
 * Chart.js v4.4.0
 * https://www.chartjs.org
 * (c) 2023 Chart.js Contributors
 * Released under the MIT License
 */function Sh(){}const YCe=(()=>{let n=0;return()=>n++})();function mr(n){return n===null||typeof n>"u"}function ha(n){if(Array.isArray&&Array.isArray(n))return!0;const e=Object.prototype.toString.call(n);return e.slice(0,7)==="[object"&&e.slice(-6)==="Array]"}function ir(n){return n!==null&&Object.prototype.toString.call(n)==="[object Object]"}function Ka(n){return(typeof n=="number"||n instanceof Number)&&isFinite(+n)}function jl(n,e){return Ka(n)?n:e}function Ui(n,e){return typeof n>"u"?e:n}const qCe=(n,e)=>typeof n=="string"&&n.endsWith("%")?parseFloat(n)/100:+n/e,OJ=(n,e)=>typeof n=="string"&&n.endsWith("%")?parseFloat(n)/100*e:+n;function aa(n,e,i){if(n&&typeof n.call=="function")return n.apply(i,e)}function Gr(n,e,i,a){let s,l,d;if(ha(n))if(l=n.length,a)for(s=l-1;s>=0;s--)e.call(i,n[s],s);else for(s=0;s<l;s++)e.call(i,n[s],s);else if(ir(n))for(d=Object.keys(n),l=d.length,s=0;s<l;s++)e.call(i,n[d[s]],d[s])}function wT(n,e){let i,a,s,l;if(!n||!e||n.length!==e.length)return!1;for(i=0,a=n.length;i<a;++i)if(s=n[i],l=e[i],s.datasetIndex!==l.datasetIndex||s.index!==l.index)return!1;return!0}function ST(n){if(ha(n))return n.map(ST);if(ir(n)){const e=Object.create(null),i=Object.keys(n),a=i.length;let s=0;for(;s<a;++s)e[i[s]]=ST(n[i[s]]);return e}return n}function NJ(n){return["__proto__","prototype","constructor"].indexOf(n)===-1}function XCe(n,e,i,a){if(!NJ(n))return;const s=e[n],l=i[n];ir(s)&&ir(l)?Iw(s,l,a):e[n]=ST(l)}function Iw(n,e,i){const a=ha(e)?e:[e],s=a.length;if(!ir(n))return n;i=i||{};const l=i.merger||XCe;let d;for(let f=0;f<s;++f){if(d=a[f],!ir(d))continue;const p=Object.keys(d);for(let y=0,_=p.length;y<_;++y)l(p[y],n,d,i)}return n}function Ab(n,e){return Iw(n,e,{merger:ZCe})}function ZCe(n,e,i){if(!NJ(n))return;const a=e[n],s=i[n];ir(a)&&ir(s)?Ab(a,s):Object.prototype.hasOwnProperty.call(e,n)||(e[n]=ST(s))}const qG={"":n=>n,x:n=>n.x,y:n=>n.y};function KCe(n){const e=n.split("."),i=[];let a="";for(const s of e)a+=s,a.endsWith("\\")?a=a.slice(0,-1)+".":(i.push(a),a="");return i}function JCe(n){const e=KCe(n);return i=>{for(const a of e){if(a==="")break;i=i&&i[a]}return i}}function Ip(n,e){return(qG[e]||(qG[e]=JCe(e)))(n)}function sO(n){return n.charAt(0).toUpperCase()+n.slice(1)}const Rw=n=>typeof n<"u",Rp=n=>typeof n=="function",XG=(n,e)=>{if(n.size!==e.size)return!1;for(const i of n)if(!e.has(i))return!1;return!0};function QCe(n){return n.type==="mouseup"||n.type==="click"||n.type==="contextmenu"}const ma=Math.PI,pa=2*ma,ePe=pa+ma,ET=Number.POSITIVE_INFINITY,tPe=ma/180,ho=ma/2,Qm=ma/4,ZG=ma*2/3,op=Math.log10,Ed=Math.sign;function Cb(n,e,i){return Math.abs(n-e)<i}function KG(n){const e=Math.round(n);n=Cb(n,e,n/1e3)?e:n;const i=Math.pow(10,Math.floor(op(n))),a=n/i;return(a<=1?1:a<=2?2:a<=5?5:10)*i}function nPe(n){const e=[],i=Math.sqrt(n);let a;for(a=1;a<i;a++)n%a===0&&(e.push(a),e.push(n/a));return i===(i|0)&&e.push(i),e.sort((s,l)=>s-l).pop(),e}function S_(n){return!isNaN(parseFloat(n))&&isFinite(n)}function iPe(n,e){const i=Math.round(n);return i-e<=n&&i+e>=n}function FJ(n,e,i){let a,s,l;for(a=0,s=n.length;a<s;a++)l=n[a][i],isNaN(l)||(e.min=Math.min(e.min,l),e.max=Math.max(e.max,l))}function gu(n){return n*(ma/180)}function lO(n){return n*(180/ma)}function JG(n){if(!Ka(n))return;let e=1,i=0;for(;Math.round(n*e)/e!==n;)e*=10,i++;return i}function BJ(n,e){const i=e.x-n.x,a=e.y-n.y,s=Math.sqrt(i*i+a*a);let l=Math.atan2(a,i);return l<-.5*ma&&(l+=pa),{angle:l,distance:s}}function aD(n,e){return Math.sqrt(Math.pow(e.x-n.x,2)+Math.pow(e.y-n.y,2))}function rPe(n,e){return(n-e+ePe)%pa-ma}function Yl(n){return(n%pa+pa)%pa}function Lw(n,e,i,a){const s=Yl(n),l=Yl(e),d=Yl(i),f=Yl(l-s),p=Yl(d-s),y=Yl(s-l),_=Yl(s-d);return s===l||s===d||a&&l===d||f>p&&y<_}function Go(n,e,i){return Math.max(e,Math.min(i,n))}function aPe(n){return Go(n,-32768,32767)}function Nh(n,e,i,a=1e-6){return n>=Math.min(e,i)-a&&n<=Math.max(e,i)+a}function cO(n,e,i){i=i||(d=>n[d]<e);let a=n.length-1,s=0,l;for(;a-s>1;)l=s+a>>1,i(l)?s=l:a=l;return{lo:s,hi:a}}const Fh=(n,e,i,a)=>cO(n,i,a?s=>{const l=n[s][e];return l<i||l===i&&n[s+1][e]===i}:s=>n[s][e]<i),oPe=(n,e,i)=>cO(n,i,a=>n[a][e]>=i);function sPe(n,e,i){let a=0,s=n.length;for(;a<s&&n[a]<e;)a++;for(;s>a&&n[s-1]>i;)s--;return a>0||s<n.length?n.slice(a,s):n}const UJ=["push","pop","shift","splice","unshift"];function lPe(n,e){if(n._chartjs){n._chartjs.listeners.push(e);return}Object.defineProperty(n,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[e]}}),UJ.forEach(i=>{const a="_onData"+sO(i),s=n[i];Object.defineProperty(n,i,{configurable:!0,enumerable:!1,value(...l){const d=s.apply(this,l);return n._chartjs.listeners.forEach(f=>{typeof f[a]=="function"&&f[a](...l)}),d}})})}function QG(n,e){const i=n._chartjs;if(!i)return;const a=i.listeners,s=a.indexOf(e);s!==-1&&a.splice(s,1),!(a.length>0)&&(UJ.forEach(l=>{delete n[l]}),delete n._chartjs)}function WJ(n){const e=new Set(n);return e.size===n.length?n:Array.from(e)}const VJ=function(){return typeof window>"u"?function(n){return n()}:window.requestAnimationFrame}();function GJ(n,e){let i=[],a=!1;return function(...s){i=s,a||(a=!0,VJ.call(window,()=>{a=!1,n.apply(e,i)}))}}function cPe(n,e){let i;return function(...a){return e?(clearTimeout(i),i=setTimeout(n,e,a)):n.apply(this,a),e}}const uO=n=>n==="start"?"left":n==="end"?"right":"center",bs=(n,e,i)=>n==="start"?e:n==="end"?i:(e+i)/2,uPe=(n,e,i,a)=>n===(a?"left":"right")?i:n==="center"?(e+i)/2:e;function HJ(n,e,i){const a=e.length;let s=0,l=a;if(n._sorted){const{iScale:d,_parsed:f}=n,p=d.axis,{min:y,max:_,minDefined:b,maxDefined:S}=d.getUserBounds();b&&(s=Go(Math.min(Fh(f,p,y).lo,i?a:Fh(e,p,d.getPixelForValue(y)).lo),0,a-1)),S?l=Go(Math.max(Fh(f,d.axis,_,!0).hi+1,i?0:Fh(e,p,d.getPixelForValue(_),!0).hi+1),s,a)-s:l=a-s}return{start:s,count:l}}function jJ(n){const{xScale:e,yScale:i,_scaleRanges:a}=n,s={xmin:e.min,xmax:e.max,ymin:i.min,ymax:i.max};if(!a)return n._scaleRanges=s,!0;const l=a.xmin!==e.min||a.xmax!==e.max||a.ymin!==i.min||a.ymax!==i.max;return Object.assign(a,s),l}const RE=n=>n===0||n===1,eH=(n,e,i)=>-(Math.pow(2,10*(n-=1))*Math.sin((n-e)*pa/i)),tH=(n,e,i)=>Math.pow(2,-10*n)*Math.sin((n-e)*pa/i)+1,Pb={linear:n=>n,easeInQuad:n=>n*n,easeOutQuad:n=>-n*(n-2),easeInOutQuad:n=>(n/=.5)<1?.5*n*n:-.5*(--n*(n-2)-1),easeInCubic:n=>n*n*n,easeOutCubic:n=>(n-=1)*n*n+1,easeInOutCubic:n=>(n/=.5)<1?.5*n*n*n:.5*((n-=2)*n*n+2),easeInQuart:n=>n*n*n*n,easeOutQuart:n=>-((n-=1)*n*n*n-1),easeInOutQuart:n=>(n/=.5)<1?.5*n*n*n*n:-.5*((n-=2)*n*n*n-2),easeInQuint:n=>n*n*n*n*n,easeOutQuint:n=>(n-=1)*n*n*n*n+1,easeInOutQuint:n=>(n/=.5)<1?.5*n*n*n*n*n:.5*((n-=2)*n*n*n*n+2),easeInSine:n=>-Math.cos(n*ho)+1,easeOutSine:n=>Math.sin(n*ho),easeInOutSine:n=>-.5*(Math.cos(ma*n)-1),easeInExpo:n=>n===0?0:Math.pow(2,10*(n-1)),easeOutExpo:n=>n===1?1:-Math.pow(2,-10*n)+1,easeInOutExpo:n=>RE(n)?n:n<.5?.5*Math.pow(2,10*(n*2-1)):.5*(-Math.pow(2,-10*(n*2-1))+2),easeInCirc:n=>n>=1?n:-(Math.sqrt(1-n*n)-1),easeOutCirc:n=>Math.sqrt(1-(n-=1)*n),easeInOutCirc:n=>(n/=.5)<1?-.5*(Math.sqrt(1-n*n)-1):.5*(Math.sqrt(1-(n-=2)*n)+1),easeInElastic:n=>RE(n)?n:eH(n,.075,.3),easeOutElastic:n=>RE(n)?n:tH(n,.075,.3),easeInOutElastic(n){return RE(n)?n:n<.5?.5*eH(n*2,.1125,.45):.5+.5*tH(n*2-1,.1125,.45)},easeInBack(n){return n*n*((1.70158+1)*n-1.70158)},easeOutBack(n){return(n-=1)*n*((1.70158+1)*n+1.70158)+1},easeInOutBack(n){let e=1.70158;return(n/=.5)<1?.5*(n*n*(((e*=1.525)+1)*n-e)):.5*((n-=2)*n*(((e*=1.525)+1)*n+e)+2)},easeInBounce:n=>1-Pb.easeOutBounce(1-n),easeOutBounce(n){return n<1/2.75?7.5625*n*n:n<2/2.75?7.5625*(n-=1.5/2.75)*n+.75:n<2.5/2.75?7.5625*(n-=2.25/2.75)*n+.9375:7.5625*(n-=2.625/2.75)*n+.984375},easeInOutBounce:n=>n<.5?Pb.easeInBounce(n*2)*.5:Pb.easeOutBounce(n*2-1)*.5+.5};function dO(n){if(n&&typeof n=="object"){const e=n.toString();return e==="[object CanvasPattern]"||e==="[object CanvasGradient]"}return!1}function nH(n){return dO(n)?n:new Pw(n)}function NL(n){return dO(n)?n:new Pw(n).saturate(.5).darken(.1).hexString()}const dPe=["x","y","borderWidth","radius","tension"],hPe=["color","borderColor","backgroundColor"];function fPe(n){n.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),n.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:e=>e!=="onProgress"&&e!=="onComplete"&&e!=="fn"}),n.set("animations",{colors:{type:"color",properties:hPe},numbers:{type:"number",properties:dPe}}),n.describe("animations",{_fallback:"animation"}),n.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:e=>e|0}}}})}function pPe(n){n.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}const iH=new Map;function mPe(n,e){e=e||{};const i=n+JSON.stringify(e);let a=iH.get(i);return a||(a=new Intl.NumberFormat(n,e),iH.set(i,a)),a}function hS(n,e,i){return mPe(e,i).format(n)}const $J={values(n){return ha(n)?n:""+n},numeric(n,e,i){if(n===0)return"0";const a=this.chart.options.locale;let s,l=n;if(i.length>1){const y=Math.max(Math.abs(i[0].value),Math.abs(i[i.length-1].value));(y<1e-4||y>1e15)&&(s="scientific"),l=gPe(n,i)}const d=op(Math.abs(l)),f=isNaN(d)?1:Math.max(Math.min(-1*Math.floor(d),20),0),p={notation:s,minimumFractionDigits:f,maximumFractionDigits:f};return Object.assign(p,this.options.ticks.format),hS(n,a,p)},logarithmic(n,e,i){if(n===0)return"0";const a=i[e].significand||n/Math.pow(10,Math.floor(op(n)));return[1,2,3,5,10,15].includes(a)||e>.8*i.length?$J.numeric.call(this,n,e,i):""}};function gPe(n,e){let i=e.length>3?e[2].value-e[1].value:e[1].value-e[0].value;return Math.abs(i)>=1&&n!==Math.floor(n)&&(i=n-Math.floor(n)),i}var EC={formatters:$J};function yPe(n){n.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(e,i)=>i.lineWidth,tickColor:(e,i)=>i.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:EC.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),n.route("scale.ticks","color","","color"),n.route("scale.grid","color","","borderColor"),n.route("scale.border","color","","borderColor"),n.route("scale.title","color","","color"),n.describe("scale",{_fallback:!1,_scriptable:e=>!e.startsWith("before")&&!e.startsWith("after")&&e!=="callback"&&e!=="parser",_indexable:e=>e!=="borderDash"&&e!=="tickBorderDash"&&e!=="dash"}),n.describe("scales",{_fallback:"scale"}),n.describe("scale.ticks",{_scriptable:e=>e!=="backdropPadding"&&e!=="callback",_indexable:e=>e!=="backdropPadding"})}const Zg=Object.create(null),oD=Object.create(null);function Ib(n,e){if(!e)return n;const i=e.split(".");for(let a=0,s=i.length;a<s;++a){const l=i[a];n=n[l]||(n[l]=Object.create(null))}return n}function FL(n,e,i){return typeof e=="string"?Iw(Ib(n,e),i):Iw(Ib(n,""),e)}class vPe{constructor(e,i){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=a=>a.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(a,s)=>NL(s.backgroundColor),this.hoverBorderColor=(a,s)=>NL(s.borderColor),this.hoverColor=(a,s)=>NL(s.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(e),this.apply(i)}set(e,i){return FL(this,e,i)}get(e){return Ib(this,e)}describe(e,i){return FL(oD,e,i)}override(e,i){return FL(Zg,e,i)}route(e,i,a,s){const l=Ib(this,e),d=Ib(this,a),f="_"+i;Object.defineProperties(l,{[f]:{value:l[i],writable:!0},[i]:{enumerable:!0,get(){const p=this[f],y=d[s];return ir(p)?Object.assign({},y,p):Ui(p,y)},set(p){this[f]=p}}})}apply(e){e.forEach(i=>i(this))}}var Ja=new vPe({_scriptable:n=>!n.startsWith("on"),_indexable:n=>n!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[fPe,pPe,yPe]);function _Pe(n){return!n||mr(n.size)||mr(n.family)?null:(n.style?n.style+" ":"")+(n.weight?n.weight+" ":"")+n.size+"px "+n.family}function MT(n,e,i,a,s){let l=e[s];return l||(l=e[s]=n.measureText(s).width,i.push(s)),l>a&&(a=l),a}function xPe(n,e,i,a){a=a||{};let s=a.data=a.data||{},l=a.garbageCollect=a.garbageCollect||[];a.font!==e&&(s=a.data={},l=a.garbageCollect=[],a.font=e),n.save(),n.font=e;let d=0;const f=i.length;let p,y,_,b,S;for(p=0;p<f;p++)if(b=i[p],b!=null&&!ha(b))d=MT(n,s,l,d,b);else if(ha(b))for(y=0,_=b.length;y<_;y++)S=b[y],S!=null&&!ha(S)&&(d=MT(n,s,l,d,S));n.restore();const A=l.length/2;if(A>i.length){for(p=0;p<A;p++)delete s[l[p]];l.splice(0,A)}return d}function eg(n,e,i){const a=n.currentDevicePixelRatio,s=i!==0?Math.max(i/2,.5):0;return Math.round((e-s)*a)/a+s}function rH(n,e){e=e||n.getContext("2d"),e.save(),e.resetTransform(),e.clearRect(0,0,n.width,n.height),e.restore()}function sD(n,e,i,a){YJ(n,e,i,a,null)}function YJ(n,e,i,a,s){let l,d,f,p,y,_,b,S;const A=e.pointStyle,P=e.rotation,L=e.radius;let k=(P||0)*tPe;if(A&&typeof A=="object"&&(l=A.toString(),l==="[object HTMLImageElement]"||l==="[object HTMLCanvasElement]")){n.save(),n.translate(i,a),n.rotate(k),n.drawImage(A,-A.width/2,-A.height/2,A.width,A.height),n.restore();return}if(!(isNaN(L)||L<=0)){switch(n.beginPath(),A){default:s?n.ellipse(i,a,s/2,L,0,0,pa):n.arc(i,a,L,0,pa),n.closePath();break;case"triangle":_=s?s/2:L,n.moveTo(i+Math.sin(k)*_,a-Math.cos(k)*L),k+=ZG,n.lineTo(i+Math.sin(k)*_,a-Math.cos(k)*L),k+=ZG,n.lineTo(i+Math.sin(k)*_,a-Math.cos(k)*L),n.closePath();break;case"rectRounded":y=L*.516,p=L-y,d=Math.cos(k+Qm)*p,b=Math.cos(k+Qm)*(s?s/2-y:p),f=Math.sin(k+Qm)*p,S=Math.sin(k+Qm)*(s?s/2-y:p),n.arc(i-b,a-f,y,k-ma,k-ho),n.arc(i+S,a-d,y,k-ho,k),n.arc(i+b,a+f,y,k,k+ho),n.arc(i-S,a+d,y,k+ho,k+ma),n.closePath();break;case"rect":if(!P){p=Math.SQRT1_2*L,_=s?s/2:p,n.rect(i-_,a-p,2*_,2*p);break}k+=Qm;case"rectRot":b=Math.cos(k)*(s?s/2:L),d=Math.cos(k)*L,f=Math.sin(k)*L,S=Math.sin(k)*(s?s/2:L),n.moveTo(i-b,a-f),n.lineTo(i+S,a-d),n.lineTo(i+b,a+f),n.lineTo(i-S,a+d),n.closePath();break;case"crossRot":k+=Qm;case"cross":b=Math.cos(k)*(s?s/2:L),d=Math.cos(k)*L,f=Math.sin(k)*L,S=Math.sin(k)*(s?s/2:L),n.moveTo(i-b,a-f),n.lineTo(i+b,a+f),n.moveTo(i+S,a-d),n.lineTo(i-S,a+d);break;case"star":b=Math.cos(k)*(s?s/2:L),d=Math.cos(k)*L,f=Math.sin(k)*L,S=Math.sin(k)*(s?s/2:L),n.moveTo(i-b,a-f),n.lineTo(i+b,a+f),n.moveTo(i+S,a-d),n.lineTo(i-S,a+d),k+=Qm,b=Math.cos(k)*(s?s/2:L),d=Math.cos(k)*L,f=Math.sin(k)*L,S=Math.sin(k)*(s?s/2:L),n.moveTo(i-b,a-f),n.lineTo(i+b,a+f),n.moveTo(i+S,a-d),n.lineTo(i-S,a+d);break;case"line":d=s?s/2:Math.cos(k)*L,f=Math.sin(k)*L,n.moveTo(i-d,a-f),n.lineTo(i+d,a+f);break;case"dash":n.moveTo(i,a),n.lineTo(i+Math.cos(k)*(s?s/2:L),a+Math.sin(k)*L);break;case!1:n.closePath();break}n.fill(),e.borderWidth>0&&n.stroke()}}function Bh(n,e,i){return i=i||.5,!e||n&&n.x>e.left-i&&n.x<e.right+i&&n.y>e.top-i&&n.y<e.bottom+i}function MC(n,e){n.save(),n.beginPath(),n.rect(e.left,e.top,e.right-e.left,e.bottom-e.top),n.clip()}function TC(n){n.restore()}function bPe(n,e,i,a,s){if(!e)return n.lineTo(i.x,i.y);if(s==="middle"){const l=(e.x+i.x)/2;n.lineTo(l,e.y),n.lineTo(l,i.y)}else s==="after"!=!!a?n.lineTo(e.x,i.y):n.lineTo(i.x,e.y);n.lineTo(i.x,i.y)}function wPe(n,e,i,a){if(!e)return n.lineTo(i.x,i.y);n.bezierCurveTo(a?e.cp1x:e.cp2x,a?e.cp1y:e.cp2y,a?i.cp2x:i.cp1x,a?i.cp2y:i.cp1y,i.x,i.y)}function SPe(n,e){e.translation&&n.translate(e.translation[0],e.translation[1]),mr(e.rotation)||n.rotate(e.rotation),e.color&&(n.fillStyle=e.color),e.textAlign&&(n.textAlign=e.textAlign),e.textBaseline&&(n.textBaseline=e.textBaseline)}function EPe(n,e,i,a,s){if(s.strikethrough||s.underline){const l=n.measureText(a),d=e-l.actualBoundingBoxLeft,f=e+l.actualBoundingBoxRight,p=i-l.actualBoundingBoxAscent,y=i+l.actualBoundingBoxDescent,_=s.strikethrough?(p+y)/2:y;n.strokeStyle=n.fillStyle,n.beginPath(),n.lineWidth=s.decorationWidth||2,n.moveTo(d,_),n.lineTo(f,_),n.stroke()}}function MPe(n,e){const i=n.fillStyle;n.fillStyle=e.color,n.fillRect(e.left,e.top,e.width,e.height),n.fillStyle=i}function Kg(n,e,i,a,s,l={}){const d=ha(e)?e:[e],f=l.strokeWidth>0&&l.strokeColor!=="";let p,y;for(n.save(),n.font=s.string,SPe(n,l),p=0;p<d.length;++p)y=d[p],l.backdrop&&MPe(n,l.backdrop),f&&(l.strokeColor&&(n.strokeStyle=l.strokeColor),mr(l.strokeWidth)||(n.lineWidth=l.strokeWidth),n.strokeText(y,i,a,l.maxWidth)),n.fillText(y,i,a,l.maxWidth),EPe(n,i,a,y,l),a+=Number(s.lineHeight);n.restore()}function kw(n,e){const{x:i,y:a,w:s,h:l,radius:d}=e;n.arc(i+d.topLeft,a+d.topLeft,d.topLeft,1.5*ma,ma,!0),n.lineTo(i,a+l-d.bottomLeft),n.arc(i+d.bottomLeft,a+l-d.bottomLeft,d.bottomLeft,ma,ho,!0),n.lineTo(i+s-d.bottomRight,a+l),n.arc(i+s-d.bottomRight,a+l-d.bottomRight,d.bottomRight,ho,0,!0),n.lineTo(i+s,a+d.topRight),n.arc(i+s-d.topRight,a+d.topRight,d.topRight,0,-ho,!0),n.lineTo(i+d.topLeft,a)}const TPe=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,APe=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function CPe(n,e){const i=(""+n).match(TPe);if(!i||i[1]==="normal")return e*1.2;switch(n=+i[2],i[3]){case"px":return n;case"%":n/=100;break}return e*n}const PPe=n=>+n||0;function hO(n,e){const i={},a=ir(e),s=a?Object.keys(e):e,l=ir(n)?a?d=>Ui(n[d],n[e[d]]):d=>n[d]:()=>n;for(const d of s)i[d]=PPe(l(d));return i}function qJ(n){return hO(n,{top:"y",right:"x",bottom:"y",left:"x"})}function Dg(n){return hO(n,["topLeft","topRight","bottomLeft","bottomRight"])}function Ps(n){const e=qJ(n);return e.width=e.left+e.right,e.height=e.top+e.bottom,e}function zo(n,e){n=n||{},e=e||Ja.font;let i=Ui(n.size,e.size);typeof i=="string"&&(i=parseInt(i,10));let a=Ui(n.style,e.style);a&&!(""+a).match(APe)&&(console.warn('Invalid font style specified: "'+a+'"'),a=void 0);const s={family:Ui(n.family,e.family),lineHeight:CPe(Ui(n.lineHeight,e.lineHeight),i),size:i,style:a,weight:Ui(n.weight,e.weight),string:""};return s.string=_Pe(s),s}function Zx(n,e,i,a){let s=!0,l,d,f;for(l=0,d=n.length;l<d;++l)if(f=n[l],f!==void 0&&(e!==void 0&&typeof f=="function"&&(f=f(e),s=!1),i!==void 0&&ha(f)&&(f=f[i%f.length],s=!1),f!==void 0))return a&&!s&&(a.cacheable=!1),f}function IPe(n,e,i){const{min:a,max:s}=n,l=OJ(e,(s-a)/2),d=(f,p)=>i&&f===0?0:f+p;return{min:d(a,-Math.abs(l)),max:d(s,l)}}function Wp(n,e){return Object.assign(Object.create(n),e)}function fO(n,e=[""],i,a,s=()=>n[0]){const l=i||n;typeof a>"u"&&(a=JJ("_fallback",n));const d={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:n,_rootScopes:l,_fallback:a,_getTarget:s,override:f=>fO([f,...n],e,l,a)};return new Proxy(d,{deleteProperty(f,p){return delete f[p],delete f._keys,delete n[0][p],!0},get(f,p){return ZJ(f,p,()=>FPe(p,e,n,f))},getOwnPropertyDescriptor(f,p){return Reflect.getOwnPropertyDescriptor(f._scopes[0],p)},getPrototypeOf(){return Reflect.getPrototypeOf(n[0])},has(f,p){return oH(f).includes(p)},ownKeys(f){return oH(f)},set(f,p,y){const _=f._storage||(f._storage=s());return f[p]=_[p]=y,delete f._keys,!0}})}function E_(n,e,i,a){const s={_cacheable:!1,_proxy:n,_context:e,_subProxy:i,_stack:new Set,_descriptors:XJ(n,a),setContext:l=>E_(n,l,i,a),override:l=>E_(n.override(l),e,i,a)};return new Proxy(s,{deleteProperty(l,d){return delete l[d],delete n[d],!0},get(l,d,f){return ZJ(l,d,()=>LPe(l,d,f))},getOwnPropertyDescriptor(l,d){return l._descriptors.allKeys?Reflect.has(n,d)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(n,d)},getPrototypeOf(){return Reflect.getPrototypeOf(n)},has(l,d){return Reflect.has(n,d)},ownKeys(){return Reflect.ownKeys(n)},set(l,d,f){return n[d]=f,delete l[d],!0}})}function XJ(n,e={scriptable:!0,indexable:!0}){const{_scriptable:i=e.scriptable,_indexable:a=e.indexable,_allKeys:s=e.allKeys}=n;return{allKeys:s,scriptable:i,indexable:a,isScriptable:Rp(i)?i:()=>i,isIndexable:Rp(a)?a:()=>a}}const RPe=(n,e)=>n?n+sO(e):e,pO=(n,e)=>ir(e)&&n!=="adapters"&&(Object.getPrototypeOf(e)===null||e.constructor===Object);function ZJ(n,e,i){if(Object.prototype.hasOwnProperty.call(n,e))return n[e];const a=i();return n[e]=a,a}function LPe(n,e,i){const{_proxy:a,_context:s,_subProxy:l,_descriptors:d}=n;let f=a[e];return Rp(f)&&d.isScriptable(e)&&(f=kPe(e,f,n,i)),ha(f)&&f.length&&(f=DPe(e,f,n,d.isIndexable)),pO(e,f)&&(f=E_(f,s,l&&l[e],d)),f}function kPe(n,e,i,a){const{_proxy:s,_context:l,_subProxy:d,_stack:f}=i;if(f.has(n))throw new Error("Recursion detected: "+Array.from(f).join("->")+"->"+n);f.add(n);let p=e(l,d||a);return f.delete(n),pO(n,p)&&(p=mO(s._scopes,s,n,p)),p}function DPe(n,e,i,a){const{_proxy:s,_context:l,_subProxy:d,_descriptors:f}=i;if(typeof l.index<"u"&&a(n))return e[l.index%e.length];if(ir(e[0])){const p=e,y=s._scopes.filter(_=>_!==p);e=[];for(const _ of p){const b=mO(y,s,n,_);e.push(E_(b,l,d&&d[n],f))}}return e}function KJ(n,e,i){return Rp(n)?n(e,i):n}const zPe=(n,e)=>n===!0?e:typeof n=="string"?Ip(e,n):void 0;function OPe(n,e,i,a,s){for(const l of e){const d=zPe(i,l);if(d){n.add(d);const f=KJ(d._fallback,i,s);if(typeof f<"u"&&f!==i&&f!==a)return f}else if(d===!1&&typeof a<"u"&&i!==a)return null}return!1}function mO(n,e,i,a){const s=e._rootScopes,l=KJ(e._fallback,i,a),d=[...n,...s],f=new Set;f.add(a);let p=aH(f,d,i,l||i,a);return p===null||typeof l<"u"&&l!==i&&(p=aH(f,d,l,p,a),p===null)?!1:fO(Array.from(f),[""],s,l,()=>NPe(e,i,a))}function aH(n,e,i,a,s){for(;i;)i=OPe(n,e,i,a,s);return i}function NPe(n,e,i){const a=n._getTarget();e in a||(a[e]={});const s=a[e];return ha(s)&&ir(i)?i:s||{}}function FPe(n,e,i,a){let s;for(const l of e)if(s=JJ(RPe(l,n),i),typeof s<"u")return pO(n,s)?mO(i,a,n,s):s}function JJ(n,e){for(const i of e){if(!i)continue;const a=i[n];if(typeof a<"u")return a}}function oH(n){let e=n._keys;return e||(e=n._keys=BPe(n._scopes)),e}function BPe(n){const e=new Set;for(const i of n)for(const a of Object.keys(i).filter(s=>!s.startsWith("_")))e.add(a);return Array.from(e)}function QJ(n,e,i,a){const{iScale:s}=n,{key:l="r"}=this._parsing,d=new Array(a);let f,p,y,_;for(f=0,p=a;f<p;++f)y=f+i,_=e[y],d[f]={r:s.parse(Ip(_,l),y)};return d}const UPe=Number.EPSILON||1e-14,M_=(n,e)=>e<n.length&&!n[e].skip&&n[e],eQ=n=>n==="x"?"y":"x";function WPe(n,e,i,a){const s=n.skip?e:n,l=e,d=i.skip?e:i,f=aD(l,s),p=aD(d,l);let y=f/(f+p),_=p/(f+p);y=isNaN(y)?0:y,_=isNaN(_)?0:_;const b=a*y,S=a*_;return{previous:{x:l.x-b*(d.x-s.x),y:l.y-b*(d.y-s.y)},next:{x:l.x+S*(d.x-s.x),y:l.y+S*(d.y-s.y)}}}function VPe(n,e,i){const a=n.length;let s,l,d,f,p,y=M_(n,0);for(let _=0;_<a-1;++_)if(p=y,y=M_(n,_+1),!(!p||!y)){if(Cb(e[_],0,UPe)){i[_]=i[_+1]=0;continue}s=i[_]/e[_],l=i[_+1]/e[_],f=Math.pow(s,2)+Math.pow(l,2),!(f<=9)&&(d=3/Math.sqrt(f),i[_]=s*d*e[_],i[_+1]=l*d*e[_])}}function GPe(n,e,i="x"){const a=eQ(i),s=n.length;let l,d,f,p=M_(n,0);for(let y=0;y<s;++y){if(d=f,f=p,p=M_(n,y+1),!f)continue;const _=f[i],b=f[a];d&&(l=(_-d[i])/3,f[`cp1${i}`]=_-l,f[`cp1${a}`]=b-l*e[y]),p&&(l=(p[i]-_)/3,f[`cp2${i}`]=_+l,f[`cp2${a}`]=b+l*e[y])}}function HPe(n,e="x"){const i=eQ(e),a=n.length,s=Array(a).fill(0),l=Array(a);let d,f,p,y=M_(n,0);for(d=0;d<a;++d)if(f=p,p=y,y=M_(n,d+1),!!p){if(y){const _=y[e]-p[e];s[d]=_!==0?(y[i]-p[i])/_:0}l[d]=f?y?Ed(s[d-1])!==Ed(s[d])?0:(s[d-1]+s[d])/2:s[d-1]:s[d]}VPe(n,s,l),GPe(n,l,e)}function LE(n,e,i){return Math.max(Math.min(n,i),e)}function jPe(n,e){let i,a,s,l,d,f=Bh(n[0],e);for(i=0,a=n.length;i<a;++i)d=l,l=f,f=i<a-1&&Bh(n[i+1],e),l&&(s=n[i],d&&(s.cp1x=LE(s.cp1x,e.left,e.right),s.cp1y=LE(s.cp1y,e.top,e.bottom)),f&&(s.cp2x=LE(s.cp2x,e.left,e.right),s.cp2y=LE(s.cp2y,e.top,e.bottom)))}function $Pe(n,e,i,a,s){let l,d,f,p;if(e.spanGaps&&(n=n.filter(y=>!y.skip)),e.cubicInterpolationMode==="monotone")HPe(n,s);else{let y=a?n[n.length-1]:n[0];for(l=0,d=n.length;l<d;++l)f=n[l],p=WPe(y,f,n[Math.min(l+1,d-(a?0:1))%d],e.tension),f.cp1x=p.previous.x,f.cp1y=p.previous.y,f.cp2x=p.next.x,f.cp2y=p.next.y,y=f}e.capBezierPoints&&jPe(n,i)}function tQ(){return typeof window<"u"&&typeof document<"u"}function gO(n){let e=n.parentNode;return e&&e.toString()==="[object ShadowRoot]"&&(e=e.host),e}function TT(n,e,i){let a;return typeof n=="string"?(a=parseInt(n,10),n.indexOf("%")!==-1&&(a=a/100*e.parentNode[i])):a=n,a}const AC=n=>n.ownerDocument.defaultView.getComputedStyle(n,null);function YPe(n,e){return AC(n).getPropertyValue(e)}const qPe=["top","right","bottom","left"];function zg(n,e,i){const a={};i=i?"-"+i:"";for(let s=0;s<4;s++){const l=qPe[s];a[l]=parseFloat(n[e+"-"+l+i])||0}return a.width=a.left+a.right,a.height=a.top+a.bottom,a}const XPe=(n,e,i)=>(n>0||e>0)&&(!i||!i.shadowRoot);function ZPe(n,e){const i=n.touches,a=i&&i.length?i[0]:n,{offsetX:s,offsetY:l}=a;let d=!1,f,p;if(XPe(s,l,n.target))f=s,p=l;else{const y=e.getBoundingClientRect();f=a.clientX-y.left,p=a.clientY-y.top,d=!0}return{x:f,y:p,box:d}}function dg(n,e){if("native"in n)return n;const{canvas:i,currentDevicePixelRatio:a}=e,s=AC(i),l=s.boxSizing==="border-box",d=zg(s,"padding"),f=zg(s,"border","width"),{x:p,y,box:_}=ZPe(n,i),b=d.left+(_&&f.left),S=d.top+(_&&f.top);let{width:A,height:P}=e;return l&&(A-=d.width+f.width,P-=d.height+f.height),{x:Math.round((p-b)/A*i.width/a),y:Math.round((y-S)/P*i.height/a)}}function KPe(n,e,i){let a,s;if(e===void 0||i===void 0){const l=gO(n);if(!l)e=n.clientWidth,i=n.clientHeight;else{const d=l.getBoundingClientRect(),f=AC(l),p=zg(f,"border","width"),y=zg(f,"padding");e=d.width-y.width-p.width,i=d.height-y.height-p.height,a=TT(f.maxWidth,l,"clientWidth"),s=TT(f.maxHeight,l,"clientHeight")}}return{width:e,height:i,maxWidth:a||ET,maxHeight:s||ET}}const kE=n=>Math.round(n*10)/10;function JPe(n,e,i,a){const s=AC(n),l=zg(s,"margin"),d=TT(s.maxWidth,n,"clientWidth")||ET,f=TT(s.maxHeight,n,"clientHeight")||ET,p=KPe(n,e,i);let{width:y,height:_}=p;if(s.boxSizing==="content-box"){const S=zg(s,"border","width"),A=zg(s,"padding");y-=A.width+S.width,_-=A.height+S.height}return y=Math.max(0,y-l.width),_=Math.max(0,a?y/a:_-l.height),y=kE(Math.min(y,d,p.maxWidth)),_=kE(Math.min(_,f,p.maxHeight)),y&&!_&&(_=kE(y/2)),(e!==void 0||i!==void 0)&&a&&p.height&&_>p.height&&(_=p.height,y=kE(Math.floor(_*a))),{width:y,height:_}}function sH(n,e,i){const a=e||1,s=Math.floor(n.height*a),l=Math.floor(n.width*a);n.height=Math.floor(n.height),n.width=Math.floor(n.width);const d=n.canvas;return d.style&&(i||!d.style.height&&!d.style.width)&&(d.style.height=`${n.height}px`,d.style.width=`${n.width}px`),n.currentDevicePixelRatio!==a||d.height!==s||d.width!==l?(n.currentDevicePixelRatio=a,d.height=s,d.width=l,n.ctx.setTransform(a,0,0,a,0,0),!0):!1}const QPe=function(){let n=!1;try{const e={get passive(){return n=!0,!1}};window.addEventListener("test",null,e),window.removeEventListener("test",null,e)}catch{}return n}();function lH(n,e){const i=YPe(n,e),a=i&&i.match(/^(\d+)(\.\d+)?px$/);return a?+a[1]:void 0}function hg(n,e,i,a){return{x:n.x+i*(e.x-n.x),y:n.y+i*(e.y-n.y)}}function eIe(n,e,i,a){return{x:n.x+i*(e.x-n.x),y:a==="middle"?i<.5?n.y:e.y:a==="after"?i<1?n.y:e.y:i>0?e.y:n.y}}function tIe(n,e,i,a){const s={x:n.cp2x,y:n.cp2y},l={x:e.cp1x,y:e.cp1y},d=hg(n,s,i),f=hg(s,l,i),p=hg(l,e,i),y=hg(d,f,i),_=hg(f,p,i);return hg(y,_,i)}const nIe=function(n,e){return{x(i){return n+n+e-i},setWidth(i){e=i},textAlign(i){return i==="center"?i:i==="right"?"left":"right"},xPlus(i,a){return i-a},leftForLtr(i,a){return i-a}}},iIe=function(){return{x(n){return n},setWidth(n){},textAlign(n){return n},xPlus(n,e){return n+e},leftForLtr(n,e){return n}}};function Q0(n,e,i){return n?nIe(e,i):iIe()}function nQ(n,e){let i,a;(e==="ltr"||e==="rtl")&&(i=n.canvas.style,a=[i.getPropertyValue("direction"),i.getPropertyPriority("direction")],i.setProperty("direction",e,"important"),n.prevTextDirection=a)}function iQ(n,e){e!==void 0&&(delete n.prevTextDirection,n.canvas.style.setProperty("direction",e[0],e[1]))}function rQ(n){return n==="angle"?{between:Lw,compare:rPe,normalize:Yl}:{between:Nh,compare:(e,i)=>e-i,normalize:e=>e}}function cH({start:n,end:e,count:i,loop:a,style:s}){return{start:n%i,end:e%i,loop:a&&(e-n+1)%i===0,style:s}}function rIe(n,e,i){const{property:a,start:s,end:l}=i,{between:d,normalize:f}=rQ(a),p=e.length;let{start:y,end:_,loop:b}=n,S,A;if(b){for(y+=p,_+=p,S=0,A=p;S<A&&d(f(e[y%p][a]),s,l);++S)y--,_--;y%=p,_%=p}return _<y&&(_+=p),{start:y,end:_,loop:b,style:n.style}}function aQ(n,e,i){if(!i)return[n];const{property:a,start:s,end:l}=i,d=e.length,{compare:f,between:p,normalize:y}=rQ(a),{start:_,end:b,loop:S,style:A}=rIe(n,e,i),P=[];let L=!1,k=null,R,z,O;const F=()=>p(s,O,R)&&f(s,O)!==0,H=()=>f(l,R)===0||p(l,O,R),$=()=>L||F(),Y=()=>!L||H();for(let te=_,G=_;te<=b;++te)z=e[te%d],!z.skip&&(R=y(z[a]),R!==O&&(L=p(R,s,l),k===null&&$()&&(k=f(R,s)===0?te:G),k!==null&&Y()&&(P.push(cH({start:k,end:te,loop:S,count:d,style:A})),k=null),G=te,O=R));return k!==null&&P.push(cH({start:k,end:b,loop:S,count:d,style:A})),P}function oQ(n,e){const i=[],a=n.segments;for(let s=0;s<a.length;s++){const l=aQ(a[s],n.points,e);l.length&&i.push(...l)}return i}function aIe(n,e,i,a){let s=0,l=e-1;if(i&&!a)for(;s<e&&!n[s].skip;)s++;for(;s<e&&n[s].skip;)s++;for(s%=e,i&&(l+=s);l>s&&n[l%e].skip;)l--;return l%=e,{start:s,end:l}}function oIe(n,e,i,a){const s=n.length,l=[];let d=e,f=n[e],p;for(p=e+1;p<=i;++p){const y=n[p%s];y.skip||y.stop?f.skip||(a=!1,l.push({start:e%s,end:(p-1)%s,loop:a}),e=d=y.stop?p:null):(d=p,f.skip&&(e=p)),f=y}return d!==null&&l.push({start:e%s,end:d%s,loop:a}),l}function sIe(n,e){const i=n.points,a=n.options.spanGaps,s=i.length;if(!s)return[];const l=!!n._loop,{start:d,end:f}=aIe(i,s,l,a);if(a===!0)return uH(n,[{start:d,end:f,loop:l}],i,e);const p=f<d?f+s:f,y=!!n._fullLoop&&d===0&&f===s-1;return uH(n,oIe(i,d,p,y),i,e)}function uH(n,e,i,a){return!a||!a.setContext||!i?e:lIe(n,e,i,a)}function lIe(n,e,i,a){const s=n._chart.getContext(),l=dH(n.options),{_datasetIndex:d,options:{spanGaps:f}}=n,p=i.length,y=[];let _=l,b=e[0].start,S=b;function A(P,L,k,R){const z=f?-1:1;if(P!==L){for(P+=p;i[P%p].skip;)P-=z;for(;i[L%p].skip;)L+=z;P%p!==L%p&&(y.push({start:P%p,end:L%p,loop:k,style:R}),_=R,b=L%p)}}for(const P of e){b=f?b:P.start;let L=i[b%p],k;for(S=b+1;S<=P.end;S++){const R=i[S%p];k=dH(a.setContext(Wp(s,{type:"segment",p0:L,p1:R,p0DataIndex:(S-1)%p,p1DataIndex:S%p,datasetIndex:d}))),cIe(k,_)&&A(b,S-1,P.loop,_),L=R,_=k}b<S-1&&A(b,S-1,P.loop,_)}return y}function dH(n){return{backgroundColor:n.backgroundColor,borderCapStyle:n.borderCapStyle,borderDash:n.borderDash,borderDashOffset:n.borderDashOffset,borderJoinStyle:n.borderJoinStyle,borderWidth:n.borderWidth,borderColor:n.borderColor}}function cIe(n,e){if(!e)return!1;const i=[],a=function(s,l){return dO(l)?(i.includes(l)||i.push(l),i.indexOf(l)):l};return JSON.stringify(n,a)!==JSON.stringify(e,a)}/*!
 * Chart.js v4.4.0
 * https://www.chartjs.org
 * (c) 2023 Chart.js Contributors
 * Released under the MIT License
 */class uIe{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(e,i,a,s){const l=i.listeners[s],d=i.duration;l.forEach(f=>f({chart:e,initial:i.initial,numSteps:d,currentStep:Math.min(a-i.start,d)}))}_refresh(){this._request||(this._running=!0,this._request=VJ.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(e=Date.now()){let i=0;this._charts.forEach((a,s)=>{if(!a.running||!a.items.length)return;const l=a.items;let d=l.length-1,f=!1,p;for(;d>=0;--d)p=l[d],p._active?(p._total>a.duration&&(a.duration=p._total),p.tick(e),f=!0):(l[d]=l[l.length-1],l.pop());f&&(s.draw(),this._notify(s,a,e,"progress")),l.length||(a.running=!1,this._notify(s,a,e,"complete"),a.initial=!1),i+=l.length}),this._lastDate=e,i===0&&(this._running=!1)}_getAnims(e){const i=this._charts;let a=i.get(e);return a||(a={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},i.set(e,a)),a}listen(e,i,a){this._getAnims(e).listeners[i].push(a)}add(e,i){!i||!i.length||this._getAnims(e).items.push(...i)}has(e){return this._getAnims(e).items.length>0}start(e){const i=this._charts.get(e);i&&(i.running=!0,i.start=Date.now(),i.duration=i.items.reduce((a,s)=>Math.max(a,s._duration),0),this._refresh())}running(e){if(!this._running)return!1;const i=this._charts.get(e);return!(!i||!i.running||!i.items.length)}stop(e){const i=this._charts.get(e);if(!i||!i.items.length)return;const a=i.items;let s=a.length-1;for(;s>=0;--s)a[s].cancel();i.items=[],this._notify(e,i,Date.now(),"complete")}remove(e){return this._charts.delete(e)}}var Mh=new uIe;const hH="transparent",dIe={boolean(n,e,i){return i>.5?e:n},color(n,e,i){const a=nH(n||hH),s=a.valid&&nH(e||hH);return s&&s.valid?s.mix(a,i).hexString():e},number(n,e,i){return n+(e-n)*i}};class hIe{constructor(e,i,a,s){const l=i[a];s=Zx([e.to,s,l,e.from]);const d=Zx([e.from,l,s]);this._active=!0,this._fn=e.fn||dIe[e.type||typeof d],this._easing=Pb[e.easing]||Pb.linear,this._start=Math.floor(Date.now()+(e.delay||0)),this._duration=this._total=Math.floor(e.duration),this._loop=!!e.loop,this._target=i,this._prop=a,this._from=d,this._to=s,this._promises=void 0}active(){return this._active}update(e,i,a){if(this._active){this._notify(!1);const s=this._target[this._prop],l=a-this._start,d=this._duration-l;this._start=a,this._duration=Math.floor(Math.max(d,e.duration)),this._total+=l,this._loop=!!e.loop,this._to=Zx([e.to,i,s,e.from]),this._from=Zx([e.from,s,i])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(e){const i=e-this._start,a=this._duration,s=this._prop,l=this._from,d=this._loop,f=this._to;let p;if(this._active=l!==f&&(d||i<a),!this._active){this._target[s]=f,this._notify(!0);return}if(i<0){this._target[s]=l;return}p=i/a%2,p=d&&p>1?2-p:p,p=this._easing(Math.min(1,Math.max(0,p))),this._target[s]=this._fn(l,f,p)}wait(){const e=this._promises||(this._promises=[]);return new Promise((i,a)=>{e.push({res:i,rej:a})})}_notify(e){const i=e?"res":"rej",a=this._promises||[];for(let s=0;s<a.length;s++)a[s][i]()}}class sQ{constructor(e,i){this._chart=e,this._properties=new Map,this.configure(i)}configure(e){if(!ir(e))return;const i=Object.keys(Ja.animation),a=this._properties;Object.getOwnPropertyNames(e).forEach(s=>{const l=e[s];if(!ir(l))return;const d={};for(const f of i)d[f]=l[f];(ha(l.properties)&&l.properties||[s]).forEach(f=>{(f===s||!a.has(f))&&a.set(f,d)})})}_animateOptions(e,i){const a=i.options,s=pIe(e,a);if(!s)return[];const l=this._createAnimations(s,a);return a.$shared&&fIe(e.options.$animations,a).then(()=>{e.options=a},()=>{}),l}_createAnimations(e,i){const a=this._properties,s=[],l=e.$animations||(e.$animations={}),d=Object.keys(i),f=Date.now();let p;for(p=d.length-1;p>=0;--p){const y=d[p];if(y.charAt(0)==="$")continue;if(y==="options"){s.push(...this._animateOptions(e,i));continue}const _=i[y];let b=l[y];const S=a.get(y);if(b)if(S&&b.active()){b.update(S,_,f);continue}else b.cancel();if(!S||!S.duration){e[y]=_;continue}l[y]=b=new hIe(S,e,y,_),s.push(b)}return s}update(e,i){if(this._properties.size===0){Object.assign(e,i);return}const a=this._createAnimations(e,i);if(a.length)return Mh.add(this._chart,a),!0}}function fIe(n,e){const i=[],a=Object.keys(e);for(let s=0;s<a.length;s++){const l=n[a[s]];l&&l.active()&&i.push(l.wait())}return Promise.all(i)}function pIe(n,e){if(!e)return;let i=n.options;if(!i){n.options=e;return}return i.$shared&&(n.options=i=Object.assign({},i,{$shared:!1,$animations:{}})),i}function fH(n,e){const i=n&&n.options||{},a=i.reverse,s=i.min===void 0?e:0,l=i.max===void 0?e:0;return{start:a?l:s,end:a?s:l}}function mIe(n,e,i){if(i===!1)return!1;const a=fH(n,i),s=fH(e,i);return{top:s.end,right:a.end,bottom:s.start,left:a.start}}function gIe(n){let e,i,a,s;return ir(n)?(e=n.top,i=n.right,a=n.bottom,s=n.left):e=i=a=s=n,{top:e,right:i,bottom:a,left:s,disabled:n===!1}}function lQ(n,e){const i=[],a=n._getSortedDatasetMetas(e);let s,l;for(s=0,l=a.length;s<l;++s)i.push(a[s].index);return i}function pH(n,e,i,a={}){const s=n.keys,l=a.mode==="single";let d,f,p,y;if(e!==null){for(d=0,f=s.length;d<f;++d){if(p=+s[d],p===i){if(a.all)continue;break}y=n.values[p],Ka(y)&&(l||e===0||Ed(e)===Ed(y))&&(e+=y)}return e}}function yIe(n){const e=Object.keys(n),i=new Array(e.length);let a,s,l;for(a=0,s=e.length;a<s;++a)l=e[a],i[a]={x:l,y:n[l]};return i}function mH(n,e){const i=n&&n.options.stacked;return i||i===void 0&&e.stack!==void 0}function vIe(n,e,i){return`${n.id}.${e.id}.${i.stack||i.type}`}function _Ie(n){const{min:e,max:i,minDefined:a,maxDefined:s}=n.getUserBounds();return{min:a?e:Number.NEGATIVE_INFINITY,max:s?i:Number.POSITIVE_INFINITY}}function xIe(n,e,i){const a=n[e]||(n[e]={});return a[i]||(a[i]={})}function gH(n,e,i,a){for(const s of e.getMatchingVisibleMetas(a).reverse()){const l=n[s.index];if(i&&l>0||!i&&l<0)return s.index}return null}function yH(n,e){const{chart:i,_cachedMeta:a}=n,s=i._stacks||(i._stacks={}),{iScale:l,vScale:d,index:f}=a,p=l.axis,y=d.axis,_=vIe(l,d,a),b=e.length;let S;for(let A=0;A<b;++A){const P=e[A],{[p]:L,[y]:k}=P,R=P._stacks||(P._stacks={});S=R[y]=xIe(s,_,L),S[f]=k,S._top=gH(S,d,!0,a.type),S._bottom=gH(S,d,!1,a.type);const z=S._visualValues||(S._visualValues={});z[f]=k}}function BL(n,e){const i=n.scales;return Object.keys(i).filter(a=>i[a].axis===e).shift()}function bIe(n,e){return Wp(n,{active:!1,dataset:void 0,datasetIndex:e,index:e,mode:"default",type:"dataset"})}function wIe(n,e,i){return Wp(n,{active:!1,dataIndex:e,parsed:void 0,raw:void 0,element:i,index:e,mode:"default",type:"data"})}function zx(n,e){const i=n.controller.index,a=n.vScale&&n.vScale.axis;if(a){e=e||n._parsed;for(const s of e){const l=s._stacks;if(!l||l[a]===void 0||l[a][i]===void 0)return;delete l[a][i],l[a]._visualValues!==void 0&&l[a]._visualValues[i]!==void 0&&delete l[a]._visualValues[i]}}}const UL=n=>n==="reset"||n==="none",vH=(n,e)=>e?n:Object.assign({},n),SIe=(n,e,i)=>n&&!e.hidden&&e._stacked&&{keys:lQ(i,!0),values:null};class _u{constructor(e,i){this.chart=e,this._ctx=e.ctx,this.index=i,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const e=this._cachedMeta;this.configure(),this.linkScales(),e._stacked=mH(e.vScale,e),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(e){this.index!==e&&zx(this._cachedMeta),this.index=e}linkScales(){const e=this.chart,i=this._cachedMeta,a=this.getDataset(),s=(b,S,A,P)=>b==="x"?S:b==="r"?P:A,l=i.xAxisID=Ui(a.xAxisID,BL(e,"x")),d=i.yAxisID=Ui(a.yAxisID,BL(e,"y")),f=i.rAxisID=Ui(a.rAxisID,BL(e,"r")),p=i.indexAxis,y=i.iAxisID=s(p,l,d,f),_=i.vAxisID=s(p,d,l,f);i.xScale=this.getScaleForId(l),i.yScale=this.getScaleForId(d),i.rScale=this.getScaleForId(f),i.iScale=this.getScaleForId(y),i.vScale=this.getScaleForId(_)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(e){return this.chart.scales[e]}_getOtherScale(e){const i=this._cachedMeta;return e===i.iScale?i.vScale:i.iScale}reset(){this._update("reset")}_destroy(){const e=this._cachedMeta;this._data&&QG(this._data,this),e._stacked&&zx(e)}_dataCheck(){const e=this.getDataset(),i=e.data||(e.data=[]),a=this._data;if(ir(i))this._data=yIe(i);else if(a!==i){if(a){QG(a,this);const s=this._cachedMeta;zx(s),s._parsed=[]}i&&Object.isExtensible(i)&&lPe(i,this),this._syncList=[],this._data=i}}addElements(){const e=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(e.dataset=new this.datasetElementType)}buildOrUpdateElements(e){const i=this._cachedMeta,a=this.getDataset();let s=!1;this._dataCheck();const l=i._stacked;i._stacked=mH(i.vScale,i),i.stack!==a.stack&&(s=!0,zx(i),i.stack=a.stack),this._resyncElements(e),(s||l!==i._stacked)&&yH(this,i._parsed)}configure(){const e=this.chart.config,i=e.datasetScopeKeys(this._type),a=e.getOptionScopes(this.getDataset(),i,!0);this.options=e.createResolver(a,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(e,i){const{_cachedMeta:a,_data:s}=this,{iScale:l,_stacked:d}=a,f=l.axis;let p=e===0&&i===s.length?!0:a._sorted,y=e>0&&a._parsed[e-1],_,b,S;if(this._parsing===!1)a._parsed=s,a._sorted=!0,S=s;else{ha(s[e])?S=this.parseArrayData(a,s,e,i):ir(s[e])?S=this.parseObjectData(a,s,e,i):S=this.parsePrimitiveData(a,s,e,i);const A=()=>b[f]===null||y&&b[f]<y[f];for(_=0;_<i;++_)a._parsed[_+e]=b=S[_],p&&(A()&&(p=!1),y=b);a._sorted=p}d&&yH(this,S)}parsePrimitiveData(e,i,a,s){const{iScale:l,vScale:d}=e,f=l.axis,p=d.axis,y=l.getLabels(),_=l===d,b=new Array(s);let S,A,P;for(S=0,A=s;S<A;++S)P=S+a,b[S]={[f]:_||l.parse(y[P],P),[p]:d.parse(i[P],P)};return b}parseArrayData(e,i,a,s){const{xScale:l,yScale:d}=e,f=new Array(s);let p,y,_,b;for(p=0,y=s;p<y;++p)_=p+a,b=i[_],f[p]={x:l.parse(b[0],_),y:d.parse(b[1],_)};return f}parseObjectData(e,i,a,s){const{xScale:l,yScale:d}=e,{xAxisKey:f="x",yAxisKey:p="y"}=this._parsing,y=new Array(s);let _,b,S,A;for(_=0,b=s;_<b;++_)S=_+a,A=i[S],y[_]={x:l.parse(Ip(A,f),S),y:d.parse(Ip(A,p),S)};return y}getParsed(e){return this._cachedMeta._parsed[e]}getDataElement(e){return this._cachedMeta.data[e]}applyStack(e,i,a){const s=this.chart,l=this._cachedMeta,d=i[e.axis],f={keys:lQ(s,!0),values:i._stacks[e.axis]._visualValues};return pH(f,d,l.index,{mode:a})}updateRangeFromParsed(e,i,a,s){const l=a[i.axis];let d=l===null?NaN:l;const f=s&&a._stacks[i.axis];s&&f&&(s.values=f,d=pH(s,l,this._cachedMeta.index)),e.min=Math.min(e.min,d),e.max=Math.max(e.max,d)}getMinMax(e,i){const a=this._cachedMeta,s=a._parsed,l=a._sorted&&e===a.iScale,d=s.length,f=this._getOtherScale(e),p=SIe(i,a,this.chart),y={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:_,max:b}=_Ie(f);let S,A;function P(){A=s[S];const L=A[f.axis];return!Ka(A[e.axis])||_>L||b<L}for(S=0;S<d&&!(!P()&&(this.updateRangeFromParsed(y,e,A,p),l));++S);if(l){for(S=d-1;S>=0;--S)if(!P()){this.updateRangeFromParsed(y,e,A,p);break}}return y}getAllParsedValues(e){const i=this._cachedMeta._parsed,a=[];let s,l,d;for(s=0,l=i.length;s<l;++s)d=i[s][e.axis],Ka(d)&&a.push(d);return a}getMaxOverflow(){return!1}getLabelAndValue(e){const i=this._cachedMeta,a=i.iScale,s=i.vScale,l=this.getParsed(e);return{label:a?""+a.getLabelForValue(l[a.axis]):"",value:s?""+s.getLabelForValue(l[s.axis]):""}}_update(e){const i=this._cachedMeta;this.update(e||"default"),i._clip=gIe(Ui(this.options.clip,mIe(i.xScale,i.yScale,this.getMaxOverflow())))}update(e){}draw(){const e=this._ctx,i=this.chart,a=this._cachedMeta,s=a.data||[],l=i.chartArea,d=[],f=this._drawStart||0,p=this._drawCount||s.length-f,y=this.options.drawActiveElementsOnTop;let _;for(a.dataset&&a.dataset.draw(e,l,f,p),_=f;_<f+p;++_){const b=s[_];b.hidden||(b.active&&y?d.push(b):b.draw(e,l))}for(_=0;_<d.length;++_)d[_].draw(e,l)}getStyle(e,i){const a=i?"active":"default";return e===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(a):this.resolveDataElementOptions(e||0,a)}getContext(e,i,a){const s=this.getDataset();let l;if(e>=0&&e<this._cachedMeta.data.length){const d=this._cachedMeta.data[e];l=d.$context||(d.$context=wIe(this.getContext(),e,d)),l.parsed=this.getParsed(e),l.raw=s.data[e],l.index=l.dataIndex=e}else l=this.$context||(this.$context=bIe(this.chart.getContext(),this.index)),l.dataset=s,l.index=l.datasetIndex=this.index;return l.active=!!i,l.mode=a,l}resolveDatasetElementOptions(e){return this._resolveElementOptions(this.datasetElementType.id,e)}resolveDataElementOptions(e,i){return this._resolveElementOptions(this.dataElementType.id,i,e)}_resolveElementOptions(e,i="default",a){const s=i==="active",l=this._cachedDataOpts,d=e+"-"+i,f=l[d],p=this.enableOptionSharing&&Rw(a);if(f)return vH(f,p);const y=this.chart.config,_=y.datasetElementScopeKeys(this._type,e),b=s?[`${e}Hover`,"hover",e,""]:[e,""],S=y.getOptionScopes(this.getDataset(),_),A=Object.keys(Ja.elements[e]),P=()=>this.getContext(a,s,i),L=y.resolveNamedOptions(S,A,P,b);return L.$shared&&(L.$shared=p,l[d]=Object.freeze(vH(L,p))),L}_resolveAnimations(e,i,a){const s=this.chart,l=this._cachedDataOpts,d=`animation-${i}`,f=l[d];if(f)return f;let p;if(s.options.animation!==!1){const _=this.chart.config,b=_.datasetAnimationScopeKeys(this._type,i),S=_.getOptionScopes(this.getDataset(),b);p=_.createResolver(S,this.getContext(e,a,i))}const y=new sQ(s,p&&p.animations);return p&&p._cacheable&&(l[d]=Object.freeze(y)),y}getSharedOptions(e){if(e.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},e))}includeOptions(e,i){return!i||UL(e)||this.chart._animationsDisabled}_getSharedOptions(e,i){const a=this.resolveDataElementOptions(e,i),s=this._sharedOptions,l=this.getSharedOptions(a),d=this.includeOptions(i,l)||l!==s;return this.updateSharedOptions(l,i,a),{sharedOptions:l,includeOptions:d}}updateElement(e,i,a,s){UL(s)?Object.assign(e,a):this._resolveAnimations(i,s).update(e,a)}updateSharedOptions(e,i,a){e&&!UL(i)&&this._resolveAnimations(void 0,i).update(e,a)}_setStyle(e,i,a,s){e.active=s;const l=this.getStyle(i,s);this._resolveAnimations(i,a,s).update(e,{options:!s&&this.getSharedOptions(l)||l})}removeHoverStyle(e,i,a){this._setStyle(e,a,"active",!1)}setHoverStyle(e,i,a){this._setStyle(e,a,"active",!0)}_removeDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!1)}_setDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!0)}_resyncElements(e){const i=this._data,a=this._cachedMeta.data;for(const[f,p,y]of this._syncList)this[f](p,y);this._syncList=[];const s=a.length,l=i.length,d=Math.min(l,s);d&&this.parse(0,d),l>s?this._insertElements(s,l-s,e):l<s&&this._removeElements(l,s-l)}_insertElements(e,i,a=!0){const s=this._cachedMeta,l=s.data,d=e+i;let f;const p=y=>{for(y.length+=i,f=y.length-1;f>=d;f--)y[f]=y[f-i]};for(p(l),f=e;f<d;++f)l[f]=new this.dataElementType;this._parsing&&p(s._parsed),this.parse(e,i),a&&this.updateElements(l,e,i,"reset")}updateElements(e,i,a,s){}_removeElements(e,i){const a=this._cachedMeta;if(this._parsing){const s=a._parsed.splice(e,i);a._stacked&&zx(a,s)}a.data.splice(e,i)}_sync(e){if(this._parsing)this._syncList.push(e);else{const[i,a,s]=e;this[i](a,s)}this.chart._dataChanges.push([this.index,...e])}_onDataPush(){const e=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-e,e])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(e,i){i&&this._sync(["_removeElements",e,i]);const a=arguments.length-2;a&&this._sync(["_insertElements",e,a])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}wn(_u,"defaults",{}),wn(_u,"datasetElementType",null),wn(_u,"dataElementType",null);function EIe(n,e){if(!n._cache.$bar){const i=n.getMatchingVisibleMetas(e);let a=[];for(let s=0,l=i.length;s<l;s++)a=a.concat(i[s].controller.getAllParsedValues(n));n._cache.$bar=WJ(a.sort((s,l)=>s-l))}return n._cache.$bar}function MIe(n){const e=n.iScale,i=EIe(e,n.type);let a=e._length,s,l,d,f;const p=()=>{d===32767||d===-32768||(Rw(f)&&(a=Math.min(a,Math.abs(d-f)||a)),f=d)};for(s=0,l=i.length;s<l;++s)d=e.getPixelForValue(i[s]),p();for(f=void 0,s=0,l=e.ticks.length;s<l;++s)d=e.getPixelForTick(s),p();return a}function TIe(n,e,i,a){const s=i.barThickness;let l,d;return mr(s)?(l=e.min*i.categoryPercentage,d=i.barPercentage):(l=s*a,d=1),{chunk:l/a,ratio:d,start:e.pixels[n]-l/2}}function AIe(n,e,i,a){const s=e.pixels,l=s[n];let d=n>0?s[n-1]:null,f=n<s.length-1?s[n+1]:null;const p=i.categoryPercentage;d===null&&(d=l-(f===null?e.end-e.start:f-l)),f===null&&(f=l+l-d);const y=l-(l-Math.min(d,f))/2*p;return{chunk:Math.abs(f-d)/2*p/a,ratio:i.barPercentage,start:y}}function CIe(n,e,i,a){const s=i.parse(n[0],a),l=i.parse(n[1],a),d=Math.min(s,l),f=Math.max(s,l);let p=d,y=f;Math.abs(d)>Math.abs(f)&&(p=f,y=d),e[i.axis]=y,e._custom={barStart:p,barEnd:y,start:s,end:l,min:d,max:f}}function cQ(n,e,i,a){return ha(n)?CIe(n,e,i,a):e[i.axis]=i.parse(n,a),e}function _H(n,e,i,a){const s=n.iScale,l=n.vScale,d=s.getLabels(),f=s===l,p=[];let y,_,b,S;for(y=i,_=i+a;y<_;++y)S=e[y],b={},b[s.axis]=f||s.parse(d[y],y),p.push(cQ(S,b,l,y));return p}function WL(n){return n&&n.barStart!==void 0&&n.barEnd!==void 0}function PIe(n,e,i){return n!==0?Ed(n):(e.isHorizontal()?1:-1)*(e.min>=i?1:-1)}function IIe(n){let e,i,a,s,l;return n.horizontal?(e=n.base>n.x,i="left",a="right"):(e=n.base<n.y,i="bottom",a="top"),e?(s="end",l="start"):(s="start",l="end"),{start:i,end:a,reverse:e,top:s,bottom:l}}function RIe(n,e,i,a){let s=e.borderSkipped;const l={};if(!s){n.borderSkipped=l;return}if(s===!0){n.borderSkipped={top:!0,right:!0,bottom:!0,left:!0};return}const{start:d,end:f,reverse:p,top:y,bottom:_}=IIe(n);s==="middle"&&i&&(n.enableBorderRadius=!0,(i._top||0)===a?s=y:(i._bottom||0)===a?s=_:(l[xH(_,d,f,p)]=!0,s=y)),l[xH(s,d,f,p)]=!0,n.borderSkipped=l}function xH(n,e,i,a){return a?(n=LIe(n,e,i),n=bH(n,i,e)):n=bH(n,e,i),n}function LIe(n,e,i){return n===e?i:n===i?e:n}function bH(n,e,i){return n==="start"?e:n==="end"?i:n}function kIe(n,{inflateAmount:e},i){n.inflateAmount=e==="auto"?i===1?.33:0:e}class wM extends _u{parsePrimitiveData(e,i,a,s){return _H(e,i,a,s)}parseArrayData(e,i,a,s){return _H(e,i,a,s)}parseObjectData(e,i,a,s){const{iScale:l,vScale:d}=e,{xAxisKey:f="x",yAxisKey:p="y"}=this._parsing,y=l.axis==="x"?f:p,_=d.axis==="x"?f:p,b=[];let S,A,P,L;for(S=a,A=a+s;S<A;++S)L=i[S],P={},P[l.axis]=l.parse(Ip(L,y),S),b.push(cQ(Ip(L,_),P,d,S));return b}updateRangeFromParsed(e,i,a,s){super.updateRangeFromParsed(e,i,a,s);const l=a._custom;l&&i===this._cachedMeta.vScale&&(e.min=Math.min(e.min,l.min),e.max=Math.max(e.max,l.max))}getMaxOverflow(){return 0}getLabelAndValue(e){const i=this._cachedMeta,{iScale:a,vScale:s}=i,l=this.getParsed(e),d=l._custom,f=WL(d)?"["+d.start+", "+d.end+"]":""+s.getLabelForValue(l[s.axis]);return{label:""+a.getLabelForValue(l[a.axis]),value:f}}initialize(){this.enableOptionSharing=!0,super.initialize();const e=this._cachedMeta;e.stack=this.getDataset().stack}update(e){const i=this._cachedMeta;this.updateElements(i.data,0,i.data.length,e)}updateElements(e,i,a,s){const l=s==="reset",{index:d,_cachedMeta:{vScale:f}}=this,p=f.getBasePixel(),y=f.isHorizontal(),_=this._getRuler(),{sharedOptions:b,includeOptions:S}=this._getSharedOptions(i,s);for(let A=i;A<i+a;A++){const P=this.getParsed(A),L=l||mr(P[f.axis])?{base:p,head:p}:this._calculateBarValuePixels(A),k=this._calculateBarIndexPixels(A,_),R=(P._stacks||{})[f.axis],z={horizontal:y,base:L.base,enableBorderRadius:!R||WL(P._custom)||d===R._top||d===R._bottom,x:y?L.head:k.center,y:y?k.center:L.head,height:y?k.size:Math.abs(L.size),width:y?Math.abs(L.size):k.size};S&&(z.options=b||this.resolveDataElementOptions(A,e[A].active?"active":s));const O=z.options||e[A].options;RIe(z,O,R,d),kIe(z,O,_.ratio),this.updateElement(e[A],A,z,s)}}_getStacks(e,i){const{iScale:a}=this._cachedMeta,s=a.getMatchingVisibleMetas(this._type).filter(p=>p.controller.options.grouped),l=a.options.stacked,d=[],f=p=>{const y=p.controller.getParsed(i),_=y&&y[p.vScale.axis];if(mr(_)||isNaN(_))return!0};for(const p of s)if(!(i!==void 0&&f(p))&&((l===!1||d.indexOf(p.stack)===-1||l===void 0&&p.stack===void 0)&&d.push(p.stack),p.index===e))break;return d.length||d.push(void 0),d}_getStackCount(e){return this._getStacks(void 0,e).length}_getStackIndex(e,i,a){const s=this._getStacks(e,a),l=i!==void 0?s.indexOf(i):-1;return l===-1?s.length-1:l}_getRuler(){const e=this.options,i=this._cachedMeta,a=i.iScale,s=[];let l,d;for(l=0,d=i.data.length;l<d;++l)s.push(a.getPixelForValue(this.getParsed(l)[a.axis],l));const f=e.barThickness;return{min:f||MIe(i),pixels:s,start:a._startPixel,end:a._endPixel,stackCount:this._getStackCount(),scale:a,grouped:e.grouped,ratio:f?1:e.categoryPercentage*e.barPercentage}}_calculateBarValuePixels(e){const{_cachedMeta:{vScale:i,_stacked:a,index:s},options:{base:l,minBarLength:d}}=this,f=l||0,p=this.getParsed(e),y=p._custom,_=WL(y);let b=p[i.axis],S=0,A=a?this.applyStack(i,p,a):b,P,L;A!==b&&(S=A-b,A=b),_&&(b=y.barStart,A=y.barEnd-y.barStart,b!==0&&Ed(b)!==Ed(y.barEnd)&&(S=0),S+=b);const k=!mr(l)&&!_?l:S;let R=i.getPixelForValue(k);if(this.chart.getDataVisibility(e)?P=i.getPixelForValue(S+A):P=R,L=P-R,Math.abs(L)<d){L=PIe(L,i,f)*d,b===f&&(R-=L/2);const z=i.getPixelForDecimal(0),O=i.getPixelForDecimal(1),F=Math.min(z,O),H=Math.max(z,O);R=Math.max(Math.min(R,H),F),P=R+L,a&&!_&&(p._stacks[i.axis]._visualValues[s]=i.getValueForPixel(P)-i.getValueForPixel(R))}if(R===i.getPixelForValue(f)){const z=Ed(L)*i.getLineWidthForValue(f)/2;R+=z,L-=z}return{size:L,base:R,head:P,center:P+L/2}}_calculateBarIndexPixels(e,i){const a=i.scale,s=this.options,l=s.skipNull,d=Ui(s.maxBarThickness,1/0);let f,p;if(i.grouped){const y=l?this._getStackCount(e):i.stackCount,_=s.barThickness==="flex"?AIe(e,i,s,y):TIe(e,i,s,y),b=this._getStackIndex(this.index,this._cachedMeta.stack,l?e:void 0);f=_.start+_.chunk*b+_.chunk/2,p=Math.min(d,_.chunk*_.ratio)}else f=a.getPixelForValue(this.getParsed(e)[a.axis],e),p=Math.min(d,i.min*i.ratio);return{base:f-p/2,head:f+p/2,center:f,size:p}}draw(){const e=this._cachedMeta,i=e.vScale,a=e.data,s=a.length;let l=0;for(;l<s;++l)this.getParsed(l)[i.axis]!==null&&a[l].draw(this._ctx)}}wn(wM,"id","bar"),wn(wM,"defaults",{datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}}),wn(wM,"overrides",{scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}});class SM extends _u{initialize(){this.enableOptionSharing=!0,super.initialize()}parsePrimitiveData(e,i,a,s){const l=super.parsePrimitiveData(e,i,a,s);for(let d=0;d<l.length;d++)l[d]._custom=this.resolveDataElementOptions(d+a).radius;return l}parseArrayData(e,i,a,s){const l=super.parseArrayData(e,i,a,s);for(let d=0;d<l.length;d++){const f=i[a+d];l[d]._custom=Ui(f[2],this.resolveDataElementOptions(d+a).radius)}return l}parseObjectData(e,i,a,s){const l=super.parseObjectData(e,i,a,s);for(let d=0;d<l.length;d++){const f=i[a+d];l[d]._custom=Ui(f&&f.r&&+f.r,this.resolveDataElementOptions(d+a).radius)}return l}getMaxOverflow(){const e=this._cachedMeta.data;let i=0;for(let a=e.length-1;a>=0;--a)i=Math.max(i,e[a].size(this.resolveDataElementOptions(a))/2);return i>0&&i}getLabelAndValue(e){const i=this._cachedMeta,a=this.chart.data.labels||[],{xScale:s,yScale:l}=i,d=this.getParsed(e),f=s.getLabelForValue(d.x),p=l.getLabelForValue(d.y),y=d._custom;return{label:a[e]||"",value:"("+f+", "+p+(y?", "+y:"")+")"}}update(e){const i=this._cachedMeta.data;this.updateElements(i,0,i.length,e)}updateElements(e,i,a,s){const l=s==="reset",{iScale:d,vScale:f}=this._cachedMeta,{sharedOptions:p,includeOptions:y}=this._getSharedOptions(i,s),_=d.axis,b=f.axis;for(let S=i;S<i+a;S++){const A=e[S],P=!l&&this.getParsed(S),L={},k=L[_]=l?d.getPixelForDecimal(.5):d.getPixelForValue(P[_]),R=L[b]=l?f.getBasePixel():f.getPixelForValue(P[b]);L.skip=isNaN(k)||isNaN(R),y&&(L.options=p||this.resolveDataElementOptions(S,A.active?"active":s),l&&(L.options.radius=0)),this.updateElement(A,S,L,s)}}resolveDataElementOptions(e,i){const a=this.getParsed(e);let s=super.resolveDataElementOptions(e,i);s.$shared&&(s=Object.assign({},s,{$shared:!1}));const l=s.radius;return i!=="active"&&(s.radius=0),s.radius+=Ui(a&&a._custom,l),s}}wn(SM,"id","bubble"),wn(SM,"defaults",{datasetElementType:!1,dataElementType:"point",animations:{numbers:{type:"number",properties:["x","y","borderWidth","radius"]}}}),wn(SM,"overrides",{scales:{x:{type:"linear"},y:{type:"linear"}}});function DIe(n,e,i){let a=1,s=1,l=0,d=0;if(e<pa){const f=n,p=f+e,y=Math.cos(f),_=Math.sin(f),b=Math.cos(p),S=Math.sin(p),A=(O,F,H)=>Lw(O,f,p,!0)?1:Math.max(F,F*i,H,H*i),P=(O,F,H)=>Lw(O,f,p,!0)?-1:Math.min(F,F*i,H,H*i),L=A(0,y,b),k=A(ho,_,S),R=P(ma,y,b),z=P(ma+ho,_,S);a=(L-R)/2,s=(k-z)/2,l=-(L+R)/2,d=-(k+z)/2}return{ratioX:a,ratioY:s,offsetX:l,offsetY:d}}class Eg extends _u{constructor(e,i){super(e,i),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(e,i){const a=this.getDataset().data,s=this._cachedMeta;if(this._parsing===!1)s._parsed=a;else{let l=p=>+a[p];if(ir(a[e])){const{key:p="value"}=this._parsing;l=y=>+Ip(a[y],p)}let d,f;for(d=e,f=e+i;d<f;++d)s._parsed[d]=l(d)}}_getRotation(){return gu(this.options.rotation-90)}_getCircumference(){return gu(this.options.circumference)}_getRotationExtents(){let e=pa,i=-pa;for(let a=0;a<this.chart.data.datasets.length;++a)if(this.chart.isDatasetVisible(a)&&this.chart.getDatasetMeta(a).type===this._type){const s=this.chart.getDatasetMeta(a).controller,l=s._getRotation(),d=s._getCircumference();e=Math.min(e,l),i=Math.max(i,l+d)}return{rotation:e,circumference:i-e}}update(e){const i=this.chart,{chartArea:a}=i,s=this._cachedMeta,l=s.data,d=this.getMaxBorderWidth()+this.getMaxOffset(l)+this.options.spacing,f=Math.max((Math.min(a.width,a.height)-d)/2,0),p=Math.min(qCe(this.options.cutout,f),1),y=this._getRingWeight(this.index),{circumference:_,rotation:b}=this._getRotationExtents(),{ratioX:S,ratioY:A,offsetX:P,offsetY:L}=DIe(b,_,p),k=(a.width-d)/S,R=(a.height-d)/A,z=Math.max(Math.min(k,R)/2,0),O=OJ(this.options.radius,z),F=Math.max(O*p,0),H=(O-F)/this._getVisibleDatasetWeightTotal();this.offsetX=P*O,this.offsetY=L*O,s.total=this.calculateTotal(),this.outerRadius=O-H*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-H*y,0),this.updateElements(l,0,l.length,e)}_circumference(e,i){const a=this.options,s=this._cachedMeta,l=this._getCircumference();return i&&a.animation.animateRotate||!this.chart.getDataVisibility(e)||s._parsed[e]===null||s.data[e].hidden?0:this.calculateCircumference(s._parsed[e]*l/pa)}updateElements(e,i,a,s){const l=s==="reset",d=this.chart,f=d.chartArea,y=d.options.animation,_=(f.left+f.right)/2,b=(f.top+f.bottom)/2,S=l&&y.animateScale,A=S?0:this.innerRadius,P=S?0:this.outerRadius,{sharedOptions:L,includeOptions:k}=this._getSharedOptions(i,s);let R=this._getRotation(),z;for(z=0;z<i;++z)R+=this._circumference(z,l);for(z=i;z<i+a;++z){const O=this._circumference(z,l),F=e[z],H={x:_+this.offsetX,y:b+this.offsetY,startAngle:R,endAngle:R+O,circumference:O,outerRadius:P,innerRadius:A};k&&(H.options=L||this.resolveDataElementOptions(z,F.active?"active":s)),R+=O,this.updateElement(F,z,H,s)}}calculateTotal(){const e=this._cachedMeta,i=e.data;let a=0,s;for(s=0;s<i.length;s++){const l=e._parsed[s];l!==null&&!isNaN(l)&&this.chart.getDataVisibility(s)&&!i[s].hidden&&(a+=Math.abs(l))}return a}calculateCircumference(e){const i=this._cachedMeta.total;return i>0&&!isNaN(e)?pa*(Math.abs(e)/i):0}getLabelAndValue(e){const i=this._cachedMeta,a=this.chart,s=a.data.labels||[],l=hS(i._parsed[e],a.options.locale);return{label:s[e]||"",value:l}}getMaxBorderWidth(e){let i=0;const a=this.chart;let s,l,d,f,p;if(!e){for(s=0,l=a.data.datasets.length;s<l;++s)if(a.isDatasetVisible(s)){d=a.getDatasetMeta(s),e=d.data,f=d.controller;break}}if(!e)return 0;for(s=0,l=e.length;s<l;++s)p=f.resolveDataElementOptions(s),p.borderAlign!=="inner"&&(i=Math.max(i,p.borderWidth||0,p.hoverBorderWidth||0));return i}getMaxOffset(e){let i=0;for(let a=0,s=e.length;a<s;++a){const l=this.resolveDataElementOptions(a);i=Math.max(i,l.offset||0,l.hoverOffset||0)}return i}_getRingWeightOffset(e){let i=0;for(let a=0;a<e;++a)this.chart.isDatasetVisible(a)&&(i+=this._getRingWeight(a));return i}_getRingWeight(e){return Math.max(Ui(this.chart.data.datasets[e].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}wn(Eg,"id","doughnut"),wn(Eg,"defaults",{datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"}),wn(Eg,"descriptors",{_scriptable:e=>e!=="spacing",_indexable:e=>e!=="spacing"&&!e.startsWith("borderDash")&&!e.startsWith("hoverBorderDash")}),wn(Eg,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels(e){const i=e.data;if(i.labels.length&&i.datasets.length){const{labels:{pointStyle:a,color:s}}=e.legend.options;return i.labels.map((l,d)=>{const p=e.getDatasetMeta(0).controller.getStyle(d);return{text:l,fillStyle:p.backgroundColor,strokeStyle:p.borderColor,fontColor:s,lineWidth:p.borderWidth,pointStyle:a,hidden:!e.getDataVisibility(d),index:d}})}return[]}},onClick(e,i,a){a.chart.toggleDataVisibility(i.index),a.chart.update()}}}});class Rb extends _u{initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(e){const i=this._cachedMeta,{dataset:a,data:s=[],_dataset:l}=i,d=this.chart._animationsDisabled;let{start:f,count:p}=HJ(i,s,d);this._drawStart=f,this._drawCount=p,jJ(i)&&(f=0,p=s.length),a._chart=this.chart,a._datasetIndex=this.index,a._decimated=!!l._decimated,a.points=s;const y=this.resolveDatasetElementOptions(e);this.options.showLine||(y.borderWidth=0),y.segment=this.options.segment,this.updateElement(a,void 0,{animated:!d,options:y},e),this.updateElements(s,f,p,e)}updateElements(e,i,a,s){const l=s==="reset",{iScale:d,vScale:f,_stacked:p,_dataset:y}=this._cachedMeta,{sharedOptions:_,includeOptions:b}=this._getSharedOptions(i,s),S=d.axis,A=f.axis,{spanGaps:P,segment:L}=this.options,k=S_(P)?P:Number.POSITIVE_INFINITY,R=this.chart._animationsDisabled||l||s==="none",z=i+a,O=e.length;let F=i>0&&this.getParsed(i-1);for(let H=0;H<O;++H){const $=e[H],Y=R?$:{};if(H<i||H>=z){Y.skip=!0;continue}const te=this.getParsed(H),G=mr(te[A]),Q=Y[S]=d.getPixelForValue(te[S],H),he=Y[A]=l||G?f.getBasePixel():f.getPixelForValue(p?this.applyStack(f,te,p):te[A],H);Y.skip=isNaN(Q)||isNaN(he)||G,Y.stop=H>0&&Math.abs(te[S]-F[S])>k,L&&(Y.parsed=te,Y.raw=y.data[H]),b&&(Y.options=_||this.resolveDataElementOptions(H,$.active?"active":s)),R||this.updateElement($,H,Y,s),F=te}}getMaxOverflow(){const e=this._cachedMeta,i=e.dataset,a=i.options&&i.options.borderWidth||0,s=e.data||[];if(!s.length)return a;const l=s[0].size(this.resolveDataElementOptions(0)),d=s[s.length-1].size(this.resolveDataElementOptions(s.length-1));return Math.max(a,l,d)/2}draw(){const e=this._cachedMeta;e.dataset.updateControlPoints(this.chart.chartArea,e.iScale.axis),super.draw()}}wn(Rb,"id","line"),wn(Rb,"defaults",{datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1}),wn(Rb,"overrides",{scales:{_index_:{type:"category"},_value_:{type:"linear"}}});class Lb extends _u{constructor(e,i){super(e,i),this.innerRadius=void 0,this.outerRadius=void 0}getLabelAndValue(e){const i=this._cachedMeta,a=this.chart,s=a.data.labels||[],l=hS(i._parsed[e].r,a.options.locale);return{label:s[e]||"",value:l}}parseObjectData(e,i,a,s){return QJ.bind(this)(e,i,a,s)}update(e){const i=this._cachedMeta.data;this._updateRadius(),this.updateElements(i,0,i.length,e)}getMinMax(){const e=this._cachedMeta,i={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};return e.data.forEach((a,s)=>{const l=this.getParsed(s).r;!isNaN(l)&&this.chart.getDataVisibility(s)&&(l<i.min&&(i.min=l),l>i.max&&(i.max=l))}),i}_updateRadius(){const e=this.chart,i=e.chartArea,a=e.options,s=Math.min(i.right-i.left,i.bottom-i.top),l=Math.max(s/2,0),d=Math.max(a.cutoutPercentage?l/100*a.cutoutPercentage:1,0),f=(l-d)/e.getVisibleDatasetCount();this.outerRadius=l-f*this.index,this.innerRadius=this.outerRadius-f}updateElements(e,i,a,s){const l=s==="reset",d=this.chart,p=d.options.animation,y=this._cachedMeta.rScale,_=y.xCenter,b=y.yCenter,S=y.getIndexAngle(0)-.5*ma;let A=S,P;const L=360/this.countVisibleElements();for(P=0;P<i;++P)A+=this._computeAngle(P,s,L);for(P=i;P<i+a;P++){const k=e[P];let R=A,z=A+this._computeAngle(P,s,L),O=d.getDataVisibility(P)?y.getDistanceFromCenterForValue(this.getParsed(P).r):0;A=z,l&&(p.animateScale&&(O=0),p.animateRotate&&(R=z=S));const F={x:_,y:b,innerRadius:0,outerRadius:O,startAngle:R,endAngle:z,options:this.resolveDataElementOptions(P,k.active?"active":s)};this.updateElement(k,P,F,s)}}countVisibleElements(){const e=this._cachedMeta;let i=0;return e.data.forEach((a,s)=>{!isNaN(this.getParsed(s).r)&&this.chart.getDataVisibility(s)&&i++}),i}_computeAngle(e,i,a){return this.chart.getDataVisibility(e)?gu(this.resolveDataElementOptions(e,i).angle||a):0}}wn(Lb,"id","polarArea"),wn(Lb,"defaults",{dataElementType:"arc",animation:{animateRotate:!0,animateScale:!0},animations:{numbers:{type:"number",properties:["x","y","startAngle","endAngle","innerRadius","outerRadius"]}},indexAxis:"r",startAngle:0}),wn(Lb,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels(e){const i=e.data;if(i.labels.length&&i.datasets.length){const{labels:{pointStyle:a,color:s}}=e.legend.options;return i.labels.map((l,d)=>{const p=e.getDatasetMeta(0).controller.getStyle(d);return{text:l,fillStyle:p.backgroundColor,strokeStyle:p.borderColor,fontColor:s,lineWidth:p.borderWidth,pointStyle:a,hidden:!e.getDataVisibility(d),index:d}})}return[]}},onClick(e,i,a){a.chart.toggleDataVisibility(i.index),a.chart.update()}}},scales:{r:{type:"radialLinear",angleLines:{display:!1},beginAtZero:!0,grid:{circular:!0},pointLabels:{display:!1},startAngle:0}}});class lD extends Eg{}wn(lD,"id","pie"),wn(lD,"defaults",{cutout:0,rotation:0,circumference:360,radius:"100%"});class kb extends _u{getLabelAndValue(e){const i=this._cachedMeta.vScale,a=this.getParsed(e);return{label:i.getLabels()[e],value:""+i.getLabelForValue(a[i.axis])}}parseObjectData(e,i,a,s){return QJ.bind(this)(e,i,a,s)}update(e){const i=this._cachedMeta,a=i.dataset,s=i.data||[],l=i.iScale.getLabels();if(a.points=s,e!=="resize"){const d=this.resolveDatasetElementOptions(e);this.options.showLine||(d.borderWidth=0);const f={_loop:!0,_fullLoop:l.length===s.length,options:d};this.updateElement(a,void 0,f,e)}this.updateElements(s,0,s.length,e)}updateElements(e,i,a,s){const l=this._cachedMeta.rScale,d=s==="reset";for(let f=i;f<i+a;f++){const p=e[f],y=this.resolveDataElementOptions(f,p.active?"active":s),_=l.getPointPositionForValue(f,this.getParsed(f).r),b=d?l.xCenter:_.x,S=d?l.yCenter:_.y,A={x:b,y:S,angle:_.angle,skip:isNaN(b)||isNaN(S),options:y};this.updateElement(p,f,A,s)}}}wn(kb,"id","radar"),wn(kb,"defaults",{datasetElementType:"line",dataElementType:"point",indexAxis:"r",showLine:!0,elements:{line:{fill:"start"}}}),wn(kb,"overrides",{aspectRatio:1,scales:{r:{type:"radialLinear"}}});class EM extends _u{getLabelAndValue(e){const i=this._cachedMeta,a=this.chart.data.labels||[],{xScale:s,yScale:l}=i,d=this.getParsed(e),f=s.getLabelForValue(d.x),p=l.getLabelForValue(d.y);return{label:a[e]||"",value:"("+f+", "+p+")"}}update(e){const i=this._cachedMeta,{data:a=[]}=i,s=this.chart._animationsDisabled;let{start:l,count:d}=HJ(i,a,s);if(this._drawStart=l,this._drawCount=d,jJ(i)&&(l=0,d=a.length),this.options.showLine){this.datasetElementType||this.addElements();const{dataset:f,_dataset:p}=i;f._chart=this.chart,f._datasetIndex=this.index,f._decimated=!!p._decimated,f.points=a;const y=this.resolveDatasetElementOptions(e);y.segment=this.options.segment,this.updateElement(f,void 0,{animated:!s,options:y},e)}else this.datasetElementType&&(delete i.dataset,this.datasetElementType=!1);this.updateElements(a,l,d,e)}addElements(){const{showLine:e}=this.options;!this.datasetElementType&&e&&(this.datasetElementType=this.chart.registry.getElement("line")),super.addElements()}updateElements(e,i,a,s){const l=s==="reset",{iScale:d,vScale:f,_stacked:p,_dataset:y}=this._cachedMeta,_=this.resolveDataElementOptions(i,s),b=this.getSharedOptions(_),S=this.includeOptions(s,b),A=d.axis,P=f.axis,{spanGaps:L,segment:k}=this.options,R=S_(L)?L:Number.POSITIVE_INFINITY,z=this.chart._animationsDisabled||l||s==="none";let O=i>0&&this.getParsed(i-1);for(let F=i;F<i+a;++F){const H=e[F],$=this.getParsed(F),Y=z?H:{},te=mr($[P]),G=Y[A]=d.getPixelForValue($[A],F),Q=Y[P]=l||te?f.getBasePixel():f.getPixelForValue(p?this.applyStack(f,$,p):$[P],F);Y.skip=isNaN(G)||isNaN(Q)||te,Y.stop=F>0&&Math.abs($[A]-O[A])>R,k&&(Y.parsed=$,Y.raw=y.data[F]),S&&(Y.options=b||this.resolveDataElementOptions(F,H.active?"active":s)),z||this.updateElement(H,F,Y,s),O=$}this.updateSharedOptions(b,s,_)}getMaxOverflow(){const e=this._cachedMeta,i=e.data||[];if(!this.options.showLine){let f=0;for(let p=i.length-1;p>=0;--p)f=Math.max(f,i[p].size(this.resolveDataElementOptions(p))/2);return f>0&&f}const a=e.dataset,s=a.options&&a.options.borderWidth||0;if(!i.length)return s;const l=i[0].size(this.resolveDataElementOptions(0)),d=i[i.length-1].size(this.resolveDataElementOptions(i.length-1));return Math.max(s,l,d)/2}}wn(EM,"id","scatter"),wn(EM,"defaults",{datasetElementType:!1,dataElementType:"point",showLine:!1,fill:!1}),wn(EM,"overrides",{interaction:{mode:"point"},scales:{x:{type:"linear"},y:{type:"linear"}}});var zIe=Object.freeze({__proto__:null,BarController:wM,BubbleController:SM,DoughnutController:Eg,LineController:Rb,PieController:lD,PolarAreaController:Lb,RadarController:kb,ScatterController:EM});function tg(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class yO{constructor(e){wn(this,"options");this.options=e||{}}static override(e){Object.assign(yO.prototype,e)}init(){}formats(){return tg()}parse(){return tg()}format(){return tg()}add(){return tg()}diff(){return tg()}startOf(){return tg()}endOf(){return tg()}}var OIe={_date:yO};function NIe(n,e,i,a){const{controller:s,data:l,_sorted:d}=n,f=s._cachedMeta.iScale;if(f&&e===f.axis&&e!=="r"&&d&&l.length){const p=f._reversePixels?oPe:Fh;if(a){if(s._sharedOptions){const y=l[0],_=typeof y.getRange=="function"&&y.getRange(e);if(_){const b=p(l,e,i-_),S=p(l,e,i+_);return{lo:b.lo,hi:S.hi}}}}else return p(l,e,i)}return{lo:0,hi:l.length-1}}function fS(n,e,i,a,s){const l=n.getSortedVisibleDatasetMetas(),d=i[e];for(let f=0,p=l.length;f<p;++f){const{index:y,data:_}=l[f],{lo:b,hi:S}=NIe(l[f],e,d,s);for(let A=b;A<=S;++A){const P=_[A];P.skip||a(P,y,A)}}}function FIe(n){const e=n.indexOf("x")!==-1,i=n.indexOf("y")!==-1;return function(a,s){const l=e?Math.abs(a.x-s.x):0,d=i?Math.abs(a.y-s.y):0;return Math.sqrt(Math.pow(l,2)+Math.pow(d,2))}}function VL(n,e,i,a,s){const l=[];return!s&&!n.isPointInArea(e)||fS(n,i,e,function(f,p,y){!s&&!Bh(f,n.chartArea,0)||f.inRange(e.x,e.y,a)&&l.push({element:f,datasetIndex:p,index:y})},!0),l}function BIe(n,e,i,a){let s=[];function l(d,f,p){const{startAngle:y,endAngle:_}=d.getProps(["startAngle","endAngle"],a),{angle:b}=BJ(d,{x:e.x,y:e.y});Lw(b,y,_)&&s.push({element:d,datasetIndex:f,index:p})}return fS(n,i,e,l),s}function UIe(n,e,i,a,s,l){let d=[];const f=FIe(i);let p=Number.POSITIVE_INFINITY;function y(_,b,S){const A=_.inRange(e.x,e.y,s);if(a&&!A)return;const P=_.getCenterPoint(s);if(!(!!l||n.isPointInArea(P))&&!A)return;const k=f(e,P);k<p?(d=[{element:_,datasetIndex:b,index:S}],p=k):k===p&&d.push({element:_,datasetIndex:b,index:S})}return fS(n,i,e,y),d}function GL(n,e,i,a,s,l){return!l&&!n.isPointInArea(e)?[]:i==="r"&&!a?BIe(n,e,i,s):UIe(n,e,i,a,s,l)}function wH(n,e,i,a,s){const l=[],d=i==="x"?"inXRange":"inYRange";let f=!1;return fS(n,i,e,(p,y,_)=>{p[d](e[i],s)&&(l.push({element:p,datasetIndex:y,index:_}),f=f||p.inRange(e.x,e.y,s))}),a&&!f?[]:l}var WIe={evaluateInteractionItems:fS,modes:{index(n,e,i,a){const s=dg(e,n),l=i.axis||"x",d=i.includeInvisible||!1,f=i.intersect?VL(n,s,l,a,d):GL(n,s,l,!1,a,d),p=[];return f.length?(n.getSortedVisibleDatasetMetas().forEach(y=>{const _=f[0].index,b=y.data[_];b&&!b.skip&&p.push({element:b,datasetIndex:y.index,index:_})}),p):[]},dataset(n,e,i,a){const s=dg(e,n),l=i.axis||"xy",d=i.includeInvisible||!1;let f=i.intersect?VL(n,s,l,a,d):GL(n,s,l,!1,a,d);if(f.length>0){const p=f[0].datasetIndex,y=n.getDatasetMeta(p).data;f=[];for(let _=0;_<y.length;++_)f.push({element:y[_],datasetIndex:p,index:_})}return f},point(n,e,i,a){const s=dg(e,n),l=i.axis||"xy",d=i.includeInvisible||!1;return VL(n,s,l,a,d)},nearest(n,e,i,a){const s=dg(e,n),l=i.axis||"xy",d=i.includeInvisible||!1;return GL(n,s,l,i.intersect,a,d)},x(n,e,i,a){const s=dg(e,n);return wH(n,s,"x",i.intersect,a)},y(n,e,i,a){const s=dg(e,n);return wH(n,s,"y",i.intersect,a)}}};const uQ=["left","top","right","bottom"];function Ox(n,e){return n.filter(i=>i.pos===e)}function SH(n,e){return n.filter(i=>uQ.indexOf(i.pos)===-1&&i.box.axis===e)}function Nx(n,e){return n.sort((i,a)=>{const s=e?a:i,l=e?i:a;return s.weight===l.weight?s.index-l.index:s.weight-l.weight})}function VIe(n){const e=[];let i,a,s,l,d,f;for(i=0,a=(n||[]).length;i<a;++i)s=n[i],{position:l,options:{stack:d,stackWeight:f=1}}=s,e.push({index:i,box:s,pos:l,horizontal:s.isHorizontal(),weight:s.weight,stack:d&&l+d,stackWeight:f});return e}function GIe(n){const e={};for(const i of n){const{stack:a,pos:s,stackWeight:l}=i;if(!a||!uQ.includes(s))continue;const d=e[a]||(e[a]={count:0,placed:0,weight:0,size:0});d.count++,d.weight+=l}return e}function HIe(n,e){const i=GIe(n),{vBoxMaxWidth:a,hBoxMaxHeight:s}=e;let l,d,f;for(l=0,d=n.length;l<d;++l){f=n[l];const{fullSize:p}=f.box,y=i[f.stack],_=y&&f.stackWeight/y.weight;f.horizontal?(f.width=_?_*a:p&&e.availableWidth,f.height=s):(f.width=a,f.height=_?_*s:p&&e.availableHeight)}return i}function jIe(n){const e=VIe(n),i=Nx(e.filter(y=>y.box.fullSize),!0),a=Nx(Ox(e,"left"),!0),s=Nx(Ox(e,"right")),l=Nx(Ox(e,"top"),!0),d=Nx(Ox(e,"bottom")),f=SH(e,"x"),p=SH(e,"y");return{fullSize:i,leftAndTop:a.concat(l),rightAndBottom:s.concat(p).concat(d).concat(f),chartArea:Ox(e,"chartArea"),vertical:a.concat(s).concat(p),horizontal:l.concat(d).concat(f)}}function EH(n,e,i,a){return Math.max(n[i],e[i])+Math.max(n[a],e[a])}function dQ(n,e){n.top=Math.max(n.top,e.top),n.left=Math.max(n.left,e.left),n.bottom=Math.max(n.bottom,e.bottom),n.right=Math.max(n.right,e.right)}function $Ie(n,e,i,a){const{pos:s,box:l}=i,d=n.maxPadding;if(!ir(s)){i.size&&(n[s]-=i.size);const b=a[i.stack]||{size:0,count:1};b.size=Math.max(b.size,i.horizontal?l.height:l.width),i.size=b.size/b.count,n[s]+=i.size}l.getPadding&&dQ(d,l.getPadding());const f=Math.max(0,e.outerWidth-EH(d,n,"left","right")),p=Math.max(0,e.outerHeight-EH(d,n,"top","bottom")),y=f!==n.w,_=p!==n.h;return n.w=f,n.h=p,i.horizontal?{same:y,other:_}:{same:_,other:y}}function YIe(n){const e=n.maxPadding;function i(a){const s=Math.max(e[a]-n[a],0);return n[a]+=s,s}n.y+=i("top"),n.x+=i("left"),i("right"),i("bottom")}function qIe(n,e){const i=e.maxPadding;function a(s){const l={left:0,top:0,right:0,bottom:0};return s.forEach(d=>{l[d]=Math.max(e[d],i[d])}),l}return a(n?["left","right"]:["top","bottom"])}function Kx(n,e,i,a){const s=[];let l,d,f,p,y,_;for(l=0,d=n.length,y=0;l<d;++l){f=n[l],p=f.box,p.update(f.width||e.w,f.height||e.h,qIe(f.horizontal,e));const{same:b,other:S}=$Ie(e,i,f,a);y|=b&&s.length,_=_||S,p.fullSize||s.push(f)}return y&&Kx(s,e,i,a)||_}function DE(n,e,i,a,s){n.top=i,n.left=e,n.right=e+a,n.bottom=i+s,n.width=a,n.height=s}function MH(n,e,i,a){const s=i.padding;let{x:l,y:d}=e;for(const f of n){const p=f.box,y=a[f.stack]||{count:1,placed:0,weight:1},_=f.stackWeight/y.weight||1;if(f.horizontal){const b=e.w*_,S=y.size||p.height;Rw(y.start)&&(d=y.start),p.fullSize?DE(p,s.left,d,i.outerWidth-s.right-s.left,S):DE(p,e.left+y.placed,d,b,S),y.start=d,y.placed+=b,d=p.bottom}else{const b=e.h*_,S=y.size||p.width;Rw(y.start)&&(l=y.start),p.fullSize?DE(p,l,s.top,S,i.outerHeight-s.bottom-s.top):DE(p,l,e.top+y.placed,S,b),y.start=l,y.placed+=b,l=p.right}}e.x=l,e.y=d}var Es={addBox(n,e){n.boxes||(n.boxes=[]),e.fullSize=e.fullSize||!1,e.position=e.position||"top",e.weight=e.weight||0,e._layers=e._layers||function(){return[{z:0,draw(i){e.draw(i)}}]},n.boxes.push(e)},removeBox(n,e){const i=n.boxes?n.boxes.indexOf(e):-1;i!==-1&&n.boxes.splice(i,1)},configure(n,e,i){e.fullSize=i.fullSize,e.position=i.position,e.weight=i.weight},update(n,e,i,a){if(!n)return;const s=Ps(n.options.layout.padding),l=Math.max(e-s.width,0),d=Math.max(i-s.height,0),f=jIe(n.boxes),p=f.vertical,y=f.horizontal;Gr(n.boxes,L=>{typeof L.beforeLayout=="function"&&L.beforeLayout()});const _=p.reduce((L,k)=>k.box.options&&k.box.options.display===!1?L:L+1,0)||1,b=Object.freeze({outerWidth:e,outerHeight:i,padding:s,availableWidth:l,availableHeight:d,vBoxMaxWidth:l/2/_,hBoxMaxHeight:d/2}),S=Object.assign({},s);dQ(S,Ps(a));const A=Object.assign({maxPadding:S,w:l,h:d,x:s.left,y:s.top},s),P=HIe(p.concat(y),b);Kx(f.fullSize,A,b,P),Kx(p,A,b,P),Kx(y,A,b,P)&&Kx(p,A,b,P),YIe(A),MH(f.leftAndTop,A,b,P),A.x+=A.w,A.y+=A.h,MH(f.rightAndBottom,A,b,P),n.chartArea={left:A.left,top:A.top,right:A.left+A.w,bottom:A.top+A.h,height:A.h,width:A.w},Gr(f.chartArea,L=>{const k=L.box;Object.assign(k,n.chartArea),k.update(A.w,A.h,{left:0,top:0,right:0,bottom:0})})}};class hQ{acquireContext(e,i){}releaseContext(e){return!1}addEventListener(e,i,a){}removeEventListener(e,i,a){}getDevicePixelRatio(){return 1}getMaximumSize(e,i,a,s){return i=Math.max(0,i||e.width),a=a||e.height,{width:i,height:Math.max(0,s?Math.floor(i/s):a)}}isAttached(e){return!0}updateConfig(e){}}class XIe extends hQ{acquireContext(e){return e&&e.getContext&&e.getContext("2d")||null}updateConfig(e){e.options.animation=!1}}const MM="$chartjs",ZIe={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},TH=n=>n===null||n==="";function KIe(n,e){const i=n.style,a=n.getAttribute("height"),s=n.getAttribute("width");if(n[MM]={initial:{height:a,width:s,style:{display:i.display,height:i.height,width:i.width}}},i.display=i.display||"block",i.boxSizing=i.boxSizing||"border-box",TH(s)){const l=lH(n,"width");l!==void 0&&(n.width=l)}if(TH(a))if(n.style.height==="")n.height=n.width/(e||2);else{const l=lH(n,"height");l!==void 0&&(n.height=l)}return n}const fQ=QPe?{passive:!0}:!1;function JIe(n,e,i){n.addEventListener(e,i,fQ)}function QIe(n,e,i){n.canvas.removeEventListener(e,i,fQ)}function eRe(n,e){const i=ZIe[n.type]||n.type,{x:a,y:s}=dg(n,e);return{type:i,chart:e,native:n,x:a!==void 0?a:null,y:s!==void 0?s:null}}function AT(n,e){for(const i of n)if(i===e||i.contains(e))return!0}function tRe(n,e,i){const a=n.canvas,s=new MutationObserver(l=>{let d=!1;for(const f of l)d=d||AT(f.addedNodes,a),d=d&&!AT(f.removedNodes,a);d&&i()});return s.observe(document,{childList:!0,subtree:!0}),s}function nRe(n,e,i){const a=n.canvas,s=new MutationObserver(l=>{let d=!1;for(const f of l)d=d||AT(f.removedNodes,a),d=d&&!AT(f.addedNodes,a);d&&i()});return s.observe(document,{childList:!0,subtree:!0}),s}const Dw=new Map;let AH=0;function pQ(){const n=window.devicePixelRatio;n!==AH&&(AH=n,Dw.forEach((e,i)=>{i.currentDevicePixelRatio!==n&&e()}))}function iRe(n,e){Dw.size||window.addEventListener("resize",pQ),Dw.set(n,e)}function rRe(n){Dw.delete(n),Dw.size||window.removeEventListener("resize",pQ)}function aRe(n,e,i){const a=n.canvas,s=a&&gO(a);if(!s)return;const l=GJ((f,p)=>{const y=s.clientWidth;i(f,p),y<s.clientWidth&&i()},window),d=new ResizeObserver(f=>{const p=f[0],y=p.contentRect.width,_=p.contentRect.height;y===0&&_===0||l(y,_)});return d.observe(s),iRe(n,l),d}function HL(n,e,i){i&&i.disconnect(),e==="resize"&&rRe(n)}function oRe(n,e,i){const a=n.canvas,s=GJ(l=>{n.ctx!==null&&i(eRe(l,n))},n);return JIe(a,e,s),s}class sRe extends hQ{acquireContext(e,i){const a=e&&e.getContext&&e.getContext("2d");return a&&a.canvas===e?(KIe(e,i),a):null}releaseContext(e){const i=e.canvas;if(!i[MM])return!1;const a=i[MM].initial;["height","width"].forEach(l=>{const d=a[l];mr(d)?i.removeAttribute(l):i.setAttribute(l,d)});const s=a.style||{};return Object.keys(s).forEach(l=>{i.style[l]=s[l]}),i.width=i.width,delete i[MM],!0}addEventListener(e,i,a){this.removeEventListener(e,i);const s=e.$proxies||(e.$proxies={}),d={attach:tRe,detach:nRe,resize:aRe}[i]||oRe;s[i]=d(e,i,a)}removeEventListener(e,i){const a=e.$proxies||(e.$proxies={}),s=a[i];if(!s)return;({attach:HL,detach:HL,resize:HL}[i]||QIe)(e,i,s),a[i]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(e,i,a,s){return JPe(e,i,a,s)}isAttached(e){const i=gO(e);return!!(i&&i.isConnected)}}function lRe(n){return!tQ()||typeof OffscreenCanvas<"u"&&n instanceof OffscreenCanvas?XIe:sRe}var YE;let Qh=(YE=class{constructor(){wn(this,"x");wn(this,"y");wn(this,"active",!1);wn(this,"options");wn(this,"$animations")}tooltipPosition(e){const{x:i,y:a}=this.getProps(["x","y"],e);return{x:i,y:a}}hasValue(){return S_(this.x)&&S_(this.y)}getProps(e,i){const a=this.$animations;if(!i||!a)return this;const s={};return e.forEach(l=>{s[l]=a[l]&&a[l].active()?a[l]._to:this[l]}),s}},wn(YE,"defaults",{}),wn(YE,"defaultRoutes"),YE);function cRe(n,e){const i=n.options.ticks,a=uRe(n),s=Math.min(i.maxTicksLimit||a,a),l=i.major.enabled?hRe(e):[],d=l.length,f=l[0],p=l[d-1],y=[];if(d>s)return fRe(e,y,l,d/s),y;const _=dRe(l,e,s);if(d>0){let b,S;const A=d>1?Math.round((p-f)/(d-1)):null;for(zE(e,y,_,mr(A)?0:f-A,f),b=0,S=d-1;b<S;b++)zE(e,y,_,l[b],l[b+1]);return zE(e,y,_,p,mr(A)?e.length:p+A),y}return zE(e,y,_),y}function uRe(n){const e=n.options.offset,i=n._tickSize(),a=n._length/i+(e?0:1),s=n._maxLength/i;return Math.floor(Math.min(a,s))}function dRe(n,e,i){const a=pRe(n),s=e.length/i;if(!a)return Math.max(s,1);const l=nPe(a);for(let d=0,f=l.length-1;d<f;d++){const p=l[d];if(p>s)return p}return Math.max(s,1)}function hRe(n){const e=[];let i,a;for(i=0,a=n.length;i<a;i++)n[i].major&&e.push(i);return e}function fRe(n,e,i,a){let s=0,l=i[0],d;for(a=Math.ceil(a),d=0;d<n.length;d++)d===l&&(e.push(n[d]),s++,l=i[s*a])}function zE(n,e,i,a,s){const l=Ui(a,0),d=Math.min(Ui(s,n.length),n.length);let f=0,p,y,_;for(i=Math.ceil(i),s&&(p=s-a,i=p/Math.floor(p/i)),_=l;_<0;)f++,_=Math.round(l+f*i);for(y=Math.max(l,0);y<d;y++)y===_&&(e.push(n[y]),f++,_=Math.round(l+f*i))}function pRe(n){const e=n.length;let i,a;if(e<2)return!1;for(a=n[0],i=1;i<e;++i)if(n[i]-n[i-1]!==a)return!1;return a}const mRe=n=>n==="left"?"right":n==="right"?"left":n,CH=(n,e,i)=>e==="top"||e==="left"?n[e]+i:n[e]-i,PH=(n,e)=>Math.min(e||n,n);function IH(n,e){const i=[],a=n.length/e,s=n.length;let l=0;for(;l<s;l+=a)i.push(n[Math.floor(l)]);return i}function gRe(n,e,i){const a=n.ticks.length,s=Math.min(e,a-1),l=n._startPixel,d=n._endPixel,f=1e-6;let p=n.getPixelForTick(s),y;if(!(i&&(a===1?y=Math.max(p-l,d-p):e===0?y=(n.getPixelForTick(1)-p)/2:y=(p-n.getPixelForTick(s-1))/2,p+=s<e?y:-y,p<l-f||p>d+f)))return p}function yRe(n,e){Gr(n,i=>{const a=i.gc,s=a.length/2;let l;if(s>e){for(l=0;l<s;++l)delete i.data[a[l]];a.splice(0,s)}})}function Fx(n){return n.drawTicks?n.tickLength:0}function RH(n,e){if(!n.display)return 0;const i=zo(n.font,e),a=Ps(n.padding);return(ha(n.text)?n.text.length:1)*i.lineHeight+a.height}function vRe(n,e){return Wp(n,{scale:e,type:"scale"})}function _Re(n,e,i){return Wp(n,{tick:i,index:e,type:"tick"})}function xRe(n,e,i){let a=uO(n);return(i&&e!=="right"||!i&&e==="right")&&(a=mRe(a)),a}function bRe(n,e,i,a){const{top:s,left:l,bottom:d,right:f,chart:p}=n,{chartArea:y,scales:_}=p;let b=0,S,A,P;const L=d-s,k=f-l;if(n.isHorizontal()){if(A=bs(a,l,f),ir(i)){const R=Object.keys(i)[0],z=i[R];P=_[R].getPixelForValue(z)+L-e}else i==="center"?P=(y.bottom+y.top)/2+L-e:P=CH(n,i,e);S=f-l}else{if(ir(i)){const R=Object.keys(i)[0],z=i[R];A=_[R].getPixelForValue(z)-k+e}else i==="center"?A=(y.left+y.right)/2-k+e:A=CH(n,i,e);P=bs(a,d,s),b=i==="left"?-ho:ho}return{titleX:A,titleY:P,maxWidth:S,rotation:b}}class ly extends Qh{constructor(e){super(),this.id=e.id,this.type=e.type,this.options=void 0,this.ctx=e.ctx,this.chart=e.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(e){this.options=e.setContext(this.getContext()),this.axis=e.axis,this._userMin=this.parse(e.min),this._userMax=this.parse(e.max),this._suggestedMin=this.parse(e.suggestedMin),this._suggestedMax=this.parse(e.suggestedMax)}parse(e,i){return e}getUserBounds(){let{_userMin:e,_userMax:i,_suggestedMin:a,_suggestedMax:s}=this;return e=jl(e,Number.POSITIVE_INFINITY),i=jl(i,Number.NEGATIVE_INFINITY),a=jl(a,Number.POSITIVE_INFINITY),s=jl(s,Number.NEGATIVE_INFINITY),{min:jl(e,a),max:jl(i,s),minDefined:Ka(e),maxDefined:Ka(i)}}getMinMax(e){let{min:i,max:a,minDefined:s,maxDefined:l}=this.getUserBounds(),d;if(s&&l)return{min:i,max:a};const f=this.getMatchingVisibleMetas();for(let p=0,y=f.length;p<y;++p)d=f[p].controller.getMinMax(this,e),s||(i=Math.min(i,d.min)),l||(a=Math.max(a,d.max));return i=l&&i>a?a:i,a=s&&i>a?i:a,{min:jl(i,jl(a,i)),max:jl(a,jl(i,a))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const e=this.chart.data;return this.options.labels||(this.isHorizontal()?e.xLabels:e.yLabels)||e.labels||[]}getLabelItems(e=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(e))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){aa(this.options.beforeUpdate,[this])}update(e,i,a){const{beginAtZero:s,grace:l,ticks:d}=this.options,f=d.sampleSize;this.beforeUpdate(),this.maxWidth=e,this.maxHeight=i,this._margins=a=Object.assign({left:0,right:0,top:0,bottom:0},a),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+a.left+a.right:this.height+a.top+a.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=IPe(this,l,s),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const p=f<this.ticks.length;this._convertTicksToLabels(p?IH(this.ticks,f):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),d.display&&(d.autoSkip||d.source==="auto")&&(this.ticks=cRe(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),p&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let e=this.options.reverse,i,a;this.isHorizontal()?(i=this.left,a=this.right):(i=this.top,a=this.bottom,e=!e),this._startPixel=i,this._endPixel=a,this._reversePixels=e,this._length=a-i,this._alignToPixels=this.options.alignToPixels}afterUpdate(){aa(this.options.afterUpdate,[this])}beforeSetDimensions(){aa(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){aa(this.options.afterSetDimensions,[this])}_callHooks(e){this.chart.notifyPlugins(e,this.getContext()),aa(this.options[e],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){aa(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(e){const i=this.options.ticks;let a,s,l;for(a=0,s=e.length;a<s;a++)l=e[a],l.label=aa(i.callback,[l.value,a,e],this)}afterTickToLabelConversion(){aa(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){aa(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const e=this.options,i=e.ticks,a=PH(this.ticks.length,e.ticks.maxTicksLimit),s=i.minRotation||0,l=i.maxRotation;let d=s,f,p,y;if(!this._isVisible()||!i.display||s>=l||a<=1||!this.isHorizontal()){this.labelRotation=s;return}const _=this._getLabelSizes(),b=_.widest.width,S=_.highest.height,A=Go(this.chart.width-b,0,this.maxWidth);f=e.offset?this.maxWidth/a:A/(a-1),b+6>f&&(f=A/(a-(e.offset?.5:1)),p=this.maxHeight-Fx(e.grid)-i.padding-RH(e.title,this.chart.options.font),y=Math.sqrt(b*b+S*S),d=lO(Math.min(Math.asin(Go((_.highest.height+6)/f,-1,1)),Math.asin(Go(p/y,-1,1))-Math.asin(Go(S/y,-1,1)))),d=Math.max(s,Math.min(l,d))),this.labelRotation=d}afterCalculateLabelRotation(){aa(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){aa(this.options.beforeFit,[this])}fit(){const e={width:0,height:0},{chart:i,options:{ticks:a,title:s,grid:l}}=this,d=this._isVisible(),f=this.isHorizontal();if(d){const p=RH(s,i.options.font);if(f?(e.width=this.maxWidth,e.height=Fx(l)+p):(e.height=this.maxHeight,e.width=Fx(l)+p),a.display&&this.ticks.length){const{first:y,last:_,widest:b,highest:S}=this._getLabelSizes(),A=a.padding*2,P=gu(this.labelRotation),L=Math.cos(P),k=Math.sin(P);if(f){const R=a.mirror?0:k*b.width+L*S.height;e.height=Math.min(this.maxHeight,e.height+R+A)}else{const R=a.mirror?0:L*b.width+k*S.height;e.width=Math.min(this.maxWidth,e.width+R+A)}this._calculatePadding(y,_,k,L)}}this._handleMargins(),f?(this.width=this._length=i.width-this._margins.left-this._margins.right,this.height=e.height):(this.width=e.width,this.height=this._length=i.height-this._margins.top-this._margins.bottom)}_calculatePadding(e,i,a,s){const{ticks:{align:l,padding:d},position:f}=this.options,p=this.labelRotation!==0,y=f!=="top"&&this.axis==="x";if(this.isHorizontal()){const _=this.getPixelForTick(0)-this.left,b=this.right-this.getPixelForTick(this.ticks.length-1);let S=0,A=0;p?y?(S=s*e.width,A=a*i.height):(S=a*e.height,A=s*i.width):l==="start"?A=i.width:l==="end"?S=e.width:l!=="inner"&&(S=e.width/2,A=i.width/2),this.paddingLeft=Math.max((S-_+d)*this.width/(this.width-_),0),this.paddingRight=Math.max((A-b+d)*this.width/(this.width-b),0)}else{let _=i.height/2,b=e.height/2;l==="start"?(_=0,b=e.height):l==="end"&&(_=i.height,b=0),this.paddingTop=_+d,this.paddingBottom=b+d}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){aa(this.options.afterFit,[this])}isHorizontal(){const{axis:e,position:i}=this.options;return i==="top"||i==="bottom"||e==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(e){this.beforeTickToLabelConversion(),this.generateTickLabels(e);let i,a;for(i=0,a=e.length;i<a;i++)mr(e[i].label)&&(e.splice(i,1),a--,i--);this.afterTickToLabelConversion()}_getLabelSizes(){let e=this._labelSizes;if(!e){const i=this.options.ticks.sampleSize;let a=this.ticks;i<a.length&&(a=IH(a,i)),this._labelSizes=e=this._computeLabelSizes(a,a.length,this.options.ticks.maxTicksLimit)}return e}_computeLabelSizes(e,i,a){const{ctx:s,_longestTextCache:l}=this,d=[],f=[],p=Math.floor(i/PH(i,a));let y=0,_=0,b,S,A,P,L,k,R,z,O,F,H;for(b=0;b<i;b+=p){if(P=e[b].label,L=this._resolveTickFontOptions(b),s.font=k=L.string,R=l[k]=l[k]||{data:{},gc:[]},z=L.lineHeight,O=F=0,!mr(P)&&!ha(P))O=MT(s,R.data,R.gc,O,P),F=z;else if(ha(P))for(S=0,A=P.length;S<A;++S)H=P[S],!mr(H)&&!ha(H)&&(O=MT(s,R.data,R.gc,O,H),F+=z);d.push(O),f.push(F),y=Math.max(O,y),_=Math.max(F,_)}yRe(l,i);const $=d.indexOf(y),Y=f.indexOf(_),te=G=>({width:d[G]||0,height:f[G]||0});return{first:te(0),last:te(i-1),widest:te($),highest:te(Y),widths:d,heights:f}}getLabelForValue(e){return e}getPixelForValue(e,i){return NaN}getValueForPixel(e){}getPixelForTick(e){const i=this.ticks;return e<0||e>i.length-1?null:this.getPixelForValue(i[e].value)}getPixelForDecimal(e){this._reversePixels&&(e=1-e);const i=this._startPixel+e*this._length;return aPe(this._alignToPixels?eg(this.chart,i,0):i)}getDecimalForPixel(e){const i=(e-this._startPixel)/this._length;return this._reversePixels?1-i:i}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:e,max:i}=this;return e<0&&i<0?i:e>0&&i>0?e:0}getContext(e){const i=this.ticks||[];if(e>=0&&e<i.length){const a=i[e];return a.$context||(a.$context=_Re(this.getContext(),e,a))}return this.$context||(this.$context=vRe(this.chart.getContext(),this))}_tickSize(){const e=this.options.ticks,i=gu(this.labelRotation),a=Math.abs(Math.cos(i)),s=Math.abs(Math.sin(i)),l=this._getLabelSizes(),d=e.autoSkipPadding||0,f=l?l.widest.width+d:0,p=l?l.highest.height+d:0;return this.isHorizontal()?p*a>f*s?f/a:p/s:p*s<f*a?p/a:f/s}_isVisible(){const e=this.options.display;return e!=="auto"?!!e:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(e){const i=this.axis,a=this.chart,s=this.options,{grid:l,position:d,border:f}=s,p=l.offset,y=this.isHorizontal(),b=this.ticks.length+(p?1:0),S=Fx(l),A=[],P=f.setContext(this.getContext()),L=P.display?P.width:0,k=L/2,R=function(Re){return eg(a,Re,L)};let z,O,F,H,$,Y,te,G,Q,he,pe,ye;if(d==="top")z=R(this.bottom),Y=this.bottom-S,G=z-k,he=R(e.top)+k,ye=e.bottom;else if(d==="bottom")z=R(this.top),he=e.top,ye=R(e.bottom)-k,Y=z+k,G=this.top+S;else if(d==="left")z=R(this.right),$=this.right-S,te=z-k,Q=R(e.left)+k,pe=e.right;else if(d==="right")z=R(this.left),Q=e.left,pe=R(e.right)-k,$=z+k,te=this.left+S;else if(i==="x"){if(d==="center")z=R((e.top+e.bottom)/2+.5);else if(ir(d)){const Re=Object.keys(d)[0],Be=d[Re];z=R(this.chart.scales[Re].getPixelForValue(Be))}he=e.top,ye=e.bottom,Y=z+k,G=Y+S}else if(i==="y"){if(d==="center")z=R((e.left+e.right)/2);else if(ir(d)){const Re=Object.keys(d)[0],Be=d[Re];z=R(this.chart.scales[Re].getPixelForValue(Be))}$=z-k,te=$-S,Q=e.left,pe=e.right}const fe=Ui(s.ticks.maxTicksLimit,b),Ae=Math.max(1,Math.ceil(b/fe));for(O=0;O<b;O+=Ae){const Re=this.getContext(O),Be=l.setContext(Re),le=f.setContext(Re),me=Be.lineWidth,we=Be.color,re=le.dash||[],Te=le.dashOffset,Je=Be.tickWidth,Xe=Be.tickColor,Ze=Be.tickBorderDash||[],Fe=Be.tickBorderDashOffset;F=gRe(this,O,p),F!==void 0&&(H=eg(a,F,me),y?$=te=Q=pe=H:Y=G=he=ye=H,A.push({tx1:$,ty1:Y,tx2:te,ty2:G,x1:Q,y1:he,x2:pe,y2:ye,width:me,color:we,borderDash:re,borderDashOffset:Te,tickWidth:Je,tickColor:Xe,tickBorderDash:Ze,tickBorderDashOffset:Fe}))}return this._ticksLength=b,this._borderValue=z,A}_computeLabelItems(e){const i=this.axis,a=this.options,{position:s,ticks:l}=a,d=this.isHorizontal(),f=this.ticks,{align:p,crossAlign:y,padding:_,mirror:b}=l,S=Fx(a.grid),A=S+_,P=b?-_:A,L=-gu(this.labelRotation),k=[];let R,z,O,F,H,$,Y,te,G,Q,he,pe,ye="middle";if(s==="top")$=this.bottom-P,Y=this._getXAxisLabelAlignment();else if(s==="bottom")$=this.top+P,Y=this._getXAxisLabelAlignment();else if(s==="left"){const Ae=this._getYAxisLabelAlignment(S);Y=Ae.textAlign,H=Ae.x}else if(s==="right"){const Ae=this._getYAxisLabelAlignment(S);Y=Ae.textAlign,H=Ae.x}else if(i==="x"){if(s==="center")$=(e.top+e.bottom)/2+A;else if(ir(s)){const Ae=Object.keys(s)[0],Re=s[Ae];$=this.chart.scales[Ae].getPixelForValue(Re)+A}Y=this._getXAxisLabelAlignment()}else if(i==="y"){if(s==="center")H=(e.left+e.right)/2-A;else if(ir(s)){const Ae=Object.keys(s)[0],Re=s[Ae];H=this.chart.scales[Ae].getPixelForValue(Re)}Y=this._getYAxisLabelAlignment(S).textAlign}i==="y"&&(p==="start"?ye="top":p==="end"&&(ye="bottom"));const fe=this._getLabelSizes();for(R=0,z=f.length;R<z;++R){O=f[R],F=O.label;const Ae=l.setContext(this.getContext(R));te=this.getPixelForTick(R)+l.labelOffset,G=this._resolveTickFontOptions(R),Q=G.lineHeight,he=ha(F)?F.length:1;const Re=he/2,Be=Ae.color,le=Ae.textStrokeColor,me=Ae.textStrokeWidth;let we=Y;d?(H=te,Y==="inner"&&(R===z-1?we=this.options.reverse?"left":"right":R===0?we=this.options.reverse?"right":"left":we="center"),s==="top"?y==="near"||L!==0?pe=-he*Q+Q/2:y==="center"?pe=-fe.highest.height/2-Re*Q+Q:pe=-fe.highest.height+Q/2:y==="near"||L!==0?pe=Q/2:y==="center"?pe=fe.highest.height/2-Re*Q:pe=fe.highest.height-he*Q,b&&(pe*=-1),L!==0&&!Ae.showLabelBackdrop&&(H+=Q/2*Math.sin(L))):($=te,pe=(1-he)*Q/2);let re;if(Ae.showLabelBackdrop){const Te=Ps(Ae.backdropPadding),Je=fe.heights[R],Xe=fe.widths[R];let Ze=pe-Te.top,Fe=0-Te.left;switch(ye){case"middle":Ze-=Je/2;break;case"bottom":Ze-=Je;break}switch(Y){case"center":Fe-=Xe/2;break;case"right":Fe-=Xe;break}re={left:Fe,top:Ze,width:Xe+Te.width,height:Je+Te.height,color:Ae.backdropColor}}k.push({label:F,font:G,textOffset:pe,options:{rotation:L,color:Be,strokeColor:le,strokeWidth:me,textAlign:we,textBaseline:ye,translation:[H,$],backdrop:re}})}return k}_getXAxisLabelAlignment(){const{position:e,ticks:i}=this.options;if(-gu(this.labelRotation))return e==="top"?"left":"right";let s="center";return i.align==="start"?s="left":i.align==="end"?s="right":i.align==="inner"&&(s="inner"),s}_getYAxisLabelAlignment(e){const{position:i,ticks:{crossAlign:a,mirror:s,padding:l}}=this.options,d=this._getLabelSizes(),f=e+l,p=d.widest.width;let y,_;return i==="left"?s?(_=this.right+l,a==="near"?y="left":a==="center"?(y="center",_+=p/2):(y="right",_+=p)):(_=this.right-f,a==="near"?y="right":a==="center"?(y="center",_-=p/2):(y="left",_=this.left)):i==="right"?s?(_=this.left+l,a==="near"?y="right":a==="center"?(y="center",_-=p/2):(y="left",_-=p)):(_=this.left+f,a==="near"?y="left":a==="center"?(y="center",_+=p/2):(y="right",_=this.right)):y="right",{textAlign:y,x:_}}_computeLabelArea(){if(this.options.ticks.mirror)return;const e=this.chart,i=this.options.position;if(i==="left"||i==="right")return{top:0,left:this.left,bottom:e.height,right:this.right};if(i==="top"||i==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:e.width}}drawBackground(){const{ctx:e,options:{backgroundColor:i},left:a,top:s,width:l,height:d}=this;i&&(e.save(),e.fillStyle=i,e.fillRect(a,s,l,d),e.restore())}getLineWidthForValue(e){const i=this.options.grid;if(!this._isVisible()||!i.display)return 0;const s=this.ticks.findIndex(l=>l.value===e);return s>=0?i.setContext(this.getContext(s)).lineWidth:0}drawGrid(e){const i=this.options.grid,a=this.ctx,s=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(e));let l,d;const f=(p,y,_)=>{!_.width||!_.color||(a.save(),a.lineWidth=_.width,a.strokeStyle=_.color,a.setLineDash(_.borderDash||[]),a.lineDashOffset=_.borderDashOffset,a.beginPath(),a.moveTo(p.x,p.y),a.lineTo(y.x,y.y),a.stroke(),a.restore())};if(i.display)for(l=0,d=s.length;l<d;++l){const p=s[l];i.drawOnChartArea&&f({x:p.x1,y:p.y1},{x:p.x2,y:p.y2},p),i.drawTicks&&f({x:p.tx1,y:p.ty1},{x:p.tx2,y:p.ty2},{color:p.tickColor,width:p.tickWidth,borderDash:p.tickBorderDash,borderDashOffset:p.tickBorderDashOffset})}}drawBorder(){const{chart:e,ctx:i,options:{border:a,grid:s}}=this,l=a.setContext(this.getContext()),d=a.display?l.width:0;if(!d)return;const f=s.setContext(this.getContext(0)).lineWidth,p=this._borderValue;let y,_,b,S;this.isHorizontal()?(y=eg(e,this.left,d)-d/2,_=eg(e,this.right,f)+f/2,b=S=p):(b=eg(e,this.top,d)-d/2,S=eg(e,this.bottom,f)+f/2,y=_=p),i.save(),i.lineWidth=l.width,i.strokeStyle=l.color,i.beginPath(),i.moveTo(y,b),i.lineTo(_,S),i.stroke(),i.restore()}drawLabels(e){if(!this.options.ticks.display)return;const a=this.ctx,s=this._computeLabelArea();s&&MC(a,s);const l=this.getLabelItems(e);for(const d of l){const f=d.options,p=d.font,y=d.label,_=d.textOffset;Kg(a,y,0,_,p,f)}s&&TC(a)}drawTitle(){const{ctx:e,options:{position:i,title:a,reverse:s}}=this;if(!a.display)return;const l=zo(a.font),d=Ps(a.padding),f=a.align;let p=l.lineHeight/2;i==="bottom"||i==="center"||ir(i)?(p+=d.bottom,ha(a.text)&&(p+=l.lineHeight*(a.text.length-1))):p+=d.top;const{titleX:y,titleY:_,maxWidth:b,rotation:S}=bRe(this,p,i,f);Kg(e,a.text,0,0,l,{color:a.color,maxWidth:b,rotation:S,textAlign:xRe(f,i,s),textBaseline:"middle",translation:[y,_]})}draw(e){this._isVisible()&&(this.drawBackground(),this.drawGrid(e),this.drawBorder(),this.drawTitle(),this.drawLabels(e))}_layers(){const e=this.options,i=e.ticks&&e.ticks.z||0,a=Ui(e.grid&&e.grid.z,-1),s=Ui(e.border&&e.border.z,0);return!this._isVisible()||this.draw!==ly.prototype.draw?[{z:i,draw:l=>{this.draw(l)}}]:[{z:a,draw:l=>{this.drawBackground(),this.drawGrid(l),this.drawTitle()}},{z:s,draw:()=>{this.drawBorder()}},{z:i,draw:l=>{this.drawLabels(l)}}]}getMatchingVisibleMetas(e){const i=this.chart.getSortedVisibleDatasetMetas(),a=this.axis+"AxisID",s=[];let l,d;for(l=0,d=i.length;l<d;++l){const f=i[l];f[a]===this.id&&(!e||f.type===e)&&s.push(f)}return s}_resolveTickFontOptions(e){const i=this.options.ticks.setContext(this.getContext(e));return zo(i.font)}_maxDigits(){const e=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/e}}class OE{constructor(e,i,a){this.type=e,this.scope=i,this.override=a,this.items=Object.create(null)}isForType(e){return Object.prototype.isPrototypeOf.call(this.type.prototype,e.prototype)}register(e){const i=Object.getPrototypeOf(e);let a;ERe(i)&&(a=this.register(i));const s=this.items,l=e.id,d=this.scope+"."+l;if(!l)throw new Error("class does not have id: "+e);return l in s||(s[l]=e,wRe(e,d,a),this.override&&Ja.override(e.id,e.overrides)),d}get(e){return this.items[e]}unregister(e){const i=this.items,a=e.id,s=this.scope;a in i&&delete i[a],s&&a in Ja[s]&&(delete Ja[s][a],this.override&&delete Zg[a])}}function wRe(n,e,i){const a=Iw(Object.create(null),[i?Ja.get(i):{},Ja.get(e),n.defaults]);Ja.set(e,a),n.defaultRoutes&&SRe(e,n.defaultRoutes),n.descriptors&&Ja.describe(e,n.descriptors)}function SRe(n,e){Object.keys(e).forEach(i=>{const a=i.split("."),s=a.pop(),l=[n].concat(a).join("."),d=e[i].split("."),f=d.pop(),p=d.join(".");Ja.route(l,s,p,f)})}function ERe(n){return"id"in n&&"defaults"in n}class MRe{constructor(){this.controllers=new OE(_u,"datasets",!0),this.elements=new OE(Qh,"elements"),this.plugins=new OE(Object,"plugins"),this.scales=new OE(ly,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...e){this._each("register",e)}remove(...e){this._each("unregister",e)}addControllers(...e){this._each("register",e,this.controllers)}addElements(...e){this._each("register",e,this.elements)}addPlugins(...e){this._each("register",e,this.plugins)}addScales(...e){this._each("register",e,this.scales)}getController(e){return this._get(e,this.controllers,"controller")}getElement(e){return this._get(e,this.elements,"element")}getPlugin(e){return this._get(e,this.plugins,"plugin")}getScale(e){return this._get(e,this.scales,"scale")}removeControllers(...e){this._each("unregister",e,this.controllers)}removeElements(...e){this._each("unregister",e,this.elements)}removePlugins(...e){this._each("unregister",e,this.plugins)}removeScales(...e){this._each("unregister",e,this.scales)}_each(e,i,a){[...i].forEach(s=>{const l=a||this._getRegistryForType(s);a||l.isForType(s)||l===this.plugins&&s.id?this._exec(e,l,s):Gr(s,d=>{const f=a||this._getRegistryForType(d);this._exec(e,f,d)})})}_exec(e,i,a){const s=sO(e);aa(a["before"+s],[],a),i[e](a),aa(a["after"+s],[],a)}_getRegistryForType(e){for(let i=0;i<this._typedRegistries.length;i++){const a=this._typedRegistries[i];if(a.isForType(e))return a}return this.plugins}_get(e,i,a){const s=i.get(e);if(s===void 0)throw new Error('"'+e+'" is not a registered '+a+".");return s}}var cd=new MRe;class TRe{constructor(){this._init=[]}notify(e,i,a,s){i==="beforeInit"&&(this._init=this._createDescriptors(e,!0),this._notify(this._init,e,"install"));const l=s?this._descriptors(e).filter(s):this._descriptors(e),d=this._notify(l,e,i,a);return i==="afterDestroy"&&(this._notify(l,e,"stop"),this._notify(this._init,e,"uninstall")),d}_notify(e,i,a,s){s=s||{};for(const l of e){const d=l.plugin,f=d[a],p=[i,s,l.options];if(aa(f,p,d)===!1&&s.cancelable)return!1}return!0}invalidate(){mr(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(e){if(this._cache)return this._cache;const i=this._cache=this._createDescriptors(e);return this._notifyStateChanges(e),i}_createDescriptors(e,i){const a=e&&e.config,s=Ui(a.options&&a.options.plugins,{}),l=ARe(a);return s===!1&&!i?[]:PRe(e,l,s,i)}_notifyStateChanges(e){const i=this._oldCache||[],a=this._cache,s=(l,d)=>l.filter(f=>!d.some(p=>f.plugin.id===p.plugin.id));this._notify(s(i,a),e,"stop"),this._notify(s(a,i),e,"start")}}function ARe(n){const e={},i=[],a=Object.keys(cd.plugins.items);for(let l=0;l<a.length;l++)i.push(cd.getPlugin(a[l]));const s=n.plugins||[];for(let l=0;l<s.length;l++){const d=s[l];i.indexOf(d)===-1&&(i.push(d),e[d.id]=!0)}return{plugins:i,localIds:e}}function CRe(n,e){return!e&&n===!1?null:n===!0?{}:n}function PRe(n,{plugins:e,localIds:i},a,s){const l=[],d=n.getContext();for(const f of e){const p=f.id,y=CRe(a[p],s);y!==null&&l.push({plugin:f,options:IRe(n.config,{plugin:f,local:i[p]},y,d)})}return l}function IRe(n,{plugin:e,local:i},a,s){const l=n.pluginScopeKeys(e),d=n.getOptionScopes(a,l);return i&&e.defaults&&d.push(e.defaults),n.createResolver(d,s,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function cD(n,e){const i=Ja.datasets[n]||{};return((e.datasets||{})[n]||{}).indexAxis||e.indexAxis||i.indexAxis||"x"}function RRe(n,e){let i=n;return n==="_index_"?i=e:n==="_value_"&&(i=e==="x"?"y":"x"),i}function LRe(n,e){return n===e?"_index_":"_value_"}function LH(n){if(n==="x"||n==="y"||n==="r")return n}function kRe(n){if(n==="top"||n==="bottom")return"x";if(n==="left"||n==="right")return"y"}function uD(n,...e){if(LH(n))return n;for(const i of e){const a=i.axis||kRe(i.position)||n.length>1&&LH(n[0].toLowerCase());if(a)return a}throw new Error(`Cannot determine type of '${n}' axis. Please provide 'axis' or 'position' option.`)}function kH(n,e,i){if(i[e+"AxisID"]===n)return{axis:e}}function DRe(n,e){if(e.data&&e.data.datasets){const i=e.data.datasets.filter(a=>a.xAxisID===n||a.yAxisID===n);if(i.length)return kH(n,"x",i[0])||kH(n,"y",i[0])}return{}}function zRe(n,e){const i=Zg[n.type]||{scales:{}},a=e.scales||{},s=cD(n.type,e),l=Object.create(null);return Object.keys(a).forEach(d=>{const f=a[d];if(!ir(f))return console.error(`Invalid scale configuration for scale: ${d}`);if(f._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${d}`);const p=uD(d,f,DRe(d,n),Ja.scales[f.type]),y=LRe(p,s),_=i.scales||{};l[d]=Ab(Object.create(null),[{axis:p},f,_[p],_[y]])}),n.data.datasets.forEach(d=>{const f=d.type||n.type,p=d.indexAxis||cD(f,e),_=(Zg[f]||{}).scales||{};Object.keys(_).forEach(b=>{const S=RRe(b,p),A=d[S+"AxisID"]||S;l[A]=l[A]||Object.create(null),Ab(l[A],[{axis:S},a[A],_[b]])})}),Object.keys(l).forEach(d=>{const f=l[d];Ab(f,[Ja.scales[f.type],Ja.scale])}),l}function mQ(n){const e=n.options||(n.options={});e.plugins=Ui(e.plugins,{}),e.scales=zRe(n,e)}function gQ(n){return n=n||{},n.datasets=n.datasets||[],n.labels=n.labels||[],n}function ORe(n){return n=n||{},n.data=gQ(n.data),mQ(n),n}const DH=new Map,yQ=new Set;function NE(n,e){let i=DH.get(n);return i||(i=e(),DH.set(n,i),yQ.add(i)),i}const Bx=(n,e,i)=>{const a=Ip(e,i);a!==void 0&&n.add(a)};class NRe{constructor(e){this._config=ORe(e),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(e){this._config.type=e}get data(){return this._config.data}set data(e){this._config.data=gQ(e)}get options(){return this._config.options}set options(e){this._config.options=e}get plugins(){return this._config.plugins}update(){const e=this._config;this.clearCache(),mQ(e)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(e){return NE(e,()=>[[`datasets.${e}`,""]])}datasetAnimationScopeKeys(e,i){return NE(`${e}.transition.${i}`,()=>[[`datasets.${e}.transitions.${i}`,`transitions.${i}`],[`datasets.${e}`,""]])}datasetElementScopeKeys(e,i){return NE(`${e}-${i}`,()=>[[`datasets.${e}.elements.${i}`,`datasets.${e}`,`elements.${i}`,""]])}pluginScopeKeys(e){const i=e.id,a=this.type;return NE(`${a}-plugin-${i}`,()=>[[`plugins.${i}`,...e.additionalOptionScopes||[]]])}_cachedScopes(e,i){const a=this._scopeCache;let s=a.get(e);return(!s||i)&&(s=new Map,a.set(e,s)),s}getOptionScopes(e,i,a){const{options:s,type:l}=this,d=this._cachedScopes(e,a),f=d.get(i);if(f)return f;const p=new Set;i.forEach(_=>{e&&(p.add(e),_.forEach(b=>Bx(p,e,b))),_.forEach(b=>Bx(p,s,b)),_.forEach(b=>Bx(p,Zg[l]||{},b)),_.forEach(b=>Bx(p,Ja,b)),_.forEach(b=>Bx(p,oD,b))});const y=Array.from(p);return y.length===0&&y.push(Object.create(null)),yQ.has(i)&&d.set(i,y),y}chartOptionScopes(){const{options:e,type:i}=this;return[e,Zg[i]||{},Ja.datasets[i]||{},{type:i},Ja,oD]}resolveNamedOptions(e,i,a,s=[""]){const l={$shared:!0},{resolver:d,subPrefixes:f}=zH(this._resolverCache,e,s);let p=d;if(BRe(d,i)){l.$shared=!1,a=Rp(a)?a():a;const y=this.createResolver(e,a,f);p=E_(d,a,y)}for(const y of i)l[y]=p[y];return l}createResolver(e,i,a=[""],s){const{resolver:l}=zH(this._resolverCache,e,a);return ir(i)?E_(l,i,void 0,s):l}}function zH(n,e,i){let a=n.get(e);a||(a=new Map,n.set(e,a));const s=i.join();let l=a.get(s);return l||(l={resolver:fO(e,i),subPrefixes:i.filter(f=>!f.toLowerCase().includes("hover"))},a.set(s,l)),l}const FRe=n=>ir(n)&&Object.getOwnPropertyNames(n).reduce((e,i)=>e||Rp(n[i]),!1);function BRe(n,e){const{isScriptable:i,isIndexable:a}=XJ(n);for(const s of e){const l=i(s),d=a(s),f=(d||l)&&n[s];if(l&&(Rp(f)||FRe(f))||d&&ha(f))return!0}return!1}var URe="4.4.0";const WRe=["top","bottom","left","right","chartArea"];function OH(n,e){return n==="top"||n==="bottom"||WRe.indexOf(n)===-1&&e==="x"}function NH(n,e){return function(i,a){return i[n]===a[n]?i[e]-a[e]:i[n]-a[n]}}function FH(n){const e=n.chart,i=e.options.animation;e.notifyPlugins("afterRender"),aa(i&&i.onComplete,[n],e)}function VRe(n){const e=n.chart,i=e.options.animation;aa(i&&i.onProgress,[n],e)}function vQ(n){return tQ()&&typeof n=="string"?n=document.getElementById(n):n&&n.length&&(n=n[0]),n&&n.canvas&&(n=n.canvas),n}const TM={},BH=n=>{const e=vQ(n);return Object.values(TM).filter(i=>i.canvas===e).pop()};function GRe(n,e,i){const a=Object.keys(n);for(const s of a){const l=+s;if(l>=e){const d=n[s];delete n[s],(i>0||l>e)&&(n[l+i]=d)}}}function HRe(n,e,i,a){return!i||n.type==="mouseout"?null:a?e:n}function FE(n,e,i){return n.options.clip?n[i]:e[i]}function jRe(n,e){const{xScale:i,yScale:a}=n;return i&&a?{left:FE(i,e,"left"),right:FE(i,e,"right"),top:FE(a,e,"top"),bottom:FE(a,e,"bottom")}:e}var Xf;let CC=(Xf=class{static register(...e){cd.add(...e),UH()}static unregister(...e){cd.remove(...e),UH()}constructor(e,i){const a=this.config=new NRe(i),s=vQ(e),l=BH(s);if(l)throw new Error("Canvas is already in use. Chart with ID '"+l.id+"' must be destroyed before the canvas with ID '"+l.canvas.id+"' can be reused.");const d=a.createResolver(a.chartOptionScopes(),this.getContext());this.platform=new(a.platform||lRe(s)),this.platform.updateConfig(a);const f=this.platform.acquireContext(s,d.aspectRatio),p=f&&f.canvas,y=p&&p.height,_=p&&p.width;if(this.id=YCe(),this.ctx=f,this.canvas=p,this.width=_,this.height=y,this._options=d,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new TRe,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=cPe(b=>this.update(b),d.resizeDelay||0),this._dataChanges=[],TM[this.id]=this,!f||!p){console.error("Failed to create chart: can't acquire context from the given item");return}Mh.listen(this,"complete",FH),Mh.listen(this,"progress",VRe),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:e,maintainAspectRatio:i},width:a,height:s,_aspectRatio:l}=this;return mr(e)?i&&l?l:s?a/s:null:e}get data(){return this.config.data}set data(e){this.config.data=e}get options(){return this._options}set options(e){this.config.options=e}get registry(){return cd}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():sH(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return rH(this.canvas,this.ctx),this}stop(){return Mh.stop(this),this}resize(e,i){Mh.running(this)?this._resizeBeforeDraw={width:e,height:i}:this._resize(e,i)}_resize(e,i){const a=this.options,s=this.canvas,l=a.maintainAspectRatio&&this.aspectRatio,d=this.platform.getMaximumSize(s,e,i,l),f=a.devicePixelRatio||this.platform.getDevicePixelRatio(),p=this.width?"resize":"attach";this.width=d.width,this.height=d.height,this._aspectRatio=this.aspectRatio,sH(this,f,!0)&&(this.notifyPlugins("resize",{size:d}),aa(a.onResize,[this,d],this),this.attached&&this._doResize(p)&&this.render())}ensureScalesHaveIDs(){const i=this.options.scales||{};Gr(i,(a,s)=>{a.id=s})}buildOrUpdateScales(){const e=this.options,i=e.scales,a=this.scales,s=Object.keys(a).reduce((d,f)=>(d[f]=!1,d),{});let l=[];i&&(l=l.concat(Object.keys(i).map(d=>{const f=i[d],p=uD(d,f),y=p==="r",_=p==="x";return{options:f,dposition:y?"chartArea":_?"bottom":"left",dtype:y?"radialLinear":_?"category":"linear"}}))),Gr(l,d=>{const f=d.options,p=f.id,y=uD(p,f),_=Ui(f.type,d.dtype);(f.position===void 0||OH(f.position,y)!==OH(d.dposition))&&(f.position=d.dposition),s[p]=!0;let b=null;if(p in a&&a[p].type===_)b=a[p];else{const S=cd.getScale(_);b=new S({id:p,type:_,ctx:this.ctx,chart:this}),a[b.id]=b}b.init(f,e)}),Gr(s,(d,f)=>{d||delete a[f]}),Gr(a,d=>{Es.configure(this,d,d.options),Es.addBox(this,d)})}_updateMetasets(){const e=this._metasets,i=this.data.datasets.length,a=e.length;if(e.sort((s,l)=>s.index-l.index),a>i){for(let s=i;s<a;++s)this._destroyDatasetMeta(s);e.splice(i,a-i)}this._sortedMetasets=e.slice(0).sort(NH("order","index"))}_removeUnreferencedMetasets(){const{_metasets:e,data:{datasets:i}}=this;e.length>i.length&&delete this._stacks,e.forEach((a,s)=>{i.filter(l=>l===a._dataset).length===0&&this._destroyDatasetMeta(s)})}buildOrUpdateControllers(){const e=[],i=this.data.datasets;let a,s;for(this._removeUnreferencedMetasets(),a=0,s=i.length;a<s;a++){const l=i[a];let d=this.getDatasetMeta(a);const f=l.type||this.config.type;if(d.type&&d.type!==f&&(this._destroyDatasetMeta(a),d=this.getDatasetMeta(a)),d.type=f,d.indexAxis=l.indexAxis||cD(f,this.options),d.order=l.order||0,d.index=a,d.label=""+l.label,d.visible=this.isDatasetVisible(a),d.controller)d.controller.updateIndex(a),d.controller.linkScales();else{const p=cd.getController(f),{datasetElementType:y,dataElementType:_}=Ja.datasets[f];Object.assign(p,{dataElementType:cd.getElement(_),datasetElementType:y&&cd.getElement(y)}),d.controller=new p(this,a),e.push(d.controller)}}return this._updateMetasets(),e}_resetElements(){Gr(this.data.datasets,(e,i)=>{this.getDatasetMeta(i).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(e){const i=this.config;i.update();const a=this._options=i.createResolver(i.chartOptionScopes(),this.getContext()),s=this._animationsDisabled=!a.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:e,cancelable:!0})===!1)return;const l=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let d=0;for(let y=0,_=this.data.datasets.length;y<_;y++){const{controller:b}=this.getDatasetMeta(y),S=!s&&l.indexOf(b)===-1;b.buildOrUpdateElements(S),d=Math.max(+b.getMaxOverflow(),d)}d=this._minPadding=a.layout.autoPadding?d:0,this._updateLayout(d),s||Gr(l,y=>{y.reset()}),this._updateDatasets(e),this.notifyPlugins("afterUpdate",{mode:e}),this._layers.sort(NH("z","_idx"));const{_active:f,_lastEvent:p}=this;p?this._eventHandler(p,!0):f.length&&this._updateHoverStyles(f,f,!0),this.render()}_updateScales(){Gr(this.scales,e=>{Es.removeBox(this,e)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const e=this.options,i=new Set(Object.keys(this._listeners)),a=new Set(e.events);(!XG(i,a)||!!this._responsiveListeners!==e.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:e}=this,i=this._getUniformDataChanges()||[];for(const{method:a,start:s,count:l}of i){const d=a==="_removeElements"?-l:l;GRe(e,s,d)}}_getUniformDataChanges(){const e=this._dataChanges;if(!e||!e.length)return;this._dataChanges=[];const i=this.data.datasets.length,a=l=>new Set(e.filter(d=>d[0]===l).map((d,f)=>f+","+d.splice(1).join(","))),s=a(0);for(let l=1;l<i;l++)if(!XG(s,a(l)))return;return Array.from(s).map(l=>l.split(",")).map(l=>({method:l[1],start:+l[2],count:+l[3]}))}_updateLayout(e){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;Es.update(this,this.width,this.height,e);const i=this.chartArea,a=i.width<=0||i.height<=0;this._layers=[],Gr(this.boxes,s=>{a&&s.position==="chartArea"||(s.configure&&s.configure(),this._layers.push(...s._layers()))},this),this._layers.forEach((s,l)=>{s._idx=l}),this.notifyPlugins("afterLayout")}_updateDatasets(e){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:e,cancelable:!0})!==!1){for(let i=0,a=this.data.datasets.length;i<a;++i)this.getDatasetMeta(i).controller.configure();for(let i=0,a=this.data.datasets.length;i<a;++i)this._updateDataset(i,Rp(e)?e({datasetIndex:i}):e);this.notifyPlugins("afterDatasetsUpdate",{mode:e})}}_updateDataset(e,i){const a=this.getDatasetMeta(e),s={meta:a,index:e,mode:i,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",s)!==!1&&(a.controller._update(i),s.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",s))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(Mh.has(this)?this.attached&&!Mh.running(this)&&Mh.start(this):(this.draw(),FH({chart:this})))}draw(){let e;if(this._resizeBeforeDraw){const{width:a,height:s}=this._resizeBeforeDraw;this._resize(a,s),this._resizeBeforeDraw=null}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const i=this._layers;for(e=0;e<i.length&&i[e].z<=0;++e)i[e].draw(this.chartArea);for(this._drawDatasets();e<i.length;++e)i[e].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(e){const i=this._sortedMetasets,a=[];let s,l;for(s=0,l=i.length;s<l;++s){const d=i[s];(!e||d.visible)&&a.push(d)}return a}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const e=this.getSortedVisibleDatasetMetas();for(let i=e.length-1;i>=0;--i)this._drawDataset(e[i]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(e){const i=this.ctx,a=e._clip,s=!a.disabled,l=jRe(e,this.chartArea),d={meta:e,index:e.index,cancelable:!0};this.notifyPlugins("beforeDatasetDraw",d)!==!1&&(s&&MC(i,{left:a.left===!1?0:l.left-a.left,right:a.right===!1?this.width:l.right+a.right,top:a.top===!1?0:l.top-a.top,bottom:a.bottom===!1?this.height:l.bottom+a.bottom}),e.controller.draw(),s&&TC(i),d.cancelable=!1,this.notifyPlugins("afterDatasetDraw",d))}isPointInArea(e){return Bh(e,this.chartArea,this._minPadding)}getElementsAtEventForMode(e,i,a,s){const l=WIe.modes[i];return typeof l=="function"?l(this,e,a,s):[]}getDatasetMeta(e){const i=this.data.datasets[e],a=this._metasets;let s=a.filter(l=>l&&l._dataset===i).pop();return s||(s={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:i&&i.order||0,index:e,_dataset:i,_parsed:[],_sorted:!1},a.push(s)),s}getContext(){return this.$context||(this.$context=Wp(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(e){const i=this.data.datasets[e];if(!i)return!1;const a=this.getDatasetMeta(e);return typeof a.hidden=="boolean"?!a.hidden:!i.hidden}setDatasetVisibility(e,i){const a=this.getDatasetMeta(e);a.hidden=!i}toggleDataVisibility(e){this._hiddenIndices[e]=!this._hiddenIndices[e]}getDataVisibility(e){return!this._hiddenIndices[e]}_updateVisibility(e,i,a){const s=a?"show":"hide",l=this.getDatasetMeta(e),d=l.controller._resolveAnimations(void 0,s);Rw(i)?(l.data[i].hidden=!a,this.update()):(this.setDatasetVisibility(e,a),d.update(l,{visible:a}),this.update(f=>f.datasetIndex===e?s:void 0))}hide(e,i){this._updateVisibility(e,i,!1)}show(e,i){this._updateVisibility(e,i,!0)}_destroyDatasetMeta(e){const i=this._metasets[e];i&&i.controller&&i.controller._destroy(),delete this._metasets[e]}_stop(){let e,i;for(this.stop(),Mh.remove(this),e=0,i=this.data.datasets.length;e<i;++e)this._destroyDatasetMeta(e)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:e,ctx:i}=this;this._stop(),this.config.clearCache(),e&&(this.unbindEvents(),rH(e,i),this.platform.releaseContext(i),this.canvas=null,this.ctx=null),delete TM[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...e){return this.canvas.toDataURL(...e)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const e=this._listeners,i=this.platform,a=(l,d)=>{i.addEventListener(this,l,d),e[l]=d},s=(l,d,f)=>{l.offsetX=d,l.offsetY=f,this._eventHandler(l)};Gr(this.options.events,l=>a(l,s))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const e=this._responsiveListeners,i=this.platform,a=(p,y)=>{i.addEventListener(this,p,y),e[p]=y},s=(p,y)=>{e[p]&&(i.removeEventListener(this,p,y),delete e[p])},l=(p,y)=>{this.canvas&&this.resize(p,y)};let d;const f=()=>{s("attach",f),this.attached=!0,this.resize(),a("resize",l),a("detach",d)};d=()=>{this.attached=!1,s("resize",l),this._stop(),this._resize(0,0),a("attach",f)},i.isAttached(this.canvas)?f():d()}unbindEvents(){Gr(this._listeners,(e,i)=>{this.platform.removeEventListener(this,i,e)}),this._listeners={},Gr(this._responsiveListeners,(e,i)=>{this.platform.removeEventListener(this,i,e)}),this._responsiveListeners=void 0}updateHoverStyle(e,i,a){const s=a?"set":"remove";let l,d,f,p;for(i==="dataset"&&(l=this.getDatasetMeta(e[0].datasetIndex),l.controller["_"+s+"DatasetHoverStyle"]()),f=0,p=e.length;f<p;++f){d=e[f];const y=d&&this.getDatasetMeta(d.datasetIndex).controller;y&&y[s+"HoverStyle"](d.element,d.datasetIndex,d.index)}}getActiveElements(){return this._active||[]}setActiveElements(e){const i=this._active||[],a=e.map(({datasetIndex:l,index:d})=>{const f=this.getDatasetMeta(l);if(!f)throw new Error("No dataset found at index "+l);return{datasetIndex:l,element:f.data[d],index:d}});!wT(a,i)&&(this._active=a,this._lastEvent=null,this._updateHoverStyles(a,i))}notifyPlugins(e,i,a){return this._plugins.notify(this,e,i,a)}isPluginEnabled(e){return this._plugins._cache.filter(i=>i.plugin.id===e).length===1}_updateHoverStyles(e,i,a){const s=this.options.hover,l=(p,y)=>p.filter(_=>!y.some(b=>_.datasetIndex===b.datasetIndex&&_.index===b.index)),d=l(i,e),f=a?e:l(e,i);d.length&&this.updateHoverStyle(d,s.mode,!1),f.length&&s.mode&&this.updateHoverStyle(f,s.mode,!0)}_eventHandler(e,i){const a={event:e,replay:i,cancelable:!0,inChartArea:this.isPointInArea(e)},s=d=>(d.options.events||this.options.events).includes(e.native.type);if(this.notifyPlugins("beforeEvent",a,s)===!1)return;const l=this._handleEvent(e,i,a.inChartArea);return a.cancelable=!1,this.notifyPlugins("afterEvent",a,s),(l||a.changed)&&this.render(),this}_handleEvent(e,i,a){const{_active:s=[],options:l}=this,d=i,f=this._getActiveElements(e,s,a,d),p=QCe(e),y=HRe(e,this._lastEvent,a,p);a&&(this._lastEvent=null,aa(l.onHover,[e,f,this],this),p&&aa(l.onClick,[e,f,this],this));const _=!wT(f,s);return(_||i)&&(this._active=f,this._updateHoverStyles(f,s,i)),this._lastEvent=y,_}_getActiveElements(e,i,a,s){if(e.type==="mouseout")return[];if(!a)return i;const l=this.options.hover;return this.getElementsAtEventForMode(e,l.mode,l,s)}},wn(Xf,"defaults",Ja),wn(Xf,"instances",TM),wn(Xf,"overrides",Zg),wn(Xf,"registry",cd),wn(Xf,"version",URe),wn(Xf,"getChart",BH),Xf);function UH(){return Gr(CC.instances,n=>n._plugins.invalidate())}function $Re(n,e,i){const{startAngle:a,pixelMargin:s,x:l,y:d,outerRadius:f,innerRadius:p}=e;let y=s/f;n.beginPath(),n.arc(l,d,f,a-y,i+y),p>s?(y=s/p,n.arc(l,d,p,i+y,a-y,!0)):n.arc(l,d,s,i+ho,a-ho),n.closePath(),n.clip()}function YRe(n){return hO(n,["outerStart","outerEnd","innerStart","innerEnd"])}function qRe(n,e,i,a){const s=YRe(n.options.borderRadius),l=(i-e)/2,d=Math.min(l,a*e/2),f=p=>{const y=(i-Math.min(l,p))*a/2;return Go(p,0,Math.min(l,y))};return{outerStart:f(s.outerStart),outerEnd:f(s.outerEnd),innerStart:Go(s.innerStart,0,d),innerEnd:Go(s.innerEnd,0,d)}}function g0(n,e,i,a){return{x:i+n*Math.cos(e),y:a+n*Math.sin(e)}}function CT(n,e,i,a,s,l){const{x:d,y:f,startAngle:p,pixelMargin:y,innerRadius:_}=e,b=Math.max(e.outerRadius+a+i-y,0),S=_>0?_+a+i+y:0;let A=0;const P=s-p;if(a){const Ae=_>0?_-a:0,Re=b>0?b-a:0,Be=(Ae+Re)/2,le=Be!==0?P*Be/(Be+a):P;A=(P-le)/2}const L=Math.max(.001,P*b-i/ma)/b,k=(P-L)/2,R=p+k+A,z=s-k-A,{outerStart:O,outerEnd:F,innerStart:H,innerEnd:$}=qRe(e,S,b,z-R),Y=b-O,te=b-F,G=R+O/Y,Q=z-F/te,he=S+H,pe=S+$,ye=R+H/he,fe=z-$/pe;if(n.beginPath(),l){const Ae=(G+Q)/2;if(n.arc(d,f,b,G,Ae),n.arc(d,f,b,Ae,Q),F>0){const me=g0(te,Q,d,f);n.arc(me.x,me.y,F,Q,z+ho)}const Re=g0(pe,z,d,f);if(n.lineTo(Re.x,Re.y),$>0){const me=g0(pe,fe,d,f);n.arc(me.x,me.y,$,z+ho,fe+Math.PI)}const Be=(z-$/S+(R+H/S))/2;if(n.arc(d,f,S,z-$/S,Be,!0),n.arc(d,f,S,Be,R+H/S,!0),H>0){const me=g0(he,ye,d,f);n.arc(me.x,me.y,H,ye+Math.PI,R-ho)}const le=g0(Y,R,d,f);if(n.lineTo(le.x,le.y),O>0){const me=g0(Y,G,d,f);n.arc(me.x,me.y,O,R-ho,G)}}else{n.moveTo(d,f);const Ae=Math.cos(G)*b+d,Re=Math.sin(G)*b+f;n.lineTo(Ae,Re);const Be=Math.cos(Q)*b+d,le=Math.sin(Q)*b+f;n.lineTo(Be,le)}n.closePath()}function XRe(n,e,i,a,s){const{fullCircles:l,startAngle:d,circumference:f}=e;let p=e.endAngle;if(l){CT(n,e,i,a,p,s);for(let y=0;y<l;++y)n.fill();isNaN(f)||(p=d+(f%pa||pa))}return CT(n,e,i,a,p,s),n.fill(),p}function ZRe(n,e,i,a,s){const{fullCircles:l,startAngle:d,circumference:f,options:p}=e,{borderWidth:y,borderJoinStyle:_,borderDash:b,borderDashOffset:S}=p,A=p.borderAlign==="inner";if(!y)return;n.setLineDash(b||[]),n.lineDashOffset=S,A?(n.lineWidth=y*2,n.lineJoin=_||"round"):(n.lineWidth=y,n.lineJoin=_||"bevel");let P=e.endAngle;if(l){CT(n,e,i,a,P,s);for(let L=0;L<l;++L)n.stroke();isNaN(f)||(P=d+(f%pa||pa))}A&&$Re(n,e,P),l||(CT(n,e,i,a,P,s),n.stroke())}class Jx extends Qh{constructor(i){super();wn(this,"circumference");wn(this,"endAngle");wn(this,"fullCircles");wn(this,"innerRadius");wn(this,"outerRadius");wn(this,"pixelMargin");wn(this,"startAngle");this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,i&&Object.assign(this,i)}inRange(i,a,s){const l=this.getProps(["x","y"],s),{angle:d,distance:f}=BJ(l,{x:i,y:a}),{startAngle:p,endAngle:y,innerRadius:_,outerRadius:b,circumference:S}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],s),A=(this.options.spacing+this.options.borderWidth)/2,L=Ui(S,y-p)>=pa||Lw(d,p,y),k=Nh(f,_+A,b+A);return L&&k}getCenterPoint(i){const{x:a,y:s,startAngle:l,endAngle:d,innerRadius:f,outerRadius:p}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],i),{offset:y,spacing:_}=this.options,b=(l+d)/2,S=(f+p+_+y)/2;return{x:a+Math.cos(b)*S,y:s+Math.sin(b)*S}}tooltipPosition(i){return this.getCenterPoint(i)}draw(i){const{options:a,circumference:s}=this,l=(a.offset||0)/4,d=(a.spacing||0)/2,f=a.circular;if(this.pixelMargin=a.borderAlign==="inner"?.33:0,this.fullCircles=s>pa?Math.floor(s/pa):0,s===0||this.innerRadius<0||this.outerRadius<0)return;i.save();const p=(this.startAngle+this.endAngle)/2;i.translate(Math.cos(p)*l,Math.sin(p)*l);const y=1-Math.sin(Math.min(ma,s||0)),_=l*y;i.fillStyle=a.backgroundColor,i.strokeStyle=a.borderColor,XRe(i,this,_,d,f),ZRe(i,this,_,d,f),i.restore()}}wn(Jx,"id","arc"),wn(Jx,"defaults",{borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0}),wn(Jx,"defaultRoutes",{backgroundColor:"backgroundColor"}),wn(Jx,"descriptors",{_scriptable:!0,_indexable:i=>i!=="borderDash"});function _Q(n,e,i=e){n.lineCap=Ui(i.borderCapStyle,e.borderCapStyle),n.setLineDash(Ui(i.borderDash,e.borderDash)),n.lineDashOffset=Ui(i.borderDashOffset,e.borderDashOffset),n.lineJoin=Ui(i.borderJoinStyle,e.borderJoinStyle),n.lineWidth=Ui(i.borderWidth,e.borderWidth),n.strokeStyle=Ui(i.borderColor,e.borderColor)}function KRe(n,e,i){n.lineTo(i.x,i.y)}function JRe(n){return n.stepped?bPe:n.tension||n.cubicInterpolationMode==="monotone"?wPe:KRe}function xQ(n,e,i={}){const a=n.length,{start:s=0,end:l=a-1}=i,{start:d,end:f}=e,p=Math.max(s,d),y=Math.min(l,f),_=s<d&&l<d||s>f&&l>f;return{count:a,start:p,loop:e.loop,ilen:y<p&&!_?a+y-p:y-p}}function QRe(n,e,i,a){const{points:s,options:l}=e,{count:d,start:f,loop:p,ilen:y}=xQ(s,i,a),_=JRe(l);let{move:b=!0,reverse:S}=a||{},A,P,L;for(A=0;A<=y;++A)P=s[(f+(S?y-A:A))%d],!P.skip&&(b?(n.moveTo(P.x,P.y),b=!1):_(n,L,P,S,l.stepped),L=P);return p&&(P=s[(f+(S?y:0))%d],_(n,L,P,S,l.stepped)),!!p}function eLe(n,e,i,a){const s=e.points,{count:l,start:d,ilen:f}=xQ(s,i,a),{move:p=!0,reverse:y}=a||{};let _=0,b=0,S,A,P,L,k,R;const z=F=>(d+(y?f-F:F))%l,O=()=>{L!==k&&(n.lineTo(_,k),n.lineTo(_,L),n.lineTo(_,R))};for(p&&(A=s[z(0)],n.moveTo(A.x,A.y)),S=0;S<=f;++S){if(A=s[z(S)],A.skip)continue;const F=A.x,H=A.y,$=F|0;$===P?(H<L?L=H:H>k&&(k=H),_=(b*_+F)/++b):(O(),n.lineTo(F,H),P=$,b=0,L=k=H),R=H}O()}function dD(n){const e=n.options,i=e.borderDash&&e.borderDash.length;return!n._decimated&&!n._loop&&!e.tension&&e.cubicInterpolationMode!=="monotone"&&!e.stepped&&!i?eLe:QRe}function tLe(n){return n.stepped?eIe:n.tension||n.cubicInterpolationMode==="monotone"?tIe:hg}function nLe(n,e,i,a){let s=e._path;s||(s=e._path=new Path2D,e.path(s,i,a)&&s.closePath()),_Q(n,e.options),n.stroke(s)}function iLe(n,e,i,a){const{segments:s,options:l}=e,d=dD(e);for(const f of s)_Q(n,l,f.style),n.beginPath(),d(n,e,f,{start:i,end:i+a-1})&&n.closePath(),n.stroke()}const rLe=typeof Path2D=="function";function aLe(n,e,i,a){rLe&&!e.options.segment?nLe(n,e,i,a):iLe(n,e,i,a)}class sp extends Qh{constructor(e){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,e&&Object.assign(this,e)}updateControlPoints(e,i){const a=this.options;if((a.tension||a.cubicInterpolationMode==="monotone")&&!a.stepped&&!this._pointsUpdated){const s=a.spanGaps?this._loop:this._fullLoop;$Pe(this._points,a,e,s,i),this._pointsUpdated=!0}}set points(e){this._points=e,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=sIe(this,this.options.segment))}first(){const e=this.segments,i=this.points;return e.length&&i[e[0].start]}last(){const e=this.segments,i=this.points,a=e.length;return a&&i[e[a-1].end]}interpolate(e,i){const a=this.options,s=e[i],l=this.points,d=oQ(this,{property:i,start:s,end:s});if(!d.length)return;const f=[],p=tLe(a);let y,_;for(y=0,_=d.length;y<_;++y){const{start:b,end:S}=d[y],A=l[b],P=l[S];if(A===P){f.push(A);continue}const L=Math.abs((s-A[i])/(P[i]-A[i])),k=p(A,P,L,a.stepped);k[i]=e[i],f.push(k)}return f.length===1?f[0]:f}pathSegment(e,i,a){return dD(this)(e,this,i,a)}path(e,i,a){const s=this.segments,l=dD(this);let d=this._loop;i=i||0,a=a||this.points.length-i;for(const f of s)d&=l(e,this,f,{start:i,end:i+a-1});return!!d}draw(e,i,a,s){const l=this.options||{};(this.points||[]).length&&l.borderWidth&&(e.save(),aLe(e,this,a,s),e.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}wn(sp,"id","line"),wn(sp,"defaults",{borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0}),wn(sp,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"}),wn(sp,"descriptors",{_scriptable:!0,_indexable:e=>e!=="borderDash"&&e!=="fill"});function WH(n,e,i,a){const s=n.options,{[i]:l}=n.getProps([i],a);return Math.abs(e-l)<s.radius+s.hitRadius}class AM extends Qh{constructor(i){super();wn(this,"parsed");wn(this,"skip");wn(this,"stop");this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,i&&Object.assign(this,i)}inRange(i,a,s){const l=this.options,{x:d,y:f}=this.getProps(["x","y"],s);return Math.pow(i-d,2)+Math.pow(a-f,2)<Math.pow(l.hitRadius+l.radius,2)}inXRange(i,a){return WH(this,i,"x",a)}inYRange(i,a){return WH(this,i,"y",a)}getCenterPoint(i){const{x:a,y:s}=this.getProps(["x","y"],i);return{x:a,y:s}}size(i){i=i||this.options||{};let a=i.radius||0;a=Math.max(a,a&&i.hoverRadius||0);const s=a&&i.borderWidth||0;return(a+s)*2}draw(i,a){const s=this.options;this.skip||s.radius<.1||!Bh(this,a,this.size(s)/2)||(i.strokeStyle=s.borderColor,i.lineWidth=s.borderWidth,i.fillStyle=s.backgroundColor,sD(i,s,this.x,this.y))}getRange(){const i=this.options||{};return i.radius+i.hitRadius}}wn(AM,"id","point"),wn(AM,"defaults",{borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0}),wn(AM,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});function bQ(n,e){const{x:i,y:a,base:s,width:l,height:d}=n.getProps(["x","y","base","width","height"],e);let f,p,y,_,b;return n.horizontal?(b=d/2,f=Math.min(i,s),p=Math.max(i,s),y=a-b,_=a+b):(b=l/2,f=i-b,p=i+b,y=Math.min(a,s),_=Math.max(a,s)),{left:f,top:y,right:p,bottom:_}}function lp(n,e,i,a){return n?0:Go(e,i,a)}function oLe(n,e,i){const a=n.options.borderWidth,s=n.borderSkipped,l=qJ(a);return{t:lp(s.top,l.top,0,i),r:lp(s.right,l.right,0,e),b:lp(s.bottom,l.bottom,0,i),l:lp(s.left,l.left,0,e)}}function sLe(n,e,i){const{enableBorderRadius:a}=n.getProps(["enableBorderRadius"]),s=n.options.borderRadius,l=Dg(s),d=Math.min(e,i),f=n.borderSkipped,p=a||ir(s);return{topLeft:lp(!p||f.top||f.left,l.topLeft,0,d),topRight:lp(!p||f.top||f.right,l.topRight,0,d),bottomLeft:lp(!p||f.bottom||f.left,l.bottomLeft,0,d),bottomRight:lp(!p||f.bottom||f.right,l.bottomRight,0,d)}}function lLe(n){const e=bQ(n),i=e.right-e.left,a=e.bottom-e.top,s=oLe(n,i/2,a/2),l=sLe(n,i/2,a/2);return{outer:{x:e.left,y:e.top,w:i,h:a,radius:l},inner:{x:e.left+s.l,y:e.top+s.t,w:i-s.l-s.r,h:a-s.t-s.b,radius:{topLeft:Math.max(0,l.topLeft-Math.max(s.t,s.l)),topRight:Math.max(0,l.topRight-Math.max(s.t,s.r)),bottomLeft:Math.max(0,l.bottomLeft-Math.max(s.b,s.l)),bottomRight:Math.max(0,l.bottomRight-Math.max(s.b,s.r))}}}}function jL(n,e,i,a){const s=e===null,l=i===null,f=n&&!(s&&l)&&bQ(n,a);return f&&(s||Nh(e,f.left,f.right))&&(l||Nh(i,f.top,f.bottom))}function cLe(n){return n.topLeft||n.topRight||n.bottomLeft||n.bottomRight}function uLe(n,e){n.rect(e.x,e.y,e.w,e.h)}function $L(n,e,i={}){const a=n.x!==i.x?-e:0,s=n.y!==i.y?-e:0,l=(n.x+n.w!==i.x+i.w?e:0)-a,d=(n.y+n.h!==i.y+i.h?e:0)-s;return{x:n.x+a,y:n.y+s,w:n.w+l,h:n.h+d,radius:n.radius}}class CM extends Qh{constructor(e){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,e&&Object.assign(this,e)}draw(e){const{inflateAmount:i,options:{borderColor:a,backgroundColor:s}}=this,{inner:l,outer:d}=lLe(this),f=cLe(d.radius)?kw:uLe;e.save(),(d.w!==l.w||d.h!==l.h)&&(e.beginPath(),f(e,$L(d,i,l)),e.clip(),f(e,$L(l,-i,d)),e.fillStyle=a,e.fill("evenodd")),e.beginPath(),f(e,$L(l,i)),e.fillStyle=s,e.fill(),e.restore()}inRange(e,i,a){return jL(this,e,i,a)}inXRange(e,i){return jL(this,e,null,i)}inYRange(e,i){return jL(this,null,e,i)}getCenterPoint(e){const{x:i,y:a,base:s,horizontal:l}=this.getProps(["x","y","base","horizontal"],e);return{x:l?(i+s)/2:i,y:l?a:(a+s)/2}}getRange(e){return e==="x"?this.width/2:this.height/2}}wn(CM,"id","bar"),wn(CM,"defaults",{borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0}),wn(CM,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});var dLe=Object.freeze({__proto__:null,ArcElement:Jx,BarElement:CM,LineElement:sp,PointElement:AM});const hD=["rgb(54, 162, 235)","rgb(255, 99, 132)","rgb(255, 159, 64)","rgb(255, 205, 86)","rgb(75, 192, 192)","rgb(153, 102, 255)","rgb(201, 203, 207)"],VH=hD.map(n=>n.replace("rgb(","rgba(").replace(")",", 0.5)"));function wQ(n){return hD[n%hD.length]}function SQ(n){return VH[n%VH.length]}function hLe(n,e){return n.borderColor=wQ(e),n.backgroundColor=SQ(e),++e}function fLe(n,e){return n.backgroundColor=n.data.map(()=>wQ(e++)),e}function pLe(n,e){return n.backgroundColor=n.data.map(()=>SQ(e++)),e}function mLe(n){let e=0;return(i,a)=>{const s=n.getDatasetMeta(a).controller;s instanceof Eg?e=fLe(i,e):s instanceof Lb?e=pLe(i,e):s&&(e=hLe(i,e))}}function GH(n){let e;for(e in n)if(n[e].borderColor||n[e].backgroundColor)return!0;return!1}function gLe(n){return n&&(n.borderColor||n.backgroundColor)}var yLe={id:"colors",defaults:{enabled:!0,forceOverride:!1},beforeLayout(n,e,i){if(!i.enabled)return;const{data:{datasets:a},options:s}=n.config,{elements:l}=s;if(!i.forceOverride&&(GH(a)||gLe(s)||l&&GH(l)))return;const d=mLe(n);a.forEach(d)}};function vLe(n,e,i,a,s){const l=s.samples||a;if(l>=i)return n.slice(e,e+i);const d=[],f=(i-2)/(l-2);let p=0;const y=e+i-1;let _=e,b,S,A,P,L;for(d[p++]=n[_],b=0;b<l-2;b++){let k=0,R=0,z;const O=Math.floor((b+1)*f)+1+e,F=Math.min(Math.floor((b+2)*f)+1,i)+e,H=F-O;for(z=O;z<F;z++)k+=n[z].x,R+=n[z].y;k/=H,R/=H;const $=Math.floor(b*f)+1+e,Y=Math.min(Math.floor((b+1)*f)+1,i)+e,{x:te,y:G}=n[_];for(A=P=-1,z=$;z<Y;z++)P=.5*Math.abs((te-k)*(n[z].y-G)-(te-n[z].x)*(R-G)),P>A&&(A=P,S=n[z],L=z);d[p++]=S,_=L}return d[p++]=n[y],d}function _Le(n,e,i,a){let s=0,l=0,d,f,p,y,_,b,S,A,P,L;const k=[],R=e+i-1,z=n[e].x,F=n[R].x-z;for(d=e;d<e+i;++d){f=n[d],p=(f.x-z)/F*a,y=f.y;const H=p|0;if(H===_)y<P?(P=y,b=d):y>L&&(L=y,S=d),s=(l*s+f.x)/++l;else{const $=d-1;if(!mr(b)&&!mr(S)){const Y=Math.min(b,S),te=Math.max(b,S);Y!==A&&Y!==$&&k.push({...n[Y],x:s}),te!==A&&te!==$&&k.push({...n[te],x:s})}d>0&&$!==A&&k.push(n[$]),k.push(f),_=H,l=0,P=L=y,b=S=A=d}}return k}function EQ(n){if(n._decimated){const e=n._data;delete n._decimated,delete n._data,Object.defineProperty(n,"data",{configurable:!0,enumerable:!0,writable:!0,value:e})}}function HH(n){n.data.datasets.forEach(e=>{EQ(e)})}function xLe(n,e){const i=e.length;let a=0,s;const{iScale:l}=n,{min:d,max:f,minDefined:p,maxDefined:y}=l.getUserBounds();return p&&(a=Go(Fh(e,l.axis,d).lo,0,i-1)),y?s=Go(Fh(e,l.axis,f).hi+1,a,i)-a:s=i-a,{start:a,count:s}}var bLe={id:"decimation",defaults:{algorithm:"min-max",enabled:!1},beforeElementsUpdate:(n,e,i)=>{if(!i.enabled){HH(n);return}const a=n.width;n.data.datasets.forEach((s,l)=>{const{_data:d,indexAxis:f}=s,p=n.getDatasetMeta(l),y=d||s.data;if(Zx([f,n.options.indexAxis])==="y"||!p.controller.supportsDecimation)return;const _=n.scales[p.xAxisID];if(_.type!=="linear"&&_.type!=="time"||n.options.parsing)return;let{start:b,count:S}=xLe(p,y);const A=i.threshold||4*a;if(S<=A){EQ(s);return}mr(d)&&(s._data=y,delete s.data,Object.defineProperty(s,"data",{configurable:!0,enumerable:!0,get:function(){return this._decimated},set:function(L){this._data=L}}));let P;switch(i.algorithm){case"lttb":P=vLe(y,b,S,a,i);break;case"min-max":P=_Le(y,b,S,a);break;default:throw new Error(`Unsupported decimation algorithm '${i.algorithm}'`)}s._decimated=P})},destroy(n){HH(n)}};function wLe(n,e,i){const a=n.segments,s=n.points,l=e.points,d=[];for(const f of a){let{start:p,end:y}=f;y=vO(p,y,s);const _=fD(i,s[p],s[y],f.loop);if(!e.segments){d.push({source:f,target:_,start:s[p],end:s[y]});continue}const b=oQ(e,_);for(const S of b){const A=fD(i,l[S.start],l[S.end],S.loop),P=aQ(f,s,A);for(const L of P)d.push({source:L,target:S,start:{[i]:jH(_,A,"start",Math.max)},end:{[i]:jH(_,A,"end",Math.min)}})}}return d}function fD(n,e,i,a){if(a)return;let s=e[n],l=i[n];return n==="angle"&&(s=Yl(s),l=Yl(l)),{property:n,start:s,end:l}}function SLe(n,e){const{x:i=null,y:a=null}=n||{},s=e.points,l=[];return e.segments.forEach(({start:d,end:f})=>{f=vO(d,f,s);const p=s[d],y=s[f];a!==null?(l.push({x:p.x,y:a}),l.push({x:y.x,y:a})):i!==null&&(l.push({x:i,y:p.y}),l.push({x:i,y:y.y}))}),l}function vO(n,e,i){for(;e>n;e--){const a=i[e];if(!isNaN(a.x)&&!isNaN(a.y))break}return e}function jH(n,e,i,a){return n&&e?a(n[i],e[i]):n?n[i]:e?e[i]:0}function MQ(n,e){let i=[],a=!1;return ha(n)?(a=!0,i=n):i=SLe(n,e),i.length?new sp({points:i,options:{tension:0},_loop:a,_fullLoop:a}):null}function $H(n){return n&&n.fill!==!1}function ELe(n,e,i){let s=n[e].fill;const l=[e];let d;if(!i)return s;for(;s!==!1&&l.indexOf(s)===-1;){if(!Ka(s))return s;if(d=n[s],!d)return!1;if(d.visible)return s;l.push(s),s=d.fill}return!1}function MLe(n,e,i){const a=PLe(n);if(ir(a))return isNaN(a.value)?!1:a;let s=parseFloat(a);return Ka(s)&&Math.floor(s)===s?TLe(a[0],e,s,i):["origin","start","end","stack","shape"].indexOf(a)>=0&&a}function TLe(n,e,i,a){return(n==="-"||n==="+")&&(i=e+i),i===e||i<0||i>=a?!1:i}function ALe(n,e){let i=null;return n==="start"?i=e.bottom:n==="end"?i=e.top:ir(n)?i=e.getPixelForValue(n.value):e.getBasePixel&&(i=e.getBasePixel()),i}function CLe(n,e,i){let a;return n==="start"?a=i:n==="end"?a=e.options.reverse?e.min:e.max:ir(n)?a=n.value:a=e.getBaseValue(),a}function PLe(n){const e=n.options,i=e.fill;let a=Ui(i&&i.target,i);return a===void 0&&(a=!!e.backgroundColor),a===!1||a===null?!1:a===!0?"origin":a}function ILe(n){const{scale:e,index:i,line:a}=n,s=[],l=a.segments,d=a.points,f=RLe(e,i);f.push(MQ({x:null,y:e.bottom},a));for(let p=0;p<l.length;p++){const y=l[p];for(let _=y.start;_<=y.end;_++)LLe(s,d[_],f)}return new sp({points:s,options:{}})}function RLe(n,e){const i=[],a=n.getMatchingVisibleMetas("line");for(let s=0;s<a.length;s++){const l=a[s];if(l.index===e)break;l.hidden||i.unshift(l.dataset)}return i}function LLe(n,e,i){const a=[];for(let s=0;s<i.length;s++){const l=i[s],{first:d,last:f,point:p}=kLe(l,e,"x");if(!(!p||d&&f)){if(d)a.unshift(p);else if(n.push(p),!f)break}}n.push(...a)}function kLe(n,e,i){const a=n.interpolate(e,i);if(!a)return{};const s=a[i],l=n.segments,d=n.points;let f=!1,p=!1;for(let y=0;y<l.length;y++){const _=l[y],b=d[_.start][i],S=d[_.end][i];if(Nh(s,b,S)){f=s===b,p=s===S;break}}return{first:f,last:p,point:a}}class TQ{constructor(e){this.x=e.x,this.y=e.y,this.radius=e.radius}pathSegment(e,i,a){const{x:s,y:l,radius:d}=this;return i=i||{start:0,end:pa},e.arc(s,l,d,i.end,i.start,!0),!a.bounds}interpolate(e){const{x:i,y:a,radius:s}=this,l=e.angle;return{x:i+Math.cos(l)*s,y:a+Math.sin(l)*s,angle:l}}}function DLe(n){const{chart:e,fill:i,line:a}=n;if(Ka(i))return zLe(e,i);if(i==="stack")return ILe(n);if(i==="shape")return!0;const s=OLe(n);return s instanceof TQ?s:MQ(s,a)}function zLe(n,e){const i=n.getDatasetMeta(e);return i&&n.isDatasetVisible(e)?i.dataset:null}function OLe(n){return(n.scale||{}).getPointPositionForValue?FLe(n):NLe(n)}function NLe(n){const{scale:e={},fill:i}=n,a=ALe(i,e);if(Ka(a)){const s=e.isHorizontal();return{x:s?a:null,y:s?null:a}}return null}function FLe(n){const{scale:e,fill:i}=n,a=e.options,s=e.getLabels().length,l=a.reverse?e.max:e.min,d=CLe(i,e,l),f=[];if(a.grid.circular){const p=e.getPointPositionForValue(0,l);return new TQ({x:p.x,y:p.y,radius:e.getDistanceFromCenterForValue(d)})}for(let p=0;p<s;++p)f.push(e.getPointPositionForValue(p,d));return f}function YL(n,e,i){const a=DLe(e),{line:s,scale:l,axis:d}=e,f=s.options,p=f.fill,y=f.backgroundColor,{above:_=y,below:b=y}=p||{};a&&s.points.length&&(MC(n,i),BLe(n,{line:s,target:a,above:_,below:b,area:i,scale:l,axis:d}),TC(n))}function BLe(n,e){const{line:i,target:a,above:s,below:l,area:d,scale:f}=e,p=i._loop?"angle":e.axis;n.save(),p==="x"&&l!==s&&(YH(n,a,d.top),qH(n,{line:i,target:a,color:s,scale:f,property:p}),n.restore(),n.save(),YH(n,a,d.bottom)),qH(n,{line:i,target:a,color:l,scale:f,property:p}),n.restore()}function YH(n,e,i){const{segments:a,points:s}=e;let l=!0,d=!1;n.beginPath();for(const f of a){const{start:p,end:y}=f,_=s[p],b=s[vO(p,y,s)];l?(n.moveTo(_.x,_.y),l=!1):(n.lineTo(_.x,i),n.lineTo(_.x,_.y)),d=!!e.pathSegment(n,f,{move:d}),d?n.closePath():n.lineTo(b.x,i)}n.lineTo(e.first().x,i),n.closePath(),n.clip()}function qH(n,e){const{line:i,target:a,property:s,color:l,scale:d}=e,f=wLe(i,a,s);for(const{source:p,target:y,start:_,end:b}of f){const{style:{backgroundColor:S=l}={}}=p,A=a!==!0;n.save(),n.fillStyle=S,ULe(n,d,A&&fD(s,_,b)),n.beginPath();const P=!!i.pathSegment(n,p);let L;if(A){P?n.closePath():XH(n,a,b,s);const k=!!a.pathSegment(n,y,{move:P,reverse:!0});L=P&&k,L||XH(n,a,_,s)}n.closePath(),n.fill(L?"evenodd":"nonzero"),n.restore()}}function ULe(n,e,i){const{top:a,bottom:s}=e.chart.chartArea,{property:l,start:d,end:f}=i||{};l==="x"&&(n.beginPath(),n.rect(d,a,f-d,s-a),n.clip())}function XH(n,e,i,a){const s=e.interpolate(i,a);s&&n.lineTo(s.x,s.y)}var WLe={id:"filler",afterDatasetsUpdate(n,e,i){const a=(n.data.datasets||[]).length,s=[];let l,d,f,p;for(d=0;d<a;++d)l=n.getDatasetMeta(d),f=l.dataset,p=null,f&&f.options&&f instanceof sp&&(p={visible:n.isDatasetVisible(d),index:d,fill:MLe(f,d,a),chart:n,axis:l.controller.options.indexAxis,scale:l.vScale,line:f}),l.$filler=p,s.push(p);for(d=0;d<a;++d)p=s[d],!(!p||p.fill===!1)&&(p.fill=ELe(s,d,i.propagate))},beforeDraw(n,e,i){const a=i.drawTime==="beforeDraw",s=n.getSortedVisibleDatasetMetas(),l=n.chartArea;for(let d=s.length-1;d>=0;--d){const f=s[d].$filler;f&&(f.line.updateControlPoints(l,f.axis),a&&f.fill&&YL(n.ctx,f,l))}},beforeDatasetsDraw(n,e,i){if(i.drawTime!=="beforeDatasetsDraw")return;const a=n.getSortedVisibleDatasetMetas();for(let s=a.length-1;s>=0;--s){const l=a[s].$filler;$H(l)&&YL(n.ctx,l,n.chartArea)}},beforeDatasetDraw(n,e,i){const a=e.meta.$filler;!$H(a)||i.drawTime!=="beforeDatasetDraw"||YL(n.ctx,a,n.chartArea)},defaults:{propagate:!0,drawTime:"beforeDatasetDraw"}};const ZH=(n,e)=>{let{boxHeight:i=e,boxWidth:a=e}=n;return n.usePointStyle&&(i=Math.min(i,e),a=n.pointStyleWidth||Math.min(a,e)),{boxWidth:a,boxHeight:i,itemHeight:Math.max(e,i)}},VLe=(n,e)=>n!==null&&e!==null&&n.datasetIndex===e.datasetIndex&&n.index===e.index;class KH extends Qh{constructor(e){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,i,a){this.maxWidth=e,this.maxHeight=i,this._margins=a,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const e=this.options.labels||{};let i=aa(e.generateLabels,[this.chart],this)||[];e.filter&&(i=i.filter(a=>e.filter(a,this.chart.data))),e.sort&&(i=i.sort((a,s)=>e.sort(a,s,this.chart.data))),this.options.reverse&&i.reverse(),this.legendItems=i}fit(){const{options:e,ctx:i}=this;if(!e.display){this.width=this.height=0;return}const a=e.labels,s=zo(a.font),l=s.size,d=this._computeTitleHeight(),{boxWidth:f,itemHeight:p}=ZH(a,l);let y,_;i.font=s.string,this.isHorizontal()?(y=this.maxWidth,_=this._fitRows(d,l,f,p)+10):(_=this.maxHeight,y=this._fitCols(d,s,f,p)+10),this.width=Math.min(y,e.maxWidth||this.maxWidth),this.height=Math.min(_,e.maxHeight||this.maxHeight)}_fitRows(e,i,a,s){const{ctx:l,maxWidth:d,options:{labels:{padding:f}}}=this,p=this.legendHitBoxes=[],y=this.lineWidths=[0],_=s+f;let b=e;l.textAlign="left",l.textBaseline="middle";let S=-1,A=-_;return this.legendItems.forEach((P,L)=>{const k=a+i/2+l.measureText(P.text).width;(L===0||y[y.length-1]+k+2*f>d)&&(b+=_,y[y.length-(L>0?0:1)]=0,A+=_,S++),p[L]={left:0,top:A,row:S,width:k,height:s},y[y.length-1]+=k+f}),b}_fitCols(e,i,a,s){const{ctx:l,maxHeight:d,options:{labels:{padding:f}}}=this,p=this.legendHitBoxes=[],y=this.columnSizes=[],_=d-e;let b=f,S=0,A=0,P=0,L=0;return this.legendItems.forEach((k,R)=>{const{itemWidth:z,itemHeight:O}=GLe(a,i,l,k,s);R>0&&A+O+2*f>_&&(b+=S+f,y.push({width:S,height:A}),P+=S+f,L++,S=A=0),p[R]={left:P,top:A,col:L,width:z,height:O},S=Math.max(S,z),A+=O+f}),b+=S,y.push({width:S,height:A}),b}adjustHitBoxes(){if(!this.options.display)return;const e=this._computeTitleHeight(),{legendHitBoxes:i,options:{align:a,labels:{padding:s},rtl:l}}=this,d=Q0(l,this.left,this.width);if(this.isHorizontal()){let f=0,p=bs(a,this.left+s,this.right-this.lineWidths[f]);for(const y of i)f!==y.row&&(f=y.row,p=bs(a,this.left+s,this.right-this.lineWidths[f])),y.top+=this.top+e+s,y.left=d.leftForLtr(d.x(p),y.width),p+=y.width+s}else{let f=0,p=bs(a,this.top+e+s,this.bottom-this.columnSizes[f].height);for(const y of i)y.col!==f&&(f=y.col,p=bs(a,this.top+e+s,this.bottom-this.columnSizes[f].height)),y.top=p,y.left+=this.left+s,y.left=d.leftForLtr(d.x(y.left),y.width),p+=y.height+s}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){const e=this.ctx;MC(e,this),this._draw(),TC(e)}}_draw(){const{options:e,columnSizes:i,lineWidths:a,ctx:s}=this,{align:l,labels:d}=e,f=Ja.color,p=Q0(e.rtl,this.left,this.width),y=zo(d.font),{padding:_}=d,b=y.size,S=b/2;let A;this.drawTitle(),s.textAlign=p.textAlign("left"),s.textBaseline="middle",s.lineWidth=.5,s.font=y.string;const{boxWidth:P,boxHeight:L,itemHeight:k}=ZH(d,b),R=function($,Y,te){if(isNaN(P)||P<=0||isNaN(L)||L<0)return;s.save();const G=Ui(te.lineWidth,1);if(s.fillStyle=Ui(te.fillStyle,f),s.lineCap=Ui(te.lineCap,"butt"),s.lineDashOffset=Ui(te.lineDashOffset,0),s.lineJoin=Ui(te.lineJoin,"miter"),s.lineWidth=G,s.strokeStyle=Ui(te.strokeStyle,f),s.setLineDash(Ui(te.lineDash,[])),d.usePointStyle){const Q={radius:L*Math.SQRT2/2,pointStyle:te.pointStyle,rotation:te.rotation,borderWidth:G},he=p.xPlus($,P/2),pe=Y+S;YJ(s,Q,he,pe,d.pointStyleWidth&&P)}else{const Q=Y+Math.max((b-L)/2,0),he=p.leftForLtr($,P),pe=Dg(te.borderRadius);s.beginPath(),Object.values(pe).some(ye=>ye!==0)?kw(s,{x:he,y:Q,w:P,h:L,radius:pe}):s.rect(he,Q,P,L),s.fill(),G!==0&&s.stroke()}s.restore()},z=function($,Y,te){Kg(s,te.text,$,Y+k/2,y,{strikethrough:te.hidden,textAlign:p.textAlign(te.textAlign)})},O=this.isHorizontal(),F=this._computeTitleHeight();O?A={x:bs(l,this.left+_,this.right-a[0]),y:this.top+_+F,line:0}:A={x:this.left+_,y:bs(l,this.top+F+_,this.bottom-i[0].height),line:0},nQ(this.ctx,e.textDirection);const H=k+_;this.legendItems.forEach(($,Y)=>{s.strokeStyle=$.fontColor,s.fillStyle=$.fontColor;const te=s.measureText($.text).width,G=p.textAlign($.textAlign||($.textAlign=d.textAlign)),Q=P+S+te;let he=A.x,pe=A.y;p.setWidth(this.width),O?Y>0&&he+Q+_>this.right&&(pe=A.y+=H,A.line++,he=A.x=bs(l,this.left+_,this.right-a[A.line])):Y>0&&pe+H>this.bottom&&(he=A.x=he+i[A.line].width+_,A.line++,pe=A.y=bs(l,this.top+F+_,this.bottom-i[A.line].height));const ye=p.x(he);if(R(ye,pe,$),he=uPe(G,he+P+S,O?he+Q:this.right,e.rtl),z(p.x(he),pe,$),O)A.x+=Q+_;else if(typeof $.text!="string"){const fe=y.lineHeight;A.y+=AQ($,fe)+_}else A.y+=H}),iQ(this.ctx,e.textDirection)}drawTitle(){const e=this.options,i=e.title,a=zo(i.font),s=Ps(i.padding);if(!i.display)return;const l=Q0(e.rtl,this.left,this.width),d=this.ctx,f=i.position,p=a.size/2,y=s.top+p;let _,b=this.left,S=this.width;if(this.isHorizontal())S=Math.max(...this.lineWidths),_=this.top+y,b=bs(e.align,b,this.right-S);else{const P=this.columnSizes.reduce((L,k)=>Math.max(L,k.height),0);_=y+bs(e.align,this.top,this.bottom-P-e.labels.padding-this._computeTitleHeight())}const A=bs(f,b,b+S);d.textAlign=l.textAlign(uO(f)),d.textBaseline="middle",d.strokeStyle=i.color,d.fillStyle=i.color,d.font=a.string,Kg(d,i.text,A,_,a)}_computeTitleHeight(){const e=this.options.title,i=zo(e.font),a=Ps(e.padding);return e.display?i.lineHeight+a.height:0}_getLegendItemAt(e,i){let a,s,l;if(Nh(e,this.left,this.right)&&Nh(i,this.top,this.bottom)){for(l=this.legendHitBoxes,a=0;a<l.length;++a)if(s=l[a],Nh(e,s.left,s.left+s.width)&&Nh(i,s.top,s.top+s.height))return this.legendItems[a]}return null}handleEvent(e){const i=this.options;if(!$Le(e.type,i))return;const a=this._getLegendItemAt(e.x,e.y);if(e.type==="mousemove"||e.type==="mouseout"){const s=this._hoveredItem,l=VLe(s,a);s&&!l&&aa(i.onLeave,[e,s,this],this),this._hoveredItem=a,a&&!l&&aa(i.onHover,[e,a,this],this)}else a&&aa(i.onClick,[e,a,this],this)}}function GLe(n,e,i,a,s){const l=HLe(a,n,e,i),d=jLe(s,a,e.lineHeight);return{itemWidth:l,itemHeight:d}}function HLe(n,e,i,a){let s=n.text;return s&&typeof s!="string"&&(s=s.reduce((l,d)=>l.length>d.length?l:d)),e+i.size/2+a.measureText(s).width}function jLe(n,e,i){let a=n;return typeof e.text!="string"&&(a=AQ(e,i)),a}function AQ(n,e){const i=n.text?n.text.length:0;return e*i}function $Le(n,e){return!!((n==="mousemove"||n==="mouseout")&&(e.onHover||e.onLeave)||e.onClick&&(n==="click"||n==="mouseup"))}var YLe={id:"legend",_element:KH,start(n,e,i){const a=n.legend=new KH({ctx:n.ctx,options:i,chart:n});Es.configure(n,a,i),Es.addBox(n,a)},stop(n){Es.removeBox(n,n.legend),delete n.legend},beforeUpdate(n,e,i){const a=n.legend;Es.configure(n,a,i),a.options=i},afterUpdate(n){const e=n.legend;e.buildLabels(),e.adjustHitBoxes()},afterEvent(n,e){e.replay||n.legend.handleEvent(e.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(n,e,i){const a=e.datasetIndex,s=i.chart;s.isDatasetVisible(a)?(s.hide(a),e.hidden=!0):(s.show(a),e.hidden=!1)},onHover:null,onLeave:null,labels:{color:n=>n.chart.options.color,boxWidth:40,padding:10,generateLabels(n){const e=n.data.datasets,{labels:{usePointStyle:i,pointStyle:a,textAlign:s,color:l,useBorderRadius:d,borderRadius:f}}=n.legend.options;return n._getSortedDatasetMetas().map(p=>{const y=p.controller.getStyle(i?0:void 0),_=Ps(y.borderWidth);return{text:e[p.index].label,fillStyle:y.backgroundColor,fontColor:l,hidden:!p.visible,lineCap:y.borderCapStyle,lineDash:y.borderDash,lineDashOffset:y.borderDashOffset,lineJoin:y.borderJoinStyle,lineWidth:(_.width+_.height)/4,strokeStyle:y.borderColor,pointStyle:a||y.pointStyle,rotation:y.rotation,textAlign:s||y.textAlign,borderRadius:d&&(f||y.borderRadius),datasetIndex:p.index}},this)}},title:{color:n=>n.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:n=>!n.startsWith("on"),labels:{_scriptable:n=>!["generateLabels","filter","sort"].includes(n)}}};let _O=class extends Qh{constructor(e){super(),this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,i){const a=this.options;if(this.left=0,this.top=0,!a.display){this.width=this.height=this.right=this.bottom=0;return}this.width=this.right=e,this.height=this.bottom=i;const s=ha(a.text)?a.text.length:1;this._padding=Ps(a.padding);const l=s*zo(a.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=l:this.width=l}isHorizontal(){const e=this.options.position;return e==="top"||e==="bottom"}_drawArgs(e){const{top:i,left:a,bottom:s,right:l,options:d}=this,f=d.align;let p=0,y,_,b;return this.isHorizontal()?(_=bs(f,a,l),b=i+e,y=l-a):(d.position==="left"?(_=a+e,b=bs(f,s,i),p=ma*-.5):(_=l-e,b=bs(f,i,s),p=ma*.5),y=s-i),{titleX:_,titleY:b,maxWidth:y,rotation:p}}draw(){const e=this.ctx,i=this.options;if(!i.display)return;const a=zo(i.font),l=a.lineHeight/2+this._padding.top,{titleX:d,titleY:f,maxWidth:p,rotation:y}=this._drawArgs(l);Kg(e,i.text,0,0,a,{color:i.color,maxWidth:p,rotation:y,textAlign:uO(i.align),textBaseline:"middle",translation:[d,f]})}};function qLe(n,e){const i=new _O({ctx:n.ctx,options:e,chart:n});Es.configure(n,i,e),Es.addBox(n,i),n.titleBlock=i}var XLe={id:"title",_element:_O,start(n,e,i){qLe(n,i)},stop(n){const e=n.titleBlock;Es.removeBox(n,e),delete n.titleBlock},beforeUpdate(n,e,i){const a=n.titleBlock;Es.configure(n,a,i),a.options=i},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const BE=new WeakMap;var ZLe={id:"subtitle",start(n,e,i){const a=new _O({ctx:n.ctx,options:i,chart:n});Es.configure(n,a,i),Es.addBox(n,a),BE.set(n,a)},stop(n){Es.removeBox(n,BE.get(n)),BE.delete(n)},beforeUpdate(n,e,i){const a=BE.get(n);Es.configure(n,a,i),a.options=i},defaults:{align:"center",display:!1,font:{weight:"normal"},fullSize:!0,padding:0,position:"top",text:"",weight:1500},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const Qx={average(n){if(!n.length)return!1;let e,i,a=0,s=0,l=0;for(e=0,i=n.length;e<i;++e){const d=n[e].element;if(d&&d.hasValue()){const f=d.tooltipPosition();a+=f.x,s+=f.y,++l}}return{x:a/l,y:s/l}},nearest(n,e){if(!n.length)return!1;let i=e.x,a=e.y,s=Number.POSITIVE_INFINITY,l,d,f;for(l=0,d=n.length;l<d;++l){const p=n[l].element;if(p&&p.hasValue()){const y=p.getCenterPoint(),_=aD(e,y);_<s&&(s=_,f=p)}}if(f){const p=f.tooltipPosition();i=p.x,a=p.y}return{x:i,y:a}}};function sd(n,e){return e&&(ha(e)?Array.prototype.push.apply(n,e):n.push(e)),n}function Th(n){return(typeof n=="string"||n instanceof String)&&n.indexOf(`
`)>-1?n.split(`
`):n}function KLe(n,e){const{element:i,datasetIndex:a,index:s}=e,l=n.getDatasetMeta(a).controller,{label:d,value:f}=l.getLabelAndValue(s);return{chart:n,label:d,parsed:l.getParsed(s),raw:n.data.datasets[a].data[s],formattedValue:f,dataset:l.getDataset(),dataIndex:s,datasetIndex:a,element:i}}function JH(n,e){const i=n.chart.ctx,{body:a,footer:s,title:l}=n,{boxWidth:d,boxHeight:f}=e,p=zo(e.bodyFont),y=zo(e.titleFont),_=zo(e.footerFont),b=l.length,S=s.length,A=a.length,P=Ps(e.padding);let L=P.height,k=0,R=a.reduce((F,H)=>F+H.before.length+H.lines.length+H.after.length,0);if(R+=n.beforeBody.length+n.afterBody.length,b&&(L+=b*y.lineHeight+(b-1)*e.titleSpacing+e.titleMarginBottom),R){const F=e.displayColors?Math.max(f,p.lineHeight):p.lineHeight;L+=A*F+(R-A)*p.lineHeight+(R-1)*e.bodySpacing}S&&(L+=e.footerMarginTop+S*_.lineHeight+(S-1)*e.footerSpacing);let z=0;const O=function(F){k=Math.max(k,i.measureText(F).width+z)};return i.save(),i.font=y.string,Gr(n.title,O),i.font=p.string,Gr(n.beforeBody.concat(n.afterBody),O),z=e.displayColors?d+2+e.boxPadding:0,Gr(a,F=>{Gr(F.before,O),Gr(F.lines,O),Gr(F.after,O)}),z=0,i.font=_.string,Gr(n.footer,O),i.restore(),k+=P.width,{width:k,height:L}}function JLe(n,e){const{y:i,height:a}=e;return i<a/2?"top":i>n.height-a/2?"bottom":"center"}function QLe(n,e,i,a){const{x:s,width:l}=a,d=i.caretSize+i.caretPadding;if(n==="left"&&s+l+d>e.width||n==="right"&&s-l-d<0)return!0}function eke(n,e,i,a){const{x:s,width:l}=i,{width:d,chartArea:{left:f,right:p}}=n;let y="center";return a==="center"?y=s<=(f+p)/2?"left":"right":s<=l/2?y="left":s>=d-l/2&&(y="right"),QLe(y,n,e,i)&&(y="center"),y}function QH(n,e,i){const a=i.yAlign||e.yAlign||JLe(n,i);return{xAlign:i.xAlign||e.xAlign||eke(n,e,i,a),yAlign:a}}function tke(n,e){let{x:i,width:a}=n;return e==="right"?i-=a:e==="center"&&(i-=a/2),i}function nke(n,e,i){let{y:a,height:s}=n;return e==="top"?a+=i:e==="bottom"?a-=s+i:a-=s/2,a}function ej(n,e,i,a){const{caretSize:s,caretPadding:l,cornerRadius:d}=n,{xAlign:f,yAlign:p}=i,y=s+l,{topLeft:_,topRight:b,bottomLeft:S,bottomRight:A}=Dg(d);let P=tke(e,f);const L=nke(e,p,y);return p==="center"?f==="left"?P+=y:f==="right"&&(P-=y):f==="left"?P-=Math.max(_,S)+s:f==="right"&&(P+=Math.max(b,A)+s),{x:Go(P,0,a.width-e.width),y:Go(L,0,a.height-e.height)}}function UE(n,e,i){const a=Ps(i.padding);return e==="center"?n.x+n.width/2:e==="right"?n.x+n.width-a.right:n.x+a.left}function tj(n){return sd([],Th(n))}function ike(n,e,i){return Wp(n,{tooltip:e,tooltipItems:i,type:"tooltip"})}function nj(n,e){const i=e&&e.dataset&&e.dataset.tooltip&&e.dataset.tooltip.callbacks;return i?n.override(i):n}const CQ={beforeTitle:Sh,title(n){if(n.length>0){const e=n[0],i=e.chart.data.labels,a=i?i.length:0;if(this&&this.options&&this.options.mode==="dataset")return e.dataset.label||"";if(e.label)return e.label;if(a>0&&e.dataIndex<a)return i[e.dataIndex]}return""},afterTitle:Sh,beforeBody:Sh,beforeLabel:Sh,label(n){if(this&&this.options&&this.options.mode==="dataset")return n.label+": "+n.formattedValue||n.formattedValue;let e=n.dataset.label||"";e&&(e+=": ");const i=n.formattedValue;return mr(i)||(e+=i),e},labelColor(n){const i=n.chart.getDatasetMeta(n.datasetIndex).controller.getStyle(n.dataIndex);return{borderColor:i.borderColor,backgroundColor:i.backgroundColor,borderWidth:i.borderWidth,borderDash:i.borderDash,borderDashOffset:i.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(n){const i=n.chart.getDatasetMeta(n.datasetIndex).controller.getStyle(n.dataIndex);return{pointStyle:i.pointStyle,rotation:i.rotation}},afterLabel:Sh,afterBody:Sh,beforeFooter:Sh,footer:Sh,afterFooter:Sh};function pl(n,e,i,a){const s=n[e].call(i,a);return typeof s>"u"?CQ[e].call(i,a):s}class pD extends Qh{constructor(e){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=e.chart,this.options=e.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(e){this.options=e,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const e=this._cachedAnimations;if(e)return e;const i=this.chart,a=this.options.setContext(this.getContext()),s=a.enabled&&i.options.animation&&a.animations,l=new sQ(this.chart,s);return s._cacheable&&(this._cachedAnimations=Object.freeze(l)),l}getContext(){return this.$context||(this.$context=ike(this.chart.getContext(),this,this._tooltipItems))}getTitle(e,i){const{callbacks:a}=i,s=pl(a,"beforeTitle",this,e),l=pl(a,"title",this,e),d=pl(a,"afterTitle",this,e);let f=[];return f=sd(f,Th(s)),f=sd(f,Th(l)),f=sd(f,Th(d)),f}getBeforeBody(e,i){return tj(pl(i.callbacks,"beforeBody",this,e))}getBody(e,i){const{callbacks:a}=i,s=[];return Gr(e,l=>{const d={before:[],lines:[],after:[]},f=nj(a,l);sd(d.before,Th(pl(f,"beforeLabel",this,l))),sd(d.lines,pl(f,"label",this,l)),sd(d.after,Th(pl(f,"afterLabel",this,l))),s.push(d)}),s}getAfterBody(e,i){return tj(pl(i.callbacks,"afterBody",this,e))}getFooter(e,i){const{callbacks:a}=i,s=pl(a,"beforeFooter",this,e),l=pl(a,"footer",this,e),d=pl(a,"afterFooter",this,e);let f=[];return f=sd(f,Th(s)),f=sd(f,Th(l)),f=sd(f,Th(d)),f}_createItems(e){const i=this._active,a=this.chart.data,s=[],l=[],d=[];let f=[],p,y;for(p=0,y=i.length;p<y;++p)f.push(KLe(this.chart,i[p]));return e.filter&&(f=f.filter((_,b,S)=>e.filter(_,b,S,a))),e.itemSort&&(f=f.sort((_,b)=>e.itemSort(_,b,a))),Gr(f,_=>{const b=nj(e.callbacks,_);s.push(pl(b,"labelColor",this,_)),l.push(pl(b,"labelPointStyle",this,_)),d.push(pl(b,"labelTextColor",this,_))}),this.labelColors=s,this.labelPointStyles=l,this.labelTextColors=d,this.dataPoints=f,f}update(e,i){const a=this.options.setContext(this.getContext()),s=this._active;let l,d=[];if(!s.length)this.opacity!==0&&(l={opacity:0});else{const f=Qx[a.position].call(this,s,this._eventPosition);d=this._createItems(a),this.title=this.getTitle(d,a),this.beforeBody=this.getBeforeBody(d,a),this.body=this.getBody(d,a),this.afterBody=this.getAfterBody(d,a),this.footer=this.getFooter(d,a);const p=this._size=JH(this,a),y=Object.assign({},f,p),_=QH(this.chart,a,y),b=ej(a,y,_,this.chart);this.xAlign=_.xAlign,this.yAlign=_.yAlign,l={opacity:1,x:b.x,y:b.y,width:p.width,height:p.height,caretX:f.x,caretY:f.y}}this._tooltipItems=d,this.$context=void 0,l&&this._resolveAnimations().update(this,l),e&&a.external&&a.external.call(this,{chart:this.chart,tooltip:this,replay:i})}drawCaret(e,i,a,s){const l=this.getCaretPosition(e,a,s);i.lineTo(l.x1,l.y1),i.lineTo(l.x2,l.y2),i.lineTo(l.x3,l.y3)}getCaretPosition(e,i,a){const{xAlign:s,yAlign:l}=this,{caretSize:d,cornerRadius:f}=a,{topLeft:p,topRight:y,bottomLeft:_,bottomRight:b}=Dg(f),{x:S,y:A}=e,{width:P,height:L}=i;let k,R,z,O,F,H;return l==="center"?(F=A+L/2,s==="left"?(k=S,R=k-d,O=F+d,H=F-d):(k=S+P,R=k+d,O=F-d,H=F+d),z=k):(s==="left"?R=S+Math.max(p,_)+d:s==="right"?R=S+P-Math.max(y,b)-d:R=this.caretX,l==="top"?(O=A,F=O-d,k=R-d,z=R+d):(O=A+L,F=O+d,k=R+d,z=R-d),H=O),{x1:k,x2:R,x3:z,y1:O,y2:F,y3:H}}drawTitle(e,i,a){const s=this.title,l=s.length;let d,f,p;if(l){const y=Q0(a.rtl,this.x,this.width);for(e.x=UE(this,a.titleAlign,a),i.textAlign=y.textAlign(a.titleAlign),i.textBaseline="middle",d=zo(a.titleFont),f=a.titleSpacing,i.fillStyle=a.titleColor,i.font=d.string,p=0;p<l;++p)i.fillText(s[p],y.x(e.x),e.y+d.lineHeight/2),e.y+=d.lineHeight+f,p+1===l&&(e.y+=a.titleMarginBottom-f)}}_drawColorBox(e,i,a,s,l){const d=this.labelColors[a],f=this.labelPointStyles[a],{boxHeight:p,boxWidth:y}=l,_=zo(l.bodyFont),b=UE(this,"left",l),S=s.x(b),A=p<_.lineHeight?(_.lineHeight-p)/2:0,P=i.y+A;if(l.usePointStyle){const L={radius:Math.min(y,p)/2,pointStyle:f.pointStyle,rotation:f.rotation,borderWidth:1},k=s.leftForLtr(S,y)+y/2,R=P+p/2;e.strokeStyle=l.multiKeyBackground,e.fillStyle=l.multiKeyBackground,sD(e,L,k,R),e.strokeStyle=d.borderColor,e.fillStyle=d.backgroundColor,sD(e,L,k,R)}else{e.lineWidth=ir(d.borderWidth)?Math.max(...Object.values(d.borderWidth)):d.borderWidth||1,e.strokeStyle=d.borderColor,e.setLineDash(d.borderDash||[]),e.lineDashOffset=d.borderDashOffset||0;const L=s.leftForLtr(S,y),k=s.leftForLtr(s.xPlus(S,1),y-2),R=Dg(d.borderRadius);Object.values(R).some(z=>z!==0)?(e.beginPath(),e.fillStyle=l.multiKeyBackground,kw(e,{x:L,y:P,w:y,h:p,radius:R}),e.fill(),e.stroke(),e.fillStyle=d.backgroundColor,e.beginPath(),kw(e,{x:k,y:P+1,w:y-2,h:p-2,radius:R}),e.fill()):(e.fillStyle=l.multiKeyBackground,e.fillRect(L,P,y,p),e.strokeRect(L,P,y,p),e.fillStyle=d.backgroundColor,e.fillRect(k,P+1,y-2,p-2))}e.fillStyle=this.labelTextColors[a]}drawBody(e,i,a){const{body:s}=this,{bodySpacing:l,bodyAlign:d,displayColors:f,boxHeight:p,boxWidth:y,boxPadding:_}=a,b=zo(a.bodyFont);let S=b.lineHeight,A=0;const P=Q0(a.rtl,this.x,this.width),L=function(te){i.fillText(te,P.x(e.x+A),e.y+S/2),e.y+=S+l},k=P.textAlign(d);let R,z,O,F,H,$,Y;for(i.textAlign=d,i.textBaseline="middle",i.font=b.string,e.x=UE(this,k,a),i.fillStyle=a.bodyColor,Gr(this.beforeBody,L),A=f&&k!=="right"?d==="center"?y/2+_:y+2+_:0,F=0,$=s.length;F<$;++F){for(R=s[F],z=this.labelTextColors[F],i.fillStyle=z,Gr(R.before,L),O=R.lines,f&&O.length&&(this._drawColorBox(i,e,F,P,a),S=Math.max(b.lineHeight,p)),H=0,Y=O.length;H<Y;++H)L(O[H]),S=b.lineHeight;Gr(R.after,L)}A=0,S=b.lineHeight,Gr(this.afterBody,L),e.y-=l}drawFooter(e,i,a){const s=this.footer,l=s.length;let d,f;if(l){const p=Q0(a.rtl,this.x,this.width);for(e.x=UE(this,a.footerAlign,a),e.y+=a.footerMarginTop,i.textAlign=p.textAlign(a.footerAlign),i.textBaseline="middle",d=zo(a.footerFont),i.fillStyle=a.footerColor,i.font=d.string,f=0;f<l;++f)i.fillText(s[f],p.x(e.x),e.y+d.lineHeight/2),e.y+=d.lineHeight+a.footerSpacing}}drawBackground(e,i,a,s){const{xAlign:l,yAlign:d}=this,{x:f,y:p}=e,{width:y,height:_}=a,{topLeft:b,topRight:S,bottomLeft:A,bottomRight:P}=Dg(s.cornerRadius);i.fillStyle=s.backgroundColor,i.strokeStyle=s.borderColor,i.lineWidth=s.borderWidth,i.beginPath(),i.moveTo(f+b,p),d==="top"&&this.drawCaret(e,i,a,s),i.lineTo(f+y-S,p),i.quadraticCurveTo(f+y,p,f+y,p+S),d==="center"&&l==="right"&&this.drawCaret(e,i,a,s),i.lineTo(f+y,p+_-P),i.quadraticCurveTo(f+y,p+_,f+y-P,p+_),d==="bottom"&&this.drawCaret(e,i,a,s),i.lineTo(f+A,p+_),i.quadraticCurveTo(f,p+_,f,p+_-A),d==="center"&&l==="left"&&this.drawCaret(e,i,a,s),i.lineTo(f,p+b),i.quadraticCurveTo(f,p,f+b,p),i.closePath(),i.fill(),s.borderWidth>0&&i.stroke()}_updateAnimationTarget(e){const i=this.chart,a=this.$animations,s=a&&a.x,l=a&&a.y;if(s||l){const d=Qx[e.position].call(this,this._active,this._eventPosition);if(!d)return;const f=this._size=JH(this,e),p=Object.assign({},d,this._size),y=QH(i,e,p),_=ej(e,p,y,i);(s._to!==_.x||l._to!==_.y)&&(this.xAlign=y.xAlign,this.yAlign=y.yAlign,this.width=f.width,this.height=f.height,this.caretX=d.x,this.caretY=d.y,this._resolveAnimations().update(this,_))}}_willRender(){return!!this.opacity}draw(e){const i=this.options.setContext(this.getContext());let a=this.opacity;if(!a)return;this._updateAnimationTarget(i);const s={width:this.width,height:this.height},l={x:this.x,y:this.y};a=Math.abs(a)<.001?0:a;const d=Ps(i.padding),f=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;i.enabled&&f&&(e.save(),e.globalAlpha=a,this.drawBackground(l,e,s,i),nQ(e,i.textDirection),l.y+=d.top,this.drawTitle(l,e,i),this.drawBody(l,e,i),this.drawFooter(l,e,i),iQ(e,i.textDirection),e.restore())}getActiveElements(){return this._active||[]}setActiveElements(e,i){const a=this._active,s=e.map(({datasetIndex:f,index:p})=>{const y=this.chart.getDatasetMeta(f);if(!y)throw new Error("Cannot find a dataset at index "+f);return{datasetIndex:f,element:y.data[p],index:p}}),l=!wT(a,s),d=this._positionChanged(s,i);(l||d)&&(this._active=s,this._eventPosition=i,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(e,i,a=!0){if(i&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const s=this.options,l=this._active||[],d=this._getActiveElements(e,l,i,a),f=this._positionChanged(d,e),p=i||!wT(d,l)||f;return p&&(this._active=d,(s.enabled||s.external)&&(this._eventPosition={x:e.x,y:e.y},this.update(!0,i))),p}_getActiveElements(e,i,a,s){const l=this.options;if(e.type==="mouseout")return[];if(!s)return i;const d=this.chart.getElementsAtEventForMode(e,l.mode,l,a);return l.reverse&&d.reverse(),d}_positionChanged(e,i){const{caretX:a,caretY:s,options:l}=this,d=Qx[l.position].call(this,e,i);return d!==!1&&(a!==d.x||s!==d.y)}}wn(pD,"positioners",Qx);var rke={id:"tooltip",_element:pD,positioners:Qx,afterInit(n,e,i){i&&(n.tooltip=new pD({chart:n,options:i}))},beforeUpdate(n,e,i){n.tooltip&&n.tooltip.initialize(i)},reset(n,e,i){n.tooltip&&n.tooltip.initialize(i)},afterDraw(n){const e=n.tooltip;if(e&&e._willRender()){const i={tooltip:e};if(n.notifyPlugins("beforeTooltipDraw",{...i,cancelable:!0})===!1)return;e.draw(n.ctx),n.notifyPlugins("afterTooltipDraw",i)}},afterEvent(n,e){if(n.tooltip){const i=e.replay;n.tooltip.handleEvent(e.event,i,e.inChartArea)&&(e.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(n,e)=>e.bodyFont.size,boxWidth:(n,e)=>e.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:CQ},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:n=>n!=="filter"&&n!=="itemSort"&&n!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]},ake=Object.freeze({__proto__:null,Colors:yLe,Decimation:bLe,Filler:WLe,Legend:YLe,SubTitle:ZLe,Title:XLe,Tooltip:rke});const oke=(n,e,i,a)=>(typeof e=="string"?(i=n.push(e)-1,a.unshift({index:i,label:e})):isNaN(e)&&(i=null),i);function ske(n,e,i,a){const s=n.indexOf(e);if(s===-1)return oke(n,e,i,a);const l=n.lastIndexOf(e);return s!==l?i:s}const lke=(n,e)=>n===null?null:Go(Math.round(n),0,e);function ij(n){const e=this.getLabels();return n>=0&&n<e.length?e[n]:n}class mD extends ly{constructor(e){super(e),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(e){const i=this._addedLabels;if(i.length){const a=this.getLabels();for(const{index:s,label:l}of i)a[s]===l&&a.splice(s,1);this._addedLabels=[]}super.init(e)}parse(e,i){if(mr(e))return null;const a=this.getLabels();return i=isFinite(i)&&a[i]===e?i:ske(a,e,Ui(i,e),this._addedLabels),lke(i,a.length-1)}determineDataLimits(){const{minDefined:e,maxDefined:i}=this.getUserBounds();let{min:a,max:s}=this.getMinMax(!0);this.options.bounds==="ticks"&&(e||(a=0),i||(s=this.getLabels().length-1)),this.min=a,this.max=s}buildTicks(){const e=this.min,i=this.max,a=this.options.offset,s=[];let l=this.getLabels();l=e===0&&i===l.length-1?l:l.slice(e,i+1),this._valueRange=Math.max(l.length-(a?0:1),1),this._startValue=this.min-(a?.5:0);for(let d=e;d<=i;d++)s.push({value:d});return s}getLabelForValue(e){return ij.call(this,e)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(e){return typeof e!="number"&&(e=this.parse(e)),e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getPixelForTick(e){const i=this.ticks;return e<0||e>i.length-1?null:this.getPixelForValue(i[e].value)}getValueForPixel(e){return Math.round(this._startValue+this.getDecimalForPixel(e)*this._valueRange)}getBasePixel(){return this.bottom}}wn(mD,"id","category"),wn(mD,"defaults",{ticks:{callback:ij}});function cke(n,e){const i=[],{bounds:s,step:l,min:d,max:f,precision:p,count:y,maxTicks:_,maxDigits:b,includeBounds:S}=n,A=l||1,P=_-1,{min:L,max:k}=e,R=!mr(d),z=!mr(f),O=!mr(y),F=(k-L)/(b+1);let H=KG((k-L)/P/A)*A,$,Y,te,G;if(H<1e-14&&!R&&!z)return[{value:L},{value:k}];G=Math.ceil(k/H)-Math.floor(L/H),G>P&&(H=KG(G*H/P/A)*A),mr(p)||($=Math.pow(10,p),H=Math.ceil(H*$)/$),s==="ticks"?(Y=Math.floor(L/H)*H,te=Math.ceil(k/H)*H):(Y=L,te=k),R&&z&&l&&iPe((f-d)/l,H/1e3)?(G=Math.round(Math.min((f-d)/H,_)),H=(f-d)/G,Y=d,te=f):O?(Y=R?d:Y,te=z?f:te,G=y-1,H=(te-Y)/G):(G=(te-Y)/H,Cb(G,Math.round(G),H/1e3)?G=Math.round(G):G=Math.ceil(G));const Q=Math.max(JG(H),JG(Y));$=Math.pow(10,mr(p)?Q:p),Y=Math.round(Y*$)/$,te=Math.round(te*$)/$;let he=0;for(R&&(S&&Y!==d?(i.push({value:d}),Y<d&&he++,Cb(Math.round((Y+he*H)*$)/$,d,rj(d,F,n))&&he++):Y<d&&he++);he<G;++he){const pe=Math.round((Y+he*H)*$)/$;if(z&&pe>f)break;i.push({value:pe})}return z&&S&&te!==f?i.length&&Cb(i[i.length-1].value,f,rj(f,F,n))?i[i.length-1].value=f:i.push({value:f}):(!z||te===f)&&i.push({value:te}),i}function rj(n,e,{horizontal:i,minRotation:a}){const s=gu(a),l=(i?Math.sin(s):Math.cos(s))||.001,d=.75*e*(""+n).length;return Math.min(e/l,d)}class PT extends ly{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(e,i){return mr(e)||(typeof e=="number"||e instanceof Number)&&!isFinite(+e)?null:+e}handleTickRangeOptions(){const{beginAtZero:e}=this.options,{minDefined:i,maxDefined:a}=this.getUserBounds();let{min:s,max:l}=this;const d=p=>s=i?s:p,f=p=>l=a?l:p;if(e){const p=Ed(s),y=Ed(l);p<0&&y<0?f(0):p>0&&y>0&&d(0)}if(s===l){let p=l===0?1:Math.abs(l*.05);f(l+p),e||d(s-p)}this.min=s,this.max=l}getTickLimit(){const e=this.options.ticks;let{maxTicksLimit:i,stepSize:a}=e,s;return a?(s=Math.ceil(this.max/a)-Math.floor(this.min/a)+1,s>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${a} would result generating up to ${s} ticks. Limiting to 1000.`),s=1e3)):(s=this.computeTickLimit(),i=i||11),i&&(s=Math.min(i,s)),s}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const e=this.options,i=e.ticks;let a=this.getTickLimit();a=Math.max(2,a);const s={maxTicks:a,bounds:e.bounds,min:e.min,max:e.max,precision:i.precision,step:i.stepSize,count:i.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:i.minRotation||0,includeBounds:i.includeBounds!==!1},l=this._range||this,d=cke(s,l);return e.bounds==="ticks"&&FJ(d,this,"value"),e.reverse?(d.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),d}configure(){const e=this.ticks;let i=this.min,a=this.max;if(super.configure(),this.options.offset&&e.length){const s=(a-i)/Math.max(e.length-1,1)/2;i-=s,a+=s}this._startValue=i,this._endValue=a,this._valueRange=a-i}getLabelForValue(e){return hS(e,this.chart.options.locale,this.options.ticks.format)}}class gD extends PT{determineDataLimits(){const{min:e,max:i}=this.getMinMax(!0);this.min=Ka(e)?e:0,this.max=Ka(i)?i:1,this.handleTickRangeOptions()}computeTickLimit(){const e=this.isHorizontal(),i=e?this.width:this.height,a=gu(this.options.ticks.minRotation),s=(e?Math.sin(a):Math.cos(a))||.001,l=this._resolveTickFontOptions(0);return Math.ceil(i/Math.min(40,l.lineHeight/s))}getPixelForValue(e){return e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getValueForPixel(e){return this._startValue+this.getDecimalForPixel(e)*this._valueRange}}wn(gD,"id","linear"),wn(gD,"defaults",{ticks:{callback:EC.formatters.numeric}});const zw=n=>Math.floor(op(n)),ng=(n,e)=>Math.pow(10,zw(n)+e);function aj(n){return n/Math.pow(10,zw(n))===1}function oj(n,e,i){const a=Math.pow(10,i),s=Math.floor(n/a);return Math.ceil(e/a)-s}function uke(n,e){const i=e-n;let a=zw(i);for(;oj(n,e,a)>10;)a++;for(;oj(n,e,a)<10;)a--;return Math.min(a,zw(n))}function dke(n,{min:e,max:i}){e=jl(n.min,e);const a=[],s=zw(e);let l=uke(e,i),d=l<0?Math.pow(10,Math.abs(l)):1;const f=Math.pow(10,l),p=s>l?Math.pow(10,s):0,y=Math.round((e-p)*d)/d,_=Math.floor((e-p)/f/10)*f*10;let b=Math.floor((y-_)/Math.pow(10,l)),S=jl(n.min,Math.round((p+_+b*Math.pow(10,l))*d)/d);for(;S<i;)a.push({value:S,major:aj(S),significand:b}),b>=10?b=b<15?15:20:b++,b>=20&&(l++,b=2,d=l>=0?1:d),S=Math.round((p+_+b*Math.pow(10,l))*d)/d;const A=jl(n.max,S);return a.push({value:A,major:aj(A),significand:b}),a}class yD extends ly{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._valueRange=0}parse(e,i){const a=PT.prototype.parse.apply(this,[e,i]);if(a===0){this._zero=!0;return}return Ka(a)&&a>0?a:null}determineDataLimits(){const{min:e,max:i}=this.getMinMax(!0);this.min=Ka(e)?Math.max(0,e):null,this.max=Ka(i)?Math.max(0,i):null,this.options.beginAtZero&&(this._zero=!0),this._zero&&this.min!==this._suggestedMin&&!Ka(this._userMin)&&(this.min=e===ng(this.min,0)?ng(this.min,-1):ng(this.min,0)),this.handleTickRangeOptions()}handleTickRangeOptions(){const{minDefined:e,maxDefined:i}=this.getUserBounds();let a=this.min,s=this.max;const l=f=>a=e?a:f,d=f=>s=i?s:f;a===s&&(a<=0?(l(1),d(10)):(l(ng(a,-1)),d(ng(s,1)))),a<=0&&l(ng(s,-1)),s<=0&&d(ng(a,1)),this.min=a,this.max=s}buildTicks(){const e=this.options,i={min:this._userMin,max:this._userMax},a=dke(i,this);return e.bounds==="ticks"&&FJ(a,this,"value"),e.reverse?(a.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),a}getLabelForValue(e){return e===void 0?"0":hS(e,this.chart.options.locale,this.options.ticks.format)}configure(){const e=this.min;super.configure(),this._startValue=op(e),this._valueRange=op(this.max)-op(e)}getPixelForValue(e){return(e===void 0||e===0)&&(e=this.min),e===null||isNaN(e)?NaN:this.getPixelForDecimal(e===this.min?0:(op(e)-this._startValue)/this._valueRange)}getValueForPixel(e){const i=this.getDecimalForPixel(e);return Math.pow(10,this._startValue+i*this._valueRange)}}wn(yD,"id","logarithmic"),wn(yD,"defaults",{ticks:{callback:EC.formatters.logarithmic,major:{enabled:!0}}});function vD(n){const e=n.ticks;if(e.display&&n.display){const i=Ps(e.backdropPadding);return Ui(e.font&&e.font.size,Ja.font.size)+i.height}return 0}function hke(n,e,i){return i=ha(i)?i:[i],{w:xPe(n,e.string,i),h:i.length*e.lineHeight}}function sj(n,e,i,a,s){return n===a||n===s?{start:e-i/2,end:e+i/2}:n<a||n>s?{start:e-i,end:e}:{start:e,end:e+i}}function fke(n){const e={l:n.left+n._padding.left,r:n.right-n._padding.right,t:n.top+n._padding.top,b:n.bottom-n._padding.bottom},i=Object.assign({},e),a=[],s=[],l=n._pointLabels.length,d=n.options.pointLabels,f=d.centerPointLabels?ma/l:0;for(let p=0;p<l;p++){const y=d.setContext(n.getPointLabelContext(p));s[p]=y.padding;const _=n.getPointPosition(p,n.drawingArea+s[p],f),b=zo(y.font),S=hke(n.ctx,b,n._pointLabels[p]);a[p]=S;const A=Yl(n.getIndexAngle(p)+f),P=Math.round(lO(A)),L=sj(P,_.x,S.w,0,180),k=sj(P,_.y,S.h,90,270);pke(i,e,A,L,k)}n.setCenterPoint(e.l-i.l,i.r-e.r,e.t-i.t,i.b-e.b),n._pointLabelItems=yke(n,a,s)}function pke(n,e,i,a,s){const l=Math.abs(Math.sin(i)),d=Math.abs(Math.cos(i));let f=0,p=0;a.start<e.l?(f=(e.l-a.start)/l,n.l=Math.min(n.l,e.l-f)):a.end>e.r&&(f=(a.end-e.r)/l,n.r=Math.max(n.r,e.r+f)),s.start<e.t?(p=(e.t-s.start)/d,n.t=Math.min(n.t,e.t-p)):s.end>e.b&&(p=(s.end-e.b)/d,n.b=Math.max(n.b,e.b+p))}function mke(n,e,i){const a=n.drawingArea,{extra:s,additionalAngle:l,padding:d,size:f}=i,p=n.getPointPosition(e,a+s+d,l),y=Math.round(lO(Yl(p.angle+ho))),_=xke(p.y,f.h,y),b=vke(y),S=_ke(p.x,f.w,b);return{visible:!0,x:p.x,y:_,textAlign:b,left:S,top:_,right:S+f.w,bottom:_+f.h}}function gke(n,e){if(!e)return!0;const{left:i,top:a,right:s,bottom:l}=n;return!(Bh({x:i,y:a},e)||Bh({x:i,y:l},e)||Bh({x:s,y:a},e)||Bh({x:s,y:l},e))}function yke(n,e,i){const a=[],s=n._pointLabels.length,l=n.options,{centerPointLabels:d,display:f}=l.pointLabels,p={extra:vD(l)/2,additionalAngle:d?ma/s:0};let y;for(let _=0;_<s;_++){p.padding=i[_],p.size=e[_];const b=mke(n,_,p);a.push(b),f==="auto"&&(b.visible=gke(b,y),b.visible&&(y=b))}return a}function vke(n){return n===0||n===180?"center":n<180?"left":"right"}function _ke(n,e,i){return i==="right"?n-=e:i==="center"&&(n-=e/2),n}function xke(n,e,i){return i===90||i===270?n-=e/2:(i>270||i<90)&&(n-=e),n}function bke(n,e,i){const{left:a,top:s,right:l,bottom:d}=i,{backdropColor:f}=e;if(!mr(f)){const p=Dg(e.borderRadius),y=Ps(e.backdropPadding);n.fillStyle=f;const _=a-y.left,b=s-y.top,S=l-a+y.width,A=d-s+y.height;Object.values(p).some(P=>P!==0)?(n.beginPath(),kw(n,{x:_,y:b,w:S,h:A,radius:p}),n.fill()):n.fillRect(_,b,S,A)}}function wke(n,e){const{ctx:i,options:{pointLabels:a}}=n;for(let s=e-1;s>=0;s--){const l=n._pointLabelItems[s];if(!l.visible)continue;const d=a.setContext(n.getPointLabelContext(s));bke(i,d,l);const f=zo(d.font),{x:p,y,textAlign:_}=l;Kg(i,n._pointLabels[s],p,y+f.lineHeight/2,f,{color:d.color,textAlign:_,textBaseline:"middle"})}}function PQ(n,e,i,a){const{ctx:s}=n;if(i)s.arc(n.xCenter,n.yCenter,e,0,pa);else{let l=n.getPointPosition(0,e);s.moveTo(l.x,l.y);for(let d=1;d<a;d++)l=n.getPointPosition(d,e),s.lineTo(l.x,l.y)}}function Ske(n,e,i,a,s){const l=n.ctx,d=e.circular,{color:f,lineWidth:p}=e;!d&&!a||!f||!p||i<0||(l.save(),l.strokeStyle=f,l.lineWidth=p,l.setLineDash(s.dash),l.lineDashOffset=s.dashOffset,l.beginPath(),PQ(n,i,d,a),l.closePath(),l.stroke(),l.restore())}function Eke(n,e,i){return Wp(n,{label:i,index:e,type:"pointLabel"})}class eb extends PT{constructor(e){super(e),this.xCenter=void 0,this.yCenter=void 0,this.drawingArea=void 0,this._pointLabels=[],this._pointLabelItems=[]}setDimensions(){const e=this._padding=Ps(vD(this.options)/2),i=this.width=this.maxWidth-e.width,a=this.height=this.maxHeight-e.height;this.xCenter=Math.floor(this.left+i/2+e.left),this.yCenter=Math.floor(this.top+a/2+e.top),this.drawingArea=Math.floor(Math.min(i,a)/2)}determineDataLimits(){const{min:e,max:i}=this.getMinMax(!1);this.min=Ka(e)&&!isNaN(e)?e:0,this.max=Ka(i)&&!isNaN(i)?i:0,this.handleTickRangeOptions()}computeTickLimit(){return Math.ceil(this.drawingArea/vD(this.options))}generateTickLabels(e){PT.prototype.generateTickLabels.call(this,e),this._pointLabels=this.getLabels().map((i,a)=>{const s=aa(this.options.pointLabels.callback,[i,a],this);return s||s===0?s:""}).filter((i,a)=>this.chart.getDataVisibility(a))}fit(){const e=this.options;e.display&&e.pointLabels.display?fke(this):this.setCenterPoint(0,0,0,0)}setCenterPoint(e,i,a,s){this.xCenter+=Math.floor((e-i)/2),this.yCenter+=Math.floor((a-s)/2),this.drawingArea-=Math.min(this.drawingArea/2,Math.max(e,i,a,s))}getIndexAngle(e){const i=pa/(this._pointLabels.length||1),a=this.options.startAngle||0;return Yl(e*i+gu(a))}getDistanceFromCenterForValue(e){if(mr(e))return NaN;const i=this.drawingArea/(this.max-this.min);return this.options.reverse?(this.max-e)*i:(e-this.min)*i}getValueForDistanceFromCenter(e){if(mr(e))return NaN;const i=e/(this.drawingArea/(this.max-this.min));return this.options.reverse?this.max-i:this.min+i}getPointLabelContext(e){const i=this._pointLabels||[];if(e>=0&&e<i.length){const a=i[e];return Eke(this.getContext(),e,a)}}getPointPosition(e,i,a=0){const s=this.getIndexAngle(e)-ho+a;return{x:Math.cos(s)*i+this.xCenter,y:Math.sin(s)*i+this.yCenter,angle:s}}getPointPositionForValue(e,i){return this.getPointPosition(e,this.getDistanceFromCenterForValue(i))}getBasePosition(e){return this.getPointPositionForValue(e||0,this.getBaseValue())}getPointLabelPosition(e){const{left:i,top:a,right:s,bottom:l}=this._pointLabelItems[e];return{left:i,top:a,right:s,bottom:l}}drawBackground(){const{backgroundColor:e,grid:{circular:i}}=this.options;if(e){const a=this.ctx;a.save(),a.beginPath(),PQ(this,this.getDistanceFromCenterForValue(this._endValue),i,this._pointLabels.length),a.closePath(),a.fillStyle=e,a.fill(),a.restore()}}drawGrid(){const e=this.ctx,i=this.options,{angleLines:a,grid:s,border:l}=i,d=this._pointLabels.length;let f,p,y;if(i.pointLabels.display&&wke(this,d),s.display&&this.ticks.forEach((_,b)=>{if(b!==0){p=this.getDistanceFromCenterForValue(_.value);const S=this.getContext(b),A=s.setContext(S),P=l.setContext(S);Ske(this,A,p,d,P)}}),a.display){for(e.save(),f=d-1;f>=0;f--){const _=a.setContext(this.getPointLabelContext(f)),{color:b,lineWidth:S}=_;!S||!b||(e.lineWidth=S,e.strokeStyle=b,e.setLineDash(_.borderDash),e.lineDashOffset=_.borderDashOffset,p=this.getDistanceFromCenterForValue(i.ticks.reverse?this.min:this.max),y=this.getPointPosition(f,p),e.beginPath(),e.moveTo(this.xCenter,this.yCenter),e.lineTo(y.x,y.y),e.stroke())}e.restore()}}drawBorder(){}drawLabels(){const e=this.ctx,i=this.options,a=i.ticks;if(!a.display)return;const s=this.getIndexAngle(0);let l,d;e.save(),e.translate(this.xCenter,this.yCenter),e.rotate(s),e.textAlign="center",e.textBaseline="middle",this.ticks.forEach((f,p)=>{if(p===0&&!i.reverse)return;const y=a.setContext(this.getContext(p)),_=zo(y.font);if(l=this.getDistanceFromCenterForValue(this.ticks[p].value),y.showLabelBackdrop){e.font=_.string,d=e.measureText(f.label).width,e.fillStyle=y.backdropColor;const b=Ps(y.backdropPadding);e.fillRect(-d/2-b.left,-l-_.size/2-b.top,d+b.width,_.size+b.height)}Kg(e,f.label,0,-l,_,{color:y.color,strokeColor:y.textStrokeColor,strokeWidth:y.textStrokeWidth})}),e.restore()}drawTitle(){}}wn(eb,"id","radialLinear"),wn(eb,"defaults",{display:!0,animate:!0,position:"chartArea",angleLines:{display:!0,lineWidth:1,borderDash:[],borderDashOffset:0},grid:{circular:!1},startAngle:0,ticks:{showLabelBackdrop:!0,callback:EC.formatters.numeric},pointLabels:{backdropColor:void 0,backdropPadding:2,display:!0,font:{size:10},callback(e){return e},padding:5,centerPointLabels:!1}}),wn(eb,"defaultRoutes",{"angleLines.color":"borderColor","pointLabels.color":"color","ticks.color":"color"}),wn(eb,"descriptors",{angleLines:{_fallback:"grid"}});const PC={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},xl=Object.keys(PC);function lj(n,e){return n-e}function cj(n,e){if(mr(e))return null;const i=n._adapter,{parser:a,round:s,isoWeekday:l}=n._parseOpts;let d=e;return typeof a=="function"&&(d=a(d)),Ka(d)||(d=typeof a=="string"?i.parse(d,a):i.parse(d)),d===null?null:(s&&(d=s==="week"&&(S_(l)||l===!0)?i.startOf(d,"isoWeek",l):i.startOf(d,s)),+d)}function uj(n,e,i,a){const s=xl.length;for(let l=xl.indexOf(n);l<s-1;++l){const d=PC[xl[l]],f=d.steps?d.steps:Number.MAX_SAFE_INTEGER;if(d.common&&Math.ceil((i-e)/(f*d.size))<=a)return xl[l]}return xl[s-1]}function Mke(n,e,i,a,s){for(let l=xl.length-1;l>=xl.indexOf(i);l--){const d=xl[l];if(PC[d].common&&n._adapter.diff(s,a,d)>=e-1)return d}return xl[i?xl.indexOf(i):0]}function Tke(n){for(let e=xl.indexOf(n)+1,i=xl.length;e<i;++e)if(PC[xl[e]].common)return xl[e]}function dj(n,e,i){if(!i)n[e]=!0;else if(i.length){const{lo:a,hi:s}=cO(i,e),l=i[a]>=e?i[a]:i[s];n[l]=!0}}function Ake(n,e,i,a){const s=n._adapter,l=+s.startOf(e[0].value,a),d=e[e.length-1].value;let f,p;for(f=l;f<=d;f=+s.add(f,1,a))p=i[f],p>=0&&(e[p].major=!0);return e}function hj(n,e,i){const a=[],s={},l=e.length;let d,f;for(d=0;d<l;++d)f=e[d],s[f]=d,a.push({value:f,major:!1});return l===0||!i?a:Ake(n,a,s,i)}class Ow extends ly{constructor(e){super(e),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(e,i={}){const a=e.time||(e.time={}),s=this._adapter=new OIe._date(e.adapters.date);s.init(i),Ab(a.displayFormats,s.formats()),this._parseOpts={parser:a.parser,round:a.round,isoWeekday:a.isoWeekday},super.init(e),this._normalized=i.normalized}parse(e,i){return e===void 0?null:cj(this,e)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const e=this.options,i=this._adapter,a=e.time.unit||"day";let{min:s,max:l,minDefined:d,maxDefined:f}=this.getUserBounds();function p(y){!d&&!isNaN(y.min)&&(s=Math.min(s,y.min)),!f&&!isNaN(y.max)&&(l=Math.max(l,y.max))}(!d||!f)&&(p(this._getLabelBounds()),(e.bounds!=="ticks"||e.ticks.source!=="labels")&&p(this.getMinMax(!1))),s=Ka(s)&&!isNaN(s)?s:+i.startOf(Date.now(),a),l=Ka(l)&&!isNaN(l)?l:+i.endOf(Date.now(),a)+1,this.min=Math.min(s,l-1),this.max=Math.max(s+1,l)}_getLabelBounds(){const e=this.getLabelTimestamps();let i=Number.POSITIVE_INFINITY,a=Number.NEGATIVE_INFINITY;return e.length&&(i=e[0],a=e[e.length-1]),{min:i,max:a}}buildTicks(){const e=this.options,i=e.time,a=e.ticks,s=a.source==="labels"?this.getLabelTimestamps():this._generate();e.bounds==="ticks"&&s.length&&(this.min=this._userMin||s[0],this.max=this._userMax||s[s.length-1]);const l=this.min,d=this.max,f=sPe(s,l,d);return this._unit=i.unit||(a.autoSkip?uj(i.minUnit,this.min,this.max,this._getLabelCapacity(l)):Mke(this,f.length,i.minUnit,this.min,this.max)),this._majorUnit=!a.major.enabled||this._unit==="year"?void 0:Tke(this._unit),this.initOffsets(s),e.reverse&&f.reverse(),hj(this,f,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(e=>+e.value))}initOffsets(e=[]){let i=0,a=0,s,l;this.options.offset&&e.length&&(s=this.getDecimalForValue(e[0]),e.length===1?i=1-s:i=(this.getDecimalForValue(e[1])-s)/2,l=this.getDecimalForValue(e[e.length-1]),e.length===1?a=l:a=(l-this.getDecimalForValue(e[e.length-2]))/2);const d=e.length<3?.5:.25;i=Go(i,0,d),a=Go(a,0,d),this._offsets={start:i,end:a,factor:1/(i+1+a)}}_generate(){const e=this._adapter,i=this.min,a=this.max,s=this.options,l=s.time,d=l.unit||uj(l.minUnit,i,a,this._getLabelCapacity(i)),f=Ui(s.ticks.stepSize,1),p=d==="week"?l.isoWeekday:!1,y=S_(p)||p===!0,_={};let b=i,S,A;if(y&&(b=+e.startOf(b,"isoWeek",p)),b=+e.startOf(b,y?"day":d),e.diff(a,i,d)>1e5*f)throw new Error(i+" and "+a+" are too far apart with stepSize of "+f+" "+d);const P=s.ticks.source==="data"&&this.getDataTimestamps();for(S=b,A=0;S<a;S=+e.add(S,f,d),A++)dj(_,S,P);return(S===a||s.bounds==="ticks"||A===1)&&dj(_,S,P),Object.keys(_).sort(lj).map(L=>+L)}getLabelForValue(e){const i=this._adapter,a=this.options.time;return a.tooltipFormat?i.format(e,a.tooltipFormat):i.format(e,a.displayFormats.datetime)}format(e,i){const s=this.options.time.displayFormats,l=this._unit,d=i||s[l];return this._adapter.format(e,d)}_tickFormatFunction(e,i,a,s){const l=this.options,d=l.ticks.callback;if(d)return aa(d,[e,i,a],this);const f=l.time.displayFormats,p=this._unit,y=this._majorUnit,_=p&&f[p],b=y&&f[y],S=a[i],A=y&&b&&S&&S.major;return this._adapter.format(e,s||(A?b:_))}generateTickLabels(e){let i,a,s;for(i=0,a=e.length;i<a;++i)s=e[i],s.label=this._tickFormatFunction(s.value,i,e)}getDecimalForValue(e){return e===null?NaN:(e-this.min)/(this.max-this.min)}getPixelForValue(e){const i=this._offsets,a=this.getDecimalForValue(e);return this.getPixelForDecimal((i.start+a)*i.factor)}getValueForPixel(e){const i=this._offsets,a=this.getDecimalForPixel(e)/i.factor-i.end;return this.min+a*(this.max-this.min)}_getLabelSize(e){const i=this.options.ticks,a=this.ctx.measureText(e).width,s=gu(this.isHorizontal()?i.maxRotation:i.minRotation),l=Math.cos(s),d=Math.sin(s),f=this._resolveTickFontOptions(0).size;return{w:a*l+f*d,h:a*d+f*l}}_getLabelCapacity(e){const i=this.options.time,a=i.displayFormats,s=a[i.unit]||a.millisecond,l=this._tickFormatFunction(e,0,hj(this,[e],this._majorUnit),s),d=this._getLabelSize(l),f=Math.floor(this.isHorizontal()?this.width/d.w:this.height/d.h)-1;return f>0?f:1}getDataTimestamps(){let e=this._cache.data||[],i,a;if(e.length)return e;const s=this.getMatchingVisibleMetas();if(this._normalized&&s.length)return this._cache.data=s[0].controller.getAllParsedValues(this);for(i=0,a=s.length;i<a;++i)e=e.concat(s[i].controller.getAllParsedValues(this));return this._cache.data=this.normalize(e)}getLabelTimestamps(){const e=this._cache.labels||[];let i,a;if(e.length)return e;const s=this.getLabels();for(i=0,a=s.length;i<a;++i)e.push(cj(this,s[i]));return this._cache.labels=this._normalized?e:this.normalize(e)}normalize(e){return WJ(e.sort(lj))}}wn(Ow,"id","time"),wn(Ow,"defaults",{bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}});function WE(n,e,i){let a=0,s=n.length-1,l,d,f,p;i?(e>=n[a].pos&&e<=n[s].pos&&({lo:a,hi:s}=Fh(n,"pos",e)),{pos:l,time:f}=n[a],{pos:d,time:p}=n[s]):(e>=n[a].time&&e<=n[s].time&&({lo:a,hi:s}=Fh(n,"time",e)),{time:l,pos:f}=n[a],{time:d,pos:p}=n[s]);const y=d-l;return y?f+(p-f)*(e-l)/y:f}class _D extends Ow{constructor(e){super(e),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const e=this._getTimestampsForTable(),i=this._table=this.buildLookupTable(e);this._minPos=WE(i,this.min),this._tableRange=WE(i,this.max)-this._minPos,super.initOffsets(e)}buildLookupTable(e){const{min:i,max:a}=this,s=[],l=[];let d,f,p,y,_;for(d=0,f=e.length;d<f;++d)y=e[d],y>=i&&y<=a&&s.push(y);if(s.length<2)return[{time:i,pos:0},{time:a,pos:1}];for(d=0,f=s.length;d<f;++d)_=s[d+1],p=s[d-1],y=s[d],Math.round((_+p)/2)!==y&&l.push({time:y,pos:d/(f-1)});return l}_generate(){const e=this.min,i=this.max;let a=super.getDataTimestamps();return(!a.includes(e)||!a.length)&&a.splice(0,0,e),(!a.includes(i)||a.length===1)&&a.push(i),a.sort((s,l)=>s-l)}_getTimestampsForTable(){let e=this._cache.all||[];if(e.length)return e;const i=this.getDataTimestamps(),a=this.getLabelTimestamps();return i.length&&a.length?e=this.normalize(i.concat(a)):e=i.length?i:a,e=this._cache.all=e,e}getDecimalForValue(e){return(WE(this._table,e)-this._minPos)/this._tableRange}getValueForPixel(e){const i=this._offsets,a=this.getDecimalForPixel(e)/i.factor-i.end;return WE(this._table,a*this._tableRange+this._minPos,!0)}}wn(_D,"id","timeseries"),wn(_D,"defaults",Ow.defaults);var Cke=Object.freeze({__proto__:null,CategoryScale:mD,LinearScale:gD,LogarithmicScale:yD,RadialLinearScale:eb,TimeScale:Ow,TimeSeriesScale:_D});const Pke=[zIe,dLe,ake,Cke],IQ="label";function fj(n,e){typeof n=="function"?n(e):n&&(n.current=e)}function Ike(n,e){const i=n.options;i&&e&&Object.assign(i,e)}function RQ(n,e){n.labels=e}function LQ(n,e){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:IQ;const a=[];n.datasets=e.map(s=>{const l=n.datasets.find(d=>d[i]===s[i]);return!l||!s.data||a.includes(l)?{...s}:(a.push(l),Object.assign(l,s),l)})}function Rke(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:IQ;const i={labels:[],datasets:[]};return RQ(i,n.labels),LQ(i,n.datasets,e),i}function Lke(n,e){const{height:i=150,width:a=300,redraw:s=!1,datasetIdKey:l,type:d,data:f,options:p,plugins:y=[],fallbackContent:_,updateMode:b,...S}=n,A=ne.useRef(null),P=ne.useRef(),L=()=>{A.current&&(P.current=new CC(A.current,{type:d,data:Rke(f,l),options:p&&{...p},plugins:y}),fj(e,P.current))},k=()=>{fj(e,null),P.current&&(P.current.destroy(),P.current=null)};return ne.useEffect(()=>{!s&&P.current&&p&&Ike(P.current,p)},[s,p]),ne.useEffect(()=>{!s&&P.current&&RQ(P.current.config.data,f.labels)},[s,f.labels]),ne.useEffect(()=>{!s&&P.current&&f.datasets&&LQ(P.current.config.data,f.datasets,l)},[s,f.datasets]),ne.useEffect(()=>{P.current&&(s?(k(),setTimeout(L)):P.current.update(b))},[s,p,f.labels,f.datasets,b]),ne.useEffect(()=>{P.current&&(k(),setTimeout(L))},[d]),ne.useEffect(()=>(L(),()=>k()),[]),U("canvas",{...Object.assign({ref:A,role:"img",height:i,width:a},S),children:_})}const kke=ne.forwardRef(Lke);function kQ(n,e){return CC.register(e),ne.forwardRef((i,a)=>U(kke,{...Object.assign({},i,{ref:a,type:n})}))}const DQ=kQ("line",Rb),xO=kQ("radar",kb),Dke=n=>{const e=document.createElement("canvas"),i=e.getContext("2d"),a=e.width/2,s=e.height/2,l=15,d=23;return i.beginPath(),i.arc(a,s,l,0,2*Math.PI,!1),i.fillStyle=n,i.fill(),i.beginPath(),i.arc(a,s,d,0,2*Math.PI,!1),i.lineWidth=1,i.strokeStyle=n,i.stroke(),e},zke=(n,e)=>i=>({responsive:!0,elements:{line:{},point:{radius:23,hoverRadius:23}},scales:{x:{type:"category",labels:i,offset:!0,grid:{display:!1},ticks:{display:!1},border:{color:"rgb(255, 255, 255)"}},y:{type:"category",offset:!0,labels:n,reverse:!0,ticks:{color:e,font:{size:20},padding:10},grid:{color:"rgba(255, 255, 255, 0.15)"},border:{display:!1}}},plugins:{legend:{display:!1},tooltip:{enabled:!1}}}),Oke=(n,e)=>(i,a,s)=>{const l=[i,...a],f=l.map(y=>y[s]).map(y=>n[y-1]),p=y=>{const _=n.indexOf(y);if(_===-1)throw new Error("Invalid value");return e[_]};return{xLabels:l.map(y=>y.City),yLabels:n,datasets:f.map((y,_)=>({label:y,data:new Array(6).fill(null).map((b,S)=>_===S?y:null),pointStyle:Dke(p(y)),showLine:!1}))}};var bO={},zQ={exports:{}};(function(n){function e(i){return i&&i.__esModule?i:{default:i}}n.exports=e,n.exports.__esModule=!0,n.exports.default=n.exports})(zQ);var OQ=zQ.exports,qL={};const Nke=Tj(vpe);var pj;function NQ(){return pj||(pj=1,function(n){"use client";Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"default",{enumerable:!0,get:function(){return e.createSvgIcon}});var e=Nke}(qL)),qL}const FQ=Tj(dhe);var Fke=OQ;Object.defineProperty(bO,"__esModule",{value:!0});var wO=bO.default=void 0,Bke=Fke(NQ()),Uke=FQ,Wke=(0,Bke.default)((0,Uke.jsx)("path",{d:"M7.41 8.59 12 13.17l4.59-4.58L18 10l-6 6-6-6 1.41-1.41z"}),"KeyboardArrowDown");wO=bO.default=Wke;var SO={},Vke=OQ;Object.defineProperty(SO,"__esModule",{value:!0});var EO=SO.default=void 0,Gke=Vke(NQ()),Hke=FQ,jke=(0,Gke.default)((0,Hke.jsx)("path",{d:"M7.41 15.41 12 10.83l4.59 4.58L18 14l-6-6-6 6z"}),"KeyboardArrowUp");EO=SO.default=jke;const $ke=({cities:n,value:e,onChange:i})=>{const[a,s]=ne.useState(null),l=!!a,d=p=>{s(p.currentTarget)},f=()=>{s(null)};return _e("div",{style:{width:220,marginTop:0},children:[U(oi,{onClick:d,endIcon:l?U(EO,{}):U(wO,{}),style:{textTransform:"none",color:"#fff",fontSize:"2.5vh",fontWeight:400},children:e}),U(Hg,{anchorEl:a,open:l,onClose:f,children:n.map(p=>U(Tp,{selected:p===e,onClick:()=>{f(),i(p)},children:p},p))})]})},Yke=({currentCity:n,selectedCities:e,cities:i,onChange:a})=>_e("div",{style:{display:"flex",textAlign:"center",paddingLeft:93,paddingRight:10,justifyContent:"space-around"},children:[U("div",{style:{width:220,height:35,marginTop:0,display:"flex",justifyContent:"center",alignItems:"center"},children:U("span",{style:{color:"#fff",fontSize:"2.5vh",fontWeight:400,fontFamily:"'Roboto', 'Helvetica', 'Arial', sans-serif"},children:n})}),e.map((s,l)=>U($ke,{cities:i.filter(d=>!e.includes(d)&&d!==n),value:s,onChange:a(l)},s))]}),qke=(n,e,i,a)=>{const[s,l]=ne.useState(i.filter(f=>f!==e).map(f=>a.find(p=>p.City===f)).slice(0,5).toSorted((f,p)=>f[n]-p[n]));return[s,f=>p=>{const y=a.find(_=>_.City===p);l(s.map((_,b)=>b===f?y:_).toSorted((_,b)=>_[n]-b[n]))}]},Xke=({categoryDataArr:n,currentCity:e,category:i,yLabels:a,yColors:s})=>{const l=n.find(b=>b.City===e),d=n.map(b=>b.City),[f,p]=qke(i,e,d,n),y=zke(a,s)([l,...f].map(b=>b.City)),_=Oke(a,s)(l,f,i);return _e("div",{style:{width:"100%",height:"auto",position:"absolute",bottom:"5vh",left:"0"},children:[U(DQ,{width:"1260px",height:"330px",options:y,data:_}),U(Yke,{currentCity:l.City,selectedCities:f.map(b=>b.City),cities:n.map(b=>b.City),onChange:p})]})},Zke=({value:n,cities:e,color:i,onChange:a})=>{const[s,l]=ne.useState(null),d=p=>{l(p.currentTarget)},f=()=>{l(null)};return _e("div",{children:[U(oi,{onClick:d,children:_e("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"},children:[U("div",{style:{width:"1.2vh",height:"1.2vh",borderRadius:"50%",backgroundColor:i,marginRight:"1vh"}}),U("div",{style:{fontFamily:"SuisseIntl-Light",fontSize:"3.1vh",fontWeight:600,textAlign:"center",color:"#000",textTransform:"none"},children:n}),U("div",{style:{marginLeft:"1vh"},children:U("img",{src:"/assets/smallArrowDown.svg",alt:"arrow down"})})]})}),U(Hg,{id:"demo-positioned-menu","aria-labelledby":"demo-positioned-button",anchorEl:s,open:!!s,onClose:f,anchorOrigin:{vertical:"top",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"},children:e==null?void 0:e.map((p,y)=>U(Tp,{onClick:()=>{f(),a(p)},children:p},p))})]})},Kke=({currentCity:n,selectedCities:e,cities:i,colors:a,onChange:s})=>_e("div",{style:{boxSizing:"border-box",position:"absolute",left:"8vh",top:"53vh"},children:[U(oi,{type:"button",children:_e("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"},children:[U("div",{style:{width:"1.2vh",height:"1.2vh",borderRadius:"50%",backgroundColor:a[0],marginRight:"1vh"}}),U("div",{style:{fontFamily:"SuisseIntl-Regular",fontSize:"3.1vh",fontWeight:600,textAlign:"center",color:a[0],textTransform:"none"},children:n})]})}),e.map((l,d)=>U(Zke,{value:l,cities:i.filter(f=>!e.includes(f)&&f!==n),color:a[d+1],onChange:s(d)},l))]}),mj=(n,e)=>n.data.filter(i=>i.category===e).map(i=>({city:n.city,...i})),Jke=()=>({responsive:!0,plugins:{tooltip:{enabled:!0},legend:{display:!1}},scales:{r:{ticks:{stepSize:1},angleLines:{display:!1},pointLabels:{font:{size:11}},suggestedMin:0}}}),Qke=n=>(e,i)=>{const a=[e,...i];return{labels:e.map(s=>e5e(s.indicator)),datasets:a.map((s,l)=>({label:s[0].city,backgroundColor:"transparent",borderWidth:l?1:8,borderColor:n[l],pointBackgroundColor:n[l],pointBorderColor:n[l],pointHoverBackgroundColor:"#fff",pointHoverBorderColor:"rgba(34, 202, 236, 1)",pointRadius:5,data:s.map(d=>d.value)}))}},e5e=n=>{const e=n.split(" "),i=[];let a="";for(let s=0;s<e.length;s++)a.length+e[s].length<30?a+=e[s]+" ":(i.push(a),a=e[s]+" ");return i.push(a),i},t5e=(n,e,i)=>{const[a,s]=ne.useState(e.filter(d=>d!==n).map(d=>i.find(f=>f[0].city===d)).slice(0,5));return[a,d=>f=>{const p=i.find(y=>y[0].city===f);s(a.map((y,_)=>_===d?p:y))}]},n5e=({indicatorDataByCitiesArr:n,currentCity:e,category:i,colors:a})=>{const s=n.map(b=>b.city),l=mj(n.find(b=>b.city===e),i),d=n.map(b=>mj(b,i)),[f,p]=t5e(e,s,d),y=Jke(),_=Qke(a)(l,f);return _e(ko,{children:[U(xO,{style:{position:"absolute",top:"50%",right:"4vh",transform:"translateY(-50%)",boxSizing:"border-box",display:"block",height:805,width:1e3},data:_,options:y}),U(Kke,{currentCity:e,selectedCities:f.map(b=>b[0].city),cities:s,colors:a,onChange:p})]})},i5e=n=>{const e=document.createElement("canvas"),i=e.getContext("2d"),a=e.width/2,s=e.height/2,l=15,d=23;return i.beginPath(),i.arc(a,s,l,0,2*Math.PI,!1),i.fillStyle=n,i.fill(),i.beginPath(),i.arc(a,s,d,0,2*Math.PI,!1),i.lineWidth=1,i.strokeStyle=n,i.stroke(),e},gj=(n,e,i)=>({city:n.city,...n.data.find(a=>a.category===e&&a.indicator===i)}),r5e=(n,e)=>{const i=[n,...e],a=Math.min(...i.map(l=>l.natural_value)),s=i.map(l=>l.city);return{responsive:!0,elements:{line:{},point:{radius:23,hoverRadius:23}},scales:{x:{type:"category",labels:s,offset:!0,grid:{display:!1},border:{color:"rgb(255, 255, 255)"},ticks:{display:!1}},y:{suggestedMin:a,ticks:{color:"rgba(255, 255, 255, 0.3)",font:{size:20},padding:10,maxTicksLimit:10},grid:{color:"rgba(255, 255, 255, 0.15)"},border:{display:!1}}},plugins:{legend:{display:!1},tooltip:{enabled:!1}}}},a5e=(n,e)=>(i,a)=>{const s=[i,...a],l=d=>e[d-1];return{xLabels:s.map(d=>d.city),yLabels:n,datasets:s.map((d,f)=>({label:d.city,data:new Array(s.length).fill(null).map((p,y)=>f===y?d.natural_value:null),pointStyle:i5e(l(d.value)),showLine:!1}))}},o5e=({cities:n,value:e,onChange:i})=>{const[a,s]=ne.useState(null),l=!!a,d=p=>{s(p.currentTarget)},f=()=>{s(null)};return _e("div",{style:{width:220,marginTop:0},children:[U(oi,{onClick:d,endIcon:l?U(EO,{}):U(wO,{}),style:{textTransform:"none",color:"#fff",fontSize:"2.5vh",fontWeight:400},children:e}),U(Hg,{anchorEl:a,open:l,onClose:f,children:n.map(p=>U(Tp,{selected:p===e,onClick:()=>{f(),i(p)},children:p},p))})]})},s5e=({currentCity:n,selectedCities:e,cities:i,onChange:a})=>_e("div",{style:{display:"flex",textAlign:"center",paddingLeft:93,paddingRight:10,justifyContent:"space-around"},children:[U("div",{style:{width:220,height:35,marginTop:0,display:"flex",justifyContent:"center",alignItems:"center"},children:U("span",{style:{color:"#fff",fontSize:"2.5vh",fontWeight:400,fontFamily:"'Roboto', 'Helvetica', 'Arial', sans-serif"},children:n})}),e.map((s,l)=>U(o5e,{cities:i.filter(d=>!e.includes(d)&&d!==n),value:s,onChange:a(l)},s))]}),l5e=(n,e,i)=>{const[a,s]=ne.useState(e.filter(d=>d!==n).map(d=>i.find(f=>f.city===d)).slice(0,5).sort((d,f)=>d.natural_value-f.natural_value));return[a,d=>f=>{const p=i.find(y=>y.city===f);s(a.map((y,_)=>_===d?p:y).toSorted((y,_)=>y.natural_value-_.natural_value))}]},c5e=({indicatorDataByCitiesArr:n,currentCity:e,category:i,indicator:a,yLabels:s,yColors:l})=>{const d=n.map(A=>A.city),f=gj(n.find(A=>A.city===e),i,a),p=n.map(A=>gj(A,i,a)),[y,_]=l5e(e,d,p),b=r5e(f,y),S=a5e(s,l)(f,y);return _e("div",{style:{width:"100%",height:"auto",position:"absolute",bottom:"5vh",left:"0"},children:[U(DQ,{width:"1260px",height:"330px",options:b,data:S}),U(s5e,{currentCity:f.city,selectedCities:y.map(A=>A.city),cities:d,onChange:_})]})},yj={Air_pollution:`The Air Pollution category assesses the levels of air pollutants impacting the urban environment and residents. Air pollution directly affects public health, quality of life, and the environment in cities. In the Global South, this issue is particularly acute for many urban areas as industrialization and motorization rates here are still on the rise.\r
\r
We measure the concentration of the most important pollutants based on World Health Organization guidelines[2]. These indicators help us to evaluate the extent of air pollution and its impact on human health and the environment, enabling cities to take informed actions to reduce pollution.`,Water_pollution:`The Water Pollution category evaluates the quality of water sources and the impact of pollution on the urban environment and communities. Adequate clean water supply is essential for public health and the natural environment. Particularly, in the Global South, where access to safe water is often limited, while pollution sources are diverse.\r
\r
We measure the levels of contamination from pollutants, industrial waste, and inadequate sanitation based on the WHO standards while also evaluating the effectiveness of local efforts to mitigate water pollution and safeguard the health and well-being of their communities. These indicators help us to determine the extent of water pollution and the effectiveness of purification methods, gauging efforts to ensure clean and safe water.`,Land_use_and_waste:`The Land Use and Waste category assesses how cities manage land resources and handle waste. The issue of land and waste directly impacts urban development and environmental sustainability. Rapid urbanization and resource constraints in the Global South pose distinct challenges to land use and waste management. The category also evaluates a city's efforts to expand green spaces and promote environmental sustainability. Urban greening directly affects livability, health, and resilience to climate change. Vegetation cover mitigates the effect of urban heat island cooling the environment. In the Global South, where rapid urbanization and environmental challenges it causes lead to significant inequalities, greening initiatives are crucial for improving quality of life.\r
\r
We measure land use practices, waste management methods, recycling rates, as well as waste disposal practices based on extensive scientific research. These indicators are designed to evaluate sustainable land management, waste reduction, and environmental protection that guide cities toward eco-friendliness.`,Natural_disaster_hazards:`The Natural Disaster Hazards category aims to assess a city's vulnerability to natural disasters and its capacity to mitigate their impact. For cities around the world, the problem of natural disasters is particularly acute due to higher population densities that multiply the damage caused by natural hazards. In the environmental and social settings of the Global South, this often becomes a key challenge for community safety.\r
\r
We measure resilience by evaluating natural conditions that can exacerbate the situation, as well as past records of extreme events including their type and volume of damage caused based on recent scientific studies. These indicators evaluate the impact of natural disasters on communities and overall sustainability.`,Water_availability:`The Water Availability category evaluates access to water resources. Water scarcity issues and population growth in many urban areas of the Global South make this issue essential for ensuring equitable access to drinking and technical water.\r
\r
It assesses the adequacy of water supply, and its affordability considering the cities' capacity to ensure equitable and sustainable access to water and sanitation services for their residents. These indicators reflect how cities address water security, resilience, and equitable access to such a vital resource.`,Food_availability:`The Food Availability category evaluates access to and availability of food resources. This category is often crucial in the Global South due to food security concerns, vulnerable populations, and sustainability challenges. This category is essential to consider as it measures equitable access to nutritious food addressing hunger and malnutrition.\r
\r
We capture and measure data on food supply chains and access to food. This assessment is designed to measure the cities' capacity to ensure a consistent and accessible food supply, as well as their ability to address hunger and nutritional requirements for their residents.`,Energy_availability:`The Energy Availability category specifically targets challenges related to ensuring reliable energy access, affordability, and sustainability of generation sources. It is essential in the Global South due to energy access disparities, sustainability challenges, and rapid economic development.\r
\r
We capture and measure data on energy infrastructure, electricity access, energy efficiency, and renewable energy adoption. This evaluation is intended to measure the cities' capacity to provide affordable and renewable energy for their residents, while also promoting environmental sustainability.`,Health:`The Health category assesses a city's healthcare infrastructure and residents access to healthcare. It centers on the distinct healthcare challenges faced by urban areas in the Global South, including intrinsic burdens of diseases that impact public health, healthcare infrastructure, and overall well-being. \r
\r
We capture and measure data on healthcare access, disease prevention, healthcare quality, and public health outcomes based on the extensive SDG-related WHO guidelines. This evaluation is crafted to assess the cities ability to deliver quality healthcare, reduce mortality rates, and enhance the well-being of residents, while also addressing their unique healthcare needs and challenges.`,Education:`The Education category assesses a citys commitment to high-quality education, access to schools, and educational outcomes. It addresses the unique educational challenges faced by the cities in the Global South due to their generally higher share of the younger population, including issues related to access, quality, and educational attainment.\r
\r
We capture and measure data on educational infrastructure, enrollment rates, as well as literacy and numeracy skills in line with the UN recommendations. This assessment aims to evaluate the cities capacity to provide accessible, high-quality education, promote educational attainment, and offer lifelong learning opportunities for their residents while addressing their specific educational needs and challenges.`,Wealth:`The Wealth category assesses a citys economic well-being and income distribution. This issue is crucial for the growing economies in the Global South facing vast disparities and poverty challenges.\r
\r
We capture and measure data on income distribution, poverty rates, and economic opportunities based on international practices. This assessment aims to evaluate the cities' capacity to address economic disparities, reduce poverty, and enhance economic well-being for their residents while considering their unique economic challenges.`,Safety:`The Safety category addresses issues related to road safety, crime, and overall safety. These challenges are inherent to cities of the Global South experiencing population growth, poverty, and increasing motorization rates. \r
\r
We capture and measure data on crime and traffic accident rates and law enforcement effectiveness based on substantive scientific research. This assessment aims to evaluate the cities ability to enhance safety, reduce crime, and promote overall security for their residents while addressing their safety challenges and concerns.`,Livability:`The Livability category assesses a city's quality of life, infrastructure, and overall living conditions. These challenges are quite acute for the rapidly changing urban environment in the Global South where authorities seek to improve living conditions and have to focus on infrastructure development.\r
\r
We capture and measure data on housing and infrastructure quality standards, communications, and basic healthcare service availability as well as public perception of this complex category. This evaluation is designed to assess the cities' efforts in promoting environmentally sustainable and livable urban environments, addressing infrastructure and accessibility challenges, and enhancing the overall quality of life for their residents.`,Transport:`The Transport category assesses a city's transportation and mobility infrastructure and accessibility. We address here the specific transportation challenges and infrastructure issues that rapidly urbanizing areas in the Global South face, including issues related to traffic congestion, accessibility, and public transportation.\r
\r
We capture and measure data on the outcomes of transport policies regarding public transit infrastructure, its accessibility, affordability and performance, traffic congestion, and green initiatives based on broad scientific evidence. This assessment aims to evaluate the cities transportation system performance that defines the mobility of their residents.`,Inclusion:`The Inclusion category assesses a citys commitment to inclusivity and equity, ensuring that all residents have equal access to opportunities and services. This category is crucial in the Global South as it addresses social disparities, discrimination, and social justice issues.\r
\r
We capture and measure data on social equity, access to education and healthcare, economic opportunities, and the presence of anti-discrimination policies based on extensive research. This assessment aims to evaluate the cities performance regarding social inclusion, gender equity, and support for groups at risk.`,Accountability:`The Accountability category assesses a citys commitment to transparency, governance, and accountability. This category is crucial in the Global South where the potential for change is maximized through the promotion of good governance and responsible public resources use.\r
\r
This assessment aims to evaluate cities commitment to transparent governance, accountability in resource allocation, and overall effective administration. This category shows how cities ensure responsible resource management, citizens trust, and effective governance.`,City_budget:`The City Budget category evaluates a citys financial management, allocation of funds, and budget transparency. The topic is of higher importance for the Global South as it encompasses the stability of government financial planning.\r
\r
We capture and measure data on budget allocations to essential services, financial transparency, fiscal responsibility, and adherence to financial sustainability principles. This assessment aims to evaluate the cities' capacity to manage their budgets effectively, ensure fiscal stability, and plan for long-term financial sustainability.`,SME:`The SME category evaluates a city's support for and the impact of SMEs on the local economy. SMEs in the Global South are a significant source of employment and economic growth. It is crucial for fostering local businesses and reducing unemployment. \r
\r
We capture and measure data on employment generation, business sustainability, and innovation related to SMEs and entrepreneurship. This assessment aims to evaluate the cities efforts in promoting a vibrant entrepreneurial ecosystem, supporting small and medium-sized enterprises.`,Public_services:`The Public Services category assesses the quality and accessibility of essential government and municipal services. This category is crucial in the Global South due to disparities in access to services. It is essential for improving living standards, health, and social equity.\r
\r
We capture and measure data on the availability and performance of key government services. This evaluation aims to represent the citys commitment to public service digitalization, efficient emergency response, and citizen engagement in the context of government services`,Sustainability_commitment:`The Sustainability Commitment category assesses a city's dedication and efforts to promote sustainability and environmental responsibility. This category is critical in the Global South because of the more pronounced need to prioritize sustainable development, resilience, and environmental stewardship.\r
\r
We capture and measure a city's sustainability policies, initiatives, and their effectiveness. This assessment aims to evaluate the cities' dedication to sustainable development, ESG principles, and the UN Sustainable Development Goals to build community resilience.`},u5e=[{City:"Dubai",Country:"UAE","Urban Resilience Index":"A-3",Environmental:4,Social:4,Governmental:4,"Air pollution":2,"Water pollution":4,"Land use and waste":5,"Natural disaster hazards":5,"Water availability":4,"Food availability":5,"Energy availability":4,Health:4,Education:5,Wealth:5,Safety:5,Livability:5,Transport:5,Inclusion:2,Accountability:5,"City budget":4,SME:4,"Public services":5,"Sustainability commitment":5},{City:"Expo City Dubai",Country:"UAE","Urban Resilience Index":"A-2",Environmental:4,Social:4,Governmental:4,"Air pollution":2,"Water pollution":4,"Land use and waste":4,"Natural disaster hazards":5,"Water availability":4,"Food availability":5,"Energy availability":4,Health:4,Education:5,Wealth:5,Safety:5,Livability:5,Transport:5,Inclusion:2,Accountability:5,"City budget":4,SME:4,"Public services":5,"Sustainability commitment":5},{City:"Valparaiso",Country:"Chile","Urban Resilience Index":"C-1",Environmental:2,Social:2,Governmental:2,"Air pollution":2,"Water pollution":4,"Land use and waste":3,"Natural disaster hazards":5,"Water availability":3,"Food availability":4,"Energy availability":5,Health:3,Education:3,Wealth:3,Safety:2,Livability:2,Transport:2,Inclusion:4,Accountability:1,"City budget":3,SME:1,"Public services":5,"Sustainability commitment":5},{City:"Dar es Salaam",Country:"Tanzania","Urban Resilience Index":"C-2",Environmental:2,Social:2,Governmental:2,"Air pollution":3,"Water pollution":1,"Land use and waste":2,"Natural disaster hazards":4,"Water availability":2,"Food availability":4,"Energy availability":3,Health:2,Education:2,Wealth:2,Safety:2,Livability:2,Transport:2,Inclusion:4,Accountability:3,"City budget":3,SME:2,"Public services":3,"Sustainability commitment":3},{City:"Adoni",Country:"India","Urban Resilience Index":"C-2",Environmental:2,Social:1,Governmental:2,"Air pollution":3,"Water pollution":2,"Land use and waste":4,"Natural disaster hazards":4,"Water availability":4,"Food availability":3,"Energy availability":4,Health:2,Education:2,Wealth:2,Safety:1,Livability:2,Transport:2,Inclusion:4,Accountability:1,"City budget":4,SME:2,"Public services":5,"Sustainability commitment":5},{City:"Natal",Country:"Brazil","Urban Resilience Index":"B-2",Environmental:3,Social:3,Governmental:3,"Air pollution":4,"Water pollution":3,"Land use and waste":5,"Natural disaster hazards":4,"Water availability":3,"Food availability":3,"Energy availability":3,Health:3,Education:3,Wealth:3,Safety:1,Livability:3,Transport:3,Inclusion:3,Accountability:1,"City budget":4,SME:2,"Public services":3,"Sustainability commitment":3},{City:"Brazzaville",Country:"Congo","Urban Resilience Index":"C-1",Environmental:3,Social:1,Governmental:3,"Air pollution":4,"Water pollution":1,"Land use and waste":3,"Natural disaster hazards":4,"Water availability":4,"Food availability":2,"Energy availability":3,Health:1,Education:3,Wealth:2,Safety:1,Livability:3,Transport:3,Inclusion:1,Accountability:1,"City budget":1,SME:1,"Public services":3,"Sustainability commitment":3},{City:"Almaty",Country:"Kazakhstan","Urban Resilience Index":"B-1",Environmental:3,Social:4,Governmental:3,"Air pollution":4,"Water pollution":3,"Land use and waste":5,"Natural disaster hazards":5,"Water availability":5,"Food availability":4,"Energy availability":4,Health:5,Education:4,Wealth:4,Safety:4,Livability:4,Transport:4,Inclusion:2,Accountability:3,"City budget":4,SME:4,"Public services":5,"Sustainability commitment":5},{City:"Cape Town",Country:"South Africa","Urban Resilience Index":"B-2",Environmental:3,Social:3,Governmental:4,"Air pollution":4,"Water pollution":2,"Land use and waste":2,"Natural disaster hazards":4,"Water availability":2,"Food availability":2,"Energy availability":2,Health:1,Education:3,Wealth:3,Safety:2,Livability:3,Transport:4,Inclusion:4,Accountability:4,"City budget":2,SME:3,"Public services":4,"Sustainability commitment":5},{City:"Mexico City",Country:"Mexico","Urban Resilience Index":"C-2",Environmental:2,Social:2,Governmental:2,"Air pollution":1,"Water pollution":1,"Land use and waste":3,"Natural disaster hazards":1,"Water availability":3,"Food availability":1,"Energy availability":3,Health:3,Education:3,Wealth:3,Safety:1,Livability:2,Transport:2,Inclusion:1,Accountability:2,"City budget":2,SME:2,"Public services":3,"Sustainability commitment":2},{City:"Jakarta",Country:"Indonesia","Urban Resilience Index":"B-3",Environmental:2,Social:3,Governmental:3,"Air pollution":1,"Water pollution":3,"Land use and waste":3,"Natural disaster hazards":1,"Water availability":3,"Food availability":2,"Energy availability":3,Health:2,Education:2,Wealth:2,Safety:4,Livability:3,Transport:3,Inclusion:2,Accountability:5,"City budget":2,SME:4,"Public services":3,"Sustainability commitment":3},{City:"Panama City",Country:"Panama","Urban Resilience Index":"B-1",Environmental:3,Social:4,Governmental:3,"Air pollution":3,"Water pollution":4,"Land use and waste":4,"Natural disaster hazards":3,"Water availability":4,"Food availability":4,"Energy availability":5,Health:4,Education:1,Wealth:2,Safety:4,Livability:2,Transport:3,Inclusion:3,Accountability:3,"City budget":3,SME:2,"Public services":4,"Sustainability commitment":4},{City:"Amman",Country:"Jordan","Urban Resilience Index":"B-1",Environmental:2,Social:4,Governmental:4,"Air pollution":2,"Water pollution":2,"Land use and waste":3,"Natural disaster hazards":3,"Water availability":4,"Food availability":4,"Energy availability":3,Health:3,Education:3,Wealth:4,Safety:4,Livability:4,Transport:3,Inclusion:2,Accountability:5,"City budget":3,SME:3,"Public services":3,"Sustainability commitment":3},{City:"Bangkok",Country:"Thailand","Urban Resilience Index":"B-3",Environmental:2,Social:3,Governmental:2,"Air pollution":2,"Water pollution":2,"Land use and waste":2,"Natural disaster hazards":1,"Water availability":4,"Food availability":2,"Energy availability":4,Health:4,Education:2,Wealth:3,Safety:5,Livability:3,Transport:2,Inclusion:4,Accountability:2,"City budget":1,SME:5,"Public services":2,"Sustainability commitment":4},{City:"Colombo",Country:"Sri Lanka","Urban Resilience Index":"B-2",Environmental:3,Social:3,Governmental:3,"Air pollution":3,"Water pollution":4,"Land use and waste":2,"Natural disaster hazards":4,"Water availability":3,"Food availability":2,"Energy availability":5,Health:4,Education:1,Wealth:2,Safety:4,Livability:2,Transport:4,Inclusion:3,Accountability:1,"City budget":2,SME:3,"Public services":3,"Sustainability commitment":2}],PM=[{city:"Dubai",data:[{category:"Air pollution",indicator:"CO2 emissions",unit:"kt",value:1,natural_value:20.3},{category:"Air pollution",indicator:"CO2 emissions (change in last 3 years)",unit:"%",value:2,natural_value:3.2},{category:"Air pollution",indicator:"CO2 concentration",unit:"ppm",value:2,natural_value:465},{category:"Air pollution",indicator:"CO2 concentration (change in last 3 years)",unit:"%",value:3,natural_value:1.8},{category:"Air pollution",indicator:"Annual average of SO2 concentration in ambient air",unit:"microgram/m3",value:3,natural_value:27.1},{category:"Air pollution",indicator:"Annual Average of SO2 Concentration in Ambient Air (change in last 3 years)",unit:"%",value:3,natural_value:17.7},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air",unit:"microgram/m3",value:1,natural_value:77.4},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air (change in last 3 years), microgram/m3",unit:"%",value:2,natural_value:1.4},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air, microgram/m3",unit:"microgram/m3",value:1,natural_value:132.1},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air (change in last 3 years), microgram/m3",unit:"%",value:3,natural_value:.2},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air, microgram/m3",unit:"microgram/m3",value:2,natural_value:.5},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air (change in last 3 years), microgram/m3",unit:"%",value:3,natural_value:1.9},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air, microgram/m3",unit:"microgram/m3",value:1,natural_value:128},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air (change in last 3 years), microgram/m3",unit:"%",value:1,natural_value:12.8},{category:"Air pollution",indicator:"Volatile organic compounds/reactive organic gases emissions",unit:"microgram/m3",value:1,natural_value:2.8},{category:"Air pollution",indicator:"Perception of air pollution index",unit:"index",value:4,natural_value:1.2},{category:"Air pollution",indicator:"Paris Agreement",unit:"Yes/No",value:5,natural_value:0},{category:"Water pollution",indicator:"Annual average of dissolved oxygen (DO) concentration in water",unit:"%",value:3,natural_value:6.401},{category:"Water pollution",indicator:"Annual average of pH concentration in water",unit:"pH",value:2,natural_value:7.876666666666666},{category:"Water pollution",indicator:"Annual average dissolved solids in drinking-water",unit:"ppm",value:5,natural_value:3.1},{category:"Water pollution",indicator:"Water management strategy in a city",unit:"Yes/No",value:5,natural_value:1},{category:"Water pollution",indicator:"Perception of water pollution index",unit:"index",value:4,natural_value:1.5},{category:"Land use and waste",indicator:"Share of devastated and degraded land area requiring reclamation",unit:"%",value:4,natural_value:3.1},{category:"Land use and waste",indicator:"3-year average growth rate of devastated and degraded land area requiring reclamation",unit:"%",value:5,natural_value:-.08},{category:"Land use and waste",indicator:"Waste deposits",unit:"%",value:5,natural_value:0},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous)",unit:"kg per capita ",value:2,natural_value:5945.914771596275},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous), (change in last 3 years)",unit:"%",value:2,natural_value:16.53405312},{category:"Land use and waste",indicator:"Total recycled construction waste",unit:"tons per capita",value:2,natural_value:.000173996963487571},{category:"Land use and waste",indicator:"Share of recycled construction and demolish waste in total generated construction and demolish waste",unit:"%",value:4,natural_value:.57866431255714},{category:"Land use and waste",indicator:"Total area of impervious surfaces and percentage to total city area",unit:"%",value:2,natural_value:.03},{category:"Land use and waste",indicator:"Productive urban land (in percent total land)",unit:"%",value:3,natural_value:32.2},{category:"Land use and waste",indicator:"Waste managenet strategy",unit:"Yes/No",value:5,natural_value:1},{category:"Land use and waste",indicator:"Perception of waste index",unit:"index",value:3,natural_value:2.155183475682713},{category:"Land use and waste",indicator:"Green spaces, % city area",unit:"%",value:2,natural_value:.0292},{category:"Land use and waste",indicator:"Green spaces, change in last 3 years",unit:"%",value:4,natural_value:1.6},{category:"Land use and waste",indicator:"NDVI",unit:"%",value:5,natural_value:.1},{category:"Natural disaster hazards",indicator:"Share of total area with altitude above sea level less than 0,5 meters",unit:"%",value:2,natural_value:.12},{category:"Natural disaster hazards",indicator:"Growth rate of freshwater mirror area",unit:"%",value:5,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of registered heavy rain, flood and thunderbolt (change in last 3 years)",unit:"%",value:4,natural_value:-.173191044314075},{category:"Natural disaster hazards",indicator:"Number of registered sand storm (change in last 3 years)",unit:"%",value:4,natural_value:-.170173466633757},{category:"Natural disaster hazards",indicator:"Environmental/natural disasters risk mitigation",unit:"Yes/No",value:5,natural_value:1},{category:"Natural disaster hazards",indicator:"Strategy/policy/government officials statement on environmental issues ",unit:"Yes/No",value:5,natural_value:1},{category:"Natural disaster hazards",indicator:"Total overall losses from natural disaster hazards",unit:"US$ mln ",value:3,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of days with average daily temperature above the threshold for 1990-2010",unit:"days",value:2,natural_value:73},{category:"Natural disaster hazards",indicator:"Number of disruptions to basic services, attributed to disasters",unit:"%",value:3,natural_value:0},{category:"Water availability",indicator:"Water consumption per capita",unit:"mcm",value:3,natural_value:.00016922114759669515},{category:"Water availability",indicator:"Water tariff to disposable income ratio",unit:"ratio",value:1,natural_value:4.033333333333333},{category:"Water availability",indicator:"Sanitary facilities tariff to disposable income ratio",unit:"ratio",value:4,natural_value:.5},{category:"Water availability",indicator:"Water consumption per capita (change in last 3 years)",unit:"%",value:3,natural_value:-.03},{category:"Water availability",indicator:"Percentage of population with access to drinking water",unit:"%",value:5,natural_value:.99},{category:"Water availability",indicator:"Percentage of population with access to drinking water (change in last 3 years)",unit:"%",value:4,natural_value:0},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities",unit:"%",value:5,natural_value:.99},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities (change in last 3 years)",unit:"%",value:4,natural_value:0},{category:"Food availability",indicator:"Cereal import dependency ratio (5-years average)",unit:"%",value:1,natural_value:.969},{category:"Food availability",indicator:"Cereal import dependency ratio (change in last 3 years)",unit:"%",value:3,natural_value:.02451091909},{category:"Food availability",indicator:"Prevalence of undernourishment",unit:"%",value:5,natural_value:.025},{category:"Food availability",indicator:"Prevalence of undernourishment (change in last 3 years)",unit:"%",value:5,natural_value:-.0333584789974298},{category:"Food availability",indicator:"Prevalence of undernourishment children",unit:"%",value:1,natural_value:1.3},{category:"Food availability",indicator:"Prevalence of undernourishment children (change in last 3 years)",unit:"%",value:4,natural_value:0},{category:"Food availability",indicator:"Prevalence of moderate or severe food insecurity in the population",unit:"%",value:4,natural_value:.075},{category:"Food availability",indicator:"Share of imports in food resources",unit:"%",value:3,natural_value:.431},{category:"Food availability",indicator:"Percentage of people with access to at least one food vendor/retailer within 15 minutes of walking",unit:"%",value:3,natural_value:91},{category:"Food availability",indicator:"Perception of food availability index",unit:"index",value:4,natural_value:2.4758589112947105},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity",unit:"%",value:5,natural_value:1},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity (change in last 3 years)",unit:"%",value:3,natural_value:0},{category:"Energy availability",indicator:"Consumption of electricity per capita",unit:"kWh/person",value:2,natural_value:13484.260097442204},{category:"Energy availability",indicator:"Consumption of electricity per capita (change in last 3 years)",unit:"%",value:4,natural_value:-.0328884973674617},{category:"Energy availability",indicator:"Electricity tariff to disposable income ratio",unit:"ratio",value:2,natural_value:.3025},{category:"Energy availability",indicator:"Share of renewable sources in electricity consumption",unit:"%",value:3,natural_value:.211},{category:"Energy availability",indicator:"Perception of energy availability index",unit:"index",value:4,natural_value:.8121750320262275},{category:"Health",indicator:"Child mortality rate (under 5 years-old)",unit:"% of live births ",value:5,natural_value:.047},{category:"Health",indicator:"City ambulance",unit:"Yes/No",value:5,natural_value:1},{category:"Health",indicator:"Life expectancy at birth, years",unit:"Years",value:5,natural_value:79.12733333333334},{category:"Health",indicator:"Life expectancy at birth goals",unit:"categories",value:2,natural_value:1},{category:"Health",indicator:"Number of hospital beds per 1,000 population",unit:"per 1,000",value:3,natural_value:1.7038581393098866},{category:"Health",indicator:"Number of doctors per 1,000 population",unit:"per 1,000",value:3,natural_value:3.1534720263756366},{category:"Health",indicator:"Maternal mortality ratio",unit:"deaths per 1,000 live births",value:5,natural_value:1.3},{category:"Health",indicator:"Ambulance arrival speed, min",unit:"min",value:5,natural_value:7},{category:"Education",indicator:"Literacy rate among population (15-24 Years)",unit:"%",value:3,natural_value:.969935633333333},{category:"Education",indicator:"Literacy rate among population (15-24 Years) (change in last 3 years)",unit:"%",value:5,natural_value:.0160766595564663},{category:"Education",indicator:"Primary education engagement",unit:"%",value:5,natural_value:.996036433333333},{category:"Education",indicator:"Pupils per teacher rate",unit:"ratio",value:4,natural_value:10.305960905809698},{category:"Education",indicator:"Proportion of population with post-secondary and higher education",unit:"%",value:5,natural_value:.5491613261},{category:"Wealth",indicator:"Percentage of population with food expenditure is above 52% of total expenditure",unit:"%",value:5,natural_value:.023},{category:"Wealth",indicator:"Mean monthly salary",unit:"US dollars thousand",value:5,natural_value:7854.14666666667},{category:"Wealth",indicator:"Mean monthly salary, change in last 3 years",unit:"%",value:3,natural_value:706225149202933e-19},{category:"Wealth",indicator:"Disposable monthly income",unit:"US dollars thousand",value:5,natural_value:2355.1463883362276},{category:"Wealth",indicator:"Disposable monthly income (change in last 3 years)",unit:"%",value:4,natural_value:.0584373085440772},{category:"Wealth",indicator:"Debt to salary ratio",unit:"ratio",value:5,natural_value:.92},{category:"Wealth",indicator:"Number of mobile phones per 1,000 population",unit:"per 1,000",value:5,natural_value:113.16800083893004},{category:"Wealth",indicator:"Decile income coefficient",unit:"ratio",value:5,natural_value:5.9021739130434785},{category:"Wealth",indicator:"Decile income coefficient (change in last 3 years)",unit:"%",value:5,natural_value:-.481645306006547},{category:"Wealth",indicator:"Poverty headcount ratio at national poverty lines",unit:"%",value:5,natural_value:.0533333333333333},{category:"Wealth",indicator:"Working poverty rate (percentage of employed living below US$1.90 PPP), 15+ age (%) ",unit:"%",value:5,natural_value:.001},{category:"Wealth",indicator:"Poverty headcount ratio at $2.15 PPP 2017 a day",unit:"%",value:5,natural_value:.00133333333333333},{category:"Wealth",indicator:"Living spaces per capita, sq m (change in last 3 years)",unit:"%",value:1,natural_value:.00224274214415088},{category:"Wealth",indicator:"Population living in slums (% of urban population)",unit:"%",value:5,natural_value:.041},{category:"Wealth",indicator:"Availability of finance (consumer loans)",unit:"%",value:3,natural_value:.5},{category:"Wealth",indicator:"Perception of wealth & poverty index",unit:"index",value:2,natural_value:2.1140395253368003},{category:"Safety",indicator:"Road fatalities rate per 100,000 population",unit:"per 100,000",value:5,natural_value:3.3516579451976907},{category:"Safety",indicator:"Road fatalities rate per 100,000 population (change in last 3 years)",unit:"%",value:3,natural_value:-.0617566486884363},{category:"Safety",indicator:"Violent crime rate per 100,000 population",unit:"per 100,000",value:5,natural_value:.26666666666666666},{category:"Safety",indicator:"Violent crime rate per 100,000 population (change in last 3 years)",unit:"%",value:3,natural_value:0},{category:"Safety",indicator:"Crime rate per 100,000 population",unit:"per 100,000",value:4,natural_value:31.433333333333334},{category:"Safety",indicator:"Crime rate per 100,000 population  (change in last 3 years)",unit:"%",value:3,natural_value:-.03},{category:"Safety",indicator:"Police arrival speed",unit:"min",value:5,natural_value:2.34},{category:"Safety",indicator:"Perception of safety index",unit:"index",value:2,natural_value:3.295},{category:"Livability",indicator:"Number of LEED certified green buildings",unit:"Certified square meters per capita",value:3,natural_value:1.378},{category:"Livability",indicator:"Number of BREEAM certified projects",unit:"Certified square meters per capita",value:5,natural_value:8},{category:"Livability",indicator:"Whether or not the city has ISO 37120 certification",unit:"Yes/No",value:5,natural_value:1},{category:"Livability",indicator:"Mobile connection coverage",unit:"%",value:5,natural_value:1},{category:"Livability",indicator:"Internet coverage",unit:"%",value:5,natural_value:1},{category:"Livability",indicator:"Perception of livability index",unit:"index",value:3,natural_value:1.082731807619587},{category:"Livability",indicator:"Share of population in 1 km from schools",unit:"%",value:3,natural_value:36.9},{category:"Livability",indicator:"Share of population in 1 km from parks",unit:"%",value:5,natural_value:51.5},{category:"Transport",indicator:"Time loss in traffic",unit:"%",value:4,natural_value:12.9},{category:"Transport",indicator:"Share of the population in 1 km from public transport stop",unit:"%",value:4,natural_value:41.8},{category:"Transport",indicator:"Ratio of the cost of monthly public transport usage Ithe cheapest option) to average mobthly income",unit:"ratio",value:4,natural_value:.01},{category:"Transport",indicator:"Ratio of the cost of a 1-kilometer taxi ride to average mobthly income",unit:"%",value:2,natural_value:.08},{category:"Transport",indicator:"Percentage of city's roads that are segregated and/or has specialized lane for cyclists",unit:"%",value:3,natural_value:.06},{category:"Transport",indicator:"Number of public electric vehicle (EV) charging points per 100,000 population",unit:"per 100,000",value:3,natural_value:1.4},{category:"Transport",indicator:"Public transport (excluding subway) operates by schedule ",unit:"Yes/No",value:5,natural_value:1},{category:"Transport",indicator:"Perception of transport index",unit:"index",value:4,natural_value:1.082731807619587},{category:"Inclusion",indicator:"Female-friendly city",unit:"1,2,3,4,5",value:2,natural_value:3},{category:"Inclusion",indicator:"Number of refugees per 1,000 population",unit:"per 1,000",value:4,natural_value:.3817158061663018},{category:"Inclusion",indicator:"Homeless people per 1,000 population",unit:"per 1,000",value:3,natural_value:1.8687289767990112},{category:"Inclusion",indicator:"Difference in number of years of schooling between woman and man, woman to man ratio ",unit:"years",value:3,natural_value:.9666666666666667},{category:"Inclusion",indicator:"Slavery index",unit:"index",value:3,natural_value:13.4},{category:"Inclusion",indicator:"Percentage of women aged 25-34 years old that have successfully completed secondary education",unit:"%",value:4,natural_value:.5670000000000001},{category:"Inclusion",indicator:"Regulations for building construction and equipment, public transport for people with disabilities",unit:"Yes/No",value:1,natural_value:0},{category:"Inclusion",indicator:"Perception of inclusion index",unit:"index",value:2,natural_value:3.237203544701542},{category:"Accountability",indicator:"City budget execution publication",unit:"Yes/No",value:5,natural_value:1},{category:"Accountability",indicator:"City budget publication",unit:"Yes/No",value:5,natural_value:1},{category:"Accountability",indicator:"Financial transparency on city government companies",unit:"Yes/No",value:1,natural_value:0},{category:"Accountability",indicator:"ISO certification",unit:"Yes/No",value:5,natural_value:1},{category:"Accountability",indicator:"City council checks and balances",unit:"Yes/No",value:5,natural_value:1},{category:"Accountability",indicator:"Plans to obtain ISO certification",unit:"Yes/No",value:5,natural_value:1},{category:"Accountability",indicator:"Perception of accountability index",unit:"index",value:2,natural_value:1.1200372913104772},{category:"City budget",indicator:"Poor financial condition",unit:"Yes/No",value:5,natural_value:0},{category:"City budget",indicator:"Central/higher level government financial intervention taking place",unit:"Yes/No",value:5,natural_value:0},{category:"City budget",indicator:"Long-term financial planning",unit:"Yes/No",value:1,natural_value:0},{category:"City budget",indicator:"Central/higher level government financial intervention is considered",unit:"Yes/No",value:1,natural_value:0},{category:"City budget",indicator:"Prudent fiscal policy requirements",unit:"Yes/No",value:1,natural_value:0},{category:"City budget",indicator:"Medium-term planning",unit:"Yes/No",value:5,natural_value:1},{category:"SME",indicator:"Number of SMEs per 100,000 population",unit:"per 100,000",value:3,natural_value:5235.1},{category:"SME",indicator:"Number of start-ups",unit:"start-ups",value:4,natural_value:3802},{category:"SME",indicator:"Global Startup Ecosystem Index",unit:"index",value:4,natural_value:11.527},{category:"SME",indicator:"Number of SMEs per capita/100 000 population (change in last 3 years)",unit:"%",value:2,natural_value:-.127},{category:"SME",indicator:"Number of start-ups (change in last 3 years)",unit:"%",value:4,natural_value:.179},{category:"Public services",indicator:"Free phone to call the police, ambulance, firefighters",unit:"1,2,3,4,5",value:5,natural_value:1},{category:"Public services",indicator:"Services for working with citizens' appeals and complaint",unit:"Yes/No",value:5,natural_value:1},{category:"Public services",indicator:"E-gov services",unit:"Yes/No",value:5,natural_value:1},{category:"Public services",indicator:"Perception of public services index: Public Services",unit:"index",value:5,natural_value:.709659690294386},{category:"Sustainability commitment",indicator:"City ESG reporting",unit:"Yes/No",value:5,natural_value:1},{category:"Sustainability commitment",indicator:"City ESG reporting verification",unit:"Yes/No",value:1,natural_value:0},{category:"Sustainability commitment",indicator:"ESG planning",unit:"Yes/No",value:5,natural_value:1},{category:"Sustainability commitment",indicator:"Plan with specific targets to develop and implement smart city principles",unit:"Yes/No",value:5,natural_value:1},{category:"Sustainability commitment",indicator:"Rollout and status of ESG / UN SDG training across the municipal/asset workforce",unit:"Yes/No",value:5,natural_value:1},{category:"Sustainability commitment",indicator:"City municipality involved in network or partnership promoting sustainable development (for example, C40 Cities network)",unit:"Yes/No",value:5,natural_value:1}]},{city:"Expo City Dubai",data:[{category:"Air pollution",indicator:"CO2 emissions",unit:"kt",value:1,natural_value:20.3},{category:"Air pollution",indicator:"CO2 emissions (change in last 3 years)",unit:"%",value:5,natural_value:-1.5},{category:"Air pollution",indicator:"CO2 concentration",unit:"ppm",value:2,natural_value:468.5},{category:"Air pollution",indicator:"CO2 concentration (change in last 3 years)",unit:"%",value:1,natural_value:15.5},{category:"Air pollution",indicator:"Annual average of SO2 concentration in ambient air",unit:"microgram/m3",value:3,natural_value:28.1},{category:"Air pollution",indicator:"Annual Average of SO2 Concentration in Ambient Air (change in last 3 years)",unit:"%",value:3,natural_value:1.2},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air",unit:"microgram/m3",value:1,natural_value:81},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air (change in last 3 years), microgram/m3",unit:"%",value:2,natural_value:1.2},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air, microgram/m3",unit:"microgram/m3",value:1,natural_value:133.8},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air (change in last 3 years), microgram/m3",unit:"%",value:3,natural_value:.1},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air, microgram/m3",unit:"microgram/m3",value:2,natural_value:.5},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air (change in last 3 years), microgram/m3",unit:"%",value:3,natural_value:1.5},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air, microgram/m3",unit:"microgram/m3",value:1,natural_value:131.7},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air (change in last 3 years), microgram/m3",unit:"%",value:1,natural_value:12.4},{category:"Air pollution",indicator:"Volatile organic compounds/reactive organic gases emissions",unit:"microgram/m3",value:1,natural_value:2.8},{category:"Air pollution",indicator:"Perception of air pollution index",unit:"index",value:2,natural_value:2.08},{category:"Air pollution",indicator:"Paris Agreement",unit:"Yes/No",value:5,natural_value:1},{category:"Water pollution",indicator:"Annual average of dissolved oxygen (DO) concentration in water",unit:"%",value:3,natural_value:6.507},{category:"Water pollution",indicator:"Annual average of pH concentration in water",unit:"pH",value:2,natural_value:7.876666666666666},{category:"Water pollution",indicator:"Annual average dissolved solids in drinking-water",unit:"ppm",value:5,natural_value:3.1},{category:"Water pollution",indicator:"Water management strategy in a city",unit:"Yes/No",value:5,natural_value:1},{category:"Water pollution",indicator:"Perception of water pollution index",unit:"index",value:2,natural_value:2.3439938519744623},{category:"Land use and waste",indicator:"Share of devastated and degraded land area requiring reclamation",unit:"%",value:4,natural_value:3.1},{category:"Land use and waste",indicator:"3-year average growth rate of devastated and degraded land area requiring reclamation",unit:"%",value:5,natural_value:-.072},{category:"Land use and waste",indicator:"Waste deposits",unit:"%",value:5,natural_value:1e-4},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous)",unit:"kg per capita ",value:5,natural_value:40.3809523809524},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous), (change in last 3 years)",unit:"%",value:2,natural_value:24.28930024},{category:"Land use and waste",indicator:"Total recycled construction waste",unit:"tons per capita",value:4,natural_value:15.171599047619047},{category:"Land use and waste",indicator:"Share of recycled construction and demolish waste in total generated construction and demolish waste",unit:"%",value:4,natural_value:.760247651924017},{category:"Land use and waste",indicator:"Total area of impervious surfaces and percentage to total city area",unit:"%",value:2,natural_value:.03},{category:"Land use and waste",indicator:"Productive urban land (in percent total land)",unit:"%",value:3,natural_value:32.2},{category:"Land use and waste",indicator:"Waste managenet strategy",unit:"Yes/No",value:5,natural_value:1},{category:"Land use and waste",indicator:"Perception of waste index",unit:"index",value:2,natural_value:3.4442358641257407},{category:"Land use and waste",indicator:"Green spaces, % city area",unit:"%",value:2,natural_value:.0241},{category:"Land use and waste",indicator:"Green spaces, change in last 3 years",unit:"%",value:3,natural_value:0},{category:"Land use and waste",indicator:"NDVI",unit:"%",value:5,natural_value:.1},{category:"Natural disaster hazards",indicator:"Share of total area with altitude above sea level less than 0,5 meters",unit:"%",value:2,natural_value:.12},{category:"Natural disaster hazards",indicator:"Growth rate of freshwater mirror area",unit:"%",value:5,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of registered heavy rain, flood and thunderbolt (change in last 3 years)",unit:"%",value:4,natural_value:-.173191044314075},{category:"Natural disaster hazards",indicator:"Number of registered sand storm (change in last 3 years)",unit:"%",value:4,natural_value:-.170173466633757},{category:"Natural disaster hazards",indicator:"Environmental/natural disasters risk mitigation",unit:"Yes/No",value:5,natural_value:1},{category:"Natural disaster hazards",indicator:"Strategy/policy/government officials statement on environmental issues ",unit:"Yes/No",value:5,natural_value:1},{category:"Natural disaster hazards",indicator:"Total overall losses from natural disaster hazards",unit:"US$ mln ",value:3,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of days with average daily temperature above the threshold for 1990-2010",unit:"days",value:2,natural_value:73},{category:"Natural disaster hazards",indicator:"Number of disruptions to basic services, attributed to disasters",unit:"%",value:3,natural_value:0},{category:"Water availability",indicator:"Water consumption per capita",unit:"mcm",value:3,natural_value:0},{category:"Water availability",indicator:"Water tariff to disposable income ratio",unit:"ratio",value:1,natural_value:4.033333333333333},{category:"Water availability",indicator:"Sanitary facilities tariff to disposable income ratio",unit:"ratio",value:4,natural_value:.5},{category:"Water availability",indicator:"Water consumption per capita (change in last 3 years)",unit:"%",value:2,natural_value:-.207},{category:"Water availability",indicator:"Percentage of population with access to drinking water",unit:"%",value:5,natural_value:.99},{category:"Water availability",indicator:"Percentage of population with access to drinking water (change in last 3 years)",unit:"%",value:4,natural_value:0},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities",unit:"%",value:3,natural_value:.99},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities (change in last 3 years)",unit:"%",value:2,natural_value:0},{category:"Food availability",indicator:"Cereal import dependency ratio (5-years average)",unit:"%",value:1,natural_value:.969},{category:"Food availability",indicator:"Cereal import dependency ratio (change in last 3 years)",unit:"%",value:3,natural_value:.02451091909},{category:"Food availability",indicator:"Prevalence of undernourishment",unit:"%",value:5,natural_value:.025},{category:"Food availability",indicator:"Prevalence of undernourishment (change in last 3 years)",unit:"%",value:5,natural_value:-.0333584789974298},{category:"Food availability",indicator:"Prevalence of undernourishment children",unit:"%",value:1,natural_value:1.3},{category:"Food availability",indicator:"Prevalence of undernourishment children (change in last 3 years)",unit:"%",value:4,natural_value:0},{category:"Food availability",indicator:"Prevalence of moderate or severe food insecurity in the population",unit:"%",value:4,natural_value:.075},{category:"Food availability",indicator:"Share of imports in food resources",unit:"%",value:3,natural_value:.431},{category:"Food availability",indicator:"Percentage of people with access to at least one food vendor/retailer within 15 minutes of walking",unit:"%",value:3,natural_value:91},{category:"Food availability",indicator:"Perception of food availability index",unit:"index",value:1,natural_value:1.6876755734216127},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity",unit:"%",value:5,natural_value:1},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity (change in last 3 years)",unit:"%",value:3,natural_value:0},{category:"Energy availability",indicator:"Consumption of electricity per capita",unit:"kWh/person",value:1,natural_value:21791.14485714286},{category:"Energy availability",indicator:"Consumption of electricity per capita (change in last 3 years)",unit:"%",value:2,natural_value:.158604595786555},{category:"Energy availability",indicator:"Electricity tariff to disposable income ratio",unit:"ratio",value:2,natural_value:.3025},{category:"Energy availability",indicator:"Share of renewable sources in electricity consumption",unit:"%",value:3,natural_value:.211},{category:"Energy availability",indicator:"Perception of energy availability index",unit:"index",value:5,natural_value:.07780892454687012},{category:"Health",indicator:"Child mortality rate (under 5 years-old)",unit:"% of live births ",value:5,natural_value:.047},{category:"Health",indicator:"City ambulance",unit:"Yes/No",value:5,natural_value:1},{category:"Health",indicator:"Life expectancy at birth, years",unit:"Years",value:5,natural_value:79.12733333333334},{category:"Health",indicator:"Life expectancy at birth goals",unit:"categories",value:2,natural_value:1},{category:"Health",indicator:"Number of hospital beds per 1,000 population",unit:"per 1,000",value:3,natural_value:1.7038581393098866},{category:"Health",indicator:"Number of doctors per 1,000 population",unit:"per 1,000",value:3,natural_value:3.1534720263756366},{category:"Health",indicator:"Maternal mortality ratio",unit:"deaths per 1,000 live births",value:5,natural_value:1.3},{category:"Health",indicator:"Ambulance arrival speed, min",unit:"min",value:5,natural_value:7},{category:"Education",indicator:"Literacy rate among population (15-24 Years)",unit:"%",value:3,natural_value:.969935633333333},{category:"Education",indicator:"Literacy rate among population (15-24 Years) (change in last 3 years)",unit:"%",value:5,natural_value:.0160766595564663},{category:"Education",indicator:"Primary education engagement",unit:"%",value:5,natural_value:.996036433333333},{category:"Education",indicator:"Pupils per teacher rate",unit:"ratio",value:4,natural_value:10.305960905809698},{category:"Education",indicator:"Proportion of population with post-secondary and higher education",unit:"%",value:5,natural_value:.5491613261},{category:"Wealth",indicator:"Percentage of population with food expenditure is above 52% of total expenditure",unit:"%",value:5,natural_value:.001},{category:"Wealth",indicator:"Mean monthly salary",unit:"US dollars thousand",value:5,natural_value:7854.14666666667},{category:"Wealth",indicator:"Mean monthly salary, change in last 3 years",unit:"%",value:3,natural_value:706225149202933e-19},{category:"Wealth",indicator:"Disposable monthly income",unit:"US dollars thousand",value:5,natural_value:2355.1463883362276},{category:"Wealth",indicator:"Disposable monthly income (change in last 3 years)",unit:"%",value:4,natural_value:.0584373085440772},{category:"Wealth",indicator:"Debt to salary ratio",unit:"ratio",value:5,natural_value:.92},{category:"Wealth",indicator:"Number of mobile phones per 1,000 population",unit:"per 1,000",value:5,natural_value:113.16800083893004},{category:"Wealth",indicator:"Decile income coefficient",unit:"ratio",value:5,natural_value:5.9021739130434785},{category:"Wealth",indicator:"Decile income coefficient (change in last 3 years)",unit:"%",value:5,natural_value:-.481645306006547},{category:"Wealth",indicator:"Poverty headcount ratio at national poverty lines",unit:"%",value:5,natural_value:0},{category:"Wealth",indicator:"Working poverty rate (percentage of employed living below US$1.90 PPP), 15+ age (%) ",unit:"%",value:5,natural_value:.001},{category:"Wealth",indicator:"Poverty headcount ratio at $2.15 PPP 2017 a day",unit:"%",value:5,natural_value:.000666666666666667},{category:"Wealth",indicator:"Living spaces per capita, sq m (change in last 3 years)",unit:"%",value:1,natural_value:.00224274214415088},{category:"Wealth",indicator:"Population living in slums (% of urban population)",unit:"%",value:5,natural_value:.041},{category:"Wealth",indicator:"Availability of finance (consumer loans)",unit:"%",value:3,natural_value:.5},{category:"Wealth",indicator:"Perception of wealth & poverty index",unit:"index",value:2,natural_value:1.87519508157957},{category:"Safety",indicator:"Road fatalities rate per 100,000 population",unit:"per 100,000",value:5,natural_value:3.3516579451976907},{category:"Safety",indicator:"Road fatalities rate per 100,000 population (change in last 3 years)",unit:"%",value:3,natural_value:-.0617566486884363},{category:"Safety",indicator:"Violent crime rate per 100,000 population",unit:"per 100,000",value:5,natural_value:.26666666666666666},{category:"Safety",indicator:"Violent crime rate per 100,000 population (change in last 3 years)",unit:"%",value:3,natural_value:0},{category:"Safety",indicator:"Crime rate per 100,000 population",unit:"per 100,000",value:4,natural_value:31.433333333333334},{category:"Safety",indicator:"Crime rate per 100,000 population  (change in last 3 years)",unit:"%",value:4,natural_value:0},{category:"Safety",indicator:"Police arrival speed",unit:"min",value:5,natural_value:2.34},{category:"Safety",indicator:"Perception of safety index",unit:"index",value:4,natural_value:2.445},{category:"Livability",indicator:"Number of LEED certified green buildings",unit:"Certified square meters per capita",value:5,natural_value:126.95604827857144},{category:"Livability",indicator:"Number of BREEAM certified projects",unit:"Certified square meters per capita",value:5,natural_value:8},{category:"Livability",indicator:"Whether or not the city has ISO 37120 certification",unit:"Yes/No",value:5,natural_value:1},{category:"Livability",indicator:"Mobile connection coverage",unit:"%",value:5,natural_value:1},{category:"Livability",indicator:"Internet coverage",unit:"%",value:5,natural_value:1},{category:"Livability",indicator:"Perception of livability index",unit:"index",value:5,natural_value:.27468677952825726},{category:"Livability",indicator:"Share of population in 1 km from schools",unit:"%",value:3,natural_value:0},{category:"Livability",indicator:"Share of population in 1 km from parks",unit:"%",value:4,natural_value:78.4},{category:"Transport",indicator:"Time loss in traffic",unit:"%",value:5,natural_value:.5},{category:"Transport",indicator:"Share of the population in 1 km from public transport stop",unit:"%",value:4,natural_value:69.5},{category:"Transport",indicator:"Ratio of the cost of monthly public transport usage Ithe cheapest option) to average mobthly income",unit:"ratio",value:4,natural_value:.01},{category:"Transport",indicator:"Ratio of the cost of a 1-kilometer taxi ride to average mobthly income",unit:"%",value:2,natural_value:.08},{category:"Transport",indicator:"Percentage of city's roads that are segregated and/or has specialized lane for cyclists",unit:"%",value:3,natural_value:.06},{category:"Transport",indicator:"Number of public electric vehicle (EV) charging points per 100,000 population",unit:"per 100,000",value:3,natural_value:1.4},{category:"Transport",indicator:"Public transport (excluding subway) operates by schedule ",unit:"Yes/No",value:5,natural_value:1},{category:"Transport",indicator:"Perception of transport index",unit:"index",value:5,natural_value:.27468677952825726},{category:"Inclusion",indicator:"Female-friendly city",unit:"1,2,3,4,5",value:2,natural_value:3},{category:"Inclusion",indicator:"Number of refugees per 1,000 population",unit:"per 1,000",value:4,natural_value:.3817158061663018},{category:"Inclusion",indicator:"Homeless people per 1,000 population",unit:"per 1,000",value:3,natural_value:1.8687289767990112},{category:"Inclusion",indicator:"Difference in number of years of schooling between woman and man, woman to man ratio ",unit:"years",value:3,natural_value:.9666666666666667},{category:"Inclusion",indicator:"Slavery index",unit:"index",value:3,natural_value:13.4},{category:"Inclusion",indicator:"Percentage of women aged 25-34 years old that have successfully completed secondary education",unit:"%",value:4,natural_value:.5670000000000001},{category:"Inclusion",indicator:"Regulations for building construction and equipment, public transport for people with disabilities",unit:"Yes/No",value:1,natural_value:0},{category:"Inclusion",indicator:"Perception of inclusion index",unit:"index",value:2,natural_value:3.217790376675001},{category:"Accountability",indicator:"City budget execution publication",unit:"Yes/No",value:5,natural_value:1},{category:"Accountability",indicator:"City budget publication",unit:"Yes/No",value:1,natural_value:0},{category:"Accountability",indicator:"Financial transparency on city government companies",unit:"Yes/No",value:1,natural_value:0},{category:"Accountability",indicator:"ISO certification",unit:"Yes/No",value:5,natural_value:1},{category:"Accountability",indicator:"City council checks and balances",unit:"Yes/No",value:5,natural_value:1},{category:"Accountability",indicator:"Plans to obtain ISO certification",unit:"Yes/No",value:5,natural_value:1},{category:"Accountability",indicator:"Perception of accountability index",unit:"index",value:4,natural_value:.7813312839914873},{category:"City budget",indicator:"Poor financial condition",unit:"Yes/No",value:5,natural_value:0},{category:"City budget",indicator:"Central/higher level government financial intervention taking place",unit:"Yes/No",value:5,natural_value:0},{category:"City budget",indicator:"Long-term financial planning",unit:"Yes/No",value:1,natural_value:0},{category:"City budget",indicator:"Central/higher level government financial intervention is considered",unit:"Yes/No",value:1,natural_value:0},{category:"City budget",indicator:"Prudent fiscal policy requirements",unit:"Yes/No",value:1,natural_value:0},{category:"City budget",indicator:"Medium-term planning",unit:"Yes/No",value:5,natural_value:1},{category:"SME",indicator:"Number of SMEs per 100,000 population",unit:"per 100,000",value:5,natural_value:5235.1},{category:"SME",indicator:"Number of start-ups",unit:"start-ups",value:1,natural_value:3802},{category:"SME",indicator:"Global Startup Ecosystem Index",unit:"index",value:4,natural_value:11.527},{category:"SME",indicator:"Number of SMEs per capita/100 000 population (change in last 3 years)",unit:"%",value:2,natural_value:-.127},{category:"SME",indicator:"Number of start-ups (change in last 3 years)",unit:"%",value:4,natural_value:.179},{category:"Public services",indicator:"Free phone to call the police, ambulance, firefighters",unit:"1,2,3,4,5",value:5,natural_value:1},{category:"Public services",indicator:"Services for working with citizens' appeals and complaint",unit:"Yes/No",value:5,natural_value:1},{category:"Public services",indicator:"E-gov services",unit:"Yes/No",value:5,natural_value:1},{category:"Public services",indicator:"Perception of public services index: Public Services",unit:"index",value:5,natural_value:.6250650271931899},{category:"Sustainability commitment",indicator:"City ESG reporting",unit:"Yes/No",value:5,natural_value:1},{category:"Sustainability commitment",indicator:"City ESG reporting verification",unit:"Yes/No",value:5,natural_value:1},{category:"Sustainability commitment",indicator:"ESG planning",unit:"Yes/No",value:5,natural_value:1},{category:"Sustainability commitment",indicator:"Plan with specific targets to develop and implement smart city principles",unit:"Yes/No",value:5,natural_value:1},{category:"Sustainability commitment",indicator:"Rollout and status of ESG / UN SDG training across the municipal/asset workforce",unit:"Yes/No",value:5,natural_value:1},{category:"Sustainability commitment",indicator:"City municipality involved in network or partnership promoting sustainable development (for example, C40 Cities network)",unit:"Yes/No",value:5,natural_value:1}]},{city:"Valparaiso",data:[{category:"Air pollution",indicator:"CO2 emissions",unit:"kt",value:3,natural_value:4.4},{category:"Air pollution",indicator:"CO2 emissions (change in last 3 years)",unit:"%",value:3,natural_value:1.6},{category:"Air pollution",indicator:"CO2 concentration",unit:"ppm",value:4,natural_value:417.7},{category:"Air pollution",indicator:"CO2 concentration (change in last 3 years)",unit:"%",value:3,natural_value:1.7},{category:"Air pollution",indicator:"Annual average of SO2 concentration in ambient air",unit:"microgram/m3",value:3,natural_value:52.1},{category:"Air pollution",indicator:"Annual Average of SO2 Concentration in Ambient Air (change in last 3 years)",unit:"%",value:1,natural_value:369.9},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air",unit:"microgram/m3",value:1,natural_value:26.9},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air (change in last 3 years), microgram/m3",unit:"%",value:1,natural_value:1.6},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air, microgram/m3",unit:"microgram/m3",value:3,natural_value:53.8},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air (change in last 3 years), microgram/m3",unit:"%",value:4,natural_value:-4.5},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air, microgram/m3",unit:"microgram/m3",value:1,natural_value:.9},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air (change in last 3 years), microgram/m3",unit:"%",value:1,natural_value:17},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air, microgram/m3",unit:"microgram/m3",value:2,natural_value:90.4},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air (change in last 3 years), microgram/m3",unit:"%",value:1,natural_value:17.3},{category:"Air pollution",indicator:"Volatile organic compounds/reactive organic gases emissions",unit:"microgram/m3",value:4,natural_value:1},{category:"Air pollution",indicator:"Perception of air pollution index",unit:"index",value:3,natural_value:1.53},{category:"Air pollution",indicator:"Paris Agreement",unit:"Yes/No",value:5,natural_value:1},{category:"Water pollution",indicator:"Annual average of dissolved oxygen (DO) concentration in water",unit:"%",value:3,natural_value:6.313333333333333},{category:"Water pollution",indicator:"Annual average of pH concentration in water",unit:"pH",value:2,natural_value:8.06},{category:"Water pollution",indicator:"Annual average dissolved solids in drinking-water",unit:"ppm",value:3,natural_value:139},{category:"Water pollution",indicator:"Water management strategy in a city",unit:"Yes/No",value:5,natural_value:1},{category:"Water pollution",indicator:"Perception of water pollution index",unit:"index",value:4,natural_value:1.0452113628976973},{category:"Land use and waste",indicator:"Share of devastated and degraded land area requiring reclamation",unit:"%",value:4,natural_value:4.5},{category:"Land use and waste",indicator:"3-year average growth rate of devastated and degraded land area requiring reclamation",unit:"%",value:1,natural_value:.112},{category:"Land use and waste",indicator:"Waste deposits",unit:"%",value:5,natural_value:16e-5},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous)",unit:"kg per capita ",value:5,natural_value:17.469310981854},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous), (change in last 3 years)",unit:"%",value:5,natural_value:-1.80539164},{category:"Land use and waste",indicator:"Total recycled construction waste",unit:"tons per capita",value:1,natural_value:.0010518},{category:"Land use and waste",indicator:"Share of recycled construction and demolish waste in total generated construction and demolish waste",unit:"%",value:2,natural_value:.084},{category:"Land use and waste",indicator:"Total area of impervious surfaces and percentage to total city area",unit:"%",value:3,natural_value:.015},{category:"Land use and waste",indicator:"Productive urban land (in percent total land)",unit:"%",value:3,natural_value:32.2},{category:"Land use and waste",indicator:"Waste managenet strategy",unit:"Yes/No",value:1,natural_value:0},{category:"Land use and waste",indicator:"Perception of waste index",unit:"index",value:2,natural_value:1.0917886963814378},{category:"Land use and waste",indicator:"Green spaces, % city area",unit:"%",value:3,natural_value:.3008},{category:"Land use and waste",indicator:"Green spaces, change in last 3 years",unit:"%",value:2,natural_value:-4},{category:"Land use and waste",indicator:"NDVI",unit:"%",value:4,natural_value:.22},{category:"Natural disaster hazards",indicator:"Share of total area with altitude above sea level less than 0,5 meters",unit:"%",value:1,natural_value:.16},{category:"Natural disaster hazards",indicator:"Growth rate of freshwater mirror area",unit:"%",value:5,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of registered heavy rain, flood and thunderbolt (change in last 3 years)",unit:"%",value:3,natural_value:-.0312706938485358},{category:"Natural disaster hazards",indicator:"Number of registered sand storm (change in last 3 years)",unit:"%",value:3,natural_value:0},{category:"Natural disaster hazards",indicator:"Environmental/natural disasters risk mitigation",unit:"Yes/No",value:5,natural_value:1},{category:"Natural disaster hazards",indicator:"Strategy/policy/government officials statement on environmental issues ",unit:"Yes/No",value:5,natural_value:1},{category:"Natural disaster hazards",indicator:"Total overall losses from natural disaster hazards",unit:"US$ mln ",value:3,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of days with average daily temperature above the threshold for 1990-2010",unit:"days",value:3,natural_value:15},{category:"Natural disaster hazards",indicator:"Number of disruptions to basic services, attributed to disasters",unit:"%",value:3,natural_value:0},{category:"Water availability",indicator:"Water consumption per capita",unit:"mcm",value:3,natural_value:.0003085905057588588},{category:"Water availability",indicator:"Water tariff to disposable income ratio",unit:"ratio",value:3,natural_value:1.3},{category:"Water availability",indicator:"Sanitary facilities tariff to disposable income ratio",unit:"ratio",value:2,natural_value:1.7},{category:"Water availability",indicator:"Water consumption per capita (change in last 3 years)",unit:"%",value:3,natural_value:0},{category:"Water availability",indicator:"Percentage of population with access to drinking water",unit:"%",value:2,natural_value:.988},{category:"Water availability",indicator:"Percentage of population with access to drinking water (change in last 3 years)",unit:"%",value:2,natural_value:0},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities",unit:"%",value:2,natural_value:.771666666666667},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities (change in last 3 years)",unit:"%",value:2,natural_value:.013},{category:"Food availability",indicator:"Cereal import dependency ratio (5-years average)",unit:"%",value:3,natural_value:.437333333333333},{category:"Food availability",indicator:"Cereal import dependency ratio (change in last 3 years)",unit:"%",value:3,natural_value:.04245544122},{category:"Food availability",indicator:"Prevalence of undernourishment",unit:"%",value:3,natural_value:.056},{category:"Food availability",indicator:"Prevalence of undernourishment (change in last 3 years)",unit:"%",value:3,natural_value:-.0125013105308766},{category:"Food availability",indicator:"Prevalence of undernourishment children",unit:"%",value:3,natural_value:.357},{category:"Food availability",indicator:"Prevalence of undernourishment children (change in last 3 years)",unit:"%",value:4,natural_value:0},{category:"Food availability",indicator:"Prevalence of moderate or severe food insecurity in the population",unit:"%",value:3,natural_value:.166666666666667},{category:"Food availability",indicator:"Share of imports in food resources",unit:"%",value:3,natural_value:.36},{category:"Food availability",indicator:"Percentage of people with access to at least one food vendor/retailer within 15 minutes of walking",unit:"%",value:3,natural_value:91},{category:"Food availability",indicator:"Perception of food availability index",unit:"index",value:2,natural_value:1.8640920844764555},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity",unit:"%",value:5,natural_value:1},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity (change in last 3 years)",unit:"%",value:3,natural_value:0},{category:"Energy availability",indicator:"Consumption of electricity per capita",unit:"kWh/person",value:3,natural_value:4079.2666666666664},{category:"Energy availability",indicator:"Consumption of electricity per capita (change in last 3 years)",unit:"%",value:3,natural_value:.00892969688080547},{category:"Energy availability",indicator:"Electricity tariff to disposable income ratio",unit:"ratio",value:5,natural_value:.002},{category:"Energy availability",indicator:"Share of renewable sources in electricity consumption",unit:"%",value:3,natural_value:.21},{category:"Energy availability",indicator:"Perception of energy availability index",unit:"index",value:4,natural_value:.6397959193215885},{category:"Health",indicator:"Child mortality rate (under 5 years-old)",unit:"% of live births ",value:3,natural_value:6.866666666666667},{category:"Health",indicator:"City ambulance",unit:"Yes/No",value:5,natural_value:1},{category:"Health",indicator:"Life expectancy at birth, years",unit:"Years",value:5,natural_value:79.94666666666666},{category:"Health",indicator:"Life expectancy at birth goals",unit:"categories",value:1,natural_value:1},{category:"Health",indicator:"Number of hospital beds per 1,000 population",unit:"per 1,000",value:3,natural_value:2.466666666666667},{category:"Health",indicator:"Number of doctors per 1,000 population",unit:"per 1,000",value:3,natural_value:6.6585},{category:"Health",indicator:"Maternal mortality ratio",unit:"deaths per 1,000 live births",value:3,natural_value:49},{category:"Health",indicator:"Ambulance arrival speed, min",unit:"min",value:3,natural_value:70},{category:"Education",indicator:"Literacy rate among population (15-24 Years)",unit:"%",value:4,natural_value:.991542002360026},{category:"Education",indicator:"Literacy rate among population (15-24 Years) (change in last 3 years)",unit:"%",value:2,natural_value:-.000852712549205825},{category:"Education",indicator:"Primary education engagement",unit:"%",value:5,natural_value:.9921428},{category:"Education",indicator:"Pupils per teacher rate",unit:"ratio",value:3,natural_value:18.877333333333336},{category:"Education",indicator:"Proportion of population with post-secondary and higher education",unit:"%",value:4,natural_value:.405},{category:"Wealth",indicator:"Percentage of population with food expenditure is above 52% of total expenditure",unit:"%",value:3,natural_value:.27},{category:"Wealth",indicator:"Mean monthly salary",unit:"US dollars thousand",value:3,natural_value:1082.1000000000001},{category:"Wealth",indicator:"Mean monthly salary, change in last 3 years",unit:"%",value:2,natural_value:-.0734334645124871},{category:"Wealth",indicator:"Disposable monthly income",unit:"US dollars thousand",value:2,natural_value:254.3964760687164},{category:"Wealth",indicator:"Disposable monthly income (change in last 3 years)",unit:"%",value:2,natural_value:-.0183481759621801},{category:"Wealth",indicator:"Debt to salary ratio",unit:"ratio",value:2,natural_value:18.240000000000002},{category:"Wealth",indicator:"Number of mobile phones per 1,000 population",unit:"per 1,000",value:4,natural_value:132.66666666666669},{category:"Wealth",indicator:"Decile income coefficient",unit:"ratio",value:3,natural_value:16.41333333333333},{category:"Wealth",indicator:"Decile income coefficient (change in last 3 years)",unit:"%",value:3,natural_value:.0128157365967749},{category:"Wealth",indicator:"Poverty headcount ratio at national poverty lines",unit:"%",value:3,natural_value:.21},{category:"Wealth",indicator:"Working poverty rate (percentage of employed living below US$1.90 PPP), 15+ age (%) ",unit:"%",value:3,natural_value:.022},{category:"Wealth",indicator:"Poverty headcount ratio at $2.15 PPP 2017 a day",unit:"%",value:3,natural_value:.0236666666666667},{category:"Wealth",indicator:"Living spaces per capita, sq m (change in last 3 years)",unit:"%",value:5,natural_value:.2213},{category:"Wealth",indicator:"Population living in slums (% of urban population)",unit:"%",value:3,natural_value:.17},{category:"Wealth",indicator:"Availability of finance (consumer loans)",unit:"%",value:3,natural_value:.5},{category:"Wealth",indicator:"Perception of wealth & poverty index",unit:"index",value:1,natural_value:1.3257846667649562},{category:"Safety",indicator:"Road fatalities rate per 100,000 population",unit:"per 100,000",value:4,natural_value:11.483333333333334},{category:"Safety",indicator:"Road fatalities rate per 100,000 population (change in last 3 years)",unit:"%",value:4,natural_value:.0786864009887851},{category:"Safety",indicator:"Violent crime rate per 100,000 population",unit:"per 100,000",value:3,natural_value:7.266666666666667},{category:"Safety",indicator:"Violent crime rate per 100,000 population (change in last 3 years)",unit:"%",value:4,natural_value:-.0682183289213857},{category:"Safety",indicator:"Crime rate per 100,000 population",unit:"per 100,000",value:3,natural_value:6270.933333333334},{category:"Safety",indicator:"Crime rate per 100,000 population  (change in last 3 years)",unit:"%",value:2,natural_value:-.0682183289213857},{category:"Safety",indicator:"Police arrival speed",unit:"min",value:2,natural_value:28},{category:"Safety",indicator:"Perception of safety index",unit:"index",value:4,natural_value:1.9649999999999999},{category:"Livability",indicator:"Number of LEED certified green buildings",unit:"Certified square meters per capita",value:3,natural_value:.35192599731186175},{category:"Livability",indicator:"Number of BREEAM certified projects",unit:"Certified square meters per capita",value:1,natural_value:0},{category:"Livability",indicator:"Whether or not the city has ISO 37120 certification",unit:"Yes/No",value:1,natural_value:0},{category:"Livability",indicator:"Mobile connection coverage",unit:"%",value:3,natural_value:.966666666666667},{category:"Livability",indicator:"Internet coverage",unit:"%",value:4,natural_value:.95},{category:"Livability",indicator:"Perception of livability index",unit:"index",value:4,natural_value:.8453069904609392},{category:"Livability",indicator:"Share of population in 1 km from schools",unit:"%",value:4,natural_value:98.6},{category:"Livability",indicator:"Share of population in 1 km from parks",unit:"%",value:5,natural_value:93.2},{category:"Transport",indicator:"Time loss in traffic",unit:"%",value:2,natural_value:34.8},{category:"Transport",indicator:"Share of the population in 1 km from public transport stop",unit:"%",value:3,natural_value:90.2},{category:"Transport",indicator:"Ratio of the cost of monthly public transport usage Ithe cheapest option) to average mobthly income",unit:"ratio",value:3,natural_value:.04},{category:"Transport",indicator:"Ratio of the cost of a 1-kilometer taxi ride to average mobthly income",unit:"%",value:3,natural_value:.04},{category:"Transport",indicator:"Percentage of city's roads that are segregated and/or has specialized lane for cyclists",unit:"%",value:3,natural_value:.06},{category:"Transport",indicator:"Number of public electric vehicle (EV) charging points per 100,000 population",unit:"per 100,000",value:3,natural_value:1.4},{category:"Transport",indicator:"Public transport (excluding subway) operates by schedule ",unit:"Yes/No",value:5,natural_value:1},{category:"Transport",indicator:"Perception of transport index",unit:"index",value:4,natural_value:.8453069904609392},{category:"Inclusion",indicator:"Female-friendly city",unit:"1,2,3,4,5",value:4,natural_value:2},{category:"Inclusion",indicator:"Number of refugees per 1,000 population",unit:"per 1,000",value:4,natural_value:.051},{category:"Inclusion",indicator:"Homeless people per 1,000 population",unit:"per 1,000",value:4,natural_value:.736},{category:"Inclusion",indicator:"Difference in number of years of schooling between woman and man, woman to man ratio ",unit:"years",value:3,natural_value:.97791},{category:"Inclusion",indicator:"Slavery index",unit:"index",value:5,natural_value:3.2},{category:"Inclusion",indicator:"Percentage of women aged 25-34 years old that have successfully completed secondary education",unit:"%",value:3,natural_value:.451},{category:"Inclusion",indicator:"Regulations for building construction and equipment, public transport for people with disabilities",unit:"Yes/No",value:5,natural_value:1},{category:"Inclusion",indicator:"Perception of inclusion index",unit:"index",value:4,natural_value:1.608933747267902},{category:"Accountability",indicator:"City budget execution publication",unit:"Yes/No",value:5,natural_value:1},{category:"Accountability",indicator:"City budget publication",unit:"Yes/No",value:5,natural_value:1},{category:"Accountability",indicator:"Financial transparency on city government companies",unit:"Yes/No",value:1,natural_value:0},{category:"Accountability",indicator:"ISO certification",unit:"Yes/No",value:1,natural_value:0},{category:"Accountability",indicator:"City council checks and balances",unit:"Yes/No",value:1,natural_value:0},{category:"Accountability",indicator:"Plans to obtain ISO certification",unit:"Yes/No",value:1,natural_value:0},{category:"Accountability",indicator:"Perception of accountability index",unit:"index",value:3,natural_value:.9155840858082012},{category:"City budget",indicator:"Poor financial condition",unit:"Yes/No",value:5,natural_value:0},{category:"City budget",indicator:"Central/higher level government financial intervention taking place",unit:"Yes/No",value:5,natural_value:0},{category:"City budget",indicator:"Long-term financial planning",unit:"Yes/No",value:1,natural_value:0},{category:"City budget",indicator:"Central/higher level government financial intervention is considered",unit:"Yes/No",value:1,natural_value:0},{category:"City budget",indicator:"Prudent fiscal policy requirements",unit:"Yes/No",value:1,natural_value:0},{category:"City budget",indicator:"Medium-term planning",unit:"Yes/No",value:1,natural_value:0},{category:"SME",indicator:"Number of SMEs per 100,000 population",unit:"per 100,000",value:5,natural_value:32477.9},{category:"SME",indicator:"Number of start-ups",unit:"start-ups",value:3,natural_value:4},{category:"SME",indicator:"Global Startup Ecosystem Index",unit:"index",value:1,natural_value:.178},{category:"SME",indicator:"Number of SMEs per capita/100 000 population (change in last 3 years)",unit:"%",value:3,natural_value:.00427846538976695},{category:"SME",indicator:"Number of start-ups (change in last 3 years)",unit:"%",value:5,natural_value:0},{category:"Public services",indicator:"Free phone to call the police, ambulance, firefighters",unit:"1,2,3,4,5",value:5,natural_value:1},{category:"Public services",indicator:"Services for working with citizens' appeals and complaint",unit:"Yes/No",value:5,natural_value:1},{category:"Public services",indicator:"E-gov services",unit:"Yes/No",value:5,natural_value:1},{category:"Public services",indicator:"Perception of public services index: Public Services",unit:"index",value:4,natural_value:.9361290524476109},{category:"Sustainability commitment",indicator:"City ESG reporting",unit:"Yes/No",value:1,natural_value:0},{category:"Sustainability commitment",indicator:"City ESG reporting verification",unit:"Yes/No",value:1,natural_value:0},{category:"Sustainability commitment",indicator:"ESG planning",unit:"Yes/No",value:1,natural_value:0},{category:"Sustainability commitment",indicator:"Plan with specific targets to develop and implement smart city principles",unit:"Yes/No",value:5,natural_value:1},{category:"Sustainability commitment",indicator:"Rollout and status of ESG / UN SDG training across the municipal/asset workforce",unit:"Yes/No",value:1,natural_value:0},{category:"Sustainability commitment",indicator:"City municipality involved in network or partnership promoting sustainable development (for example, C40 Cities network)",unit:"Yes/No",value:5,natural_value:1}]},{city:"Dar es Salaam",data:[{category:"Air pollution",indicator:"CO2 emissions",unit:"kt",value:5,natural_value:.2},{category:"Air pollution",indicator:"CO2 emissions (change in last 3 years)",unit:"%",value:2,natural_value:4.6},{category:"Air pollution",indicator:"CO2 concentration",unit:"ppm",value:5,natural_value:412.5},{category:"Air pollution",indicator:"CO2 concentration (change in last 3 years)",unit:"%",value:3,natural_value:1.6},{category:"Air pollution",indicator:"Annual average of SO2 concentration in ambient air",unit:"microgram/m3",value:5,natural_value:.2},{category:"Air pollution",indicator:"Annual Average of SO2 Concentration in Ambient Air (change in last 3 years)",unit:"%",value:5,natural_value:-67.3},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air",unit:"microgram/m3",value:1,natural_value:.4},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air (change in last 3 years), microgram/m3",unit:"%",value:5,natural_value:-8.2},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air, microgram/m3",unit:"microgram/m3",value:3,natural_value:49.6},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air (change in last 3 years), microgram/m3",unit:"%",value:2,natural_value:3.8},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air, microgram/m3",unit:"microgram/m3",value:5,natural_value:.1},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air (change in last 3 years), microgram/m3",unit:"%",value:5,natural_value:-7.2},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air, microgram/m3",unit:"microgram/m3",value:5,natural_value:16.8},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air (change in last 3 years), microgram/m3",unit:"%",value:1,natural_value:12.1},{category:"Air pollution",indicator:"Volatile organic compounds/reactive organic gases emissions",unit:"microgram/m3",value:5,natural_value:.6},{category:"Air pollution",indicator:"Perception of air pollution index",unit:"index",value:3,natural_value:1.84},{category:"Air pollution",indicator:"Paris Agreement",unit:"Yes/No",value:5,natural_value:1},{category:"Water pollution",indicator:"Annual average of dissolved oxygen (DO) concentration in water",unit:"%",value:5,natural_value:4.6},{category:"Water pollution",indicator:"Annual average of pH concentration in water",unit:"pH",value:5,natural_value:4.2},{category:"Water pollution",indicator:"Annual average dissolved solids in drinking-water",unit:"ppm",value:3,natural_value:139},{category:"Water pollution",indicator:"Water management strategy in a city",unit:"Yes/No",value:1,natural_value:0},{category:"Water pollution",indicator:"Perception of water pollution index",unit:"index",value:4,natural_value:1.5753920145654807},{category:"Land use and waste",indicator:"Share of devastated and degraded land area requiring reclamation",unit:"%",value:3,natural_value:6.7},{category:"Land use and waste",indicator:"3-year average growth rate of devastated and degraded land area requiring reclamation",unit:"%",value:4,natural_value:-.018},{category:"Land use and waste",indicator:"Waste deposits",unit:"%",value:2,natural_value:.013},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous)",unit:"kg per capita ",value:5,natural_value:16.761630773179},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous), (change in last 3 years)",unit:"%",value:4,natural_value:.94309270238},{category:"Land use and waste",indicator:"Total recycled construction waste",unit:"tons per capita",value:3,natural_value:2.041343669},{category:"Land use and waste",indicator:"Share of recycled construction and demolish waste in total generated construction and demolish waste",unit:"%",value:2,natural_value:.06},{category:"Land use and waste",indicator:"Total area of impervious surfaces and percentage to total city area",unit:"%",value:3,natural_value:.02},{category:"Land use and waste",indicator:"Productive urban land (in percent total land)",unit:"%",value:3,natural_value:32.2},{category:"Land use and waste",indicator:"Waste managenet strategy",unit:"Yes/No",value:1,natural_value:0},{category:"Land use and waste",indicator:"Perception of waste index",unit:"index",value:5,natural_value:2.0883519403371764},{category:"Land use and waste",indicator:"Green spaces, % city area",unit:"%",value:3,natural_value:.1989},{category:"Land use and waste",indicator:"Green spaces, change in last 3 years",unit:"%",value:2,natural_value:-1.6},{category:"Land use and waste",indicator:"NDVI",unit:"%",value:3,natural_value:.25},{category:"Natural disaster hazards",indicator:"Share of total area with altitude above sea level less than 0,5 meters",unit:"%",value:2,natural_value:.15},{category:"Natural disaster hazards",indicator:"Growth rate of freshwater mirror area",unit:"%",value:4,natural_value:-.05},{category:"Natural disaster hazards",indicator:"Number of registered heavy rain, flood and thunderbolt (change in last 3 years)",unit:"%",value:4,natural_value:-.0670521428844533},{category:"Natural disaster hazards",indicator:"Number of registered sand storm (change in last 3 years)",unit:"%",value:4,natural_value:-.186448788952852},{category:"Natural disaster hazards",indicator:"Environmental/natural disasters risk mitigation",unit:"Yes/No",value:5,natural_value:1},{category:"Natural disaster hazards",indicator:"Strategy/policy/government officials statement on environmental issues ",unit:"Yes/No",value:5,natural_value:1},{category:"Natural disaster hazards",indicator:"Total overall losses from natural disaster hazards",unit:"US$ mln ",value:3,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of days with average daily temperature above the threshold for 1990-2010",unit:"days",value:3,natural_value:15},{category:"Natural disaster hazards",indicator:"Number of disruptions to basic services, attributed to disasters",unit:"%",value:3,natural_value:0},{category:"Water availability",indicator:"Water consumption per capita",unit:"mcm",value:3,natural_value:9489999999999999e-21},{category:"Water availability",indicator:"Water tariff to disposable income ratio",unit:"ratio",value:3,natural_value:.7},{category:"Water availability",indicator:"Sanitary facilities tariff to disposable income ratio",unit:"ratio",value:2,natural_value:2.1},{category:"Water availability",indicator:"Water consumption per capita (change in last 3 years)",unit:"%",value:3,natural_value:0},{category:"Water availability",indicator:"Percentage of population with access to drinking water",unit:"%",value:3,natural_value:.6},{category:"Water availability",indicator:"Percentage of population with access to drinking water (change in last 3 years)",unit:"%",value:3,natural_value:.011},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities",unit:"%",value:3,natural_value:.311666666666667},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities (change in last 3 years)",unit:"%",value:1,natural_value:.018},{category:"Food availability",indicator:"Cereal import dependency ratio (5-years average)",unit:"%",value:4,natural_value:.042},{category:"Food availability",indicator:"Cereal import dependency ratio (change in last 3 years)",unit:"%",value:4,natural_value:-.1398613725},{category:"Food availability",indicator:"Prevalence of undernourishment",unit:"%",value:3,natural_value:.056},{category:"Food availability",indicator:"Prevalence of undernourishment (change in last 3 years)",unit:"%",value:3,natural_value:-.0101163005900995},{category:"Food availability",indicator:"Prevalence of undernourishment children",unit:"%",value:3,natural_value:.357},{category:"Food availability",indicator:"Prevalence of undernourishment children (change in last 3 years)",unit:"%",value:3,natural_value:-.0158254476471159},{category:"Food availability",indicator:"Prevalence of moderate or severe food insecurity in the population",unit:"%",value:2,natural_value:.5685},{category:"Food availability",indicator:"Share of imports in food resources",unit:"%",value:3,natural_value:.36},{category:"Food availability",indicator:"Percentage of people with access to at least one food vendor/retailer within 15 minutes of walking",unit:"%",value:3,natural_value:91},{category:"Food availability",indicator:"Perception of food availability index",unit:"index",value:5,natural_value:3.3307200778133215},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity",unit:"%",value:1,natural_value:.401},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity (change in last 3 years)",unit:"%",value:5,natural_value:.0423866522560024},{category:"Energy availability",indicator:"Consumption of electricity per capita",unit:"kWh/person",value:4,natural_value:915.5},{category:"Energy availability",indicator:"Consumption of electricity per capita (change in last 3 years)",unit:"%",value:2,natural_value:.195999685612988},{category:"Energy availability",indicator:"Electricity tariff to disposable income ratio",unit:"ratio",value:3,natural_value:.09866666666666668},{category:"Energy availability",indicator:"Share of renewable sources in electricity consumption",unit:"%",value:3,natural_value:.21},{category:"Energy availability",indicator:"Perception of energy availability index",unit:"index",value:2,natural_value:1.7464372477518388},{category:"Health",indicator:"Child mortality rate (under 5 years-old)",unit:"% of live births ",value:4,natural_value:4.86666666666667},{category:"Health",indicator:"City ambulance",unit:"Yes/No",value:5,natural_value:1},{category:"Health",indicator:"Life expectancy at birth, years",unit:"Years",value:2,natural_value:66.33333333333333},{category:"Health",indicator:"Life expectancy at birth goals",unit:"categories",value:5,natural_value:3},{category:"Health",indicator:"Number of hospital beds per 1,000 population",unit:"per 1,000",value:4,natural_value:.9},{category:"Health",indicator:"Number of doctors per 1,000 population",unit:"per 1,000",value:4,natural_value:.1},{category:"Health",indicator:"Maternal mortality ratio",unit:"deaths per 1,000 live births",value:3,natural_value:49},{category:"Health",indicator:"Ambulance arrival speed, min",unit:"min",value:3,natural_value:70},{category:"Education",indicator:"Literacy rate among population (15-24 Years)",unit:"%",value:2,natural_value:.866666666666667},{category:"Education",indicator:"Literacy rate among population (15-24 Years) (change in last 3 years)",unit:"%",value:4,natural_value:.00769260999601173},{category:"Education",indicator:"Primary education engagement",unit:"%",value:3,natural_value:.8430377},{category:"Education",indicator:"Pupils per teacher rate",unit:"ratio",value:1,natural_value:41},{category:"Education",indicator:"Proportion of population with post-secondary and higher education",unit:"%",value:2,natural_value:.02555639982},{category:"Wealth",indicator:"Percentage of population with food expenditure is above 52% of total expenditure",unit:"%",value:3,natural_value:.143333333333333},{category:"Wealth",indicator:"Mean monthly salary",unit:"US dollars thousand",value:2,natural_value:198.89333333333332},{category:"Wealth",indicator:"Mean monthly salary, change in last 3 years",unit:"%",value:2,natural_value:-.0647021383543841},{category:"Wealth",indicator:"Disposable monthly income",unit:"US dollars thousand",value:2,natural_value:277.8994829014047},{category:"Wealth",indicator:"Disposable monthly income (change in last 3 years)",unit:"%",value:2,natural_value:-.0154922656223049},{category:"Wealth",indicator:"Debt to salary ratio",unit:"ratio",value:3,natural_value:3.83754800973528},{category:"Wealth",indicator:"Number of mobile phones per 1,000 population",unit:"per 1,000",value:4,natural_value:82.66666666666666},{category:"Wealth",indicator:"Decile income coefficient",unit:"ratio",value:3,natural_value:11.391264367816092},{category:"Wealth",indicator:"Decile income coefficient (change in last 3 years)",unit:"%",value:3,natural_value:-.036482129845679},{category:"Wealth",indicator:"Poverty headcount ratio at national poverty lines",unit:"%",value:3,natural_value:.333333333333333},{category:"Wealth",indicator:"Working poverty rate (percentage of employed living below US$1.90 PPP), 15+ age (%) ",unit:"%",value:3,natural_value:.032},{category:"Wealth",indicator:"Poverty headcount ratio at $2.15 PPP 2017 a day",unit:"%",value:3,natural_value:.0346666666666667},{category:"Wealth",indicator:"Living spaces per capita, sq m (change in last 3 years)",unit:"%",value:1,natural_value:0},{category:"Wealth",indicator:"Population living in slums (% of urban population)",unit:"%",value:3,natural_value:.17},{category:"Wealth",indicator:"Availability of finance (consumer loans)",unit:"%",value:3,natural_value:.5},{category:"Wealth",indicator:"Perception of wealth & poverty index",unit:"index",value:2,natural_value:1.8715798707389055},{category:"Safety",indicator:"Road fatalities rate per 100,000 population",unit:"per 100,000",value:1,natural_value:383.3333333333333},{category:"Safety",indicator:"Road fatalities rate per 100,000 population (change in last 3 years)",unit:"%",value:2,natural_value:-.14},{category:"Safety",indicator:"Violent crime rate per 100,000 population",unit:"per 100,000",value:3,natural_value:7.240165689817097},{category:"Safety",indicator:"Violent crime rate per 100,000 population (change in last 3 years)",unit:"%",value:3,natural_value:-.00832504805114254},{category:"Safety",indicator:"Crime rate per 100,000 population",unit:"per 100,000",value:4,natural_value:56},{category:"Safety",indicator:"Crime rate per 100,000 population  (change in last 3 years)",unit:"%",value:4,natural_value:-.00832504805114254},{category:"Safety",indicator:"Police arrival speed",unit:"min",value:2,natural_value:28},{category:"Safety",indicator:"Perception of safety index",unit:"index",value:2,natural_value:3.475},{category:"Livability",indicator:"Number of LEED certified green buildings",unit:"Certified square meters per capita",value:2,natural_value:.0009965494125590817},{category:"Livability",indicator:"Number of BREEAM certified projects",unit:"Certified square meters per capita",value:1,natural_value:0},{category:"Livability",indicator:"Whether or not the city has ISO 37120 certification",unit:"Yes/No",value:1,natural_value:0},{category:"Livability",indicator:"Mobile connection coverage",unit:"%",value:3,natural_value:.95},{category:"Livability",indicator:"Internet coverage",unit:"%",value:2,natural_value:.85},{category:"Livability",indicator:"Perception of livability index",unit:"index",value:3,natural_value:1.4694013205984446},{category:"Livability",indicator:"Share of population in 1 km from schools",unit:"%",value:4,natural_value:97.5},{category:"Livability",indicator:"Share of population in 1 km from parks",unit:"%",value:2,natural_value:34.4},{category:"Transport",indicator:"Time loss in traffic",unit:"%",value:3,natural_value:22.9},{category:"Transport",indicator:"Share of the population in 1 km from public transport stop",unit:"%",value:2,natural_value:48.2},{category:"Transport",indicator:"Ratio of the cost of monthly public transport usage Ithe cheapest option) to average mobthly income",unit:"ratio",value:3,natural_value:.04},{category:"Transport",indicator:"Ratio of the cost of a 1-kilometer taxi ride to average mobthly income",unit:"%",value:3,natural_value:.04},{category:"Transport",indicator:"Percentage of city's roads that are segregated and/or has specialized lane for cyclists",unit:"%",value:3,natural_value:.06},{category:"Transport",indicator:"Number of public electric vehicle (EV) charging points per 100,000 population",unit:"per 100,000",value:3,natural_value:1.4},{category:"Transport",indicator:"Public transport (excluding subway) operates by schedule ",unit:"Yes/No",value:5,natural_value:1},{category:"Transport",indicator:"Perception of transport index",unit:"index",value:3,natural_value:1.4694013205984446},{category:"Inclusion",indicator:"Female-friendly city",unit:"1,2,3,4,5",value:4,natural_value:2},{category:"Inclusion",indicator:"Number of refugees per 1,000 population",unit:"per 1,000",value:4,natural_value:.034},{category:"Inclusion",indicator:"Homeless people per 1,000 population",unit:"per 1,000",value:3,natural_value:1.889719188959608},{category:"Inclusion",indicator:"Difference in number of years of schooling between woman and man, woman to man ratio ",unit:"years",value:1,natural_value:5.45},{category:"Inclusion",indicator:"Slavery index",unit:"index",value:5,natural_value:2.9},{category:"Inclusion",indicator:"Percentage of women aged 25-34 years old that have successfully completed secondary education",unit:"%",value:3,natural_value:.423},{category:"Inclusion",indicator:"Regulations for building construction and equipment, public transport for people with disabilities",unit:"Yes/No",value:1,natural_value:0},{category:"Inclusion",indicator:"Perception of inclusion index",unit:"index",value:4,natural_value:2.0596216601999084},{category:"Accountability",indicator:"City budget execution publication",unit:"Yes/No",value:1,natural_value:0},{category:"Accountability",indicator:"City budget publication",unit:"Yes/No",value:1,natural_value:0},{category:"Accountability",indicator:"Financial transparency on city government companies",unit:"Yes/No",value:5,natural_value:1},{category:"Accountability",indicator:"ISO certification",unit:"Yes/No",value:1,natural_value:0},{category:"Accountability",indicator:"City council checks and balances",unit:"Yes/No",value:5,natural_value:1},{category:"Accountability",indicator:"Plans to obtain ISO certification",unit:"Yes/No",value:1,natural_value:0},{category:"Accountability",indicator:"Perception of accountability index",unit:"index",value:1,natural_value:1.2774937108588444},{category:"City budget",indicator:"Poor financial condition",unit:"Yes/No",value:5,natural_value:0},{category:"City budget",indicator:"Central/higher level government financial intervention taking place",unit:"Yes/No",value:5,natural_value:0},{category:"City budget",indicator:"Long-term financial planning",unit:"Yes/No",value:1,natural_value:0},{category:"City budget",indicator:"Central/higher level government financial intervention is considered",unit:"Yes/No",value:1,natural_value:0},{category:"City budget",indicator:"Prudent fiscal policy requirements",unit:"Yes/No",value:1,natural_value:0},{category:"City budget",indicator:"Medium-term planning",unit:"Yes/No",value:5,natural_value:1},{category:"SME",indicator:"Number of SMEs per 100,000 population",unit:"per 100,000",value:1,natural_value:32893.42962791773},{category:"SME",indicator:"Number of start-ups",unit:"start-ups",value:3,natural_value:334.3530666666667},{category:"SME",indicator:"Global Startup Ecosystem Index",unit:"index",value:1,natural_value:.336},{category:"SME",indicator:"Number of SMEs per capita/100 000 population (change in last 3 years)",unit:"%",value:3,natural_value:0},{category:"SME",indicator:"Number of start-ups (change in last 3 years)",unit:"%",value:1,natural_value:.396709338846017},{category:"Public services",indicator:"Free phone to call the police, ambulance, firefighters",unit:"1,2,3,4,5",value:5,natural_value:1},{category:"Public services",indicator:"Services for working with citizens' appeals and complaint",unit:"Yes/No",value:5,natural_value:1},{category:"Public services",indicator:"E-gov services",unit:"Yes/No",value:5,natural_value:1},{category:"Public services",indicator:"Perception of public services index: Public Services",unit:"index",value:2,natural_value:2.221932145814465},{category:"Sustainability commitment",indicator:"City ESG reporting",unit:"Yes/No",value:1,natural_value:0},{category:"Sustainability commitment",indicator:"City ESG reporting verification",unit:"Yes/No",value:1,natural_value:0},{category:"Sustainability commitment",indicator:"ESG planning",unit:"Yes/No",value:1,natural_value:0},{category:"Sustainability commitment",indicator:"Plan with specific targets to develop and implement smart city principles",unit:"Yes/No",value:1,natural_value:0},{category:"Sustainability commitment",indicator:"Rollout and status of ESG / UN SDG training across the municipal/asset workforce",unit:"Yes/No",value:1,natural_value:0},{category:"Sustainability commitment",indicator:"City municipality involved in network or partnership promoting sustainable development (for example, C40 Cities network)",unit:"Yes/No",value:1,natural_value:0}]},{city:"Adoni",data:[{category:"Air pollution",indicator:"CO2 emissions",unit:"kt",value:4,natural_value:1.6},{category:"Air pollution",indicator:"CO2 emissions (change in last 3 years)",unit:"%",value:3,natural_value:2.7},{category:"Air pollution",indicator:"CO2 concentration",unit:"ppm",value:3,natural_value:435.7},{category:"Air pollution",indicator:"CO2 concentration (change in last 3 years)",unit:"%",value:3,natural_value:2.4},{category:"Air pollution",indicator:"Annual average of SO2 concentration in ambient air",unit:"microgram/m3",value:4,natural_value:5.1},{category:"Air pollution",indicator:"Annual Average of SO2 Concentration in Ambient Air (change in last 3 years)",unit:"%",value:4,natural_value:-52.2},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air",unit:"microgram/m3",value:2,natural_value:10.2},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air (change in last 3 years), microgram/m3",unit:"%",value:4,natural_value:-1.6},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air, microgram/m3",unit:"microgram/m3",value:2,natural_value:73.1},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air (change in last 3 years), microgram/m3",unit:"%",value:2,natural_value:3.1},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air, microgram/m3",unit:"microgram/m3",value:3,natural_value:.4},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air (change in last 3 years), microgram/m3",unit:"%",value:3,natural_value:.1},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air, microgram/m3",unit:"microgram/m3",value:4,natural_value:53.6},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air (change in last 3 years), microgram/m3",unit:"%",value:1,natural_value:21.7},{category:"Air pollution",indicator:"Volatile organic compounds/reactive organic gases emissions",unit:"microgram/m3",value:2,natural_value:2.1},{category:"Air pollution",indicator:"Perception of air pollution index",unit:"index",value:1,natural_value:3.51},{category:"Air pollution",indicator:"Paris Agreement",unit:"Yes/No",value:5,natural_value:1},{category:"Water pollution",indicator:"Annual average of dissolved oxygen (DO) concentration in water",unit:"%",value:3,natural_value:6.364666666666667},{category:"Water pollution",indicator:"Annual average of pH concentration in water",unit:"pH",value:2,natural_value:7.48},{category:"Water pollution",indicator:"Annual average dissolved solids in drinking-water",unit:"ppm",value:3,natural_value:139},{category:"Water pollution",indicator:"Water management strategy in a city",unit:"Yes/No",value:1,natural_value:0},{category:"Water pollution",indicator:"Perception of water pollution index",unit:"index",value:1,natural_value:4.237722036452691},{category:"Land use and waste",indicator:"Share of devastated and degraded land area requiring reclamation",unit:"%",value:4,natural_value:3.2},{category:"Land use and waste",indicator:"3-year average growth rate of devastated and degraded land area requiring reclamation",unit:"%",value:2,natural_value:.034},{category:"Land use and waste",indicator:"Waste deposits",unit:"%",value:1,natural_value:.02467},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous)",unit:"kg per capita ",value:5,natural_value:43.57403004271947},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous), (change in last 3 years)",unit:"%",value:3,natural_value:3.0448031884},{category:"Land use and waste",indicator:"Total recycled construction waste",unit:"tons per capita",value:1,natural_value:.001049303},{category:"Land use and waste",indicator:"Share of recycled construction and demolish waste in total generated construction and demolish waste",unit:"%",value:3,natural_value:.137},{category:"Land use and waste",indicator:"Total area of impervious surfaces and percentage to total city area",unit:"%",value:3,natural_value:.02},{category:"Land use and waste",indicator:"Productive urban land (in percent total land)",unit:"%",value:3,natural_value:32.2},{category:"Land use and waste",indicator:"Waste managenet strategy",unit:"Yes/No",value:1,natural_value:0},{category:"Land use and waste",indicator:"Perception of waste index",unit:"index",value:4,natural_value:2.4809015475033926},{category:"Land use and waste",indicator:"Green spaces, % city area",unit:"%",value:4,natural_value:.4061},{category:"Land use and waste",indicator:"Green spaces, change in last 3 years",unit:"%",value:3,natural_value:.9},{category:"Land use and waste",indicator:"NDVI",unit:"%",value:3,natural_value:.24},{category:"Natural disaster hazards",indicator:"Share of total area with altitude above sea level less than 0,5 meters",unit:"%",value:5,natural_value:0},{category:"Natural disaster hazards",indicator:"Growth rate of freshwater mirror area",unit:"%",value:3,natural_value:-.1},{category:"Natural disaster hazards",indicator:"Number of registered heavy rain, flood and thunderbolt (change in last 3 years)",unit:"%",value:3,natural_value:-.0390013286126644},{category:"Natural disaster hazards",indicator:"Number of registered sand storm (change in last 3 years)",unit:"%",value:3,natural_value:-.068012954951526},{category:"Natural disaster hazards",indicator:"Environmental/natural disasters risk mitigation",unit:"Yes/No",value:5,natural_value:1},{category:"Natural disaster hazards",indicator:"Strategy/policy/government officials statement on environmental issues ",unit:"Yes/No",value:5,natural_value:1},{category:"Natural disaster hazards",indicator:"Total overall losses from natural disaster hazards",unit:"US$ mln ",value:3,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of days with average daily temperature above the threshold for 1990-2010",unit:"days",value:3,natural_value:15},{category:"Natural disaster hazards",indicator:"Number of disruptions to basic services, attributed to disasters",unit:"%",value:3,natural_value:0},{category:"Water availability",indicator:"Water consumption per capita",unit:"mcm",value:3,natural_value:.0005761166037365854},{category:"Water availability",indicator:"Water tariff to disposable income ratio",unit:"ratio",value:5,natural_value:0},{category:"Water availability",indicator:"Sanitary facilities tariff to disposable income ratio",unit:"ratio",value:1,natural_value:2.5},{category:"Water availability",indicator:"Water consumption per capita (change in last 3 years)",unit:"%",value:3,natural_value:0},{category:"Water availability",indicator:"Percentage of population with access to drinking water",unit:"%",value:3,natural_value:.94},{category:"Water availability",indicator:"Percentage of population with access to drinking water (change in last 3 years)",unit:"%",value:3,natural_value:0},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities",unit:"%",value:3,natural_value:.683333333333333},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities (change in last 3 years)",unit:"%",value:3,natural_value:.029},{category:"Food availability",indicator:"Cereal import dependency ratio (5-years average)",unit:"%",value:4,natural_value:-.0563333333333333},{category:"Food availability",indicator:"Cereal import dependency ratio (change in last 3 years)",unit:"%",value:2,natural_value:.06488171074},{category:"Food availability",indicator:"Prevalence of undernourishment",unit:"%",value:3,natural_value:.056},{category:"Food availability",indicator:"Prevalence of undernourishment (change in last 3 years)",unit:"%",value:3,natural_value:.0666991349319599},{category:"Food availability",indicator:"Prevalence of undernourishment children",unit:"%",value:3,natural_value:.357},{category:"Food availability",indicator:"Prevalence of undernourishment children (change in last 3 years)",unit:"%",value:3,natural_value:-.0182411646604512},{category:"Food availability",indicator:"Prevalence of moderate or severe food insecurity in the population",unit:"%",value:3,natural_value:.406},{category:"Food availability",indicator:"Share of imports in food resources",unit:"%",value:3,natural_value:.36},{category:"Food availability",indicator:"Percentage of people with access to at least one food vendor/retailer within 15 minutes of walking",unit:"%",value:3,natural_value:91},{category:"Food availability",indicator:"Perception of food availability index",unit:"index",value:3,natural_value:2.0123986386340906},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity",unit:"%",value:3,natural_value:.973333333333333},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity (change in last 3 years)",unit:"%",value:4,natural_value:.0126986796536908},{category:"Energy availability",indicator:"Consumption of electricity per capita",unit:"kWh/person",value:4,natural_value:758.3852989040864},{category:"Energy availability",indicator:"Consumption of electricity per capita (change in last 3 years)",unit:"%",value:3,natural_value:.0299415138727994},{category:"Energy availability",indicator:"Electricity tariff to disposable income ratio",unit:"ratio",value:3,natural_value:.09233333333333334},{category:"Energy availability",indicator:"Share of renewable sources in electricity consumption",unit:"%",value:3,natural_value:.21},{category:"Energy availability",indicator:"Perception of energy availability index",unit:"index",value:3,natural_value:1.115973148644494},{category:"Health",indicator:"Child mortality rate (under 5 years-old)",unit:"% of live births ",value:4,natural_value:5.86666666666667},{category:"Health",indicator:"City ambulance",unit:"Yes/No",value:5,natural_value:1},{category:"Health",indicator:"Life expectancy at birth, years",unit:"Years",value:2,natural_value:71.85},{category:"Health",indicator:"Life expectancy at birth goals",unit:"categories",value:1,natural_value:1},{category:"Health",indicator:"Number of hospital beds per 1,000 population",unit:"per 1,000",value:4,natural_value:.4841105354058722},{category:"Health",indicator:"Number of doctors per 1,000 population",unit:"per 1,000",value:4,natural_value:.7530765255860573},{category:"Health",indicator:"Maternal mortality ratio",unit:"deaths per 1,000 live births",value:3,natural_value:49},{category:"Health",indicator:"Ambulance arrival speed, min",unit:"min",value:3,natural_value:70},{category:"Education",indicator:"Literacy rate among population (15-24 Years)",unit:"%",value:2,natural_value:.774433333333333},{category:"Education",indicator:"Literacy rate among population (15-24 Years) (change in last 3 years)",unit:"%",value:3,natural_value:0},{category:"Education",indicator:"Primary education engagement",unit:"%",value:5,natural_value:.9706456},{category:"Education",indicator:"Pupils per teacher rate",unit:"ratio",value:2,natural_value:30},{category:"Education",indicator:"Proportion of population with post-secondary and higher education",unit:"%",value:2,natural_value:.0911604537342698},{category:"Wealth",indicator:"Percentage of population with food expenditure is above 52% of total expenditure",unit:"%",value:3,natural_value:.213333333333333},{category:"Wealth",indicator:"Mean monthly salary",unit:"US dollars thousand",value:3,natural_value:2768.8000000000006},{category:"Wealth",indicator:"Mean monthly salary, change in last 3 years",unit:"%",value:3,natural_value:.0196642582706827},{category:"Wealth",indicator:"Disposable monthly income",unit:"US dollars thousand",value:3,natural_value:733.0256252983403},{category:"Wealth",indicator:"Disposable monthly income (change in last 3 years)",unit:"%",value:5,natural_value:.125516966254866},{category:"Wealth",indicator:"Debt to salary ratio",unit:"ratio",value:3,natural_value:9.29401497117486},{category:"Wealth",indicator:"Number of mobile phones per 1,000 population",unit:"per 1,000",value:3,natural_value:82.66666666666666},{category:"Wealth",indicator:"Decile income coefficient",unit:"ratio",value:3,natural_value:8.6890756302521},{category:"Wealth",indicator:"Decile income coefficient (change in last 3 years)",unit:"%",value:3,natural_value:.011},{category:"Wealth",indicator:"Poverty headcount ratio at national poverty lines",unit:"%",value:3,natural_value:.273333333333333},{category:"Wealth",indicator:"Working poverty rate (percentage of employed living below US$1.90 PPP), 15+ age (%) ",unit:"%",value:3,natural_value:.03},{category:"Wealth",indicator:"Poverty headcount ratio at $2.15 PPP 2017 a day",unit:"%",value:3,natural_value:.042},{category:"Wealth",indicator:"Living spaces per capita, sq m (change in last 3 years)",unit:"%",value:1,natural_value:0},{category:"Wealth",indicator:"Population living in slums (% of urban population)",unit:"%",value:3,natural_value:.17},{category:"Wealth",indicator:"Availability of finance (consumer loans)",unit:"%",value:3,natural_value:.5},{category:"Wealth",indicator:"Perception of wealth & poverty index",unit:"index",value:4,natural_value:1.4613529663376146},{category:"Safety",indicator:"Road fatalities rate per 100,000 population",unit:"per 100,000",value:4,natural_value:10.666666666666666},{category:"Safety",indicator:"Road fatalities rate per 100,000 population (change in last 3 years)",unit:"%",value:5,natural_value:.208},{category:"Safety",indicator:"Violent crime rate per 100,000 population",unit:"per 100,000",value:2,natural_value:16.48181321670989},{category:"Safety",indicator:"Violent crime rate per 100,000 population (change in last 3 years)",unit:"%",value:3,natural_value:.0275130980808507},{category:"Safety",indicator:"Crime rate per 100,000 population",unit:"per 100,000",value:3,natural_value:2391.3621676725943},{category:"Safety",indicator:"Crime rate per 100,000 population  (change in last 3 years)",unit:"%",value:5,natural_value:.0275130980808507},{category:"Safety",indicator:"Police arrival speed",unit:"min",value:2,natural_value:24.89},{category:"Safety",indicator:"Perception of safety index",unit:"index",value:2,natural_value:3.665},{category:"Livability",indicator:"Number of LEED certified green buildings",unit:"Certified square meters per capita",value:2,natural_value:.01973773861260913},{category:"Livability",indicator:"Number of BREEAM certified projects",unit:"Certified square meters per capita",value:1,natural_value:0},{category:"Livability",indicator:"Whether or not the city has ISO 37120 certification",unit:"Yes/No",value:1,natural_value:0},{category:"Livability",indicator:"Mobile connection coverage",unit:"%",value:3,natural_value:.9},{category:"Livability",indicator:"Internet coverage",unit:"%",value:4,natural_value:.967666666666667},{category:"Livability",indicator:"Perception of livability index",unit:"index",value:3,natural_value:2.068296237483395},{category:"Livability",indicator:"Share of population in 1 km from schools",unit:"%",value:4,natural_value:98.3},{category:"Livability",indicator:"Share of population in 1 km from parks",unit:"%",value:4,natural_value:70.4},{category:"Transport",indicator:"Time loss in traffic",unit:"%",value:4,natural_value:7.8},{category:"Transport",indicator:"Share of the population in 1 km from public transport stop",unit:"%",value:3,natural_value:26.6},{category:"Transport",indicator:"Ratio of the cost of monthly public transport usage Ithe cheapest option) to average mobthly income",unit:"ratio",value:3,natural_value:.04},{category:"Transport",indicator:"Ratio of the cost of a 1-kilometer taxi ride to average mobthly income",unit:"%",value:3,natural_value:.04},{category:"Transport",indicator:"Percentage of city's roads that are segregated and/or has specialized lane for cyclists",unit:"%",value:3,natural_value:.06},{category:"Transport",indicator:"Number of public electric vehicle (EV) charging points per 100,000 population",unit:"per 100,000",value:3,natural_value:1.4},{category:"Transport",indicator:"Public transport (excluding subway) operates by schedule ",unit:"Yes/No",value:5,natural_value:1},{category:"Transport",indicator:"Perception of transport index",unit:"index",value:2,natural_value:2.068296237483395},{category:"Inclusion",indicator:"Female-friendly city",unit:"1,2,3,4,5",value:4,natural_value:2},{category:"Inclusion",indicator:"Number of refugees per 1,000 population",unit:"per 1,000",value:4,natural_value:.154},{category:"Inclusion",indicator:"Homeless people per 1,000 population",unit:"per 1,000",value:3,natural_value:1.889719188959608},{category:"Inclusion",indicator:"Difference in number of years of schooling between woman and man, woman to man ratio ",unit:"years",value:1,natural_value:6.365},{category:"Inclusion",indicator:"Slavery index",unit:"index",value:4,natural_value:8},{category:"Inclusion",indicator:"Percentage of women aged 25-34 years old that have successfully completed secondary education",unit:"%",value:3,natural_value:.348},{category:"Inclusion",indicator:"Regulations for building construction and equipment, public transport for people with disabilities",unit:"Yes/No",value:1,natural_value:0},{category:"Inclusion",indicator:"Perception of inclusion index",unit:"index",value:1,natural_value:3.724379588475344},{category:"Accountability",indicator:"City budget execution publication",unit:"Yes/No",value:1,natural_value:0},{category:"Accountability",indicator:"City budget publication",unit:"Yes/No",value:1,natural_value:0},{category:"Accountability",indicator:"Financial transparency on city government companies",unit:"Yes/No",value:1,natural_value:0},{category:"Accountability",indicator:"ISO certification",unit:"Yes/No",value:1,natural_value:0},{category:"Accountability",indicator:"City council checks and balances",unit:"Yes/No",value:1,natural_value:0},{category:"Accountability",indicator:"Plans to obtain ISO certification",unit:"Yes/No",value:1,natural_value:0},{category:"Accountability",indicator:"Perception of accountability index",unit:"index",value:4,natural_value:.5427410395046992},{category:"City budget",indicator:"Poor financial condition",unit:"Yes/No",value:5,natural_value:0},{category:"City budget",indicator:"Central/higher level government financial intervention taking place",unit:"Yes/No",value:5,natural_value:0},{category:"City budget",indicator:"Long-term financial planning",unit:"Yes/No",value:1,natural_value:0},{category:"City budget",indicator:"Central/higher level government financial intervention is considered",unit:"Yes/No",value:1,natural_value:0},{category:"City budget",indicator:"Prudent fiscal policy requirements",unit:"Yes/No",value:1,natural_value:0},{category:"City budget",indicator:"Medium-term planning",unit:"Yes/No",value:1,natural_value:0},{category:"SME",indicator:"Number of SMEs per 100,000 population",unit:"per 100,000",value:3,natural_value:383.68866652411435},{category:"SME",indicator:"Number of start-ups",unit:"start-ups",value:2,natural_value:818.3333333333334},{category:"SME",indicator:"Global Startup Ecosystem Index",unit:"index",value:4,natural_value:11.982},{category:"SME",indicator:"Number of SMEs per capita/100 000 population (change in last 3 years)",unit:"%",value:5,natural_value:.595855801785293},{category:"SME",indicator:"Number of start-ups (change in last 3 years)",unit:"%",value:2,natural_value:.245817774855551},{category:"Public services",indicator:"Free phone to call the police, ambulance, firefighters",unit:"1,2,3,4,5",value:5,natural_value:1},{category:"Public services",indicator:"Services for working with citizens' appeals and complaint",unit:"Yes/No",value:5,natural_value:1},{category:"Public services",indicator:"E-gov services",unit:"Yes/No",value:5,natural_value:1},{category:"Public services",indicator:"Perception of public services index: Public Services",unit:"index",value:1,natural_value:4.805884365936772},{category:"Sustainability commitment",indicator:"City ESG reporting",unit:"Yes/No",value:1,natural_value:0},{category:"Sustainability commitment",indicator:"City ESG reporting verification",unit:"Yes/No",value:1,natural_value:0},{category:"Sustainability commitment",indicator:"ESG planning",unit:"Yes/No",value:1,natural_value:0},{category:"Sustainability commitment",indicator:"Plan with specific targets to develop and implement smart city principles",unit:"Yes/No",value:1,natural_value:0},{category:"Sustainability commitment",indicator:"Rollout and status of ESG / UN SDG training across the municipal/asset workforce",unit:"Yes/No",value:1,natural_value:0},{category:"Sustainability commitment",indicator:"City municipality involved in network or partnership promoting sustainable development (for example, C40 Cities network)",unit:"Yes/No",value:1,natural_value:0}]},{city:"Natal",data:[{category:"Air pollution",indicator:"CO2 emissions",unit:"kt",value:4,natural_value:1.9},{category:"Air pollution",indicator:"CO2 emissions (change in last 3 years)",unit:"%",value:5,natural_value:-1.2},{category:"Air pollution",indicator:"CO2 concentration",unit:"ppm",value:5,natural_value:412},{category:"Air pollution",indicator:"CO2 concentration (change in last 3 years)",unit:"%",value:3,natural_value:1.6},{category:"Air pollution",indicator:"Annual average of SO2 concentration in ambient air",unit:"microgram/m3",value:5,natural_value:.7},{category:"Air pollution",indicator:"Annual Average of SO2 Concentration in Ambient Air (change in last 3 years)",unit:"%",value:4,natural_value:-45.5},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air",unit:"microgram/m3",value:5,natural_value:1.2},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air (change in last 3 years), microgram/m3",unit:"%",value:4,natural_value:-2.4},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air, microgram/m3",unit:"microgram/m3",value:3,natural_value:55.1},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air (change in last 3 years), microgram/m3",unit:"%",value:1,natural_value:6.1},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air, microgram/m3",unit:"microgram/m3",value:5,natural_value:.1},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air (change in last 3 years), microgram/m3",unit:"%",value:3,natural_value:.4},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air, microgram/m3",unit:"microgram/m3",value:5,natural_value:14.8},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air (change in last 3 years), microgram/m3",unit:"%",value:1,natural_value:21.3},{category:"Air pollution",indicator:"Volatile organic compounds/reactive organic gases emissions",unit:"microgram/m3",value:4,natural_value:1.3},{category:"Air pollution",indicator:"Perception of air pollution index",unit:"index",value:5,natural_value:.45},{category:"Air pollution",indicator:"Paris Agreement",unit:"Yes/No",value:5,natural_value:1},{category:"Water pollution",indicator:"Annual average of dissolved oxygen (DO) concentration in water",unit:"%",value:3,natural_value:6.21},{category:"Water pollution",indicator:"Annual average of pH concentration in water",unit:"pH",value:2,natural_value:8.05},{category:"Water pollution",indicator:"Annual average dissolved solids in drinking-water",unit:"ppm",value:3,natural_value:139},{category:"Water pollution",indicator:"Water management strategy in a city",unit:"Yes/No",value:5,natural_value:1},{category:"Water pollution",indicator:"Perception of water pollution index",unit:"index",value:4,natural_value:1.3706361563678544},{category:"Land use and waste",indicator:"Share of devastated and degraded land area requiring reclamation",unit:"%",value:5,natural_value:1.4},{category:"Land use and waste",indicator:"3-year average growth rate of devastated and degraded land area requiring reclamation",unit:"%",value:3,natural_value:0},{category:"Land use and waste",indicator:"Waste deposits",unit:"%",value:5,natural_value:202e-6},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous)",unit:"kg per capita ",value:3,natural_value:165.8668566967861},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous), (change in last 3 years)",unit:"%",value:1,natural_value:28.45430686667},{category:"Land use and waste",indicator:"Total recycled construction waste",unit:"tons per capita",value:3,natural_value:.02021146977159802},{category:"Land use and waste",indicator:"Share of recycled construction and demolish waste in total generated construction and demolish waste",unit:"%",value:3,natural_value:.21},{category:"Land use and waste",indicator:"Total area of impervious surfaces and percentage to total city area",unit:"%",value:3,natural_value:.02},{category:"Land use and waste",indicator:"Productive urban land (in percent total land)",unit:"%",value:3,natural_value:32.2},{category:"Land use and waste",indicator:"Waste managenet strategy",unit:"Yes/No",value:1,natural_value:0},{category:"Land use and waste",indicator:"Perception of waste index",unit:"index",value:3,natural_value:1.514098740830482},{category:"Land use and waste",indicator:"Green spaces, % city area",unit:"%",value:4,natural_value:.4585},{category:"Land use and waste",indicator:"Green spaces, change in last 3 years",unit:"%",value:5,natural_value:6.3},{category:"Land use and waste",indicator:"NDVI",unit:"%",value:3,natural_value:.29},{category:"Natural disaster hazards",indicator:"Share of total area with altitude above sea level less than 0,5 meters",unit:"%",value:2,natural_value:.13},{category:"Natural disaster hazards",indicator:"Growth rate of freshwater mirror area",unit:"%",value:5,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of registered heavy rain, flood and thunderbolt (change in last 3 years)",unit:"%",value:3,natural_value:.0549016607508779},{category:"Natural disaster hazards",indicator:"Number of registered sand storm (change in last 3 years)",unit:"%",value:3,natural_value:.02704},{category:"Natural disaster hazards",indicator:"Environmental/natural disasters risk mitigation",unit:"Yes/No",value:5,natural_value:1},{category:"Natural disaster hazards",indicator:"Strategy/policy/government officials statement on environmental issues ",unit:"Yes/No",value:5,natural_value:1},{category:"Natural disaster hazards",indicator:"Total overall losses from natural disaster hazards",unit:"US$ mln ",value:3,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of days with average daily temperature above the threshold for 1990-2010",unit:"days",value:3,natural_value:15},{category:"Natural disaster hazards",indicator:"Number of disruptions to basic services, attributed to disasters",unit:"%",value:3,natural_value:0},{category:"Water availability",indicator:"Water consumption per capita",unit:"mcm",value:2,natural_value:3621e-8},{category:"Water availability",indicator:"Water tariff to disposable income ratio",unit:"ratio",value:4,natural_value:.8},{category:"Water availability",indicator:"Sanitary facilities tariff to disposable income ratio",unit:"ratio",value:2,natural_value:1.972},{category:"Water availability",indicator:"Water consumption per capita (change in last 3 years)",unit:"%",value:3,natural_value:-.0743369778509908},{category:"Water availability",indicator:"Percentage of population with access to drinking water",unit:"%",value:4,natural_value:.988666666666667},{category:"Water availability",indicator:"Percentage of population with access to drinking water (change in last 3 years)",unit:"%",value:3,natural_value:.001},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities",unit:"%",value:2,natural_value:.893},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities (change in last 3 years)",unit:"%",value:3,natural_value:.006},{category:"Food availability",indicator:"Cereal import dependency ratio (5-years average)",unit:"%",value:4,natural_value:-.239666666666667},{category:"Food availability",indicator:"Cereal import dependency ratio (change in last 3 years)",unit:"%",value:1,natural_value:.1737694332},{category:"Food availability",indicator:"Prevalence of undernourishment",unit:"%",value:3,natural_value:.056},{category:"Food availability",indicator:"Prevalence of undernourishment (change in last 3 years)",unit:"%",value:3,natural_value:.083},{category:"Food availability",indicator:"Prevalence of undernourishment children",unit:"%",value:3,natural_value:.357},{category:"Food availability",indicator:"Prevalence of undernourishment children (change in last 3 years)",unit:"%",value:3,natural_value:0},{category:"Food availability",indicator:"Prevalence of moderate or severe food insecurity in the population",unit:"%",value:3,natural_value:.284},{category:"Food availability",indicator:"Share of imports in food resources",unit:"%",value:3,natural_value:.36},{category:"Food availability",indicator:"Percentage of people with access to at least one food vendor/retailer within 15 minutes of walking",unit:"%",value:3,natural_value:91},{category:"Food availability",indicator:"Perception of food availability index",unit:"index",value:3,natural_value:2.0848544311905264},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity",unit:"%",value:3,natural_value:.996549443562825},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity (change in last 3 years)",unit:"%",value:1,natural_value:-.001},{category:"Energy availability",indicator:"Consumption of electricity per capita",unit:"kWh/person",value:3,natural_value:2554.644235196744},{category:"Energy availability",indicator:"Consumption of electricity per capita (change in last 3 years)",unit:"%",value:3,natural_value:.016},{category:"Energy availability",indicator:"Electricity tariff to disposable income ratio",unit:"ratio",value:3,natural_value:.159},{category:"Energy availability",indicator:"Share of renewable sources in electricity consumption",unit:"%",value:3,natural_value:.21},{category:"Energy availability",indicator:"Perception of energy availability index",unit:"index",value:2,natural_value:1.6479892845366555},{category:"Health",indicator:"Child mortality rate (under 5 years-old)",unit:"% of live births ",value:5,natural_value:1.83},{category:"Health",indicator:"City ambulance",unit:"Yes/No",value:5,natural_value:1},{category:"Health",indicator:"Life expectancy at birth, years",unit:"Years",value:3,natural_value:74.03233333333333},{category:"Health",indicator:"Life expectancy at birth goals",unit:"categories",value:3,natural_value:2},{category:"Health",indicator:"Number of hospital beds per 1,000 population",unit:"per 1,000",value:3,natural_value:2.1166666666666667},{category:"Health",indicator:"Number of doctors per 1,000 population",unit:"per 1,000",value:4,natural_value:1.26},{category:"Health",indicator:"Maternal mortality ratio",unit:"deaths per 1,000 live births",value:3,natural_value:49},{category:"Health",indicator:"Ambulance arrival speed, min",unit:"min",value:3,natural_value:70},{category:"Education",indicator:"Literacy rate among population (15-24 Years)",unit:"%",value:4,natural_value:.992531941731771},{category:"Education",indicator:"Literacy rate among population (15-24 Years) (change in last 3 years)",unit:"%",value:3,natural_value:.001},{category:"Education",indicator:"Primary education engagement",unit:"%",value:5,natural_value:.954859166666667},{category:"Education",indicator:"Pupils per teacher rate",unit:"ratio",value:3,natural_value:23.826666666666668},{category:"Education",indicator:"Proportion of population with post-secondary and higher education",unit:"%",value:4,natural_value:.377},{category:"Wealth",indicator:"Percentage of population with food expenditure is above 52% of total expenditure",unit:"%",value:3,natural_value:.173333333333333},{category:"Wealth",indicator:"Mean monthly salary",unit:"US dollars thousand",value:3,natural_value:1794.2433333333336},{category:"Wealth",indicator:"Mean monthly salary, change in last 3 years",unit:"%",value:3,natural_value:.00116669528203617},{category:"Wealth",indicator:"Disposable monthly income",unit:"US dollars thousand",value:2,natural_value:312.1303401590869},{category:"Wealth",indicator:"Disposable monthly income (change in last 3 years)",unit:"%",value:2,natural_value:-.0307054183800864},{category:"Wealth",indicator:"Debt to salary ratio",unit:"ratio",value:2,natural_value:19.4310686264357},{category:"Wealth",indicator:"Number of mobile phones per 1,000 population",unit:"per 1,000",value:1,natural_value:98.14033017333333},{category:"Wealth",indicator:"Decile income coefficient",unit:"ratio",value:3,natural_value:37.56018518518518},{category:"Wealth",indicator:"Decile income coefficient (change in last 3 years)",unit:"%",value:3,natural_value:-.0375928051939775},{category:"Wealth",indicator:"Poverty headcount ratio at national poverty lines",unit:"%",value:3,natural_value:.15},{category:"Wealth",indicator:"Working poverty rate (percentage of employed living below US$1.90 PPP), 15+ age (%) ",unit:"%",value:3,natural_value:.0233333333333333},{category:"Wealth",indicator:"Poverty headcount ratio at $2.15 PPP 2017 a day",unit:"%",value:3,natural_value:.027},{category:"Wealth",indicator:"Living spaces per capita, sq m (change in last 3 years)",unit:"%",value:3,natural_value:.026192},{category:"Wealth",indicator:"Population living in slums (% of urban population)",unit:"%",value:3,natural_value:.17},{category:"Wealth",indicator:"Availability of finance (consumer loans)",unit:"%",value:3,natural_value:.5},{category:"Wealth",indicator:"Perception of wealth & poverty index",unit:"index",value:2,natural_value:2.099160121450789},{category:"Safety",indicator:"Road fatalities rate per 100,000 population",unit:"per 100,000",value:2,natural_value:19.073333333333334},{category:"Safety",indicator:"Road fatalities rate per 100,000 population (change in last 3 years)",unit:"%",value:2,natural_value:-.118},{category:"Safety",indicator:"Violent crime rate per 100,000 population",unit:"per 100,000",value:2,natural_value:31.899999999999995},{category:"Safety",indicator:"Violent crime rate per 100,000 population (change in last 3 years)",unit:"%",value:3,natural_value:-.00952438823708124},{category:"Safety",indicator:"Crime rate per 100,000 population",unit:"per 100,000",value:3,natural_value:67.49},{category:"Safety",indicator:"Crime rate per 100,000 population  (change in last 3 years)",unit:"%",value:4,natural_value:-.00952438823708124},{category:"Safety",indicator:"Police arrival speed",unit:"min",value:3,natural_value:22.5},{category:"Safety",indicator:"Perception of safety index",unit:"index",value:4,natural_value:2.54},{category:"Livability",indicator:"Number of LEED certified green buildings",unit:"Certified square meters per capita",value:3,natural_value:.09697838620283454},{category:"Livability",indicator:"Number of BREEAM certified projects",unit:"Certified square meters per capita",value:1,natural_value:0},{category:"Livability",indicator:"Whether or not the city has ISO 37120 certification",unit:"Yes/No",value:1,natural_value:0},{category:"Livability",indicator:"Mobile connection coverage",unit:"%",value:5,natural_value:1},{category:"Livability",indicator:"Internet coverage",unit:"%",value:2,natural_value:.922533333333333},{category:"Livability",indicator:"Perception of livability index",unit:"index",value:4,natural_value:.8072949066928007},{category:"Livability",indicator:"Share of population in 1 km from schools",unit:"%",value:4,natural_value:95.6},{category:"Livability",indicator:"Share of population in 1 km from parks",unit:"%",value:4,natural_value:83.6},{category:"Transport",indicator:"Time loss in traffic",unit:"%",value:2,natural_value:34.4},{category:"Transport",indicator:"Share of the population in 1 km from public transport stop",unit:"%",value:3,natural_value:77.3},{category:"Transport",indicator:"Ratio of the cost of monthly public transport usage Ithe cheapest option) to average mobthly income",unit:"ratio",value:3,natural_value:.04},{category:"Transport",indicator:"Ratio of the cost of a 1-kilometer taxi ride to average mobthly income",unit:"%",value:3,natural_value:.04},{category:"Transport",indicator:"Percentage of city's roads that are segregated and/or has specialized lane for cyclists",unit:"%",value:3,natural_value:.06},{category:"Transport",indicator:"Number of public electric vehicle (EV) charging points per 100,000 population",unit:"per 100,000",value:3,natural_value:1.4},{category:"Transport",indicator:"Public transport (excluding subway) operates by schedule ",unit:"Yes/No",value:5,natural_value:1},{category:"Transport",indicator:"Perception of transport index",unit:"index",value:4,natural_value:.8072949066928007},{category:"Inclusion",indicator:"Female-friendly city",unit:"1,2,3,4,5",value:4,natural_value:2},{category:"Inclusion",indicator:"Number of refugees per 1,000 population",unit:"per 1,000",value:4,natural_value:.24},{category:"Inclusion",indicator:"Homeless people per 1,000 population",unit:"per 1,000",value:4,natural_value:1.242280047916944},{category:"Inclusion",indicator:"Difference in number of years of schooling between woman and man, woman to man ratio ",unit:"years",value:3,natural_value:1.05},{category:"Inclusion",indicator:"Slavery index",unit:"index",value:4,natural_value:5},{category:"Inclusion",indicator:"Percentage of women aged 25-34 years old that have successfully completed secondary education",unit:"%",value:4,natural_value:.514},{category:"Inclusion",indicator:"Regulations for building construction and equipment, public transport for people with disabilities",unit:"Yes/No",value:5,natural_value:1},{category:"Inclusion",indicator:"Perception of inclusion index",unit:"index",value:4,natural_value:1.6419624913097781},{category:"Accountability",indicator:"City budget execution publication",unit:"Yes/No",value:5,natural_value:1},{category:"Accountability",indicator:"City budget publication",unit:"Yes/No",value:5,natural_value:1},{category:"Accountability",indicator:"Financial transparency on city government companies",unit:"Yes/No",value:1,natural_value:0},{category:"Accountability",indicator:"ISO certification",unit:"Yes/No",value:1,natural_value:0},{category:"Accountability",indicator:"City council checks and balances",unit:"Yes/No",value:1,natural_value:0},{category:"Accountability",indicator:"Plans to obtain ISO certification",unit:"Yes/No",value:1,natural_value:0},{category:"Accountability",indicator:"Perception of accountability index",unit:"index",value:2,natural_value:1.0203402004058097},{category:"City budget",indicator:"Poor financial condition",unit:"Yes/No",value:5,natural_value:0},{category:"City budget",indicator:"Central/higher level government financial intervention taking place",unit:"Yes/No",value:5,natural_value:0},{category:"City budget",indicator:"Long-term financial planning",unit:"Yes/No",value:1,natural_value:0},{category:"City budget",indicator:"Central/higher level government financial intervention is considered",unit:"Yes/No",value:1,natural_value:0},{category:"City budget",indicator:"Prudent fiscal policy requirements",unit:"Yes/No",value:1,natural_value:0},{category:"City budget",indicator:"Medium-term planning",unit:"Yes/No",value:5,natural_value:1},{category:"SME",indicator:"Number of SMEs per 100,000 population",unit:"per 100,000",value:1,natural_value:5341.05},{category:"SME",indicator:"Number of start-ups",unit:"start-ups",value:2,natural_value:3},{category:"SME",indicator:"Global Startup Ecosystem Index",unit:"index",value:1,natural_value:.143},{category:"SME",indicator:"Number of SMEs per capita/100 000 population (change in last 3 years)",unit:"%",value:3,natural_value:0},{category:"SME",indicator:"Number of start-ups (change in last 3 years)",unit:"%",value:5,natural_value:0},{category:"Public services",indicator:"Free phone to call the police, ambulance, firefighters",unit:"1,2,3,4,5",value:5,natural_value:1},{category:"Public services",indicator:"Services for working with citizens' appeals and complaint",unit:"Yes/No",value:5,natural_value:1},{category:"Public services",indicator:"E-gov services",unit:"Yes/No",value:5,natural_value:1},{category:"Public services",indicator:"Perception of public services index: Public Services",unit:"index",value:4,natural_value:1.398629594433814},{category:"Sustainability commitment",indicator:"City ESG reporting",unit:"Yes/No",value:1,natural_value:0},{category:"Sustainability commitment",indicator:"City ESG reporting verification",unit:"Yes/No",value:1,natural_value:0},{category:"Sustainability commitment",indicator:"ESG planning",unit:"Yes/No",value:1,natural_value:0},{category:"Sustainability commitment",indicator:"Plan with specific targets to develop and implement smart city principles",unit:"Yes/No",value:5,natural_value:1},{category:"Sustainability commitment",indicator:"Rollout and status of ESG / UN SDG training across the municipal/asset workforce",unit:"Yes/No",value:1,natural_value:0},{category:"Sustainability commitment",indicator:"City municipality involved in network or partnership promoting sustainable development (for example, C40 Cities network)",unit:"Yes/No",value:5,natural_value:1}]},{city:"Brazzaville",data:[{category:"Air pollution",indicator:"CO2 emissions",unit:"kt",value:4,natural_value:1.25},{category:"Air pollution",indicator:"CO2 emissions (change in last 3 years)",unit:"%",value:3,natural_value:1.2},{category:"Air pollution",indicator:"CO2 concentration",unit:"ppm",value:2,natural_value:453.6},{category:"Air pollution",indicator:"CO2 concentration (change in last 3 years)",unit:"%",value:3,natural_value:.2},{category:"Air pollution",indicator:"Annual average of SO2 concentration in ambient air",unit:"microgram/m3",value:4,natural_value:3.3},{category:"Air pollution",indicator:"Annual Average of SO2 Concentration in Ambient Air (change in last 3 years)",unit:"%",value:3,natural_value:23.5},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air",unit:"microgram/m3",value:4,natural_value:7.5},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air (change in last 3 years), microgram/m3",unit:"%",value:4,natural_value:-1.9},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air, microgram/m3",unit:"microgram/m3",value:4,natural_value:42.7},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air (change in last 3 years), microgram/m3",unit:"%",value:5,natural_value:-4.3},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air, microgram/m3",unit:"microgram/m3",value:2,natural_value:.7},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air (change in last 3 years), microgram/m3",unit:"%",value:4,natural_value:-1.8},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air, microgram/m3",unit:"microgram/m3",value:3,natural_value:85.2},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air (change in last 3 years), microgram/m3",unit:"%",value:3,natural_value:5},{category:"Air pollution",indicator:"Volatile organic compounds/reactive organic gases emissions",unit:"microgram/m3",value:3,natural_value:1.7},{category:"Air pollution",indicator:"Perception of air pollution index",unit:"index",value:5,natural_value:.73},{category:"Air pollution",indicator:"Paris Agreement",unit:"Yes/No",value:5,natural_value:1},{category:"Water pollution",indicator:"Annual average of dissolved oxygen (DO) concentration in water",unit:"%",value:5,natural_value:4.45},{category:"Water pollution",indicator:"Annual average of pH concentration in water",unit:"pH",value:5,natural_value:4.06},{category:"Water pollution",indicator:"Annual average dissolved solids in drinking-water",unit:"ppm",value:3,natural_value:139},{category:"Water pollution",indicator:"Water management strategy in a city",unit:"Yes/No",value:1,natural_value:0},{category:"Water pollution",indicator:"Perception of water pollution index",unit:"index",value:5,natural_value:.45536897331942433},{category:"Land use and waste",indicator:"Share of devastated and degraded land area requiring reclamation",unit:"%",value:5,natural_value:1.8},{category:"Land use and waste",indicator:"3-year average growth rate of devastated and degraded land area requiring reclamation",unit:"%",value:2,natural_value:.091},{category:"Land use and waste",indicator:"Waste deposits",unit:"%",value:5,natural_value:17e-5},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous)",unit:"kg per capita ",value:3,natural_value:184.6411523451221},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous), (change in last 3 years)",unit:"%",value:4,natural_value:1.08639431138},{category:"Land use and waste",indicator:"Total recycled construction waste",unit:"tons per capita",value:3,natural_value:.0202},{category:"Land use and waste",indicator:"Share of recycled construction and demolish waste in total generated construction and demolish waste",unit:"%",value:3,natural_value:.293},{category:"Land use and waste",indicator:"Total area of impervious surfaces and percentage to total city area",unit:"%",value:3,natural_value:.02},{category:"Land use and waste",indicator:"Productive urban land (in percent total land)",unit:"%",value:3,natural_value:32.2},{category:"Land use and waste",indicator:"Waste managenet strategy",unit:"Yes/No",value:1,natural_value:0},{category:"Land use and waste",indicator:"Perception of waste index",unit:"index",value:4,natural_value:1.810424467560072},{category:"Land use and waste",indicator:"Green spaces, % city area",unit:"%",value:2,natural_value:.0811},{category:"Land use and waste",indicator:"Green spaces, change in last 3 years",unit:"%",value:1,natural_value:-5.5},{category:"Land use and waste",indicator:"NDVI",unit:"%",value:4,natural_value:.15},{category:"Natural disaster hazards",indicator:"Share of total area with altitude above sea level less than 0,5 meters",unit:"%",value:5,natural_value:0},{category:"Natural disaster hazards",indicator:"Growth rate of freshwater mirror area",unit:"%",value:1,natural_value:-.3},{category:"Natural disaster hazards",indicator:"Number of registered heavy rain, flood and thunderbolt (change in last 3 years)",unit:"%",value:3,natural_value:-.0319126617675967},{category:"Natural disaster hazards",indicator:"Number of registered sand storm (change in last 3 years)",unit:"%",value:3,natural_value:-.0395901759852154},{category:"Natural disaster hazards",indicator:"Environmental/natural disasters risk mitigation",unit:"Yes/No",value:5,natural_value:1},{category:"Natural disaster hazards",indicator:"Strategy/policy/government officials statement on environmental issues ",unit:"Yes/No",value:5,natural_value:1},{category:"Natural disaster hazards",indicator:"Total overall losses from natural disaster hazards",unit:"US$ mln ",value:3,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of days with average daily temperature above the threshold for 1990-2010",unit:"days",value:3,natural_value:15},{category:"Natural disaster hazards",indicator:"Number of disruptions to basic services, attributed to disasters",unit:"%",value:3,natural_value:0},{category:"Water availability",indicator:"Water consumption per capita",unit:"mcm",value:2,natural_value:11437737370684483e-21},{category:"Water availability",indicator:"Water tariff to disposable income ratio",unit:"ratio",value:4,natural_value:.6},{category:"Water availability",indicator:"Sanitary facilities tariff to disposable income ratio",unit:"ratio",value:4,natural_value:.4},{category:"Water availability",indicator:"Water consumption per capita (change in last 3 years)",unit:"%",value:3,natural_value:-.015502986483292},{category:"Water availability",indicator:"Percentage of population with access to drinking water",unit:"%",value:2,natural_value:.736},{category:"Water availability",indicator:"Percentage of population with access to drinking water (change in last 3 years)",unit:"%",value:3,natural_value:.002},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities",unit:"%",value:3,natural_value:.204},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities (change in last 3 years)",unit:"%",value:2,natural_value:.003},{category:"Food availability",indicator:"Cereal import dependency ratio (5-years average)",unit:"%",value:2,natural_value:.939},{category:"Food availability",indicator:"Cereal import dependency ratio (change in last 3 years)",unit:"%",value:3,natural_value:.01425708551},{category:"Food availability",indicator:"Prevalence of undernourishment",unit:"%",value:3,natural_value:.056},{category:"Food availability",indicator:"Prevalence of undernourishment (change in last 3 years)",unit:"%",value:3,natural_value:.023},{category:"Food availability",indicator:"Prevalence of undernourishment children",unit:"%",value:3,natural_value:.357},{category:"Food availability",indicator:"Prevalence of undernourishment children (change in last 3 years)",unit:"%",value:3,natural_value:-.025},{category:"Food availability",indicator:"Prevalence of moderate or severe food insecurity in the population",unit:"%",value:1,natural_value:.884},{category:"Food availability",indicator:"Share of imports in food resources",unit:"%",value:3,natural_value:.36},{category:"Food availability",indicator:"Percentage of people with access to at least one food vendor/retailer within 15 minutes of walking",unit:"%",value:3,natural_value:91},{category:"Food availability",indicator:"Perception of food availability index",unit:"index",value:2,natural_value:1.7694823312081864},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity",unit:"%",value:2,natural_value:.486883850097656},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity (change in last 3 years)",unit:"%",value:3,natural_value:.013},{category:"Energy availability",indicator:"Consumption of electricity per capita",unit:"kWh/person",value:5,natural_value:233.8543925649949},{category:"Energy availability",indicator:"Consumption of electricity per capita (change in last 3 years)",unit:"%",value:1,natural_value:.212},{category:"Energy availability",indicator:"Electricity tariff to disposable income ratio",unit:"ratio",value:3,natural_value:.15757312},{category:"Energy availability",indicator:"Share of renewable sources in electricity consumption",unit:"%",value:3,natural_value:.21},{category:"Energy availability",indicator:"Perception of energy availability index",unit:"index",value:2,natural_value:1.4623815285284214},{category:"Health",indicator:"Child mortality rate (under 5 years-old)",unit:"% of live births ",value:5,natural_value:3.13},{category:"Health",indicator:"City ambulance",unit:"Yes/No",value:5,natural_value:1},{category:"Health",indicator:"Life expectancy at birth, years",unit:"Years",value:4,natural_value:63.35033333333333},{category:"Health",indicator:"Life expectancy at birth goals",unit:"categories",value:1,natural_value:1},{category:"Health",indicator:"Number of hospital beds per 1,000 population",unit:"per 1,000",value:4,natural_value:.8409929205874421},{category:"Health",indicator:"Number of doctors per 1,000 population",unit:"per 1,000",value:4,natural_value:.18714517624971974},{category:"Health",indicator:"Maternal mortality ratio",unit:"deaths per 1,000 live births",value:3,natural_value:49},{category:"Health",indicator:"Ambulance arrival speed, min",unit:"min",value:3,natural_value:70},{category:"Education",indicator:"Literacy rate among population (15-24 Years)",unit:"%",value:2,natural_value:.817762451171875},{category:"Education",indicator:"Literacy rate among population (15-24 Years) (change in last 3 years)",unit:"%",value:3,natural_value:.006},{category:"Education",indicator:"Primary education engagement",unit:"%",value:3,natural_value:.8437051},{category:"Education",indicator:"Pupils per teacher rate",unit:"ratio",value:1,natural_value:42.71358024691358},{category:"Education",indicator:"Proportion of population with post-secondary and higher education",unit:"%",value:4,natural_value:.377},{category:"Wealth",indicator:"Percentage of population with food expenditure is above 52% of total expenditure",unit:"%",value:3,natural_value:.156666666666667},{category:"Wealth",indicator:"Mean monthly salary",unit:"US dollars thousand",value:3,natural_value:1282.4291856666666},{category:"Wealth",indicator:"Mean monthly salary, change in last 3 years",unit:"%",value:3,natural_value:-.0266873352529554},{category:"Wealth",indicator:"Disposable monthly income",unit:"US dollars thousand",value:2,natural_value:302.3992620874996},{category:"Wealth",indicator:"Disposable monthly income (change in last 3 years)",unit:"%",value:4,natural_value:.0871101353185355},{category:"Wealth",indicator:"Debt to salary ratio",unit:"ratio",value:3,natural_value:8.072656977014631},{category:"Wealth",indicator:"Number of mobile phones per 1,000 population",unit:"per 1,000",value:1,natural_value:95.70893438666667},{category:"Wealth",indicator:"Decile income coefficient",unit:"ratio",value:4,natural_value:21.068749999999998},{category:"Wealth",indicator:"Decile income coefficient (change in last 3 years)",unit:"%",value:1,natural_value:.133082229475596},{category:"Wealth",indicator:"Poverty headcount ratio at national poverty lines",unit:"%",value:5,natural_value:19.3333333333333},{category:"Wealth",indicator:"Working poverty rate (percentage of employed living below US$1.90 PPP), 15+ age (%) ",unit:"%",value:4,natural_value:.011},{category:"Wealth",indicator:"Poverty headcount ratio at $2.15 PPP 2017 a day",unit:"%",value:4,natural_value:.0186666666666667},{category:"Wealth",indicator:"Living spaces per capita, sq m (change in last 3 years)",unit:"%",value:1,natural_value:0},{category:"Wealth",indicator:"Population living in slums (% of urban population)",unit:"%",value:3,natural_value:.17},{category:"Wealth",indicator:"Availability of finance (consumer loans)",unit:"%",value:3,natural_value:.5},{category:"Wealth",indicator:"Perception of wealth & poverty index",unit:"index",value:4,natural_value:.7426272126444186},{category:"Safety",indicator:"Road fatalities rate per 100,000 population",unit:"per 100,000",value:3,natural_value:29.166666666666668},{category:"Safety",indicator:"Road fatalities rate per 100,000 population (change in last 3 years)",unit:"%",value:3,natural_value:.013},{category:"Safety",indicator:"Violent crime rate per 100,000 population",unit:"per 100,000",value:2,natural_value:34.750798202781176},{category:"Safety",indicator:"Violent crime rate per 100,000 population (change in last 3 years)",unit:"%",value:3,natural_value:-.00195060506205014},{category:"Safety",indicator:"Crime rate per 100,000 population",unit:"per 100,000",value:3,natural_value:511.29593711362435},{category:"Safety",indicator:"Crime rate per 100,000 population  (change in last 3 years)",unit:"%",value:4,natural_value:-.00195060506205014},{category:"Safety",indicator:"Police arrival speed",unit:"min",value:2,natural_value:31},{category:"Safety",indicator:"Perception of safety index",unit:"index",value:5,natural_value:1.7149999999999999},{category:"Livability",indicator:"Number of LEED certified green buildings",unit:"Certified square meters per capita",value:2,natural_value:.001253900252388248},{category:"Livability",indicator:"Number of BREEAM certified projects",unit:"Certified square meters per capita",value:1,natural_value:0},{category:"Livability",indicator:"Whether or not the city has ISO 37120 certification",unit:"Yes/No",value:1,natural_value:0},{category:"Livability",indicator:"Mobile connection coverage",unit:"%",value:1,natural_value:.548333333333333},{category:"Livability",indicator:"Internet coverage",unit:"%",value:1,natural_value:.548333333333333},{category:"Livability",indicator:"Perception of livability index",unit:"index",value:4,natural_value:.9380400918704376},{category:"Livability",indicator:"Share of population in 1 km from schools",unit:"%",value:4,natural_value:98.6},{category:"Livability",indicator:"Share of population in 1 km from parks",unit:"%",value:1,natural_value:32.8},{category:"Transport",indicator:"Time loss in traffic",unit:"%",value:1,natural_value:15.7},{category:"Transport",indicator:"Share of the population in 1 km from public transport stop",unit:"%",value:2,natural_value:52.5},{category:"Transport",indicator:"Ratio of the cost of monthly public transport usage Ithe cheapest option) to average mobthly income",unit:"ratio",value:3,natural_value:.04},{category:"Transport",indicator:"Ratio of the cost of a 1-kilometer taxi ride to average mobthly income",unit:"%",value:3,natural_value:.04},{category:"Transport",indicator:"Percentage of city's roads that are segregated and/or has specialized lane for cyclists",unit:"%",value:3,natural_value:.06},{category:"Transport",indicator:"Number of public electric vehicle (EV) charging points per 100,000 population",unit:"per 100,000",value:3,natural_value:1.4},{category:"Transport",indicator:"Public transport (excluding subway) operates by schedule ",unit:"Yes/No",value:5,natural_value:1},{category:"Transport",indicator:"Perception of transport index",unit:"index",value:4,natural_value:.9380400918704376},{category:"Inclusion",indicator:"Female-friendly city",unit:"1,2,3,4,5",value:4,natural_value:2},{category:"Inclusion",indicator:"Number of refugees per 1,000 population",unit:"per 1,000",value:3,natural_value:9.399},{category:"Inclusion",indicator:"Homeless people per 1,000 population",unit:"per 1,000",value:1,natural_value:73.28310431478172},{category:"Inclusion",indicator:"Difference in number of years of schooling between woman and man, woman to man ratio ",unit:"years",value:3,natural_value:1.05},{category:"Inclusion",indicator:"Slavery index",unit:"index",value:4,natural_value:8},{category:"Inclusion",indicator:"Percentage of women aged 25-34 years old that have successfully completed secondary education",unit:"%",value:4,natural_value:.542},{category:"Inclusion",indicator:"Regulations for building construction and equipment, public transport for people with disabilities",unit:"Yes/No",value:1,natural_value:0},{category:"Inclusion",indicator:"Perception of inclusion index",unit:"index",value:5,natural_value:.8545100144780505},{category:"Accountability",indicator:"City budget execution publication",unit:"Yes/No",value:1,natural_value:0},{category:"Accountability",indicator:"City budget publication",unit:"Yes/No",value:1,natural_value:0},{category:"Accountability",indicator:"Financial transparency on city government companies",unit:"Yes/No",value:1,natural_value:0},{category:"Accountability",indicator:"ISO certification",unit:"Yes/No",value:1,natural_value:0},{category:"Accountability",indicator:"City council checks and balances",unit:"Yes/No",value:1,natural_value:0},{category:"Accountability",indicator:"Plans to obtain ISO certification",unit:"Yes/No",value:1,natural_value:0},{category:"Accountability",indicator:"Perception of accountability index",unit:"index",value:5,natural_value:.3307362014059618},{category:"City budget",indicator:"Poor financial condition",unit:"Yes/No",value:1,natural_value:1},{category:"City budget",indicator:"Central/higher level government financial intervention taking place",unit:"Yes/No",value:5,natural_value:0},{category:"City budget",indicator:"Long-term financial planning",unit:"Yes/No",value:1,natural_value:0},{category:"City budget",indicator:"Central/higher level government financial intervention is considered",unit:"Yes/No",value:1,natural_value:0},{category:"City budget",indicator:"Prudent fiscal policy requirements",unit:"Yes/No",value:1,natural_value:0},{category:"City budget",indicator:"Medium-term planning",unit:"Yes/No",value:5,natural_value:1},{category:"SME",indicator:"Number of SMEs per 100,000 population",unit:"per 100,000",value:3,natural_value:44.353002254907814},{category:"SME",indicator:"Number of start-ups",unit:"start-ups",value:5,natural_value:2},{category:"SME",indicator:"Global Startup Ecosystem Index",unit:"index",value:1,natural_value:0},{category:"SME",indicator:"Number of SMEs per capita/100 000 population (change in last 3 years)",unit:"%",value:3,natural_value:0},{category:"SME",indicator:"Number of start-ups (change in last 3 years)",unit:"%",value:5,natural_value:0},{category:"Public services",indicator:"Free phone to call the police, ambulance, firefighters",unit:"1,2,3,4,5",value:5,natural_value:1},{category:"Public services",indicator:"Services for working with citizens' appeals and complaint",unit:"Yes/No",value:5,natural_value:1},{category:"Public services",indicator:"E-gov services",unit:"Yes/No",value:5,natural_value:1},{category:"Public services",indicator:"Perception of public services index: Public Services",unit:"index",value:5,natural_value:.6852289874246976},{category:"Sustainability commitment",indicator:"City ESG reporting",unit:"Yes/No",value:1,natural_value:0},{category:"Sustainability commitment",indicator:"City ESG reporting verification",unit:"Yes/No",value:1,natural_value:0},{category:"Sustainability commitment",indicator:"ESG planning",unit:"Yes/No",value:1,natural_value:0},{category:"Sustainability commitment",indicator:"Plan with specific targets to develop and implement smart city principles",unit:"Yes/No",value:1,natural_value:0},{category:"Sustainability commitment",indicator:"Rollout and status of ESG / UN SDG training across the municipal/asset workforce",unit:"Yes/No",value:1,natural_value:0},{category:"Sustainability commitment",indicator:"City municipality involved in network or partnership promoting sustainable development (for example, C40 Cities network)",unit:"Yes/No",value:1,natural_value:0}]},{city:"Almaty",data:[{category:"Air pollution",indicator:"CO2 emissions",unit:"kt",value:2,natural_value:11.3},{category:"Air pollution",indicator:"CO2 emissions (change in last 3 years)",unit:"%",value:3,natural_value:.6},{category:"Air pollution",indicator:"CO2 concentration",unit:"ppm",value:3,natural_value:433.9},{category:"Air pollution",indicator:"CO2 concentration (change in last 3 years)",unit:"%",value:3,natural_value:2.1},{category:"Air pollution",indicator:"Annual average of SO2 concentration in ambient air",unit:"microgram/m3",value:4,natural_value:7.2},{category:"Air pollution",indicator:"Annual Average of SO2 Concentration in Ambient Air (change in last 3 years)",unit:"%",value:4,natural_value:-28.2},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air",unit:"microgram/m3",value:5,natural_value:9.2},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air (change in last 3 years), microgram/m3",unit:"%",value:4,natural_value:-1.3},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air, microgram/m3",unit:"microgram/m3",value:2,natural_value:76.6},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air (change in last 3 years), microgram/m3",unit:"%",value:5,natural_value:-5.5},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air, microgram/m3",unit:"microgram/m3",value:4,natural_value:.2},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air (change in last 3 years), microgram/m3",unit:"%",value:4,natural_value:-4.9},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air, microgram/m3",unit:"microgram/m3",value:5,natural_value:18.6},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air (change in last 3 years), microgram/m3",unit:"%",value:5,natural_value:-11.3},{category:"Air pollution",indicator:"Volatile organic compounds/reactive organic gases emissions",unit:"microgram/m3",value:4,natural_value:1.2},{category:"Air pollution",indicator:"Perception of air pollution index",unit:"index",value:3,natural_value:1.77},{category:"Air pollution",indicator:"Paris Agreement",unit:"Yes/No",value:5,natural_value:1},{category:"Water pollution",indicator:"Annual average of dissolved oxygen (DO) concentration in water",unit:"%",value:3,natural_value:6.32},{category:"Water pollution",indicator:"Annual average of pH concentration in water",unit:"pH",value:2,natural_value:7.933333333333334},{category:"Water pollution",indicator:"Annual average dissolved solids in drinking-water",unit:"ppm",value:3,natural_value:139},{category:"Water pollution",indicator:"Water management strategy in a city",unit:"Yes/No",value:5,natural_value:1},{category:"Water pollution",indicator:"Perception of water pollution index",unit:"index",value:2,natural_value:2.4280063619803385},{category:"Land use and waste",indicator:"Share of devastated and degraded land area requiring reclamation",unit:"%",value:5,natural_value:1.7},{category:"Land use and waste",indicator:"3-year average growth rate of devastated and degraded land area requiring reclamation",unit:"%",value:4,natural_value:-.05},{category:"Land use and waste",indicator:"Waste deposits",unit:"%",value:5,natural_value:21e-5},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous)",unit:"kg per capita ",value:3,natural_value:218.70589992818873},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous), (change in last 3 years)",unit:"%",value:4,natural_value:2.06527603657},{category:"Land use and waste",indicator:"Total recycled construction waste",unit:"tons per capita",value:3,natural_value:.0202},{category:"Land use and waste",indicator:"Share of recycled construction and demolish waste in total generated construction and demolish waste",unit:"%",value:2,natural_value:.018},{category:"Land use and waste",indicator:"Total area of impervious surfaces and percentage to total city area",unit:"%",value:3,natural_value:.02},{category:"Land use and waste",indicator:"Productive urban land (in percent total land)",unit:"%",value:3,natural_value:32.2},{category:"Land use and waste",indicator:"Waste managenet strategy",unit:"Yes/No",value:1,natural_value:0},{category:"Land use and waste",indicator:"Perception of waste index",unit:"index",value:4,natural_value:3.672950776137062},{category:"Land use and waste",indicator:"Green spaces, % city area",unit:"%",value:3,natural_value:.2334},{category:"Land use and waste",indicator:"Green spaces, change in last 3 years",unit:"%",value:4,natural_value:1.8},{category:"Land use and waste",indicator:"NDVI",unit:"%",value:4,natural_value:.18},{category:"Natural disaster hazards",indicator:"Share of total area with altitude above sea level less than 0,5 meters",unit:"%",value:5,natural_value:0},{category:"Natural disaster hazards",indicator:"Growth rate of freshwater mirror area",unit:"%",value:5,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of registered heavy rain, flood and thunderbolt (change in last 3 years)",unit:"%",value:2,natural_value:.0971033487259057},{category:"Natural disaster hazards",indicator:"Number of registered sand storm (change in last 3 years)",unit:"%",value:2,natural_value:.310370697104448},{category:"Natural disaster hazards",indicator:"Environmental/natural disasters risk mitigation",unit:"Yes/No",value:5,natural_value:1},{category:"Natural disaster hazards",indicator:"Strategy/policy/government officials statement on environmental issues ",unit:"Yes/No",value:5,natural_value:1},{category:"Natural disaster hazards",indicator:"Total overall losses from natural disaster hazards",unit:"US$ mln ",value:3,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of days with average daily temperature above the threshold for 1990-2010",unit:"days",value:3,natural_value:15},{category:"Natural disaster hazards",indicator:"Number of disruptions to basic services, attributed to disasters",unit:"%",value:3,natural_value:0},{category:"Water availability",indicator:"Water consumption per capita",unit:"mcm",value:4,natural_value:3.483},{category:"Water availability",indicator:"Water tariff to disposable income ratio",unit:"ratio",value:3,natural_value:1.2},{category:"Water availability",indicator:"Sanitary facilities tariff to disposable income ratio",unit:"ratio",value:5,natural_value:.056},{category:"Water availability",indicator:"Water consumption per capita (change in last 3 years)",unit:"%",value:3,natural_value:-.005},{category:"Water availability",indicator:"Percentage of population with access to drinking water",unit:"%",value:3,natural_value:.976},{category:"Water availability",indicator:"Percentage of population with access to drinking water (change in last 3 years)",unit:"%",value:3,natural_value:.003},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities",unit:"%",value:3,natural_value:.722},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities (change in last 3 years)",unit:"%",value:3,natural_value:.024},{category:"Food availability",indicator:"Cereal import dependency ratio (5-years average)",unit:"%",value:5,natural_value:-.823333333333333},{category:"Food availability",indicator:"Cereal import dependency ratio (change in last 3 years)",unit:"%",value:3,natural_value:.0689057773},{category:"Food availability",indicator:"Prevalence of undernourishment",unit:"%",value:3,natural_value:.056},{category:"Food availability",indicator:"Prevalence of undernourishment (change in last 3 years)",unit:"%",value:1,natural_value:.223},{category:"Food availability",indicator:"Prevalence of undernourishment children",unit:"%",value:3,natural_value:.357},{category:"Food availability",indicator:"Prevalence of undernourishment children (change in last 3 years)",unit:"%",value:2,natural_value:-.055},{category:"Food availability",indicator:"Prevalence of moderate or severe food insecurity in the population",unit:"%",value:5,natural_value:.052},{category:"Food availability",indicator:"Share of imports in food resources",unit:"%",value:3,natural_value:.36},{category:"Food availability",indicator:"Percentage of people with access to at least one food vendor/retailer within 15 minutes of walking",unit:"%",value:3,natural_value:91},{category:"Food availability",indicator:"Perception of food availability index",unit:"index",value:4,natural_value:2.7911336002553444},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity",unit:"%",value:5,natural_value:1},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity (change in last 3 years)",unit:"%",value:3,natural_value:0},{category:"Energy availability",indicator:"Consumption of electricity per capita",unit:"kWh/person",value:4,natural_value:744.0523414104803},{category:"Energy availability",indicator:"Consumption of electricity per capita (change in last 3 years)",unit:"%",value:4,natural_value:0},{category:"Energy availability",indicator:"Electricity tariff to disposable income ratio",unit:"ratio",value:4,natural_value:.046000000000000006},{category:"Energy availability",indicator:"Share of renewable sources in electricity consumption",unit:"%",value:3,natural_value:.21},{category:"Energy availability",indicator:"Perception of energy availability index",unit:"index",value:1,natural_value:2.215077404374128},{category:"Health",indicator:"Child mortality rate (under 5 years-old)",unit:"% of live births ",value:5,natural_value:.949666666666667},{category:"Health",indicator:"City ambulance",unit:"Yes/No",value:5,natural_value:1},{category:"Health",indicator:"Life expectancy at birth, years",unit:"Years",value:3,natural_value:74.43666666666667},{category:"Health",indicator:"Life expectancy at birth goals",unit:"categories",value:5,natural_value:3},{category:"Health",indicator:"Number of hospital beds per 1,000 population",unit:"per 1,000",value:2,natural_value:5.311479254299262},{category:"Health",indicator:"Number of doctors per 1,000 population",unit:"per 1,000",value:3,natural_value:6.822767921629207},{category:"Health",indicator:"Maternal mortality ratio",unit:"deaths per 1,000 live births",value:3,natural_value:49},{category:"Health",indicator:"Ambulance arrival speed, min",unit:"min",value:3,natural_value:70},{category:"Education",indicator:"Literacy rate among population (15-24 Years)",unit:"%",value:5,natural_value:.998982416788737},{category:"Education",indicator:"Literacy rate among population (15-24 Years) (change in last 3 years)",unit:"%",value:3,natural_value:0},{category:"Education",indicator:"Primary education engagement",unit:"%",value:5,natural_value:.961578066666667},{category:"Education",indicator:"Pupils per teacher rate",unit:"ratio",value:3,natural_value:18.502333333333333},{category:"Education",indicator:"Proportion of population with post-secondary and higher education",unit:"%",value:5,natural_value:.634474207560221},{category:"Wealth",indicator:"Percentage of population with food expenditure is above 52% of total expenditure",unit:"%",value:3,natural_value:.14},{category:"Wealth",indicator:"Mean monthly salary",unit:"US dollars thousand",value:3,natural_value:2901.12},{category:"Wealth",indicator:"Mean monthly salary, change in last 3 years",unit:"%",value:5,natural_value:.0970823344626255},{category:"Wealth",indicator:"Disposable monthly income",unit:"US dollars thousand",value:3,natural_value:521.0737469923129},{category:"Wealth",indicator:"Disposable monthly income (change in last 3 years)",unit:"%",value:3,natural_value:-.0155428529827583},{category:"Wealth",indicator:"Debt to salary ratio",unit:"ratio",value:4,natural_value:2.6836602741196},{category:"Wealth",indicator:"Number of mobile phones per 1,000 population",unit:"per 1,000",value:2,natural_value:90.56666666666668},{category:"Wealth",indicator:"Decile income coefficient",unit:"ratio",value:5,natural_value:5.4751039235044985},{category:"Wealth",indicator:"Decile income coefficient (change in last 3 years)",unit:"%",value:3,natural_value:-.036},{category:"Wealth",indicator:"Poverty headcount ratio at national poverty lines",unit:"%",value:3,natural_value:.186666666666667},{category:"Wealth",indicator:"Working poverty rate (percentage of employed living below US$1.90 PPP), 15+ age (%) ",unit:"%",value:4,natural_value:.0156666666666667},{category:"Wealth",indicator:"Poverty headcount ratio at $2.15 PPP 2017 a day",unit:"%",value:4,natural_value:.0163333333333333},{category:"Wealth",indicator:"Living spaces per capita, sq m (change in last 3 years)",unit:"%",value:2,natural_value:.0117657852745596},{category:"Wealth",indicator:"Population living in slums (% of urban population)",unit:"%",value:3,natural_value:.17},{category:"Wealth",indicator:"Availability of finance (consumer loans)",unit:"%",value:3,natural_value:.5},{category:"Wealth",indicator:"Perception of wealth & poverty index",unit:"index",value:1,natural_value:1.7232024487028685},{category:"Safety",indicator:"Road fatalities rate per 100,000 population",unit:"per 100,000",value:4,natural_value:8.586666666666666},{category:"Safety",indicator:"Road fatalities rate per 100,000 population (change in last 3 years)",unit:"%",value:1,natural_value:-.224},{category:"Safety",indicator:"Violent crime rate per 100,000 population",unit:"per 100,000",value:4,natural_value:3.3666666666666667},{category:"Safety",indicator:"Violent crime rate per 100,000 population (change in last 3 years)",unit:"%",value:5,natural_value:-.084},{category:"Safety",indicator:"Crime rate per 100,000 population",unit:"per 100,000",value:3,natural_value:1605},{category:"Safety",indicator:"Crime rate per 100,000 population  (change in last 3 years)",unit:"%",value:1,natural_value:-.084},{category:"Safety",indicator:"Police arrival speed",unit:"min",value:2,natural_value:26},{category:"Safety",indicator:"Perception of safety index",unit:"index",value:2,natural_value:3.2249999999999996},{category:"Livability",indicator:"Number of LEED certified green buildings",unit:"Certified square meters per capita",value:2,natural_value:0},{category:"Livability",indicator:"Number of BREEAM certified projects",unit:"Certified square meters per capita",value:1,natural_value:0},{category:"Livability",indicator:"Whether or not the city has ISO 37120 certification",unit:"Yes/No",value:1,natural_value:0},{category:"Livability",indicator:"Mobile connection coverage",unit:"%",value:2,natural_value:.922},{category:"Livability",indicator:"Internet coverage",unit:"%",value:2,natural_value:.880666666666667},{category:"Livability",indicator:"Perception of livability index",unit:"index",value:1,natural_value:4.173213808617591},{category:"Livability",indicator:"Share of population in 1 km from schools",unit:"%",value:4,natural_value:97},{category:"Livability",indicator:"Share of population in 1 km from parks",unit:"%",value:3,natural_value:70.1},{category:"Transport",indicator:"Time loss in traffic",unit:"%",value:2,natural_value:60.7},{category:"Transport",indicator:"Share of the population in 1 km from public transport stop",unit:"%",value:3,natural_value:75.4},{category:"Transport",indicator:"Ratio of the cost of monthly public transport usage Ithe cheapest option) to average mobthly income",unit:"ratio",value:3,natural_value:.04},{category:"Transport",indicator:"Ratio of the cost of a 1-kilometer taxi ride to average mobthly income",unit:"%",value:3,natural_value:.04},{category:"Transport",indicator:"Percentage of city's roads that are segregated and/or has specialized lane for cyclists",unit:"%",value:3,natural_value:.06},{category:"Transport",indicator:"Number of public electric vehicle (EV) charging points per 100,000 population",unit:"per 100,000",value:3,natural_value:1.4},{category:"Transport",indicator:"Public transport (excluding subway) operates by schedule ",unit:"Yes/No",value:5,natural_value:1},{category:"Transport",indicator:"Perception of transport index",unit:"index",value:1,natural_value:4.173213808617591},{category:"Inclusion",indicator:"Female-friendly city",unit:"1,2,3,4,5",value:3,natural_value:3},{category:"Inclusion",indicator:"Number of refugees per 1,000 population",unit:"per 1,000",value:3,natural_value:4.1},{category:"Inclusion",indicator:"Homeless people per 1,000 population",unit:"per 1,000",value:3,natural_value:1.889719188959608},{category:"Inclusion",indicator:"Difference in number of years of schooling between woman and man, woman to man ratio ",unit:"years",value:3,natural_value:1.05},{category:"Inclusion",indicator:"Slavery index",unit:"index",value:3,natural_value:11.1},{category:"Inclusion",indicator:"Percentage of women aged 25-34 years old that have successfully completed secondary education",unit:"%",value:5,natural_value:.6729999999999999},{category:"Inclusion",indicator:"Regulations for building construction and equipment, public transport for people with disabilities",unit:"Yes/No",value:5,natural_value:1},{category:"Inclusion",indicator:"Perception of inclusion index",unit:"index",value:4,natural_value:1.6634254646800826},{category:"Accountability",indicator:"City budget execution publication",unit:"Yes/No",value:5,natural_value:1},{category:"Accountability",indicator:"City budget publication",unit:"Yes/No",value:5,natural_value:1},{category:"Accountability",indicator:"Financial transparency on city government companies",unit:"Yes/No",value:1,natural_value:0},{category:"Accountability",indicator:"ISO certification",unit:"Yes/No",value:1,natural_value:0},{category:"Accountability",indicator:"City council checks and balances",unit:"Yes/No",value:5,natural_value:1},{category:"Accountability",indicator:"Plans to obtain ISO certification",unit:"Yes/No",value:5,natural_value:1},{category:"Accountability",indicator:"Perception of accountability index",unit:"index",value:1,natural_value:1.359106447444682},{category:"City budget",indicator:"Poor financial condition",unit:"Yes/No",value:5,natural_value:0},{category:"City budget",indicator:"Central/higher level government financial intervention taking place",unit:"Yes/No",value:5,natural_value:0},{category:"City budget",indicator:"Long-term financial planning",unit:"Yes/No",value:1,natural_value:0},{category:"City budget",indicator:"Central/higher level government financial intervention is considered",unit:"Yes/No",value:1,natural_value:0},{category:"City budget",indicator:"Prudent fiscal policy requirements",unit:"Yes/No",value:5,natural_value:1},{category:"City budget",indicator:"Medium-term planning",unit:"Yes/No",value:5,natural_value:1},{category:"SME",indicator:"Number of SMEs per 100,000 population",unit:"per 100,000",value:1,natural_value:11505.543278417088},{category:"SME",indicator:"Number of start-ups",unit:"start-ups",value:2,natural_value:7567.666666666667},{category:"SME",indicator:"Global Startup Ecosystem Index",unit:"index",value:1,natural_value:0},{category:"SME",indicator:"Number of SMEs per capita/100 000 population (change in last 3 years)",unit:"%",value:3,natural_value:0},{category:"SME",indicator:"Number of start-ups (change in last 3 years)",unit:"%",value:3,natural_value:0},{category:"Public services",indicator:"Free phone to call the police, ambulance, firefighters",unit:"1,2,3,4,5",value:5,natural_value:1},{category:"Public services",indicator:"Services for working with citizens' appeals and complaint",unit:"Yes/No",value:5,natural_value:1},{category:"Public services",indicator:"E-gov services",unit:"Yes/No",value:5,natural_value:1},{category:"Public services",indicator:"Perception of public services index: Public Services",unit:"index",value:2,natural_value:2.7906076049115165},{category:"Sustainability commitment",indicator:"City ESG reporting",unit:"Yes/No",value:1,natural_value:0},{category:"Sustainability commitment",indicator:"City ESG reporting verification",unit:"Yes/No",value:1,natural_value:0},{category:"Sustainability commitment",indicator:"ESG planning",unit:"Yes/No",value:1,natural_value:0},{category:"Sustainability commitment",indicator:"Plan with specific targets to develop and implement smart city principles",unit:"Yes/No",value:5,natural_value:1},{category:"Sustainability commitment",indicator:"Rollout and status of ESG / UN SDG training across the municipal/asset workforce",unit:"Yes/No",value:1,natural_value:0},{category:"Sustainability commitment",indicator:"City municipality involved in network or partnership promoting sustainable development (for example, C40 Cities network)",unit:"Yes/No",value:5,natural_value:1}]},{city:"Cape Town",data:[{category:"Air pollution",indicator:"CO2 emissions",unit:"kt",value:4,natural_value:1.83141622},{category:"Air pollution",indicator:"CO2 emissions (change in last 3 years)",unit:"%",value:3,natural_value:.038347905482194224},{category:"Air pollution",indicator:"CO2 concentration",unit:"ppm",value:5,natural_value:410.982591},{category:"Air pollution",indicator:"CO2 concentration (change in last 3 years)",unit:"%",value:5,natural_value:.00947134212255332},{category:"Air pollution",indicator:"Annual average of SO2 concentration in ambient air",unit:"microgram/m3",value:4,natural_value:2.959491114},{category:"Air pollution",indicator:"Annual Average of SO2 Concentration in Ambient Air (change in last 3 years)",unit:"%",value:3,natural_value:.053096182207327494},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air",unit:"microgram/m3",value:3,natural_value:12.6},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air (change in last 3 years), microgram/m3",unit:"%",value:3,natural_value:.05843338090840398},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air, microgram/m3",unit:"microgram/m3",value:5,natural_value:41.0593754},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air (change in last 3 years), microgram/m3",unit:"%",value:3,natural_value:.004064526034607794},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air, microgram/m3",unit:"microgram/m3",value:4,natural_value:.183141622},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air (change in last 3 years), microgram/m3",unit:"%",value:3,natural_value:.038347905482194224},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air, microgram/m3",unit:"microgram/m3",value:4,natural_value:30.61868568},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air (change in last 3 years), microgram/m3",unit:"%",value:3,natural_value:.06188768470920251},{category:"Air pollution",indicator:"Volatile organic compounds/reactive organic gases emissions",unit:"microgram/m3",value:3,natural_value:1.7},{category:"Air pollution",indicator:"Perception of air pollution index",unit:"index",value:3,natural_value:1.6},{category:"Air pollution",indicator:"Paris Agreement",unit:"Yes/No",value:5,natural_value:1},{category:"Water pollution",indicator:"Annual average of dissolved oxygen (DO) concentration in water",unit:"%",value:1,natural_value:7.4},{category:"Water pollution",indicator:"Annual average of pH concentration in water",unit:"pH",value:1,natural_value:8.608333333333334},{category:"Water pollution",indicator:"Annual average dissolved solids in drinking-water",unit:"ppm",value:2,natural_value:246.15384615384616},{category:"Water pollution",indicator:"Water management strategy in a city",unit:"Yes/No",value:5,natural_value:1},{category:"Water pollution",indicator:"Perception of water pollution index",unit:"index",value:3,natural_value:1.9},{category:"Land use and waste",indicator:"Share of devastated and degraded land area requiring reclamation",unit:"%",value:3,natural_value:7},{category:"Land use and waste",indicator:"3-year average growth rate of devastated and degraded land area requiring reclamation",unit:"%",value:3,natural_value:.002},{category:"Land use and waste",indicator:"Waste deposits",unit:"%",value:3,natural_value:.005},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous)",unit:"kg per capita ",value:3,natural_value:487.0252454957336},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous), (change in last 3 years)",unit:"%",value:4,natural_value:-.10465563349646823},{category:"Land use and waste",indicator:"Total recycled construction waste",unit:"tons per capita",value:2,natural_value:.007102473498233216},{category:"Land use and waste",indicator:"Share of recycled construction and demolish waste in total generated construction and demolish waste",unit:"%",value:2,natural_value:.1},{category:"Land use and waste",indicator:"Total area of impervious surfaces and percentage to total city area",unit:"%",value:3,natural_value:.02},{category:"Land use and waste",indicator:"Productive urban land (in percent total land)",unit:"%",value:3,natural_value:32.2},{category:"Land use and waste",indicator:"Waste managenet strategy",unit:"Yes/No",value:5,natural_value:1},{category:"Land use and waste",indicator:"Perception of waste index",unit:"index",value:2,natural_value:2.3},{category:"Land use and waste",indicator:"Green spaces, % city area",unit:"%",value:3,natural_value:.24},{category:"Land use and waste",indicator:"Green spaces, change in last 3 years",unit:"%",value:3,natural_value:-.06},{category:"Land use and waste",indicator:"NDVI",unit:"%",value:3,natural_value:.334},{category:"Natural disaster hazards",indicator:"Share of total area with altitude above sea level less than 0,5 meters",unit:"%",value:3,natural_value:.085},{category:"Natural disaster hazards",indicator:"Growth rate of freshwater mirror area",unit:"%",value:3,natural_value:-.06},{category:"Natural disaster hazards",indicator:"Number of registered heavy rain, flood and thunderbolt (change in last 3 years)",unit:"%",value:3,natural_value:.006622709560113016},{category:"Natural disaster hazards",indicator:"Number of registered sand storm (change in last 3 years)",unit:"%",value:3,natural_value:.006622709560113016},{category:"Natural disaster hazards",indicator:"Environmental/natural disasters risk mitigation",unit:"Yes/No",value:5,natural_value:1},{category:"Natural disaster hazards",indicator:"Strategy/policy/government officials statement on environmental issues ",unit:"Yes/No",value:5,natural_value:1},{category:"Natural disaster hazards",indicator:"Total overall losses from natural disaster hazards",unit:"US$ mln ",value:3,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of days with average daily temperature above the threshold for 1990-2010",unit:"days",value:4,natural_value:8},{category:"Natural disaster hazards",indicator:"Number of disruptions to basic services, attributed to disasters",unit:"%",value:3,natural_value:0},{category:"Water availability",indicator:"Water consumption per capita",unit:"mcm",value:3,natural_value:.0006548780200194737},{category:"Water availability",indicator:"Water tariff to disposable income ratio",unit:"ratio",value:3,natural_value:1.943333333},{category:"Water availability",indicator:"Sanitary facilities tariff to disposable income ratio",unit:"ratio",value:3,natural_value:1.626},{category:"Water availability",indicator:"Water consumption per capita (change in last 3 years)",unit:"%",value:3,natural_value:.001543290127960395},{category:"Water availability",indicator:"Percentage of population with access to drinking water",unit:"%",value:3,natural_value:.939},{category:"Water availability",indicator:"Percentage of population with access to drinking water (change in last 3 years)",unit:"%",value:3,natural_value:.002856138323718005},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities",unit:"%",value:3,natural_value:.785},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities (change in last 3 years)",unit:"%",value:3,natural_value:.007762276945399327},{category:"Food availability",indicator:"Cereal import dependency ratio (5-years average)",unit:"%",value:3,natural_value:.1336},{category:"Food availability",indicator:"Cereal import dependency ratio (change in last 3 years)",unit:"%",value:5,natural_value:-.19939738387128758},{category:"Food availability",indicator:"Prevalence of undernourishment",unit:"%",value:2,natural_value:.079},{category:"Food availability",indicator:"Prevalence of undernourishment (change in last 3 years)",unit:"%",value:3,natural_value:.018000000000000002},{category:"Food availability",indicator:"Prevalence of undernourishment children",unit:"%",value:4,natural_value:.121},{category:"Food availability",indicator:"Prevalence of undernourishment children (change in last 3 years)",unit:"%",value:3,natural_value:-.010782511350259871},{category:"Food availability",indicator:"Prevalence of moderate or severe food insecurity in the population",unit:"%",value:3,natural_value:.213},{category:"Food availability",indicator:"Share of imports in food resources",unit:"%",value:4,natural_value:.078},{category:"Food availability",indicator:"Percentage of people with access to at least one food vendor/retailer within 15 minutes of walking",unit:"%",value:3,natural_value:91},{category:"Food availability",indicator:"Perception of food availability index",unit:"index",value:3,natural_value:2.2},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity",unit:"%",value:3,natural_value:.873669662475586},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity (change in last 3 years)",unit:"%",value:3,natural_value:.0003793691719999881},{category:"Energy availability",indicator:"Consumption of electricity per capita",unit:"kWh/person",value:3,natural_value:1791.8035267072164},{category:"Energy availability",indicator:"Consumption of electricity per capita (change in last 3 years)",unit:"%",value:5,natural_value:-.03615737083310333},{category:"Energy availability",indicator:"Electricity tariff to disposable income ratio",unit:"ratio",value:4,natural_value:.038868},{category:"Energy availability",indicator:"Share of renewable sources in electricity consumption",unit:"%",value:1,natural_value:.0976},{category:"Energy availability",indicator:"Perception of energy availability index",unit:"index",value:3,natural_value:1.07},{category:"Health",indicator:"Child mortality rate (under 5 years-old)",unit:"% of live births ",value:1,natural_value:32.85},{category:"Health",indicator:"City ambulance",unit:"Yes/No",value:5,natural_value:1},{category:"Health",indicator:"Life expectancy at birth, years",unit:"Years",value:5,natural_value:62.341},{category:"Health",indicator:"Life expectancy at birth goals",unit:"categories",value:5,natural_value:3},{category:"Health",indicator:"Number of hospital beds per 1,000 population",unit:"per 1,000",value:3,natural_value:1.9},{category:"Health",indicator:"Number of doctors per 1,000 population",unit:"per 1,000",value:3,natural_value:4.600528619222334},{category:"Health",indicator:"Maternal mortality ratio",unit:"deaths per 1,000 live births",value:3,natural_value:82.4},{category:"Health",indicator:"Ambulance arrival speed, min",unit:"min",value:3,natural_value:70},{category:"Education",indicator:"Literacy rate among population (15-24 Years)",unit:"%",value:3,natural_value:.971},{category:"Education",indicator:"Literacy rate among population (15-24 Years) (change in last 3 years)",unit:"%",value:1,natural_value:-.0064386739444597385},{category:"Education",indicator:"Primary education engagement",unit:"%",value:5,natural_value:.9547},{category:"Education",indicator:"Pupils per teacher rate",unit:"ratio",value:2,natural_value:30.9},{category:"Education",indicator:"Proportion of population with post-secondary and higher education",unit:"%",value:2,natural_value:.1369382},{category:"Wealth",indicator:"Percentage of population with food expenditure is above 52% of total expenditure",unit:"%",value:1,natural_value:.667},{category:"Wealth",indicator:"Mean monthly salary",unit:"US dollars thousand",value:3,natural_value:1685.79},{category:"Wealth",indicator:"Mean monthly salary, change in last 3 years",unit:"%",value:2,natural_value:-.049376116118616475},{category:"Wealth",indicator:"Disposable monthly income",unit:"US dollars thousand",value:3,natural_value:796.6926340868529},{category:"Wealth",indicator:"Disposable monthly income (change in last 3 years)",unit:"%",value:3,natural_value:.0419292096217605},{category:"Wealth",indicator:"Debt to salary ratio",unit:"ratio",value:5,natural_value:.17357018007398073},{category:"Wealth",indicator:"Number of mobile phones per 1,000 population",unit:"per 1,000",value:2,natural_value:167.3958702},{category:"Wealth",indicator:"Decile income coefficient",unit:"ratio",value:1,natural_value:56.11111111111111},{category:"Wealth",indicator:"Decile income coefficient (change in last 3 years)",unit:"%",value:3,natural_value:.03033195142262146},{category:"Wealth",indicator:"Poverty headcount ratio at national poverty lines",unit:"%",value:3,natural_value:.555},{category:"Wealth",indicator:"Working poverty rate (percentage of employed living below US$1.90 PPP), 15+ age (%) ",unit:"%",value:2,natural_value:.07},{category:"Wealth",indicator:"Poverty headcount ratio at $2.15 PPP 2017 a day",unit:"%",value:3,natural_value:.205},{category:"Wealth",indicator:"Living spaces per capita, sq m (change in last 3 years)",unit:"%",value:3,natural_value:.033},{category:"Wealth",indicator:"Population living in slums (% of urban population)",unit:"%",value:3,natural_value:.242},{category:"Wealth",indicator:"Availability of finance (consumer loans)",unit:"%",value:1,natural_value:.094},{category:"Wealth",indicator:"Perception of wealth & poverty index",unit:"index",value:5,natural_value:1.7},{category:"Safety",indicator:"Road fatalities rate per 100,000 population",unit:"per 100,000",value:3,natural_value:25.079090734507815},{category:"Safety",indicator:"Road fatalities rate per 100,000 population (change in last 3 years)",unit:"%",value:3,natural_value:-.06410660306012106},{category:"Safety",indicator:"Violent crime rate per 100,000 population",unit:"per 100,000",value:1,natural_value:66},{category:"Safety",indicator:"Violent crime rate per 100,000 population (change in last 3 years)",unit:"%",value:3,natural_value:-.005000083544809186},{category:"Safety",indicator:"Crime rate per 100,000 population",unit:"per 100,000",value:3,natural_value:1284.6769493044394},{category:"Safety",indicator:"Crime rate per 100,000 population  (change in last 3 years)",unit:"%",value:1,natural_value:-.08128988581649332},{category:"Safety",indicator:"Police arrival speed",unit:"min",value:2,natural_value:30},{category:"Safety",indicator:"Perception of safety index",unit:"index",value:3,natural_value:2.79},{category:"Livability",indicator:"Number of LEED certified green buildings",unit:"Certified square meters per capita",value:2,natural_value:.00236896007406712},{category:"Livability",indicator:"Number of BREEAM certified projects",unit:"Certified square meters per capita",value:1,natural_value:0},{category:"Livability",indicator:"Whether or not the city has ISO 37120 certification",unit:"Yes/No",value:1,natural_value:0},{category:"Livability",indicator:"Mobile connection coverage",unit:"%",value:5,natural_value:.999},{category:"Livability",indicator:"Internet coverage",unit:"%",value:5,natural_value:.998},{category:"Livability",indicator:"Perception of livability index",unit:"index",value:3,natural_value:1.5},{category:"Livability",indicator:"Share of population in 1 km from schools",unit:"%",value:4,natural_value:88.8},{category:"Livability",indicator:"Share of population in 1 km from parks",unit:"%",value:3,natural_value:64.3},{category:"Transport",indicator:"Time loss in traffic",unit:"%",value:3,natural_value:.275},{category:"Transport",indicator:"Share of the population in 1 km from public transport stop",unit:"%",value:3,natural_value:36.4},{category:"Transport",indicator:"Ratio of the cost of monthly public transport usage Ithe cheapest option) to average mobthly income",unit:"ratio",value:1,natural_value:.06538576303528867},{category:"Transport",indicator:"Ratio of the cost of a 1-kilometer taxi ride to average mobthly income",unit:"%",value:5,natural_value:.00030252878472407596},{category:"Transport",indicator:"Percentage of city's roads that are segregated and/or has specialized lane for cyclists",unit:"%",value:3,natural_value:.06},{category:"Transport",indicator:"Number of public electric vehicle (EV) charging points per 100,000 population",unit:"per 100,000",value:2,natural_value:.23162888167891352},{category:"Transport",indicator:"Public transport (excluding subway) operates by schedule ",unit:"Yes/No",value:5,natural_value:1},{category:"Transport",indicator:"Perception of transport index",unit:"index",value:3,natural_value:1.5},{category:"Inclusion",indicator:"Female-friendly city",unit:"1,2,3,4,5",value:3,natural_value:3},{category:"Inclusion",indicator:"Number of refugees per 1,000 population",unit:"per 1,000",value:3,natural_value:4.178214846228337},{category:"Inclusion",indicator:"Homeless people per 1,000 population",unit:"per 1,000",value:5,natural_value:.1895145395554747},{category:"Inclusion",indicator:"Difference in number of years of schooling between woman and man, woman to man ratio ",unit:"years",value:3,natural_value:.98},{category:"Inclusion",indicator:"Slavery index",unit:"index",value:4,natural_value:2.7},{category:"Inclusion",indicator:"Percentage of women aged 25-34 years old that have successfully completed secondary education",unit:"%",value:4,natural_value:.486074295},{category:"Inclusion",indicator:"Regulations for building construction and equipment, public transport for people with disabilities",unit:"Yes/No",value:5,natural_value:1},{category:"Inclusion",indicator:"Perception of inclusion index",unit:"index",value:3,natural_value:2.3},{category:"Accountability",indicator:"City budget execution publication",unit:"Yes/No",value:5,natural_value:1},{category:"Accountability",indicator:"City budget publication",unit:"Yes/No",value:5,natural_value:1},{category:"Accountability",indicator:"Financial transparency on city government companies",unit:"Yes/No",value:1,natural_value:0},{category:"Accountability",indicator:"ISO certification",unit:"Yes/No",value:1,natural_value:0},{category:"Accountability",indicator:"City council checks and balances",unit:"Yes/No",value:5,natural_value:1},{category:"Accountability",indicator:"Plans to obtain ISO certification",unit:"Yes/No",value:5,natural_value:1},{category:"Accountability",indicator:"Perception of accountability index",unit:"index",value:3,natural_value:.9},{category:"City budget",indicator:"Poor financial condition",unit:"Yes/No",value:1,natural_value:1},{category:"City budget",indicator:"Central/higher level government financial intervention taking place",unit:"Yes/No",value:5,natural_value:0},{category:"City budget",indicator:"Long-term financial planning",unit:"Yes/No",value:5,natural_value:1},{category:"City budget",indicator:"Central/higher level government financial intervention is considered",unit:"Yes/No",value:1,natural_value:0},{category:"City budget",indicator:"Prudent fiscal policy requirements",unit:"Yes/No",value:1,natural_value:0},{category:"City budget",indicator:"Medium-term planning",unit:"Yes/No",value:5,natural_value:1},{category:"SME",indicator:"Number of SMEs per 100,000 population",unit:"per 100,000",value:3,natural_value:464.75262588672},{category:"SME",indicator:"Number of start-ups",unit:"start-ups",value:3,natural_value:225},{category:"SME",indicator:"Global Startup Ecosystem Index",unit:"index",value:1,natural_value:5.188},{category:"SME",indicator:"Number of SMEs per capita/100 000 population (change in last 3 years)",unit:"%",value:1,natural_value:-.3690430901893693},{category:"SME",indicator:"Number of start-ups (change in last 3 years)",unit:"%",value:3,natural_value:.125},{category:"Public services",indicator:"Free phone to call the police, ambulance, firefighters",unit:"1,2,3,4,5",value:5,natural_value:1},{category:"Public services",indicator:"Services for working with citizens' appeals and complaint",unit:"Yes/No",value:5,natural_value:1},{category:"Public services",indicator:"E-gov services",unit:"Yes/No",value:5,natural_value:1},{category:"Public services",indicator:"Perception of public services index: Public Services",unit:"index",value:3,natural_value:1.77},{category:"Sustainability commitment",indicator:"City ESG reporting",unit:"Yes/No",value:5,natural_value:1},{category:"Sustainability commitment",indicator:"City ESG reporting verification",unit:"Yes/No",value:5,natural_value:1},{category:"Sustainability commitment",indicator:"ESG planning",unit:"Yes/No",value:5,natural_value:1},{category:"Sustainability commitment",indicator:"Plan with specific targets to develop and implement smart city principles",unit:"Yes/No",value:5,natural_value:1},{category:"Sustainability commitment",indicator:"Rollout and status of ESG / UN SDG training across the municipal/asset workforce",unit:"Yes/No",value:5,natural_value:1},{category:"Sustainability commitment",indicator:"City municipality involved in network or partnership promoting sustainable development (for example, C40 Cities network)",unit:"Yes/No",value:5,natural_value:1}]},{city:"Mexico City",data:[{category:"Air pollution",indicator:"CO2 emissions",unit:"kt",value:3,natural_value:3.94406729},{category:"Air pollution",indicator:"CO2 emissions (change in last 3 years)",unit:"%",value:3,natural_value:-.004250140841668175},{category:"Air pollution",indicator:"CO2 concentration",unit:"ppm",value:4,natural_value:417.6455595},{category:"Air pollution",indicator:"CO2 concentration (change in last 3 years)",unit:"%",value:5,natural_value:.01301563418143103},{category:"Air pollution",indicator:"Annual average of SO2 concentration in ambient air",unit:"microgram/m3",value:1,natural_value:416.6828153},{category:"Air pollution",indicator:"Annual Average of SO2 Concentration in Ambient Air (change in last 3 years)",unit:"%",value:3,natural_value:.029396212805524676},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air",unit:"microgram/m3",value:2,natural_value:35},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air (change in last 3 years), microgram/m3",unit:"%",value:3,natural_value:-.002990856524339786},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air, microgram/m3",unit:"microgram/m3",value:3,natural_value:49.19622362},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air (change in last 3 years), microgram/m3",unit:"%",value:3,natural_value:.02331986649456455},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air, microgram/m3",unit:"microgram/m3",value:3,natural_value:.394406729},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air (change in last 3 years), microgram/m3",unit:"%",value:3,natural_value:-.004250140841668175},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air, microgram/m3",unit:"microgram/m3",value:1,natural_value:141.6888279},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air (change in last 3 years), microgram/m3",unit:"%",value:3,natural_value:.01619130675578221},{category:"Air pollution",indicator:"Volatile organic compounds/reactive organic gases emissions",unit:"microgram/m3",value:3,natural_value:1.7},{category:"Air pollution",indicator:"Perception of air pollution index",unit:"index",value:3,natural_value:1.6},{category:"Air pollution",indicator:"Paris Agreement",unit:"Yes/No",value:5,natural_value:1},{category:"Water pollution",indicator:"Annual average of dissolved oxygen (DO) concentration in water",unit:"%",value:1,natural_value:7.4},{category:"Water pollution",indicator:"Annual average of pH concentration in water",unit:"pH",value:3,natural_value:7.1},{category:"Water pollution",indicator:"Annual average dissolved solids in drinking-water",unit:"ppm",value:1,natural_value:394.16},{category:"Water pollution",indicator:"Water management strategy in a city",unit:"Yes/No",value:5,natural_value:1},{category:"Water pollution",indicator:"Perception of water pollution index",unit:"index",value:3,natural_value:1.9},{category:"Land use and waste",indicator:"Share of devastated and degraded land area requiring reclamation",unit:"%",value:3,natural_value:7},{category:"Land use and waste",indicator:"3-year average growth rate of devastated and degraded land area requiring reclamation",unit:"%",value:3,natural_value:.002},{category:"Land use and waste",indicator:"Waste deposits",unit:"%",value:3,natural_value:.005},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous)",unit:"kg per capita ",value:3,natural_value:209.69890723087653},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous), (change in last 3 years)",unit:"%",value:4,natural_value:-.037697909969071075},{category:"Land use and waste",indicator:"Total recycled construction waste",unit:"tons per capita",value:3,natural_value:1.7},{category:"Land use and waste",indicator:"Share of recycled construction and demolish waste in total generated construction and demolish waste",unit:"%",value:3,natural_value:.249},{category:"Land use and waste",indicator:"Total area of impervious surfaces and percentage to total city area",unit:"%",value:3,natural_value:.02},{category:"Land use and waste",indicator:"Productive urban land (in percent total land)",unit:"%",value:3,natural_value:32.2},{category:"Land use and waste",indicator:"Waste managenet strategy",unit:"Yes/No",value:5,natural_value:1},{category:"Land use and waste",indicator:"Perception of waste index",unit:"index",value:3,natural_value:2.3},{category:"Land use and waste",indicator:"Green spaces, % city area",unit:"%",value:3,natural_value:.21},{category:"Land use and waste",indicator:"Green spaces, change in last 3 years",unit:"%",value:3,natural_value:-.06},{category:"Land use and waste",indicator:"NDVI",unit:"%",value:3,natural_value:.262},{category:"Natural disaster hazards",indicator:"Share of total area with altitude above sea level less than 0,5 meters",unit:"%",value:3,natural_value:.085},{category:"Natural disaster hazards",indicator:"Growth rate of freshwater mirror area",unit:"%",value:3,natural_value:-.06},{category:"Natural disaster hazards",indicator:"Number of registered heavy rain, flood and thunderbolt (change in last 3 years)",unit:"%",value:3,natural_value:-.0379},{category:"Natural disaster hazards",indicator:"Number of registered sand storm (change in last 3 years)",unit:"%",value:3,natural_value:-.0379},{category:"Natural disaster hazards",indicator:"Environmental/natural disasters risk mitigation",unit:"Yes/No",value:5,natural_value:1},{category:"Natural disaster hazards",indicator:"Strategy/policy/government officials statement on environmental issues ",unit:"Yes/No",value:5,natural_value:1},{category:"Natural disaster hazards",indicator:"Total overall losses from natural disaster hazards",unit:"US$ mln ",value:3,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of days with average daily temperature above the threshold for 1990-2010",unit:"days",value:1,natural_value:279},{category:"Natural disaster hazards",indicator:"Number of disruptions to basic services, attributed to disasters",unit:"%",value:3,natural_value:0},{category:"Water availability",indicator:"Water consumption per capita",unit:"mcm",value:3,natural_value:26240674667531622e-21},{category:"Water availability",indicator:"Water tariff to disposable income ratio",unit:"ratio",value:3,natural_value:.891333333},{category:"Water availability",indicator:"Sanitary facilities tariff to disposable income ratio",unit:"ratio",value:3,natural_value:1.1},{category:"Water availability",indicator:"Water consumption per capita (change in last 3 years)",unit:"%",value:5,natural_value:-.19799737528184247},{category:"Water availability",indicator:"Percentage of population with access to drinking water",unit:"%",value:5,natural_value:.99},{category:"Water availability",indicator:"Percentage of population with access to drinking water (change in last 3 years)",unit:"%",value:3,natural_value:.0016},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities",unit:"%",value:4,natural_value:.924},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities (change in last 3 years)",unit:"%",value:4,natural_value:.00510212913410224},{category:"Food availability",indicator:"Cereal import dependency ratio (5-years average)",unit:"%",value:3,natural_value:.3408},{category:"Food availability",indicator:"Cereal import dependency ratio (change in last 3 years)",unit:"%",value:4,natural_value:-.05401609914880312},{category:"Food availability",indicator:"Prevalence of undernourishment",unit:"%",value:3,natural_value:.025},{category:"Food availability",indicator:"Prevalence of undernourishment (change in last 3 years)",unit:"%",value:3,natural_value:-.002999999999999999},{category:"Food availability",indicator:"Prevalence of undernourishment children",unit:"%",value:4,natural_value:.126},{category:"Food availability",indicator:"Prevalence of undernourishment children (change in last 3 years)",unit:"%",value:3,natural_value:-.005235698025902069},{category:"Food availability",indicator:"Prevalence of moderate or severe food insecurity in the population",unit:"%",value:3,natural_value:.332},{category:"Food availability",indicator:"Share of imports in food resources",unit:"%",value:3,natural_value:.391},{category:"Food availability",indicator:"Percentage of people with access to at least one food vendor/retailer within 15 minutes of walking",unit:"%",value:3,natural_value:91},{category:"Food availability",indicator:"Perception of food availability index",unit:"index",value:3,natural_value:2.2},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity",unit:"%",value:5,natural_value:1},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity (change in last 3 years)",unit:"%",value:3,natural_value:.00133689998761799},{category:"Energy availability",indicator:"Consumption of electricity per capita",unit:"kWh/person",value:3,natural_value:4751.875097009815},{category:"Energy availability",indicator:"Consumption of electricity per capita (change in last 3 years)",unit:"%",value:4,natural_value:-.014927121837602364},{category:"Energy availability",indicator:"Electricity tariff to disposable income ratio",unit:"ratio",value:3,natural_value:.095},{category:"Energy availability",indicator:"Share of renewable sources in electricity consumption",unit:"%",value:2,natural_value:.1233},{category:"Energy availability",indicator:"Perception of energy availability index",unit:"index",value:3,natural_value:1.07},{category:"Health",indicator:"Child mortality rate (under 5 years-old)",unit:"% of live births ",value:3,natural_value:9.3},{category:"Health",indicator:"City ambulance",unit:"Yes/No",value:1,natural_value:0},{category:"Health",indicator:"Life expectancy at birth, years",unit:"Years",value:2,natural_value:70.213},{category:"Health",indicator:"Life expectancy at birth goals",unit:"categories",value:1,natural_value:1},{category:"Health",indicator:"Number of hospital beds per 1,000 population",unit:"per 1,000",value:5,natural_value:6.008509648918856},{category:"Health",indicator:"Number of doctors per 1,000 population",unit:"per 1,000",value:3,natural_value:5.4},{category:"Health",indicator:"Maternal mortality ratio",unit:"deaths per 1,000 live births",value:3,natural_value:36},{category:"Health",indicator:"Ambulance arrival speed, min",unit:"min",value:3,natural_value:70},{category:"Education",indicator:"Literacy rate among population (15-24 Years)",unit:"%",value:3,natural_value:.990824127197266},{category:"Education",indicator:"Literacy rate among population (15-24 Years) (change in last 3 years)",unit:"%",value:3,natural_value:-.00014217945297922974},{category:"Education",indicator:"Primary education engagement",unit:"%",value:3,natural_value:.73},{category:"Education",indicator:"Pupils per teacher rate",unit:"ratio",value:3,natural_value:21.6},{category:"Education",indicator:"Proportion of population with post-secondary and higher education",unit:"%",value:2,natural_value:.1877145958},{category:"Wealth",indicator:"Percentage of population with food expenditure is above 52% of total expenditure",unit:"%",value:3,natural_value:.202},{category:"Wealth",indicator:"Mean monthly salary",unit:"US dollars thousand",value:2,natural_value:890.8545},{category:"Wealth",indicator:"Mean monthly salary, change in last 3 years",unit:"%",value:3,natural_value:0},{category:"Wealth",indicator:"Disposable monthly income",unit:"US dollars thousand",value:3,natural_value:784},{category:"Wealth",indicator:"Disposable monthly income (change in last 3 years)",unit:"%",value:3,natural_value:.02},{category:"Wealth",indicator:"Debt to salary ratio",unit:"ratio",value:5,natural_value:.05835306826207985},{category:"Wealth",indicator:"Number of mobile phones per 1,000 population",unit:"per 1,000",value:2,natural_value:523},{category:"Wealth",indicator:"Decile income coefficient",unit:"ratio",value:3,natural_value:19.72222222222222},{category:"Wealth",indicator:"Decile income coefficient (change in last 3 years)",unit:"%",value:3,natural_value:-.03918968586393867},{category:"Wealth",indicator:"Poverty headcount ratio at national poverty lines",unit:"%",value:3,natural_value:.363},{category:"Wealth",indicator:"Working poverty rate (percentage of employed living below US$1.90 PPP), 15+ age (%) ",unit:"%",value:4,natural_value:.017},{category:"Wealth",indicator:"Poverty headcount ratio at $2.15 PPP 2017 a day",unit:"%",value:4,natural_value:.031},{category:"Wealth",indicator:"Living spaces per capita, sq m (change in last 3 years)",unit:"%",value:3,natural_value:.033},{category:"Wealth",indicator:"Population living in slums (% of urban population)",unit:"%",value:3,natural_value:.176},{category:"Wealth",indicator:"Availability of finance (consumer loans)",unit:"%",value:3,natural_value:.25},{category:"Wealth",indicator:"Perception of wealth & poverty index",unit:"index",value:3,natural_value:1.7},{category:"Safety",indicator:"Road fatalities rate per 100,000 population",unit:"per 100,000",value:4,natural_value:1.1857707509881423},{category:"Safety",indicator:"Road fatalities rate per 100,000 population (change in last 3 years)",unit:"%",value:5,natural_value:.1725851631673272},{category:"Safety",indicator:"Violent crime rate per 100,000 population",unit:"per 100,000",value:3,natural_value:14},{category:"Safety",indicator:"Violent crime rate per 100,000 population (change in last 3 years)",unit:"%",value:3,natural_value:0},{category:"Safety",indicator:"Crime rate per 100,000 population",unit:"per 100,000",value:1,natural_value:46032},{category:"Safety",indicator:"Crime rate per 100,000 population  (change in last 3 years)",unit:"%",value:2,natural_value:-.04789415935857033},{category:"Safety",indicator:"Police arrival speed",unit:"min",value:3,natural_value:21.7},{category:"Safety",indicator:"Perception of safety index",unit:"index",value:3,natural_value:2.79},{category:"Livability",indicator:"Number of LEED certified green buildings",unit:"Certified square meters per capita",value:3,natural_value:.126343935797907},{category:"Livability",indicator:"Number of BREEAM certified projects",unit:"Certified square meters per capita",value:1,natural_value:0},{category:"Livability",indicator:"Whether or not the city has ISO 37120 certification",unit:"Yes/No",value:1,natural_value:0},{category:"Livability",indicator:"Mobile connection coverage",unit:"%",value:5,natural_value:.999},{category:"Livability",indicator:"Internet coverage",unit:"%",value:3,natural_value:.9},{category:"Livability",indicator:"Perception of livability index",unit:"index",value:3,natural_value:1.5},{category:"Livability",indicator:"Share of population in 1 km from schools",unit:"%",value:3,natural_value:70.7},{category:"Livability",indicator:"Share of population in 1 km from parks",unit:"%",value:3,natural_value:64.3},{category:"Transport",indicator:"Time loss in traffic",unit:"%",value:1,natural_value:.6645},{category:"Transport",indicator:"Share of the population in 1 km from public transport stop",unit:"%",value:3,natural_value:43.9},{category:"Transport",indicator:"Ratio of the cost of monthly public transport usage Ithe cheapest option) to average mobthly income",unit:"ratio",value:5,natural_value:.0599424485143197},{category:"Transport",indicator:"Ratio of the cost of a 1-kilometer taxi ride to average mobthly income",unit:"%",value:1,natural_value:.07857624337083104},{category:"Transport",indicator:"Percentage of city's roads that are segregated and/or has specialized lane for cyclists",unit:"%",value:3,natural_value:.06},{category:"Transport",indicator:"Number of public electric vehicle (EV) charging points per 100,000 population",unit:"per 100,000",value:4,natural_value:1.8319738823695886},{category:"Transport",indicator:"Public transport (excluding subway) operates by schedule ",unit:"Yes/No",value:5,natural_value:1},{category:"Transport",indicator:"Perception of transport index",unit:"index",value:3,natural_value:1.5},{category:"Inclusion",indicator:"Female-friendly city",unit:"1,2,3,4,5",value:3,natural_value:3},{category:"Inclusion",indicator:"Number of refugees per 1,000 population",unit:"per 1,000",value:3,natural_value:4.1},{category:"Inclusion",indicator:"Homeless people per 1,000 population",unit:"per 1,000",value:3,natural_value:7.7},{category:"Inclusion",indicator:"Difference in number of years of schooling between woman and man, woman to man ratio ",unit:"years",value:3,natural_value:.97},{category:"Inclusion",indicator:"Slavery index",unit:"index",value:1,natural_value:58.1},{category:"Inclusion",indicator:"Percentage of women aged 25-34 years old that have successfully completed secondary education",unit:"%",value:1,natural_value:.1828479004},{category:"Inclusion",indicator:"Regulations for building construction and equipment, public transport for people with disabilities",unit:"Yes/No",value:5,natural_value:1},{category:"Inclusion",indicator:"Perception of inclusion index",unit:"index",value:3,natural_value:2.3},{category:"Accountability",indicator:"City budget execution publication",unit:"Yes/No",value:5,natural_value:1},{category:"Accountability",indicator:"City budget publication",unit:"Yes/No",value:5,natural_value:1},{category:"Accountability",indicator:"Financial transparency on city government companies",unit:"Yes/No",value:1,natural_value:0},{category:"Accountability",indicator:"ISO certification",unit:"Yes/No",value:1,natural_value:0},{category:"Accountability",indicator:"City council checks and balances",unit:"Yes/No",value:5,natural_value:1},{category:"Accountability",indicator:"Plans to obtain ISO certification",unit:"Yes/No",value:1,natural_value:0},{category:"Accountability",indicator:"Perception of accountability index",unit:"index",value:3,natural_value:.9},{category:"City budget",indicator:"Poor financial condition",unit:"Yes/No",value:1,natural_value:1},{category:"City budget",indicator:"Central/higher level government financial intervention taking place",unit:"Yes/No",value:1,natural_value:1},{category:"City budget",indicator:"Long-term financial planning",unit:"Yes/No",value:5,natural_value:1},{category:"City budget",indicator:"Central/higher level government financial intervention is considered",unit:"Yes/No",value:1,natural_value:0},{category:"City budget",indicator:"Prudent fiscal policy requirements",unit:"Yes/No",value:5,natural_value:1},{category:"City budget",indicator:"Medium-term planning",unit:"Yes/No",value:5,natural_value:1},{category:"SME",indicator:"Number of SMEs per 100,000 population",unit:"per 100,000",value:3,natural_value:9336},{category:"SME",indicator:"Number of start-ups",unit:"start-ups",value:3,natural_value:1211},{category:"SME",indicator:"Global Startup Ecosystem Index",unit:"index",value:3,natural_value:13.567},{category:"SME",indicator:"Number of SMEs per capita/100 000 population (change in last 3 years)",unit:"%",value:3,natural_value:-7e-4},{category:"SME",indicator:"Number of start-ups (change in last 3 years)",unit:"%",value:3,natural_value:.125},{category:"Public services",indicator:"Free phone to call the police, ambulance, firefighters",unit:"1,2,3,4,5",value:5,natural_value:1},{category:"Public services",indicator:"Services for working with citizens' appeals and complaint",unit:"Yes/No",value:5,natural_value:1},{category:"Public services",indicator:"E-gov services",unit:"Yes/No",value:5,natural_value:1},{category:"Public services",indicator:"Perception of public services index: Public Services",unit:"index",value:3,natural_value:1.77},{category:"Sustainability commitment",indicator:"City ESG reporting",unit:"Yes/No",value:1,natural_value:0},{category:"Sustainability commitment",indicator:"City ESG reporting verification",unit:"Yes/No",value:1,natural_value:0},{category:"Sustainability commitment",indicator:"ESG planning",unit:"Yes/No",value:1,natural_value:0},{category:"Sustainability commitment",indicator:"Plan with specific targets to develop and implement smart city principles",unit:"Yes/No",value:5,natural_value:1},{category:"Sustainability commitment",indicator:"Rollout and status of ESG / UN SDG training across the municipal/asset workforce",unit:"Yes/No",value:1,natural_value:0},{category:"Sustainability commitment",indicator:"City municipality involved in network or partnership promoting sustainable development (for example, C40 Cities network)",unit:"Yes/No",value:5,natural_value:1}]},{city:"Jakarta",data:[{category:"Air pollution",indicator:"CO2 emissions",unit:"kt",value:2,natural_value:7.06684134},{category:"Air pollution",indicator:"CO2 emissions (change in last 3 years)",unit:"%",value:3,natural_value:-.003920588646618603},{category:"Air pollution",indicator:"CO2 concentration",unit:"ppm",value:1,natural_value:488.0373113},{category:"Air pollution",indicator:"CO2 concentration (change in last 3 years)",unit:"%",value:5,natural_value:.017863350354496974},{category:"Air pollution",indicator:"Annual average of SO2 concentration in ambient air",unit:"microgram/m3",value:3,natural_value:28.66047717},{category:"Air pollution",indicator:"Annual Average of SO2 Concentration in Ambient Air (change in last 3 years)",unit:"%",value:3,natural_value:-.0009916021541911573},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air",unit:"microgram/m3",value:2,natural_value:24.2},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air (change in last 3 years), microgram/m3",unit:"%",value:3,natural_value:.008889816360600893},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air, microgram/m3",unit:"microgram/m3",value:4,natural_value:46.95295405},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air (change in last 3 years), microgram/m3",unit:"%",value:3,natural_value:-.06267596465337597},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air, microgram/m3",unit:"microgram/m3",value:2,natural_value:.706684134},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air (change in last 3 years), microgram/m3",unit:"%",value:3,natural_value:-.003920588646618603},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air, microgram/m3",unit:"microgram/m3",value:1,natural_value:131.8745867},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air (change in last 3 years), microgram/m3",unit:"%",value:3,natural_value:.006113533484481624},{category:"Air pollution",indicator:"Volatile organic compounds/reactive organic gases emissions",unit:"microgram/m3",value:3,natural_value:1.7},{category:"Air pollution",indicator:"Perception of air pollution index",unit:"index",value:3,natural_value:1.6},{category:"Air pollution",indicator:"Paris Agreement",unit:"Yes/No",value:5,natural_value:1},{category:"Water pollution",indicator:"Annual average of dissolved oxygen (DO) concentration in water",unit:"%",value:3,natural_value:6.08},{category:"Water pollution",indicator:"Annual average of pH concentration in water",unit:"pH",value:3,natural_value:7.1},{category:"Water pollution",indicator:"Annual average dissolved solids in drinking-water",unit:"ppm",value:4,natural_value:75},{category:"Water pollution",indicator:"Water management strategy in a city",unit:"Yes/No",value:5,natural_value:1},{category:"Water pollution",indicator:"Perception of water pollution index",unit:"index",value:3,natural_value:1.9},{category:"Land use and waste",indicator:"Share of devastated and degraded land area requiring reclamation",unit:"%",value:3,natural_value:7},{category:"Land use and waste",indicator:"3-year average growth rate of devastated and degraded land area requiring reclamation",unit:"%",value:3,natural_value:.002},{category:"Land use and waste",indicator:"Waste deposits",unit:"%",value:3,natural_value:.005},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous)",unit:"kg per capita ",value:3,natural_value:219},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous), (change in last 3 years)",unit:"%",value:3,natural_value:4.2},{category:"Land use and waste",indicator:"Total recycled construction waste",unit:"tons per capita",value:3,natural_value:1.7},{category:"Land use and waste",indicator:"Share of recycled construction and demolish waste in total generated construction and demolish waste",unit:"%",value:3,natural_value:.249},{category:"Land use and waste",indicator:"Total area of impervious surfaces and percentage to total city area",unit:"%",value:3,natural_value:.02},{category:"Land use and waste",indicator:"Productive urban land (in percent total land)",unit:"%",value:3,natural_value:32.2},{category:"Land use and waste",indicator:"Waste managenet strategy",unit:"Yes/No",value:1,natural_value:0},{category:"Land use and waste",indicator:"Perception of waste index",unit:"index",value:3,natural_value:2.3},{category:"Land use and waste",indicator:"Green spaces, % city area",unit:"%",value:2,natural_value:.0465},{category:"Land use and waste",indicator:"Green spaces, change in last 3 years",unit:"%",value:3,natural_value:-.06},{category:"Land use and waste",indicator:"NDVI",unit:"%",value:3,natural_value:.447},{category:"Natural disaster hazards",indicator:"Share of total area with altitude above sea level less than 0,5 meters",unit:"%",value:3,natural_value:.085},{category:"Natural disaster hazards",indicator:"Growth rate of freshwater mirror area",unit:"%",value:3,natural_value:-.06},{category:"Natural disaster hazards",indicator:"Number of registered heavy rain, flood and thunderbolt (change in last 3 years)",unit:"%",value:3,natural_value:-.0379},{category:"Natural disaster hazards",indicator:"Number of registered sand storm (change in last 3 years)",unit:"%",value:3,natural_value:-.0379},{category:"Natural disaster hazards",indicator:"Environmental/natural disasters risk mitigation",unit:"Yes/No",value:5,natural_value:1},{category:"Natural disaster hazards",indicator:"Strategy/policy/government officials statement on environmental issues ",unit:"Yes/No",value:1,natural_value:0},{category:"Natural disaster hazards",indicator:"Total overall losses from natural disaster hazards",unit:"US$ mln ",value:3,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of days with average daily temperature above the threshold for 1990-2010",unit:"days",value:3,natural_value:15},{category:"Natural disaster hazards",indicator:"Number of disruptions to basic services, attributed to disasters",unit:"%",value:3,natural_value:0},{category:"Water availability",indicator:"Water consumption per capita",unit:"mcm",value:3,natural_value:.11353959693443089},{category:"Water availability",indicator:"Water tariff to disposable income ratio",unit:"ratio",value:3,natural_value:1.29},{category:"Water availability",indicator:"Sanitary facilities tariff to disposable income ratio",unit:"ratio",value:3,natural_value:1.1},{category:"Water availability",indicator:"Water consumption per capita (change in last 3 years)",unit:"%",value:3,natural_value:-.004},{category:"Water availability",indicator:"Percentage of population with access to drinking water",unit:"%",value:3,natural_value:.9773},{category:"Water availability",indicator:"Percentage of population with access to drinking water (change in last 3 years)",unit:"%",value:5,natural_value:-.003421320060821298},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities",unit:"%",value:4,natural_value:.9279},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities (change in last 3 years)",unit:"%",value:4,natural_value:-.0008964755405916902},{category:"Food availability",indicator:"Cereal import dependency ratio (5-years average)",unit:"%",value:3,natural_value:.35},{category:"Food availability",indicator:"Cereal import dependency ratio (change in last 3 years)",unit:"%",value:3,natural_value:.002},{category:"Food availability",indicator:"Prevalence of undernourishment",unit:"%",value:3,natural_value:.065},{category:"Food availability",indicator:"Prevalence of undernourishment (change in last 3 years)",unit:"%",value:3,natural_value:.006000000000000005},{category:"Food availability",indicator:"Prevalence of undernourishment children",unit:"%",value:4,natural_value:.122},{category:"Food availability",indicator:"Prevalence of undernourishment children (change in last 3 years)",unit:"%",value:3,natural_value:-.0010000000000000009},{category:"Food availability",indicator:"Prevalence of moderate or severe food insecurity in the population",unit:"%",value:3,natural_value:.117},{category:"Food availability",indicator:"Share of imports in food resources",unit:"%",value:2,natural_value:.6},{category:"Food availability",indicator:"Percentage of people with access to at least one food vendor/retailer within 15 minutes of walking",unit:"%",value:3,natural_value:91},{category:"Food availability",indicator:"Perception of food availability index",unit:"index",value:3,natural_value:2.2},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity",unit:"%",value:3,natural_value:.9973},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity (change in last 3 years)",unit:"%",value:1,natural_value:-.0008675056905055323},{category:"Energy availability",indicator:"Consumption of electricity per capita",unit:"kWh/person",value:4,natural_value:1090},{category:"Energy availability",indicator:"Consumption of electricity per capita (change in last 3 years)",unit:"%",value:3,natural_value:.009346336118695842},{category:"Energy availability",indicator:"Electricity tariff to disposable income ratio",unit:"ratio",value:3,natural_value:.1},{category:"Energy availability",indicator:"Share of renewable sources in electricity consumption",unit:"%",value:2,natural_value:.14},{category:"Energy availability",indicator:"Perception of energy availability index",unit:"index",value:3,natural_value:1.07},{category:"Health",indicator:"Child mortality rate (under 5 years-old)",unit:"% of live births ",value:2,natural_value:22.17},{category:"Health",indicator:"City ambulance",unit:"Yes/No",value:5,natural_value:1},{category:"Health",indicator:"Life expectancy at birth, years",unit:"Years",value:3,natural_value:73.32},{category:"Health",indicator:"Life expectancy at birth goals",unit:"categories",value:5,natural_value:3},{category:"Health",indicator:"Number of hospital beds per 1,000 population",unit:"per 1,000",value:3,natural_value:3.1},{category:"Health",indicator:"Number of doctors per 1,000 population",unit:"per 1,000",value:2,natural_value:23},{category:"Health",indicator:"Maternal mortality ratio",unit:"deaths per 1,000 live births",value:1,natural_value:173},{category:"Health",indicator:"Ambulance arrival speed, min",unit:"min",value:3,natural_value:120},{category:"Education",indicator:"Literacy rate among population (15-24 Years)",unit:"%",value:5,natural_value:.9996},{category:"Education",indicator:"Literacy rate among population (15-24 Years) (change in last 3 years)",unit:"%",value:3,natural_value:.00023353573945694706},{category:"Education",indicator:"Primary education engagement",unit:"%",value:3,natural_value:.5018},{category:"Education",indicator:"Pupils per teacher rate",unit:"ratio",value:3,natural_value:18.44},{category:"Education",indicator:"Proportion of population with post-secondary and higher education",unit:"%",value:4,natural_value:.4012},{category:"Wealth",indicator:"Percentage of population with food expenditure is above 52% of total expenditure",unit:"%",value:4,natural_value:.07},{category:"Wealth",indicator:"Mean monthly salary",unit:"US dollars thousand",value:2,natural_value:554.22},{category:"Wealth",indicator:"Mean monthly salary, change in last 3 years",unit:"%",value:3,natural_value:0},{category:"Wealth",indicator:"Disposable monthly income",unit:"US dollars thousand",value:3,natural_value:784},{category:"Wealth",indicator:"Disposable monthly income (change in last 3 years)",unit:"%",value:3,natural_value:.02},{category:"Wealth",indicator:"Debt to salary ratio",unit:"ratio",value:3,natural_value:5},{category:"Wealth",indicator:"Number of mobile phones per 1,000 population",unit:"per 1,000",value:3,natural_value:1300},{category:"Wealth",indicator:"Decile income coefficient",unit:"ratio",value:3,natural_value:16},{category:"Wealth",indicator:"Decile income coefficient (change in last 3 years)",unit:"%",value:3,natural_value:-.0685},{category:"Wealth",indicator:"Poverty headcount ratio at national poverty lines",unit:"%",value:3,natural_value:.0469},{category:"Wealth",indicator:"Working poverty rate (percentage of employed living below US$1.90 PPP), 15+ age (%) ",unit:"%",value:3,natural_value:.023},{category:"Wealth",indicator:"Poverty headcount ratio at $2.15 PPP 2017 a day",unit:"%",value:3,natural_value:.025},{category:"Wealth",indicator:"Living spaces per capita, sq m (change in last 3 years)",unit:"%",value:3,natural_value:.033},{category:"Wealth",indicator:"Population living in slums (% of urban population)",unit:"%",value:3,natural_value:.075},{category:"Wealth",indicator:"Availability of finance (consumer loans)",unit:"%",value:3,natural_value:.43},{category:"Wealth",indicator:"Perception of wealth & poverty index",unit:"index",value:3,natural_value:1.7},{category:"Safety",indicator:"Road fatalities rate per 100,000 population",unit:"per 100,000",value:4,natural_value:13.94},{category:"Safety",indicator:"Road fatalities rate per 100,000 population (change in last 3 years)",unit:"%",value:3,natural_value:-.03},{category:"Safety",indicator:"Violent crime rate per 100,000 population",unit:"per 100,000",value:5,natural_value:.33038999264164826},{category:"Safety",indicator:"Violent crime rate per 100,000 population (change in last 3 years)",unit:"%",value:4,natural_value:-.0484913742569858},{category:"Safety",indicator:"Crime rate per 100,000 population",unit:"per 100,000",value:3,natural_value:82.24439043689594},{category:"Safety",indicator:"Crime rate per 100,000 population  (change in last 3 years)",unit:"%",value:3,natural_value:-.03},{category:"Safety",indicator:"Police arrival speed",unit:"min",value:3,natural_value:21.7},{category:"Safety",indicator:"Perception of safety index",unit:"index",value:3,natural_value:2.79},{category:"Livability",indicator:"Number of LEED certified green buildings",unit:"Certified square meters per capita",value:3,natural_value:24.08014468999039},{category:"Livability",indicator:"Number of BREEAM certified projects",unit:"Certified square meters per capita",value:1,natural_value:0},{category:"Livability",indicator:"Whether or not the city has ISO 37120 certification",unit:"Yes/No",value:1,natural_value:1},{category:"Livability",indicator:"Mobile connection coverage",unit:"%",value:3,natural_value:.9676},{category:"Livability",indicator:"Internet coverage",unit:"%",value:4,natural_value:.9676},{category:"Livability",indicator:"Perception of livability index",unit:"index",value:3,natural_value:1.5},{category:"Livability",indicator:"Share of population in 1 km from schools",unit:"%",value:3,natural_value:54.7},{category:"Livability",indicator:"Share of population in 1 km from parks",unit:"%",value:3,natural_value:64.3},{category:"Transport",indicator:"Time loss in traffic",unit:"%",value:2,natural_value:.3624},{category:"Transport",indicator:"Share of the population in 1 km from public transport stop",unit:"%",value:3,natural_value:24.8},{category:"Transport",indicator:"Ratio of the cost of monthly public transport usage Ithe cheapest option) to average mobthly income",unit:"ratio",value:3,natural_value:.04},{category:"Transport",indicator:"Ratio of the cost of a 1-kilometer taxi ride to average mobthly income",unit:"%",value:3,natural_value:.04},{category:"Transport",indicator:"Percentage of city's roads that are segregated and/or has specialized lane for cyclists",unit:"%",value:3,natural_value:.06},{category:"Transport",indicator:"Number of public electric vehicle (EV) charging points per 100,000 population",unit:"per 100,000",value:3,natural_value:1.4},{category:"Transport",indicator:"Public transport (excluding subway) operates by schedule ",unit:"Yes/No",value:5,natural_value:1},{category:"Transport",indicator:"Perception of transport index",unit:"index",value:3,natural_value:1.5},{category:"Inclusion",indicator:"Female-friendly city",unit:"1,2,3,4,5",value:3,natural_value:3},{category:"Inclusion",indicator:"Number of refugees per 1,000 population",unit:"per 1,000",value:5,natural_value:.19897699655230883},{category:"Inclusion",indicator:"Homeless people per 1,000 population",unit:"per 1,000",value:5,natural_value:.2491806348909074},{category:"Inclusion",indicator:"Difference in number of years of schooling between woman and man, woman to man ratio ",unit:"years",value:5,natural_value:.1},{category:"Inclusion",indicator:"Slavery index",unit:"index",value:1,natural_value:49},{category:"Inclusion",indicator:"Percentage of women aged 25-34 years old that have successfully completed secondary education",unit:"%",value:1,natural_value:.061},{category:"Inclusion",indicator:"Regulations for building construction and equipment, public transport for people with disabilities",unit:"Yes/No",value:5,natural_value:1},{category:"Inclusion",indicator:"Perception of inclusion index",unit:"index",value:3,natural_value:2.3},{category:"Accountability",indicator:"City budget execution publication",unit:"Yes/No",value:5,natural_value:1},{category:"Accountability",indicator:"City budget publication",unit:"Yes/No",value:5,natural_value:1},{category:"Accountability",indicator:"Financial transparency on city government companies",unit:"Yes/No",value:5,natural_value:1},{category:"Accountability",indicator:"ISO certification",unit:"Yes/No",value:1,natural_value:0},{category:"Accountability",indicator:"City council checks and balances",unit:"Yes/No",value:5,natural_value:1},{category:"Accountability",indicator:"Plans to obtain ISO certification",unit:"Yes/No",value:5,natural_value:1},{category:"Accountability",indicator:"Perception of accountability index",unit:"index",value:3,natural_value:.9},{category:"City budget",indicator:"Poor financial condition",unit:"Yes/No",value:1,natural_value:0},{category:"City budget",indicator:"Central/higher level government financial intervention taking place",unit:"Yes/No",value:5,natural_value:0},{category:"City budget",indicator:"Long-term financial planning",unit:"Yes/No",value:1,natural_value:0},{category:"City budget",indicator:"Central/higher level government financial intervention is considered",unit:"Yes/No",value:1,natural_value:0},{category:"City budget",indicator:"Prudent fiscal policy requirements",unit:"Yes/No",value:1,natural_value:0},{category:"City budget",indicator:"Medium-term planning",unit:"Yes/No",value:1,natural_value:0},{category:"SME",indicator:"Number of SMEs per 100,000 population",unit:"per 100,000",value:2,natural_value:13350.342150446195},{category:"SME",indicator:"Number of start-ups",unit:"start-ups",value:3,natural_value:473},{category:"SME",indicator:"Global Startup Ecosystem Index",unit:"index",value:4,natural_value:24.073},{category:"SME",indicator:"Number of SMEs per capita/100 000 population (change in last 3 years)",unit:"%",value:3,natural_value:-7e-4},{category:"SME",indicator:"Number of start-ups (change in last 3 years)",unit:"%",value:3,natural_value:.125},{category:"Public services",indicator:"Free phone to call the police, ambulance, firefighters",unit:"1,2,3,4,5",value:5,natural_value:1},{category:"Public services",indicator:"Services for working with citizens' appeals and complaint",unit:"Yes/No",value:5,natural_value:1},{category:"Public services",indicator:"E-gov services",unit:"Yes/No",value:1,natural_value:0},{category:"Public services",indicator:"Perception of public services index: Public Services",unit:"index",value:3,natural_value:1.77},{category:"Sustainability commitment",indicator:"City ESG reporting",unit:"Yes/No",value:1,natural_value:0},{category:"Sustainability commitment",indicator:"City ESG reporting verification",unit:"Yes/No",value:1,natural_value:0},{category:"Sustainability commitment",indicator:"ESG planning",unit:"Yes/No",value:1,natural_value:0},{category:"Sustainability commitment",indicator:"Plan with specific targets to develop and implement smart city principles",unit:"Yes/No",value:5,natural_value:1},{category:"Sustainability commitment",indicator:"Rollout and status of ESG / UN SDG training across the municipal/asset workforce",unit:"Yes/No",value:1,natural_value:0},{category:"Sustainability commitment",indicator:"City municipality involved in network or partnership promoting sustainable development (for example, C40 Cities network)",unit:"Yes/No",value:5,natural_value:1}]},{city:"Panama City",data:[{category:"Air pollution",indicator:"CO2 emissions",unit:"kt",value:4,natural_value:1.07156422},{category:"Air pollution",indicator:"CO2 emissions (change in last 3 years)",unit:"%",value:3,natural_value:-.049160125068900634},{category:"Air pollution",indicator:"CO2 concentration",unit:"ppm",value:5,natural_value:415.3752444},{category:"Air pollution",indicator:"CO2 concentration (change in last 3 years)",unit:"%",value:5,natural_value:.009762337640858978},{category:"Air pollution",indicator:"Annual average of SO2 concentration in ambient air",unit:"microgram/m3",value:5,natural_value:.565713238},{category:"Air pollution",indicator:"Annual Average of SO2 Concentration in Ambient Air (change in last 3 years)",unit:"%",value:3,natural_value:-.06442138720963429},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air",unit:"microgram/m3",value:4,natural_value:4.8},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air (change in last 3 years), microgram/m3",unit:"%",value:3,natural_value:-.05918882204541039},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air, microgram/m3",unit:"microgram/m3",value:4,natural_value:44.18979582},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air (change in last 3 years), microgram/m3",unit:"%",value:3,natural_value:-.029267096962324747},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air, microgram/m3",unit:"microgram/m3",value:5,natural_value:.107156422},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air (change in last 3 years), microgram/m3",unit:"%",value:3,natural_value:-.049160125068900634},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air, microgram/m3",unit:"microgram/m3",value:5,natural_value:19.10546465},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air (change in last 3 years), microgram/m3",unit:"%",value:3,natural_value:-.17542578581721666},{category:"Air pollution",indicator:"Volatile organic compounds/reactive organic gases emissions",unit:"microgram/m3",value:3,natural_value:1.7},{category:"Air pollution",indicator:"Perception of air pollution index",unit:"index",value:3,natural_value:1.6},{category:"Air pollution",indicator:"Paris Agreement",unit:"Yes/No",value:5,natural_value:1},{category:"Water pollution",indicator:"Annual average of dissolved oxygen (DO) concentration in water",unit:"%",value:4,natural_value:5},{category:"Water pollution",indicator:"Annual average of pH concentration in water",unit:"pH",value:3,natural_value:7.1},{category:"Water pollution",indicator:"Annual average dissolved solids in drinking-water",unit:"ppm",value:4,natural_value:47},{category:"Water pollution",indicator:"Water management strategy in a city",unit:"Yes/No",value:5,natural_value:1},{category:"Water pollution",indicator:"Perception of water pollution index",unit:"index",value:3,natural_value:1.9},{category:"Land use and waste",indicator:"Share of devastated and degraded land area requiring reclamation",unit:"%",value:3,natural_value:7},{category:"Land use and waste",indicator:"3-year average growth rate of devastated and degraded land area requiring reclamation",unit:"%",value:3,natural_value:.002},{category:"Land use and waste",indicator:"Waste deposits",unit:"%",value:3,natural_value:.005},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous)",unit:"kg per capita ",value:5,natural_value:82.12135448591799},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous), (change in last 3 years)",unit:"%",value:3,natural_value:4.2},{category:"Land use and waste",indicator:"Total recycled construction waste",unit:"tons per capita",value:3,natural_value:.02564102564102564},{category:"Land use and waste",indicator:"Share of recycled construction and demolish waste in total generated construction and demolish waste",unit:"%",value:3,natural_value:.249},{category:"Land use and waste",indicator:"Total area of impervious surfaces and percentage to total city area",unit:"%",value:3,natural_value:.02},{category:"Land use and waste",indicator:"Productive urban land (in percent total land)",unit:"%",value:3,natural_value:32.2},{category:"Land use and waste",indicator:"Waste managenet strategy",unit:"Yes/No",value:1,natural_value:0},{category:"Land use and waste",indicator:"Perception of waste index",unit:"index",value:3,natural_value:2.3},{category:"Land use and waste",indicator:"Green spaces, % city area",unit:"%",value:3,natural_value:.21},{category:"Land use and waste",indicator:"Green spaces, change in last 3 years",unit:"%",value:3,natural_value:-.06},{category:"Land use and waste",indicator:"NDVI",unit:"%",value:3,natural_value:.384},{category:"Natural disaster hazards",indicator:"Share of total area with altitude above sea level less than 0,5 meters",unit:"%",value:3,natural_value:.085},{category:"Natural disaster hazards",indicator:"Growth rate of freshwater mirror area",unit:"%",value:3,natural_value:-.06},{category:"Natural disaster hazards",indicator:"Number of registered heavy rain, flood and thunderbolt (change in last 3 years)",unit:"%",value:3,natural_value:-.02},{category:"Natural disaster hazards",indicator:"Number of registered sand storm (change in last 3 years)",unit:"%",value:3,natural_value:-.02},{category:"Natural disaster hazards",indicator:"Environmental/natural disasters risk mitigation",unit:"Yes/No",value:5,natural_value:1},{category:"Natural disaster hazards",indicator:"Strategy/policy/government officials statement on environmental issues ",unit:"Yes/No",value:5,natural_value:1},{category:"Natural disaster hazards",indicator:"Total overall losses from natural disaster hazards",unit:"US$ mln ",value:3,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of days with average daily temperature above the threshold for 1990-2010",unit:"days",value:3,natural_value:15},{category:"Natural disaster hazards",indicator:"Number of disruptions to basic services, attributed to disasters",unit:"%",value:3,natural_value:0},{category:"Water availability",indicator:"Water consumption per capita",unit:"mcm",value:3,natural_value:.507},{category:"Water availability",indicator:"Water tariff to disposable income ratio",unit:"ratio",value:5,natural_value:.0003910710654340107},{category:"Water availability",indicator:"Sanitary facilities tariff to disposable income ratio",unit:"ratio",value:5,natural_value:.0001173213196302032},{category:"Water availability",indicator:"Water consumption per capita (change in last 3 years)",unit:"%",value:3,natural_value:-.004},{category:"Water availability",indicator:"Percentage of population with access to drinking water",unit:"%",value:3,natural_value:.986},{category:"Water availability",indicator:"Percentage of population with access to drinking water (change in last 3 years)",unit:"%",value:3,natural_value:.0016},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities",unit:"%",value:4,natural_value:.97},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities (change in last 3 years)",unit:"%",value:4,natural_value:9e-5},{category:"Food availability",indicator:"Cereal import dependency ratio (5-years average)",unit:"%",value:3,natural_value:.35},{category:"Food availability",indicator:"Cereal import dependency ratio (change in last 3 years)",unit:"%",value:3,natural_value:.002},{category:"Food availability",indicator:"Prevalence of undernourishment",unit:"%",value:3,natural_value:.058},{category:"Food availability",indicator:"Prevalence of undernourishment (change in last 3 years)",unit:"%",value:3,natural_value:-.001999999999999995},{category:"Food availability",indicator:"Prevalence of undernourishment children",unit:"%",value:4,natural_value:.011},{category:"Food availability",indicator:"Prevalence of undernourishment children (change in last 3 years)",unit:"%",value:3,natural_value:-.005000000000000001},{category:"Food availability",indicator:"Prevalence of moderate or severe food insecurity in the population",unit:"%",value:3,natural_value:.26},{category:"Food availability",indicator:"Share of imports in food resources",unit:"%",value:1,natural_value:.66},{category:"Food availability",indicator:"Percentage of people with access to at least one food vendor/retailer within 15 minutes of walking",unit:"%",value:3,natural_value:91},{category:"Food availability",indicator:"Perception of food availability index",unit:"index",value:3,natural_value:2.2},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity",unit:"%",value:3,natural_value:.996},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity (change in last 3 years)",unit:"%",value:3,natural_value:.0003348962072196038},{category:"Energy availability",indicator:"Consumption of electricity per capita",unit:"kWh/person",value:3,natural_value:1838.495873103703},{category:"Energy availability",indicator:"Consumption of electricity per capita (change in last 3 years)",unit:"%",value:4,natural_value:-.029342853464357277},{category:"Energy availability",indicator:"Electricity tariff to disposable income ratio",unit:"ratio",value:5,natural_value:.0001321820201166956},{category:"Energy availability",indicator:"Share of renewable sources in electricity consumption",unit:"%",value:4,natural_value:.349},{category:"Energy availability",indicator:"Perception of energy availability index",unit:"index",value:3,natural_value:1.07},{category:"Health",indicator:"Child mortality rate (under 5 years-old)",unit:"% of live births ",value:3,natural_value:14},{category:"Health",indicator:"City ambulance",unit:"Yes/No",value:5,natural_value:1},{category:"Health",indicator:"Life expectancy at birth, years",unit:"Years",value:5,natural_value:79.91},{category:"Health",indicator:"Life expectancy at birth goals",unit:"categories",value:3,natural_value:2},{category:"Health",indicator:"Number of hospital beds per 1,000 population",unit:"per 1,000",value:3,natural_value:2.25},{category:"Health",indicator:"Number of doctors per 1,000 population",unit:"per 1,000",value:1,natural_value:21.0740203193033},{category:"Health",indicator:"Maternal mortality ratio",unit:"deaths per 1,000 live births",value:3,natural_value:50},{category:"Health",indicator:"Ambulance arrival speed, min",unit:"min",value:5,natural_value:16},{category:"Education",indicator:"Literacy rate among population (15-24 Years)",unit:"%",value:3,natural_value:.988},{category:"Education",indicator:"Literacy rate among population (15-24 Years) (change in last 3 years)",unit:"%",value:3,natural_value:-.0013458966466194378},{category:"Education",indicator:"Primary education engagement",unit:"%",value:2,natural_value:.136},{category:"Education",indicator:"Pupils per teacher rate",unit:"ratio",value:3,natural_value:21.96},{category:"Education",indicator:"Proportion of population with post-secondary and higher education",unit:"%",value:3,natural_value:.267},{category:"Wealth",indicator:"Percentage of population with food expenditure is above 52% of total expenditure",unit:"%",value:3,natural_value:.17},{category:"Wealth",indicator:"Mean monthly salary",unit:"US dollars thousand",value:3,natural_value:1278.54},{category:"Wealth",indicator:"Mean monthly salary, change in last 3 years",unit:"%",value:3,natural_value:.025692033293787775},{category:"Wealth",indicator:"Disposable monthly income",unit:"US dollars thousand",value:2,natural_value:338.4257548066175},{category:"Wealth",indicator:"Disposable monthly income (change in last 3 years)",unit:"%",value:2,natural_value:-.06742304531464682},{category:"Wealth",indicator:"Debt to salary ratio",unit:"ratio",value:3,natural_value:4.732742033882397},{category:"Wealth",indicator:"Number of mobile phones per 1,000 population",unit:"per 1,000",value:3,natural_value:1202.5015122755053},{category:"Wealth",indicator:"Decile income coefficient",unit:"ratio",value:3,natural_value:31.666666666666668},{category:"Wealth",indicator:"Decile income coefficient (change in last 3 years)",unit:"%",value:3,natural_value:-.011987456560442311},{category:"Wealth",indicator:"Poverty headcount ratio at national poverty lines",unit:"%",value:3,natural_value:.0458},{category:"Wealth",indicator:"Working poverty rate (percentage of employed living below US$1.90 PPP), 15+ age (%) ",unit:"%",value:4,natural_value:.008},{category:"Wealth",indicator:"Poverty headcount ratio at $2.15 PPP 2017 a day",unit:"%",value:5,natural_value:.01},{category:"Wealth",indicator:"Living spaces per capita, sq m (change in last 3 years)",unit:"%",value:3,natural_value:.033},{category:"Wealth",indicator:"Population living in slums (% of urban population)",unit:"%",value:3,natural_value:.221},{category:"Wealth",indicator:"Availability of finance (consumer loans)",unit:"%",value:3,natural_value:.43},{category:"Wealth",indicator:"Perception of wealth & poverty index",unit:"index",value:3,natural_value:1.7},{category:"Safety",indicator:"Road fatalities rate per 100,000 population",unit:"per 100,000",value:4,natural_value:4.247303994294455},{category:"Safety",indicator:"Road fatalities rate per 100,000 population (change in last 3 years)",unit:"%",value:3,natural_value:-.051691630918183074},{category:"Safety",indicator:"Violent crime rate per 100,000 population",unit:"per 100,000",value:3,natural_value:10.8},{category:"Safety",indicator:"Violent crime rate per 100,000 population (change in last 3 years)",unit:"%",value:3,natural_value:-.012049365987475635},{category:"Safety",indicator:"Crime rate per 100,000 population",unit:"per 100,000",value:4,natural_value:45.15},{category:"Safety",indicator:"Crime rate per 100,000 population  (change in last 3 years)",unit:"%",value:3,natural_value:-.03},{category:"Safety",indicator:"Police arrival speed",unit:"min",value:3,natural_value:21.7},{category:"Safety",indicator:"Perception of safety index",unit:"index",value:3,natural_value:2.79},{category:"Livability",indicator:"Number of LEED certified green buildings",unit:"Certified square meters per capita",value:5,natural_value:127},{category:"Livability",indicator:"Number of BREEAM certified projects",unit:"Certified square meters per capita",value:1,natural_value:0},{category:"Livability",indicator:"Whether or not the city has ISO 37120 certification",unit:"Yes/No",value:5,natural_value:1},{category:"Livability",indicator:"Mobile connection coverage",unit:"%",value:3,natural_value:.93},{category:"Livability",indicator:"Internet coverage",unit:"%",value:3,natural_value:.9},{category:"Livability",indicator:"Perception of livability index",unit:"index",value:3,natural_value:1.5},{category:"Livability",indicator:"Share of population in 1 km from schools",unit:"%",value:3,natural_value:67.4},{category:"Livability",indicator:"Share of population in 1 km from parks",unit:"%",value:3,natural_value:64.3},{category:"Transport",indicator:"Time loss in traffic",unit:"%",value:2,natural_value:.3918},{category:"Transport",indicator:"Share of the population in 1 km from public transport stop",unit:"%",value:3,natural_value:68.2},{category:"Transport",indicator:"Ratio of the cost of monthly public transport usage Ithe cheapest option) to average mobthly income",unit:"ratio",value:3,natural_value:.04},{category:"Transport",indicator:"Ratio of the cost of a 1-kilometer taxi ride to average mobthly income",unit:"%",value:3,natural_value:.04},{category:"Transport",indicator:"Percentage of city's roads that are segregated and/or has specialized lane for cyclists",unit:"%",value:3,natural_value:.06},{category:"Transport",indicator:"Number of public electric vehicle (EV) charging points per 100,000 population",unit:"per 100,000",value:3,natural_value:1.4},{category:"Transport",indicator:"Public transport (excluding subway) operates by schedule ",unit:"Yes/No",value:5,natural_value:1},{category:"Transport",indicator:"Perception of transport index",unit:"index",value:3,natural_value:1.5},{category:"Inclusion",indicator:"Female-friendly city",unit:"1,2,3,4,5",value:3,natural_value:3},{category:"Inclusion",indicator:"Number of refugees per 1,000 population",unit:"per 1,000",value:1,natural_value:32.98092392553436},{category:"Inclusion",indicator:"Homeless people per 1,000 population",unit:"per 1,000",value:3,natural_value:7.7},{category:"Inclusion",indicator:"Difference in number of years of schooling between woman and man, woman to man ratio ",unit:"years",value:3,natural_value:1.05},{category:"Inclusion",indicator:"Slavery index",unit:"index",value:2,natural_value:33},{category:"Inclusion",indicator:"Percentage of women aged 25-34 years old that have successfully completed secondary education",unit:"%",value:2,natural_value:.3},{category:"Inclusion",indicator:"Regulations for building construction and equipment, public transport for people with disabilities",unit:"Yes/No",value:5,natural_value:1},{category:"Inclusion",indicator:"Perception of inclusion index",unit:"index",value:3,natural_value:2.3},{category:"Accountability",indicator:"City budget execution publication",unit:"Yes/No",value:5,natural_value:1},{category:"Accountability",indicator:"City budget publication",unit:"Yes/No",value:5,natural_value:1},{category:"Accountability",indicator:"Financial transparency on city government companies",unit:"Yes/No",value:1,natural_value:0},{category:"Accountability",indicator:"ISO certification",unit:"Yes/No",value:5,natural_value:1},{category:"Accountability",indicator:"City council checks and balances",unit:"Yes/No",value:5,natural_value:1},{category:"Accountability",indicator:"Plans to obtain ISO certification",unit:"Yes/No",value:1,natural_value:0},{category:"Accountability",indicator:"Perception of accountability index",unit:"index",value:3,natural_value:.9},{category:"City budget",indicator:"Poor financial condition",unit:"Yes/No",value:5,natural_value:0},{category:"City budget",indicator:"Central/higher level government financial intervention taking place",unit:"Yes/No",value:5,natural_value:0},{category:"City budget",indicator:"Long-term financial planning",unit:"Yes/No",value:5,natural_value:1},{category:"City budget",indicator:"Central/higher level government financial intervention is considered",unit:"Yes/No",value:1,natural_value:0},{category:"City budget",indicator:"Prudent fiscal policy requirements",unit:"Yes/No",value:5,natural_value:1},{category:"City budget",indicator:"Medium-term planning",unit:"Yes/No",value:5,natural_value:1},{category:"SME",indicator:"Number of SMEs per 100,000 population",unit:"per 100,000",value:3,natural_value:1188.4164559871294},{category:"SME",indicator:"Number of start-ups",unit:"start-ups",value:3,natural_value:775},{category:"SME",indicator:"Global Startup Ecosystem Index",unit:"index",value:5,natural_value:.662},{category:"SME",indicator:"Number of SMEs per capita/100 000 population (change in last 3 years)",unit:"%",value:3,natural_value:-.060895231200825406},{category:"SME",indicator:"Number of start-ups (change in last 3 years)",unit:"%",value:3,natural_value:.125},{category:"Public services",indicator:"Free phone to call the police, ambulance, firefighters",unit:"1,2,3,4,5",value:5,natural_value:1},{category:"Public services",indicator:"Services for working with citizens' appeals and complaint",unit:"Yes/No",value:5,natural_value:1},{category:"Public services",indicator:"E-gov services",unit:"Yes/No",value:1,natural_value:0},{category:"Public services",indicator:"Perception of public services index: Public Services",unit:"index",value:3,natural_value:1.77},{category:"Sustainability commitment",indicator:"City ESG reporting",unit:"Yes/No",value:5,natural_value:1},{category:"Sustainability commitment",indicator:"City ESG reporting verification",unit:"Yes/No",value:5,natural_value:1},{category:"Sustainability commitment",indicator:"ESG planning",unit:"Yes/No",value:5,natural_value:1},{category:"Sustainability commitment",indicator:"Plan with specific targets to develop and implement smart city principles",unit:"Yes/No",value:5,natural_value:1},{category:"Sustainability commitment",indicator:"Rollout and status of ESG / UN SDG training across the municipal/asset workforce",unit:"Yes/No",value:1,natural_value:0},{category:"Sustainability commitment",indicator:"City municipality involved in network or partnership promoting sustainable development (for example, C40 Cities network)",unit:"Yes/No",value:5,natural_value:1}]},{city:"Amman",data:[{category:"Air pollution",indicator:"CO2 emissions",unit:"kt",value:4,natural_value:2.29819392},{category:"Air pollution",indicator:"CO2 emissions (change in last 3 years)",unit:"%",value:3,natural_value:-.0397125056600682},{category:"Air pollution",indicator:"CO2 concentration",unit:"ppm",value:4,natural_value:424.0303438},{category:"Air pollution",indicator:"CO2 concentration (change in last 3 years)",unit:"%",value:5,natural_value:.010229294125018148},{category:"Air pollution",indicator:"Annual average of SO2 concentration in ambient air",unit:"microgram/m3",value:3,natural_value:19.05745758},{category:"Air pollution",indicator:"Annual Average of SO2 Concentration in Ambient Air (change in last 3 years)",unit:"%",value:3,natural_value:-.007976779262179951},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air",unit:"microgram/m3",value:2,natural_value:27.8},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air (change in last 3 years), microgram/m3",unit:"%",value:3,natural_value:.002166534267350411},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air, microgram/m3",unit:"microgram/m3",value:2,natural_value:63.70975559},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air (change in last 3 years), microgram/m3",unit:"%",value:3,natural_value:-.008936926031556151},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air, microgram/m3",unit:"microgram/m3",value:4,natural_value:.229819392},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air (change in last 3 years), microgram/m3",unit:"%",value:3,natural_value:-.0397125056600682},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air, microgram/m3",unit:"microgram/m3",value:4,natural_value:56.1712303},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air (change in last 3 years), microgram/m3",unit:"%",value:3,natural_value:-.02113665705443046},{category:"Air pollution",indicator:"Volatile organic compounds/reactive organic gases emissions",unit:"microgram/m3",value:3,natural_value:1.7},{category:"Air pollution",indicator:"Perception of air pollution index",unit:"index",value:3,natural_value:1.6},{category:"Air pollution",indicator:"Paris Agreement",unit:"Yes/No",value:5,natural_value:1},{category:"Water pollution",indicator:"Annual average of dissolved oxygen (DO) concentration in water",unit:"%",value:3,natural_value:6.08},{category:"Water pollution",indicator:"Annual average of pH concentration in water",unit:"pH",value:3,natural_value:7.1},{category:"Water pollution",indicator:"Annual average dissolved solids in drinking-water",unit:"ppm",value:2,natural_value:319.4},{category:"Water pollution",indicator:"Water management strategy in a city",unit:"Yes/No",value:5,natural_value:1},{category:"Water pollution",indicator:"Perception of water pollution index",unit:"index",value:3,natural_value:1.9},{category:"Land use and waste",indicator:"Share of devastated and degraded land area requiring reclamation",unit:"%",value:2,natural_value:23},{category:"Land use and waste",indicator:"3-year average growth rate of devastated and degraded land area requiring reclamation",unit:"%",value:3,natural_value:.002},{category:"Land use and waste",indicator:"Waste deposits",unit:"%",value:3,natural_value:.009},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous)",unit:"kg per capita ",value:3,natural_value:635},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous), (change in last 3 years)",unit:"%",value:3,natural_value:4.2},{category:"Land use and waste",indicator:"Total recycled construction waste",unit:"tons per capita",value:3,natural_value:1.7},{category:"Land use and waste",indicator:"Share of recycled construction and demolish waste in total generated construction and demolish waste",unit:"%",value:2,natural_value:.07},{category:"Land use and waste",indicator:"Total area of impervious surfaces and percentage to total city area",unit:"%",value:4,natural_value:.00578},{category:"Land use and waste",indicator:"Productive urban land (in percent total land)",unit:"%",value:3,natural_value:32.2},{category:"Land use and waste",indicator:"Waste managenet strategy",unit:"Yes/No",value:5,natural_value:1},{category:"Land use and waste",indicator:"Perception of waste index",unit:"index",value:3,natural_value:2.3},{category:"Land use and waste",indicator:"Green spaces, % city area",unit:"%",value:3,natural_value:.21},{category:"Land use and waste",indicator:"Green spaces, change in last 3 years",unit:"%",value:3,natural_value:-.06},{category:"Land use and waste",indicator:"NDVI",unit:"%",value:4,natural_value:.159},{category:"Natural disaster hazards",indicator:"Share of total area with altitude above sea level less than 0,5 meters",unit:"%",value:3,natural_value:.085},{category:"Natural disaster hazards",indicator:"Growth rate of freshwater mirror area",unit:"%",value:3,natural_value:-.06},{category:"Natural disaster hazards",indicator:"Number of registered heavy rain, flood and thunderbolt (change in last 3 years)",unit:"%",value:4,natural_value:-.115709},{category:"Natural disaster hazards",indicator:"Number of registered sand storm (change in last 3 years)",unit:"%",value:4,natural_value:-.115709},{category:"Natural disaster hazards",indicator:"Environmental/natural disasters risk mitigation",unit:"Yes/No",value:5,natural_value:1},{category:"Natural disaster hazards",indicator:"Strategy/policy/government officials statement on environmental issues ",unit:"Yes/No",value:5,natural_value:1},{category:"Natural disaster hazards",indicator:"Total overall losses from natural disaster hazards",unit:"US$ mln ",value:3,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of days with average daily temperature above the threshold for 1990-2010",unit:"days",value:3,natural_value:15},{category:"Natural disaster hazards",indicator:"Number of disruptions to basic services, attributed to disasters",unit:"%",value:3,natural_value:0},{category:"Water availability",indicator:"Water consumption per capita",unit:"mcm",value:3,natural_value:61e-6},{category:"Water availability",indicator:"Water tariff to disposable income ratio",unit:"ratio",value:3,natural_value:1.29},{category:"Water availability",indicator:"Sanitary facilities tariff to disposable income ratio",unit:"ratio",value:3,natural_value:1.1},{category:"Water availability",indicator:"Water consumption per capita (change in last 3 years)",unit:"%",value:3,natural_value:.037490119437293856},{category:"Water availability",indicator:"Percentage of population with access to drinking water",unit:"%",value:3,natural_value:.98},{category:"Water availability",indicator:"Percentage of population with access to drinking water (change in last 3 years)",unit:"%",value:3,natural_value:-337e-6},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities",unit:"%",value:4,natural_value:.971},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities (change in last 3 years)",unit:"%",value:4,natural_value:-343e-6},{category:"Food availability",indicator:"Cereal import dependency ratio (5-years average)",unit:"%",value:1,natural_value:1},{category:"Food availability",indicator:"Cereal import dependency ratio (change in last 3 years)",unit:"%",value:3,natural_value:.002},{category:"Food availability",indicator:"Prevalence of undernourishment",unit:"%",value:3,natural_value:.169},{category:"Food availability",indicator:"Prevalence of undernourishment (change in last 3 years)",unit:"%",value:3,natural_value:.05700000000000001},{category:"Food availability",indicator:"Prevalence of undernourishment children",unit:"%",value:4,natural_value:.006},{category:"Food availability",indicator:"Prevalence of undernourishment children (change in last 3 years)",unit:"%",value:3,natural_value:-.018000000000000002},{category:"Food availability",indicator:"Prevalence of moderate or severe food insecurity in the population",unit:"%",value:3,natural_value:.26},{category:"Food availability",indicator:"Share of imports in food resources",unit:"%",value:3,natural_value:.43},{category:"Food availability",indicator:"Percentage of people with access to at least one food vendor/retailer within 15 minutes of walking",unit:"%",value:3,natural_value:91},{category:"Food availability",indicator:"Perception of food availability index",unit:"index",value:3,natural_value:2.2},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity",unit:"%",value:5,natural_value:1},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity (change in last 3 years)",unit:"%",value:3,natural_value:.01},{category:"Energy availability",indicator:"Consumption of electricity per capita",unit:"kWh/person",value:3,natural_value:4171},{category:"Energy availability",indicator:"Consumption of electricity per capita (change in last 3 years)",unit:"%",value:3,natural_value:.04},{category:"Energy availability",indicator:"Electricity tariff to disposable income ratio",unit:"ratio",value:3,natural_value:.1},{category:"Energy availability",indicator:"Share of renewable sources in electricity consumption",unit:"%",value:2,natural_value:.1104},{category:"Energy availability",indicator:"Perception of energy availability index",unit:"index",value:3,natural_value:1.07},{category:"Health",indicator:"Child mortality rate (under 5 years-old)",unit:"% of live births ",value:3,natural_value:14.6},{category:"Health",indicator:"City ambulance",unit:"Yes/No",value:5,natural_value:1},{category:"Health",indicator:"Life expectancy at birth, years",unit:"Years",value:4,natural_value:77.9},{category:"Health",indicator:"Life expectancy at birth goals",unit:"categories",value:1,natural_value:1},{category:"Health",indicator:"Number of hospital beds per 1,000 population",unit:"per 1,000",value:3,natural_value:1.47},{category:"Health",indicator:"Number of doctors per 1,000 population",unit:"per 1,000",value:3,natural_value:2.5},{category:"Health",indicator:"Maternal mortality ratio",unit:"deaths per 1,000 live births",value:4,natural_value:41},{category:"Health",indicator:"Ambulance arrival speed, min",unit:"min",value:5,natural_value:8.8},{category:"Education",indicator:"Literacy rate among population (15-24 Years)",unit:"%",value:4,natural_value:.994199982},{category:"Education",indicator:"Literacy rate among population (15-24 Years) (change in last 3 years)",unit:"%",value:3,natural_value:312e-6},{category:"Education",indicator:"Primary education engagement",unit:"%",value:3,natural_value:.5406670007324498},{category:"Education",indicator:"Pupils per teacher rate",unit:"ratio",value:3,natural_value:18.5},{category:"Education",indicator:"Proportion of population with post-secondary and higher education",unit:"%",value:3,natural_value:.325574417114258},{category:"Wealth",indicator:"Percentage of population with food expenditure is above 52% of total expenditure",unit:"%",value:4,natural_value:.071},{category:"Wealth",indicator:"Mean monthly salary",unit:"US dollars thousand",value:3,natural_value:2284.29},{category:"Wealth",indicator:"Mean monthly salary, change in last 3 years",unit:"%",value:3,natural_value:.01098},{category:"Wealth",indicator:"Disposable monthly income",unit:"US dollars thousand",value:3,natural_value:595.7819488480237},{category:"Wealth",indicator:"Disposable monthly income (change in last 3 years)",unit:"%",value:3,natural_value:.04442},{category:"Wealth",indicator:"Debt to salary ratio",unit:"ratio",value:5,natural_value:.088},{category:"Wealth",indicator:"Number of mobile phones per 1,000 population",unit:"per 1,000",value:4,natural_value:675.6799743},{category:"Wealth",indicator:"Decile income coefficient",unit:"ratio",value:4,natural_value:7.857142857142857},{category:"Wealth",indicator:"Decile income coefficient (change in last 3 years)",unit:"%",value:3,natural_value:-.011548},{category:"Wealth",indicator:"Poverty headcount ratio at national poverty lines",unit:"%",value:3,natural_value:.157},{category:"Wealth",indicator:"Working poverty rate (percentage of employed living below US$1.90 PPP), 15+ age (%) ",unit:"%",value:1,natural_value:.2},{category:"Wealth",indicator:"Poverty headcount ratio at $2.15 PPP 2017 a day",unit:"%",value:1,natural_value:.1},{category:"Wealth",indicator:"Living spaces per capita, sq m (change in last 3 years)",unit:"%",value:3,natural_value:.033},{category:"Wealth",indicator:"Population living in slums (% of urban population)",unit:"%",value:3,natural_value:.17},{category:"Wealth",indicator:"Availability of finance (consumer loans)",unit:"%",value:3,natural_value:.43},{category:"Wealth",indicator:"Perception of wealth & poverty index",unit:"index",value:3,natural_value:1.7},{category:"Safety",indicator:"Road fatalities rate per 100,000 population",unit:"per 100,000",value:2,natural_value:19.68},{category:"Safety",indicator:"Road fatalities rate per 100,000 population (change in last 3 years)",unit:"%",value:3,natural_value:-.095554},{category:"Safety",indicator:"Violent crime rate per 100,000 population",unit:"per 100,000",value:3,natural_value:11.418181818181818},{category:"Safety",indicator:"Violent crime rate per 100,000 population (change in last 3 years)",unit:"%",value:2,natural_value:.075114},{category:"Safety",indicator:"Crime rate per 100,000 population",unit:"per 100,000",value:3,natural_value:530.1151894060845},{category:"Safety",indicator:"Crime rate per 100,000 population  (change in last 3 years)",unit:"%",value:3,natural_value:-.03},{category:"Safety",indicator:"Police arrival speed",unit:"min",value:3,natural_value:21.7},{category:"Safety",indicator:"Perception of safety index",unit:"index",value:3,natural_value:2.79},{category:"Livability",indicator:"Number of LEED certified green buildings",unit:"Certified square meters per capita",value:4,natural_value:21.55},{category:"Livability",indicator:"Number of BREEAM certified projects",unit:"Certified square meters per capita",value:1,natural_value:0},{category:"Livability",indicator:"Whether or not the city has ISO 37120 certification",unit:"Yes/No",value:5,natural_value:1},{category:"Livability",indicator:"Mobile connection coverage",unit:"%",value:3,natural_value:.93},{category:"Livability",indicator:"Internet coverage",unit:"%",value:3,natural_value:.9},{category:"Livability",indicator:"Perception of livability index",unit:"index",value:3,natural_value:1.5},{category:"Livability",indicator:"Share of population in 1 km from schools",unit:"%",value:3,natural_value:37.6},{category:"Livability",indicator:"Share of population in 1 km from parks",unit:"%",value:3,natural_value:64.3},{category:"Transport",indicator:"Time loss in traffic",unit:"%",value:2,natural_value:.3768},{category:"Transport",indicator:"Share of the population in 1 km from public transport stop",unit:"%",value:3,natural_value:29.1},{category:"Transport",indicator:"Ratio of the cost of monthly public transport usage Ithe cheapest option) to average mobthly income",unit:"ratio",value:5,natural_value:.01751091148672016},{category:"Transport",indicator:"Ratio of the cost of a 1-kilometer taxi ride to average mobthly income",unit:"%",value:5,natural_value:.0006566591807520061},{category:"Transport",indicator:"Percentage of city's roads that are segregated and/or has specialized lane for cyclists",unit:"%",value:3,natural_value:.06},{category:"Transport",indicator:"Number of public electric vehicle (EV) charging points per 100,000 population",unit:"per 100,000",value:2,natural_value:.28846153846153844},{category:"Transport",indicator:"Public transport (excluding subway) operates by schedule ",unit:"Yes/No",value:5,natural_value:1},{category:"Transport",indicator:"Perception of transport index",unit:"index",value:3,natural_value:1.5},{category:"Inclusion",indicator:"Female-friendly city",unit:"1,2,3,4,5",value:5,natural_value:1},{category:"Inclusion",indicator:"Number of refugees per 1,000 population",unit:"per 1,000",value:3,natural_value:4.1},{category:"Inclusion",indicator:"Homeless people per 1,000 population",unit:"per 1,000",value:3,natural_value:7.7},{category:"Inclusion",indicator:"Difference in number of years of schooling between woman and man, woman to man ratio ",unit:"years",value:3,natural_value:.93},{category:"Inclusion",indicator:"Slavery index",unit:"index",value:1,natural_value:49},{category:"Inclusion",indicator:"Percentage of women aged 25-34 years old that have successfully completed secondary education",unit:"%",value:3,natural_value:.41},{category:"Inclusion",indicator:"Regulations for building construction and equipment, public transport for people with disabilities",unit:"Yes/No",value:5,natural_value:1},{category:"Inclusion",indicator:"Perception of inclusion index",unit:"index",value:3,natural_value:2.3},{category:"Accountability",indicator:"City budget execution publication",unit:"Yes/No",value:5,natural_value:1},{category:"Accountability",indicator:"City budget publication",unit:"Yes/No",value:5,natural_value:1},{category:"Accountability",indicator:"Financial transparency on city government companies",unit:"Yes/No",value:1,natural_value:0},{category:"Accountability",indicator:"ISO certification",unit:"Yes/No",value:5,natural_value:1},{category:"Accountability",indicator:"City council checks and balances",unit:"Yes/No",value:5,natural_value:1},{category:"Accountability",indicator:"Plans to obtain ISO certification",unit:"Yes/No",value:5,natural_value:1},{category:"Accountability",indicator:"Perception of accountability index",unit:"index",value:3,natural_value:.9},{category:"City budget",indicator:"Poor financial condition",unit:"Yes/No",value:5,natural_value:0},{category:"City budget",indicator:"Central/higher level government financial intervention taking place",unit:"Yes/No",value:5,natural_value:0},{category:"City budget",indicator:"Long-term financial planning",unit:"Yes/No",value:1,natural_value:0},{category:"City budget",indicator:"Central/higher level government financial intervention is considered",unit:"Yes/No",value:1,natural_value:0},{category:"City budget",indicator:"Prudent fiscal policy requirements",unit:"Yes/No",value:1,natural_value:0},{category:"City budget",indicator:"Medium-term planning",unit:"Yes/No",value:5,natural_value:1},{category:"SME",indicator:"Number of SMEs per 100,000 population",unit:"per 100,000",value:3,natural_value:9336},{category:"SME",indicator:"Number of start-ups",unit:"start-ups",value:2,natural_value:80},{category:"SME",indicator:"Global Startup Ecosystem Index",unit:"index",value:2,natural_value:2.425},{category:"SME",indicator:"Number of SMEs per capita/100 000 population (change in last 3 years)",unit:"%",value:3,natural_value:-7e-4},{category:"SME",indicator:"Number of start-ups (change in last 3 years)",unit:"%",value:3,natural_value:.125},{category:"Public services",indicator:"Free phone to call the police, ambulance, firefighters",unit:"1,2,3,4,5",value:1,natural_value:0},{category:"Public services",indicator:"Services for working with citizens' appeals and complaint",unit:"Yes/No",value:5,natural_value:1},{category:"Public services",indicator:"E-gov services",unit:"Yes/No",value:5,natural_value:1},{category:"Public services",indicator:"Perception of public services index: Public Services",unit:"index",value:3,natural_value:1.77},{category:"Sustainability commitment",indicator:"City ESG reporting",unit:"Yes/No",value:1,natural_value:0},{category:"Sustainability commitment",indicator:"City ESG reporting verification",unit:"Yes/No",value:1,natural_value:0},{category:"Sustainability commitment",indicator:"ESG planning",unit:"Yes/No",value:5,natural_value:1},{category:"Sustainability commitment",indicator:"Plan with specific targets to develop and implement smart city principles",unit:"Yes/No",value:5,natural_value:1},{category:"Sustainability commitment",indicator:"Rollout and status of ESG / UN SDG training across the municipal/asset workforce",unit:"Yes/No",value:1,natural_value:0},{category:"Sustainability commitment",indicator:"City municipality involved in network or partnership promoting sustainable development (for example, C40 Cities network)",unit:"Yes/No",value:5,natural_value:1}]},{city:"Bangkok",data:[{category:"Air pollution",indicator:"CO2 emissions",unit:"kt",value:3,natural_value:4.43369794},{category:"Air pollution",indicator:"CO2 emissions (change in last 3 years)",unit:"%",value:3,natural_value:.07848997390501591},{category:"Air pollution",indicator:"CO2 concentration",unit:"ppm",value:2,natural_value:460.5116023},{category:"Air pollution",indicator:"CO2 concentration (change in last 3 years)",unit:"%",value:5,natural_value:.0058540614082655705},{category:"Air pollution",indicator:"Annual average of SO2 concentration in ambient air",unit:"microgram/m3",value:3,natural_value:23.48326534},{category:"Air pollution",indicator:"Annual Average of SO2 Concentration in Ambient Air (change in last 3 years)",unit:"%",value:3,natural_value:.09924267894029333},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air",unit:"microgram/m3",value:3,natural_value:21.5},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air (change in last 3 years), microgram/m3",unit:"%",value:3,natural_value:.09681541685835517},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air, microgram/m3",unit:"microgram/m3",value:5,natural_value:40.72419549},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air (change in last 3 years), microgram/m3",unit:"%",value:3,natural_value:-.07769443975402442},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air, microgram/m3",unit:"microgram/m3",value:3,natural_value:.443369794},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air (change in last 3 years), microgram/m3",unit:"%",value:3,natural_value:.07848997390501591},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air, microgram/m3",unit:"microgram/m3",value:3,natural_value:80.77055411},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air (change in last 3 years), microgram/m3",unit:"%",value:3,natural_value:.0716916595957008},{category:"Air pollution",indicator:"Volatile organic compounds/reactive organic gases emissions",unit:"microgram/m3",value:3,natural_value:1.7},{category:"Air pollution",indicator:"Perception of air pollution index",unit:"index",value:3,natural_value:1.6},{category:"Air pollution",indicator:"Paris Agreement",unit:"Yes/No",value:5,natural_value:1},{category:"Water pollution",indicator:"Annual average of dissolved oxygen (DO) concentration in water",unit:"%",value:3,natural_value:6.08},{category:"Water pollution",indicator:"Annual average of pH concentration in water",unit:"pH",value:3,natural_value:7.1},{category:"Water pollution",indicator:"Annual average dissolved solids in drinking-water",unit:"ppm",value:3,natural_value:139},{category:"Water pollution",indicator:"Water management strategy in a city",unit:"Yes/No",value:5,natural_value:0},{category:"Water pollution",indicator:"Perception of water pollution index",unit:"index",value:3,natural_value:1.9},{category:"Land use and waste",indicator:"Share of devastated and degraded land area requiring reclamation",unit:"%",value:2,natural_value:21},{category:"Land use and waste",indicator:"3-year average growth rate of devastated and degraded land area requiring reclamation",unit:"%",value:3,natural_value:.002},{category:"Land use and waste",indicator:"Waste deposits",unit:"%",value:3,natural_value:.009},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous)",unit:"kg per capita ",value:3,natural_value:635},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous), (change in last 3 years)",unit:"%",value:3,natural_value:4.2},{category:"Land use and waste",indicator:"Total recycled construction waste",unit:"tons per capita",value:3,natural_value:1.7},{category:"Land use and waste",indicator:"Share of recycled construction and demolish waste in total generated construction and demolish waste",unit:"%",value:3,natural_value:.249},{category:"Land use and waste",indicator:"Total area of impervious surfaces and percentage to total city area",unit:"%",value:4,natural_value:.010827876520112254},{category:"Land use and waste",indicator:"Productive urban land (in percent total land)",unit:"%",value:3,natural_value:32.2},{category:"Land use and waste",indicator:"Waste managenet strategy",unit:"Yes/No",value:5,natural_value:1},{category:"Land use and waste",indicator:"Perception of waste index",unit:"index",value:3,natural_value:2.3},{category:"Land use and waste",indicator:"Green spaces, % city area",unit:"%",value:3,natural_value:.21},{category:"Land use and waste",indicator:"Green spaces, change in last 3 years",unit:"%",value:3,natural_value:-.06},{category:"Land use and waste",indicator:"NDVI",unit:"%",value:3,natural_value:.373},{category:"Natural disaster hazards",indicator:"Share of total area with altitude above sea level less than 0,5 meters",unit:"%",value:3,natural_value:.085},{category:"Natural disaster hazards",indicator:"Growth rate of freshwater mirror area",unit:"%",value:3,natural_value:-.06},{category:"Natural disaster hazards",indicator:"Number of registered heavy rain, flood and thunderbolt (change in last 3 years)",unit:"%",value:1,natural_value:.5},{category:"Natural disaster hazards",indicator:"Number of registered sand storm (change in last 3 years)",unit:"%",value:1,natural_value:.5},{category:"Natural disaster hazards",indicator:"Environmental/natural disasters risk mitigation",unit:"Yes/No",value:5,natural_value:1},{category:"Natural disaster hazards",indicator:"Strategy/policy/government officials statement on environmental issues ",unit:"Yes/No",value:5,natural_value:1},{category:"Natural disaster hazards",indicator:"Total overall losses from natural disaster hazards",unit:"US$ mln ",value:2,natural_value:606.681668405105},{category:"Natural disaster hazards",indicator:"Number of days with average daily temperature above the threshold for 1990-2010",unit:"days",value:3,natural_value:1},{category:"Natural disaster hazards",indicator:"Number of disruptions to basic services, attributed to disasters",unit:"%",value:3,natural_value:0},{category:"Water availability",indicator:"Water consumption per capita",unit:"mcm",value:3,natural_value:1095e-7},{category:"Water availability",indicator:"Water tariff to disposable income ratio",unit:"ratio",value:4,natural_value:.01731179318646874},{category:"Water availability",indicator:"Sanitary facilities tariff to disposable income ratio",unit:"ratio",value:3,natural_value:1.1},{category:"Water availability",indicator:"Water consumption per capita (change in last 3 years)",unit:"%",value:5,natural_value:-.004},{category:"Water availability",indicator:"Percentage of population with access to drinking water",unit:"%",value:5,natural_value:.99},{category:"Water availability",indicator:"Percentage of population with access to drinking water (change in last 3 years)",unit:"%",value:3,natural_value:.0016},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities",unit:"%",value:4,natural_value:.987},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities (change in last 3 years)",unit:"%",value:4,natural_value:.002035},{category:"Food availability",indicator:"Cereal import dependency ratio (5-years average)",unit:"%",value:2,natural_value:.57},{category:"Food availability",indicator:"Cereal import dependency ratio (change in last 3 years)",unit:"%",value:3,natural_value:.002},{category:"Food availability",indicator:"Prevalence of undernourishment",unit:"%",value:3,natural_value:.052},{category:"Food availability",indicator:"Prevalence of undernourishment (change in last 3 years)",unit:"%",value:3,natural_value:-.008},{category:"Food availability",indicator:"Prevalence of undernourishment children",unit:"%",value:4,natural_value:.077},{category:"Food availability",indicator:"Prevalence of undernourishment children (change in last 3 years)",unit:"%",value:5,natural_value:.023},{category:"Food availability",indicator:"Prevalence of moderate or severe food insecurity in the population",unit:"%",value:5,natural_value:.071},{category:"Food availability",indicator:"Share of imports in food resources",unit:"%",value:5,natural_value:.04},{category:"Food availability",indicator:"Percentage of people with access to at least one food vendor/retailer within 15 minutes of walking",unit:"%",value:3,natural_value:91},{category:"Food availability",indicator:"Perception of food availability index",unit:"index",value:3,natural_value:2.2},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity",unit:"%",value:5,natural_value:1},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity (change in last 3 years)",unit:"%",value:3,natural_value:601e-6},{category:"Energy availability",indicator:"Consumption of electricity per capita",unit:"kWh/person",value:3,natural_value:3748.45273},{category:"Energy availability",indicator:"Consumption of electricity per capita (change in last 3 years)",unit:"%",value:3,natural_value:.04},{category:"Energy availability",indicator:"Electricity tariff to disposable income ratio",unit:"ratio",value:5,natural_value:.001137782160890261},{category:"Energy availability",indicator:"Share of renewable sources in electricity consumption",unit:"%",value:2,natural_value:.1526},{category:"Energy availability",indicator:"Perception of energy availability index",unit:"index",value:3,natural_value:1.07},{category:"Health",indicator:"Child mortality rate (under 5 years-old)",unit:"% of live births ",value:3,natural_value:8.29},{category:"Health",indicator:"City ambulance",unit:"Yes/No",value:5,natural_value:1},{category:"Health",indicator:"Life expectancy at birth, years",unit:"Years",value:4,natural_value:77.74},{category:"Health",indicator:"Life expectancy at birth goals",unit:"categories",value:5,natural_value:3},{category:"Health",indicator:"Number of hospital beds per 1,000 population",unit:"per 1,000",value:3,natural_value:2.41},{category:"Health",indicator:"Number of doctors per 1,000 population",unit:"per 1,000",value:4,natural_value:.95},{category:"Health",indicator:"Maternal mortality ratio",unit:"deaths per 1,000 live births",value:4,natural_value:29},{category:"Health",indicator:"Ambulance arrival speed, min",unit:"min",value:1,natural_value:300},{category:"Education",indicator:"Literacy rate among population (15-24 Years)",unit:"%",value:3,natural_value:.988000030517578},{category:"Education",indicator:"Literacy rate among population (15-24 Years) (change in last 3 years)",unit:"%",value:3,natural_value:943e-6},{category:"Education",indicator:"Primary education engagement",unit:"%",value:3,natural_value:.484145},{category:"Education",indicator:"Pupils per teacher rate",unit:"ratio",value:3,natural_value:16.6},{category:"Education",indicator:"Proportion of population with post-secondary and higher education",unit:"%",value:2,natural_value:.129012299},{category:"Wealth",indicator:"Percentage of population with food expenditure is above 52% of total expenditure",unit:"%",value:3,natural_value:.18},{category:"Wealth",indicator:"Mean monthly salary",unit:"US dollars thousand",value:2,natural_value:420.54},{category:"Wealth",indicator:"Mean monthly salary, change in last 3 years",unit:"%",value:3,natural_value:.016679},{category:"Wealth",indicator:"Disposable monthly income",unit:"US dollars thousand",value:3,natural_value:571.2868617059399},{category:"Wealth",indicator:"Disposable monthly income (change in last 3 years)",unit:"%",value:3,natural_value:-.024122},{category:"Wealth",indicator:"Debt to salary ratio",unit:"ratio",value:5,natural_value:.2270070622615472},{category:"Wealth",indicator:"Number of mobile phones per 1,000 population",unit:"per 1,000",value:4,natural_value:1763.169269},{category:"Wealth",indicator:"Decile income coefficient",unit:"ratio",value:4,natural_value:8.53125},{category:"Wealth",indicator:"Decile income coefficient (change in last 3 years)",unit:"%",value:3,natural_value:.011596},{category:"Wealth",indicator:"Poverty headcount ratio at national poverty lines",unit:"%",value:3,natural_value:.063},{category:"Wealth",indicator:"Working poverty rate (percentage of employed living below US$1.90 PPP), 15+ age (%) ",unit:"%",value:2,natural_value:.1},{category:"Wealth",indicator:"Poverty headcount ratio at $2.15 PPP 2017 a day",unit:"%",value:2,natural_value:.04},{category:"Wealth",indicator:"Living spaces per capita, sq m (change in last 3 years)",unit:"%",value:3,natural_value:.033},{category:"Wealth",indicator:"Population living in slums (% of urban population)",unit:"%",value:4,natural_value:.0679482},{category:"Wealth",indicator:"Availability of finance (consumer loans)",unit:"%",value:3,natural_value:.43},{category:"Wealth",indicator:"Perception of wealth & poverty index",unit:"index",value:3,natural_value:1.7},{category:"Safety",indicator:"Road fatalities rate per 100,000 population",unit:"per 100,000",value:2,natural_value:30.48},{category:"Safety",indicator:"Road fatalities rate per 100,000 population (change in last 3 years)",unit:"%",value:3,natural_value:-.0137},{category:"Safety",indicator:"Violent crime rate per 100,000 population",unit:"per 100,000",value:4,natural_value:2.58},{category:"Safety",indicator:"Violent crime rate per 100,000 population (change in last 3 years)",unit:"%",value:2,natural_value:.0481278275098662},{category:"Safety",indicator:"Crime rate per 100,000 population",unit:"per 100,000",value:4,natural_value:40.55},{category:"Safety",indicator:"Crime rate per 100,000 population  (change in last 3 years)",unit:"%",value:3,natural_value:-.03},{category:"Safety",indicator:"Police arrival speed",unit:"min",value:3,natural_value:20},{category:"Safety",indicator:"Perception of safety index",unit:"index",value:3,natural_value:2.79},{category:"Livability",indicator:"Number of LEED certified green buildings",unit:"Certified square meters per capita",value:4,natural_value:21.55},{category:"Livability",indicator:"Number of BREEAM certified projects",unit:"Certified square meters per capita",value:1,natural_value:0},{category:"Livability",indicator:"Whether or not the city has ISO 37120 certification",unit:"Yes/No",value:1,natural_value:0},{category:"Livability",indicator:"Mobile connection coverage",unit:"%",value:5,natural_value:1},{category:"Livability",indicator:"Internet coverage",unit:"%",value:5,natural_value:1},{category:"Livability",indicator:"Perception of livability index",unit:"index",value:3,natural_value:1.5},{category:"Livability",indicator:"Share of population in 1 km from schools",unit:"%",value:3,natural_value:29.4},{category:"Livability",indicator:"Share of population in 1 km from parks",unit:"%",value:3,natural_value:64.3},{category:"Transport",indicator:"Time loss in traffic",unit:"%",value:1,natural_value:.6456},{category:"Transport",indicator:"Share of the population in 1 km from public transport stop",unit:"%",value:3,natural_value:55.1},{category:"Transport",indicator:"Ratio of the cost of monthly public transport usage Ithe cheapest option) to average mobthly income",unit:"ratio",value:5,natural_value:.09120895596981358},{category:"Transport",indicator:"Ratio of the cost of a 1-kilometer taxi ride to average mobthly income",unit:"%",value:5,natural_value:.002687021448613687},{category:"Transport",indicator:"Percentage of city's roads that are segregated and/or has specialized lane for cyclists",unit:"%",value:3,natural_value:.06},{category:"Transport",indicator:"Number of public electric vehicle (EV) charging points per 100,000 population",unit:"per 100,000",value:5,natural_value:3.191340782122905},{category:"Transport",indicator:"Public transport (excluding subway) operates by schedule ",unit:"Yes/No",value:5,natural_value:1},{category:"Transport",indicator:"Perception of transport index",unit:"index",value:3,natural_value:1.5},{category:"Inclusion",indicator:"Female-friendly city",unit:"1,2,3,4,5",value:1,natural_value:4},{category:"Inclusion",indicator:"Number of refugees per 1,000 population",unit:"per 1,000",value:3,natural_value:4.1},{category:"Inclusion",indicator:"Homeless people per 1,000 population",unit:"per 1,000",value:5,natural_value:.229357798},{category:"Inclusion",indicator:"Difference in number of years of schooling between woman and man, woman to man ratio ",unit:"years",value:3,natural_value:.97},{category:"Inclusion",indicator:"Slavery index",unit:"index",value:1,natural_value:46},{category:"Inclusion",indicator:"Percentage of women aged 25-34 years old that have successfully completed secondary education",unit:"%",value:3,natural_value:.41},{category:"Inclusion",indicator:"Regulations for building construction and equipment, public transport for people with disabilities",unit:"Yes/No",value:5,natural_value:1},{category:"Inclusion",indicator:"Perception of inclusion index",unit:"index",value:3,natural_value:2.3},{category:"Accountability",indicator:"City budget execution publication",unit:"Yes/No",value:5,natural_value:1},{category:"Accountability",indicator:"City budget publication",unit:"Yes/No",value:5,natural_value:1},{category:"Accountability",indicator:"Financial transparency on city government companies",unit:"Yes/No",value:1,natural_value:0},{category:"Accountability",indicator:"ISO certification",unit:"Yes/No",value:1,natural_value:0},{category:"Accountability",indicator:"City council checks and balances",unit:"Yes/No",value:5,natural_value:1},{category:"Accountability",indicator:"Plans to obtain ISO certification",unit:"Yes/No",value:1,natural_value:0},{category:"Accountability",indicator:"Perception of accountability index",unit:"index",value:3,natural_value:.9},{category:"City budget",indicator:"Poor financial condition",unit:"Yes/No",value:5,natural_value:0},{category:"City budget",indicator:"Central/higher level government financial intervention taking place",unit:"Yes/No",value:5,natural_value:0},{category:"City budget",indicator:"Long-term financial planning",unit:"Yes/No",value:1,natural_value:0},{category:"City budget",indicator:"Central/higher level government financial intervention is considered",unit:"Yes/No",value:1,natural_value:0},{category:"City budget",indicator:"Prudent fiscal policy requirements",unit:"Yes/No",value:1,natural_value:0},{category:"City budget",indicator:"Medium-term planning",unit:"Yes/No",value:1,natural_value:0},{category:"SME",indicator:"Number of SMEs per 100,000 population",unit:"per 100,000",value:3,natural_value:4558.664923782264},{category:"SME",indicator:"Number of start-ups",unit:"start-ups",value:2,natural_value:184},{category:"SME",indicator:"Global Startup Ecosystem Index",unit:"index",value:4,natural_value:8.619},{category:"SME",indicator:"Number of SMEs per capita/100 000 population (change in last 3 years)",unit:"%",value:3,natural_value:.011495},{category:"SME",indicator:"Number of start-ups (change in last 3 years)",unit:"%",value:3,natural_value:.125},{category:"Public services",indicator:"Free phone to call the police, ambulance, firefighters",unit:"1,2,3,4,5",value:1,natural_value:0},{category:"Public services",indicator:"Services for working with citizens' appeals and complaint",unit:"Yes/No",value:1,natural_value:0},{category:"Public services",indicator:"E-gov services",unit:"Yes/No",value:1,natural_value:0},{category:"Public services",indicator:"Perception of public services index: Public Services",unit:"index",value:3,natural_value:1.77},{category:"Sustainability commitment",indicator:"City ESG reporting",unit:"Yes/No",value:5,natural_value:1},{category:"Sustainability commitment",indicator:"City ESG reporting verification",unit:"Yes/No",value:1,natural_value:0},{category:"Sustainability commitment",indicator:"ESG planning",unit:"Yes/No",value:5,natural_value:1},{category:"Sustainability commitment",indicator:"Plan with specific targets to develop and implement smart city principles",unit:"Yes/No",value:5,natural_value:1},{category:"Sustainability commitment",indicator:"Rollout and status of ESG / UN SDG training across the municipal/asset workforce",unit:"Yes/No",value:5,natural_value:1},{category:"Sustainability commitment",indicator:"City municipality involved in network or partnership promoting sustainable development (for example, C40 Cities network)",unit:"Yes/No",value:5,natural_value:1}]},{city:"Colombo",data:[{category:"Air pollution",indicator:"CO2 emissions",unit:"kt",value:3,natural_value:3.6589237000000003},{category:"Air pollution",indicator:"CO2 emissions (change in last 3 years)",unit:"%",value:3,natural_value:.026410067738081355},{category:"Air pollution",indicator:"CO2 concentration",unit:"ppm",value:3,natural_value:436.697055},{category:"Air pollution",indicator:"CO2 concentration (change in last 3 years)",unit:"%",value:5,natural_value:.009401072323507535},{category:"Air pollution",indicator:"Annual average of SO2 concentration in ambient air",unit:"microgram/m3",value:3,natural_value:18.4707334},{category:"Air pollution",indicator:"Annual Average of SO2 Concentration in Ambient Air (change in last 3 years)",unit:"%",value:3,natural_value:-.002810218110774317},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air",unit:"microgram/m3",value:3,natural_value:13.5},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air (change in last 3 years), microgram/m3",unit:"%",value:3,natural_value:-.015029913906318366},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air, microgram/m3",unit:"microgram/m3",value:3,natural_value:48.62512501},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air (change in last 3 years), microgram/m3",unit:"%",value:3,natural_value:.041136887700210525},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air, microgram/m3",unit:"microgram/m3",value:3,natural_value:.36589237},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air (change in last 3 years), microgram/m3",unit:"%",value:3,natural_value:.026410067738081355},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air, microgram/m3",unit:"microgram/m3",value:3,natural_value:75.11740601},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air (change in last 3 years), microgram/m3",unit:"%",value:3,natural_value:.031062641636741342},{category:"Air pollution",indicator:"Volatile organic compounds/reactive organic gases emissions",unit:"microgram/m3",value:3,natural_value:1.7},{category:"Air pollution",indicator:"Perception of air pollution index",unit:"index",value:3,natural_value:1.6},{category:"Air pollution",indicator:"Paris Agreement",unit:"Yes/No",value:5,natural_value:1},{category:"Water pollution",indicator:"Annual average of dissolved oxygen (DO) concentration in water",unit:"%",value:3,natural_value:6.08},{category:"Water pollution",indicator:"Annual average of pH concentration in water",unit:"pH",value:3,natural_value:7.1},{category:"Water pollution",indicator:"Annual average dissolved solids in drinking-water",unit:"ppm",value:4,natural_value:24.51},{category:"Water pollution",indicator:"Water management strategy in a city",unit:"Yes/No",value:5,natural_value:1},{category:"Water pollution",indicator:"Perception of water pollution index",unit:"index",value:3,natural_value:1.9},{category:"Land use and waste",indicator:"Share of devastated and degraded land area requiring reclamation",unit:"%",value:3,natural_value:7},{category:"Land use and waste",indicator:"3-year average growth rate of devastated and degraded land area requiring reclamation",unit:"%",value:1,natural_value:.002},{category:"Land use and waste",indicator:"Waste deposits",unit:"%",value:1,natural_value:.005},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous)",unit:"kg per capita ",value:3,natural_value:635},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous), (change in last 3 years)",unit:"%",value:3,natural_value:4.2},{category:"Land use and waste",indicator:"Total recycled construction waste",unit:"tons per capita",value:3,natural_value:1.7},{category:"Land use and waste",indicator:"Share of recycled construction and demolish waste in total generated construction and demolish waste",unit:"%",value:3,natural_value:.249},{category:"Land use and waste",indicator:"Total area of impervious surfaces and percentage to total city area",unit:"%",value:3,natural_value:.02},{category:"Land use and waste",indicator:"Productive urban land (in percent total land)",unit:"%",value:3,natural_value:32.2},{category:"Land use and waste",indicator:"Waste managenet strategy",unit:"Yes/No",value:1,natural_value:0},{category:"Land use and waste",indicator:"Perception of waste index",unit:"index",value:3,natural_value:2.3},{category:"Land use and waste",indicator:"Green spaces, % city area",unit:"%",value:3,natural_value:.24},{category:"Land use and waste",indicator:"Green spaces, change in last 3 years",unit:"%",value:3,natural_value:-.06},{category:"Land use and waste",indicator:"NDVI",unit:"%",value:2,natural_value:.575},{category:"Natural disaster hazards",indicator:"Share of total area with altitude above sea level less than 0,5 meters",unit:"%",value:3,natural_value:.085},{category:"Natural disaster hazards",indicator:"Growth rate of freshwater mirror area",unit:"%",value:3,natural_value:-.06},{category:"Natural disaster hazards",indicator:"Number of registered heavy rain, flood and thunderbolt (change in last 3 years)",unit:"%",value:5,natural_value:-.5},{category:"Natural disaster hazards",indicator:"Number of registered sand storm (change in last 3 years)",unit:"%",value:5,natural_value:-.5},{category:"Natural disaster hazards",indicator:"Environmental/natural disasters risk mitigation",unit:"Yes/No",value:5,natural_value:1},{category:"Natural disaster hazards",indicator:"Strategy/policy/government officials statement on environmental issues ",unit:"Yes/No",value:5,natural_value:1},{category:"Natural disaster hazards",indicator:"Total overall losses from natural disaster hazards",unit:"US$ mln ",value:3,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of days with average daily temperature above the threshold for 1990-2010",unit:"days",value:3,natural_value:15},{category:"Natural disaster hazards",indicator:"Number of disruptions to basic services, attributed to disasters",unit:"%",value:3,natural_value:0},{category:"Water availability",indicator:"Water consumption per capita",unit:"mcm",value:3,natural_value:.11944},{category:"Water availability",indicator:"Water tariff to disposable income ratio",unit:"ratio",value:3,natural_value:1.29},{category:"Water availability",indicator:"Sanitary facilities tariff to disposable income ratio",unit:"ratio",value:3,natural_value:1.1},{category:"Water availability",indicator:"Water consumption per capita (change in last 3 years)",unit:"%",value:5,natural_value:-.004},{category:"Water availability",indicator:"Percentage of population with access to drinking water",unit:"%",value:5,natural_value:.99},{category:"Water availability",indicator:"Percentage of population with access to drinking water (change in last 3 years)",unit:"%",value:3,natural_value:.0016},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities",unit:"%",value:3,natural_value:.915},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities (change in last 3 years)",unit:"%",value:4,natural_value:9e-5},{category:"Food availability",indicator:"Cereal import dependency ratio (5-years average)",unit:"%",value:3,natural_value:.35},{category:"Food availability",indicator:"Cereal import dependency ratio (change in last 3 years)",unit:"%",value:3,natural_value:.002},{category:"Food availability",indicator:"Prevalence of undernourishment",unit:"%",value:3,natural_value:.058},{category:"Food availability",indicator:"Prevalence of undernourishment (change in last 3 years)",unit:"%",value:3,natural_value:-.001999999999999995},{category:"Food availability",indicator:"Prevalence of undernourishment children",unit:"%",value:4,natural_value:.151},{category:"Food availability",indicator:"Prevalence of undernourishment children (change in last 3 years)",unit:"%",value:1,natural_value:-.10834034891947486},{category:"Food availability",indicator:"Prevalence of moderate or severe food insecurity in the population",unit:"%",value:4,natural_value:.109},{category:"Food availability",indicator:"Share of imports in food resources",unit:"%",value:4,natural_value:.209},{category:"Food availability",indicator:"Percentage of people with access to at least one food vendor/retailer within 15 minutes of walking",unit:"%",value:3,natural_value:91},{category:"Food availability",indicator:"Perception of food availability index",unit:"index",value:3,natural_value:2.2},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity",unit:"%",value:3,natural_value:.986},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity (change in last 3 years)",unit:"%",value:5,natural_value:.04506506935002963},{category:"Energy availability",indicator:"Consumption of electricity per capita",unit:"kWh/person",value:4,natural_value:626},{category:"Energy availability",indicator:"Consumption of electricity per capita (change in last 3 years)",unit:"%",value:3,natural_value:.056395649590240904},{category:"Energy availability",indicator:"Electricity tariff to disposable income ratio",unit:"ratio",value:3,natural_value:.1},{category:"Energy availability",indicator:"Share of renewable sources in electricity consumption",unit:"%",value:5,natural_value:.4932},{category:"Energy availability",indicator:"Perception of energy availability index",unit:"index",value:3,natural_value:1.07},{category:"Health",indicator:"Child mortality rate (under 5 years-old)",unit:"% of live births ",value:3,natural_value:14.9},{category:"Health",indicator:"City ambulance",unit:"Yes/No",value:5,natural_value:1},{category:"Health",indicator:"Life expectancy at birth, years",unit:"Years",value:4,natural_value:76.9},{category:"Health",indicator:"Life expectancy at birth goals",unit:"categories",value:1,natural_value:1},{category:"Health",indicator:"Number of hospital beds per 1,000 population",unit:"per 1,000",value:3,natural_value:4.2},{category:"Health",indicator:"Number of doctors per 1,000 population",unit:"per 1,000",value:4,natural_value:1.2},{category:"Health",indicator:"Maternal mortality ratio",unit:"deaths per 1,000 live births",value:4,natural_value:29},{category:"Health",indicator:"Ambulance arrival speed, min",unit:"min",value:5,natural_value:10},{category:"Education",indicator:"Literacy rate among population (15-24 Years)",unit:"%",value:3,natural_value:.99},{category:"Education",indicator:"Literacy rate among population (15-24 Years) (change in last 3 years)",unit:"%",value:3,natural_value:.00033692724921396966},{category:"Education",indicator:"Primary education engagement",unit:"%",value:3,natural_value:.73},{category:"Education",indicator:"Pupils per teacher rate",unit:"ratio",value:5,natural_value:.217},{category:"Education",indicator:"Proportion of population with post-secondary and higher education",unit:"%",value:3,natural_value:.296},{category:"Wealth",indicator:"Percentage of population with food expenditure is above 52% of total expenditure",unit:"%",value:2,natural_value:.555},{category:"Wealth",indicator:"Mean monthly salary",unit:"US dollars thousand",value:2,natural_value:182.75},{category:"Wealth",indicator:"Mean monthly salary, change in last 3 years",unit:"%",value:3,natural_value:.020413775479336982},{category:"Wealth",indicator:"Disposable monthly income",unit:"US dollars thousand",value:3,natural_value:784},{category:"Wealth",indicator:"Disposable monthly income (change in last 3 years)",unit:"%",value:3,natural_value:.02},{category:"Wealth",indicator:"Debt to salary ratio",unit:"ratio",value:3,natural_value:5},{category:"Wealth",indicator:"Number of mobile phones per 1,000 population",unit:"per 1,000",value:4,natural_value:1410},{category:"Wealth",indicator:"Decile income coefficient",unit:"ratio",value:4,natural_value:9.935483870967742},{category:"Wealth",indicator:"Decile income coefficient (change in last 3 years)",unit:"%",value:3,natural_value:-.02237297581008335},{category:"Wealth",indicator:"Poverty headcount ratio at national poverty lines",unit:"%",value:3,natural_value:.143},{category:"Wealth",indicator:"Working poverty rate (percentage of employed living below US$1.90 PPP), 15+ age (%) ",unit:"%",value:5,natural_value:.004},{category:"Wealth",indicator:"Poverty headcount ratio at $2.15 PPP 2017 a day",unit:"%",value:5,natural_value:.04},{category:"Wealth",indicator:"Living spaces per capita, sq m (change in last 3 years)",unit:"%",value:3,natural_value:.033},{category:"Wealth",indicator:"Population living in slums (% of urban population)",unit:"%",value:1,natural_value:.5},{category:"Wealth",indicator:"Availability of finance (consumer loans)",unit:"%",value:3,natural_value:.43},{category:"Wealth",indicator:"Perception of wealth & poverty index",unit:"index",value:3,natural_value:1.7},{category:"Safety",indicator:"Road fatalities rate per 100,000 population",unit:"per 100,000",value:3,natural_value:11.340252707581227},{category:"Safety",indicator:"Road fatalities rate per 100,000 population (change in last 3 years)",unit:"%",value:3,natural_value:-.04507057046287022},{category:"Safety",indicator:"Violent crime rate per 100,000 population",unit:"per 100,000",value:4,natural_value:3.43},{category:"Safety",indicator:"Violent crime rate per 100,000 population (change in last 3 years)",unit:"%",value:1,natural_value:.14919896707064462},{category:"Safety",indicator:"Crime rate per 100,000 population",unit:"per 100,000",value:5,natural_value:3.43},{category:"Safety",indicator:"Crime rate per 100,000 population  (change in last 3 years)",unit:"%",value:3,natural_value:-.03},{category:"Safety",indicator:"Police arrival speed",unit:"min",value:3,natural_value:21.7},{category:"Safety",indicator:"Perception of safety index",unit:"index",value:3,natural_value:2.79},{category:"Livability",indicator:"Number of LEED certified green buildings",unit:"Certified square meters per capita",value:3,natural_value:.08486437677053825},{category:"Livability",indicator:"Number of BREEAM certified projects",unit:"Certified square meters per capita",value:1,natural_value:0},{category:"Livability",indicator:"Whether or not the city has ISO 37120 certification",unit:"Yes/No",value:1,natural_value:0},{category:"Livability",indicator:"Mobile connection coverage",unit:"%",value:2,natural_value:.87},{category:"Livability",indicator:"Internet coverage",unit:"%",value:2,natural_value:.75},{category:"Livability",indicator:"Perception of livability index",unit:"index",value:3,natural_value:1.5},{category:"Livability",indicator:"Share of population in 1 km from schools",unit:"%",value:3,natural_value:54.9},{category:"Livability",indicator:"Share of population in 1 km from parks",unit:"%",value:3,natural_value:64.3},{category:"Transport",indicator:"Time loss in traffic",unit:"%",value:2,natural_value:.2235},{category:"Transport",indicator:"Share of the population in 1 km from public transport stop",unit:"%",value:3,natural_value:44.1},{category:"Transport",indicator:"Ratio of the cost of monthly public transport usage Ithe cheapest option) to average mobthly income",unit:"ratio",value:3,natural_value:.04},{category:"Transport",indicator:"Ratio of the cost of a 1-kilometer taxi ride to average mobthly income",unit:"%",value:3,natural_value:.04},{category:"Transport",indicator:"Percentage of city's roads that are segregated and/or has specialized lane for cyclists",unit:"%",value:3,natural_value:.06},{category:"Transport",indicator:"Number of public electric vehicle (EV) charging points per 100,000 population",unit:"per 100,000",value:3,natural_value:1.4},{category:"Transport",indicator:"Public transport (excluding subway) operates by schedule ",unit:"Yes/No",value:5,natural_value:1},{category:"Transport",indicator:"Perception of transport index",unit:"index",value:3,natural_value:1.5},{category:"Inclusion",indicator:"Female-friendly city",unit:"1,2,3,4,5",value:1,natural_value:4},{category:"Inclusion",indicator:"Number of refugees per 1,000 population",unit:"per 1,000",value:3,natural_value:1.227346570397112},{category:"Inclusion",indicator:"Homeless people per 1,000 population",unit:"per 1,000",value:3,natural_value:7.7},{category:"Inclusion",indicator:"Difference in number of years of schooling between woman and man, woman to man ratio ",unit:"years",value:3,natural_value:1.03},{category:"Inclusion",indicator:"Slavery index",unit:"index",value:1,natural_value:56},{category:"Inclusion",indicator:"Percentage of women aged 25-34 years old that have successfully completed secondary education",unit:"%",value:3,natural_value:.302},{category:"Inclusion",indicator:"Regulations for building construction and equipment, public transport for people with disabilities",unit:"Yes/No",value:5,natural_value:1},{category:"Inclusion",indicator:"Perception of inclusion index",unit:"index",value:3,natural_value:2.3},{category:"Accountability",indicator:"City budget execution publication",unit:"Yes/No",value:1,natural_value:0},{category:"Accountability",indicator:"City budget publication",unit:"Yes/No",value:1,natural_value:0},{category:"Accountability",indicator:"Financial transparency on city government companies",unit:"Yes/No",value:1,natural_value:0},{category:"Accountability",indicator:"ISO certification",unit:"Yes/No",value:1,natural_value:0},{category:"Accountability",indicator:"City council checks and balances",unit:"Yes/No",value:5,natural_value:1},{category:"Accountability",indicator:"Plans to obtain ISO certification",unit:"Yes/No",value:1,natural_value:0},{category:"Accountability",indicator:"Perception of accountability index",unit:"index",value:3,natural_value:.9},{category:"City budget",indicator:"Poor financial condition",unit:"Yes/No",value:1,natural_value:1},{category:"City budget",indicator:"Central/higher level government financial intervention taking place",unit:"Yes/No",value:1,natural_value:1},{category:"City budget",indicator:"Long-term financial planning",unit:"Yes/No",value:1,natural_value:0},{category:"City budget",indicator:"Central/higher level government financial intervention is considered",unit:"Yes/No",value:5,natural_value:1},{category:"City budget",indicator:"Prudent fiscal policy requirements",unit:"Yes/No",value:5,natural_value:1},{category:"City budget",indicator:"Medium-term planning",unit:"Yes/No",value:1,natural_value:0},{category:"SME",indicator:"Number of SMEs per 100,000 population",unit:"per 100,000",value:3,natural_value:4589.350180505415},{category:"SME",indicator:"Number of start-ups",unit:"start-ups",value:2,natural_value:105},{category:"SME",indicator:"Global Startup Ecosystem Index",unit:"index",value:2,natural_value:1.144},{category:"SME",indicator:"Number of SMEs per capita/100 000 population (change in last 3 years)",unit:"%",value:3,natural_value:-7e-4},{category:"SME",indicator:"Number of start-ups (change in last 3 years)",unit:"%",value:3,natural_value:.125},{category:"Public services",indicator:"Free phone to call the police, ambulance, firefighters",unit:"1,2,3,4,5",value:5,natural_value:1},{category:"Public services",indicator:"Services for working with citizens' appeals and complaint",unit:"Yes/No",value:5,natural_value:1},{category:"Public services",indicator:"E-gov services",unit:"Yes/No",value:5,natural_value:1},{category:"Public services",indicator:"Perception of public services index: Public Services",unit:"index",value:3,natural_value:1.77},{category:"Sustainability commitment",indicator:"City ESG reporting",unit:"Yes/No",value:1,natural_value:0},{category:"Sustainability commitment",indicator:"City ESG reporting verification",unit:"Yes/No",value:1,natural_value:0},{category:"Sustainability commitment",indicator:"ESG planning",unit:"Yes/No",value:1,natural_value:0},{category:"Sustainability commitment",indicator:"Plan with specific targets to develop and implement smart city principles",unit:"Yes/No",value:5,natural_value:1},{category:"Sustainability commitment",indicator:"Rollout and status of ESG / UN SDG training across the municipal/asset workforce",unit:"Yes/No",value:1,natural_value:0},{category:"Sustainability commitment",indicator:"City municipality involved in network or partnership promoting sustainable development (for example, C40 Cities network)",unit:"Yes/No",value:5,natural_value:1}]}],vj=["Very low","Low","Average","Strong","Very strong"],_j=["#FF3B29","#FF632F","#FF9B3F","#A0DA8B","#35CB00"],d5e=({city:n,category:e,setClickedCategory:i})=>{const{classes:a}=wCe(),s=PM.find(_=>_.city===n).data.filter(_=>_.category===e),[l,d]=ne.useState(0),f=_=>{_&&l+1===s.length?d(0):_?d(l+1):!_&&l-1<0?d(s.length-1):d(l-1)},p=e.replace(" ","_"),y=Object.keys(yj).includes(p)?yj[p]:"No description available";return _e("div",{className:a.backgroundWrapper,children:[_e("div",{onClick:()=>{i(null);const _=document.getElementById("landing");_.scrollTo({top:_.clientHeight*2})},className:a.returnBack,children:[U("img",{className:a.returnBackIcon,src:"/assets/returnBackIcon.svg",alt:"return back"}),U(nn,{className:a.returnBackText,children:"Back to Urban resilience index"})]}),_e("div",{className:a.content,children:[_e("div",{className:a.blueSection,children:[U(ECe,{title:e,text:y}),_e(nn,{style:{position:"absolute",top:"25vh",left:"8vh",color:"#fff",fontFamily:"SuisseIntl-Regular",fontSize:"4vh"},children:["Chose cities ",U("br",{}),"and compare to peers"]}),U(Xke,{categoryDataArr:u5e,currentCity:n,category:e,yLabels:vj,yColors:_j})]}),_e("div",{className:a.whiteSection,children:[_e("div",{style:{position:"absolute",top:"4vh",left:"8vh"},children:[_e("div",{className:a.title,style:{color:"#000000",fontFamily:"SuisseIntl-Light"},children:["Indicators of"," "]}),U("div",{className:a.title,style:{color:"#2D67FF"},children:e})]}),_e(nn,{style:{position:"absolute",top:"27.5vh",left:"8vh",width:"30vw",color:"#000000",fontFamily:"SuisseIntl-Light",fontSize:"2vh"},children:["The graph highlights the strengths and weaknesses of cities across various aspects of ",e," category. The further the vertices of the shape are from the center of the diagram, the better the city's performance in that particular indicator. The larger the area of the shape, the higher the overall assessment in the ",e," category."]}),U(n5e,{indicatorDataByCitiesArr:PM,currentCity:n,category:e,colors:["#2D67FF","#00BCF8","#00DDD0","#8490FF","#AD00FF","#FF7AE2"]})]}),_e("div",{className:a.blueSection,children:[_e("div",{style:{position:"absolute",top:"4vh",left:"8vh",display:"flex",flexDirection:"row",alignItems:"left",justifyContent:"left",gap:"1vw",height:"5vh"},children:[U("img",{src:"/assets/circle_arrow_transparent.svg",alt:"arrow",style:{width:"100%",height:"100%",cursor:"pointer"},onClick:()=>f(!1)}),U("img",{src:"/assets/circle_arrow_transparent.svg",alt:"arrow",style:{width:"100%",height:"100%",cursor:"pointer",transform:"rotate(180deg)"},onClick:()=>f(!0)})]}),_e(nn,{style:{position:"absolute",top:"5vh",left:"12vw",fontFamily:"SuisseIntl-Regular",fontSize:"2vh",color:"#fff",alignSelf:"center"},children:["Browse indicators for the ",e," category"]}),U("div",{style:{position:"absolute",top:"10vh",left:"8vh"},children:_e("div",{className:a.title,style:{fontSize:"6vh"},children:[s[l].indicator,U("br",{}),U("span",{style:{fontSize:"3vh",fontFamily:"SuisseIntl-Light",letterSpacing:"0"},children:s[l].unit})]})}),U(c5e,{indicatorDataByCitiesArr:PM,currentCity:n,category:e,indicator:s[l].indicator,yLabels:vj,yColors:_j})]})]})]})},h5e=wr()({backgroundWrapper:{position:"absolute",top:0,left:0,backgroundColor:"#0C1F68",width:"100vw",height:"100vh",overflowY:"scroll","&::-webkit-scrollbar":{width:"0em"},zIndex:"1200"},content:{position:"relative",width:"90%",margin:"12vh 5% 5vh",borderRadius:"3vh",overflow:"hidden",display:"flex"},whiteSection:{position:"relative",display:"flex",flexDirection:"column",width:"100%",height:"fit-content",float:"left",background:"#ffffff"},returnBack:{position:"absolute",top:"4vh",left:"5%",display:"flex",flexDirection:"row",alignItems:"center",gap:"1vh",cursor:"pointer"},returnBackIcon:{height:"4vh"},returnBackText:{fontFamily:"SuisseIntl-Light",fontWeight:400,color:"#fff",textTransform:"none",fontSize:"1.8vh","&:hover":{backgroundColor:"inherit"}},titleWrapper:{marginTop:"4vh",marginLeft:"8vh"},title:{fontWeight:400,lineHeight:"9vh",letterSpacing:"-0.2vh",fontSize:"8vh",width:"100%",color:"#000000",fontFamily:"SuisseIntl-Light"},filterBtn:{fontFamily:"SuisseIntl-Light",fontWeight:600,fontSize:"2vh",textTransform:"none"}});wr()({wrapper:{display:"flex",flexDirection:"row",justifyContent:"space-between",width:"100%",padding:"4vh 8vh",boxSizing:"border-box"},titleWrapper:{width:"50%"},title:{fontFamily:"SuisseIntl-Regular",fontWeight:400,lineHeight:"9vh",letterSpacing:"-0.2vh",fontSize:"8vh",color:"#fff",width:"100%"},subTitle:{fontFamily:"SuisseIntl-Light",fontWeight:200,lineHeight:"9vh",letterSpacing:"-0.2vh",fontSize:"6vh",color:"#fff",width:"100%"},text:{fontFamily:"SuisseIntl-Light",fontWeight:400,lineHeight:"3vh",letterSpacing:"0vh",fontSize:"2vh",color:"#fff",width:"55%",paddingTop:"3vh"}});const f5e=[{id:1,group:"E",category:"Air pollution",indicator:"CO2 emissions",scope:1,dimension:"Current state",type:"Key",unit:"kt"},{id:2,group:"E",category:"Air pollution",indicator:"CO2 emissions (change in last 3 years)",scope:1,dimension:"Ability & willingness",type:"Key",unit:"CAGR, %"},{id:3,group:"E",category:"Air pollution",indicator:"CO2 concentration",scope:1,dimension:"Current state",type:"Key",unit:"ppm"},{id:4,group:"E",category:"Air pollution",indicator:"CO2 concentration (change in last 3 years)",scope:1,dimension:"Ability & willingness",type:"Key",unit:"CAGR, %"},{id:5,group:"E",category:"Air pollution",indicator:"Annual average of SO2 concentration in ambient air",scope:0,dimension:"Current state",type:"Key",unit:"microgram/m3"},{id:6,group:"E",category:"Air pollution",indicator:"Annual Average of SO2 Concentration in Ambient Air (change in last 3 years)",scope:0,dimension:"Ability & willingness",type:"Key",unit:"CAGR, %"},{id:7,group:"E",category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air",scope:0,dimension:"Current state",type:"Key",unit:"microgram/m3"},{id:8,group:"E",category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air (change in last 3 years)",scope:0,dimension:"Ability & willingness",type:"Key",unit:"CAGR, %"},{id:9,group:"E",category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air",scope:0,dimension:"Current state",type:"Key",unit:"microgram/m3"},{id:10,group:"E",category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air (change in last 3 years)",scope:0,dimension:"Ability & willingness",type:"Key",unit:"CAGR, %"},{id:11,group:"E",category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air",scope:0,dimension:"Current state",type:"Key",unit:"microgram/m3"},{id:12,group:"E",category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air (change in last 3 years)",scope:0,dimension:"Ability & willingness",type:"Key",unit:"CAGR, %"},{id:13,group:"E",category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air",scope:0,dimension:"Current state",type:"Key",unit:"microgram/m3"},{id:14,group:"E",category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air (change in last 3 years)",scope:0,dimension:"Ability & willingness",type:"Key",unit:"CAGR, %"},{id:15,group:"E",category:"Air pollution",indicator:"Volatile organic compounds/reactive organic gases emissions",scope:1,dimension:"Current state",type:"Supportive",unit:"microgram/m3"},{id:16,group:"E",category:"Air pollution",indicator:"Perception of air pollution index",scope:0,dimension:"Current state",type:"Key",unit:"index"},{id:17,group:"E",category:"Air pollution",indicator:"Paris Agreement",scope:3,dimension:"Ability & willingness",type:"Supportive",unit:"Yes/No"},{id:18,group:"E",category:"Water pollution",indicator:"Annual average of dissolved oxygen (DO) concentration in water",scope:1,dimension:"Current state",type:"Supportive",unit:"%"},{id:19,group:"E",category:"Water pollution",indicator:"Annual average of pH concentration in water",scope:1,dimension:"Current state",type:"Supportive",unit:"pH"},{id:20,group:"E",category:"Water pollution",indicator:"Annual average dissolved solids in drinking water",scope:1,dimension:"Current state",type:"Supportive",unit:"ppm"},{id:21,group:"E",category:"Water pollution",indicator:"Water management strategy in a city",scope:1,dimension:"Ability & willingness",type:"Supportive",unit:"Yes/No"},{id:22,group:"E",category:"Water pollution",indicator:"Perception of water pollution index",scope:0,dimension:"Current state",type:"Key",unit:"index"},{id:23,group:"E",category:"Land use and waste",indicator:"Share of devastated and degraded land area requiring reclamation",scope:1,dimension:"Current state",type:"Key",unit:"%"},{id:24,group:"E",category:"Land use and waste",indicator:"3-year average growth rate of devastated and degraded land area requiring reclamation",scope:1,dimension:"Ability & willingness",type:"Key",unit:"CAGR, %"},{id:25,group:"E",category:"Land use and waste",indicator:"Waste deposits",scope:0,dimension:"Current state",type:"Supportive",unit:"%"},{id:26,group:"E",category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous)",scope:0,dimension:"Current state",type:"Supportive",unit:"kg per capita "},{id:27,group:"E",category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous), (change in last 3 years)",scope:0,dimension:"Ability & willingness",type:"Supportive",unit:"CAGR, %"},{id:28,group:"E",category:"Land use and waste",indicator:"Total recycled construction waste",scope:1,dimension:"Current state",type:"Supportive",unit:"tons per capita"},{id:29,group:"E",category:"Land use and waste",indicator:"Share of recycled construction and demolish waste in total generated construction and demolish waste",scope:1,dimension:"Current state",type:"Supportive",unit:"%"},{id:30,group:"E",category:"Land use and waste",indicator:"Total area of impervious surfaces and percentage to total city area",scope:1,dimension:"Current state",type:"Supportive",unit:"%"},{id:31,group:"E",category:"Land use and waste",indicator:"Productive urban land, % of total area",scope:1,dimension:"Current state",type:"Supportive",unit:"%"},{id:32,group:"E",category:"Land use and waste",indicator:"Waste management strategy",scope:1,dimension:"Ability & willingness",type:"Supportive",unit:"Yes/No"},{id:33,group:"E",category:"Land use and waste",indicator:"Perception of waste index",scope:0,dimension:"Current state",type:"Key",unit:"index"},{id:34,group:"E",category:"Land use and waste",indicator:"Green spaces, % city area",scope:1,dimension:"Current state",type:"Key",unit:"%"},{id:35,group:"E",category:"Land use and waste",indicator:"Green spaces, change in last 3 years",scope:1,dimension:"Ability & willingness",type:"Key",unit:"CAGR, %"},{id:36,group:"E",category:"Land use and waste",indicator:"NDVI (Normalized Difference Vegetation Index)",scope:1,dimension:"Current state",type:"Supportive",unit:"index"},{id:37,group:"E",category:"Natural disaster hazards",indicator:"Share of total area with altitude above sea level less than 0,5 meters",scope:1,dimension:"Current state",type:"Supportive",unit:"%"},{id:38,group:"E",category:"Natural disaster hazards",indicator:"Growth rate of freshwater mirror area",scope:1,dimension:"Ability & willingness",type:"Key",unit:"%"},{id:39,group:"E",category:"Natural disaster hazards",indicator:"Number of registered heavy rain, flood and thunderbolt (change in last 3 years)",scope:1,dimension:"Current state",type:"Supportive",unit:"CAGR, %"},{id:40,group:"E",category:"Natural disaster hazards",indicator:"Number of registered sandstorm (change in last 3 years)",scope:1,dimension:"Current state",type:"Supportive",unit:"CAGR, %"},{id:41,group:"E",category:"Natural disaster hazards",indicator:"Environmental/natural disasters risk mitigation",scope:1,dimension:"Ability & willingness",type:"Supportive",unit:"Yes/No"},{id:42,group:"E",category:"Natural disaster hazards",indicator:"Strategy/policy/government officials statement on environmental issues ",scope:1,dimension:"Ability & willingness",type:"Supportive",unit:"Yes/No"},{id:43,group:"E",category:"Natural disaster hazards",indicator:"Total overall losses from natural disaster hazards",scope:1,dimension:"Current state",type:"Supportive",unit:"US$ mln "},{id:44,group:"E",category:"Natural disaster hazards",indicator:"Number of days with average daily temperature above the threshold for 1990-2010",scope:1,dimension:"Current state",type:"Supportive",unit:"days"},{id:45,group:"E",category:"Natural disaster hazards",indicator:"Number of disruptions to basic services, attributed to disasters",scope:0,dimension:"Current state",type:"Supportive",unit:"%"},{id:46,group:"S",category:"Water availability",indicator:"Water consumption per capita",scope:0,dimension:"Current state",type:"Supportive",unit:"mcm per capita"},{id:47,group:"S",category:"Water availability",indicator:"Water tariff to disposable income ratio",scope:0,dimension:"Current state",type:"Supportive",unit:"ratio"},{id:48,group:"S",category:"Water availability",indicator:"Sanitary facilities tariff to disposable income ratio",scope:0,dimension:"Current state",type:"Supportive",unit:"ratio"},{id:49,group:"S",category:"Water availability",indicator:"Water consumption per capita (change in last 3 years)",scope:1,dimension:"Ability & willingness",type:"Supportive",unit:"CAGR, %"},{id:50,group:"S",category:"Water availability",indicator:"Percentage of population with access to drinking water",scope:0,dimension:"Current state",type:"Key",unit:"%"},{id:51,group:"S",category:"Water availability",indicator:"Percentage of population with access to drinking water (change in last 3 years)",scope:0,dimension:"Ability & willingness",type:"Supportive",unit:"CAGR, %"},{id:52,group:"S",category:"Water availability",indicator:"Percentage of population with access to sanitary facilities",scope:0,dimension:"Current state",type:"Key",unit:"%"},{id:53,group:"S",category:"Water availability",indicator:"Percentage of population with access to sanitary facilities (change in last 3 years)",scope:0,dimension:"Ability & willingness",type:"Supportive",unit:"CAGR, %"},{id:54,group:"S",category:"Food availability",indicator:"Cereal import dependency ratio (5-years average)",scope:1,dimension:"Current state",type:"Supportive",unit:"ratio"},{id:55,group:"S",category:"Food availability",indicator:"Cereal import dependency ratio (change in last 3 years)",scope:1,dimension:"Ability & willingness",type:"Supportive",unit:"CAGR, %"},{id:56,group:"S",category:"Food availability",indicator:"Prevalence of undernourishment",scope:0,dimension:"Current state",type:"Key",unit:"%"},{id:57,group:"S",category:"Food availability",indicator:"Prevalence of undernourishment (change in last 3 years)",scope:0,dimension:"Ability & willingness",type:"Supportive",unit:"CAGR, %"},{id:58,group:"S",category:"Food availability",indicator:"Prevalence of undernourishment children",scope:0,dimension:"Current state",type:"Supportive",unit:"%"},{id:59,group:"S",category:"Food availability",indicator:"Prevalence of undernourishment children (change in last 3 years)",scope:0,dimension:"Ability & willingness",type:"Supportive",unit:"CAGR, %"},{id:60,group:"S",category:"Food availability",indicator:"Prevalence of moderate or severe food insecurity in the population",scope:0,dimension:"Current state",type:"Supportive",unit:"%"},{id:61,group:"S",category:"Food availability",indicator:"Share of imports in food resources",scope:1,dimension:"Current state",type:"Supportive",unit:"%"},{id:62,group:"S",category:"Food availability",indicator:"Percentage of people with access to at least one food vendor/retailer within 15 minutes of walking",scope:1,dimension:"Current state",type:"Supportive",unit:"%"},{id:63,group:"S",category:"Food availability",indicator:"Perception of food availability index",scope:0,dimension:"Current state",type:"Key",unit:"index"},{id:64,group:"S",category:"Energy availability",indicator:"Percentage of urban population with access to electricity",scope:0,dimension:"Ability & willingness",type:"Key",unit:"%"},{id:65,group:"S",category:"Energy availability",indicator:"Percentage of urban population with access to electricity (change in last 3 years)",scope:0,dimension:"Ability & willingness",type:"Supportive",unit:"CAGR, %"},{id:66,group:"S",category:"Energy availability",indicator:"Consumption of electricity per capita",scope:0,dimension:"Current state",type:"Supportive",unit:"kWh/person"},{id:67,group:"S",category:"Energy availability",indicator:"Consumption of electricity per capita (change in last 3 years)",scope:0,dimension:"Ability & willingness",type:"Supportive",unit:"CAGR, %"},{id:68,group:"S",category:"Energy availability",indicator:"Electricity tariff to disposable income ratio",scope:0,dimension:"Ability & willingness",type:"Supportive",unit:"ratio"},{id:69,group:"S",category:"Energy availability",indicator:"Share of renewable sources in electricity consumption",scope:2,dimension:"Current state",type:"Supportive",unit:"%"},{id:70,group:"S",category:"Energy availability",indicator:"Perception of energy availability index",scope:0,dimension:"Current state",type:"Supportive",unit:"index"},{id:71,group:"S",category:"Health",indicator:"Child mortality rate (under 5 years-old)",scope:1,dimension:"Current state",type:"Key",unit:"% of live births "},{id:72,group:"S",category:"Health",indicator:"City ambulance",scope:0,dimension:"Current state",type:"Key",unit:"Yes/No"},{id:73,group:"S",category:"Health",indicator:"Life expectancy at birth, years",scope:1,dimension:"Ability & willingness",type:"Supportive",unit:"years"},{id:74,group:"S",category:"Health",indicator:"Life expectancy at birth goals",scope:1,dimension:"Ability & willingness",type:"Key",unit:"index"},{id:75,group:"S",category:"Health",indicator:"Number of hospital beds per 1,000 population",scope:1,dimension:"Current state",type:"Supportive",unit:"per 1,000"},{id:76,group:"S",category:"Health",indicator:"Number of doctors per 1,000 population",scope:1,dimension:"Current state",type:"Supportive",unit:"per 1,000"},{id:77,group:"S",category:"Health",indicator:"Maternal mortality ratio",scope:0,dimension:"Current state",type:"Supportive",unit:"deaths per 1,000 live births"},{id:78,group:"S",category:"Health",indicator:"Ambulance arrival speed",scope:0,dimension:"Current state",type:"Supportive",unit:"min"},{id:79,group:"S",category:"Education",indicator:"Literacy rate among population (15-24 Years)",scope:0,dimension:"Current state",type:"Key",unit:"%"},{id:80,group:"S",category:"Education",indicator:"Literacy rate among population (15-24 Years) (change in last 3 years)",scope:0,dimension:"Ability & willingness",type:"Key",unit:"CAGR, %"},{id:81,group:"S",category:"Education",indicator:"Primary education engagement",scope:1,dimension:"Current state",type:"Supportive",unit:"%"},{id:82,group:"S",category:"Education",indicator:"Pupils per teacher rate",scope:1,dimension:"Current state",type:"Supportive",unit:"ratio"},{id:83,group:"S",category:"Education",indicator:"Proportion of population with post-secondary and higher education",scope:1,dimension:"Current state",type:"Supportive",unit:"%"},{id:84,group:"S",category:"Wealth",indicator:"Percentage of population with food expenditure is above 52% of total expenditure",scope:0,dimension:"Current state",type:"Key",unit:"%"},{id:85,group:"S",category:"Wealth",indicator:"Mean monthly salary",scope:1,dimension:"Current state",type:"Key",unit:"US dollars thousand PPP"},{id:86,group:"S",category:"Wealth",indicator:"Mean monthly salary, change in last 3 years",scope:1,dimension:"Ability & willingness",type:"Key",unit:"CAGR, %"},{id:87,group:"S",category:"Wealth",indicator:"Disposable monthly income",scope:0,dimension:"Current state",type:"Supportive",unit:"US dollars thousand PPP"},{id:88,group:"S",category:"Wealth",indicator:"Disposable monthly income (change in last 3 years)",scope:1,dimension:"Ability & willingness",type:"Supportive",unit:"CAGR, %"},{id:89,group:"S",category:"Wealth",indicator:"Debt to salary ratio",scope:1,dimension:"Current state",type:"Supportive",unit:"ratio"},{id:90,group:"S",category:"Wealth",indicator:"Number of mobile phones per 1,000 population",scope:1,dimension:"Current state",type:"Supportive",unit:"per 1,000"},{id:91,group:"S",category:"Wealth",indicator:"Decile income coefficient",scope:1,dimension:"Current state",type:"Supportive",unit:"ratio"},{id:92,group:"S",category:"Wealth",indicator:"Decile income coefficient (change in last 3 years)",scope:1,dimension:"Ability & willingness",type:"Supportive",unit:"CAGR, %"},{id:93,group:"S",category:"Wealth",indicator:"Poverty headcount ratio at national poverty lines",scope:1,dimension:"Current state",type:"Supportive",unit:"ratio"},{id:94,group:"S",category:"Wealth",indicator:"Working poverty rate (percentage of employed living below US$1.90 PPP), 15+ age (%) ",scope:1,dimension:"Current state",type:"Supportive",unit:"%"},{id:95,group:"S",category:"Wealth",indicator:"Poverty headcount ratio at $2.15 PPP 2017 a day",scope:0,dimension:"Current state",type:"Supportive",unit:"ratio"},{id:96,group:"S",category:"Wealth",indicator:"Living spaces per capita, sq m (change in last 3 years)",scope:0,dimension:"Ability & willingness",type:"Supportive",unit:"CAGR, %"},{id:97,group:"S",category:"Wealth",indicator:"Population living in slums (% of urban population)",scope:0,dimension:"Ability & willingness",type:"Supportive",unit:"%"},{id:98,group:"S",category:"Wealth",indicator:"Availability of finance (consumer loans)",scope:1,dimension:"Current state",type:"Supportive",unit:"%"},{id:99,group:"S",category:"Wealth",indicator:"Perception of wealth & poverty index",scope:0,dimension:"Current state",type:"Key",unit:"index"},{id:100,group:"S",category:"Safety",indicator:"Road fatalities rate per 100,000 population",scope:1,dimension:"Current state",type:"Supportive",unit:"per 100,000"},{id:101,group:"S",category:"Safety",indicator:"Road fatalities rate per 100,000 population (change in last 3 years)",scope:1,dimension:"Ability & willingness",type:"Supportive",unit:"CAGR, %"},{id:102,group:"S",category:"Safety",indicator:"Violent crime rate per 100,000 population",scope:0,dimension:"Current state",type:"Key",unit:"per 100,000"},{id:103,group:"S",category:"Safety",indicator:"Violent crime rate per 100,000 population (change in last 3 years)",scope:0,dimension:"Ability & willingness",type:"Supportive",unit:"CAGR, %"},{id:104,group:"S",category:"Safety",indicator:"Crime rate per 100,000 population",scope:0,dimension:"Current state",type:"Supportive",unit:"per 100,000"},{id:105,group:"S",category:"Safety",indicator:"Crime rate per 100,000 population  (change in last 3 years)",scope:0,dimension:"Ability & willingness",type:"Supportive",unit:"CAGR, %"},{id:106,group:"S",category:"Safety",indicator:"Police arrival speed",scope:0,dimension:"Current state",type:"Supportive",unit:"min"},{id:107,group:"S",category:"Safety",indicator:"Perception of safety index",scope:0,dimension:"Current state",type:"Supportive",unit:"index"},{id:108,group:"S",category:"Livability",indicator:"Number of LEED certified green buildings",scope:1,dimension:"Current state",type:"Supportive",unit:"certified square meters per capita"},{id:109,group:"S",category:"Livability",indicator:"Number of CEEQUAL certified projects",scope:2,dimension:"Current state",type:"Supportive",unit:"certified square meters per capita"},{id:110,group:"S",category:"Livability",indicator:"Whether or not the city has ISO 37120 certification",scope:2,dimension:"Ability & willingness",type:"Supportive",unit:"Yes/No"},{id:111,group:"S",category:"Livability",indicator:"Mobile connection coverage",scope:0,dimension:"Current state",type:"Supportive",unit:"%"},{id:112,group:"S",category:"Livability",indicator:"Internet coverage",scope:1,dimension:"Current state",type:"Supportive",unit:"%"},{id:113,group:"S",category:"Livability",indicator:"Perception of livability index",scope:0,dimension:"Current state",type:"Key",unit:"index"},{id:114,group:"S",category:"Livability",indicator:"Share of population in 1 km from hospitals",scope:0,dimension:"Current state",type:"Key",unit:"%"},{id:115,group:"S",category:"Livability",indicator:"Share of population in 1 km from parks",scope:0,dimension:"Current state",type:"Key",unit:"%"},{id:116,group:"S",category:"Transport",indicator:"Time loss in traffic",scope:1,dimension:"Current state",type:"Key",unit:"%"},{id:117,group:"S",category:"Transport",indicator:"Share of the population in 1 km from public transport stop",scope:1,dimension:"Current state",type:"Supportive",unit:"%"},{id:118,group:"S",category:"Transport",indicator:"Ratio of the cost of monthly public transport usage (the cheapest option) to average monthly income",scope:1,dimension:"Current state",type:"Supportive",unit:"ratio"},{id:119,group:"S",category:"Transport",indicator:"Ratio of the cost of a 1-kilometer taxi ride to average monthly income",scope:1,dimension:"Current state",type:"Supportive",unit:"ratio"},{id:120,group:"S",category:"Transport",indicator:"Percentage of city roads that are segregated and/or has specialized lane for cyclists",scope:1,dimension:"Current state",type:"Supportive",unit:"%"},{id:121,group:"S",category:"Transport",indicator:"Number of public electric vehicle (EV) charging points per 100,000 population",scope:3,dimension:"Current state",type:"Supportive",unit:"per 100,000"},{id:122,group:"S",category:"Transport",indicator:"Public transport (excluding subway) operates by schedule ",scope:1,dimension:"Current state",type:"Supportive",unit:"Yes/No"},{id:123,group:"S",category:"Transport",indicator:"Perception of transport index",scope:0,dimension:"Current state",type:"Key",unit:"index"},{id:124,group:"S",category:"Inclusion",indicator:"Female-friendly city",scope:1,dimension:"Current state",type:"Supportive",unit:"index"},{id:125,group:"S",category:"Inclusion",indicator:"Number of refugees per 1,000 population",scope:0,dimension:"Current state",type:"Supportive",unit:"per 1,000"},{id:126,group:"S",category:"Inclusion",indicator:"Homeless people per 1,000 population",scope:0,dimension:"Current state",type:"Key",unit:"per 1,000"},{id:127,group:"S",category:"Inclusion",indicator:"Difference in number of years of schooling between woman and man, woman to man ratio ",scope:1,dimension:"Current state",type:"Supportive",unit:"ratio"},{id:128,group:"S",category:"Inclusion",indicator:"Slavery index",scope:0,dimension:"Current state",type:"Supportive",unit:"index"},{id:129,group:"S",category:"Inclusion",indicator:"Percentage of women aged 25-34 years old that have successfully completed secondary education",scope:1,dimension:"Current state",type:"Supportive",unit:"%"},{id:130,group:"S",category:"Inclusion",indicator:"Regulations for building construction and equipment, public transport for people with disabilities",scope:2,dimension:"Current state",type:"Supportive",unit:"Yes/No"},{id:131,group:"S",category:"Inclusion",indicator:"Perception of inclusion index",scope:0,dimension:"Current state",type:"Key",unit:"index"},{id:132,group:"G",category:"Accountability",indicator:"City budget execution publication",scope:1,dimension:"Current state",type:"Key",unit:"Yes/No"},{id:133,group:"G",category:"Accountability",indicator:"City budget publication",scope:1,dimension:"Current state",type:"Key",unit:"Yes/No"},{id:134,group:"G",category:"Accountability",indicator:"Financial transparency on city government companies",scope:2,dimension:"Current state",type:"Key",unit:"Yes/No"},{id:135,group:"G",category:"Accountability",indicator:"ISO certification",scope:2,dimension:"Current state",type:"Key",unit:"Yes/No"},{id:136,group:"G",category:"Accountability",indicator:"City council checks and balances",scope:1,dimension:"Ability & willingness",type:"Supportive",unit:"Yes/No"},{id:137,group:"G",category:"Accountability",indicator:"Plans to obtain ISO certification",scope:2,dimension:"Ability & willingness",type:"Supportive",unit:"Yes/No"},{id:138,group:"G",category:"Accountability",indicator:"Perception of accountability index",scope:1,dimension:"Current state",type:"Key",unit:"index"},{id:139,group:"G",category:"City budget",indicator:"Poor financial condition",scope:2,dimension:"Current state",type:"Key",unit:"Yes/No"},{id:140,group:"G",category:"City budget",indicator:"Central/higher level government financial intervention taking place",scope:2,dimension:"Current state",type:"Key",unit:"Yes/No"},{id:141,group:"G",category:"City budget",indicator:"Long-term financial planning",scope:3,dimension:"Ability & willingness",type:"Key",unit:"Yes/No"},{id:142,group:"G",category:"City budget",indicator:"Central/higher level government financial intervention is considered",scope:2,dimension:"Ability & willingness",type:"Supportive",unit:"Yes/No"},{id:143,group:"G",category:"City budget",indicator:"Prudent fiscal policy requirements",scope:2,dimension:"Ability & willingness",type:"Supportive",unit:"Yes/No"},{id:144,group:"G",category:"City budget",indicator:"Medium-term planning",scope:3,dimension:"Ability & willingness",type:"Key",unit:"Yes/No"},{id:145,group:"G",category:"SME",indicator:"Number of SMEs per 100,000 population",scope:2,dimension:"Current state",type:"Key",unit:"per 100,000"},{id:146,group:"G",category:"SME",indicator:"Number of start-ups",scope:2,dimension:"Current state",type:"Supportive",unit:"start-ups"},{id:147,group:"G",category:"SME",indicator:"Global Startup Ecosystem Index",scope:3,dimension:"Current state",type:"Supportive",unit:"index"},{id:148,group:"G",category:"SME",indicator:"Number of SMEs per capita/100 000 population (change in last 3 years)",scope:2,dimension:"Ability & willingness",type:"Supportive",unit:"CAGR, %"},{id:149,group:"G",category:"SME",indicator:"Number of start-ups (change in last 3 years)",scope:2,dimension:"Ability & willingness",type:"Supportive",unit:"CAGR, %"},{id:150,group:"G",category:"Public services",indicator:"Free phone to call the police, ambulance, firefighters",scope:0,dimension:"Current state",type:"Supportive",unit:"index"},{id:151,group:"G",category:"Public services",indicator:"Services for working with citizens' appeals and complaint",scope:1,dimension:"Current state",type:"Supportive",unit:"Yes/No"},{id:152,group:"G",category:"Public services",indicator:"E-gov services",scope:1,dimension:"Current state",type:"Key",unit:"Yes/No"},{id:153,group:"G",category:"Public services",indicator:"Perception of public services index: Public Services",scope:1,dimension:"Current state",type:"Key",unit:"index"},{id:154,group:"G",category:"Sustainability commitment",indicator:"City ESG reporting",scope:3,dimension:"Ability & willingness",type:"Key",unit:"Yes/No"},{id:155,group:"G",category:"Sustainability commitment",indicator:"City ESG reporting verification",scope:3,dimension:"Ability & willingness",type:"Supportive",unit:"Yes/No"},{id:156,group:"G",category:"Sustainability commitment",indicator:"ESG planning",scope:3,dimension:"Ability & willingness",type:"Key",unit:"Yes/No"},{id:157,group:"G",category:"Sustainability commitment",indicator:"Plan with specific targets to develop and implement smart city principles",scope:1,dimension:"Ability & willingness",type:"Supportive",unit:"Yes/No"},{id:158,group:"G",category:"Sustainability commitment",indicator:"Rollout and status of ESG / UN SDG training across the municipal/asset workforce",scope:1,dimension:"Current state",type:"Supportive",unit:"Yes/No"},{id:159,group:"G",category:"Sustainability commitment",indicator:"City municipality involved in network or partnership promoting sustainable development (for example, C40 Cities network)",scope:3,dimension:"Current state",type:"Supportive",unit:"Yes/No"}],y0=({title:n,menuItems:e,indicatorsDataArr:i,accessorKey:a,setRows:s,filteredColumn:l,setFilteredColumn:d})=>{const f=(A,P)=>(d(A),i.filter(L=>L[A]===P)),[p,y]=ne.useState(null),_=!!p,b=A=>{y(A.currentTarget)},S=()=>{y(null)};return _e("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"},children:[_e(oi,{id:"basic-button","aria-controls":_?"basic-menu":void 0,"aria-haspopup":"true","aria-expanded":_?"true":void 0,onClick:b,style:{fontFamily:"SuisseIntl-Light",fontWeight:600,fontSize:"2vh",textTransform:"none",color:l===a?"#2D67FF":"rgba(0, 0, 0, 0.6)"},children:[n,U("img",{src:"/assets/arrowDownIcon.svg",alt:"arrowDownIcon",style:{marginLeft:"1vh"}})]}),U(Hg,{id:"basic-menu",anchorEl:p,open:_,onClose:S,MenuListProps:{"aria-labelledby":"basic-button"},children:e.map(A=>U(Tp,{onClick:()=>{console.log("accessorKey",a),console.log("item",A),s(f(a,A)),S()},children:A},A))}),l===a&&U("img",{src:"/assets/remove_filter.svg",alt:"crossIcon",style:{width:"1.5vh",cursor:"pointer"},onClick:()=>{s(i),d("")}})]},n)},p5e=(n,e,i,a,s,l,d,f,p)=>({id:n,group:e,category:i,indicator:a,scope:s,dimension:l,type:d,unit:f,natural_value:p}),m5e=()=>{uS();const e=jo().City,i=PM.find(_=>_.city===e).data,[a,s]=ne.useState(""),l=_=>{const b=f.map(S=>S[_]);return[...new Set(b)]},d=i.map(_=>({...f5e.find(S=>S.indicator===_.indicator),..._})),f=d.map(_=>p5e(_.id,_.group,_.category,_.indicator,_.scope,_.dimension,_.type,_.unit,_.natural_value)),[p,y]=ne.useState(f);return _e(X_e,{"aria-label":"simple table",stickyHeader:!0,children:[U(S1e,{children:_e(CV,{children:[U(ys,{align:"left",children:U(y0,{title:"Category",accessorKey:"category",menuItems:l("category"),indicatorsDataArr:d,filteredColumn:a,setRows:y,setFilteredColumn:s})}),U(ys,{align:"left",children:U(y0,{title:"Component",accessorKey:"group",menuItems:l("group"),indicatorsDataArr:d,filteredColumn:a,setRows:y,setFilteredColumn:s})}),U(ys,{align:"left",children:"Indicator"}),U(ys,{align:"center",children:U(y0,{title:"Scope",accessorKey:"scope",menuItems:l("scope"),indicatorsDataArr:d,setRows:y,filteredColumn:a,setFilteredColumn:s})}),U(ys,{align:"center",children:U(y0,{title:"Dimension",accessorKey:"dimension",menuItems:l("dimension"),indicatorsDataArr:d,setRows:y,filteredColumn:a,setFilteredColumn:s})}),U(ys,{align:"left",children:U(y0,{title:"Type",accessorKey:"type",menuItems:l("type"),indicatorsDataArr:d,setRows:y,filteredColumn:a,setFilteredColumn:s})}),U(ys,{align:"left",children:U(y0,{title:"Unit",accessorKey:"unit",menuItems:l("unit"),indicatorsDataArr:d,setRows:y,filteredColumn:a,setFilteredColumn:s})}),U(ys,{align:"left",children:"Value"})]})}),U(i1e,{children:p.map(_=>{var b;return _e(CV,{sx:{"&:last-child td, &:last-child th":{border:0}},children:[U(ys,{align:"left",children:_.category}),U(ys,{component:"th",scope:"row",children:_.group}),U(ys,{align:"left",children:_.indicator}),U(ys,{align:"center",children:_.scope}),U(ys,{align:"center",children:_.dimension}),U(ys,{align:"left",children:_.type}),U(ys,{align:"left",children:_.unit}),U(ys,{align:"left",children:Number.isInteger(_.natural_value)?_.natural_value:(b=Number(_.natural_value))==null?void 0:b.toFixed(2)})]},_.id)})})]})},g5e=({setTablePopupOpen:n})=>{const{classes:e}=h5e(),a=jo().City,s="Urban resilience index";return _e("div",{className:e.backgroundWrapper,children:[_e("div",{className:e.returnBack,onClick:()=>{const l=document.getElementById("landing");l.scrollTo({top:l.clientHeight*2}),n(!1)},children:[U("img",{className:e.returnBackIcon,src:"/assets/returnBackIcon.svg",alt:"return back"}),U(nn,{className:e.returnBackText,children:"Back to Urban resilience index"})]}),U("div",{className:e.content,children:_e("div",{className:e.whiteSection,children:[_e("div",{className:e.titleWrapper,children:[_e("div",{className:e.title,children:[a,": Indicators of "]}),U("div",{className:e.title,style:{color:"#2D67FF"},children:s})]}),U("div",{style:{width:"100%",height:"fit-content",display:"flex"},children:U(g1e,{component:Oq,sx:{width:"100%",height:"52vh",marginLeft:"8vh",marginRight:"8vh",marginTop:"4vh",marginBottom:"4vh"},children:U(m5e,{})})})]})})]})},y5e=({value:n,cities:e,color:i,isMobile:a,onChange:s})=>{const[l,d]=ne.useState(null),f=y=>{d(y.currentTarget)},p=()=>{d(null)};return a?_e(ko,{children:[_e(oi,{onClick:f,children:[U("div",{style:{width:"16px",height:"16px",borderRadius:"50%",backgroundColor:i}}),n,U("img",{src:"/assets/smallArrowDown.svg",alt:"arrow down"})]}),U(Hg,{id:"demo-positioned-menu","aria-labelledby":"demo-positioned-button",anchorEl:l,open:!!l,onClose:p,anchorOrigin:{vertical:"top",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"},children:e==null?void 0:e.map((y,_)=>U(Tp,{onClick:()=>{p(),s(y)},children:y},y))})]}):_e("div",{children:[U(oi,{onClick:f,style:{background:"transparent"},children:_e("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"},children:[U("div",{style:{width:"1.2vh",height:"1.2vh",borderRadius:"50%",backgroundColor:i,marginRight:"1vh"}}),U("div",{style:{fontFamily:"SuisseIntl-Light",fontSize:"3.1vh",fontWeight:600,textAlign:"center",color:"#000",textTransform:"none"},children:n}),U("div",{style:{marginLeft:"1vh"},children:U("img",{src:"/assets/smallArrowDown.svg",alt:"arrow down"})})]})}),U(Hg,{id:"demo-positioned-menu","aria-labelledby":"demo-positioned-button",anchorEl:l,open:!!l,onClose:p,anchorOrigin:{vertical:"top",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"},children:e==null?void 0:e.map((y,_)=>U(Tp,{onClick:()=>{p(),s(y)},children:y},y))})]})},BQ=({currentCity:n,selectedCities:e,cities:i,colors:a,isMobile:s,onChange:l})=>_e("div",{style:s?{paddingTop:"16px",paddingBottom:"16px",display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center",flexWrap:"wrap"}:{},children:[U(oi,{type:"button",style:{display:s?"none":"block"},children:_e("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"},children:[U("div",{style:{width:"1.2vh",height:"1.2vh",borderRadius:"50%",backgroundColor:a[0],marginRight:"1vh"}}),U("div",{style:{fontFamily:"SuisseIntl-Regular",fontSize:"3.1vh",fontWeight:600,textAlign:"center",color:a[0],textTransform:"none"},children:n})]})}),e.map((f,p)=>U(y5e,{value:f,cities:i.filter(y=>!e.includes(y)&&y!==n),color:a[p+1],onChange:l(p),isMobile:s},f))]}),v5e=()=>({responsive:!0,plugins:{tooltip:{enabled:!0},legend:{display:!1}},scales:{r:{ticks:{stepSize:1},angleLines:{display:!1},pointLabels:{font:{size:11}},suggestedMin:0}}}),UQ=n=>(e,i)=>{const a=[e,...i];return{labels:["Efficiency","Accessibility","Safety","Affordability","Environmental impact","Satisfaction"],datasets:a.map((s,l)=>({label:s.City,backgroundColor:"transparent",borderWidth:l===0?8:1,borderColor:n[l],pointBackgroundColor:n[l],pointBorderColor:n[l],pointHoverBackgroundColor:"#fff",pointHoverBorderColor:"rgba(34, 202, 236, 1)",pointRadius:5,data:[s.Efficiency,s.Accessibility,s.Safety,s.Affordability,s["Environmental impact"],s.Satisfaction]}))}},WQ=(n,e,i)=>{const[a,s]=ne.useState(e.filter(d=>d!==n).map(d=>i.find(f=>f.City===d)).slice(0,5));return[a,d=>f=>{const p=i.find(y=>y.City===f);s(a.map((y,_)=>_===d?p:y))}]},_5e=Rn(({className:n,...e})=>U(mX,{...e,classes:{popper:n}}))(({theme:n})=>({[`& .${pd.tooltip}`]:{backgroundColor:"#f5f5f9",color:"rgba(0, 0, 0, 0.87)",maxWidth:"30vw",fontSize:n.typography.pxToRem(12),border:"1px solid #dadde9"}})),x5e=({children:n})=>{const{classes:e}=uS(),i=jo(),[a,s]=ne.useState(!1),l=5,d=7;return _e("div",{className:e.contentWrapper,children:[_e("div",{style:{position:"absolute",top:"15.5%",left:"9vh",display:"flex",flexDirection:"column",zIndex:1e3},children:[_e("div",{style:{fontFamily:"SuisseIntl-Light",fontSize:"6.25vh",color:"#000"},children:[i==null?void 0:i.City,": ",U("br",{}),U("b",{children:"Transport"})," resilience",U("br",{}),"index",U("span",{style:{paddingTop:"-1.5vh",marginLeft:"1.2vh",fontFamily:"SuisseIntl-Light",fontSize:"3.1vh",fontWeight:400,marginTop:"1.45vh",textAlign:"center",padding:"1.4vh 2vh",verticalAlign:"middle",backgroundColor:Ys[i==null?void 0:i["Transport Resilience Index"].toUpperCase().replace(" ","_")],color:"#000",borderRadius:50,width:"fit-content"},children:i==null?void 0:i["Transport Resilience Index"]}),U(_5e,{title:U(ko,{children:_e("div",{style:{fontFamily:"SuisseIntl-Light",fontSize:"1.8vh"},children:["The assessment is based on indicators in the 'transport' category from the URI, and it is supplemented with some other metrics: ",U("br",{}),_e(Vl,{container:!0,style:{marginTop:"1vh"},spacing:2,children:[U(Vl,{item:!0,xs:l,children:U("div",{style:{fontFamily:"SuisseIntl-Light",fontSize:"1.8vh"},children:"Efficiency"})}),U(Vl,{item:!0,xs:d,children:U("div",{style:{fontFamily:"SuisseIntl-Light",fontSize:"1.8vh"},children:"Time loss in traffic, minutes"})}),U(Vl,{item:!0,xs:l,children:U("div",{style:{fontFamily:"SuisseIntl-Light",fontSize:"1.8vh"},children:"Accessibility"})}),U(Vl,{item:!0,xs:d,children:U("div",{style:{fontFamily:"SuisseIntl-Light",fontSize:"1.8vh"},children:"Share of population in 1km from public transport stops, %"})}),U(Vl,{item:!0,xs:l,children:U("div",{style:{fontFamily:"SuisseIntl-Light",fontSize:"1.8vh"},children:"Safety"})}),U(Vl,{item:!0,xs:d,children:U("div",{style:{fontFamily:"SuisseIntl-Light",fontSize:"1.8vh"},children:"Road fatalities rate per 100,000 population"})}),U(Vl,{item:!0,xs:l,children:U("div",{style:{fontFamily:"SuisseIntl-Light",fontSize:"1.8vh"},children:"Affordability"})}),U(Vl,{item:!0,xs:d,children:U("div",{style:{fontFamily:"SuisseIntl-Light",fontSize:"1.8vh"},children:"Ratio of the cost of monthly public transport usage (the cheapest option) to the average monthly income"})}),U(Vl,{item:!0,xs:l,children:U("div",{style:{fontFamily:"SuisseIntl-Light",fontSize:"1.8vh"},children:"Environmental impact"})}),U(Vl,{item:!0,xs:d,children:U("div",{style:{fontFamily:"SuisseIntl-Light",fontSize:"1.8vh"},children:"NO2 concentration, g/m3"})}),U(Vl,{item:!0,xs:l,children:U("div",{style:{fontFamily:"SuisseIntl-Light",fontSize:"1.8vh"},children:"Satisfaction"})}),U(Vl,{item:!0,xs:d,children:U("div",{style:{fontFamily:"SuisseIntl-Light",fontSize:"1.8vh"},children:"Ratio of the cost of a 1-kilometer taxi ride to average monthly income, %"})})]})]})}),placement:"bottom-start",children:U("img",{onMouseEnter:()=>s(!0),onMouseLeave:()=>s(!1),src:"/assets/infoIcon.svg",alt:"info",style:{filter:"invert(1)",marginLeft:"2vh",opacity:a?1:.5,cursor:"pointer"}})})]}),U("div",{style:{display:"flex",flexDirection:"column",gap:".5vh",marginTop:"17vh"},children:n})]}),U(nn,{style:{position:"absolute",top:"41vh",left:"9.5vh",width:"35vw",color:"#000000",fontFamily:"SuisseIntl-Light",fontSize:"1.8vh"},children:"The graph highlights the strengths and weaknesses of cities across various aspects of transport system. The further the vertices of the shape are from the center of the diagram, the better the city's performance in that particular metrics. The larger the area of the shape, the higher the overall assessment in Transport resilience."}),U("div",{className:e.pageContainer,children:_e("div",{className:e.bottomWrapper,children:[U("div",{className:e.smallTextWrapper}),_e("div",{style:{display:"flex",flexDirection:"row",gap:"2vh",marginTop:"1vh"},children:[U(oi,{onClick:()=>{},style:{pointerEvents:"all",color:"#fff",backgroundColor:"transparent",border:"1px solid rgba(255, 255, 255, 0.3)",borderRadius:50,padding:"1vh 2.5vh",textTransform:"none",fontFamily:"SuisseIntl-Light",fontSize:"1.7vh",display:"flex",flexDirection:"row",gap:"1.2vh",filter:"invert(1)",zIndex:2},children:U("div",{children:"Explore indicators"})}),_e(oi,{style:{pointerEvents:"all",color:"#fff",backgroundColor:"#2D67FF",borderRadius:50,padding:"1vh 2.5vh",textTransform:"none",fontFamily:"SuisseIntl-Light",fontSize:"1.7vh",display:"flex",flexDirection:"row",gap:"1.2vh"},onClick:()=>{const f=i.pdfName,p=document.createElement("a");p.href=`/pdf/${f}`,p.download=f,p.click()},children:[U("div",{children:"Download report"}),U("img",{src:"/assets/downloadIcon.svg",alt:"arrow down"})]})]})]})})]})},b5e=({cityDataArr:n,currentCity:e,colors:i})=>{const{classes:a}=uS(),s=n.map(_=>_.City),l=n.find(_=>_.City===e),[d,f]=WQ(e,s,n),p=v5e(),y=UQ(i)(l,d);return U("div",{style:{position:"relative",backgroundColor:"#fff"},children:_e("div",{className:a.root,children:[U("div",{style:{position:"absolute",top:"15vh",right:"8vw",width:"80vh",zIndex:1},children:U(xO,{id:"star-graph",style:{position:"absolute",left:"4vw",boxSizing:"border-box",display:"block",height:805,width:1e3},data:y,options:p})}),U(x5e,{children:U(BQ,{currentCity:e,selectedCities:d.map(_=>_.City),cities:s,colors:i,onChange:f})})]})})};CC.register(...Pke);const VQ=n=>n.map(e=>({City:e.City,...e.tr_graph})),xj=()=>{const{classes:n}=EJ(),[e,i]=ne.useState(0);ne.useState(!1);const[a,s]=ne.useState(null),[l,d]=ne.useState(!1),[f,p]=ne.useState(!1),y=oc(),{cityName:_}=y4(),b=w_.find(A=>A.City===_);b||y("/");const S=A=>{const P=document.getElementById("landing"),L=P.clientHeight,k=P.scrollTop;let R=0;A=="down"?R=k+L:A=="up"&&(R=k-L),P.scrollTo({top:R,left:0,behavior:"smooth"})};return ne.useEffect(()=>{const A=document.getElementById("landing");return A.addEventListener("wheel",P=>{P.deltaY<0||P.deltaY>0}),()=>{A.removeEventListener("scroll",S)}},[]),ne.useEffect(()=>{const A=document.getElementById("landing");return A.addEventListener("scroll",P=>{}),()=>{A.removeEventListener("scroll",S)}},[]),ne.useEffect(()=>{const A=document.getElementById("landing");A.addEventListener("scroll",P=>{const L=A.clientHeight,k=A.scrollTop,R=Math.floor(k/L);i(R)})},[]),_e(PJ,{cityData:b,children:[f&&U(Jh,{setVisible:p}),l&&U(g5e,{setTablePopupOpen:d}),U("div",{style:{position:"absolute",backgroundColor:"#203CBF",width:"100vw",height:"100vh"},children:U(MJ,{invertColors:e===3||e===4,setMenuVisible:p})}),_e("div",{className:n.root,id:"landing",children:[U(Dx,{isActive:e===0,sectionIndex:0,children:U(cCe,{setActiveSection:i})},0),U(Dx,{isActive:e===1,sectionIndex:1,children:U(uCe,{setActiveSection:i})},1),U(Dx,{isActive:e===2,sectionIndex:2,children:U(dCe,{setClickedCategory:s,clickedCategory:a,setTablePopupOpen:d})},2),U(Dx,{isActive:e===3,sectionIndex:3,children:U(b5e,{cityDataArr:VQ(w_),currentCity:b.City,colors:["#2D67FF","#00BCF8","#00DDD0","#8490FF","#AD00FF","#FF7AE2"]})},3),((b==null?void 0:b.City)==="Dubai"||(b==null?void 0:b.City)==="Dar es Salaam")&&U(Dx,{isActive:e===5,sectionIndex:5,children:U(bCe,{})},5)]}),a&&U(d5e,{category:a,city:b.City,setClickedCategory:s})]})},w5e=wr()({root:{position:"relative",width:"100%",height:"100vh",backgroundColor:"rgba(21, 52, 175, 1)"},svgBox:{position:"absolute",bottom:"5vh",left:"50%",transform:"translateX(-50%)",height:"80vh",width:"125.5vh"},svg:{position:"absolute",bottom:0,left:0,height:"100%"},toolTip:{width:"15vw"}}),S5e=wr()({root:{position:"absolute",width:"100%",height:"100%",overflowY:"auto"}}),E5e=wr()({root:{display:"flex",flexDirection:"row",alignItems:"start",gap:"8vw"},textWrapper:{maxWidth:"40vw",display:"flex",flexDirection:"row",justifyContent:"start",alignItems:"left",lineHeight:"5vh",gap:"1vh"},name:{width:"10vw",fontFamily:"SuisseIntl-Regular",fontWeight:400,fontSize:"4vh",color:"#000000",opacity:.2,margin:"0"},text:{fontFamily:"SuisseIntl-Light",fontWeight:400,fontSize:"4vh",color:"#000000",margin:"0"}}),MO=wr()({root:{position:"relative",display:"flex",flexDirection:"column",alignItems:"left",boxSizing:"border-box",padding:"0 10vh",gap:"6vh"},smallText:{fontFamily:"SuisseIntl-Regular",fontWeight:400,fontSize:"2vh",color:"#000000",margin:"0"},statusRow:{display:"flex",gap:"1vh",alignItems:"center"},text:{fontFamily:"SuisseIntl-Regular",fontWeight:400,fontSize:"4vh",color:"#000000",margin:"0"},link:{height:"3vh",width:"3vh"},textWrapper:{maxWidth:"40vw",display:"flex",flexDirection:"row",justifyContent:"start",alignItems:"left",lineHeight:"5vh",gap:"1vh"}}),M5e=wr()({root:{zIndex:2,position:"sticky",display:"flex",borderBottom:"1px solid #fff",height:"10.3vh",justifyContent:"space-between",alignItems:"center",top:0,backgroundColor:"#fff",padding:"0 10vh 0 10vh",boxSizing:"border-box"},menuIconWrapper:{cursor:"pointer",display:"flex",justifyContent:"space-between",alignItems:"center",gap:"8px"},buttonsWrapper:{display:"flex",gap:"8px",justifyContent:"space-between",alignItems:"center"},whiteText:{fontFamily:"SuisseIntl-Light",fontWeight:400,color:"#fff",textTransform:"none",fontSize:"1.8vh","&:hover":{backgroundColor:"inherit"}},signUpButton:{fontFamily:"SuisseIntl-Light",fontWeight:600,color:"#fff",textTransform:"none",fontSize:"1.8vh",height:"4.6vh",backgroundColor:"rgba(45, 103, 255, 1)",borderRadius:"50px",padding:"0.5rem 1.3rem","&:hover":{backgroundColor:"rgba(45, 103, 255, 0.85)"}}}),T5e={menu:"Menu",login:"Log in",signup:"Sign up",back:"Back to globe"},A5e=({invertColors:n,setMenuVisible:e})=>{const i=l=>T5e[l],{classes:a}=M5e(),s=oc();return _e("div",{className:a.root,style:{borderBottom:n?"1px solid #000":"1px solid #fff"},children:[_e("div",{style:{display:"flex",gap:"2.5vh",alignItems:"center"},children:[_e("div",{onClick:()=>{s("/marketplace")},style:{display:"flex",gap:"1vh",alignItems:"center",cursor:"pointer",marginRight:"2vh"},children:[U("img",{style:{width:"4.7vh"},src:"/assets/back_black.svg",width:45,alt:"logo"}),U(nn,{className:a.whiteText,style:{color:"#000"},children:"Back to project market"})]}),_e("div",{className:a.menuIconWrapper,onClick:()=>{e(!0)},children:[n?U("img",{style:{width:"4.7vh"},src:"/assets/blackMenuIcon.svg",width:45,alt:"logo"}):U("img",{style:{width:"4.7vh"},src:"/assets/menuIcon.svg",width:45,alt:"logo"}),U(nn,{className:a.whiteText,style:{color:n?"#000":"#fff"},children:i("menu")})]})]}),n?U("img",{style:{width:"7.8vh",position:"absolute",left:"50%",transform:"translateX(-50%)"},src:"/assets/blackLogo.svg",alt:"logo"}):U("img",{style:{width:"7.8vh"},src:"/assets/logo.svg",alt:"logo"}),_e("div",{className:a.buttonsWrapper,children:[U("div",{style:{width:"19vh"}}),n?U("img",{src:"/assets/blackAvatarIcon.svg",alt:"user icon"}):U("div",{style:{fontFamily:"SuisseIntl-Light",fontWeight:600,color:"#fff",textTransform:"none",fontSize:"1.8vh",height:"4.6vh",width:"fit-content",padding:"0 1.5vh",backgroundColor:"#fff",borderRadius:"50px",display:"flex",alignItems:"center"},children:U("img",{src:"/assets/avatarIcon.svg",alt:"user icon"})})]})]})},C5e=wr()({bubble:{display:"flex",flexDirection:"row",alignItems:"center",fontFamily:"SuisseIntl-Regular",fontWeight:400,fontSize:"2vh",color:"#000000",boxSizing:"border-box",border:"1px solid #ccc",padding:"1vh 2vh",borderRadius:"50px",backgroundColor:"#ffffff"},statusCircle:{width:"1vh",height:"1vh",borderRadius:"50%",marginLeft:"1vh"}}),P5e=wr()({button:{backgroundColor:"#2D67FF",boxSizing:"border-box",padding:"1vh 2vh",margin:"0",borderRadius:"50px",display:"flex",flexDirection:"row",alignItems:"center",gap:"1vh"},title:{fontFamily:"SuisseIntl-Light",fontWeight:400,fontSize:"2vh",color:"#FFFFFF",textTransform:"none"},icon:{width:"2vh",height:"2vh"}}),I5e=wr()({root:{position:"relative",height:"50vh",overflow:"hidden",borderRadius:"0 0 50px 50px"},image:{width:"100%",height:"100%",objectFit:"cover"}}),R5e=wr()({root:{display:"flex",flexDirection:"column",alignItems:"left",gap:"0.5vh",marginTop:"2vh"},title:{fontFamily:"SuisseIntl-Medium",fontWeight:500,fontSize:"8vh",lineHeight:"9vh",color:"#2D67FF",margin:"0"},subtitle:{fontFamily:"SuisseIntl-Light",fontWeight:400,fontSize:"4vh",color:"#000",margin:"0"},country:{color:"rgba(0, 0, 0, 1)"},city:{color:"rgba(0, 0, 0, 0.4)",cursor:"pointer"},location:{fontFamily:"SuisseIntl-Light",fontWeight:400,fontSize:"2.5vh",color:"rgba(0, 0, 0, 0.2)",margin:"0",display:"flex",flexDirection:"row",alignItems:"center",gap:"4px"}}),L5e=({subtitle:n,country:e,city:i,children:a,style:s})=>{const{classes:l}=R5e(),d=oc();return _e("div",{className:l.root,style:s,children:[_e("div",{children:[U(nn,{className:l.title,children:a}),U(nn,{className:l.subtitle,children:n})]}),_e(nn,{className:l.location,children:[U("span",{className:l.country,children:e})," / ",U("span",{className:l.city,onClick:()=>{d("/city/"+i)},children:i})]})]})},GQ=({title:n,onClick:e,disabled:i,variant:a,style:s})=>{const{classes:l}=P5e();return U("div",{className:l.button,onClick:e,style:s||{opacity:i?.5:1,cursor:i?"default":"pointer",pointerEvents:i?"none":"auto"},children:a==="icon"?_e(ko,{children:[U("img",{className:l.icon,src:"/assets/like_icon.svg",alt:"icon"}),U(nn,{className:l.title,children:n})]}):U(nn,{className:l.title,children:n})})},k5e=({imageURL:n,style:e})=>{const{classes:i}=I5e();return _e("div",{className:i.root,style:e,children:[U("img",{className:i.image,src:n,alt:"project image"}),U("div",{style:{position:"absolute",bottom:"4vh",left:"4vh"},children:U(GQ,{title:"Add project to Portfolio",variant:"icon"})})]})},D5e=({parametrs:n,investment:e,newJobs:i,startYear:a,contractType:s})=>{const{classes:l}=MO();return U("div",{style:{display:"flex",flexDirection:"row",gap:"2vw",flex:5},children:_e("div",{style:{display:"flex",flexDirection:"column",gap:"2vh"},children:[_e("div",{style:{display:"flex",flexDirection:"row",gap:"2vh"},children:[U(nn,{className:l.smallText,style:{width:"11vw"},children:"Parameters"}),U(nn,{className:l.smallText,style:{maxWidth:"29vw"},children:n})]}),_e("div",{style:{display:"flex",flexDirection:"row",gap:"2vh"},children:[U(nn,{className:l.smallText,style:{width:"11vw"},children:"Investment, $USD M"}),U(nn,{className:l.smallText,style:{maxWidth:"29vw"},children:e})]}),_e("div",{style:{display:"flex",flexDirection:"row",gap:"2vh"},children:[U(nn,{className:l.smallText,style:{width:"11vw"},children:"New jobs"}),U(nn,{className:l.smallText,style:{maxWidth:"29vw"},children:i})]}),_e("div",{style:{display:"flex",flexDirection:"row",gap:"2vh"},children:[U(nn,{className:l.smallText,style:{width:"11vw"},children:"Start, year"}),U(nn,{className:l.smallText,style:{maxWidth:"29vw"},children:a})]}),_e("div",{style:{display:"flex",flexDirection:"row",gap:"2vh"},children:[U(nn,{className:l.smallText,style:{width:"11vw"},children:"Contract type"}),U(nn,{className:l.smallText,style:{maxWidth:"29vw"},children:s})]})]})})},Mg=({title:n,value:e,style:i,children:a})=>{let s="#000";if(e)switch(e){case"Very strong":s="#35CB00";break;case"Strong":s="#A0DA8B";break;case"Average":s="#FF9B3F";break;case"Low":s="#FF632F";break;case"Very low":s="#FF3B29";break;default:s="#000";break}const{classes:l}=C5e();return e?_e("div",{className:l.bubble,style:i,children:[n,U("div",{className:l.statusCircle,style:{background:s}}),a]}):_e("div",{className:l.bubble,style:i,children:[n,a]})},z5e=({status:n,resilienceImpact:e,directImpact:i,indirectImpact:a})=>{const{classes:s}=MO();let l="#000";switch(e){case"Very strong":l="#35CB00";break;case"Strong":l="#A0DA8B";break;case"Average":l="#FF9B3F";break;case"Low":l="#FF632F";break;case"Very low":l="#FF3B29";break;default:l="#000";break}return U("div",{style:{display:"flex",flexDirection:"row",alignContent:"space-between",gap:"5vw",flex:5},children:_e("div",{style:{display:"flex",flexDirection:"column",gap:"2vh"},children:[_e("div",{className:s.statusRow,children:[U(nn,{className:s.smallText,style:{width:"9vw"},children:"Status"}),U(Mg,{title:n.title,value:n.value})]}),_e("div",{className:s.statusRow,children:[U(nn,{className:s.smallText,style:{width:"9vw"},children:"Resilience impact"}),U(Mg,{title:e,style:{borderColor:l,color:l}})]}),_e("div",{className:s.statusRow,children:[U(nn,{className:s.smallText,style:{width:"9vw"},children:"Direct impact"}),i.map((d,f)=>U(Mg,{title:d.title,value:d.value},f))]}),_e("div",{className:s.statusRow,children:[U(nn,{className:s.smallText,style:{width:"9vw"},children:"Indirect impact"}),a.map((d,f)=>U(Mg,{title:d.title,value:d.value},f))]})]})})},bj=()=>U("div",{style:{width:"100%",height:"1px",backgroundColor:"#000",margin:"0"}}),VE=({name:n,text:e,children:i})=>{const{classes:a}=E5e();return _e("div",{className:a.root,children:[U("div",{className:a.name,children:n}),e&&U("div",{className:a.textWrapper,children:U("div",{className:a.text,children:e})}),i]})},XL=[{ID:8,Country:"Kazakhstan",City:"Almaty",Category:"Inclusion, SME",Searching_for:"Operation & management",Status:"Implementation",Project:"Women Entrepreneurship Development Centers",Desciption:"To provide training and networking opportunities to around 7,000 women.",TitleBlue:" in Almaty",Parametres:"To provide training and networking opportunities to around 7,000 women.",Participation_options:"Operation & management",Goals:"Creation of safe and inclusive business environment, delivering specialized training and capacity building programs to over 15,000 women entrepreneurs across the country by 2025",Investment:200,New_Jobs:7e3,Start_Date:2020,End_Date:2025,Contract_type:"Design-Build",Resilience_Impact:"Average",Direct_Impact:"Inclusion, SME",Indirect_Impact:"Wealth",Location:"https://maps.app.goo.gl/o6eM4KX36KX6zXCU8",Website:"https://www.adb.org/results/building-better-normal-women-entrepreneurs-kazakhstan",News_Sources:"https://www.undp.org/kazakhstan/news/women-entrepreneurship-development-centers-are-opening-all-regions-kazakhstan",News_Headers:"15 March 2022. Women entrepreneurship development centers are opening in all regions of Kazakhstan",Initiator:"the National Commission for Women's Affairs and Family and Population Policy under the President of the Republic of Kazakhstan",Financial_Partners:"Ministry of National Economy, the National Commission for Women's Affairs and Family and Population Policy under the President of the Republic of Kazakhstan, NCE Atameken, Asian Development Bank, the United Nations Development Programme (UNDP) in Kazakhstan.",url:"/assets/PROJECTS/Inclusion.jpg"},{ID:15,Country:"Tanzania",City:"Dar es Salaam",Category:"Water Availability, Water Pollution",Searching_for:"Construction",Status:"Implementation",Project:"New wastewater treatment plant",TitleBlue:" in Dar es Salaam region",Desciption:"Consturction of a new wastewater treatment plant. The project is expected to reduce environmental pollution through safe treatment of wastewater.",Parametres:"New 16K m3 per day wastewater treatment plant",Participation_options:"Construction",Goals:"A new the 16,000 m3/day wastewater plant will mitigate the environmental impact of a growing city and improve the access to clean water.",Investment:178,New_Jobs:40,Start_Date:2023,End_Date:2024,Contract_type:"Design-Build-Operate",Resilience_Impact:"Very strong",Direct_Impact:"Water Availability, Water Pollution",Indirect_Impact:"Health",Location:"https://maps.app.goo.gl/rA2JU3DPmYb1MeXT7",Website:"https://www.maji.go.tz/uploads/publications/sw1683132047-MBEZI%20BEACH%20SEWERAGE%20PROJECT_%20ESIA%20EXECUTIVE%20SUMMARY%20ENGLISH.pdf",News_Sources:"https://www.metito.com/news-detail/tanzania-to-develop-its-first-wastewater-treatment-plant-project-dar-es-salaam-water-supply-and-sanitation-authority-appoints-metito-to-develop-the-first-of-its-type-project/",News_Headers:"4 April 2023. Tanzania to develop its first wastewater treatment plant project Dar es Salaam Water Supply and Sanitation Authority appoints Metito to develop the first of its type project",Initiator:"Dar Es Salaam Water Supply and Sanitation Authority (DAWASA)",Financial_Partners:"Tanzanian Government, the World Bank",Contracting_Party:"Metito",url:"/assets/PROJECTS/Water_Pollution.jpg"}],O5e=({projectID:n})=>{let e=XL[0];n==="8"?e=XL[0]:n==="15"&&(e=XL[1]);let i;switch(e.Status){case"Suspended":i="Very low";break;case"Planning":i="Low";break;case"Implementation":i="Average";break;case"Completed":i="Very strong";break;default:i="Very low";break}const a=e.Direct_Impact.split(", ").map(d=>({title:d})),s=e.Indirect_Impact.split(", ").map(d=>({title:d})),{classes:l}=MO();return _e("div",{className:l.root,children:[_e("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",width:"100%",height:"100%",backgroundColor:"#fff"},children:[_e(L5e,{country:e.Country,city:e.City,style:{flex:5},children:[e.Project,U("span",{style:{color:"#000",fontFamily:"SuisseIntl-Light",fontWeight:400},children:e.TitleBlue})]}),U("div",{style:{flex:1}}),U(k5e,{imageURL:e.url,style:{flex:5}})]}),_e("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"flex-start",width:"100%",height:"100%",backgroundColor:"#fff"},children:[U(D5e,{parametrs:e.Parametres,investment:e.Investment,newJobs:e.New_Jobs,startYear:e.Start_Date,contractType:e.Contract_type}),U("div",{style:{flex:1}}),U(z5e,{status:{title:e.Status,value:i},resilienceImpact:e.Resilience_Impact,directImpact:a,indirectImpact:s})]}),U(bj,{}),U(VE,{name:"Initiator",children:_e("div",{style:{display:"flex",flexDirection:"column",justifyContent:"start",alignItems:"left",gap:"2vh",width:"fit-content"},children:[U("div",{className:l.textWrapper,style:{maxWidth:"100%"},children:U(nn,{className:l.text,children:e.Initiator})}),U(Mg,{title:"Contact initiator",style:{color:"#ffffff",backgroundColor:"#000000",width:"fit-content",padding:"1.2vh 3vh"}})]})}),U(VE,{name:"Financial partners",children:U("div",{style:{display:"flex",flexDirection:"column",justifyContent:"start",alignItems:"left",gap:0},children:e.Financial_Partners.split(", ").map(d=>U("div",{className:l.textWrapper,style:{maxWidth:"100%"},children:U(nn,{className:l.text,children:d})}))})}),U(bj,{}),U(VE,{name:"Participation options",children:U("div",{style:{display:"flex",flexDirection:"row",justifyContent:"start",alignItems:"center",gap:"2vh",flexWrap:"wrap",maxWidth:"50vw"},children:e.Participation_options.split(", ").map(d=>U(Mg,{title:d,style:{color:"#000000",border:"1px solid #000000",backgroundColor:"#FFFFFF",width:"fit-content",fontSize:"4vh",padding:"1.2vh 3vh"}}))})}),U(VE,{name:"Project description",children:U("div",{className:l.textWrapper,style:{flexDirection:"column",maxWidth:"100%",gap:"4vh"},children:U(nn,{className:l.text,children:e.Desciption})})}),U(Mg,{title:"Download project",style:{color:"#ffffff",backgroundColor:"#000000",width:"fit-content",marginLeft:"18vw",padding:"1.2vh 3vh"},children:U("img",{src:"/assets/projects_download_icon.svg",style:{width:"2vh",height:"2vh",marginLeft:"1vh"}})}),U("div",{style:{height:"1vh"}})]})},GE=Rn(({className:n,...e})=>U(mX,{...e,classes:{popper:n}}))(({theme:n})=>({[`& .${pd.tooltip}`]:{backgroundColor:"rgba(0, 0, 0, 0)",color:"rgba(0, 0, 0, 0)",maxWidth:220,fontSize:n.typography.pxToRem(12)}})),N5e=({city:n})=>{const{classes:e}=w5e();let i="";switch(n){case"Almaty":i="/assets/pm_schemes/Almaty.svg";break;case"Dar es Salaam":i="/assets/pm_schemes/Dar_es_Salaam.svg";break;default:i="/assets/pm_schemes/Almaty.svg";break}return ne.useState({city:"",category:""}),_e("div",{className:e.root,children:[U("div",{style:{position:"absolute",top:"5vh",left:"5vw",fontFamily:"SuisseIntl-Light",fontWeight:400,fontSize:"8vh",lineHeight:"9vh",color:"#fff",margin:"0"},children:"Project impact"}),_e("div",{className:e.svgBox,children:[U("img",{src:i,className:e.svg,alt:"project impact"}),n==="Almaty"?_e(ko,{children:[U(GE,{title:U(ko,{children:U("img",{src:"/assets/tooltip/SME.svg",alt:"SME data",className:e.toolTip})}),children:U("div",{style:{position:"absolute",width:"4.4vh",height:"4.4vh",top:"42.2vh",right:"47.4vh",borderRadius:"50%"}})}),U(GE,{title:U(ko,{children:U("img",{src:"/assets/tooltip/Inclusion.svg",alt:"Inclusion data",className:e.toolTip})}),children:U("div",{style:{position:"absolute",width:"5vh",height:"5vh",left:"45.9vh",borderRadius:"50%",top:"42.3vh"}})})]}):_e(ko,{children:[U(GE,{title:U(ko,{children:U("img",{src:"/assets/tooltip/Water_availability.svg",alt:"Water_availability data",className:e.toolTip})}),children:U("div",{style:{position:"absolute",width:"5vh",height:"5vh",top:"37.5vh",right:"47.5vh",borderRadius:"50%"}})}),U(GE,{title:U(ko,{children:U("img",{src:"/assets/tooltip/Water_pollution.svg",alt:"Water_pollution data",className:e.toolTip})}),children:U("div",{style:{position:"absolute",width:"6vh",height:"6vh",left:"45.5vh",borderRadius:"50%",top:"37.5vh"}})})]})]}),U(GQ,{title:"Add project to Portfolio",variant:"icon",style:{position:"absolute",bottom:"5vh",right:"5vw",fontFamily:"SuisseIntl-Light",fontWeight:400,fontSize:"8vh",lineHeight:"9vh",color:"#fff",margin:"0"}})]})},F5e=()=>{const{projectID:n}=y4(),[e,i]=ne.useState(!1),{classes:a}=S5e();let s="Almaty";return n==="8"?s="Almaty":n==="15"&&(s="Dar es Salaam"),_e(ko,{children:[e&&U(Jh,{setVisible:i}),_e("div",{className:a.root,children:[U(A5e,{invertColors:!0,setMenuVisible:i}),U(O5e,{projectID:n}),U(N5e,{city:s})]})]})},B5e={menu:"Menu",login:"Log in",signup:"Sign up",back:"Back to globe"},U5e=({invertColors:n,setMenuVisible:e})=>{const i=s=>B5e[s],{classes:a}=Jw();return oc(),_e("div",{className:a.root,style:{margin:"0 10vh 0 10vh",borderBottom:n?"1px solid #000":"1px solid #fff"},children:[U("div",{style:{display:"flex",gap:"2.5vh",alignItems:"center"},children:_e("div",{className:a.menuIconWrapper,onClick:()=>{e(!0)},children:[n?U("img",{style:{width:"4.7vh"},src:"/assets/blackMenuIcon.svg",width:45,alt:"logo"}):U("img",{style:{width:"4.7vh"},src:"/assets/menuIcon.svg",width:45,alt:"logo"}),U(nn,{className:a.whiteText,style:{color:n?"#000":"#fff"},children:i("menu")})]})}),n?U("img",{style:{width:"7.8vh"},src:"/assets/blackLogo.svg",alt:"logo"}):U("img",{style:{width:"7.8vh"},src:"/assets/logo.svg",alt:"logo"}),_e("div",{className:a.buttonsWrapper,children:[U("div",{style:{width:"5vh"}}),n?U("img",{src:"/assets/blackAvatarIcon.svg",alt:"user icon"}):U("div",{style:{fontFamily:"SuisseIntl-Light",fontWeight:600,color:"#fff",textTransform:"none",fontSize:"1.8vh",height:"4.6vh",width:"fit-content",padding:"0 1.5vh",backgroundColor:"#fff",borderRadius:"50px",display:"flex",alignItems:"center"},children:U("img",{src:"/assets/avatarIcon.svg",alt:"user icon"})})]})]})},IC=wr()({contentWrapper:{position:"relative",overflowY:"scroll",margin:"0 10vh",height:"calc(100vh - 10.3vh)"},title:{fontFamily:"SuisseIntl-Light",fontWeight:400,fontSize:"6.8vh",margin:"2vh 0vh 4vh"},titleBold:{fontFamily:"SuisseIntl-Regular",fontWeight:"700"},filtersAndProjectsWrapper:{display:"flex",flexDirection:"row",marginBottom:"10vh",gap:"2vh"},filtersWrapper:{flex:1},projectsWrapper:{flex:4,display:"flex",flexDirection:"row",flexWrap:"wrap",rowGap:"4vh",columnGap:"4vh",justifyContent:"flex-start",alignItems:"flex-start",height:"fit-content"},addProjectBtn:{position:"sticky",zIndex:1,top:"2vh",backgroundColor:"#000",color:"#fff",borderRadius:"50px",textTransform:"none",fontSize:"2.1vh",display:"flex",flexDirection:"row",gap:"1vh",padding:"1.5vh 3vh",textWrap:"nowrap"},filterGroupHeader:{fontFamily:"SuisseIntl-Light",fontWeight:400,fontSize:"3.5vh",marginTop:"4vh",marginBottom:"1vh",textWrap:"nowrap"},filterList:{overflow:"visible",display:"flex",flexDirection:"column",gap:"0"},filterRow:{fontFamily:"SuisseIntl-Light",fontWeight:400,fontSize:"2.1vh",display:"flex",flexDirection:"row",justifyContent:"flex-start",alignItems:"center",marginLeft:"-1vh",textWrap:"nowrap"},moreFiltersBtn:{fontFamily:"SuisseIntl-Light",fontWeight:400,fontSize:"2.1vh",color:"#000",cursor:"pointer",marginTop:"1vh",opacity:"0.5"},projectItem:{position:"relative",overflow:"hidden",borderRadius:"3vh",backgroundColor:"#fff",width:"25vh",height:"45vh",display:"flex",flexDirection:"column",justifyContent:"flex-start",alignItems:"center",border:"1px solid #CCCCCC"},statItem:{fontFamily:"SuisseIntl-Light",fontWeight:800,color:"#35CB00",border:"1px solid rgba(53, 203, 0, 0.5)",padding:"1vh 1.5vh",borderRadius:"50px",fontSize:"1.4vh",width:"fit-content"},projectImageWrapper:{width:"100%",height:"15vh",overflow:"hidden",backgroundSize:"cover",backgroundPosition:"center"},projectInfoWrapper:{display:"flex",flexDirection:"column",gap:"1vh",padding:"0 1.5vh",height:"20vh"},projectTitle:{cursor:"pointer",fontFamily:"SuisseIntl-Regular",fontWeight:600,fontSize:"1.8vh"},projectSubTitle:{fontFamily:"SuisseIntl-Light",fontWeight:400,fontSize:"1.5vh",opacity:"0.5"},projectStatsWrapper:{display:"flex",flexDirection:"row",alignItems:"center",gap:"1.5vh"},impactLabel:{fontFamily:"SuisseIntl-Regular",fontWeight:100,fontSize:"1.5vh"},likeBtn:{backgroundColor:"#2D67FF",fontSize:"1.5vh",color:"#fff",borderRadius:"50px",display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"flex-start",justifySelf:"flex-end",gap:"2vh",padding:".7vh 1.5vh",textTransform:"none",width:"21vh","&:hover":{backgroundColor:"#000"}},projectsOnMapBtn:{position:"absolute",top:"9vh",right:"6vw",zIndex:200,cursor:"pointer",width:"12vh",height:"12vh"}}),wj={"Very Low":Ys.VERY_LOW,Low:Ys.LOW,Average:Ys.AVERAGE,Strong:Ys.STRONG,"Very Strong":Ys.VERY_STRONG},W5e={Suspended:Ys.VERY_LOW,Planning:Ys.LOW,Implementation:Ys.AVERAGE,Completed:Ys.VERY_STRONG},V5e=({project:n,isLiked:e,setLikedProjects:i})=>{const{classes:a}=IC(),s=oc(),[l,d]=ne.useState(!1);ne.useEffect(()=>{d(e)},[e]);const f=()=>{d(!l),i(y=>l?y.filter(_=>_.id!==n.id):[...y,n]);const p=localStorage.getItem("grp:likedProjects");if(p){const y=JSON.parse(p);if(l){const _=y.filter(b=>b.id!==n.id);localStorage.setItem("grp:likedProjects",JSON.stringify(_))}else localStorage.setItem("grp:likedProjects",JSON.stringify([...y,n]))}else localStorage.setItem("grp:likedProjects",JSON.stringify([n]))};return _e("div",{className:a.projectItem,style:{opacity:n.id==8||n.id==15?1:.6},children:[_e("div",{style:{position:"absolute",right:"1.2vh",top:"1.2vh",backgroundColor:"#fff",padding:"0.5vh 1vh 0.5vh 1vh",borderRadius:"2vh",display:"flex",flexDirection:"row",alignItems:"center",gap:"0.5vh",fontFamily:"SuisseIntl-Light",fontWeight:600,fontSize:"1.4vh"},children:[n.Status,U("div",{style:{width:"1.2vh",height:"1.2vh",borderRadius:"50%",backgroundColor:W5e[n.Status]}})]}),U("div",{className:a.projectImageWrapper,style:{backgroundImage:`url(${n.url})`}}),_e("div",{className:a.projectInfoWrapper,children:[_e("div",{style:{fontFamily:"SuisseIntl-Light",fontWeight:600,fontSize:"1.4vh",marginTop:"2vh"},children:[n.City,", ",n.Country]}),_e("div",{className:a.projectTitle,onClick:()=>{(n.id==8||n.id==15)&&s(`/project_page/${n.id}`)},children:[n.Project," ",U("img",{src:"/assets/arrowRightIcon.svg",alt:"arrowRightIcon"})]}),U("div",{className:a.projectSubTitle,children:n.Description})]}),_e("div",{style:{display:"flex",flexDirection:"column-reverse",height:"10vh"},children:[_e(oi,{onClick:f,className:a.likeBtn,style:{marginBottom:"2vh"},children:[U("img",{src:l?"/assets/likeIconFill.svg":"/assets/likeIcon.svg",alt:"likeIcon",style:{width:"1.8vh",height:"1.8vh"}}),"Add to Portfolio"]}),_e("div",{className:a.projectStatsWrapper,style:{marginBottom:"2vh"},children:[U("div",{className:a.impactLabel,children:"Impact"}),U("div",{className:a.statItem,style:{color:wj[n["Resilience Impact"]],borderColor:`${wj[n["Resilience Impact"]]}30`},children:n["Resilience Impact"]})]})]})]})},Jg=[{id:1,Country:"Kazakhstan",City:"Almaty",Category:"Air Pollution, Energy Availability","Searching for":"Finance",Status:"Implementation",Project:"Modernisation of CHP-2 (TETs-2)",Description:"Conversion from coal to gas, increase in installed capacity from 510 to 600 MW","Resilience Impact":"Very strong",url:"/assets/PROJECTS/Air_Pollution.jpg"},{id:2,Country:"Kazakhstan",City:"Almaty",Category:"Transport","Searching for":"Construction",Status:"Implementation",Project:"Expansion and Modernisation of the International Airport",Description:"The international passenger terminal with an area of 53K m","Resilience Impact":"Low",url:"/assets/PROJECTS/Transport.jpg"},{id:3,Country:"Kazakhstan",City:"Almaty",Category:"Water Pollution, Natural disaster hazards","Searching for":"Construction",Status:"Implementation",Project:"Reconstruction of Aryk Water Drainage Networks",Description:"Constuction of 376 km of aryk water drainage network","Resilience Impact":"Very strong",url:"/assets/PROJECTS/Water_Pollution.jpg"},{id:4,Country:"Kazakhstan",City:"Almaty",Category:"Transport","Searching for":"Construction",Status:"Completed",Project:"Big Ring Almaty Road (BAKAD)",Description:"onstruction of a 66-km first class bypass road","Resilience Impact":"Strong",url:"/assets/PROJECTS/Transport.jpg"},{id:5,Country:"Kazakhstan",City:"Almaty",Category:"Transport","Searching for":"Finance",Status:"Implementation",Project:"Renewal of Electric Public Transport",Description:"Acquisition of 190 modern trolleybuses and rehabilitation of 10 power supply sub-stations","Resilience Impact":"Strong",url:"/assets/PROJECTS/Transport.jpg"},{id:6,Country:"Kazakhstan",City:"Almaty",Category:"Liveability, Energy Availability","Searching for":"Finance",Status:"Suspended",Project:"Modernisation of Outdoor Lighting",Description:"Replacement with modern luminaires and supports for 45K+ light points","Resilience Impact":"Strong",url:"/assets/PROJECTS/Livability.jpg"},{id:7,Country:"Kazakhstan",City:"Almaty",Category:"Accountability, Public Services","Searching for":"Finance",Status:"Implementation",Project:'Public Reception Office "Open Almaty"',Description:'Creation of a public reception centre on the principle of "one window"',"Resilience Impact":"Low",url:"/assets/PROJECTS/Public_Services.jpg"},{id:8,Country:"Kazakhstan",City:"Almaty",Category:"Inclusion, SME",Status:"Implementation",Project:"Women Entrepreneurship Development Centres",Description:"Provide training and networking opportunities to around 7K women","Resilience Impact":"Average",url:"/assets/PROJECTS/Inclusion.jpg"},{id:9,Country:"Kazakhstan",City:"Almaty",Category:"Sustainability Commitment, Inclusion",Status:"Completed",Project:"Involvement of Youth in Solving ESG Problems",Description:"Raising sustainability awareness among future decision makers","Resilience Impact":"Low",url:"/assets/PROJECTS/Inclusion.jpg"},{id:10,Country:"Tanzania",City:"Dar es Salaam",Category:"Greening, Air Pollution, Land use and waste","Searching for":"Finance",Status:"Implementation",Project:"Urban Greening",Description:"Facilitating greening interventions to prevent surface water runoff and soil erosion","Resilience Impact":"Strong",url:"/assets/PROJECTS/Land_use_and_waste.jpg"},{id:11,Country:"Tanzania",City:"Dar es Salaam",Category:"Land use and waste","Searching for":"Finance",Status:"Planning",Project:"Waste Collection and Management",Description:"Creation of the centralised waste collection, management and recycling system","Resilience Impact":"Very strong",url:"/assets/PROJECTS/Land_use_and_waste.jpg"},{id:12,Country:"Tanzania",City:"Dar es Salaam",Category:"Air Pollution, Energy Availability","Searching for":"Finance",Status:"Planning",Project:"CNG and PNG Distribution Network ",Description:"New gas distribution trunk pipelines to form a complete network","Resilience Impact":"Very strong",url:"/assets/PROJECTS/Air_Pollution.jpg"},{id:13,Country:"Tanzania",City:"Dar es Salaam",Category:"SME, Wealth","Searching for":"Finance",Status:"Planning",Project:"Expansion of the Nyerere Trade Fair Ground",Description:"Construction halls, an expo village, conference halls, and banking ","Resilience Impact":"Low",url:"/assets/PROJECTS/Wealth.jpg"},{id:14,Country:"Tanzania",City:"Dar es Salaam",Category:"Transport","Searching for":"Finance",Status:"Planning",Project:"Procurement and Repair of Rolling Stocks of the Railways",Description:"Revamp of railway operations of the Central Line to Kigoma and Mwanza","Resilience Impact":"Very strong",url:"/assets/PROJECTS/Transport.jpg"},{id:15,Country:"Tanzania",City:"Dar es Salaam",Category:"Water Availability, Water Pollution","Searching for":"Construction",Status:"Implementation",Project:"New Wastewater Treatment Plant",Description:"New 16K m3 per day wastewater treatment plant","Resilience Impact":"Very strong",url:"/assets/PROJECTS/Water_Pollution.jpg"},{id:16,Country:"Tanzania",City:"Dar es Salaam",Category:"Transport, Air Pollution","Searching for":"Finance",Status:"Implementation",Project:"Bus Rapid Transit Project  Phase 2",Description:"20.3 km of exclusive BRT lanes along Kilwa Road","Resilience Impact":"Very strong",url:"/assets/PROJECTS/Transport.jpg"},{id:17,Country:"Tanzania",City:"Dar es Salaam",Category:"Accountability, Health","Searching for":"",Status:"Completed",Project:"Covid-19 Crisis Response Budget Support",Description:"Creation a national Covid-19 response plan and mitigation measures","Resilience Impact":"Average",url:"/assets/PROJECTS/Health.jpg"}],HE=({title:n,checked:e,onChange:i})=>{const{classes:a}=IC(),s=()=>{i&&i(n)};return U("div",{children:_e("div",{className:a.filterRow,children:[U(Kq,{checked:e,style:{marginLeft:"0"},onChange:s}),U("div",{children:n})]})})},G5e=()=>{const e=[...new Set(Jg.map(i=>i.Category))].map(i=>i.split(", ")).flat();return new Set(e)},H5e=()=>{const n=Jg.map(e=>e["Searching for"]);return new Set(n.filter(e=>e))},j5e=()=>{const n=Jg.map(e=>e.Status);return new Set(n.filter(e=>e))},$5e=()=>{const n=Jg.map(e=>e.Country);return new Set(n.filter(e=>e))},Y5e=({setFilteredProjects:n})=>{const{classes:e}=IC(),[i,a]=ne.useState(!1),s=H5e(),l=j5e(),d=G5e(),f=$5e(),[p,y]=ne.useState({categories:new Set,searchFor:new Set,statuses:new Set,countries:new Set});ne.useEffect(()=>{if(!p.categories.size&&!p.searchFor.size&&!p.statuses.size&&!p.countries.size){n(Jg);return}else{let b=Jg;p.categories.size&&(b=b.filter(S=>Array.from(p.categories).some(A=>S.Category.includes(A)))),p.searchFor.size&&(b=b.filter(S=>Array.from(p.searchFor).some(A=>S["Searching for"]?S["Searching for"].includes(A):!1))),p.statuses.size&&(b=b.filter(S=>Array.from(p.statuses).some(A=>S.Status.includes(A)))),p.countries.size&&(b=b.filter(S=>Array.from(p.countries).some(A=>S.Country.includes(A)))),n(b)}},[p]);const _=(b,S)=>{p[S].has(b)?p[S].delete(b):p[S].add(b),y({...p})};return _e("div",{children:[U("div",{className:e.filterGroupHeader,children:"Searching for"}),U("div",{className:e.filterList,children:Array.from(s).map(b=>U(HE,{title:b,checked:p.searchFor.has(b),onChange:S=>_(S,"searchFor")},b))}),U("div",{className:e.filterGroupHeader,children:"Status"}),U("div",{className:e.filterList,children:Array.from(l).map(b=>U(HE,{title:b,checked:p.statuses.has(b),onChange:S=>_(S,"statuses")},b))}),U("div",{className:e.filterGroupHeader,children:"Category"}),_e("div",{className:e.filterList,children:[Array.from(d).slice(0,i?d.size:3).map(b=>U(HE,{title:b,checked:p.categories.has(b),onChange:S=>_(S,"categories")},b)),U("div",{className:e.moreFiltersBtn,onClick:()=>a(!i),children:i?"Show less":"More categories"})]}),U("div",{className:e.filterGroupHeader,children:"Country"}),U("div",{className:e.filterList,children:Array.from(f).map(b=>U(HE,{title:b,checked:p.countries.has(b),onChange:S=>_(S,"countries")},b))})]})},q5e=()=>{const{classes:n}=IC(),[e,i]=ne.useState(Jg.sort((f,p)=>f.id==8||f.id==15?-1:p.id==8||p.id==15?1:0)),[a,s]=ne.useState([]),[l,d]=ne.useState(!1);return ne.useEffect(()=>{const f=localStorage.getItem("grp:likedProjects");f&&s(JSON.parse(f))},[]),_e("div",{children:[l&&U(Jh,{setVisible:d}),U(U5e,{invertColors:!0,setMenuVisible:d}),U("img",{src:"/assets/projectsOnMapBtn.svg",alt:"projectsOnMapBtn",className:n.projectsOnMapBtn}),U(dve,{direction:"up",in:a.length>0,mountOnEnter:!0,unmountOnExit:!0,children:_e("div",{style:{position:"absolute",left:"10vh",bottom:"4vh",backgroundColor:"#000",color:"#fff",zIndex:1,borderTopRightRadius:"2vh",borderTopLeftRadius:"2vh",borderBottomRightRadius:"4vh",borderBottomLeftRadius:"4vh",padding:"2vh",display:"flex",flexDirection:"column",gap:"1vh"},children:[_e("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center",gap:"1vh"},children:[U("img",{src:"/assets/likeIconFill.svg",alt:"likeIcon",style:{width:"2.5vh",height:"2.5vh"}}),_e("div",{style:{fontFamily:"SuisseIntl-Regular",fontWeight:100,fontSize:"1.8vh"},children:[a.length+" "," projects added"]})]}),_e(oi,{className:n.likeBtn,style:{alignItems:"center",justifyContent:"center",fontSize:"1.8vh"},children:["Check your Portfolio"," "]})]})}),_e("div",{className:n.contentWrapper,children:[_e("div",{className:n.title,children:["Project ",U("span",{className:n.titleBold,children:"marketplace"})]}),_e("div",{className:n.filtersAndProjectsWrapper,children:[_e("div",{className:n.filtersWrapper,children:[_e(oi,{className:n.addProjectBtn,children:[U("img",{src:"/assets/plusIconWhite.svg",alt:"plus"}),"Add project"]}),U(Y5e,{setFilteredProjects:i})]}),U("div",{className:n.projectsWrapper,children:e.map(f=>U(V5e,{project:f,isLiked:a.some(p=>p.id===f.id),setLikedProjects:s},f.id))})]})]})]})},RC=wr()({root:{position:"absolute",top:0,left:0,width:"100%",height:"100%",backgroundImage:"url(/assets/mainPageBg.png)",backgroundSize:"cover",backgroundRepeat:"no-repeat",backgroundPosition:"center"},title:{fontFamily:"SuisseIntl-Light",fontWeight:400,fontSize:"6vh",display:"flex",justifyContent:"center",alignItems:"center",textAlign:"center",color:"#fff",marginTop:"5vh"},content:{display:"flex",flexDirection:"row",width:"100%",color:"#fff",fontFamily:"SuisseIntl-Light",fontWeight:400,fontSize:"4.5vh",marginTop:"15vh"},sectionWrapper:{flex:1,paddingLeft:"15vh"},smallTextGroupWrapper:{display:"flex",flexDirection:"row",fontSize:"2vh",gap:"5vh",marginTop:"4vh"},smallTextWrapper:{alignSelf:"flex-start",display:"flex",flexDirection:"column",gap:"1vh",textWrap:"nowrap"},sectionTitle:{alignSelf:"flex-end"},whiteButton:{fontFamily:"SuisseIntl-Light",fontWeight:600,backgroundColor:"#fff",color:"#000",width:"fit-content",padding:"1vh 3vh",borderRadius:"4vh",textTransform:"none",fontSize:"2.8vh",display:"flex",justifyContent:"center",alignItems:"center",gap:"1vh","&:hover":{backgroundColor:"#fff"}}}),X5e=()=>{const{classes:n}=RC();return U("div",{className:n.title,children:_e("div",{children:[_e("span",{style:{fontFamily:"SuisseIntl-Regular",fontWeight:600},children:["Global Resilience Platform"," "]}),"is a data-driven ",U("br",{}),"resilience diagnostic observatory for the",U("br",{})," Global South which provides"]})})},Z5e=()=>{const{classes:n}=RC(),[e,i]=ne.useState(!1);return _e("div",{className:n.root,children:[e&&U(Jh,{setVisible:i}),U(MJ,{setMenuVisible:i,displayBackButton:!0,marginLogo:"15vh"}),U(X5e,{}),_e("div",{className:n.content,children:[U(K5e,{}),U(J5e,{})]})]})},jE={title:_e(ko,{children:[U("b",{children:"Ratings & monitoring"}),U("br",{})," tool for cities and ",U("br",{})," corporates"]}),first:_e("div",{children:["Reimagining ESG ",U("br",{}),"metrics through the ",U("br",{})," lens of Resilience"]}),second:_e("div",{children:["Focusing on basic ",U("br",{})," needs satisfaction ",U("br",{})," and humans dignity"]}),third:_e("div",{children:["Introducing ",U("br",{}),"transparent ",U("br",{}),"methodology & AI-",U("br",{}),"driven data handling"]})},K5e=()=>{const{classes:n}=RC(),e=oc();return _e("div",{className:n.sectionWrapper,children:[U("div",{className:n.sectionTitle,children:jE.title}),_e("div",{className:n.smallTextGroupWrapper,children:[_e("div",{className:n.smallTextWrapper,children:[U(e_,{}),jE.first]}),_e("div",{className:n.smallTextWrapper,children:[U(e_,{}),jE.second]}),_e("div",{className:n.smallTextWrapper,children:[U(e_,{}),jE.third]})]}),_e("div",{style:{display:"flex",flexDirection:"row",gap:"2vh",marginTop:"5vh"},children:[_e(oi,{className:n.whiteButton,onClick:()=>e("/urban"),children:["Urban",U("img",{src:"assets/arrowRightIcon.svg",alt:"arrowRightIcon",style:{width:"2.5vh",height:"2.5vh"}})]}),_e(oi,{className:n.whiteButton,disabled:!0,style:{opacity:.5},children:["Corporate",U("img",{src:"assets/arrowRightIcon.svg",alt:"arrowRightIcon",style:{width:"2.5vh",height:"2.5vh"}})]})]})]})},$E={title:_e(ko,{children:["Projects ",U("br",{}),U("b",{children:"marketplace"})]}),first:_e("div",{children:["Evaluating the ",U("br",{})," resilience impact of ",U("br",{}),"investment projects"]}),second:_e("div",{children:["Promoting the better ",U("br",{})," impact investment ",U("br",{})," opportunities"]}),third:_e("div",{children:["Bridging the gap between ",U("br",{})," impact investment ",U("br",{})," demand and supply"]})},J5e=()=>{const{classes:n}=RC(),e=oc();return _e("div",{className:n.sectionWrapper,style:{paddingLeft:0},children:[U("div",{className:n.sectionTitle,style:{marginTop:"5vh"},children:$E.title}),_e("div",{className:n.smallTextGroupWrapper,children:[_e("div",{className:n.smallTextWrapper,children:[U(e_,{}),$E.first]}),_e("div",{className:n.smallTextWrapper,children:[U(e_,{}),$E.second]}),_e("div",{className:n.smallTextWrapper,children:[U(e_,{}),$E.third]})]}),U("div",{style:{display:"flex",flexDirection:"row",gap:"2vh",marginTop:"7.5vh"},children:_e(oi,{className:n.whiteButton,onClick:()=>e("/marketplace"),children:["Project marketplace",U("img",{src:"assets/arrowRightIcon.svg",alt:"arrowRightIcon",style:{width:"2.5vh",height:"2.5vh"}})]})})]})},e_=()=>U("div",{style:{width:"1vh",height:"1vh",backgroundColor:"#fff",borderRadius:"50%"}}),Q5e={menu:"Menu",login:"Log in",signup:"Sign up",back:"Back to globe"},eDe=({invertColors:n,setMenuVisible:e,displayBackButton:i,marginLogo:a})=>{const s=d=>Q5e[d],{classes:l}=Jw();return oc(),_e("div",{className:l.root,style:{margin:"0 10vh 0 10vh",borderBottom:n?"1px solid #000":"1px solid #fff",backgroundColor:"transparent"},children:[U("div",{style:{display:"flex",gap:"2.5vh",alignItems:"center"},children:U("div",{className:l.menuIconWrapper,children:_e("div",{onClick:()=>e(!0),style:{display:"flex",gap:"1vh",flexDirection:"row",alignItems:"center"},children:[U("img",{style:{width:"4.7vh"},src:"/assets/orangeMenuIcon.svg",width:45,alt:"logo"}),U(nn,{className:l.whiteText,style:{color:n?"#000":"#fff"},children:s("menu")})]})})}),U("img",{style:{width:"50vh",marginLeft:a||"0"},src:n?"/assets/expo_logo_black.svg":"/assets/expo_logo.svg",alt:"logo"}),U("img",{src:"/assets/orangeAvatarIcon.svg",alt:"user icon"})]})},tDe=wr()({root:{position:"absolute",width:"100vw",height:"100vh"},headerWrapper:{position:"absolute",width:"100vw",height:"100vh"},contentWrapper:{position:"absolute",overflowY:"scroll",width:"100vw",height:"100vh","&::-webkit-scrollbar":{width:"0em"}},sectionWrapper:{position:"relative",height:"100%",width:"100%"},title:{fontFamily:"SuisseIntl-Light",fontWeight:100,fontSize:"6vh",color:"#fff"},textWrapper:{position:"relative",zIndex:1,marginLeft:"10vh",paddingTop:"15vh"},description:{paddingTop:"4vh",fontFamily:"SuisseIntl-Light",fontWeight:100,fontSize:"3vh",color:"#fff",width:"40vw"},bottomWrapper:{position:"absolute",bottom:"0",zIndex:1,display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:"4vh",pointerEvents:"none",width:"100%"}}),Sj=["/assets/expo_bg.png","/assets/Expo/1.jpg","/assets/Expo/2.jpg","/assets/Expo/3.jpg","/assets/Expo/4.jpg","/assets/Expo/5.jpg"],nDe=()=>{const{classes:n}=tDe(),[e,i]=ne.useState(0),[a,s]=ne.useState(0),[l,d]=ne.useState(!1);return ne.useEffect(()=>{const f=document.getElementById("landing2");f.addEventListener("scroll",p=>{const y=f.clientHeight,_=f.scrollTop,b=Math.floor(_/y);s(b)})},[]),_e("div",{className:n.root,children:[l&&U(Jh,{setVisible:d}),U("div",{className:n.headerWrapper,children:U(eDe,{displayBackButton:!0,invertColors:a===1,marginLogo:"0 10vh 0 10vh",setMenuVisible:d})}),_e("div",{className:n.contentWrapper,id:"landing2",children:[_e("div",{className:n.sectionWrapper,children:[U(iO,{imagesUrls:Sj,activeImageIndex:e}),U("div",{style:{position:"absolute",width:"100%",height:"100%",background:"linear-gradient(180deg, rgba(0,0,0,0.65) 60%, rgba(0,0,0,0.4))"}}),_e("div",{className:n.textWrapper,children:[_e("div",{className:n.title,children:["Expo City Dubai is the visionary inspiration",U("br",{}),"behind the"," ",U("span",{style:{color:"#FFB800"},children:U("b",{children:"Global Resilience Platform"})})]}),_e("div",{className:n.description,children:["Global Resilience platform is one of the tools Expo City employs to promote its values which centre around diversity, sustainability, and knowledge-sharing. The city prioritizes sustainable practices and open exchange of ideas to shape ",U("br",{})," a better future for the community and environment. ",U("br",{}),U("br",{}),U("a",{target:"_blank",href:"https://www.expocitydubai.com/en/",style:{color:"#fff"},children:"Explore more about Expo City Dubai"})]})]}),_e("div",{className:n.bottomWrapper,children:[U("div",{}),U("div",{style:{position:"absolute",width:"100%",display:"flex",flexDirection:"row",justifyContent:"center",gap:"1.6vh"},children:Sj.map((f,p)=>U(nO,{bgUrl:f,onClick:()=>{i(p)},isActive:e===p},p))}),_e(oi,{style:{pointerEvents:"all",color:"#000",backgroundColor:"#FFB800",borderRadius:50,padding:"1vh 2.5vh",textTransform:"none",fontFamily:"SuisseIntl-Light",fontSize:"1.7vh",display:"flex",flexDirection:"row",justifyContent:"center",gap:"1.2vh",marginRight:"10vh"},children:[U("div",{onClick:()=>{const f="Dubai_Expo_IEC_A&S_Report.pdf",p=document.createElement("a");p.href=`/pdf/${f}`,p.download=f,p.click()},children:"Download report"}),U("img",{src:"/assets/downloadIcon.svg",alt:"arrow down",style:{filter:"invert(1)"}})]})]}),_e("div",{style:{position:"absolute",bottom:"12vh",width:"100%",textAlign:"center",fontFamily:"SuisseIntl-Light",fontWeight:100,fontSize:"3vh",color:"#fff"},children:[U("span",{style:{color:"#FFB800"},children:"Expo City Dubai"}),U("br",{}),"Flourishing and expanding business environment"]})]}),_e("div",{className:n.sectionWrapper,style:{backgroundImage:"url(/assets/expo_bg_2.png)",backgroundSize:"cover",backgroundPosition:"center"},children:[_e("div",{className:n.textWrapper,children:[U("div",{className:n.title,style:{color:"#000"},children:"Expo City Dubai, UAE"}),U("img",{src:"/assets/expo_urban.svg",alt:"expo",style:{width:"50vh",marginTop:"4vh"}})]}),U("img",{src:"/assets/expo_cube.png",alt:"expo",style:{position:"absolute",bottom:"0",width:"77vh"}}),_e("div",{style:{position:"absolute",top:"15vh",right:"10vh",width:"45vw",height:"65vh",fontFamily:"SuisseIntl-Light",fontWeight:100,fontSize:"2vh",border:"1.5px solid #FFB800",borderRadius:"1vh",padding:"2vh",overflowY:"scroll",zIndex:1},children:["Expo City Dubai not only remains true to its Expo 2020 heritage but also transcends it. ECD is building upon the great legacy of the Expo, making a remarkable leap forward, and developing into a thriving urban community. This transformation is acknowledged by the citys high rating. ",U("br",{}),U("br",{}),"The ECDs urban environment is based on the 15-minute city concept, ensuring that sustainability is the focal point within its boundaries. Expo City demonstrates exceptional livability through internationally certified urban developments and construction initiatives accredited by LEED and BREEAM. ",U("br",{}),U("br",{}),"A defining feature of Expo City Dubai is its unwavering commitment to implementing top-tier environmental, social, and governance policies. The city prioritizes inclusion fostering equal opportunities for all. Expo City sets the pace for inclusion in Asia by creating and implementing best practices in gender equality and empowering people of determination. This commitment is reinforced by initiatives supporting representation and participation in the labor force. Also, this approach extends to the urban infrastructure design, providing an accessible environment for all. Designed as a pedestrian-centric city, Expo City minimizes its carbon footprint by emphasizing walkability, green spaces, and efficient public transport. ",U("br",{}),U("br",{}),"While upholding high standards, Expo City Dubai is actively striving to further enhance its sustainability practices. The city has made significant investments in tree planting initiatives, facilitating the rapid expansion of lush green spaces across the city. Despite challenges such as relatively higher water and electricity tariffs in proportion to income, which may concern future residents, the city is taking proactive measures to ensure a balanced and sustainable cost of living. In its pursuit of becoming an unparalleled residential destination, Expo City is dedicated to improving accessibility to essential amenities such as best practice governmental services, schools, and hospitals.",U("br",{}),U("br",{}),"Special measures are being implemented to address air pollution concerns, aligning with the broader sustainability objectives prevalent in the Middle East, considering environmental and climate hazards. Expo City Dubai stands as a testament to its commitment to sustainable practices, continuously evolving to provide an increasingly harmonious, eco-friendly, and desirable living environment for its residents while setting new standards for responsible urban development in the Global South."]}),_e(oi,{style:{position:"absolute",marginRight:"10vh",bottom:"2vw",right:0,width:"fit-content",pointerEvents:"all",color:"#000",backgroundColor:"#FFB800",borderRadius:50,padding:"1vh 2.5vh",textTransform:"none",fontFamily:"SuisseIntl-Light",fontSize:"1.7vh",display:"flex",flexDirection:"row",justifyContent:"center",gap:"1.2vh"},children:[U("div",{onClick:()=>{const f="Dubai_Expo_IEC_A&S_Report.pdf",p=document.createElement("a");p.href=`/pdf/${f}`,p.download=f,p.click()},children:"Download report"}),U("img",{src:"/assets/downloadIcon.svg",alt:"arrow down",style:{filter:"invert(1)"}})]})]})]})]})},TO=wr()({contentWrapper:{position:"relative",overflowY:"scroll",margin:"0 10vh",height:"calc(100vh - 10.3vh)"},title:{fontFamily:"SuisseIntl-Light",fontWeight:400,fontSize:"6.8vh",margin:"2vh 0vh 4vh"},titleBold:{fontFamily:"SuisseIntl-Regular",fontWeight:"700"},filtersAndProjectsWrapper:{display:"flex",flexDirection:"row",marginBottom:"10vh",gap:"2vh"},filtersWrapper:{flex:1},projectsWrapper:{flex:4,display:"flex",flexDirection:"row",flexWrap:"wrap",rowGap:"4vh",columnGap:"4vh",justifyContent:"flex-start",alignItems:"flex-start",height:"fit-content"},addProjectBtn:{position:"sticky",zIndex:1,top:"2vh",backgroundColor:"#000",color:"#fff",borderRadius:"50px",textTransform:"none",fontSize:"2.1vh",display:"flex",flexDirection:"row",gap:"1vh",padding:"1.5vh 3vh",textWrap:"nowrap"},filterGroupHeader:{fontFamily:"SuisseIntl-Light",fontWeight:400,fontSize:"3.5vh",marginTop:"4vh",marginBottom:"1vh",textWrap:"nowrap"},filterList:{overflow:"visible",display:"flex",flexDirection:"column",gap:"0"},filterRow:{fontFamily:"SuisseIntl-Light",fontWeight:400,fontSize:"2.1vh",display:"flex",flexDirection:"row",justifyContent:"flex-start",alignItems:"center",marginLeft:"-1vh",textWrap:"nowrap"},moreFiltersBtn:{fontFamily:"SuisseIntl-Light",fontWeight:400,fontSize:"2.1vh",color:"#000",cursor:"pointer",marginTop:"1vh",opacity:"0.5"},projectItem:{position:"relative",overflow:"hidden",borderRadius:"3vh",backgroundColor:"#fff",width:"25vh",height:"45vh",display:"flex",flexDirection:"column",justifyContent:"flex-start",alignItems:"center",border:"1px solid #CCCCCC"},statItem:{fontFamily:"SuisseIntl-Light",fontWeight:800,color:"#35CB00",border:"1px solid rgba(53, 203, 0, 0.5)",padding:"1vh 1.5vh",borderRadius:"50px",fontSize:"1.4vh",width:"fit-content"},projectImageWrapper:{width:"100%",height:"15vh",overflow:"hidden",backgroundSize:"cover",backgroundPosition:"center"},projectInfoWrapper:{display:"flex",flexDirection:"column",gap:"1vh",padding:"0 1.5vh",height:"20vh"},projectTitle:{cursor:"pointer",fontFamily:"SuisseIntl-Regular",fontWeight:600,fontSize:"1.8vh"},projectSubTitle:{fontFamily:"SuisseIntl-Light",fontWeight:400,fontSize:"1.5vh",opacity:"0.5"},projectStatsWrapper:{display:"flex",flexDirection:"row",alignItems:"center",gap:"1.5vh"},impactLabel:{fontFamily:"SuisseIntl-Regular",fontWeight:100,fontSize:"1.5vh"},likeBtn:{backgroundColor:"#2D67FF",fontSize:"1.5vh",color:"#fff",borderRadius:"50px",display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"flex-start",justifySelf:"flex-end",gap:"2vh",padding:".7vh 1.5vh",textTransform:"none",width:"21vh","&:hover":{backgroundColor:"#000"}},projectsOnMapBtn:{position:"absolute",top:"9vh",right:"6vw",zIndex:200,cursor:"pointer",width:"12vh",height:"12vh"}}),iDe={menu:"Menu",login:"Log in",signup:"Sign up",back:"Back to globe"},rDe=({invertColors:n,setMenuVisible:e})=>{const i=s=>iDe[s],{classes:a}=Jw();return oc(),_e("div",{className:a.root,style:{margin:"0 10vh 0 10vh",borderBottom:n?"1px solid #000":"1px solid #fff"},children:[U("div",{style:{display:"flex",gap:"2.5vh",alignItems:"center"},children:_e("div",{className:a.menuIconWrapper,onClick:()=>{e(!0)},children:[n?U("img",{style:{width:"4.7vh"},src:"/assets/blackMenuIcon.svg",width:45,alt:"logo"}):U("img",{style:{width:"4.7vh"},src:"/assets/menuIcon.svg",width:45,alt:"logo"}),U(nn,{className:a.whiteText,style:{color:n?"#000":"#fff"},children:i("menu")})]})}),n?U("img",{style:{width:"7.8vh"},src:"/assets/blackLogo.svg",alt:"logo"}):U("img",{style:{width:"7.8vh"},src:"/assets/logo.svg",alt:"logo"}),_e("div",{className:a.buttonsWrapper,children:[U("div",{style:{width:"5vh"}}),n?U("img",{src:"/assets/blackAvatarIcon.svg",alt:"user icon"}):U("div",{style:{fontFamily:"SuisseIntl-Light",fontWeight:600,color:"#fff",textTransform:"none",fontSize:"1.8vh",height:"4.6vh",width:"fit-content",padding:"0 1.5vh",backgroundColor:"#fff",borderRadius:"50px",display:"flex",alignItems:"center"},children:U("img",{src:"/assets/avatarIcon.svg",alt:"user icon"})})]})]})},aDe=({title:n,checked:e,onChange:i})=>{const{classes:a}=TO(),s=()=>{i&&i(n)};return U("div",{children:_e("div",{className:a.filterRow,children:[U(Kq,{checked:e,style:{marginLeft:"0"},onChange:s}),U("div",{children:n})]})})},IT=[{id:1,category:"Water quality and avaliability",title:"Dubai announces it will reuse 100% of its water by 2030"},{id:2,category:"Public services",title:"Back to school: Smart buses to serve 25 000 students in Dubai"},{id:3,category:"Natural disaster hazards",title:"Weather: Partly cloudy skies across the UAE, humidity to hit 90 percent, maximum temperatures at 47 C"},{id:4,category:"Health",title:"Breaking ground: Early access to revolutionary ALS Therapy now offered by Mediclinic Parkview Hospital"},{id:5,category:"Wealth",title:"Jobs in UAE: Holiday Swap to set up global HQ in Dubai, support 500 jobs"},{id:6,category:"Accountability",title:"Dubai: Youth circle discusses sustainability, climate change"}],oDe=()=>new Set(IT.map(n=>n.category)),sDe=({setFilteredNews:n})=>{const{classes:e}=TO();ne.useState(!1);const i=oDe(),[a,s]=ne.useState({categories:new Set,searchFor:new Set,statuses:new Set,countries:new Set});ne.useEffect(()=>{if(a.categories.size){let d=IT;a.categories.size&&(d=d.filter(f=>Array.from(a.categories).some(p=>f.Category.includes(p)))),n(d)}else{n(IT);return}},[a]);const l=(d,f)=>{a[f].has(d)?a[f].delete(d):a[f].add(d),s({...a})};return _e("div",{children:[U("div",{className:e.filterGroupHeader,children:"Category"}),U("div",{className:e.filterList,children:Array.from(i).map(d=>U(aDe,{title:d,checked:a.searchFor.has(d),onChange:f=>l(f,"categories")},d))}),U("div",{className:e.filterGroupHeader,children:"Level"}),U("div",{className:e.filterList}),U("div",{className:e.filterGroupHeader,children:"Date"}),U("div",{className:e.filterList,children:_e("div",{style:{display:"flex",flexDirection:"column",justifyContent:"space-between",alignItems:"flex-start"},children:[U(PV,{id:"date",type:"date",defaultValue:"2017-05-24",InputLabelProps:{shrink:!0}}),U(PV,{id:"date",type:"date",defaultValue:"2017-05-24",InputLabelProps:{shrink:!0}})]})}),U("div",{className:e.filterGroupHeader,children:"Source"}),U("div",{className:e.filterList}),U("div",{className:e.filterGroupHeader,children:"New type"}),U("div",{className:e.filterList})]})},lDe=({newsItem:n})=>{const[e,i]=ne.useState(!1);return _e("div",{onMouseEnter:()=>i(!0),onMouseLeave:()=>i(!1),style:{backgroundColor:e?"#2D67FF":"#fff",cursor:"pointer",display:"flex",flexDirection:"row",width:"100%",justifyContent:"space-between",border:"1px solid #BFBFBF",height:"125px",borderRadius:"30px",boxSizing:"border-box",padding:"2vh 3.5vw",gap:"2vw",fontFamily:"SuisseIntl-Light",fontWeight:400,color:e?"#fff":"#000"},children:[_e("div",{style:{flex:2,display:"flex",flexDirection:"column",gap:".5vh"},children:[U("div",{style:{opacity:.5},children:"Category"}),U("div",{children:n.category})]}),U("div",{style:{flex:8,fontFamily:"SuisseIntl-Regular",fontWeight:600,display:"flex",alignItems:"center"},children:n.title}),_e("div",{style:{flex:1,display:"flex",flexDirection:"row",alignItems:"center",gap:"1vw"},children:[U(oi,{style:{fontFamily:"SuisseIntl-Light",textTransform:"none",border:"1px solid #BFBFBF",color:e?"#fff":"#000",borderRadius:"50px",padding:"0 25px",textWrap:"nowrap",height:"4vh",transition:"none"},children:"Follow"}),U(oi,{style:{fontFamily:"SuisseIntl-Light",textTransform:"none",color:e?"#000":"#fff",backgroundColor:e?"#fff":"#2D67FF",borderRadius:"50px",padding:"0 25px",textWrap:"nowrap",height:"4vh",transition:"none"},children:"Read more"})]})]})},cDe=()=>{const{classes:n}=TO(),[e,i]=ne.useState(!1);return _e("div",{children:[e&&U(Jh,{setVisible:i}),U(rDe,{invertColors:!0,setMenuVisible:i}),_e("div",{className:n.contentWrapper,children:[U("div",{className:n.title,children:U("span",{className:n.titleBold,children:"News"})}),_e("div",{className:n.filtersAndProjectsWrapper,children:[_e("div",{className:n.filtersWrapper,children:[_e(oi,{style:{fontFamily:"SuisseIntl-Light",fontSize:"1.8vh",textTransform:"none",border:"1px solid #BFBFBF",color:"#000",borderRadius:"50px",padding:"0 20px",textWrap:"nowrap",height:"4vh"},children:["Choose saved filter",U("img",{src:"/assets/arrowDownIcon.svg",alt:"arrowDown",style:{marginLeft:"1vw"}})]}),U(sDe,{setFilteredNews:()=>{}})]}),_e("div",{className:n.projectsWrapper,children:[_e("div",{style:{fontFamily:"SuisseIntl-Light",fontSize:"1.8vh",textTransform:"none",border:"1px solid #BFBFBF",color:"#000",borderRadius:"50px",height:"4vh",width:"100%",textWrap:"nowrap",display:"flex",flexDirection:"row",alignItems:"center"},children:[U(GA,{sx:{ml:2,flex:10,width:"90%",fontSize:"1.vh"},placeholder:"Search",inputProps:{"aria-label":"search google maps"}}),U("img",{src:"/assets/loupeIcon.svg",alt:"filterIcon",style:{marginRight:"1vw"}})]}),U("div",{style:{display:"flex",flexDirection:"column",gap:"2vh"},children:IT.map(a=>U(lDe,{newsItem:a}))})]})]})]})]})},uDe=[{path:"/",element:U(Z5e,{})},{path:"/urban",element:U(iCe,{})},{path:"/city",element:U(xj,{}),state:{selectedCityName:"Moscow"}},{path:"/city/:cityName",element:U(xj,{})},{path:"/project_page/:projectID",element:U(F5e,{})},{path:"/marketplace",element:U(q5e,{})},{path:"/expo_city_dubai",element:U(nDe,{})},{path:"/resilience_news",element:U(cDe,{})}],dDe=G4({palette:{primary:{light:"#2D67FF",main:"#fff",dark:"#000",contrastText:"#fff"},secondary:{main:"#2D67FF"},background:{default:"#000"}},typography:{fontFamily:"SuisseIntl-Thin",h1:{color:"#fff",fontSize:38,fontWeight:300,lineHeight:"40px"},h2:{color:"#fff",fontSize:24},h3:{color:"#fff",fontSize:18},h4:{color:"#fff",fontSize:14},h5:{color:"#FFFFFF99",fontSize:14},h6:{color:"#FFFFFF",fontSize:12}},components:{MuiButton:{styleOverrides:{root:{pointerEvents:"all",textTransform:"none",borderRadius:"16px",fontFamily:"SuisseIntl-Regular",fontSize:14,fontWeight:400,backgroundColor:"#2D67FF",width:"fit-content",padding:"3px 14px",boxShadow:"none",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",zIndex:2}},variants:[{props:{variant:"outlined"},style:{backgroundColor:"#2429B5",color:"#FFFFFF",border:"1px solid #FFFFFF33"}},{props:{variant:"text"},style:{backgroundColor:"#FFF",color:"#000","&:hover":{backgroundColor:"#fff"}}},{props:{variant:"contained"},style:{"&:hover":{backgroundColor:"#2D67FF"}}}]},MuiDivider:{styleOverrides:{root:{backgroundColor:"#FFF"}}},MuiSwitch:{styleOverrides:{root:{"& .MuiSwitch-switchBase":{"&.Mui-checked":{"& + .MuiSwitch-track":{opacity:1,backgroundColor:"#2D67FF",borderColor:"#007378"}}},"& .MuiSwitch-track":{opacity:1,backgroundColor:"#767676",height:20,borderRadius:10},"& .MuiSwitch-thumb":{transform:"translateY(3px)"}}}}}}),hDe=Rn(_X)(()=>({"& .MuiToggleButtonGroup-grouped":{borderRadius:"16px",border:"1px solid rgba(255, 255, 255, 0.2)",color:"#fff",textTransform:"none",pointerEvents:"all"}})),Ej=Rn(vX)({"&.MuiToggleButton-root":{fontFamily:"SuisseIntl-Regular",fontSize:"30px",textTransform:"none",borderRadius:"16px",border:"1px solid rgba(255, 255, 255, 0.2)",backgroundColor:"transparent",width:"calc(100vw / 2 - 16px)",maxWidth:"250px",padding:"0px 0px","&:hover":{backgroundColor:"#fff",color:"#000"}},"&.Mui-selected":{backgroundColor:"#fff",color:"#000"}}),HQ=({setMenuVisible:n})=>_e("div",{onClick:()=>n(!0),style:{pointerEvents:"all",position:"sticky",top:0,width:"100%",display:"flex",flexDirection:"row",justifyContent:"space-between",paddingBottom:"16px",borderBottom:"1px solid #fff",zIndex:1},children:[U("img",{src:"/assets/menuIcon.svg",width:32,alt:"menu icon"}),U("img",{src:"/assets/logo.svg",height:32,alt:"logo icon"}),U("img",{src:"/assets/logoutIcon.svg",alt:"logout"})]}),fDe=({map:n,currentView:e,selectedCity:i,setMap:a,setCurrentView:s,setSelectedCity:l})=>{const{classes:d}=jQ(),[f,p]=ne.useState(!1),y=ne.useCallback(()=>{s("map")},[]),_=ne.useCallback(()=>{s("graph")},[]);return _e("div",{children:[_e(nn,{variant:"h1",style:{marginTop:"14px"},children:["Choose a city and ",U("br",{})," view its"," ",U("span",{className:d.span,children:"score"})]}),_e("div",{className:d.toggleButtonGroupWrapper,children:[_e(hDe,{children:[U(Ej,{value:"map",selected:e==="map",onClick:y,children:"Map"}),U(Ej,{value:"graph",selected:e==="graph",onClick:_,children:"Graph"})]}),U("div",{className:d.bottomRatingLegend,children:U("img",{src:"/assets/rating_legend.svg",alt:"urban page icon",className:d.bottomRatingLegendImage})})]}),U("div",{className:d.filterButtonsWrapper,children:f?_e(ko,{children:[U("div",{className:d.blurWrapper}),_e(oi,{onClick:()=>p(!1),variant:"contained",children:["Close ",U("img",{src:"./assets/closeIcon.svg",alt:"arrow"})]}),_e(oi,{variant:"text",children:["Country ",U("img",{src:"./assets/arrowDownIcon.svg",alt:"arrow"})]}),_e(oi,{variant:"text",children:["Climate ",U("img",{src:"./assets/arrowDownIcon.svg",alt:"arrow"})]}),_e(oi,{variant:"text",children:["Risk exposure"," ",U("img",{src:"./assets/arrowDownIcon.svg",alt:"arrow"})]}),_e(oi,{variant:"text",children:["Income group"," ",U("img",{src:"./assets/arrowDownIcon.svg",alt:"arrow"})]}),_e(oi,{variant:"text",children:["Population group"," ",U("img",{src:"./assets/arrowDownIcon.svg",alt:"arrow"})]}),_e(oi,{variant:"text",children:["Rating ",U("img",{src:"./assets/arrowDownIcon.svg",alt:"arrow"})]})]}):U(oi,{variant:"text",onClick:()=>p(!0),children:"Filter by"})}),_e("div",{className:d.graphAndMapWrapper,children:[e==="graph"&&!i&&U("div",{className:d.graphWrapper,children:U(_J,{setSelectedCity:l,isMobile:!0})}),e==="map"&&!i&&U(wJ,{setMap:a,setSelectedCity:l})]})]})};var RT=(n=>(n.A1="#35CB00",n.A2="#75D652",n.A3="#B7DE86",n.B1="#ECE38E",n.B2="#FFD748",n.B3="#FFC700",n.C1="#FF9B3F",n.C2="#FF632F",n.C3="#F74B3C",n))(RT||{});const $a=({rating:n,size:e="medium"})=>e==="small"?U("div",{style:{textTransform:"none",borderRadius:"16px",fontFamily:"SuisseIntl-Thin",fontSize:12,fontWeight:300,width:"fit-content",padding:"8px 16px",boxShadow:"none",color:"white",backgroundColor:RT[n]},children:n}):U("div",{style:{textTransform:"none",borderRadius:"16px",fontFamily:"SuisseIntl-Thin",fontSize:18,fontWeight:300,width:"fit-content",padding:"8px 16px",boxShadow:"none",color:"white",backgroundColor:RT[n]},children:n});var Db=(n=>(n.VERY_LOW="#FF3B29",n.LOW="#FF632F",n.AVERAGE="#FF9B3F",n.STRONG="#A0DA8B",n.VERY_STRONG="#35CB00",n))(Db||{});const wi=({status:n,variant:e="outlined",text:i,textColor:a="white",fillColor:s})=>{if(i)return U("div",{style:{textWrap:"wrap",textTransform:"none",borderRadius:"16px",boxSizing:"border-box",fontFamily:"SuisseIntl-Thin",fontSize:12,fontWeight:300,width:"90px",padding:"7px 0px",boxShadow:"none",color:a||"white",border:"1px solid white",textAlign:"center",background:s||"transparent"},children:i});if(e==="outlined"){const l=n.replace(/\s/g,"_").toUpperCase(),d=Db[l];return U("div",{style:{textWrap:"nowrap",textTransform:"none",borderRadius:"16px",boxSizing:"border-box",fontFamily:"SuisseIntl-Thin",fontSize:12,fontWeight:300,width:"fit-content",padding:"8px 16px",boxShadow:"none",color:d,border:`1px solid ${d}`},children:n})}if(e==="opacity"){const l=n.replace(/\s/g,"_").toUpperCase(),d=Db[l];return U("div",{style:{textWrap:"nowrap",textTransform:"none",borderRadius:"16px",fontFamily:"SuisseIntl-Thin",boxSizing:"border-box",fontSize:12,fontWeight:300,width:"fit-content",padding:"8px 16px",boxShadow:"none",color:d,backgroundColor:`${d}10`},children:n})}if(e==="solid"){const l=n.replace(/\s/g,"_").toUpperCase(),d=Db[l];return U("div",{style:{textWrap:"nowrap",textTransform:"none",borderRadius:"16px",fontFamily:"SuisseIntl-Thin",boxSizing:"border-box",fontSize:12,fontWeight:300,width:"fit-content",padding:"8px 16px",boxShadow:"none",color:a,backgroundColor:`${d}`},children:n})}},AO=({size:n="small"})=>_e(nn,{variant:"h5",style:{cursor:"pointer",fontFamily:"SuisseIntl-Thin",fontWeight:600,display:"flex",fontSize:n==="small"?12:18,flexDirection:"row",alignItems:"center",gap:"8px"},children:["How the rating works",U("img",{src:"/assets/questionGray.svg",alt:"hint",style:{opacity:.6,height:"18px"}})]}),pDe=wr()({column:{display:"flex",flexDirection:"column",gap:"16px"},row:{display:"flex",flexDirection:"row",gap:"20px",alignItems:"center"},statusColumn:{display:"flex",flexDirection:"column",gap:"8px",alignItems:"center"},statusRow:{width:"100%",display:"flex",flexDirection:"row",justifyContent:"space-around",gap:"32px",alignItems:"center",flexWrap:"wrap"}}),mDe=({selectedCityName:n})=>{var p;const{classes:e}=pDe(),i=w_.find(y=>y.City===n),a=oc(),s=(p=i==null?void 0:i["Urban Resilience Index"])==null?void 0:p.replace("-",""),l=i==null?void 0:i["Population description"],d=i==null?void 0:i["Population density description"],f=i==null?void 0:i["Climate description"];return _e("div",{className:e.column,style:{marginTop:"16px"},children:[_e("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:[U(nn,{variant:"h1",children:n}),U(nn,{variant:"h3",children:i==null?void 0:i.Country})]}),U(nn,{variant:"h5",children:"Largest city in the country, centre of region"}),_e("div",{className:e.row,children:[_e(nn,{variant:"h3",children:["Urban ",U("br",{}),"resilience index"]}),U($a,{rating:s})]}),_e("div",{className:e.column,children:[_e("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",gap:"8px"},children:[U(nn,{variant:"h5",style:{flex:2},children:"Population"}),U(nn,{variant:"h4",style:{flex:3},children:i==null?void 0:i.Population}),U(wi,{text:l})]}),_e("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",gap:"8px"},children:[_e(nn,{variant:"h5",style:{flex:2},children:["Population ",U("br",{}),"density"]}),U(nn,{variant:"h4",style:{flex:3},children:i["Population density"]+" people/ha"}),U(wi,{text:d})]}),_e("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",gap:"8px"},children:[U(nn,{variant:"h5",style:{flex:2},children:"Climate"}),U(nn,{variant:"h4",style:{flex:3},children:i.Climate}),U(wi,{text:f})]})]}),U(tO,{selectedCityName:n,isMobile:!0}),U(nn,{variant:"h5",style:{fontSize:"8px",textAlign:"center"},children:"The height of a bar represents the total number of people in a grid cell."}),_e("div",{className:e.statusRow,children:[_e("div",{className:e.statusColumn,children:[U(nn,{variant:"h4",children:"Environmental"}),U(wi,{status:i==null?void 0:i.Environmental,variant:"outlined"})]}),_e("div",{className:e.statusColumn,children:[U(nn,{variant:"h4",children:"Social"}),U(wi,{status:i==null?void 0:i.Social,variant:"outlined"})]}),_e("div",{className:e.statusColumn,children:[U(nn,{variant:"h4",children:"Governmental"}),U(wi,{status:i.Governmental,variant:"outlined"})]}),_e("div",{className:e.statusColumn,children:[U(nn,{variant:"h4",children:"Current state"}),U(wi,{status:i["Current state"],variant:"outlined"})]}),_e("div",{className:e.statusColumn,children:[U(nn,{variant:"h4",children:"Ability & Willingness"}),U(wi,{status:i["Ability & Willingness"]})]})]}),_e("div",{children:[_e("div",{style:{display:"flex",flexDirection:"row",gap:"16px",alignItems:"center",marginTop:"16px"},children:[U(nn,{variant:"h3",children:"Basic needs"}),U($a,{rating:i["Basic needs Scope"].replace("-",""),size:"small"})]}),_e("div",{style:{display:"flex",flexDirection:"row",gap:"16px",alignItems:"center",marginTop:"16px"},children:[U(nn,{variant:"h3",children:"Natural risk exposure"}),U(wi,{status:i["Natural Risk Exposure"],variant:"opacity"})]}),_e("div",{style:{display:"flex",flexDirection:"row",gap:"16px",alignItems:"center",marginTop:"16px"},children:[U(nn,{variant:"h3",children:"Transport resilience index"}),U(wi,{status:i["Transport Resilience Index"],variant:"opacity"})]}),_e("div",{style:{display:"flex",flexDirection:"row",gap:"16px",alignItems:"center",marginTop:"16px"},children:[U(nn,{variant:"h3",children:"Urban sentiment index"}),U(wi,{status:i["Urban Sentiment Index"],variant:"opacity"})]})]}),U("div",{style:{marginTop:"16px"},children:U(AO,{})}),U("div",{style:{display:"flex",flexDirection:"row",justifyContent:"center",marginTop:"16px"},children:U(oi,{onClick:()=>{a("/city/"+n)},variant:"contained",children:"Dashboard"})})]})},jQ=wr()({root:{position:"absolute",width:"100%",height:"auto",padding:"16px",boxSizing:"border-box",overflow:"scroll",pointerEvents:"none"},span:{fontFamily:"SuisseIntl-Regular",color:"#2D67FF"},toggleButtonGroupWrapper:{display:"flex",flexDirection:"row",justifyContent:"center",marginTop:"14px"},bottomRatingLegend:{display:"flex",alignItems:"center",justifyContent:"center",width:"100%",position:"absolute",left:"0",bottom:"0",height:"100px",background:"linear-gradient(0deg, #2429B5 63.09%, rgba(36, 41, 181, 0) 99.48%)"},bottomRatingLegendImage:{userSelect:"none",width:"90%",maxWidth:"450px"},graphAndMapWrapper:{pointerEvents:"all",position:"absolute",width:"100%",height:"100%",top:"0",left:"0",backgroundColor:"rgba(21, 52, 175, 1)",zIndex:-1},graphWrapper:{width:"100%",height:"100%",position:"absolute",top:"0",left:"0",overflow:"hidden"},blurWrapper:{position:"absolute",width:"100%",height:"100%",top:0,left:0,background:"rgba(0, 0, 0, 0.5)",backdropFilter:"blur(10px)",zIndex:1},filterButtonsWrapper:{display:"flex",width:"100%",flexDirection:"column",justifyContent:"flex-end",alignItems:"flex-end",marginTop:"16px",gap:"16px"}}),gDe=()=>{const{classes:n}=jQ(),[e,i]=ne.useState("map"),[a,s]=ne.useState(null),[l,d]=ne.useState(!1),[f,p]=ne.useState(null);return _e("div",{children:[l&&U(Jh,{setVisible:d,isMobile:!0}),_e("div",{className:n.root,style:{height:a?"100%":"100vh",backgroundColor:a?"#1433AE":"transparent",overflow:a?"scroll":"hidden",pointerEvents:a?"all":"none"},children:[U(HQ,{setMenuVisible:d}),a?U(mDe,{selectedCityName:a}):U(fDe,{map:f,setMap:p,currentView:e,setCurrentView:i,selectedCity:a,setSelectedCity:s})]})]})},yDe=wr()({root:{position:"absolute",width:"100%",height:"100vh",padding:"16px",boxSizing:"border-box",backgroundColor:"rgba(21, 52, 175, 1)",overflow:"scroll"},column:{display:"flex",flexDirection:"column",gap:"16px",marginTop:"16px"},row:{display:"flex",flexDirection:"row",gap:"16px",marginTop:"16px"}}),vDe=()=>{const{classes:n}=yDe();return _e("div",{className:n.root,children:[U(nn,{variant:"h1",sx:{width:"100%",textAlign:"center"},children:"Mobile Theme"}),_e("div",{className:n.column,children:[U(mx,{}),U(nn,{variant:"h2",children:"Texts"}),U(nn,{variant:"h1",children:"h1 Urban Page"}),U(nn,{variant:"h2",children:"h2 Urban Page"}),U(nn,{variant:"h3",children:"h3 Urban Page"}),U(nn,{variant:"h4",children:"h4 Urban Page"}),U(nn,{variant:"h5",children:"h5 Urban Page"})]}),_e("div",{className:n.column,children:[U(mx,{}),U(nn,{variant:"h2",children:"Buttons"}),_e("div",{className:n.row,children:[U(oi,{variant:"outlined",children:"Outlined"}),U(oi,{variant:"text",children:"Text"}),U(oi,{variant:"contained",children:"Contained"})]}),_e("div",{className:n.row,children:[_e(oi,{variant:"outlined",children:["Outlined",U("img",{src:"./assets/arrowDownIcon.svg",alt:"arrow",style:{filter:"invert(1)"}})]}),_e(oi,{variant:"contained",children:["Contained",U("img",{src:"./assets/closeIcon.svg",alt:"arrow"})]}),_e(oi,{variant:"text",children:["Outlined",U("img",{src:"./assets/arrowDownIcon.svg",alt:"arrow"})]})]}),_e("div",{className:n.row,children:[_e(oi,{variant:"contained",children:["Button",U("img",{src:"./assets/downloadIcon.svg",alt:"arrow",style:{width:"12px"}})]}),U(oi,{variant:"contained",style:{background:"#3752BA",fontFamily:"SuisseIntl-Thin"},children:"Geoanalytics"}),U(oi,{variant:"outlined",style:{background:"transparent",fontFamily:"SuisseIntl-Thin"},children:"Table view"})]})]}),_e("div",{className:n.column,children:[U(mx,{}),U(nn,{variant:"h2",children:"Ratings"}),_e("div",{className:n.row,children:[U($a,{rating:"A1"}),U($a,{rating:"A2"}),U($a,{rating:"A3"}),U($a,{rating:"B1"}),U($a,{rating:"B2"}),U($a,{rating:"B3"}),U($a,{rating:"C1"}),U($a,{rating:"C2"}),U($a,{rating:"C3"})]}),_e("div",{className:n.row,children:[U($a,{rating:"A1",size:"small"}),U($a,{rating:"A2",size:"small"}),U($a,{rating:"A3",size:"small"}),U($a,{rating:"B1",size:"small"}),U($a,{rating:"B2",size:"small"}),U($a,{rating:"B3",size:"small"}),U($a,{rating:"C1",size:"small"}),U($a,{rating:"C2",size:"small"}),U($a,{rating:"C3",size:"small"})]})]}),_e("div",{className:n.column,children:[U(mx,{}),U(nn,{variant:"h2",children:"Status"}),U("div",{className:n.row,children:_e("div",{className:n.column,children:[U(nn,{variant:"h4",children:"Text status"}),U(wi,{text:"very large"}),U(wi,{text:"large",fillColor:"#fff",textColor:"#000"})]})}),_e("div",{className:n.row,children:[_e("div",{className:n.column,children:[U(nn,{variant:"h4",children:"Outlined"}),U(wi,{status:"Very low",variant:"outlined"}),U(wi,{status:"Low",variant:"outlined"}),U(wi,{status:"Average",variant:"outlined"}),U(wi,{status:"Strong",variant:"outlined"}),U(wi,{status:"Very strong",variant:"outlined"})]}),_e("div",{className:n.column,children:[U(nn,{variant:"h4",children:"Opacity"}),U(wi,{status:"Very low",variant:"opacity"}),U(wi,{status:"Low",variant:"opacity"}),U(wi,{status:"Average",variant:"opacity"}),U(wi,{status:"Strong",variant:"opacity"}),U(wi,{status:"Very strong",variant:"opacity"})]}),_e("div",{className:n.column,children:[U(nn,{variant:"h4",children:"Solid white"}),U(wi,{status:"Very low",variant:"solid"}),U(wi,{status:"Low",variant:"solid"}),U(wi,{status:"Average",variant:"solid"}),U(wi,{status:"Strong",variant:"solid"}),U(wi,{status:"Very strong",variant:"solid"})]}),_e("div",{className:n.column,children:[U(nn,{variant:"h4",children:"Solid black"}),U(wi,{status:"Very low",variant:"solid",textColor:"black"}),U(wi,{status:"Low",variant:"solid",textColor:"black"}),U(wi,{status:"Average",variant:"solid",textColor:"black"}),U(wi,{status:"Strong",variant:"solid",textColor:"black"}),U(wi,{status:"Very strong",variant:"solid",textColor:"black"})]})]})]}),_e("div",{className:n.column,children:[U(mx,{}),U(nn,{variant:"h2",children:"Switches"}),U(gX,{size:"medium"})]})]})},_De=({setFirstSectionHeight:n})=>{var s;const{classes:e}=$Q(),i=jo(),a=(s=i==null?void 0:i["Urban Resilience Index"])==null?void 0:s.replace("-","");return ne.useEffect(()=>{const l=document.getElementById("first-section");n(l.clientHeight)},[]),_e("div",{id:"first-section",style:{padding:"16px",paddingTop:"0px"},children:[U(nn,{variant:"h1",style:{paddingTop:"0px"},children:i==null?void 0:i.City}),U(nn,{variant:"h2",style:{marginTop:"8px"},children:"in indices"}),_e("div",{style:{display:"flex",flexDirection:"row",gap:"16px",marginTop:"16px",alignItems:"center"},children:[_e(nn,{variant:"h3",children:["Urban ",U("br",{}),"resilience index"]}),U($a,{rating:a})]}),_e("div",{className:e.statusRow,style:{marginTop:"32px"},children:[_e("div",{className:e.statusColumn,children:[U(nn,{variant:"h4",children:"Environmental"}),U(wi,{status:i==null?void 0:i.Environmental,variant:"outlined"})]}),_e("div",{className:e.statusColumn,children:[U(nn,{variant:"h4",children:"Social"}),U(wi,{status:i==null?void 0:i.Social,variant:"outlined"})]}),_e("div",{className:e.statusColumn,children:[U(nn,{variant:"h4",children:"Governmental"}),U(wi,{status:i.Governmental,variant:"outlined"})]}),_e("div",{className:e.statusColumn,children:[U(nn,{variant:"h4",children:"Current state"}),U(wi,{status:i["Current state"],variant:"outlined"})]}),_e("div",{className:e.statusColumn,children:[U(nn,{variant:"h4",children:"Ability & Willingness"}),U(wi,{status:i["Ability & Willingness"]})]})]}),U(tO,{selectedCityName:i.City,isMobile:!0}),U(nn,{variant:"h5",style:{fontSize:"8px",textAlign:"center"},children:"The height of a bar represents the total number of people in a grid cell."}),U("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center",marginTop:"16px"},children:_e(oi,{variant:"contained",children:["Download report",U("img",{src:"./assets/downloadIcon.svg",alt:"arrow",style:{width:"12px"}})]})}),_e("div",{children:[_e("div",{style:{display:"flex",flexDirection:"row",gap:"16px",alignItems:"center",marginTop:"32px"},children:[U(nn,{variant:"h3",children:"Basic needs"}),U($a,{rating:i["Basic needs Scope"].replace("-",""),size:"small"})]}),_e("div",{style:{display:"flex",flexDirection:"row",gap:"16px",alignItems:"center",marginTop:"16px"},children:[U(nn,{variant:"h3",children:"Natural risk exposure"}),U(wi,{status:i["Natural Risk Exposure"],variant:"opacity"})]}),_e("div",{style:{display:"flex",flexDirection:"row",gap:"16px",alignItems:"center",marginTop:"16px"},children:[U(nn,{variant:"h3",children:"Transport resilience index"}),U(wi,{status:i["Transport Resilience Index"],variant:"opacity"})]}),_e("div",{style:{display:"flex",flexDirection:"row",gap:"16px",alignItems:"center",marginTop:"16px"},children:[U(nn,{variant:"h3",children:"Urban sentiment index"}),U(wi,{status:i["Urban Sentiment Index"],variant:"opacity"})]})]}),U("div",{style:{marginTop:"16px"},children:U(AO,{})}),U("div",{style:{display:"flex",flexDirection:"row",justifyContent:"center",marginTop:"32px"},children:U(oi,{variant:"contained",style:{background:"#3752BA",fontFamily:"SuisseIntl-Thin"},children:"Geoanalytics"})})]})},xDe=wr()({itemColumn:{width:"90px",textAlign:"center",display:"flex",flexDirection:"column",alignItems:"center",gap:"8px"},itemsRow:{display:"flex",flexDirection:"row",justifyContent:"space-around",paddingTop:"16px",gap:"16px",alignItems:"flex-end",flexWrap:"wrap"}}),bDe=()=>{const{classes:n}=xDe(),[e,i]=ne.useState(0),a=jo(),s=a.Climate.replace(/,/g,"/"),l=(a["Poverty headcount ratio at national poverty lines"]*100).toFixed(1)+"% ",d=(a["Literacy rate among population"]*100).toFixed(1)+"% ";return _e("div",{style:{position:"relative",width:"100%",height:"100vh",backgroundColor:"#000"},children:[U("div",{style:{position:"absolute",top:"0",left:"0",width:"100%",height:"100%",background:"linear-gradient(180deg, rgba(0,0,0,0.5) 90%, rgba(0,0,0,0.5))",zIndex:1}}),U(iO,{imagesUrls:a.images,activeImageIndex:e}),_e("div",{style:{position:"relative",paddingTop:"80px",paddingLeft:"16px",paddingRight:"16px",zIndex:3},children:[U(nn,{variant:"h1",children:a==null?void 0:a.City}),U(nn,{variant:"h2",style:{paddingTop:"8px"},children:"in Pictures and Numbers"}),_e("div",{className:n.itemsRow,children:[_e("div",{className:n.itemColumn,children:[U(nn,{variant:"h5",children:"Population"}),U(nn,{variant:"h4",children:a==null?void 0:a.Population}),U(wi,{text:a==null?void 0:a["Population description"],fillColor:"#fff",textColor:"#000"})]}),_e("div",{className:n.itemColumn,children:[U(nn,{variant:"h5",children:"Population density"}),U(nn,{variant:"h4",children:a["Population density"]+" people/ha"}),U(wi,{text:a["Population density description"],fillColor:"#fff",textColor:"#000"})]}),_e("div",{className:n.itemColumn,children:[U(nn,{variant:"h5",children:"Mean salary"}),U(nn,{variant:"h4",children:a["Mean salary"]+" PPP$"}),U(wi,{text:a["Mean salary description"],fillColor:"#fff",textColor:"#000"})]}),_e("div",{className:n.itemColumn,children:[_e(nn,{variant:"h5",children:[" ","Poverty headcount ratio at national poverty lines"]}),U(nn,{variant:"h4",children:l+"of population"}),U(wi,{text:a["Poverty headcount ratio at national poverty lines description"],fillColor:"#fff",textColor:"#000"})]}),_e("div",{className:n.itemColumn,children:[U(nn,{variant:"h5",children:"Literacy rate among population (15-24 Years)"}),U(nn,{variant:"h4",children:d}),U(wi,{text:a["Literacy rate among population description"],fillColor:"#fff",textColor:"#000"})]}),_e("div",{className:n.itemColumn,children:[U(nn,{variant:"h5",children:"Climate"}),U(nn,{variant:"h4",children:s}),U(wi,{text:a["Climate description"],fillColor:"#fff",textColor:"#000"})]})]})]}),_e("div",{style:{position:"absolute",flexDirection:"column",gap:"16px",bottom:"10%",zIndex:2,display:"flex",alignItems:"center",justifyContent:"center",width:"100%"},children:[_e(nn,{variant:"h4",style:{textDecoration:"underline",textAlign:"center"},children:["Become our reporter ",U("br",{}),"Suggest another image"]}),U(oi,{onClick:()=>{const f=a.pdfName,p=document.createElement("a");p.href=`/pdf/${f}`,p.download=f,p.click()},variant:"contained",children:"Download report"})]}),U("div",{style:{position:"absolute",bottom:"16px",width:"100%",display:"flex",flexDirection:"row",justifyContent:"center",gap:"1.6vh",zIndex:2},children:a.images.map((f,p)=>U(nO,{bgUrl:f,onClick:()=>{i(p)},isActive:e===p},p))})]})},wDe=wr()({itemColumn:{display:"flex",flexDirection:"column",alignItems:"center",gap:"16px"}}),SDe=({setClickedCategory:n})=>{const{classes:e}=wDe(),[i,a]=ne.useState(null),[s,l]=ne.useState(728),d=jo();return _e("div",{style:{position:"relative",width:"100%",height:"auto",background:"#1433AE",boxSizing:"border-box",padding:"16px",paddingTop:"80px"},children:[_e(nn,{variant:"h1",children:[d==null?void 0:d.City,": ",U("br",{}),U("span",{style:{fontFamily:"SuisseIntl-Light"},children:"Urban"})," ","resilience",U("br",{}),"index",U("span",{style:{textTransform:"none",verticalAlign:"middle",marginLeft:"16px",borderRadius:"16px",fontFamily:"SuisseIntl-Thin",fontSize:18,fontWeight:300,width:"fit-content",padding:"8px 16px",boxShadow:"none",color:"white",backgroundColor:RT[d["Urban Resilience Index"].replace("-","")]},children:d["Urban Resilience Index"].replace("-","")})]}),_e("div",{style:{position:"relative",width:"100%",display:"flex",flexDirection:"row",gap:"16px",alignItems:"center",justifyContent:"space-around"},children:[_e("div",{className:e.itemColumn,children:[U(nn,{variant:"h3",style:{marginTop:"32px"},children:"Environmental"}),U(wi,{status:d==null?void 0:d.Environmental,variant:"outlined"})]}),_e("div",{className:e.itemColumn,children:[U(nn,{variant:"h3",style:{marginTop:"32px"},children:"Social"}),U(wi,{status:d==null?void 0:d.Social,variant:"outlined"})]}),_e("div",{className:e.itemColumn,children:[U(nn,{variant:"h3",style:{marginTop:"32px"},children:"Governmental"}),U(wi,{status:d==null?void 0:d.Governmental,variant:"outlined"})]})]}),U("div",{style:{paddingTop:"48px",position:"relative",height:`${s}px`},children:U(CJ,{setHoveredSide:a,setClickedCategory:n,isMobile:!0,setCubeHeight:l})}),_e("div",{style:{position:"relative",width:"100%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"16px",boxSizing:"border-box"},children:[U(AO,{size:"big"}),_e("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between",width:"100%",marginTop:"16px"},children:[U(oi,{variant:"outlined",style:{background:"transparent",fontFamily:"SuisseIntl-Thin"},children:"Table view"}),_e(oi,{onClick:()=>{const f=d.pdfName,p=document.createElement("a");p.href=`/pdf/${f}`,p.download=f,p.click()},variant:"contained",children:["Download report",U("img",{src:"./assets/downloadIcon.svg",alt:"arrow",style:{width:"12px"}})]})]})]})]})},EDe=["#2D67FF","#00BCF8","#00DDD0","#8490FF","#AD00FF","#FF7AE2"],MDe=()=>({responsive:!0,plugins:{tooltip:{enabled:!0},legend:{display:!1}},scales:{r:{ticks:{stepSize:1},angleLines:{display:!1},pointLabels:{font:{size:8}},suggestedMin:0}}}),TDe=()=>{const n=jo(),e=n["Transport Resilience Index"].replace(/\s/g,"_").toUpperCase(),i=Db[e],a=VQ(w_),s=a.map(b=>b.City),l=n.City,d=a.find(b=>b.City===l),[f,p]=WQ(l,s,a),y=MDe();let _=UQ(["#2D67FF","#00BCF8","#00DDD0","#8490FF","#AD00FF","#FF7AE2"])(d,f);return _e("div",{style:{position:"relative",width:"100%",height:"auto",background:"#fff",boxSizing:"border-box",padding:"16px",paddingTop:"80px"},children:[_e(nn,{variant:"h1",style:{color:"#000"},children:[n==null?void 0:n.City,": ",U("br",{}),U("span",{style:{fontFamily:"SuisseIntl-Light"},children:"Transport"})," ","resilience index",U("span",{style:{verticalAlign:"middle",marginLeft:"16px",textWrap:"nowrap",textTransform:"none",borderRadius:"16px",fontFamily:"SuisseIntl-Thin",boxSizing:"border-box",fontSize:12,fontWeight:300,width:"fit-content",padding:"8px 16px",boxShadow:"none",color:"#000",backgroundColor:`${i}`},children:n["Transport Resilience Index"].replace("-","")})]}),U(nn,{variant:"h3",style:{marginTop:"16px",color:"#000"},children:"The graph highlights the strengths and weaknesses of cities across various aspects of transport system. The further the vertices of the shape are from the center of the diagram, the better the city's performance in that particular metrics. The larger the area of the shape, the higher the overall assessment in Transport resilience."}),U("div",{style:{display:"flex",width:"100%",paddingTop:"16px",justifyContent:"center"},children:_e(oi,{children:[U("div",{style:{width:"16px",height:"16px",borderRadius:"50%",backgroundColor:"#2D67FF"}}),n.City]})}),U(xO,{id:"star-graph",style:{paddingTop:"16px",maxHeight:"400px"},data:_,options:y}),U("div",{style:{display:"flex",flexDirection:"row",justifyContent:"center",width:"100%"},children:U(BQ,{currentCity:l,selectedCities:f.map(b=>b.City),cities:s,colors:EDe,onChange:p,isMobile:!0})}),U("div",{id:"graph-section",style:{position:"relative",width:"100%",bottom:"16px",display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center",marginTop:"16px"},children:_e(oi,{variant:"contained",children:["Download report",U("img",{src:"./assets/downloadIcon.svg",alt:"arrow",style:{width:"12px"}})]})})]})},ADe=()=>{const[n,e]=ne.useState(null),[i,a]=ne.useState(null),s=jo(),d=jo().City;return _e("div",{style:{position:"relative",width:"100%",height:"100vh",backgroundColor:"#000"},children:[_e(nn,{variant:"h1",style:{padding:"16px",paddingTop:"80px",position:"relative",color:"#000",zIndex:"4"},children:[s==null?void 0:s.City,": Geoanalytics"]}),_e("div",{style:{position:"absolute",bottom:"0",padding:"16px",boxSizing:"border-box",width:"100%",zIndex:1},children:[_e("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between"},children:[U("img",{src:"/legends/bordersLegend.svg",style:{marginTop:"3vh",width:"180px"}}),i&&i.includes("/")?U("img",{src:i,style:{width:"78px"}}):i&&U("div",{style:{fontFamily:"SuisseIntl-Light",fontSize:"1.8vh",width:"10vw"},children:i})]}),U(RJ,{map:n,setLegend:a,isMobile:!0})]}),d==="Dubai"&&U(IJ,{setMap:e,isMobile:!0}),d==="Dar es Salaam"&&U(LJ,{setMap:e,isMobile:!0})]})},$Q=wr()({root:{position:"relative",width:"100%",height:"100vh",boxSizing:"border-box",backgroundColor:"rgba(21, 52, 175, 1)",overflow:"scroll"},statusColumn:{display:"flex",flexDirection:"column",gap:"8px",alignItems:"center"},statusRow:{width:"100%",display:"flex",flexDirection:"row",justifyContent:"space-around",gap:"32px",alignItems:"center",flexWrap:"wrap"}}),CDe=()=>{var A;const{classes:n}=$Q(),{cityName:e}=y4(),i=w_.find(P=>P.City===e),[a,s]=ne.useState(!1),[l,d]=ne.useState(null),[f,p]=ne.useState(0),[y,_]=ne.useState(0),[b,S]=ne.useState(!1);return ne.useEffect(()=>{const P=document.getElementById("landing");P.addEventListener("scroll",L=>{const k=P.clientHeight,R=P.scrollTop,z=Math.floor(R/k);p(z)})},[]),ne.useEffect(()=>{const k=document.getElementById("graph-section").getBoundingClientRect().top;document.getElementById("landing").scrollTop>k?S(!0):S(!1)},[(A=document.getElementById("landing"))==null?void 0:A.scrollTop]),U(PJ,{cityData:i,children:_e("div",{children:[a&&U(Jh,{setVisible:s,isMobile:!0}),_e("div",{className:n.root,id:"landing",children:[U("div",{style:{padding:"16px",position:"sticky",top:"0",zIndex:10},children:U("div",{style:{filter:b?"invert(1)":"invert(0)"},children:U(HQ,{setMenuVisible:s})})}),U(_De,{setFirstSectionHeight:_}),U(bDe,{}),U(SDe,{setClickedCategory:d}),U(TDe,{}),U(ADe,{})]})]})})},PDe=[{path:"/urban",element:U(gDe,{})},{path:"/theme",element:U(vDe,{})},{path:"/city/:cityName",element:U(CDe,{})}],IDe=eq(PDe),RDe=()=>U(kq,{theme:dDe,children:U(tq,{router:IDe})}),LDe=()=>prompt("Enter password")==="g"?(localStorage.setItem("user","admin"),U(qQ,{})):U("div",{children:"Wrong password"}),YQ=document.getElementById("root");if(!YQ)throw new Error("There is no root element in HTML!");const kDe=eq(uDe),DDe=localStorage.getItem("user"),qQ=()=>U(kq,{theme:X1e,children:U(tq,{router:kDe})}),zDe=()=>{const[n,e]=Kl.useState(window.innerWidth<1e3||window.innerHeight>window.innerWidth);return ne.useEffect(()=>{const i=()=>{window.innerWidth<1e3||window.innerHeight>window.innerWidth?e(!0):e(!1)};return window.addEventListener("resize",i),()=>window.removeEventListener("resize",i)},[]),U(Kl.StrictMode,{children:n?U(RDe,{}):U(qQ,{})})};ZL.createRoot(YQ).render(U(Kl.StrictMode,{children:DDe==="admin"?U(zDe,{}):LDe()}));
