var roe=Object.defineProperty;var ooe=(n,e,i)=>e in n?roe(n,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):n[e]=i;var xn=(n,e,i)=>(ooe(n,typeof e!="symbol"?e+"":e,i),i);function sj(n,e){for(var i=0;i<e.length;i++){const o=e[i];if(typeof o!="string"&&!Array.isArray(o)){for(const s in o)if(s!=="default"&&!(s in n)){const l=Object.getOwnPropertyDescriptor(o,s);l&&Object.defineProperty(n,s,l.get?l:{enumerable:!0,get:()=>o[s]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))o(s);new MutationObserver(s=>{for(const l of s)if(l.type==="childList")for(const d of l.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&o(d)}).observe(document,{childList:!0,subtree:!0});function i(s){const l={};return s.integrity&&(l.integrity=s.integrity),s.referrerPolicy&&(l.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?l.credentials="include":s.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function o(s){if(s.ep)return;s.ep=!0;const l=i(s);fetch(s.href,l)}})();var soe=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Iw(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function lj(n){if(n.__esModule)return n;var e=n.default;if(typeof e=="function"){var i=function o(){return this instanceof o?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};i.prototype=e.prototype}else i={};return Object.defineProperty(i,"__esModule",{value:!0}),Object.keys(n).forEach(function(o){var s=Object.getOwnPropertyDescriptor(n,o);Object.defineProperty(i,o,s.get?s:{enumerable:!0,get:function(){return n[o]}})}),i}var cj={exports:{}},ea={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Lw=Symbol.for("react.element"),loe=Symbol.for("react.portal"),coe=Symbol.for("react.fragment"),uoe=Symbol.for("react.strict_mode"),doe=Symbol.for("react.profiler"),hoe=Symbol.for("react.provider"),poe=Symbol.for("react.context"),foe=Symbol.for("react.forward_ref"),moe=Symbol.for("react.suspense"),goe=Symbol.for("react.memo"),yoe=Symbol.for("react.lazy"),C9=Symbol.iterator;function voe(n){return n===null||typeof n!="object"?null:(n=C9&&n[C9]||n["@@iterator"],typeof n=="function"?n:null)}var uj={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},dj=Object.assign,hj={};function y_(n,e,i){this.props=n,this.context=e,this.refs=hj,this.updater=i||uj}y_.prototype.isReactComponent={};y_.prototype.setState=function(n,e){if(typeof n!="object"&&typeof n!="function"&&n!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,n,e,"setState")};y_.prototype.forceUpdate=function(n){this.updater.enqueueForceUpdate(this,n,"forceUpdate")};function pj(){}pj.prototype=y_.prototype;function ck(n,e,i){this.props=n,this.context=e,this.refs=hj,this.updater=i||uj}var uk=ck.prototype=new pj;uk.constructor=ck;dj(uk,y_.prototype);uk.isPureReactComponent=!0;var P9=Array.isArray,fj=Object.prototype.hasOwnProperty,dk={current:null},mj={key:!0,ref:!0,__self:!0,__source:!0};function gj(n,e,i){var o,s={},l=null,d=null;if(e!=null)for(o in e.ref!==void 0&&(d=e.ref),e.key!==void 0&&(l=""+e.key),e)fj.call(e,o)&&!mj.hasOwnProperty(o)&&(s[o]=e[o]);var p=arguments.length-2;if(p===1)s.children=i;else if(1<p){for(var f=Array(p),y=0;y<p;y++)f[y]=arguments[y+2];s.children=f}if(n&&n.defaultProps)for(o in p=n.defaultProps,p)s[o]===void 0&&(s[o]=p[o]);return{$$typeof:Lw,type:n,key:l,ref:d,props:s,_owner:dk.current}}function _oe(n,e){return{$$typeof:Lw,type:n.type,key:e,ref:n.ref,props:n.props,_owner:n._owner}}function hk(n){return typeof n=="object"&&n!==null&&n.$$typeof===Lw}function boe(n){var e={"=":"=0",":":"=2"};return"$"+n.replace(/[=:]/g,function(i){return e[i]})}var I9=/\/+/g;function B5(n,e){return typeof n=="object"&&n!==null&&n.key!=null?boe(""+n.key):e.toString(36)}function WA(n,e,i,o,s){var l=typeof n;(l==="undefined"||l==="boolean")&&(n=null);var d=!1;if(n===null)d=!0;else switch(l){case"string":case"number":d=!0;break;case"object":switch(n.$$typeof){case Lw:case loe:d=!0}}if(d)return d=n,s=s(d),n=o===""?"."+B5(d,0):o,P9(s)?(i="",n!=null&&(i=n.replace(I9,"$&/")+"/"),WA(s,e,i,"",function(y){return y})):s!=null&&(hk(s)&&(s=_oe(s,i+(!s.key||d&&d.key===s.key?"":(""+s.key).replace(I9,"$&/")+"/")+n)),e.push(s)),1;if(d=0,o=o===""?".":o+":",P9(n))for(var p=0;p<n.length;p++){l=n[p];var f=o+B5(l,p);d+=WA(l,e,i,f,s)}else if(f=voe(n),typeof f=="function")for(n=f.call(n),p=0;!(l=n.next()).done;)l=l.value,f=o+B5(l,p++),d+=WA(l,e,i,f,s);else if(l==="object")throw e=String(n),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return d}function eS(n,e,i){if(n==null)return n;var o=[],s=0;return WA(n,o,"","",function(l){return e.call(i,l,s++)}),o}function xoe(n){if(n._status===-1){var e=n._result;e=e(),e.then(function(i){(n._status===0||n._status===-1)&&(n._status=1,n._result=i)},function(i){(n._status===0||n._status===-1)&&(n._status=2,n._result=i)}),n._status===-1&&(n._status=0,n._result=e)}if(n._status===1)return n._result.default;throw n._result}var $s={current:null},VA={transition:null},woe={ReactCurrentDispatcher:$s,ReactCurrentBatchConfig:VA,ReactCurrentOwner:dk};ea.Children={map:eS,forEach:function(n,e,i){eS(n,function(){e.apply(this,arguments)},i)},count:function(n){var e=0;return eS(n,function(){e++}),e},toArray:function(n){return eS(n,function(e){return e})||[]},only:function(n){if(!hk(n))throw Error("React.Children.only expected to receive a single React element child.");return n}};ea.Component=y_;ea.Fragment=coe;ea.Profiler=doe;ea.PureComponent=ck;ea.StrictMode=uoe;ea.Suspense=moe;ea.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=woe;ea.cloneElement=function(n,e,i){if(n==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+n+".");var o=dj({},n.props),s=n.key,l=n.ref,d=n._owner;if(e!=null){if(e.ref!==void 0&&(l=e.ref,d=dk.current),e.key!==void 0&&(s=""+e.key),n.type&&n.type.defaultProps)var p=n.type.defaultProps;for(f in e)fj.call(e,f)&&!mj.hasOwnProperty(f)&&(o[f]=e[f]===void 0&&p!==void 0?p[f]:e[f])}var f=arguments.length-2;if(f===1)o.children=i;else if(1<f){p=Array(f);for(var y=0;y<f;y++)p[y]=arguments[y+2];o.children=p}return{$$typeof:Lw,type:n.type,key:s,ref:l,props:o,_owner:d}};ea.createContext=function(n){return n={$$typeof:poe,_currentValue:n,_currentValue2:n,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},n.Provider={$$typeof:hoe,_context:n},n.Consumer=n};ea.createElement=gj;ea.createFactory=function(n){var e=gj.bind(null,n);return e.type=n,e};ea.createRef=function(){return{current:null}};ea.forwardRef=function(n){return{$$typeof:foe,render:n}};ea.isValidElement=hk;ea.lazy=function(n){return{$$typeof:yoe,_payload:{_status:-1,_result:n},_init:xoe}};ea.memo=function(n,e){return{$$typeof:goe,type:n,compare:e===void 0?null:e}};ea.startTransition=function(n){var e=VA.transition;VA.transition={};try{n()}finally{VA.transition=e}};ea.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};ea.useCallback=function(n,e){return $s.current.useCallback(n,e)};ea.useContext=function(n){return $s.current.useContext(n)};ea.useDebugValue=function(){};ea.useDeferredValue=function(n){return $s.current.useDeferredValue(n)};ea.useEffect=function(n,e){return $s.current.useEffect(n,e)};ea.useId=function(){return $s.current.useId()};ea.useImperativeHandle=function(n,e,i){return $s.current.useImperativeHandle(n,e,i)};ea.useInsertionEffect=function(n,e){return $s.current.useInsertionEffect(n,e)};ea.useLayoutEffect=function(n,e){return $s.current.useLayoutEffect(n,e)};ea.useMemo=function(n,e){return $s.current.useMemo(n,e)};ea.useReducer=function(n,e,i){return $s.current.useReducer(n,e,i)};ea.useRef=function(n){return $s.current.useRef(n)};ea.useState=function(n){return $s.current.useState(n)};ea.useSyncExternalStore=function(n,e,i){return $s.current.useSyncExternalStore(n,e,i)};ea.useTransition=function(){return $s.current.useTransition()};ea.version="18.2.0";cj.exports=ea;var ie=cj.exports;const cu=Iw(ie),wE=sj({__proto__:null,default:cu},[ie]);var BI={},yj={exports:{}},ec={},vj={exports:{}},_j={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(n){function e(le,me){var xe=le.length;le.push(me);e:for(;0<xe;){var ae=xe-1>>>1,Ee=le[ae];if(0<s(Ee,me))le[ae]=me,le[xe]=Ee,xe=ae;else break e}}function i(le){return le.length===0?null:le[0]}function o(le){if(le.length===0)return null;var me=le[0],xe=le.pop();if(xe!==me){le[0]=xe;e:for(var ae=0,Ee=le.length,Je=Ee>>>1;ae<Je;){var Ze=2*(ae+1)-1,Ke=le[Ze],Fe=Ze+1,ct=le[Fe];if(0>s(Ke,xe))Fe<Ee&&0>s(ct,Ke)?(le[ae]=ct,le[Fe]=xe,ae=Fe):(le[ae]=Ke,le[Ze]=xe,ae=Ze);else if(Fe<Ee&&0>s(ct,xe))le[ae]=ct,le[Fe]=xe,ae=Fe;else break e}}return me}function s(le,me){var xe=le.sortIndex-me.sortIndex;return xe!==0?xe:le.id-me.id}if(typeof performance=="object"&&typeof performance.now=="function"){var l=performance;n.unstable_now=function(){return l.now()}}else{var d=Date,p=d.now();n.unstable_now=function(){return d.now()-p}}var f=[],y=[],_=1,x=null,S=3,T=!1,I=!1,R=!1,D=typeof setTimeout=="function"?setTimeout:null,L=typeof clearTimeout=="function"?clearTimeout:null,O=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function N(le){for(var me=i(y);me!==null;){if(me.callback===null)o(y);else if(me.startTime<=le)o(y),me.sortIndex=me.expirationTime,e(f,me);else break;me=i(y)}}function F(le){if(R=!1,N(le),!I)if(i(f)!==null)I=!0,Ie(G);else{var me=i(y);me!==null&&ze(F,me.startTime-le)}}function G(le,me){I=!1,R&&(R=!1,L(te),te=-1),T=!0;var xe=S;try{for(N(me),x=i(f);x!==null&&(!(x.expirationTime>me)||le&&!he());){var ae=x.callback;if(typeof ae=="function"){x.callback=null,S=x.priorityLevel;var Ee=ae(x.expirationTime<=me);me=n.unstable_now(),typeof Ee=="function"?x.callback=Ee:x===i(f)&&o(f),N(me)}else o(f);x=i(f)}if(x!==null)var Je=!0;else{var Ze=i(y);Ze!==null&&ze(F,Ze.startTime-me),Je=!1}return Je}finally{x=null,S=xe,T=!1}}var j=!1,Y=null,te=-1,V=5,Q=-1;function he(){return!(n.unstable_now()-Q<V)}function fe(){if(Y!==null){var le=n.unstable_now();Q=le;var me=!0;try{me=Y(!0,le)}finally{me?ye():(j=!1,Y=null)}}else j=!1}var ye;if(typeof O=="function")ye=function(){O(fe)};else if(typeof MessageChannel<"u"){var pe=new MessageChannel,Me=pe.port2;pe.port1.onmessage=fe,ye=function(){Me.postMessage(null)}}else ye=function(){D(fe,0)};function Ie(le){Y=le,j||(j=!0,ye())}function ze(le,me){te=D(function(){le(n.unstable_now())},me)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(le){le.callback=null},n.unstable_continueExecution=function(){I||T||(I=!0,Ie(G))},n.unstable_forceFrameRate=function(le){0>le||125<le?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):V=0<le?Math.floor(1e3/le):5},n.unstable_getCurrentPriorityLevel=function(){return S},n.unstable_getFirstCallbackNode=function(){return i(f)},n.unstable_next=function(le){switch(S){case 1:case 2:case 3:var me=3;break;default:me=S}var xe=S;S=me;try{return le()}finally{S=xe}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(le,me){switch(le){case 1:case 2:case 3:case 4:case 5:break;default:le=3}var xe=S;S=le;try{return me()}finally{S=xe}},n.unstable_scheduleCallback=function(le,me,xe){var ae=n.unstable_now();switch(typeof xe=="object"&&xe!==null?(xe=xe.delay,xe=typeof xe=="number"&&0<xe?ae+xe:ae):xe=ae,le){case 1:var Ee=-1;break;case 2:Ee=250;break;case 5:Ee=1073741823;break;case 4:Ee=1e4;break;default:Ee=5e3}return Ee=xe+Ee,le={id:_++,callback:me,priorityLevel:le,startTime:xe,expirationTime:Ee,sortIndex:-1},xe>ae?(le.sortIndex=xe,e(y,le),i(f)===null&&le===i(y)&&(R?(L(te),te=-1):R=!0,ze(F,xe-ae))):(le.sortIndex=Ee,e(f,le),I||T||(I=!0,Ie(G))),le},n.unstable_shouldYield=he,n.unstable_wrapCallback=function(le){var me=S;return function(){var xe=S;S=me;try{return le.apply(this,arguments)}finally{S=xe}}}})(_j);vj.exports=_j;var Soe=vj.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var bj=ie,Jl=Soe;function pn(n){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+n,i=1;i<arguments.length;i++)e+="&args[]="+encodeURIComponent(arguments[i]);return"Minified React error #"+n+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var xj=new Set,Px={};function Yg(n,e){Y0(n,e),Y0(n+"Capture",e)}function Y0(n,e){for(Px[n]=e,n=0;n<e.length;n++)xj.add(e[n])}var Fh=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),UI=Object.prototype.hasOwnProperty,Aoe=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,L9={},R9={};function Eoe(n){return UI.call(R9,n)?!0:UI.call(L9,n)?!1:Aoe.test(n)?R9[n]=!0:(L9[n]=!0,!1)}function Moe(n,e,i,o){if(i!==null&&i.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return o?!1:i!==null?!i.acceptsBooleans:(n=n.toLowerCase().slice(0,5),n!=="data-"&&n!=="aria-");default:return!1}}function Toe(n,e,i,o){if(e===null||typeof e>"u"||Moe(n,e,i,o))return!0;if(o)return!1;if(i!==null)switch(i.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Ys(n,e,i,o,s,l,d){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=o,this.attributeNamespace=s,this.mustUseProperty=i,this.propertyName=n,this.type=e,this.sanitizeURL=l,this.removeEmptyString=d}var Qo={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(n){Qo[n]=new Ys(n,0,!1,n,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(n){var e=n[0];Qo[e]=new Ys(e,1,!1,n[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(n){Qo[n]=new Ys(n,2,!1,n.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(n){Qo[n]=new Ys(n,2,!1,n,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(n){Qo[n]=new Ys(n,3,!1,n.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(n){Qo[n]=new Ys(n,3,!0,n,null,!1,!1)});["capture","download"].forEach(function(n){Qo[n]=new Ys(n,4,!1,n,null,!1,!1)});["cols","rows","size","span"].forEach(function(n){Qo[n]=new Ys(n,6,!1,n,null,!1,!1)});["rowSpan","start"].forEach(function(n){Qo[n]=new Ys(n,5,!1,n.toLowerCase(),null,!1,!1)});var pk=/[\-:]([a-z])/g;function fk(n){return n[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(n){var e=n.replace(pk,fk);Qo[e]=new Ys(e,1,!1,n,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(n){var e=n.replace(pk,fk);Qo[e]=new Ys(e,1,!1,n,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(n){var e=n.replace(pk,fk);Qo[e]=new Ys(e,1,!1,n,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(n){Qo[n]=new Ys(n,1,!1,n.toLowerCase(),null,!1,!1)});Qo.xlinkHref=new Ys("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(n){Qo[n]=new Ys(n,1,!1,n.toLowerCase(),null,!0,!0)});function mk(n,e,i,o){var s=Qo.hasOwnProperty(e)?Qo[e]:null;(s!==null?s.type!==0:o||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(Toe(e,i,s,o)&&(i=null),o||s===null?Eoe(e)&&(i===null?n.removeAttribute(e):n.setAttribute(e,""+i)):s.mustUseProperty?n[s.propertyName]=i===null?s.type===3?!1:"":i:(e=s.attributeName,o=s.attributeNamespace,i===null?n.removeAttribute(e):(s=s.type,i=s===3||s===4&&i===!0?"":""+i,o?n.setAttributeNS(o,e,i):n.setAttribute(e,i))))}var $h=bj.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,tS=Symbol.for("react.element"),m0=Symbol.for("react.portal"),g0=Symbol.for("react.fragment"),gk=Symbol.for("react.strict_mode"),WI=Symbol.for("react.profiler"),wj=Symbol.for("react.provider"),Sj=Symbol.for("react.context"),yk=Symbol.for("react.forward_ref"),VI=Symbol.for("react.suspense"),GI=Symbol.for("react.suspense_list"),vk=Symbol.for("react.memo"),$p=Symbol.for("react.lazy"),Aj=Symbol.for("react.offscreen"),k9=Symbol.iterator;function $1(n){return n===null||typeof n!="object"?null:(n=k9&&n[k9]||n["@@iterator"],typeof n=="function"?n:null)}var Nr=Object.assign,U5;function Db(n){if(U5===void 0)try{throw Error()}catch(i){var e=i.stack.trim().match(/\n( *(at )?)/);U5=e&&e[1]||""}return`
`+U5+n}var W5=!1;function V5(n,e){if(!n||W5)return"";W5=!0;var i=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(y){var o=y}Reflect.construct(n,[],e)}else{try{e.call()}catch(y){o=y}n.call(e.prototype)}else{try{throw Error()}catch(y){o=y}n()}}catch(y){if(y&&o&&typeof y.stack=="string"){for(var s=y.stack.split(`
`),l=o.stack.split(`
`),d=s.length-1,p=l.length-1;1<=d&&0<=p&&s[d]!==l[p];)p--;for(;1<=d&&0<=p;d--,p--)if(s[d]!==l[p]){if(d!==1||p!==1)do if(d--,p--,0>p||s[d]!==l[p]){var f=`
`+s[d].replace(" at new "," at ");return n.displayName&&f.includes("<anonymous>")&&(f=f.replace("<anonymous>",n.displayName)),f}while(1<=d&&0<=p);break}}}finally{W5=!1,Error.prepareStackTrace=i}return(n=n?n.displayName||n.name:"")?Db(n):""}function Coe(n){switch(n.tag){case 5:return Db(n.type);case 16:return Db("Lazy");case 13:return Db("Suspense");case 19:return Db("SuspenseList");case 0:case 2:case 15:return n=V5(n.type,!1),n;case 11:return n=V5(n.type.render,!1),n;case 1:return n=V5(n.type,!0),n;default:return""}}function HI(n){if(n==null)return null;if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case g0:return"Fragment";case m0:return"Portal";case WI:return"Profiler";case gk:return"StrictMode";case VI:return"Suspense";case GI:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case Sj:return(n.displayName||"Context")+".Consumer";case wj:return(n._context.displayName||"Context")+".Provider";case yk:var e=n.render;return n=n.displayName,n||(n=e.displayName||e.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case vk:return e=n.displayName||null,e!==null?e:HI(n.type)||"Memo";case $p:e=n._payload,n=n._init;try{return HI(n(e))}catch{}}return null}function Poe(n){var e=n.type;switch(n.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return n=e.render,n=n.displayName||n.name||"",e.displayName||(n!==""?"ForwardRef("+n+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return HI(e);case 8:return e===gk?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function vf(n){switch(typeof n){case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function Ej(n){var e=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function Ioe(n){var e=Ej(n)?"checked":"value",i=Object.getOwnPropertyDescriptor(n.constructor.prototype,e),o=""+n[e];if(!n.hasOwnProperty(e)&&typeof i<"u"&&typeof i.get=="function"&&typeof i.set=="function"){var s=i.get,l=i.set;return Object.defineProperty(n,e,{configurable:!0,get:function(){return s.call(this)},set:function(d){o=""+d,l.call(this,d)}}),Object.defineProperty(n,e,{enumerable:i.enumerable}),{getValue:function(){return o},setValue:function(d){o=""+d},stopTracking:function(){n._valueTracker=null,delete n[e]}}}}function nS(n){n._valueTracker||(n._valueTracker=Ioe(n))}function Mj(n){if(!n)return!1;var e=n._valueTracker;if(!e)return!0;var i=e.getValue(),o="";return n&&(o=Ej(n)?n.checked?"true":"false":n.value),n=o,n!==i?(e.setValue(n),!0):!1}function SE(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}function jI(n,e){var i=e.checked;return Nr({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:i??n._wrapperState.initialChecked})}function D9(n,e){var i=e.defaultValue==null?"":e.defaultValue,o=e.checked!=null?e.checked:e.defaultChecked;i=vf(e.value!=null?e.value:i),n._wrapperState={initialChecked:o,initialValue:i,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function Tj(n,e){e=e.checked,e!=null&&mk(n,"checked",e,!1)}function $I(n,e){Tj(n,e);var i=vf(e.value),o=e.type;if(i!=null)o==="number"?(i===0&&n.value===""||n.value!=i)&&(n.value=""+i):n.value!==""+i&&(n.value=""+i);else if(o==="submit"||o==="reset"){n.removeAttribute("value");return}e.hasOwnProperty("value")?YI(n,e.type,i):e.hasOwnProperty("defaultValue")&&YI(n,e.type,vf(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(n.defaultChecked=!!e.defaultChecked)}function O9(n,e,i){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var o=e.type;if(!(o!=="submit"&&o!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+n._wrapperState.initialValue,i||e===n.value||(n.value=e),n.defaultValue=e}i=n.name,i!==""&&(n.name=""),n.defaultChecked=!!n._wrapperState.initialChecked,i!==""&&(n.name=i)}function YI(n,e,i){(e!=="number"||SE(n.ownerDocument)!==n)&&(i==null?n.defaultValue=""+n._wrapperState.initialValue:n.defaultValue!==""+i&&(n.defaultValue=""+i))}var Ob=Array.isArray;function D0(n,e,i,o){if(n=n.options,e){e={};for(var s=0;s<i.length;s++)e["$"+i[s]]=!0;for(i=0;i<n.length;i++)s=e.hasOwnProperty("$"+n[i].value),n[i].selected!==s&&(n[i].selected=s),s&&o&&(n[i].defaultSelected=!0)}else{for(i=""+vf(i),e=null,s=0;s<n.length;s++){if(n[s].value===i){n[s].selected=!0,o&&(n[s].defaultSelected=!0);return}e!==null||n[s].disabled||(e=n[s])}e!==null&&(e.selected=!0)}}function qI(n,e){if(e.dangerouslySetInnerHTML!=null)throw Error(pn(91));return Nr({},e,{value:void 0,defaultValue:void 0,children:""+n._wrapperState.initialValue})}function N9(n,e){var i=e.value;if(i==null){if(i=e.children,e=e.defaultValue,i!=null){if(e!=null)throw Error(pn(92));if(Ob(i)){if(1<i.length)throw Error(pn(93));i=i[0]}e=i}e==null&&(e=""),i=e}n._wrapperState={initialValue:vf(i)}}function Cj(n,e){var i=vf(e.value),o=vf(e.defaultValue);i!=null&&(i=""+i,i!==n.value&&(n.value=i),e.defaultValue==null&&n.defaultValue!==i&&(n.defaultValue=i)),o!=null&&(n.defaultValue=""+o)}function z9(n){var e=n.textContent;e===n._wrapperState.initialValue&&e!==""&&e!==null&&(n.value=e)}function Pj(n){switch(n){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function XI(n,e){return n==null||n==="http://www.w3.org/1999/xhtml"?Pj(e):n==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":n}var iS,Ij=function(n){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,i,o,s){MSApp.execUnsafeLocalFunction(function(){return n(e,i,o,s)})}:n}(function(n,e){if(n.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in n)n.innerHTML=e;else{for(iS=iS||document.createElement("div"),iS.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=iS.firstChild;n.firstChild;)n.removeChild(n.firstChild);for(;e.firstChild;)n.appendChild(e.firstChild)}});function Ix(n,e){if(e){var i=n.firstChild;if(i&&i===n.lastChild&&i.nodeType===3){i.nodeValue=e;return}}n.textContent=e}var Xb={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Loe=["Webkit","ms","Moz","O"];Object.keys(Xb).forEach(function(n){Loe.forEach(function(e){e=e+n.charAt(0).toUpperCase()+n.substring(1),Xb[e]=Xb[n]})});function Lj(n,e,i){return e==null||typeof e=="boolean"||e===""?"":i||typeof e!="number"||e===0||Xb.hasOwnProperty(n)&&Xb[n]?(""+e).trim():e+"px"}function Rj(n,e){n=n.style;for(var i in e)if(e.hasOwnProperty(i)){var o=i.indexOf("--")===0,s=Lj(i,e[i],o);i==="float"&&(i="cssFloat"),o?n.setProperty(i,s):n[i]=s}}var Roe=Nr({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ZI(n,e){if(e){if(Roe[n]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(pn(137,n));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(pn(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(pn(61))}if(e.style!=null&&typeof e.style!="object")throw Error(pn(62))}}function KI(n,e){if(n.indexOf("-")===-1)return typeof e.is=="string";switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var JI=null;function _k(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var QI=null,O0=null,N0=null;function F9(n){if(n=Dw(n)){if(typeof QI!="function")throw Error(pn(280));var e=n.stateNode;e&&(e=TM(e),QI(n.stateNode,n.type,e))}}function kj(n){O0?N0?N0.push(n):N0=[n]:O0=n}function Dj(){if(O0){var n=O0,e=N0;if(N0=O0=null,F9(n),e)for(n=0;n<e.length;n++)F9(e[n])}}function Oj(n,e){return n(e)}function Nj(){}var G5=!1;function zj(n,e,i){if(G5)return n(e,i);G5=!0;try{return Oj(n,e,i)}finally{G5=!1,(O0!==null||N0!==null)&&(Nj(),Dj())}}function Lx(n,e){var i=n.stateNode;if(i===null)return null;var o=TM(i);if(o===null)return null;i=o[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(o=!o.disabled)||(n=n.type,o=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!o;break e;default:n=!1}if(n)return null;if(i&&typeof i!="function")throw Error(pn(231,e,typeof i));return i}var eL=!1;if(Fh)try{var Y1={};Object.defineProperty(Y1,"passive",{get:function(){eL=!0}}),window.addEventListener("test",Y1,Y1),window.removeEventListener("test",Y1,Y1)}catch{eL=!1}function koe(n,e,i,o,s,l,d,p,f){var y=Array.prototype.slice.call(arguments,3);try{e.apply(i,y)}catch(_){this.onError(_)}}var Zb=!1,AE=null,EE=!1,tL=null,Doe={onError:function(n){Zb=!0,AE=n}};function Ooe(n,e,i,o,s,l,d,p,f){Zb=!1,AE=null,koe.apply(Doe,arguments)}function Noe(n,e,i,o,s,l,d,p,f){if(Ooe.apply(this,arguments),Zb){if(Zb){var y=AE;Zb=!1,AE=null}else throw Error(pn(198));EE||(EE=!0,tL=y)}}function qg(n){var e=n,i=n;if(n.alternate)for(;e.return;)e=e.return;else{n=e;do e=n,e.flags&4098&&(i=e.return),n=e.return;while(n)}return e.tag===3?i:null}function Fj(n){if(n.tag===13){var e=n.memoizedState;if(e===null&&(n=n.alternate,n!==null&&(e=n.memoizedState)),e!==null)return e.dehydrated}return null}function B9(n){if(qg(n)!==n)throw Error(pn(188))}function zoe(n){var e=n.alternate;if(!e){if(e=qg(n),e===null)throw Error(pn(188));return e!==n?null:n}for(var i=n,o=e;;){var s=i.return;if(s===null)break;var l=s.alternate;if(l===null){if(o=s.return,o!==null){i=o;continue}break}if(s.child===l.child){for(l=s.child;l;){if(l===i)return B9(s),n;if(l===o)return B9(s),e;l=l.sibling}throw Error(pn(188))}if(i.return!==o.return)i=s,o=l;else{for(var d=!1,p=s.child;p;){if(p===i){d=!0,i=s,o=l;break}if(p===o){d=!0,o=s,i=l;break}p=p.sibling}if(!d){for(p=l.child;p;){if(p===i){d=!0,i=l,o=s;break}if(p===o){d=!0,o=l,i=s;break}p=p.sibling}if(!d)throw Error(pn(189))}}if(i.alternate!==o)throw Error(pn(190))}if(i.tag!==3)throw Error(pn(188));return i.stateNode.current===i?n:e}function Bj(n){return n=zoe(n),n!==null?Uj(n):null}function Uj(n){if(n.tag===5||n.tag===6)return n;for(n=n.child;n!==null;){var e=Uj(n);if(e!==null)return e;n=n.sibling}return null}var Wj=Jl.unstable_scheduleCallback,U9=Jl.unstable_cancelCallback,Foe=Jl.unstable_shouldYield,Boe=Jl.unstable_requestPaint,lo=Jl.unstable_now,Uoe=Jl.unstable_getCurrentPriorityLevel,bk=Jl.unstable_ImmediatePriority,Vj=Jl.unstable_UserBlockingPriority,ME=Jl.unstable_NormalPriority,Woe=Jl.unstable_LowPriority,Gj=Jl.unstable_IdlePriority,SM=null,hd=null;function Voe(n){if(hd&&typeof hd.onCommitFiberRoot=="function")try{hd.onCommitFiberRoot(SM,n,void 0,(n.current.flags&128)===128)}catch{}}var hu=Math.clz32?Math.clz32:joe,Goe=Math.log,Hoe=Math.LN2;function joe(n){return n>>>=0,n===0?32:31-(Goe(n)/Hoe|0)|0}var aS=64,rS=4194304;function Nb(n){switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return n&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return n}}function TE(n,e){var i=n.pendingLanes;if(i===0)return 0;var o=0,s=n.suspendedLanes,l=n.pingedLanes,d=i&268435455;if(d!==0){var p=d&~s;p!==0?o=Nb(p):(l&=d,l!==0&&(o=Nb(l)))}else d=i&~s,d!==0?o=Nb(d):l!==0&&(o=Nb(l));if(o===0)return 0;if(e!==0&&e!==o&&!(e&s)&&(s=o&-o,l=e&-e,s>=l||s===16&&(l&4194240)!==0))return e;if(o&4&&(o|=i&16),e=n.entangledLanes,e!==0)for(n=n.entanglements,e&=o;0<e;)i=31-hu(e),s=1<<i,o|=n[i],e&=~s;return o}function $oe(n,e){switch(n){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Yoe(n,e){for(var i=n.suspendedLanes,o=n.pingedLanes,s=n.expirationTimes,l=n.pendingLanes;0<l;){var d=31-hu(l),p=1<<d,f=s[d];f===-1?(!(p&i)||p&o)&&(s[d]=$oe(p,e)):f<=e&&(n.expiredLanes|=p),l&=~p}}function nL(n){return n=n.pendingLanes&-1073741825,n!==0?n:n&1073741824?1073741824:0}function Hj(){var n=aS;return aS<<=1,!(aS&4194240)&&(aS=64),n}function H5(n){for(var e=[],i=0;31>i;i++)e.push(n);return e}function Rw(n,e,i){n.pendingLanes|=e,e!==536870912&&(n.suspendedLanes=0,n.pingedLanes=0),n=n.eventTimes,e=31-hu(e),n[e]=i}function qoe(n,e){var i=n.pendingLanes&~e;n.pendingLanes=e,n.suspendedLanes=0,n.pingedLanes=0,n.expiredLanes&=e,n.mutableReadLanes&=e,n.entangledLanes&=e,e=n.entanglements;var o=n.eventTimes;for(n=n.expirationTimes;0<i;){var s=31-hu(i),l=1<<s;e[s]=0,o[s]=-1,n[s]=-1,i&=~l}}function xk(n,e){var i=n.entangledLanes|=e;for(n=n.entanglements;i;){var o=31-hu(i),s=1<<o;s&e|n[o]&e&&(n[o]|=e),i&=~s}}var Wa=0;function jj(n){return n&=-n,1<n?4<n?n&268435455?16:536870912:4:1}var $j,wk,Yj,qj,Xj,iL=!1,oS=[],rf=null,of=null,sf=null,Rx=new Map,kx=new Map,qp=[],Xoe="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function W9(n,e){switch(n){case"focusin":case"focusout":rf=null;break;case"dragenter":case"dragleave":of=null;break;case"mouseover":case"mouseout":sf=null;break;case"pointerover":case"pointerout":Rx.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":kx.delete(e.pointerId)}}function q1(n,e,i,o,s,l){return n===null||n.nativeEvent!==l?(n={blockedOn:e,domEventName:i,eventSystemFlags:o,nativeEvent:l,targetContainers:[s]},e!==null&&(e=Dw(e),e!==null&&wk(e)),n):(n.eventSystemFlags|=o,e=n.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),n)}function Zoe(n,e,i,o,s){switch(e){case"focusin":return rf=q1(rf,n,e,i,o,s),!0;case"dragenter":return of=q1(of,n,e,i,o,s),!0;case"mouseover":return sf=q1(sf,n,e,i,o,s),!0;case"pointerover":var l=s.pointerId;return Rx.set(l,q1(Rx.get(l)||null,n,e,i,o,s)),!0;case"gotpointercapture":return l=s.pointerId,kx.set(l,q1(kx.get(l)||null,n,e,i,o,s)),!0}return!1}function Zj(n){var e=lg(n.target);if(e!==null){var i=qg(e);if(i!==null){if(e=i.tag,e===13){if(e=Fj(i),e!==null){n.blockedOn=e,Xj(n.priority,function(){Yj(i)});return}}else if(e===3&&i.stateNode.current.memoizedState.isDehydrated){n.blockedOn=i.tag===3?i.stateNode.containerInfo:null;return}}}n.blockedOn=null}function GA(n){if(n.blockedOn!==null)return!1;for(var e=n.targetContainers;0<e.length;){var i=aL(n.domEventName,n.eventSystemFlags,e[0],n.nativeEvent);if(i===null){i=n.nativeEvent;var o=new i.constructor(i.type,i);JI=o,i.target.dispatchEvent(o),JI=null}else return e=Dw(i),e!==null&&wk(e),n.blockedOn=i,!1;e.shift()}return!0}function V9(n,e,i){GA(n)&&i.delete(e)}function Koe(){iL=!1,rf!==null&&GA(rf)&&(rf=null),of!==null&&GA(of)&&(of=null),sf!==null&&GA(sf)&&(sf=null),Rx.forEach(V9),kx.forEach(V9)}function X1(n,e){n.blockedOn===e&&(n.blockedOn=null,iL||(iL=!0,Jl.unstable_scheduleCallback(Jl.unstable_NormalPriority,Koe)))}function Dx(n){function e(s){return X1(s,n)}if(0<oS.length){X1(oS[0],n);for(var i=1;i<oS.length;i++){var o=oS[i];o.blockedOn===n&&(o.blockedOn=null)}}for(rf!==null&&X1(rf,n),of!==null&&X1(of,n),sf!==null&&X1(sf,n),Rx.forEach(e),kx.forEach(e),i=0;i<qp.length;i++)o=qp[i],o.blockedOn===n&&(o.blockedOn=null);for(;0<qp.length&&(i=qp[0],i.blockedOn===null);)Zj(i),i.blockedOn===null&&qp.shift()}var z0=$h.ReactCurrentBatchConfig,CE=!0;function Joe(n,e,i,o){var s=Wa,l=z0.transition;z0.transition=null;try{Wa=1,Sk(n,e,i,o)}finally{Wa=s,z0.transition=l}}function Qoe(n,e,i,o){var s=Wa,l=z0.transition;z0.transition=null;try{Wa=4,Sk(n,e,i,o)}finally{Wa=s,z0.transition=l}}function Sk(n,e,i,o){if(CE){var s=aL(n,e,i,o);if(s===null)e4(n,e,o,PE,i),W9(n,o);else if(Zoe(s,n,e,i,o))o.stopPropagation();else if(W9(n,o),e&4&&-1<Xoe.indexOf(n)){for(;s!==null;){var l=Dw(s);if(l!==null&&$j(l),l=aL(n,e,i,o),l===null&&e4(n,e,o,PE,i),l===s)break;s=l}s!==null&&o.stopPropagation()}else e4(n,e,o,null,i)}}var PE=null;function aL(n,e,i,o){if(PE=null,n=_k(o),n=lg(n),n!==null)if(e=qg(n),e===null)n=null;else if(i=e.tag,i===13){if(n=Fj(e),n!==null)return n;n=null}else if(i===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;n=null}else e!==n&&(n=null);return PE=n,null}function Kj(n){switch(n){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Uoe()){case bk:return 1;case Vj:return 4;case ME:case Woe:return 16;case Gj:return 536870912;default:return 16}default:return 16}}var Kp=null,Ak=null,HA=null;function Jj(){if(HA)return HA;var n,e=Ak,i=e.length,o,s="value"in Kp?Kp.value:Kp.textContent,l=s.length;for(n=0;n<i&&e[n]===s[n];n++);var d=i-n;for(o=1;o<=d&&e[i-o]===s[l-o];o++);return HA=s.slice(n,1<o?1-o:void 0)}function jA(n){var e=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&e===13&&(n=13)):n=e,n===10&&(n=13),32<=n||n===13?n:0}function sS(){return!0}function G9(){return!1}function tc(n){function e(i,o,s,l,d){this._reactName=i,this._targetInst=s,this.type=o,this.nativeEvent=l,this.target=d,this.currentTarget=null;for(var p in n)n.hasOwnProperty(p)&&(i=n[p],this[p]=i?i(l):l[p]);return this.isDefaultPrevented=(l.defaultPrevented!=null?l.defaultPrevented:l.returnValue===!1)?sS:G9,this.isPropagationStopped=G9,this}return Nr(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var i=this.nativeEvent;i&&(i.preventDefault?i.preventDefault():typeof i.returnValue!="unknown"&&(i.returnValue=!1),this.isDefaultPrevented=sS)},stopPropagation:function(){var i=this.nativeEvent;i&&(i.stopPropagation?i.stopPropagation():typeof i.cancelBubble!="unknown"&&(i.cancelBubble=!0),this.isPropagationStopped=sS)},persist:function(){},isPersistent:sS}),e}var v_={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ek=tc(v_),kw=Nr({},v_,{view:0,detail:0}),ese=tc(kw),j5,$5,Z1,AM=Nr({},kw,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Mk,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==Z1&&(Z1&&n.type==="mousemove"?(j5=n.screenX-Z1.screenX,$5=n.screenY-Z1.screenY):$5=j5=0,Z1=n),j5)},movementY:function(n){return"movementY"in n?n.movementY:$5}}),H9=tc(AM),tse=Nr({},AM,{dataTransfer:0}),nse=tc(tse),ise=Nr({},kw,{relatedTarget:0}),Y5=tc(ise),ase=Nr({},v_,{animationName:0,elapsedTime:0,pseudoElement:0}),rse=tc(ase),ose=Nr({},v_,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),sse=tc(ose),lse=Nr({},v_,{data:0}),j9=tc(lse),cse={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},use={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},dse={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function hse(n){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(n):(n=dse[n])?!!e[n]:!1}function Mk(){return hse}var pse=Nr({},kw,{key:function(n){if(n.key){var e=cse[n.key]||n.key;if(e!=="Unidentified")return e}return n.type==="keypress"?(n=jA(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?use[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Mk,charCode:function(n){return n.type==="keypress"?jA(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?jA(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),fse=tc(pse),mse=Nr({},AM,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),$9=tc(mse),gse=Nr({},kw,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Mk}),yse=tc(gse),vse=Nr({},v_,{propertyName:0,elapsedTime:0,pseudoElement:0}),_se=tc(vse),bse=Nr({},AM,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),xse=tc(bse),wse=[9,13,27,32],Tk=Fh&&"CompositionEvent"in window,Kb=null;Fh&&"documentMode"in document&&(Kb=document.documentMode);var Sse=Fh&&"TextEvent"in window&&!Kb,Qj=Fh&&(!Tk||Kb&&8<Kb&&11>=Kb),Y9=String.fromCharCode(32),q9=!1;function e$(n,e){switch(n){case"keyup":return wse.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function t$(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var y0=!1;function Ase(n,e){switch(n){case"compositionend":return t$(e);case"keypress":return e.which!==32?null:(q9=!0,Y9);case"textInput":return n=e.data,n===Y9&&q9?null:n;default:return null}}function Ese(n,e){if(y0)return n==="compositionend"||!Tk&&e$(n,e)?(n=Jj(),HA=Ak=Kp=null,y0=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Qj&&e.locale!=="ko"?null:e.data;default:return null}}var Mse={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function X9(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e==="input"?!!Mse[n.type]:e==="textarea"}function n$(n,e,i,o){kj(o),e=IE(e,"onChange"),0<e.length&&(i=new Ek("onChange","change",null,i,o),n.push({event:i,listeners:e}))}var Jb=null,Ox=null;function Tse(n){p$(n,0)}function EM(n){var e=b0(n);if(Mj(e))return n}function Cse(n,e){if(n==="change")return e}var i$=!1;if(Fh){var q5;if(Fh){var X5="oninput"in document;if(!X5){var Z9=document.createElement("div");Z9.setAttribute("oninput","return;"),X5=typeof Z9.oninput=="function"}q5=X5}else q5=!1;i$=q5&&(!document.documentMode||9<document.documentMode)}function K9(){Jb&&(Jb.detachEvent("onpropertychange",a$),Ox=Jb=null)}function a$(n){if(n.propertyName==="value"&&EM(Ox)){var e=[];n$(e,Ox,n,_k(n)),zj(Tse,e)}}function Pse(n,e,i){n==="focusin"?(K9(),Jb=e,Ox=i,Jb.attachEvent("onpropertychange",a$)):n==="focusout"&&K9()}function Ise(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return EM(Ox)}function Lse(n,e){if(n==="click")return EM(e)}function Rse(n,e){if(n==="input"||n==="change")return EM(e)}function kse(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var mu=typeof Object.is=="function"?Object.is:kse;function Nx(n,e){if(mu(n,e))return!0;if(typeof n!="object"||n===null||typeof e!="object"||e===null)return!1;var i=Object.keys(n),o=Object.keys(e);if(i.length!==o.length)return!1;for(o=0;o<i.length;o++){var s=i[o];if(!UI.call(e,s)||!mu(n[s],e[s]))return!1}return!0}function J9(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function Q9(n,e){var i=J9(n);n=0;for(var o;i;){if(i.nodeType===3){if(o=n+i.textContent.length,n<=e&&o>=e)return{node:i,offset:e-n};n=o}e:{for(;i;){if(i.nextSibling){i=i.nextSibling;break e}i=i.parentNode}i=void 0}i=J9(i)}}function r$(n,e){return n&&e?n===e?!0:n&&n.nodeType===3?!1:e&&e.nodeType===3?r$(n,e.parentNode):"contains"in n?n.contains(e):n.compareDocumentPosition?!!(n.compareDocumentPosition(e)&16):!1:!1}function o$(){for(var n=window,e=SE();e instanceof n.HTMLIFrameElement;){try{var i=typeof e.contentWindow.location.href=="string"}catch{i=!1}if(i)n=e.contentWindow;else break;e=SE(n.document)}return e}function Ck(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e&&(e==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||e==="textarea"||n.contentEditable==="true")}function Dse(n){var e=o$(),i=n.focusedElem,o=n.selectionRange;if(e!==i&&i&&i.ownerDocument&&r$(i.ownerDocument.documentElement,i)){if(o!==null&&Ck(i)){if(e=o.start,n=o.end,n===void 0&&(n=e),"selectionStart"in i)i.selectionStart=e,i.selectionEnd=Math.min(n,i.value.length);else if(n=(e=i.ownerDocument||document)&&e.defaultView||window,n.getSelection){n=n.getSelection();var s=i.textContent.length,l=Math.min(o.start,s);o=o.end===void 0?l:Math.min(o.end,s),!n.extend&&l>o&&(s=o,o=l,l=s),s=Q9(i,l);var d=Q9(i,o);s&&d&&(n.rangeCount!==1||n.anchorNode!==s.node||n.anchorOffset!==s.offset||n.focusNode!==d.node||n.focusOffset!==d.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),n.removeAllRanges(),l>o?(n.addRange(e),n.extend(d.node,d.offset)):(e.setEnd(d.node,d.offset),n.addRange(e)))}}for(e=[],n=i;n=n.parentNode;)n.nodeType===1&&e.push({element:n,left:n.scrollLeft,top:n.scrollTop});for(typeof i.focus=="function"&&i.focus(),i=0;i<e.length;i++)n=e[i],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}var Ose=Fh&&"documentMode"in document&&11>=document.documentMode,v0=null,rL=null,Qb=null,oL=!1;function eU(n,e,i){var o=i.window===i?i.document:i.nodeType===9?i:i.ownerDocument;oL||v0==null||v0!==SE(o)||(o=v0,"selectionStart"in o&&Ck(o)?o={start:o.selectionStart,end:o.selectionEnd}:(o=(o.ownerDocument&&o.ownerDocument.defaultView||window).getSelection(),o={anchorNode:o.anchorNode,anchorOffset:o.anchorOffset,focusNode:o.focusNode,focusOffset:o.focusOffset}),Qb&&Nx(Qb,o)||(Qb=o,o=IE(rL,"onSelect"),0<o.length&&(e=new Ek("onSelect","select",null,e,i),n.push({event:e,listeners:o}),e.target=v0)))}function lS(n,e){var i={};return i[n.toLowerCase()]=e.toLowerCase(),i["Webkit"+n]="webkit"+e,i["Moz"+n]="moz"+e,i}var _0={animationend:lS("Animation","AnimationEnd"),animationiteration:lS("Animation","AnimationIteration"),animationstart:lS("Animation","AnimationStart"),transitionend:lS("Transition","TransitionEnd")},Z5={},s$={};Fh&&(s$=document.createElement("div").style,"AnimationEvent"in window||(delete _0.animationend.animation,delete _0.animationiteration.animation,delete _0.animationstart.animation),"TransitionEvent"in window||delete _0.transitionend.transition);function MM(n){if(Z5[n])return Z5[n];if(!_0[n])return n;var e=_0[n],i;for(i in e)if(e.hasOwnProperty(i)&&i in s$)return Z5[n]=e[i];return n}var l$=MM("animationend"),c$=MM("animationiteration"),u$=MM("animationstart"),d$=MM("transitionend"),h$=new Map,tU="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Tf(n,e){h$.set(n,e),Yg(e,[n])}for(var K5=0;K5<tU.length;K5++){var J5=tU[K5],Nse=J5.toLowerCase(),zse=J5[0].toUpperCase()+J5.slice(1);Tf(Nse,"on"+zse)}Tf(l$,"onAnimationEnd");Tf(c$,"onAnimationIteration");Tf(u$,"onAnimationStart");Tf("dblclick","onDoubleClick");Tf("focusin","onFocus");Tf("focusout","onBlur");Tf(d$,"onTransitionEnd");Y0("onMouseEnter",["mouseout","mouseover"]);Y0("onMouseLeave",["mouseout","mouseover"]);Y0("onPointerEnter",["pointerout","pointerover"]);Y0("onPointerLeave",["pointerout","pointerover"]);Yg("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Yg("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Yg("onBeforeInput",["compositionend","keypress","textInput","paste"]);Yg("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Yg("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Yg("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var zb="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Fse=new Set("cancel close invalid load scroll toggle".split(" ").concat(zb));function nU(n,e,i){var o=n.type||"unknown-event";n.currentTarget=i,Noe(o,e,void 0,n),n.currentTarget=null}function p$(n,e){e=(e&4)!==0;for(var i=0;i<n.length;i++){var o=n[i],s=o.event;o=o.listeners;e:{var l=void 0;if(e)for(var d=o.length-1;0<=d;d--){var p=o[d],f=p.instance,y=p.currentTarget;if(p=p.listener,f!==l&&s.isPropagationStopped())break e;nU(s,p,y),l=f}else for(d=0;d<o.length;d++){if(p=o[d],f=p.instance,y=p.currentTarget,p=p.listener,f!==l&&s.isPropagationStopped())break e;nU(s,p,y),l=f}}}if(EE)throw n=tL,EE=!1,tL=null,n}function sr(n,e){var i=e[dL];i===void 0&&(i=e[dL]=new Set);var o=n+"__bubble";i.has(o)||(f$(e,n,2,!1),i.add(o))}function Q5(n,e,i){var o=0;e&&(o|=4),f$(i,n,o,e)}var cS="_reactListening"+Math.random().toString(36).slice(2);function zx(n){if(!n[cS]){n[cS]=!0,xj.forEach(function(i){i!=="selectionchange"&&(Fse.has(i)||Q5(i,!1,n),Q5(i,!0,n))});var e=n.nodeType===9?n:n.ownerDocument;e===null||e[cS]||(e[cS]=!0,Q5("selectionchange",!1,e))}}function f$(n,e,i,o){switch(Kj(e)){case 1:var s=Joe;break;case 4:s=Qoe;break;default:s=Sk}i=s.bind(null,e,i,n),s=void 0,!eL||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),o?s!==void 0?n.addEventListener(e,i,{capture:!0,passive:s}):n.addEventListener(e,i,!0):s!==void 0?n.addEventListener(e,i,{passive:s}):n.addEventListener(e,i,!1)}function e4(n,e,i,o,s){var l=o;if(!(e&1)&&!(e&2)&&o!==null)e:for(;;){if(o===null)return;var d=o.tag;if(d===3||d===4){var p=o.stateNode.containerInfo;if(p===s||p.nodeType===8&&p.parentNode===s)break;if(d===4)for(d=o.return;d!==null;){var f=d.tag;if((f===3||f===4)&&(f=d.stateNode.containerInfo,f===s||f.nodeType===8&&f.parentNode===s))return;d=d.return}for(;p!==null;){if(d=lg(p),d===null)return;if(f=d.tag,f===5||f===6){o=l=d;continue e}p=p.parentNode}}o=o.return}zj(function(){var y=l,_=_k(i),x=[];e:{var S=h$.get(n);if(S!==void 0){var T=Ek,I=n;switch(n){case"keypress":if(jA(i)===0)break e;case"keydown":case"keyup":T=fse;break;case"focusin":I="focus",T=Y5;break;case"focusout":I="blur",T=Y5;break;case"beforeblur":case"afterblur":T=Y5;break;case"click":if(i.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":T=H9;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":T=nse;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":T=yse;break;case l$:case c$:case u$:T=rse;break;case d$:T=_se;break;case"scroll":T=ese;break;case"wheel":T=xse;break;case"copy":case"cut":case"paste":T=sse;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":T=$9}var R=(e&4)!==0,D=!R&&n==="scroll",L=R?S!==null?S+"Capture":null:S;R=[];for(var O=y,N;O!==null;){N=O;var F=N.stateNode;if(N.tag===5&&F!==null&&(N=F,L!==null&&(F=Lx(O,L),F!=null&&R.push(Fx(O,F,N)))),D)break;O=O.return}0<R.length&&(S=new T(S,I,null,i,_),x.push({event:S,listeners:R}))}}if(!(e&7)){e:{if(S=n==="mouseover"||n==="pointerover",T=n==="mouseout"||n==="pointerout",S&&i!==JI&&(I=i.relatedTarget||i.fromElement)&&(lg(I)||I[Bh]))break e;if((T||S)&&(S=_.window===_?_:(S=_.ownerDocument)?S.defaultView||S.parentWindow:window,T?(I=i.relatedTarget||i.toElement,T=y,I=I?lg(I):null,I!==null&&(D=qg(I),I!==D||I.tag!==5&&I.tag!==6)&&(I=null)):(T=null,I=y),T!==I)){if(R=H9,F="onMouseLeave",L="onMouseEnter",O="mouse",(n==="pointerout"||n==="pointerover")&&(R=$9,F="onPointerLeave",L="onPointerEnter",O="pointer"),D=T==null?S:b0(T),N=I==null?S:b0(I),S=new R(F,O+"leave",T,i,_),S.target=D,S.relatedTarget=N,F=null,lg(_)===y&&(R=new R(L,O+"enter",I,i,_),R.target=N,R.relatedTarget=D,F=R),D=F,T&&I)t:{for(R=T,L=I,O=0,N=R;N;N=Iv(N))O++;for(N=0,F=L;F;F=Iv(F))N++;for(;0<O-N;)R=Iv(R),O--;for(;0<N-O;)L=Iv(L),N--;for(;O--;){if(R===L||L!==null&&R===L.alternate)break t;R=Iv(R),L=Iv(L)}R=null}else R=null;T!==null&&iU(x,S,T,R,!1),I!==null&&D!==null&&iU(x,D,I,R,!0)}}e:{if(S=y?b0(y):window,T=S.nodeName&&S.nodeName.toLowerCase(),T==="select"||T==="input"&&S.type==="file")var G=Cse;else if(X9(S))if(i$)G=Rse;else{G=Ise;var j=Pse}else(T=S.nodeName)&&T.toLowerCase()==="input"&&(S.type==="checkbox"||S.type==="radio")&&(G=Lse);if(G&&(G=G(n,y))){n$(x,G,i,_);break e}j&&j(n,S,y),n==="focusout"&&(j=S._wrapperState)&&j.controlled&&S.type==="number"&&YI(S,"number",S.value)}switch(j=y?b0(y):window,n){case"focusin":(X9(j)||j.contentEditable==="true")&&(v0=j,rL=y,Qb=null);break;case"focusout":Qb=rL=v0=null;break;case"mousedown":oL=!0;break;case"contextmenu":case"mouseup":case"dragend":oL=!1,eU(x,i,_);break;case"selectionchange":if(Ose)break;case"keydown":case"keyup":eU(x,i,_)}var Y;if(Tk)e:{switch(n){case"compositionstart":var te="onCompositionStart";break e;case"compositionend":te="onCompositionEnd";break e;case"compositionupdate":te="onCompositionUpdate";break e}te=void 0}else y0?e$(n,i)&&(te="onCompositionEnd"):n==="keydown"&&i.keyCode===229&&(te="onCompositionStart");te&&(Qj&&i.locale!=="ko"&&(y0||te!=="onCompositionStart"?te==="onCompositionEnd"&&y0&&(Y=Jj()):(Kp=_,Ak="value"in Kp?Kp.value:Kp.textContent,y0=!0)),j=IE(y,te),0<j.length&&(te=new j9(te,n,null,i,_),x.push({event:te,listeners:j}),Y?te.data=Y:(Y=t$(i),Y!==null&&(te.data=Y)))),(Y=Sse?Ase(n,i):Ese(n,i))&&(y=IE(y,"onBeforeInput"),0<y.length&&(_=new j9("onBeforeInput","beforeinput",null,i,_),x.push({event:_,listeners:y}),_.data=Y))}p$(x,e)})}function Fx(n,e,i){return{instance:n,listener:e,currentTarget:i}}function IE(n,e){for(var i=e+"Capture",o=[];n!==null;){var s=n,l=s.stateNode;s.tag===5&&l!==null&&(s=l,l=Lx(n,i),l!=null&&o.unshift(Fx(n,l,s)),l=Lx(n,e),l!=null&&o.push(Fx(n,l,s))),n=n.return}return o}function Iv(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5);return n||null}function iU(n,e,i,o,s){for(var l=e._reactName,d=[];i!==null&&i!==o;){var p=i,f=p.alternate,y=p.stateNode;if(f!==null&&f===o)break;p.tag===5&&y!==null&&(p=y,s?(f=Lx(i,l),f!=null&&d.unshift(Fx(i,f,p))):s||(f=Lx(i,l),f!=null&&d.push(Fx(i,f,p)))),i=i.return}d.length!==0&&n.push({event:e,listeners:d})}var Bse=/\r\n?/g,Use=/\u0000|\uFFFD/g;function aU(n){return(typeof n=="string"?n:""+n).replace(Bse,`
`).replace(Use,"")}function uS(n,e,i){if(e=aU(e),aU(n)!==e&&i)throw Error(pn(425))}function LE(){}var sL=null,lL=null;function cL(n,e){return n==="textarea"||n==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var uL=typeof setTimeout=="function"?setTimeout:void 0,Wse=typeof clearTimeout=="function"?clearTimeout:void 0,rU=typeof Promise=="function"?Promise:void 0,Vse=typeof queueMicrotask=="function"?queueMicrotask:typeof rU<"u"?function(n){return rU.resolve(null).then(n).catch(Gse)}:uL;function Gse(n){setTimeout(function(){throw n})}function t4(n,e){var i=e,o=0;do{var s=i.nextSibling;if(n.removeChild(i),s&&s.nodeType===8)if(i=s.data,i==="/$"){if(o===0){n.removeChild(s),Dx(e);return}o--}else i!=="$"&&i!=="$?"&&i!=="$!"||o++;i=s}while(i);Dx(e)}function lf(n){for(;n!=null;n=n.nextSibling){var e=n.nodeType;if(e===1||e===3)break;if(e===8){if(e=n.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return n}function oU(n){n=n.previousSibling;for(var e=0;n;){if(n.nodeType===8){var i=n.data;if(i==="$"||i==="$!"||i==="$?"){if(e===0)return n;e--}else i==="/$"&&e++}n=n.previousSibling}return null}var __=Math.random().toString(36).slice(2),ld="__reactFiber$"+__,Bx="__reactProps$"+__,Bh="__reactContainer$"+__,dL="__reactEvents$"+__,Hse="__reactListeners$"+__,jse="__reactHandles$"+__;function lg(n){var e=n[ld];if(e)return e;for(var i=n.parentNode;i;){if(e=i[Bh]||i[ld]){if(i=e.alternate,e.child!==null||i!==null&&i.child!==null)for(n=oU(n);n!==null;){if(i=n[ld])return i;n=oU(n)}return e}n=i,i=n.parentNode}return null}function Dw(n){return n=n[ld]||n[Bh],!n||n.tag!==5&&n.tag!==6&&n.tag!==13&&n.tag!==3?null:n}function b0(n){if(n.tag===5||n.tag===6)return n.stateNode;throw Error(pn(33))}function TM(n){return n[Bx]||null}var hL=[],x0=-1;function Cf(n){return{current:n}}function ur(n){0>x0||(n.current=hL[x0],hL[x0]=null,x0--)}function ir(n,e){x0++,hL[x0]=n.current,n.current=e}var _f={},Es=Cf(_f),_l=Cf(!1),Ig=_f;function q0(n,e){var i=n.type.contextTypes;if(!i)return _f;var o=n.stateNode;if(o&&o.__reactInternalMemoizedUnmaskedChildContext===e)return o.__reactInternalMemoizedMaskedChildContext;var s={},l;for(l in i)s[l]=e[l];return o&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=e,n.__reactInternalMemoizedMaskedChildContext=s),s}function bl(n){return n=n.childContextTypes,n!=null}function RE(){ur(_l),ur(Es)}function sU(n,e,i){if(Es.current!==_f)throw Error(pn(168));ir(Es,e),ir(_l,i)}function m$(n,e,i){var o=n.stateNode;if(e=e.childContextTypes,typeof o.getChildContext!="function")return i;o=o.getChildContext();for(var s in o)if(!(s in e))throw Error(pn(108,Poe(n)||"Unknown",s));return Nr({},i,o)}function kE(n){return n=(n=n.stateNode)&&n.__reactInternalMemoizedMergedChildContext||_f,Ig=Es.current,ir(Es,n),ir(_l,_l.current),!0}function lU(n,e,i){var o=n.stateNode;if(!o)throw Error(pn(169));i?(n=m$(n,e,Ig),o.__reactInternalMemoizedMergedChildContext=n,ur(_l),ur(Es),ir(Es,n)):ur(_l),ir(_l,i)}var Sh=null,CM=!1,n4=!1;function g$(n){Sh===null?Sh=[n]:Sh.push(n)}function $se(n){CM=!0,g$(n)}function Pf(){if(!n4&&Sh!==null){n4=!0;var n=0,e=Wa;try{var i=Sh;for(Wa=1;n<i.length;n++){var o=i[n];do o=o(!0);while(o!==null)}Sh=null,CM=!1}catch(s){throw Sh!==null&&(Sh=Sh.slice(n+1)),Wj(bk,Pf),s}finally{Wa=e,n4=!1}}return null}var w0=[],S0=0,DE=null,OE=0,wc=[],Sc=0,Lg=null,Ch=1,Ph="";function Km(n,e){w0[S0++]=OE,w0[S0++]=DE,DE=n,OE=e}function y$(n,e,i){wc[Sc++]=Ch,wc[Sc++]=Ph,wc[Sc++]=Lg,Lg=n;var o=Ch;n=Ph;var s=32-hu(o)-1;o&=~(1<<s),i+=1;var l=32-hu(e)+s;if(30<l){var d=s-s%5;l=(o&(1<<d)-1).toString(32),o>>=d,s-=d,Ch=1<<32-hu(e)+s|i<<s|o,Ph=l+n}else Ch=1<<l|i<<s|o,Ph=n}function Pk(n){n.return!==null&&(Km(n,1),y$(n,1,0))}function Ik(n){for(;n===DE;)DE=w0[--S0],w0[S0]=null,OE=w0[--S0],w0[S0]=null;for(;n===Lg;)Lg=wc[--Sc],wc[Sc]=null,Ph=wc[--Sc],wc[Sc]=null,Ch=wc[--Sc],wc[Sc]=null}var ql=null,Yl=null,br=!1,su=null;function v$(n,e){var i=Ac(5,null,null,0);i.elementType="DELETED",i.stateNode=e,i.return=n,e=n.deletions,e===null?(n.deletions=[i],n.flags|=16):e.push(i)}function cU(n,e){switch(n.tag){case 5:var i=n.type;return e=e.nodeType!==1||i.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(n.stateNode=e,ql=n,Yl=lf(e.firstChild),!0):!1;case 6:return e=n.pendingProps===""||e.nodeType!==3?null:e,e!==null?(n.stateNode=e,ql=n,Yl=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(i=Lg!==null?{id:Ch,overflow:Ph}:null,n.memoizedState={dehydrated:e,treeContext:i,retryLane:1073741824},i=Ac(18,null,null,0),i.stateNode=e,i.return=n,n.child=i,ql=n,Yl=null,!0):!1;default:return!1}}function pL(n){return(n.mode&1)!==0&&(n.flags&128)===0}function fL(n){if(br){var e=Yl;if(e){var i=e;if(!cU(n,e)){if(pL(n))throw Error(pn(418));e=lf(i.nextSibling);var o=ql;e&&cU(n,e)?v$(o,i):(n.flags=n.flags&-4097|2,br=!1,ql=n)}}else{if(pL(n))throw Error(pn(418));n.flags=n.flags&-4097|2,br=!1,ql=n}}}function uU(n){for(n=n.return;n!==null&&n.tag!==5&&n.tag!==3&&n.tag!==13;)n=n.return;ql=n}function dS(n){if(n!==ql)return!1;if(!br)return uU(n),br=!0,!1;var e;if((e=n.tag!==3)&&!(e=n.tag!==5)&&(e=n.type,e=e!=="head"&&e!=="body"&&!cL(n.type,n.memoizedProps)),e&&(e=Yl)){if(pL(n))throw _$(),Error(pn(418));for(;e;)v$(n,e),e=lf(e.nextSibling)}if(uU(n),n.tag===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(pn(317));e:{for(n=n.nextSibling,e=0;n;){if(n.nodeType===8){var i=n.data;if(i==="/$"){if(e===0){Yl=lf(n.nextSibling);break e}e--}else i!=="$"&&i!=="$!"&&i!=="$?"||e++}n=n.nextSibling}Yl=null}}else Yl=ql?lf(n.stateNode.nextSibling):null;return!0}function _$(){for(var n=Yl;n;)n=lf(n.nextSibling)}function X0(){Yl=ql=null,br=!1}function Lk(n){su===null?su=[n]:su.push(n)}var Yse=$h.ReactCurrentBatchConfig;function iu(n,e){if(n&&n.defaultProps){e=Nr({},e),n=n.defaultProps;for(var i in n)e[i]===void 0&&(e[i]=n[i]);return e}return e}var NE=Cf(null),zE=null,A0=null,Rk=null;function kk(){Rk=A0=zE=null}function Dk(n){var e=NE.current;ur(NE),n._currentValue=e}function mL(n,e,i){for(;n!==null;){var o=n.alternate;if((n.childLanes&e)!==e?(n.childLanes|=e,o!==null&&(o.childLanes|=e)):o!==null&&(o.childLanes&e)!==e&&(o.childLanes|=e),n===i)break;n=n.return}}function F0(n,e){zE=n,Rk=A0=null,n=n.dependencies,n!==null&&n.firstContext!==null&&(n.lanes&e&&(vl=!0),n.firstContext=null)}function Tc(n){var e=n._currentValue;if(Rk!==n)if(n={context:n,memoizedValue:e,next:null},A0===null){if(zE===null)throw Error(pn(308));A0=n,zE.dependencies={lanes:0,firstContext:n}}else A0=A0.next=n;return e}var cg=null;function Ok(n){cg===null?cg=[n]:cg.push(n)}function b$(n,e,i,o){var s=e.interleaved;return s===null?(i.next=i,Ok(e)):(i.next=s.next,s.next=i),e.interleaved=i,Uh(n,o)}function Uh(n,e){n.lanes|=e;var i=n.alternate;for(i!==null&&(i.lanes|=e),i=n,n=n.return;n!==null;)n.childLanes|=e,i=n.alternate,i!==null&&(i.childLanes|=e),i=n,n=n.return;return i.tag===3?i.stateNode:null}var Yp=!1;function Nk(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function x$(n,e){n=n.updateQueue,e.updateQueue===n&&(e.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,effects:n.effects})}function Nh(n,e){return{eventTime:n,lane:e,tag:0,payload:null,callback:null,next:null}}function cf(n,e,i){var o=n.updateQueue;if(o===null)return null;if(o=o.shared,ua&2){var s=o.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),o.pending=e,Uh(n,i)}return s=o.interleaved,s===null?(e.next=e,Ok(o)):(e.next=s.next,s.next=e),o.interleaved=e,Uh(n,i)}function $A(n,e,i){if(e=e.updateQueue,e!==null&&(e=e.shared,(i&4194240)!==0)){var o=e.lanes;o&=n.pendingLanes,i|=o,e.lanes=i,xk(n,i)}}function dU(n,e){var i=n.updateQueue,o=n.alternate;if(o!==null&&(o=o.updateQueue,i===o)){var s=null,l=null;if(i=i.firstBaseUpdate,i!==null){do{var d={eventTime:i.eventTime,lane:i.lane,tag:i.tag,payload:i.payload,callback:i.callback,next:null};l===null?s=l=d:l=l.next=d,i=i.next}while(i!==null);l===null?s=l=e:l=l.next=e}else s=l=e;i={baseState:o.baseState,firstBaseUpdate:s,lastBaseUpdate:l,shared:o.shared,effects:o.effects},n.updateQueue=i;return}n=i.lastBaseUpdate,n===null?i.firstBaseUpdate=e:n.next=e,i.lastBaseUpdate=e}function FE(n,e,i,o){var s=n.updateQueue;Yp=!1;var l=s.firstBaseUpdate,d=s.lastBaseUpdate,p=s.shared.pending;if(p!==null){s.shared.pending=null;var f=p,y=f.next;f.next=null,d===null?l=y:d.next=y,d=f;var _=n.alternate;_!==null&&(_=_.updateQueue,p=_.lastBaseUpdate,p!==d&&(p===null?_.firstBaseUpdate=y:p.next=y,_.lastBaseUpdate=f))}if(l!==null){var x=s.baseState;d=0,_=y=f=null,p=l;do{var S=p.lane,T=p.eventTime;if((o&S)===S){_!==null&&(_=_.next={eventTime:T,lane:0,tag:p.tag,payload:p.payload,callback:p.callback,next:null});e:{var I=n,R=p;switch(S=e,T=i,R.tag){case 1:if(I=R.payload,typeof I=="function"){x=I.call(T,x,S);break e}x=I;break e;case 3:I.flags=I.flags&-65537|128;case 0:if(I=R.payload,S=typeof I=="function"?I.call(T,x,S):I,S==null)break e;x=Nr({},x,S);break e;case 2:Yp=!0}}p.callback!==null&&p.lane!==0&&(n.flags|=64,S=s.effects,S===null?s.effects=[p]:S.push(p))}else T={eventTime:T,lane:S,tag:p.tag,payload:p.payload,callback:p.callback,next:null},_===null?(y=_=T,f=x):_=_.next=T,d|=S;if(p=p.next,p===null){if(p=s.shared.pending,p===null)break;S=p,p=S.next,S.next=null,s.lastBaseUpdate=S,s.shared.pending=null}}while(1);if(_===null&&(f=x),s.baseState=f,s.firstBaseUpdate=y,s.lastBaseUpdate=_,e=s.shared.interleaved,e!==null){s=e;do d|=s.lane,s=s.next;while(s!==e)}else l===null&&(s.shared.lanes=0);kg|=d,n.lanes=d,n.memoizedState=x}}function hU(n,e,i){if(n=e.effects,e.effects=null,n!==null)for(e=0;e<n.length;e++){var o=n[e],s=o.callback;if(s!==null){if(o.callback=null,o=i,typeof s!="function")throw Error(pn(191,s));s.call(o)}}}var w$=new bj.Component().refs;function gL(n,e,i,o){e=n.memoizedState,i=i(o,e),i=i==null?e:Nr({},e,i),n.memoizedState=i,n.lanes===0&&(n.updateQueue.baseState=i)}var PM={isMounted:function(n){return(n=n._reactInternals)?qg(n)===n:!1},enqueueSetState:function(n,e,i){n=n._reactInternals;var o=js(),s=df(n),l=Nh(o,s);l.payload=e,i!=null&&(l.callback=i),e=cf(n,l,s),e!==null&&(pu(e,n,s,o),$A(e,n,s))},enqueueReplaceState:function(n,e,i){n=n._reactInternals;var o=js(),s=df(n),l=Nh(o,s);l.tag=1,l.payload=e,i!=null&&(l.callback=i),e=cf(n,l,s),e!==null&&(pu(e,n,s,o),$A(e,n,s))},enqueueForceUpdate:function(n,e){n=n._reactInternals;var i=js(),o=df(n),s=Nh(i,o);s.tag=2,e!=null&&(s.callback=e),e=cf(n,s,o),e!==null&&(pu(e,n,o,i),$A(e,n,o))}};function pU(n,e,i,o,s,l,d){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(o,l,d):e.prototype&&e.prototype.isPureReactComponent?!Nx(i,o)||!Nx(s,l):!0}function S$(n,e,i){var o=!1,s=_f,l=e.contextType;return typeof l=="object"&&l!==null?l=Tc(l):(s=bl(e)?Ig:Es.current,o=e.contextTypes,l=(o=o!=null)?q0(n,s):_f),e=new e(i,l),n.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=PM,n.stateNode=e,e._reactInternals=n,o&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=s,n.__reactInternalMemoizedMaskedChildContext=l),e}function fU(n,e,i,o){n=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(i,o),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(i,o),e.state!==n&&PM.enqueueReplaceState(e,e.state,null)}function yL(n,e,i,o){var s=n.stateNode;s.props=i,s.state=n.memoizedState,s.refs=w$,Nk(n);var l=e.contextType;typeof l=="object"&&l!==null?s.context=Tc(l):(l=bl(e)?Ig:Es.current,s.context=q0(n,l)),s.state=n.memoizedState,l=e.getDerivedStateFromProps,typeof l=="function"&&(gL(n,e,l,i),s.state=n.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&PM.enqueueReplaceState(s,s.state,null),FE(n,i,s,o),s.state=n.memoizedState),typeof s.componentDidMount=="function"&&(n.flags|=4194308)}function K1(n,e,i){if(n=i.ref,n!==null&&typeof n!="function"&&typeof n!="object"){if(i._owner){if(i=i._owner,i){if(i.tag!==1)throw Error(pn(309));var o=i.stateNode}if(!o)throw Error(pn(147,n));var s=o,l=""+n;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===l?e.ref:(e=function(d){var p=s.refs;p===w$&&(p=s.refs={}),d===null?delete p[l]:p[l]=d},e._stringRef=l,e)}if(typeof n!="string")throw Error(pn(284));if(!i._owner)throw Error(pn(290,n))}return n}function hS(n,e){throw n=Object.prototype.toString.call(e),Error(pn(31,n==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":n))}function mU(n){var e=n._init;return e(n._payload)}function A$(n){function e(L,O){if(n){var N=L.deletions;N===null?(L.deletions=[O],L.flags|=16):N.push(O)}}function i(L,O){if(!n)return null;for(;O!==null;)e(L,O),O=O.sibling;return null}function o(L,O){for(L=new Map;O!==null;)O.key!==null?L.set(O.key,O):L.set(O.index,O),O=O.sibling;return L}function s(L,O){return L=hf(L,O),L.index=0,L.sibling=null,L}function l(L,O,N){return L.index=N,n?(N=L.alternate,N!==null?(N=N.index,N<O?(L.flags|=2,O):N):(L.flags|=2,O)):(L.flags|=1048576,O)}function d(L){return n&&L.alternate===null&&(L.flags|=2),L}function p(L,O,N,F){return O===null||O.tag!==6?(O=c4(N,L.mode,F),O.return=L,O):(O=s(O,N),O.return=L,O)}function f(L,O,N,F){var G=N.type;return G===g0?_(L,O,N.props.children,F,N.key):O!==null&&(O.elementType===G||typeof G=="object"&&G!==null&&G.$$typeof===$p&&mU(G)===O.type)?(F=s(O,N.props),F.ref=K1(L,O,N),F.return=L,F):(F=JA(N.type,N.key,N.props,null,L.mode,F),F.ref=K1(L,O,N),F.return=L,F)}function y(L,O,N,F){return O===null||O.tag!==4||O.stateNode.containerInfo!==N.containerInfo||O.stateNode.implementation!==N.implementation?(O=u4(N,L.mode,F),O.return=L,O):(O=s(O,N.children||[]),O.return=L,O)}function _(L,O,N,F,G){return O===null||O.tag!==7?(O=xg(N,L.mode,F,G),O.return=L,O):(O=s(O,N),O.return=L,O)}function x(L,O,N){if(typeof O=="string"&&O!==""||typeof O=="number")return O=c4(""+O,L.mode,N),O.return=L,O;if(typeof O=="object"&&O!==null){switch(O.$$typeof){case tS:return N=JA(O.type,O.key,O.props,null,L.mode,N),N.ref=K1(L,null,O),N.return=L,N;case m0:return O=u4(O,L.mode,N),O.return=L,O;case $p:var F=O._init;return x(L,F(O._payload),N)}if(Ob(O)||$1(O))return O=xg(O,L.mode,N,null),O.return=L,O;hS(L,O)}return null}function S(L,O,N,F){var G=O!==null?O.key:null;if(typeof N=="string"&&N!==""||typeof N=="number")return G!==null?null:p(L,O,""+N,F);if(typeof N=="object"&&N!==null){switch(N.$$typeof){case tS:return N.key===G?f(L,O,N,F):null;case m0:return N.key===G?y(L,O,N,F):null;case $p:return G=N._init,S(L,O,G(N._payload),F)}if(Ob(N)||$1(N))return G!==null?null:_(L,O,N,F,null);hS(L,N)}return null}function T(L,O,N,F,G){if(typeof F=="string"&&F!==""||typeof F=="number")return L=L.get(N)||null,p(O,L,""+F,G);if(typeof F=="object"&&F!==null){switch(F.$$typeof){case tS:return L=L.get(F.key===null?N:F.key)||null,f(O,L,F,G);case m0:return L=L.get(F.key===null?N:F.key)||null,y(O,L,F,G);case $p:var j=F._init;return T(L,O,N,j(F._payload),G)}if(Ob(F)||$1(F))return L=L.get(N)||null,_(O,L,F,G,null);hS(O,F)}return null}function I(L,O,N,F){for(var G=null,j=null,Y=O,te=O=0,V=null;Y!==null&&te<N.length;te++){Y.index>te?(V=Y,Y=null):V=Y.sibling;var Q=S(L,Y,N[te],F);if(Q===null){Y===null&&(Y=V);break}n&&Y&&Q.alternate===null&&e(L,Y),O=l(Q,O,te),j===null?G=Q:j.sibling=Q,j=Q,Y=V}if(te===N.length)return i(L,Y),br&&Km(L,te),G;if(Y===null){for(;te<N.length;te++)Y=x(L,N[te],F),Y!==null&&(O=l(Y,O,te),j===null?G=Y:j.sibling=Y,j=Y);return br&&Km(L,te),G}for(Y=o(L,Y);te<N.length;te++)V=T(Y,L,te,N[te],F),V!==null&&(n&&V.alternate!==null&&Y.delete(V.key===null?te:V.key),O=l(V,O,te),j===null?G=V:j.sibling=V,j=V);return n&&Y.forEach(function(he){return e(L,he)}),br&&Km(L,te),G}function R(L,O,N,F){var G=$1(N);if(typeof G!="function")throw Error(pn(150));if(N=G.call(N),N==null)throw Error(pn(151));for(var j=G=null,Y=O,te=O=0,V=null,Q=N.next();Y!==null&&!Q.done;te++,Q=N.next()){Y.index>te?(V=Y,Y=null):V=Y.sibling;var he=S(L,Y,Q.value,F);if(he===null){Y===null&&(Y=V);break}n&&Y&&he.alternate===null&&e(L,Y),O=l(he,O,te),j===null?G=he:j.sibling=he,j=he,Y=V}if(Q.done)return i(L,Y),br&&Km(L,te),G;if(Y===null){for(;!Q.done;te++,Q=N.next())Q=x(L,Q.value,F),Q!==null&&(O=l(Q,O,te),j===null?G=Q:j.sibling=Q,j=Q);return br&&Km(L,te),G}for(Y=o(L,Y);!Q.done;te++,Q=N.next())Q=T(Y,L,te,Q.value,F),Q!==null&&(n&&Q.alternate!==null&&Y.delete(Q.key===null?te:Q.key),O=l(Q,O,te),j===null?G=Q:j.sibling=Q,j=Q);return n&&Y.forEach(function(fe){return e(L,fe)}),br&&Km(L,te),G}function D(L,O,N,F){if(typeof N=="object"&&N!==null&&N.type===g0&&N.key===null&&(N=N.props.children),typeof N=="object"&&N!==null){switch(N.$$typeof){case tS:e:{for(var G=N.key,j=O;j!==null;){if(j.key===G){if(G=N.type,G===g0){if(j.tag===7){i(L,j.sibling),O=s(j,N.props.children),O.return=L,L=O;break e}}else if(j.elementType===G||typeof G=="object"&&G!==null&&G.$$typeof===$p&&mU(G)===j.type){i(L,j.sibling),O=s(j,N.props),O.ref=K1(L,j,N),O.return=L,L=O;break e}i(L,j);break}else e(L,j);j=j.sibling}N.type===g0?(O=xg(N.props.children,L.mode,F,N.key),O.return=L,L=O):(F=JA(N.type,N.key,N.props,null,L.mode,F),F.ref=K1(L,O,N),F.return=L,L=F)}return d(L);case m0:e:{for(j=N.key;O!==null;){if(O.key===j)if(O.tag===4&&O.stateNode.containerInfo===N.containerInfo&&O.stateNode.implementation===N.implementation){i(L,O.sibling),O=s(O,N.children||[]),O.return=L,L=O;break e}else{i(L,O);break}else e(L,O);O=O.sibling}O=u4(N,L.mode,F),O.return=L,L=O}return d(L);case $p:return j=N._init,D(L,O,j(N._payload),F)}if(Ob(N))return I(L,O,N,F);if($1(N))return R(L,O,N,F);hS(L,N)}return typeof N=="string"&&N!==""||typeof N=="number"?(N=""+N,O!==null&&O.tag===6?(i(L,O.sibling),O=s(O,N),O.return=L,L=O):(i(L,O),O=c4(N,L.mode,F),O.return=L,L=O),d(L)):i(L,O)}return D}var Z0=A$(!0),E$=A$(!1),Ow={},pd=Cf(Ow),Ux=Cf(Ow),Wx=Cf(Ow);function ug(n){if(n===Ow)throw Error(pn(174));return n}function zk(n,e){switch(ir(Wx,e),ir(Ux,n),ir(pd,Ow),n=e.nodeType,n){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:XI(null,"");break;default:n=n===8?e.parentNode:e,e=n.namespaceURI||null,n=n.tagName,e=XI(e,n)}ur(pd),ir(pd,e)}function K0(){ur(pd),ur(Ux),ur(Wx)}function M$(n){ug(Wx.current);var e=ug(pd.current),i=XI(e,n.type);e!==i&&(ir(Ux,n),ir(pd,i))}function Fk(n){Ux.current===n&&(ur(pd),ur(Ux))}var Ir=Cf(0);function BE(n){for(var e=n;e!==null;){if(e.tag===13){var i=e.memoizedState;if(i!==null&&(i=i.dehydrated,i===null||i.data==="$?"||i.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var i4=[];function Bk(){for(var n=0;n<i4.length;n++)i4[n]._workInProgressVersionPrimary=null;i4.length=0}var YA=$h.ReactCurrentDispatcher,a4=$h.ReactCurrentBatchConfig,Rg=0,Dr=null,Po=null,Bo=null,UE=!1,ex=!1,Vx=0,qse=0;function ds(){throw Error(pn(321))}function Uk(n,e){if(e===null)return!1;for(var i=0;i<e.length&&i<n.length;i++)if(!mu(n[i],e[i]))return!1;return!0}function Wk(n,e,i,o,s,l){if(Rg=l,Dr=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,YA.current=n===null||n.memoizedState===null?Jse:Qse,n=i(o,s),ex){l=0;do{if(ex=!1,Vx=0,25<=l)throw Error(pn(301));l+=1,Bo=Po=null,e.updateQueue=null,YA.current=ele,n=i(o,s)}while(ex)}if(YA.current=WE,e=Po!==null&&Po.next!==null,Rg=0,Bo=Po=Dr=null,UE=!1,e)throw Error(pn(300));return n}function Vk(){var n=Vx!==0;return Vx=0,n}function ad(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Bo===null?Dr.memoizedState=Bo=n:Bo=Bo.next=n,Bo}function Cc(){if(Po===null){var n=Dr.alternate;n=n!==null?n.memoizedState:null}else n=Po.next;var e=Bo===null?Dr.memoizedState:Bo.next;if(e!==null)Bo=e,Po=n;else{if(n===null)throw Error(pn(310));Po=n,n={memoizedState:Po.memoizedState,baseState:Po.baseState,baseQueue:Po.baseQueue,queue:Po.queue,next:null},Bo===null?Dr.memoizedState=Bo=n:Bo=Bo.next=n}return Bo}function Gx(n,e){return typeof e=="function"?e(n):e}function r4(n){var e=Cc(),i=e.queue;if(i===null)throw Error(pn(311));i.lastRenderedReducer=n;var o=Po,s=o.baseQueue,l=i.pending;if(l!==null){if(s!==null){var d=s.next;s.next=l.next,l.next=d}o.baseQueue=s=l,i.pending=null}if(s!==null){l=s.next,o=o.baseState;var p=d=null,f=null,y=l;do{var _=y.lane;if((Rg&_)===_)f!==null&&(f=f.next={lane:0,action:y.action,hasEagerState:y.hasEagerState,eagerState:y.eagerState,next:null}),o=y.hasEagerState?y.eagerState:n(o,y.action);else{var x={lane:_,action:y.action,hasEagerState:y.hasEagerState,eagerState:y.eagerState,next:null};f===null?(p=f=x,d=o):f=f.next=x,Dr.lanes|=_,kg|=_}y=y.next}while(y!==null&&y!==l);f===null?d=o:f.next=p,mu(o,e.memoizedState)||(vl=!0),e.memoizedState=o,e.baseState=d,e.baseQueue=f,i.lastRenderedState=o}if(n=i.interleaved,n!==null){s=n;do l=s.lane,Dr.lanes|=l,kg|=l,s=s.next;while(s!==n)}else s===null&&(i.lanes=0);return[e.memoizedState,i.dispatch]}function o4(n){var e=Cc(),i=e.queue;if(i===null)throw Error(pn(311));i.lastRenderedReducer=n;var o=i.dispatch,s=i.pending,l=e.memoizedState;if(s!==null){i.pending=null;var d=s=s.next;do l=n(l,d.action),d=d.next;while(d!==s);mu(l,e.memoizedState)||(vl=!0),e.memoizedState=l,e.baseQueue===null&&(e.baseState=l),i.lastRenderedState=l}return[l,o]}function T$(){}function C$(n,e){var i=Dr,o=Cc(),s=e(),l=!mu(o.memoizedState,s);if(l&&(o.memoizedState=s,vl=!0),o=o.queue,Gk(L$.bind(null,i,o,n),[n]),o.getSnapshot!==e||l||Bo!==null&&Bo.memoizedState.tag&1){if(i.flags|=2048,Hx(9,I$.bind(null,i,o,s,e),void 0,null),Wo===null)throw Error(pn(349));Rg&30||P$(i,e,s)}return s}function P$(n,e,i){n.flags|=16384,n={getSnapshot:e,value:i},e=Dr.updateQueue,e===null?(e={lastEffect:null,stores:null},Dr.updateQueue=e,e.stores=[n]):(i=e.stores,i===null?e.stores=[n]:i.push(n))}function I$(n,e,i,o){e.value=i,e.getSnapshot=o,R$(e)&&k$(n)}function L$(n,e,i){return i(function(){R$(e)&&k$(n)})}function R$(n){var e=n.getSnapshot;n=n.value;try{var i=e();return!mu(n,i)}catch{return!0}}function k$(n){var e=Uh(n,1);e!==null&&pu(e,n,1,-1)}function gU(n){var e=ad();return typeof n=="function"&&(n=n()),e.memoizedState=e.baseState=n,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Gx,lastRenderedState:n},e.queue=n,n=n.dispatch=Kse.bind(null,Dr,n),[e.memoizedState,n]}function Hx(n,e,i,o){return n={tag:n,create:e,destroy:i,deps:o,next:null},e=Dr.updateQueue,e===null?(e={lastEffect:null,stores:null},Dr.updateQueue=e,e.lastEffect=n.next=n):(i=e.lastEffect,i===null?e.lastEffect=n.next=n:(o=i.next,i.next=n,n.next=o,e.lastEffect=n)),n}function D$(){return Cc().memoizedState}function qA(n,e,i,o){var s=ad();Dr.flags|=n,s.memoizedState=Hx(1|e,i,void 0,o===void 0?null:o)}function IM(n,e,i,o){var s=Cc();o=o===void 0?null:o;var l=void 0;if(Po!==null){var d=Po.memoizedState;if(l=d.destroy,o!==null&&Uk(o,d.deps)){s.memoizedState=Hx(e,i,l,o);return}}Dr.flags|=n,s.memoizedState=Hx(1|e,i,l,o)}function yU(n,e){return qA(8390656,8,n,e)}function Gk(n,e){return IM(2048,8,n,e)}function O$(n,e){return IM(4,2,n,e)}function N$(n,e){return IM(4,4,n,e)}function z$(n,e){if(typeof e=="function")return n=n(),e(n),function(){e(null)};if(e!=null)return n=n(),e.current=n,function(){e.current=null}}function F$(n,e,i){return i=i!=null?i.concat([n]):null,IM(4,4,z$.bind(null,e,n),i)}function Hk(){}function B$(n,e){var i=Cc();e=e===void 0?null:e;var o=i.memoizedState;return o!==null&&e!==null&&Uk(e,o[1])?o[0]:(i.memoizedState=[n,e],n)}function U$(n,e){var i=Cc();e=e===void 0?null:e;var o=i.memoizedState;return o!==null&&e!==null&&Uk(e,o[1])?o[0]:(n=n(),i.memoizedState=[n,e],n)}function W$(n,e,i){return Rg&21?(mu(i,e)||(i=Hj(),Dr.lanes|=i,kg|=i,n.baseState=!0),e):(n.baseState&&(n.baseState=!1,vl=!0),n.memoizedState=i)}function Xse(n,e){var i=Wa;Wa=i!==0&&4>i?i:4,n(!0);var o=a4.transition;a4.transition={};try{n(!1),e()}finally{Wa=i,a4.transition=o}}function V$(){return Cc().memoizedState}function Zse(n,e,i){var o=df(n);if(i={lane:o,action:i,hasEagerState:!1,eagerState:null,next:null},G$(n))H$(e,i);else if(i=b$(n,e,i,o),i!==null){var s=js();pu(i,n,o,s),j$(i,e,o)}}function Kse(n,e,i){var o=df(n),s={lane:o,action:i,hasEagerState:!1,eagerState:null,next:null};if(G$(n))H$(e,s);else{var l=n.alternate;if(n.lanes===0&&(l===null||l.lanes===0)&&(l=e.lastRenderedReducer,l!==null))try{var d=e.lastRenderedState,p=l(d,i);if(s.hasEagerState=!0,s.eagerState=p,mu(p,d)){var f=e.interleaved;f===null?(s.next=s,Ok(e)):(s.next=f.next,f.next=s),e.interleaved=s;return}}catch{}finally{}i=b$(n,e,s,o),i!==null&&(s=js(),pu(i,n,o,s),j$(i,e,o))}}function G$(n){var e=n.alternate;return n===Dr||e!==null&&e===Dr}function H$(n,e){ex=UE=!0;var i=n.pending;i===null?e.next=e:(e.next=i.next,i.next=e),n.pending=e}function j$(n,e,i){if(i&4194240){var o=e.lanes;o&=n.pendingLanes,i|=o,e.lanes=i,xk(n,i)}}var WE={readContext:Tc,useCallback:ds,useContext:ds,useEffect:ds,useImperativeHandle:ds,useInsertionEffect:ds,useLayoutEffect:ds,useMemo:ds,useReducer:ds,useRef:ds,useState:ds,useDebugValue:ds,useDeferredValue:ds,useTransition:ds,useMutableSource:ds,useSyncExternalStore:ds,useId:ds,unstable_isNewReconciler:!1},Jse={readContext:Tc,useCallback:function(n,e){return ad().memoizedState=[n,e===void 0?null:e],n},useContext:Tc,useEffect:yU,useImperativeHandle:function(n,e,i){return i=i!=null?i.concat([n]):null,qA(4194308,4,z$.bind(null,e,n),i)},useLayoutEffect:function(n,e){return qA(4194308,4,n,e)},useInsertionEffect:function(n,e){return qA(4,2,n,e)},useMemo:function(n,e){var i=ad();return e=e===void 0?null:e,n=n(),i.memoizedState=[n,e],n},useReducer:function(n,e,i){var o=ad();return e=i!==void 0?i(e):e,o.memoizedState=o.baseState=e,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:e},o.queue=n,n=n.dispatch=Zse.bind(null,Dr,n),[o.memoizedState,n]},useRef:function(n){var e=ad();return n={current:n},e.memoizedState=n},useState:gU,useDebugValue:Hk,useDeferredValue:function(n){return ad().memoizedState=n},useTransition:function(){var n=gU(!1),e=n[0];return n=Xse.bind(null,n[1]),ad().memoizedState=n,[e,n]},useMutableSource:function(){},useSyncExternalStore:function(n,e,i){var o=Dr,s=ad();if(br){if(i===void 0)throw Error(pn(407));i=i()}else{if(i=e(),Wo===null)throw Error(pn(349));Rg&30||P$(o,e,i)}s.memoizedState=i;var l={value:i,getSnapshot:e};return s.queue=l,yU(L$.bind(null,o,l,n),[n]),o.flags|=2048,Hx(9,I$.bind(null,o,l,i,e),void 0,null),i},useId:function(){var n=ad(),e=Wo.identifierPrefix;if(br){var i=Ph,o=Ch;i=(o&~(1<<32-hu(o)-1)).toString(32)+i,e=":"+e+"R"+i,i=Vx++,0<i&&(e+="H"+i.toString(32)),e+=":"}else i=qse++,e=":"+e+"r"+i.toString(32)+":";return n.memoizedState=e},unstable_isNewReconciler:!1},Qse={readContext:Tc,useCallback:B$,useContext:Tc,useEffect:Gk,useImperativeHandle:F$,useInsertionEffect:O$,useLayoutEffect:N$,useMemo:U$,useReducer:r4,useRef:D$,useState:function(){return r4(Gx)},useDebugValue:Hk,useDeferredValue:function(n){var e=Cc();return W$(e,Po.memoizedState,n)},useTransition:function(){var n=r4(Gx)[0],e=Cc().memoizedState;return[n,e]},useMutableSource:T$,useSyncExternalStore:C$,useId:V$,unstable_isNewReconciler:!1},ele={readContext:Tc,useCallback:B$,useContext:Tc,useEffect:Gk,useImperativeHandle:F$,useInsertionEffect:O$,useLayoutEffect:N$,useMemo:U$,useReducer:o4,useRef:D$,useState:function(){return o4(Gx)},useDebugValue:Hk,useDeferredValue:function(n){var e=Cc();return Po===null?e.memoizedState=n:W$(e,Po.memoizedState,n)},useTransition:function(){var n=o4(Gx)[0],e=Cc().memoizedState;return[n,e]},useMutableSource:T$,useSyncExternalStore:C$,useId:V$,unstable_isNewReconciler:!1};function J0(n,e){try{var i="",o=e;do i+=Coe(o),o=o.return;while(o);var s=i}catch(l){s=`
Error generating stack: `+l.message+`
`+l.stack}return{value:n,source:e,stack:s,digest:null}}function s4(n,e,i){return{value:n,source:null,stack:i??null,digest:e??null}}function vL(n,e){try{console.error(e.value)}catch(i){setTimeout(function(){throw i})}}var tle=typeof WeakMap=="function"?WeakMap:Map;function $$(n,e,i){i=Nh(-1,i),i.tag=3,i.payload={element:null};var o=e.value;return i.callback=function(){GE||(GE=!0,CL=o),vL(n,e)},i}function Y$(n,e,i){i=Nh(-1,i),i.tag=3;var o=n.type.getDerivedStateFromError;if(typeof o=="function"){var s=e.value;i.payload=function(){return o(s)},i.callback=function(){vL(n,e)}}var l=n.stateNode;return l!==null&&typeof l.componentDidCatch=="function"&&(i.callback=function(){vL(n,e),typeof o!="function"&&(uf===null?uf=new Set([this]):uf.add(this));var d=e.stack;this.componentDidCatch(e.value,{componentStack:d!==null?d:""})}),i}function vU(n,e,i){var o=n.pingCache;if(o===null){o=n.pingCache=new tle;var s=new Set;o.set(e,s)}else s=o.get(e),s===void 0&&(s=new Set,o.set(e,s));s.has(i)||(s.add(i),n=mle.bind(null,n,e,i),e.then(n,n))}function _U(n){do{var e;if((e=n.tag===13)&&(e=n.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return n;n=n.return}while(n!==null);return null}function bU(n,e,i,o,s){return n.mode&1?(n.flags|=65536,n.lanes=s,n):(n===e?n.flags|=65536:(n.flags|=128,i.flags|=131072,i.flags&=-52805,i.tag===1&&(i.alternate===null?i.tag=17:(e=Nh(-1,1),e.tag=2,cf(i,e,1))),i.lanes|=1),n)}var nle=$h.ReactCurrentOwner,vl=!1;function Gs(n,e,i,o){e.child=n===null?E$(e,null,i,o):Z0(e,n.child,i,o)}function xU(n,e,i,o,s){i=i.render;var l=e.ref;return F0(e,s),o=Wk(n,e,i,o,l,s),i=Vk(),n!==null&&!vl?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~s,Wh(n,e,s)):(br&&i&&Pk(e),e.flags|=1,Gs(n,e,o,s),e.child)}function wU(n,e,i,o,s){if(n===null){var l=i.type;return typeof l=="function"&&!Jk(l)&&l.defaultProps===void 0&&i.compare===null&&i.defaultProps===void 0?(e.tag=15,e.type=l,q$(n,e,l,o,s)):(n=JA(i.type,null,o,e,e.mode,s),n.ref=e.ref,n.return=e,e.child=n)}if(l=n.child,!(n.lanes&s)){var d=l.memoizedProps;if(i=i.compare,i=i!==null?i:Nx,i(d,o)&&n.ref===e.ref)return Wh(n,e,s)}return e.flags|=1,n=hf(l,o),n.ref=e.ref,n.return=e,e.child=n}function q$(n,e,i,o,s){if(n!==null){var l=n.memoizedProps;if(Nx(l,o)&&n.ref===e.ref)if(vl=!1,e.pendingProps=o=l,(n.lanes&s)!==0)n.flags&131072&&(vl=!0);else return e.lanes=n.lanes,Wh(n,e,s)}return _L(n,e,i,o,s)}function X$(n,e,i){var o=e.pendingProps,s=o.children,l=n!==null?n.memoizedState:null;if(o.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},ir(M0,Vl),Vl|=i;else{if(!(i&1073741824))return n=l!==null?l.baseLanes|i:i,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:n,cachePool:null,transitions:null},e.updateQueue=null,ir(M0,Vl),Vl|=n,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},o=l!==null?l.baseLanes:i,ir(M0,Vl),Vl|=o}else l!==null?(o=l.baseLanes|i,e.memoizedState=null):o=i,ir(M0,Vl),Vl|=o;return Gs(n,e,s,i),e.child}function Z$(n,e){var i=e.ref;(n===null&&i!==null||n!==null&&n.ref!==i)&&(e.flags|=512,e.flags|=2097152)}function _L(n,e,i,o,s){var l=bl(i)?Ig:Es.current;return l=q0(e,l),F0(e,s),i=Wk(n,e,i,o,l,s),o=Vk(),n!==null&&!vl?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~s,Wh(n,e,s)):(br&&o&&Pk(e),e.flags|=1,Gs(n,e,i,s),e.child)}function SU(n,e,i,o,s){if(bl(i)){var l=!0;kE(e)}else l=!1;if(F0(e,s),e.stateNode===null)XA(n,e),S$(e,i,o),yL(e,i,o,s),o=!0;else if(n===null){var d=e.stateNode,p=e.memoizedProps;d.props=p;var f=d.context,y=i.contextType;typeof y=="object"&&y!==null?y=Tc(y):(y=bl(i)?Ig:Es.current,y=q0(e,y));var _=i.getDerivedStateFromProps,x=typeof _=="function"||typeof d.getSnapshotBeforeUpdate=="function";x||typeof d.UNSAFE_componentWillReceiveProps!="function"&&typeof d.componentWillReceiveProps!="function"||(p!==o||f!==y)&&fU(e,d,o,y),Yp=!1;var S=e.memoizedState;d.state=S,FE(e,o,d,s),f=e.memoizedState,p!==o||S!==f||_l.current||Yp?(typeof _=="function"&&(gL(e,i,_,o),f=e.memoizedState),(p=Yp||pU(e,i,p,o,S,f,y))?(x||typeof d.UNSAFE_componentWillMount!="function"&&typeof d.componentWillMount!="function"||(typeof d.componentWillMount=="function"&&d.componentWillMount(),typeof d.UNSAFE_componentWillMount=="function"&&d.UNSAFE_componentWillMount()),typeof d.componentDidMount=="function"&&(e.flags|=4194308)):(typeof d.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=o,e.memoizedState=f),d.props=o,d.state=f,d.context=y,o=p):(typeof d.componentDidMount=="function"&&(e.flags|=4194308),o=!1)}else{d=e.stateNode,x$(n,e),p=e.memoizedProps,y=e.type===e.elementType?p:iu(e.type,p),d.props=y,x=e.pendingProps,S=d.context,f=i.contextType,typeof f=="object"&&f!==null?f=Tc(f):(f=bl(i)?Ig:Es.current,f=q0(e,f));var T=i.getDerivedStateFromProps;(_=typeof T=="function"||typeof d.getSnapshotBeforeUpdate=="function")||typeof d.UNSAFE_componentWillReceiveProps!="function"&&typeof d.componentWillReceiveProps!="function"||(p!==x||S!==f)&&fU(e,d,o,f),Yp=!1,S=e.memoizedState,d.state=S,FE(e,o,d,s);var I=e.memoizedState;p!==x||S!==I||_l.current||Yp?(typeof T=="function"&&(gL(e,i,T,o),I=e.memoizedState),(y=Yp||pU(e,i,y,o,S,I,f)||!1)?(_||typeof d.UNSAFE_componentWillUpdate!="function"&&typeof d.componentWillUpdate!="function"||(typeof d.componentWillUpdate=="function"&&d.componentWillUpdate(o,I,f),typeof d.UNSAFE_componentWillUpdate=="function"&&d.UNSAFE_componentWillUpdate(o,I,f)),typeof d.componentDidUpdate=="function"&&(e.flags|=4),typeof d.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof d.componentDidUpdate!="function"||p===n.memoizedProps&&S===n.memoizedState||(e.flags|=4),typeof d.getSnapshotBeforeUpdate!="function"||p===n.memoizedProps&&S===n.memoizedState||(e.flags|=1024),e.memoizedProps=o,e.memoizedState=I),d.props=o,d.state=I,d.context=f,o=y):(typeof d.componentDidUpdate!="function"||p===n.memoizedProps&&S===n.memoizedState||(e.flags|=4),typeof d.getSnapshotBeforeUpdate!="function"||p===n.memoizedProps&&S===n.memoizedState||(e.flags|=1024),o=!1)}return bL(n,e,i,o,l,s)}function bL(n,e,i,o,s,l){Z$(n,e);var d=(e.flags&128)!==0;if(!o&&!d)return s&&lU(e,i,!1),Wh(n,e,l);o=e.stateNode,nle.current=e;var p=d&&typeof i.getDerivedStateFromError!="function"?null:o.render();return e.flags|=1,n!==null&&d?(e.child=Z0(e,n.child,null,l),e.child=Z0(e,null,p,l)):Gs(n,e,p,l),e.memoizedState=o.state,s&&lU(e,i,!0),e.child}function K$(n){var e=n.stateNode;e.pendingContext?sU(n,e.pendingContext,e.pendingContext!==e.context):e.context&&sU(n,e.context,!1),zk(n,e.containerInfo)}function AU(n,e,i,o,s){return X0(),Lk(s),e.flags|=256,Gs(n,e,i,o),e.child}var xL={dehydrated:null,treeContext:null,retryLane:0};function wL(n){return{baseLanes:n,cachePool:null,transitions:null}}function J$(n,e,i){var o=e.pendingProps,s=Ir.current,l=!1,d=(e.flags&128)!==0,p;if((p=d)||(p=n!==null&&n.memoizedState===null?!1:(s&2)!==0),p?(l=!0,e.flags&=-129):(n===null||n.memoizedState!==null)&&(s|=1),ir(Ir,s&1),n===null)return fL(e),n=e.memoizedState,n!==null&&(n=n.dehydrated,n!==null)?(e.mode&1?n.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(d=o.children,n=o.fallback,l?(o=e.mode,l=e.child,d={mode:"hidden",children:d},!(o&1)&&l!==null?(l.childLanes=0,l.pendingProps=d):l=kM(d,o,0,null),n=xg(n,o,i,null),l.return=e,n.return=e,l.sibling=n,e.child=l,e.child.memoizedState=wL(i),e.memoizedState=xL,n):jk(e,d));if(s=n.memoizedState,s!==null&&(p=s.dehydrated,p!==null))return ile(n,e,d,o,p,s,i);if(l){l=o.fallback,d=e.mode,s=n.child,p=s.sibling;var f={mode:"hidden",children:o.children};return!(d&1)&&e.child!==s?(o=e.child,o.childLanes=0,o.pendingProps=f,e.deletions=null):(o=hf(s,f),o.subtreeFlags=s.subtreeFlags&14680064),p!==null?l=hf(p,l):(l=xg(l,d,i,null),l.flags|=2),l.return=e,o.return=e,o.sibling=l,e.child=o,o=l,l=e.child,d=n.child.memoizedState,d=d===null?wL(i):{baseLanes:d.baseLanes|i,cachePool:null,transitions:d.transitions},l.memoizedState=d,l.childLanes=n.childLanes&~i,e.memoizedState=xL,o}return l=n.child,n=l.sibling,o=hf(l,{mode:"visible",children:o.children}),!(e.mode&1)&&(o.lanes=i),o.return=e,o.sibling=null,n!==null&&(i=e.deletions,i===null?(e.deletions=[n],e.flags|=16):i.push(n)),e.child=o,e.memoizedState=null,o}function jk(n,e){return e=kM({mode:"visible",children:e},n.mode,0,null),e.return=n,n.child=e}function pS(n,e,i,o){return o!==null&&Lk(o),Z0(e,n.child,null,i),n=jk(e,e.pendingProps.children),n.flags|=2,e.memoizedState=null,n}function ile(n,e,i,o,s,l,d){if(i)return e.flags&256?(e.flags&=-257,o=s4(Error(pn(422))),pS(n,e,d,o)):e.memoizedState!==null?(e.child=n.child,e.flags|=128,null):(l=o.fallback,s=e.mode,o=kM({mode:"visible",children:o.children},s,0,null),l=xg(l,s,d,null),l.flags|=2,o.return=e,l.return=e,o.sibling=l,e.child=o,e.mode&1&&Z0(e,n.child,null,d),e.child.memoizedState=wL(d),e.memoizedState=xL,l);if(!(e.mode&1))return pS(n,e,d,null);if(s.data==="$!"){if(o=s.nextSibling&&s.nextSibling.dataset,o)var p=o.dgst;return o=p,l=Error(pn(419)),o=s4(l,o,void 0),pS(n,e,d,o)}if(p=(d&n.childLanes)!==0,vl||p){if(o=Wo,o!==null){switch(d&-d){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(o.suspendedLanes|d)?0:s,s!==0&&s!==l.retryLane&&(l.retryLane=s,Uh(n,s),pu(o,n,s,-1))}return Kk(),o=s4(Error(pn(421))),pS(n,e,d,o)}return s.data==="$?"?(e.flags|=128,e.child=n.child,e=gle.bind(null,n),s._reactRetry=e,null):(n=l.treeContext,Yl=lf(s.nextSibling),ql=e,br=!0,su=null,n!==null&&(wc[Sc++]=Ch,wc[Sc++]=Ph,wc[Sc++]=Lg,Ch=n.id,Ph=n.overflow,Lg=e),e=jk(e,o.children),e.flags|=4096,e)}function EU(n,e,i){n.lanes|=e;var o=n.alternate;o!==null&&(o.lanes|=e),mL(n.return,e,i)}function l4(n,e,i,o,s){var l=n.memoizedState;l===null?n.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:o,tail:i,tailMode:s}:(l.isBackwards=e,l.rendering=null,l.renderingStartTime=0,l.last=o,l.tail=i,l.tailMode=s)}function Q$(n,e,i){var o=e.pendingProps,s=o.revealOrder,l=o.tail;if(Gs(n,e,o.children,i),o=Ir.current,o&2)o=o&1|2,e.flags|=128;else{if(n!==null&&n.flags&128)e:for(n=e.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&EU(n,i,e);else if(n.tag===19)EU(n,i,e);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break e;for(;n.sibling===null;){if(n.return===null||n.return===e)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}o&=1}if(ir(Ir,o),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(i=e.child,s=null;i!==null;)n=i.alternate,n!==null&&BE(n)===null&&(s=i),i=i.sibling;i=s,i===null?(s=e.child,e.child=null):(s=i.sibling,i.sibling=null),l4(e,!1,s,i,l);break;case"backwards":for(i=null,s=e.child,e.child=null;s!==null;){if(n=s.alternate,n!==null&&BE(n)===null){e.child=s;break}n=s.sibling,s.sibling=i,i=s,s=n}l4(e,!0,i,null,l);break;case"together":l4(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function XA(n,e){!(e.mode&1)&&n!==null&&(n.alternate=null,e.alternate=null,e.flags|=2)}function Wh(n,e,i){if(n!==null&&(e.dependencies=n.dependencies),kg|=e.lanes,!(i&e.childLanes))return null;if(n!==null&&e.child!==n.child)throw Error(pn(153));if(e.child!==null){for(n=e.child,i=hf(n,n.pendingProps),e.child=i,i.return=e;n.sibling!==null;)n=n.sibling,i=i.sibling=hf(n,n.pendingProps),i.return=e;i.sibling=null}return e.child}function ale(n,e,i){switch(e.tag){case 3:K$(e),X0();break;case 5:M$(e);break;case 1:bl(e.type)&&kE(e);break;case 4:zk(e,e.stateNode.containerInfo);break;case 10:var o=e.type._context,s=e.memoizedProps.value;ir(NE,o._currentValue),o._currentValue=s;break;case 13:if(o=e.memoizedState,o!==null)return o.dehydrated!==null?(ir(Ir,Ir.current&1),e.flags|=128,null):i&e.child.childLanes?J$(n,e,i):(ir(Ir,Ir.current&1),n=Wh(n,e,i),n!==null?n.sibling:null);ir(Ir,Ir.current&1);break;case 19:if(o=(i&e.childLanes)!==0,n.flags&128){if(o)return Q$(n,e,i);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),ir(Ir,Ir.current),o)break;return null;case 22:case 23:return e.lanes=0,X$(n,e,i)}return Wh(n,e,i)}var eY,SL,tY,nY;eY=function(n,e){for(var i=e.child;i!==null;){if(i.tag===5||i.tag===6)n.appendChild(i.stateNode);else if(i.tag!==4&&i.child!==null){i.child.return=i,i=i.child;continue}if(i===e)break;for(;i.sibling===null;){if(i.return===null||i.return===e)return;i=i.return}i.sibling.return=i.return,i=i.sibling}};SL=function(){};tY=function(n,e,i,o){var s=n.memoizedProps;if(s!==o){n=e.stateNode,ug(pd.current);var l=null;switch(i){case"input":s=jI(n,s),o=jI(n,o),l=[];break;case"select":s=Nr({},s,{value:void 0}),o=Nr({},o,{value:void 0}),l=[];break;case"textarea":s=qI(n,s),o=qI(n,o),l=[];break;default:typeof s.onClick!="function"&&typeof o.onClick=="function"&&(n.onclick=LE)}ZI(i,o);var d;i=null;for(y in s)if(!o.hasOwnProperty(y)&&s.hasOwnProperty(y)&&s[y]!=null)if(y==="style"){var p=s[y];for(d in p)p.hasOwnProperty(d)&&(i||(i={}),i[d]="")}else y!=="dangerouslySetInnerHTML"&&y!=="children"&&y!=="suppressContentEditableWarning"&&y!=="suppressHydrationWarning"&&y!=="autoFocus"&&(Px.hasOwnProperty(y)?l||(l=[]):(l=l||[]).push(y,null));for(y in o){var f=o[y];if(p=s!=null?s[y]:void 0,o.hasOwnProperty(y)&&f!==p&&(f!=null||p!=null))if(y==="style")if(p){for(d in p)!p.hasOwnProperty(d)||f&&f.hasOwnProperty(d)||(i||(i={}),i[d]="");for(d in f)f.hasOwnProperty(d)&&p[d]!==f[d]&&(i||(i={}),i[d]=f[d])}else i||(l||(l=[]),l.push(y,i)),i=f;else y==="dangerouslySetInnerHTML"?(f=f?f.__html:void 0,p=p?p.__html:void 0,f!=null&&p!==f&&(l=l||[]).push(y,f)):y==="children"?typeof f!="string"&&typeof f!="number"||(l=l||[]).push(y,""+f):y!=="suppressContentEditableWarning"&&y!=="suppressHydrationWarning"&&(Px.hasOwnProperty(y)?(f!=null&&y==="onScroll"&&sr("scroll",n),l||p===f||(l=[])):(l=l||[]).push(y,f))}i&&(l=l||[]).push("style",i);var y=l;(e.updateQueue=y)&&(e.flags|=4)}};nY=function(n,e,i,o){i!==o&&(e.flags|=4)};function J1(n,e){if(!br)switch(n.tailMode){case"hidden":e=n.tail;for(var i=null;e!==null;)e.alternate!==null&&(i=e),e=e.sibling;i===null?n.tail=null:i.sibling=null;break;case"collapsed":i=n.tail;for(var o=null;i!==null;)i.alternate!==null&&(o=i),i=i.sibling;o===null?e||n.tail===null?n.tail=null:n.tail.sibling=null:o.sibling=null}}function hs(n){var e=n.alternate!==null&&n.alternate.child===n.child,i=0,o=0;if(e)for(var s=n.child;s!==null;)i|=s.lanes|s.childLanes,o|=s.subtreeFlags&14680064,o|=s.flags&14680064,s.return=n,s=s.sibling;else for(s=n.child;s!==null;)i|=s.lanes|s.childLanes,o|=s.subtreeFlags,o|=s.flags,s.return=n,s=s.sibling;return n.subtreeFlags|=o,n.childLanes=i,e}function rle(n,e,i){var o=e.pendingProps;switch(Ik(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return hs(e),null;case 1:return bl(e.type)&&RE(),hs(e),null;case 3:return o=e.stateNode,K0(),ur(_l),ur(Es),Bk(),o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),(n===null||n.child===null)&&(dS(e)?e.flags|=4:n===null||n.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,su!==null&&(LL(su),su=null))),SL(n,e),hs(e),null;case 5:Fk(e);var s=ug(Wx.current);if(i=e.type,n!==null&&e.stateNode!=null)tY(n,e,i,o,s),n.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!o){if(e.stateNode===null)throw Error(pn(166));return hs(e),null}if(n=ug(pd.current),dS(e)){o=e.stateNode,i=e.type;var l=e.memoizedProps;switch(o[ld]=e,o[Bx]=l,n=(e.mode&1)!==0,i){case"dialog":sr("cancel",o),sr("close",o);break;case"iframe":case"object":case"embed":sr("load",o);break;case"video":case"audio":for(s=0;s<zb.length;s++)sr(zb[s],o);break;case"source":sr("error",o);break;case"img":case"image":case"link":sr("error",o),sr("load",o);break;case"details":sr("toggle",o);break;case"input":D9(o,l),sr("invalid",o);break;case"select":o._wrapperState={wasMultiple:!!l.multiple},sr("invalid",o);break;case"textarea":N9(o,l),sr("invalid",o)}ZI(i,l),s=null;for(var d in l)if(l.hasOwnProperty(d)){var p=l[d];d==="children"?typeof p=="string"?o.textContent!==p&&(l.suppressHydrationWarning!==!0&&uS(o.textContent,p,n),s=["children",p]):typeof p=="number"&&o.textContent!==""+p&&(l.suppressHydrationWarning!==!0&&uS(o.textContent,p,n),s=["children",""+p]):Px.hasOwnProperty(d)&&p!=null&&d==="onScroll"&&sr("scroll",o)}switch(i){case"input":nS(o),O9(o,l,!0);break;case"textarea":nS(o),z9(o);break;case"select":case"option":break;default:typeof l.onClick=="function"&&(o.onclick=LE)}o=s,e.updateQueue=o,o!==null&&(e.flags|=4)}else{d=s.nodeType===9?s:s.ownerDocument,n==="http://www.w3.org/1999/xhtml"&&(n=Pj(i)),n==="http://www.w3.org/1999/xhtml"?i==="script"?(n=d.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild)):typeof o.is=="string"?n=d.createElement(i,{is:o.is}):(n=d.createElement(i),i==="select"&&(d=n,o.multiple?d.multiple=!0:o.size&&(d.size=o.size))):n=d.createElementNS(n,i),n[ld]=e,n[Bx]=o,eY(n,e,!1,!1),e.stateNode=n;e:{switch(d=KI(i,o),i){case"dialog":sr("cancel",n),sr("close",n),s=o;break;case"iframe":case"object":case"embed":sr("load",n),s=o;break;case"video":case"audio":for(s=0;s<zb.length;s++)sr(zb[s],n);s=o;break;case"source":sr("error",n),s=o;break;case"img":case"image":case"link":sr("error",n),sr("load",n),s=o;break;case"details":sr("toggle",n),s=o;break;case"input":D9(n,o),s=jI(n,o),sr("invalid",n);break;case"option":s=o;break;case"select":n._wrapperState={wasMultiple:!!o.multiple},s=Nr({},o,{value:void 0}),sr("invalid",n);break;case"textarea":N9(n,o),s=qI(n,o),sr("invalid",n);break;default:s=o}ZI(i,s),p=s;for(l in p)if(p.hasOwnProperty(l)){var f=p[l];l==="style"?Rj(n,f):l==="dangerouslySetInnerHTML"?(f=f?f.__html:void 0,f!=null&&Ij(n,f)):l==="children"?typeof f=="string"?(i!=="textarea"||f!=="")&&Ix(n,f):typeof f=="number"&&Ix(n,""+f):l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&l!=="autoFocus"&&(Px.hasOwnProperty(l)?f!=null&&l==="onScroll"&&sr("scroll",n):f!=null&&mk(n,l,f,d))}switch(i){case"input":nS(n),O9(n,o,!1);break;case"textarea":nS(n),z9(n);break;case"option":o.value!=null&&n.setAttribute("value",""+vf(o.value));break;case"select":n.multiple=!!o.multiple,l=o.value,l!=null?D0(n,!!o.multiple,l,!1):o.defaultValue!=null&&D0(n,!!o.multiple,o.defaultValue,!0);break;default:typeof s.onClick=="function"&&(n.onclick=LE)}switch(i){case"button":case"input":case"select":case"textarea":o=!!o.autoFocus;break e;case"img":o=!0;break e;default:o=!1}}o&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return hs(e),null;case 6:if(n&&e.stateNode!=null)nY(n,e,n.memoizedProps,o);else{if(typeof o!="string"&&e.stateNode===null)throw Error(pn(166));if(i=ug(Wx.current),ug(pd.current),dS(e)){if(o=e.stateNode,i=e.memoizedProps,o[ld]=e,(l=o.nodeValue!==i)&&(n=ql,n!==null))switch(n.tag){case 3:uS(o.nodeValue,i,(n.mode&1)!==0);break;case 5:n.memoizedProps.suppressHydrationWarning!==!0&&uS(o.nodeValue,i,(n.mode&1)!==0)}l&&(e.flags|=4)}else o=(i.nodeType===9?i:i.ownerDocument).createTextNode(o),o[ld]=e,e.stateNode=o}return hs(e),null;case 13:if(ur(Ir),o=e.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(br&&Yl!==null&&e.mode&1&&!(e.flags&128))_$(),X0(),e.flags|=98560,l=!1;else if(l=dS(e),o!==null&&o.dehydrated!==null){if(n===null){if(!l)throw Error(pn(318));if(l=e.memoizedState,l=l!==null?l.dehydrated:null,!l)throw Error(pn(317));l[ld]=e}else X0(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;hs(e),l=!1}else su!==null&&(LL(su),su=null),l=!0;if(!l)return e.flags&65536?e:null}return e.flags&128?(e.lanes=i,e):(o=o!==null,o!==(n!==null&&n.memoizedState!==null)&&o&&(e.child.flags|=8192,e.mode&1&&(n===null||Ir.current&1?Lo===0&&(Lo=3):Kk())),e.updateQueue!==null&&(e.flags|=4),hs(e),null);case 4:return K0(),SL(n,e),n===null&&zx(e.stateNode.containerInfo),hs(e),null;case 10:return Dk(e.type._context),hs(e),null;case 17:return bl(e.type)&&RE(),hs(e),null;case 19:if(ur(Ir),l=e.memoizedState,l===null)return hs(e),null;if(o=(e.flags&128)!==0,d=l.rendering,d===null)if(o)J1(l,!1);else{if(Lo!==0||n!==null&&n.flags&128)for(n=e.child;n!==null;){if(d=BE(n),d!==null){for(e.flags|=128,J1(l,!1),o=d.updateQueue,o!==null&&(e.updateQueue=o,e.flags|=4),e.subtreeFlags=0,o=i,i=e.child;i!==null;)l=i,n=o,l.flags&=14680066,d=l.alternate,d===null?(l.childLanes=0,l.lanes=n,l.child=null,l.subtreeFlags=0,l.memoizedProps=null,l.memoizedState=null,l.updateQueue=null,l.dependencies=null,l.stateNode=null):(l.childLanes=d.childLanes,l.lanes=d.lanes,l.child=d.child,l.subtreeFlags=0,l.deletions=null,l.memoizedProps=d.memoizedProps,l.memoizedState=d.memoizedState,l.updateQueue=d.updateQueue,l.type=d.type,n=d.dependencies,l.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),i=i.sibling;return ir(Ir,Ir.current&1|2),e.child}n=n.sibling}l.tail!==null&&lo()>Q0&&(e.flags|=128,o=!0,J1(l,!1),e.lanes=4194304)}else{if(!o)if(n=BE(d),n!==null){if(e.flags|=128,o=!0,i=n.updateQueue,i!==null&&(e.updateQueue=i,e.flags|=4),J1(l,!0),l.tail===null&&l.tailMode==="hidden"&&!d.alternate&&!br)return hs(e),null}else 2*lo()-l.renderingStartTime>Q0&&i!==1073741824&&(e.flags|=128,o=!0,J1(l,!1),e.lanes=4194304);l.isBackwards?(d.sibling=e.child,e.child=d):(i=l.last,i!==null?i.sibling=d:e.child=d,l.last=d)}return l.tail!==null?(e=l.tail,l.rendering=e,l.tail=e.sibling,l.renderingStartTime=lo(),e.sibling=null,i=Ir.current,ir(Ir,o?i&1|2:i&1),e):(hs(e),null);case 22:case 23:return Zk(),o=e.memoizedState!==null,n!==null&&n.memoizedState!==null!==o&&(e.flags|=8192),o&&e.mode&1?Vl&1073741824&&(hs(e),e.subtreeFlags&6&&(e.flags|=8192)):hs(e),null;case 24:return null;case 25:return null}throw Error(pn(156,e.tag))}function ole(n,e){switch(Ik(e),e.tag){case 1:return bl(e.type)&&RE(),n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 3:return K0(),ur(_l),ur(Es),Bk(),n=e.flags,n&65536&&!(n&128)?(e.flags=n&-65537|128,e):null;case 5:return Fk(e),null;case 13:if(ur(Ir),n=e.memoizedState,n!==null&&n.dehydrated!==null){if(e.alternate===null)throw Error(pn(340));X0()}return n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 19:return ur(Ir),null;case 4:return K0(),null;case 10:return Dk(e.type._context),null;case 22:case 23:return Zk(),null;case 24:return null;default:return null}}var fS=!1,vs=!1,sle=typeof WeakSet=="function"?WeakSet:Set,zn=null;function E0(n,e){var i=n.ref;if(i!==null)if(typeof i=="function")try{i(null)}catch(o){jr(n,e,o)}else i.current=null}function AL(n,e,i){try{i()}catch(o){jr(n,e,o)}}var MU=!1;function lle(n,e){if(sL=CE,n=o$(),Ck(n)){if("selectionStart"in n)var i={start:n.selectionStart,end:n.selectionEnd};else e:{i=(i=n.ownerDocument)&&i.defaultView||window;var o=i.getSelection&&i.getSelection();if(o&&o.rangeCount!==0){i=o.anchorNode;var s=o.anchorOffset,l=o.focusNode;o=o.focusOffset;try{i.nodeType,l.nodeType}catch{i=null;break e}var d=0,p=-1,f=-1,y=0,_=0,x=n,S=null;t:for(;;){for(var T;x!==i||s!==0&&x.nodeType!==3||(p=d+s),x!==l||o!==0&&x.nodeType!==3||(f=d+o),x.nodeType===3&&(d+=x.nodeValue.length),(T=x.firstChild)!==null;)S=x,x=T;for(;;){if(x===n)break t;if(S===i&&++y===s&&(p=d),S===l&&++_===o&&(f=d),(T=x.nextSibling)!==null)break;x=S,S=x.parentNode}x=T}i=p===-1||f===-1?null:{start:p,end:f}}else i=null}i=i||{start:0,end:0}}else i=null;for(lL={focusedElem:n,selectionRange:i},CE=!1,zn=e;zn!==null;)if(e=zn,n=e.child,(e.subtreeFlags&1028)!==0&&n!==null)n.return=e,zn=n;else for(;zn!==null;){e=zn;try{var I=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(I!==null){var R=I.memoizedProps,D=I.memoizedState,L=e.stateNode,O=L.getSnapshotBeforeUpdate(e.elementType===e.type?R:iu(e.type,R),D);L.__reactInternalSnapshotBeforeUpdate=O}break;case 3:var N=e.stateNode.containerInfo;N.nodeType===1?N.textContent="":N.nodeType===9&&N.documentElement&&N.removeChild(N.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(pn(163))}}catch(F){jr(e,e.return,F)}if(n=e.sibling,n!==null){n.return=e.return,zn=n;break}zn=e.return}return I=MU,MU=!1,I}function tx(n,e,i){var o=e.updateQueue;if(o=o!==null?o.lastEffect:null,o!==null){var s=o=o.next;do{if((s.tag&n)===n){var l=s.destroy;s.destroy=void 0,l!==void 0&&AL(e,i,l)}s=s.next}while(s!==o)}}function LM(n,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var i=e=e.next;do{if((i.tag&n)===n){var o=i.create;i.destroy=o()}i=i.next}while(i!==e)}}function EL(n){var e=n.ref;if(e!==null){var i=n.stateNode;switch(n.tag){case 5:n=i;break;default:n=i}typeof e=="function"?e(n):e.current=n}}function iY(n){var e=n.alternate;e!==null&&(n.alternate=null,iY(e)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(e=n.stateNode,e!==null&&(delete e[ld],delete e[Bx],delete e[dL],delete e[Hse],delete e[jse])),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}function aY(n){return n.tag===5||n.tag===3||n.tag===4}function TU(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||aY(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function ML(n,e,i){var o=n.tag;if(o===5||o===6)n=n.stateNode,e?i.nodeType===8?i.parentNode.insertBefore(n,e):i.insertBefore(n,e):(i.nodeType===8?(e=i.parentNode,e.insertBefore(n,i)):(e=i,e.appendChild(n)),i=i._reactRootContainer,i!=null||e.onclick!==null||(e.onclick=LE));else if(o!==4&&(n=n.child,n!==null))for(ML(n,e,i),n=n.sibling;n!==null;)ML(n,e,i),n=n.sibling}function TL(n,e,i){var o=n.tag;if(o===5||o===6)n=n.stateNode,e?i.insertBefore(n,e):i.appendChild(n);else if(o!==4&&(n=n.child,n!==null))for(TL(n,e,i),n=n.sibling;n!==null;)TL(n,e,i),n=n.sibling}var Zo=null,ru=!1;function Np(n,e,i){for(i=i.child;i!==null;)rY(n,e,i),i=i.sibling}function rY(n,e,i){if(hd&&typeof hd.onCommitFiberUnmount=="function")try{hd.onCommitFiberUnmount(SM,i)}catch{}switch(i.tag){case 5:vs||E0(i,e);case 6:var o=Zo,s=ru;Zo=null,Np(n,e,i),Zo=o,ru=s,Zo!==null&&(ru?(n=Zo,i=i.stateNode,n.nodeType===8?n.parentNode.removeChild(i):n.removeChild(i)):Zo.removeChild(i.stateNode));break;case 18:Zo!==null&&(ru?(n=Zo,i=i.stateNode,n.nodeType===8?t4(n.parentNode,i):n.nodeType===1&&t4(n,i),Dx(n)):t4(Zo,i.stateNode));break;case 4:o=Zo,s=ru,Zo=i.stateNode.containerInfo,ru=!0,Np(n,e,i),Zo=o,ru=s;break;case 0:case 11:case 14:case 15:if(!vs&&(o=i.updateQueue,o!==null&&(o=o.lastEffect,o!==null))){s=o=o.next;do{var l=s,d=l.destroy;l=l.tag,d!==void 0&&(l&2||l&4)&&AL(i,e,d),s=s.next}while(s!==o)}Np(n,e,i);break;case 1:if(!vs&&(E0(i,e),o=i.stateNode,typeof o.componentWillUnmount=="function"))try{o.props=i.memoizedProps,o.state=i.memoizedState,o.componentWillUnmount()}catch(p){jr(i,e,p)}Np(n,e,i);break;case 21:Np(n,e,i);break;case 22:i.mode&1?(vs=(o=vs)||i.memoizedState!==null,Np(n,e,i),vs=o):Np(n,e,i);break;default:Np(n,e,i)}}function CU(n){var e=n.updateQueue;if(e!==null){n.updateQueue=null;var i=n.stateNode;i===null&&(i=n.stateNode=new sle),e.forEach(function(o){var s=yle.bind(null,n,o);i.has(o)||(i.add(o),o.then(s,s))})}}function Qc(n,e){var i=e.deletions;if(i!==null)for(var o=0;o<i.length;o++){var s=i[o];try{var l=n,d=e,p=d;e:for(;p!==null;){switch(p.tag){case 5:Zo=p.stateNode,ru=!1;break e;case 3:Zo=p.stateNode.containerInfo,ru=!0;break e;case 4:Zo=p.stateNode.containerInfo,ru=!0;break e}p=p.return}if(Zo===null)throw Error(pn(160));rY(l,d,s),Zo=null,ru=!1;var f=s.alternate;f!==null&&(f.return=null),s.return=null}catch(y){jr(s,e,y)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)oY(e,n),e=e.sibling}function oY(n,e){var i=n.alternate,o=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:if(Qc(e,n),nd(n),o&4){try{tx(3,n,n.return),LM(3,n)}catch(R){jr(n,n.return,R)}try{tx(5,n,n.return)}catch(R){jr(n,n.return,R)}}break;case 1:Qc(e,n),nd(n),o&512&&i!==null&&E0(i,i.return);break;case 5:if(Qc(e,n),nd(n),o&512&&i!==null&&E0(i,i.return),n.flags&32){var s=n.stateNode;try{Ix(s,"")}catch(R){jr(n,n.return,R)}}if(o&4&&(s=n.stateNode,s!=null)){var l=n.memoizedProps,d=i!==null?i.memoizedProps:l,p=n.type,f=n.updateQueue;if(n.updateQueue=null,f!==null)try{p==="input"&&l.type==="radio"&&l.name!=null&&Tj(s,l),KI(p,d);var y=KI(p,l);for(d=0;d<f.length;d+=2){var _=f[d],x=f[d+1];_==="style"?Rj(s,x):_==="dangerouslySetInnerHTML"?Ij(s,x):_==="children"?Ix(s,x):mk(s,_,x,y)}switch(p){case"input":$I(s,l);break;case"textarea":Cj(s,l);break;case"select":var S=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!l.multiple;var T=l.value;T!=null?D0(s,!!l.multiple,T,!1):S!==!!l.multiple&&(l.defaultValue!=null?D0(s,!!l.multiple,l.defaultValue,!0):D0(s,!!l.multiple,l.multiple?[]:"",!1))}s[Bx]=l}catch(R){jr(n,n.return,R)}}break;case 6:if(Qc(e,n),nd(n),o&4){if(n.stateNode===null)throw Error(pn(162));s=n.stateNode,l=n.memoizedProps;try{s.nodeValue=l}catch(R){jr(n,n.return,R)}}break;case 3:if(Qc(e,n),nd(n),o&4&&i!==null&&i.memoizedState.isDehydrated)try{Dx(e.containerInfo)}catch(R){jr(n,n.return,R)}break;case 4:Qc(e,n),nd(n);break;case 13:Qc(e,n),nd(n),s=n.child,s.flags&8192&&(l=s.memoizedState!==null,s.stateNode.isHidden=l,!l||s.alternate!==null&&s.alternate.memoizedState!==null||(qk=lo())),o&4&&CU(n);break;case 22:if(_=i!==null&&i.memoizedState!==null,n.mode&1?(vs=(y=vs)||_,Qc(e,n),vs=y):Qc(e,n),nd(n),o&8192){if(y=n.memoizedState!==null,(n.stateNode.isHidden=y)&&!_&&n.mode&1)for(zn=n,_=n.child;_!==null;){for(x=zn=_;zn!==null;){switch(S=zn,T=S.child,S.tag){case 0:case 11:case 14:case 15:tx(4,S,S.return);break;case 1:E0(S,S.return);var I=S.stateNode;if(typeof I.componentWillUnmount=="function"){o=S,i=S.return;try{e=o,I.props=e.memoizedProps,I.state=e.memoizedState,I.componentWillUnmount()}catch(R){jr(o,i,R)}}break;case 5:E0(S,S.return);break;case 22:if(S.memoizedState!==null){IU(x);continue}}T!==null?(T.return=S,zn=T):IU(x)}_=_.sibling}e:for(_=null,x=n;;){if(x.tag===5){if(_===null){_=x;try{s=x.stateNode,y?(l=s.style,typeof l.setProperty=="function"?l.setProperty("display","none","important"):l.display="none"):(p=x.stateNode,f=x.memoizedProps.style,d=f!=null&&f.hasOwnProperty("display")?f.display:null,p.style.display=Lj("display",d))}catch(R){jr(n,n.return,R)}}}else if(x.tag===6){if(_===null)try{x.stateNode.nodeValue=y?"":x.memoizedProps}catch(R){jr(n,n.return,R)}}else if((x.tag!==22&&x.tag!==23||x.memoizedState===null||x===n)&&x.child!==null){x.child.return=x,x=x.child;continue}if(x===n)break e;for(;x.sibling===null;){if(x.return===null||x.return===n)break e;_===x&&(_=null),x=x.return}_===x&&(_=null),x.sibling.return=x.return,x=x.sibling}}break;case 19:Qc(e,n),nd(n),o&4&&CU(n);break;case 21:break;default:Qc(e,n),nd(n)}}function nd(n){var e=n.flags;if(e&2){try{e:{for(var i=n.return;i!==null;){if(aY(i)){var o=i;break e}i=i.return}throw Error(pn(160))}switch(o.tag){case 5:var s=o.stateNode;o.flags&32&&(Ix(s,""),o.flags&=-33);var l=TU(n);TL(n,l,s);break;case 3:case 4:var d=o.stateNode.containerInfo,p=TU(n);ML(n,p,d);break;default:throw Error(pn(161))}}catch(f){jr(n,n.return,f)}n.flags&=-3}e&4096&&(n.flags&=-4097)}function cle(n,e,i){zn=n,sY(n)}function sY(n,e,i){for(var o=(n.mode&1)!==0;zn!==null;){var s=zn,l=s.child;if(s.tag===22&&o){var d=s.memoizedState!==null||fS;if(!d){var p=s.alternate,f=p!==null&&p.memoizedState!==null||vs;p=fS;var y=vs;if(fS=d,(vs=f)&&!y)for(zn=s;zn!==null;)d=zn,f=d.child,d.tag===22&&d.memoizedState!==null?LU(s):f!==null?(f.return=d,zn=f):LU(s);for(;l!==null;)zn=l,sY(l),l=l.sibling;zn=s,fS=p,vs=y}PU(n)}else s.subtreeFlags&8772&&l!==null?(l.return=s,zn=l):PU(n)}}function PU(n){for(;zn!==null;){var e=zn;if(e.flags&8772){var i=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:vs||LM(5,e);break;case 1:var o=e.stateNode;if(e.flags&4&&!vs)if(i===null)o.componentDidMount();else{var s=e.elementType===e.type?i.memoizedProps:iu(e.type,i.memoizedProps);o.componentDidUpdate(s,i.memoizedState,o.__reactInternalSnapshotBeforeUpdate)}var l=e.updateQueue;l!==null&&hU(e,l,o);break;case 3:var d=e.updateQueue;if(d!==null){if(i=null,e.child!==null)switch(e.child.tag){case 5:i=e.child.stateNode;break;case 1:i=e.child.stateNode}hU(e,d,i)}break;case 5:var p=e.stateNode;if(i===null&&e.flags&4){i=p;var f=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":f.autoFocus&&i.focus();break;case"img":f.src&&(i.src=f.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var y=e.alternate;if(y!==null){var _=y.memoizedState;if(_!==null){var x=_.dehydrated;x!==null&&Dx(x)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(pn(163))}vs||e.flags&512&&EL(e)}catch(S){jr(e,e.return,S)}}if(e===n){zn=null;break}if(i=e.sibling,i!==null){i.return=e.return,zn=i;break}zn=e.return}}function IU(n){for(;zn!==null;){var e=zn;if(e===n){zn=null;break}var i=e.sibling;if(i!==null){i.return=e.return,zn=i;break}zn=e.return}}function LU(n){for(;zn!==null;){var e=zn;try{switch(e.tag){case 0:case 11:case 15:var i=e.return;try{LM(4,e)}catch(f){jr(e,i,f)}break;case 1:var o=e.stateNode;if(typeof o.componentDidMount=="function"){var s=e.return;try{o.componentDidMount()}catch(f){jr(e,s,f)}}var l=e.return;try{EL(e)}catch(f){jr(e,l,f)}break;case 5:var d=e.return;try{EL(e)}catch(f){jr(e,d,f)}}}catch(f){jr(e,e.return,f)}if(e===n){zn=null;break}var p=e.sibling;if(p!==null){p.return=e.return,zn=p;break}zn=e.return}}var ule=Math.ceil,VE=$h.ReactCurrentDispatcher,$k=$h.ReactCurrentOwner,Ec=$h.ReactCurrentBatchConfig,ua=0,Wo=null,xo=null,Jo=0,Vl=0,M0=Cf(0),Lo=0,jx=null,kg=0,RM=0,Yk=0,nx=null,pl=null,qk=0,Q0=1/0,wh=null,GE=!1,CL=null,uf=null,mS=!1,Jp=null,HE=0,ix=0,PL=null,ZA=-1,KA=0;function js(){return ua&6?lo():ZA!==-1?ZA:ZA=lo()}function df(n){return n.mode&1?ua&2&&Jo!==0?Jo&-Jo:Yse.transition!==null?(KA===0&&(KA=Hj()),KA):(n=Wa,n!==0||(n=window.event,n=n===void 0?16:Kj(n.type)),n):1}function pu(n,e,i,o){if(50<ix)throw ix=0,PL=null,Error(pn(185));Rw(n,i,o),(!(ua&2)||n!==Wo)&&(n===Wo&&(!(ua&2)&&(RM|=i),Lo===4&&Xp(n,Jo)),xl(n,o),i===1&&ua===0&&!(e.mode&1)&&(Q0=lo()+500,CM&&Pf()))}function xl(n,e){var i=n.callbackNode;Yoe(n,e);var o=TE(n,n===Wo?Jo:0);if(o===0)i!==null&&U9(i),n.callbackNode=null,n.callbackPriority=0;else if(e=o&-o,n.callbackPriority!==e){if(i!=null&&U9(i),e===1)n.tag===0?$se(RU.bind(null,n)):g$(RU.bind(null,n)),Vse(function(){!(ua&6)&&Pf()}),i=null;else{switch(jj(o)){case 1:i=bk;break;case 4:i=Vj;break;case 16:i=ME;break;case 536870912:i=Gj;break;default:i=ME}i=mY(i,lY.bind(null,n))}n.callbackPriority=e,n.callbackNode=i}}function lY(n,e){if(ZA=-1,KA=0,ua&6)throw Error(pn(327));var i=n.callbackNode;if(B0()&&n.callbackNode!==i)return null;var o=TE(n,n===Wo?Jo:0);if(o===0)return null;if(o&30||o&n.expiredLanes||e)e=jE(n,o);else{e=o;var s=ua;ua|=2;var l=uY();(Wo!==n||Jo!==e)&&(wh=null,Q0=lo()+500,bg(n,e));do try{ple();break}catch(p){cY(n,p)}while(1);kk(),VE.current=l,ua=s,xo!==null?e=0:(Wo=null,Jo=0,e=Lo)}if(e!==0){if(e===2&&(s=nL(n),s!==0&&(o=s,e=IL(n,s))),e===1)throw i=jx,bg(n,0),Xp(n,o),xl(n,lo()),i;if(e===6)Xp(n,o);else{if(s=n.current.alternate,!(o&30)&&!dle(s)&&(e=jE(n,o),e===2&&(l=nL(n),l!==0&&(o=l,e=IL(n,l))),e===1))throw i=jx,bg(n,0),Xp(n,o),xl(n,lo()),i;switch(n.finishedWork=s,n.finishedLanes=o,e){case 0:case 1:throw Error(pn(345));case 2:Jm(n,pl,wh);break;case 3:if(Xp(n,o),(o&130023424)===o&&(e=qk+500-lo(),10<e)){if(TE(n,0)!==0)break;if(s=n.suspendedLanes,(s&o)!==o){js(),n.pingedLanes|=n.suspendedLanes&s;break}n.timeoutHandle=uL(Jm.bind(null,n,pl,wh),e);break}Jm(n,pl,wh);break;case 4:if(Xp(n,o),(o&4194240)===o)break;for(e=n.eventTimes,s=-1;0<o;){var d=31-hu(o);l=1<<d,d=e[d],d>s&&(s=d),o&=~l}if(o=s,o=lo()-o,o=(120>o?120:480>o?480:1080>o?1080:1920>o?1920:3e3>o?3e3:4320>o?4320:1960*ule(o/1960))-o,10<o){n.timeoutHandle=uL(Jm.bind(null,n,pl,wh),o);break}Jm(n,pl,wh);break;case 5:Jm(n,pl,wh);break;default:throw Error(pn(329))}}}return xl(n,lo()),n.callbackNode===i?lY.bind(null,n):null}function IL(n,e){var i=nx;return n.current.memoizedState.isDehydrated&&(bg(n,e).flags|=256),n=jE(n,e),n!==2&&(e=pl,pl=i,e!==null&&LL(e)),n}function LL(n){pl===null?pl=n:pl.push.apply(pl,n)}function dle(n){for(var e=n;;){if(e.flags&16384){var i=e.updateQueue;if(i!==null&&(i=i.stores,i!==null))for(var o=0;o<i.length;o++){var s=i[o],l=s.getSnapshot;s=s.value;try{if(!mu(l(),s))return!1}catch{return!1}}}if(i=e.child,e.subtreeFlags&16384&&i!==null)i.return=e,e=i;else{if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Xp(n,e){for(e&=~Yk,e&=~RM,n.suspendedLanes|=e,n.pingedLanes&=~e,n=n.expirationTimes;0<e;){var i=31-hu(e),o=1<<i;n[i]=-1,e&=~o}}function RU(n){if(ua&6)throw Error(pn(327));B0();var e=TE(n,0);if(!(e&1))return xl(n,lo()),null;var i=jE(n,e);if(n.tag!==0&&i===2){var o=nL(n);o!==0&&(e=o,i=IL(n,o))}if(i===1)throw i=jx,bg(n,0),Xp(n,e),xl(n,lo()),i;if(i===6)throw Error(pn(345));return n.finishedWork=n.current.alternate,n.finishedLanes=e,Jm(n,pl,wh),xl(n,lo()),null}function Xk(n,e){var i=ua;ua|=1;try{return n(e)}finally{ua=i,ua===0&&(Q0=lo()+500,CM&&Pf())}}function Dg(n){Jp!==null&&Jp.tag===0&&!(ua&6)&&B0();var e=ua;ua|=1;var i=Ec.transition,o=Wa;try{if(Ec.transition=null,Wa=1,n)return n()}finally{Wa=o,Ec.transition=i,ua=e,!(ua&6)&&Pf()}}function Zk(){Vl=M0.current,ur(M0)}function bg(n,e){n.finishedWork=null,n.finishedLanes=0;var i=n.timeoutHandle;if(i!==-1&&(n.timeoutHandle=-1,Wse(i)),xo!==null)for(i=xo.return;i!==null;){var o=i;switch(Ik(o),o.tag){case 1:o=o.type.childContextTypes,o!=null&&RE();break;case 3:K0(),ur(_l),ur(Es),Bk();break;case 5:Fk(o);break;case 4:K0();break;case 13:ur(Ir);break;case 19:ur(Ir);break;case 10:Dk(o.type._context);break;case 22:case 23:Zk()}i=i.return}if(Wo=n,xo=n=hf(n.current,null),Jo=Vl=e,Lo=0,jx=null,Yk=RM=kg=0,pl=nx=null,cg!==null){for(e=0;e<cg.length;e++)if(i=cg[e],o=i.interleaved,o!==null){i.interleaved=null;var s=o.next,l=i.pending;if(l!==null){var d=l.next;l.next=s,o.next=d}i.pending=o}cg=null}return n}function cY(n,e){do{var i=xo;try{if(kk(),YA.current=WE,UE){for(var o=Dr.memoizedState;o!==null;){var s=o.queue;s!==null&&(s.pending=null),o=o.next}UE=!1}if(Rg=0,Bo=Po=Dr=null,ex=!1,Vx=0,$k.current=null,i===null||i.return===null){Lo=1,jx=e,xo=null;break}e:{var l=n,d=i.return,p=i,f=e;if(e=Jo,p.flags|=32768,f!==null&&typeof f=="object"&&typeof f.then=="function"){var y=f,_=p,x=_.tag;if(!(_.mode&1)&&(x===0||x===11||x===15)){var S=_.alternate;S?(_.updateQueue=S.updateQueue,_.memoizedState=S.memoizedState,_.lanes=S.lanes):(_.updateQueue=null,_.memoizedState=null)}var T=_U(d);if(T!==null){T.flags&=-257,bU(T,d,p,l,e),T.mode&1&&vU(l,y,e),e=T,f=y;var I=e.updateQueue;if(I===null){var R=new Set;R.add(f),e.updateQueue=R}else I.add(f);break e}else{if(!(e&1)){vU(l,y,e),Kk();break e}f=Error(pn(426))}}else if(br&&p.mode&1){var D=_U(d);if(D!==null){!(D.flags&65536)&&(D.flags|=256),bU(D,d,p,l,e),Lk(J0(f,p));break e}}l=f=J0(f,p),Lo!==4&&(Lo=2),nx===null?nx=[l]:nx.push(l),l=d;do{switch(l.tag){case 3:l.flags|=65536,e&=-e,l.lanes|=e;var L=$$(l,f,e);dU(l,L);break e;case 1:p=f;var O=l.type,N=l.stateNode;if(!(l.flags&128)&&(typeof O.getDerivedStateFromError=="function"||N!==null&&typeof N.componentDidCatch=="function"&&(uf===null||!uf.has(N)))){l.flags|=65536,e&=-e,l.lanes|=e;var F=Y$(l,p,e);dU(l,F);break e}}l=l.return}while(l!==null)}hY(i)}catch(G){e=G,xo===i&&i!==null&&(xo=i=i.return);continue}break}while(1)}function uY(){var n=VE.current;return VE.current=WE,n===null?WE:n}function Kk(){(Lo===0||Lo===3||Lo===2)&&(Lo=4),Wo===null||!(kg&268435455)&&!(RM&268435455)||Xp(Wo,Jo)}function jE(n,e){var i=ua;ua|=2;var o=uY();(Wo!==n||Jo!==e)&&(wh=null,bg(n,e));do try{hle();break}catch(s){cY(n,s)}while(1);if(kk(),ua=i,VE.current=o,xo!==null)throw Error(pn(261));return Wo=null,Jo=0,Lo}function hle(){for(;xo!==null;)dY(xo)}function ple(){for(;xo!==null&&!Foe();)dY(xo)}function dY(n){var e=fY(n.alternate,n,Vl);n.memoizedProps=n.pendingProps,e===null?hY(n):xo=e,$k.current=null}function hY(n){var e=n;do{var i=e.alternate;if(n=e.return,e.flags&32768){if(i=ole(i,e),i!==null){i.flags&=32767,xo=i;return}if(n!==null)n.flags|=32768,n.subtreeFlags=0,n.deletions=null;else{Lo=6,xo=null;return}}else if(i=rle(i,e,Vl),i!==null){xo=i;return}if(e=e.sibling,e!==null){xo=e;return}xo=e=n}while(e!==null);Lo===0&&(Lo=5)}function Jm(n,e,i){var o=Wa,s=Ec.transition;try{Ec.transition=null,Wa=1,fle(n,e,i,o)}finally{Ec.transition=s,Wa=o}return null}function fle(n,e,i,o){do B0();while(Jp!==null);if(ua&6)throw Error(pn(327));i=n.finishedWork;var s=n.finishedLanes;if(i===null)return null;if(n.finishedWork=null,n.finishedLanes=0,i===n.current)throw Error(pn(177));n.callbackNode=null,n.callbackPriority=0;var l=i.lanes|i.childLanes;if(qoe(n,l),n===Wo&&(xo=Wo=null,Jo=0),!(i.subtreeFlags&2064)&&!(i.flags&2064)||mS||(mS=!0,mY(ME,function(){return B0(),null})),l=(i.flags&15990)!==0,i.subtreeFlags&15990||l){l=Ec.transition,Ec.transition=null;var d=Wa;Wa=1;var p=ua;ua|=4,$k.current=null,lle(n,i),oY(i,n),Dse(lL),CE=!!sL,lL=sL=null,n.current=i,cle(i),Boe(),ua=p,Wa=d,Ec.transition=l}else n.current=i;if(mS&&(mS=!1,Jp=n,HE=s),l=n.pendingLanes,l===0&&(uf=null),Voe(i.stateNode),xl(n,lo()),e!==null)for(o=n.onRecoverableError,i=0;i<e.length;i++)s=e[i],o(s.value,{componentStack:s.stack,digest:s.digest});if(GE)throw GE=!1,n=CL,CL=null,n;return HE&1&&n.tag!==0&&B0(),l=n.pendingLanes,l&1?n===PL?ix++:(ix=0,PL=n):ix=0,Pf(),null}function B0(){if(Jp!==null){var n=jj(HE),e=Ec.transition,i=Wa;try{if(Ec.transition=null,Wa=16>n?16:n,Jp===null)var o=!1;else{if(n=Jp,Jp=null,HE=0,ua&6)throw Error(pn(331));var s=ua;for(ua|=4,zn=n.current;zn!==null;){var l=zn,d=l.child;if(zn.flags&16){var p=l.deletions;if(p!==null){for(var f=0;f<p.length;f++){var y=p[f];for(zn=y;zn!==null;){var _=zn;switch(_.tag){case 0:case 11:case 15:tx(8,_,l)}var x=_.child;if(x!==null)x.return=_,zn=x;else for(;zn!==null;){_=zn;var S=_.sibling,T=_.return;if(iY(_),_===y){zn=null;break}if(S!==null){S.return=T,zn=S;break}zn=T}}}var I=l.alternate;if(I!==null){var R=I.child;if(R!==null){I.child=null;do{var D=R.sibling;R.sibling=null,R=D}while(R!==null)}}zn=l}}if(l.subtreeFlags&2064&&d!==null)d.return=l,zn=d;else e:for(;zn!==null;){if(l=zn,l.flags&2048)switch(l.tag){case 0:case 11:case 15:tx(9,l,l.return)}var L=l.sibling;if(L!==null){L.return=l.return,zn=L;break e}zn=l.return}}var O=n.current;for(zn=O;zn!==null;){d=zn;var N=d.child;if(d.subtreeFlags&2064&&N!==null)N.return=d,zn=N;else e:for(d=O;zn!==null;){if(p=zn,p.flags&2048)try{switch(p.tag){case 0:case 11:case 15:LM(9,p)}}catch(G){jr(p,p.return,G)}if(p===d){zn=null;break e}var F=p.sibling;if(F!==null){F.return=p.return,zn=F;break e}zn=p.return}}if(ua=s,Pf(),hd&&typeof hd.onPostCommitFiberRoot=="function")try{hd.onPostCommitFiberRoot(SM,n)}catch{}o=!0}return o}finally{Wa=i,Ec.transition=e}}return!1}function kU(n,e,i){e=J0(i,e),e=$$(n,e,1),n=cf(n,e,1),e=js(),n!==null&&(Rw(n,1,e),xl(n,e))}function jr(n,e,i){if(n.tag===3)kU(n,n,i);else for(;e!==null;){if(e.tag===3){kU(e,n,i);break}else if(e.tag===1){var o=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof o.componentDidCatch=="function"&&(uf===null||!uf.has(o))){n=J0(i,n),n=Y$(e,n,1),e=cf(e,n,1),n=js(),e!==null&&(Rw(e,1,n),xl(e,n));break}}e=e.return}}function mle(n,e,i){var o=n.pingCache;o!==null&&o.delete(e),e=js(),n.pingedLanes|=n.suspendedLanes&i,Wo===n&&(Jo&i)===i&&(Lo===4||Lo===3&&(Jo&130023424)===Jo&&500>lo()-qk?bg(n,0):Yk|=i),xl(n,e)}function pY(n,e){e===0&&(n.mode&1?(e=rS,rS<<=1,!(rS&130023424)&&(rS=4194304)):e=1);var i=js();n=Uh(n,e),n!==null&&(Rw(n,e,i),xl(n,i))}function gle(n){var e=n.memoizedState,i=0;e!==null&&(i=e.retryLane),pY(n,i)}function yle(n,e){var i=0;switch(n.tag){case 13:var o=n.stateNode,s=n.memoizedState;s!==null&&(i=s.retryLane);break;case 19:o=n.stateNode;break;default:throw Error(pn(314))}o!==null&&o.delete(e),pY(n,i)}var fY;fY=function(n,e,i){if(n!==null)if(n.memoizedProps!==e.pendingProps||_l.current)vl=!0;else{if(!(n.lanes&i)&&!(e.flags&128))return vl=!1,ale(n,e,i);vl=!!(n.flags&131072)}else vl=!1,br&&e.flags&1048576&&y$(e,OE,e.index);switch(e.lanes=0,e.tag){case 2:var o=e.type;XA(n,e),n=e.pendingProps;var s=q0(e,Es.current);F0(e,i),s=Wk(null,e,o,n,s,i);var l=Vk();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,bl(o)?(l=!0,kE(e)):l=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Nk(e),s.updater=PM,e.stateNode=s,s._reactInternals=e,yL(e,o,n,i),e=bL(null,e,o,!0,l,i)):(e.tag=0,br&&l&&Pk(e),Gs(null,e,s,i),e=e.child),e;case 16:o=e.elementType;e:{switch(XA(n,e),n=e.pendingProps,s=o._init,o=s(o._payload),e.type=o,s=e.tag=_le(o),n=iu(o,n),s){case 0:e=_L(null,e,o,n,i);break e;case 1:e=SU(null,e,o,n,i);break e;case 11:e=xU(null,e,o,n,i);break e;case 14:e=wU(null,e,o,iu(o.type,n),i);break e}throw Error(pn(306,o,""))}return e;case 0:return o=e.type,s=e.pendingProps,s=e.elementType===o?s:iu(o,s),_L(n,e,o,s,i);case 1:return o=e.type,s=e.pendingProps,s=e.elementType===o?s:iu(o,s),SU(n,e,o,s,i);case 3:e:{if(K$(e),n===null)throw Error(pn(387));o=e.pendingProps,l=e.memoizedState,s=l.element,x$(n,e),FE(e,o,null,i);var d=e.memoizedState;if(o=d.element,l.isDehydrated)if(l={element:o,isDehydrated:!1,cache:d.cache,pendingSuspenseBoundaries:d.pendingSuspenseBoundaries,transitions:d.transitions},e.updateQueue.baseState=l,e.memoizedState=l,e.flags&256){s=J0(Error(pn(423)),e),e=AU(n,e,o,i,s);break e}else if(o!==s){s=J0(Error(pn(424)),e),e=AU(n,e,o,i,s);break e}else for(Yl=lf(e.stateNode.containerInfo.firstChild),ql=e,br=!0,su=null,i=E$(e,null,o,i),e.child=i;i;)i.flags=i.flags&-3|4096,i=i.sibling;else{if(X0(),o===s){e=Wh(n,e,i);break e}Gs(n,e,o,i)}e=e.child}return e;case 5:return M$(e),n===null&&fL(e),o=e.type,s=e.pendingProps,l=n!==null?n.memoizedProps:null,d=s.children,cL(o,s)?d=null:l!==null&&cL(o,l)&&(e.flags|=32),Z$(n,e),Gs(n,e,d,i),e.child;case 6:return n===null&&fL(e),null;case 13:return J$(n,e,i);case 4:return zk(e,e.stateNode.containerInfo),o=e.pendingProps,n===null?e.child=Z0(e,null,o,i):Gs(n,e,o,i),e.child;case 11:return o=e.type,s=e.pendingProps,s=e.elementType===o?s:iu(o,s),xU(n,e,o,s,i);case 7:return Gs(n,e,e.pendingProps,i),e.child;case 8:return Gs(n,e,e.pendingProps.children,i),e.child;case 12:return Gs(n,e,e.pendingProps.children,i),e.child;case 10:e:{if(o=e.type._context,s=e.pendingProps,l=e.memoizedProps,d=s.value,ir(NE,o._currentValue),o._currentValue=d,l!==null)if(mu(l.value,d)){if(l.children===s.children&&!_l.current){e=Wh(n,e,i);break e}}else for(l=e.child,l!==null&&(l.return=e);l!==null;){var p=l.dependencies;if(p!==null){d=l.child;for(var f=p.firstContext;f!==null;){if(f.context===o){if(l.tag===1){f=Nh(-1,i&-i),f.tag=2;var y=l.updateQueue;if(y!==null){y=y.shared;var _=y.pending;_===null?f.next=f:(f.next=_.next,_.next=f),y.pending=f}}l.lanes|=i,f=l.alternate,f!==null&&(f.lanes|=i),mL(l.return,i,e),p.lanes|=i;break}f=f.next}}else if(l.tag===10)d=l.type===e.type?null:l.child;else if(l.tag===18){if(d=l.return,d===null)throw Error(pn(341));d.lanes|=i,p=d.alternate,p!==null&&(p.lanes|=i),mL(d,i,e),d=l.sibling}else d=l.child;if(d!==null)d.return=l;else for(d=l;d!==null;){if(d===e){d=null;break}if(l=d.sibling,l!==null){l.return=d.return,d=l;break}d=d.return}l=d}Gs(n,e,s.children,i),e=e.child}return e;case 9:return s=e.type,o=e.pendingProps.children,F0(e,i),s=Tc(s),o=o(s),e.flags|=1,Gs(n,e,o,i),e.child;case 14:return o=e.type,s=iu(o,e.pendingProps),s=iu(o.type,s),wU(n,e,o,s,i);case 15:return q$(n,e,e.type,e.pendingProps,i);case 17:return o=e.type,s=e.pendingProps,s=e.elementType===o?s:iu(o,s),XA(n,e),e.tag=1,bl(o)?(n=!0,kE(e)):n=!1,F0(e,i),S$(e,o,s),yL(e,o,s,i),bL(null,e,o,!0,n,i);case 19:return Q$(n,e,i);case 22:return X$(n,e,i)}throw Error(pn(156,e.tag))};function mY(n,e){return Wj(n,e)}function vle(n,e,i,o){this.tag=n,this.key=i,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=o,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ac(n,e,i,o){return new vle(n,e,i,o)}function Jk(n){return n=n.prototype,!(!n||!n.isReactComponent)}function _le(n){if(typeof n=="function")return Jk(n)?1:0;if(n!=null){if(n=n.$$typeof,n===yk)return 11;if(n===vk)return 14}return 2}function hf(n,e){var i=n.alternate;return i===null?(i=Ac(n.tag,e,n.key,n.mode),i.elementType=n.elementType,i.type=n.type,i.stateNode=n.stateNode,i.alternate=n,n.alternate=i):(i.pendingProps=e,i.type=n.type,i.flags=0,i.subtreeFlags=0,i.deletions=null),i.flags=n.flags&14680064,i.childLanes=n.childLanes,i.lanes=n.lanes,i.child=n.child,i.memoizedProps=n.memoizedProps,i.memoizedState=n.memoizedState,i.updateQueue=n.updateQueue,e=n.dependencies,i.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},i.sibling=n.sibling,i.index=n.index,i.ref=n.ref,i}function JA(n,e,i,o,s,l){var d=2;if(o=n,typeof n=="function")Jk(n)&&(d=1);else if(typeof n=="string")d=5;else e:switch(n){case g0:return xg(i.children,s,l,e);case gk:d=8,s|=8;break;case WI:return n=Ac(12,i,e,s|2),n.elementType=WI,n.lanes=l,n;case VI:return n=Ac(13,i,e,s),n.elementType=VI,n.lanes=l,n;case GI:return n=Ac(19,i,e,s),n.elementType=GI,n.lanes=l,n;case Aj:return kM(i,s,l,e);default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case wj:d=10;break e;case Sj:d=9;break e;case yk:d=11;break e;case vk:d=14;break e;case $p:d=16,o=null;break e}throw Error(pn(130,n==null?n:typeof n,""))}return e=Ac(d,i,e,s),e.elementType=n,e.type=o,e.lanes=l,e}function xg(n,e,i,o){return n=Ac(7,n,o,e),n.lanes=i,n}function kM(n,e,i,o){return n=Ac(22,n,o,e),n.elementType=Aj,n.lanes=i,n.stateNode={isHidden:!1},n}function c4(n,e,i){return n=Ac(6,n,null,e),n.lanes=i,n}function u4(n,e,i){return e=Ac(4,n.children!==null?n.children:[],n.key,e),e.lanes=i,e.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},e}function ble(n,e,i,o,s){this.tag=e,this.containerInfo=n,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=H5(0),this.expirationTimes=H5(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=H5(0),this.identifierPrefix=o,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Qk(n,e,i,o,s,l,d,p,f){return n=new ble(n,e,i,p,f),e===1?(e=1,l===!0&&(e|=8)):e=0,l=Ac(3,null,null,e),n.current=l,l.stateNode=n,l.memoizedState={element:o,isDehydrated:i,cache:null,transitions:null,pendingSuspenseBoundaries:null},Nk(l),n}function xle(n,e,i){var o=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:m0,key:o==null?null:""+o,children:n,containerInfo:e,implementation:i}}function gY(n){if(!n)return _f;n=n._reactInternals;e:{if(qg(n)!==n||n.tag!==1)throw Error(pn(170));var e=n;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(bl(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(pn(171))}if(n.tag===1){var i=n.type;if(bl(i))return m$(n,i,e)}return e}function yY(n,e,i,o,s,l,d,p,f){return n=Qk(i,o,!0,n,s,l,d,p,f),n.context=gY(null),i=n.current,o=js(),s=df(i),l=Nh(o,s),l.callback=e??null,cf(i,l,s),n.current.lanes=s,Rw(n,s,o),xl(n,o),n}function DM(n,e,i,o){var s=e.current,l=js(),d=df(s);return i=gY(i),e.context===null?e.context=i:e.pendingContext=i,e=Nh(l,d),e.payload={element:n},o=o===void 0?null:o,o!==null&&(e.callback=o),n=cf(s,e,d),n!==null&&(pu(n,s,d,l),$A(n,s,d)),d}function $E(n){if(n=n.current,!n.child)return null;switch(n.child.tag){case 5:return n.child.stateNode;default:return n.child.stateNode}}function DU(n,e){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var i=n.retryLane;n.retryLane=i!==0&&i<e?i:e}}function eD(n,e){DU(n,e),(n=n.alternate)&&DU(n,e)}function wle(){return null}var vY=typeof reportError=="function"?reportError:function(n){console.error(n)};function tD(n){this._internalRoot=n}OM.prototype.render=tD.prototype.render=function(n){var e=this._internalRoot;if(e===null)throw Error(pn(409));DM(n,e,null,null)};OM.prototype.unmount=tD.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var e=n.containerInfo;Dg(function(){DM(null,n,null,null)}),e[Bh]=null}};function OM(n){this._internalRoot=n}OM.prototype.unstable_scheduleHydration=function(n){if(n){var e=qj();n={blockedOn:null,target:n,priority:e};for(var i=0;i<qp.length&&e!==0&&e<qp[i].priority;i++);qp.splice(i,0,n),i===0&&Zj(n)}};function nD(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function NM(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11&&(n.nodeType!==8||n.nodeValue!==" react-mount-point-unstable "))}function OU(){}function Sle(n,e,i,o,s){if(s){if(typeof o=="function"){var l=o;o=function(){var y=$E(d);l.call(y)}}var d=yY(e,o,n,0,null,!1,!1,"",OU);return n._reactRootContainer=d,n[Bh]=d.current,zx(n.nodeType===8?n.parentNode:n),Dg(),d}for(;s=n.lastChild;)n.removeChild(s);if(typeof o=="function"){var p=o;o=function(){var y=$E(f);p.call(y)}}var f=Qk(n,0,!1,null,null,!1,!1,"",OU);return n._reactRootContainer=f,n[Bh]=f.current,zx(n.nodeType===8?n.parentNode:n),Dg(function(){DM(e,f,i,o)}),f}function zM(n,e,i,o,s){var l=i._reactRootContainer;if(l){var d=l;if(typeof s=="function"){var p=s;s=function(){var f=$E(d);p.call(f)}}DM(e,d,n,s)}else d=Sle(i,e,n,s,o);return $E(d)}$j=function(n){switch(n.tag){case 3:var e=n.stateNode;if(e.current.memoizedState.isDehydrated){var i=Nb(e.pendingLanes);i!==0&&(xk(e,i|1),xl(e,lo()),!(ua&6)&&(Q0=lo()+500,Pf()))}break;case 13:Dg(function(){var o=Uh(n,1);if(o!==null){var s=js();pu(o,n,1,s)}}),eD(n,1)}};wk=function(n){if(n.tag===13){var e=Uh(n,134217728);if(e!==null){var i=js();pu(e,n,134217728,i)}eD(n,134217728)}};Yj=function(n){if(n.tag===13){var e=df(n),i=Uh(n,e);if(i!==null){var o=js();pu(i,n,e,o)}eD(n,e)}};qj=function(){return Wa};Xj=function(n,e){var i=Wa;try{return Wa=n,e()}finally{Wa=i}};QI=function(n,e,i){switch(e){case"input":if($I(n,i),e=i.name,i.type==="radio"&&e!=null){for(i=n;i.parentNode;)i=i.parentNode;for(i=i.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<i.length;e++){var o=i[e];if(o!==n&&o.form===n.form){var s=TM(o);if(!s)throw Error(pn(90));Mj(o),$I(o,s)}}}break;case"textarea":Cj(n,i);break;case"select":e=i.value,e!=null&&D0(n,!!i.multiple,e,!1)}};Oj=Xk;Nj=Dg;var Ale={usingClientEntryPoint:!1,Events:[Dw,b0,TM,kj,Dj,Xk]},Q1={findFiberByHostInstance:lg,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},Ele={bundleType:Q1.bundleType,version:Q1.version,rendererPackageName:Q1.rendererPackageName,rendererConfig:Q1.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:$h.ReactCurrentDispatcher,findHostInstanceByFiber:function(n){return n=Bj(n),n===null?null:n.stateNode},findFiberByHostInstance:Q1.findFiberByHostInstance||wle,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var gS=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!gS.isDisabled&&gS.supportsFiber)try{SM=gS.inject(Ele),hd=gS}catch{}}ec.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Ale;ec.createPortal=function(n,e){var i=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!nD(e))throw Error(pn(200));return xle(n,e,null,i)};ec.createRoot=function(n,e){if(!nD(n))throw Error(pn(299));var i=!1,o="",s=vY;return e!=null&&(e.unstable_strictMode===!0&&(i=!0),e.identifierPrefix!==void 0&&(o=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=Qk(n,1,!1,null,null,i,!1,o,s),n[Bh]=e.current,zx(n.nodeType===8?n.parentNode:n),new tD(e)};ec.findDOMNode=function(n){if(n==null)return null;if(n.nodeType===1)return n;var e=n._reactInternals;if(e===void 0)throw typeof n.render=="function"?Error(pn(188)):(n=Object.keys(n).join(","),Error(pn(268,n)));return n=Bj(e),n=n===null?null:n.stateNode,n};ec.flushSync=function(n){return Dg(n)};ec.hydrate=function(n,e,i){if(!NM(e))throw Error(pn(200));return zM(null,n,e,!0,i)};ec.hydrateRoot=function(n,e,i){if(!nD(n))throw Error(pn(405));var o=i!=null&&i.hydratedSources||null,s=!1,l="",d=vY;if(i!=null&&(i.unstable_strictMode===!0&&(s=!0),i.identifierPrefix!==void 0&&(l=i.identifierPrefix),i.onRecoverableError!==void 0&&(d=i.onRecoverableError)),e=yY(e,null,n,1,i??null,s,!1,l,d),n[Bh]=e.current,zx(n),o)for(n=0;n<o.length;n++)i=o[n],s=i._getVersion,s=s(i._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[i,s]:e.mutableSourceEagerHydrationData.push(i,s);return new OM(e)};ec.render=function(n,e,i){if(!NM(e))throw Error(pn(200));return zM(null,n,e,!1,i)};ec.unmountComponentAtNode=function(n){if(!NM(n))throw Error(pn(40));return n._reactRootContainer?(Dg(function(){zM(null,null,n,!1,function(){n._reactRootContainer=null,n[Bh]=null})}),!0):!1};ec.unstable_batchedUpdates=Xk;ec.unstable_renderSubtreeIntoContainer=function(n,e,i,o){if(!NM(i))throw Error(pn(200));if(n==null||n._reactInternals===void 0)throw Error(pn(38));return zM(n,e,i,!1,o)};ec.version="18.2.0-next-9e3b772b8-20220608";function _Y(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(_Y)}catch(n){console.error(n)}}_Y(),yj.exports=ec;var Nw=yj.exports;const Fb=Iw(Nw),Mle=sj({__proto__:null,default:Fb},[Nw]);var NU=Nw;BI.createRoot=NU.createRoot,BI.hydrateRoot=NU.hydrateRoot;/**
 * @remix-run/router v1.12.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function $r(){return $r=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(n[o]=i[o])}return n},$r.apply(this,arguments)}var ro;(function(n){n.Pop="POP",n.Push="PUSH",n.Replace="REPLACE"})(ro||(ro={}));const zU="popstate";function Tle(n){n===void 0&&(n={});function e(s,l){let{pathname:d="/",search:p="",hash:f=""}=Md(s.location.hash.substr(1));return!d.startsWith("/")&&!d.startsWith(".")&&(d="/"+d),$x("",{pathname:d,search:p,hash:f},l.state&&l.state.usr||null,l.state&&l.state.key||"default")}function i(s,l){let d=s.document.querySelector("base"),p="";if(d&&d.getAttribute("href")){let f=s.location.href,y=f.indexOf("#");p=y===-1?f:f.slice(0,y)}return p+"#"+(typeof l=="string"?l:zw(l))}function o(s,l){bf(s.pathname.charAt(0)==="/","relative pathnames are not supported in hash history.push("+JSON.stringify(l)+")")}return Ple(e,i,o,n)}function Ji(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function bf(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function Cle(){return Math.random().toString(36).substr(2,8)}function FU(n,e){return{usr:n.state,key:n.key,idx:e}}function $x(n,e,i,o){return i===void 0&&(i=null),$r({pathname:typeof n=="string"?n:n.pathname,search:"",hash:""},typeof e=="string"?Md(e):e,{state:i,key:e&&e.key||o||Cle()})}function zw(n){let{pathname:e="/",search:i="",hash:o=""}=n;return i&&i!=="?"&&(e+=i.charAt(0)==="?"?i:"?"+i),o&&o!=="#"&&(e+=o.charAt(0)==="#"?o:"#"+o),e}function Md(n){let e={};if(n){let i=n.indexOf("#");i>=0&&(e.hash=n.substr(i),n=n.substr(0,i));let o=n.indexOf("?");o>=0&&(e.search=n.substr(o),n=n.substr(0,o)),n&&(e.pathname=n)}return e}function Ple(n,e,i,o){o===void 0&&(o={});let{window:s=document.defaultView,v5Compat:l=!1}=o,d=s.history,p=ro.Pop,f=null,y=_();y==null&&(y=0,d.replaceState($r({},d.state,{idx:y}),""));function _(){return(d.state||{idx:null}).idx}function x(){p=ro.Pop;let D=_(),L=D==null?null:D-y;y=D,f&&f({action:p,location:R.location,delta:L})}function S(D,L){p=ro.Push;let O=$x(R.location,D,L);i&&i(O,D),y=_()+1;let N=FU(O,y),F=R.createHref(O);try{d.pushState(N,"",F)}catch(G){if(G instanceof DOMException&&G.name==="DataCloneError")throw G;s.location.assign(F)}l&&f&&f({action:p,location:R.location,delta:1})}function T(D,L){p=ro.Replace;let O=$x(R.location,D,L);i&&i(O,D),y=_();let N=FU(O,y),F=R.createHref(O);d.replaceState(N,"",F),l&&f&&f({action:p,location:R.location,delta:0})}function I(D){let L=s.location.origin!=="null"?s.location.origin:s.location.href,O=typeof D=="string"?D:zw(D);return Ji(L,"No window.location.(origin|href) available to create URL for href: "+O),new URL(O,L)}let R={get action(){return p},get location(){return n(s,d)},listen(D){if(f)throw new Error("A history only accepts one active listener");return s.addEventListener(zU,x),f=D,()=>{s.removeEventListener(zU,x),f=null}},createHref(D){return e(s,D)},createURL:I,encodeLocation(D){let L=I(D);return{pathname:L.pathname,search:L.search,hash:L.hash}},push:S,replace:T,go(D){return d.go(D)}};return R}var oo;(function(n){n.data="data",n.deferred="deferred",n.redirect="redirect",n.error="error"})(oo||(oo={}));const Ile=new Set(["lazy","caseSensitive","path","id","index","children"]);function Lle(n){return n.index===!0}function RL(n,e,i,o){return i===void 0&&(i=[]),o===void 0&&(o={}),n.map((s,l)=>{let d=[...i,l],p=typeof s.id=="string"?s.id:d.join("-");if(Ji(s.index!==!0||!s.children,"Cannot specify children on an index route"),Ji(!o[p],'Found a route id collision on id "'+p+`".  Route id's must be globally unique within Data Router usages`),Lle(s)){let f=$r({},s,e(s),{id:p});return o[p]=f,f}else{let f=$r({},s,e(s),{id:p,children:void 0});return o[p]=f,s.children&&(f.children=RL(s.children,e,d,o)),f}})}function T0(n,e,i){i===void 0&&(i="/");let o=typeof e=="string"?Md(e):e,s=Fw(o.pathname||"/",i);if(s==null)return null;let l=bY(n);kle(l);let d=null;for(let p=0;d==null&&p<l.length;++p)d=Vle(l[p],jle(s));return d}function Rle(n,e){let{route:i,pathname:o,params:s}=n;return{id:i.id,pathname:o,params:s,data:e[i.id],handle:i.handle}}function bY(n,e,i,o){e===void 0&&(e=[]),i===void 0&&(i=[]),o===void 0&&(o="");let s=(l,d,p)=>{let f={relativePath:p===void 0?l.path||"":p,caseSensitive:l.caseSensitive===!0,childrenIndex:d,route:l};f.relativePath.startsWith("/")&&(Ji(f.relativePath.startsWith(o),'Absolute route path "'+f.relativePath+'" nested under path '+('"'+o+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),f.relativePath=f.relativePath.slice(o.length));let y=pf([o,f.relativePath]),_=i.concat(f);l.children&&l.children.length>0&&(Ji(l.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+y+'".')),bY(l.children,e,_,y)),!(l.path==null&&!l.index)&&e.push({path:y,score:Ule(y,l.index),routesMeta:_})};return n.forEach((l,d)=>{var p;if(l.path===""||!((p=l.path)!=null&&p.includes("?")))s(l,d);else for(let f of xY(l.path))s(l,d,f)}),e}function xY(n){let e=n.split("/");if(e.length===0)return[];let[i,...o]=e,s=i.endsWith("?"),l=i.replace(/\?$/,"");if(o.length===0)return s?[l,""]:[l];let d=xY(o.join("/")),p=[];return p.push(...d.map(f=>f===""?l:[l,f].join("/"))),s&&p.push(...d),p.map(f=>n.startsWith("/")&&f===""?"/":f)}function kle(n){n.sort((e,i)=>e.score!==i.score?i.score-e.score:Wle(e.routesMeta.map(o=>o.childrenIndex),i.routesMeta.map(o=>o.childrenIndex)))}const Dle=/^:\w+$/,Ole=3,Nle=2,zle=1,Fle=10,Ble=-2,BU=n=>n==="*";function Ule(n,e){let i=n.split("/"),o=i.length;return i.some(BU)&&(o+=Ble),e&&(o+=Nle),i.filter(s=>!BU(s)).reduce((s,l)=>s+(Dle.test(l)?Ole:l===""?zle:Fle),o)}function Wle(n,e){return n.length===e.length&&n.slice(0,-1).every((o,s)=>o===e[s])?n[n.length-1]-e[e.length-1]:0}function Vle(n,e){let{routesMeta:i}=n,o={},s="/",l=[];for(let d=0;d<i.length;++d){let p=i[d],f=d===i.length-1,y=s==="/"?e:e.slice(s.length)||"/",_=Gle({path:p.relativePath,caseSensitive:p.caseSensitive,end:f},y);if(!_)return null;Object.assign(o,_.params);let x=p.route;l.push({params:o,pathname:pf([s,_.pathname]),pathnameBase:Xle(pf([s,_.pathnameBase])),route:x}),_.pathnameBase!=="/"&&(s=pf([s,_.pathnameBase]))}return l}function Gle(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[i,o]=Hle(n.path,n.caseSensitive,n.end),s=e.match(i);if(!s)return null;let l=s[0],d=l.replace(/(.)\/+$/,"$1"),p=s.slice(1);return{params:o.reduce((y,_,x)=>{let{paramName:S,isOptional:T}=_;if(S==="*"){let R=p[x]||"";d=l.slice(0,l.length-R.length).replace(/(.)\/+$/,"$1")}const I=p[x];return T&&!I?y[S]=void 0:y[S]=$le(I||"",S),y},{}),pathname:l,pathnameBase:d,pattern:n}}function Hle(n,e,i){e===void 0&&(e=!1),i===void 0&&(i=!0),bf(n==="*"||!n.endsWith("*")||n.endsWith("/*"),'Route path "'+n+'" will be treated as if it were '+('"'+n.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+n.replace(/\*$/,"/*")+'".'));let o=[],s="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:(\w+)(\?)?/g,(d,p,f)=>(o.push({paramName:p,isOptional:f!=null}),f?"/?([^\\/]+)?":"/([^\\/]+)"));return n.endsWith("*")?(o.push({paramName:"*"}),s+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):i?s+="\\/*$":n!==""&&n!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),o]}function jle(n){try{return decodeURI(n)}catch(e){return bf(!1,'The URL path "'+n+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),n}}function $le(n,e){try{return decodeURIComponent(n)}catch(i){return bf(!1,'The value for the URL param "'+e+'" will not be decoded because'+(' the string "'+n+'" is a malformed URL segment. This is probably')+(" due to a bad percent encoding ("+i+").")),n}}function Fw(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let i=e.endsWith("/")?e.length-1:e.length,o=n.charAt(i);return o&&o!=="/"?null:n.slice(i)||"/"}function Yle(n,e){e===void 0&&(e="/");let{pathname:i,search:o="",hash:s=""}=typeof n=="string"?Md(n):n;return{pathname:i?i.startsWith("/")?i:qle(i,e):e,search:Zle(o),hash:Kle(s)}}function qle(n,e){let i=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(s=>{s===".."?i.length>1&&i.pop():s!=="."&&i.push(s)}),i.length>1?i.join("/"):"/"}function d4(n,e,i,o){return"Cannot include a '"+n+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(o)+"].  Please separate it out to the ")+("`to."+i+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function iD(n){return n.filter((e,i)=>i===0||e.route.path&&e.route.path.length>0)}function wY(n,e,i,o){o===void 0&&(o=!1);let s;typeof n=="string"?s=Md(n):(s=$r({},n),Ji(!s.pathname||!s.pathname.includes("?"),d4("?","pathname","search",s)),Ji(!s.pathname||!s.pathname.includes("#"),d4("#","pathname","hash",s)),Ji(!s.search||!s.search.includes("#"),d4("#","search","hash",s)));let l=n===""||s.pathname==="",d=l?"/":s.pathname,p;if(d==null)p=i;else if(o){let x=e[e.length-1].replace(/^\//,"").split("/");if(d.startsWith("..")){let S=d.split("/");for(;S[0]==="..";)S.shift(),x.pop();s.pathname=S.join("/")}p="/"+x.join("/")}else{let x=e.length-1;if(d.startsWith("..")){let S=d.split("/");for(;S[0]==="..";)S.shift(),x-=1;s.pathname=S.join("/")}p=x>=0?e[x]:"/"}let f=Yle(s,p),y=d&&d!=="/"&&d.endsWith("/"),_=(l||d===".")&&i.endsWith("/");return!f.pathname.endsWith("/")&&(y||_)&&(f.pathname+="/"),f}const pf=n=>n.join("/").replace(/\/\/+/g,"/"),Xle=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),Zle=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,Kle=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n;class aD{constructor(e,i,o,s){s===void 0&&(s=!1),this.status=e,this.statusText=i||"",this.internal=s,o instanceof Error?(this.data=o.toString(),this.error=o):this.data=o}}function SY(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}const AY=["post","put","patch","delete"],Jle=new Set(AY),Qle=["get",...AY],ece=new Set(Qle),tce=new Set([301,302,303,307,308]),nce=new Set([307,308]),h4={state:"idle",location:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},ice={state:"idle",data:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},eb={state:"unblocked",proceed:void 0,reset:void 0,location:void 0},EY=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,ace=n=>({hasErrorBoundary:!!n.hasErrorBoundary}),MY="remix-router-transitions";function rce(n){const e=n.window?n.window:typeof window<"u"?window:void 0,i=typeof e<"u"&&typeof e.document<"u"&&typeof e.document.createElement<"u",o=!i;Ji(n.routes.length>0,"You must provide a non-empty routes array to createRouter");let s;if(n.mapRouteProperties)s=n.mapRouteProperties;else if(n.detectErrorBoundary){let be=n.detectErrorBoundary;s=Qe=>({hasErrorBoundary:be(Qe)})}else s=ace;let l={},d=RL(n.routes,s,void 0,l),p,f=n.basename||"/",y=$r({v7_fetcherPersist:!1,v7_normalizeFormMethod:!1,v7_prependBasename:!1},n.future),_=null,x=new Set,S=null,T=null,I=null,R=n.hydrationData!=null,D=T0(d,n.history.location,f),L=null;if(D==null){let be=bc(404,{pathname:n.history.location.pathname}),{matches:Qe,route:we}=YU(d);D=Qe,L={[we.id]:be}}let O=!D.some(be=>be.route.lazy)&&(!D.some(be=>be.route.loader)||n.hydrationData!=null),N,F={historyAction:n.history.action,location:n.history.location,matches:D,initialized:O,navigation:h4,restoreScrollPosition:n.hydrationData!=null?!1:null,preventScrollReset:!1,revalidation:"idle",loaderData:n.hydrationData&&n.hydrationData.loaderData||{},actionData:n.hydrationData&&n.hydrationData.actionData||null,errors:n.hydrationData&&n.hydrationData.errors||L,fetchers:new Map,blockers:new Map},G=ro.Pop,j=!1,Y,te=!1,V=new Map,Q=null,he=!1,fe=!1,ye=[],pe=[],Me=new Map,Ie=0,ze=-1,le=new Map,me=new Set,xe=new Map,ae=new Map,Ee=new Set,Je=new Map,Ze=new Map,Ke=!1;function Fe(){if(_=n.history.listen(be=>{let{action:Qe,location:we,delta:Te}=be;if(Ke){Ke=!1;return}bf(Ze.size===0||Te!=null,"You are trying to use a blocker on a POP navigation to a location that was not created by @remix-run/router. This will fail silently in production. This can happen if you are navigating outside the router via `window.history.pushState`/`window.location.hash` instead of using router navigation APIs.  This can also happen if you are using createHashRouter and the user manually changes the URL.");let Ne=wt({currentLocation:F.location,nextLocation:we,historyAction:Qe});if(Ne&&Te!=null){Ke=!0,n.history.go(Te*-1),Dt(Ne,{state:"blocked",location:we,proceed(){Dt(Ne,{state:"proceeding",proceed:void 0,reset:void 0,location:we}),n.history.go(Te)},reset(){let et=new Map(F.blockers);et.set(Ne,eb),kt({blockers:et})}});return}return ft(Qe,we)}),i){gce(e,V);let be=()=>yce(e,V);e.addEventListener("pagehide",be),Q=()=>e.removeEventListener("pagehide",be)}return F.initialized||ft(ro.Pop,F.location),N}function ct(){_&&_(),Q&&Q(),x.clear(),Y&&Y.abort(),F.fetchers.forEach((be,Qe)=>Oe(Qe)),F.blockers.forEach((be,Qe)=>Ht(Qe))}function Ct(be){return x.add(be),()=>x.delete(be)}function kt(be,Qe){Qe===void 0&&(Qe={}),F=$r({},F,be);let we=[],Te=[];y.v7_fetcherPersist&&F.fetchers.forEach((Ne,et)=>{Ne.state==="idle"&&(Ee.has(et)?Te.push(et):we.push(et))}),[...x].forEach(Ne=>Ne(F,{deletedFetchers:Te,unstable_viewTransitionOpts:Qe.viewTransitionOpts,unstable_flushSync:Qe.flushSync===!0})),y.v7_fetcherPersist&&(we.forEach(Ne=>F.fetchers.delete(Ne)),Te.forEach(Ne=>Oe(Ne)))}function Kt(be,Qe,we){var Te,Ne;let{flushSync:et}=we===void 0?{}:we,tt=F.actionData!=null&&F.navigation.formMethod!=null&&ou(F.navigation.formMethod)&&F.navigation.state==="loading"&&((Te=be.state)==null?void 0:Te._isRedirect)!==!0,vt;Qe.actionData?Object.keys(Qe.actionData).length>0?vt=Qe.actionData:vt=null:tt?vt=F.actionData:vt=null;let ht=Qe.loaderData?$U(F.loaderData,Qe.loaderData,Qe.matches||[],Qe.errors):F.loaderData,dt=F.blockers;dt.size>0&&(dt=new Map(dt),dt.forEach((Qt,fn)=>dt.set(fn,eb)));let Vt=j===!0||F.navigation.formMethod!=null&&ou(F.navigation.formMethod)&&((Ne=be.state)==null?void 0:Ne._isRedirect)!==!0;p&&(d=p,p=void 0),he||G===ro.Pop||(G===ro.Push?n.history.push(be,be.state):G===ro.Replace&&n.history.replace(be,be.state));let It;if(G===ro.Pop){let Qt=V.get(F.location.pathname);Qt&&Qt.has(be.pathname)?It={currentLocation:F.location,nextLocation:be}:V.has(be.pathname)&&(It={currentLocation:be,nextLocation:F.location})}else if(te){let Qt=V.get(F.location.pathname);Qt?Qt.add(be.pathname):(Qt=new Set([be.pathname]),V.set(F.location.pathname,Qt)),It={currentLocation:F.location,nextLocation:be}}kt($r({},Qe,{actionData:vt,loaderData:ht,historyAction:G,location:be,initialized:!0,navigation:h4,revalidation:"idle",restoreScrollPosition:Nt(be,Qe.matches||F.matches),preventScrollReset:Vt,blockers:dt}),{viewTransitionOpts:It,flushSync:et===!0}),G=ro.Pop,j=!1,te=!1,he=!1,fe=!1,ye=[],pe=[]}async function At(be,Qe){if(typeof be=="number"){n.history.go(be);return}let we=kL(F.location,F.matches,f,y.v7_prependBasename,be,Qe==null?void 0:Qe.fromRouteId,Qe==null?void 0:Qe.relative),{path:Te,submission:Ne,error:et}=UU(y.v7_normalizeFormMethod,!1,we,Qe),tt=F.location,vt=$x(F.location,Te,Qe&&Qe.state);vt=$r({},vt,n.history.encodeLocation(vt));let ht=Qe&&Qe.replace!=null?Qe.replace:void 0,dt=ro.Push;ht===!0?dt=ro.Replace:ht===!1||Ne!=null&&ou(Ne.formMethod)&&Ne.formAction===F.location.pathname+F.location.search&&(dt=ro.Replace);let Vt=Qe&&"preventScrollReset"in Qe?Qe.preventScrollReset===!0:void 0,It=(Qe&&Qe.unstable_flushSync)===!0,Qt=wt({currentLocation:tt,nextLocation:vt,historyAction:dt});if(Qt){Dt(Qt,{state:"blocked",location:vt,proceed(){Dt(Qt,{state:"proceeding",proceed:void 0,reset:void 0,location:vt}),At(be,Qe)},reset(){let fn=new Map(F.blockers);fn.set(Qt,eb),kt({blockers:fn})}});return}return await ft(dt,vt,{submission:Ne,pendingError:et,preventScrollReset:Vt,replace:Qe&&Qe.replace,enableViewTransition:Qe&&Qe.unstable_viewTransition,flushSync:It})}function Pe(){if(De(),kt({revalidation:"loading"}),F.navigation.state!=="submitting"){if(F.navigation.state==="idle"){ft(F.historyAction,F.location,{startUninterruptedRevalidation:!0});return}ft(G||F.historyAction,F.navigation.location,{overrideNavigation:F.navigation})}}async function ft(be,Qe,we){Y&&Y.abort(),Y=null,G=be,he=(we&&we.startUninterruptedRevalidation)===!0,qt(F.location,F.matches),j=(we&&we.preventScrollReset)===!0,te=(we&&we.enableViewTransition)===!0;let Te=p||d,Ne=we&&we.overrideNavigation,et=T0(Te,Qe,f),tt=(we&&we.flushSync)===!0;if(!et){let fn=bc(404,{pathname:Qe.pathname}),{matches:en,route:vn}=YU(Te);Xt(),Kt(Qe,{matches:en,loaderData:{},errors:{[vn.id]:fn}},{flushSync:tt});return}if(F.initialized&&!fe&&uce(F.location,Qe)&&!(we&&we.submission&&ou(we.submission.formMethod))){Kt(Qe,{matches:et},{flushSync:tt});return}Y=new AbortController;let vt=nb(n.history,Qe,Y.signal,we&&we.submission),ht,dt;if(we&&we.pendingError)dt={[ax(et).route.id]:we.pendingError};else if(we&&we.submission&&ou(we.submission.formMethod)){let fn=await gt(vt,Qe,we.submission,et,{replace:we.replace,flushSync:tt});if(fn.shortCircuited)return;ht=fn.pendingActionData,dt=fn.pendingActionError,Ne=p4(Qe,we.submission),tt=!1,vt=new Request(vt.url,{signal:vt.signal})}let{shortCircuited:Vt,loaderData:It,errors:Qt}=await _t(vt,Qe,et,Ne,we&&we.submission,we&&we.fetcherSubmission,we&&we.replace,tt,ht,dt);Vt||(Y=null,Kt(Qe,$r({matches:et},ht?{actionData:ht}:{},{loaderData:It,errors:Qt})))}async function gt(be,Qe,we,Te,Ne){Ne===void 0&&(Ne={}),De();let et=fce(Qe,we);kt({navigation:et},{flushSync:Ne.flushSync===!0});let tt,vt=OL(Te,Qe);if(!vt.route.action&&!vt.route.lazy)tt={type:oo.error,error:bc(405,{method:be.method,pathname:Qe.pathname,routeId:vt.route.id})};else if(tt=await tb("action",be,vt,Te,l,s,f),be.signal.aborted)return{shortCircuited:!0};if(U0(tt)){let ht;return Ne&&Ne.replace!=null?ht=Ne.replace:ht=tt.location===F.location.pathname+F.location.search,await _e(F,tt,{submission:we,replace:ht}),{shortCircuited:!0}}if(rx(tt)){let ht=ax(Te,vt.route.id);return(Ne&&Ne.replace)!==!0&&(G=ro.Push),{pendingActionData:{},pendingActionError:{[ht.route.id]:tt.error}}}if(dg(tt))throw bc(400,{type:"defer-action"});return{pendingActionData:{[vt.route.id]:tt.data}}}async function _t(be,Qe,we,Te,Ne,et,tt,vt,ht,dt){let Vt=Te||p4(Qe,Ne),It=Ne||et||ZU(Vt),Qt=p||d,[fn,en]=WU(n.history,F,we,It,Qe,fe,ye,pe,xe,me,Qt,f,ht,dt);if(Xt(Lt=>!(we&&we.some(zt=>zt.route.id===Lt))||fn&&fn.some(zt=>zt.route.id===Lt)),ze=++Ie,fn.length===0&&en.length===0){let Lt=Et();return Kt(Qe,$r({matches:we,loaderData:{},errors:dt||null},ht?{actionData:ht}:{},Lt?{fetchers:new Map(F.fetchers)}:{}),{flushSync:vt}),{shortCircuited:!0}}if(!he){en.forEach(zt=>{let jt=F.fetchers.get(zt.key),gn=ib(void 0,jt?jt.data:void 0);F.fetchers.set(zt.key,gn)});let Lt=ht||F.actionData;kt($r({navigation:Vt},Lt?Object.keys(Lt).length===0?{actionData:null}:{actionData:Lt}:{},en.length>0?{fetchers:new Map(F.fetchers)}:{}),{flushSync:vt})}en.forEach(Lt=>{Me.has(Lt.key)&&it(Lt.key),Lt.controller&&Me.set(Lt.key,Lt.controller)});let vn=()=>en.forEach(Lt=>it(Lt.key));Y&&Y.signal.addEventListener("abort",vn);let{results:Vn,loaderResults:ei,fetcherResults:xi}=await je(F.matches,we,fn,en,be);if(be.signal.aborted)return{shortCircuited:!0};Y&&Y.signal.removeEventListener("abort",vn),en.forEach(Lt=>Me.delete(Lt.key));let wi=qU(Vn);if(wi){if(wi.idx>=fn.length){let Lt=en[wi.idx-fn.length].key;me.add(Lt)}return await _e(F,wi.result,{replace:tt}),{shortCircuited:!0}}let{loaderData:pa,errors:na}=jU(F,we,fn,ei,dt,en,xi,Je);Je.forEach((Lt,zt)=>{Lt.subscribe(jt=>{(jt||Lt.done)&&Je.delete(zt)})});let Re=Et(),bt=Ut(ze),Ot=Re||bt||en.length>0;return $r({loaderData:pa,errors:na},Ot?{fetchers:new Map(F.fetchers)}:{})}function Be(be,Qe,we,Te){if(o)throw new Error("router.fetch() was called during the server render, but it shouldn't be. You are likely calling a useFetcher() method in the body of your component. Try moving it to a useEffect or a callback.");Me.has(be)&&it(be);let Ne=(Te&&Te.unstable_flushSync)===!0,et=p||d,tt=kL(F.location,F.matches,f,y.v7_prependBasename,we,Qe,Te==null?void 0:Te.relative),vt=T0(et,tt,f);if(!vt){de(be,Qe,bc(404,{pathname:tt}),{flushSync:Ne});return}let{path:ht,submission:dt,error:Vt}=UU(y.v7_normalizeFormMethod,!0,tt,Te);if(Vt){de(be,Qe,Vt,{flushSync:Ne});return}let It=OL(vt,ht);if(j=(Te&&Te.preventScrollReset)===!0,dt&&ou(dt.formMethod)){ue(be,Qe,ht,It,vt,Ne,dt);return}xe.set(be,{routeId:Qe,path:ht}),se(be,Qe,ht,It,vt,Ne,dt)}async function ue(be,Qe,we,Te,Ne,et,tt){if(De(),xe.delete(be),!Te.route.action&&!Te.route.lazy){let jt=bc(405,{method:tt.formMethod,pathname:we,routeId:Qe});de(be,Qe,jt,{flushSync:et});return}let vt=F.fetchers.get(be);st(be,mce(tt,vt),{flushSync:et});let ht=new AbortController,dt=nb(n.history,we,ht.signal,tt);Me.set(be,ht);let Vt=Ie,It=await tb("action",dt,Te,Ne,l,s,f);if(dt.signal.aborted){Me.get(be)===ht&&Me.delete(be);return}if(Ee.has(be)){st(be,jp(void 0));return}if(U0(It))if(Me.delete(be),ze>Vt){st(be,jp(void 0));return}else return me.add(be),st(be,ib(tt)),_e(F,It,{fetcherSubmission:tt});if(rx(It)){de(be,Qe,It.error);return}if(dg(It))throw bc(400,{type:"defer-action"});let Qt=F.navigation.location||F.location,fn=nb(n.history,Qt,ht.signal),en=p||d,vn=F.navigation.state!=="idle"?T0(en,F.navigation.location,f):F.matches;Ji(vn,"Didn't find any matches after fetcher action");let Vn=++Ie;le.set(be,Vn);let ei=ib(tt,It.data);F.fetchers.set(be,ei);let[xi,wi]=WU(n.history,F,vn,tt,Qt,fe,ye,pe,xe,me,en,f,{[Te.route.id]:It.data},void 0);wi.filter(jt=>jt.key!==be).forEach(jt=>{let gn=jt.key,Xn=F.fetchers.get(gn),rn=ib(void 0,Xn?Xn.data:void 0);F.fetchers.set(gn,rn),Me.has(gn)&&it(gn),jt.controller&&Me.set(gn,jt.controller)}),kt({fetchers:new Map(F.fetchers)});let pa=()=>wi.forEach(jt=>it(jt.key));ht.signal.addEventListener("abort",pa);let{results:na,loaderResults:Re,fetcherResults:bt}=await je(F.matches,vn,xi,wi,fn);if(ht.signal.aborted)return;ht.signal.removeEventListener("abort",pa),le.delete(be),Me.delete(be),wi.forEach(jt=>Me.delete(jt.key));let Ot=qU(na);if(Ot){if(Ot.idx>=xi.length){let jt=wi[Ot.idx-xi.length].key;me.add(jt)}return _e(F,Ot.result)}let{loaderData:Lt,errors:zt}=jU(F,F.matches,xi,Re,void 0,wi,bt,Je);if(F.fetchers.has(be)){let jt=jp(It.data);F.fetchers.set(be,jt)}Ut(Vn),F.navigation.state==="loading"&&Vn>ze?(Ji(G,"Expected pending action"),Y&&Y.abort(),Kt(F.navigation.location,{matches:vn,loaderData:Lt,errors:zt,fetchers:new Map(F.fetchers)})):(kt({errors:zt,loaderData:$U(F.loaderData,Lt,vn,zt),fetchers:new Map(F.fetchers)}),fe=!1)}async function se(be,Qe,we,Te,Ne,et,tt){let vt=F.fetchers.get(be);st(be,ib(tt,vt?vt.data:void 0),{flushSync:et});let ht=new AbortController,dt=nb(n.history,we,ht.signal);Me.set(be,ht);let Vt=Ie,It=await tb("loader",dt,Te,Ne,l,s,f);if(dg(It)&&(It=await PY(It,dt.signal,!0)||It),Me.get(be)===ht&&Me.delete(be),!dt.signal.aborted){if(Ee.has(be)){st(be,jp(void 0));return}if(U0(It))if(ze>Vt){st(be,jp(void 0));return}else{me.add(be),await _e(F,It);return}if(rx(It)){de(be,Qe,It.error);return}Ji(!dg(It),"Unhandled fetcher deferred data"),st(be,jp(It.data))}}async function _e(be,Qe,we){let{submission:Te,fetcherSubmission:Ne,replace:et}=we===void 0?{}:we;Qe.revalidate&&(fe=!0);let tt=$x(be.location,Qe.location,{_isRedirect:!0});if(Ji(tt,"Expected a location on the redirect navigation"),i){let Qt=!1;if(Qe.reloadDocument)Qt=!0;else if(EY.test(Qe.location)){const fn=n.history.createURL(Qe.location);Qt=fn.origin!==e.location.origin||Fw(fn.pathname,f)==null}if(Qt){et?e.location.replace(Qe.location):e.location.assign(Qe.location);return}}Y=null;let vt=et===!0?ro.Replace:ro.Push,{formMethod:ht,formAction:dt,formEncType:Vt}=be.navigation;!Te&&!Ne&&ht&&dt&&Vt&&(Te=ZU(be.navigation));let It=Te||Ne;if(nce.has(Qe.status)&&It&&ou(It.formMethod))await ft(vt,tt,{submission:$r({},It,{formAction:Qe.location}),preventScrollReset:j});else{let Qt=p4(tt,Te);await ft(vt,tt,{overrideNavigation:Qt,fetcherSubmission:Ne,preventScrollReset:j})}}async function je(be,Qe,we,Te,Ne){let et=await Promise.all([...we.map(ht=>tb("loader",Ne,ht,Qe,l,s,f)),...Te.map(ht=>ht.matches&&ht.match&&ht.controller?tb("loader",nb(n.history,ht.path,ht.controller.signal),ht.match,ht.matches,l,s,f):{type:oo.error,error:bc(404,{pathname:ht.path})})]),tt=et.slice(0,we.length),vt=et.slice(we.length);return await Promise.all([XU(be,we,tt,tt.map(()=>Ne.signal),!1,F.loaderData),XU(be,Te.map(ht=>ht.match),vt,Te.map(ht=>ht.controller?ht.controller.signal:null),!0)]),{results:et,loaderResults:tt,fetcherResults:vt}}function De(){fe=!0,ye.push(...Xt()),xe.forEach((be,Qe)=>{Me.has(Qe)&&(pe.push(Qe),it(Qe))})}function st(be,Qe,we){we===void 0&&(we={}),F.fetchers.set(be,Qe),kt({fetchers:new Map(F.fetchers)},{flushSync:(we&&we.flushSync)===!0})}function de(be,Qe,we,Te){Te===void 0&&(Te={});let Ne=ax(F.matches,Qe);Oe(be),kt({errors:{[Ne.route.id]:we},fetchers:new Map(F.fetchers)},{flushSync:(Te&&Te.flushSync)===!0})}function ne(be){return y.v7_fetcherPersist&&(ae.set(be,(ae.get(be)||0)+1),Ee.has(be)&&Ee.delete(be)),F.fetchers.get(be)||ice}function Oe(be){let Qe=F.fetchers.get(be);Me.has(be)&&!(Qe&&Qe.state==="loading"&&le.has(be))&&it(be),xe.delete(be),le.delete(be),me.delete(be),Ee.delete(be),F.fetchers.delete(be)}function ut(be){if(y.v7_fetcherPersist){let Qe=(ae.get(be)||0)-1;Qe<=0?(ae.delete(be),Ee.add(be)):ae.set(be,Qe)}else Oe(be);kt({fetchers:new Map(F.fetchers)})}function it(be){let Qe=Me.get(be);Ji(Qe,"Expected fetch controller: "+be),Qe.abort(),Me.delete(be)}function lt(be){for(let Qe of be){let we=ne(Qe),Te=jp(we.data);F.fetchers.set(Qe,Te)}}function Et(){let be=[],Qe=!1;for(let we of me){let Te=F.fetchers.get(we);Ji(Te,"Expected fetcher: "+we),Te.state==="loading"&&(me.delete(we),be.push(we),Qe=!0)}return lt(be),Qe}function Ut(be){let Qe=[];for(let[we,Te]of le)if(Te<be){let Ne=F.fetchers.get(we);Ji(Ne,"Expected fetcher: "+we),Ne.state==="loading"&&(it(we),le.delete(we),Qe.push(we))}return lt(Qe),Qe.length>0}function Wt(be,Qe){let we=F.blockers.get(be)||eb;return Ze.get(be)!==Qe&&Ze.set(be,Qe),we}function Ht(be){F.blockers.delete(be),Ze.delete(be)}function Dt(be,Qe){let we=F.blockers.get(be)||eb;Ji(we.state==="unblocked"&&Qe.state==="blocked"||we.state==="blocked"&&Qe.state==="blocked"||we.state==="blocked"&&Qe.state==="proceeding"||we.state==="blocked"&&Qe.state==="unblocked"||we.state==="proceeding"&&Qe.state==="unblocked","Invalid blocker state transition: "+we.state+" -> "+Qe.state);let Te=new Map(F.blockers);Te.set(be,Qe),kt({blockers:Te})}function wt(be){let{currentLocation:Qe,nextLocation:we,historyAction:Te}=be;if(Ze.size===0)return;Ze.size>1&&bf(!1,"A router only supports one blocker at a time");let Ne=Array.from(Ze.entries()),[et,tt]=Ne[Ne.length-1],vt=F.blockers.get(et);if(!(vt&&vt.state==="proceeding")&&tt({currentLocation:Qe,nextLocation:we,historyAction:Te}))return et}function Xt(be){let Qe=[];return Je.forEach((we,Te)=>{(!be||be(Te))&&(we.cancel(),Qe.push(Te),Je.delete(Te))}),Qe}function He(be,Qe,we){if(S=be,I=Qe,T=we||null,!R&&F.navigation===h4){R=!0;let Te=Nt(F.location,F.matches);Te!=null&&kt({restoreScrollPosition:Te})}return()=>{S=null,I=null,T=null}}function Pt(be,Qe){return T&&T(be,Qe.map(Te=>Rle(Te,F.loaderData)))||be.key}function qt(be,Qe){if(S&&I){let we=Pt(be,Qe);S[we]=I()}}function Nt(be,Qe){if(S){let we=Pt(be,Qe),Te=S[we];if(typeof Te=="number")return Te}return null}function hn(be){l={},p=RL(be,s,void 0,l)}return N={get basename(){return f},get state(){return F},get routes(){return d},get window(){return e},initialize:Fe,subscribe:Ct,enableScrollRestoration:He,navigate:At,fetch:Be,revalidate:Pe,createHref:be=>n.history.createHref(be),encodeLocation:be=>n.history.encodeLocation(be),getFetcher:ne,deleteFetcher:ut,dispose:ct,getBlocker:Wt,deleteBlocker:Ht,_internalFetchControllers:Me,_internalActiveDeferreds:Je,_internalSetRoutes:hn},N}function oce(n){return n!=null&&("formData"in n&&n.formData!=null||"body"in n&&n.body!==void 0)}function kL(n,e,i,o,s,l,d){let p,f;if(l){p=[];for(let _ of e)if(p.push(_),_.route.id===l){f=_;break}}else p=e,f=e[e.length-1];let y=wY(s||".",iD(p).map(_=>_.pathnameBase),Fw(n.pathname,i)||n.pathname,d==="path");return s==null&&(y.search=n.search,y.hash=n.hash),(s==null||s===""||s===".")&&f&&f.route.index&&!rD(y.search)&&(y.search=y.search?y.search.replace(/^\?/,"?index&"):"?index"),o&&i!=="/"&&(y.pathname=y.pathname==="/"?i:pf([i,y.pathname])),zw(y)}function UU(n,e,i,o){if(!o||!oce(o))return{path:i};if(o.formMethod&&!pce(o.formMethod))return{path:i,error:bc(405,{method:o.formMethod})};let s=()=>({path:i,error:bc(400,{type:"invalid-body"})}),l=o.formMethod||"get",d=n?l.toUpperCase():l.toLowerCase(),p=CY(i);if(o.body!==void 0){if(o.formEncType==="text/plain"){if(!ou(d))return s();let S=typeof o.body=="string"?o.body:o.body instanceof FormData||o.body instanceof URLSearchParams?Array.from(o.body.entries()).reduce((T,I)=>{let[R,D]=I;return""+T+R+"="+D+`
`},""):String(o.body);return{path:i,submission:{formMethod:d,formAction:p,formEncType:o.formEncType,formData:void 0,json:void 0,text:S}}}else if(o.formEncType==="application/json"){if(!ou(d))return s();try{let S=typeof o.body=="string"?JSON.parse(o.body):o.body;return{path:i,submission:{formMethod:d,formAction:p,formEncType:o.formEncType,formData:void 0,json:S,text:void 0}}}catch{return s()}}}Ji(typeof FormData=="function","FormData is not available in this environment");let f,y;if(o.formData)f=DL(o.formData),y=o.formData;else if(o.body instanceof FormData)f=DL(o.body),y=o.body;else if(o.body instanceof URLSearchParams)f=o.body,y=HU(f);else if(o.body==null)f=new URLSearchParams,y=new FormData;else try{f=new URLSearchParams(o.body),y=HU(f)}catch{return s()}let _={formMethod:d,formAction:p,formEncType:o&&o.formEncType||"application/x-www-form-urlencoded",formData:y,json:void 0,text:void 0};if(ou(_.formMethod))return{path:i,submission:_};let x=Md(i);return e&&x.search&&rD(x.search)&&f.append("index",""),x.search="?"+f,{path:zw(x),submission:_}}function sce(n,e){let i=n;if(e){let o=n.findIndex(s=>s.route.id===e);o>=0&&(i=n.slice(0,o))}return i}function WU(n,e,i,o,s,l,d,p,f,y,_,x,S,T){let I=T?Object.values(T)[0]:S?Object.values(S)[0]:void 0,R=n.createURL(e.location),D=n.createURL(s),L=T?Object.keys(T)[0]:void 0,N=sce(i,L).filter((G,j)=>{if(G.route.lazy)return!0;if(G.route.loader==null)return!1;if(lce(e.loaderData,e.matches[j],G)||d.some(V=>V===G.route.id))return!0;let Y=e.matches[j],te=G;return VU(G,$r({currentUrl:R,currentParams:Y.params,nextUrl:D,nextParams:te.params},o,{actionResult:I,defaultShouldRevalidate:l||R.pathname+R.search===D.pathname+D.search||R.search!==D.search||TY(Y,te)}))}),F=[];return f.forEach((G,j)=>{if(!i.some(he=>he.route.id===G.routeId))return;let Y=T0(_,G.path,x);if(!Y){F.push({key:j,routeId:G.routeId,path:G.path,matches:null,match:null,controller:null});return}let te=e.fetchers.get(j),V=OL(Y,G.path),Q=!1;y.has(j)?Q=!1:p.includes(j)?Q=!0:te&&te.state!=="idle"&&te.data===void 0?Q=l:Q=VU(V,$r({currentUrl:R,currentParams:e.matches[e.matches.length-1].params,nextUrl:D,nextParams:i[i.length-1].params},o,{actionResult:I,defaultShouldRevalidate:l})),Q&&F.push({key:j,routeId:G.routeId,path:G.path,matches:Y,match:V,controller:new AbortController})}),[N,F]}function lce(n,e,i){let o=!e||i.route.id!==e.route.id,s=n[i.route.id]===void 0;return o||s}function TY(n,e){let i=n.route.path;return n.pathname!==e.pathname||i!=null&&i.endsWith("*")&&n.params["*"]!==e.params["*"]}function VU(n,e){if(n.route.shouldRevalidate){let i=n.route.shouldRevalidate(e);if(typeof i=="boolean")return i}return e.defaultShouldRevalidate}async function GU(n,e,i){if(!n.lazy)return;let o=await n.lazy();if(!n.lazy)return;let s=i[n.id];Ji(s,"No route found in manifest");let l={};for(let d in o){let f=s[d]!==void 0&&d!=="hasErrorBoundary";bf(!f,'Route "'+s.id+'" has a static property "'+d+'" defined but its lazy function is also returning a value for this property. '+('The lazy route property "'+d+'" will be ignored.')),!f&&!Ile.has(d)&&(l[d]=o[d])}Object.assign(s,l),Object.assign(s,$r({},e(s),{lazy:void 0}))}async function tb(n,e,i,o,s,l,d,p){p===void 0&&(p={});let f,y,_,x=I=>{let R,D=new Promise((L,O)=>R=O);return _=()=>R(),e.signal.addEventListener("abort",_),Promise.race([I({request:e,params:i.params,context:p.requestContext}),D])};try{let I=i.route[n];if(i.route.lazy)if(I){let R,D=await Promise.all([x(I).catch(L=>{R=L}),GU(i.route,l,s)]);if(R)throw R;y=D[0]}else if(await GU(i.route,l,s),I=i.route[n],I)y=await x(I);else if(n==="action"){let R=new URL(e.url),D=R.pathname+R.search;throw bc(405,{method:e.method,pathname:D,routeId:i.route.id})}else return{type:oo.data,data:void 0};else if(I)y=await x(I);else{let R=new URL(e.url),D=R.pathname+R.search;throw bc(404,{pathname:D})}Ji(y!==void 0,"You defined "+(n==="action"?"an action":"a loader")+" for route "+('"'+i.route.id+"\" but didn't return anything from your `"+n+"` ")+"function. Please return a value or `null`.")}catch(I){f=oo.error,y=I}finally{_&&e.signal.removeEventListener("abort",_)}if(hce(y)){let I=y.status;if(tce.has(I)){let L=y.headers.get("Location");if(Ji(L,"Redirects returned/thrown from loaders/actions must have a Location header"),!EY.test(L))L=kL(new URL(e.url),o.slice(0,o.indexOf(i)+1),d,!0,L);else if(!p.isStaticRequest){let O=new URL(e.url),N=L.startsWith("//")?new URL(O.protocol+L):new URL(L),F=Fw(N.pathname,d)!=null;N.origin===O.origin&&F&&(L=N.pathname+N.search+N.hash)}if(p.isStaticRequest)throw y.headers.set("Location",L),y;return{type:oo.redirect,status:I,location:L,revalidate:y.headers.get("X-Remix-Revalidate")!==null,reloadDocument:y.headers.get("X-Remix-Reload-Document")!==null}}if(p.isRouteRequest)throw{type:f===oo.error?oo.error:oo.data,response:y};let R,D=y.headers.get("Content-Type");return D&&/\bapplication\/json\b/.test(D)?R=await y.json():R=await y.text(),f===oo.error?{type:f,error:new aD(I,y.statusText,R),headers:y.headers}:{type:oo.data,data:R,statusCode:y.status,headers:y.headers}}if(f===oo.error)return{type:f,error:y};if(dce(y)){var S,T;return{type:oo.deferred,deferredData:y,statusCode:(S=y.init)==null?void 0:S.status,headers:((T=y.init)==null?void 0:T.headers)&&new Headers(y.init.headers)}}return{type:oo.data,data:y}}function nb(n,e,i,o){let s=n.createURL(CY(e)).toString(),l={signal:i};if(o&&ou(o.formMethod)){let{formMethod:d,formEncType:p}=o;l.method=d.toUpperCase(),p==="application/json"?(l.headers=new Headers({"Content-Type":p}),l.body=JSON.stringify(o.json)):p==="text/plain"?l.body=o.text:p==="application/x-www-form-urlencoded"&&o.formData?l.body=DL(o.formData):l.body=o.formData}return new Request(s,l)}function DL(n){let e=new URLSearchParams;for(let[i,o]of n.entries())e.append(i,typeof o=="string"?o:o.name);return e}function HU(n){let e=new FormData;for(let[i,o]of n.entries())e.append(i,o);return e}function cce(n,e,i,o,s){let l={},d=null,p,f=!1,y={};return i.forEach((_,x)=>{let S=e[x].route.id;if(Ji(!U0(_),"Cannot handle redirect results in processLoaderData"),rx(_)){let T=ax(n,S),I=_.error;o&&(I=Object.values(o)[0],o=void 0),d=d||{},d[T.route.id]==null&&(d[T.route.id]=I),l[S]=void 0,f||(f=!0,p=SY(_.error)?_.error.status:500),_.headers&&(y[S]=_.headers)}else dg(_)?(s.set(S,_.deferredData),l[S]=_.deferredData.data):l[S]=_.data,_.statusCode!=null&&_.statusCode!==200&&!f&&(p=_.statusCode),_.headers&&(y[S]=_.headers)}),o&&(d=o,l[Object.keys(o)[0]]=void 0),{loaderData:l,errors:d,statusCode:p||200,loaderHeaders:y}}function jU(n,e,i,o,s,l,d,p){let{loaderData:f,errors:y}=cce(e,i,o,s,p);for(let _=0;_<l.length;_++){let{key:x,match:S,controller:T}=l[_];Ji(d!==void 0&&d[_]!==void 0,"Did not find corresponding fetcher result");let I=d[_];if(!(T&&T.signal.aborted))if(rx(I)){let R=ax(n.matches,S==null?void 0:S.route.id);y&&y[R.route.id]||(y=$r({},y,{[R.route.id]:I.error})),n.fetchers.delete(x)}else if(U0(I))Ji(!1,"Unhandled fetcher revalidation redirect");else if(dg(I))Ji(!1,"Unhandled fetcher deferred data");else{let R=jp(I.data);n.fetchers.set(x,R)}}return{loaderData:f,errors:y}}function $U(n,e,i,o){let s=$r({},e);for(let l of i){let d=l.route.id;if(e.hasOwnProperty(d)?e[d]!==void 0&&(s[d]=e[d]):n[d]!==void 0&&l.route.loader&&(s[d]=n[d]),o&&o.hasOwnProperty(d))break}return s}function ax(n,e){return(e?n.slice(0,n.findIndex(o=>o.route.id===e)+1):[...n]).reverse().find(o=>o.route.hasErrorBoundary===!0)||n[0]}function YU(n){let e=n.length===1?n[0]:n.find(i=>i.index||!i.path||i.path==="/")||{id:"__shim-error-route__"};return{matches:[{params:{},pathname:"",pathnameBase:"",route:e}],route:e}}function bc(n,e){let{pathname:i,routeId:o,method:s,type:l}=e===void 0?{}:e,d="Unknown Server Error",p="Unknown @remix-run/router error";return n===400?(d="Bad Request",s&&i&&o?p="You made a "+s+' request to "'+i+'" but '+('did not provide a `loader` for route "'+o+'", ')+"so there is no way to handle the request.":l==="defer-action"?p="defer() is not supported in actions":l==="invalid-body"&&(p="Unable to encode submission body")):n===403?(d="Forbidden",p='Route "'+o+'" does not match URL "'+i+'"'):n===404?(d="Not Found",p='No route matches URL "'+i+'"'):n===405&&(d="Method Not Allowed",s&&i&&o?p="You made a "+s.toUpperCase()+' request to "'+i+'" but '+('did not provide an `action` for route "'+o+'", ')+"so there is no way to handle the request.":s&&(p='Invalid request method "'+s.toUpperCase()+'"')),new aD(n||500,d,new Error(p),!0)}function qU(n){for(let e=n.length-1;e>=0;e--){let i=n[e];if(U0(i))return{result:i,idx:e}}}function CY(n){let e=typeof n=="string"?Md(n):n;return zw($r({},e,{hash:""}))}function uce(n,e){return n.pathname!==e.pathname||n.search!==e.search?!1:n.hash===""?e.hash!=="":n.hash===e.hash?!0:e.hash!==""}function dg(n){return n.type===oo.deferred}function rx(n){return n.type===oo.error}function U0(n){return(n&&n.type)===oo.redirect}function dce(n){let e=n;return e&&typeof e=="object"&&typeof e.data=="object"&&typeof e.subscribe=="function"&&typeof e.cancel=="function"&&typeof e.resolveData=="function"}function hce(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.headers=="object"&&typeof n.body<"u"}function pce(n){return ece.has(n.toLowerCase())}function ou(n){return Jle.has(n.toLowerCase())}async function XU(n,e,i,o,s,l){for(let d=0;d<i.length;d++){let p=i[d],f=e[d];if(!f)continue;let y=n.find(x=>x.route.id===f.route.id),_=y!=null&&!TY(y,f)&&(l&&l[f.route.id])!==void 0;if(dg(p)&&(s||_)){let x=o[d];Ji(x,"Expected an AbortSignal for revalidating fetcher deferred result"),await PY(p,x,s).then(S=>{S&&(i[d]=S||i[d])})}}}async function PY(n,e,i){if(i===void 0&&(i=!1),!await n.deferredData.resolveData(e)){if(i)try{return{type:oo.data,data:n.deferredData.unwrappedData}}catch(s){return{type:oo.error,error:s}}return{type:oo.data,data:n.deferredData.data}}}function rD(n){return new URLSearchParams(n).getAll("index").some(e=>e==="")}function OL(n,e){let i=typeof e=="string"?Md(e).search:e.search;if(n[n.length-1].route.index&&rD(i||""))return n[n.length-1];let o=iD(n);return o[o.length-1]}function ZU(n){let{formMethod:e,formAction:i,formEncType:o,text:s,formData:l,json:d}=n;if(!(!e||!i||!o)){if(s!=null)return{formMethod:e,formAction:i,formEncType:o,formData:void 0,json:void 0,text:s};if(l!=null)return{formMethod:e,formAction:i,formEncType:o,formData:l,json:void 0,text:void 0};if(d!==void 0)return{formMethod:e,formAction:i,formEncType:o,formData:void 0,json:d,text:void 0}}}function p4(n,e){return e?{state:"loading",location:n,formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text}:{state:"loading",location:n,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0}}function fce(n,e){return{state:"submitting",location:n,formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text}}function ib(n,e){return n?{state:"loading",formMethod:n.formMethod,formAction:n.formAction,formEncType:n.formEncType,formData:n.formData,json:n.json,text:n.text,data:e}:{state:"loading",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:e}}function mce(n,e){return{state:"submitting",formMethod:n.formMethod,formAction:n.formAction,formEncType:n.formEncType,formData:n.formData,json:n.json,text:n.text,data:e?e.data:void 0}}function jp(n){return{state:"idle",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:n}}function gce(n,e){try{let i=n.sessionStorage.getItem(MY);if(i){let o=JSON.parse(i);for(let[s,l]of Object.entries(o||{}))l&&Array.isArray(l)&&e.set(s,new Set(l||[]))}}catch{}}function yce(n,e){if(e.size>0){let i={};for(let[o,s]of e)i[o]=[...s];try{n.sessionStorage.setItem(MY,JSON.stringify(i))}catch(o){bf(!1,"Failed to save applied view transitions in sessionStorage ("+o+").")}}}/**
 * React Router v6.19.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function YE(){return YE=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(n[o]=i[o])}return n},YE.apply(this,arguments)}const FM=ie.createContext(null),IY=ie.createContext(null),BM=ie.createContext(null),UM=ie.createContext(null),Xg=ie.createContext({outlet:null,matches:[],isDataRoute:!1}),LY=ie.createContext(null);function WM(){return ie.useContext(UM)!=null}function RY(){return WM()||Ji(!1),ie.useContext(UM).location}function kY(n){ie.useContext(BM).static||ie.useLayoutEffect(n)}function vu(){let{isDataRoute:n}=ie.useContext(Xg);return n?Pce():vce()}function vce(){WM()||Ji(!1);let n=ie.useContext(FM),{basename:e,navigator:i}=ie.useContext(BM),{matches:o}=ie.useContext(Xg),{pathname:s}=RY(),l=JSON.stringify(iD(o).map(f=>f.pathnameBase)),d=ie.useRef(!1);return kY(()=>{d.current=!0}),ie.useCallback(function(f,y){if(y===void 0&&(y={}),!d.current)return;if(typeof f=="number"){i.go(f);return}let _=wY(f,JSON.parse(l),s,y.relative==="path");n==null&&e!=="/"&&(_.pathname=_.pathname==="/"?e:pf([e,_.pathname])),(y.replace?i.replace:i.push)(_,y.state,y)},[e,i,l,s,n])}function DY(){let{matches:n}=ie.useContext(Xg),e=n[n.length-1];return e?e.params:{}}function _ce(n,e,i){WM()||Ji(!1);let{navigator:o}=ie.useContext(BM),{matches:s}=ie.useContext(Xg),l=s[s.length-1],d=l?l.params:{};l&&l.pathname;let p=l?l.pathnameBase:"/";l&&l.route;let f=RY(),y;if(e){var _;let R=typeof e=="string"?Md(e):e;p==="/"||(_=R.pathname)!=null&&_.startsWith(p)||Ji(!1),y=R}else y=f;let x=y.pathname||"/",S=p==="/"?x:x.slice(p.length)||"/",T=T0(n,{pathname:S}),I=Ace(T&&T.map(R=>Object.assign({},R,{params:Object.assign({},d,R.params),pathname:pf([p,o.encodeLocation?o.encodeLocation(R.pathname).pathname:R.pathname]),pathnameBase:R.pathnameBase==="/"?p:pf([p,o.encodeLocation?o.encodeLocation(R.pathnameBase).pathname:R.pathnameBase])})),s,i);return e&&I?ie.createElement(UM.Provider,{value:{location:YE({pathname:"/",search:"",hash:"",state:null,key:"default"},y),navigationType:ro.Pop}},I):I}function bce(){let n=Cce(),e=SY(n)?n.status+" "+n.statusText:n instanceof Error?n.message:JSON.stringify(n),i=n instanceof Error?n.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"},l=null;return ie.createElement(ie.Fragment,null,ie.createElement("h2",null,"Unexpected Application Error!"),ie.createElement("h3",{style:{fontStyle:"italic"}},e),i?ie.createElement("pre",{style:s},i):null,l)}const xce=ie.createElement(bce,null);class wce extends ie.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,i){return i.location!==e.location||i.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error||i.error,location:i.location,revalidation:e.revalidation||i.revalidation}}componentDidCatch(e,i){console.error("React Router caught the following error during render",e,i)}render(){return this.state.error?ie.createElement(Xg.Provider,{value:this.props.routeContext},ie.createElement(LY.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function Sce(n){let{routeContext:e,match:i,children:o}=n,s=ie.useContext(FM);return s&&s.static&&s.staticContext&&(i.route.errorElement||i.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=i.route.id),ie.createElement(Xg.Provider,{value:e},o)}function Ace(n,e,i){var o;if(e===void 0&&(e=[]),i===void 0&&(i=null),n==null){var s;if((s=i)!=null&&s.errors)n=i.matches;else return null}let l=n,d=(o=i)==null?void 0:o.errors;if(d!=null){let p=l.findIndex(f=>f.route.id&&(d==null?void 0:d[f.route.id]));p>=0||Ji(!1),l=l.slice(0,Math.min(l.length,p+1))}return l.reduceRight((p,f,y)=>{let _=f.route.id?d==null?void 0:d[f.route.id]:null,x=null;i&&(x=f.route.errorElement||xce);let S=e.concat(l.slice(0,y+1)),T=()=>{let I;return _?I=x:f.route.Component?I=ie.createElement(f.route.Component,null):f.route.element?I=f.route.element:I=p,ie.createElement(Sce,{match:f,routeContext:{outlet:p,matches:S,isDataRoute:i!=null},children:I})};return i&&(f.route.ErrorBoundary||f.route.errorElement||y===0)?ie.createElement(wce,{location:i.location,revalidation:i.revalidation,component:x,error:_,children:T(),routeContext:{outlet:null,matches:S,isDataRoute:!0}}):T()},null)}var OY=function(n){return n.UseBlocker="useBlocker",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n}(OY||{}),qE=function(n){return n.UseBlocker="useBlocker",n.UseLoaderData="useLoaderData",n.UseActionData="useActionData",n.UseRouteError="useRouteError",n.UseNavigation="useNavigation",n.UseRouteLoaderData="useRouteLoaderData",n.UseMatches="useMatches",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n.UseRouteId="useRouteId",n}(qE||{});function Ece(n){let e=ie.useContext(FM);return e||Ji(!1),e}function Mce(n){let e=ie.useContext(IY);return e||Ji(!1),e}function Tce(n){let e=ie.useContext(Xg);return e||Ji(!1),e}function NY(n){let e=Tce(),i=e.matches[e.matches.length-1];return i.route.id||Ji(!1),i.route.id}function Cce(){var n;let e=ie.useContext(LY),i=Mce(qE.UseRouteError),o=NY(qE.UseRouteError);return e||((n=i.errors)==null?void 0:n[o])}function Pce(){let{router:n}=Ece(OY.UseNavigateStable),e=NY(qE.UseNavigateStable),i=ie.useRef(!1);return kY(()=>{i.current=!0}),ie.useCallback(function(s,l){l===void 0&&(l={}),i.current&&(typeof s=="number"?n.navigate(s):n.navigate(s,YE({fromRouteId:e},l)))},[n,e])}function Ice(n){let{basename:e="/",children:i=null,location:o,navigationType:s=ro.Pop,navigator:l,static:d=!1}=n;WM()&&Ji(!1);let p=e.replace(/^\/*/,"/"),f=ie.useMemo(()=>({basename:p,navigator:l,static:d}),[p,l,d]);typeof o=="string"&&(o=Md(o));let{pathname:y="/",search:_="",hash:x="",state:S=null,key:T="default"}=o,I=ie.useMemo(()=>{let R=Fw(y,p);return R==null?null:{location:{pathname:R,search:_,hash:x,state:S,key:T},navigationType:s}},[p,y,_,x,S,T,s]);return I==null?null:ie.createElement(BM.Provider,{value:f},ie.createElement(UM.Provider,{children:i,value:I}))}new Promise(()=>{});function Lce(n){let e={hasErrorBoundary:n.ErrorBoundary!=null||n.errorElement!=null};return n.Component&&Object.assign(e,{element:ie.createElement(n.Component),Component:void 0}),n.ErrorBoundary&&Object.assign(e,{errorElement:ie.createElement(n.ErrorBoundary),ErrorBoundary:void 0}),e}/**
 * React Router DOM v6.19.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function XE(){return XE=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(n[o]=i[o])}return n},XE.apply(this,arguments)}function Rce(n,e){return rce({basename:e==null?void 0:e.basename,future:XE({},e==null?void 0:e.future,{v7_prependBasename:!0}),history:Tle({window:e==null?void 0:e.window}),hydrationData:(e==null?void 0:e.hydrationData)||kce(),routes:n,mapRouteProperties:Lce,window:e==null?void 0:e.window}).initialize()}function kce(){var n;let e=(n=window)==null?void 0:n.__staticRouterHydrationData;return e&&e.errors&&(e=XE({},e,{errors:Dce(e.errors)})),e}function Dce(n){if(!n)return null;let e=Object.entries(n),i={};for(let[o,s]of e)if(s&&s.__type==="RouteErrorResponse")i[o]=new aD(s.status,s.statusText,s.data,s.internal===!0);else if(s&&s.__type==="Error"){if(s.__subType){let l=window[s.__subType];if(typeof l=="function")try{let d=new l(s.message);d.stack="",i[o]=d}catch{}}if(i[o]==null){let l=new Error(s.message);l.stack="",i[o]=l}}else i[o]=s;return i}const Oce=ie.createContext({isTransitioning:!1}),Nce=ie.createContext(new Map),zce="startTransition",KU=wE[zce],Fce="flushSync",JU=Mle[Fce];function Bce(n){KU?KU(n):n()}function ab(n){JU?JU(n):n()}class Uce{constructor(){this.status="pending",this.promise=new Promise((e,i)=>{this.resolve=o=>{this.status==="pending"&&(this.status="resolved",e(o))},this.reject=o=>{this.status==="pending"&&(this.status="rejected",i(o))}})}}function Wce(n){let{fallbackElement:e,router:i,future:o}=n,[s,l]=ie.useState(i.state),[d,p]=ie.useState(),[f,y]=ie.useState({isTransitioning:!1}),[_,x]=ie.useState(),[S,T]=ie.useState(),[I,R]=ie.useState(),D=ie.useRef(new Map),{v7_startTransition:L}=o||{},O=ie.useCallback(Y=>{L?Bce(Y):Y()},[L]),N=ie.useCallback((Y,te)=>{let{deletedFetchers:V,unstable_flushSync:Q,unstable_viewTransitionOpts:he}=te;V.forEach(ye=>D.current.delete(ye)),Y.fetchers.forEach((ye,pe)=>{ye.data!==void 0&&D.current.set(pe,ye.data)});let fe=i.window==null||typeof i.window.document.startViewTransition!="function";if(!he||fe){Q?ab(()=>l(Y)):O(()=>l(Y));return}if(Q){ab(()=>{S&&(_&&_.resolve(),S.skipTransition()),y({isTransitioning:!0,flushSync:!0,currentLocation:he.currentLocation,nextLocation:he.nextLocation})});let ye=i.window.document.startViewTransition(()=>{ab(()=>l(Y))});ye.finished.finally(()=>{ab(()=>{x(void 0),T(void 0),p(void 0),y({isTransitioning:!1})})}),ab(()=>T(ye));return}S?(_&&_.resolve(),S.skipTransition(),R({state:Y,currentLocation:he.currentLocation,nextLocation:he.nextLocation})):(p(Y),y({isTransitioning:!0,flushSync:!1,currentLocation:he.currentLocation,nextLocation:he.nextLocation}))},[i.window,S,_,D,O]);ie.useLayoutEffect(()=>i.subscribe(N),[i,N]),ie.useEffect(()=>{f.isTransitioning&&!f.flushSync&&x(new Uce)},[f]),ie.useEffect(()=>{if(_&&d&&i.window){let Y=d,te=_.promise,V=i.window.document.startViewTransition(async()=>{O(()=>l(Y)),await te});V.finished.finally(()=>{x(void 0),T(void 0),p(void 0),y({isTransitioning:!1})}),T(V)}},[O,d,_,i.window]),ie.useEffect(()=>{_&&d&&s.location.key===d.location.key&&_.resolve()},[_,S,s.location,d]),ie.useEffect(()=>{!f.isTransitioning&&I&&(p(I.state),y({isTransitioning:!0,flushSync:!1,currentLocation:I.currentLocation,nextLocation:I.nextLocation}),R(void 0))},[f.isTransitioning,I]);let F=ie.useMemo(()=>({createHref:i.createHref,encodeLocation:i.encodeLocation,go:Y=>i.navigate(Y),push:(Y,te,V)=>i.navigate(Y,{state:te,preventScrollReset:V==null?void 0:V.preventScrollReset}),replace:(Y,te,V)=>i.navigate(Y,{replace:!0,state:te,preventScrollReset:V==null?void 0:V.preventScrollReset})}),[i]),G=i.basename||"/",j=ie.useMemo(()=>({router:i,navigator:F,static:!1,basename:G}),[i,F,G]);return ie.createElement(ie.Fragment,null,ie.createElement(FM.Provider,{value:j},ie.createElement(IY.Provider,{value:s},ie.createElement(Nce.Provider,{value:D.current},ie.createElement(Oce.Provider,{value:f},ie.createElement(Ice,{basename:G,location:s.location,navigationType:s.historyAction,navigator:F},s.initialized?ie.createElement(Vce,{routes:i.routes,state:s}):e))))),null)}function Vce(n){let{routes:e,state:i}=n;return _ce(e,void 0,i)}var QU;(function(n){n.UseScrollRestoration="useScrollRestoration",n.UseSubmit="useSubmit",n.UseSubmitFetcher="useSubmitFetcher",n.UseFetcher="useFetcher",n.useViewTransitionState="useViewTransitionState"})(QU||(QU={}));var e7;(function(n){n.UseFetcher="useFetcher",n.UseFetchers="useFetchers",n.UseScrollRestoration="useScrollRestoration"})(e7||(e7={}));const Gce={black:"#000",white:"#fff"},Yx=Gce,Hce={50:"#ffebee",100:"#ffcdd2",200:"#ef9a9a",300:"#e57373",400:"#ef5350",500:"#f44336",600:"#e53935",700:"#d32f2f",800:"#c62828",900:"#b71c1c",A100:"#ff8a80",A200:"#ff5252",A400:"#ff1744",A700:"#d50000"},Lv=Hce,jce={50:"#f3e5f5",100:"#e1bee7",200:"#ce93d8",300:"#ba68c8",400:"#ab47bc",500:"#9c27b0",600:"#8e24aa",700:"#7b1fa2",800:"#6a1b9a",900:"#4a148c",A100:"#ea80fc",A200:"#e040fb",A400:"#d500f9",A700:"#aa00ff"},Rv=jce,$ce={50:"#e3f2fd",100:"#bbdefb",200:"#90caf9",300:"#64b5f6",400:"#42a5f5",500:"#2196f3",600:"#1e88e5",700:"#1976d2",800:"#1565c0",900:"#0d47a1",A100:"#82b1ff",A200:"#448aff",A400:"#2979ff",A700:"#2962ff"},kv=$ce,Yce={50:"#e1f5fe",100:"#b3e5fc",200:"#81d4fa",300:"#4fc3f7",400:"#29b6f6",500:"#03a9f4",600:"#039be5",700:"#0288d1",800:"#0277bd",900:"#01579b",A100:"#80d8ff",A200:"#40c4ff",A400:"#00b0ff",A700:"#0091ea"},Dv=Yce,qce={50:"#e8f5e9",100:"#c8e6c9",200:"#a5d6a7",300:"#81c784",400:"#66bb6a",500:"#4caf50",600:"#43a047",700:"#388e3c",800:"#2e7d32",900:"#1b5e20",A100:"#b9f6ca",A200:"#69f0ae",A400:"#00e676",A700:"#00c853"},Ov=qce,Xce={50:"#fff3e0",100:"#ffe0b2",200:"#ffcc80",300:"#ffb74d",400:"#ffa726",500:"#ff9800",600:"#fb8c00",700:"#f57c00",800:"#ef6c00",900:"#e65100",A100:"#ffd180",A200:"#ffab40",A400:"#ff9100",A700:"#ff6d00"},rb=Xce,Zce={50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121",A100:"#f5f5f5",A200:"#eeeeee",A400:"#bdbdbd",A700:"#616161"},Kce=Zce;function qe(){return qe=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(n[o]=i[o])}return n},qe.apply(this,arguments)}function Mh(n){return n!==null&&typeof n=="object"&&n.constructor===Object}function zY(n){if(!Mh(n))return n;const e={};return Object.keys(n).forEach(i=>{e[i]=zY(n[i])}),e}function wl(n,e,i={clone:!0}){const o=i.clone?qe({},n):n;return Mh(n)&&Mh(e)&&Object.keys(e).forEach(s=>{s!=="__proto__"&&(Mh(e[s])&&s in n&&Mh(n[s])?o[s]=wl(n[s],e[s],i):i.clone?o[s]=Mh(e[s])?zY(e[s]):e[s]:o[s]=e[s])}),o}function xf(n){let e="https://mui.com/production-error/?code="+n;for(let i=1;i<arguments.length;i+=1)e+="&args[]="+encodeURIComponent(arguments[i]);return"Minified MUI error #"+n+"; visit "+e+" for the full message."}var Ha={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var oD=Symbol.for("react.element"),sD=Symbol.for("react.portal"),VM=Symbol.for("react.fragment"),GM=Symbol.for("react.strict_mode"),HM=Symbol.for("react.profiler"),jM=Symbol.for("react.provider"),$M=Symbol.for("react.context"),Jce=Symbol.for("react.server_context"),YM=Symbol.for("react.forward_ref"),qM=Symbol.for("react.suspense"),XM=Symbol.for("react.suspense_list"),ZM=Symbol.for("react.memo"),KM=Symbol.for("react.lazy"),Qce=Symbol.for("react.offscreen"),FY;FY=Symbol.for("react.module.reference");function Lc(n){if(typeof n=="object"&&n!==null){var e=n.$$typeof;switch(e){case oD:switch(n=n.type,n){case VM:case HM:case GM:case qM:case XM:return n;default:switch(n=n&&n.$$typeof,n){case Jce:case $M:case YM:case KM:case ZM:case jM:return n;default:return e}}case sD:return e}}}Ha.ContextConsumer=$M;Ha.ContextProvider=jM;Ha.Element=oD;Ha.ForwardRef=YM;Ha.Fragment=VM;Ha.Lazy=KM;Ha.Memo=ZM;Ha.Portal=sD;Ha.Profiler=HM;Ha.StrictMode=GM;Ha.Suspense=qM;Ha.SuspenseList=XM;Ha.isAsyncMode=function(){return!1};Ha.isConcurrentMode=function(){return!1};Ha.isContextConsumer=function(n){return Lc(n)===$M};Ha.isContextProvider=function(n){return Lc(n)===jM};Ha.isElement=function(n){return typeof n=="object"&&n!==null&&n.$$typeof===oD};Ha.isForwardRef=function(n){return Lc(n)===YM};Ha.isFragment=function(n){return Lc(n)===VM};Ha.isLazy=function(n){return Lc(n)===KM};Ha.isMemo=function(n){return Lc(n)===ZM};Ha.isPortal=function(n){return Lc(n)===sD};Ha.isProfiler=function(n){return Lc(n)===HM};Ha.isStrictMode=function(n){return Lc(n)===GM};Ha.isSuspense=function(n){return Lc(n)===qM};Ha.isSuspenseList=function(n){return Lc(n)===XM};Ha.isValidElementType=function(n){return typeof n=="string"||typeof n=="function"||n===VM||n===HM||n===GM||n===qM||n===XM||n===Qce||typeof n=="object"&&n!==null&&(n.$$typeof===KM||n.$$typeof===ZM||n.$$typeof===jM||n.$$typeof===$M||n.$$typeof===YM||n.$$typeof===FY||n.getModuleId!==void 0)};Ha.typeOf=Lc;function ai(n){if(typeof n!="string")throw new Error(xf(7));return n.charAt(0).toUpperCase()+n.slice(1)}function NL(...n){return n.reduce((e,i)=>i==null?e:function(...s){e.apply(this,s),i.apply(this,s)},()=>{})}function JM(n,e=166){let i;function o(...s){const l=()=>{n.apply(this,s)};clearTimeout(i),i=setTimeout(l,e)}return o.clear=()=>{clearTimeout(i)},o}function eue(n,e){return()=>null}function QA(n,e){var i,o;return ie.isValidElement(n)&&e.indexOf((i=n.type.muiName)!=null?i:(o=n.type)==null||(o=o._payload)==null||(o=o.value)==null?void 0:o.muiName)!==-1}function ws(n){return n&&n.ownerDocument||document}function bd(n){return ws(n).defaultView||window}function tue(n,e){return()=>null}function ZE(n,e){typeof n=="function"?n(e):n&&(n.current=e)}const nue=typeof window<"u"?ie.useLayoutEffect:ie.useEffect,gu=nue;let t7=0;function iue(n){const[e,i]=ie.useState(n),o=n||e;return ie.useEffect(()=>{e==null&&(t7+=1,i(`mui-${t7}`))},[e]),o}const n7=wE["useId".toString()];function lD(n){if(n7!==void 0){const e=n7();return n??e}return iue(n)}function aue(n,e,i,o,s){return null}function qx({controlled:n,default:e,name:i,state:o="value"}){const{current:s}=ie.useRef(n!==void 0),[l,d]=ie.useState(e),p=s?n:l,f=ie.useCallback(y=>{s||d(y)},[]);return[p,f]}function Qp(n){const e=ie.useRef(n);return gu(()=>{e.current=n}),ie.useRef((...i)=>(0,e.current)(...i)).current}function So(...n){return ie.useMemo(()=>n.every(e=>e==null)?null:e=>{n.forEach(i=>{ZE(i,e)})},n)}let QM=!0,zL=!1,i7;const rue={text:!0,search:!0,url:!0,tel:!0,email:!0,password:!0,number:!0,date:!0,month:!0,week:!0,time:!0,datetime:!0,"datetime-local":!0};function oue(n){const{type:e,tagName:i}=n;return!!(i==="INPUT"&&rue[e]&&!n.readOnly||i==="TEXTAREA"&&!n.readOnly||n.isContentEditable)}function sue(n){n.metaKey||n.altKey||n.ctrlKey||(QM=!0)}function f4(){QM=!1}function lue(){this.visibilityState==="hidden"&&zL&&(QM=!0)}function cue(n){n.addEventListener("keydown",sue,!0),n.addEventListener("mousedown",f4,!0),n.addEventListener("pointerdown",f4,!0),n.addEventListener("touchstart",f4,!0),n.addEventListener("visibilitychange",lue,!0)}function uue(n){const{target:e}=n;try{return e.matches(":focus-visible")}catch{}return QM||oue(e)}function cD(){const n=ie.useCallback(s=>{s!=null&&cue(s.ownerDocument)},[]),e=ie.useRef(!1);function i(){return e.current?(zL=!0,window.clearTimeout(i7),i7=window.setTimeout(()=>{zL=!1},100),e.current=!1,!0):!1}function o(s){return uue(s)?(e.current=!0,!0):!1}return{isFocusVisibleRef:e,onFocus:o,onBlur:i,ref:n}}function BY(n){const e=n.documentElement.clientWidth;return Math.abs(window.innerWidth-e)}function uD(n,e){const i=qe({},e);return Object.keys(n).forEach(o=>{if(o.toString().match(/^(components|slots)$/))i[o]=qe({},n[o],i[o]);else if(o.toString().match(/^(componentsProps|slotProps)$/)){const s=n[o]||{},l=e[o];i[o]={},!l||!Object.keys(l)?i[o]=s:!s||!Object.keys(s)?i[o]=l:(i[o]=qe({},l),Object.keys(s).forEach(d=>{i[o][d]=uD(s[d],l[d])}))}else i[o]===void 0&&(i[o]=n[o])}),i}function ha(n,e,i=void 0){const o={};return Object.keys(n).forEach(s=>{o[s]=n[s].reduce((l,d)=>{if(d){const p=e(d);p!==""&&l.push(p),i&&i[d]&&l.push(i[d])}return l},[]).join(" ")}),o}const a7=n=>n,due=()=>{let n=a7;return{configure(e){n=e},generate(e){return n(e)},reset(){n=a7}}},hue=due(),UY=hue,pue={active:"active",checked:"checked",completed:"completed",disabled:"disabled",error:"error",expanded:"expanded",focused:"focused",focusVisible:"focusVisible",open:"open",readOnly:"readOnly",required:"required",selected:"selected"};function aa(n,e,i="Mui"){const o=pue[e];return o?`${i}-${o}`:`${UY.generate(n)}-${e}`}function Zi(n,e,i="Mui"){const o={};return e.forEach(s=>{o[s]=aa(n,s,i)}),o}const e_="$$material";function qn(n,e){if(n==null)return{};var i={},o=Object.keys(n),s,l;for(l=0;l<o.length;l++)s=o[l],!(e.indexOf(s)>=0)&&(i[s]=n[s]);return i}function WY(n){var e=Object.create(null);return function(i){return e[i]===void 0&&(e[i]=n(i)),e[i]}}var fue=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|download|draggable|encType|enterKeyHint|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,mue=WY(function(n){return fue.test(n)||n.charCodeAt(0)===111&&n.charCodeAt(1)===110&&n.charCodeAt(2)<91});function gue(n){if(n.sheet)return n.sheet;for(var e=0;e<document.styleSheets.length;e++)if(document.styleSheets[e].ownerNode===n)return document.styleSheets[e]}function yue(n){var e=document.createElement("style");return e.setAttribute("data-emotion",n.key),n.nonce!==void 0&&e.setAttribute("nonce",n.nonce),e.appendChild(document.createTextNode("")),e.setAttribute("data-s",""),e}var vue=function(){function n(i){var o=this;this._insertTag=function(s){var l;o.tags.length===0?o.insertionPoint?l=o.insertionPoint.nextSibling:o.prepend?l=o.container.firstChild:l=o.before:l=o.tags[o.tags.length-1].nextSibling,o.container.insertBefore(s,l),o.tags.push(s)},this.isSpeedy=i.speedy===void 0?!0:i.speedy,this.tags=[],this.ctr=0,this.nonce=i.nonce,this.key=i.key,this.container=i.container,this.prepend=i.prepend,this.insertionPoint=i.insertionPoint,this.before=null}var e=n.prototype;return e.hydrate=function(o){o.forEach(this._insertTag)},e.insert=function(o){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(yue(this));var s=this.tags[this.tags.length-1];if(this.isSpeedy){var l=gue(s);try{l.insertRule(o,l.cssRules.length)}catch{}}else s.appendChild(document.createTextNode(o));this.ctr++},e.flush=function(){this.tags.forEach(function(o){return o.parentNode&&o.parentNode.removeChild(o)}),this.tags=[],this.ctr=0},n}(),gs="-ms-",KE="-moz-",Ta="-webkit-",VY="comm",dD="rule",hD="decl",_ue="@import",GY="@keyframes",bue="@layer",xue=Math.abs,eT=String.fromCharCode,wue=Object.assign;function Sue(n,e){return Ko(n,0)^45?(((e<<2^Ko(n,0))<<2^Ko(n,1))<<2^Ko(n,2))<<2^Ko(n,3):0}function HY(n){return n.trim()}function Aue(n,e){return(n=e.exec(n))?n[0]:n}function Ca(n,e,i){return n.replace(e,i)}function FL(n,e){return n.indexOf(e)}function Ko(n,e){return n.charCodeAt(e)|0}function Xx(n,e,i){return n.slice(e,i)}function od(n){return n.length}function pD(n){return n.length}function yS(n,e){return e.push(n),n}function Eue(n,e){return n.map(e).join("")}var tT=1,t_=1,jY=0,El=0,bo=0,b_="";function nT(n,e,i,o,s,l,d){return{value:n,root:e,parent:i,type:o,props:s,children:l,line:tT,column:t_,length:d,return:""}}function ob(n,e){return wue(nT("",null,null,"",null,null,0),n,{length:-n.length},e)}function Mue(){return bo}function Tue(){return bo=El>0?Ko(b_,--El):0,t_--,bo===10&&(t_=1,tT--),bo}function Xl(){return bo=El<jY?Ko(b_,El++):0,t_++,bo===10&&(t_=1,tT++),bo}function fd(){return Ko(b_,El)}function eE(){return El}function Bw(n,e){return Xx(b_,n,e)}function Zx(n){switch(n){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function $Y(n){return tT=t_=1,jY=od(b_=n),El=0,[]}function YY(n){return b_="",n}function tE(n){return HY(Bw(El-1,BL(n===91?n+2:n===40?n+1:n)))}function Cue(n){for(;(bo=fd())&&bo<33;)Xl();return Zx(n)>2||Zx(bo)>3?"":" "}function Pue(n,e){for(;--e&&Xl()&&!(bo<48||bo>102||bo>57&&bo<65||bo>70&&bo<97););return Bw(n,eE()+(e<6&&fd()==32&&Xl()==32))}function BL(n){for(;Xl();)switch(bo){case n:return El;case 34:case 39:n!==34&&n!==39&&BL(bo);break;case 40:n===41&&BL(n);break;case 92:Xl();break}return El}function Iue(n,e){for(;Xl()&&n+bo!==47+10;)if(n+bo===42+42&&fd()===47)break;return"/*"+Bw(e,El-1)+"*"+eT(n===47?n:Xl())}function Lue(n){for(;!Zx(fd());)Xl();return Bw(n,El)}function Rue(n){return YY(nE("",null,null,null,[""],n=$Y(n),0,[0],n))}function nE(n,e,i,o,s,l,d,p,f){for(var y=0,_=0,x=d,S=0,T=0,I=0,R=1,D=1,L=1,O=0,N="",F=s,G=l,j=o,Y=N;D;)switch(I=O,O=Xl()){case 40:if(I!=108&&Ko(Y,x-1)==58){FL(Y+=Ca(tE(O),"&","&\f"),"&\f")!=-1&&(L=-1);break}case 34:case 39:case 91:Y+=tE(O);break;case 9:case 10:case 13:case 32:Y+=Cue(I);break;case 92:Y+=Pue(eE()-1,7);continue;case 47:switch(fd()){case 42:case 47:yS(kue(Iue(Xl(),eE()),e,i),f);break;default:Y+="/"}break;case 123*R:p[y++]=od(Y)*L;case 125*R:case 59:case 0:switch(O){case 0:case 125:D=0;case 59+_:L==-1&&(Y=Ca(Y,/\f/g,"")),T>0&&od(Y)-x&&yS(T>32?o7(Y+";",o,i,x-1):o7(Ca(Y," ","")+";",o,i,x-2),f);break;case 59:Y+=";";default:if(yS(j=r7(Y,e,i,y,_,s,p,N,F=[],G=[],x),l),O===123)if(_===0)nE(Y,e,j,j,F,l,x,p,G);else switch(S===99&&Ko(Y,3)===110?100:S){case 100:case 108:case 109:case 115:nE(n,j,j,o&&yS(r7(n,j,j,0,0,s,p,N,s,F=[],x),G),s,G,x,p,o?F:G);break;default:nE(Y,j,j,j,[""],G,0,p,G)}}y=_=T=0,R=L=1,N=Y="",x=d;break;case 58:x=1+od(Y),T=I;default:if(R<1){if(O==123)--R;else if(O==125&&R++==0&&Tue()==125)continue}switch(Y+=eT(O),O*R){case 38:L=_>0?1:(Y+="\f",-1);break;case 44:p[y++]=(od(Y)-1)*L,L=1;break;case 64:fd()===45&&(Y+=tE(Xl())),S=fd(),_=x=od(N=Y+=Lue(eE())),O++;break;case 45:I===45&&od(Y)==2&&(R=0)}}return l}function r7(n,e,i,o,s,l,d,p,f,y,_){for(var x=s-1,S=s===0?l:[""],T=pD(S),I=0,R=0,D=0;I<o;++I)for(var L=0,O=Xx(n,x+1,x=xue(R=d[I])),N=n;L<T;++L)(N=HY(R>0?S[L]+" "+O:Ca(O,/&\f/g,S[L])))&&(f[D++]=N);return nT(n,e,i,s===0?dD:p,f,y,_)}function kue(n,e,i){return nT(n,e,i,VY,eT(Mue()),Xx(n,2,-2),0)}function o7(n,e,i,o){return nT(n,e,i,hD,Xx(n,0,o),Xx(n,o+1,-1),o)}function W0(n,e){for(var i="",o=pD(n),s=0;s<o;s++)i+=e(n[s],s,n,e)||"";return i}function Due(n,e,i,o){switch(n.type){case bue:if(n.children.length)break;case _ue:case hD:return n.return=n.return||n.value;case VY:return"";case GY:return n.return=n.value+"{"+W0(n.children,o)+"}";case dD:n.value=n.props.join(",")}return od(i=W0(n.children,o))?n.return=n.value+"{"+i+"}":""}function Oue(n){var e=pD(n);return function(i,o,s,l){for(var d="",p=0;p<e;p++)d+=n[p](i,o,s,l)||"";return d}}function Nue(n){return function(e){e.root||(e=e.return)&&n(e)}}var zue=function(e,i,o){for(var s=0,l=0;s=l,l=fd(),s===38&&l===12&&(i[o]=1),!Zx(l);)Xl();return Bw(e,El)},Fue=function(e,i){var o=-1,s=44;do switch(Zx(s)){case 0:s===38&&fd()===12&&(i[o]=1),e[o]+=zue(El-1,i,o);break;case 2:e[o]+=tE(s);break;case 4:if(s===44){e[++o]=fd()===58?"&\f":"",i[o]=e[o].length;break}default:e[o]+=eT(s)}while(s=Xl());return e},Bue=function(e,i){return YY(Fue($Y(e),i))},s7=new WeakMap,Uue=function(e){if(!(e.type!=="rule"||!e.parent||e.length<1)){for(var i=e.value,o=e.parent,s=e.column===o.column&&e.line===o.line;o.type!=="rule";)if(o=o.parent,!o)return;if(!(e.props.length===1&&i.charCodeAt(0)!==58&&!s7.get(o))&&!s){s7.set(e,!0);for(var l=[],d=Bue(i,l),p=o.props,f=0,y=0;f<d.length;f++)for(var _=0;_<p.length;_++,y++)e.props[y]=l[f]?d[f].replace(/&\f/g,p[_]):p[_]+" "+d[f]}}},Wue=function(e){if(e.type==="decl"){var i=e.value;i.charCodeAt(0)===108&&i.charCodeAt(2)===98&&(e.return="",e.value="")}};function qY(n,e){switch(Sue(n,e)){case 5103:return Ta+"print-"+n+n;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return Ta+n+n;case 5349:case 4246:case 4810:case 6968:case 2756:return Ta+n+KE+n+gs+n+n;case 6828:case 4268:return Ta+n+gs+n+n;case 6165:return Ta+n+gs+"flex-"+n+n;case 5187:return Ta+n+Ca(n,/(\w+).+(:[^]+)/,Ta+"box-$1$2"+gs+"flex-$1$2")+n;case 5443:return Ta+n+gs+"flex-item-"+Ca(n,/flex-|-self/,"")+n;case 4675:return Ta+n+gs+"flex-line-pack"+Ca(n,/align-content|flex-|-self/,"")+n;case 5548:return Ta+n+gs+Ca(n,"shrink","negative")+n;case 5292:return Ta+n+gs+Ca(n,"basis","preferred-size")+n;case 6060:return Ta+"box-"+Ca(n,"-grow","")+Ta+n+gs+Ca(n,"grow","positive")+n;case 4554:return Ta+Ca(n,/([^-])(transform)/g,"$1"+Ta+"$2")+n;case 6187:return Ca(Ca(Ca(n,/(zoom-|grab)/,Ta+"$1"),/(image-set)/,Ta+"$1"),n,"")+n;case 5495:case 3959:return Ca(n,/(image-set\([^]*)/,Ta+"$1$`$1");case 4968:return Ca(Ca(n,/(.+:)(flex-)?(.*)/,Ta+"box-pack:$3"+gs+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+Ta+n+n;case 4095:case 3583:case 4068:case 2532:return Ca(n,/(.+)-inline(.+)/,Ta+"$1$2")+n;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(od(n)-1-e>6)switch(Ko(n,e+1)){case 109:if(Ko(n,e+4)!==45)break;case 102:return Ca(n,/(.+:)(.+)-([^]+)/,"$1"+Ta+"$2-$3$1"+KE+(Ko(n,e+3)==108?"$3":"$2-$3"))+n;case 115:return~FL(n,"stretch")?qY(Ca(n,"stretch","fill-available"),e)+n:n}break;case 4949:if(Ko(n,e+1)!==115)break;case 6444:switch(Ko(n,od(n)-3-(~FL(n,"!important")&&10))){case 107:return Ca(n,":",":"+Ta)+n;case 101:return Ca(n,/(.+:)([^;!]+)(;|!.+)?/,"$1"+Ta+(Ko(n,14)===45?"inline-":"")+"box$3$1"+Ta+"$2$3$1"+gs+"$2box$3")+n}break;case 5936:switch(Ko(n,e+11)){case 114:return Ta+n+gs+Ca(n,/[svh]\w+-[tblr]{2}/,"tb")+n;case 108:return Ta+n+gs+Ca(n,/[svh]\w+-[tblr]{2}/,"tb-rl")+n;case 45:return Ta+n+gs+Ca(n,/[svh]\w+-[tblr]{2}/,"lr")+n}return Ta+n+gs+n+n}return n}var Vue=function(e,i,o,s){if(e.length>-1&&!e.return)switch(e.type){case hD:e.return=qY(e.value,e.length);break;case GY:return W0([ob(e,{value:Ca(e.value,"@","@"+Ta)})],s);case dD:if(e.length)return Eue(e.props,function(l){switch(Aue(l,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return W0([ob(e,{props:[Ca(l,/:(read-\w+)/,":"+KE+"$1")]})],s);case"::placeholder":return W0([ob(e,{props:[Ca(l,/:(plac\w+)/,":"+Ta+"input-$1")]}),ob(e,{props:[Ca(l,/:(plac\w+)/,":"+KE+"$1")]}),ob(e,{props:[Ca(l,/:(plac\w+)/,gs+"input-$1")]})],s)}return""})}},Gue=[Vue],Hue=function(e){var i=e.key;if(i==="css"){var o=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(o,function(R){var D=R.getAttribute("data-emotion");D.indexOf(" ")!==-1&&(document.head.appendChild(R),R.setAttribute("data-s",""))})}var s=e.stylisPlugins||Gue,l={},d,p=[];d=e.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+i+' "]'),function(R){for(var D=R.getAttribute("data-emotion").split(" "),L=1;L<D.length;L++)l[D[L]]=!0;p.push(R)});var f,y=[Uue,Wue];{var _,x=[Due,Nue(function(R){_.insert(R)})],S=Oue(y.concat(s,x)),T=function(D){return W0(Rue(D),S)};f=function(D,L,O,N){_=O,T(D?D+"{"+L.styles+"}":L.styles),N&&(I.inserted[L.name]=!0)}}var I={key:i,sheet:new vue({key:i,container:d,nonce:e.nonce,speedy:e.speedy,prepend:e.prepend,insertionPoint:e.insertionPoint}),nonce:e.nonce,inserted:l,registered:{},insert:f};return I.sheet.hydrate(p),I},XY={exports:{}},Va={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Vo=typeof Symbol=="function"&&Symbol.for,fD=Vo?Symbol.for("react.element"):60103,mD=Vo?Symbol.for("react.portal"):60106,iT=Vo?Symbol.for("react.fragment"):60107,aT=Vo?Symbol.for("react.strict_mode"):60108,rT=Vo?Symbol.for("react.profiler"):60114,oT=Vo?Symbol.for("react.provider"):60109,sT=Vo?Symbol.for("react.context"):60110,gD=Vo?Symbol.for("react.async_mode"):60111,lT=Vo?Symbol.for("react.concurrent_mode"):60111,cT=Vo?Symbol.for("react.forward_ref"):60112,uT=Vo?Symbol.for("react.suspense"):60113,jue=Vo?Symbol.for("react.suspense_list"):60120,dT=Vo?Symbol.for("react.memo"):60115,hT=Vo?Symbol.for("react.lazy"):60116,$ue=Vo?Symbol.for("react.block"):60121,Yue=Vo?Symbol.for("react.fundamental"):60117,que=Vo?Symbol.for("react.responder"):60118,Xue=Vo?Symbol.for("react.scope"):60119;function nc(n){if(typeof n=="object"&&n!==null){var e=n.$$typeof;switch(e){case fD:switch(n=n.type,n){case gD:case lT:case iT:case rT:case aT:case uT:return n;default:switch(n=n&&n.$$typeof,n){case sT:case cT:case hT:case dT:case oT:return n;default:return e}}case mD:return e}}}function ZY(n){return nc(n)===lT}Va.AsyncMode=gD;Va.ConcurrentMode=lT;Va.ContextConsumer=sT;Va.ContextProvider=oT;Va.Element=fD;Va.ForwardRef=cT;Va.Fragment=iT;Va.Lazy=hT;Va.Memo=dT;Va.Portal=mD;Va.Profiler=rT;Va.StrictMode=aT;Va.Suspense=uT;Va.isAsyncMode=function(n){return ZY(n)||nc(n)===gD};Va.isConcurrentMode=ZY;Va.isContextConsumer=function(n){return nc(n)===sT};Va.isContextProvider=function(n){return nc(n)===oT};Va.isElement=function(n){return typeof n=="object"&&n!==null&&n.$$typeof===fD};Va.isForwardRef=function(n){return nc(n)===cT};Va.isFragment=function(n){return nc(n)===iT};Va.isLazy=function(n){return nc(n)===hT};Va.isMemo=function(n){return nc(n)===dT};Va.isPortal=function(n){return nc(n)===mD};Va.isProfiler=function(n){return nc(n)===rT};Va.isStrictMode=function(n){return nc(n)===aT};Va.isSuspense=function(n){return nc(n)===uT};Va.isValidElementType=function(n){return typeof n=="string"||typeof n=="function"||n===iT||n===lT||n===rT||n===aT||n===uT||n===jue||typeof n=="object"&&n!==null&&(n.$$typeof===hT||n.$$typeof===dT||n.$$typeof===oT||n.$$typeof===sT||n.$$typeof===cT||n.$$typeof===Yue||n.$$typeof===que||n.$$typeof===Xue||n.$$typeof===$ue)};Va.typeOf=nc;XY.exports=Va;var Zue=XY.exports,KY=Zue,Kue={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},Jue={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},JY={};JY[KY.ForwardRef]=Kue;JY[KY.Memo]=Jue;var Que=!0;function QY(n,e,i){var o="";return i.split(" ").forEach(function(s){n[s]!==void 0?e.push(n[s]+";"):o+=s+" "}),o}var eq=function(e,i,o){var s=e.key+"-"+i.name;(o===!1||Que===!1)&&e.registered[s]===void 0&&(e.registered[s]=i.styles)},yD=function(e,i,o){eq(e,i,o);var s=e.key+"-"+i.name;if(e.inserted[i.name]===void 0){var l=i;do e.insert(i===l?"."+s:"",l,e.sheet,!0),l=l.next;while(l!==void 0)}};function ede(n){for(var e=0,i,o=0,s=n.length;s>=4;++o,s-=4)i=n.charCodeAt(o)&255|(n.charCodeAt(++o)&255)<<8|(n.charCodeAt(++o)&255)<<16|(n.charCodeAt(++o)&255)<<24,i=(i&65535)*1540483477+((i>>>16)*59797<<16),i^=i>>>24,e=(i&65535)*1540483477+((i>>>16)*59797<<16)^(e&65535)*1540483477+((e>>>16)*59797<<16);switch(s){case 3:e^=(n.charCodeAt(o+2)&255)<<16;case 2:e^=(n.charCodeAt(o+1)&255)<<8;case 1:e^=n.charCodeAt(o)&255,e=(e&65535)*1540483477+((e>>>16)*59797<<16)}return e^=e>>>13,e=(e&65535)*1540483477+((e>>>16)*59797<<16),((e^e>>>15)>>>0).toString(36)}var tde={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},nde=/[A-Z]|^ms/g,ide=/_EMO_([^_]+?)_([^]*?)_EMO_/g,tq=function(e){return e.charCodeAt(1)===45},l7=function(e){return e!=null&&typeof e!="boolean"},m4=WY(function(n){return tq(n)?n:n.replace(nde,"-$&").toLowerCase()}),c7=function(e,i){switch(e){case"animation":case"animationName":if(typeof i=="string")return i.replace(ide,function(o,s,l){return sd={name:s,styles:l,next:sd},s})}return tde[e]!==1&&!tq(e)&&typeof i=="number"&&i!==0?i+"px":i};function Kx(n,e,i){if(i==null)return"";if(i.__emotion_styles!==void 0)return i;switch(typeof i){case"boolean":return"";case"object":{if(i.anim===1)return sd={name:i.name,styles:i.styles,next:sd},i.name;if(i.styles!==void 0){var o=i.next;if(o!==void 0)for(;o!==void 0;)sd={name:o.name,styles:o.styles,next:sd},o=o.next;var s=i.styles+";";return s}return ade(n,e,i)}case"function":{if(n!==void 0){var l=sd,d=i(n);return sd=l,Kx(n,e,d)}break}}if(e==null)return i;var p=e[i];return p!==void 0?p:i}function ade(n,e,i){var o="";if(Array.isArray(i))for(var s=0;s<i.length;s++)o+=Kx(n,e,i[s])+";";else for(var l in i){var d=i[l];if(typeof d!="object")e!=null&&e[d]!==void 0?o+=l+"{"+e[d]+"}":l7(d)&&(o+=m4(l)+":"+c7(l,d)+";");else if(Array.isArray(d)&&typeof d[0]=="string"&&(e==null||e[d[0]]===void 0))for(var p=0;p<d.length;p++)l7(d[p])&&(o+=m4(l)+":"+c7(l,d[p])+";");else{var f=Kx(n,e,d);switch(l){case"animation":case"animationName":{o+=m4(l)+":"+f+";";break}default:o+=l+"{"+f+"}"}}}return o}var u7=/label:\s*([^\s;\n{]+)\s*(;|$)/g,sd,pT=function(e,i,o){if(e.length===1&&typeof e[0]=="object"&&e[0]!==null&&e[0].styles!==void 0)return e[0];var s=!0,l="";sd=void 0;var d=e[0];d==null||d.raw===void 0?(s=!1,l+=Kx(o,i,d)):l+=d[0];for(var p=1;p<e.length;p++)l+=Kx(o,i,e[p]),s&&(l+=d[p]);u7.lastIndex=0;for(var f="",y;(y=u7.exec(l))!==null;)f+="-"+y[1];var _=ede(l)+f;return{name:_,styles:l,next:sd}},rde=function(e){return e()},nq=wE["useInsertionEffect"]?wE["useInsertionEffect"]:!1,ode=nq||rde,d7=nq||ie.useLayoutEffect,vD=ie.createContext(typeof HTMLElement<"u"?Hue({key:"css"}):null);vD.Provider;var sde=function(){return ie.useContext(vD)},iq=function(e){return ie.forwardRef(function(i,o){var s=ie.useContext(vD);return e(i,s,o)})},fT=ie.createContext({}),lde=iq(function(n,e){var i=n.styles,o=pT([i],void 0,ie.useContext(fT)),s=ie.useRef();return d7(function(){var l=e.key+"-global",d=new e.sheet.constructor({key:l,nonce:e.sheet.nonce,container:e.sheet.container,speedy:e.sheet.isSpeedy}),p=!1,f=document.querySelector('style[data-emotion="'+l+" "+o.name+'"]');return e.sheet.tags.length&&(d.before=e.sheet.tags[0]),f!==null&&(p=!0,f.setAttribute("data-emotion",l),d.hydrate([f])),s.current=[d,p],function(){d.flush()}},[e]),d7(function(){var l=s.current,d=l[0],p=l[1];if(p){l[1]=!1;return}if(o.next!==void 0&&yD(e,o.next,!0),d.tags.length){var f=d.tags[d.tags.length-1].nextElementSibling;d.before=f,d.flush()}e.insert("",o,d,!1)},[e,o.name]),null});function cde(){for(var n=arguments.length,e=new Array(n),i=0;i<n;i++)e[i]=arguments[i];return pT(e)}var _D=function(){var e=cde.apply(void 0,arguments),i="animation-"+e.name;return{name:i,styles:"@keyframes "+i+"{"+e.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}},ude=mue,dde=function(e){return e!=="theme"},h7=function(e){return typeof e=="string"&&e.charCodeAt(0)>96?ude:dde},p7=function(e,i,o){var s;if(i){var l=i.shouldForwardProp;s=e.__emotion_forwardProp&&l?function(d){return e.__emotion_forwardProp(d)&&l(d)}:l}return typeof s!="function"&&o&&(s=e.__emotion_forwardProp),s},hde=function(e){var i=e.cache,o=e.serialized,s=e.isStringTag;return eq(i,o,s),ode(function(){return yD(i,o,s)}),null},pde=function n(e,i){var o=e.__emotion_real===e,s=o&&e.__emotion_base||e,l,d;i!==void 0&&(l=i.label,d=i.target);var p=p7(e,i,o),f=p||h7(s),y=!f("as");return function(){var _=arguments,x=o&&e.__emotion_styles!==void 0?e.__emotion_styles.slice(0):[];if(l!==void 0&&x.push("label:"+l+";"),_[0]==null||_[0].raw===void 0)x.push.apply(x,_);else{x.push(_[0][0]);for(var S=_.length,T=1;T<S;T++)x.push(_[T],_[0][T])}var I=iq(function(R,D,L){var O=y&&R.as||s,N="",F=[],G=R;if(R.theme==null){G={};for(var j in R)G[j]=R[j];G.theme=ie.useContext(fT)}typeof R.className=="string"?N=QY(D.registered,F,R.className):R.className!=null&&(N=R.className+" ");var Y=pT(x.concat(F),D.registered,G);N+=D.key+"-"+Y.name,d!==void 0&&(N+=" "+d);var te=y&&p===void 0?h7(O):f,V={};for(var Q in R)y&&Q==="as"||te(Q)&&(V[Q]=R[Q]);return V.className=N,V.ref=L,ie.createElement(ie.Fragment,null,ie.createElement(hde,{cache:D,serialized:Y,isStringTag:typeof O=="string"}),ie.createElement(O,V))});return I.displayName=l!==void 0?l:"Styled("+(typeof s=="string"?s:s.displayName||s.name||"Component")+")",I.defaultProps=e.defaultProps,I.__emotion_real=I,I.__emotion_base=s,I.__emotion_styles=x,I.__emotion_forwardProp=p,Object.defineProperty(I,"toString",{value:function(){return"."+d}}),I.withComponent=function(R,D){return n(R,qe({},i,D,{shouldForwardProp:p7(I,D,!0)})).apply(void 0,x)},I}},fde=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"],UL=pde.bind();fde.forEach(function(n){UL[n]=UL(n)});var aq={exports:{}},mT={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var mde=ie,gde=Symbol.for("react.element"),yde=Symbol.for("react.fragment"),vde=Object.prototype.hasOwnProperty,_de=mde.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,bde={key:!0,ref:!0,__self:!0,__source:!0};function rq(n,e,i){var o,s={},l=null,d=null;i!==void 0&&(l=""+i),e.key!==void 0&&(l=""+e.key),e.ref!==void 0&&(d=e.ref);for(o in e)vde.call(e,o)&&!bde.hasOwnProperty(o)&&(s[o]=e[o]);if(n&&n.defaultProps)for(o in e=n.defaultProps,e)s[o]===void 0&&(s[o]=e[o]);return{$$typeof:gde,type:n,key:l,ref:d,props:s,_owner:_de.current}}mT.Fragment=yde;mT.jsx=rq;mT.jsxs=rq;aq.exports=mT;var bD=aq.exports;const X=bD.jsx,$e=bD.jsxs,_s=bD.Fragment,xde=Object.freeze(Object.defineProperty({__proto__:null,Fragment:_s,jsx:X,jsxs:$e},Symbol.toStringTag,{value:"Module"}));function wde(n){return n==null||Object.keys(n).length===0}function Sde(n){const{styles:e,defaultTheme:i={}}=n;return X(lde,{styles:typeof e=="function"?s=>e(wde(s)?i:s):e})}/**
 * @mui/styled-engine v5.14.17
 *
 * @license MIT
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */function Ade(n,e){return UL(n,e)}const Ede=(n,e)=>{Array.isArray(n.__emotion_styles)&&(n.__emotion_styles=e(n.__emotion_styles))},Mde=["values","unit","step"],Tde=n=>{const e=Object.keys(n).map(i=>({key:i,val:n[i]}))||[];return e.sort((i,o)=>i.val-o.val),e.reduce((i,o)=>qe({},i,{[o.key]:o.val}),{})};function Cde(n){const{values:e={xs:0,sm:600,md:900,lg:1200,xl:1536},unit:i="px",step:o=5}=n,s=qn(n,Mde),l=Tde(e),d=Object.keys(l);function p(S){return`@media (min-width:${typeof e[S]=="number"?e[S]:S}${i})`}function f(S){return`@media (max-width:${(typeof e[S]=="number"?e[S]:S)-o/100}${i})`}function y(S,T){const I=d.indexOf(T);return`@media (min-width:${typeof e[S]=="number"?e[S]:S}${i}) and (max-width:${(I!==-1&&typeof e[d[I]]=="number"?e[d[I]]:T)-o/100}${i})`}function _(S){return d.indexOf(S)+1<d.length?y(S,d[d.indexOf(S)+1]):p(S)}function x(S){const T=d.indexOf(S);return T===0?p(d[1]):T===d.length-1?f(d[T]):y(S,d[d.indexOf(S)+1]).replace("@media","@media not all and")}return qe({keys:d,values:l,up:p,down:f,between:y,only:_,not:x,unit:i},s)}const Pde={borderRadius:4},Ide=Pde;function ox(n,e){return e?wl(n,e,{clone:!1}):n}const xD={xs:0,sm:600,md:900,lg:1200,xl:1536},f7={keys:["xs","sm","md","lg","xl"],up:n=>`@media (min-width:${xD[n]}px)`};function Vh(n,e,i){const o=n.theme||{};if(Array.isArray(e)){const l=o.breakpoints||f7;return e.reduce((d,p,f)=>(d[l.up(l.keys[f])]=i(e[f]),d),{})}if(typeof e=="object"){const l=o.breakpoints||f7;return Object.keys(e).reduce((d,p)=>{if(Object.keys(l.values||xD).indexOf(p)!==-1){const f=l.up(p);d[f]=i(e[p],p)}else{const f=p;d[f]=e[f]}return d},{})}return i(e)}function Lde(n={}){var e;return((e=n.keys)==null?void 0:e.reduce((o,s)=>{const l=n.up(s);return o[l]={},o},{}))||{}}function Rde(n,e){return n.reduce((i,o)=>{const s=i[o];return(!s||Object.keys(s).length===0)&&delete i[o],i},e)}function gT(n,e,i=!0){if(!e||typeof e!="string")return null;if(n&&n.vars&&i){const o=`vars.${e}`.split(".").reduce((s,l)=>s&&s[l]?s[l]:null,n);if(o!=null)return o}return e.split(".").reduce((o,s)=>o&&o[s]!=null?o[s]:null,n)}function JE(n,e,i,o=i){let s;return typeof n=="function"?s=n(i):Array.isArray(n)?s=n[i]||o:s=gT(n,i)||o,e&&(s=e(s,o,n)),s}function Da(n){const{prop:e,cssProperty:i=n.prop,themeKey:o,transform:s}=n,l=d=>{if(d[e]==null)return null;const p=d[e],f=d.theme,y=gT(f,o)||{};return Vh(d,p,x=>{let S=JE(y,s,x);return x===S&&typeof x=="string"&&(S=JE(y,s,`${e}${x==="default"?"":ai(x)}`,x)),i===!1?S:{[i]:S}})};return l.propTypes={},l.filterProps=[e],l}function kde(n){const e={};return i=>(e[i]===void 0&&(e[i]=n(i)),e[i])}const Dde={m:"margin",p:"padding"},Ode={t:"Top",r:"Right",b:"Bottom",l:"Left",x:["Left","Right"],y:["Top","Bottom"]},m7={marginX:"mx",marginY:"my",paddingX:"px",paddingY:"py"},Nde=kde(n=>{if(n.length>2)if(m7[n])n=m7[n];else return[n];const[e,i]=n.split(""),o=Dde[e],s=Ode[i]||"";return Array.isArray(s)?s.map(l=>o+l):[o+s]}),wD=["m","mt","mr","mb","ml","mx","my","margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","marginInline","marginInlineStart","marginInlineEnd","marginBlock","marginBlockStart","marginBlockEnd"],SD=["p","pt","pr","pb","pl","px","py","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","paddingX","paddingY","paddingInline","paddingInlineStart","paddingInlineEnd","paddingBlock","paddingBlockStart","paddingBlockEnd"];[...wD,...SD];function Uw(n,e,i,o){var s;const l=(s=gT(n,e,!1))!=null?s:i;return typeof l=="number"?d=>typeof d=="string"?d:l*d:Array.isArray(l)?d=>typeof d=="string"?d:l[d]:typeof l=="function"?l:()=>{}}function oq(n){return Uw(n,"spacing",8)}function Ww(n,e){if(typeof e=="string"||e==null)return e;const i=Math.abs(e),o=n(i);return e>=0?o:typeof o=="number"?-o:`-${o}`}function zde(n,e){return i=>n.reduce((o,s)=>(o[s]=Ww(e,i),o),{})}function Fde(n,e,i,o){if(e.indexOf(i)===-1)return null;const s=Nde(i),l=zde(s,o),d=n[i];return Vh(n,d,l)}function sq(n,e){const i=oq(n.theme);return Object.keys(n).map(o=>Fde(n,e,o,i)).reduce(ox,{})}function Gr(n){return sq(n,wD)}Gr.propTypes={};Gr.filterProps=wD;function Hr(n){return sq(n,SD)}Hr.propTypes={};Hr.filterProps=SD;function Bde(n=8){if(n.mui)return n;const e=oq({spacing:n}),i=(...o)=>(o.length===0?[1]:o).map(l=>{const d=e(l);return typeof d=="number"?`${d}px`:d}).join(" ");return i.mui=!0,i}function yT(...n){const e=n.reduce((o,s)=>(s.filterProps.forEach(l=>{o[l]=s}),o),{}),i=o=>Object.keys(o).reduce((s,l)=>e[l]?ox(s,e[l](o)):s,{});return i.propTypes={},i.filterProps=n.reduce((o,s)=>o.concat(s.filterProps),[]),i}function cd(n){return typeof n!="number"?n:`${n}px solid`}const Ude=Da({prop:"border",themeKey:"borders",transform:cd}),Wde=Da({prop:"borderTop",themeKey:"borders",transform:cd}),Vde=Da({prop:"borderRight",themeKey:"borders",transform:cd}),Gde=Da({prop:"borderBottom",themeKey:"borders",transform:cd}),Hde=Da({prop:"borderLeft",themeKey:"borders",transform:cd}),jde=Da({prop:"borderColor",themeKey:"palette"}),$de=Da({prop:"borderTopColor",themeKey:"palette"}),Yde=Da({prop:"borderRightColor",themeKey:"palette"}),qde=Da({prop:"borderBottomColor",themeKey:"palette"}),Xde=Da({prop:"borderLeftColor",themeKey:"palette"}),vT=n=>{if(n.borderRadius!==void 0&&n.borderRadius!==null){const e=Uw(n.theme,"shape.borderRadius",4),i=o=>({borderRadius:Ww(e,o)});return Vh(n,n.borderRadius,i)}return null};vT.propTypes={};vT.filterProps=["borderRadius"];yT(Ude,Wde,Vde,Gde,Hde,jde,$de,Yde,qde,Xde,vT);const _T=n=>{if(n.gap!==void 0&&n.gap!==null){const e=Uw(n.theme,"spacing",8),i=o=>({gap:Ww(e,o)});return Vh(n,n.gap,i)}return null};_T.propTypes={};_T.filterProps=["gap"];const bT=n=>{if(n.columnGap!==void 0&&n.columnGap!==null){const e=Uw(n.theme,"spacing",8),i=o=>({columnGap:Ww(e,o)});return Vh(n,n.columnGap,i)}return null};bT.propTypes={};bT.filterProps=["columnGap"];const xT=n=>{if(n.rowGap!==void 0&&n.rowGap!==null){const e=Uw(n.theme,"spacing",8),i=o=>({rowGap:Ww(e,o)});return Vh(n,n.rowGap,i)}return null};xT.propTypes={};xT.filterProps=["rowGap"];const Zde=Da({prop:"gridColumn"}),Kde=Da({prop:"gridRow"}),Jde=Da({prop:"gridAutoFlow"}),Qde=Da({prop:"gridAutoColumns"}),ehe=Da({prop:"gridAutoRows"}),the=Da({prop:"gridTemplateColumns"}),nhe=Da({prop:"gridTemplateRows"}),ihe=Da({prop:"gridTemplateAreas"}),ahe=Da({prop:"gridArea"});yT(_T,bT,xT,Zde,Kde,Jde,Qde,ehe,the,nhe,ihe,ahe);function V0(n,e){return e==="grey"?e:n}const rhe=Da({prop:"color",themeKey:"palette",transform:V0}),ohe=Da({prop:"bgcolor",cssProperty:"backgroundColor",themeKey:"palette",transform:V0}),she=Da({prop:"backgroundColor",themeKey:"palette",transform:V0});yT(rhe,ohe,she);function Hl(n){return n<=1&&n!==0?`${n*100}%`:n}const lhe=Da({prop:"width",transform:Hl}),AD=n=>{if(n.maxWidth!==void 0&&n.maxWidth!==null){const e=i=>{var o,s;const l=((o=n.theme)==null||(o=o.breakpoints)==null||(o=o.values)==null?void 0:o[i])||xD[i];return l?((s=n.theme)==null||(s=s.breakpoints)==null?void 0:s.unit)!=="px"?{maxWidth:`${l}${n.theme.breakpoints.unit}`}:{maxWidth:l}:{maxWidth:Hl(i)}};return Vh(n,n.maxWidth,e)}return null};AD.filterProps=["maxWidth"];const che=Da({prop:"minWidth",transform:Hl}),uhe=Da({prop:"height",transform:Hl}),dhe=Da({prop:"maxHeight",transform:Hl}),hhe=Da({prop:"minHeight",transform:Hl});Da({prop:"size",cssProperty:"width",transform:Hl});Da({prop:"size",cssProperty:"height",transform:Hl});const phe=Da({prop:"boxSizing"});yT(lhe,AD,che,uhe,dhe,hhe,phe);const fhe={border:{themeKey:"borders",transform:cd},borderTop:{themeKey:"borders",transform:cd},borderRight:{themeKey:"borders",transform:cd},borderBottom:{themeKey:"borders",transform:cd},borderLeft:{themeKey:"borders",transform:cd},borderColor:{themeKey:"palette"},borderTopColor:{themeKey:"palette"},borderRightColor:{themeKey:"palette"},borderBottomColor:{themeKey:"palette"},borderLeftColor:{themeKey:"palette"},borderRadius:{themeKey:"shape.borderRadius",style:vT},color:{themeKey:"palette",transform:V0},bgcolor:{themeKey:"palette",cssProperty:"backgroundColor",transform:V0},backgroundColor:{themeKey:"palette",transform:V0},p:{style:Hr},pt:{style:Hr},pr:{style:Hr},pb:{style:Hr},pl:{style:Hr},px:{style:Hr},py:{style:Hr},padding:{style:Hr},paddingTop:{style:Hr},paddingRight:{style:Hr},paddingBottom:{style:Hr},paddingLeft:{style:Hr},paddingX:{style:Hr},paddingY:{style:Hr},paddingInline:{style:Hr},paddingInlineStart:{style:Hr},paddingInlineEnd:{style:Hr},paddingBlock:{style:Hr},paddingBlockStart:{style:Hr},paddingBlockEnd:{style:Hr},m:{style:Gr},mt:{style:Gr},mr:{style:Gr},mb:{style:Gr},ml:{style:Gr},mx:{style:Gr},my:{style:Gr},margin:{style:Gr},marginTop:{style:Gr},marginRight:{style:Gr},marginBottom:{style:Gr},marginLeft:{style:Gr},marginX:{style:Gr},marginY:{style:Gr},marginInline:{style:Gr},marginInlineStart:{style:Gr},marginInlineEnd:{style:Gr},marginBlock:{style:Gr},marginBlockStart:{style:Gr},marginBlockEnd:{style:Gr},displayPrint:{cssProperty:!1,transform:n=>({"@media print":{display:n}})},display:{},overflow:{},textOverflow:{},visibility:{},whiteSpace:{},flexBasis:{},flexDirection:{},flexWrap:{},justifyContent:{},alignItems:{},alignContent:{},order:{},flex:{},flexGrow:{},flexShrink:{},alignSelf:{},justifyItems:{},justifySelf:{},gap:{style:_T},rowGap:{style:xT},columnGap:{style:bT},gridColumn:{},gridRow:{},gridAutoFlow:{},gridAutoColumns:{},gridAutoRows:{},gridTemplateColumns:{},gridTemplateRows:{},gridTemplateAreas:{},gridArea:{},position:{},zIndex:{themeKey:"zIndex"},top:{},right:{},bottom:{},left:{},boxShadow:{themeKey:"shadows"},width:{transform:Hl},maxWidth:{style:AD},minWidth:{transform:Hl},height:{transform:Hl},maxHeight:{transform:Hl},minHeight:{transform:Hl},boxSizing:{},fontFamily:{themeKey:"typography"},fontSize:{themeKey:"typography"},fontStyle:{themeKey:"typography"},fontWeight:{themeKey:"typography"},letterSpacing:{},textTransform:{},lineHeight:{},textAlign:{},typography:{cssProperty:!1,themeKey:"typography"}},wT=fhe;function mhe(...n){const e=n.reduce((o,s)=>o.concat(Object.keys(s)),[]),i=new Set(e);return n.every(o=>i.size===Object.keys(o).length)}function ghe(n,e){return typeof n=="function"?n(e):n}function yhe(){function n(i,o,s,l){const d={[i]:o,theme:s},p=l[i];if(!p)return{[i]:o};const{cssProperty:f=i,themeKey:y,transform:_,style:x}=p;if(o==null)return null;if(y==="typography"&&o==="inherit")return{[i]:o};const S=gT(s,y)||{};return x?x(d):Vh(d,o,I=>{let R=JE(S,_,I);return I===R&&typeof I=="string"&&(R=JE(S,_,`${i}${I==="default"?"":ai(I)}`,I)),f===!1?R:{[f]:R}})}function e(i){var o;const{sx:s,theme:l={}}=i||{};if(!s)return null;const d=(o=l.unstable_sxConfig)!=null?o:wT;function p(f){let y=f;if(typeof f=="function")y=f(l);else if(typeof f!="object")return f;if(!y)return null;const _=Lde(l.breakpoints),x=Object.keys(_);let S=_;return Object.keys(y).forEach(T=>{const I=ghe(y[T],l);if(I!=null)if(typeof I=="object")if(d[T])S=ox(S,n(T,I,l,d));else{const R=Vh({theme:l},I,D=>({[T]:D}));mhe(R,I)?S[T]=e({sx:I,theme:l}):S=ox(S,R)}else S=ox(S,n(T,I,l,d))}),Rde(x,S)}return Array.isArray(s)?s.map(p):p(s)}return e}const lq=yhe();lq.filterProps=["sx"];const ED=lq,vhe=["breakpoints","palette","spacing","shape"];function MD(n={},...e){const{breakpoints:i={},palette:o={},spacing:s,shape:l={}}=n,d=qn(n,vhe),p=Cde(i),f=Bde(s);let y=wl({breakpoints:p,direction:"ltr",components:{},palette:qe({mode:"light"},o),spacing:f,shape:qe({},Ide,l)},d);return y=e.reduce((_,x)=>wl(_,x),y),y.unstable_sxConfig=qe({},wT,d==null?void 0:d.unstable_sxConfig),y.unstable_sx=function(x){return ED({sx:x,theme:this})},y}function _he(n){return Object.keys(n).length===0}function TD(n=null){const e=ie.useContext(fT);return!e||_he(e)?n:e}const bhe=MD();function CD(n=bhe){return TD(n)}function xhe({styles:n,themeId:e,defaultTheme:i={}}){const o=CD(i),s=typeof n=="function"?n(e&&o[e]||o):n;return X(Sde,{styles:s})}const whe=["sx"],She=n=>{var e,i;const o={systemProps:{},otherProps:{}},s=(e=n==null||(i=n.theme)==null?void 0:i.unstable_sxConfig)!=null?e:wT;return Object.keys(n).forEach(l=>{s[l]?o.systemProps[l]=n[l]:o.otherProps[l]=n[l]}),o};function Ahe(n){const{sx:e}=n,i=qn(n,whe),{systemProps:o,otherProps:s}=She(i);let l;return Array.isArray(e)?l=[o,...e]:typeof e=="function"?l=(...d)=>{const p=e(...d);return Mh(p)?qe({},o,p):o}:l=qe({},o,e),qe({},s,{sx:l})}function cq(n){var e,i,o="";if(typeof n=="string"||typeof n=="number")o+=n;else if(typeof n=="object")if(Array.isArray(n))for(e=0;e<n.length;e++)n[e]&&(i=cq(n[e]))&&(o&&(o+=" "),o+=i);else for(e in n)n[e]&&(o&&(o+=" "),o+=e);return o}function _i(){for(var n,e,i=0,o="";i<arguments.length;)(n=arguments[i++])&&(e=cq(n))&&(o&&(o+=" "),o+=e);return o}const Ehe=["variant"];function g7(n){return n.length===0}function uq(n){const{variant:e}=n,i=qn(n,Ehe);let o=e||"";return Object.keys(i).sort().forEach(s=>{s==="color"?o+=g7(o)?n[s]:ai(n[s]):o+=`${g7(o)?s:ai(s)}${ai(n[s].toString())}`}),o}const Mhe=["name","slot","skipVariantsResolver","skipSx","overridesResolver"];function The(n){return Object.keys(n).length===0}function Che(n){return typeof n=="string"&&n.charCodeAt(0)>96}const Phe=(n,e)=>e.components&&e.components[n]&&e.components[n].styleOverrides?e.components[n].styleOverrides:null,QE=n=>{const e={};return n&&n.forEach(i=>{const o=uq(i.props);e[o]=i.style}),e},Ihe=(n,e)=>{let i=[];return e&&e.components&&e.components[n]&&e.components[n].variants&&(i=e.components[n].variants),QE(i)},eM=(n,e,i)=>{const{ownerState:o={}}=n,s=[];return i&&i.forEach(l=>{let d=!0;Object.keys(l.props).forEach(p=>{o[p]!==l.props[p]&&n[p]!==l.props[p]&&(d=!1)}),d&&s.push(e[uq(l.props)])}),s},Lhe=(n,e,i,o)=>{var s;const l=i==null||(s=i.components)==null||(s=s[o])==null?void 0:s.variants;return eM(n,e,l)};function sx(n){return n!=="ownerState"&&n!=="theme"&&n!=="sx"&&n!=="as"}const Rhe=MD(),khe=n=>n&&n.charAt(0).toLowerCase()+n.slice(1);function iE({defaultTheme:n,theme:e,themeId:i}){return The(e)?n:e[i]||e}function Dhe(n){return n?(e,i)=>i[n]:null}const y7=({styledArg:n,props:e,defaultTheme:i,themeId:o})=>{const s=n(qe({},e,{theme:iE(qe({},e,{defaultTheme:i,themeId:o}))}));let l;if(s&&s.variants&&(l=s.variants,delete s.variants),l){const d=eM(e,QE(l),l);return[s,...d]}return s};function Ohe(n={}){const{themeId:e,defaultTheme:i=Rhe,rootShouldForwardProp:o=sx,slotShouldForwardProp:s=sx}=n,l=d=>ED(qe({},d,{theme:iE(qe({},d,{defaultTheme:i,themeId:e}))}));return l.__mui_systemSx=!0,(d,p={})=>{Ede(d,F=>F.filter(G=>!(G!=null&&G.__mui_systemSx)));const{name:f,slot:y,skipVariantsResolver:_,skipSx:x,overridesResolver:S=Dhe(khe(y))}=p,T=qn(p,Mhe),I=_!==void 0?_:y&&y!=="Root"&&y!=="root"||!1,R=x||!1;let D,L=sx;y==="Root"||y==="root"?L=o:y?L=s:Che(d)&&(L=void 0);const O=Ade(d,qe({shouldForwardProp:L,label:D},T)),N=(F,...G)=>{const j=G?G.map(Q=>{if(typeof Q=="function"&&Q.__emotion_real!==Q)return he=>y7({styledArg:Q,props:he,defaultTheme:i,themeId:e});if(Mh(Q)){let he=Q,fe;return Q&&Q.variants&&(fe=Q.variants,delete he.variants,he=ye=>{let pe=Q;return eM(ye,QE(fe),fe).forEach(Ie=>{pe=wl(pe,Ie)}),pe}),he}return Q}):[];let Y=F;if(Mh(F)){let Q;F&&F.variants&&(Q=F.variants,delete Y.variants,Y=he=>{let fe=F;return eM(he,QE(Q),Q).forEach(pe=>{fe=wl(fe,pe)}),fe})}else typeof F=="function"&&F.__emotion_real!==F&&(Y=Q=>y7({styledArg:F,props:Q,defaultTheme:i,themeId:e}));f&&S&&j.push(Q=>{const he=iE(qe({},Q,{defaultTheme:i,themeId:e})),fe=Phe(f,he);if(fe){const ye={};return Object.entries(fe).forEach(([pe,Me])=>{ye[pe]=typeof Me=="function"?Me(qe({},Q,{theme:he})):Me}),S(Q,ye)}return null}),f&&!I&&j.push(Q=>{const he=iE(qe({},Q,{defaultTheme:i,themeId:e}));return Lhe(Q,Ihe(f,he),he,f)}),R||j.push(l);const te=j.length-G.length;if(Array.isArray(F)&&te>0){const Q=new Array(te).fill("");Y=[...F,...Q],Y.raw=[...F.raw,...Q]}const V=O(Y,...j);return d.muiName&&(V.muiName=d.muiName),V};return O.withConfig&&(N.withConfig=O.withConfig),N}}function Nhe(n){const{theme:e,name:i,props:o}=n;return!e||!e.components||!e.components[i]||!e.components[i].defaultProps?o:uD(e.components[i].defaultProps,o)}function zhe({props:n,name:e,defaultTheme:i,themeId:o}){let s=CD(i);return o&&(s=s[o]||s),Nhe({theme:s,name:e,props:n})}function PD(n,e=0,i=1){return Math.min(Math.max(e,n),i)}function Fhe(n){n=n.slice(1);const e=new RegExp(`.{1,${n.length>=6?2:1}}`,"g");let i=n.match(e);return i&&i[0].length===1&&(i=i.map(o=>o+o)),i?`rgb${i.length===4?"a":""}(${i.map((o,s)=>s<3?parseInt(o,16):Math.round(parseInt(o,16)/255*1e3)/1e3).join(", ")})`:""}function Og(n){if(n.type)return n;if(n.charAt(0)==="#")return Og(Fhe(n));const e=n.indexOf("("),i=n.substring(0,e);if(["rgb","rgba","hsl","hsla","color"].indexOf(i)===-1)throw new Error(xf(9,n));let o=n.substring(e+1,n.length-1),s;if(i==="color"){if(o=o.split(" "),s=o.shift(),o.length===4&&o[3].charAt(0)==="/"&&(o[3]=o[3].slice(1)),["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].indexOf(s)===-1)throw new Error(xf(10,s))}else o=o.split(",");return o=o.map(l=>parseFloat(l)),{type:i,values:o,colorSpace:s}}function ST(n){const{type:e,colorSpace:i}=n;let{values:o}=n;return e.indexOf("rgb")!==-1?o=o.map((s,l)=>l<3?parseInt(s,10):s):e.indexOf("hsl")!==-1&&(o[1]=`${o[1]}%`,o[2]=`${o[2]}%`),e.indexOf("color")!==-1?o=`${i} ${o.join(" ")}`:o=`${o.join(", ")}`,`${e}(${o})`}function Bhe(n){n=Og(n);const{values:e}=n,i=e[0],o=e[1]/100,s=e[2]/100,l=o*Math.min(s,1-s),d=(y,_=(y+i/30)%12)=>s-l*Math.max(Math.min(_-3,9-_,1),-1);let p="rgb";const f=[Math.round(d(0)*255),Math.round(d(8)*255),Math.round(d(4)*255)];return n.type==="hsla"&&(p+="a",f.push(e[3])),ST({type:p,values:f})}function v7(n){n=Og(n);let e=n.type==="hsl"||n.type==="hsla"?Og(Bhe(n)).values:n.values;return e=e.map(i=>(n.type!=="color"&&(i/=255),i<=.03928?i/12.92:((i+.055)/1.055)**2.4)),Number((.2126*e[0]+.7152*e[1]+.0722*e[2]).toFixed(3))}function Uhe(n,e){const i=v7(n),o=v7(e);return(Math.max(i,o)+.05)/(Math.min(i,o)+.05)}function kr(n,e){return n=Og(n),e=PD(e),(n.type==="rgb"||n.type==="hsl")&&(n.type+="a"),n.type==="color"?n.values[3]=`/${e}`:n.values[3]=e,ST(n)}function ID(n,e){if(n=Og(n),e=PD(e),n.type.indexOf("hsl")!==-1)n.values[2]*=1-e;else if(n.type.indexOf("rgb")!==-1||n.type.indexOf("color")!==-1)for(let i=0;i<3;i+=1)n.values[i]*=1-e;return ST(n)}function LD(n,e){if(n=Og(n),e=PD(e),n.type.indexOf("hsl")!==-1)n.values[2]+=(100-n.values[2])*e;else if(n.type.indexOf("rgb")!==-1)for(let i=0;i<3;i+=1)n.values[i]+=(255-n.values[i])*e;else if(n.type.indexOf("color")!==-1)for(let i=0;i<3;i+=1)n.values[i]+=(1-n.values[i])*e;return ST(n)}const Whe=ie.createContext(null),dq=Whe;function hq(){return ie.useContext(dq)}const Vhe=typeof Symbol=="function"&&Symbol.for,Ghe=Vhe?Symbol.for("mui.nested"):"__THEME_NESTED__";function Hhe(n,e){return typeof e=="function"?e(n):qe({},n,e)}function jhe(n){const{children:e,theme:i}=n,o=hq(),s=ie.useMemo(()=>{const l=o===null?i:Hhe(o,i);return l!=null&&(l[Ghe]=o!==null),l},[i,o]);return X(dq.Provider,{value:s,children:e})}const _7={};function b7(n,e,i,o=!1){return ie.useMemo(()=>{const s=n&&e[n]||e;if(typeof i=="function"){const l=i(s),d=n?qe({},e,{[n]:l}):l;return o?()=>d:d}return n?qe({},e,{[n]:i}):qe({},e,i)},[n,e,i,o])}function $he(n){const{children:e,theme:i,themeId:o}=n,s=TD(_7),l=hq()||_7,d=b7(o,s,i),p=b7(o,l,i,!0);return X(jhe,{theme:p,children:X(fT.Provider,{value:d,children:e})})}function Yhe(n,e){return qe({toolbar:{minHeight:56,[n.up("xs")]:{"@media (orientation: landscape)":{minHeight:48}},[n.up("sm")]:{minHeight:64}}},e)}const qhe=["mode","contrastThreshold","tonalOffset"],x7={text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.6)",disabled:"rgba(0, 0, 0, 0.38)"},divider:"rgba(0, 0, 0, 0.12)",background:{paper:Yx.white,default:Yx.white},action:{active:"rgba(0, 0, 0, 0.54)",hover:"rgba(0, 0, 0, 0.04)",hoverOpacity:.04,selected:"rgba(0, 0, 0, 0.08)",selectedOpacity:.08,disabled:"rgba(0, 0, 0, 0.26)",disabledBackground:"rgba(0, 0, 0, 0.12)",disabledOpacity:.38,focus:"rgba(0, 0, 0, 0.12)",focusOpacity:.12,activatedOpacity:.12}},g4={text:{primary:Yx.white,secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",icon:"rgba(255, 255, 255, 0.5)"},divider:"rgba(255, 255, 255, 0.12)",background:{paper:"#121212",default:"#121212"},action:{active:Yx.white,hover:"rgba(255, 255, 255, 0.08)",hoverOpacity:.08,selected:"rgba(255, 255, 255, 0.16)",selectedOpacity:.16,disabled:"rgba(255, 255, 255, 0.3)",disabledBackground:"rgba(255, 255, 255, 0.12)",disabledOpacity:.38,focus:"rgba(255, 255, 255, 0.12)",focusOpacity:.12,activatedOpacity:.24}};function w7(n,e,i,o){const s=o.light||o,l=o.dark||o*1.5;n[e]||(n.hasOwnProperty(i)?n[e]=n[i]:e==="light"?n.light=LD(n.main,s):e==="dark"&&(n.dark=ID(n.main,l)))}function Xhe(n="light"){return n==="dark"?{main:kv[200],light:kv[50],dark:kv[400]}:{main:kv[700],light:kv[400],dark:kv[800]}}function Zhe(n="light"){return n==="dark"?{main:Rv[200],light:Rv[50],dark:Rv[400]}:{main:Rv[500],light:Rv[300],dark:Rv[700]}}function Khe(n="light"){return n==="dark"?{main:Lv[500],light:Lv[300],dark:Lv[700]}:{main:Lv[700],light:Lv[400],dark:Lv[800]}}function Jhe(n="light"){return n==="dark"?{main:Dv[400],light:Dv[300],dark:Dv[700]}:{main:Dv[700],light:Dv[500],dark:Dv[900]}}function Qhe(n="light"){return n==="dark"?{main:Ov[400],light:Ov[300],dark:Ov[700]}:{main:Ov[800],light:Ov[500],dark:Ov[900]}}function epe(n="light"){return n==="dark"?{main:rb[400],light:rb[300],dark:rb[700]}:{main:"#ed6c02",light:rb[500],dark:rb[900]}}function tpe(n){const{mode:e="light",contrastThreshold:i=3,tonalOffset:o=.2}=n,s=qn(n,qhe),l=n.primary||Xhe(e),d=n.secondary||Zhe(e),p=n.error||Khe(e),f=n.info||Jhe(e),y=n.success||Qhe(e),_=n.warning||epe(e);function x(R){return Uhe(R,g4.text.primary)>=i?g4.text.primary:x7.text.primary}const S=({color:R,name:D,mainShade:L=500,lightShade:O=300,darkShade:N=700})=>{if(R=qe({},R),!R.main&&R[L]&&(R.main=R[L]),!R.hasOwnProperty("main"))throw new Error(xf(11,D?` (${D})`:"",L));if(typeof R.main!="string")throw new Error(xf(12,D?` (${D})`:"",JSON.stringify(R.main)));return w7(R,"light",O,o),w7(R,"dark",N,o),R.contrastText||(R.contrastText=x(R.main)),R},T={dark:g4,light:x7};return wl(qe({common:qe({},Yx),mode:e,primary:S({color:l,name:"primary"}),secondary:S({color:d,name:"secondary",mainShade:"A400",lightShade:"A200",darkShade:"A700"}),error:S({color:p,name:"error"}),warning:S({color:_,name:"warning"}),info:S({color:f,name:"info"}),success:S({color:y,name:"success"}),grey:Kce,contrastThreshold:i,getContrastText:x,augmentColor:S,tonalOffset:o},T[e]),s)}const npe=["fontFamily","fontSize","fontWeightLight","fontWeightRegular","fontWeightMedium","fontWeightBold","htmlFontSize","allVariants","pxToRem"];function ipe(n){return Math.round(n*1e5)/1e5}const S7={textTransform:"uppercase"},A7='"Roboto", "Helvetica", "Arial", sans-serif';function ape(n,e){const i=typeof e=="function"?e(n):e,{fontFamily:o=A7,fontSize:s=14,fontWeightLight:l=300,fontWeightRegular:d=400,fontWeightMedium:p=500,fontWeightBold:f=700,htmlFontSize:y=16,allVariants:_,pxToRem:x}=i,S=qn(i,npe),T=s/14,I=x||(L=>`${L/y*T}rem`),R=(L,O,N,F,G)=>qe({fontFamily:o,fontWeight:L,fontSize:I(O),lineHeight:N},o===A7?{letterSpacing:`${ipe(F/O)}em`}:{},G,_),D={h1:R(l,96,1.167,-1.5),h2:R(l,60,1.2,-.5),h3:R(d,48,1.167,0),h4:R(d,34,1.235,.25),h5:R(d,24,1.334,0),h6:R(p,20,1.6,.15),subtitle1:R(d,16,1.75,.15),subtitle2:R(p,14,1.57,.1),body1:R(d,16,1.5,.15),body2:R(d,14,1.43,.15),button:R(p,14,1.75,.4,S7),caption:R(d,12,1.66,.4),overline:R(d,12,2.66,1,S7),inherit:{fontFamily:"inherit",fontWeight:"inherit",fontSize:"inherit",lineHeight:"inherit",letterSpacing:"inherit"}};return wl(qe({htmlFontSize:y,pxToRem:I,fontFamily:o,fontSize:s,fontWeightLight:l,fontWeightRegular:d,fontWeightMedium:p,fontWeightBold:f},D),S,{clone:!1})}const rpe=.2,ope=.14,spe=.12;function _r(...n){return[`${n[0]}px ${n[1]}px ${n[2]}px ${n[3]}px rgba(0,0,0,${rpe})`,`${n[4]}px ${n[5]}px ${n[6]}px ${n[7]}px rgba(0,0,0,${ope})`,`${n[8]}px ${n[9]}px ${n[10]}px ${n[11]}px rgba(0,0,0,${spe})`].join(",")}const lpe=["none",_r(0,2,1,-1,0,1,1,0,0,1,3,0),_r(0,3,1,-2,0,2,2,0,0,1,5,0),_r(0,3,3,-2,0,3,4,0,0,1,8,0),_r(0,2,4,-1,0,4,5,0,0,1,10,0),_r(0,3,5,-1,0,5,8,0,0,1,14,0),_r(0,3,5,-1,0,6,10,0,0,1,18,0),_r(0,4,5,-2,0,7,10,1,0,2,16,1),_r(0,5,5,-3,0,8,10,1,0,3,14,2),_r(0,5,6,-3,0,9,12,1,0,3,16,2),_r(0,6,6,-3,0,10,14,1,0,4,18,3),_r(0,6,7,-4,0,11,15,1,0,4,20,3),_r(0,7,8,-4,0,12,17,2,0,5,22,4),_r(0,7,8,-4,0,13,19,2,0,5,24,4),_r(0,7,9,-4,0,14,21,2,0,5,26,4),_r(0,8,9,-5,0,15,22,2,0,6,28,5),_r(0,8,10,-5,0,16,24,2,0,6,30,5),_r(0,8,11,-5,0,17,26,2,0,6,32,5),_r(0,9,11,-5,0,18,28,2,0,7,34,6),_r(0,9,12,-6,0,19,29,2,0,7,36,6),_r(0,10,13,-6,0,20,31,3,0,8,38,7),_r(0,10,13,-6,0,21,33,3,0,8,40,7),_r(0,10,14,-6,0,22,35,3,0,8,42,7),_r(0,11,14,-7,0,23,36,3,0,9,44,8),_r(0,11,15,-7,0,24,38,3,0,9,46,8)],cpe=lpe,upe=["duration","easing","delay"],dpe={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",easeIn:"cubic-bezier(0.4, 0, 1, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},hpe={shortest:150,shorter:200,short:250,standard:300,complex:375,enteringScreen:225,leavingScreen:195};function E7(n){return`${Math.round(n)}ms`}function ppe(n){if(!n)return 0;const e=n/36;return Math.round((4+15*e**.25+e/5)*10)}function fpe(n){const e=qe({},dpe,n.easing),i=qe({},hpe,n.duration);return qe({getAutoHeightDuration:ppe,create:(s=["all"],l={})=>{const{duration:d=i.standard,easing:p=e.easeInOut,delay:f=0}=l;return qn(l,upe),(Array.isArray(s)?s:[s]).map(y=>`${y} ${typeof d=="string"?d:E7(d)} ${p} ${typeof f=="string"?f:E7(f)}`).join(",")}},n,{easing:e,duration:i})}const mpe={mobileStepper:1e3,fab:1050,speedDial:1050,appBar:1100,drawer:1200,modal:1300,snackbar:1400,tooltip:1500},gpe=mpe,ype=["breakpoints","mixins","spacing","palette","transitions","typography","shape"];function pq(n={},...e){const{mixins:i={},palette:o={},transitions:s={},typography:l={}}=n,d=qn(n,ype);if(n.vars)throw new Error(xf(18));const p=tpe(o),f=MD(n);let y=wl(f,{mixins:Yhe(f.breakpoints,i),palette:p,shadows:cpe.slice(),typography:ape(p,l),transitions:fpe(s),zIndex:qe({},gpe)});return y=wl(y,d),y=e.reduce((_,x)=>wl(_,x),y),y.unstable_sxConfig=qe({},wT,d==null?void 0:d.unstable_sxConfig),y.unstable_sx=function(x){return ED({sx:x,theme:this})},y}const vpe=pq(),AT=vpe;function Zg(){const n=CD(AT);return n[e_]||n}function _a({props:n,name:e}){return zhe({props:n,name:e,defaultTheme:AT,themeId:e_})}const Ml=n=>sx(n)&&n!=="classes",_pe=sx,bpe=Ohe({themeId:e_,defaultTheme:AT,rootShouldForwardProp:Ml}),Bn=bpe,xpe=["theme"];function wpe(n){let{theme:e}=n,i=qn(n,xpe);const o=e[e_];return X($he,qe({},i,{themeId:o?e_:void 0,theme:o||e}))}const Spe=n=>{let e;return n<1?e=5.11916*n**2:e=4.5*Math.log(n+1)+2,(e/100).toFixed(2)},M7=Spe;function Ape(n){return aa("MuiSvgIcon",n)}Zi("MuiSvgIcon",["root","colorPrimary","colorSecondary","colorAction","colorError","colorDisabled","fontSizeInherit","fontSizeSmall","fontSizeMedium","fontSizeLarge"]);const Epe=["children","className","color","component","fontSize","htmlColor","inheritViewBox","titleAccess","viewBox"],Mpe=n=>{const{color:e,fontSize:i,classes:o}=n,s={root:["root",e!=="inherit"&&`color${ai(e)}`,`fontSize${ai(i)}`]};return ha(s,Ape,o)},Tpe=Bn("svg",{name:"MuiSvgIcon",slot:"Root",overridesResolver:(n,e)=>{const{ownerState:i}=n;return[e.root,i.color!=="inherit"&&e[`color${ai(i.color)}`],e[`fontSize${ai(i.fontSize)}`]]}})(({theme:n,ownerState:e})=>{var i,o,s,l,d,p,f,y,_,x,S,T,I;return{userSelect:"none",width:"1em",height:"1em",display:"inline-block",fill:e.hasSvgAsChild?void 0:"currentColor",flexShrink:0,transition:(i=n.transitions)==null||(o=i.create)==null?void 0:o.call(i,"fill",{duration:(s=n.transitions)==null||(s=s.duration)==null?void 0:s.shorter}),fontSize:{inherit:"inherit",small:((l=n.typography)==null||(d=l.pxToRem)==null?void 0:d.call(l,20))||"1.25rem",medium:((p=n.typography)==null||(f=p.pxToRem)==null?void 0:f.call(p,24))||"1.5rem",large:((y=n.typography)==null||(_=y.pxToRem)==null?void 0:_.call(y,35))||"2.1875rem"}[e.fontSize],color:(x=(S=(n.vars||n).palette)==null||(S=S[e.color])==null?void 0:S.main)!=null?x:{action:(T=(n.vars||n).palette)==null||(T=T.action)==null?void 0:T.active,disabled:(I=(n.vars||n).palette)==null||(I=I.action)==null?void 0:I.disabled,inherit:void 0}[e.color]}}),fq=ie.forwardRef(function(e,i){const o=_a({props:e,name:"MuiSvgIcon"}),{children:s,className:l,color:d="inherit",component:p="svg",fontSize:f="medium",htmlColor:y,inheritViewBox:_=!1,titleAccess:x,viewBox:S="0 0 24 24"}=o,T=qn(o,Epe),I=ie.isValidElement(s)&&s.type==="svg",R=qe({},o,{color:d,component:p,fontSize:f,instanceFontSize:e.fontSize,inheritViewBox:_,viewBox:S,hasSvgAsChild:I}),D={};_||(D.viewBox=S);const L=Mpe(R);return $e(Tpe,qe({as:p,className:_i(L.root,l),focusable:"false",color:y,"aria-hidden":x?void 0:!0,role:x?"img":void 0,ref:i},D,T,I&&s.props,{ownerState:R,children:[I?s.props.children:s,x?X("title",{children:x}):null]}))});fq.muiName="SvgIcon";const T7=fq;function Vw(n,e){function i(o,s){return X(T7,qe({"data-testid":`${e}Icon`,ref:s},o,{children:n}))}return i.muiName=T7.muiName,ie.memo(ie.forwardRef(i))}const Cpe={configure:n=>{UY.configure(n)}},Ppe=Object.freeze(Object.defineProperty({__proto__:null,capitalize:ai,createChainedFunction:NL,createSvgIcon:Vw,debounce:JM,deprecatedPropType:eue,isMuiElement:QA,ownerDocument:ws,ownerWindow:bd,requirePropFactory:tue,setRef:ZE,unstable_ClassNameGenerator:Cpe,unstable_useEnhancedEffect:gu,unstable_useId:lD,unsupportedProp:aue,useControlled:qx,useEventCallback:Qp,useForkRef:So,useIsFocusVisible:cD},Symbol.toStringTag,{value:"Module"}));function WL(n,e){return WL=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,s){return o.__proto__=s,o},WL(n,e)}function mq(n,e){n.prototype=Object.create(e.prototype),n.prototype.constructor=n,WL(n,e)}const C7={disabled:!1},tM=cu.createContext(null);var Ipe=function(e){return e.scrollTop},Bb="unmounted",Qm="exited",eg="entering",d0="entered",VL="exiting",Yh=function(n){mq(e,n);function e(o,s){var l;l=n.call(this,o,s)||this;var d=s,p=d&&!d.isMounting?o.enter:o.appear,f;return l.appearStatus=null,o.in?p?(f=Qm,l.appearStatus=eg):f=d0:o.unmountOnExit||o.mountOnEnter?f=Bb:f=Qm,l.state={status:f},l.nextCallback=null,l}e.getDerivedStateFromProps=function(s,l){var d=s.in;return d&&l.status===Bb?{status:Qm}:null};var i=e.prototype;return i.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},i.componentDidUpdate=function(s){var l=null;if(s!==this.props){var d=this.state.status;this.props.in?d!==eg&&d!==d0&&(l=eg):(d===eg||d===d0)&&(l=VL)}this.updateStatus(!1,l)},i.componentWillUnmount=function(){this.cancelNextCallback()},i.getTimeouts=function(){var s=this.props.timeout,l,d,p;return l=d=p=s,s!=null&&typeof s!="number"&&(l=s.exit,d=s.enter,p=s.appear!==void 0?s.appear:d),{exit:l,enter:d,appear:p}},i.updateStatus=function(s,l){if(s===void 0&&(s=!1),l!==null)if(this.cancelNextCallback(),l===eg){if(this.props.unmountOnExit||this.props.mountOnEnter){var d=this.props.nodeRef?this.props.nodeRef.current:Fb.findDOMNode(this);d&&Ipe(d)}this.performEnter(s)}else this.performExit();else this.props.unmountOnExit&&this.state.status===Qm&&this.setState({status:Bb})},i.performEnter=function(s){var l=this,d=this.props.enter,p=this.context?this.context.isMounting:s,f=this.props.nodeRef?[p]:[Fb.findDOMNode(this),p],y=f[0],_=f[1],x=this.getTimeouts(),S=p?x.appear:x.enter;if(!s&&!d||C7.disabled){this.safeSetState({status:d0},function(){l.props.onEntered(y)});return}this.props.onEnter(y,_),this.safeSetState({status:eg},function(){l.props.onEntering(y,_),l.onTransitionEnd(S,function(){l.safeSetState({status:d0},function(){l.props.onEntered(y,_)})})})},i.performExit=function(){var s=this,l=this.props.exit,d=this.getTimeouts(),p=this.props.nodeRef?void 0:Fb.findDOMNode(this);if(!l||C7.disabled){this.safeSetState({status:Qm},function(){s.props.onExited(p)});return}this.props.onExit(p),this.safeSetState({status:VL},function(){s.props.onExiting(p),s.onTransitionEnd(d.exit,function(){s.safeSetState({status:Qm},function(){s.props.onExited(p)})})})},i.cancelNextCallback=function(){this.nextCallback!==null&&(this.nextCallback.cancel(),this.nextCallback=null)},i.safeSetState=function(s,l){l=this.setNextCallback(l),this.setState(s,l)},i.setNextCallback=function(s){var l=this,d=!0;return this.nextCallback=function(p){d&&(d=!1,l.nextCallback=null,s(p))},this.nextCallback.cancel=function(){d=!1},this.nextCallback},i.onTransitionEnd=function(s,l){this.setNextCallback(l);var d=this.props.nodeRef?this.props.nodeRef.current:Fb.findDOMNode(this),p=s==null&&!this.props.addEndListener;if(!d||p){setTimeout(this.nextCallback,0);return}if(this.props.addEndListener){var f=this.props.nodeRef?[this.nextCallback]:[d,this.nextCallback],y=f[0],_=f[1];this.props.addEndListener(y,_)}s!=null&&setTimeout(this.nextCallback,s)},i.render=function(){var s=this.state.status;if(s===Bb)return null;var l=this.props,d=l.children;l.in,l.mountOnEnter,l.unmountOnExit,l.appear,l.enter,l.exit,l.timeout,l.addEndListener,l.onEnter,l.onEntering,l.onEntered,l.onExit,l.onExiting,l.onExited,l.nodeRef;var p=qn(l,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]);return cu.createElement(tM.Provider,{value:null},typeof d=="function"?d(s,p):cu.cloneElement(cu.Children.only(d),p))},e}(cu.Component);Yh.contextType=tM;Yh.propTypes={};function Nv(){}Yh.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:Nv,onEntering:Nv,onEntered:Nv,onExit:Nv,onExiting:Nv,onExited:Nv};Yh.UNMOUNTED=Bb;Yh.EXITED=Qm;Yh.ENTERING=eg;Yh.ENTERED=d0;Yh.EXITING=VL;const RD=Yh;function Lpe(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function kD(n,e){var i=function(l){return e&&ie.isValidElement(l)?e(l):l},o=Object.create(null);return n&&ie.Children.map(n,function(s){return s}).forEach(function(s){o[s.key]=i(s)}),o}function Rpe(n,e){n=n||{},e=e||{};function i(_){return _ in e?e[_]:n[_]}var o=Object.create(null),s=[];for(var l in n)l in e?s.length&&(o[l]=s,s=[]):s.push(l);var d,p={};for(var f in e){if(o[f])for(d=0;d<o[f].length;d++){var y=o[f][d];p[o[f][d]]=i(y)}p[f]=i(f)}for(d=0;d<s.length;d++)p[s[d]]=i(s[d]);return p}function hg(n,e,i){return i[e]!=null?i[e]:n.props[e]}function kpe(n,e){return kD(n.children,function(i){return ie.cloneElement(i,{onExited:e.bind(null,i),in:!0,appear:hg(i,"appear",n),enter:hg(i,"enter",n),exit:hg(i,"exit",n)})})}function Dpe(n,e,i){var o=kD(n.children),s=Rpe(e,o);return Object.keys(s).forEach(function(l){var d=s[l];if(ie.isValidElement(d)){var p=l in e,f=l in o,y=e[l],_=ie.isValidElement(y)&&!y.props.in;f&&(!p||_)?s[l]=ie.cloneElement(d,{onExited:i.bind(null,d),in:!0,exit:hg(d,"exit",n),enter:hg(d,"enter",n)}):!f&&p&&!_?s[l]=ie.cloneElement(d,{in:!1}):f&&p&&ie.isValidElement(y)&&(s[l]=ie.cloneElement(d,{onExited:i.bind(null,d),in:y.props.in,exit:hg(d,"exit",n),enter:hg(d,"enter",n)}))}}),s}var Ope=Object.values||function(n){return Object.keys(n).map(function(e){return n[e]})},Npe={component:"div",childFactory:function(e){return e}},DD=function(n){mq(e,n);function e(o,s){var l;l=n.call(this,o,s)||this;var d=l.handleExited.bind(Lpe(l));return l.state={contextValue:{isMounting:!0},handleExited:d,firstRender:!0},l}var i=e.prototype;return i.componentDidMount=function(){this.mounted=!0,this.setState({contextValue:{isMounting:!1}})},i.componentWillUnmount=function(){this.mounted=!1},e.getDerivedStateFromProps=function(s,l){var d=l.children,p=l.handleExited,f=l.firstRender;return{children:f?kpe(s,p):Dpe(s,d,p),firstRender:!1}},i.handleExited=function(s,l){var d=kD(this.props.children);s.key in d||(s.props.onExited&&s.props.onExited(l),this.mounted&&this.setState(function(p){var f=qe({},p.children);return delete f[s.key],{children:f}}))},i.render=function(){var s=this.props,l=s.component,d=s.childFactory,p=qn(s,["component","childFactory"]),f=this.state.contextValue,y=Ope(this.state.children).map(d);return delete p.appear,delete p.enter,delete p.exit,l===null?cu.createElement(tM.Provider,{value:f},y):cu.createElement(tM.Provider,{value:f},cu.createElement(l,p,y))},e}(cu.Component);DD.propTypes={};DD.defaultProps=Npe;const zpe=DD,OD=n=>n.scrollTop;function n_(n,e){var i,o;const{timeout:s,easing:l,style:d={}}=n;return{duration:(i=d.transitionDuration)!=null?i:typeof s=="number"?s:s[e.mode]||0,easing:(o=d.transitionTimingFunction)!=null?o:typeof l=="object"?l[e.mode]:l,delay:d.transitionDelay}}function Fpe(n){return aa("MuiPaper",n)}Zi("MuiPaper",["root","rounded","outlined","elevation","elevation0","elevation1","elevation2","elevation3","elevation4","elevation5","elevation6","elevation7","elevation8","elevation9","elevation10","elevation11","elevation12","elevation13","elevation14","elevation15","elevation16","elevation17","elevation18","elevation19","elevation20","elevation21","elevation22","elevation23","elevation24"]);const Bpe=["className","component","elevation","square","variant"],Upe=n=>{const{square:e,elevation:i,variant:o,classes:s}=n,l={root:["root",o,!e&&"rounded",o==="elevation"&&`elevation${i}`]};return ha(l,Fpe,s)},Wpe=Bn("div",{name:"MuiPaper",slot:"Root",overridesResolver:(n,e)=>{const{ownerState:i}=n;return[e.root,e[i.variant],!i.square&&e.rounded,i.variant==="elevation"&&e[`elevation${i.elevation}`]]}})(({theme:n,ownerState:e})=>{var i;return qe({backgroundColor:(n.vars||n).palette.background.paper,color:(n.vars||n).palette.text.primary,transition:n.transitions.create("box-shadow")},!e.square&&{borderRadius:n.shape.borderRadius},e.variant==="outlined"&&{border:`1px solid ${(n.vars||n).palette.divider}`},e.variant==="elevation"&&qe({boxShadow:(n.vars||n).shadows[e.elevation]},!n.vars&&n.palette.mode==="dark"&&{backgroundImage:`linear-gradient(${kr("#fff",M7(e.elevation))}, ${kr("#fff",M7(e.elevation))})`},n.vars&&{backgroundImage:(i=n.vars.overlays)==null?void 0:i[e.elevation]}))}),Vpe=ie.forwardRef(function(e,i){const o=_a({props:e,name:"MuiPaper"}),{className:s,component:l="div",elevation:d=1,square:p=!1,variant:f="elevation"}=o,y=qn(o,Bpe),_=qe({},o,{component:l,elevation:d,square:p,variant:f}),x=Upe(_);return X(Wpe,qe({as:l,ownerState:_,className:_i(x.root,s),ref:i},y))}),gq=Vpe;function Gpe(n){const{className:e,classes:i,pulsate:o=!1,rippleX:s,rippleY:l,rippleSize:d,in:p,onExited:f,timeout:y}=n,[_,x]=ie.useState(!1),S=_i(e,i.ripple,i.rippleVisible,o&&i.ripplePulsate),T={width:d,height:d,top:-(d/2)+l,left:-(d/2)+s},I=_i(i.child,_&&i.childLeaving,o&&i.childPulsate);return!p&&!_&&x(!0),ie.useEffect(()=>{if(!p&&f!=null){const R=setTimeout(f,y);return()=>{clearTimeout(R)}}},[f,p,y]),X("span",{className:S,style:T,children:X("span",{className:I})})}const Hpe=Zi("MuiTouchRipple",["root","ripple","rippleVisible","ripplePulsate","child","childLeaving","childPulsate"]),xc=Hpe,jpe=["center","classes","className"];let ET=n=>n,P7,I7,L7,R7;const GL=550,$pe=80,Ype=_D(P7||(P7=ET`
  0% {
    transform: scale(0);
    opacity: 0.1;
  }

  100% {
    transform: scale(1);
    opacity: 0.3;
  }
`)),qpe=_D(I7||(I7=ET`
  0% {
    opacity: 1;
  }

  100% {
    opacity: 0;
  }
`)),Xpe=_D(L7||(L7=ET`
  0% {
    transform: scale(1);
  }

  50% {
    transform: scale(0.92);
  }

  100% {
    transform: scale(1);
  }
`)),Zpe=Bn("span",{name:"MuiTouchRipple",slot:"Root"})({overflow:"hidden",pointerEvents:"none",position:"absolute",zIndex:0,top:0,right:0,bottom:0,left:0,borderRadius:"inherit"}),Kpe=Bn(Gpe,{name:"MuiTouchRipple",slot:"Ripple"})(R7||(R7=ET`
  opacity: 0;
  position: absolute;

  &.${0} {
    opacity: 0.3;
    transform: scale(1);
    animation-name: ${0};
    animation-duration: ${0}ms;
    animation-timing-function: ${0};
  }

  &.${0} {
    animation-duration: ${0}ms;
  }

  & .${0} {
    opacity: 1;
    display: block;
    width: 100%;
    height: 100%;
    border-radius: 50%;
    background-color: currentColor;
  }

  & .${0} {
    opacity: 0;
    animation-name: ${0};
    animation-duration: ${0}ms;
    animation-timing-function: ${0};
  }

  & .${0} {
    position: absolute;
    /* @noflip */
    left: 0px;
    top: 0;
    animation-name: ${0};
    animation-duration: 2500ms;
    animation-timing-function: ${0};
    animation-iteration-count: infinite;
    animation-delay: 200ms;
  }
`),xc.rippleVisible,Ype,GL,({theme:n})=>n.transitions.easing.easeInOut,xc.ripplePulsate,({theme:n})=>n.transitions.duration.shorter,xc.child,xc.childLeaving,qpe,GL,({theme:n})=>n.transitions.easing.easeInOut,xc.childPulsate,Xpe,({theme:n})=>n.transitions.easing.easeInOut),Jpe=ie.forwardRef(function(e,i){const o=_a({props:e,name:"MuiTouchRipple"}),{center:s=!1,classes:l={},className:d}=o,p=qn(o,jpe),[f,y]=ie.useState([]),_=ie.useRef(0),x=ie.useRef(null);ie.useEffect(()=>{x.current&&(x.current(),x.current=null)},[f]);const S=ie.useRef(!1),T=ie.useRef(0),I=ie.useRef(null),R=ie.useRef(null);ie.useEffect(()=>()=>{T.current&&clearTimeout(T.current)},[]);const D=ie.useCallback(F=>{const{pulsate:G,rippleX:j,rippleY:Y,rippleSize:te,cb:V}=F;y(Q=>[...Q,X(Kpe,{classes:{ripple:_i(l.ripple,xc.ripple),rippleVisible:_i(l.rippleVisible,xc.rippleVisible),ripplePulsate:_i(l.ripplePulsate,xc.ripplePulsate),child:_i(l.child,xc.child),childLeaving:_i(l.childLeaving,xc.childLeaving),childPulsate:_i(l.childPulsate,xc.childPulsate)},timeout:GL,pulsate:G,rippleX:j,rippleY:Y,rippleSize:te},_.current)]),_.current+=1,x.current=V},[l]),L=ie.useCallback((F={},G={},j=()=>{})=>{const{pulsate:Y=!1,center:te=s||G.pulsate,fakeElement:V=!1}=G;if((F==null?void 0:F.type)==="mousedown"&&S.current){S.current=!1;return}(F==null?void 0:F.type)==="touchstart"&&(S.current=!0);const Q=V?null:R.current,he=Q?Q.getBoundingClientRect():{width:0,height:0,left:0,top:0};let fe,ye,pe;if(te||F===void 0||F.clientX===0&&F.clientY===0||!F.clientX&&!F.touches)fe=Math.round(he.width/2),ye=Math.round(he.height/2);else{const{clientX:Me,clientY:Ie}=F.touches&&F.touches.length>0?F.touches[0]:F;fe=Math.round(Me-he.left),ye=Math.round(Ie-he.top)}if(te)pe=Math.sqrt((2*he.width**2+he.height**2)/3),pe%2===0&&(pe+=1);else{const Me=Math.max(Math.abs((Q?Q.clientWidth:0)-fe),fe)*2+2,Ie=Math.max(Math.abs((Q?Q.clientHeight:0)-ye),ye)*2+2;pe=Math.sqrt(Me**2+Ie**2)}F!=null&&F.touches?I.current===null&&(I.current=()=>{D({pulsate:Y,rippleX:fe,rippleY:ye,rippleSize:pe,cb:j})},T.current=setTimeout(()=>{I.current&&(I.current(),I.current=null)},$pe)):D({pulsate:Y,rippleX:fe,rippleY:ye,rippleSize:pe,cb:j})},[s,D]),O=ie.useCallback(()=>{L({},{pulsate:!0})},[L]),N=ie.useCallback((F,G)=>{if(clearTimeout(T.current),(F==null?void 0:F.type)==="touchend"&&I.current){I.current(),I.current=null,T.current=setTimeout(()=>{N(F,G)});return}I.current=null,y(j=>j.length>0?j.slice(1):j),x.current=G},[]);return ie.useImperativeHandle(i,()=>({pulsate:O,start:L,stop:N}),[O,L,N]),X(Zpe,qe({className:_i(xc.root,l.root,d),ref:R},p,{children:X(zpe,{component:null,exit:!0,children:f})}))}),Qpe=Jpe;function efe(n){return aa("MuiButtonBase",n)}const tfe=Zi("MuiButtonBase",["root","disabled","focusVisible"]),nfe=tfe,ife=["action","centerRipple","children","className","component","disabled","disableRipple","disableTouchRipple","focusRipple","focusVisibleClassName","LinkComponent","onBlur","onClick","onContextMenu","onDragLeave","onFocus","onFocusVisible","onKeyDown","onKeyUp","onMouseDown","onMouseLeave","onMouseUp","onTouchEnd","onTouchMove","onTouchStart","tabIndex","TouchRippleProps","touchRippleRef","type"],afe=n=>{const{disabled:e,focusVisible:i,focusVisibleClassName:o,classes:s}=n,d=ha({root:["root",e&&"disabled",i&&"focusVisible"]},efe,s);return i&&o&&(d.root+=` ${o}`),d},rfe=Bn("button",{name:"MuiButtonBase",slot:"Root",overridesResolver:(n,e)=>e.root})({display:"inline-flex",alignItems:"center",justifyContent:"center",position:"relative",boxSizing:"border-box",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle",MozAppearance:"none",WebkitAppearance:"none",textDecoration:"none",color:"inherit","&::-moz-focus-inner":{borderStyle:"none"},[`&.${nfe.disabled}`]:{pointerEvents:"none",cursor:"default"},"@media print":{colorAdjust:"exact"}}),ofe=ie.forwardRef(function(e,i){const o=_a({props:e,name:"MuiButtonBase"}),{action:s,centerRipple:l=!1,children:d,className:p,component:f="button",disabled:y=!1,disableRipple:_=!1,disableTouchRipple:x=!1,focusRipple:S=!1,LinkComponent:T="a",onBlur:I,onClick:R,onContextMenu:D,onDragLeave:L,onFocus:O,onFocusVisible:N,onKeyDown:F,onKeyUp:G,onMouseDown:j,onMouseLeave:Y,onMouseUp:te,onTouchEnd:V,onTouchMove:Q,onTouchStart:he,tabIndex:fe=0,TouchRippleProps:ye,touchRippleRef:pe,type:Me}=o,Ie=qn(o,ife),ze=ie.useRef(null),le=ie.useRef(null),me=So(le,pe),{isFocusVisibleRef:xe,onFocus:ae,onBlur:Ee,ref:Je}=cD(),[Ze,Ke]=ie.useState(!1);y&&Ze&&Ke(!1),ie.useImperativeHandle(s,()=>({focusVisible:()=>{Ke(!0),ze.current.focus()}}),[]);const[Fe,ct]=ie.useState(!1);ie.useEffect(()=>{ct(!0)},[]);const Ct=Fe&&!_&&!y;ie.useEffect(()=>{Ze&&S&&!_&&Fe&&le.current.pulsate()},[_,S,Ze,Fe]);function kt(Et,Ut,Wt=x){return Qp(Ht=>(Ut&&Ut(Ht),!Wt&&le.current&&le.current[Et](Ht),!0))}const Kt=kt("start",j),At=kt("stop",D),Pe=kt("stop",L),ft=kt("stop",te),gt=kt("stop",Et=>{Ze&&Et.preventDefault(),Y&&Y(Et)}),_t=kt("start",he),Be=kt("stop",V),ue=kt("stop",Q),se=kt("stop",Et=>{Ee(Et),xe.current===!1&&Ke(!1),I&&I(Et)},!1),_e=Qp(Et=>{ze.current||(ze.current=Et.currentTarget),ae(Et),xe.current===!0&&(Ke(!0),N&&N(Et)),O&&O(Et)}),je=()=>{const Et=ze.current;return f&&f!=="button"&&!(Et.tagName==="A"&&Et.href)},De=ie.useRef(!1),st=Qp(Et=>{S&&!De.current&&Ze&&le.current&&Et.key===" "&&(De.current=!0,le.current.stop(Et,()=>{le.current.start(Et)})),Et.target===Et.currentTarget&&je()&&Et.key===" "&&Et.preventDefault(),F&&F(Et),Et.target===Et.currentTarget&&je()&&Et.key==="Enter"&&!y&&(Et.preventDefault(),R&&R(Et))}),de=Qp(Et=>{S&&Et.key===" "&&le.current&&Ze&&!Et.defaultPrevented&&(De.current=!1,le.current.stop(Et,()=>{le.current.pulsate(Et)})),G&&G(Et),R&&Et.target===Et.currentTarget&&je()&&Et.key===" "&&!Et.defaultPrevented&&R(Et)});let ne=f;ne==="button"&&(Ie.href||Ie.to)&&(ne=T);const Oe={};ne==="button"?(Oe.type=Me===void 0?"button":Me,Oe.disabled=y):(!Ie.href&&!Ie.to&&(Oe.role="button"),y&&(Oe["aria-disabled"]=y));const ut=So(i,Je,ze),it=qe({},o,{centerRipple:l,component:f,disabled:y,disableRipple:_,disableTouchRipple:x,focusRipple:S,tabIndex:fe,focusVisible:Ze}),lt=afe(it);return $e(rfe,qe({as:ne,className:_i(lt.root,p),ownerState:it,onBlur:se,onClick:R,onContextMenu:At,onFocus:_e,onKeyDown:st,onKeyUp:de,onMouseDown:Kt,onMouseLeave:gt,onMouseUp:ft,onDragLeave:Pe,onTouchEnd:Be,onTouchMove:ue,onTouchStart:_t,ref:ut,tabIndex:y?-1:fe,type:Me},Oe,Ie,{children:[d,Ct?X(Qpe,qe({ref:me,center:l},ye)):null]}))}),MT=ofe;function sfe(n){return aa("MuiTypography",n)}Zi("MuiTypography",["root","h1","h2","h3","h4","h5","h6","subtitle1","subtitle2","body1","body2","inherit","button","caption","overline","alignLeft","alignRight","alignCenter","alignJustify","noWrap","gutterBottom","paragraph"]);const lfe=["align","className","component","gutterBottom","noWrap","paragraph","variant","variantMapping"],cfe=n=>{const{align:e,gutterBottom:i,noWrap:o,paragraph:s,variant:l,classes:d}=n,p={root:["root",l,n.align!=="inherit"&&`align${ai(e)}`,i&&"gutterBottom",o&&"noWrap",s&&"paragraph"]};return ha(p,sfe,d)},ufe=Bn("span",{name:"MuiTypography",slot:"Root",overridesResolver:(n,e)=>{const{ownerState:i}=n;return[e.root,i.variant&&e[i.variant],i.align!=="inherit"&&e[`align${ai(i.align)}`],i.noWrap&&e.noWrap,i.gutterBottom&&e.gutterBottom,i.paragraph&&e.paragraph]}})(({theme:n,ownerState:e})=>qe({margin:0},e.variant==="inherit"&&{font:"inherit"},e.variant!=="inherit"&&n.typography[e.variant],e.align!=="inherit"&&{textAlign:e.align},e.noWrap&&{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},e.gutterBottom&&{marginBottom:"0.35em"},e.paragraph&&{marginBottom:16})),k7={h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",h6:"h6",subtitle1:"h6",subtitle2:"h6",body1:"p",body2:"p",inherit:"p"},dfe={primary:"primary.main",textPrimary:"text.primary",secondary:"secondary.main",textSecondary:"text.secondary",error:"error.main"},hfe=n=>dfe[n]||n,pfe=ie.forwardRef(function(e,i){const o=_a({props:e,name:"MuiTypography"}),s=hfe(o.color),l=Ahe(qe({},o,{color:s})),{align:d="inherit",className:p,component:f,gutterBottom:y=!1,noWrap:_=!1,paragraph:x=!1,variant:S="body1",variantMapping:T=k7}=l,I=qn(l,lfe),R=qe({},l,{align:d,color:s,className:p,component:f,gutterBottom:y,noWrap:_,paragraph:x,variant:S,variantMapping:T}),D=f||(x?"p":T[S]||k7[S])||"span",L=cfe(R);return X(ufe,qe({as:D,ref:i,ownerState:R,className:_i(L.root,p)},I))}),Ii=pfe;function nM(n){return typeof n=="string"}function Ub(n,e,i){return n===void 0||nM(n)?e:qe({},e,{ownerState:qe({},e.ownerState,i)})}const ffe={disableDefaultClasses:!1},mfe=ie.createContext(ffe);function gfe(n){const{disableDefaultClasses:e}=ie.useContext(mfe);return i=>e?"":n(i)}function yq(n,e=[]){if(n===void 0)return{};const i={};return Object.keys(n).filter(o=>o.match(/^on[A-Z]/)&&typeof n[o]=="function"&&!e.includes(o)).forEach(o=>{i[o]=n[o]}),i}function yfe(n,e,i){return typeof n=="function"?n(e,i):n}function D7(n){if(n===void 0)return{};const e={};return Object.keys(n).filter(i=>!(i.match(/^on[A-Z]/)&&typeof n[i]=="function")).forEach(i=>{e[i]=n[i]}),e}function vfe(n){const{getSlotProps:e,additionalProps:i,externalSlotProps:o,externalForwardedProps:s,className:l}=n;if(!e){const T=_i(i==null?void 0:i.className,l,s==null?void 0:s.className,o==null?void 0:o.className),I=qe({},i==null?void 0:i.style,s==null?void 0:s.style,o==null?void 0:o.style),R=qe({},i,s,o);return T.length>0&&(R.className=T),Object.keys(I).length>0&&(R.style=I),{props:R,internalRef:void 0}}const d=yq(qe({},s,o)),p=D7(o),f=D7(s),y=e(d),_=_i(y==null?void 0:y.className,i==null?void 0:i.className,l,s==null?void 0:s.className,o==null?void 0:o.className),x=qe({},y==null?void 0:y.style,i==null?void 0:i.style,s==null?void 0:s.style,o==null?void 0:o.style),S=qe({},y,i,f,p);return _.length>0&&(S.className=_),Object.keys(x).length>0&&(S.style=x),{props:S,internalRef:y.ref}}const _fe=["elementType","externalSlotProps","ownerState","skipResolvingSlotProps"];function Ng(n){var e;const{elementType:i,externalSlotProps:o,ownerState:s,skipResolvingSlotProps:l=!1}=n,d=qn(n,_fe),p=l?{}:yfe(o,s),{props:f,internalRef:y}=vfe(qe({},d,{externalSlotProps:p})),_=So(y,p==null?void 0:p.ref,(e=n.additionalProps)==null?void 0:e.ref);return Ub(i,qe({},f,{ref:_}),s)}const bfe=["input","select","textarea","a[href]","button","[tabindex]","audio[controls]","video[controls]",'[contenteditable]:not([contenteditable="false"])'].join(",");function xfe(n){const e=parseInt(n.getAttribute("tabindex")||"",10);return Number.isNaN(e)?n.contentEditable==="true"||(n.nodeName==="AUDIO"||n.nodeName==="VIDEO"||n.nodeName==="DETAILS")&&n.getAttribute("tabindex")===null?0:n.tabIndex:e}function wfe(n){if(n.tagName!=="INPUT"||n.type!=="radio"||!n.name)return!1;const e=o=>n.ownerDocument.querySelector(`input[type="radio"]${o}`);let i=e(`[name="${n.name}"]:checked`);return i||(i=e(`[name="${n.name}"]`)),i!==n}function Sfe(n){return!(n.disabled||n.tagName==="INPUT"&&n.type==="hidden"||wfe(n))}function Afe(n){const e=[],i=[];return Array.from(n.querySelectorAll(bfe)).forEach((o,s)=>{const l=xfe(o);l===-1||!Sfe(o)||(l===0?e.push(o):i.push({documentOrder:s,tabIndex:l,node:o}))}),i.sort((o,s)=>o.tabIndex===s.tabIndex?o.documentOrder-s.documentOrder:o.tabIndex-s.tabIndex).map(o=>o.node).concat(e)}function Efe(){return!0}function Mfe(n){const{children:e,disableAutoFocus:i=!1,disableEnforceFocus:o=!1,disableRestoreFocus:s=!1,getTabbable:l=Afe,isEnabled:d=Efe,open:p}=n,f=ie.useRef(!1),y=ie.useRef(null),_=ie.useRef(null),x=ie.useRef(null),S=ie.useRef(null),T=ie.useRef(!1),I=ie.useRef(null),R=So(e.ref,I),D=ie.useRef(null);ie.useEffect(()=>{!p||!I.current||(T.current=!i)},[i,p]),ie.useEffect(()=>{if(!p||!I.current)return;const N=ws(I.current);return I.current.contains(N.activeElement)||(I.current.hasAttribute("tabIndex")||I.current.setAttribute("tabIndex","-1"),T.current&&I.current.focus()),()=>{s||(x.current&&x.current.focus&&(f.current=!0,x.current.focus()),x.current=null)}},[p]),ie.useEffect(()=>{if(!p||!I.current)return;const N=ws(I.current),F=Y=>{D.current=Y,!(o||!d()||Y.key!=="Tab")&&N.activeElement===I.current&&Y.shiftKey&&(f.current=!0,_.current&&_.current.focus())},G=()=>{const Y=I.current;if(Y===null)return;if(!N.hasFocus()||!d()||f.current){f.current=!1;return}if(Y.contains(N.activeElement)||o&&N.activeElement!==y.current&&N.activeElement!==_.current)return;if(N.activeElement!==S.current)S.current=null;else if(S.current!==null)return;if(!T.current)return;let te=[];if((N.activeElement===y.current||N.activeElement===_.current)&&(te=l(I.current)),te.length>0){var V,Q;const he=!!((V=D.current)!=null&&V.shiftKey&&((Q=D.current)==null?void 0:Q.key)==="Tab"),fe=te[0],ye=te[te.length-1];typeof fe!="string"&&typeof ye!="string"&&(he?ye.focus():fe.focus())}else Y.focus()};N.addEventListener("focusin",G),N.addEventListener("keydown",F,!0);const j=setInterval(()=>{N.activeElement&&N.activeElement.tagName==="BODY"&&G()},50);return()=>{clearInterval(j),N.removeEventListener("focusin",G),N.removeEventListener("keydown",F,!0)}},[i,o,s,d,p,l]);const L=N=>{x.current===null&&(x.current=N.relatedTarget),T.current=!0,S.current=N.target;const F=e.props.onFocus;F&&F(N)},O=N=>{x.current===null&&(x.current=N.relatedTarget),T.current=!0};return $e(ie.Fragment,{children:[X("div",{tabIndex:p?0:-1,onFocus:O,ref:y,"data-testid":"sentinelStart"}),ie.cloneElement(e,{ref:R,onFocus:L}),X("div",{tabIndex:p?0:-1,onFocus:O,ref:_,"data-testid":"sentinelEnd"})]})}var Sl="top",Pc="bottom",Ic="right",Al="left",ND="auto",Gw=[Sl,Pc,Ic,Al],i_="start",Jx="end",Tfe="clippingParents",vq="viewport",sb="popper",Cfe="reference",O7=Gw.reduce(function(n,e){return n.concat([e+"-"+i_,e+"-"+Jx])},[]),_q=[].concat(Gw,[ND]).reduce(function(n,e){return n.concat([e,e+"-"+i_,e+"-"+Jx])},[]),Pfe="beforeRead",Ife="read",Lfe="afterRead",Rfe="beforeMain",kfe="main",Dfe="afterMain",Ofe="beforeWrite",Nfe="write",zfe="afterWrite",Ffe=[Pfe,Ife,Lfe,Rfe,kfe,Dfe,Ofe,Nfe,zfe];function xd(n){return n?(n.nodeName||"").toLowerCase():null}function Ql(n){if(n==null)return window;if(n.toString()!=="[object Window]"){var e=n.ownerDocument;return e&&e.defaultView||window}return n}function zg(n){var e=Ql(n).Element;return n instanceof e||n instanceof Element}function Mc(n){var e=Ql(n).HTMLElement;return n instanceof e||n instanceof HTMLElement}function zD(n){if(typeof ShadowRoot>"u")return!1;var e=Ql(n).ShadowRoot;return n instanceof e||n instanceof ShadowRoot}function Bfe(n){var e=n.state;Object.keys(e.elements).forEach(function(i){var o=e.styles[i]||{},s=e.attributes[i]||{},l=e.elements[i];!Mc(l)||!xd(l)||(Object.assign(l.style,o),Object.keys(s).forEach(function(d){var p=s[d];p===!1?l.removeAttribute(d):l.setAttribute(d,p===!0?"":p)}))})}function Ufe(n){var e=n.state,i={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,i.popper),e.styles=i,e.elements.arrow&&Object.assign(e.elements.arrow.style,i.arrow),function(){Object.keys(e.elements).forEach(function(o){var s=e.elements[o],l=e.attributes[o]||{},d=Object.keys(e.styles.hasOwnProperty(o)?e.styles[o]:i[o]),p=d.reduce(function(f,y){return f[y]="",f},{});!Mc(s)||!xd(s)||(Object.assign(s.style,p),Object.keys(l).forEach(function(f){s.removeAttribute(f)}))})}}const Wfe={name:"applyStyles",enabled:!0,phase:"write",fn:Bfe,effect:Ufe,requires:["computeStyles"]};function md(n){return n.split("-")[0]}var wg=Math.max,iM=Math.min,a_=Math.round;function HL(){var n=navigator.userAgentData;return n!=null&&n.brands&&Array.isArray(n.brands)?n.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function bq(){return!/^((?!chrome|android).)*safari/i.test(HL())}function r_(n,e,i){e===void 0&&(e=!1),i===void 0&&(i=!1);var o=n.getBoundingClientRect(),s=1,l=1;e&&Mc(n)&&(s=n.offsetWidth>0&&a_(o.width)/n.offsetWidth||1,l=n.offsetHeight>0&&a_(o.height)/n.offsetHeight||1);var d=zg(n)?Ql(n):window,p=d.visualViewport,f=!bq()&&i,y=(o.left+(f&&p?p.offsetLeft:0))/s,_=(o.top+(f&&p?p.offsetTop:0))/l,x=o.width/s,S=o.height/l;return{width:x,height:S,top:_,right:y+x,bottom:_+S,left:y,x:y,y:_}}function FD(n){var e=r_(n),i=n.offsetWidth,o=n.offsetHeight;return Math.abs(e.width-i)<=1&&(i=e.width),Math.abs(e.height-o)<=1&&(o=e.height),{x:n.offsetLeft,y:n.offsetTop,width:i,height:o}}function xq(n,e){var i=e.getRootNode&&e.getRootNode();if(n.contains(e))return!0;if(i&&zD(i)){var o=e;do{if(o&&n.isSameNode(o))return!0;o=o.parentNode||o.host}while(o)}return!1}function Gh(n){return Ql(n).getComputedStyle(n)}function Vfe(n){return["table","td","th"].indexOf(xd(n))>=0}function If(n){return((zg(n)?n.ownerDocument:n.document)||window.document).documentElement}function TT(n){return xd(n)==="html"?n:n.assignedSlot||n.parentNode||(zD(n)?n.host:null)||If(n)}function N7(n){return!Mc(n)||Gh(n).position==="fixed"?null:n.offsetParent}function Gfe(n){var e=/firefox/i.test(HL()),i=/Trident/i.test(HL());if(i&&Mc(n)){var o=Gh(n);if(o.position==="fixed")return null}var s=TT(n);for(zD(s)&&(s=s.host);Mc(s)&&["html","body"].indexOf(xd(s))<0;){var l=Gh(s);if(l.transform!=="none"||l.perspective!=="none"||l.contain==="paint"||["transform","perspective"].indexOf(l.willChange)!==-1||e&&l.willChange==="filter"||e&&l.filter&&l.filter!=="none")return s;s=s.parentNode}return null}function Hw(n){for(var e=Ql(n),i=N7(n);i&&Vfe(i)&&Gh(i).position==="static";)i=N7(i);return i&&(xd(i)==="html"||xd(i)==="body"&&Gh(i).position==="static")?e:i||Gfe(n)||e}function BD(n){return["top","bottom"].indexOf(n)>=0?"x":"y"}function lx(n,e,i){return wg(n,iM(e,i))}function Hfe(n,e,i){var o=lx(n,e,i);return o>i?i:o}function wq(){return{top:0,right:0,bottom:0,left:0}}function Sq(n){return Object.assign({},wq(),n)}function Aq(n,e){return e.reduce(function(i,o){return i[o]=n,i},{})}var jfe=function(e,i){return e=typeof e=="function"?e(Object.assign({},i.rects,{placement:i.placement})):e,Sq(typeof e!="number"?e:Aq(e,Gw))};function $fe(n){var e,i=n.state,o=n.name,s=n.options,l=i.elements.arrow,d=i.modifiersData.popperOffsets,p=md(i.placement),f=BD(p),y=[Al,Ic].indexOf(p)>=0,_=y?"height":"width";if(!(!l||!d)){var x=jfe(s.padding,i),S=FD(l),T=f==="y"?Sl:Al,I=f==="y"?Pc:Ic,R=i.rects.reference[_]+i.rects.reference[f]-d[f]-i.rects.popper[_],D=d[f]-i.rects.reference[f],L=Hw(l),O=L?f==="y"?L.clientHeight||0:L.clientWidth||0:0,N=R/2-D/2,F=x[T],G=O-S[_]-x[I],j=O/2-S[_]/2+N,Y=lx(F,j,G),te=f;i.modifiersData[o]=(e={},e[te]=Y,e.centerOffset=Y-j,e)}}function Yfe(n){var e=n.state,i=n.options,o=i.element,s=o===void 0?"[data-popper-arrow]":o;s!=null&&(typeof s=="string"&&(s=e.elements.popper.querySelector(s),!s)||xq(e.elements.popper,s)&&(e.elements.arrow=s))}const qfe={name:"arrow",enabled:!0,phase:"main",fn:$fe,effect:Yfe,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function o_(n){return n.split("-")[1]}var Xfe={top:"auto",right:"auto",bottom:"auto",left:"auto"};function Zfe(n,e){var i=n.x,o=n.y,s=e.devicePixelRatio||1;return{x:a_(i*s)/s||0,y:a_(o*s)/s||0}}function z7(n){var e,i=n.popper,o=n.popperRect,s=n.placement,l=n.variation,d=n.offsets,p=n.position,f=n.gpuAcceleration,y=n.adaptive,_=n.roundOffsets,x=n.isFixed,S=d.x,T=S===void 0?0:S,I=d.y,R=I===void 0?0:I,D=typeof _=="function"?_({x:T,y:R}):{x:T,y:R};T=D.x,R=D.y;var L=d.hasOwnProperty("x"),O=d.hasOwnProperty("y"),N=Al,F=Sl,G=window;if(y){var j=Hw(i),Y="clientHeight",te="clientWidth";if(j===Ql(i)&&(j=If(i),Gh(j).position!=="static"&&p==="absolute"&&(Y="scrollHeight",te="scrollWidth")),j=j,s===Sl||(s===Al||s===Ic)&&l===Jx){F=Pc;var V=x&&j===G&&G.visualViewport?G.visualViewport.height:j[Y];R-=V-o.height,R*=f?1:-1}if(s===Al||(s===Sl||s===Pc)&&l===Jx){N=Ic;var Q=x&&j===G&&G.visualViewport?G.visualViewport.width:j[te];T-=Q-o.width,T*=f?1:-1}}var he=Object.assign({position:p},y&&Xfe),fe=_===!0?Zfe({x:T,y:R},Ql(i)):{x:T,y:R};if(T=fe.x,R=fe.y,f){var ye;return Object.assign({},he,(ye={},ye[F]=O?"0":"",ye[N]=L?"0":"",ye.transform=(G.devicePixelRatio||1)<=1?"translate("+T+"px, "+R+"px)":"translate3d("+T+"px, "+R+"px, 0)",ye))}return Object.assign({},he,(e={},e[F]=O?R+"px":"",e[N]=L?T+"px":"",e.transform="",e))}function Kfe(n){var e=n.state,i=n.options,o=i.gpuAcceleration,s=o===void 0?!0:o,l=i.adaptive,d=l===void 0?!0:l,p=i.roundOffsets,f=p===void 0?!0:p,y={placement:md(e.placement),variation:o_(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:s,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,z7(Object.assign({},y,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:d,roundOffsets:f})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,z7(Object.assign({},y,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:f})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}const Jfe={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:Kfe,data:{}};var vS={passive:!0};function Qfe(n){var e=n.state,i=n.instance,o=n.options,s=o.scroll,l=s===void 0?!0:s,d=o.resize,p=d===void 0?!0:d,f=Ql(e.elements.popper),y=[].concat(e.scrollParents.reference,e.scrollParents.popper);return l&&y.forEach(function(_){_.addEventListener("scroll",i.update,vS)}),p&&f.addEventListener("resize",i.update,vS),function(){l&&y.forEach(function(_){_.removeEventListener("scroll",i.update,vS)}),p&&f.removeEventListener("resize",i.update,vS)}}const eme={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:Qfe,data:{}};var tme={left:"right",right:"left",bottom:"top",top:"bottom"};function aE(n){return n.replace(/left|right|bottom|top/g,function(e){return tme[e]})}var nme={start:"end",end:"start"};function F7(n){return n.replace(/start|end/g,function(e){return nme[e]})}function UD(n){var e=Ql(n),i=e.pageXOffset,o=e.pageYOffset;return{scrollLeft:i,scrollTop:o}}function WD(n){return r_(If(n)).left+UD(n).scrollLeft}function ime(n,e){var i=Ql(n),o=If(n),s=i.visualViewport,l=o.clientWidth,d=o.clientHeight,p=0,f=0;if(s){l=s.width,d=s.height;var y=bq();(y||!y&&e==="fixed")&&(p=s.offsetLeft,f=s.offsetTop)}return{width:l,height:d,x:p+WD(n),y:f}}function ame(n){var e,i=If(n),o=UD(n),s=(e=n.ownerDocument)==null?void 0:e.body,l=wg(i.scrollWidth,i.clientWidth,s?s.scrollWidth:0,s?s.clientWidth:0),d=wg(i.scrollHeight,i.clientHeight,s?s.scrollHeight:0,s?s.clientHeight:0),p=-o.scrollLeft+WD(n),f=-o.scrollTop;return Gh(s||i).direction==="rtl"&&(p+=wg(i.clientWidth,s?s.clientWidth:0)-l),{width:l,height:d,x:p,y:f}}function VD(n){var e=Gh(n),i=e.overflow,o=e.overflowX,s=e.overflowY;return/auto|scroll|overlay|hidden/.test(i+s+o)}function Eq(n){return["html","body","#document"].indexOf(xd(n))>=0?n.ownerDocument.body:Mc(n)&&VD(n)?n:Eq(TT(n))}function cx(n,e){var i;e===void 0&&(e=[]);var o=Eq(n),s=o===((i=n.ownerDocument)==null?void 0:i.body),l=Ql(o),d=s?[l].concat(l.visualViewport||[],VD(o)?o:[]):o,p=e.concat(d);return s?p:p.concat(cx(TT(d)))}function jL(n){return Object.assign({},n,{left:n.x,top:n.y,right:n.x+n.width,bottom:n.y+n.height})}function rme(n,e){var i=r_(n,!1,e==="fixed");return i.top=i.top+n.clientTop,i.left=i.left+n.clientLeft,i.bottom=i.top+n.clientHeight,i.right=i.left+n.clientWidth,i.width=n.clientWidth,i.height=n.clientHeight,i.x=i.left,i.y=i.top,i}function B7(n,e,i){return e===vq?jL(ime(n,i)):zg(e)?rme(e,i):jL(ame(If(n)))}function ome(n){var e=cx(TT(n)),i=["absolute","fixed"].indexOf(Gh(n).position)>=0,o=i&&Mc(n)?Hw(n):n;return zg(o)?e.filter(function(s){return zg(s)&&xq(s,o)&&xd(s)!=="body"}):[]}function sme(n,e,i,o){var s=e==="clippingParents"?ome(n):[].concat(e),l=[].concat(s,[i]),d=l[0],p=l.reduce(function(f,y){var _=B7(n,y,o);return f.top=wg(_.top,f.top),f.right=iM(_.right,f.right),f.bottom=iM(_.bottom,f.bottom),f.left=wg(_.left,f.left),f},B7(n,d,o));return p.width=p.right-p.left,p.height=p.bottom-p.top,p.x=p.left,p.y=p.top,p}function Mq(n){var e=n.reference,i=n.element,o=n.placement,s=o?md(o):null,l=o?o_(o):null,d=e.x+e.width/2-i.width/2,p=e.y+e.height/2-i.height/2,f;switch(s){case Sl:f={x:d,y:e.y-i.height};break;case Pc:f={x:d,y:e.y+e.height};break;case Ic:f={x:e.x+e.width,y:p};break;case Al:f={x:e.x-i.width,y:p};break;default:f={x:e.x,y:e.y}}var y=s?BD(s):null;if(y!=null){var _=y==="y"?"height":"width";switch(l){case i_:f[y]=f[y]-(e[_]/2-i[_]/2);break;case Jx:f[y]=f[y]+(e[_]/2-i[_]/2);break}}return f}function Qx(n,e){e===void 0&&(e={});var i=e,o=i.placement,s=o===void 0?n.placement:o,l=i.strategy,d=l===void 0?n.strategy:l,p=i.boundary,f=p===void 0?Tfe:p,y=i.rootBoundary,_=y===void 0?vq:y,x=i.elementContext,S=x===void 0?sb:x,T=i.altBoundary,I=T===void 0?!1:T,R=i.padding,D=R===void 0?0:R,L=Sq(typeof D!="number"?D:Aq(D,Gw)),O=S===sb?Cfe:sb,N=n.rects.popper,F=n.elements[I?O:S],G=sme(zg(F)?F:F.contextElement||If(n.elements.popper),f,_,d),j=r_(n.elements.reference),Y=Mq({reference:j,element:N,strategy:"absolute",placement:s}),te=jL(Object.assign({},N,Y)),V=S===sb?te:j,Q={top:G.top-V.top+L.top,bottom:V.bottom-G.bottom+L.bottom,left:G.left-V.left+L.left,right:V.right-G.right+L.right},he=n.modifiersData.offset;if(S===sb&&he){var fe=he[s];Object.keys(Q).forEach(function(ye){var pe=[Ic,Pc].indexOf(ye)>=0?1:-1,Me=[Sl,Pc].indexOf(ye)>=0?"y":"x";Q[ye]+=fe[Me]*pe})}return Q}function lme(n,e){e===void 0&&(e={});var i=e,o=i.placement,s=i.boundary,l=i.rootBoundary,d=i.padding,p=i.flipVariations,f=i.allowedAutoPlacements,y=f===void 0?_q:f,_=o_(o),x=_?p?O7:O7.filter(function(I){return o_(I)===_}):Gw,S=x.filter(function(I){return y.indexOf(I)>=0});S.length===0&&(S=x);var T=S.reduce(function(I,R){return I[R]=Qx(n,{placement:R,boundary:s,rootBoundary:l,padding:d})[md(R)],I},{});return Object.keys(T).sort(function(I,R){return T[I]-T[R]})}function cme(n){if(md(n)===ND)return[];var e=aE(n);return[F7(n),e,F7(e)]}function ume(n){var e=n.state,i=n.options,o=n.name;if(!e.modifiersData[o]._skip){for(var s=i.mainAxis,l=s===void 0?!0:s,d=i.altAxis,p=d===void 0?!0:d,f=i.fallbackPlacements,y=i.padding,_=i.boundary,x=i.rootBoundary,S=i.altBoundary,T=i.flipVariations,I=T===void 0?!0:T,R=i.allowedAutoPlacements,D=e.options.placement,L=md(D),O=L===D,N=f||(O||!I?[aE(D)]:cme(D)),F=[D].concat(N).reduce(function(Ze,Ke){return Ze.concat(md(Ke)===ND?lme(e,{placement:Ke,boundary:_,rootBoundary:x,padding:y,flipVariations:I,allowedAutoPlacements:R}):Ke)},[]),G=e.rects.reference,j=e.rects.popper,Y=new Map,te=!0,V=F[0],Q=0;Q<F.length;Q++){var he=F[Q],fe=md(he),ye=o_(he)===i_,pe=[Sl,Pc].indexOf(fe)>=0,Me=pe?"width":"height",Ie=Qx(e,{placement:he,boundary:_,rootBoundary:x,altBoundary:S,padding:y}),ze=pe?ye?Ic:Al:ye?Pc:Sl;G[Me]>j[Me]&&(ze=aE(ze));var le=aE(ze),me=[];if(l&&me.push(Ie[fe]<=0),p&&me.push(Ie[ze]<=0,Ie[le]<=0),me.every(function(Ze){return Ze})){V=he,te=!1;break}Y.set(he,me)}if(te)for(var xe=I?3:1,ae=function(Ke){var Fe=F.find(function(ct){var Ct=Y.get(ct);if(Ct)return Ct.slice(0,Ke).every(function(kt){return kt})});if(Fe)return V=Fe,"break"},Ee=xe;Ee>0;Ee--){var Je=ae(Ee);if(Je==="break")break}e.placement!==V&&(e.modifiersData[o]._skip=!0,e.placement=V,e.reset=!0)}}const dme={name:"flip",enabled:!0,phase:"main",fn:ume,requiresIfExists:["offset"],data:{_skip:!1}};function U7(n,e,i){return i===void 0&&(i={x:0,y:0}),{top:n.top-e.height-i.y,right:n.right-e.width+i.x,bottom:n.bottom-e.height+i.y,left:n.left-e.width-i.x}}function W7(n){return[Sl,Ic,Pc,Al].some(function(e){return n[e]>=0})}function hme(n){var e=n.state,i=n.name,o=e.rects.reference,s=e.rects.popper,l=e.modifiersData.preventOverflow,d=Qx(e,{elementContext:"reference"}),p=Qx(e,{altBoundary:!0}),f=U7(d,o),y=U7(p,s,l),_=W7(f),x=W7(y);e.modifiersData[i]={referenceClippingOffsets:f,popperEscapeOffsets:y,isReferenceHidden:_,hasPopperEscaped:x},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":_,"data-popper-escaped":x})}const pme={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:hme};function fme(n,e,i){var o=md(n),s=[Al,Sl].indexOf(o)>=0?-1:1,l=typeof i=="function"?i(Object.assign({},e,{placement:n})):i,d=l[0],p=l[1];return d=d||0,p=(p||0)*s,[Al,Ic].indexOf(o)>=0?{x:p,y:d}:{x:d,y:p}}function mme(n){var e=n.state,i=n.options,o=n.name,s=i.offset,l=s===void 0?[0,0]:s,d=_q.reduce(function(_,x){return _[x]=fme(x,e.rects,l),_},{}),p=d[e.placement],f=p.x,y=p.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=f,e.modifiersData.popperOffsets.y+=y),e.modifiersData[o]=d}const gme={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:mme};function yme(n){var e=n.state,i=n.name;e.modifiersData[i]=Mq({reference:e.rects.reference,element:e.rects.popper,strategy:"absolute",placement:e.placement})}const vme={name:"popperOffsets",enabled:!0,phase:"read",fn:yme,data:{}};function _me(n){return n==="x"?"y":"x"}function bme(n){var e=n.state,i=n.options,o=n.name,s=i.mainAxis,l=s===void 0?!0:s,d=i.altAxis,p=d===void 0?!1:d,f=i.boundary,y=i.rootBoundary,_=i.altBoundary,x=i.padding,S=i.tether,T=S===void 0?!0:S,I=i.tetherOffset,R=I===void 0?0:I,D=Qx(e,{boundary:f,rootBoundary:y,padding:x,altBoundary:_}),L=md(e.placement),O=o_(e.placement),N=!O,F=BD(L),G=_me(F),j=e.modifiersData.popperOffsets,Y=e.rects.reference,te=e.rects.popper,V=typeof R=="function"?R(Object.assign({},e.rects,{placement:e.placement})):R,Q=typeof V=="number"?{mainAxis:V,altAxis:V}:Object.assign({mainAxis:0,altAxis:0},V),he=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,fe={x:0,y:0};if(j){if(l){var ye,pe=F==="y"?Sl:Al,Me=F==="y"?Pc:Ic,Ie=F==="y"?"height":"width",ze=j[F],le=ze+D[pe],me=ze-D[Me],xe=T?-te[Ie]/2:0,ae=O===i_?Y[Ie]:te[Ie],Ee=O===i_?-te[Ie]:-Y[Ie],Je=e.elements.arrow,Ze=T&&Je?FD(Je):{width:0,height:0},Ke=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:wq(),Fe=Ke[pe],ct=Ke[Me],Ct=lx(0,Y[Ie],Ze[Ie]),kt=N?Y[Ie]/2-xe-Ct-Fe-Q.mainAxis:ae-Ct-Fe-Q.mainAxis,Kt=N?-Y[Ie]/2+xe+Ct+ct+Q.mainAxis:Ee+Ct+ct+Q.mainAxis,At=e.elements.arrow&&Hw(e.elements.arrow),Pe=At?F==="y"?At.clientTop||0:At.clientLeft||0:0,ft=(ye=he==null?void 0:he[F])!=null?ye:0,gt=ze+kt-ft-Pe,_t=ze+Kt-ft,Be=lx(T?iM(le,gt):le,ze,T?wg(me,_t):me);j[F]=Be,fe[F]=Be-ze}if(p){var ue,se=F==="x"?Sl:Al,_e=F==="x"?Pc:Ic,je=j[G],De=G==="y"?"height":"width",st=je+D[se],de=je-D[_e],ne=[Sl,Al].indexOf(L)!==-1,Oe=(ue=he==null?void 0:he[G])!=null?ue:0,ut=ne?st:je-Y[De]-te[De]-Oe+Q.altAxis,it=ne?je+Y[De]+te[De]-Oe-Q.altAxis:de,lt=T&&ne?Hfe(ut,je,it):lx(T?ut:st,je,T?it:de);j[G]=lt,fe[G]=lt-je}e.modifiersData[o]=fe}}const xme={name:"preventOverflow",enabled:!0,phase:"main",fn:bme,requiresIfExists:["offset"]};function wme(n){return{scrollLeft:n.scrollLeft,scrollTop:n.scrollTop}}function Sme(n){return n===Ql(n)||!Mc(n)?UD(n):wme(n)}function Ame(n){var e=n.getBoundingClientRect(),i=a_(e.width)/n.offsetWidth||1,o=a_(e.height)/n.offsetHeight||1;return i!==1||o!==1}function Eme(n,e,i){i===void 0&&(i=!1);var o=Mc(e),s=Mc(e)&&Ame(e),l=If(e),d=r_(n,s,i),p={scrollLeft:0,scrollTop:0},f={x:0,y:0};return(o||!o&&!i)&&((xd(e)!=="body"||VD(l))&&(p=Sme(e)),Mc(e)?(f=r_(e,!0),f.x+=e.clientLeft,f.y+=e.clientTop):l&&(f.x=WD(l))),{x:d.left+p.scrollLeft-f.x,y:d.top+p.scrollTop-f.y,width:d.width,height:d.height}}function Mme(n){var e=new Map,i=new Set,o=[];n.forEach(function(l){e.set(l.name,l)});function s(l){i.add(l.name);var d=[].concat(l.requires||[],l.requiresIfExists||[]);d.forEach(function(p){if(!i.has(p)){var f=e.get(p);f&&s(f)}}),o.push(l)}return n.forEach(function(l){i.has(l.name)||s(l)}),o}function Tme(n){var e=Mme(n);return Ffe.reduce(function(i,o){return i.concat(e.filter(function(s){return s.phase===o}))},[])}function Cme(n){var e;return function(){return e||(e=new Promise(function(i){Promise.resolve().then(function(){e=void 0,i(n())})})),e}}function Pme(n){var e=n.reduce(function(i,o){var s=i[o.name];return i[o.name]=s?Object.assign({},s,o,{options:Object.assign({},s.options,o.options),data:Object.assign({},s.data,o.data)}):o,i},{});return Object.keys(e).map(function(i){return e[i]})}var V7={placement:"bottom",modifiers:[],strategy:"absolute"};function G7(){for(var n=arguments.length,e=new Array(n),i=0;i<n;i++)e[i]=arguments[i];return!e.some(function(o){return!(o&&typeof o.getBoundingClientRect=="function")})}function Ime(n){n===void 0&&(n={});var e=n,i=e.defaultModifiers,o=i===void 0?[]:i,s=e.defaultOptions,l=s===void 0?V7:s;return function(p,f,y){y===void 0&&(y=l);var _={placement:"bottom",orderedModifiers:[],options:Object.assign({},V7,l),modifiersData:{},elements:{reference:p,popper:f},attributes:{},styles:{}},x=[],S=!1,T={state:_,setOptions:function(L){var O=typeof L=="function"?L(_.options):L;R(),_.options=Object.assign({},l,_.options,O),_.scrollParents={reference:zg(p)?cx(p):p.contextElement?cx(p.contextElement):[],popper:cx(f)};var N=Tme(Pme([].concat(o,_.options.modifiers)));return _.orderedModifiers=N.filter(function(F){return F.enabled}),I(),T.update()},forceUpdate:function(){if(!S){var L=_.elements,O=L.reference,N=L.popper;if(G7(O,N)){_.rects={reference:Eme(O,Hw(N),_.options.strategy==="fixed"),popper:FD(N)},_.reset=!1,_.placement=_.options.placement,_.orderedModifiers.forEach(function(Q){return _.modifiersData[Q.name]=Object.assign({},Q.data)});for(var F=0;F<_.orderedModifiers.length;F++){if(_.reset===!0){_.reset=!1,F=-1;continue}var G=_.orderedModifiers[F],j=G.fn,Y=G.options,te=Y===void 0?{}:Y,V=G.name;typeof j=="function"&&(_=j({state:_,options:te,name:V,instance:T})||_)}}}},update:Cme(function(){return new Promise(function(D){T.forceUpdate(),D(_)})}),destroy:function(){R(),S=!0}};if(!G7(p,f))return T;T.setOptions(y).then(function(D){!S&&y.onFirstUpdate&&y.onFirstUpdate(D)});function I(){_.orderedModifiers.forEach(function(D){var L=D.name,O=D.options,N=O===void 0?{}:O,F=D.effect;if(typeof F=="function"){var G=F({state:_,name:L,instance:T,options:N}),j=function(){};x.push(G||j)}})}function R(){x.forEach(function(D){return D()}),x=[]}return T}}var Lme=[eme,vme,Jfe,Wfe,gme,dme,xme,qfe,pme],Rme=Ime({defaultModifiers:Lme});function kme(n){return typeof n=="function"?n():n}const Tq=ie.forwardRef(function(e,i){const{children:o,container:s,disablePortal:l=!1}=e,[d,p]=ie.useState(null),f=So(ie.isValidElement(o)?o.ref:null,i);if(gu(()=>{l||p(kme(s)||document.body)},[s,l]),gu(()=>{if(d&&!l)return ZE(i,d),()=>{ZE(i,null)}},[i,d,l]),l){if(ie.isValidElement(o)){const y={ref:f};return ie.cloneElement(o,y)}return X(ie.Fragment,{children:o})}return X(ie.Fragment,{children:d&&Nw.createPortal(o,d)})});function Dme(n){return aa("MuiPopper",n)}Zi("MuiPopper",["root"]);const Ome=["anchorEl","children","direction","disablePortal","modifiers","open","placement","popperOptions","popperRef","slotProps","slots","TransitionProps","ownerState"],Nme=["anchorEl","children","container","direction","disablePortal","keepMounted","modifiers","open","placement","popperOptions","popperRef","style","transition","slotProps","slots"];function zme(n,e){if(e==="ltr")return n;switch(n){case"bottom-end":return"bottom-start";case"bottom-start":return"bottom-end";case"top-end":return"top-start";case"top-start":return"top-end";default:return n}}function $L(n){return typeof n=="function"?n():n}function Fme(n){return n.nodeType!==void 0}const Bme=()=>ha({root:["root"]},gfe(Dme)),Ume={},Wme=ie.forwardRef(function(e,i){var o;const{anchorEl:s,children:l,direction:d,disablePortal:p,modifiers:f,open:y,placement:_,popperOptions:x,popperRef:S,slotProps:T={},slots:I={},TransitionProps:R}=e,D=qn(e,Ome),L=ie.useRef(null),O=So(L,i),N=ie.useRef(null),F=So(N,S),G=ie.useRef(F);gu(()=>{G.current=F},[F]),ie.useImperativeHandle(S,()=>N.current,[]);const j=zme(_,d),[Y,te]=ie.useState(j),[V,Q]=ie.useState($L(s));ie.useEffect(()=>{N.current&&N.current.forceUpdate()}),ie.useEffect(()=>{s&&Q($L(s))},[s]),gu(()=>{if(!V||!y)return;const Me=le=>{te(le.placement)};let Ie=[{name:"preventOverflow",options:{altBoundary:p}},{name:"flip",options:{altBoundary:p}},{name:"onUpdate",enabled:!0,phase:"afterWrite",fn:({state:le})=>{Me(le)}}];f!=null&&(Ie=Ie.concat(f)),x&&x.modifiers!=null&&(Ie=Ie.concat(x.modifiers));const ze=Rme(V,L.current,qe({placement:j},x,{modifiers:Ie}));return G.current(ze),()=>{ze.destroy(),G.current(null)}},[V,p,f,y,x,j]);const he={placement:Y};R!==null&&(he.TransitionProps=R);const fe=Bme(),ye=(o=I.root)!=null?o:"div",pe=Ng({elementType:ye,externalSlotProps:T.root,externalForwardedProps:D,additionalProps:{role:"tooltip",ref:O},ownerState:e,className:fe.root});return X(ye,qe({},pe,{children:typeof l=="function"?l(he):l}))}),Vme=ie.forwardRef(function(e,i){const{anchorEl:o,children:s,container:l,direction:d="ltr",disablePortal:p=!1,keepMounted:f=!1,modifiers:y,open:_,placement:x="bottom",popperOptions:S=Ume,popperRef:T,style:I,transition:R=!1,slotProps:D={},slots:L={}}=e,O=qn(e,Nme),[N,F]=ie.useState(!0),G=()=>{F(!1)},j=()=>{F(!0)};if(!f&&!_&&(!R||N))return null;let Y;if(l)Y=l;else if(o){const Q=$L(o);Y=Q&&Fme(Q)?ws(Q).body:ws(null).body}const te=!_&&f&&(!R||N)?"none":void 0,V=R?{in:_,onEnter:G,onExited:j}:void 0;return X(Tq,{disablePortal:p,container:Y,children:X(Wme,qe({anchorEl:o,direction:d,disablePortal:p,modifiers:y,ref:i,open:R?!N:_,placement:x,popperOptions:S,popperRef:T,slotProps:D,slots:L},O,{style:qe({position:"fixed",top:0,left:0,display:te},I),TransitionProps:V,children:s}))})});function Gme(n){const e=ws(n);return e.body===n?bd(n).innerWidth>e.documentElement.clientWidth:n.scrollHeight>n.clientHeight}function ux(n,e){e?n.setAttribute("aria-hidden","true"):n.removeAttribute("aria-hidden")}function H7(n){return parseInt(bd(n).getComputedStyle(n).paddingRight,10)||0}function Hme(n){const i=["TEMPLATE","SCRIPT","STYLE","LINK","MAP","META","NOSCRIPT","PICTURE","COL","COLGROUP","PARAM","SLOT","SOURCE","TRACK"].indexOf(n.tagName)!==-1,o=n.tagName==="INPUT"&&n.getAttribute("type")==="hidden";return i||o}function j7(n,e,i,o,s){const l=[e,i,...o];[].forEach.call(n.children,d=>{const p=l.indexOf(d)===-1,f=!Hme(d);p&&f&&ux(d,s)})}function y4(n,e){let i=-1;return n.some((o,s)=>e(o)?(i=s,!0):!1),i}function jme(n,e){const i=[],o=n.container;if(!e.disableScrollLock){if(Gme(o)){const d=BY(ws(o));i.push({value:o.style.paddingRight,property:"padding-right",el:o}),o.style.paddingRight=`${H7(o)+d}px`;const p=ws(o).querySelectorAll(".mui-fixed");[].forEach.call(p,f=>{i.push({value:f.style.paddingRight,property:"padding-right",el:f}),f.style.paddingRight=`${H7(f)+d}px`})}let l;if(o.parentNode instanceof DocumentFragment)l=ws(o).body;else{const d=o.parentElement,p=bd(o);l=(d==null?void 0:d.nodeName)==="HTML"&&p.getComputedStyle(d).overflowY==="scroll"?d:o}i.push({value:l.style.overflow,property:"overflow",el:l},{value:l.style.overflowX,property:"overflow-x",el:l},{value:l.style.overflowY,property:"overflow-y",el:l}),l.style.overflow="hidden"}return()=>{i.forEach(({value:l,el:d,property:p})=>{l?d.style.setProperty(p,l):d.style.removeProperty(p)})}}function $me(n){const e=[];return[].forEach.call(n.children,i=>{i.getAttribute("aria-hidden")==="true"&&e.push(i)}),e}class Yme{constructor(){this.containers=void 0,this.modals=void 0,this.modals=[],this.containers=[]}add(e,i){let o=this.modals.indexOf(e);if(o!==-1)return o;o=this.modals.length,this.modals.push(e),e.modalRef&&ux(e.modalRef,!1);const s=$me(i);j7(i,e.mount,e.modalRef,s,!0);const l=y4(this.containers,d=>d.container===i);return l!==-1?(this.containers[l].modals.push(e),o):(this.containers.push({modals:[e],container:i,restore:null,hiddenSiblings:s}),o)}mount(e,i){const o=y4(this.containers,l=>l.modals.indexOf(e)!==-1),s=this.containers[o];s.restore||(s.restore=jme(s,i))}remove(e,i=!0){const o=this.modals.indexOf(e);if(o===-1)return o;const s=y4(this.containers,d=>d.modals.indexOf(e)!==-1),l=this.containers[s];if(l.modals.splice(l.modals.indexOf(e),1),this.modals.splice(o,1),l.modals.length===0)l.restore&&l.restore(),e.modalRef&&ux(e.modalRef,i),j7(l.container,e.mount,e.modalRef,l.hiddenSiblings,!1),this.containers.splice(s,1);else{const d=l.modals[l.modals.length-1];d.modalRef&&ux(d.modalRef,!1)}return o}isTopModal(e){return this.modals.length>0&&this.modals[this.modals.length-1]===e}}function qme(n){return typeof n=="function"?n():n}function Xme(n){return n?n.props.hasOwnProperty("in"):!1}const Zme=new Yme;function Kme(n){const{container:e,disableEscapeKeyDown:i=!1,disableScrollLock:o=!1,manager:s=Zme,closeAfterTransition:l=!1,onTransitionEnter:d,onTransitionExited:p,children:f,onClose:y,open:_,rootRef:x}=n,S=ie.useRef({}),T=ie.useRef(null),I=ie.useRef(null),R=So(I,x),[D,L]=ie.useState(!_),O=Xme(f);let N=!0;(n["aria-hidden"]==="false"||n["aria-hidden"]===!1)&&(N=!1);const F=()=>ws(T.current),G=()=>(S.current.modalRef=I.current,S.current.mount=T.current,S.current),j=()=>{s.mount(G(),{disableScrollLock:o}),I.current&&(I.current.scrollTop=0)},Y=Qp(()=>{const Ie=qme(e)||F().body;s.add(G(),Ie),I.current&&j()}),te=ie.useCallback(()=>s.isTopModal(G()),[s]),V=Qp(Ie=>{T.current=Ie,Ie&&(_&&te()?j():I.current&&ux(I.current,N))}),Q=ie.useCallback(()=>{s.remove(G(),N)},[N,s]);ie.useEffect(()=>()=>{Q()},[Q]),ie.useEffect(()=>{_?Y():(!O||!l)&&Q()},[_,Q,O,l,Y]);const he=Ie=>ze=>{var le;(le=Ie.onKeyDown)==null||le.call(Ie,ze),!(ze.key!=="Escape"||ze.which===229||!te())&&(i||(ze.stopPropagation(),y&&y(ze,"escapeKeyDown")))},fe=Ie=>ze=>{var le;(le=Ie.onClick)==null||le.call(Ie,ze),ze.target===ze.currentTarget&&y&&y(ze,"backdropClick")};return{getRootProps:(Ie={})=>{const ze=yq(n);delete ze.onTransitionEnter,delete ze.onTransitionExited;const le=qe({},ze,Ie);return qe({role:"presentation"},le,{onKeyDown:he(le),ref:R})},getBackdropProps:(Ie={})=>{const ze=Ie;return qe({"aria-hidden":!0},ze,{onClick:fe(ze),open:_})},getTransitionProps:()=>{const Ie=()=>{L(!1),d&&d()},ze=()=>{L(!0),p&&p(),l&&Q()};return{onEnter:NL(Ie,f==null?void 0:f.props.onEnter),onExited:NL(ze,f==null?void 0:f.props.onExited)}},rootRef:R,portalRef:V,isTopModal:te,exited:D,hasTransition:O}}const Jme=["onChange","maxRows","minRows","style","value"];function _S(n){return parseInt(n,10)||0}const Qme={shadow:{visibility:"hidden",position:"absolute",overflow:"hidden",height:0,top:0,left:0,transform:"translateZ(0)"}};function $7(n){return n==null||Object.keys(n).length===0||n.outerHeightStyle===0&&!n.overflow}const ege=ie.forwardRef(function(e,i){const{onChange:o,maxRows:s,minRows:l=1,style:d,value:p}=e,f=qn(e,Jme),{current:y}=ie.useRef(p!=null),_=ie.useRef(null),x=So(i,_),S=ie.useRef(null),T=ie.useRef(0),[I,R]=ie.useState({outerHeightStyle:0}),D=ie.useCallback(()=>{const F=_.current,j=bd(F).getComputedStyle(F);if(j.width==="0px")return{outerHeightStyle:0};const Y=S.current;Y.style.width=j.width,Y.value=F.value||e.placeholder||"x",Y.value.slice(-1)===`
`&&(Y.value+=" ");const te=j.boxSizing,V=_S(j.paddingBottom)+_S(j.paddingTop),Q=_S(j.borderBottomWidth)+_S(j.borderTopWidth),he=Y.scrollHeight;Y.value="x";const fe=Y.scrollHeight;let ye=he;l&&(ye=Math.max(Number(l)*fe,ye)),s&&(ye=Math.min(Number(s)*fe,ye)),ye=Math.max(ye,fe);const pe=ye+(te==="border-box"?V+Q:0),Me=Math.abs(ye-he)<=1;return{outerHeightStyle:pe,overflow:Me}},[s,l,e.placeholder]),L=(F,G)=>{const{outerHeightStyle:j,overflow:Y}=G;return T.current<20&&(j>0&&Math.abs((F.outerHeightStyle||0)-j)>1||F.overflow!==Y)?(T.current+=1,{overflow:Y,outerHeightStyle:j}):F},O=ie.useCallback(()=>{const F=D();$7(F)||R(G=>L(G,F))},[D]);gu(()=>{const F=()=>{const he=D();$7(he)||Nw.flushSync(()=>{R(fe=>L(fe,he))})},G=()=>{T.current=0,F()};let j;const Y=JM(G),te=_.current,V=bd(te);V.addEventListener("resize",Y);let Q;return typeof ResizeObserver<"u"&&(Q=new ResizeObserver(G),Q.observe(te)),()=>{Y.clear(),cancelAnimationFrame(j),V.removeEventListener("resize",Y),Q&&Q.disconnect()}},[D]),gu(()=>{O()}),ie.useEffect(()=>{T.current=0},[p]);const N=F=>{T.current=0,y||O(),o&&o(F)};return $e(ie.Fragment,{children:[X("textarea",qe({value:p,onChange:N,ref:x,rows:l,style:qe({height:I.outerHeightStyle,overflow:I.overflow?"hidden":void 0},d)},f)),X("textarea",{"aria-hidden":!0,className:e.className,readOnly:!0,ref:S,tabIndex:-1,style:qe({},Qme.shadow,d,{paddingTop:0,paddingBottom:0})})]})}),tge=["anchorEl","component","components","componentsProps","container","disablePortal","keepMounted","modifiers","open","placement","popperOptions","popperRef","transition","slots","slotProps"],nge=Bn(Vme,{name:"MuiPopper",slot:"Root",overridesResolver:(n,e)=>e.root})({}),ige=ie.forwardRef(function(e,i){var o;const s=TD(),l=_a({props:e,name:"MuiPopper"}),{anchorEl:d,component:p,components:f,componentsProps:y,container:_,disablePortal:x,keepMounted:S,modifiers:T,open:I,placement:R,popperOptions:D,popperRef:L,transition:O,slots:N,slotProps:F}=l,G=qn(l,tge),j=(o=N==null?void 0:N.root)!=null?o:f==null?void 0:f.Root,Y=qe({anchorEl:d,container:_,disablePortal:x,keepMounted:S,modifiers:T,open:I,placement:R,popperOptions:D,popperRef:L,transition:O},G);return X(nge,qe({as:p,direction:s==null?void 0:s.direction,slots:{root:j},slotProps:F??y},Y,{ref:i}))}),Cq=ige;function jw({props:n,states:e,muiFormControl:i}){return e.reduce((o,s)=>(o[s]=n[s],i&&typeof n[s]>"u"&&(o[s]=i[s]),o),{})}const age=ie.createContext(void 0),GD=age;function x_(){return ie.useContext(GD)}function rge(n){return X(xhe,qe({},n,{defaultTheme:AT,themeId:e_}))}function Y7(n){return n!=null&&!(Array.isArray(n)&&n.length===0)}function aM(n,e=!1){return n&&(Y7(n.value)&&n.value!==""||e&&Y7(n.defaultValue)&&n.defaultValue!=="")}function oge(n){return n.startAdornment}function sge(n){return aa("MuiInputBase",n)}const lge=Zi("MuiInputBase",["root","formControl","focused","disabled","adornedStart","adornedEnd","error","sizeSmall","multiline","colorSecondary","fullWidth","hiddenLabel","readOnly","input","inputSizeSmall","inputMultiline","inputTypeSearch","inputAdornedStart","inputAdornedEnd","inputHiddenLabel"]),s_=lge,cge=["aria-describedby","autoComplete","autoFocus","className","color","components","componentsProps","defaultValue","disabled","disableInjectingGlobalStyles","endAdornment","error","fullWidth","id","inputComponent","inputProps","inputRef","margin","maxRows","minRows","multiline","name","onBlur","onChange","onClick","onFocus","onKeyDown","onKeyUp","placeholder","readOnly","renderSuffix","rows","size","slotProps","slots","startAdornment","type","value"],CT=(n,e)=>{const{ownerState:i}=n;return[e.root,i.formControl&&e.formControl,i.startAdornment&&e.adornedStart,i.endAdornment&&e.adornedEnd,i.error&&e.error,i.size==="small"&&e.sizeSmall,i.multiline&&e.multiline,i.color&&e[`color${ai(i.color)}`],i.fullWidth&&e.fullWidth,i.hiddenLabel&&e.hiddenLabel]},PT=(n,e)=>{const{ownerState:i}=n;return[e.input,i.size==="small"&&e.inputSizeSmall,i.multiline&&e.inputMultiline,i.type==="search"&&e.inputTypeSearch,i.startAdornment&&e.inputAdornedStart,i.endAdornment&&e.inputAdornedEnd,i.hiddenLabel&&e.inputHiddenLabel]},uge=n=>{const{classes:e,color:i,disabled:o,error:s,endAdornment:l,focused:d,formControl:p,fullWidth:f,hiddenLabel:y,multiline:_,readOnly:x,size:S,startAdornment:T,type:I}=n,R={root:["root",`color${ai(i)}`,o&&"disabled",s&&"error",f&&"fullWidth",d&&"focused",p&&"formControl",S&&S!=="medium"&&`size${ai(S)}`,_&&"multiline",T&&"adornedStart",l&&"adornedEnd",y&&"hiddenLabel",x&&"readOnly"],input:["input",o&&"disabled",I==="search"&&"inputTypeSearch",_&&"inputMultiline",S==="small"&&"inputSizeSmall",y&&"inputHiddenLabel",T&&"inputAdornedStart",l&&"inputAdornedEnd",x&&"readOnly"]};return ha(R,sge,e)},IT=Bn("div",{name:"MuiInputBase",slot:"Root",overridesResolver:CT})(({theme:n,ownerState:e})=>qe({},n.typography.body1,{color:(n.vars||n).palette.text.primary,lineHeight:"1.4375em",boxSizing:"border-box",position:"relative",cursor:"text",display:"inline-flex",alignItems:"center",[`&.${s_.disabled}`]:{color:(n.vars||n).palette.text.disabled,cursor:"default"}},e.multiline&&qe({padding:"4px 0 5px"},e.size==="small"&&{paddingTop:1}),e.fullWidth&&{width:"100%"})),LT=Bn("input",{name:"MuiInputBase",slot:"Input",overridesResolver:PT})(({theme:n,ownerState:e})=>{const i=n.palette.mode==="light",o=qe({color:"currentColor"},n.vars?{opacity:n.vars.opacity.inputPlaceholder}:{opacity:i?.42:.5},{transition:n.transitions.create("opacity",{duration:n.transitions.duration.shorter})}),s={opacity:"0 !important"},l=n.vars?{opacity:n.vars.opacity.inputPlaceholder}:{opacity:i?.42:.5};return qe({font:"inherit",letterSpacing:"inherit",color:"currentColor",padding:"4px 0 5px",border:0,boxSizing:"content-box",background:"none",height:"1.4375em",margin:0,WebkitTapHighlightColor:"transparent",display:"block",minWidth:0,width:"100%",animationName:"mui-auto-fill-cancel",animationDuration:"10ms","&::-webkit-input-placeholder":o,"&::-moz-placeholder":o,"&:-ms-input-placeholder":o,"&::-ms-input-placeholder":o,"&:focus":{outline:0},"&:invalid":{boxShadow:"none"},"&::-webkit-search-decoration":{WebkitAppearance:"none"},[`label[data-shrink=false] + .${s_.formControl} &`]:{"&::-webkit-input-placeholder":s,"&::-moz-placeholder":s,"&:-ms-input-placeholder":s,"&::-ms-input-placeholder":s,"&:focus::-webkit-input-placeholder":l,"&:focus::-moz-placeholder":l,"&:focus:-ms-input-placeholder":l,"&:focus::-ms-input-placeholder":l},[`&.${s_.disabled}`]:{opacity:1,WebkitTextFillColor:(n.vars||n).palette.text.disabled},"&:-webkit-autofill":{animationDuration:"5000s",animationName:"mui-auto-fill"}},e.size==="small"&&{paddingTop:1},e.multiline&&{height:"auto",resize:"none",padding:0,paddingTop:0},e.type==="search"&&{MozAppearance:"textfield"})}),dge=X(rge,{styles:{"@keyframes mui-auto-fill":{from:{display:"block"}},"@keyframes mui-auto-fill-cancel":{from:{display:"block"}}}}),hge=ie.forwardRef(function(e,i){var o;const s=_a({props:e,name:"MuiInputBase"}),{"aria-describedby":l,autoComplete:d,autoFocus:p,className:f,components:y={},componentsProps:_={},defaultValue:x,disabled:S,disableInjectingGlobalStyles:T,endAdornment:I,fullWidth:R=!1,id:D,inputComponent:L="input",inputProps:O={},inputRef:N,maxRows:F,minRows:G,multiline:j=!1,name:Y,onBlur:te,onChange:V,onClick:Q,onFocus:he,onKeyDown:fe,onKeyUp:ye,placeholder:pe,readOnly:Me,renderSuffix:Ie,rows:ze,slotProps:le={},slots:me={},startAdornment:xe,type:ae="text",value:Ee}=s,Je=qn(s,cge),Ze=O.value!=null?O.value:Ee,{current:Ke}=ie.useRef(Ze!=null),Fe=ie.useRef(),ct=ie.useCallback(lt=>{},[]),Ct=So(Fe,N,O.ref,ct),[kt,Kt]=ie.useState(!1),At=x_(),Pe=jw({props:s,muiFormControl:At,states:["color","disabled","error","hiddenLabel","size","required","filled"]});Pe.focused=At?At.focused:kt,ie.useEffect(()=>{!At&&S&&kt&&(Kt(!1),te&&te())},[At,S,kt,te]);const ft=At&&At.onFilled,gt=At&&At.onEmpty,_t=ie.useCallback(lt=>{aM(lt)?ft&&ft():gt&&gt()},[ft,gt]);gu(()=>{Ke&&_t({value:Ze})},[Ze,_t,Ke]);const Be=lt=>{if(Pe.disabled){lt.stopPropagation();return}he&&he(lt),O.onFocus&&O.onFocus(lt),At&&At.onFocus?At.onFocus(lt):Kt(!0)},ue=lt=>{te&&te(lt),O.onBlur&&O.onBlur(lt),At&&At.onBlur?At.onBlur(lt):Kt(!1)},se=(lt,...Et)=>{if(!Ke){const Ut=lt.target||Fe.current;if(Ut==null)throw new Error(xf(1));_t({value:Ut.value})}O.onChange&&O.onChange(lt,...Et),V&&V(lt,...Et)};ie.useEffect(()=>{_t(Fe.current)},[]);const _e=lt=>{Fe.current&&lt.currentTarget===lt.target&&Fe.current.focus(),Q&&Q(lt)};let je=L,De=O;j&&je==="input"&&(ze?De=qe({type:void 0,minRows:ze,maxRows:ze},De):De=qe({type:void 0,maxRows:F,minRows:G},De),je=ege);const st=lt=>{_t(lt.animationName==="mui-auto-fill-cancel"?Fe.current:{value:"x"})};ie.useEffect(()=>{At&&At.setAdornedStart(!!xe)},[At,xe]);const de=qe({},s,{color:Pe.color||"primary",disabled:Pe.disabled,endAdornment:I,error:Pe.error,focused:Pe.focused,formControl:At,fullWidth:R,hiddenLabel:Pe.hiddenLabel,multiline:j,size:Pe.size,startAdornment:xe,type:ae}),ne=uge(de),Oe=me.root||y.Root||IT,ut=le.root||_.root||{},it=me.input||y.Input||LT;return De=qe({},De,(o=le.input)!=null?o:_.input),$e(ie.Fragment,{children:[!T&&dge,$e(Oe,qe({},ut,!nM(Oe)&&{ownerState:qe({},de,ut.ownerState)},{ref:i,onClick:_e},Je,{className:_i(ne.root,ut.className,f,Me&&"MuiInputBase-readOnly"),children:[xe,X(GD.Provider,{value:null,children:X(it,qe({ownerState:de,"aria-invalid":Pe.error,"aria-describedby":l,autoComplete:d,autoFocus:p,defaultValue:x,disabled:Pe.disabled,id:D,onAnimationStart:st,name:Y,placeholder:pe,readOnly:Me,required:Pe.required,rows:ze,value:Ze,onKeyDown:fe,onKeyUp:ye,type:ae},De,!nM(it)&&{as:je,ownerState:qe({},de,De.ownerState)},{ref:Ct,className:_i(ne.input,De.className,Me&&"MuiInputBase-readOnly"),onBlur:ue,onChange:se,onFocus:Be}))}),I,Ie?Ie(qe({},Pe,{startAdornment:xe})):null]}))]})}),HD=hge;function pge(n){return aa("MuiInput",n)}const fge=qe({},s_,Zi("MuiInput",["root","underline","input"])),lb=fge;function mge(n){return aa("MuiOutlinedInput",n)}const gge=qe({},s_,Zi("MuiOutlinedInput",["root","notchedOutline","input"])),zp=gge;function yge(n){return aa("MuiFilledInput",n)}const vge=qe({},s_,Zi("MuiFilledInput",["root","underline","input"])),Nm=vge,_ge=Vw(X("path",{d:"M7 10l5 5 5-5z"}),"ArrowDropDown"),bge=["addEndListener","appear","children","easing","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","style","timeout","TransitionComponent"],xge={entering:{opacity:1},entered:{opacity:1}},wge=ie.forwardRef(function(e,i){const o=Zg(),s={enter:o.transitions.duration.enteringScreen,exit:o.transitions.duration.leavingScreen},{addEndListener:l,appear:d=!0,children:p,easing:f,in:y,onEnter:_,onEntered:x,onEntering:S,onExit:T,onExited:I,onExiting:R,style:D,timeout:L=s,TransitionComponent:O=RD}=e,N=qn(e,bge),F=ie.useRef(null),G=So(F,p.ref,i),j=pe=>Me=>{if(pe){const Ie=F.current;Me===void 0?pe(Ie):pe(Ie,Me)}},Y=j(S),te=j((pe,Me)=>{OD(pe);const Ie=n_({style:D,timeout:L,easing:f},{mode:"enter"});pe.style.webkitTransition=o.transitions.create("opacity",Ie),pe.style.transition=o.transitions.create("opacity",Ie),_&&_(pe,Me)}),V=j(x),Q=j(R),he=j(pe=>{const Me=n_({style:D,timeout:L,easing:f},{mode:"exit"});pe.style.webkitTransition=o.transitions.create("opacity",Me),pe.style.transition=o.transitions.create("opacity",Me),T&&T(pe)}),fe=j(I);return X(O,qe({appear:d,in:y,nodeRef:F,onEnter:te,onEntered:V,onEntering:Y,onExit:he,onExited:fe,onExiting:Q,addEndListener:pe=>{l&&l(F.current,pe)},timeout:L},N,{children:(pe,Me)=>ie.cloneElement(p,qe({style:qe({opacity:0,visibility:pe==="exited"&&!y?"hidden":void 0},xge[pe],D,p.props.style),ref:G},Me))}))}),Sge=wge;function Age(n){return aa("MuiBackdrop",n)}Zi("MuiBackdrop",["root","invisible"]);const Ege=["children","className","component","components","componentsProps","invisible","open","slotProps","slots","TransitionComponent","transitionDuration"],Mge=n=>{const{classes:e,invisible:i}=n;return ha({root:["root",i&&"invisible"]},Age,e)},Tge=Bn("div",{name:"MuiBackdrop",slot:"Root",overridesResolver:(n,e)=>{const{ownerState:i}=n;return[e.root,i.invisible&&e.invisible]}})(({ownerState:n})=>qe({position:"fixed",display:"flex",alignItems:"center",justifyContent:"center",right:0,bottom:0,top:0,left:0,backgroundColor:"rgba(0, 0, 0, 0.5)",WebkitTapHighlightColor:"transparent"},n.invisible&&{backgroundColor:"transparent"})),Cge=ie.forwardRef(function(e,i){var o,s,l;const d=_a({props:e,name:"MuiBackdrop"}),{children:p,className:f,component:y="div",components:_={},componentsProps:x={},invisible:S=!1,open:T,slotProps:I={},slots:R={},TransitionComponent:D=Sge,transitionDuration:L}=d,O=qn(d,Ege),N=qe({},d,{component:y,invisible:S}),F=Mge(N),G=(o=I.root)!=null?o:x.root;return X(D,qe({in:T,timeout:L},O,{children:X(Tge,qe({"aria-hidden":!0},G,{as:(s=(l=R.root)!=null?l:_.Root)!=null?s:y,className:_i(F.root,f,G==null?void 0:G.className),ownerState:qe({},N,G==null?void 0:G.ownerState),classes:F,ref:i,children:p}))}))}),Pge=Cge;function Ige(n){return aa("MuiButton",n)}const Lge=Zi("MuiButton",["root","text","textInherit","textPrimary","textSecondary","textSuccess","textError","textInfo","textWarning","outlined","outlinedInherit","outlinedPrimary","outlinedSecondary","outlinedSuccess","outlinedError","outlinedInfo","outlinedWarning","contained","containedInherit","containedPrimary","containedSecondary","containedSuccess","containedError","containedInfo","containedWarning","disableElevation","focusVisible","disabled","colorInherit","textSizeSmall","textSizeMedium","textSizeLarge","outlinedSizeSmall","outlinedSizeMedium","outlinedSizeLarge","containedSizeSmall","containedSizeMedium","containedSizeLarge","sizeMedium","sizeSmall","sizeLarge","fullWidth","startIcon","endIcon","iconSizeSmall","iconSizeMedium","iconSizeLarge"]),bS=Lge,Rge=ie.createContext({}),kge=Rge,Dge=ie.createContext(void 0),Oge=Dge,Nge=["children","color","component","className","disabled","disableElevation","disableFocusRipple","endIcon","focusVisibleClassName","fullWidth","size","startIcon","type","variant"],zge=n=>{const{color:e,disableElevation:i,fullWidth:o,size:s,variant:l,classes:d}=n,p={root:["root",l,`${l}${ai(e)}`,`size${ai(s)}`,`${l}Size${ai(s)}`,e==="inherit"&&"colorInherit",i&&"disableElevation",o&&"fullWidth"],label:["label"],startIcon:["startIcon",`iconSize${ai(s)}`],endIcon:["endIcon",`iconSize${ai(s)}`]},f=ha(p,Ige,d);return qe({},d,f)},Pq=n=>qe({},n.size==="small"&&{"& > *:nth-of-type(1)":{fontSize:18}},n.size==="medium"&&{"& > *:nth-of-type(1)":{fontSize:20}},n.size==="large"&&{"& > *:nth-of-type(1)":{fontSize:22}}),Fge=Bn(MT,{shouldForwardProp:n=>Ml(n)||n==="classes",name:"MuiButton",slot:"Root",overridesResolver:(n,e)=>{const{ownerState:i}=n;return[e.root,e[i.variant],e[`${i.variant}${ai(i.color)}`],e[`size${ai(i.size)}`],e[`${i.variant}Size${ai(i.size)}`],i.color==="inherit"&&e.colorInherit,i.disableElevation&&e.disableElevation,i.fullWidth&&e.fullWidth]}})(({theme:n,ownerState:e})=>{var i,o;const s=n.palette.mode==="light"?n.palette.grey[300]:n.palette.grey[800],l=n.palette.mode==="light"?n.palette.grey.A100:n.palette.grey[700];return qe({},n.typography.button,{minWidth:64,padding:"6px 16px",borderRadius:(n.vars||n).shape.borderRadius,transition:n.transitions.create(["background-color","box-shadow","border-color","color"],{duration:n.transitions.duration.short}),"&:hover":qe({textDecoration:"none",backgroundColor:n.vars?`rgba(${n.vars.palette.text.primaryChannel} / ${n.vars.palette.action.hoverOpacity})`:kr(n.palette.text.primary,n.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},e.variant==="text"&&e.color!=="inherit"&&{backgroundColor:n.vars?`rgba(${n.vars.palette[e.color].mainChannel} / ${n.vars.palette.action.hoverOpacity})`:kr(n.palette[e.color].main,n.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},e.variant==="outlined"&&e.color!=="inherit"&&{border:`1px solid ${(n.vars||n).palette[e.color].main}`,backgroundColor:n.vars?`rgba(${n.vars.palette[e.color].mainChannel} / ${n.vars.palette.action.hoverOpacity})`:kr(n.palette[e.color].main,n.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},e.variant==="contained"&&{backgroundColor:n.vars?n.vars.palette.Button.inheritContainedHoverBg:l,boxShadow:(n.vars||n).shadows[4],"@media (hover: none)":{boxShadow:(n.vars||n).shadows[2],backgroundColor:(n.vars||n).palette.grey[300]}},e.variant==="contained"&&e.color!=="inherit"&&{backgroundColor:(n.vars||n).palette[e.color].dark,"@media (hover: none)":{backgroundColor:(n.vars||n).palette[e.color].main}}),"&:active":qe({},e.variant==="contained"&&{boxShadow:(n.vars||n).shadows[8]}),[`&.${bS.focusVisible}`]:qe({},e.variant==="contained"&&{boxShadow:(n.vars||n).shadows[6]}),[`&.${bS.disabled}`]:qe({color:(n.vars||n).palette.action.disabled},e.variant==="outlined"&&{border:`1px solid ${(n.vars||n).palette.action.disabledBackground}`},e.variant==="contained"&&{color:(n.vars||n).palette.action.disabled,boxShadow:(n.vars||n).shadows[0],backgroundColor:(n.vars||n).palette.action.disabledBackground})},e.variant==="text"&&{padding:"6px 8px"},e.variant==="text"&&e.color!=="inherit"&&{color:(n.vars||n).palette[e.color].main},e.variant==="outlined"&&{padding:"5px 15px",border:"1px solid currentColor"},e.variant==="outlined"&&e.color!=="inherit"&&{color:(n.vars||n).palette[e.color].main,border:n.vars?`1px solid rgba(${n.vars.palette[e.color].mainChannel} / 0.5)`:`1px solid ${kr(n.palette[e.color].main,.5)}`},e.variant==="contained"&&{color:n.vars?n.vars.palette.text.primary:(i=(o=n.palette).getContrastText)==null?void 0:i.call(o,n.palette.grey[300]),backgroundColor:n.vars?n.vars.palette.Button.inheritContainedBg:s,boxShadow:(n.vars||n).shadows[2]},e.variant==="contained"&&e.color!=="inherit"&&{color:(n.vars||n).palette[e.color].contrastText,backgroundColor:(n.vars||n).palette[e.color].main},e.color==="inherit"&&{color:"inherit",borderColor:"currentColor"},e.size==="small"&&e.variant==="text"&&{padding:"4px 5px",fontSize:n.typography.pxToRem(13)},e.size==="large"&&e.variant==="text"&&{padding:"8px 11px",fontSize:n.typography.pxToRem(15)},e.size==="small"&&e.variant==="outlined"&&{padding:"3px 9px",fontSize:n.typography.pxToRem(13)},e.size==="large"&&e.variant==="outlined"&&{padding:"7px 21px",fontSize:n.typography.pxToRem(15)},e.size==="small"&&e.variant==="contained"&&{padding:"4px 10px",fontSize:n.typography.pxToRem(13)},e.size==="large"&&e.variant==="contained"&&{padding:"8px 22px",fontSize:n.typography.pxToRem(15)},e.fullWidth&&{width:"100%"})},({ownerState:n})=>n.disableElevation&&{boxShadow:"none","&:hover":{boxShadow:"none"},[`&.${bS.focusVisible}`]:{boxShadow:"none"},"&:active":{boxShadow:"none"},[`&.${bS.disabled}`]:{boxShadow:"none"}}),Bge=Bn("span",{name:"MuiButton",slot:"StartIcon",overridesResolver:(n,e)=>{const{ownerState:i}=n;return[e.startIcon,e[`iconSize${ai(i.size)}`]]}})(({ownerState:n})=>qe({display:"inherit",marginRight:8,marginLeft:-4},n.size==="small"&&{marginLeft:-2},Pq(n))),Uge=Bn("span",{name:"MuiButton",slot:"EndIcon",overridesResolver:(n,e)=>{const{ownerState:i}=n;return[e.endIcon,e[`iconSize${ai(i.size)}`]]}})(({ownerState:n})=>qe({display:"inherit",marginRight:-4,marginLeft:8},n.size==="small"&&{marginRight:-2},Pq(n))),Wge=ie.forwardRef(function(e,i){const o=ie.useContext(kge),s=ie.useContext(Oge),l=uD(o,e),d=_a({props:l,name:"MuiButton"}),{children:p,color:f="primary",component:y="button",className:_,disabled:x=!1,disableElevation:S=!1,disableFocusRipple:T=!1,endIcon:I,focusVisibleClassName:R,fullWidth:D=!1,size:L="medium",startIcon:O,type:N,variant:F="text"}=d,G=qn(d,Nge),j=qe({},d,{color:f,component:y,disabled:x,disableElevation:S,disableFocusRipple:T,fullWidth:D,size:L,type:N,variant:F}),Y=zge(j),te=O&&X(Bge,{className:Y.startIcon,ownerState:j,children:O}),V=I&&X(Uge,{className:Y.endIcon,ownerState:j,children:I}),Q=s||"";return $e(Fge,qe({ownerState:j,className:_i(o.className,Y.root,_,Q),component:y,disabled:x,focusRipple:!T,focusVisibleClassName:_i(Y.focusVisible,R),ref:i,type:N},G,{classes:Y,children:[te,p,V]}))}),xr=Wge;function Vge(n){return aa("PrivateSwitchBase",n)}Zi("PrivateSwitchBase",["root","checked","disabled","input","edgeStart","edgeEnd"]);const Gge=["autoFocus","checked","checkedIcon","className","defaultChecked","disabled","disableFocusRipple","edge","icon","id","inputProps","inputRef","name","onBlur","onChange","onFocus","readOnly","required","tabIndex","type","value"],Hge=n=>{const{classes:e,checked:i,disabled:o,edge:s}=n,l={root:["root",i&&"checked",o&&"disabled",s&&`edge${ai(s)}`],input:["input"]};return ha(l,Vge,e)},jge=Bn(MT)(({ownerState:n})=>qe({padding:9,borderRadius:"50%"},n.edge==="start"&&{marginLeft:n.size==="small"?-3:-12},n.edge==="end"&&{marginRight:n.size==="small"?-3:-12})),$ge=Bn("input",{shouldForwardProp:Ml})({cursor:"inherit",position:"absolute",opacity:0,width:"100%",height:"100%",top:0,left:0,margin:0,padding:0,zIndex:1}),Yge=ie.forwardRef(function(e,i){const{autoFocus:o,checked:s,checkedIcon:l,className:d,defaultChecked:p,disabled:f,disableFocusRipple:y=!1,edge:_=!1,icon:x,id:S,inputProps:T,inputRef:I,name:R,onBlur:D,onChange:L,onFocus:O,readOnly:N,required:F=!1,tabIndex:G,type:j,value:Y}=e,te=qn(e,Gge),[V,Q]=qx({controlled:s,default:!!p,name:"SwitchBase",state:"checked"}),he=x_(),fe=me=>{O&&O(me),he&&he.onFocus&&he.onFocus(me)},ye=me=>{D&&D(me),he&&he.onBlur&&he.onBlur(me)},pe=me=>{if(me.nativeEvent.defaultPrevented)return;const xe=me.target.checked;Q(xe),L&&L(me,xe)};let Me=f;he&&typeof Me>"u"&&(Me=he.disabled);const Ie=j==="checkbox"||j==="radio",ze=qe({},e,{checked:V,disabled:Me,disableFocusRipple:y,edge:_}),le=Hge(ze);return $e(jge,qe({component:"span",className:_i(le.root,d),centerRipple:!0,focusRipple:!y,disabled:Me,tabIndex:null,role:void 0,onFocus:fe,onBlur:ye,ownerState:ze,ref:i},te,{children:[X($ge,qe({autoFocus:o,checked:s,defaultChecked:p,className:le.input,disabled:Me,id:Ie?S:void 0,name:R,onChange:pe,readOnly:N,ref:I,required:F,ownerState:ze,tabIndex:G,type:j},j==="checkbox"&&Y===void 0?{}:{value:Y},T)),V?l:x]}))}),Iq=Yge,qge=Vw(X("path",{d:"M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"}),"CheckBoxOutlineBlank"),Xge=Vw(X("path",{d:"M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.11 0 2-.9 2-2V5c0-1.1-.89-2-2-2zm-9 14l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"}),"CheckBox"),Zge=Vw(X("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-2 10H7v-2h10v2z"}),"IndeterminateCheckBox");function Kge(n){return aa("MuiCheckbox",n)}const Jge=Zi("MuiCheckbox",["root","checked","disabled","indeterminate","colorPrimary","colorSecondary","sizeSmall","sizeMedium"]),v4=Jge,Qge=["checkedIcon","color","icon","indeterminate","indeterminateIcon","inputProps","size","className"],eye=n=>{const{classes:e,indeterminate:i,color:o,size:s}=n,l={root:["root",i&&"indeterminate",`color${ai(o)}`,`size${ai(s)}`]},d=ha(l,Kge,e);return qe({},e,d)},tye=Bn(Iq,{shouldForwardProp:n=>Ml(n)||n==="classes",name:"MuiCheckbox",slot:"Root",overridesResolver:(n,e)=>{const{ownerState:i}=n;return[e.root,i.indeterminate&&e.indeterminate,e[`size${ai(i.size)}`],i.color!=="default"&&e[`color${ai(i.color)}`]]}})(({theme:n,ownerState:e})=>qe({color:(n.vars||n).palette.text.secondary},!e.disableRipple&&{"&:hover":{backgroundColor:n.vars?`rgba(${e.color==="default"?n.vars.palette.action.activeChannel:n.vars.palette[e.color].mainChannel} / ${n.vars.palette.action.hoverOpacity})`:kr(e.color==="default"?n.palette.action.active:n.palette[e.color].main,n.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},e.color!=="default"&&{[`&.${v4.checked}, &.${v4.indeterminate}`]:{color:(n.vars||n).palette[e.color].main},[`&.${v4.disabled}`]:{color:(n.vars||n).palette.action.disabled}})),nye=X(Xge,{}),iye=X(qge,{}),aye=X(Zge,{}),rye=ie.forwardRef(function(e,i){var o,s;const l=_a({props:e,name:"MuiCheckbox"}),{checkedIcon:d=nye,color:p="primary",icon:f=iye,indeterminate:y=!1,indeterminateIcon:_=aye,inputProps:x,size:S="medium",className:T}=l,I=qn(l,Qge),R=y?_:f,D=y?_:d,L=qe({},l,{color:p,indeterminate:y,size:S}),O=eye(L);return X(tye,qe({type:"checkbox",inputProps:qe({"data-indeterminate":y},x),icon:ie.cloneElement(R,{fontSize:(o=R.props.fontSize)!=null?o:S}),checkedIcon:ie.cloneElement(D,{fontSize:(s=D.props.fontSize)!=null?s:S}),ownerState:L,ref:i,className:_i(O.root,T)},I,{classes:O}))}),oye=rye;function sye(n){return aa("MuiModal",n)}Zi("MuiModal",["root","hidden","backdrop"]);const lye=["BackdropComponent","BackdropProps","classes","className","closeAfterTransition","children","container","component","components","componentsProps","disableAutoFocus","disableEnforceFocus","disableEscapeKeyDown","disablePortal","disableRestoreFocus","disableScrollLock","hideBackdrop","keepMounted","onBackdropClick","onClose","onTransitionEnter","onTransitionExited","open","slotProps","slots","theme"],cye=n=>{const{open:e,exited:i,classes:o}=n;return ha({root:["root",!e&&i&&"hidden"],backdrop:["backdrop"]},sye,o)},uye=Bn("div",{name:"MuiModal",slot:"Root",overridesResolver:(n,e)=>{const{ownerState:i}=n;return[e.root,!i.open&&i.exited&&e.hidden]}})(({theme:n,ownerState:e})=>qe({position:"fixed",zIndex:(n.vars||n).zIndex.modal,right:0,bottom:0,top:0,left:0},!e.open&&e.exited&&{visibility:"hidden"})),dye=Bn(Pge,{name:"MuiModal",slot:"Backdrop",overridesResolver:(n,e)=>e.backdrop})({zIndex:-1}),hye=ie.forwardRef(function(e,i){var o,s,l,d,p,f;const y=_a({name:"MuiModal",props:e}),{BackdropComponent:_=dye,BackdropProps:x,className:S,closeAfterTransition:T=!1,children:I,container:R,component:D,components:L={},componentsProps:O={},disableAutoFocus:N=!1,disableEnforceFocus:F=!1,disableEscapeKeyDown:G=!1,disablePortal:j=!1,disableRestoreFocus:Y=!1,disableScrollLock:te=!1,hideBackdrop:V=!1,keepMounted:Q=!1,onBackdropClick:he,open:fe,slotProps:ye,slots:pe}=y,Me=qn(y,lye),Ie=qe({},y,{closeAfterTransition:T,disableAutoFocus:N,disableEnforceFocus:F,disableEscapeKeyDown:G,disablePortal:j,disableRestoreFocus:Y,disableScrollLock:te,hideBackdrop:V,keepMounted:Q}),{getRootProps:ze,getBackdropProps:le,getTransitionProps:me,portalRef:xe,isTopModal:ae,exited:Ee,hasTransition:Je}=Kme(qe({},Ie,{rootRef:i})),Ze=qe({},Ie,{exited:Ee}),Ke=cye(Ze),Fe={};if(I.props.tabIndex===void 0&&(Fe.tabIndex="-1"),Je){const{onEnter:ft,onExited:gt}=me();Fe.onEnter=ft,Fe.onExited=gt}const ct=(o=(s=pe==null?void 0:pe.root)!=null?s:L.Root)!=null?o:uye,Ct=(l=(d=pe==null?void 0:pe.backdrop)!=null?d:L.Backdrop)!=null?l:_,kt=(p=ye==null?void 0:ye.root)!=null?p:O.root,Kt=(f=ye==null?void 0:ye.backdrop)!=null?f:O.backdrop,At=Ng({elementType:ct,externalSlotProps:kt,externalForwardedProps:Me,getSlotProps:ze,additionalProps:{ref:i,as:D},ownerState:Ze,className:_i(S,kt==null?void 0:kt.className,Ke==null?void 0:Ke.root,!Ze.open&&Ze.exited&&(Ke==null?void 0:Ke.hidden))}),Pe=Ng({elementType:Ct,externalSlotProps:Kt,additionalProps:x,getSlotProps:ft=>le(qe({},ft,{onClick:gt=>{he&&he(gt),ft!=null&&ft.onClick&&ft.onClick(gt)}})),className:_i(Kt==null?void 0:Kt.className,x==null?void 0:x.className,Ke==null?void 0:Ke.backdrop),ownerState:Ze});return!Q&&!fe&&(!Je||Ee)?null:X(Tq,{ref:xe,container:R,disablePortal:j,children:$e(ct,qe({},At,{children:[!V&&_?X(Ct,qe({},Pe)):null,X(Mfe,{disableEnforceFocus:F,disableAutoFocus:N,disableRestoreFocus:Y,isEnabled:ae,open:fe,children:ie.cloneElement(I,Fe)})]}))})}),pye=hye,fye=Zi("MuiDivider",["root","absolute","fullWidth","inset","middle","flexItem","light","vertical","withChildren","withChildrenVertical","textAlignRight","textAlignLeft","wrapper","wrapperVertical"]),q7=fye,mye=["addEndListener","appear","children","container","direction","easing","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","style","timeout","TransitionComponent"];function gye(n,e,i){const o=e.getBoundingClientRect(),s=i&&i.getBoundingClientRect(),l=bd(e);let d;if(e.fakeTransform)d=e.fakeTransform;else{const y=l.getComputedStyle(e);d=y.getPropertyValue("-webkit-transform")||y.getPropertyValue("transform")}let p=0,f=0;if(d&&d!=="none"&&typeof d=="string"){const y=d.split("(")[1].split(")")[0].split(",");p=parseInt(y[4],10),f=parseInt(y[5],10)}return n==="left"?s?`translateX(${s.right+p-o.left}px)`:`translateX(${l.innerWidth+p-o.left}px)`:n==="right"?s?`translateX(-${o.right-s.left-p}px)`:`translateX(-${o.left+o.width-p}px)`:n==="up"?s?`translateY(${s.bottom+f-o.top}px)`:`translateY(${l.innerHeight+f-o.top}px)`:s?`translateY(-${o.top-s.top+o.height-f}px)`:`translateY(-${o.top+o.height-f}px)`}function yye(n){return typeof n=="function"?n():n}function xS(n,e,i){const o=yye(i),s=gye(n,e,o);s&&(e.style.webkitTransform=s,e.style.transform=s)}const vye=ie.forwardRef(function(e,i){const o=Zg(),s={enter:o.transitions.easing.easeOut,exit:o.transitions.easing.sharp},l={enter:o.transitions.duration.enteringScreen,exit:o.transitions.duration.leavingScreen},{addEndListener:d,appear:p=!0,children:f,container:y,direction:_="down",easing:x=s,in:S,onEnter:T,onEntered:I,onEntering:R,onExit:D,onExited:L,onExiting:O,style:N,timeout:F=l,TransitionComponent:G=RD}=e,j=qn(e,mye),Y=ie.useRef(null),te=So(f.ref,Y,i),V=le=>me=>{le&&(me===void 0?le(Y.current):le(Y.current,me))},Q=V((le,me)=>{xS(_,le,y),OD(le),T&&T(le,me)}),he=V((le,me)=>{const xe=n_({timeout:F,style:N,easing:x},{mode:"enter"});le.style.webkitTransition=o.transitions.create("-webkit-transform",qe({},xe)),le.style.transition=o.transitions.create("transform",qe({},xe)),le.style.webkitTransform="none",le.style.transform="none",R&&R(le,me)}),fe=V(I),ye=V(O),pe=V(le=>{const me=n_({timeout:F,style:N,easing:x},{mode:"exit"});le.style.webkitTransition=o.transitions.create("-webkit-transform",me),le.style.transition=o.transitions.create("transform",me),xS(_,le,y),D&&D(le)}),Me=V(le=>{le.style.webkitTransition="",le.style.transition="",L&&L(le)}),Ie=le=>{d&&d(Y.current,le)},ze=ie.useCallback(()=>{Y.current&&xS(_,Y.current,y)},[_,y]);return ie.useEffect(()=>{if(S||_==="down"||_==="right")return;const le=JM(()=>{Y.current&&xS(_,Y.current,y)}),me=bd(Y.current);return me.addEventListener("resize",le),()=>{le.clear(),me.removeEventListener("resize",le)}},[_,S,y]),ie.useEffect(()=>{S||ze()},[S,ze]),X(G,qe({nodeRef:Y,onEnter:Q,onEntered:fe,onEntering:he,onExit:pe,onExited:Me,onExiting:ye,addEndListener:Ie,appear:p,in:S,timeout:F},j,{children:(le,me)=>ie.cloneElement(f,qe({ref:te,style:qe({visibility:le==="exited"&&!S?"hidden":void 0},N,f.props.style)},me))}))}),_ye=vye,bye=["disableUnderline","components","componentsProps","fullWidth","hiddenLabel","inputComponent","multiline","slotProps","slots","type"],xye=n=>{const{classes:e,disableUnderline:i}=n,s=ha({root:["root",!i&&"underline"],input:["input"]},yge,e);return qe({},e,s)},wye=Bn(IT,{shouldForwardProp:n=>Ml(n)||n==="classes",name:"MuiFilledInput",slot:"Root",overridesResolver:(n,e)=>{const{ownerState:i}=n;return[...CT(n,e),!i.disableUnderline&&e.underline]}})(({theme:n,ownerState:e})=>{var i;const o=n.palette.mode==="light",s=o?"rgba(0, 0, 0, 0.42)":"rgba(255, 255, 255, 0.7)",l=o?"rgba(0, 0, 0, 0.06)":"rgba(255, 255, 255, 0.09)",d=o?"rgba(0, 0, 0, 0.09)":"rgba(255, 255, 255, 0.13)",p=o?"rgba(0, 0, 0, 0.12)":"rgba(255, 255, 255, 0.12)";return qe({position:"relative",backgroundColor:n.vars?n.vars.palette.FilledInput.bg:l,borderTopLeftRadius:(n.vars||n).shape.borderRadius,borderTopRightRadius:(n.vars||n).shape.borderRadius,transition:n.transitions.create("background-color",{duration:n.transitions.duration.shorter,easing:n.transitions.easing.easeOut}),"&:hover":{backgroundColor:n.vars?n.vars.palette.FilledInput.hoverBg:d,"@media (hover: none)":{backgroundColor:n.vars?n.vars.palette.FilledInput.bg:l}},[`&.${Nm.focused}`]:{backgroundColor:n.vars?n.vars.palette.FilledInput.bg:l},[`&.${Nm.disabled}`]:{backgroundColor:n.vars?n.vars.palette.FilledInput.disabledBg:p}},!e.disableUnderline&&{"&:after":{borderBottom:`2px solid ${(i=(n.vars||n).palette[e.color||"primary"])==null?void 0:i.main}`,left:0,bottom:0,content:'""',position:"absolute",right:0,transform:"scaleX(0)",transition:n.transitions.create("transform",{duration:n.transitions.duration.shorter,easing:n.transitions.easing.easeOut}),pointerEvents:"none"},[`&.${Nm.focused}:after`]:{transform:"scaleX(1) translateX(0)"},[`&.${Nm.error}`]:{"&:before, &:after":{borderBottomColor:(n.vars||n).palette.error.main}},"&:before":{borderBottom:`1px solid ${n.vars?`rgba(${n.vars.palette.common.onBackgroundChannel} / ${n.vars.opacity.inputUnderline})`:s}`,left:0,bottom:0,content:'"\\00a0"',position:"absolute",right:0,transition:n.transitions.create("border-bottom-color",{duration:n.transitions.duration.shorter}),pointerEvents:"none"},[`&:hover:not(.${Nm.disabled}, .${Nm.error}):before`]:{borderBottom:`1px solid ${(n.vars||n).palette.text.primary}`},[`&.${Nm.disabled}:before`]:{borderBottomStyle:"dotted"}},e.startAdornment&&{paddingLeft:12},e.endAdornment&&{paddingRight:12},e.multiline&&qe({padding:"25px 12px 8px"},e.size==="small"&&{paddingTop:21,paddingBottom:4},e.hiddenLabel&&{paddingTop:16,paddingBottom:17}))}),Sye=Bn(LT,{name:"MuiFilledInput",slot:"Input",overridesResolver:PT})(({theme:n,ownerState:e})=>qe({paddingTop:25,paddingRight:12,paddingBottom:8,paddingLeft:12},!n.vars&&{"&:-webkit-autofill":{WebkitBoxShadow:n.palette.mode==="light"?null:"0 0 0 100px #266798 inset",WebkitTextFillColor:n.palette.mode==="light"?null:"#fff",caretColor:n.palette.mode==="light"?null:"#fff",borderTopLeftRadius:"inherit",borderTopRightRadius:"inherit"}},n.vars&&{"&:-webkit-autofill":{borderTopLeftRadius:"inherit",borderTopRightRadius:"inherit"},[n.getColorSchemeSelector("dark")]:{"&:-webkit-autofill":{WebkitBoxShadow:"0 0 0 100px #266798 inset",WebkitTextFillColor:"#fff",caretColor:"#fff"}}},e.size==="small"&&{paddingTop:21,paddingBottom:4},e.hiddenLabel&&{paddingTop:16,paddingBottom:17},e.multiline&&{paddingTop:0,paddingBottom:0,paddingLeft:0,paddingRight:0},e.startAdornment&&{paddingLeft:0},e.endAdornment&&{paddingRight:0},e.hiddenLabel&&e.size==="small"&&{paddingTop:8,paddingBottom:9})),Lq=ie.forwardRef(function(e,i){var o,s,l,d;const p=_a({props:e,name:"MuiFilledInput"}),{components:f={},componentsProps:y,fullWidth:_=!1,inputComponent:x="input",multiline:S=!1,slotProps:T,slots:I={},type:R="text"}=p,D=qn(p,bye),L=qe({},p,{fullWidth:_,inputComponent:x,multiline:S,type:R}),O=xye(p),N={root:{ownerState:L},input:{ownerState:L}},F=T??y?wl(T??y,N):N,G=(o=(s=I.root)!=null?s:f.Root)!=null?o:wye,j=(l=(d=I.input)!=null?d:f.Input)!=null?l:Sye;return X(HD,qe({slots:{root:G,input:j},componentsProps:F,fullWidth:_,inputComponent:x,multiline:S,ref:i,type:R},D,{classes:O}))});Lq.muiName="Input";const Aye=Lq;function Eye(n){return aa("MuiFormControl",n)}Zi("MuiFormControl",["root","marginNone","marginNormal","marginDense","fullWidth","disabled"]);const Mye=["children","className","color","component","disabled","error","focused","fullWidth","hiddenLabel","margin","required","size","variant"],Tye=n=>{const{classes:e,margin:i,fullWidth:o}=n,s={root:["root",i!=="none"&&`margin${ai(i)}`,o&&"fullWidth"]};return ha(s,Eye,e)},Cye=Bn("div",{name:"MuiFormControl",slot:"Root",overridesResolver:({ownerState:n},e)=>qe({},e.root,e[`margin${ai(n.margin)}`],n.fullWidth&&e.fullWidth)})(({ownerState:n})=>qe({display:"inline-flex",flexDirection:"column",position:"relative",minWidth:0,padding:0,margin:0,border:0,verticalAlign:"top"},n.margin==="normal"&&{marginTop:16,marginBottom:8},n.margin==="dense"&&{marginTop:8,marginBottom:4},n.fullWidth&&{width:"100%"})),Pye=ie.forwardRef(function(e,i){const o=_a({props:e,name:"MuiFormControl"}),{children:s,className:l,color:d="primary",component:p="div",disabled:f=!1,error:y=!1,focused:_,fullWidth:x=!1,hiddenLabel:S=!1,margin:T="none",required:I=!1,size:R="medium",variant:D="outlined"}=o,L=qn(o,Mye),O=qe({},o,{color:d,component:p,disabled:f,error:y,fullWidth:x,hiddenLabel:S,margin:T,required:I,size:R,variant:D}),N=Tye(O),[F,G]=ie.useState(()=>{let ye=!1;return s&&ie.Children.forEach(s,pe=>{if(!QA(pe,["Input","Select"]))return;const Me=QA(pe,["Select"])?pe.props.input:pe;Me&&oge(Me.props)&&(ye=!0)}),ye}),[j,Y]=ie.useState(()=>{let ye=!1;return s&&ie.Children.forEach(s,pe=>{QA(pe,["Input","Select"])&&(aM(pe.props,!0)||aM(pe.props.inputProps,!0))&&(ye=!0)}),ye}),[te,V]=ie.useState(!1);f&&te&&V(!1);const Q=_!==void 0&&!f?_:te;let he;const fe=ie.useMemo(()=>({adornedStart:F,setAdornedStart:G,color:d,disabled:f,error:y,filled:j,focused:Q,fullWidth:x,hiddenLabel:S,size:R,onBlur:()=>{V(!1)},onEmpty:()=>{Y(!1)},onFilled:()=>{Y(!0)},onFocus:()=>{V(!0)},registerEffect:he,required:I,variant:D}),[F,d,f,y,j,Q,x,S,he,I,R,D]);return X(GD.Provider,{value:fe,children:X(Cye,qe({as:p,ownerState:O,className:_i(N.root,l),ref:i},L,{children:s}))})}),Iye=Pye;function Lye(n){return aa("MuiFormLabel",n)}const Rye=Zi("MuiFormLabel",["root","colorSecondary","focused","disabled","error","filled","required","asterisk"]),dx=Rye,kye=["children","className","color","component","disabled","error","filled","focused","required"],Dye=n=>{const{classes:e,color:i,focused:o,disabled:s,error:l,filled:d,required:p}=n,f={root:["root",`color${ai(i)}`,s&&"disabled",l&&"error",d&&"filled",o&&"focused",p&&"required"],asterisk:["asterisk",l&&"error"]};return ha(f,Lye,e)},Oye=Bn("label",{name:"MuiFormLabel",slot:"Root",overridesResolver:({ownerState:n},e)=>qe({},e.root,n.color==="secondary"&&e.colorSecondary,n.filled&&e.filled)})(({theme:n,ownerState:e})=>qe({color:(n.vars||n).palette.text.secondary},n.typography.body1,{lineHeight:"1.4375em",padding:0,position:"relative",[`&.${dx.focused}`]:{color:(n.vars||n).palette[e.color].main},[`&.${dx.disabled}`]:{color:(n.vars||n).palette.text.disabled},[`&.${dx.error}`]:{color:(n.vars||n).palette.error.main}})),Nye=Bn("span",{name:"MuiFormLabel",slot:"Asterisk",overridesResolver:(n,e)=>e.asterisk})(({theme:n})=>({[`&.${dx.error}`]:{color:(n.vars||n).palette.error.main}})),zye=ie.forwardRef(function(e,i){const o=_a({props:e,name:"MuiFormLabel"}),{children:s,className:l,component:d="label"}=o,p=qn(o,kye),f=x_(),y=jw({props:o,muiFormControl:f,states:["color","required","focused","disabled","error","filled"]}),_=qe({},o,{color:y.color||"primary",component:d,disabled:y.disabled,error:y.error,filled:y.filled,focused:y.focused,required:y.required}),x=Dye(_);return $e(Oye,qe({as:d,ownerState:_,className:_i(x.root,l),ref:i},p,{children:[s,y.required&&$e(Nye,{ownerState:_,"aria-hidden":!0,className:x.asterisk,children:[" ","*"]})]}))}),Fye=zye,Bye=["addEndListener","appear","children","easing","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","style","timeout","TransitionComponent"];function YL(n){return`scale(${n}, ${n**2})`}const Uye={entering:{opacity:1,transform:YL(1)},entered:{opacity:1,transform:"none"}},_4=typeof navigator<"u"&&/^((?!chrome|android).)*(safari|mobile)/i.test(navigator.userAgent)&&/(os |version\/)15(.|_)4/i.test(navigator.userAgent),Rq=ie.forwardRef(function(e,i){const{addEndListener:o,appear:s=!0,children:l,easing:d,in:p,onEnter:f,onEntered:y,onEntering:_,onExit:x,onExited:S,onExiting:T,style:I,timeout:R="auto",TransitionComponent:D=RD}=e,L=qn(e,Bye),O=ie.useRef(),N=ie.useRef(),F=Zg(),G=ie.useRef(null),j=So(G,l.ref,i),Y=Me=>Ie=>{if(Me){const ze=G.current;Ie===void 0?Me(ze):Me(ze,Ie)}},te=Y(_),V=Y((Me,Ie)=>{OD(Me);const{duration:ze,delay:le,easing:me}=n_({style:I,timeout:R,easing:d},{mode:"enter"});let xe;R==="auto"?(xe=F.transitions.getAutoHeightDuration(Me.clientHeight),N.current=xe):xe=ze,Me.style.transition=[F.transitions.create("opacity",{duration:xe,delay:le}),F.transitions.create("transform",{duration:_4?xe:xe*.666,delay:le,easing:me})].join(","),f&&f(Me,Ie)}),Q=Y(y),he=Y(T),fe=Y(Me=>{const{duration:Ie,delay:ze,easing:le}=n_({style:I,timeout:R,easing:d},{mode:"exit"});let me;R==="auto"?(me=F.transitions.getAutoHeightDuration(Me.clientHeight),N.current=me):me=Ie,Me.style.transition=[F.transitions.create("opacity",{duration:me,delay:ze}),F.transitions.create("transform",{duration:_4?me:me*.666,delay:_4?ze:ze||me*.333,easing:le})].join(","),Me.style.opacity=0,Me.style.transform=YL(.75),x&&x(Me)}),ye=Y(S),pe=Me=>{R==="auto"&&(O.current=setTimeout(Me,N.current||0)),o&&o(G.current,Me)};return ie.useEffect(()=>()=>{clearTimeout(O.current)},[]),X(D,qe({appear:s,in:p,nodeRef:G,onEnter:V,onEntered:Q,onEntering:te,onExit:fe,onExited:ye,onExiting:he,addEndListener:pe,timeout:R==="auto"?null:R},L,{children:(Me,Ie)=>ie.cloneElement(l,qe({style:qe({opacity:0,transform:YL(.75),visibility:Me==="exited"&&!p?"hidden":void 0},Uye[Me],I,l.props.style),ref:j},Ie))}))});Rq.muiSupportAuto=!0;const qL=Rq,Wye=["disableUnderline","components","componentsProps","fullWidth","inputComponent","multiline","slotProps","slots","type"],Vye=n=>{const{classes:e,disableUnderline:i}=n,s=ha({root:["root",!i&&"underline"],input:["input"]},pge,e);return qe({},e,s)},Gye=Bn(IT,{shouldForwardProp:n=>Ml(n)||n==="classes",name:"MuiInput",slot:"Root",overridesResolver:(n,e)=>{const{ownerState:i}=n;return[...CT(n,e),!i.disableUnderline&&e.underline]}})(({theme:n,ownerState:e})=>{let o=n.palette.mode==="light"?"rgba(0, 0, 0, 0.42)":"rgba(255, 255, 255, 0.7)";return n.vars&&(o=`rgba(${n.vars.palette.common.onBackgroundChannel} / ${n.vars.opacity.inputUnderline})`),qe({position:"relative"},e.formControl&&{"label + &":{marginTop:16}},!e.disableUnderline&&{"&:after":{borderBottom:`2px solid ${(n.vars||n).palette[e.color].main}`,left:0,bottom:0,content:'""',position:"absolute",right:0,transform:"scaleX(0)",transition:n.transitions.create("transform",{duration:n.transitions.duration.shorter,easing:n.transitions.easing.easeOut}),pointerEvents:"none"},[`&.${lb.focused}:after`]:{transform:"scaleX(1) translateX(0)"},[`&.${lb.error}`]:{"&:before, &:after":{borderBottomColor:(n.vars||n).palette.error.main}},"&:before":{borderBottom:`1px solid ${o}`,left:0,bottom:0,content:'"\\00a0"',position:"absolute",right:0,transition:n.transitions.create("border-bottom-color",{duration:n.transitions.duration.shorter}),pointerEvents:"none"},[`&:hover:not(.${lb.disabled}, .${lb.error}):before`]:{borderBottom:`2px solid ${(n.vars||n).palette.text.primary}`,"@media (hover: none)":{borderBottom:`1px solid ${o}`}},[`&.${lb.disabled}:before`]:{borderBottomStyle:"dotted"}})}),Hye=Bn(LT,{name:"MuiInput",slot:"Input",overridesResolver:PT})({}),kq=ie.forwardRef(function(e,i){var o,s,l,d;const p=_a({props:e,name:"MuiInput"}),{disableUnderline:f,components:y={},componentsProps:_,fullWidth:x=!1,inputComponent:S="input",multiline:T=!1,slotProps:I,slots:R={},type:D="text"}=p,L=qn(p,Wye),O=Vye(p),F={root:{ownerState:{disableUnderline:f}}},G=I??_?wl(I??_,F):F,j=(o=(s=R.root)!=null?s:y.Root)!=null?o:Gye,Y=(l=(d=R.input)!=null?d:y.Input)!=null?l:Hye;return X(HD,qe({slots:{root:j,input:Y},slotProps:G,fullWidth:x,inputComponent:S,multiline:T,ref:i,type:D},L,{classes:O}))});kq.muiName="Input";const jye=kq;function $ye(n){return aa("MuiInputLabel",n)}Zi("MuiInputLabel",["root","focused","disabled","error","required","asterisk","formControl","sizeSmall","shrink","animated","standard","filled","outlined"]);const Yye=["disableAnimation","margin","shrink","variant","className"],qye=n=>{const{classes:e,formControl:i,size:o,shrink:s,disableAnimation:l,variant:d,required:p}=n,f={root:["root",i&&"formControl",!l&&"animated",s&&"shrink",o&&o!=="normal"&&`size${ai(o)}`,d],asterisk:[p&&"asterisk"]},y=ha(f,$ye,e);return qe({},e,y)},Xye=Bn(Fye,{shouldForwardProp:n=>Ml(n)||n==="classes",name:"MuiInputLabel",slot:"Root",overridesResolver:(n,e)=>{const{ownerState:i}=n;return[{[`& .${dx.asterisk}`]:e.asterisk},e.root,i.formControl&&e.formControl,i.size==="small"&&e.sizeSmall,i.shrink&&e.shrink,!i.disableAnimation&&e.animated,i.focused&&e.focused,e[i.variant]]}})(({theme:n,ownerState:e})=>qe({display:"block",transformOrigin:"top left",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"100%"},e.formControl&&{position:"absolute",left:0,top:0,transform:"translate(0, 20px) scale(1)"},e.size==="small"&&{transform:"translate(0, 17px) scale(1)"},e.shrink&&{transform:"translate(0, -1.5px) scale(0.75)",transformOrigin:"top left",maxWidth:"133%"},!e.disableAnimation&&{transition:n.transitions.create(["color","transform","max-width"],{duration:n.transitions.duration.shorter,easing:n.transitions.easing.easeOut})},e.variant==="filled"&&qe({zIndex:1,pointerEvents:"none",transform:"translate(12px, 16px) scale(1)",maxWidth:"calc(100% - 24px)"},e.size==="small"&&{transform:"translate(12px, 13px) scale(1)"},e.shrink&&qe({userSelect:"none",pointerEvents:"auto",transform:"translate(12px, 7px) scale(0.75)",maxWidth:"calc(133% - 24px)"},e.size==="small"&&{transform:"translate(12px, 4px) scale(0.75)"})),e.variant==="outlined"&&qe({zIndex:1,pointerEvents:"none",transform:"translate(14px, 16px) scale(1)",maxWidth:"calc(100% - 24px)"},e.size==="small"&&{transform:"translate(14px, 9px) scale(1)"},e.shrink&&{userSelect:"none",pointerEvents:"auto",maxWidth:"calc(133% - 32px)",transform:"translate(14px, -9px) scale(0.75)"}))),Zye=ie.forwardRef(function(e,i){const o=_a({name:"MuiInputLabel",props:e}),{disableAnimation:s=!1,shrink:l,className:d}=o,p=qn(o,Yye),f=x_();let y=l;typeof y>"u"&&f&&(y=f.filled||f.focused||f.adornedStart);const _=jw({props:o,muiFormControl:f,states:["size","variant","required","focused"]}),x=qe({},o,{disableAnimation:s,formControl:f,shrink:y,size:_.size,variant:_.variant,required:_.required,focused:_.focused}),S=qye(x);return X(Xye,qe({"data-shrink":y,ownerState:x,ref:i,className:_i(S.root,d)},p,{classes:S}))}),Kye=Zye,Jye=ie.createContext({}),XL=Jye;function Qye(n){return aa("MuiList",n)}Zi("MuiList",["root","padding","dense","subheader"]);const eve=["children","className","component","dense","disablePadding","subheader"],tve=n=>{const{classes:e,disablePadding:i,dense:o,subheader:s}=n;return ha({root:["root",!i&&"padding",o&&"dense",s&&"subheader"]},Qye,e)},nve=Bn("ul",{name:"MuiList",slot:"Root",overridesResolver:(n,e)=>{const{ownerState:i}=n;return[e.root,!i.disablePadding&&e.padding,i.dense&&e.dense,i.subheader&&e.subheader]}})(({ownerState:n})=>qe({listStyle:"none",margin:0,padding:0,position:"relative"},!n.disablePadding&&{paddingTop:8,paddingBottom:8},n.subheader&&{paddingTop:0})),ive=ie.forwardRef(function(e,i){const o=_a({props:e,name:"MuiList"}),{children:s,className:l,component:d="ul",dense:p=!1,disablePadding:f=!1,subheader:y}=o,_=qn(o,eve),x=ie.useMemo(()=>({dense:p}),[p]),S=qe({},o,{component:d,dense:p,disablePadding:f}),T=tve(S);return X(XL.Provider,{value:x,children:$e(nve,qe({as:d,className:_i(T.root,l),ref:i,ownerState:S},_,{children:[y,s]}))})}),ave=ive,rve=Zi("MuiListItemIcon",["root","alignItemsFlexStart"]),X7=rve,ove=Zi("MuiListItemText",["root","multiline","dense","inset","primary","secondary"]),Z7=ove,sve=["actions","autoFocus","autoFocusItem","children","className","disabledItemsFocusable","disableListWrap","onKeyDown","variant"];function b4(n,e,i){return n===e?n.firstChild:e&&e.nextElementSibling?e.nextElementSibling:i?null:n.firstChild}function K7(n,e,i){return n===e?i?n.firstChild:n.lastChild:e&&e.previousElementSibling?e.previousElementSibling:i?null:n.lastChild}function Dq(n,e){if(e===void 0)return!0;let i=n.innerText;return i===void 0&&(i=n.textContent),i=i.trim().toLowerCase(),i.length===0?!1:e.repeating?i[0]===e.keys[0]:i.indexOf(e.keys.join(""))===0}function cb(n,e,i,o,s,l){let d=!1,p=s(n,e,e?i:!1);for(;p;){if(p===n.firstChild){if(d)return!1;d=!0}const f=o?!1:p.disabled||p.getAttribute("aria-disabled")==="true";if(!p.hasAttribute("tabindex")||!Dq(p,l)||f)p=s(n,p,i);else return p.focus(),!0}return!1}const lve=ie.forwardRef(function(e,i){const{actions:o,autoFocus:s=!1,autoFocusItem:l=!1,children:d,className:p,disabledItemsFocusable:f=!1,disableListWrap:y=!1,onKeyDown:_,variant:x="selectedMenu"}=e,S=qn(e,sve),T=ie.useRef(null),I=ie.useRef({keys:[],repeating:!0,previousKeyMatched:!0,lastTime:null});gu(()=>{s&&T.current.focus()},[s]),ie.useImperativeHandle(o,()=>({adjustStyleForScrollbar:(N,F)=>{const G=!T.current.style.width;if(N.clientHeight<T.current.clientHeight&&G){const j=`${BY(ws(N))}px`;T.current.style[F.direction==="rtl"?"paddingLeft":"paddingRight"]=j,T.current.style.width=`calc(100% + ${j})`}return T.current}}),[]);const R=N=>{const F=T.current,G=N.key,j=ws(F).activeElement;if(G==="ArrowDown")N.preventDefault(),cb(F,j,y,f,b4);else if(G==="ArrowUp")N.preventDefault(),cb(F,j,y,f,K7);else if(G==="Home")N.preventDefault(),cb(F,null,y,f,b4);else if(G==="End")N.preventDefault(),cb(F,null,y,f,K7);else if(G.length===1){const Y=I.current,te=G.toLowerCase(),V=performance.now();Y.keys.length>0&&(V-Y.lastTime>500?(Y.keys=[],Y.repeating=!0,Y.previousKeyMatched=!0):Y.repeating&&te!==Y.keys[0]&&(Y.repeating=!1)),Y.lastTime=V,Y.keys.push(te);const Q=j&&!Y.repeating&&Dq(j,Y);Y.previousKeyMatched&&(Q||cb(F,j,!1,f,b4,Y))?N.preventDefault():Y.previousKeyMatched=!1}_&&_(N)},D=So(T,i);let L=-1;ie.Children.forEach(d,(N,F)=>{if(!ie.isValidElement(N)){L===F&&(L+=1,L>=d.length&&(L=-1));return}N.props.disabled||(x==="selectedMenu"&&N.props.selected||L===-1)&&(L=F),L===F&&(N.props.disabled||N.props.muiSkipListHighlight||N.type.muiSkipListHighlight)&&(L+=1,L>=d.length&&(L=-1))});const O=ie.Children.map(d,(N,F)=>{if(F===L){const G={};return l&&(G.autoFocus=!0),N.props.tabIndex===void 0&&x==="selectedMenu"&&(G.tabIndex=0),ie.cloneElement(N,G)}return N});return X(ave,qe({role:"menu",ref:D,className:p,onKeyDown:R,tabIndex:s?0:-1},S,{children:O}))}),cve=lve;function uve(n){return aa("MuiPopover",n)}Zi("MuiPopover",["root","paper"]);const dve=["onEntering"],hve=["action","anchorEl","anchorOrigin","anchorPosition","anchorReference","children","className","container","elevation","marginThreshold","open","PaperProps","slots","slotProps","transformOrigin","TransitionComponent","transitionDuration","TransitionProps","disableScrollLock"],pve=["slotProps"];function J7(n,e){let i=0;return typeof e=="number"?i=e:e==="center"?i=n.height/2:e==="bottom"&&(i=n.height),i}function Q7(n,e){let i=0;return typeof e=="number"?i=e:e==="center"?i=n.width/2:e==="right"&&(i=n.width),i}function eW(n){return[n.horizontal,n.vertical].map(e=>typeof e=="number"?`${e}px`:e).join(" ")}function x4(n){return typeof n=="function"?n():n}const fve=n=>{const{classes:e}=n;return ha({root:["root"],paper:["paper"]},uve,e)},mve=Bn(pye,{name:"MuiPopover",slot:"Root",overridesResolver:(n,e)=>e.root})({}),Oq=Bn(gq,{name:"MuiPopover",slot:"Paper",overridesResolver:(n,e)=>e.paper})({position:"absolute",overflowY:"auto",overflowX:"hidden",minWidth:16,minHeight:16,maxWidth:"calc(100% - 32px)",maxHeight:"calc(100% - 32px)",outline:0}),gve=ie.forwardRef(function(e,i){var o,s,l;const d=_a({props:e,name:"MuiPopover"}),{action:p,anchorEl:f,anchorOrigin:y={vertical:"top",horizontal:"left"},anchorPosition:_,anchorReference:x="anchorEl",children:S,className:T,container:I,elevation:R=8,marginThreshold:D=16,open:L,PaperProps:O={},slots:N,slotProps:F,transformOrigin:G={vertical:"top",horizontal:"left"},TransitionComponent:j=qL,transitionDuration:Y="auto",TransitionProps:{onEntering:te}={},disableScrollLock:V=!1}=d,Q=qn(d.TransitionProps,dve),he=qn(d,hve),fe=(o=F==null?void 0:F.paper)!=null?o:O,ye=ie.useRef(),pe=So(ye,fe.ref),Me=qe({},d,{anchorOrigin:y,anchorReference:x,elevation:R,marginThreshold:D,externalPaperSlotProps:fe,transformOrigin:G,TransitionComponent:j,transitionDuration:Y,TransitionProps:Q}),Ie=fve(Me),ze=ie.useCallback(()=>{if(x==="anchorPosition")return _;const ft=x4(f),_t=(ft&&ft.nodeType===1?ft:ws(ye.current).body).getBoundingClientRect();return{top:_t.top+J7(_t,y.vertical),left:_t.left+Q7(_t,y.horizontal)}},[f,y.horizontal,y.vertical,_,x]),le=ie.useCallback(ft=>({vertical:J7(ft,G.vertical),horizontal:Q7(ft,G.horizontal)}),[G.horizontal,G.vertical]),me=ie.useCallback(ft=>{const gt={width:ft.offsetWidth,height:ft.offsetHeight},_t=le(gt);if(x==="none")return{top:null,left:null,transformOrigin:eW(_t)};const Be=ze();let ue=Be.top-_t.vertical,se=Be.left-_t.horizontal;const _e=ue+gt.height,je=se+gt.width,De=bd(x4(f)),st=De.innerHeight-D,de=De.innerWidth-D;if(D!==null&&ue<D){const ne=ue-D;ue-=ne,_t.vertical+=ne}else if(D!==null&&_e>st){const ne=_e-st;ue-=ne,_t.vertical+=ne}if(D!==null&&se<D){const ne=se-D;se-=ne,_t.horizontal+=ne}else if(je>de){const ne=je-de;se-=ne,_t.horizontal+=ne}return{top:`${Math.round(ue)}px`,left:`${Math.round(se)}px`,transformOrigin:eW(_t)}},[f,x,ze,le,D]),[xe,ae]=ie.useState(L),Ee=ie.useCallback(()=>{const ft=ye.current;if(!ft)return;const gt=me(ft);gt.top!==null&&(ft.style.top=gt.top),gt.left!==null&&(ft.style.left=gt.left),ft.style.transformOrigin=gt.transformOrigin,ae(!0)},[me]);ie.useEffect(()=>(V&&window.addEventListener("scroll",Ee),()=>window.removeEventListener("scroll",Ee)),[f,V,Ee]);const Je=(ft,gt)=>{te&&te(ft,gt),Ee()},Ze=()=>{ae(!1)};ie.useEffect(()=>{L&&Ee()}),ie.useImperativeHandle(p,()=>L?{updatePosition:()=>{Ee()}}:null,[L,Ee]),ie.useEffect(()=>{if(!L)return;const ft=JM(()=>{Ee()}),gt=bd(f);return gt.addEventListener("resize",ft),()=>{ft.clear(),gt.removeEventListener("resize",ft)}},[f,L,Ee]);let Ke=Y;Y==="auto"&&!j.muiSupportAuto&&(Ke=void 0);const Fe=I||(f?ws(x4(f)).body:void 0),ct=(s=N==null?void 0:N.root)!=null?s:mve,Ct=(l=N==null?void 0:N.paper)!=null?l:Oq,kt=Ng({elementType:Ct,externalSlotProps:qe({},fe,{style:xe?fe.style:qe({},fe.style,{opacity:0})}),additionalProps:{elevation:R,ref:pe},ownerState:Me,className:_i(Ie.paper,fe==null?void 0:fe.className)}),Kt=Ng({elementType:ct,externalSlotProps:(F==null?void 0:F.root)||{},externalForwardedProps:he,additionalProps:{ref:i,slotProps:{backdrop:{invisible:!0}},container:Fe,open:L},ownerState:Me,className:_i(Ie.root,T)}),{slotProps:At}=Kt,Pe=qn(Kt,pve);return X(ct,qe({},Pe,!nM(ct)&&{slotProps:At,disableScrollLock:V},{children:X(j,qe({appear:!0,in:L,onEntering:Je,onExited:Ze,timeout:Ke},Q,{children:X(Ct,qe({},kt,{children:S}))}))}))}),yve=gve;function vve(n){return aa("MuiMenu",n)}Zi("MuiMenu",["root","paper","list"]);const _ve=["onEntering"],bve=["autoFocus","children","className","disableAutoFocusItem","MenuListProps","onClose","open","PaperProps","PopoverClasses","transitionDuration","TransitionProps","variant","slots","slotProps"],xve={vertical:"top",horizontal:"right"},wve={vertical:"top",horizontal:"left"},Sve=n=>{const{classes:e}=n;return ha({root:["root"],paper:["paper"],list:["list"]},vve,e)},Ave=Bn(yve,{shouldForwardProp:n=>Ml(n)||n==="classes",name:"MuiMenu",slot:"Root",overridesResolver:(n,e)=>e.root})({}),Eve=Bn(Oq,{name:"MuiMenu",slot:"Paper",overridesResolver:(n,e)=>e.paper})({maxHeight:"calc(100% - 96px)",WebkitOverflowScrolling:"touch"}),Mve=Bn(cve,{name:"MuiMenu",slot:"List",overridesResolver:(n,e)=>e.list})({outline:0}),Tve=ie.forwardRef(function(e,i){var o,s;const l=_a({props:e,name:"MuiMenu"}),{autoFocus:d=!0,children:p,className:f,disableAutoFocusItem:y=!1,MenuListProps:_={},onClose:x,open:S,PaperProps:T={},PopoverClasses:I,transitionDuration:R="auto",TransitionProps:{onEntering:D}={},variant:L="selectedMenu",slots:O={},slotProps:N={}}=l,F=qn(l.TransitionProps,_ve),G=qn(l,bve),j=Zg(),Y=j.direction==="rtl",te=qe({},l,{autoFocus:d,disableAutoFocusItem:y,MenuListProps:_,onEntering:D,PaperProps:T,transitionDuration:R,TransitionProps:F,variant:L}),V=Sve(te),Q=d&&!y&&S,he=ie.useRef(null),fe=(me,xe)=>{he.current&&he.current.adjustStyleForScrollbar(me,j),D&&D(me,xe)},ye=me=>{me.key==="Tab"&&(me.preventDefault(),x&&x(me,"tabKeyDown"))};let pe=-1;ie.Children.map(p,(me,xe)=>{ie.isValidElement(me)&&(me.props.disabled||(L==="selectedMenu"&&me.props.selected||pe===-1)&&(pe=xe))});const Me=(o=O.paper)!=null?o:Eve,Ie=(s=N.paper)!=null?s:T,ze=Ng({elementType:O.root,externalSlotProps:N.root,ownerState:te,className:[V.root,f]}),le=Ng({elementType:Me,externalSlotProps:Ie,ownerState:te,className:V.paper});return X(Ave,qe({onClose:x,anchorOrigin:{vertical:"bottom",horizontal:Y?"right":"left"},transformOrigin:Y?xve:wve,slots:{paper:Me,root:O.root},slotProps:{root:ze,paper:le},open:S,ref:i,transitionDuration:R,TransitionProps:qe({onEntering:fe},F),ownerState:te},G,{classes:I,children:X(Mve,qe({onKeyDown:ye,actions:he,autoFocus:d&&(pe===-1||y),autoFocusItem:Q,variant:L},_,{className:_i(V.list,_.className),children:p}))}))}),w_=Tve;function Cve(n){return aa("MuiMenuItem",n)}const Pve=Zi("MuiMenuItem",["root","focusVisible","dense","disabled","divider","gutters","selected"]),ub=Pve,Ive=["autoFocus","component","dense","divider","disableGutters","focusVisibleClassName","role","tabIndex","className"],Lve=(n,e)=>{const{ownerState:i}=n;return[e.root,i.dense&&e.dense,i.divider&&e.divider,!i.disableGutters&&e.gutters]},Rve=n=>{const{disabled:e,dense:i,divider:o,disableGutters:s,selected:l,classes:d}=n,f=ha({root:["root",i&&"dense",e&&"disabled",!s&&"gutters",o&&"divider",l&&"selected"]},Cve,d);return qe({},d,f)},kve=Bn(MT,{shouldForwardProp:n=>Ml(n)||n==="classes",name:"MuiMenuItem",slot:"Root",overridesResolver:Lve})(({theme:n,ownerState:e})=>qe({},n.typography.body1,{display:"flex",justifyContent:"flex-start",alignItems:"center",position:"relative",textDecoration:"none",minHeight:48,paddingTop:6,paddingBottom:6,boxSizing:"border-box",whiteSpace:"nowrap"},!e.disableGutters&&{paddingLeft:16,paddingRight:16},e.divider&&{borderBottom:`1px solid ${(n.vars||n).palette.divider}`,backgroundClip:"padding-box"},{"&:hover":{textDecoration:"none",backgroundColor:(n.vars||n).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${ub.selected}`]:{backgroundColor:n.vars?`rgba(${n.vars.palette.primary.mainChannel} / ${n.vars.palette.action.selectedOpacity})`:kr(n.palette.primary.main,n.palette.action.selectedOpacity),[`&.${ub.focusVisible}`]:{backgroundColor:n.vars?`rgba(${n.vars.palette.primary.mainChannel} / calc(${n.vars.palette.action.selectedOpacity} + ${n.vars.palette.action.focusOpacity}))`:kr(n.palette.primary.main,n.palette.action.selectedOpacity+n.palette.action.focusOpacity)}},[`&.${ub.selected}:hover`]:{backgroundColor:n.vars?`rgba(${n.vars.palette.primary.mainChannel} / calc(${n.vars.palette.action.selectedOpacity} + ${n.vars.palette.action.hoverOpacity}))`:kr(n.palette.primary.main,n.palette.action.selectedOpacity+n.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:n.vars?`rgba(${n.vars.palette.primary.mainChannel} / ${n.vars.palette.action.selectedOpacity})`:kr(n.palette.primary.main,n.palette.action.selectedOpacity)}},[`&.${ub.focusVisible}`]:{backgroundColor:(n.vars||n).palette.action.focus},[`&.${ub.disabled}`]:{opacity:(n.vars||n).palette.action.disabledOpacity},[`& + .${q7.root}`]:{marginTop:n.spacing(1),marginBottom:n.spacing(1)},[`& + .${q7.inset}`]:{marginLeft:52},[`& .${Z7.root}`]:{marginTop:0,marginBottom:0},[`& .${Z7.inset}`]:{paddingLeft:36},[`& .${X7.root}`]:{minWidth:36}},!e.dense&&{[n.breakpoints.up("sm")]:{minHeight:"auto"}},e.dense&&qe({minHeight:32,paddingTop:4,paddingBottom:4},n.typography.body2,{[`& .${X7.root} svg`]:{fontSize:"1.25rem"}}))),Dve=ie.forwardRef(function(e,i){const o=_a({props:e,name:"MuiMenuItem"}),{autoFocus:s=!1,component:l="li",dense:d=!1,divider:p=!1,disableGutters:f=!1,focusVisibleClassName:y,role:_="menuitem",tabIndex:x,className:S}=o,T=qn(o,Ive),I=ie.useContext(XL),R=ie.useMemo(()=>({dense:d||I.dense||!1,disableGutters:f}),[I.dense,d,f]),D=ie.useRef(null);gu(()=>{s&&D.current&&D.current.focus()},[s]);const L=qe({},o,{dense:R.dense,divider:p,disableGutters:f}),O=Rve(o),N=So(D,i);let F;return o.disabled||(F=x!==void 0?x:-1),X(XL.Provider,{value:R,children:X(kve,qe({ref:N,role:_,tabIndex:F,component:l,focusVisibleClassName:_i(O.focusVisible,y),className:_i(O.root,S)},T,{ownerState:L,classes:O}))})}),Fg=Dve;function Ove(n){return aa("MuiNativeSelect",n)}const Nve=Zi("MuiNativeSelect",["root","select","multiple","filled","outlined","standard","disabled","icon","iconOpen","iconFilled","iconOutlined","iconStandard","nativeInput","error"]),jD=Nve,zve=["className","disabled","error","IconComponent","inputRef","variant"],Fve=n=>{const{classes:e,variant:i,disabled:o,multiple:s,open:l,error:d}=n,p={select:["select",i,o&&"disabled",s&&"multiple",d&&"error"],icon:["icon",`icon${ai(i)}`,l&&"iconOpen",o&&"disabled"]};return ha(p,Ove,e)},Nq=({ownerState:n,theme:e})=>qe({MozAppearance:"none",WebkitAppearance:"none",userSelect:"none",borderRadius:0,cursor:"pointer","&:focus":qe({},e.vars?{backgroundColor:`rgba(${e.vars.palette.common.onBackgroundChannel} / 0.05)`}:{backgroundColor:e.palette.mode==="light"?"rgba(0, 0, 0, 0.05)":"rgba(255, 255, 255, 0.05)"},{borderRadius:0}),"&::-ms-expand":{display:"none"},[`&.${jD.disabled}`]:{cursor:"default"},"&[multiple]":{height:"auto"},"&:not([multiple]) option, &:not([multiple]) optgroup":{backgroundColor:(e.vars||e).palette.background.paper},"&&&":{paddingRight:24,minWidth:16}},n.variant==="filled"&&{"&&&":{paddingRight:32}},n.variant==="outlined"&&{borderRadius:(e.vars||e).shape.borderRadius,"&:focus":{borderRadius:(e.vars||e).shape.borderRadius},"&&&":{paddingRight:32}}),Bve=Bn("select",{name:"MuiNativeSelect",slot:"Select",shouldForwardProp:Ml,overridesResolver:(n,e)=>{const{ownerState:i}=n;return[e.select,e[i.variant],i.error&&e.error,{[`&.${jD.multiple}`]:e.multiple}]}})(Nq),zq=({ownerState:n,theme:e})=>qe({position:"absolute",right:0,top:"calc(50% - .5em)",pointerEvents:"none",color:(e.vars||e).palette.action.active,[`&.${jD.disabled}`]:{color:(e.vars||e).palette.action.disabled}},n.open&&{transform:"rotate(180deg)"},n.variant==="filled"&&{right:7},n.variant==="outlined"&&{right:7}),Uve=Bn("svg",{name:"MuiNativeSelect",slot:"Icon",overridesResolver:(n,e)=>{const{ownerState:i}=n;return[e.icon,i.variant&&e[`icon${ai(i.variant)}`],i.open&&e.iconOpen]}})(zq),Wve=ie.forwardRef(function(e,i){const{className:o,disabled:s,error:l,IconComponent:d,inputRef:p,variant:f="standard"}=e,y=qn(e,zve),_=qe({},e,{disabled:s,variant:f,error:l}),x=Fve(_);return $e(ie.Fragment,{children:[X(Bve,qe({ownerState:_,className:_i(x.select,o),disabled:s,ref:p||i},y)),e.multiple?null:X(Uve,{as:d,ownerState:_,className:x.icon})]})}),Vve=Wve;var tW;const Gve=["children","classes","className","label","notched"],Hve=Bn("fieldset",{shouldForwardProp:Ml})({textAlign:"left",position:"absolute",bottom:0,right:0,top:-5,left:0,margin:0,padding:"0 8px",pointerEvents:"none",borderRadius:"inherit",borderStyle:"solid",borderWidth:1,overflow:"hidden",minWidth:"0%"}),jve=Bn("legend",{shouldForwardProp:Ml})(({ownerState:n,theme:e})=>qe({float:"unset",width:"auto",overflow:"hidden"},!n.withLabel&&{padding:0,lineHeight:"11px",transition:e.transitions.create("width",{duration:150,easing:e.transitions.easing.easeOut})},n.withLabel&&qe({display:"block",padding:0,height:11,fontSize:"0.75em",visibility:"hidden",maxWidth:.01,transition:e.transitions.create("max-width",{duration:50,easing:e.transitions.easing.easeOut}),whiteSpace:"nowrap","& > span":{paddingLeft:5,paddingRight:5,display:"inline-block",opacity:0,visibility:"visible"}},n.notched&&{maxWidth:"100%",transition:e.transitions.create("max-width",{duration:100,easing:e.transitions.easing.easeOut,delay:50})})));function $ve(n){const{className:e,label:i,notched:o}=n,s=qn(n,Gve),l=i!=null&&i!=="",d=qe({},n,{notched:o,withLabel:l});return X(Hve,qe({"aria-hidden":!0,className:e,ownerState:d},s,{children:X(jve,{ownerState:d,children:l?X("span",{children:i}):tW||(tW=X("span",{className:"notranslate",children:"​"}))})}))}const Yve=["components","fullWidth","inputComponent","label","multiline","notched","slots","type"],qve=n=>{const{classes:e}=n,o=ha({root:["root"],notchedOutline:["notchedOutline"],input:["input"]},mge,e);return qe({},e,o)},Xve=Bn(IT,{shouldForwardProp:n=>Ml(n)||n==="classes",name:"MuiOutlinedInput",slot:"Root",overridesResolver:CT})(({theme:n,ownerState:e})=>{const i=n.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)";return qe({position:"relative",borderRadius:(n.vars||n).shape.borderRadius,[`&:hover .${zp.notchedOutline}`]:{borderColor:(n.vars||n).palette.text.primary},"@media (hover: none)":{[`&:hover .${zp.notchedOutline}`]:{borderColor:n.vars?`rgba(${n.vars.palette.common.onBackgroundChannel} / 0.23)`:i}},[`&.${zp.focused} .${zp.notchedOutline}`]:{borderColor:(n.vars||n).palette[e.color].main,borderWidth:2},[`&.${zp.error} .${zp.notchedOutline}`]:{borderColor:(n.vars||n).palette.error.main},[`&.${zp.disabled} .${zp.notchedOutline}`]:{borderColor:(n.vars||n).palette.action.disabled}},e.startAdornment&&{paddingLeft:14},e.endAdornment&&{paddingRight:14},e.multiline&&qe({padding:"16.5px 14px"},e.size==="small"&&{padding:"8.5px 14px"}))}),Zve=Bn($ve,{name:"MuiOutlinedInput",slot:"NotchedOutline",overridesResolver:(n,e)=>e.notchedOutline})(({theme:n})=>{const e=n.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)";return{borderColor:n.vars?`rgba(${n.vars.palette.common.onBackgroundChannel} / 0.23)`:e}}),Kve=Bn(LT,{name:"MuiOutlinedInput",slot:"Input",overridesResolver:PT})(({theme:n,ownerState:e})=>qe({padding:"16.5px 14px"},!n.vars&&{"&:-webkit-autofill":{WebkitBoxShadow:n.palette.mode==="light"?null:"0 0 0 100px #266798 inset",WebkitTextFillColor:n.palette.mode==="light"?null:"#fff",caretColor:n.palette.mode==="light"?null:"#fff",borderRadius:"inherit"}},n.vars&&{"&:-webkit-autofill":{borderRadius:"inherit"},[n.getColorSchemeSelector("dark")]:{"&:-webkit-autofill":{WebkitBoxShadow:"0 0 0 100px #266798 inset",WebkitTextFillColor:"#fff",caretColor:"#fff"}}},e.size==="small"&&{padding:"8.5px 14px"},e.multiline&&{padding:0},e.startAdornment&&{paddingLeft:0},e.endAdornment&&{paddingRight:0})),Fq=ie.forwardRef(function(e,i){var o,s,l,d,p;const f=_a({props:e,name:"MuiOutlinedInput"}),{components:y={},fullWidth:_=!1,inputComponent:x="input",label:S,multiline:T=!1,notched:I,slots:R={},type:D="text"}=f,L=qn(f,Yve),O=qve(f),N=x_(),F=jw({props:f,muiFormControl:N,states:["color","disabled","error","focused","hiddenLabel","size","required"]}),G=qe({},f,{color:F.color||"primary",disabled:F.disabled,error:F.error,focused:F.focused,formControl:N,fullWidth:_,hiddenLabel:F.hiddenLabel,multiline:T,size:F.size,type:D}),j=(o=(s=R.root)!=null?s:y.Root)!=null?o:Xve,Y=(l=(d=R.input)!=null?d:y.Input)!=null?l:Kve;return X(HD,qe({slots:{root:j,input:Y},renderSuffix:te=>X(Zve,{ownerState:G,className:O.notchedOutline,label:S!=null&&S!==""&&F.required?p||(p=$e(ie.Fragment,{children:[S," ","*"]})):S,notched:typeof I<"u"?I:!!(te.startAdornment||te.filled||te.focused)}),fullWidth:_,inputComponent:x,multiline:T,ref:i,type:D},L,{classes:qe({},O,{notchedOutline:null})}))});Fq.muiName="Input";const Jve=Fq;function Qve(n){return aa("MuiSelect",n)}const e0e=Zi("MuiSelect",["root","select","multiple","filled","outlined","standard","disabled","focused","icon","iconOpen","iconFilled","iconOutlined","iconStandard","nativeInput","error"]),db=e0e;var nW;const t0e=["aria-describedby","aria-label","autoFocus","autoWidth","children","className","defaultOpen","defaultValue","disabled","displayEmpty","error","IconComponent","inputRef","labelId","MenuProps","multiple","name","onBlur","onChange","onClose","onFocus","onOpen","open","readOnly","renderValue","SelectDisplayProps","tabIndex","type","value","variant"],n0e=Bn("div",{name:"MuiSelect",slot:"Select",overridesResolver:(n,e)=>{const{ownerState:i}=n;return[{[`&.${db.select}`]:e.select},{[`&.${db.select}`]:e[i.variant]},{[`&.${db.error}`]:e.error},{[`&.${db.multiple}`]:e.multiple}]}})(Nq,{[`&.${db.select}`]:{height:"auto",minHeight:"1.4375em",textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"}}),i0e=Bn("svg",{name:"MuiSelect",slot:"Icon",overridesResolver:(n,e)=>{const{ownerState:i}=n;return[e.icon,i.variant&&e[`icon${ai(i.variant)}`],i.open&&e.iconOpen]}})(zq),a0e=Bn("input",{shouldForwardProp:n=>_pe(n)&&n!=="classes",name:"MuiSelect",slot:"NativeInput",overridesResolver:(n,e)=>e.nativeInput})({bottom:0,left:0,position:"absolute",opacity:0,pointerEvents:"none",width:"100%",boxSizing:"border-box"});function iW(n,e){return typeof e=="object"&&e!==null?n===e:String(n)===String(e)}function r0e(n){return n==null||typeof n=="string"&&!n.trim()}const o0e=n=>{const{classes:e,variant:i,disabled:o,multiple:s,open:l,error:d}=n,p={select:["select",i,o&&"disabled",s&&"multiple",d&&"error"],icon:["icon",`icon${ai(i)}`,l&&"iconOpen",o&&"disabled"],nativeInput:["nativeInput"]};return ha(p,Qve,e)},s0e=ie.forwardRef(function(e,i){var o;const{"aria-describedby":s,"aria-label":l,autoFocus:d,autoWidth:p,children:f,className:y,defaultOpen:_,defaultValue:x,disabled:S,displayEmpty:T,error:I=!1,IconComponent:R,inputRef:D,labelId:L,MenuProps:O={},multiple:N,name:F,onBlur:G,onChange:j,onClose:Y,onFocus:te,onOpen:V,open:Q,readOnly:he,renderValue:fe,SelectDisplayProps:ye={},tabIndex:pe,value:Me,variant:Ie="standard"}=e,ze=qn(e,t0e),[le,me]=qx({controlled:Me,default:x,name:"Select"}),[xe,ae]=qx({controlled:Q,default:_,name:"Select"}),Ee=ie.useRef(null),Je=ie.useRef(null),[Ze,Ke]=ie.useState(null),{current:Fe}=ie.useRef(Q!=null),[ct,Ct]=ie.useState(),kt=So(i,D),Kt=ie.useCallback(Dt=>{Je.current=Dt,Dt&&Ke(Dt)},[]),At=Ze==null?void 0:Ze.parentNode;ie.useImperativeHandle(kt,()=>({focus:()=>{Je.current.focus()},node:Ee.current,value:le}),[le]),ie.useEffect(()=>{_&&xe&&Ze&&!Fe&&(Ct(p?null:At.clientWidth),Je.current.focus())},[Ze,p]),ie.useEffect(()=>{d&&Je.current.focus()},[d]),ie.useEffect(()=>{if(!L)return;const Dt=ws(Je.current).getElementById(L);if(Dt){const wt=()=>{getSelection().isCollapsed&&Je.current.focus()};return Dt.addEventListener("click",wt),()=>{Dt.removeEventListener("click",wt)}}},[L]);const Pe=(Dt,wt)=>{Dt?V&&V(wt):Y&&Y(wt),Fe||(Ct(p?null:At.clientWidth),ae(Dt))},ft=Dt=>{Dt.button===0&&(Dt.preventDefault(),Je.current.focus(),Pe(!0,Dt))},gt=Dt=>{Pe(!1,Dt)},_t=ie.Children.toArray(f),Be=Dt=>{const wt=_t.find(Xt=>Xt.props.value===Dt.target.value);wt!==void 0&&(me(wt.props.value),j&&j(Dt,wt))},ue=Dt=>wt=>{let Xt;if(wt.currentTarget.hasAttribute("tabindex")){if(N){Xt=Array.isArray(le)?le.slice():[];const He=le.indexOf(Dt.props.value);He===-1?Xt.push(Dt.props.value):Xt.splice(He,1)}else Xt=Dt.props.value;if(Dt.props.onClick&&Dt.props.onClick(wt),le!==Xt&&(me(Xt),j)){const He=wt.nativeEvent||wt,Pt=new He.constructor(He.type,He);Object.defineProperty(Pt,"target",{writable:!0,value:{value:Xt,name:F}}),j(Pt,Dt)}N||Pe(!1,wt)}},se=Dt=>{he||[" ","ArrowUp","ArrowDown","Enter"].indexOf(Dt.key)!==-1&&(Dt.preventDefault(),Pe(!0,Dt))},_e=Ze!==null&&xe,je=Dt=>{!_e&&G&&(Object.defineProperty(Dt,"target",{writable:!0,value:{value:le,name:F}}),G(Dt))};delete ze["aria-invalid"];let De,st;const de=[];let ne=!1;(aM({value:le})||T)&&(fe?De=fe(le):ne=!0);const Oe=_t.map(Dt=>{if(!ie.isValidElement(Dt))return null;let wt;if(N){if(!Array.isArray(le))throw new Error(xf(2));wt=le.some(Xt=>iW(Xt,Dt.props.value)),wt&&ne&&de.push(Dt.props.children)}else wt=iW(le,Dt.props.value),wt&&ne&&(st=Dt.props.children);return ie.cloneElement(Dt,{"aria-selected":wt?"true":"false",onClick:ue(Dt),onKeyUp:Xt=>{Xt.key===" "&&Xt.preventDefault(),Dt.props.onKeyUp&&Dt.props.onKeyUp(Xt)},role:"option",selected:wt,value:void 0,"data-value":Dt.props.value})});ne&&(N?de.length===0?De=null:De=de.reduce((Dt,wt,Xt)=>(Dt.push(wt),Xt<de.length-1&&Dt.push(", "),Dt),[]):De=st);let ut=ct;!p&&Fe&&Ze&&(ut=At.clientWidth);let it;typeof pe<"u"?it=pe:it=S?null:0;const lt=ye.id||(F?`mui-component-select-${F}`:void 0),Et=qe({},e,{variant:Ie,value:le,open:_e,error:I}),Ut=o0e(Et),Wt=qe({},O.PaperProps,(o=O.slotProps)==null?void 0:o.paper),Ht=lD();return $e(ie.Fragment,{children:[X(n0e,qe({ref:Kt,tabIndex:it,role:"combobox","aria-controls":Ht,"aria-disabled":S?"true":void 0,"aria-expanded":_e?"true":"false","aria-haspopup":"listbox","aria-label":l,"aria-labelledby":[L,lt].filter(Boolean).join(" ")||void 0,"aria-describedby":s,onKeyDown:se,onMouseDown:S||he?null:ft,onBlur:je,onFocus:te},ye,{ownerState:Et,className:_i(ye.className,Ut.select,y),id:lt,children:r0e(De)?nW||(nW=X("span",{className:"notranslate",children:"​"})):De})),X(a0e,qe({"aria-invalid":I,value:Array.isArray(le)?le.join(","):le,name:F,ref:Ee,"aria-hidden":!0,onChange:Be,tabIndex:-1,disabled:S,className:Ut.nativeInput,autoFocus:d,ownerState:Et},ze)),X(i0e,{as:R,className:Ut.icon,ownerState:Et}),X(w_,qe({id:`menu-${F||""}`,anchorEl:At,open:_e,onClose:gt,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"}},O,{MenuListProps:qe({"aria-labelledby":L,role:"listbox","aria-multiselectable":N?"true":void 0,disableListWrap:!0,id:Ht},O.MenuListProps),slotProps:qe({},O.slotProps,{paper:qe({},Wt,{style:qe({minWidth:ut},Wt!=null?Wt.style:null)})}),children:Oe}))]})}),l0e=s0e,c0e=["autoWidth","children","classes","className","defaultOpen","displayEmpty","IconComponent","id","input","inputProps","label","labelId","MenuProps","multiple","native","onClose","onOpen","open","renderValue","SelectDisplayProps","variant"],u0e=["root"],d0e=n=>{const{classes:e}=n;return e},$D={name:"MuiSelect",overridesResolver:(n,e)=>e.root,shouldForwardProp:n=>Ml(n)&&n!=="variant",slot:"Root"},h0e=Bn(jye,$D)(""),p0e=Bn(Jve,$D)(""),f0e=Bn(Aye,$D)(""),Bq=ie.forwardRef(function(e,i){const o=_a({name:"MuiSelect",props:e}),{autoWidth:s=!1,children:l,classes:d={},className:p,defaultOpen:f=!1,displayEmpty:y=!1,IconComponent:_=_ge,id:x,input:S,inputProps:T,label:I,labelId:R,MenuProps:D,multiple:L=!1,native:O=!1,onClose:N,onOpen:F,open:G,renderValue:j,SelectDisplayProps:Y,variant:te="outlined"}=o,V=qn(o,c0e),Q=O?Vve:l0e,he=x_(),fe=jw({props:o,muiFormControl:he,states:["variant","error"]}),ye=fe.variant||te,pe=qe({},o,{variant:ye,classes:d}),Me=d0e(pe),Ie=qn(Me,u0e),ze=S||{standard:X(h0e,{ownerState:pe}),outlined:X(p0e,{label:I,ownerState:pe}),filled:X(f0e,{ownerState:pe})}[ye],le=So(i,ze.ref);return X(ie.Fragment,{children:ie.cloneElement(ze,qe({inputComponent:Q,inputProps:qe({children:l,error:fe.error,IconComponent:_,variant:ye,type:void 0,multiple:L},O?{id:x}:{autoWidth:s,defaultOpen:f,displayEmpty:y,labelId:R,MenuProps:D,onClose:N,onOpen:F,open:G,renderValue:j,SelectDisplayProps:qe({id:x},Y)},T,{classes:T?wl(Ie,T.classes):Ie},S?S.props.inputProps:{})},L&&O&&ye==="outlined"?{notched:!0}:{},{ref:le,className:_i(ze.props.className,p,Me.root)},!S&&{variant:ye},V))})});Bq.muiName="Select";const m0e=Bq;function g0e(n){return aa("MuiTooltip",n)}const y0e=Zi("MuiTooltip",["popper","popperInteractive","popperArrow","popperClose","tooltip","tooltipArrow","touch","tooltipPlacementLeft","tooltipPlacementRight","tooltipPlacementTop","tooltipPlacementBottom","arrow"]),Ih=y0e,v0e=["arrow","children","classes","components","componentsProps","describeChild","disableFocusListener","disableHoverListener","disableInteractive","disableTouchListener","enterDelay","enterNextDelay","enterTouchDelay","followCursor","id","leaveDelay","leaveTouchDelay","onClose","onOpen","open","placement","PopperComponent","PopperProps","slotProps","slots","title","TransitionComponent","TransitionProps"];function _0e(n){return Math.round(n*1e5)/1e5}const b0e=n=>{const{classes:e,disableInteractive:i,arrow:o,touch:s,placement:l}=n,d={popper:["popper",!i&&"popperInteractive",o&&"popperArrow"],tooltip:["tooltip",o&&"tooltipArrow",s&&"touch",`tooltipPlacement${ai(l.split("-")[0])}`],arrow:["arrow"]};return ha(d,g0e,e)},x0e=Bn(Cq,{name:"MuiTooltip",slot:"Popper",overridesResolver:(n,e)=>{const{ownerState:i}=n;return[e.popper,!i.disableInteractive&&e.popperInteractive,i.arrow&&e.popperArrow,!i.open&&e.popperClose]}})(({theme:n,ownerState:e,open:i})=>qe({zIndex:(n.vars||n).zIndex.tooltip,pointerEvents:"none"},!e.disableInteractive&&{pointerEvents:"auto"},!i&&{pointerEvents:"none"},e.arrow&&{[`&[data-popper-placement*="bottom"] .${Ih.arrow}`]:{top:0,marginTop:"-0.71em","&::before":{transformOrigin:"0 100%"}},[`&[data-popper-placement*="top"] .${Ih.arrow}`]:{bottom:0,marginBottom:"-0.71em","&::before":{transformOrigin:"100% 0"}},[`&[data-popper-placement*="right"] .${Ih.arrow}`]:qe({},e.isRtl?{right:0,marginRight:"-0.71em"}:{left:0,marginLeft:"-0.71em"},{height:"1em",width:"0.71em","&::before":{transformOrigin:"100% 100%"}}),[`&[data-popper-placement*="left"] .${Ih.arrow}`]:qe({},e.isRtl?{left:0,marginLeft:"-0.71em"}:{right:0,marginRight:"-0.71em"},{height:"1em",width:"0.71em","&::before":{transformOrigin:"0 0"}})})),w0e=Bn("div",{name:"MuiTooltip",slot:"Tooltip",overridesResolver:(n,e)=>{const{ownerState:i}=n;return[e.tooltip,i.touch&&e.touch,i.arrow&&e.tooltipArrow,e[`tooltipPlacement${ai(i.placement.split("-")[0])}`]]}})(({theme:n,ownerState:e})=>qe({backgroundColor:n.vars?n.vars.palette.Tooltip.bg:kr(n.palette.grey[700],.92),borderRadius:(n.vars||n).shape.borderRadius,color:(n.vars||n).palette.common.white,fontFamily:n.typography.fontFamily,padding:"4px 8px",fontSize:n.typography.pxToRem(11),maxWidth:300,margin:2,wordWrap:"break-word",fontWeight:n.typography.fontWeightMedium},e.arrow&&{position:"relative",margin:0},e.touch&&{padding:"8px 16px",fontSize:n.typography.pxToRem(14),lineHeight:`${_0e(16/14)}em`,fontWeight:n.typography.fontWeightRegular},{[`.${Ih.popper}[data-popper-placement*="left"] &`]:qe({transformOrigin:"right center"},e.isRtl?qe({marginLeft:"14px"},e.touch&&{marginLeft:"24px"}):qe({marginRight:"14px"},e.touch&&{marginRight:"24px"})),[`.${Ih.popper}[data-popper-placement*="right"] &`]:qe({transformOrigin:"left center"},e.isRtl?qe({marginRight:"14px"},e.touch&&{marginRight:"24px"}):qe({marginLeft:"14px"},e.touch&&{marginLeft:"24px"})),[`.${Ih.popper}[data-popper-placement*="top"] &`]:qe({transformOrigin:"center bottom",marginBottom:"14px"},e.touch&&{marginBottom:"24px"}),[`.${Ih.popper}[data-popper-placement*="bottom"] &`]:qe({transformOrigin:"center top",marginTop:"14px"},e.touch&&{marginTop:"24px"})})),S0e=Bn("span",{name:"MuiTooltip",slot:"Arrow",overridesResolver:(n,e)=>e.arrow})(({theme:n})=>({overflow:"hidden",position:"absolute",width:"1em",height:"0.71em",boxSizing:"border-box",color:n.vars?n.vars.palette.Tooltip.bg:kr(n.palette.grey[700],.9),"&::before":{content:'""',margin:"auto",display:"block",width:"100%",height:"100%",backgroundColor:"currentColor",transform:"rotate(45deg)"}}));let wS=!1,w4=null,hb={x:0,y:0};function SS(n,e){return i=>{e&&e(i),n(i)}}const A0e=ie.forwardRef(function(e,i){var o,s,l,d,p,f,y,_,x,S,T,I,R,D,L,O,N,F,G;const j=_a({props:e,name:"MuiTooltip"}),{arrow:Y=!1,children:te,components:V={},componentsProps:Q={},describeChild:he=!1,disableFocusListener:fe=!1,disableHoverListener:ye=!1,disableInteractive:pe=!1,disableTouchListener:Me=!1,enterDelay:Ie=100,enterNextDelay:ze=0,enterTouchDelay:le=700,followCursor:me=!1,id:xe,leaveDelay:ae=0,leaveTouchDelay:Ee=1500,onClose:Je,onOpen:Ze,open:Ke,placement:Fe="bottom",PopperComponent:ct,PopperProps:Ct={},slotProps:kt={},slots:Kt={},title:At,TransitionComponent:Pe=qL,TransitionProps:ft}=j,gt=qn(j,v0e),_t=ie.isValidElement(te)?te:X("span",{children:te}),Be=Zg(),ue=Be.direction==="rtl",[se,_e]=ie.useState(),[je,De]=ie.useState(null),st=ie.useRef(!1),de=pe||me,ne=ie.useRef(),Oe=ie.useRef(),ut=ie.useRef(),it=ie.useRef(),[lt,Et]=qx({controlled:Ke,default:!1,name:"Tooltip",state:"open"});let Ut=lt;const Wt=lD(xe),Ht=ie.useRef(),Dt=ie.useCallback(()=>{Ht.current!==void 0&&(document.body.style.WebkitUserSelect=Ht.current,Ht.current=void 0),clearTimeout(it.current)},[]);ie.useEffect(()=>()=>{clearTimeout(ne.current),clearTimeout(Oe.current),clearTimeout(ut.current),Dt()},[Dt]);const wt=jt=>{clearTimeout(w4),wS=!0,Et(!0),Ze&&!Ut&&Ze(jt)},Xt=Qp(jt=>{clearTimeout(w4),w4=setTimeout(()=>{wS=!1},800+ae),Et(!1),Je&&Ut&&Je(jt),clearTimeout(ne.current),ne.current=setTimeout(()=>{st.current=!1},Be.transitions.duration.shortest)}),He=jt=>{st.current&&jt.type!=="touchstart"||(se&&se.removeAttribute("title"),clearTimeout(Oe.current),clearTimeout(ut.current),Ie||wS&&ze?Oe.current=setTimeout(()=>{wt(jt)},wS?ze:Ie):wt(jt))},Pt=jt=>{clearTimeout(Oe.current),clearTimeout(ut.current),ut.current=setTimeout(()=>{Xt(jt)},ae)},{isFocusVisibleRef:qt,onBlur:Nt,onFocus:hn,ref:be}=cD(),[,Qe]=ie.useState(!1),we=jt=>{Nt(jt),qt.current===!1&&(Qe(!1),Pt(jt))},Te=jt=>{se||_e(jt.currentTarget),hn(jt),qt.current===!0&&(Qe(!0),He(jt))},Ne=jt=>{st.current=!0;const gn=_t.props;gn.onTouchStart&&gn.onTouchStart(jt)},et=He,tt=Pt,vt=jt=>{Ne(jt),clearTimeout(ut.current),clearTimeout(ne.current),Dt(),Ht.current=document.body.style.WebkitUserSelect,document.body.style.WebkitUserSelect="none",it.current=setTimeout(()=>{document.body.style.WebkitUserSelect=Ht.current,He(jt)},le)},ht=jt=>{_t.props.onTouchEnd&&_t.props.onTouchEnd(jt),Dt(),clearTimeout(ut.current),ut.current=setTimeout(()=>{Xt(jt)},Ee)};ie.useEffect(()=>{if(!Ut)return;function jt(gn){(gn.key==="Escape"||gn.key==="Esc")&&Xt(gn)}return document.addEventListener("keydown",jt),()=>{document.removeEventListener("keydown",jt)}},[Xt,Ut]);const dt=So(_t.ref,be,_e,i);!At&&At!==0&&(Ut=!1);const Vt=ie.useRef(),It=jt=>{const gn=_t.props;gn.onMouseMove&&gn.onMouseMove(jt),hb={x:jt.clientX,y:jt.clientY},Vt.current&&Vt.current.update()},Qt={},fn=typeof At=="string";he?(Qt.title=!Ut&&fn&&!ye?At:null,Qt["aria-describedby"]=Ut?Wt:null):(Qt["aria-label"]=fn?At:null,Qt["aria-labelledby"]=Ut&&!fn?Wt:null);const en=qe({},Qt,gt,_t.props,{className:_i(gt.className,_t.props.className),onTouchStart:Ne,ref:dt},me?{onMouseMove:It}:{}),vn={};Me||(en.onTouchStart=vt,en.onTouchEnd=ht),ye||(en.onMouseOver=SS(et,en.onMouseOver),en.onMouseLeave=SS(tt,en.onMouseLeave),de||(vn.onMouseOver=et,vn.onMouseLeave=tt)),fe||(en.onFocus=SS(Te,en.onFocus),en.onBlur=SS(we,en.onBlur),de||(vn.onFocus=Te,vn.onBlur=we));const Vn=ie.useMemo(()=>{var jt;let gn=[{name:"arrow",enabled:!!je,options:{element:je,padding:4}}];return(jt=Ct.popperOptions)!=null&&jt.modifiers&&(gn=gn.concat(Ct.popperOptions.modifiers)),qe({},Ct.popperOptions,{modifiers:gn})},[je,Ct]),ei=qe({},j,{isRtl:ue,arrow:Y,disableInteractive:de,placement:Fe,PopperComponentProp:ct,touch:st.current}),xi=b0e(ei),wi=(o=(s=Kt.popper)!=null?s:V.Popper)!=null?o:x0e,pa=(l=(d=(p=Kt.transition)!=null?p:V.Transition)!=null?d:Pe)!=null?l:qL,na=(f=(y=Kt.tooltip)!=null?y:V.Tooltip)!=null?f:w0e,Re=(_=(x=Kt.arrow)!=null?x:V.Arrow)!=null?_:S0e,bt=Ub(wi,qe({},Ct,(S=kt.popper)!=null?S:Q.popper,{className:_i(xi.popper,Ct==null?void 0:Ct.className,(T=(I=kt.popper)!=null?I:Q.popper)==null?void 0:T.className)}),ei),Ot=Ub(pa,qe({},ft,(R=kt.transition)!=null?R:Q.transition),ei),Lt=Ub(na,qe({},(D=kt.tooltip)!=null?D:Q.tooltip,{className:_i(xi.tooltip,(L=(O=kt.tooltip)!=null?O:Q.tooltip)==null?void 0:L.className)}),ei),zt=Ub(Re,qe({},(N=kt.arrow)!=null?N:Q.arrow,{className:_i(xi.arrow,(F=(G=kt.arrow)!=null?G:Q.arrow)==null?void 0:F.className)}),ei);return $e(ie.Fragment,{children:[ie.cloneElement(_t,en),X(wi,qe({as:ct??Cq,placement:Fe,anchorEl:me?{getBoundingClientRect:()=>({top:hb.y,left:hb.x,right:hb.x,bottom:hb.y,width:0,height:0})}:se,popperRef:Vt,open:se?Ut:!1,id:Wt,transition:!0},vn,bt,{popperOptions:Vn,children:({TransitionProps:jt})=>X(pa,qe({timeout:Be.transitions.duration.shorter},jt,Ot,{children:$e(na,qe({},Lt,{children:[At,Y?X(Re,qe({},zt,{ref:De})):null]}))}))}))]})}),E0e=A0e;function M0e(n){return aa("MuiSwitch",n)}const T0e=Zi("MuiSwitch",["root","edgeStart","edgeEnd","switchBase","colorPrimary","colorSecondary","sizeSmall","sizeMedium","checked","disabled","input","thumb","track"]),Vs=T0e,C0e=["className","color","edge","size","sx"],P0e=n=>{const{classes:e,edge:i,size:o,color:s,checked:l,disabled:d}=n,p={root:["root",i&&`edge${ai(i)}`,`size${ai(o)}`],switchBase:["switchBase",`color${ai(s)}`,l&&"checked",d&&"disabled"],thumb:["thumb"],track:["track"],input:["input"]},f=ha(p,M0e,e);return qe({},e,f)},I0e=Bn("span",{name:"MuiSwitch",slot:"Root",overridesResolver:(n,e)=>{const{ownerState:i}=n;return[e.root,i.edge&&e[`edge${ai(i.edge)}`],e[`size${ai(i.size)}`]]}})(({ownerState:n})=>qe({display:"inline-flex",width:34+12*2,height:14+12*2,overflow:"hidden",padding:12,boxSizing:"border-box",position:"relative",flexShrink:0,zIndex:0,verticalAlign:"middle","@media print":{colorAdjust:"exact"}},n.edge==="start"&&{marginLeft:-8},n.edge==="end"&&{marginRight:-8},n.size==="small"&&{width:40,height:24,padding:7,[`& .${Vs.thumb}`]:{width:16,height:16},[`& .${Vs.switchBase}`]:{padding:4,[`&.${Vs.checked}`]:{transform:"translateX(16px)"}}})),L0e=Bn(Iq,{name:"MuiSwitch",slot:"SwitchBase",overridesResolver:(n,e)=>{const{ownerState:i}=n;return[e.switchBase,{[`& .${Vs.input}`]:e.input},i.color!=="default"&&e[`color${ai(i.color)}`]]}})(({theme:n})=>({position:"absolute",top:0,left:0,zIndex:1,color:n.vars?n.vars.palette.Switch.defaultColor:`${n.palette.mode==="light"?n.palette.common.white:n.palette.grey[300]}`,transition:n.transitions.create(["left","transform"],{duration:n.transitions.duration.shortest}),[`&.${Vs.checked}`]:{transform:"translateX(20px)"},[`&.${Vs.disabled}`]:{color:n.vars?n.vars.palette.Switch.defaultDisabledColor:`${n.palette.mode==="light"?n.palette.grey[100]:n.palette.grey[600]}`},[`&.${Vs.checked} + .${Vs.track}`]:{opacity:.5},[`&.${Vs.disabled} + .${Vs.track}`]:{opacity:n.vars?n.vars.opacity.switchTrackDisabled:`${n.palette.mode==="light"?.12:.2}`},[`& .${Vs.input}`]:{left:"-100%",width:"300%"}}),({theme:n,ownerState:e})=>qe({"&:hover":{backgroundColor:n.vars?`rgba(${n.vars.palette.action.activeChannel} / ${n.vars.palette.action.hoverOpacity})`:kr(n.palette.action.active,n.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},e.color!=="default"&&{[`&.${Vs.checked}`]:{color:(n.vars||n).palette[e.color].main,"&:hover":{backgroundColor:n.vars?`rgba(${n.vars.palette[e.color].mainChannel} / ${n.vars.palette.action.hoverOpacity})`:kr(n.palette[e.color].main,n.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${Vs.disabled}`]:{color:n.vars?n.vars.palette.Switch[`${e.color}DisabledColor`]:`${n.palette.mode==="light"?LD(n.palette[e.color].main,.62):ID(n.palette[e.color].main,.55)}`}},[`&.${Vs.checked} + .${Vs.track}`]:{backgroundColor:(n.vars||n).palette[e.color].main}})),R0e=Bn("span",{name:"MuiSwitch",slot:"Track",overridesResolver:(n,e)=>e.track})(({theme:n})=>({height:"100%",width:"100%",borderRadius:14/2,zIndex:-1,transition:n.transitions.create(["opacity","background-color"],{duration:n.transitions.duration.shortest}),backgroundColor:n.vars?n.vars.palette.common.onBackground:`${n.palette.mode==="light"?n.palette.common.black:n.palette.common.white}`,opacity:n.vars?n.vars.opacity.switchTrack:`${n.palette.mode==="light"?.38:.3}`})),k0e=Bn("span",{name:"MuiSwitch",slot:"Thumb",overridesResolver:(n,e)=>e.thumb})(({theme:n})=>({boxShadow:(n.vars||n).shadows[1],backgroundColor:"currentColor",width:20,height:20,borderRadius:"50%"})),D0e=ie.forwardRef(function(e,i){const o=_a({props:e,name:"MuiSwitch"}),{className:s,color:l="primary",edge:d=!1,size:p="medium",sx:f}=o,y=qn(o,C0e),_=qe({},o,{color:l,edge:d,size:p}),x=P0e(_),S=X(k0e,{className:x.thumb,ownerState:_});return $e(I0e,{className:_i(x.root,s),sx:f,ownerState:_,children:[X(L0e,qe({type:"checkbox",icon:S,checkedIcon:S,ref:i,ownerState:_},y,{classes:qe({},x,{root:x.switchBase})})),X(R0e,{className:x.track,ownerState:_})]})}),O0e=D0e,N0e=ie.createContext(),Uq=N0e;function z0e(n){return aa("MuiTable",n)}Zi("MuiTable",["root","stickyHeader"]);const F0e=["className","component","padding","size","stickyHeader"],B0e=n=>{const{classes:e,stickyHeader:i}=n;return ha({root:["root",i&&"stickyHeader"]},z0e,e)},U0e=Bn("table",{name:"MuiTable",slot:"Root",overridesResolver:(n,e)=>{const{ownerState:i}=n;return[e.root,i.stickyHeader&&e.stickyHeader]}})(({theme:n,ownerState:e})=>qe({display:"table",width:"100%",borderCollapse:"collapse",borderSpacing:0,"& caption":qe({},n.typography.body2,{padding:n.spacing(2),color:(n.vars||n).palette.text.secondary,textAlign:"left",captionSide:"bottom"})},e.stickyHeader&&{borderCollapse:"separate"})),aW="table",W0e=ie.forwardRef(function(e,i){const o=_a({props:e,name:"MuiTable"}),{className:s,component:l=aW,padding:d="normal",size:p="medium",stickyHeader:f=!1}=o,y=qn(o,F0e),_=qe({},o,{component:l,padding:d,size:p,stickyHeader:f}),x=B0e(_),S=ie.useMemo(()=>({padding:d,size:p,stickyHeader:f}),[d,p,f]);return X(Uq.Provider,{value:S,children:X(U0e,qe({as:l,role:l===aW?null:"table",ref:i,className:_i(x.root,s),ownerState:_},y))})}),V0e=W0e,G0e=ie.createContext(),RT=G0e;function H0e(n){return aa("MuiTableBody",n)}Zi("MuiTableBody",["root"]);const j0e=["className","component"],$0e=n=>{const{classes:e}=n;return ha({root:["root"]},H0e,e)},Y0e=Bn("tbody",{name:"MuiTableBody",slot:"Root",overridesResolver:(n,e)=>e.root})({display:"table-row-group"}),q0e={variant:"body"},rW="tbody",X0e=ie.forwardRef(function(e,i){const o=_a({props:e,name:"MuiTableBody"}),{className:s,component:l=rW}=o,d=qn(o,j0e),p=qe({},o,{component:l}),f=$0e(p);return X(RT.Provider,{value:q0e,children:X(Y0e,qe({className:_i(f.root,s),as:l,ref:i,role:l===rW?null:"rowgroup",ownerState:p},d))})}),Z0e=X0e;function K0e(n){return aa("MuiTableCell",n)}const J0e=Zi("MuiTableCell",["root","head","body","footer","sizeSmall","sizeMedium","paddingCheckbox","paddingNone","alignLeft","alignCenter","alignRight","alignJustify","stickyHeader"]),Q0e=J0e,e_e=["align","className","component","padding","scope","size","sortDirection","variant"],t_e=n=>{const{classes:e,variant:i,align:o,padding:s,size:l,stickyHeader:d}=n,p={root:["root",i,d&&"stickyHeader",o!=="inherit"&&`align${ai(o)}`,s!=="normal"&&`padding${ai(s)}`,`size${ai(l)}`]};return ha(p,K0e,e)},n_e=Bn("td",{name:"MuiTableCell",slot:"Root",overridesResolver:(n,e)=>{const{ownerState:i}=n;return[e.root,e[i.variant],e[`size${ai(i.size)}`],i.padding!=="normal"&&e[`padding${ai(i.padding)}`],i.align!=="inherit"&&e[`align${ai(i.align)}`],i.stickyHeader&&e.stickyHeader]}})(({theme:n,ownerState:e})=>qe({},n.typography.body2,{display:"table-cell",verticalAlign:"inherit",borderBottom:n.vars?`1px solid ${n.vars.palette.TableCell.border}`:`1px solid
    ${n.palette.mode==="light"?LD(kr(n.palette.divider,1),.88):ID(kr(n.palette.divider,1),.68)}`,textAlign:"left",padding:16},e.variant==="head"&&{color:(n.vars||n).palette.text.primary,lineHeight:n.typography.pxToRem(24),fontWeight:n.typography.fontWeightMedium},e.variant==="body"&&{color:(n.vars||n).palette.text.primary},e.variant==="footer"&&{color:(n.vars||n).palette.text.secondary,lineHeight:n.typography.pxToRem(21),fontSize:n.typography.pxToRem(12)},e.size==="small"&&{padding:"6px 16px",[`&.${Q0e.paddingCheckbox}`]:{width:24,padding:"0 12px 0 16px","& > *":{padding:0}}},e.padding==="checkbox"&&{width:48,padding:"0 0 0 4px"},e.padding==="none"&&{padding:0},e.align==="left"&&{textAlign:"left"},e.align==="center"&&{textAlign:"center"},e.align==="right"&&{textAlign:"right",flexDirection:"row-reverse"},e.align==="justify"&&{textAlign:"justify"},e.stickyHeader&&{position:"sticky",top:0,zIndex:2,backgroundColor:(n.vars||n).palette.background.default})),i_e=ie.forwardRef(function(e,i){const o=_a({props:e,name:"MuiTableCell"}),{align:s="inherit",className:l,component:d,padding:p,scope:f,size:y,sortDirection:_,variant:x}=o,S=qn(o,e_e),T=ie.useContext(Uq),I=ie.useContext(RT),R=I&&I.variant==="head";let D;d?D=d:D=R?"th":"td";let L=f;D==="td"?L=void 0:!L&&R&&(L="col");const O=x||I&&I.variant,N=qe({},o,{align:s,component:D,padding:p||(T&&T.padding?T.padding:"normal"),size:y||(T&&T.size?T.size:"medium"),sortDirection:_,stickyHeader:O==="head"&&T&&T.stickyHeader,variant:O}),F=t_e(N);let G=null;return _&&(G=_==="asc"?"ascending":"descending"),X(n_e,qe({as:D,ref:i,className:_i(F.root,l),"aria-sort":G,scope:L,ownerState:N},S))}),ps=i_e;function a_e(n){return aa("MuiTableContainer",n)}Zi("MuiTableContainer",["root"]);const r_e=["className","component"],o_e=n=>{const{classes:e}=n;return ha({root:["root"]},a_e,e)},s_e=Bn("div",{name:"MuiTableContainer",slot:"Root",overridesResolver:(n,e)=>e.root})({width:"100%",overflowX:"auto"}),l_e=ie.forwardRef(function(e,i){const o=_a({props:e,name:"MuiTableContainer"}),{className:s,component:l="div"}=o,d=qn(o,r_e),p=qe({},o,{component:l}),f=o_e(p);return X(s_e,qe({ref:i,as:l,className:_i(f.root,s),ownerState:p},d))}),c_e=l_e;function u_e(n){return aa("MuiTableHead",n)}Zi("MuiTableHead",["root"]);const d_e=["className","component"],h_e=n=>{const{classes:e}=n;return ha({root:["root"]},u_e,e)},p_e=Bn("thead",{name:"MuiTableHead",slot:"Root",overridesResolver:(n,e)=>e.root})({display:"table-header-group"}),f_e={variant:"head"},oW="thead",m_e=ie.forwardRef(function(e,i){const o=_a({props:e,name:"MuiTableHead"}),{className:s,component:l=oW}=o,d=qn(o,d_e),p=qe({},o,{component:l}),f=h_e(p);return X(RT.Provider,{value:f_e,children:X(p_e,qe({as:l,className:_i(f.root,s),ref:i,role:l===oW?null:"rowgroup",ownerState:p},d))})}),g_e=m_e;function y_e(n){return aa("MuiTableRow",n)}const v_e=Zi("MuiTableRow",["root","selected","hover","head","footer"]),sW=v_e,__e=["className","component","hover","selected"],b_e=n=>{const{classes:e,selected:i,hover:o,head:s,footer:l}=n;return ha({root:["root",i&&"selected",o&&"hover",s&&"head",l&&"footer"]},y_e,e)},x_e=Bn("tr",{name:"MuiTableRow",slot:"Root",overridesResolver:(n,e)=>{const{ownerState:i}=n;return[e.root,i.head&&e.head,i.footer&&e.footer]}})(({theme:n})=>({color:"inherit",display:"table-row",verticalAlign:"middle",outline:0,[`&.${sW.hover}:hover`]:{backgroundColor:(n.vars||n).palette.action.hover},[`&.${sW.selected}`]:{backgroundColor:n.vars?`rgba(${n.vars.palette.primary.mainChannel} / ${n.vars.palette.action.selectedOpacity})`:kr(n.palette.primary.main,n.palette.action.selectedOpacity),"&:hover":{backgroundColor:n.vars?`rgba(${n.vars.palette.primary.mainChannel} / calc(${n.vars.palette.action.selectedOpacity} + ${n.vars.palette.action.hoverOpacity}))`:kr(n.palette.primary.main,n.palette.action.selectedOpacity+n.palette.action.hoverOpacity)}}})),lW="tr",w_e=ie.forwardRef(function(e,i){const o=_a({props:e,name:"MuiTableRow"}),{className:s,component:l=lW,hover:d=!1,selected:p=!1}=o,f=qn(o,__e),y=ie.useContext(RT),_=qe({},o,{component:l,hover:d,selected:p,head:y&&y.variant==="head",footer:y&&y.variant==="footer"}),x=b_e(_);return X(x_e,qe({as:l,ref:i,className:_i(x.root,s),role:l===lW?null:"row",ownerState:_},f))}),cW=w_e;function S_e(n){return aa("MuiToggleButton",n)}const A_e=Zi("MuiToggleButton",["root","disabled","selected","standard","primary","secondary","sizeSmall","sizeMedium","sizeLarge","fullWidth"]),uW=A_e,E_e=["children","className","color","disabled","disableFocusRipple","fullWidth","onChange","onClick","selected","size","value"],M_e=n=>{const{classes:e,fullWidth:i,selected:o,disabled:s,size:l,color:d}=n,p={root:["root",o&&"selected",s&&"disabled",i&&"fullWidth",`size${ai(l)}`,d]};return ha(p,S_e,e)},T_e=Bn(MT,{name:"MuiToggleButton",slot:"Root",overridesResolver:(n,e)=>{const{ownerState:i}=n;return[e.root,e[`size${ai(i.size)}`]]}})(({theme:n,ownerState:e})=>{let i=e.color==="standard"?n.palette.text.primary:n.palette[e.color].main,o;return n.vars&&(i=e.color==="standard"?n.vars.palette.text.primary:n.vars.palette[e.color].main,o=e.color==="standard"?n.vars.palette.text.primaryChannel:n.vars.palette[e.color].mainChannel),qe({},n.typography.button,{borderRadius:(n.vars||n).shape.borderRadius,padding:11,border:`1px solid ${(n.vars||n).palette.divider}`,color:(n.vars||n).palette.action.active},e.fullWidth&&{width:"100%"},{[`&.${uW.disabled}`]:{color:(n.vars||n).palette.action.disabled,border:`1px solid ${(n.vars||n).palette.action.disabledBackground}`},"&:hover":{textDecoration:"none",backgroundColor:n.vars?`rgba(${n.vars.palette.text.primaryChannel} / ${n.vars.palette.action.hoverOpacity})`:kr(n.palette.text.primary,n.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${uW.selected}`]:{color:i,backgroundColor:n.vars?`rgba(${o} / ${n.vars.palette.action.selectedOpacity})`:kr(i,n.palette.action.selectedOpacity),"&:hover":{backgroundColor:n.vars?`rgba(${o} / calc(${n.vars.palette.action.selectedOpacity} + ${n.vars.palette.action.hoverOpacity}))`:kr(i,n.palette.action.selectedOpacity+n.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:n.vars?`rgba(${o} / ${n.vars.palette.action.selectedOpacity})`:kr(i,n.palette.action.selectedOpacity)}}}},e.size==="small"&&{padding:7,fontSize:n.typography.pxToRem(13)},e.size==="large"&&{padding:15,fontSize:n.typography.pxToRem(15)})}),C_e=ie.forwardRef(function(e,i){const o=_a({props:e,name:"MuiToggleButton"}),{children:s,className:l,color:d="standard",disabled:p=!1,disableFocusRipple:f=!1,fullWidth:y=!1,onChange:_,onClick:x,selected:S,size:T="medium",value:I}=o,R=qn(o,E_e),D=qe({},o,{color:d,disabled:p,disableFocusRipple:f,fullWidth:y,size:T}),L=M_e(D),O=N=>{x&&(x(N,I),N.defaultPrevented)||_&&_(N,I)};return X(T_e,qe({className:_i(L.root,l),disabled:p,focusRipple:!f,ref:i,onClick:O,onChange:_,value:I,ownerState:D,"aria-pressed":S},R,{children:s}))}),P_e=C_e;function I_e(n,e){return e===void 0||n===void 0?!1:Array.isArray(e)?e.indexOf(n)>=0:n===e}function L_e(n){return aa("MuiToggleButtonGroup",n)}const R_e=Zi("MuiToggleButtonGroup",["root","selected","vertical","disabled","grouped","groupedHorizontal","groupedVertical","fullWidth"]),dh=R_e,k_e=["children","className","color","disabled","exclusive","fullWidth","onChange","orientation","size","value"],D_e=n=>{const{classes:e,orientation:i,fullWidth:o,disabled:s}=n,l={root:["root",i==="vertical"&&"vertical",o&&"fullWidth"],grouped:["grouped",`grouped${ai(i)}`,s&&"disabled"]};return ha(l,L_e,e)},O_e=Bn("div",{name:"MuiToggleButtonGroup",slot:"Root",overridesResolver:(n,e)=>{const{ownerState:i}=n;return[{[`& .${dh.grouped}`]:e.grouped},{[`& .${dh.grouped}`]:e[`grouped${ai(i.orientation)}`]},e.root,i.orientation==="vertical"&&e.vertical,i.fullWidth&&e.fullWidth]}})(({ownerState:n,theme:e})=>qe({display:"inline-flex",borderRadius:(e.vars||e).shape.borderRadius},n.orientation==="vertical"&&{flexDirection:"column"},n.fullWidth&&{width:"100%"},{[`& .${dh.grouped}`]:qe({},n.orientation==="horizontal"?{"&:not(:first-of-type)":{marginLeft:-1,borderLeft:"1px solid transparent",borderTopLeftRadius:0,borderBottomLeftRadius:0},"&:not(:last-of-type)":{borderTopRightRadius:0,borderBottomRightRadius:0},[`&.${dh.selected} + .${dh.grouped}.${dh.selected}`]:{borderLeft:0,marginLeft:0}}:{"&:not(:first-of-type)":{marginTop:-1,borderTop:"1px solid transparent",borderTopLeftRadius:0,borderTopRightRadius:0},"&:not(:last-of-type)":{borderBottomLeftRadius:0,borderBottomRightRadius:0},[`&.${dh.selected} + .${dh.grouped}.${dh.selected}`]:{borderTop:0,marginTop:0}})})),N_e=ie.forwardRef(function(e,i){const o=_a({props:e,name:"MuiToggleButtonGroup"}),{children:s,className:l,color:d="standard",disabled:p=!1,exclusive:f=!1,fullWidth:y=!1,onChange:_,orientation:x="horizontal",size:S="medium",value:T}=o,I=qn(o,k_e),R=qe({},o,{disabled:p,fullWidth:y,orientation:x,size:S}),D=D_e(R),L=(N,F)=>{if(!_)return;const G=T&&T.indexOf(F);let j;T&&G>=0?(j=T.slice(),j.splice(G,1)):j=T?T.concat(F):[F],_(N,j)},O=(N,F)=>{_&&_(N,T===F?null:F)};return X(O_e,qe({role:"group",className:_i(D.root,l),ref:i,ownerState:R},I,{children:ie.Children.map(s,N=>ie.isValidElement(N)?ie.cloneElement(N,{className:_i(D.grouped,N.props.className),onChange:f?O:L,selected:N.props.selected===void 0?I_e(N.props.value,T):N.props.selected,size:N.props.size||S,fullWidth:y,color:N.props.color||d,disabled:N.props.disabled||p}):null)}))}),z_e=N_e,F_e=pq({palette:{primary:{main:"#007378"},secondary:{main:"#959595"}},components:{MuiSwitch:{styleOverrides:{root:{"& .MuiSwitch-switchBase":{"&.Mui-checked":{color:"#fff","& + .MuiSwitch-track":{opacity:1,backgroundColor:"#2D67FF",borderColor:"#007378"}}}}}},MuiDialog:{styleOverrides:{paper:{maxWidth:"none",borderRadius:40,marginTop:96}}},MuiDialogContent:{styleOverrides:{root:{padding:0}}},MuiCheckbox:{styleOverrides:{root:{color:"#D9D9D9","&.Mui-checked":{color:"#2D67FF"}}}},MuiTable:{styleOverrides:{root:{"& .MuiTableCell-root":{fontFamily:"SuisseIntl-Light",fontWeight:600,fontSize:"2vh"},"& .MuiTableCell-head":{fontFamily:"SuisseIntl-Light",fontWeight:600,fontSize:"2vh",color:"rgba(0, 0, 0, 0.6)"}}}},MuiTableContainer:{styleOverrides:{root:{borderRadius:0,boxShadow:"none"}}}}}),Wq=Object.fromEntries?Object.fromEntries:n=>{if(!n||!n[Symbol.iterator])throw new Error("Object.fromEntries() requires a single iterable argument");const e={};return Object.keys(n).forEach(i=>{const[o,s]=n[i];e[o]=s}),e};function l_(n){return Object.keys(n)}function YD(n,e){if(!n)throw new Error(e)}function qD(n,e){return e}const XD=n=>{const e=n.length;let i=0,o="";for(;i<e;i++){const s=n[i];if(s==null)continue;let l;switch(typeof s){case"boolean":break;case"object":{if(Array.isArray(s))l=XD(s);else{YD(!qD(s,!1)),l="";for(const d in s)s[d]&&d&&(l&&(l+=" "),l+=d)}break}default:l=s}l&&(o&&(o+=" "),o+=l)}return o};function B_e(n,e){const i=ie.useRef();return(!i.current||e.length!==i.current.prevDeps.length||i.current.prevDeps.map((o,s)=>o===e[s]).indexOf(!1)>=0)&&(i.current={v:n(),prevDeps:[...e]}),i.current.v}function U_e(n){return n instanceof Object&&!("styles"in n)&&!("length"in n)&&!("__emotion_styles"in n)}const{createCssAndCx:W_e}=(()=>{function n(i,o,s){const l=[],d=QY(i,l,s);return l.length<2?s:d+o(l)}function e(i){const{cache:o}=i,s=(...d)=>{const p=pT(d,o.registered);yD(o,p,!1);const f=`${o.key}-${p.name}`;e:{const y=d[0];if(!U_e(y))break e;dW.saveClassNameCSSObjectMapping(o,f,y)}return f};return{css:s,cx:(...d)=>{const p=XD(d),f=dW.fixClassName(o,p,s);return n(o.registered,s,f)}}}return{createCssAndCx:e}})();function Vq(n){const{useCache:e}=n;function i(){const o=e(),{css:s,cx:l}=B_e(()=>W_e({cache:o}),[o]);return{css:s,cx:l}}return{useCssAndCx:i}}const dW=(()=>{const n=new WeakMap;return{saveClassNameCSSObjectMapping:(e,i,o)=>{let s=n.get(e);s===void 0&&(s=new Map,n.set(e,s)),s.set(i,o)},fixClassName:(()=>{function e(i){let o=!1;return i.map(([s,l])=>{if(l===void 0)return s;let d;if(o)d={"&&":l};else{d=s;for(const p in l)if(p.startsWith("@media")){o=!0;break}}return d})}return(i,o,s)=>{const l=n.get(i);return XD(e(o.split(" ").map(d=>[d,l==null?void 0:l.get(d)])).map(d=>typeof d=="string"?d:s(d)))}})()}})();function c_(n){if(!(n instanceof Object)||typeof n=="function")return n;const e=[];for(const i in n){const o=n[i],s=typeof o;if(!(s==="string"||s==="number"&&!isNaN(o)||s==="boolean"||o===void 0||o===null))return n;e.push(`${i}:${s}_${o}`)}return"xSqLiJdLMd9s"+e.join("|")}function ZD(n,e,i){if(!(e instanceof Object))return n;const o={};return l_(n).forEach(s=>o[s]=i(n[s],e[s])),l_(e).forEach(s=>{if(s in n)return;const l=e[s];typeof l=="string"&&(o[s]=l)}),o}const Gq=({classes:n,theme:e,muiStyleOverridesParams:i,css:o,cx:s,name:l})=>{var d,p;e:{if(l==="makeStyle no name"){l=void 0;break e}if(i!==void 0&&l===void 0)throw new Error("To use muiStyleOverridesParams, you must specify a name using .withName('MyComponent')")}let f;try{f=l===void 0?void 0:((p=(d=e.components)===null||d===void 0?void 0:d[l])===null||p===void 0?void 0:p.styleOverrides)||void 0}catch{}const y=ie.useMemo(()=>{if(f===void 0)return;const _={};for(const x in f){const S=f[x];S instanceof Object&&(_[x]=o(typeof S=="function"?S(Object.assign({theme:e,ownerState:i==null?void 0:i.ownerState},i==null?void 0:i.props)):S))}return _},[f,c_(i==null?void 0:i.props),c_(i==null?void 0:i.ownerState),o]);return n=ie.useMemo(()=>ZD(n,y,s),[n,y,s]),{classes:n}};let V_e=0;function Hq(n){const{useTheme:e,cache:i}=n,{useCache:o}=jq({cacheProvidedAtInception:i}),{useCssAndCx:s}=Vq({useCache:o});function l(p){const{name:f,uniqId:y=`${V_e++}`}=p??{},_=typeof f!="object"?f:Object.keys(f)[0];return function(x){const S=typeof x=="function"?x:()=>x;return function(I,R){const D=e();let{css:L,cx:O}=s();const N=o();let F=ie.useMemo(()=>{const G={},j=typeof Proxy<"u"&&new Proxy({},{get:(V,Q)=>(typeof Q=="symbol"&&YD(!1),G[Q]=`${N.key}-${y}${_!==void 0?`-${_}`:""}-${Q}-ref`)}),Y=S(D,I,j||{}),te=Wq(l_(Y).map(V=>{const Q=Y[V];return Q.label||(Q.label=`${_!==void 0?`${_}-`:""}${V}`),[V,`${L(Q)}${qD(V,V in G)?` ${G[V]}`:""}`]}));return l_(G).forEach(V=>{V in te||(te[V]=G[V])}),te},[N,L,O,D,c_(I)]);{const G=R==null?void 0:R.props.classes;F=ie.useMemo(()=>ZD(F,G,O),[F,c_(G),O])}{const G=Gq({classes:F,css:L,cx:O,name:_??"makeStyle no name",idOfUseStyles:y,muiStyleOverridesParams:R,theme:D});G.classes!==void 0&&(F=G.classes),G.css!==void 0&&(L=G.css),G.cx!==void 0&&(O=G.cx)}return{classes:F,theme:D,css:L,cx:O}}}}function d(){const p=e(),{css:f,cx:y}=s();return{theme:p,css:f,cx:y}}return{makeStyles:l,useStyles:d}}const G_e=ie.createContext(void 0),{createUseCache:jq}=(()=>{function n(){return ie.useContext(G_e)}function e(i){const{cacheProvidedAtInception:o}=i;function s(){var l;const d=sde(),p=n(),f=(l=o??p)!==null&&l!==void 0?l:d;if(f===null)throw new Error(["In order to get SSR working with tss-react you need to explicitly provide an Emotion cache.","MUI users be aware: This is not an error strictly related to tss-react, with or without tss-react,","MUI needs an Emotion cache to be provided for SSR to work.","Here is the MUI documentation related to SSR setup: https://mui.com/material-ui/guides/server-rendering/","TSS provides helper that makes the process of setting up SSR easier: https://docs.tss-react.dev/ssr"].join(`
`));return f}return{useCache:s}}return{createUseCache:e}})();function hW(n){return n.charAt(0).toUpperCase()+n.slice(1)}var pW=globalThis&&globalThis.__rest||function(n,e){var i={};for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&e.indexOf(o)<0&&(i[o]=n[o]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,o=Object.getOwnPropertySymbols(n);s<o.length;s++)e.indexOf(o[s])<0&&Object.prototype.propertyIsEnumerable.call(n,o[s])&&(i[o[s]]=n[o[s]]);return i};function H_e(n){const{useTheme:e,cache:i}=n,{makeStyles:o}=Hq({useTheme:e,cache:i});function s(l,d,p){const f=typeof l=="string"?(()=>{const T=l,I=function(R){var{children:D}=R,L=pW(R,["children"]);return ie.createElement(T,L,D)};return Object.defineProperty(I,"name",{value:hW(T)}),I})():l,y=(()=>{{const{name:T}=p??{};if(T!==void 0)return typeof T!="object"?T:Object.keys(T)[0]}{const T=f.displayName;if(typeof T=="string"&&T!=="")return T}{const{name:T}=f;if(T)return T.replace(/\$/g,"usd")}})(),_=o(Object.assign(Object.assign({},p),{name:y}))(typeof d=="function"?(T,I,R)=>mW(d(T,I,R)):mW(d));function x(T){for(const I in T)if(I!=="root")return!0;return!1}const S=ie.forwardRef(function(T,I){const{className:R,classes:D}=T,L=pW(T,["className","classes"]),{classes:O,cx:N}=_(T,{props:T}),F=N(O.root,R);return $q.set(O,Object.assign(Object.assign({},O),{root:F})),X(f,{...Object.assign({ref:I,className:x(O)?R:F},typeof l=="string"?{}:{classes:O},L)})});return y!==void 0&&(S.displayName=`${hW(y)}WithStyles`,Object.defineProperty(S,"name",{value:S.displayName})),S}return s.getClasses=j_e,{withStyles:s}}const $q=new WeakMap,fW="getClasses should only be used in conjunction with withStyles";function j_e(n){const e=n.classes;if(e===void 0)throw new Error(fW);const i=$q.get(e);if(i===void 0)throw new Error(fW);return i}function mW(n){const e={},i={};return Object.keys(n).forEach(o=>(o.startsWith("@media")?i:e)[o]=n[o]),Object.keys(i).forEach(o=>{const s=i[o];Object.keys(s).forEach(l=>{var d;return e[l]=Object.assign(Object.assign({},(d=e[l])!==null&&d!==void 0?d:{}),{[o]:s[l]})})}),e}const $_e=(()=>!(typeof document=="object"&&typeof(document==null?void 0:document.getElementById)=="function")&&!(typeof jest<"u")&&!(typeof mocha<"u")&&!(typeof __vitest_worker__<"u"))();var Y_e=globalThis&&globalThis.__rest||function(n,e){var i={};for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&e.indexOf(o)<0&&(i[o]=n[o]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,o=Object.getOwnPropertySymbols(n);s<o.length;s++)e.indexOf(o[s])<0&&Object.prototype.propertyIsEnumerable.call(n,o[s])&&(i[o[s]]=n[o[s]]);return i};function Yq(n){const{useContext:e,usePlugin:i,cache:o}=n,{useCache:s}=jq({cacheProvidedAtInception:o}),{useCssAndCx:l}=Vq({useCache:s});return{tss:rE({useContext:e,useCache:s,useCssAndCx:l,usePlugin:i??(({classes:f,cx:y,css:_})=>({classes:f,cx:y,css:_})),name:void 0,doesUseNestedSelectors:!1})}}let q_e=0;const S4=[];function rE(n){const{useContext:e,useCache:i,useCssAndCx:o,usePlugin:s,name:l,doesUseNestedSelectors:d}=n;return{withParams:()=>rE(Object.assign({},n)),withName:p=>rE(Object.assign(Object.assign({},n),{name:typeof p!="object"?p:Object.keys(p)[0]})),withNestedSelectors:()=>rE(Object.assign(Object.assign({},n),{doesUseNestedSelectors:!0})),create:p=>{const f=`x${q_e++}`,y=typeof p=="function"?p:()=>p;return function(x){var S,T,I;const R=x??{},{classesOverrides:D}=R,L=Y_e(R,["classesOverrides"]),O=e(),{css:N,cx:F}=o(),G=i();let j=ie.useMemo(()=>{const te={},V=y(Object.assign(Object.assign(Object.assign({},x),O),d?{classes:typeof Proxy>"u"?{}:new Proxy({},{get:(he,fe)=>{if(typeof fe=="symbol"&&YD(!1),$_e){{let ye=S4.find(pe=>pe.name===l&&pe.idOfUseStyles===f);ye===void 0&&(ye={name:l,idOfUseStyles:f,nestedSelectorRuleNames:new Set},S4.push(ye)),ye.nestedSelectorRuleNames.add(fe)}if(S4.find(ye=>ye.name===l&&ye.idOfUseStyles!==f&&ye.nestedSelectorRuleNames.has(fe))!==void 0)throw new Error([`tss-react: Duplicate nested selector "${fe}" detected in ${l===void 0?`useStyles named "${l}"`:"anonymous useStyles function"}.`,"In SSR setups, this may lead to CSS class name collisions, causing nested selectors to target elements outside of the intended scope.",'Solution: Ensure each useStyles using nested selectors has a unique name. Use tss.withName("UniqueName").withNestedSelectors<...>()... to set a name.'].join(`
`))}return te[fe]=`${G.key}-${f}${l!==void 0?`-${l}`:""}-${fe}-ref`}})}:{})),Q=Wq(l_(V).map(he=>{const fe=V[he];return fe.label||(fe.label=`${l!==void 0?`${l}-`:""}${he}`),[he,`${N(fe)}${qD(he,he in te)?` ${te[he]}`:""}`]}));return l_(te).forEach(he=>{he in Q||(Q[he]=te[he])}),Q},[G,N,F,c_(x),...Object.values(O)]);j=ie.useMemo(()=>ZD(j,D,F),[j,c_(D),F]);const Y=s(Object.assign(Object.assign({classes:j,css:N,cx:F,idOfUseStyles:f,name:l},O),L));return Object.assign({classes:(S=Y.classes)!==null&&S!==void 0?S:j,css:(T=Y.css)!==null&&T!==void 0?T:N,cx:(I=Y.cx)!==null&&I!==void 0?I:F},O)}}}}function X_e(n){return Object.assign(Object.assign({},Hq(n)),H_e(n))}const{tss:Z_e}=Yq({useContext:()=>({})});Z_e.create({});const{makeStyles:pr,withStyles:tRe}=X_e({useTheme:Zg}),{tss:K_e}=Yq({useContext:function(){return{theme:Zg()}},usePlugin:Gq});K_e.create({});const KD=pr()({root:{padding:0,margin:0,backgroundColor:"#1433AE",color:"#fff",height:"100vh"},contentWrapper:{maxWidth:"100%",margin:"0 auto",padding:"0 5%"},gradient:{position:"absolute",top:"0",left:"0",width:"100%",height:"100%",zIndex:1,backgroundImage:"radial-gradient(53.6% 37.94% at 49.21% 62.06%, rgba(33, 63, 178, 0) 0%, #1424A2 100%)"},graph3dWrapper:{backgroundColor:"transparent",zIndex:1,position:"absolute",top:"-30%",left:"8%",width:"100%",height:"130%"}}),kT=pr()({root:{position:"absolute",marginTop:"1.5vh",zIndex:1},titleWrapper:{display:"flex",flexDirection:"row",gap:"5vh",alignItems:"center",justifyContent:"flex-start"},cityNameAndCountryNameWrapper:{display:"flex",flexDirection:"column"},cityName:{fontFamily:"SuisseIntl-Light",fontWeight:400,fontSize:"10.8vh",marginLeft:"-1vh"},cityDescription:{fontFamily:"SuisseIntl-Light",fontWeight:400,fontSize:"1.6vh",opacity:"0.5"},countryName:{fontFamily:"SuisseIntl-Light",fontWeight:400,fontSize:"2vh",marginTop:"-0.95vh"},statWrapper:{display:"flex",flexDirection:"row",gap:"3.5vh",alignItems:"center",justifyContent:"flex-start",marginTop:"2vh"},statItem:{display:"flex",flexDirection:"column",gap:"1vh",justifyContent:"flex-end"},statTitle:{fontFamily:"SuisseIntl-Light",fontWeight:100,fontSize:"1.40vh",opacity:"0.5"},statValue:{fontFamily:"SuisseIntl-Light",fontWeight:200,fontSize:"1.95vh",marginTop:"-0.40vh"},statStatus:{fontFamily:"SuisseIntl-Light",fontWeight:300,width:"fit-content",fontSize:"1.4vh",color:"#2D67FF",border:"1px solid #2D67FF",borderRadius:"50px",padding:"0.6rem .9rem",marginTop:"0vh"},statsContainer:{width:"63.5vh",marginTop:"5.5vh",marginLeft:"-2vh",padding:0,paddingLeft:"2vh",borderLeft:"1px solid #fff"},statStatusBig:{fontFamily:"SuisseIntl-Light",fontWeight:300,width:"fit-content",fontSize:"2vh",borderRadius:"50px",marginTop:"0vh"},statItemBigWrapper:{display:"flex",flexDirection:"column",gap:"1vh",justifyContent:"flex-end"},smallRowWrapper:{position:"relative",width:"auto",display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center"},lowOpacityLabel:{fontFamily:"SuisseIntl-Light",fontWeight:100,fontSize:"1.40vh",opacity:"0.5"},statsBigText:{fontFamily:"SuisseIntl-Light",fontWeight:200,fontSize:"2.5vh",width:"22vh"},statsSmallText:{fontFamily:"SuisseIntl-Light",fontWeight:100,fontSize:"1.5vh"},smallItemsListWrapper:{marginTop:"4vh",display:"flex",flexDirection:"column",gap:"1.1vh"},bottomWrapper:{zIndex:1,display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"flex-end",marginBottom:"29vh",pointerEvents:"none",height:"5vh",marginLeft:"0vh"},smallTextWrapper:{pointerEvents:"all",display:"flex",flexDirection:"row",gap:"10px"},smallText:{fontFamily:"SuisseIntl-Light",fontSize:"1.8vh",color:"#fff",opacity:"0.6",cursor:"pointer"}}),DT=pr()({root:{zIndex:2,position:"relative",display:"flex",borderBottom:"1px solid #fff",height:"10.3vh",justifyContent:"space-between",alignItems:"center"},menuIconWrapper:{cursor:"pointer",display:"flex",justifyContent:"space-between",alignItems:"center",gap:"8px"},buttonsWrapper:{display:"flex",gap:"8px",justifyContent:"space-between",alignItems:"center"},whiteText:{fontFamily:"SuisseIntl-Light",fontWeight:400,color:"#fff",textTransform:"none",fontSize:"1.8vh","&:hover":{backgroundColor:"inherit"}},signUpButton:{fontFamily:"SuisseIntl-Light",fontWeight:600,color:"#fff",textTransform:"none",fontSize:"1.8vh",height:"4.6vh",backgroundColor:"rgba(45, 103, 255, 1)",borderRadius:"50px",padding:"0.5rem 1.3rem","&:hover":{backgroundColor:"rgba(45, 103, 255, 0.85)"}}}),JD=pr()({root:{display:"flex",flexDirection:"column",justifyContent:"space-between",height:"90vh"},bigText:{paddingTop:"18px",fontFamily:"SuisseIntl-Light",fontWeight:300,lineHeight:"9vh",letterSpacing:"-0.5vh",fontSize:"10.7vh",color:"#fff"},bigTextSubtitle:{position:"absolute",top:"48%",width:"40%",paddingTop:"18px",fontFamily:"SuisseIntl-Thin",lineHeight:"3vh",letterSpacing:"0vh",fontSize:"2vh",color:"#fff",pointerEvents:"none"},bigTextBlue:{paddingTop:"18px",fontFamily:"SuisseIntl-Medium",fontWeight:500,lineHeight:"9vh",letterSpacing:"-0.5vh",fontSize:"10.7vh",color:"#2D67FF"},textAndToggleWrapper:{zIndex:2,display:"flex",flexDirection:"column",gap:"30px",pointerEvents:"none"},filterButtonAndScaleWrapper:{zIndex:1,minWidth:"100px",display:"flex",flexDirection:"column",alignItems:"flex-end",justifyContent:"space-between"},filterSelect:{zIndex:2,borderRadius:"50px",background:"white",minWidth:"unset",minHeight:"unset",height:"4.6vh",fontSize:"1.8vh",padding:"0px 0px 0px 5px","& .MuiSelect-select":{padding:"0px 0px 0px 15px","&:focus":{backgroundColor:"transparent"}}},filterButton:{minWidth:"unset",minHeight:"unset",height:"4.6vh",fontFamily:"SuisseIntl-Light",fontWeight:400,color:"#000000",textTransform:"none",fontSize:"1.8vh",zIndex:2,backgroundColor:"rgba(255, 255, 255, 1)",borderRadius:"50px",padding:"0.5rem 1rem",opacity:"1","&:hover":{backgroundColor:"rgba(255, 255, 255, 0.85)"}},topLineWrapper:{width:"100%",display:"flex",justifyContent:"space-between",flexDirection:"row"},bottomWrapper:{zIndex:1,display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"flex-end",marginBottom:"40px",pointerEvents:"none",height:"10vh"},smallTextWrapper:{pointerEvents:"all",display:"flex",flexDirection:"row",gap:"10px"},smallText:{fontFamily:"SuisseIntl-Light",fontSize:"17px",color:"#7386CA",cursor:"pointer"},legendLine:{position:"absolute",height:"51.5vh",top:"50%",right:"5%",transform:"translate(0, -45%)",pointerEvents:"none",zIndex:"1"},filterButtonsWrapper:{display:"flex",flexDirection:"row",justifyContent:"space-between",marginTop:"-92vh",alignSelf:"end"},blurAll:{position:"absolute",width:"100%",height:"100%",top:0,left:0,zIndex:2,background:"rgba(0, 0, 0, 0.5)",backdropFilter:"blur(10px)"}}),J_e=Bn(z_e)(()=>({"& .MuiToggleButtonGroup-grouped":{borderRadius:"50px",border:"1px solid rgba(255, 255, 255, 0.2)",color:"#fff",textTransform:"none",pointerEvents:"all"}})),gW=Bn(P_e)({"&.MuiToggleButton-root":{fontFamily:"SuisseIntl-Regular",fontSize:"4vh",textTransform:"none",borderRadius:"50px",border:"1px solid rgba(255, 255, 255, 0.2)",backgroundColor:"transparent",padding:"0.2rem 1.5rem","&:hover":{backgroundColor:"#fff",color:"#000"}},"&.Mui-selected":{backgroundColor:"#fff",color:"#000"}}),Q_e=({children:n,backgroundColor:e})=>{const{classes:i}=KD(),o="#1433AE";return X("div",{className:i.root,style:{backgroundColor:e||o},children:X("div",{className:i.contentWrapper,children:n})})},e1e={menu:"Menu",login:"Log in",signup:"Sign up",back:"Back to globe"},t1e=({isCitySelected:n,setSelectedCity:e,setMenuVisible:i})=>{const o=l=>e1e[l],{classes:s}=DT();return $e("div",{className:s.root,children:[$e("div",{style:{display:"flex",gap:"2.5vh",alignItems:"center"},children:[n&&$e("div",{onClick:()=>{e(null)},className:s.menuIconWrapper,children:[X("img",{style:{width:"4.7vh"},src:"/assets/backToGlobeIcon.svg",width:45,alt:"logo"}),X(Ii,{className:s.whiteText,children:o("back")})]}),$e("div",{onClick:()=>i(!0),className:s.menuIconWrapper,children:[X("img",{style:{width:"4.7vh"},src:"/assets/menuIcon.svg",width:45,alt:"logo"}),X(Ii,{className:s.whiteText,children:o("menu")})]})]}),X("img",{style:{width:"7.8vh"},src:"/assets/logo.svg",alt:"logo"}),$e("div",{className:s.buttonsWrapper,children:[X(xr,{className:s.whiteText,children:o("login")}),X(xr,{className:s.signUpButton,style:{backgroundColor:n?"#FFFFFF":"#2D67FF",color:n?"#1433AE":"#FFFFFF"},children:o("signup")})]})]})},n1e=({map:n})=>$e("div",{style:{position:"relative",zIndex:2,marginRight:"15px",height:"10.5vh",width:"4.7vh",display:"flex",flexDirection:"column",backgroundColor:"#fff",borderRadius:"50px",overflow:"hidden",padding:0,margin:0,pointerEvents:"all"},children:[X("div",{onClick:()=>{n&&n.zoomIn()},style:{cursor:"pointer",height:"50%",display:"flex",justifyContent:"center",alignItems:"center",backgroundColor:"#fff",borderRadius:"50px",overflow:"hidden",padding:0,margin:0},children:X("img",{src:"/assets/plusIcon.svg",width:"45%",alt:"zoom in"})}),X("div",{onClick:()=>{n&&n.zoomOut()},style:{cursor:"pointer",height:"50%",display:"flex",justifyContent:"center",alignItems:"center",backgroundColor:"#fff",borderRadius:"50px",overflow:"hidden",padding:0,margin:0},children:X("img",{src:"/assets/minusIcon.svg",width:"45%",alt:"zoom out"})})]});/**
 * @license
 * Copyright 2010-2023 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const OT="158",tg={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},ng={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},qq=0,ZL=1,Xq=2,i1e=3,Zq=0,NT=1,hx=2,au=3,wd=0,Ss=1,jl=2,a1e=2,zh=0,Sg=1,KL=2,JL=3,QL=4,Kq=5,Zp=100,Jq=101,Qq=102,eR=103,tR=104,eX=200,tX=201,nX=202,iX=203,rM=204,oM=205,aX=206,rX=207,oX=208,sX=209,lX=210,cX=211,uX=212,dX=213,hX=214,pX=0,fX=1,mX=2,ew=3,gX=4,yX=5,vX=6,_X=7,$w=0,bX=1,xX=2,gd=0,wX=1,SX=2,AX=3,QD=4,EX=5,nR="attached",MX="detached",zT=300,Hh=301,wf=302,tw=303,nw=304,S_=306,iw=1e3,bs=1001,aw=1002,so=1003,sM=1004,r1e=1004,px=1005,o1e=1005,Lr=1006,e6=1007,s1e=1007,Sf=1008,l1e=1008,yd=1009,TX=1010,CX=1011,FT=1012,t6=1013,Lh=1014,ud=1015,u_=1016,n6=1017,i6=1018,ff=1020,PX=1021,ml=1023,IX=1024,LX=1025,mf=1026,Bg=1027,RX=1028,a6=1029,kX=1030,r6=1031,o6=1033,oE=33776,sE=33777,lE=33778,cE=33779,iR=35840,aR=35841,rR=35842,oR=35843,DX=36196,sR=37492,lR=37496,cR=37808,uR=37809,dR=37810,hR=37811,pR=37812,fR=37813,mR=37814,gR=37815,yR=37816,vR=37817,_R=37818,bR=37819,xR=37820,wR=37821,uE=36492,SR=36494,AR=36495,OX=36283,ER=36284,MR=36285,TR=36286,NX=2200,zX=2201,FX=2202,rw=2300,ow=2301,dE=2302,pg=2400,fg=2401,sw=2402,BT=2500,s6=2501,c1e=0,u1e=1,d1e=2,l6=3e3,gf=3001,BX=3200,c6=3201,Lf=0,UX=1,$l="",Io="srgb",Sd="srgb-linear",UT="display-p3",Yw="display-p3-linear",lw="linear",tr="srgb",cw="rec709",uw="p3",h1e=0,ig=7680,p1e=7681,f1e=7682,m1e=7683,g1e=34055,y1e=34056,v1e=5386,_1e=512,b1e=513,x1e=514,w1e=515,S1e=516,A1e=517,E1e=518,CR=519,WX=512,VX=513,GX=514,HX=515,jX=516,$X=517,YX=518,qX=519,dw=35044,M1e=35048,T1e=35040,C1e=35045,P1e=35049,I1e=35041,L1e=35046,R1e=35050,k1e=35042,D1e="100",PR="300 es",lM=1035,dd=2e3,hw=2001;class Td{addEventListener(e,i){this._listeners===void 0&&(this._listeners={});const o=this._listeners;o[e]===void 0&&(o[e]=[]),o[e].indexOf(i)===-1&&o[e].push(i)}hasEventListener(e,i){if(this._listeners===void 0)return!1;const o=this._listeners;return o[e]!==void 0&&o[e].indexOf(i)!==-1}removeEventListener(e,i){if(this._listeners===void 0)return;const s=this._listeners[e];if(s!==void 0){const l=s.indexOf(i);l!==-1&&s.splice(l,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const o=this._listeners[e.type];if(o!==void 0){e.target=this;const s=o.slice(0);for(let l=0,d=s.length;l<d;l++)s[l].call(this,e);e.target=null}}}const fs=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let yW=1234567;const Ag=Math.PI/180,d_=180/Math.PI;function Zl(){const n=Math.random()*4294967295|0,e=Math.random()*4294967295|0,i=Math.random()*4294967295|0,o=Math.random()*4294967295|0;return(fs[n&255]+fs[n>>8&255]+fs[n>>16&255]+fs[n>>24&255]+"-"+fs[e&255]+fs[e>>8&255]+"-"+fs[e>>16&15|64]+fs[e>>24&255]+"-"+fs[i&63|128]+fs[i>>8&255]+"-"+fs[i>>16&255]+fs[i>>24&255]+fs[o&255]+fs[o>>8&255]+fs[o>>16&255]+fs[o>>24&255]).toLowerCase()}function Yr(n,e,i){return Math.max(e,Math.min(i,n))}function u6(n,e){return(n%e+e)%e}function O1e(n,e,i,o,s){return o+(n-e)*(s-o)/(i-e)}function N1e(n,e,i){return n!==e?(i-n)/(e-n):0}function fx(n,e,i){return(1-i)*n+i*e}function z1e(n,e,i,o){return fx(n,e,1-Math.exp(-i*o))}function F1e(n,e=1){return e-Math.abs(u6(n,e*2)-e)}function B1e(n,e,i){return n<=e?0:n>=i?1:(n=(n-e)/(i-e),n*n*(3-2*n))}function U1e(n,e,i){return n<=e?0:n>=i?1:(n=(n-e)/(i-e),n*n*n*(n*(n*6-15)+10))}function W1e(n,e){return n+Math.floor(Math.random()*(e-n+1))}function V1e(n,e){return n+Math.random()*(e-n)}function G1e(n){return n*(.5-Math.random())}function H1e(n){n!==void 0&&(yW=n);let e=yW+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function j1e(n){return n*Ag}function $1e(n){return n*d_}function IR(n){return(n&n-1)===0&&n!==0}function XX(n){return Math.pow(2,Math.ceil(Math.log(n)/Math.LN2))}function cM(n){return Math.pow(2,Math.floor(Math.log(n)/Math.LN2))}function Y1e(n,e,i,o,s){const l=Math.cos,d=Math.sin,p=l(i/2),f=d(i/2),y=l((e+o)/2),_=d((e+o)/2),x=l((e-o)/2),S=d((e-o)/2),T=l((o-e)/2),I=d((o-e)/2);switch(s){case"XYX":n.set(p*_,f*x,f*S,p*y);break;case"YZY":n.set(f*S,p*_,f*x,p*y);break;case"ZXZ":n.set(f*x,f*S,p*_,p*y);break;case"XZX":n.set(p*_,f*I,f*T,p*y);break;case"YXY":n.set(f*T,p*_,f*I,p*y);break;case"ZYZ":n.set(f*I,f*T,p*_,p*y);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+s)}}function gl(n,e){switch(e.constructor){case Float32Array:return n;case Uint32Array:return n/4294967295;case Uint16Array:return n/65535;case Uint8Array:return n/255;case Int32Array:return Math.max(n/2147483647,-1);case Int16Array:return Math.max(n/32767,-1);case Int8Array:return Math.max(n/127,-1);default:throw new Error("Invalid component type.")}}function Wi(n,e){switch(e.constructor){case Float32Array:return n;case Uint32Array:return Math.round(n*4294967295);case Uint16Array:return Math.round(n*65535);case Uint8Array:return Math.round(n*255);case Int32Array:return Math.round(n*2147483647);case Int16Array:return Math.round(n*32767);case Int8Array:return Math.round(n*127);default:throw new Error("Invalid component type.")}}const q1e={DEG2RAD:Ag,RAD2DEG:d_,generateUUID:Zl,clamp:Yr,euclideanModulo:u6,mapLinear:O1e,inverseLerp:N1e,lerp:fx,damp:z1e,pingpong:F1e,smoothstep:B1e,smootherstep:U1e,randInt:W1e,randFloat:V1e,randFloatSpread:G1e,seededRandom:H1e,degToRad:j1e,radToDeg:$1e,isPowerOfTwo:IR,ceilPowerOfTwo:XX,floorPowerOfTwo:cM,setQuaternionFromProperEuler:Y1e,normalize:Wi,denormalize:gl};class tn{constructor(e=0,i=0){tn.prototype.isVector2=!0,this.x=e,this.y=i}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,i){return this.x=e,this.y=i,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,i){switch(e){case 0:this.x=i;break;case 1:this.y=i;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,i){return this.x=e.x+i.x,this.y=e.y+i.y,this}addScaledVector(e,i){return this.x+=e.x*i,this.y+=e.y*i,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,i){return this.x=e.x-i.x,this.y=e.y-i.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const i=this.x,o=this.y,s=e.elements;return this.x=s[0]*i+s[3]*o+s[6],this.y=s[1]*i+s[4]*o+s[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,i){return this.x=Math.max(e.x,Math.min(i.x,this.x)),this.y=Math.max(e.y,Math.min(i.y,this.y)),this}clampScalar(e,i){return this.x=Math.max(e,Math.min(i,this.x)),this.y=Math.max(e,Math.min(i,this.y)),this}clampLength(e,i){const o=this.length();return this.divideScalar(o||1).multiplyScalar(Math.max(e,Math.min(i,o)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const i=Math.sqrt(this.lengthSq()*e.lengthSq());if(i===0)return Math.PI/2;const o=this.dot(e)/i;return Math.acos(Yr(o,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const i=this.x-e.x,o=this.y-e.y;return i*i+o*o}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,i){return this.x+=(e.x-this.x)*i,this.y+=(e.y-this.y)*i,this}lerpVectors(e,i,o){return this.x=e.x+(i.x-e.x)*o,this.y=e.y+(i.y-e.y)*o,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,i=0){return this.x=e[i],this.y=e[i+1],this}toArray(e=[],i=0){return e[i]=this.x,e[i+1]=this.y,e}fromBufferAttribute(e,i){return this.x=e.getX(i),this.y=e.getY(i),this}rotateAround(e,i){const o=Math.cos(i),s=Math.sin(i),l=this.x-e.x,d=this.y-e.y;return this.x=l*o-d*s+e.x,this.y=l*s+d*o+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Ui{constructor(e,i,o,s,l,d,p,f,y){Ui.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,i,o,s,l,d,p,f,y)}set(e,i,o,s,l,d,p,f,y){const _=this.elements;return _[0]=e,_[1]=s,_[2]=p,_[3]=i,_[4]=l,_[5]=f,_[6]=o,_[7]=d,_[8]=y,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const i=this.elements,o=e.elements;return i[0]=o[0],i[1]=o[1],i[2]=o[2],i[3]=o[3],i[4]=o[4],i[5]=o[5],i[6]=o[6],i[7]=o[7],i[8]=o[8],this}extractBasis(e,i,o){return e.setFromMatrix3Column(this,0),i.setFromMatrix3Column(this,1),o.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const i=e.elements;return this.set(i[0],i[4],i[8],i[1],i[5],i[9],i[2],i[6],i[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,i){const o=e.elements,s=i.elements,l=this.elements,d=o[0],p=o[3],f=o[6],y=o[1],_=o[4],x=o[7],S=o[2],T=o[5],I=o[8],R=s[0],D=s[3],L=s[6],O=s[1],N=s[4],F=s[7],G=s[2],j=s[5],Y=s[8];return l[0]=d*R+p*O+f*G,l[3]=d*D+p*N+f*j,l[6]=d*L+p*F+f*Y,l[1]=y*R+_*O+x*G,l[4]=y*D+_*N+x*j,l[7]=y*L+_*F+x*Y,l[2]=S*R+T*O+I*G,l[5]=S*D+T*N+I*j,l[8]=S*L+T*F+I*Y,this}multiplyScalar(e){const i=this.elements;return i[0]*=e,i[3]*=e,i[6]*=e,i[1]*=e,i[4]*=e,i[7]*=e,i[2]*=e,i[5]*=e,i[8]*=e,this}determinant(){const e=this.elements,i=e[0],o=e[1],s=e[2],l=e[3],d=e[4],p=e[5],f=e[6],y=e[7],_=e[8];return i*d*_-i*p*y-o*l*_+o*p*f+s*l*y-s*d*f}invert(){const e=this.elements,i=e[0],o=e[1],s=e[2],l=e[3],d=e[4],p=e[5],f=e[6],y=e[7],_=e[8],x=_*d-p*y,S=p*f-_*l,T=y*l-d*f,I=i*x+o*S+s*T;if(I===0)return this.set(0,0,0,0,0,0,0,0,0);const R=1/I;return e[0]=x*R,e[1]=(s*y-_*o)*R,e[2]=(p*o-s*d)*R,e[3]=S*R,e[4]=(_*i-s*f)*R,e[5]=(s*l-p*i)*R,e[6]=T*R,e[7]=(o*f-y*i)*R,e[8]=(d*i-o*l)*R,this}transpose(){let e;const i=this.elements;return e=i[1],i[1]=i[3],i[3]=e,e=i[2],i[2]=i[6],i[6]=e,e=i[5],i[5]=i[7],i[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const i=this.elements;return e[0]=i[0],e[1]=i[3],e[2]=i[6],e[3]=i[1],e[4]=i[4],e[5]=i[7],e[6]=i[2],e[7]=i[5],e[8]=i[8],this}setUvTransform(e,i,o,s,l,d,p){const f=Math.cos(l),y=Math.sin(l);return this.set(o*f,o*y,-o*(f*d+y*p)+d+e,-s*y,s*f,-s*(-y*d+f*p)+p+i,0,0,1),this}scale(e,i){return this.premultiply(A4.makeScale(e,i)),this}rotate(e){return this.premultiply(A4.makeRotation(-e)),this}translate(e,i){return this.premultiply(A4.makeTranslation(e,i)),this}makeTranslation(e,i){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,i,0,0,1),this}makeRotation(e){const i=Math.cos(e),o=Math.sin(e);return this.set(i,-o,0,o,i,0,0,0,1),this}makeScale(e,i){return this.set(e,0,0,0,i,0,0,0,1),this}equals(e){const i=this.elements,o=e.elements;for(let s=0;s<9;s++)if(i[s]!==o[s])return!1;return!0}fromArray(e,i=0){for(let o=0;o<9;o++)this.elements[o]=e[o+i];return this}toArray(e=[],i=0){const o=this.elements;return e[i]=o[0],e[i+1]=o[1],e[i+2]=o[2],e[i+3]=o[3],e[i+4]=o[4],e[i+5]=o[5],e[i+6]=o[6],e[i+7]=o[7],e[i+8]=o[8],e}clone(){return new this.constructor().fromArray(this.elements)}}const A4=new Ui;function ZX(n){for(let e=n.length-1;e>=0;--e)if(n[e]>=65535)return!0;return!1}const X1e={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function C0(n,e){return new X1e[n](e)}function pw(n){return document.createElementNS("http://www.w3.org/1999/xhtml",n)}function KX(){const n=pw("canvas");return n.style.display="block",n}const vW={};function mx(n){n in vW||(vW[n]=!0,console.warn(n))}const _W=new Ui().set(.8224621,.177538,0,.0331941,.9668058,0,.0170827,.0723974,.9105199),bW=new Ui().set(1.2249401,-.2249404,0,-.0420569,1.0420571,0,-.0196376,-.0786361,1.0982735),AS={[Sd]:{transfer:lw,primaries:cw,toReference:n=>n,fromReference:n=>n},[Io]:{transfer:tr,primaries:cw,toReference:n=>n.convertSRGBToLinear(),fromReference:n=>n.convertLinearToSRGB()},[Yw]:{transfer:lw,primaries:uw,toReference:n=>n.applyMatrix3(bW),fromReference:n=>n.applyMatrix3(_W)},[UT]:{transfer:tr,primaries:uw,toReference:n=>n.convertSRGBToLinear().applyMatrix3(bW),fromReference:n=>n.applyMatrix3(_W).convertLinearToSRGB()}},Z1e=new Set([Sd,Yw]),Ba={enabled:!0,_workingColorSpace:Sd,get legacyMode(){return console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),!this.enabled},set legacyMode(n){console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),this.enabled=!n},get workingColorSpace(){return this._workingColorSpace},set workingColorSpace(n){if(!Z1e.has(n))throw new Error(`Unsupported working color space, "${n}".`);this._workingColorSpace=n},convert:function(n,e,i){if(this.enabled===!1||e===i||!e||!i)return n;const o=AS[e].toReference,s=AS[i].fromReference;return s(o(n))},fromWorkingColorSpace:function(n,e){return this.convert(n,this._workingColorSpace,e)},toWorkingColorSpace:function(n,e){return this.convert(n,e,this._workingColorSpace)},getPrimaries:function(n){return AS[n].primaries},getTransfer:function(n){return n===$l?lw:AS[n].transfer}};function G0(n){return n<.04045?n*.0773993808:Math.pow(n*.9478672986+.0521327014,2.4)}function E4(n){return n<.0031308?n*12.92:1.055*Math.pow(n,.41666)-.055}let zv;class d6{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let i;if(e instanceof HTMLCanvasElement)i=e;else{zv===void 0&&(zv=pw("canvas")),zv.width=e.width,zv.height=e.height;const o=zv.getContext("2d");e instanceof ImageData?o.putImageData(e,0,0):o.drawImage(e,0,0,e.width,e.height),i=zv}return i.width>2048||i.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),i.toDataURL("image/jpeg",.6)):i.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const i=pw("canvas");i.width=e.width,i.height=e.height;const o=i.getContext("2d");o.drawImage(e,0,0,e.width,e.height);const s=o.getImageData(0,0,e.width,e.height),l=s.data;for(let d=0;d<l.length;d++)l[d]=G0(l[d]/255)*255;return o.putImageData(s,0,0),i}else if(e.data){const i=e.data.slice(0);for(let o=0;o<i.length;o++)i instanceof Uint8Array||i instanceof Uint8ClampedArray?i[o]=Math.floor(G0(i[o]/255)*255):i[o]=G0(i[o]);return{data:i,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let K1e=0;class mg{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:K1e++}),this.uuid=Zl(),this.data=e,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const i=e===void 0||typeof e=="string";if(!i&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const o={uuid:this.uuid,url:""},s=this.data;if(s!==null){let l;if(Array.isArray(s)){l=[];for(let d=0,p=s.length;d<p;d++)s[d].isDataTexture?l.push(M4(s[d].image)):l.push(M4(s[d]))}else l=M4(s);o.url=l}return i||(e.images[this.uuid]=o),o}}function M4(n){return typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&n instanceof ImageBitmap?d6.getDataURL(n):n.data?{data:Array.from(n.data),width:n.width,height:n.height,type:n.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let J1e=0;class Or extends Td{constructor(e=Or.DEFAULT_IMAGE,i=Or.DEFAULT_MAPPING,o=bs,s=bs,l=Lr,d=Sf,p=ml,f=yd,y=Or.DEFAULT_ANISOTROPY,_=$l){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:J1e++}),this.uuid=Zl(),this.name="",this.source=new mg(e),this.mipmaps=[],this.mapping=i,this.channel=0,this.wrapS=o,this.wrapT=s,this.magFilter=l,this.minFilter=d,this.anisotropy=y,this.format=p,this.internalFormat=null,this.type=f,this.offset=new tn(0,0),this.repeat=new tn(1,1),this.center=new tn(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Ui,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,typeof _=="string"?this.colorSpace=_:(mx("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=_===gf?Io:$l),this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const i=e===void 0||typeof e=="string";if(!i&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const o={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(o.userData=this.userData),i||(e.textures[this.uuid]=o),o}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==zT)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case iw:e.x=e.x-Math.floor(e.x);break;case bs:e.x=e.x<0?0:1;break;case aw:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case iw:e.y=e.y-Math.floor(e.y);break;case bs:e.y=e.y<0?0:1;break;case aw:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}get encoding(){return mx("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace===Io?gf:l6}set encoding(e){mx("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=e===gf?Io:$l}}Or.DEFAULT_IMAGE=null;Or.DEFAULT_MAPPING=zT;Or.DEFAULT_ANISOTROPY=1;class Pa{constructor(e=0,i=0,o=0,s=1){Pa.prototype.isVector4=!0,this.x=e,this.y=i,this.z=o,this.w=s}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,i,o,s){return this.x=e,this.y=i,this.z=o,this.w=s,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,i){switch(e){case 0:this.x=i;break;case 1:this.y=i;break;case 2:this.z=i;break;case 3:this.w=i;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,i){return this.x=e.x+i.x,this.y=e.y+i.y,this.z=e.z+i.z,this.w=e.w+i.w,this}addScaledVector(e,i){return this.x+=e.x*i,this.y+=e.y*i,this.z+=e.z*i,this.w+=e.w*i,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,i){return this.x=e.x-i.x,this.y=e.y-i.y,this.z=e.z-i.z,this.w=e.w-i.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const i=this.x,o=this.y,s=this.z,l=this.w,d=e.elements;return this.x=d[0]*i+d[4]*o+d[8]*s+d[12]*l,this.y=d[1]*i+d[5]*o+d[9]*s+d[13]*l,this.z=d[2]*i+d[6]*o+d[10]*s+d[14]*l,this.w=d[3]*i+d[7]*o+d[11]*s+d[15]*l,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const i=Math.sqrt(1-e.w*e.w);return i<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/i,this.y=e.y/i,this.z=e.z/i),this}setAxisAngleFromRotationMatrix(e){let i,o,s,l;const f=e.elements,y=f[0],_=f[4],x=f[8],S=f[1],T=f[5],I=f[9],R=f[2],D=f[6],L=f[10];if(Math.abs(_-S)<.01&&Math.abs(x-R)<.01&&Math.abs(I-D)<.01){if(Math.abs(_+S)<.1&&Math.abs(x+R)<.1&&Math.abs(I+D)<.1&&Math.abs(y+T+L-3)<.1)return this.set(1,0,0,0),this;i=Math.PI;const N=(y+1)/2,F=(T+1)/2,G=(L+1)/2,j=(_+S)/4,Y=(x+R)/4,te=(I+D)/4;return N>F&&N>G?N<.01?(o=0,s=.707106781,l=.707106781):(o=Math.sqrt(N),s=j/o,l=Y/o):F>G?F<.01?(o=.707106781,s=0,l=.707106781):(s=Math.sqrt(F),o=j/s,l=te/s):G<.01?(o=.707106781,s=.707106781,l=0):(l=Math.sqrt(G),o=Y/l,s=te/l),this.set(o,s,l,i),this}let O=Math.sqrt((D-I)*(D-I)+(x-R)*(x-R)+(S-_)*(S-_));return Math.abs(O)<.001&&(O=1),this.x=(D-I)/O,this.y=(x-R)/O,this.z=(S-_)/O,this.w=Math.acos((y+T+L-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,i){return this.x=Math.max(e.x,Math.min(i.x,this.x)),this.y=Math.max(e.y,Math.min(i.y,this.y)),this.z=Math.max(e.z,Math.min(i.z,this.z)),this.w=Math.max(e.w,Math.min(i.w,this.w)),this}clampScalar(e,i){return this.x=Math.max(e,Math.min(i,this.x)),this.y=Math.max(e,Math.min(i,this.y)),this.z=Math.max(e,Math.min(i,this.z)),this.w=Math.max(e,Math.min(i,this.w)),this}clampLength(e,i){const o=this.length();return this.divideScalar(o||1).multiplyScalar(Math.max(e,Math.min(i,o)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,i){return this.x+=(e.x-this.x)*i,this.y+=(e.y-this.y)*i,this.z+=(e.z-this.z)*i,this.w+=(e.w-this.w)*i,this}lerpVectors(e,i,o){return this.x=e.x+(i.x-e.x)*o,this.y=e.y+(i.y-e.y)*o,this.z=e.z+(i.z-e.z)*o,this.w=e.w+(i.w-e.w)*o,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,i=0){return this.x=e[i],this.y=e[i+1],this.z=e[i+2],this.w=e[i+3],this}toArray(e=[],i=0){return e[i]=this.x,e[i+1]=this.y,e[i+2]=this.z,e[i+3]=this.w,e}fromBufferAttribute(e,i){return this.x=e.getX(i),this.y=e.getY(i),this.z=e.getZ(i),this.w=e.getW(i),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class JX extends Td{constructor(e=1,i=1,o={}){super(),this.isRenderTarget=!0,this.width=e,this.height=i,this.depth=1,this.scissor=new Pa(0,0,e,i),this.scissorTest=!1,this.viewport=new Pa(0,0,e,i);const s={width:e,height:i,depth:1};o.encoding!==void 0&&(mx("THREE.WebGLRenderTarget: option.encoding has been replaced by option.colorSpace."),o.colorSpace=o.encoding===gf?Io:$l),o=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:Lr,depthBuffer:!0,stencilBuffer:!1,depthTexture:null,samples:0},o),this.texture=new Or(s,o.mapping,o.wrapS,o.wrapT,o.magFilter,o.minFilter,o.format,o.type,o.anisotropy,o.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=o.generateMipmaps,this.texture.internalFormat=o.internalFormat,this.depthBuffer=o.depthBuffer,this.stencilBuffer=o.stencilBuffer,this.depthTexture=o.depthTexture,this.samples=o.samples}setSize(e,i,o=1){(this.width!==e||this.height!==i||this.depth!==o)&&(this.width=e,this.height=i,this.depth=o,this.texture.image.width=e,this.texture.image.height=i,this.texture.image.depth=o,this.dispose()),this.viewport.set(0,0,e,i),this.scissor.set(0,0,e,i)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0;const i=Object.assign({},e.texture.image);return this.texture.source=new mg(i),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class yu extends JX{constructor(e=1,i=1,o={}){super(e,i,o),this.isWebGLRenderTarget=!0}}class WT extends Or{constructor(e=null,i=1,o=1,s=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:i,height:o,depth:s},this.magFilter=so,this.minFilter=so,this.wrapR=bs,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class Q1e extends yu{constructor(e=1,i=1,o=1){super(e,i),this.isWebGLArrayRenderTarget=!0,this.depth=o,this.texture=new WT(null,e,i,o),this.texture.isRenderTargetTexture=!0}}class h6 extends Or{constructor(e=null,i=1,o=1,s=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:i,height:o,depth:s},this.magFilter=so,this.minFilter=so,this.wrapR=bs,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class ebe extends yu{constructor(e=1,i=1,o=1){super(e,i),this.isWebGL3DRenderTarget=!0,this.depth=o,this.texture=new h6(null,e,i,o),this.texture.isRenderTargetTexture=!0}}class tbe extends yu{constructor(e=1,i=1,o=1,s={}){super(e,i,s),this.isWebGLMultipleRenderTargets=!0;const l=this.texture;this.texture=[];for(let d=0;d<o;d++)this.texture[d]=l.clone(),this.texture[d].isRenderTargetTexture=!0}setSize(e,i,o=1){if(this.width!==e||this.height!==i||this.depth!==o){this.width=e,this.height=i,this.depth=o;for(let s=0,l=this.texture.length;s<l;s++)this.texture[s].image.width=e,this.texture[s].image.height=i,this.texture[s].image.depth=o;this.dispose()}this.viewport.set(0,0,e,i),this.scissor.set(0,0,e,i)}copy(e){this.dispose(),this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.texture.length=0;for(let i=0,o=e.texture.length;i<o;i++)this.texture[i]=e.texture[i].clone(),this.texture[i].isRenderTargetTexture=!0;return this}}class As{constructor(e=0,i=0,o=0,s=1){this.isQuaternion=!0,this._x=e,this._y=i,this._z=o,this._w=s}static slerpFlat(e,i,o,s,l,d,p){let f=o[s+0],y=o[s+1],_=o[s+2],x=o[s+3];const S=l[d+0],T=l[d+1],I=l[d+2],R=l[d+3];if(p===0){e[i+0]=f,e[i+1]=y,e[i+2]=_,e[i+3]=x;return}if(p===1){e[i+0]=S,e[i+1]=T,e[i+2]=I,e[i+3]=R;return}if(x!==R||f!==S||y!==T||_!==I){let D=1-p;const L=f*S+y*T+_*I+x*R,O=L>=0?1:-1,N=1-L*L;if(N>Number.EPSILON){const G=Math.sqrt(N),j=Math.atan2(G,L*O);D=Math.sin(D*j)/G,p=Math.sin(p*j)/G}const F=p*O;if(f=f*D+S*F,y=y*D+T*F,_=_*D+I*F,x=x*D+R*F,D===1-p){const G=1/Math.sqrt(f*f+y*y+_*_+x*x);f*=G,y*=G,_*=G,x*=G}}e[i]=f,e[i+1]=y,e[i+2]=_,e[i+3]=x}static multiplyQuaternionsFlat(e,i,o,s,l,d){const p=o[s],f=o[s+1],y=o[s+2],_=o[s+3],x=l[d],S=l[d+1],T=l[d+2],I=l[d+3];return e[i]=p*I+_*x+f*T-y*S,e[i+1]=f*I+_*S+y*x-p*T,e[i+2]=y*I+_*T+p*S-f*x,e[i+3]=_*I-p*x-f*S-y*T,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,i,o,s){return this._x=e,this._y=i,this._z=o,this._w=s,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,i){const o=e._x,s=e._y,l=e._z,d=e._order,p=Math.cos,f=Math.sin,y=p(o/2),_=p(s/2),x=p(l/2),S=f(o/2),T=f(s/2),I=f(l/2);switch(d){case"XYZ":this._x=S*_*x+y*T*I,this._y=y*T*x-S*_*I,this._z=y*_*I+S*T*x,this._w=y*_*x-S*T*I;break;case"YXZ":this._x=S*_*x+y*T*I,this._y=y*T*x-S*_*I,this._z=y*_*I-S*T*x,this._w=y*_*x+S*T*I;break;case"ZXY":this._x=S*_*x-y*T*I,this._y=y*T*x+S*_*I,this._z=y*_*I+S*T*x,this._w=y*_*x-S*T*I;break;case"ZYX":this._x=S*_*x-y*T*I,this._y=y*T*x+S*_*I,this._z=y*_*I-S*T*x,this._w=y*_*x+S*T*I;break;case"YZX":this._x=S*_*x+y*T*I,this._y=y*T*x+S*_*I,this._z=y*_*I-S*T*x,this._w=y*_*x-S*T*I;break;case"XZY":this._x=S*_*x-y*T*I,this._y=y*T*x-S*_*I,this._z=y*_*I+S*T*x,this._w=y*_*x+S*T*I;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+d)}return i!==!1&&this._onChangeCallback(),this}setFromAxisAngle(e,i){const o=i/2,s=Math.sin(o);return this._x=e.x*s,this._y=e.y*s,this._z=e.z*s,this._w=Math.cos(o),this._onChangeCallback(),this}setFromRotationMatrix(e){const i=e.elements,o=i[0],s=i[4],l=i[8],d=i[1],p=i[5],f=i[9],y=i[2],_=i[6],x=i[10],S=o+p+x;if(S>0){const T=.5/Math.sqrt(S+1);this._w=.25/T,this._x=(_-f)*T,this._y=(l-y)*T,this._z=(d-s)*T}else if(o>p&&o>x){const T=2*Math.sqrt(1+o-p-x);this._w=(_-f)/T,this._x=.25*T,this._y=(s+d)/T,this._z=(l+y)/T}else if(p>x){const T=2*Math.sqrt(1+p-o-x);this._w=(l-y)/T,this._x=(s+d)/T,this._y=.25*T,this._z=(f+_)/T}else{const T=2*Math.sqrt(1+x-o-p);this._w=(d-s)/T,this._x=(l+y)/T,this._y=(f+_)/T,this._z=.25*T}return this._onChangeCallback(),this}setFromUnitVectors(e,i){let o=e.dot(i)+1;return o<Number.EPSILON?(o=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=o):(this._x=0,this._y=-e.z,this._z=e.y,this._w=o)):(this._x=e.y*i.z-e.z*i.y,this._y=e.z*i.x-e.x*i.z,this._z=e.x*i.y-e.y*i.x,this._w=o),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Yr(this.dot(e),-1,1)))}rotateTowards(e,i){const o=this.angleTo(e);if(o===0)return this;const s=Math.min(1,i/o);return this.slerp(e,s),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,i){const o=e._x,s=e._y,l=e._z,d=e._w,p=i._x,f=i._y,y=i._z,_=i._w;return this._x=o*_+d*p+s*y-l*f,this._y=s*_+d*f+l*p-o*y,this._z=l*_+d*y+o*f-s*p,this._w=d*_-o*p-s*f-l*y,this._onChangeCallback(),this}slerp(e,i){if(i===0)return this;if(i===1)return this.copy(e);const o=this._x,s=this._y,l=this._z,d=this._w;let p=d*e._w+o*e._x+s*e._y+l*e._z;if(p<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,p=-p):this.copy(e),p>=1)return this._w=d,this._x=o,this._y=s,this._z=l,this;const f=1-p*p;if(f<=Number.EPSILON){const T=1-i;return this._w=T*d+i*this._w,this._x=T*o+i*this._x,this._y=T*s+i*this._y,this._z=T*l+i*this._z,this.normalize(),this._onChangeCallback(),this}const y=Math.sqrt(f),_=Math.atan2(y,p),x=Math.sin((1-i)*_)/y,S=Math.sin(i*_)/y;return this._w=d*x+this._w*S,this._x=o*x+this._x*S,this._y=s*x+this._y*S,this._z=l*x+this._z*S,this._onChangeCallback(),this}slerpQuaternions(e,i,o){return this.copy(e).slerp(i,o)}random(){const e=Math.random(),i=Math.sqrt(1-e),o=Math.sqrt(e),s=2*Math.PI*Math.random(),l=2*Math.PI*Math.random();return this.set(i*Math.cos(s),o*Math.sin(l),o*Math.cos(l),i*Math.sin(s))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,i=0){return this._x=e[i],this._y=e[i+1],this._z=e[i+2],this._w=e[i+3],this._onChangeCallback(),this}toArray(e=[],i=0){return e[i]=this._x,e[i+1]=this._y,e[i+2]=this._z,e[i+3]=this._w,e}fromBufferAttribute(e,i){return this._x=e.getX(i),this._y=e.getY(i),this._z=e.getZ(i),this._w=e.getW(i),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class Ue{constructor(e=0,i=0,o=0){Ue.prototype.isVector3=!0,this.x=e,this.y=i,this.z=o}set(e,i,o){return o===void 0&&(o=this.z),this.x=e,this.y=i,this.z=o,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,i){switch(e){case 0:this.x=i;break;case 1:this.y=i;break;case 2:this.z=i;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,i){return this.x=e.x+i.x,this.y=e.y+i.y,this.z=e.z+i.z,this}addScaledVector(e,i){return this.x+=e.x*i,this.y+=e.y*i,this.z+=e.z*i,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,i){return this.x=e.x-i.x,this.y=e.y-i.y,this.z=e.z-i.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,i){return this.x=e.x*i.x,this.y=e.y*i.y,this.z=e.z*i.z,this}applyEuler(e){return this.applyQuaternion(xW.setFromEuler(e))}applyAxisAngle(e,i){return this.applyQuaternion(xW.setFromAxisAngle(e,i))}applyMatrix3(e){const i=this.x,o=this.y,s=this.z,l=e.elements;return this.x=l[0]*i+l[3]*o+l[6]*s,this.y=l[1]*i+l[4]*o+l[7]*s,this.z=l[2]*i+l[5]*o+l[8]*s,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const i=this.x,o=this.y,s=this.z,l=e.elements,d=1/(l[3]*i+l[7]*o+l[11]*s+l[15]);return this.x=(l[0]*i+l[4]*o+l[8]*s+l[12])*d,this.y=(l[1]*i+l[5]*o+l[9]*s+l[13])*d,this.z=(l[2]*i+l[6]*o+l[10]*s+l[14])*d,this}applyQuaternion(e){const i=this.x,o=this.y,s=this.z,l=e.x,d=e.y,p=e.z,f=e.w,y=2*(d*s-p*o),_=2*(p*i-l*s),x=2*(l*o-d*i);return this.x=i+f*y+d*x-p*_,this.y=o+f*_+p*y-l*x,this.z=s+f*x+l*_-d*y,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const i=this.x,o=this.y,s=this.z,l=e.elements;return this.x=l[0]*i+l[4]*o+l[8]*s,this.y=l[1]*i+l[5]*o+l[9]*s,this.z=l[2]*i+l[6]*o+l[10]*s,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,i){return this.x=Math.max(e.x,Math.min(i.x,this.x)),this.y=Math.max(e.y,Math.min(i.y,this.y)),this.z=Math.max(e.z,Math.min(i.z,this.z)),this}clampScalar(e,i){return this.x=Math.max(e,Math.min(i,this.x)),this.y=Math.max(e,Math.min(i,this.y)),this.z=Math.max(e,Math.min(i,this.z)),this}clampLength(e,i){const o=this.length();return this.divideScalar(o||1).multiplyScalar(Math.max(e,Math.min(i,o)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,i){return this.x+=(e.x-this.x)*i,this.y+=(e.y-this.y)*i,this.z+=(e.z-this.z)*i,this}lerpVectors(e,i,o){return this.x=e.x+(i.x-e.x)*o,this.y=e.y+(i.y-e.y)*o,this.z=e.z+(i.z-e.z)*o,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,i){const o=e.x,s=e.y,l=e.z,d=i.x,p=i.y,f=i.z;return this.x=s*f-l*p,this.y=l*d-o*f,this.z=o*p-s*d,this}projectOnVector(e){const i=e.lengthSq();if(i===0)return this.set(0,0,0);const o=e.dot(this)/i;return this.copy(e).multiplyScalar(o)}projectOnPlane(e){return T4.copy(this).projectOnVector(e),this.sub(T4)}reflect(e){return this.sub(T4.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const i=Math.sqrt(this.lengthSq()*e.lengthSq());if(i===0)return Math.PI/2;const o=this.dot(e)/i;return Math.acos(Yr(o,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const i=this.x-e.x,o=this.y-e.y,s=this.z-e.z;return i*i+o*o+s*s}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,i,o){const s=Math.sin(i)*e;return this.x=s*Math.sin(o),this.y=Math.cos(i)*e,this.z=s*Math.cos(o),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,i,o){return this.x=e*Math.sin(i),this.y=o,this.z=e*Math.cos(i),this}setFromMatrixPosition(e){const i=e.elements;return this.x=i[12],this.y=i[13],this.z=i[14],this}setFromMatrixScale(e){const i=this.setFromMatrixColumn(e,0).length(),o=this.setFromMatrixColumn(e,1).length(),s=this.setFromMatrixColumn(e,2).length();return this.x=i,this.y=o,this.z=s,this}setFromMatrixColumn(e,i){return this.fromArray(e.elements,i*4)}setFromMatrix3Column(e,i){return this.fromArray(e.elements,i*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,i=0){return this.x=e[i],this.y=e[i+1],this.z=e[i+2],this}toArray(e=[],i=0){return e[i]=this.x,e[i+1]=this.y,e[i+2]=this.z,e}fromBufferAttribute(e,i){return this.x=e.getX(i),this.y=e.getY(i),this.z=e.getZ(i),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=(Math.random()-.5)*2,i=Math.random()*Math.PI*2,o=Math.sqrt(1-e**2);return this.x=o*Math.cos(i),this.y=o*Math.sin(i),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const T4=new Ue,xW=new As;class _u{constructor(e=new Ue(1/0,1/0,1/0),i=new Ue(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=i}set(e,i){return this.min.copy(e),this.max.copy(i),this}setFromArray(e){this.makeEmpty();for(let i=0,o=e.length;i<o;i+=3)this.expandByPoint(eu.fromArray(e,i));return this}setFromBufferAttribute(e){this.makeEmpty();for(let i=0,o=e.count;i<o;i++)this.expandByPoint(eu.fromBufferAttribute(e,i));return this}setFromPoints(e){this.makeEmpty();for(let i=0,o=e.length;i<o;i++)this.expandByPoint(e[i]);return this}setFromCenterAndSize(e,i){const o=eu.copy(i).multiplyScalar(.5);return this.min.copy(e).sub(o),this.max.copy(e).add(o),this}setFromObject(e,i=!1){return this.makeEmpty(),this.expandByObject(e,i)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,i=!1){e.updateWorldMatrix(!1,!1);const o=e.geometry;if(o!==void 0){const l=o.getAttribute("position");if(i===!0&&l!==void 0&&e.isInstancedMesh!==!0)for(let d=0,p=l.count;d<p;d++)e.isMesh===!0?e.getVertexPosition(d,eu):eu.fromBufferAttribute(l,d),eu.applyMatrix4(e.matrixWorld),this.expandByPoint(eu);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),ES.copy(e.boundingBox)):(o.boundingBox===null&&o.computeBoundingBox(),ES.copy(o.boundingBox)),ES.applyMatrix4(e.matrixWorld),this.union(ES)}const s=e.children;for(let l=0,d=s.length;l<d;l++)this.expandByObject(s[l],i);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,i){return i.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,eu),eu.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let i,o;return e.normal.x>0?(i=e.normal.x*this.min.x,o=e.normal.x*this.max.x):(i=e.normal.x*this.max.x,o=e.normal.x*this.min.x),e.normal.y>0?(i+=e.normal.y*this.min.y,o+=e.normal.y*this.max.y):(i+=e.normal.y*this.max.y,o+=e.normal.y*this.min.y),e.normal.z>0?(i+=e.normal.z*this.min.z,o+=e.normal.z*this.max.z):(i+=e.normal.z*this.max.z,o+=e.normal.z*this.min.z),i<=-e.constant&&o>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(pb),MS.subVectors(this.max,pb),Fv.subVectors(e.a,pb),Bv.subVectors(e.b,pb),Uv.subVectors(e.c,pb),Fp.subVectors(Bv,Fv),Bp.subVectors(Uv,Bv),zm.subVectors(Fv,Uv);let i=[0,-Fp.z,Fp.y,0,-Bp.z,Bp.y,0,-zm.z,zm.y,Fp.z,0,-Fp.x,Bp.z,0,-Bp.x,zm.z,0,-zm.x,-Fp.y,Fp.x,0,-Bp.y,Bp.x,0,-zm.y,zm.x,0];return!C4(i,Fv,Bv,Uv,MS)||(i=[1,0,0,0,1,0,0,0,1],!C4(i,Fv,Bv,Uv,MS))?!1:(TS.crossVectors(Fp,Bp),i=[TS.x,TS.y,TS.z],C4(i,Fv,Bv,Uv,MS))}clampPoint(e,i){return i.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,eu).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(eu).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(hh[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),hh[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),hh[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),hh[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),hh[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),hh[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),hh[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),hh[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(hh),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const hh=[new Ue,new Ue,new Ue,new Ue,new Ue,new Ue,new Ue,new Ue],eu=new Ue,ES=new _u,Fv=new Ue,Bv=new Ue,Uv=new Ue,Fp=new Ue,Bp=new Ue,zm=new Ue,pb=new Ue,MS=new Ue,TS=new Ue,Fm=new Ue;function C4(n,e,i,o,s){for(let l=0,d=n.length-3;l<=d;l+=3){Fm.fromArray(n,l);const p=s.x*Math.abs(Fm.x)+s.y*Math.abs(Fm.y)+s.z*Math.abs(Fm.z),f=e.dot(Fm),y=i.dot(Fm),_=o.dot(Fm);if(Math.max(-Math.max(f,y,_),Math.min(f,y,_))>p)return!1}return!0}const nbe=new _u,fb=new Ue,P4=new Ue;class Rc{constructor(e=new Ue,i=-1){this.center=e,this.radius=i}set(e,i){return this.center.copy(e),this.radius=i,this}setFromPoints(e,i){const o=this.center;i!==void 0?o.copy(i):nbe.setFromPoints(e).getCenter(o);let s=0;for(let l=0,d=e.length;l<d;l++)s=Math.max(s,o.distanceToSquared(e[l]));return this.radius=Math.sqrt(s),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const i=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=i*i}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,i){const o=this.center.distanceToSquared(e);return i.copy(e),o>this.radius*this.radius&&(i.sub(this.center).normalize(),i.multiplyScalar(this.radius).add(this.center)),i}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;fb.subVectors(e,this.center);const i=fb.lengthSq();if(i>this.radius*this.radius){const o=Math.sqrt(i),s=(o-this.radius)*.5;this.center.addScaledVector(fb,s/o),this.radius+=s}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(P4.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(fb.copy(e.center).add(P4)),this.expandByPoint(fb.copy(e.center).sub(P4))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}}const ph=new Ue,I4=new Ue,CS=new Ue,Up=new Ue,L4=new Ue,PS=new Ue,R4=new Ue;class Kg{constructor(e=new Ue,i=new Ue(0,0,-1)){this.origin=e,this.direction=i}set(e,i){return this.origin.copy(e),this.direction.copy(i),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,i){return i.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,ph)),this}closestPointToPoint(e,i){i.subVectors(e,this.origin);const o=i.dot(this.direction);return o<0?i.copy(this.origin):i.copy(this.origin).addScaledVector(this.direction,o)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const i=ph.subVectors(e,this.origin).dot(this.direction);return i<0?this.origin.distanceToSquared(e):(ph.copy(this.origin).addScaledVector(this.direction,i),ph.distanceToSquared(e))}distanceSqToSegment(e,i,o,s){I4.copy(e).add(i).multiplyScalar(.5),CS.copy(i).sub(e).normalize(),Up.copy(this.origin).sub(I4);const l=e.distanceTo(i)*.5,d=-this.direction.dot(CS),p=Up.dot(this.direction),f=-Up.dot(CS),y=Up.lengthSq(),_=Math.abs(1-d*d);let x,S,T,I;if(_>0)if(x=d*f-p,S=d*p-f,I=l*_,x>=0)if(S>=-I)if(S<=I){const R=1/_;x*=R,S*=R,T=x*(x+d*S+2*p)+S*(d*x+S+2*f)+y}else S=l,x=Math.max(0,-(d*S+p)),T=-x*x+S*(S+2*f)+y;else S=-l,x=Math.max(0,-(d*S+p)),T=-x*x+S*(S+2*f)+y;else S<=-I?(x=Math.max(0,-(-d*l+p)),S=x>0?-l:Math.min(Math.max(-l,-f),l),T=-x*x+S*(S+2*f)+y):S<=I?(x=0,S=Math.min(Math.max(-l,-f),l),T=S*(S+2*f)+y):(x=Math.max(0,-(d*l+p)),S=x>0?l:Math.min(Math.max(-l,-f),l),T=-x*x+S*(S+2*f)+y);else S=d>0?-l:l,x=Math.max(0,-(d*S+p)),T=-x*x+S*(S+2*f)+y;return o&&o.copy(this.origin).addScaledVector(this.direction,x),s&&s.copy(I4).addScaledVector(CS,S),T}intersectSphere(e,i){ph.subVectors(e.center,this.origin);const o=ph.dot(this.direction),s=ph.dot(ph)-o*o,l=e.radius*e.radius;if(s>l)return null;const d=Math.sqrt(l-s),p=o-d,f=o+d;return f<0?null:p<0?this.at(f,i):this.at(p,i)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const i=e.normal.dot(this.direction);if(i===0)return e.distanceToPoint(this.origin)===0?0:null;const o=-(this.origin.dot(e.normal)+e.constant)/i;return o>=0?o:null}intersectPlane(e,i){const o=this.distanceToPlane(e);return o===null?null:this.at(o,i)}intersectsPlane(e){const i=e.distanceToPoint(this.origin);return i===0||e.normal.dot(this.direction)*i<0}intersectBox(e,i){let o,s,l,d,p,f;const y=1/this.direction.x,_=1/this.direction.y,x=1/this.direction.z,S=this.origin;return y>=0?(o=(e.min.x-S.x)*y,s=(e.max.x-S.x)*y):(o=(e.max.x-S.x)*y,s=(e.min.x-S.x)*y),_>=0?(l=(e.min.y-S.y)*_,d=(e.max.y-S.y)*_):(l=(e.max.y-S.y)*_,d=(e.min.y-S.y)*_),o>d||l>s||((l>o||isNaN(o))&&(o=l),(d<s||isNaN(s))&&(s=d),x>=0?(p=(e.min.z-S.z)*x,f=(e.max.z-S.z)*x):(p=(e.max.z-S.z)*x,f=(e.min.z-S.z)*x),o>f||p>s)||((p>o||o!==o)&&(o=p),(f<s||s!==s)&&(s=f),s<0)?null:this.at(o>=0?o:s,i)}intersectsBox(e){return this.intersectBox(e,ph)!==null}intersectTriangle(e,i,o,s,l){L4.subVectors(i,e),PS.subVectors(o,e),R4.crossVectors(L4,PS);let d=this.direction.dot(R4),p;if(d>0){if(s)return null;p=1}else if(d<0)p=-1,d=-d;else return null;Up.subVectors(this.origin,e);const f=p*this.direction.dot(PS.crossVectors(Up,PS));if(f<0)return null;const y=p*this.direction.dot(L4.cross(Up));if(y<0||f+y>d)return null;const _=-p*Up.dot(R4);return _<0?null:this.at(_/d,l)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class Ri{constructor(e,i,o,s,l,d,p,f,y,_,x,S,T,I,R,D){Ri.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,i,o,s,l,d,p,f,y,_,x,S,T,I,R,D)}set(e,i,o,s,l,d,p,f,y,_,x,S,T,I,R,D){const L=this.elements;return L[0]=e,L[4]=i,L[8]=o,L[12]=s,L[1]=l,L[5]=d,L[9]=p,L[13]=f,L[2]=y,L[6]=_,L[10]=x,L[14]=S,L[3]=T,L[7]=I,L[11]=R,L[15]=D,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new Ri().fromArray(this.elements)}copy(e){const i=this.elements,o=e.elements;return i[0]=o[0],i[1]=o[1],i[2]=o[2],i[3]=o[3],i[4]=o[4],i[5]=o[5],i[6]=o[6],i[7]=o[7],i[8]=o[8],i[9]=o[9],i[10]=o[10],i[11]=o[11],i[12]=o[12],i[13]=o[13],i[14]=o[14],i[15]=o[15],this}copyPosition(e){const i=this.elements,o=e.elements;return i[12]=o[12],i[13]=o[13],i[14]=o[14],this}setFromMatrix3(e){const i=e.elements;return this.set(i[0],i[3],i[6],0,i[1],i[4],i[7],0,i[2],i[5],i[8],0,0,0,0,1),this}extractBasis(e,i,o){return e.setFromMatrixColumn(this,0),i.setFromMatrixColumn(this,1),o.setFromMatrixColumn(this,2),this}makeBasis(e,i,o){return this.set(e.x,i.x,o.x,0,e.y,i.y,o.y,0,e.z,i.z,o.z,0,0,0,0,1),this}extractRotation(e){const i=this.elements,o=e.elements,s=1/Wv.setFromMatrixColumn(e,0).length(),l=1/Wv.setFromMatrixColumn(e,1).length(),d=1/Wv.setFromMatrixColumn(e,2).length();return i[0]=o[0]*s,i[1]=o[1]*s,i[2]=o[2]*s,i[3]=0,i[4]=o[4]*l,i[5]=o[5]*l,i[6]=o[6]*l,i[7]=0,i[8]=o[8]*d,i[9]=o[9]*d,i[10]=o[10]*d,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,this}makeRotationFromEuler(e){const i=this.elements,o=e.x,s=e.y,l=e.z,d=Math.cos(o),p=Math.sin(o),f=Math.cos(s),y=Math.sin(s),_=Math.cos(l),x=Math.sin(l);if(e.order==="XYZ"){const S=d*_,T=d*x,I=p*_,R=p*x;i[0]=f*_,i[4]=-f*x,i[8]=y,i[1]=T+I*y,i[5]=S-R*y,i[9]=-p*f,i[2]=R-S*y,i[6]=I+T*y,i[10]=d*f}else if(e.order==="YXZ"){const S=f*_,T=f*x,I=y*_,R=y*x;i[0]=S+R*p,i[4]=I*p-T,i[8]=d*y,i[1]=d*x,i[5]=d*_,i[9]=-p,i[2]=T*p-I,i[6]=R+S*p,i[10]=d*f}else if(e.order==="ZXY"){const S=f*_,T=f*x,I=y*_,R=y*x;i[0]=S-R*p,i[4]=-d*x,i[8]=I+T*p,i[1]=T+I*p,i[5]=d*_,i[9]=R-S*p,i[2]=-d*y,i[6]=p,i[10]=d*f}else if(e.order==="ZYX"){const S=d*_,T=d*x,I=p*_,R=p*x;i[0]=f*_,i[4]=I*y-T,i[8]=S*y+R,i[1]=f*x,i[5]=R*y+S,i[9]=T*y-I,i[2]=-y,i[6]=p*f,i[10]=d*f}else if(e.order==="YZX"){const S=d*f,T=d*y,I=p*f,R=p*y;i[0]=f*_,i[4]=R-S*x,i[8]=I*x+T,i[1]=x,i[5]=d*_,i[9]=-p*_,i[2]=-y*_,i[6]=T*x+I,i[10]=S-R*x}else if(e.order==="XZY"){const S=d*f,T=d*y,I=p*f,R=p*y;i[0]=f*_,i[4]=-x,i[8]=y*_,i[1]=S*x+R,i[5]=d*_,i[9]=T*x-I,i[2]=I*x-T,i[6]=p*_,i[10]=R*x+S}return i[3]=0,i[7]=0,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,this}makeRotationFromQuaternion(e){return this.compose(ibe,e,abe)}lookAt(e,i,o){const s=this.elements;return Bl.subVectors(e,i),Bl.lengthSq()===0&&(Bl.z=1),Bl.normalize(),Wp.crossVectors(o,Bl),Wp.lengthSq()===0&&(Math.abs(o.z)===1?Bl.x+=1e-4:Bl.z+=1e-4,Bl.normalize(),Wp.crossVectors(o,Bl)),Wp.normalize(),IS.crossVectors(Bl,Wp),s[0]=Wp.x,s[4]=IS.x,s[8]=Bl.x,s[1]=Wp.y,s[5]=IS.y,s[9]=Bl.y,s[2]=Wp.z,s[6]=IS.z,s[10]=Bl.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,i){const o=e.elements,s=i.elements,l=this.elements,d=o[0],p=o[4],f=o[8],y=o[12],_=o[1],x=o[5],S=o[9],T=o[13],I=o[2],R=o[6],D=o[10],L=o[14],O=o[3],N=o[7],F=o[11],G=o[15],j=s[0],Y=s[4],te=s[8],V=s[12],Q=s[1],he=s[5],fe=s[9],ye=s[13],pe=s[2],Me=s[6],Ie=s[10],ze=s[14],le=s[3],me=s[7],xe=s[11],ae=s[15];return l[0]=d*j+p*Q+f*pe+y*le,l[4]=d*Y+p*he+f*Me+y*me,l[8]=d*te+p*fe+f*Ie+y*xe,l[12]=d*V+p*ye+f*ze+y*ae,l[1]=_*j+x*Q+S*pe+T*le,l[5]=_*Y+x*he+S*Me+T*me,l[9]=_*te+x*fe+S*Ie+T*xe,l[13]=_*V+x*ye+S*ze+T*ae,l[2]=I*j+R*Q+D*pe+L*le,l[6]=I*Y+R*he+D*Me+L*me,l[10]=I*te+R*fe+D*Ie+L*xe,l[14]=I*V+R*ye+D*ze+L*ae,l[3]=O*j+N*Q+F*pe+G*le,l[7]=O*Y+N*he+F*Me+G*me,l[11]=O*te+N*fe+F*Ie+G*xe,l[15]=O*V+N*ye+F*ze+G*ae,this}multiplyScalar(e){const i=this.elements;return i[0]*=e,i[4]*=e,i[8]*=e,i[12]*=e,i[1]*=e,i[5]*=e,i[9]*=e,i[13]*=e,i[2]*=e,i[6]*=e,i[10]*=e,i[14]*=e,i[3]*=e,i[7]*=e,i[11]*=e,i[15]*=e,this}determinant(){const e=this.elements,i=e[0],o=e[4],s=e[8],l=e[12],d=e[1],p=e[5],f=e[9],y=e[13],_=e[2],x=e[6],S=e[10],T=e[14],I=e[3],R=e[7],D=e[11],L=e[15];return I*(+l*f*x-s*y*x-l*p*S+o*y*S+s*p*T-o*f*T)+R*(+i*f*T-i*y*S+l*d*S-s*d*T+s*y*_-l*f*_)+D*(+i*y*x-i*p*T-l*d*x+o*d*T+l*p*_-o*y*_)+L*(-s*p*_-i*f*x+i*p*S+s*d*x-o*d*S+o*f*_)}transpose(){const e=this.elements;let i;return i=e[1],e[1]=e[4],e[4]=i,i=e[2],e[2]=e[8],e[8]=i,i=e[6],e[6]=e[9],e[9]=i,i=e[3],e[3]=e[12],e[12]=i,i=e[7],e[7]=e[13],e[13]=i,i=e[11],e[11]=e[14],e[14]=i,this}setPosition(e,i,o){const s=this.elements;return e.isVector3?(s[12]=e.x,s[13]=e.y,s[14]=e.z):(s[12]=e,s[13]=i,s[14]=o),this}invert(){const e=this.elements,i=e[0],o=e[1],s=e[2],l=e[3],d=e[4],p=e[5],f=e[6],y=e[7],_=e[8],x=e[9],S=e[10],T=e[11],I=e[12],R=e[13],D=e[14],L=e[15],O=x*D*y-R*S*y+R*f*T-p*D*T-x*f*L+p*S*L,N=I*S*y-_*D*y-I*f*T+d*D*T+_*f*L-d*S*L,F=_*R*y-I*x*y+I*p*T-d*R*T-_*p*L+d*x*L,G=I*x*f-_*R*f-I*p*S+d*R*S+_*p*D-d*x*D,j=i*O+o*N+s*F+l*G;if(j===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const Y=1/j;return e[0]=O*Y,e[1]=(R*S*l-x*D*l-R*s*T+o*D*T+x*s*L-o*S*L)*Y,e[2]=(p*D*l-R*f*l+R*s*y-o*D*y-p*s*L+o*f*L)*Y,e[3]=(x*f*l-p*S*l-x*s*y+o*S*y+p*s*T-o*f*T)*Y,e[4]=N*Y,e[5]=(_*D*l-I*S*l+I*s*T-i*D*T-_*s*L+i*S*L)*Y,e[6]=(I*f*l-d*D*l-I*s*y+i*D*y+d*s*L-i*f*L)*Y,e[7]=(d*S*l-_*f*l+_*s*y-i*S*y-d*s*T+i*f*T)*Y,e[8]=F*Y,e[9]=(I*x*l-_*R*l-I*o*T+i*R*T+_*o*L-i*x*L)*Y,e[10]=(d*R*l-I*p*l+I*o*y-i*R*y-d*o*L+i*p*L)*Y,e[11]=(_*p*l-d*x*l-_*o*y+i*x*y+d*o*T-i*p*T)*Y,e[12]=G*Y,e[13]=(_*R*s-I*x*s+I*o*S-i*R*S-_*o*D+i*x*D)*Y,e[14]=(I*p*s-d*R*s-I*o*f+i*R*f+d*o*D-i*p*D)*Y,e[15]=(d*x*s-_*p*s+_*o*f-i*x*f-d*o*S+i*p*S)*Y,this}scale(e){const i=this.elements,o=e.x,s=e.y,l=e.z;return i[0]*=o,i[4]*=s,i[8]*=l,i[1]*=o,i[5]*=s,i[9]*=l,i[2]*=o,i[6]*=s,i[10]*=l,i[3]*=o,i[7]*=s,i[11]*=l,this}getMaxScaleOnAxis(){const e=this.elements,i=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],o=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],s=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(i,o,s))}makeTranslation(e,i,o){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,i,0,0,1,o,0,0,0,1),this}makeRotationX(e){const i=Math.cos(e),o=Math.sin(e);return this.set(1,0,0,0,0,i,-o,0,0,o,i,0,0,0,0,1),this}makeRotationY(e){const i=Math.cos(e),o=Math.sin(e);return this.set(i,0,o,0,0,1,0,0,-o,0,i,0,0,0,0,1),this}makeRotationZ(e){const i=Math.cos(e),o=Math.sin(e);return this.set(i,-o,0,0,o,i,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,i){const o=Math.cos(i),s=Math.sin(i),l=1-o,d=e.x,p=e.y,f=e.z,y=l*d,_=l*p;return this.set(y*d+o,y*p-s*f,y*f+s*p,0,y*p+s*f,_*p+o,_*f-s*d,0,y*f-s*p,_*f+s*d,l*f*f+o,0,0,0,0,1),this}makeScale(e,i,o){return this.set(e,0,0,0,0,i,0,0,0,0,o,0,0,0,0,1),this}makeShear(e,i,o,s,l,d){return this.set(1,o,l,0,e,1,d,0,i,s,1,0,0,0,0,1),this}compose(e,i,o){const s=this.elements,l=i._x,d=i._y,p=i._z,f=i._w,y=l+l,_=d+d,x=p+p,S=l*y,T=l*_,I=l*x,R=d*_,D=d*x,L=p*x,O=f*y,N=f*_,F=f*x,G=o.x,j=o.y,Y=o.z;return s[0]=(1-(R+L))*G,s[1]=(T+F)*G,s[2]=(I-N)*G,s[3]=0,s[4]=(T-F)*j,s[5]=(1-(S+L))*j,s[6]=(D+O)*j,s[7]=0,s[8]=(I+N)*Y,s[9]=(D-O)*Y,s[10]=(1-(S+R))*Y,s[11]=0,s[12]=e.x,s[13]=e.y,s[14]=e.z,s[15]=1,this}decompose(e,i,o){const s=this.elements;let l=Wv.set(s[0],s[1],s[2]).length();const d=Wv.set(s[4],s[5],s[6]).length(),p=Wv.set(s[8],s[9],s[10]).length();this.determinant()<0&&(l=-l),e.x=s[12],e.y=s[13],e.z=s[14],tu.copy(this);const y=1/l,_=1/d,x=1/p;return tu.elements[0]*=y,tu.elements[1]*=y,tu.elements[2]*=y,tu.elements[4]*=_,tu.elements[5]*=_,tu.elements[6]*=_,tu.elements[8]*=x,tu.elements[9]*=x,tu.elements[10]*=x,i.setFromRotationMatrix(tu),o.x=l,o.y=d,o.z=p,this}makePerspective(e,i,o,s,l,d,p=dd){const f=this.elements,y=2*l/(i-e),_=2*l/(o-s),x=(i+e)/(i-e),S=(o+s)/(o-s);let T,I;if(p===dd)T=-(d+l)/(d-l),I=-2*d*l/(d-l);else if(p===hw)T=-d/(d-l),I=-d*l/(d-l);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+p);return f[0]=y,f[4]=0,f[8]=x,f[12]=0,f[1]=0,f[5]=_,f[9]=S,f[13]=0,f[2]=0,f[6]=0,f[10]=T,f[14]=I,f[3]=0,f[7]=0,f[11]=-1,f[15]=0,this}makeOrthographic(e,i,o,s,l,d,p=dd){const f=this.elements,y=1/(i-e),_=1/(o-s),x=1/(d-l),S=(i+e)*y,T=(o+s)*_;let I,R;if(p===dd)I=(d+l)*x,R=-2*x;else if(p===hw)I=l*x,R=-1*x;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+p);return f[0]=2*y,f[4]=0,f[8]=0,f[12]=-S,f[1]=0,f[5]=2*_,f[9]=0,f[13]=-T,f[2]=0,f[6]=0,f[10]=R,f[14]=-I,f[3]=0,f[7]=0,f[11]=0,f[15]=1,this}equals(e){const i=this.elements,o=e.elements;for(let s=0;s<16;s++)if(i[s]!==o[s])return!1;return!0}fromArray(e,i=0){for(let o=0;o<16;o++)this.elements[o]=e[o+i];return this}toArray(e=[],i=0){const o=this.elements;return e[i]=o[0],e[i+1]=o[1],e[i+2]=o[2],e[i+3]=o[3],e[i+4]=o[4],e[i+5]=o[5],e[i+6]=o[6],e[i+7]=o[7],e[i+8]=o[8],e[i+9]=o[9],e[i+10]=o[10],e[i+11]=o[11],e[i+12]=o[12],e[i+13]=o[13],e[i+14]=o[14],e[i+15]=o[15],e}}const Wv=new Ue,tu=new Ri,ibe=new Ue(0,0,0),abe=new Ue(1,1,1),Wp=new Ue,IS=new Ue,Bl=new Ue,wW=new Ri,SW=new As;class qw{constructor(e=0,i=0,o=0,s=qw.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=i,this._z=o,this._order=s}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,i,o,s=this._order){return this._x=e,this._y=i,this._z=o,this._order=s,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,i=this._order,o=!0){const s=e.elements,l=s[0],d=s[4],p=s[8],f=s[1],y=s[5],_=s[9],x=s[2],S=s[6],T=s[10];switch(i){case"XYZ":this._y=Math.asin(Yr(p,-1,1)),Math.abs(p)<.9999999?(this._x=Math.atan2(-_,T),this._z=Math.atan2(-d,l)):(this._x=Math.atan2(S,y),this._z=0);break;case"YXZ":this._x=Math.asin(-Yr(_,-1,1)),Math.abs(_)<.9999999?(this._y=Math.atan2(p,T),this._z=Math.atan2(f,y)):(this._y=Math.atan2(-x,l),this._z=0);break;case"ZXY":this._x=Math.asin(Yr(S,-1,1)),Math.abs(S)<.9999999?(this._y=Math.atan2(-x,T),this._z=Math.atan2(-d,y)):(this._y=0,this._z=Math.atan2(f,l));break;case"ZYX":this._y=Math.asin(-Yr(x,-1,1)),Math.abs(x)<.9999999?(this._x=Math.atan2(S,T),this._z=Math.atan2(f,l)):(this._x=0,this._z=Math.atan2(-d,y));break;case"YZX":this._z=Math.asin(Yr(f,-1,1)),Math.abs(f)<.9999999?(this._x=Math.atan2(-_,y),this._y=Math.atan2(-x,l)):(this._x=0,this._y=Math.atan2(p,T));break;case"XZY":this._z=Math.asin(-Yr(d,-1,1)),Math.abs(d)<.9999999?(this._x=Math.atan2(S,y),this._y=Math.atan2(p,l)):(this._x=Math.atan2(-_,T),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+i)}return this._order=i,o===!0&&this._onChangeCallback(),this}setFromQuaternion(e,i,o){return wW.makeRotationFromQuaternion(e),this.setFromRotationMatrix(wW,i,o)}setFromVector3(e,i=this._order){return this.set(e.x,e.y,e.z,i)}reorder(e){return SW.setFromEuler(this),this.setFromQuaternion(SW,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],i=0){return e[i]=this._x,e[i+1]=this._y,e[i+2]=this._z,e[i+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}qw.DEFAULT_ORDER="XYZ";class Eg{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let rbe=0;const AW=new Ue,Vv=new As,fh=new Ri,LS=new Ue,mb=new Ue,obe=new Ue,sbe=new As,EW=new Ue(1,0,0),MW=new Ue(0,1,0),TW=new Ue(0,0,1),lbe={type:"added"},cbe={type:"removed"};class va extends Td{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:rbe++}),this.uuid=Zl(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=va.DEFAULT_UP.clone();const e=new Ue,i=new qw,o=new As,s=new Ue(1,1,1);function l(){o.setFromEuler(i,!1)}function d(){i.setFromQuaternion(o,void 0,!1)}i._onChange(l),o._onChange(d),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:i},quaternion:{configurable:!0,enumerable:!0,value:o},scale:{configurable:!0,enumerable:!0,value:s},modelViewMatrix:{value:new Ri},normalMatrix:{value:new Ui}}),this.matrix=new Ri,this.matrixWorld=new Ri,this.matrixAutoUpdate=va.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.matrixWorldAutoUpdate=va.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.layers=new Eg,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,i){this.quaternion.setFromAxisAngle(e,i)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,i){return Vv.setFromAxisAngle(e,i),this.quaternion.multiply(Vv),this}rotateOnWorldAxis(e,i){return Vv.setFromAxisAngle(e,i),this.quaternion.premultiply(Vv),this}rotateX(e){return this.rotateOnAxis(EW,e)}rotateY(e){return this.rotateOnAxis(MW,e)}rotateZ(e){return this.rotateOnAxis(TW,e)}translateOnAxis(e,i){return AW.copy(e).applyQuaternion(this.quaternion),this.position.add(AW.multiplyScalar(i)),this}translateX(e){return this.translateOnAxis(EW,e)}translateY(e){return this.translateOnAxis(MW,e)}translateZ(e){return this.translateOnAxis(TW,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(fh.copy(this.matrixWorld).invert())}lookAt(e,i,o){e.isVector3?LS.copy(e):LS.set(e,i,o);const s=this.parent;this.updateWorldMatrix(!0,!1),mb.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?fh.lookAt(mb,LS,this.up):fh.lookAt(LS,mb,this.up),this.quaternion.setFromRotationMatrix(fh),s&&(fh.extractRotation(s.matrixWorld),Vv.setFromRotationMatrix(fh),this.quaternion.premultiply(Vv.invert()))}add(e){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.add(arguments[i]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.parent!==null&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(lbe)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let o=0;o<arguments.length;o++)this.remove(arguments[o]);return this}const i=this.children.indexOf(e);return i!==-1&&(e.parent=null,this.children.splice(i,1),e.dispatchEvent(cbe)),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),fh.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),fh.multiply(e.parent.matrixWorld)),e.applyMatrix4(fh),this.add(e),e.updateWorldMatrix(!1,!0),this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,i){if(this[e]===i)return this;for(let o=0,s=this.children.length;o<s;o++){const d=this.children[o].getObjectByProperty(e,i);if(d!==void 0)return d}}getObjectsByProperty(e,i){let o=[];this[e]===i&&o.push(this);for(let s=0,l=this.children.length;s<l;s++){const d=this.children[s].getObjectsByProperty(e,i);d.length>0&&(o=o.concat(d))}return o}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(mb,e,obe),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(mb,sbe,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const i=this.matrixWorld.elements;return e.set(i[8],i[9],i[10]).normalize()}raycast(){}traverse(e){e(this);const i=this.children;for(let o=0,s=i.length;o<s;o++)i[o].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const i=this.children;for(let o=0,s=i.length;o<s;o++)i[o].traverseVisible(e)}traverseAncestors(e){const i=this.parent;i!==null&&(e(i),i.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);const i=this.children;for(let o=0,s=i.length;o<s;o++){const l=i[o];(l.matrixWorldAutoUpdate===!0||e===!0)&&l.updateMatrixWorld(e)}}updateWorldMatrix(e,i){const o=this.parent;if(e===!0&&o!==null&&o.matrixWorldAutoUpdate===!0&&o.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),i===!0){const s=this.children;for(let l=0,d=s.length;l<d;l++){const p=s[l];p.matrixWorldAutoUpdate===!0&&p.updateWorldMatrix(!1,!0)}}}toJSON(e){const i=e===void 0||typeof e=="string",o={};i&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},o.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const s={};s.uuid=this.uuid,s.type=this.type,this.name!==""&&(s.name=this.name),this.castShadow===!0&&(s.castShadow=!0),this.receiveShadow===!0&&(s.receiveShadow=!0),this.visible===!1&&(s.visible=!1),this.frustumCulled===!1&&(s.frustumCulled=!1),this.renderOrder!==0&&(s.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(s.userData=this.userData),s.layers=this.layers.mask,s.matrix=this.matrix.toArray(),s.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(s.matrixAutoUpdate=!1),this.isInstancedMesh&&(s.type="InstancedMesh",s.count=this.count,s.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(s.instanceColor=this.instanceColor.toJSON()));function l(p,f){return p[f.uuid]===void 0&&(p[f.uuid]=f.toJSON(e)),f.uuid}if(this.isScene)this.background&&(this.background.isColor?s.background=this.background.toJSON():this.background.isTexture&&(s.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(s.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){s.geometry=l(e.geometries,this.geometry);const p=this.geometry.parameters;if(p!==void 0&&p.shapes!==void 0){const f=p.shapes;if(Array.isArray(f))for(let y=0,_=f.length;y<_;y++){const x=f[y];l(e.shapes,x)}else l(e.shapes,f)}}if(this.isSkinnedMesh&&(s.bindMode=this.bindMode,s.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(l(e.skeletons,this.skeleton),s.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const p=[];for(let f=0,y=this.material.length;f<y;f++)p.push(l(e.materials,this.material[f]));s.material=p}else s.material=l(e.materials,this.material);if(this.children.length>0){s.children=[];for(let p=0;p<this.children.length;p++)s.children.push(this.children[p].toJSON(e).object)}if(this.animations.length>0){s.animations=[];for(let p=0;p<this.animations.length;p++){const f=this.animations[p];s.animations.push(l(e.animations,f))}}if(i){const p=d(e.geometries),f=d(e.materials),y=d(e.textures),_=d(e.images),x=d(e.shapes),S=d(e.skeletons),T=d(e.animations),I=d(e.nodes);p.length>0&&(o.geometries=p),f.length>0&&(o.materials=f),y.length>0&&(o.textures=y),_.length>0&&(o.images=_),x.length>0&&(o.shapes=x),S.length>0&&(o.skeletons=S),T.length>0&&(o.animations=T),I.length>0&&(o.nodes=I)}return o.object=s,o;function d(p){const f=[];for(const y in p){const _=p[y];delete _.metadata,f.push(_)}return f}}clone(e){return new this.constructor().copy(this,e)}copy(e,i=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),i===!0)for(let o=0;o<e.children.length;o++){const s=e.children[o];this.add(s.clone())}return this}}va.DEFAULT_UP=new Ue(0,1,0);va.DEFAULT_MATRIX_AUTO_UPDATE=!0;va.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const nu=new Ue,mh=new Ue,k4=new Ue,gh=new Ue,Gv=new Ue,Hv=new Ue,CW=new Ue,D4=new Ue,O4=new Ue,N4=new Ue;let RS=!1;class fl{constructor(e=new Ue,i=new Ue,o=new Ue){this.a=e,this.b=i,this.c=o}static getNormal(e,i,o,s){s.subVectors(o,i),nu.subVectors(e,i),s.cross(nu);const l=s.lengthSq();return l>0?s.multiplyScalar(1/Math.sqrt(l)):s.set(0,0,0)}static getBarycoord(e,i,o,s,l){nu.subVectors(s,i),mh.subVectors(o,i),k4.subVectors(e,i);const d=nu.dot(nu),p=nu.dot(mh),f=nu.dot(k4),y=mh.dot(mh),_=mh.dot(k4),x=d*y-p*p;if(x===0)return l.set(-2,-1,-1);const S=1/x,T=(y*f-p*_)*S,I=(d*_-p*f)*S;return l.set(1-T-I,I,T)}static containsPoint(e,i,o,s){return this.getBarycoord(e,i,o,s,gh),gh.x>=0&&gh.y>=0&&gh.x+gh.y<=1}static getUV(e,i,o,s,l,d,p,f){return RS===!1&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),RS=!0),this.getInterpolation(e,i,o,s,l,d,p,f)}static getInterpolation(e,i,o,s,l,d,p,f){return this.getBarycoord(e,i,o,s,gh),f.setScalar(0),f.addScaledVector(l,gh.x),f.addScaledVector(d,gh.y),f.addScaledVector(p,gh.z),f}static isFrontFacing(e,i,o,s){return nu.subVectors(o,i),mh.subVectors(e,i),nu.cross(mh).dot(s)<0}set(e,i,o){return this.a.copy(e),this.b.copy(i),this.c.copy(o),this}setFromPointsAndIndices(e,i,o,s){return this.a.copy(e[i]),this.b.copy(e[o]),this.c.copy(e[s]),this}setFromAttributeAndIndices(e,i,o,s){return this.a.fromBufferAttribute(e,i),this.b.fromBufferAttribute(e,o),this.c.fromBufferAttribute(e,s),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return nu.subVectors(this.c,this.b),mh.subVectors(this.a,this.b),nu.cross(mh).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return fl.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,i){return fl.getBarycoord(e,this.a,this.b,this.c,i)}getUV(e,i,o,s,l){return RS===!1&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),RS=!0),fl.getInterpolation(e,this.a,this.b,this.c,i,o,s,l)}getInterpolation(e,i,o,s,l){return fl.getInterpolation(e,this.a,this.b,this.c,i,o,s,l)}containsPoint(e){return fl.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return fl.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,i){const o=this.a,s=this.b,l=this.c;let d,p;Gv.subVectors(s,o),Hv.subVectors(l,o),D4.subVectors(e,o);const f=Gv.dot(D4),y=Hv.dot(D4);if(f<=0&&y<=0)return i.copy(o);O4.subVectors(e,s);const _=Gv.dot(O4),x=Hv.dot(O4);if(_>=0&&x<=_)return i.copy(s);const S=f*x-_*y;if(S<=0&&f>=0&&_<=0)return d=f/(f-_),i.copy(o).addScaledVector(Gv,d);N4.subVectors(e,l);const T=Gv.dot(N4),I=Hv.dot(N4);if(I>=0&&T<=I)return i.copy(l);const R=T*y-f*I;if(R<=0&&y>=0&&I<=0)return p=y/(y-I),i.copy(o).addScaledVector(Hv,p);const D=_*I-T*x;if(D<=0&&x-_>=0&&T-I>=0)return CW.subVectors(l,s),p=(x-_)/(x-_+(T-I)),i.copy(s).addScaledVector(CW,p);const L=1/(D+R+S);return d=R*L,p=S*L,i.copy(o).addScaledVector(Gv,d).addScaledVector(Hv,p)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}const QX={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Vp={h:0,s:0,l:0},kS={h:0,s:0,l:0};function z4(n,e,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?n+(e-n)*6*i:i<1/2?e:i<2/3?n+(e-n)*6*(2/3-i):n}let Pn=class{constructor(e,i,o){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,i,o)}set(e,i,o){if(i===void 0&&o===void 0){const s=e;s&&s.isColor?this.copy(s):typeof s=="number"?this.setHex(s):typeof s=="string"&&this.setStyle(s)}else this.setRGB(e,i,o);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,i=Io){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,Ba.toWorkingColorSpace(this,i),this}setRGB(e,i,o,s=Ba.workingColorSpace){return this.r=e,this.g=i,this.b=o,Ba.toWorkingColorSpace(this,s),this}setHSL(e,i,o,s=Ba.workingColorSpace){if(e=u6(e,1),i=Yr(i,0,1),o=Yr(o,0,1),i===0)this.r=this.g=this.b=o;else{const l=o<=.5?o*(1+i):o+i-o*i,d=2*o-l;this.r=z4(d,l,e+1/3),this.g=z4(d,l,e),this.b=z4(d,l,e-1/3)}return Ba.toWorkingColorSpace(this,s),this}setStyle(e,i=Io){function o(l){l!==void 0&&parseFloat(l)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let s;if(s=/^(\w+)\(([^\)]*)\)/.exec(e)){let l;const d=s[1],p=s[2];switch(d){case"rgb":case"rgba":if(l=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(p))return o(l[4]),this.setRGB(Math.min(255,parseInt(l[1],10))/255,Math.min(255,parseInt(l[2],10))/255,Math.min(255,parseInt(l[3],10))/255,i);if(l=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(p))return o(l[4]),this.setRGB(Math.min(100,parseInt(l[1],10))/100,Math.min(100,parseInt(l[2],10))/100,Math.min(100,parseInt(l[3],10))/100,i);break;case"hsl":case"hsla":if(l=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(p))return o(l[4]),this.setHSL(parseFloat(l[1])/360,parseFloat(l[2])/100,parseFloat(l[3])/100,i);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(s=/^\#([A-Fa-f\d]+)$/.exec(e)){const l=s[1],d=l.length;if(d===3)return this.setRGB(parseInt(l.charAt(0),16)/15,parseInt(l.charAt(1),16)/15,parseInt(l.charAt(2),16)/15,i);if(d===6)return this.setHex(parseInt(l,16),i);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,i);return this}setColorName(e,i=Io){const o=QX[e.toLowerCase()];return o!==void 0?this.setHex(o,i):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=G0(e.r),this.g=G0(e.g),this.b=G0(e.b),this}copyLinearToSRGB(e){return this.r=E4(e.r),this.g=E4(e.g),this.b=E4(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=Io){return Ba.fromWorkingColorSpace(ms.copy(this),e),Math.round(Yr(ms.r*255,0,255))*65536+Math.round(Yr(ms.g*255,0,255))*256+Math.round(Yr(ms.b*255,0,255))}getHexString(e=Io){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,i=Ba.workingColorSpace){Ba.fromWorkingColorSpace(ms.copy(this),i);const o=ms.r,s=ms.g,l=ms.b,d=Math.max(o,s,l),p=Math.min(o,s,l);let f,y;const _=(p+d)/2;if(p===d)f=0,y=0;else{const x=d-p;switch(y=_<=.5?x/(d+p):x/(2-d-p),d){case o:f=(s-l)/x+(s<l?6:0);break;case s:f=(l-o)/x+2;break;case l:f=(o-s)/x+4;break}f/=6}return e.h=f,e.s=y,e.l=_,e}getRGB(e,i=Ba.workingColorSpace){return Ba.fromWorkingColorSpace(ms.copy(this),i),e.r=ms.r,e.g=ms.g,e.b=ms.b,e}getStyle(e=Io){Ba.fromWorkingColorSpace(ms.copy(this),e);const i=ms.r,o=ms.g,s=ms.b;return e!==Io?`color(${e} ${i.toFixed(3)} ${o.toFixed(3)} ${s.toFixed(3)})`:`rgb(${Math.round(i*255)},${Math.round(o*255)},${Math.round(s*255)})`}offsetHSL(e,i,o){return this.getHSL(Vp),this.setHSL(Vp.h+e,Vp.s+i,Vp.l+o)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,i){return this.r=e.r+i.r,this.g=e.g+i.g,this.b=e.b+i.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,i){return this.r+=(e.r-this.r)*i,this.g+=(e.g-this.g)*i,this.b+=(e.b-this.b)*i,this}lerpColors(e,i,o){return this.r=e.r+(i.r-e.r)*o,this.g=e.g+(i.g-e.g)*o,this.b=e.b+(i.b-e.b)*o,this}lerpHSL(e,i){this.getHSL(Vp),e.getHSL(kS);const o=fx(Vp.h,kS.h,i),s=fx(Vp.s,kS.s,i),l=fx(Vp.l,kS.l,i);return this.setHSL(o,s,l),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const i=this.r,o=this.g,s=this.b,l=e.elements;return this.r=l[0]*i+l[3]*o+l[6]*s,this.g=l[1]*i+l[4]*o+l[7]*s,this.b=l[2]*i+l[5]*o+l[8]*s,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,i=0){return this.r=e[i],this.g=e[i+1],this.b=e[i+2],this}toArray(e=[],i=0){return e[i]=this.r,e[i+1]=this.g,e[i+2]=this.b,e}fromBufferAttribute(e,i){return this.r=e.getX(i),this.g=e.getY(i),this.b=e.getZ(i),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}};const ms=new Pn;Pn.NAMES=QX;let ube=0;class es extends Td{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:ube++}),this.uuid=Zl(),this.name="",this.type="Material",this.blending=Sg,this.side=wd,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=rM,this.blendDst=oM,this.blendEquation=Zp,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new Pn(0,0,0),this.blendAlpha=0,this.depthFunc=ew,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=CR,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=ig,this.stencilZFail=ig,this.stencilZPass=ig,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const i in e){const o=e[i];if(o===void 0){console.warn(`THREE.Material: parameter '${i}' has value of undefined.`);continue}const s=this[i];if(s===void 0){console.warn(`THREE.Material: '${i}' is not a property of THREE.${this.type}.`);continue}s&&s.isColor?s.set(o):s&&s.isVector3&&o&&o.isVector3?s.copy(o):this[i]=o}}toJSON(e){const i=e===void 0||typeof e=="string";i&&(e={textures:{},images:{}});const o={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};o.uuid=this.uuid,o.type=this.type,this.name!==""&&(o.name=this.name),this.color&&this.color.isColor&&(o.color=this.color.getHex()),this.roughness!==void 0&&(o.roughness=this.roughness),this.metalness!==void 0&&(o.metalness=this.metalness),this.sheen!==void 0&&(o.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(o.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(o.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(o.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(o.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(o.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(o.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(o.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(o.shininess=this.shininess),this.clearcoat!==void 0&&(o.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(o.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(o.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(o.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(o.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,o.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.iridescence!==void 0&&(o.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(o.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(o.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(o.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(o.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(o.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(o.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(o.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(o.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(o.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(o.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(o.lightMap=this.lightMap.toJSON(e).uuid,o.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(o.aoMap=this.aoMap.toJSON(e).uuid,o.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(o.bumpMap=this.bumpMap.toJSON(e).uuid,o.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(o.normalMap=this.normalMap.toJSON(e).uuid,o.normalMapType=this.normalMapType,o.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(o.displacementMap=this.displacementMap.toJSON(e).uuid,o.displacementScale=this.displacementScale,o.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(o.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(o.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(o.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(o.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(o.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(o.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(o.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(o.combine=this.combine)),this.envMapIntensity!==void 0&&(o.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(o.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(o.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(o.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(o.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(o.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(o.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(o.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(o.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(o.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(o.size=this.size),this.shadowSide!==null&&(o.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(o.sizeAttenuation=this.sizeAttenuation),this.blending!==Sg&&(o.blending=this.blending),this.side!==wd&&(o.side=this.side),this.vertexColors===!0&&(o.vertexColors=!0),this.opacity<1&&(o.opacity=this.opacity),this.transparent===!0&&(o.transparent=!0),this.blendSrc!==rM&&(o.blendSrc=this.blendSrc),this.blendDst!==oM&&(o.blendDst=this.blendDst),this.blendEquation!==Zp&&(o.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(o.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(o.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(o.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(o.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(o.blendAlpha=this.blendAlpha),this.depthFunc!==ew&&(o.depthFunc=this.depthFunc),this.depthTest===!1&&(o.depthTest=this.depthTest),this.depthWrite===!1&&(o.depthWrite=this.depthWrite),this.colorWrite===!1&&(o.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(o.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==CR&&(o.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(o.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(o.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==ig&&(o.stencilFail=this.stencilFail),this.stencilZFail!==ig&&(o.stencilZFail=this.stencilZFail),this.stencilZPass!==ig&&(o.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(o.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(o.rotation=this.rotation),this.polygonOffset===!0&&(o.polygonOffset=!0),this.polygonOffsetFactor!==0&&(o.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(o.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(o.linewidth=this.linewidth),this.dashSize!==void 0&&(o.dashSize=this.dashSize),this.gapSize!==void 0&&(o.gapSize=this.gapSize),this.scale!==void 0&&(o.scale=this.scale),this.dithering===!0&&(o.dithering=!0),this.alphaTest>0&&(o.alphaTest=this.alphaTest),this.alphaHash===!0&&(o.alphaHash=!0),this.alphaToCoverage===!0&&(o.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(o.premultipliedAlpha=!0),this.forceSinglePass===!0&&(o.forceSinglePass=!0),this.wireframe===!0&&(o.wireframe=!0),this.wireframeLinewidth>1&&(o.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(o.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(o.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(o.flatShading=!0),this.visible===!1&&(o.visible=!1),this.toneMapped===!1&&(o.toneMapped=!1),this.fog===!1&&(o.fog=!1),Object.keys(this.userData).length>0&&(o.userData=this.userData);function s(l){const d=[];for(const p in l){const f=l[p];delete f.metadata,d.push(f)}return d}if(i){const l=s(e.textures),d=s(e.images);l.length>0&&(o.textures=l),d.length>0&&(o.images=d)}return o}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const i=e.clippingPlanes;let o=null;if(i!==null){const s=i.length;o=new Array(s);for(let l=0;l!==s;++l)o[l]=i[l].clone()}return this.clippingPlanes=o,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}}class qh extends es{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Pn(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=$w,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const Th=dbe();function dbe(){const n=new ArrayBuffer(4),e=new Float32Array(n),i=new Uint32Array(n),o=new Uint32Array(512),s=new Uint32Array(512);for(let f=0;f<256;++f){const y=f-127;y<-27?(o[f]=0,o[f|256]=32768,s[f]=24,s[f|256]=24):y<-14?(o[f]=1024>>-y-14,o[f|256]=1024>>-y-14|32768,s[f]=-y-1,s[f|256]=-y-1):y<=15?(o[f]=y+15<<10,o[f|256]=y+15<<10|32768,s[f]=13,s[f|256]=13):y<128?(o[f]=31744,o[f|256]=64512,s[f]=24,s[f|256]=24):(o[f]=31744,o[f|256]=64512,s[f]=13,s[f|256]=13)}const l=new Uint32Array(2048),d=new Uint32Array(64),p=new Uint32Array(64);for(let f=1;f<1024;++f){let y=f<<13,_=0;for(;!(y&8388608);)y<<=1,_-=8388608;y&=-8388609,_+=947912704,l[f]=y|_}for(let f=1024;f<2048;++f)l[f]=939524096+(f-1024<<13);for(let f=1;f<31;++f)d[f]=f<<23;d[31]=1199570944,d[32]=2147483648;for(let f=33;f<63;++f)d[f]=2147483648+(f-32<<23);d[63]=3347054592;for(let f=1;f<64;++f)f!==32&&(p[f]=1024);return{floatView:e,uint32View:i,baseTable:o,shiftTable:s,mantissaTable:l,exponentTable:d,offsetTable:p}}function hl(n){Math.abs(n)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),n=Yr(n,-65504,65504),Th.floatView[0]=n;const e=Th.uint32View[0],i=e>>23&511;return Th.baseTable[i]+((e&8388607)>>Th.shiftTable[i])}function Wb(n){const e=n>>10;return Th.uint32View[0]=Th.mantissaTable[Th.offsetTable[e]+(n&1023)]+Th.exponentTable[e],Th.floatView[0]}const hbe={toHalfFloat:hl,fromHalfFloat:Wb},_o=new Ue,DS=new tn;class Za{constructor(e,i,o=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=i,this.count=e!==void 0?e.length/i:0,this.normalized=o,this.usage=dw,this.updateRange={offset:0,count:-1},this.gpuType=ud,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,i,o){e*=this.itemSize,o*=i.itemSize;for(let s=0,l=this.itemSize;s<l;s++)this.array[e+s]=i.array[o+s];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let i=0,o=this.count;i<o;i++)DS.fromBufferAttribute(this,i),DS.applyMatrix3(e),this.setXY(i,DS.x,DS.y);else if(this.itemSize===3)for(let i=0,o=this.count;i<o;i++)_o.fromBufferAttribute(this,i),_o.applyMatrix3(e),this.setXYZ(i,_o.x,_o.y,_o.z);return this}applyMatrix4(e){for(let i=0,o=this.count;i<o;i++)_o.fromBufferAttribute(this,i),_o.applyMatrix4(e),this.setXYZ(i,_o.x,_o.y,_o.z);return this}applyNormalMatrix(e){for(let i=0,o=this.count;i<o;i++)_o.fromBufferAttribute(this,i),_o.applyNormalMatrix(e),this.setXYZ(i,_o.x,_o.y,_o.z);return this}transformDirection(e){for(let i=0,o=this.count;i<o;i++)_o.fromBufferAttribute(this,i),_o.transformDirection(e),this.setXYZ(i,_o.x,_o.y,_o.z);return this}set(e,i=0){return this.array.set(e,i),this}getComponent(e,i){let o=this.array[e*this.itemSize+i];return this.normalized&&(o=gl(o,this.array)),o}setComponent(e,i,o){return this.normalized&&(o=Wi(o,this.array)),this.array[e*this.itemSize+i]=o,this}getX(e){let i=this.array[e*this.itemSize];return this.normalized&&(i=gl(i,this.array)),i}setX(e,i){return this.normalized&&(i=Wi(i,this.array)),this.array[e*this.itemSize]=i,this}getY(e){let i=this.array[e*this.itemSize+1];return this.normalized&&(i=gl(i,this.array)),i}setY(e,i){return this.normalized&&(i=Wi(i,this.array)),this.array[e*this.itemSize+1]=i,this}getZ(e){let i=this.array[e*this.itemSize+2];return this.normalized&&(i=gl(i,this.array)),i}setZ(e,i){return this.normalized&&(i=Wi(i,this.array)),this.array[e*this.itemSize+2]=i,this}getW(e){let i=this.array[e*this.itemSize+3];return this.normalized&&(i=gl(i,this.array)),i}setW(e,i){return this.normalized&&(i=Wi(i,this.array)),this.array[e*this.itemSize+3]=i,this}setXY(e,i,o){return e*=this.itemSize,this.normalized&&(i=Wi(i,this.array),o=Wi(o,this.array)),this.array[e+0]=i,this.array[e+1]=o,this}setXYZ(e,i,o,s){return e*=this.itemSize,this.normalized&&(i=Wi(i,this.array),o=Wi(o,this.array),s=Wi(s,this.array)),this.array[e+0]=i,this.array[e+1]=o,this.array[e+2]=s,this}setXYZW(e,i,o,s,l){return e*=this.itemSize,this.normalized&&(i=Wi(i,this.array),o=Wi(o,this.array),s=Wi(s,this.array),l=Wi(l,this.array)),this.array[e+0]=i,this.array[e+1]=o,this.array[e+2]=s,this.array[e+3]=l,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==dw&&(e.usage=this.usage),(this.updateRange.offset!==0||this.updateRange.count!==-1)&&(e.updateRange=this.updateRange),e}}class pbe extends Za{constructor(e,i,o){super(new Int8Array(e),i,o)}}class fbe extends Za{constructor(e,i,o){super(new Uint8Array(e),i,o)}}class mbe extends Za{constructor(e,i,o){super(new Uint8ClampedArray(e),i,o)}}class gbe extends Za{constructor(e,i,o){super(new Int16Array(e),i,o)}}class p6 extends Za{constructor(e,i,o){super(new Uint16Array(e),i,o)}}class ybe extends Za{constructor(e,i,o){super(new Int32Array(e),i,o)}}class f6 extends Za{constructor(e,i,o){super(new Uint32Array(e),i,o)}}class vbe extends Za{constructor(e,i,o){super(new Uint16Array(e),i,o),this.isFloat16BufferAttribute=!0}getX(e){let i=Wb(this.array[e*this.itemSize]);return this.normalized&&(i=gl(i,this.array)),i}setX(e,i){return this.normalized&&(i=Wi(i,this.array)),this.array[e*this.itemSize]=hl(i),this}getY(e){let i=Wb(this.array[e*this.itemSize+1]);return this.normalized&&(i=gl(i,this.array)),i}setY(e,i){return this.normalized&&(i=Wi(i,this.array)),this.array[e*this.itemSize+1]=hl(i),this}getZ(e){let i=Wb(this.array[e*this.itemSize+2]);return this.normalized&&(i=gl(i,this.array)),i}setZ(e,i){return this.normalized&&(i=Wi(i,this.array)),this.array[e*this.itemSize+2]=hl(i),this}getW(e){let i=Wb(this.array[e*this.itemSize+3]);return this.normalized&&(i=gl(i,this.array)),i}setW(e,i){return this.normalized&&(i=Wi(i,this.array)),this.array[e*this.itemSize+3]=hl(i),this}setXY(e,i,o){return e*=this.itemSize,this.normalized&&(i=Wi(i,this.array),o=Wi(o,this.array)),this.array[e+0]=hl(i),this.array[e+1]=hl(o),this}setXYZ(e,i,o,s){return e*=this.itemSize,this.normalized&&(i=Wi(i,this.array),o=Wi(o,this.array),s=Wi(s,this.array)),this.array[e+0]=hl(i),this.array[e+1]=hl(o),this.array[e+2]=hl(s),this}setXYZW(e,i,o,s,l){return e*=this.itemSize,this.normalized&&(i=Wi(i,this.array),o=Wi(o,this.array),s=Wi(s,this.array),l=Wi(l,this.array)),this.array[e+0]=hl(i),this.array[e+1]=hl(o),this.array[e+2]=hl(s),this.array[e+3]=hl(l),this}}class Gn extends Za{constructor(e,i,o){super(new Float32Array(e),i,o)}}class _be extends Za{constructor(e,i,o){super(new Float64Array(e),i,o)}}let bbe=0;const vc=new Ri,F4=new va,jv=new Ue,Ul=new _u,gb=new _u,Fo=new Ue;class ki extends Td{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:bbe++}),this.uuid=Zl(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(ZX(e)?f6:p6)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,i){return this.attributes[e]=i,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,i,o=0){this.groups.push({start:e,count:i,materialIndex:o})}clearGroups(){this.groups=[]}setDrawRange(e,i){this.drawRange.start=e,this.drawRange.count=i}applyMatrix4(e){const i=this.attributes.position;i!==void 0&&(i.applyMatrix4(e),i.needsUpdate=!0);const o=this.attributes.normal;if(o!==void 0){const l=new Ui().getNormalMatrix(e);o.applyNormalMatrix(l),o.needsUpdate=!0}const s=this.attributes.tangent;return s!==void 0&&(s.transformDirection(e),s.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return vc.makeRotationFromQuaternion(e),this.applyMatrix4(vc),this}rotateX(e){return vc.makeRotationX(e),this.applyMatrix4(vc),this}rotateY(e){return vc.makeRotationY(e),this.applyMatrix4(vc),this}rotateZ(e){return vc.makeRotationZ(e),this.applyMatrix4(vc),this}translate(e,i,o){return vc.makeTranslation(e,i,o),this.applyMatrix4(vc),this}scale(e,i,o){return vc.makeScale(e,i,o),this.applyMatrix4(vc),this}lookAt(e){return F4.lookAt(e),F4.updateMatrix(),this.applyMatrix4(F4.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(jv).negate(),this.translate(jv.x,jv.y,jv.z),this}setFromPoints(e){const i=[];for(let o=0,s=e.length;o<s;o++){const l=e[o];i.push(l.x,l.y,l.z||0)}return this.setAttribute("position",new Gn(i,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new _u);const e=this.attributes.position,i=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new Ue(-1/0,-1/0,-1/0),new Ue(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),i)for(let o=0,s=i.length;o<s;o++){const l=i[o];Ul.setFromBufferAttribute(l),this.morphTargetsRelative?(Fo.addVectors(this.boundingBox.min,Ul.min),this.boundingBox.expandByPoint(Fo),Fo.addVectors(this.boundingBox.max,Ul.max),this.boundingBox.expandByPoint(Fo)):(this.boundingBox.expandByPoint(Ul.min),this.boundingBox.expandByPoint(Ul.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Rc);const e=this.attributes.position,i=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingSphere.set(new Ue,1/0);return}if(e){const o=this.boundingSphere.center;if(Ul.setFromBufferAttribute(e),i)for(let l=0,d=i.length;l<d;l++){const p=i[l];gb.setFromBufferAttribute(p),this.morphTargetsRelative?(Fo.addVectors(Ul.min,gb.min),Ul.expandByPoint(Fo),Fo.addVectors(Ul.max,gb.max),Ul.expandByPoint(Fo)):(Ul.expandByPoint(gb.min),Ul.expandByPoint(gb.max))}Ul.getCenter(o);let s=0;for(let l=0,d=e.count;l<d;l++)Fo.fromBufferAttribute(e,l),s=Math.max(s,o.distanceToSquared(Fo));if(i)for(let l=0,d=i.length;l<d;l++){const p=i[l],f=this.morphTargetsRelative;for(let y=0,_=p.count;y<_;y++)Fo.fromBufferAttribute(p,y),f&&(jv.fromBufferAttribute(e,y),Fo.add(jv)),s=Math.max(s,o.distanceToSquared(Fo))}this.boundingSphere.radius=Math.sqrt(s),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,i=this.attributes;if(e===null||i.position===void 0||i.normal===void 0||i.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const o=e.array,s=i.position.array,l=i.normal.array,d=i.uv.array,p=s.length/3;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new Za(new Float32Array(4*p),4));const f=this.getAttribute("tangent").array,y=[],_=[];for(let Q=0;Q<p;Q++)y[Q]=new Ue,_[Q]=new Ue;const x=new Ue,S=new Ue,T=new Ue,I=new tn,R=new tn,D=new tn,L=new Ue,O=new Ue;function N(Q,he,fe){x.fromArray(s,Q*3),S.fromArray(s,he*3),T.fromArray(s,fe*3),I.fromArray(d,Q*2),R.fromArray(d,he*2),D.fromArray(d,fe*2),S.sub(x),T.sub(x),R.sub(I),D.sub(I);const ye=1/(R.x*D.y-D.x*R.y);isFinite(ye)&&(L.copy(S).multiplyScalar(D.y).addScaledVector(T,-R.y).multiplyScalar(ye),O.copy(T).multiplyScalar(R.x).addScaledVector(S,-D.x).multiplyScalar(ye),y[Q].add(L),y[he].add(L),y[fe].add(L),_[Q].add(O),_[he].add(O),_[fe].add(O))}let F=this.groups;F.length===0&&(F=[{start:0,count:o.length}]);for(let Q=0,he=F.length;Q<he;++Q){const fe=F[Q],ye=fe.start,pe=fe.count;for(let Me=ye,Ie=ye+pe;Me<Ie;Me+=3)N(o[Me+0],o[Me+1],o[Me+2])}const G=new Ue,j=new Ue,Y=new Ue,te=new Ue;function V(Q){Y.fromArray(l,Q*3),te.copy(Y);const he=y[Q];G.copy(he),G.sub(Y.multiplyScalar(Y.dot(he))).normalize(),j.crossVectors(te,he);const ye=j.dot(_[Q])<0?-1:1;f[Q*4]=G.x,f[Q*4+1]=G.y,f[Q*4+2]=G.z,f[Q*4+3]=ye}for(let Q=0,he=F.length;Q<he;++Q){const fe=F[Q],ye=fe.start,pe=fe.count;for(let Me=ye,Ie=ye+pe;Me<Ie;Me+=3)V(o[Me+0]),V(o[Me+1]),V(o[Me+2])}}computeVertexNormals(){const e=this.index,i=this.getAttribute("position");if(i!==void 0){let o=this.getAttribute("normal");if(o===void 0)o=new Za(new Float32Array(i.count*3),3),this.setAttribute("normal",o);else for(let S=0,T=o.count;S<T;S++)o.setXYZ(S,0,0,0);const s=new Ue,l=new Ue,d=new Ue,p=new Ue,f=new Ue,y=new Ue,_=new Ue,x=new Ue;if(e)for(let S=0,T=e.count;S<T;S+=3){const I=e.getX(S+0),R=e.getX(S+1),D=e.getX(S+2);s.fromBufferAttribute(i,I),l.fromBufferAttribute(i,R),d.fromBufferAttribute(i,D),_.subVectors(d,l),x.subVectors(s,l),_.cross(x),p.fromBufferAttribute(o,I),f.fromBufferAttribute(o,R),y.fromBufferAttribute(o,D),p.add(_),f.add(_),y.add(_),o.setXYZ(I,p.x,p.y,p.z),o.setXYZ(R,f.x,f.y,f.z),o.setXYZ(D,y.x,y.y,y.z)}else for(let S=0,T=i.count;S<T;S+=3)s.fromBufferAttribute(i,S+0),l.fromBufferAttribute(i,S+1),d.fromBufferAttribute(i,S+2),_.subVectors(d,l),x.subVectors(s,l),_.cross(x),o.setXYZ(S+0,_.x,_.y,_.z),o.setXYZ(S+1,_.x,_.y,_.z),o.setXYZ(S+2,_.x,_.y,_.z);this.normalizeNormals(),o.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let i=0,o=e.count;i<o;i++)Fo.fromBufferAttribute(e,i),Fo.normalize(),e.setXYZ(i,Fo.x,Fo.y,Fo.z)}toNonIndexed(){function e(p,f){const y=p.array,_=p.itemSize,x=p.normalized,S=new y.constructor(f.length*_);let T=0,I=0;for(let R=0,D=f.length;R<D;R++){p.isInterleavedBufferAttribute?T=f[R]*p.data.stride+p.offset:T=f[R]*_;for(let L=0;L<_;L++)S[I++]=y[T++]}return new Za(S,_,x)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const i=new ki,o=this.index.array,s=this.attributes;for(const p in s){const f=s[p],y=e(f,o);i.setAttribute(p,y)}const l=this.morphAttributes;for(const p in l){const f=[],y=l[p];for(let _=0,x=y.length;_<x;_++){const S=y[_],T=e(S,o);f.push(T)}i.morphAttributes[p]=f}i.morphTargetsRelative=this.morphTargetsRelative;const d=this.groups;for(let p=0,f=d.length;p<f;p++){const y=d[p];i.addGroup(y.start,y.count,y.materialIndex)}return i}toJSON(){const e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const f=this.parameters;for(const y in f)f[y]!==void 0&&(e[y]=f[y]);return e}e.data={attributes:{}};const i=this.index;i!==null&&(e.data.index={type:i.array.constructor.name,array:Array.prototype.slice.call(i.array)});const o=this.attributes;for(const f in o){const y=o[f];e.data.attributes[f]=y.toJSON(e.data)}const s={};let l=!1;for(const f in this.morphAttributes){const y=this.morphAttributes[f],_=[];for(let x=0,S=y.length;x<S;x++){const T=y[x];_.push(T.toJSON(e.data))}_.length>0&&(s[f]=_,l=!0)}l&&(e.data.morphAttributes=s,e.data.morphTargetsRelative=this.morphTargetsRelative);const d=this.groups;d.length>0&&(e.data.groups=JSON.parse(JSON.stringify(d)));const p=this.boundingSphere;return p!==null&&(e.data.boundingSphere={center:p.center.toArray(),radius:p.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const i={};this.name=e.name;const o=e.index;o!==null&&this.setIndex(o.clone(i));const s=e.attributes;for(const y in s){const _=s[y];this.setAttribute(y,_.clone(i))}const l=e.morphAttributes;for(const y in l){const _=[],x=l[y];for(let S=0,T=x.length;S<T;S++)_.push(x[S].clone(i));this.morphAttributes[y]=_}this.morphTargetsRelative=e.morphTargetsRelative;const d=e.groups;for(let y=0,_=d.length;y<_;y++){const x=d[y];this.addGroup(x.start,x.count,x.materialIndex)}const p=e.boundingBox;p!==null&&(this.boundingBox=p.clone());const f=e.boundingSphere;return f!==null&&(this.boundingSphere=f.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const PW=new Ri,Bm=new Kg,OS=new Rc,IW=new Ue,$v=new Ue,Yv=new Ue,qv=new Ue,B4=new Ue,NS=new Ue,zS=new tn,FS=new tn,BS=new tn,LW=new Ue,RW=new Ue,kW=new Ue,US=new Ue,WS=new Ue;class wo extends va{constructor(e=new ki,i=new qh){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=i,this.updateMorphTargets()}copy(e,i){return super.copy(e,i),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const i=this.geometry.morphAttributes,o=Object.keys(i);if(o.length>0){const s=i[o[0]];if(s!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let l=0,d=s.length;l<d;l++){const p=s[l].name||String(l);this.morphTargetInfluences.push(0),this.morphTargetDictionary[p]=l}}}}getVertexPosition(e,i){const o=this.geometry,s=o.attributes.position,l=o.morphAttributes.position,d=o.morphTargetsRelative;i.fromBufferAttribute(s,e);const p=this.morphTargetInfluences;if(l&&p){NS.set(0,0,0);for(let f=0,y=l.length;f<y;f++){const _=p[f],x=l[f];_!==0&&(B4.fromBufferAttribute(x,e),d?NS.addScaledVector(B4,_):NS.addScaledVector(B4.sub(i),_))}i.add(NS)}return i}raycast(e,i){const o=this.geometry,s=this.material,l=this.matrixWorld;s!==void 0&&(o.boundingSphere===null&&o.computeBoundingSphere(),OS.copy(o.boundingSphere),OS.applyMatrix4(l),Bm.copy(e.ray).recast(e.near),!(OS.containsPoint(Bm.origin)===!1&&(Bm.intersectSphere(OS,IW)===null||Bm.origin.distanceToSquared(IW)>(e.far-e.near)**2))&&(PW.copy(l).invert(),Bm.copy(e.ray).applyMatrix4(PW),!(o.boundingBox!==null&&Bm.intersectsBox(o.boundingBox)===!1)&&this._computeIntersections(e,i,Bm)))}_computeIntersections(e,i,o){let s;const l=this.geometry,d=this.material,p=l.index,f=l.attributes.position,y=l.attributes.uv,_=l.attributes.uv1,x=l.attributes.normal,S=l.groups,T=l.drawRange;if(p!==null)if(Array.isArray(d))for(let I=0,R=S.length;I<R;I++){const D=S[I],L=d[D.materialIndex],O=Math.max(D.start,T.start),N=Math.min(p.count,Math.min(D.start+D.count,T.start+T.count));for(let F=O,G=N;F<G;F+=3){const j=p.getX(F),Y=p.getX(F+1),te=p.getX(F+2);s=VS(this,L,e,o,y,_,x,j,Y,te),s&&(s.faceIndex=Math.floor(F/3),s.face.materialIndex=D.materialIndex,i.push(s))}}else{const I=Math.max(0,T.start),R=Math.min(p.count,T.start+T.count);for(let D=I,L=R;D<L;D+=3){const O=p.getX(D),N=p.getX(D+1),F=p.getX(D+2);s=VS(this,d,e,o,y,_,x,O,N,F),s&&(s.faceIndex=Math.floor(D/3),i.push(s))}}else if(f!==void 0)if(Array.isArray(d))for(let I=0,R=S.length;I<R;I++){const D=S[I],L=d[D.materialIndex],O=Math.max(D.start,T.start),N=Math.min(f.count,Math.min(D.start+D.count,T.start+T.count));for(let F=O,G=N;F<G;F+=3){const j=F,Y=F+1,te=F+2;s=VS(this,L,e,o,y,_,x,j,Y,te),s&&(s.faceIndex=Math.floor(F/3),s.face.materialIndex=D.materialIndex,i.push(s))}}else{const I=Math.max(0,T.start),R=Math.min(f.count,T.start+T.count);for(let D=I,L=R;D<L;D+=3){const O=D,N=D+1,F=D+2;s=VS(this,d,e,o,y,_,x,O,N,F),s&&(s.faceIndex=Math.floor(D/3),i.push(s))}}}}function xbe(n,e,i,o,s,l,d,p){let f;if(e.side===Ss?f=o.intersectTriangle(d,l,s,!0,p):f=o.intersectTriangle(s,l,d,e.side===wd,p),f===null)return null;WS.copy(p),WS.applyMatrix4(n.matrixWorld);const y=i.ray.origin.distanceTo(WS);return y<i.near||y>i.far?null:{distance:y,point:WS.clone(),object:n}}function VS(n,e,i,o,s,l,d,p,f,y){n.getVertexPosition(p,$v),n.getVertexPosition(f,Yv),n.getVertexPosition(y,qv);const _=xbe(n,e,i,o,$v,Yv,qv,US);if(_){s&&(zS.fromBufferAttribute(s,p),FS.fromBufferAttribute(s,f),BS.fromBufferAttribute(s,y),_.uv=fl.getInterpolation(US,$v,Yv,qv,zS,FS,BS,new tn)),l&&(zS.fromBufferAttribute(l,p),FS.fromBufferAttribute(l,f),BS.fromBufferAttribute(l,y),_.uv1=fl.getInterpolation(US,$v,Yv,qv,zS,FS,BS,new tn),_.uv2=_.uv1),d&&(LW.fromBufferAttribute(d,p),RW.fromBufferAttribute(d,f),kW.fromBufferAttribute(d,y),_.normal=fl.getInterpolation(US,$v,Yv,qv,LW,RW,kW,new Ue),_.normal.dot(o.direction)>0&&_.normal.multiplyScalar(-1));const x={a:p,b:f,c:y,normal:new Ue,materialIndex:0};fl.getNormal($v,Yv,qv,x.normal),_.face=x}return _}class Jg extends ki{constructor(e=1,i=1,o=1,s=1,l=1,d=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:i,depth:o,widthSegments:s,heightSegments:l,depthSegments:d};const p=this;s=Math.floor(s),l=Math.floor(l),d=Math.floor(d);const f=[],y=[],_=[],x=[];let S=0,T=0;I("z","y","x",-1,-1,o,i,e,d,l,0),I("z","y","x",1,-1,o,i,-e,d,l,1),I("x","z","y",1,1,e,o,i,s,d,2),I("x","z","y",1,-1,e,o,-i,s,d,3),I("x","y","z",1,-1,e,i,o,s,l,4),I("x","y","z",-1,-1,e,i,-o,s,l,5),this.setIndex(f),this.setAttribute("position",new Gn(y,3)),this.setAttribute("normal",new Gn(_,3)),this.setAttribute("uv",new Gn(x,2));function I(R,D,L,O,N,F,G,j,Y,te,V){const Q=F/Y,he=G/te,fe=F/2,ye=G/2,pe=j/2,Me=Y+1,Ie=te+1;let ze=0,le=0;const me=new Ue;for(let xe=0;xe<Ie;xe++){const ae=xe*he-ye;for(let Ee=0;Ee<Me;Ee++){const Je=Ee*Q-fe;me[R]=Je*O,me[D]=ae*N,me[L]=pe,y.push(me.x,me.y,me.z),me[R]=0,me[D]=0,me[L]=j>0?1:-1,_.push(me.x,me.y,me.z),x.push(Ee/Y),x.push(1-xe/te),ze+=1}}for(let xe=0;xe<te;xe++)for(let ae=0;ae<Y;ae++){const Ee=S+ae+Me*xe,Je=S+ae+Me*(xe+1),Ze=S+(ae+1)+Me*(xe+1),Ke=S+(ae+1)+Me*xe;f.push(Ee,Je,Ke),f.push(Je,Ze,Ke),le+=6}p.addGroup(T,le,V),T+=le,S+=ze}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Jg(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function h_(n){const e={};for(const i in n){e[i]={};for(const o in n[i]){const s=n[i][o];s&&(s.isColor||s.isMatrix3||s.isMatrix4||s.isVector2||s.isVector3||s.isVector4||s.isTexture||s.isQuaternion)?s.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[i][o]=null):e[i][o]=s.clone():Array.isArray(s)?e[i][o]=s.slice():e[i][o]=s}}return e}function Ws(n){const e={};for(let i=0;i<n.length;i++){const o=h_(n[i]);for(const s in o)e[s]=o[s]}return e}function wbe(n){const e=[];for(let i=0;i<n.length;i++)e.push(n[i].clone());return e}function eZ(n){return n.getRenderTarget()===null?n.outputColorSpace:Ba.workingColorSpace}const m6={clone:h_,merge:Ws};var Sbe=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,Abe=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class Ad extends es{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=Sbe,this.fragmentShader=Abe,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=h_(e.uniforms),this.uniformsGroups=wbe(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const i=super.toJSON(e);i.glslVersion=this.glslVersion,i.uniforms={};for(const s in this.uniforms){const d=this.uniforms[s].value;d&&d.isTexture?i.uniforms[s]={type:"t",value:d.toJSON(e).uuid}:d&&d.isColor?i.uniforms[s]={type:"c",value:d.getHex()}:d&&d.isVector2?i.uniforms[s]={type:"v2",value:d.toArray()}:d&&d.isVector3?i.uniforms[s]={type:"v3",value:d.toArray()}:d&&d.isVector4?i.uniforms[s]={type:"v4",value:d.toArray()}:d&&d.isMatrix3?i.uniforms[s]={type:"m3",value:d.toArray()}:d&&d.isMatrix4?i.uniforms[s]={type:"m4",value:d.toArray()}:i.uniforms[s]={value:d}}Object.keys(this.defines).length>0&&(i.defines=this.defines),i.vertexShader=this.vertexShader,i.fragmentShader=this.fragmentShader,i.lights=this.lights,i.clipping=this.clipping;const o={};for(const s in this.extensions)this.extensions[s]===!0&&(o[s]=!0);return Object.keys(o).length>0&&(i.extensions=o),i}}class Xw extends va{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Ri,this.projectionMatrix=new Ri,this.projectionMatrixInverse=new Ri,this.coordinateSystem=dd}copy(e,i){return super.copy(e,i),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,i){super.updateWorldMatrix(e,i),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}class qr extends Xw{constructor(e=50,i=1,o=.1,s=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=o,this.far=s,this.focus=10,this.aspect=i,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,i){return super.copy(e,i),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const i=.5*this.getFilmHeight()/e;this.fov=d_*2*Math.atan(i),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(Ag*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return d_*2*Math.atan(Math.tan(Ag*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,i,o,s,l,d){this.aspect=e/i,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=i,this.view.offsetX=o,this.view.offsetY=s,this.view.width=l,this.view.height=d,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let i=e*Math.tan(Ag*.5*this.fov)/this.zoom,o=2*i,s=this.aspect*o,l=-.5*s;const d=this.view;if(this.view!==null&&this.view.enabled){const f=d.fullWidth,y=d.fullHeight;l+=d.offsetX*s/f,i-=d.offsetY*o/y,s*=d.width/f,o*=d.height/y}const p=this.filmOffset;p!==0&&(l+=e*p/this.getFilmWidth()),this.projectionMatrix.makePerspective(l,l+s,i,i-o,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const i=super.toJSON(e);return i.object.fov=this.fov,i.object.zoom=this.zoom,i.object.near=this.near,i.object.far=this.far,i.object.focus=this.focus,i.object.aspect=this.aspect,this.view!==null&&(i.object.view=Object.assign({},this.view)),i.object.filmGauge=this.filmGauge,i.object.filmOffset=this.filmOffset,i}}const Xv=-90,Zv=1;class tZ extends va{constructor(e,i,o){super(),this.type="CubeCamera",this.renderTarget=o,this.coordinateSystem=null,this.activeMipmapLevel=0;const s=new qr(Xv,Zv,e,i);s.layers=this.layers,this.add(s);const l=new qr(Xv,Zv,e,i);l.layers=this.layers,this.add(l);const d=new qr(Xv,Zv,e,i);d.layers=this.layers,this.add(d);const p=new qr(Xv,Zv,e,i);p.layers=this.layers,this.add(p);const f=new qr(Xv,Zv,e,i);f.layers=this.layers,this.add(f);const y=new qr(Xv,Zv,e,i);y.layers=this.layers,this.add(y)}updateCoordinateSystem(){const e=this.coordinateSystem,i=this.children.concat(),[o,s,l,d,p,f]=i;for(const y of i)this.remove(y);if(e===dd)o.up.set(0,1,0),o.lookAt(1,0,0),s.up.set(0,1,0),s.lookAt(-1,0,0),l.up.set(0,0,-1),l.lookAt(0,1,0),d.up.set(0,0,1),d.lookAt(0,-1,0),p.up.set(0,1,0),p.lookAt(0,0,1),f.up.set(0,1,0),f.lookAt(0,0,-1);else if(e===hw)o.up.set(0,-1,0),o.lookAt(-1,0,0),s.up.set(0,-1,0),s.lookAt(1,0,0),l.up.set(0,0,1),l.lookAt(0,1,0),d.up.set(0,0,-1),d.lookAt(0,-1,0),p.up.set(0,-1,0),p.lookAt(0,0,1),f.up.set(0,-1,0),f.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(const y of i)this.add(y),y.updateMatrixWorld()}update(e,i){this.parent===null&&this.updateMatrixWorld();const{renderTarget:o,activeMipmapLevel:s}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[l,d,p,f,y,_]=this.children,x=e.getRenderTarget(),S=e.getActiveCubeFace(),T=e.getActiveMipmapLevel(),I=e.xr.enabled;e.xr.enabled=!1;const R=o.texture.generateMipmaps;o.texture.generateMipmaps=!1,e.setRenderTarget(o,0,s),e.render(i,l),e.setRenderTarget(o,1,s),e.render(i,d),e.setRenderTarget(o,2,s),e.render(i,p),e.setRenderTarget(o,3,s),e.render(i,f),e.setRenderTarget(o,4,s),e.render(i,y),o.texture.generateMipmaps=R,e.setRenderTarget(o,5,s),e.render(i,_),e.setRenderTarget(x,S,T),e.xr.enabled=I,o.texture.needsPMREMUpdate=!0}}class Zw extends Or{constructor(e,i,o,s,l,d,p,f,y,_){e=e!==void 0?e:[],i=i!==void 0?i:Hh,super(e,i,o,s,l,d,p,f,y,_),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class nZ extends yu{constructor(e=1,i={}){super(e,e,i),this.isWebGLCubeRenderTarget=!0;const o={width:e,height:e,depth:1},s=[o,o,o,o,o,o];i.encoding!==void 0&&(mx("THREE.WebGLCubeRenderTarget: option.encoding has been replaced by option.colorSpace."),i.colorSpace=i.encoding===gf?Io:$l),this.texture=new Zw(s,i.mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=i.generateMipmaps!==void 0?i.generateMipmaps:!1,this.texture.minFilter=i.minFilter!==void 0?i.minFilter:Lr}fromEquirectangularTexture(e,i){this.texture.type=i.type,this.texture.colorSpace=i.colorSpace,this.texture.generateMipmaps=i.generateMipmaps,this.texture.minFilter=i.minFilter,this.texture.magFilter=i.magFilter;const o={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},s=new Jg(5,5,5),l=new Ad({name:"CubemapFromEquirect",uniforms:h_(o.uniforms),vertexShader:o.vertexShader,fragmentShader:o.fragmentShader,side:Ss,blending:zh});l.uniforms.tEquirect.value=i;const d=new wo(s,l),p=i.minFilter;return i.minFilter===Sf&&(i.minFilter=Lr),new tZ(1,10,this).update(e,d),i.minFilter=p,d.geometry.dispose(),d.material.dispose(),this}clear(e,i,o,s){const l=e.getRenderTarget();for(let d=0;d<6;d++)e.setRenderTarget(this,d),e.clear(i,o,s);e.setRenderTarget(l)}}const U4=new Ue,Ebe=new Ue,Mbe=new Ui;class Ah{constructor(e=new Ue(1,0,0),i=0){this.isPlane=!0,this.normal=e,this.constant=i}set(e,i){return this.normal.copy(e),this.constant=i,this}setComponents(e,i,o,s){return this.normal.set(e,i,o),this.constant=s,this}setFromNormalAndCoplanarPoint(e,i){return this.normal.copy(e),this.constant=-i.dot(this.normal),this}setFromCoplanarPoints(e,i,o){const s=U4.subVectors(o,i).cross(Ebe.subVectors(e,i)).normalize();return this.setFromNormalAndCoplanarPoint(s,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,i){return i.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,i){const o=e.delta(U4),s=this.normal.dot(o);if(s===0)return this.distanceToPoint(e.start)===0?i.copy(e.start):null;const l=-(e.start.dot(this.normal)+this.constant)/s;return l<0||l>1?null:i.copy(e.start).addScaledVector(o,l)}intersectsLine(e){const i=this.distanceToPoint(e.start),o=this.distanceToPoint(e.end);return i<0&&o>0||o<0&&i>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,i){const o=i||Mbe.getNormalMatrix(e),s=this.coplanarPoint(U4).applyMatrix4(e),l=this.normal.applyMatrix3(o).normalize();return this.constant=-s.dot(l),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}const Um=new Rc,GS=new Ue;class VT{constructor(e=new Ah,i=new Ah,o=new Ah,s=new Ah,l=new Ah,d=new Ah){this.planes=[e,i,o,s,l,d]}set(e,i,o,s,l,d){const p=this.planes;return p[0].copy(e),p[1].copy(i),p[2].copy(o),p[3].copy(s),p[4].copy(l),p[5].copy(d),this}copy(e){const i=this.planes;for(let o=0;o<6;o++)i[o].copy(e.planes[o]);return this}setFromProjectionMatrix(e,i=dd){const o=this.planes,s=e.elements,l=s[0],d=s[1],p=s[2],f=s[3],y=s[4],_=s[5],x=s[6],S=s[7],T=s[8],I=s[9],R=s[10],D=s[11],L=s[12],O=s[13],N=s[14],F=s[15];if(o[0].setComponents(f-l,S-y,D-T,F-L).normalize(),o[1].setComponents(f+l,S+y,D+T,F+L).normalize(),o[2].setComponents(f+d,S+_,D+I,F+O).normalize(),o[3].setComponents(f-d,S-_,D-I,F-O).normalize(),o[4].setComponents(f-p,S-x,D-R,F-N).normalize(),i===dd)o[5].setComponents(f+p,S+x,D+R,F+N).normalize();else if(i===hw)o[5].setComponents(p,x,R,N).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+i);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),Um.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const i=e.geometry;i.boundingSphere===null&&i.computeBoundingSphere(),Um.copy(i.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(Um)}intersectsSprite(e){return Um.center.set(0,0,0),Um.radius=.7071067811865476,Um.applyMatrix4(e.matrixWorld),this.intersectsSphere(Um)}intersectsSphere(e){const i=this.planes,o=e.center,s=-e.radius;for(let l=0;l<6;l++)if(i[l].distanceToPoint(o)<s)return!1;return!0}intersectsBox(e){const i=this.planes;for(let o=0;o<6;o++){const s=i[o];if(GS.x=s.normal.x>0?e.max.x:e.min.x,GS.y=s.normal.y>0?e.max.y:e.min.y,GS.z=s.normal.z>0?e.max.z:e.min.z,s.distanceToPoint(GS)<0)return!1}return!0}containsPoint(e){const i=this.planes;for(let o=0;o<6;o++)if(i[o].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}function iZ(){let n=null,e=!1,i=null,o=null;function s(l,d){i(l,d),o=n.requestAnimationFrame(s)}return{start:function(){e!==!0&&i!==null&&(o=n.requestAnimationFrame(s),e=!0)},stop:function(){n.cancelAnimationFrame(o),e=!1},setAnimationLoop:function(l){i=l},setContext:function(l){n=l}}}function Tbe(n,e){const i=e.isWebGL2,o=new WeakMap;function s(y,_){const x=y.array,S=y.usage,T=n.createBuffer();n.bindBuffer(_,T),n.bufferData(_,x,S),y.onUploadCallback();let I;if(x instanceof Float32Array)I=n.FLOAT;else if(x instanceof Uint16Array)if(y.isFloat16BufferAttribute)if(i)I=n.HALF_FLOAT;else throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");else I=n.UNSIGNED_SHORT;else if(x instanceof Int16Array)I=n.SHORT;else if(x instanceof Uint32Array)I=n.UNSIGNED_INT;else if(x instanceof Int32Array)I=n.INT;else if(x instanceof Int8Array)I=n.BYTE;else if(x instanceof Uint8Array)I=n.UNSIGNED_BYTE;else if(x instanceof Uint8ClampedArray)I=n.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+x);return{buffer:T,type:I,bytesPerElement:x.BYTES_PER_ELEMENT,version:y.version}}function l(y,_,x){const S=_.array,T=_.updateRange;n.bindBuffer(x,y),T.count===-1?n.bufferSubData(x,0,S):(i?n.bufferSubData(x,T.offset*S.BYTES_PER_ELEMENT,S,T.offset,T.count):n.bufferSubData(x,T.offset*S.BYTES_PER_ELEMENT,S.subarray(T.offset,T.offset+T.count)),T.count=-1),_.onUploadCallback()}function d(y){return y.isInterleavedBufferAttribute&&(y=y.data),o.get(y)}function p(y){y.isInterleavedBufferAttribute&&(y=y.data);const _=o.get(y);_&&(n.deleteBuffer(_.buffer),o.delete(y))}function f(y,_){if(y.isGLBufferAttribute){const S=o.get(y);(!S||S.version<y.version)&&o.set(y,{buffer:y.buffer,type:y.type,bytesPerElement:y.elementSize,version:y.version});return}y.isInterleavedBufferAttribute&&(y=y.data);const x=o.get(y);x===void 0?o.set(y,s(y,_)):x.version<y.version&&(l(x.buffer,y,_),x.version=y.version)}return{get:d,remove:p,update:f}}class Rf extends ki{constructor(e=1,i=1,o=1,s=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:i,widthSegments:o,heightSegments:s};const l=e/2,d=i/2,p=Math.floor(o),f=Math.floor(s),y=p+1,_=f+1,x=e/p,S=i/f,T=[],I=[],R=[],D=[];for(let L=0;L<_;L++){const O=L*S-d;for(let N=0;N<y;N++){const F=N*x-l;I.push(F,-O,0),R.push(0,0,1),D.push(N/p),D.push(1-L/f)}}for(let L=0;L<f;L++)for(let O=0;O<p;O++){const N=O+y*L,F=O+y*(L+1),G=O+1+y*(L+1),j=O+1+y*L;T.push(N,F,j),T.push(F,G,j)}this.setIndex(T),this.setAttribute("position",new Gn(I,3)),this.setAttribute("normal",new Gn(R,3)),this.setAttribute("uv",new Gn(D,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Rf(e.width,e.height,e.widthSegments,e.heightSegments)}}var Cbe=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,Pbe=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,Ibe=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,Lbe=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,Rbe=`#ifdef USE_ALPHATEST
	if ( diffuseColor.a < alphaTest ) discard;
#endif`,kbe=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,Dbe=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,Obe=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,Nbe=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,zbe=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,Fbe=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,Bbe=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,Ube=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,Wbe=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#pragma unroll_loop_start
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
		plane = clippingPlanes[ i ];
		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
	}
	#pragma unroll_loop_end
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		#pragma unroll_loop_start
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
		}
		#pragma unroll_loop_end
		if ( clipped ) discard;
	#endif
#endif`,Vbe=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,Gbe=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,Hbe=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,jbe=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,$be=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,Ybe=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,qbe=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,Xbe=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float luminance( const in vec3 rgb ) {
	const vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );
	return dot( weights, rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,Zbe=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_v0 0.339
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_v1 0.276
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_v4 0.046
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_v5 0.016
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_v6 0.0038
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,Kbe=`vec3 transformedNormal = objectNormal;
#ifdef USE_INSTANCING
	mat3 m = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );
	transformedNormal = m * transformedNormal;
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	vec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,Jbe=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,Qbe=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,exe=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,txe=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,nxe="gl_FragColor = linearToOutputTexel( gl_FragColor );",ixe=`
const mat3 LINEAR_SRGB_TO_LINEAR_DISPLAY_P3 = mat3(
	vec3( 0.8224621, 0.177538, 0.0 ),
	vec3( 0.0331941, 0.9668058, 0.0 ),
	vec3( 0.0170827, 0.0723974, 0.9105199 )
);
const mat3 LINEAR_DISPLAY_P3_TO_LINEAR_SRGB = mat3(
	vec3( 1.2249401, - 0.2249404, 0.0 ),
	vec3( - 0.0420569, 1.0420571, 0.0 ),
	vec3( - 0.0196376, - 0.0786361, 1.0982735 )
);
vec4 LinearSRGBToLinearDisplayP3( in vec4 value ) {
	return vec4( value.rgb * LINEAR_SRGB_TO_LINEAR_DISPLAY_P3, value.a );
}
vec4 LinearDisplayP3ToLinearSRGB( in vec4 value ) {
	return vec4( value.rgb * LINEAR_DISPLAY_P3_TO_LINEAR_SRGB, value.a );
}
vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}
vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 LinearTosRGB( in vec4 value ) {
	return sRGBTransferOETF( value );
}`,axe=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,rxe=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,oxe=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,sxe=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,lxe=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,cxe=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,uxe=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,dxe=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,hxe=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,pxe=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,fxe=`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
	vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
	reflectedLight.indirectDiffuse += lightMapIrradiance;
#endif`,mxe=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,gxe=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,yxe=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,vxe=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	#if defined ( LEGACY_LIGHTS )
		if ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
			return pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );
		}
		return 1.0;
	#else
		float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
		if ( cutoffDistance > 0.0 ) {
			distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
		}
		return distanceFalloff;
	#endif
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,_xe=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,bxe=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,xxe=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,wxe=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,Sxe=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,Axe=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	anisotropyV /= material.anisotropy;
	material.anisotropy = saturate( material.anisotropy );
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x - tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x + tbn[ 0 ] * anisotropyV.y;
#endif`,Exe=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return saturate(v);
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,Mxe=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,Txe=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,Cxe=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,Pxe=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,Ixe=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,Lxe=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,Rxe=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,kxe=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );
	
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,Dxe=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,Oxe=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,Nxe=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,zxe=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,Fxe=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,Bxe=`#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,Uxe=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
		objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
		objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
		objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
	#endif
#endif`,Wxe=`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
		uniform sampler2DArray morphTargetsTexture;
		uniform ivec2 morphTargetsTextureSize;
		vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
			int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
			int y = texelIndex / morphTargetsTextureSize.x;
			int x = texelIndex - y * morphTargetsTextureSize.x;
			ivec3 morphUV = ivec3( x, y, morphTargetIndex );
			return texelFetch( morphTargetsTexture, morphUV, 0 );
		}
	#else
		#ifndef USE_MORPHNORMALS
			uniform float morphTargetInfluences[ 8 ];
		#else
			uniform float morphTargetInfluences[ 4 ];
		#endif
	#endif
#endif`,Vxe=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		transformed += morphTarget0 * morphTargetInfluences[ 0 ];
		transformed += morphTarget1 * morphTargetInfluences[ 1 ];
		transformed += morphTarget2 * morphTargetInfluences[ 2 ];
		transformed += morphTarget3 * morphTargetInfluences[ 3 ];
		#ifndef USE_MORPHNORMALS
			transformed += morphTarget4 * morphTargetInfluences[ 4 ];
			transformed += morphTarget5 * morphTargetInfluences[ 5 ];
			transformed += morphTarget6 * morphTargetInfluences[ 6 ];
			transformed += morphTarget7 * morphTargetInfluences[ 7 ];
		#endif
	#endif
#endif`,Gxe=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,Hxe=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,jxe=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,$xe=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,Yxe=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,qxe=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,Xxe=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,Zxe=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,Kxe=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,Jxe=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,Qxe=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,ewe=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec2 packDepthToRG( in highp float v ) {
	return packDepthToRGBA( v ).yx;
}
float unpackRGToDepth( const in highp vec2 v ) {
	return unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,twe=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,nwe=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,iwe=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,awe=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,rwe=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,owe=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,swe=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,lwe=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,cwe=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,uwe=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,dwe=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,hwe=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	uniform int boneTextureSize;
	mat4 getBoneMatrix( const in float i ) {
		float j = i * 4.0;
		float x = mod( j, float( boneTextureSize ) );
		float y = floor( j / float( boneTextureSize ) );
		float dx = 1.0 / float( boneTextureSize );
		float dy = 1.0 / float( boneTextureSize );
		y = dy * ( y + 0.5 );
		vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );
		vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );
		vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );
		vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );
		mat4 bone = mat4( v1, v2, v3, v4 );
		return bone;
	}
#endif`,pwe=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,fwe=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,mwe=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,gwe=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,ywe=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,vwe=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,_we=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,bwe=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
		vec3 refractedRayExit = position + transmissionRay;
		vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
		vec2 refractionCoords = ndcPos.xy / ndcPos.w;
		refractionCoords += 1.0;
		refractionCoords /= 2.0;
		vec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
		vec3 transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,xwe=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,wwe=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,Swe=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,Awe=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const Ewe=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,Mwe=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,Twe=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,Cwe=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,Pwe=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,Iwe=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,Lwe=`#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,Rwe=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,kwe=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,Dwe=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,Owe=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,Nwe=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,zwe=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,Fwe=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,Bwe=`#include <common>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,Uwe=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Wwe=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Vwe=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Gwe=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,Hwe=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,jwe=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,$we=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,Ywe=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,qwe=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Xwe=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,Zwe=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Kwe=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Jwe=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Qwe=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,e2e=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,t2e=`#include <common>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,n2e=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,i2e=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,a2e=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,zi={alphahash_fragment:Cbe,alphahash_pars_fragment:Pbe,alphamap_fragment:Ibe,alphamap_pars_fragment:Lbe,alphatest_fragment:Rbe,alphatest_pars_fragment:kbe,aomap_fragment:Dbe,aomap_pars_fragment:Obe,begin_vertex:Nbe,beginnormal_vertex:zbe,bsdfs:Fbe,iridescence_fragment:Bbe,bumpmap_pars_fragment:Ube,clipping_planes_fragment:Wbe,clipping_planes_pars_fragment:Vbe,clipping_planes_pars_vertex:Gbe,clipping_planes_vertex:Hbe,color_fragment:jbe,color_pars_fragment:$be,color_pars_vertex:Ybe,color_vertex:qbe,common:Xbe,cube_uv_reflection_fragment:Zbe,defaultnormal_vertex:Kbe,displacementmap_pars_vertex:Jbe,displacementmap_vertex:Qbe,emissivemap_fragment:exe,emissivemap_pars_fragment:txe,colorspace_fragment:nxe,colorspace_pars_fragment:ixe,envmap_fragment:axe,envmap_common_pars_fragment:rxe,envmap_pars_fragment:oxe,envmap_pars_vertex:sxe,envmap_physical_pars_fragment:_xe,envmap_vertex:lxe,fog_vertex:cxe,fog_pars_vertex:uxe,fog_fragment:dxe,fog_pars_fragment:hxe,gradientmap_pars_fragment:pxe,lightmap_fragment:fxe,lightmap_pars_fragment:mxe,lights_lambert_fragment:gxe,lights_lambert_pars_fragment:yxe,lights_pars_begin:vxe,lights_toon_fragment:bxe,lights_toon_pars_fragment:xxe,lights_phong_fragment:wxe,lights_phong_pars_fragment:Sxe,lights_physical_fragment:Axe,lights_physical_pars_fragment:Exe,lights_fragment_begin:Mxe,lights_fragment_maps:Txe,lights_fragment_end:Cxe,logdepthbuf_fragment:Pxe,logdepthbuf_pars_fragment:Ixe,logdepthbuf_pars_vertex:Lxe,logdepthbuf_vertex:Rxe,map_fragment:kxe,map_pars_fragment:Dxe,map_particle_fragment:Oxe,map_particle_pars_fragment:Nxe,metalnessmap_fragment:zxe,metalnessmap_pars_fragment:Fxe,morphcolor_vertex:Bxe,morphnormal_vertex:Uxe,morphtarget_pars_vertex:Wxe,morphtarget_vertex:Vxe,normal_fragment_begin:Gxe,normal_fragment_maps:Hxe,normal_pars_fragment:jxe,normal_pars_vertex:$xe,normal_vertex:Yxe,normalmap_pars_fragment:qxe,clearcoat_normal_fragment_begin:Xxe,clearcoat_normal_fragment_maps:Zxe,clearcoat_pars_fragment:Kxe,iridescence_pars_fragment:Jxe,opaque_fragment:Qxe,packing:ewe,premultiplied_alpha_fragment:twe,project_vertex:nwe,dithering_fragment:iwe,dithering_pars_fragment:awe,roughnessmap_fragment:rwe,roughnessmap_pars_fragment:owe,shadowmap_pars_fragment:swe,shadowmap_pars_vertex:lwe,shadowmap_vertex:cwe,shadowmask_pars_fragment:uwe,skinbase_vertex:dwe,skinning_pars_vertex:hwe,skinning_vertex:pwe,skinnormal_vertex:fwe,specularmap_fragment:mwe,specularmap_pars_fragment:gwe,tonemapping_fragment:ywe,tonemapping_pars_fragment:vwe,transmission_fragment:_we,transmission_pars_fragment:bwe,uv_pars_fragment:xwe,uv_pars_vertex:wwe,uv_vertex:Swe,worldpos_vertex:Awe,background_vert:Ewe,background_frag:Mwe,backgroundCube_vert:Twe,backgroundCube_frag:Cwe,cube_vert:Pwe,cube_frag:Iwe,depth_vert:Lwe,depth_frag:Rwe,distanceRGBA_vert:kwe,distanceRGBA_frag:Dwe,equirect_vert:Owe,equirect_frag:Nwe,linedashed_vert:zwe,linedashed_frag:Fwe,meshbasic_vert:Bwe,meshbasic_frag:Uwe,meshlambert_vert:Wwe,meshlambert_frag:Vwe,meshmatcap_vert:Gwe,meshmatcap_frag:Hwe,meshnormal_vert:jwe,meshnormal_frag:$we,meshphong_vert:Ywe,meshphong_frag:qwe,meshphysical_vert:Xwe,meshphysical_frag:Zwe,meshtoon_vert:Kwe,meshtoon_frag:Jwe,points_vert:Qwe,points_frag:e2e,shadow_vert:t2e,shadow_frag:n2e,sprite_vert:i2e,sprite_frag:a2e},wn={common:{diffuse:{value:new Pn(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new Ui},alphaMap:{value:null},alphaMapTransform:{value:new Ui},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new Ui}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new Ui}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new Ui}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new Ui},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new Ui},normalScale:{value:new tn(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new Ui},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new Ui}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new Ui}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new Ui}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Pn(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Pn(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new Ui},alphaTest:{value:0},uvTransform:{value:new Ui}},sprite:{diffuse:{value:new Pn(16777215)},opacity:{value:1},center:{value:new tn(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new Ui},alphaMap:{value:null},alphaMapTransform:{value:new Ui},alphaTest:{value:0}}},lu={basic:{uniforms:Ws([wn.common,wn.specularmap,wn.envmap,wn.aomap,wn.lightmap,wn.fog]),vertexShader:zi.meshbasic_vert,fragmentShader:zi.meshbasic_frag},lambert:{uniforms:Ws([wn.common,wn.specularmap,wn.envmap,wn.aomap,wn.lightmap,wn.emissivemap,wn.bumpmap,wn.normalmap,wn.displacementmap,wn.fog,wn.lights,{emissive:{value:new Pn(0)}}]),vertexShader:zi.meshlambert_vert,fragmentShader:zi.meshlambert_frag},phong:{uniforms:Ws([wn.common,wn.specularmap,wn.envmap,wn.aomap,wn.lightmap,wn.emissivemap,wn.bumpmap,wn.normalmap,wn.displacementmap,wn.fog,wn.lights,{emissive:{value:new Pn(0)},specular:{value:new Pn(1118481)},shininess:{value:30}}]),vertexShader:zi.meshphong_vert,fragmentShader:zi.meshphong_frag},standard:{uniforms:Ws([wn.common,wn.envmap,wn.aomap,wn.lightmap,wn.emissivemap,wn.bumpmap,wn.normalmap,wn.displacementmap,wn.roughnessmap,wn.metalnessmap,wn.fog,wn.lights,{emissive:{value:new Pn(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:zi.meshphysical_vert,fragmentShader:zi.meshphysical_frag},toon:{uniforms:Ws([wn.common,wn.aomap,wn.lightmap,wn.emissivemap,wn.bumpmap,wn.normalmap,wn.displacementmap,wn.gradientmap,wn.fog,wn.lights,{emissive:{value:new Pn(0)}}]),vertexShader:zi.meshtoon_vert,fragmentShader:zi.meshtoon_frag},matcap:{uniforms:Ws([wn.common,wn.bumpmap,wn.normalmap,wn.displacementmap,wn.fog,{matcap:{value:null}}]),vertexShader:zi.meshmatcap_vert,fragmentShader:zi.meshmatcap_frag},points:{uniforms:Ws([wn.points,wn.fog]),vertexShader:zi.points_vert,fragmentShader:zi.points_frag},dashed:{uniforms:Ws([wn.common,wn.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:zi.linedashed_vert,fragmentShader:zi.linedashed_frag},depth:{uniforms:Ws([wn.common,wn.displacementmap]),vertexShader:zi.depth_vert,fragmentShader:zi.depth_frag},normal:{uniforms:Ws([wn.common,wn.bumpmap,wn.normalmap,wn.displacementmap,{opacity:{value:1}}]),vertexShader:zi.meshnormal_vert,fragmentShader:zi.meshnormal_frag},sprite:{uniforms:Ws([wn.sprite,wn.fog]),vertexShader:zi.sprite_vert,fragmentShader:zi.sprite_frag},background:{uniforms:{uvTransform:{value:new Ui},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:zi.background_vert,fragmentShader:zi.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:zi.backgroundCube_vert,fragmentShader:zi.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:zi.cube_vert,fragmentShader:zi.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:zi.equirect_vert,fragmentShader:zi.equirect_frag},distanceRGBA:{uniforms:Ws([wn.common,wn.displacementmap,{referencePosition:{value:new Ue},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:zi.distanceRGBA_vert,fragmentShader:zi.distanceRGBA_frag},shadow:{uniforms:Ws([wn.lights,wn.fog,{color:{value:new Pn(0)},opacity:{value:1}}]),vertexShader:zi.shadow_vert,fragmentShader:zi.shadow_frag}};lu.physical={uniforms:Ws([lu.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new Ui},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new Ui},clearcoatNormalScale:{value:new tn(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new Ui},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new Ui},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new Ui},sheen:{value:0},sheenColor:{value:new Pn(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new Ui},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new Ui},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new Ui},transmissionSamplerSize:{value:new tn},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new Ui},attenuationDistance:{value:0},attenuationColor:{value:new Pn(0)},specularColor:{value:new Pn(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new Ui},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new Ui},anisotropyVector:{value:new tn},anisotropyMap:{value:null},anisotropyMapTransform:{value:new Ui}}]),vertexShader:zi.meshphysical_vert,fragmentShader:zi.meshphysical_frag};const HS={r:0,b:0,g:0};function r2e(n,e,i,o,s,l,d){const p=new Pn(0);let f=l===!0?0:1,y,_,x=null,S=0,T=null;function I(D,L){let O=!1,N=L.isScene===!0?L.background:null;N&&N.isTexture&&(N=(L.backgroundBlurriness>0?i:e).get(N)),N===null?R(p,f):N&&N.isColor&&(R(N,1),O=!0);const F=n.xr.getEnvironmentBlendMode();F==="additive"?o.buffers.color.setClear(0,0,0,1,d):F==="alpha-blend"&&o.buffers.color.setClear(0,0,0,0,d),(n.autoClear||O)&&n.clear(n.autoClearColor,n.autoClearDepth,n.autoClearStencil),N&&(N.isCubeTexture||N.mapping===S_)?(_===void 0&&(_=new wo(new Jg(1,1,1),new Ad({name:"BackgroundCubeMaterial",uniforms:h_(lu.backgroundCube.uniforms),vertexShader:lu.backgroundCube.vertexShader,fragmentShader:lu.backgroundCube.fragmentShader,side:Ss,depthTest:!1,depthWrite:!1,fog:!1})),_.geometry.deleteAttribute("normal"),_.geometry.deleteAttribute("uv"),_.onBeforeRender=function(G,j,Y){this.matrixWorld.copyPosition(Y.matrixWorld)},Object.defineProperty(_.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),s.update(_)),_.material.uniforms.envMap.value=N,_.material.uniforms.flipEnvMap.value=N.isCubeTexture&&N.isRenderTargetTexture===!1?-1:1,_.material.uniforms.backgroundBlurriness.value=L.backgroundBlurriness,_.material.uniforms.backgroundIntensity.value=L.backgroundIntensity,_.material.toneMapped=Ba.getTransfer(N.colorSpace)!==tr,(x!==N||S!==N.version||T!==n.toneMapping)&&(_.material.needsUpdate=!0,x=N,S=N.version,T=n.toneMapping),_.layers.enableAll(),D.unshift(_,_.geometry,_.material,0,0,null)):N&&N.isTexture&&(y===void 0&&(y=new wo(new Rf(2,2),new Ad({name:"BackgroundMaterial",uniforms:h_(lu.background.uniforms),vertexShader:lu.background.vertexShader,fragmentShader:lu.background.fragmentShader,side:wd,depthTest:!1,depthWrite:!1,fog:!1})),y.geometry.deleteAttribute("normal"),Object.defineProperty(y.material,"map",{get:function(){return this.uniforms.t2D.value}}),s.update(y)),y.material.uniforms.t2D.value=N,y.material.uniforms.backgroundIntensity.value=L.backgroundIntensity,y.material.toneMapped=Ba.getTransfer(N.colorSpace)!==tr,N.matrixAutoUpdate===!0&&N.updateMatrix(),y.material.uniforms.uvTransform.value.copy(N.matrix),(x!==N||S!==N.version||T!==n.toneMapping)&&(y.material.needsUpdate=!0,x=N,S=N.version,T=n.toneMapping),y.layers.enableAll(),D.unshift(y,y.geometry,y.material,0,0,null))}function R(D,L){D.getRGB(HS,eZ(n)),o.buffers.color.setClear(HS.r,HS.g,HS.b,L,d)}return{getClearColor:function(){return p},setClearColor:function(D,L=1){p.set(D),f=L,R(p,f)},getClearAlpha:function(){return f},setClearAlpha:function(D){f=D,R(p,f)},render:I}}function o2e(n,e,i,o){const s=n.getParameter(n.MAX_VERTEX_ATTRIBS),l=o.isWebGL2?null:e.get("OES_vertex_array_object"),d=o.isWebGL2||l!==null,p={},f=D(null);let y=f,_=!1;function x(pe,Me,Ie,ze,le){let me=!1;if(d){const xe=R(ze,Ie,Me);y!==xe&&(y=xe,T(y.object)),me=L(pe,ze,Ie,le),me&&O(pe,ze,Ie,le)}else{const xe=Me.wireframe===!0;(y.geometry!==ze.id||y.program!==Ie.id||y.wireframe!==xe)&&(y.geometry=ze.id,y.program=Ie.id,y.wireframe=xe,me=!0)}le!==null&&i.update(le,n.ELEMENT_ARRAY_BUFFER),(me||_)&&(_=!1,te(pe,Me,Ie,ze),le!==null&&n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,i.get(le).buffer))}function S(){return o.isWebGL2?n.createVertexArray():l.createVertexArrayOES()}function T(pe){return o.isWebGL2?n.bindVertexArray(pe):l.bindVertexArrayOES(pe)}function I(pe){return o.isWebGL2?n.deleteVertexArray(pe):l.deleteVertexArrayOES(pe)}function R(pe,Me,Ie){const ze=Ie.wireframe===!0;let le=p[pe.id];le===void 0&&(le={},p[pe.id]=le);let me=le[Me.id];me===void 0&&(me={},le[Me.id]=me);let xe=me[ze];return xe===void 0&&(xe=D(S()),me[ze]=xe),xe}function D(pe){const Me=[],Ie=[],ze=[];for(let le=0;le<s;le++)Me[le]=0,Ie[le]=0,ze[le]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:Me,enabledAttributes:Ie,attributeDivisors:ze,object:pe,attributes:{},index:null}}function L(pe,Me,Ie,ze){const le=y.attributes,me=Me.attributes;let xe=0;const ae=Ie.getAttributes();for(const Ee in ae)if(ae[Ee].location>=0){const Ze=le[Ee];let Ke=me[Ee];if(Ke===void 0&&(Ee==="instanceMatrix"&&pe.instanceMatrix&&(Ke=pe.instanceMatrix),Ee==="instanceColor"&&pe.instanceColor&&(Ke=pe.instanceColor)),Ze===void 0||Ze.attribute!==Ke||Ke&&Ze.data!==Ke.data)return!0;xe++}return y.attributesNum!==xe||y.index!==ze}function O(pe,Me,Ie,ze){const le={},me=Me.attributes;let xe=0;const ae=Ie.getAttributes();for(const Ee in ae)if(ae[Ee].location>=0){let Ze=me[Ee];Ze===void 0&&(Ee==="instanceMatrix"&&pe.instanceMatrix&&(Ze=pe.instanceMatrix),Ee==="instanceColor"&&pe.instanceColor&&(Ze=pe.instanceColor));const Ke={};Ke.attribute=Ze,Ze&&Ze.data&&(Ke.data=Ze.data),le[Ee]=Ke,xe++}y.attributes=le,y.attributesNum=xe,y.index=ze}function N(){const pe=y.newAttributes;for(let Me=0,Ie=pe.length;Me<Ie;Me++)pe[Me]=0}function F(pe){G(pe,0)}function G(pe,Me){const Ie=y.newAttributes,ze=y.enabledAttributes,le=y.attributeDivisors;Ie[pe]=1,ze[pe]===0&&(n.enableVertexAttribArray(pe),ze[pe]=1),le[pe]!==Me&&((o.isWebGL2?n:e.get("ANGLE_instanced_arrays"))[o.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](pe,Me),le[pe]=Me)}function j(){const pe=y.newAttributes,Me=y.enabledAttributes;for(let Ie=0,ze=Me.length;Ie<ze;Ie++)Me[Ie]!==pe[Ie]&&(n.disableVertexAttribArray(Ie),Me[Ie]=0)}function Y(pe,Me,Ie,ze,le,me,xe){xe===!0?n.vertexAttribIPointer(pe,Me,Ie,le,me):n.vertexAttribPointer(pe,Me,Ie,ze,le,me)}function te(pe,Me,Ie,ze){if(o.isWebGL2===!1&&(pe.isInstancedMesh||ze.isInstancedBufferGeometry)&&e.get("ANGLE_instanced_arrays")===null)return;N();const le=ze.attributes,me=Ie.getAttributes(),xe=Me.defaultAttributeValues;for(const ae in me){const Ee=me[ae];if(Ee.location>=0){let Je=le[ae];if(Je===void 0&&(ae==="instanceMatrix"&&pe.instanceMatrix&&(Je=pe.instanceMatrix),ae==="instanceColor"&&pe.instanceColor&&(Je=pe.instanceColor)),Je!==void 0){const Ze=Je.normalized,Ke=Je.itemSize,Fe=i.get(Je);if(Fe===void 0)continue;const ct=Fe.buffer,Ct=Fe.type,kt=Fe.bytesPerElement,Kt=o.isWebGL2===!0&&(Ct===n.INT||Ct===n.UNSIGNED_INT||Je.gpuType===t6);if(Je.isInterleavedBufferAttribute){const At=Je.data,Pe=At.stride,ft=Je.offset;if(At.isInstancedInterleavedBuffer){for(let gt=0;gt<Ee.locationSize;gt++)G(Ee.location+gt,At.meshPerAttribute);pe.isInstancedMesh!==!0&&ze._maxInstanceCount===void 0&&(ze._maxInstanceCount=At.meshPerAttribute*At.count)}else for(let gt=0;gt<Ee.locationSize;gt++)F(Ee.location+gt);n.bindBuffer(n.ARRAY_BUFFER,ct);for(let gt=0;gt<Ee.locationSize;gt++)Y(Ee.location+gt,Ke/Ee.locationSize,Ct,Ze,Pe*kt,(ft+Ke/Ee.locationSize*gt)*kt,Kt)}else{if(Je.isInstancedBufferAttribute){for(let At=0;At<Ee.locationSize;At++)G(Ee.location+At,Je.meshPerAttribute);pe.isInstancedMesh!==!0&&ze._maxInstanceCount===void 0&&(ze._maxInstanceCount=Je.meshPerAttribute*Je.count)}else for(let At=0;At<Ee.locationSize;At++)F(Ee.location+At);n.bindBuffer(n.ARRAY_BUFFER,ct);for(let At=0;At<Ee.locationSize;At++)Y(Ee.location+At,Ke/Ee.locationSize,Ct,Ze,Ke*kt,Ke/Ee.locationSize*At*kt,Kt)}}else if(xe!==void 0){const Ze=xe[ae];if(Ze!==void 0)switch(Ze.length){case 2:n.vertexAttrib2fv(Ee.location,Ze);break;case 3:n.vertexAttrib3fv(Ee.location,Ze);break;case 4:n.vertexAttrib4fv(Ee.location,Ze);break;default:n.vertexAttrib1fv(Ee.location,Ze)}}}}j()}function V(){fe();for(const pe in p){const Me=p[pe];for(const Ie in Me){const ze=Me[Ie];for(const le in ze)I(ze[le].object),delete ze[le];delete Me[Ie]}delete p[pe]}}function Q(pe){if(p[pe.id]===void 0)return;const Me=p[pe.id];for(const Ie in Me){const ze=Me[Ie];for(const le in ze)I(ze[le].object),delete ze[le];delete Me[Ie]}delete p[pe.id]}function he(pe){for(const Me in p){const Ie=p[Me];if(Ie[pe.id]===void 0)continue;const ze=Ie[pe.id];for(const le in ze)I(ze[le].object),delete ze[le];delete Ie[pe.id]}}function fe(){ye(),_=!0,y!==f&&(y=f,T(y.object))}function ye(){f.geometry=null,f.program=null,f.wireframe=!1}return{setup:x,reset:fe,resetDefaultState:ye,dispose:V,releaseStatesOfGeometry:Q,releaseStatesOfProgram:he,initAttributes:N,enableAttribute:F,disableUnusedAttributes:j}}function s2e(n,e,i,o){const s=o.isWebGL2;let l;function d(y){l=y}function p(y,_){n.drawArrays(l,y,_),i.update(_,l,1)}function f(y,_,x){if(x===0)return;let S,T;if(s)S=n,T="drawArraysInstanced";else if(S=e.get("ANGLE_instanced_arrays"),T="drawArraysInstancedANGLE",S===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}S[T](l,y,_,x),i.update(_,l,x)}this.setMode=d,this.render=p,this.renderInstances=f}function l2e(n,e,i){let o;function s(){if(o!==void 0)return o;if(e.has("EXT_texture_filter_anisotropic")===!0){const Y=e.get("EXT_texture_filter_anisotropic");o=n.getParameter(Y.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else o=0;return o}function l(Y){if(Y==="highp"){if(n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.HIGH_FLOAT).precision>0&&n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.HIGH_FLOAT).precision>0)return"highp";Y="mediump"}return Y==="mediump"&&n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.MEDIUM_FLOAT).precision>0&&n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}const d=typeof WebGL2RenderingContext<"u"&&n.constructor.name==="WebGL2RenderingContext";let p=i.precision!==void 0?i.precision:"highp";const f=l(p);f!==p&&(console.warn("THREE.WebGLRenderer:",p,"not supported, using",f,"instead."),p=f);const y=d||e.has("WEBGL_draw_buffers"),_=i.logarithmicDepthBuffer===!0,x=n.getParameter(n.MAX_TEXTURE_IMAGE_UNITS),S=n.getParameter(n.MAX_VERTEX_TEXTURE_IMAGE_UNITS),T=n.getParameter(n.MAX_TEXTURE_SIZE),I=n.getParameter(n.MAX_CUBE_MAP_TEXTURE_SIZE),R=n.getParameter(n.MAX_VERTEX_ATTRIBS),D=n.getParameter(n.MAX_VERTEX_UNIFORM_VECTORS),L=n.getParameter(n.MAX_VARYING_VECTORS),O=n.getParameter(n.MAX_FRAGMENT_UNIFORM_VECTORS),N=S>0,F=d||e.has("OES_texture_float"),G=N&&F,j=d?n.getParameter(n.MAX_SAMPLES):0;return{isWebGL2:d,drawBuffers:y,getMaxAnisotropy:s,getMaxPrecision:l,precision:p,logarithmicDepthBuffer:_,maxTextures:x,maxVertexTextures:S,maxTextureSize:T,maxCubemapSize:I,maxAttributes:R,maxVertexUniforms:D,maxVaryings:L,maxFragmentUniforms:O,vertexTextures:N,floatFragmentTextures:F,floatVertexTextures:G,maxSamples:j}}function c2e(n){const e=this;let i=null,o=0,s=!1,l=!1;const d=new Ah,p=new Ui,f={value:null,needsUpdate:!1};this.uniform=f,this.numPlanes=0,this.numIntersection=0,this.init=function(x,S){const T=x.length!==0||S||o!==0||s;return s=S,o=x.length,T},this.beginShadows=function(){l=!0,_(null)},this.endShadows=function(){l=!1},this.setGlobalState=function(x,S){i=_(x,S,0)},this.setState=function(x,S,T){const I=x.clippingPlanes,R=x.clipIntersection,D=x.clipShadows,L=n.get(x);if(!s||I===null||I.length===0||l&&!D)l?_(null):y();else{const O=l?0:o,N=O*4;let F=L.clippingState||null;f.value=F,F=_(I,S,N,T);for(let G=0;G!==N;++G)F[G]=i[G];L.clippingState=F,this.numIntersection=R?this.numPlanes:0,this.numPlanes+=O}};function y(){f.value!==i&&(f.value=i,f.needsUpdate=o>0),e.numPlanes=o,e.numIntersection=0}function _(x,S,T,I){const R=x!==null?x.length:0;let D=null;if(R!==0){if(D=f.value,I!==!0||D===null){const L=T+R*4,O=S.matrixWorldInverse;p.getNormalMatrix(O),(D===null||D.length<L)&&(D=new Float32Array(L));for(let N=0,F=T;N!==R;++N,F+=4)d.copy(x[N]).applyMatrix4(O,p),d.normal.toArray(D,F),D[F+3]=d.constant}f.value=D,f.needsUpdate=!0}return e.numPlanes=R,e.numIntersection=0,D}}function u2e(n){let e=new WeakMap;function i(d,p){return p===tw?d.mapping=Hh:p===nw&&(d.mapping=wf),d}function o(d){if(d&&d.isTexture&&d.isRenderTargetTexture===!1){const p=d.mapping;if(p===tw||p===nw)if(e.has(d)){const f=e.get(d).texture;return i(f,d.mapping)}else{const f=d.image;if(f&&f.height>0){const y=new nZ(f.height/2);return y.fromEquirectangularTexture(n,d),e.set(d,y),d.addEventListener("dispose",s),i(y.texture,d.mapping)}else return null}}return d}function s(d){const p=d.target;p.removeEventListener("dispose",s);const f=e.get(p);f!==void 0&&(e.delete(p),f.dispose())}function l(){e=new WeakMap}return{get:o,dispose:l}}class Rh extends Xw{constructor(e=-1,i=1,o=1,s=-1,l=.1,d=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=i,this.top=o,this.bottom=s,this.near=l,this.far=d,this.updateProjectionMatrix()}copy(e,i){return super.copy(e,i),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,i,o,s,l,d){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=i,this.view.offsetX=o,this.view.offsetY=s,this.view.width=l,this.view.height=d,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),i=(this.top-this.bottom)/(2*this.zoom),o=(this.right+this.left)/2,s=(this.top+this.bottom)/2;let l=o-e,d=o+e,p=s+i,f=s-i;if(this.view!==null&&this.view.enabled){const y=(this.right-this.left)/this.view.fullWidth/this.zoom,_=(this.top-this.bottom)/this.view.fullHeight/this.zoom;l+=y*this.view.offsetX,d=l+y*this.view.width,p-=_*this.view.offsetY,f=p-_*this.view.height}this.projectionMatrix.makeOrthographic(l,d,p,f,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const i=super.toJSON(e);return i.object.zoom=this.zoom,i.object.left=this.left,i.object.right=this.right,i.object.top=this.top,i.object.bottom=this.bottom,i.object.near=this.near,i.object.far=this.far,this.view!==null&&(i.object.view=Object.assign({},this.view)),i}}const P0=4,DW=[.125,.215,.35,.446,.526,.582],sg=20,W4=new Rh,OW=new Pn;let V4=null,G4=0,H4=0;const ag=(1+Math.sqrt(5))/2,Kv=1/ag,NW=[new Ue(1,1,1),new Ue(-1,1,1),new Ue(1,1,-1),new Ue(-1,1,-1),new Ue(0,ag,Kv),new Ue(0,ag,-Kv),new Ue(Kv,0,ag),new Ue(-Kv,0,ag),new Ue(ag,Kv,0),new Ue(-ag,Kv,0)];class LR{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,i=0,o=.1,s=100){V4=this._renderer.getRenderTarget(),G4=this._renderer.getActiveCubeFace(),H4=this._renderer.getActiveMipmapLevel(),this._setSize(256);const l=this._allocateTargets();return l.depthBuffer=!0,this._sceneToCubeUV(e,o,s,l),i>0&&this._blur(l,0,0,i),this._applyPMREM(l),this._cleanup(l),l}fromEquirectangular(e,i=null){return this._fromTexture(e,i)}fromCubemap(e,i=null){return this._fromTexture(e,i)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=BW(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=FW(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(V4,G4,H4),e.scissorTest=!1,jS(e,0,0,e.width,e.height)}_fromTexture(e,i){e.mapping===Hh||e.mapping===wf?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),V4=this._renderer.getRenderTarget(),G4=this._renderer.getActiveCubeFace(),H4=this._renderer.getActiveMipmapLevel();const o=i||this._allocateTargets();return this._textureToCubeUV(e,o),this._applyPMREM(o),this._cleanup(o),o}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),i=4*this._cubeSize,o={magFilter:Lr,minFilter:Lr,generateMipmaps:!1,type:u_,format:ml,colorSpace:Sd,depthBuffer:!1},s=zW(e,i,o);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==i){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=zW(e,i,o);const{_lodMax:l}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=d2e(l)),this._blurMaterial=h2e(l,e,i)}return s}_compileMaterial(e){const i=new wo(this._lodPlanes[0],e);this._renderer.compile(i,W4)}_sceneToCubeUV(e,i,o,s){const p=new qr(90,1,i,o),f=[1,-1,1,1,1,1],y=[1,1,1,-1,-1,-1],_=this._renderer,x=_.autoClear,S=_.toneMapping;_.getClearColor(OW),_.toneMapping=gd,_.autoClear=!1;const T=new qh({name:"PMREM.Background",side:Ss,depthWrite:!1,depthTest:!1}),I=new wo(new Jg,T);let R=!1;const D=e.background;D?D.isColor&&(T.color.copy(D),e.background=null,R=!0):(T.color.copy(OW),R=!0);for(let L=0;L<6;L++){const O=L%3;O===0?(p.up.set(0,f[L],0),p.lookAt(y[L],0,0)):O===1?(p.up.set(0,0,f[L]),p.lookAt(0,y[L],0)):(p.up.set(0,f[L],0),p.lookAt(0,0,y[L]));const N=this._cubeSize;jS(s,O*N,L>2?N:0,N,N),_.setRenderTarget(s),R&&_.render(I,p),_.render(e,p)}I.geometry.dispose(),I.material.dispose(),_.toneMapping=S,_.autoClear=x,e.background=D}_textureToCubeUV(e,i){const o=this._renderer,s=e.mapping===Hh||e.mapping===wf;s?(this._cubemapMaterial===null&&(this._cubemapMaterial=BW()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=FW());const l=s?this._cubemapMaterial:this._equirectMaterial,d=new wo(this._lodPlanes[0],l),p=l.uniforms;p.envMap.value=e;const f=this._cubeSize;jS(i,0,0,3*f,2*f),o.setRenderTarget(i),o.render(d,W4)}_applyPMREM(e){const i=this._renderer,o=i.autoClear;i.autoClear=!1;for(let s=1;s<this._lodPlanes.length;s++){const l=Math.sqrt(this._sigmas[s]*this._sigmas[s]-this._sigmas[s-1]*this._sigmas[s-1]),d=NW[(s-1)%NW.length];this._blur(e,s-1,s,l,d)}i.autoClear=o}_blur(e,i,o,s,l){const d=this._pingPongRenderTarget;this._halfBlur(e,d,i,o,s,"latitudinal",l),this._halfBlur(d,e,o,o,s,"longitudinal",l)}_halfBlur(e,i,o,s,l,d,p){const f=this._renderer,y=this._blurMaterial;d!=="latitudinal"&&d!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const _=3,x=new wo(this._lodPlanes[s],y),S=y.uniforms,T=this._sizeLods[o]-1,I=isFinite(l)?Math.PI/(2*T):2*Math.PI/(2*sg-1),R=l/I,D=isFinite(l)?1+Math.floor(_*R):sg;D>sg&&console.warn(`sigmaRadians, ${l}, is too large and will clip, as it requested ${D} samples when the maximum is set to ${sg}`);const L=[];let O=0;for(let Y=0;Y<sg;++Y){const te=Y/R,V=Math.exp(-te*te/2);L.push(V),Y===0?O+=V:Y<D&&(O+=2*V)}for(let Y=0;Y<L.length;Y++)L[Y]=L[Y]/O;S.envMap.value=e.texture,S.samples.value=D,S.weights.value=L,S.latitudinal.value=d==="latitudinal",p&&(S.poleAxis.value=p);const{_lodMax:N}=this;S.dTheta.value=I,S.mipInt.value=N-o;const F=this._sizeLods[s],G=3*F*(s>N-P0?s-N+P0:0),j=4*(this._cubeSize-F);jS(i,G,j,3*F,2*F),f.setRenderTarget(i),f.render(x,W4)}}function d2e(n){const e=[],i=[],o=[];let s=n;const l=n-P0+1+DW.length;for(let d=0;d<l;d++){const p=Math.pow(2,s);i.push(p);let f=1/p;d>n-P0?f=DW[d-n+P0-1]:d===0&&(f=0),o.push(f);const y=1/(p-2),_=-y,x=1+y,S=[_,_,x,_,x,x,_,_,x,x,_,x],T=6,I=6,R=3,D=2,L=1,O=new Float32Array(R*I*T),N=new Float32Array(D*I*T),F=new Float32Array(L*I*T);for(let j=0;j<T;j++){const Y=j%3*2/3-1,te=j>2?0:-1,V=[Y,te,0,Y+2/3,te,0,Y+2/3,te+1,0,Y,te,0,Y+2/3,te+1,0,Y,te+1,0];O.set(V,R*I*j),N.set(S,D*I*j);const Q=[j,j,j,j,j,j];F.set(Q,L*I*j)}const G=new ki;G.setAttribute("position",new Za(O,R)),G.setAttribute("uv",new Za(N,D)),G.setAttribute("faceIndex",new Za(F,L)),e.push(G),s>P0&&s--}return{lodPlanes:e,sizeLods:i,sigmas:o}}function zW(n,e,i){const o=new yu(n,e,i);return o.texture.mapping=S_,o.texture.name="PMREM.cubeUv",o.scissorTest=!0,o}function jS(n,e,i,o,s){n.viewport.set(e,i,o,s),n.scissor.set(e,i,o,s)}function h2e(n,e,i){const o=new Float32Array(sg),s=new Ue(0,1,0);return new Ad({name:"SphericalGaussianBlur",defines:{n:sg,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/i,CUBEUV_MAX_MIP:`${n}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:o},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:s}},vertexShader:g6(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:zh,depthTest:!1,depthWrite:!1})}function FW(){return new Ad({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:g6(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:zh,depthTest:!1,depthWrite:!1})}function BW(){return new Ad({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:g6(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:zh,depthTest:!1,depthWrite:!1})}function g6(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function p2e(n){let e=new WeakMap,i=null;function o(p){if(p&&p.isTexture){const f=p.mapping,y=f===tw||f===nw,_=f===Hh||f===wf;if(y||_)if(p.isRenderTargetTexture&&p.needsPMREMUpdate===!0){p.needsPMREMUpdate=!1;let x=e.get(p);return i===null&&(i=new LR(n)),x=y?i.fromEquirectangular(p,x):i.fromCubemap(p,x),e.set(p,x),x.texture}else{if(e.has(p))return e.get(p).texture;{const x=p.image;if(y&&x&&x.height>0||_&&x&&s(x)){i===null&&(i=new LR(n));const S=y?i.fromEquirectangular(p):i.fromCubemap(p);return e.set(p,S),p.addEventListener("dispose",l),S.texture}else return null}}}return p}function s(p){let f=0;const y=6;for(let _=0;_<y;_++)p[_]!==void 0&&f++;return f===y}function l(p){const f=p.target;f.removeEventListener("dispose",l);const y=e.get(f);y!==void 0&&(e.delete(f),y.dispose())}function d(){e=new WeakMap,i!==null&&(i.dispose(),i=null)}return{get:o,dispose:d}}function f2e(n){const e={};function i(o){if(e[o]!==void 0)return e[o];let s;switch(o){case"WEBGL_depth_texture":s=n.getExtension("WEBGL_depth_texture")||n.getExtension("MOZ_WEBGL_depth_texture")||n.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":s=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":s=n.getExtension("WEBGL_compressed_texture_s3tc")||n.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":s=n.getExtension("WEBGL_compressed_texture_pvrtc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:s=n.getExtension(o)}return e[o]=s,s}return{has:function(o){return i(o)!==null},init:function(o){o.isWebGL2?i("EXT_color_buffer_float"):(i("WEBGL_depth_texture"),i("OES_texture_float"),i("OES_texture_half_float"),i("OES_texture_half_float_linear"),i("OES_standard_derivatives"),i("OES_element_index_uint"),i("OES_vertex_array_object"),i("ANGLE_instanced_arrays")),i("OES_texture_float_linear"),i("EXT_color_buffer_half_float"),i("WEBGL_multisampled_render_to_texture")},get:function(o){const s=i(o);return s===null&&console.warn("THREE.WebGLRenderer: "+o+" extension not supported."),s}}}function m2e(n,e,i,o){const s={},l=new WeakMap;function d(x){const S=x.target;S.index!==null&&e.remove(S.index);for(const I in S.attributes)e.remove(S.attributes[I]);for(const I in S.morphAttributes){const R=S.morphAttributes[I];for(let D=0,L=R.length;D<L;D++)e.remove(R[D])}S.removeEventListener("dispose",d),delete s[S.id];const T=l.get(S);T&&(e.remove(T),l.delete(S)),o.releaseStatesOfGeometry(S),S.isInstancedBufferGeometry===!0&&delete S._maxInstanceCount,i.memory.geometries--}function p(x,S){return s[S.id]===!0||(S.addEventListener("dispose",d),s[S.id]=!0,i.memory.geometries++),S}function f(x){const S=x.attributes;for(const I in S)e.update(S[I],n.ARRAY_BUFFER);const T=x.morphAttributes;for(const I in T){const R=T[I];for(let D=0,L=R.length;D<L;D++)e.update(R[D],n.ARRAY_BUFFER)}}function y(x){const S=[],T=x.index,I=x.attributes.position;let R=0;if(T!==null){const O=T.array;R=T.version;for(let N=0,F=O.length;N<F;N+=3){const G=O[N+0],j=O[N+1],Y=O[N+2];S.push(G,j,j,Y,Y,G)}}else if(I!==void 0){const O=I.array;R=I.version;for(let N=0,F=O.length/3-1;N<F;N+=3){const G=N+0,j=N+1,Y=N+2;S.push(G,j,j,Y,Y,G)}}else return;const D=new(ZX(S)?f6:p6)(S,1);D.version=R;const L=l.get(x);L&&e.remove(L),l.set(x,D)}function _(x){const S=l.get(x);if(S){const T=x.index;T!==null&&S.version<T.version&&y(x)}else y(x);return l.get(x)}return{get:p,update:f,getWireframeAttribute:_}}function g2e(n,e,i,o){const s=o.isWebGL2;let l;function d(S){l=S}let p,f;function y(S){p=S.type,f=S.bytesPerElement}function _(S,T){n.drawElements(l,T,p,S*f),i.update(T,l,1)}function x(S,T,I){if(I===0)return;let R,D;if(s)R=n,D="drawElementsInstanced";else if(R=e.get("ANGLE_instanced_arrays"),D="drawElementsInstancedANGLE",R===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}R[D](l,T,p,S*f,I),i.update(T,l,I)}this.setMode=d,this.setIndex=y,this.render=_,this.renderInstances=x}function y2e(n){const e={geometries:0,textures:0},i={frame:0,calls:0,triangles:0,points:0,lines:0};function o(l,d,p){switch(i.calls++,d){case n.TRIANGLES:i.triangles+=p*(l/3);break;case n.LINES:i.lines+=p*(l/2);break;case n.LINE_STRIP:i.lines+=p*(l-1);break;case n.LINE_LOOP:i.lines+=p*l;break;case n.POINTS:i.points+=p*l;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",d);break}}function s(){i.calls=0,i.triangles=0,i.points=0,i.lines=0}return{memory:e,render:i,programs:null,autoReset:!0,reset:s,update:o}}function v2e(n,e){return n[0]-e[0]}function _2e(n,e){return Math.abs(e[1])-Math.abs(n[1])}function b2e(n,e,i){const o={},s=new Float32Array(8),l=new WeakMap,d=new Pa,p=[];for(let y=0;y<8;y++)p[y]=[y,0];function f(y,_,x){const S=y.morphTargetInfluences;if(e.isWebGL2===!0){const I=_.morphAttributes.position||_.morphAttributes.normal||_.morphAttributes.color,R=I!==void 0?I.length:0;let D=l.get(_);if(D===void 0||D.count!==R){let Me=function(){ye.dispose(),l.delete(_),_.removeEventListener("dispose",Me)};var T=Me;D!==void 0&&D.texture.dispose();const N=_.morphAttributes.position!==void 0,F=_.morphAttributes.normal!==void 0,G=_.morphAttributes.color!==void 0,j=_.morphAttributes.position||[],Y=_.morphAttributes.normal||[],te=_.morphAttributes.color||[];let V=0;N===!0&&(V=1),F===!0&&(V=2),G===!0&&(V=3);let Q=_.attributes.position.count*V,he=1;Q>e.maxTextureSize&&(he=Math.ceil(Q/e.maxTextureSize),Q=e.maxTextureSize);const fe=new Float32Array(Q*he*4*R),ye=new WT(fe,Q,he,R);ye.type=ud,ye.needsUpdate=!0;const pe=V*4;for(let Ie=0;Ie<R;Ie++){const ze=j[Ie],le=Y[Ie],me=te[Ie],xe=Q*he*4*Ie;for(let ae=0;ae<ze.count;ae++){const Ee=ae*pe;N===!0&&(d.fromBufferAttribute(ze,ae),fe[xe+Ee+0]=d.x,fe[xe+Ee+1]=d.y,fe[xe+Ee+2]=d.z,fe[xe+Ee+3]=0),F===!0&&(d.fromBufferAttribute(le,ae),fe[xe+Ee+4]=d.x,fe[xe+Ee+5]=d.y,fe[xe+Ee+6]=d.z,fe[xe+Ee+7]=0),G===!0&&(d.fromBufferAttribute(me,ae),fe[xe+Ee+8]=d.x,fe[xe+Ee+9]=d.y,fe[xe+Ee+10]=d.z,fe[xe+Ee+11]=me.itemSize===4?d.w:1)}}D={count:R,texture:ye,size:new tn(Q,he)},l.set(_,D),_.addEventListener("dispose",Me)}let L=0;for(let N=0;N<S.length;N++)L+=S[N];const O=_.morphTargetsRelative?1:1-L;x.getUniforms().setValue(n,"morphTargetBaseInfluence",O),x.getUniforms().setValue(n,"morphTargetInfluences",S),x.getUniforms().setValue(n,"morphTargetsTexture",D.texture,i),x.getUniforms().setValue(n,"morphTargetsTextureSize",D.size)}else{const I=S===void 0?0:S.length;let R=o[_.id];if(R===void 0||R.length!==I){R=[];for(let F=0;F<I;F++)R[F]=[F,0];o[_.id]=R}for(let F=0;F<I;F++){const G=R[F];G[0]=F,G[1]=S[F]}R.sort(_2e);for(let F=0;F<8;F++)F<I&&R[F][1]?(p[F][0]=R[F][0],p[F][1]=R[F][1]):(p[F][0]=Number.MAX_SAFE_INTEGER,p[F][1]=0);p.sort(v2e);const D=_.morphAttributes.position,L=_.morphAttributes.normal;let O=0;for(let F=0;F<8;F++){const G=p[F],j=G[0],Y=G[1];j!==Number.MAX_SAFE_INTEGER&&Y?(D&&_.getAttribute("morphTarget"+F)!==D[j]&&_.setAttribute("morphTarget"+F,D[j]),L&&_.getAttribute("morphNormal"+F)!==L[j]&&_.setAttribute("morphNormal"+F,L[j]),s[F]=Y,O+=Y):(D&&_.hasAttribute("morphTarget"+F)===!0&&_.deleteAttribute("morphTarget"+F),L&&_.hasAttribute("morphNormal"+F)===!0&&_.deleteAttribute("morphNormal"+F),s[F]=0)}const N=_.morphTargetsRelative?1:1-O;x.getUniforms().setValue(n,"morphTargetBaseInfluence",N),x.getUniforms().setValue(n,"morphTargetInfluences",s)}}return{update:f}}function x2e(n,e,i,o){let s=new WeakMap;function l(f){const y=o.render.frame,_=f.geometry,x=e.get(f,_);if(s.get(x)!==y&&(e.update(x),s.set(x,y)),f.isInstancedMesh&&(f.hasEventListener("dispose",p)===!1&&f.addEventListener("dispose",p),s.get(f)!==y&&(i.update(f.instanceMatrix,n.ARRAY_BUFFER),f.instanceColor!==null&&i.update(f.instanceColor,n.ARRAY_BUFFER),s.set(f,y))),f.isSkinnedMesh){const S=f.skeleton;s.get(S)!==y&&(S.update(),s.set(S,y))}return x}function d(){s=new WeakMap}function p(f){const y=f.target;y.removeEventListener("dispose",p),i.remove(y.instanceMatrix),y.instanceColor!==null&&i.remove(y.instanceColor)}return{update:l,dispose:d}}const aZ=new Or,rZ=new WT,oZ=new h6,sZ=new Zw,UW=[],WW=[],VW=new Float32Array(16),GW=new Float32Array(9),HW=new Float32Array(4);function A_(n,e,i){const o=n[0];if(o<=0||o>0)return n;const s=e*i;let l=UW[s];if(l===void 0&&(l=new Float32Array(s),UW[s]=l),e!==0){o.toArray(l,0);for(let d=1,p=0;d!==e;++d)p+=i,n[d].toArray(l,p)}return l}function ko(n,e){if(n.length!==e.length)return!1;for(let i=0,o=n.length;i<o;i++)if(n[i]!==e[i])return!1;return!0}function Do(n,e){for(let i=0,o=e.length;i<o;i++)n[i]=e[i]}function GT(n,e){let i=WW[e];i===void 0&&(i=new Int32Array(e),WW[e]=i);for(let o=0;o!==e;++o)i[o]=n.allocateTextureUnit();return i}function w2e(n,e){const i=this.cache;i[0]!==e&&(n.uniform1f(this.addr,e),i[0]=e)}function S2e(n,e){const i=this.cache;if(e.x!==void 0)(i[0]!==e.x||i[1]!==e.y)&&(n.uniform2f(this.addr,e.x,e.y),i[0]=e.x,i[1]=e.y);else{if(ko(i,e))return;n.uniform2fv(this.addr,e),Do(i,e)}}function A2e(n,e){const i=this.cache;if(e.x!==void 0)(i[0]!==e.x||i[1]!==e.y||i[2]!==e.z)&&(n.uniform3f(this.addr,e.x,e.y,e.z),i[0]=e.x,i[1]=e.y,i[2]=e.z);else if(e.r!==void 0)(i[0]!==e.r||i[1]!==e.g||i[2]!==e.b)&&(n.uniform3f(this.addr,e.r,e.g,e.b),i[0]=e.r,i[1]=e.g,i[2]=e.b);else{if(ko(i,e))return;n.uniform3fv(this.addr,e),Do(i,e)}}function E2e(n,e){const i=this.cache;if(e.x!==void 0)(i[0]!==e.x||i[1]!==e.y||i[2]!==e.z||i[3]!==e.w)&&(n.uniform4f(this.addr,e.x,e.y,e.z,e.w),i[0]=e.x,i[1]=e.y,i[2]=e.z,i[3]=e.w);else{if(ko(i,e))return;n.uniform4fv(this.addr,e),Do(i,e)}}function M2e(n,e){const i=this.cache,o=e.elements;if(o===void 0){if(ko(i,e))return;n.uniformMatrix2fv(this.addr,!1,e),Do(i,e)}else{if(ko(i,o))return;HW.set(o),n.uniformMatrix2fv(this.addr,!1,HW),Do(i,o)}}function T2e(n,e){const i=this.cache,o=e.elements;if(o===void 0){if(ko(i,e))return;n.uniformMatrix3fv(this.addr,!1,e),Do(i,e)}else{if(ko(i,o))return;GW.set(o),n.uniformMatrix3fv(this.addr,!1,GW),Do(i,o)}}function C2e(n,e){const i=this.cache,o=e.elements;if(o===void 0){if(ko(i,e))return;n.uniformMatrix4fv(this.addr,!1,e),Do(i,e)}else{if(ko(i,o))return;VW.set(o),n.uniformMatrix4fv(this.addr,!1,VW),Do(i,o)}}function P2e(n,e){const i=this.cache;i[0]!==e&&(n.uniform1i(this.addr,e),i[0]=e)}function I2e(n,e){const i=this.cache;if(e.x!==void 0)(i[0]!==e.x||i[1]!==e.y)&&(n.uniform2i(this.addr,e.x,e.y),i[0]=e.x,i[1]=e.y);else{if(ko(i,e))return;n.uniform2iv(this.addr,e),Do(i,e)}}function L2e(n,e){const i=this.cache;if(e.x!==void 0)(i[0]!==e.x||i[1]!==e.y||i[2]!==e.z)&&(n.uniform3i(this.addr,e.x,e.y,e.z),i[0]=e.x,i[1]=e.y,i[2]=e.z);else{if(ko(i,e))return;n.uniform3iv(this.addr,e),Do(i,e)}}function R2e(n,e){const i=this.cache;if(e.x!==void 0)(i[0]!==e.x||i[1]!==e.y||i[2]!==e.z||i[3]!==e.w)&&(n.uniform4i(this.addr,e.x,e.y,e.z,e.w),i[0]=e.x,i[1]=e.y,i[2]=e.z,i[3]=e.w);else{if(ko(i,e))return;n.uniform4iv(this.addr,e),Do(i,e)}}function k2e(n,e){const i=this.cache;i[0]!==e&&(n.uniform1ui(this.addr,e),i[0]=e)}function D2e(n,e){const i=this.cache;if(e.x!==void 0)(i[0]!==e.x||i[1]!==e.y)&&(n.uniform2ui(this.addr,e.x,e.y),i[0]=e.x,i[1]=e.y);else{if(ko(i,e))return;n.uniform2uiv(this.addr,e),Do(i,e)}}function O2e(n,e){const i=this.cache;if(e.x!==void 0)(i[0]!==e.x||i[1]!==e.y||i[2]!==e.z)&&(n.uniform3ui(this.addr,e.x,e.y,e.z),i[0]=e.x,i[1]=e.y,i[2]=e.z);else{if(ko(i,e))return;n.uniform3uiv(this.addr,e),Do(i,e)}}function N2e(n,e){const i=this.cache;if(e.x!==void 0)(i[0]!==e.x||i[1]!==e.y||i[2]!==e.z||i[3]!==e.w)&&(n.uniform4ui(this.addr,e.x,e.y,e.z,e.w),i[0]=e.x,i[1]=e.y,i[2]=e.z,i[3]=e.w);else{if(ko(i,e))return;n.uniform4uiv(this.addr,e),Do(i,e)}}function z2e(n,e,i){const o=this.cache,s=i.allocateTextureUnit();o[0]!==s&&(n.uniform1i(this.addr,s),o[0]=s),i.setTexture2D(e||aZ,s)}function F2e(n,e,i){const o=this.cache,s=i.allocateTextureUnit();o[0]!==s&&(n.uniform1i(this.addr,s),o[0]=s),i.setTexture3D(e||oZ,s)}function B2e(n,e,i){const o=this.cache,s=i.allocateTextureUnit();o[0]!==s&&(n.uniform1i(this.addr,s),o[0]=s),i.setTextureCube(e||sZ,s)}function U2e(n,e,i){const o=this.cache,s=i.allocateTextureUnit();o[0]!==s&&(n.uniform1i(this.addr,s),o[0]=s),i.setTexture2DArray(e||rZ,s)}function W2e(n){switch(n){case 5126:return w2e;case 35664:return S2e;case 35665:return A2e;case 35666:return E2e;case 35674:return M2e;case 35675:return T2e;case 35676:return C2e;case 5124:case 35670:return P2e;case 35667:case 35671:return I2e;case 35668:case 35672:return L2e;case 35669:case 35673:return R2e;case 5125:return k2e;case 36294:return D2e;case 36295:return O2e;case 36296:return N2e;case 35678:case 36198:case 36298:case 36306:case 35682:return z2e;case 35679:case 36299:case 36307:return F2e;case 35680:case 36300:case 36308:case 36293:return B2e;case 36289:case 36303:case 36311:case 36292:return U2e}}function V2e(n,e){n.uniform1fv(this.addr,e)}function G2e(n,e){const i=A_(e,this.size,2);n.uniform2fv(this.addr,i)}function H2e(n,e){const i=A_(e,this.size,3);n.uniform3fv(this.addr,i)}function j2e(n,e){const i=A_(e,this.size,4);n.uniform4fv(this.addr,i)}function $2e(n,e){const i=A_(e,this.size,4);n.uniformMatrix2fv(this.addr,!1,i)}function Y2e(n,e){const i=A_(e,this.size,9);n.uniformMatrix3fv(this.addr,!1,i)}function q2e(n,e){const i=A_(e,this.size,16);n.uniformMatrix4fv(this.addr,!1,i)}function X2e(n,e){n.uniform1iv(this.addr,e)}function Z2e(n,e){n.uniform2iv(this.addr,e)}function K2e(n,e){n.uniform3iv(this.addr,e)}function J2e(n,e){n.uniform4iv(this.addr,e)}function Q2e(n,e){n.uniform1uiv(this.addr,e)}function e3e(n,e){n.uniform2uiv(this.addr,e)}function t3e(n,e){n.uniform3uiv(this.addr,e)}function n3e(n,e){n.uniform4uiv(this.addr,e)}function i3e(n,e,i){const o=this.cache,s=e.length,l=GT(i,s);ko(o,l)||(n.uniform1iv(this.addr,l),Do(o,l));for(let d=0;d!==s;++d)i.setTexture2D(e[d]||aZ,l[d])}function a3e(n,e,i){const o=this.cache,s=e.length,l=GT(i,s);ko(o,l)||(n.uniform1iv(this.addr,l),Do(o,l));for(let d=0;d!==s;++d)i.setTexture3D(e[d]||oZ,l[d])}function r3e(n,e,i){const o=this.cache,s=e.length,l=GT(i,s);ko(o,l)||(n.uniform1iv(this.addr,l),Do(o,l));for(let d=0;d!==s;++d)i.setTextureCube(e[d]||sZ,l[d])}function o3e(n,e,i){const o=this.cache,s=e.length,l=GT(i,s);ko(o,l)||(n.uniform1iv(this.addr,l),Do(o,l));for(let d=0;d!==s;++d)i.setTexture2DArray(e[d]||rZ,l[d])}function s3e(n){switch(n){case 5126:return V2e;case 35664:return G2e;case 35665:return H2e;case 35666:return j2e;case 35674:return $2e;case 35675:return Y2e;case 35676:return q2e;case 5124:case 35670:return X2e;case 35667:case 35671:return Z2e;case 35668:case 35672:return K2e;case 35669:case 35673:return J2e;case 5125:return Q2e;case 36294:return e3e;case 36295:return t3e;case 36296:return n3e;case 35678:case 36198:case 36298:case 36306:case 35682:return i3e;case 35679:case 36299:case 36307:return a3e;case 35680:case 36300:case 36308:case 36293:return r3e;case 36289:case 36303:case 36311:case 36292:return o3e}}class l3e{constructor(e,i,o){this.id=e,this.addr=o,this.cache=[],this.setValue=W2e(i.type)}}class c3e{constructor(e,i,o){this.id=e,this.addr=o,this.cache=[],this.size=i.size,this.setValue=s3e(i.type)}}class u3e{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,i,o){const s=this.seq;for(let l=0,d=s.length;l!==d;++l){const p=s[l];p.setValue(e,i[p.id],o)}}}const j4=/(\w+)(\])?(\[|\.)?/g;function jW(n,e){n.seq.push(e),n.map[e.id]=e}function d3e(n,e,i){const o=n.name,s=o.length;for(j4.lastIndex=0;;){const l=j4.exec(o),d=j4.lastIndex;let p=l[1];const f=l[2]==="]",y=l[3];if(f&&(p=p|0),y===void 0||y==="["&&d+2===s){jW(i,y===void 0?new l3e(p,n,e):new c3e(p,n,e));break}else{let x=i.map[p];x===void 0&&(x=new u3e(p),jW(i,x)),i=x}}}class hE{constructor(e,i){this.seq=[],this.map={};const o=e.getProgramParameter(i,e.ACTIVE_UNIFORMS);for(let s=0;s<o;++s){const l=e.getActiveUniform(i,s),d=e.getUniformLocation(i,l.name);d3e(l,d,this)}}setValue(e,i,o,s){const l=this.map[i];l!==void 0&&l.setValue(e,o,s)}setOptional(e,i,o){const s=i[o];s!==void 0&&this.setValue(e,o,s)}static upload(e,i,o,s){for(let l=0,d=i.length;l!==d;++l){const p=i[l],f=o[p.id];f.needsUpdate!==!1&&p.setValue(e,f.value,s)}}static seqWithValue(e,i){const o=[];for(let s=0,l=e.length;s!==l;++s){const d=e[s];d.id in i&&o.push(d)}return o}}function $W(n,e,i){const o=n.createShader(e);return n.shaderSource(o,i),n.compileShader(o),o}const h3e=37297;let p3e=0;function f3e(n,e){const i=n.split(`
`),o=[],s=Math.max(e-6,0),l=Math.min(e+6,i.length);for(let d=s;d<l;d++){const p=d+1;o.push(`${p===e?">":" "} ${p}: ${i[d]}`)}return o.join(`
`)}function m3e(n){const e=Ba.getPrimaries(Ba.workingColorSpace),i=Ba.getPrimaries(n);let o;switch(e===i?o="":e===uw&&i===cw?o="LinearDisplayP3ToLinearSRGB":e===cw&&i===uw&&(o="LinearSRGBToLinearDisplayP3"),n){case Sd:case Yw:return[o,"LinearTransferOETF"];case Io:case UT:return[o,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space:",n),[o,"LinearTransferOETF"]}}function YW(n,e,i){const o=n.getShaderParameter(e,n.COMPILE_STATUS),s=n.getShaderInfoLog(e).trim();if(o&&s==="")return"";const l=/ERROR: 0:(\d+)/.exec(s);if(l){const d=parseInt(l[1]);return i.toUpperCase()+`

`+s+`

`+f3e(n.getShaderSource(e),d)}else return s}function g3e(n,e){const i=m3e(e);return`vec4 ${n}( vec4 value ) { return ${i[0]}( ${i[1]}( value ) ); }`}function y3e(n,e){let i;switch(e){case wX:i="Linear";break;case SX:i="Reinhard";break;case AX:i="OptimizedCineon";break;case QD:i="ACESFilmic";break;case EX:i="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),i="Linear"}return"vec3 "+n+"( vec3 color ) { return "+i+"ToneMapping( color ); }"}function v3e(n){return[n.extensionDerivatives||n.envMapCubeUVHeight||n.bumpMap||n.normalMapTangentSpace||n.clearcoatNormalMap||n.flatShading||n.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(n.extensionFragDepth||n.logarithmicDepthBuffer)&&n.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",n.extensionDrawBuffers&&n.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(n.extensionShaderTextureLOD||n.envMap||n.transmission)&&n.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Vb).join(`
`)}function _3e(n){const e=[];for(const i in n){const o=n[i];o!==!1&&e.push("#define "+i+" "+o)}return e.join(`
`)}function b3e(n,e){const i={},o=n.getProgramParameter(e,n.ACTIVE_ATTRIBUTES);for(let s=0;s<o;s++){const l=n.getActiveAttrib(e,s),d=l.name;let p=1;l.type===n.FLOAT_MAT2&&(p=2),l.type===n.FLOAT_MAT3&&(p=3),l.type===n.FLOAT_MAT4&&(p=4),i[d]={type:l.type,location:n.getAttribLocation(e,d),locationSize:p}}return i}function Vb(n){return n!==""}function qW(n,e){const i=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return n.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,i).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function XW(n,e){return n.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const x3e=/^[ \t]*#include +<([\w\d./]+)>/gm;function RR(n){return n.replace(x3e,S3e)}const w3e=new Map([["encodings_fragment","colorspace_fragment"],["encodings_pars_fragment","colorspace_pars_fragment"],["output_fragment","opaque_fragment"]]);function S3e(n,e){let i=zi[e];if(i===void 0){const o=w3e.get(e);if(o!==void 0)i=zi[o],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,o);else throw new Error("Can not resolve #include <"+e+">")}return RR(i)}const A3e=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function ZW(n){return n.replace(A3e,E3e)}function E3e(n,e,i,o){let s="";for(let l=parseInt(e);l<parseInt(i);l++)s+=o.replace(/\[\s*i\s*\]/g,"[ "+l+" ]").replace(/UNROLLED_LOOP_INDEX/g,l);return s}function KW(n){let e="precision "+n.precision+` float;
precision `+n.precision+" int;";return n.precision==="highp"?e+=`
#define HIGH_PRECISION`:n.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:n.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function M3e(n){let e="SHADOWMAP_TYPE_BASIC";return n.shadowMapType===NT?e="SHADOWMAP_TYPE_PCF":n.shadowMapType===hx?e="SHADOWMAP_TYPE_PCF_SOFT":n.shadowMapType===au&&(e="SHADOWMAP_TYPE_VSM"),e}function T3e(n){let e="ENVMAP_TYPE_CUBE";if(n.envMap)switch(n.envMapMode){case Hh:case wf:e="ENVMAP_TYPE_CUBE";break;case S_:e="ENVMAP_TYPE_CUBE_UV";break}return e}function C3e(n){let e="ENVMAP_MODE_REFLECTION";if(n.envMap)switch(n.envMapMode){case wf:e="ENVMAP_MODE_REFRACTION";break}return e}function P3e(n){let e="ENVMAP_BLENDING_NONE";if(n.envMap)switch(n.combine){case $w:e="ENVMAP_BLENDING_MULTIPLY";break;case bX:e="ENVMAP_BLENDING_MIX";break;case xX:e="ENVMAP_BLENDING_ADD";break}return e}function I3e(n){const e=n.envMapCubeUVHeight;if(e===null)return null;const i=Math.log2(e)-2,o=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,i),7*16)),texelHeight:o,maxMip:i}}function L3e(n,e,i,o){const s=n.getContext(),l=i.defines;let d=i.vertexShader,p=i.fragmentShader;const f=M3e(i),y=T3e(i),_=C3e(i),x=P3e(i),S=I3e(i),T=i.isWebGL2?"":v3e(i),I=_3e(l),R=s.createProgram();let D,L,O=i.glslVersion?"#version "+i.glslVersion+`
`:"";i.isRawShaderMaterial?(D=["#define SHADER_TYPE "+i.shaderType,"#define SHADER_NAME "+i.shaderName,I].filter(Vb).join(`
`),D.length>0&&(D+=`
`),L=[T,"#define SHADER_TYPE "+i.shaderType,"#define SHADER_NAME "+i.shaderName,I].filter(Vb).join(`
`),L.length>0&&(L+=`
`)):(D=[KW(i),"#define SHADER_TYPE "+i.shaderType,"#define SHADER_NAME "+i.shaderName,I,i.instancing?"#define USE_INSTANCING":"",i.instancingColor?"#define USE_INSTANCING_COLOR":"",i.useFog&&i.fog?"#define USE_FOG":"",i.useFog&&i.fogExp2?"#define FOG_EXP2":"",i.map?"#define USE_MAP":"",i.envMap?"#define USE_ENVMAP":"",i.envMap?"#define "+_:"",i.lightMap?"#define USE_LIGHTMAP":"",i.aoMap?"#define USE_AOMAP":"",i.bumpMap?"#define USE_BUMPMAP":"",i.normalMap?"#define USE_NORMALMAP":"",i.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",i.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",i.displacementMap?"#define USE_DISPLACEMENTMAP":"",i.emissiveMap?"#define USE_EMISSIVEMAP":"",i.anisotropy?"#define USE_ANISOTROPY":"",i.anisotropyMap?"#define USE_ANISOTROPYMAP":"",i.clearcoatMap?"#define USE_CLEARCOATMAP":"",i.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",i.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",i.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",i.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",i.specularMap?"#define USE_SPECULARMAP":"",i.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",i.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",i.roughnessMap?"#define USE_ROUGHNESSMAP":"",i.metalnessMap?"#define USE_METALNESSMAP":"",i.alphaMap?"#define USE_ALPHAMAP":"",i.alphaHash?"#define USE_ALPHAHASH":"",i.transmission?"#define USE_TRANSMISSION":"",i.transmissionMap?"#define USE_TRANSMISSIONMAP":"",i.thicknessMap?"#define USE_THICKNESSMAP":"",i.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",i.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",i.mapUv?"#define MAP_UV "+i.mapUv:"",i.alphaMapUv?"#define ALPHAMAP_UV "+i.alphaMapUv:"",i.lightMapUv?"#define LIGHTMAP_UV "+i.lightMapUv:"",i.aoMapUv?"#define AOMAP_UV "+i.aoMapUv:"",i.emissiveMapUv?"#define EMISSIVEMAP_UV "+i.emissiveMapUv:"",i.bumpMapUv?"#define BUMPMAP_UV "+i.bumpMapUv:"",i.normalMapUv?"#define NORMALMAP_UV "+i.normalMapUv:"",i.displacementMapUv?"#define DISPLACEMENTMAP_UV "+i.displacementMapUv:"",i.metalnessMapUv?"#define METALNESSMAP_UV "+i.metalnessMapUv:"",i.roughnessMapUv?"#define ROUGHNESSMAP_UV "+i.roughnessMapUv:"",i.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+i.anisotropyMapUv:"",i.clearcoatMapUv?"#define CLEARCOATMAP_UV "+i.clearcoatMapUv:"",i.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+i.clearcoatNormalMapUv:"",i.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+i.clearcoatRoughnessMapUv:"",i.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+i.iridescenceMapUv:"",i.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+i.iridescenceThicknessMapUv:"",i.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+i.sheenColorMapUv:"",i.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+i.sheenRoughnessMapUv:"",i.specularMapUv?"#define SPECULARMAP_UV "+i.specularMapUv:"",i.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+i.specularColorMapUv:"",i.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+i.specularIntensityMapUv:"",i.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+i.transmissionMapUv:"",i.thicknessMapUv?"#define THICKNESSMAP_UV "+i.thicknessMapUv:"",i.vertexTangents&&i.flatShading===!1?"#define USE_TANGENT":"",i.vertexColors?"#define USE_COLOR":"",i.vertexAlphas?"#define USE_COLOR_ALPHA":"",i.vertexUv1s?"#define USE_UV1":"",i.vertexUv2s?"#define USE_UV2":"",i.vertexUv3s?"#define USE_UV3":"",i.pointsUvs?"#define USE_POINTS_UV":"",i.flatShading?"#define FLAT_SHADED":"",i.skinning?"#define USE_SKINNING":"",i.morphTargets?"#define USE_MORPHTARGETS":"",i.morphNormals&&i.flatShading===!1?"#define USE_MORPHNORMALS":"",i.morphColors&&i.isWebGL2?"#define USE_MORPHCOLORS":"",i.morphTargetsCount>0&&i.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",i.morphTargetsCount>0&&i.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+i.morphTextureStride:"",i.morphTargetsCount>0&&i.isWebGL2?"#define MORPHTARGETS_COUNT "+i.morphTargetsCount:"",i.doubleSided?"#define DOUBLE_SIDED":"",i.flipSided?"#define FLIP_SIDED":"",i.shadowMapEnabled?"#define USE_SHADOWMAP":"",i.shadowMapEnabled?"#define "+f:"",i.sizeAttenuation?"#define USE_SIZEATTENUATION":"",i.numLightProbes>0?"#define USE_LIGHT_PROBES":"",i.useLegacyLights?"#define LEGACY_LIGHTS":"",i.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",i.logarithmicDepthBuffer&&i.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(Vb).join(`
`),L=[T,KW(i),"#define SHADER_TYPE "+i.shaderType,"#define SHADER_NAME "+i.shaderName,I,i.useFog&&i.fog?"#define USE_FOG":"",i.useFog&&i.fogExp2?"#define FOG_EXP2":"",i.map?"#define USE_MAP":"",i.matcap?"#define USE_MATCAP":"",i.envMap?"#define USE_ENVMAP":"",i.envMap?"#define "+y:"",i.envMap?"#define "+_:"",i.envMap?"#define "+x:"",S?"#define CUBEUV_TEXEL_WIDTH "+S.texelWidth:"",S?"#define CUBEUV_TEXEL_HEIGHT "+S.texelHeight:"",S?"#define CUBEUV_MAX_MIP "+S.maxMip+".0":"",i.lightMap?"#define USE_LIGHTMAP":"",i.aoMap?"#define USE_AOMAP":"",i.bumpMap?"#define USE_BUMPMAP":"",i.normalMap?"#define USE_NORMALMAP":"",i.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",i.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",i.emissiveMap?"#define USE_EMISSIVEMAP":"",i.anisotropy?"#define USE_ANISOTROPY":"",i.anisotropyMap?"#define USE_ANISOTROPYMAP":"",i.clearcoat?"#define USE_CLEARCOAT":"",i.clearcoatMap?"#define USE_CLEARCOATMAP":"",i.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",i.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",i.iridescence?"#define USE_IRIDESCENCE":"",i.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",i.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",i.specularMap?"#define USE_SPECULARMAP":"",i.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",i.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",i.roughnessMap?"#define USE_ROUGHNESSMAP":"",i.metalnessMap?"#define USE_METALNESSMAP":"",i.alphaMap?"#define USE_ALPHAMAP":"",i.alphaTest?"#define USE_ALPHATEST":"",i.alphaHash?"#define USE_ALPHAHASH":"",i.sheen?"#define USE_SHEEN":"",i.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",i.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",i.transmission?"#define USE_TRANSMISSION":"",i.transmissionMap?"#define USE_TRANSMISSIONMAP":"",i.thicknessMap?"#define USE_THICKNESSMAP":"",i.vertexTangents&&i.flatShading===!1?"#define USE_TANGENT":"",i.vertexColors||i.instancingColor?"#define USE_COLOR":"",i.vertexAlphas?"#define USE_COLOR_ALPHA":"",i.vertexUv1s?"#define USE_UV1":"",i.vertexUv2s?"#define USE_UV2":"",i.vertexUv3s?"#define USE_UV3":"",i.pointsUvs?"#define USE_POINTS_UV":"",i.gradientMap?"#define USE_GRADIENTMAP":"",i.flatShading?"#define FLAT_SHADED":"",i.doubleSided?"#define DOUBLE_SIDED":"",i.flipSided?"#define FLIP_SIDED":"",i.shadowMapEnabled?"#define USE_SHADOWMAP":"",i.shadowMapEnabled?"#define "+f:"",i.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",i.numLightProbes>0?"#define USE_LIGHT_PROBES":"",i.useLegacyLights?"#define LEGACY_LIGHTS":"",i.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",i.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",i.logarithmicDepthBuffer&&i.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",i.toneMapping!==gd?"#define TONE_MAPPING":"",i.toneMapping!==gd?zi.tonemapping_pars_fragment:"",i.toneMapping!==gd?y3e("toneMapping",i.toneMapping):"",i.dithering?"#define DITHERING":"",i.opaque?"#define OPAQUE":"",zi.colorspace_pars_fragment,g3e("linearToOutputTexel",i.outputColorSpace),i.useDepthPacking?"#define DEPTH_PACKING "+i.depthPacking:"",`
`].filter(Vb).join(`
`)),d=RR(d),d=qW(d,i),d=XW(d,i),p=RR(p),p=qW(p,i),p=XW(p,i),d=ZW(d),p=ZW(p),i.isWebGL2&&i.isRawShaderMaterial!==!0&&(O=`#version 300 es
`,D=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+D,L=["precision mediump sampler2DArray;","#define varying in",i.glslVersion===PR?"":"layout(location = 0) out highp vec4 pc_fragColor;",i.glslVersion===PR?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+L);const N=O+D+d,F=O+L+p,G=$W(s,s.VERTEX_SHADER,N),j=$W(s,s.FRAGMENT_SHADER,F);s.attachShader(R,G),s.attachShader(R,j),i.index0AttributeName!==void 0?s.bindAttribLocation(R,0,i.index0AttributeName):i.morphTargets===!0&&s.bindAttribLocation(R,0,"position"),s.linkProgram(R);function Y(he){if(n.debug.checkShaderErrors){const fe=s.getProgramInfoLog(R).trim(),ye=s.getShaderInfoLog(G).trim(),pe=s.getShaderInfoLog(j).trim();let Me=!0,Ie=!0;if(s.getProgramParameter(R,s.LINK_STATUS)===!1)if(Me=!1,typeof n.debug.onShaderError=="function")n.debug.onShaderError(s,R,G,j);else{const ze=YW(s,G,"vertex"),le=YW(s,j,"fragment");console.error("THREE.WebGLProgram: Shader Error "+s.getError()+" - VALIDATE_STATUS "+s.getProgramParameter(R,s.VALIDATE_STATUS)+`

Program Info Log: `+fe+`
`+ze+`
`+le)}else fe!==""?console.warn("THREE.WebGLProgram: Program Info Log:",fe):(ye===""||pe==="")&&(Ie=!1);Ie&&(he.diagnostics={runnable:Me,programLog:fe,vertexShader:{log:ye,prefix:D},fragmentShader:{log:pe,prefix:L}})}s.deleteShader(G),s.deleteShader(j),te=new hE(s,R),V=b3e(s,R)}let te;this.getUniforms=function(){return te===void 0&&Y(this),te};let V;this.getAttributes=function(){return V===void 0&&Y(this),V};let Q=i.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return Q===!1&&(Q=s.getProgramParameter(R,h3e)),Q},this.destroy=function(){o.releaseStatesOfProgram(this),s.deleteProgram(R),this.program=void 0},this.type=i.shaderType,this.name=i.shaderName,this.id=p3e++,this.cacheKey=e,this.usedTimes=1,this.program=R,this.vertexShader=G,this.fragmentShader=j,this}let R3e=0;class k3e{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const i=e.vertexShader,o=e.fragmentShader,s=this._getShaderStage(i),l=this._getShaderStage(o),d=this._getShaderCacheForMaterial(e);return d.has(s)===!1&&(d.add(s),s.usedTimes++),d.has(l)===!1&&(d.add(l),l.usedTimes++),this}remove(e){const i=this.materialCache.get(e);for(const o of i)o.usedTimes--,o.usedTimes===0&&this.shaderCache.delete(o.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const i=this.materialCache;let o=i.get(e);return o===void 0&&(o=new Set,i.set(e,o)),o}_getShaderStage(e){const i=this.shaderCache;let o=i.get(e);return o===void 0&&(o=new D3e(e),i.set(e,o)),o}}class D3e{constructor(e){this.id=R3e++,this.code=e,this.usedTimes=0}}function O3e(n,e,i,o,s,l,d){const p=new Eg,f=new k3e,y=[],_=s.isWebGL2,x=s.logarithmicDepthBuffer,S=s.vertexTextures;let T=s.precision;const I={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function R(V){return V===0?"uv":`uv${V}`}function D(V,Q,he,fe,ye){const pe=fe.fog,Me=ye.geometry,Ie=V.isMeshStandardMaterial?fe.environment:null,ze=(V.isMeshStandardMaterial?i:e).get(V.envMap||Ie),le=ze&&ze.mapping===S_?ze.image.height:null,me=I[V.type];V.precision!==null&&(T=s.getMaxPrecision(V.precision),T!==V.precision&&console.warn("THREE.WebGLProgram.getParameters:",V.precision,"not supported, using",T,"instead."));const xe=Me.morphAttributes.position||Me.morphAttributes.normal||Me.morphAttributes.color,ae=xe!==void 0?xe.length:0;let Ee=0;Me.morphAttributes.position!==void 0&&(Ee=1),Me.morphAttributes.normal!==void 0&&(Ee=2),Me.morphAttributes.color!==void 0&&(Ee=3);let Je,Ze,Ke,Fe;if(me){const vt=lu[me];Je=vt.vertexShader,Ze=vt.fragmentShader}else Je=V.vertexShader,Ze=V.fragmentShader,f.update(V),Ke=f.getVertexShaderID(V),Fe=f.getFragmentShaderID(V);const ct=n.getRenderTarget(),Ct=ye.isInstancedMesh===!0,kt=!!V.map,Kt=!!V.matcap,At=!!ze,Pe=!!V.aoMap,ft=!!V.lightMap,gt=!!V.bumpMap,_t=!!V.normalMap,Be=!!V.displacementMap,ue=!!V.emissiveMap,se=!!V.metalnessMap,_e=!!V.roughnessMap,je=V.anisotropy>0,De=V.clearcoat>0,st=V.iridescence>0,de=V.sheen>0,ne=V.transmission>0,Oe=je&&!!V.anisotropyMap,ut=De&&!!V.clearcoatMap,it=De&&!!V.clearcoatNormalMap,lt=De&&!!V.clearcoatRoughnessMap,Et=st&&!!V.iridescenceMap,Ut=st&&!!V.iridescenceThicknessMap,Wt=de&&!!V.sheenColorMap,Ht=de&&!!V.sheenRoughnessMap,Dt=!!V.specularMap,wt=!!V.specularColorMap,Xt=!!V.specularIntensityMap,He=ne&&!!V.transmissionMap,Pt=ne&&!!V.thicknessMap,qt=!!V.gradientMap,Nt=!!V.alphaMap,hn=V.alphaTest>0,be=!!V.alphaHash,Qe=!!V.extensions,we=!!Me.attributes.uv1,Te=!!Me.attributes.uv2,Ne=!!Me.attributes.uv3;let et=gd;return V.toneMapped&&(ct===null||ct.isXRRenderTarget===!0)&&(et=n.toneMapping),{isWebGL2:_,shaderID:me,shaderType:V.type,shaderName:V.name,vertexShader:Je,fragmentShader:Ze,defines:V.defines,customVertexShaderID:Ke,customFragmentShaderID:Fe,isRawShaderMaterial:V.isRawShaderMaterial===!0,glslVersion:V.glslVersion,precision:T,instancing:Ct,instancingColor:Ct&&ye.instanceColor!==null,supportsVertexTextures:S,outputColorSpace:ct===null?n.outputColorSpace:ct.isXRRenderTarget===!0?ct.texture.colorSpace:Sd,map:kt,matcap:Kt,envMap:At,envMapMode:At&&ze.mapping,envMapCubeUVHeight:le,aoMap:Pe,lightMap:ft,bumpMap:gt,normalMap:_t,displacementMap:S&&Be,emissiveMap:ue,normalMapObjectSpace:_t&&V.normalMapType===UX,normalMapTangentSpace:_t&&V.normalMapType===Lf,metalnessMap:se,roughnessMap:_e,anisotropy:je,anisotropyMap:Oe,clearcoat:De,clearcoatMap:ut,clearcoatNormalMap:it,clearcoatRoughnessMap:lt,iridescence:st,iridescenceMap:Et,iridescenceThicknessMap:Ut,sheen:de,sheenColorMap:Wt,sheenRoughnessMap:Ht,specularMap:Dt,specularColorMap:wt,specularIntensityMap:Xt,transmission:ne,transmissionMap:He,thicknessMap:Pt,gradientMap:qt,opaque:V.transparent===!1&&V.blending===Sg,alphaMap:Nt,alphaTest:hn,alphaHash:be,combine:V.combine,mapUv:kt&&R(V.map.channel),aoMapUv:Pe&&R(V.aoMap.channel),lightMapUv:ft&&R(V.lightMap.channel),bumpMapUv:gt&&R(V.bumpMap.channel),normalMapUv:_t&&R(V.normalMap.channel),displacementMapUv:Be&&R(V.displacementMap.channel),emissiveMapUv:ue&&R(V.emissiveMap.channel),metalnessMapUv:se&&R(V.metalnessMap.channel),roughnessMapUv:_e&&R(V.roughnessMap.channel),anisotropyMapUv:Oe&&R(V.anisotropyMap.channel),clearcoatMapUv:ut&&R(V.clearcoatMap.channel),clearcoatNormalMapUv:it&&R(V.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:lt&&R(V.clearcoatRoughnessMap.channel),iridescenceMapUv:Et&&R(V.iridescenceMap.channel),iridescenceThicknessMapUv:Ut&&R(V.iridescenceThicknessMap.channel),sheenColorMapUv:Wt&&R(V.sheenColorMap.channel),sheenRoughnessMapUv:Ht&&R(V.sheenRoughnessMap.channel),specularMapUv:Dt&&R(V.specularMap.channel),specularColorMapUv:wt&&R(V.specularColorMap.channel),specularIntensityMapUv:Xt&&R(V.specularIntensityMap.channel),transmissionMapUv:He&&R(V.transmissionMap.channel),thicknessMapUv:Pt&&R(V.thicknessMap.channel),alphaMapUv:Nt&&R(V.alphaMap.channel),vertexTangents:!!Me.attributes.tangent&&(_t||je),vertexColors:V.vertexColors,vertexAlphas:V.vertexColors===!0&&!!Me.attributes.color&&Me.attributes.color.itemSize===4,vertexUv1s:we,vertexUv2s:Te,vertexUv3s:Ne,pointsUvs:ye.isPoints===!0&&!!Me.attributes.uv&&(kt||Nt),fog:!!pe,useFog:V.fog===!0,fogExp2:pe&&pe.isFogExp2,flatShading:V.flatShading===!0,sizeAttenuation:V.sizeAttenuation===!0,logarithmicDepthBuffer:x,skinning:ye.isSkinnedMesh===!0,morphTargets:Me.morphAttributes.position!==void 0,morphNormals:Me.morphAttributes.normal!==void 0,morphColors:Me.morphAttributes.color!==void 0,morphTargetsCount:ae,morphTextureStride:Ee,numDirLights:Q.directional.length,numPointLights:Q.point.length,numSpotLights:Q.spot.length,numSpotLightMaps:Q.spotLightMap.length,numRectAreaLights:Q.rectArea.length,numHemiLights:Q.hemi.length,numDirLightShadows:Q.directionalShadowMap.length,numPointLightShadows:Q.pointShadowMap.length,numSpotLightShadows:Q.spotShadowMap.length,numSpotLightShadowsWithMaps:Q.numSpotLightShadowsWithMaps,numLightProbes:Q.numLightProbes,numClippingPlanes:d.numPlanes,numClipIntersection:d.numIntersection,dithering:V.dithering,shadowMapEnabled:n.shadowMap.enabled&&he.length>0,shadowMapType:n.shadowMap.type,toneMapping:et,useLegacyLights:n._useLegacyLights,decodeVideoTexture:kt&&V.map.isVideoTexture===!0&&Ba.getTransfer(V.map.colorSpace)===tr,premultipliedAlpha:V.premultipliedAlpha,doubleSided:V.side===jl,flipSided:V.side===Ss,useDepthPacking:V.depthPacking>=0,depthPacking:V.depthPacking||0,index0AttributeName:V.index0AttributeName,extensionDerivatives:Qe&&V.extensions.derivatives===!0,extensionFragDepth:Qe&&V.extensions.fragDepth===!0,extensionDrawBuffers:Qe&&V.extensions.drawBuffers===!0,extensionShaderTextureLOD:Qe&&V.extensions.shaderTextureLOD===!0,rendererExtensionFragDepth:_||o.has("EXT_frag_depth"),rendererExtensionDrawBuffers:_||o.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:_||o.has("EXT_shader_texture_lod"),rendererExtensionParallelShaderCompile:o.has("KHR_parallel_shader_compile"),customProgramCacheKey:V.customProgramCacheKey()}}function L(V){const Q=[];if(V.shaderID?Q.push(V.shaderID):(Q.push(V.customVertexShaderID),Q.push(V.customFragmentShaderID)),V.defines!==void 0)for(const he in V.defines)Q.push(he),Q.push(V.defines[he]);return V.isRawShaderMaterial===!1&&(O(Q,V),N(Q,V),Q.push(n.outputColorSpace)),Q.push(V.customProgramCacheKey),Q.join()}function O(V,Q){V.push(Q.precision),V.push(Q.outputColorSpace),V.push(Q.envMapMode),V.push(Q.envMapCubeUVHeight),V.push(Q.mapUv),V.push(Q.alphaMapUv),V.push(Q.lightMapUv),V.push(Q.aoMapUv),V.push(Q.bumpMapUv),V.push(Q.normalMapUv),V.push(Q.displacementMapUv),V.push(Q.emissiveMapUv),V.push(Q.metalnessMapUv),V.push(Q.roughnessMapUv),V.push(Q.anisotropyMapUv),V.push(Q.clearcoatMapUv),V.push(Q.clearcoatNormalMapUv),V.push(Q.clearcoatRoughnessMapUv),V.push(Q.iridescenceMapUv),V.push(Q.iridescenceThicknessMapUv),V.push(Q.sheenColorMapUv),V.push(Q.sheenRoughnessMapUv),V.push(Q.specularMapUv),V.push(Q.specularColorMapUv),V.push(Q.specularIntensityMapUv),V.push(Q.transmissionMapUv),V.push(Q.thicknessMapUv),V.push(Q.combine),V.push(Q.fogExp2),V.push(Q.sizeAttenuation),V.push(Q.morphTargetsCount),V.push(Q.morphAttributeCount),V.push(Q.numDirLights),V.push(Q.numPointLights),V.push(Q.numSpotLights),V.push(Q.numSpotLightMaps),V.push(Q.numHemiLights),V.push(Q.numRectAreaLights),V.push(Q.numDirLightShadows),V.push(Q.numPointLightShadows),V.push(Q.numSpotLightShadows),V.push(Q.numSpotLightShadowsWithMaps),V.push(Q.numLightProbes),V.push(Q.shadowMapType),V.push(Q.toneMapping),V.push(Q.numClippingPlanes),V.push(Q.numClipIntersection),V.push(Q.depthPacking)}function N(V,Q){p.disableAll(),Q.isWebGL2&&p.enable(0),Q.supportsVertexTextures&&p.enable(1),Q.instancing&&p.enable(2),Q.instancingColor&&p.enable(3),Q.matcap&&p.enable(4),Q.envMap&&p.enable(5),Q.normalMapObjectSpace&&p.enable(6),Q.normalMapTangentSpace&&p.enable(7),Q.clearcoat&&p.enable(8),Q.iridescence&&p.enable(9),Q.alphaTest&&p.enable(10),Q.vertexColors&&p.enable(11),Q.vertexAlphas&&p.enable(12),Q.vertexUv1s&&p.enable(13),Q.vertexUv2s&&p.enable(14),Q.vertexUv3s&&p.enable(15),Q.vertexTangents&&p.enable(16),Q.anisotropy&&p.enable(17),Q.alphaHash&&p.enable(18),V.push(p.mask),p.disableAll(),Q.fog&&p.enable(0),Q.useFog&&p.enable(1),Q.flatShading&&p.enable(2),Q.logarithmicDepthBuffer&&p.enable(3),Q.skinning&&p.enable(4),Q.morphTargets&&p.enable(5),Q.morphNormals&&p.enable(6),Q.morphColors&&p.enable(7),Q.premultipliedAlpha&&p.enable(8),Q.shadowMapEnabled&&p.enable(9),Q.useLegacyLights&&p.enable(10),Q.doubleSided&&p.enable(11),Q.flipSided&&p.enable(12),Q.useDepthPacking&&p.enable(13),Q.dithering&&p.enable(14),Q.transmission&&p.enable(15),Q.sheen&&p.enable(16),Q.opaque&&p.enable(17),Q.pointsUvs&&p.enable(18),Q.decodeVideoTexture&&p.enable(19),V.push(p.mask)}function F(V){const Q=I[V.type];let he;if(Q){const fe=lu[Q];he=m6.clone(fe.uniforms)}else he=V.uniforms;return he}function G(V,Q){let he;for(let fe=0,ye=y.length;fe<ye;fe++){const pe=y[fe];if(pe.cacheKey===Q){he=pe,++he.usedTimes;break}}return he===void 0&&(he=new L3e(n,Q,V,l),y.push(he)),he}function j(V){if(--V.usedTimes===0){const Q=y.indexOf(V);y[Q]=y[y.length-1],y.pop(),V.destroy()}}function Y(V){f.remove(V)}function te(){f.dispose()}return{getParameters:D,getProgramCacheKey:L,getUniforms:F,acquireProgram:G,releaseProgram:j,releaseShaderCache:Y,programs:y,dispose:te}}function N3e(){let n=new WeakMap;function e(l){let d=n.get(l);return d===void 0&&(d={},n.set(l,d)),d}function i(l){n.delete(l)}function o(l,d,p){n.get(l)[d]=p}function s(){n=new WeakMap}return{get:e,remove:i,update:o,dispose:s}}function z3e(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.material.id!==e.material.id?n.material.id-e.material.id:n.z!==e.z?n.z-e.z:n.id-e.id}function JW(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.z!==e.z?e.z-n.z:n.id-e.id}function QW(){const n=[];let e=0;const i=[],o=[],s=[];function l(){e=0,i.length=0,o.length=0,s.length=0}function d(x,S,T,I,R,D){let L=n[e];return L===void 0?(L={id:x.id,object:x,geometry:S,material:T,groupOrder:I,renderOrder:x.renderOrder,z:R,group:D},n[e]=L):(L.id=x.id,L.object=x,L.geometry=S,L.material=T,L.groupOrder=I,L.renderOrder=x.renderOrder,L.z=R,L.group=D),e++,L}function p(x,S,T,I,R,D){const L=d(x,S,T,I,R,D);T.transmission>0?o.push(L):T.transparent===!0?s.push(L):i.push(L)}function f(x,S,T,I,R,D){const L=d(x,S,T,I,R,D);T.transmission>0?o.unshift(L):T.transparent===!0?s.unshift(L):i.unshift(L)}function y(x,S){i.length>1&&i.sort(x||z3e),o.length>1&&o.sort(S||JW),s.length>1&&s.sort(S||JW)}function _(){for(let x=e,S=n.length;x<S;x++){const T=n[x];if(T.id===null)break;T.id=null,T.object=null,T.geometry=null,T.material=null,T.group=null}}return{opaque:i,transmissive:o,transparent:s,init:l,push:p,unshift:f,finish:_,sort:y}}function F3e(){let n=new WeakMap;function e(o,s){const l=n.get(o);let d;return l===void 0?(d=new QW,n.set(o,[d])):s>=l.length?(d=new QW,l.push(d)):d=l[s],d}function i(){n=new WeakMap}return{get:e,dispose:i}}function B3e(){const n={};return{get:function(e){if(n[e.id]!==void 0)return n[e.id];let i;switch(e.type){case"DirectionalLight":i={direction:new Ue,color:new Pn};break;case"SpotLight":i={position:new Ue,direction:new Ue,color:new Pn,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":i={position:new Ue,color:new Pn,distance:0,decay:0};break;case"HemisphereLight":i={direction:new Ue,skyColor:new Pn,groundColor:new Pn};break;case"RectAreaLight":i={color:new Pn,position:new Ue,halfWidth:new Ue,halfHeight:new Ue};break}return n[e.id]=i,i}}}function U3e(){const n={};return{get:function(e){if(n[e.id]!==void 0)return n[e.id];let i;switch(e.type){case"DirectionalLight":i={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new tn};break;case"SpotLight":i={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new tn};break;case"PointLight":i={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new tn,shadowCameraNear:1,shadowCameraFar:1e3};break}return n[e.id]=i,i}}}let W3e=0;function V3e(n,e){return(e.castShadow?2:0)-(n.castShadow?2:0)+(e.map?1:0)-(n.map?1:0)}function G3e(n,e){const i=new B3e,o=U3e(),s={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let _=0;_<9;_++)s.probe.push(new Ue);const l=new Ue,d=new Ri,p=new Ri;function f(_,x){let S=0,T=0,I=0;for(let fe=0;fe<9;fe++)s.probe[fe].set(0,0,0);let R=0,D=0,L=0,O=0,N=0,F=0,G=0,j=0,Y=0,te=0,V=0;_.sort(V3e);const Q=x===!0?Math.PI:1;for(let fe=0,ye=_.length;fe<ye;fe++){const pe=_[fe],Me=pe.color,Ie=pe.intensity,ze=pe.distance,le=pe.shadow&&pe.shadow.map?pe.shadow.map.texture:null;if(pe.isAmbientLight)S+=Me.r*Ie*Q,T+=Me.g*Ie*Q,I+=Me.b*Ie*Q;else if(pe.isLightProbe){for(let me=0;me<9;me++)s.probe[me].addScaledVector(pe.sh.coefficients[me],Ie);V++}else if(pe.isDirectionalLight){const me=i.get(pe);if(me.color.copy(pe.color).multiplyScalar(pe.intensity*Q),pe.castShadow){const xe=pe.shadow,ae=o.get(pe);ae.shadowBias=xe.bias,ae.shadowNormalBias=xe.normalBias,ae.shadowRadius=xe.radius,ae.shadowMapSize=xe.mapSize,s.directionalShadow[R]=ae,s.directionalShadowMap[R]=le,s.directionalShadowMatrix[R]=pe.shadow.matrix,F++}s.directional[R]=me,R++}else if(pe.isSpotLight){const me=i.get(pe);me.position.setFromMatrixPosition(pe.matrixWorld),me.color.copy(Me).multiplyScalar(Ie*Q),me.distance=ze,me.coneCos=Math.cos(pe.angle),me.penumbraCos=Math.cos(pe.angle*(1-pe.penumbra)),me.decay=pe.decay,s.spot[L]=me;const xe=pe.shadow;if(pe.map&&(s.spotLightMap[Y]=pe.map,Y++,xe.updateMatrices(pe),pe.castShadow&&te++),s.spotLightMatrix[L]=xe.matrix,pe.castShadow){const ae=o.get(pe);ae.shadowBias=xe.bias,ae.shadowNormalBias=xe.normalBias,ae.shadowRadius=xe.radius,ae.shadowMapSize=xe.mapSize,s.spotShadow[L]=ae,s.spotShadowMap[L]=le,j++}L++}else if(pe.isRectAreaLight){const me=i.get(pe);me.color.copy(Me).multiplyScalar(Ie),me.halfWidth.set(pe.width*.5,0,0),me.halfHeight.set(0,pe.height*.5,0),s.rectArea[O]=me,O++}else if(pe.isPointLight){const me=i.get(pe);if(me.color.copy(pe.color).multiplyScalar(pe.intensity*Q),me.distance=pe.distance,me.decay=pe.decay,pe.castShadow){const xe=pe.shadow,ae=o.get(pe);ae.shadowBias=xe.bias,ae.shadowNormalBias=xe.normalBias,ae.shadowRadius=xe.radius,ae.shadowMapSize=xe.mapSize,ae.shadowCameraNear=xe.camera.near,ae.shadowCameraFar=xe.camera.far,s.pointShadow[D]=ae,s.pointShadowMap[D]=le,s.pointShadowMatrix[D]=pe.shadow.matrix,G++}s.point[D]=me,D++}else if(pe.isHemisphereLight){const me=i.get(pe);me.skyColor.copy(pe.color).multiplyScalar(Ie*Q),me.groundColor.copy(pe.groundColor).multiplyScalar(Ie*Q),s.hemi[N]=me,N++}}O>0&&(e.isWebGL2||n.has("OES_texture_float_linear")===!0?(s.rectAreaLTC1=wn.LTC_FLOAT_1,s.rectAreaLTC2=wn.LTC_FLOAT_2):n.has("OES_texture_half_float_linear")===!0?(s.rectAreaLTC1=wn.LTC_HALF_1,s.rectAreaLTC2=wn.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),s.ambient[0]=S,s.ambient[1]=T,s.ambient[2]=I;const he=s.hash;(he.directionalLength!==R||he.pointLength!==D||he.spotLength!==L||he.rectAreaLength!==O||he.hemiLength!==N||he.numDirectionalShadows!==F||he.numPointShadows!==G||he.numSpotShadows!==j||he.numSpotMaps!==Y||he.numLightProbes!==V)&&(s.directional.length=R,s.spot.length=L,s.rectArea.length=O,s.point.length=D,s.hemi.length=N,s.directionalShadow.length=F,s.directionalShadowMap.length=F,s.pointShadow.length=G,s.pointShadowMap.length=G,s.spotShadow.length=j,s.spotShadowMap.length=j,s.directionalShadowMatrix.length=F,s.pointShadowMatrix.length=G,s.spotLightMatrix.length=j+Y-te,s.spotLightMap.length=Y,s.numSpotLightShadowsWithMaps=te,s.numLightProbes=V,he.directionalLength=R,he.pointLength=D,he.spotLength=L,he.rectAreaLength=O,he.hemiLength=N,he.numDirectionalShadows=F,he.numPointShadows=G,he.numSpotShadows=j,he.numSpotMaps=Y,he.numLightProbes=V,s.version=W3e++)}function y(_,x){let S=0,T=0,I=0,R=0,D=0;const L=x.matrixWorldInverse;for(let O=0,N=_.length;O<N;O++){const F=_[O];if(F.isDirectionalLight){const G=s.directional[S];G.direction.setFromMatrixPosition(F.matrixWorld),l.setFromMatrixPosition(F.target.matrixWorld),G.direction.sub(l),G.direction.transformDirection(L),S++}else if(F.isSpotLight){const G=s.spot[I];G.position.setFromMatrixPosition(F.matrixWorld),G.position.applyMatrix4(L),G.direction.setFromMatrixPosition(F.matrixWorld),l.setFromMatrixPosition(F.target.matrixWorld),G.direction.sub(l),G.direction.transformDirection(L),I++}else if(F.isRectAreaLight){const G=s.rectArea[R];G.position.setFromMatrixPosition(F.matrixWorld),G.position.applyMatrix4(L),p.identity(),d.copy(F.matrixWorld),d.premultiply(L),p.extractRotation(d),G.halfWidth.set(F.width*.5,0,0),G.halfHeight.set(0,F.height*.5,0),G.halfWidth.applyMatrix4(p),G.halfHeight.applyMatrix4(p),R++}else if(F.isPointLight){const G=s.point[T];G.position.setFromMatrixPosition(F.matrixWorld),G.position.applyMatrix4(L),T++}else if(F.isHemisphereLight){const G=s.hemi[D];G.direction.setFromMatrixPosition(F.matrixWorld),G.direction.transformDirection(L),D++}}}return{setup:f,setupView:y,state:s}}function eV(n,e){const i=new G3e(n,e),o=[],s=[];function l(){o.length=0,s.length=0}function d(x){o.push(x)}function p(x){s.push(x)}function f(x){i.setup(o,x)}function y(x){i.setupView(o,x)}return{init:l,state:{lightsArray:o,shadowsArray:s,lights:i},setupLights:f,setupLightsView:y,pushLight:d,pushShadow:p}}function H3e(n,e){let i=new WeakMap;function o(l,d=0){const p=i.get(l);let f;return p===void 0?(f=new eV(n,e),i.set(l,[f])):d>=p.length?(f=new eV(n,e),p.push(f)):f=p[d],f}function s(){i=new WeakMap}return{get:o,dispose:s}}class HT extends es{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=BX,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class jT extends es{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}const j3e=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,$3e=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function Y3e(n,e,i){let o=new VT;const s=new tn,l=new tn,d=new Pa,p=new HT({depthPacking:c6}),f=new jT,y={},_=i.maxTextureSize,x={[wd]:Ss,[Ss]:wd,[jl]:jl},S=new Ad({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new tn},radius:{value:4}},vertexShader:j3e,fragmentShader:$3e}),T=S.clone();T.defines.HORIZONTAL_PASS=1;const I=new ki;I.setAttribute("position",new Za(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const R=new wo(I,S),D=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=NT;let L=this.type;this.render=function(G,j,Y){if(D.enabled===!1||D.autoUpdate===!1&&D.needsUpdate===!1||G.length===0)return;const te=n.getRenderTarget(),V=n.getActiveCubeFace(),Q=n.getActiveMipmapLevel(),he=n.state;he.setBlending(zh),he.buffers.color.setClear(1,1,1,1),he.buffers.depth.setTest(!0),he.setScissorTest(!1);const fe=L!==au&&this.type===au,ye=L===au&&this.type!==au;for(let pe=0,Me=G.length;pe<Me;pe++){const Ie=G[pe],ze=Ie.shadow;if(ze===void 0){console.warn("THREE.WebGLShadowMap:",Ie,"has no shadow.");continue}if(ze.autoUpdate===!1&&ze.needsUpdate===!1)continue;s.copy(ze.mapSize);const le=ze.getFrameExtents();if(s.multiply(le),l.copy(ze.mapSize),(s.x>_||s.y>_)&&(s.x>_&&(l.x=Math.floor(_/le.x),s.x=l.x*le.x,ze.mapSize.x=l.x),s.y>_&&(l.y=Math.floor(_/le.y),s.y=l.y*le.y,ze.mapSize.y=l.y)),ze.map===null||fe===!0||ye===!0){const xe=this.type!==au?{minFilter:so,magFilter:so}:{};ze.map!==null&&ze.map.dispose(),ze.map=new yu(s.x,s.y,xe),ze.map.texture.name=Ie.name+".shadowMap",ze.camera.updateProjectionMatrix()}n.setRenderTarget(ze.map),n.clear();const me=ze.getViewportCount();for(let xe=0;xe<me;xe++){const ae=ze.getViewport(xe);d.set(l.x*ae.x,l.y*ae.y,l.x*ae.z,l.y*ae.w),he.viewport(d),ze.updateMatrices(Ie,xe),o=ze.getFrustum(),F(j,Y,ze.camera,Ie,this.type)}ze.isPointLightShadow!==!0&&this.type===au&&O(ze,Y),ze.needsUpdate=!1}L=this.type,D.needsUpdate=!1,n.setRenderTarget(te,V,Q)};function O(G,j){const Y=e.update(R);S.defines.VSM_SAMPLES!==G.blurSamples&&(S.defines.VSM_SAMPLES=G.blurSamples,T.defines.VSM_SAMPLES=G.blurSamples,S.needsUpdate=!0,T.needsUpdate=!0),G.mapPass===null&&(G.mapPass=new yu(s.x,s.y)),S.uniforms.shadow_pass.value=G.map.texture,S.uniforms.resolution.value=G.mapSize,S.uniforms.radius.value=G.radius,n.setRenderTarget(G.mapPass),n.clear(),n.renderBufferDirect(j,null,Y,S,R,null),T.uniforms.shadow_pass.value=G.mapPass.texture,T.uniforms.resolution.value=G.mapSize,T.uniforms.radius.value=G.radius,n.setRenderTarget(G.map),n.clear(),n.renderBufferDirect(j,null,Y,T,R,null)}function N(G,j,Y,te){let V=null;const Q=Y.isPointLight===!0?G.customDistanceMaterial:G.customDepthMaterial;if(Q!==void 0)V=Q;else if(V=Y.isPointLight===!0?f:p,n.localClippingEnabled&&j.clipShadows===!0&&Array.isArray(j.clippingPlanes)&&j.clippingPlanes.length!==0||j.displacementMap&&j.displacementScale!==0||j.alphaMap&&j.alphaTest>0||j.map&&j.alphaTest>0){const he=V.uuid,fe=j.uuid;let ye=y[he];ye===void 0&&(ye={},y[he]=ye);let pe=ye[fe];pe===void 0&&(pe=V.clone(),ye[fe]=pe),V=pe}if(V.visible=j.visible,V.wireframe=j.wireframe,te===au?V.side=j.shadowSide!==null?j.shadowSide:j.side:V.side=j.shadowSide!==null?j.shadowSide:x[j.side],V.alphaMap=j.alphaMap,V.alphaTest=j.alphaTest,V.map=j.map,V.clipShadows=j.clipShadows,V.clippingPlanes=j.clippingPlanes,V.clipIntersection=j.clipIntersection,V.displacementMap=j.displacementMap,V.displacementScale=j.displacementScale,V.displacementBias=j.displacementBias,V.wireframeLinewidth=j.wireframeLinewidth,V.linewidth=j.linewidth,Y.isPointLight===!0&&V.isMeshDistanceMaterial===!0){const he=n.properties.get(V);he.light=Y}return V}function F(G,j,Y,te,V){if(G.visible===!1)return;if(G.layers.test(j.layers)&&(G.isMesh||G.isLine||G.isPoints)&&(G.castShadow||G.receiveShadow&&V===au)&&(!G.frustumCulled||o.intersectsObject(G))){G.modelViewMatrix.multiplyMatrices(Y.matrixWorldInverse,G.matrixWorld);const fe=e.update(G),ye=G.material;if(Array.isArray(ye)){const pe=fe.groups;for(let Me=0,Ie=pe.length;Me<Ie;Me++){const ze=pe[Me],le=ye[ze.materialIndex];if(le&&le.visible){const me=N(G,le,te,V);n.renderBufferDirect(Y,null,fe,me,G,ze)}}}else if(ye.visible){const pe=N(G,ye,te,V);n.renderBufferDirect(Y,null,fe,pe,G,null)}}const he=G.children;for(let fe=0,ye=he.length;fe<ye;fe++)F(he[fe],j,Y,te,V)}}function q3e(n,e,i){const o=i.isWebGL2;function s(){let be=!1;const Qe=new Pa;let we=null;const Te=new Pa(0,0,0,0);return{setMask:function(Ne){we!==Ne&&!be&&(n.colorMask(Ne,Ne,Ne,Ne),we=Ne)},setLocked:function(Ne){be=Ne},setClear:function(Ne,et,tt,vt,ht){ht===!0&&(Ne*=vt,et*=vt,tt*=vt),Qe.set(Ne,et,tt,vt),Te.equals(Qe)===!1&&(n.clearColor(Ne,et,tt,vt),Te.copy(Qe))},reset:function(){be=!1,we=null,Te.set(-1,0,0,0)}}}function l(){let be=!1,Qe=null,we=null,Te=null;return{setTest:function(Ne){Ne?kt(n.DEPTH_TEST):Kt(n.DEPTH_TEST)},setMask:function(Ne){Qe!==Ne&&!be&&(n.depthMask(Ne),Qe=Ne)},setFunc:function(Ne){if(we!==Ne){switch(Ne){case pX:n.depthFunc(n.NEVER);break;case fX:n.depthFunc(n.ALWAYS);break;case mX:n.depthFunc(n.LESS);break;case ew:n.depthFunc(n.LEQUAL);break;case gX:n.depthFunc(n.EQUAL);break;case yX:n.depthFunc(n.GEQUAL);break;case vX:n.depthFunc(n.GREATER);break;case _X:n.depthFunc(n.NOTEQUAL);break;default:n.depthFunc(n.LEQUAL)}we=Ne}},setLocked:function(Ne){be=Ne},setClear:function(Ne){Te!==Ne&&(n.clearDepth(Ne),Te=Ne)},reset:function(){be=!1,Qe=null,we=null,Te=null}}}function d(){let be=!1,Qe=null,we=null,Te=null,Ne=null,et=null,tt=null,vt=null,ht=null;return{setTest:function(dt){be||(dt?kt(n.STENCIL_TEST):Kt(n.STENCIL_TEST))},setMask:function(dt){Qe!==dt&&!be&&(n.stencilMask(dt),Qe=dt)},setFunc:function(dt,Vt,It){(we!==dt||Te!==Vt||Ne!==It)&&(n.stencilFunc(dt,Vt,It),we=dt,Te=Vt,Ne=It)},setOp:function(dt,Vt,It){(et!==dt||tt!==Vt||vt!==It)&&(n.stencilOp(dt,Vt,It),et=dt,tt=Vt,vt=It)},setLocked:function(dt){be=dt},setClear:function(dt){ht!==dt&&(n.clearStencil(dt),ht=dt)},reset:function(){be=!1,Qe=null,we=null,Te=null,Ne=null,et=null,tt=null,vt=null,ht=null}}}const p=new s,f=new l,y=new d,_=new WeakMap,x=new WeakMap;let S={},T={},I=new WeakMap,R=[],D=null,L=!1,O=null,N=null,F=null,G=null,j=null,Y=null,te=null,V=new Pn(0,0,0),Q=0,he=!1,fe=null,ye=null,pe=null,Me=null,Ie=null;const ze=n.getParameter(n.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let le=!1,me=0;const xe=n.getParameter(n.VERSION);xe.indexOf("WebGL")!==-1?(me=parseFloat(/^WebGL (\d)/.exec(xe)[1]),le=me>=1):xe.indexOf("OpenGL ES")!==-1&&(me=parseFloat(/^OpenGL ES (\d)/.exec(xe)[1]),le=me>=2);let ae=null,Ee={};const Je=n.getParameter(n.SCISSOR_BOX),Ze=n.getParameter(n.VIEWPORT),Ke=new Pa().fromArray(Je),Fe=new Pa().fromArray(Ze);function ct(be,Qe,we,Te){const Ne=new Uint8Array(4),et=n.createTexture();n.bindTexture(be,et),n.texParameteri(be,n.TEXTURE_MIN_FILTER,n.NEAREST),n.texParameteri(be,n.TEXTURE_MAG_FILTER,n.NEAREST);for(let tt=0;tt<we;tt++)o&&(be===n.TEXTURE_3D||be===n.TEXTURE_2D_ARRAY)?n.texImage3D(Qe,0,n.RGBA,1,1,Te,0,n.RGBA,n.UNSIGNED_BYTE,Ne):n.texImage2D(Qe+tt,0,n.RGBA,1,1,0,n.RGBA,n.UNSIGNED_BYTE,Ne);return et}const Ct={};Ct[n.TEXTURE_2D]=ct(n.TEXTURE_2D,n.TEXTURE_2D,1),Ct[n.TEXTURE_CUBE_MAP]=ct(n.TEXTURE_CUBE_MAP,n.TEXTURE_CUBE_MAP_POSITIVE_X,6),o&&(Ct[n.TEXTURE_2D_ARRAY]=ct(n.TEXTURE_2D_ARRAY,n.TEXTURE_2D_ARRAY,1,1),Ct[n.TEXTURE_3D]=ct(n.TEXTURE_3D,n.TEXTURE_3D,1,1)),p.setClear(0,0,0,1),f.setClear(1),y.setClear(0),kt(n.DEPTH_TEST),f.setFunc(ew),se(!1),_e(ZL),kt(n.CULL_FACE),Be(zh);function kt(be){S[be]!==!0&&(n.enable(be),S[be]=!0)}function Kt(be){S[be]!==!1&&(n.disable(be),S[be]=!1)}function At(be,Qe){return T[be]!==Qe?(n.bindFramebuffer(be,Qe),T[be]=Qe,o&&(be===n.DRAW_FRAMEBUFFER&&(T[n.FRAMEBUFFER]=Qe),be===n.FRAMEBUFFER&&(T[n.DRAW_FRAMEBUFFER]=Qe)),!0):!1}function Pe(be,Qe){let we=R,Te=!1;if(be)if(we=I.get(Qe),we===void 0&&(we=[],I.set(Qe,we)),be.isWebGLMultipleRenderTargets){const Ne=be.texture;if(we.length!==Ne.length||we[0]!==n.COLOR_ATTACHMENT0){for(let et=0,tt=Ne.length;et<tt;et++)we[et]=n.COLOR_ATTACHMENT0+et;we.length=Ne.length,Te=!0}}else we[0]!==n.COLOR_ATTACHMENT0&&(we[0]=n.COLOR_ATTACHMENT0,Te=!0);else we[0]!==n.BACK&&(we[0]=n.BACK,Te=!0);Te&&(i.isWebGL2?n.drawBuffers(we):e.get("WEBGL_draw_buffers").drawBuffersWEBGL(we))}function ft(be){return D!==be?(n.useProgram(be),D=be,!0):!1}const gt={[Zp]:n.FUNC_ADD,[Jq]:n.FUNC_SUBTRACT,[Qq]:n.FUNC_REVERSE_SUBTRACT};if(o)gt[eR]=n.MIN,gt[tR]=n.MAX;else{const be=e.get("EXT_blend_minmax");be!==null&&(gt[eR]=be.MIN_EXT,gt[tR]=be.MAX_EXT)}const _t={[eX]:n.ZERO,[tX]:n.ONE,[nX]:n.SRC_COLOR,[rM]:n.SRC_ALPHA,[lX]:n.SRC_ALPHA_SATURATE,[oX]:n.DST_COLOR,[aX]:n.DST_ALPHA,[iX]:n.ONE_MINUS_SRC_COLOR,[oM]:n.ONE_MINUS_SRC_ALPHA,[sX]:n.ONE_MINUS_DST_COLOR,[rX]:n.ONE_MINUS_DST_ALPHA,[cX]:n.CONSTANT_COLOR,[uX]:n.ONE_MINUS_CONSTANT_COLOR,[dX]:n.CONSTANT_ALPHA,[hX]:n.ONE_MINUS_CONSTANT_ALPHA};function Be(be,Qe,we,Te,Ne,et,tt,vt,ht,dt){if(be===zh){L===!0&&(Kt(n.BLEND),L=!1);return}if(L===!1&&(kt(n.BLEND),L=!0),be!==Kq){if(be!==O||dt!==he){if((N!==Zp||j!==Zp)&&(n.blendEquation(n.FUNC_ADD),N=Zp,j=Zp),dt)switch(be){case Sg:n.blendFuncSeparate(n.ONE,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case KL:n.blendFunc(n.ONE,n.ONE);break;case JL:n.blendFuncSeparate(n.ZERO,n.ONE_MINUS_SRC_COLOR,n.ZERO,n.ONE);break;case QL:n.blendFuncSeparate(n.ZERO,n.SRC_COLOR,n.ZERO,n.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",be);break}else switch(be){case Sg:n.blendFuncSeparate(n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case KL:n.blendFunc(n.SRC_ALPHA,n.ONE);break;case JL:n.blendFuncSeparate(n.ZERO,n.ONE_MINUS_SRC_COLOR,n.ZERO,n.ONE);break;case QL:n.blendFunc(n.ZERO,n.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",be);break}F=null,G=null,Y=null,te=null,V.set(0,0,0),Q=0,O=be,he=dt}return}Ne=Ne||Qe,et=et||we,tt=tt||Te,(Qe!==N||Ne!==j)&&(n.blendEquationSeparate(gt[Qe],gt[Ne]),N=Qe,j=Ne),(we!==F||Te!==G||et!==Y||tt!==te)&&(n.blendFuncSeparate(_t[we],_t[Te],_t[et],_t[tt]),F=we,G=Te,Y=et,te=tt),(vt.equals(V)===!1||ht!==Q)&&(n.blendColor(vt.r,vt.g,vt.b,ht),V.copy(vt),Q=ht),O=be,he=!1}function ue(be,Qe){be.side===jl?Kt(n.CULL_FACE):kt(n.CULL_FACE);let we=be.side===Ss;Qe&&(we=!we),se(we),be.blending===Sg&&be.transparent===!1?Be(zh):Be(be.blending,be.blendEquation,be.blendSrc,be.blendDst,be.blendEquationAlpha,be.blendSrcAlpha,be.blendDstAlpha,be.blendColor,be.blendAlpha,be.premultipliedAlpha),f.setFunc(be.depthFunc),f.setTest(be.depthTest),f.setMask(be.depthWrite),p.setMask(be.colorWrite);const Te=be.stencilWrite;y.setTest(Te),Te&&(y.setMask(be.stencilWriteMask),y.setFunc(be.stencilFunc,be.stencilRef,be.stencilFuncMask),y.setOp(be.stencilFail,be.stencilZFail,be.stencilZPass)),De(be.polygonOffset,be.polygonOffsetFactor,be.polygonOffsetUnits),be.alphaToCoverage===!0?kt(n.SAMPLE_ALPHA_TO_COVERAGE):Kt(n.SAMPLE_ALPHA_TO_COVERAGE)}function se(be){fe!==be&&(be?n.frontFace(n.CW):n.frontFace(n.CCW),fe=be)}function _e(be){be!==qq?(kt(n.CULL_FACE),be!==ye&&(be===ZL?n.cullFace(n.BACK):be===Xq?n.cullFace(n.FRONT):n.cullFace(n.FRONT_AND_BACK))):Kt(n.CULL_FACE),ye=be}function je(be){be!==pe&&(le&&n.lineWidth(be),pe=be)}function De(be,Qe,we){be?(kt(n.POLYGON_OFFSET_FILL),(Me!==Qe||Ie!==we)&&(n.polygonOffset(Qe,we),Me=Qe,Ie=we)):Kt(n.POLYGON_OFFSET_FILL)}function st(be){be?kt(n.SCISSOR_TEST):Kt(n.SCISSOR_TEST)}function de(be){be===void 0&&(be=n.TEXTURE0+ze-1),ae!==be&&(n.activeTexture(be),ae=be)}function ne(be,Qe,we){we===void 0&&(ae===null?we=n.TEXTURE0+ze-1:we=ae);let Te=Ee[we];Te===void 0&&(Te={type:void 0,texture:void 0},Ee[we]=Te),(Te.type!==be||Te.texture!==Qe)&&(ae!==we&&(n.activeTexture(we),ae=we),n.bindTexture(be,Qe||Ct[be]),Te.type=be,Te.texture=Qe)}function Oe(){const be=Ee[ae];be!==void 0&&be.type!==void 0&&(n.bindTexture(be.type,null),be.type=void 0,be.texture=void 0)}function ut(){try{n.compressedTexImage2D.apply(n,arguments)}catch(be){console.error("THREE.WebGLState:",be)}}function it(){try{n.compressedTexImage3D.apply(n,arguments)}catch(be){console.error("THREE.WebGLState:",be)}}function lt(){try{n.texSubImage2D.apply(n,arguments)}catch(be){console.error("THREE.WebGLState:",be)}}function Et(){try{n.texSubImage3D.apply(n,arguments)}catch(be){console.error("THREE.WebGLState:",be)}}function Ut(){try{n.compressedTexSubImage2D.apply(n,arguments)}catch(be){console.error("THREE.WebGLState:",be)}}function Wt(){try{n.compressedTexSubImage3D.apply(n,arguments)}catch(be){console.error("THREE.WebGLState:",be)}}function Ht(){try{n.texStorage2D.apply(n,arguments)}catch(be){console.error("THREE.WebGLState:",be)}}function Dt(){try{n.texStorage3D.apply(n,arguments)}catch(be){console.error("THREE.WebGLState:",be)}}function wt(){try{n.texImage2D.apply(n,arguments)}catch(be){console.error("THREE.WebGLState:",be)}}function Xt(){try{n.texImage3D.apply(n,arguments)}catch(be){console.error("THREE.WebGLState:",be)}}function He(be){Ke.equals(be)===!1&&(n.scissor(be.x,be.y,be.z,be.w),Ke.copy(be))}function Pt(be){Fe.equals(be)===!1&&(n.viewport(be.x,be.y,be.z,be.w),Fe.copy(be))}function qt(be,Qe){let we=x.get(Qe);we===void 0&&(we=new WeakMap,x.set(Qe,we));let Te=we.get(be);Te===void 0&&(Te=n.getUniformBlockIndex(Qe,be.name),we.set(be,Te))}function Nt(be,Qe){const Te=x.get(Qe).get(be);_.get(Qe)!==Te&&(n.uniformBlockBinding(Qe,Te,be.__bindingPointIndex),_.set(Qe,Te))}function hn(){n.disable(n.BLEND),n.disable(n.CULL_FACE),n.disable(n.DEPTH_TEST),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SCISSOR_TEST),n.disable(n.STENCIL_TEST),n.disable(n.SAMPLE_ALPHA_TO_COVERAGE),n.blendEquation(n.FUNC_ADD),n.blendFunc(n.ONE,n.ZERO),n.blendFuncSeparate(n.ONE,n.ZERO,n.ONE,n.ZERO),n.blendColor(0,0,0,0),n.colorMask(!0,!0,!0,!0),n.clearColor(0,0,0,0),n.depthMask(!0),n.depthFunc(n.LESS),n.clearDepth(1),n.stencilMask(4294967295),n.stencilFunc(n.ALWAYS,0,4294967295),n.stencilOp(n.KEEP,n.KEEP,n.KEEP),n.clearStencil(0),n.cullFace(n.BACK),n.frontFace(n.CCW),n.polygonOffset(0,0),n.activeTexture(n.TEXTURE0),n.bindFramebuffer(n.FRAMEBUFFER,null),o===!0&&(n.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),n.bindFramebuffer(n.READ_FRAMEBUFFER,null)),n.useProgram(null),n.lineWidth(1),n.scissor(0,0,n.canvas.width,n.canvas.height),n.viewport(0,0,n.canvas.width,n.canvas.height),S={},ae=null,Ee={},T={},I=new WeakMap,R=[],D=null,L=!1,O=null,N=null,F=null,G=null,j=null,Y=null,te=null,V=new Pn(0,0,0),Q=0,he=!1,fe=null,ye=null,pe=null,Me=null,Ie=null,Ke.set(0,0,n.canvas.width,n.canvas.height),Fe.set(0,0,n.canvas.width,n.canvas.height),p.reset(),f.reset(),y.reset()}return{buffers:{color:p,depth:f,stencil:y},enable:kt,disable:Kt,bindFramebuffer:At,drawBuffers:Pe,useProgram:ft,setBlending:Be,setMaterial:ue,setFlipSided:se,setCullFace:_e,setLineWidth:je,setPolygonOffset:De,setScissorTest:st,activeTexture:de,bindTexture:ne,unbindTexture:Oe,compressedTexImage2D:ut,compressedTexImage3D:it,texImage2D:wt,texImage3D:Xt,updateUBOMapping:qt,uniformBlockBinding:Nt,texStorage2D:Ht,texStorage3D:Dt,texSubImage2D:lt,texSubImage3D:Et,compressedTexSubImage2D:Ut,compressedTexSubImage3D:Wt,scissor:He,viewport:Pt,reset:hn}}function X3e(n,e,i,o,s,l,d){const p=s.isWebGL2,f=s.maxTextures,y=s.maxCubemapSize,_=s.maxTextureSize,x=s.maxSamples,S=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,T=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),I=new WeakMap;let R;const D=new WeakMap;let L=!1;try{L=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function O(de,ne){return L?new OffscreenCanvas(de,ne):pw("canvas")}function N(de,ne,Oe,ut){let it=1;if((de.width>ut||de.height>ut)&&(it=ut/Math.max(de.width,de.height)),it<1||ne===!0)if(typeof HTMLImageElement<"u"&&de instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&de instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&de instanceof ImageBitmap){const lt=ne?cM:Math.floor,Et=lt(it*de.width),Ut=lt(it*de.height);R===void 0&&(R=O(Et,Ut));const Wt=Oe?O(Et,Ut):R;return Wt.width=Et,Wt.height=Ut,Wt.getContext("2d").drawImage(de,0,0,Et,Ut),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+de.width+"x"+de.height+") to ("+Et+"x"+Ut+")."),Wt}else return"data"in de&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+de.width+"x"+de.height+")."),de;return de}function F(de){return IR(de.width)&&IR(de.height)}function G(de){return p?!1:de.wrapS!==bs||de.wrapT!==bs||de.minFilter!==so&&de.minFilter!==Lr}function j(de,ne){return de.generateMipmaps&&ne&&de.minFilter!==so&&de.minFilter!==Lr}function Y(de){n.generateMipmap(de)}function te(de,ne,Oe,ut,it=!1){if(p===!1)return ne;if(de!==null){if(n[de]!==void 0)return n[de];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+de+"'")}let lt=ne;if(ne===n.RED&&(Oe===n.FLOAT&&(lt=n.R32F),Oe===n.HALF_FLOAT&&(lt=n.R16F),Oe===n.UNSIGNED_BYTE&&(lt=n.R8)),ne===n.RED_INTEGER&&(Oe===n.UNSIGNED_BYTE&&(lt=n.R8UI),Oe===n.UNSIGNED_SHORT&&(lt=n.R16UI),Oe===n.UNSIGNED_INT&&(lt=n.R32UI),Oe===n.BYTE&&(lt=n.R8I),Oe===n.SHORT&&(lt=n.R16I),Oe===n.INT&&(lt=n.R32I)),ne===n.RG&&(Oe===n.FLOAT&&(lt=n.RG32F),Oe===n.HALF_FLOAT&&(lt=n.RG16F),Oe===n.UNSIGNED_BYTE&&(lt=n.RG8)),ne===n.RGBA){const Et=it?lw:Ba.getTransfer(ut);Oe===n.FLOAT&&(lt=n.RGBA32F),Oe===n.HALF_FLOAT&&(lt=n.RGBA16F),Oe===n.UNSIGNED_BYTE&&(lt=Et===tr?n.SRGB8_ALPHA8:n.RGBA8),Oe===n.UNSIGNED_SHORT_4_4_4_4&&(lt=n.RGBA4),Oe===n.UNSIGNED_SHORT_5_5_5_1&&(lt=n.RGB5_A1)}return(lt===n.R16F||lt===n.R32F||lt===n.RG16F||lt===n.RG32F||lt===n.RGBA16F||lt===n.RGBA32F)&&e.get("EXT_color_buffer_float"),lt}function V(de,ne,Oe){return j(de,Oe)===!0||de.isFramebufferTexture&&de.minFilter!==so&&de.minFilter!==Lr?Math.log2(Math.max(ne.width,ne.height))+1:de.mipmaps!==void 0&&de.mipmaps.length>0?de.mipmaps.length:de.isCompressedTexture&&Array.isArray(de.image)?ne.mipmaps.length:1}function Q(de){return de===so||de===sM||de===px?n.NEAREST:n.LINEAR}function he(de){const ne=de.target;ne.removeEventListener("dispose",he),ye(ne),ne.isVideoTexture&&I.delete(ne)}function fe(de){const ne=de.target;ne.removeEventListener("dispose",fe),Me(ne)}function ye(de){const ne=o.get(de);if(ne.__webglInit===void 0)return;const Oe=de.source,ut=D.get(Oe);if(ut){const it=ut[ne.__cacheKey];it.usedTimes--,it.usedTimes===0&&pe(de),Object.keys(ut).length===0&&D.delete(Oe)}o.remove(de)}function pe(de){const ne=o.get(de);n.deleteTexture(ne.__webglTexture);const Oe=de.source,ut=D.get(Oe);delete ut[ne.__cacheKey],d.memory.textures--}function Me(de){const ne=de.texture,Oe=o.get(de),ut=o.get(ne);if(ut.__webglTexture!==void 0&&(n.deleteTexture(ut.__webglTexture),d.memory.textures--),de.depthTexture&&de.depthTexture.dispose(),de.isWebGLCubeRenderTarget)for(let it=0;it<6;it++){if(Array.isArray(Oe.__webglFramebuffer[it]))for(let lt=0;lt<Oe.__webglFramebuffer[it].length;lt++)n.deleteFramebuffer(Oe.__webglFramebuffer[it][lt]);else n.deleteFramebuffer(Oe.__webglFramebuffer[it]);Oe.__webglDepthbuffer&&n.deleteRenderbuffer(Oe.__webglDepthbuffer[it])}else{if(Array.isArray(Oe.__webglFramebuffer))for(let it=0;it<Oe.__webglFramebuffer.length;it++)n.deleteFramebuffer(Oe.__webglFramebuffer[it]);else n.deleteFramebuffer(Oe.__webglFramebuffer);if(Oe.__webglDepthbuffer&&n.deleteRenderbuffer(Oe.__webglDepthbuffer),Oe.__webglMultisampledFramebuffer&&n.deleteFramebuffer(Oe.__webglMultisampledFramebuffer),Oe.__webglColorRenderbuffer)for(let it=0;it<Oe.__webglColorRenderbuffer.length;it++)Oe.__webglColorRenderbuffer[it]&&n.deleteRenderbuffer(Oe.__webglColorRenderbuffer[it]);Oe.__webglDepthRenderbuffer&&n.deleteRenderbuffer(Oe.__webglDepthRenderbuffer)}if(de.isWebGLMultipleRenderTargets)for(let it=0,lt=ne.length;it<lt;it++){const Et=o.get(ne[it]);Et.__webglTexture&&(n.deleteTexture(Et.__webglTexture),d.memory.textures--),o.remove(ne[it])}o.remove(ne),o.remove(de)}let Ie=0;function ze(){Ie=0}function le(){const de=Ie;return de>=f&&console.warn("THREE.WebGLTextures: Trying to use "+de+" texture units while this GPU supports only "+f),Ie+=1,de}function me(de){const ne=[];return ne.push(de.wrapS),ne.push(de.wrapT),ne.push(de.wrapR||0),ne.push(de.magFilter),ne.push(de.minFilter),ne.push(de.anisotropy),ne.push(de.internalFormat),ne.push(de.format),ne.push(de.type),ne.push(de.generateMipmaps),ne.push(de.premultiplyAlpha),ne.push(de.flipY),ne.push(de.unpackAlignment),ne.push(de.colorSpace),ne.join()}function xe(de,ne){const Oe=o.get(de);if(de.isVideoTexture&&De(de),de.isRenderTargetTexture===!1&&de.version>0&&Oe.__version!==de.version){const ut=de.image;if(ut===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(ut.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{kt(Oe,de,ne);return}}i.bindTexture(n.TEXTURE_2D,Oe.__webglTexture,n.TEXTURE0+ne)}function ae(de,ne){const Oe=o.get(de);if(de.version>0&&Oe.__version!==de.version){kt(Oe,de,ne);return}i.bindTexture(n.TEXTURE_2D_ARRAY,Oe.__webglTexture,n.TEXTURE0+ne)}function Ee(de,ne){const Oe=o.get(de);if(de.version>0&&Oe.__version!==de.version){kt(Oe,de,ne);return}i.bindTexture(n.TEXTURE_3D,Oe.__webglTexture,n.TEXTURE0+ne)}function Je(de,ne){const Oe=o.get(de);if(de.version>0&&Oe.__version!==de.version){Kt(Oe,de,ne);return}i.bindTexture(n.TEXTURE_CUBE_MAP,Oe.__webglTexture,n.TEXTURE0+ne)}const Ze={[iw]:n.REPEAT,[bs]:n.CLAMP_TO_EDGE,[aw]:n.MIRRORED_REPEAT},Ke={[so]:n.NEAREST,[sM]:n.NEAREST_MIPMAP_NEAREST,[px]:n.NEAREST_MIPMAP_LINEAR,[Lr]:n.LINEAR,[e6]:n.LINEAR_MIPMAP_NEAREST,[Sf]:n.LINEAR_MIPMAP_LINEAR},Fe={[WX]:n.NEVER,[qX]:n.ALWAYS,[VX]:n.LESS,[HX]:n.LEQUAL,[GX]:n.EQUAL,[YX]:n.GEQUAL,[jX]:n.GREATER,[$X]:n.NOTEQUAL};function ct(de,ne,Oe){if(Oe?(n.texParameteri(de,n.TEXTURE_WRAP_S,Ze[ne.wrapS]),n.texParameteri(de,n.TEXTURE_WRAP_T,Ze[ne.wrapT]),(de===n.TEXTURE_3D||de===n.TEXTURE_2D_ARRAY)&&n.texParameteri(de,n.TEXTURE_WRAP_R,Ze[ne.wrapR]),n.texParameteri(de,n.TEXTURE_MAG_FILTER,Ke[ne.magFilter]),n.texParameteri(de,n.TEXTURE_MIN_FILTER,Ke[ne.minFilter])):(n.texParameteri(de,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(de,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),(de===n.TEXTURE_3D||de===n.TEXTURE_2D_ARRAY)&&n.texParameteri(de,n.TEXTURE_WRAP_R,n.CLAMP_TO_EDGE),(ne.wrapS!==bs||ne.wrapT!==bs)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),n.texParameteri(de,n.TEXTURE_MAG_FILTER,Q(ne.magFilter)),n.texParameteri(de,n.TEXTURE_MIN_FILTER,Q(ne.minFilter)),ne.minFilter!==so&&ne.minFilter!==Lr&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),ne.compareFunction&&(n.texParameteri(de,n.TEXTURE_COMPARE_MODE,n.COMPARE_REF_TO_TEXTURE),n.texParameteri(de,n.TEXTURE_COMPARE_FUNC,Fe[ne.compareFunction])),e.has("EXT_texture_filter_anisotropic")===!0){const ut=e.get("EXT_texture_filter_anisotropic");if(ne.magFilter===so||ne.minFilter!==px&&ne.minFilter!==Sf||ne.type===ud&&e.has("OES_texture_float_linear")===!1||p===!1&&ne.type===u_&&e.has("OES_texture_half_float_linear")===!1)return;(ne.anisotropy>1||o.get(ne).__currentAnisotropy)&&(n.texParameterf(de,ut.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(ne.anisotropy,s.getMaxAnisotropy())),o.get(ne).__currentAnisotropy=ne.anisotropy)}}function Ct(de,ne){let Oe=!1;de.__webglInit===void 0&&(de.__webglInit=!0,ne.addEventListener("dispose",he));const ut=ne.source;let it=D.get(ut);it===void 0&&(it={},D.set(ut,it));const lt=me(ne);if(lt!==de.__cacheKey){it[lt]===void 0&&(it[lt]={texture:n.createTexture(),usedTimes:0},d.memory.textures++,Oe=!0),it[lt].usedTimes++;const Et=it[de.__cacheKey];Et!==void 0&&(it[de.__cacheKey].usedTimes--,Et.usedTimes===0&&pe(ne)),de.__cacheKey=lt,de.__webglTexture=it[lt].texture}return Oe}function kt(de,ne,Oe){let ut=n.TEXTURE_2D;(ne.isDataArrayTexture||ne.isCompressedArrayTexture)&&(ut=n.TEXTURE_2D_ARRAY),ne.isData3DTexture&&(ut=n.TEXTURE_3D);const it=Ct(de,ne),lt=ne.source;i.bindTexture(ut,de.__webglTexture,n.TEXTURE0+Oe);const Et=o.get(lt);if(lt.version!==Et.__version||it===!0){i.activeTexture(n.TEXTURE0+Oe);const Ut=Ba.getPrimaries(Ba.workingColorSpace),Wt=ne.colorSpace===$l?null:Ba.getPrimaries(ne.colorSpace),Ht=ne.colorSpace===$l||Ut===Wt?n.NONE:n.BROWSER_DEFAULT_WEBGL;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,ne.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,ne.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,ne.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,Ht);const Dt=G(ne)&&F(ne.image)===!1;let wt=N(ne.image,Dt,!1,_);wt=st(ne,wt);const Xt=F(wt)||p,He=l.convert(ne.format,ne.colorSpace);let Pt=l.convert(ne.type),qt=te(ne.internalFormat,He,Pt,ne.colorSpace,ne.isVideoTexture);ct(ut,ne,Xt);let Nt;const hn=ne.mipmaps,be=p&&ne.isVideoTexture!==!0,Qe=Et.__version===void 0||it===!0,we=V(ne,wt,Xt);if(ne.isDepthTexture)qt=n.DEPTH_COMPONENT,p?ne.type===ud?qt=n.DEPTH_COMPONENT32F:ne.type===Lh?qt=n.DEPTH_COMPONENT24:ne.type===ff?qt=n.DEPTH24_STENCIL8:qt=n.DEPTH_COMPONENT16:ne.type===ud&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),ne.format===mf&&qt===n.DEPTH_COMPONENT&&ne.type!==FT&&ne.type!==Lh&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),ne.type=Lh,Pt=l.convert(ne.type)),ne.format===Bg&&qt===n.DEPTH_COMPONENT&&(qt=n.DEPTH_STENCIL,ne.type!==ff&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),ne.type=ff,Pt=l.convert(ne.type))),Qe&&(be?i.texStorage2D(n.TEXTURE_2D,1,qt,wt.width,wt.height):i.texImage2D(n.TEXTURE_2D,0,qt,wt.width,wt.height,0,He,Pt,null));else if(ne.isDataTexture)if(hn.length>0&&Xt){be&&Qe&&i.texStorage2D(n.TEXTURE_2D,we,qt,hn[0].width,hn[0].height);for(let Te=0,Ne=hn.length;Te<Ne;Te++)Nt=hn[Te],be?i.texSubImage2D(n.TEXTURE_2D,Te,0,0,Nt.width,Nt.height,He,Pt,Nt.data):i.texImage2D(n.TEXTURE_2D,Te,qt,Nt.width,Nt.height,0,He,Pt,Nt.data);ne.generateMipmaps=!1}else be?(Qe&&i.texStorage2D(n.TEXTURE_2D,we,qt,wt.width,wt.height),i.texSubImage2D(n.TEXTURE_2D,0,0,0,wt.width,wt.height,He,Pt,wt.data)):i.texImage2D(n.TEXTURE_2D,0,qt,wt.width,wt.height,0,He,Pt,wt.data);else if(ne.isCompressedTexture)if(ne.isCompressedArrayTexture){be&&Qe&&i.texStorage3D(n.TEXTURE_2D_ARRAY,we,qt,hn[0].width,hn[0].height,wt.depth);for(let Te=0,Ne=hn.length;Te<Ne;Te++)Nt=hn[Te],ne.format!==ml?He!==null?be?i.compressedTexSubImage3D(n.TEXTURE_2D_ARRAY,Te,0,0,0,Nt.width,Nt.height,wt.depth,He,Nt.data,0,0):i.compressedTexImage3D(n.TEXTURE_2D_ARRAY,Te,qt,Nt.width,Nt.height,wt.depth,0,Nt.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):be?i.texSubImage3D(n.TEXTURE_2D_ARRAY,Te,0,0,0,Nt.width,Nt.height,wt.depth,He,Pt,Nt.data):i.texImage3D(n.TEXTURE_2D_ARRAY,Te,qt,Nt.width,Nt.height,wt.depth,0,He,Pt,Nt.data)}else{be&&Qe&&i.texStorage2D(n.TEXTURE_2D,we,qt,hn[0].width,hn[0].height);for(let Te=0,Ne=hn.length;Te<Ne;Te++)Nt=hn[Te],ne.format!==ml?He!==null?be?i.compressedTexSubImage2D(n.TEXTURE_2D,Te,0,0,Nt.width,Nt.height,He,Nt.data):i.compressedTexImage2D(n.TEXTURE_2D,Te,qt,Nt.width,Nt.height,0,Nt.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):be?i.texSubImage2D(n.TEXTURE_2D,Te,0,0,Nt.width,Nt.height,He,Pt,Nt.data):i.texImage2D(n.TEXTURE_2D,Te,qt,Nt.width,Nt.height,0,He,Pt,Nt.data)}else if(ne.isDataArrayTexture)be?(Qe&&i.texStorage3D(n.TEXTURE_2D_ARRAY,we,qt,wt.width,wt.height,wt.depth),i.texSubImage3D(n.TEXTURE_2D_ARRAY,0,0,0,0,wt.width,wt.height,wt.depth,He,Pt,wt.data)):i.texImage3D(n.TEXTURE_2D_ARRAY,0,qt,wt.width,wt.height,wt.depth,0,He,Pt,wt.data);else if(ne.isData3DTexture)be?(Qe&&i.texStorage3D(n.TEXTURE_3D,we,qt,wt.width,wt.height,wt.depth),i.texSubImage3D(n.TEXTURE_3D,0,0,0,0,wt.width,wt.height,wt.depth,He,Pt,wt.data)):i.texImage3D(n.TEXTURE_3D,0,qt,wt.width,wt.height,wt.depth,0,He,Pt,wt.data);else if(ne.isFramebufferTexture){if(Qe)if(be)i.texStorage2D(n.TEXTURE_2D,we,qt,wt.width,wt.height);else{let Te=wt.width,Ne=wt.height;for(let et=0;et<we;et++)i.texImage2D(n.TEXTURE_2D,et,qt,Te,Ne,0,He,Pt,null),Te>>=1,Ne>>=1}}else if(hn.length>0&&Xt){be&&Qe&&i.texStorage2D(n.TEXTURE_2D,we,qt,hn[0].width,hn[0].height);for(let Te=0,Ne=hn.length;Te<Ne;Te++)Nt=hn[Te],be?i.texSubImage2D(n.TEXTURE_2D,Te,0,0,He,Pt,Nt):i.texImage2D(n.TEXTURE_2D,Te,qt,He,Pt,Nt);ne.generateMipmaps=!1}else be?(Qe&&i.texStorage2D(n.TEXTURE_2D,we,qt,wt.width,wt.height),i.texSubImage2D(n.TEXTURE_2D,0,0,0,He,Pt,wt)):i.texImage2D(n.TEXTURE_2D,0,qt,He,Pt,wt);j(ne,Xt)&&Y(ut),Et.__version=lt.version,ne.onUpdate&&ne.onUpdate(ne)}de.__version=ne.version}function Kt(de,ne,Oe){if(ne.image.length!==6)return;const ut=Ct(de,ne),it=ne.source;i.bindTexture(n.TEXTURE_CUBE_MAP,de.__webglTexture,n.TEXTURE0+Oe);const lt=o.get(it);if(it.version!==lt.__version||ut===!0){i.activeTexture(n.TEXTURE0+Oe);const Et=Ba.getPrimaries(Ba.workingColorSpace),Ut=ne.colorSpace===$l?null:Ba.getPrimaries(ne.colorSpace),Wt=ne.colorSpace===$l||Et===Ut?n.NONE:n.BROWSER_DEFAULT_WEBGL;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,ne.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,ne.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,ne.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,Wt);const Ht=ne.isCompressedTexture||ne.image[0].isCompressedTexture,Dt=ne.image[0]&&ne.image[0].isDataTexture,wt=[];for(let Te=0;Te<6;Te++)!Ht&&!Dt?wt[Te]=N(ne.image[Te],!1,!0,y):wt[Te]=Dt?ne.image[Te].image:ne.image[Te],wt[Te]=st(ne,wt[Te]);const Xt=wt[0],He=F(Xt)||p,Pt=l.convert(ne.format,ne.colorSpace),qt=l.convert(ne.type),Nt=te(ne.internalFormat,Pt,qt,ne.colorSpace),hn=p&&ne.isVideoTexture!==!0,be=lt.__version===void 0||ut===!0;let Qe=V(ne,Xt,He);ct(n.TEXTURE_CUBE_MAP,ne,He);let we;if(Ht){hn&&be&&i.texStorage2D(n.TEXTURE_CUBE_MAP,Qe,Nt,Xt.width,Xt.height);for(let Te=0;Te<6;Te++){we=wt[Te].mipmaps;for(let Ne=0;Ne<we.length;Ne++){const et=we[Ne];ne.format!==ml?Pt!==null?hn?i.compressedTexSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Te,Ne,0,0,et.width,et.height,Pt,et.data):i.compressedTexImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Te,Ne,Nt,et.width,et.height,0,et.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):hn?i.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Te,Ne,0,0,et.width,et.height,Pt,qt,et.data):i.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Te,Ne,Nt,et.width,et.height,0,Pt,qt,et.data)}}}else{we=ne.mipmaps,hn&&be&&(we.length>0&&Qe++,i.texStorage2D(n.TEXTURE_CUBE_MAP,Qe,Nt,wt[0].width,wt[0].height));for(let Te=0;Te<6;Te++)if(Dt){hn?i.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Te,0,0,0,wt[Te].width,wt[Te].height,Pt,qt,wt[Te].data):i.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Te,0,Nt,wt[Te].width,wt[Te].height,0,Pt,qt,wt[Te].data);for(let Ne=0;Ne<we.length;Ne++){const tt=we[Ne].image[Te].image;hn?i.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Te,Ne+1,0,0,tt.width,tt.height,Pt,qt,tt.data):i.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Te,Ne+1,Nt,tt.width,tt.height,0,Pt,qt,tt.data)}}else{hn?i.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Te,0,0,0,Pt,qt,wt[Te]):i.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Te,0,Nt,Pt,qt,wt[Te]);for(let Ne=0;Ne<we.length;Ne++){const et=we[Ne];hn?i.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Te,Ne+1,0,0,Pt,qt,et.image[Te]):i.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Te,Ne+1,Nt,Pt,qt,et.image[Te])}}}j(ne,He)&&Y(n.TEXTURE_CUBE_MAP),lt.__version=it.version,ne.onUpdate&&ne.onUpdate(ne)}de.__version=ne.version}function At(de,ne,Oe,ut,it,lt){const Et=l.convert(Oe.format,Oe.colorSpace),Ut=l.convert(Oe.type),Wt=te(Oe.internalFormat,Et,Ut,Oe.colorSpace);if(!o.get(ne).__hasExternalTextures){const Dt=Math.max(1,ne.width>>lt),wt=Math.max(1,ne.height>>lt);it===n.TEXTURE_3D||it===n.TEXTURE_2D_ARRAY?i.texImage3D(it,lt,Wt,Dt,wt,ne.depth,0,Et,Ut,null):i.texImage2D(it,lt,Wt,Dt,wt,0,Et,Ut,null)}i.bindFramebuffer(n.FRAMEBUFFER,de),je(ne)?S.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,ut,it,o.get(Oe).__webglTexture,0,_e(ne)):(it===n.TEXTURE_2D||it>=n.TEXTURE_CUBE_MAP_POSITIVE_X&&it<=n.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&n.framebufferTexture2D(n.FRAMEBUFFER,ut,it,o.get(Oe).__webglTexture,lt),i.bindFramebuffer(n.FRAMEBUFFER,null)}function Pe(de,ne,Oe){if(n.bindRenderbuffer(n.RENDERBUFFER,de),ne.depthBuffer&&!ne.stencilBuffer){let ut=p===!0?n.DEPTH_COMPONENT24:n.DEPTH_COMPONENT16;if(Oe||je(ne)){const it=ne.depthTexture;it&&it.isDepthTexture&&(it.type===ud?ut=n.DEPTH_COMPONENT32F:it.type===Lh&&(ut=n.DEPTH_COMPONENT24));const lt=_e(ne);je(ne)?S.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,lt,ut,ne.width,ne.height):n.renderbufferStorageMultisample(n.RENDERBUFFER,lt,ut,ne.width,ne.height)}else n.renderbufferStorage(n.RENDERBUFFER,ut,ne.width,ne.height);n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.RENDERBUFFER,de)}else if(ne.depthBuffer&&ne.stencilBuffer){const ut=_e(ne);Oe&&je(ne)===!1?n.renderbufferStorageMultisample(n.RENDERBUFFER,ut,n.DEPTH24_STENCIL8,ne.width,ne.height):je(ne)?S.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,ut,n.DEPTH24_STENCIL8,ne.width,ne.height):n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,ne.width,ne.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,de)}else{const ut=ne.isWebGLMultipleRenderTargets===!0?ne.texture:[ne.texture];for(let it=0;it<ut.length;it++){const lt=ut[it],Et=l.convert(lt.format,lt.colorSpace),Ut=l.convert(lt.type),Wt=te(lt.internalFormat,Et,Ut,lt.colorSpace),Ht=_e(ne);Oe&&je(ne)===!1?n.renderbufferStorageMultisample(n.RENDERBUFFER,Ht,Wt,ne.width,ne.height):je(ne)?S.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,Ht,Wt,ne.width,ne.height):n.renderbufferStorage(n.RENDERBUFFER,Wt,ne.width,ne.height)}}n.bindRenderbuffer(n.RENDERBUFFER,null)}function ft(de,ne){if(ne&&ne.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(i.bindFramebuffer(n.FRAMEBUFFER,de),!(ne.depthTexture&&ne.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!o.get(ne.depthTexture).__webglTexture||ne.depthTexture.image.width!==ne.width||ne.depthTexture.image.height!==ne.height)&&(ne.depthTexture.image.width=ne.width,ne.depthTexture.image.height=ne.height,ne.depthTexture.needsUpdate=!0),xe(ne.depthTexture,0);const ut=o.get(ne.depthTexture).__webglTexture,it=_e(ne);if(ne.depthTexture.format===mf)je(ne)?S.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,ut,0,it):n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,ut,0);else if(ne.depthTexture.format===Bg)je(ne)?S.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.TEXTURE_2D,ut,0,it):n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.TEXTURE_2D,ut,0);else throw new Error("Unknown depthTexture format")}function gt(de){const ne=o.get(de),Oe=de.isWebGLCubeRenderTarget===!0;if(de.depthTexture&&!ne.__autoAllocateDepthBuffer){if(Oe)throw new Error("target.depthTexture not supported in Cube render targets");ft(ne.__webglFramebuffer,de)}else if(Oe){ne.__webglDepthbuffer=[];for(let ut=0;ut<6;ut++)i.bindFramebuffer(n.FRAMEBUFFER,ne.__webglFramebuffer[ut]),ne.__webglDepthbuffer[ut]=n.createRenderbuffer(),Pe(ne.__webglDepthbuffer[ut],de,!1)}else i.bindFramebuffer(n.FRAMEBUFFER,ne.__webglFramebuffer),ne.__webglDepthbuffer=n.createRenderbuffer(),Pe(ne.__webglDepthbuffer,de,!1);i.bindFramebuffer(n.FRAMEBUFFER,null)}function _t(de,ne,Oe){const ut=o.get(de);ne!==void 0&&At(ut.__webglFramebuffer,de,de.texture,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,0),Oe!==void 0&&gt(de)}function Be(de){const ne=de.texture,Oe=o.get(de),ut=o.get(ne);de.addEventListener("dispose",fe),de.isWebGLMultipleRenderTargets!==!0&&(ut.__webglTexture===void 0&&(ut.__webglTexture=n.createTexture()),ut.__version=ne.version,d.memory.textures++);const it=de.isWebGLCubeRenderTarget===!0,lt=de.isWebGLMultipleRenderTargets===!0,Et=F(de)||p;if(it){Oe.__webglFramebuffer=[];for(let Ut=0;Ut<6;Ut++)if(p&&ne.mipmaps&&ne.mipmaps.length>0){Oe.__webglFramebuffer[Ut]=[];for(let Wt=0;Wt<ne.mipmaps.length;Wt++)Oe.__webglFramebuffer[Ut][Wt]=n.createFramebuffer()}else Oe.__webglFramebuffer[Ut]=n.createFramebuffer()}else{if(p&&ne.mipmaps&&ne.mipmaps.length>0){Oe.__webglFramebuffer=[];for(let Ut=0;Ut<ne.mipmaps.length;Ut++)Oe.__webglFramebuffer[Ut]=n.createFramebuffer()}else Oe.__webglFramebuffer=n.createFramebuffer();if(lt)if(s.drawBuffers){const Ut=de.texture;for(let Wt=0,Ht=Ut.length;Wt<Ht;Wt++){const Dt=o.get(Ut[Wt]);Dt.__webglTexture===void 0&&(Dt.__webglTexture=n.createTexture(),d.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(p&&de.samples>0&&je(de)===!1){const Ut=lt?ne:[ne];Oe.__webglMultisampledFramebuffer=n.createFramebuffer(),Oe.__webglColorRenderbuffer=[],i.bindFramebuffer(n.FRAMEBUFFER,Oe.__webglMultisampledFramebuffer);for(let Wt=0;Wt<Ut.length;Wt++){const Ht=Ut[Wt];Oe.__webglColorRenderbuffer[Wt]=n.createRenderbuffer(),n.bindRenderbuffer(n.RENDERBUFFER,Oe.__webglColorRenderbuffer[Wt]);const Dt=l.convert(Ht.format,Ht.colorSpace),wt=l.convert(Ht.type),Xt=te(Ht.internalFormat,Dt,wt,Ht.colorSpace,de.isXRRenderTarget===!0),He=_e(de);n.renderbufferStorageMultisample(n.RENDERBUFFER,He,Xt,de.width,de.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+Wt,n.RENDERBUFFER,Oe.__webglColorRenderbuffer[Wt])}n.bindRenderbuffer(n.RENDERBUFFER,null),de.depthBuffer&&(Oe.__webglDepthRenderbuffer=n.createRenderbuffer(),Pe(Oe.__webglDepthRenderbuffer,de,!0)),i.bindFramebuffer(n.FRAMEBUFFER,null)}}if(it){i.bindTexture(n.TEXTURE_CUBE_MAP,ut.__webglTexture),ct(n.TEXTURE_CUBE_MAP,ne,Et);for(let Ut=0;Ut<6;Ut++)if(p&&ne.mipmaps&&ne.mipmaps.length>0)for(let Wt=0;Wt<ne.mipmaps.length;Wt++)At(Oe.__webglFramebuffer[Ut][Wt],de,ne,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+Ut,Wt);else At(Oe.__webglFramebuffer[Ut],de,ne,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+Ut,0);j(ne,Et)&&Y(n.TEXTURE_CUBE_MAP),i.unbindTexture()}else if(lt){const Ut=de.texture;for(let Wt=0,Ht=Ut.length;Wt<Ht;Wt++){const Dt=Ut[Wt],wt=o.get(Dt);i.bindTexture(n.TEXTURE_2D,wt.__webglTexture),ct(n.TEXTURE_2D,Dt,Et),At(Oe.__webglFramebuffer,de,Dt,n.COLOR_ATTACHMENT0+Wt,n.TEXTURE_2D,0),j(Dt,Et)&&Y(n.TEXTURE_2D)}i.unbindTexture()}else{let Ut=n.TEXTURE_2D;if((de.isWebGL3DRenderTarget||de.isWebGLArrayRenderTarget)&&(p?Ut=de.isWebGL3DRenderTarget?n.TEXTURE_3D:n.TEXTURE_2D_ARRAY:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),i.bindTexture(Ut,ut.__webglTexture),ct(Ut,ne,Et),p&&ne.mipmaps&&ne.mipmaps.length>0)for(let Wt=0;Wt<ne.mipmaps.length;Wt++)At(Oe.__webglFramebuffer[Wt],de,ne,n.COLOR_ATTACHMENT0,Ut,Wt);else At(Oe.__webglFramebuffer,de,ne,n.COLOR_ATTACHMENT0,Ut,0);j(ne,Et)&&Y(Ut),i.unbindTexture()}de.depthBuffer&&gt(de)}function ue(de){const ne=F(de)||p,Oe=de.isWebGLMultipleRenderTargets===!0?de.texture:[de.texture];for(let ut=0,it=Oe.length;ut<it;ut++){const lt=Oe[ut];if(j(lt,ne)){const Et=de.isWebGLCubeRenderTarget?n.TEXTURE_CUBE_MAP:n.TEXTURE_2D,Ut=o.get(lt).__webglTexture;i.bindTexture(Et,Ut),Y(Et),i.unbindTexture()}}}function se(de){if(p&&de.samples>0&&je(de)===!1){const ne=de.isWebGLMultipleRenderTargets?de.texture:[de.texture],Oe=de.width,ut=de.height;let it=n.COLOR_BUFFER_BIT;const lt=[],Et=de.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT,Ut=o.get(de),Wt=de.isWebGLMultipleRenderTargets===!0;if(Wt)for(let Ht=0;Ht<ne.length;Ht++)i.bindFramebuffer(n.FRAMEBUFFER,Ut.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+Ht,n.RENDERBUFFER,null),i.bindFramebuffer(n.FRAMEBUFFER,Ut.__webglFramebuffer),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0+Ht,n.TEXTURE_2D,null,0);i.bindFramebuffer(n.READ_FRAMEBUFFER,Ut.__webglMultisampledFramebuffer),i.bindFramebuffer(n.DRAW_FRAMEBUFFER,Ut.__webglFramebuffer);for(let Ht=0;Ht<ne.length;Ht++){lt.push(n.COLOR_ATTACHMENT0+Ht),de.depthBuffer&&lt.push(Et);const Dt=Ut.__ignoreDepthValues!==void 0?Ut.__ignoreDepthValues:!1;if(Dt===!1&&(de.depthBuffer&&(it|=n.DEPTH_BUFFER_BIT),de.stencilBuffer&&(it|=n.STENCIL_BUFFER_BIT)),Wt&&n.framebufferRenderbuffer(n.READ_FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.RENDERBUFFER,Ut.__webglColorRenderbuffer[Ht]),Dt===!0&&(n.invalidateFramebuffer(n.READ_FRAMEBUFFER,[Et]),n.invalidateFramebuffer(n.DRAW_FRAMEBUFFER,[Et])),Wt){const wt=o.get(ne[Ht]).__webglTexture;n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,wt,0)}n.blitFramebuffer(0,0,Oe,ut,0,0,Oe,ut,it,n.NEAREST),T&&n.invalidateFramebuffer(n.READ_FRAMEBUFFER,lt)}if(i.bindFramebuffer(n.READ_FRAMEBUFFER,null),i.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),Wt)for(let Ht=0;Ht<ne.length;Ht++){i.bindFramebuffer(n.FRAMEBUFFER,Ut.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+Ht,n.RENDERBUFFER,Ut.__webglColorRenderbuffer[Ht]);const Dt=o.get(ne[Ht]).__webglTexture;i.bindFramebuffer(n.FRAMEBUFFER,Ut.__webglFramebuffer),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0+Ht,n.TEXTURE_2D,Dt,0)}i.bindFramebuffer(n.DRAW_FRAMEBUFFER,Ut.__webglMultisampledFramebuffer)}}function _e(de){return Math.min(x,de.samples)}function je(de){const ne=o.get(de);return p&&de.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&ne.__useRenderToTexture!==!1}function De(de){const ne=d.render.frame;I.get(de)!==ne&&(I.set(de,ne),de.update())}function st(de,ne){const Oe=de.colorSpace,ut=de.format,it=de.type;return de.isCompressedTexture===!0||de.isVideoTexture===!0||de.format===lM||Oe!==Sd&&Oe!==$l&&(Ba.getTransfer(Oe)===tr?p===!1?e.has("EXT_sRGB")===!0&&ut===ml?(de.format=lM,de.minFilter=Lr,de.generateMipmaps=!1):ne=d6.sRGBToLinear(ne):(ut!==ml||it!==yd)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",Oe)),ne}this.allocateTextureUnit=le,this.resetTextureUnits=ze,this.setTexture2D=xe,this.setTexture2DArray=ae,this.setTexture3D=Ee,this.setTextureCube=Je,this.rebindTextures=_t,this.setupRenderTarget=Be,this.updateRenderTargetMipmap=ue,this.updateMultisampleRenderTarget=se,this.setupDepthRenderbuffer=gt,this.setupFrameBufferTexture=At,this.useMultisampledRTT=je}function lZ(n,e,i){const o=i.isWebGL2;function s(l,d=$l){let p;const f=Ba.getTransfer(d);if(l===yd)return n.UNSIGNED_BYTE;if(l===n6)return n.UNSIGNED_SHORT_4_4_4_4;if(l===i6)return n.UNSIGNED_SHORT_5_5_5_1;if(l===TX)return n.BYTE;if(l===CX)return n.SHORT;if(l===FT)return n.UNSIGNED_SHORT;if(l===t6)return n.INT;if(l===Lh)return n.UNSIGNED_INT;if(l===ud)return n.FLOAT;if(l===u_)return o?n.HALF_FLOAT:(p=e.get("OES_texture_half_float"),p!==null?p.HALF_FLOAT_OES:null);if(l===PX)return n.ALPHA;if(l===ml)return n.RGBA;if(l===IX)return n.LUMINANCE;if(l===LX)return n.LUMINANCE_ALPHA;if(l===mf)return n.DEPTH_COMPONENT;if(l===Bg)return n.DEPTH_STENCIL;if(l===lM)return p=e.get("EXT_sRGB"),p!==null?p.SRGB_ALPHA_EXT:null;if(l===RX)return n.RED;if(l===a6)return n.RED_INTEGER;if(l===kX)return n.RG;if(l===r6)return n.RG_INTEGER;if(l===o6)return n.RGBA_INTEGER;if(l===oE||l===sE||l===lE||l===cE)if(f===tr)if(p=e.get("WEBGL_compressed_texture_s3tc_srgb"),p!==null){if(l===oE)return p.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(l===sE)return p.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(l===lE)return p.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(l===cE)return p.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(p=e.get("WEBGL_compressed_texture_s3tc"),p!==null){if(l===oE)return p.COMPRESSED_RGB_S3TC_DXT1_EXT;if(l===sE)return p.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(l===lE)return p.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(l===cE)return p.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(l===iR||l===aR||l===rR||l===oR)if(p=e.get("WEBGL_compressed_texture_pvrtc"),p!==null){if(l===iR)return p.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(l===aR)return p.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(l===rR)return p.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(l===oR)return p.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(l===DX)return p=e.get("WEBGL_compressed_texture_etc1"),p!==null?p.COMPRESSED_RGB_ETC1_WEBGL:null;if(l===sR||l===lR)if(p=e.get("WEBGL_compressed_texture_etc"),p!==null){if(l===sR)return f===tr?p.COMPRESSED_SRGB8_ETC2:p.COMPRESSED_RGB8_ETC2;if(l===lR)return f===tr?p.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:p.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(l===cR||l===uR||l===dR||l===hR||l===pR||l===fR||l===mR||l===gR||l===yR||l===vR||l===_R||l===bR||l===xR||l===wR)if(p=e.get("WEBGL_compressed_texture_astc"),p!==null){if(l===cR)return f===tr?p.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:p.COMPRESSED_RGBA_ASTC_4x4_KHR;if(l===uR)return f===tr?p.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:p.COMPRESSED_RGBA_ASTC_5x4_KHR;if(l===dR)return f===tr?p.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:p.COMPRESSED_RGBA_ASTC_5x5_KHR;if(l===hR)return f===tr?p.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:p.COMPRESSED_RGBA_ASTC_6x5_KHR;if(l===pR)return f===tr?p.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:p.COMPRESSED_RGBA_ASTC_6x6_KHR;if(l===fR)return f===tr?p.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:p.COMPRESSED_RGBA_ASTC_8x5_KHR;if(l===mR)return f===tr?p.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:p.COMPRESSED_RGBA_ASTC_8x6_KHR;if(l===gR)return f===tr?p.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:p.COMPRESSED_RGBA_ASTC_8x8_KHR;if(l===yR)return f===tr?p.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:p.COMPRESSED_RGBA_ASTC_10x5_KHR;if(l===vR)return f===tr?p.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:p.COMPRESSED_RGBA_ASTC_10x6_KHR;if(l===_R)return f===tr?p.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:p.COMPRESSED_RGBA_ASTC_10x8_KHR;if(l===bR)return f===tr?p.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:p.COMPRESSED_RGBA_ASTC_10x10_KHR;if(l===xR)return f===tr?p.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:p.COMPRESSED_RGBA_ASTC_12x10_KHR;if(l===wR)return f===tr?p.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:p.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(l===uE||l===SR||l===AR)if(p=e.get("EXT_texture_compression_bptc"),p!==null){if(l===uE)return f===tr?p.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:p.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(l===SR)return p.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(l===AR)return p.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(l===OX||l===ER||l===MR||l===TR)if(p=e.get("EXT_texture_compression_rgtc"),p!==null){if(l===uE)return p.COMPRESSED_RED_RGTC1_EXT;if(l===ER)return p.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(l===MR)return p.COMPRESSED_RED_GREEN_RGTC2_EXT;if(l===TR)return p.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return l===ff?o?n.UNSIGNED_INT_24_8:(p=e.get("WEBGL_depth_texture"),p!==null?p.UNSIGNED_INT_24_8_WEBGL:null):n[l]!==void 0?n[l]:null}return{convert:s}}class cZ extends qr{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}}class I0 extends va{constructor(){super(),this.isGroup=!0,this.type="Group"}}const Z3e={type:"move"};class $4{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new I0,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new I0,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new Ue,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new Ue),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new I0,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new Ue,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new Ue),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const i=this._hand;if(i)for(const o of e.hand.values())this._getHandJoint(i,o)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,i,o){let s=null,l=null,d=null;const p=this._targetRay,f=this._grip,y=this._hand;if(e&&i.session.visibilityState!=="visible-blurred"){if(y&&e.hand){d=!0;for(const R of e.hand.values()){const D=i.getJointPose(R,o),L=this._getHandJoint(y,R);D!==null&&(L.matrix.fromArray(D.transform.matrix),L.matrix.decompose(L.position,L.rotation,L.scale),L.matrixWorldNeedsUpdate=!0,L.jointRadius=D.radius),L.visible=D!==null}const _=y.joints["index-finger-tip"],x=y.joints["thumb-tip"],S=_.position.distanceTo(x.position),T=.02,I=.005;y.inputState.pinching&&S>T+I?(y.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!y.inputState.pinching&&S<=T-I&&(y.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else f!==null&&e.gripSpace&&(l=i.getPose(e.gripSpace,o),l!==null&&(f.matrix.fromArray(l.transform.matrix),f.matrix.decompose(f.position,f.rotation,f.scale),f.matrixWorldNeedsUpdate=!0,l.linearVelocity?(f.hasLinearVelocity=!0,f.linearVelocity.copy(l.linearVelocity)):f.hasLinearVelocity=!1,l.angularVelocity?(f.hasAngularVelocity=!0,f.angularVelocity.copy(l.angularVelocity)):f.hasAngularVelocity=!1));p!==null&&(s=i.getPose(e.targetRaySpace,o),s===null&&l!==null&&(s=l),s!==null&&(p.matrix.fromArray(s.transform.matrix),p.matrix.decompose(p.position,p.rotation,p.scale),p.matrixWorldNeedsUpdate=!0,s.linearVelocity?(p.hasLinearVelocity=!0,p.linearVelocity.copy(s.linearVelocity)):p.hasLinearVelocity=!1,s.angularVelocity?(p.hasAngularVelocity=!0,p.angularVelocity.copy(s.angularVelocity)):p.hasAngularVelocity=!1,this.dispatchEvent(Z3e)))}return p!==null&&(p.visible=s!==null),f!==null&&(f.visible=l!==null),y!==null&&(y.visible=d!==null),this}_getHandJoint(e,i){if(e.joints[i.jointName]===void 0){const o=new I0;o.matrixAutoUpdate=!1,o.visible=!1,e.joints[i.jointName]=o,e.add(o)}return e.joints[i.jointName]}}class uZ extends Or{constructor(e,i,o,s,l,d,p,f,y,_){if(_=_!==void 0?_:mf,_!==mf&&_!==Bg)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");o===void 0&&_===mf&&(o=Lh),o===void 0&&_===Bg&&(o=ff),super(null,s,l,d,p,f,_,o,y),this.isDepthTexture=!0,this.image={width:e,height:i},this.magFilter=p!==void 0?p:so,this.minFilter=f!==void 0?f:so,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.compareFunction=e.compareFunction,this}toJSON(e){const i=super.toJSON(e);return this.compareFunction!==null&&(i.compareFunction=this.compareFunction),i}}class K3e extends Td{constructor(e,i){super();const o=this;let s=null,l=1,d=null,p="local-floor",f=1,y=null,_=null,x=null,S=null,T=null,I=null;const R=i.getContextAttributes();let D=null,L=null;const O=[],N=[],F=new qr;F.layers.enable(1),F.viewport=new Pa;const G=new qr;G.layers.enable(2),G.viewport=new Pa;const j=[F,G],Y=new cZ;Y.layers.enable(1),Y.layers.enable(2);let te=null,V=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(ae){let Ee=O[ae];return Ee===void 0&&(Ee=new $4,O[ae]=Ee),Ee.getTargetRaySpace()},this.getControllerGrip=function(ae){let Ee=O[ae];return Ee===void 0&&(Ee=new $4,O[ae]=Ee),Ee.getGripSpace()},this.getHand=function(ae){let Ee=O[ae];return Ee===void 0&&(Ee=new $4,O[ae]=Ee),Ee.getHandSpace()};function Q(ae){const Ee=N.indexOf(ae.inputSource);if(Ee===-1)return;const Je=O[Ee];Je!==void 0&&(Je.update(ae.inputSource,ae.frame,y||d),Je.dispatchEvent({type:ae.type,data:ae.inputSource}))}function he(){s.removeEventListener("select",Q),s.removeEventListener("selectstart",Q),s.removeEventListener("selectend",Q),s.removeEventListener("squeeze",Q),s.removeEventListener("squeezestart",Q),s.removeEventListener("squeezeend",Q),s.removeEventListener("end",he),s.removeEventListener("inputsourceschange",fe);for(let ae=0;ae<O.length;ae++){const Ee=N[ae];Ee!==null&&(N[ae]=null,O[ae].disconnect(Ee))}te=null,V=null,e.setRenderTarget(D),T=null,S=null,x=null,s=null,L=null,xe.stop(),o.isPresenting=!1,o.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(ae){l=ae,o.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(ae){p=ae,o.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return y||d},this.setReferenceSpace=function(ae){y=ae},this.getBaseLayer=function(){return S!==null?S:T},this.getBinding=function(){return x},this.getFrame=function(){return I},this.getSession=function(){return s},this.setSession=async function(ae){if(s=ae,s!==null){if(D=e.getRenderTarget(),s.addEventListener("select",Q),s.addEventListener("selectstart",Q),s.addEventListener("selectend",Q),s.addEventListener("squeeze",Q),s.addEventListener("squeezestart",Q),s.addEventListener("squeezeend",Q),s.addEventListener("end",he),s.addEventListener("inputsourceschange",fe),R.xrCompatible!==!0&&await i.makeXRCompatible(),s.renderState.layers===void 0||e.capabilities.isWebGL2===!1){const Ee={antialias:s.renderState.layers===void 0?R.antialias:!0,alpha:!0,depth:R.depth,stencil:R.stencil,framebufferScaleFactor:l};T=new XRWebGLLayer(s,i,Ee),s.updateRenderState({baseLayer:T}),L=new yu(T.framebufferWidth,T.framebufferHeight,{format:ml,type:yd,colorSpace:e.outputColorSpace,stencilBuffer:R.stencil})}else{let Ee=null,Je=null,Ze=null;R.depth&&(Ze=R.stencil?i.DEPTH24_STENCIL8:i.DEPTH_COMPONENT24,Ee=R.stencil?Bg:mf,Je=R.stencil?ff:Lh);const Ke={colorFormat:i.RGBA8,depthFormat:Ze,scaleFactor:l};x=new XRWebGLBinding(s,i),S=x.createProjectionLayer(Ke),s.updateRenderState({layers:[S]}),L=new yu(S.textureWidth,S.textureHeight,{format:ml,type:yd,depthTexture:new uZ(S.textureWidth,S.textureHeight,Je,void 0,void 0,void 0,void 0,void 0,void 0,Ee),stencilBuffer:R.stencil,colorSpace:e.outputColorSpace,samples:R.antialias?4:0});const Fe=e.properties.get(L);Fe.__ignoreDepthValues=S.ignoreDepthValues}L.isXRRenderTarget=!0,this.setFoveation(f),y=null,d=await s.requestReferenceSpace(p),xe.setContext(s),xe.start(),o.isPresenting=!0,o.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(s!==null)return s.environmentBlendMode};function fe(ae){for(let Ee=0;Ee<ae.removed.length;Ee++){const Je=ae.removed[Ee],Ze=N.indexOf(Je);Ze>=0&&(N[Ze]=null,O[Ze].disconnect(Je))}for(let Ee=0;Ee<ae.added.length;Ee++){const Je=ae.added[Ee];let Ze=N.indexOf(Je);if(Ze===-1){for(let Fe=0;Fe<O.length;Fe++)if(Fe>=N.length){N.push(Je),Ze=Fe;break}else if(N[Fe]===null){N[Fe]=Je,Ze=Fe;break}if(Ze===-1)break}const Ke=O[Ze];Ke&&Ke.connect(Je)}}const ye=new Ue,pe=new Ue;function Me(ae,Ee,Je){ye.setFromMatrixPosition(Ee.matrixWorld),pe.setFromMatrixPosition(Je.matrixWorld);const Ze=ye.distanceTo(pe),Ke=Ee.projectionMatrix.elements,Fe=Je.projectionMatrix.elements,ct=Ke[14]/(Ke[10]-1),Ct=Ke[14]/(Ke[10]+1),kt=(Ke[9]+1)/Ke[5],Kt=(Ke[9]-1)/Ke[5],At=(Ke[8]-1)/Ke[0],Pe=(Fe[8]+1)/Fe[0],ft=ct*At,gt=ct*Pe,_t=Ze/(-At+Pe),Be=_t*-At;Ee.matrixWorld.decompose(ae.position,ae.quaternion,ae.scale),ae.translateX(Be),ae.translateZ(_t),ae.matrixWorld.compose(ae.position,ae.quaternion,ae.scale),ae.matrixWorldInverse.copy(ae.matrixWorld).invert();const ue=ct+_t,se=Ct+_t,_e=ft-Be,je=gt+(Ze-Be),De=kt*Ct/se*ue,st=Kt*Ct/se*ue;ae.projectionMatrix.makePerspective(_e,je,De,st,ue,se),ae.projectionMatrixInverse.copy(ae.projectionMatrix).invert()}function Ie(ae,Ee){Ee===null?ae.matrixWorld.copy(ae.matrix):ae.matrixWorld.multiplyMatrices(Ee.matrixWorld,ae.matrix),ae.matrixWorldInverse.copy(ae.matrixWorld).invert()}this.updateCamera=function(ae){if(s===null)return;Y.near=G.near=F.near=ae.near,Y.far=G.far=F.far=ae.far,(te!==Y.near||V!==Y.far)&&(s.updateRenderState({depthNear:Y.near,depthFar:Y.far}),te=Y.near,V=Y.far);const Ee=ae.parent,Je=Y.cameras;Ie(Y,Ee);for(let Ze=0;Ze<Je.length;Ze++)Ie(Je[Ze],Ee);Je.length===2?Me(Y,F,G):Y.projectionMatrix.copy(F.projectionMatrix),ze(ae,Y,Ee)};function ze(ae,Ee,Je){Je===null?ae.matrix.copy(Ee.matrixWorld):(ae.matrix.copy(Je.matrixWorld),ae.matrix.invert(),ae.matrix.multiply(Ee.matrixWorld)),ae.matrix.decompose(ae.position,ae.quaternion,ae.scale),ae.updateMatrixWorld(!0),ae.projectionMatrix.copy(Ee.projectionMatrix),ae.projectionMatrixInverse.copy(Ee.projectionMatrixInverse),ae.isPerspectiveCamera&&(ae.fov=d_*2*Math.atan(1/ae.projectionMatrix.elements[5]),ae.zoom=1)}this.getCamera=function(){return Y},this.getFoveation=function(){if(!(S===null&&T===null))return f},this.setFoveation=function(ae){f=ae,S!==null&&(S.fixedFoveation=ae),T!==null&&T.fixedFoveation!==void 0&&(T.fixedFoveation=ae)};let le=null;function me(ae,Ee){if(_=Ee.getViewerPose(y||d),I=Ee,_!==null){const Je=_.views;T!==null&&(e.setRenderTargetFramebuffer(L,T.framebuffer),e.setRenderTarget(L));let Ze=!1;Je.length!==Y.cameras.length&&(Y.cameras.length=0,Ze=!0);for(let Ke=0;Ke<Je.length;Ke++){const Fe=Je[Ke];let ct=null;if(T!==null)ct=T.getViewport(Fe);else{const kt=x.getViewSubImage(S,Fe);ct=kt.viewport,Ke===0&&(e.setRenderTargetTextures(L,kt.colorTexture,S.ignoreDepthValues?void 0:kt.depthStencilTexture),e.setRenderTarget(L))}let Ct=j[Ke];Ct===void 0&&(Ct=new qr,Ct.layers.enable(Ke),Ct.viewport=new Pa,j[Ke]=Ct),Ct.matrix.fromArray(Fe.transform.matrix),Ct.matrix.decompose(Ct.position,Ct.quaternion,Ct.scale),Ct.projectionMatrix.fromArray(Fe.projectionMatrix),Ct.projectionMatrixInverse.copy(Ct.projectionMatrix).invert(),Ct.viewport.set(ct.x,ct.y,ct.width,ct.height),Ke===0&&(Y.matrix.copy(Ct.matrix),Y.matrix.decompose(Y.position,Y.quaternion,Y.scale)),Ze===!0&&Y.cameras.push(Ct)}}for(let Je=0;Je<O.length;Je++){const Ze=N[Je],Ke=O[Je];Ze!==null&&Ke!==void 0&&Ke.update(Ze,Ee,y||d)}le&&le(ae,Ee),Ee.detectedPlanes&&o.dispatchEvent({type:"planesdetected",data:Ee}),I=null}const xe=new iZ;xe.setAnimationLoop(me),this.setAnimationLoop=function(ae){le=ae},this.dispose=function(){}}}function J3e(n,e){function i(D,L){D.matrixAutoUpdate===!0&&D.updateMatrix(),L.value.copy(D.matrix)}function o(D,L){L.color.getRGB(D.fogColor.value,eZ(n)),L.isFog?(D.fogNear.value=L.near,D.fogFar.value=L.far):L.isFogExp2&&(D.fogDensity.value=L.density)}function s(D,L,O,N,F){L.isMeshBasicMaterial||L.isMeshLambertMaterial?l(D,L):L.isMeshToonMaterial?(l(D,L),x(D,L)):L.isMeshPhongMaterial?(l(D,L),_(D,L)):L.isMeshStandardMaterial?(l(D,L),S(D,L),L.isMeshPhysicalMaterial&&T(D,L,F)):L.isMeshMatcapMaterial?(l(D,L),I(D,L)):L.isMeshDepthMaterial?l(D,L):L.isMeshDistanceMaterial?(l(D,L),R(D,L)):L.isMeshNormalMaterial?l(D,L):L.isLineBasicMaterial?(d(D,L),L.isLineDashedMaterial&&p(D,L)):L.isPointsMaterial?f(D,L,O,N):L.isSpriteMaterial?y(D,L):L.isShadowMaterial?(D.color.value.copy(L.color),D.opacity.value=L.opacity):L.isShaderMaterial&&(L.uniformsNeedUpdate=!1)}function l(D,L){D.opacity.value=L.opacity,L.color&&D.diffuse.value.copy(L.color),L.emissive&&D.emissive.value.copy(L.emissive).multiplyScalar(L.emissiveIntensity),L.map&&(D.map.value=L.map,i(L.map,D.mapTransform)),L.alphaMap&&(D.alphaMap.value=L.alphaMap,i(L.alphaMap,D.alphaMapTransform)),L.bumpMap&&(D.bumpMap.value=L.bumpMap,i(L.bumpMap,D.bumpMapTransform),D.bumpScale.value=L.bumpScale,L.side===Ss&&(D.bumpScale.value*=-1)),L.normalMap&&(D.normalMap.value=L.normalMap,i(L.normalMap,D.normalMapTransform),D.normalScale.value.copy(L.normalScale),L.side===Ss&&D.normalScale.value.negate()),L.displacementMap&&(D.displacementMap.value=L.displacementMap,i(L.displacementMap,D.displacementMapTransform),D.displacementScale.value=L.displacementScale,D.displacementBias.value=L.displacementBias),L.emissiveMap&&(D.emissiveMap.value=L.emissiveMap,i(L.emissiveMap,D.emissiveMapTransform)),L.specularMap&&(D.specularMap.value=L.specularMap,i(L.specularMap,D.specularMapTransform)),L.alphaTest>0&&(D.alphaTest.value=L.alphaTest);const O=e.get(L).envMap;if(O&&(D.envMap.value=O,D.flipEnvMap.value=O.isCubeTexture&&O.isRenderTargetTexture===!1?-1:1,D.reflectivity.value=L.reflectivity,D.ior.value=L.ior,D.refractionRatio.value=L.refractionRatio),L.lightMap){D.lightMap.value=L.lightMap;const N=n._useLegacyLights===!0?Math.PI:1;D.lightMapIntensity.value=L.lightMapIntensity*N,i(L.lightMap,D.lightMapTransform)}L.aoMap&&(D.aoMap.value=L.aoMap,D.aoMapIntensity.value=L.aoMapIntensity,i(L.aoMap,D.aoMapTransform))}function d(D,L){D.diffuse.value.copy(L.color),D.opacity.value=L.opacity,L.map&&(D.map.value=L.map,i(L.map,D.mapTransform))}function p(D,L){D.dashSize.value=L.dashSize,D.totalSize.value=L.dashSize+L.gapSize,D.scale.value=L.scale}function f(D,L,O,N){D.diffuse.value.copy(L.color),D.opacity.value=L.opacity,D.size.value=L.size*O,D.scale.value=N*.5,L.map&&(D.map.value=L.map,i(L.map,D.uvTransform)),L.alphaMap&&(D.alphaMap.value=L.alphaMap,i(L.alphaMap,D.alphaMapTransform)),L.alphaTest>0&&(D.alphaTest.value=L.alphaTest)}function y(D,L){D.diffuse.value.copy(L.color),D.opacity.value=L.opacity,D.rotation.value=L.rotation,L.map&&(D.map.value=L.map,i(L.map,D.mapTransform)),L.alphaMap&&(D.alphaMap.value=L.alphaMap,i(L.alphaMap,D.alphaMapTransform)),L.alphaTest>0&&(D.alphaTest.value=L.alphaTest)}function _(D,L){D.specular.value.copy(L.specular),D.shininess.value=Math.max(L.shininess,1e-4)}function x(D,L){L.gradientMap&&(D.gradientMap.value=L.gradientMap)}function S(D,L){D.metalness.value=L.metalness,L.metalnessMap&&(D.metalnessMap.value=L.metalnessMap,i(L.metalnessMap,D.metalnessMapTransform)),D.roughness.value=L.roughness,L.roughnessMap&&(D.roughnessMap.value=L.roughnessMap,i(L.roughnessMap,D.roughnessMapTransform)),e.get(L).envMap&&(D.envMapIntensity.value=L.envMapIntensity)}function T(D,L,O){D.ior.value=L.ior,L.sheen>0&&(D.sheenColor.value.copy(L.sheenColor).multiplyScalar(L.sheen),D.sheenRoughness.value=L.sheenRoughness,L.sheenColorMap&&(D.sheenColorMap.value=L.sheenColorMap,i(L.sheenColorMap,D.sheenColorMapTransform)),L.sheenRoughnessMap&&(D.sheenRoughnessMap.value=L.sheenRoughnessMap,i(L.sheenRoughnessMap,D.sheenRoughnessMapTransform))),L.clearcoat>0&&(D.clearcoat.value=L.clearcoat,D.clearcoatRoughness.value=L.clearcoatRoughness,L.clearcoatMap&&(D.clearcoatMap.value=L.clearcoatMap,i(L.clearcoatMap,D.clearcoatMapTransform)),L.clearcoatRoughnessMap&&(D.clearcoatRoughnessMap.value=L.clearcoatRoughnessMap,i(L.clearcoatRoughnessMap,D.clearcoatRoughnessMapTransform)),L.clearcoatNormalMap&&(D.clearcoatNormalMap.value=L.clearcoatNormalMap,i(L.clearcoatNormalMap,D.clearcoatNormalMapTransform),D.clearcoatNormalScale.value.copy(L.clearcoatNormalScale),L.side===Ss&&D.clearcoatNormalScale.value.negate())),L.iridescence>0&&(D.iridescence.value=L.iridescence,D.iridescenceIOR.value=L.iridescenceIOR,D.iridescenceThicknessMinimum.value=L.iridescenceThicknessRange[0],D.iridescenceThicknessMaximum.value=L.iridescenceThicknessRange[1],L.iridescenceMap&&(D.iridescenceMap.value=L.iridescenceMap,i(L.iridescenceMap,D.iridescenceMapTransform)),L.iridescenceThicknessMap&&(D.iridescenceThicknessMap.value=L.iridescenceThicknessMap,i(L.iridescenceThicknessMap,D.iridescenceThicknessMapTransform))),L.transmission>0&&(D.transmission.value=L.transmission,D.transmissionSamplerMap.value=O.texture,D.transmissionSamplerSize.value.set(O.width,O.height),L.transmissionMap&&(D.transmissionMap.value=L.transmissionMap,i(L.transmissionMap,D.transmissionMapTransform)),D.thickness.value=L.thickness,L.thicknessMap&&(D.thicknessMap.value=L.thicknessMap,i(L.thicknessMap,D.thicknessMapTransform)),D.attenuationDistance.value=L.attenuationDistance,D.attenuationColor.value.copy(L.attenuationColor)),L.anisotropy>0&&(D.anisotropyVector.value.set(L.anisotropy*Math.cos(L.anisotropyRotation),L.anisotropy*Math.sin(L.anisotropyRotation)),L.anisotropyMap&&(D.anisotropyMap.value=L.anisotropyMap,i(L.anisotropyMap,D.anisotropyMapTransform))),D.specularIntensity.value=L.specularIntensity,D.specularColor.value.copy(L.specularColor),L.specularColorMap&&(D.specularColorMap.value=L.specularColorMap,i(L.specularColorMap,D.specularColorMapTransform)),L.specularIntensityMap&&(D.specularIntensityMap.value=L.specularIntensityMap,i(L.specularIntensityMap,D.specularIntensityMapTransform))}function I(D,L){L.matcap&&(D.matcap.value=L.matcap)}function R(D,L){const O=e.get(L).light;D.referencePosition.value.setFromMatrixPosition(O.matrixWorld),D.nearDistance.value=O.shadow.camera.near,D.farDistance.value=O.shadow.camera.far}return{refreshFogUniforms:o,refreshMaterialUniforms:s}}function Q3e(n,e,i,o){let s={},l={},d=[];const p=i.isWebGL2?n.getParameter(n.MAX_UNIFORM_BUFFER_BINDINGS):0;function f(O,N){const F=N.program;o.uniformBlockBinding(O,F)}function y(O,N){let F=s[O.id];F===void 0&&(I(O),F=_(O),s[O.id]=F,O.addEventListener("dispose",D));const G=N.program;o.updateUBOMapping(O,G);const j=e.render.frame;l[O.id]!==j&&(S(O),l[O.id]=j)}function _(O){const N=x();O.__bindingPointIndex=N;const F=n.createBuffer(),G=O.__size,j=O.usage;return n.bindBuffer(n.UNIFORM_BUFFER,F),n.bufferData(n.UNIFORM_BUFFER,G,j),n.bindBuffer(n.UNIFORM_BUFFER,null),n.bindBufferBase(n.UNIFORM_BUFFER,N,F),F}function x(){for(let O=0;O<p;O++)if(d.indexOf(O)===-1)return d.push(O),O;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function S(O){const N=s[O.id],F=O.uniforms,G=O.__cache;n.bindBuffer(n.UNIFORM_BUFFER,N);for(let j=0,Y=F.length;j<Y;j++){const te=F[j];if(T(te,j,G)===!0){const V=te.__offset,Q=Array.isArray(te.value)?te.value:[te.value];let he=0;for(let fe=0;fe<Q.length;fe++){const ye=Q[fe],pe=R(ye);typeof ye=="number"?(te.__data[0]=ye,n.bufferSubData(n.UNIFORM_BUFFER,V+he,te.__data)):ye.isMatrix3?(te.__data[0]=ye.elements[0],te.__data[1]=ye.elements[1],te.__data[2]=ye.elements[2],te.__data[3]=ye.elements[0],te.__data[4]=ye.elements[3],te.__data[5]=ye.elements[4],te.__data[6]=ye.elements[5],te.__data[7]=ye.elements[0],te.__data[8]=ye.elements[6],te.__data[9]=ye.elements[7],te.__data[10]=ye.elements[8],te.__data[11]=ye.elements[0]):(ye.toArray(te.__data,he),he+=pe.storage/Float32Array.BYTES_PER_ELEMENT)}n.bufferSubData(n.UNIFORM_BUFFER,V,te.__data)}}n.bindBuffer(n.UNIFORM_BUFFER,null)}function T(O,N,F){const G=O.value;if(F[N]===void 0){if(typeof G=="number")F[N]=G;else{const j=Array.isArray(G)?G:[G],Y=[];for(let te=0;te<j.length;te++)Y.push(j[te].clone());F[N]=Y}return!0}else if(typeof G=="number"){if(F[N]!==G)return F[N]=G,!0}else{const j=Array.isArray(F[N])?F[N]:[F[N]],Y=Array.isArray(G)?G:[G];for(let te=0;te<j.length;te++){const V=j[te];if(V.equals(Y[te])===!1)return V.copy(Y[te]),!0}}return!1}function I(O){const N=O.uniforms;let F=0;const G=16;let j=0;for(let Y=0,te=N.length;Y<te;Y++){const V=N[Y],Q={boundary:0,storage:0},he=Array.isArray(V.value)?V.value:[V.value];for(let fe=0,ye=he.length;fe<ye;fe++){const pe=he[fe],Me=R(pe);Q.boundary+=Me.boundary,Q.storage+=Me.storage}if(V.__data=new Float32Array(Q.storage/Float32Array.BYTES_PER_ELEMENT),V.__offset=F,Y>0){j=F%G;const fe=G-j;j!==0&&fe-Q.boundary<0&&(F+=G-j,V.__offset=F)}F+=Q.storage}return j=F%G,j>0&&(F+=G-j),O.__size=F,O.__cache={},this}function R(O){const N={boundary:0,storage:0};return typeof O=="number"?(N.boundary=4,N.storage=4):O.isVector2?(N.boundary=8,N.storage=8):O.isVector3||O.isColor?(N.boundary=16,N.storage=12):O.isVector4?(N.boundary=16,N.storage=16):O.isMatrix3?(N.boundary=48,N.storage=48):O.isMatrix4?(N.boundary=64,N.storage=64):O.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",O),N}function D(O){const N=O.target;N.removeEventListener("dispose",D);const F=d.indexOf(N.__bindingPointIndex);d.splice(F,1),n.deleteBuffer(s[N.id]),delete s[N.id],delete l[N.id]}function L(){for(const O in s)n.deleteBuffer(s[O]);d=[],s={},l={}}return{bind:f,update:y,dispose:L}}class y6{constructor(e={}){const{canvas:i=KX(),context:o=null,depth:s=!0,stencil:l=!0,alpha:d=!1,antialias:p=!1,premultipliedAlpha:f=!0,preserveDrawingBuffer:y=!1,powerPreference:_="default",failIfMajorPerformanceCaveat:x=!1}=e;this.isWebGLRenderer=!0;let S;o!==null?S=o.getContextAttributes().alpha:S=d;const T=new Uint32Array(4),I=new Int32Array(4);let R=null,D=null;const L=[],O=[];this.domElement=i,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this._outputColorSpace=Io,this._useLegacyLights=!1,this.toneMapping=gd,this.toneMappingExposure=1;const N=this;let F=!1,G=0,j=0,Y=null,te=-1,V=null;const Q=new Pa,he=new Pa;let fe=null;const ye=new Pn(0);let pe=0,Me=i.width,Ie=i.height,ze=1,le=null,me=null;const xe=new Pa(0,0,Me,Ie),ae=new Pa(0,0,Me,Ie);let Ee=!1;const Je=new VT;let Ze=!1,Ke=!1,Fe=null;const ct=new Ri,Ct=new tn,kt=new Ue,Kt={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function At(){return Y===null?ze:1}let Pe=o;function ft(Re,bt){for(let Ot=0;Ot<Re.length;Ot++){const Lt=Re[Ot],zt=i.getContext(Lt,bt);if(zt!==null)return zt}return null}try{const Re={alpha:!0,depth:s,stencil:l,antialias:p,premultipliedAlpha:f,preserveDrawingBuffer:y,powerPreference:_,failIfMajorPerformanceCaveat:x};if("setAttribute"in i&&i.setAttribute("data-engine",`three.js r${OT}`),i.addEventListener("webglcontextlost",hn,!1),i.addEventListener("webglcontextrestored",be,!1),i.addEventListener("webglcontextcreationerror",Qe,!1),Pe===null){const bt=["webgl2","webgl","experimental-webgl"];if(N.isWebGL1Renderer===!0&&bt.shift(),Pe=ft(bt,Re),Pe===null)throw ft(bt)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}typeof WebGLRenderingContext<"u"&&Pe instanceof WebGLRenderingContext&&console.warn("THREE.WebGLRenderer: WebGL 1 support was deprecated in r153 and will be removed in r163."),Pe.getShaderPrecisionFormat===void 0&&(Pe.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(Re){throw console.error("THREE.WebGLRenderer: "+Re.message),Re}let gt,_t,Be,ue,se,_e,je,De,st,de,ne,Oe,ut,it,lt,Et,Ut,Wt,Ht,Dt,wt,Xt,He,Pt;function qt(){gt=new f2e(Pe),_t=new l2e(Pe,gt,e),gt.init(_t),Xt=new lZ(Pe,gt,_t),Be=new q3e(Pe,gt,_t),ue=new y2e(Pe),se=new N3e,_e=new X3e(Pe,gt,Be,se,_t,Xt,ue),je=new u2e(N),De=new p2e(N),st=new Tbe(Pe,_t),He=new o2e(Pe,gt,st,_t),de=new m2e(Pe,st,ue,He),ne=new x2e(Pe,de,st,ue),Ht=new b2e(Pe,_t,_e),Et=new c2e(se),Oe=new O3e(N,je,De,gt,_t,He,Et),ut=new J3e(N,se),it=new F3e,lt=new H3e(gt,_t),Wt=new r2e(N,je,De,Be,ne,S,f),Ut=new Y3e(N,ne,_t),Pt=new Q3e(Pe,ue,_t,Be),Dt=new s2e(Pe,gt,ue,_t),wt=new g2e(Pe,gt,ue,_t),ue.programs=Oe.programs,N.capabilities=_t,N.extensions=gt,N.properties=se,N.renderLists=it,N.shadowMap=Ut,N.state=Be,N.info=ue}qt();const Nt=new K3e(N,Pe);this.xr=Nt,this.getContext=function(){return Pe},this.getContextAttributes=function(){return Pe.getContextAttributes()},this.forceContextLoss=function(){const Re=gt.get("WEBGL_lose_context");Re&&Re.loseContext()},this.forceContextRestore=function(){const Re=gt.get("WEBGL_lose_context");Re&&Re.restoreContext()},this.getPixelRatio=function(){return ze},this.setPixelRatio=function(Re){Re!==void 0&&(ze=Re,this.setSize(Me,Ie,!1))},this.getSize=function(Re){return Re.set(Me,Ie)},this.setSize=function(Re,bt,Ot=!0){if(Nt.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}Me=Re,Ie=bt,i.width=Math.floor(Re*ze),i.height=Math.floor(bt*ze),Ot===!0&&(i.style.width=Re+"px",i.style.height=bt+"px"),this.setViewport(0,0,Re,bt)},this.getDrawingBufferSize=function(Re){return Re.set(Me*ze,Ie*ze).floor()},this.setDrawingBufferSize=function(Re,bt,Ot){Me=Re,Ie=bt,ze=Ot,i.width=Math.floor(Re*Ot),i.height=Math.floor(bt*Ot),this.setViewport(0,0,Re,bt)},this.getCurrentViewport=function(Re){return Re.copy(Q)},this.getViewport=function(Re){return Re.copy(xe)},this.setViewport=function(Re,bt,Ot,Lt){Re.isVector4?xe.set(Re.x,Re.y,Re.z,Re.w):xe.set(Re,bt,Ot,Lt),Be.viewport(Q.copy(xe).multiplyScalar(ze).floor())},this.getScissor=function(Re){return Re.copy(ae)},this.setScissor=function(Re,bt,Ot,Lt){Re.isVector4?ae.set(Re.x,Re.y,Re.z,Re.w):ae.set(Re,bt,Ot,Lt),Be.scissor(he.copy(ae).multiplyScalar(ze).floor())},this.getScissorTest=function(){return Ee},this.setScissorTest=function(Re){Be.setScissorTest(Ee=Re)},this.setOpaqueSort=function(Re){le=Re},this.setTransparentSort=function(Re){me=Re},this.getClearColor=function(Re){return Re.copy(Wt.getClearColor())},this.setClearColor=function(){Wt.setClearColor.apply(Wt,arguments)},this.getClearAlpha=function(){return Wt.getClearAlpha()},this.setClearAlpha=function(){Wt.setClearAlpha.apply(Wt,arguments)},this.clear=function(Re=!0,bt=!0,Ot=!0){let Lt=0;if(Re){let zt=!1;if(Y!==null){const jt=Y.texture.format;zt=jt===o6||jt===r6||jt===a6}if(zt){const jt=Y.texture.type,gn=jt===yd||jt===Lh||jt===FT||jt===ff||jt===n6||jt===i6,Xn=Wt.getClearColor(),rn=Wt.getClearAlpha(),di=Xn.r,gi=Xn.g,li=Xn.b;gn?(T[0]=di,T[1]=gi,T[2]=li,T[3]=rn,Pe.clearBufferuiv(Pe.COLOR,0,T)):(I[0]=di,I[1]=gi,I[2]=li,I[3]=rn,Pe.clearBufferiv(Pe.COLOR,0,I))}else Lt|=Pe.COLOR_BUFFER_BIT}bt&&(Lt|=Pe.DEPTH_BUFFER_BIT),Ot&&(Lt|=Pe.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),Pe.clear(Lt)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){i.removeEventListener("webglcontextlost",hn,!1),i.removeEventListener("webglcontextrestored",be,!1),i.removeEventListener("webglcontextcreationerror",Qe,!1),it.dispose(),lt.dispose(),se.dispose(),je.dispose(),De.dispose(),ne.dispose(),He.dispose(),Pt.dispose(),Oe.dispose(),Nt.dispose(),Nt.removeEventListener("sessionstart",ht),Nt.removeEventListener("sessionend",dt),Fe&&(Fe.dispose(),Fe=null),Vt.stop()};function hn(Re){Re.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),F=!0}function be(){console.log("THREE.WebGLRenderer: Context Restored."),F=!1;const Re=ue.autoReset,bt=Ut.enabled,Ot=Ut.autoUpdate,Lt=Ut.needsUpdate,zt=Ut.type;qt(),ue.autoReset=Re,Ut.enabled=bt,Ut.autoUpdate=Ot,Ut.needsUpdate=Lt,Ut.type=zt}function Qe(Re){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",Re.statusMessage)}function we(Re){const bt=Re.target;bt.removeEventListener("dispose",we),Te(bt)}function Te(Re){Ne(Re),se.remove(Re)}function Ne(Re){const bt=se.get(Re).programs;bt!==void 0&&(bt.forEach(function(Ot){Oe.releaseProgram(Ot)}),Re.isShaderMaterial&&Oe.releaseShaderCache(Re))}this.renderBufferDirect=function(Re,bt,Ot,Lt,zt,jt){bt===null&&(bt=Kt);const gn=zt.isMesh&&zt.matrixWorld.determinant()<0,Xn=wi(Re,bt,Ot,Lt,zt);Be.setMaterial(Lt,gn);let rn=Ot.index,di=1;if(Lt.wireframe===!0){if(rn=de.getWireframeAttribute(Ot),rn===void 0)return;di=2}const gi=Ot.drawRange,li=Ot.attributes.position;let ra=gi.start*di,wr=(gi.start+gi.count)*di;jt!==null&&(ra=Math.max(ra,jt.start*di),wr=Math.min(wr,(jt.start+jt.count)*di)),rn!==null?(ra=Math.max(ra,0),wr=Math.min(wr,rn.count)):li!=null&&(ra=Math.max(ra,0),wr=Math.min(wr,li.count));const ia=wr-ra;if(ia<0||ia===1/0)return;He.setup(zt,Lt,Xn,Ot,rn);let Ka,ri=Dt;if(rn!==null&&(Ka=st.get(rn),ri=wt,ri.setIndex(Ka)),zt.isMesh)Lt.wireframe===!0?(Be.setLineWidth(Lt.wireframeLinewidth*At()),ri.setMode(Pe.LINES)):ri.setMode(Pe.TRIANGLES);else if(zt.isLine){let Rn=Lt.linewidth;Rn===void 0&&(Rn=1),Be.setLineWidth(Rn*At()),zt.isLineSegments?ri.setMode(Pe.LINES):zt.isLineLoop?ri.setMode(Pe.LINE_LOOP):ri.setMode(Pe.LINE_STRIP)}else zt.isPoints?ri.setMode(Pe.POINTS):zt.isSprite&&ri.setMode(Pe.TRIANGLES);if(zt.isInstancedMesh)ri.renderInstances(ra,ia,zt.count);else if(Ot.isInstancedBufferGeometry){const Rn=Ot._maxInstanceCount!==void 0?Ot._maxInstanceCount:1/0,uo=Math.min(Ot.instanceCount,Rn);ri.renderInstances(ra,ia,uo)}else ri.render(ra,ia)};function et(Re,bt,Ot){Re.transparent===!0&&Re.side===jl&&Re.forceSinglePass===!1?(Re.side=Ss,Re.needsUpdate=!0,Vn(Re,bt,Ot),Re.side=wd,Re.needsUpdate=!0,Vn(Re,bt,Ot),Re.side=jl):Vn(Re,bt,Ot)}this.compile=function(Re,bt,Ot=null){Ot===null&&(Ot=Re),D=lt.get(Ot),D.init(),O.push(D),Ot.traverseVisible(function(zt){zt.isLight&&zt.layers.test(bt.layers)&&(D.pushLight(zt),zt.castShadow&&D.pushShadow(zt))}),Re!==Ot&&Re.traverseVisible(function(zt){zt.isLight&&zt.layers.test(bt.layers)&&(D.pushLight(zt),zt.castShadow&&D.pushShadow(zt))}),D.setupLights(N._useLegacyLights);const Lt=new Set;return Re.traverse(function(zt){const jt=zt.material;if(jt)if(Array.isArray(jt))for(let gn=0;gn<jt.length;gn++){const Xn=jt[gn];et(Xn,Ot,zt),Lt.add(Xn)}else et(jt,Ot,zt),Lt.add(jt)}),O.pop(),D=null,Lt},this.compileAsync=function(Re,bt,Ot=null){const Lt=this.compile(Re,bt,Ot);return new Promise(zt=>{function jt(){if(Lt.forEach(function(gn){se.get(gn).currentProgram.isReady()&&Lt.delete(gn)}),Lt.size===0){zt(Re);return}setTimeout(jt,10)}gt.get("KHR_parallel_shader_compile")!==null?jt():setTimeout(jt,10)})};let tt=null;function vt(Re){tt&&tt(Re)}function ht(){Vt.stop()}function dt(){Vt.start()}const Vt=new iZ;Vt.setAnimationLoop(vt),typeof self<"u"&&Vt.setContext(self),this.setAnimationLoop=function(Re){tt=Re,Nt.setAnimationLoop(Re),Re===null?Vt.stop():Vt.start()},Nt.addEventListener("sessionstart",ht),Nt.addEventListener("sessionend",dt),this.render=function(Re,bt){if(bt!==void 0&&bt.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(F===!0)return;Re.matrixWorldAutoUpdate===!0&&Re.updateMatrixWorld(),bt.parent===null&&bt.matrixWorldAutoUpdate===!0&&bt.updateMatrixWorld(),Nt.enabled===!0&&Nt.isPresenting===!0&&(Nt.cameraAutoUpdate===!0&&Nt.updateCamera(bt),bt=Nt.getCamera()),Re.isScene===!0&&Re.onBeforeRender(N,Re,bt,Y),D=lt.get(Re,O.length),D.init(),O.push(D),ct.multiplyMatrices(bt.projectionMatrix,bt.matrixWorldInverse),Je.setFromProjectionMatrix(ct),Ke=this.localClippingEnabled,Ze=Et.init(this.clippingPlanes,Ke),R=it.get(Re,L.length),R.init(),L.push(R),It(Re,bt,0,N.sortObjects),R.finish(),N.sortObjects===!0&&R.sort(le,me),this.info.render.frame++,Ze===!0&&Et.beginShadows();const Ot=D.state.shadowsArray;if(Ut.render(Ot,Re,bt),Ze===!0&&Et.endShadows(),this.info.autoReset===!0&&this.info.reset(),Wt.render(R,Re),D.setupLights(N._useLegacyLights),bt.isArrayCamera){const Lt=bt.cameras;for(let zt=0,jt=Lt.length;zt<jt;zt++){const gn=Lt[zt];Qt(R,Re,gn,gn.viewport)}}else Qt(R,Re,bt);Y!==null&&(_e.updateMultisampleRenderTarget(Y),_e.updateRenderTargetMipmap(Y)),Re.isScene===!0&&Re.onAfterRender(N,Re,bt),He.resetDefaultState(),te=-1,V=null,O.pop(),O.length>0?D=O[O.length-1]:D=null,L.pop(),L.length>0?R=L[L.length-1]:R=null};function It(Re,bt,Ot,Lt){if(Re.visible===!1)return;if(Re.layers.test(bt.layers)){if(Re.isGroup)Ot=Re.renderOrder;else if(Re.isLOD)Re.autoUpdate===!0&&Re.update(bt);else if(Re.isLight)D.pushLight(Re),Re.castShadow&&D.pushShadow(Re);else if(Re.isSprite){if(!Re.frustumCulled||Je.intersectsSprite(Re)){Lt&&kt.setFromMatrixPosition(Re.matrixWorld).applyMatrix4(ct);const gn=ne.update(Re),Xn=Re.material;Xn.visible&&R.push(Re,gn,Xn,Ot,kt.z,null)}}else if((Re.isMesh||Re.isLine||Re.isPoints)&&(!Re.frustumCulled||Je.intersectsObject(Re))){const gn=ne.update(Re),Xn=Re.material;if(Lt&&(Re.boundingSphere!==void 0?(Re.boundingSphere===null&&Re.computeBoundingSphere(),kt.copy(Re.boundingSphere.center)):(gn.boundingSphere===null&&gn.computeBoundingSphere(),kt.copy(gn.boundingSphere.center)),kt.applyMatrix4(Re.matrixWorld).applyMatrix4(ct)),Array.isArray(Xn)){const rn=gn.groups;for(let di=0,gi=rn.length;di<gi;di++){const li=rn[di],ra=Xn[li.materialIndex];ra&&ra.visible&&R.push(Re,gn,ra,Ot,kt.z,li)}}else Xn.visible&&R.push(Re,gn,Xn,Ot,kt.z,null)}}const jt=Re.children;for(let gn=0,Xn=jt.length;gn<Xn;gn++)It(jt[gn],bt,Ot,Lt)}function Qt(Re,bt,Ot,Lt){const zt=Re.opaque,jt=Re.transmissive,gn=Re.transparent;D.setupLightsView(Ot),Ze===!0&&Et.setGlobalState(N.clippingPlanes,Ot),jt.length>0&&fn(zt,jt,bt,Ot),Lt&&Be.viewport(Q.copy(Lt)),zt.length>0&&en(zt,bt,Ot),jt.length>0&&en(jt,bt,Ot),gn.length>0&&en(gn,bt,Ot),Be.buffers.depth.setTest(!0),Be.buffers.depth.setMask(!0),Be.buffers.color.setMask(!0),Be.setPolygonOffset(!1)}function fn(Re,bt,Ot,Lt){if((Ot.isScene===!0?Ot.overrideMaterial:null)!==null)return;const jt=_t.isWebGL2;Fe===null&&(Fe=new yu(1,1,{generateMipmaps:!0,type:gt.has("EXT_color_buffer_half_float")?u_:yd,minFilter:Sf,samples:jt?4:0})),N.getDrawingBufferSize(Ct),jt?Fe.setSize(Ct.x,Ct.y):Fe.setSize(cM(Ct.x),cM(Ct.y));const gn=N.getRenderTarget();N.setRenderTarget(Fe),N.getClearColor(ye),pe=N.getClearAlpha(),pe<1&&N.setClearColor(16777215,.5),N.clear();const Xn=N.toneMapping;N.toneMapping=gd,en(Re,Ot,Lt),_e.updateMultisampleRenderTarget(Fe),_e.updateRenderTargetMipmap(Fe);let rn=!1;for(let di=0,gi=bt.length;di<gi;di++){const li=bt[di],ra=li.object,wr=li.geometry,ia=li.material,Ka=li.group;if(ia.side===jl&&ra.layers.test(Lt.layers)){const ri=ia.side;ia.side=Ss,ia.needsUpdate=!0,vn(ra,Ot,Lt,wr,ia,Ka),ia.side=ri,ia.needsUpdate=!0,rn=!0}}rn===!0&&(_e.updateMultisampleRenderTarget(Fe),_e.updateRenderTargetMipmap(Fe)),N.setRenderTarget(gn),N.setClearColor(ye,pe),N.toneMapping=Xn}function en(Re,bt,Ot){const Lt=bt.isScene===!0?bt.overrideMaterial:null;for(let zt=0,jt=Re.length;zt<jt;zt++){const gn=Re[zt],Xn=gn.object,rn=gn.geometry,di=Lt===null?gn.material:Lt,gi=gn.group;Xn.layers.test(Ot.layers)&&vn(Xn,bt,Ot,rn,di,gi)}}function vn(Re,bt,Ot,Lt,zt,jt){Re.onBeforeRender(N,bt,Ot,Lt,zt,jt),Re.modelViewMatrix.multiplyMatrices(Ot.matrixWorldInverse,Re.matrixWorld),Re.normalMatrix.getNormalMatrix(Re.modelViewMatrix),zt.onBeforeRender(N,bt,Ot,Lt,Re,jt),zt.transparent===!0&&zt.side===jl&&zt.forceSinglePass===!1?(zt.side=Ss,zt.needsUpdate=!0,N.renderBufferDirect(Ot,bt,Lt,zt,Re,jt),zt.side=wd,zt.needsUpdate=!0,N.renderBufferDirect(Ot,bt,Lt,zt,Re,jt),zt.side=jl):N.renderBufferDirect(Ot,bt,Lt,zt,Re,jt),Re.onAfterRender(N,bt,Ot,Lt,zt,jt)}function Vn(Re,bt,Ot){bt.isScene!==!0&&(bt=Kt);const Lt=se.get(Re),zt=D.state.lights,jt=D.state.shadowsArray,gn=zt.state.version,Xn=Oe.getParameters(Re,zt.state,jt,bt,Ot),rn=Oe.getProgramCacheKey(Xn);let di=Lt.programs;Lt.environment=Re.isMeshStandardMaterial?bt.environment:null,Lt.fog=bt.fog,Lt.envMap=(Re.isMeshStandardMaterial?De:je).get(Re.envMap||Lt.environment),di===void 0&&(Re.addEventListener("dispose",we),di=new Map,Lt.programs=di);let gi=di.get(rn);if(gi!==void 0){if(Lt.currentProgram===gi&&Lt.lightsStateVersion===gn)return xi(Re,Xn),gi}else Xn.uniforms=Oe.getUniforms(Re),Re.onBuild(Ot,Xn,N),Re.onBeforeCompile(Xn,N),gi=Oe.acquireProgram(Xn,rn),di.set(rn,gi),Lt.uniforms=Xn.uniforms;const li=Lt.uniforms;return(!Re.isShaderMaterial&&!Re.isRawShaderMaterial||Re.clipping===!0)&&(li.clippingPlanes=Et.uniform),xi(Re,Xn),Lt.needsLights=na(Re),Lt.lightsStateVersion=gn,Lt.needsLights&&(li.ambientLightColor.value=zt.state.ambient,li.lightProbe.value=zt.state.probe,li.directionalLights.value=zt.state.directional,li.directionalLightShadows.value=zt.state.directionalShadow,li.spotLights.value=zt.state.spot,li.spotLightShadows.value=zt.state.spotShadow,li.rectAreaLights.value=zt.state.rectArea,li.ltc_1.value=zt.state.rectAreaLTC1,li.ltc_2.value=zt.state.rectAreaLTC2,li.pointLights.value=zt.state.point,li.pointLightShadows.value=zt.state.pointShadow,li.hemisphereLights.value=zt.state.hemi,li.directionalShadowMap.value=zt.state.directionalShadowMap,li.directionalShadowMatrix.value=zt.state.directionalShadowMatrix,li.spotShadowMap.value=zt.state.spotShadowMap,li.spotLightMatrix.value=zt.state.spotLightMatrix,li.spotLightMap.value=zt.state.spotLightMap,li.pointShadowMap.value=zt.state.pointShadowMap,li.pointShadowMatrix.value=zt.state.pointShadowMatrix),Lt.currentProgram=gi,Lt.uniformsList=null,gi}function ei(Re){if(Re.uniformsList===null){const bt=Re.currentProgram.getUniforms();Re.uniformsList=hE.seqWithValue(bt.seq,Re.uniforms)}return Re.uniformsList}function xi(Re,bt){const Ot=se.get(Re);Ot.outputColorSpace=bt.outputColorSpace,Ot.instancing=bt.instancing,Ot.instancingColor=bt.instancingColor,Ot.skinning=bt.skinning,Ot.morphTargets=bt.morphTargets,Ot.morphNormals=bt.morphNormals,Ot.morphColors=bt.morphColors,Ot.morphTargetsCount=bt.morphTargetsCount,Ot.numClippingPlanes=bt.numClippingPlanes,Ot.numIntersection=bt.numClipIntersection,Ot.vertexAlphas=bt.vertexAlphas,Ot.vertexTangents=bt.vertexTangents,Ot.toneMapping=bt.toneMapping}function wi(Re,bt,Ot,Lt,zt){bt.isScene!==!0&&(bt=Kt),_e.resetTextureUnits();const jt=bt.fog,gn=Lt.isMeshStandardMaterial?bt.environment:null,Xn=Y===null?N.outputColorSpace:Y.isXRRenderTarget===!0?Y.texture.colorSpace:Sd,rn=(Lt.isMeshStandardMaterial?De:je).get(Lt.envMap||gn),di=Lt.vertexColors===!0&&!!Ot.attributes.color&&Ot.attributes.color.itemSize===4,gi=!!Ot.attributes.tangent&&(!!Lt.normalMap||Lt.anisotropy>0),li=!!Ot.morphAttributes.position,ra=!!Ot.morphAttributes.normal,wr=!!Ot.morphAttributes.color;let ia=gd;Lt.toneMapped&&(Y===null||Y.isXRRenderTarget===!0)&&(ia=N.toneMapping);const Ka=Ot.morphAttributes.position||Ot.morphAttributes.normal||Ot.morphAttributes.color,ri=Ka!==void 0?Ka.length:0,Rn=se.get(Lt),uo=D.state.lights;if(Ze===!0&&(Ke===!0||Re!==V)){const Jn=Re===V&&Lt.id===te;Et.setState(Lt,Re,Jn)}let Di=!1;Lt.version===Rn.__version?(Rn.needsLights&&Rn.lightsStateVersion!==uo.state.version||Rn.outputColorSpace!==Xn||zt.isInstancedMesh&&Rn.instancing===!1||!zt.isInstancedMesh&&Rn.instancing===!0||zt.isSkinnedMesh&&Rn.skinning===!1||!zt.isSkinnedMesh&&Rn.skinning===!0||zt.isInstancedMesh&&Rn.instancingColor===!0&&zt.instanceColor===null||zt.isInstancedMesh&&Rn.instancingColor===!1&&zt.instanceColor!==null||Rn.envMap!==rn||Lt.fog===!0&&Rn.fog!==jt||Rn.numClippingPlanes!==void 0&&(Rn.numClippingPlanes!==Et.numPlanes||Rn.numIntersection!==Et.numIntersection)||Rn.vertexAlphas!==di||Rn.vertexTangents!==gi||Rn.morphTargets!==li||Rn.morphNormals!==ra||Rn.morphColors!==wr||Rn.toneMapping!==ia||_t.isWebGL2===!0&&Rn.morphTargetsCount!==ri)&&(Di=!0):(Di=!0,Rn.__version=Lt.version);let Ia=Rn.currentProgram;Di===!0&&(Ia=Vn(Lt,bt,zt));let Go=!1,Sr=!1,Ja=!1;const fa=Ia.getUniforms(),zr=Rn.uniforms;if(Be.useProgram(Ia.program)&&(Go=!0,Sr=!0,Ja=!0),Lt.id!==te&&(te=Lt.id,Sr=!0),Go||V!==Re){fa.setValue(Pe,"projectionMatrix",Re.projectionMatrix),fa.setValue(Pe,"viewMatrix",Re.matrixWorldInverse);const Jn=fa.map.cameraPosition;Jn!==void 0&&Jn.setValue(Pe,kt.setFromMatrixPosition(Re.matrixWorld)),_t.logarithmicDepthBuffer&&fa.setValue(Pe,"logDepthBufFC",2/(Math.log(Re.far+1)/Math.LN2)),(Lt.isMeshPhongMaterial||Lt.isMeshToonMaterial||Lt.isMeshLambertMaterial||Lt.isMeshBasicMaterial||Lt.isMeshStandardMaterial||Lt.isShaderMaterial)&&fa.setValue(Pe,"isOrthographic",Re.isOrthographicCamera===!0),V!==Re&&(V=Re,Sr=!0,Ja=!0)}if(zt.isSkinnedMesh){fa.setOptional(Pe,zt,"bindMatrix"),fa.setOptional(Pe,zt,"bindMatrixInverse");const Jn=zt.skeleton;Jn&&(_t.floatVertexTextures?(Jn.boneTexture===null&&Jn.computeBoneTexture(),fa.setValue(Pe,"boneTexture",Jn.boneTexture,_e),fa.setValue(Pe,"boneTextureSize",Jn.boneTextureSize)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}const Cn=Ot.morphAttributes;if((Cn.position!==void 0||Cn.normal!==void 0||Cn.color!==void 0&&_t.isWebGL2===!0)&&Ht.update(zt,Ot,Ia),(Sr||Rn.receiveShadow!==zt.receiveShadow)&&(Rn.receiveShadow=zt.receiveShadow,fa.setValue(Pe,"receiveShadow",zt.receiveShadow)),Lt.isMeshGouraudMaterial&&Lt.envMap!==null&&(zr.envMap.value=rn,zr.flipEnvMap.value=rn.isCubeTexture&&rn.isRenderTargetTexture===!1?-1:1),Sr&&(fa.setValue(Pe,"toneMappingExposure",N.toneMappingExposure),Rn.needsLights&&pa(zr,Ja),jt&&Lt.fog===!0&&ut.refreshFogUniforms(zr,jt),ut.refreshMaterialUniforms(zr,Lt,ze,Ie,Fe),hE.upload(Pe,ei(Rn),zr,_e)),Lt.isShaderMaterial&&Lt.uniformsNeedUpdate===!0&&(hE.upload(Pe,ei(Rn),zr,_e),Lt.uniformsNeedUpdate=!1),Lt.isSpriteMaterial&&fa.setValue(Pe,"center",zt.center),fa.setValue(Pe,"modelViewMatrix",zt.modelViewMatrix),fa.setValue(Pe,"normalMatrix",zt.normalMatrix),fa.setValue(Pe,"modelMatrix",zt.matrixWorld),Lt.isShaderMaterial||Lt.isRawShaderMaterial){const Jn=Lt.uniformsGroups;for(let ja=0,Ar=Jn.length;ja<Ar;ja++)if(_t.isWebGL2){const Ts=Jn[ja];Pt.update(Ts,Ia),Pt.bind(Ts,Ia)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return Ia}function pa(Re,bt){Re.ambientLightColor.needsUpdate=bt,Re.lightProbe.needsUpdate=bt,Re.directionalLights.needsUpdate=bt,Re.directionalLightShadows.needsUpdate=bt,Re.pointLights.needsUpdate=bt,Re.pointLightShadows.needsUpdate=bt,Re.spotLights.needsUpdate=bt,Re.spotLightShadows.needsUpdate=bt,Re.rectAreaLights.needsUpdate=bt,Re.hemisphereLights.needsUpdate=bt}function na(Re){return Re.isMeshLambertMaterial||Re.isMeshToonMaterial||Re.isMeshPhongMaterial||Re.isMeshStandardMaterial||Re.isShadowMaterial||Re.isShaderMaterial&&Re.lights===!0}this.getActiveCubeFace=function(){return G},this.getActiveMipmapLevel=function(){return j},this.getRenderTarget=function(){return Y},this.setRenderTargetTextures=function(Re,bt,Ot){se.get(Re.texture).__webglTexture=bt,se.get(Re.depthTexture).__webglTexture=Ot;const Lt=se.get(Re);Lt.__hasExternalTextures=!0,Lt.__hasExternalTextures&&(Lt.__autoAllocateDepthBuffer=Ot===void 0,Lt.__autoAllocateDepthBuffer||gt.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),Lt.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(Re,bt){const Ot=se.get(Re);Ot.__webglFramebuffer=bt,Ot.__useDefaultFramebuffer=bt===void 0},this.setRenderTarget=function(Re,bt=0,Ot=0){Y=Re,G=bt,j=Ot;let Lt=!0,zt=null,jt=!1,gn=!1;if(Re){const rn=se.get(Re);rn.__useDefaultFramebuffer!==void 0?(Be.bindFramebuffer(Pe.FRAMEBUFFER,null),Lt=!1):rn.__webglFramebuffer===void 0?_e.setupRenderTarget(Re):rn.__hasExternalTextures&&_e.rebindTextures(Re,se.get(Re.texture).__webglTexture,se.get(Re.depthTexture).__webglTexture);const di=Re.texture;(di.isData3DTexture||di.isDataArrayTexture||di.isCompressedArrayTexture)&&(gn=!0);const gi=se.get(Re).__webglFramebuffer;Re.isWebGLCubeRenderTarget?(Array.isArray(gi[bt])?zt=gi[bt][Ot]:zt=gi[bt],jt=!0):_t.isWebGL2&&Re.samples>0&&_e.useMultisampledRTT(Re)===!1?zt=se.get(Re).__webglMultisampledFramebuffer:Array.isArray(gi)?zt=gi[Ot]:zt=gi,Q.copy(Re.viewport),he.copy(Re.scissor),fe=Re.scissorTest}else Q.copy(xe).multiplyScalar(ze).floor(),he.copy(ae).multiplyScalar(ze).floor(),fe=Ee;if(Be.bindFramebuffer(Pe.FRAMEBUFFER,zt)&&_t.drawBuffers&&Lt&&Be.drawBuffers(Re,zt),Be.viewport(Q),Be.scissor(he),Be.setScissorTest(fe),jt){const rn=se.get(Re.texture);Pe.framebufferTexture2D(Pe.FRAMEBUFFER,Pe.COLOR_ATTACHMENT0,Pe.TEXTURE_CUBE_MAP_POSITIVE_X+bt,rn.__webglTexture,Ot)}else if(gn){const rn=se.get(Re.texture),di=bt||0;Pe.framebufferTextureLayer(Pe.FRAMEBUFFER,Pe.COLOR_ATTACHMENT0,rn.__webglTexture,Ot||0,di)}te=-1},this.readRenderTargetPixels=function(Re,bt,Ot,Lt,zt,jt,gn){if(!(Re&&Re.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let Xn=se.get(Re).__webglFramebuffer;if(Re.isWebGLCubeRenderTarget&&gn!==void 0&&(Xn=Xn[gn]),Xn){Be.bindFramebuffer(Pe.FRAMEBUFFER,Xn);try{const rn=Re.texture,di=rn.format,gi=rn.type;if(di!==ml&&Xt.convert(di)!==Pe.getParameter(Pe.IMPLEMENTATION_COLOR_READ_FORMAT)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}const li=gi===u_&&(gt.has("EXT_color_buffer_half_float")||_t.isWebGL2&&gt.has("EXT_color_buffer_float"));if(gi!==yd&&Xt.convert(gi)!==Pe.getParameter(Pe.IMPLEMENTATION_COLOR_READ_TYPE)&&!(gi===ud&&(_t.isWebGL2||gt.has("OES_texture_float")||gt.has("WEBGL_color_buffer_float")))&&!li){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}bt>=0&&bt<=Re.width-Lt&&Ot>=0&&Ot<=Re.height-zt&&Pe.readPixels(bt,Ot,Lt,zt,Xt.convert(di),Xt.convert(gi),jt)}finally{const rn=Y!==null?se.get(Y).__webglFramebuffer:null;Be.bindFramebuffer(Pe.FRAMEBUFFER,rn)}}},this.copyFramebufferToTexture=function(Re,bt,Ot=0){const Lt=Math.pow(2,-Ot),zt=Math.floor(bt.image.width*Lt),jt=Math.floor(bt.image.height*Lt);_e.setTexture2D(bt,0),Pe.copyTexSubImage2D(Pe.TEXTURE_2D,Ot,0,0,Re.x,Re.y,zt,jt),Be.unbindTexture()},this.copyTextureToTexture=function(Re,bt,Ot,Lt=0){const zt=bt.image.width,jt=bt.image.height,gn=Xt.convert(Ot.format),Xn=Xt.convert(Ot.type);_e.setTexture2D(Ot,0),Pe.pixelStorei(Pe.UNPACK_FLIP_Y_WEBGL,Ot.flipY),Pe.pixelStorei(Pe.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Ot.premultiplyAlpha),Pe.pixelStorei(Pe.UNPACK_ALIGNMENT,Ot.unpackAlignment),bt.isDataTexture?Pe.texSubImage2D(Pe.TEXTURE_2D,Lt,Re.x,Re.y,zt,jt,gn,Xn,bt.image.data):bt.isCompressedTexture?Pe.compressedTexSubImage2D(Pe.TEXTURE_2D,Lt,Re.x,Re.y,bt.mipmaps[0].width,bt.mipmaps[0].height,gn,bt.mipmaps[0].data):Pe.texSubImage2D(Pe.TEXTURE_2D,Lt,Re.x,Re.y,gn,Xn,bt.image),Lt===0&&Ot.generateMipmaps&&Pe.generateMipmap(Pe.TEXTURE_2D),Be.unbindTexture()},this.copyTextureToTexture3D=function(Re,bt,Ot,Lt,zt=0){if(N.isWebGL1Renderer){console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");return}const jt=Re.max.x-Re.min.x+1,gn=Re.max.y-Re.min.y+1,Xn=Re.max.z-Re.min.z+1,rn=Xt.convert(Lt.format),di=Xt.convert(Lt.type);let gi;if(Lt.isData3DTexture)_e.setTexture3D(Lt,0),gi=Pe.TEXTURE_3D;else if(Lt.isDataArrayTexture)_e.setTexture2DArray(Lt,0),gi=Pe.TEXTURE_2D_ARRAY;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}Pe.pixelStorei(Pe.UNPACK_FLIP_Y_WEBGL,Lt.flipY),Pe.pixelStorei(Pe.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Lt.premultiplyAlpha),Pe.pixelStorei(Pe.UNPACK_ALIGNMENT,Lt.unpackAlignment);const li=Pe.getParameter(Pe.UNPACK_ROW_LENGTH),ra=Pe.getParameter(Pe.UNPACK_IMAGE_HEIGHT),wr=Pe.getParameter(Pe.UNPACK_SKIP_PIXELS),ia=Pe.getParameter(Pe.UNPACK_SKIP_ROWS),Ka=Pe.getParameter(Pe.UNPACK_SKIP_IMAGES),ri=Ot.isCompressedTexture?Ot.mipmaps[0]:Ot.image;Pe.pixelStorei(Pe.UNPACK_ROW_LENGTH,ri.width),Pe.pixelStorei(Pe.UNPACK_IMAGE_HEIGHT,ri.height),Pe.pixelStorei(Pe.UNPACK_SKIP_PIXELS,Re.min.x),Pe.pixelStorei(Pe.UNPACK_SKIP_ROWS,Re.min.y),Pe.pixelStorei(Pe.UNPACK_SKIP_IMAGES,Re.min.z),Ot.isDataTexture||Ot.isData3DTexture?Pe.texSubImage3D(gi,zt,bt.x,bt.y,bt.z,jt,gn,Xn,rn,di,ri.data):Ot.isCompressedArrayTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),Pe.compressedTexSubImage3D(gi,zt,bt.x,bt.y,bt.z,jt,gn,Xn,rn,ri.data)):Pe.texSubImage3D(gi,zt,bt.x,bt.y,bt.z,jt,gn,Xn,rn,di,ri),Pe.pixelStorei(Pe.UNPACK_ROW_LENGTH,li),Pe.pixelStorei(Pe.UNPACK_IMAGE_HEIGHT,ra),Pe.pixelStorei(Pe.UNPACK_SKIP_PIXELS,wr),Pe.pixelStorei(Pe.UNPACK_SKIP_ROWS,ia),Pe.pixelStorei(Pe.UNPACK_SKIP_IMAGES,Ka),zt===0&&Lt.generateMipmaps&&Pe.generateMipmap(gi),Be.unbindTexture()},this.initTexture=function(Re){Re.isCubeTexture?_e.setTextureCube(Re,0):Re.isData3DTexture?_e.setTexture3D(Re,0):Re.isDataArrayTexture||Re.isCompressedArrayTexture?_e.setTexture2DArray(Re,0):_e.setTexture2D(Re,0),Be.unbindTexture()},this.resetState=function(){G=0,j=0,Y=null,Be.reset(),He.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return dd}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const i=this.getContext();i.drawingBufferColorSpace=e===UT?"display-p3":"srgb",i.unpackColorSpace=Ba.workingColorSpace===Yw?"display-p3":"srgb"}get physicallyCorrectLights(){return console.warn("THREE.WebGLRenderer: The property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),!this.useLegacyLights}set physicallyCorrectLights(e){console.warn("THREE.WebGLRenderer: The property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),this.useLegacyLights=!e}get outputEncoding(){return console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace===Io?gf:l6}set outputEncoding(e){console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace=e===gf?Io:Sd}get useLegacyLights(){return console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights}set useLegacyLights(e){console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights=e}}class dZ extends y6{}dZ.prototype.isWebGL1Renderer=!0;class $T{constructor(e,i=25e-5){this.isFogExp2=!0,this.name="",this.color=new Pn(e),this.density=i}clone(){return new $T(this.color,this.density)}toJSON(){return{type:"FogExp2",name:this.name,color:this.color.getHex(),density:this.density}}}class YT{constructor(e,i=1,o=1e3){this.isFog=!0,this.name="",this.color=new Pn(e),this.near=i,this.far=o}clone(){return new YT(this.color,this.near,this.far)}toJSON(){return{type:"Fog",name:this.name,color:this.color.getHex(),near:this.near,far:this.far}}}class uM extends va{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,i){return super.copy(e,i),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const i=super.toJSON(e);return this.fog!==null&&(i.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(i.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(i.object.backgroundIntensity=this.backgroundIntensity),i}}class qT{constructor(e,i){this.isInterleavedBuffer=!0,this.array=e,this.stride=i,this.count=e!==void 0?e.length/i:0,this.usage=dw,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=Zl()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,i,o){e*=this.stride,o*=i.stride;for(let s=0,l=this.stride;s<l;s++)this.array[e+s]=i.array[o+s];return this}set(e,i=0){return this.array.set(e,i),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Zl()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const i=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),o=new this.constructor(i,this.stride);return o.setUsage(this.usage),o}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Zl()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const Bs=new Ue;class Ug{constructor(e,i,o,s=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=i,this.offset=o,this.normalized=s}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let i=0,o=this.data.count;i<o;i++)Bs.fromBufferAttribute(this,i),Bs.applyMatrix4(e),this.setXYZ(i,Bs.x,Bs.y,Bs.z);return this}applyNormalMatrix(e){for(let i=0,o=this.count;i<o;i++)Bs.fromBufferAttribute(this,i),Bs.applyNormalMatrix(e),this.setXYZ(i,Bs.x,Bs.y,Bs.z);return this}transformDirection(e){for(let i=0,o=this.count;i<o;i++)Bs.fromBufferAttribute(this,i),Bs.transformDirection(e),this.setXYZ(i,Bs.x,Bs.y,Bs.z);return this}setX(e,i){return this.normalized&&(i=Wi(i,this.array)),this.data.array[e*this.data.stride+this.offset]=i,this}setY(e,i){return this.normalized&&(i=Wi(i,this.array)),this.data.array[e*this.data.stride+this.offset+1]=i,this}setZ(e,i){return this.normalized&&(i=Wi(i,this.array)),this.data.array[e*this.data.stride+this.offset+2]=i,this}setW(e,i){return this.normalized&&(i=Wi(i,this.array)),this.data.array[e*this.data.stride+this.offset+3]=i,this}getX(e){let i=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(i=gl(i,this.array)),i}getY(e){let i=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(i=gl(i,this.array)),i}getZ(e){let i=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(i=gl(i,this.array)),i}getW(e){let i=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(i=gl(i,this.array)),i}setXY(e,i,o){return e=e*this.data.stride+this.offset,this.normalized&&(i=Wi(i,this.array),o=Wi(o,this.array)),this.data.array[e+0]=i,this.data.array[e+1]=o,this}setXYZ(e,i,o,s){return e=e*this.data.stride+this.offset,this.normalized&&(i=Wi(i,this.array),o=Wi(o,this.array),s=Wi(s,this.array)),this.data.array[e+0]=i,this.data.array[e+1]=o,this.data.array[e+2]=s,this}setXYZW(e,i,o,s,l){return e=e*this.data.stride+this.offset,this.normalized&&(i=Wi(i,this.array),o=Wi(o,this.array),s=Wi(s,this.array),l=Wi(l,this.array)),this.data.array[e+0]=i,this.data.array[e+1]=o,this.data.array[e+2]=s,this.data.array[e+3]=l,this}clone(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const i=[];for(let o=0;o<this.count;o++){const s=o*this.data.stride+this.offset;for(let l=0;l<this.itemSize;l++)i.push(this.data.array[s+l])}return new Za(new this.array.constructor(i),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new Ug(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const i=[];for(let o=0;o<this.count;o++){const s=o*this.data.stride+this.offset;for(let l=0;l<this.itemSize;l++)i.push(this.data.array[s+l])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:i,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class v6 extends es{constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new Pn(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}let Jv;const yb=new Ue,Qv=new Ue,e0=new Ue,t0=new tn,vb=new tn,hZ=new Ri,$S=new Ue,_b=new Ue,YS=new Ue,tV=new tn,Y4=new tn,nV=new tn;class pZ extends va{constructor(e=new v6){if(super(),this.isSprite=!0,this.type="Sprite",Jv===void 0){Jv=new ki;const i=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),o=new qT(i,5);Jv.setIndex([0,1,2,0,2,3]),Jv.setAttribute("position",new Ug(o,3,0,!1)),Jv.setAttribute("uv",new Ug(o,2,3,!1))}this.geometry=Jv,this.material=e,this.center=new tn(.5,.5)}raycast(e,i){e.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),Qv.setFromMatrixScale(this.matrixWorld),hZ.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),e0.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&Qv.multiplyScalar(-e0.z);const o=this.material.rotation;let s,l;o!==0&&(l=Math.cos(o),s=Math.sin(o));const d=this.center;qS($S.set(-.5,-.5,0),e0,d,Qv,s,l),qS(_b.set(.5,-.5,0),e0,d,Qv,s,l),qS(YS.set(.5,.5,0),e0,d,Qv,s,l),tV.set(0,0),Y4.set(1,0),nV.set(1,1);let p=e.ray.intersectTriangle($S,_b,YS,!1,yb);if(p===null&&(qS(_b.set(-.5,.5,0),e0,d,Qv,s,l),Y4.set(0,1),p=e.ray.intersectTriangle($S,YS,_b,!1,yb),p===null))return;const f=e.ray.origin.distanceTo(yb);f<e.near||f>e.far||i.push({distance:f,point:yb.clone(),uv:fl.getInterpolation(yb,$S,_b,YS,tV,Y4,nV,new tn),face:null,object:this})}copy(e,i){return super.copy(e,i),e.center!==void 0&&this.center.copy(e.center),this.material=e.material,this}}function qS(n,e,i,o,s,l){t0.subVectors(n,i).addScalar(.5).multiply(o),s!==void 0?(vb.x=l*t0.x-s*t0.y,vb.y=s*t0.x+l*t0.y):vb.copy(t0),n.copy(e),n.x+=vb.x,n.y+=vb.y,n.applyMatrix4(hZ)}const XS=new Ue,iV=new Ue;class fZ extends va{constructor(){super(),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),this.autoUpdate=!0}copy(e){super.copy(e,!1);const i=e.levels;for(let o=0,s=i.length;o<s;o++){const l=i[o];this.addLevel(l.object.clone(),l.distance,l.hysteresis)}return this.autoUpdate=e.autoUpdate,this}addLevel(e,i=0,o=0){i=Math.abs(i);const s=this.levels;let l;for(l=0;l<s.length&&!(i<s[l].distance);l++);return s.splice(l,0,{distance:i,hysteresis:o,object:e}),this.add(e),this}getCurrentLevel(){return this._currentLevel}getObjectForDistance(e){const i=this.levels;if(i.length>0){let o,s;for(o=1,s=i.length;o<s;o++){let l=i[o].distance;if(i[o].object.visible&&(l-=l*i[o].hysteresis),e<l)break}return i[o-1].object}return null}raycast(e,i){if(this.levels.length>0){XS.setFromMatrixPosition(this.matrixWorld);const s=e.ray.origin.distanceTo(XS);this.getObjectForDistance(s).raycast(e,i)}}update(e){const i=this.levels;if(i.length>1){XS.setFromMatrixPosition(e.matrixWorld),iV.setFromMatrixPosition(this.matrixWorld);const o=XS.distanceTo(iV)/e.zoom;i[0].object.visible=!0;let s,l;for(s=1,l=i.length;s<l;s++){let d=i[s].distance;if(i[s].object.visible&&(d-=d*i[s].hysteresis),o>=d)i[s-1].object.visible=!1,i[s].object.visible=!0;else break}for(this._currentLevel=s-1;s<l;s++)i[s].object.visible=!1}}toJSON(e){const i=super.toJSON(e);this.autoUpdate===!1&&(i.object.autoUpdate=!1),i.object.levels=[];const o=this.levels;for(let s=0,l=o.length;s<l;s++){const d=o[s];i.object.levels.push({object:d.object.uuid,distance:d.distance,hysteresis:d.hysteresis})}return i}}const aV=new Ue,rV=new Pa,oV=new Pa,eSe=new Ue,sV=new Ri,ZS=new Ue,q4=new Rc,lV=new Ri,X4=new Kg;class mZ extends wo{constructor(e,i){super(e,i),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=nR,this.bindMatrix=new Ri,this.bindMatrixInverse=new Ri,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const e=this.geometry;this.boundingBox===null&&(this.boundingBox=new _u),this.boundingBox.makeEmpty();const i=e.getAttribute("position");for(let o=0;o<i.count;o++)this.getVertexPosition(o,ZS),this.boundingBox.expandByPoint(ZS)}computeBoundingSphere(){const e=this.geometry;this.boundingSphere===null&&(this.boundingSphere=new Rc),this.boundingSphere.makeEmpty();const i=e.getAttribute("position");for(let o=0;o<i.count;o++)this.getVertexPosition(o,ZS),this.boundingSphere.expandByPoint(ZS)}copy(e,i){return super.copy(e,i),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}raycast(e,i){const o=this.material,s=this.matrixWorld;o!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),q4.copy(this.boundingSphere),q4.applyMatrix4(s),e.ray.intersectsSphere(q4)!==!1&&(lV.copy(s).invert(),X4.copy(e.ray).applyMatrix4(lV),!(this.boundingBox!==null&&X4.intersectsBox(this.boundingBox)===!1)&&this._computeIntersections(e,i,X4)))}getVertexPosition(e,i){return super.getVertexPosition(e,i),this.applyBoneTransform(e,i),i}bind(e,i){this.skeleton=e,i===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),i=this.matrixWorld),this.bindMatrix.copy(i),this.bindMatrixInverse.copy(i).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new Pa,i=this.geometry.attributes.skinWeight;for(let o=0,s=i.count;o<s;o++){e.fromBufferAttribute(i,o);const l=1/e.manhattanLength();l!==1/0?e.multiplyScalar(l):e.set(1,0,0,0),i.setXYZW(o,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode===nR?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode===MX?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,i){const o=this.skeleton,s=this.geometry;rV.fromBufferAttribute(s.attributes.skinIndex,e),oV.fromBufferAttribute(s.attributes.skinWeight,e),aV.copy(i).applyMatrix4(this.bindMatrix),i.set(0,0,0);for(let l=0;l<4;l++){const d=oV.getComponent(l);if(d!==0){const p=rV.getComponent(l);sV.multiplyMatrices(o.bones[p].matrixWorld,o.boneInverses[p]),i.addScaledVector(eSe.copy(aV).applyMatrix4(sV),d)}}return i.applyMatrix4(this.bindMatrixInverse)}boneTransform(e,i){return console.warn("THREE.SkinnedMesh: .boneTransform() was renamed to .applyBoneTransform() in r151."),this.applyBoneTransform(e,i)}}class _6 extends va{constructor(){super(),this.isBone=!0,this.type="Bone"}}class H0 extends Or{constructor(e=null,i=1,o=1,s,l,d,p,f,y=so,_=so,x,S){super(null,d,p,f,y,_,s,l,x,S),this.isDataTexture=!0,this.image={data:e,width:i,height:o},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const cV=new Ri,tSe=new Ri;class XT{constructor(e=[],i=[]){this.uuid=Zl(),this.bones=e.slice(0),this.boneInverses=i,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.init()}init(){const e=this.bones,i=this.boneInverses;if(this.boneMatrices=new Float32Array(e.length*16),i.length===0)this.calculateInverses();else if(e.length!==i.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let o=0,s=this.bones.length;o<s;o++)this.boneInverses.push(new Ri)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,i=this.bones.length;e<i;e++){const o=new Ri;this.bones[e]&&o.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(o)}}pose(){for(let e=0,i=this.bones.length;e<i;e++){const o=this.bones[e];o&&o.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,i=this.bones.length;e<i;e++){const o=this.bones[e];o&&(o.parent&&o.parent.isBone?(o.matrix.copy(o.parent.matrixWorld).invert(),o.matrix.multiply(o.matrixWorld)):o.matrix.copy(o.matrixWorld),o.matrix.decompose(o.position,o.quaternion,o.scale))}}update(){const e=this.bones,i=this.boneInverses,o=this.boneMatrices,s=this.boneTexture;for(let l=0,d=e.length;l<d;l++){const p=e[l]?e[l].matrixWorld:tSe;cV.multiplyMatrices(p,i[l]),cV.toArray(o,l*16)}s!==null&&(s.needsUpdate=!0)}clone(){return new XT(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(this.bones.length*4);e=XX(e),e=Math.max(e,4);const i=new Float32Array(e*e*4);i.set(this.boneMatrices);const o=new H0(i,e,e,ml,ud);return o.needsUpdate=!0,this.boneMatrices=i,this.boneTexture=o,this.boneTextureSize=e,this}getBoneByName(e){for(let i=0,o=this.bones.length;i<o;i++){const s=this.bones[i];if(s.name===e)return s}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,i){this.uuid=e.uuid;for(let o=0,s=e.bones.length;o<s;o++){const l=e.bones[o];let d=i[l];d===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",l),d=new _6),this.bones.push(d),this.boneInverses.push(new Ri().fromArray(e.boneInverses[o]))}return this.init(),this}toJSON(){const e={metadata:{version:4.6,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const i=this.bones,o=this.boneInverses;for(let s=0,l=i.length;s<l;s++){const d=i[s];e.bones.push(d.uuid);const p=o[s];e.boneInverses.push(p.toArray())}return e}}class Wg extends Za{constructor(e,i,o,s=1){super(e,i,o),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=s}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const n0=new Ri,uV=new Ri,KS=[],dV=new _u,nSe=new Ri,bb=new wo,xb=new Rc;class gZ extends wo{constructor(e,i,o){super(e,i),this.isInstancedMesh=!0,this.instanceMatrix=new Wg(new Float32Array(o*16),16),this.instanceColor=null,this.count=o,this.boundingBox=null,this.boundingSphere=null;for(let s=0;s<o;s++)this.setMatrixAt(s,nSe)}computeBoundingBox(){const e=this.geometry,i=this.count;this.boundingBox===null&&(this.boundingBox=new _u),e.boundingBox===null&&e.computeBoundingBox(),this.boundingBox.makeEmpty();for(let o=0;o<i;o++)this.getMatrixAt(o,n0),dV.copy(e.boundingBox).applyMatrix4(n0),this.boundingBox.union(dV)}computeBoundingSphere(){const e=this.geometry,i=this.count;this.boundingSphere===null&&(this.boundingSphere=new Rc),e.boundingSphere===null&&e.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let o=0;o<i;o++)this.getMatrixAt(o,n0),xb.copy(e.boundingSphere).applyMatrix4(n0),this.boundingSphere.union(xb)}copy(e,i){return super.copy(e,i),this.instanceMatrix.copy(e.instanceMatrix),e.instanceColor!==null&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}getColorAt(e,i){i.fromArray(this.instanceColor.array,e*3)}getMatrixAt(e,i){i.fromArray(this.instanceMatrix.array,e*16)}raycast(e,i){const o=this.matrixWorld,s=this.count;if(bb.geometry=this.geometry,bb.material=this.material,bb.material!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),xb.copy(this.boundingSphere),xb.applyMatrix4(o),e.ray.intersectsSphere(xb)!==!1))for(let l=0;l<s;l++){this.getMatrixAt(l,n0),uV.multiplyMatrices(o,n0),bb.matrixWorld=uV,bb.raycast(e,KS);for(let d=0,p=KS.length;d<p;d++){const f=KS[d];f.instanceId=l,f.object=this,i.push(f)}KS.length=0}}setColorAt(e,i){this.instanceColor===null&&(this.instanceColor=new Wg(new Float32Array(this.instanceMatrix.count*3),3)),i.toArray(this.instanceColor.array,e*3)}setMatrixAt(e,i){i.toArray(this.instanceMatrix.array,e*16)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}class qs extends es{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new Pn(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const hV=new Ue,pV=new Ue,fV=new Ri,Z4=new Kg,JS=new Rc;let Af=class extends va{constructor(e=new ki,i=new qs){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=i,this.updateMorphTargets()}copy(e,i){return super.copy(e,i),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.index===null){const i=e.attributes.position,o=[0];for(let s=1,l=i.count;s<l;s++)hV.fromBufferAttribute(i,s-1),pV.fromBufferAttribute(i,s),o[s]=o[s-1],o[s]+=hV.distanceTo(pV);e.setAttribute("lineDistance",new Gn(o,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,i){const o=this.geometry,s=this.matrixWorld,l=e.params.Line.threshold,d=o.drawRange;if(o.boundingSphere===null&&o.computeBoundingSphere(),JS.copy(o.boundingSphere),JS.applyMatrix4(s),JS.radius+=l,e.ray.intersectsSphere(JS)===!1)return;fV.copy(s).invert(),Z4.copy(e.ray).applyMatrix4(fV);const p=l/((this.scale.x+this.scale.y+this.scale.z)/3),f=p*p,y=new Ue,_=new Ue,x=new Ue,S=new Ue,T=this.isLineSegments?2:1,I=o.index,D=o.attributes.position;if(I!==null){const L=Math.max(0,d.start),O=Math.min(I.count,d.start+d.count);for(let N=L,F=O-1;N<F;N+=T){const G=I.getX(N),j=I.getX(N+1);if(y.fromBufferAttribute(D,G),_.fromBufferAttribute(D,j),Z4.distanceSqToSegment(y,_,S,x)>f)continue;S.applyMatrix4(this.matrixWorld);const te=e.ray.origin.distanceTo(S);te<e.near||te>e.far||i.push({distance:te,point:x.clone().applyMatrix4(this.matrixWorld),index:N,face:null,faceIndex:null,object:this})}}else{const L=Math.max(0,d.start),O=Math.min(D.count,d.start+d.count);for(let N=L,F=O-1;N<F;N+=T){if(y.fromBufferAttribute(D,N),_.fromBufferAttribute(D,N+1),Z4.distanceSqToSegment(y,_,S,x)>f)continue;S.applyMatrix4(this.matrixWorld);const j=e.ray.origin.distanceTo(S);j<e.near||j>e.far||i.push({distance:j,point:x.clone().applyMatrix4(this.matrixWorld),index:N,face:null,faceIndex:null,object:this})}}}updateMorphTargets(){const i=this.geometry.morphAttributes,o=Object.keys(i);if(o.length>0){const s=i[o[0]];if(s!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let l=0,d=s.length;l<d;l++){const p=s[l].name||String(l);this.morphTargetInfluences.push(0),this.morphTargetDictionary[p]=l}}}}};const mV=new Ue,gV=new Ue;class Cd extends Af{constructor(e,i){super(e,i),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.index===null){const i=e.attributes.position,o=[];for(let s=0,l=i.count;s<l;s+=2)mV.fromBufferAttribute(i,s),gV.fromBufferAttribute(i,s+1),o[s]=s===0?0:o[s-1],o[s+1]=o[s]+mV.distanceTo(gV);e.setAttribute("lineDistance",new Gn(o,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class yZ extends Af{constructor(e,i){super(e,i),this.isLineLoop=!0,this.type="LineLoop"}}class b6 extends es{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new Pn(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const yV=new Ri,kR=new Kg,QS=new Rc,eA=new Ue;class vZ extends va{constructor(e=new ki,i=new b6){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=i,this.updateMorphTargets()}copy(e,i){return super.copy(e,i),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,i){const o=this.geometry,s=this.matrixWorld,l=e.params.Points.threshold,d=o.drawRange;if(o.boundingSphere===null&&o.computeBoundingSphere(),QS.copy(o.boundingSphere),QS.applyMatrix4(s),QS.radius+=l,e.ray.intersectsSphere(QS)===!1)return;yV.copy(s).invert(),kR.copy(e.ray).applyMatrix4(yV);const p=l/((this.scale.x+this.scale.y+this.scale.z)/3),f=p*p,y=o.index,x=o.attributes.position;if(y!==null){const S=Math.max(0,d.start),T=Math.min(y.count,d.start+d.count);for(let I=S,R=T;I<R;I++){const D=y.getX(I);eA.fromBufferAttribute(x,D),vV(eA,D,f,s,e,i,this)}}else{const S=Math.max(0,d.start),T=Math.min(x.count,d.start+d.count);for(let I=S,R=T;I<R;I++)eA.fromBufferAttribute(x,I),vV(eA,I,f,s,e,i,this)}}updateMorphTargets(){const i=this.geometry.morphAttributes,o=Object.keys(i);if(o.length>0){const s=i[o[0]];if(s!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let l=0,d=s.length;l<d;l++){const p=s[l].name||String(l);this.morphTargetInfluences.push(0),this.morphTargetDictionary[p]=l}}}}}function vV(n,e,i,o,s,l,d){const p=kR.distanceSqToPoint(n);if(p<i){const f=new Ue;kR.closestPointToPoint(n,f),f.applyMatrix4(o);const y=s.ray.origin.distanceTo(f);if(y<s.near||y>s.far)return;l.push({distance:y,distanceToRay:Math.sqrt(p),point:f,index:e,face:null,object:d})}}class iSe extends Or{constructor(e,i,o,s,l,d,p,f,y){super(e,i,o,s,l,d,p,f,y),this.isVideoTexture=!0,this.minFilter=d!==void 0?d:Lr,this.magFilter=l!==void 0?l:Lr,this.generateMipmaps=!1;const _=this;function x(){_.needsUpdate=!0,e.requestVideoFrameCallback(x)}"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback(x)}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image;"requestVideoFrameCallback"in e===!1&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}class aSe extends Or{constructor(e,i){super({width:e,height:i}),this.isFramebufferTexture=!0,this.magFilter=so,this.minFilter=so,this.generateMipmaps=!1,this.needsUpdate=!0}}class ZT extends Or{constructor(e,i,o,s,l,d,p,f,y,_,x,S){super(null,d,p,f,y,_,s,l,x,S),this.isCompressedTexture=!0,this.image={width:i,height:o},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}class rSe extends ZT{constructor(e,i,o,s,l,d){super(e,i,o,l,d),this.isCompressedArrayTexture=!0,this.image.depth=s,this.wrapR=bs}}class oSe extends ZT{constructor(e,i,o){super(void 0,e[0].width,e[0].height,i,o,Hh),this.isCompressedCubeTexture=!0,this.isCubeTexture=!0,this.image=e}}class sSe extends Or{constructor(e,i,o,s,l,d,p,f,y){super(e,i,o,s,l,d,p,f,y),this.isCanvasTexture=!0,this.needsUpdate=!0}}class bu{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,i){const o=this.getUtoTmapping(e);return this.getPoint(o,i)}getPoints(e=5){const i=[];for(let o=0;o<=e;o++)i.push(this.getPoint(o/e));return i}getSpacedPoints(e=5){const i=[];for(let o=0;o<=e;o++)i.push(this.getPointAt(o/e));return i}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const i=[];let o,s=this.getPoint(0),l=0;i.push(0);for(let d=1;d<=e;d++)o=this.getPoint(d/e),l+=o.distanceTo(s),i.push(l),s=o;return this.cacheArcLengths=i,i}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,i){const o=this.getLengths();let s=0;const l=o.length;let d;i?d=i:d=e*o[l-1];let p=0,f=l-1,y;for(;p<=f;)if(s=Math.floor(p+(f-p)/2),y=o[s]-d,y<0)p=s+1;else if(y>0)f=s-1;else{f=s;break}if(s=f,o[s]===d)return s/(l-1);const _=o[s],S=o[s+1]-_,T=(d-_)/S;return(s+T)/(l-1)}getTangent(e,i){let s=e-1e-4,l=e+1e-4;s<0&&(s=0),l>1&&(l=1);const d=this.getPoint(s),p=this.getPoint(l),f=i||(d.isVector2?new tn:new Ue);return f.copy(p).sub(d).normalize(),f}getTangentAt(e,i){const o=this.getUtoTmapping(e);return this.getTangent(o,i)}computeFrenetFrames(e,i){const o=new Ue,s=[],l=[],d=[],p=new Ue,f=new Ri;for(let T=0;T<=e;T++){const I=T/e;s[T]=this.getTangentAt(I,new Ue)}l[0]=new Ue,d[0]=new Ue;let y=Number.MAX_VALUE;const _=Math.abs(s[0].x),x=Math.abs(s[0].y),S=Math.abs(s[0].z);_<=y&&(y=_,o.set(1,0,0)),x<=y&&(y=x,o.set(0,1,0)),S<=y&&o.set(0,0,1),p.crossVectors(s[0],o).normalize(),l[0].crossVectors(s[0],p),d[0].crossVectors(s[0],l[0]);for(let T=1;T<=e;T++){if(l[T]=l[T-1].clone(),d[T]=d[T-1].clone(),p.crossVectors(s[T-1],s[T]),p.length()>Number.EPSILON){p.normalize();const I=Math.acos(Yr(s[T-1].dot(s[T]),-1,1));l[T].applyMatrix4(f.makeRotationAxis(p,I))}d[T].crossVectors(s[T],l[T])}if(i===!0){let T=Math.acos(Yr(l[0].dot(l[e]),-1,1));T/=e,s[0].dot(p.crossVectors(l[0],l[e]))>0&&(T=-T);for(let I=1;I<=e;I++)l[I].applyMatrix4(f.makeRotationAxis(s[I],T*I)),d[I].crossVectors(s[I],l[I])}return{tangents:s,normals:l,binormals:d}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class KT extends bu{constructor(e=0,i=0,o=1,s=1,l=0,d=Math.PI*2,p=!1,f=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=i,this.xRadius=o,this.yRadius=s,this.aStartAngle=l,this.aEndAngle=d,this.aClockwise=p,this.aRotation=f}getPoint(e,i){const o=i||new tn,s=Math.PI*2;let l=this.aEndAngle-this.aStartAngle;const d=Math.abs(l)<Number.EPSILON;for(;l<0;)l+=s;for(;l>s;)l-=s;l<Number.EPSILON&&(d?l=0:l=s),this.aClockwise===!0&&!d&&(l===s?l=-s:l=l-s);const p=this.aStartAngle+e*l;let f=this.aX+this.xRadius*Math.cos(p),y=this.aY+this.yRadius*Math.sin(p);if(this.aRotation!==0){const _=Math.cos(this.aRotation),x=Math.sin(this.aRotation),S=f-this.aX,T=y-this.aY;f=S*_-T*x+this.aX,y=S*x+T*_+this.aY}return o.set(f,y)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}class _Z extends KT{constructor(e,i,o,s,l,d){super(e,i,o,o,s,l,d),this.isArcCurve=!0,this.type="ArcCurve"}}function x6(){let n=0,e=0,i=0,o=0;function s(l,d,p,f){n=l,e=p,i=-3*l+3*d-2*p-f,o=2*l-2*d+p+f}return{initCatmullRom:function(l,d,p,f,y){s(d,p,y*(p-l),y*(f-d))},initNonuniformCatmullRom:function(l,d,p,f,y,_,x){let S=(d-l)/y-(p-l)/(y+_)+(p-d)/_,T=(p-d)/_-(f-d)/(_+x)+(f-p)/x;S*=_,T*=_,s(d,p,S,T)},calc:function(l){const d=l*l,p=d*l;return n+e*l+i*d+o*p}}}const tA=new Ue,K4=new x6,J4=new x6,Q4=new x6;class bZ extends bu{constructor(e=[],i=!1,o="centripetal",s=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=i,this.curveType=o,this.tension=s}getPoint(e,i=new Ue){const o=i,s=this.points,l=s.length,d=(l-(this.closed?0:1))*e;let p=Math.floor(d),f=d-p;this.closed?p+=p>0?0:(Math.floor(Math.abs(p)/l)+1)*l:f===0&&p===l-1&&(p=l-2,f=1);let y,_;this.closed||p>0?y=s[(p-1)%l]:(tA.subVectors(s[0],s[1]).add(s[0]),y=tA);const x=s[p%l],S=s[(p+1)%l];if(this.closed||p+2<l?_=s[(p+2)%l]:(tA.subVectors(s[l-1],s[l-2]).add(s[l-1]),_=tA),this.curveType==="centripetal"||this.curveType==="chordal"){const T=this.curveType==="chordal"?.5:.25;let I=Math.pow(y.distanceToSquared(x),T),R=Math.pow(x.distanceToSquared(S),T),D=Math.pow(S.distanceToSquared(_),T);R<1e-4&&(R=1),I<1e-4&&(I=R),D<1e-4&&(D=R),K4.initNonuniformCatmullRom(y.x,x.x,S.x,_.x,I,R,D),J4.initNonuniformCatmullRom(y.y,x.y,S.y,_.y,I,R,D),Q4.initNonuniformCatmullRom(y.z,x.z,S.z,_.z,I,R,D)}else this.curveType==="catmullrom"&&(K4.initCatmullRom(y.x,x.x,S.x,_.x,this.tension),J4.initCatmullRom(y.y,x.y,S.y,_.y,this.tension),Q4.initCatmullRom(y.z,x.z,S.z,_.z,this.tension));return o.set(K4.calc(f),J4.calc(f),Q4.calc(f)),o}copy(e){super.copy(e),this.points=[];for(let i=0,o=e.points.length;i<o;i++){const s=e.points[i];this.points.push(s.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let i=0,o=this.points.length;i<o;i++){const s=this.points[i];e.points.push(s.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let i=0,o=e.points.length;i<o;i++){const s=e.points[i];this.points.push(new Ue().fromArray(s))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function _V(n,e,i,o,s){const l=(o-e)*.5,d=(s-i)*.5,p=n*n,f=n*p;return(2*i-2*o+l+d)*f+(-3*i+3*o-2*l-d)*p+l*n+i}function lSe(n,e){const i=1-n;return i*i*e}function cSe(n,e){return 2*(1-n)*n*e}function uSe(n,e){return n*n*e}function gx(n,e,i,o){return lSe(n,e)+cSe(n,i)+uSe(n,o)}function dSe(n,e){const i=1-n;return i*i*i*e}function hSe(n,e){const i=1-n;return 3*i*i*n*e}function pSe(n,e){return 3*(1-n)*n*n*e}function fSe(n,e){return n*n*n*e}function yx(n,e,i,o,s){return dSe(n,e)+hSe(n,i)+pSe(n,o)+fSe(n,s)}class w6 extends bu{constructor(e=new tn,i=new tn,o=new tn,s=new tn){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=i,this.v2=o,this.v3=s}getPoint(e,i=new tn){const o=i,s=this.v0,l=this.v1,d=this.v2,p=this.v3;return o.set(yx(e,s.x,l.x,d.x,p.x),yx(e,s.y,l.y,d.y,p.y)),o}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class xZ extends bu{constructor(e=new Ue,i=new Ue,o=new Ue,s=new Ue){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=i,this.v2=o,this.v3=s}getPoint(e,i=new Ue){const o=i,s=this.v0,l=this.v1,d=this.v2,p=this.v3;return o.set(yx(e,s.x,l.x,d.x,p.x),yx(e,s.y,l.y,d.y,p.y),yx(e,s.z,l.z,d.z,p.z)),o}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class S6 extends bu{constructor(e=new tn,i=new tn){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=i}getPoint(e,i=new tn){const o=i;return e===1?o.copy(this.v2):(o.copy(this.v2).sub(this.v1),o.multiplyScalar(e).add(this.v1)),o}getPointAt(e,i){return this.getPoint(e,i)}getTangent(e,i=new tn){return i.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,i){return this.getTangent(e,i)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class wZ extends bu{constructor(e=new Ue,i=new Ue){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=i}getPoint(e,i=new Ue){const o=i;return e===1?o.copy(this.v2):(o.copy(this.v2).sub(this.v1),o.multiplyScalar(e).add(this.v1)),o}getPointAt(e,i){return this.getPoint(e,i)}getTangent(e,i=new Ue){return i.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,i){return this.getTangent(e,i)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class A6 extends bu{constructor(e=new tn,i=new tn,o=new tn){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=i,this.v2=o}getPoint(e,i=new tn){const o=i,s=this.v0,l=this.v1,d=this.v2;return o.set(gx(e,s.x,l.x,d.x),gx(e,s.y,l.y,d.y)),o}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class E6 extends bu{constructor(e=new Ue,i=new Ue,o=new Ue){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=i,this.v2=o}getPoint(e,i=new Ue){const o=i,s=this.v0,l=this.v1,d=this.v2;return o.set(gx(e,s.x,l.x,d.x),gx(e,s.y,l.y,d.y),gx(e,s.z,l.z,d.z)),o}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class M6 extends bu{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,i=new tn){const o=i,s=this.points,l=(s.length-1)*e,d=Math.floor(l),p=l-d,f=s[d===0?d:d-1],y=s[d],_=s[d>s.length-2?s.length-1:d+1],x=s[d>s.length-3?s.length-1:d+2];return o.set(_V(p,f.x,y.x,_.x,x.x),_V(p,f.y,y.y,_.y,x.y)),o}copy(e){super.copy(e),this.points=[];for(let i=0,o=e.points.length;i<o;i++){const s=e.points[i];this.points.push(s.clone())}return this}toJSON(){const e=super.toJSON();e.points=[];for(let i=0,o=this.points.length;i<o;i++){const s=this.points[i];e.points.push(s.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let i=0,o=e.points.length;i<o;i++){const s=e.points[i];this.points.push(new tn().fromArray(s))}return this}}var dM=Object.freeze({__proto__:null,ArcCurve:_Z,CatmullRomCurve3:bZ,CubicBezierCurve:w6,CubicBezierCurve3:xZ,EllipseCurve:KT,LineCurve:S6,LineCurve3:wZ,QuadraticBezierCurve:A6,QuadraticBezierCurve3:E6,SplineCurve:M6});class SZ extends bu{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),i=this.curves[this.curves.length-1].getPoint(1);if(!e.equals(i)){const o=e.isVector2===!0?"LineCurve":"LineCurve3";this.curves.push(new dM[o](i,e))}return this}getPoint(e,i){const o=e*this.getLength(),s=this.getCurveLengths();let l=0;for(;l<s.length;){if(s[l]>=o){const d=s[l]-o,p=this.curves[l],f=p.getLength(),y=f===0?0:1-d/f;return p.getPointAt(y,i)}l++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let i=0;for(let o=0,s=this.curves.length;o<s;o++)i+=this.curves[o].getLength(),e.push(i);return this.cacheLengths=e,e}getSpacedPoints(e=40){const i=[];for(let o=0;o<=e;o++)i.push(this.getPoint(o/e));return this.autoClose&&i.push(i[0]),i}getPoints(e=12){const i=[];let o;for(let s=0,l=this.curves;s<l.length;s++){const d=l[s],p=d.isEllipseCurve?e*2:d.isLineCurve||d.isLineCurve3?1:d.isSplineCurve?e*d.points.length:e,f=d.getPoints(p);for(let y=0;y<f.length;y++){const _=f[y];o&&o.equals(_)||(i.push(_),o=_)}}return this.autoClose&&i.length>1&&!i[i.length-1].equals(i[0])&&i.push(i[0]),i}copy(e){super.copy(e),this.curves=[];for(let i=0,o=e.curves.length;i<o;i++){const s=e.curves[i];this.curves.push(s.clone())}return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let i=0,o=this.curves.length;i<o;i++){const s=this.curves[i];e.curves.push(s.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let i=0,o=e.curves.length;i<o;i++){const s=e.curves[i];this.curves.push(new dM[s.type]().fromJSON(s))}return this}}class fw extends SZ{constructor(e){super(),this.type="Path",this.currentPoint=new tn,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let i=1,o=e.length;i<o;i++)this.lineTo(e[i].x,e[i].y);return this}moveTo(e,i){return this.currentPoint.set(e,i),this}lineTo(e,i){const o=new S6(this.currentPoint.clone(),new tn(e,i));return this.curves.push(o),this.currentPoint.set(e,i),this}quadraticCurveTo(e,i,o,s){const l=new A6(this.currentPoint.clone(),new tn(e,i),new tn(o,s));return this.curves.push(l),this.currentPoint.set(o,s),this}bezierCurveTo(e,i,o,s,l,d){const p=new w6(this.currentPoint.clone(),new tn(e,i),new tn(o,s),new tn(l,d));return this.curves.push(p),this.currentPoint.set(l,d),this}splineThru(e){const i=[this.currentPoint.clone()].concat(e),o=new M6(i);return this.curves.push(o),this.currentPoint.copy(e[e.length-1]),this}arc(e,i,o,s,l,d){const p=this.currentPoint.x,f=this.currentPoint.y;return this.absarc(e+p,i+f,o,s,l,d),this}absarc(e,i,o,s,l,d){return this.absellipse(e,i,o,o,s,l,d),this}ellipse(e,i,o,s,l,d,p,f){const y=this.currentPoint.x,_=this.currentPoint.y;return this.absellipse(e+y,i+_,o,s,l,d,p,f),this}absellipse(e,i,o,s,l,d,p,f){const y=new KT(e,i,o,s,l,d,p,f);if(this.curves.length>0){const x=y.getPoint(0);x.equals(this.currentPoint)||this.lineTo(x.x,x.y)}this.curves.push(y);const _=y.getPoint(1);return this.currentPoint.copy(_),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class Kw extends ki{constructor(e=[new tn(0,-.5),new tn(.5,0),new tn(0,.5)],i=12,o=0,s=Math.PI*2){super(),this.type="LatheGeometry",this.parameters={points:e,segments:i,phiStart:o,phiLength:s},i=Math.floor(i),s=Yr(s,0,Math.PI*2);const l=[],d=[],p=[],f=[],y=[],_=1/i,x=new Ue,S=new tn,T=new Ue,I=new Ue,R=new Ue;let D=0,L=0;for(let O=0;O<=e.length-1;O++)switch(O){case 0:D=e[O+1].x-e[O].x,L=e[O+1].y-e[O].y,T.x=L*1,T.y=-D,T.z=L*0,R.copy(T),T.normalize(),f.push(T.x,T.y,T.z);break;case e.length-1:f.push(R.x,R.y,R.z);break;default:D=e[O+1].x-e[O].x,L=e[O+1].y-e[O].y,T.x=L*1,T.y=-D,T.z=L*0,I.copy(T),T.x+=R.x,T.y+=R.y,T.z+=R.z,T.normalize(),f.push(T.x,T.y,T.z),R.copy(I)}for(let O=0;O<=i;O++){const N=o+O*_*s,F=Math.sin(N),G=Math.cos(N);for(let j=0;j<=e.length-1;j++){x.x=e[j].x*F,x.y=e[j].y,x.z=e[j].x*G,d.push(x.x,x.y,x.z),S.x=O/i,S.y=j/(e.length-1),p.push(S.x,S.y);const Y=f[3*j+0]*F,te=f[3*j+1],V=f[3*j+0]*G;y.push(Y,te,V)}}for(let O=0;O<i;O++)for(let N=0;N<e.length-1;N++){const F=N+O*e.length,G=F,j=F+e.length,Y=F+e.length+1,te=F+1;l.push(G,j,te),l.push(Y,te,j)}this.setIndex(l),this.setAttribute("position",new Gn(d,3)),this.setAttribute("uv",new Gn(p,2)),this.setAttribute("normal",new Gn(y,3))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Kw(e.points,e.segments,e.phiStart,e.phiLength)}}class JT extends Kw{constructor(e=1,i=1,o=4,s=8){const l=new fw;l.absarc(0,-i/2,e,Math.PI*1.5,0),l.absarc(0,i/2,e,0,Math.PI*.5),super(l.getPoints(o),s),this.type="CapsuleGeometry",this.parameters={radius:e,length:i,capSegments:o,radialSegments:s}}static fromJSON(e){return new JT(e.radius,e.length,e.capSegments,e.radialSegments)}}class QT extends ki{constructor(e=1,i=32,o=0,s=Math.PI*2){super(),this.type="CircleGeometry",this.parameters={radius:e,segments:i,thetaStart:o,thetaLength:s},i=Math.max(3,i);const l=[],d=[],p=[],f=[],y=new Ue,_=new tn;d.push(0,0,0),p.push(0,0,1),f.push(.5,.5);for(let x=0,S=3;x<=i;x++,S+=3){const T=o+x/i*s;y.x=e*Math.cos(T),y.y=e*Math.sin(T),d.push(y.x,y.y,y.z),p.push(0,0,1),_.x=(d[S]/e+1)/2,_.y=(d[S+1]/e+1)/2,f.push(_.x,_.y)}for(let x=1;x<=i;x++)l.push(x,x+1,0);this.setIndex(l),this.setAttribute("position",new Gn(d,3)),this.setAttribute("normal",new Gn(p,3)),this.setAttribute("uv",new Gn(f,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new QT(e.radius,e.segments,e.thetaStart,e.thetaLength)}}class E_ extends ki{constructor(e=1,i=1,o=1,s=32,l=1,d=!1,p=0,f=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:i,height:o,radialSegments:s,heightSegments:l,openEnded:d,thetaStart:p,thetaLength:f};const y=this;s=Math.floor(s),l=Math.floor(l);const _=[],x=[],S=[],T=[];let I=0;const R=[],D=o/2;let L=0;O(),d===!1&&(e>0&&N(!0),i>0&&N(!1)),this.setIndex(_),this.setAttribute("position",new Gn(x,3)),this.setAttribute("normal",new Gn(S,3)),this.setAttribute("uv",new Gn(T,2));function O(){const F=new Ue,G=new Ue;let j=0;const Y=(i-e)/o;for(let te=0;te<=l;te++){const V=[],Q=te/l,he=Q*(i-e)+e;for(let fe=0;fe<=s;fe++){const ye=fe/s,pe=ye*f+p,Me=Math.sin(pe),Ie=Math.cos(pe);G.x=he*Me,G.y=-Q*o+D,G.z=he*Ie,x.push(G.x,G.y,G.z),F.set(Me,Y,Ie).normalize(),S.push(F.x,F.y,F.z),T.push(ye,1-Q),V.push(I++)}R.push(V)}for(let te=0;te<s;te++)for(let V=0;V<l;V++){const Q=R[V][te],he=R[V+1][te],fe=R[V+1][te+1],ye=R[V][te+1];_.push(Q,he,ye),_.push(he,fe,ye),j+=6}y.addGroup(L,j,0),L+=j}function N(F){const G=I,j=new tn,Y=new Ue;let te=0;const V=F===!0?e:i,Q=F===!0?1:-1;for(let fe=1;fe<=s;fe++)x.push(0,D*Q,0),S.push(0,Q,0),T.push(.5,.5),I++;const he=I;for(let fe=0;fe<=s;fe++){const pe=fe/s*f+p,Me=Math.cos(pe),Ie=Math.sin(pe);Y.x=V*Ie,Y.y=D*Q,Y.z=V*Me,x.push(Y.x,Y.y,Y.z),S.push(0,Q,0),j.x=Me*.5+.5,j.y=Ie*.5*Q+.5,T.push(j.x,j.y),I++}for(let fe=0;fe<s;fe++){const ye=G+fe,pe=he+fe;F===!0?_.push(pe,pe+1,ye):_.push(pe+1,pe,ye),te+=3}y.addGroup(L,te,F===!0?1:2),L+=te}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new E_(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class eC extends E_{constructor(e=1,i=1,o=32,s=1,l=!1,d=0,p=Math.PI*2){super(0,e,i,o,s,l,d,p),this.type="ConeGeometry",this.parameters={radius:e,height:i,radialSegments:o,heightSegments:s,openEnded:l,thetaStart:d,thetaLength:p}}static fromJSON(e){return new eC(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class kf extends ki{constructor(e=[],i=[],o=1,s=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:i,radius:o,detail:s};const l=[],d=[];p(s),y(o),_(),this.setAttribute("position",new Gn(l,3)),this.setAttribute("normal",new Gn(l.slice(),3)),this.setAttribute("uv",new Gn(d,2)),s===0?this.computeVertexNormals():this.normalizeNormals();function p(O){const N=new Ue,F=new Ue,G=new Ue;for(let j=0;j<i.length;j+=3)T(i[j+0],N),T(i[j+1],F),T(i[j+2],G),f(N,F,G,O)}function f(O,N,F,G){const j=G+1,Y=[];for(let te=0;te<=j;te++){Y[te]=[];const V=O.clone().lerp(F,te/j),Q=N.clone().lerp(F,te/j),he=j-te;for(let fe=0;fe<=he;fe++)fe===0&&te===j?Y[te][fe]=V:Y[te][fe]=V.clone().lerp(Q,fe/he)}for(let te=0;te<j;te++)for(let V=0;V<2*(j-te)-1;V++){const Q=Math.floor(V/2);V%2===0?(S(Y[te][Q+1]),S(Y[te+1][Q]),S(Y[te][Q])):(S(Y[te][Q+1]),S(Y[te+1][Q+1]),S(Y[te+1][Q]))}}function y(O){const N=new Ue;for(let F=0;F<l.length;F+=3)N.x=l[F+0],N.y=l[F+1],N.z=l[F+2],N.normalize().multiplyScalar(O),l[F+0]=N.x,l[F+1]=N.y,l[F+2]=N.z}function _(){const O=new Ue;for(let N=0;N<l.length;N+=3){O.x=l[N+0],O.y=l[N+1],O.z=l[N+2];const F=D(O)/2/Math.PI+.5,G=L(O)/Math.PI+.5;d.push(F,1-G)}I(),x()}function x(){for(let O=0;O<d.length;O+=6){const N=d[O+0],F=d[O+2],G=d[O+4],j=Math.max(N,F,G),Y=Math.min(N,F,G);j>.9&&Y<.1&&(N<.2&&(d[O+0]+=1),F<.2&&(d[O+2]+=1),G<.2&&(d[O+4]+=1))}}function S(O){l.push(O.x,O.y,O.z)}function T(O,N){const F=O*3;N.x=e[F+0],N.y=e[F+1],N.z=e[F+2]}function I(){const O=new Ue,N=new Ue,F=new Ue,G=new Ue,j=new tn,Y=new tn,te=new tn;for(let V=0,Q=0;V<l.length;V+=9,Q+=6){O.set(l[V+0],l[V+1],l[V+2]),N.set(l[V+3],l[V+4],l[V+5]),F.set(l[V+6],l[V+7],l[V+8]),j.set(d[Q+0],d[Q+1]),Y.set(d[Q+2],d[Q+3]),te.set(d[Q+4],d[Q+5]),G.copy(O).add(N).add(F).divideScalar(3);const he=D(G);R(j,Q+0,O,he),R(Y,Q+2,N,he),R(te,Q+4,F,he)}}function R(O,N,F,G){G<0&&O.x===1&&(d[N]=O.x-1),F.x===0&&F.z===0&&(d[N]=G/2/Math.PI+.5)}function D(O){return Math.atan2(O.z,-O.x)}function L(O){return Math.atan2(-O.y,Math.sqrt(O.x*O.x+O.z*O.z))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new kf(e.vertices,e.indices,e.radius,e.details)}}class tC extends kf{constructor(e=1,i=0){const o=(1+Math.sqrt(5))/2,s=1/o,l=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-s,-o,0,-s,o,0,s,-o,0,s,o,-s,-o,0,-s,o,0,s,-o,0,s,o,0,-o,0,-s,o,0,-s,-o,0,s,o,0,s],d=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(l,d,e,i),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:i}}static fromJSON(e){return new tC(e.radius,e.detail)}}const nA=new Ue,iA=new Ue,eI=new Ue,aA=new fl;class AZ extends ki{constructor(e=null,i=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:i},e!==null){const s=Math.pow(10,4),l=Math.cos(Ag*i),d=e.getIndex(),p=e.getAttribute("position"),f=d?d.count:p.count,y=[0,0,0],_=["a","b","c"],x=new Array(3),S={},T=[];for(let I=0;I<f;I+=3){d?(y[0]=d.getX(I),y[1]=d.getX(I+1),y[2]=d.getX(I+2)):(y[0]=I,y[1]=I+1,y[2]=I+2);const{a:R,b:D,c:L}=aA;if(R.fromBufferAttribute(p,y[0]),D.fromBufferAttribute(p,y[1]),L.fromBufferAttribute(p,y[2]),aA.getNormal(eI),x[0]=`${Math.round(R.x*s)},${Math.round(R.y*s)},${Math.round(R.z*s)}`,x[1]=`${Math.round(D.x*s)},${Math.round(D.y*s)},${Math.round(D.z*s)}`,x[2]=`${Math.round(L.x*s)},${Math.round(L.y*s)},${Math.round(L.z*s)}`,!(x[0]===x[1]||x[1]===x[2]||x[2]===x[0]))for(let O=0;O<3;O++){const N=(O+1)%3,F=x[O],G=x[N],j=aA[_[O]],Y=aA[_[N]],te=`${F}_${G}`,V=`${G}_${F}`;V in S&&S[V]?(eI.dot(S[V].normal)<=l&&(T.push(j.x,j.y,j.z),T.push(Y.x,Y.y,Y.z)),S[V]=null):te in S||(S[te]={index0:y[O],index1:y[N],normal:eI.clone()})}}for(const I in S)if(S[I]){const{index0:R,index1:D}=S[I];nA.fromBufferAttribute(p,R),iA.fromBufferAttribute(p,D),T.push(nA.x,nA.y,nA.z),T.push(iA.x,iA.y,iA.z)}this.setAttribute("position",new Gn(T,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}class Mg extends fw{constructor(e){super(e),this.uuid=Zl(),this.type="Shape",this.holes=[]}getPointsHoles(e){const i=[];for(let o=0,s=this.holes.length;o<s;o++)i[o]=this.holes[o].getPoints(e);return i}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let i=0,o=e.holes.length;i<o;i++){const s=e.holes[i];this.holes.push(s.clone())}return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let i=0,o=this.holes.length;i<o;i++){const s=this.holes[i];e.holes.push(s.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let i=0,o=e.holes.length;i<o;i++){const s=e.holes[i];this.holes.push(new fw().fromJSON(s))}return this}}const mSe={triangulate:function(n,e,i=2){const o=e&&e.length,s=o?e[0]*i:n.length;let l=EZ(n,0,s,i,!0);const d=[];if(!l||l.next===l.prev)return d;let p,f,y,_,x,S,T;if(o&&(l=bSe(n,e,l,i)),n.length>80*i){p=y=n[0],f=_=n[1];for(let I=i;I<s;I+=i)x=n[I],S=n[I+1],x<p&&(p=x),S<f&&(f=S),x>y&&(y=x),S>_&&(_=S);T=Math.max(y-p,_-f),T=T!==0?32767/T:0}return mw(l,d,i,p,f,T,0),d}};function EZ(n,e,i,o,s){let l,d;if(s===LSe(n,e,i,o)>0)for(l=e;l<i;l+=o)d=bV(l,n[l],n[l+1],d);else for(l=i-o;l>=e;l-=o)d=bV(l,n[l],n[l+1],d);return d&&nC(d,d.next)&&(yw(d),d=d.next),d}function Vg(n,e){if(!n)return n;e||(e=n);let i=n,o;do if(o=!1,!i.steiner&&(nC(i,i.next)||Rr(i.prev,i,i.next)===0)){if(yw(i),i=e=i.prev,i===i.next)break;o=!0}else i=i.next;while(o||i!==e);return e}function mw(n,e,i,o,s,l,d){if(!n)return;!d&&l&&ESe(n,o,s,l);let p=n,f,y;for(;n.prev!==n.next;){if(f=n.prev,y=n.next,l?ySe(n,o,s,l):gSe(n)){e.push(f.i/i|0),e.push(n.i/i|0),e.push(y.i/i|0),yw(n),n=y.next,p=y.next;continue}if(n=y,n===p){d?d===1?(n=vSe(Vg(n),e,i),mw(n,e,i,o,s,l,2)):d===2&&_Se(n,e,i,o,s,l):mw(Vg(n),e,i,o,s,l,1);break}}}function gSe(n){const e=n.prev,i=n,o=n.next;if(Rr(e,i,o)>=0)return!1;const s=e.x,l=i.x,d=o.x,p=e.y,f=i.y,y=o.y,_=s<l?s<d?s:d:l<d?l:d,x=p<f?p<y?p:y:f<y?f:y,S=s>l?s>d?s:d:l>d?l:d,T=p>f?p>y?p:y:f>y?f:y;let I=o.next;for(;I!==e;){if(I.x>=_&&I.x<=S&&I.y>=x&&I.y<=T&&L0(s,p,l,f,d,y,I.x,I.y)&&Rr(I.prev,I,I.next)>=0)return!1;I=I.next}return!0}function ySe(n,e,i,o){const s=n.prev,l=n,d=n.next;if(Rr(s,l,d)>=0)return!1;const p=s.x,f=l.x,y=d.x,_=s.y,x=l.y,S=d.y,T=p<f?p<y?p:y:f<y?f:y,I=_<x?_<S?_:S:x<S?x:S,R=p>f?p>y?p:y:f>y?f:y,D=_>x?_>S?_:S:x>S?x:S,L=DR(T,I,e,i,o),O=DR(R,D,e,i,o);let N=n.prevZ,F=n.nextZ;for(;N&&N.z>=L&&F&&F.z<=O;){if(N.x>=T&&N.x<=R&&N.y>=I&&N.y<=D&&N!==s&&N!==d&&L0(p,_,f,x,y,S,N.x,N.y)&&Rr(N.prev,N,N.next)>=0||(N=N.prevZ,F.x>=T&&F.x<=R&&F.y>=I&&F.y<=D&&F!==s&&F!==d&&L0(p,_,f,x,y,S,F.x,F.y)&&Rr(F.prev,F,F.next)>=0))return!1;F=F.nextZ}for(;N&&N.z>=L;){if(N.x>=T&&N.x<=R&&N.y>=I&&N.y<=D&&N!==s&&N!==d&&L0(p,_,f,x,y,S,N.x,N.y)&&Rr(N.prev,N,N.next)>=0)return!1;N=N.prevZ}for(;F&&F.z<=O;){if(F.x>=T&&F.x<=R&&F.y>=I&&F.y<=D&&F!==s&&F!==d&&L0(p,_,f,x,y,S,F.x,F.y)&&Rr(F.prev,F,F.next)>=0)return!1;F=F.nextZ}return!0}function vSe(n,e,i){let o=n;do{const s=o.prev,l=o.next.next;!nC(s,l)&&MZ(s,o,o.next,l)&&gw(s,l)&&gw(l,s)&&(e.push(s.i/i|0),e.push(o.i/i|0),e.push(l.i/i|0),yw(o),yw(o.next),o=n=l),o=o.next}while(o!==n);return Vg(o)}function _Se(n,e,i,o,s,l){let d=n;do{let p=d.next.next;for(;p!==d.prev;){if(d.i!==p.i&&CSe(d,p)){let f=TZ(d,p);d=Vg(d,d.next),f=Vg(f,f.next),mw(d,e,i,o,s,l,0),mw(f,e,i,o,s,l,0);return}p=p.next}d=d.next}while(d!==n)}function bSe(n,e,i,o){const s=[];let l,d,p,f,y;for(l=0,d=e.length;l<d;l++)p=e[l]*o,f=l<d-1?e[l+1]*o:n.length,y=EZ(n,p,f,o,!1),y===y.next&&(y.steiner=!0),s.push(TSe(y));for(s.sort(xSe),l=0;l<s.length;l++)i=wSe(s[l],i);return i}function xSe(n,e){return n.x-e.x}function wSe(n,e){const i=SSe(n,e);if(!i)return e;const o=TZ(i,n);return Vg(o,o.next),Vg(i,i.next)}function SSe(n,e){let i=e,o=-1/0,s;const l=n.x,d=n.y;do{if(d<=i.y&&d>=i.next.y&&i.next.y!==i.y){const S=i.x+(d-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(S<=l&&S>o&&(o=S,s=i.x<i.next.x?i:i.next,S===l))return s}i=i.next}while(i!==e);if(!s)return null;const p=s,f=s.x,y=s.y;let _=1/0,x;i=s;do l>=i.x&&i.x>=f&&l!==i.x&&L0(d<y?l:o,d,f,y,d<y?o:l,d,i.x,i.y)&&(x=Math.abs(d-i.y)/(l-i.x),gw(i,n)&&(x<_||x===_&&(i.x>s.x||i.x===s.x&&ASe(s,i)))&&(s=i,_=x)),i=i.next;while(i!==p);return s}function ASe(n,e){return Rr(n.prev,n,e.prev)<0&&Rr(e.next,n,n.next)<0}function ESe(n,e,i,o){let s=n;do s.z===0&&(s.z=DR(s.x,s.y,e,i,o)),s.prevZ=s.prev,s.nextZ=s.next,s=s.next;while(s!==n);s.prevZ.nextZ=null,s.prevZ=null,MSe(s)}function MSe(n){let e,i,o,s,l,d,p,f,y=1;do{for(i=n,n=null,l=null,d=0;i;){for(d++,o=i,p=0,e=0;e<y&&(p++,o=o.nextZ,!!o);e++);for(f=y;p>0||f>0&&o;)p!==0&&(f===0||!o||i.z<=o.z)?(s=i,i=i.nextZ,p--):(s=o,o=o.nextZ,f--),l?l.nextZ=s:n=s,s.prevZ=l,l=s;i=o}l.nextZ=null,y*=2}while(d>1);return n}function DR(n,e,i,o,s){return n=(n-i)*s|0,e=(e-o)*s|0,n=(n|n<<8)&16711935,n=(n|n<<4)&252645135,n=(n|n<<2)&858993459,n=(n|n<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,n|e<<1}function TSe(n){let e=n,i=n;do(e.x<i.x||e.x===i.x&&e.y<i.y)&&(i=e),e=e.next;while(e!==n);return i}function L0(n,e,i,o,s,l,d,p){return(s-d)*(e-p)>=(n-d)*(l-p)&&(n-d)*(o-p)>=(i-d)*(e-p)&&(i-d)*(l-p)>=(s-d)*(o-p)}function CSe(n,e){return n.next.i!==e.i&&n.prev.i!==e.i&&!PSe(n,e)&&(gw(n,e)&&gw(e,n)&&ISe(n,e)&&(Rr(n.prev,n,e.prev)||Rr(n,e.prev,e))||nC(n,e)&&Rr(n.prev,n,n.next)>0&&Rr(e.prev,e,e.next)>0)}function Rr(n,e,i){return(e.y-n.y)*(i.x-e.x)-(e.x-n.x)*(i.y-e.y)}function nC(n,e){return n.x===e.x&&n.y===e.y}function MZ(n,e,i,o){const s=oA(Rr(n,e,i)),l=oA(Rr(n,e,o)),d=oA(Rr(i,o,n)),p=oA(Rr(i,o,e));return!!(s!==l&&d!==p||s===0&&rA(n,i,e)||l===0&&rA(n,o,e)||d===0&&rA(i,n,o)||p===0&&rA(i,e,o))}function rA(n,e,i){return e.x<=Math.max(n.x,i.x)&&e.x>=Math.min(n.x,i.x)&&e.y<=Math.max(n.y,i.y)&&e.y>=Math.min(n.y,i.y)}function oA(n){return n>0?1:n<0?-1:0}function PSe(n,e){let i=n;do{if(i.i!==n.i&&i.next.i!==n.i&&i.i!==e.i&&i.next.i!==e.i&&MZ(i,i.next,n,e))return!0;i=i.next}while(i!==n);return!1}function gw(n,e){return Rr(n.prev,n,n.next)<0?Rr(n,e,n.next)>=0&&Rr(n,n.prev,e)>=0:Rr(n,e,n.prev)<0||Rr(n,n.next,e)<0}function ISe(n,e){let i=n,o=!1;const s=(n.x+e.x)/2,l=(n.y+e.y)/2;do i.y>l!=i.next.y>l&&i.next.y!==i.y&&s<(i.next.x-i.x)*(l-i.y)/(i.next.y-i.y)+i.x&&(o=!o),i=i.next;while(i!==n);return o}function TZ(n,e){const i=new OR(n.i,n.x,n.y),o=new OR(e.i,e.x,e.y),s=n.next,l=e.prev;return n.next=e,e.prev=n,i.next=s,s.prev=i,o.next=i,i.prev=o,l.next=o,o.prev=l,o}function bV(n,e,i,o){const s=new OR(n,e,i);return o?(s.next=o.next,s.prev=o,o.next.prev=s,o.next=s):(s.prev=s,s.next=s),s}function yw(n){n.next.prev=n.prev,n.prev.next=n.next,n.prevZ&&(n.prevZ.nextZ=n.nextZ),n.nextZ&&(n.nextZ.prevZ=n.prevZ)}function OR(n,e,i){this.i=n,this.x=e,this.y=i,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function LSe(n,e,i,o){let s=0;for(let l=e,d=i-o;l<i;l+=o)s+=(n[d]-n[l])*(n[l+1]+n[d+1]),d=l;return s}class vd{static area(e){const i=e.length;let o=0;for(let s=i-1,l=0;l<i;s=l++)o+=e[s].x*e[l].y-e[l].x*e[s].y;return o*.5}static isClockWise(e){return vd.area(e)<0}static triangulateShape(e,i){const o=[],s=[],l=[];xV(e),wV(o,e);let d=e.length;i.forEach(xV);for(let f=0;f<i.length;f++)s.push(d),d+=i[f].length,wV(o,i[f]);const p=mSe.triangulate(o,s);for(let f=0;f<p.length;f+=3)l.push(p.slice(f,f+3));return l}}function xV(n){const e=n.length;e>2&&n[e-1].equals(n[0])&&n.pop()}function wV(n,e){for(let i=0;i<e.length;i++)n.push(e[i].x),n.push(e[i].y)}class iC extends ki{constructor(e=new Mg([new tn(.5,.5),new tn(-.5,.5),new tn(-.5,-.5),new tn(.5,-.5)]),i={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:i},e=Array.isArray(e)?e:[e];const o=this,s=[],l=[];for(let p=0,f=e.length;p<f;p++){const y=e[p];d(y)}this.setAttribute("position",new Gn(s,3)),this.setAttribute("uv",new Gn(l,2)),this.computeVertexNormals();function d(p){const f=[],y=i.curveSegments!==void 0?i.curveSegments:12,_=i.steps!==void 0?i.steps:1,x=i.depth!==void 0?i.depth:1;let S=i.bevelEnabled!==void 0?i.bevelEnabled:!0,T=i.bevelThickness!==void 0?i.bevelThickness:.2,I=i.bevelSize!==void 0?i.bevelSize:T-.1,R=i.bevelOffset!==void 0?i.bevelOffset:0,D=i.bevelSegments!==void 0?i.bevelSegments:3;const L=i.extrudePath,O=i.UVGenerator!==void 0?i.UVGenerator:RSe;let N,F=!1,G,j,Y,te;L&&(N=L.getSpacedPoints(_),F=!0,S=!1,G=L.computeFrenetFrames(_,!1),j=new Ue,Y=new Ue,te=new Ue),S||(D=0,T=0,I=0,R=0);const V=p.extractPoints(y);let Q=V.shape;const he=V.holes;if(!vd.isClockWise(Q)){Q=Q.reverse();for(let Pe=0,ft=he.length;Pe<ft;Pe++){const gt=he[Pe];vd.isClockWise(gt)&&(he[Pe]=gt.reverse())}}const ye=vd.triangulateShape(Q,he),pe=Q;for(let Pe=0,ft=he.length;Pe<ft;Pe++){const gt=he[Pe];Q=Q.concat(gt)}function Me(Pe,ft,gt){return ft||console.error("THREE.ExtrudeGeometry: vec does not exist"),Pe.clone().addScaledVector(ft,gt)}const Ie=Q.length,ze=ye.length;function le(Pe,ft,gt){let _t,Be,ue;const se=Pe.x-ft.x,_e=Pe.y-ft.y,je=gt.x-Pe.x,De=gt.y-Pe.y,st=se*se+_e*_e,de=se*De-_e*je;if(Math.abs(de)>Number.EPSILON){const ne=Math.sqrt(st),Oe=Math.sqrt(je*je+De*De),ut=ft.x-_e/ne,it=ft.y+se/ne,lt=gt.x-De/Oe,Et=gt.y+je/Oe,Ut=((lt-ut)*De-(Et-it)*je)/(se*De-_e*je);_t=ut+se*Ut-Pe.x,Be=it+_e*Ut-Pe.y;const Wt=_t*_t+Be*Be;if(Wt<=2)return new tn(_t,Be);ue=Math.sqrt(Wt/2)}else{let ne=!1;se>Number.EPSILON?je>Number.EPSILON&&(ne=!0):se<-Number.EPSILON?je<-Number.EPSILON&&(ne=!0):Math.sign(_e)===Math.sign(De)&&(ne=!0),ne?(_t=-_e,Be=se,ue=Math.sqrt(st)):(_t=se,Be=_e,ue=Math.sqrt(st/2))}return new tn(_t/ue,Be/ue)}const me=[];for(let Pe=0,ft=pe.length,gt=ft-1,_t=Pe+1;Pe<ft;Pe++,gt++,_t++)gt===ft&&(gt=0),_t===ft&&(_t=0),me[Pe]=le(pe[Pe],pe[gt],pe[_t]);const xe=[];let ae,Ee=me.concat();for(let Pe=0,ft=he.length;Pe<ft;Pe++){const gt=he[Pe];ae=[];for(let _t=0,Be=gt.length,ue=Be-1,se=_t+1;_t<Be;_t++,ue++,se++)ue===Be&&(ue=0),se===Be&&(se=0),ae[_t]=le(gt[_t],gt[ue],gt[se]);xe.push(ae),Ee=Ee.concat(ae)}for(let Pe=0;Pe<D;Pe++){const ft=Pe/D,gt=T*Math.cos(ft*Math.PI/2),_t=I*Math.sin(ft*Math.PI/2)+R;for(let Be=0,ue=pe.length;Be<ue;Be++){const se=Me(pe[Be],me[Be],_t);ct(se.x,se.y,-gt)}for(let Be=0,ue=he.length;Be<ue;Be++){const se=he[Be];ae=xe[Be];for(let _e=0,je=se.length;_e<je;_e++){const De=Me(se[_e],ae[_e],_t);ct(De.x,De.y,-gt)}}}const Je=I+R;for(let Pe=0;Pe<Ie;Pe++){const ft=S?Me(Q[Pe],Ee[Pe],Je):Q[Pe];F?(Y.copy(G.normals[0]).multiplyScalar(ft.x),j.copy(G.binormals[0]).multiplyScalar(ft.y),te.copy(N[0]).add(Y).add(j),ct(te.x,te.y,te.z)):ct(ft.x,ft.y,0)}for(let Pe=1;Pe<=_;Pe++)for(let ft=0;ft<Ie;ft++){const gt=S?Me(Q[ft],Ee[ft],Je):Q[ft];F?(Y.copy(G.normals[Pe]).multiplyScalar(gt.x),j.copy(G.binormals[Pe]).multiplyScalar(gt.y),te.copy(N[Pe]).add(Y).add(j),ct(te.x,te.y,te.z)):ct(gt.x,gt.y,x/_*Pe)}for(let Pe=D-1;Pe>=0;Pe--){const ft=Pe/D,gt=T*Math.cos(ft*Math.PI/2),_t=I*Math.sin(ft*Math.PI/2)+R;for(let Be=0,ue=pe.length;Be<ue;Be++){const se=Me(pe[Be],me[Be],_t);ct(se.x,se.y,x+gt)}for(let Be=0,ue=he.length;Be<ue;Be++){const se=he[Be];ae=xe[Be];for(let _e=0,je=se.length;_e<je;_e++){const De=Me(se[_e],ae[_e],_t);F?ct(De.x,De.y+N[_-1].y,N[_-1].x+gt):ct(De.x,De.y,x+gt)}}}Ze(),Ke();function Ze(){const Pe=s.length/3;if(S){let ft=0,gt=Ie*ft;for(let _t=0;_t<ze;_t++){const Be=ye[_t];Ct(Be[2]+gt,Be[1]+gt,Be[0]+gt)}ft=_+D*2,gt=Ie*ft;for(let _t=0;_t<ze;_t++){const Be=ye[_t];Ct(Be[0]+gt,Be[1]+gt,Be[2]+gt)}}else{for(let ft=0;ft<ze;ft++){const gt=ye[ft];Ct(gt[2],gt[1],gt[0])}for(let ft=0;ft<ze;ft++){const gt=ye[ft];Ct(gt[0]+Ie*_,gt[1]+Ie*_,gt[2]+Ie*_)}}o.addGroup(Pe,s.length/3-Pe,0)}function Ke(){const Pe=s.length/3;let ft=0;Fe(pe,ft),ft+=pe.length;for(let gt=0,_t=he.length;gt<_t;gt++){const Be=he[gt];Fe(Be,ft),ft+=Be.length}o.addGroup(Pe,s.length/3-Pe,1)}function Fe(Pe,ft){let gt=Pe.length;for(;--gt>=0;){const _t=gt;let Be=gt-1;Be<0&&(Be=Pe.length-1);for(let ue=0,se=_+D*2;ue<se;ue++){const _e=Ie*ue,je=Ie*(ue+1),De=ft+_t+_e,st=ft+Be+_e,de=ft+Be+je,ne=ft+_t+je;kt(De,st,de,ne)}}}function ct(Pe,ft,gt){f.push(Pe),f.push(ft),f.push(gt)}function Ct(Pe,ft,gt){Kt(Pe),Kt(ft),Kt(gt);const _t=s.length/3,Be=O.generateTopUV(o,s,_t-3,_t-2,_t-1);At(Be[0]),At(Be[1]),At(Be[2])}function kt(Pe,ft,gt,_t){Kt(Pe),Kt(ft),Kt(_t),Kt(ft),Kt(gt),Kt(_t);const Be=s.length/3,ue=O.generateSideWallUV(o,s,Be-6,Be-3,Be-2,Be-1);At(ue[0]),At(ue[1]),At(ue[3]),At(ue[1]),At(ue[2]),At(ue[3])}function Kt(Pe){s.push(f[Pe*3+0]),s.push(f[Pe*3+1]),s.push(f[Pe*3+2])}function At(Pe){l.push(Pe.x),l.push(Pe.y)}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),i=this.parameters.shapes,o=this.parameters.options;return kSe(i,o,e)}static fromJSON(e,i){const o=[];for(let l=0,d=e.shapes.length;l<d;l++){const p=i[e.shapes[l]];o.push(p)}const s=e.options.extrudePath;return s!==void 0&&(e.options.extrudePath=new dM[s.type]().fromJSON(s)),new iC(o,e.options)}}const RSe={generateTopUV:function(n,e,i,o,s){const l=e[i*3],d=e[i*3+1],p=e[o*3],f=e[o*3+1],y=e[s*3],_=e[s*3+1];return[new tn(l,d),new tn(p,f),new tn(y,_)]},generateSideWallUV:function(n,e,i,o,s,l){const d=e[i*3],p=e[i*3+1],f=e[i*3+2],y=e[o*3],_=e[o*3+1],x=e[o*3+2],S=e[s*3],T=e[s*3+1],I=e[s*3+2],R=e[l*3],D=e[l*3+1],L=e[l*3+2];return Math.abs(p-_)<Math.abs(d-y)?[new tn(d,1-f),new tn(y,1-x),new tn(S,1-I),new tn(R,1-L)]:[new tn(p,1-f),new tn(_,1-x),new tn(T,1-I),new tn(D,1-L)]}};function kSe(n,e,i){if(i.shapes=[],Array.isArray(n))for(let o=0,s=n.length;o<s;o++){const l=n[o];i.shapes.push(l.uuid)}else i.shapes.push(n.uuid);return i.options=Object.assign({},e),e.extrudePath!==void 0&&(i.options.extrudePath=e.extrudePath.toJSON()),i}class aC extends kf{constructor(e=1,i=0){const o=(1+Math.sqrt(5))/2,s=[-1,o,0,1,o,0,-1,-o,0,1,-o,0,0,-1,o,0,1,o,0,-1,-o,0,1,-o,o,0,-1,o,0,1,-o,0,-1,-o,0,1],l=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(s,l,e,i),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:i}}static fromJSON(e){return new aC(e.radius,e.detail)}}class Jw extends kf{constructor(e=1,i=0){const o=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],s=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];super(o,s,e,i),this.type="OctahedronGeometry",this.parameters={radius:e,detail:i}}static fromJSON(e){return new Jw(e.radius,e.detail)}}class rC extends ki{constructor(e=.5,i=1,o=32,s=1,l=0,d=Math.PI*2){super(),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:i,thetaSegments:o,phiSegments:s,thetaStart:l,thetaLength:d},o=Math.max(3,o),s=Math.max(1,s);const p=[],f=[],y=[],_=[];let x=e;const S=(i-e)/s,T=new Ue,I=new tn;for(let R=0;R<=s;R++){for(let D=0;D<=o;D++){const L=l+D/o*d;T.x=x*Math.cos(L),T.y=x*Math.sin(L),f.push(T.x,T.y,T.z),y.push(0,0,1),I.x=(T.x/i+1)/2,I.y=(T.y/i+1)/2,_.push(I.x,I.y)}x+=S}for(let R=0;R<s;R++){const D=R*(o+1);for(let L=0;L<o;L++){const O=L+D,N=O,F=O+o+1,G=O+o+2,j=O+1;p.push(N,F,j),p.push(F,G,j)}}this.setIndex(p),this.setAttribute("position",new Gn(f,3)),this.setAttribute("normal",new Gn(y,3)),this.setAttribute("uv",new Gn(_,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new rC(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}}class oC extends ki{constructor(e=new Mg([new tn(0,.5),new tn(-.5,-.5),new tn(.5,-.5)]),i=12){super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:i};const o=[],s=[],l=[],d=[];let p=0,f=0;if(Array.isArray(e)===!1)y(e);else for(let _=0;_<e.length;_++)y(e[_]),this.addGroup(p,f,_),p+=f,f=0;this.setIndex(o),this.setAttribute("position",new Gn(s,3)),this.setAttribute("normal",new Gn(l,3)),this.setAttribute("uv",new Gn(d,2));function y(_){const x=s.length/3,S=_.extractPoints(i);let T=S.shape;const I=S.holes;vd.isClockWise(T)===!1&&(T=T.reverse());for(let D=0,L=I.length;D<L;D++){const O=I[D];vd.isClockWise(O)===!0&&(I[D]=O.reverse())}const R=vd.triangulateShape(T,I);for(let D=0,L=I.length;D<L;D++){const O=I[D];T=T.concat(O)}for(let D=0,L=T.length;D<L;D++){const O=T[D];s.push(O.x,O.y,0),l.push(0,0,1),d.push(O.x,O.y)}for(let D=0,L=R.length;D<L;D++){const O=R[D],N=O[0]+x,F=O[1]+x,G=O[2]+x;o.push(N,F,G),f+=3}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),i=this.parameters.shapes;return DSe(i,e)}static fromJSON(e,i){const o=[];for(let s=0,l=e.shapes.length;s<l;s++){const d=i[e.shapes[s]];o.push(d)}return new oC(o,e.curveSegments)}}function DSe(n,e){if(e.shapes=[],Array.isArray(n))for(let i=0,o=n.length;i<o;i++){const s=n[i];e.shapes.push(s.uuid)}else e.shapes.push(n.uuid);return e}class Qw extends ki{constructor(e=1,i=32,o=16,s=0,l=Math.PI*2,d=0,p=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:i,heightSegments:o,phiStart:s,phiLength:l,thetaStart:d,thetaLength:p},i=Math.max(3,Math.floor(i)),o=Math.max(2,Math.floor(o));const f=Math.min(d+p,Math.PI);let y=0;const _=[],x=new Ue,S=new Ue,T=[],I=[],R=[],D=[];for(let L=0;L<=o;L++){const O=[],N=L/o;let F=0;L===0&&d===0?F=.5/i:L===o&&f===Math.PI&&(F=-.5/i);for(let G=0;G<=i;G++){const j=G/i;x.x=-e*Math.cos(s+j*l)*Math.sin(d+N*p),x.y=e*Math.cos(d+N*p),x.z=e*Math.sin(s+j*l)*Math.sin(d+N*p),I.push(x.x,x.y,x.z),S.copy(x).normalize(),R.push(S.x,S.y,S.z),D.push(j+F,1-N),O.push(y++)}_.push(O)}for(let L=0;L<o;L++)for(let O=0;O<i;O++){const N=_[L][O+1],F=_[L][O],G=_[L+1][O],j=_[L+1][O+1];(L!==0||d>0)&&T.push(N,F,j),(L!==o-1||f<Math.PI)&&T.push(F,G,j)}this.setIndex(T),this.setAttribute("position",new Gn(I,3)),this.setAttribute("normal",new Gn(R,3)),this.setAttribute("uv",new Gn(D,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Qw(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class sC extends kf{constructor(e=1,i=0){const o=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],s=[2,1,0,0,3,2,1,3,0,2,3,1];super(o,s,e,i),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:i}}static fromJSON(e){return new sC(e.radius,e.detail)}}class lC extends ki{constructor(e=1,i=.4,o=12,s=48,l=Math.PI*2){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:i,radialSegments:o,tubularSegments:s,arc:l},o=Math.floor(o),s=Math.floor(s);const d=[],p=[],f=[],y=[],_=new Ue,x=new Ue,S=new Ue;for(let T=0;T<=o;T++)for(let I=0;I<=s;I++){const R=I/s*l,D=T/o*Math.PI*2;x.x=(e+i*Math.cos(D))*Math.cos(R),x.y=(e+i*Math.cos(D))*Math.sin(R),x.z=i*Math.sin(D),p.push(x.x,x.y,x.z),_.x=e*Math.cos(R),_.y=e*Math.sin(R),S.subVectors(x,_).normalize(),f.push(S.x,S.y,S.z),y.push(I/s),y.push(T/o)}for(let T=1;T<=o;T++)for(let I=1;I<=s;I++){const R=(s+1)*T+I-1,D=(s+1)*(T-1)+I-1,L=(s+1)*(T-1)+I,O=(s+1)*T+I;d.push(R,D,O),d.push(D,L,O)}this.setIndex(d),this.setAttribute("position",new Gn(p,3)),this.setAttribute("normal",new Gn(f,3)),this.setAttribute("uv",new Gn(y,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new lC(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class cC extends ki{constructor(e=1,i=.4,o=64,s=8,l=2,d=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:i,tubularSegments:o,radialSegments:s,p:l,q:d},o=Math.floor(o),s=Math.floor(s);const p=[],f=[],y=[],_=[],x=new Ue,S=new Ue,T=new Ue,I=new Ue,R=new Ue,D=new Ue,L=new Ue;for(let N=0;N<=o;++N){const F=N/o*l*Math.PI*2;O(F,l,d,e,T),O(F+.01,l,d,e,I),D.subVectors(I,T),L.addVectors(I,T),R.crossVectors(D,L),L.crossVectors(R,D),R.normalize(),L.normalize();for(let G=0;G<=s;++G){const j=G/s*Math.PI*2,Y=-i*Math.cos(j),te=i*Math.sin(j);x.x=T.x+(Y*L.x+te*R.x),x.y=T.y+(Y*L.y+te*R.y),x.z=T.z+(Y*L.z+te*R.z),f.push(x.x,x.y,x.z),S.subVectors(x,T).normalize(),y.push(S.x,S.y,S.z),_.push(N/o),_.push(G/s)}}for(let N=1;N<=o;N++)for(let F=1;F<=s;F++){const G=(s+1)*(N-1)+(F-1),j=(s+1)*N+(F-1),Y=(s+1)*N+F,te=(s+1)*(N-1)+F;p.push(G,j,te),p.push(j,Y,te)}this.setIndex(p),this.setAttribute("position",new Gn(f,3)),this.setAttribute("normal",new Gn(y,3)),this.setAttribute("uv",new Gn(_,2));function O(N,F,G,j,Y){const te=Math.cos(N),V=Math.sin(N),Q=G/F*N,he=Math.cos(Q);Y.x=j*(2+he)*.5*te,Y.y=j*(2+he)*V*.5,Y.z=j*Math.sin(Q)*.5}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new cC(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}}class uC extends ki{constructor(e=new E6(new Ue(-1,-1,0),new Ue(-1,1,0),new Ue(1,1,0)),i=64,o=1,s=8,l=!1){super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:i,radius:o,radialSegments:s,closed:l};const d=e.computeFrenetFrames(i,l);this.tangents=d.tangents,this.normals=d.normals,this.binormals=d.binormals;const p=new Ue,f=new Ue,y=new tn;let _=new Ue;const x=[],S=[],T=[],I=[];R(),this.setIndex(I),this.setAttribute("position",new Gn(x,3)),this.setAttribute("normal",new Gn(S,3)),this.setAttribute("uv",new Gn(T,2));function R(){for(let N=0;N<i;N++)D(N);D(l===!1?i:0),O(),L()}function D(N){_=e.getPointAt(N/i,_);const F=d.normals[N],G=d.binormals[N];for(let j=0;j<=s;j++){const Y=j/s*Math.PI*2,te=Math.sin(Y),V=-Math.cos(Y);f.x=V*F.x+te*G.x,f.y=V*F.y+te*G.y,f.z=V*F.z+te*G.z,f.normalize(),S.push(f.x,f.y,f.z),p.x=_.x+o*f.x,p.y=_.y+o*f.y,p.z=_.z+o*f.z,x.push(p.x,p.y,p.z)}}function L(){for(let N=1;N<=i;N++)for(let F=1;F<=s;F++){const G=(s+1)*(N-1)+(F-1),j=(s+1)*N+(F-1),Y=(s+1)*N+F,te=(s+1)*(N-1)+F;I.push(G,j,te),I.push(j,Y,te)}}function O(){for(let N=0;N<=i;N++)for(let F=0;F<=s;F++)y.x=N/i,y.y=F/s,T.push(y.x,y.y)}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new uC(new dM[e.path.type]().fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}class CZ extends ki{constructor(e=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:e},e!==null){const i=[],o=new Set,s=new Ue,l=new Ue;if(e.index!==null){const d=e.attributes.position,p=e.index;let f=e.groups;f.length===0&&(f=[{start:0,count:p.count,materialIndex:0}]);for(let y=0,_=f.length;y<_;++y){const x=f[y],S=x.start,T=x.count;for(let I=S,R=S+T;I<R;I+=3)for(let D=0;D<3;D++){const L=p.getX(I+D),O=p.getX(I+(D+1)%3);s.fromBufferAttribute(d,L),l.fromBufferAttribute(d,O),SV(s,l,o)===!0&&(i.push(s.x,s.y,s.z),i.push(l.x,l.y,l.z))}}}else{const d=e.attributes.position;for(let p=0,f=d.count/3;p<f;p++)for(let y=0;y<3;y++){const _=3*p+y,x=3*p+(y+1)%3;s.fromBufferAttribute(d,_),l.fromBufferAttribute(d,x),SV(s,l,o)===!0&&(i.push(s.x,s.y,s.z),i.push(l.x,l.y,l.z))}}this.setAttribute("position",new Gn(i,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}function SV(n,e,i){const o=`${n.x},${n.y},${n.z}-${e.x},${e.y},${e.z}`,s=`${e.x},${e.y},${e.z}-${n.x},${n.y},${n.z}`;return i.has(o)===!0||i.has(s)===!0?!1:(i.add(o),i.add(s),!0)}var AV=Object.freeze({__proto__:null,BoxGeometry:Jg,CapsuleGeometry:JT,CircleGeometry:QT,ConeGeometry:eC,CylinderGeometry:E_,DodecahedronGeometry:tC,EdgesGeometry:AZ,ExtrudeGeometry:iC,IcosahedronGeometry:aC,LatheGeometry:Kw,OctahedronGeometry:Jw,PlaneGeometry:Rf,PolyhedronGeometry:kf,RingGeometry:rC,ShapeGeometry:oC,SphereGeometry:Qw,TetrahedronGeometry:sC,TorusGeometry:lC,TorusKnotGeometry:cC,TubeGeometry:uC,WireframeGeometry:CZ});class PZ extends es{constructor(e){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new Pn(0),this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.fog=e.fog,this}}class IZ extends Ad{constructor(e){super(e),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class T6 extends es{constructor(e){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new Pn(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Pn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Lf,this.normalScale=new tn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class LZ extends T6{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new tn(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return Yr(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(i){this.ior=(1+.4*i)/(1-.4*i)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new Pn(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new Pn(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new Pn(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class RZ extends es{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new Pn(16777215),this.specular=new Pn(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Pn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Lf,this.normalScale=new tn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=$w,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class kZ extends es{constructor(e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new Pn(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Pn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Lf,this.normalScale=new tn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}class DZ extends es{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Lf,this.normalScale=new tn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}class OZ extends es{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new Pn(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Pn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Lf,this.normalScale=new tn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=$w,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class NZ extends es{constructor(e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new Pn(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Lf,this.normalScale=new tn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this.fog=e.fog,this}}class zZ extends qs{constructor(e){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}function gg(n,e,i){return!n||!i&&n.constructor===e?n:typeof e.BYTES_PER_ELEMENT=="number"?new e(n):Array.prototype.slice.call(n)}function FZ(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)}function BZ(n){function e(s,l){return n[s]-n[l]}const i=n.length,o=new Array(i);for(let s=0;s!==i;++s)o[s]=s;return o.sort(e),o}function NR(n,e,i){const o=n.length,s=new n.constructor(o);for(let l=0,d=0;d!==o;++l){const p=i[l]*e;for(let f=0;f!==e;++f)s[d++]=n[p+f]}return s}function C6(n,e,i,o){let s=1,l=n[0];for(;l!==void 0&&l[o]===void 0;)l=n[s++];if(l===void 0)return;let d=l[o];if(d!==void 0)if(Array.isArray(d))do d=l[o],d!==void 0&&(e.push(l.time),i.push.apply(i,d)),l=n[s++];while(l!==void 0);else if(d.toArray!==void 0)do d=l[o],d!==void 0&&(e.push(l.time),d.toArray(i,i.length)),l=n[s++];while(l!==void 0);else do d=l[o],d!==void 0&&(e.push(l.time),i.push(d)),l=n[s++];while(l!==void 0)}function OSe(n,e,i,o,s=30){const l=n.clone();l.name=e;const d=[];for(let f=0;f<l.tracks.length;++f){const y=l.tracks[f],_=y.getValueSize(),x=[],S=[];for(let T=0;T<y.times.length;++T){const I=y.times[T]*s;if(!(I<i||I>=o)){x.push(y.times[T]);for(let R=0;R<_;++R)S.push(y.values[T*_+R])}}x.length!==0&&(y.times=gg(x,y.times.constructor),y.values=gg(S,y.values.constructor),d.push(y))}l.tracks=d;let p=1/0;for(let f=0;f<l.tracks.length;++f)p>l.tracks[f].times[0]&&(p=l.tracks[f].times[0]);for(let f=0;f<l.tracks.length;++f)l.tracks[f].shift(-1*p);return l.resetDuration(),l}function NSe(n,e=0,i=n,o=30){o<=0&&(o=30);const s=i.tracks.length,l=e/o;for(let d=0;d<s;++d){const p=i.tracks[d],f=p.ValueTypeName;if(f==="bool"||f==="string")continue;const y=n.tracks.find(function(L){return L.name===p.name&&L.ValueTypeName===f});if(y===void 0)continue;let _=0;const x=p.getValueSize();p.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(_=x/3);let S=0;const T=y.getValueSize();y.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(S=T/3);const I=p.times.length-1;let R;if(l<=p.times[0]){const L=_,O=x-_;R=p.values.slice(L,O)}else if(l>=p.times[I]){const L=I*x+_,O=L+x-_;R=p.values.slice(L,O)}else{const L=p.createInterpolant(),O=_,N=x-_;L.evaluate(l),R=L.resultBuffer.slice(O,N)}f==="quaternion"&&new As().fromArray(R).normalize().conjugate().toArray(R);const D=y.times.length;for(let L=0;L<D;++L){const O=L*T+S;if(f==="quaternion")As.multiplyQuaternionsFlat(y.values,O,R,0,y.values,O);else{const N=T-S*2;for(let F=0;F<N;++F)y.values[O+F]-=R[F]}}}return n.blendMode=s6,n}const zSe={convertArray:gg,isTypedArray:FZ,getKeyframeOrder:BZ,sortedArray:NR,flattenJSON:C6,subclip:OSe,makeClipAdditive:NSe};class e2{constructor(e,i,o,s){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=s!==void 0?s:new i.constructor(o),this.sampleValues=i,this.valueSize=o,this.settings=null,this.DefaultSettings_={}}evaluate(e){const i=this.parameterPositions;let o=this._cachedIndex,s=i[o],l=i[o-1];e:{t:{let d;n:{i:if(!(e<s)){for(let p=o+2;;){if(s===void 0){if(e<l)break i;return o=i.length,this._cachedIndex=o,this.copySampleValue_(o-1)}if(o===p)break;if(l=s,s=i[++o],e<s)break t}d=i.length;break n}if(!(e>=l)){const p=i[1];e<p&&(o=2,l=p);for(let f=o-2;;){if(l===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(o===f)break;if(s=l,l=i[--o-1],e>=l)break t}d=o,o=0;break n}break e}for(;o<d;){const p=o+d>>>1;e<i[p]?d=p:o=p+1}if(s=i[o],l=i[o-1],l===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(s===void 0)return o=i.length,this._cachedIndex=o,this.copySampleValue_(o-1)}this._cachedIndex=o,this.intervalChanged_(o,l,s)}return this.interpolate_(o,l,e,s)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const i=this.resultBuffer,o=this.sampleValues,s=this.valueSize,l=e*s;for(let d=0;d!==s;++d)i[d]=o[l+d];return i}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class UZ extends e2{constructor(e,i,o,s){super(e,i,o,s),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:pg,endingEnd:pg}}intervalChanged_(e,i,o){const s=this.parameterPositions;let l=e-2,d=e+1,p=s[l],f=s[d];if(p===void 0)switch(this.getSettings_().endingStart){case fg:l=e,p=2*i-o;break;case sw:l=s.length-2,p=i+s[l]-s[l+1];break;default:l=e,p=o}if(f===void 0)switch(this.getSettings_().endingEnd){case fg:d=e,f=2*o-i;break;case sw:d=1,f=o+s[1]-s[0];break;default:d=e-1,f=i}const y=(o-i)*.5,_=this.valueSize;this._weightPrev=y/(i-p),this._weightNext=y/(f-o),this._offsetPrev=l*_,this._offsetNext=d*_}interpolate_(e,i,o,s){const l=this.resultBuffer,d=this.sampleValues,p=this.valueSize,f=e*p,y=f-p,_=this._offsetPrev,x=this._offsetNext,S=this._weightPrev,T=this._weightNext,I=(o-i)/(s-i),R=I*I,D=R*I,L=-S*D+2*S*R-S*I,O=(1+S)*D+(-1.5-2*S)*R+(-.5+S)*I+1,N=(-1-T)*D+(1.5+T)*R+.5*I,F=T*D-T*R;for(let G=0;G!==p;++G)l[G]=L*d[_+G]+O*d[y+G]+N*d[f+G]+F*d[x+G];return l}}class P6 extends e2{constructor(e,i,o,s){super(e,i,o,s)}interpolate_(e,i,o,s){const l=this.resultBuffer,d=this.sampleValues,p=this.valueSize,f=e*p,y=f-p,_=(o-i)/(s-i),x=1-_;for(let S=0;S!==p;++S)l[S]=d[y+S]*x+d[f+S]*_;return l}}class WZ extends e2{constructor(e,i,o,s){super(e,i,o,s)}interpolate_(e){return this.copySampleValue_(e-1)}}class xu{constructor(e,i,o,s){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(i===void 0||i.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=gg(i,this.TimeBufferType),this.values=gg(o,this.ValueBufferType),this.setInterpolation(s||this.DefaultInterpolation)}static toJSON(e){const i=e.constructor;let o;if(i.toJSON!==this.toJSON)o=i.toJSON(e);else{o={name:e.name,times:gg(e.times,Array),values:gg(e.values,Array)};const s=e.getInterpolation();s!==e.DefaultInterpolation&&(o.interpolation=s)}return o.type=e.ValueTypeName,o}InterpolantFactoryMethodDiscrete(e){return new WZ(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new P6(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new UZ(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let i;switch(e){case rw:i=this.InterpolantFactoryMethodDiscrete;break;case ow:i=this.InterpolantFactoryMethodLinear;break;case dE:i=this.InterpolantFactoryMethodSmooth;break}if(i===void 0){const o="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(o);return console.warn("THREE.KeyframeTrack:",o),this}return this.createInterpolant=i,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return rw;case this.InterpolantFactoryMethodLinear:return ow;case this.InterpolantFactoryMethodSmooth:return dE}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){const i=this.times;for(let o=0,s=i.length;o!==s;++o)i[o]+=e}return this}scale(e){if(e!==1){const i=this.times;for(let o=0,s=i.length;o!==s;++o)i[o]*=e}return this}trim(e,i){const o=this.times,s=o.length;let l=0,d=s-1;for(;l!==s&&o[l]<e;)++l;for(;d!==-1&&o[d]>i;)--d;if(++d,l!==0||d!==s){l>=d&&(d=Math.max(d,1),l=d-1);const p=this.getValueSize();this.times=o.slice(l,d),this.values=this.values.slice(l*p,d*p)}return this}validate(){let e=!0;const i=this.getValueSize();i-Math.floor(i)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const o=this.times,s=this.values,l=o.length;l===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let d=null;for(let p=0;p!==l;p++){const f=o[p];if(typeof f=="number"&&isNaN(f)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,p,f),e=!1;break}if(d!==null&&d>f){console.error("THREE.KeyframeTrack: Out of order keys.",this,p,f,d),e=!1;break}d=f}if(s!==void 0&&FZ(s))for(let p=0,f=s.length;p!==f;++p){const y=s[p];if(isNaN(y)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,p,y),e=!1;break}}return e}optimize(){const e=this.times.slice(),i=this.values.slice(),o=this.getValueSize(),s=this.getInterpolation()===dE,l=e.length-1;let d=1;for(let p=1;p<l;++p){let f=!1;const y=e[p],_=e[p+1];if(y!==_&&(p!==1||y!==e[0]))if(s)f=!0;else{const x=p*o,S=x-o,T=x+o;for(let I=0;I!==o;++I){const R=i[x+I];if(R!==i[S+I]||R!==i[T+I]){f=!0;break}}}if(f){if(p!==d){e[d]=e[p];const x=p*o,S=d*o;for(let T=0;T!==o;++T)i[S+T]=i[x+T]}++d}}if(l>0){e[d]=e[l];for(let p=l*o,f=d*o,y=0;y!==o;++y)i[f+y]=i[p+y];++d}return d!==e.length?(this.times=e.slice(0,d),this.values=i.slice(0,d*o)):(this.times=e,this.values=i),this}clone(){const e=this.times.slice(),i=this.values.slice(),o=this.constructor,s=new o(this.name,e,i);return s.createInterpolant=this.createInterpolant,s}}xu.prototype.TimeBufferType=Float32Array;xu.prototype.ValueBufferType=Float32Array;xu.prototype.DefaultInterpolation=ow;class Qg extends xu{}Qg.prototype.ValueTypeName="bool";Qg.prototype.ValueBufferType=Array;Qg.prototype.DefaultInterpolation=rw;Qg.prototype.InterpolantFactoryMethodLinear=void 0;Qg.prototype.InterpolantFactoryMethodSmooth=void 0;class I6 extends xu{}I6.prototype.ValueTypeName="color";class vw extends xu{}vw.prototype.ValueTypeName="number";class VZ extends e2{constructor(e,i,o,s){super(e,i,o,s)}interpolate_(e,i,o,s){const l=this.resultBuffer,d=this.sampleValues,p=this.valueSize,f=(o-i)/(s-i);let y=e*p;for(let _=y+p;y!==_;y+=4)As.slerpFlat(l,0,d,y-p,d,y,f);return l}}class M_ extends xu{InterpolantFactoryMethodLinear(e){return new VZ(this.times,this.values,this.getValueSize(),e)}}M_.prototype.ValueTypeName="quaternion";M_.prototype.DefaultInterpolation=ow;M_.prototype.InterpolantFactoryMethodSmooth=void 0;class ey extends xu{}ey.prototype.ValueTypeName="string";ey.prototype.ValueBufferType=Array;ey.prototype.DefaultInterpolation=rw;ey.prototype.InterpolantFactoryMethodLinear=void 0;ey.prototype.InterpolantFactoryMethodSmooth=void 0;class _w extends xu{}_w.prototype.ValueTypeName="vector";class bw{constructor(e,i=-1,o,s=BT){this.name=e,this.tracks=o,this.duration=i,this.blendMode=s,this.uuid=Zl(),this.duration<0&&this.resetDuration()}static parse(e){const i=[],o=e.tracks,s=1/(e.fps||1);for(let d=0,p=o.length;d!==p;++d)i.push(BSe(o[d]).scale(s));const l=new this(e.name,e.duration,i,e.blendMode);return l.uuid=e.uuid,l}static toJSON(e){const i=[],o=e.tracks,s={name:e.name,duration:e.duration,tracks:i,uuid:e.uuid,blendMode:e.blendMode};for(let l=0,d=o.length;l!==d;++l)i.push(xu.toJSON(o[l]));return s}static CreateFromMorphTargetSequence(e,i,o,s){const l=i.length,d=[];for(let p=0;p<l;p++){let f=[],y=[];f.push((p+l-1)%l,p,(p+1)%l),y.push(0,1,0);const _=BZ(f);f=NR(f,1,_),y=NR(y,1,_),!s&&f[0]===0&&(f.push(l),y.push(y[0])),d.push(new vw(".morphTargetInfluences["+i[p].name+"]",f,y).scale(1/o))}return new this(e,-1,d)}static findByName(e,i){let o=e;if(!Array.isArray(e)){const s=e;o=s.geometry&&s.geometry.animations||s.animations}for(let s=0;s<o.length;s++)if(o[s].name===i)return o[s];return null}static CreateClipsFromMorphTargetSequences(e,i,o){const s={},l=/^([\w-]*?)([\d]+)$/;for(let p=0,f=e.length;p<f;p++){const y=e[p],_=y.name.match(l);if(_&&_.length>1){const x=_[1];let S=s[x];S||(s[x]=S=[]),S.push(y)}}const d=[];for(const p in s)d.push(this.CreateFromMorphTargetSequence(p,s[p],i,o));return d}static parseAnimation(e,i){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const o=function(x,S,T,I,R){if(T.length!==0){const D=[],L=[];C6(T,D,L,I),D.length!==0&&R.push(new x(S,D,L))}},s=[],l=e.name||"default",d=e.fps||30,p=e.blendMode;let f=e.length||-1;const y=e.hierarchy||[];for(let x=0;x<y.length;x++){const S=y[x].keys;if(!(!S||S.length===0))if(S[0].morphTargets){const T={};let I;for(I=0;I<S.length;I++)if(S[I].morphTargets)for(let R=0;R<S[I].morphTargets.length;R++)T[S[I].morphTargets[R]]=-1;for(const R in T){const D=[],L=[];for(let O=0;O!==S[I].morphTargets.length;++O){const N=S[I];D.push(N.time),L.push(N.morphTarget===R?1:0)}s.push(new vw(".morphTargetInfluence["+R+"]",D,L))}f=T.length*d}else{const T=".bones["+i[x].name+"]";o(_w,T+".position",S,"pos",s),o(M_,T+".quaternion",S,"rot",s),o(_w,T+".scale",S,"scl",s)}}return s.length===0?null:new this(l,f,s,p)}resetDuration(){const e=this.tracks;let i=0;for(let o=0,s=e.length;o!==s;++o){const l=this.tracks[o];i=Math.max(i,l.times[l.times.length-1])}return this.duration=i,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let i=0;i<this.tracks.length;i++)e=e&&this.tracks[i].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let i=0;i<this.tracks.length;i++)e.push(this.tracks[i].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function FSe(n){switch(n.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return vw;case"vector":case"vector2":case"vector3":case"vector4":return _w;case"color":return I6;case"quaternion":return M_;case"bool":case"boolean":return Qg;case"string":return ey}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+n)}function BSe(n){if(n.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=FSe(n.type);if(n.times===void 0){const i=[],o=[];C6(n.keys,i,o,"value"),n.times=i,n.values=o}return e.parse!==void 0?e.parse(n):new e(n.name,n.times,n.values,n.interpolation)}const Gg={enabled:!1,files:{},add:function(n,e){this.enabled!==!1&&(this.files[n]=e)},get:function(n){if(this.enabled!==!1)return this.files[n]},remove:function(n){delete this.files[n]},clear:function(){this.files={}}};class L6{constructor(e,i,o){const s=this;let l=!1,d=0,p=0,f;const y=[];this.onStart=void 0,this.onLoad=e,this.onProgress=i,this.onError=o,this.itemStart=function(_){p++,l===!1&&s.onStart!==void 0&&s.onStart(_,d,p),l=!0},this.itemEnd=function(_){d++,s.onProgress!==void 0&&s.onProgress(_,d,p),d===p&&(l=!1,s.onLoad!==void 0&&s.onLoad())},this.itemError=function(_){s.onError!==void 0&&s.onError(_)},this.resolveURL=function(_){return f?f(_):_},this.setURLModifier=function(_){return f=_,this},this.addHandler=function(_,x){return y.push(_,x),this},this.removeHandler=function(_){const x=y.indexOf(_);return x!==-1&&y.splice(x,2),this},this.getHandler=function(_){for(let x=0,S=y.length;x<S;x+=2){const T=y[x],I=y[x+1];if(T.global&&(T.lastIndex=0),T.test(_))return I}return null}}}const GZ=new L6;class Tl{constructor(e){this.manager=e!==void 0?e:GZ,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,i){const o=this;return new Promise(function(s,l){o.load(e,s,i,l)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}Tl.DEFAULT_MATERIAL_NAME="__DEFAULT";const yh={};class USe extends Error{constructor(e,i){super(e),this.response=i}}class jh extends Tl{constructor(e){super(e)}load(e,i,o,s){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const l=Gg.get(e);if(l!==void 0)return this.manager.itemStart(e),setTimeout(()=>{i&&i(l),this.manager.itemEnd(e)},0),l;if(yh[e]!==void 0){yh[e].push({onLoad:i,onProgress:o,onError:s});return}yh[e]=[],yh[e].push({onLoad:i,onProgress:o,onError:s});const d=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),p=this.mimeType,f=this.responseType;fetch(d).then(y=>{if(y.status===200||y.status===0){if(y.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||y.body===void 0||y.body.getReader===void 0)return y;const _=yh[e],x=y.body.getReader(),S=y.headers.get("Content-Length")||y.headers.get("X-File-Size"),T=S?parseInt(S):0,I=T!==0;let R=0;const D=new ReadableStream({start(L){O();function O(){x.read().then(({done:N,value:F})=>{if(N)L.close();else{R+=F.byteLength;const G=new ProgressEvent("progress",{lengthComputable:I,loaded:R,total:T});for(let j=0,Y=_.length;j<Y;j++){const te=_[j];te.onProgress&&te.onProgress(G)}L.enqueue(F),O()}})}}});return new Response(D)}else throw new USe(`fetch for "${y.url}" responded with ${y.status}: ${y.statusText}`,y)}).then(y=>{switch(f){case"arraybuffer":return y.arrayBuffer();case"blob":return y.blob();case"document":return y.text().then(_=>new DOMParser().parseFromString(_,p));case"json":return y.json();default:if(p===void 0)return y.text();{const x=/charset="?([^;"\s]*)"?/i.exec(p),S=x&&x[1]?x[1].toLowerCase():void 0,T=new TextDecoder(S);return y.arrayBuffer().then(I=>T.decode(I))}}}).then(y=>{Gg.add(e,y);const _=yh[e];delete yh[e];for(let x=0,S=_.length;x<S;x++){const T=_[x];T.onLoad&&T.onLoad(y)}}).catch(y=>{const _=yh[e];if(_===void 0)throw this.manager.itemError(e),y;delete yh[e];for(let x=0,S=_.length;x<S;x++){const T=_[x];T.onError&&T.onError(y)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class WSe extends Tl{constructor(e){super(e)}load(e,i,o,s){const l=this,d=new jh(this.manager);d.setPath(this.path),d.setRequestHeader(this.requestHeader),d.setWithCredentials(this.withCredentials),d.load(e,function(p){try{i(l.parse(JSON.parse(p)))}catch(f){s?s(f):console.error(f),l.manager.itemError(e)}},o,s)}parse(e){const i=[];for(let o=0;o<e.length;o++){const s=bw.parse(e[o]);i.push(s)}return i}}class VSe extends Tl{constructor(e){super(e)}load(e,i,o,s){const l=this,d=[],p=new ZT,f=new jh(this.manager);f.setPath(this.path),f.setResponseType("arraybuffer"),f.setRequestHeader(this.requestHeader),f.setWithCredentials(l.withCredentials);let y=0;function _(x){f.load(e[x],function(S){const T=l.parse(S,!0);d[x]={width:T.width,height:T.height,format:T.format,mipmaps:T.mipmaps},y+=1,y===6&&(T.mipmapCount===1&&(p.minFilter=Lr),p.image=d,p.format=T.format,p.needsUpdate=!0,i&&i(p))},o,s)}if(Array.isArray(e))for(let x=0,S=e.length;x<S;++x)_(x);else f.load(e,function(x){const S=l.parse(x,!0);if(S.isCubemap){const T=S.mipmaps.length/S.mipmapCount;for(let I=0;I<T;I++){d[I]={mipmaps:[]};for(let R=0;R<S.mipmapCount;R++)d[I].mipmaps.push(S.mipmaps[I*S.mipmapCount+R]),d[I].format=S.format,d[I].width=S.width,d[I].height=S.height}p.image=d}else p.image.width=S.width,p.image.height=S.height,p.mipmaps=S.mipmaps;S.mipmapCount===1&&(p.minFilter=Lr),p.format=S.format,p.needsUpdate=!0,i&&i(p)},o,s);return p}}class xw extends Tl{constructor(e){super(e)}load(e,i,o,s){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const l=this,d=Gg.get(e);if(d!==void 0)return l.manager.itemStart(e),setTimeout(function(){i&&i(d),l.manager.itemEnd(e)},0),d;const p=pw("img");function f(){_(),Gg.add(e,this),i&&i(this),l.manager.itemEnd(e)}function y(x){_(),s&&s(x),l.manager.itemError(e),l.manager.itemEnd(e)}function _(){p.removeEventListener("load",f,!1),p.removeEventListener("error",y,!1)}return p.addEventListener("load",f,!1),p.addEventListener("error",y,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(p.crossOrigin=this.crossOrigin),l.manager.itemStart(e),p.src=e,p}}class GSe extends Tl{constructor(e){super(e)}load(e,i,o,s){const l=new Zw;l.colorSpace=Io;const d=new xw(this.manager);d.setCrossOrigin(this.crossOrigin),d.setPath(this.path);let p=0;function f(y){d.load(e[y],function(_){l.images[y]=_,p++,p===6&&(l.needsUpdate=!0,i&&i(l))},void 0,s)}for(let y=0;y<e.length;++y)f(y);return l}}class HSe extends Tl{constructor(e){super(e)}load(e,i,o,s){const l=this,d=new H0,p=new jh(this.manager);return p.setResponseType("arraybuffer"),p.setRequestHeader(this.requestHeader),p.setPath(this.path),p.setWithCredentials(l.withCredentials),p.load(e,function(f){let y;try{y=l.parse(f)}catch(_){if(s!==void 0)s(_);else{console.error(_);return}}y.image!==void 0?d.image=y.image:y.data!==void 0&&(d.image.width=y.width,d.image.height=y.height,d.image.data=y.data),d.wrapS=y.wrapS!==void 0?y.wrapS:bs,d.wrapT=y.wrapT!==void 0?y.wrapT:bs,d.magFilter=y.magFilter!==void 0?y.magFilter:Lr,d.minFilter=y.minFilter!==void 0?y.minFilter:Lr,d.anisotropy=y.anisotropy!==void 0?y.anisotropy:1,y.colorSpace!==void 0?d.colorSpace=y.colorSpace:y.encoding!==void 0&&(d.encoding=y.encoding),y.flipY!==void 0&&(d.flipY=y.flipY),y.format!==void 0&&(d.format=y.format),y.type!==void 0&&(d.type=y.type),y.mipmaps!==void 0&&(d.mipmaps=y.mipmaps,d.minFilter=Sf),y.mipmapCount===1&&(d.minFilter=Lr),y.generateMipmaps!==void 0&&(d.generateMipmaps=y.generateMipmaps),d.needsUpdate=!0,i&&i(d,y)},o,s),d}}class HZ extends Tl{constructor(e){super(e)}load(e,i,o,s){const l=new Or,d=new xw(this.manager);return d.setCrossOrigin(this.crossOrigin),d.setPath(this.path),d.load(e,function(p){l.image=p,l.needsUpdate=!0,i!==void 0&&i(l)},o,s),l}}class Df extends va{constructor(e,i=1){super(),this.isLight=!0,this.type="Light",this.color=new Pn(e),this.intensity=i}dispose(){}copy(e,i){return super.copy(e,i),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const i=super.toJSON(e);return i.object.color=this.color.getHex(),i.object.intensity=this.intensity,this.groundColor!==void 0&&(i.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(i.object.distance=this.distance),this.angle!==void 0&&(i.object.angle=this.angle),this.decay!==void 0&&(i.object.decay=this.decay),this.penumbra!==void 0&&(i.object.penumbra=this.penumbra),this.shadow!==void 0&&(i.object.shadow=this.shadow.toJSON()),i}}class jZ extends Df{constructor(e,i,o){super(e,o),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(va.DEFAULT_UP),this.updateMatrix(),this.groundColor=new Pn(i)}copy(e,i){return super.copy(e,i),this.groundColor.copy(e.groundColor),this}}const tI=new Ri,EV=new Ue,MV=new Ue;class R6{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new tn(512,512),this.map=null,this.mapPass=null,this.matrix=new Ri,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new VT,this._frameExtents=new tn(1,1),this._viewportCount=1,this._viewports=[new Pa(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const i=this.camera,o=this.matrix;EV.setFromMatrixPosition(e.matrixWorld),i.position.copy(EV),MV.setFromMatrixPosition(e.target.matrixWorld),i.lookAt(MV),i.updateMatrixWorld(),tI.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),this._frustum.setFromProjectionMatrix(tI),o.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),o.multiply(tI)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class jSe extends R6{constructor(){super(new qr(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){const i=this.camera,o=d_*2*e.angle*this.focus,s=this.mapSize.width/this.mapSize.height,l=e.distance||i.far;(o!==i.fov||s!==i.aspect||l!==i.far)&&(i.fov=o,i.aspect=s,i.far=l,i.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class $Z extends Df{constructor(e,i,o=0,s=Math.PI/3,l=0,d=2){super(e,i),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(va.DEFAULT_UP),this.updateMatrix(),this.target=new va,this.distance=o,this.angle=s,this.penumbra=l,this.decay=d,this.map=null,this.shadow=new jSe}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,i){return super.copy(e,i),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}const TV=new Ri,wb=new Ue,nI=new Ue;class $Se extends R6{constructor(){super(new qr(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new tn(4,2),this._viewportCount=6,this._viewports=[new Pa(2,1,1,1),new Pa(0,1,1,1),new Pa(3,1,1,1),new Pa(1,1,1,1),new Pa(3,0,1,1),new Pa(1,0,1,1)],this._cubeDirections=[new Ue(1,0,0),new Ue(-1,0,0),new Ue(0,0,1),new Ue(0,0,-1),new Ue(0,1,0),new Ue(0,-1,0)],this._cubeUps=[new Ue(0,1,0),new Ue(0,1,0),new Ue(0,1,0),new Ue(0,1,0),new Ue(0,0,1),new Ue(0,0,-1)]}updateMatrices(e,i=0){const o=this.camera,s=this.matrix,l=e.distance||o.far;l!==o.far&&(o.far=l,o.updateProjectionMatrix()),wb.setFromMatrixPosition(e.matrixWorld),o.position.copy(wb),nI.copy(o.position),nI.add(this._cubeDirections[i]),o.up.copy(this._cubeUps[i]),o.lookAt(nI),o.updateMatrixWorld(),s.makeTranslation(-wb.x,-wb.y,-wb.z),TV.multiplyMatrices(o.projectionMatrix,o.matrixWorldInverse),this._frustum.setFromProjectionMatrix(TV)}}class YZ extends Df{constructor(e,i,o=0,s=2){super(e,i),this.isPointLight=!0,this.type="PointLight",this.distance=o,this.decay=s,this.shadow=new $Se}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,i){return super.copy(e,i),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class YSe extends R6{constructor(){super(new Rh(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class qZ extends Df{constructor(e,i){super(e,i),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(va.DEFAULT_UP),this.updateMatrix(),this.target=new va,this.shadow=new YSe}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class XZ extends Df{constructor(e,i){super(e,i),this.isAmbientLight=!0,this.type="AmbientLight"}}class ZZ extends Df{constructor(e,i,o=10,s=10){super(e,i),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=o,this.height=s}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const i=super.toJSON(e);return i.object.width=this.width,i.object.height=this.height,i}}class KZ{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new Ue)}set(e){for(let i=0;i<9;i++)this.coefficients[i].copy(e[i]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,i){const o=e.x,s=e.y,l=e.z,d=this.coefficients;return i.copy(d[0]).multiplyScalar(.282095),i.addScaledVector(d[1],.488603*s),i.addScaledVector(d[2],.488603*l),i.addScaledVector(d[3],.488603*o),i.addScaledVector(d[4],1.092548*(o*s)),i.addScaledVector(d[5],1.092548*(s*l)),i.addScaledVector(d[6],.315392*(3*l*l-1)),i.addScaledVector(d[7],1.092548*(o*l)),i.addScaledVector(d[8],.546274*(o*o-s*s)),i}getIrradianceAt(e,i){const o=e.x,s=e.y,l=e.z,d=this.coefficients;return i.copy(d[0]).multiplyScalar(.886227),i.addScaledVector(d[1],2*.511664*s),i.addScaledVector(d[2],2*.511664*l),i.addScaledVector(d[3],2*.511664*o),i.addScaledVector(d[4],2*.429043*o*s),i.addScaledVector(d[5],2*.429043*s*l),i.addScaledVector(d[6],.743125*l*l-.247708),i.addScaledVector(d[7],2*.429043*o*l),i.addScaledVector(d[8],.429043*(o*o-s*s)),i}add(e){for(let i=0;i<9;i++)this.coefficients[i].add(e.coefficients[i]);return this}addScaledSH(e,i){for(let o=0;o<9;o++)this.coefficients[o].addScaledVector(e.coefficients[o],i);return this}scale(e){for(let i=0;i<9;i++)this.coefficients[i].multiplyScalar(e);return this}lerp(e,i){for(let o=0;o<9;o++)this.coefficients[o].lerp(e.coefficients[o],i);return this}equals(e){for(let i=0;i<9;i++)if(!this.coefficients[i].equals(e.coefficients[i]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(e,i=0){const o=this.coefficients;for(let s=0;s<9;s++)o[s].fromArray(e,i+s*3);return this}toArray(e=[],i=0){const o=this.coefficients;for(let s=0;s<9;s++)o[s].toArray(e,i+s*3);return e}static getBasisAt(e,i){const o=e.x,s=e.y,l=e.z;i[0]=.282095,i[1]=.488603*s,i[2]=.488603*l,i[3]=.488603*o,i[4]=1.092548*o*s,i[5]=1.092548*s*l,i[6]=.315392*(3*l*l-1),i[7]=1.092548*o*l,i[8]=.546274*(o*o-s*s)}}class JZ extends Df{constructor(e=new KZ,i=1){super(void 0,i),this.isLightProbe=!0,this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){const i=super.toJSON(e);return i.object.sh=this.sh.toArray(),i}}class dC extends Tl{constructor(e){super(e),this.textures={}}load(e,i,o,s){const l=this,d=new jh(l.manager);d.setPath(l.path),d.setRequestHeader(l.requestHeader),d.setWithCredentials(l.withCredentials),d.load(e,function(p){try{i(l.parse(JSON.parse(p)))}catch(f){s?s(f):console.error(f),l.manager.itemError(e)}},o,s)}parse(e){const i=this.textures;function o(l){return i[l]===void 0&&console.warn("THREE.MaterialLoader: Undefined texture",l),i[l]}const s=dC.createMaterialFromType(e.type);if(e.uuid!==void 0&&(s.uuid=e.uuid),e.name!==void 0&&(s.name=e.name),e.color!==void 0&&s.color!==void 0&&s.color.setHex(e.color),e.roughness!==void 0&&(s.roughness=e.roughness),e.metalness!==void 0&&(s.metalness=e.metalness),e.sheen!==void 0&&(s.sheen=e.sheen),e.sheenColor!==void 0&&(s.sheenColor=new Pn().setHex(e.sheenColor)),e.sheenRoughness!==void 0&&(s.sheenRoughness=e.sheenRoughness),e.emissive!==void 0&&s.emissive!==void 0&&s.emissive.setHex(e.emissive),e.specular!==void 0&&s.specular!==void 0&&s.specular.setHex(e.specular),e.specularIntensity!==void 0&&(s.specularIntensity=e.specularIntensity),e.specularColor!==void 0&&s.specularColor!==void 0&&s.specularColor.setHex(e.specularColor),e.shininess!==void 0&&(s.shininess=e.shininess),e.clearcoat!==void 0&&(s.clearcoat=e.clearcoat),e.clearcoatRoughness!==void 0&&(s.clearcoatRoughness=e.clearcoatRoughness),e.iridescence!==void 0&&(s.iridescence=e.iridescence),e.iridescenceIOR!==void 0&&(s.iridescenceIOR=e.iridescenceIOR),e.iridescenceThicknessRange!==void 0&&(s.iridescenceThicknessRange=e.iridescenceThicknessRange),e.transmission!==void 0&&(s.transmission=e.transmission),e.thickness!==void 0&&(s.thickness=e.thickness),e.attenuationDistance!==void 0&&(s.attenuationDistance=e.attenuationDistance),e.attenuationColor!==void 0&&s.attenuationColor!==void 0&&s.attenuationColor.setHex(e.attenuationColor),e.anisotropy!==void 0&&(s.anisotropy=e.anisotropy),e.anisotropyRotation!==void 0&&(s.anisotropyRotation=e.anisotropyRotation),e.fog!==void 0&&(s.fog=e.fog),e.flatShading!==void 0&&(s.flatShading=e.flatShading),e.blending!==void 0&&(s.blending=e.blending),e.combine!==void 0&&(s.combine=e.combine),e.side!==void 0&&(s.side=e.side),e.shadowSide!==void 0&&(s.shadowSide=e.shadowSide),e.opacity!==void 0&&(s.opacity=e.opacity),e.transparent!==void 0&&(s.transparent=e.transparent),e.alphaTest!==void 0&&(s.alphaTest=e.alphaTest),e.alphaHash!==void 0&&(s.alphaHash=e.alphaHash),e.depthFunc!==void 0&&(s.depthFunc=e.depthFunc),e.depthTest!==void 0&&(s.depthTest=e.depthTest),e.depthWrite!==void 0&&(s.depthWrite=e.depthWrite),e.colorWrite!==void 0&&(s.colorWrite=e.colorWrite),e.blendSrc!==void 0&&(s.blendSrc=e.blendSrc),e.blendDst!==void 0&&(s.blendDst=e.blendDst),e.blendEquation!==void 0&&(s.blendEquation=e.blendEquation),e.blendSrcAlpha!==void 0&&(s.blendSrcAlpha=e.blendSrcAlpha),e.blendDstAlpha!==void 0&&(s.blendDstAlpha=e.blendDstAlpha),e.blendEquationAlpha!==void 0&&(s.blendEquationAlpha=e.blendEquationAlpha),e.blendColor!==void 0&&s.blendColor!==void 0&&s.blendColor.setHex(e.blendColor),e.blendAlpha!==void 0&&(s.blendAlpha=e.blendAlpha),e.stencilWriteMask!==void 0&&(s.stencilWriteMask=e.stencilWriteMask),e.stencilFunc!==void 0&&(s.stencilFunc=e.stencilFunc),e.stencilRef!==void 0&&(s.stencilRef=e.stencilRef),e.stencilFuncMask!==void 0&&(s.stencilFuncMask=e.stencilFuncMask),e.stencilFail!==void 0&&(s.stencilFail=e.stencilFail),e.stencilZFail!==void 0&&(s.stencilZFail=e.stencilZFail),e.stencilZPass!==void 0&&(s.stencilZPass=e.stencilZPass),e.stencilWrite!==void 0&&(s.stencilWrite=e.stencilWrite),e.wireframe!==void 0&&(s.wireframe=e.wireframe),e.wireframeLinewidth!==void 0&&(s.wireframeLinewidth=e.wireframeLinewidth),e.wireframeLinecap!==void 0&&(s.wireframeLinecap=e.wireframeLinecap),e.wireframeLinejoin!==void 0&&(s.wireframeLinejoin=e.wireframeLinejoin),e.rotation!==void 0&&(s.rotation=e.rotation),e.linewidth!==void 0&&(s.linewidth=e.linewidth),e.dashSize!==void 0&&(s.dashSize=e.dashSize),e.gapSize!==void 0&&(s.gapSize=e.gapSize),e.scale!==void 0&&(s.scale=e.scale),e.polygonOffset!==void 0&&(s.polygonOffset=e.polygonOffset),e.polygonOffsetFactor!==void 0&&(s.polygonOffsetFactor=e.polygonOffsetFactor),e.polygonOffsetUnits!==void 0&&(s.polygonOffsetUnits=e.polygonOffsetUnits),e.dithering!==void 0&&(s.dithering=e.dithering),e.alphaToCoverage!==void 0&&(s.alphaToCoverage=e.alphaToCoverage),e.premultipliedAlpha!==void 0&&(s.premultipliedAlpha=e.premultipliedAlpha),e.forceSinglePass!==void 0&&(s.forceSinglePass=e.forceSinglePass),e.visible!==void 0&&(s.visible=e.visible),e.toneMapped!==void 0&&(s.toneMapped=e.toneMapped),e.userData!==void 0&&(s.userData=e.userData),e.vertexColors!==void 0&&(typeof e.vertexColors=="number"?s.vertexColors=e.vertexColors>0:s.vertexColors=e.vertexColors),e.uniforms!==void 0)for(const l in e.uniforms){const d=e.uniforms[l];switch(s.uniforms[l]={},d.type){case"t":s.uniforms[l].value=o(d.value);break;case"c":s.uniforms[l].value=new Pn().setHex(d.value);break;case"v2":s.uniforms[l].value=new tn().fromArray(d.value);break;case"v3":s.uniforms[l].value=new Ue().fromArray(d.value);break;case"v4":s.uniforms[l].value=new Pa().fromArray(d.value);break;case"m3":s.uniforms[l].value=new Ui().fromArray(d.value);break;case"m4":s.uniforms[l].value=new Ri().fromArray(d.value);break;default:s.uniforms[l].value=d.value}}if(e.defines!==void 0&&(s.defines=e.defines),e.vertexShader!==void 0&&(s.vertexShader=e.vertexShader),e.fragmentShader!==void 0&&(s.fragmentShader=e.fragmentShader),e.glslVersion!==void 0&&(s.glslVersion=e.glslVersion),e.extensions!==void 0)for(const l in e.extensions)s.extensions[l]=e.extensions[l];if(e.lights!==void 0&&(s.lights=e.lights),e.clipping!==void 0&&(s.clipping=e.clipping),e.size!==void 0&&(s.size=e.size),e.sizeAttenuation!==void 0&&(s.sizeAttenuation=e.sizeAttenuation),e.map!==void 0&&(s.map=o(e.map)),e.matcap!==void 0&&(s.matcap=o(e.matcap)),e.alphaMap!==void 0&&(s.alphaMap=o(e.alphaMap)),e.bumpMap!==void 0&&(s.bumpMap=o(e.bumpMap)),e.bumpScale!==void 0&&(s.bumpScale=e.bumpScale),e.normalMap!==void 0&&(s.normalMap=o(e.normalMap)),e.normalMapType!==void 0&&(s.normalMapType=e.normalMapType),e.normalScale!==void 0){let l=e.normalScale;Array.isArray(l)===!1&&(l=[l,l]),s.normalScale=new tn().fromArray(l)}return e.displacementMap!==void 0&&(s.displacementMap=o(e.displacementMap)),e.displacementScale!==void 0&&(s.displacementScale=e.displacementScale),e.displacementBias!==void 0&&(s.displacementBias=e.displacementBias),e.roughnessMap!==void 0&&(s.roughnessMap=o(e.roughnessMap)),e.metalnessMap!==void 0&&(s.metalnessMap=o(e.metalnessMap)),e.emissiveMap!==void 0&&(s.emissiveMap=o(e.emissiveMap)),e.emissiveIntensity!==void 0&&(s.emissiveIntensity=e.emissiveIntensity),e.specularMap!==void 0&&(s.specularMap=o(e.specularMap)),e.specularIntensityMap!==void 0&&(s.specularIntensityMap=o(e.specularIntensityMap)),e.specularColorMap!==void 0&&(s.specularColorMap=o(e.specularColorMap)),e.envMap!==void 0&&(s.envMap=o(e.envMap)),e.envMapIntensity!==void 0&&(s.envMapIntensity=e.envMapIntensity),e.reflectivity!==void 0&&(s.reflectivity=e.reflectivity),e.refractionRatio!==void 0&&(s.refractionRatio=e.refractionRatio),e.lightMap!==void 0&&(s.lightMap=o(e.lightMap)),e.lightMapIntensity!==void 0&&(s.lightMapIntensity=e.lightMapIntensity),e.aoMap!==void 0&&(s.aoMap=o(e.aoMap)),e.aoMapIntensity!==void 0&&(s.aoMapIntensity=e.aoMapIntensity),e.gradientMap!==void 0&&(s.gradientMap=o(e.gradientMap)),e.clearcoatMap!==void 0&&(s.clearcoatMap=o(e.clearcoatMap)),e.clearcoatRoughnessMap!==void 0&&(s.clearcoatRoughnessMap=o(e.clearcoatRoughnessMap)),e.clearcoatNormalMap!==void 0&&(s.clearcoatNormalMap=o(e.clearcoatNormalMap)),e.clearcoatNormalScale!==void 0&&(s.clearcoatNormalScale=new tn().fromArray(e.clearcoatNormalScale)),e.iridescenceMap!==void 0&&(s.iridescenceMap=o(e.iridescenceMap)),e.iridescenceThicknessMap!==void 0&&(s.iridescenceThicknessMap=o(e.iridescenceThicknessMap)),e.transmissionMap!==void 0&&(s.transmissionMap=o(e.transmissionMap)),e.thicknessMap!==void 0&&(s.thicknessMap=o(e.thicknessMap)),e.anisotropyMap!==void 0&&(s.anisotropyMap=o(e.anisotropyMap)),e.sheenColorMap!==void 0&&(s.sheenColorMap=o(e.sheenColorMap)),e.sheenRoughnessMap!==void 0&&(s.sheenRoughnessMap=o(e.sheenRoughnessMap)),s}setTextures(e){return this.textures=e,this}static createMaterialFromType(e){const i={ShadowMaterial:PZ,SpriteMaterial:v6,RawShaderMaterial:IZ,ShaderMaterial:Ad,PointsMaterial:b6,MeshPhysicalMaterial:LZ,MeshStandardMaterial:T6,MeshPhongMaterial:RZ,MeshToonMaterial:kZ,MeshNormalMaterial:DZ,MeshLambertMaterial:OZ,MeshDepthMaterial:HT,MeshDistanceMaterial:jT,MeshBasicMaterial:qh,MeshMatcapMaterial:NZ,LineDashedMaterial:zZ,LineBasicMaterial:qs,Material:es};return new i[e]}}class zR{static decodeText(e){if(typeof TextDecoder<"u")return new TextDecoder().decode(e);let i="";for(let o=0,s=e.length;o<s;o++)i+=String.fromCharCode(e[o]);try{return decodeURIComponent(escape(i))}catch{return i}}static extractUrlBase(e){const i=e.lastIndexOf("/");return i===-1?"./":e.slice(0,i+1)}static resolveURL(e,i){return typeof e!="string"||e===""?"":(/^https?:\/\//i.test(i)&&/^\//.test(e)&&(i=i.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:i+e)}}class k6 extends ki{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){const e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}class QZ extends Tl{constructor(e){super(e)}load(e,i,o,s){const l=this,d=new jh(l.manager);d.setPath(l.path),d.setRequestHeader(l.requestHeader),d.setWithCredentials(l.withCredentials),d.load(e,function(p){try{i(l.parse(JSON.parse(p)))}catch(f){s?s(f):console.error(f),l.manager.itemError(e)}},o,s)}parse(e){const i={},o={};function s(T,I){if(i[I]!==void 0)return i[I];const D=T.interleavedBuffers[I],L=l(T,D.buffer),O=C0(D.type,L),N=new qT(O,D.stride);return N.uuid=D.uuid,i[I]=N,N}function l(T,I){if(o[I]!==void 0)return o[I];const D=T.arrayBuffers[I],L=new Uint32Array(D).buffer;return o[I]=L,L}const d=e.isInstancedBufferGeometry?new k6:new ki,p=e.data.index;if(p!==void 0){const T=C0(p.type,p.array);d.setIndex(new Za(T,1))}const f=e.data.attributes;for(const T in f){const I=f[T];let R;if(I.isInterleavedBufferAttribute){const D=s(e.data,I.data);R=new Ug(D,I.itemSize,I.offset,I.normalized)}else{const D=C0(I.type,I.array),L=I.isInstancedBufferAttribute?Wg:Za;R=new L(D,I.itemSize,I.normalized)}I.name!==void 0&&(R.name=I.name),I.usage!==void 0&&R.setUsage(I.usage),I.updateRange!==void 0&&(R.updateRange.offset=I.updateRange.offset,R.updateRange.count=I.updateRange.count),d.setAttribute(T,R)}const y=e.data.morphAttributes;if(y)for(const T in y){const I=y[T],R=[];for(let D=0,L=I.length;D<L;D++){const O=I[D];let N;if(O.isInterleavedBufferAttribute){const F=s(e.data,O.data);N=new Ug(F,O.itemSize,O.offset,O.normalized)}else{const F=C0(O.type,O.array);N=new Za(F,O.itemSize,O.normalized)}O.name!==void 0&&(N.name=O.name),R.push(N)}d.morphAttributes[T]=R}e.data.morphTargetsRelative&&(d.morphTargetsRelative=!0);const x=e.data.groups||e.data.drawcalls||e.data.offsets;if(x!==void 0)for(let T=0,I=x.length;T!==I;++T){const R=x[T];d.addGroup(R.start,R.count,R.materialIndex)}const S=e.data.boundingSphere;if(S!==void 0){const T=new Ue;S.center!==void 0&&T.fromArray(S.center),d.boundingSphere=new Rc(T,S.radius)}return e.name&&(d.name=e.name),e.userData&&(d.userData=e.userData),d}}class qSe extends Tl{constructor(e){super(e)}load(e,i,o,s){const l=this,d=this.path===""?zR.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||d;const p=new jh(this.manager);p.setPath(this.path),p.setRequestHeader(this.requestHeader),p.setWithCredentials(this.withCredentials),p.load(e,function(f){let y=null;try{y=JSON.parse(f)}catch(x){s!==void 0&&s(x),console.error("THREE:ObjectLoader: Can't parse "+e+".",x.message);return}const _=y.metadata;if(_===void 0||_.type===void 0||_.type.toLowerCase()==="geometry"){s!==void 0&&s(new Error("THREE.ObjectLoader: Can't load "+e)),console.error("THREE.ObjectLoader: Can't load "+e);return}l.parse(y,i)},o,s)}async loadAsync(e,i){const o=this,s=this.path===""?zR.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||s;const l=new jh(this.manager);l.setPath(this.path),l.setRequestHeader(this.requestHeader),l.setWithCredentials(this.withCredentials);const d=await l.loadAsync(e,i),p=JSON.parse(d),f=p.metadata;if(f===void 0||f.type===void 0||f.type.toLowerCase()==="geometry")throw new Error("THREE.ObjectLoader: Can't load "+e);return await o.parseAsync(p)}parse(e,i){const o=this.parseAnimations(e.animations),s=this.parseShapes(e.shapes),l=this.parseGeometries(e.geometries,s),d=this.parseImages(e.images,function(){i!==void 0&&i(y)}),p=this.parseTextures(e.textures,d),f=this.parseMaterials(e.materials,p),y=this.parseObject(e.object,l,f,p,o),_=this.parseSkeletons(e.skeletons,y);if(this.bindSkeletons(y,_),i!==void 0){let x=!1;for(const S in d)if(d[S].data instanceof HTMLImageElement){x=!0;break}x===!1&&i(y)}return y}async parseAsync(e){const i=this.parseAnimations(e.animations),o=this.parseShapes(e.shapes),s=this.parseGeometries(e.geometries,o),l=await this.parseImagesAsync(e.images),d=this.parseTextures(e.textures,l),p=this.parseMaterials(e.materials,d),f=this.parseObject(e.object,s,p,d,i),y=this.parseSkeletons(e.skeletons,f);return this.bindSkeletons(f,y),f}parseShapes(e){const i={};if(e!==void 0)for(let o=0,s=e.length;o<s;o++){const l=new Mg().fromJSON(e[o]);i[l.uuid]=l}return i}parseSkeletons(e,i){const o={},s={};if(i.traverse(function(l){l.isBone&&(s[l.uuid]=l)}),e!==void 0)for(let l=0,d=e.length;l<d;l++){const p=new XT().fromJSON(e[l],s);o[p.uuid]=p}return o}parseGeometries(e,i){const o={};if(e!==void 0){const s=new QZ;for(let l=0,d=e.length;l<d;l++){let p;const f=e[l];switch(f.type){case"BufferGeometry":case"InstancedBufferGeometry":p=s.parse(f);break;default:f.type in AV?p=AV[f.type].fromJSON(f,i):console.warn(`THREE.ObjectLoader: Unsupported geometry type "${f.type}"`)}p.uuid=f.uuid,f.name!==void 0&&(p.name=f.name),f.userData!==void 0&&(p.userData=f.userData),o[f.uuid]=p}}return o}parseMaterials(e,i){const o={},s={};if(e!==void 0){const l=new dC;l.setTextures(i);for(let d=0,p=e.length;d<p;d++){const f=e[d];o[f.uuid]===void 0&&(o[f.uuid]=l.parse(f)),s[f.uuid]=o[f.uuid]}}return s}parseAnimations(e){const i={};if(e!==void 0)for(let o=0;o<e.length;o++){const s=e[o],l=bw.parse(s);i[l.uuid]=l}return i}parseImages(e,i){const o=this,s={};let l;function d(f){return o.manager.itemStart(f),l.load(f,function(){o.manager.itemEnd(f)},void 0,function(){o.manager.itemError(f),o.manager.itemEnd(f)})}function p(f){if(typeof f=="string"){const y=f,_=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(y)?y:o.resourcePath+y;return d(_)}else return f.data?{data:C0(f.type,f.data),width:f.width,height:f.height}:null}if(e!==void 0&&e.length>0){const f=new L6(i);l=new xw(f),l.setCrossOrigin(this.crossOrigin);for(let y=0,_=e.length;y<_;y++){const x=e[y],S=x.url;if(Array.isArray(S)){const T=[];for(let I=0,R=S.length;I<R;I++){const D=S[I],L=p(D);L!==null&&(L instanceof HTMLImageElement?T.push(L):T.push(new H0(L.data,L.width,L.height)))}s[x.uuid]=new mg(T)}else{const T=p(x.url);s[x.uuid]=new mg(T)}}}return s}async parseImagesAsync(e){const i=this,o={};let s;async function l(d){if(typeof d=="string"){const p=d,f=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(p)?p:i.resourcePath+p;return await s.loadAsync(f)}else return d.data?{data:C0(d.type,d.data),width:d.width,height:d.height}:null}if(e!==void 0&&e.length>0){s=new xw(this.manager),s.setCrossOrigin(this.crossOrigin);for(let d=0,p=e.length;d<p;d++){const f=e[d],y=f.url;if(Array.isArray(y)){const _=[];for(let x=0,S=y.length;x<S;x++){const T=y[x],I=await l(T);I!==null&&(I instanceof HTMLImageElement?_.push(I):_.push(new H0(I.data,I.width,I.height)))}o[f.uuid]=new mg(_)}else{const _=await l(f.url);o[f.uuid]=new mg(_)}}}return o}parseTextures(e,i){function o(l,d){return typeof l=="number"?l:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",l),d[l])}const s={};if(e!==void 0)for(let l=0,d=e.length;l<d;l++){const p=e[l];p.image===void 0&&console.warn('THREE.ObjectLoader: No "image" specified for',p.uuid),i[p.image]===void 0&&console.warn("THREE.ObjectLoader: Undefined image",p.image);const f=i[p.image],y=f.data;let _;Array.isArray(y)?(_=new Zw,y.length===6&&(_.needsUpdate=!0)):(y&&y.data?_=new H0:_=new Or,y&&(_.needsUpdate=!0)),_.source=f,_.uuid=p.uuid,p.name!==void 0&&(_.name=p.name),p.mapping!==void 0&&(_.mapping=o(p.mapping,XSe)),p.channel!==void 0&&(_.channel=p.channel),p.offset!==void 0&&_.offset.fromArray(p.offset),p.repeat!==void 0&&_.repeat.fromArray(p.repeat),p.center!==void 0&&_.center.fromArray(p.center),p.rotation!==void 0&&(_.rotation=p.rotation),p.wrap!==void 0&&(_.wrapS=o(p.wrap[0],CV),_.wrapT=o(p.wrap[1],CV)),p.format!==void 0&&(_.format=p.format),p.internalFormat!==void 0&&(_.internalFormat=p.internalFormat),p.type!==void 0&&(_.type=p.type),p.colorSpace!==void 0&&(_.colorSpace=p.colorSpace),p.encoding!==void 0&&(_.encoding=p.encoding),p.minFilter!==void 0&&(_.minFilter=o(p.minFilter,PV)),p.magFilter!==void 0&&(_.magFilter=o(p.magFilter,PV)),p.anisotropy!==void 0&&(_.anisotropy=p.anisotropy),p.flipY!==void 0&&(_.flipY=p.flipY),p.generateMipmaps!==void 0&&(_.generateMipmaps=p.generateMipmaps),p.premultiplyAlpha!==void 0&&(_.premultiplyAlpha=p.premultiplyAlpha),p.unpackAlignment!==void 0&&(_.unpackAlignment=p.unpackAlignment),p.compareFunction!==void 0&&(_.compareFunction=p.compareFunction),p.userData!==void 0&&(_.userData=p.userData),s[p.uuid]=_}return s}parseObject(e,i,o,s,l){let d;function p(S){return i[S]===void 0&&console.warn("THREE.ObjectLoader: Undefined geometry",S),i[S]}function f(S){if(S!==void 0){if(Array.isArray(S)){const T=[];for(let I=0,R=S.length;I<R;I++){const D=S[I];o[D]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",D),T.push(o[D])}return T}return o[S]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",S),o[S]}}function y(S){return s[S]===void 0&&console.warn("THREE.ObjectLoader: Undefined texture",S),s[S]}let _,x;switch(e.type){case"Scene":d=new uM,e.background!==void 0&&(Number.isInteger(e.background)?d.background=new Pn(e.background):d.background=y(e.background)),e.environment!==void 0&&(d.environment=y(e.environment)),e.fog!==void 0&&(e.fog.type==="Fog"?d.fog=new YT(e.fog.color,e.fog.near,e.fog.far):e.fog.type==="FogExp2"&&(d.fog=new $T(e.fog.color,e.fog.density)),e.fog.name!==""&&(d.fog.name=e.fog.name)),e.backgroundBlurriness!==void 0&&(d.backgroundBlurriness=e.backgroundBlurriness),e.backgroundIntensity!==void 0&&(d.backgroundIntensity=e.backgroundIntensity);break;case"PerspectiveCamera":d=new qr(e.fov,e.aspect,e.near,e.far),e.focus!==void 0&&(d.focus=e.focus),e.zoom!==void 0&&(d.zoom=e.zoom),e.filmGauge!==void 0&&(d.filmGauge=e.filmGauge),e.filmOffset!==void 0&&(d.filmOffset=e.filmOffset),e.view!==void 0&&(d.view=Object.assign({},e.view));break;case"OrthographicCamera":d=new Rh(e.left,e.right,e.top,e.bottom,e.near,e.far),e.zoom!==void 0&&(d.zoom=e.zoom),e.view!==void 0&&(d.view=Object.assign({},e.view));break;case"AmbientLight":d=new XZ(e.color,e.intensity);break;case"DirectionalLight":d=new qZ(e.color,e.intensity);break;case"PointLight":d=new YZ(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":d=new ZZ(e.color,e.intensity,e.width,e.height);break;case"SpotLight":d=new $Z(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":d=new jZ(e.color,e.groundColor,e.intensity);break;case"LightProbe":d=new JZ().fromJSON(e);break;case"SkinnedMesh":_=p(e.geometry),x=f(e.material),d=new mZ(_,x),e.bindMode!==void 0&&(d.bindMode=e.bindMode),e.bindMatrix!==void 0&&d.bindMatrix.fromArray(e.bindMatrix),e.skeleton!==void 0&&(d.skeleton=e.skeleton);break;case"Mesh":_=p(e.geometry),x=f(e.material),d=new wo(_,x);break;case"InstancedMesh":_=p(e.geometry),x=f(e.material);const S=e.count,T=e.instanceMatrix,I=e.instanceColor;d=new gZ(_,x,S),d.instanceMatrix=new Wg(new Float32Array(T.array),16),I!==void 0&&(d.instanceColor=new Wg(new Float32Array(I.array),I.itemSize));break;case"LOD":d=new fZ;break;case"Line":d=new Af(p(e.geometry),f(e.material));break;case"LineLoop":d=new yZ(p(e.geometry),f(e.material));break;case"LineSegments":d=new Cd(p(e.geometry),f(e.material));break;case"PointCloud":case"Points":d=new vZ(p(e.geometry),f(e.material));break;case"Sprite":d=new pZ(f(e.material));break;case"Group":d=new I0;break;case"Bone":d=new _6;break;default:d=new va}if(d.uuid=e.uuid,e.name!==void 0&&(d.name=e.name),e.matrix!==void 0?(d.matrix.fromArray(e.matrix),e.matrixAutoUpdate!==void 0&&(d.matrixAutoUpdate=e.matrixAutoUpdate),d.matrixAutoUpdate&&d.matrix.decompose(d.position,d.quaternion,d.scale)):(e.position!==void 0&&d.position.fromArray(e.position),e.rotation!==void 0&&d.rotation.fromArray(e.rotation),e.quaternion!==void 0&&d.quaternion.fromArray(e.quaternion),e.scale!==void 0&&d.scale.fromArray(e.scale)),e.up!==void 0&&d.up.fromArray(e.up),e.castShadow!==void 0&&(d.castShadow=e.castShadow),e.receiveShadow!==void 0&&(d.receiveShadow=e.receiveShadow),e.shadow&&(e.shadow.bias!==void 0&&(d.shadow.bias=e.shadow.bias),e.shadow.normalBias!==void 0&&(d.shadow.normalBias=e.shadow.normalBias),e.shadow.radius!==void 0&&(d.shadow.radius=e.shadow.radius),e.shadow.mapSize!==void 0&&d.shadow.mapSize.fromArray(e.shadow.mapSize),e.shadow.camera!==void 0&&(d.shadow.camera=this.parseObject(e.shadow.camera))),e.visible!==void 0&&(d.visible=e.visible),e.frustumCulled!==void 0&&(d.frustumCulled=e.frustumCulled),e.renderOrder!==void 0&&(d.renderOrder=e.renderOrder),e.userData!==void 0&&(d.userData=e.userData),e.layers!==void 0&&(d.layers.mask=e.layers),e.children!==void 0){const S=e.children;for(let T=0;T<S.length;T++)d.add(this.parseObject(S[T],i,o,s,l))}if(e.animations!==void 0){const S=e.animations;for(let T=0;T<S.length;T++){const I=S[T];d.animations.push(l[I])}}if(e.type==="LOD"){e.autoUpdate!==void 0&&(d.autoUpdate=e.autoUpdate);const S=e.levels;for(let T=0;T<S.length;T++){const I=S[T],R=d.getObjectByProperty("uuid",I.object);R!==void 0&&d.addLevel(R,I.distance,I.hysteresis)}}return d}bindSkeletons(e,i){Object.keys(i).length!==0&&e.traverse(function(o){if(o.isSkinnedMesh===!0&&o.skeleton!==void 0){const s=i[o.skeleton];s===void 0?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",o.skeleton):o.bind(s,o.bindMatrix)}})}}const XSe={UVMapping:zT,CubeReflectionMapping:Hh,CubeRefractionMapping:wf,EquirectangularReflectionMapping:tw,EquirectangularRefractionMapping:nw,CubeUVReflectionMapping:S_},CV={RepeatWrapping:iw,ClampToEdgeWrapping:bs,MirroredRepeatWrapping:aw},PV={NearestFilter:so,NearestMipmapNearestFilter:sM,NearestMipmapLinearFilter:px,LinearFilter:Lr,LinearMipmapNearestFilter:e6,LinearMipmapLinearFilter:Sf};class ZSe extends Tl{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,i,o,s){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const l=this,d=Gg.get(e);if(d!==void 0)return l.manager.itemStart(e),setTimeout(function(){i&&i(d),l.manager.itemEnd(e)},0),d;const p={};p.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",p.headers=this.requestHeader,fetch(e,p).then(function(f){return f.blob()}).then(function(f){return createImageBitmap(f,Object.assign(l.options,{colorSpaceConversion:"none"}))}).then(function(f){Gg.add(e,f),i&&i(f),l.manager.itemEnd(e)}).catch(function(f){s&&s(f),l.manager.itemError(e),l.manager.itemEnd(e)}),l.manager.itemStart(e)}}let sA;class D6{static getContext(){return sA===void 0&&(sA=new(window.AudioContext||window.webkitAudioContext)),sA}static setContext(e){sA=e}}class KSe extends Tl{constructor(e){super(e)}load(e,i,o,s){const l=this,d=new jh(this.manager);d.setResponseType("arraybuffer"),d.setPath(this.path),d.setRequestHeader(this.requestHeader),d.setWithCredentials(this.withCredentials),d.load(e,function(f){try{const y=f.slice(0);D6.getContext().decodeAudioData(y,function(x){i(x)},p)}catch(y){p(y)}},o,s);function p(f){s?s(f):console.error(f),l.manager.itemError(e)}}}const IV=new Ri,LV=new Ri,Wm=new Ri;class JSe{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new qr,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new qr,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(e){const i=this._cache;if(i.focus!==e.focus||i.fov!==e.fov||i.aspect!==e.aspect*this.aspect||i.near!==e.near||i.far!==e.far||i.zoom!==e.zoom||i.eyeSep!==this.eyeSep){i.focus=e.focus,i.fov=e.fov,i.aspect=e.aspect*this.aspect,i.near=e.near,i.far=e.far,i.zoom=e.zoom,i.eyeSep=this.eyeSep,Wm.copy(e.projectionMatrix);const s=i.eyeSep/2,l=s*i.near/i.focus,d=i.near*Math.tan(Ag*i.fov*.5)/i.zoom;let p,f;LV.elements[12]=-s,IV.elements[12]=s,p=-d*i.aspect+l,f=d*i.aspect+l,Wm.elements[0]=2*i.near/(f-p),Wm.elements[8]=(f+p)/(f-p),this.cameraL.projectionMatrix.copy(Wm),p=-d*i.aspect-l,f=d*i.aspect-l,Wm.elements[0]=2*i.near/(f-p),Wm.elements[8]=(f+p)/(f-p),this.cameraR.projectionMatrix.copy(Wm)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(LV),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(IV)}}class O6{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=RV(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const i=RV();e=(i-this.oldTime)/1e3,this.oldTime=i,this.elapsedTime+=e}return e}}function RV(){return(typeof performance>"u"?Date:performance).now()}const Vm=new Ue,kV=new As,QSe=new Ue,Gm=new Ue;class eAe extends va{constructor(){super(),this.type="AudioListener",this.context=D6.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new O6}getInput(){return this.gain}removeFilter(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(e){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}updateMatrixWorld(e){super.updateMatrixWorld(e);const i=this.context.listener,o=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(Vm,kV,QSe),Gm.set(0,0,-1).applyQuaternion(kV),i.positionX){const s=this.context.currentTime+this.timeDelta;i.positionX.linearRampToValueAtTime(Vm.x,s),i.positionY.linearRampToValueAtTime(Vm.y,s),i.positionZ.linearRampToValueAtTime(Vm.z,s),i.forwardX.linearRampToValueAtTime(Gm.x,s),i.forwardY.linearRampToValueAtTime(Gm.y,s),i.forwardZ.linearRampToValueAtTime(Gm.z,s),i.upX.linearRampToValueAtTime(o.x,s),i.upY.linearRampToValueAtTime(o.y,s),i.upZ.linearRampToValueAtTime(o.z,s)}else i.setPosition(Vm.x,Vm.y,Vm.z),i.setOrientation(Gm.x,Gm.y,Gm.z,o.x,o.y,o.z)}}class eK extends va{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(e=0){if(this.isPlaying===!0){console.warn("THREE.Audio: Audio is already playing.");return}if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+e;const i=this.context.createBufferSource();return i.buffer=this.buffer,i.loop=this.loop,i.loopStart=this.loopStart,i.loopEnd=this.loopEnd,i.onended=this.onEnded.bind(this),i.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=i,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this}stop(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this._progress=0,this.source!==null&&(this.source.stop(),this.source.onended=null),this.isPlaying=!1,this}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,i=this.filters.length;e<i;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this._connected!==!1){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,i=this.filters.length;e<i;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}}getFilters(){return this.filters}setFilters(e){return e||(e=[]),this._connected===!0?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){if(this.detune=e,this.source.detune!==void 0)return this.isPlaying===!0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.playbackRate=e,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.loop=e,this.isPlaying===!0&&(this.source.loop=this.loop),this}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}}const Hm=new Ue,DV=new As,tAe=new Ue,jm=new Ue;class nAe extends eK{constructor(e){super(e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}connect(){super.connect(),this.panner.connect(this.gain)}disconnect(){super.disconnect(),this.panner.disconnect(this.gain)}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(e){return this.panner.refDistance=e,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(e){return this.panner.rolloffFactor=e,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(e){return this.panner.distanceModel=e,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(e){return this.panner.maxDistance=e,this}setDirectionalCone(e,i,o){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=i,this.panner.coneOuterGain=o,this}updateMatrixWorld(e){if(super.updateMatrixWorld(e),this.hasPlaybackControl===!0&&this.isPlaying===!1)return;this.matrixWorld.decompose(Hm,DV,tAe),jm.set(0,0,1).applyQuaternion(DV);const i=this.panner;if(i.positionX){const o=this.context.currentTime+this.listener.timeDelta;i.positionX.linearRampToValueAtTime(Hm.x,o),i.positionY.linearRampToValueAtTime(Hm.y,o),i.positionZ.linearRampToValueAtTime(Hm.z,o),i.orientationX.linearRampToValueAtTime(jm.x,o),i.orientationY.linearRampToValueAtTime(jm.y,o),i.orientationZ.linearRampToValueAtTime(jm.z,o)}else i.setPosition(Hm.x,Hm.y,Hm.z),i.setOrientation(jm.x,jm.y,jm.z)}}class iAe{constructor(e,i=2048){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=i,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let e=0;const i=this.getFrequencyData();for(let o=0;o<i.length;o++)e+=i[o];return e/i.length}}class tK{constructor(e,i,o){this.binding=e,this.valueSize=o;let s,l,d;switch(i){case"quaternion":s=this._slerp,l=this._slerpAdditive,d=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(o*6),this._workIndex=5;break;case"string":case"bool":s=this._select,l=this._select,d=this._setAdditiveIdentityOther,this.buffer=new Array(o*5);break;default:s=this._lerp,l=this._lerpAdditive,d=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(o*5)}this._mixBufferRegion=s,this._mixBufferRegionAdditive=l,this._setIdentity=d,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,i){const o=this.buffer,s=this.valueSize,l=e*s+s;let d=this.cumulativeWeight;if(d===0){for(let p=0;p!==s;++p)o[l+p]=o[p];d=i}else{d+=i;const p=i/d;this._mixBufferRegion(o,l,0,p,s)}this.cumulativeWeight=d}accumulateAdditive(e){const i=this.buffer,o=this.valueSize,s=o*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(i,s,0,e,o),this.cumulativeWeightAdditive+=e}apply(e){const i=this.valueSize,o=this.buffer,s=e*i+i,l=this.cumulativeWeight,d=this.cumulativeWeightAdditive,p=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,l<1){const f=i*this._origIndex;this._mixBufferRegion(o,s,f,1-l,i)}d>0&&this._mixBufferRegionAdditive(o,s,this._addIndex*i,1,i);for(let f=i,y=i+i;f!==y;++f)if(o[f]!==o[f+i]){p.setValue(o,s);break}}saveOriginalState(){const e=this.binding,i=this.buffer,o=this.valueSize,s=o*this._origIndex;e.getValue(i,s);for(let l=o,d=s;l!==d;++l)i[l]=i[s+l%o];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const e=this.valueSize*3;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,i=e+this.valueSize;for(let o=e;o<i;o++)this.buffer[o]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,i=this._addIndex*this.valueSize;for(let o=0;o<this.valueSize;o++)this.buffer[i+o]=this.buffer[e+o]}_select(e,i,o,s,l){if(s>=.5)for(let d=0;d!==l;++d)e[i+d]=e[o+d]}_slerp(e,i,o,s){As.slerpFlat(e,i,e,i,e,o,s)}_slerpAdditive(e,i,o,s,l){const d=this._workIndex*l;As.multiplyQuaternionsFlat(e,d,e,i,e,o),As.slerpFlat(e,i,e,i,e,d,s)}_lerp(e,i,o,s,l){const d=1-s;for(let p=0;p!==l;++p){const f=i+p;e[f]=e[f]*d+e[o+p]*s}}_lerpAdditive(e,i,o,s,l){for(let d=0;d!==l;++d){const p=i+d;e[p]=e[p]+e[o+d]*s}}}const N6="\\[\\]\\.:\\/",aAe=new RegExp("["+N6+"]","g"),z6="[^"+N6+"]",rAe="[^"+N6.replace("\\.","")+"]",oAe=/((?:WC+[\/:])*)/.source.replace("WC",z6),sAe=/(WCOD+)?/.source.replace("WCOD",rAe),lAe=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",z6),cAe=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",z6),uAe=new RegExp("^"+oAe+sAe+lAe+cAe+"$"),dAe=["material","materials","bones","map"];class hAe{constructor(e,i,o){const s=o||ca.parseTrackName(i);this._targetGroup=e,this._bindings=e.subscribe_(i,s)}getValue(e,i){this.bind();const o=this._targetGroup.nCachedObjects_,s=this._bindings[o];s!==void 0&&s.getValue(e,i)}setValue(e,i){const o=this._bindings;for(let s=this._targetGroup.nCachedObjects_,l=o.length;s!==l;++s)o[s].setValue(e,i)}bind(){const e=this._bindings;for(let i=this._targetGroup.nCachedObjects_,o=e.length;i!==o;++i)e[i].bind()}unbind(){const e=this._bindings;for(let i=this._targetGroup.nCachedObjects_,o=e.length;i!==o;++i)e[i].unbind()}}class ca{constructor(e,i,o){this.path=i,this.parsedPath=o||ca.parseTrackName(i),this.node=ca.findNode(e,this.parsedPath.nodeName),this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,i,o){return e&&e.isAnimationObjectGroup?new ca.Composite(e,i,o):new ca(e,i,o)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(aAe,"")}static parseTrackName(e){const i=uAe.exec(e);if(i===null)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const o={nodeName:i[2],objectName:i[3],objectIndex:i[4],propertyName:i[5],propertyIndex:i[6]},s=o.nodeName&&o.nodeName.lastIndexOf(".");if(s!==void 0&&s!==-1){const l=o.nodeName.substring(s+1);dAe.indexOf(l)!==-1&&(o.nodeName=o.nodeName.substring(0,s),o.objectName=l)}if(o.propertyName===null||o.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return o}static findNode(e,i){if(i===void 0||i===""||i==="."||i===-1||i===e.name||i===e.uuid)return e;if(e.skeleton){const o=e.skeleton.getBoneByName(i);if(o!==void 0)return o}if(e.children){const o=function(l){for(let d=0;d<l.length;d++){const p=l[d];if(p.name===i||p.uuid===i)return p;const f=o(p.children);if(f)return f}return null},s=o(e.children);if(s)return s}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,i){e[i]=this.targetObject[this.propertyName]}_getValue_array(e,i){const o=this.resolvedProperty;for(let s=0,l=o.length;s!==l;++s)e[i++]=o[s]}_getValue_arrayElement(e,i){e[i]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,i){this.resolvedProperty.toArray(e,i)}_setValue_direct(e,i){this.targetObject[this.propertyName]=e[i]}_setValue_direct_setNeedsUpdate(e,i){this.targetObject[this.propertyName]=e[i],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,i){this.targetObject[this.propertyName]=e[i],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,i){const o=this.resolvedProperty;for(let s=0,l=o.length;s!==l;++s)o[s]=e[i++]}_setValue_array_setNeedsUpdate(e,i){const o=this.resolvedProperty;for(let s=0,l=o.length;s!==l;++s)o[s]=e[i++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,i){const o=this.resolvedProperty;for(let s=0,l=o.length;s!==l;++s)o[s]=e[i++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,i){this.resolvedProperty[this.propertyIndex]=e[i]}_setValue_arrayElement_setNeedsUpdate(e,i){this.resolvedProperty[this.propertyIndex]=e[i],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,i){this.resolvedProperty[this.propertyIndex]=e[i],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,i){this.resolvedProperty.fromArray(e,i)}_setValue_fromArray_setNeedsUpdate(e,i){this.resolvedProperty.fromArray(e,i),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,i){this.resolvedProperty.fromArray(e,i),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,i){this.bind(),this.getValue(e,i)}_setValue_unbound(e,i){this.bind(),this.setValue(e,i)}bind(){let e=this.node;const i=this.parsedPath,o=i.objectName,s=i.propertyName;let l=i.propertyIndex;if(e||(e=ca.findNode(this.rootNode,i.nodeName),this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");return}if(o){let y=i.objectIndex;switch(o){case"materials":if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let _=0;_<e.length;_++)if(e[_].name===y){y=_;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}e=e.material.map;break;default:if(e[o]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[o]}if(y!==void 0){if(e[y]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[y]}}const d=e[s];if(d===void 0){const y=i.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+y+"."+s+" but it wasn't found.",e);return}let p=this.Versioning.None;this.targetObject=e,e.needsUpdate!==void 0?p=this.Versioning.NeedsUpdate:e.matrixWorldNeedsUpdate!==void 0&&(p=this.Versioning.MatrixWorldNeedsUpdate);let f=this.BindingType.Direct;if(l!==void 0){if(s==="morphTargetInfluences"){if(!e.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!e.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[l]!==void 0&&(l=e.morphTargetDictionary[l])}f=this.BindingType.ArrayElement,this.resolvedProperty=d,this.propertyIndex=l}else d.fromArray!==void 0&&d.toArray!==void 0?(f=this.BindingType.HasFromToArray,this.resolvedProperty=d):Array.isArray(d)?(f=this.BindingType.EntireArray,this.resolvedProperty=d):this.propertyName=s;this.getValue=this.GetterByBindingType[f],this.setValue=this.SetterByBindingTypeAndVersioning[f][p]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}ca.Composite=hAe;ca.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};ca.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};ca.prototype.GetterByBindingType=[ca.prototype._getValue_direct,ca.prototype._getValue_array,ca.prototype._getValue_arrayElement,ca.prototype._getValue_toArray];ca.prototype.SetterByBindingTypeAndVersioning=[[ca.prototype._setValue_direct,ca.prototype._setValue_direct_setNeedsUpdate,ca.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[ca.prototype._setValue_array,ca.prototype._setValue_array_setNeedsUpdate,ca.prototype._setValue_array_setMatrixWorldNeedsUpdate],[ca.prototype._setValue_arrayElement,ca.prototype._setValue_arrayElement_setNeedsUpdate,ca.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[ca.prototype._setValue_fromArray,ca.prototype._setValue_fromArray_setNeedsUpdate,ca.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class pAe{constructor(){this.isAnimationObjectGroup=!0,this.uuid=Zl(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const e={};this._indicesByUUID=e;for(let o=0,s=arguments.length;o!==s;++o)e[arguments[o].uuid]=o;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const i=this;this.stats={objects:{get total(){return i._objects.length},get inUse(){return this.total-i.nCachedObjects_}},get bindingsPerObject(){return i._bindings.length}}}add(){const e=this._objects,i=this._indicesByUUID,o=this._paths,s=this._parsedPaths,l=this._bindings,d=l.length;let p,f=e.length,y=this.nCachedObjects_;for(let _=0,x=arguments.length;_!==x;++_){const S=arguments[_],T=S.uuid;let I=i[T];if(I===void 0){I=f++,i[T]=I,e.push(S);for(let R=0,D=d;R!==D;++R)l[R].push(new ca(S,o[R],s[R]))}else if(I<y){p=e[I];const R=--y,D=e[R];i[D.uuid]=I,e[I]=D,i[T]=R,e[R]=S;for(let L=0,O=d;L!==O;++L){const N=l[L],F=N[R];let G=N[I];N[I]=F,G===void 0&&(G=new ca(S,o[L],s[L])),N[R]=G}}else e[I]!==p&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=y}remove(){const e=this._objects,i=this._indicesByUUID,o=this._bindings,s=o.length;let l=this.nCachedObjects_;for(let d=0,p=arguments.length;d!==p;++d){const f=arguments[d],y=f.uuid,_=i[y];if(_!==void 0&&_>=l){const x=l++,S=e[x];i[S.uuid]=_,e[_]=S,i[y]=x,e[x]=f;for(let T=0,I=s;T!==I;++T){const R=o[T],D=R[x],L=R[_];R[_]=D,R[x]=L}}}this.nCachedObjects_=l}uncache(){const e=this._objects,i=this._indicesByUUID,o=this._bindings,s=o.length;let l=this.nCachedObjects_,d=e.length;for(let p=0,f=arguments.length;p!==f;++p){const y=arguments[p],_=y.uuid,x=i[_];if(x!==void 0)if(delete i[_],x<l){const S=--l,T=e[S],I=--d,R=e[I];i[T.uuid]=x,e[x]=T,i[R.uuid]=S,e[S]=R,e.pop();for(let D=0,L=s;D!==L;++D){const O=o[D],N=O[S],F=O[I];O[x]=N,O[S]=F,O.pop()}}else{const S=--d,T=e[S];S>0&&(i[T.uuid]=x),e[x]=T,e.pop();for(let I=0,R=s;I!==R;++I){const D=o[I];D[x]=D[S],D.pop()}}}this.nCachedObjects_=l}subscribe_(e,i){const o=this._bindingsIndicesByPath;let s=o[e];const l=this._bindings;if(s!==void 0)return l[s];const d=this._paths,p=this._parsedPaths,f=this._objects,y=f.length,_=this.nCachedObjects_,x=new Array(y);s=l.length,o[e]=s,d.push(e),p.push(i),l.push(x);for(let S=_,T=f.length;S!==T;++S){const I=f[S];x[S]=new ca(I,e,i)}return x}unsubscribe_(e){const i=this._bindingsIndicesByPath,o=i[e];if(o!==void 0){const s=this._paths,l=this._parsedPaths,d=this._bindings,p=d.length-1,f=d[p],y=e[p];i[y]=o,d[o]=f,d.pop(),l[o]=l[p],l.pop(),s[o]=s[p],s.pop()}}}class nK{constructor(e,i,o=null,s=i.blendMode){this._mixer=e,this._clip=i,this._localRoot=o,this.blendMode=s;const l=i.tracks,d=l.length,p=new Array(d),f={endingStart:pg,endingEnd:pg};for(let y=0;y!==d;++y){const _=l[y].createInterpolant(null);p[y]=_,_.settings=f}this._interpolantSettings=f,this._interpolants=p,this._propertyBindings=new Array(d),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=zX,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,i){return this.loop=e,this.repetitions=i,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,i,o){if(e.fadeOut(i),this.fadeIn(i),o){const s=this._clip.duration,l=e._clip.duration,d=l/s,p=s/l;e.warp(1,d,i),this.warp(p,1,i)}return this}crossFadeTo(e,i,o){return e.crossFadeFrom(this,i,o)}stopFading(){const e=this._weightInterpolant;return e!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,i,o){const s=this._mixer,l=s.time,d=this.timeScale;let p=this._timeScaleInterpolant;p===null&&(p=s._lendControlInterpolant(),this._timeScaleInterpolant=p);const f=p.parameterPositions,y=p.sampleValues;return f[0]=l,f[1]=l+o,y[0]=e/d,y[1]=i/d,this}stopWarping(){const e=this._timeScaleInterpolant;return e!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,i,o,s){if(!this.enabled){this._updateWeight(e);return}const l=this._startTime;if(l!==null){const f=(e-l)*o;f<0||o===0?i=0:(this._startTime=null,i=o*f)}i*=this._updateTimeScale(e);const d=this._updateTime(i),p=this._updateWeight(e);if(p>0){const f=this._interpolants,y=this._propertyBindings;switch(this.blendMode){case s6:for(let _=0,x=f.length;_!==x;++_)f[_].evaluate(d),y[_].accumulateAdditive(p);break;case BT:default:for(let _=0,x=f.length;_!==x;++_)f[_].evaluate(d),y[_].accumulate(s,p)}}}_updateWeight(e){let i=0;if(this.enabled){i=this.weight;const o=this._weightInterpolant;if(o!==null){const s=o.evaluate(e)[0];i*=s,e>o.parameterPositions[1]&&(this.stopFading(),s===0&&(this.enabled=!1))}}return this._effectiveWeight=i,i}_updateTimeScale(e){let i=0;if(!this.paused){i=this.timeScale;const o=this._timeScaleInterpolant;if(o!==null){const s=o.evaluate(e)[0];i*=s,e>o.parameterPositions[1]&&(this.stopWarping(),i===0?this.paused=!0:this.timeScale=i)}}return this._effectiveTimeScale=i,i}_updateTime(e){const i=this._clip.duration,o=this.loop;let s=this.time+e,l=this._loopCount;const d=o===FX;if(e===0)return l===-1?s:d&&(l&1)===1?i-s:s;if(o===NX){l===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(s>=i)s=i;else if(s<0)s=0;else{this.time=s;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=s,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(l===-1&&(e>=0?(l=0,this._setEndings(!0,this.repetitions===0,d)):this._setEndings(this.repetitions===0,!0,d)),s>=i||s<0){const p=Math.floor(s/i);s-=i*p,l+=Math.abs(p);const f=this.repetitions-l;if(f<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,s=e>0?i:0,this.time=s,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(f===1){const y=e<0;this._setEndings(y,!y,d)}else this._setEndings(!1,!1,d);this._loopCount=l,this.time=s,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:p})}}else this.time=s;if(d&&(l&1)===1)return i-s}return s}_setEndings(e,i,o){const s=this._interpolantSettings;o?(s.endingStart=fg,s.endingEnd=fg):(e?s.endingStart=this.zeroSlopeAtStart?fg:pg:s.endingStart=sw,i?s.endingEnd=this.zeroSlopeAtEnd?fg:pg:s.endingEnd=sw)}_scheduleFading(e,i,o){const s=this._mixer,l=s.time;let d=this._weightInterpolant;d===null&&(d=s._lendControlInterpolant(),this._weightInterpolant=d);const p=d.parameterPositions,f=d.sampleValues;return p[0]=l,f[0]=i,p[1]=l+e,f[1]=o,this}}const fAe=new Float32Array(1);class mAe extends Td{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,i){const o=e._localRoot||this._root,s=e._clip.tracks,l=s.length,d=e._propertyBindings,p=e._interpolants,f=o.uuid,y=this._bindingsByRootAndName;let _=y[f];_===void 0&&(_={},y[f]=_);for(let x=0;x!==l;++x){const S=s[x],T=S.name;let I=_[T];if(I!==void 0)++I.referenceCount,d[x]=I;else{if(I=d[x],I!==void 0){I._cacheIndex===null&&(++I.referenceCount,this._addInactiveBinding(I,f,T));continue}const R=i&&i._propertyBindings[x].binding.parsedPath;I=new tK(ca.create(o,T,R),S.ValueTypeName,S.getValueSize()),++I.referenceCount,this._addInactiveBinding(I,f,T),d[x]=I}p[x].resultBuffer=I.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(e._cacheIndex===null){const o=(e._localRoot||this._root).uuid,s=e._clip.uuid,l=this._actionsByClip[s];this._bindAction(e,l&&l.knownActions[0]),this._addInactiveAction(e,s,o)}const i=e._propertyBindings;for(let o=0,s=i.length;o!==s;++o){const l=i[o];l.useCount++===0&&(this._lendBinding(l),l.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const i=e._propertyBindings;for(let o=0,s=i.length;o!==s;++o){const l=i[o];--l.useCount===0&&(l.restoreOriginalState(),this._takeBackBinding(l))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const i=e._cacheIndex;return i!==null&&i<this._nActiveActions}_addInactiveAction(e,i,o){const s=this._actions,l=this._actionsByClip;let d=l[i];if(d===void 0)d={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,l[i]=d;else{const p=d.knownActions;e._byClipCacheIndex=p.length,p.push(e)}e._cacheIndex=s.length,s.push(e),d.actionByRoot[o]=e}_removeInactiveAction(e){const i=this._actions,o=i[i.length-1],s=e._cacheIndex;o._cacheIndex=s,i[s]=o,i.pop(),e._cacheIndex=null;const l=e._clip.uuid,d=this._actionsByClip,p=d[l],f=p.knownActions,y=f[f.length-1],_=e._byClipCacheIndex;y._byClipCacheIndex=_,f[_]=y,f.pop(),e._byClipCacheIndex=null;const x=p.actionByRoot,S=(e._localRoot||this._root).uuid;delete x[S],f.length===0&&delete d[l],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const i=e._propertyBindings;for(let o=0,s=i.length;o!==s;++o){const l=i[o];--l.referenceCount===0&&this._removeInactiveBinding(l)}}_lendAction(e){const i=this._actions,o=e._cacheIndex,s=this._nActiveActions++,l=i[s];e._cacheIndex=s,i[s]=e,l._cacheIndex=o,i[o]=l}_takeBackAction(e){const i=this._actions,o=e._cacheIndex,s=--this._nActiveActions,l=i[s];e._cacheIndex=s,i[s]=e,l._cacheIndex=o,i[o]=l}_addInactiveBinding(e,i,o){const s=this._bindingsByRootAndName,l=this._bindings;let d=s[i];d===void 0&&(d={},s[i]=d),d[o]=e,e._cacheIndex=l.length,l.push(e)}_removeInactiveBinding(e){const i=this._bindings,o=e.binding,s=o.rootNode.uuid,l=o.path,d=this._bindingsByRootAndName,p=d[s],f=i[i.length-1],y=e._cacheIndex;f._cacheIndex=y,i[y]=f,i.pop(),delete p[l],Object.keys(p).length===0&&delete d[s]}_lendBinding(e){const i=this._bindings,o=e._cacheIndex,s=this._nActiveBindings++,l=i[s];e._cacheIndex=s,i[s]=e,l._cacheIndex=o,i[o]=l}_takeBackBinding(e){const i=this._bindings,o=e._cacheIndex,s=--this._nActiveBindings,l=i[s];e._cacheIndex=s,i[s]=e,l._cacheIndex=o,i[o]=l}_lendControlInterpolant(){const e=this._controlInterpolants,i=this._nActiveControlInterpolants++;let o=e[i];return o===void 0&&(o=new P6(new Float32Array(2),new Float32Array(2),1,fAe),o.__cacheIndex=i,e[i]=o),o}_takeBackControlInterpolant(e){const i=this._controlInterpolants,o=e.__cacheIndex,s=--this._nActiveControlInterpolants,l=i[s];e.__cacheIndex=s,i[s]=e,l.__cacheIndex=o,i[o]=l}clipAction(e,i,o){const s=i||this._root,l=s.uuid;let d=typeof e=="string"?bw.findByName(s,e):e;const p=d!==null?d.uuid:e,f=this._actionsByClip[p];let y=null;if(o===void 0&&(d!==null?o=d.blendMode:o=BT),f!==void 0){const x=f.actionByRoot[l];if(x!==void 0&&x.blendMode===o)return x;y=f.knownActions[0],d===null&&(d=y._clip)}if(d===null)return null;const _=new nK(this,d,i,o);return this._bindAction(_,y),this._addInactiveAction(_,p,l),_}existingAction(e,i){const o=i||this._root,s=o.uuid,l=typeof e=="string"?bw.findByName(o,e):e,d=l?l.uuid:e,p=this._actionsByClip[d];return p!==void 0&&p.actionByRoot[s]||null}stopAllAction(){const e=this._actions,i=this._nActiveActions;for(let o=i-1;o>=0;--o)e[o].stop();return this}update(e){e*=this.timeScale;const i=this._actions,o=this._nActiveActions,s=this.time+=e,l=Math.sign(e),d=this._accuIndex^=1;for(let y=0;y!==o;++y)i[y]._update(s,e,l,d);const p=this._bindings,f=this._nActiveBindings;for(let y=0;y!==f;++y)p[y].apply(d);return this}setTime(e){this.time=0;for(let i=0;i<this._actions.length;i++)this._actions[i].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const i=this._actions,o=e.uuid,s=this._actionsByClip,l=s[o];if(l!==void 0){const d=l.knownActions;for(let p=0,f=d.length;p!==f;++p){const y=d[p];this._deactivateAction(y);const _=y._cacheIndex,x=i[i.length-1];y._cacheIndex=null,y._byClipCacheIndex=null,x._cacheIndex=_,i[_]=x,i.pop(),this._removeInactiveBindingsForAction(y)}delete s[o]}}uncacheRoot(e){const i=e.uuid,o=this._actionsByClip;for(const d in o){const p=o[d].actionByRoot,f=p[i];f!==void 0&&(this._deactivateAction(f),this._removeInactiveAction(f))}const s=this._bindingsByRootAndName,l=s[i];if(l!==void 0)for(const d in l){const p=l[d];p.restoreOriginalState(),this._removeInactiveBinding(p)}}uncacheAction(e,i){const o=this.existingAction(e,i);o!==null&&(this._deactivateAction(o),this._removeInactiveAction(o))}}class F6{constructor(e){this.value=e}clone(){return new F6(this.value.clone===void 0?this.value:this.value.clone())}}let gAe=0;class yAe extends Td{constructor(){super(),this.isUniformsGroup=!0,Object.defineProperty(this,"id",{value:gAe++}),this.name="",this.usage=dw,this.uniforms=[]}add(e){return this.uniforms.push(e),this}remove(e){const i=this.uniforms.indexOf(e);return i!==-1&&this.uniforms.splice(i,1),this}setName(e){return this.name=e,this}setUsage(e){return this.usage=e,this}dispose(){return this.dispatchEvent({type:"dispose"}),this}copy(e){this.name=e.name,this.usage=e.usage;const i=e.uniforms;this.uniforms.length=0;for(let o=0,s=i.length;o<s;o++)this.uniforms.push(i[o].clone());return this}clone(){return new this.constructor().copy(this)}}class vAe extends qT{constructor(e,i,o=1){super(e,i),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=o}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const i=super.clone(e);return i.meshPerAttribute=this.meshPerAttribute,i}toJSON(e){const i=super.toJSON(e);return i.isInstancedInterleavedBuffer=!0,i.meshPerAttribute=this.meshPerAttribute,i}}class _Ae{constructor(e,i,o,s,l){this.isGLBufferAttribute=!0,this.name="",this.buffer=e,this.type=i,this.itemSize=o,this.elementSize=s,this.count=l,this.version=0}set needsUpdate(e){e===!0&&this.version++}setBuffer(e){return this.buffer=e,this}setType(e,i){return this.type=e,this.elementSize=i,this}setItemSize(e){return this.itemSize=e,this}setCount(e){return this.count=e,this}}class iK{constructor(e,i,o=0,s=1/0){this.ray=new Kg(e,i),this.near=o,this.far=s,this.camera=null,this.layers=new Eg,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,i){this.ray.set(e,i)}setFromCamera(e,i){i.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(i.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(i).sub(this.ray.origin).normalize(),this.camera=i):i.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(i.near+i.far)/(i.near-i.far)).unproject(i),this.ray.direction.set(0,0,-1).transformDirection(i.matrixWorld),this.camera=i):console.error("THREE.Raycaster: Unsupported camera type: "+i.type)}intersectObject(e,i=!0,o=[]){return FR(e,this,o,i),o.sort(OV),o}intersectObjects(e,i=!0,o=[]){for(let s=0,l=e.length;s<l;s++)FR(e[s],this,o,i);return o.sort(OV),o}}function OV(n,e){return n.distance-e.distance}function FR(n,e,i,o){if(n.layers.test(e.layers)&&n.raycast(e,i),o===!0){const s=n.children;for(let l=0,d=s.length;l<d;l++)FR(s[l],e,i,!0)}}class BR{constructor(e=1,i=0,o=0){return this.radius=e,this.phi=i,this.theta=o,this}set(e,i,o){return this.radius=e,this.phi=i,this.theta=o,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,i,o){return this.radius=Math.sqrt(e*e+i*i+o*o),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,o),this.phi=Math.acos(Yr(i/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}class bAe{constructor(e=1,i=0,o=0){return this.radius=e,this.theta=i,this.y=o,this}set(e,i,o){return this.radius=e,this.theta=i,this.y=o,this}copy(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,i,o){return this.radius=Math.sqrt(e*e+o*o),this.theta=Math.atan2(e,o),this.y=i,this}clone(){return new this.constructor().copy(this)}}const NV=new tn;class xAe{constructor(e=new tn(1/0,1/0),i=new tn(-1/0,-1/0)){this.isBox2=!0,this.min=e,this.max=i}set(e,i){return this.min.copy(e),this.max.copy(i),this}setFromPoints(e){this.makeEmpty();for(let i=0,o=e.length;i<o;i++)this.expandByPoint(e[i]);return this}setFromCenterAndSize(e,i){const o=NV.copy(i).multiplyScalar(.5);return this.min.copy(e).sub(o),this.max.copy(e).add(o),this}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,i){return i.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)}clampPoint(e,i){return i.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,NV).distanceTo(e)}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const zV=new Ue,lA=new Ue;class wAe{constructor(e=new Ue,i=new Ue){this.start=e,this.end=i}set(e,i){return this.start.copy(e),this.end.copy(i),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,i){return this.delta(i).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,i){zV.subVectors(e,this.start),lA.subVectors(this.end,this.start);const o=lA.dot(lA);let l=lA.dot(zV)/o;return i&&(l=Yr(l,0,1)),l}closestPointToPoint(e,i,o){const s=this.closestPointToPointParameter(e,i);return this.delta(o).multiplyScalar(s).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return new this.constructor().copy(this)}}const FV=new Ue;class SAe extends va{constructor(e,i){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=i,this.type="SpotLightHelper";const o=new ki,s=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let d=0,p=1,f=32;d<f;d++,p++){const y=d/f*Math.PI*2,_=p/f*Math.PI*2;s.push(Math.cos(y),Math.sin(y),1,Math.cos(_),Math.sin(_),1)}o.setAttribute("position",new Gn(s,3));const l=new qs({fog:!1,toneMapped:!1});this.cone=new Cd(o,l),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1);const e=this.light.distance?this.light.distance:1e3,i=e*Math.tan(this.light.angle);this.cone.scale.set(i,i,e),FV.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(FV),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const Gp=new Ue,cA=new Ri,iI=new Ri;class AAe extends Cd{constructor(e){const i=aK(e),o=new ki,s=[],l=[],d=new Pn(0,0,1),p=new Pn(0,1,0);for(let y=0;y<i.length;y++){const _=i[y];_.parent&&_.parent.isBone&&(s.push(0,0,0),s.push(0,0,0),l.push(d.r,d.g,d.b),l.push(p.r,p.g,p.b))}o.setAttribute("position",new Gn(s,3)),o.setAttribute("color",new Gn(l,3));const f=new qs({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});super(o,f),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=e,this.bones=i,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(e){const i=this.bones,o=this.geometry,s=o.getAttribute("position");iI.copy(this.root.matrixWorld).invert();for(let l=0,d=0;l<i.length;l++){const p=i[l];p.parent&&p.parent.isBone&&(cA.multiplyMatrices(iI,p.matrixWorld),Gp.setFromMatrixPosition(cA),s.setXYZ(d,Gp.x,Gp.y,Gp.z),cA.multiplyMatrices(iI,p.parent.matrixWorld),Gp.setFromMatrixPosition(cA),s.setXYZ(d+1,Gp.x,Gp.y,Gp.z),d+=2)}o.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose()}}function aK(n){const e=[];n.isBone===!0&&e.push(n);for(let i=0;i<n.children.length;i++)e.push.apply(e,aK(n.children[i]));return e}class EAe extends wo{constructor(e,i,o){const s=new Qw(i,4,2),l=new qh({wireframe:!0,fog:!1,toneMapped:!1});super(s,l),this.light=e,this.color=o,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const MAe=new Ue,BV=new Pn,UV=new Pn;class TAe extends va{constructor(e,i,o){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=o,this.type="HemisphereLightHelper";const s=new Jw(i);s.rotateY(Math.PI*.5),this.material=new qh({wireframe:!0,fog:!1,toneMapped:!1}),this.color===void 0&&(this.material.vertexColors=!0);const l=s.getAttribute("position"),d=new Float32Array(l.count*3);s.setAttribute("color",new Za(d,3)),this.add(new wo(s,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const e=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{const i=e.geometry.getAttribute("color");BV.copy(this.light.color),UV.copy(this.light.groundColor);for(let o=0,s=i.count;o<s;o++){const l=o<s/2?BV:UV;i.setXYZ(o,l.r,l.g,l.b)}i.needsUpdate=!0}this.light.updateWorldMatrix(!0,!1),e.lookAt(MAe.setFromMatrixPosition(this.light.matrixWorld).negate())}}class CAe extends Cd{constructor(e=10,i=10,o=4473924,s=8947848){o=new Pn(o),s=new Pn(s);const l=i/2,d=e/i,p=e/2,f=[],y=[];for(let S=0,T=0,I=-p;S<=i;S++,I+=d){f.push(-p,0,I,p,0,I),f.push(I,0,-p,I,0,p);const R=S===l?o:s;R.toArray(y,T),T+=3,R.toArray(y,T),T+=3,R.toArray(y,T),T+=3,R.toArray(y,T),T+=3}const _=new ki;_.setAttribute("position",new Gn(f,3)),_.setAttribute("color",new Gn(y,3));const x=new qs({vertexColors:!0,toneMapped:!1});super(_,x),this.type="GridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}class PAe extends Cd{constructor(e=10,i=16,o=8,s=64,l=4473924,d=8947848){l=new Pn(l),d=new Pn(d);const p=[],f=[];if(i>1)for(let x=0;x<i;x++){const S=x/i*(Math.PI*2),T=Math.sin(S)*e,I=Math.cos(S)*e;p.push(0,0,0),p.push(T,0,I);const R=x&1?l:d;f.push(R.r,R.g,R.b),f.push(R.r,R.g,R.b)}for(let x=0;x<o;x++){const S=x&1?l:d,T=e-e/o*x;for(let I=0;I<s;I++){let R=I/s*(Math.PI*2),D=Math.sin(R)*T,L=Math.cos(R)*T;p.push(D,0,L),f.push(S.r,S.g,S.b),R=(I+1)/s*(Math.PI*2),D=Math.sin(R)*T,L=Math.cos(R)*T,p.push(D,0,L),f.push(S.r,S.g,S.b)}}const y=new ki;y.setAttribute("position",new Gn(p,3)),y.setAttribute("color",new Gn(f,3));const _=new qs({vertexColors:!0,toneMapped:!1});super(y,_),this.type="PolarGridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}const WV=new Ue,uA=new Ue,VV=new Ue;class IAe extends va{constructor(e,i,o){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=o,this.type="DirectionalLightHelper",i===void 0&&(i=1);let s=new ki;s.setAttribute("position",new Gn([-i,i,0,i,i,0,i,-i,0,-i,-i,0,-i,i,0],3));const l=new qs({fog:!1,toneMapped:!1});this.lightPlane=new Af(s,l),this.add(this.lightPlane),s=new ki,s.setAttribute("position",new Gn([0,0,0,0,0,1],3)),this.targetLine=new Af(s,l),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),WV.setFromMatrixPosition(this.light.matrixWorld),uA.setFromMatrixPosition(this.light.target.matrixWorld),VV.subVectors(uA,WV),this.lightPlane.lookAt(uA),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(uA),this.targetLine.scale.z=VV.length()}}const dA=new Ue,Vr=new Xw;class LAe extends Cd{constructor(e){const i=new ki,o=new qs({color:16777215,vertexColors:!0,toneMapped:!1}),s=[],l=[],d={};p("n1","n2"),p("n2","n4"),p("n4","n3"),p("n3","n1"),p("f1","f2"),p("f2","f4"),p("f4","f3"),p("f3","f1"),p("n1","f1"),p("n2","f2"),p("n3","f3"),p("n4","f4"),p("p","n1"),p("p","n2"),p("p","n3"),p("p","n4"),p("u1","u2"),p("u2","u3"),p("u3","u1"),p("c","t"),p("p","c"),p("cn1","cn2"),p("cn3","cn4"),p("cf1","cf2"),p("cf3","cf4");function p(I,R){f(I),f(R)}function f(I){s.push(0,0,0),l.push(0,0,0),d[I]===void 0&&(d[I]=[]),d[I].push(s.length/3-1)}i.setAttribute("position",new Gn(s,3)),i.setAttribute("color",new Gn(l,3)),super(i,o),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=d,this.update();const y=new Pn(16755200),_=new Pn(16711680),x=new Pn(43775),S=new Pn(16777215),T=new Pn(3355443);this.setColors(y,_,x,S,T)}setColors(e,i,o,s,l){const p=this.geometry.getAttribute("color");p.setXYZ(0,e.r,e.g,e.b),p.setXYZ(1,e.r,e.g,e.b),p.setXYZ(2,e.r,e.g,e.b),p.setXYZ(3,e.r,e.g,e.b),p.setXYZ(4,e.r,e.g,e.b),p.setXYZ(5,e.r,e.g,e.b),p.setXYZ(6,e.r,e.g,e.b),p.setXYZ(7,e.r,e.g,e.b),p.setXYZ(8,e.r,e.g,e.b),p.setXYZ(9,e.r,e.g,e.b),p.setXYZ(10,e.r,e.g,e.b),p.setXYZ(11,e.r,e.g,e.b),p.setXYZ(12,e.r,e.g,e.b),p.setXYZ(13,e.r,e.g,e.b),p.setXYZ(14,e.r,e.g,e.b),p.setXYZ(15,e.r,e.g,e.b),p.setXYZ(16,e.r,e.g,e.b),p.setXYZ(17,e.r,e.g,e.b),p.setXYZ(18,e.r,e.g,e.b),p.setXYZ(19,e.r,e.g,e.b),p.setXYZ(20,e.r,e.g,e.b),p.setXYZ(21,e.r,e.g,e.b),p.setXYZ(22,e.r,e.g,e.b),p.setXYZ(23,e.r,e.g,e.b),p.setXYZ(24,i.r,i.g,i.b),p.setXYZ(25,i.r,i.g,i.b),p.setXYZ(26,i.r,i.g,i.b),p.setXYZ(27,i.r,i.g,i.b),p.setXYZ(28,i.r,i.g,i.b),p.setXYZ(29,i.r,i.g,i.b),p.setXYZ(30,i.r,i.g,i.b),p.setXYZ(31,i.r,i.g,i.b),p.setXYZ(32,o.r,o.g,o.b),p.setXYZ(33,o.r,o.g,o.b),p.setXYZ(34,o.r,o.g,o.b),p.setXYZ(35,o.r,o.g,o.b),p.setXYZ(36,o.r,o.g,o.b),p.setXYZ(37,o.r,o.g,o.b),p.setXYZ(38,s.r,s.g,s.b),p.setXYZ(39,s.r,s.g,s.b),p.setXYZ(40,l.r,l.g,l.b),p.setXYZ(41,l.r,l.g,l.b),p.setXYZ(42,l.r,l.g,l.b),p.setXYZ(43,l.r,l.g,l.b),p.setXYZ(44,l.r,l.g,l.b),p.setXYZ(45,l.r,l.g,l.b),p.setXYZ(46,l.r,l.g,l.b),p.setXYZ(47,l.r,l.g,l.b),p.setXYZ(48,l.r,l.g,l.b),p.setXYZ(49,l.r,l.g,l.b),p.needsUpdate=!0}update(){const e=this.geometry,i=this.pointMap,o=1,s=1;Vr.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),ao("c",i,e,Vr,0,0,-1),ao("t",i,e,Vr,0,0,1),ao("n1",i,e,Vr,-o,-s,-1),ao("n2",i,e,Vr,o,-s,-1),ao("n3",i,e,Vr,-o,s,-1),ao("n4",i,e,Vr,o,s,-1),ao("f1",i,e,Vr,-o,-s,1),ao("f2",i,e,Vr,o,-s,1),ao("f3",i,e,Vr,-o,s,1),ao("f4",i,e,Vr,o,s,1),ao("u1",i,e,Vr,o*.7,s*1.1,-1),ao("u2",i,e,Vr,-o*.7,s*1.1,-1),ao("u3",i,e,Vr,0,s*2,-1),ao("cf1",i,e,Vr,-o,0,1),ao("cf2",i,e,Vr,o,0,1),ao("cf3",i,e,Vr,0,-s,1),ao("cf4",i,e,Vr,0,s,1),ao("cn1",i,e,Vr,-o,0,-1),ao("cn2",i,e,Vr,o,0,-1),ao("cn3",i,e,Vr,0,-s,-1),ao("cn4",i,e,Vr,0,s,-1),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function ao(n,e,i,o,s,l,d){dA.set(s,l,d).unproject(o);const p=e[n];if(p!==void 0){const f=i.getAttribute("position");for(let y=0,_=p.length;y<_;y++)f.setXYZ(p[y],dA.x,dA.y,dA.z)}}const hA=new _u;class RAe extends Cd{constructor(e,i=16776960){const o=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),s=new Float32Array(8*3),l=new ki;l.setIndex(new Za(o,1)),l.setAttribute("position",new Za(s,3)),super(l,new qs({color:i,toneMapped:!1})),this.object=e,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(e){if(e!==void 0&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),this.object!==void 0&&hA.setFromObject(this.object),hA.isEmpty())return;const i=hA.min,o=hA.max,s=this.geometry.attributes.position,l=s.array;l[0]=o.x,l[1]=o.y,l[2]=o.z,l[3]=i.x,l[4]=o.y,l[5]=o.z,l[6]=i.x,l[7]=i.y,l[8]=o.z,l[9]=o.x,l[10]=i.y,l[11]=o.z,l[12]=o.x,l[13]=o.y,l[14]=i.z,l[15]=i.x,l[16]=o.y,l[17]=i.z,l[18]=i.x,l[19]=i.y,l[20]=i.z,l[21]=o.x,l[22]=i.y,l[23]=i.z,s.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(e){return this.object=e,this.update(),this}copy(e,i){return super.copy(e,i),this.object=e.object,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class kAe extends Cd{constructor(e,i=16776960){const o=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),s=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],l=new ki;l.setIndex(new Za(o,1)),l.setAttribute("position",new Gn(s,3)),super(l,new qs({color:i,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){const i=this.box;i.isEmpty()||(i.getCenter(this.position),i.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}dispose(){this.geometry.dispose(),this.material.dispose()}}class DAe extends Af{constructor(e,i=1,o=16776960){const s=o,l=[1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],d=new ki;d.setAttribute("position",new Gn(l,3)),d.computeBoundingSphere(),super(d,new qs({color:s,toneMapped:!1})),this.type="PlaneHelper",this.plane=e,this.size=i;const p=[1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],f=new ki;f.setAttribute("position",new Gn(p,3)),f.computeBoundingSphere(),this.add(new wo(f,new qh({color:s,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(e){this.position.set(0,0,0),this.scale.set(.5*this.size,.5*this.size,1),this.lookAt(this.plane.normal),this.translateZ(-this.plane.constant),super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}}const GV=new Ue;let pA,aI;class OAe extends va{constructor(e=new Ue(0,0,1),i=new Ue(0,0,0),o=1,s=16776960,l=o*.2,d=l*.2){super(),this.type="ArrowHelper",pA===void 0&&(pA=new ki,pA.setAttribute("position",new Gn([0,0,0,0,1,0],3)),aI=new E_(0,.5,1,5,1),aI.translate(0,-.5,0)),this.position.copy(i),this.line=new Af(pA,new qs({color:s,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new wo(aI,new qh({color:s,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(o,l,d)}setDirection(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{GV.set(e.z,0,-e.x).normalize();const i=Math.acos(e.y);this.quaternion.setFromAxisAngle(GV,i)}}setLength(e,i=e*.2,o=i*.2){this.line.scale.set(1,Math.max(1e-4,e-i),1),this.line.updateMatrix(),this.cone.scale.set(o,i,o),this.cone.position.y=e,this.cone.updateMatrix()}setColor(e){this.line.material.color.set(e),this.cone.material.color.set(e)}copy(e){return super.copy(e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}dispose(){this.line.geometry.dispose(),this.line.material.dispose(),this.cone.geometry.dispose(),this.cone.material.dispose()}}class NAe extends Cd{constructor(e=1){const i=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],o=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],s=new ki;s.setAttribute("position",new Gn(i,3)),s.setAttribute("color",new Gn(o,3));const l=new qs({vertexColors:!0,toneMapped:!1});super(s,l),this.type="AxesHelper"}setColors(e,i,o){const s=new Pn,l=this.geometry.attributes.color.array;return s.set(e),s.toArray(l,0),s.toArray(l,3),s.set(i),s.toArray(l,6),s.toArray(l,9),s.set(o),s.toArray(l,12),s.toArray(l,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class zAe{constructor(){this.type="ShapePath",this.color=new Pn,this.subPaths=[],this.currentPath=null}moveTo(e,i){return this.currentPath=new fw,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,i),this}lineTo(e,i){return this.currentPath.lineTo(e,i),this}quadraticCurveTo(e,i,o,s){return this.currentPath.quadraticCurveTo(e,i,o,s),this}bezierCurveTo(e,i,o,s,l,d){return this.currentPath.bezierCurveTo(e,i,o,s,l,d),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e){function i(L){const O=[];for(let N=0,F=L.length;N<F;N++){const G=L[N],j=new Mg;j.curves=G.curves,O.push(j)}return O}function o(L,O){const N=O.length;let F=!1;for(let G=N-1,j=0;j<N;G=j++){let Y=O[G],te=O[j],V=te.x-Y.x,Q=te.y-Y.y;if(Math.abs(Q)>Number.EPSILON){if(Q<0&&(Y=O[j],V=-V,te=O[G],Q=-Q),L.y<Y.y||L.y>te.y)continue;if(L.y===Y.y){if(L.x===Y.x)return!0}else{const he=Q*(L.x-Y.x)-V*(L.y-Y.y);if(he===0)return!0;if(he<0)continue;F=!F}}else{if(L.y!==Y.y)continue;if(te.x<=L.x&&L.x<=Y.x||Y.x<=L.x&&L.x<=te.x)return!0}}return F}const s=vd.isClockWise,l=this.subPaths;if(l.length===0)return[];let d,p,f;const y=[];if(l.length===1)return p=l[0],f=new Mg,f.curves=p.curves,y.push(f),y;let _=!s(l[0].getPoints());_=e?!_:_;const x=[],S=[];let T=[],I=0,R;S[I]=void 0,T[I]=[];for(let L=0,O=l.length;L<O;L++)p=l[L],R=p.getPoints(),d=s(R),d=e?!d:d,d?(!_&&S[I]&&I++,S[I]={s:new Mg,p:R},S[I].s.curves=p.curves,_&&I++,T[I]=[]):T[I].push({h:p,p:R[0]});if(!S[0])return i(l);if(S.length>1){let L=!1,O=0;for(let N=0,F=S.length;N<F;N++)x[N]=[];for(let N=0,F=S.length;N<F;N++){const G=T[N];for(let j=0;j<G.length;j++){const Y=G[j];let te=!0;for(let V=0;V<S.length;V++)o(Y.p,S[V].p)&&(N!==V&&O++,te?(te=!1,x[V].push(Y)):L=!0);te&&x[N].push(Y)}}O>0&&L===!1&&(T=x)}let D;for(let L=0,O=S.length;L<O;L++){f=S[L].s,y.push(f),D=T[L];for(let N=0,F=D.length;N<F;N++)f.holes.push(D[N].h)}return y}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:OT}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=OT);const FAe=Object.freeze(Object.defineProperty({__proto__:null,ACESFilmicToneMapping:QD,AddEquation:Zp,AddOperation:xX,AdditiveAnimationBlendMode:s6,AdditiveBlending:KL,AlphaFormat:PX,AlwaysCompare:qX,AlwaysDepth:fX,AlwaysStencilFunc:CR,AmbientLight:XZ,AnimationAction:nK,AnimationClip:bw,AnimationLoader:WSe,AnimationMixer:mAe,AnimationObjectGroup:pAe,AnimationUtils:zSe,ArcCurve:_Z,ArrayCamera:cZ,ArrowHelper:OAe,AttachedBindMode:nR,Audio:eK,AudioAnalyser:iAe,AudioContext:D6,AudioListener:eAe,AudioLoader:KSe,AxesHelper:NAe,BackSide:Ss,BasicDepthPacking:BX,BasicShadowMap:Zq,Bone:_6,BooleanKeyframeTrack:Qg,Box2:xAe,Box3:_u,Box3Helper:kAe,BoxGeometry:Jg,BoxHelper:RAe,BufferAttribute:Za,BufferGeometry:ki,BufferGeometryLoader:QZ,ByteType:TX,Cache:Gg,Camera:Xw,CameraHelper:LAe,CanvasTexture:sSe,CapsuleGeometry:JT,CatmullRomCurve3:bZ,CineonToneMapping:AX,CircleGeometry:QT,ClampToEdgeWrapping:bs,Clock:O6,Color:Pn,ColorKeyframeTrack:I6,ColorManagement:Ba,CompressedArrayTexture:rSe,CompressedCubeTexture:oSe,CompressedTexture:ZT,CompressedTextureLoader:VSe,ConeGeometry:eC,ConstantAlphaFactor:dX,ConstantColorFactor:cX,CubeCamera:tZ,CubeReflectionMapping:Hh,CubeRefractionMapping:wf,CubeTexture:Zw,CubeTextureLoader:GSe,CubeUVReflectionMapping:S_,CubicBezierCurve:w6,CubicBezierCurve3:xZ,CubicInterpolant:UZ,CullFaceBack:ZL,CullFaceFront:Xq,CullFaceFrontBack:i1e,CullFaceNone:qq,Curve:bu,CurvePath:SZ,CustomBlending:Kq,CustomToneMapping:EX,CylinderGeometry:E_,Cylindrical:bAe,Data3DTexture:h6,DataArrayTexture:WT,DataTexture:H0,DataTextureLoader:HSe,DataUtils:hbe,DecrementStencilOp:m1e,DecrementWrapStencilOp:y1e,DefaultLoadingManager:GZ,DepthFormat:mf,DepthStencilFormat:Bg,DepthTexture:uZ,DetachedBindMode:MX,DirectionalLight:qZ,DirectionalLightHelper:IAe,DiscreteInterpolant:WZ,DisplayP3ColorSpace:UT,DodecahedronGeometry:tC,DoubleSide:jl,DstAlphaFactor:aX,DstColorFactor:oX,DynamicCopyUsage:R1e,DynamicDrawUsage:M1e,DynamicReadUsage:P1e,EdgesGeometry:AZ,EllipseCurve:KT,EqualCompare:GX,EqualDepth:gX,EqualStencilFunc:x1e,EquirectangularReflectionMapping:tw,EquirectangularRefractionMapping:nw,Euler:qw,EventDispatcher:Td,ExtrudeGeometry:iC,FileLoader:jh,Float16BufferAttribute:vbe,Float32BufferAttribute:Gn,Float64BufferAttribute:_be,FloatType:ud,Fog:YT,FogExp2:$T,FramebufferTexture:aSe,FrontSide:wd,Frustum:VT,GLBufferAttribute:_Ae,GLSL1:D1e,GLSL3:PR,GreaterCompare:jX,GreaterDepth:vX,GreaterEqualCompare:YX,GreaterEqualDepth:yX,GreaterEqualStencilFunc:E1e,GreaterStencilFunc:S1e,GridHelper:CAe,Group:I0,HalfFloatType:u_,HemisphereLight:jZ,HemisphereLightHelper:TAe,IcosahedronGeometry:aC,ImageBitmapLoader:ZSe,ImageLoader:xw,ImageUtils:d6,IncrementStencilOp:f1e,IncrementWrapStencilOp:g1e,InstancedBufferAttribute:Wg,InstancedBufferGeometry:k6,InstancedInterleavedBuffer:vAe,InstancedMesh:gZ,Int16BufferAttribute:gbe,Int32BufferAttribute:ybe,Int8BufferAttribute:pbe,IntType:t6,InterleavedBuffer:qT,InterleavedBufferAttribute:Ug,Interpolant:e2,InterpolateDiscrete:rw,InterpolateLinear:ow,InterpolateSmooth:dE,InvertStencilOp:v1e,KeepStencilOp:ig,KeyframeTrack:xu,LOD:fZ,LatheGeometry:Kw,Layers:Eg,LessCompare:VX,LessDepth:mX,LessEqualCompare:HX,LessEqualDepth:ew,LessEqualStencilFunc:w1e,LessStencilFunc:b1e,Light:Df,LightProbe:JZ,Line:Af,Line3:wAe,LineBasicMaterial:qs,LineCurve:S6,LineCurve3:wZ,LineDashedMaterial:zZ,LineLoop:yZ,LineSegments:Cd,LinearDisplayP3ColorSpace:Yw,LinearEncoding:l6,LinearFilter:Lr,LinearInterpolant:P6,LinearMipMapLinearFilter:l1e,LinearMipMapNearestFilter:s1e,LinearMipmapLinearFilter:Sf,LinearMipmapNearestFilter:e6,LinearSRGBColorSpace:Sd,LinearToneMapping:wX,LinearTransfer:lw,Loader:Tl,LoaderUtils:zR,LoadingManager:L6,LoopOnce:NX,LoopPingPong:FX,LoopRepeat:zX,LuminanceAlphaFormat:LX,LuminanceFormat:IX,MOUSE:tg,Material:es,MaterialLoader:dC,MathUtils:q1e,Matrix3:Ui,Matrix4:Ri,MaxEquation:tR,Mesh:wo,MeshBasicMaterial:qh,MeshDepthMaterial:HT,MeshDistanceMaterial:jT,MeshLambertMaterial:OZ,MeshMatcapMaterial:NZ,MeshNormalMaterial:DZ,MeshPhongMaterial:RZ,MeshPhysicalMaterial:LZ,MeshStandardMaterial:T6,MeshToonMaterial:kZ,MinEquation:eR,MirroredRepeatWrapping:aw,MixOperation:bX,MultiplyBlending:QL,MultiplyOperation:$w,NearestFilter:so,NearestMipMapLinearFilter:o1e,NearestMipMapNearestFilter:r1e,NearestMipmapLinearFilter:px,NearestMipmapNearestFilter:sM,NeverCompare:WX,NeverDepth:pX,NeverStencilFunc:_1e,NoBlending:zh,NoColorSpace:$l,NoToneMapping:gd,NormalAnimationBlendMode:BT,NormalBlending:Sg,NotEqualCompare:$X,NotEqualDepth:_X,NotEqualStencilFunc:A1e,NumberKeyframeTrack:vw,Object3D:va,ObjectLoader:qSe,ObjectSpaceNormalMap:UX,OctahedronGeometry:Jw,OneFactor:tX,OneMinusConstantAlphaFactor:hX,OneMinusConstantColorFactor:uX,OneMinusDstAlphaFactor:rX,OneMinusDstColorFactor:sX,OneMinusSrcAlphaFactor:oM,OneMinusSrcColorFactor:iX,OrthographicCamera:Rh,P3Primaries:uw,PCFShadowMap:NT,PCFSoftShadowMap:hx,PMREMGenerator:LR,Path:fw,PerspectiveCamera:qr,Plane:Ah,PlaneGeometry:Rf,PlaneHelper:DAe,PointLight:YZ,PointLightHelper:EAe,Points:vZ,PointsMaterial:b6,PolarGridHelper:PAe,PolyhedronGeometry:kf,PositionalAudio:nAe,PropertyBinding:ca,PropertyMixer:tK,QuadraticBezierCurve:A6,QuadraticBezierCurve3:E6,Quaternion:As,QuaternionKeyframeTrack:M_,QuaternionLinearInterpolant:VZ,RED_GREEN_RGTC2_Format:MR,RED_RGTC1_Format:OX,REVISION:OT,RGBADepthPacking:c6,RGBAFormat:ml,RGBAIntegerFormat:o6,RGBA_ASTC_10x10_Format:bR,RGBA_ASTC_10x5_Format:yR,RGBA_ASTC_10x6_Format:vR,RGBA_ASTC_10x8_Format:_R,RGBA_ASTC_12x10_Format:xR,RGBA_ASTC_12x12_Format:wR,RGBA_ASTC_4x4_Format:cR,RGBA_ASTC_5x4_Format:uR,RGBA_ASTC_5x5_Format:dR,RGBA_ASTC_6x5_Format:hR,RGBA_ASTC_6x6_Format:pR,RGBA_ASTC_8x5_Format:fR,RGBA_ASTC_8x6_Format:mR,RGBA_ASTC_8x8_Format:gR,RGBA_BPTC_Format:uE,RGBA_ETC2_EAC_Format:lR,RGBA_PVRTC_2BPPV1_Format:oR,RGBA_PVRTC_4BPPV1_Format:rR,RGBA_S3TC_DXT1_Format:sE,RGBA_S3TC_DXT3_Format:lE,RGBA_S3TC_DXT5_Format:cE,RGB_BPTC_SIGNED_Format:SR,RGB_BPTC_UNSIGNED_Format:AR,RGB_ETC1_Format:DX,RGB_ETC2_Format:sR,RGB_PVRTC_2BPPV1_Format:aR,RGB_PVRTC_4BPPV1_Format:iR,RGB_S3TC_DXT1_Format:oE,RGFormat:kX,RGIntegerFormat:r6,RawShaderMaterial:IZ,Ray:Kg,Raycaster:iK,Rec709Primaries:cw,RectAreaLight:ZZ,RedFormat:RX,RedIntegerFormat:a6,ReinhardToneMapping:SX,RenderTarget:JX,RepeatWrapping:iw,ReplaceStencilOp:p1e,ReverseSubtractEquation:Qq,RingGeometry:rC,SIGNED_RED_GREEN_RGTC2_Format:TR,SIGNED_RED_RGTC1_Format:ER,SRGBColorSpace:Io,SRGBTransfer:tr,Scene:uM,ShaderChunk:zi,ShaderLib:lu,ShaderMaterial:Ad,ShadowMaterial:PZ,Shape:Mg,ShapeGeometry:oC,ShapePath:zAe,ShapeUtils:vd,ShortType:CX,Skeleton:XT,SkeletonHelper:AAe,SkinnedMesh:mZ,Source:mg,Sphere:Rc,SphereGeometry:Qw,Spherical:BR,SphericalHarmonics3:KZ,SplineCurve:M6,SpotLight:$Z,SpotLightHelper:SAe,Sprite:pZ,SpriteMaterial:v6,SrcAlphaFactor:rM,SrcAlphaSaturateFactor:lX,SrcColorFactor:nX,StaticCopyUsage:L1e,StaticDrawUsage:dw,StaticReadUsage:C1e,StereoCamera:JSe,StreamCopyUsage:k1e,StreamDrawUsage:T1e,StreamReadUsage:I1e,StringKeyframeTrack:ey,SubtractEquation:Jq,SubtractiveBlending:JL,TOUCH:ng,TangentSpaceNormalMap:Lf,TetrahedronGeometry:sC,Texture:Or,TextureLoader:HZ,TorusGeometry:lC,TorusKnotGeometry:cC,Triangle:fl,TriangleFanDrawMode:d1e,TriangleStripDrawMode:u1e,TrianglesDrawMode:c1e,TubeGeometry:uC,TwoPassDoubleSide:a1e,UVMapping:zT,Uint16BufferAttribute:p6,Uint32BufferAttribute:f6,Uint8BufferAttribute:fbe,Uint8ClampedBufferAttribute:mbe,Uniform:F6,UniformsGroup:yAe,UniformsLib:wn,UniformsUtils:m6,UnsignedByteType:yd,UnsignedInt248Type:ff,UnsignedIntType:Lh,UnsignedShort4444Type:n6,UnsignedShort5551Type:i6,UnsignedShortType:FT,VSMShadowMap:au,Vector2:tn,Vector3:Ue,Vector4:Pa,VectorKeyframeTrack:_w,VideoTexture:iSe,WebGL1Renderer:dZ,WebGL3DRenderTarget:ebe,WebGLArrayRenderTarget:Q1e,WebGLCoordinateSystem:dd,WebGLCubeRenderTarget:nZ,WebGLMultipleRenderTargets:tbe,WebGLRenderTarget:yu,WebGLRenderer:y6,WebGLUtils:lZ,WebGPUCoordinateSystem:hw,WireframeGeometry:CZ,WrapAroundEnding:sw,ZeroCurvatureEnding:pg,ZeroFactor:eX,ZeroSlopeEnding:fg,ZeroStencilOp:h1e,_SRGBAFormat:lM,createCanvasElement:KX,sRGBEncoding:gf},Symbol.toStringTag,{value:"Module"}));var rK={exports:{}},ty={};/**
 * @license React
 * react-reconciler-constants.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */ty.ConcurrentRoot=1;ty.ContinuousEventPriority=4;ty.DefaultEventPriority=16;ty.DiscreteEventPriority=1;ty.IdleEventPriority=536870912;ty.LegacyRoot=0;rK.exports=ty;var R0=rK.exports;function BAe(n){let e;const i=new Set,o=(y,_)=>{const x=typeof y=="function"?y(e):y;if(x!==e){const S=e;e=_?x:Object.assign({},e,x),i.forEach(T=>T(e,S))}},s=()=>e,l=(y,_=s,x=Object.is)=>{console.warn("[DEPRECATED] Please use `subscribeWithSelector` middleware");let S=_(e);function T(){const I=_(e);if(!x(S,I)){const R=S;y(S=I,R)}}return i.add(T),()=>i.delete(T)},f={setState:o,getState:s,subscribe:(y,_,x)=>_||x?l(y,_,x):(i.add(y),()=>i.delete(y)),destroy:()=>i.clear()};return e=n(o,s,f),f}const UAe=typeof window>"u"||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent),HV=UAe?ie.useEffect:ie.useLayoutEffect;function WAe(n){const e=typeof n=="function"?BAe(n):n,i=(o=e.getState,s=Object.is)=>{const[,l]=ie.useReducer(D=>D+1,0),d=e.getState(),p=ie.useRef(d),f=ie.useRef(o),y=ie.useRef(s),_=ie.useRef(!1),x=ie.useRef();x.current===void 0&&(x.current=o(d));let S,T=!1;(p.current!==d||f.current!==o||y.current!==s||_.current)&&(S=o(d),T=!s(x.current,S)),HV(()=>{T&&(x.current=S),p.current=d,f.current=o,y.current=s,_.current=!1});const I=ie.useRef(d);HV(()=>{const D=()=>{try{const O=e.getState(),N=f.current(O);y.current(x.current,N)||(p.current=O,x.current=N,l())}catch{_.current=!0,l()}},L=e.subscribe(D);return e.getState()!==I.current&&D(),L},[]);const R=T?S:x.current;return ie.useDebugValue(R),R};return Object.assign(i,e),i[Symbol.iterator]=function(){console.warn("[useStore, api] = create() is deprecated and will be removed in v4");const o=[i,e];return{next(){const s=o.length<=0;return{value:o.shift(),done:s}}}},i}var oK={exports:{}},rI={exports:{}},oI={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var jV;function VAe(){return jV||(jV=1,function(n){function e(le,me){var xe=le.length;le.push(me);e:for(;0<xe;){var ae=xe-1>>>1,Ee=le[ae];if(0<s(Ee,me))le[ae]=me,le[xe]=Ee,xe=ae;else break e}}function i(le){return le.length===0?null:le[0]}function o(le){if(le.length===0)return null;var me=le[0],xe=le.pop();if(xe!==me){le[0]=xe;e:for(var ae=0,Ee=le.length,Je=Ee>>>1;ae<Je;){var Ze=2*(ae+1)-1,Ke=le[Ze],Fe=Ze+1,ct=le[Fe];if(0>s(Ke,xe))Fe<Ee&&0>s(ct,Ke)?(le[ae]=ct,le[Fe]=xe,ae=Fe):(le[ae]=Ke,le[Ze]=xe,ae=Ze);else if(Fe<Ee&&0>s(ct,xe))le[ae]=ct,le[Fe]=xe,ae=Fe;else break e}}return me}function s(le,me){var xe=le.sortIndex-me.sortIndex;return xe!==0?xe:le.id-me.id}if(typeof performance=="object"&&typeof performance.now=="function"){var l=performance;n.unstable_now=function(){return l.now()}}else{var d=Date,p=d.now();n.unstable_now=function(){return d.now()-p}}var f=[],y=[],_=1,x=null,S=3,T=!1,I=!1,R=!1,D=typeof setTimeout=="function"?setTimeout:null,L=typeof clearTimeout=="function"?clearTimeout:null,O=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function N(le){for(var me=i(y);me!==null;){if(me.callback===null)o(y);else if(me.startTime<=le)o(y),me.sortIndex=me.expirationTime,e(f,me);else break;me=i(y)}}function F(le){if(R=!1,N(le),!I)if(i(f)!==null)I=!0,Ie(G);else{var me=i(y);me!==null&&ze(F,me.startTime-le)}}function G(le,me){I=!1,R&&(R=!1,L(te),te=-1),T=!0;var xe=S;try{for(N(me),x=i(f);x!==null&&(!(x.expirationTime>me)||le&&!he());){var ae=x.callback;if(typeof ae=="function"){x.callback=null,S=x.priorityLevel;var Ee=ae(x.expirationTime<=me);me=n.unstable_now(),typeof Ee=="function"?x.callback=Ee:x===i(f)&&o(f),N(me)}else o(f);x=i(f)}if(x!==null)var Je=!0;else{var Ze=i(y);Ze!==null&&ze(F,Ze.startTime-me),Je=!1}return Je}finally{x=null,S=xe,T=!1}}var j=!1,Y=null,te=-1,V=5,Q=-1;function he(){return!(n.unstable_now()-Q<V)}function fe(){if(Y!==null){var le=n.unstable_now();Q=le;var me=!0;try{me=Y(!0,le)}finally{me?ye():(j=!1,Y=null)}}else j=!1}var ye;if(typeof O=="function")ye=function(){O(fe)};else if(typeof MessageChannel<"u"){var pe=new MessageChannel,Me=pe.port2;pe.port1.onmessage=fe,ye=function(){Me.postMessage(null)}}else ye=function(){D(fe,0)};function Ie(le){Y=le,j||(j=!0,ye())}function ze(le,me){te=D(function(){le(n.unstable_now())},me)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(le){le.callback=null},n.unstable_continueExecution=function(){I||T||(I=!0,Ie(G))},n.unstable_forceFrameRate=function(le){0>le||125<le?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):V=0<le?Math.floor(1e3/le):5},n.unstable_getCurrentPriorityLevel=function(){return S},n.unstable_getFirstCallbackNode=function(){return i(f)},n.unstable_next=function(le){switch(S){case 1:case 2:case 3:var me=3;break;default:me=S}var xe=S;S=me;try{return le()}finally{S=xe}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(le,me){switch(le){case 1:case 2:case 3:case 4:case 5:break;default:le=3}var xe=S;S=le;try{return me()}finally{S=xe}},n.unstable_scheduleCallback=function(le,me,xe){var ae=n.unstable_now();switch(typeof xe=="object"&&xe!==null?(xe=xe.delay,xe=typeof xe=="number"&&0<xe?ae+xe:ae):xe=ae,le){case 1:var Ee=-1;break;case 2:Ee=250;break;case 5:Ee=1073741823;break;case 4:Ee=1e4;break;default:Ee=5e3}return Ee=xe+Ee,le={id:_++,callback:me,priorityLevel:le,startTime:xe,expirationTime:Ee,sortIndex:-1},xe>ae?(le.sortIndex=xe,e(y,le),i(f)===null&&le===i(y)&&(R?(L(te),te=-1):R=!0,ze(F,xe-ae))):(le.sortIndex=Ee,e(f,le),I||T||(I=!0,Ie(G))),le},n.unstable_shouldYield=he,n.unstable_wrapCallback=function(le){var me=S;return function(){var xe=S;S=me;try{return le.apply(this,arguments)}finally{S=xe}}}}(oI)),oI}var $V;function GAe(){return $V||($V=1,rI.exports=VAe()),rI.exports}/**
 * @license React
 * react-reconciler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var HAe=function(e){var i={},o=ie,s=GAe(),l=Object.assign;function d(E){for(var M="https://reactjs.org/docs/error-decoder.html?invariant="+E,B=1;B<arguments.length;B++)M+="&args[]="+encodeURIComponent(arguments[B]);return"Minified React error #"+E+"; visit "+M+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var p=o.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,f=Symbol.for("react.element"),y=Symbol.for("react.portal"),_=Symbol.for("react.fragment"),x=Symbol.for("react.strict_mode"),S=Symbol.for("react.profiler"),T=Symbol.for("react.provider"),I=Symbol.for("react.context"),R=Symbol.for("react.forward_ref"),D=Symbol.for("react.suspense"),L=Symbol.for("react.suspense_list"),O=Symbol.for("react.memo"),N=Symbol.for("react.lazy"),F=Symbol.for("react.offscreen"),G=Symbol.iterator;function j(E){return E===null||typeof E!="object"?null:(E=G&&E[G]||E["@@iterator"],typeof E=="function"?E:null)}function Y(E){if(E==null)return null;if(typeof E=="function")return E.displayName||E.name||null;if(typeof E=="string")return E;switch(E){case _:return"Fragment";case y:return"Portal";case S:return"Profiler";case x:return"StrictMode";case D:return"Suspense";case L:return"SuspenseList"}if(typeof E=="object")switch(E.$$typeof){case I:return(E.displayName||"Context")+".Consumer";case T:return(E._context.displayName||"Context")+".Provider";case R:var M=E.render;return E=E.displayName,E||(E=M.displayName||M.name||"",E=E!==""?"ForwardRef("+E+")":"ForwardRef"),E;case O:return M=E.displayName||null,M!==null?M:Y(E.type)||"Memo";case N:M=E._payload,E=E._init;try{return Y(E(M))}catch{}}return null}function te(E){var M=E.type;switch(E.tag){case 24:return"Cache";case 9:return(M.displayName||"Context")+".Consumer";case 10:return(M._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return E=M.render,E=E.displayName||E.name||"",M.displayName||(E!==""?"ForwardRef("+E+")":"ForwardRef");case 7:return"Fragment";case 5:return M;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Y(M);case 8:return M===x?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof M=="function")return M.displayName||M.name||null;if(typeof M=="string")return M}return null}function V(E){var M=E,B=E;if(E.alternate)for(;M.return;)M=M.return;else{E=M;do M=E,M.flags&4098&&(B=M.return),E=M.return;while(E)}return M.tag===3?B:null}function Q(E){if(V(E)!==E)throw Error(d(188))}function he(E){var M=E.alternate;if(!M){if(M=V(E),M===null)throw Error(d(188));return M!==E?null:E}for(var B=E,H=M;;){var ee=B.return;if(ee===null)break;var oe=ee.alternate;if(oe===null){if(H=ee.return,H!==null){B=H;continue}break}if(ee.child===oe.child){for(oe=ee.child;oe;){if(oe===B)return Q(ee),E;if(oe===H)return Q(ee),M;oe=oe.sibling}throw Error(d(188))}if(B.return!==H.return)B=ee,H=oe;else{for(var Ye=!1,xt=ee.child;xt;){if(xt===B){Ye=!0,B=ee,H=oe;break}if(xt===H){Ye=!0,H=ee,B=oe;break}xt=xt.sibling}if(!Ye){for(xt=oe.child;xt;){if(xt===B){Ye=!0,B=oe,H=ee;break}if(xt===H){Ye=!0,H=oe,B=ee;break}xt=xt.sibling}if(!Ye)throw Error(d(189))}}if(B.alternate!==H)throw Error(d(190))}if(B.tag!==3)throw Error(d(188));return B.stateNode.current===B?E:M}function fe(E){return E=he(E),E!==null?ye(E):null}function ye(E){if(E.tag===5||E.tag===6)return E;for(E=E.child;E!==null;){var M=ye(E);if(M!==null)return M;E=E.sibling}return null}function pe(E){if(E.tag===5||E.tag===6)return E;for(E=E.child;E!==null;){if(E.tag!==4){var M=pe(E);if(M!==null)return M}E=E.sibling}return null}var Me=Array.isArray,Ie=e.getPublicInstance,ze=e.getRootHostContext,le=e.getChildHostContext,me=e.prepareForCommit,xe=e.resetAfterCommit,ae=e.createInstance,Ee=e.appendInitialChild,Je=e.finalizeInitialChildren,Ze=e.prepareUpdate,Ke=e.shouldSetTextContent,Fe=e.createTextInstance,ct=e.scheduleTimeout,Ct=e.cancelTimeout,kt=e.noTimeout,Kt=e.isPrimaryRenderer,At=e.supportsMutation,Pe=e.supportsPersistence,ft=e.supportsHydration,gt=e.getInstanceFromNode,_t=e.preparePortalMount,Be=e.getCurrentEventPriority,ue=e.detachDeletedInstance,se=e.supportsMicrotasks,_e=e.scheduleMicrotask,je=e.supportsTestSelectors,De=e.findFiberRoot,st=e.getBoundingRect,de=e.getTextContent,ne=e.isHiddenSubtree,Oe=e.matchAccessibilityRole,ut=e.setFocusIfFocusable,it=e.setupIntersectionObserver,lt=e.appendChild,Et=e.appendChildToContainer,Ut=e.commitTextUpdate,Wt=e.commitMount,Ht=e.commitUpdate,Dt=e.insertBefore,wt=e.insertInContainerBefore,Xt=e.removeChild,He=e.removeChildFromContainer,Pt=e.resetTextContent,qt=e.hideInstance,Nt=e.hideTextInstance,hn=e.unhideInstance,be=e.unhideTextInstance,Qe=e.clearContainer,we=e.cloneInstance,Te=e.createContainerChildSet,Ne=e.appendChildToContainerChildSet,et=e.finalizeContainerChildren,tt=e.replaceContainerChildren,vt=e.cloneHiddenInstance,ht=e.cloneHiddenTextInstance,dt=e.canHydrateInstance,Vt=e.canHydrateTextInstance,It=e.canHydrateSuspenseInstance,Qt=e.isSuspenseInstancePending,fn=e.isSuspenseInstanceFallback,en=e.registerSuspenseInstanceRetry,vn=e.getNextHydratableSibling,Vn=e.getFirstHydratableChild,ei=e.getFirstHydratableChildWithinContainer,xi=e.getFirstHydratableChildWithinSuspenseInstance,wi=e.hydrateInstance,pa=e.hydrateTextInstance,na=e.hydrateSuspenseInstance,Re=e.getNextHydratableInstanceAfterSuspenseInstance,bt=e.commitHydratedContainer,Ot=e.commitHydratedSuspenseInstance,Lt=e.clearSuspenseBoundary,zt=e.clearSuspenseBoundaryFromContainer,jt=e.shouldDeleteUnhydratedTailInstances,gn=e.didNotMatchHydratedContainerTextInstance,Xn=e.didNotMatchHydratedTextInstance,rn;function di(E){if(rn===void 0)try{throw Error()}catch(B){var M=B.stack.trim().match(/\n( *(at )?)/);rn=M&&M[1]||""}return`
`+rn+E}var gi=!1;function li(E,M){if(!E||gi)return"";gi=!0;var B=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(M)if(M=function(){throw Error()},Object.defineProperty(M.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(M,[])}catch(dn){var H=dn}Reflect.construct(E,[],M)}else{try{M.call()}catch(dn){H=dn}E.call(M.prototype)}else{try{throw Error()}catch(dn){H=dn}E()}}catch(dn){if(dn&&H&&typeof dn.stack=="string"){for(var ee=dn.stack.split(`
`),oe=H.stack.split(`
`),Ye=ee.length-1,xt=oe.length-1;1<=Ye&&0<=xt&&ee[Ye]!==oe[xt];)xt--;for(;1<=Ye&&0<=xt;Ye--,xt--)if(ee[Ye]!==oe[xt]){if(Ye!==1||xt!==1)do if(Ye--,xt--,0>xt||ee[Ye]!==oe[xt]){var Yt=`
`+ee[Ye].replace(" at new "," at ");return E.displayName&&Yt.includes("<anonymous>")&&(Yt=Yt.replace("<anonymous>",E.displayName)),Yt}while(1<=Ye&&0<=xt);break}}}finally{gi=!1,Error.prepareStackTrace=B}return(E=E?E.displayName||E.name:"")?di(E):""}var ra=Object.prototype.hasOwnProperty,wr=[],ia=-1;function Ka(E){return{current:E}}function ri(E){0>ia||(E.current=wr[ia],wr[ia]=null,ia--)}function Rn(E,M){ia++,wr[ia]=E.current,E.current=M}var uo={},Di=Ka(uo),Ia=Ka(!1),Go=uo;function Sr(E,M){var B=E.type.contextTypes;if(!B)return uo;var H=E.stateNode;if(H&&H.__reactInternalMemoizedUnmaskedChildContext===M)return H.__reactInternalMemoizedMaskedChildContext;var ee={},oe;for(oe in B)ee[oe]=M[oe];return H&&(E=E.stateNode,E.__reactInternalMemoizedUnmaskedChildContext=M,E.__reactInternalMemoizedMaskedChildContext=ee),ee}function Ja(E){return E=E.childContextTypes,E!=null}function fa(){ri(Ia),ri(Di)}function zr(E,M,B){if(Di.current!==uo)throw Error(d(168));Rn(Di,M),Rn(Ia,B)}function Cn(E,M,B){var H=E.stateNode;if(M=M.childContextTypes,typeof H.getChildContext!="function")return B;H=H.getChildContext();for(var ee in H)if(!(ee in M))throw Error(d(108,te(E)||"Unknown",ee));return l({},B,H)}function Jn(E){return E=(E=E.stateNode)&&E.__reactInternalMemoizedMergedChildContext||uo,Go=Di.current,Rn(Di,E),Rn(Ia,Ia.current),!0}function ja(E,M,B){var H=E.stateNode;if(!H)throw Error(d(169));B?(E=Cn(E,M,Go),H.__reactInternalMemoizedMergedChildContext=E,ri(Ia),ri(Di),Rn(Di,E)):ri(Ia),Rn(Ia,B)}var Ar=Math.clz32?Math.clz32:Nf,Ts=Math.log,wu=Math.LN2;function Nf(E){return E>>>=0,E===0?32:31-(Ts(E)/wu|0)|0}var ic=64,Cl=4194304;function Pl(E){switch(E&-E){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return E&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return E&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return E}}function Il(E,M){var B=E.pendingLanes;if(B===0)return 0;var H=0,ee=E.suspendedLanes,oe=E.pingedLanes,Ye=B&268435455;if(Ye!==0){var xt=Ye&~ee;xt!==0?H=Pl(xt):(oe&=Ye,oe!==0&&(H=Pl(oe)))}else Ye=B&~ee,Ye!==0?H=Pl(Ye):oe!==0&&(H=Pl(oe));if(H===0)return 0;if(M!==0&&M!==H&&!(M&ee)&&(ee=H&-H,oe=M&-M,ee>=oe||ee===16&&(oe&4194240)!==0))return M;if(H&4&&(H|=B&16),M=E.entangledLanes,M!==0)for(E=E.entanglements,M&=H;0<M;)B=31-Ar(M),ee=1<<B,H|=E[B],M&=~ee;return H}function Pd(E,M){switch(E){case 1:case 2:case 4:return M+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return M+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Zh(E,M){for(var B=E.suspendedLanes,H=E.pingedLanes,ee=E.expirationTimes,oe=E.pendingLanes;0<oe;){var Ye=31-Ar(oe),xt=1<<Ye,Yt=ee[Ye];Yt===-1?(!(xt&B)||xt&H)&&(ee[Ye]=Pd(xt,M)):Yt<=M&&(E.expiredLanes|=xt),oe&=~xt}}function ac(E){return E=E.pendingLanes&-1073741825,E!==0?E:E&1073741824?1073741824:0}function Id(E){for(var M=[],B=0;31>B;B++)M.push(E);return M}function Xs(E,M,B){E.pendingLanes|=M,M!==536870912&&(E.suspendedLanes=0,E.pingedLanes=0),E=E.eventTimes,M=31-Ar(M),E[M]=B}function $t(E,M){var B=E.pendingLanes&~M;E.pendingLanes=M,E.suspendedLanes=0,E.pingedLanes=0,E.expiredLanes&=M,E.mutableReadLanes&=M,E.entangledLanes&=M,M=E.entanglements;var H=E.eventTimes;for(E=E.expirationTimes;0<B;){var ee=31-Ar(B),oe=1<<ee;M[ee]=0,H[ee]=-1,E[ee]=-1,B&=~oe}}function bn(E,M){var B=E.entangledLanes|=M;for(E=E.entanglements;B;){var H=31-Ar(B),ee=1<<H;ee&M|E[H]&M&&(E[H]|=M),B&=~ee}}var Un=0;function at(E){return E&=-E,1<E?4<E?E&268435455?16:536870912:4:1}var ln=s.unstable_scheduleCallback,Zs=s.unstable_cancelCallback,Cs=s.unstable_shouldYield,Ga=s.unstable_requestPaint,oa=s.unstable_now,Ld=s.unstable_ImmediatePriority,Ps=s.unstable_UserBlockingPriority,Ao=s.unstable_NormalPriority,zf=s.unstable_IdlePriority,Ks=null,an=null;function yi(E){if(an&&typeof an.onCommitFiberRoot=="function")try{an.onCommitFiberRoot(Ks,E,void 0,(E.current.flags&128)===128)}catch{}}function Ei(E,M){return E===M&&(E!==0||1/E===1/M)||E!==E&&M!==M}var Qa=typeof Object.is=="function"?Object.is:Ei,Fr=null,oi=!1,Ho=!1;function kc(E){Fr===null?Fr=[E]:Fr.push(E)}function Dc(E){oi=!0,kc(E)}function Oa(){if(!Ho&&Fr!==null){Ho=!0;var E=0,M=Un;try{var B=Fr;for(Un=1;E<B.length;E++){var H=B[E];do H=H(!0);while(H!==null)}Fr=null,oi=!1}catch(ee){throw Fr!==null&&(Fr=Fr.slice(E+1)),ln(Ld,Oa),ee}finally{Un=M,Ho=!1}}return null}var ma=p.ReactCurrentBatchConfig;function Rd(E,M){if(Qa(E,M))return!0;if(typeof E!="object"||E===null||typeof M!="object"||M===null)return!1;var B=Object.keys(E),H=Object.keys(M);if(B.length!==H.length)return!1;for(H=0;H<B.length;H++){var ee=B[H];if(!ra.call(M,ee)||!Qa(E[ee],M[ee]))return!1}return!0}function Ll(E){switch(E.tag){case 5:return di(E.type);case 16:return di("Lazy");case 13:return di("Suspense");case 19:return di("SuspenseList");case 0:case 2:case 15:return E=li(E.type,!1),E;case 11:return E=li(E.type.render,!1),E;case 1:return E=li(E.type,!0),E;default:return""}}function Eo(E,M){if(E&&E.defaultProps){M=l({},M),E=E.defaultProps;for(var B in E)M[B]===void 0&&(M[B]=E[B]);return M}return M}var fr=Ka(null),Su=null,Js=null,Rl=null;function Au(){Rl=Js=Su=null}function kd(E,M,B){Kt?(Rn(fr,M._currentValue),M._currentValue=B):(Rn(fr,M._currentValue2),M._currentValue2=B)}function Br(E){var M=fr.current;ri(fr),Kt?E._currentValue=M:E._currentValue2=M}function La(E,M,B){for(;E!==null;){var H=E.alternate;if((E.childLanes&M)!==M?(E.childLanes|=M,H!==null&&(H.childLanes|=M)):H!==null&&(H.childLanes&M)!==M&&(H.childLanes|=M),E===B)break;E=E.return}}function Sn(E,M){Su=E,Rl=Js=null,E=E.dependencies,E!==null&&E.firstContext!==null&&(E.lanes&M&&(as=!0),E.firstContext=null)}function ar(E){var M=Kt?E._currentValue:E._currentValue2;if(Rl!==E)if(E={context:E,memoizedValue:M,next:null},Js===null){if(Su===null)throw Error(d(308));Js=E,Su.dependencies={lanes:0,firstContext:E}}else Js=Js.next=E;return M}var jo=null,Er=!1;function ts(E){E.updateQueue={baseState:E.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function P_(E,M){E=E.updateQueue,M.updateQueue===E&&(M.updateQueue={baseState:E.baseState,firstBaseUpdate:E.firstBaseUpdate,lastBaseUpdate:E.lastBaseUpdate,shared:E.shared,effects:E.effects})}function ns(E,M){return{eventTime:E,lane:M,tag:0,payload:null,callback:null,next:null}}function Ra(E,M){var B=E.updateQueue;B!==null&&(B=B.shared,$a!==null&&E.mode&1&&!(Ni&2)?(E=B.interleaved,E===null?(M.next=M,jo===null?jo=[B]:jo.push(B)):(M.next=E.next,E.next=M),B.interleaved=M):(E=B.pending,E===null?M.next=M:(M.next=E.next,E.next=M),B.pending=M))}function Eu(E,M,B){if(M=M.updateQueue,M!==null&&(M=M.shared,(B&4194240)!==0)){var H=M.lanes;H&=E.pendingLanes,B|=H,M.lanes=B,bn(E,B)}}function iy(E,M){var B=E.updateQueue,H=E.alternate;if(H!==null&&(H=H.updateQueue,B===H)){var ee=null,oe=null;if(B=B.firstBaseUpdate,B!==null){do{var Ye={eventTime:B.eventTime,lane:B.lane,tag:B.tag,payload:B.payload,callback:B.callback,next:null};oe===null?ee=oe=Ye:oe=oe.next=Ye,B=B.next}while(B!==null);oe===null?ee=oe=M:oe=oe.next=M}else ee=oe=M;B={baseState:H.baseState,firstBaseUpdate:ee,lastBaseUpdate:oe,shared:H.shared,effects:H.effects},E.updateQueue=B;return}E=B.lastBaseUpdate,E===null?B.firstBaseUpdate=M:E.next=M,B.lastBaseUpdate=M}function Mu(E,M,B,H){var ee=E.updateQueue;Er=!1;var oe=ee.firstBaseUpdate,Ye=ee.lastBaseUpdate,xt=ee.shared.pending;if(xt!==null){ee.shared.pending=null;var Yt=xt,dn=Yt.next;Yt.next=null,Ye===null?oe=dn:Ye.next=dn,Ye=Yt;var Tn=E.alternate;Tn!==null&&(Tn=Tn.updateQueue,xt=Tn.lastBaseUpdate,xt!==Ye&&(xt===null?Tn.firstBaseUpdate=dn:xt.next=dn,Tn.lastBaseUpdate=Yt))}if(oe!==null){var Si=ee.baseState;Ye=0,Tn=dn=Yt=null,xt=oe;do{var ti=xt.lane,wa=xt.eventTime;if((H&ti)===ti){Tn!==null&&(Tn=Tn.next={eventTime:wa,lane:0,tag:xt.tag,payload:xt.payload,callback:xt.callback,next:null});e:{var Hn=E,go=xt;switch(ti=M,wa=B,go.tag){case 1:if(Hn=go.payload,typeof Hn=="function"){Si=Hn.call(wa,Si,ti);break e}Si=Hn;break e;case 3:Hn.flags=Hn.flags&-65537|128;case 0:if(Hn=go.payload,ti=typeof Hn=="function"?Hn.call(wa,Si,ti):Hn,ti==null)break e;Si=l({},Si,ti);break e;case 2:Er=!0}}xt.callback!==null&&xt.lane!==0&&(E.flags|=64,ti=ee.effects,ti===null?ee.effects=[xt]:ti.push(xt))}else wa={eventTime:wa,lane:ti,tag:xt.tag,payload:xt.payload,callback:xt.callback,next:null},Tn===null?(dn=Tn=wa,Yt=Si):Tn=Tn.next=wa,Ye|=ti;if(xt=xt.next,xt===null){if(xt=ee.shared.pending,xt===null)break;ti=xt,xt=ti.next,ti.next=null,ee.lastBaseUpdate=ti,ee.shared.pending=null}}while(1);if(Tn===null&&(Yt=Si),ee.baseState=Yt,ee.firstBaseUpdate=dn,ee.lastBaseUpdate=Tn,M=ee.shared.interleaved,M!==null){ee=M;do Ye|=ee.lane,ee=ee.next;while(ee!==M)}else oe===null&&(ee.shared.lanes=0);qd|=Ye,E.lanes=Ye,E.memoizedState=Si}}function Mr(E,M,B){if(E=M.effects,M.effects=null,E!==null)for(M=0;M<E.length;M++){var H=E[M],ee=H.callback;if(ee!==null){if(H.callback=null,H=B,typeof ee!="function")throw Error(d(191,ee));ee.call(H)}}}var ay=new o.Component().refs;function Ff(E,M,B,H){M=E.memoizedState,B=B(H,M),B=B==null?M:l({},M,B),E.memoizedState=B,E.lanes===0&&(E.updateQueue.baseState=B)}var Qs={isMounted:function(E){return(E=E._reactInternals)?V(E)===E:!1},enqueueSetState:function(E,M,B){E=E._reactInternals;var H=mo(),ee=Wu(E),oe=ns(H,ee);oe.payload=M,B!=null&&(oe.callback=B),Ra(E,oe),M=Jr(E,ee,H),M!==null&&Eu(M,E,ee)},enqueueReplaceState:function(E,M,B){E=E._reactInternals;var H=mo(),ee=Wu(E),oe=ns(H,ee);oe.tag=1,oe.payload=M,B!=null&&(oe.callback=B),Ra(E,oe),M=Jr(E,ee,H),M!==null&&Eu(M,E,ee)},enqueueForceUpdate:function(E,M){E=E._reactInternals;var B=mo(),H=Wu(E),ee=ns(B,H);ee.tag=2,M!=null&&(ee.callback=M),Ra(E,ee),M=Jr(E,H,B),M!==null&&Eu(M,E,H)}};function Kh(E,M,B,H,ee,oe,Ye){return E=E.stateNode,typeof E.shouldComponentUpdate=="function"?E.shouldComponentUpdate(H,oe,Ye):M.prototype&&M.prototype.isPureReactComponent?!Rd(B,H)||!Rd(ee,oe):!0}function Jh(E,M,B){var H=!1,ee=uo,oe=M.contextType;return typeof oe=="object"&&oe!==null?oe=ar(oe):(ee=Ja(M)?Go:Di.current,H=M.contextTypes,oe=(H=H!=null)?Sr(E,ee):uo),M=new M(B,oe),E.memoizedState=M.state!==null&&M.state!==void 0?M.state:null,M.updater=Qs,E.stateNode=M,M._reactInternals=E,H&&(E=E.stateNode,E.__reactInternalMemoizedUnmaskedChildContext=ee,E.__reactInternalMemoizedMaskedChildContext=oe),M}function Oi(E,M,B,H){E=M.state,typeof M.componentWillReceiveProps=="function"&&M.componentWillReceiveProps(B,H),typeof M.UNSAFE_componentWillReceiveProps=="function"&&M.UNSAFE_componentWillReceiveProps(B,H),M.state!==E&&Qs.enqueueReplaceState(M,M.state,null)}function I_(E,M,B,H){var ee=E.stateNode;ee.props=B,ee.state=E.memoizedState,ee.refs=ay,ts(E);var oe=M.contextType;typeof oe=="object"&&oe!==null?ee.context=ar(oe):(oe=Ja(M)?Go:Di.current,ee.context=Sr(E,oe)),ee.state=E.memoizedState,oe=M.getDerivedStateFromProps,typeof oe=="function"&&(Ff(E,M,oe,B),ee.state=E.memoizedState),typeof M.getDerivedStateFromProps=="function"||typeof ee.getSnapshotBeforeUpdate=="function"||typeof ee.UNSAFE_componentWillMount!="function"&&typeof ee.componentWillMount!="function"||(M=ee.state,typeof ee.componentWillMount=="function"&&ee.componentWillMount(),typeof ee.UNSAFE_componentWillMount=="function"&&ee.UNSAFE_componentWillMount(),M!==ee.state&&Qs.enqueueReplaceState(ee,ee.state,null),Mu(E,B,ee,H),ee.state=E.memoizedState),typeof ee.componentDidMount=="function"&&(E.flags|=4194308)}var Tu=[],el=0,ry=null,Bf=0,Mo=[],Tr=0,rc=null,oc=1,Oc="";function Dd(E,M){Tu[el++]=Bf,Tu[el++]=ry,ry=E,Bf=M}function Qh(E,M,B){Mo[Tr++]=oc,Mo[Tr++]=Oc,Mo[Tr++]=rc,rc=E;var H=oc;E=Oc;var ee=32-Ar(H)-1;H&=~(1<<ee),B+=1;var oe=32-Ar(M)+ee;if(30<oe){var Ye=ee-ee%5;oe=(H&(1<<Ye)-1).toString(32),H>>=Ye,ee-=Ye,oc=1<<32-Ar(M)+ee|B<<ee|H,Oc=oe+E}else oc=1<<oe|B<<ee|H,Oc=E}function Od(E){E.return!==null&&(Dd(E,1),Qh(E,1,0))}function L_(E){for(;E===ry;)ry=Tu[--el],Tu[el]=null,Bf=Tu[--el],Tu[el]=null;for(;E===rc;)rc=Mo[--Tr],Mo[Tr]=null,Oc=Mo[--Tr],Mo[Tr]=null,oc=Mo[--Tr],Mo[Tr]=null}var ho=null,is=null,Na=!1,tl=!1,kl=null;function s2(E,M){var B=ls(5,null,null,0);B.elementType="DELETED",B.stateNode=M,B.return=E,M=E.deletions,M===null?(E.deletions=[B],E.flags|=16):M.push(B)}function l2(E,M){switch(E.tag){case 5:return M=dt(M,E.type,E.pendingProps),M!==null?(E.stateNode=M,ho=E,is=Vn(M),!0):!1;case 6:return M=Vt(M,E.pendingProps),M!==null?(E.stateNode=M,ho=E,is=null,!0):!1;case 13:if(M=It(M),M!==null){var B=rc!==null?{id:oc,overflow:Oc}:null;return E.memoizedState={dehydrated:M,treeContext:B,retryLane:1073741824},B=ls(18,null,null,0),B.stateNode=M,B.return=E,E.child=B,ho=E,is=null,!0}return!1;default:return!1}}function oy(E){return(E.mode&1)!==0&&(E.flags&128)===0}function R_(E){if(Na){var M=is;if(M){var B=M;if(!l2(E,M)){if(oy(E))throw Error(d(418));M=vn(B);var H=ho;M&&l2(E,M)?s2(H,B):(E.flags=E.flags&-4097|2,Na=!1,ho=E)}}else{if(oy(E))throw Error(d(418));E.flags=E.flags&-4097|2,Na=!1,ho=E}}}function sy(E){for(E=E.return;E!==null&&E.tag!==5&&E.tag!==3&&E.tag!==13;)E=E.return;ho=E}function ep(E){if(!ft||E!==ho)return!1;if(!Na)return sy(E),Na=!0,!1;if(E.tag!==3&&(E.tag!==5||jt(E.type)&&!Ke(E.type,E.memoizedProps))){var M=is;if(M){if(oy(E)){for(E=is;E;)E=vn(E);throw Error(d(418))}for(;M;)s2(E,M),M=vn(M)}}if(sy(E),E.tag===13){if(!ft)throw Error(d(316));if(E=E.memoizedState,E=E!==null?E.dehydrated:null,!E)throw Error(d(317));is=Re(E)}else is=ho?vn(E.stateNode):null;return!0}function Nd(){ft&&(is=ho=null,tl=Na=!1)}function ly(E){kl===null?kl=[E]:kl.push(E)}function tp(E,M,B){if(E=B.ref,E!==null&&typeof E!="function"&&typeof E!="object"){if(B._owner){if(B=B._owner,B){if(B.tag!==1)throw Error(d(309));var H=B.stateNode}if(!H)throw Error(d(147,E));var ee=H,oe=""+E;return M!==null&&M.ref!==null&&typeof M.ref=="function"&&M.ref._stringRef===oe?M.ref:(M=function(Ye){var xt=ee.refs;xt===ay&&(xt=ee.refs={}),Ye===null?delete xt[oe]:xt[oe]=Ye},M._stringRef=oe,M)}if(typeof E!="string")throw Error(d(284));if(!B._owner)throw Error(d(290,E))}return E}function Cu(E,M){throw E=Object.prototype.toString.call(M),Error(d(31,E==="[object Object]"?"object with keys {"+Object.keys(M).join(", ")+"}":E))}function cy(E){var M=E._init;return M(E._payload)}function k_(E){function M(Bt,Mt){if(E){var Gt=Bt.deletions;Gt===null?(Bt.deletions=[Mt],Bt.flags|=16):Gt.push(Mt)}}function B(Bt,Mt){if(!E)return null;for(;Mt!==null;)M(Bt,Mt),Mt=Mt.sibling;return null}function H(Bt,Mt){for(Bt=new Map;Mt!==null;)Mt.key!==null?Bt.set(Mt.key,Mt):Bt.set(Mt.index,Mt),Mt=Mt.sibling;return Bt}function ee(Bt,Mt){return Bt=Gc(Bt,Mt),Bt.index=0,Bt.sibling=null,Bt}function oe(Bt,Mt,Gt){return Bt.index=Gt,E?(Gt=Bt.alternate,Gt!==null?(Gt=Gt.index,Gt<Mt?(Bt.flags|=2,Mt):Gt):(Bt.flags|=2,Mt)):(Bt.flags|=1048576,Mt)}function Ye(Bt){return E&&Bt.alternate===null&&(Bt.flags|=2),Bt}function xt(Bt,Mt,Gt,En){return Mt===null||Mt.tag!==6?(Mt=Zt(Gt,Bt.mode,En),Mt.return=Bt,Mt):(Mt=ee(Mt,Gt),Mt.return=Bt,Mt)}function Yt(Bt,Mt,Gt,En){var Dn=Gt.type;return Dn===_?Tn(Bt,Mt,Gt.props.children,En,Gt.key):Mt!==null&&(Mt.elementType===Dn||typeof Dn=="object"&&Dn!==null&&Dn.$$typeof===N&&cy(Dn)===Mt.type)?(En=ee(Mt,Gt.props),En.ref=tp(Bt,Mt,Gt),En.return=Bt,En):(En=ev(Gt.type,Gt.key,Gt.props,null,Bt.mode,En),En.ref=tp(Bt,Mt,Gt),En.return=Bt,En)}function dn(Bt,Mt,Gt,En){return Mt===null||Mt.tag!==4||Mt.stateNode.containerInfo!==Gt.containerInfo||Mt.stateNode.implementation!==Gt.implementation?(Mt=_n(Gt,Bt.mode,En),Mt.return=Bt,Mt):(Mt=ee(Mt,Gt.children||[]),Mt.return=Bt,Mt)}function Tn(Bt,Mt,Gt,En,Dn){return Mt===null||Mt.tag!==7?(Mt=rl(Gt,Bt.mode,En,Dn),Mt.return=Bt,Mt):(Mt=ee(Mt,Gt),Mt.return=Bt,Mt)}function Si(Bt,Mt,Gt){if(typeof Mt=="string"&&Mt!==""||typeof Mt=="number")return Mt=Zt(""+Mt,Bt.mode,Gt),Mt.return=Bt,Mt;if(typeof Mt=="object"&&Mt!==null){switch(Mt.$$typeof){case f:return Gt=ev(Mt.type,Mt.key,Mt.props,null,Bt.mode,Gt),Gt.ref=tp(Bt,null,Mt),Gt.return=Bt,Gt;case y:return Mt=_n(Mt,Bt.mode,Gt),Mt.return=Bt,Mt;case N:var En=Mt._init;return Si(Bt,En(Mt._payload),Gt)}if(Me(Mt)||j(Mt))return Mt=rl(Mt,Bt.mode,Gt,null),Mt.return=Bt,Mt;Cu(Bt,Mt)}return null}function ti(Bt,Mt,Gt,En){var Dn=Mt!==null?Mt.key:null;if(typeof Gt=="string"&&Gt!==""||typeof Gt=="number")return Dn!==null?null:xt(Bt,Mt,""+Gt,En);if(typeof Gt=="object"&&Gt!==null){switch(Gt.$$typeof){case f:return Gt.key===Dn?Yt(Bt,Mt,Gt,En):null;case y:return Gt.key===Dn?dn(Bt,Mt,Gt,En):null;case N:return Dn=Gt._init,ti(Bt,Mt,Dn(Gt._payload),En)}if(Me(Gt)||j(Gt))return Dn!==null?null:Tn(Bt,Mt,Gt,En,null);Cu(Bt,Gt)}return null}function wa(Bt,Mt,Gt,En,Dn){if(typeof En=="string"&&En!==""||typeof En=="number")return Bt=Bt.get(Gt)||null,xt(Mt,Bt,""+En,Dn);if(typeof En=="object"&&En!==null){switch(En.$$typeof){case f:return Bt=Bt.get(En.key===null?Gt:En.key)||null,Yt(Mt,Bt,En,Dn);case y:return Bt=Bt.get(En.key===null?Gt:En.key)||null,dn(Mt,Bt,En,Dn);case N:var Fn=En._init;return wa(Bt,Mt,Gt,Fn(En._payload),Dn)}if(Me(En)||j(En))return Bt=Bt.get(Gt)||null,Tn(Mt,Bt,En,Dn,null);Cu(Mt,En)}return null}function Hn(Bt,Mt,Gt,En){for(var Dn=null,Fn=null,Mi=Mt,Ki=Mt=0,gr=null;Mi!==null&&Ki<Gt.length;Ki++){Mi.index>Ki?(gr=Mi,Mi=null):gr=Mi.sibling;var Vi=ti(Bt,Mi,Gt[Ki],En);if(Vi===null){Mi===null&&(Mi=gr);break}E&&Mi&&Vi.alternate===null&&M(Bt,Mi),Mt=oe(Vi,Mt,Ki),Fn===null?Dn=Vi:Fn.sibling=Vi,Fn=Vi,Mi=gr}if(Ki===Gt.length)return B(Bt,Mi),Na&&Dd(Bt,Ki),Dn;if(Mi===null){for(;Ki<Gt.length;Ki++)Mi=Si(Bt,Gt[Ki],En),Mi!==null&&(Mt=oe(Mi,Mt,Ki),Fn===null?Dn=Mi:Fn.sibling=Mi,Fn=Mi);return Na&&Dd(Bt,Ki),Dn}for(Mi=H(Bt,Mi);Ki<Gt.length;Ki++)gr=wa(Mi,Bt,Ki,Gt[Ki],En),gr!==null&&(E&&gr.alternate!==null&&Mi.delete(gr.key===null?Ki:gr.key),Mt=oe(gr,Mt,Ki),Fn===null?Dn=gr:Fn.sibling=gr,Fn=gr);return E&&Mi.forEach(function(hc){return M(Bt,hc)}),Na&&Dd(Bt,Ki),Dn}function go(Bt,Mt,Gt,En){var Dn=j(Gt);if(typeof Dn!="function")throw Error(d(150));if(Gt=Dn.call(Gt),Gt==null)throw Error(d(151));for(var Fn=Dn=null,Mi=Mt,Ki=Mt=0,gr=null,Vi=Gt.next();Mi!==null&&!Vi.done;Ki++,Vi=Gt.next()){Mi.index>Ki?(gr=Mi,Mi=null):gr=Mi.sibling;var hc=ti(Bt,Mi,Vi.value,En);if(hc===null){Mi===null&&(Mi=gr);break}E&&Mi&&hc.alternate===null&&M(Bt,Mi),Mt=oe(hc,Mt,Ki),Fn===null?Dn=hc:Fn.sibling=hc,Fn=hc,Mi=gr}if(Vi.done)return B(Bt,Mi),Na&&Dd(Bt,Ki),Dn;if(Mi===null){for(;!Vi.done;Ki++,Vi=Gt.next())Vi=Si(Bt,Vi.value,En),Vi!==null&&(Mt=oe(Vi,Mt,Ki),Fn===null?Dn=Vi:Fn.sibling=Vi,Fn=Vi);return Na&&Dd(Bt,Ki),Dn}for(Mi=H(Bt,Mi);!Vi.done;Ki++,Vi=Gt.next())Vi=wa(Mi,Bt,Ki,Vi.value,En),Vi!==null&&(E&&Vi.alternate!==null&&Mi.delete(Vi.key===null?Ki:Vi.key),Mt=oe(Vi,Mt,Ki),Fn===null?Dn=Vi:Fn.sibling=Vi,Fn=Vi);return E&&Mi.forEach(function(a1){return M(Bt,a1)}),Na&&Dd(Bt,Ki),Dn}function eo(Bt,Mt,Gt,En){if(typeof Gt=="object"&&Gt!==null&&Gt.type===_&&Gt.key===null&&(Gt=Gt.props.children),typeof Gt=="object"&&Gt!==null){switch(Gt.$$typeof){case f:e:{for(var Dn=Gt.key,Fn=Mt;Fn!==null;){if(Fn.key===Dn){if(Dn=Gt.type,Dn===_){if(Fn.tag===7){B(Bt,Fn.sibling),Mt=ee(Fn,Gt.props.children),Mt.return=Bt,Bt=Mt;break e}}else if(Fn.elementType===Dn||typeof Dn=="object"&&Dn!==null&&Dn.$$typeof===N&&cy(Dn)===Fn.type){B(Bt,Fn.sibling),Mt=ee(Fn,Gt.props),Mt.ref=tp(Bt,Fn,Gt),Mt.return=Bt,Bt=Mt;break e}B(Bt,Fn);break}else M(Bt,Fn);Fn=Fn.sibling}Gt.type===_?(Mt=rl(Gt.props.children,Bt.mode,En,Gt.key),Mt.return=Bt,Bt=Mt):(En=ev(Gt.type,Gt.key,Gt.props,null,Bt.mode,En),En.ref=tp(Bt,Mt,Gt),En.return=Bt,Bt=En)}return Ye(Bt);case y:e:{for(Fn=Gt.key;Mt!==null;){if(Mt.key===Fn)if(Mt.tag===4&&Mt.stateNode.containerInfo===Gt.containerInfo&&Mt.stateNode.implementation===Gt.implementation){B(Bt,Mt.sibling),Mt=ee(Mt,Gt.children||[]),Mt.return=Bt,Bt=Mt;break e}else{B(Bt,Mt);break}else M(Bt,Mt);Mt=Mt.sibling}Mt=_n(Gt,Bt.mode,En),Mt.return=Bt,Bt=Mt}return Ye(Bt);case N:return Fn=Gt._init,eo(Bt,Mt,Fn(Gt._payload),En)}if(Me(Gt))return Hn(Bt,Mt,Gt,En);if(j(Gt))return go(Bt,Mt,Gt,En);Cu(Bt,Gt)}return typeof Gt=="string"&&Gt!==""||typeof Gt=="number"?(Gt=""+Gt,Mt!==null&&Mt.tag===6?(B(Bt,Mt.sibling),Mt=ee(Mt,Gt),Mt.return=Bt,Bt=Mt):(B(Bt,Mt),Mt=Zt(Gt,Bt.mode,En),Mt.return=Bt,Bt=Mt),Ye(Bt)):B(Bt,Mt)}return eo}var Pu=k_(!0),D_=k_(!1),zd={},mt=Ka(zd),np=Ka(zd),Iu=Ka(zd);function nl(E){if(E===zd)throw Error(d(174));return E}function uy(E,M){Rn(Iu,M),Rn(np,E),Rn(mt,zd),E=ze(M),ri(mt),Rn(mt,E)}function Nc(){ri(mt),ri(np),ri(Iu)}function sc(E){var M=nl(Iu.current),B=nl(mt.current);M=le(B,E.type,M),B!==M&&(Rn(np,E),Rn(mt,M))}function Uf(E){np.current===E&&(ri(mt),ri(np))}var ba=Ka(0);function Fd(E){for(var M=E;M!==null;){if(M.tag===13){var B=M.memoizedState;if(B!==null&&(B=B.dehydrated,B===null||Qt(B)||fn(B)))return M}else if(M.tag===19&&M.memoizedProps.revealOrder!==void 0){if(M.flags&128)return M}else if(M.child!==null){M.child.return=M,M=M.child;continue}if(M===E)break;for(;M.sibling===null;){if(M.return===null||M.return===E)return null;M=M.return}M.sibling.return=M.return,M=M.sibling}return null}var Lu=[];function Wf(){for(var E=0;E<Lu.length;E++){var M=Lu[E];Kt?M._workInProgressVersionPrimary=null:M._workInProgressVersionSecondary=null}Lu.length=0}var dy=p.ReactCurrentDispatcher,Is=p.ReactCurrentBatchConfig,Bd=0,er=null,Oo=null,po=null,hy=!1,Vf=!1,ip=0,bC=0;function Kr(){throw Error(d(321))}function O_(E,M){if(M===null)return!1;for(var B=0;B<M.length&&B<E.length;B++)if(!Qa(E[B],M[B]))return!1;return!0}function py(E,M,B,H,ee,oe){if(Bd=oe,er=M,M.memoizedState=null,M.updateQueue=null,M.lanes=0,dy.current=E===null||E.memoizedState===null?Yf:qf,E=B(H,ee),Vf){oe=0;do{if(Vf=!1,ip=0,25<=oe)throw Error(d(301));oe+=1,po=Oo=null,M.updateQueue=null,dy.current=d2,E=B(H,ee)}while(Vf)}if(dy.current=by,M=Oo!==null&&Oo.next!==null,Bd=0,po=Oo=er=null,hy=!1,M)throw Error(d(300));return E}function Gf(){var E=ip!==0;return ip=0,E}function il(){var E={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return po===null?er.memoizedState=po=E:po=po.next=E,po}function al(){if(Oo===null){var E=er.alternate;E=E!==null?E.memoizedState:null}else E=Oo.next;var M=po===null?er.memoizedState:po.next;if(M!==null)po=M,Oo=E;else{if(E===null)throw Error(d(310));Oo=E,E={memoizedState:Oo.memoizedState,baseState:Oo.baseState,baseQueue:Oo.baseQueue,queue:Oo.queue,next:null},po===null?er.memoizedState=po=E:po=po.next=E}return po}function Dl(E,M){return typeof M=="function"?M(E):M}function ap(E){var M=al(),B=M.queue;if(B===null)throw Error(d(311));B.lastRenderedReducer=E;var H=Oo,ee=H.baseQueue,oe=B.pending;if(oe!==null){if(ee!==null){var Ye=ee.next;ee.next=oe.next,oe.next=Ye}H.baseQueue=ee=oe,B.pending=null}if(ee!==null){oe=ee.next,H=H.baseState;var xt=Ye=null,Yt=null,dn=oe;do{var Tn=dn.lane;if((Bd&Tn)===Tn)Yt!==null&&(Yt=Yt.next={lane:0,action:dn.action,hasEagerState:dn.hasEagerState,eagerState:dn.eagerState,next:null}),H=dn.hasEagerState?dn.eagerState:E(H,dn.action);else{var Si={lane:Tn,action:dn.action,hasEagerState:dn.hasEagerState,eagerState:dn.eagerState,next:null};Yt===null?(xt=Yt=Si,Ye=H):Yt=Yt.next=Si,er.lanes|=Tn,qd|=Tn}dn=dn.next}while(dn!==null&&dn!==oe);Yt===null?Ye=H:Yt.next=xt,Qa(H,M.memoizedState)||(as=!0),M.memoizedState=H,M.baseState=Ye,M.baseQueue=Yt,B.lastRenderedState=H}if(E=B.interleaved,E!==null){ee=E;do oe=ee.lane,er.lanes|=oe,qd|=oe,ee=ee.next;while(ee!==E)}else ee===null&&(B.lanes=0);return[M.memoizedState,B.dispatch]}function Ru(E){var M=al(),B=M.queue;if(B===null)throw Error(d(311));B.lastRenderedReducer=E;var H=B.dispatch,ee=B.pending,oe=M.memoizedState;if(ee!==null){B.pending=null;var Ye=ee=ee.next;do oe=E(oe,Ye.action),Ye=Ye.next;while(Ye!==ee);Qa(oe,M.memoizedState)||(as=!0),M.memoizedState=oe,M.baseQueue===null&&(M.baseState=oe),B.lastRenderedState=oe}return[oe,H]}function Hf(){}function fy(E,M){var B=er,H=al(),ee=M(),oe=!Qa(H.memoizedState,ee);if(oe&&(H.memoizedState=ee,as=!0),H=H.queue,sp(N_.bind(null,B,H,E),[E]),H.getSnapshot!==M||oe||po!==null&&po.memoizedState.tag&1){if(B.flags|=2048,Wd(9,my.bind(null,B,H,ee,M),void 0,null),$a===null)throw Error(d(349));Bd&30||Ud(B,M,ee)}return ee}function Ud(E,M,B){E.flags|=16384,E={getSnapshot:M,value:B},M=er.updateQueue,M===null?(M={lastEffect:null,stores:null},er.updateQueue=M,M.stores=[E]):(B=M.stores,B===null?M.stores=[E]:B.push(E))}function my(E,M,B,H){M.value=B,M.getSnapshot=H,gy(M)&&Jr(E,1,-1)}function N_(E,M,B){return B(function(){gy(M)&&Jr(E,1,-1)})}function gy(E){var M=E.getSnapshot;E=E.value;try{var B=M();return!Qa(E,B)}catch{return!0}}function yy(E){var M=il();return typeof E=="function"&&(E=E()),M.memoizedState=M.baseState=E,E={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Dl,lastRenderedState:E},M.queue=E,E=E.dispatch=V_.bind(null,er,E),[M.memoizedState,E]}function Wd(E,M,B,H){return E={tag:E,create:M,destroy:B,deps:H,next:null},M=er.updateQueue,M===null?(M={lastEffect:null,stores:null},er.updateQueue=M,M.lastEffect=E.next=E):(B=M.lastEffect,B===null?M.lastEffect=E.next=E:(H=B.next,B.next=E,E.next=H,M.lastEffect=E)),E}function jf(){return al().memoizedState}function rp(E,M,B,H){var ee=il();er.flags|=E,ee.memoizedState=Wd(1|M,B,void 0,H===void 0?null:H)}function op(E,M,B,H){var ee=al();H=H===void 0?null:H;var oe=void 0;if(Oo!==null){var Ye=Oo.memoizedState;if(oe=Ye.destroy,H!==null&&O_(H,Ye.deps)){ee.memoizedState=Wd(M,B,oe,H);return}}er.flags|=E,ee.memoizedState=Wd(1|M,B,oe,H)}function Ln(E,M){return rp(8390656,8,E,M)}function sp(E,M){return op(2048,8,E,M)}function $f(E,M){return op(4,2,E,M)}function z_(E,M){return op(4,4,E,M)}function F_(E,M){if(typeof M=="function")return E=E(),M(E),function(){M(null)};if(M!=null)return E=E(),M.current=E,function(){M.current=null}}function B_(E,M,B){return B=B!=null?B.concat([E]):null,op(4,4,F_.bind(null,M,E),B)}function ku(){}function U_(E,M){var B=al();M=M===void 0?null:M;var H=B.memoizedState;return H!==null&&M!==null&&O_(M,H[1])?H[0]:(B.memoizedState=[E,M],E)}function c2(E,M){var B=al();M=M===void 0?null:M;var H=B.memoizedState;return H!==null&&M!==null&&O_(M,H[1])?H[0]:(E=E(),B.memoizedState=[E,M],E)}function xC(E,M){var B=Un;Un=B!==0&&4>B?B:4,E(!0);var H=Is.transition;Is.transition={};try{E(!1),M()}finally{Un=B,Is.transition=H}}function u2(){return al().memoizedState}function W_(E,M,B){var H=Wu(E);B={lane:H,action:B,hasEagerState:!1,eagerState:null,next:null},vy(E)?_y(M,B):(G_(E,M,B),B=mo(),E=Jr(E,H,B),E!==null&&H_(E,M,H))}function V_(E,M,B){var H=Wu(E),ee={lane:H,action:B,hasEagerState:!1,eagerState:null,next:null};if(vy(E))_y(M,ee);else{G_(E,M,ee);var oe=E.alternate;if(E.lanes===0&&(oe===null||oe.lanes===0)&&(oe=M.lastRenderedReducer,oe!==null))try{var Ye=M.lastRenderedState,xt=oe(Ye,B);if(ee.hasEagerState=!0,ee.eagerState=xt,Qa(xt,Ye))return}catch{}finally{}B=mo(),E=Jr(E,H,B),E!==null&&H_(E,M,H)}}function vy(E){var M=E.alternate;return E===er||M!==null&&M===er}function _y(E,M){Vf=hy=!0;var B=E.pending;B===null?M.next=M:(M.next=B.next,B.next=M),E.pending=M}function G_(E,M,B){$a!==null&&E.mode&1&&!(Ni&2)?(E=M.interleaved,E===null?(B.next=B,jo===null?jo=[M]:jo.push(M)):(B.next=E.next,E.next=B),M.interleaved=B):(E=M.pending,E===null?B.next=B:(B.next=E.next,E.next=B),M.pending=B)}function H_(E,M,B){if(B&4194240){var H=M.lanes;H&=E.pendingLanes,B|=H,M.lanes=B,bn(E,B)}}var by={readContext:ar,useCallback:Kr,useContext:Kr,useEffect:Kr,useImperativeHandle:Kr,useInsertionEffect:Kr,useLayoutEffect:Kr,useMemo:Kr,useReducer:Kr,useRef:Kr,useState:Kr,useDebugValue:Kr,useDeferredValue:Kr,useTransition:Kr,useMutableSource:Kr,useSyncExternalStore:Kr,useId:Kr,unstable_isNewReconciler:!1},Yf={readContext:ar,useCallback:function(E,M){return il().memoizedState=[E,M===void 0?null:M],E},useContext:ar,useEffect:Ln,useImperativeHandle:function(E,M,B){return B=B!=null?B.concat([E]):null,rp(4194308,4,F_.bind(null,M,E),B)},useLayoutEffect:function(E,M){return rp(4194308,4,E,M)},useInsertionEffect:function(E,M){return rp(4,2,E,M)},useMemo:function(E,M){var B=il();return M=M===void 0?null:M,E=E(),B.memoizedState=[E,M],E},useReducer:function(E,M,B){var H=il();return M=B!==void 0?B(M):M,H.memoizedState=H.baseState=M,E={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:E,lastRenderedState:M},H.queue=E,E=E.dispatch=W_.bind(null,er,E),[H.memoizedState,E]},useRef:function(E){var M=il();return E={current:E},M.memoizedState=E},useState:yy,useDebugValue:ku,useDeferredValue:function(E){var M=yy(E),B=M[0],H=M[1];return Ln(function(){var ee=Is.transition;Is.transition={};try{H(E)}finally{Is.transition=ee}},[E]),B},useTransition:function(){var E=yy(!1),M=E[0];return E=xC.bind(null,E[1]),il().memoizedState=E,[M,E]},useMutableSource:function(){},useSyncExternalStore:function(E,M,B){var H=er,ee=il();if(Na){if(B===void 0)throw Error(d(407));B=B()}else{if(B=M(),$a===null)throw Error(d(349));Bd&30||Ud(H,M,B)}ee.memoizedState=B;var oe={value:B,getSnapshot:M};return ee.queue=oe,Ln(N_.bind(null,H,oe,E),[E]),H.flags|=2048,Wd(9,my.bind(null,H,oe,B,M),void 0,null),B},useId:function(){var E=il(),M=$a.identifierPrefix;if(Na){var B=Oc,H=oc;B=(H&~(1<<32-Ar(H)-1)).toString(32)+B,M=":"+M+"R"+B,B=ip++,0<B&&(M+="H"+B.toString(32)),M+=":"}else B=bC++,M=":"+M+"r"+B.toString(32)+":";return E.memoizedState=M},unstable_isNewReconciler:!1},qf={readContext:ar,useCallback:U_,useContext:ar,useEffect:sp,useImperativeHandle:B_,useInsertionEffect:$f,useLayoutEffect:z_,useMemo:c2,useReducer:ap,useRef:jf,useState:function(){return ap(Dl)},useDebugValue:ku,useDeferredValue:function(E){var M=ap(Dl),B=M[0],H=M[1];return sp(function(){var ee=Is.transition;Is.transition={};try{H(E)}finally{Is.transition=ee}},[E]),B},useTransition:function(){var E=ap(Dl)[0],M=al().memoizedState;return[E,M]},useMutableSource:Hf,useSyncExternalStore:fy,useId:u2,unstable_isNewReconciler:!1},d2={readContext:ar,useCallback:U_,useContext:ar,useEffect:sp,useImperativeHandle:B_,useInsertionEffect:$f,useLayoutEffect:z_,useMemo:c2,useReducer:Ru,useRef:jf,useState:function(){return Ru(Dl)},useDebugValue:ku,useDeferredValue:function(E){var M=Ru(Dl),B=M[0],H=M[1];return sp(function(){var ee=Is.transition;Is.transition={};try{H(E)}finally{Is.transition=ee}},[E]),B},useTransition:function(){var E=Ru(Dl)[0],M=al().memoizedState;return[E,M]},useMutableSource:Hf,useSyncExternalStore:fy,useId:u2,unstable_isNewReconciler:!1};function lp(E,M){try{var B="",H=M;do B+=Ll(H),H=H.return;while(H);var ee=B}catch(oe){ee=`
Error generating stack: `+oe.message+`
`+oe.stack}return{value:E,source:M,stack:ee}}function Xf(E,M){try{console.error(M.value)}catch(B){setTimeout(function(){throw B})}}var lc=typeof WeakMap=="function"?WeakMap:Map;function xy(E,M,B){B=ns(-1,B),B.tag=3,B.payload={element:null};var H=M.value;return B.callback=function(){Hy||(Hy=!0,J_=H),Xf(E,M)},B}function j_(E,M,B){B=ns(-1,B),B.tag=3;var H=E.type.getDerivedStateFromError;if(typeof H=="function"){var ee=M.value;B.payload=function(){return H(ee)},B.callback=function(){Xf(E,M)}}var oe=E.stateNode;return oe!==null&&typeof oe.componentDidCatch=="function"&&(B.callback=function(){Xf(E,M),typeof H!="function"&&(Bu===null?Bu=new Set([this]):Bu.add(this));var Ye=M.stack;this.componentDidCatch(M.value,{componentStack:Ye!==null?Ye:""})}),B}function wy(E,M,B){var H=E.pingCache;if(H===null){H=E.pingCache=new lc;var ee=new Set;H.set(M,ee)}else ee=H.get(M),ee===void 0&&(ee=new Set,H.set(M,ee));ee.has(B)||(ee.add(B),E=t1.bind(null,E,M,B),M.then(E,E))}function $_(E){do{var M;if((M=E.tag===13)&&(M=E.memoizedState,M=M!==null?M.dehydrated!==null:!0),M)return E;E=E.return}while(E!==null);return null}function Sy(E,M,B,H,ee){return E.mode&1?(E.flags|=65536,E.lanes=ee,E):(E===M?E.flags|=65536:(E.flags|=128,B.flags|=131072,B.flags&=-52805,B.tag===1&&(B.alternate===null?B.tag=17:(M=ns(-1,1),M.tag=2,Ra(B,M))),B.lanes|=1),E)}function cc(E){E.flags|=4}function Ay(E,M){if(E!==null&&E.child===M.child)return!0;if(M.flags&16)return!1;for(E=M.child;E!==null;){if(E.flags&12854||E.subtreeFlags&12854)return!1;E=E.sibling}return!0}var Zf,Du,Ey,cp;if(At)Zf=function(E,M){for(var B=M.child;B!==null;){if(B.tag===5||B.tag===6)Ee(E,B.stateNode);else if(B.tag!==4&&B.child!==null){B.child.return=B,B=B.child;continue}if(B===M)break;for(;B.sibling===null;){if(B.return===null||B.return===M)return;B=B.return}B.sibling.return=B.return,B=B.sibling}},Du=function(){},Ey=function(E,M,B,H,ee){if(E=E.memoizedProps,E!==H){var oe=M.stateNode,Ye=nl(mt.current);B=Ze(oe,B,E,H,ee,Ye),(M.updateQueue=B)&&cc(M)}},cp=function(E,M,B,H){B!==H&&cc(M)};else if(Pe){Zf=function(E,M,B,H){for(var ee=M.child;ee!==null;){if(ee.tag===5){var oe=ee.stateNode;B&&H&&(oe=vt(oe,ee.type,ee.memoizedProps,ee)),Ee(E,oe)}else if(ee.tag===6)oe=ee.stateNode,B&&H&&(oe=ht(oe,ee.memoizedProps,ee)),Ee(E,oe);else if(ee.tag!==4){if(ee.tag===22&&ee.memoizedState!==null)oe=ee.child,oe!==null&&(oe.return=ee),Zf(E,ee,!0,!0);else if(ee.child!==null){ee.child.return=ee,ee=ee.child;continue}}if(ee===M)break;for(;ee.sibling===null;){if(ee.return===null||ee.return===M)return;ee=ee.return}ee.sibling.return=ee.return,ee=ee.sibling}};var h2=function(E,M,B,H){for(var ee=M.child;ee!==null;){if(ee.tag===5){var oe=ee.stateNode;B&&H&&(oe=vt(oe,ee.type,ee.memoizedProps,ee)),Ne(E,oe)}else if(ee.tag===6)oe=ee.stateNode,B&&H&&(oe=ht(oe,ee.memoizedProps,ee)),Ne(E,oe);else if(ee.tag!==4){if(ee.tag===22&&ee.memoizedState!==null)oe=ee.child,oe!==null&&(oe.return=ee),h2(E,ee,!0,!0);else if(ee.child!==null){ee.child.return=ee,ee=ee.child;continue}}if(ee===M)break;for(;ee.sibling===null;){if(ee.return===null||ee.return===M)return;ee=ee.return}ee.sibling.return=ee.return,ee=ee.sibling}};Du=function(E,M){var B=M.stateNode;if(!Ay(E,M)){E=B.containerInfo;var H=Te(E);h2(H,M,!1,!1),B.pendingChildren=H,cc(M),et(E,H)}},Ey=function(E,M,B,H,ee){var oe=E.stateNode,Ye=E.memoizedProps;if((E=Ay(E,M))&&Ye===H)M.stateNode=oe;else{var xt=M.stateNode,Yt=nl(mt.current),dn=null;Ye!==H&&(dn=Ze(xt,B,Ye,H,ee,Yt)),E&&dn===null?M.stateNode=oe:(oe=we(oe,dn,B,Ye,H,M,E,xt),Je(oe,B,H,ee,Yt)&&cc(M),M.stateNode=oe,E?cc(M):Zf(oe,M,!1,!1))}},cp=function(E,M,B,H){B!==H?(E=nl(Iu.current),B=nl(mt.current),M.stateNode=Fe(H,E,B,M),cc(M)):M.stateNode=E.stateNode}}else Du=function(){},Ey=function(){},cp=function(){};function Vd(E,M){if(!Na)switch(E.tailMode){case"hidden":M=E.tail;for(var B=null;M!==null;)M.alternate!==null&&(B=M),M=M.sibling;B===null?E.tail=null:B.sibling=null;break;case"collapsed":B=E.tail;for(var H=null;B!==null;)B.alternate!==null&&(H=B),B=B.sibling;H===null?M||E.tail===null?E.tail=null:E.tail.sibling=null:H.sibling=null}}function No(E){var M=E.alternate!==null&&E.alternate.child===E.child,B=0,H=0;if(M)for(var ee=E.child;ee!==null;)B|=ee.lanes|ee.childLanes,H|=ee.subtreeFlags&14680064,H|=ee.flags&14680064,ee.return=E,ee=ee.sibling;else for(ee=E.child;ee!==null;)B|=ee.lanes|ee.childLanes,H|=ee.subtreeFlags,H|=ee.flags,ee.return=E,ee=ee.sibling;return E.subtreeFlags|=H,E.childLanes=B,M}function My(E,M,B){var H=M.pendingProps;switch(L_(M),M.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return No(M),null;case 1:return Ja(M.type)&&fa(),No(M),null;case 3:return H=M.stateNode,Nc(),ri(Ia),ri(Di),Wf(),H.pendingContext&&(H.context=H.pendingContext,H.pendingContext=null),(E===null||E.child===null)&&(ep(M)?cc(M):E===null||E.memoizedState.isDehydrated&&!(M.flags&256)||(M.flags|=1024,kl!==null&&(Yy(kl),kl=null))),Du(E,M),No(M),null;case 5:Uf(M),B=nl(Iu.current);var ee=M.type;if(E!==null&&M.stateNode!=null)Ey(E,M,ee,H,B),E.ref!==M.ref&&(M.flags|=512,M.flags|=2097152);else{if(!H){if(M.stateNode===null)throw Error(d(166));return No(M),null}if(E=nl(mt.current),ep(M)){if(!ft)throw Error(d(175));E=wi(M.stateNode,M.type,M.memoizedProps,B,E,M,!tl),M.updateQueue=E,E!==null&&cc(M)}else{var oe=ae(ee,H,B,E,M);Zf(oe,M,!1,!1),M.stateNode=oe,Je(oe,ee,H,B,E)&&cc(M)}M.ref!==null&&(M.flags|=512,M.flags|=2097152)}return No(M),null;case 6:if(E&&M.stateNode!=null)cp(E,M,E.memoizedProps,H);else{if(typeof H!="string"&&M.stateNode===null)throw Error(d(166));if(E=nl(Iu.current),B=nl(mt.current),ep(M)){if(!ft)throw Error(d(176));if(E=M.stateNode,H=M.memoizedProps,(B=pa(E,H,M,!tl))&&(ee=ho,ee!==null))switch(oe=(ee.mode&1)!==0,ee.tag){case 3:gn(ee.stateNode.containerInfo,E,H,oe);break;case 5:Xn(ee.type,ee.memoizedProps,ee.stateNode,E,H,oe)}B&&cc(M)}else M.stateNode=Fe(H,E,B,M)}return No(M),null;case 13:if(ri(ba),H=M.memoizedState,Na&&is!==null&&M.mode&1&&!(M.flags&128)){for(E=is;E;)E=vn(E);return Nd(),M.flags|=98560,M}if(H!==null&&H.dehydrated!==null){if(H=ep(M),E===null){if(!H)throw Error(d(318));if(!ft)throw Error(d(344));if(E=M.memoizedState,E=E!==null?E.dehydrated:null,!E)throw Error(d(317));na(E,M)}else Nd(),!(M.flags&128)&&(M.memoizedState=null),M.flags|=4;return No(M),null}return kl!==null&&(Yy(kl),kl=null),M.flags&128?(M.lanes=B,M):(H=H!==null,B=!1,E===null?ep(M):B=E.memoizedState!==null,H&&!B&&(M.child.flags|=8192,M.mode&1&&(E===null||ba.current&1?Ur===0&&(Ur=3):Xy())),M.updateQueue!==null&&(M.flags|=4),No(M),null);case 4:return Nc(),Du(E,M),E===null&&_t(M.stateNode.containerInfo),No(M),null;case 10:return Br(M.type._context),No(M),null;case 17:return Ja(M.type)&&fa(),No(M),null;case 19:if(ri(ba),ee=M.memoizedState,ee===null)return No(M),null;if(H=(M.flags&128)!==0,oe=ee.rendering,oe===null)if(H)Vd(ee,!1);else{if(Ur!==0||E!==null&&E.flags&128)for(E=M.child;E!==null;){if(oe=Fd(E),oe!==null){for(M.flags|=128,Vd(ee,!1),E=oe.updateQueue,E!==null&&(M.updateQueue=E,M.flags|=4),M.subtreeFlags=0,E=B,H=M.child;H!==null;)B=H,ee=E,B.flags&=14680066,oe=B.alternate,oe===null?(B.childLanes=0,B.lanes=ee,B.child=null,B.subtreeFlags=0,B.memoizedProps=null,B.memoizedState=null,B.updateQueue=null,B.dependencies=null,B.stateNode=null):(B.childLanes=oe.childLanes,B.lanes=oe.lanes,B.child=oe.child,B.subtreeFlags=0,B.deletions=null,B.memoizedProps=oe.memoizedProps,B.memoizedState=oe.memoizedState,B.updateQueue=oe.updateQueue,B.type=oe.type,ee=oe.dependencies,B.dependencies=ee===null?null:{lanes:ee.lanes,firstContext:ee.firstContext}),H=H.sibling;return Rn(ba,ba.current&1|2),M.child}E=E.sibling}ee.tail!==null&&oa()>Fu&&(M.flags|=128,H=!0,Vd(ee,!1),M.lanes=4194304)}else{if(!H)if(E=Fd(oe),E!==null){if(M.flags|=128,H=!0,E=E.updateQueue,E!==null&&(M.updateQueue=E,M.flags|=4),Vd(ee,!0),ee.tail===null&&ee.tailMode==="hidden"&&!oe.alternate&&!Na)return No(M),null}else 2*oa()-ee.renderingStartTime>Fu&&B!==1073741824&&(M.flags|=128,H=!0,Vd(ee,!1),M.lanes=4194304);ee.isBackwards?(oe.sibling=M.child,M.child=oe):(E=ee.last,E!==null?E.sibling=oe:M.child=oe,ee.last=oe)}return ee.tail!==null?(M=ee.tail,ee.rendering=M,ee.tail=M.sibling,ee.renderingStartTime=oa(),M.sibling=null,E=ba.current,Rn(ba,H?E&1|2:E&1),M):(No(M),null);case 22:case 23:return ym(),H=M.memoizedState!==null,E!==null&&E.memoizedState!==null!==H&&(M.flags|=8192),H&&M.mode&1?Ls&1073741824&&(No(M),At&&M.subtreeFlags&6&&(M.flags|=8192)):No(M),null;case 24:return null;case 25:return null}throw Error(d(156,M.tag))}var wC=p.ReactCurrentOwner,as=!1;function zo(E,M,B,H){M.child=E===null?D_(M,null,B,H):Pu(M,E.child,B,H)}function Gd(E,M,B,H,ee){B=B.render;var oe=M.ref;return Sn(M,ee),H=py(E,M,B,H,oe,ee),B=Gf(),E!==null&&!as?(M.updateQueue=E.updateQueue,M.flags&=-2053,E.lanes&=~ee,dc(E,M,ee)):(Na&&B&&Od(M),M.flags|=1,zo(E,M,H,ee),M.child)}function p2(E,M,B,H,ee){if(E===null){var oe=B.type;return typeof oe=="function"&&!Kd(oe)&&oe.defaultProps===void 0&&B.compare===null&&B.defaultProps===void 0?(M.tag=15,M.type=oe,f2(E,M,oe,H,ee)):(E=ev(B.type,null,H,M,M.mode,ee),E.ref=M.ref,E.return=M,M.child=E)}if(oe=E.child,!(E.lanes&ee)){var Ye=oe.memoizedProps;if(B=B.compare,B=B!==null?B:Rd,B(Ye,H)&&E.ref===M.ref)return dc(E,M,ee)}return M.flags|=1,E=Gc(oe,H),E.ref=M.ref,E.return=M,M.child=E}function f2(E,M,B,H,ee){if(E!==null&&Rd(E.memoizedProps,H)&&E.ref===M.ref)if(as=!1,(E.lanes&ee)!==0)E.flags&131072&&(as=!0);else return M.lanes=E.lanes,dc(E,M,ee);return Y_(E,M,B,H,ee)}function m2(E,M,B){var H=M.pendingProps,ee=H.children,oe=E!==null?E.memoizedState:null;if(H.mode==="hidden")if(!(M.mode&1))M.memoizedState={baseLanes:0,cachePool:null},Rn(Yd,Ls),Ls|=B;else if(B&1073741824)M.memoizedState={baseLanes:0,cachePool:null},H=oe!==null?oe.baseLanes:B,Rn(Yd,Ls),Ls|=H;else return E=oe!==null?oe.baseLanes|B:B,M.lanes=M.childLanes=1073741824,M.memoizedState={baseLanes:E,cachePool:null},M.updateQueue=null,Rn(Yd,Ls),Ls|=E,null;else oe!==null?(H=oe.baseLanes|B,M.memoizedState=null):H=B,Rn(Yd,Ls),Ls|=H;return zo(E,M,ee,B),M.child}function g2(E,M){var B=M.ref;(E===null&&B!==null||E!==null&&E.ref!==B)&&(M.flags|=512,M.flags|=2097152)}function Y_(E,M,B,H,ee){var oe=Ja(B)?Go:Di.current;return oe=Sr(M,oe),Sn(M,ee),B=py(E,M,B,H,oe,ee),H=Gf(),E!==null&&!as?(M.updateQueue=E.updateQueue,M.flags&=-2053,E.lanes&=~ee,dc(E,M,ee)):(Na&&H&&Od(M),M.flags|=1,zo(E,M,B,ee),M.child)}function y2(E,M,B,H,ee){if(Ja(B)){var oe=!0;Jn(M)}else oe=!1;if(Sn(M,ee),M.stateNode===null)E!==null&&(E.alternate=null,M.alternate=null,M.flags|=2),Jh(M,B,H),I_(M,B,H,ee),H=!0;else if(E===null){var Ye=M.stateNode,xt=M.memoizedProps;Ye.props=xt;var Yt=Ye.context,dn=B.contextType;typeof dn=="object"&&dn!==null?dn=ar(dn):(dn=Ja(B)?Go:Di.current,dn=Sr(M,dn));var Tn=B.getDerivedStateFromProps,Si=typeof Tn=="function"||typeof Ye.getSnapshotBeforeUpdate=="function";Si||typeof Ye.UNSAFE_componentWillReceiveProps!="function"&&typeof Ye.componentWillReceiveProps!="function"||(xt!==H||Yt!==dn)&&Oi(M,Ye,H,dn),Er=!1;var ti=M.memoizedState;Ye.state=ti,Mu(M,H,Ye,ee),Yt=M.memoizedState,xt!==H||ti!==Yt||Ia.current||Er?(typeof Tn=="function"&&(Ff(M,B,Tn,H),Yt=M.memoizedState),(xt=Er||Kh(M,B,xt,H,ti,Yt,dn))?(Si||typeof Ye.UNSAFE_componentWillMount!="function"&&typeof Ye.componentWillMount!="function"||(typeof Ye.componentWillMount=="function"&&Ye.componentWillMount(),typeof Ye.UNSAFE_componentWillMount=="function"&&Ye.UNSAFE_componentWillMount()),typeof Ye.componentDidMount=="function"&&(M.flags|=4194308)):(typeof Ye.componentDidMount=="function"&&(M.flags|=4194308),M.memoizedProps=H,M.memoizedState=Yt),Ye.props=H,Ye.state=Yt,Ye.context=dn,H=xt):(typeof Ye.componentDidMount=="function"&&(M.flags|=4194308),H=!1)}else{Ye=M.stateNode,P_(E,M),xt=M.memoizedProps,dn=M.type===M.elementType?xt:Eo(M.type,xt),Ye.props=dn,Si=M.pendingProps,ti=Ye.context,Yt=B.contextType,typeof Yt=="object"&&Yt!==null?Yt=ar(Yt):(Yt=Ja(B)?Go:Di.current,Yt=Sr(M,Yt));var wa=B.getDerivedStateFromProps;(Tn=typeof wa=="function"||typeof Ye.getSnapshotBeforeUpdate=="function")||typeof Ye.UNSAFE_componentWillReceiveProps!="function"&&typeof Ye.componentWillReceiveProps!="function"||(xt!==Si||ti!==Yt)&&Oi(M,Ye,H,Yt),Er=!1,ti=M.memoizedState,Ye.state=ti,Mu(M,H,Ye,ee);var Hn=M.memoizedState;xt!==Si||ti!==Hn||Ia.current||Er?(typeof wa=="function"&&(Ff(M,B,wa,H),Hn=M.memoizedState),(dn=Er||Kh(M,B,dn,H,ti,Hn,Yt)||!1)?(Tn||typeof Ye.UNSAFE_componentWillUpdate!="function"&&typeof Ye.componentWillUpdate!="function"||(typeof Ye.componentWillUpdate=="function"&&Ye.componentWillUpdate(H,Hn,Yt),typeof Ye.UNSAFE_componentWillUpdate=="function"&&Ye.UNSAFE_componentWillUpdate(H,Hn,Yt)),typeof Ye.componentDidUpdate=="function"&&(M.flags|=4),typeof Ye.getSnapshotBeforeUpdate=="function"&&(M.flags|=1024)):(typeof Ye.componentDidUpdate!="function"||xt===E.memoizedProps&&ti===E.memoizedState||(M.flags|=4),typeof Ye.getSnapshotBeforeUpdate!="function"||xt===E.memoizedProps&&ti===E.memoizedState||(M.flags|=1024),M.memoizedProps=H,M.memoizedState=Hn),Ye.props=H,Ye.state=Hn,Ye.context=Yt,H=dn):(typeof Ye.componentDidUpdate!="function"||xt===E.memoizedProps&&ti===E.memoizedState||(M.flags|=4),typeof Ye.getSnapshotBeforeUpdate!="function"||xt===E.memoizedProps&&ti===E.memoizedState||(M.flags|=1024),H=!1)}return Kf(E,M,B,H,oe,ee)}function Kf(E,M,B,H,ee,oe){g2(E,M);var Ye=(M.flags&128)!==0;if(!H&&!Ye)return ee&&ja(M,B,!1),dc(E,M,oe);H=M.stateNode,wC.current=M;var xt=Ye&&typeof B.getDerivedStateFromError!="function"?null:H.render();return M.flags|=1,E!==null&&Ye?(M.child=Pu(M,E.child,null,oe),M.child=Pu(M,null,xt,oe)):zo(E,M,xt,oe),M.memoizedState=H.state,ee&&ja(M,B,!0),M.child}function Ty(E){var M=E.stateNode;M.pendingContext?zr(E,M.pendingContext,M.pendingContext!==M.context):M.context&&zr(E,M.context,!1),uy(E,M.containerInfo)}function Cy(E,M,B,H,ee){return Nd(),ly(ee),M.flags|=256,zo(E,M,B,H),M.child}var Jf={dehydrated:null,treeContext:null,retryLane:0};function Qf(E){return{baseLanes:E,cachePool:null}}function q_(E,M,B){var H=M.pendingProps,ee=ba.current,oe=!1,Ye=(M.flags&128)!==0,xt;if((xt=Ye)||(xt=E!==null&&E.memoizedState===null?!1:(ee&2)!==0),xt?(oe=!0,M.flags&=-129):(E===null||E.memoizedState!==null)&&(ee|=1),Rn(ba,ee&1),E===null)return R_(M),E=M.memoizedState,E!==null&&(E=E.dehydrated,E!==null)?(M.mode&1?fn(E)?M.lanes=8:M.lanes=1073741824:M.lanes=1,null):(ee=H.children,E=H.fallback,oe?(H=M.mode,oe=M.child,ee={mode:"hidden",children:ee},!(H&1)&&oe!==null?(oe.childLanes=0,oe.pendingProps=ee):oe=Vu(ee,H,0,null),E=rl(E,H,B,null),oe.return=M,E.return=M,oe.sibling=E,M.child=oe,M.child.memoizedState=Qf(B),M.memoizedState=Jf,E):Py(M,ee));if(ee=E.memoizedState,ee!==null){if(xt=ee.dehydrated,xt!==null){if(Ye)return M.flags&256?(M.flags&=-257,uc(E,M,B,Error(d(422)))):M.memoizedState!==null?(M.child=E.child,M.flags|=128,null):(oe=H.fallback,ee=M.mode,H=Vu({mode:"visible",children:H.children},ee,0,null),oe=rl(oe,ee,B,null),oe.flags|=2,H.return=M,oe.return=M,H.sibling=oe,M.child=H,M.mode&1&&Pu(M,E.child,null,B),M.child.memoizedState=Qf(B),M.memoizedState=Jf,oe);if(!(M.mode&1))M=uc(E,M,B,null);else if(fn(xt))M=uc(E,M,B,Error(d(419)));else if(H=(B&E.childLanes)!==0,as||H){if(H=$a,H!==null){switch(B&-B){case 4:oe=2;break;case 16:oe=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:oe=32;break;case 536870912:oe=268435456;break;default:oe=0}H=oe&(H.suspendedLanes|B)?0:oe,H!==0&&H!==ee.retryLane&&(ee.retryLane=H,Jr(E,H,-1))}Xy(),M=uc(E,M,B,Error(d(421)))}else Qt(xt)?(M.flags|=128,M.child=E.child,M=n1.bind(null,E),en(xt,M),M=null):(B=ee.treeContext,ft&&(is=xi(xt),ho=M,Na=!0,kl=null,tl=!1,B!==null&&(Mo[Tr++]=oc,Mo[Tr++]=Oc,Mo[Tr++]=rc,oc=B.id,Oc=B.overflow,rc=M)),M=Py(M,M.pendingProps.children),M.flags|=4096);return M}return oe?(H=X_(E,M,H.children,H.fallback,B),oe=M.child,ee=E.child.memoizedState,oe.memoizedState=ee===null?Qf(B):{baseLanes:ee.baseLanes|B,cachePool:null},oe.childLanes=E.childLanes&~B,M.memoizedState=Jf,H):(B=Iy(E,M,H.children,B),M.memoizedState=null,B)}return oe?(H=X_(E,M,H.children,H.fallback,B),oe=M.child,ee=E.child.memoizedState,oe.memoizedState=ee===null?Qf(B):{baseLanes:ee.baseLanes|B,cachePool:null},oe.childLanes=E.childLanes&~B,M.memoizedState=Jf,H):(B=Iy(E,M,H.children,B),M.memoizedState=null,B)}function Py(E,M){return M=Vu({mode:"visible",children:M},E.mode,0,null),M.return=E,E.child=M}function Iy(E,M,B,H){var ee=E.child;return E=ee.sibling,B=Gc(ee,{mode:"visible",children:B}),!(M.mode&1)&&(B.lanes=H),B.return=M,B.sibling=null,E!==null&&(H=M.deletions,H===null?(M.deletions=[E],M.flags|=16):H.push(E)),M.child=B}function X_(E,M,B,H,ee){var oe=M.mode;E=E.child;var Ye=E.sibling,xt={mode:"hidden",children:B};return!(oe&1)&&M.child!==E?(B=M.child,B.childLanes=0,B.pendingProps=xt,M.deletions=null):(B=Gc(E,xt),B.subtreeFlags=E.subtreeFlags&14680064),Ye!==null?H=Gc(Ye,H):(H=rl(H,oe,ee,null),H.flags|=2),H.return=M,B.return=M,B.sibling=H,M.child=B,H}function uc(E,M,B,H){return H!==null&&ly(H),Pu(M,E.child,null,B),E=Py(M,M.pendingProps.children),E.flags|=2,M.memoizedState=null,E}function up(E,M,B){E.lanes|=M;var H=E.alternate;H!==null&&(H.lanes|=M),La(E.return,M,B)}function Ly(E,M,B,H,ee){var oe=E.memoizedState;oe===null?E.memoizedState={isBackwards:M,rendering:null,renderingStartTime:0,last:H,tail:B,tailMode:ee}:(oe.isBackwards=M,oe.rendering=null,oe.renderingStartTime=0,oe.last=H,oe.tail=B,oe.tailMode=ee)}function Ou(E,M,B){var H=M.pendingProps,ee=H.revealOrder,oe=H.tail;if(zo(E,M,H.children,B),H=ba.current,H&2)H=H&1|2,M.flags|=128;else{if(E!==null&&E.flags&128)e:for(E=M.child;E!==null;){if(E.tag===13)E.memoizedState!==null&&up(E,B,M);else if(E.tag===19)up(E,B,M);else if(E.child!==null){E.child.return=E,E=E.child;continue}if(E===M)break e;for(;E.sibling===null;){if(E.return===null||E.return===M)break e;E=E.return}E.sibling.return=E.return,E=E.sibling}H&=1}if(Rn(ba,H),!(M.mode&1))M.memoizedState=null;else switch(ee){case"forwards":for(B=M.child,ee=null;B!==null;)E=B.alternate,E!==null&&Fd(E)===null&&(ee=B),B=B.sibling;B=ee,B===null?(ee=M.child,M.child=null):(ee=B.sibling,B.sibling=null),Ly(M,!1,ee,B,oe);break;case"backwards":for(B=null,ee=M.child,M.child=null;ee!==null;){if(E=ee.alternate,E!==null&&Fd(E)===null){M.child=ee;break}E=ee.sibling,ee.sibling=B,B=ee,ee=E}Ly(M,!0,B,null,oe);break;case"together":Ly(M,!1,null,null,void 0);break;default:M.memoizedState=null}return M.child}function dc(E,M,B){if(E!==null&&(M.dependencies=E.dependencies),qd|=M.lanes,!(B&M.childLanes))return null;if(E!==null&&M.child!==E.child)throw Error(d(153));if(M.child!==null){for(E=M.child,B=Gc(E,E.pendingProps),M.child=B,B.return=M;E.sibling!==null;)E=E.sibling,B=B.sibling=Gc(E,E.pendingProps),B.return=M;B.sibling=null}return M.child}function Hd(E,M,B){switch(M.tag){case 3:Ty(M),Nd();break;case 5:sc(M);break;case 1:Ja(M.type)&&Jn(M);break;case 4:uy(M,M.stateNode.containerInfo);break;case 10:kd(M,M.type._context,M.memoizedProps.value);break;case 13:var H=M.memoizedState;if(H!==null)return H.dehydrated!==null?(Rn(ba,ba.current&1),M.flags|=128,null):B&M.child.childLanes?q_(E,M,B):(Rn(ba,ba.current&1),E=dc(E,M,B),E!==null?E.sibling:null);Rn(ba,ba.current&1);break;case 19:if(H=(B&M.childLanes)!==0,E.flags&128){if(H)return Ou(E,M,B);M.flags|=128}var ee=M.memoizedState;if(ee!==null&&(ee.rendering=null,ee.tail=null,ee.lastEffect=null),Rn(ba,ba.current),H)break;return null;case 22:case 23:return M.lanes=0,m2(E,M,B)}return dc(E,M,B)}function v2(E,M){switch(L_(M),M.tag){case 1:return Ja(M.type)&&fa(),E=M.flags,E&65536?(M.flags=E&-65537|128,M):null;case 3:return Nc(),ri(Ia),ri(Di),Wf(),E=M.flags,E&65536&&!(E&128)?(M.flags=E&-65537|128,M):null;case 5:return Uf(M),null;case 13:if(ri(ba),E=M.memoizedState,E!==null&&E.dehydrated!==null){if(M.alternate===null)throw Error(d(340));Nd()}return E=M.flags,E&65536?(M.flags=E&-65537|128,M):null;case 19:return ri(ba),null;case 4:return Nc(),null;case 10:return Br(M.type._context),null;case 22:case 23:return ym(),null;case 24:return null;default:return null}}var dp=!1,zc=!1,Ry=typeof WeakSet=="function"?WeakSet:Set,An=null;function em(E,M){var B=E.ref;if(B!==null)if(typeof B=="function")try{B(null)}catch(H){$o(E,M,H)}else B.current=null}function jd(E,M,B){try{B()}catch(H){$o(E,M,H)}}var _2=!1;function SC(E,M){for(me(E.containerInfo),An=M;An!==null;)if(E=An,M=E.child,(E.subtreeFlags&1028)!==0&&M!==null)M.return=E,An=M;else for(;An!==null;){E=An;try{var B=E.alternate;if(E.flags&1024)switch(E.tag){case 0:case 11:case 15:break;case 1:if(B!==null){var H=B.memoizedProps,ee=B.memoizedState,oe=E.stateNode,Ye=oe.getSnapshotBeforeUpdate(E.elementType===E.type?H:Eo(E.type,H),ee);oe.__reactInternalSnapshotBeforeUpdate=Ye}break;case 3:At&&Qe(E.stateNode.containerInfo);break;case 5:case 6:case 4:case 17:break;default:throw Error(d(163))}}catch(xt){$o(E,E.return,xt)}if(M=E.sibling,M!==null){M.return=E.return,An=M;break}An=E.return}return B=_2,_2=!1,B}function Nu(E,M,B){var H=M.updateQueue;if(H=H!==null?H.lastEffect:null,H!==null){var ee=H=H.next;do{if((ee.tag&E)===E){var oe=ee.destroy;ee.destroy=void 0,oe!==void 0&&jd(M,B,oe)}ee=ee.next}while(ee!==H)}}function tm(E,M){if(M=M.updateQueue,M=M!==null?M.lastEffect:null,M!==null){var B=M=M.next;do{if((B.tag&E)===E){var H=B.create;B.destroy=H()}B=B.next}while(B!==M)}}function nm(E){var M=E.ref;if(M!==null){var B=E.stateNode;switch(E.tag){case 5:E=Ie(B);break;default:E=B}typeof M=="function"?M(E):M.current=E}}function im(E,M,B){if(an&&typeof an.onCommitFiberUnmount=="function")try{an.onCommitFiberUnmount(Ks,M)}catch{}switch(M.tag){case 0:case 11:case 14:case 15:if(E=M.updateQueue,E!==null&&(E=E.lastEffect,E!==null)){var H=E=E.next;do{var ee=H,oe=ee.destroy;ee=ee.tag,oe!==void 0&&(ee&2||ee&4)&&jd(M,B,oe),H=H.next}while(H!==E)}break;case 1:if(em(M,B),E=M.stateNode,typeof E.componentWillUnmount=="function")try{E.props=M.memoizedProps,E.state=M.memoizedState,E.componentWillUnmount()}catch(Ye){$o(M,B,Ye)}break;case 5:em(M,B);break;case 4:At?Z_(E,M,B):Pe&&Pe&&(M=M.stateNode.containerInfo,B=Te(M),tt(M,B))}}function Fc(E,M,B){for(var H=M;;)if(im(E,H,B),H.child===null||At&&H.tag===4){if(H===M)break;for(;H.sibling===null;){if(H.return===null||H.return===M)return;H=H.return}H.sibling.return=H.return,H=H.sibling}else H.child.return=H,H=H.child}function ky(E){var M=E.alternate;M!==null&&(E.alternate=null,ky(M)),E.child=null,E.deletions=null,E.sibling=null,E.tag===5&&(M=E.stateNode,M!==null&&ue(M)),E.stateNode=null,E.return=null,E.dependencies=null,E.memoizedProps=null,E.memoizedState=null,E.pendingProps=null,E.stateNode=null,E.updateQueue=null}function Bc(E){return E.tag===5||E.tag===3||E.tag===4}function Dy(E){e:for(;;){for(;E.sibling===null;){if(E.return===null||Bc(E.return))return null;E=E.return}for(E.sibling.return=E.return,E=E.sibling;E.tag!==5&&E.tag!==6&&E.tag!==18;){if(E.flags&2||E.child===null||E.tag===4)continue e;E.child.return=E,E=E.child}if(!(E.flags&2))return E.stateNode}}function am(E){if(At){e:{for(var M=E.return;M!==null;){if(Bc(M))break e;M=M.return}throw Error(d(160))}var B=M;switch(B.tag){case 5:M=B.stateNode,B.flags&32&&(Pt(M),B.flags&=-33),B=Dy(E),rs(E,B,M);break;case 3:case 4:M=B.stateNode.containerInfo,B=Dy(E),hp(E,B,M);break;default:throw Error(d(161))}}}function hp(E,M,B){var H=E.tag;if(H===5||H===6)E=E.stateNode,M?wt(B,E,M):Et(B,E);else if(H!==4&&(E=E.child,E!==null))for(hp(E,M,B),E=E.sibling;E!==null;)hp(E,M,B),E=E.sibling}function rs(E,M,B){var H=E.tag;if(H===5||H===6)E=E.stateNode,M?Dt(B,E,M):lt(B,E);else if(H!==4&&(E=E.child,E!==null))for(rs(E,M,B),E=E.sibling;E!==null;)rs(E,M,B),E=E.sibling}function Z_(E,M,B){for(var H=M,ee=!1,oe,Ye;;){if(!ee){ee=H.return;e:for(;;){if(ee===null)throw Error(d(160));switch(oe=ee.stateNode,ee.tag){case 5:Ye=!1;break e;case 3:oe=oe.containerInfo,Ye=!0;break e;case 4:oe=oe.containerInfo,Ye=!0;break e}ee=ee.return}ee=!0}if(H.tag===5||H.tag===6)Fc(E,H,B),Ye?He(oe,H.stateNode):Xt(oe,H.stateNode);else if(H.tag===18)Ye?zt(oe,H.stateNode):Lt(oe,H.stateNode);else if(H.tag===4){if(H.child!==null){oe=H.stateNode.containerInfo,Ye=!0,H.child.return=H,H=H.child;continue}}else if(im(E,H,B),H.child!==null){H.child.return=H,H=H.child;continue}if(H===M)break;for(;H.sibling===null;){if(H.return===null||H.return===M)return;H=H.return,H.tag===4&&(ee=!1)}H.sibling.return=H.return,H=H.sibling}}function Oy(E,M){if(At){switch(M.tag){case 0:case 11:case 14:case 15:Nu(3,M,M.return),tm(3,M),Nu(5,M,M.return);return;case 1:return;case 5:var B=M.stateNode;if(B!=null){var H=M.memoizedProps;E=E!==null?E.memoizedProps:H;var ee=M.type,oe=M.updateQueue;M.updateQueue=null,oe!==null&&Ht(B,oe,ee,E,H,M)}return;case 6:if(M.stateNode===null)throw Error(d(162));B=M.memoizedProps,Ut(M.stateNode,E!==null?E.memoizedProps:B,B);return;case 3:ft&&E!==null&&E.memoizedState.isDehydrated&&bt(M.stateNode.containerInfo);return;case 12:return;case 13:rm(M);return;case 19:rm(M);return;case 17:return}throw Error(d(163))}switch(M.tag){case 0:case 11:case 14:case 15:Nu(3,M,M.return),tm(3,M),Nu(5,M,M.return);return;case 12:return;case 13:rm(M);return;case 19:rm(M);return;case 3:ft&&E!==null&&E.memoizedState.isDehydrated&&bt(M.stateNode.containerInfo);break;case 22:case 23:return}e:if(Pe){switch(M.tag){case 1:case 5:case 6:break e;case 3:case 4:M=M.stateNode,tt(M.containerInfo,M.pendingChildren);break e}throw Error(d(163))}}function rm(E){var M=E.updateQueue;if(M!==null){E.updateQueue=null;var B=E.stateNode;B===null&&(B=E.stateNode=new Ry),M.forEach(function(H){var ee=A2.bind(null,E,H);B.has(H)||(B.add(H),H.then(ee,ee))})}}function $d(E,M){for(An=M;An!==null;){M=An;var B=M.deletions;if(B!==null)for(var H=0;H<B.length;H++){var ee=B[H];try{var oe=E;At?Z_(oe,ee,M):Fc(oe,ee,M);var Ye=ee.alternate;Ye!==null&&(Ye.return=null),ee.return=null}catch(Dn){$o(ee,M,Dn)}}if(B=M.child,M.subtreeFlags&12854&&B!==null)B.return=M,An=B;else for(;An!==null;){M=An;try{var xt=M.flags;if(xt&32&&At&&Pt(M.stateNode),xt&512){var Yt=M.alternate;if(Yt!==null){var dn=Yt.ref;dn!==null&&(typeof dn=="function"?dn(null):dn.current=null)}}if(xt&8192)switch(M.tag){case 13:if(M.memoizedState!==null){var Tn=M.alternate;(Tn===null||Tn.memoizedState===null)&&(Gy=oa())}break;case 22:var Si=M.memoizedState!==null,ti=M.alternate,wa=ti!==null&&ti.memoizedState!==null;if(B=M,At){e:if(H=B,ee=Si,oe=null,At)for(var Hn=H;;){if(Hn.tag===5){if(oe===null){oe=Hn;var go=Hn.stateNode;ee?qt(go):hn(Hn.stateNode,Hn.memoizedProps)}}else if(Hn.tag===6){if(oe===null){var eo=Hn.stateNode;ee?Nt(eo):be(eo,Hn.memoizedProps)}}else if((Hn.tag!==22&&Hn.tag!==23||Hn.memoizedState===null||Hn===H)&&Hn.child!==null){Hn.child.return=Hn,Hn=Hn.child;continue}if(Hn===H)break;for(;Hn.sibling===null;){if(Hn.return===null||Hn.return===H)break e;oe===Hn&&(oe=null),Hn=Hn.return}oe===Hn&&(oe=null),Hn.sibling.return=Hn.return,Hn=Hn.sibling}}if(Si&&!wa&&B.mode&1){An=B;for(var Bt=B.child;Bt!==null;){for(B=An=Bt;An!==null;){H=An;var Mt=H.child;switch(H.tag){case 0:case 11:case 14:case 15:Nu(4,H,H.return);break;case 1:em(H,H.return);var Gt=H.stateNode;if(typeof Gt.componentWillUnmount=="function"){var En=H.return;try{Gt.props=H.memoizedProps,Gt.state=H.memoizedState,Gt.componentWillUnmount()}catch(Dn){$o(H,En,Dn)}}break;case 5:em(H,H.return);break;case 22:if(H.memoizedState!==null){sm(B);continue}}Mt!==null?(Mt.return=H,An=Mt):sm(B)}Bt=Bt.sibling}}}switch(xt&4102){case 2:am(M),M.flags&=-3;break;case 6:am(M),M.flags&=-3,Oy(M.alternate,M);break;case 4096:M.flags&=-4097;break;case 4100:M.flags&=-4097,Oy(M.alternate,M);break;case 4:Oy(M.alternate,M)}}catch(Dn){$o(M,M.return,Dn)}if(B=M.sibling,B!==null){B.return=M.return,An=B;break}An=M.return}}}function b2(E,M,B){An=E,om(E)}function om(E,M,B){for(var H=(E.mode&1)!==0;An!==null;){var ee=An,oe=ee.child;if(ee.tag===22&&H){var Ye=ee.memoizedState!==null||dp;if(!Ye){var xt=ee.alternate,Yt=xt!==null&&xt.memoizedState!==null||zc;xt=dp;var dn=zc;if(dp=Ye,(zc=Yt)&&!dn)for(An=ee;An!==null;)Ye=An,Yt=Ye.child,Ye.tag===22&&Ye.memoizedState!==null?K_(ee):Yt!==null?(Yt.return=Ye,An=Yt):K_(ee);for(;oe!==null;)An=oe,om(oe),oe=oe.sibling;An=ee,dp=xt,zc=dn}Ny(E)}else ee.subtreeFlags&8772&&oe!==null?(oe.return=ee,An=oe):Ny(E)}}function Ny(E){for(;An!==null;){var M=An;if(M.flags&8772){var B=M.alternate;try{if(M.flags&8772)switch(M.tag){case 0:case 11:case 15:zc||tm(5,M);break;case 1:var H=M.stateNode;if(M.flags&4&&!zc)if(B===null)H.componentDidMount();else{var ee=M.elementType===M.type?B.memoizedProps:Eo(M.type,B.memoizedProps);H.componentDidUpdate(ee,B.memoizedState,H.__reactInternalSnapshotBeforeUpdate)}var oe=M.updateQueue;oe!==null&&Mr(M,oe,H);break;case 3:var Ye=M.updateQueue;if(Ye!==null){if(B=null,M.child!==null)switch(M.child.tag){case 5:B=Ie(M.child.stateNode);break;case 1:B=M.child.stateNode}Mr(M,Ye,B)}break;case 5:var xt=M.stateNode;B===null&&M.flags&4&&Wt(xt,M.type,M.memoizedProps,M);break;case 6:break;case 4:break;case 12:break;case 13:if(ft&&M.memoizedState===null){var Yt=M.alternate;if(Yt!==null){var dn=Yt.memoizedState;if(dn!==null){var Tn=dn.dehydrated;Tn!==null&&Ot(Tn)}}}break;case 19:case 17:case 21:case 22:case 23:break;default:throw Error(d(163))}zc||M.flags&512&&nm(M)}catch(Si){$o(M,M.return,Si)}}if(M===E){An=null;break}if(B=M.sibling,B!==null){B.return=M.return,An=B;break}An=M.return}}function sm(E){for(;An!==null;){var M=An;if(M===E){An=null;break}var B=M.sibling;if(B!==null){B.return=M.return,An=B;break}An=M.return}}function K_(E){for(;An!==null;){var M=An;try{switch(M.tag){case 0:case 11:case 15:var B=M.return;try{tm(4,M)}catch(Yt){$o(M,B,Yt)}break;case 1:var H=M.stateNode;if(typeof H.componentDidMount=="function"){var ee=M.return;try{H.componentDidMount()}catch(Yt){$o(M,ee,Yt)}}var oe=M.return;try{nm(M)}catch(Yt){$o(M,oe,Yt)}break;case 5:var Ye=M.return;try{nm(M)}catch(Yt){$o(M,Ye,Yt)}}}catch(Yt){$o(M,M.return,Yt)}if(M===E){An=null;break}var xt=M.sibling;if(xt!==null){xt.return=M.return,An=xt;break}An=M.return}}var lm=0,Uc=1,zy=2,Fy=3,cm=4;if(typeof Symbol=="function"&&Symbol.for){var zu=Symbol.for;lm=zu("selector.component"),Uc=zu("selector.has_pseudo_class"),zy=zu("selector.role"),Fy=zu("selector.test_id"),cm=zu("selector.text")}function um(E){var M=gt(E);if(M!=null){if(typeof M.memoizedProps["data-testname"]!="string")throw Error(d(364));return M}if(E=De(E),E===null)throw Error(d(362));return E.stateNode.current}function By(E,M){switch(M.$$typeof){case lm:if(E.type===M.value)return!0;break;case Uc:e:{M=M.value,E=[E,0];for(var B=0;B<E.length;){var H=E[B++],ee=E[B++],oe=M[ee];if(H.tag!==5||!ne(H)){for(;oe!=null&&By(H,oe);)ee++,oe=M[ee];if(ee===M.length){M=!0;break e}else for(H=H.child;H!==null;)E.push(H,ee),H=H.sibling}}M=!1}return M;case zy:if(E.tag===5&&Oe(E.stateNode,M.value))return!0;break;case cm:if((E.tag===5||E.tag===6)&&(E=de(E),E!==null&&0<=E.indexOf(M.value)))return!0;break;case Fy:if(E.tag===5&&(E=E.memoizedProps["data-testname"],typeof E=="string"&&E.toLowerCase()===M.value.toLowerCase()))return!0;break;default:throw Error(d(365))}return!1}function Uy(E){switch(E.$$typeof){case lm:return"<"+(Y(E.value)||"Unknown")+">";case Uc:return":has("+(Uy(E)||"")+")";case zy:return'[role="'+E.value+'"]';case cm:return'"'+E.value+'"';case Fy:return'[data-testname="'+E.value+'"]';default:throw Error(d(365))}}function dm(E,M){var B=[];E=[E,0];for(var H=0;H<E.length;){var ee=E[H++],oe=E[H++],Ye=M[oe];if(ee.tag!==5||!ne(ee)){for(;Ye!=null&&By(ee,Ye);)oe++,Ye=M[oe];if(oe===M.length)B.push(ee);else for(ee=ee.child;ee!==null;)E.push(ee,oe),ee=ee.sibling}}return B}function hm(E,M){if(!je)throw Error(d(363));E=um(E),E=dm(E,M),M=[],E=Array.from(E);for(var B=0;B<E.length;){var H=E[B++];if(H.tag===5)ne(H)||M.push(H.stateNode);else for(H=H.child;H!==null;)E.push(H),H=H.sibling}return M}var x2=Math.ceil,pm=p.ReactCurrentDispatcher,Wy=p.ReactCurrentOwner,mr=p.ReactCurrentBatchConfig,Ni=0,$a=null,Cr=null,fo=0,Ls=0,Yd=Ka(0),Ur=0,pp=null,qd=0,fm=0,Vy=0,rr=null,os=null,Gy=0,Fu=1/0;function fp(){Fu=oa()+500}var Hy=!1,J_=null,Bu=null,jy=!1,Uu=null,mp=0,mm=0,Q_=null,$y=-1,ss=0;function mo(){return Ni&6?oa():$y!==-1?$y:$y=oa()}function Wu(E){return E.mode&1?Ni&2&&fo!==0?fo&-fo:ma.transition!==null?(ss===0&&(E=ic,ic<<=1,!(ic&4194240)&&(ic=64),ss=E),ss):(E=Un,E!==0?E:Be()):1}function Jr(E,M,B){if(50<mm)throw mm=0,Q_=null,Error(d(185));var H=Rs(E,M);return H===null?null:(Xs(H,M,B),(!(Ni&2)||H!==$a)&&(H===$a&&(!(Ni&2)&&(fm|=M),Ur===4&&ks(H,fo)),Qr(H,B),M===1&&Ni===0&&!(E.mode&1)&&(fp(),oi&&Oa())),H)}function Rs(E,M){E.lanes|=M;var B=E.alternate;for(B!==null&&(B.lanes|=M),B=E,E=E.return;E!==null;)E.childLanes|=M,B=E.alternate,B!==null&&(B.childLanes|=M),B=E,E=E.return;return B.tag===3?B.stateNode:null}function Qr(E,M){var B=E.callbackNode;Zh(E,M);var H=Il(E,E===$a?fo:0);if(H===0)B!==null&&Zs(B),E.callbackNode=null,E.callbackPriority=0;else if(M=H&-H,E.callbackPriority!==M){if(B!=null&&Zs(B),M===1)E.tag===0?Dc(Xd.bind(null,E)):kc(Xd.bind(null,E)),se?_e(function(){Ni===0&&Oa()}):ln(Ld,Oa),B=null;else{switch(at(H)){case 1:B=Ld;break;case 4:B=Ps;break;case 16:B=Ao;break;case 536870912:B=zf;break;default:B=Ao}B=sa(B,gm.bind(null,E))}E.callbackPriority=M,E.callbackNode=B}}function gm(E,M){if($y=-1,ss=0,Ni&6)throw Error(d(327));var B=E.callbackNode;if(Wr()&&E.callbackNode!==B)return null;var H=Il(E,E===$a?fo:0);if(H===0)return null;if(H&30||H&E.expiredLanes||M)M=vm(E,H);else{M=H;var ee=Ni;Ni|=2;var oe=qy();($a!==E||fo!==M)&&(fp(),Zd(E,M));do try{EC();break}catch(xt){S2(E,xt)}while(1);Au(),pm.current=oe,Ni=ee,Cr!==null?M=0:($a=null,fo=0,M=Ur)}if(M!==0){if(M===2&&(ee=ac(E),ee!==0&&(H=ee,M=un(E,ee))),M===1)throw B=pp,Zd(E,0),ks(E,H),Qr(E,oa()),B;if(M===6)ks(E,H);else{if(ee=E.current.alternate,!(H&30)&&!w2(ee)&&(M=vm(E,H),M===2&&(oe=ac(E),oe!==0&&(H=oe,M=un(E,oe))),M===1))throw B=pp,Zd(E,0),ks(E,H),Qr(E,oa()),B;switch(E.finishedWork=ee,E.finishedLanes=H,M){case 0:case 1:throw Error(d(345));case 2:Wc(E,os);break;case 3:if(ks(E,H),(H&130023424)===H&&(M=Gy+500-oa(),10<M)){if(Il(E,0)!==0)break;if(ee=E.suspendedLanes,(ee&H)!==H){mo(),E.pingedLanes|=E.suspendedLanes&ee;break}E.timeoutHandle=ct(Wc.bind(null,E,os),M);break}Wc(E,os);break;case 4:if(ks(E,H),(H&4194240)===H)break;for(M=E.eventTimes,ee=-1;0<H;){var Ye=31-Ar(H);oe=1<<Ye,Ye=M[Ye],Ye>ee&&(ee=Ye),H&=~oe}if(H=ee,H=oa()-H,H=(120>H?120:480>H?480:1080>H?1080:1920>H?1920:3e3>H?3e3:4320>H?4320:1960*x2(H/1960))-H,10<H){E.timeoutHandle=ct(Wc.bind(null,E,os),H);break}Wc(E,os);break;case 5:Wc(E,os);break;default:throw Error(d(329))}}}return Qr(E,oa()),E.callbackNode===B?gm.bind(null,E):null}function un(E,M){var B=rr;return E.current.memoizedState.isDehydrated&&(Zd(E,M).flags|=256),E=vm(E,M),E!==2&&(M=os,os=B,M!==null&&Yy(M)),E}function Yy(E){os===null?os=E:os.push.apply(os,E)}function w2(E){for(var M=E;;){if(M.flags&16384){var B=M.updateQueue;if(B!==null&&(B=B.stores,B!==null))for(var H=0;H<B.length;H++){var ee=B[H],oe=ee.getSnapshot;ee=ee.value;try{if(!Qa(oe(),ee))return!1}catch{return!1}}}if(B=M.child,M.subtreeFlags&16384&&B!==null)B.return=M,M=B;else{if(M===E)break;for(;M.sibling===null;){if(M.return===null||M.return===E)return!0;M=M.return}M.sibling.return=M.return,M=M.sibling}}return!0}function ks(E,M){for(M&=~Vy,M&=~fm,E.suspendedLanes|=M,E.pingedLanes&=~M,E=E.expirationTimes;0<M;){var B=31-Ar(M),H=1<<B;E[B]=-1,M&=~H}}function Xd(E){if(Ni&6)throw Error(d(327));Wr();var M=Il(E,0);if(!(M&1))return Qr(E,oa()),null;var B=vm(E,M);if(E.tag!==0&&B===2){var H=ac(E);H!==0&&(M=H,B=un(E,H))}if(B===1)throw B=pp,Zd(E,0),ks(E,M),Qr(E,oa()),B;if(B===6)throw Error(d(345));return E.finishedWork=E.current.alternate,E.finishedLanes=M,Wc(E,os),Qr(E,oa()),null}function mn(E){Uu!==null&&Uu.tag===0&&!(Ni&6)&&Wr();var M=Ni;Ni|=1;var B=mr.transition,H=Un;try{if(mr.transition=null,Un=1,E)return E()}finally{Un=H,mr.transition=B,Ni=M,!(Ni&6)&&Oa()}}function ym(){Ls=Yd.current,ri(Yd)}function Zd(E,M){E.finishedWork=null,E.finishedLanes=0;var B=E.timeoutHandle;if(B!==kt&&(E.timeoutHandle=kt,Ct(B)),Cr!==null)for(B=Cr.return;B!==null;){var H=B;switch(L_(H),H.tag){case 1:H=H.type.childContextTypes,H!=null&&fa();break;case 3:Nc(),ri(Ia),ri(Di),Wf();break;case 5:Uf(H);break;case 4:Nc();break;case 13:ri(ba);break;case 19:ri(ba);break;case 10:Br(H.type._context);break;case 22:case 23:ym()}B=B.return}if($a=E,Cr=E=Gc(E.current,null),fo=Ls=M,Ur=0,pp=null,Vy=fm=qd=0,os=rr=null,jo!==null){for(M=0;M<jo.length;M++)if(B=jo[M],H=B.interleaved,H!==null){B.interleaved=null;var ee=H.next,oe=B.pending;if(oe!==null){var Ye=oe.next;oe.next=ee,H.next=Ye}B.pending=H}jo=null}return E}function S2(E,M){do{var B=Cr;try{if(Au(),dy.current=by,hy){for(var H=er.memoizedState;H!==null;){var ee=H.queue;ee!==null&&(ee.pending=null),H=H.next}hy=!1}if(Bd=0,po=Oo=er=null,Vf=!1,ip=0,Wy.current=null,B===null||B.return===null){Ur=1,pp=M,Cr=null;break}e:{var oe=E,Ye=B.return,xt=B,Yt=M;if(M=fo,xt.flags|=32768,Yt!==null&&typeof Yt=="object"&&typeof Yt.then=="function"){var dn=Yt,Tn=xt,Si=Tn.tag;if(!(Tn.mode&1)&&(Si===0||Si===11||Si===15)){var ti=Tn.alternate;ti?(Tn.updateQueue=ti.updateQueue,Tn.memoizedState=ti.memoizedState,Tn.lanes=ti.lanes):(Tn.updateQueue=null,Tn.memoizedState=null)}var wa=$_(Ye);if(wa!==null){wa.flags&=-257,Sy(wa,Ye,xt,oe,M),wa.mode&1&&wy(oe,dn,M),M=wa,Yt=dn;var Hn=M.updateQueue;if(Hn===null){var go=new Set;go.add(Yt),M.updateQueue=go}else Hn.add(Yt);break e}else{if(!(M&1)){wy(oe,dn,M),Xy();break e}Yt=Error(d(426))}}else if(Na&&xt.mode&1){var eo=$_(Ye);if(eo!==null){!(eo.flags&65536)&&(eo.flags|=256),Sy(eo,Ye,xt,oe,M),ly(Yt);break e}}oe=Yt,Ur!==4&&(Ur=2),rr===null?rr=[oe]:rr.push(oe),Yt=lp(Yt,xt),xt=Ye;do{switch(xt.tag){case 3:xt.flags|=65536,M&=-M,xt.lanes|=M;var Bt=xy(xt,Yt,M);iy(xt,Bt);break e;case 1:oe=Yt;var Mt=xt.type,Gt=xt.stateNode;if(!(xt.flags&128)&&(typeof Mt.getDerivedStateFromError=="function"||Gt!==null&&typeof Gt.componentDidCatch=="function"&&(Bu===null||!Bu.has(Gt)))){xt.flags|=65536,M&=-M,xt.lanes|=M;var En=j_(xt,oe,M);iy(xt,En);break e}}xt=xt.return}while(xt!==null)}Ky(B)}catch(Dn){M=Dn,Cr===B&&B!==null&&(Cr=B=B.return);continue}break}while(1)}function qy(){var E=pm.current;return pm.current=by,E===null?by:E}function Xy(){(Ur===0||Ur===3||Ur===2)&&(Ur=4),$a===null||!(qd&268435455)&&!(fm&268435455)||ks($a,fo)}function vm(E,M){var B=Ni;Ni|=2;var H=qy();$a===E&&fo===M||Zd(E,M);do try{AC();break}catch(ee){S2(E,ee)}while(1);if(Au(),Ni=B,pm.current=H,Cr!==null)throw Error(d(261));return $a=null,fo=0,Ur}function AC(){for(;Cr!==null;)Zy(Cr)}function EC(){for(;Cr!==null&&!Cs();)Zy(Cr)}function Zy(E){var M=Ds(E.alternate,E,Ls);E.memoizedProps=E.pendingProps,M===null?Ky(E):Cr=M,Wy.current=null}function Ky(E){var M=E;do{var B=M.alternate;if(E=M.return,M.flags&32768){if(B=v2(B,M),B!==null){B.flags&=32767,Cr=B;return}if(E!==null)E.flags|=32768,E.subtreeFlags=0,E.deletions=null;else{Ur=6,Cr=null;return}}else if(B=My(B,M,Ls),B!==null){Cr=B;return}if(M=M.sibling,M!==null){Cr=M;return}Cr=M=E}while(M!==null);Ur===0&&(Ur=5)}function Wc(E,M){var B=Un,H=mr.transition;try{mr.transition=null,Un=1,e1(E,M,B)}finally{mr.transition=H,Un=B}return null}function e1(E,M,B){do Wr();while(Uu!==null);if(Ni&6)throw Error(d(327));var H=E.finishedWork,ee=E.finishedLanes;if(H===null)return null;if(E.finishedWork=null,E.finishedLanes=0,H===E.current)throw Error(d(177));E.callbackNode=null,E.callbackPriority=0;var oe=H.lanes|H.childLanes;if($t(E,oe),E===$a&&(Cr=$a=null,fo=0),!(H.subtreeFlags&2064)&&!(H.flags&2064)||jy||(jy=!0,sa(Ao,function(){return Wr(),null})),oe=(H.flags&15990)!==0,H.subtreeFlags&15990||oe){oe=mr.transition,mr.transition=null;var Ye=Un;Un=1;var xt=Ni;Ni|=4,Wy.current=null,SC(E,H),$d(E,H),xe(E.containerInfo),E.current=H,b2(H),Ga(),Ni=xt,Un=Ye,mr.transition=oe}else E.current=H;if(jy&&(jy=!1,Uu=E,mp=ee),oe=E.pendingLanes,oe===0&&(Bu=null),yi(H.stateNode),Qr(E,oa()),M!==null)for(B=E.onRecoverableError,H=0;H<M.length;H++)B(M[H]);if(Hy)throw Hy=!1,E=J_,J_=null,E;return mp&1&&E.tag!==0&&Wr(),oe=E.pendingLanes,oe&1?E===Q_?mm++:(mm=0,Q_=E):mm=0,Oa(),null}function Wr(){if(Uu!==null){var E=at(mp),M=mr.transition,B=Un;try{if(mr.transition=null,Un=16>E?16:E,Uu===null)var H=!1;else{if(E=Uu,Uu=null,mp=0,Ni&6)throw Error(d(331));var ee=Ni;for(Ni|=4,An=E.current;An!==null;){var oe=An,Ye=oe.child;if(An.flags&16){var xt=oe.deletions;if(xt!==null){for(var Yt=0;Yt<xt.length;Yt++){var dn=xt[Yt];for(An=dn;An!==null;){var Tn=An;switch(Tn.tag){case 0:case 11:case 15:Nu(8,Tn,oe)}var Si=Tn.child;if(Si!==null)Si.return=Tn,An=Si;else for(;An!==null;){Tn=An;var ti=Tn.sibling,wa=Tn.return;if(ky(Tn),Tn===dn){An=null;break}if(ti!==null){ti.return=wa,An=ti;break}An=wa}}}var Hn=oe.alternate;if(Hn!==null){var go=Hn.child;if(go!==null){Hn.child=null;do{var eo=go.sibling;go.sibling=null,go=eo}while(go!==null)}}An=oe}}if(oe.subtreeFlags&2064&&Ye!==null)Ye.return=oe,An=Ye;else e:for(;An!==null;){if(oe=An,oe.flags&2048)switch(oe.tag){case 0:case 11:case 15:Nu(9,oe,oe.return)}var Bt=oe.sibling;if(Bt!==null){Bt.return=oe.return,An=Bt;break e}An=oe.return}}var Mt=E.current;for(An=Mt;An!==null;){Ye=An;var Gt=Ye.child;if(Ye.subtreeFlags&2064&&Gt!==null)Gt.return=Ye,An=Gt;else e:for(Ye=Mt;An!==null;){if(xt=An,xt.flags&2048)try{switch(xt.tag){case 0:case 11:case 15:tm(9,xt)}}catch(Dn){$o(xt,xt.return,Dn)}if(xt===Ye){An=null;break e}var En=xt.sibling;if(En!==null){En.return=xt.return,An=En;break e}An=xt.return}}if(Ni=ee,Oa(),an&&typeof an.onPostCommitFiberRoot=="function")try{an.onPostCommitFiberRoot(Ks,E)}catch{}H=!0}return H}finally{Un=B,mr.transition=M}}return!1}function Vc(E,M,B){M=lp(B,M),M=xy(E,M,1),Ra(E,M),M=mo(),E=Rs(E,1),E!==null&&(Xs(E,1,M),Qr(E,M))}function $o(E,M,B){if(E.tag===3)Vc(E,E,B);else for(;M!==null;){if(M.tag===3){Vc(M,E,B);break}else if(M.tag===1){var H=M.stateNode;if(typeof M.type.getDerivedStateFromError=="function"||typeof H.componentDidCatch=="function"&&(Bu===null||!Bu.has(H))){E=lp(B,E),E=j_(M,E,1),Ra(M,E),E=mo(),M=Rs(M,1),M!==null&&(Xs(M,1,E),Qr(M,E));break}}M=M.return}}function t1(E,M,B){var H=E.pingCache;H!==null&&H.delete(M),M=mo(),E.pingedLanes|=E.suspendedLanes&B,$a===E&&(fo&B)===B&&(Ur===4||Ur===3&&(fo&130023424)===fo&&500>oa()-Gy?Zd(E,0):Vy|=B),Qr(E,M)}function Jy(E,M){M===0&&(E.mode&1?(M=Cl,Cl<<=1,!(Cl&130023424)&&(Cl=4194304)):M=1);var B=mo();E=Rs(E,M),E!==null&&(Xs(E,M,B),Qr(E,B))}function n1(E){var M=E.memoizedState,B=0;M!==null&&(B=M.retryLane),Jy(E,B)}function A2(E,M){var B=0;switch(E.tag){case 13:var H=E.stateNode,ee=E.memoizedState;ee!==null&&(B=ee.retryLane);break;case 19:H=E.stateNode;break;default:throw Error(d(314))}H!==null&&H.delete(M),Jy(E,B)}var Ds;Ds=function(E,M,B){if(E!==null)if(E.memoizedProps!==M.pendingProps||Ia.current)as=!0;else{if(!(E.lanes&B)&&!(M.flags&128))return as=!1,Hd(E,M,B);as=!!(E.flags&131072)}else as=!1,Na&&M.flags&1048576&&Qh(M,Bf,M.index);switch(M.lanes=0,M.tag){case 2:var H=M.type;E!==null&&(E.alternate=null,M.alternate=null,M.flags|=2),E=M.pendingProps;var ee=Sr(M,Di.current);Sn(M,B),ee=py(null,M,H,E,ee,B);var oe=Gf();return M.flags|=1,typeof ee=="object"&&ee!==null&&typeof ee.render=="function"&&ee.$$typeof===void 0?(M.tag=1,M.memoizedState=null,M.updateQueue=null,Ja(H)?(oe=!0,Jn(M)):oe=!1,M.memoizedState=ee.state!==null&&ee.state!==void 0?ee.state:null,ts(M),ee.updater=Qs,M.stateNode=ee,ee._reactInternals=M,I_(M,H,E,B),M=Kf(null,M,H,!0,oe,B)):(M.tag=0,Na&&oe&&Od(M),zo(null,M,ee,B),M=M.child),M;case 16:H=M.elementType;e:{switch(E!==null&&(E.alternate=null,M.alternate=null,M.flags|=2),E=M.pendingProps,ee=H._init,H=ee(H._payload),M.type=H,ee=M.tag=E2(H),E=Eo(H,E),ee){case 0:M=Y_(null,M,H,E,B);break e;case 1:M=y2(null,M,H,E,B);break e;case 11:M=Gd(null,M,H,E,B);break e;case 14:M=p2(null,M,H,Eo(H.type,E),B);break e}throw Error(d(306,H,""))}return M;case 0:return H=M.type,ee=M.pendingProps,ee=M.elementType===H?ee:Eo(H,ee),Y_(E,M,H,ee,B);case 1:return H=M.type,ee=M.pendingProps,ee=M.elementType===H?ee:Eo(H,ee),y2(E,M,H,ee,B);case 3:e:{if(Ty(M),E===null)throw Error(d(387));H=M.pendingProps,oe=M.memoizedState,ee=oe.element,P_(E,M),Mu(M,H,null,B);var Ye=M.memoizedState;if(H=Ye.element,ft&&oe.isDehydrated)if(oe={element:H,isDehydrated:!1,cache:Ye.cache,transitions:Ye.transitions},M.updateQueue.baseState=oe,M.memoizedState=oe,M.flags&256){ee=Error(d(423)),M=Cy(E,M,H,B,ee);break e}else if(H!==ee){ee=Error(d(424)),M=Cy(E,M,H,B,ee);break e}else for(ft&&(is=ei(M.stateNode.containerInfo),ho=M,Na=!0,kl=null,tl=!1),B=D_(M,null,H,B),M.child=B;B;)B.flags=B.flags&-3|4096,B=B.sibling;else{if(Nd(),H===ee){M=dc(E,M,B);break e}zo(E,M,H,B)}M=M.child}return M;case 5:return sc(M),E===null&&R_(M),H=M.type,ee=M.pendingProps,oe=E!==null?E.memoizedProps:null,Ye=ee.children,Ke(H,ee)?Ye=null:oe!==null&&Ke(H,oe)&&(M.flags|=32),g2(E,M),zo(E,M,Ye,B),M.child;case 6:return E===null&&R_(M),null;case 13:return q_(E,M,B);case 4:return uy(M,M.stateNode.containerInfo),H=M.pendingProps,E===null?M.child=Pu(M,null,H,B):zo(E,M,H,B),M.child;case 11:return H=M.type,ee=M.pendingProps,ee=M.elementType===H?ee:Eo(H,ee),Gd(E,M,H,ee,B);case 7:return zo(E,M,M.pendingProps,B),M.child;case 8:return zo(E,M,M.pendingProps.children,B),M.child;case 12:return zo(E,M,M.pendingProps.children,B),M.child;case 10:e:{if(H=M.type._context,ee=M.pendingProps,oe=M.memoizedProps,Ye=ee.value,kd(M,H,Ye),oe!==null)if(Qa(oe.value,Ye)){if(oe.children===ee.children&&!Ia.current){M=dc(E,M,B);break e}}else for(oe=M.child,oe!==null&&(oe.return=M);oe!==null;){var xt=oe.dependencies;if(xt!==null){Ye=oe.child;for(var Yt=xt.firstContext;Yt!==null;){if(Yt.context===H){if(oe.tag===1){Yt=ns(-1,B&-B),Yt.tag=2;var dn=oe.updateQueue;if(dn!==null){dn=dn.shared;var Tn=dn.pending;Tn===null?Yt.next=Yt:(Yt.next=Tn.next,Tn.next=Yt),dn.pending=Yt}}oe.lanes|=B,Yt=oe.alternate,Yt!==null&&(Yt.lanes|=B),La(oe.return,B,M),xt.lanes|=B;break}Yt=Yt.next}}else if(oe.tag===10)Ye=oe.type===M.type?null:oe.child;else if(oe.tag===18){if(Ye=oe.return,Ye===null)throw Error(d(341));Ye.lanes|=B,xt=Ye.alternate,xt!==null&&(xt.lanes|=B),La(Ye,B,M),Ye=oe.sibling}else Ye=oe.child;if(Ye!==null)Ye.return=oe;else for(Ye=oe;Ye!==null;){if(Ye===M){Ye=null;break}if(oe=Ye.sibling,oe!==null){oe.return=Ye.return,Ye=oe;break}Ye=Ye.return}oe=Ye}zo(E,M,ee.children,B),M=M.child}return M;case 9:return ee=M.type,H=M.pendingProps.children,Sn(M,B),ee=ar(ee),H=H(ee),M.flags|=1,zo(E,M,H,B),M.child;case 14:return H=M.type,ee=Eo(H,M.pendingProps),ee=Eo(H.type,ee),p2(E,M,H,ee,B);case 15:return f2(E,M,M.type,M.pendingProps,B);case 17:return H=M.type,ee=M.pendingProps,ee=M.elementType===H?ee:Eo(H,ee),E!==null&&(E.alternate=null,M.alternate=null,M.flags|=2),M.tag=1,Ja(H)?(E=!0,Jn(M)):E=!1,Sn(M,B),Jh(M,H,ee),I_(M,H,ee,B),Kf(null,M,H,!0,E,B);case 19:return Ou(E,M,B);case 22:return m2(E,M,B)}throw Error(d(156,M.tag))};function sa(E,M){return ln(E,M)}function Qy(E,M,B,H){this.tag=E,this.key=B,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=M,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=H,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ls(E,M,B,H){return new Qy(E,M,B,H)}function Kd(E){return E=E.prototype,!(!E||!E.isReactComponent)}function E2(E){if(typeof E=="function")return Kd(E)?1:0;if(E!=null){if(E=E.$$typeof,E===R)return 11;if(E===O)return 14}return 2}function Gc(E,M){var B=E.alternate;return B===null?(B=ls(E.tag,M,E.key,E.mode),B.elementType=E.elementType,B.type=E.type,B.stateNode=E.stateNode,B.alternate=E,E.alternate=B):(B.pendingProps=M,B.type=E.type,B.flags=0,B.subtreeFlags=0,B.deletions=null),B.flags=E.flags&14680064,B.childLanes=E.childLanes,B.lanes=E.lanes,B.child=E.child,B.memoizedProps=E.memoizedProps,B.memoizedState=E.memoizedState,B.updateQueue=E.updateQueue,M=E.dependencies,B.dependencies=M===null?null:{lanes:M.lanes,firstContext:M.firstContext},B.sibling=E.sibling,B.index=E.index,B.ref=E.ref,B}function ev(E,M,B,H,ee,oe){var Ye=2;if(H=E,typeof E=="function")Kd(E)&&(Ye=1);else if(typeof E=="string")Ye=5;else e:switch(E){case _:return rl(B.children,ee,oe,M);case x:Ye=8,ee|=8;break;case S:return E=ls(12,B,M,ee|2),E.elementType=S,E.lanes=oe,E;case D:return E=ls(13,B,M,ee),E.elementType=D,E.lanes=oe,E;case L:return E=ls(19,B,M,ee),E.elementType=L,E.lanes=oe,E;case F:return Vu(B,ee,oe,M);default:if(typeof E=="object"&&E!==null)switch(E.$$typeof){case T:Ye=10;break e;case I:Ye=9;break e;case R:Ye=11;break e;case O:Ye=14;break e;case N:Ye=16,H=null;break e}throw Error(d(130,E==null?E:typeof E,""))}return M=ls(Ye,B,M,ee),M.elementType=E,M.type=H,M.lanes=oe,M}function rl(E,M,B,H){return E=ls(7,E,H,M),E.lanes=B,E}function Vu(E,M,B,H){return E=ls(22,E,H,M),E.elementType=F,E.lanes=B,E.stateNode={},E}function Zt(E,M,B){return E=ls(6,E,null,M),E.lanes=B,E}function _n(E,M,B){return M=ls(4,E.children!==null?E.children:[],E.key,M),M.lanes=B,M.stateNode={containerInfo:E.containerInfo,pendingChildren:null,implementation:E.implementation},M}function _m(E,M,B,H,ee){this.tag=M,this.containerInfo=E,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=kt,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Id(0),this.expirationTimes=Id(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Id(0),this.identifierPrefix=H,this.onRecoverableError=ee,ft&&(this.mutableSourceEagerHydrationData=null)}function xa(E,M,B,H,ee,oe,Ye,xt,Yt){return E=new _m(E,M,B,xt,Yt),M===1?(M=1,oe===!0&&(M|=8)):M=0,oe=ls(3,null,null,M),E.current=oe,oe.stateNode=E,oe.memoizedState={element:H,isDehydrated:B,cache:null,transitions:null},ts(oe),E}function Yo(E){if(!E)return uo;E=E._reactInternals;e:{if(V(E)!==E||E.tag!==1)throw Error(d(170));var M=E;do{switch(M.tag){case 3:M=M.stateNode.context;break e;case 1:if(Ja(M.type)){M=M.stateNode.__reactInternalMemoizedMergedChildContext;break e}}M=M.return}while(M!==null);throw Error(d(171))}if(E.tag===1){var B=E.type;if(Ja(B))return Cn(E,B,M)}return M}function tv(E){var M=E._reactInternals;if(M===void 0)throw typeof E.render=="function"?Error(d(188)):(E=Object.keys(E).join(","),Error(d(268,E)));return E=fe(M),E===null?null:E.stateNode}function i1(E,M){if(E=E.memoizedState,E!==null&&E.dehydrated!==null){var B=E.retryLane;E.retryLane=B!==0&&B<M?B:M}}function qo(E,M){i1(E,M),(E=E.alternate)&&i1(E,M)}function MC(E){return E=fe(E),E===null?null:E.stateNode}function TC(){return null}return i.attemptContinuousHydration=function(E){if(E.tag===13){var M=mo();Jr(E,134217728,M),qo(E,134217728)}},i.attemptHydrationAtCurrentPriority=function(E){if(E.tag===13){var M=mo(),B=Wu(E);Jr(E,B,M),qo(E,B)}},i.attemptSynchronousHydration=function(E){switch(E.tag){case 3:var M=E.stateNode;if(M.current.memoizedState.isDehydrated){var B=Pl(M.pendingLanes);B!==0&&(bn(M,B|1),Qr(M,oa()),!(Ni&6)&&(fp(),Oa()))}break;case 13:var H=mo();mn(function(){return Jr(E,1,H)}),qo(E,1)}},i.batchedUpdates=function(E,M){var B=Ni;Ni|=1;try{return E(M)}finally{Ni=B,Ni===0&&(fp(),oi&&Oa())}},i.createComponentSelector=function(E){return{$$typeof:lm,value:E}},i.createContainer=function(E,M,B,H,ee,oe,Ye){return xa(E,M,!1,null,B,H,ee,oe,Ye)},i.createHasPseudoClassSelector=function(E){return{$$typeof:Uc,value:E}},i.createHydrationContainer=function(E,M,B,H,ee,oe,Ye,xt,Yt){return E=xa(B,H,!0,E,ee,oe,Ye,xt,Yt),E.context=Yo(null),B=E.current,H=mo(),ee=Wu(B),oe=ns(H,ee),oe.callback=M??null,Ra(B,oe),E.current.lanes=ee,Xs(E,ee,H),Qr(E,H),E},i.createPortal=function(E,M,B){var H=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:y,key:H==null?null:""+H,children:E,containerInfo:M,implementation:B}},i.createRoleSelector=function(E){return{$$typeof:zy,value:E}},i.createTestNameSelector=function(E){return{$$typeof:Fy,value:E}},i.createTextSelector=function(E){return{$$typeof:cm,value:E}},i.deferredUpdates=function(E){var M=Un,B=mr.transition;try{return mr.transition=null,Un=16,E()}finally{Un=M,mr.transition=B}},i.discreteUpdates=function(E,M,B,H,ee){var oe=Un,Ye=mr.transition;try{return mr.transition=null,Un=1,E(M,B,H,ee)}finally{Un=oe,mr.transition=Ye,Ni===0&&fp()}},i.findAllNodes=hm,i.findBoundingRects=function(E,M){if(!je)throw Error(d(363));M=hm(E,M),E=[];for(var B=0;B<M.length;B++)E.push(st(M[B]));for(M=E.length-1;0<M;M--){B=E[M];for(var H=B.x,ee=H+B.width,oe=B.y,Ye=oe+B.height,xt=M-1;0<=xt;xt--)if(M!==xt){var Yt=E[xt],dn=Yt.x,Tn=dn+Yt.width,Si=Yt.y,ti=Si+Yt.height;if(H>=dn&&oe>=Si&&ee<=Tn&&Ye<=ti){E.splice(M,1);break}else if(H!==dn||B.width!==Yt.width||ti<oe||Si>Ye){if(!(oe!==Si||B.height!==Yt.height||Tn<H||dn>ee)){dn>H&&(Yt.width+=dn-H,Yt.x=H),Tn<ee&&(Yt.width=ee-dn),E.splice(M,1);break}}else{Si>oe&&(Yt.height+=Si-oe,Yt.y=oe),ti<Ye&&(Yt.height=Ye-Si),E.splice(M,1);break}}}return E},i.findHostInstance=tv,i.findHostInstanceWithNoPortals=function(E){return E=he(E),E=E!==null?pe(E):null,E===null?null:E.stateNode},i.findHostInstanceWithWarning=function(E){return tv(E)},i.flushControlled=function(E){var M=Ni;Ni|=1;var B=mr.transition,H=Un;try{mr.transition=null,Un=1,E()}finally{Un=H,mr.transition=B,Ni=M,Ni===0&&(fp(),Oa())}},i.flushPassiveEffects=Wr,i.flushSync=mn,i.focusWithin=function(E,M){if(!je)throw Error(d(363));for(E=um(E),M=dm(E,M),M=Array.from(M),E=0;E<M.length;){var B=M[E++];if(!ne(B)){if(B.tag===5&&ut(B.stateNode))return!0;for(B=B.child;B!==null;)M.push(B),B=B.sibling}}return!1},i.getCurrentUpdatePriority=function(){return Un},i.getFindAllNodesFailureDescription=function(E,M){if(!je)throw Error(d(363));var B=0,H=[];E=[um(E),0];for(var ee=0;ee<E.length;){var oe=E[ee++],Ye=E[ee++],xt=M[Ye];if((oe.tag!==5||!ne(oe))&&(By(oe,xt)&&(H.push(Uy(xt)),Ye++,Ye>B&&(B=Ye)),Ye<M.length))for(oe=oe.child;oe!==null;)E.push(oe,Ye),oe=oe.sibling}if(B<M.length){for(E=[];B<M.length;B++)E.push(Uy(M[B]));return`findAllNodes was able to match part of the selector:
  `+(H.join(" > ")+`

No matching component was found for:
  `)+E.join(" > ")}return null},i.getPublicRootInstance=function(E){if(E=E.current,!E.child)return null;switch(E.child.tag){case 5:return Ie(E.child.stateNode);default:return E.child.stateNode}},i.injectIntoDevTools=function(E){if(E={bundleType:E.bundleType,version:E.version,rendererPackageName:E.rendererPackageName,rendererConfig:E.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:p.ReactCurrentDispatcher,findHostInstanceByFiber:MC,findFiberByHostInstance:E.findFiberByHostInstance||TC,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.0.0-fc46dba67-20220329"},typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")E=!1;else{var M=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(M.isDisabled||!M.supportsFiber)E=!0;else{try{Ks=M.inject(E),an=M}catch{}E=!!M.checkDCE}}return E},i.isAlreadyRendering=function(){return!1},i.observeVisibleRects=function(E,M,B,H){if(!je)throw Error(d(363));E=hm(E,M);var ee=it(E,B,H).disconnect;return{disconnect:function(){ee()}}},i.registerMutableSourceForHydration=function(E,M){var B=M._getVersion;B=B(M._source),E.mutableSourceEagerHydrationData==null?E.mutableSourceEagerHydrationData=[M,B]:E.mutableSourceEagerHydrationData.push(M,B)},i.runWithPriority=function(E,M){var B=Un;try{return Un=E,M()}finally{Un=B}},i.shouldError=function(){return null},i.shouldSuspend=function(){return!1},i.updateContainer=function(E,M,B,H){var ee=M.current,oe=mo(),Ye=Wu(ee);return B=Yo(B),M.context===null?M.context=B:M.pendingContext=B,M=ns(oe,Ye),M.payload={element:E},H=H===void 0?null:H,H!==null&&(M.callback=H),Ra(ee,M),E=Jr(ee,Ye,oe),E!==null&&Eu(E,ee,Ye),Ye},i};oK.exports=HAe;var jAe=oK.exports;const $Ae=Iw(jAe);var sK={exports:{}},lK={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(n){function e(le,me){var xe=le.length;le.push(me);e:for(;0<xe;){var ae=xe-1>>>1,Ee=le[ae];if(0<s(Ee,me))le[ae]=me,le[xe]=Ee,xe=ae;else break e}}function i(le){return le.length===0?null:le[0]}function o(le){if(le.length===0)return null;var me=le[0],xe=le.pop();if(xe!==me){le[0]=xe;e:for(var ae=0,Ee=le.length,Je=Ee>>>1;ae<Je;){var Ze=2*(ae+1)-1,Ke=le[Ze],Fe=Ze+1,ct=le[Fe];if(0>s(Ke,xe))Fe<Ee&&0>s(ct,Ke)?(le[ae]=ct,le[Fe]=xe,ae=Fe):(le[ae]=Ke,le[Ze]=xe,ae=Ze);else if(Fe<Ee&&0>s(ct,xe))le[ae]=ct,le[Fe]=xe,ae=Fe;else break e}}return me}function s(le,me){var xe=le.sortIndex-me.sortIndex;return xe!==0?xe:le.id-me.id}if(typeof performance=="object"&&typeof performance.now=="function"){var l=performance;n.unstable_now=function(){return l.now()}}else{var d=Date,p=d.now();n.unstable_now=function(){return d.now()-p}}var f=[],y=[],_=1,x=null,S=3,T=!1,I=!1,R=!1,D=typeof setTimeout=="function"?setTimeout:null,L=typeof clearTimeout=="function"?clearTimeout:null,O=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function N(le){for(var me=i(y);me!==null;){if(me.callback===null)o(y);else if(me.startTime<=le)o(y),me.sortIndex=me.expirationTime,e(f,me);else break;me=i(y)}}function F(le){if(R=!1,N(le),!I)if(i(f)!==null)I=!0,Ie(G);else{var me=i(y);me!==null&&ze(F,me.startTime-le)}}function G(le,me){I=!1,R&&(R=!1,L(te),te=-1),T=!0;var xe=S;try{for(N(me),x=i(f);x!==null&&(!(x.expirationTime>me)||le&&!he());){var ae=x.callback;if(typeof ae=="function"){x.callback=null,S=x.priorityLevel;var Ee=ae(x.expirationTime<=me);me=n.unstable_now(),typeof Ee=="function"?x.callback=Ee:x===i(f)&&o(f),N(me)}else o(f);x=i(f)}if(x!==null)var Je=!0;else{var Ze=i(y);Ze!==null&&ze(F,Ze.startTime-me),Je=!1}return Je}finally{x=null,S=xe,T=!1}}var j=!1,Y=null,te=-1,V=5,Q=-1;function he(){return!(n.unstable_now()-Q<V)}function fe(){if(Y!==null){var le=n.unstable_now();Q=le;var me=!0;try{me=Y(!0,le)}finally{me?ye():(j=!1,Y=null)}}else j=!1}var ye;if(typeof O=="function")ye=function(){O(fe)};else if(typeof MessageChannel<"u"){var pe=new MessageChannel,Me=pe.port2;pe.port1.onmessage=fe,ye=function(){Me.postMessage(null)}}else ye=function(){D(fe,0)};function Ie(le){Y=le,j||(j=!0,ye())}function ze(le,me){te=D(function(){le(n.unstable_now())},me)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(le){le.callback=null},n.unstable_continueExecution=function(){I||T||(I=!0,Ie(G))},n.unstable_forceFrameRate=function(le){0>le||125<le?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):V=0<le?Math.floor(1e3/le):5},n.unstable_getCurrentPriorityLevel=function(){return S},n.unstable_getFirstCallbackNode=function(){return i(f)},n.unstable_next=function(le){switch(S){case 1:case 2:case 3:var me=3;break;default:me=S}var xe=S;S=me;try{return le()}finally{S=xe}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(le,me){switch(le){case 1:case 2:case 3:case 4:case 5:break;default:le=3}var xe=S;S=le;try{return me()}finally{S=xe}},n.unstable_scheduleCallback=function(le,me,xe){var ae=n.unstable_now();switch(typeof xe=="object"&&xe!==null?(xe=xe.delay,xe=typeof xe=="number"&&0<xe?ae+xe:ae):xe=ae,le){case 1:var Ee=-1;break;case 2:Ee=250;break;case 5:Ee=1073741823;break;case 4:Ee=1e4;break;default:Ee=5e3}return Ee=xe+Ee,le={id:_++,callback:me,priorityLevel:le,startTime:xe,expirationTime:Ee,sortIndex:-1},xe>ae?(le.sortIndex=xe,e(y,le),i(f)===null&&le===i(y)&&(R?(L(te),te=-1):R=!0,ze(F,xe-ae))):(le.sortIndex=Ee,e(f,le),I||T||(I=!0,Ie(G))),le},n.unstable_shouldYield=he,n.unstable_wrapCallback=function(le){var me=S;return function(){var xe=S;S=me;try{return le.apply(this,arguments)}finally{S=xe}}}})(lK);sK.exports=lK;var YV=sK.exports;const YAe=n=>typeof n=="object"&&typeof n.then=="function",yg=[];function cK(n,e,i=(o,s)=>o===s){if(n===e)return!0;if(!n||!e)return!1;const o=n.length;if(e.length!==o)return!1;for(let s=0;s<o;s++)if(!i(n[s],e[s]))return!1;return!0}function uK(n,e=null,i=!1,o={}){e===null&&(e=[n]);for(const l of yg)if(cK(e,l.keys,l.equal)){if(i)return;if(Object.prototype.hasOwnProperty.call(l,"error"))throw l.error;if(Object.prototype.hasOwnProperty.call(l,"response"))return o.lifespan&&o.lifespan>0&&(l.timeout&&clearTimeout(l.timeout),l.timeout=setTimeout(l.remove,o.lifespan)),l.response;if(!i)throw l.promise}const s={keys:e,equal:o.equal,remove:()=>{const l=yg.indexOf(s);l!==-1&&yg.splice(l,1)},promise:(YAe(n)?n:n(...e)).then(l=>{s.response=l,o.lifespan&&o.lifespan>0&&(s.timeout=setTimeout(s.remove,o.lifespan))}).catch(l=>s.error=l)};if(yg.push(s),!i)throw s.promise}const dK=(n,e,i)=>uK(n,e,!1,i),qAe=(n,e,i)=>void uK(n,e,!0,i),XAe=n=>{if(n===void 0||n.length===0)yg.splice(0,yg.length);else{const e=yg.find(i=>cK(n,i.keys,i.equal));e&&e.remove()}},B6={},ZAe=n=>void Object.assign(B6,n);function KAe(n,e){function i(_,{args:x=[],attach:S,...T},I){let R=`${_[0].toUpperCase()}${_.slice(1)}`,D;if(_==="primitive"){if(T.object===void 0)throw new Error("R3F: Primitives without 'object' are invalid!");const L=T.object;D=h0(L,{type:_,root:I,attach:S,primitive:!0})}else{const L=B6[R];if(!L)throw new Error(`R3F: ${R} is not part of the THREE namespace! Did you forget to extend? See: https://docs.pmnd.rs/react-three-fiber/api/objects#using-3rd-party-objects-declaratively`);if(!Array.isArray(x))throw new Error("R3F: The args prop must be an array!");D=h0(new L(...x),{type:_,root:I,attach:S,memoizedProps:{args:x}})}return D.__r3f.attach===void 0&&(D instanceof ki?D.__r3f.attach="geometry":D instanceof es&&(D.__r3f.attach="material")),R!=="inject"&&cI(D,T),D}function o(_,x){let S=!1;if(x){var T,I;(T=x.__r3f)!=null&&T.attach?lI(_,x,x.__r3f.attach):x.isObject3D&&_.isObject3D&&(_.add(x),S=!0),S||(I=_.__r3f)==null||I.objects.push(x),x.__r3f||h0(x,{}),x.__r3f.parent=_,WR(x),p0(x)}}function s(_,x,S){let T=!1;if(x){var I,R;if((I=x.__r3f)!=null&&I.attach)lI(_,x,x.__r3f.attach);else if(x.isObject3D&&_.isObject3D){x.parent=_,x.dispatchEvent({type:"added"});const D=_.children.filter(O=>O!==x),L=D.indexOf(S);_.children=[...D.slice(0,L),x,...D.slice(L)],T=!0}T||(R=_.__r3f)==null||R.objects.push(x),x.__r3f||h0(x,{}),x.__r3f.parent=_,WR(x),p0(x)}}function l(_,x,S=!1){_&&[..._].forEach(T=>d(x,T,S))}function d(_,x,S){if(x){var T,I,R;if(x.__r3f&&(x.__r3f.parent=null),(T=_.__r3f)!=null&&T.objects&&(_.__r3f.objects=_.__r3f.objects.filter(F=>F!==x)),(I=x.__r3f)!=null&&I.attach)JV(_,x,x.__r3f.attach);else if(x.isObject3D&&_.isObject3D){var D;_.remove(x),(D=x.__r3f)!=null&&D.root&&oEe(x.__r3f.root,x)}const O=(R=x.__r3f)==null?void 0:R.primitive,N=!O&&(S===void 0?x.dispose!==null:S);if(!O){var L;l((L=x.__r3f)==null?void 0:L.objects,x,N),l(x.children,x,N)}delete x.__r3f,N&&x.dispose&&x.type!=="Scene"&&YV.unstable_scheduleCallback(YV.unstable_IdlePriority,()=>{try{x.dispose()}catch{}}),p0(_)}}function p(_,x,S,T){var I;const R=(I=_.__r3f)==null?void 0:I.parent;if(!R)return;const D=i(x,S,_.__r3f.root);if(_.children){for(const L of _.children)L.__r3f&&o(D,L);_.children=_.children.filter(L=>!L.__r3f)}_.__r3f.objects.forEach(L=>o(D,L)),_.__r3f.objects=[],_.__r3f.autoRemovedBeforeAppend||d(R,_),D.parent&&(D.__r3f.autoRemovedBeforeAppend=!0),o(R,D),D.raycast&&D.__r3f.eventCount&&D.__r3f.root.getState().internal.interaction.push(D),[T,T.alternate].forEach(L=>{L!==null&&(L.stateNode=D,L.ref&&(typeof L.ref=="function"?L.ref(D):L.ref.current=D))})}const f=()=>console.warn("Text is not allowed in the R3F tree! This could be stray whitespace or characters.");return{reconciler:$Ae({createInstance:i,removeChild:d,appendChild:o,appendInitialChild:o,insertBefore:s,supportsMutation:!0,isPrimaryRenderer:!1,supportsPersistence:!1,supportsHydration:!1,noTimeout:-1,appendChildToContainer:(_,x)=>{if(!x)return;const S=_.getState().scene;S.__r3f&&(S.__r3f.root=_,o(S,x))},removeChildFromContainer:(_,x)=>{x&&d(_.getState().scene,x)},insertInContainerBefore:(_,x,S)=>{if(!x||!S)return;const T=_.getState().scene;T.__r3f&&s(T,x,S)},getRootHostContext:()=>null,getChildHostContext:_=>_,finalizeInitialChildren(_){var x;return!!((x=_==null?void 0:_.__r3f)!=null?x:{}).handlers},prepareUpdate(_,x,S,T){var I;if(((I=_==null?void 0:_.__r3f)!=null?I:{}).primitive&&T.object&&T.object!==_)return[!0];{const{args:D=[],children:L,...O}=T,{args:N=[],children:F,...G}=S;if(!Array.isArray(D))throw new Error("R3F: the args prop must be an array!");if(D.some((Y,te)=>Y!==N[te]))return[!0];const j=vK(_,O,G,!0);return j.changes.length?[!1,j]:null}},commitUpdate(_,[x,S],T,I,R,D){x?p(_,T,R,D):cI(_,S)},commitMount(_,x,S,T){var I;const R=(I=_.__r3f)!=null?I:{};_.raycast&&R.handlers&&R.eventCount&&_.__r3f.root.getState().internal.interaction.push(_)},getPublicInstance:_=>_,prepareForCommit:()=>null,preparePortalMount:_=>h0(_.getState().scene),resetAfterCommit:()=>{},shouldSetTextContent:()=>!1,clearContainer:()=>!1,hideInstance(_){var x;const{attach:S,parent:T}=(x=_.__r3f)!=null?x:{};S&&T&&JV(T,_,S),_.isObject3D&&(_.visible=!1),p0(_)},unhideInstance(_,x){var S;const{attach:T,parent:I}=(S=_.__r3f)!=null?S:{};T&&I&&lI(I,_,T),(_.isObject3D&&x.visible==null||x.visible)&&(_.visible=!0),p0(_)},createTextInstance:f,hideTextInstance:f,unhideTextInstance:f,getCurrentEventPriority:()=>e?e():R0.DefaultEventPriority,beforeActiveInstanceBlur:()=>{},afterActiveInstanceBlur:()=>{},detachDeletedInstance:()=>{},now:typeof performance<"u"&&lr.fun(performance.now)?performance.now:lr.fun(Date.now)?Date.now:()=>0,scheduleTimeout:lr.fun(setTimeout)?setTimeout:void 0,cancelTimeout:lr.fun(clearTimeout)?clearTimeout:void 0}),applyProps:cI}}var qV,XV;const sI=n=>"colorSpace"in n||"outputColorSpace"in n,hK=()=>{var n;return(n=B6.ColorManagement)!=null?n:null},pK=n=>n&&n.isOrthographicCamera,JAe=n=>n&&n.hasOwnProperty("current"),t2=typeof window<"u"&&((qV=window.document)!=null&&qV.createElement||((XV=window.navigator)==null?void 0:XV.product)==="ReactNative")?ie.useLayoutEffect:ie.useEffect;function fK(n){const e=ie.useRef(n);return t2(()=>void(e.current=n),[n]),e}function QAe({set:n}){return t2(()=>(n(new Promise(()=>null)),()=>n(!1)),[n]),null}class mK extends ie.Component{constructor(...e){super(...e),this.state={error:!1}}componentDidCatch(e){this.props.set(e)}render(){return this.state.error?null:this.props.children}}mK.getDerivedStateFromError=()=>({error:!0});const gK="__default",ZV=new Map,eEe=n=>n&&!!n.memoized&&!!n.changes;function yK(n){var e;const i=typeof window<"u"?(e=window.devicePixelRatio)!=null?e:2:1;return Array.isArray(n)?Math.min(Math.max(n[0],i),n[1]):n}const Sb=n=>{var e;return(e=n.__r3f)==null?void 0:e.root.getState()},lr={obj:n=>n===Object(n)&&!lr.arr(n)&&typeof n!="function",fun:n=>typeof n=="function",str:n=>typeof n=="string",num:n=>typeof n=="number",boo:n=>typeof n=="boolean",und:n=>n===void 0,arr:n=>Array.isArray(n),equ(n,e,{arrays:i="shallow",objects:o="reference",strict:s=!0}={}){if(typeof n!=typeof e||!!n!=!!e)return!1;if(lr.str(n)||lr.num(n))return n===e;const l=lr.obj(n);if(l&&o==="reference")return n===e;const d=lr.arr(n);if(d&&i==="reference")return n===e;if((d||l)&&n===e)return!0;let p;for(p in n)if(!(p in e))return!1;if(l&&i==="shallow"&&o==="shallow"){for(p in s?e:n)if(!lr.equ(n[p],e[p],{strict:s,objects:"reference"}))return!1}else for(p in s?e:n)if(n[p]!==e[p])return!1;if(lr.und(p)){if(d&&n.length===0&&e.length===0||l&&Object.keys(n).length===0&&Object.keys(e).length===0)return!0;if(n!==e)return!1}return!0}};function tEe(n){const e={nodes:{},materials:{}};return n&&n.traverse(i=>{i.name&&(e.nodes[i.name]=i),i.material&&!e.materials[i.material.name]&&(e.materials[i.material.name]=i.material)}),e}function nEe(n){n.dispose&&n.type!=="Scene"&&n.dispose();for(const e in n)e.dispose==null||e.dispose(),delete n[e]}function h0(n,e){const i=n;return i.__r3f={type:"",root:null,previousAttach:null,memoizedProps:{},eventCount:0,handlers:{},objects:[],parent:null,...e},n}function UR(n,e){let i=n;if(e.includes("-")){const o=e.split("-"),s=o.pop();return i=o.reduce((l,d)=>l[d],n),{target:i,key:s}}else return{target:i,key:e}}const KV=/-\d+$/;function lI(n,e,i){if(lr.str(i)){if(KV.test(i)){const l=i.replace(KV,""),{target:d,key:p}=UR(n,l);Array.isArray(d[p])||(d[p]=[])}const{target:o,key:s}=UR(n,i);e.__r3f.previousAttach=o[s],o[s]=e}else e.__r3f.previousAttach=i(n,e)}function JV(n,e,i){var o,s;if(lr.str(i)){const{target:l,key:d}=UR(n,i),p=e.__r3f.previousAttach;p===void 0?delete l[d]:l[d]=p}else(o=e.__r3f)==null||o.previousAttach==null||o.previousAttach(n,e);(s=e.__r3f)==null||delete s.previousAttach}function vK(n,{children:e,key:i,ref:o,...s},{children:l,key:d,ref:p,...f}={},y=!1){var _;const x=(_=n==null?void 0:n.__r3f)!=null?_:{},S=Object.entries(s),T=[];if(y){const R=Object.keys(f);for(let D=0;D<R.length;D++)s.hasOwnProperty(R[D])||S.unshift([R[D],gK+"remove"])}S.forEach(([R,D])=>{var L;if((L=n.__r3f)!=null&&L.primitive&&R==="object"||lr.equ(D,f[R]))return;if(/^on(Pointer|Click|DoubleClick|ContextMenu|Wheel)/.test(R))return T.push([R,D,!0,[]]);let O=[];R.includes("-")&&(O=R.split("-")),T.push([R,D,!1,O]);for(const N in s){const F=s[N];N.startsWith(`${R}-`)&&T.push([N,F,!1,N.split("-")])}});const I={...s};return x.memoizedProps&&x.memoizedProps.args&&(I.args=x.memoizedProps.args),x.memoizedProps&&x.memoizedProps.attach&&(I.attach=x.memoizedProps.attach),{memoized:I,changes:T}}const iEe=typeof process<"u"&&!1;function cI(n,e){var i,o,s;const l=(i=n.__r3f)!=null?i:{},d=l.root,p=(o=d==null||d.getState==null?void 0:d.getState())!=null?o:{},{memoized:f,changes:y}=eEe(e)?e:vK(n,e),_=l.eventCount;n.__r3f&&(n.__r3f.memoizedProps=f);for(let S=0;S<y.length;S++){let[T,I,R,D]=y[S];if(sI(n)){const F="srgb",G="srgb-linear";T==="encoding"?(T="colorSpace",I=I===3001?F:G):T==="outputEncoding"&&(T="outputColorSpace",I=I===3001?F:G)}let L=n,O=L[T];if(D.length&&(O=D.reduce((N,F)=>N[F],n),!(O&&O.set))){const[N,...F]=D.reverse();L=F.reverse().reduce((G,j)=>G[j],n),T=N}if(I===gK+"remove")if(L.constructor){let N=ZV.get(L.constructor);N||(N=new L.constructor,ZV.set(L.constructor,N)),I=N[T]}else I=0;if(R)I?l.handlers[T]=I:delete l.handlers[T],l.eventCount=Object.keys(l.handlers).length;else if(O&&O.set&&(O.copy||O instanceof Eg)){if(Array.isArray(I))O.fromArray?O.fromArray(I):O.set(...I);else if(O.copy&&I&&I.constructor&&(iEe?O.constructor.name===I.constructor.name:O.constructor===I.constructor))O.copy(I);else if(I!==void 0){const N=O instanceof Pn;!N&&O.setScalar?O.setScalar(I):O instanceof Eg&&I instanceof Eg?O.mask=I.mask:O.set(I),!hK()&&!p.linear&&N&&O.convertSRGBToLinear()}}else if(L[T]=I,L[T]instanceof Or&&L[T].format===ml&&L[T].type===yd){const N=L[T];sI(N)&&sI(p.gl)?N.colorSpace=p.gl.outputColorSpace:N.encoding=p.gl.outputEncoding}p0(n)}if(l.parent&&p.internal&&n.raycast&&_!==l.eventCount){const S=p.internal.interaction.indexOf(n);S>-1&&p.internal.interaction.splice(S,1),l.eventCount&&p.internal.interaction.push(n)}return!(y.length===1&&y[0][0]==="onUpdate")&&y.length&&(s=n.__r3f)!=null&&s.parent&&WR(n),n}function p0(n){var e,i;const o=(e=n.__r3f)==null||(i=e.root)==null||i.getState==null?void 0:i.getState();o&&o.internal.frames===0&&o.invalidate()}function WR(n){n.onUpdate==null||n.onUpdate(n)}function aEe(n,e){n.manual||(pK(n)?(n.left=e.width/-2,n.right=e.width/2,n.top=e.height/2,n.bottom=e.height/-2):n.aspect=e.width/e.height,n.updateProjectionMatrix(),n.updateMatrixWorld())}function fA(n){return(n.eventObject||n.object).uuid+"/"+n.index+n.instanceId}function rEe(){var n;const e=typeof self<"u"&&self||typeof window<"u"&&window;if(!e)return R0.DefaultEventPriority;switch((n=e.event)==null?void 0:n.type){case"click":case"contextmenu":case"dblclick":case"pointercancel":case"pointerdown":case"pointerup":return R0.DiscreteEventPriority;case"pointermove":case"pointerout":case"pointerover":case"pointerenter":case"pointerleave":case"wheel":return R0.ContinuousEventPriority;default:return R0.DefaultEventPriority}}function _K(n,e,i,o){const s=i.get(e);s&&(i.delete(e),i.size===0&&(n.delete(o),s.target.releasePointerCapture(o)))}function oEe(n,e){const{internal:i}=n.getState();i.interaction=i.interaction.filter(o=>o!==e),i.initialHits=i.initialHits.filter(o=>o!==e),i.hovered.forEach((o,s)=>{(o.eventObject===e||o.object===e)&&i.hovered.delete(s)}),i.capturedMap.forEach((o,s)=>{_K(i.capturedMap,e,o,s)})}function sEe(n){function e(f){const{internal:y}=n.getState(),_=f.offsetX-y.initialClick[0],x=f.offsetY-y.initialClick[1];return Math.round(Math.sqrt(_*_+x*x))}function i(f){return f.filter(y=>["Move","Over","Enter","Out","Leave"].some(_=>{var x;return(x=y.__r3f)==null?void 0:x.handlers["onPointer"+_]}))}function o(f,y){const _=n.getState(),x=new Set,S=[],T=y?y(_.internal.interaction):_.internal.interaction;for(let L=0;L<T.length;L++){const O=Sb(T[L]);O&&(O.raycaster.camera=void 0)}_.previousRoot||_.events.compute==null||_.events.compute(f,_);function I(L){const O=Sb(L);if(!O||!O.events.enabled||O.raycaster.camera===null)return[];if(O.raycaster.camera===void 0){var N;O.events.compute==null||O.events.compute(f,O,(N=O.previousRoot)==null?void 0:N.getState()),O.raycaster.camera===void 0&&(O.raycaster.camera=null)}return O.raycaster.camera?O.raycaster.intersectObject(L,!0):[]}let R=T.flatMap(I).sort((L,O)=>{const N=Sb(L.object),F=Sb(O.object);return!N||!F?L.distance-O.distance:F.events.priority-N.events.priority||L.distance-O.distance}).filter(L=>{const O=fA(L);return x.has(O)?!1:(x.add(O),!0)});_.events.filter&&(R=_.events.filter(R,_));for(const L of R){let O=L.object;for(;O;){var D;(D=O.__r3f)!=null&&D.eventCount&&S.push({...L,eventObject:O}),O=O.parent}}if("pointerId"in f&&_.internal.capturedMap.has(f.pointerId))for(let L of _.internal.capturedMap.get(f.pointerId).values())x.has(fA(L.intersection))||S.push(L.intersection);return S}function s(f,y,_,x){const S=n.getState();if(f.length){const T={stopped:!1};for(const I of f){const R=Sb(I.object)||S,{raycaster:D,pointer:L,camera:O,internal:N}=R,F=new Ue(L.x,L.y,0).unproject(O),G=Q=>{var he,fe;return(he=(fe=N.capturedMap.get(Q))==null?void 0:fe.has(I.eventObject))!=null?he:!1},j=Q=>{const he={intersection:I,target:y.target};N.capturedMap.has(Q)?N.capturedMap.get(Q).set(I.eventObject,he):N.capturedMap.set(Q,new Map([[I.eventObject,he]])),y.target.setPointerCapture(Q)},Y=Q=>{const he=N.capturedMap.get(Q);he&&_K(N.capturedMap,I.eventObject,he,Q)};let te={};for(let Q in y){let he=y[Q];typeof he!="function"&&(te[Q]=he)}let V={...I,...te,pointer:L,intersections:f,stopped:T.stopped,delta:_,unprojectedPoint:F,ray:D.ray,camera:O,stopPropagation(){const Q="pointerId"in y&&N.capturedMap.get(y.pointerId);if((!Q||Q.has(I.eventObject))&&(V.stopped=T.stopped=!0,N.hovered.size&&Array.from(N.hovered.values()).find(he=>he.eventObject===I.eventObject))){const he=f.slice(0,f.indexOf(I));l([...he,I])}},target:{hasPointerCapture:G,setPointerCapture:j,releasePointerCapture:Y},currentTarget:{hasPointerCapture:G,setPointerCapture:j,releasePointerCapture:Y},nativeEvent:y};if(x(V),T.stopped===!0)break}}return f}function l(f){const{internal:y}=n.getState();for(const _ of y.hovered.values())if(!f.length||!f.find(x=>x.object===_.object&&x.index===_.index&&x.instanceId===_.instanceId)){const S=_.eventObject.__r3f,T=S==null?void 0:S.handlers;if(y.hovered.delete(fA(_)),S!=null&&S.eventCount){const I={..._,intersections:f};T.onPointerOut==null||T.onPointerOut(I),T.onPointerLeave==null||T.onPointerLeave(I)}}}function d(f,y){for(let _=0;_<y.length;_++){const x=y[_].__r3f;x==null||x.handlers.onPointerMissed==null||x.handlers.onPointerMissed(f)}}function p(f){switch(f){case"onPointerLeave":case"onPointerCancel":return()=>l([]);case"onLostPointerCapture":return y=>{const{internal:_}=n.getState();"pointerId"in y&&_.capturedMap.has(y.pointerId)&&requestAnimationFrame(()=>{_.capturedMap.has(y.pointerId)&&(_.capturedMap.delete(y.pointerId),l([]))})}}return function(_){const{onPointerMissed:x,internal:S}=n.getState();S.lastEvent.current=_;const T=f==="onPointerMove",I=f==="onClick"||f==="onContextMenu"||f==="onDoubleClick",D=o(_,T?i:void 0),L=I?e(_):0;f==="onPointerDown"&&(S.initialClick=[_.offsetX,_.offsetY],S.initialHits=D.map(N=>N.eventObject)),I&&!D.length&&L<=2&&(d(_,S.interaction),x&&x(_)),T&&l(D);function O(N){const F=N.eventObject,G=F.__r3f,j=G==null?void 0:G.handlers;if(G!=null&&G.eventCount)if(T){if(j.onPointerOver||j.onPointerEnter||j.onPointerOut||j.onPointerLeave){const Y=fA(N),te=S.hovered.get(Y);te?te.stopped&&N.stopPropagation():(S.hovered.set(Y,N),j.onPointerOver==null||j.onPointerOver(N),j.onPointerEnter==null||j.onPointerEnter(N))}j.onPointerMove==null||j.onPointerMove(N)}else{const Y=j[f];Y?(!I||S.initialHits.includes(F))&&(d(_,S.interaction.filter(te=>!S.initialHits.includes(te))),Y(N)):I&&S.initialHits.includes(F)&&d(_,S.interaction.filter(te=>!S.initialHits.includes(te)))}}s(D,_,L,O)}}return{handlePointer:p}}const bK=n=>!!(n!=null&&n.render),xK=ie.createContext(null),lEe=(n,e)=>{const i=WAe((p,f)=>{const y=new Ue,_=new Ue,x=new Ue;function S(L=f().camera,O=_,N=f().size){const{width:F,height:G,top:j,left:Y}=N,te=F/G;O instanceof Ue?x.copy(O):x.set(...O);const V=L.getWorldPosition(y).distanceTo(x);if(pK(L))return{width:F/L.zoom,height:G/L.zoom,top:j,left:Y,factor:1,distance:V,aspect:te};{const Q=L.fov*Math.PI/180,he=2*Math.tan(Q/2)*V,fe=he*(F/G);return{width:fe,height:he,top:j,left:Y,factor:F/fe,distance:V,aspect:te}}}let T;const I=L=>p(O=>({performance:{...O.performance,current:L}})),R=new tn;return{set:p,get:f,gl:null,camera:null,raycaster:null,events:{priority:1,enabled:!0,connected:!1},xr:null,scene:null,invalidate:(L=1)=>n(f(),L),advance:(L,O)=>e(L,O,f()),legacy:!1,linear:!1,flat:!1,controls:null,clock:new O6,pointer:R,mouse:R,frameloop:"always",onPointerMissed:void 0,performance:{current:1,min:.5,max:1,debounce:200,regress:()=>{const L=f();T&&clearTimeout(T),L.performance.current!==L.performance.min&&I(L.performance.min),T=setTimeout(()=>I(f().performance.max),L.performance.debounce)}},size:{width:0,height:0,top:0,left:0,updateStyle:!1},viewport:{initialDpr:0,dpr:0,width:0,height:0,top:0,left:0,aspect:0,distance:0,factor:0,getCurrentViewport:S},setEvents:L=>p(O=>({...O,events:{...O.events,...L}})),setSize:(L,O,N,F,G)=>{const j=f().camera,Y={width:L,height:O,top:F||0,left:G||0,updateStyle:N};p(te=>({size:Y,viewport:{...te.viewport,...S(j,_,Y)}}))},setDpr:L=>p(O=>{const N=yK(L);return{viewport:{...O.viewport,dpr:N,initialDpr:O.viewport.initialDpr||N}}}),setFrameloop:(L="always")=>{const O=f().clock;O.stop(),O.elapsedTime=0,L!=="never"&&(O.start(),O.elapsedTime=0),p(()=>({frameloop:L}))},previousRoot:void 0,internal:{active:!1,priority:0,frames:0,lastEvent:ie.createRef(),interaction:[],hovered:new Map,subscribers:[],initialClick:[0,0],initialHits:[],capturedMap:new Map,subscribe:(L,O,N)=>{const F=f().internal;return F.priority=F.priority+(O>0?1:0),F.subscribers.push({ref:L,priority:O,store:N}),F.subscribers=F.subscribers.sort((G,j)=>G.priority-j.priority),()=>{const G=f().internal;G!=null&&G.subscribers&&(G.priority=G.priority-(O>0?1:0),G.subscribers=G.subscribers.filter(j=>j.ref!==L))}}}}}),o=i.getState();let s=o.size,l=o.viewport.dpr,d=o.camera;return i.subscribe(()=>{const{camera:p,size:f,viewport:y,gl:_,set:x}=i.getState();if(f.width!==s.width||f.height!==s.height||y.dpr!==l){var S;s=f,l=y.dpr,aEe(p,f),_.setPixelRatio(y.dpr);const T=(S=f.updateStyle)!=null?S:typeof HTMLCanvasElement<"u"&&_.domElement instanceof HTMLCanvasElement;_.setSize(f.width,f.height,T)}p!==d&&(d=p,x(T=>({viewport:{...T.viewport,...T.viewport.getCurrentViewport(p)}})))}),i.subscribe(p=>n(p)),i};let mA,cEe=new Set,uEe=new Set,dEe=new Set;function uI(n,e){if(n.size)for(const{callback:i}of n.values())i(e)}function Ab(n,e){switch(n){case"before":return uI(cEe,e);case"after":return uI(uEe,e);case"tail":return uI(dEe,e)}}let dI,hI;function pI(n,e,i){let o=e.clock.getDelta();for(e.frameloop==="never"&&typeof n=="number"&&(o=n-e.clock.elapsedTime,e.clock.oldTime=e.clock.elapsedTime,e.clock.elapsedTime=n),dI=e.internal.subscribers,mA=0;mA<dI.length;mA++)hI=dI[mA],hI.ref.current(hI.store.getState(),o,i);return!e.internal.priority&&e.gl.render&&e.gl.render(e.scene,e.camera),e.internal.frames=Math.max(0,e.internal.frames-1),e.frameloop==="always"?1:e.internal.frames}function hEe(n){let e=!1,i,o,s;function l(f){o=requestAnimationFrame(l),e=!0,i=0,Ab("before",f);for(const _ of n.values()){var y;s=_.store.getState(),s.internal.active&&(s.frameloop==="always"||s.internal.frames>0)&&!((y=s.gl.xr)!=null&&y.isPresenting)&&(i+=pI(f,s))}if(Ab("after",f),i===0)return Ab("tail",f),e=!1,cancelAnimationFrame(o)}function d(f,y=1){var _;if(!f)return n.forEach(x=>d(x.store.getState()),y);(_=f.gl.xr)!=null&&_.isPresenting||!f.internal.active||f.frameloop==="never"||(f.internal.frames=Math.min(60,f.internal.frames+y),e||(e=!0,requestAnimationFrame(l)))}function p(f,y=!0,_,x){if(y&&Ab("before",f),_)pI(f,_,x);else for(const S of n.values())pI(f,S.store.getState());y&&Ab("after",f)}return{loop:l,invalidate:d,advance:p}}function wK(){const n=ie.useContext(xK);if(!n)throw new Error("R3F: Hooks can only be used within the Canvas component!");return n}function _h(n=i=>i,e){return wK()(n,e)}function U6(n,e=0){const i=wK(),o=i.getState().internal.subscribe,s=fK(n);return t2(()=>o(s,e,i),[e,o,i]),null}const QV=new WeakMap;function SK(n,e){return function(i,...o){let s=QV.get(i);return s||(s=new i,QV.set(i,s)),n&&n(s),Promise.all(o.map(l=>new Promise((d,p)=>s.load(l,f=>{f.scene&&Object.assign(f,tEe(f.scene)),d(f)},e,f=>p(new Error(`Could not load ${l}: ${f==null?void 0:f.message}`)))))).finally(()=>s.dispose==null?void 0:s.dispose())}}function W6(n,e,i,o){const s=Array.isArray(e)?e:[e],l=dK(SK(i,o),[n,...s],{equal:lr.equ});return Array.isArray(e)?l:l[0]}W6.preload=function(n,e,i){const o=Array.isArray(e)?e:[e];return qAe(SK(i),[n,...o])};W6.clear=function(n,e){const i=Array.isArray(e)?e:[e];return XAe([n,...i])};const p_=new Map,{invalidate:eG,advance:tG}=hEe(p_),{reconciler:hM,applyProps:i0}=KAe(p_,rEe),a0={objects:"shallow",strict:!1},pEe=(n,e)=>{const i=typeof n=="function"?n(e):n;return bK(i)?i:new y6({powerPreference:"high-performance",canvas:e,antialias:!0,alpha:!0,...n})};function fEe(n,e){const i=typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement;if(e){const{width:o,height:s,top:l,left:d,updateStyle:p=i}=e;return{width:o,height:s,top:l,left:d,updateStyle:p}}else if(typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement&&n.parentElement){const{width:o,height:s,top:l,left:d}=n.parentElement.getBoundingClientRect();return{width:o,height:s,top:l,left:d,updateStyle:i}}else if(typeof OffscreenCanvas<"u"&&n instanceof OffscreenCanvas)return{width:n.width,height:n.height,top:0,left:0,updateStyle:i};return{width:0,height:0,top:0,left:0}}function mEe(n){const e=p_.get(n),i=e==null?void 0:e.fiber,o=e==null?void 0:e.store;e&&console.warn("R3F.createRoot should only be called once!");const s=typeof reportError=="function"?reportError:console.error,l=o||lEe(eG,tG),d=i||hM.createContainer(l,R0.ConcurrentRoot,null,!1,null,"",s,null);e||p_.set(n,{fiber:d,store:l});let p,f=!1,y;return{configure(_={}){let{gl:x,size:S,scene:T,events:I,onCreated:R,shadows:D=!1,linear:L=!1,flat:O=!1,legacy:N=!1,orthographic:F=!1,frameloop:G="always",dpr:j=[1,2],performance:Y,raycaster:te,camera:V,onPointerMissed:Q}=_,he=l.getState(),fe=he.gl;he.gl||he.set({gl:fe=pEe(x,n)});let ye=he.raycaster;ye||he.set({raycaster:ye=new iK});const{params:pe,...Me}=te||{};if(lr.equ(Me,ye,a0)||i0(ye,{...Me}),lr.equ(pe,ye.params,a0)||i0(ye,{params:{...ye.params,...pe}}),!he.camera||he.camera===y&&!lr.equ(y,V,a0)){y=V;const Ee=V instanceof Xw,Je=Ee?V:F?new Rh(0,0,0,0,.1,1e3):new qr(75,0,.1,1e3);Ee||(Je.position.z=5,V&&i0(Je,V),!he.camera&&!(V!=null&&V.rotation)&&Je.lookAt(0,0,0)),he.set({camera:Je}),ye.camera=Je}if(!he.scene){let Ee;T instanceof uM?Ee=T:(Ee=new uM,T&&i0(Ee,T)),he.set({scene:h0(Ee)})}if(!he.xr){var Ie;const Ee=(Ke,Fe)=>{const ct=l.getState();ct.frameloop!=="never"&&tG(Ke,!0,ct,Fe)},Je=()=>{const Ke=l.getState();Ke.gl.xr.enabled=Ke.gl.xr.isPresenting,Ke.gl.xr.setAnimationLoop(Ke.gl.xr.isPresenting?Ee:null),Ke.gl.xr.isPresenting||eG(Ke)},Ze={connect(){const Ke=l.getState().gl;Ke.xr.addEventListener("sessionstart",Je),Ke.xr.addEventListener("sessionend",Je)},disconnect(){const Ke=l.getState().gl;Ke.xr.removeEventListener("sessionstart",Je),Ke.xr.removeEventListener("sessionend",Je)}};typeof((Ie=fe.xr)==null?void 0:Ie.addEventListener)=="function"&&Ze.connect(),he.set({xr:Ze})}if(fe.shadowMap){const Ee=fe.shadowMap.enabled,Je=fe.shadowMap.type;if(fe.shadowMap.enabled=!!D,lr.boo(D))fe.shadowMap.type=hx;else if(lr.str(D)){var ze;const Ze={basic:Zq,percentage:NT,soft:hx,variance:au};fe.shadowMap.type=(ze=Ze[D])!=null?ze:hx}else lr.obj(D)&&Object.assign(fe.shadowMap,D);(Ee!==fe.shadowMap.enabled||Je!==fe.shadowMap.type)&&(fe.shadowMap.needsUpdate=!0)}const le=hK();le&&("enabled"in le?le.enabled=!N:"legacyMode"in le&&(le.legacyMode=N)),i0(fe,{outputEncoding:L?3e3:3001,toneMapping:O?gd:QD}),he.legacy!==N&&he.set(()=>({legacy:N})),he.linear!==L&&he.set(()=>({linear:L})),he.flat!==O&&he.set(()=>({flat:O})),x&&!lr.fun(x)&&!bK(x)&&!lr.equ(x,fe,a0)&&i0(fe,x),I&&!he.events.handlers&&he.set({events:I(l)});const ae=fEe(n,S);return lr.equ(ae,he.size,a0)||he.setSize(ae.width,ae.height,ae.updateStyle,ae.top,ae.left),j&&he.viewport.dpr!==yK(j)&&he.setDpr(j),he.frameloop!==G&&he.setFrameloop(G),he.onPointerMissed||he.set({onPointerMissed:Q}),Y&&!lr.equ(Y,he.performance,a0)&&he.set(Ee=>({performance:{...Ee.performance,...Y}})),p=R,f=!0,this},render(_){return f||this.configure(),hM.updateContainer(ie.createElement(gEe,{store:l,children:_,onCreated:p,rootElement:n}),d,null,()=>{}),l},unmount(){AK(n)}}}function gEe({store:n,children:e,onCreated:i,rootElement:o}){return t2(()=>{const s=n.getState();s.set(l=>({internal:{...l.internal,active:!0}})),i&&i(s),n.getState().events.connected||s.events.connect==null||s.events.connect(o)},[]),ie.createElement(xK.Provider,{value:n},e)}function AK(n,e){const i=p_.get(n),o=i==null?void 0:i.fiber;if(o){const s=i==null?void 0:i.store.getState();s&&(s.internal.active=!1),hM.updateContainer(null,o,null,()=>{s&&setTimeout(()=>{try{var l,d,p,f;s.events.disconnect==null||s.events.disconnect(),(l=s.gl)==null||(d=l.renderLists)==null||d.dispose==null||d.dispose(),(p=s.gl)==null||p.forceContextLoss==null||p.forceContextLoss(),(f=s.gl)!=null&&f.xr&&s.xr.disconnect(),nEe(s),p_.delete(n),e&&e(n)}catch{}},500)})}}hM.injectIntoDevTools({bundleType:0,rendererPackageName:"@react-three/fiber",version:ie.version});function VR(n,e,i){var o,s,l,d,p;e==null&&(e=100);function f(){var _=Date.now()-d;_<e&&_>=0?o=setTimeout(f,e-_):(o=null,i||(p=n.apply(l,s),l=s=null))}var y=function(){l=this,s=arguments,d=Date.now();var _=i&&!o;return o||(o=setTimeout(f,e)),_&&(p=n.apply(l,s),l=s=null),p};return y.clear=function(){o&&(clearTimeout(o),o=null)},y.flush=function(){o&&(p=n.apply(l,s),l=s=null,clearTimeout(o),o=null)},y}VR.debounce=VR;var yEe=VR;const nG=Iw(yEe);function vEe(n){let{debounce:e,scroll:i,polyfill:o,offsetSize:s}=n===void 0?{debounce:0,scroll:!1,offsetSize:!1}:n;const l=o||(typeof window>"u"?class{}:window.ResizeObserver);if(!l)throw new Error("This browser does not support ResizeObserver out of the box. See: https://github.com/react-spring/react-use-measure/#resize-observer-polyfills");const[d,p]=ie.useState({left:0,top:0,width:0,height:0,bottom:0,right:0,x:0,y:0}),f=ie.useRef({element:null,scrollContainers:null,resizeObserver:null,lastBounds:d}),y=e?typeof e=="number"?e:e.scroll:null,_=e?typeof e=="number"?e:e.resize:null,x=ie.useRef(!1);ie.useEffect(()=>(x.current=!0,()=>void(x.current=!1)));const[S,T,I]=ie.useMemo(()=>{const O=()=>{if(!f.current.element)return;const{left:N,top:F,width:G,height:j,bottom:Y,right:te,x:V,y:Q}=f.current.element.getBoundingClientRect(),he={left:N,top:F,width:G,height:j,bottom:Y,right:te,x:V,y:Q};f.current.element instanceof HTMLElement&&s&&(he.height=f.current.element.offsetHeight,he.width=f.current.element.offsetWidth),Object.freeze(he),x.current&&!wEe(f.current.lastBounds,he)&&p(f.current.lastBounds=he)};return[O,_?nG(O,_):O,y?nG(O,y):O]},[p,s,y,_]);function R(){f.current.scrollContainers&&(f.current.scrollContainers.forEach(O=>O.removeEventListener("scroll",I,!0)),f.current.scrollContainers=null),f.current.resizeObserver&&(f.current.resizeObserver.disconnect(),f.current.resizeObserver=null)}function D(){f.current.element&&(f.current.resizeObserver=new l(I),f.current.resizeObserver.observe(f.current.element),i&&f.current.scrollContainers&&f.current.scrollContainers.forEach(O=>O.addEventListener("scroll",I,{capture:!0,passive:!0})))}const L=O=>{!O||O===f.current.element||(R(),f.current.element=O,f.current.scrollContainers=EK(O),D())};return bEe(I,!!i),_Ee(T),ie.useEffect(()=>{R(),D()},[i,I,T]),ie.useEffect(()=>R,[]),[L,d,S]}function _Ee(n){ie.useEffect(()=>{const e=n;return window.addEventListener("resize",e),()=>void window.removeEventListener("resize",e)},[n])}function bEe(n,e){ie.useEffect(()=>{if(e){const i=n;return window.addEventListener("scroll",i,{capture:!0,passive:!0}),()=>void window.removeEventListener("scroll",i,!0)}},[n,e])}function EK(n){const e=[];if(!n||n===document.body)return e;const{overflow:i,overflowX:o,overflowY:s}=window.getComputedStyle(n);return[i,o,s].some(l=>l==="auto"||l==="scroll")&&e.push(n),[...e,...EK(n.parentElement)]}const xEe=["x","y","top","bottom","left","right","width","height"],wEe=(n,e)=>xEe.every(i=>n[i]===e[i]);var SEe=Object.defineProperty,AEe=Object.defineProperties,EEe=Object.getOwnPropertyDescriptors,iG=Object.getOwnPropertySymbols,MEe=Object.prototype.hasOwnProperty,TEe=Object.prototype.propertyIsEnumerable,aG=(n,e,i)=>e in n?SEe(n,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):n[e]=i,rG=(n,e)=>{for(var i in e||(e={}))MEe.call(e,i)&&aG(n,i,e[i]);if(iG)for(var i of iG(e))TEe.call(e,i)&&aG(n,i,e[i]);return n},CEe=(n,e)=>AEe(n,EEe(e));function MK(n,e,i){if(!n)return;if(i(n)===!0)return n;let o=e?n.return:n.child;for(;o;){const s=MK(o,e,i);if(s)return s;o=e?null:o.sibling}}function TK(n){try{return Object.defineProperties(n,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return n}}const V6=TK(ie.createContext(null));class CK extends ie.Component{render(){return ie.createElement(V6.Provider,{value:this._reactInternals},this.props.children)}}const{ReactCurrentOwner:oG,ReactCurrentDispatcher:sG}=ie.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;function PEe(){const n=ie.useContext(V6);if(n===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const e=ie.useId();return ie.useMemo(()=>{for(const o of[oG==null?void 0:oG.current,n,n==null?void 0:n.alternate]){if(!o)continue;const s=MK(o,!1,l=>{let d=l.memoizedState;for(;d;){if(d.memoizedState===e)return!0;d=d.next}});if(s)return s}},[n,e])}function IEe(){var n,e;const i=PEe(),[o]=ie.useState(()=>new Map);o.clear();let s=i;for(;s;){const l=(n=s.type)==null?void 0:n._context;l&&l!==V6&&!o.has(l)&&o.set(l,(e=sG==null?void 0:sG.current)==null?void 0:e.readContext(TK(l))),s=s.return}return o}function LEe(){const n=IEe();return ie.useMemo(()=>Array.from(n.keys()).reduce((e,i)=>o=>ie.createElement(e,null,ie.createElement(i.Provider,CEe(rG({},o),{value:n.get(i)}))),e=>ie.createElement(CK,rG({},e))),[n])}const fI={onClick:["click",!1],onContextMenu:["contextmenu",!1],onDoubleClick:["dblclick",!1],onWheel:["wheel",!0],onPointerDown:["pointerdown",!0],onPointerUp:["pointerup",!0],onPointerLeave:["pointerleave",!0],onPointerMove:["pointermove",!0],onPointerCancel:["pointercancel",!0],onLostPointerCapture:["lostpointercapture",!0]};function REe(n){const{handlePointer:e}=sEe(n);return{priority:1,enabled:!0,compute(i,o,s){o.pointer.set(i.offsetX/o.size.width*2-1,-(i.offsetY/o.size.height)*2+1),o.raycaster.setFromCamera(o.pointer,o.camera)},connected:void 0,handlers:Object.keys(fI).reduce((i,o)=>({...i,[o]:e(o)}),{}),update:()=>{var i;const{events:o,internal:s}=n.getState();(i=s.lastEvent)!=null&&i.current&&o.handlers&&o.handlers.onPointerMove(s.lastEvent.current)},connect:i=>{var o;const{set:s,events:l}=n.getState();l.disconnect==null||l.disconnect(),s(d=>({events:{...d.events,connected:i}})),Object.entries((o=l.handlers)!=null?o:[]).forEach(([d,p])=>{const[f,y]=fI[d];i.addEventListener(f,p,{passive:y})})},disconnect:()=>{const{set:i,events:o}=n.getState();if(o.connected){var s;Object.entries((s=o.handlers)!=null?s:[]).forEach(([l,d])=>{if(o&&o.connected instanceof HTMLElement){const[p]=fI[l];o.connected.removeEventListener(p,d)}}),i(l=>({events:{...l.events,connected:void 0}}))}}}}const kEe=ie.forwardRef(function({children:e,fallback:i,resize:o,style:s,gl:l,events:d=REe,eventSource:p,eventPrefix:f,shadows:y,linear:_,flat:x,legacy:S,orthographic:T,frameloop:I,dpr:R,performance:D,raycaster:L,camera:O,scene:N,onPointerMissed:F,onCreated:G,...j},Y){ie.useMemo(()=>ZAe(FAe),[]);const te=LEe(),[V,Q]=vEe({scroll:!0,debounce:{scroll:50,resize:0},...o}),he=ie.useRef(null),fe=ie.useRef(null);ie.useImperativeHandle(Y,()=>he.current);const ye=fK(F),[pe,Me]=ie.useState(!1),[Ie,ze]=ie.useState(!1);if(pe)throw pe;if(Ie)throw Ie;const le=ie.useRef(null);t2(()=>{const xe=he.current;Q.width>0&&Q.height>0&&xe&&(le.current||(le.current=mEe(xe)),le.current.configure({gl:l,events:d,shadows:y,linear:_,flat:x,legacy:S,orthographic:T,frameloop:I,dpr:R,performance:D,raycaster:L,camera:O,scene:N,size:Q,onPointerMissed:(...ae)=>ye.current==null?void 0:ye.current(...ae),onCreated:ae=>{ae.events.connect==null||ae.events.connect(p?JAe(p)?p.current:p:fe.current),f&&ae.setEvents({compute:(Ee,Je)=>{const Ze=Ee[f+"X"],Ke=Ee[f+"Y"];Je.pointer.set(Ze/Je.size.width*2-1,-(Ke/Je.size.height)*2+1),Je.raycaster.setFromCamera(Je.pointer,Je.camera)}}),G==null||G(ae)}}),le.current.render(ie.createElement(te,null,ie.createElement(mK,{set:ze},ie.createElement(ie.Suspense,{fallback:ie.createElement(QAe,{set:Me})},e)))))}),ie.useEffect(()=>{const xe=he.current;if(xe)return()=>AK(xe)},[]);const me=p?"none":"auto";return ie.createElement("div",qe({ref:fe,style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",pointerEvents:me,...s}},j),ie.createElement("div",{ref:V,style:{width:"100%",height:"100%"}},ie.createElement("canvas",{ref:he,style:{display:"block"}},i)))}),DEe=ie.forwardRef(function(e,i){return ie.createElement(CK,null,ie.createElement(kEe,qe({},e,{ref:i})))});var OEe=Object.defineProperty,NEe=(n,e,i)=>e in n?OEe(n,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):n[e]=i,Ti=(n,e,i)=>(NEe(n,typeof e!="symbol"?e+"":e,i),i);const gA=new Kg,lG=new Ah,zEe=Math.cos(70*(Math.PI/180)),cG=(n,e)=>(n%e+e)%e;let FEe=class extends Td{constructor(e,i){super(),Ti(this,"object"),Ti(this,"domElement"),Ti(this,"enabled",!0),Ti(this,"target",new Ue),Ti(this,"minDistance",0),Ti(this,"maxDistance",1/0),Ti(this,"minZoom",0),Ti(this,"maxZoom",1/0),Ti(this,"minPolarAngle",0),Ti(this,"maxPolarAngle",Math.PI),Ti(this,"minAzimuthAngle",-1/0),Ti(this,"maxAzimuthAngle",1/0),Ti(this,"enableDamping",!1),Ti(this,"dampingFactor",.05),Ti(this,"enableZoom",!0),Ti(this,"zoomSpeed",1),Ti(this,"enableRotate",!0),Ti(this,"rotateSpeed",1),Ti(this,"enablePan",!0),Ti(this,"panSpeed",1),Ti(this,"screenSpacePanning",!0),Ti(this,"keyPanSpeed",7),Ti(this,"zoomToCursor",!1),Ti(this,"autoRotate",!1),Ti(this,"autoRotateSpeed",2),Ti(this,"reverseOrbit",!1),Ti(this,"reverseHorizontalOrbit",!1),Ti(this,"reverseVerticalOrbit",!1),Ti(this,"keys",{LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"}),Ti(this,"mouseButtons",{LEFT:tg.ROTATE,MIDDLE:tg.DOLLY,RIGHT:tg.PAN}),Ti(this,"touches",{ONE:ng.ROTATE,TWO:ng.DOLLY_PAN}),Ti(this,"target0"),Ti(this,"position0"),Ti(this,"zoom0"),Ti(this,"_domElementKeyEvents",null),Ti(this,"getPolarAngle"),Ti(this,"getAzimuthalAngle"),Ti(this,"setPolarAngle"),Ti(this,"setAzimuthalAngle"),Ti(this,"getDistance"),Ti(this,"listenToKeyEvents"),Ti(this,"stopListenToKeyEvents"),Ti(this,"saveState"),Ti(this,"reset"),Ti(this,"update"),Ti(this,"connect"),Ti(this,"dispose"),this.object=e,this.domElement=i,this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=()=>_.phi,this.getAzimuthalAngle=()=>_.theta,this.setPolarAngle=He=>{let Pt=cG(He,2*Math.PI),qt=_.phi;qt<0&&(qt+=2*Math.PI),Pt<0&&(Pt+=2*Math.PI);let Nt=Math.abs(Pt-qt);2*Math.PI-Nt<Nt&&(Pt<qt?Pt+=2*Math.PI:qt+=2*Math.PI),x.phi=Pt-qt,o.update()},this.setAzimuthalAngle=He=>{let Pt=cG(He,2*Math.PI),qt=_.theta;qt<0&&(qt+=2*Math.PI),Pt<0&&(Pt+=2*Math.PI);let Nt=Math.abs(Pt-qt);2*Math.PI-Nt<Nt&&(Pt<qt?Pt+=2*Math.PI:qt+=2*Math.PI),x.theta=Pt-qt,o.update()},this.getDistance=()=>o.object.position.distanceTo(o.target),this.listenToKeyEvents=He=>{He.addEventListener("keydown",lt),this._domElementKeyEvents=He},this.stopListenToKeyEvents=()=>{this._domElementKeyEvents.removeEventListener("keydown",lt),this._domElementKeyEvents=null},this.saveState=()=>{o.target0.copy(o.target),o.position0.copy(o.object.position),o.zoom0=o.object.zoom},this.reset=()=>{o.target.copy(o.target0),o.object.position.copy(o.position0),o.object.zoom=o.zoom0,o.object.updateProjectionMatrix(),o.dispatchEvent(s),o.update(),f=p.NONE},this.update=(()=>{const He=new Ue,Pt=new Ue(0,1,0),qt=new As().setFromUnitVectors(e.up,Pt),Nt=qt.clone().invert(),hn=new Ue,be=new As,Qe=2*Math.PI;return function(){const Te=o.object.position;qt.setFromUnitVectors(e.up,Pt),Nt.copy(qt).invert(),He.copy(Te).sub(o.target),He.applyQuaternion(qt),_.setFromVector3(He),o.autoRotate&&f===p.NONE&&pe(fe()),o.enableDamping?(_.theta+=x.theta*o.dampingFactor,_.phi+=x.phi*o.dampingFactor):(_.theta+=x.theta,_.phi+=x.phi);let Ne=o.minAzimuthAngle,et=o.maxAzimuthAngle;isFinite(Ne)&&isFinite(et)&&(Ne<-Math.PI?Ne+=Qe:Ne>Math.PI&&(Ne-=Qe),et<-Math.PI?et+=Qe:et>Math.PI&&(et-=Qe),Ne<=et?_.theta=Math.max(Ne,Math.min(et,_.theta)):_.theta=_.theta>(Ne+et)/2?Math.max(Ne,_.theta):Math.min(et,_.theta)),_.phi=Math.max(o.minPolarAngle,Math.min(o.maxPolarAngle,_.phi)),_.makeSafe(),o.enableDamping===!0?o.target.addScaledVector(T,o.dampingFactor):o.target.add(T),o.zoomToCursor&&V||o.object.isOrthographicCamera?_.radius=Ee(_.radius):_.radius=Ee(_.radius*S),He.setFromSpherical(_),He.applyQuaternion(Nt),Te.copy(o.target).add(He),o.object.lookAt(o.target),o.enableDamping===!0?(x.theta*=1-o.dampingFactor,x.phi*=1-o.dampingFactor,T.multiplyScalar(1-o.dampingFactor)):(x.set(0,0,0),T.set(0,0,0));let tt=!1;if(o.zoomToCursor&&V){let vt=null;if(o.object instanceof qr&&o.object.isPerspectiveCamera){const ht=He.length();vt=Ee(ht*S);const dt=ht-vt;o.object.position.addScaledVector(Y,dt),o.object.updateMatrixWorld()}else if(o.object.isOrthographicCamera){const ht=new Ue(te.x,te.y,0);ht.unproject(o.object),o.object.zoom=Math.max(o.minZoom,Math.min(o.maxZoom,o.object.zoom/S)),o.object.updateProjectionMatrix(),tt=!0;const dt=new Ue(te.x,te.y,0);dt.unproject(o.object),o.object.position.sub(dt).add(ht),o.object.updateMatrixWorld(),vt=He.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),o.zoomToCursor=!1;vt!==null&&(o.screenSpacePanning?o.target.set(0,0,-1).transformDirection(o.object.matrix).multiplyScalar(vt).add(o.object.position):(gA.origin.copy(o.object.position),gA.direction.set(0,0,-1).transformDirection(o.object.matrix),Math.abs(o.object.up.dot(gA.direction))<zEe?e.lookAt(o.target):(lG.setFromNormalAndCoplanarPoint(o.object.up,o.target),gA.intersectPlane(lG,o.target))))}else o.object instanceof Rh&&o.object.isOrthographicCamera&&(o.object.zoom=Math.max(o.minZoom,Math.min(o.maxZoom,o.object.zoom/S)),o.object.updateProjectionMatrix(),tt=!0);return S=1,V=!1,tt||hn.distanceToSquared(o.object.position)>y||8*(1-be.dot(o.object.quaternion))>y?(o.dispatchEvent(s),hn.copy(o.object.position),be.copy(o.object.quaternion),tt=!1,!0):!1}})(),this.connect=He=>{He===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),o.domElement=He,o.domElement.style.touchAction="none",o.domElement.addEventListener("contextmenu",Wt),o.domElement.addEventListener("pointerdown",De),o.domElement.addEventListener("pointercancel",ne),o.domElement.addEventListener("wheel",it)},this.dispose=()=>{var He,Pt,qt,Nt,hn,be;(He=o.domElement)==null||He.removeEventListener("contextmenu",Wt),(Pt=o.domElement)==null||Pt.removeEventListener("pointerdown",De),(qt=o.domElement)==null||qt.removeEventListener("pointercancel",ne),(Nt=o.domElement)==null||Nt.removeEventListener("wheel",it),(hn=o.domElement)==null||hn.ownerDocument.removeEventListener("pointermove",st),(be=o.domElement)==null||be.ownerDocument.removeEventListener("pointerup",de),o._domElementKeyEvents!==null&&o._domElementKeyEvents.removeEventListener("keydown",lt)};const o=this,s={type:"change"},l={type:"start"},d={type:"end"},p={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let f=p.NONE;const y=1e-6,_=new BR,x=new BR;let S=1;const T=new Ue,I=new tn,R=new tn,D=new tn,L=new tn,O=new tn,N=new tn,F=new tn,G=new tn,j=new tn,Y=new Ue,te=new tn;let V=!1;const Q=[],he={};function fe(){return 2*Math.PI/60/60*o.autoRotateSpeed}function ye(){return Math.pow(.95,o.zoomSpeed)}function pe(He){o.reverseOrbit||o.reverseHorizontalOrbit?x.theta+=He:x.theta-=He}function Me(He){o.reverseOrbit||o.reverseVerticalOrbit?x.phi+=He:x.phi-=He}const Ie=(()=>{const He=new Ue;return function(qt,Nt){He.setFromMatrixColumn(Nt,0),He.multiplyScalar(-qt),T.add(He)}})(),ze=(()=>{const He=new Ue;return function(qt,Nt){o.screenSpacePanning===!0?He.setFromMatrixColumn(Nt,1):(He.setFromMatrixColumn(Nt,0),He.crossVectors(o.object.up,He)),He.multiplyScalar(qt),T.add(He)}})(),le=(()=>{const He=new Ue;return function(qt,Nt){const hn=o.domElement;if(hn&&o.object instanceof qr&&o.object.isPerspectiveCamera){const be=o.object.position;He.copy(be).sub(o.target);let Qe=He.length();Qe*=Math.tan(o.object.fov/2*Math.PI/180),Ie(2*qt*Qe/hn.clientHeight,o.object.matrix),ze(2*Nt*Qe/hn.clientHeight,o.object.matrix)}else hn&&o.object instanceof Rh&&o.object.isOrthographicCamera?(Ie(qt*(o.object.right-o.object.left)/o.object.zoom/hn.clientWidth,o.object.matrix),ze(Nt*(o.object.top-o.object.bottom)/o.object.zoom/hn.clientHeight,o.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),o.enablePan=!1)}})();function me(He){o.object instanceof qr&&o.object.isPerspectiveCamera||o.object instanceof Rh&&o.object.isOrthographicCamera?S/=He:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),o.enableZoom=!1)}function xe(He){o.object instanceof qr&&o.object.isPerspectiveCamera||o.object instanceof Rh&&o.object.isOrthographicCamera?S*=He:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),o.enableZoom=!1)}function ae(He){if(!o.zoomToCursor||!o.domElement)return;V=!0;const Pt=o.domElement.getBoundingClientRect(),qt=He.clientX-Pt.left,Nt=He.clientY-Pt.top,hn=Pt.width,be=Pt.height;te.x=qt/hn*2-1,te.y=-(Nt/be)*2+1,Y.set(te.x,te.y,1).unproject(o.object).sub(o.object.position).normalize()}function Ee(He){return Math.max(o.minDistance,Math.min(o.maxDistance,He))}function Je(He){I.set(He.clientX,He.clientY)}function Ze(He){ae(He),F.set(He.clientX,He.clientY)}function Ke(He){L.set(He.clientX,He.clientY)}function Fe(He){R.set(He.clientX,He.clientY),D.subVectors(R,I).multiplyScalar(o.rotateSpeed);const Pt=o.domElement;Pt&&(pe(2*Math.PI*D.x/Pt.clientHeight),Me(2*Math.PI*D.y/Pt.clientHeight)),I.copy(R),o.update()}function ct(He){G.set(He.clientX,He.clientY),j.subVectors(G,F),j.y>0?me(ye()):j.y<0&&xe(ye()),F.copy(G),o.update()}function Ct(He){O.set(He.clientX,He.clientY),N.subVectors(O,L).multiplyScalar(o.panSpeed),le(N.x,N.y),L.copy(O),o.update()}function kt(He){ae(He),He.deltaY<0?xe(ye()):He.deltaY>0&&me(ye()),o.update()}function Kt(He){let Pt=!1;switch(He.code){case o.keys.UP:le(0,o.keyPanSpeed),Pt=!0;break;case o.keys.BOTTOM:le(0,-o.keyPanSpeed),Pt=!0;break;case o.keys.LEFT:le(o.keyPanSpeed,0),Pt=!0;break;case o.keys.RIGHT:le(-o.keyPanSpeed,0),Pt=!0;break}Pt&&(He.preventDefault(),o.update())}function At(){if(Q.length==1)I.set(Q[0].pageX,Q[0].pageY);else{const He=.5*(Q[0].pageX+Q[1].pageX),Pt=.5*(Q[0].pageY+Q[1].pageY);I.set(He,Pt)}}function Pe(){if(Q.length==1)L.set(Q[0].pageX,Q[0].pageY);else{const He=.5*(Q[0].pageX+Q[1].pageX),Pt=.5*(Q[0].pageY+Q[1].pageY);L.set(He,Pt)}}function ft(){const He=Q[0].pageX-Q[1].pageX,Pt=Q[0].pageY-Q[1].pageY,qt=Math.sqrt(He*He+Pt*Pt);F.set(0,qt)}function gt(){o.enableZoom&&ft(),o.enablePan&&Pe()}function _t(){o.enableZoom&&ft(),o.enableRotate&&At()}function Be(He){if(Q.length==1)R.set(He.pageX,He.pageY);else{const qt=Xt(He),Nt=.5*(He.pageX+qt.x),hn=.5*(He.pageY+qt.y);R.set(Nt,hn)}D.subVectors(R,I).multiplyScalar(o.rotateSpeed);const Pt=o.domElement;Pt&&(pe(2*Math.PI*D.x/Pt.clientHeight),Me(2*Math.PI*D.y/Pt.clientHeight)),I.copy(R)}function ue(He){if(Q.length==1)O.set(He.pageX,He.pageY);else{const Pt=Xt(He),qt=.5*(He.pageX+Pt.x),Nt=.5*(He.pageY+Pt.y);O.set(qt,Nt)}N.subVectors(O,L).multiplyScalar(o.panSpeed),le(N.x,N.y),L.copy(O)}function se(He){const Pt=Xt(He),qt=He.pageX-Pt.x,Nt=He.pageY-Pt.y,hn=Math.sqrt(qt*qt+Nt*Nt);G.set(0,hn),j.set(0,Math.pow(G.y/F.y,o.zoomSpeed)),me(j.y),F.copy(G)}function _e(He){o.enableZoom&&se(He),o.enablePan&&ue(He)}function je(He){o.enableZoom&&se(He),o.enableRotate&&Be(He)}function De(He){var Pt,qt;o.enabled!==!1&&(Q.length===0&&((Pt=o.domElement)==null||Pt.ownerDocument.addEventListener("pointermove",st),(qt=o.domElement)==null||qt.ownerDocument.addEventListener("pointerup",de)),Ht(He),He.pointerType==="touch"?Et(He):Oe(He))}function st(He){o.enabled!==!1&&(He.pointerType==="touch"?Ut(He):ut(He))}function de(He){var Pt,qt,Nt;Dt(He),Q.length===0&&((Pt=o.domElement)==null||Pt.releasePointerCapture(He.pointerId),(qt=o.domElement)==null||qt.ownerDocument.removeEventListener("pointermove",st),(Nt=o.domElement)==null||Nt.ownerDocument.removeEventListener("pointerup",de)),o.dispatchEvent(d),f=p.NONE}function ne(He){Dt(He)}function Oe(He){let Pt;switch(He.button){case 0:Pt=o.mouseButtons.LEFT;break;case 1:Pt=o.mouseButtons.MIDDLE;break;case 2:Pt=o.mouseButtons.RIGHT;break;default:Pt=-1}switch(Pt){case tg.DOLLY:if(o.enableZoom===!1)return;Ze(He),f=p.DOLLY;break;case tg.ROTATE:if(He.ctrlKey||He.metaKey||He.shiftKey){if(o.enablePan===!1)return;Ke(He),f=p.PAN}else{if(o.enableRotate===!1)return;Je(He),f=p.ROTATE}break;case tg.PAN:if(He.ctrlKey||He.metaKey||He.shiftKey){if(o.enableRotate===!1)return;Je(He),f=p.ROTATE}else{if(o.enablePan===!1)return;Ke(He),f=p.PAN}break;default:f=p.NONE}f!==p.NONE&&o.dispatchEvent(l)}function ut(He){if(o.enabled!==!1)switch(f){case p.ROTATE:if(o.enableRotate===!1)return;Fe(He);break;case p.DOLLY:if(o.enableZoom===!1)return;ct(He);break;case p.PAN:if(o.enablePan===!1)return;Ct(He);break}}function it(He){o.enabled===!1||o.enableZoom===!1||f!==p.NONE&&f!==p.ROTATE||(He.preventDefault(),o.dispatchEvent(l),kt(He),o.dispatchEvent(d))}function lt(He){o.enabled===!1||o.enablePan===!1||Kt(He)}function Et(He){switch(wt(He),Q.length){case 1:switch(o.touches.ONE){case ng.ROTATE:if(o.enableRotate===!1)return;At(),f=p.TOUCH_ROTATE;break;case ng.PAN:if(o.enablePan===!1)return;Pe(),f=p.TOUCH_PAN;break;default:f=p.NONE}break;case 2:switch(o.touches.TWO){case ng.DOLLY_PAN:if(o.enableZoom===!1&&o.enablePan===!1)return;gt(),f=p.TOUCH_DOLLY_PAN;break;case ng.DOLLY_ROTATE:if(o.enableZoom===!1&&o.enableRotate===!1)return;_t(),f=p.TOUCH_DOLLY_ROTATE;break;default:f=p.NONE}break;default:f=p.NONE}f!==p.NONE&&o.dispatchEvent(l)}function Ut(He){switch(wt(He),f){case p.TOUCH_ROTATE:if(o.enableRotate===!1)return;Be(He),o.update();break;case p.TOUCH_PAN:if(o.enablePan===!1)return;ue(He),o.update();break;case p.TOUCH_DOLLY_PAN:if(o.enableZoom===!1&&o.enablePan===!1)return;_e(He),o.update();break;case p.TOUCH_DOLLY_ROTATE:if(o.enableZoom===!1&&o.enableRotate===!1)return;je(He),o.update();break;default:f=p.NONE}}function Wt(He){o.enabled!==!1&&He.preventDefault()}function Ht(He){Q.push(He)}function Dt(He){delete he[He.pointerId];for(let Pt=0;Pt<Q.length;Pt++)if(Q[Pt].pointerId==He.pointerId){Q.splice(Pt,1);return}}function wt(He){let Pt=he[He.pointerId];Pt===void 0&&(Pt=new tn,he[He.pointerId]=Pt),Pt.set(He.pageX,He.pageY)}function Xt(He){const Pt=He.pointerId===Q[0].pointerId?Q[1]:Q[0];return he[Pt.pointerId]}i!==void 0&&this.connect(i),this.update()}};function BEe(){var n=Object.create(null);function e(s,l){var d=s.id,p=s.name,f=s.dependencies;f===void 0&&(f=[]);var y=s.init;y===void 0&&(y=function(){});var _=s.getTransferables;if(_===void 0&&(_=null),!n[d])try{f=f.map(function(S){return S&&S.isWorkerModule&&(e(S,function(T){if(T instanceof Error)throw T}),S=n[S.id].value),S}),y=o("<"+p+">.init",y),_&&(_=o("<"+p+">.getTransferables",_));var x=null;typeof y=="function"?x=y.apply(void 0,f):console.error("worker module init function failed to rehydrate"),n[d]={id:d,value:x,getTransferables:_},l(x)}catch(S){S&&S.noLog||console.error(S),l(S)}}function i(s,l){var d,p=s.id,f=s.args;(!n[p]||typeof n[p].value!="function")&&l(new Error("Worker module "+p+": not found or its 'init' did not return a function"));try{var y=(d=n[p]).value.apply(d,f);y&&typeof y.then=="function"?y.then(_,function(x){return l(x instanceof Error?x:new Error(""+x))}):_(y)}catch(x){l(x)}function _(x){try{var S=n[p].getTransferables&&n[p].getTransferables(x);(!S||!Array.isArray(S)||!S.length)&&(S=void 0),l(x,S)}catch(T){console.error(T),l(T)}}}function o(s,l){var d=void 0;self.troikaDefine=function(f){return d=f};var p=URL.createObjectURL(new Blob(["/** "+s.replace(/\*/g,"")+` **/

troikaDefine(
`+l+`
)`],{type:"application/javascript"}));try{importScripts(p)}catch(f){console.error(f)}return URL.revokeObjectURL(p),delete self.troikaDefine,d}self.addEventListener("message",function(s){var l=s.data,d=l.messageId,p=l.action,f=l.data;try{p==="registerModule"&&e(f,function(y){y instanceof Error?postMessage({messageId:d,success:!1,error:y.message}):postMessage({messageId:d,success:!0,result:{isCallable:typeof y=="function"}})}),p==="callModule"&&i(f,function(y,_){y instanceof Error?postMessage({messageId:d,success:!1,error:y.message}):postMessage({messageId:d,success:!0,result:y},_||void 0)})}catch(y){postMessage({messageId:d,success:!1,error:y.stack})}})}function UEe(n){var e=function(){for(var i=[],o=arguments.length;o--;)i[o]=arguments[o];return e._getInitResult().then(function(s){if(typeof s=="function")return s.apply(void 0,i);throw new Error("Worker module function was called but `init` did not return a callable function")})};return e._getInitResult=function(){var i=n.dependencies,o=n.init;i=Array.isArray(i)?i.map(function(l){return l&&l._getInitResult?l._getInitResult():l}):[];var s=Promise.all(i).then(function(l){return o.apply(null,l)});return e._getInitResult=function(){return s},s},e}var PK=function(){var n=!1;if(typeof window<"u"&&typeof window.document<"u")try{var e=new Worker(URL.createObjectURL(new Blob([""],{type:"application/javascript"})));e.terminate(),n=!0}catch(i){typeof process<"u",console.log("Troika createWorkerModule: web workers not allowed; falling back to main thread execution. Cause: ["+i.message+"]")}return PK=function(){return n},n},WEe=0,VEe=0,mI=!1,vx=Object.create(null),_x=Object.create(null),GR=Object.create(null);function n2(n){if((!n||typeof n.init!="function")&&!mI)throw new Error("requires `options.init` function");var e=n.dependencies,i=n.init,o=n.getTransferables,s=n.workerId;if(!PK())return UEe(n);s==null&&(s="#default");var l="workerModule"+ ++WEe,d=n.name||l,p=null;e=e&&e.map(function(y){return typeof y=="function"&&!y.workerModuleData&&(mI=!0,y=n2({workerId:s,name:"<"+d+"> function dependency: "+y.name,init:`function(){return (
`+pE(y)+`
)}`}),mI=!1),y&&y.workerModuleData&&(y=y.workerModuleData),y});function f(){for(var y=[],_=arguments.length;_--;)y[_]=arguments[_];if(!p){p=uG(s,"registerModule",f.workerModuleData);var x=function(){p=null,_x[s].delete(x)};(_x[s]||(_x[s]=new Set)).add(x)}return p.then(function(S){var T=S.isCallable;if(T)return uG(s,"callModule",{id:l,args:y});throw new Error("Worker module function was called but `init` did not return a callable function")})}return f.workerModuleData={isWorkerModule:!0,id:l,name:d,dependencies:e,init:pE(i),getTransferables:o&&pE(o)},f}function GEe(n){_x[n]&&_x[n].forEach(function(e){e()}),vx[n]&&(vx[n].terminate(),delete vx[n])}function pE(n){var e=n.toString();return!/^function/.test(e)&&/^\w+\s*\(/.test(e)&&(e="function "+e),e}function HEe(n){var e=vx[n];if(!e){var i=pE(BEe);e=vx[n]=new Worker(URL.createObjectURL(new Blob(["/** Worker Module Bootstrap: "+n.replace(/\*/g,"")+` **/

;(`+i+")()"],{type:"application/javascript"}))),e.onmessage=function(o){var s=o.data,l=s.messageId,d=GR[l];if(!d)throw new Error("WorkerModule response with empty or unknown messageId");delete GR[l],d(s)}}return e}function uG(n,e,i){return new Promise(function(o,s){var l=++VEe;GR[l]=function(d){d.success?o(d.result):s(new Error("Error in worker "+e+" call: "+d.error))},HEe(n).postMessage({messageId:l,action:e,data:i})})}function IK(){var n=function(e){function i(me,xe,ae,Ee,Je,Ze,Ke,Fe){var ct=1-Ke;Fe.x=ct*ct*me+2*ct*Ke*ae+Ke*Ke*Je,Fe.y=ct*ct*xe+2*ct*Ke*Ee+Ke*Ke*Ze}function o(me,xe,ae,Ee,Je,Ze,Ke,Fe,ct,Ct){var kt=1-ct;Ct.x=kt*kt*kt*me+3*kt*kt*ct*ae+3*kt*ct*ct*Je+ct*ct*ct*Ke,Ct.y=kt*kt*kt*xe+3*kt*kt*ct*Ee+3*kt*ct*ct*Ze+ct*ct*ct*Fe}function s(me,xe){for(var ae=/([MLQCZ])([^MLQCZ]*)/g,Ee,Je,Ze,Ke,Fe;Ee=ae.exec(me);){var ct=Ee[2].replace(/^\s*|\s*$/g,"").split(/[,\s]+/).map(function(Ct){return parseFloat(Ct)});switch(Ee[1]){case"M":Ke=Je=ct[0],Fe=Ze=ct[1];break;case"L":(ct[0]!==Ke||ct[1]!==Fe)&&xe("L",Ke,Fe,Ke=ct[0],Fe=ct[1]);break;case"Q":{xe("Q",Ke,Fe,Ke=ct[2],Fe=ct[3],ct[0],ct[1]);break}case"C":{xe("C",Ke,Fe,Ke=ct[4],Fe=ct[5],ct[0],ct[1],ct[2],ct[3]);break}case"Z":(Ke!==Je||Fe!==Ze)&&xe("L",Ke,Fe,Je,Ze);break}}}function l(me,xe,ae){ae===void 0&&(ae=16);var Ee={x:0,y:0};s(me,function(Je,Ze,Ke,Fe,ct,Ct,kt,Kt,At){switch(Je){case"L":xe(Ze,Ke,Fe,ct);break;case"Q":{for(var Pe=Ze,ft=Ke,gt=1;gt<ae;gt++)i(Ze,Ke,Ct,kt,Fe,ct,gt/(ae-1),Ee),xe(Pe,ft,Ee.x,Ee.y),Pe=Ee.x,ft=Ee.y;break}case"C":{for(var _t=Ze,Be=Ke,ue=1;ue<ae;ue++)o(Ze,Ke,Ct,kt,Kt,At,Fe,ct,ue/(ae-1),Ee),xe(_t,Be,Ee.x,Ee.y),_t=Ee.x,Be=Ee.y;break}}})}var d="precision highp float;attribute vec2 aUV;varying vec2 vUV;void main(){vUV=aUV;gl_Position=vec4(mix(vec2(-1.0),vec2(1.0),aUV),0.0,1.0);}",p="precision highp float;uniform sampler2D tex;varying vec2 vUV;void main(){gl_FragColor=texture2D(tex,vUV);}",f=new WeakMap,y={premultipliedAlpha:!1,preserveDrawingBuffer:!0,antialias:!1,depth:!1};function _(me,xe){var ae=me.getContext?me.getContext("webgl",y):me,Ee=f.get(ae);if(!Ee){let _t=function(De){var st=Ze[De];if(!st&&(st=Ze[De]=ae.getExtension(De),!st))throw new Error(De+" not supported");return st},Be=function(De,st){var de=ae.createShader(st);return ae.shaderSource(de,De),ae.compileShader(de),de},ue=function(De,st,de,ne){if(!Ke[De]){var Oe={},ut={},it=ae.createProgram();ae.attachShader(it,Be(st,ae.VERTEX_SHADER)),ae.attachShader(it,Be(de,ae.FRAGMENT_SHADER)),ae.linkProgram(it),Ke[De]={program:it,transaction:function(Et){ae.useProgram(it),Et({setUniform:function(Wt,Ht){for(var Dt=[],wt=arguments.length-2;wt-- >0;)Dt[wt]=arguments[wt+2];var Xt=ut[Ht]||(ut[Ht]=ae.getUniformLocation(it,Ht));ae["uniform"+Wt].apply(ae,[Xt].concat(Dt))},setAttribute:function(Wt,Ht,Dt,wt,Xt){var He=Oe[Wt];He||(He=Oe[Wt]={buf:ae.createBuffer(),loc:ae.getAttribLocation(it,Wt),data:null}),ae.bindBuffer(ae.ARRAY_BUFFER,He.buf),ae.vertexAttribPointer(He.loc,Ht,ae.FLOAT,!1,0,0),ae.enableVertexAttribArray(He.loc),Je?ae.vertexAttribDivisor(He.loc,wt):_t("ANGLE_instanced_arrays").vertexAttribDivisorANGLE(He.loc,wt),Xt!==He.data&&(ae.bufferData(ae.ARRAY_BUFFER,Xt,Dt),He.data=Xt)}})}}}Ke[De].transaction(ne)},se=function(De,st){ct++;try{ae.activeTexture(ae.TEXTURE0+ct);var de=Fe[De];de||(de=Fe[De]=ae.createTexture(),ae.bindTexture(ae.TEXTURE_2D,de),ae.texParameteri(ae.TEXTURE_2D,ae.TEXTURE_MIN_FILTER,ae.NEAREST),ae.texParameteri(ae.TEXTURE_2D,ae.TEXTURE_MAG_FILTER,ae.NEAREST)),ae.bindTexture(ae.TEXTURE_2D,de),st(de,ct)}finally{ct--}},_e=function(De,st,de){var ne=ae.createFramebuffer();Ct.push(ne),ae.bindFramebuffer(ae.FRAMEBUFFER,ne),ae.activeTexture(ae.TEXTURE0+st),ae.bindTexture(ae.TEXTURE_2D,De),ae.framebufferTexture2D(ae.FRAMEBUFFER,ae.COLOR_ATTACHMENT0,ae.TEXTURE_2D,De,0);try{de(ne)}finally{ae.deleteFramebuffer(ne),ae.bindFramebuffer(ae.FRAMEBUFFER,Ct[--Ct.length-1]||null)}},je=function(){Ze={},Ke={},Fe={},ct=-1,Ct.length=0};var kt=_t,Kt=Be,At=ue,Pe=se,ft=_e,gt=je,Je=typeof WebGL2RenderingContext<"u"&&ae instanceof WebGL2RenderingContext,Ze={},Ke={},Fe={},ct=-1,Ct=[];ae.canvas.addEventListener("webglcontextlost",function(De){je(),De.preventDefault()},!1),f.set(ae,Ee={gl:ae,isWebGL2:Je,getExtension:_t,withProgram:ue,withTexture:se,withTextureFramebuffer:_e,handleContextLoss:je})}xe(Ee)}function x(me,xe,ae,Ee,Je,Ze,Ke,Fe){Ke===void 0&&(Ke=15),Fe===void 0&&(Fe=null),_(me,function(ct){var Ct=ct.gl,kt=ct.withProgram,Kt=ct.withTexture;Kt("copy",function(At,Pe){Ct.texImage2D(Ct.TEXTURE_2D,0,Ct.RGBA,Je,Ze,0,Ct.RGBA,Ct.UNSIGNED_BYTE,xe),kt("copy",d,p,function(ft){var gt=ft.setUniform,_t=ft.setAttribute;_t("aUV",2,Ct.STATIC_DRAW,0,new Float32Array([0,0,2,0,0,2])),gt("1i","image",Pe),Ct.bindFramebuffer(Ct.FRAMEBUFFER,Fe||null),Ct.disable(Ct.BLEND),Ct.colorMask(Ke&8,Ke&4,Ke&2,Ke&1),Ct.viewport(ae,Ee,Je,Ze),Ct.scissor(ae,Ee,Je,Ze),Ct.drawArrays(Ct.TRIANGLES,0,3)})})})}function S(me,xe,ae){var Ee=me.width,Je=me.height;_(me,function(Ze){var Ke=Ze.gl,Fe=new Uint8Array(Ee*Je*4);Ke.readPixels(0,0,Ee,Je,Ke.RGBA,Ke.UNSIGNED_BYTE,Fe),me.width=xe,me.height=ae,x(Ke,Fe,0,0,Ee,Je)})}var T=Object.freeze({__proto__:null,withWebGLContext:_,renderImageData:x,resizeWebGLCanvasWithoutClearing:S});function I(me,xe,ae,Ee,Je,Ze){Ze===void 0&&(Ze=1);var Ke=new Uint8Array(me*xe),Fe=Ee[2]-Ee[0],ct=Ee[3]-Ee[1],Ct=[];l(ae,function(_t,Be,ue,se){Ct.push({x1:_t,y1:Be,x2:ue,y2:se,minX:Math.min(_t,ue),minY:Math.min(Be,se),maxX:Math.max(_t,ue),maxY:Math.max(Be,se)})}),Ct.sort(function(_t,Be){return _t.maxX-Be.maxX});for(var kt=0;kt<me;kt++)for(var Kt=0;Kt<xe;Kt++){var At=ft(Ee[0]+Fe*(kt+.5)/me,Ee[1]+ct*(Kt+.5)/xe),Pe=Math.pow(1-Math.abs(At)/Je,Ze)/2;At<0&&(Pe=1-Pe),Pe=Math.max(0,Math.min(255,Math.round(Pe*255))),Ke[Kt*me+kt]=Pe}return Ke;function ft(_t,Be){for(var ue=1/0,se=1/0,_e=Ct.length;_e--;){var je=Ct[_e];if(je.maxX+se<=_t)break;if(_t+se>je.minX&&Be-se<je.maxY&&Be+se>je.minY){var De=L(_t,Be,je.x1,je.y1,je.x2,je.y2);De<ue&&(ue=De,se=Math.sqrt(ue))}}return gt(_t,Be)&&(se=-se),se}function gt(_t,Be){for(var ue=0,se=Ct.length;se--;){var _e=Ct[se];if(_e.maxX<=_t)break;var je=_e.y1>Be!=_e.y2>Be&&_t<(_e.x2-_e.x1)*(Be-_e.y1)/(_e.y2-_e.y1)+_e.x1;je&&(ue+=_e.y1<_e.y2?1:-1)}return ue!==0}}function R(me,xe,ae,Ee,Je,Ze,Ke,Fe,ct,Ct){Ze===void 0&&(Ze=1),Fe===void 0&&(Fe=0),ct===void 0&&(ct=0),Ct===void 0&&(Ct=0),D(me,xe,ae,Ee,Je,Ze,Ke,null,Fe,ct,Ct)}function D(me,xe,ae,Ee,Je,Ze,Ke,Fe,ct,Ct,kt){Ze===void 0&&(Ze=1),ct===void 0&&(ct=0),Ct===void 0&&(Ct=0),kt===void 0&&(kt=0);for(var Kt=I(me,xe,ae,Ee,Je,Ze),At=new Uint8Array(Kt.length*4),Pe=0;Pe<Kt.length;Pe++)At[Pe*4+kt]=Kt[Pe];x(Ke,At,ct,Ct,me,xe,1<<3-kt,Fe)}function L(me,xe,ae,Ee,Je,Ze){var Ke=Je-ae,Fe=Ze-Ee,ct=Ke*Ke+Fe*Fe,Ct=ct?Math.max(0,Math.min(1,((me-ae)*Ke+(xe-Ee)*Fe)/ct)):0,kt=me-(ae+Ct*Ke),Kt=xe-(Ee+Ct*Fe);return kt*kt+Kt*Kt}var O=Object.freeze({__proto__:null,generate:I,generateIntoCanvas:R,generateIntoFramebuffer:D}),N="precision highp float;uniform vec4 uGlyphBounds;attribute vec2 aUV;attribute vec4 aLineSegment;varying vec4 vLineSegment;varying vec2 vGlyphXY;void main(){vLineSegment=aLineSegment;vGlyphXY=mix(uGlyphBounds.xy,uGlyphBounds.zw,aUV);gl_Position=vec4(mix(vec2(-1.0),vec2(1.0),aUV),0.0,1.0);}",F="precision highp float;uniform vec4 uGlyphBounds;uniform float uMaxDistance;uniform float uExponent;varying vec4 vLineSegment;varying vec2 vGlyphXY;float absDistToSegment(vec2 point,vec2 lineA,vec2 lineB){vec2 lineDir=lineB-lineA;float lenSq=dot(lineDir,lineDir);float t=lenSq==0.0 ? 0.0 : clamp(dot(point-lineA,lineDir)/lenSq,0.0,1.0);vec2 linePt=lineA+t*lineDir;return distance(point,linePt);}void main(){vec4 seg=vLineSegment;vec2 p=vGlyphXY;float dist=absDistToSegment(p,seg.xy,seg.zw);float val=pow(1.0-clamp(dist/uMaxDistance,0.0,1.0),uExponent)*0.5;bool crossing=(seg.y>p.y!=seg.w>p.y)&&(p.x<(seg.z-seg.x)*(p.y-seg.y)/(seg.w-seg.y)+seg.x);bool crossingUp=crossing&&vLineSegment.y<vLineSegment.w;gl_FragColor=vec4(crossingUp ? 1.0/255.0 : 0.0,crossing&&!crossingUp ? 1.0/255.0 : 0.0,0.0,val);}",G="precision highp float;uniform sampler2D tex;varying vec2 vUV;void main(){vec4 color=texture2D(tex,vUV);bool inside=color.r!=color.g;float val=inside ? 1.0-color.a : color.a;gl_FragColor=vec4(val);}",j=new Float32Array([0,0,2,0,0,2]),Y=null,te=!1,V={},Q=new WeakMap;function he(me){if(!te&&!Me(me))throw new Error("WebGL generation not supported")}function fe(me,xe,ae,Ee,Je,Ze,Ke){if(Ze===void 0&&(Ze=1),Ke===void 0&&(Ke=null),!Ke&&(Ke=Y,!Ke)){var Fe=typeof OffscreenCanvas=="function"?new OffscreenCanvas(1,1):typeof document<"u"?document.createElement("canvas"):null;if(!Fe)throw new Error("OffscreenCanvas or DOM canvas not supported");Ke=Y=Fe.getContext("webgl",{depth:!1})}he(Ke);var ct=new Uint8Array(me*xe*4);_(Ke,function(At){var Pe=At.gl,ft=At.withTexture,gt=At.withTextureFramebuffer;ft("readable",function(_t,Be){Pe.texImage2D(Pe.TEXTURE_2D,0,Pe.RGBA,me,xe,0,Pe.RGBA,Pe.UNSIGNED_BYTE,null),gt(_t,Be,function(ue){pe(me,xe,ae,Ee,Je,Ze,Pe,ue,0,0,0),Pe.readPixels(0,0,me,xe,Pe.RGBA,Pe.UNSIGNED_BYTE,ct)})})});for(var Ct=new Uint8Array(me*xe),kt=0,Kt=0;kt<ct.length;kt+=4)Ct[Kt++]=ct[kt];return Ct}function ye(me,xe,ae,Ee,Je,Ze,Ke,Fe,ct,Ct){Ze===void 0&&(Ze=1),Fe===void 0&&(Fe=0),ct===void 0&&(ct=0),Ct===void 0&&(Ct=0),pe(me,xe,ae,Ee,Je,Ze,Ke,null,Fe,ct,Ct)}function pe(me,xe,ae,Ee,Je,Ze,Ke,Fe,ct,Ct,kt){Ze===void 0&&(Ze=1),ct===void 0&&(ct=0),Ct===void 0&&(Ct=0),kt===void 0&&(kt=0),he(Ke);var Kt=[];l(ae,function(At,Pe,ft,gt){Kt.push(At,Pe,ft,gt)}),Kt=new Float32Array(Kt),_(Ke,function(At){var Pe=At.gl,ft=At.isWebGL2,gt=At.getExtension,_t=At.withProgram,Be=At.withTexture,ue=At.withTextureFramebuffer,se=At.handleContextLoss;if(Be("rawDistances",function(_e,je){(me!==_e._lastWidth||xe!==_e._lastHeight)&&Pe.texImage2D(Pe.TEXTURE_2D,0,Pe.RGBA,_e._lastWidth=me,_e._lastHeight=xe,0,Pe.RGBA,Pe.UNSIGNED_BYTE,null),_t("main",N,F,function(De){var st=De.setAttribute,de=De.setUniform,ne=!ft&&gt("ANGLE_instanced_arrays"),Oe=!ft&&gt("EXT_blend_minmax");st("aUV",2,Pe.STATIC_DRAW,0,j),st("aLineSegment",4,Pe.DYNAMIC_DRAW,1,Kt),de.apply(void 0,["4f","uGlyphBounds"].concat(Ee)),de("1f","uMaxDistance",Je),de("1f","uExponent",Ze),ue(_e,je,function(ut){Pe.enable(Pe.BLEND),Pe.colorMask(!0,!0,!0,!0),Pe.viewport(0,0,me,xe),Pe.scissor(0,0,me,xe),Pe.blendFunc(Pe.ONE,Pe.ONE),Pe.blendEquationSeparate(Pe.FUNC_ADD,ft?Pe.MAX:Oe.MAX_EXT),Pe.clear(Pe.COLOR_BUFFER_BIT),ft?Pe.drawArraysInstanced(Pe.TRIANGLES,0,3,Kt.length/4):ne.drawArraysInstancedANGLE(Pe.TRIANGLES,0,3,Kt.length/4)})}),_t("post",d,G,function(De){De.setAttribute("aUV",2,Pe.STATIC_DRAW,0,j),De.setUniform("1i","tex",je),Pe.bindFramebuffer(Pe.FRAMEBUFFER,Fe),Pe.disable(Pe.BLEND),Pe.colorMask(kt===0,kt===1,kt===2,kt===3),Pe.viewport(ct,Ct,me,xe),Pe.scissor(ct,Ct,me,xe),Pe.drawArrays(Pe.TRIANGLES,0,3)})}),Pe.isContextLost())throw se(),new Error("webgl context lost")})}function Me(me){var xe=!me||me===Y?V:me.canvas||me,ae=Q.get(xe);if(ae===void 0){te=!0;var Ee=null;try{var Je=[97,106,97,61,99,137,118,80,80,118,137,99,61,97,106,97],Ze=fe(4,4,"M8,8L16,8L24,24L16,24Z",[0,0,32,32],24,1,me);ae=Ze&&Je.length===Ze.length&&Ze.every(function(Ke,Fe){return Ke===Je[Fe]}),ae||(Ee="bad trial run results",console.info(Je,Ze))}catch(Ke){ae=!1,Ee=Ke.message}Ee&&console.warn("WebGL SDF generation not supported:",Ee),te=!1,Q.set(xe,ae)}return ae}var Ie=Object.freeze({__proto__:null,generate:fe,generateIntoCanvas:ye,generateIntoFramebuffer:pe,isSupported:Me});function ze(me,xe,ae,Ee,Je,Ze){Je===void 0&&(Je=Math.max(Ee[2]-Ee[0],Ee[3]-Ee[1])/2),Ze===void 0&&(Ze=1);try{return fe.apply(Ie,arguments)}catch(Ke){return console.info("WebGL SDF generation failed, falling back to JS",Ke),I.apply(O,arguments)}}function le(me,xe,ae,Ee,Je,Ze,Ke,Fe,ct,Ct){Je===void 0&&(Je=Math.max(Ee[2]-Ee[0],Ee[3]-Ee[1])/2),Ze===void 0&&(Ze=1),Fe===void 0&&(Fe=0),ct===void 0&&(ct=0),Ct===void 0&&(Ct=0);try{return ye.apply(Ie,arguments)}catch(kt){return console.info("WebGL SDF generation failed, falling back to JS",kt),R.apply(O,arguments)}}return e.forEachPathCommand=s,e.generate=ze,e.generateIntoCanvas=le,e.javascript=O,e.pathToLineSegments=l,e.webgl=Ie,e.webglUtils=T,Object.defineProperty(e,"__esModule",{value:!0}),e}({});return n}function jEe(){var n=function(e){var i={R:"13k,1a,2,3,3,2+1j,ch+16,a+1,5+2,2+n,5,a,4,6+16,4+3,h+1b,4mo,179q,2+9,2+11,2i9+7y,2+68,4,3+4,5+13,4+3,2+4k,3+29,8+cf,1t+7z,w+17,3+3m,1t+3z,16o1+5r,8+30,8+mc,29+1r,29+4v,75+73",EN:"1c+9,3d+1,6,187+9,513,4+5,7+9,sf+j,175h+9,qw+q,161f+1d,4xt+a,25i+9",ES:"17,2,6dp+1,f+1,av,16vr,mx+1,4o,2",ET:"z+2,3h+3,b+1,ym,3e+1,2o,p4+1,8,6u,7c,g6,1wc,1n9+4,30+1b,2n,6d,qhx+1,h0m,a+1,49+2,63+1,4+1,6bb+3,12jj",AN:"16o+5,2j+9,2+1,35,ed,1ff2+9,87+u",CS:"18,2+1,b,2u,12k,55v,l,17v0,2,3,53,2+1,b",B:"a,3,f+2,2v,690",S:"9,2,k",WS:"c,k,4f4,1vk+a,u,1j,335",ON:"x+1,4+4,h+5,r+5,r+3,z,5+3,2+1,2+1,5,2+2,3+4,o,w,ci+1,8+d,3+d,6+8,2+g,39+1,9,6+1,2,33,b8,3+1,3c+1,7+1,5r,b,7h+3,sa+5,2,3i+6,jg+3,ur+9,2v,ij+1,9g+9,7+a,8m,4+1,49+x,14u,2+2,c+2,e+2,e+2,e+1,i+n,e+e,2+p,u+2,e+2,36+1,2+3,2+1,b,2+2,6+5,2,2,2,h+1,5+4,6+3,3+f,16+2,5+3l,3+81,1y+p,2+40,q+a,m+13,2r+ch,2+9e,75+hf,3+v,2+2w,6e+5,f+6,75+2a,1a+p,2+2g,d+5x,r+b,6+3,4+o,g,6+1,6+2,2k+1,4,2j,5h+z,1m+1,1e+f,t+2,1f+e,d+3,4o+3,2s+1,w,535+1r,h3l+1i,93+2,2s,b+1,3l+x,2v,4g+3,21+3,kz+1,g5v+1,5a,j+9,n+v,2,3,2+8,2+1,3+2,2,3,46+1,4+4,h+5,r+5,r+a,3h+2,4+6,b+4,78,1r+24,4+c,4,1hb,ey+6,103+j,16j+c,1ux+7,5+g,fsh,jdq+1t,4,57+2e,p1,1m,1m,1m,1m,4kt+1,7j+17,5+2r,d+e,3+e,2+e,2+10,m+4,w,1n+5,1q,4z+5,4b+rb,9+c,4+c,4+37,d+2g,8+b,l+b,5+1j,9+9,7+13,9+t,3+1,27+3c,2+29,2+3q,d+d,3+4,4+2,6+6,a+o,8+6,a+2,e+6,16+42,2+1i",BN:"0+8,6+d,2s+5,2+p,e,4m9,1kt+2,2b+5,5+5,17q9+v,7k,6p+8,6+1,119d+3,440+7,96s+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+75,6p+2rz,1ben+1,1ekf+1,1ekf+1",NSM:"lc+33,7o+6,7c+18,2,2+1,2+1,2,21+a,1d+k,h,2u+6,3+5,3+1,2+3,10,v+q,2k+a,1n+8,a,p+3,2+8,2+2,2+4,18+2,3c+e,2+v,1k,2,5+7,5,4+6,b+1,u,1n,5+3,9,l+1,r,3+1,1m,5+1,5+1,3+2,4,v+1,4,c+1,1m,5+4,2+1,5,l+1,n+5,2,1n,3,2+3,9,8+1,c+1,v,1q,d,1f,4,1m+2,6+2,2+3,8+1,c+1,u,1n,g+1,l+1,t+1,1m+1,5+3,9,l+1,u,21,8+2,2,2j,3+6,d+7,2r,3+8,c+5,23+1,s,2,2,1k+d,2+4,2+1,6+a,2+z,a,2v+3,2+5,2+1,3+1,q+1,5+2,h+3,e,3+1,7,g,jk+2,qb+2,u+2,u+1,v+1,1t+1,2+6,9,3+a,a,1a+2,3c+1,z,3b+2,5+1,a,7+2,64+1,3,1n,2+6,2,2,3+7,7+9,3,1d+g,1s+3,1d,2+4,2,6,15+8,d+1,x+3,3+1,2+2,1l,2+1,4,2+2,1n+7,3+1,49+2,2+c,2+6,5,7,4+1,5j+1l,2+4,k1+w,2db+2,3y,2p+v,ff+3,30+1,n9x+3,2+9,x+1,29+1,7l,4,5,q+1,6,48+1,r+h,e,13+7,q+a,1b+2,1d,3+3,3+1,14,1w+5,3+1,3+1,d,9,1c,1g,2+2,3+1,6+1,2,17+1,9,6n,3,5,fn5,ki+f,h+f,r2,6b,46+4,1af+2,2+1,6+3,15+2,5,4m+1,fy+3,as+1,4a+a,4x,1j+e,1l+2,1e+3,3+1,1y+2,11+4,2+7,1r,d+1,1h+8,b+3,3,2o+2,3,2+1,7,4h,4+7,m+1,1m+1,4,12+6,4+4,5g+7,3+2,2,o,2d+5,2,5+1,2+1,6n+3,7+1,2+1,s+1,2e+7,3,2+1,2z,2,3+5,2,2u+2,3+3,2+4,78+8,2+1,75+1,2,5,41+3,3+1,5,x+5,3+1,15+5,3+3,9,a+5,3+2,1b+c,2+1,bb+6,2+5,2d+l,3+6,2+1,2+1,3f+5,4,2+1,2+6,2,21+1,4,2,9o+1,f0c+4,1o+6,t5,1s+3,2a,f5l+1,43t+2,i+7,3+6,v+3,45+2,1j0+1i,5+1d,9,f,n+4,2+e,11t+6,2+g,3+6,2+1,2+4,7a+6,c6+3,15t+6,32+6,gzhy+6n",AL:"16w,3,2,e+1b,z+2,2+2s,g+1,8+1,b+m,2+t,s+2i,c+e,4h+f,1d+1e,1bwe+dp,3+3z,x+c,2+1,35+3y,2rm+z,5+7,b+5,dt+l,c+u,17nl+27,1t+27,4x+6n,3+d",LRO:"6ct",RLO:"6cu",LRE:"6cq",RLE:"6cr",PDF:"6cs",LRI:"6ee",RLI:"6ef",FSI:"6eg",PDI:"6eh"},o={},s={};o.L=1,s[1]="L",Object.keys(i).forEach(function(se,_e){o[se]=1<<_e+1,s[o[se]]=se}),Object.freeze(o);var l=o.LRI|o.RLI|o.FSI,d=o.L|o.R|o.AL,p=o.B|o.S|o.WS|o.ON|o.FSI|o.LRI|o.RLI|o.PDI,f=o.BN|o.RLE|o.LRE|o.RLO|o.LRO|o.PDF,y=o.S|o.WS|o.B|l|o.PDI|f,_=null;function x(){if(!_){_=new Map;var se=function(je){if(i.hasOwnProperty(je)){var De=0;i[je].split(",").forEach(function(st){var de=st.split("+"),ne=de[0],Oe=de[1];ne=parseInt(ne,36),Oe=Oe?parseInt(Oe,36):0,_.set(De+=ne,o[je]);for(var ut=0;ut<Oe;ut++)_.set(++De,o[je])})}};for(var _e in i)se(_e)}}function S(se){return x(),_.get(se.codePointAt(0))||o.L}function T(se){return s[S(se)]}var I={pairs:"14>1,1e>2,u>2,2wt>1,1>1,1ge>1,1wp>1,1j>1,f>1,hm>1,1>1,u>1,u6>1,1>1,+5,28>1,w>1,1>1,+3,b8>1,1>1,+3,1>3,-1>-1,3>1,1>1,+2,1s>1,1>1,x>1,th>1,1>1,+2,db>1,1>1,+3,3>1,1>1,+2,14qm>1,1>1,+1,4q>1,1e>2,u>2,2>1,+1",canonical:"6f1>-6dx,6dy>-6dx,6ec>-6ed,6ee>-6ed,6ww>2jj,-2ji>2jj,14r4>-1e7l,1e7m>-1e7l,1e7m>-1e5c,1e5d>-1e5b,1e5c>-14qx,14qy>-14qx,14vn>-1ecg,1ech>-1ecg,1edu>-1ecg,1eci>-1ecg,1eda>-1ecg,1eci>-1ecg,1eci>-168q,168r>-168q,168s>-14ye,14yf>-14ye"};function R(se,_e){var je=36,De=0,st=new Map,de=_e&&new Map,ne;return se.split(",").forEach(function Oe(ut){if(ut.indexOf("+")!==-1)for(var it=+ut;it--;)Oe(ne);else{ne=ut;var lt=ut.split(">"),Et=lt[0],Ut=lt[1];Et=String.fromCodePoint(De+=parseInt(Et,je)),Ut=String.fromCodePoint(De+=parseInt(Ut,je)),st.set(Et,Ut),_e&&de.set(Ut,Et)}}),{map:st,reverseMap:de}}var D,L,O;function N(){if(!D){var se=R(I.pairs,!0),_e=se.map,je=se.reverseMap;D=_e,L=je,O=R(I.canonical,!1).map}}function F(se){return N(),D.get(se)||null}function G(se){return N(),L.get(se)||null}function j(se){return N(),O.get(se)||null}var Y=o.L,te=o.R,V=o.EN,Q=o.ES,he=o.ET,fe=o.AN,ye=o.CS,pe=o.B,Me=o.S,Ie=o.ON,ze=o.BN,le=o.NSM,me=o.AL,xe=o.LRO,ae=o.RLO,Ee=o.LRE,Je=o.RLE,Ze=o.PDF,Ke=o.LRI,Fe=o.RLI,ct=o.FSI,Ct=o.PDI;function kt(se,_e){for(var je=125,De=new Uint32Array(se.length),st=0;st<se.length;st++)De[st]=S(se[st]);var de=new Map;function ne(Br,La){var Sn=De[Br];De[Br]=La,de.set(Sn,de.get(Sn)-1),Sn&p&&de.set(p,de.get(p)-1),de.set(La,(de.get(La)||0)+1),La&p&&de.set(p,(de.get(p)||0)+1)}for(var Oe=new Uint8Array(se.length),ut=new Map,it=[],lt=null,Et=0;Et<se.length;Et++)lt||it.push(lt={start:Et,end:se.length-1,level:_e==="rtl"?1:_e==="ltr"?0:Au(Et,!1)}),De[Et]&pe&&(lt.end=Et,lt=null);for(var Ut=Je|Ee|ae|xe|l|Ct|Ze|pe,Wt=function(Br){return Br+(Br&1?1:2)},Ht=function(Br){return Br+(Br&1?2:1)},Dt=0;Dt<it.length;Dt++){lt=it[Dt];var wt=[{_level:lt.level,_override:0,_isolate:0}],Xt=void 0,He=0,Pt=0,qt=0;de.clear();for(var Nt=lt.start;Nt<=lt.end;Nt++){var hn=De[Nt];if(Xt=wt[wt.length-1],de.set(hn,(de.get(hn)||0)+1),hn&p&&de.set(p,(de.get(p)||0)+1),hn&Ut)if(hn&(Je|Ee)){Oe[Nt]=Xt._level;var be=(hn===Je?Ht:Wt)(Xt._level);be<=je&&!He&&!Pt?wt.push({_level:be,_override:0,_isolate:0}):He||Pt++}else if(hn&(ae|xe)){Oe[Nt]=Xt._level;var Qe=(hn===ae?Ht:Wt)(Xt._level);Qe<=je&&!He&&!Pt?wt.push({_level:Qe,_override:hn&ae?te:Y,_isolate:0}):He||Pt++}else if(hn&l){hn&ct&&(hn=Au(Nt+1,!0)===1?Fe:Ke),Oe[Nt]=Xt._level,Xt._override&&ne(Nt,Xt._override);var we=(hn===Fe?Ht:Wt)(Xt._level);we<=je&&He===0&&Pt===0?(qt++,wt.push({_level:we,_override:0,_isolate:1,_isolInitIndex:Nt})):He++}else if(hn&Ct){if(He>0)He--;else if(qt>0){for(Pt=0;!wt[wt.length-1]._isolate;)wt.pop();var Te=wt[wt.length-1]._isolInitIndex;Te!=null&&(ut.set(Te,Nt),ut.set(Nt,Te)),wt.pop(),qt--}Xt=wt[wt.length-1],Oe[Nt]=Xt._level,Xt._override&&ne(Nt,Xt._override)}else hn&Ze?(He===0&&(Pt>0?Pt--:!Xt._isolate&&wt.length>1&&(wt.pop(),Xt=wt[wt.length-1])),Oe[Nt]=Xt._level):hn&pe&&(Oe[Nt]=lt.level);else Oe[Nt]=Xt._level,Xt._override&&hn!==ze&&ne(Nt,Xt._override)}for(var Ne=[],et=null,tt=lt.start;tt<=lt.end;tt++){var vt=De[tt];if(!(vt&f)){var ht=Oe[tt],dt=vt&l,Vt=vt===Ct;et&&ht===et._level?(et._end=tt,et._endsWithIsolInit=dt):Ne.push(et={_start:tt,_end:tt,_level:ht,_startsWithPDI:Vt,_endsWithIsolInit:dt})}}for(var It=[],Qt=0;Qt<Ne.length;Qt++){var fn=Ne[Qt];if(!fn._startsWithPDI||fn._startsWithPDI&&!ut.has(fn._start)){for(var en=[et=fn],vn=void 0;et&&et._endsWithIsolInit&&(vn=ut.get(et._end))!=null;)for(var Vn=Qt+1;Vn<Ne.length;Vn++)if(Ne[Vn]._start===vn){en.push(et=Ne[Vn]);break}for(var ei=[],xi=0;xi<en.length;xi++)for(var wi=en[xi],pa=wi._start;pa<=wi._end;pa++)ei.push(pa);for(var na=Oe[ei[0]],Re=lt.level,bt=ei[0]-1;bt>=0;bt--)if(!(De[bt]&f)){Re=Oe[bt];break}var Ot=ei[ei.length-1],Lt=Oe[Ot],zt=lt.level;if(!(De[Ot]&l)){for(var jt=Ot+1;jt<=lt.end;jt++)if(!(De[jt]&f)){zt=Oe[jt];break}}It.push({_seqIndices:ei,_sosType:Math.max(Re,na)%2?te:Y,_eosType:Math.max(zt,Lt)%2?te:Y})}}for(var gn=0;gn<It.length;gn++){var Xn=It[gn],rn=Xn._seqIndices,di=Xn._sosType,gi=Xn._eosType,li=Oe[rn[0]]&1?te:Y;if(de.get(le))for(var ra=0;ra<rn.length;ra++){var wr=rn[ra];if(De[wr]&le){for(var ia=di,Ka=ra-1;Ka>=0;Ka--)if(!(De[rn[Ka]]&f)){ia=De[rn[Ka]];break}ne(wr,ia&(l|Ct)?Ie:ia)}}if(de.get(V))for(var ri=0;ri<rn.length;ri++){var Rn=rn[ri];if(De[Rn]&V)for(var uo=ri-1;uo>=-1;uo--){var Di=uo===-1?di:De[rn[uo]];if(Di&d){Di===me&&ne(Rn,fe);break}}}if(de.get(me))for(var Ia=0;Ia<rn.length;Ia++){var Go=rn[Ia];De[Go]&me&&ne(Go,te)}if(de.get(Q)||de.get(ye))for(var Sr=1;Sr<rn.length-1;Sr++){var Ja=rn[Sr];if(De[Ja]&(Q|ye)){for(var fa=0,zr=0,Cn=Sr-1;Cn>=0&&(fa=De[rn[Cn]],!!(fa&f));Cn--);for(var Jn=Sr+1;Jn<rn.length&&(zr=De[rn[Jn]],!!(zr&f));Jn++);fa===zr&&(De[Ja]===Q?fa===V:fa&(V|fe))&&ne(Ja,fa)}}if(de.get(V))for(var ja=0;ja<rn.length;ja++){var Ar=rn[ja];if(De[Ar]&V){for(var Ts=ja-1;Ts>=0&&De[rn[Ts]]&(he|f);Ts--)ne(rn[Ts],V);for(ja++;ja<rn.length&&De[rn[ja]]&(he|f|V);ja++)De[rn[ja]]!==V&&ne(rn[ja],V)}}if(de.get(he)||de.get(Q)||de.get(ye))for(var wu=0;wu<rn.length;wu++){var Nf=rn[wu];if(De[Nf]&(he|Q|ye)){ne(Nf,Ie);for(var ic=wu-1;ic>=0&&De[rn[ic]]&f;ic--)ne(rn[ic],Ie);for(var Cl=wu+1;Cl<rn.length&&De[rn[Cl]]&f;Cl++)ne(rn[Cl],Ie)}}if(de.get(V))for(var Pl=0,Il=di;Pl<rn.length;Pl++){var Pd=rn[Pl],Zh=De[Pd];Zh&V?Il===Y&&ne(Pd,Y):Zh&d&&(Il=Zh)}if(de.get(p)){var ac=te|V|fe,Id=ac|Y,Xs=[];{for(var $t=[],bn=0;bn<rn.length;bn++)if(De[rn[bn]]&p){var Un=se[rn[bn]],at=void 0;if(F(Un)!==null)if($t.length<63)$t.push({char:Un,seqIndex:bn});else break;else if((at=G(Un))!==null)for(var ln=$t.length-1;ln>=0;ln--){var Zs=$t[ln].char;if(Zs===at||Zs===G(j(Un))||F(j(Zs))===Un){Xs.push([$t[ln].seqIndex,bn]),$t.length=ln;break}}}Xs.sort(function(Br,La){return Br[0]-La[0]})}for(var Cs=0;Cs<Xs.length;Cs++){for(var Ga=Xs[Cs],oa=Ga[0],Ld=Ga[1],Ps=!1,Ao=0,zf=oa+1;zf<Ld;zf++){var Ks=rn[zf];if(De[Ks]&Id){Ps=!0;var an=De[Ks]&ac?te:Y;if(an===li){Ao=an;break}}}if(Ps&&!Ao){Ao=di;for(var yi=oa-1;yi>=0;yi--){var Ei=rn[yi];if(De[Ei]&Id){var Qa=De[Ei]&ac?te:Y;Qa!==li?Ao=Qa:Ao=li;break}}}if(Ao){if(De[rn[oa]]=De[rn[Ld]]=Ao,Ao!==li){for(var Fr=oa+1;Fr<rn.length;Fr++)if(!(De[rn[Fr]]&f)){S(se[rn[Fr]])&le&&(De[rn[Fr]]=Ao);break}}if(Ao!==li){for(var oi=Ld+1;oi<rn.length;oi++)if(!(De[rn[oi]]&f)){S(se[rn[oi]])&le&&(De[rn[oi]]=Ao);break}}}}for(var Ho=0;Ho<rn.length;Ho++)if(De[rn[Ho]]&p){for(var kc=Ho,Dc=Ho,Oa=di,ma=Ho-1;ma>=0;ma--)if(De[rn[ma]]&f)kc=ma;else{Oa=De[rn[ma]]&ac?te:Y;break}for(var Rd=gi,Ll=Ho+1;Ll<rn.length;Ll++)if(De[rn[Ll]]&(p|f))Dc=Ll;else{Rd=De[rn[Ll]]&ac?te:Y;break}for(var Eo=kc;Eo<=Dc;Eo++)De[rn[Eo]]=Oa===Rd?Oa:li;Ho=Dc}}}for(var fr=lt.start;fr<=lt.end;fr++){var Su=Oe[fr],Js=De[fr];if(Su&1?Js&(Y|V|fe)&&Oe[fr]++:Js&te?Oe[fr]++:Js&(fe|V)&&(Oe[fr]+=2),Js&f&&(Oe[fr]=fr===0?lt.level:Oe[fr-1]),fr===lt.end||S(se[fr])&(Me|pe))for(var Rl=fr;Rl>=0&&S(se[Rl])&y;Rl--)Oe[Rl]=lt.level}}return{levels:Oe,paragraphs:it};function Au(Br,La){for(var Sn=Br;Sn<se.length;Sn++){var ar=De[Sn];if(ar&(te|me))return 1;if(ar&(pe|Y)||La&&ar===Ct)return 0;if(ar&l){var jo=kd(Sn);Sn=jo===-1?se.length:jo}}return 0}function kd(Br){for(var La=1,Sn=Br+1;Sn<se.length;Sn++){var ar=De[Sn];if(ar&pe)break;if(ar&Ct){if(--La===0)return Sn}else ar&l&&La++}return-1}}var Kt="14>1,j>2,t>2,u>2,1a>g,2v3>1,1>1,1ge>1,1wd>1,b>1,1j>1,f>1,ai>3,-2>3,+1,8>1k0,-1jq>1y7,-1y6>1hf,-1he>1h6,-1h5>1ha,-1h8>1qi,-1pu>1,6>3u,-3s>7,6>1,1>1,f>1,1>1,+2,3>1,1>1,+13,4>1,1>1,6>1eo,-1ee>1,3>1mg,-1me>1mk,-1mj>1mi,-1mg>1mi,-1md>1,1>1,+2,1>10k,-103>1,1>1,4>1,5>1,1>1,+10,3>1,1>8,-7>8,+1,-6>7,+1,a>1,1>1,u>1,u6>1,1>1,+5,26>1,1>1,2>1,2>2,8>1,7>1,4>1,1>1,+5,b8>1,1>1,+3,1>3,-2>1,2>1,1>1,+2,c>1,3>1,1>1,+2,h>1,3>1,a>1,1>1,2>1,3>1,1>1,d>1,f>1,3>1,1a>1,1>1,6>1,7>1,13>1,k>1,1>1,+19,4>1,1>1,+2,2>1,1>1,+18,m>1,a>1,1>1,lk>1,1>1,4>1,2>1,f>1,3>1,1>1,+3,db>1,1>1,+3,3>1,1>1,+2,14qm>1,1>1,+1,6>1,4j>1,j>2,t>2,u>2,2>1,+1",At;function Pe(){if(!At){var se=R(Kt,!0),_e=se.map,je=se.reverseMap;je.forEach(function(De,st){_e.set(st,De)}),At=_e}}function ft(se){return Pe(),At.get(se)||null}function gt(se,_e,je,De){var st=se.length;je=Math.max(0,je==null?0:+je),De=Math.min(st-1,De==null?st-1:+De);for(var de=new Map,ne=je;ne<=De;ne++)if(_e[ne]&1){var Oe=ft(se[ne]);Oe!==null&&de.set(ne,Oe)}return de}function _t(se,_e,je,De){var st=se.length;je=Math.max(0,je==null?0:+je),De=Math.min(st-1,De==null?st-1:+De);var de=[];return _e.paragraphs.forEach(function(ne){var Oe=Math.max(je,ne.start),ut=Math.min(De,ne.end);if(Oe<ut){for(var it=_e.levels.slice(Oe,ut+1),lt=ut;lt>=Oe&&S(se[lt])&y;lt--)it[lt]=ne.level;for(var Et=ne.level,Ut=1/0,Wt=0;Wt<it.length;Wt++){var Ht=it[Wt];Ht>Et&&(Et=Ht),Ht<Ut&&(Ut=Ht|1)}for(var Dt=Et;Dt>=Ut;Dt--)for(var wt=0;wt<it.length;wt++)if(it[wt]>=Dt){for(var Xt=wt;wt+1<it.length&&it[wt+1]>=Dt;)wt++;wt>Xt&&de.push([Xt+Oe,wt+Oe])}}}),de}function Be(se,_e,je,De){var st=ue(se,_e,je,De),de=[].concat(se);return st.forEach(function(ne,Oe){de[Oe]=(_e.levels[ne]&1?ft(se[ne]):null)||se[ne]}),de.join("")}function ue(se,_e,je,De){for(var st=_t(se,_e,je,De),de=[],ne=0;ne<se.length;ne++)de[ne]=ne;return st.forEach(function(Oe){for(var ut=Oe[0],it=Oe[1],lt=de.slice(ut,it+1),Et=lt.length;Et--;)de[it-Et]=lt[Et]}),de}return e.closingToOpeningBracket=G,e.getBidiCharType=S,e.getBidiCharTypeName=T,e.getCanonicalBracket=j,e.getEmbeddingLevels=kt,e.getMirroredCharacter=ft,e.getMirroredCharactersMap=gt,e.getReorderSegments=_t,e.getReorderedIndices=ue,e.getReorderedString=Be,e.openingToClosingBracket=F,Object.defineProperty(e,"__esModule",{value:!0}),e}({});return n}const LK=/\bvoid\s+main\s*\(\s*\)\s*{/g;function HR(n){const e=/^[ \t]*#include +<([\w\d./]+)>/gm;function i(o,s){let l=zi[s];return l?HR(l):o}return n.replace(e,i)}const Xo=[];for(let n=0;n<256;n++)Xo[n]=(n<16?"0":"")+n.toString(16);function $Ee(){const n=Math.random()*4294967295|0,e=Math.random()*4294967295|0,i=Math.random()*4294967295|0,o=Math.random()*4294967295|0;return(Xo[n&255]+Xo[n>>8&255]+Xo[n>>16&255]+Xo[n>>24&255]+"-"+Xo[e&255]+Xo[e>>8&255]+"-"+Xo[e>>16&15|64]+Xo[e>>24&255]+"-"+Xo[i&63|128]+Xo[i>>8&255]+"-"+Xo[i>>16&255]+Xo[i>>24&255]+Xo[o&255]+Xo[o>>8&255]+Xo[o>>16&255]+Xo[o>>24&255]).toUpperCase()}const $m=Object.assign||function(){let n=arguments[0];for(let e=1,i=arguments.length;e<i;e++){let o=arguments[e];if(o)for(let s in o)Object.prototype.hasOwnProperty.call(o,s)&&(n[s]=o[s])}return n},YEe=Date.now(),dG=new WeakMap,hG=new Map;let qEe=1e10;function jR(n,e){const i=JEe(e);let o=dG.get(n);if(o||dG.set(n,o=Object.create(null)),o[i])return new o[i];const s=`_onBeforeCompile${i}`,l=function(y,_){n.onBeforeCompile.call(this,y,_);const x=this.customProgramCacheKey()+"|"+y.vertexShader+"|"+y.fragmentShader;let S=hG[x];if(!S){const T=XEe(this,y,e,i);S=hG[x]=T}y.vertexShader=S.vertexShader,y.fragmentShader=S.fragmentShader,$m(y.uniforms,this.uniforms),e.timeUniform&&(y.uniforms[e.timeUniform]={get value(){return Date.now()-YEe}}),this[s]&&this[s](y)},d=function(){return p(e.chained?n:n.clone())},p=function(y){const _=Object.create(y,f);return Object.defineProperty(_,"baseMaterial",{value:n}),Object.defineProperty(_,"id",{value:qEe++}),_.uuid=$Ee(),_.uniforms=$m({},y.uniforms,e.uniforms),_.defines=$m({},y.defines,e.defines),_.defines[`TROIKA_DERIVED_MATERIAL_${i}`]="",_.extensions=$m({},y.extensions,e.extensions),_._listeners=void 0,_},f={constructor:{value:d},isDerivedMaterial:{value:!0},customProgramCacheKey:{writable:!0,configurable:!0,value:function(){return n.customProgramCacheKey()+"|"+i}},onBeforeCompile:{get(){return l},set(y){this[s]=y}},copy:{writable:!0,configurable:!0,value:function(y){return n.copy.call(this,y),!n.isShaderMaterial&&!n.isDerivedMaterial&&($m(this.extensions,y.extensions),$m(this.defines,y.defines),$m(this.uniforms,m6.clone(y.uniforms))),this}},clone:{writable:!0,configurable:!0,value:function(){const y=new n.constructor;return p(y).copy(this)}},getDepthMaterial:{writable:!0,configurable:!0,value:function(){let y=this._depthMaterial;return y||(y=this._depthMaterial=jR(n.isDerivedMaterial?n.getDepthMaterial():new HT({depthPacking:c6}),e),y.defines.IS_DEPTH_MATERIAL="",y.uniforms=this.uniforms),y}},getDistanceMaterial:{writable:!0,configurable:!0,value:function(){let y=this._distanceMaterial;return y||(y=this._distanceMaterial=jR(n.isDerivedMaterial?n.getDistanceMaterial():new jT,e),y.defines.IS_DISTANCE_MATERIAL="",y.uniforms=this.uniforms),y}},dispose:{writable:!0,configurable:!0,value(){const{_depthMaterial:y,_distanceMaterial:_}=this;y&&y.dispose(),_&&_.dispose(),n.dispose.call(this)}}};return o[i]=d,new d}function XEe(n,{vertexShader:e,fragmentShader:i},o,s){let{vertexDefs:l,vertexMainIntro:d,vertexMainOutro:p,vertexTransform:f,fragmentDefs:y,fragmentMainIntro:_,fragmentMainOutro:x,fragmentColorTransform:S,customRewriter:T,timeUniform:I}=o;if(l=l||"",d=d||"",p=p||"",y=y||"",_=_||"",x=x||"",(f||T)&&(e=HR(e)),(S||T)&&(i=i.replace(/^[ \t]*#include <((?:tonemapping|encodings|fog|premultiplied_alpha|dithering)_fragment)>/gm,`
//!BEGIN_POST_CHUNK $1
$&
//!END_POST_CHUNK
`),i=HR(i)),T){let R=T({vertexShader:e,fragmentShader:i});e=R.vertexShader,i=R.fragmentShader}if(S){let R=[];i=i.replace(/^\/\/!BEGIN_POST_CHUNK[^]+?^\/\/!END_POST_CHUNK/gm,D=>(R.push(D),"")),x=`${S}
${R.join(`
`)}
${x}`}if(I){const R=`
uniform float ${I};
`;l=R+l,y=R+y}return f&&(e=`vec3 troika_position_${s};
vec3 troika_normal_${s};
vec2 troika_uv_${s};
${e}
`,l=`${l}
void troikaVertexTransform${s}(inout vec3 position, inout vec3 normal, inout vec2 uv) {
  ${f}
}
`,d=`
troika_position_${s} = vec3(position);
troika_normal_${s} = vec3(normal);
troika_uv_${s} = vec2(uv);
troikaVertexTransform${s}(troika_position_${s}, troika_normal_${s}, troika_uv_${s});
${d}
`,e=e.replace(/\b(position|normal|uv)\b/g,(R,D,L,O)=>/\battribute\s+vec[23]\s+$/.test(O.substr(0,L))?D:`troika_${D}_${s}`),n.map&&n.map.channel>0||(e=e.replace(/\bMAP_UV\b/g,`troika_uv_${s}`))),e=pG(e,s,l,d,p),i=pG(i,s,y,_,x),{vertexShader:e,fragmentShader:i}}function pG(n,e,i,o,s){return(o||s||i)&&(n=n.replace(LK,`
${i}
void troikaOrigMain${e}() {`),n+=`
void main() {
  ${o}
  troikaOrigMain${e}();
  ${s}
}`),n}function ZEe(n,e){return n==="uniforms"?void 0:typeof e=="function"?e.toString():e}let KEe=0;const fG=new Map;function JEe(n){const e=JSON.stringify(n,ZEe);let i=fG.get(e);return i==null&&fG.set(e,i=++KEe),i}function QEe(n,e,i){const{defaultFontURL:o}=i,s=Object.create(null),l=1/0,d=/[\u00AD\u034F\u061C\u115F-\u1160\u17B4-\u17B5\u180B-\u180E\u200B-\u200F\u202A-\u202E\u2060-\u206F\u3164\uFE00-\uFE0F\uFEFF\uFFA0\uFFF0-\uFFF8]/,p="[^\\S\\u00A0]",f=new RegExp(`${p}|[\\-\\u007C\\u00AD\\u2010\\u2012-\\u2014\\u2027\\u2056\\u2E17\\u2E40]`);function y(O,N){function F(){const G=j=>{console.error(`Failure loading font ${O}${O===o?"":"; trying fallback"}`,j),O!==o&&(O=o,F())};try{const j=new XMLHttpRequest;j.open("get",O,!0),j.responseType="arraybuffer",j.onload=function(){if(j.status>=400)G(new Error(j.statusText));else if(j.status>0)try{const Y=n(j.response);N(Y)}catch(Y){G(Y)}},j.onerror=G,j.send()}catch(j){G(j)}}F()}function _(O,N){O||(O=o);let F=s[O];F?F.pending?F.pending.push(N):N(F):(s[O]={pending:[N]},y(O,G=>{let j=s[O].pending;s[O]=G,j.forEach(Y=>Y(G))}))}function x({text:O="",font:N=o,sdfGlyphSize:F=64,fontSize:G=1,letterSpacing:j=0,lineHeight:Y="normal",maxWidth:te=l,direction:V,textAlign:Q="left",textIndent:he=0,whiteSpace:fe="normal",overflowWrap:ye="normal",anchorX:pe=0,anchorY:Me=0,includeCaretPositions:Ie=!1,chunkedBoundsSize:ze=8192,colorRanges:le=null},me,xe=!1){const ae=R(),Ee={fontLoad:0,typesetting:0};O.indexOf("\r")>-1&&(console.info("Typesetter: got text with \\r chars; normalizing to \\n"),O=O.replace(/\r\n/g,`
`).replace(/\r/g,`
`)),G=+G,j=+j,te=+te,Y=Y||"normal",he=+he,_(N,Je=>{const Ze=isFinite(te);let Ke=null,Fe=null,ct=null,Ct=null,kt=null,Kt=null,At=null,Pe=0,ft=0,gt=fe!=="nowrap";const{ascender:_t,descender:Be,unitsPerEm:ue,lineGap:se,capHeight:_e,xHeight:je}=Je;Ee.fontLoad=R()-ae;const De=R(),st=G/ue;Y==="normal"&&(Y=(_t-Be+se)/ue),Y=Y*G;const de=(Y-(_t-Be)*st)/2,ne=-(_t*st+de),Oe=Math.min(Y,(_t-Be)*st),ut=(_t+Be)/2*st-Oe/2;let it=he,lt=new D;const Et=[lt];Je.forEachGlyph(O,G,j,(Ht,Dt,wt)=>{const Xt=O.charAt(wt),He=Ht.advanceWidth*st,Pt=lt.count;let qt;if("isEmpty"in Ht||(Ht.isWhitespace=!!Xt&&new RegExp(p).test(Xt),Ht.canBreakAfter=!!Xt&&f.test(Xt),Ht.isEmpty=Ht.xMin===Ht.xMax||Ht.yMin===Ht.yMax||d.test(Xt)),!Ht.isWhitespace&&!Ht.isEmpty&&ft++,gt&&Ze&&!Ht.isWhitespace&&Dt+He+it>te&&Pt){if(lt.glyphAt(Pt-1).glyphObj.canBreakAfter)qt=new D,it=-Dt;else for(let hn=Pt;hn--;)if(hn===0&&ye==="break-word"){qt=new D,it=-Dt;break}else if(lt.glyphAt(hn).glyphObj.canBreakAfter){qt=lt.splitAt(hn+1);const be=qt.glyphAt(0).x;it-=be;for(let Qe=qt.count;Qe--;)qt.glyphAt(Qe).x-=be;break}qt&&(lt.isSoftWrapped=!0,lt=qt,Et.push(lt),Pe=te)}let Nt=lt.glyphAt(lt.count);Nt.glyphObj=Ht,Nt.x=Dt+it,Nt.width=He,Nt.charIndex=wt,Xt===`
`&&(lt=new D,Et.push(lt),it=-(Dt+He+j*G)+he)}),Et.forEach(Ht=>{for(let Dt=Ht.count;Dt--;){let{glyphObj:wt,x:Xt,width:He}=Ht.glyphAt(Dt);if(!wt.isWhitespace){Ht.width=Xt+He,Ht.width>Pe&&(Pe=Ht.width);return}}});let Ut=0,Wt=0;if(pe&&(typeof pe=="number"?Ut=-pe:typeof pe=="string"&&(Ut=-Pe*(pe==="left"?0:pe==="center"?.5:pe==="right"?1:T(pe)))),Me){if(typeof Me=="number")Wt=-Me;else if(typeof Me=="string"){let Ht=Et.length*Y;Wt=Me==="top"?0:Me==="top-baseline"?-ne:Me==="top-cap"?-ne-_e*st:Me==="top-ex"?-ne-je*st:Me==="middle"?Ht/2:Me==="bottom"?Ht:Me==="bottom-baseline"?Ht-de+Be*st:T(Me)*Ht}}if(!xe){const Ht=e.getEmbeddingLevels(O,V);Ke=new Uint16Array(ft),Fe=new Float32Array(ft*2),ct={},Kt=[l,l,-l,-l],At=[];let Dt=ne;Ie&&(kt=new Float32Array(O.length*3)),le&&(Ct=new Uint8Array(ft*3));let wt=0,Xt=-1,He=-1,Pt,qt;if(Et.forEach((Nt,hn)=>{let{count:be,width:Qe}=Nt;if(be>0){let we=0;for(let ht=be;ht--&&Nt.glyphAt(ht).glyphObj.isWhitespace;)we++;let Te=0,Ne=0;if(Q==="center")Te=(Pe-Qe)/2;else if(Q==="right")Te=Pe-Qe;else if(Q==="justify"&&Nt.isSoftWrapped){let ht=0;for(let dt=be-we;dt--;)Nt.glyphAt(dt).glyphObj.isWhitespace&&ht++;Ne=(Pe-Qe)/ht}if(Ne||Te){let ht=0;for(let dt=0;dt<be;dt++){let Vt=Nt.glyphAt(dt);const It=Vt.glyphObj;Vt.x+=Te+ht,Ne!==0&&It.isWhitespace&&dt<be-we&&(ht+=Ne,Vt.width+=Ne)}}const et=e.getReorderSegments(O,Ht,Nt.glyphAt(0).charIndex,Nt.glyphAt(Nt.count-1).charIndex);for(let ht=0;ht<et.length;ht++){const[dt,Vt]=et[ht];let It=1/0,Qt=-1/0;for(let fn=0;fn<be;fn++)if(Nt.glyphAt(fn).charIndex>=dt){let en=fn,vn=fn;for(;vn<be;vn++){let Vn=Nt.glyphAt(vn);if(Vn.charIndex>Vt)break;vn<be-we&&(It=Math.min(It,Vn.x),Qt=Math.max(Qt,Vn.x+Vn.width))}for(let Vn=en;Vn<vn;Vn++){const ei=Nt.glyphAt(Vn);ei.x=Qt-(ei.x+ei.width-It)}break}}let tt;const vt=ht=>tt=ht;for(let ht=0;ht<be;ht++){let dt=Nt.glyphAt(ht);tt=dt.glyphObj;const Vt=tt.index,It=Ht.levels[dt.charIndex]&1;if(It){const Qt=e.getMirroredCharacter(O[dt.charIndex]);Qt&&Je.forEachGlyph(Qt,0,0,vt)}if(Ie){const{charIndex:Qt}=dt,fn=dt.x+Ut,en=dt.x+dt.width+Ut;kt[Qt*3]=It?en:fn,kt[Qt*3+1]=It?fn:en,kt[Qt*3+2]=Dt+ut+Wt;const vn=Qt-Xt;vn>1&&I(kt,Xt,vn),Xt=Qt}if(le){const{charIndex:Qt}=dt;for(;Qt>He;)He++,le.hasOwnProperty(He)&&(qt=le[He])}if(!tt.isWhitespace&&!tt.isEmpty){const Qt=wt++;ct[Vt]||(ct[Vt]={path:tt.path,pathBounds:[tt.xMin,tt.yMin,tt.xMax,tt.yMax]});const fn=dt.x+Ut,en=Dt+Wt;Fe[Qt*2]=fn,Fe[Qt*2+1]=en;const vn=fn+tt.xMin*st,Vn=en+tt.yMin*st,ei=fn+tt.xMax*st,xi=en+tt.yMax*st;vn<Kt[0]&&(Kt[0]=vn),Vn<Kt[1]&&(Kt[1]=Vn),ei>Kt[2]&&(Kt[2]=ei),xi>Kt[3]&&(Kt[3]=xi),Qt%ze===0&&(Pt={start:Qt,end:Qt,rect:[l,l,-l,-l]},At.push(Pt)),Pt.end++;const wi=Pt.rect;if(vn<wi[0]&&(wi[0]=vn),Vn<wi[1]&&(wi[1]=Vn),ei>wi[2]&&(wi[2]=ei),xi>wi[3]&&(wi[3]=xi),Ke[Qt]=Vt,le){const pa=Qt*3;Ct[pa]=qt>>16&255,Ct[pa+1]=qt>>8&255,Ct[pa+2]=qt&255}}}}Dt-=Y}),kt){const Nt=O.length-Xt;Nt>1&&I(kt,Xt,Nt)}}Ee.typesetting=R()-De,me({glyphIds:Ke,glyphPositions:Fe,glyphData:ct,caretPositions:kt,caretHeight:Oe,glyphColors:Ct,chunkedBounds:At,fontSize:G,unitsPerEm:ue,ascender:_t*st,descender:Be*st,capHeight:_e*st,xHeight:je*st,lineHeight:Y,topBaseline:ne,blockBounds:[Ut,Wt-Et.length*Y,Ut+Pe,Wt],visibleBounds:Kt,timings:Ee})})}function S(O,N){x(O,F=>{const[G,j,Y,te]=F.blockBounds;N({width:Y-G,height:te-j})},{metricsOnly:!0})}function T(O){let N=O.match(/^([\d.]+)%$/),F=N?parseFloat(N[1]):NaN;return isNaN(F)?0:F/100}function I(O,N,F){const G=O[N*3],j=O[N*3+1],Y=O[N*3+2],te=(j-G)/F;for(let V=0;V<F;V++){const Q=(N+V)*3;O[Q]=G+te*V,O[Q+1]=G+te*(V+1),O[Q+2]=Y}}function R(){return(self.performance||Date).now()}function D(){this.data=[]}const L=["glyphObj","x","width","charIndex"];return D.prototype={width:0,isSoftWrapped:!1,get count(){return Math.ceil(this.data.length/L.length)},glyphAt(O){let N=D.flyweight;return N.data=this.data,N.index=O,N},splitAt(O){let N=new D;return N.data=this.data.splice(O*L.length),N}},D.flyweight=L.reduce((O,N,F,G)=>(Object.defineProperty(O,N,{get(){return this.data[this.index*L.length+F]},set(j){this.data[this.index*L.length+F]=j}}),O),{data:null,index:0}),{typeset:x,measure:S,loadFont:_}}const Tg=()=>(self.performance||Date).now(),hC=IK();let mG;function eMe(n,e,i,o,s,l,d,p,f,y,_=!0){return _?nMe(n,e,i,o,s,l,d,p,f,y).then(null,x=>(mG||(console.warn("WebGL SDF generation failed, falling back to JS",x),mG=!0),yG(n,e,i,o,s,l,d,p,f,y))):yG(n,e,i,o,s,l,d,p,f,y)}const fE=[],tMe=5;let $R=0;function RK(){const n=Tg();for(;fE.length&&Tg()-n<tMe;)fE.shift()();$R=fE.length?setTimeout(RK,0):0}const nMe=(...n)=>new Promise((e,i)=>{fE.push(()=>{const o=Tg();try{hC.webgl.generateIntoCanvas(...n),e({timing:Tg()-o})}catch(s){i(s)}}),$R||($R=setTimeout(RK,0))}),iMe=4,aMe=2e3,gG={};let rMe=0;function yG(n,e,i,o,s,l,d,p,f,y){const _="TroikaTextSDFGenerator_JS_"+rMe++%iMe;let x=gG[_];return x||(x=gG[_]={workerModule:n2({name:_,workerId:_,dependencies:[IK,Tg],init(S,T){const I=S().javascript.generate;return function(...R){const D=T();return{textureData:I(...R),timing:T()-D}}},getTransferables(S){return[S.textureData.buffer]}}),requests:0,idleTimer:null}),x.requests++,clearTimeout(x.idleTimer),x.workerModule(n,e,i,o,s,l).then(({textureData:S,timing:T})=>{const I=Tg(),R=new Uint8Array(S.length*4);for(let D=0;D<S.length;D++)R[D*4+y]=S[D];return hC.webglUtils.renderImageData(d,R,p,f,n,e,1<<3-y),T+=Tg()-I,--x.requests===0&&(x.idleTimer=setTimeout(()=>{GEe(_)},aMe)),{timing:T}})}function oMe(n){n._warm||(hC.webgl.isSupported(n),n._warm=!0)}const sMe=hC.webglUtils.resizeWebGLCanvasWithoutClearing;/*!
Custom build of Typr.ts (https://github.com/fredli74/Typr.ts) for use in Troika text rendering.
Original MIT license applies: https://github.com/fredli74/Typr.ts/blob/master/LICENSE
*/function lMe(){return typeof window>"u"&&(self.window=self),function(n){var e={parse:function(s){var l=e._bin,d=new Uint8Array(s);if(l.readASCII(d,0,4)=="ttcf"){var p=4;l.readUshort(d,p),p+=2,l.readUshort(d,p),p+=2;var f=l.readUint(d,p);p+=4;for(var y=[],_=0;_<f;_++){var x=l.readUint(d,p);p+=4,y.push(e._readFont(d,x))}return y}return[e._readFont(d,0)]},_readFont:function(s,l){var d=e._bin,p=l;d.readFixed(s,l),l+=4;var f=d.readUshort(s,l);l+=2,d.readUshort(s,l),l+=2,d.readUshort(s,l),l+=2,d.readUshort(s,l),l+=2;for(var y=["cmap","head","hhea","maxp","hmtx","name","OS/2","post","loca","glyf","kern","CFF ","GPOS","GSUB","SVG "],_={_data:s,_offset:p},x={},S=0;S<f;S++){var T=d.readASCII(s,l,4);l+=4,d.readUint(s,l),l+=4;var I=d.readUint(s,l);l+=4;var R=d.readUint(s,l);l+=4,x[T]={offset:I,length:R}}for(S=0;S<y.length;S++){var D=y[S];x[D]&&(_[D.trim()]=e[D.trim()].parse(s,x[D].offset,x[D].length,_))}return _},_tabOffset:function(s,l,d){for(var p=e._bin,f=p.readUshort(s,d+4),y=d+12,_=0;_<f;_++){var x=p.readASCII(s,y,4);y+=4,p.readUint(s,y),y+=4;var S=p.readUint(s,y);if(y+=4,p.readUint(s,y),y+=4,x==l)return S}return 0}};e._bin={readFixed:function(s,l){return(s[l]<<8|s[l+1])+(s[l+2]<<8|s[l+3])/65540},readF2dot14:function(s,l){return e._bin.readShort(s,l)/16384},readInt:function(s,l){return e._bin._view(s).getInt32(l)},readInt8:function(s,l){return e._bin._view(s).getInt8(l)},readShort:function(s,l){return e._bin._view(s).getInt16(l)},readUshort:function(s,l){return e._bin._view(s).getUint16(l)},readUshorts:function(s,l,d){for(var p=[],f=0;f<d;f++)p.push(e._bin.readUshort(s,l+2*f));return p},readUint:function(s,l){return e._bin._view(s).getUint32(l)},readUint64:function(s,l){return 4294967296*e._bin.readUint(s,l)+e._bin.readUint(s,l+4)},readASCII:function(s,l,d){for(var p="",f=0;f<d;f++)p+=String.fromCharCode(s[l+f]);return p},readUnicode:function(s,l,d){for(var p="",f=0;f<d;f++){var y=s[l++]<<8|s[l++];p+=String.fromCharCode(y)}return p},_tdec:typeof window<"u"&&window.TextDecoder?new window.TextDecoder:null,readUTF8:function(s,l,d){var p=e._bin._tdec;return p&&l==0&&d==s.length?p.decode(s):e._bin.readASCII(s,l,d)},readBytes:function(s,l,d){for(var p=[],f=0;f<d;f++)p.push(s[l+f]);return p},readASCIIArray:function(s,l,d){for(var p=[],f=0;f<d;f++)p.push(String.fromCharCode(s[l+f]));return p},_view:function(s){return s._dataView||(s._dataView=s.buffer?new DataView(s.buffer,s.byteOffset,s.byteLength):new DataView(new Uint8Array(s).buffer))}},e._lctf={},e._lctf.parse=function(s,l,d,p,f){var y=e._bin,_={},x=l;y.readFixed(s,l),l+=4;var S=y.readUshort(s,l);l+=2;var T=y.readUshort(s,l);l+=2;var I=y.readUshort(s,l);return l+=2,_.scriptList=e._lctf.readScriptList(s,x+S),_.featureList=e._lctf.readFeatureList(s,x+T),_.lookupList=e._lctf.readLookupList(s,x+I,f),_},e._lctf.readLookupList=function(s,l,d){var p=e._bin,f=l,y=[],_=p.readUshort(s,l);l+=2;for(var x=0;x<_;x++){var S=p.readUshort(s,l);l+=2;var T=e._lctf.readLookupTable(s,f+S,d);y.push(T)}return y},e._lctf.readLookupTable=function(s,l,d){var p=e._bin,f=l,y={tabs:[]};y.ltype=p.readUshort(s,l),l+=2,y.flag=p.readUshort(s,l),l+=2;var _=p.readUshort(s,l);l+=2;for(var x=y.ltype,S=0;S<_;S++){var T=p.readUshort(s,l);l+=2;var I=d(s,x,f+T,y);y.tabs.push(I)}return y},e._lctf.numOfOnes=function(s){for(var l=0,d=0;d<32;d++)s>>>d&1&&l++;return l},e._lctf.readClassDef=function(s,l){var d=e._bin,p=[],f=d.readUshort(s,l);if(l+=2,f==1){var y=d.readUshort(s,l);l+=2;var _=d.readUshort(s,l);l+=2;for(var x=0;x<_;x++)p.push(y+x),p.push(y+x),p.push(d.readUshort(s,l)),l+=2}if(f==2){var S=d.readUshort(s,l);for(l+=2,x=0;x<S;x++)p.push(d.readUshort(s,l)),l+=2,p.push(d.readUshort(s,l)),l+=2,p.push(d.readUshort(s,l)),l+=2}return p},e._lctf.getInterval=function(s,l){for(var d=0;d<s.length;d+=3){var p=s[d],f=s[d+1];if(s[d+2],p<=l&&l<=f)return d}return-1},e._lctf.readCoverage=function(s,l){var d=e._bin,p={};p.fmt=d.readUshort(s,l),l+=2;var f=d.readUshort(s,l);return l+=2,p.fmt==1&&(p.tab=d.readUshorts(s,l,f)),p.fmt==2&&(p.tab=d.readUshorts(s,l,3*f)),p},e._lctf.coverageIndex=function(s,l){var d=s.tab;if(s.fmt==1)return d.indexOf(l);if(s.fmt==2){var p=e._lctf.getInterval(d,l);if(p!=-1)return d[p+2]+(l-d[p])}return-1},e._lctf.readFeatureList=function(s,l){var d=e._bin,p=l,f=[],y=d.readUshort(s,l);l+=2;for(var _=0;_<y;_++){var x=d.readASCII(s,l,4);l+=4;var S=d.readUshort(s,l);l+=2;var T=e._lctf.readFeatureTable(s,p+S);T.tag=x.trim(),f.push(T)}return f},e._lctf.readFeatureTable=function(s,l){var d=e._bin,p=l,f={},y=d.readUshort(s,l);l+=2,y>0&&(f.featureParams=p+y);var _=d.readUshort(s,l);l+=2,f.tab=[];for(var x=0;x<_;x++)f.tab.push(d.readUshort(s,l+2*x));return f},e._lctf.readScriptList=function(s,l){var d=e._bin,p=l,f={},y=d.readUshort(s,l);l+=2;for(var _=0;_<y;_++){var x=d.readASCII(s,l,4);l+=4;var S=d.readUshort(s,l);l+=2,f[x.trim()]=e._lctf.readScriptTable(s,p+S)}return f},e._lctf.readScriptTable=function(s,l){var d=e._bin,p=l,f={},y=d.readUshort(s,l);l+=2,f.default=e._lctf.readLangSysTable(s,p+y);var _=d.readUshort(s,l);l+=2;for(var x=0;x<_;x++){var S=d.readASCII(s,l,4);l+=4;var T=d.readUshort(s,l);l+=2,f[S.trim()]=e._lctf.readLangSysTable(s,p+T)}return f},e._lctf.readLangSysTable=function(s,l){var d=e._bin,p={};d.readUshort(s,l),l+=2,p.reqFeature=d.readUshort(s,l),l+=2;var f=d.readUshort(s,l);return l+=2,p.features=d.readUshorts(s,l,f),p},e.CFF={},e.CFF.parse=function(s,l,d){var p=e._bin;(s=new Uint8Array(s.buffer,l,d))[l=0],s[++l],s[++l],s[++l],l++;var f=[];l=e.CFF.readIndex(s,l,f);for(var y=[],_=0;_<f.length-1;_++)y.push(p.readASCII(s,l+f[_],f[_+1]-f[_]));l+=f[f.length-1];var x=[];l=e.CFF.readIndex(s,l,x);var S=[];for(_=0;_<x.length-1;_++)S.push(e.CFF.readDict(s,l+x[_],l+x[_+1]));l+=x[x.length-1];var T=S[0],I=[];l=e.CFF.readIndex(s,l,I);var R=[];for(_=0;_<I.length-1;_++)R.push(p.readASCII(s,l+I[_],I[_+1]-I[_]));if(l+=I[I.length-1],e.CFF.readSubrs(s,l,T),T.CharStrings){l=T.CharStrings,I=[],l=e.CFF.readIndex(s,l,I);var D=[];for(_=0;_<I.length-1;_++)D.push(p.readBytes(s,l+I[_],I[_+1]-I[_]));T.CharStrings=D}if(T.ROS){l=T.FDArray;var L=[];for(l=e.CFF.readIndex(s,l,L),T.FDArray=[],_=0;_<L.length-1;_++){var O=e.CFF.readDict(s,l+L[_],l+L[_+1]);e.CFF._readFDict(s,O,R),T.FDArray.push(O)}l+=L[L.length-1],l=T.FDSelect,T.FDSelect=[];var N=s[l];if(l++,N!=3)throw N;var F=p.readUshort(s,l);for(l+=2,_=0;_<F+1;_++)T.FDSelect.push(p.readUshort(s,l),s[l+2]),l+=3}return T.Encoding&&(T.Encoding=e.CFF.readEncoding(s,T.Encoding,T.CharStrings.length)),T.charset&&(T.charset=e.CFF.readCharset(s,T.charset,T.CharStrings.length)),e.CFF._readFDict(s,T,R),T},e.CFF._readFDict=function(s,l,d){var p;for(var f in l.Private&&(p=l.Private[1],l.Private=e.CFF.readDict(s,p,p+l.Private[0]),l.Private.Subrs&&e.CFF.readSubrs(s,p+l.Private.Subrs,l.Private)),l)["FamilyName","FontName","FullName","Notice","version","Copyright"].indexOf(f)!=-1&&(l[f]=d[l[f]-426+35])},e.CFF.readSubrs=function(s,l,d){var p=e._bin,f=[];l=e.CFF.readIndex(s,l,f);var y,_=f.length;y=_<1240?107:_<33900?1131:32768,d.Bias=y,d.Subrs=[];for(var x=0;x<f.length-1;x++)d.Subrs.push(p.readBytes(s,l+f[x],f[x+1]-f[x]))},e.CFF.tableSE=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,0,111,112,113,114,0,115,116,117,118,119,120,121,122,0,123,0,124,125,126,127,128,129,130,131,0,132,133,0,134,135,136,137,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,138,0,139,0,0,0,0,140,141,142,143,0,0,0,0,0,144,0,0,0,145,0,0,146,147,148,149,0,0,0,0],e.CFF.glyphByUnicode=function(s,l){for(var d=0;d<s.charset.length;d++)if(s.charset[d]==l)return d;return-1},e.CFF.glyphBySE=function(s,l){return l<0||l>255?-1:e.CFF.glyphByUnicode(s,e.CFF.tableSE[l])},e.CFF.readEncoding=function(s,l,d){e._bin;var p=[".notdef"],f=s[l];if(l++,f!=0)throw"error: unknown encoding format: "+f;var y=s[l];l++;for(var _=0;_<y;_++)p.push(s[l+_]);return p},e.CFF.readCharset=function(s,l,d){var p=e._bin,f=[".notdef"],y=s[l];if(l++,y==0)for(var _=0;_<d;_++){var x=p.readUshort(s,l);l+=2,f.push(x)}else{if(y!=1&&y!=2)throw"error: format: "+y;for(;f.length<d;){x=p.readUshort(s,l),l+=2;var S=0;for(y==1?(S=s[l],l++):(S=p.readUshort(s,l),l+=2),_=0;_<=S;_++)f.push(x),x++}}return f},e.CFF.readIndex=function(s,l,d){var p=e._bin,f=p.readUshort(s,l)+1,y=s[l+=2];if(l++,y==1)for(var _=0;_<f;_++)d.push(s[l+_]);else if(y==2)for(_=0;_<f;_++)d.push(p.readUshort(s,l+2*_));else if(y==3)for(_=0;_<f;_++)d.push(16777215&p.readUint(s,l+3*_-1));else if(f!=1)throw"unsupported offset size: "+y+", count: "+f;return(l+=f*y)-1},e.CFF.getCharString=function(s,l,d){var p=e._bin,f=s[l],y=s[l+1];s[l+2],s[l+3],s[l+4];var _=1,x=null,S=null;f<=20&&(x=f,_=1),f==12&&(x=100*f+y,_=2),21<=f&&f<=27&&(x=f,_=1),f==28&&(S=p.readShort(s,l+1),_=3),29<=f&&f<=31&&(x=f,_=1),32<=f&&f<=246&&(S=f-139,_=1),247<=f&&f<=250&&(S=256*(f-247)+y+108,_=2),251<=f&&f<=254&&(S=256*-(f-251)-y-108,_=2),f==255&&(S=p.readInt(s,l+1)/65535,_=5),d.val=S??"o"+x,d.size=_},e.CFF.readCharString=function(s,l,d){for(var p=l+d,f=e._bin,y=[];l<p;){var _=s[l],x=s[l+1];s[l+2],s[l+3],s[l+4];var S=1,T=null,I=null;_<=20&&(T=_,S=1),_==12&&(T=100*_+x,S=2),_!=19&&_!=20||(T=_,S=2),21<=_&&_<=27&&(T=_,S=1),_==28&&(I=f.readShort(s,l+1),S=3),29<=_&&_<=31&&(T=_,S=1),32<=_&&_<=246&&(I=_-139,S=1),247<=_&&_<=250&&(I=256*(_-247)+x+108,S=2),251<=_&&_<=254&&(I=256*-(_-251)-x-108,S=2),_==255&&(I=f.readInt(s,l+1)/65535,S=5),y.push(I??"o"+T),l+=S}return y},e.CFF.readDict=function(s,l,d){for(var p=e._bin,f={},y=[];l<d;){var _=s[l],x=s[l+1];s[l+2],s[l+3],s[l+4];var S=1,T=null,I=null;if(_==28&&(I=p.readShort(s,l+1),S=3),_==29&&(I=p.readInt(s,l+1),S=5),32<=_&&_<=246&&(I=_-139,S=1),247<=_&&_<=250&&(I=256*(_-247)+x+108,S=2),251<=_&&_<=254&&(I=256*-(_-251)-x-108,S=2),_==255)throw I=p.readInt(s,l+1)/65535,S=5,"unknown number";if(_==30){var R=[];for(S=1;;){var D=s[l+S];S++;var L=D>>4,O=15&D;if(L!=15&&R.push(L),O!=15&&R.push(O),O==15)break}for(var N="",F=[0,1,2,3,4,5,6,7,8,9,".","e","e-","reserved","-","endOfNumber"],G=0;G<R.length;G++)N+=F[R[G]];I=parseFloat(N)}_<=21&&(T=["version","Notice","FullName","FamilyName","Weight","FontBBox","BlueValues","OtherBlues","FamilyBlues","FamilyOtherBlues","StdHW","StdVW","escape","UniqueID","XUID","charset","Encoding","CharStrings","Private","Subrs","defaultWidthX","nominalWidthX"][_],S=1,_==12&&(T=["Copyright","isFixedPitch","ItalicAngle","UnderlinePosition","UnderlineThickness","PaintType","CharstringType","FontMatrix","StrokeWidth","BlueScale","BlueShift","BlueFuzz","StemSnapH","StemSnapV","ForceBold",0,0,"LanguageGroup","ExpansionFactor","initialRandomSeed","SyntheticBase","PostScript","BaseFontName","BaseFontBlend",0,0,0,0,0,0,"ROS","CIDFontVersion","CIDFontRevision","CIDFontType","CIDCount","UIDBase","FDArray","FDSelect","FontName"][x],S=2)),T!=null?(f[T]=y.length==1?y[0]:y,y=[]):y.push(I),l+=S}return f},e.cmap={},e.cmap.parse=function(s,l,d){s=new Uint8Array(s.buffer,l,d),l=0;var p=e._bin,f={};p.readUshort(s,l),l+=2;var y=p.readUshort(s,l);l+=2;var _=[];f.tables=[];for(var x=0;x<y;x++){var S=p.readUshort(s,l);l+=2;var T=p.readUshort(s,l);l+=2;var I=p.readUint(s,l);l+=4;var R="p"+S+"e"+T,D=_.indexOf(I);if(D==-1){var L;D=f.tables.length,_.push(I);var O=p.readUshort(s,I);O==0?L=e.cmap.parse0(s,I):O==4?L=e.cmap.parse4(s,I):O==6?L=e.cmap.parse6(s,I):O==12?L=e.cmap.parse12(s,I):console.debug("unknown format: "+O,S,T,I),f.tables.push(L)}if(f[R]!=null)throw"multiple tables for one platform+encoding";f[R]=D}return f},e.cmap.parse0=function(s,l){var d=e._bin,p={};p.format=d.readUshort(s,l),l+=2;var f=d.readUshort(s,l);l+=2,d.readUshort(s,l),l+=2,p.map=[];for(var y=0;y<f-6;y++)p.map.push(s[l+y]);return p},e.cmap.parse4=function(s,l){var d=e._bin,p=l,f={};f.format=d.readUshort(s,l),l+=2;var y=d.readUshort(s,l);l+=2,d.readUshort(s,l),l+=2;var _=d.readUshort(s,l);l+=2;var x=_/2;f.searchRange=d.readUshort(s,l),l+=2,f.entrySelector=d.readUshort(s,l),l+=2,f.rangeShift=d.readUshort(s,l),l+=2,f.endCount=d.readUshorts(s,l,x),l+=2*x,l+=2,f.startCount=d.readUshorts(s,l,x),l+=2*x,f.idDelta=[];for(var S=0;S<x;S++)f.idDelta.push(d.readShort(s,l)),l+=2;for(f.idRangeOffset=d.readUshorts(s,l,x),l+=2*x,f.glyphIdArray=[];l<p+y;)f.glyphIdArray.push(d.readUshort(s,l)),l+=2;return f},e.cmap.parse6=function(s,l){var d=e._bin,p={};p.format=d.readUshort(s,l),l+=2,d.readUshort(s,l),l+=2,d.readUshort(s,l),l+=2,p.firstCode=d.readUshort(s,l),l+=2;var f=d.readUshort(s,l);l+=2,p.glyphIdArray=[];for(var y=0;y<f;y++)p.glyphIdArray.push(d.readUshort(s,l)),l+=2;return p},e.cmap.parse12=function(s,l){var d=e._bin,p={};p.format=d.readUshort(s,l),l+=2,l+=2,d.readUint(s,l),l+=4,d.readUint(s,l),l+=4;var f=d.readUint(s,l);l+=4,p.groups=[];for(var y=0;y<f;y++){var _=l+12*y,x=d.readUint(s,_+0),S=d.readUint(s,_+4),T=d.readUint(s,_+8);p.groups.push([x,S,T])}return p},e.glyf={},e.glyf.parse=function(s,l,d,p){for(var f=[],y=0;y<p.maxp.numGlyphs;y++)f.push(null);return f},e.glyf._parseGlyf=function(s,l){var d=e._bin,p=s._data,f=e._tabOffset(p,"glyf",s._offset)+s.loca[l];if(s.loca[l]==s.loca[l+1])return null;var y={};if(y.noc=d.readShort(p,f),f+=2,y.xMin=d.readShort(p,f),f+=2,y.yMin=d.readShort(p,f),f+=2,y.xMax=d.readShort(p,f),f+=2,y.yMax=d.readShort(p,f),f+=2,y.xMin>=y.xMax||y.yMin>=y.yMax)return null;if(y.noc>0){y.endPts=[];for(var _=0;_<y.noc;_++)y.endPts.push(d.readUshort(p,f)),f+=2;var x=d.readUshort(p,f);if(f+=2,p.length-f<x)return null;y.instructions=d.readBytes(p,f,x),f+=x;var S=y.endPts[y.noc-1]+1;for(y.flags=[],_=0;_<S;_++){var T=p[f];if(f++,y.flags.push(T),(8&T)!=0){var I=p[f];f++;for(var R=0;R<I;R++)y.flags.push(T),_++}}for(y.xs=[],_=0;_<S;_++){var D=(2&y.flags[_])!=0,L=(16&y.flags[_])!=0;D?(y.xs.push(L?p[f]:-p[f]),f++):L?y.xs.push(0):(y.xs.push(d.readShort(p,f)),f+=2)}for(y.ys=[],_=0;_<S;_++)D=(4&y.flags[_])!=0,L=(32&y.flags[_])!=0,D?(y.ys.push(L?p[f]:-p[f]),f++):L?y.ys.push(0):(y.ys.push(d.readShort(p,f)),f+=2);var O=0,N=0;for(_=0;_<S;_++)O+=y.xs[_],N+=y.ys[_],y.xs[_]=O,y.ys[_]=N}else{var F;y.parts=[];do{F=d.readUshort(p,f),f+=2;var G={m:{a:1,b:0,c:0,d:1,tx:0,ty:0},p1:-1,p2:-1};if(y.parts.push(G),G.glyphIndex=d.readUshort(p,f),f+=2,1&F){var j=d.readShort(p,f);f+=2;var Y=d.readShort(p,f);f+=2}else j=d.readInt8(p,f),f++,Y=d.readInt8(p,f),f++;2&F?(G.m.tx=j,G.m.ty=Y):(G.p1=j,G.p2=Y),8&F?(G.m.a=G.m.d=d.readF2dot14(p,f),f+=2):64&F?(G.m.a=d.readF2dot14(p,f),f+=2,G.m.d=d.readF2dot14(p,f),f+=2):128&F&&(G.m.a=d.readF2dot14(p,f),f+=2,G.m.b=d.readF2dot14(p,f),f+=2,G.m.c=d.readF2dot14(p,f),f+=2,G.m.d=d.readF2dot14(p,f),f+=2)}while(32&F);if(256&F){var te=d.readUshort(p,f);for(f+=2,y.instr=[],_=0;_<te;_++)y.instr.push(p[f]),f++}}return y},e.GPOS={},e.GPOS.parse=function(s,l,d,p){return e._lctf.parse(s,l,d,p,e.GPOS.subt)},e.GPOS.subt=function(s,l,d,p){var f=e._bin,y=d,_={};if(_.fmt=f.readUshort(s,d),d+=2,l==1||l==2||l==3||l==7||l==8&&_.fmt<=2){var x=f.readUshort(s,d);d+=2,_.coverage=e._lctf.readCoverage(s,x+y)}if(l==1&&_.fmt==1){var S=f.readUshort(s,d);d+=2;var T=e._lctf.numOfOnes(S);S!=0&&(_.pos=e.GPOS.readValueRecord(s,d,S))}else if(l==2&&_.fmt>=1&&_.fmt<=2){S=f.readUshort(s,d),d+=2;var I=f.readUshort(s,d);d+=2,T=e._lctf.numOfOnes(S);var R=e._lctf.numOfOnes(I);if(_.fmt==1){_.pairsets=[];var D=f.readUshort(s,d);d+=2;for(var L=0;L<D;L++){var O=y+f.readUshort(s,d);d+=2;var N=f.readUshort(s,O);O+=2;for(var F=[],G=0;G<N;G++){var j=f.readUshort(s,O);O+=2,S!=0&&(fe=e.GPOS.readValueRecord(s,O,S),O+=2*T),I!=0&&(ye=e.GPOS.readValueRecord(s,O,I),O+=2*R),F.push({gid2:j,val1:fe,val2:ye})}_.pairsets.push(F)}}if(_.fmt==2){var Y=f.readUshort(s,d);d+=2;var te=f.readUshort(s,d);d+=2;var V=f.readUshort(s,d);d+=2;var Q=f.readUshort(s,d);for(d+=2,_.classDef1=e._lctf.readClassDef(s,y+Y),_.classDef2=e._lctf.readClassDef(s,y+te),_.matrix=[],L=0;L<V;L++){var he=[];for(G=0;G<Q;G++){var fe=null,ye=null;S!=0&&(fe=e.GPOS.readValueRecord(s,d,S),d+=2*T),I!=0&&(ye=e.GPOS.readValueRecord(s,d,I),d+=2*R),he.push({val1:fe,val2:ye})}_.matrix.push(he)}}}else{if(l==9&&_.fmt==1){var pe=f.readUshort(s,d);d+=2;var Me=f.readUint(s,d);if(d+=4,p.ltype==9)p.ltype=pe;else if(p.ltype!=pe)throw"invalid extension substitution";return e.GPOS.subt(s,p.ltype,y+Me)}console.debug("unsupported GPOS table LookupType",l,"format",_.fmt)}return _},e.GPOS.readValueRecord=function(s,l,d){var p=e._bin,f=[];return f.push(1&d?p.readShort(s,l):0),l+=1&d?2:0,f.push(2&d?p.readShort(s,l):0),l+=2&d?2:0,f.push(4&d?p.readShort(s,l):0),l+=4&d?2:0,f.push(8&d?p.readShort(s,l):0),l+=8&d?2:0,f},e.GSUB={},e.GSUB.parse=function(s,l,d,p){return e._lctf.parse(s,l,d,p,e.GSUB.subt)},e.GSUB.subt=function(s,l,d,p){var f=e._bin,y=d,_={};if(_.fmt=f.readUshort(s,d),d+=2,l!=1&&l!=4&&l!=5&&l!=6)return null;if(l==1||l==4||l==5&&_.fmt<=2||l==6&&_.fmt<=2){var x=f.readUshort(s,d);d+=2,_.coverage=e._lctf.readCoverage(s,y+x)}if(l==1&&_.fmt>=1&&_.fmt<=2){if(_.fmt==1)_.delta=f.readShort(s,d),d+=2;else if(_.fmt==2){var S=f.readUshort(s,d);d+=2,_.newg=f.readUshorts(s,d,S),d+=2*_.newg.length}}else if(l==4){_.vals=[],S=f.readUshort(s,d),d+=2;for(var T=0;T<S;T++){var I=f.readUshort(s,d);d+=2,_.vals.push(e.GSUB.readLigatureSet(s,y+I))}}else if(l==5&&_.fmt==2){if(_.fmt==2){var R=f.readUshort(s,d);d+=2,_.cDef=e._lctf.readClassDef(s,y+R),_.scset=[];var D=f.readUshort(s,d);for(d+=2,T=0;T<D;T++){var L=f.readUshort(s,d);d+=2,_.scset.push(L==0?null:e.GSUB.readSubClassSet(s,y+L))}}}else if(l==6&&_.fmt==3){if(_.fmt==3){for(T=0;T<3;T++){S=f.readUshort(s,d),d+=2;for(var O=[],N=0;N<S;N++)O.push(e._lctf.readCoverage(s,y+f.readUshort(s,d+2*N)));d+=2*S,T==0&&(_.backCvg=O),T==1&&(_.inptCvg=O),T==2&&(_.ahedCvg=O)}S=f.readUshort(s,d),d+=2,_.lookupRec=e.GSUB.readSubstLookupRecords(s,d,S)}}else{if(l==7&&_.fmt==1){var F=f.readUshort(s,d);d+=2;var G=f.readUint(s,d);if(d+=4,p.ltype==9)p.ltype=F;else if(p.ltype!=F)throw"invalid extension substitution";return e.GSUB.subt(s,p.ltype,y+G)}console.debug("unsupported GSUB table LookupType",l,"format",_.fmt)}return _},e.GSUB.readSubClassSet=function(s,l){var d=e._bin.readUshort,p=l,f=[],y=d(s,l);l+=2;for(var _=0;_<y;_++){var x=d(s,l);l+=2,f.push(e.GSUB.readSubClassRule(s,p+x))}return f},e.GSUB.readSubClassRule=function(s,l){var d=e._bin.readUshort,p={},f=d(s,l),y=d(s,l+=2);l+=2,p.input=[];for(var _=0;_<f-1;_++)p.input.push(d(s,l)),l+=2;return p.substLookupRecords=e.GSUB.readSubstLookupRecords(s,l,y),p},e.GSUB.readSubstLookupRecords=function(s,l,d){for(var p=e._bin.readUshort,f=[],y=0;y<d;y++)f.push(p(s,l),p(s,l+2)),l+=4;return f},e.GSUB.readChainSubClassSet=function(s,l){var d=e._bin,p=l,f=[],y=d.readUshort(s,l);l+=2;for(var _=0;_<y;_++){var x=d.readUshort(s,l);l+=2,f.push(e.GSUB.readChainSubClassRule(s,p+x))}return f},e.GSUB.readChainSubClassRule=function(s,l){for(var d=e._bin,p={},f=["backtrack","input","lookahead"],y=0;y<f.length;y++){var _=d.readUshort(s,l);l+=2,y==1&&_--,p[f[y]]=d.readUshorts(s,l,_),l+=2*p[f[y]].length}return _=d.readUshort(s,l),l+=2,p.subst=d.readUshorts(s,l,2*_),l+=2*p.subst.length,p},e.GSUB.readLigatureSet=function(s,l){var d=e._bin,p=l,f=[],y=d.readUshort(s,l);l+=2;for(var _=0;_<y;_++){var x=d.readUshort(s,l);l+=2,f.push(e.GSUB.readLigature(s,p+x))}return f},e.GSUB.readLigature=function(s,l){var d=e._bin,p={chain:[]};p.nglyph=d.readUshort(s,l),l+=2;var f=d.readUshort(s,l);l+=2;for(var y=0;y<f-1;y++)p.chain.push(d.readUshort(s,l)),l+=2;return p},e.head={},e.head.parse=function(s,l,d){var p=e._bin,f={};return p.readFixed(s,l),l+=4,f.fontRevision=p.readFixed(s,l),l+=4,p.readUint(s,l),l+=4,p.readUint(s,l),l+=4,f.flags=p.readUshort(s,l),l+=2,f.unitsPerEm=p.readUshort(s,l),l+=2,f.created=p.readUint64(s,l),l+=8,f.modified=p.readUint64(s,l),l+=8,f.xMin=p.readShort(s,l),l+=2,f.yMin=p.readShort(s,l),l+=2,f.xMax=p.readShort(s,l),l+=2,f.yMax=p.readShort(s,l),l+=2,f.macStyle=p.readUshort(s,l),l+=2,f.lowestRecPPEM=p.readUshort(s,l),l+=2,f.fontDirectionHint=p.readShort(s,l),l+=2,f.indexToLocFormat=p.readShort(s,l),l+=2,f.glyphDataFormat=p.readShort(s,l),l+=2,f},e.hhea={},e.hhea.parse=function(s,l,d){var p=e._bin,f={};return p.readFixed(s,l),l+=4,f.ascender=p.readShort(s,l),l+=2,f.descender=p.readShort(s,l),l+=2,f.lineGap=p.readShort(s,l),l+=2,f.advanceWidthMax=p.readUshort(s,l),l+=2,f.minLeftSideBearing=p.readShort(s,l),l+=2,f.minRightSideBearing=p.readShort(s,l),l+=2,f.xMaxExtent=p.readShort(s,l),l+=2,f.caretSlopeRise=p.readShort(s,l),l+=2,f.caretSlopeRun=p.readShort(s,l),l+=2,f.caretOffset=p.readShort(s,l),l+=2,l+=8,f.metricDataFormat=p.readShort(s,l),l+=2,f.numberOfHMetrics=p.readUshort(s,l),l+=2,f},e.hmtx={},e.hmtx.parse=function(s,l,d,p){for(var f=e._bin,y={aWidth:[],lsBearing:[]},_=0,x=0,S=0;S<p.maxp.numGlyphs;S++)S<p.hhea.numberOfHMetrics&&(_=f.readUshort(s,l),l+=2,x=f.readShort(s,l),l+=2),y.aWidth.push(_),y.lsBearing.push(x);return y},e.kern={},e.kern.parse=function(s,l,d,p){var f=e._bin,y=f.readUshort(s,l);if(l+=2,y==1)return e.kern.parseV1(s,l-2,d,p);var _=f.readUshort(s,l);l+=2;for(var x={glyph1:[],rval:[]},S=0;S<_;S++){l+=2,d=f.readUshort(s,l),l+=2;var T=f.readUshort(s,l);l+=2;var I=T>>>8;if((I&=15)!=0)throw"unknown kern table format: "+I;l=e.kern.readFormat0(s,l,x)}return x},e.kern.parseV1=function(s,l,d,p){var f=e._bin;f.readFixed(s,l),l+=4;var y=f.readUint(s,l);l+=4;for(var _={glyph1:[],rval:[]},x=0;x<y;x++){f.readUint(s,l),l+=4;var S=f.readUshort(s,l);l+=2,f.readUshort(s,l),l+=2;var T=S>>>8;if((T&=15)!=0)throw"unknown kern table format: "+T;l=e.kern.readFormat0(s,l,_)}return _},e.kern.readFormat0=function(s,l,d){var p=e._bin,f=-1,y=p.readUshort(s,l);l+=2,p.readUshort(s,l),l+=2,p.readUshort(s,l),l+=2,p.readUshort(s,l),l+=2;for(var _=0;_<y;_++){var x=p.readUshort(s,l);l+=2;var S=p.readUshort(s,l);l+=2;var T=p.readShort(s,l);l+=2,x!=f&&(d.glyph1.push(x),d.rval.push({glyph2:[],vals:[]}));var I=d.rval[d.rval.length-1];I.glyph2.push(S),I.vals.push(T),f=x}return l},e.loca={},e.loca.parse=function(s,l,d,p){var f=e._bin,y=[],_=p.head.indexToLocFormat,x=p.maxp.numGlyphs+1;if(_==0)for(var S=0;S<x;S++)y.push(f.readUshort(s,l+(S<<1))<<1);if(_==1)for(S=0;S<x;S++)y.push(f.readUint(s,l+(S<<2)));return y},e.maxp={},e.maxp.parse=function(s,l,d){var p=e._bin,f={},y=p.readUint(s,l);return l+=4,f.numGlyphs=p.readUshort(s,l),l+=2,y==65536&&(f.maxPoints=p.readUshort(s,l),l+=2,f.maxContours=p.readUshort(s,l),l+=2,f.maxCompositePoints=p.readUshort(s,l),l+=2,f.maxCompositeContours=p.readUshort(s,l),l+=2,f.maxZones=p.readUshort(s,l),l+=2,f.maxTwilightPoints=p.readUshort(s,l),l+=2,f.maxStorage=p.readUshort(s,l),l+=2,f.maxFunctionDefs=p.readUshort(s,l),l+=2,f.maxInstructionDefs=p.readUshort(s,l),l+=2,f.maxStackElements=p.readUshort(s,l),l+=2,f.maxSizeOfInstructions=p.readUshort(s,l),l+=2,f.maxComponentElements=p.readUshort(s,l),l+=2,f.maxComponentDepth=p.readUshort(s,l),l+=2),f},e.name={},e.name.parse=function(s,l,d){var p=e._bin,f={};p.readUshort(s,l),l+=2;var y=p.readUshort(s,l);l+=2,p.readUshort(s,l);for(var _,x=["copyright","fontFamily","fontSubfamily","ID","fullName","version","postScriptName","trademark","manufacturer","designer","description","urlVendor","urlDesigner","licence","licenceURL","---","typoFamilyName","typoSubfamilyName","compatibleFull","sampleText","postScriptCID","wwsFamilyName","wwsSubfamilyName","lightPalette","darkPalette"],S=l+=2,T=0;T<y;T++){var I=p.readUshort(s,l);l+=2;var R=p.readUshort(s,l);l+=2;var D=p.readUshort(s,l);l+=2;var L=p.readUshort(s,l);l+=2;var O=p.readUshort(s,l);l+=2;var N=p.readUshort(s,l);l+=2;var F,G=x[L],j=S+12*y+N;if(I==0)F=p.readUnicode(s,j,O/2);else if(I==3&&R==0)F=p.readUnicode(s,j,O/2);else if(R==0)F=p.readASCII(s,j,O);else if(R==1)F=p.readUnicode(s,j,O/2);else if(R==3)F=p.readUnicode(s,j,O/2);else{if(I!=1)throw"unknown encoding "+R+", platformID: "+I;F=p.readASCII(s,j,O),console.debug("reading unknown MAC encoding "+R+" as ASCII")}var Y="p"+I+","+D.toString(16);f[Y]==null&&(f[Y]={}),f[Y][G!==void 0?G:L]=F,f[Y]._lang=D}for(var te in f)if(f[te].postScriptName!=null&&f[te]._lang==1033)return f[te];for(var te in f)if(f[te].postScriptName!=null&&f[te]._lang==0)return f[te];for(var te in f)if(f[te].postScriptName!=null&&f[te]._lang==3084)return f[te];for(var te in f)if(f[te].postScriptName!=null)return f[te];for(var te in f){_=te;break}return console.debug("returning name table with languageID "+f[_]._lang),f[_]},e["OS/2"]={},e["OS/2"].parse=function(s,l,d){var p=e._bin.readUshort(s,l);l+=2;var f={};if(p==0)e["OS/2"].version0(s,l,f);else if(p==1)e["OS/2"].version1(s,l,f);else if(p==2||p==3||p==4)e["OS/2"].version2(s,l,f);else{if(p!=5)throw"unknown OS/2 table version: "+p;e["OS/2"].version5(s,l,f)}return f},e["OS/2"].version0=function(s,l,d){var p=e._bin;return d.xAvgCharWidth=p.readShort(s,l),l+=2,d.usWeightClass=p.readUshort(s,l),l+=2,d.usWidthClass=p.readUshort(s,l),l+=2,d.fsType=p.readUshort(s,l),l+=2,d.ySubscriptXSize=p.readShort(s,l),l+=2,d.ySubscriptYSize=p.readShort(s,l),l+=2,d.ySubscriptXOffset=p.readShort(s,l),l+=2,d.ySubscriptYOffset=p.readShort(s,l),l+=2,d.ySuperscriptXSize=p.readShort(s,l),l+=2,d.ySuperscriptYSize=p.readShort(s,l),l+=2,d.ySuperscriptXOffset=p.readShort(s,l),l+=2,d.ySuperscriptYOffset=p.readShort(s,l),l+=2,d.yStrikeoutSize=p.readShort(s,l),l+=2,d.yStrikeoutPosition=p.readShort(s,l),l+=2,d.sFamilyClass=p.readShort(s,l),l+=2,d.panose=p.readBytes(s,l,10),l+=10,d.ulUnicodeRange1=p.readUint(s,l),l+=4,d.ulUnicodeRange2=p.readUint(s,l),l+=4,d.ulUnicodeRange3=p.readUint(s,l),l+=4,d.ulUnicodeRange4=p.readUint(s,l),l+=4,d.achVendID=[p.readInt8(s,l),p.readInt8(s,l+1),p.readInt8(s,l+2),p.readInt8(s,l+3)],l+=4,d.fsSelection=p.readUshort(s,l),l+=2,d.usFirstCharIndex=p.readUshort(s,l),l+=2,d.usLastCharIndex=p.readUshort(s,l),l+=2,d.sTypoAscender=p.readShort(s,l),l+=2,d.sTypoDescender=p.readShort(s,l),l+=2,d.sTypoLineGap=p.readShort(s,l),l+=2,d.usWinAscent=p.readUshort(s,l),l+=2,d.usWinDescent=p.readUshort(s,l),l+=2},e["OS/2"].version1=function(s,l,d){var p=e._bin;return l=e["OS/2"].version0(s,l,d),d.ulCodePageRange1=p.readUint(s,l),l+=4,d.ulCodePageRange2=p.readUint(s,l),l+=4},e["OS/2"].version2=function(s,l,d){var p=e._bin;return l=e["OS/2"].version1(s,l,d),d.sxHeight=p.readShort(s,l),l+=2,d.sCapHeight=p.readShort(s,l),l+=2,d.usDefault=p.readUshort(s,l),l+=2,d.usBreak=p.readUshort(s,l),l+=2,d.usMaxContext=p.readUshort(s,l),l+=2},e["OS/2"].version5=function(s,l,d){var p=e._bin;return l=e["OS/2"].version2(s,l,d),d.usLowerOpticalPointSize=p.readUshort(s,l),l+=2,d.usUpperOpticalPointSize=p.readUshort(s,l),l+=2},e.post={},e.post.parse=function(s,l,d){var p=e._bin,f={};return f.version=p.readFixed(s,l),l+=4,f.italicAngle=p.readFixed(s,l),l+=4,f.underlinePosition=p.readShort(s,l),l+=2,f.underlineThickness=p.readShort(s,l),l+=2,f},e==null&&(e={}),e.U==null&&(e.U={}),e.U.codeToGlyph=function(s,l){var d=s.cmap,p=-1;if(d.p0e4!=null?p=d.p0e4:d.p3e1!=null?p=d.p3e1:d.p1e0!=null?p=d.p1e0:d.p0e3!=null&&(p=d.p0e3),p==-1)throw"no familiar platform and encoding!";var f=d.tables[p];if(f.format==0)return l>=f.map.length?0:f.map[l];if(f.format==4){for(var y=-1,_=0;_<f.endCount.length;_++)if(l<=f.endCount[_]){y=_;break}return y==-1||f.startCount[y]>l?0:65535&(f.idRangeOffset[y]!=0?f.glyphIdArray[l-f.startCount[y]+(f.idRangeOffset[y]>>1)-(f.idRangeOffset.length-y)]:l+f.idDelta[y])}if(f.format==12){if(l>f.groups[f.groups.length-1][1])return 0;for(_=0;_<f.groups.length;_++){var x=f.groups[_];if(x[0]<=l&&l<=x[1])return x[2]+(l-x[0])}return 0}throw"unknown cmap table format "+f.format},e.U.glyphToPath=function(s,l){var d={cmds:[],crds:[]};if(s.SVG&&s.SVG.entries[l]){var p=s.SVG.entries[l];return p==null?d:(typeof p=="string"&&(p=e.SVG.toPath(p),s.SVG.entries[l]=p),p)}if(s.CFF){var f={x:0,y:0,stack:[],nStems:0,haveWidth:!1,width:s.CFF.Private?s.CFF.Private.defaultWidthX:0,open:!1},y=s.CFF,_=s.CFF.Private;if(y.ROS){for(var x=0;y.FDSelect[x+2]<=l;)x+=2;_=y.FDArray[y.FDSelect[x+1]].Private}e.U._drawCFF(s.CFF.CharStrings[l],f,y,_,d)}else s.glyf&&e.U._drawGlyf(l,s,d);return d},e.U._drawGlyf=function(s,l,d){var p=l.glyf[s];p==null&&(p=l.glyf[s]=e.glyf._parseGlyf(l,s)),p!=null&&(p.noc>-1?e.U._simpleGlyph(p,d):e.U._compoGlyph(p,l,d))},e.U._simpleGlyph=function(s,l){for(var d=0;d<s.noc;d++){for(var p=d==0?0:s.endPts[d-1]+1,f=s.endPts[d],y=p;y<=f;y++){var _=y==p?f:y-1,x=y==f?p:y+1,S=1&s.flags[y],T=1&s.flags[_],I=1&s.flags[x],R=s.xs[y],D=s.ys[y];if(y==p)if(S){if(!T){e.U.P.moveTo(l,R,D);continue}e.U.P.moveTo(l,s.xs[_],s.ys[_])}else T?e.U.P.moveTo(l,s.xs[_],s.ys[_]):e.U.P.moveTo(l,(s.xs[_]+R)/2,(s.ys[_]+D)/2);S?T&&e.U.P.lineTo(l,R,D):I?e.U.P.qcurveTo(l,R,D,s.xs[x],s.ys[x]):e.U.P.qcurveTo(l,R,D,(R+s.xs[x])/2,(D+s.ys[x])/2)}e.U.P.closePath(l)}},e.U._compoGlyph=function(s,l,d){for(var p=0;p<s.parts.length;p++){var f={cmds:[],crds:[]},y=s.parts[p];e.U._drawGlyf(y.glyphIndex,l,f);for(var _=y.m,x=0;x<f.crds.length;x+=2){var S=f.crds[x],T=f.crds[x+1];d.crds.push(S*_.a+T*_.b+_.tx),d.crds.push(S*_.c+T*_.d+_.ty)}for(x=0;x<f.cmds.length;x++)d.cmds.push(f.cmds[x])}},e.U._getGlyphClass=function(s,l){var d=e._lctf.getInterval(l,s);return d==-1?0:l[d+2]},e.U.getPairAdjustment=function(s,l,d){var p=!1;if(s.GPOS)for(var f=s.GPOS,y=f.lookupList,_=f.featureList,x=[],S=0;S<_.length;S++){var T=_[S];if(T.tag=="kern"){p=!0;for(var I=0;I<T.tab.length;I++)if(!x[T.tab[I]]){x[T.tab[I]]=!0;for(var R=y[T.tab[I]],D=0;D<R.tabs.length;D++)if(R.tabs[D]!=null){var L,O=R.tabs[D];if((!O.coverage||(L=e._lctf.coverageIndex(O.coverage,l))!=-1)&&R.ltype!=1){if(R.ltype==2){var N=null;if(O.fmt==1){var F=O.pairsets[L];for(S=0;S<F.length;S++)F[S].gid2==d&&(N=F[S])}else if(O.fmt==2){var G=e.U._getGlyphClass(l,O.classDef1),j=e.U._getGlyphClass(d,O.classDef2);N=O.matrix[G][j]}if(N){var Y=0;return N.val1&&N.val1[2]&&(Y+=N.val1[2]),N.val2&&N.val2[0]&&(Y+=N.val2[0]),Y}}}}}}}if(s.kern&&!p){var te=s.kern.glyph1.indexOf(l);if(te!=-1){var V=s.kern.rval[te].glyph2.indexOf(d);if(V!=-1)return s.kern.rval[te].vals[V]}}return 0},e.U._applySubs=function(s,l,d,p){for(var f=s.length-l-1,y=0;y<d.tabs.length;y++)if(d.tabs[y]!=null){var _,x=d.tabs[y];if(!x.coverage||(_=e._lctf.coverageIndex(x.coverage,s[l]))!=-1){if(d.ltype==1)s[l],x.fmt==1?s[l]=s[l]+x.delta:s[l]=x.newg[_];else if(d.ltype==4)for(var S=x.vals[_],T=0;T<S.length;T++){var I=S[T],R=I.chain.length;if(!(R>f)){for(var D=!0,L=0,O=0;O<R;O++){for(;s[l+L+(1+O)]==-1;)L++;I.chain[O]!=s[l+L+(1+O)]&&(D=!1)}if(D){for(s[l]=I.nglyph,O=0;O<R+L;O++)s[l+O+1]=-1;break}}}else if(d.ltype==5&&x.fmt==2)for(var N=e._lctf.getInterval(x.cDef,s[l]),F=x.cDef[N+2],G=x.scset[F],j=0;j<G.length;j++){var Y=G[j],te=Y.input;if(!(te.length>f)){for(D=!0,O=0;O<te.length;O++){var V=e._lctf.getInterval(x.cDef,s[l+1+O]);if(N==-1&&x.cDef[V+2]!=te[O]){D=!1;break}}if(D){var Q=Y.substLookupRecords;for(T=0;T<Q.length;T+=2)Q[T],Q[T+1]}}}else if(d.ltype==6&&x.fmt==3){if(!e.U._glsCovered(s,x.backCvg,l-x.backCvg.length)||!e.U._glsCovered(s,x.inptCvg,l)||!e.U._glsCovered(s,x.ahedCvg,l+x.inptCvg.length))continue;var he=x.lookupRec;for(j=0;j<he.length;j+=2){N=he[j];var fe=p[he[j+1]];e.U._applySubs(s,l+N,fe,p)}}}}},e.U._glsCovered=function(s,l,d){for(var p=0;p<l.length;p++)if(e._lctf.coverageIndex(l[p],s[d+p])==-1)return!1;return!0},e.U.glyphsToPath=function(s,l,d){for(var p={cmds:[],crds:[]},f=0,y=0;y<l.length;y++){var _=l[y];if(_!=-1){for(var x=y<l.length-1&&l[y+1]!=-1?l[y+1]:0,S=e.U.glyphToPath(s,_),T=0;T<S.crds.length;T+=2)p.crds.push(S.crds[T]+f),p.crds.push(S.crds[T+1]);for(d&&p.cmds.push(d),T=0;T<S.cmds.length;T++)p.cmds.push(S.cmds[T]);d&&p.cmds.push("X"),f+=s.hmtx.aWidth[_],y<l.length-1&&(f+=e.U.getPairAdjustment(s,_,x))}}return p},e.U.P={},e.U.P.moveTo=function(s,l,d){s.cmds.push("M"),s.crds.push(l,d)},e.U.P.lineTo=function(s,l,d){s.cmds.push("L"),s.crds.push(l,d)},e.U.P.curveTo=function(s,l,d,p,f,y,_){s.cmds.push("C"),s.crds.push(l,d,p,f,y,_)},e.U.P.qcurveTo=function(s,l,d,p,f){s.cmds.push("Q"),s.crds.push(l,d,p,f)},e.U.P.closePath=function(s){s.cmds.push("Z")},e.U._drawCFF=function(s,l,d,p,f){for(var y=l.stack,_=l.nStems,x=l.haveWidth,S=l.width,T=l.open,I=0,R=l.x,D=l.y,L=0,O=0,N=0,F=0,G=0,j=0,Y=0,te=0,V=0,Q=0,he={val:0,size:0};I<s.length;){e.CFF.getCharString(s,I,he);var fe=he.val;if(I+=he.size,fe=="o1"||fe=="o18")y.length%2!=0&&!x&&(S=y.shift()+p.nominalWidthX),_+=y.length>>1,y.length=0,x=!0;else if(fe=="o3"||fe=="o23")y.length%2!=0&&!x&&(S=y.shift()+p.nominalWidthX),_+=y.length>>1,y.length=0,x=!0;else if(fe=="o4")y.length>1&&!x&&(S=y.shift()+p.nominalWidthX,x=!0),T&&e.U.P.closePath(f),D+=y.pop(),e.U.P.moveTo(f,R,D),T=!0;else if(fe=="o5")for(;y.length>0;)R+=y.shift(),D+=y.shift(),e.U.P.lineTo(f,R,D);else if(fe=="o6"||fe=="o7")for(var ye=y.length,pe=fe=="o6",Me=0;Me<ye;Me++){var Ie=y.shift();pe?R+=Ie:D+=Ie,pe=!pe,e.U.P.lineTo(f,R,D)}else if(fe=="o8"||fe=="o24"){ye=y.length;for(var ze=0;ze+6<=ye;)L=R+y.shift(),O=D+y.shift(),N=L+y.shift(),F=O+y.shift(),R=N+y.shift(),D=F+y.shift(),e.U.P.curveTo(f,L,O,N,F,R,D),ze+=6;fe=="o24"&&(R+=y.shift(),D+=y.shift(),e.U.P.lineTo(f,R,D))}else{if(fe=="o11")break;if(fe=="o1234"||fe=="o1235"||fe=="o1236"||fe=="o1237")fe=="o1234"&&(O=D,N=(L=R+y.shift())+y.shift(),Q=F=O+y.shift(),j=F,te=D,R=(Y=(G=(V=N+y.shift())+y.shift())+y.shift())+y.shift(),e.U.P.curveTo(f,L,O,N,F,V,Q),e.U.P.curveTo(f,G,j,Y,te,R,D)),fe=="o1235"&&(L=R+y.shift(),O=D+y.shift(),N=L+y.shift(),F=O+y.shift(),V=N+y.shift(),Q=F+y.shift(),G=V+y.shift(),j=Q+y.shift(),Y=G+y.shift(),te=j+y.shift(),R=Y+y.shift(),D=te+y.shift(),y.shift(),e.U.P.curveTo(f,L,O,N,F,V,Q),e.U.P.curveTo(f,G,j,Y,te,R,D)),fe=="o1236"&&(L=R+y.shift(),O=D+y.shift(),N=L+y.shift(),Q=F=O+y.shift(),j=F,Y=(G=(V=N+y.shift())+y.shift())+y.shift(),te=j+y.shift(),R=Y+y.shift(),e.U.P.curveTo(f,L,O,N,F,V,Q),e.U.P.curveTo(f,G,j,Y,te,R,D)),fe=="o1237"&&(L=R+y.shift(),O=D+y.shift(),N=L+y.shift(),F=O+y.shift(),V=N+y.shift(),Q=F+y.shift(),G=V+y.shift(),j=Q+y.shift(),Y=G+y.shift(),te=j+y.shift(),Math.abs(Y-R)>Math.abs(te-D)?R=Y+y.shift():D=te+y.shift(),e.U.P.curveTo(f,L,O,N,F,V,Q),e.U.P.curveTo(f,G,j,Y,te,R,D));else if(fe=="o14"){if(y.length>0&&!x&&(S=y.shift()+d.nominalWidthX,x=!0),y.length==4){var le=y.shift(),me=y.shift(),xe=y.shift(),ae=y.shift(),Ee=e.CFF.glyphBySE(d,xe),Je=e.CFF.glyphBySE(d,ae);e.U._drawCFF(d.CharStrings[Ee],l,d,p,f),l.x=le,l.y=me,e.U._drawCFF(d.CharStrings[Je],l,d,p,f)}T&&(e.U.P.closePath(f),T=!1)}else if(fe=="o19"||fe=="o20")y.length%2!=0&&!x&&(S=y.shift()+p.nominalWidthX),_+=y.length>>1,y.length=0,x=!0,I+=_+7>>3;else if(fe=="o21")y.length>2&&!x&&(S=y.shift()+p.nominalWidthX,x=!0),D+=y.pop(),R+=y.pop(),T&&e.U.P.closePath(f),e.U.P.moveTo(f,R,D),T=!0;else if(fe=="o22")y.length>1&&!x&&(S=y.shift()+p.nominalWidthX,x=!0),R+=y.pop(),T&&e.U.P.closePath(f),e.U.P.moveTo(f,R,D),T=!0;else if(fe=="o25"){for(;y.length>6;)R+=y.shift(),D+=y.shift(),e.U.P.lineTo(f,R,D);L=R+y.shift(),O=D+y.shift(),N=L+y.shift(),F=O+y.shift(),R=N+y.shift(),D=F+y.shift(),e.U.P.curveTo(f,L,O,N,F,R,D)}else if(fe=="o26")for(y.length%2&&(R+=y.shift());y.length>0;)L=R,O=D+y.shift(),R=N=L+y.shift(),D=(F=O+y.shift())+y.shift(),e.U.P.curveTo(f,L,O,N,F,R,D);else if(fe=="o27")for(y.length%2&&(D+=y.shift());y.length>0;)O=D,N=(L=R+y.shift())+y.shift(),F=O+y.shift(),R=N+y.shift(),D=F,e.U.P.curveTo(f,L,O,N,F,R,D);else if(fe=="o10"||fe=="o29"){var Ze=fe=="o10"?p:d;if(y.length==0)console.debug("error: empty stack");else{var Ke=y.pop(),Fe=Ze.Subrs[Ke+Ze.Bias];l.x=R,l.y=D,l.nStems=_,l.haveWidth=x,l.width=S,l.open=T,e.U._drawCFF(Fe,l,d,p,f),R=l.x,D=l.y,_=l.nStems,x=l.haveWidth,S=l.width,T=l.open}}else if(fe=="o30"||fe=="o31"){var ct=y.length,Ct=(ze=0,fe=="o31");for(ze+=ct-(ye=-3&ct);ze<ye;)Ct?(O=D,N=(L=R+y.shift())+y.shift(),D=(F=O+y.shift())+y.shift(),ye-ze==5?(R=N+y.shift(),ze++):R=N,Ct=!1):(L=R,O=D+y.shift(),N=L+y.shift(),F=O+y.shift(),R=N+y.shift(),ye-ze==5?(D=F+y.shift(),ze++):D=F,Ct=!0),e.U.P.curveTo(f,L,O,N,F,R,D),ze+=4}else{if((fe+"").charAt(0)=="o")throw console.debug("Unknown operation: "+fe,s),fe;y.push(fe)}}}l.x=R,l.y=D,l.nStems=_,l.haveWidth=x,l.width=S,l.open=T};var i=e,o={Typr:i};return n.Typr=i,n.default=o,Object.defineProperty(n,"__esModule",{value:!0}),n}({}).Typr}/*!
Custom bundle of woff2otf (https://github.com/arty-name/woff2otf) with fflate
(https://github.com/101arrowz/fflate) for use in Troika text rendering. 
Original licenses apply: 
- fflate: https://github.com/101arrowz/fflate/blob/master/LICENSE (MIT)
- woff2otf.js: https://github.com/arty-name/woff2otf/blob/master/woff2otf.js (Apache2)
*/function cMe(){return function(n){var e=Uint8Array,i=Uint16Array,o=Uint32Array,s=new e([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),l=new e([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),d=new e([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),p=function(fe,ye){for(var pe=new i(31),Me=0;Me<31;++Me)pe[Me]=ye+=1<<fe[Me-1];var Ie=new o(pe[30]);for(Me=1;Me<30;++Me)for(var ze=pe[Me];ze<pe[Me+1];++ze)Ie[ze]=ze-pe[Me]<<5|Me;return[pe,Ie]},f=p(s,2),y=f[0],_=f[1];y[28]=258,_[258]=28;for(var x=p(l,0)[0],S=new i(32768),T=0;T<32768;++T){var I=(43690&T)>>>1|(21845&T)<<1;I=(61680&(I=(52428&I)>>>2|(13107&I)<<2))>>>4|(3855&I)<<4,S[T]=((65280&I)>>>8|(255&I)<<8)>>>1}var R=function(fe,ye,pe){for(var Me=fe.length,Ie=0,ze=new i(ye);Ie<Me;++Ie)++ze[fe[Ie]-1];var le,me=new i(ye);for(Ie=0;Ie<ye;++Ie)me[Ie]=me[Ie-1]+ze[Ie-1]<<1;if(pe){le=new i(1<<ye);var xe=15-ye;for(Ie=0;Ie<Me;++Ie)if(fe[Ie])for(var ae=Ie<<4|fe[Ie],Ee=ye-fe[Ie],Je=me[fe[Ie]-1]++<<Ee,Ze=Je|(1<<Ee)-1;Je<=Ze;++Je)le[S[Je]>>>xe]=ae}else for(le=new i(Me),Ie=0;Ie<Me;++Ie)fe[Ie]&&(le[Ie]=S[me[fe[Ie]-1]++]>>>15-fe[Ie]);return le},D=new e(288);for(T=0;T<144;++T)D[T]=8;for(T=144;T<256;++T)D[T]=9;for(T=256;T<280;++T)D[T]=7;for(T=280;T<288;++T)D[T]=8;var L=new e(32);for(T=0;T<32;++T)L[T]=5;var O=R(D,9,1),N=R(L,5,1),F=function(fe){for(var ye=fe[0],pe=1;pe<fe.length;++pe)fe[pe]>ye&&(ye=fe[pe]);return ye},G=function(fe,ye,pe){var Me=ye/8|0;return(fe[Me]|fe[Me+1]<<8)>>(7&ye)&pe},j=function(fe,ye){var pe=ye/8|0;return(fe[pe]|fe[pe+1]<<8|fe[pe+2]<<16)>>(7&ye)},Y=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],te=function(fe,ye,pe){var Me=new Error(ye||Y[fe]);if(Me.code=fe,Error.captureStackTrace&&Error.captureStackTrace(Me,te),!pe)throw Me;return Me},V=function(fe,ye,pe){var Me=fe.length;if(!Me||pe&&!pe.l&&Me<5)return ye||new e(0);var Ie=!ye||pe,ze=!pe||pe.i;pe||(pe={}),ye||(ye=new e(3*Me));var le,me=function(Xt){var He=ye.length;if(Xt>He){var Pt=new e(Math.max(2*He,Xt));Pt.set(ye),ye=Pt}},xe=pe.f||0,ae=pe.p||0,Ee=pe.b||0,Je=pe.l,Ze=pe.d,Ke=pe.m,Fe=pe.n,ct=8*Me;do{if(!Je){pe.f=xe=G(fe,ae,1);var Ct=G(fe,ae+1,3);if(ae+=3,!Ct){var kt=fe[(je=((le=ae)/8|0)+(7&le&&1)+4)-4]|fe[je-3]<<8,Kt=je+kt;if(Kt>Me){ze&&te(0);break}Ie&&me(Ee+kt),ye.set(fe.subarray(je,Kt),Ee),pe.b=Ee+=kt,pe.p=ae=8*Kt;continue}if(Ct==1)Je=O,Ze=N,Ke=9,Fe=5;else if(Ct==2){var At=G(fe,ae,31)+257,Pe=G(fe,ae+10,15)+4,ft=At+G(fe,ae+5,31)+1;ae+=14;for(var gt=new e(ft),_t=new e(19),Be=0;Be<Pe;++Be)_t[d[Be]]=G(fe,ae+3*Be,7);ae+=3*Pe;var ue=F(_t),se=(1<<ue)-1,_e=R(_t,ue,1);for(Be=0;Be<ft;){var je,De=_e[G(fe,ae,se)];if(ae+=15&De,(je=De>>>4)<16)gt[Be++]=je;else{var st=0,de=0;for(je==16?(de=3+G(fe,ae,3),ae+=2,st=gt[Be-1]):je==17?(de=3+G(fe,ae,7),ae+=3):je==18&&(de=11+G(fe,ae,127),ae+=7);de--;)gt[Be++]=st}}var ne=gt.subarray(0,At),Oe=gt.subarray(At);Ke=F(ne),Fe=F(Oe),Je=R(ne,Ke,1),Ze=R(Oe,Fe,1)}else te(1);if(ae>ct){ze&&te(0);break}}Ie&&me(Ee+131072);for(var ut=(1<<Ke)-1,it=(1<<Fe)-1,lt=ae;;lt=ae){var Et=(st=Je[j(fe,ae)&ut])>>>4;if((ae+=15&st)>ct){ze&&te(0);break}if(st||te(2),Et<256)ye[Ee++]=Et;else{if(Et==256){lt=ae,Je=null;break}var Ut=Et-254;if(Et>264){var Wt=s[Be=Et-257];Ut=G(fe,ae,(1<<Wt)-1)+y[Be],ae+=Wt}var Ht=Ze[j(fe,ae)&it],Dt=Ht>>>4;if(Ht||te(3),ae+=15&Ht,Oe=x[Dt],Dt>3&&(Wt=l[Dt],Oe+=j(fe,ae)&(1<<Wt)-1,ae+=Wt),ae>ct){ze&&te(0);break}Ie&&me(Ee+131072);for(var wt=Ee+Ut;Ee<wt;Ee+=4)ye[Ee]=ye[Ee-Oe],ye[Ee+1]=ye[Ee+1-Oe],ye[Ee+2]=ye[Ee+2-Oe],ye[Ee+3]=ye[Ee+3-Oe];Ee=wt}}pe.l=Je,pe.p=lt,pe.b=Ee,Je&&(xe=1,pe.m=Ke,pe.d=Ze,pe.n=Fe)}while(!xe);return Ee==ye.length?ye:function(Xt,He,Pt){(He==null||He<0)&&(He=0),(Pt==null||Pt>Xt.length)&&(Pt=Xt.length);var qt=new(Xt instanceof i?i:Xt instanceof o?o:e)(Pt-He);return qt.set(Xt.subarray(He,Pt)),qt}(ye,0,Ee)},Q=new e(0),he=typeof TextDecoder<"u"&&new TextDecoder;try{he.decode(Q,{stream:!0})}catch{}return n.convert_streams=function(fe){var ye=new DataView(fe),pe=0;function Me(){var At=ye.getUint16(pe);return pe+=2,At}function Ie(){var At=ye.getUint32(pe);return pe+=4,At}function ze(At){kt.setUint16(Kt,At),Kt+=2}function le(At){kt.setUint32(Kt,At),Kt+=4}for(var me={signature:Ie(),flavor:Ie(),length:Ie(),numTables:Me(),reserved:Me(),totalSfntSize:Ie(),majorVersion:Me(),minorVersion:Me(),metaOffset:Ie(),metaLength:Ie(),metaOrigLength:Ie(),privOffset:Ie(),privLength:Ie()},xe=0;Math.pow(2,xe)<=me.numTables;)xe++;xe--;for(var ae=16*Math.pow(2,xe),Ee=16*me.numTables-ae,Je=12,Ze=[],Ke=0;Ke<me.numTables;Ke++)Ze.push({tag:Ie(),offset:Ie(),compLength:Ie(),origLength:Ie(),origChecksum:Ie()}),Je+=16;var Fe,ct=new Uint8Array(12+16*Ze.length+Ze.reduce(function(At,Pe){return At+Pe.origLength+4},0)),Ct=ct.buffer,kt=new DataView(Ct),Kt=0;return le(me.flavor),ze(me.numTables),ze(ae),ze(xe),ze(Ee),Ze.forEach(function(At){le(At.tag),le(At.origChecksum),le(Je),le(At.origLength),At.outOffset=Je,(Je+=At.origLength)%4!=0&&(Je+=4-Je%4)}),Ze.forEach(function(At){var Pe,ft=fe.slice(At.offset,At.offset+At.compLength);if(At.compLength!=At.origLength){var gt=new Uint8Array(At.origLength);Pe=new Uint8Array(ft,2),V(Pe,gt)}else gt=new Uint8Array(ft);ct.set(gt,At.outOffset);var _t=0;(Je=At.outOffset+At.origLength)%4!=0&&(_t=4-Je%4),ct.set(new Uint8Array(_t).buffer,At.outOffset+At.origLength),Fe=Je+_t}),Ct.slice(0,Fe)},Object.defineProperty(n,"__esModule",{value:!0}),n}({}).convert_streams}function uMe(n,e){const i={M:2,L:2,Q:4,C:6,Z:0},o={C:"18g,ca,368,1kz",D:"17k,6,2,2+4,5+c,2+6,2+1,10+1,9+f,j+11,2+1,a,2,2+1,15+2,3,j+2,6+3,2+8,2,2,2+1,w+a,4+e,3+3,2,3+2,3+5,23+w,2f+4,3,2+9,2,b,2+3,3,1k+9,6+1,3+1,2+2,2+d,30g,p+y,1,1+1g,f+x,2,sd2+1d,jf3+4,f+3,2+4,2+2,b+3,42,2,4+2,2+1,2,3,t+1,9f+w,2,el+2,2+g,d+2,2l,2+1,5,3+1,2+1,2,3,6,16wm+1v",R:"17m+3,2,2,6+3,m,15+2,2+2,h+h,13,3+8,2,2,3+1,2,p+1,x,5+4,5,a,2,2,3,u,c+2,g+1,5,2+1,4+1,5j,6+1,2,b,2+2,f,2+1,1s+2,2,3+1,7,1ez0,2,2+1,4+4,b,4,3,b,42,2+2,4,3,2+1,2,o+3,ae,ep,x,2o+2,3+1,3,5+1,6",L:"x9u,jff,a,fd,jv",T:"4t,gj+33,7o+4,1+1,7c+18,2,2+1,2+1,2,21+a,2,1b+k,h,2u+6,3+5,3+1,2+3,y,2,v+q,2k+a,1n+8,a,p+3,2+8,2+2,2+4,18+2,3c+e,2+v,1k,2,5+7,5,4+6,b+1,u,1n,5+3,9,l+1,r,3+1,1m,5+1,5+1,3+2,4,v+1,4,c+1,1m,5+4,2+1,5,l+1,n+5,2,1n,3,2+3,9,8+1,c+1,v,1q,d,1f,4,1m+2,6+2,2+3,8+1,c+1,u,1n,3,7,6+1,l+1,t+1,1m+1,5+3,9,l+1,u,21,8+2,2,2j,3+6,d+7,2r,3+8,c+5,23+1,s,2,2,1k+d,2+4,2+1,6+a,2+z,a,2v+3,2+5,2+1,3+1,q+1,5+2,h+3,e,3+1,7,g,jk+2,qb+2,u+2,u+1,v+1,1t+1,2+6,9,3+a,a,1a+2,3c+1,z,3b+2,5+1,a,7+2,64+1,3,1n,2+6,2,2,3+7,7+9,3,1d+d,1,1+1,1s+3,1d,2+4,2,6,15+8,d+1,x+3,3+1,2+2,1l,2+1,4,2+2,1n+7,3+1,49+2,2+c,2+6,5,7,4+1,5j+1l,2+4,ek,3+1,r+4,1e+4,6+5,2p+c,1+3,1,1+2,1+b,2db+2,3y,2p+v,ff+3,30+1,n9x,1+2,2+9,x+1,29+1,7l,4,5,q+1,6,48+1,r+h,e,13+7,q+a,1b+2,1d,3+3,3+1,14,1w+5,3+1,3+1,d,9,1c,1g,2+2,3+1,6+1,2,17+1,9,6n,3,5,fn5,ki+f,h+f,5s,6y+2,ea,6b,46+4,1af+2,2+1,6+3,15+2,5,4m+1,fy+3,as+1,4a+a,4x,1j+e,1l+2,1e+3,3+1,1y+2,11+4,2+7,1r,d+1,1h+8,b+3,3,2o+2,3,2+1,7,4h,4+7,m+1,1m+1,4,12+6,4+4,5g+7,3+2,2,o,2d+5,2,5+1,2+1,6n+3,7+1,2+1,s+1,2e+7,3,2+1,2z,2,3+5,2,2u+2,3+3,2+4,78+8,2+1,75+1,2,5,41+3,3+1,5,x+9,15+5,3+3,9,a+5,3+2,1b+c,2+1,bb+6,2+5,2,2b+l,3+6,2+1,2+1,3f+5,4,2+1,2+6,2,21+1,4,2,9o+1,470+8,at4+4,1o+6,t5,1s+3,2a,f5l+1,2+3,43o+2,a+7,1+7,3+6,v+3,45+2,1j0+1i,5+1d,9,f,n+4,2+e,11t+6,2+g,3+6,2+1,2+4,7a+6,c6+3,15t+6,32+6,1,gzau,v+2n,3l+6n"},s=1,l=2,d=4,p=8,f=16,y=32;let _;function x(G){if(!_){const j={R:l,L:s,D:d,C:f,U:y,T:p};_=new Map;for(let Y in o){let te=0;o[Y].split(",").forEach(V=>{let[Q,he]=V.split("+");Q=parseInt(Q,36),he=he?parseInt(he,36):0,_.set(te+=Q,j[Y]);for(let fe=he;fe--;)_.set(++te,j[Y])})}}return _.get(G)||y}const S=1,T=2,I=3,R=4,D=[null,"isol","init","fina","medi"];function L(G){const j=new Uint8Array(G.length);let Y=y,te=S,V=-1;for(let Q=0;Q<G.length;Q++){const he=G.codePointAt(Q);let fe=x(he)|0,ye=S;fe&p||(Y&(s|d|f)?fe&(l|d|f)?(ye=I,(te===S||te===I)&&j[V]++):fe&(s|y)&&(te===T||te===R)&&j[V]--:Y&(l|y)&&(te===T||te===R)&&j[V]--,te=j[Q]=ye,Y=fe,V=Q,he>65535&&Q++)}return j}function O(G,j){const Y=[];for(let V=0;V<j.length;V++){const Q=j.codePointAt(V);Q>65535&&V++,Y.push(n.U.codeToGlyph(G,Q))}const te=G.GSUB;if(te){const{lookupList:V,featureList:Q}=te;let he;const fe=/^(rlig|liga|mset|isol|init|fina|medi|half|pres|blws)$/,ye=[];Q.forEach(pe=>{if(fe.test(pe.tag))for(let Me=0;Me<pe.tab.length;Me++){if(ye[pe.tab[Me]])continue;ye[pe.tab[Me]]=!0;const Ie=V[pe.tab[Me]],ze=/^(isol|init|fina|medi)$/.test(pe.tag);ze&&!he&&(he=L(j));for(let le=0;le<Y.length;le++)(!he||!ze||D[he[le]]===pe.tag)&&n.U._applySubs(Y,le,Ie,V)}})}return Y}function N(...G){for(let j=0;j<G.length;j++)if(typeof G[j]=="number")return G[j]}function F(G){const j=Object.create(null),Y=G["OS/2"],te=G.hhea,V=G.head.unitsPerEm,Q=N(Y&&Y.sTypoAscender,te&&te.ascender,V),he={unitsPerEm:V,ascender:Q,descender:N(Y&&Y.sTypoDescender,te&&te.descender,0),capHeight:N(Y&&Y.sCapHeight,Q),xHeight:N(Y&&Y.sxHeight,Q),lineGap:N(Y&&Y.sTypoLineGap,te&&te.lineGap),forEachGlyph(fe,ye,pe,Me){let Ie=0;const ze=1/he.unitsPerEm*ye,le=O(G,fe);let me=0,xe=-1;return le.forEach((ae,Ee)=>{if(ae!==-1){let Je=j[ae];if(!Je){const{cmds:Ze,crds:Ke}=n.U.glyphToPath(G,ae);let Fe="",ct=0;for(let Pe=0,ft=Ze.length;Pe<ft;Pe++){const gt=i[Ze[Pe]];Fe+=Ze[Pe];for(let _t=1;_t<=gt;_t++)Fe+=(_t>1?",":"")+Ke[ct++]}let Ct,kt,Kt,At;if(Ke.length){Ct=kt=1/0,Kt=At=-1/0;for(let Pe=0,ft=Ke.length;Pe<ft;Pe+=2){let gt=Ke[Pe],_t=Ke[Pe+1];gt<Ct&&(Ct=gt),_t<kt&&(kt=_t),gt>Kt&&(Kt=gt),_t>At&&(At=_t)}}else Ct=Kt=kt=At=0;Je=j[ae]={index:ae,advanceWidth:G.hmtx.aWidth[ae],xMin:Ct,yMin:kt,xMax:Kt,yMax:At,path:Fe,pathCommandCount:Ze.length}}xe!==-1&&(Ie+=n.U.getPairAdjustment(G,xe,ae)*ze),Me.call(null,Je,Ie,me),Je.advanceWidth&&(Ie+=Je.advanceWidth*ze),pe&&(Ie+=pe*ye),xe=ae}me+=fe.codePointAt(me)>65535?2:1}),Ie}};return he}return function(j){const Y=new Uint8Array(j,0,4),te=n._bin.readASCII(Y,0,4);if(te==="wOFF")j=e(j);else if(te==="wOF2")throw new Error("woff2 fonts not supported");return F(n.parse(j)[0])}}const dMe=n2({name:"Typr Font Parser",dependencies:[lMe,cMe,uMe],init(n,e,i){const o=n(),s=e();return i(o,s)}}),k0={defaultFontURL:"https://fonts.gstatic.com/s/roboto/v18/KFOmCnqEu92Fr1Mu4mxM.woff",sdfGlyphSize:64,sdfMargin:1/16,sdfExponent:9,textureWidth:2048},hMe=new Pn;function r0(){return(self.performance||Date).now()}const vG=Object.create(null);function kK(n,e){n=mMe({},n);const i=r0();if(n.font=gMe(n.font||k0.defaultFontURL),n.text=""+n.text,n.sdfGlyphSize=n.sdfGlyphSize||k0.sdfGlyphSize,n.colorRanges!=null){let x={};for(let S in n.colorRanges)if(n.colorRanges.hasOwnProperty(S)){let T=n.colorRanges[S];typeof T!="number"&&(T=hMe.set(T).getHex()),x[S]=T}n.colorRanges=x}Object.freeze(n);const{textureWidth:o,sdfExponent:s}=k0,{sdfGlyphSize:l}=n,d=o/l*4;let p=vG[l];if(!p){const x=document.createElement("canvas");x.width=o,x.height=l*256/d,p=vG[l]={glyphCount:0,sdfGlyphSize:l,sdfCanvas:x,sdfTexture:new Or(x,void 0,void 0,void 0,Lr,Lr),contextLost:!1,glyphsByFont:new Map},p.sdfTexture.generateMipmaps=!1,pMe(p)}const{sdfTexture:f,sdfCanvas:y}=p;let _=p.glyphsByFont.get(n.font);_||p.glyphsByFont.set(n.font,_=new Map),vMe(n).then(x=>{const{glyphIds:S,glyphPositions:T,fontSize:I,unitsPerEm:R,timings:D}=x,L=[],O=new Float32Array(S.length*4),N=I/R;let F=0,G=0;const j=r0();S.forEach((he,fe)=>{let ye=_.get(he);if(!ye){const{path:ze,pathBounds:le}=x.glyphData[he],me=Math.max(le[2]-le[0],le[3]-le[1])/l*(k0.sdfMargin*l+.5),xe=p.glyphCount++,ae=[le[0]-me,le[1]-me,le[2]+me,le[3]+me];_.set(he,ye={path:ze,atlasIndex:xe,sdfViewBox:ae}),L.push(ye)}const{sdfViewBox:pe}=ye,Me=T[G++],Ie=T[G++];O[F++]=Me+pe[0]*N,O[F++]=Ie+pe[1]*N,O[F++]=Me+pe[2]*N,O[F++]=Ie+pe[3]*N,S[fe]=ye.atlasIndex}),D.quads=(D.quads||0)+(r0()-j);const Y=r0();D.sdf={};const te=y.height,V=Math.ceil(p.glyphCount/d),Q=Math.pow(2,Math.ceil(Math.log2(V*l)));Q>te&&(console.info(`Increasing SDF texture size ${te}->${Q}`),sMe(y,o,Q),f.dispose()),Promise.all(L.map(he=>DK(he,p,n.gpuAccelerateSDF).then(({timing:fe})=>{D.sdf[he.atlasIndex]=fe}))).then(()=>{L.length&&!p.contextLost&&(OK(p),f.needsUpdate=!0),D.sdfTotal=r0()-Y,D.total=r0()-i,e(Object.freeze({parameters:n,sdfTexture:f,sdfGlyphSize:l,sdfExponent:s,glyphBounds:O,glyphAtlasIndices:S,glyphColors:x.glyphColors,caretPositions:x.caretPositions,caretHeight:x.caretHeight,chunkedBounds:x.chunkedBounds,ascender:x.ascender,descender:x.descender,lineHeight:x.lineHeight,capHeight:x.capHeight,xHeight:x.xHeight,topBaseline:x.topBaseline,blockBounds:x.blockBounds,visibleBounds:x.visibleBounds,timings:x.timings}))})}),Promise.resolve().then(()=>{p.contextLost||oMe(y)})}function DK({path:n,atlasIndex:e,sdfViewBox:i},{sdfGlyphSize:o,sdfCanvas:s,contextLost:l},d){if(l)return Promise.resolve({timing:-1});const{textureWidth:p,sdfExponent:f}=k0,y=Math.max(i[2]-i[0],i[3]-i[1]),_=Math.floor(e/4),x=_%(p/o)*o,S=Math.floor(_/(p/o))*o,T=e%4;return eMe(o,o,n,i,y,f,s,x,S,T,d)}function pMe(n){const e=n.sdfCanvas;e.addEventListener("webglcontextlost",i=>{console.log("Context Lost",i),i.preventDefault(),n.contextLost=!0}),e.addEventListener("webglcontextrestored",i=>{console.log("Context Restored",i),n.contextLost=!1;const o=[];n.glyphsByFont.forEach(s=>{s.forEach(l=>{o.push(DK(l,n,!0))})}),Promise.all(o).then(()=>{OK(n),n.sdfTexture.needsUpdate=!0})})}function fMe({font:n,characters:e,sdfGlyphSize:i},o){let s=Array.isArray(e)?e.join(`
`):""+e;kK({font:n,sdfGlyphSize:i,text:s},o)}function mMe(n,e){for(let i in e)e.hasOwnProperty(i)&&(n[i]=e[i]);return n}let yA;function gMe(n){return yA||(yA=typeof document>"u"?{}:document.createElement("a")),yA.href=n,yA.href}function OK(n){if(typeof createImageBitmap!="function"){console.info("Safari<15: applying SDF canvas workaround");const{sdfCanvas:e,sdfTexture:i}=n,{width:o,height:s}=e,l=n.sdfCanvas.getContext("webgl");let d=i.image.data;(!d||d.length!==o*s*4)&&(d=new Uint8Array(o*s*4),i.image={width:o,height:s,data:d},i.flipY=!1,i.isDataTexture=!0),l.readPixels(0,0,o,s,l.RGBA,l.UNSIGNED_BYTE,d)}}const yMe=n2({name:"Typesetter",dependencies:[k0,dMe,QEe,jEe],init(n,e,i,o){const{defaultFontURL:s}=n;return i(e,o(),{defaultFontURL:s})}}),vMe=n2({name:"Typesetter",dependencies:[yMe],init(n){return function(e){return new Promise(i=>{n.typeset(e,i)})}},getTransferables(n){const e=[n.glyphPositions.buffer,n.glyphIds.buffer];return n.caretPositions&&e.push(n.caretPositions.buffer),n.glyphColors&&e.push(n.glyphColors.buffer),e}}),_G={};function _Me(n){let e=_G[n];if(!e){const i=new Rf(1,1,n,n),o=i.clone(),s=i.attributes,l=o.attributes,d=new ki,p=s.uv.count;for(let f=0;f<p;f++)l.position.array[f*3]*=-1,l.normal.array[f*3+2]*=-1;["position","normal","uv"].forEach(f=>{d.setAttribute(f,new Gn([...s[f].array,...l[f].array],s[f].itemSize))}),d.setIndex([...i.index.array,...o.index.array.map(f=>f+p)]),d.translate(.5,.5,0),e=_G[n]=d}return e}const bMe="aTroikaGlyphBounds",bG="aTroikaGlyphIndex",xMe="aTroikaGlyphColor";class wMe extends k6{constructor(){super(),this.detail=1,this.curveRadius=0,this.groups=[{start:0,count:1/0,materialIndex:0},{start:0,count:1/0,materialIndex:1}],this.boundingSphere=new Rc,this.boundingBox=new _u}computeBoundingSphere(){}computeBoundingBox(){}setSide(e){const i=this.getIndex().count;this.setDrawRange(e===Ss?i/2:0,e===jl?i:i/2)}set detail(e){if(e!==this._detail){this._detail=e,(typeof e!="number"||e<1)&&(e=1);let i=_Me(e);["position","normal","uv"].forEach(o=>{this.attributes[o]=i.attributes[o].clone()}),this.setIndex(i.getIndex().clone())}}get detail(){return this._detail}set curveRadius(e){e!==this._curveRadius&&(this._curveRadius=e,this._updateBounds())}get curveRadius(){return this._curveRadius}updateGlyphs(e,i,o,s,l){gI(this,bMe,e,4),gI(this,bG,i,1),gI(this,xMe,l,3),this._blockBounds=o,this._chunkedBounds=s,this.instanceCount=i.length,this._updateBounds()}_updateBounds(){const e=this._blockBounds;if(e){const{curveRadius:i,boundingBox:o}=this;if(i){const{PI:s,floor:l,min:d,max:p,sin:f,cos:y}=Math,_=s/2,x=s*2,S=Math.abs(i),T=e[0]/S,I=e[2]/S,R=l((T+_)/x)!==l((I+_)/x)?-S:d(f(T)*S,f(I)*S),D=l((T-_)/x)!==l((I-_)/x)?S:p(f(T)*S,f(I)*S),L=l((T+s)/x)!==l((I+s)/x)?S*2:p(S-y(T)*S,S-y(I)*S);o.min.set(R,e[1],i<0?-L:0),o.max.set(D,e[3],i<0?0:L)}else o.min.set(e[0],e[1],0),o.max.set(e[2],e[3],0);o.getBoundingSphere(this.boundingSphere)}}applyClipRect(e){let i=this.getAttribute(bG).count,o=this._chunkedBounds;if(o)for(let s=o.length;s--;){i=o[s].end;let l=o[s].rect;if(l[1]<e.w&&l[3]>e.y&&l[0]<e.z&&l[2]>e.x)break}this.instanceCount=i}}function gI(n,e,i,o){const s=n.getAttribute(e);i?s&&s.array.length===i.length?(s.array.set(i),s.needsUpdate=!0):(n.setAttribute(e,new Wg(i,o)),delete n._maxInstanceCount,n.dispose()):s&&n.deleteAttribute(e)}const SMe=`
uniform vec2 uTroikaSDFTextureSize;
uniform float uTroikaSDFGlyphSize;
uniform vec4 uTroikaTotalBounds;
uniform vec4 uTroikaClipRect;
uniform mat3 uTroikaOrient;
uniform bool uTroikaUseGlyphColors;
uniform float uTroikaDistanceOffset;
uniform float uTroikaBlurRadius;
uniform vec2 uTroikaPositionOffset;
uniform float uTroikaCurveRadius;
attribute vec4 aTroikaGlyphBounds;
attribute float aTroikaGlyphIndex;
attribute vec3 aTroikaGlyphColor;
varying vec2 vTroikaGlyphUV;
varying vec4 vTroikaTextureUVBounds;
varying float vTroikaTextureChannel;
varying vec3 vTroikaGlyphColor;
varying vec2 vTroikaGlyphDimensions;
`,AMe=`
vec4 bounds = aTroikaGlyphBounds;
bounds.xz += uTroikaPositionOffset.x;
bounds.yw -= uTroikaPositionOffset.y;

vec4 outlineBounds = vec4(
  bounds.xy - uTroikaDistanceOffset - uTroikaBlurRadius,
  bounds.zw + uTroikaDistanceOffset + uTroikaBlurRadius
);
vec4 clippedBounds = vec4(
  clamp(outlineBounds.xy, uTroikaClipRect.xy, uTroikaClipRect.zw),
  clamp(outlineBounds.zw, uTroikaClipRect.xy, uTroikaClipRect.zw)
);

vec2 clippedXY = (mix(clippedBounds.xy, clippedBounds.zw, position.xy) - bounds.xy) / (bounds.zw - bounds.xy);

position.xy = mix(bounds.xy, bounds.zw, clippedXY);

uv = (position.xy - uTroikaTotalBounds.xy) / (uTroikaTotalBounds.zw - uTroikaTotalBounds.xy);

float rad = uTroikaCurveRadius;
if (rad != 0.0) {
  float angle = position.x / rad;
  position.xz = vec2(sin(angle) * rad, rad - cos(angle) * rad);
  normal.xz = vec2(sin(angle), cos(angle));
}
  
position = uTroikaOrient * position;
normal = uTroikaOrient * normal;

vTroikaGlyphUV = clippedXY.xy;
vTroikaGlyphDimensions = vec2(bounds[2] - bounds[0], bounds[3] - bounds[1]);


float txCols = uTroikaSDFTextureSize.x / uTroikaSDFGlyphSize;
vec2 txUvPerSquare = uTroikaSDFGlyphSize / uTroikaSDFTextureSize;
vec2 txStartUV = txUvPerSquare * vec2(
  mod(floor(aTroikaGlyphIndex / 4.0), txCols),
  floor(floor(aTroikaGlyphIndex / 4.0) / txCols)
);
vTroikaTextureUVBounds = vec4(txStartUV, vec2(txStartUV) + txUvPerSquare);
vTroikaTextureChannel = mod(aTroikaGlyphIndex, 4.0);
`,EMe=`
uniform sampler2D uTroikaSDFTexture;
uniform vec2 uTroikaSDFTextureSize;
uniform float uTroikaSDFGlyphSize;
uniform float uTroikaSDFExponent;
uniform float uTroikaDistanceOffset;
uniform float uTroikaFillOpacity;
uniform float uTroikaOutlineOpacity;
uniform float uTroikaBlurRadius;
uniform vec3 uTroikaStrokeColor;
uniform float uTroikaStrokeWidth;
uniform float uTroikaStrokeOpacity;
uniform bool uTroikaSDFDebug;
varying vec2 vTroikaGlyphUV;
varying vec4 vTroikaTextureUVBounds;
varying float vTroikaTextureChannel;
varying vec2 vTroikaGlyphDimensions;

float troikaSdfValueToSignedDistance(float alpha) {
  // Inverse of exponential encoding in webgl-sdf-generator
  
  float maxDimension = max(vTroikaGlyphDimensions.x, vTroikaGlyphDimensions.y);
  float absDist = (1.0 - pow(2.0 * (alpha > 0.5 ? 1.0 - alpha : alpha), 1.0 / uTroikaSDFExponent)) * maxDimension;
  float signedDist = absDist * (alpha > 0.5 ? -1.0 : 1.0);
  return signedDist;
}

float troikaGlyphUvToSdfValue(vec2 glyphUV) {
  vec2 textureUV = mix(vTroikaTextureUVBounds.xy, vTroikaTextureUVBounds.zw, glyphUV);
  vec4 rgba = texture2D(uTroikaSDFTexture, textureUV);
  float ch = floor(vTroikaTextureChannel + 0.5); //NOTE: can't use round() in WebGL1
  return ch == 0.0 ? rgba.r : ch == 1.0 ? rgba.g : ch == 2.0 ? rgba.b : rgba.a;
}

float troikaGlyphUvToDistance(vec2 uv) {
  return troikaSdfValueToSignedDistance(troikaGlyphUvToSdfValue(uv));
}

float troikaGetAADist() {
  
  #if defined(GL_OES_standard_derivatives) || __VERSION__ >= 300
  return length(fwidth(vTroikaGlyphUV * vTroikaGlyphDimensions)) * 0.5;
  #else
  return vTroikaGlyphDimensions.x / 64.0;
  #endif
}

float troikaGetFragDistValue() {
  vec2 clampedGlyphUV = clamp(vTroikaGlyphUV, 0.5 / uTroikaSDFGlyphSize, 1.0 - 0.5 / uTroikaSDFGlyphSize);
  float distance = troikaGlyphUvToDistance(clampedGlyphUV);
 
  // Extrapolate distance when outside bounds:
  distance += clampedGlyphUV == vTroikaGlyphUV ? 0.0 : 
    length((vTroikaGlyphUV - clampedGlyphUV) * vTroikaGlyphDimensions);

  

  return distance;
}

float troikaGetEdgeAlpha(float distance, float distanceOffset, float aaDist) {
  #if defined(IS_DEPTH_MATERIAL) || defined(IS_DISTANCE_MATERIAL)
  float alpha = step(-distanceOffset, -distance);
  #else

  float alpha = smoothstep(
    distanceOffset + aaDist,
    distanceOffset - aaDist,
    distance
  );
  #endif

  return alpha;
}
`,MMe=`
float aaDist = troikaGetAADist();
float fragDistance = troikaGetFragDistValue();
float edgeAlpha = uTroikaSDFDebug ?
  troikaGlyphUvToSdfValue(vTroikaGlyphUV) :
  troikaGetEdgeAlpha(fragDistance, uTroikaDistanceOffset, max(aaDist, uTroikaBlurRadius));

#if !defined(IS_DEPTH_MATERIAL) && !defined(IS_DISTANCE_MATERIAL)
vec4 fillRGBA = gl_FragColor;
fillRGBA.a *= uTroikaFillOpacity;
vec4 strokeRGBA = uTroikaStrokeWidth == 0.0 ? fillRGBA : vec4(uTroikaStrokeColor, uTroikaStrokeOpacity);
if (fillRGBA.a == 0.0) fillRGBA.rgb = strokeRGBA.rgb;
gl_FragColor = mix(fillRGBA, strokeRGBA, smoothstep(
  -uTroikaStrokeWidth - aaDist,
  -uTroikaStrokeWidth + aaDist,
  fragDistance
));
gl_FragColor.a *= edgeAlpha;
#endif

if (edgeAlpha == 0.0) {
  discard;
}
`;function TMe(n){const e=jR(n,{chained:!0,extensions:{derivatives:!0},uniforms:{uTroikaSDFTexture:{value:null},uTroikaSDFTextureSize:{value:new tn},uTroikaSDFGlyphSize:{value:0},uTroikaSDFExponent:{value:0},uTroikaTotalBounds:{value:new Pa(0,0,0,0)},uTroikaClipRect:{value:new Pa(0,0,0,0)},uTroikaDistanceOffset:{value:0},uTroikaOutlineOpacity:{value:0},uTroikaFillOpacity:{value:1},uTroikaPositionOffset:{value:new tn},uTroikaCurveRadius:{value:0},uTroikaBlurRadius:{value:0},uTroikaStrokeWidth:{value:0},uTroikaStrokeColor:{value:new Pn},uTroikaStrokeOpacity:{value:1},uTroikaOrient:{value:new Ui},uTroikaUseGlyphColors:{value:!0},uTroikaSDFDebug:{value:!1}},vertexDefs:SMe,vertexTransform:AMe,fragmentDefs:EMe,fragmentColorTransform:MMe,customRewriter({vertexShader:i,fragmentShader:o}){let s=/\buniform\s+vec3\s+diffuse\b/;return s.test(o)&&(o=o.replace(s,"varying vec3 vTroikaGlyphColor").replace(/\bdiffuse\b/g,"vTroikaGlyphColor"),s.test(i)||(i=i.replace(LK,`uniform vec3 diffuse;
$&
vTroikaGlyphColor = uTroikaUseGlyphColors ? aTroikaGlyphColor / 255.0 : diffuse;
`))),{vertexShader:i,fragmentShader:o}}});return e.transparent=!0,Object.defineProperties(e,{isTroikaTextMaterial:{value:!0},shadowSide:{get(){return this.side},set(){}}}),e}const G6=new qh({color:16777215,side:jl,transparent:!0}),xG=8421504,wG=new Ri,vA=new Ue,yI=new Ue,Eb=[],CMe=new Ue,vI="+x+y";function SG(n){return Array.isArray(n)?n[0]:n}let NK=()=>{const n=new wo(new Rf(1,1),G6);return NK=()=>n,n},zK=()=>{const n=new wo(new Rf(1,1,32,1),G6);return zK=()=>n,n};const PMe={type:"syncstart"},IMe={type:"synccomplete"},FK=["font","fontSize","letterSpacing","lineHeight","maxWidth","overflowWrap","text","direction","textAlign","textIndent","whiteSpace","anchorX","anchorY","colorRanges","sdfGlyphSize"],LMe=FK.concat("material","color","depthOffset","clipRect","curveRadius","orientation","glyphGeometryDetail");let BK=class extends wo{constructor(){const e=new wMe;super(e,null),this.text="",this.anchorX=0,this.anchorY=0,this.curveRadius=0,this.direction="auto",this.font=null,this.fontSize=.1,this.letterSpacing=0,this.lineHeight="normal",this.maxWidth=1/0,this.overflowWrap="normal",this.textAlign="left",this.textIndent=0,this.whiteSpace="normal",this.material=null,this.color=null,this.colorRanges=null,this.outlineWidth=0,this.outlineColor=0,this.outlineOpacity=1,this.outlineBlur=0,this.outlineOffsetX=0,this.outlineOffsetY=0,this.strokeWidth=0,this.strokeColor=xG,this.strokeOpacity=1,this.fillOpacity=1,this.depthOffset=0,this.clipRect=null,this.orientation=vI,this.glyphGeometryDetail=1,this.sdfGlyphSize=null,this.gpuAccelerateSDF=!0,this.debugSDF=!1}sync(e){this._needsSync&&(this._needsSync=!1,this._isSyncing?(this._queuedSyncs||(this._queuedSyncs=[])).push(e):(this._isSyncing=!0,this.dispatchEvent(PMe),kK({text:this.text,font:this.font,fontSize:this.fontSize||.1,letterSpacing:this.letterSpacing||0,lineHeight:this.lineHeight||"normal",maxWidth:this.maxWidth,direction:this.direction||"auto",textAlign:this.textAlign,textIndent:this.textIndent,whiteSpace:this.whiteSpace,overflowWrap:this.overflowWrap,anchorX:this.anchorX,anchorY:this.anchorY,colorRanges:this.colorRanges,includeCaretPositions:!0,sdfGlyphSize:this.sdfGlyphSize,gpuAccelerateSDF:this.gpuAccelerateSDF},i=>{this._isSyncing=!1,this._textRenderInfo=i,this.geometry.updateGlyphs(i.glyphBounds,i.glyphAtlasIndices,i.blockBounds,i.chunkedBounds,i.glyphColors);const o=this._queuedSyncs;o&&(this._queuedSyncs=null,this._needsSync=!0,this.sync(()=>{o.forEach(s=>s&&s())})),this.dispatchEvent(IMe),e&&e()})))}onBeforeRender(e,i,o,s,l,d){this.sync(),l.isTroikaTextMaterial&&this._prepareForRender(l),l._hadOwnSide=l.hasOwnProperty("side"),this.geometry.setSide(l._actualSide=l.side),l.side=wd}onAfterRender(e,i,o,s,l,d){l._hadOwnSide?l.side=l._actualSide:delete l.side}dispose(){this.geometry.dispose()}get textRenderInfo(){return this._textRenderInfo||null}get material(){let e=this._derivedMaterial;const i=this._baseMaterial||this._defaultMaterial||(this._defaultMaterial=G6.clone());if((!e||e.baseMaterial!==i)&&(e=this._derivedMaterial=TMe(i),i.addEventListener("dispose",function o(){i.removeEventListener("dispose",o),e.dispose()})),this.outlineWidth||this.outlineBlur||this.outlineOffsetX||this.outlineOffsetY){let o=e._outlineMtl;return o||(o=e._outlineMtl=Object.create(e,{id:{value:e.id+.1}}),o.isTextOutlineMaterial=!0,o.depthWrite=!1,o.map=null,e.addEventListener("dispose",function s(){e.removeEventListener("dispose",s),o.dispose()})),[o,e]}else return e}set material(e){e&&e.isTroikaTextMaterial?(this._derivedMaterial=e,this._baseMaterial=e.baseMaterial):this._baseMaterial=e}get glyphGeometryDetail(){return this.geometry.detail}set glyphGeometryDetail(e){this.geometry.detail=e}get curveRadius(){return this.geometry.curveRadius}set curveRadius(e){this.geometry.curveRadius=e}get customDepthMaterial(){return SG(this.material).getDepthMaterial()}get customDistanceMaterial(){return SG(this.material).getDistanceMaterial()}_prepareForRender(e){const i=e.isTextOutlineMaterial,o=e.uniforms,s=this.textRenderInfo;if(s){const{sdfTexture:p,blockBounds:f}=s;o.uTroikaSDFTexture.value=p,o.uTroikaSDFTextureSize.value.set(p.image.width,p.image.height),o.uTroikaSDFGlyphSize.value=s.sdfGlyphSize,o.uTroikaSDFExponent.value=s.sdfExponent,o.uTroikaTotalBounds.value.fromArray(f),o.uTroikaUseGlyphColors.value=!i&&!!s.glyphColors;let y=0,_=0,x=0,S,T,I,R=0,D=0;if(i){let{outlineWidth:O,outlineOffsetX:N,outlineOffsetY:F,outlineBlur:G,outlineOpacity:j}=this;y=this._parsePercent(O)||0,_=Math.max(0,this._parsePercent(G)||0),S=j,R=this._parsePercent(N)||0,D=this._parsePercent(F)||0}else x=Math.max(0,this._parsePercent(this.strokeWidth)||0),x&&(I=this.strokeColor,o.uTroikaStrokeColor.value.set(I??xG),T=this.strokeOpacity,T==null&&(T=1)),S=this.fillOpacity;o.uTroikaDistanceOffset.value=y,o.uTroikaPositionOffset.value.set(R,D),o.uTroikaBlurRadius.value=_,o.uTroikaStrokeWidth.value=x,o.uTroikaStrokeOpacity.value=T,o.uTroikaFillOpacity.value=S??1,o.uTroikaCurveRadius.value=this.curveRadius||0;let L=this.clipRect;if(L&&Array.isArray(L)&&L.length===4)o.uTroikaClipRect.value.fromArray(L);else{const O=(this.fontSize||.1)*100;o.uTroikaClipRect.value.set(f[0]-O,f[1]-O,f[2]+O,f[3]+O)}this.geometry.applyClipRect(o.uTroikaClipRect.value)}o.uTroikaSDFDebug.value=!!this.debugSDF,e.polygonOffset=!!this.depthOffset,e.polygonOffsetFactor=e.polygonOffsetUnits=this.depthOffset||0;const l=i?this.outlineColor||0:this.color;if(l==null)delete e.color;else{const p=e.hasOwnProperty("color")?e.color:e.color=new Pn;(l!==p._input||typeof l=="object")&&p.set(p._input=l)}let d=this.orientation||vI;if(d!==e._orientation){let p=o.uTroikaOrient.value;d=d.replace(/[^-+xyz]/g,"");let f=d!==vI&&d.match(/^([-+])([xyz])([-+])([xyz])$/);if(f){let[,y,_,x,S]=f;vA.set(0,0,0)[_]=y==="-"?1:-1,yI.set(0,0,0)[S]=x==="-"?-1:1,wG.lookAt(CMe,vA.cross(yI),yI),p.setFromMatrix4(wG)}else p.identity();e._orientation=d}}_parsePercent(e){if(typeof e=="string"){let i=e.match(/^(-?[\d.]+)%$/),o=i?parseFloat(i[1]):NaN;e=(isNaN(o)?0:o/100)*this.fontSize}return e}localPositionToTextCoords(e,i=new tn){i.copy(e);const o=this.curveRadius;return o&&(i.x=Math.atan2(e.x,Math.abs(o)-Math.abs(e.z))*Math.abs(o)),i}worldPositionToTextCoords(e,i=new tn){return vA.copy(e),this.localPositionToTextCoords(this.worldToLocal(vA),i)}raycast(e,i){const{textRenderInfo:o,curveRadius:s}=this;if(o){const l=o.blockBounds,d=s?zK():NK(),p=d.geometry,{position:f,uv:y}=p.attributes;for(let _=0;_<y.count;_++){let x=l[0]+y.getX(_)*(l[2]-l[0]);const S=l[1]+y.getY(_)*(l[3]-l[1]);let T=0;s&&(T=s-Math.cos(x/s)*s,x=Math.sin(x/s)*s),f.setXYZ(_,x,S,T)}p.boundingSphere=this.geometry.boundingSphere,p.boundingBox=this.geometry.boundingBox,d.matrixWorld=this.matrixWorld,d.material.side=this.material.side,Eb.length=0,d.raycast(e,Eb);for(let _=0;_<Eb.length;_++)Eb[_].object=this,i.push(Eb[_])}}copy(e){const i=this.geometry;return super.copy(e),this.geometry=i,LMe.forEach(o=>{this[o]=e[o]}),this}clone(){return new this.constructor().copy(this)}};FK.forEach(n=>{const e="_private_"+n;Object.defineProperty(BK.prototype,n,{get(){return this[e]},set(i){i!==this[e]&&(this[e]=i,this._needsSync=!0)}})});const bx=ie.forwardRef(({sdfGlyphSize:n=64,anchorX:e="center",anchorY:i="middle",font:o,fontSize:s=1,children:l,characters:d,onSync:p,...f},y)=>{const _=_h(({invalidate:I})=>I),[x]=ie.useState(()=>new BK),[S,T]=ie.useMemo(()=>{const I=[];let R="";return ie.Children.forEach(l,D=>{typeof D=="string"||typeof D=="number"?R+=D:I.push(D)}),[I,R]},[l]);return dK(()=>new Promise(I=>fMe({font:o,characters:d},I)),["troika-text",o,d]),ie.useLayoutEffect(()=>void x.sync(()=>{_(),p&&p(x)})),ie.useEffect(()=>()=>x.dispose(),[x]),ie.createElement("primitive",qe({object:x,ref:y,font:o,text:T,anchorX:e,anchorY:i,fontSize:s,sdfGlyphSize:n},f),S)}),RMe=ie.forwardRef(({makeDefault:n,camera:e,regress:i,domElement:o,enableDamping:s=!0,keyEvents:l=!1,onChange:d,onStart:p,onEnd:f,...y},_)=>{const x=_h(j=>j.invalidate),S=_h(j=>j.camera),T=_h(j=>j.gl),I=_h(j=>j.events),R=_h(j=>j.setEvents),D=_h(j=>j.set),L=_h(j=>j.get),O=_h(j=>j.performance),N=e||S,F=o||I.connected||T.domElement,G=ie.useMemo(()=>new FEe(N),[N]);return U6(()=>{G.enabled&&G.update()},-1),ie.useEffect(()=>(l&&G.connect(l===!0?F:l),G.connect(F),()=>void G.dispose()),[l,F,i,G,x]),ie.useEffect(()=>{const j=V=>{x(),i&&O.regress(),d&&d(V)},Y=V=>{p&&p(V)},te=V=>{f&&f(V)};return G.addEventListener("change",j),G.addEventListener("start",Y),G.addEventListener("end",te),()=>{G.removeEventListener("start",Y),G.removeEventListener("end",te),G.removeEventListener("change",j)}},[d,p,f,G,x,R]),ie.useEffect(()=>{if(n){const j=L().controls;return D({controls:G}),()=>D({controls:j})}},[n,G]),ie.createElement("primitive",qe({ref:_,object:G,enableDamping:s},y))}),o0=({value:n,label:e,options:i,onChange:o})=>{const{classes:s}=JD(),[l,d]=ie.useState(!1),p=()=>{d(!1)};return $e(Iye,{children:[X(Kye,{children:e}),$e(m0e,{className:s.filterSelect,open:l,value:n,onOpen:p,onChange:o,variant:"outlined",label:e,sx:{boxShadow:"none",".MuiOutlinedInput-notchedOutline":{border:0},"&.MuiOutlinedInput-root.Mui-focused .MuiOutlinedInput-notchedOutline":{border:0}},renderValue:f=>f.length===0?X("em",{children:e}):f,children:[X(Fg,{disabled:!0,value:"",children:X("em",{children:e})}),i.map(f=>X(Fg,{value:f,children:f},f))]})]})},kMe=()=>{const{classes:n}=JD(),[e,i]=ie.useState(!1),[o,s]=ie.useState("Country"),[l,d]=ie.useState("Climate"),[p,f]=ie.useState("Risk exposure"),[y,_]=ie.useState("Income group"),[x,S]=ie.useState("Population group"),[T,I]=ie.useState("Rating"),R=ie.useCallback(G=>{s(G.target.value)},[]),D=ie.useCallback(G=>{d(G.target.value)},[]),L=ie.useCallback(G=>{f(G.target.value)},[]),O=ie.useCallback(G=>{_(G.target.value)},[]),N=ie.useCallback(G=>{S(G.target.value)},[]),F=ie.useCallback(G=>{I(G.target.value)},[]);return X("div",{className:n.filterButtonsWrapper,children:e?$e("div",{children:[X("div",{onClick:()=>i(!1),className:n.blurAll}),X(o0,{value:o,label:"Country",options:["Country","Canada"],onChange:R}),X(o0,{value:l,label:"Climate",options:["Climate","Tropical"],onChange:D}),X(o0,{value:p,label:"Risk exposure",options:["Risk exposure","Low"],onChange:L}),X(o0,{value:y,label:"Income group",options:["Income group","High"],onChange:O}),X(o0,{value:x,label:"Population group",options:["Population group","High"],onChange:N}),X(o0,{value:T,label:"Rating",options:["Rating","High"],onChange:F}),$e(xr,{style:{color:"white",background:"#2D67FF",gap:"10px"},className:n.filterButton,variant:"outlined",onClick:()=>i(!1),children:["Close",X("img",{style:{height:"1.1vh"},src:"assets/closeIcon.svg",alt:"close"})]})]}):X(xr,{className:n.filterButton,variant:"outlined",onClick:()=>{i(!0)},children:"Filter by"})})},DMe={firstRow:"Choose a city and ",secondRow:"view its ",score:"score",howRatingWorks:"How rating works",map:"Map",graph:"Graph",filterBy:"Filter by",smallTextGraph1:"Urban Resilience Index (URI) is a tool to measure environmental (E), social (S), and governmental (G) performance of urban areas as well as their ability & willingness to achieve better practices.",smallTextGraph2:"URI shows whether the basic needs of residents are satisfied, how vulnerable the place is to crises and how it impacts the world around.",smallTextGraph3:"At the graph color represents the cities' overall ratings (see right scale) while position against E, S and G axes reflects respective component scoring."},OMe=({map:n,currentView:e,setCurrentView:i,isZoomButtonsVisible:o})=>{const s=f=>DMe[f],{classes:l}=JD(),d=ie.useCallback(()=>{i("map")},[]),p=ie.useCallback(()=>{i("graph")},[]);return $e("div",{className:l.root,children:[X("div",{className:l.topLineWrapper,children:$e("div",{className:l.textAndToggleWrapper,children:[$e(Ii,{className:l.bigText,children:[s("firstRow")," ",X("br",{}),s("secondRow"),X("span",{className:l.bigTextBlue,children:s("score")})]}),$e(J_e,{children:[X(gW,{value:"map",selected:e==="map",onClick:d,children:s("map")}),X(gW,{value:"graph",selected:e==="graph",onClick:p,children:s("graph")})]}),!o&&$e(Ii,{className:l.bigTextSubtitle,children:[s("smallTextGraph1")," ",X("br",{}),X("br",{}),s("smallTextGraph2")," ",X("br",{}),X("br",{}),s("smallTextGraph3")]})]})}),X(kMe,{}),X("img",{className:l.legendLine,src:"/assets/legendLine.svg",alt:"legend"}),$e("div",{className:l.bottomWrapper,children:[$e("div",{className:l.smallTextWrapper,children:[X(Ii,{className:l.smallText,children:s("howRatingWorks")}),X("img",{src:"/assets/hintQuestionIcon.svg",alt:"hint"})]}),o&&X(n1e,{map:n})]})]})},NMe=()=>{const n=[new Ue(0,0,0),new Ue(6,0,0)],e=[new Ue(0,0,0),new Ue(0,6,0)],i=[new Ue(0,0,0),new Ue(0,0,6)],o=new ki().setFromPoints(n),s=new ki().setFromPoints(e),l=new ki().setFromPoints(i),d=W6(HZ,"/textures/texture_cage_radial_fade_2.svg");return $e("group",{children:[X("mesh",{position:[4.5,.5,0],children:X(bx,{fontSize:.5,color:"white",children:"Environmental"})}),X("mesh",{position:[.5,5,0],rotation:[0,0,Math.PI/2],children:X(bx,{fontSize:.5,color:"white",children:"Social"})}),X("mesh",{position:[0,.5,4.5],rotation:[0,-Math.PI/2,0],children:X(bx,{fontSize:.5,color:"white",children:"Governmental"})}),$e("group",{children:[X("line",{geometry:o,children:X("lineBasicMaterial",{color:"white"})}),$e("mesh",{position:[6,0,0],rotation:[0,0,-Math.PI/2],children:[X("coneGeometry",{args:[.1,.3,10]}),X("meshBasicMaterial",{color:"white"})]})]}),$e("group",{children:[X("line",{geometry:s,children:X("lineBasicMaterial",{color:"white"})}),$e("mesh",{position:[0,6,0],rotation:[0,0,0],children:[X("coneGeometry",{args:[.1,.3,10]}),X("meshBasicMaterial",{color:"white"})]})]}),$e("group",{children:[X("line",{geometry:l,children:X("lineBasicMaterial",{color:"white"})}),$e("mesh",{position:[0,0,6],rotation:[Math.PI/2,0,0],children:[X("coneGeometry",{args:[.1,.3,10]}),X("meshBasicMaterial",{color:"white"})]})]}),$e("mesh",{position:[0,-.02,0],rotation:[-Math.PI/2,0,0],children:[X("planeGeometry",{args:[16,16]}),X("meshStandardMaterial",{map:d,transparent:!0,opacity:.5,side:jl})]})]})},zMe=([n,e,i])=>{const o=[],s=[],l=[],d=[];for(let f=0;f<=e;f+=.5)o.push({x:n,y:f,z:i});for(let f=0;f<=n;f+=.5)s.push({x:f,y:0,z:i});for(let f=0;f<=i;f+=.5)l.push({x:n,y:0,z:f});for(let f=0;f<=e;f+=.5)d.push({x:n-n/e*f,y:e,z:i-i/e*f});return $e(_s,{children:[o.map(f=>$e("mesh",{position:[f.x-n,f.y-e,f.z-i],children:[X("boxGeometry",{args:[.02,.2,.02]}),X("meshStandardMaterial",{transparent:!0,opacity:.8,color:"white"})]},f.y)),s.map(f=>$e("mesh",{position:[f.x-n,f.y-e,f.z-i],children:[X("boxGeometry",{args:[.2,.02,.02]}),X("meshStandardMaterial",{transparent:!0,opacity:.8,color:"white"})]},f.x)),l.map(f=>$e("mesh",{position:[f.x-n,f.y-e,f.z-i],children:[X("boxGeometry",{args:[.02,.02,.2]}),X("meshStandardMaterial",{transparent:!0,opacity:.8,color:"white"})]},f.z)),d.map(f=>$e("mesh",{rotation:[0,Math.atan2(f.x-n,f.z-i),0],position:[f.x-n,f.y-e,f.z-i],children:[X("boxGeometry",{args:[.02,.02,.2]}),X("meshStandardMaterial",{transparent:!0,opacity:.8,color:"white"})]},f.z))]})},FMe=({item:n,color:e,setSelectedCity:i})=>{const o=ie.useRef(),s=ie.useRef(),l=ie.useRef(),[d,p]=ie.useState(!1),[f,y]=ie.useState(!1);return U6(_=>{s.current.lookAt(_.camera.position),l.current.lookAt(_.camera.position)}),$e("group",{ref:o,position:n.position,children:[$e("mesh",{ref:l,children:[X("torusGeometry",{args:f?[.32,.015,100,100]:[.35,.015,100,100]}),X("meshStandardMaterial",{color:e,transparent:!0,opacity:1})]}),$e("mesh",{onClick:()=>{p(!0),i(n.label)},onPointerMissed:()=>{p(!1)},onPointerOver:()=>{y(!0)},onPointerOut:()=>{y(!1)},children:[X("sphereGeometry",{args:[.2,100,100]}),X("meshStandardMaterial",{color:e})]}),$e("mesh",{ref:s,position:[0,1.5,0],children:[X(bx,{fontSize:.45,color:"white",anchorX:"center",anchorY:"middle",children:f&&n.label}),X(bx,{fontSize:.45,color:e,anchorX:"center",anchorY:"middle",position:[0,-.5,0],children:f&&n.status}),X("meshStandardMaterial",{color:"black"})]}),f&&zMe(n.position)]},n.label)},BMe=({data:n,color:e,setSelectedCity:i})=>{const o=ie.useRef();return U6(({camera:s})=>{s.lookAt(2,-6,0)}),$e("group",{ref:o,position:[2,-10,1],rotation:[0,1,0],children:[X(NMe,{}),n.map(s=>X(FMe,{item:s,color:s.color,setSelectedCity:i},s.label))]})},UMe=[{position:[3,5,5],label:"Dubai",color:"#B7DE86",status:"A-3"},{position:[4,5,5],label:"Expo City Dubai",color:"#75D652",status:"A-2"},{position:[2,2,1],label:"Valparaiso",color:"#FF9B3F",status:"C-1"},{position:[1,1,1],label:"Dar es Salaam",color:"#FF632F",status:"C-2"},{position:[4,1,4],label:"Adoni",color:"#FF632F",status:"C-2"},{position:[4,3,3],label:"Natal",color:"#FFD748",status:"B-2"},{position:[3,1,3],label:"Brazzaville",color:"#FF9B3F",status:"C-1"},{position:[3,2,2],label:"Almaty",color:"#D6E15A",status:"B-1"},{position:[3,3,4],label:"Cape Town",color:"#FFD748",status:"B-2"},{position:[2,2,2],label:"Mexico City",color:"#FF632F",status:"C-2"},{position:[2,3,3],label:"Jakarta",color:"#FFD748",status:"B-3"},{position:[3,4,3],label:"Panama City",color:"#ECE38E",status:"B-1"},{position:[2,4,4],label:"Amman",color:"#ECE38E",status:"B-1"},{position:[2,3,2],label:"Bangkok",color:"#FFD748",status:"B-3"},{position:[3,3,3],label:"Colombo",color:"#FFD748",status:"B-2"}],WMe=({setSelectedCity:n})=>{const{classes:e}=KD();return X("div",{className:e.graph3dWrapper,children:X(ie.Suspense,{fallback:null,children:$e(DEe,{style:{background:"transparent "},camera:{position:[11,11,11],fov:50},children:[X("ambientLight",{intensity:1,castShadow:!0}),X("directionalLight",{intensity:1,position:[10,10,0],castShadow:!0}),X(BMe,{data:UMe,setSelectedCity:n}),X(RMe,{enableZoom:!1,makeDefault:!0,minPolarAngle:Math.PI/4,maxPolarAngle:Math.PI/2,minAzimuthAngle:Math.PI/4,maxAzimuthAngle:Math.PI/2})]})})})};var UK={exports:{}};(function(n,e){(function(i,o){n.exports=o()})(soe,function(){var i,o,s;function l(p,f){if(!i)i=f;else if(!o)o=f;else{var y="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+i+")(sharedChunk); ("+o+")(sharedChunk); self.onerror = null;",_={};i(_),s=f(_),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(s.workerUrl=window.URL.createObjectURL(new Blob([y],{type:"text/javascript"})))}}l(["exports"],function(p){var f=typeof self<"u"?self:{},y="3.0.0-rc.2";let _;const x={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(_==null){const a=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{_={}.API_URL_REGEX!=null?new RegExp({}.API_URL_REGEX):a}catch{_=a}}return _},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!x.API_URL)return null;try{const a=new URL(x.API_URL);return a.hostname==="api.mapbox.cn"?"https://events.mapbox.cn/events/v2":a.hostname==="api.mapbox.com"?"https://events.mapbox.com/events/v2":null}catch{return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,DEFAULT_STYLE:"mapbox://styles/mapbox/standard",MAX_PARALLEL_IMAGE_REQUESTS:16,DRACO_URL:"https://api.mapbox.com/mapbox-gl-js/draco_decoder_gltf_v1.5.6.wasm",GLYPHS_URL:"mapbox://fonts/mapbox/{fontstack}/{range}.pbf"},S={supported:!1,testSupport:function(a){!R&&I&&(D?L(a):T=a)}};let T,I,R=!1,D=!1;function L(a){const t=a.createTexture();a.bindTexture(a.TEXTURE_2D,t);try{if(a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,I),a.isContextLost())return;S.supported=!0}catch{}a.deleteTexture(t),R=!0}f.document&&(I=f.document.createElement("img"),I.onload=function(){T&&L(T),T=null,D=!0},I.onerror=function(){R=!0,T=null},I.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const O="01";function N(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}var F=G;function G(a,t,r,c){this.cx=3*a,this.bx=3*(r-a)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(c-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=a,this.p1y=t,this.p2x=r,this.p2y=c}G.prototype={sampleCurveX:function(a){return((this.ax*a+this.bx)*a+this.cx)*a},sampleCurveY:function(a){return((this.ay*a+this.by)*a+this.cy)*a},sampleCurveDerivativeX:function(a){return(3*this.ax*a+2*this.bx)*a+this.cx},solveCurveX:function(a,t){if(t===void 0&&(t=1e-6),a<0)return 0;if(a>1)return 1;for(var r=a,c=0;c<8;c++){var u=this.sampleCurveX(r)-a;if(Math.abs(u)<t)return r;var h=this.sampleCurveDerivativeX(r);if(Math.abs(h)<1e-6)break;r-=u/h}var m=0,g=1;for(r=a,c=0;c<20&&(u=this.sampleCurveX(r),!(Math.abs(u-a)<t));c++)a>u?m=r:g=r,r=.5*(g-m)+m;return r},solve:function(a,t){return this.sampleCurveY(this.solveCurveX(a,t))}};var j=N(F),Y=te;function te(a,t){this.x=a,this.y=t}te.prototype={clone:function(){return new te(this.x,this.y)},add:function(a){return this.clone()._add(a)},sub:function(a){return this.clone()._sub(a)},multByPoint:function(a){return this.clone()._multByPoint(a)},divByPoint:function(a){return this.clone()._divByPoint(a)},mult:function(a){return this.clone()._mult(a)},div:function(a){return this.clone()._div(a)},rotate:function(a){return this.clone()._rotate(a)},rotateAround:function(a,t){return this.clone()._rotateAround(a,t)},matMult:function(a){return this.clone()._matMult(a)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(a){return this.x===a.x&&this.y===a.y},dist:function(a){return Math.sqrt(this.distSqr(a))},distSqr:function(a){var t=a.x-this.x,r=a.y-this.y;return t*t+r*r},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(a){return Math.atan2(this.y-a.y,this.x-a.x)},angleWith:function(a){return this.angleWithSep(a.x,a.y)},angleWithSep:function(a,t){return Math.atan2(this.x*t-this.y*a,this.x*a+this.y*t)},_matMult:function(a){var t=a[2]*this.x+a[3]*this.y;return this.x=a[0]*this.x+a[1]*this.y,this.y=t,this},_add:function(a){return this.x+=a.x,this.y+=a.y,this},_sub:function(a){return this.x-=a.x,this.y-=a.y,this},_mult:function(a){return this.x*=a,this.y*=a,this},_div:function(a){return this.x/=a,this.y/=a,this},_multByPoint:function(a){return this.x*=a.x,this.y*=a.y,this},_divByPoint:function(a){return this.x/=a.x,this.y/=a.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var a=this.y;return this.y=this.x,this.x=-a,this},_rotate:function(a){var t=Math.cos(a),r=Math.sin(a),c=r*this.x+t*this.y;return this.x=t*this.x-r*this.y,this.y=c,this},_rotateAround:function(a,t){var r=Math.cos(a),c=Math.sin(a),u=t.y+c*(this.x-t.x)+r*(this.y-t.y);return this.x=t.x+r*(this.x-t.x)-c*(this.y-t.y),this.y=u,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},te.convert=function(a){return a instanceof te?a:Array.isArray(a)?new te(a[0],a[1]):a};var V=N(Y);function Q(a,t){if(Array.isArray(a)){if(!Array.isArray(t)||a.length!==t.length)return!1;for(let r=0;r<a.length;r++)if(!Q(a[r],t[r]))return!1;return!0}if(typeof a=="object"&&a!==null&&t!==null){if(typeof t!="object"||Object.keys(a).length!==Object.keys(t).length)return!1;for(const r in a)if(!Q(a[r],t[r]))return!1;return!0}return a===t}const he=Math.PI/180,fe=180/Math.PI;function ye(a){return a*he}function pe(a){return a*fe}const Me=[[0,0],[1,0],[1,1],[0,1]];function Ie(a){if(a<=0)return 0;if(a>=1)return 1;const t=a*a,r=t*a;return 4*(a<.5?r:3*(a-t)+r-.75)}function ze(a){let t=1/0,r=1/0,c=-1/0,u=-1/0;for(const h of a)t=Math.min(t,h.x),r=Math.min(r,h.y),c=Math.max(c,h.x),u=Math.max(u,h.y);return{min:new V(t,r),max:new V(c,u)}}function le(a,t,r=0,c=!0){const u=new V(r,r),h=a.sub(u),m=t.add(u),g=[h,new V(m.x,h.y),m,new V(h.x,m.y)];return c&&g.push(h.clone()),g}function me(a,t,r,c){const u=new j(a,t,r,c);return function(h){return u.solve(h)}}const xe=me(.25,.1,.25,1);function ae(a,t,r){return Math.min(r,Math.max(t,a))}function Ee(a,t,r){return(r=ae((r-a)/(t-a),0,1))*r*(3-2*r)}function Je(a,t,r){const c=r-t,u=((a-t)%c+c)%c+t;return u===t?r:u}function Ze(a,t,r){if(!a.length)return r(null,[]);let c=a.length;const u=new Array(a.length);let h=null;a.forEach((m,g)=>{t(m,(v,b)=>{v&&(h=v),u[g]=b,--c==0&&r(h,u)})})}function Ke(a){const t=[];for(const r in a)t.push(a[r]);return t}function Fe(a,...t){for(const r of t)for(const c in r)a[c]=r[c];return a}function ct(a,t){const r={};for(let c=0;c<t.length;c++){const u=t[c];u in a&&(r[u]=a[u])}return r}let Ct=1;function kt(){return Ct++}function Kt(){return function a(t){return t?(t^Math.random()*(16>>t/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,a)}()}function At(a){return a<=1?1:Math.pow(2,Math.ceil(Math.log(a)/Math.LN2))}function Pe(a){return!!a&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(a)}function ft(a,t){a.forEach(r=>{t[r]&&(t[r]=t[r].bind(t))})}function gt(a,t){return a.indexOf(t,a.length-t.length)!==-1}function _t(a,t,r){const c={};for(const u in a)c[u]=t.call(r||this,a[u],u,a);return c}function Be(a,t,r){const c={};for(const u in a)t.call(r||this,a[u],u,a)&&(c[u]=a[u]);return c}function ue(a){return Array.isArray(a)?a.map(ue):typeof a=="object"&&a?_t(a,ue):a}const se={};function _e(a){se[a]||(typeof console<"u"&&console.warn(a),se[a]=!0)}function je(a,t,r){return(r.y-a.y)*(t.x-a.x)>(t.y-a.y)*(r.x-a.x)}function De(a){let t=0;for(let r,c,u=0,h=a.length,m=h-1;u<h;m=u++)r=a[u],c=a[m],t+=(c.x-r.x)*(r.y+c.y);return t}function st([a,t,r]){const c=ye(t+90),u=ye(r);return{x:a*Math.cos(c)*Math.sin(u),y:a*Math.sin(c)*Math.sin(u),z:a*Math.cos(u),azimuthal:t,polar:r}}function de(a,t,r){const c=Math.sqrt(a*a+t*t+r*r),u=c>0?Math.acos(r/c)*fe:0;let h=a!==0||t!==0?Math.atan2(-t,-a)*fe+90:0;return h<0&&(h+=360),[c,h,u]}function ne(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function Oe(a){const t={};if(a.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(r,c,u,h)=>{const m=u||h;return t[c]=!m||m.toLowerCase(),""}),t["max-age"]){const r=parseInt(t["max-age"],10);isNaN(r)?delete t["max-age"]:t["max-age"]=r}return t}let ut=null;function it(){return!!f.document.fullscreenElement||!!f.document.webkitFullscreenElement}function lt(a){try{const t=f[a];return t.setItem("_mapbox_test_",1),t.removeItem("_mapbox_test_"),!0}catch{return!1}}function Et(a,t){return[a[4*t],a[4*t+1],a[4*t+2],a[4*t+3]]}function Ut(a,t,r){a[4*t+0]=r[0],a[4*t+1]=r[1],a[4*t+2]=r[2],a[4*t+3]=r[3]}function Wt(a,t){return[Math.pow(a[0],2.2)*t,Math.pow(a[1],2.2)*t,Math.pow(a[2],2.2)*t]}function Ht(a){return[Math.pow(a[0],1/2.2),Math.pow(a[1],1/2.2),Math.pow(a[2],1/2.2)]}const Dt="mapbox-tiles";let wt=500,Xt=50,He,Pt;function qt(){try{return f.caches}catch{}}function Nt(){qt()&&!He&&(He=f.caches.open(Dt))}function hn(a){const t=a.indexOf("?");if(t<0)return a;const r=function(u){const h=u.indexOf("?");return h>0?u.slice(h+1).split("&"):[]}(a),c=r.filter(u=>{const h=u.split("=");return h[0]==="language"||h[0]==="worldview"});return c.length?`${a.slice(0,t)}?${c.join("&")}`:a.slice(0,t)}let be=1/0;function Qe(a){be++,be>Xt&&(a.getActor().send("enforceCacheSizeLimit",wt),be=0)}const we={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image",Model:"Model"};typeof Object.freeze=="function"&&Object.freeze(we);class Te extends Error{constructor(t,r,c){r===401&&Vn(c)&&(t+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(t),this.status=r,this.url=c}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const Ne=ne()?()=>self.worker&&self.worker.referrer:()=>(f.location.protocol==="blob:"?f.parent:f).location.href,et=function(a,t){if(!(/^file:/.test(r=a.url)||/^file:/.test(Ne())&&!/^\w+:/.test(r))){if(f.fetch&&f.Request&&f.AbortController&&f.Request.prototype.hasOwnProperty("signal"))return function(c,u){const h=new f.AbortController,m=new f.Request(c.url,{method:c.method||"GET",body:c.body,credentials:c.credentials,headers:c.headers,referrer:Ne(),referrerPolicy:c.referrerPolicy,signal:h.signal});let g=!1,v=!1;const b=(w=m.url).indexOf("sku=")>0&&Vn(w);var w;c.type==="json"&&m.headers.set("Accept","application/json");const A=(P,k,z)=>{if(v)return;if(P&&P.message!=="SecurityError"&&_e(P.toString()),k&&z)return C(k);const U=Date.now();f.fetch(m).then(W=>{if(W.ok){const $=b?W.clone():null;return C(W,$,U)}return u(new Te(W.statusText,W.status,c.url))}).catch(W=>{W.name!=="AbortError"&&u(new Error(`${W.message} ${c.url}`))})},C=(P,k,z)=>{(c.type==="arrayBuffer"?P.arrayBuffer():c.type==="json"?P.json():P.text()).then(U=>{v||(k&&z&&function(W,$,Z){if(Nt(),!He)return;const K={status:$.status,statusText:$.statusText,headers:new f.Headers};$.headers.forEach((re,ce)=>K.headers.set(ce,re));const q=Oe($.headers.get("Cache-Control")||"");if(q["no-store"])return;q["max-age"]&&K.headers.set("Expires",new Date(Z+1e3*q["max-age"]).toUTCString());const J=K.headers.get("Expires");J&&(new Date(J).getTime()-Z<42e4||function(re,ce){if(Pt===void 0)try{new Response(new ReadableStream),Pt=!0}catch{Pt=!1}Pt?ce(re.body):re.blob().then(ce)}($,re=>{const ce=new f.Response(re,K);Nt(),He&&He.then(ge=>ge.put(hn(W.url),ce)).catch(ge=>_e(ge.message))}))}(m,k,z),g=!0,u(null,U,P.headers.get("Cache-Control"),P.headers.get("Expires")))}).catch(U=>{v||u(new Error(U.message))})};return b?function(P,k){if(Nt(),!He)return k(null);const z=hn(P.url);He.then(U=>{U.match(z).then(W=>{const $=function(Z){if(!Z)return!1;const K=new Date(Z.headers.get("Expires")||0),q=Oe(Z.headers.get("Cache-Control")||"");return K>Date.now()&&!q["no-cache"]}(W);U.delete(z),$&&U.put(z,W.clone()),k(null,W,$)}).catch(k)}).catch(k)}(m,A):A(null,null),{cancel:()=>{v=!0,g||h.abort()}}}(a,t);if(ne()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",a,t,void 0,!0)}var r;return function(c,u){const h=new f.XMLHttpRequest;h.open(c.method||"GET",c.url,!0),c.type==="arrayBuffer"&&(h.responseType="arraybuffer");for(const m in c.headers)h.setRequestHeader(m,c.headers[m]);return c.type==="json"&&(h.responseType="text",h.setRequestHeader("Accept","application/json")),h.withCredentials=c.credentials==="include",h.onerror=()=>{u(new Error(h.statusText))},h.onload=()=>{if((h.status>=200&&h.status<300||h.status===0)&&h.response!==null){let m=h.response;if(c.type==="json")try{m=JSON.parse(h.response)}catch(g){return u(g)}u(null,m,h.getResponseHeader("Cache-Control"),h.getResponseHeader("Expires"))}else u(new Te(h.statusText,h.status,c.url))},h.send(c.body),{cancel:()=>h.abort()}}(a,t)},tt=function(a,t){return et(Fe(a,{type:"json"}),t)},vt=function(a,t){return et(Fe(a,{type:"arrayBuffer"}),t)};function ht(a){const t=f.document.createElement("a");return t.href=a,t.protocol===f.document.location.protocol&&t.host===f.document.location.host}const dt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let Vt,It;Vt=[],It=0;const Qt=function(a,t){if(S.supported&&(a.headers||(a.headers={}),a.headers.accept="image/webp,*/*"),It>=x.MAX_PARALLEL_IMAGE_REQUESTS){const h={requestParameters:a,callback:t,cancelled:!1,cancel(){this.cancelled=!0}};return Vt.push(h),h}It++;let r=!1;const c=()=>{if(!r)for(r=!0,It--;Vt.length&&It<x.MAX_PARALLEL_IMAGE_REQUESTS;){const h=Vt.shift(),{requestParameters:m,callback:g,cancelled:v}=h;v||(h.cancel=Qt(m,g).cancel)}},u=vt(a,(h,m,g,v)=>{c(),h?t(h):m&&(f.createImageBitmap?function(b,w){const A=new f.Blob([new Uint8Array(b)],{type:"image/png"});f.createImageBitmap(A).then(C=>{w(null,C)}).catch(C=>{w(new Error(`Could not load image because of ${C.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(m,(b,w)=>t(b,w,g,v)):function(b,w){const A=new f.Image,C=f.URL;A.onload=()=>{w(null,A),C.revokeObjectURL(A.src),A.onload=null,f.requestAnimationFrame(()=>{A.src=dt})},A.onerror=()=>w(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const P=new f.Blob([new Uint8Array(b)],{type:"image/png"});A.src=b.byteLength?C.createObjectURL(P):dt}(m,(b,w)=>t(b,w,g,v)))});return{cancel:()=>{u.cancel(),c()}}},fn="NO_ACCESS_TOKEN";class en{constructor(t,r,c){this._transformRequestFn=t,this._customAccessToken=r,this._silenceAuthErrors=!!c,this._createSkuToken()}_createSkuToken(){const t=function(){let r="";for(let c=0;c<10;c++)r+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",O,r].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=t.token,this._skuTokenExpiresAt=t.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(t,r){return this._transformRequestFn&&this._transformRequestFn(t,r)||{url:t}}normalizeStyleURL(t,r){if(!vn(t))return t;const c=na(t);return c.params.push(`sdk=js-${y}`),c.path=`/styles/v1${c.path}`,this._makeAPIURL(c,this._customAccessToken||r)}normalizeGlyphsURL(t,r){if(!vn(t))return t;const c=na(t);return c.path=`/fonts/v1${c.path}`,this._makeAPIURL(c,this._customAccessToken||r)}normalizeModelURL(t,r){if(!vn(t))return t;const c=na(t);return c.path=`/models/v1${c.path}`,this._makeAPIURL(c,this._customAccessToken||r)}normalizeSourceURL(t,r,c,u){if(!vn(t))return t;const h=na(t);return h.path=`/v4/${h.authority}.json`,h.params.push("secure"),c&&h.params.push(`language=${c}`),u&&h.params.push(`worldview=${u}`),this._makeAPIURL(h,this._customAccessToken||r)}normalizeSpriteURL(t,r,c,u){const h=na(t);return vn(t)?(h.path=`/styles/v1${h.path}/sprite${r}${c}`,this._makeAPIURL(h,this._customAccessToken||u)):(h.path+=`${r}${c}`,Re(h))}normalizeTileURL(t,r,c){if(this._isSkuTokenExpired()&&this._createSkuToken(),t&&!vn(t))return t;const u=na(t);u.path=u.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${r||c&&u.authority!=="raster"&&c===512?"@2x":""}${S.supported?".webp":"$1"}`),u.authority==="raster"?u.path=`/${x.RASTER_URL_PREFIX}${u.path}`:(u.path=u.path.replace(/^.+\/v4\//,"/"),u.path=`/${x.TILE_URL_VERSION}${u.path}`);const h=this._customAccessToken||function(m){for(const g of m){const v=g.match(/^access_token=(.*)$/);if(v)return v[1]}return null}(u.params)||x.ACCESS_TOKEN;return x.REQUIRE_ACCESS_TOKEN&&h&&this._skuToken&&u.params.push(`sku=${this._skuToken}`),this._makeAPIURL(u,h)}canonicalizeTileURL(t,r){const c=na(t);if(!c.path.match(/^(\/v4\/|\/raster\/v1\/)/)||!c.path.match(/\.[\w]+$/))return t;let u="mapbox://";c.path.match(/^\/raster\/v1\//)?u+=`raster/${c.path.replace(`/${x.RASTER_URL_PREFIX}/`,"")}`:u+=`tiles/${c.path.replace(`/${x.TILE_URL_VERSION}/`,"")}`;let h=c.params;return r&&(h=h.filter(m=>!m.match(/^access_token=/))),h.length&&(u+=`?${h.join("&")}`),u}canonicalizeTileset(t,r){const c=!!r&&vn(r),u=[];for(const h of t.tiles||[])Vn(h)?u.push(this.canonicalizeTileURL(h,c)):u.push(h);return u}_makeAPIURL(t,r){const c="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",u=na(x.API_URL);if(t.protocol=u.protocol,t.authority=u.authority,t.protocol==="http"){const h=t.params.indexOf("secure");h>=0&&t.params.splice(h,1)}if(u.path!=="/"&&(t.path=`${u.path}${t.path}`),!x.REQUIRE_ACCESS_TOKEN)return Re(t);if(r=r||x.ACCESS_TOKEN,!this._silenceAuthErrors){if(!r)throw new Error(`An API access token is required to use Mapbox GL. ${c}`);if(r[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${c}`)}return t.params=t.params.filter(h=>h.indexOf("access_token")===-1),t.params.push(`access_token=${r||""}`),Re(t)}}function vn(a){return a.indexOf("mapbox:")===0}function Vn(a){return x.API_URL_REGEX.test(a)}function ei(a){return x.API_CDN_URL_REGEX.test(a)}function xi(a){return x.API_STYLE_REGEX.test(a)&&!wi(a)}function wi(a){return x.API_SPRITE_REGEX.test(a)}const pa=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function na(a){const t=a.match(pa);if(!t)throw new Error("Unable to parse URL object");return{protocol:t[1],authority:t[2],path:t[3]||"/",params:t[4]?t[4].split("&"):[]}}function Re(a){const t=a.params.length?`?${a.params.join("&")}`:"";return`${a.protocol}://${a.authority}${a.path}${t}`}const bt="mapbox.eventData";function Ot(a){if(!a)return null;const t=a.split(".");if(!t||t.length!==3)return null;try{return JSON.parse(decodeURIComponent(f.atob(t[1]).split("").map(r=>"%"+("00"+r.charCodeAt(0).toString(16)).slice(-2)).join("")))}catch{return null}}class Lt{constructor(t){this.type=t,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(t){const r=Ot(x.ACCESS_TOKEN);let c="";return c=r&&r.u?f.btoa(encodeURIComponent(r.u).replace(/%([0-9A-F]{2})/g,(u,h)=>String.fromCharCode(+("0x"+h)))):x.ACCESS_TOKEN||"",t?`${bt}.${t}:${c}`:`${bt}:${c}`}fetchEventData(){const t=lt("localStorage"),r=this.getStorageKey(),c=this.getStorageKey("uuid");if(t)try{const u=f.localStorage.getItem(r);u&&(this.eventData=JSON.parse(u));const h=f.localStorage.getItem(c);h&&(this.anonId=h)}catch{_e("Unable to read from LocalStorage")}}saveEventData(){const t=lt("localStorage"),r=this.getStorageKey(),c=this.getStorageKey("uuid");if(t)try{f.localStorage.setItem(c,this.anonId),Object.keys(this.eventData).length>=1&&f.localStorage.setItem(r,JSON.stringify(this.eventData))}catch{_e("Unable to write to LocalStorage")}}processRequests(t){}postEvent(t,r,c,u){if(!x.EVENTS_URL)return;const h=na(x.EVENTS_URL);h.params.push(`access_token=${u||x.ACCESS_TOKEN||""}`);const m={event:this.type,created:new Date(t).toISOString()},g=r?Fe(m,r):m,v={url:Re(h),headers:{"Content-Type":"text/plain"},body:JSON.stringify([g])};this.pendingRequest=function(b,w){return et(Fe(b,{method:"POST"}),w)}(v,b=>{this.pendingRequest=null,c(b),this.saveEventData(),this.processRequests(u)})}queueRequest(t,r){this.queue.push(t),this.processRequests(r)}}const zt=new class extends Lt{constructor(a){super("appUserTurnstile"),this._customAccessToken=a}postTurnstileEvent(a,t){x.EVENTS_URL&&x.ACCESS_TOKEN&&Array.isArray(a)&&a.some(r=>vn(r)||Vn(r))&&this.queueRequest(Date.now(),t)}processRequests(a){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const t=Ot(x.ACCESS_TOKEN),r=t?t.u:x.ACCESS_TOKEN;let c=r!==this.eventData.tokenU;Pe(this.anonId)||(this.anonId=Kt(),c=!0);const u=this.queue.shift();if(this.eventData.lastSuccess){const h=new Date(this.eventData.lastSuccess),m=new Date(u),g=(u-this.eventData.lastSuccess)/864e5;c=c||g>=1||g<-1||h.getDate()!==m.getDate()}else c=!0;c?this.postEvent(u,{sdkIdentifier:"mapbox-gl-js",sdkVersion:y,skuId:O,"enabled.telemetry":!1,userId:this.anonId},h=>{h||(this.eventData.lastSuccess=u,this.eventData.tokenU=r)},a):this.processRequests()}},jt=zt.postTurnstileEvent.bind(zt),gn=new class extends Lt{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(a,t,r,c){this.skuToken=t,this.errorCb=c,x.EVENTS_URL&&(r||x.ACCESS_TOKEN?this.queueRequest({id:a,timestamp:Date.now()},r):this.errorCb(new Error(fn)))}processRequests(a){if(this.pendingRequest||this.queue.length===0)return;const{id:t,timestamp:r}=this.queue.shift();t&&this.success[t]||(this.anonId||this.fetchEventData(),Pe(this.anonId)||(this.anonId=Kt()),this.postEvent(r,{sdkIdentifier:"mapbox-gl-js",sdkVersion:y,skuId:O,skuToken:this.skuToken,userId:this.anonId},c=>{c?this.errorCb(c):t&&(this.success[t]=!0)},a))}},Xn=gn.postMapLoadEvent.bind(gn),rn=new class extends Lt{constructor(){super("gljs.performance")}postPerformanceEvent(a,t){x.EVENTS_URL&&(a||x.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:t},a)}processRequests(a){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:t,performanceData:r}=this.queue.shift(),c=function(u){const h=f.performance.getEntriesByType("resource"),m=f.performance.getEntriesByType("mark"),g=function(C){const P={};if(C){for(const k in C)if(k!=="other")for(const z of C[k]){const U=`${k}ResolveRangeMin`,W=`${k}ResolveRangeMax`,$=`${k}RequestCount`,Z=`${k}RequestCachedCount`;P[U]=Math.min(P[U]||1/0,z.startTime),P[W]=Math.max(P[W]||-1/0,z.responseEnd);const K=q=>{P[q]===void 0&&(P[q]=0),++P[q]};z.transferSize!==void 0&&z.transferSize===0&&K(Z),K($)}}return P}(function(C,P){const k={};if(C)for(const z of C){const U=P(z);k[U]===void 0&&(k[U]=[]),k[U].push(z)}return k}(h,ri)),v=f.devicePixelRatio,b=f.navigator.connection||f.navigator.mozConnection||f.navigator.webkitConnection,w={counters:[],metadata:[],attributes:[]},A=(C,P,k)=>{k!=null&&C.push({name:P,value:k.toString()})};for(const C in g)A(w.counters,C,g[C]);if(u.interactionRange[0]!==1/0&&u.interactionRange[1]!==-1/0&&(A(w.counters,"interactionRangeMin",u.interactionRange[0]),A(w.counters,"interactionRangeMax",u.interactionRange[1])),m)for(const C of Object.keys(ia)){const P=ia[C],k=m.find(z=>z.name===P);k&&A(w.counters,P,k.startTime)}return A(w.counters,"visibilityHidden",u.visibilityHidden),A(w.attributes,"style",function(C){if(C)for(const P of C){const k=P.name.split("?")[0];if(xi(k)){const z=k.split("/").slice(-2);if(z.length===2)return`mapbox://styles/${z[0]}/${z[1]}`}}}(h)),A(w.attributes,"terrainEnabled",u.terrainEnabled?"true":"false"),A(w.attributes,"fogEnabled",u.fogEnabled?"true":"false"),A(w.attributes,"projection",u.projection),A(w.attributes,"zoom",u.zoom),A(w.metadata,"devicePixelRatio",v),A(w.metadata,"connectionEffectiveType",b?b.effectiveType:void 0),A(w.metadata,"navigatorUserAgent",f.navigator.userAgent),A(w.metadata,"screenWidth",f.screen.width),A(w.metadata,"screenHeight",f.screen.height),A(w.metadata,"windowWidth",f.innerWidth),A(w.metadata,"windowHeight",f.innerHeight),A(w.metadata,"mapWidth",u.width/v),A(w.metadata,"mapHeight",u.height/v),A(w.metadata,"webglRenderer",u.renderer),A(w.metadata,"webglVendor",u.vendor),A(w.metadata,"sdkVersion",y),A(w.metadata,"sdkIdentifier","mapbox-gl-js"),w}(r);for(const u of c.metadata);for(const u of c.counters);for(const u of c.attributes);this.postEvent(t,c,()=>{},a)}},di=rn.postPerformanceEvent.bind(rn),gi=new class extends Lt{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(a,t,r,c){if(!x.API_URL||!x.SESSION_PATH)return;const u=na(x.API_URL+x.SESSION_PATH);u.params.push(`sku=${t||""}`),u.params.push(`access_token=${c||x.ACCESS_TOKEN||""}`);const h={url:Re(u),headers:{"Content-Type":"text/plain"}};this.pendingRequest=function(m,g){return et(Fe(m,{method:"GET"}),g)}(h,m=>{this.pendingRequest=null,r(m),this.saveEventData(),this.processRequests(c)})}getSessionAPI(a,t,r,c){this.skuToken=t,this.errorCb=c,x.SESSION_PATH&&x.API_URL&&(r||x.ACCESS_TOKEN?this.queueRequest({id:a,timestamp:Date.now()},r):this.errorCb(new Error(fn)))}processRequests(a){if(this.pendingRequest||this.queue.length===0)return;const{id:t,timestamp:r}=this.queue.shift();t&&this.success[t]||this.getSession(r,this.skuToken,c=>{c?this.errorCb(c):t&&(this.success[t]=!0)},a)}},li=gi.getSessionAPI.bind(gi),ra=new Set;function wr(a,t){t?ra.add(a):ra.delete(a)}const ia={create:"create",load:"load",fullLoad:"fullLoad"},Ka={mark(a){f.performance.mark(a)},measure(a,t,r){f.performance.measure(a,t,r)}};function ri(a){const t=a.name.split("?")[0];return ei(t)&&t.includes("mapbox-gl.js")?"javascript":ei(t)&&t.includes("mapbox-gl.css")?"css":function(r){return x.API_FONTS_REGEX.test(r)}(t)?"fontRange":wi(t)?"sprite":xi(t)?"style":function(r){return x.API_TILEJSON_REGEX.test(r)}(t)?"tilejson":"other"}const Rn=f.performance;function uo(a){const t=a?a.url.toString():void 0;return Rn.getEntriesByName(t)}var Di=Ia;function Ia(a){return!function(t){return typeof window>"u"||typeof document>"u"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var c,u,h=new Blob([""],{type:"text/javascript"}),m=URL.createObjectURL(h);try{u=new Worker(m),c=!0}catch{c=!1}return u&&u.terminate(),URL.revokeObjectURL(m),c}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var c=document.createElement("canvas");c.width=c.height=1;var u=c.getContext("2d");if(!u)return!1;var h=u.getImageData(0,0,1,1);return h&&h.width===c.width}()?(Go[r=t&&t.failIfMajorPerformanceCaveat]===void 0&&(Go[r]=function(c){var u,h=function(m){var g=document.createElement("canvas"),v=Object.create(Ia.webGLContextAttributes);return v.failIfMajorPerformanceCaveat=m,g.getContext("webgl",v)||g.getContext("experimental-webgl",v)}(c);if(!h)return!1;try{u=h.createShader(h.VERTEX_SHADER)}catch{return!1}return!(!u||h.isContextLost())&&(h.shaderSource(u,"void main() {}"),h.compileShader(u),h.getShaderParameter(u,h.COMPILE_STATUS)===!0)}(r)),Go[r]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var r}(a)}var Go={};let Sr,Ja,fa,zr;Ia.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const Cn={now:()=>fa!==void 0?fa:f.performance.now(),setNow(a){fa=a},restoreNow(){fa=void 0},frame(a){const t=f.requestAnimationFrame(a);return{cancel:()=>f.cancelAnimationFrame(t)}},getImageData(a,t=0){const{width:r,height:c}=a;zr||(zr=f.document.createElement("canvas"));const u=zr.getContext("2d",{willReadFrequently:!0});if(!u)throw new Error("failed to create canvas 2d context");return(r>zr.width||c>zr.height)&&(zr.width=r,zr.height=c),u.clearRect(-t,-t,r+2*t,c+2*t),u.drawImage(a,0,0,r,c),u.getImageData(-t,-t,r+2*t,c+2*t)},resolveURL:a=>(Sr||(Sr=f.document.createElement("a")),Sr.href=a,Sr.href),get devicePixelRatio(){return f.devicePixelRatio},get prefersReducedMotion(){return!!f.matchMedia&&(Ja==null&&(Ja=f.matchMedia("(prefers-reduced-motion: reduce)")),Ja.matches)}};function Jn(a,t,r){const c=f.document.createElement(a);return t!==void 0&&(c.className=t),r&&r.appendChild(c),c}function ja(a,t,r){const c=f.document.createElementNS("http://www.w3.org/2000/svg",a);for(const u of Object.keys(t))c.setAttributeNS(null,u,t[u]);return r&&r.appendChild(c),c}const Ar=f.document&&f.document.documentElement.style,Ts=Ar&&Ar.userSelect!==void 0?"userSelect":"WebkitUserSelect";let wu;function Nf(){Ar&&Ts&&(wu=Ar[Ts],Ar[Ts]="none")}function ic(){Ar&&Ts&&(Ar[Ts]=wu)}function Cl(a){a.preventDefault(),a.stopPropagation(),f.removeEventListener("click",Cl,!0)}function Pl(){f.addEventListener("click",Cl,!0),f.setTimeout(()=>{f.removeEventListener("click",Cl,!0)},0)}function Il(a,t){const r=a.getBoundingClientRect();return ac(a,r,t)}function Pd(a,t){const r=a.getBoundingClientRect(),c=[];for(let u=0;u<t.length;u++)c.push(ac(a,r,t[u]));return c}function Zh(a){return f.InstallTrigger!==void 0&&a.button===2&&a.ctrlKey&&f.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:a.button}function ac(a,t,r){const c=a.offsetWidth===t.width?1:a.offsetWidth/t.width;return new V((r.clientX-t.left)*c,(r.clientY-t.top)*c)}function Id(a,t,r){r[a]&&r[a].indexOf(t)!==-1||(r[a]=r[a]||[],r[a].push(t))}function Xs(a,t,r){if(r&&r[a]){const c=r[a].indexOf(t);c!==-1&&r[a].splice(c,1)}}class $t{constructor(t,r={}){Fe(this,r),this.type=t}}class bn extends $t{constructor(t,r={}){super("error",Fe({error:t},r))}}class Un{on(t,r){return this._listeners=this._listeners||{},Id(t,r,this._listeners),this}off(t,r){return Xs(t,r,this._listeners),Xs(t,r,this._oneTimeListeners),this}once(t,r){return r?(this._oneTimeListeners=this._oneTimeListeners||{},Id(t,r,this._oneTimeListeners),this):new Promise(c=>this.once(t,c))}fire(t,r){typeof t=="string"&&(t=new $t(t,r||{}));const c=t.type;if(this.listens(c)){t.target=this;const u=this._listeners&&this._listeners[c]?this._listeners[c].slice():[];for(const g of u)g.call(this,t);const h=this._oneTimeListeners&&this._oneTimeListeners[c]?this._oneTimeListeners[c].slice():[];for(const g of h)Xs(c,g,this._oneTimeListeners),g.call(this,t);const m=this._eventedParent;m&&(Fe(t,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),m.fire(t))}else t instanceof bn&&console.error(t.error);return this}listens(t){return!!(this._listeners&&this._listeners[t]&&this._listeners[t].length>0||this._oneTimeListeners&&this._oneTimeListeners[t]&&this._oneTimeListeners[t].length>0||this._eventedParent&&this._eventedParent.listens(t))}setEventedParent(t,r){return this._eventedParent=t,this._eventedParentData=r,this}}var at=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"fragment":{"type":"boolean"},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360},"pitch":{"type":"number","default":0},"light":{"type":"light"},"lights":{"required":false,"type":"array","value":"light-3d"},"terrain":{"type":"terrain"},"fog":{"type":"fog"},"camera":{"type":"camera"},"imports":{"type":"array","value":"import"},"schema":{"type":"schema"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string","default":"mapbox://fonts/mapbox/{fontstack}/{range}.pbf"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"},"models":{"type":"models"}},"model":{"type":"string","required":true},"import":{"id":{"type":"string","required":true},"url":{"type":"string","required":true},"config":{"type":"config"},"data":{"type":"$root"}},"config":{"*":{"type":"*"}},"schema":{"*":{"type":"option"}},"option":{"default":{"type":"*","required":true},"type":{"type":"enum","values":{"string":1,"number":1,"boolean":1,"color":1}},"array":{"type":"boolean"},"minValue":{"type":"number"},"maxValue":{"type":"number"},"stepValue":{"type":"number"},"values":{"type":"array","value":"*"},"metadata":{"type":"*"}},"models":{"*":{"type":"model"}},"light-3d":{"id":{"type":"string","required":true},"properties":{"type":"properties"},"type":{"type":"enum","values":{"ambient":{},"directional":{},"flat":{}}}},"properties":["properties_light_directional","properties_light_ambient","properties_light_flat"],"properties_light_directional":{"direction":{"type":"array","default":[210,30],"minimum":[0,0],"maximum":[360,90],"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"cast-shadows":{"type":"boolean","default":false,"expression":{},"property-type":"data-constant"},"shadow-intensity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_ambient":{"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_flat":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"property-type":"data-constant","expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image","source_model"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":1,"mapbox":1},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":1}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":1}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":1}},"url":{"required":false,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_model":{"type":{"required":true,"type":"enum","values":{"model":1,"batched-model":1}},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"tiles":{"type":"array","value":"string"}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"hillshade":{},"model":{},"background":{},"sky":{},"slot":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"slot":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky","layout_model"],"layout_background":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_model":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"model-id":{"type":"string","default":"","property-type":"data-driven","expression":{"parameters":["zoom","feature"]}}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":1,"round":1,"square":1},"default":"butt","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":1,"round":1,"miter":1},"default":"miter","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":1,"line":1,"line-center":1},"default":"point","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":1,"viewport-y":1,"source":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-z-elevate":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":1,"width":1,"height":1,"both":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":1,"left":1,"center":1,"right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","default":0,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":1,"vertical":1},"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":1,"uppercase":1,"lowercase":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":1,"!=":1,">":1,">=":1,"<":1,"<=":1,"in":1,"!in":1,"all":1,"any":1,"none":1,"has":1,"!has":1}},"geometry_type":{"type":"enum","values":{"Point":1,"LineString":1,"Polygon":1}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":1,"exponential":1,"interval":1,"categorical":1},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":1,"lab":1,"hcl":1},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vertical-range":{"type":"array","default":[0,0],"minimum":0,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}}},"camera":{"camera-projection":{"type":"enum","values":{"perspective":1,"orthographic":1},"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"default":"perspective","property-type":"data-constant"}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"property-type":"data-constant","expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":1,"equalEarth":1,"equirectangular":1,"lambertConformalConic":1,"mercator":1,"naturalEarth":1,"winkelTripel":1,"globe":1},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky","paint_model"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","private":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-wall-radius":{"property-type":"data-constant","type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-radius":{"property-type":"data-constant","type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-attenuation":{"property-type":"data-constant","type":"number","default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-flood-light-color":{"property-type":"data-constant","type":"color","default":"#ffffff","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-intensity":{"property-type":"data-constant","type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-wall-radius":{"property-type":"data-driven","type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-radius":{"property-type":"data-driven","type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-attenuation":{"property-type":"data-constant","type":"number","default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-vertical-scale":{"property-type":"data-constant","type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-rounded-roof":{"property-type":"data-constant","type":"boolean","default":true,"expression":{"parameters":["zoom"]}},"fill-extrusion-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"property-type":"constant"},"line-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-border-width":{"type":"number","private":true,"default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-border-color":{"type":"color","private":true,"default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-driven"},"text-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-image-cross-fade":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"transition":true},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-color":{"type":"color","expression":{"interpolated":true,"parameters":["raster-value"]},"property-type":"color-ramp"},"raster-color-mix":{"type":"array","default":[0.2126,0.7152,0.0722,0],"length":4,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-color-range":{"type":"array","default":[0,1],"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":1,"nearest":1},"default":"linear","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":1,"atmosphere":1},"default":"atmosphere","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","default":10,"minimum":0,"maximum":100,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","value":"number","default":[0,0],"length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","default":90,"minimum":0,"maximum":180,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_model":{"model-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"model-rotation":{"type":"array","value":"number","length":3,"default":[0,0,0],"period":360,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-scale":{"type":"array","value":"number","length":3,"default":[1,1,1],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-translation":{"type":"array","value":"number","length":3,"default":[0,0,0],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-color":{"type":"color","default":"#ffffff","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light","zoom"]},"transition":true},"model-color-mix-intensity":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-type":{"type":"enum","values":{"common-3d":1,"location-indicator":1},"default":"common-3d","property-type":"data-constant"},"model-cast-shadows":{"type":"boolean","default":true,"expression":{},"property-type":"data-constant"},"model-receive-shadows":{"type":"boolean","default":true,"expression":{},"property-type":"data-constant"},"model-ambient-occlusion-intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant","transition":true},"model-emissive-strength":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":5,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-roughness":{"type":"number","default":1,"minimum":0,"maximum":1,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state"]},"transition":true},"model-height-based-emissive-strength-multiplier":{"type":"array","default":[1,1,1,1,0],"length":5,"value":"number","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"}},"transition":{"duration":{"type":"number","default":300,"minimum":0},"delay":{"type":"number","default":0,"minimum":0}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');class ln{constructor(t,r,c,u){this.message=(t?`${t}: `:"")+c,u&&(this.identifier=u),r!=null&&r.__line__&&(this.line=r.__line__)}}class Zs extends ln{}function Cs(a,...t){for(const r of t)for(const c in r)a[c]=r[c];return a}function Ga(a){return a instanceof Number||a instanceof String||a instanceof Boolean?a.valueOf():a}function oa(a){if(Array.isArray(a))return a.map(oa);if(a instanceof Object&&!(a instanceof Number||a instanceof String||a instanceof Boolean)){const t={};for(const r in a)t[r]=oa(a[r]);return t}return Ga(a)}class Ld extends Error{constructor(t,r){super(r),this.message=r,this.key=t}}var Ps=Ld;class Ao{constructor(t,r=[]){this.parent=t,this.bindings={};for(const[c,u]of r)this.bindings[c]=u}concat(t){return new Ao(this,t)}get(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(`${t} not found in scope.`)}has(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)}}var zf=Ao;const Ks={kind:"null"},an={kind:"number"},yi={kind:"string"},Ei={kind:"boolean"},Qa={kind:"color"},Fr={kind:"object"},oi={kind:"value"},Ho={kind:"collator"},kc={kind:"formatted"},Dc={kind:"resolvedImage"};function Oa(a,t){return{kind:"array",itemType:a,N:t}}function ma(a){if(a.kind==="array"){const t=ma(a.itemType);return typeof a.N=="number"?`array<${t}, ${a.N}>`:a.itemType.kind==="value"?"array":`array<${t}>`}return a.kind}const Rd=[Ks,an,yi,Ei,Qa,kc,Fr,Oa(oi),Dc];function Ll(a,t){if(t.kind==="error")return null;if(a.kind==="array"){if(t.kind==="array"&&(t.N===0&&t.itemType.kind==="value"||!Ll(a.itemType,t.itemType))&&(typeof a.N!="number"||a.N===t.N))return null}else{if(a.kind===t.kind)return null;if(a.kind==="value"){for(const r of Rd)if(!Ll(r,t))return null}}return`Expected ${ma(a)} but found ${ma(t)} instead.`}function Eo(a,t){return t.some(r=>r.kind===a.kind)}function fr(a,t){return t.some(r=>r==="null"?a===null:r==="array"?Array.isArray(a):r==="object"?a&&!Array.isArray(a)&&typeof a=="object":r===typeof a)}var Su,Js={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function Rl(a){return(a=Math.round(a))<0?0:a>255?255:a}function Au(a){return Rl(a[a.length-1]==="%"?parseFloat(a)/100*255:parseInt(a))}function kd(a){return(t=a[a.length-1]==="%"?parseFloat(a)/100:parseFloat(a))<0?0:t>1?1:t;var t}function Br(a,t,r){return r<0?r+=1:r>1&&(r-=1),6*r<1?a+(t-a)*r*6:2*r<1?t:3*r<2?a+(t-a)*(2/3-r)*6:a}try{Su={}.parseCSSColor=function(a){var t,r=a.replace(/ /g,"").toLowerCase();if(r in Js)return Js[r].slice();if(r[0]==="#")return r.length===4?(t=parseInt(r.substr(1),16))>=0&&t<=4095?[(3840&t)>>4|(3840&t)>>8,240&t|(240&t)>>4,15&t|(15&t)<<4,1]:null:r.length===7&&(t=parseInt(r.substr(1),16))>=0&&t<=16777215?[(16711680&t)>>16,(65280&t)>>8,255&t,1]:null;var c=r.indexOf("("),u=r.indexOf(")");if(c!==-1&&u+1===r.length){var h=r.substr(0,c),m=r.substr(c+1,u-(c+1)).split(","),g=1;switch(h){case"rgba":if(m.length!==4)return null;g=kd(m.pop());case"rgb":return m.length!==3?null:[Au(m[0]),Au(m[1]),Au(m[2]),g];case"hsla":if(m.length!==4)return null;g=kd(m.pop());case"hsl":if(m.length!==3)return null;var v=(parseFloat(m[0])%360+360)%360/360,b=kd(m[1]),w=kd(m[2]),A=w<=.5?w*(b+1):w+b-w*b,C=2*w-A;return[Rl(255*Br(C,A,v+1/3)),Rl(255*Br(C,A,v)),Rl(255*Br(C,A,v-1/3)),g];default:return null}}return null}}catch{}class La{constructor(t,r,c,u=1){this.r=t,this.g=r,this.b=c,this.a=u}static parse(t){if(!t)return;if(t instanceof La)return t;if(typeof t!="string")return;const r=Su(t);return r?new La(r[0]/255*r[3],r[1]/255*r[3],r[2]/255*r[3],r[3]):void 0}toString(){const[t,r,c,u]=this.toArray();return`rgba(${Math.round(t)},${Math.round(r)},${Math.round(c)},${u})`}toArray(){const{r:t,g:r,b:c,a:u}=this;return u===0?[0,0,0,0]:[255*t/u,255*r/u,255*c/u,u]}toArray01(){const{r:t,g:r,b:c,a:u}=this;return u===0?[0,0,0,0]:[t/u,r/u,c/u,u]}toArray01Scaled(t){const{r,g:c,b:u,a:h}=this;return h===0?[0,0,0]:[r/h*t,c/h*t,u/h*t]}toArray01PremultipliedAlpha(){const{r:t,g:r,b:c,a:u}=this;return[t,r,c,u]}toArray01Linear(){const{r:t,g:r,b:c,a:u}=this;return u===0?[0,0,0,0]:[Math.pow(t/u,2.2),Math.pow(r/u,2.2),Math.pow(c/u,2.2),u]}}La.black=new La(0,0,0,1),La.white=new La(1,1,1,1),La.transparent=new La(0,0,0,0),La.red=new La(1,0,0,1),La.blue=new La(0,0,1,1);var Sn=La;class ar{constructor(t,r,c){this.sensitivity=t?r?"variant":"case":r?"accent":"base",this.locale=c,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(t,r){return this.collator.compare(t,r)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class jo{constructor(t,r,c,u,h){this.text=t.normalize?t.normalize():t,this.image=r,this.scale=c,this.fontStack=u,this.textColor=h}}class Er{constructor(t){this.sections=t}static fromString(t){return new Er([new jo(t,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(t=>t.text.length!==0||t.image&&t.image.namePrimary.length!==0)}static factory(t){return t instanceof Er?t:Er.fromString(t)}toString(){return this.sections.length===0?"":this.sections.map(t=>t.text).join("")}serialize(){const t=["format"];for(const r of this.sections){if(r.image){t.push(["image",r.image.namePrimary]);continue}t.push(r.text);const c={};r.fontStack&&(c["text-font"]=["literal",r.fontStack.split(",")]),r.scale&&(c["font-scale"]=r.scale),r.textColor&&(c["text-color"]=["rgba"].concat(r.textColor.toArray())),t.push(c)}return t}}class ts{constructor(t){this.namePrimary=t.namePrimary,t.nameSecondary&&(this.nameSecondary=t.nameSecondary),this.available=t.available}toString(){return this.nameSecondary?`[${this.namePrimary},${this.nameSecondary}]`:this.namePrimary}static fromString(t,r){return t?new ts({namePrimary:t,nameSecondary:r,available:!1}):null}serialize(){return this.nameSecondary?["image",this.namePrimary,this.nameSecondary]:["image",this.namePrimary]}}function P_(a,t,r,c){return typeof a=="number"&&a>=0&&a<=255&&typeof t=="number"&&t>=0&&t<=255&&typeof r=="number"&&r>=0&&r<=255?c===void 0||typeof c=="number"&&c>=0&&c<=1?null:`Invalid rgba value [${[a,t,r,c].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof c=="number"?[a,t,r,c]:[a,t,r]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function ns(a){if(a===null||typeof a=="string"||typeof a=="boolean"||typeof a=="number"||a instanceof Sn||a instanceof ar||a instanceof Er||a instanceof ts)return!0;if(Array.isArray(a)){for(const t of a)if(!ns(t))return!1;return!0}if(typeof a=="object"){for(const t in a)if(!ns(a[t]))return!1;return!0}return!1}function Ra(a){if(a===null)return Ks;if(typeof a=="string")return yi;if(typeof a=="boolean")return Ei;if(typeof a=="number")return an;if(a instanceof Sn)return Qa;if(a instanceof ar)return Ho;if(a instanceof Er)return kc;if(a instanceof ts)return Dc;if(Array.isArray(a)){const t=a.length;let r;for(const c of a){const u=Ra(c);if(r){if(r===u)continue;r=oi;break}r=u}return Oa(r||oi,t)}return Fr}function Eu(a){const t=typeof a;return a===null?"":t==="string"||t==="number"||t==="boolean"?String(a):a instanceof Sn||a instanceof Er||a instanceof ts?a.toString():JSON.stringify(a)}class iy{constructor(t,r){this.type=t,this.value=r}static parse(t,r){if(t.length!==2)return r.error(`'literal' expression requires exactly one argument, but found ${t.length-1} instead.`);if(!ns(t[1]))return r.error("invalid value");const c=t[1];let u=Ra(c);const h=r.expectedType;return u.kind!=="array"||u.N!==0||!h||h.kind!=="array"||typeof h.N=="number"&&h.N!==0||(u=h),new iy(u,c)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof Sn?["rgba"].concat(this.value.toArray()):this.value instanceof Er?this.value.serialize():this.value}}var Mu=iy,Mr=class{constructor(a){this.name="ExpressionEvaluationError",this.message=a}toJSON(){return this.message}};const ay={string:yi,number:an,boolean:Ei,object:Fr};class Ff{constructor(t,r){this.type=t,this.args=r}static parse(t,r){if(t.length<2)return r.error("Expected at least one argument.");let c,u=1;const h=t[0];if(h==="array"){let g,v;if(t.length>2){const b=t[1];if(typeof b!="string"||!(b in ay)||b==="object")return r.error('The item type argument of "array" must be one of string, number, boolean',1);g=ay[b],u++}else g=oi;if(t.length>3){if(t[2]!==null&&(typeof t[2]!="number"||t[2]<0||t[2]!==Math.floor(t[2])))return r.error('The length argument to "array" must be a positive integer literal',2);v=t[2],u++}c=Oa(g,v)}else c=ay[h];const m=[];for(;u<t.length;u++){const g=r.parse(t[u],u,oi);if(!g)return null;m.push(g)}return new Ff(c,m)}evaluate(t){for(let r=0;r<this.args.length;r++){const c=this.args[r].evaluate(t);if(!Ll(this.type,Ra(c)))return c;if(r===this.args.length-1)throw new Mr(`Expected value to be of type ${ma(this.type)}, but found ${ma(Ra(c))} instead.`)}return null}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}serialize(){const t=this.type,r=[t.kind];if(t.kind==="array"){const c=t.itemType;if(c.kind==="string"||c.kind==="number"||c.kind==="boolean"){r.push(c.kind);const u=t.N;(typeof u=="number"||this.args.length>1)&&r.push(u)}}return r.concat(this.args.map(c=>c.serialize()))}}var Qs=Ff;class Kh{constructor(t){this.type=kc,this.sections=t}static parse(t,r){if(t.length<2)return r.error("Expected at least one argument.");const c=t[1];if(!Array.isArray(c)&&typeof c=="object")return r.error("First argument must be an image or text section.");const u=[];let h=!1;for(let m=1;m<=t.length-1;++m){const g=t[m];if(h&&typeof g=="object"&&!Array.isArray(g)){h=!1;let v=null;if(g["font-scale"]&&(v=r.parse(g["font-scale"],1,an),!v))return null;let b=null;if(g["text-font"]&&(b=r.parse(g["text-font"],1,Oa(yi)),!b))return null;let w=null;if(g["text-color"]&&(w=r.parse(g["text-color"],1,Qa),!w))return null;const A=u[u.length-1];A.scale=v,A.font=b,A.textColor=w}else{const v=r.parse(t[m],1,oi);if(!v)return null;const b=v.type.kind;if(b!=="string"&&b!=="value"&&b!=="null"&&b!=="resolvedImage")return r.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");h=!0,u.push({content:v,scale:null,font:null,textColor:null})}}return new Kh(u)}evaluate(t){return new Er(this.sections.map(r=>{const c=r.content.evaluate(t);return Ra(c)===Dc?new jo("",c,null,null,null):new jo(Eu(c),null,r.scale?r.scale.evaluate(t):null,r.font?r.font.evaluate(t).join(","):null,r.textColor?r.textColor.evaluate(t):null)}))}eachChild(t){for(const r of this.sections)t(r.content),r.scale&&t(r.scale),r.font&&t(r.font),r.textColor&&t(r.textColor)}outputDefined(){return!1}serialize(){const t=["format"];for(const r of this.sections){t.push(r.content.serialize());const c={};r.scale&&(c["font-scale"]=r.scale.serialize()),r.font&&(c["text-font"]=r.font.serialize()),r.textColor&&(c["text-color"]=r.textColor.serialize()),t.push(c)}return t}}class Jh{constructor(t,r){this.type=Dc,this.inputPrimary=t,this.inputSecondary=r}static parse(t,r){if(t.length<2)return r.error("Expected two or more arguments.");const c=r.parse(t[1],1,yi);if(!c)return r.error("No image name provided.");if(t.length===2)return new Jh(c);const u=r.parse(t[2],1,yi);return u?new Jh(c,u):r.error("Secondary image variant is not a string.")}evaluate(t){const r=ts.fromString(this.inputPrimary.evaluate(t),this.inputSecondary?this.inputSecondary.evaluate(t):void 0);return r&&t.availableImages&&(r.available=t.availableImages.indexOf(r.namePrimary)>-1,r.nameSecondary&&r.available&&t.availableImages&&(r.available=t.availableImages.indexOf(r.nameSecondary)>-1)),r}eachChild(t){t(this.inputPrimary),this.inputSecondary&&t(this.inputSecondary)}outputDefined(){return!1}serialize(){return this.inputSecondary?["image",this.inputPrimary.serialize(),this.inputSecondary.serialize()]:["image",this.inputPrimary.serialize()]}}function Oi(a){return a instanceof Number?"number":a instanceof String?"string":a instanceof Boolean?"boolean":Array.isArray(a)?"array":a===null?"null":typeof a}const I_={"to-boolean":Ei,"to-color":Qa,"to-number":an,"to-string":yi};class Tu{constructor(t,r){this.type=t,this.args=r}static parse(t,r){if(t.length<2)return r.error("Expected at least one argument.");const c=t[0],u=[];let h=Ks;if(c==="to-array"){if(!Array.isArray(t[1]))return null;const m=t[1].length;if(r.expectedType){if(r.expectedType.kind!=="array")return r.error(`Expected ${r.expectedType.kind} but found array.`);h=Oa(r.expectedType.itemType,m)}else{if(!(m>0&&ns(t[1][0])))return null;h=Oa(Ra(t[1][0]),m)}for(let g=0;g<m;g++){const v=t[1][g];let b;if(Oi(v)==="array")b=r.parse(v,void 0,h.itemType);else{const w=Oi(v);if(w!==h.itemType.kind)return r.error(`Expected ${h.itemType.kind} but found ${w}.`);b=r.registry.literal.parse(["literal",v===void 0?null:v],r)}if(!b)return null;u.push(b)}}else{if((c==="to-boolean"||c==="to-string")&&t.length!==2)return r.error("Expected one argument.");h=I_[c];for(let m=1;m<t.length;m++){const g=r.parse(t[m],m,oi);if(!g)return null;u.push(g)}}return new Tu(h,u)}evaluate(t){if(this.type.kind==="boolean")return!!this.args[0].evaluate(t);if(this.type.kind==="color"){let r,c;for(const u of this.args){if(r=u.evaluate(t),c=null,r instanceof Sn)return r;if(typeof r=="string"){const h=t.parseColor(r);if(h)return h}else if(Array.isArray(r)&&(c=r.length<3||r.length>4?`Invalid rbga value ${JSON.stringify(r)}: expected an array containing either three or four numeric values.`:P_(r[0],r[1],r[2],r[3]),!c))return new Sn(r[0]/255,r[1]/255,r[2]/255,r[3])}throw new Mr(c||`Could not parse color from value '${typeof r=="string"?r:String(JSON.stringify(r))}'`)}if(this.type.kind==="number"){let r=null;for(const c of this.args){if(r=c.evaluate(t),r===null)return 0;const u=Number(r);if(!isNaN(u))return u}throw new Mr(`Could not convert ${JSON.stringify(r)} to number.`)}return this.type.kind==="formatted"?Er.fromString(Eu(this.args[0].evaluate(t))):this.type.kind==="resolvedImage"?ts.fromString(Eu(this.args[0].evaluate(t))):this.type.kind==="array"?this.args.map(r=>r.evaluate(t)):Eu(this.args[0].evaluate(t))}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}serialize(){if(this.type.kind==="formatted")return new Kh([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new Jh(this.args[0]).serialize();const t=this.type.kind==="array"?[]:[`to-${this.type.kind}`];return this.eachChild(r=>{t.push(r.serialize())}),t}}var el=Tu;const ry=["Unknown","Point","LineString","Polygon"];var Bf=class{constructor(a){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null,this.options=a}id(){return this.feature&&this.feature.id!==void 0?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?ry[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}measureLight(a){return this.globals.brightness||0}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const a=this.featureDistanceData.center,t=this.featureDistanceData.scale,{x:r,y:c}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(r*t-a[0])+this.featureDistanceData.bearing[1]*(c*t-a[1])}return 0}parseColor(a){let t=this._parseColorCache[a];return t||(t=this._parseColorCache[a]=Sn.parse(a)),t}getConfig(a){return this.options?this.options.get(a):null}};class Mo{constructor(t,r,c,u){this.name=t,this.type=r,this._evaluate=c,this.args=u}evaluate(t){return this._evaluate(t,this.args)}eachChild(t){this.args.forEach(t)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(t=>t.serialize()))}static parse(t,r){const c=t[0],u=Mo.definitions[c];if(!u)return r.error(`Unknown expression "${c}". If you wanted a literal array, use ["literal", [...]].`,0);const h=Array.isArray(u)?u[0]:u.type,m=Array.isArray(u)?[[u[1],u[2]]]:u.overloads,g=m.filter(([b])=>!Array.isArray(b)||b.length===t.length-1);let v=null;for(const[b,w]of g){v=new yy(r.registry,r.path,null,r.scope,void 0,r.options);const A=[];let C=!1;for(let P=1;P<t.length;P++){const k=t[P],z=Array.isArray(b)?b[P-1]:b.type,U=v.parse(k,1+A.length,z);if(!U){C=!0;break}A.push(U)}if(!C)if(Array.isArray(b)&&b.length!==A.length)v.error(`Expected ${b.length} arguments, but found ${A.length} instead.`);else{for(let P=0;P<A.length;P++){const k=Array.isArray(b)?b[P]:b.type,z=A[P];v.concat(P+1).checkSubtype(k,z.type)}if(v.errors.length===0)return new Mo(c,h,w,A)}}if(g.length===1)r.errors.push(...v.errors);else{const b=(g.length?g:m).map(([A])=>{return C=A,Array.isArray(C)?`(${C.map(ma).join(", ")})`:`(${ma(C.type)}...)`;var C}).join(" | "),w=[];for(let A=1;A<t.length;A++){const C=r.parse(t[A],1+w.length);if(!C)return null;w.push(ma(C.type))}r.error(`Expected arguments of type ${b}, but found (${w.join(", ")}) instead.`)}return null}static register(t,r){Mo.definitions=r;for(const c in r)t[c]=Mo}}var Tr=Mo;class rc{constructor(t,r,c){this.type=Ho,this.locale=c,this.caseSensitive=t,this.diacriticSensitive=r}static parse(t,r){if(t.length!==2)return r.error("Expected one argument.");const c=t[1];if(typeof c!="object"||Array.isArray(c))return r.error("Collator options argument must be an object.");const u=r.parse(c["case-sensitive"]!==void 0&&c["case-sensitive"],1,Ei);if(!u)return null;const h=r.parse(c["diacritic-sensitive"]!==void 0&&c["diacritic-sensitive"],1,Ei);if(!h)return null;let m=null;return c.locale&&(m=r.parse(c.locale,1,yi),!m)?null:new rc(u,h,m)}evaluate(t){return new ar(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)}eachChild(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)}outputDefined(){return!1}serialize(){const t={};return t["case-sensitive"]=this.caseSensitive.serialize(),t["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(t.locale=this.locale.serialize()),["collator",t]}}var oc={exports:{}};oc.exports=function(){function a(c,u,h,m,g){for(;m>h;){if(m-h>600){var v=m-h+1,b=u-h+1,w=Math.log(v),A=.5*Math.exp(2*w/3),C=.5*Math.sqrt(w*A*(v-A)/v)*(b-v/2<0?-1:1);a(c,u,Math.max(h,Math.floor(u-b*A/v+C)),Math.min(m,Math.floor(u+(v-b)*A/v+C)),g)}var P=c[u],k=h,z=m;for(t(c,h,u),g(c[m],P)>0&&t(c,h,m);k<z;){for(t(c,k,z),k++,z--;g(c[k],P)<0;)k++;for(;g(c[z],P)>0;)z--}g(c[h],P)===0?t(c,h,z):t(c,++z,m),z<=u&&(h=z+1),u<=z&&(m=z-1)}}function t(c,u,h){var m=c[u];c[u]=c[h],c[h]=m}function r(c,u){return c<u?-1:c>u?1:0}return function(c,u,h,m,g){a(c,u,h||0,m||c.length-1,g||r)}}();var Oc=N(oc.exports);function Dd(a){let t=0;for(let r,c,u=0,h=a.length,m=h-1;u<h;m=u++)r=a[u],c=a[m],t+=(c.x-r.x)*(r.y+c.y);return t}function Qh(a,t){a[0]=Math.min(a[0],t[0]),a[1]=Math.min(a[1],t[1]),a[2]=Math.max(a[2],t[0]),a[3]=Math.max(a[3],t[1])}function Od(a,t){return!(a[0]<=t[0]||a[2]>=t[2]||a[1]<=t[1]||a[3]>=t[3])}function L_(a,t,r){const c=a[0]-t[0],u=a[1]-t[1],h=a[0]-r[0],m=a[1]-r[1];return c*m-h*u==0&&c*h<=0&&u*m<=0}function ho(a,t,r=!1){let c=!1;for(let g=0,v=t.length;g<v;g++){const b=t[g];for(let w=0,A=b.length,C=A-1;w<A;C=w++){const P=b[C],k=b[w];if(L_(a,P,k))return r;(h=P)[1]>(u=a)[1]!=(m=k)[1]>u[1]&&u[0]<(m[0]-h[0])*(u[1]-h[1])/(m[1]-h[1])+h[0]&&(c=!c)}}var u,h,m;return c}function is(a,t,r,c){const u=c[0]-r[0],h=c[1]-r[1],m=(a[0]-r[0])*h-u*(a[1]-r[1]),g=(t[0]-r[0])*h-u*(t[1]-r[1]);return m>0&&g<0||m<0&&g>0}function Na(a,t,r,c){return(u=[c[0]-r[0],c[1]-r[1]])[0]*(h=[t[0]-a[0],t[1]-a[1]])[1]-u[1]*h[0]!=0&&!(!is(a,t,r,c)||!is(r,c,a,t));var u,h}const tl=8192;function kl(a,t){const r=(180+a[0])/360,c=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+a[1]*Math.PI/360)))/360,u=Math.pow(2,t.z);return[Math.round(r*u*tl),Math.round(c*u*tl)]}function s2(a,t){for(let r=0;r<t.length;r++)if(ho(a,t[r]))return!0;return!1}function l2(a,t,r){for(const c of r)for(let u=0,h=c.length,m=h-1;u<h;m=u++)if(Na(a,t,c[m],c[u]))return!0;return!1}function oy(a,t){for(let r=0;r<a.length;++r)if(!ho(a[r],t))return!1;for(let r=0;r<a.length-1;++r)if(l2(a[r],a[r+1],t))return!1;return!0}function R_(a,t){for(let r=0;r<t.length;r++)if(oy(a,t[r]))return!0;return!1}function sy(a,t,r){const c=[];for(let u=0;u<a.length;u++){const h=[];for(let m=0;m<a[u].length;m++){const g=kl(a[u][m],r);Qh(t,g),h.push(g)}c.push(h)}return c}function ep(a,t,r){const c=[];for(let u=0;u<a.length;u++){const h=sy(a[u],t,r);c.push(h)}return c}function Nd(a,t,r,c){if(a[0]<r[0]||a[0]>r[2]){const u=.5*c;let h=a[0]-r[0]>u?-c:r[0]-a[0]>u?c:0;h===0&&(h=a[0]-r[2]>u?-c:r[2]-a[0]>u?c:0),a[0]+=h}Qh(t,a)}function ly(a,t,r,c){const u=Math.pow(2,c.z)*tl,h=[c.x*tl,c.y*tl],m=[];if(!a)return m;for(const g of a)for(const v of g){const b=[v.x+h[0],v.y+h[1]];Nd(b,t,r,u),m.push(b)}return m}function tp(a,t,r,c){const u=Math.pow(2,c.z)*tl,h=[c.x*tl,c.y*tl],m=[];if(!a)return m;for(const v of a){const b=[];for(const w of v){const A=[w.x+h[0],w.y+h[1]];Qh(t,A),b.push(A)}m.push(b)}if(t[2]-t[0]<=u/2){(g=t)[0]=g[1]=1/0,g[2]=g[3]=-1/0;for(const v of m)for(const b of v)Nd(b,t,r,u)}var g;return m}class Cu{constructor(t,r){this.type=Ei,this.geojson=t,this.geometries=r}static parse(t,r){if(t.length!==2)return r.error(`'within' expression requires exactly one argument, but found ${t.length-1} instead.`);if(ns(t[1])){const c=t[1];if(c.type==="FeatureCollection")for(let u=0;u<c.features.length;++u){const h=c.features[u].geometry.type;if(h==="Polygon"||h==="MultiPolygon")return new Cu(c,c.features[u].geometry)}else if(c.type==="Feature"){const u=c.geometry.type;if(u==="Polygon"||u==="MultiPolygon")return new Cu(c,c.geometry)}else if(c.type==="Polygon"||c.type==="MultiPolygon")return new Cu(c,c)}return r.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return function(r,c){const u=[1/0,1/0,-1/0,-1/0],h=[1/0,1/0,-1/0,-1/0],m=r.canonicalID();if(!m)return!1;if(c.type==="Polygon"){const g=sy(c.coordinates,h,m),v=ly(r.geometry(),u,h,m);if(!Od(u,h))return!1;for(const b of v)if(!ho(b,g))return!1}if(c.type==="MultiPolygon"){const g=ep(c.coordinates,h,m),v=ly(r.geometry(),u,h,m);if(!Od(u,h))return!1;for(const b of v)if(!s2(b,g))return!1}return!0}(t,this.geometries);if(t.geometryType()==="LineString")return function(r,c){const u=[1/0,1/0,-1/0,-1/0],h=[1/0,1/0,-1/0,-1/0],m=r.canonicalID();if(!m)return!1;if(c.type==="Polygon"){const g=sy(c.coordinates,h,m),v=tp(r.geometry(),u,h,m);if(!Od(u,h))return!1;for(const b of v)if(!oy(b,g))return!1}if(c.type==="MultiPolygon"){const g=ep(c.coordinates,h,m),v=tp(r.geometry(),u,h,m);if(!Od(u,h))return!1;for(const b of v)if(!R_(b,g))return!1}return!0}(t,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}var cy=Cu,k_={exports:{}};k_.exports=function(){var a={kilometers:1,miles:.621371192237334,nauticalmiles:.5399568034557235,meters:1e3,metres:1e3,yards:1093.6132983377079,feet:3280.839895013123,inches:39370.078740157485},t=1/298.257223563,r=t*(2-t),c=Math.PI/180,u=function(b,w){if(b===void 0)throw new Error("No latitude given.");if(w&&!a[w])throw new Error("Unknown unit "+w+". Use one of: "+Object.keys(a).join(", "));var A=6378.137*c*(w?a[w]:1),C=Math.cos(b*c),P=1/(1-r*(1-C*C)),k=Math.sqrt(P);this.kx=A*k*C,this.ky=A*k*P*(1-r)},h={units:{configurable:!0}};function m(b,w){return b[0]===w[0]&&b[1]===w[1]}function g(b,w,A){var C=v(w[0]-b[0]);return[b[0]+C*A,b[1]+(w[1]-b[1])*A]}function v(b){for(;b<-180;)b+=360;for(;b>180;)b-=360;return b}return u.fromTile=function(b,w,A){var C=Math.PI*(1-2*(b+.5)/Math.pow(2,w)),P=Math.atan(.5*(Math.exp(C)-Math.exp(-C)))/c;return new u(P,A)},h.units.get=function(){return a},u.prototype.distance=function(b,w){var A=v(b[0]-w[0])*this.kx,C=(b[1]-w[1])*this.ky;return Math.sqrt(A*A+C*C)},u.prototype.bearing=function(b,w){var A=v(w[0]-b[0])*this.kx;return Math.atan2(A,(w[1]-b[1])*this.ky)/c},u.prototype.destination=function(b,w,A){var C=A*c;return this.offset(b,Math.sin(C)*w,Math.cos(C)*w)},u.prototype.offset=function(b,w,A){return[b[0]+w/this.kx,b[1]+A/this.ky]},u.prototype.lineDistance=function(b){for(var w=0,A=0;A<b.length-1;A++)w+=this.distance(b[A],b[A+1]);return w},u.prototype.area=function(b){for(var w=0,A=0;A<b.length;A++)for(var C=b[A],P=0,k=C.length,z=k-1;P<k;z=P++)w+=v(C[P][0]-C[z][0])*(C[P][1]+C[z][1])*(A?-1:1);return Math.abs(w)/2*this.kx*this.ky},u.prototype.along=function(b,w){var A=0;if(w<=0)return b[0];for(var C=0;C<b.length-1;C++){var P=b[C],k=b[C+1],z=this.distance(P,k);if((A+=z)>w)return g(P,k,(w-(A-z))/z)}return b[b.length-1]},u.prototype.pointToSegmentDistance=function(b,w,A){var C=w[0],P=w[1],k=v(A[0]-C)*this.kx,z=(A[1]-P)*this.ky,U=0;return k===0&&z===0||((U=(v(b[0]-C)*this.kx*k+(b[1]-P)*this.ky*z)/(k*k+z*z))>1?(C=A[0],P=A[1]):U>0&&(C+=k/this.kx*U,P+=z/this.ky*U)),k=v(b[0]-C)*this.kx,z=(b[1]-P)*this.ky,Math.sqrt(k*k+z*z)},u.prototype.pointOnLine=function(b,w){for(var A,C,P,k,z=1/0,U=0;U<b.length-1;U++){var W=b[U][0],$=b[U][1],Z=v(b[U+1][0]-W)*this.kx,K=(b[U+1][1]-$)*this.ky,q=0;Z===0&&K===0||((q=(v(w[0]-W)*this.kx*Z+(w[1]-$)*this.ky*K)/(Z*Z+K*K))>1?(W=b[U+1][0],$=b[U+1][1]):q>0&&(W+=Z/this.kx*q,$+=K/this.ky*q));var J=(Z=v(w[0]-W)*this.kx)*Z+(K=(w[1]-$)*this.ky)*K;J<z&&(z=J,A=W,C=$,P=U,k=q)}return{point:[A,C],index:P,t:Math.max(0,Math.min(1,k))}},u.prototype.lineSlice=function(b,w,A){var C=this.pointOnLine(A,b),P=this.pointOnLine(A,w);if(C.index>P.index||C.index===P.index&&C.t>P.t){var k=C;C=P,P=k}var z=[C.point],U=C.index+1,W=P.index;!m(A[U],z[0])&&U<=W&&z.push(A[U]);for(var $=U+1;$<=W;$++)z.push(A[$]);return m(A[W],P.point)||z.push(P.point),z},u.prototype.lineSliceAlong=function(b,w,A){for(var C=0,P=[],k=0;k<A.length-1;k++){var z=A[k],U=A[k+1],W=this.distance(z,U);if((C+=W)>b&&P.length===0&&P.push(g(z,U,(b-(C-W))/W)),C>=w)return P.push(g(z,U,(w-(C-W))/W)),P;C>b&&P.push(U)}return P},u.prototype.bufferPoint=function(b,w){var A=w/this.ky,C=w/this.kx;return[b[0]-C,b[1]-A,b[0]+C,b[1]+A]},u.prototype.bufferBBox=function(b,w){var A=w/this.ky,C=w/this.kx;return[b[0]-C,b[1]-A,b[2]+C,b[3]+A]},u.prototype.insideBBox=function(b,w){return v(b[0]-w[0])>=0&&v(b[0]-w[2])<=0&&b[1]>=w[1]&&b[1]<=w[3]},Object.defineProperties(u,h),u}();var Pu=N(k_.exports),D_={exports:{}};D_.exports=function(){var a=function(r,c){if(r===void 0&&(r=[]),c===void 0&&(c=t),this.data=r,this.length=this.data.length,this.compare=c,this.length>0)for(var u=(this.length>>1)-1;u>=0;u--)this._down(u)};function t(r,c){return r<c?-1:r>c?1:0}return a.prototype.push=function(r){this.data.push(r),this.length++,this._up(this.length-1)},a.prototype.pop=function(){if(this.length!==0){var r=this.data[0],c=this.data.pop();return this.length--,this.length>0&&(this.data[0]=c,this._down(0)),r}},a.prototype.peek=function(){return this.data[0]},a.prototype._up=function(r){for(var c=this.data,u=this.compare,h=c[r];r>0;){var m=r-1>>1,g=c[m];if(u(h,g)>=0)break;c[r]=g,r=m}c[r]=h},a.prototype._down=function(r){for(var c=this.data,u=this.compare,h=this.length>>1,m=c[r];r<h;){var g=1+(r<<1),v=c[g],b=g+1;if(b<this.length&&u(c[b],v)<0&&(g=b,v=c[b]),u(v,m)>=0)break;c[r]=v,r=g}c[r]=m},a}();var zd=N(D_.exports),mt=8192;function np(a,t){return t.dist-a.dist}const Iu=100,nl=50;function uy(a){const t=[1/0,1/0,-1/0,-1/0];if(t.length!==a.length)return!1;for(let r=0;r<t.length;r++)if(t[r]!==a[r])return!1;return!0}function Nc(a){return a[1]-a[0]+1}function sc(a,t){const r=a[1]>=a[0]&&a[1]<t;return r||console.warn("Distance Expression: Index is out of range"),r}function Uf(a,t){if(a[0]>a[1])return[null,null];const r=Nc(a);if(t){if(r===2)return[a,null];const c=Math.floor(r/2);return[[a[0],a[0]+c],[a[0]+c,a[1]]]}{if(r===1)return[a,null];const c=Math.floor(r/2)-1;return[[a[0],a[0]+c],[a[0]+c+1,a[1]]]}}function ba(a,t){const r=[1/0,1/0,-1/0,-1/0];if(!sc(t,a.length))return r;for(let c=t[0];c<=t[1];++c)Qh(r,a[c]);return r}function Fd(a){const t=[1/0,1/0,-1/0,-1/0];for(let r=0;r<a.length;++r)for(let c=0;c<a[r].length;++c)Qh(t,a[r][c]);return t}function Lu(a,t,r){if(uy(a)||uy(t))return NaN;let c=0,u=0;return a[2]<t[0]&&(c=t[0]-a[2]),a[0]>t[2]&&(c=a[0]-t[2]),a[1]>t[3]&&(u=a[1]-t[3]),a[3]<t[1]&&(u=t[1]-a[3]),r.distance([0,0],[c,u])}function Wf(a,t){const r=Math.pow(2,t.z);return[(u=(a.x/mt+t.x)/r,360*u-180),(c=(a.y/mt+t.y)/r,360/Math.PI*Math.atan(Math.exp((180-360*c)*Math.PI/180))-90)];var c,u}function dy(a,t){const r=[];for(let c=0;c<a.length;++c)r.push(Wf(a[c],t));return r}function Is(a,t,r){const c=r.pointOnLine(t,a).point;return r.distance(a,c)}function Bd(a,t,r,c,u){const h=r.slice(c[0],c[1]+1);let m=1/0;for(let g=t[0];g<=t[1];++g)if((m=Math.min(m,Is(a[g],h,u)))===0)return 0;return m}function er(a,t,r,c,u){const h=Math.min(u.pointToSegmentDistance(a,r,c),u.pointToSegmentDistance(t,r,c)),m=Math.min(u.pointToSegmentDistance(r,a,t),u.pointToSegmentDistance(c,a,t));return Math.min(h,m)}function Oo(a,t,r,c,u){if(!sc(t,a.length)||!sc(c,r.length))return NaN;let h=1/0;for(let m=t[0];m<t[1];++m)for(let g=c[0];g<c[1];++g){if(Na(a[m],a[m+1],r[g],r[g+1]))return 0;h=Math.min(h,er(a[m],a[m+1],r[g],r[g+1],u))}return h}function po(a,t,r,c,u){if(!sc(t,a.length)||!sc(c,r.length))return NaN;let h=1/0;for(let m=t[0];m<=t[1];++m)for(let g=c[0];g<=c[1];++g)if((h=Math.min(h,u.distance(a[m],r[g])))===0)return h;return h}function hy(a,t,r){if(ho(a,t,!0))return 0;let c=1/0;for(const u of t){const h=u.length;if(h<2)return console.warn("Distance Expression: Invalid polygon!"),NaN;if(u[0]!==u[h-1]&&(c=Math.min(c,r.pointToSegmentDistance(a,u[h-1],u[0])))===0||(c=Math.min(c,Is(a,u,r)))===0)return c}return c}function Vf(a,t,r,c){if(!sc(t,a.length))return NaN;for(let h=t[0];h<=t[1];++h)if(ho(a[h],r,!0))return 0;let u=1/0;for(let h=t[0];h<t[1];++h)for(const m of r)for(let g=0,v=m.length,b=v-1;g<v;b=g++){if(Na(a[h],a[h+1],m[b],m[g]))return 0;u=Math.min(u,er(a[h],a[h+1],m[b],m[g],c))}return u}function ip(a,t){for(const r of a)for(let c=0;c<=r.length-1;++c)if(ho(r[c],t,!0))return!0;return!1}function bC(a,t,r,c=1/0){const u=Fd(a),h=Fd(t);if(c!==1/0&&Lu(u,h,r)>=c)return c;if(Od(u,h)){if(ip(a,t))return 0}else if(ip(t,a))return 0;let m=c;for(const g of a)for(let v=0,b=g.length,w=b-1;v<b;w=v++)for(const A of t)for(let C=0,P=A.length,k=P-1;C<P;k=C++){if(Na(g[w],g[v],A[k],A[C]))return 0;m=Math.min(m,er(g[w],g[v],A[k],A[C],r))}return m}function Kr(a,t,r,c,u,h,m){if(h===null||m===null)return;const g=Lu(ba(c,h),ba(u,m),r);g<t&&a.push({dist:g,range1:h,range2:m})}function O_(a,t,r,c,u=1/0){let h=Math.min(c.distance(a[0],r[0][0]),u);if(h===0)return h;const m=new zd([{dist:0,range1:[0,a.length-1],range2:[0,0]}],np),g=t?nl:Iu,v=Fd(r);for(;m.length;){const b=m.pop();if(b.dist>=h)continue;const w=b.range1;if(Nc(w)<=g){if(!sc(w,a.length))return NaN;if(t){const A=Vf(a,w,r,c);if((h=Math.min(h,A))===0)return h}else for(let A=w[0];A<=w[1];++A){const C=hy(a[A],r,c);if((h=Math.min(h,C))===0)return h}}else{const A=Uf(w,t);if(A[0]!==null){const C=Lu(ba(a,A[0]),v,c);C<h&&m.push({dist:C,range1:A[0],range2:[0,0]})}if(A[1]!==null){const C=Lu(ba(a,A[1]),v,c);C<h&&m.push({dist:C,range1:A[1],range2:[0,0]})}}}return h}function py(a,t,r,c,u,h=1/0){let m=Math.min(h,u.distance(a[0],r[0]));if(m===0)return m;const g=new zd([{dist:0,range1:[0,a.length-1],range2:[0,r.length-1]}],np),v=t?nl:Iu,b=c?nl:Iu;for(;g.length;){const w=g.pop();if(w.dist>=m)continue;const A=w.range1,C=w.range2;if(Nc(A)<=v&&Nc(C)<=b){if(!sc(A,a.length)||!sc(C,r.length))return NaN;if(t&&c?m=Math.min(m,Oo(a,A,r,C,u)):t||c?t&&!c?m=Math.min(m,Bd(r,C,a,A,u)):!t&&c&&(m=Math.min(m,Bd(a,A,r,C,u))):m=Math.min(m,po(a,A,r,C,u)),m===0)return m}else{const P=Uf(A,t),k=Uf(C,c);Kr(g,m,u,a,r,P[0],k[0]),Kr(g,m,u,a,r,P[0],k[1]),Kr(g,m,u,a,r,P[1],k[0]),Kr(g,m,u,a,r,P[1],k[1])}}return m}function Gf(a,t,r,c,u=1/0){let h=u;const m=ba(a,[0,a.length-1]);for(const g of r)if(!(h!==1/0&&Lu(m,ba(g,[0,g.length-1]),c)>=h)&&(h=Math.min(h,py(a,t,g,!0,c,h)),h===0))return h;return h}function il(a,t,r,c,u=1/0){let h=u;const m=ba(a,[0,a.length-1]);for(const g of r){if(h!==1/0&&Lu(m,Fd(g),c)>=h)continue;const v=O_(a,t,g,c,h);if(isNaN(v))return v;if((h=Math.min(h,v))===0)return h}return h}function al(a){return a==="Point"||a==="MultiPoint"||a==="LineString"||a==="MultiLineString"||a==="Polygon"||a==="MultiPolygon"}class Dl{constructor(t,r){this.type=an,this.geojson=t,this.geometries=r}static parse(t,r){if(t.length!==2)return r.error(`'distance' expression requires either one argument, but found ' ${t.length-1} instead.`);if(ns(t[1])){const c=t[1];if(c.type==="FeatureCollection"){for(let u=0;u<c.features.length;++u)if(al(c.features[u].geometry.type))return new Dl(c,c.features[u].geometry)}else if(c.type==="Feature"){if(al(c.geometry.type))return new Dl(c,c.geometry)}else if(al(c.type))return new Dl(c,c)}return r.error("'distance' expression needs to be an array with format ['Distance', GeoJSONObj].")}evaluate(t){const r=t.geometry(),c=t.canonicalID();if(r!=null&&c!=null){if(t.geometryType()==="Point")return function(u,h,m){const g=[];for(const b of u)for(const w of b)g.push(Wf(w,h));const v=new Pu(g[0][1],"meters");return m.type==="Point"||m.type==="MultiPoint"||m.type==="LineString"?py(g,!1,m.type==="Point"?[m.coordinates]:m.coordinates,m.type==="LineString",v):m.type==="MultiLineString"?Gf(g,!1,m.coordinates,v):m.type==="Polygon"||m.type==="MultiPolygon"?il(g,!1,m.type==="Polygon"?[m.coordinates]:m.coordinates,v):null}(r,c,this.geometries);if(t.geometryType()==="LineString")return function(u,h,m){const g=[];for(const b of u){const w=[];for(const A of b)w.push(Wf(A,h));g.push(w)}const v=new Pu(g[0][0][1],"meters");if(m.type==="Point"||m.type==="MultiPoint"||m.type==="LineString")return Gf(m.type==="Point"?[m.coordinates]:m.coordinates,m.type==="LineString",g,v);if(m.type==="MultiLineString"){let b=1/0;for(let w=0;w<m.coordinates.length;w++){const A=Gf(m.coordinates[w],!0,g,v,b);if(isNaN(A))return A;if((b=Math.min(b,A))===0)return b}return b}if(m.type==="Polygon"||m.type==="MultiPolygon"){let b=1/0;for(let w=0;w<g.length;w++){const A=il(g[w],!0,m.type==="Polygon"?[m.coordinates]:m.coordinates,v,b);if(isNaN(A))return A;if((b=Math.min(b,A))===0)return b}return b}return null}(r,c,this.geometries);if(t.geometryType()==="Polygon")return function(u,h,m){const g=[];for(const b of function(w,A){const C=w.length;if(C<=1)return[w];const P=[];let k,z;for(let U=0;U<C;U++){const W=Dd(w[U]);W!==0&&(w[U].area=Math.abs(W),z===void 0&&(z=W<0),z===W<0?(k&&P.push(k),k=[w[U]]):k.push(w[U]))}return k&&P.push(k),P}(u)){const w=[];for(let A=0;A<b.length;++A)w.push(dy(b[A],h));g.push(w)}const v=new Pu(g[0][0][0][1],"meters");if(m.type==="Point"||m.type==="MultiPoint"||m.type==="LineString")return il(m.type==="Point"?[m.coordinates]:m.coordinates,m.type==="LineString",g,v);if(m.type==="MultiLineString"){let b=1/0;for(let w=0;w<m.coordinates.length;w++){const A=il(m.coordinates[w],!0,g,v,b);if(isNaN(A))return A;if((b=Math.min(b,A))===0)return b}return b}return m.type==="Polygon"||m.type==="MultiPolygon"?function(b,w,A){let C=1/0;for(const P of b)for(const k of w){const z=bC(P,k,A,C);if(isNaN(z))return z;if((C=Math.min(C,z))===0)return C}return C}(m.type==="Polygon"?[m.coordinates]:m.coordinates,g,v):null}(r,c,this.geometries);console.warn("Distance Expression: currently only evaluates valid Point/LineString/Polygon geometries.")}else console.warn("Distance Expression: requirs valid feature and canonical information.");return null}eachChild(){}outputDefined(){return!0}serialize(){return["distance",this.geojson]}}var ap=Dl;function Ru(a){if(a instanceof Tr&&(a.name==="get"&&a.args.length===1||a.name==="feature-state"||a.name==="has"&&a.args.length===1||a.name==="properties"||a.name==="geometry-type"||a.name==="id"||/^filter-/.test(a.name))||a instanceof cy||a instanceof ap)return!1;let t=!0;return a.eachChild(r=>{t&&!Ru(r)&&(t=!1)}),t}function Hf(a){if(a instanceof Tr&&a.name==="feature-state")return!1;let t=!0;return a.eachChild(r=>{t&&!Hf(r)&&(t=!1)}),t}function fy(a){if(a instanceof Tr&&a.name==="config")return!1;let t=!0;return a.eachChild(r=>{t&&!fy(r)&&(t=!1)}),t}function Ud(a,t){if(a instanceof Tr&&t.indexOf(a.name)>=0)return!1;let r=!0;return a.eachChild(c=>{r&&!Ud(c,t)&&(r=!1)}),r}class my{constructor(t,r){this.type=r.type,this.name=t,this.boundExpression=r}static parse(t,r){if(t.length!==2||typeof t[1]!="string")return r.error("'var' expression requires exactly one string literal argument.");const c=t[1];return r.scope.has(c)?new my(c,r.scope.get(c)):r.error(`Unknown variable "${c}". Make sure "${c}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(t){return this.boundExpression.evaluate(t)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}var N_=my;class gy{constructor(t,r=[],c,u=new zf,h=[],m){this.registry=t,this.path=r,this.key=r.map(g=>`[${g}]`).join(""),this.scope=u,this.errors=h,this.expectedType=c,this.options=m}parse(t,r,c,u,h={}){return r||c?this.concat(r,c,u)._parse(t,h):this._parse(t,h)}_parse(t,r){function c(u,h,m){return m==="assert"?new Qs(h,[u]):m==="coerce"?new el(h,[u]):u}if(t!==null&&typeof t!="string"&&typeof t!="boolean"&&typeof t!="number"||(t=["literal",t]),Array.isArray(t)){if(t.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const u=typeof t[0]=="string"?this.registry[t[0]]:void 0;if(u){let h=u.parse(t,this);if(!h)return null;if(this.expectedType){const m=this.expectedType,g=h.type;if(m.kind!=="string"&&m.kind!=="number"&&m.kind!=="boolean"&&m.kind!=="object"&&m.kind!=="array"||g.kind!=="value")if(m.kind!=="color"&&m.kind!=="formatted"&&m.kind!=="resolvedImage"||g.kind!=="value"&&g.kind!=="string"){if(this.checkSubtype(m,g))return null}else h=c(h,m,r.typeAnnotation||"coerce");else h=c(h,m,r.typeAnnotation||"assert")}if(!(h instanceof Mu)&&h.type.kind!=="resolvedImage"&&Wd(h)){const m=new Bf(this.options);try{h=new Mu(h.type,h.evaluate(m))}catch(g){return this.error(g.message),null}}return h}return el.parse(["to-array",t],this)}return this.error(t===void 0?"'undefined' value invalid. Use null instead.":typeof t=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof t} instead.`)}concat(t,r,c){const u=typeof t=="number"?this.path.concat(t):this.path,h=c?this.scope.concat(c):this.scope;return new gy(this.registry,u,r||null,h,this.errors,this.options)}error(t,...r){const c=`${this.key}${r.map(u=>`[${u}]`).join("")}`;this.errors.push(new Ps(c,t))}checkSubtype(t,r){const c=Ll(t,r);return c&&this.error(c),c}}var yy=gy;function Wd(a){if(a instanceof N_)return Wd(a.boundExpression);if(a instanceof Tr&&a.name==="error"||a instanceof Tr&&a.name==="config"||a instanceof rc||a instanceof cy||a instanceof ap)return!1;const t=a instanceof el||a instanceof Qs;let r=!0;return a.eachChild(c=>{r=t?r&&Wd(c):r&&c instanceof Mu}),!!r&&Ru(a)&&Ud(a,["zoom","heatmap-density","line-progress","raster-value","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center","measure-light"])}function jf(a,t){const r=a.length-1;let c,u,h=0,m=r,g=0;for(;h<=m;)if(g=Math.floor((h+m)/2),c=a[g],u=a[g+1],c<=t){if(g===r||t<u)return g;h=g+1}else{if(!(c>t))throw new Mr("Input is not a number.");m=g-1}return 0}class rp{constructor(t,r,c){this.type=t,this.input=r,this.labels=[],this.outputs=[];for(const[u,h]of c)this.labels.push(u),this.outputs.push(h)}static parse(t,r){if(t.length-1<4)return r.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return r.error("Expected an even number of arguments.");const c=r.parse(t[1],1,an);if(!c)return null;const u=[];let h=null;r.expectedType&&r.expectedType.kind!=="value"&&(h=r.expectedType);for(let m=1;m<t.length;m+=2){const g=m===1?-1/0:t[m],v=t[m+1],b=m,w=m+1;if(typeof g!="number")return r.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',b);if(u.length&&u[u.length-1][0]>=g)return r.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',b);const A=r.parse(v,w,h);if(!A)return null;h=h||A.type,u.push([g,A])}return new rp(h,c,u)}evaluate(t){const r=this.labels,c=this.outputs;if(r.length===1)return c[0].evaluate(t);const u=this.input.evaluate(t);if(u<=r[0])return c[0].evaluate(t);const h=r.length;return u>=r[h-1]?c[h-1].evaluate(t):c[jf(r,u)].evaluate(t)}eachChild(t){t(this.input);for(const r of this.outputs)t(r)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}serialize(){const t=["step",this.input.serialize()];for(let r=0;r<this.labels.length;r++)r>0&&t.push(this.labels[r]),t.push(this.outputs[r].serialize());return t}}var op=rp;function Ln(a,t,r){return a*(1-r)+t*r}function sp(a,t,r){return a.map((c,u)=>Ln(c,t[u],r))}var $f=Object.freeze({__proto__:null,array:sp,color:function(a,t,r){return new Sn(Ln(a.r,t.r,r),Ln(a.g,t.g,r),Ln(a.b,t.b,r),Ln(a.a,t.a,r))},number:Ln});const z_=.95047,F_=1.08883,B_=4/29,ku=6/29,U_=3*ku*ku,c2=ku*ku*ku,xC=Math.PI/180,u2=180/Math.PI;function W_(a){return a>c2?Math.pow(a,1/3):a/U_+B_}function V_(a){return a>ku?a*a*a:U_*(a-B_)}function vy(a){return 255*(a<=.0031308?12.92*a:1.055*Math.pow(a,1/2.4)-.055)}function _y(a){return(a/=255)<=.04045?a/12.92:Math.pow((a+.055)/1.055,2.4)}function G_(a){const t=_y(a.r),r=_y(a.g),c=_y(a.b),u=W_((.4124564*t+.3575761*r+.1804375*c)/z_),h=W_((.2126729*t+.7151522*r+.072175*c)/1);return{l:116*h-16,a:500*(u-h),b:200*(h-W_((.0193339*t+.119192*r+.9503041*c)/F_)),alpha:a.a}}function H_(a){let t=(a.l+16)/116,r=isNaN(a.a)?t:t+a.a/500,c=isNaN(a.b)?t:t-a.b/200;return t=1*V_(t),r=z_*V_(r),c=F_*V_(c),new Sn(vy(3.2404542*r-1.5371385*t-.4985314*c),vy(-.969266*r+1.8760108*t+.041556*c),vy(.0556434*r-.2040259*t+1.0572252*c),a.alpha)}function by(a,t,r){const c=t-a;return a+r*(c>180||c<-180?c-360*Math.round(c/360):c)}const Yf={forward:G_,reverse:H_,interpolate:function(a,t,r){return{l:Ln(a.l,t.l,r),a:Ln(a.a,t.a,r),b:Ln(a.b,t.b,r),alpha:Ln(a.alpha,t.alpha,r)}}},qf={forward:function(a){const{l:t,a:r,b:c}=G_(a),u=Math.atan2(c,r)*u2;return{h:u<0?u+360:u,c:Math.sqrt(r*r+c*c),l:t,alpha:a.a}},reverse:function(a){const t=a.h*xC,r=a.c;return H_({l:a.l,a:Math.cos(t)*r,b:Math.sin(t)*r,alpha:a.alpha})},interpolate:function(a,t,r){return{h:by(a.h,t.h,r),c:Ln(a.c,t.c,r),l:Ln(a.l,t.l,r),alpha:Ln(a.alpha,t.alpha,r)}}};var d2=Object.freeze({__proto__:null,hcl:qf,lab:Yf});class lp{constructor(t,r,c,u,h){this.type=t,this.operator=r,this.interpolation=c,this.input=u,this.labels=[],this.outputs=[];for(const[m,g]of h)this.labels.push(m),this.outputs.push(g)}static interpolationFactor(t,r,c,u){let h=0;if(t.name==="exponential")h=Xf(r,t.base,c,u);else if(t.name==="linear")h=Xf(r,1,c,u);else if(t.name==="cubic-bezier"){const m=t.controlPoints;h=new j(m[0],m[1],m[2],m[3]).solve(Xf(r,1,c,u))}return h}static parse(t,r){let[c,u,h,...m]=t;if(!Array.isArray(u)||u.length===0)return r.error("Expected an interpolation type expression.",1);if(u[0]==="linear")u={name:"linear"};else if(u[0]==="exponential"){const b=u[1];if(typeof b!="number")return r.error("Exponential interpolation requires a numeric base.",1,1);u={name:"exponential",base:b}}else{if(u[0]!=="cubic-bezier")return r.error(`Unknown interpolation type ${String(u[0])}`,1,0);{const b=u.slice(1);if(b.length!==4||b.some(w=>typeof w!="number"||w<0||w>1))return r.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);u={name:"cubic-bezier",controlPoints:b}}}if(t.length-1<4)return r.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return r.error("Expected an even number of arguments.");if(h=r.parse(h,2,an),!h)return null;const g=[];let v=null;c==="interpolate-hcl"||c==="interpolate-lab"?v=Qa:r.expectedType&&r.expectedType.kind!=="value"&&(v=r.expectedType);for(let b=0;b<m.length;b+=2){const w=m[b],A=m[b+1],C=b+3,P=b+4;if(typeof w!="number")return r.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',C);if(g.length&&g[g.length-1][0]>=w)return r.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',C);const k=r.parse(A,P,v);if(!k)return null;v=v||k.type,g.push([w,k])}return v.kind==="number"||v.kind==="color"||v.kind==="array"&&v.itemType.kind==="number"&&typeof v.N=="number"?new lp(v,c,u,h,g):r.error(`Type ${ma(v)} is not interpolatable.`)}evaluate(t){const r=this.labels,c=this.outputs;if(r.length===1)return c[0].evaluate(t);const u=this.input.evaluate(t);if(u<=r[0])return c[0].evaluate(t);const h=r.length;if(u>=r[h-1])return c[h-1].evaluate(t);const m=jf(r,u),g=lp.interpolationFactor(this.interpolation,u,r[m],r[m+1]),v=c[m].evaluate(t),b=c[m+1].evaluate(t);return this.operator==="interpolate"?$f[this.type.kind.toLowerCase()](v,b,g):this.operator==="interpolate-hcl"?qf.reverse(qf.interpolate(qf.forward(v),qf.forward(b),g)):Yf.reverse(Yf.interpolate(Yf.forward(v),Yf.forward(b),g))}eachChild(t){t(this.input);for(const r of this.outputs)t(r)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}serialize(){let t;t=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const r=[this.operator,t,this.input.serialize()];for(let c=0;c<this.labels.length;c++)r.push(this.labels[c],this.outputs[c].serialize());return r}}function Xf(a,t,r,c){const u=c-r,h=a-r;return u===0?0:t===1?h/u:(Math.pow(t,h)-1)/(Math.pow(t,u)-1)}var lc=lp;class xy{constructor(t,r){this.type=t,this.args=r}static parse(t,r){if(t.length<2)return r.error("Expectected at least one argument.");let c=null;const u=r.expectedType;u&&u.kind!=="value"&&(c=u);const h=[];for(const g of t.slice(1)){const v=r.parse(g,1+h.length,c,void 0,{typeAnnotation:"omit"});if(!v)return null;c=c||v.type,h.push(v)}const m=u&&h.some(g=>Ll(u,g.type));return new xy(m?oi:c,h)}evaluate(t){let r,c=null,u=0;for(const h of this.args){if(u++,c=h.evaluate(t),c&&c instanceof ts&&!c.available&&(r||(r=c),c=null,u===this.args.length))return r;if(c!==null)break}return c}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}serialize(){const t=["coalesce"];return this.eachChild(r=>{t.push(r.serialize())}),t}}var j_=xy;class wy{constructor(t,r){this.type=r.type,this.bindings=[].concat(t),this.result=r}evaluate(t){return this.result.evaluate(t)}eachChild(t){for(const r of this.bindings)t(r[1]);t(this.result)}static parse(t,r){if(t.length<4)return r.error(`Expected at least 3 arguments, but found ${t.length-1} instead.`);const c=[];for(let h=1;h<t.length-1;h+=2){const m=t[h];if(typeof m!="string")return r.error(`Expected string, but found ${typeof m} instead.`,h);if(/[^a-zA-Z0-9_]/.test(m))return r.error("Variable names must contain only alphanumeric characters or '_'.",h);const g=r.parse(t[h+1],h+1);if(!g)return null;c.push([m,g])}const u=r.parse(t[t.length-1],t.length-1,r.expectedType,c);return u?new wy(c,u):null}outputDefined(){return this.result.outputDefined()}serialize(){const t=["let"];for(const[r,c]of this.bindings)t.push(r,c.serialize());return t.push(this.result.serialize()),t}}var $_=wy;class Sy{constructor(t,r,c){this.type=t,this.index=r,this.input=c}static parse(t,r){if(t.length!==3)return r.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const c=r.parse(t[1],1,an),u=r.parse(t[2],2,Oa(r.expectedType||oi));return c&&u?new Sy(u.type.itemType,c,u):null}evaluate(t){const r=this.index.evaluate(t),c=this.input.evaluate(t);if(r<0)throw new Mr(`Array index out of bounds: ${r} < 0.`);if(r>=c.length)throw new Mr(`Array index out of bounds: ${r} > ${c.length-1}.`);if(r!==Math.floor(r))throw new Mr(`Array index must be an integer, but found ${r} instead.`);return c[r]}eachChild(t){t(this.index),t(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}var cc=Sy;class Ay{constructor(t,r){this.type=Ei,this.needle=t,this.haystack=r}static parse(t,r){if(t.length!==3)return r.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const c=r.parse(t[1],1,oi),u=r.parse(t[2],2,oi);return c&&u?Eo(c.type,[Ei,yi,an,Ks,oi])?new Ay(c,u):r.error(`Expected first argument to be of type boolean, string, number or null, but found ${ma(c.type)} instead`):null}evaluate(t){const r=this.needle.evaluate(t),c=this.haystack.evaluate(t);if(c==null)return!1;if(!fr(r,["boolean","string","number","null"]))throw new Mr(`Expected first argument to be of type boolean, string, number or null, but found ${ma(Ra(r))} instead.`);if(!fr(c,["string","array"]))throw new Mr(`Expected second argument to be of type array or string, but found ${ma(Ra(c))} instead.`);return c.indexOf(r)>=0}eachChild(t){t(this.needle),t(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}var Zf=Ay;class Du{constructor(t,r,c){this.type=an,this.needle=t,this.haystack=r,this.fromIndex=c}static parse(t,r){if(t.length<=2||t.length>=5)return r.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const c=r.parse(t[1],1,oi),u=r.parse(t[2],2,oi);if(!c||!u)return null;if(!Eo(c.type,[Ei,yi,an,Ks,oi]))return r.error(`Expected first argument to be of type boolean, string, number or null, but found ${ma(c.type)} instead`);if(t.length===4){const h=r.parse(t[3],3,an);return h?new Du(c,u,h):null}return new Du(c,u)}evaluate(t){const r=this.needle.evaluate(t),c=this.haystack.evaluate(t);if(!fr(r,["boolean","string","number","null"]))throw new Mr(`Expected first argument to be of type boolean, string, number or null, but found ${ma(Ra(r))} instead.`);if(!fr(c,["string","array"]))throw new Mr(`Expected second argument to be of type array or string, but found ${ma(Ra(c))} instead.`);if(this.fromIndex){const u=this.fromIndex.evaluate(t);return c.indexOf(r,u)}return c.indexOf(r)}eachChild(t){t(this.needle),t(this.haystack),this.fromIndex&&t(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const t=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),t]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}var Ey=Du;class cp{constructor(t,r,c,u,h,m){this.inputType=t,this.type=r,this.input=c,this.cases=u,this.outputs=h,this.otherwise=m}static parse(t,r){if(t.length<5)return r.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if(t.length%2!=1)return r.error("Expected an even number of arguments.");let c,u;r.expectedType&&r.expectedType.kind!=="value"&&(u=r.expectedType);const h={},m=[];for(let b=2;b<t.length-1;b+=2){let w=t[b];const A=t[b+1];Array.isArray(w)||(w=[w]);const C=r.concat(b);if(w.length===0)return C.error("Expected at least one branch label.");for(const k of w){if(typeof k!="number"&&typeof k!="string")return C.error("Branch labels must be numbers or strings.");if(typeof k=="number"&&Math.abs(k)>Number.MAX_SAFE_INTEGER)return C.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof k=="number"&&Math.floor(k)!==k)return C.error("Numeric branch labels must be integer values.");if(c){if(C.checkSubtype(c,Ra(k)))return null}else c=Ra(k);if(h[String(k)]!==void 0)return C.error("Branch labels must be unique.");h[String(k)]=m.length}const P=r.parse(A,b,u);if(!P)return null;u=u||P.type,m.push(P)}const g=r.parse(t[1],1,oi);if(!g)return null;const v=r.parse(t[t.length-1],t.length-1,u);return v?g.type.kind!=="value"&&r.concat(1).checkSubtype(c,g.type)?null:new cp(c,u,g,h,m,v):null}evaluate(t){const r=this.input.evaluate(t);return(Ra(r)===this.inputType&&this.outputs[this.cases[r]]||this.otherwise).evaluate(t)}eachChild(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)}outputDefined(){return this.outputs.every(t=>t.outputDefined())&&this.otherwise.outputDefined()}serialize(){const t=["match",this.input.serialize()],r=Object.keys(this.cases).sort(),c=[],u={};for(const m of r){const g=u[this.cases[m]];g===void 0?(u[this.cases[m]]=c.length,c.push([this.cases[m],[m]])):c[g][1].push(m)}const h=m=>this.inputType.kind==="number"?Number(m):m;for(const[m,g]of c)t.push(g.length===1?h(g[0]):g.map(h)),t.push(this.outputs[m].serialize());return t.push(this.otherwise.serialize()),t}}var h2=cp;class Vd{constructor(t,r,c){this.type=t,this.branches=r,this.otherwise=c}static parse(t,r){if(t.length<4)return r.error(`Expected at least 3 arguments, but found only ${t.length-1}.`);if(t.length%2!=0)return r.error("Expected an odd number of arguments.");let c;r.expectedType&&r.expectedType.kind!=="value"&&(c=r.expectedType);const u=[];for(let m=1;m<t.length-1;m+=2){const g=r.parse(t[m],m,Ei);if(!g)return null;const v=r.parse(t[m+1],m+1,c);if(!v)return null;u.push([g,v]),c=c||v.type}const h=r.parse(t[t.length-1],t.length-1,c);return h?new Vd(c,u,h):null}evaluate(t){for(const[r,c]of this.branches)if(r.evaluate(t))return c.evaluate(t);return this.otherwise.evaluate(t)}eachChild(t){for(const[r,c]of this.branches)t(r),t(c);t(this.otherwise)}outputDefined(){return this.branches.every(([t,r])=>r.outputDefined())&&this.otherwise.outputDefined()}serialize(){const t=["case"];return this.eachChild(r=>{t.push(r.serialize())}),t}}var No=Vd;class My{constructor(t,r,c,u){this.type=t,this.input=r,this.beginIndex=c,this.endIndex=u}static parse(t,r){if(t.length<=2||t.length>=5)return r.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const c=r.parse(t[1],1,oi),u=r.parse(t[2],2,an);if(!c||!u)return null;if(!Eo(c.type,[Oa(oi),yi,oi]))return r.error(`Expected first argument to be of type array or string, but found ${ma(c.type)} instead`);if(t.length===4){const h=r.parse(t[3],3,an);return h?new My(c.type,c,u,h):null}return new My(c.type,c,u)}evaluate(t){const r=this.input.evaluate(t),c=this.beginIndex.evaluate(t);if(!fr(r,["string","array"]))throw new Mr(`Expected first argument to be of type array or string, but found ${ma(Ra(r))} instead.`);if(this.endIndex){const u=this.endIndex.evaluate(t);return r.slice(c,u)}return r.slice(c)}eachChild(t){t(this.input),t(this.beginIndex),this.endIndex&&t(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const t=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),t]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}var wC=My;function as(a,t){return a==="=="||a==="!="?t.kind==="boolean"||t.kind==="string"||t.kind==="number"||t.kind==="null"||t.kind==="value":t.kind==="string"||t.kind==="number"||t.kind==="value"}function zo(a,t,r,c){return c.compare(t,r)===0}function Gd(a,t,r){const c=a!=="=="&&a!=="!=";return class WK{constructor(h,m,g){this.type=Ei,this.lhs=h,this.rhs=m,this.collator=g,this.hasUntypedArgument=h.type.kind==="value"||m.type.kind==="value"}static parse(h,m){if(h.length!==3&&h.length!==4)return m.error("Expected two or three arguments.");const g=h[0];let v=m.parse(h[1],1,oi);if(!v)return null;if(!as(g,v.type))return m.concat(1).error(`"${g}" comparisons are not supported for type '${ma(v.type)}'.`);let b=m.parse(h[2],2,oi);if(!b)return null;if(!as(g,b.type))return m.concat(2).error(`"${g}" comparisons are not supported for type '${ma(b.type)}'.`);if(v.type.kind!==b.type.kind&&v.type.kind!=="value"&&b.type.kind!=="value")return m.error(`Cannot compare types '${ma(v.type)}' and '${ma(b.type)}'.`);c&&(v.type.kind==="value"&&b.type.kind!=="value"?v=new Qs(b.type,[v]):v.type.kind!=="value"&&b.type.kind==="value"&&(b=new Qs(v.type,[b])));let w=null;if(h.length===4){if(v.type.kind!=="string"&&b.type.kind!=="string"&&v.type.kind!=="value"&&b.type.kind!=="value")return m.error("Cannot use collator to compare non-string types.");if(w=m.parse(h[3],3,Ho),!w)return null}return new WK(v,b,w)}evaluate(h){const m=this.lhs.evaluate(h),g=this.rhs.evaluate(h);if(c&&this.hasUntypedArgument){const v=Ra(m),b=Ra(g);if(v.kind!==b.kind||v.kind!=="string"&&v.kind!=="number")throw new Mr(`Expected arguments for "${a}" to be (string, string) or (number, number), but found (${v.kind}, ${b.kind}) instead.`)}if(this.collator&&!c&&this.hasUntypedArgument){const v=Ra(m),b=Ra(g);if(v.kind!=="string"||b.kind!=="string")return t(h,m,g)}return this.collator?r(h,m,g,this.collator.evaluate(h)):t(h,m,g)}eachChild(h){h(this.lhs),h(this.rhs),this.collator&&h(this.collator)}outputDefined(){return!0}serialize(){const h=[a];return this.eachChild(m=>{h.push(m.serialize())}),h}}}const p2=Gd("==",function(a,t,r){return t===r},zo),f2=Gd("!=",function(a,t,r){return t!==r},function(a,t,r,c){return!zo(0,t,r,c)}),m2=Gd("<",function(a,t,r){return t<r},function(a,t,r,c){return c.compare(t,r)<0}),g2=Gd(">",function(a,t,r){return t>r},function(a,t,r,c){return c.compare(t,r)>0}),Y_=Gd("<=",function(a,t,r){return t<=r},function(a,t,r,c){return c.compare(t,r)<=0}),y2=Gd(">=",function(a,t,r){return t>=r},function(a,t,r,c){return c.compare(t,r)>=0});class Kf{constructor(t,r,c,u,h,m){this.type=yi,this.number=t,this.locale=r,this.currency=c,this.unit=u,this.minFractionDigits=h,this.maxFractionDigits=m}static parse(t,r){if(t.length!==3)return r.error("Expected two arguments.");const c=r.parse(t[1],1,an);if(!c)return null;const u=t[2];if(typeof u!="object"||Array.isArray(u))return r.error("NumberFormat options argument must be an object.");let h=null;if(u.locale&&(h=r.parse(u.locale,1,yi),!h))return null;let m=null;if(u.currency&&(m=r.parse(u.currency,1,yi),!m))return null;let g=null;if(u.unit&&(g=r.parse(u.unit,1,yi),!g))return null;let v=null;if(u["min-fraction-digits"]&&(v=r.parse(u["min-fraction-digits"],1,an),!v))return null;let b=null;return u["max-fraction-digits"]&&(b=r.parse(u["max-fraction-digits"],1,an),!b)?null:new Kf(c,h,m,g,v,b)}evaluate(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(t):void 0,unit:this.unit?this.unit.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))}eachChild(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.unit&&t(this.unit),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const t={};return this.locale&&(t.locale=this.locale.serialize()),this.currency&&(t.currency=this.currency.serialize()),this.unit&&(t.unit=this.unit.serialize()),this.minFractionDigits&&(t["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(t["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),t]}}class Ty{constructor(t){this.type=an,this.input=t}static parse(t,r){if(t.length!==2)return r.error(`Expected 1 argument, but found ${t.length-1} instead.`);const c=r.parse(t[1],1);return c?c.type.kind!=="array"&&c.type.kind!=="string"&&c.type.kind!=="value"?r.error(`Expected argument of type string or array, but found ${ma(c.type)} instead.`):new Ty(c):null}evaluate(t){const r=this.input.evaluate(t);if(typeof r=="string"||Array.isArray(r))return r.length;throw new Mr(`Expected value to be of type string or array, but found ${ma(Ra(r))} instead.`)}eachChild(t){t(this.input)}outputDefined(){return!1}serialize(){const t=["length"];return this.eachChild(r=>{t.push(r.serialize())}),t}}function Cy(a){return function(){a=1831565813+(a|=0)|0;let t=Math.imul(a^a>>>15,1|a);return t=t+Math.imul(t^t>>>7,61|t)^t,((t^t>>>14)>>>0)/4294967296}}const Jf={"==":p2,"!=":f2,">":g2,"<":m2,">=":y2,"<=":Y_,array:Qs,at:cc,boolean:Qs,case:No,coalesce:j_,collator:rc,format:Kh,image:Jh,in:Zf,"index-of":Ey,interpolate:lc,"interpolate-hcl":lc,"interpolate-lab":lc,length:Ty,let:$_,literal:Mu,match:h2,number:Qs,"number-format":Kf,object:Qs,slice:wC,step:op,string:Qs,"to-boolean":el,"to-color":el,"to-number":el,"to-string":el,var:N_,within:cy,distance:ap};function Qf(a,[t,r,c,u]){t=t.evaluate(a),r=r.evaluate(a),c=c.evaluate(a);const h=u?u.evaluate(a):1,m=P_(t,r,c,h);if(m)throw new Mr(m);return new Sn(t/255*h,r/255*h,c/255*h,h)}function q_(a,[t,r,c,u]){t=t.evaluate(a),r=r.evaluate(a),c=c.evaluate(a);const h=u?u.evaluate(a):1,m=function(b,w,A,C){return typeof b=="number"&&b>=0&&b<=360?typeof w=="number"&&w>=0&&w<=100&&typeof A=="number"&&A>=0&&A<=100?C===void 0||typeof C=="number"&&C>=0&&C<=1?null:`Invalid hsla value [${[b,w,A,C].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid hsla value [${(typeof C=="number"?[b,w,A,C]:[b,w,A]).join(", ")}]: 's', and 'l' must be between 0 and 100.`:`Invalid hsla value [${(typeof C=="number"?[b,w,A,C]:[b,w,A]).join(", ")}]: 'h' must be between 0 and 360.`}(t,r,c,h);if(m)throw new Mr(m);const g=`hsla(${t}, ${r}%, ${c}%, ${h})`,v=Sn.parse(g);if(!v)throw new Mr(`Failed to parse HSLA color: ${g}`);return v}function Py(a,t){return a in t}function Iy(a,t){const r=t[a];return r===void 0?null:r}function X_(a,t,r){r.length&&(t+=`${r}`);const c=a.getConfig(t);return c?c.evaluate(a):null}function uc(a){return{type:a}}Tr.register(Jf,{error:[{kind:"error"},[yi],(a,[t])=>{throw new Mr(t.evaluate(a))}],typeof:[yi,[oi],(a,[t])=>ma(Ra(t.evaluate(a)))],"to-rgba":[Oa(an,4),[Qa],(a,[t])=>t.evaluate(a).toArray()],rgb:[Qa,[an,an,an],Qf],rgba:[Qa,[an,an,an,an],Qf],hsl:[Qa,[an,an,an],q_],hsla:[Qa,[an,an,an,an],q_],has:{type:Ei,overloads:[[[yi],(a,[t])=>Py(t.evaluate(a),a.properties())],[[yi,Fr],(a,[t,r])=>Py(t.evaluate(a),r.evaluate(a))]]},get:{type:oi,overloads:[[[yi],(a,[t])=>Iy(t.evaluate(a),a.properties())],[[yi,Fr],(a,[t,r])=>Iy(t.evaluate(a),r.evaluate(a))]]},config:{type:oi,overloads:[[[yi],(a,[t])=>X_(a,t.evaluate(a),"")],[[yi,yi],(a,[t,r])=>X_(a,t.evaluate(a),r.evaluate(a))]]},"feature-state":[oi,[yi],(a,[t])=>Iy(t.evaluate(a),a.featureState||{})],properties:[Fr,[],a=>a.properties()],"geometry-type":[yi,[],a=>a.geometryType()],id:[oi,[],a=>a.id()],zoom:[an,[],a=>a.globals.zoom],pitch:[an,[],a=>a.globals.pitch||0],"distance-from-center":[an,[],a=>a.distanceFromCenter()],"measure-light":[an,[yi],(a,[t])=>a.measureLight(t.evaluate(a))],"heatmap-density":[an,[],a=>a.globals.heatmapDensity||0],"line-progress":[an,[],a=>a.globals.lineProgress||0],"raster-value":[an,[],a=>a.globals.rasterValue||0],"sky-radial-progress":[an,[],a=>a.globals.skyRadialProgress||0],accumulated:[oi,[],a=>a.globals.accumulated===void 0?null:a.globals.accumulated],"+":[an,uc(an),(a,t)=>{let r=0;for(const c of t)r+=c.evaluate(a);return r}],"*":[an,uc(an),(a,t)=>{let r=1;for(const c of t)r*=c.evaluate(a);return r}],"-":{type:an,overloads:[[[an,an],(a,[t,r])=>t.evaluate(a)-r.evaluate(a)],[[an],(a,[t])=>-t.evaluate(a)]]},"/":[an,[an,an],(a,[t,r])=>t.evaluate(a)/r.evaluate(a)],"%":[an,[an,an],(a,[t,r])=>t.evaluate(a)%r.evaluate(a)],ln2:[an,[],()=>Math.LN2],pi:[an,[],()=>Math.PI],e:[an,[],()=>Math.E],"^":[an,[an,an],(a,[t,r])=>Math.pow(t.evaluate(a),r.evaluate(a))],sqrt:[an,[an],(a,[t])=>Math.sqrt(t.evaluate(a))],log10:[an,[an],(a,[t])=>Math.log(t.evaluate(a))/Math.LN10],ln:[an,[an],(a,[t])=>Math.log(t.evaluate(a))],log2:[an,[an],(a,[t])=>Math.log(t.evaluate(a))/Math.LN2],sin:[an,[an],(a,[t])=>Math.sin(t.evaluate(a))],cos:[an,[an],(a,[t])=>Math.cos(t.evaluate(a))],tan:[an,[an],(a,[t])=>Math.tan(t.evaluate(a))],asin:[an,[an],(a,[t])=>Math.asin(t.evaluate(a))],acos:[an,[an],(a,[t])=>Math.acos(t.evaluate(a))],atan:[an,[an],(a,[t])=>Math.atan(t.evaluate(a))],min:[an,uc(an),(a,t)=>Math.min(...t.map(r=>r.evaluate(a)))],max:[an,uc(an),(a,t)=>Math.max(...t.map(r=>r.evaluate(a)))],abs:[an,[an],(a,[t])=>Math.abs(t.evaluate(a))],round:[an,[an],(a,[t])=>{const r=t.evaluate(a);return r<0?-Math.round(-r):Math.round(r)}],floor:[an,[an],(a,[t])=>Math.floor(t.evaluate(a))],ceil:[an,[an],(a,[t])=>Math.ceil(t.evaluate(a))],"filter-==":[Ei,[yi,oi],(a,[t,r])=>a.properties()[t.value]===r.value],"filter-id-==":[Ei,[oi],(a,[t])=>a.id()===t.value],"filter-type-==":[Ei,[yi],(a,[t])=>a.geometryType()===t.value],"filter-<":[Ei,[yi,oi],(a,[t,r])=>{const c=a.properties()[t.value],u=r.value;return typeof c==typeof u&&c<u}],"filter-id-<":[Ei,[oi],(a,[t])=>{const r=a.id(),c=t.value;return typeof r==typeof c&&r<c}],"filter->":[Ei,[yi,oi],(a,[t,r])=>{const c=a.properties()[t.value],u=r.value;return typeof c==typeof u&&c>u}],"filter-id->":[Ei,[oi],(a,[t])=>{const r=a.id(),c=t.value;return typeof r==typeof c&&r>c}],"filter-<=":[Ei,[yi,oi],(a,[t,r])=>{const c=a.properties()[t.value],u=r.value;return typeof c==typeof u&&c<=u}],"filter-id-<=":[Ei,[oi],(a,[t])=>{const r=a.id(),c=t.value;return typeof r==typeof c&&r<=c}],"filter->=":[Ei,[yi,oi],(a,[t,r])=>{const c=a.properties()[t.value],u=r.value;return typeof c==typeof u&&c>=u}],"filter-id->=":[Ei,[oi],(a,[t])=>{const r=a.id(),c=t.value;return typeof r==typeof c&&r>=c}],"filter-has":[Ei,[oi],(a,[t])=>t.value in a.properties()],"filter-has-id":[Ei,[],a=>a.id()!==null&&a.id()!==void 0],"filter-type-in":[Ei,[Oa(yi)],(a,[t])=>t.value.indexOf(a.geometryType())>=0],"filter-id-in":[Ei,[Oa(oi)],(a,[t])=>t.value.indexOf(a.id())>=0],"filter-in-small":[Ei,[yi,Oa(oi)],(a,[t,r])=>r.value.indexOf(a.properties()[t.value])>=0],"filter-in-large":[Ei,[yi,Oa(oi)],(a,[t,r])=>function(c,u,h,m){for(;h<=m;){const g=h+m>>1;if(u[g]===c)return!0;u[g]>c?m=g-1:h=g+1}return!1}(a.properties()[t.value],r.value,0,r.value.length-1)],all:{type:Ei,overloads:[[[Ei,Ei],(a,[t,r])=>t.evaluate(a)&&r.evaluate(a)],[uc(Ei),(a,t)=>{for(const r of t)if(!r.evaluate(a))return!1;return!0}]]},any:{type:Ei,overloads:[[[Ei,Ei],(a,[t,r])=>t.evaluate(a)||r.evaluate(a)],[uc(Ei),(a,t)=>{for(const r of t)if(r.evaluate(a))return!0;return!1}]]},"!":[Ei,[Ei],(a,[t])=>!t.evaluate(a)],"is-supported-script":[Ei,[yi],(a,[t])=>{const r=a.globals&&a.globals.isSupportedScript;return!r||r(t.evaluate(a))}],upcase:[yi,[yi],(a,[t])=>t.evaluate(a).toUpperCase()],downcase:[yi,[yi],(a,[t])=>t.evaluate(a).toLowerCase()],concat:[yi,uc(oi),(a,t)=>t.map(r=>Eu(r.evaluate(a))).join("")],"resolved-locale":[yi,[Ho],(a,[t])=>t.evaluate(a).resolvedLocale()],random:[an,[an,an,oi],(a,t)=>{const[r,c,u]=t.map(m=>m.evaluate(a));if(r>c||r===c)return r;let h;if(typeof u=="string")h=function(m){let g=0;if(m.length===0)return g;for(let v=0;v<m.length;v++)g=(g<<5)-g+m.charCodeAt(v),g&=g;return g}(u);else{if(typeof u!="number")throw new Mr(`Invalid seed input: ${u}`);h=u}return r+Cy(h)()*(c-r)}]});var up=Jf;function Ly(a){return{result:"success",value:a}}function Ou(a){return{result:"error",value:a}}function dc(a,t){return!!a&&!!a.parameters&&a.parameters.indexOf(t)>-1}function Hd(a){return a["property-type"]==="data-driven"}function v2(a){return dc(a.expression,"measure-light")}function dp(a){return dc(a.expression,"zoom")}function zc(a){return!!a.expression&&a.expression.interpolated}function Ry(a){return typeof a=="object"&&a!==null&&!Array.isArray(a)}function An(a){return a}function em(a,t){const r=t.type==="color",c=a.stops&&typeof a.stops[0][0]=="object",u=c||!(c||a.property!==void 0),h=a.type||(zc(t)?"exponential":"interval");if(r&&((a=Cs({},a)).stops&&(a.stops=a.stops.map(b=>[b[0],Sn.parse(b[1])])),a.default=Sn.parse(a.default?a.default:t.default)),a.colorSpace&&a.colorSpace!=="rgb"&&!d2[a.colorSpace])throw new Error(`Unknown color space: ${a.colorSpace}`);let m,g,v;if(h==="exponential")m=Nu;else if(h==="interval")m=SC;else if(h==="categorical"){m=_2,g=Object.create(null);for(const b of a.stops)g[b[0]]=b[1];v=typeof a.stops[0][0]}else{if(h!=="identity")throw new Error(`Unknown function type "${h}"`);m=tm}if(c){const b={},w=[];for(let P=0;P<a.stops.length;P++){const k=a.stops[P],z=k[0].zoom;b[z]===void 0&&(b[z]={zoom:z,type:a.type,property:a.property,default:a.default,stops:[]},w.push(z)),b[z].stops.push([k[0].value,k[1]])}const A=[];for(const P of w)A.push([b[P].zoom,em(b[P],t)]);const C={name:"linear"};return{kind:"composite",interpolationType:C,interpolationFactor:lc.interpolationFactor.bind(void 0,C),zoomStops:A.map(P=>P[0]),evaluate:({zoom:P},k)=>Nu({stops:A,base:a.base},t,P).evaluate(P,k)}}if(u){const b=h==="exponential"?{name:"exponential",base:a.base!==void 0?a.base:1}:null;return{kind:"camera",interpolationType:b,interpolationFactor:lc.interpolationFactor.bind(void 0,b),zoomStops:a.stops.map(w=>w[0]),evaluate:({zoom:w})=>m(a,t,w,g,v)}}return{kind:"source",evaluate(b,w){const A=w&&w.properties?w.properties[a.property]:void 0;return A===void 0?jd(a.default,t.default):m(a,t,A,g,v)}}}function jd(a,t,r){return a!==void 0?a:t!==void 0?t:r!==void 0?r:void 0}function _2(a,t,r,c,u){return jd(typeof r===u?c[r]:void 0,a.default,t.default)}function SC(a,t,r){if(Oi(r)!=="number")return jd(a.default,t.default);const c=a.stops.length;if(c===1||r<=a.stops[0][0])return a.stops[0][1];if(r>=a.stops[c-1][0])return a.stops[c-1][1];const u=jf(a.stops.map(h=>h[0]),r);return a.stops[u][1]}function Nu(a,t,r){const c=a.base!==void 0?a.base:1;if(Oi(r)!=="number")return jd(a.default,t.default);const u=a.stops.length;if(u===1||r<=a.stops[0][0])return a.stops[0][1];if(r>=a.stops[u-1][0])return a.stops[u-1][1];const h=jf(a.stops.map(w=>w[0]),r),m=function(w,A,C,P){const k=P-C,z=w-C;return k===0?0:A===1?z/k:(Math.pow(A,z)-1)/(Math.pow(A,k)-1)}(r,c,a.stops[h][0],a.stops[h+1][0]),g=a.stops[h][1],v=a.stops[h+1][1];let b=$f[t.type]||An;if(a.colorSpace&&a.colorSpace!=="rgb"){const w=d2[a.colorSpace];b=(A,C)=>w.reverse(w.interpolate(w.forward(A),w.forward(C),m))}return typeof g.evaluate=="function"?{evaluate(...w){const A=g.evaluate.apply(void 0,w),C=v.evaluate.apply(void 0,w);if(A!==void 0&&C!==void 0)return b(A,C,m)}}:b(g,v,m)}function tm(a,t,r){return t.type==="color"?r=Sn.parse(r):t.type==="formatted"?r=Er.fromString(r.toString()):t.type==="resolvedImage"?r=ts.fromString(r.toString()):Oi(r)===t.type||t.type==="enum"&&t.values[r]||(r=void 0),jd(r,a.default,t.default)}class nm{constructor(t,r,c){this.expression=t,this._warningHistory={},this._evaluator=new Bf(c),this._defaultValue=r?function(u){return u.type==="color"&&(Ry(u.default)||Array.isArray(u.default))?new Sn(0,0,0,0):u.type==="color"?Sn.parse(u.default)||null:u.default===void 0?null:u.default}(r):null,this._enumValues=r&&r.type==="enum"?r.values:null}evaluateWithoutErrorHandling(t,r,c,u,h,m,g,v){return this._evaluator.globals=t,this._evaluator.feature=r,this._evaluator.featureState=c,this._evaluator.canonical=u||null,this._evaluator.availableImages=h||null,this._evaluator.formattedSection=m,this._evaluator.featureTileCoord=g||null,this._evaluator.featureDistanceData=v||null,this.expression.evaluate(this._evaluator)}evaluate(t,r,c,u,h,m,g,v){this._evaluator.globals=t,this._evaluator.feature=r||null,this._evaluator.featureState=c||null,this._evaluator.canonical=u||null,this._evaluator.availableImages=h||null,this._evaluator.formattedSection=m||null,this._evaluator.featureTileCoord=g||null,this._evaluator.featureDistanceData=v||null;try{const b=this.expression.evaluate(this._evaluator);if(b==null||typeof b=="number"&&b!=b)return this._defaultValue;if(this._enumValues&&!(b in this._enumValues))throw new Mr(`Expected value to be one of ${Object.keys(this._enumValues).map(w=>JSON.stringify(w)).join(", ")}, but found ${JSON.stringify(b)} instead.`);return b}catch(b){return this._warningHistory[b.message]||(this._warningHistory[b.message]=!0,typeof console<"u"&&console.warn(b.message)),this._defaultValue}}}function im(a){return Array.isArray(a)&&a.length>0&&typeof a[0]=="string"&&a[0]in up}function Fc(a,t,r){const c=new yy(up,[],t?function(h){const m={color:Qa,string:yi,number:an,enum:yi,boolean:Ei,formatted:kc,resolvedImage:Dc};return h.type==="array"?Oa(m[h.value]||oi,h.length):m[h.type]}(t):void 0,void 0,void 0,r),u=c.parse(a,void 0,void 0,void 0,t&&t.type==="string"?{typeAnnotation:"coerce"}:void 0);return u?Ly(new nm(u,t,r)):Ou(c.errors)}class ky{constructor(t,r,c){this.kind=t,this._styleExpression=r,this.isLightConstant=c,this.isStateDependent=t!=="constant"&&!Hf(r.expression),this.isConfigDependent=!fy(r.expression)}evaluateWithoutErrorHandling(t,r,c,u,h,m){return this._styleExpression.evaluateWithoutErrorHandling(t,r,c,u,h,m)}evaluate(t,r,c,u,h,m){return this._styleExpression.evaluate(t,r,c,u,h,m)}}class Bc{constructor(t,r,c,u,h){this.kind=t,this.zoomStops=c,this._styleExpression=r,this.isStateDependent=t!=="camera"&&!Hf(r.expression),this.isLightConstant=h,this.isConfigDependent=!fy(r.expression),this.interpolationType=u}evaluateWithoutErrorHandling(t,r,c,u,h,m){return this._styleExpression.evaluateWithoutErrorHandling(t,r,c,u,h,m)}evaluate(t,r,c,u,h,m){return this._styleExpression.evaluate(t,r,c,u,h,m)}interpolationFactor(t,r,c){return this.interpolationType?lc.interpolationFactor(this.interpolationType,t,r,c):0}}function Dy(a,t,r){if((a=Fc(a,t,r)).result==="error")return a;const c=a.value.expression,u=Ru(c);if(!u&&!Hd(t))return Ou([new Ps("","data expressions not supported")]);const h=Ud(c,["zoom","pitch","distance-from-center"]);if(!h&&!dp(t))return Ou([new Ps("","zoom expressions not supported")]);const m=Ud(c,["measure-light"]);if(!m&&!v2(t))return Ou([new Ps("","measure-light expression not supported")]);const g=t.expression&&t.expression.relaxZoomRestriction,v=hp(c);return v||h||g?v instanceof Ps?Ou([v]):v instanceof lc&&!zc(t)?Ou([new Ps("",'"interpolate" expressions cannot be used with this property')]):Ly(v?new Bc(u?"camera":"composite",a.value,v.labels,v instanceof lc?v.interpolation:void 0,m):new ky(u?"constant":"source",a.value,m)):Ou([new Ps("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression, or in the properties of atmosphere.')])}class am{constructor(t,r){this._parameters=t,this._specification=r,Cs(this,em(this._parameters,this._specification))}static deserialize(t){return new am(t._parameters,t._specification)}static serialize(t){return{_parameters:t._parameters,_specification:t._specification}}}function hp(a){let t=null;if(a instanceof $_)t=hp(a.result);else if(a instanceof j_){for(const r of a.args)if(t=hp(r),t)break}else(a instanceof op||a instanceof lc)&&a.input instanceof Tr&&a.input.name==="zoom"&&(t=a);return t instanceof Ps||a.eachChild(r=>{const c=hp(r);c instanceof Ps?t=c:t&&c&&t!==c&&(t=new Ps("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),t}function rs(a){const t=a.key,r=a.value,c=a.valueSpec||{},u=a.objectElementValidators||{},h=a.style,m=a.styleSpec;let g=[];const v=Oi(r);if(v!=="object")return[new ln(t,r,`object expected, ${v} found`)];for(const b in r){const w=b.split(".")[0];let A;u[w]?A=u[w]:c[w]?A=rr:u["*"]?A=u["*"]:c["*"]&&(A=rr),A?g=g.concat(A({key:(t&&`${t}.`)+b,value:r[b],valueSpec:c[w]||c["*"],style:h,styleSpec:m,object:r,objectKey:b},r)):g.push(new Zs(t,r[b],`unknown property "${b}"`))}for(const b in c)u[b]||c[b].required&&c[b].default===void 0&&r[b]===void 0&&g.push(new ln(t,r,`missing required property "${b}"`));return g}function Z_(a){const t=a.value,r=a.valueSpec,c=a.style,u=a.styleSpec,h=a.key,m=a.arrayElementValidator||rr;if(Oi(t)!=="array")return[new ln(h,t,`array expected, ${Oi(t)} found`)];if(r.length&&t.length!==r.length)return[new ln(h,t,`array length ${r.length} expected, length ${t.length} found`)];if(r["min-length"]&&t.length<r["min-length"])return[new ln(h,t,`array length at least ${r["min-length"]} expected, length ${t.length} found`)];let g={type:r.value,values:r.values,minimum:r.minimum,maximum:r.maximum,function:void 0};u.$version<7&&(g.function=r.function),Oi(r.value)==="object"&&(g=r.value);let v=[];for(let b=0;b<t.length;b++)v=v.concat(m({array:t,arrayIndex:b,value:t[b],valueSpec:g,style:c,styleSpec:u,key:`${h}[${b}]`},!0));return v}function Oy(a){const t=a.key,r=a.value,c=a.valueSpec;let u=Oi(r);if(u==="number"&&r!=r&&(u="NaN"),u!=="number")return[new ln(t,r,`number expected, ${u} found`)];if("minimum"in c){let h=c.minimum;if(Oi(c.minimum)==="array"&&(h=c.minimum[a.arrayIndex]),r<h)return[new ln(t,r,`${r} is less than the minimum value ${h}`)]}if("maximum"in c){let h=c.maximum;if(Oi(c.maximum)==="array"&&(h=c.maximum[a.arrayIndex]),r>h)return[new ln(t,r,`${r} is greater than the maximum value ${h}`)]}return[]}function rm(a){const t=a.valueSpec,r=Ga(a.value.type);let c,u,h,m={};const g=r!=="categorical"&&a.value.property===void 0,v=!g,b=Oi(a.value.stops)==="array"&&Oi(a.value.stops[0])==="array"&&Oi(a.value.stops[0][0])==="object",w=rs({key:a.key,value:a.value,valueSpec:a.styleSpec.function,style:a.style,styleSpec:a.styleSpec,objectElementValidators:{stops:function(P){if(r==="identity")return[new ln(P.key,P.value,'identity function may not have a "stops" property')];let k=[];const z=P.value;return k=k.concat(Z_({key:P.key,value:z,valueSpec:P.valueSpec,style:P.style,styleSpec:P.styleSpec,arrayElementValidator:A})),Oi(z)==="array"&&z.length===0&&k.push(new ln(P.key,z,"array must have at least one stop")),k},default:function(P){return rr({key:P.key,value:P.value,valueSpec:t,style:P.style,styleSpec:P.styleSpec})}}});return r==="identity"&&g&&w.push(new ln(a.key,a.value,'missing required property "property"')),r==="identity"||a.value.stops||w.push(new ln(a.key,a.value,'missing required property "stops"')),r==="exponential"&&a.valueSpec.expression&&!zc(a.valueSpec)&&w.push(new ln(a.key,a.value,"exponential functions not supported")),a.styleSpec.$version>=8&&(v&&!Hd(a.valueSpec)?w.push(new ln(a.key,a.value,"property functions not supported")):g&&!dp(a.valueSpec)&&w.push(new ln(a.key,a.value,"zoom functions not supported"))),r!=="categorical"&&!b||a.value.property!==void 0||w.push(new ln(a.key,a.value,'"property" property is required')),w;function A(P){let k=[];const z=P.value,U=P.key;if(Oi(z)!=="array")return[new ln(U,z,`array expected, ${Oi(z)} found`)];if(z.length!==2)return[new ln(U,z,`array length 2 expected, length ${z.length} found`)];if(b){if(Oi(z[0])!=="object")return[new ln(U,z,`object expected, ${Oi(z[0])} found`)];if(z[0].zoom===void 0)return[new ln(U,z,"object stop key must have zoom")];if(z[0].value===void 0)return[new ln(U,z,"object stop key must have value")];const W=Ga(z[0].zoom);if(typeof W!="number")return[new ln(U,z[0].zoom,"stop zoom values must be numbers")];if(h&&h>W)return[new ln(U,z[0].zoom,"stop zoom values must appear in ascending order")];W!==h&&(h=W,u=void 0,m={}),k=k.concat(rs({key:`${U}[0]`,value:z[0],valueSpec:{zoom:{}},style:P.style,styleSpec:P.styleSpec,objectElementValidators:{zoom:Oy,value:C}}))}else k=k.concat(C({key:`${U}[0]`,value:z[0],valueSpec:{},style:P.style,styleSpec:P.styleSpec},z));return im(oa(z[1]))?k.concat([new ln(`${U}[1]`,z[1],"expressions are not allowed in function stops.")]):k.concat(rr({key:`${U}[1]`,value:z[1],valueSpec:t,style:P.style,styleSpec:P.styleSpec}))}function C(P,k){const z=Oi(P.value),U=Ga(P.value),W=P.value!==null?P.value:k;if(c){if(z!==c)return[new ln(P.key,W,`${z} stop domain type must match previous stop domain type ${c}`)]}else c=z;if(z!=="number"&&z!=="string"&&z!=="boolean"&&typeof U!="number"&&typeof U!="string"&&typeof U!="boolean")return[new ln(P.key,W,"stop domain value must be a number, string, or boolean")];if(z!=="number"&&r!=="categorical"){let $=`number expected, ${z} found`;return Hd(t)&&r===void 0&&($+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new ln(P.key,W,$)]}return r!=="categorical"||z!=="number"||typeof U=="number"&&isFinite(U)&&Math.floor(U)===U?r!=="categorical"&&z==="number"&&typeof U=="number"&&typeof u=="number"&&u!==void 0&&U<u?[new ln(P.key,W,"stop domain values must appear in ascending order")]:(u=U,r==="categorical"&&U in m?[new ln(P.key,W,"stop domain values must be unique")]:(m[U]=!0,[])):[new ln(P.key,W,`integer expected, found ${String(U)}`)]}}function $d(a){const t=(a.expressionContext==="property"?Dy:Fc)(oa(a.value),a.valueSpec);if(t.result==="error")return t.value.map(c=>new ln(`${a.key}${c.key}`,a.value,c.message));const r=t.value.expression||t.value._styleExpression.expression;if(a.expressionContext==="property"&&a.propertyKey==="text-font"&&!r.outputDefined())return[new ln(a.key,a.value,`Invalid data expression for "${a.propertyKey}". Output values must be contained as literals within the expression.`)];if(a.expressionContext==="property"&&a.propertyType==="layout"&&!Hf(r))return[new ln(a.key,a.value,'"feature-state" data expressions are not supported with layout properties.')];if(a.expressionContext==="filter")return b2(r,a);if(a.expressionContext&&a.expressionContext.indexOf("cluster")===0){if(!Ud(r,["zoom","feature-state"]))return[new ln(a.key,a.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(a.expressionContext==="cluster-initial"&&!Ru(r))return[new ln(a.key,a.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function b2(a,t){const r=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(t.valueSpec&&t.valueSpec.expression)for(const u of t.valueSpec.expression.parameters)r.delete(u);if(r.size===0)return[];const c=[];return a instanceof Tr&&r.has(a.name)?[new ln(t.key,t.value,`["${a.name}"] expression is not supported in a filter for a ${t.object.type} layer with id: ${t.object.id}`)]:(a.eachChild(u=>{c.push(...b2(u,t))}),c)}function om(a){const t=a.key,r=a.value,c=a.valueSpec,u=[];return Array.isArray(c.values)?c.values.indexOf(Ga(r))===-1&&u.push(new ln(t,r,`expected one of [${c.values.join(", ")}], ${JSON.stringify(r)} found`)):Object.keys(c.values).indexOf(Ga(r))===-1&&u.push(new ln(t,r,`expected one of [${Object.keys(c.values).join(", ")}], ${JSON.stringify(r)} found`)),u}function Ny(a){if(a===!0||a===!1)return!0;if(!Array.isArray(a)||a.length===0)return!1;switch(a[0]){case"has":return a.length>=2&&a[1]!=="$id"&&a[1]!=="$type";case"in":return a.length>=3&&(typeof a[1]!="string"||Array.isArray(a[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return a.length!==3||Array.isArray(a[1])||Array.isArray(a[2]);case"any":case"all":for(const t of a.slice(1))if(!Ny(t)&&typeof t!="boolean")return!1;return!0;default:return!0}}function sm(a,t="fill"){if(a==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};Ny(a)||(a=zu(a));const r=a;let c=!0;try{c=function(b){if(!Uc(b))return b;let w=oa(b);return lm(w),w=K_(w),w}(r)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(r,null,2)}
        `)}const u=at[`filter_${t}`],h=Fc(c,u);let m=null;if(h.result==="error")throw new Error(h.value.map(b=>`${b.key}: ${b.message}`).join(", "));m=(b,w,A)=>h.value.evaluate(b,w,{},A);let g=null,v=null;if(c!==r){const b=Fc(r,u);if(b.result==="error")throw new Error(b.value.map(w=>`${w.key}: ${w.message}`).join(", "));g=(w,A,C,P,k)=>b.value.evaluate(w,A,{},C,void 0,void 0,P,k),v=!Ru(b.value.expression)}return{filter:m,dynamicFilter:g||void 0,needGeometry:cm(c),needFeature:!!v}}function K_(a){if(!Array.isArray(a))return a;const t=function(r){if(zy.has(r[0])){for(let c=1;c<r.length;c++)if(Uc(r[c]))return!0}return r}(a);return t===!0?t:t.map(r=>K_(r))}function lm(a){let t=!1;const r=[];if(a[0]==="case"){for(let c=1;c<a.length-1;c+=2)t=t||Uc(a[c]),r.push(a[c+1]);r.push(a[a.length-1])}else if(a[0]==="match"){t=t||Uc(a[1]);for(let c=2;c<a.length-1;c+=2)r.push(a[c+1]);r.push(a[a.length-1])}else if(a[0]==="step"){t=t||Uc(a[1]);for(let c=1;c<a.length-1;c+=2)r.push(a[c+1])}t&&(a.length=0,a.push("any",...r));for(let c=1;c<a.length;c++)lm(a[c])}function Uc(a){if(!Array.isArray(a))return!1;if((t=a[0])==="pitch"||t==="distance-from-center")return!0;var t;for(let r=1;r<a.length;r++)if(Uc(a[r]))return!0;return!1}const zy=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function Fy(a,t){return a<t?-1:a>t?1:0}function cm(a){if(!Array.isArray(a))return!1;if(a[0]==="within"||a[0]==="distance")return!0;for(let t=1;t<a.length;t++)if(cm(a[t]))return!0;return!1}function zu(a){if(!a)return!0;const t=a[0];return a.length<=1?t!=="any":t==="=="?um(a[1],a[2],"=="):t==="!="?dm(um(a[1],a[2],"==")):t==="<"||t===">"||t==="<="||t===">="?um(a[1],a[2],t):t==="any"?(r=a.slice(1),["any"].concat(r.map(zu))):t==="all"?["all"].concat(a.slice(1).map(zu)):t==="none"?["all"].concat(a.slice(1).map(zu).map(dm)):t==="in"?By(a[1],a.slice(2)):t==="!in"?dm(By(a[1],a.slice(2))):t==="has"?Uy(a[1]):t!=="!has"||dm(Uy(a[1]));var r}function um(a,t,r){switch(a){case"$type":return[`filter-type-${r}`,t];case"$id":return[`filter-id-${r}`,t];default:return[`filter-${r}`,a,t]}}function By(a,t){if(t.length===0)return!1;switch(a){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some(r=>typeof r!=typeof t[0])?["filter-in-large",a,["literal",t.sort(Fy)]]:["filter-in-small",a,["literal",t]]}}function Uy(a){switch(a){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",a]}}function dm(a){return["!",a]}function hm(a){return Ny(oa(a.value))?$d(Cs({},a,{expressionContext:"filter",valueSpec:a.styleSpec[`filter_${a.layerType||"fill"}`]})):x2(a)}function x2(a){const t=a.value,r=a.key;if(Oi(t)!=="array")return[new ln(r,t,`array expected, ${Oi(t)} found`)];const c=a.styleSpec;let u,h=[];if(t.length<1)return[new ln(r,t,"filter array must have at least 1 element")];switch(h=h.concat(om({key:`${r}[0]`,value:t[0],valueSpec:c.filter_operator,style:a.style,styleSpec:a.styleSpec})),Ga(t[0])){case"<":case"<=":case">":case">=":t.length>=2&&Ga(t[1])==="$type"&&h.push(new ln(r,t,`"$type" cannot be use with operator "${t[0]}"`));case"==":case"!=":t.length!==3&&h.push(new ln(r,t,`filter array for operator "${t[0]}" must have 3 elements`));case"in":case"!in":t.length>=2&&(u=Oi(t[1]),u!=="string"&&h.push(new ln(`${r}[1]`,t[1],`string expected, ${u} found`)));for(let m=2;m<t.length;m++)u=Oi(t[m]),Ga(t[1])==="$type"?h=h.concat(om({key:`${r}[${m}]`,value:t[m],valueSpec:c.geometry_type,style:a.style,styleSpec:a.styleSpec})):u!=="string"&&u!=="number"&&u!=="boolean"&&h.push(new ln(`${r}[${m}]`,t[m],`string, number, or boolean expected, ${u} found`));break;case"any":case"all":case"none":for(let m=1;m<t.length;m++)h=h.concat(x2({key:`${r}[${m}]`,value:t[m],style:a.style,styleSpec:a.styleSpec}));break;case"has":case"!has":u=Oi(t[1]),t.length!==2?h.push(new ln(r,t,`filter array for "${t[0]}" operator must have 2 elements`)):u!=="string"&&h.push(new ln(`${r}[1]`,t[1],`string expected, ${u} found`))}return h}function pm(a,t){const r=a.key,c=a.style,u=a.layer,h=a.styleSpec,m=a.value,g=a.objectKey,v=h[`${t}_${a.layerType}`];if(!v)return[];const b=g.match(/^(.*)-transition$/);if(t==="paint"&&b&&v[b[1]]&&v[b[1]].transition)return rr({key:r,value:m,valueSpec:h.transition,style:c,styleSpec:h});const w=a.valueSpec||v[g];if(!w)return[new Zs(r,m,`unknown property "${g}"`)];let A;if(Oi(m)==="string"&&Hd(w)&&!w.tokens&&(A=/^{([^}]+)}$/.exec(m))){const P=`\`{ "type": "identity", "property": ${A?JSON.stringify(A[1]):'"_"'} }\``;return[new ln(r,m,`"${g}" does not support interpolation syntax
Use an identity property function instead: ${P}.`)]}const C=[];if(a.layerType==="symbol")g!=="text-field"||!c||c.glyphs||c.imports||C.push(new ln(r,m,'use of "text-field" requires a style "glyphs" property')),g==="text-font"&&Ry(oa(m))&&Ga(m.type)==="identity"&&C.push(new ln(r,m,'"text-font" does not support identity functions'));else if(a.layerType==="model"&&t==="paint"&&u&&u.layout&&u.layout.hasOwnProperty("model-id")&&Hd(w)&&(v2(w)||dp(w))){const P=Dy(oa(m),w),k=P.value.expression||P.value._styleExpression.expression;k&&!Ud(k,["measure-light"])&&C.push(new ln(r,m,`${g} does not support measure-light expressions when the model layer source is vector tile or GeoJSON.`))}return C.concat(rr({key:a.key,value:m,valueSpec:w,style:c,styleSpec:h,expressionContext:"property",propertyType:t,propertyKey:g}))}function Wy(a){return pm(a,"paint")}function mr(a){return pm(a,"layout")}function Ni(a){let t=[];const r=a.value,c=a.key,u=a.style,h=a.styleSpec;r.type||r.ref||t.push(new ln(c,r,'either "type" or "ref" is required'));let m=Ga(r.type);const g=Ga(r.ref);if(r.id){const v=Ga(r.id);for(let b=0;b<a.arrayIndex;b++){const w=u.layers[b];Ga(w.id)===v&&t.push(new ln(c,r.id,`duplicate layer id "${r.id}", previously used at line ${w.id.__line__}`))}}if("ref"in r){let v;["type","source","source-layer","filter","layout"].forEach(b=>{b in r&&t.push(new ln(c,r[b],`"${b}" is prohibited for ref layers`))}),u.layers.forEach(b=>{Ga(b.id)===g&&(v=b)}),v?v.ref?t.push(new ln(c,r.ref,"ref cannot reference another ref layer")):m=Ga(v.type):typeof g=="string"&&t.push(new ln(c,r.ref,`ref layer "${g}" not found`))}else if(m!=="background"&&m!=="sky"&&m!=="slot")if(r.source){const v=u.sources&&u.sources[r.source],b=v&&Ga(v.type);v?b==="vector"&&m==="raster"?t.push(new ln(c,r.source,`layer "${r.id}" requires a raster source`)):b==="raster"&&m!=="raster"?t.push(new ln(c,r.source,`layer "${r.id}" requires a vector source`)):b!=="vector"||r["source-layer"]?b==="raster-dem"&&m!=="hillshade"?t.push(new ln(c,r.source,"raster-dem source can only be used with layer type 'hillshade'.")):m!=="line"||!r.paint||!r.paint["line-gradient"]&&!r.paint["line-trim-offset"]||b==="geojson"&&v.lineMetrics||t.push(new ln(c,r,`layer "${r.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):t.push(new ln(c,r,`layer "${r.id}" must specify a "source-layer"`)):t.push(new ln(c,r.source,`source "${r.source}" not found`))}else t.push(new ln(c,r,'missing required property "source"'));return t=t.concat(rs({key:c,value:r,valueSpec:h.layer,style:a.style,styleSpec:a.styleSpec,objectElementValidators:{"*":()=>[],type:()=>rr({key:`${c}.type`,value:r.type,valueSpec:h.layer.type,style:a.style,styleSpec:a.styleSpec,object:r,objectKey:"type"}),filter:v=>hm(Cs({layerType:m},v)),layout:v=>rs({layer:r,key:v.key,value:v.value,valueSpec:{},style:v.style,styleSpec:v.styleSpec,objectElementValidators:{"*":b=>mr(Cs({layerType:m},b))}}),paint:v=>rs({layer:r,key:v.key,value:v.value,valueSpec:{},style:v.style,styleSpec:v.styleSpec,objectElementValidators:{"*":b=>Wy(Cs({layerType:m,layer:r},b))}})}})),t}function $a(a){const t=a.value,r=a.key,c=Oi(t);return c!=="string"?[new ln(r,t,`string expected, ${c} found`)]:[]}const Cr={promoteId:function({key:a,value:t}){if(Oi(t)==="string")return $a({key:a,value:t});{const r=[];for(const c in t)r.push(...$a({key:`${a}.${c}`,value:t[c]}));return r}}};function fo(a){const t=a.value,r=a.key,c=a.styleSpec,u=a.style;if(!t.type)return[new ln(r,t,'"type" is required')];const h=Ga(t.type);let m;switch(h){case"vector":case"raster":case"raster-dem":return m=rs({key:r,value:t,valueSpec:c[`source_${h.replace("-","_")}`],style:a.style,styleSpec:c,objectElementValidators:Cr}),m;case"geojson":if(m=rs({key:r,value:t,valueSpec:c.source_geojson,style:u,styleSpec:c,objectElementValidators:Cr}),t.cluster)for(const g in t.clusterProperties){const[v,b]=t.clusterProperties[g],w=typeof v=="string"?[v,["accumulated"],["get",g]]:v;m.push(...$d({key:`${r}.${g}.map`,value:b,expressionContext:"cluster-map"})),m.push(...$d({key:`${r}.${g}.reduce`,value:w,expressionContext:"cluster-reduce"}))}return m;case"video":return rs({key:r,value:t,valueSpec:c.source_video,style:u,styleSpec:c});case"image":return rs({key:r,value:t,valueSpec:c.source_image,style:u,styleSpec:c});case"canvas":return[new ln(r,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return om({key:`${r}.type`,value:t.type,valueSpec:{values:Ls(c)},style:u,styleSpec:c})}}function Ls(a){return a.source.reduce((t,r)=>{const c=a[r];return c.type.type==="enum"&&(t=t.concat(Object.keys(c.type.values))),t},[])}function Yd(a){const t=a.value;let r=[];if(!t)return r;const c=Oi(t);return c!=="string"?(r=r.concat([new ln(a.key,t,`string expected, "${c}" found`)]),r):(function(u){const h=u.indexOf("://")===-1;try{return new URL(u,h?"http://example.com":void 0),!0}catch{return!1}}(t)||(r=r.concat([new ln(a.key,t,`invalid url "${t}"`)])),r)}function Ur(a){const t=a.value,r=a.styleSpec,c=r.light,u=a.style;let h=[];const m=Oi(t);if(t===void 0)return h;if(m!=="object")return h=h.concat([new ln("light",t,`object expected, ${m} found`)]),h;for(const g in t){const v=g.match(/^(.*)-transition$/);h=h.concat(v&&c[v[1]]&&c[v[1]].transition?rr({key:g,value:t[g],valueSpec:r.transition,style:u,styleSpec:r}):c[g]?rr({key:g,value:t[g],valueSpec:c[g],style:u,styleSpec:r}):[new ln(g,t[g],`unknown property "${g}"`)])}return h}function pp(a){const t=a.value;let r=[];if(!t)return r;const c=Oi(t);if(c!=="object")return r=r.concat([new ln("light-3d",t,`object expected, ${c} found`)]),r;const u=a.styleSpec,h=u["light-3d"],m=a.key,g=a.style,v=a.style.lights;for(const A of["type","id"])if(!(A in t))return r=r.concat([new ln("light-3d",t,`missing property ${A} on light`)]),r;if(t.type&&v)for(let A=0;A<a.arrayIndex;A++){const C=Ga(t.type),P=v[A];Ga(P.type)===C&&r.push(new ln(m,t.id,`duplicate light type "${t.type}", previously defined at line ${P.id.__line__}`))}const b=`properties_light_${t.type}`;if(!(b in u))return r=r.concat([new ln("light-3d",t,`Invalid light type ${t.type}`)]),r;const w=u[b];for(const A in t)if(A==="properties"){const C=t[A],P=Oi(C);if(P!=="object")return r=r.concat([new ln("properties",C,`object expected, ${P} found`)]),r;for(const k in C)r=r.concat(w[k]?rr({key:k,value:C[k],valueSpec:w[k],style:g,styleSpec:u}):[new Zs(a.key,C[k],`unknown property "${k}"`)])}else{const C=A.match(/^(.*)-transition$/);r=r.concat(C&&h[C[1]]&&h[C[1]].transition?rr({key:A,value:t[A],valueSpec:u.transition,style:g,styleSpec:u}):h[A]?rr({key:A,value:t[A],valueSpec:h[A],style:g,styleSpec:u}):[new Zs(A,t[A],`unknown property "${A}"`)])}return r}function qd(a){const t=a.value,r=a.key,c=a.style,u=a.styleSpec,h=u.terrain;let m=[];const g=Oi(t);if(t===void 0)return m;if(g!=="object")return m=m.concat([new ln("terrain",t,`object expected, ${g} found`)]),m;for(const v in t){const b=v.match(/^(.*)-transition$/);m=m.concat(b&&h[b[1]]&&h[b[1]].transition?rr({key:v,value:t[v],valueSpec:u.transition,style:c,styleSpec:u}):h[v]?rr({key:v,value:t[v],valueSpec:h[v],style:c,styleSpec:u}):[new Zs(v,t[v],`unknown property "${v}"`)])}if(t.source){const v=c.sources&&c.sources[t.source],b=v&&Ga(v.type);v?b!=="raster-dem"&&m.push(new ln(r,t.source,`terrain cannot be used with a source of type ${String(b)}, it only be used with a "raster-dem" source type`)):m.push(new ln(r,t.source,`source "${t.source}" not found`))}else m.push(new ln(r,t,'terrain is missing required property "source"'));return m}function fm(a){const t=a.value,r=a.style,c=a.styleSpec,u=c.fog;let h=[];const m=Oi(t);if(t===void 0)return h;if(m!=="object")return h=h.concat([new ln("fog",t,`object expected, ${m} found`)]),h;for(const g in t){const v=g.match(/^(.*)-transition$/);h=h.concat(v&&u[v[1]]&&u[v[1]].transition?rr({key:g,value:t[g],valueSpec:c.transition,style:r,styleSpec:c}):u[g]?rr({key:g,value:t[g],valueSpec:u[g],style:r,styleSpec:c}):[new Zs(g,t[g],`unknown property "${g}"`)])}return h}const Vy={"*":()=>[],array:Z_,boolean:function(a){const t=a.value,r=a.key,c=Oi(t);return c!=="boolean"?[new ln(r,t,`boolean expected, ${c} found`)]:[]},number:Oy,color:function(a){const t=a.key,r=a.value,c=Oi(r);return c!=="string"?[new ln(t,r,`color expected, ${c} found`)]:Su(r)===null?[new ln(t,r,`color expected, "${r}" found`)]:[]},enum:om,filter:hm,function:rm,layer:Ni,object:rs,source:fo,model:Yd,light:Ur,"light-3d":pp,terrain:qd,fog:fm,string:$a,formatted:function(a){return $a(a).length===0?[]:$d(a)},resolvedImage:function(a){return $a(a).length===0?[]:$d(a)},projection:function(a){const t=a.value,r=a.styleSpec,c=r.projection,u=a.style;let h=[];const m=Oi(t);if(m==="object")for(const g in t)h=h.concat(rr({key:g,value:t[g],valueSpec:c[g],style:u,styleSpec:r}));else m!=="string"&&(h=h.concat([new ln("projection",t,`object or string expected, ${m} found`)]));return h},import:function(a){const{value:t,styleSpec:r}=a,{data:c,...u}=t;Object.defineProperty(u,"__line__",{value:t.__line__,enumerable:!1});let h=rs(Cs({},a,{value:u,valueSpec:r.import}));return Ga(u.id)===""&&h.push(new ln(`${a.key}.id`,u,"import id can't be an empty string")),c&&(h=h.concat(Gy(c,r,{key:`${a.key}.data`}))),h}};function rr(a,t=!1){const r=a.value,c=a.valueSpec,u=a.styleSpec;if(c.expression&&Ry(Ga(r)))return rm(a);if(c.expression&&im(oa(r)))return $d(a);if(c.type&&Vy[c.type]){const h=Vy[c.type](a);return t===!0&&h.length>0&&Oi(a.value)==="array"?$d(a):h}return rs(Cs({},a,{valueSpec:c.type?u[c.type]:c}))}function os(a){const t=a.value,r=a.key,c=$a(a);return c.length||(t.indexOf("{fontstack}")===-1&&c.push(new ln(r,t,'"glyphs" url must include a "{fontstack}" token')),t.indexOf("{range}")===-1&&c.push(new ln(r,t,'"glyphs" url must include a "{range}" token'))),c}function Gy(a,t=at,r={}){return rr({key:r.key||"",value:a,valueSpec:t.$root,styleSpec:t,style:a,objectElementValidators:{glyphs:os,"*":()=>[]}})}function Fu(a,t=at){return ss(Gy(a,t))}const fp=a=>ss(fo(a)),Hy=a=>ss(Ur(a)),J_=a=>ss(pp(a)),Bu=a=>ss(qd(a)),jy=a=>ss(fm(a)),Uu=a=>ss(Ni(a)),mp=a=>ss(hm(a)),mm=a=>ss(Wy(a)),Q_=a=>ss(mr(a)),$y=a=>ss(Yd(a));function ss(a){return a.slice().sort((t,r)=>t.line&&r.line?t.line-r.line:0)}function mo(a,t){let r=!1;if(t&&t.length)for(const c of t)c instanceof Zs?_e(c.message):(a.fire(new bn(new Error(c.message))),r=!0);return r}var Wu=Rs,Jr=3;function Rs(a,t,r){var c=this.cells=[];if(a instanceof ArrayBuffer){this.arrayBuffer=a;var u=new Int32Array(this.arrayBuffer);a=u[0],this.d=(t=u[1])+2*(r=u[2]);for(var h=0;h<this.d*this.d;h++){var m=u[Jr+h],g=u[Jr+h+1];c.push(m===g?null:u.subarray(m,g))}var v=u[Jr+c.length+1];this.keys=u.subarray(u[Jr+c.length],v),this.bboxes=u.subarray(v),this.insert=this._insertReadonly}else{this.d=t+2*r;for(var b=0;b<this.d*this.d;b++)c.push([]);this.keys=[],this.bboxes=[]}this.n=t,this.extent=a,this.padding=r,this.scale=t/a,this.uid=0;var w=r/t*a;this.min=-w,this.max=a+w}Rs.prototype.insert=function(a,t,r,c,u){this._forEachCell(t,r,c,u,this._insertCell,this.uid++),this.keys.push(a),this.bboxes.push(t),this.bboxes.push(r),this.bboxes.push(c),this.bboxes.push(u)},Rs.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},Rs.prototype._insertCell=function(a,t,r,c,u,h){this.cells[u].push(h)},Rs.prototype.query=function(a,t,r,c,u){var h=this.min,m=this.max;if(a<=h&&t<=h&&m<=r&&m<=c&&!u)return Array.prototype.slice.call(this.keys);var g=[];return this._forEachCell(a,t,r,c,this._queryCell,g,{},u),g},Rs.prototype._queryCell=function(a,t,r,c,u,h,m,g){var v=this.cells[u];if(v!==null)for(var b=this.keys,w=this.bboxes,A=0;A<v.length;A++){var C=v[A];if(m[C]===void 0){var P=4*C;(g?g(w[P+0],w[P+1],w[P+2],w[P+3]):a<=w[P+2]&&t<=w[P+3]&&r>=w[P+0]&&c>=w[P+1])?(m[C]=!0,h.push(b[C])):m[C]=!1}}},Rs.prototype._forEachCell=function(a,t,r,c,u,h,m,g){for(var v=this._convertToCellCoord(a),b=this._convertToCellCoord(t),w=this._convertToCellCoord(r),A=this._convertToCellCoord(c),C=v;C<=w;C++)for(var P=b;P<=A;P++){var k=this.d*P+C;if((!g||g(this._convertFromCellCoord(C),this._convertFromCellCoord(P),this._convertFromCellCoord(C+1),this._convertFromCellCoord(P+1)))&&u.call(this,a,t,r,c,k,h,m,g))return}},Rs.prototype._convertFromCellCoord=function(a){return(a-this.padding)/this.scale},Rs.prototype._convertToCellCoord=function(a){return Math.max(0,Math.min(this.d-1,Math.floor(a*this.scale)+this.padding))},Rs.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var a=this.cells,t=Jr+this.cells.length+1+1,r=0,c=0;c<this.cells.length;c++)r+=this.cells[c].length;var u=new Int32Array(t+r+this.keys.length+this.bboxes.length);u[0]=this.extent,u[1]=this.n,u[2]=this.padding;for(var h=t,m=0;m<a.length;m++){var g=a[m];u[Jr+m]=h,u.set(g,h),h+=g.length}return u[Jr+a.length]=h,u.set(this.keys,h),u[Jr+a.length+1]=h+=this.keys.length,u.set(this.bboxes,h),h+=this.bboxes.length,u.buffer};var Qr=N(Wu);const gm={};function un(a,t,r={}){Object.defineProperty(a,"_classRegistryKey",{value:t,writeable:!1}),gm[t]={klass:a,omit:r.omit||[]}}un(Object,"Object"),Qr.serialize=function(a,t){const r=a.toArrayBuffer();return t&&t.add(r),{buffer:r}},Qr.deserialize=function(a){return new Qr(a.buffer)},Object.defineProperty(Qr,"name",{value:"Grid"}),un(Qr,"Grid"),un(Sn,"Color"),un(Error,"Error"),un(Te,"AJAXError"),un(ts,"ResolvedImage"),un(am,"StylePropertyFunction"),un(nm,"StyleExpression",{omit:["_evaluator"]}),un(Bc,"ZoomDependentExpression"),un(ky,"ZoomConstantExpression"),un(Tr,"CompoundExpression",{omit:["_evaluate"]});for(const a in up)gm[up[a]._classRegistryKey]||un(up[a],`Expression${a}`);function Yy(a){return a&&typeof ArrayBuffer<"u"&&(a instanceof ArrayBuffer||a.constructor&&a.constructor.name==="ArrayBuffer")}function w2(a){return f.ImageBitmap&&a instanceof f.ImageBitmap}function ks(a,t){if(a==null||typeof a=="boolean"||typeof a=="number"||typeof a=="string"||a instanceof Boolean||a instanceof Number||a instanceof String||a instanceof Date||a instanceof RegExp)return a;if(Yy(a)||w2(a))return t&&t.add(a),a;if(ArrayBuffer.isView(a)){const r=a;return t&&t.add(r.buffer),r}if(a instanceof f.ImageData)return t&&t.add(a.data.buffer),a;if(Array.isArray(a)){const r=[];for(const c of a)r.push(ks(c,t));return r}if(a instanceof Map){const r={$name:"Map"};for(const[c,u]of a.entries())r[c]=ks(u);return r}if(typeof a=="object"){const r=a.constructor,c=r._classRegistryKey;if(!c)throw new Error(`can't serialize object of unregistered class ${c}`);const u=r.serialize?r.serialize(a,t):{};if(!r.serialize){for(const h in a)a.hasOwnProperty(h)&&(gm[c].omit.indexOf(h)>=0||(u[h]=ks(a[h],t)));a instanceof Error&&(u.message=a.message)}if(u.$name)throw new Error("$name property is reserved for worker serialization logic.");return c!=="Object"&&(u.$name=c),u}throw new Error("can't serialize object of type "+typeof a)}function Xd(a){if(a==null||typeof a=="boolean"||typeof a=="number"||typeof a=="string"||a instanceof Boolean||a instanceof Number||a instanceof String||a instanceof Date||a instanceof RegExp||Yy(a)||w2(a)||ArrayBuffer.isView(a)||a instanceof f.ImageData)return a;if(Array.isArray(a))return a.map(Xd);if(typeof a=="object"){const t=a.$name||"Object";if(t==="Map"){const u=new Map;for(const h of Object.keys(a))h!=="$name"&&u.set(h,Xd(a[h]));return u}const{klass:r}=gm[t];if(!r)throw new Error(`can't deserialize unregistered class ${t}`);if(r.deserialize)return r.deserialize(a);const c=Object.create(r.prototype);for(const u of Object.keys(a))u!=="$name"&&(c[u]=Xd(a[u]));return c}throw new Error("can't deserialize object of type "+typeof a)}const mn={"Latin-1 Supplement":a=>a>=128&&a<=255,Arabic:a=>a>=1536&&a<=1791,"Arabic Supplement":a=>a>=1872&&a<=1919,"Arabic Extended-A":a=>a>=2208&&a<=2303,"Hangul Jamo":a=>a>=4352&&a<=4607,"Unified Canadian Aboriginal Syllabics":a=>a>=5120&&a<=5759,Khmer:a=>a>=6016&&a<=6143,"Unified Canadian Aboriginal Syllabics Extended":a=>a>=6320&&a<=6399,"General Punctuation":a=>a>=8192&&a<=8303,"Letterlike Symbols":a=>a>=8448&&a<=8527,"Number Forms":a=>a>=8528&&a<=8591,"Miscellaneous Technical":a=>a>=8960&&a<=9215,"Control Pictures":a=>a>=9216&&a<=9279,"Optical Character Recognition":a=>a>=9280&&a<=9311,"Enclosed Alphanumerics":a=>a>=9312&&a<=9471,"Geometric Shapes":a=>a>=9632&&a<=9727,"Miscellaneous Symbols":a=>a>=9728&&a<=9983,"Miscellaneous Symbols and Arrows":a=>a>=11008&&a<=11263,"CJK Radicals Supplement":a=>a>=11904&&a<=12031,"Kangxi Radicals":a=>a>=12032&&a<=12255,"Ideographic Description Characters":a=>a>=12272&&a<=12287,"CJK Symbols and Punctuation":a=>a>=12288&&a<=12351,Hiragana:a=>a>=12352&&a<=12447,Katakana:a=>a>=12448&&a<=12543,Bopomofo:a=>a>=12544&&a<=12591,"Hangul Compatibility Jamo":a=>a>=12592&&a<=12687,Kanbun:a=>a>=12688&&a<=12703,"Bopomofo Extended":a=>a>=12704&&a<=12735,"CJK Strokes":a=>a>=12736&&a<=12783,"Katakana Phonetic Extensions":a=>a>=12784&&a<=12799,"Enclosed CJK Letters and Months":a=>a>=12800&&a<=13055,"CJK Compatibility":a=>a>=13056&&a<=13311,"CJK Unified Ideographs Extension A":a=>a>=13312&&a<=19903,"Yijing Hexagram Symbols":a=>a>=19904&&a<=19967,"CJK Unified Ideographs":a=>a>=19968&&a<=40959,"Yi Syllables":a=>a>=40960&&a<=42127,"Yi Radicals":a=>a>=42128&&a<=42191,"Hangul Jamo Extended-A":a=>a>=43360&&a<=43391,"Hangul Syllables":a=>a>=44032&&a<=55215,"Hangul Jamo Extended-B":a=>a>=55216&&a<=55295,"Private Use Area":a=>a>=57344&&a<=63743,"CJK Compatibility Ideographs":a=>a>=63744&&a<=64255,"Arabic Presentation Forms-A":a=>a>=64336&&a<=65023,"Vertical Forms":a=>a>=65040&&a<=65055,"CJK Compatibility Forms":a=>a>=65072&&a<=65103,"Small Form Variants":a=>a>=65104&&a<=65135,"Arabic Presentation Forms-B":a=>a>=65136&&a<=65279,"Halfwidth and Fullwidth Forms":a=>a>=65280&&a<=65519,"CJK Unified Ideographs Extension B":a=>a>=131072&&a<=173791};function ym(a){for(const t of a)if(qy(t.charCodeAt(0)))return!0;return!1}function Zd(a){for(const t of a)if(!S2(t.charCodeAt(0)))return!1;return!0}function S2(a){return!(mn.Arabic(a)||mn["Arabic Supplement"](a)||mn["Arabic Extended-A"](a)||mn["Arabic Presentation Forms-A"](a)||mn["Arabic Presentation Forms-B"](a))}function qy(a){return!(a!==746&&a!==747&&(a<4352||!(mn["Bopomofo Extended"](a)||mn.Bopomofo(a)||mn["CJK Compatibility Forms"](a)&&!(a>=65097&&a<=65103)||mn["CJK Compatibility Ideographs"](a)||mn["CJK Compatibility"](a)||mn["CJK Radicals Supplement"](a)||mn["CJK Strokes"](a)||!(!mn["CJK Symbols and Punctuation"](a)||a>=12296&&a<=12305||a>=12308&&a<=12319||a===12336)||mn["CJK Unified Ideographs Extension A"](a)||mn["CJK Unified Ideographs"](a)||mn["Enclosed CJK Letters and Months"](a)||mn["Hangul Compatibility Jamo"](a)||mn["Hangul Jamo Extended-A"](a)||mn["Hangul Jamo Extended-B"](a)||mn["Hangul Jamo"](a)||mn["Hangul Syllables"](a)||mn.Hiragana(a)||mn["Ideographic Description Characters"](a)||mn.Kanbun(a)||mn["Kangxi Radicals"](a)||mn["Katakana Phonetic Extensions"](a)||mn.Katakana(a)&&a!==12540||!(!mn["Halfwidth and Fullwidth Forms"](a)||a===65288||a===65289||a===65293||a>=65306&&a<=65310||a===65339||a===65341||a===65343||a>=65371&&a<=65503||a===65507||a>=65512&&a<=65519)||!(!mn["Small Form Variants"](a)||a>=65112&&a<=65118||a>=65123&&a<=65126)||mn["Unified Canadian Aboriginal Syllabics"](a)||mn["Unified Canadian Aboriginal Syllabics Extended"](a)||mn["Vertical Forms"](a)||mn["Yijing Hexagram Symbols"](a)||mn["Yi Syllables"](a)||mn["Yi Radicals"](a))))}function Xy(a){return!(qy(a)||function(t){return!!(mn["Latin-1 Supplement"](t)&&(t===167||t===169||t===174||t===177||t===188||t===189||t===190||t===215||t===247)||mn["General Punctuation"](t)&&(t===8214||t===8224||t===8225||t===8240||t===8241||t===8251||t===8252||t===8258||t===8263||t===8264||t===8265||t===8273)||mn["Letterlike Symbols"](t)||mn["Number Forms"](t)||mn["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||t===9003||t>=9085&&t<=9114||t>=9150&&t<=9165||t===9167||t>=9169&&t<=9179||t>=9186&&t<=9215)||mn["Control Pictures"](t)&&t!==9251||mn["Optical Character Recognition"](t)||mn["Enclosed Alphanumerics"](t)||mn["Geometric Shapes"](t)||mn["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||mn["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||mn["CJK Symbols and Punctuation"](t)||mn.Katakana(t)||mn["Private Use Area"](t)||mn["CJK Compatibility Forms"](t)||mn["Small Form Variants"](t)||mn["Halfwidth and Fullwidth Forms"](t)||t===8734||t===8756||t===8757||t>=9984&&t<=10087||t>=10102&&t<=10131||t===65532||t===65533)}(a))}function vm(a){return a>=1424&&a<=2303||mn["Arabic Presentation Forms-A"](a)||mn["Arabic Presentation Forms-B"](a)}function AC(a,t){return!(!t&&vm(a)||a>=2304&&a<=3583||a>=3840&&a<=4255||mn.Khmer(a))}function EC(a){for(const t of a)if(vm(t.charCodeAt(0)))return!0;return!1}const Zy="deferred",Ky="loading",Wc="loaded";let e1=null,Wr="unavailable",Vc=null;const $o=function(a){a&&typeof a=="string"&&a.indexOf("NetworkError")>-1&&(Wr="error"),e1&&e1(a)};function t1(){Jy.fire(new $t("pluginStateChange",{pluginStatus:Wr,pluginURL:Vc}))}const Jy=new Un,n1=function(){return Wr},A2=function(){if(Wr!==Zy||!Vc)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Wr=Ky,t1(),Vc&&vt({url:Vc},a=>{a?$o(a):(Wr=Wc,t1())})},Ds={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>Wr===Wc||Ds.applyArabicShaping!=null,isLoading:()=>Wr===Ky,setState(a){Wr=a.pluginStatus,Vc=a.pluginURL},isParsed:()=>Ds.applyArabicShaping!=null&&Ds.processBidirectionalText!=null&&Ds.processStyledBidirectionalText!=null,getPluginURL:()=>Vc};class sa{constructor(t,r){this.zoom=t,r?(this.now=r.now,this.fadeDuration=r.fadeDuration,this.transition=r.transition,this.pitch=r.pitch,this.brightness=r.brightness):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0,this.brightness=0)}isSupportedScript(t){return function(r,c){for(const u of r)if(!AC(u.charCodeAt(0),c))return!1;return!0}(t,Ds.isLoaded())}}class Qy{constructor(t,r,c){this.property=t,this.value=r,this.expression=function(u,h,m){if(Ry(u))return new am(u,h);if(im(u)||Array.isArray(u)&&u.length>0){const g=Dy(u,h,m);if(g.result==="error")throw new Error(g.value.map(v=>`${v.key}: ${v.message}`).join(", "));return g.value}{let g=u;return typeof u=="string"&&h.type==="color"&&(g=Sn.parse(u)),{kind:"constant",isConfigDependent:!1,evaluate:()=>g}}}(r===void 0?t.specification.default:r,t.specification,c)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(t,r,c){return this.property.possiblyEvaluate(this,t,r,c)}}class ls{constructor(t,r){this.property=t,this.value=new Qy(t,void 0,r)}transitioned(t,r){return new E2(this.property,this.value,r,Fe({},t.transition,this.transition),t.now)}untransitioned(){return new E2(this.property,this.value,null,{},0)}}class Kd{constructor(t,r){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues),this._options=r,this.isConfigDependent=!1}getValue(t){return ue(this._values[t].value.value)}setValue(t,r){this._values.hasOwnProperty(t)||(this._values[t]=new ls(this._values[t].property,this._options)),this._values[t].value=new Qy(this._values[t].property,r===null?void 0:ue(r),this._options),this.isConfigDependent=this.isConfigDependent||this._values[t].value.expression.isConfigDependent}setTransitionOrValue(t,r){r&&(this._options=r);const c=this._properties.properties;if(t)for(const u in t){const h=t[u];if(gt(u,"-transition")){const m=u.slice(0,-11);c[m]&&this.setTransition(m,h)}else c[u]&&this.setValue(u,h)}}getTransition(t){return ue(this._values[t].transition)}setTransition(t,r){this._values.hasOwnProperty(t)||(this._values[t]=new ls(this._values[t].property)),this._values[t].transition=ue(r)||void 0}serialize(){const t={};for(const r of Object.keys(this._values)){const c=this.getValue(r);c!==void 0&&(t[r]=c);const u=this.getTransition(r);u!==void 0&&(t[`${r}-transition`]=u)}return t}transitioned(t,r){const c=new Gc(this._properties);for(const u of Object.keys(this._values))c._values[u]=this._values[u].transitioned(t,r._values[u]);return c}untransitioned(){const t=new Gc(this._properties);for(const r of Object.keys(this._values))t._values[r]=this._values[r].untransitioned();return t}}class E2{constructor(t,r,c,u,h){const m=u.delay||0,g=u.duration||0;h=h||0,this.property=t,this.value=r,this.begin=h+m,this.end=this.begin+g,t.specification.transition&&(u.delay||u.duration)&&(this.prior=c)}possiblyEvaluate(t,r,c){const u=t.now||0,h=this.value.possiblyEvaluate(t,r,c),m=this.prior;if(m){if(u>this.end)return this.prior=null,h;if(this.value.isDataDriven())return this.prior=null,h;if(u<this.begin)return m.possiblyEvaluate(t,r,c);{const g=(u-this.begin)/(this.end-this.begin);return this.property.interpolate(m.possiblyEvaluate(t,r,c),h,Ie(g))}}return h}}class Gc{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)}possiblyEvaluate(t,r,c){const u=new Vu(this._properties);for(const h of Object.keys(this._values))u._values[h]=this._values[h].possiblyEvaluate(t,r,c);return u}hasTransition(){for(const t of Object.keys(this._values))if(this._values[t].prior)return!0;return!1}}class ev{constructor(t,r){this._properties=t,this._values=Object.create(t.defaultPropertyValues),this._options=r,this.isConfigDependent=!1}getValue(t){return ue(this._values[t].value)}setValue(t,r){this._values[t]=new Qy(this._values[t].property,r===null?void 0:ue(r),this._options),this.isConfigDependent=this.isConfigDependent||this._values[t].expression.isConfigDependent}serialize(){const t={};for(const r of Object.keys(this._values)){const c=this.getValue(r);c!==void 0&&(t[r]=c)}return t}possiblyEvaluate(t,r,c){const u=new Vu(this._properties);for(const h of Object.keys(this._values))u._values[h]=this._values[h].possiblyEvaluate(t,r,c);return u}}class rl{constructor(t,r,c){this.property=t,this.value=r,this.parameters=c}isConstant(){return this.value.kind==="constant"}constantOr(t){return this.value.kind==="constant"?this.value.value:t}evaluate(t,r,c,u){return this.property.evaluate(this.value,this.parameters,t,r,c,u)}}class Vu{constructor(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)}get(t){return this._values[t]}}class Zt{constructor(t){this.specification=t}possiblyEvaluate(t,r){return t.expression.evaluate(r)}interpolate(t,r,c){const u=$f[this.specification.type];return u?u(t,r,c):t}}class _n{constructor(t,r){this.specification=t,this.overrides=r}possiblyEvaluate(t,r,c,u){return new rl(this,t.expression.kind==="constant"||t.expression.kind==="camera"?{kind:"constant",value:t.expression.evaluate(r,null,{},c,u)}:t.expression,r)}interpolate(t,r,c){if(t.value.kind!=="constant"||r.value.kind!=="constant")return t;if(t.value.value===void 0||r.value.value===void 0)return new rl(this,{kind:"constant",value:void 0},t.parameters);const u=$f[this.specification.type];return u?new rl(this,{kind:"constant",value:u(t.value.value,r.value.value,c)},t.parameters):t}evaluate(t,r,c,u,h,m){return t.kind==="constant"?t.value:t.evaluate(r,c,u,h,m)}}class _m{constructor(t){this.specification=t}possiblyEvaluate(t,r,c,u){return!!t.expression.evaluate(r,null,{},c,u)}interpolate(){return!1}}class xa{constructor(t){this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const r=new sa(0,{});for(const c in t){const u=t[c];u.specification.overridable&&this.overridableProperties.push(c);const h=this.defaultPropertyValues[c]=new Qy(u,void 0),m=this.defaultTransitionablePropertyValues[c]=new ls(u);this.defaultTransitioningPropertyValues[c]=m.untransitioned(),this.defaultPossiblyEvaluatedValues[c]=h.possiblyEvaluate(r)}}}function Yo(a,t){return t?`${a}${t}`:a}function tv(a){const t=a.indexOf("");return t>=0?a.slice(0,t):a}un(_n,"DataDrivenProperty"),un(Zt,"DataConstantProperty"),un(_m,"ColorRampProperty");const i1="-transition";class qo extends Un{constructor(t,r,c){if(super(),this.id=t.id,this.type=t.type,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,this.isConfigDependent=!1,t.type!=="custom"&&(this.metadata=t.metadata,this.minzoom=t.minzoom,this.maxzoom=t.maxzoom,t.type!=="background"&&t.type!=="sky"&&t.type!=="slot"&&(this.source=t.source,this.sourceLayer=t["source-layer"],this.filter=t.filter),this.options=c,t.slot&&(this.slot=t.slot),r.layout&&(this._unevaluatedLayout=new ev(r.layout,c),this.isConfigDependent=this.isConfigDependent||this._unevaluatedLayout.isConfigDependent),r.paint)){this._transitionablePaint=new Kd(r.paint,c);for(const u in t.paint)this.setPaintProperty(u,t.paint[u],{validate:!1});for(const u in t.layout)this.setLayoutProperty(u,t.layout[u],{validate:!1});this.isConfigDependent=this.isConfigDependent||this._transitionablePaint.isConfigDependent,this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Vu(r.paint)}}setScope(t){this.scope=t,this.fqid=Yo(this.id,t)}getLayoutProperty(t){return t==="visibility"?this.visibility:this._unevaluatedLayout.getValue(t)}setLayoutProperty(t,r,c={}){if(r!=null&&this._validate(Q_,`layers.${this.id}.layout.${t}`,t,r,c))return;if(this.type==="custom"&&t==="visibility")return void(this.visibility=r);const u=this._unevaluatedLayout;u._properties.properties[t]&&(u.setValue(t,r),this.isConfigDependent=this.isConfigDependent||u.isConfigDependent,t==="visibility"&&this.possiblyEvaluateVisibility())}possiblyEvaluateVisibility(){this.visibility=this._unevaluatedLayout._values.visibility.possiblyEvaluate({zoom:0})}getPaintProperty(t){return gt(t,i1)?this._transitionablePaint.getTransition(t.slice(0,-11)):this._transitionablePaint.getValue(t)}setPaintProperty(t,r,c={}){if(r!=null&&this._validate(mm,`layers.${this.id}.paint.${t}`,t,r,c))return!1;const u=this._transitionablePaint,h=u._properties.properties;if(gt(t,i1)){const C=t.slice(0,-11);return h[C]&&u.setTransition(C,r||void 0),!1}if(!h[t])return!1;const m=u._values[t],g=m.value.isDataDriven(),v=m.value;u.setValue(t,r),this.isConfigDependent=this.isConfigDependent||u.isConfigDependent,this._handleSpecialPaintPropertyUpdate(t);const b=u._values[t].value,w=b.isDataDriven(),A=gt(t,"pattern")||t==="line-dasharray";return w||g||A||this._handleOverridablePaintPropertyUpdate(t,v,b)}_handleSpecialPaintPropertyUpdate(t){}getProgramIds(){return null}getDefaultProgramParams(t,r){return null}_handleOverridablePaintPropertyUpdate(t,r,c){return!1}isHidden(t){return!!(this.minzoom&&t<this.minzoom)||!!(this.maxzoom&&t>=this.maxzoom)||this.visibility==="none"}updateTransitions(t){this._transitioningPaint=this._transitionablePaint.transitioned(t,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(t,r){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(t,void 0,r)),this.paint=this._transitioningPaint.possiblyEvaluate(t,void 0,r)}serialize(){return Be({id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()},(t,r)=>!(t===void 0||r==="layout"&&!Object.keys(t).length||r==="paint"&&!Object.keys(t).length))}_validate(t,r,c,u,h={}){return(!h||h.validate!==!1)&&mo(this,t.call(Fu,{key:r,layerType:this.type,objectKey:c,value:u,styleSpec:at,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}hasShadowPass(){return!1}canCastShadows(){return!1}hasLightBeamPass(){return!1}cutoffRange(){return 0}resize(){}isStateDependent(){for(const t in this.paint._values){const r=this.paint.get(t);if(r instanceof rl&&Hd(r.property.specification)&&(r.value.kind==="source"||r.value.kind==="composite")&&r.value.isStateDependent)return!0}return!1}compileFilter(){this._filterCompiled||(this._featureFilter=sm(this.filter),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}}class MC{constructor(){this.changed=!1,this._updatedLayers={},this._removedLayers={},this.updatedSourceCaches={},this.updatedPaintProps=new Set,this.changedImages=new Set}updateLayer(t){const r=t.scope;this._updatedLayers[r]=this._updatedLayers[r]||new Set,this._updatedLayers[r].add(t.id)}removeLayer(t){const r=t.scope;this._removedLayers[r]=this._removedLayers[r]||{},this._updatedLayers[r]=this._updatedLayers[r]||new Set,this._removedLayers[r][t.id]=t,this._updatedLayers[r].delete(t.id),this.updatedPaintProps.delete(t.fqid)}getRemovedLayer(t){return this._removedLayers[t.scope]?this._removedLayers[t.scope][t.id]:null}discardLayerRemoval(t){this._removedLayers[t.scope]&&delete this._removedLayers[t.scope][t.id]}getLayerUpdatesByScope(){const t={};for(const r in this._updatedLayers)t[r]=t[r]||{},t[r].updatedIds=Array.from(this._updatedLayers[r].values());for(const r in this._removedLayers)t[r]=t[r]||{},t[r].removedIds=Object.keys(this._removedLayers[r]);return t}reset(){this.changed=!1,this._updatedLayers={},this._removedLayers={},this.updatedSourceCaches={},this.updatedPaintProps.clear(),this.changedImages.clear()}}const TC={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class E{constructor(t,r){this._structArray=t,this._pos1=r*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class M{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(t,r){return t._trim(),r&&(t.isTransferred=!0,r.add(t.arrayBuffer)),{length:t.length,arrayBuffer:t.arrayBuffer}}static deserialize(t){const r=Object.create(this.prototype);return r.arrayBuffer=t.arrayBuffer,r.length=t.length,r.capacity=t.arrayBuffer.byteLength/r.bytesPerElement,r._refreshViews(),r}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(t){this.reserve(t),this.length=t}reserve(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const r=this.uint8;this._refreshViews(),r&&this.uint8.set(r)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function B(a,t=1){let r=0,c=0;return{members:a.map(u=>{const h=TC[u.type].BYTES_PER_ELEMENT,m=r=H(r,Math.max(t,h)),g=u.components||1;return c=Math.max(c,h),r+=h*g,{name:u.name,type:u.type,components:g,offset:m}}),size:H(r,Math.max(c,t)),alignment:t}}function H(a,t){return Math.ceil(a/t)*t}class ee extends M{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r){const c=this.length;return this.resize(c+1),this.emplace(c,t,r)}emplace(t,r,c){const u=2*t;return this.int16[u+0]=r,this.int16[u+1]=c,t}}ee.prototype.bytesPerElement=4,un(ee,"StructArrayLayout2i4");class oe extends M{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r,c){const u=this.length;return this.resize(u+1),this.emplace(u,t,r,c)}emplace(t,r,c,u){const h=3*t;return this.int16[h+0]=r,this.int16[h+1]=c,this.int16[h+2]=u,t}}oe.prototype.bytesPerElement=6,un(oe,"StructArrayLayout3i6");class Ye extends M{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r,c,u){const h=this.length;return this.resize(h+1),this.emplace(h,t,r,c,u)}emplace(t,r,c,u,h){const m=4*t;return this.int16[m+0]=r,this.int16[m+1]=c,this.int16[m+2]=u,this.int16[m+3]=h,t}}Ye.prototype.bytesPerElement=8,un(Ye,"StructArrayLayout4i8");class xt extends M{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r,c,u,h){const m=this.length;return this.resize(m+1),this.emplace(m,t,r,c,u,h)}emplace(t,r,c,u,h,m){const g=5*t;return this.int16[g+0]=r,this.int16[g+1]=c,this.int16[g+2]=u,this.int16[g+3]=h,this.int16[g+4]=m,t}}xt.prototype.bytesPerElement=10,un(xt,"StructArrayLayout5i10");class Yt extends M{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r,c,u,h,m,g){const v=this.length;return this.resize(v+1),this.emplace(v,t,r,c,u,h,m,g)}emplace(t,r,c,u,h,m,g,v){const b=6*t,w=12*t,A=3*t;return this.int16[b+0]=r,this.int16[b+1]=c,this.uint8[w+4]=u,this.uint8[w+5]=h,this.uint8[w+6]=m,this.uint8[w+7]=g,this.float32[A+2]=v,t}}Yt.prototype.bytesPerElement=12,un(Yt,"StructArrayLayout2i4ub1f12");class dn extends M{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r,c,u){const h=this.length;return this.resize(h+1),this.emplace(h,t,r,c,u)}emplace(t,r,c,u,h){const m=4*t;return this.float32[m+0]=r,this.float32[m+1]=c,this.float32[m+2]=u,this.float32[m+3]=h,t}}dn.prototype.bytesPerElement=16,un(dn,"StructArrayLayout4f16");class Tn extends M{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r,c,u,h){const m=this.length;return this.resize(m+1),this.emplace(m,t,r,c,u,h)}emplace(t,r,c,u,h,m){const g=6*t,v=3*t;return this.uint16[g+0]=r,this.uint16[g+1]=c,this.uint16[g+2]=u,this.uint16[g+3]=h,this.float32[v+2]=m,t}}Tn.prototype.bytesPerElement=12,un(Tn,"StructArrayLayout4ui1f12");class Si extends M{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,r,c,u){const h=this.length;return this.resize(h+1),this.emplace(h,t,r,c,u)}emplace(t,r,c,u,h){const m=4*t;return this.uint16[m+0]=r,this.uint16[m+1]=c,this.uint16[m+2]=u,this.uint16[m+3]=h,t}}Si.prototype.bytesPerElement=8,un(Si,"StructArrayLayout4ui8");class ti extends M{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r,c,u,h,m){const g=this.length;return this.resize(g+1),this.emplace(g,t,r,c,u,h,m)}emplace(t,r,c,u,h,m,g){const v=6*t;return this.int16[v+0]=r,this.int16[v+1]=c,this.int16[v+2]=u,this.int16[v+3]=h,this.int16[v+4]=m,this.int16[v+5]=g,t}}ti.prototype.bytesPerElement=12,un(ti,"StructArrayLayout6i12");class wa extends M{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,r,c,u,h,m,g,v,b,w,A,C){const P=this.length;return this.resize(P+1),this.emplace(P,t,r,c,u,h,m,g,v,b,w,A,C)}emplace(t,r,c,u,h,m,g,v,b,w,A,C,P){const k=12*t;return this.int16[k+0]=r,this.int16[k+1]=c,this.int16[k+2]=u,this.int16[k+3]=h,this.uint16[k+4]=m,this.uint16[k+5]=g,this.uint16[k+6]=v,this.uint16[k+7]=b,this.int16[k+8]=w,this.int16[k+9]=A,this.int16[k+10]=C,this.int16[k+11]=P,t}}wa.prototype.bytesPerElement=24,un(wa,"StructArrayLayout4i4ui4i24");class Hn extends M{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r,c,u,h,m){const g=this.length;return this.resize(g+1),this.emplace(g,t,r,c,u,h,m)}emplace(t,r,c,u,h,m,g){const v=10*t,b=5*t;return this.int16[v+0]=r,this.int16[v+1]=c,this.int16[v+2]=u,this.float32[b+2]=h,this.float32[b+3]=m,this.float32[b+4]=g,t}}Hn.prototype.bytesPerElement=20,un(Hn,"StructArrayLayout3i3f20");class go extends M{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t){const r=this.length;return this.resize(r+1),this.emplace(r,t)}emplace(t,r){return this.uint32[1*t+0]=r,t}}go.prototype.bytesPerElement=4,un(go,"StructArrayLayout1ul4");class eo extends M{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,r){const c=this.length;return this.resize(c+1),this.emplace(c,t,r)}emplace(t,r,c){const u=2*t;return this.uint16[u+0]=r,this.uint16[u+1]=c,t}}eo.prototype.bytesPerElement=4,un(eo,"StructArrayLayout2ui4");class Bt extends M{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,r,c,u,h,m,g,v,b,w,A,C,P){const k=this.length;return this.resize(k+1),this.emplace(k,t,r,c,u,h,m,g,v,b,w,A,C,P)}emplace(t,r,c,u,h,m,g,v,b,w,A,C,P,k){const z=20*t,U=10*t;return this.int16[z+0]=r,this.int16[z+1]=c,this.int16[z+2]=u,this.int16[z+3]=h,this.int16[z+4]=m,this.float32[U+3]=g,this.float32[U+4]=v,this.float32[U+5]=b,this.float32[U+6]=w,this.int16[z+14]=A,this.uint32[U+8]=C,this.uint16[z+18]=P,this.uint16[z+19]=k,t}}Bt.prototype.bytesPerElement=40,un(Bt,"StructArrayLayout5i4f1i1ul2ui40");class Mt extends M{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r,c,u,h,m,g){const v=this.length;return this.resize(v+1),this.emplace(v,t,r,c,u,h,m,g)}emplace(t,r,c,u,h,m,g,v){const b=8*t;return this.int16[b+0]=r,this.int16[b+1]=c,this.int16[b+2]=u,this.int16[b+4]=h,this.int16[b+5]=m,this.int16[b+6]=g,this.int16[b+7]=v,t}}Mt.prototype.bytesPerElement=16,un(Mt,"StructArrayLayout3i2i2i16");class Gt extends M{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r,c,u,h){const m=this.length;return this.resize(m+1),this.emplace(m,t,r,c,u,h)}emplace(t,r,c,u,h,m){const g=4*t,v=8*t;return this.float32[g+0]=r,this.float32[g+1]=c,this.float32[g+2]=u,this.int16[v+6]=h,this.int16[v+7]=m,t}}Gt.prototype.bytesPerElement=16,un(Gt,"StructArrayLayout2f1f2i16");class En extends M{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r,c,u){const h=this.length;return this.resize(h+1),this.emplace(h,t,r,c,u)}emplace(t,r,c,u,h){const m=12*t,g=3*t;return this.uint8[m+0]=r,this.uint8[m+1]=c,this.float32[g+1]=u,this.float32[g+2]=h,t}}En.prototype.bytesPerElement=12,un(En,"StructArrayLayout2ub2f12");class Dn extends M{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r,c){const u=this.length;return this.resize(u+1),this.emplace(u,t,r,c)}emplace(t,r,c,u){const h=3*t;return this.float32[h+0]=r,this.float32[h+1]=c,this.float32[h+2]=u,t}}Dn.prototype.bytesPerElement=12,un(Dn,"StructArrayLayout3f12");class Fn extends M{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,r,c){const u=this.length;return this.resize(u+1),this.emplace(u,t,r,c)}emplace(t,r,c,u){const h=3*t;return this.uint16[h+0]=r,this.uint16[h+1]=c,this.uint16[h+2]=u,t}}Fn.prototype.bytesPerElement=6,un(Fn,"StructArrayLayout3ui6");class Mi extends M{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t,r,c,u,h,m,g,v,b,w,A,C,P,k,z,U,W,$,Z,K,q){const J=this.length;return this.resize(J+1),this.emplace(J,t,r,c,u,h,m,g,v,b,w,A,C,P,k,z,U,W,$,Z,K,q)}emplace(t,r,c,u,h,m,g,v,b,w,A,C,P,k,z,U,W,$,Z,K,q,J){const re=30*t,ce=15*t,ge=60*t;return this.int16[re+0]=r,this.int16[re+1]=c,this.int16[re+2]=u,this.float32[ce+2]=h,this.float32[ce+3]=m,this.uint16[re+8]=g,this.uint16[re+9]=v,this.uint32[ce+5]=b,this.uint32[ce+6]=w,this.uint32[ce+7]=A,this.uint16[re+16]=C,this.uint16[re+17]=P,this.uint16[re+18]=k,this.float32[ce+10]=z,this.float32[ce+11]=U,this.uint8[ge+48]=W,this.uint8[ge+49]=$,this.uint8[ge+50]=Z,this.uint32[ce+13]=K,this.int16[re+28]=q,this.uint8[ge+58]=J,t}}Mi.prototype.bytesPerElement=60,un(Mi,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class Ki extends M{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t,r,c,u,h,m,g,v,b,w,A,C,P,k,z,U,W,$,Z,K,q,J,re,ce,ge,ve,Ce,Ae,Le,Se,Ve,Xe){const nt=this.length;return this.resize(nt+1),this.emplace(nt,t,r,c,u,h,m,g,v,b,w,A,C,P,k,z,U,W,$,Z,K,q,J,re,ce,ge,ve,Ce,Ae,Le,Se,Ve,Xe)}emplace(t,r,c,u,h,m,g,v,b,w,A,C,P,k,z,U,W,$,Z,K,q,J,re,ce,ge,ve,Ce,Ae,Le,Se,Ve,Xe,nt){const We=20*t,Ge=40*t,ot=80*t;return this.float32[We+0]=r,this.float32[We+1]=c,this.int16[Ge+4]=u,this.int16[Ge+5]=h,this.int16[Ge+6]=m,this.int16[Ge+7]=g,this.int16[Ge+8]=v,this.int16[Ge+9]=b,this.int16[Ge+10]=w,this.int16[Ge+11]=A,this.int16[Ge+12]=C,this.uint16[Ge+13]=P,this.uint16[Ge+14]=k,this.uint16[Ge+15]=z,this.uint16[Ge+16]=U,this.uint16[Ge+17]=W,this.uint16[Ge+18]=$,this.uint16[Ge+19]=Z,this.uint16[Ge+20]=K,this.uint16[Ge+21]=q,this.uint16[Ge+22]=J,this.uint16[Ge+23]=re,this.uint16[Ge+24]=ce,this.uint16[Ge+25]=ge,this.uint16[Ge+26]=ve,this.uint16[Ge+27]=Ce,this.uint32[We+14]=Ae,this.float32[We+15]=Le,this.float32[We+16]=Se,this.float32[We+17]=Ve,this.float32[We+18]=Xe,this.uint8[ot+76]=nt,t}}Ki.prototype.bytesPerElement=80,un(Ki,"StructArrayLayout2f9i15ui1ul4f1ub80");class gr extends M{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t){const r=this.length;return this.resize(r+1),this.emplace(r,t)}emplace(t,r){return this.float32[1*t+0]=r,t}}gr.prototype.bytesPerElement=4,un(gr,"StructArrayLayout1f4");class Vi extends M{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r,c,u,h){const m=this.length;return this.resize(m+1),this.emplace(m,t,r,c,u,h)}emplace(t,r,c,u,h,m){const g=5*t;return this.float32[g+0]=r,this.float32[g+1]=c,this.float32[g+2]=u,this.float32[g+3]=h,this.float32[g+4]=m,t}}Vi.prototype.bytesPerElement=20,un(Vi,"StructArrayLayout5f20");class hc extends M{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r,c,u,h,m,g){const v=this.length;return this.resize(v+1),this.emplace(v,t,r,c,u,h,m,g)}emplace(t,r,c,u,h,m,g,v){const b=7*t;return this.float32[b+0]=r,this.float32[b+1]=c,this.float32[b+2]=u,this.float32[b+3]=h,this.float32[b+4]=m,this.float32[b+5]=g,this.float32[b+6]=v,t}}hc.prototype.bytesPerElement=28,un(hc,"StructArrayLayout7f28");class a1 extends M{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,r,c,u){const h=this.length;return this.resize(h+1),this.emplace(h,t,r,c,u)}emplace(t,r,c,u,h){const m=6*t;return this.uint32[3*t+0]=r,this.uint16[m+2]=c,this.uint16[m+3]=u,this.uint16[m+4]=h,t}}a1.prototype.bytesPerElement=12,un(a1,"StructArrayLayout1ul3ui12");class r1 extends M{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t){const r=this.length;return this.resize(r+1),this.emplace(r,t)}emplace(t,r){return this.uint16[1*t+0]=r,t}}r1.prototype.bytesPerElement=2,un(r1,"StructArrayLayout1ui2");class o1 extends M{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r){const c=this.length;return this.resize(c+1),this.emplace(c,t,r)}emplace(t,r,c){const u=2*t;return this.float32[u+0]=r,this.float32[u+1]=c,t}}o1.prototype.bytesPerElement=8,un(o1,"StructArrayLayout2f8");class CC extends M{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r,c,u,h,m,g,v,b,w,A,C,P,k,z,U){const W=this.length;return this.resize(W+1),this.emplace(W,t,r,c,u,h,m,g,v,b,w,A,C,P,k,z,U)}emplace(t,r,c,u,h,m,g,v,b,w,A,C,P,k,z,U,W){const $=16*t;return this.float32[$+0]=r,this.float32[$+1]=c,this.float32[$+2]=u,this.float32[$+3]=h,this.float32[$+4]=m,this.float32[$+5]=g,this.float32[$+6]=v,this.float32[$+7]=b,this.float32[$+8]=w,this.float32[$+9]=A,this.float32[$+10]=C,this.float32[$+11]=P,this.float32[$+12]=k,this.float32[$+13]=z,this.float32[$+14]=U,this.float32[$+15]=W,t}}CC.prototype.bytesPerElement=64,un(CC,"StructArrayLayout16f64");class M2 extends M{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r,c,u,h,m,g){const v=this.length;return this.resize(v+1),this.emplace(v,t,r,c,u,h,m,g)}emplace(t,r,c,u,h,m,g,v){const b=10*t,w=5*t;return this.uint16[b+0]=r,this.uint16[b+1]=c,this.uint16[b+2]=u,this.uint16[b+3]=h,this.float32[w+2]=m,this.float32[w+3]=g,this.float32[w+4]=v,t}}M2.prototype.bytesPerElement=20,un(M2,"StructArrayLayout4ui3f20");class PC extends M{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer)}emplaceBack(t){const r=this.length;return this.resize(r+1),this.emplace(r,t)}emplace(t,r){return this.uint8[1*t+0]=r,t}}PC.prototype.bytesPerElement=1,un(PC,"StructArrayLayout1ub1");class hO extends E{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}hO.prototype.size=40;class IC extends Bt{get(t){return new hO(this,t)}}un(IC,"CollisionBoxArray");class pO extends E{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(t){this._structArray.uint8[this._pos1+49]=t}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(t){this._structArray.uint8[this._pos1+50]=t}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(t){this._structArray.uint32[this._pos4+13]=t}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(t){this._structArray.uint8[this._pos1+58]=t}}pO.prototype.size=60;class fO extends Mi{get(t){return new pO(this,t)}}un(fO,"PlacedSymbolArray");class mO extends E{get tileAnchorX(){return this._structArray.float32[this._pos4+0]}get tileAnchorY(){return this._structArray.float32[this._pos4+1]}get projectedAnchorX(){return this._structArray.int16[this._pos2+4]}get projectedAnchorY(){return this._structArray.int16[this._pos2+5]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+6]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+7]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+11]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get key(){return this._structArray.uint16[this._pos2+13]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+14]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+15]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+17]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+19]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+21]}get featureIndex(){return this._structArray.uint16[this._pos2+22]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+23]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numIconVertices(){return this._structArray.uint16[this._pos2+25]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+26]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+27]}get crossTileID(){return this._structArray.uint32[this._pos4+14]}set crossTileID(t){this._structArray.uint32[this._pos4+14]=t}get textOffset0(){return this._structArray.float32[this._pos4+15]}get textOffset1(){return this._structArray.float32[this._pos4+16]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+17]}get zOffset(){return this._structArray.float32[this._pos4+18]}set zOffset(t){this._structArray.float32[this._pos4+18]=t}get hasIconTextFit(){return this._structArray.uint8[this._pos1+76]}}mO.prototype.size=80;class gO extends Ki{get(t){return new mO(this,t)}}un(gO,"SymbolInstanceArray");class yO extends gr{getoffsetX(t){return this.float32[1*t+0]}}un(yO,"GlyphOffsetArray");class vO extends ee{getx(t){return this.int16[2*t+0]}gety(t){return this.int16[2*t+1]}}un(vO,"SymbolLineVertexArray");class _O extends E{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}_O.prototype.size=12;class bO extends a1{get(t){return new _O(this,t)}}un(bO,"FeatureIndexArray");class xO extends eo{geta_centroid_pos0(t){return this.uint16[2*t+0]}geta_centroid_pos1(t){return this.uint16[2*t+1]}}un(xO,"FillExtrusionCentroidArray");const iQ=B([{name:"a_pos",components:2,type:"Int16"}],4),aQ=B([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class ji{constructor(t=[]){this.segments=t}_prepareSegment(t,r,c,u){let h=this.segments[this.segments.length-1];return t>ji.MAX_VERTEX_ARRAY_LENGTH&&_e(`Max vertices per segment is ${ji.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${t}`),(!h||h.vertexLength+t>ji.MAX_VERTEX_ARRAY_LENGTH||h.sortKey!==u)&&(h={vertexOffset:r,primitiveOffset:c,vertexLength:0,primitiveLength:0},u!==void 0&&(h.sortKey=u),this.segments.push(h)),h}prepareSegment(t,r,c,u){return this._prepareSegment(t,r.length,c.length,u)}get(){return this.segments}destroy(){for(const t of this.segments)for(const r in t.vaos)t.vaos[r].destroy()}static simpleSegment(t,r,c,u){return new ji([{vertexOffset:t,primitiveOffset:r,vertexLength:c,primitiveLength:u,vaos:{},sortKey:0}])}}function wO(a,t){return 256*(a=ae(Math.floor(a),0,255))+ae(Math.floor(t),0,255)}ji.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,un(ji,"SegmentVector");const rQ=B([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),oQ=B([{name:"a_dash",components:4,type:"Uint16"}]);var T2={exports:{}},SO={exports:{}};(function(a){a.exports=function(t,r){var c,u,h,m,g,v,b,w;for(u=t.length-(c=3&t.length),h=r,g=3432918353,v=461845907,w=0;w<u;)b=255&t.charCodeAt(w)|(255&t.charCodeAt(++w))<<8|(255&t.charCodeAt(++w))<<16|(255&t.charCodeAt(++w))<<24,++w,h=27492+(65535&(m=5*(65535&(h=(h^=b=(65535&(b=(b=(65535&b)*g+(((b>>>16)*g&65535)<<16)&4294967295)<<15|b>>>17))*v+(((b>>>16)*v&65535)<<16)&4294967295)<<13|h>>>19))+((5*(h>>>16)&65535)<<16)&4294967295))+((58964+(m>>>16)&65535)<<16);switch(b=0,c){case 3:b^=(255&t.charCodeAt(w+2))<<16;case 2:b^=(255&t.charCodeAt(w+1))<<8;case 1:h^=b=(65535&(b=(b=(65535&(b^=255&t.charCodeAt(w)))*g+(((b>>>16)*g&65535)<<16)&4294967295)<<15|b>>>17))*v+(((b>>>16)*v&65535)<<16)&4294967295}return h^=t.length,h=2246822507*(65535&(h^=h>>>16))+((2246822507*(h>>>16)&65535)<<16)&4294967295,h=3266489909*(65535&(h^=h>>>13))+((3266489909*(h>>>16)&65535)<<16)&4294967295,(h^=h>>>16)>>>0}})(SO);var sQ=SO.exports,AO={exports:{}};(function(a){a.exports=function(t,r){for(var c,u=t.length,h=r^u,m=0;u>=4;)c=1540483477*(65535&(c=255&t.charCodeAt(m)|(255&t.charCodeAt(++m))<<8|(255&t.charCodeAt(++m))<<16|(255&t.charCodeAt(++m))<<24))+((1540483477*(c>>>16)&65535)<<16),h=1540483477*(65535&h)+((1540483477*(h>>>16)&65535)<<16)^(c=1540483477*(65535&(c^=c>>>24))+((1540483477*(c>>>16)&65535)<<16)),u-=4,++m;switch(u){case 3:h^=(255&t.charCodeAt(m+2))<<16;case 2:h^=(255&t.charCodeAt(m+1))<<8;case 1:h=1540483477*(65535&(h^=255&t.charCodeAt(m)))+((1540483477*(h>>>16)&65535)<<16)}return h=1540483477*(65535&(h^=h>>>13))+((1540483477*(h>>>16)&65535)<<16),(h^=h>>>15)>>>0}})(AO);var EO=sQ,lQ=AO.exports;T2.exports=EO,T2.exports.murmur3=EO,T2.exports.murmur2=lQ;var LC=N(T2.exports);class s1{constructor(){this.ids=[],this.uniqueIds=[],this.positions=[],this.indexed=!1}add(t,r,c,u){this.ids.push(MO(t)),this.positions.push(r,c,u)}eachPosition(t,r){const c=MO(t);let u=0,h=this.ids.length-1;for(;u<h;){const m=u+h>>1;this.ids[m]>=c?h=m:u=m+1}for(;this.ids[u]===c;)r(this.positions[3*u],this.positions[3*u+1],this.positions[3*u+2]),u++}static serialize(t,r){const c=new Float64Array(t.ids),u=new Uint32Array(t.positions);return RC(c,u,0,c.length-1),r&&(r.add(c.buffer),r.add(u.buffer)),{ids:c,positions:u}}static deserialize(t){const r=new s1;let c;r.ids=t.ids,r.positions=t.positions;for(const u of r.ids)u!==c&&r.uniqueIds.push(u),c=u;return r.indexed=!0,r}}function MO(a){const t=+a;return!isNaN(t)&&Number.MIN_SAFE_INTEGER<=t&&t<=Number.MAX_SAFE_INTEGER?t:LC(String(a))}function RC(a,t,r,c){for(;r<c;){const u=a[r+c>>1];let h=r-1,m=c+1;for(;;){do h++;while(a[h]<u);do m--;while(a[m]>u);if(h>=m)break;C2(a,h,m),C2(t,3*h,3*m),C2(t,3*h+1,3*m+1),C2(t,3*h+2,3*m+2)}m-r<c-m?(RC(a,t,r,m),r=m+1):(RC(a,t,m+1,c),c=m)}}function C2(a,t,r){const c=a[t];a[t]=a[r],a[r]=c}un(s1,"FeaturePositionMap");class Jd{constructor(t){this.gl=t.gl,this.initialized=!1}fetchUniformLocation(t,r){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(t,r),this.initialized=!0),!!this.location}}class ci extends Jd{constructor(t){super(t),this.current=0}set(t,r,c){this.fetchUniformLocation(t,r)&&this.current!==c&&(this.current=c,this.gl.uniform1i(this.location,c))}}class Jt extends Jd{constructor(t){super(t),this.current=0}set(t,r,c){this.fetchUniformLocation(t,r)&&this.current!==c&&(this.current=c,this.gl.uniform1f(this.location,c))}}class pi extends Jd{constructor(t){super(t),this.current=[0,0]}set(t,r,c){this.fetchUniformLocation(t,r)&&(c[0]===this.current[0]&&c[1]===this.current[1]||(this.current=c,this.gl.uniform2f(this.location,c[0],c[1])))}}class Zn extends Jd{constructor(t){super(t),this.current=[0,0,0]}set(t,r,c){this.fetchUniformLocation(t,r)&&(c[0]===this.current[0]&&c[1]===this.current[1]&&c[2]===this.current[2]||(this.current=c,this.gl.uniform3f(this.location,c[0],c[1],c[2])))}}class ol extends Jd{constructor(t){super(t),this.current=[0,0,0,0]}set(t,r,c){this.fetchUniformLocation(t,r)&&(c[0]===this.current[0]&&c[1]===this.current[1]&&c[2]===this.current[2]&&c[3]===this.current[3]||(this.current=c,this.gl.uniform4f(this.location,c[0],c[1],c[2],c[3])))}}class nv extends Jd{constructor(t){super(t),this.current=Sn.transparent}set(t,r,c){this.fetchUniformLocation(t,r)&&(c.r===this.current.r&&c.g===this.current.g&&c.b===this.current.b&&c.a===this.current.a||(this.current=c,this.gl.uniform4f(this.location,c.r,c.g,c.b,c.a)))}}const cQ=new Float32Array(16);class $n extends Jd{constructor(t){super(t),this.current=cQ}set(t,r,c){if(this.fetchUniformLocation(t,r)){if(c[12]!==this.current[12]||c[0]!==this.current[0])return this.current=c,void this.gl.uniformMatrix4fv(this.location,!1,c);for(let u=1;u<16;u++)if(c[u]!==this.current[u]){this.current=c,this.gl.uniformMatrix4fv(this.location,!1,c);break}}}}const uQ=new Float32Array(9);class TO extends Jd{constructor(t){super(t),this.current=uQ}set(t,r,c){if(this.fetchUniformLocation(t,r)){for(let u=0;u<9;u++)if(c[u]!==this.current[u]){this.current=c,this.gl.uniformMatrix3fv(this.location,!1,c);break}}}}const dQ=new Float32Array(4);class kC extends Jd{constructor(t){super(t),this.current=dQ}set(t,r,c){if(this.fetchUniformLocation(t,r)){for(let u=0;u<4;u++)if(c[u]!==this.current[u]){this.current=c,this.gl.uniformMatrix2fv(this.location,!1,c);break}}}}function DC(a){return[wO(255*a.r,255*a.g),wO(255*a.b,255*a.a)]}class l1{constructor(t,r,c){this.value=t,this.uniformNames=r.map(u=>`u_${u}`),this.type=c}setUniform(t,r,c,u,h){r.set(t,h,u.constantOr(this.value))}getBinding(t,r){return this.type==="color"?new nv(t):new Jt(t)}}class iv{constructor(t,r){this.uniformNames=r.map(c=>`u_${c}`),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(t){this.pixelRatio=t.pixelRatio||1,this.pattern=t.tl.concat(t.br)}setUniform(t,r,c,u,h){const m=h==="u_pattern"||h==="u_dash"?this.pattern:h==="u_pixel_ratio"?this.pixelRatio:null;m&&r.set(t,h,m)}getBinding(t,r){return r==="u_pattern"||r==="u_dash"?new ol(t):new Jt(t)}}class Qd{constructor(t,r,c,u){this.expression=t,this.type=c,this.maxValue=0,this.paintVertexAttributes=r.map(h=>({name:`a_${h}`,type:"Float32",components:c==="color"?2:1,offset:0})),this.paintVertexArray=new u}populatePaintArray(t,r,c,u,h,m,g){const v=this.paintVertexArray.length,b=this.expression.evaluate(new sa(0,{brightness:m}),r,{},h,u,g);this.paintVertexArray.resize(t),this._setPaintValue(v,t,b)}updatePaintArray(t,r,c,u,h,m,g){const v=this.expression.evaluate({zoom:0,brightness:g},c,u,void 0,h);this._setPaintValue(t,r,v)}_setPaintValue(t,r,c){if(this.type==="color"){const u=DC(c);for(let h=t;h<r;h++)this.paintVertexArray.emplace(h,u[0],u[1])}else{for(let u=t;u<r;u++)this.paintVertexArray.emplace(u,c);this.maxValue=Math.max(this.maxValue,Math.abs(c))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Hc{constructor(t,r,c,u,h,m){this.expression=t,this.uniformNames=r.map(g=>`u_${g}_t`),this.type=c,this.useIntegerZoom=u,this.zoom=h,this.maxValue=0,this.paintVertexAttributes=r.map(g=>({name:`a_${g}`,type:"Float32",components:c==="color"?4:2,offset:0})),this.paintVertexArray=new m}populatePaintArray(t,r,c,u,h,m,g){const v=this.expression.evaluate(new sa(this.zoom,{brightness:m}),r,{},h,u,g),b=this.expression.evaluate(new sa(this.zoom+1,{brightness:m}),r,{},h,u,g),w=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValue(w,t,v,b)}updatePaintArray(t,r,c,u,h,m,g){const v=this.expression.evaluate({zoom:this.zoom,brightness:g},c,u,void 0,h),b=this.expression.evaluate({zoom:this.zoom+1,brightness:g},c,u,void 0,h);this._setPaintValue(t,r,v,b)}_setPaintValue(t,r,c,u){if(this.type==="color"){const h=DC(c),m=DC(u);for(let g=t;g<r;g++)this.paintVertexArray.emplace(g,h[0],h[1],m[0],m[1])}else{for(let h=t;h<r;h++)this.paintVertexArray.emplace(h,c,u);this.maxValue=Math.max(this.maxValue,Math.abs(c),Math.abs(u))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(t,r,c,u,h){const m=this.useIntegerZoom?Math.floor(c.zoom):c.zoom,g=ae(this.expression.interpolationFactor(m,this.zoom,this.zoom+1),0,1);r.set(t,h,g)}getBinding(t,r){return new Jt(t)}}class gp{constructor(t,r,c,u,h){this.expression=t,this.layerId=h,this.paintVertexAttributes=(c==="array"?oQ:rQ).members;for(let m=0;m<r.length;++m);this.paintVertexArray=new u}populatePaintArray(t,r,c){const u=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValues(u,t,r.patterns&&r.patterns[this.layerId],c)}updatePaintArray(t,r,c,u,h,m,g){this._setPaintValues(t,r,c.patterns&&c.patterns[this.layerId],m)}_setPaintValues(t,r,c,u){if(!u||!c)return;const h=u[c];if(!h)return;const{tl:m,br:g,pixelRatio:v}=h;for(let b=t;b<r;b++)this.paintVertexArray.emplace(b,m[0],m[1],g[0],g[1],v)}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class bm{constructor(t,r,c=()=>!0){this.binders={},this._buffers=[];const u=[];for(const h in t.paint._values){const m=t.paint.get(h);if(!c(h)||!(m instanceof rl&&Hd(m.property.specification)))continue;const g=pQ(h,t.type),v=m.value,b=m.property.specification.type,w=!!m.property.useIntegerZoom,A=h==="line-dasharray"||h.endsWith("pattern"),C=h==="line-dasharray"&&t.layout.get("line-cap").value.kind!=="constant";if(v.kind!=="constant"||C)if(v.kind==="source"||C||A){const P=CO(h,b,"source");this.binders[h]=A?new gp(v,g,b,P,t.id):new Qd(v,g,b,P),u.push(`/a_${h}`)}else{const P=CO(h,b,"composite");this.binders[h]=new Hc(v,g,b,w,r,P),u.push(`/z_${h}`)}else this.binders[h]=A?new iv(v.value,g):new l1(v.value,g,b),u.push(`/u_${h}`)}this.cacheKey=u.sort().join("")}getMaxValue(t){const r=this.binders[t];return r instanceof Qd||r instanceof Hc?r.maxValue:0}populatePaintArrays(t,r,c,u,h,m,g){for(const v in this.binders){const b=this.binders[v];(b instanceof Qd||b instanceof Hc||b instanceof gp)&&b.populatePaintArray(t,r,c,u,h,m,g)}}setConstantPatternPositions(t){for(const r in this.binders){const c=this.binders[r];c instanceof iv&&c.setConstantPatternPositions(t)}}updatePaintArrays(t,r,c,u,h,m,g,v){let b=!1;const w=Object.keys(t),A=w.length!==0,C=A?w:r.uniqueIds;for(const P in this.binders){const k=this.binders[P];if((k instanceof Qd||k instanceof Hc||k instanceof gp)&&(k.expression.isStateDependent===!0||k.expression.isLightConstant===!1)){const z=h.paint.get(P);k.expression=z.value;for(const U of C){const W=t[U.toString()];r.eachPosition(U,($,Z,K)=>{const q=u.feature($);k.updatePaintArray(Z,K,q,W,m,g,v)})}if(!A)for(const U of c.uniqueIds){const W=t[U.toString()];c.eachPosition(U,($,Z,K)=>{const q=u.feature($);k.updatePaintArray(Z,K,q,W,m,g,v)})}b=!0}}return b}defines(){const t=[];for(const r in this.binders){const c=this.binders[r];(c instanceof l1||c instanceof iv)&&t.push(...c.uniformNames.map(u=>`#define HAS_UNIFORM_${u}`))}return t}getBinderAttributes(){const t=[];for(const r in this.binders){const c=this.binders[r];if(c instanceof Qd||c instanceof Hc||c instanceof gp)for(let u=0;u<c.paintVertexAttributes.length;u++)t.push(c.paintVertexAttributes[u].name)}return t}getBinderUniforms(){const t=[];for(const r in this.binders){const c=this.binders[r];if(c instanceof l1||c instanceof iv||c instanceof Hc)for(const u of c.uniformNames)t.push(u)}return t}getPaintVertexBuffers(){return this._buffers}getUniforms(t){const r=[];for(const c in this.binders){const u=this.binders[c];if(u instanceof l1||u instanceof iv||u instanceof Hc)for(const h of u.uniformNames)r.push({name:h,property:c,binding:u.getBinding(t,h)})}return r}setUniforms(t,r,c,u,h){for(const{name:m,property:g,binding:v}of c)this.binders[g].setUniform(t,v,h,u.get(g),m)}updatePaintBuffers(){this._buffers=[];for(const t in this.binders){const r=this.binders[t];(r instanceof Qd||r instanceof Hc||r instanceof gp)&&r.paintVertexBuffer&&this._buffers.push(r.paintVertexBuffer)}}upload(t){for(const r in this.binders){const c=this.binders[r];(c instanceof Qd||c instanceof Hc||c instanceof gp)&&c.upload(t)}this.updatePaintBuffers()}destroy(){for(const t in this.binders){const r=this.binders[t];(r instanceof Qd||r instanceof Hc||r instanceof gp)&&r.destroy()}}}class yp{constructor(t,r,c=()=>!0){this.programConfigurations={};for(const u of t)this.programConfigurations[u.id]=new bm(u,r,c);this.needsUpload=!1,this._featureMap=new s1,this._featureMapWithoutIds=new s1,this._bufferOffset=0,this._idlessCounter=0}populatePaintArrays(t,r,c,u,h,m,g,v){for(const b in this.programConfigurations)this.programConfigurations[b].populatePaintArrays(t,r,u,h,m,g,v);r.id!==void 0?this._featureMap.add(r.id,c,this._bufferOffset,t):(this._featureMapWithoutIds.add(this._idlessCounter,c,this._bufferOffset,t),this._idlessCounter+=1),this._bufferOffset=t,this.needsUpload=!0}updatePaintArrays(t,r,c,u,h,m){for(const g of c)this.needsUpload=this.programConfigurations[g.id].updatePaintArrays(t,this._featureMap,this._featureMapWithoutIds,r,g,u,h,m||0)||this.needsUpload}get(t){return this.programConfigurations[t]}upload(t){if(this.needsUpload){for(const r in this.programConfigurations)this.programConfigurations[r].upload(t);this.needsUpload=!1}}destroy(){for(const t in this.programConfigurations)this.programConfigurations[t].destroy()}}const hQ={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-emissive-strength":["emissive_strength"],"icon-emissive-strength":["emissive_strength"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function pQ(a,t){return hQ[a]||[a.replace(`${t}-`,"").replace(/-/g,"_")]}const fQ={"line-pattern":{source:Tn,composite:Tn},"fill-pattern":{source:Tn,composite:Tn},"fill-extrusion-pattern":{source:Tn,composite:Tn},"line-dasharray":{source:Si,composite:Si}},mQ={color:{source:o1,composite:dn},number:{source:gr,composite:o1}};function CO(a,t,r){const c=fQ[a];return c&&c[r]||mQ[t][r]}un(l1,"ConstantBinder"),un(iv,"PatternConstantBinder"),un(Qd,"SourceExpressionBinder"),un(gp,"PatternCompositeBinder"),un(Hc,"CompositeExpressionBinder"),un(bm,"ProgramConfiguration",{omit:["_buffers"]}),un(yp,"ProgramConfigurationSet");class Ol{constructor(t,r){t&&(r?this.setSouthWest(t).setNorthEast(r):t.length===4?this.setSouthWest([t[0],t[1]]).setNorthEast([t[2],t[3]]):this.setSouthWest(t[0]).setNorthEast(t[1]))}setNorthEast(t){return this._ne=t instanceof On?new On(t.lng,t.lat):On.convert(t),this}setSouthWest(t){return this._sw=t instanceof On?new On(t.lng,t.lat):On.convert(t),this}extend(t){const r=this._sw,c=this._ne;let u,h;if(t instanceof On)u=t,h=t;else{if(!(t instanceof Ol))return Array.isArray(t)?t.length===4||t.every(Array.isArray)?this.extend(Ol.convert(t)):this.extend(On.convert(t)):typeof t=="object"&&t!==null&&t.hasOwnProperty("lat")&&(t.hasOwnProperty("lon")||t.hasOwnProperty("lng"))?this.extend(On.convert(t)):this;if(u=t._sw,h=t._ne,!u||!h)return this}return r||c?(r.lng=Math.min(u.lng,r.lng),r.lat=Math.min(u.lat,r.lat),c.lng=Math.max(h.lng,c.lng),c.lat=Math.max(h.lat,c.lat)):(this._sw=new On(u.lng,u.lat),this._ne=new On(h.lng,h.lat)),this}getCenter(){return new On((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new On(this.getWest(),this.getNorth())}getSouthEast(){return new On(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(t){const{lng:r,lat:c}=On.convert(t);let u=this._sw.lng<=r&&r<=this._ne.lng;return this._sw.lng>this._ne.lng&&(u=this._sw.lng>=r&&r>=this._ne.lng),this._sw.lat<=c&&c<=this._ne.lat&&u}static convert(t){return!t||t instanceof Ol?t:new Ol(t)}}var to={},no={};Object.defineProperty(no,"__esModule",{value:!0}),no.setMatrixArrayType=function(a){no.ARRAY_TYPE=IO=a},no.toRadian=function(a){return a*yQ},no.equals=function(a,t){return Math.abs(a-t)<=PO*Math.max(1,Math.abs(a),Math.abs(t))},no.RANDOM=no.ARRAY_TYPE=no.EPSILON=void 0;var PO=1e-6;no.EPSILON=PO;var IO=typeof Float32Array<"u"?Float32Array:Array;no.ARRAY_TYPE=IO;var gQ=Math.random;no.RANDOM=gQ;var yQ=Math.PI/180;Math.hypot||(Math.hypot=function(){for(var a=0,t=arguments.length;t--;)a+=arguments[t]*arguments[t];return Math.sqrt(a)});var ka={};function OC(a){return OC=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},OC(a)}Object.defineProperty(ka,"__esModule",{value:!0}),ka.create=function(){var a=new vp.ARRAY_TYPE(4);return vp.ARRAY_TYPE!=Float32Array&&(a[1]=0,a[2]=0),a[0]=1,a[3]=1,a},ka.clone=function(a){var t=new vp.ARRAY_TYPE(4);return t[0]=a[0],t[1]=a[1],t[2]=a[2],t[3]=a[3],t},ka.copy=function(a,t){return a[0]=t[0],a[1]=t[1],a[2]=t[2],a[3]=t[3],a},ka.identity=function(a){return a[0]=1,a[1]=0,a[2]=0,a[3]=1,a},ka.fromValues=function(a,t,r,c){var u=new vp.ARRAY_TYPE(4);return u[0]=a,u[1]=t,u[2]=r,u[3]=c,u},ka.set=function(a,t,r,c,u){return a[0]=t,a[1]=r,a[2]=c,a[3]=u,a},ka.transpose=function(a,t){if(a===t){var r=t[1];a[1]=t[2],a[2]=r}else a[0]=t[0],a[1]=t[2],a[2]=t[1],a[3]=t[3];return a},ka.invert=function(a,t){var r=t[0],c=t[1],u=t[2],h=t[3],m=r*h-u*c;return m?(a[0]=h*(m=1/m),a[1]=-c*m,a[2]=-u*m,a[3]=r*m,a):null},ka.adjoint=function(a,t){var r=t[0];return a[0]=t[3],a[1]=-t[1],a[2]=-t[2],a[3]=r,a},ka.determinant=function(a){return a[0]*a[3]-a[2]*a[1]},ka.multiply=RO,ka.rotate=function(a,t,r){var c=t[0],u=t[1],h=t[2],m=t[3],g=Math.sin(r),v=Math.cos(r);return a[0]=c*v+h*g,a[1]=u*v+m*g,a[2]=c*-g+h*v,a[3]=u*-g+m*v,a},ka.scale=function(a,t,r){var c=t[1],u=t[2],h=t[3],m=r[0],g=r[1];return a[0]=t[0]*m,a[1]=c*m,a[2]=u*g,a[3]=h*g,a},ka.fromRotation=function(a,t){var r=Math.sin(t),c=Math.cos(t);return a[0]=c,a[1]=r,a[2]=-r,a[3]=c,a},ka.fromScaling=function(a,t){return a[0]=t[0],a[1]=0,a[2]=0,a[3]=t[1],a},ka.str=function(a){return"mat2("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+")"},ka.frob=function(a){return Math.hypot(a[0],a[1],a[2],a[3])},ka.LDU=function(a,t,r,c){return a[2]=c[2]/c[0],r[0]=c[0],r[1]=c[1],r[3]=c[3]-a[2]*r[1],[a,t,r]},ka.add=function(a,t,r){return a[0]=t[0]+r[0],a[1]=t[1]+r[1],a[2]=t[2]+r[2],a[3]=t[3]+r[3],a},ka.subtract=kO,ka.exactEquals=function(a,t){return a[0]===t[0]&&a[1]===t[1]&&a[2]===t[2]&&a[3]===t[3]},ka.equals=function(a,t){var r=a[0],c=a[1],u=a[2],h=a[3],m=t[0],g=t[1],v=t[2],b=t[3];return Math.abs(r-m)<=vp.EPSILON*Math.max(1,Math.abs(r),Math.abs(m))&&Math.abs(c-g)<=vp.EPSILON*Math.max(1,Math.abs(c),Math.abs(g))&&Math.abs(u-v)<=vp.EPSILON*Math.max(1,Math.abs(u),Math.abs(v))&&Math.abs(h-b)<=vp.EPSILON*Math.max(1,Math.abs(h),Math.abs(b))},ka.multiplyScalar=function(a,t,r){return a[0]=t[0]*r,a[1]=t[1]*r,a[2]=t[2]*r,a[3]=t[3]*r,a},ka.multiplyScalarAndAdd=function(a,t,r,c){return a[0]=t[0]+r[0]*c,a[1]=t[1]+r[1]*c,a[2]=t[2]+r[2]*c,a[3]=t[3]+r[3]*c,a},ka.sub=ka.mul=void 0;var vp=function(a,t){if(a&&a.__esModule)return a;if(a===null||OC(a)!=="object"&&typeof a!="function")return{default:a};var r=LO(void 0);if(r&&r.has(a))return r.get(a);var c={},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var h in a)if(h!=="default"&&Object.prototype.hasOwnProperty.call(a,h)){var m=u?Object.getOwnPropertyDescriptor(a,h):null;m&&(m.get||m.set)?Object.defineProperty(c,h,m):c[h]=a[h]}return c.default=a,r&&r.set(a,c),c}(no);function LO(a){if(typeof WeakMap!="function")return null;var t=new WeakMap,r=new WeakMap;return(LO=function(c){return c?r:t})(a)}function RO(a,t,r){var c=t[0],u=t[1],h=t[2],m=t[3],g=r[0],v=r[1],b=r[2],w=r[3];return a[0]=c*g+h*v,a[1]=u*g+m*v,a[2]=c*b+h*w,a[3]=u*b+m*w,a}function kO(a,t,r){return a[0]=t[0]-r[0],a[1]=t[1]-r[1],a[2]=t[2]-r[2],a[3]=t[3]-r[3],a}ka.mul=RO,ka.sub=kO;var za={};function NC(a){return NC=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},NC(a)}Object.defineProperty(za,"__esModule",{value:!0}),za.create=function(){var a=new Gu.ARRAY_TYPE(6);return Gu.ARRAY_TYPE!=Float32Array&&(a[1]=0,a[2]=0,a[4]=0,a[5]=0),a[0]=1,a[3]=1,a},za.clone=function(a){var t=new Gu.ARRAY_TYPE(6);return t[0]=a[0],t[1]=a[1],t[2]=a[2],t[3]=a[3],t[4]=a[4],t[5]=a[5],t},za.copy=function(a,t){return a[0]=t[0],a[1]=t[1],a[2]=t[2],a[3]=t[3],a[4]=t[4],a[5]=t[5],a},za.identity=function(a){return a[0]=1,a[1]=0,a[2]=0,a[3]=1,a[4]=0,a[5]=0,a},za.fromValues=function(a,t,r,c,u,h){var m=new Gu.ARRAY_TYPE(6);return m[0]=a,m[1]=t,m[2]=r,m[3]=c,m[4]=u,m[5]=h,m},za.set=function(a,t,r,c,u,h,m){return a[0]=t,a[1]=r,a[2]=c,a[3]=u,a[4]=h,a[5]=m,a},za.invert=function(a,t){var r=t[0],c=t[1],u=t[2],h=t[3],m=t[4],g=t[5],v=r*h-c*u;return v?(a[0]=h*(v=1/v),a[1]=-c*v,a[2]=-u*v,a[3]=r*v,a[4]=(u*g-h*m)*v,a[5]=(c*m-r*g)*v,a):null},za.determinant=function(a){return a[0]*a[3]-a[1]*a[2]},za.multiply=OO,za.rotate=function(a,t,r){var c=t[0],u=t[1],h=t[2],m=t[3],g=t[4],v=t[5],b=Math.sin(r),w=Math.cos(r);return a[0]=c*w+h*b,a[1]=u*w+m*b,a[2]=c*-b+h*w,a[3]=u*-b+m*w,a[4]=g,a[5]=v,a},za.scale=function(a,t,r){var c=t[1],u=t[2],h=t[3],m=t[4],g=t[5],v=r[0],b=r[1];return a[0]=t[0]*v,a[1]=c*v,a[2]=u*b,a[3]=h*b,a[4]=m,a[5]=g,a},za.translate=function(a,t,r){var c=t[0],u=t[1],h=t[2],m=t[3],g=t[4],v=t[5],b=r[0],w=r[1];return a[0]=c,a[1]=u,a[2]=h,a[3]=m,a[4]=c*b+h*w+g,a[5]=u*b+m*w+v,a},za.fromRotation=function(a,t){var r=Math.sin(t),c=Math.cos(t);return a[0]=c,a[1]=r,a[2]=-r,a[3]=c,a[4]=0,a[5]=0,a},za.fromScaling=function(a,t){return a[0]=t[0],a[1]=0,a[2]=0,a[3]=t[1],a[4]=0,a[5]=0,a},za.fromTranslation=function(a,t){return a[0]=1,a[1]=0,a[2]=0,a[3]=1,a[4]=t[0],a[5]=t[1],a},za.str=function(a){return"mat2d("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+")"},za.frob=function(a){return Math.hypot(a[0],a[1],a[2],a[3],a[4],a[5],1)},za.add=function(a,t,r){return a[0]=t[0]+r[0],a[1]=t[1]+r[1],a[2]=t[2]+r[2],a[3]=t[3]+r[3],a[4]=t[4]+r[4],a[5]=t[5]+r[5],a},za.subtract=NO,za.multiplyScalar=function(a,t,r){return a[0]=t[0]*r,a[1]=t[1]*r,a[2]=t[2]*r,a[3]=t[3]*r,a[4]=t[4]*r,a[5]=t[5]*r,a},za.multiplyScalarAndAdd=function(a,t,r,c){return a[0]=t[0]+r[0]*c,a[1]=t[1]+r[1]*c,a[2]=t[2]+r[2]*c,a[3]=t[3]+r[3]*c,a[4]=t[4]+r[4]*c,a[5]=t[5]+r[5]*c,a},za.exactEquals=function(a,t){return a[0]===t[0]&&a[1]===t[1]&&a[2]===t[2]&&a[3]===t[3]&&a[4]===t[4]&&a[5]===t[5]},za.equals=function(a,t){var r=a[0],c=a[1],u=a[2],h=a[3],m=a[4],g=a[5],v=t[0],b=t[1],w=t[2],A=t[3],C=t[4],P=t[5];return Math.abs(r-v)<=Gu.EPSILON*Math.max(1,Math.abs(r),Math.abs(v))&&Math.abs(c-b)<=Gu.EPSILON*Math.max(1,Math.abs(c),Math.abs(b))&&Math.abs(u-w)<=Gu.EPSILON*Math.max(1,Math.abs(u),Math.abs(w))&&Math.abs(h-A)<=Gu.EPSILON*Math.max(1,Math.abs(h),Math.abs(A))&&Math.abs(m-C)<=Gu.EPSILON*Math.max(1,Math.abs(m),Math.abs(C))&&Math.abs(g-P)<=Gu.EPSILON*Math.max(1,Math.abs(g),Math.abs(P))},za.sub=za.mul=void 0;var Gu=function(a,t){if(a&&a.__esModule)return a;if(a===null||NC(a)!=="object"&&typeof a!="function")return{default:a};var r=DO(void 0);if(r&&r.has(a))return r.get(a);var c={},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var h in a)if(h!=="default"&&Object.prototype.hasOwnProperty.call(a,h)){var m=u?Object.getOwnPropertyDescriptor(a,h):null;m&&(m.get||m.set)?Object.defineProperty(c,h,m):c[h]=a[h]}return c.default=a,r&&r.set(a,c),c}(no);function DO(a){if(typeof WeakMap!="function")return null;var t=new WeakMap,r=new WeakMap;return(DO=function(c){return c?r:t})(a)}function OO(a,t,r){var c=t[0],u=t[1],h=t[2],m=t[3],g=t[4],v=t[5],b=r[0],w=r[1],A=r[2],C=r[3],P=r[4],k=r[5];return a[0]=c*b+h*w,a[1]=u*b+m*w,a[2]=c*A+h*C,a[3]=u*A+m*C,a[4]=c*P+h*k+g,a[5]=u*P+m*k+v,a}function NO(a,t,r){return a[0]=t[0]-r[0],a[1]=t[1]-r[1],a[2]=t[2]-r[2],a[3]=t[3]-r[3],a[4]=t[4]-r[4],a[5]=t[5]-r[5],a}za.mul=OO,za.sub=NO;var Yi={};function zC(a){return zC=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zC(a)}Object.defineProperty(Yi,"__esModule",{value:!0}),Yi.create=function(){var a=new Nl.ARRAY_TYPE(9);return Nl.ARRAY_TYPE!=Float32Array&&(a[1]=0,a[2]=0,a[3]=0,a[5]=0,a[6]=0,a[7]=0),a[0]=1,a[4]=1,a[8]=1,a},Yi.fromMat4=function(a,t){return a[0]=t[0],a[1]=t[1],a[2]=t[2],a[3]=t[4],a[4]=t[5],a[5]=t[6],a[6]=t[8],a[7]=t[9],a[8]=t[10],a},Yi.clone=function(a){var t=new Nl.ARRAY_TYPE(9);return t[0]=a[0],t[1]=a[1],t[2]=a[2],t[3]=a[3],t[4]=a[4],t[5]=a[5],t[6]=a[6],t[7]=a[7],t[8]=a[8],t},Yi.copy=function(a,t){return a[0]=t[0],a[1]=t[1],a[2]=t[2],a[3]=t[3],a[4]=t[4],a[5]=t[5],a[6]=t[6],a[7]=t[7],a[8]=t[8],a},Yi.fromValues=function(a,t,r,c,u,h,m,g,v){var b=new Nl.ARRAY_TYPE(9);return b[0]=a,b[1]=t,b[2]=r,b[3]=c,b[4]=u,b[5]=h,b[6]=m,b[7]=g,b[8]=v,b},Yi.set=function(a,t,r,c,u,h,m,g,v,b){return a[0]=t,a[1]=r,a[2]=c,a[3]=u,a[4]=h,a[5]=m,a[6]=g,a[7]=v,a[8]=b,a},Yi.identity=function(a){return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=1,a[5]=0,a[6]=0,a[7]=0,a[8]=1,a},Yi.transpose=function(a,t){if(a===t){var r=t[1],c=t[2],u=t[5];a[1]=t[3],a[2]=t[6],a[3]=r,a[5]=t[7],a[6]=c,a[7]=u}else a[0]=t[0],a[1]=t[3],a[2]=t[6],a[3]=t[1],a[4]=t[4],a[5]=t[7],a[6]=t[2],a[7]=t[5],a[8]=t[8];return a},Yi.invert=function(a,t){var r=t[0],c=t[1],u=t[2],h=t[3],m=t[4],g=t[5],v=t[6],b=t[7],w=t[8],A=w*m-g*b,C=-w*h+g*v,P=b*h-m*v,k=r*A+c*C+u*P;return k?(a[0]=A*(k=1/k),a[1]=(-w*c+u*b)*k,a[2]=(g*c-u*m)*k,a[3]=C*k,a[4]=(w*r-u*v)*k,a[5]=(-g*r+u*h)*k,a[6]=P*k,a[7]=(-b*r+c*v)*k,a[8]=(m*r-c*h)*k,a):null},Yi.adjoint=function(a,t){var r=t[0],c=t[1],u=t[2],h=t[3],m=t[4],g=t[5],v=t[6],b=t[7],w=t[8];return a[0]=m*w-g*b,a[1]=u*b-c*w,a[2]=c*g-u*m,a[3]=g*v-h*w,a[4]=r*w-u*v,a[5]=u*h-r*g,a[6]=h*b-m*v,a[7]=c*v-r*b,a[8]=r*m-c*h,a},Yi.determinant=function(a){var t=a[3],r=a[4],c=a[5],u=a[6],h=a[7],m=a[8];return a[0]*(m*r-c*h)+a[1]*(-m*t+c*u)+a[2]*(h*t-r*u)},Yi.multiply=FO,Yi.translate=function(a,t,r){var c=t[0],u=t[1],h=t[2],m=t[3],g=t[4],v=t[5],b=t[6],w=t[7],A=t[8],C=r[0],P=r[1];return a[0]=c,a[1]=u,a[2]=h,a[3]=m,a[4]=g,a[5]=v,a[6]=C*c+P*m+b,a[7]=C*u+P*g+w,a[8]=C*h+P*v+A,a},Yi.rotate=function(a,t,r){var c=t[0],u=t[1],h=t[2],m=t[3],g=t[4],v=t[5],b=t[6],w=t[7],A=t[8],C=Math.sin(r),P=Math.cos(r);return a[0]=P*c+C*m,a[1]=P*u+C*g,a[2]=P*h+C*v,a[3]=P*m-C*c,a[4]=P*g-C*u,a[5]=P*v-C*h,a[6]=b,a[7]=w,a[8]=A,a},Yi.scale=function(a,t,r){var c=r[0],u=r[1];return a[0]=c*t[0],a[1]=c*t[1],a[2]=c*t[2],a[3]=u*t[3],a[4]=u*t[4],a[5]=u*t[5],a[6]=t[6],a[7]=t[7],a[8]=t[8],a},Yi.fromTranslation=function(a,t){return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=1,a[5]=0,a[6]=t[0],a[7]=t[1],a[8]=1,a},Yi.fromRotation=function(a,t){var r=Math.sin(t),c=Math.cos(t);return a[0]=c,a[1]=r,a[2]=0,a[3]=-r,a[4]=c,a[5]=0,a[6]=0,a[7]=0,a[8]=1,a},Yi.fromScaling=function(a,t){return a[0]=t[0],a[1]=0,a[2]=0,a[3]=0,a[4]=t[1],a[5]=0,a[6]=0,a[7]=0,a[8]=1,a},Yi.fromMat2d=function(a,t){return a[0]=t[0],a[1]=t[1],a[2]=0,a[3]=t[2],a[4]=t[3],a[5]=0,a[6]=t[4],a[7]=t[5],a[8]=1,a},Yi.fromQuat=function(a,t){var r=t[0],c=t[1],u=t[2],h=t[3],m=r+r,g=c+c,v=u+u,b=r*m,w=c*m,A=c*g,C=u*m,P=u*g,k=u*v,z=h*m,U=h*g,W=h*v;return a[0]=1-A-k,a[3]=w-W,a[6]=C+U,a[1]=w+W,a[4]=1-b-k,a[7]=P-z,a[2]=C-U,a[5]=P+z,a[8]=1-b-A,a},Yi.normalFromMat4=function(a,t){var r=t[0],c=t[1],u=t[2],h=t[3],m=t[4],g=t[5],v=t[6],b=t[7],w=t[8],A=t[9],C=t[10],P=t[11],k=t[12],z=t[13],U=t[14],W=t[15],$=r*g-c*m,Z=r*v-u*m,K=r*b-h*m,q=c*v-u*g,J=c*b-h*g,re=u*b-h*v,ce=w*z-A*k,ge=w*U-C*k,ve=w*W-P*k,Ce=A*U-C*z,Ae=A*W-P*z,Le=C*W-P*U,Se=$*Le-Z*Ae+K*Ce+q*ve-J*ge+re*ce;return Se?(a[0]=(g*Le-v*Ae+b*Ce)*(Se=1/Se),a[1]=(v*ve-m*Le-b*ge)*Se,a[2]=(m*Ae-g*ve+b*ce)*Se,a[3]=(u*Ae-c*Le-h*Ce)*Se,a[4]=(r*Le-u*ve+h*ge)*Se,a[5]=(c*ve-r*Ae-h*ce)*Se,a[6]=(z*re-U*J+W*q)*Se,a[7]=(U*K-k*re-W*Z)*Se,a[8]=(k*J-z*K+W*$)*Se,a):null},Yi.projection=function(a,t,r){return a[0]=2/t,a[1]=0,a[2]=0,a[3]=0,a[4]=-2/r,a[5]=0,a[6]=-1,a[7]=1,a[8]=1,a},Yi.str=function(a){return"mat3("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+")"},Yi.frob=function(a){return Math.hypot(a[0],a[1],a[2],a[3],a[4],a[5],a[6],a[7],a[8])},Yi.add=function(a,t,r){return a[0]=t[0]+r[0],a[1]=t[1]+r[1],a[2]=t[2]+r[2],a[3]=t[3]+r[3],a[4]=t[4]+r[4],a[5]=t[5]+r[5],a[6]=t[6]+r[6],a[7]=t[7]+r[7],a[8]=t[8]+r[8],a},Yi.subtract=BO,Yi.multiplyScalar=function(a,t,r){return a[0]=t[0]*r,a[1]=t[1]*r,a[2]=t[2]*r,a[3]=t[3]*r,a[4]=t[4]*r,a[5]=t[5]*r,a[6]=t[6]*r,a[7]=t[7]*r,a[8]=t[8]*r,a},Yi.multiplyScalarAndAdd=function(a,t,r,c){return a[0]=t[0]+r[0]*c,a[1]=t[1]+r[1]*c,a[2]=t[2]+r[2]*c,a[3]=t[3]+r[3]*c,a[4]=t[4]+r[4]*c,a[5]=t[5]+r[5]*c,a[6]=t[6]+r[6]*c,a[7]=t[7]+r[7]*c,a[8]=t[8]+r[8]*c,a},Yi.exactEquals=function(a,t){return a[0]===t[0]&&a[1]===t[1]&&a[2]===t[2]&&a[3]===t[3]&&a[4]===t[4]&&a[5]===t[5]&&a[6]===t[6]&&a[7]===t[7]&&a[8]===t[8]},Yi.equals=function(a,t){var r=a[0],c=a[1],u=a[2],h=a[3],m=a[4],g=a[5],v=a[6],b=a[7],w=a[8],A=t[0],C=t[1],P=t[2],k=t[3],z=t[4],U=t[5],W=t[6],$=t[7],Z=t[8];return Math.abs(r-A)<=Nl.EPSILON*Math.max(1,Math.abs(r),Math.abs(A))&&Math.abs(c-C)<=Nl.EPSILON*Math.max(1,Math.abs(c),Math.abs(C))&&Math.abs(u-P)<=Nl.EPSILON*Math.max(1,Math.abs(u),Math.abs(P))&&Math.abs(h-k)<=Nl.EPSILON*Math.max(1,Math.abs(h),Math.abs(k))&&Math.abs(m-z)<=Nl.EPSILON*Math.max(1,Math.abs(m),Math.abs(z))&&Math.abs(g-U)<=Nl.EPSILON*Math.max(1,Math.abs(g),Math.abs(U))&&Math.abs(v-W)<=Nl.EPSILON*Math.max(1,Math.abs(v),Math.abs(W))&&Math.abs(b-$)<=Nl.EPSILON*Math.max(1,Math.abs(b),Math.abs($))&&Math.abs(w-Z)<=Nl.EPSILON*Math.max(1,Math.abs(w),Math.abs(Z))},Yi.sub=Yi.mul=void 0;var Nl=function(a,t){if(a&&a.__esModule)return a;if(a===null||zC(a)!=="object"&&typeof a!="function")return{default:a};var r=zO(void 0);if(r&&r.has(a))return r.get(a);var c={},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var h in a)if(h!=="default"&&Object.prototype.hasOwnProperty.call(a,h)){var m=u?Object.getOwnPropertyDescriptor(a,h):null;m&&(m.get||m.set)?Object.defineProperty(c,h,m):c[h]=a[h]}return c.default=a,r&&r.set(a,c),c}(no);function zO(a){if(typeof WeakMap!="function")return null;var t=new WeakMap,r=new WeakMap;return(zO=function(c){return c?r:t})(a)}function FO(a,t,r){var c=t[0],u=t[1],h=t[2],m=t[3],g=t[4],v=t[5],b=t[6],w=t[7],A=t[8],C=r[0],P=r[1],k=r[2],z=r[3],U=r[4],W=r[5],$=r[6],Z=r[7],K=r[8];return a[0]=C*c+P*m+k*b,a[1]=C*u+P*g+k*w,a[2]=C*h+P*v+k*A,a[3]=z*c+U*m+W*b,a[4]=z*u+U*g+W*w,a[5]=z*h+U*v+W*A,a[6]=$*c+Z*m+K*b,a[7]=$*u+Z*g+K*w,a[8]=$*h+Z*v+K*A,a}function BO(a,t,r){return a[0]=t[0]-r[0],a[1]=t[1]-r[1],a[2]=t[2]-r[2],a[3]=t[3]-r[3],a[4]=t[4]-r[4],a[5]=t[5]-r[5],a[6]=t[6]-r[6],a[7]=t[7]-r[7],a[8]=t[8]-r[8],a}Yi.mul=FO,Yi.sub=BO;var Qn={};function FC(a){return FC=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},FC(a)}Object.defineProperty(Qn,"__esModule",{value:!0}),Qn.create=function(){var a=new Ya.ARRAY_TYPE(16);return Ya.ARRAY_TYPE!=Float32Array&&(a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[11]=0,a[12]=0,a[13]=0,a[14]=0),a[0]=1,a[5]=1,a[10]=1,a[15]=1,a},Qn.clone=function(a){var t=new Ya.ARRAY_TYPE(16);return t[0]=a[0],t[1]=a[1],t[2]=a[2],t[3]=a[3],t[4]=a[4],t[5]=a[5],t[6]=a[6],t[7]=a[7],t[8]=a[8],t[9]=a[9],t[10]=a[10],t[11]=a[11],t[12]=a[12],t[13]=a[13],t[14]=a[14],t[15]=a[15],t},Qn.copy=function(a,t){return a[0]=t[0],a[1]=t[1],a[2]=t[2],a[3]=t[3],a[4]=t[4],a[5]=t[5],a[6]=t[6],a[7]=t[7],a[8]=t[8],a[9]=t[9],a[10]=t[10],a[11]=t[11],a[12]=t[12],a[13]=t[13],a[14]=t[14],a[15]=t[15],a},Qn.fromValues=function(a,t,r,c,u,h,m,g,v,b,w,A,C,P,k,z){var U=new Ya.ARRAY_TYPE(16);return U[0]=a,U[1]=t,U[2]=r,U[3]=c,U[4]=u,U[5]=h,U[6]=m,U[7]=g,U[8]=v,U[9]=b,U[10]=w,U[11]=A,U[12]=C,U[13]=P,U[14]=k,U[15]=z,U},Qn.set=function(a,t,r,c,u,h,m,g,v,b,w,A,C,P,k,z,U){return a[0]=t,a[1]=r,a[2]=c,a[3]=u,a[4]=h,a[5]=m,a[6]=g,a[7]=v,a[8]=b,a[9]=w,a[10]=A,a[11]=C,a[12]=P,a[13]=k,a[14]=z,a[15]=U,a},Qn.identity=WO,Qn.transpose=function(a,t){if(a===t){var r=t[1],c=t[2],u=t[3],h=t[6],m=t[7],g=t[11];a[1]=t[4],a[2]=t[8],a[3]=t[12],a[4]=r,a[6]=t[9],a[7]=t[13],a[8]=c,a[9]=h,a[11]=t[14],a[12]=u,a[13]=m,a[14]=g}else a[0]=t[0],a[1]=t[4],a[2]=t[8],a[3]=t[12],a[4]=t[1],a[5]=t[5],a[6]=t[9],a[7]=t[13],a[8]=t[2],a[9]=t[6],a[10]=t[10],a[11]=t[14],a[12]=t[3],a[13]=t[7],a[14]=t[11],a[15]=t[15];return a},Qn.invert=function(a,t){var r=t[0],c=t[1],u=t[2],h=t[3],m=t[4],g=t[5],v=t[6],b=t[7],w=t[8],A=t[9],C=t[10],P=t[11],k=t[12],z=t[13],U=t[14],W=t[15],$=r*g-c*m,Z=r*v-u*m,K=r*b-h*m,q=c*v-u*g,J=c*b-h*g,re=u*b-h*v,ce=w*z-A*k,ge=w*U-C*k,ve=w*W-P*k,Ce=A*U-C*z,Ae=A*W-P*z,Le=C*W-P*U,Se=$*Le-Z*Ae+K*Ce+q*ve-J*ge+re*ce;return Se?(a[0]=(g*Le-v*Ae+b*Ce)*(Se=1/Se),a[1]=(u*Ae-c*Le-h*Ce)*Se,a[2]=(z*re-U*J+W*q)*Se,a[3]=(C*J-A*re-P*q)*Se,a[4]=(v*ve-m*Le-b*ge)*Se,a[5]=(r*Le-u*ve+h*ge)*Se,a[6]=(U*K-k*re-W*Z)*Se,a[7]=(w*re-C*K+P*Z)*Se,a[8]=(m*Ae-g*ve+b*ce)*Se,a[9]=(c*ve-r*Ae-h*ce)*Se,a[10]=(k*J-z*K+W*$)*Se,a[11]=(A*K-w*J-P*$)*Se,a[12]=(g*ge-m*Ce-v*ce)*Se,a[13]=(r*Ce-c*ge+u*ce)*Se,a[14]=(z*Z-k*q-U*$)*Se,a[15]=(w*q-A*Z+C*$)*Se,a):null},Qn.adjoint=function(a,t){var r=t[0],c=t[1],u=t[2],h=t[3],m=t[4],g=t[5],v=t[6],b=t[7],w=t[8],A=t[9],C=t[10],P=t[11],k=t[12],z=t[13],U=t[14],W=t[15];return a[0]=g*(C*W-P*U)-A*(v*W-b*U)+z*(v*P-b*C),a[1]=-(c*(C*W-P*U)-A*(u*W-h*U)+z*(u*P-h*C)),a[2]=c*(v*W-b*U)-g*(u*W-h*U)+z*(u*b-h*v),a[3]=-(c*(v*P-b*C)-g*(u*P-h*C)+A*(u*b-h*v)),a[4]=-(m*(C*W-P*U)-w*(v*W-b*U)+k*(v*P-b*C)),a[5]=r*(C*W-P*U)-w*(u*W-h*U)+k*(u*P-h*C),a[6]=-(r*(v*W-b*U)-m*(u*W-h*U)+k*(u*b-h*v)),a[7]=r*(v*P-b*C)-m*(u*P-h*C)+w*(u*b-h*v),a[8]=m*(A*W-P*z)-w*(g*W-b*z)+k*(g*P-b*A),a[9]=-(r*(A*W-P*z)-w*(c*W-h*z)+k*(c*P-h*A)),a[10]=r*(g*W-b*z)-m*(c*W-h*z)+k*(c*b-h*g),a[11]=-(r*(g*P-b*A)-m*(c*P-h*A)+w*(c*b-h*g)),a[12]=-(m*(A*U-C*z)-w*(g*U-v*z)+k*(g*C-v*A)),a[13]=r*(A*U-C*z)-w*(c*U-u*z)+k*(c*C-u*A),a[14]=-(r*(g*U-v*z)-m*(c*U-u*z)+k*(c*v-u*g)),a[15]=r*(g*C-v*A)-m*(c*C-u*A)+w*(c*v-u*g),a},Qn.determinant=function(a){var t=a[0],r=a[1],c=a[2],u=a[3],h=a[4],m=a[5],g=a[6],v=a[7],b=a[8],w=a[9],A=a[10],C=a[11],P=a[12],k=a[13],z=a[14],U=a[15];return(t*m-r*h)*(A*U-C*z)-(t*g-c*h)*(w*U-C*k)+(t*v-u*h)*(w*z-A*k)+(r*g-c*m)*(b*U-C*P)-(r*v-u*m)*(b*z-A*P)+(c*v-u*g)*(b*k-w*P)},Qn.multiply=VO,Qn.translate=function(a,t,r){var c,u,h,m,g,v,b,w,A,C,P,k,z=r[0],U=r[1],W=r[2];return t===a?(a[12]=t[0]*z+t[4]*U+t[8]*W+t[12],a[13]=t[1]*z+t[5]*U+t[9]*W+t[13],a[14]=t[2]*z+t[6]*U+t[10]*W+t[14],a[15]=t[3]*z+t[7]*U+t[11]*W+t[15]):(u=t[1],h=t[2],m=t[3],g=t[4],v=t[5],b=t[6],w=t[7],A=t[8],C=t[9],P=t[10],k=t[11],a[0]=c=t[0],a[1]=u,a[2]=h,a[3]=m,a[4]=g,a[5]=v,a[6]=b,a[7]=w,a[8]=A,a[9]=C,a[10]=P,a[11]=k,a[12]=c*z+g*U+A*W+t[12],a[13]=u*z+v*U+C*W+t[13],a[14]=h*z+b*U+P*W+t[14],a[15]=m*z+w*U+k*W+t[15]),a},Qn.scale=function(a,t,r){var c=r[0],u=r[1],h=r[2];return a[0]=t[0]*c,a[1]=t[1]*c,a[2]=t[2]*c,a[3]=t[3]*c,a[4]=t[4]*u,a[5]=t[5]*u,a[6]=t[6]*u,a[7]=t[7]*u,a[8]=t[8]*h,a[9]=t[9]*h,a[10]=t[10]*h,a[11]=t[11]*h,a[12]=t[12],a[13]=t[13],a[14]=t[14],a[15]=t[15],a},Qn.rotate=function(a,t,r,c){var u,h,m,g,v,b,w,A,C,P,k,z,U,W,$,Z,K,q,J,re,ce,ge,ve,Ce,Ae=c[0],Le=c[1],Se=c[2],Ve=Math.hypot(Ae,Le,Se);return Ve<Ya.EPSILON?null:(Ae*=Ve=1/Ve,Le*=Ve,Se*=Ve,u=Math.sin(r),h=Math.cos(r),v=t[1],b=t[2],w=t[3],C=t[5],P=t[6],k=t[7],U=t[9],W=t[10],$=t[11],J=Ae*Le*(m=1-h)-Se*u,re=Le*Le*m+h,ce=Se*Le*m+Ae*u,ge=Ae*Se*m+Le*u,ve=Le*Se*m-Ae*u,Ce=Se*Se*m+h,a[0]=(g=t[0])*(Z=Ae*Ae*m+h)+(A=t[4])*(K=Le*Ae*m+Se*u)+(z=t[8])*(q=Se*Ae*m-Le*u),a[1]=v*Z+C*K+U*q,a[2]=b*Z+P*K+W*q,a[3]=w*Z+k*K+$*q,a[4]=g*J+A*re+z*ce,a[5]=v*J+C*re+U*ce,a[6]=b*J+P*re+W*ce,a[7]=w*J+k*re+$*ce,a[8]=g*ge+A*ve+z*Ce,a[9]=v*ge+C*ve+U*Ce,a[10]=b*ge+P*ve+W*Ce,a[11]=w*ge+k*ve+$*Ce,t!==a&&(a[12]=t[12],a[13]=t[13],a[14]=t[14],a[15]=t[15]),a)},Qn.rotateX=function(a,t,r){var c=Math.sin(r),u=Math.cos(r),h=t[4],m=t[5],g=t[6],v=t[7],b=t[8],w=t[9],A=t[10],C=t[11];return t!==a&&(a[0]=t[0],a[1]=t[1],a[2]=t[2],a[3]=t[3],a[12]=t[12],a[13]=t[13],a[14]=t[14],a[15]=t[15]),a[4]=h*u+b*c,a[5]=m*u+w*c,a[6]=g*u+A*c,a[7]=v*u+C*c,a[8]=b*u-h*c,a[9]=w*u-m*c,a[10]=A*u-g*c,a[11]=C*u-v*c,a},Qn.rotateY=function(a,t,r){var c=Math.sin(r),u=Math.cos(r),h=t[0],m=t[1],g=t[2],v=t[3],b=t[8],w=t[9],A=t[10],C=t[11];return t!==a&&(a[4]=t[4],a[5]=t[5],a[6]=t[6],a[7]=t[7],a[12]=t[12],a[13]=t[13],a[14]=t[14],a[15]=t[15]),a[0]=h*u-b*c,a[1]=m*u-w*c,a[2]=g*u-A*c,a[3]=v*u-C*c,a[8]=h*c+b*u,a[9]=m*c+w*u,a[10]=g*c+A*u,a[11]=v*c+C*u,a},Qn.rotateZ=function(a,t,r){var c=Math.sin(r),u=Math.cos(r),h=t[0],m=t[1],g=t[2],v=t[3],b=t[4],w=t[5],A=t[6],C=t[7];return t!==a&&(a[8]=t[8],a[9]=t[9],a[10]=t[10],a[11]=t[11],a[12]=t[12],a[13]=t[13],a[14]=t[14],a[15]=t[15]),a[0]=h*u+b*c,a[1]=m*u+w*c,a[2]=g*u+A*c,a[3]=v*u+C*c,a[4]=b*u-h*c,a[5]=w*u-m*c,a[6]=A*u-g*c,a[7]=C*u-v*c,a},Qn.fromTranslation=function(a,t){return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=t[0],a[13]=t[1],a[14]=t[2],a[15]=1,a},Qn.fromScaling=function(a,t){return a[0]=t[0],a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=t[1],a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=t[2],a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a},Qn.fromRotation=function(a,t,r){var c,u,h,m=r[0],g=r[1],v=r[2],b=Math.hypot(m,g,v);return b<Ya.EPSILON?null:(m*=b=1/b,g*=b,v*=b,c=Math.sin(t),u=Math.cos(t),a[0]=m*m*(h=1-u)+u,a[1]=g*m*h+v*c,a[2]=v*m*h-g*c,a[3]=0,a[4]=m*g*h-v*c,a[5]=g*g*h+u,a[6]=v*g*h+m*c,a[7]=0,a[8]=m*v*h+g*c,a[9]=g*v*h-m*c,a[10]=v*v*h+u,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a)},Qn.fromXRotation=function(a,t){var r=Math.sin(t),c=Math.cos(t);return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=c,a[6]=r,a[7]=0,a[8]=0,a[9]=-r,a[10]=c,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a},Qn.fromYRotation=function(a,t){var r=Math.sin(t),c=Math.cos(t);return a[0]=c,a[1]=0,a[2]=-r,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=r,a[9]=0,a[10]=c,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a},Qn.fromZRotation=function(a,t){var r=Math.sin(t),c=Math.cos(t);return a[0]=c,a[1]=r,a[2]=0,a[3]=0,a[4]=-r,a[5]=c,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a},Qn.fromRotationTranslation=GO,Qn.fromQuat2=function(a,t){var r=new Ya.ARRAY_TYPE(3),c=-t[0],u=-t[1],h=-t[2],m=t[3],g=t[4],v=t[5],b=t[6],w=t[7],A=c*c+u*u+h*h+m*m;return A>0?(r[0]=2*(g*m+w*c+v*h-b*u)/A,r[1]=2*(v*m+w*u+b*c-g*h)/A,r[2]=2*(b*m+w*h+g*u-v*c)/A):(r[0]=2*(g*m+w*c+v*h-b*u),r[1]=2*(v*m+w*u+b*c-g*h),r[2]=2*(b*m+w*h+g*u-v*c)),GO(a,t,r),a},Qn.getTranslation=function(a,t){return a[0]=t[12],a[1]=t[13],a[2]=t[14],a},Qn.getScaling=HO,Qn.getRotation=function(a,t){var r=new Ya.ARRAY_TYPE(3);HO(r,t);var c=1/r[0],u=1/r[1],h=1/r[2],m=t[0]*c,g=t[1]*u,v=t[2]*h,b=t[4]*c,w=t[5]*u,A=t[6]*h,C=t[8]*c,P=t[9]*u,k=t[10]*h,z=m+w+k,U=0;return z>0?(U=2*Math.sqrt(z+1),a[3]=.25*U,a[0]=(A-P)/U,a[1]=(C-v)/U,a[2]=(g-b)/U):m>w&&m>k?(U=2*Math.sqrt(1+m-w-k),a[3]=(A-P)/U,a[0]=.25*U,a[1]=(g+b)/U,a[2]=(C+v)/U):w>k?(U=2*Math.sqrt(1+w-m-k),a[3]=(C-v)/U,a[0]=(g+b)/U,a[1]=.25*U,a[2]=(A+P)/U):(U=2*Math.sqrt(1+k-m-w),a[3]=(g-b)/U,a[0]=(C+v)/U,a[1]=(A+P)/U,a[2]=.25*U),a},Qn.fromRotationTranslationScale=function(a,t,r,c){var u=t[0],h=t[1],m=t[2],g=t[3],v=u+u,b=h+h,w=m+m,A=u*v,C=u*b,P=u*w,k=h*b,z=h*w,U=m*w,W=g*v,$=g*b,Z=g*w,K=c[0],q=c[1],J=c[2];return a[0]=(1-(k+U))*K,a[1]=(C+Z)*K,a[2]=(P-$)*K,a[3]=0,a[4]=(C-Z)*q,a[5]=(1-(A+U))*q,a[6]=(z+W)*q,a[7]=0,a[8]=(P+$)*J,a[9]=(z-W)*J,a[10]=(1-(A+k))*J,a[11]=0,a[12]=r[0],a[13]=r[1],a[14]=r[2],a[15]=1,a},Qn.fromRotationTranslationScaleOrigin=function(a,t,r,c,u){var h=t[0],m=t[1],g=t[2],v=t[3],b=h+h,w=m+m,A=g+g,C=h*b,P=h*w,k=h*A,z=m*w,U=m*A,W=g*A,$=v*b,Z=v*w,K=v*A,q=c[0],J=c[1],re=c[2],ce=u[0],ge=u[1],ve=u[2],Ce=(1-(z+W))*q,Ae=(P+K)*q,Le=(k-Z)*q,Se=(P-K)*J,Ve=(1-(C+W))*J,Xe=(U+$)*J,nt=(k+Z)*re,We=(U-$)*re,Ge=(1-(C+z))*re;return a[0]=Ce,a[1]=Ae,a[2]=Le,a[3]=0,a[4]=Se,a[5]=Ve,a[6]=Xe,a[7]=0,a[8]=nt,a[9]=We,a[10]=Ge,a[11]=0,a[12]=r[0]+ce-(Ce*ce+Se*ge+nt*ve),a[13]=r[1]+ge-(Ae*ce+Ve*ge+We*ve),a[14]=r[2]+ve-(Le*ce+Xe*ge+Ge*ve),a[15]=1,a},Qn.fromQuat=function(a,t){var r=t[0],c=t[1],u=t[2],h=t[3],m=r+r,g=c+c,v=u+u,b=r*m,w=c*m,A=c*g,C=u*m,P=u*g,k=u*v,z=h*m,U=h*g,W=h*v;return a[0]=1-A-k,a[1]=w+W,a[2]=C-U,a[3]=0,a[4]=w-W,a[5]=1-b-k,a[6]=P+z,a[7]=0,a[8]=C+U,a[9]=P-z,a[10]=1-b-A,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a},Qn.frustum=function(a,t,r,c,u,h,m){var g=1/(r-t),v=1/(u-c),b=1/(h-m);return a[0]=2*h*g,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=2*h*v,a[6]=0,a[7]=0,a[8]=(r+t)*g,a[9]=(u+c)*v,a[10]=(m+h)*b,a[11]=-1,a[12]=0,a[13]=0,a[14]=m*h*2*b,a[15]=0,a},Qn.perspectiveNO=jO,Qn.perspectiveZO=function(a,t,r,c,u){var h,m=1/Math.tan(t/2);return a[0]=m/r,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=m,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[11]=-1,a[12]=0,a[13]=0,a[15]=0,u!=null&&u!==1/0?(a[10]=u*(h=1/(c-u)),a[14]=u*c*h):(a[10]=-1,a[14]=-c),a},Qn.perspectiveFromFieldOfView=function(a,t,r,c){var u=Math.tan(t.upDegrees*Math.PI/180),h=Math.tan(t.downDegrees*Math.PI/180),m=Math.tan(t.leftDegrees*Math.PI/180),g=Math.tan(t.rightDegrees*Math.PI/180),v=2/(m+g),b=2/(u+h);return a[0]=v,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=b,a[6]=0,a[7]=0,a[8]=-(m-g)*v*.5,a[9]=(u-h)*b*.5,a[10]=c/(r-c),a[11]=-1,a[12]=0,a[13]=0,a[14]=c*r/(r-c),a[15]=0,a},Qn.orthoNO=$O,Qn.orthoZO=function(a,t,r,c,u,h,m){var g=1/(t-r),v=1/(c-u),b=1/(h-m);return a[0]=-2*g,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=-2*v,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=b,a[11]=0,a[12]=(t+r)*g,a[13]=(u+c)*v,a[14]=h*b,a[15]=1,a},Qn.lookAt=function(a,t,r,c){var u,h,m,g,v,b,w,A,C,P,k=t[0],z=t[1],U=t[2],W=c[0],$=c[1],Z=c[2],K=r[0],q=r[1],J=r[2];return Math.abs(k-K)<Ya.EPSILON&&Math.abs(z-q)<Ya.EPSILON&&Math.abs(U-J)<Ya.EPSILON?WO(a):(w=k-K,A=z-q,C=U-J,u=$*(C*=P=1/Math.hypot(w,A,C))-Z*(A*=P),h=Z*(w*=P)-W*C,m=W*A-$*w,(P=Math.hypot(u,h,m))?(u*=P=1/P,h*=P,m*=P):(u=0,h=0,m=0),g=A*m-C*h,v=C*u-w*m,b=w*h-A*u,(P=Math.hypot(g,v,b))?(g*=P=1/P,v*=P,b*=P):(g=0,v=0,b=0),a[0]=u,a[1]=g,a[2]=w,a[3]=0,a[4]=h,a[5]=v,a[6]=A,a[7]=0,a[8]=m,a[9]=b,a[10]=C,a[11]=0,a[12]=-(u*k+h*z+m*U),a[13]=-(g*k+v*z+b*U),a[14]=-(w*k+A*z+C*U),a[15]=1,a)},Qn.targetTo=function(a,t,r,c){var u=t[0],h=t[1],m=t[2],g=c[0],v=c[1],b=c[2],w=u-r[0],A=h-r[1],C=m-r[2],P=w*w+A*A+C*C;P>0&&(w*=P=1/Math.sqrt(P),A*=P,C*=P);var k=v*C-b*A,z=b*w-g*C,U=g*A-v*w;return(P=k*k+z*z+U*U)>0&&(k*=P=1/Math.sqrt(P),z*=P,U*=P),a[0]=k,a[1]=z,a[2]=U,a[3]=0,a[4]=A*U-C*z,a[5]=C*k-w*U,a[6]=w*z-A*k,a[7]=0,a[8]=w,a[9]=A,a[10]=C,a[11]=0,a[12]=u,a[13]=h,a[14]=m,a[15]=1,a},Qn.str=function(a){return"mat4("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+", "+a[9]+", "+a[10]+", "+a[11]+", "+a[12]+", "+a[13]+", "+a[14]+", "+a[15]+")"},Qn.frob=function(a){return Math.hypot(a[0],a[1],a[2],a[3],a[4],a[5],a[6],a[7],a[8],a[9],a[10],a[11],a[12],a[13],a[14],a[15])},Qn.add=function(a,t,r){return a[0]=t[0]+r[0],a[1]=t[1]+r[1],a[2]=t[2]+r[2],a[3]=t[3]+r[3],a[4]=t[4]+r[4],a[5]=t[5]+r[5],a[6]=t[6]+r[6],a[7]=t[7]+r[7],a[8]=t[8]+r[8],a[9]=t[9]+r[9],a[10]=t[10]+r[10],a[11]=t[11]+r[11],a[12]=t[12]+r[12],a[13]=t[13]+r[13],a[14]=t[14]+r[14],a[15]=t[15]+r[15],a},Qn.subtract=YO,Qn.multiplyScalar=function(a,t,r){return a[0]=t[0]*r,a[1]=t[1]*r,a[2]=t[2]*r,a[3]=t[3]*r,a[4]=t[4]*r,a[5]=t[5]*r,a[6]=t[6]*r,a[7]=t[7]*r,a[8]=t[8]*r,a[9]=t[9]*r,a[10]=t[10]*r,a[11]=t[11]*r,a[12]=t[12]*r,a[13]=t[13]*r,a[14]=t[14]*r,a[15]=t[15]*r,a},Qn.multiplyScalarAndAdd=function(a,t,r,c){return a[0]=t[0]+r[0]*c,a[1]=t[1]+r[1]*c,a[2]=t[2]+r[2]*c,a[3]=t[3]+r[3]*c,a[4]=t[4]+r[4]*c,a[5]=t[5]+r[5]*c,a[6]=t[6]+r[6]*c,a[7]=t[7]+r[7]*c,a[8]=t[8]+r[8]*c,a[9]=t[9]+r[9]*c,a[10]=t[10]+r[10]*c,a[11]=t[11]+r[11]*c,a[12]=t[12]+r[12]*c,a[13]=t[13]+r[13]*c,a[14]=t[14]+r[14]*c,a[15]=t[15]+r[15]*c,a},Qn.exactEquals=function(a,t){return a[0]===t[0]&&a[1]===t[1]&&a[2]===t[2]&&a[3]===t[3]&&a[4]===t[4]&&a[5]===t[5]&&a[6]===t[6]&&a[7]===t[7]&&a[8]===t[8]&&a[9]===t[9]&&a[10]===t[10]&&a[11]===t[11]&&a[12]===t[12]&&a[13]===t[13]&&a[14]===t[14]&&a[15]===t[15]},Qn.equals=function(a,t){var r=a[0],c=a[1],u=a[2],h=a[3],m=a[4],g=a[5],v=a[6],b=a[7],w=a[8],A=a[9],C=a[10],P=a[11],k=a[12],z=a[13],U=a[14],W=a[15],$=t[0],Z=t[1],K=t[2],q=t[3],J=t[4],re=t[5],ce=t[6],ge=t[7],ve=t[8],Ce=t[9],Ae=t[10],Le=t[11],Se=t[12],Ve=t[13],Xe=t[14],nt=t[15];return Math.abs(r-$)<=Ya.EPSILON*Math.max(1,Math.abs(r),Math.abs($))&&Math.abs(c-Z)<=Ya.EPSILON*Math.max(1,Math.abs(c),Math.abs(Z))&&Math.abs(u-K)<=Ya.EPSILON*Math.max(1,Math.abs(u),Math.abs(K))&&Math.abs(h-q)<=Ya.EPSILON*Math.max(1,Math.abs(h),Math.abs(q))&&Math.abs(m-J)<=Ya.EPSILON*Math.max(1,Math.abs(m),Math.abs(J))&&Math.abs(g-re)<=Ya.EPSILON*Math.max(1,Math.abs(g),Math.abs(re))&&Math.abs(v-ce)<=Ya.EPSILON*Math.max(1,Math.abs(v),Math.abs(ce))&&Math.abs(b-ge)<=Ya.EPSILON*Math.max(1,Math.abs(b),Math.abs(ge))&&Math.abs(w-ve)<=Ya.EPSILON*Math.max(1,Math.abs(w),Math.abs(ve))&&Math.abs(A-Ce)<=Ya.EPSILON*Math.max(1,Math.abs(A),Math.abs(Ce))&&Math.abs(C-Ae)<=Ya.EPSILON*Math.max(1,Math.abs(C),Math.abs(Ae))&&Math.abs(P-Le)<=Ya.EPSILON*Math.max(1,Math.abs(P),Math.abs(Le))&&Math.abs(k-Se)<=Ya.EPSILON*Math.max(1,Math.abs(k),Math.abs(Se))&&Math.abs(z-Ve)<=Ya.EPSILON*Math.max(1,Math.abs(z),Math.abs(Ve))&&Math.abs(U-Xe)<=Ya.EPSILON*Math.max(1,Math.abs(U),Math.abs(Xe))&&Math.abs(W-nt)<=Ya.EPSILON*Math.max(1,Math.abs(W),Math.abs(nt))},Qn.sub=Qn.mul=Qn.ortho=Qn.perspective=void 0;var Ya=function(a,t){if(a&&a.__esModule)return a;if(a===null||FC(a)!=="object"&&typeof a!="function")return{default:a};var r=UO(void 0);if(r&&r.has(a))return r.get(a);var c={},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var h in a)if(h!=="default"&&Object.prototype.hasOwnProperty.call(a,h)){var m=u?Object.getOwnPropertyDescriptor(a,h):null;m&&(m.get||m.set)?Object.defineProperty(c,h,m):c[h]=a[h]}return c.default=a,r&&r.set(a,c),c}(no);function UO(a){if(typeof WeakMap!="function")return null;var t=new WeakMap,r=new WeakMap;return(UO=function(c){return c?r:t})(a)}function WO(a){return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a}function VO(a,t,r){var c=t[0],u=t[1],h=t[2],m=t[3],g=t[4],v=t[5],b=t[6],w=t[7],A=t[8],C=t[9],P=t[10],k=t[11],z=t[12],U=t[13],W=t[14],$=t[15],Z=r[0],K=r[1],q=r[2],J=r[3];return a[0]=Z*c+K*g+q*A+J*z,a[1]=Z*u+K*v+q*C+J*U,a[2]=Z*h+K*b+q*P+J*W,a[3]=Z*m+K*w+q*k+J*$,a[4]=(Z=r[4])*c+(K=r[5])*g+(q=r[6])*A+(J=r[7])*z,a[5]=Z*u+K*v+q*C+J*U,a[6]=Z*h+K*b+q*P+J*W,a[7]=Z*m+K*w+q*k+J*$,a[8]=(Z=r[8])*c+(K=r[9])*g+(q=r[10])*A+(J=r[11])*z,a[9]=Z*u+K*v+q*C+J*U,a[10]=Z*h+K*b+q*P+J*W,a[11]=Z*m+K*w+q*k+J*$,a[12]=(Z=r[12])*c+(K=r[13])*g+(q=r[14])*A+(J=r[15])*z,a[13]=Z*u+K*v+q*C+J*U,a[14]=Z*h+K*b+q*P+J*W,a[15]=Z*m+K*w+q*k+J*$,a}function GO(a,t,r){var c=t[0],u=t[1],h=t[2],m=t[3],g=c+c,v=u+u,b=h+h,w=c*g,A=c*v,C=c*b,P=u*v,k=u*b,z=h*b,U=m*g,W=m*v,$=m*b;return a[0]=1-(P+z),a[1]=A+$,a[2]=C-W,a[3]=0,a[4]=A-$,a[5]=1-(w+z),a[6]=k+U,a[7]=0,a[8]=C+W,a[9]=k-U,a[10]=1-(w+P),a[11]=0,a[12]=r[0],a[13]=r[1],a[14]=r[2],a[15]=1,a}function HO(a,t){var r=t[4],c=t[5],u=t[6],h=t[8],m=t[9],g=t[10];return a[0]=Math.hypot(t[0],t[1],t[2]),a[1]=Math.hypot(r,c,u),a[2]=Math.hypot(h,m,g),a}function jO(a,t,r,c,u){var h,m=1/Math.tan(t/2);return a[0]=m/r,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=m,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[11]=-1,a[12]=0,a[13]=0,a[15]=0,u!=null&&u!==1/0?(a[10]=(u+c)*(h=1/(c-u)),a[14]=2*u*c*h):(a[10]=-1,a[14]=-2*c),a}function $O(a,t,r,c,u,h,m){var g=1/(t-r),v=1/(c-u),b=1/(h-m);return a[0]=-2*g,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=-2*v,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=2*b,a[11]=0,a[12]=(t+r)*g,a[13]=(u+c)*v,a[14]=(m+h)*b,a[15]=1,a}function YO(a,t,r){return a[0]=t[0]-r[0],a[1]=t[1]-r[1],a[2]=t[2]-r[2],a[3]=t[3]-r[3],a[4]=t[4]-r[4],a[5]=t[5]-r[5],a[6]=t[6]-r[6],a[7]=t[7]-r[7],a[8]=t[8]-r[8],a[9]=t[9]-r[9],a[10]=t[10]-r[10],a[11]=t[11]-r[11],a[12]=t[12]-r[12],a[13]=t[13]-r[13],a[14]=t[14]-r[14],a[15]=t[15]-r[15],a}Qn.perspective=jO,Qn.ortho=$O,Qn.mul=VO,Qn.sub=YO;var jn={},Kn={};function BC(a){return BC=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},BC(a)}Object.defineProperty(Kn,"__esModule",{value:!0}),Kn.create=XO,Kn.clone=function(a){var t=new eh.ARRAY_TYPE(3);return t[0]=a[0],t[1]=a[1],t[2]=a[2],t},Kn.length=ZO,Kn.fromValues=function(a,t,r){var c=new eh.ARRAY_TYPE(3);return c[0]=a,c[1]=t,c[2]=r,c},Kn.copy=function(a,t){return a[0]=t[0],a[1]=t[1],a[2]=t[2],a},Kn.set=function(a,t,r,c){return a[0]=t,a[1]=r,a[2]=c,a},Kn.add=function(a,t,r){return a[0]=t[0]+r[0],a[1]=t[1]+r[1],a[2]=t[2]+r[2],a},Kn.subtract=KO,Kn.multiply=JO,Kn.divide=QO,Kn.ceil=function(a,t){return a[0]=Math.ceil(t[0]),a[1]=Math.ceil(t[1]),a[2]=Math.ceil(t[2]),a},Kn.floor=function(a,t){return a[0]=Math.floor(t[0]),a[1]=Math.floor(t[1]),a[2]=Math.floor(t[2]),a},Kn.min=function(a,t,r){return a[0]=Math.min(t[0],r[0]),a[1]=Math.min(t[1],r[1]),a[2]=Math.min(t[2],r[2]),a},Kn.max=function(a,t,r){return a[0]=Math.max(t[0],r[0]),a[1]=Math.max(t[1],r[1]),a[2]=Math.max(t[2],r[2]),a},Kn.round=function(a,t){return a[0]=Math.round(t[0]),a[1]=Math.round(t[1]),a[2]=Math.round(t[2]),a},Kn.scale=function(a,t,r){return a[0]=t[0]*r,a[1]=t[1]*r,a[2]=t[2]*r,a},Kn.scaleAndAdd=function(a,t,r,c){return a[0]=t[0]+r[0]*c,a[1]=t[1]+r[1]*c,a[2]=t[2]+r[2]*c,a},Kn.distance=eN,Kn.squaredDistance=tN,Kn.squaredLength=nN,Kn.negate=function(a,t){return a[0]=-t[0],a[1]=-t[1],a[2]=-t[2],a},Kn.inverse=function(a,t){return a[0]=1/t[0],a[1]=1/t[1],a[2]=1/t[2],a},Kn.normalize=function(a,t){var r=t[0],c=t[1],u=t[2],h=r*r+c*c+u*u;return h>0&&(h=1/Math.sqrt(h)),a[0]=t[0]*h,a[1]=t[1]*h,a[2]=t[2]*h,a},Kn.dot=iN,Kn.cross=function(a,t,r){var c=t[0],u=t[1],h=t[2],m=r[0],g=r[1],v=r[2];return a[0]=u*v-h*g,a[1]=h*m-c*v,a[2]=c*g-u*m,a},Kn.lerp=function(a,t,r,c){var u=t[0],h=t[1],m=t[2];return a[0]=u+c*(r[0]-u),a[1]=h+c*(r[1]-h),a[2]=m+c*(r[2]-m),a},Kn.hermite=function(a,t,r,c,u,h){var m=h*h,g=m*(2*h-3)+1,v=m*(h-2)+h,b=m*(h-1),w=m*(3-2*h);return a[0]=t[0]*g+r[0]*v+c[0]*b+u[0]*w,a[1]=t[1]*g+r[1]*v+c[1]*b+u[1]*w,a[2]=t[2]*g+r[2]*v+c[2]*b+u[2]*w,a},Kn.bezier=function(a,t,r,c,u,h){var m=1-h,g=m*m,v=h*h,b=g*m,w=3*h*g,A=3*v*m,C=v*h;return a[0]=t[0]*b+r[0]*w+c[0]*A+u[0]*C,a[1]=t[1]*b+r[1]*w+c[1]*A+u[1]*C,a[2]=t[2]*b+r[2]*w+c[2]*A+u[2]*C,a},Kn.random=function(a,t){t=t||1;var r=2*eh.RANDOM()*Math.PI,c=2*eh.RANDOM()-1,u=Math.sqrt(1-c*c)*t;return a[0]=Math.cos(r)*u,a[1]=Math.sin(r)*u,a[2]=c*t,a},Kn.transformMat4=function(a,t,r){var c=t[0],u=t[1],h=t[2],m=r[3]*c+r[7]*u+r[11]*h+r[15];return a[0]=(r[0]*c+r[4]*u+r[8]*h+r[12])/(m=m||1),a[1]=(r[1]*c+r[5]*u+r[9]*h+r[13])/m,a[2]=(r[2]*c+r[6]*u+r[10]*h+r[14])/m,a},Kn.transformMat3=function(a,t,r){var c=t[0],u=t[1],h=t[2];return a[0]=c*r[0]+u*r[3]+h*r[6],a[1]=c*r[1]+u*r[4]+h*r[7],a[2]=c*r[2]+u*r[5]+h*r[8],a},Kn.transformQuat=function(a,t,r){var c=r[0],u=r[1],h=r[2],m=t[0],g=t[1],v=t[2],b=u*v-h*g,w=h*m-c*v,A=c*g-u*m,C=u*A-h*w,P=h*b-c*A,k=c*w-u*b,z=2*r[3];return w*=z,A*=z,P*=2,k*=2,a[0]=m+(b*=z)+(C*=2),a[1]=g+w+P,a[2]=v+A+k,a},Kn.rotateX=function(a,t,r,c){var u=[],h=[];return u[0]=t[0]-r[0],u[1]=t[1]-r[1],u[2]=t[2]-r[2],h[0]=u[0],h[1]=u[1]*Math.cos(c)-u[2]*Math.sin(c),h[2]=u[1]*Math.sin(c)+u[2]*Math.cos(c),a[0]=h[0]+r[0],a[1]=h[1]+r[1],a[2]=h[2]+r[2],a},Kn.rotateY=function(a,t,r,c){var u=[],h=[];return u[0]=t[0]-r[0],u[1]=t[1]-r[1],u[2]=t[2]-r[2],h[0]=u[2]*Math.sin(c)+u[0]*Math.cos(c),h[1]=u[1],h[2]=u[2]*Math.cos(c)-u[0]*Math.sin(c),a[0]=h[0]+r[0],a[1]=h[1]+r[1],a[2]=h[2]+r[2],a},Kn.rotateZ=function(a,t,r,c){var u=[],h=[];return u[0]=t[0]-r[0],u[1]=t[1]-r[1],u[2]=t[2]-r[2],h[0]=u[0]*Math.cos(c)-u[1]*Math.sin(c),h[1]=u[0]*Math.sin(c)+u[1]*Math.cos(c),h[2]=u[2],a[0]=h[0]+r[0],a[1]=h[1]+r[1],a[2]=h[2]+r[2],a},Kn.angle=function(a,t){var r=a[0],c=a[1],u=a[2],h=t[0],m=t[1],g=t[2],v=Math.sqrt(r*r+c*c+u*u)*Math.sqrt(h*h+m*m+g*g),b=v&&iN(a,t)/v;return Math.acos(Math.min(Math.max(b,-1),1))},Kn.zero=function(a){return a[0]=0,a[1]=0,a[2]=0,a},Kn.str=function(a){return"vec3("+a[0]+", "+a[1]+", "+a[2]+")"},Kn.exactEquals=function(a,t){return a[0]===t[0]&&a[1]===t[1]&&a[2]===t[2]},Kn.equals=function(a,t){var r=a[0],c=a[1],u=a[2],h=t[0],m=t[1],g=t[2];return Math.abs(r-h)<=eh.EPSILON*Math.max(1,Math.abs(r),Math.abs(h))&&Math.abs(c-m)<=eh.EPSILON*Math.max(1,Math.abs(c),Math.abs(m))&&Math.abs(u-g)<=eh.EPSILON*Math.max(1,Math.abs(u),Math.abs(g))},Kn.forEach=Kn.sqrLen=Kn.len=Kn.sqrDist=Kn.dist=Kn.div=Kn.mul=Kn.sub=void 0;var eh=function(a,t){if(a&&a.__esModule)return a;if(a===null||BC(a)!=="object"&&typeof a!="function")return{default:a};var r=qO(void 0);if(r&&r.has(a))return r.get(a);var c={},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var h in a)if(h!=="default"&&Object.prototype.hasOwnProperty.call(a,h)){var m=u?Object.getOwnPropertyDescriptor(a,h):null;m&&(m.get||m.set)?Object.defineProperty(c,h,m):c[h]=a[h]}return c.default=a,r&&r.set(a,c),c}(no);function qO(a){if(typeof WeakMap!="function")return null;var t=new WeakMap,r=new WeakMap;return(qO=function(c){return c?r:t})(a)}function XO(){var a=new eh.ARRAY_TYPE(3);return eh.ARRAY_TYPE!=Float32Array&&(a[0]=0,a[1]=0,a[2]=0),a}function ZO(a){return Math.hypot(a[0],a[1],a[2])}function KO(a,t,r){return a[0]=t[0]-r[0],a[1]=t[1]-r[1],a[2]=t[2]-r[2],a}function JO(a,t,r){return a[0]=t[0]*r[0],a[1]=t[1]*r[1],a[2]=t[2]*r[2],a}function QO(a,t,r){return a[0]=t[0]/r[0],a[1]=t[1]/r[1],a[2]=t[2]/r[2],a}function eN(a,t){return Math.hypot(t[0]-a[0],t[1]-a[1],t[2]-a[2])}function tN(a,t){var r=t[0]-a[0],c=t[1]-a[1],u=t[2]-a[2];return r*r+c*c+u*u}function nN(a){var t=a[0],r=a[1],c=a[2];return t*t+r*r+c*c}function iN(a,t){return a[0]*t[0]+a[1]*t[1]+a[2]*t[2]}Kn.sub=KO,Kn.mul=JO,Kn.div=QO,Kn.dist=eN,Kn.sqrDist=tN,Kn.len=ZO,Kn.sqrLen=nN;var th,vQ=(th=XO(),function(a,t,r,c,u,h){var m,g;for(t||(t=3),r||(r=0),g=c?Math.min(c*t+r,a.length):a.length,m=r;m<g;m+=t)th[0]=a[m],th[1]=a[m+1],th[2]=a[m+2],u(th,th,h),a[m]=th[0],a[m+1]=th[1],a[m+2]=th[2];return a});Kn.forEach=vQ;var fi={};function UC(a){return UC=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},UC(a)}Object.defineProperty(fi,"__esModule",{value:!0}),fi.create=rN,fi.clone=function(a){var t=new pc.ARRAY_TYPE(4);return t[0]=a[0],t[1]=a[1],t[2]=a[2],t[3]=a[3],t},fi.fromValues=function(a,t,r,c){var u=new pc.ARRAY_TYPE(4);return u[0]=a,u[1]=t,u[2]=r,u[3]=c,u},fi.copy=function(a,t){return a[0]=t[0],a[1]=t[1],a[2]=t[2],a[3]=t[3],a},fi.set=function(a,t,r,c,u){return a[0]=t,a[1]=r,a[2]=c,a[3]=u,a},fi.add=function(a,t,r){return a[0]=t[0]+r[0],a[1]=t[1]+r[1],a[2]=t[2]+r[2],a[3]=t[3]+r[3],a},fi.subtract=oN,fi.multiply=sN,fi.divide=lN,fi.ceil=function(a,t){return a[0]=Math.ceil(t[0]),a[1]=Math.ceil(t[1]),a[2]=Math.ceil(t[2]),a[3]=Math.ceil(t[3]),a},fi.floor=function(a,t){return a[0]=Math.floor(t[0]),a[1]=Math.floor(t[1]),a[2]=Math.floor(t[2]),a[3]=Math.floor(t[3]),a},fi.min=function(a,t,r){return a[0]=Math.min(t[0],r[0]),a[1]=Math.min(t[1],r[1]),a[2]=Math.min(t[2],r[2]),a[3]=Math.min(t[3],r[3]),a},fi.max=function(a,t,r){return a[0]=Math.max(t[0],r[0]),a[1]=Math.max(t[1],r[1]),a[2]=Math.max(t[2],r[2]),a[3]=Math.max(t[3],r[3]),a},fi.round=function(a,t){return a[0]=Math.round(t[0]),a[1]=Math.round(t[1]),a[2]=Math.round(t[2]),a[3]=Math.round(t[3]),a},fi.scale=function(a,t,r){return a[0]=t[0]*r,a[1]=t[1]*r,a[2]=t[2]*r,a[3]=t[3]*r,a},fi.scaleAndAdd=function(a,t,r,c){return a[0]=t[0]+r[0]*c,a[1]=t[1]+r[1]*c,a[2]=t[2]+r[2]*c,a[3]=t[3]+r[3]*c,a},fi.distance=cN,fi.squaredDistance=uN,fi.length=dN,fi.squaredLength=hN,fi.negate=function(a,t){return a[0]=-t[0],a[1]=-t[1],a[2]=-t[2],a[3]=-t[3],a},fi.inverse=function(a,t){return a[0]=1/t[0],a[1]=1/t[1],a[2]=1/t[2],a[3]=1/t[3],a},fi.normalize=function(a,t){var r=t[0],c=t[1],u=t[2],h=t[3],m=r*r+c*c+u*u+h*h;return m>0&&(m=1/Math.sqrt(m)),a[0]=r*m,a[1]=c*m,a[2]=u*m,a[3]=h*m,a},fi.dot=function(a,t){return a[0]*t[0]+a[1]*t[1]+a[2]*t[2]+a[3]*t[3]},fi.cross=function(a,t,r,c){var u=r[0]*c[1]-r[1]*c[0],h=r[0]*c[2]-r[2]*c[0],m=r[0]*c[3]-r[3]*c[0],g=r[1]*c[2]-r[2]*c[1],v=r[1]*c[3]-r[3]*c[1],b=r[2]*c[3]-r[3]*c[2],w=t[0],A=t[1],C=t[2],P=t[3];return a[0]=A*b-C*v+P*g,a[1]=-w*b+C*m-P*h,a[2]=w*v-A*m+P*u,a[3]=-w*g+A*h-C*u,a},fi.lerp=function(a,t,r,c){var u=t[0],h=t[1],m=t[2],g=t[3];return a[0]=u+c*(r[0]-u),a[1]=h+c*(r[1]-h),a[2]=m+c*(r[2]-m),a[3]=g+c*(r[3]-g),a},fi.random=function(a,t){var r,c,u,h,m,g;t=t||1;do m=(r=2*pc.RANDOM()-1)*r+(c=2*pc.RANDOM()-1)*c;while(m>=1);do g=(u=2*pc.RANDOM()-1)*u+(h=2*pc.RANDOM()-1)*h;while(g>=1);var v=Math.sqrt((1-m)/g);return a[0]=t*r,a[1]=t*c,a[2]=t*u*v,a[3]=t*h*v,a},fi.transformMat4=function(a,t,r){var c=t[0],u=t[1],h=t[2],m=t[3];return a[0]=r[0]*c+r[4]*u+r[8]*h+r[12]*m,a[1]=r[1]*c+r[5]*u+r[9]*h+r[13]*m,a[2]=r[2]*c+r[6]*u+r[10]*h+r[14]*m,a[3]=r[3]*c+r[7]*u+r[11]*h+r[15]*m,a},fi.transformQuat=function(a,t,r){var c=t[0],u=t[1],h=t[2],m=r[0],g=r[1],v=r[2],b=r[3],w=b*c+g*h-v*u,A=b*u+v*c-m*h,C=b*h+m*u-g*c,P=-m*c-g*u-v*h;return a[0]=w*b+P*-m+A*-v-C*-g,a[1]=A*b+P*-g+C*-m-w*-v,a[2]=C*b+P*-v+w*-g-A*-m,a[3]=t[3],a},fi.zero=function(a){return a[0]=0,a[1]=0,a[2]=0,a[3]=0,a},fi.str=function(a){return"vec4("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+")"},fi.exactEquals=function(a,t){return a[0]===t[0]&&a[1]===t[1]&&a[2]===t[2]&&a[3]===t[3]},fi.equals=function(a,t){var r=a[0],c=a[1],u=a[2],h=a[3],m=t[0],g=t[1],v=t[2],b=t[3];return Math.abs(r-m)<=pc.EPSILON*Math.max(1,Math.abs(r),Math.abs(m))&&Math.abs(c-g)<=pc.EPSILON*Math.max(1,Math.abs(c),Math.abs(g))&&Math.abs(u-v)<=pc.EPSILON*Math.max(1,Math.abs(u),Math.abs(v))&&Math.abs(h-b)<=pc.EPSILON*Math.max(1,Math.abs(h),Math.abs(b))},fi.forEach=fi.sqrLen=fi.len=fi.sqrDist=fi.dist=fi.div=fi.mul=fi.sub=void 0;var pc=function(a,t){if(a&&a.__esModule)return a;if(a===null||UC(a)!=="object"&&typeof a!="function")return{default:a};var r=aN(void 0);if(r&&r.has(a))return r.get(a);var c={},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var h in a)if(h!=="default"&&Object.prototype.hasOwnProperty.call(a,h)){var m=u?Object.getOwnPropertyDescriptor(a,h):null;m&&(m.get||m.set)?Object.defineProperty(c,h,m):c[h]=a[h]}return c.default=a,r&&r.set(a,c),c}(no);function aN(a){if(typeof WeakMap!="function")return null;var t=new WeakMap,r=new WeakMap;return(aN=function(c){return c?r:t})(a)}function rN(){var a=new pc.ARRAY_TYPE(4);return pc.ARRAY_TYPE!=Float32Array&&(a[0]=0,a[1]=0,a[2]=0,a[3]=0),a}function oN(a,t,r){return a[0]=t[0]-r[0],a[1]=t[1]-r[1],a[2]=t[2]-r[2],a[3]=t[3]-r[3],a}function sN(a,t,r){return a[0]=t[0]*r[0],a[1]=t[1]*r[1],a[2]=t[2]*r[2],a[3]=t[3]*r[3],a}function lN(a,t,r){return a[0]=t[0]/r[0],a[1]=t[1]/r[1],a[2]=t[2]/r[2],a[3]=t[3]/r[3],a}function cN(a,t){return Math.hypot(t[0]-a[0],t[1]-a[1],t[2]-a[2],t[3]-a[3])}function uN(a,t){var r=t[0]-a[0],c=t[1]-a[1],u=t[2]-a[2],h=t[3]-a[3];return r*r+c*c+u*u+h*h}function dN(a){return Math.hypot(a[0],a[1],a[2],a[3])}function hN(a){var t=a[0],r=a[1],c=a[2],u=a[3];return t*t+r*r+c*c+u*u}fi.sub=oN,fi.mul=sN,fi.div=lN,fi.dist=cN,fi.sqrDist=uN,fi.len=dN,fi.sqrLen=hN;var _Q=function(){var a=rN();return function(t,r,c,u,h,m){var g,v;for(r||(r=4),c||(c=0),v=u?Math.min(u*r+c,t.length):t.length,g=c;g<v;g+=r)a[0]=t[g],a[1]=t[g+1],a[2]=t[g+2],a[3]=t[g+3],h(a,a,m),t[g]=a[0],t[g+1]=a[1],t[g+2]=a[2],t[g+3]=a[3];return t}}();function WC(a){return WC=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},WC(a)}fi.forEach=_Q,Object.defineProperty(jn,"__esModule",{value:!0}),jn.create=VC,jn.identity=function(a){return a[0]=0,a[1]=0,a[2]=0,a[3]=1,a},jn.setAxisAngle=fN,jn.getAxisAngle=function(a,t){var r=2*Math.acos(t[3]),c=Math.sin(r/2);return c>xm.EPSILON?(a[0]=t[0]/c,a[1]=t[1]/c,a[2]=t[2]/c):(a[0]=1,a[1]=0,a[2]=0),r},jn.getAngle=function(a,t){var r=bN(a,t);return Math.acos(2*r*r-1)},jn.multiply=mN,jn.rotateX=function(a,t,r){r*=.5;var c=t[0],u=t[1],h=t[2],m=t[3],g=Math.sin(r),v=Math.cos(r);return a[0]=c*v+m*g,a[1]=u*v+h*g,a[2]=h*v-u*g,a[3]=m*v-c*g,a},jn.rotateY=function(a,t,r){r*=.5;var c=t[0],u=t[1],h=t[2],m=t[3],g=Math.sin(r),v=Math.cos(r);return a[0]=c*v-h*g,a[1]=u*v+m*g,a[2]=h*v+c*g,a[3]=m*v-u*g,a},jn.rotateZ=function(a,t,r){r*=.5;var c=t[0],u=t[1],h=t[2],m=t[3],g=Math.sin(r),v=Math.cos(r);return a[0]=c*v+u*g,a[1]=u*v-c*g,a[2]=h*v+m*g,a[3]=m*v-h*g,a},jn.calculateW=function(a,t){var r=t[0],c=t[1],u=t[2];return a[0]=r,a[1]=c,a[2]=u,a[3]=Math.sqrt(Math.abs(1-r*r-c*c-u*u)),a},jn.exp=gN,jn.ln=yN,jn.pow=function(a,t,r){return yN(a,t),_N(a,a,r),gN(a,a),a},jn.slerp=I2,jn.random=function(a){var t=xm.RANDOM(),r=xm.RANDOM(),c=xm.RANDOM(),u=Math.sqrt(1-t),h=Math.sqrt(t);return a[0]=u*Math.sin(2*Math.PI*r),a[1]=u*Math.cos(2*Math.PI*r),a[2]=h*Math.sin(2*Math.PI*c),a[3]=h*Math.cos(2*Math.PI*c),a},jn.invert=function(a,t){var r=t[0],c=t[1],u=t[2],h=t[3],m=r*r+c*c+u*u+h*h,g=m?1/m:0;return a[0]=-r*g,a[1]=-c*g,a[2]=-u*g,a[3]=h*g,a},jn.conjugate=function(a,t){return a[0]=-t[0],a[1]=-t[1],a[2]=-t[2],a[3]=t[3],a},jn.fromMat3=vN,jn.fromEuler=function(a,t,r,c){var u=.5*Math.PI/180;t*=u,r*=u,c*=u;var h=Math.sin(t),m=Math.cos(t),g=Math.sin(r),v=Math.cos(r),b=Math.sin(c),w=Math.cos(c);return a[0]=h*v*w-m*g*b,a[1]=m*g*w+h*v*b,a[2]=m*v*b-h*g*w,a[3]=m*v*w+h*g*b,a},jn.str=function(a){return"quat("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+")"},jn.setAxes=jn.sqlerp=jn.rotationTo=jn.equals=jn.exactEquals=jn.normalize=jn.sqrLen=jn.squaredLength=jn.len=jn.length=jn.lerp=jn.dot=jn.scale=jn.mul=jn.add=jn.set=jn.copy=jn.fromValues=jn.clone=void 0;var xm=P2(no),bQ=P2(Yi),nh=P2(Kn),zl=P2(fi);function pN(a){if(typeof WeakMap!="function")return null;var t=new WeakMap,r=new WeakMap;return(pN=function(c){return c?r:t})(a)}function P2(a,t){if(!t&&a&&a.__esModule)return a;if(a===null||WC(a)!=="object"&&typeof a!="function")return{default:a};var r=pN(t);if(r&&r.has(a))return r.get(a);var c={},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var h in a)if(h!=="default"&&Object.prototype.hasOwnProperty.call(a,h)){var m=u?Object.getOwnPropertyDescriptor(a,h):null;m&&(m.get||m.set)?Object.defineProperty(c,h,m):c[h]=a[h]}return c.default=a,r&&r.set(a,c),c}function VC(){var a=new xm.ARRAY_TYPE(4);return xm.ARRAY_TYPE!=Float32Array&&(a[0]=0,a[1]=0,a[2]=0),a[3]=1,a}function fN(a,t,r){r*=.5;var c=Math.sin(r);return a[0]=c*t[0],a[1]=c*t[1],a[2]=c*t[2],a[3]=Math.cos(r),a}function mN(a,t,r){var c=t[0],u=t[1],h=t[2],m=t[3],g=r[0],v=r[1],b=r[2],w=r[3];return a[0]=c*w+m*g+u*b-h*v,a[1]=u*w+m*v+h*g-c*b,a[2]=h*w+m*b+c*v-u*g,a[3]=m*w-c*g-u*v-h*b,a}function gN(a,t){var r=t[0],c=t[1],u=t[2],h=t[3],m=Math.sqrt(r*r+c*c+u*u),g=Math.exp(h),v=m>0?g*Math.sin(m)/m:0;return a[0]=r*v,a[1]=c*v,a[2]=u*v,a[3]=g*Math.cos(m),a}function yN(a,t){var r=t[0],c=t[1],u=t[2],h=t[3],m=Math.sqrt(r*r+c*c+u*u),g=m>0?Math.atan2(m,h)/m:0;return a[0]=r*g,a[1]=c*g,a[2]=u*g,a[3]=.5*Math.log(r*r+c*c+u*u+h*h),a}function I2(a,t,r,c){var u,h,m,g,v,b=t[0],w=t[1],A=t[2],C=t[3],P=r[0],k=r[1],z=r[2],U=r[3];return(h=b*P+w*k+A*z+C*U)<0&&(h=-h,P=-P,k=-k,z=-z,U=-U),1-h>xm.EPSILON?(u=Math.acos(h),m=Math.sin(u),g=Math.sin((1-c)*u)/m,v=Math.sin(c*u)/m):(g=1-c,v=c),a[0]=g*b+v*P,a[1]=g*w+v*k,a[2]=g*A+v*z,a[3]=g*C+v*U,a}function vN(a,t){var r,c=t[0]+t[4]+t[8];if(c>0)r=Math.sqrt(c+1),a[3]=.5*r,a[0]=(t[5]-t[7])*(r=.5/r),a[1]=(t[6]-t[2])*r,a[2]=(t[1]-t[3])*r;else{var u=0;t[4]>t[0]&&(u=1),t[8]>t[3*u+u]&&(u=2);var h=(u+1)%3,m=(u+2)%3;r=Math.sqrt(t[3*u+u]-t[3*h+h]-t[3*m+m]+1),a[u]=.5*r,a[3]=(t[3*h+m]-t[3*m+h])*(r=.5/r),a[h]=(t[3*h+u]+t[3*u+h])*r,a[m]=(t[3*m+u]+t[3*u+m])*r}return a}jn.clone=zl.clone,jn.fromValues=zl.fromValues,jn.copy=zl.copy,jn.set=zl.set,jn.add=zl.add,jn.mul=mN;var _N=zl.scale;jn.scale=_N;var bN=zl.dot;jn.dot=bN,jn.lerp=zl.lerp;var xN=zl.length;jn.length=xN,jn.len=xN;var wN=zl.squaredLength;jn.squaredLength=wN,jn.sqrLen=wN;var GC=zl.normalize;jn.normalize=GC,jn.exactEquals=zl.exactEquals,jn.equals=zl.equals;var jc,SN,AN,xQ=(jc=nh.create(),SN=nh.fromValues(1,0,0),AN=nh.fromValues(0,1,0),function(a,t,r){var c=nh.dot(t,r);return c<-.999999?(nh.cross(jc,SN,t),nh.len(jc)<1e-6&&nh.cross(jc,AN,t),nh.normalize(jc,jc),fN(a,jc,Math.PI),a):c>.999999?(a[0]=0,a[1]=0,a[2]=0,a[3]=1,a):(nh.cross(jc,t,r),a[0]=jc[0],a[1]=jc[1],a[2]=jc[2],a[3]=1+c,GC(a,a))});jn.rotationTo=xQ;var HC,jC,wQ=(HC=VC(),jC=VC(),function(a,t,r,c,u,h){return I2(HC,t,u,h),I2(jC,r,c,h),I2(a,HC,jC,2*h*(1-h)),a});jn.sqlerp=wQ;var $c,SQ=($c=bQ.create(),function(a,t,r,c){return $c[0]=r[0],$c[3]=r[1],$c[6]=r[2],$c[1]=c[0],$c[4]=c[1],$c[7]=c[2],$c[2]=-t[0],$c[5]=-t[1],$c[8]=-t[2],GC(a,vN(a,$c))});jn.setAxes=SQ;var bi={};function $C(a){return $C=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$C(a)}Object.defineProperty(bi,"__esModule",{value:!0}),bi.create=function(){var a=new Os.ARRAY_TYPE(8);return Os.ARRAY_TYPE!=Float32Array&&(a[0]=0,a[1]=0,a[2]=0,a[4]=0,a[5]=0,a[6]=0,a[7]=0),a[3]=1,a},bi.clone=function(a){var t=new Os.ARRAY_TYPE(8);return t[0]=a[0],t[1]=a[1],t[2]=a[2],t[3]=a[3],t[4]=a[4],t[5]=a[5],t[6]=a[6],t[7]=a[7],t},bi.fromValues=function(a,t,r,c,u,h,m,g){var v=new Os.ARRAY_TYPE(8);return v[0]=a,v[1]=t,v[2]=r,v[3]=c,v[4]=u,v[5]=h,v[6]=m,v[7]=g,v},bi.fromRotationTranslationValues=function(a,t,r,c,u,h,m){var g=new Os.ARRAY_TYPE(8);g[0]=a,g[1]=t,g[2]=r,g[3]=c;var v=.5*u,b=.5*h,w=.5*m;return g[4]=v*c+b*r-w*t,g[5]=b*c+w*a-v*r,g[6]=w*c+v*t-b*a,g[7]=-v*a-b*t-w*r,g},bi.fromRotationTranslation=TN,bi.fromTranslation=function(a,t){return a[0]=0,a[1]=0,a[2]=0,a[3]=1,a[4]=.5*t[0],a[5]=.5*t[1],a[6]=.5*t[2],a[7]=0,a},bi.fromRotation=function(a,t){return a[0]=t[0],a[1]=t[1],a[2]=t[2],a[3]=t[3],a[4]=0,a[5]=0,a[6]=0,a[7]=0,a},bi.fromMat4=function(a,t){var r=ih.create();EN.getRotation(r,t);var c=new Os.ARRAY_TYPE(3);return EN.getTranslation(c,t),TN(a,r,c),a},bi.copy=CN,bi.identity=function(a){return a[0]=0,a[1]=0,a[2]=0,a[3]=1,a[4]=0,a[5]=0,a[6]=0,a[7]=0,a},bi.set=function(a,t,r,c,u,h,m,g,v){return a[0]=t,a[1]=r,a[2]=c,a[3]=u,a[4]=h,a[5]=m,a[6]=g,a[7]=v,a},bi.getDual=function(a,t){return a[0]=t[4],a[1]=t[5],a[2]=t[6],a[3]=t[7],a},bi.setDual=function(a,t){return a[4]=t[0],a[5]=t[1],a[6]=t[2],a[7]=t[3],a},bi.getTranslation=function(a,t){var r=t[4],c=t[5],u=t[6],h=t[7],m=-t[0],g=-t[1],v=-t[2],b=t[3];return a[0]=2*(r*b+h*m+c*v-u*g),a[1]=2*(c*b+h*g+u*m-r*v),a[2]=2*(u*b+h*v+r*g-c*m),a},bi.translate=function(a,t,r){var c=t[0],u=t[1],h=t[2],m=t[3],g=.5*r[0],v=.5*r[1],b=.5*r[2],w=t[4],A=t[5],C=t[6],P=t[7];return a[0]=c,a[1]=u,a[2]=h,a[3]=m,a[4]=m*g+u*b-h*v+w,a[5]=m*v+h*g-c*b+A,a[6]=m*b+c*v-u*g+C,a[7]=-c*g-u*v-h*b+P,a},bi.rotateX=function(a,t,r){var c=-t[0],u=-t[1],h=-t[2],m=t[3],g=t[4],v=t[5],b=t[6],w=t[7],A=g*m+w*c+v*h-b*u,C=v*m+w*u+b*c-g*h,P=b*m+w*h+g*u-v*c,k=w*m-g*c-v*u-b*h;return ih.rotateX(a,t,r),a[4]=A*(m=a[3])+k*(c=a[0])+C*(h=a[2])-P*(u=a[1]),a[5]=C*m+k*u+P*c-A*h,a[6]=P*m+k*h+A*u-C*c,a[7]=k*m-A*c-C*u-P*h,a},bi.rotateY=function(a,t,r){var c=-t[0],u=-t[1],h=-t[2],m=t[3],g=t[4],v=t[5],b=t[6],w=t[7],A=g*m+w*c+v*h-b*u,C=v*m+w*u+b*c-g*h,P=b*m+w*h+g*u-v*c,k=w*m-g*c-v*u-b*h;return ih.rotateY(a,t,r),a[4]=A*(m=a[3])+k*(c=a[0])+C*(h=a[2])-P*(u=a[1]),a[5]=C*m+k*u+P*c-A*h,a[6]=P*m+k*h+A*u-C*c,a[7]=k*m-A*c-C*u-P*h,a},bi.rotateZ=function(a,t,r){var c=-t[0],u=-t[1],h=-t[2],m=t[3],g=t[4],v=t[5],b=t[6],w=t[7],A=g*m+w*c+v*h-b*u,C=v*m+w*u+b*c-g*h,P=b*m+w*h+g*u-v*c,k=w*m-g*c-v*u-b*h;return ih.rotateZ(a,t,r),a[4]=A*(m=a[3])+k*(c=a[0])+C*(h=a[2])-P*(u=a[1]),a[5]=C*m+k*u+P*c-A*h,a[6]=P*m+k*h+A*u-C*c,a[7]=k*m-A*c-C*u-P*h,a},bi.rotateByQuatAppend=function(a,t,r){var c=r[0],u=r[1],h=r[2],m=r[3],g=t[0],v=t[1],b=t[2],w=t[3];return a[0]=g*m+w*c+v*h-b*u,a[1]=v*m+w*u+b*c-g*h,a[2]=b*m+w*h+g*u-v*c,a[3]=w*m-g*c-v*u-b*h,a[4]=(g=t[4])*m+(w=t[7])*c+(v=t[5])*h-(b=t[6])*u,a[5]=v*m+w*u+b*c-g*h,a[6]=b*m+w*h+g*u-v*c,a[7]=w*m-g*c-v*u-b*h,a},bi.rotateByQuatPrepend=function(a,t,r){var c=t[0],u=t[1],h=t[2],m=t[3],g=r[0],v=r[1],b=r[2],w=r[3];return a[0]=c*w+m*g+u*b-h*v,a[1]=u*w+m*v+h*g-c*b,a[2]=h*w+m*b+c*v-u*g,a[3]=m*w-c*g-u*v-h*b,a[4]=c*(w=r[7])+m*(g=r[4])+u*(b=r[6])-h*(v=r[5]),a[5]=u*w+m*v+h*g-c*b,a[6]=h*w+m*b+c*v-u*g,a[7]=m*w-c*g-u*v-h*b,a},bi.rotateAroundAxis=function(a,t,r,c){if(Math.abs(c)<Os.EPSILON)return CN(a,t);var u=Math.hypot(r[0],r[1],r[2]);c*=.5;var h=Math.sin(c),m=h*r[0]/u,g=h*r[1]/u,v=h*r[2]/u,b=Math.cos(c),w=t[0],A=t[1],C=t[2],P=t[3];a[0]=w*b+P*m+A*v-C*g,a[1]=A*b+P*g+C*m-w*v,a[2]=C*b+P*v+w*g-A*m,a[3]=P*b-w*m-A*g-C*v;var k=t[4],z=t[5],U=t[6],W=t[7];return a[4]=k*b+W*m+z*v-U*g,a[5]=z*b+W*g+U*m-k*v,a[6]=U*b+W*v+k*g-z*m,a[7]=W*b-k*m-z*g-U*v,a},bi.add=function(a,t,r){return a[0]=t[0]+r[0],a[1]=t[1]+r[1],a[2]=t[2]+r[2],a[3]=t[3]+r[3],a[4]=t[4]+r[4],a[5]=t[5]+r[5],a[6]=t[6]+r[6],a[7]=t[7]+r[7],a},bi.multiply=PN,bi.scale=function(a,t,r){return a[0]=t[0]*r,a[1]=t[1]*r,a[2]=t[2]*r,a[3]=t[3]*r,a[4]=t[4]*r,a[5]=t[5]*r,a[6]=t[6]*r,a[7]=t[7]*r,a},bi.lerp=function(a,t,r,c){var u=1-c;return IN(t,r)<0&&(c=-c),a[0]=t[0]*u+r[0]*c,a[1]=t[1]*u+r[1]*c,a[2]=t[2]*u+r[2]*c,a[3]=t[3]*u+r[3]*c,a[4]=t[4]*u+r[4]*c,a[5]=t[5]*u+r[5]*c,a[6]=t[6]*u+r[6]*c,a[7]=t[7]*u+r[7]*c,a},bi.invert=function(a,t){var r=L2(t);return a[0]=-t[0]/r,a[1]=-t[1]/r,a[2]=-t[2]/r,a[3]=t[3]/r,a[4]=-t[4]/r,a[5]=-t[5]/r,a[6]=-t[6]/r,a[7]=t[7]/r,a},bi.conjugate=function(a,t){return a[0]=-t[0],a[1]=-t[1],a[2]=-t[2],a[3]=t[3],a[4]=-t[4],a[5]=-t[5],a[6]=-t[6],a[7]=t[7],a},bi.normalize=function(a,t){var r=L2(t);if(r>0){r=Math.sqrt(r);var c=t[0]/r,u=t[1]/r,h=t[2]/r,m=t[3]/r,g=t[4],v=t[5],b=t[6],w=t[7],A=c*g+u*v+h*b+m*w;a[0]=c,a[1]=u,a[2]=h,a[3]=m,a[4]=(g-c*A)/r,a[5]=(v-u*A)/r,a[6]=(b-h*A)/r,a[7]=(w-m*A)/r}return a},bi.str=function(a){return"quat2("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+")"},bi.exactEquals=function(a,t){return a[0]===t[0]&&a[1]===t[1]&&a[2]===t[2]&&a[3]===t[3]&&a[4]===t[4]&&a[5]===t[5]&&a[6]===t[6]&&a[7]===t[7]},bi.equals=function(a,t){var r=a[0],c=a[1],u=a[2],h=a[3],m=a[4],g=a[5],v=a[6],b=a[7],w=t[0],A=t[1],C=t[2],P=t[3],k=t[4],z=t[5],U=t[6],W=t[7];return Math.abs(r-w)<=Os.EPSILON*Math.max(1,Math.abs(r),Math.abs(w))&&Math.abs(c-A)<=Os.EPSILON*Math.max(1,Math.abs(c),Math.abs(A))&&Math.abs(u-C)<=Os.EPSILON*Math.max(1,Math.abs(u),Math.abs(C))&&Math.abs(h-P)<=Os.EPSILON*Math.max(1,Math.abs(h),Math.abs(P))&&Math.abs(m-k)<=Os.EPSILON*Math.max(1,Math.abs(m),Math.abs(k))&&Math.abs(g-z)<=Os.EPSILON*Math.max(1,Math.abs(g),Math.abs(z))&&Math.abs(v-U)<=Os.EPSILON*Math.max(1,Math.abs(v),Math.abs(U))&&Math.abs(b-W)<=Os.EPSILON*Math.max(1,Math.abs(b),Math.abs(W))},bi.sqrLen=bi.squaredLength=bi.len=bi.length=bi.dot=bi.mul=bi.setReal=bi.getReal=void 0;var Os=YC(no),ih=YC(jn),EN=YC(Qn);function MN(a){if(typeof WeakMap!="function")return null;var t=new WeakMap,r=new WeakMap;return(MN=function(c){return c?r:t})(a)}function YC(a,t){if(!t&&a&&a.__esModule)return a;if(a===null||$C(a)!=="object"&&typeof a!="function")return{default:a};var r=MN(t);if(r&&r.has(a))return r.get(a);var c={},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var h in a)if(h!=="default"&&Object.prototype.hasOwnProperty.call(a,h)){var m=u?Object.getOwnPropertyDescriptor(a,h):null;m&&(m.get||m.set)?Object.defineProperty(c,h,m):c[h]=a[h]}return c.default=a,r&&r.set(a,c),c}function TN(a,t,r){var c=.5*r[0],u=.5*r[1],h=.5*r[2],m=t[0],g=t[1],v=t[2],b=t[3];return a[0]=m,a[1]=g,a[2]=v,a[3]=b,a[4]=c*b+u*v-h*g,a[5]=u*b+h*m-c*v,a[6]=h*b+c*g-u*m,a[7]=-c*m-u*g-h*v,a}function CN(a,t){return a[0]=t[0],a[1]=t[1],a[2]=t[2],a[3]=t[3],a[4]=t[4],a[5]=t[5],a[6]=t[6],a[7]=t[7],a}function PN(a,t,r){var c=t[0],u=t[1],h=t[2],m=t[3],g=r[4],v=r[5],b=r[6],w=r[7],A=t[4],C=t[5],P=t[6],k=t[7],z=r[0],U=r[1],W=r[2],$=r[3];return a[0]=c*$+m*z+u*W-h*U,a[1]=u*$+m*U+h*z-c*W,a[2]=h*$+m*W+c*U-u*z,a[3]=m*$-c*z-u*U-h*W,a[4]=c*w+m*g+u*b-h*v+A*$+k*z+C*W-P*U,a[5]=u*w+m*v+h*g-c*b+C*$+k*U+P*z-A*W,a[6]=h*w+m*b+c*v-u*g+P*$+k*W+A*U-C*z,a[7]=m*w-c*g-u*v-h*b+k*$-A*z-C*U-P*W,a}bi.getReal=ih.copy,bi.setReal=ih.copy,bi.mul=PN;var IN=ih.dot;bi.dot=IN;var LN=ih.length;bi.length=LN,bi.len=LN;var L2=ih.squaredLength;bi.squaredLength=L2,bi.sqrLen=L2;var si={};function qC(a){return qC=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qC(a)}Object.defineProperty(si,"__esModule",{value:!0}),si.create=kN,si.clone=function(a){var t=new wm.ARRAY_TYPE(2);return t[0]=a[0],t[1]=a[1],t},si.fromValues=function(a,t){var r=new wm.ARRAY_TYPE(2);return r[0]=a,r[1]=t,r},si.copy=function(a,t){return a[0]=t[0],a[1]=t[1],a},si.set=function(a,t,r){return a[0]=t,a[1]=r,a},si.add=function(a,t,r){return a[0]=t[0]+r[0],a[1]=t[1]+r[1],a},si.subtract=DN,si.multiply=ON,si.divide=NN,si.ceil=function(a,t){return a[0]=Math.ceil(t[0]),a[1]=Math.ceil(t[1]),a},si.floor=function(a,t){return a[0]=Math.floor(t[0]),a[1]=Math.floor(t[1]),a},si.min=function(a,t,r){return a[0]=Math.min(t[0],r[0]),a[1]=Math.min(t[1],r[1]),a},si.max=function(a,t,r){return a[0]=Math.max(t[0],r[0]),a[1]=Math.max(t[1],r[1]),a},si.round=function(a,t){return a[0]=Math.round(t[0]),a[1]=Math.round(t[1]),a},si.scale=function(a,t,r){return a[0]=t[0]*r,a[1]=t[1]*r,a},si.scaleAndAdd=function(a,t,r,c){return a[0]=t[0]+r[0]*c,a[1]=t[1]+r[1]*c,a},si.distance=zN,si.squaredDistance=FN,si.length=BN,si.squaredLength=UN,si.negate=function(a,t){return a[0]=-t[0],a[1]=-t[1],a},si.inverse=function(a,t){return a[0]=1/t[0],a[1]=1/t[1],a},si.normalize=function(a,t){var r=t[0],c=t[1],u=r*r+c*c;return u>0&&(u=1/Math.sqrt(u)),a[0]=t[0]*u,a[1]=t[1]*u,a},si.dot=function(a,t){return a[0]*t[0]+a[1]*t[1]},si.cross=function(a,t,r){var c=t[0]*r[1]-t[1]*r[0];return a[0]=a[1]=0,a[2]=c,a},si.lerp=function(a,t,r,c){var u=t[0],h=t[1];return a[0]=u+c*(r[0]-u),a[1]=h+c*(r[1]-h),a},si.random=function(a,t){t=t||1;var r=2*wm.RANDOM()*Math.PI;return a[0]=Math.cos(r)*t,a[1]=Math.sin(r)*t,a},si.transformMat2=function(a,t,r){var c=t[0],u=t[1];return a[0]=r[0]*c+r[2]*u,a[1]=r[1]*c+r[3]*u,a},si.transformMat2d=function(a,t,r){var c=t[0],u=t[1];return a[0]=r[0]*c+r[2]*u+r[4],a[1]=r[1]*c+r[3]*u+r[5],a},si.transformMat3=function(a,t,r){var c=t[0],u=t[1];return a[0]=r[0]*c+r[3]*u+r[6],a[1]=r[1]*c+r[4]*u+r[7],a},si.transformMat4=function(a,t,r){var c=t[0],u=t[1];return a[0]=r[0]*c+r[4]*u+r[12],a[1]=r[1]*c+r[5]*u+r[13],a},si.rotate=function(a,t,r,c){var u=t[0]-r[0],h=t[1]-r[1],m=Math.sin(c),g=Math.cos(c);return a[0]=u*g-h*m+r[0],a[1]=u*m+h*g+r[1],a},si.angle=function(a,t){var r=a[0],c=a[1],u=t[0],h=t[1],m=Math.sqrt(r*r+c*c)*Math.sqrt(u*u+h*h);return Math.acos(Math.min(Math.max(m&&(r*u+c*h)/m,-1),1))},si.zero=function(a){return a[0]=0,a[1]=0,a},si.str=function(a){return"vec2("+a[0]+", "+a[1]+")"},si.exactEquals=function(a,t){return a[0]===t[0]&&a[1]===t[1]},si.equals=function(a,t){var r=a[0],c=a[1],u=t[0],h=t[1];return Math.abs(r-u)<=wm.EPSILON*Math.max(1,Math.abs(r),Math.abs(u))&&Math.abs(c-h)<=wm.EPSILON*Math.max(1,Math.abs(c),Math.abs(h))},si.forEach=si.sqrLen=si.sqrDist=si.dist=si.div=si.mul=si.sub=si.len=void 0;var wm=function(a,t){if(a&&a.__esModule)return a;if(a===null||qC(a)!=="object"&&typeof a!="function")return{default:a};var r=RN(void 0);if(r&&r.has(a))return r.get(a);var c={},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var h in a)if(h!=="default"&&Object.prototype.hasOwnProperty.call(a,h)){var m=u?Object.getOwnPropertyDescriptor(a,h):null;m&&(m.get||m.set)?Object.defineProperty(c,h,m):c[h]=a[h]}return c.default=a,r&&r.set(a,c),c}(no);function RN(a){if(typeof WeakMap!="function")return null;var t=new WeakMap,r=new WeakMap;return(RN=function(c){return c?r:t})(a)}function kN(){var a=new wm.ARRAY_TYPE(2);return wm.ARRAY_TYPE!=Float32Array&&(a[0]=0,a[1]=0),a}function DN(a,t,r){return a[0]=t[0]-r[0],a[1]=t[1]-r[1],a}function ON(a,t,r){return a[0]=t[0]*r[0],a[1]=t[1]*r[1],a}function NN(a,t,r){return a[0]=t[0]/r[0],a[1]=t[1]/r[1],a}function zN(a,t){return Math.hypot(t[0]-a[0],t[1]-a[1])}function FN(a,t){var r=t[0]-a[0],c=t[1]-a[1];return r*r+c*c}function BN(a){return Math.hypot(a[0],a[1])}function UN(a){var t=a[0],r=a[1];return t*t+r*r}si.len=BN,si.sub=DN,si.mul=ON,si.div=NN,si.dist=zN,si.sqrDist=FN,si.sqrLen=UN;var AQ=function(){var a=kN();return function(t,r,c,u,h,m){var g,v;for(r||(r=2),c||(c=0),v=u?Math.min(u*r+c,t.length):t.length,g=c;g<v;g+=r)a[0]=t[g],a[1]=t[g+1],h(a,a,m),t[g]=a[0],t[g+1]=a[1];return t}}();function XC(a){return XC=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},XC(a)}si.forEach=AQ,Object.defineProperty(to,"__esModule",{value:!0});var Hi=to.vec4=ke=to.vec3=to.vec2=to.quat2=To=to.quat=rt=to.mat4=Ns=to.mat3=to.mat2d=av=to.mat2=to.glMatrix=void 0,EQ=Hu(no);to.glMatrix=EQ;var MQ=Hu(ka),av=to.mat2=MQ,TQ=Hu(za);to.mat2d=TQ;var CQ=Hu(Yi),Ns=to.mat3=CQ,PQ=Hu(Qn),rt=to.mat4=PQ,IQ=Hu(jn),To=to.quat=IQ,LQ=Hu(bi);to.quat2=LQ;var RQ=Hu(si);to.vec2=RQ;var kQ=Hu(Kn),ke=to.vec3=kQ,DQ=Hu(fi);function WN(a){if(typeof WeakMap!="function")return null;var t=new WeakMap,r=new WeakMap;return(WN=function(c){return c?r:t})(a)}function Hu(a,t){if(!t&&a&&a.__esModule)return a;if(a===null||XC(a)!=="object"&&typeof a!="function")return{default:a};var r=WN(t);if(r&&r.has(a))return r.get(a);var c={},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var h in a)if(h!=="default"&&Object.prototype.hasOwnProperty.call(a,h)){var m=u?Object.getOwnPropertyDescriptor(a,h):null;m&&(m.get||m.set)?Object.defineProperty(c,h,m):c[h]=a[h]}return c.default=a,r&&r.set(a,c),c}Hi=to.vec4=DQ;const OQ=B([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:R2}=OQ,VN=B([{name:"a_pos_3",components:3,type:"Int16"}]);var _p=B([{name:"a_pos",type:"Int16",components:2}]),GN={};(function(a,t){(function(r){function c(h,m,g){var v=u(256*h,256*(m=Math.pow(2,g)-m-1),g),b=u(256*(h+1),256*(m+1),g);return v[0]+","+v[1]+","+b[0]+","+b[1]}function u(h,m,g){var v=2*Math.PI*6378137/256/Math.pow(2,g);return[h*v-2*Math.PI*6378137/2,m*v-2*Math.PI*6378137/2]}r.getURL=function(h,m,g,v,b,w){return w=w||{},h+"?"+["bbox="+c(g,v,b),"format="+(w.format||"image/png"),"service="+(w.service||"WMS"),"version="+(w.version||"1.1.1"),"request="+(w.request||"GetMap"),"srs="+(w.srs||"EPSG:3857"),"width="+(w.width||256),"height="+(w.height||256),"layers="+m].join("&")},r.getTileBBox=c,r.getMercCoords=u,Object.defineProperty(r,"__esModule",{value:!0})})(t)})(0,GN);var NQ=GN;class ju{constructor(t,r,c){this.z=t,this.x=r,this.y=c,this.key=c1(0,t,t,r,c)}equals(t){return this.z===t.z&&this.x===t.x&&this.y===t.y}url(t,r){const c=NQ.getTileBBox(this.x,this.y,this.z),u=function(h,m,g){let v,b="";for(let w=h;w>0;w--)v=1<<w-1,b+=(m&v?1:0)+(g&v?2:0);return b}(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(r==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",u).replace("{bbox-epsg-3857}",c)}toString(){return`${this.z}/${this.x}/${this.y}`}}class ZC{constructor(t,r){this.wrap=t,this.canonical=r,this.key=c1(t,r.z,r.z,r.x,r.y)}}class Li{constructor(t,r,c,u,h){this.overscaledZ=t,this.wrap=r,this.canonical=new ju(c,+u,+h),this.key=r===0&&t===c?this.canonical.key:c1(r,t,c,u,h)}equals(t){return this.overscaledZ===t.overscaledZ&&this.wrap===t.wrap&&this.canonical.equals(t.canonical)}scaledTo(t){const r=this.canonical.z-t;return t>this.canonical.z?new Li(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Li(t,this.wrap,t,this.canonical.x>>r,this.canonical.y>>r)}calculateScaledKey(t,r=!0){if(this.overscaledZ===t&&r)return this.key;if(t>this.canonical.z)return c1(this.wrap*+r,t,this.canonical.z,this.canonical.x,this.canonical.y);{const c=this.canonical.z-t;return c1(this.wrap*+r,t,t,this.canonical.x>>c,this.canonical.y>>c)}}isChildOf(t){if(t.wrap!==this.wrap)return!1;const r=this.canonical.z-t.canonical.z;return t.overscaledZ===0||t.overscaledZ<this.overscaledZ&&t.canonical.z<this.canonical.z&&t.canonical.x===this.canonical.x>>r&&t.canonical.y===this.canonical.y>>r}children(t){if(this.overscaledZ>=t)return[new Li(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const r=this.canonical.z+1,c=2*this.canonical.x,u=2*this.canonical.y;return[new Li(r,this.wrap,r,c,u),new Li(r,this.wrap,r,c+1,u),new Li(r,this.wrap,r,c,u+1),new Li(r,this.wrap,r,c+1,u+1)]}isLessThan(t){return this.wrap<t.wrap||!(this.wrap>t.wrap)&&(this.overscaledZ<t.overscaledZ||!(this.overscaledZ>t.overscaledZ)&&(this.canonical.x<t.canonical.x||!(this.canonical.x>t.canonical.x)&&this.canonical.y<t.canonical.y))}wrapped(){return new Li(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(t){return new Li(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new ZC(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function c1(a,t,r,c,u){const h=1<<Math.min(r,22);let m=h*(u%h)+c%h;return a&&r<22&&(m+=h*h*((a<0?-2*a-1:2*a)%(1<<2*(22-r)))),16*(32*m+r)+(t-r)}const HN=[a=>{let t=a.canonical.x-1,r=a.wrap;return t<0&&(t=(1<<a.canonical.z)-1,r--),new Li(a.overscaledZ,r,a.canonical.z,t,a.canonical.y)},a=>{let t=a.canonical.x+1,r=a.wrap;return t===1<<a.canonical.z&&(t=0,r++),new Li(a.overscaledZ,r,a.canonical.z,t,a.canonical.y)},a=>new Li(a.overscaledZ,a.wrap,a.canonical.z,a.canonical.x,(a.canonical.y===0?1<<a.canonical.z:a.canonical.y)-1),a=>new Li(a.overscaledZ,a.wrap,a.canonical.z,a.canonical.x,a.canonical.y===(1<<a.canonical.z)-1?0:a.canonical.y+1)];un(ju,"CanonicalTileID"),un(Li,"OverscaledTileID",{omit:["projMatrix"]});class k2{constructor(t,r){this.pos=t,this.dir=r}intersectsPlane(t,r,c){const u=ke.dot(r,this.dir);if(Math.abs(u)<1e-6)return!1;const h=((t[0]-this.pos[0])*r[0]+(t[1]-this.pos[1])*r[1]+(t[2]-this.pos[2])*r[2])/u;return c[0]=this.pos[0]+this.dir[0]*h,c[1]=this.pos[1]+this.dir[1]*h,c[2]=this.pos[2]+this.dir[2]*h,!0}closestPointOnSphere(t,r,c){if(ke.equals(this.pos,t)||r===0)return c[0]=c[1]=c[2]=0,!1;const[u,h,m]=this.dir,g=this.pos[0]-t[0],v=this.pos[1]-t[1],b=this.pos[2]-t[2],w=u*u+h*h+m*m,A=2*(g*u+v*h+b*m),C=A*A-4*w*(g*g+v*v+b*b-r*r);if(C<0){const P=Math.max(-A/2,0),k=g+u*P,z=v+h*P,U=b+m*P,W=Math.hypot(k,z,U);return c[0]=k*r/W,c[1]=z*r/W,c[2]=U*r/W,!1}{const P=(-A-Math.sqrt(C))/(2*w);if(P<0){const k=Math.hypot(g,v,b);return c[0]=g*r/k,c[1]=v*r/k,c[2]=b*r/k,!1}return c[0]=g+u*P,c[1]=v+h*P,c[2]=b+m*P,!0}}}class KC{constructor(t,r,c,u,h){this.TL=t,this.TR=r,this.BR=c,this.BL=u,this.horizon=h}static fromInvProjectionMatrix(t,r,c){const u=[-1,1,1],h=[1,1,1],m=[1,-1,1],g=[-1,-1,1],v=ke.transformMat4(u,u,t),b=ke.transformMat4(h,h,t),w=ke.transformMat4(m,m,t),A=ke.transformMat4(g,g,t);return new KC(v,b,w,A,r/c)}}function u1(a,t,r){let c=1/0,u=-1/0;const h=[];for(const m of a){ke.sub(h,m,t);const g=ke.dot(h,r);c=Math.min(c,g),u=Math.max(u,g)}return[c,u]}function jN(a,t){let r=!0;for(let c=0;c<a.planes.length;c++){const u=a.planes[c];let h=0;for(let m=0;m<t.length;m++)h+=ke.dot(u,t[m])+u[3]>=0;if(h===0)return 0;h!==t.length&&(r=!1)}return r?2:1}function $N(a,t){for(const r of a.projections){const c=u1(t,a.points[0],r.axis);if(r.projection[1]<c[0]||r.projection[0]>c[1])return 0}return 1}function YN(a,t){let r=0;const c=[0,0,0,0];for(let u=0;u<a.length;u++)c[0]=a[u][0],c[1]=a[u][1],c[2]=a[u][2],c[3]=1,Hi.dot(c,t)>=0&&r++;return r}class ah{constructor(t,r){this.points=t||new Array(8).fill([0,0,0]),this.planes=r||new Array(6).fill([0,0,0,0]),this.bounds=ga.fromPoints(this.points),this.projections=[],this.frustumEdges=[ke.sub([],this.points[2],this.points[3]),ke.sub([],this.points[0],this.points[3]),ke.sub([],this.points[4],this.points[0]),ke.sub([],this.points[5],this.points[1]),ke.sub([],this.points[6],this.points[2]),ke.sub([],this.points[7],this.points[3])];for(const c of this.frustumEdges){const u=[0,-c[2],c[1]],h=[c[2],0,-c[0]];this.projections.push({axis:u,projection:u1(this.points,this.points[0],u)}),this.projections.push({axis:h,projection:u1(this.points,this.points[0],h)})}}static fromInvProjectionMatrix(t,r,c,u){const h=Math.pow(2,c),m=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(b=>{const w=Hi.transformMat4([],b,t),A=1/w[3]/r*h;return Hi.mul(w,w,[A,A,u?1/w[3]:A,A])}),g=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(b=>{const w=ke.sub([],m[b[0]],m[b[1]]),A=ke.sub([],m[b[2]],m[b[1]]),C=ke.normalize([],ke.cross([],w,A)),P=-ke.dot(C,m[b[1]]);return C.concat(P)}),v=[];for(let b=0;b<m.length;b++)v.push([m[b][0],m[b][1],m[b][2]]);return new ah(v,g)}intersectsPrecise(t,r,c){for(let u=0;u<r.length;u++)if(!YN(t,r[u]))return 0;for(let u=0;u<this.planes.length;u++)if(!YN(t,this.planes[u]))return 0;for(const u of c)for(const h of this.frustumEdges){const m=ke.cross([],u,h),g=ke.length(m);if(g===0)continue;ke.scale(m,m,1/g);const v=u1(this.points,this.points[0],m),b=u1(t,this.points[0],m);if(v[0]>b[1]||b[0]>v[1])return 0}return 1}}class ga{static fromPoints(t){const r=[1/0,1/0,1/0],c=[-1/0,-1/0,-1/0];for(const u of t)ke.min(r,r,u),ke.max(c,c,u);return new ga(r,c)}static fromTileIdAndHeight(t,r,c){const u=1<<t.canonical.z,h=t.canonical.x,m=t.canonical.y;return new ga([h/u,m/u,r],[(h+1)/u,(m+1)/u,c])}static applyTransform(t,r){const c=t.getCorners();for(let u=0;u<c.length;++u)ke.transformMat4(c[u],c[u],r);return ga.fromPoints(c)}static projectAabbCorners(t,r){const c=t.getCorners();for(let u=0;u<c.length;++u)ke.transformMat4(c[u],c[u],r);return c}constructor(t,r){this.min=t,this.max=r,this.center=ke.scale([],ke.add([],this.min,this.max),.5)}quadrant(t){const r=[t%2==0,t<2],c=ke.clone(this.min),u=ke.clone(this.max);for(let h=0;h<r.length;h++)c[h]=r[h]?this.min[h]:this.center[h],u[h]=r[h]?this.center[h]:this.max[h];return u[2]=this.max[2],new ga(c,u)}distanceX(t){return Math.max(Math.min(this.max[0],t[0]),this.min[0])-t[0]}distanceY(t){return Math.max(Math.min(this.max[1],t[1]),this.min[1])-t[1]}distanceZ(t){return Math.max(Math.min(this.max[2],t[2]),this.min[2])-t[2]}getCorners(){const t=this.min,r=this.max;return[[t[0],t[1],t[2]],[r[0],t[1],t[2]],[r[0],r[1],t[2]],[t[0],r[1],t[2]],[t[0],t[1],r[2]],[r[0],t[1],r[2]],[r[0],r[1],r[2]],[t[0],r[1],r[2]]]}intersects(t){return this.intersectsAabb(t.bounds)?jN(t,this.getCorners()):0}intersectsFlat(t){return this.intersectsAabb(t.bounds)?jN(t,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsPrecise(t,r){return r||this.intersects(t)?$N(t,this.getCorners()):0}intersectsPreciseFlat(t,r){return r||this.intersectsFlat(t)?$N(t,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsAabb(t){for(let r=0;r<3;++r)if(this.min[r]>t.max[r]||t.min[r]>this.max[r])return!1;return!0}intersectsAabbXY(t){return!(this.min[0]>t.max[0]||t.min[0]>this.max[0]||this.min[1]>t.max[1]||t.min[1]>this.max[1])}encapsulate(t){for(let r=0;r<3;r++)this.min[r]=Math.min(this.min[r],t.min[r]),this.max[r]=Math.max(this.max[r],t.max[r])}encapsulatePoint(t){for(let r=0;r<3;r++)this.min[r]=Math.min(this.min[r],t[r]),this.max[r]=Math.max(this.max[r],t[r])}closestPoint(t){return[Math.max(Math.min(this.max[0],t[0]),this.min[0]),Math.max(Math.min(this.max[1],t[1]),this.min[1]),Math.max(Math.min(this.max[2],t[2]),this.min[2])]}}un(ga,"Aabb");const d1=5,bp=6,cs=mt/Math.PI/2,zQ=16383,rv=64,JC=[rv,32,16],fc=-cs,mc=cs,FQ=[new ga([fc,fc,fc],[mc,mc,mc]),new ga([fc,fc,fc],[0,0,mc]),new ga([0,fc,fc],[mc,0,mc]),new ga([fc,0,fc],[0,mc,mc]),new ga([0,0,fc],[mc,mc,mc])];function D2(a){return a*cs/sv}function qN(a,t,r,c=!0){const u=ke.scale([],a._camera.position,a.worldSize),h=[t,r,1,1];Hi.transformMat4(h,h,a.pixelMatrixInverse),Hi.scale(h,h,1/h[3]);const m=ke.sub([],h,u),g=ke.normalize([],m),v=a.globeMatrix,b=[v[12],v[13],v[14]],w=ke.sub([],b,u),A=ke.length(w),C=ke.normalize([],w),P=a.worldSize/(2*Math.PI),k=ke.dot(C,g),z=Math.asin(P/A);if(z<Math.acos(k)){if(!c)return null;const Ce=[],Ae=[];ke.scale(Ce,g,A/k),ke.normalize(Ae,ke.sub(Ae,Ce,w)),ke.normalize(g,ke.add(g,w,ke.scale(g,Ae,Math.tan(z)*A)))}const U=[];new k2(u,g).closestPointOnSphere(b,P,U);const W=ke.normalize([],Et(v,0)),$=ke.normalize([],Et(v,1)),Z=ke.normalize([],Et(v,2)),K=ke.dot(W,U),q=ke.dot($,U),J=ke.dot(Z,U),re=pe(Math.asin(-q/P));let ce=pe(Math.atan2(K,J));ce=a.center.lng+function(Ce,Ae){const Le=(Ae-Ce+180)%360-180;return Le<-180?Le+360:Le}(a.center.lng,ce);const ge=vo(ce),ve=ae(Co(re),0,1);return new vi(ge,ve)}class BQ{constructor(t,r,c){this.a=ke.sub([],t,c),this.b=ke.sub([],r,c),this.center=c;const u=ke.normalize([],this.a),h=ke.normalize([],this.b);this.angle=Math.acos(ke.dot(u,h))}}function QC(a,t){if(a.angle===0)return null;let r;return r=a.a[t]===0?1/a.angle*.5*Math.PI:1/a.angle*Math.atan(a.b[t]/a.a[t]/Math.sin(a.angle)-1/Math.tan(a.angle)),r<0||r>1?null:function(c,u,h,m){const g=Math.sin(h);return c*(Math.sin((1-m)*h)/g)+u*(Math.sin(m*h)/g)}(a.a[t],a.b[t],a.angle,ae(r,0,1))+a.center[t]}function gc(a){if(a.z<=1)return FQ[a.z+2*a.y+a.x];const t=tP(O2(a));return ga.fromPoints(t)}function rh(a,t,r){return ke.scale(a,a,1-r),ke.scaleAndAdd(a,a,t,r)}function XN(a,t){const r=yo(t.zoom);if(r===0)return gc(a);const c=O2(a),u=tP(c),h=vo(c.getWest())*t.worldSize,m=vo(c.getEast())*t.worldSize,g=Co(c.getNorth())*t.worldSize,v=Co(c.getSouth())*t.worldSize,b=[h,g,0],w=[m,g,0],A=[h,v,0],C=[m,v,0],P=rt.invert([],t.globeMatrix);return ke.transformMat4(b,b,P),ke.transformMat4(w,w,P),ke.transformMat4(A,A,P),ke.transformMat4(C,C,P),u[0]=rh(u[0],A,r),u[1]=rh(u[1],C,r),u[2]=rh(u[2],w,r),u[3]=rh(u[3],b,r),ga.fromPoints(u)}function ZN(a,t,r){for(const c of a)ke.transformMat4(c,c,t),ke.scale(c,c,r)}function eP(a,t,r,c){const u=t/a.worldSize,h=a.globeMatrix;if(r.z<=1){const ge=gc(r).getCorners();return ZN(ge,h,u),ga.fromPoints(ge)}const m=O2(r,c),g=tP(m);ZN(g,h,u);const v=Number.MAX_VALUE,b=[-v,-v,-v],w=[v,v,v];if(m.contains(a.center)){for(const Ce of g)ke.min(w,w,Ce),ke.max(b,b,Ce);b[2]=0;const ge=a.point,ve=[ge.x*u,ge.y*u,0];return ke.min(w,w,ve),ke.max(b,b,ve),new ga(w,b)}const A=[h[12]*u,h[13]*u,h[14]*u],C=m.getCenter(),P=ae(a.center.lat,-qa,qa),k=ae(C.lat,-qa,qa),z=vo(a.center.lng),U=Co(P);let W=z-vo(C.lng);const $=U-Co(k);W>.5?W-=1:W<-.5&&(W+=1);let Z=0;if(Math.abs(W)>Math.abs($))Z=W>=0?1:3;else{Z=$>=0?0:2;const ge=[h[4]*u,h[5]*u,h[6]*u],ve=-Math.sin(ye($>=0?m.getSouth():m.getNorth()))*cs;ke.scaleAndAdd(A,A,ge,ve)}const K=g[Z],q=g[(Z+1)%4],J=new BQ(K,q,A),re=[QC(J,0)||K[0],QC(J,1)||K[1],QC(J,2)||K[2]],ce=yo(a.zoom);if(ce>0){const ge=function({x:Ce,y:Ae,z:Le},Se,Ve,Xe,nt){const We=1/(1<<Le);let Ge=Ce*We,ot=Ge+We,yt=Ae*We,pt=yt+We,Rt=0;const Ft=(Ge+ot)/2-Xe;return Ft>.5?Rt=-1:Ft<-.5&&(Rt=1),Ge=((Ge+Rt)*Se-(Xe*=Se))*Ve+Xe,ot=((ot+Rt)*Se-Xe)*Ve+Xe,yt=(yt*Se-(nt*=Se))*Ve+nt,pt=(pt*Se-nt)*Ve+nt,[[Ge,pt,0],[ot,pt,0],[ot,yt,0],[Ge,yt,0]]}(r,t,a._pixelsPerMercatorPixel,z,U);for(let Ce=0;Ce<g.length;Ce++)rh(g[Ce],ge[Ce],ce);const ve=ke.add([],ge[Z],ge[(Z+1)%4]);ke.scale(ve,ve,.5),rh(re,ve,ce)}for(const ge of g)ke.min(w,w,ge),ke.max(b,b,ge);return w[2]=Math.min(K[2],q[2]),ke.min(w,w,re),ke.max(b,b,re),new ga(w,b)}function O2({x:a,y:t,z:r},c=!1){const u=1/(1<<r),h=new On(sl(a*u),t===(1<<r)-1&&c?-90:yr((t+1)*u)),m=new On(sl((a+1)*u),t===0&&c?90:yr(t*u));return new Ol(h,m)}function tP(a){const t=ye(a.getNorth()),r=ye(a.getSouth()),c=Math.cos(t),u=Math.cos(r),h=Math.sin(t),m=Math.sin(r),g=a.getWest(),v=a.getEast();return[ov(u,m,g),ov(u,m,v),ov(c,h,v),ov(c,h,g)]}function ov(a,t,r,c=cs){return r=ye(r),[a*Math.sin(r)*c,-t*c,a*Math.cos(r)*c]}function zs(a,t,r){return ov(Math.cos(ye(a)),Math.sin(ye(a)),t,r)}function h1(a,t,r,c){const u=1<<r.z,h=(a/mt+r.x)/u;return zs(yr((t/mt+r.y)/u),sl(h),c)}function N2({min:a,max:t}){return zQ/Math.max(t[0]-a[0],t[1]-a[1],t[2]-a[2])}const KN=new Float64Array(16);function Sm(a){const t=N2(a),r=rt.fromScaling(KN,[t,t,t]);return rt.translate(r,r,ke.negate([],a.min))}function nP(a){const t=rt.fromTranslation(KN,a.min),r=1/N2(a);return rt.scale(t,t,[r,r,r])}function iP(a){const t=mt/(2*Math.PI);return a/(2*Math.PI)/t}function JN(a,t){return mt/(512*Math.pow(2,a))*N2(gc(t))}function QN(a,t,r,c,u){const h=iP(r),m=[a,t,-r/(2*Math.PI)],g=rt.identity(new Float64Array(16));return rt.translate(g,g,m),rt.scale(g,g,[h,h,h]),rt.rotateX(g,g,ye(-u)),rt.rotateY(g,g,ye(-c)),g}function yo(a){return Ee(d1,bp,a)}function ez(a,t,r){const c=rt.identity(new Float64Array(16)),u=(t/(1<<a)-.5)*Math.PI*2;return rt.rotateY(c,r.globeMatrix,u),Float32Array.from(c)}function tz(a,t,r){const c=yo(r.zoom),u=a.style.map._antialias,h=t.extStandardDerivativesForceOff||a.terrain&&a.terrain.exaggeration()>0;return c===0&&!u&&!h}function UQ(a,t,r,c){const u=t.getNorth(),h=t.getSouth(),m=t.getWest(),g=t.getEast(),v=1<<a.z,b=g-m,w=u-h,A=b/rv,C=-w/JC[r],P=[0,A,0,C,0,0,u,m,0];if(a.z>0){const k=180/c;Ns.multiply(P,P,[k/b+1,0,0,0,k/w+1,0,-.5*k/A,.5*k/C,1])}return P[2]=v,P[5]=a.x,P[8]=a.y,P}function WQ(a){const t=qa-5;a=ae(a,-t,t)/t*90;const r=Math.pow(Math.abs(Math.sin(ye(a))),3);return Math.round(r*(JC.length-1))}function nz(a){const t=[0,0,0],r=rt.identity(new Float64Array(16));return rt.multiply(r,a.pixelMatrix,a.globeMatrix),ke.transformMat4(t,t,r),new V(t[0],t[1])}function iz(a,t){const r=zs(t.lat,t.lng),c=function(h){const m=zs(h._center.lat,h._center.lng),g=ke.fromValues(0,1,0);let v=ke.cross([],g,m);const b=rt.fromRotation([],-h.angle,m);v=ke.transformMat4(v,v,b),rt.fromRotation(b,-h._pitch,v);const w=ke.normalize([],m);return ke.scale(w,w,D2(h.cameraToCenterDistance/h.pixelsPerMeter)),ke.transformMat4(w,w,b),ke.add([],m,w)}(a),u=ke.subtract([],c,r);return ke.angle(u,r)}function z2(a,t){return iz(a,t)>Math.PI/2*1.01}const az=ye(85),VQ=Math.cos(az),GQ=Math.sin(az);class HQ{constructor(t){this._createGrid(t),this._createPoles(t)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const t of this._poleSegments)t.destroy();for(const t of this._gridSegments)t.withSkirts.destroy(),t.withoutSkirts.destroy()}_fillGridMeshWithLods(t,r){const c=new ee,u=new Fn,h=[],m=t+1+2,g=r[0]+1,v=r[0]+1+(1+r.length),b=(w,A,C)=>{let P=w===m-1?w-2:w===0?w:w-1;return P+=C?24575:0,[P,A]};for(let w=0;w<m;++w)c.emplaceBack(...b(w,0,!0));for(let w=0;w<g;++w)for(let A=0;A<m;++A)c.emplaceBack(...b(A,w,(A===0||A===m-1)&&!0));for(let w=0;w<r.length;++w){const A=r[w];for(let C=0;C<m;++C)c.emplaceBack(...b(C,A,!0))}for(let w=0;w<r.length;++w){const A=u.length,C=r[w]+1+2,P=new Fn;for(let U=0;U<C-1;U++){const W=U===C-2,$=W?m*(v-r.length+w-U):m;for(let Z=0;Z<m-1;Z++){const K=U*m+Z;U===0||W||Z===0||Z===m-2?(P.emplaceBack(K+1,K,K+$),P.emplaceBack(K+$,K+$+1,K+1)):(u.emplaceBack(K+1,K,K+$),u.emplaceBack(K+$,K+$+1,K+1))}}const k=ji.simpleSegment(0,A,c.length,u.length-A);for(let U=0;U<P.uint16.length;U+=3)u.emplaceBack(P.uint16[U],P.uint16[U+1],P.uint16[U+2]);const z=ji.simpleSegment(0,A,c.length,u.length-A);h.push({withoutSkirts:k,withSkirts:z})}return{vertices:c,indices:u,segments:h}}_createGrid(t){const r=this._fillGridMeshWithLods(rv,JC);this._gridSegments=r.segments,this._gridBuffer=t.createVertexBuffer(r.vertices,_p.members),this._gridIndexBuffer=t.createIndexBuffer(r.indices,!0)}_createPoles(t){const r=new Fn;for(let g=0;g<=rv;g++)r.emplaceBack(0,g+1,g+2);this._poleIndexBuffer=t.createIndexBuffer(r,!0);const c=new Vi,u=new Vi,h=new Vi,m=new Vi;this._poleSegments=[];for(let g=0,v=0;g<d1;g++){const b=360/(1<<g);c.emplaceBack(0,-cs,0,.5,0),u.emplaceBack(0,-cs,0,.5,1),h.emplaceBack(0,-cs,0,.5,.5),m.emplaceBack(0,-cs,0,.5,.5);for(let w=0;w<=rv;w++){let A=w/rv,C=0;const P=Ln(0,b,A),[k,z,U]=ov(VQ,GQ,P,cs);c.emplaceBack(k,z,U,A,C),u.emplaceBack(k,z,U,A,1-C);const W=ye(P);A=.5+.5*Math.sin(W),C=.5+.5*Math.cos(W),h.emplaceBack(k,z,U,A,C),m.emplaceBack(k,z,U,A,1-C)}this._poleSegments.push(ji.simpleSegment(v,0,66,64)),v+=66}this._poleNorthVertexBuffer=t.createVertexBuffer(c,R2,!1),this._poleSouthVertexBuffer=t.createVertexBuffer(u,R2,!1),this._texturedPoleNorthVertexBuffer=t.createVertexBuffer(h,R2,!1),this._texturedPoleSouthVertexBuffer=t.createVertexBuffer(m,R2,!1)}getGridBuffers(t,r){return[this._gridBuffer,this._gridIndexBuffer,r?this._gridSegments[t].withSkirts:this._gridSegments[t].withoutSkirts]}getPoleBuffers(t,r){return[r?this._texturedPoleNorthVertexBuffer:this._poleNorthVertexBuffer,r?this._texturedPoleSouthVertexBuffer:this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[t]]}}const sv=63710088e-1,aP=2*Math.PI*sv;class xp{constructor(t,r){if(isNaN(t)||isNaN(r))throw new Error(`Invalid LngLat object: (${t}, ${r})`);if(this.lng=+t,this.lat=+r,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new xp(Je(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(t){const r=Math.PI/180,c=this.lat*r,u=t.lat*r,h=Math.sin(c)*Math.sin(u)+Math.cos(c)*Math.cos(u)*Math.cos((t.lng-this.lng)*r);return sv*Math.acos(Math.min(h,1))}toBounds(t=0){const r=360*t/40075017,c=r/Math.cos(Math.PI/180*this.lat);return new Ol(new xp(this.lng-c,this.lat-r),new xp(this.lng+c,this.lat+r))}toEcef(t){const r=D2(t);return zs(this.lat,this.lng,cs+r)}static convert(t){if(t instanceof xp)return t;if(Array.isArray(t)&&(t.length===2||t.length===3))return new xp(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&typeof t=="object"&&t!==null)return new xp(Number("lng"in t?t.lng:t.lon),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}var On=xp;const jQ=0,$Q=25.5;function F2(a){return aP*Math.cos(a*Math.PI/180)}function vo(a){return(180+a)/360}function Co(a){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+a*Math.PI/360)))/360}function $i(a,t){return a/F2(t)}function sl(a){return 360*a-180}function yr(a){return 360/Math.PI*Math.atan(Math.exp((180-360*a)*Math.PI/180))-90}function rz(a,t){return a*F2(yr(t))}const qa=85.051129;function oz(a){return Math.cos(ye(ae(a,-qa,qa)))}function wp(a,t){const r=ae(t,jQ,$Q),c=Math.pow(2,r);return oz(a)*aP/(512*c)}function rP(a){return 1/Math.cos(a*Math.PI/180)}function p1(a,t=0){const r=Math.exp(Math.PI*(1-(a.y+t/mt)/(1<<a.z)*2));return 80150034*r/(r*r+1)/mt/(1<<a.z)}class vi{constructor(t,r,c=0){this.x=+t,this.y=+r,this.z=+c}static fromLngLat(t,r=0){const c=On.convert(t);return new vi(vo(c.lng),Co(c.lat),$i(r,c.lat))}toLngLat(){return new On(sl(this.x),yr(this.y))}toAltitude(){return rz(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/aP*rP(yr(this.y))}}function oP(a,t,r,c,u,h,m,g,v){const b=(t+c)/2,w=(r+u)/2,A=new V(b,w);g(A),function(C,P,k,z,U,W){const $=k-U,Z=z-W;return Math.abs((z-P)*$-(k-C)*Z)/Math.hypot($,Z)}(A.x,A.y,h.x,h.y,m.x,m.y)>=v?(oP(a,t,r,b,w,h,A,g,v),oP(a,b,w,c,u,A,m,g,v)):a.push(m)}function sz(a,t,r){let c=a[0],u=c.x,h=c.y;t(c);const m=[c];for(let g=1;g<a.length;g++){const v=a[g],{x:b,y:w}=v;t(v),oP(m,u,h,b,w,c,v,t,r),u=b,h=w,c=v}return m}function sP(a,t,r,c){if(c(t,r)){const u=t.add(r)._mult(.5);sP(a,t,u,c),sP(a,u,r,c)}else a.push(r)}function YQ(a,t){let r=a[0];const c=[r];for(let u=1;u<a.length;u++){const h=a[u];sP(c,r,h,t),r=h}return c}const lP=Math.pow(2,14)-1,lz=-lP-1;function qQ(a,t){const r=Math.round(a.x*t),c=Math.round(a.y*t);return a.x=ae(r,lz,lP),a.y=ae(c,lz,lP),(r<a.x||r>a.x+1||c<a.y||c>a.y+1)&&_e("Geometry exceeds allowed extent, reduce your vector tile buffer size"),a}function $u(a,t,r){const c=a.loadGeometry(),u=a.extent,h=mt/u;if(t&&r&&r.projection.isReprojectedInTileSpace){const m=1<<t.z,{scale:g,x:v,y:b,projection:w}=r,A=C=>{const P=sl((t.x+C.x/u)/m),k=yr((t.y+C.y/u)/m),z=w.project(P,k);C.x=(z.x*g-v)*u,C.y=(z.y*g-b)*u};for(let C=0;C<c.length;C++)if(a.type!==1)c[C]=sz(c[C],A,1);else{const P=[];for(const k of c[C])k.x<0||k.x>=u||k.y<0||k.y>=u||(A(k),P.push(k));c[C]=P}}for(const m of c)for(const g of m)qQ(g,h);return c}function Sp(a,t){return{type:a.type,id:a.id,properties:a.properties,geometry:t?$u(a):[]}}function B2(a,t,r,c,u){a.emplaceBack(2*t+(c+1)/2,2*r+(u+1)/2)}function U2(a,t,r){a.emplaceBack(t.x,t.y,t.z,r[0]*16384,r[1]*16384,r[2]*16384)}class cP{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(r=>r.fqid),this.index=t.index,this.hasPattern=!1,this.projection=t.projection,this.layoutVertexArray=new ee,this.indexArray=new Fn,this.segments=new ji,this.programConfigurations=new yp(t.layers,t.zoom),this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id)}populate(t,r,c,u){const h=this.layers[0],m=[];let g=null;h.type==="circle"&&(g=h.layout.get("circle-sort-key"));for(const{feature:b,id:w,index:A,sourceLayerIndex:C}of t){const P=this.layers[0]._featureFilter.needGeometry,k=Sp(b,P);if(!this.layers[0]._featureFilter.filter(new sa(this.zoom),k,c))continue;const z=g?g.evaluate(k,{},c):void 0,U={id:w,properties:b.properties,type:b.type,sourceLayerIndex:C,index:A,geometry:P?k.geometry:$u(b,c,u),patterns:{},sortKey:z};m.push(U)}g&&m.sort((b,w)=>b.sortKey-w.sortKey);let v=null;u.projection.name==="globe"&&(this.globeExtVertexArray=new ti,v=u.projection);for(const b of m){const{geometry:w,index:A,sourceLayerIndex:C}=b,P=t[A].feature;this.addFeature(b,w,A,r.availableImages,c,v,r.brightness),r.featureIndex.insert(P,w,A,C,this.index)}}update(t,r,c,u,h){const m=Object.keys(t).length!==0;m&&!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(t,r,m?this.stateDependentLayers:this.layers,c,u,h)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,iQ.members),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=t.createVertexBuffer(this.globeExtVertexArray,aQ.members))),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(t,r,c,u,h,m,g){for(const v of r)for(const b of v){const w=b.x,A=b.y;if(w<0||w>=mt||A<0||A>=mt)continue;if(m){const k=m.projectTilePoint(w,A,h),z=m.upVector(h,w,A),U=this.globeExtVertexArray;U2(U,k,z),U2(U,k,z),U2(U,k,z),U2(U,k,z)}const C=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,t.sortKey),P=C.vertexLength;B2(this.layoutVertexArray,w,A,-1,-1),B2(this.layoutVertexArray,w,A,1,-1),B2(this.layoutVertexArray,w,A,1,1),B2(this.layoutVertexArray,w,A,-1,1),this.indexArray.emplaceBack(P,P+1,P+2),this.indexArray.emplaceBack(P,P+2,P+3),C.vertexLength+=4,C.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,c,{},u,h,g)}}function cz(a,t){for(let r=0;r<a.length;r++)if(Ap(t,a[r]))return!0;for(let r=0;r<t.length;r++)if(Ap(a,t[r]))return!0;return!!uP(a,t)}function XQ(a,t,r){return!!Ap(a,t)||!!dP(t,a,r)}function uz(a,t){if(a.length===1)return hz(t,a[0]);for(let r=0;r<t.length;r++){const c=t[r];for(let u=0;u<c.length;u++)if(Ap(a,c[u]))return!0}for(let r=0;r<a.length;r++)if(hz(t,a[r]))return!0;for(let r=0;r<t.length;r++)if(uP(a,t[r]))return!0;return!1}function ZQ(a,t,r){if(a.length>1){if(uP(a,t))return!0;for(let c=0;c<t.length;c++)if(dP(t[c],a,r))return!0}for(let c=0;c<a.length;c++)if(dP(a[c],t,r))return!0;return!1}function uP(a,t){if(a.length===0||t.length===0)return!1;for(let r=0;r<a.length-1;r++){const c=a[r],u=a[r+1];for(let h=0;h<t.length-1;h++)if(KQ(c,u,t[h],t[h+1]))return!0}return!1}function KQ(a,t,r,c){return je(a,r,c)!==je(t,r,c)&&je(a,t,r)!==je(a,t,c)}function dP(a,t,r){const c=r*r;if(t.length===1)return a.distSqr(t[0])<c;for(let u=1;u<t.length;u++)if(dz(a,t[u-1],t[u])<c)return!0;return!1}function dz(a,t,r){const c=t.distSqr(r);if(c===0)return a.distSqr(t);const u=((a.x-t.x)*(r.x-t.x)+(a.y-t.y)*(r.y-t.y))/c;return a.distSqr(u<0?t:u>1?r:r.sub(t)._mult(u)._add(t))}function hz(a,t){let r,c,u,h=!1;for(let m=0;m<a.length;m++){r=a[m];for(let g=0,v=r.length-1;g<r.length;v=g++)c=r[g],u=r[v],c.y>t.y!=u.y>t.y&&t.x<(u.x-c.x)*(t.y-c.y)/(u.y-c.y)+c.x&&(h=!h)}return h}function Ap(a,t){let r=!1;for(let c=0,u=a.length-1;c<a.length;u=c++){const h=a[c],m=a[u];h.y>t.y!=m.y>t.y&&t.x<(m.x-h.x)*(t.y-h.y)/(m.y-h.y)+h.x&&(r=!r)}return r}function pz(a,t,r,c,u){for(const m of a)if(t<=m.x&&r<=m.y&&c>=m.x&&u>=m.y)return!0;const h=[new V(t,r),new V(t,u),new V(c,u),new V(c,r)];if(a.length>2){for(const m of h)if(Ap(a,m))return!0}for(let m=0;m<a.length-1;m++)if(JQ(a[m],a[m+1],h))return!0;return!1}function JQ(a,t,r){const c=r[0],u=r[2];if(a.x<c.x&&t.x<c.x||a.x>u.x&&t.x>u.x||a.y<c.y&&t.y<c.y||a.y>u.y&&t.y>u.y)return!1;const h=je(a,t,r[0]);return h!==je(a,t,r[1])||h!==je(a,t,r[2])||h!==je(a,t,r[3])}function lv(a,t,r,c,u,h){let m=t.y-a.y,g=a.x-t.x;if(h=h||0){const v=m*m+g*g;if(v===0)return!0;const b=Math.sqrt(v);m/=b,g/=b}return!((r.x-a.x)*m+(r.y-a.y)*g-h<0||(c.x-a.x)*m+(c.y-a.y)*g-h<0||(u.x-a.x)*m+(u.y-a.y)*g-h<0)}function hP(a,t,r,c,u,h,m){return!(lv(a,t,c,u,h,m)||lv(t,r,c,u,h,m)||lv(r,a,c,u,h,m)||lv(c,u,a,t,r,m)||lv(u,h,a,t,r,m)||lv(h,c,a,t,r,m))}function cv(a,t,r){const c=t.paint.get(a).value;return c.kind==="constant"?c.value:r.programConfigurations.get(t.id).getMaxValue(a)}function W2(a){return Math.sqrt(a[0]*a[0]+a[1]*a[1])}function fz(a,t,r,c,u){if(!t[0]&&!t[1])return a;const h=V.convert(t)._mult(u);r==="viewport"&&h._rotate(-c);const m=[];for(let g=0;g<a.length;g++)m.push(a[g].sub(h));return m}function mz(a,t,r,c){const u=V.convert(a)._mult(c);return t==="viewport"&&u._rotate(-r),u}un(cP,"CircleBucket",{omit:["layers"]});const QQ=new xa({"circle-sort-key":new _n(at.layout_circle["circle-sort-key"]),visibility:new Zt(at.layout_circle.visibility)});var eee={paint:new xa({"circle-radius":new _n(at.paint_circle["circle-radius"]),"circle-color":new _n(at.paint_circle["circle-color"]),"circle-blur":new _n(at.paint_circle["circle-blur"]),"circle-opacity":new _n(at.paint_circle["circle-opacity"]),"circle-translate":new Zt(at.paint_circle["circle-translate"]),"circle-translate-anchor":new Zt(at.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Zt(at.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Zt(at.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new _n(at.paint_circle["circle-stroke-width"]),"circle-stroke-color":new _n(at.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new _n(at.paint_circle["circle-stroke-opacity"]),"circle-emissive-strength":new Zt(at.paint_circle["circle-emissive-strength"])}),layout:QQ};const tee=rt.create(),nee=(a,t,r,c,u,h)=>{const m=a.transform,g=m.projection.name==="globe";let v;if(h.paint.get("circle-pitch-alignment")==="map")if(g){const w=JN(m.zoom,t.canonical)*m._pixelsPerMercatorPixel;v=Float32Array.from([w,0,0,w])}else v=m.calculatePixelsToTileUnitsMatrix(r);else v=new Float32Array([m.pixelsToGLUnits[0],0,0,m.pixelsToGLUnits[1]]);const b={u_camera_to_center_distance:a.transform.getCameraToCenterDistance(m.projection),u_matrix:a.translatePosMatrix(t.projMatrix,r,h.paint.get("circle-translate"),h.paint.get("circle-translate-anchor")),u_device_pixel_ratio:Cn.devicePixelRatio,u_extrude_scale:v,u_inv_rot_matrix:tee,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0],u_emissive_strength:h.paint.get("circle-emissive-strength")};if(g){b.u_inv_rot_matrix=c,b.u_merc_center=u,b.u_tile_id=[t.canonical.x,t.canonical.y,1<<t.canonical.z],b.u_zoom_transition=yo(m.zoom);const w=u[0]*mt,A=u[1]*mt;b.u_up_dir=m.projection.upVector(new ju(0,0,0),w,A)}return b},gz=a=>{const t=[];return a.paint.get("circle-pitch-alignment")==="map"&&t.push("PITCH_WITH_MAP"),a.paint.get("circle-pitch-scale")==="map"&&t.push("SCALE_WITH_MAP"),t};function yz(a,t,r,c,u,h,m,g,v){if(h&&a.queryGeometry.isAboveHorizon)return!1;h&&(v*=a.pixelToTileUnitsFactor);const b=a.tileID.canonical,w=r.projection.upVectorScale(b,r.center.lat,r.worldSize).metersToTile;for(const A of t)for(const C of A){const P=C.add(g),k=u&&r.elevation?r.elevation.exaggeration()*u.getElevationAt(P.x,P.y,!0):0,z=r.projection.projectTilePoint(P.x,P.y,b);if(k>0){const Z=r.projection.upVector(b,P.x,P.y);z.x+=Z[0]*w*k,z.y+=Z[1]*w*k,z.z+=Z[2]*w*k}const U=h?P:iee(z.x,z.y,z.z,c),W=h?a.tilespaceRays.map(Z=>ree(Z,k)):a.queryGeometry.screenGeometry,$=Hi.transformMat4([],[z.x,z.y,z.z,1],c);if(!m&&h?v*=$[3]/r.cameraToCenterDistance:m&&!h&&(v*=r.cameraToCenterDistance/$[3]),h){const Z=yr((C.y/mt+b.y)/(1<<b.z));v/=r.projection.pixelsPerMeter(Z,1)/$i(1,Z)}if(XQ(W,U,v))return!0}return!1}function iee(a,t,r,c){const u=Hi.transformMat4([],[a,t,r,1],c);return new V(u[0]/u[3],u[1]/u[3])}const vz=ke.fromValues(0,0,0),aee=ke.fromValues(0,0,1);function ree(a,t){const r=ke.create();return vz[2]=t,a.intersectsPlane(vz,aee,r),new V(r[0],r[1])}class _z extends cP{}function bz(a,{width:t,height:r},c,u){if(u){if(u instanceof Uint8ClampedArray)u=new Uint8Array(u.buffer);else if(u.length!==t*r*c)throw new RangeError("mismatched image size")}else u=new Uint8Array(t*r*c);return a.width=t,a.height=r,a.data=u,a}function xz(a,t,r){const{width:c,height:u}=t;c===a.width&&u===a.height||(pP(a,t,{x:0,y:0},{x:0,y:0},{width:Math.min(a.width,c),height:Math.min(a.height,u)},r),a.width=c,a.height=u,a.data=t.data)}function pP(a,t,r,c,u,h){if(u.width===0||u.height===0)return t;if(u.width>a.width||u.height>a.height||r.x>a.width-u.width||r.y>a.height-u.height)throw new RangeError("out of range source coordinates for image copy");if(u.width>t.width||u.height>t.height||c.x>t.width-u.width||c.y>t.height-u.height)throw new RangeError("out of range destination coordinates for image copy");const m=a.data,g=t.data;for(let v=0;v<u.height;v++){const b=((r.y+v)*a.width+r.x)*h,w=((c.y+v)*t.width+c.x)*h;for(let A=0;A<u.width*h;A++)g[w+A]=m[b+A]}return t}un(_z,"HeatmapBucket",{omit:["layers"]});class oh{constructor(t,r){bz(this,t,1,r)}resize(t){xz(this,new oh(t),1)}clone(){return new oh({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,r,c,u,h){pP(t,r,c,u,h,1)}}class Xa{constructor(t,r){bz(this,t,4,r)}resize(t){xz(this,new Xa(t),4)}replace(t,r){r?this.data.set(t):this.data=t instanceof Uint8ClampedArray?new Uint8Array(t.buffer):t}clone(){return new Xa({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,r,c,u,h){pP(t,r,c,u,h,4)}}class wz{constructor(t,r){this.width=t.width,this.height=t.height,this.data=r instanceof Uint8Array?new Float32Array(r.buffer):r}}un(oh,"AlphaImage"),un(Xa,"RGBAImage");const oee=new xa({visibility:new Zt(at.layout_heatmap.visibility)});var see={paint:new xa({"heatmap-radius":new _n(at.paint_heatmap["heatmap-radius"]),"heatmap-weight":new _n(at.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Zt(at.paint_heatmap["heatmap-intensity"]),"heatmap-color":new _m(at.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Zt(at.paint_heatmap["heatmap-opacity"])}),layout:oee};function V2(a){const t={},r=a.resolution||256,c=a.clips?a.clips.length:1,u=a.image||new Xa({width:r,height:c}),h=(m,g,v)=>{t[a.evaluationKey]=v;const b=a.expression.evaluate(t);b&&(u.data[m+g+0]=Math.floor(255*b.r/b.a),u.data[m+g+1]=Math.floor(255*b.g/b.a),u.data[m+g+2]=Math.floor(255*b.b/b.a),u.data[m+g+3]=Math.floor(255*b.a))};if(a.clips)for(let m=0,g=0;m<c;++m,g+=4*r)for(let v=0,b=0;v<r;v++,b+=4){const w=v/(r-1),{start:A,end:C}=a.clips[m];h(g,b,A*(1-w)+C*w)}else for(let m=0,g=0;m<r;m++,g+=4)h(0,g,m/(r-1));return u}const lee=new xa({visibility:new Zt(at.layout_hillshade.visibility)});var cee={paint:new xa({"hillshade-illumination-direction":new Zt(at.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Zt(at.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Zt(at.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Zt(at.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Zt(at.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Zt(at.paint_hillshade["hillshade-accent-color"]),"hillshade-emissive-strength":new Zt(at.paint_hillshade["hillshade-emissive-strength"])}),layout:lee};const uee=B([{name:"a_pos",components:2,type:"Int16"}],4),{members:dee}=uee;var fP={exports:{}};function G2(a,t,r){r=r||2;var c,u,h,m,g,v,b,w=t&&t.length,A=w?t[0]*r:a.length,C=Sz(a,0,A,r,!0),P=[];if(!C||C.next===C.prev)return P;if(w&&(C=function(z,U,W,$){var Z,K,q,J=[];for(Z=0,K=U.length;Z<K;Z++)(q=Sz(z,U[Z]*$,Z<K-1?U[Z+1]*$:z.length,$,!1))===q.next&&(q.steiner=!0),J.push(_ee(q));for(J.sort(gee),Z=0;Z<J.length;Z++)W=yee(J[Z],W);return W}(a,t,C,r)),a.length>80*r){c=h=a[0],u=m=a[1];for(var k=r;k<A;k+=r)(g=a[k])<c&&(c=g),(v=a[k+1])<u&&(u=v),g>h&&(h=g),v>m&&(m=v);b=(b=Math.max(h-c,m-u))!==0?32767/b:0}return f1(C,P,r,c,u,b,0),P}function Sz(a,t,r,c,u){var h,m;if(u===yP(a,t,r,c)>0)for(h=t;h<r;h+=c)m=Mz(h,a[h],a[h+1],m);else for(h=r-c;h>=t;h-=c)m=Mz(h,a[h],a[h+1],m);return m&&H2(m,m.next)&&(g1(m),m=m.next),m}function Am(a,t){if(!a)return a;t||(t=a);var r,c=a;do if(r=!1,c.steiner||!H2(c,c.next)&&Pr(c.prev,c,c.next)!==0)c=c.next;else{if(g1(c),(c=t=c.prev)===c.next)break;r=!0}while(r||c!==t);return t}function f1(a,t,r,c,u,h,m){if(a){!m&&h&&function(w,A,C,P){var k=w;do k.z===0&&(k.z=mP(k.x,k.y,A,C,P)),k.prevZ=k.prev,k.nextZ=k.next,k=k.next;while(k!==w);k.prevZ.nextZ=null,k.prevZ=null,function(z){var U,W,$,Z,K,q,J,re,ce=1;do{for(W=z,z=null,K=null,q=0;W;){for(q++,$=W,J=0,U=0;U<ce&&(J++,$=$.nextZ);U++);for(re=ce;J>0||re>0&&$;)J!==0&&(re===0||!$||W.z<=$.z)?(Z=W,W=W.nextZ,J--):(Z=$,$=$.nextZ,re--),K?K.nextZ=Z:z=Z,Z.prevZ=K,K=Z;W=$}K.nextZ=null,ce*=2}while(q>1)}(k)}(a,c,u,h);for(var g,v,b=a;a.prev!==a.next;)if(g=a.prev,v=a.next,h?pee(a,c,u,h):hee(a))t.push(g.i/r|0),t.push(a.i/r|0),t.push(v.i/r|0),g1(a),a=v.next,b=v.next;else if((a=v)===b){m?m===1?f1(a=fee(Am(a),t,r),t,r,c,u,h,2):m===2&&mee(a,t,r,c,u,h):f1(Am(a),t,r,c,u,h,1);break}}}function hee(a){var t=a.prev,r=a,c=a.next;if(Pr(t,r,c)>=0)return!1;for(var u=t.x,h=r.x,m=c.x,g=t.y,v=r.y,b=c.y,w=u<h?u<m?u:m:h<m?h:m,A=g<v?g<b?g:b:v<b?v:b,C=u>h?u>m?u:m:h>m?h:m,P=g>v?g>b?g:b:v>b?v:b,k=c.next;k!==t;){if(k.x>=w&&k.x<=C&&k.y>=A&&k.y<=P&&uv(u,g,h,v,m,b,k.x,k.y)&&Pr(k.prev,k,k.next)>=0)return!1;k=k.next}return!0}function pee(a,t,r,c){var u=a.prev,h=a,m=a.next;if(Pr(u,h,m)>=0)return!1;for(var g=u.x,v=h.x,b=m.x,w=u.y,A=h.y,C=m.y,P=g<v?g<b?g:b:v<b?v:b,k=w<A?w<C?w:C:A<C?A:C,z=g>v?g>b?g:b:v>b?v:b,U=w>A?w>C?w:C:A>C?A:C,W=mP(P,k,t,r,c),$=mP(z,U,t,r,c),Z=a.prevZ,K=a.nextZ;Z&&Z.z>=W&&K&&K.z<=$;){if(Z.x>=P&&Z.x<=z&&Z.y>=k&&Z.y<=U&&Z!==u&&Z!==m&&uv(g,w,v,A,b,C,Z.x,Z.y)&&Pr(Z.prev,Z,Z.next)>=0||(Z=Z.prevZ,K.x>=P&&K.x<=z&&K.y>=k&&K.y<=U&&K!==u&&K!==m&&uv(g,w,v,A,b,C,K.x,K.y)&&Pr(K.prev,K,K.next)>=0))return!1;K=K.nextZ}for(;Z&&Z.z>=W;){if(Z.x>=P&&Z.x<=z&&Z.y>=k&&Z.y<=U&&Z!==u&&Z!==m&&uv(g,w,v,A,b,C,Z.x,Z.y)&&Pr(Z.prev,Z,Z.next)>=0)return!1;Z=Z.prevZ}for(;K&&K.z<=$;){if(K.x>=P&&K.x<=z&&K.y>=k&&K.y<=U&&K!==u&&K!==m&&uv(g,w,v,A,b,C,K.x,K.y)&&Pr(K.prev,K,K.next)>=0)return!1;K=K.nextZ}return!0}function fee(a,t,r){var c=a;do{var u=c.prev,h=c.next.next;!H2(u,h)&&Az(u,c,c.next,h)&&m1(u,h)&&m1(h,u)&&(t.push(u.i/r|0),t.push(c.i/r|0),t.push(h.i/r|0),g1(c),g1(c.next),c=a=h),c=c.next}while(c!==a);return Am(c)}function mee(a,t,r,c,u,h){var m=a;do{for(var g=m.next.next;g!==m.prev;){if(m.i!==g.i&&bee(m,g)){var v=Ez(m,g);return m=Am(m,m.next),v=Am(v,v.next),f1(m,t,r,c,u,h,0),void f1(v,t,r,c,u,h,0)}g=g.next}m=m.next}while(m!==a)}function gee(a,t){return a.x-t.x}function yee(a,t){var r=function(u,h){var m,g=h,v=u.x,b=u.y,w=-1/0;do{if(b<=g.y&&b>=g.next.y&&g.next.y!==g.y){var A=g.x+(b-g.y)*(g.next.x-g.x)/(g.next.y-g.y);if(A<=v&&A>w&&(w=A,m=g.x<g.next.x?g:g.next,A===v))return m}g=g.next}while(g!==h);if(!m)return null;var C,P=m,k=m.x,z=m.y,U=1/0;g=m;do v>=g.x&&g.x>=k&&v!==g.x&&uv(b<z?v:w,b,k,z,b<z?w:v,b,g.x,g.y)&&(C=Math.abs(b-g.y)/(v-g.x),m1(g,u)&&(C<U||C===U&&(g.x>m.x||g.x===m.x&&vee(m,g)))&&(m=g,U=C)),g=g.next;while(g!==P);return m}(a,t);if(!r)return t;var c=Ez(r,a);return Am(c,c.next),Am(r,r.next)}function vee(a,t){return Pr(a.prev,a,t.prev)<0&&Pr(t.next,a,a.next)<0}function mP(a,t,r,c,u){return(a=1431655765&((a=858993459&((a=252645135&((a=16711935&((a=(a-r)*u|0)|a<<8))|a<<4))|a<<2))|a<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-c)*u|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function _ee(a){var t=a,r=a;do(t.x<r.x||t.x===r.x&&t.y<r.y)&&(r=t),t=t.next;while(t!==a);return r}function uv(a,t,r,c,u,h,m,g){return(u-m)*(t-g)>=(a-m)*(h-g)&&(a-m)*(c-g)>=(r-m)*(t-g)&&(r-m)*(h-g)>=(u-m)*(c-g)}function bee(a,t){return a.next.i!==t.i&&a.prev.i!==t.i&&!function(r,c){var u=r;do{if(u.i!==r.i&&u.next.i!==r.i&&u.i!==c.i&&u.next.i!==c.i&&Az(u,u.next,r,c))return!0;u=u.next}while(u!==r);return!1}(a,t)&&(m1(a,t)&&m1(t,a)&&function(r,c){var u=r,h=!1,m=(r.x+c.x)/2,g=(r.y+c.y)/2;do u.y>g!=u.next.y>g&&u.next.y!==u.y&&m<(u.next.x-u.x)*(g-u.y)/(u.next.y-u.y)+u.x&&(h=!h),u=u.next;while(u!==r);return h}(a,t)&&(Pr(a.prev,a,t.prev)||Pr(a,t.prev,t))||H2(a,t)&&Pr(a.prev,a,a.next)>0&&Pr(t.prev,t,t.next)>0)}function Pr(a,t,r){return(t.y-a.y)*(r.x-t.x)-(t.x-a.x)*(r.y-t.y)}function H2(a,t){return a.x===t.x&&a.y===t.y}function Az(a,t,r,c){var u=$2(Pr(a,t,r)),h=$2(Pr(a,t,c)),m=$2(Pr(r,c,a)),g=$2(Pr(r,c,t));return u!==h&&m!==g||!(u!==0||!j2(a,r,t))||!(h!==0||!j2(a,c,t))||!(m!==0||!j2(r,a,c))||!(g!==0||!j2(r,t,c))}function j2(a,t,r){return t.x<=Math.max(a.x,r.x)&&t.x>=Math.min(a.x,r.x)&&t.y<=Math.max(a.y,r.y)&&t.y>=Math.min(a.y,r.y)}function $2(a){return a>0?1:a<0?-1:0}function m1(a,t){return Pr(a.prev,a,a.next)<0?Pr(a,t,a.next)>=0&&Pr(a,a.prev,t)>=0:Pr(a,t,a.prev)<0||Pr(a,a.next,t)<0}function Ez(a,t){var r=new gP(a.i,a.x,a.y),c=new gP(t.i,t.x,t.y),u=a.next,h=t.prev;return a.next=t,t.prev=a,r.next=u,u.prev=r,c.next=r,r.prev=c,h.next=c,c.prev=h,c}function Mz(a,t,r,c){var u=new gP(a,t,r);return c?(u.next=c.next,u.prev=c,c.next.prev=u,c.next=u):(u.prev=u,u.next=u),u}function g1(a){a.next.prev=a.prev,a.prev.next=a.next,a.prevZ&&(a.prevZ.nextZ=a.nextZ),a.nextZ&&(a.nextZ.prevZ=a.prevZ)}function gP(a,t,r){this.i=a,this.x=t,this.y=r,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function yP(a,t,r,c){for(var u=0,h=t,m=r-c;h<r;h+=c)u+=(a[m]-a[h])*(a[h+1]+a[m+1]),m=h;return u}fP.exports=G2,fP.exports.default=G2,G2.deviation=function(a,t,r,c){var u=t&&t.length,h=Math.abs(yP(a,0,u?t[0]*r:a.length,r));if(u)for(var m=0,g=t.length;m<g;m++)h-=Math.abs(yP(a,t[m]*r,m<g-1?t[m+1]*r:a.length,r));var v=0;for(m=0;m<c.length;m+=3){var b=c[m]*r,w=c[m+1]*r,A=c[m+2]*r;v+=Math.abs((a[b]-a[A])*(a[w+1]-a[b+1])-(a[b]-a[w])*(a[A+1]-a[b+1]))}return h===0&&v===0?0:Math.abs((v-h)/h)},G2.flatten=function(a){for(var t=a[0][0].length,r={vertices:[],holes:[],dimensions:t},c=0,u=0;u<a.length;u++){for(var h=0;h<a[u].length;h++)for(var m=0;m<t;m++)r.vertices.push(a[u][h][m]);u>0&&r.holes.push(c+=a[u-1].length)}return r};var Y2=N(fP.exports);function vP(a,t){const r=a.length;if(r<=1)return[a];const c=[];let u,h;for(let m=0;m<r;m++){const g=De(a[m]);g!==0&&(a[m].area=Math.abs(g),h===void 0&&(h=g<0),h===g<0?(u&&c.push(u),u=[a[m]]):u.push(a[m]))}if(u&&c.push(u),t>1)for(let m=0;m<c.length;m++)c[m].length<=t||(Oc(c[m],t,1,c[m].length-1,xee),c[m]=c[m].slice(0,t));return c}function xee(a,t){return t.area-a.area}function _P(a,t,r){const c=r.patternDependencies;let u=!1;for(const h of t){const m=h.paint.get(`${a}-pattern`);m.isConstant()||(u=!0);const g=m.constantOr(null);g&&(u=!0,c[g]=!0)}return u}function bP(a,t,r,c,u){const h=u.patternDependencies;for(const m of t){const g=m.paint.get(`${a}-pattern`).value;if(g.kind!=="constant"){let v=g.evaluate({zoom:c},r,{},u.availableImages);v=v&&v.name?v.name:v,h[v]=!0,r.patterns[m.id]=v}}return r}class q2{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(r=>r.fqid),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new ee,this.indexArray=new Fn,this.indexArray2=new eo,this.programConfigurations=new yp(t.layers,t.zoom),this.segments=new ji,this.segments2=new ji,this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id),this.projection=t.projection}populate(t,r,c,u){this.hasPattern=_P("fill",this.layers,r);const h=this.layers[0].layout.get("fill-sort-key"),m=[];for(const{feature:g,id:v,index:b,sourceLayerIndex:w}of t){const A=this.layers[0]._featureFilter.needGeometry,C=Sp(g,A);if(!this.layers[0]._featureFilter.filter(new sa(this.zoom),C,c))continue;const P=h?h.evaluate(C,{},c,r.availableImages):void 0,k={id:v,properties:g.properties,type:g.type,sourceLayerIndex:w,index:b,geometry:A?C.geometry:$u(g,c,u),patterns:{},sortKey:P};m.push(k)}h&&m.sort((g,v)=>g.sortKey-v.sortKey);for(const g of m){const{geometry:v,index:b,sourceLayerIndex:w}=g;if(this.hasPattern){const A=bP("fill",this.layers,g,this.zoom,r);this.patternFeatures.push(A)}else this.addFeature(g,v,b,c,{},r.availableImages,r.brightness);r.featureIndex.insert(t[b].feature,v,b,w,this.index)}}update(t,r,c,u,h){const m=Object.keys(t).length!==0;m&&!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(t,r,m?this.stateDependentLayers:this.layers,c,u,h)}addFeatures(t,r,c,u,h,m){for(const g of this.patternFeatures)this.addFeature(g,g.geometry,g.index,r,c,u,m)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,dee),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.indexBuffer2=t.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(t,r,c,u,h,m=[],g){for(const v of vP(r,500)){let b=0;for(const z of v)b+=z.length;const w=this.segments.prepareSegment(b,this.layoutVertexArray,this.indexArray),A=w.vertexLength,C=[],P=[];for(const z of v){if(z.length===0)continue;z!==v[0]&&P.push(C.length/2);const U=this.segments2.prepareSegment(z.length,this.layoutVertexArray,this.indexArray2),W=U.vertexLength;this.layoutVertexArray.emplaceBack(z[0].x,z[0].y),this.indexArray2.emplaceBack(W+z.length-1,W),C.push(z[0].x),C.push(z[0].y);for(let $=1;$<z.length;$++)this.layoutVertexArray.emplaceBack(z[$].x,z[$].y),this.indexArray2.emplaceBack(W+$-1,W+$),C.push(z[$].x),C.push(z[$].y);U.vertexLength+=z.length,U.primitiveLength+=z.length}const k=Y2(C,P);for(let z=0;z<k.length;z+=3)this.indexArray.emplaceBack(A+k[z],A+k[z+1],A+k[z+2]);w.vertexLength+=b,w.primitiveLength+=k.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,c,h,m,u,g)}}un(q2,"FillBucket",{omit:["layers","patternFeatures"]});const wee=new xa({"fill-sort-key":new _n(at.layout_fill["fill-sort-key"]),visibility:new Zt(at.layout_fill.visibility)});var See={paint:new xa({"fill-antialias":new Zt(at.paint_fill["fill-antialias"]),"fill-opacity":new _n(at.paint_fill["fill-opacity"]),"fill-color":new _n(at.paint_fill["fill-color"]),"fill-outline-color":new _n(at.paint_fill["fill-outline-color"]),"fill-translate":new Zt(at.paint_fill["fill-translate"]),"fill-translate-anchor":new Zt(at.paint_fill["fill-translate-anchor"]),"fill-pattern":new _n(at.paint_fill["fill-pattern"]),"fill-emissive-strength":new Zt(at.paint_fill["fill-emissive-strength"])}),layout:wee};const Aee=B([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),Eee=B([{name:"a_pos_end",components:4,type:"Int16"},{name:"a_angular_offset_factor",components:1,type:"Int16"}]),Mee=B([{name:"a_centroid_pos",components:2,type:"Uint16"}]),Tee=B([{name:"a_hidden_by_landmark",components:1,type:"Uint8"}]),Cee=B([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:Pee}=Aee;var X2={},Iee=Y,Tz=dv;function dv(a,t,r,c,u){this.properties={},this.extent=r,this.type=0,this._pbf=a,this._geometry=-1,this._keys=c,this._values=u,a.readFields(Lee,this,t)}function Lee(a,t,r){a==1?t.id=r.readVarint():a==2?function(c,u){for(var h=c.readVarint()+c.pos;c.pos<h;){var m=u._keys[c.readVarint()],g=u._values[c.readVarint()];u.properties[m]=g}}(r,t):a==3?t.type=r.readVarint():a==4&&(t._geometry=r.pos)}function Ree(a){for(var t,r,c=0,u=0,h=a.length,m=h-1;u<h;m=u++)c+=((r=a[m]).x-(t=a[u]).x)*(t.y+r.y);return c}dv.types=["Unknown","Point","LineString","Polygon"],dv.prototype.loadGeometry=function(){var a=this._pbf;a.pos=this._geometry;for(var t,r=a.readVarint()+a.pos,c=1,u=0,h=0,m=0,g=[];a.pos<r;){if(u<=0){var v=a.readVarint();c=7&v,u=v>>3}if(u--,c===1||c===2)h+=a.readSVarint(),m+=a.readSVarint(),c===1&&(t&&g.push(t),t=[]),t.push(new Iee(h,m));else{if(c!==7)throw new Error("unknown command "+c);t&&t.push(t[0].clone())}}return t&&g.push(t),g},dv.prototype.bbox=function(){var a=this._pbf;a.pos=this._geometry;for(var t=a.readVarint()+a.pos,r=1,c=0,u=0,h=0,m=1/0,g=-1/0,v=1/0,b=-1/0;a.pos<t;){if(c<=0){var w=a.readVarint();r=7&w,c=w>>3}if(c--,r===1||r===2)(u+=a.readSVarint())<m&&(m=u),u>g&&(g=u),(h+=a.readSVarint())<v&&(v=h),h>b&&(b=h);else if(r!==7)throw new Error("unknown command "+r)}return[m,v,g,b]},dv.prototype.toGeoJSON=function(a,t,r){var c,u,h=this.extent*Math.pow(2,r),m=this.extent*a,g=this.extent*t,v=this.loadGeometry(),b=dv.types[this.type];function w(P){for(var k=0;k<P.length;k++){var z=P[k];P[k]=[360*(z.x+m)/h-180,360/Math.PI*Math.atan(Math.exp((180-360*(z.y+g)/h)*Math.PI/180))-90]}}switch(this.type){case 1:var A=[];for(c=0;c<v.length;c++)A[c]=v[c][0];w(v=A);break;case 2:for(c=0;c<v.length;c++)w(v[c]);break;case 3:for(v=function(P){var k=P.length;if(k<=1)return[P];for(var z,U,W=[],$=0;$<k;$++){var Z=Ree(P[$]);Z!==0&&(U===void 0&&(U=Z<0),U===Z<0?(z&&W.push(z),z=[P[$]]):z.push(P[$]))}return z&&W.push(z),W}(v),c=0;c<v.length;c++)for(u=0;u<v[c].length;u++)w(v[c][u])}v.length===1?v=v[0]:b="Multi"+b;var C={type:"Feature",geometry:{type:b,coordinates:v},properties:this.properties};return"id"in this&&(C.id=this.id),C};var kee=Tz,Cz=Pz;function Pz(a,t){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=a,this._keys=[],this._values=[],this._features=[],a.readFields(Dee,this,t),this.length=this._features.length}function Dee(a,t,r){a===15?t.version=r.readVarint():a===1?t.name=r.readString():a===5?t.extent=r.readVarint():a===2?t._features.push(r.pos):a===3?t._keys.push(r.readString()):a===4&&t._values.push(function(c){for(var u=null,h=c.readVarint()+c.pos;c.pos<h;){var m=c.readVarint()>>3;u=m===1?c.readString():m===2?c.readFloat():m===3?c.readDouble():m===4?c.readVarint64():m===5?c.readVarint():m===6?c.readSVarint():m===7?c.readBoolean():null}return u}(r))}Pz.prototype.feature=function(a){if(a<0||a>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[a];var t=this._pbf.readVarint()+this._pbf.pos;return new kee(this._pbf,t,this.extent,this._keys,this._values)};var Oee=Cz;function Nee(a,t,r){if(a===3){var c=new Oee(r,r.readVarint()+r.pos);c.length&&(t[c.name]=c)}}var xP=X2.VectorTile=function(a,t){this.layers=a.readFields(Nee,{},t)},Z2=X2.VectorTileFeature=Tz;function K2(a,t,r,c){const u=[],h=c===0?(m,g,v,b,w,A)=>{m.push(new V(A,v+(A-g)/(b-g)*(w-v)))}:(m,g,v,b,w,A)=>{m.push(new V(g+(A-v)/(w-v)*(b-g),A))};for(const m of a){const g=[];for(const v of m){if(v.length<=2)continue;const b=[];for(let C=0;C<v.length-1;C++){const P=v[C].x,k=v[C].y,z=v[C+1].x,U=v[C+1].y,W=c===0?P:k,$=c===0?z:U;W<t?$>t&&h(b,P,k,z,U,t):W>r?$<r&&h(b,P,k,z,U,r):b.push(v[C]),$<t&&W>=t&&h(b,P,k,z,U,t),$>r&&W<=r&&h(b,P,k,z,U,r)}let w=v[v.length-1];const A=c===0?w.x:w.y;A>=t&&A<=r&&b.push(w),b.length&&(w=b[b.length-1],b[0].x===w.x&&b[0].y===w.y||b.push(b[0]),g.push(b))}g.length&&u.push(g)}return u}X2.VectorTileLayer=Cz;class Iz{constructor(t){this._stringToNumber={},this._numberToString=[];for(let r=0;r<t.length;r++){const c=t[r];this._stringToNumber[c]=r,this._numberToString[r]=c}}encode(t){return this._stringToNumber[t]}decode(t){return this._numberToString[t]}}var zee={read:function(a,t,r,c,u){var h,m,g=8*u-c-1,v=(1<<g)-1,b=v>>1,w=-7,A=r?u-1:0,C=r?-1:1,P=a[t+A];for(A+=C,h=P&(1<<-w)-1,P>>=-w,w+=g;w>0;h=256*h+a[t+A],A+=C,w-=8);for(m=h&(1<<-w)-1,h>>=-w,w+=c;w>0;m=256*m+a[t+A],A+=C,w-=8);if(h===0)h=1-b;else{if(h===v)return m?NaN:1/0*(P?-1:1);m+=Math.pow(2,c),h-=b}return(P?-1:1)*m*Math.pow(2,h-c)},write:function(a,t,r,c,u,h){var m,g,v,b=8*h-u-1,w=(1<<b)-1,A=w>>1,C=u===23?Math.pow(2,-24)-Math.pow(2,-77):0,P=c?0:h-1,k=c?1:-1,z=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(g=isNaN(t)?1:0,m=w):(m=Math.floor(Math.log(t)/Math.LN2),t*(v=Math.pow(2,-m))<1&&(m--,v*=2),(t+=m+A>=1?C/v:C*Math.pow(2,1-A))*v>=2&&(m++,v/=2),m+A>=w?(g=0,m=w):m+A>=1?(g=(t*v-1)*Math.pow(2,u),m+=A):(g=t*Math.pow(2,A-1)*Math.pow(2,u),m=0));u>=8;a[r+P]=255&g,P+=k,g/=256,u-=8);for(m=m<<u|g,b+=u;b>0;a[r+P]=255&m,P+=k,m/=256,b-=8);a[r+P-k]|=128*z}},Lz=Sa,J2=zee;function Sa(a){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(a)?a:new Uint8Array(a||0),this.pos=0,this.type=0,this.length=this.buf.length}Sa.Varint=0,Sa.Fixed64=1,Sa.Bytes=2,Sa.Fixed32=5;var wP=4294967296,Rz=1/wP,kz=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function sh(a){return a.type===Sa.Bytes?a.readVarint()+a.pos:a.pos+1}function hv(a,t,r){return r?4294967296*t+(a>>>0):4294967296*(t>>>0)+(a>>>0)}function Dz(a,t,r){var c=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(7*Math.LN2));r.realloc(c);for(var u=r.pos-1;u>=a;u--)r.buf[u+c]=r.buf[u]}function Fee(a,t){for(var r=0;r<a.length;r++)t.writeVarint(a[r])}function Bee(a,t){for(var r=0;r<a.length;r++)t.writeSVarint(a[r])}function Uee(a,t){for(var r=0;r<a.length;r++)t.writeFloat(a[r])}function Wee(a,t){for(var r=0;r<a.length;r++)t.writeDouble(a[r])}function Vee(a,t){for(var r=0;r<a.length;r++)t.writeBoolean(a[r])}function Gee(a,t){for(var r=0;r<a.length;r++)t.writeFixed32(a[r])}function Hee(a,t){for(var r=0;r<a.length;r++)t.writeSFixed32(a[r])}function jee(a,t){for(var r=0;r<a.length;r++)t.writeFixed64(a[r])}function $ee(a,t){for(var r=0;r<a.length;r++)t.writeSFixed64(a[r])}function Q2(a,t){return(a[t]|a[t+1]<<8|a[t+2]<<16)+16777216*a[t+3]}function pv(a,t,r){a[r]=t,a[r+1]=t>>>8,a[r+2]=t>>>16,a[r+3]=t>>>24}function Oz(a,t){return(a[t]|a[t+1]<<8|a[t+2]<<16)+(a[t+3]<<24)}Sa.prototype={destroy:function(){this.buf=null},readFields:function(a,t,r){for(r=r||this.length;this.pos<r;){var c=this.readVarint(),u=c>>3,h=this.pos;this.type=7&c,a(u,t,this),this.pos===h&&this.skip(c)}return t},readMessage:function(a,t){return this.readFields(a,t,this.readVarint()+this.pos)},readFixed32:function(){var a=Q2(this.buf,this.pos);return this.pos+=4,a},readSFixed32:function(){var a=Oz(this.buf,this.pos);return this.pos+=4,a},readFixed64:function(){var a=Q2(this.buf,this.pos)+Q2(this.buf,this.pos+4)*wP;return this.pos+=8,a},readSFixed64:function(){var a=Q2(this.buf,this.pos)+Oz(this.buf,this.pos+4)*wP;return this.pos+=8,a},readFloat:function(){var a=J2.read(this.buf,this.pos,!0,23,4);return this.pos+=4,a},readDouble:function(){var a=J2.read(this.buf,this.pos,!0,52,8);return this.pos+=8,a},readVarint:function(a){var t,r,c=this.buf;return t=127&(r=c[this.pos++]),r<128?t:(t|=(127&(r=c[this.pos++]))<<7,r<128?t:(t|=(127&(r=c[this.pos++]))<<14,r<128?t:(t|=(127&(r=c[this.pos++]))<<21,r<128?t:function(u,h,m){var g,v,b=m.buf;if(g=(112&(v=b[m.pos++]))>>4,v<128||(g|=(127&(v=b[m.pos++]))<<3,v<128)||(g|=(127&(v=b[m.pos++]))<<10,v<128)||(g|=(127&(v=b[m.pos++]))<<17,v<128)||(g|=(127&(v=b[m.pos++]))<<24,v<128)||(g|=(1&(v=b[m.pos++]))<<31,v<128))return hv(u,g,h);throw new Error("Expected varint not more than 10 bytes")}(t|=(15&(r=c[this.pos]))<<28,a,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var a=this.readVarint();return a%2==1?(a+1)/-2:a/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var a=this.readVarint()+this.pos,t=this.pos;return this.pos=a,a-t>=12&&kz?function(r,c,u){return kz.decode(r.subarray(c,u))}(this.buf,t,a):function(r,c,u){for(var h="",m=c;m<u;){var g,v,b,w=r[m],A=null,C=w>239?4:w>223?3:w>191?2:1;if(m+C>u)break;C===1?w<128&&(A=w):C===2?(192&(g=r[m+1]))==128&&(A=(31&w)<<6|63&g)<=127&&(A=null):C===3?(v=r[m+2],(192&(g=r[m+1]))==128&&(192&v)==128&&((A=(15&w)<<12|(63&g)<<6|63&v)<=2047||A>=55296&&A<=57343)&&(A=null)):C===4&&(v=r[m+2],b=r[m+3],(192&(g=r[m+1]))==128&&(192&v)==128&&(192&b)==128&&((A=(15&w)<<18|(63&g)<<12|(63&v)<<6|63&b)<=65535||A>=1114112)&&(A=null)),A===null?(A=65533,C=1):A>65535&&(A-=65536,h+=String.fromCharCode(A>>>10&1023|55296),A=56320|1023&A),h+=String.fromCharCode(A),m+=C}return h}(this.buf,t,a)},readBytes:function(){var a=this.readVarint()+this.pos,t=this.buf.subarray(this.pos,a);return this.pos=a,t},readPackedVarint:function(a,t){if(this.type!==Sa.Bytes)return a.push(this.readVarint(t));var r=sh(this);for(a=a||[];this.pos<r;)a.push(this.readVarint(t));return a},readPackedSVarint:function(a){if(this.type!==Sa.Bytes)return a.push(this.readSVarint());var t=sh(this);for(a=a||[];this.pos<t;)a.push(this.readSVarint());return a},readPackedBoolean:function(a){if(this.type!==Sa.Bytes)return a.push(this.readBoolean());var t=sh(this);for(a=a||[];this.pos<t;)a.push(this.readBoolean());return a},readPackedFloat:function(a){if(this.type!==Sa.Bytes)return a.push(this.readFloat());var t=sh(this);for(a=a||[];this.pos<t;)a.push(this.readFloat());return a},readPackedDouble:function(a){if(this.type!==Sa.Bytes)return a.push(this.readDouble());var t=sh(this);for(a=a||[];this.pos<t;)a.push(this.readDouble());return a},readPackedFixed32:function(a){if(this.type!==Sa.Bytes)return a.push(this.readFixed32());var t=sh(this);for(a=a||[];this.pos<t;)a.push(this.readFixed32());return a},readPackedSFixed32:function(a){if(this.type!==Sa.Bytes)return a.push(this.readSFixed32());var t=sh(this);for(a=a||[];this.pos<t;)a.push(this.readSFixed32());return a},readPackedFixed64:function(a){if(this.type!==Sa.Bytes)return a.push(this.readFixed64());var t=sh(this);for(a=a||[];this.pos<t;)a.push(this.readFixed64());return a},readPackedSFixed64:function(a){if(this.type!==Sa.Bytes)return a.push(this.readSFixed64());var t=sh(this);for(a=a||[];this.pos<t;)a.push(this.readSFixed64());return a},skip:function(a){var t=7&a;if(t===Sa.Varint)for(;this.buf[this.pos++]>127;);else if(t===Sa.Bytes)this.pos=this.readVarint()+this.pos;else if(t===Sa.Fixed32)this.pos+=4;else{if(t!==Sa.Fixed64)throw new Error("Unimplemented type: "+t);this.pos+=8}},writeTag:function(a,t){this.writeVarint(a<<3|t)},realloc:function(a){for(var t=this.length||16;t<this.pos+a;)t*=2;if(t!==this.length){var r=new Uint8Array(t);r.set(this.buf),this.buf=r,this.length=t}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(a){this.realloc(4),pv(this.buf,a,this.pos),this.pos+=4},writeSFixed32:function(a){this.realloc(4),pv(this.buf,a,this.pos),this.pos+=4},writeFixed64:function(a){this.realloc(8),pv(this.buf,-1&a,this.pos),pv(this.buf,Math.floor(a*Rz),this.pos+4),this.pos+=8},writeSFixed64:function(a){this.realloc(8),pv(this.buf,-1&a,this.pos),pv(this.buf,Math.floor(a*Rz),this.pos+4),this.pos+=8},writeVarint:function(a){(a=+a||0)>268435455||a<0?function(t,r){var c,u;if(t>=0?(c=t%4294967296|0,u=t/4294967296|0):(u=~(-t/4294967296),4294967295^(c=~(-t%4294967296))?c=c+1|0:(c=0,u=u+1|0)),t>=18446744073709552e3||t<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");r.realloc(10),function(h,m,g){g.buf[g.pos++]=127&h|128,h>>>=7,g.buf[g.pos++]=127&h|128,h>>>=7,g.buf[g.pos++]=127&h|128,h>>>=7,g.buf[g.pos++]=127&h|128,g.buf[g.pos]=127&(h>>>=7)}(c,0,r),function(h,m){var g=(7&h)<<4;m.buf[m.pos++]|=g|((h>>>=3)?128:0),h&&(m.buf[m.pos++]=127&h|((h>>>=7)?128:0),h&&(m.buf[m.pos++]=127&h|((h>>>=7)?128:0),h&&(m.buf[m.pos++]=127&h|((h>>>=7)?128:0),h&&(m.buf[m.pos++]=127&h|((h>>>=7)?128:0),h&&(m.buf[m.pos++]=127&h)))))}(u,r)}(a,this):(this.realloc(4),this.buf[this.pos++]=127&a|(a>127?128:0),a<=127||(this.buf[this.pos++]=127&(a>>>=7)|(a>127?128:0),a<=127||(this.buf[this.pos++]=127&(a>>>=7)|(a>127?128:0),a<=127||(this.buf[this.pos++]=a>>>7&127))))},writeSVarint:function(a){this.writeVarint(a<0?2*-a-1:2*a)},writeBoolean:function(a){this.writeVarint(!!a)},writeString:function(a){a=String(a),this.realloc(4*a.length),this.pos++;var t=this.pos;this.pos=function(c,u,h){for(var m,g,v=0;v<u.length;v++){if((m=u.charCodeAt(v))>55295&&m<57344){if(!g){m>56319||v+1===u.length?(c[h++]=239,c[h++]=191,c[h++]=189):g=m;continue}if(m<56320){c[h++]=239,c[h++]=191,c[h++]=189,g=m;continue}m=g-55296<<10|m-56320|65536,g=null}else g&&(c[h++]=239,c[h++]=191,c[h++]=189,g=null);m<128?c[h++]=m:(m<2048?c[h++]=m>>6|192:(m<65536?c[h++]=m>>12|224:(c[h++]=m>>18|240,c[h++]=m>>12&63|128),c[h++]=m>>6&63|128),c[h++]=63&m|128)}return h}(this.buf,a,this.pos);var r=this.pos-t;r>=128&&Dz(t,r,this),this.pos=t-1,this.writeVarint(r),this.pos+=r},writeFloat:function(a){this.realloc(4),J2.write(this.buf,a,this.pos,!0,23,4),this.pos+=4},writeDouble:function(a){this.realloc(8),J2.write(this.buf,a,this.pos,!0,52,8),this.pos+=8},writeBytes:function(a){var t=a.length;this.writeVarint(t),this.realloc(t);for(var r=0;r<t;r++)this.buf[this.pos++]=a[r]},writeRawMessage:function(a,t){this.pos++;var r=this.pos;a(t,this);var c=this.pos-r;c>=128&&Dz(r,c,this),this.pos=r-1,this.writeVarint(c),this.pos+=c},writeMessage:function(a,t,r){this.writeTag(a,Sa.Bytes),this.writeRawMessage(t,r)},writePackedVarint:function(a,t){t.length&&this.writeMessage(a,Fee,t)},writePackedSVarint:function(a,t){t.length&&this.writeMessage(a,Bee,t)},writePackedBoolean:function(a,t){t.length&&this.writeMessage(a,Vee,t)},writePackedFloat:function(a,t){t.length&&this.writeMessage(a,Uee,t)},writePackedDouble:function(a,t){t.length&&this.writeMessage(a,Wee,t)},writePackedFixed32:function(a,t){t.length&&this.writeMessage(a,Gee,t)},writePackedSFixed32:function(a,t){t.length&&this.writeMessage(a,Hee,t)},writePackedFixed64:function(a,t){t.length&&this.writeMessage(a,jee,t)},writePackedSFixed64:function(a,t){t.length&&this.writeMessage(a,$ee,t)},writeBytesField:function(a,t){this.writeTag(a,Sa.Bytes),this.writeBytes(t)},writeFixed32Field:function(a,t){this.writeTag(a,Sa.Fixed32),this.writeFixed32(t)},writeSFixed32Field:function(a,t){this.writeTag(a,Sa.Fixed32),this.writeSFixed32(t)},writeFixed64Field:function(a,t){this.writeTag(a,Sa.Fixed64),this.writeFixed64(t)},writeSFixed64Field:function(a,t){this.writeTag(a,Sa.Fixed64),this.writeSFixed64(t)},writeVarintField:function(a,t){this.writeTag(a,Sa.Varint),this.writeVarint(t)},writeSVarintField:function(a,t){this.writeTag(a,Sa.Varint),this.writeSVarint(t)},writeStringField:function(a,t){this.writeTag(a,Sa.Bytes),this.writeString(t)},writeFloatField:function(a,t){this.writeTag(a,Sa.Fixed32),this.writeFloat(t)},writeDoubleField:function(a,t){this.writeTag(a,Sa.Fixed64),this.writeDouble(t)},writeBooleanField:function(a,t){this.writeVarintField(a,!!t)}};var e3=N(Lz);const Yee=["tile","layer","source","sourceLayer","state"];class Nz{constructor(t,r,c,u,h){this.type="Feature",this._vectorTileFeature=t,this._z=r,this._x=c,this._y=u,this.properties=t.properties,this.id=h}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(t){this._geometry=t}toJSON(){const t={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};this.id!==void 0&&(t.id=this.id);for(const r of Yee)this[r]!==void 0&&(t[r]=this[r]);return t}}class qee{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(t,r,c){const u=String(r);if(this.stateChanges[t]=this.stateChanges[t]||{},this.stateChanges[t][u]=this.stateChanges[t][u]||{},Fe(this.stateChanges[t][u],c),this.deletedStates[t]===null){this.deletedStates[t]={};for(const h in this.state[t])h!==u&&(this.deletedStates[t][h]=null)}else if(this.deletedStates[t]&&this.deletedStates[t][u]===null){this.deletedStates[t][u]={};for(const h in this.state[t][u])c[h]||(this.deletedStates[t][u][h]=null)}else for(const h in c)this.deletedStates[t]&&this.deletedStates[t][u]&&this.deletedStates[t][u][h]===null&&delete this.deletedStates[t][u][h]}removeFeatureState(t,r,c){if(this.deletedStates[t]===null)return;const u=String(r);if(this.deletedStates[t]=this.deletedStates[t]||{},c&&r!==void 0)this.deletedStates[t][u]!==null&&(this.deletedStates[t][u]=this.deletedStates[t][u]||{},this.deletedStates[t][u][c]=null);else if(r!==void 0)if(this.stateChanges[t]&&this.stateChanges[t][u])for(c in this.deletedStates[t][u]={},this.stateChanges[t][u])this.deletedStates[t][u][c]=null;else this.deletedStates[t][u]=null;else this.deletedStates[t]=null}getState(t,r){const c=String(r),u=Fe({},(this.state[t]||{})[c],(this.stateChanges[t]||{})[c]);if(this.deletedStates[t]===null)return{};if(this.deletedStates[t]){const h=this.deletedStates[t][r];if(h===null)return{};for(const m in h)delete u[m]}return u}initializeTileState(t,r){t.setFeatureState(this.state,r)}coalesceChanges(t,r){const c={};for(const u in this.stateChanges){this.state[u]=this.state[u]||{};const h={};for(const m in this.stateChanges[u])this.state[u][m]||(this.state[u][m]={}),Fe(this.state[u][m],this.stateChanges[u][m]),h[m]=this.state[u][m];c[u]=h}for(const u in this.deletedStates){this.state[u]=this.state[u]||{};const h={};if(this.deletedStates[u]===null)for(const m in this.state[u])h[m]={},this.state[u][m]={};else for(const m in this.deletedStates[u]){if(this.deletedStates[u][m]===null)this.state[u][m]={};else if(this.state[u][m])for(const g of Object.keys(this.deletedStates[u][m]))delete this.state[u][m][g];h[m]=this.state[u][m]}c[u]=c[u]||{},Fe(c[u],h)}if(this.stateChanges={},this.deletedStates={},Object.keys(c).length!==0)for(const u in t)t[u].setFeatureState(c,r)}}class zz{constructor(t){this.size=t,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(t,r){const c=this.toIdx(t,r);return{min:this.minimums[c],max:this.maximums[c]}}isLeaf(t,r){return this.leaves[this.toIdx(t,r)]}toIdx(t,r){return r*this.size+t}}function Fz(a,t,r,c){let u=0,h=Number.MAX_VALUE;for(let m=0;m<3;m++)if(Math.abs(c[m])<1e-15){if(r[m]<a[m]||r[m]>t[m])return null}else{const g=1/c[m];let v=(a[m]-r[m])*g,b=(t[m]-r[m])*g;if(v>b){const w=v;v=b,b=w}if(v>u&&(u=v),b<h&&(h=b),u>h)return null}return u}function Bz(a,t,r,c,u,h,m,g,v,b,w){const A=c-a,C=u-t,P=h-r,k=m-a,z=g-t,U=v-r,W=w[1]*U-w[2]*z,$=w[2]*k-w[0]*U,Z=w[0]*z-w[1]*k,K=A*W+C*$+P*Z;if(Math.abs(K)<1e-15)return null;const q=1/K,J=b[0]-a,re=b[1]-t,ce=b[2]-r,ge=(J*W+re*$+ce*Z)*q;if(ge<0||ge>1)return null;const ve=re*P-ce*C,Ce=ce*A-J*P,Ae=J*C-re*A,Le=(w[0]*ve+w[1]*Ce+w[2]*Ae)*q;return Le<0||ge+Le>1?null:(k*ve+z*Ce+U*Ae)*q}function Uz(a,t,r){return(a-t)/(r-t)}function Wz(a,t,r,c,u,h,m,g,v){const b=1<<r,w=h-c,A=m-u,C=(a+1)/b*w+c,P=(t+0)/b*A+u,k=(t+1)/b*A+u;g[0]=(a+0)/b*w+c,g[1]=P,v[0]=C,v[1]=k}class Vz{constructor(t){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=t,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const r=function(h){const m=Math.ceil(Math.log2(h.dim/8)),g=[];let v=Math.ceil(Math.pow(2,m));const b=1/v,w=(P,k,z,U,W)=>{const $=U?1:0,Z=(P+1)*z-$,K=k*z,q=(k+1)*z-$;W[0]=P*z,W[1]=K,W[2]=Z,W[3]=q};let A=new zz(v);const C=[];for(let P=0;P<v*v;P++){w(P%v,Math.floor(P/v),b,!1,C);const k=Ep(C[0],C[1],h),z=Ep(C[2],C[1],h),U=Ep(C[2],C[3],h),W=Ep(C[0],C[3],h);A.minimums.push(Math.min(k,z,U,W)),A.maximums.push(Math.max(k,z,U,W)),A.leaves.push(1)}for(g.push(A),v/=2;v>=1;v/=2){const P=g[g.length-1];A=new zz(v);for(let k=0;k<v*v;k++){w(k%v,Math.floor(k/v),2,!0,C);const z=P.getElevation(C[0],C[1]),U=P.getElevation(C[2],C[1]),W=P.getElevation(C[2],C[3]),$=P.getElevation(C[0],C[3]),Z=P.isLeaf(C[0],C[1]),K=P.isLeaf(C[2],C[1]),q=P.isLeaf(C[2],C[3]),J=P.isLeaf(C[0],C[3]),re=Math.min(z.min,U.min,W.min,$.min),ce=Math.max(z.max,U.max,W.max,$.max),ge=Z&&K&&q&&J;A.maximums.push(ce),A.minimums.push(re),A.leaves.push(ce-re<=5&&ge?1:0)}g.push(A)}return g}(this.dem),c=r.length-1,u=r[c];this._addNode(u.minimums[0],u.maximums[0],u.leaves[0]),this._construct(r,0,0,c,0)}raycastRoot(t,r,c,u,h,m,g=1){return Fz([t,r,-100],[c,u,this.maximums[0]*g],h,m)}raycast(t,r,c,u,h,m,g=1){if(!this.nodeCount)return null;const v=this.raycastRoot(t,r,c,u,h,m,g);if(v==null)return null;const b=[],w=[],A=[],C=[],P=[{idx:0,t:v,nodex:0,nodey:0,depth:0}];for(;P.length>0;){const{idx:k,t:z,nodex:U,nodey:W,depth:$}=P.pop();if(this.leaves[k]){Wz(U,W,$,t,r,c,u,A,C);const K=1<<$,q=(U+0)/K,J=(U+1)/K,re=(W+0)/K,ce=(W+1)/K,ge=Ep(q,re,this.dem)*g,ve=Ep(J,re,this.dem)*g,Ce=Ep(J,ce,this.dem)*g,Ae=Ep(q,ce,this.dem)*g,Le=Bz(A[0],A[1],ge,C[0],A[1],ve,C[0],C[1],Ce,h,m),Se=Bz(C[0],C[1],Ce,A[0],C[1],Ae,A[0],A[1],ge,h,m),Ve=Math.min(Le!==null?Le:Number.MAX_VALUE,Se!==null?Se:Number.MAX_VALUE);if(Ve!==Number.MAX_VALUE)return Ve;{const Xe=ke.scaleAndAdd([],h,m,z);if(Gz(ge,ve,Ae,Ce,Uz(Xe[0],A[0],C[0]),Uz(Xe[1],A[1],C[1]))>=Xe[2])return z}continue}let Z=0;for(let K=0;K<this._siblingOffset.length;K++){Wz((U<<1)+this._siblingOffset[K][0],(W<<1)+this._siblingOffset[K][1],$+1,t,r,c,u,A,C),A[2]=-100,C[2]=this.maximums[this.childOffsets[k]+K]*g;const q=Fz(A,C,h,m);if(q!=null){const J=q;b[K]=J;let re=!1;for(let ce=0;ce<Z&&!re;ce++)J>=b[w[ce]]&&(w.splice(ce,0,K),re=!0);re||(w[Z]=K),Z++}}for(let K=0;K<Z;K++){const q=w[K];P.push({idx:this.childOffsets[k]+q,t:b[q],nodex:(U<<1)+this._siblingOffset[q][0],nodey:(W<<1)+this._siblingOffset[q][1],depth:$+1})}}return null}_addNode(t,r,c){return this.minimums.push(t),this.maximums.push(r),this.leaves.push(c),this.childOffsets.push(0),this.nodeCount++}_construct(t,r,c,u,h){if(t[u].isLeaf(r,c)===1)return;this.childOffsets[h]||(this.childOffsets[h]=this.nodeCount);const m=u-1,g=t[m];let v=0,b=0;for(let w=0;w<this._siblingOffset.length;w++){const A=2*r+this._siblingOffset[w][0],C=2*c+this._siblingOffset[w][1],P=g.getElevation(A,C),k=g.isLeaf(A,C),z=this._addNode(P.min,P.max,k);k&&(v|=1<<w),b||(b=z)}for(let w=0;w<this._siblingOffset.length;w++)v&1<<w||this._construct(t,2*r+this._siblingOffset[w][0],2*c+this._siblingOffset[w][1],m,b+w)}}function Gz(a,t,r,c,u,h){return Ln(Ln(a,r,h),Ln(t,c,h),u)}function Ep(a,t,r){const c=r.dim,u=ae(a*c-.5,0,c-1),h=ae(t*c-.5,0,c-1),m=Math.floor(u),g=Math.floor(h),v=Math.min(m+1,c-1),b=Math.min(g+1,c-1);return Gz(r.get(m,g),r.get(v,g),r.get(m,b),r.get(v,b),u-m,h-g)}const Hz={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768],float:[1,1,1,1]};function SP(a,t,r){return(256*a*256+256*t+r)/10-1e4}function AP(a,t,r){return 256*a+t+r/256-32768}class Em{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(t,r,c,u,h=!1){if(this.uid=t,r.height!==r.width)throw new RangeError("DEM tiles must be square");if(c&&c!=="mapbox"&&c!=="terrarium")return _e(`"${c}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=r.height;const m=this.dim=r.height-2,g=new Uint32Array(r.data.buffer);if(this.pixels=new Uint8Array(r.data.buffer),this.encoding=c||"mapbox",this.borderReady=h,this._modifiedForSources={},!h){for(let v=0;v<m;v++)g[this._idx(-1,v)]=g[this._idx(0,v)],g[this._idx(m,v)]=g[this._idx(m-1,v)],g[this._idx(v,-1)]=g[this._idx(v,0)],g[this._idx(v,m)]=g[this._idx(v,m-1)];g[this._idx(-1,-1)]=g[this._idx(0,0)],g[this._idx(m,-1)]=g[this._idx(m-1,0)],g[this._idx(-1,m)]=g[this._idx(0,m-1)],g[this._idx(m,m)]=g[this._idx(m-1,m-1)]}if(u){const v=new Float32Array(r.data.buffer),b=this.encoding==="terrarium"?AP:SP;for(let w=0;w<g.length;++w){const A=4*w;v[w]=b(this.pixels[A],this.pixels[A+1],this.pixels[A+2])}this.encoding="float"}this._timestamp=Cn.now()}_buildQuadTree(){this._tree=new Vz(this)}get(t,r,c=!1){c&&(t=ae(t,-1,this.dim),r=ae(r,-1,this.dim));const u=this._idx(t,r);if(this.encoding==="float")return this.floatView||(this.floatView=new Float32Array(this.pixels.buffer)),this.floatView[u];const h=4*u;return(this.encoding==="terrarium"?AP:SP)(this.pixels[h],this.pixels[h+1],this.pixels[h+2])}set(t,r,c){const u=this._idx(t,r);if(this.encoding==="float"){this.floatView||(this.floatView=new Float32Array(this.pixels.buffer));const v=this.floatView[u];return this.floatView[u]=c,c-v}const h=4*u,m=(this.encoding==="terrarium"?AP:SP)(this.pixels[h],this.pixels[h+1],this.pixels[h+2]),g=Em.pack(c,this.encoding==="terrarium"?"terrarium":"mapbox");return this.pixels[h]=g[0],this.pixels[h+1]=g[1],this.pixels[h+2]=g[2],c-m}static getUnpackVector(t){return Hz[t]}get unpackVector(){return Hz[this.encoding]}_idx(t,r){if(t<-1||t>=this.dim+1||r<-1||r>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(r+1)*this.stride+(t+1)}static pack(t,r){const c=[0,0,0,0],u=Em.getUnpackVector(r);let h=Math.floor((t+u[3])/u[2]);return c[2]=h%256,h=Math.floor(h/256),c[1]=h%256,h=Math.floor(h/256),c[0]=h,c}getPixels(){return this.encoding==="float"?new wz({width:this.stride,height:this.stride},this.pixels):new Xa({width:this.stride,height:this.stride},this.pixels)}backfillBorder(t,r,c){if(this.dim!==t.dim)throw new Error("dem dimension mismatch");let u=r*this.dim,h=r*this.dim+this.dim,m=c*this.dim,g=c*this.dim+this.dim;switch(r){case-1:u=h-1;break;case 1:h=u+1}switch(c){case-1:m=g-1;break;case 1:g=m+1}const v=-r*this.dim,b=-c*this.dim;for(let w=m;w<g;w++)for(let A=u;A<h;A++){const C=4*this._idx(A,w),P=4*this._idx(A+v,w+b);this.pixels[C+0]=t.pixels[P+0],this.pixels[C+1]=t.pixels[P+1],this.pixels[C+2]=t.pixels[P+2],this.pixels[C+3]=t.pixels[P+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}un(Em,"DEMData"),un(Vz,"DemMinMaxQuadTree",{omit:["dem"]});class Xee{isDataAvailableAtPoint(t){const r=this._source();if(this.isUsingMockSource()||!r||t.y<0||t.y>1)return!1;const c=r.getSource().maxzoom,u=1<<c,h=Math.floor(t.x),m=Math.floor((t.x-h)*u),g=Math.floor(t.y*u),v=this.findDEMTileFor(new Li(c,h,c,m,g));return!(!v||!v.dem)}getAtPointOrZero(t,r=0){return this.getAtPoint(t,r)||0}getAtPoint(t,r,c=!0){if(this.isUsingMockSource())return null;r==null&&(r=null);const u=this._source();if(!u||t.y<0||t.y>1)return r;const h=u.getSource().maxzoom,m=1<<h,g=Math.floor(t.x),v=t.x-g,b=new Li(h,g,h,Math.floor(v*m),Math.floor(t.y*m)),w=this.findDEMTileFor(b);if(!w||!w.dem)return r;const A=w.dem,C=1<<w.tileID.canonical.z,P=(v*C-w.tileID.canonical.x)*A.dim,k=(t.y*C-w.tileID.canonical.y)*A.dim,z=Math.floor(P),U=Math.floor(k);return(c?this.exaggeration():1)*Ln(Ln(A.get(z,U),A.get(z,U+1),k-U),Ln(A.get(z+1,U),A.get(z+1,U+1),k-U),P-z)}getAtTileOffset(t,r,c){const u=1<<t.canonical.z;return this.getAtPointOrZero(new vi(t.wrap+(t.canonical.x+r/mt)/u,(t.canonical.y+c/mt)/u))}getAtTileOffsetFunc(t,r,c,u){return h=>{const m=this.getAtTileOffset(t,h.x,h.y),g=u.upVector(t.canonical,h.x,h.y),v=u.upVectorScale(t.canonical,r,c).metersToTile;return ke.scale(g,g,m*v),g}}getForTilePoints(t,r,c,u){if(this.isUsingMockSource())return!1;const h=fv.create(this,t,u);return!!h&&(r.forEach(m=>{m[2]=this.exaggeration()*h.getElevationAt(m[0],m[1],c)}),!0)}getMinMaxForTile(t){if(this.isUsingMockSource())return null;const r=this.findDEMTileFor(t);if(!r||!r.dem)return null;const c=r.dem.tree,u=r.tileID,h=1<<t.canonical.z-u.canonical.z;let m=t.canonical.x/h-u.canonical.x,g=t.canonical.y/h-u.canonical.y,v=0;for(let b=0;b<t.canonical.z-u.canonical.z&&!c.leaves[v];b++){m*=2,g*=2;const w=2*Math.floor(g)+Math.floor(m);v=c.childOffsets[v]+w,m%=1,g%=1}return{min:this.exaggeration()*c.minimums[v],max:this.exaggeration()*c.maximums[v]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(t,r,c){throw new Error("Pure virtual method called.")}pointCoordinate(t){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(t){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}}class fv{constructor(t,r,c){this._demTile=t,this._dem=this._demTile.dem,this._scale=r,this._offset=c}static create(t,r,c){const u=c||t.findDEMTileFor(r);if(!u||!u.dem)return;const h=u.dem,m=u.tileID,g=1<<r.canonical.z-m.canonical.z;return new fv(u,h.dim/mt/g,[(r.canonical.x/g-m.canonical.x)*h.dim,(r.canonical.y/g-m.canonical.y)*h.dim])}tileCoordToPixel(t,r){const c=r*this._scale+this._offset[1],u=Math.floor(t*this._scale+this._offset[0]),h=Math.floor(c);return new V(u,h)}getElevationAt(t,r,c,u){const h=t*this._scale+this._offset[0],m=r*this._scale+this._offset[1],g=Math.floor(h),v=Math.floor(m),b=this._dem;return u=!!u,c?Ln(Ln(b.get(g,v,u),b.get(g,v+1,u),m-v),Ln(b.get(g+1,v,u),b.get(g+1,v+1,u),m-v),h-g):b.get(g,v,u)}getElevationAtPixel(t,r,c){return this._dem.get(t,r,!!c)}getMeterToDEM(t){return(1<<this._demTile.tileID.canonical.z)*$i(1,t)*this._dem.stride}}class EP{constructor(t,r){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new Qr(mt,16,0),this.featureIndexArray=new bO,this.promoteId=r}insert(t,r,c,u,h,m=0){const g=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(c,u,h,m);const v=this.grid;for(let b=0;b<r.length;b++){const w=r[b],A=[1/0,1/0,-1/0,-1/0];for(let C=0;C<w.length;C++){const P=w[C];A[0]=Math.min(A[0],P.x),A[1]=Math.min(A[1],P.y),A[2]=Math.max(A[2],P.x),A[3]=Math.max(A[3],P.y)}A[0]<mt&&A[1]<mt&&A[2]>=0&&A[3]>=0&&v.insert(g,A[0],A[1],A[2],A[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new xP(new e3(this.rawTileData)).layers,this.sourceLayerCoder=new Iz(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const t in this.vtLayers)this.vtFeatures[t]=[]}return this.vtLayers}query(t,r,c,u){this.loadVTLayers();const h=t.params||{},m=sm(h.filter),g=t.tileResult,v=t.transform,b=g.bufferedTilespaceBounds,w=this.grid.query(b.min.x,b.min.y,b.max.x,b.max.y,(k,z,U,W)=>pz(g.bufferedTilespaceGeometry,k,z,U,W));w.sort(Zee);let A=null;v.elevation&&w.length>0&&(A=fv.create(v.elevation,this.tileID));const C={};let P;for(let k=0;k<w.length;k++){const z=w[k];if(z===P)continue;P=z;const U=this.featureIndexArray.get(z);let W=null;this.loadMatchingFeature(C,U,m,h.layers,h.availableImages,r,c,u,($,Z,K,q=0)=>(W||(W=$u($,this.tileID.canonical,t.tileTransform)),Z.queryIntersectsFeature(g,$,K,W,this.z,t.transform,t.pixelPosMatrix,A,q)))}return C}loadMatchingFeature(t,r,c,u,h,m,g,v,b){const{featureIndex:w,bucketIndex:A,sourceLayerIndex:C,layoutVertexArrayOffset:P}=r,k=this.bucketLayerIDs[A];if(u&&!function($,Z){for(let K=0;K<$.length;K++)if(Z.indexOf($[K])>=0)return!0;return!1}(u,k))return;const z=this.sourceLayerCoder.decode(C),U=this.vtLayers[z].feature(w);if(c.needGeometry){const $=Sp(U,!0);if(!c.filter(new sa(this.tileID.overscaledZ),$,this.tileID.canonical))return}else if(!c.filter(new sa(this.tileID.overscaledZ),U))return;const W=this.getId(U,z);for(let $=0;$<k.length;$++){const Z=k[$];if(u&&u.indexOf(Z)<0)continue;const K=m[Z];if(!K)continue;let q={};W!==void 0&&v&&(q=v.getState(K.sourceLayer||"_geojsonTileLayer",W));const J=Fe({},g[Z]);J.paint=jz(J.paint,K.paint,U,q,h),J.layout=jz(J.layout,K.layout,U,q,h);const re=!b||b(U,K,q,P);if(!re)continue;const ce=new Nz(U,this.z,this.x,this.y,W);ce.layer=J;let ge=t[Z];ge===void 0&&(ge=t[Z]=[]),ge.push({featureIndex:w,feature:ce,intersectionZ:re})}}lookupSymbolFeatures(t,r,c,u,h,m,g,v){const b={};this.loadVTLayers();const w=sm(h);for(const A of t)this.loadMatchingFeature(b,{bucketIndex:c,sourceLayerIndex:u,featureIndex:A,layoutVertexArrayOffset:0},w,m,g,v,r);return b}loadFeature(t){const{featureIndex:r,sourceLayerIndex:c}=t;this.loadVTLayers();const u=this.sourceLayerCoder.decode(c),h=this.vtFeatures[u];if(h[r])return h[r];const m=this.vtLayers[u].feature(r);return h[r]=m,m}hasLayer(t){for(const r of this.bucketLayerIDs)for(const c of r)if(t===c)return!0;return!1}getId(t,r){let c=t.id;if(this.promoteId){const u=typeof this.promoteId=="string"?this.promoteId:this.promoteId[r];u!=null&&(c=t.properties[u]),typeof c=="boolean"&&(c=Number(c))}return c}}function jz(a,t,r,c,u){return _t(a,(h,m)=>{const g=t instanceof Vu?t.get(m):null;return g&&g.evaluate?g.evaluate(r,c,u):g})}function Zee(a,t){return t-a}un(EP,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});const Kee=B([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Jee=B([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),Qee=B([{name:"a_projected_pos",components:4,type:"Float32"}],4);B([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const ete=B([{name:"a_z_offset",components:1,type:"Float32"}],4),tte=B([{name:"a_texb",components:2,type:"Uint16"}]),nte=B([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),ite=B([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"}]);B([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const $z=B([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),ate=B([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);B([{name:"triangle",components:3,type:"Uint16"}]),B([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),B([{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Float32",name:"zOffset"},{type:"Uint8",name:"hasIconTextFit"}]),B([{type:"Float32",name:"offsetX"}]),B([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var io=24;const Yc=128;function MP(a,t){const{expression:r}=t;if(r.kind==="constant")return{kind:"constant",layoutSize:r.evaluate(new sa(a+1))};if(r.kind==="source")return{kind:"source"};{const{zoomStops:c,interpolationType:u}=r;let h=0;for(;h<c.length&&c[h]<=a;)h++;h=Math.max(0,h-1);let m=h;for(;m<c.length&&c[m]<a+1;)m++;m=Math.min(c.length-1,m);const g=c[h],v=c[m];return r.kind==="composite"?{kind:"composite",minZoom:g,maxZoom:v,interpolationType:u}:{kind:"camera",minZoom:g,maxZoom:v,minSize:r.evaluate(new sa(g)),maxSize:r.evaluate(new sa(v)),interpolationType:u}}}function y1(a,{uSize:t,uSizeT:r},{lowerSize:c,upperSize:u}){return a.kind==="source"?c/Yc:a.kind==="composite"?Ln(c/Yc,u/Yc,r):t}function Yu(a,t){let r=0,c=0;if(a.kind==="constant")c=a.layoutSize;else if(a.kind!=="source"){const{interpolationType:u,minZoom:h,maxZoom:m}=a,g=u?ae(lc.interpolationFactor(u,t,h,m),0,1):0;a.kind==="camera"?c=Ln(a.minSize,a.maxSize,g):r=g}return{uSizeT:r,uSize:c}}var rte=Object.freeze({__proto__:null,SIZE_PACK_FACTOR:Yc,evaluateSizeForFeature:y1,evaluateSizeForZoom:Yu,getSizeData:MP});function ote(a,t,r){return a.sections.forEach(c=>{c.text=function(u,h,m){const g=h.layout.get("text-transform").evaluate(m,{});return g==="uppercase"?u=u.toLocaleUpperCase():g==="lowercase"&&(u=u.toLocaleLowerCase()),Ds.applyArabicShaping&&(u=Ds.applyArabicShaping(u)),u}(c.text,t,r)}),a}const v1={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂","←":"↑","→":"↓"};function ste(a){return a==="︶"||a==="﹈"||a==="︸"||a==="﹄"||a==="﹂"||a==="︾"||a==="︼"||a==="︺"||a==="︘"||a==="﹀"||a==="︐"||a==="︓"||a==="︔"||a==="｀"||a==="￣"||a==="︑"||a==="︒"}function lte(a){return a==="︵"||a==="﹇"||a==="︷"||a==="﹃"||a==="﹁"||a==="︽"||a==="︻"||a==="︹"||a==="︗"||a==="︿"}const TP=3;function cte(a,t,r){t.glyphs=[],a===1&&r.readMessage(ute,t)}function ute(a,t,r){if(a===3){const{id:c,bitmap:u,width:h,height:m,left:g,top:v,advance:b}=r.readMessage(dte,{});t.glyphs.push({id:c,bitmap:new oh({width:h+2*TP,height:m+2*TP},u),metrics:{width:h,height:m,left:g,top:v,advance:b}})}else a===4?t.ascender=r.readSVarint():a===5&&(t.descender=r.readSVarint())}function dte(a,t,r){a===1?t.id=r.readVarint():a===2?t.bitmap=r.readBytes():a===3?t.width=r.readVarint():a===4?t.height=r.readVarint():a===5?t.left=r.readSVarint():a===6?t.top=r.readSVarint():a===7&&(t.advance=r.readVarint())}const Yz=TP;function CP(a){let t=0,r=0;for(const m of a)t+=m.w*m.h,r=Math.max(r,m.w);a.sort((m,g)=>g.h-m.h);const c=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),r),h:1/0}];let u=0,h=0;for(const m of a)for(let g=c.length-1;g>=0;g--){const v=c[g];if(!(m.w>v.w||m.h>v.h)){if(m.x=v.x,m.y=v.y,h=Math.max(h,m.y+m.h),u=Math.max(u,m.x+m.w),m.w===v.w&&m.h===v.h){const b=c.pop();g<c.length&&(c[g]=b)}else m.h===v.h?(v.x+=m.w,v.w-=m.w):m.w===v.w?(v.y+=m.h,v.h-=m.h):(c.push({x:v.x+m.w,y:v.y,w:v.w-m.w,h:m.h}),v.y+=m.h,v.h-=m.h);break}}return{w:u,h,fill:t/(u*h)||0}}const Fs=1;class PP{constructor(t,{pixelRatio:r,version:c,stretchX:u,stretchY:h,content:m}){this.paddedRect=t,this.pixelRatio=r,this.stretchX=u,this.stretchY=h,this.content=m,this.version=c}get tl(){return[this.paddedRect.x+Fs,this.paddedRect.y+Fs]}get br(){return[this.paddedRect.x+this.paddedRect.w-Fs,this.paddedRect.y+this.paddedRect.h-Fs]}get displaySize(){return[(this.paddedRect.w-2*Fs)/this.pixelRatio,(this.paddedRect.h-2*Fs)/this.pixelRatio]}}class qz{constructor(t,r){const c={},u={};this.haveRenderCallbacks=[];const h=[];this.addImages(t,c,h),this.addImages(r,u,h);const{w:m,h:g}=CP(h),v=new Xa({width:m||1,height:g||1});for(const b in t){const w=t[b],A=c[b].paddedRect;Xa.copy(w.data,v,{x:0,y:0},{x:A.x+Fs,y:A.y+Fs},w.data)}for(const b in r){const w=r[b],A=u[b].paddedRect,C=A.x+Fs,P=A.y+Fs,k=w.data.width,z=w.data.height;Xa.copy(w.data,v,{x:0,y:0},{x:C,y:P},w.data),Xa.copy(w.data,v,{x:0,y:z-1},{x:C,y:P-1},{width:k,height:1}),Xa.copy(w.data,v,{x:0,y:0},{x:C,y:P+z},{width:k,height:1}),Xa.copy(w.data,v,{x:k-1,y:0},{x:C-1,y:P},{width:1,height:z}),Xa.copy(w.data,v,{x:0,y:0},{x:C+k,y:P},{width:1,height:z})}this.image=v,this.iconPositions=c,this.patternPositions=u}addImages(t,r,c){for(const u in t){const h=t[u],m={x:0,y:0,w:h.data.width+2*Fs,h:h.data.height+2*Fs};c.push(m),r[u]=new PP(m,h),h.hasRenderCallback&&this.haveRenderCallbacks.push(u)}}patchUpdatedImages(t,r,c){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(u=>t.hasImage(u,c)),t.dispatchRenderCallbacks(this.haveRenderCallbacks,c);for(const u in t.getUpdatedImages(c))this.patchUpdatedImage(this.iconPositions[u],t.getImage(u,c),r),this.patchUpdatedImage(this.patternPositions[u],t.getImage(u,c),r)}patchUpdatedImage(t,r,c){if(!t||!r||t.version===r.version)return;t.version=r.version;const[u,h]=t.tl;c.update(r.data,void 0,{x:u,y:h})}}un(PP,"ImagePosition"),un(qz,"ImageAtlas");const Aa={horizontal:1,vertical:2,horizontalOnly:3},Xz=-17;class _1{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(t,r){const c=new _1;return c.scale=t||1,c.fontStack=r,c}static forImage(t){const r=new _1;return r.imageName=t,r}}class mv{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(t,r){const c=new mv;for(let u=0;u<t.sections.length;u++){const h=t.sections[u];h.image?c.addImageSection(h):c.addTextSection(h,r)}return c}length(){return this.text.length}getSection(t){return this.sections[this.sectionIndex[t]]}getSections(){return this.sections}getSectionIndex(t){return this.sectionIndex[t]}getCodePoint(t){return this.text.codePointAt(t)}verticalizePunctuation(t){this.text=function(r,c){let u="";for(let h=0;h<r.length;h++){const m=r.charCodeAt(h+1)||null,g=r.charCodeAt(h-1)||null;u+=!c&&(m&&Xy(m)&&!v1[r[h+1]]||g&&Xy(g)&&!v1[r[h-1]])||!v1[r[h]]?r[h]:v1[r[h]]}return u}(this.text,t)}trim(){let t=0;for(let c=0;c<this.text.length&&t3[this.text.charCodeAt(c)];c++)t++;let r=this.text.length;for(let c=this.text.length-1;c>=0&&c>=t&&t3[this.text.charCodeAt(c)];c--)r--;this.text=this.text.substring(t,r),this.sectionIndex=this.sectionIndex.slice(t,r)}substring(t,r){const c=new mv;return c.text=this.text.substring(t,r),c.sectionIndex=this.sectionIndex.slice(t,r),c.sections=this.sections,c}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((t,r)=>Math.max(t,this.sections[r].scale),0)}addTextSection(t,r){this.text+=t.text,this.sections.push(_1.forText(t.scale,t.fontStack||r));const c=this.sections.length-1;for(let u=0;u<t.text.length;++u)this.sectionIndex.push(c)}addImageSection(t){const r=t.image?t.image.namePrimary:"";if(r.length===0)return void _e("Can't add FormattedSection with an empty image.");const c=this.getNextImageSectionCharCode();c?(this.text+=String.fromCodePoint(c),this.sections.push(_1.forImage(r)),this.sectionIndex.push(this.sections.length-1)):_e("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function IP(a,t,r,c,u,h,m,g,v,b,w,A,C,P,k){const z=mv.fromFeature(a,u);A===Aa.vertical&&z.verticalizePunctuation(C);let U=[];const W=function(J,re,ce,ge,ve,Ce){if(!J)return[];const Ae=[],Le=function(nt,We,Ge,ot,yt,pt){let Rt=0;for(let Ft=0;Ft<nt.length();Ft++){const St=nt.getSection(Ft);Rt+=Zz(nt.getCodePoint(Ft),St,ot,yt,We,pt)}return Rt/Math.max(1,Math.ceil(Rt/Ge))}(J,re,ce,ge,ve,Ce),Se=J.text.indexOf("​")>=0;let Ve=0;for(let nt=0;nt<J.length();nt++){const We=J.getSection(nt),Ge=J.getCodePoint(nt);if(t3[Ge]||(Ve+=Zz(Ge,We,ge,ve,re,Ce)),nt<J.length()-1){const ot=!((Xe=Ge)<11904||!(mn["Bopomofo Extended"](Xe)||mn.Bopomofo(Xe)||mn["CJK Compatibility Forms"](Xe)||mn["CJK Compatibility Ideographs"](Xe)||mn["CJK Compatibility"](Xe)||mn["CJK Radicals Supplement"](Xe)||mn["CJK Strokes"](Xe)||mn["CJK Symbols and Punctuation"](Xe)||mn["CJK Unified Ideographs Extension A"](Xe)||mn["CJK Unified Ideographs"](Xe)||mn["Enclosed CJK Letters and Months"](Xe)||mn["Halfwidth and Fullwidth Forms"](Xe)||mn.Hiragana(Xe)||mn["Ideographic Description Characters"](Xe)||mn["Kangxi Radicals"](Xe)||mn["Katakana Phonetic Extensions"](Xe)||mn.Katakana(Xe)||mn["Vertical Forms"](Xe)||mn["Yi Radicals"](Xe)||mn["Yi Syllables"](Xe)));(hte[Ge]||ot||We.imageName)&&Ae.push(Jz(nt+1,Ve,Le,Ae,pte(Ge,J.getCodePoint(nt+1),ot&&Se),!1))}}var Xe;return Qz(Jz(J.length(),Ve,Le,Ae,0,!0))}(z,b,h,t,c,P),{processBidirectionalText:$,processStyledBidirectionalText:Z}=Ds;if($&&z.sections.length===1){const J=$(z.toString(),W);for(const re of J){const ce=new mv;ce.text=re,ce.sections=z.sections;for(let ge=0;ge<re.length;ge++)ce.sectionIndex.push(0);U.push(ce)}}else if(Z){const J=Z(z.text,z.sectionIndex,W);for(const re of J){const ce=new mv;ce.text=re[0],ce.sectionIndex=re[1],ce.sections=z.sections,U.push(ce)}}else U=function(J,re){const ce=[],ge=J.text;let ve=0;for(const Ce of re)ce.push(J.substring(ve,Ce)),ve=Ce;return ve<ge.length&&ce.push(J.substring(ve,ge.length)),ce}(z,W);const K=[],q={positionedLines:K,text:z.toString(),top:w[1],bottom:w[1],left:w[0],right:w[0],writingMode:A,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(J,re,ce,ge,ve,Ce,Ae,Le,Se,Ve,Xe,nt){let We=0,Ge=0,ot=0;const yt=Le==="right"?1:Le==="left"?0:.5;let pt=!1;for(const sn of ve){const on=sn.getSections();for(const cn of on){if(cn.imageName)continue;const yn=re[cn.fontStack];if(yn&&(pt=yn.ascender!==void 0&&yn.descender!==void 0,!pt))break}if(!pt)break}let Rt=0;for(const sn of ve){sn.trim();const on=sn.getMaxScale(),cn=(on-1)*io,yn={positionedGlyphs:[],lineOffset:0};J.positionedLines[Rt]=yn;const kn=yn.positionedGlyphs;let ii=0;if(!sn.length()){Ge+=Ce,++Rt;continue}let Ai=0,Yn=0;for(let In=0;In<sn.length();In++){const Mn=sn.getSection(In),mi=sn.getSectionIndex(In),Pi=sn.getCodePoint(In);let ni=Mn.scale,qi=null,Ea=null,la=null,ta=io,or=0;const Ma=!(Se===Aa.horizontal||!Xe&&!qy(Pi)||Xe&&(t3[Pi]||(Ft=Pi,mn.Arabic(Ft)||mn["Arabic Supplement"](Ft)||mn["Arabic Extended-A"](Ft)||mn["Arabic Presentation Forms-A"](Ft)||mn["Arabic Presentation Forms-B"](Ft))));if(Mn.imageName){const Fa=ge[Mn.imageName];if(!Fa)continue;la=Mn.imageName,J.iconsInText=J.iconsInText||!0,Ea=Fa.paddedRect;const Xi=Fa.displaySize;ni=ni*io/nt,qi={width:Xi[0],height:Xi[1],left:Fs,top:-Yz,advance:Ma?Xi[1]:Xi[0],localGlyph:!1},or=pt?-qi.height*ni:Xz+on*io-Xi[1]*ni,ta=qi.advance;const us=(Ma?Xi[0]:Xi[1])*ni-io*on;us>0&&us>ii&&(ii=us)}else{const Fa=ce[Mn.fontStack];if(!Fa)continue;Fa[Pi]&&(Ea=Fa[Pi]);const Xi=re[Mn.fontStack];if(!Xi)continue;const us=Xi.glyphs[Pi];if(!us)continue;if(qi=us.metrics,ta=Pi!==8203?io:0,pt){const ed=Xi.ascender!==void 0?Math.abs(Xi.ascender):0,ch=Xi.descender!==void 0?Math.abs(Xi.descender):0,uh=(ed+ch)*ni;Ai<uh&&(Ai=uh,Yn=(ed-ch)/2*ni),or=-ed*ni}else or=Xz+(on-ni)*io}Ma?(J.verticalizable=!0,kn.push({glyph:Pi,imageName:la,x:We,y:Ge+or,vertical:Ma,scale:ni,localGlyph:qi.localGlyph,fontStack:Mn.fontStack,sectionIndex:mi,metrics:qi,rect:Ea}),We+=ta*ni+Ve):(kn.push({glyph:Pi,imageName:la,x:We,y:Ge+or,vertical:Ma,scale:ni,localGlyph:qi.localGlyph,fontStack:Mn.fontStack,sectionIndex:mi,metrics:qi,rect:Ea}),We+=qi.advance*ni+Ve)}kn.length!==0&&(ot=Math.max(We-Ve,ot),pt?eF(kn,yt,ii,Yn,Ce*on/2):eF(kn,yt,ii,0,Ce/2)),We=0;const Wn=Ce*on+ii;yn.lineOffset=Math.max(ii,cn),Ge+=Wn,++Rt}var Ft;const St=Ge,{horizontalAlign:Tt,verticalAlign:nn}=n3(Ae);(function(sn,on,cn,yn,kn,ii){const Ai=(on-cn)*kn,Yn=-ii*yn;for(const Wn of sn)for(const In of Wn.positionedGlyphs)In.x+=Ai,In.y+=Yn})(J.positionedLines,yt,Tt,nn,ot,St),J.top+=-nn*St,J.bottom=J.top+St,J.left+=-Tt*ot,J.right=J.left+ot,J.hasBaseline=pt}(q,t,r,c,U,m,g,v,A,b,C,k),!function(J){for(const re of J)if(re.positionedGlyphs.length!==0)return!1;return!0}(K)&&q}const t3={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},hte={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function Zz(a,t,r,c,u,h){if(t.imageName){const m=c[t.imageName];return m?m.displaySize[0]*t.scale*io/h+u:0}{const m=r[t.fontStack],g=m&&m.glyphs[a];return g?g.metrics.advance*t.scale+u:0}}function Kz(a,t,r,c){const u=Math.pow(a-t,2);return c?a<t?u/2:2*u:u+Math.abs(r)*r}function pte(a,t,r){let c=0;return a===10&&(c-=1e4),r&&(c+=150),a!==40&&a!==65288||(c+=50),t!==41&&t!==65289||(c+=50),c}function Jz(a,t,r,c,u,h){let m=null,g=Kz(t,r,u,h);for(const v of c){const b=Kz(t-v.x,r,u,h)+v.badness;b<=g&&(m=v,g=b)}return{index:a,x:t,priorBreak:m,badness:g}}function Qz(a){return a?Qz(a.priorBreak).concat(a.index):[]}function n3(a){let t=.5,r=.5;switch(a){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(a){case"bottom":case"bottom-right":case"bottom-left":r=1;break;case"top":case"top-right":case"top-left":r=0}return{horizontalAlign:t,verticalAlign:r}}function eF(a,t,r,c,u){if(!(t||r||c||u))return;const h=a.length-1,m=a[h],g=(m.x+m.metrics.advance*m.scale)*t;for(let v=0;v<=h;v++)a[v].x-=g,a[v].y+=r+c+u}function fte(a,t,r,c){const{horizontalAlign:u,verticalAlign:h}=n3(c),m=r[0]-a.displaySize[0]*u,g=r[1]-a.displaySize[1]*h;return{imagePrimary:a,imageSecondary:t,top:g,bottom:g+a.displaySize[1],left:m,right:m+a.displaySize[0]}}function tF(a,t,r,c,u,h){const m=a.imagePrimary;let g;if(m.content){const U=m.content,W=m.pixelRatio||1;g=[U[0]/W,U[1]/W,m.displaySize[0]-U[2]/W,m.displaySize[1]-U[3]/W]}const v=t.left*h,b=t.right*h;let w,A,C,P;r==="width"||r==="both"?(P=u[0]+v-c[3],A=u[0]+b+c[1]):(P=u[0]+(v+b-m.displaySize[0])/2,A=P+m.displaySize[0]);const k=t.top*h,z=t.bottom*h;return r==="height"||r==="both"?(w=u[1]+k-c[0],C=u[1]+z+c[2]):(w=u[1]+(k+z-m.displaySize[1])/2,C=w+m.displaySize[1]),{imagePrimary:m,imageSecondary:void 0,top:w,right:A,bottom:C,left:P,collisionPadding:g}}class lh extends V{constructor(t,r,c,u,h){super(t,r),this.angle=u,this.z=c,h!==void 0&&(this.segment=h)}clone(){return new lh(this.x,this.y,this.z,this.angle,this.segment)}}function nF(a,t,r,c,u){if(t.segment===void 0)return!0;let h=t,m=t.segment+1,g=0;for(;g>-r/2;){if(m--,m<0)return!1;g-=a[m].dist(h),h=a[m]}g+=a[m].dist(a[m+1]),m++;const v=[];let b=0;for(;g<r/2;){const w=a[m],A=a[m+1];if(!A)return!1;let C=a[m-1].angleTo(w)-w.angleTo(A);for(C=Math.abs((C+3*Math.PI)%(2*Math.PI)-Math.PI),v.push({distance:g,angleDelta:C}),b+=C;g-v[0].distance>c;)b-=v.shift().angleDelta;if(b>u)return!1;m++,g+=w.dist(A)}return!0}function iF(a){let t=0;for(let r=0;r<a.length-1;r++)t+=a[r].dist(a[r+1]);return t}function aF(a,t,r){return a?.6*t*r:0}function rF(a,t){return Math.max(a?a.right-a.left:0,t?t.right-t.left:0)}function mte(a,t,r,c,u,h){const m=aF(r,u,h),g=rF(r,c)*h;let v=0;const b=iF(a)/2;for(let w=0;w<a.length-1;w++){const A=a[w],C=a[w+1],P=A.dist(C);if(v+P>b){const k=(b-v)/P,z=Ln(A.x,C.x,k),U=Ln(A.y,C.y,k),W=new lh(z,U,0,C.angleTo(A),w);return!m||nF(a,W,g,m,t)?W:void 0}v+=P}}function gte(a,t,r,c,u,h,m,g,v){const b=aF(c,h,m),w=rF(c,u),A=w*m,C=a[0].x===0||a[0].x===v||a[0].y===0||a[0].y===v;return t-A<t/4&&(t=A+t/4),oF(a,C?t/2*g%t:(w/2+2*h)*m*g%t,t,b,r,A,C,!1,v)}function oF(a,t,r,c,u,h,m,g,v){const b=h/2,w=iF(a);let A=0,C=t-r,P=[];for(let k=0;k<a.length-1;k++){const z=a[k],U=a[k+1],W=z.dist(U),$=U.angleTo(z);for(;C+r<A+W;){C+=r;const Z=(C-A)/W,K=Ln(z.x,U.x,Z),q=Ln(z.y,U.y,Z);if(K>=0&&K<v&&q>=0&&q<v&&C-b>=0&&C+b<=w){const J=new lh(K,q,0,$,k);c&&!nF(a,J,h,c,u)||P.push(J)}}A+=W}return g||P.length||m||(P=oF(a,A/2,r,c,u,h,m,!0,v)),P}function sF(a,t,r,c,u){const h=[];for(let m=0;m<a.length;m++){const g=a[m];let v;for(let b=0;b<g.length-1;b++){let w=g[b],A=g[b+1];w.x<t&&A.x<t||(w.x<t?w=new V(t,w.y+(t-w.x)/(A.x-w.x)*(A.y-w.y))._round():A.x<t&&(A=new V(t,w.y+(t-w.x)/(A.x-w.x)*(A.y-w.y))._round()),w.y<r&&A.y<r||(w.y<r?w=new V(w.x+(r-w.y)/(A.y-w.y)*(A.x-w.x),r)._round():A.y<r&&(A=new V(w.x+(r-w.y)/(A.y-w.y)*(A.x-w.x),r)._round()),w.x>=c&&A.x>=c||(w.x>=c?w=new V(c,w.y+(c-w.x)/(A.x-w.x)*(A.y-w.y))._round():A.x>=c&&(A=new V(c,w.y+(c-w.x)/(A.x-w.x)*(A.y-w.y))._round()),w.y>=u&&A.y>=u||(w.y>=u?w=new V(w.x+(u-w.y)/(A.y-w.y)*(A.x-w.x),u)._round():A.y>=u&&(A=new V(w.x+(u-w.y)/(A.y-w.y)*(A.x-w.x),u)._round()),v&&w.equals(v[v.length-1])||(v=[w],h.push(v)),v.push(A)))))}}return h}un(lh,"Anchor");const b1=1e20;function lF(a,t,r,c,u,h,m,g,v){for(let b=t;b<t+c;b++)cF(a,r*h+b,h,u,m,g,v);for(let b=r;b<r+u;b++)cF(a,b*h+t,1,c,m,g,v)}function cF(a,t,r,c,u,h,m){h[0]=0,m[0]=-b1,m[1]=b1,u[0]=a[t];for(let g=1,v=0,b=0;g<c;g++){u[g]=a[t+g*r];const w=g*g;do{const A=h[v];b=(u[g]-u[A]+w-A*A)/(g-A)/2}while(b<=m[v]&&--v>-1);v++,h[v]=g,m[v]=b,m[v+1]=b1}for(let g=0,v=0;g<c;g++){for(;m[v+1]<g;)v++;const b=h[v],w=g-b;a[t+g*r]=u[b]+w*w}}const qc=2;class gv{constructor(t,r,c){this.requestManager=t,this.localGlyphMode=r,this.localFontFamily=c,this.urls={},this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(t,r){this.urls[r]=t}getGlyphs(t,r,c){const u=[],h=this.urls[r]||x.GLYPHS_URL;for(const m in t)for(const g of t[m])u.push({stack:m,id:g});Ze(u,({stack:m,id:g},v)=>{let b=this.entries[m];b||(b=this.entries[m]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let w=b.glyphs[g];if(w!==void 0)return void v(null,{stack:m,id:g,glyph:w});if(w=this._tinySDF(b,m,g),w)return b.glyphs[g]=w,void v(null,{stack:m,id:g,glyph:w});const A=Math.floor(g/256);if(256*A>65535)return void v(new Error("glyphs > 65535 not supported"));if(b.ranges[A])return void v(null,{stack:m,id:g,glyph:w});let C=b.requests[A];C||(C=b.requests[A]=[],gv.loadGlyphRange(m,A,h,this.requestManager,(P,k)=>{if(k){b.ascender=k.ascender,b.descender=k.descender;for(const z in k.glyphs)this._doesCharSupportLocalGlyph(+z)||(b.glyphs[+z]=k.glyphs[+z]);b.ranges[A]=!0}for(const z of C)z(P,k);delete b.requests[A]})),C.push((P,k)=>{P?v(P):k&&v(null,{stack:m,id:g,glyph:k.glyphs[g]||null})})},(m,g)=>{if(m)c(m);else if(g){const v={};for(const{stack:b,id:w,glyph:A}of g)v[b]===void 0&&(v[b]={}),v[b].glyphs===void 0&&(v[b].glyphs={}),v[b].glyphs[w]=A&&{id:A.id,bitmap:A.bitmap.clone(),metrics:A.metrics},v[b].ascender=this.entries[b].ascender,v[b].descender=this.entries[b].descender;c(null,v)}})}_doesCharSupportLocalGlyph(t){return this.localGlyphMode!==0&&(this.localGlyphMode===2?!!this.localFontFamily:!!this.localFontFamily&&(mn["CJK Unified Ideographs"](t)||mn["Hangul Syllables"](t)||mn.Hiragana(t)||mn.Katakana(t)||mn["CJK Symbols and Punctuation"](t)||mn["CJK Unified Ideographs Extension A"](t)||mn["CJK Unified Ideographs Extension B"](t)))}_tinySDF(t,r,c){const u=this.localFontFamily;if(!u||!this._doesCharSupportLocalGlyph(c))return;let h=t.tinySDF;if(!h){let z="400";/bold/i.test(r)?z="900":/medium/i.test(r)?z="500":/light/i.test(r)&&(z="200"),h=t.tinySDF=new gv.TinySDF({fontFamily:u,fontWeight:z,fontSize:24*qc,buffer:3*qc,radius:8*qc}),h.fontWeight=z}if(this.localGlyphs[h.fontWeight][c])return this.localGlyphs[h.fontWeight][c];const m=String.fromCodePoint(c),{data:g,width:v,height:b,glyphWidth:w,glyphHeight:A,glyphLeft:C,glyphTop:P,glyphAdvance:k}=h.draw(m);return this.localGlyphs[h.fontWeight][c]={id:c,bitmap:new oh({width:v,height:b},g),metrics:{width:w/qc,height:A/qc,left:C/qc,top:P/qc-27,advance:k/qc,localGlyph:!0}}}}gv.loadGlyphRange=function(a,t,r,c,u){const h=256*t,m=h+255,g=c.transformRequest(c.normalizeGlyphsURL(r).replace("{fontstack}",a).replace("{range}",`${h}-${m}`),we.Glyphs);vt(g,(v,b)=>{if(v)u(v);else if(b){const w={},A=function(C){return new e3(C).readFields(cte,{})}(b);for(const C of A.glyphs)w[C.id]=C;u(null,{glyphs:w,ascender:A.ascender,descender:A.descender})}})},gv.TinySDF=class{constructor({fontSize:a=24,buffer:t=3,radius:r=8,cutoff:c=.25,fontFamily:u="sans-serif",fontWeight:h="normal",fontStyle:m="normal"}={}){this.buffer=t,this.cutoff=c,this.radius=r;const g=this.size=a+4*t,v=this._createCanvas(g),b=this.ctx=v.getContext("2d",{willReadFrequently:!0});b.font=`${m} ${h} ${a}px ${u}`,b.textBaseline="alphabetic",b.textAlign="left",b.fillStyle="black",this.gridOuter=new Float64Array(g*g),this.gridInner=new Float64Array(g*g),this.f=new Float64Array(g),this.z=new Float64Array(g+1),this.v=new Uint16Array(g)}_createCanvas(a){const t=document.createElement("canvas");return t.width=t.height=a,t}draw(a){const{width:t,actualBoundingBoxAscent:r,actualBoundingBoxDescent:c,actualBoundingBoxLeft:u,actualBoundingBoxRight:h}=this.ctx.measureText(a),m=Math.ceil(r),g=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(h-u))),v=Math.min(this.size-this.buffer,m+Math.ceil(c)),b=g+2*this.buffer,w=v+2*this.buffer,A=Math.max(b*w,0),C=new Uint8ClampedArray(A),P={data:C,width:b,height:w,glyphWidth:g,glyphHeight:v,glyphTop:m,glyphLeft:0,glyphAdvance:t};if(g===0||v===0)return P;const{ctx:k,buffer:z,gridInner:U,gridOuter:W}=this;k.clearRect(z,z,g,v),k.fillText(a,z,z+m);const $=k.getImageData(z,z,g,v);W.fill(b1,0,A),U.fill(0,0,A);for(let Z=0;Z<v;Z++)for(let K=0;K<g;K++){const q=$.data[4*(Z*g+K)+3]/255;if(q===0)continue;const J=(Z+z)*b+K+z;if(q===1)W[J]=0,U[J]=b1;else{const re=.5-q;W[J]=re>0?re*re:0,U[J]=re<0?re*re:0}}lF(W,0,0,b,w,b,this.f,this.v,this.z),lF(U,z,z,g,v,b,this.f,this.v,this.z);for(let Z=0;Z<A;Z++){const K=Math.sqrt(W[Z])-Math.sqrt(U[Z]);C[Z]=Math.round(255-255*(K/this.radius+this.cutoff))}return P}};const Mp=Fs;function uF(a,t,r,c){const u=[],h=a.imagePrimary,m=h.pixelRatio,g=h.paddedRect.w-2*Mp,v=h.paddedRect.h-2*Mp,b=a.right-a.left,w=a.bottom-a.top,A=h.stretchX||[[0,g]],C=h.stretchY||[[0,v]],P=(Ce,Ae)=>Ce+Ae[1]-Ae[0],k=A.reduce(P,0),z=C.reduce(P,0),U=g-k,W=v-z;let $=0,Z=k,K=0,q=z,J=0,re=U,ce=0,ge=W;if(h.content&&c){const Ce=h.content;$=i3(A,0,Ce[0]),K=i3(C,0,Ce[1]),Z=i3(A,Ce[0],Ce[2]),q=i3(C,Ce[1],Ce[3]),J=Ce[0]-$,ce=Ce[1]-K,re=Ce[2]-Ce[0]-Z,ge=Ce[3]-Ce[1]-q}const ve=(Ce,Ae,Le,Se)=>{const Ve=a3(Ce.stretch-$,Z,b,a.left),Xe=r3(Ce.fixed-J,re,Ce.stretch,k),nt=a3(Ae.stretch-K,q,w,a.top),We=r3(Ae.fixed-ce,ge,Ae.stretch,z),Ge=a3(Le.stretch-$,Z,b,a.left),ot=r3(Le.fixed-J,re,Le.stretch,k),yt=a3(Se.stretch-K,q,w,a.top),pt=r3(Se.fixed-ce,ge,Se.stretch,z),Rt=new V(Ve,nt),Ft=new V(Ge,nt),St=new V(Ge,yt),Tt=new V(Ve,yt),nn=new V(Xe/m,We/m),sn=new V(ot/m,pt/m),on=t*Math.PI/180;if(on){const Yn=Math.sin(on),Wn=Math.cos(on),In=[Wn,-Yn,Yn,Wn];Rt._matMult(In),Ft._matMult(In),Tt._matMult(In),St._matMult(In)}const cn=Ce.stretch+Ce.fixed,yn=Le.stretch+Le.fixed,kn=Ae.stretch+Ae.fixed,ii=Se.stretch+Se.fixed,Ai=a.imageSecondary;return{tl:Rt,tr:Ft,bl:Tt,br:St,texPrimary:{x:h.paddedRect.x+Mp+cn,y:h.paddedRect.y+Mp+kn,w:yn-cn,h:ii-kn},texSecondary:Ai?{x:Ai.paddedRect.x+Mp+cn,y:Ai.paddedRect.y+Mp+kn,w:yn-cn,h:ii-kn}:void 0,writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:nn,pixelOffsetBR:sn,minFontScaleX:re/m/b,minFontScaleY:ge/m/w,isSDF:r}};if(c&&(h.stretchX||h.stretchY)){const Ce=dF(A,U,k),Ae=dF(C,W,z);for(let Le=0;Le<Ce.length-1;Le++){const Se=Ce[Le],Ve=Ce[Le+1];for(let Xe=0;Xe<Ae.length-1;Xe++)u.push(ve(Se,Ae[Xe],Ve,Ae[Xe+1]))}}else u.push(ve({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:g+1},{fixed:0,stretch:v+1}));return u}function i3(a,t,r){let c=0;for(const u of a)c+=Math.max(t,Math.min(r,u[1]))-Math.max(t,Math.min(r,u[0]));return c}function dF(a,t,r){const c=[{fixed:-Mp,stretch:0}];for(const[u,h]of a){const m=c[c.length-1];c.push({fixed:u-m.stretch,stretch:m.stretch}),c.push({fixed:u-m.stretch,stretch:m.stretch+(h-u)})}return c.push({fixed:t+Mp,stretch:r}),c}function a3(a,t,r,c){return a/t*r+c}function r3(a,t,r,c){return a-t*r/c}function yte(a,t,r,c){const u=t+a.positionedLines[c].lineOffset;return c===0?r+u/2:r+(u+(t+a.positionedLines[c-1].lineOffset))/2}function vte(a,t=1,r=!1){let c=1/0,u=1/0,h=-1/0,m=-1/0;const g=a[0];for(let P=0;P<g.length;P++){const k=g[P];(!P||k.x<c)&&(c=k.x),(!P||k.y<u)&&(u=k.y),(!P||k.x>h)&&(h=k.x),(!P||k.y>m)&&(m=k.y)}const v=Math.min(h-c,m-u);let b=v/2;const w=new zd([],_te);if(v===0)return new V(c,u);for(let P=c;P<h;P+=v)for(let k=u;k<m;k+=v)w.push(new yv(P+b,k+b,b,a));let A=function(P){let k=0,z=0,U=0;const W=P[0];for(let $=0,Z=W.length,K=Z-1;$<Z;K=$++){const q=W[$],J=W[K],re=q.x*J.y-J.x*q.y;z+=(q.x+J.x)*re,U+=(q.y+J.y)*re,k+=3*re}return new yv(z/k,U/k,0,P)}(a),C=w.length;for(;w.length;){const P=w.pop();(P.d>A.d||!A.d)&&(A=P,r&&console.log("found best %d after %d probes",Math.round(1e4*P.d)/1e4,C)),P.max-A.d<=t||(b=P.h/2,w.push(new yv(P.p.x-b,P.p.y-b,b,a)),w.push(new yv(P.p.x+b,P.p.y-b,b,a)),w.push(new yv(P.p.x-b,P.p.y+b,b,a)),w.push(new yv(P.p.x+b,P.p.y+b,b,a)),C+=4)}return r&&(console.log(`num probes: ${C}`),console.log(`best distance: ${A.d}`)),A.p}function _te(a,t){return t.max-a.max}class yv{constructor(t,r,c,u){this.p=new V(t,r),this.h=c,this.d=function(h,m){let g=!1,v=1/0;for(let b=0;b<m.length;b++){const w=m[b];for(let A=0,C=w.length,P=C-1;A<C;P=A++){const k=w[A],z=w[P];k.y>h.y!=z.y>h.y&&h.x<(z.x-k.x)*(h.y-k.y)/(z.y-k.y)+k.x&&(g=!g),v=Math.min(v,dz(h,k,z))}}return(g?1:-1)*Math.sqrt(v)}(this.p,u),this.max=this.d+this.h*Math.SQRT2}}const vv=7,LP=Number.POSITIVE_INFINITY,bte=Math.sqrt(2);function RP(a,[t,r]){let c=0,u=0;if(r===LP){t<0&&(t=0);const h=t/bte;switch(a){case"top-right":case"top-left":u=h-vv;break;case"bottom-right":case"bottom-left":u=-h+vv;break;case"bottom":u=-t+vv;break;case"top":u=t-vv}switch(a){case"top-right":case"bottom-right":c=-h;break;case"top-left":case"bottom-left":c=h;break;case"left":c=t;break;case"right":c=-t}}else{switch(t=Math.abs(t),r=Math.abs(r),a){case"top-right":case"top-left":case"top":u=r-vv;break;case"bottom-right":case"bottom-left":case"bottom":u=-r+vv}switch(a){case"top-right":case"bottom-right":case"right":c=-t;break;case"top-left":case"bottom-left":case"left":c=t}}return[c,u]}function xte(a,t,r,c,u,h,m,g,v,b,w){a.createArrays(),a.tilePixelRatio=mt/(512*a.overscaling),a.compareText={},a.iconsNeedLinear=!1;const A=a.layers[0].layout,C=a.layers[0]._unevaluatedLayout._values,P={};if(a.textSizeData.kind==="composite"){const{minZoom:W,maxZoom:$}=a.textSizeData;P.compositeTextSizes=[C["text-size"].possiblyEvaluate(new sa(W),g),C["text-size"].possiblyEvaluate(new sa($),g)]}if(a.iconSizeData.kind==="composite"){const{minZoom:W,maxZoom:$}=a.iconSizeData;P.compositeIconSizes=[C["icon-size"].possiblyEvaluate(new sa(W),g),C["icon-size"].possiblyEvaluate(new sa($),g)]}P.layoutTextSize=C["text-size"].possiblyEvaluate(new sa(v+1),g),P.layoutIconSize=C["icon-size"].possiblyEvaluate(new sa(v+1),g),P.textMaxSize=C["text-size"].possiblyEvaluate(new sa(18),g);const k=A.get("text-rotation-alignment")==="map"&&A.get("symbol-placement")!=="point",z=A.get("text-size");let U=!1;for(const W of a.features)if(W.icon&&W.icon.nameSecondary){U=!0;break}for(const W of a.features){const $=A.get("text-font").evaluate(W,{},g).join(","),Z=z.evaluate(W,{},g),K=P.layoutTextSize.evaluate(W,{},g),q=(P.layoutIconSize.evaluate(W,{},g),{horizontal:{},vertical:void 0}),J=W.text;let re,ce=[0,0];if(J){const Ce=J.toString(),Ae=A.get("text-letter-spacing").evaluate(W,{},g)*io,Le=A.get("text-line-height").evaluate(W,{},g)*io,Se=Zd(Ce)?Ae:0,Ve=A.get("text-anchor").evaluate(W,{},g),Xe=A.get("text-variable-anchor");if(!Xe){const yt=A.get("text-radial-offset").evaluate(W,{},g);ce=yt?RP(Ve,[yt*io,LP]):A.get("text-offset").evaluate(W,{},g).map(pt=>pt*io)}let nt=k?"center":A.get("text-justify").evaluate(W,{},g);const We=A.get("symbol-placement")==="point",Ge=We?A.get("text-max-width").evaluate(W,{},g)*io:1/0,ot=yt=>{a.allowVerticalPlacement&&ym(Ce)&&(q.vertical=IP(J,t,r,u,$,Ge,Le,Ve,yt,Se,ce,Aa.vertical,!0,K,Z))};if(!k&&Xe){const yt=nt==="auto"?Xe.map(Rt=>kP(Rt)):[nt];let pt=!1;for(let Rt=0;Rt<yt.length;Rt++){const Ft=yt[Rt];if(!q.horizontal[Ft])if(pt)q.horizontal[Ft]=q.horizontal[0];else{const St=IP(J,t,r,u,$,Ge,Le,"center",Ft,Se,ce,Aa.horizontal,!1,K,Z);St&&(q.horizontal[Ft]=St,pt=St.positionedLines.length===1)}}ot("left")}else{if(nt==="auto"&&(nt=kP(Ve)),We||A.get("text-writing-mode").indexOf("horizontal")>=0||!ym(Ce)){const yt=IP(J,t,r,u,$,Ge,Le,Ve,nt,Se,ce,Aa.horizontal,!1,K,Z);yt&&(q.horizontal[nt]=yt)}ot(We?"left":nt)}}let ge=!1;if(W.icon&&W.icon.namePrimary){const Ce=c[W.icon.namePrimary];Ce&&(re=fte(u[W.icon.namePrimary],W.icon.nameSecondary?u[W.icon.nameSecondary]:void 0,A.get("icon-offset").evaluate(W,{},g),A.get("icon-anchor").evaluate(W,{},g)),ge=Ce.sdf,a.sdfIcons===void 0?a.sdfIcons=Ce.sdf:a.sdfIcons!==Ce.sdf&&_e("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Ce.pixelRatio!==a.pixelRatio||A.get("icon-rotate").constantOr(1)!==0)&&(a.iconsNeedLinear=!0))}const ve=pF(q.horizontal)||q.vertical;a.iconsInText||(a.iconsInText=!!ve&&ve.iconsInText),(ve||re)&&wte(a,W,q,re,c,P,K,0,ce,ge,m,g,b,w,U)}h&&a.generateCollisionDebugBuffers(v,a.collisionBoxArray)}function kP(a){switch(a){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function wte(a,t,r,c,u,h,m,g,v,b,w,A,C,P,k){let z=h.textMaxSize.evaluate(t,{},A);z===void 0&&(z=m);const U=a.layers[0].layout,W=U.get("icon-offset").evaluate(t,{},A),$=pF(r.horizontal)||r.vertical,Z=C.name==="globe",K=io,q=m/K,J=a.tilePixelRatio*z/K,re=(Ve=a.overscaling,a.zoom>18&&Ve>2&&(Ve>>=1),Math.max(mt/(512*Ve),1)*U.get("symbol-spacing")),ce=U.get("text-padding")*a.tilePixelRatio,ge=U.get("icon-padding")*a.tilePixelRatio,ve=ye(U.get("text-max-angle")),Ce=U.get("text-rotation-alignment")==="map"&&U.get("symbol-placement")!=="point",Ae=U.get("icon-rotation-alignment")==="map"&&U.get("symbol-placement")!=="point",Le=U.get("symbol-placement"),Se=re/2;var Ve;const Xe=U.get("icon-text-fit").evaluate(t,{},A),nt=U.get("icon-text-fit-padding").evaluate(t,{},A),We=Xe!=="none";let Ge;a.hasAnyIconTextFit===!1&&We&&(a.hasAnyIconTextFit=!0),c&&We&&(a.allowVerticalPlacement&&r.vertical&&(Ge=tF(c,r.vertical,Xe,nt,W,q)),$&&(c=tF(c,$,Xe,nt,W,q)));const ot=(yt,pt,Rt)=>{if(pt.x<0||pt.x>=mt||pt.y<0||pt.y>=mt)return;let Ft=null;if(Z){const{x:St,y:Tt,z:nn}=C.projectTilePoint(pt.x,pt.y,Rt);Ft={anchor:new lh(St,Tt,nn,0,void 0),up:C.upVector(Rt,pt.x,pt.y)}}(function(St,Tt,nn,sn,on,cn,yn,kn,ii,Ai,Yn,Wn,In,Mn,mi,Pi,ni,qi,Ea,la,ta,or,Ma,Fa,Xi,us,ed){const ch=St.addToLineVertexArray(Tt,sn);let uh,H1,j1,Q3,_9,b9,x9,w9=0,S9=0,A9=0,E9=0,k5=-1,D5=-1;const td={};let M9=LC("");const Dm=nn?nn.anchor:Tt,O5=ii.layout.get("icon-text-fit").evaluate(ta,{},Xi)!=="none";let N5=0,z5=0;if(ii._unevaluatedLayout.getValue("text-radial-offset")===void 0?[N5,z5]=ii.layout.get("text-offset").evaluate(ta,{},Xi).map(cl=>cl*io):(N5=ii.layout.get("text-radial-offset").evaluate(ta,{},Xi)*io,z5=LP),St.allowVerticalPlacement&&on.vertical){const cl=on.vertical;if(mi)b9=DP(cl),kn&&(x9=DP(kn));else{const ul=ii.layout.get("text-rotate").evaluate(ta,{},Xi)+90;j1=o3(Ai,Dm,Tt,Yn,Wn,In,cl,Mn,ul,Pi),kn&&(Q3=o3(Ai,Dm,Tt,Yn,Wn,In,kn,qi,ul))}}if(cn){const cl=ii.layout.get("icon-rotate").evaluate(ta,{},Xi),ul=uF(cn,cl,Ma,O5),Pv=kn?uF(kn,cl,Ma,O5):void 0;H1=o3(Ai,Dm,Tt,Yn,Wn,In,cn,qi,cl),w9=4*ul.length;const T9=St.iconSizeData;let Om=null;T9.kind==="source"?(Om=[Yc*ii.layout.get("icon-size").evaluate(ta,{},Xi)],Om[0]>Tp&&_e(`${St.layerIds[0]}: Value for "icon-size" is >= ${x1}. Reduce your "icon-size".`)):T9.kind==="composite"&&(Om=[Yc*or.compositeIconSizes[0].evaluate(ta,{},Xi),Yc*or.compositeIconSizes[1].evaluate(ta,{},Xi)],(Om[0]>Tp||Om[1]>Tp)&&_e(`${St.layerIds[0]}: Value for "icon-size" is >= ${x1}. Reduce your "icon-size".`)),St.addSymbols(St.icon,ul,Om,la,Ea,ta,!1,nn,Tt,ch.lineStartIndex,ch.lineLength,-1,Fa,Xi,us,ed),k5=St.icon.placedSymbolArray.length-1,Pv&&(S9=4*Pv.length,St.addSymbols(St.icon,Pv,Om,la,Ea,ta,Aa.vertical,nn,Tt,ch.lineStartIndex,ch.lineLength,-1,Fa,Xi,us,ed),D5=St.icon.placedSymbolArray.length-1)}for(const cl in on.horizontal){const ul=on.horizontal[cl];uh||(M9=LC(ul.text),mi?_9=DP(ul):uh=o3(Ai,Dm,Tt,Yn,Wn,In,ul,Mn,ii.layout.get("text-rotate").evaluate(ta,{},Xi),Pi));const Pv=ul.positionedLines.length===1;if(A9+=hF(St,nn,Tt,ul,yn,ii,mi,ta,Pi,ch,on.vertical?Aa.horizontal:Aa.horizontalOnly,Pv?Object.keys(on.horizontal):[cl],td,k5,or,Fa,Xi,us),Pv)break}on.vertical&&(E9+=hF(St,nn,Tt,on.vertical,yn,ii,mi,ta,Pi,ch,Aa.vertical,["vertical"],td,D5,or,Fa,Xi,us));let Op=-1;const F5=(cl,ul)=>cl?Math.max(cl,ul):ul;Op=F5(_9,Op),Op=F5(b9,Op),Op=F5(x9,Op);const aoe=Op>-1?1:0;St.glyphOffsetArray.length>=M1.MAX_GLYPHS&&_e("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),ta.sortKey!==void 0&&St.addToSortKeyRanges(St.symbolInstances.length,ta.sortKey),St.symbolInstances.emplaceBack(Tt.x,Tt.y,Dm.x,Dm.y,Dm.z,td.right>=0?td.right:-1,td.center>=0?td.center:-1,td.left>=0?td.left:-1,td.vertical>=0?td.vertical:-1,k5,D5,M9,uh!==void 0?uh:St.collisionBoxArray.length,uh!==void 0?uh+1:St.collisionBoxArray.length,j1!==void 0?j1:St.collisionBoxArray.length,j1!==void 0?j1+1:St.collisionBoxArray.length,H1!==void 0?H1:St.collisionBoxArray.length,H1!==void 0?H1+1:St.collisionBoxArray.length,Q3||St.collisionBoxArray.length,Q3?Q3+1:St.collisionBoxArray.length,Yn,A9,E9,w9,S9,aoe,0,N5,z5,Op,0,O5?1:0)})(a,pt,Ft,yt,r,c,u,Ge,a.layers[0],a.collisionBoxArray,t.index,t.sourceLayerIndex,a.index,ce,Ce,v,0,ge,Ae,W,t,h,b,w,A,P,k)};if(Le==="line")for(const yt of sF(t.geometry,0,0,mt,mt)){const pt=gte(yt,re,ve,r.vertical||$,c,K,J,a.overscaling,mt);for(const Rt of pt)$&&Ste(a,$.text,Se,Rt)||ot(yt,Rt,A)}else if(Le==="line-center"){for(const yt of t.geometry)if(yt.length>1){const pt=mte(yt,ve,r.vertical||$,c,K,J);pt&&ot(yt,pt,A)}}else if(t.type==="Polygon")for(const yt of vP(t.geometry,0)){const pt=vte(yt,16);ot(yt[0],new lh(pt.x,pt.y,0,0,void 0),A)}else if(t.type==="LineString")for(const yt of t.geometry)ot(yt,new lh(yt[0].x,yt[0].y,0,0,void 0),A);else if(t.type==="Point")for(const yt of t.geometry)for(const pt of yt)ot([pt],new lh(pt.x,pt.y,0,0,void 0),A)}const x1=255,Tp=x1*Yc;function hF(a,t,r,c,u,h,m,g,v,b,w,A,C,P,k,z,U,W){const $=function(q,J,re,ce,ge,ve,Ce,Ae){const Le=[];if(J.positionedLines.length===0)return Le;const Se=ce.layout.get("text-rotate").evaluate(ve,{})*Math.PI/180,Ve=function(ot){const yt=ot[0],pt=ot[1],Rt=yt*pt;return Rt>0?[yt,-pt]:Rt<0?[-yt,pt]:yt===0?[pt,yt]:[pt,-yt]}(re);let Xe=Math.abs(J.top-J.bottom);for(const ot of J.positionedLines)Xe-=ot.lineOffset;const nt=J.positionedLines.length,We=Xe/nt;let Ge=J.top-re[1];for(let ot=0;ot<nt;++ot){const yt=J.positionedLines[ot];Ge=yte(J,We,Ge,ot);for(const pt of yt.positionedGlyphs){if(!pt.rect)continue;const Rt=pt.rect||{};let Ft=Yz+1,St=!0,Tt=1,nn=0;if(pt.imageName){const la=Ce[pt.imageName];if(!la)continue;if(la.sdf){_e("SDF images are not supported in formatted text and will be ignored.");continue}St=!1,Tt=la.pixelRatio,Ft=Fs/Tt}const sn=(ge||Ae)&&pt.vertical,on=pt.metrics.advance*pt.scale/2,cn=pt.metrics,yn=pt.rect;if(yn===null)continue;Ae&&J.verticalizable&&(nn=pt.imageName?on-pt.metrics.width*pt.scale/2:0);const kn=ge?[pt.x+on,pt.y]:[0,0];let ii=[0,0],Ai=[0,0],Yn=!1;ge||(sn?(Ai=[pt.x+on+Ve[0],pt.y+Ve[1]-nn],Yn=!0):ii=[pt.x+on+re[0],pt.y+re[1]-nn]);const Wn=yn.w*pt.scale/(Tt*(pt.localGlyph?qc:1)),In=yn.h*pt.scale/(Tt*(pt.localGlyph?qc:1));let Mn,mi,Pi,ni;if(sn){const la=pt.y-Ge,ta=new V(-on,on-la),or=-Math.PI/2,Ma=new V(...Ai);Mn=new V(-on+ii[0],ii[1]),Mn._rotateAround(or,ta)._add(Ma),Mn.x+=-la+on,Mn.y-=(cn.left-Ft)*pt.scale;const Fa=pt.imageName?cn.advance*pt.scale:io*pt.scale,Xi=String.fromCodePoint(pt.glyph);ste(Xi)?Mn.x+=(1-Ft)*pt.scale:lte(Xi)?Mn.x+=Fa-cn.height*pt.scale+(-Ft-1)*pt.scale:Mn.x+=pt.imageName||cn.width+2*Ft===yn.w&&cn.height+2*Ft===yn.h?(Fa-In)/2:(Fa-(cn.height+2*Ft)*pt.scale)/2,mi=new V(Mn.x,Mn.y-Wn),Pi=new V(Mn.x+In,Mn.y),ni=new V(Mn.x+In,Mn.y-Wn)}else{const la=(cn.left-Ft)*pt.scale-on+ii[0],ta=(-cn.top-Ft)*pt.scale+ii[1],or=la+Wn,Ma=ta+In;Mn=new V(la,ta),mi=new V(or,ta),Pi=new V(la,Ma),ni=new V(or,Ma)}if(Se){let la;la=ge?new V(0,0):Yn?new V(Ve[0],Ve[1]):new V(re[0],re[1]),Mn._rotateAround(Se,la),mi._rotateAround(Se,la),Pi._rotateAround(Se,la),ni._rotateAround(Se,la)}const qi=new V(0,0),Ea=new V(0,0);Le.push({tl:Mn,tr:mi,bl:Pi,br:ni,texPrimary:Rt,texSecondary:void 0,writingMode:J.writingMode,glyphOffset:kn,sectionIndex:pt.sectionIndex,isSDF:St,pixelOffsetTL:qi,pixelOffsetBR:Ea,minFontScaleX:0,minFontScaleY:0})}}return Le}(0,c,v,h,m,g,u,a.allowVerticalPlacement),Z=a.textSizeData;let K=null;Z.kind==="source"?(K=[Yc*h.layout.get("text-size").evaluate(g,{},U)],K[0]>Tp&&_e(`${a.layerIds[0]}: Value for "text-size" is >= ${x1}. Reduce your "text-size".`)):Z.kind==="composite"&&(K=[Yc*k.compositeTextSizes[0].evaluate(g,{},U),Yc*k.compositeTextSizes[1].evaluate(g,{},U)],(K[0]>Tp||K[1]>Tp)&&_e(`${a.layerIds[0]}: Value for "text-size" is >= ${x1}. Reduce your "text-size".`)),a.addSymbols(a.text,$,K,v,m,g,w,t,r,b.lineStartIndex,b.lineLength,P,z,U,W,!1);for(const q of A)C[q]=a.text.placedSymbolArray.length-1;return 4*$.length}function pF(a){for(const t in a)return a[t];return null}function o3(a,t,r,c,u,h,m,g,v,b){let w=m.top,A=m.bottom,C=m.left,P=m.right;const k=m.collisionPadding;if(k&&(C-=k[0],w-=k[1],P+=k[2],A+=k[3]),v){const z=new V(C,w),U=new V(P,w),W=new V(C,A),$=new V(P,A),Z=ye(v);let K=new V(0,0);b&&(K=new V(b[0],b[1])),z._rotateAround(Z,K),U._rotateAround(Z,K),W._rotateAround(Z,K),$._rotateAround(Z,K),C=Math.min(z.x,U.x,W.x,$.x),P=Math.max(z.x,U.x,W.x,$.x),w=Math.min(z.y,U.y,W.y,$.y),A=Math.max(z.y,U.y,W.y,$.y)}return a.emplaceBack(t.x,t.y,t.z,r.x,r.y,C,w,P,A,g,c,u,h),a.length-1}function DP(a){a.collisionPadding&&(a.top-=a.collisionPadding[1],a.bottom+=a.collisionPadding[3]);const t=a.bottom-a.top;return t>0?Math.max(10,t):null}function Ste(a,t,r,c){const u=a.compareText;if(t in u){const h=u[t];for(let m=h.length-1;m>=0;m--)if(c.dist(h[m])<r)return!0}else u[t]=[];return u[t].push(c),!1}function fF(a,t){const r=a.fovAboveCenter,c=a.elevation?a.elevation.getMinElevationBelowMSL()*t:0,u=(a._camera.position[2]*a.worldSize-c)/Math.cos(a._pitch),h=Math.sin(r)*u/Math.sin(Math.max(Math.PI/2-a._pitch-r,.01)),m=Math.sin(a._pitch)*h+u;return Math.min(1.01*m,u*(1/a._horizonShift))}function Mm(a,t){if(!t.isReprojectedInTileSpace)return{scale:1<<a.z,x:a.x,y:a.y,x2:a.x+1,y2:a.y+1,projection:t};const r=Math.pow(2,-a.z),c=a.x*r,u=(a.x+1)*r,h=a.y*r,m=(a.y+1)*r,g=sl(c),v=sl(u),b=yr(h),w=yr(m),A=t.project(g,b),C=t.project(v,b),P=t.project(v,w),k=t.project(g,w);let z=Math.min(A.x,C.x,P.x,k.x),U=Math.min(A.y,C.y,P.y,k.y),W=Math.max(A.x,C.x,P.x,k.x),$=Math.max(A.y,C.y,P.y,k.y);const Z=r/16;function K(J,re,ce,ge,ve,Ce){const Ae=(ce+ve)/2,Le=(ge+Ce)/2,Se=t.project(sl(Ae),yr(Le)),Ve=Math.max(0,z-Se.x,U-Se.y,Se.x-W,Se.y-$);z=Math.min(z,Se.x),W=Math.max(W,Se.x),U=Math.min(U,Se.y),$=Math.max($,Se.y),Ve>Z&&(K(J,Se,ce,ge,Ae,Le),K(Se,re,Ae,Le,ve,Ce))}K(A,C,c,h,u,h),K(C,P,u,h,u,m),K(P,k,u,m,c,m),K(k,A,c,m,c,h),z-=Z,U-=Z,W+=Z,$+=Z;const q=1/Math.max(W-z,$-U);return{scale:q,x:z*q,y:U*q,x2:W*q,y2:$*q,projection:t}}function mF(a,t,r,c,u,h,m,g,v){if(v.name==="globe")return eP(a,t,new ju(r,c,u),!1);const b=Mm({z:r,x:c,y:u},v);return new ga([(h+b.x/b.scale)*t,t*(b.y/b.scale),m],[(h+b.x2/b.scale)*t,t*(b.y2/b.scale),g])}function gF(a,{x:t,y:r},c=0){return new V(((t-c)*a.scale-a.x)*mt,(r*a.scale-a.y)*mt)}function yF(a,t,r=0){return ke.fromValues(((t.x-r)*a.scale-a.x)*mt,(t.y*a.scale-a.y)*mt,rz(t.z,t.y))}const Ate=rt.identity(new Float32Array(16));class Cp{constructor(t){this.spec=t,this.name=t.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(t,r){return{x:0,y:0,z:0}}unproject(t,r){return new On(0,0)}projectTilePoint(t,r,c){return{x:t,y:r,z:0}}locationPoint(t,r,c=!0){return t._coordinatePoint(t.locationCoordinate(r),c)}pixelsPerMeter(t,r){return $i(1,t)*r}pixelSpaceConversion(t,r,c){return 1}farthestPixelDistance(t){return fF(t,t.pixelsPerMeter)}pointCoordinate(t,r,c,u){const h=t.horizonLineFromTop(!1),m=new V(r,Math.max(h,c));return t.rayIntersectionCoordinate(t.pointRayIntersection(m,u))}pointCoordinate3D(t,r,c){const u=new V(r,c);if(t.elevation)return t.elevation.pointCoordinate(u);{const h=this.pointCoordinate(t,u.x,u.y,0);return[h.x,h.y,h.z]}}isPointAboveHorizon(t,r){if(t.elevation)return!this.pointCoordinate3D(t,r.x,r.y);const c=t.horizonLineFromTop();return r.y<c}createInversionMatrix(t,r){return Ate}createTileMatrix(t,r,c){let u,h,m;const g=c.canonical,v=rt.identity(new Float64Array(16));if(this.isReprojectedInTileSpace){const b=Mm(g,this);u=1,h=b.x+c.wrap*b.scale,m=b.y,rt.scale(v,v,[u/b.scale,u/b.scale,t.pixelsPerMeter/r])}else u=r/t.zoomScale(g.z),h=(g.x+Math.pow(2,g.z)*c.wrap)*u,m=g.y*u;return rt.translate(v,v,[h,m,0]),rt.scale(v,v,[u/mt,u/mt,1]),v}upVector(t,r,c){return[0,0,1]}upVectorScale(t,r,c){return{metersToTile:1}}}class Ete extends Cp{constructor(t){super(t),this.range=[4,7],this.center=t.center||[-96,37.5];const[r,c]=this.parallels=t.parallels||[29.5,45.5],u=Math.sin(ye(r));this.n=(u+Math.sin(ye(c)))/2,this.c=1+u*(2*this.n-u),this.r0=Math.sqrt(this.c)/this.n}project(t,r){const{n:c,c:u,r0:h}=this,m=ye(t-this.center[0]),g=ye(r),v=Math.sqrt(u-2*c*Math.sin(g))/c;return{x:v*Math.sin(m*c),y:v*Math.cos(m*c)-h,z:0}}unproject(t,r){const{n:c,c:u,r0:h}=this,m=h+r;let g=Math.atan2(t,Math.abs(m))*Math.sign(m);m*c<0&&(g-=Math.PI*Math.sign(t)*Math.sign(m));const v=ye(this.center[0])*c;g=Je(g,-Math.PI-v,Math.PI-v);const b=ae(pe(g/c)+this.center[0],-180,180),w=Math.asin(ae((u-(t*t+m*m)*c*c)/(2*c),-1,1)),A=ae(pe(w),-qa,qa);return new On(b,A)}}const w1=1.340264,S1=-.081106,A1=893e-6,E1=.003796,s3=Math.sqrt(3)/2;class Mte extends Cp{project(t,r){r=r/180*Math.PI,t=t/180*Math.PI;const c=Math.asin(s3*Math.sin(r)),u=c*c,h=u*u*u;return{x:.5*(t*Math.cos(c)/(s3*(w1+3*S1*u+h*(7*A1+9*E1*u)))/Math.PI+.5),y:1-.5*(c*(w1+S1*u+h*(A1+E1*u))/Math.PI+1),z:0}}unproject(t,r){t=(2*t-.5)*Math.PI;let c=r=(2*(1-r)-1)*Math.PI,u=c*c,h=u*u*u;for(let w,A,C,P=0;P<12&&(A=c*(w1+S1*u+h*(A1+E1*u))-r,C=w1+3*S1*u+h*(7*A1+9*E1*u),w=A/C,c=ae(c-w,-Math.PI/3,Math.PI/3),u=c*c,h=u*u*u,!(Math.abs(w)<1e-12));++P);const m=s3*t*(w1+3*S1*u+h*(7*A1+9*E1*u))/Math.cos(c),g=Math.asin(Math.sin(c)/s3),v=ae(180*m/Math.PI,-180,180),b=ae(180*g/Math.PI,-qa,qa);return new On(v,b)}}class Tte extends Cp{constructor(t){super(t),this.wrap=!0,this.supportsWorldCopies=!0}project(t,r){return{x:.5+t/360,y:.5-r/360,z:0}}unproject(t,r){const c=360*(t-.5),u=ae(360*(.5-r),-qa,qa);return new On(c,u)}}const _v=Math.PI/2;function l3(a){return Math.tan((_v+a)/2)}class Cte extends Cp{constructor(t){super(t),this.center=t.center||[0,30];const[r,c]=this.parallels=t.parallels||[30,30];let u=ye(r),h=ye(c);this.southernCenter=u+h<0,this.southernCenter&&(u=-u,h=-h);const m=Math.cos(u),g=l3(u);this.n=u===h?Math.sin(u):Math.log(m/Math.cos(h))/Math.log(l3(h)/g),this.f=m*Math.pow(l3(u),this.n)/this.n}project(t,r){r=ye(r),this.southernCenter&&(r=-r),t=ye(t-this.center[0]);const c=1e-6,{n:u,f:h}=this;h>0?r<-_v+c&&(r=-_v+c):r>_v-c&&(r=_v-c);const m=h/Math.pow(l3(r),u);let g=m*Math.sin(u*t),v=h-m*Math.cos(u*t);return g=.5*(g/Math.PI+.5),v=.5*(v/Math.PI+.5),{x:g,y:this.southernCenter?v:1-v,z:0}}unproject(t,r){t=(2*t-.5)*Math.PI,this.southernCenter&&(r=1-r),r=(2*(1-r)-.5)*Math.PI;const{n:c,f:u}=this,h=u-r,m=Math.sign(h),g=Math.sign(c)*Math.sqrt(t*t+h*h);let v=Math.atan2(t,Math.abs(h))*m;h*c<0&&(v-=Math.PI*Math.sign(t)*m);const b=ae(pe(v/c)+this.center[0],-180,180),w=ae(pe(2*Math.atan(Math.pow(u/g,1/c))-_v),-qa,qa);return new On(b,this.southernCenter?-w:w)}}class vF extends Cp{constructor(t){super(t),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(t,r){return{x:vo(t),y:Co(r),z:0}}unproject(t,r){const c=sl(t),u=yr(r);return new On(c,u)}}const _F=ye(qa);class Pte extends Cp{project(t,r){const c=(r=ye(r))*r,u=c*c;return{x:.5*((t=ye(t))*(.8707-.131979*c+u*(u*(.003971*c-.001529*u)-.013791))/Math.PI+.5),y:1-.5*(r*(1.007226+c*(.015085+u*(.028874*c-.044475-.005916*u)))/Math.PI+1),z:0}}unproject(t,r){t=(2*t-.5)*Math.PI;let c=r=(2*(1-r)-1)*Math.PI,u=25,h=0,m=c*c;do{m=c*c;const b=m*m;h=(c*(1.007226+m*(.015085+b*(.028874*m-.044475-.005916*b)))-r)/(1.007226+m*(.045255+b*(.259866*m-.311325-.005916*11*b))),c=ae(c-h,-_F,_F)}while(Math.abs(h)>1e-6&&--u>0);m=c*c;const g=ae(pe(t/(.8707+m*(m*(m*m*m*(.003971-.001529*m)-.013791)-.131979))),-180,180),v=pe(c);return new On(g,v)}}const bF=ye(qa);class Ite extends Cp{project(t,r){r=ye(r),t=ye(t);const c=Math.cos(r),u=2/Math.PI,h=Math.acos(c*Math.cos(t/2)),m=Math.sin(h)/h,g=.5*(t*u+2*c*Math.sin(t/2)/m)||0,v=.5*(r+Math.sin(r)/m)||0;return{x:.5*(g/Math.PI+.5),y:1-.5*(v/Math.PI+1),z:0}}unproject(t,r){let c=t=(2*t-.5)*Math.PI,u=r=(2*(1-r)-1)*Math.PI,h=25;const m=1e-6;let g=0,v=0;do{const b=Math.cos(u),w=Math.sin(u),A=2*w*b,C=w*w,P=b*b,k=Math.cos(c/2),z=Math.sin(c/2),U=2*k*z,W=z*z,$=1-P*k*k,Z=$?1/$:0,K=$?Math.acos(b*k)*Math.sqrt(1/$):0,q=.5*(2*K*b*z+2*c/Math.PI)-t,J=.5*(K*w+u)-r,re=.5*Z*(P*W+K*b*k*C)+1/Math.PI,ce=Z*(U*A/4-K*w*z),ge=.125*Z*(A*z-K*w*P*U),ve=.5*Z*(C*k+K*W*b)+.5,Ce=ce*ge-ve*re;g=(J*ce-q*ve)/Ce,v=(q*ge-J*re)/Ce,c=ae(c-g,-Math.PI,Math.PI),u=ae(u-v,-bF,bF)}while((Math.abs(g)>m||Math.abs(v)>m)&&--h>0);return new On(pe(c),pe(u))}}class xF extends Cp{constructor(t){super(t),this.center=t.center||[0,0],this.parallels=t.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(ye(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(t,r){const{scale:c,cosPhi:u}=this;return{x:ye(t)*u*c+.5,y:-Math.sin(ye(r))/u*c+.5,z:0}}unproject(t,r){const{scale:c,cosPhi:u}=this,h=-(r-.5)/c,m=ae(pe((t-.5)/c)/u,-180,180),g=Math.asin(ae(h*u,-1,1)),v=ae(pe(g),-qa,qa);return new On(m,v)}}class Lte extends vF{constructor(t){super(t),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(t,r,c){const u=h1(t,r,c),h=Sm(gc(c));return ke.transformMat4(u,u,h),{x:u[0],y:u[1],z:u[2]}}locationPoint(t,r){const c=zs(r.lat,r.lng),u=ke.normalize([],c),h=t.elevation?t.elevation.getAtPointOrZero(t.locationCoordinate(r),t._centerAltitude):t._centerAltitude,m=$i(1,0)*mt*h;ke.scaleAndAdd(c,c,u,m);const g=rt.identity(new Float64Array(16));return rt.multiply(g,t.pixelMatrix,t.globeMatrix),ke.transformMat4(c,c,g),new V(c[0],c[1])}pixelsPerMeter(t,r){return $i(1,0)*r}pixelSpaceConversion(t,r,c){const u=$i(1,t)*r,h=Ln($i(1,45)*r,u,c);return this.pixelsPerMeter(t,r)/h}createTileMatrix(t,r,c){const u=nP(gc(c.canonical));return rt.multiply(new Float64Array(16),t.globeMatrix,u)}createInversionMatrix(t,r){const{center:c}=t,u=Sm(gc(r));return rt.rotateY(u,u,ye(c.lng)),rt.rotateX(u,u,ye(c.lat)),rt.scale(u,u,[t._pixelsPerMercatorPixel,t._pixelsPerMercatorPixel,1]),Float32Array.from(u)}pointCoordinate(t,r,c,u){return qN(t,r,c,!0)||new vi(0,0)}pointCoordinate3D(t,r,c){const u=this.pointCoordinate(t,r,c,0);return[u.x,u.y,u.z]}isPointAboveHorizon(t,r){return!qN(t,r.x,r.y,!1)}farthestPixelDistance(t){const r=function(u,h){const m=u.cameraToCenterDistance,g=u._centerAltitude*h,v=u._camera,b=u._camera.forward(),w=ke.add([],ke.scale([],b,-m),[0,0,g]),A=u.worldSize/(2*Math.PI),C=[0,0,-A],P=u.width/u.height,k=Math.tan(u.fovAboveCenter),z=ke.scale([],v.up(),k),U=ke.scale([],v.right(),k*P),W=ke.normalize([],ke.add([],ke.add([],b,z),U)),$=[];let Z;if(new k2(w,W).closestPointOnSphere(C,A,$)){const K=ke.add([],$,C),q=ke.sub([],K,w);Z=Math.cos(u.fovAboveCenter)*ke.length(q)}else{const K=ke.sub([],w,C),q=ke.sub([],C,w);ke.normalize(q,q);const J=ke.length(K)-A;Z=Math.sqrt(J*(J+2*A));const re=Math.acos(Z/(A+J))-Math.acos(ke.dot(b,q));Z*=Math.cos(re)}return 1.01*Z}(t,this.pixelsPerMeter(t.center.lat,t.worldSize)),c=yo(t.zoom);if(c>0){const u=fF(t,$i(1,t.center.lat)*t.worldSize),h=t.worldSize/(2*Math.PI),m=Math.max(t.width,t.height)/t.worldSize*Math.PI;return Ln(r,u+h*(1-Math.cos(m)),Math.pow(c,10))}return r}upVector(t,r,c){return h1(r,c,t,1)}upVectorScale(t){return{metersToTile:D2(N2(gc(t)))}}}function c3(a){const t=a.parallels,r=!!t&&Math.abs(t[0]+t[1])<.01;switch(a.name){case"mercator":return new vF(a);case"equirectangular":return new Tte(a);case"naturalEarth":return new Pte(a);case"equalEarth":return new Mte(a);case"winkelTripel":return new Ite(a);case"albers":return r?new xF(a):new Ete(a);case"lambertConformalConic":return r?new xF(a):new Cte(a);case"globe":return new Lte(a)}throw new Error(`Invalid projection name: ${a.name}`)}const Rte=new xa({"symbol-placement":new Zt(at.layout_symbol["symbol-placement"]),"symbol-spacing":new Zt(at.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Zt(at.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new _n(at.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Zt(at.layout_symbol["symbol-z-order"]),"symbol-z-elevate":new Zt(at.layout_symbol["symbol-z-elevate"]),"icon-allow-overlap":new Zt(at.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Zt(at.layout_symbol["icon-ignore-placement"]),"icon-optional":new Zt(at.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Zt(at.layout_symbol["icon-rotation-alignment"]),"icon-size":new _n(at.layout_symbol["icon-size"]),"icon-text-fit":new _n(at.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new _n(at.layout_symbol["icon-text-fit-padding"]),"icon-image":new _n(at.layout_symbol["icon-image"]),"icon-rotate":new _n(at.layout_symbol["icon-rotate"]),"icon-padding":new Zt(at.layout_symbol["icon-padding"]),"icon-keep-upright":new Zt(at.layout_symbol["icon-keep-upright"]),"icon-offset":new _n(at.layout_symbol["icon-offset"]),"icon-anchor":new _n(at.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Zt(at.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Zt(at.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Zt(at.layout_symbol["text-rotation-alignment"]),"text-field":new _n(at.layout_symbol["text-field"]),"text-font":new _n(at.layout_symbol["text-font"]),"text-size":new _n(at.layout_symbol["text-size"]),"text-max-width":new _n(at.layout_symbol["text-max-width"]),"text-line-height":new _n(at.layout_symbol["text-line-height"]),"text-letter-spacing":new _n(at.layout_symbol["text-letter-spacing"]),"text-justify":new _n(at.layout_symbol["text-justify"]),"text-radial-offset":new _n(at.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Zt(at.layout_symbol["text-variable-anchor"]),"text-anchor":new _n(at.layout_symbol["text-anchor"]),"text-max-angle":new Zt(at.layout_symbol["text-max-angle"]),"text-writing-mode":new Zt(at.layout_symbol["text-writing-mode"]),"text-rotate":new _n(at.layout_symbol["text-rotate"]),"text-padding":new Zt(at.layout_symbol["text-padding"]),"text-keep-upright":new Zt(at.layout_symbol["text-keep-upright"]),"text-transform":new _n(at.layout_symbol["text-transform"]),"text-offset":new _n(at.layout_symbol["text-offset"]),"text-allow-overlap":new Zt(at.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Zt(at.layout_symbol["text-ignore-placement"]),"text-optional":new Zt(at.layout_symbol["text-optional"]),visibility:new Zt(at.layout_symbol.visibility)});var OP={paint:new xa({"icon-opacity":new _n(at.paint_symbol["icon-opacity"]),"icon-emissive-strength":new _n(at.paint_symbol["icon-emissive-strength"]),"text-emissive-strength":new _n(at.paint_symbol["text-emissive-strength"]),"icon-color":new _n(at.paint_symbol["icon-color"]),"icon-halo-color":new _n(at.paint_symbol["icon-halo-color"]),"icon-halo-width":new _n(at.paint_symbol["icon-halo-width"]),"icon-halo-blur":new _n(at.paint_symbol["icon-halo-blur"]),"icon-translate":new Zt(at.paint_symbol["icon-translate"]),"icon-translate-anchor":new Zt(at.paint_symbol["icon-translate-anchor"]),"icon-image-cross-fade":new _n(at.paint_symbol["icon-image-cross-fade"]),"text-opacity":new _n(at.paint_symbol["text-opacity"]),"text-color":new _n(at.paint_symbol["text-color"],{runtimeType:Qa,getOverride:a=>a.textColor,hasOverride:a=>!!a.textColor}),"text-halo-color":new _n(at.paint_symbol["text-halo-color"]),"text-halo-width":new _n(at.paint_symbol["text-halo-width"]),"text-halo-blur":new _n(at.paint_symbol["text-halo-blur"]),"text-translate":new Zt(at.paint_symbol["text-translate"]),"text-translate-anchor":new Zt(at.paint_symbol["text-translate-anchor"])}),layout:Rte};class wF{constructor(t){this.type=t.property.overrides?t.property.overrides.runtimeType:Ks,this.defaultValue=t}evaluate(t){if(t.formattedSection){const r=this.defaultValue.property.overrides;if(r&&r.hasOverride(t.formattedSection))return r.getOverride(t.formattedSection)}return t.feature&&t.featureState?this.defaultValue.evaluate(t.feature,t.featureState):this.defaultValue.property.specification.default}eachChild(t){this.defaultValue.isConstant()||t(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}un(wF,"FormatSectionOverride",{omit:["defaultValue"]});class u3 extends qo{constructor(t,r){super(t,OP,r)}recalculate(t,r){super.recalculate(t,r),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const c=this.layout.get("text-writing-mode");if(c){const u=[];for(const h of c)u.indexOf(h)<0&&u.push(h);this.layout._values["text-writing-mode"]=u}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getValueAndResolveTokens(t,r,c,u){const h=this.layout.get(t).evaluate(r,{},c,u),m=this._unevaluatedLayout._values[t];return m.isDataDriven()||im(m.value)||!h?h:function(g,v){return v.replace(/{([^{}]+)}/g,(b,w)=>w in g?String(g[w]):"")}(r.properties,h)}createBucket(t){return new M1(t)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const t of OP.paint.overridableProperties){if(!u3.hasPaintOverride(this.layout,t))continue;const r=this.paint.get(t),c=new wF(r),u=new nm(c,r.property.specification);let h=null;h=r.value.kind==="constant"||r.value.kind==="source"?new ky("source",u):new Bc("composite",u,r.value.zoomStops,r.value._interpolationType),this.paint._values[t]=new rl(r.property,h,r.parameters)}}_handleOverridablePaintPropertyUpdate(t,r,c){return!(!this.layout||r.isDataDriven()||c.isDataDriven())&&u3.hasPaintOverride(this.layout,t)}static hasPaintOverride(t,r){const c=t.get("text-field"),u=OP.paint.properties[r];let h=!1;const m=g=>{for(const v of g)if(u.overrides&&u.overrides.hasOverride(v))return void(h=!0)};if(c.value.kind==="constant"&&c.value.value instanceof Er)m(c.value.value.sections);else if(c.value.kind==="source"){const g=b=>{h||(b instanceof Mu&&Ra(b.value)===kc?m(b.value.sections):b instanceof Kh?m(b.sections):b.eachChild(g))},v=c.value;v._styleExpression&&g(v._styleExpression.expression)}return h}getProgramIds(){const t=this.paint.get("icon-opacity").constantOr(1)!==0,r=this.paint.get("text-opacity").constantOr(1)!==0,c=[];return t&&c.push("symbolIcon"),r&&c.push("symbolSDF"),c}getDefaultProgramParams(t,r){return{config:new bm(this,r),overrideFog:!1}}}const kte=Z2.types,Dte=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function d3(a,t,r,c,u,h,m,g,v,b,w,A,C){const P=g?Math.min(Tp,Math.round(g[0])):0,k=g?Math.min(Tp,Math.round(g[1])):0;a.emplaceBack(t,r,Math.round(32*c),Math.round(32*u),h,m,(P<<1)+(v?1:0),k,16*b,16*w,256*A,256*C)}function h3(a,t,r){a.emplaceBack(t,r)}function p3(a,t,r,c,u,h,m){a.emplaceBack(t,r,c,u,h,m)}function f3(a,t,r,c,u){const h=5*t+2;a.float32[h+0]=r,a.float32[h+1]=c,a.float32[h+2]=u}function bv(a,t,r,c,u){a.emplaceBack(t,r,c,u),a.emplaceBack(t,r,c,u),a.emplaceBack(t,r,c,u),a.emplaceBack(t,r,c,u)}function Ote(a){for(const t of a.sections)if(EC(t.text))return!0;return!1}class NP{constructor(t){this.layoutVertexArray=new wa,this.indexArray=new Fn,this.programConfigurations=t,this.segments=new ji,this.dynamicLayoutVertexArray=new dn,this.opacityVertexArray=new go,this.placedSymbolArray=new fO,this.iconTransitioningVertexArray=new eo,this.globeExtVertexArray=new Hn,this.zOffsetVertexArray=new gr}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0&&this.iconTransitioningVertexArray.length===0}upload(t,r,c,u,h){this.isEmpty()||(c&&(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Kee.members),this.indexBuffer=t.createIndexBuffer(this.indexArray,r),this.dynamicLayoutVertexBuffer=t.createVertexBuffer(this.dynamicLayoutVertexArray,Qee.members,!0),this.opacityVertexBuffer=t.createVertexBuffer(this.opacityVertexArray,Dte,!0),this.iconTransitioningVertexArray.length>0&&(this.iconTransitioningVertexBuffer=t.createVertexBuffer(this.iconTransitioningVertexArray,tte.members,!0)),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=t.createVertexBuffer(this.globeExtVertexArray,Jee.members,!0)),!this.zOffsetVertexBuffer&&(this.zOffsetVertexArray.length>0||h)&&(this.zOffsetVertexBuffer=t.createVertexBuffer(this.zOffsetVertexArray,ete.members,!0)),this.opacityVertexBuffer.itemSize=1),(c||u)&&this.programConfigurations.upload(t))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.iconTransitioningVertexBuffer&&this.iconTransitioningVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy(),this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy())}}un(NP,"SymbolBuffers");class zP{constructor(t,r,c){this.layoutVertexArray=new t,this.layoutAttributes=r,this.indexArray=new c,this.segments=new ji,this.collisionVertexArray=new En,this.collisionVertexArrayExt=new Dn}upload(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,nte.members,!0),this.collisionVertexBufferExt=t.createVertexBuffer(this.collisionVertexArrayExt,ite.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}un(zP,"CollisionBuffers");class m3{constructor(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(m=>m.fqid),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.hasAnyIconTextFit=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=rt.identity([]),this.placementViewportMatrix=rt.identity([]);const r=this.layers[0]._unevaluatedLayout._values;this.textSizeData=MP(this.zoom,r["text-size"]),this.iconSizeData=MP(this.zoom,r["icon-size"]);const c=this.layers[0].layout,u=c.get("symbol-sort-key"),h=c.get("symbol-z-order");this.canOverlap=c.get("text-allow-overlap")||c.get("icon-allow-overlap")||c.get("text-ignore-placement")||c.get("icon-ignore-placement"),this.sortFeaturesByKey=h!=="viewport-y"&&u.constantOr(1)!==void 0,this.sortFeaturesByY=(h==="viewport-y"||h==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=c.get("text-writing-mode").map(m=>Aa[m]),this.stateDependentLayerIds=this.layers.filter(m=>m.isStateDependent()).map(m=>m.id),this.sourceID=t.sourceID,this.projection=t.projection,this.hasAnyZOffset=!1,this.zOffsetSortDirty=!1,this.zOffsetBuffersNeedUpload=c.get("symbol-z-elevate")}createArrays(){this.text=new NP(new yp(this.layers,this.zoom,t=>/^text/.test(t))),this.icon=new NP(new yp(this.layers,this.zoom,t=>/^icon/.test(t))),this.glyphOffsetArray=new yO,this.lineVertexArray=new vO,this.symbolInstances=new gO}calculateGlyphDependencies(t,r,c,u,h){for(let m=0;m<t.length;m++){const g=t.codePointAt(m);if(g===void 0)break;if(r[g]=!0,u&&h&&g<=65535){const v=v1[t.charAt(m)];v&&(r[v.charCodeAt(0)]=!0)}}}populate(t,r,c,u){const h=this.layers[0],m=h.layout,g=this.projection.name==="globe",v=m.get("text-font"),b=m.get("text-field"),w=m.get("icon-image"),A=(b.value.kind!=="constant"||b.value.value instanceof Er&&!b.value.value.isEmpty()||b.value.value.toString().length>0)&&(v.value.kind!=="constant"||v.value.value.length>0),C=w.value.kind!=="constant"||!!w.value.value||Object.keys(w.parameters).length>0,P=m.get("symbol-sort-key");if(this.features=[],!A&&!C)return;const k=r.iconDependencies,z=r.glyphDependencies,U=r.availableImages,W=new sa(this.zoom);for(const{feature:$,id:Z,index:K,sourceLayerIndex:q}of t){const J=h._featureFilter.needGeometry,re=Sp($,J);if(!h._featureFilter.filter(W,re,c))continue;if(J||(re.geometry=$u($,c,u)),g&&$.type!==1&&c.z<=5){const Ce=re.geometry,Ae=.98078528056,Le=(Se,Ve)=>{const Xe=h1(Se.x,Se.y,c,1),nt=h1(Ve.x,Ve.y,c,1);return ke.dot(Xe,nt)<Ae};for(let Se=0;Se<Ce.length;Se++)Ce[Se]=YQ(Ce[Se],Le)}let ce,ge;if(A){const Ce=h.getValueAndResolveTokens("text-field",re,c,U),Ae=Er.factory(Ce);Ote(Ae)&&(this.hasRTLText=!0),(!this.hasRTLText||n1()==="unavailable"||this.hasRTLText&&Ds.isParsed())&&(ce=ote(Ae,h,re))}if(C){const Ce=h.getValueAndResolveTokens("icon-image",re,c,U);ge=Ce instanceof ts?Ce:ts.fromString(Ce)}if(!ce&&!ge)continue;const ve=this.sortFeaturesByKey?P.evaluate(re,{},c):void 0;if(this.features.push({id:Z,text:ce,icon:ge,index:K,sourceLayerIndex:q,geometry:re.geometry,properties:$.properties,type:kte[$.type],sortKey:ve}),ge&&(k[ge.namePrimary]=!0,ge.nameSecondary&&(k[ge.nameSecondary]=!0)),ce){const Ce=v.evaluate(re,{},c).join(","),Ae=m.get("text-rotation-alignment")==="map"&&m.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Aa.vertical)>=0;for(const Le of ce.sections)if(Le.image)k[Le.image.namePrimary]=!0;else{const Se=ym(ce.toString()),Ve=Le.fontStack||Ce,Xe=z[Ve]=z[Ve]||{};this.calculateGlyphDependencies(Le.text,Xe,Ae,this.allowVerticalPlacement,Se)}}}m.get("symbol-placement")==="line"&&(this.features=function($){const Z={},K={},q=[];let J=0;function re(Ce){q.push($[Ce]),J++}function ce(Ce,Ae,Le){const Se=K[Ce];return delete K[Ce],K[Ae]=Se,q[Se].geometry[0].pop(),q[Se].geometry[0]=q[Se].geometry[0].concat(Le[0]),Se}function ge(Ce,Ae,Le){const Se=Z[Ae];return delete Z[Ae],Z[Ce]=Se,q[Se].geometry[0].shift(),q[Se].geometry[0]=Le[0].concat(q[Se].geometry[0]),Se}function ve(Ce,Ae,Le){const Se=Le?Ae[0][Ae[0].length-1]:Ae[0][0];return`${Ce}:${Se.x}:${Se.y}`}for(let Ce=0;Ce<$.length;Ce++){const Ae=$[Ce],Le=Ae.geometry,Se=Ae.text?Ae.text.toString():null;if(!Se){re(Ce);continue}const Ve=ve(Se,Le),Xe=ve(Se,Le,!0);if(Ve in K&&Xe in Z&&K[Ve]!==Z[Xe]){const nt=ge(Ve,Xe,Le),We=ce(Ve,Xe,q[nt].geometry);delete Z[Ve],delete K[Xe],K[ve(Se,q[We].geometry,!0)]=We,q[nt].geometry=null}else Ve in K?ce(Ve,Xe,Le):Xe in Z?ge(Ve,Xe,Le):(re(Ce),Z[Ve]=J-1,K[Xe]=J-1)}return q.filter(Ce=>Ce.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort(($,Z)=>$.sortKey-Z.sortKey)}update(t,r,c,u,h){const m=Object.keys(t).length!==0;if(m&&!this.stateDependentLayers.length)return;const g=m?this.stateDependentLayers:this.layers;this.text.programConfigurations.updatePaintArrays(t,r,g,c,u,h),this.icon.programConfigurations.updatePaintArrays(t,r,g,c,u,h)}updateZOffset(){const t=(h,m,g)=>{c+=m,c>h.length&&h.resize(c);for(let v=-m;v<0;v++)h.emplace(v+c,g)},r=(h,m,g)=>{u+=m,u>h.length&&h.resize(u);for(let v=-m;v<0;v++)h.emplace(v+u,g)};if(!this.zOffsetBuffersNeedUpload)return;this.zOffsetBuffersNeedUpload=!1;let c=0,u=0;for(let h=0;h<this.symbolInstances.length;h++){const m=this.symbolInstances.get(h),{numHorizontalGlyphVertices:g,numVerticalGlyphVertices:v,numIconVertices:b}=m,w=m.zOffset,A=b>0;if((g>0||v>0)&&(t(this.text.zOffsetVertexArray,g,w),t(this.text.zOffsetVertexArray,v,w)),A){const{placedIconSymbolIndex:C,verticalPlacedIconSymbolIndex:P}=m;C>=0&&r(this.icon.zOffsetVertexArray,b,w),P>=0&&r(this.icon.zOffsetVertexArray,m.numVerticalIconVertices,w)}}this.text.zOffsetVertexBuffer&&this.text.zOffsetVertexBuffer.updateData(this.text.zOffsetVertexArray),this.icon.zOffsetVertexBuffer&&this.icon.zOffsetVertexBuffer.updateData(this.icon.zOffsetVertexArray)}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(t){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(t),this.iconCollisionBox.upload(t)),this.text.upload(t,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.icon.upload(t,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=c3(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(t,r){const c=this.lineVertexArray.length;if(t.segment!==void 0)for(const{x:u,y:h}of r)this.lineVertexArray.emplaceBack(u,h);return{lineStartIndex:c,lineLength:this.lineVertexArray.length-c}}addSymbols(t,r,c,u,h,m,g,v,b,w,A,C,P,k,z,U){const W=t.indexArray,$=t.layoutVertexArray,Z=t.globeExtVertexArray,K=t.segments.prepareSegment(4*r.length,$,W,this.canOverlap?m.sortKey:void 0),q=this.glyphOffsetArray.length,J=K.vertexLength,re=this.allowVerticalPlacement&&g===Aa.vertical?Math.PI/2:0,ce=m.text&&m.text.sections;for(let ve=0;ve<r.length;ve++){const{tl:Ce,tr:Ae,bl:Le,br:Se,texPrimary:Ve,texSecondary:Xe,pixelOffsetTL:nt,pixelOffsetBR:We,minFontScaleX:Ge,minFontScaleY:ot,glyphOffset:yt,isSDF:pt,sectionIndex:Rt}=r[ve],Ft=K.vertexLength,St=yt[1];if(d3($,b.x,b.y,Ce.x,St+Ce.y,Ve.x,Ve.y,c,pt,nt.x,nt.y,Ge,ot),d3($,b.x,b.y,Ae.x,St+Ae.y,Ve.x+Ve.w,Ve.y,c,pt,We.x,nt.y,Ge,ot),d3($,b.x,b.y,Le.x,St+Le.y,Ve.x,Ve.y+Ve.h,c,pt,nt.x,We.y,Ge,ot),d3($,b.x,b.y,Se.x,St+Se.y,Ve.x+Ve.w,Ve.y+Ve.h,c,pt,We.x,We.y,Ge,ot),v){const{x:Tt,y:nn,z:sn}=v.anchor,[on,cn,yn]=v.up;p3(Z,Tt,nn,sn,on,cn,yn),p3(Z,Tt,nn,sn,on,cn,yn),p3(Z,Tt,nn,sn,on,cn,yn),p3(Z,Tt,nn,sn,on,cn,yn),bv(t.dynamicLayoutVertexArray,Tt,nn,sn,re)}else bv(t.dynamicLayoutVertexArray,b.x,b.y,b.z,re);if(U){const Tt=Xe||Ve;h3(t.iconTransitioningVertexArray,Tt.x,Tt.y),h3(t.iconTransitioningVertexArray,Tt.x+Tt.w,Tt.y),h3(t.iconTransitioningVertexArray,Tt.x,Tt.y+Tt.h),h3(t.iconTransitioningVertexArray,Tt.x+Tt.w,Tt.y+Tt.h)}W.emplaceBack(Ft,Ft+1,Ft+2),W.emplaceBack(Ft+1,Ft+2,Ft+3),K.vertexLength+=4,K.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(yt[0]),ve!==r.length-1&&Rt===r[ve+1].sectionIndex||t.programConfigurations.populatePaintArrays($.length,m,m.index,{},P,k,z,ce&&ce[Rt])}const ge=v?v.anchor:b;t.placedSymbolArray.emplaceBack(ge.x,ge.y,ge.z,b.x,b.y,q,this.glyphOffsetArray.length-q,J,w,A,b.segment,c?c[0]:0,c?c[1]:0,u[0],u[1],g,0,!1,0,C,0)}_commitLayoutVertex(t,r,c,u,h,m,g){t.emplaceBack(r,c,u,h,m,Math.round(g.x),Math.round(g.y))}_addCollisionDebugVertices(t,r,c,u,h,m,g){const v=c.segments.prepareSegment(4,c.layoutVertexArray,c.indexArray),b=v.vertexLength,w=g.tileAnchorX,A=g.tileAnchorY;for(let P=0;P<4;P++)c.collisionVertexArray.emplaceBack(0,0,0,0);c.collisionVertexArrayExt.emplaceBack(r,-t.padding,-t.padding),c.collisionVertexArrayExt.emplaceBack(r,t.padding,-t.padding),c.collisionVertexArrayExt.emplaceBack(r,t.padding,t.padding),c.collisionVertexArrayExt.emplaceBack(r,-t.padding,t.padding),this._commitLayoutVertex(c.layoutVertexArray,u,h,m,w,A,new V(t.x1,t.y1)),this._commitLayoutVertex(c.layoutVertexArray,u,h,m,w,A,new V(t.x2,t.y1)),this._commitLayoutVertex(c.layoutVertexArray,u,h,m,w,A,new V(t.x2,t.y2)),this._commitLayoutVertex(c.layoutVertexArray,u,h,m,w,A,new V(t.x1,t.y2)),v.vertexLength+=4;const C=c.indexArray;C.emplaceBack(b,b+1),C.emplaceBack(b+1,b+2),C.emplaceBack(b+2,b+3),C.emplaceBack(b+3,b),v.primitiveLength+=4}_addTextDebugCollisionBoxes(t,r,c,u,h,m){for(let g=u;g<h;g++){const v=c.get(g),b=this.getSymbolInstanceTextSize(t,m,r,g);this._addCollisionDebugVertices(v,b,this.textCollisionBox,v.projectedAnchorX,v.projectedAnchorY,v.projectedAnchorZ,m)}}_addIconDebugCollisionBoxes(t,r,c,u,h,m){for(let g=u;g<h;g++){const v=c.get(g),b=this.getSymbolInstanceIconSize(t,r,m.placedIconSymbolIndex);this._addCollisionDebugVertices(v,b,this.iconCollisionBox,v.projectedAnchorX,v.projectedAnchorY,v.projectedAnchorZ,m)}}generateCollisionDebugBuffers(t,r){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new zP(Mt,$z.members,eo),this.iconCollisionBox=new zP(Mt,$z.members,eo);const c=Yu(this.iconSizeData,t),u=Yu(this.textSizeData,t);for(let h=0;h<this.symbolInstances.length;h++){const m=this.symbolInstances.get(h);this._addTextDebugCollisionBoxes(u,t,r,m.textBoxStartIndex,m.textBoxEndIndex,m),this._addTextDebugCollisionBoxes(u,t,r,m.verticalTextBoxStartIndex,m.verticalTextBoxEndIndex,m),this._addIconDebugCollisionBoxes(c,t,r,m.iconBoxStartIndex,m.iconBoxEndIndex,m),this._addIconDebugCollisionBoxes(c,t,r,m.verticalIconBoxStartIndex,m.verticalIconBoxEndIndex,m)}}getSymbolInstanceTextSize(t,r,c,u){const h=this.text.placedSymbolArray.get(r.rightJustifiedTextSymbolIndex>=0?r.rightJustifiedTextSymbolIndex:r.centerJustifiedTextSymbolIndex>=0?r.centerJustifiedTextSymbolIndex:r.leftJustifiedTextSymbolIndex>=0?r.leftJustifiedTextSymbolIndex:r.verticalPlacedTextSymbolIndex>=0?r.verticalPlacedTextSymbolIndex:u),m=y1(this.textSizeData,t,h)/io;return this.tilePixelRatio*m}getSymbolInstanceIconSize(t,r,c){const u=this.icon.placedSymbolArray.get(c),h=y1(this.iconSizeData,t,u);return this.tilePixelRatio*h}_commitDebugCollisionVertexUpdate(t,r,c){t.emplaceBack(r,-c,-c),t.emplaceBack(r,c,-c),t.emplaceBack(r,c,c),t.emplaceBack(r,-c,c)}_updateTextDebugCollisionBoxes(t,r,c,u,h,m){for(let g=u;g<h;g++){const v=c.get(g),b=this.getSymbolInstanceTextSize(t,m,r,g);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,b,v.padding)}}_updateIconDebugCollisionBoxes(t,r,c,u,h,m){for(let g=u;g<h;g++){const v=c.get(g),b=this.getSymbolInstanceIconSize(t,r,m);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,b,v.padding)}}updateCollisionDebugBuffers(t,r){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const c=Yu(this.iconSizeData,t),u=Yu(this.textSizeData,t);for(let h=0;h<this.symbolInstances.length;h++){const m=this.symbolInstances.get(h);this._updateTextDebugCollisionBoxes(u,t,r,m.textBoxStartIndex,m.textBoxEndIndex,m),this._updateTextDebugCollisionBoxes(u,t,r,m.verticalTextBoxStartIndex,m.verticalTextBoxEndIndex,m),this._updateIconDebugCollisionBoxes(c,t,r,m.iconBoxStartIndex,m.iconBoxEndIndex,m.placedIconSymbolIndex),this._updateIconDebugCollisionBoxes(c,t,r,m.verticalIconBoxStartIndex,m.verticalIconBoxEndIndex,m.placedIconSymbolIndex)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(t,r,c,u,h,m,g,v,b){const w={};if(r<c){const{x1:A,y1:C,x2:P,y2:k,padding:z,projectedAnchorX:U,projectedAnchorY:W,projectedAnchorZ:$,tileAnchorX:Z,tileAnchorY:K,featureIndex:q}=t.get(r);w.textBox={x1:A,y1:C,x2:P,y2:k,padding:z,projectedAnchorX:U,projectedAnchorY:W,projectedAnchorZ:$,tileAnchorX:Z,tileAnchorY:K},w.textFeatureIndex=q}if(u<h){const{x1:A,y1:C,x2:P,y2:k,padding:z,projectedAnchorX:U,projectedAnchorY:W,projectedAnchorZ:$,tileAnchorX:Z,tileAnchorY:K,featureIndex:q}=t.get(u);w.verticalTextBox={x1:A,y1:C,x2:P,y2:k,padding:z,projectedAnchorX:U,projectedAnchorY:W,projectedAnchorZ:$,tileAnchorX:Z,tileAnchorY:K},w.verticalTextFeatureIndex=q}if(m<g){const{x1:A,y1:C,x2:P,y2:k,padding:z,projectedAnchorX:U,projectedAnchorY:W,projectedAnchorZ:$,tileAnchorX:Z,tileAnchorY:K,featureIndex:q}=t.get(m);w.iconBox={x1:A,y1:C,x2:P,y2:k,padding:z,projectedAnchorX:U,projectedAnchorY:W,projectedAnchorZ:$,tileAnchorX:Z,tileAnchorY:K},w.iconFeatureIndex=q}if(v<b){const{x1:A,y1:C,x2:P,y2:k,padding:z,projectedAnchorX:U,projectedAnchorY:W,projectedAnchorZ:$,tileAnchorX:Z,tileAnchorY:K,featureIndex:q}=t.get(v);w.verticalIconBox={x1:A,y1:C,x2:P,y2:k,padding:z,projectedAnchorX:U,projectedAnchorY:W,projectedAnchorZ:$,tileAnchorX:Z,tileAnchorY:K},w.verticalIconFeatureIndex=q}return w}deserializeCollisionBoxes(t){this.collisionArrays=[];for(let r=0;r<this.symbolInstances.length;r++){const c=this.symbolInstances.get(r);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t,c.textBoxStartIndex,c.textBoxEndIndex,c.verticalTextBoxStartIndex,c.verticalTextBoxEndIndex,c.iconBoxStartIndex,c.iconBoxEndIndex,c.verticalIconBoxStartIndex,c.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}hasIconTextFit(){return this.hasAnyIconTextFit}addIndicesForPlacedSymbol(t,r){const c=t.placedSymbolArray.get(r),u=c.vertexStartIndex+4*c.numGlyphs;for(let h=c.vertexStartIndex;h<u;h+=4)t.indexArray.emplaceBack(h,h+1,h+2),t.indexArray.emplaceBack(h+1,h+2,h+3)}getSortedSymbolIndexes(t){if(this.sortedAngle===t&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const r=Math.sin(t),c=Math.cos(t),u=[],h=[],m=[];for(let g=0;g<this.symbolInstances.length;++g){m.push(g);const v=this.symbolInstances.get(g);u.push(0|Math.round(r*v.tileAnchorX+c*v.tileAnchorY)),h.push(v.featureIndex)}return m.sort((g,v)=>u[g]-u[v]||h[v]-h[g]),m}getSortedIndexesByZOffset(){if(!this.zOffsetSortDirty)return this.symbolInstanceIndexesSortedZOffset;if(!this.symbolInstanceIndexesSortedZOffset){this.symbolInstanceIndexesSortedZOffset=[];for(let t=0;t<this.symbolInstances.length;++t)this.symbolInstanceIndexesSortedZOffset.push(t)}return this.zOffsetSortDirty=!1,this.symbolInstanceIndexesSortedZOffset.sort((t,r)=>this.symbolInstances.get(r).zOffset-this.symbolInstances.get(t).zOffset)}addToSortKeyRanges(t,r){const c=this.sortKeyRanges[this.sortKeyRanges.length-1];c&&c.sortKey===r?c.symbolInstanceEnd=t+1:this.sortKeyRanges.push({sortKey:r,symbolInstanceStart:t,symbolInstanceEnd:t+1})}sortFeatures(t){if(this.sortFeaturesByY&&this.sortedAngle!==t&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(t),this.sortedAngle=t,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const r of this.symbolInstanceIndexes){const c=this.symbolInstances.get(r);this.featureSortOrder.push(c.featureIndex);const{rightJustifiedTextSymbolIndex:u,centerJustifiedTextSymbolIndex:h,leftJustifiedTextSymbolIndex:m,verticalPlacedTextSymbolIndex:g,placedIconSymbolIndex:v,verticalPlacedIconSymbolIndex:b}=c;u>=0&&this.addIndicesForPlacedSymbol(this.text,u),h>=0&&h!==u&&this.addIndicesForPlacedSymbol(this.text,h),m>=0&&m!==h&&m!==u&&this.addIndicesForPlacedSymbol(this.text,m),g>=0&&this.addIndicesForPlacedSymbol(this.text,g),v>=0&&this.addIndicesForPlacedSymbol(this.icon,v),b>=0&&this.addIndicesForPlacedSymbol(this.icon,b)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}un(m3,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),m3.MAX_GLYPHS=65535,m3.addDynamicAttributes=bv;var M1=m3;const Nte=B([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:zte}=Nte,Fte=B([{name:"a_packed",components:4,type:"Float32"}]),{members:Bte}=Fte,Ute=Z2.types,Wte=Math.cos(Math.PI/180*37.5);class g3{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(r=>r.fqid),this.index=t.index,this.projection=t.projection,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(r=>{this.gradients[r.id]={}}),this.layoutVertexArray=new Yt,this.layoutVertexArray2=new dn,this.indexArray=new Fn,this.programConfigurations=new yp(t.layers,t.zoom),this.segments=new ji,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id)}populate(t,r,c,u){this.hasPattern=_P("line",this.layers,r);const h=this.layers[0].layout.get("line-sort-key"),m=[];for(const{feature:w,id:A,index:C,sourceLayerIndex:P}of t){const k=this.layers[0]._featureFilter.needGeometry,z=Sp(w,k);if(!this.layers[0]._featureFilter.filter(new sa(this.zoom),z,c))continue;const U=h?h.evaluate(z,{},c):void 0,W={id:A,properties:w.properties,type:w.type,sourceLayerIndex:P,index:C,geometry:k?z.geometry:$u(w,c,u),patterns:{},sortKey:U};m.push(W)}h&&m.sort((w,A)=>w.sortKey-A.sortKey);const{lineAtlas:g,featureIndex:v}=r,b=this.addConstantDashes(g);for(const w of m){const{geometry:A,index:C,sourceLayerIndex:P}=w;if(b&&this.addFeatureDashes(w,g),this.hasPattern){const k=bP("line",this.layers,w,this.zoom,r);this.patternFeatures.push(k)}else this.addFeature(w,A,C,c,g.positions,r.availableImages,r.brightness);v.insert(t[C].feature,A,C,P,this.index)}}addConstantDashes(t){let r=!1;for(const c of this.layers){const u=c.paint.get("line-dasharray").value,h=c.layout.get("line-cap").value;if(u.kind!=="constant"||h.kind!=="constant")r=!0;else{const m=h.value,g=u.value;if(!g)continue;t.addDash(g,m)}}return r}addFeatureDashes(t,r){const c=this.zoom;for(const u of this.layers){const h=u.paint.get("line-dasharray").value,m=u.layout.get("line-cap").value;if(h.kind==="constant"&&m.kind==="constant")continue;let g,v;if(h.kind==="constant"){if(g=h.value,!g)continue}else g=h.evaluate({zoom:c},t);v=m.kind==="constant"?m.value:m.evaluate({zoom:c},t),r.addDash(g,v),t.patterns[u.id]=r.getKey(g,v)}}update(t,r,c,u,h){const m=Object.keys(t).length!==0;m&&!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(t,r,m?this.stateDependentLayers:this.layers,c,u,h)}addFeatures(t,r,c,u,h,m){for(const g of this.patternFeatures)this.addFeature(g,g.geometry,g.index,r,c,u,m)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=t.createVertexBuffer(this.layoutVertexArray2,Bte)),this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,zte),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(t){if(t.properties&&t.properties.hasOwnProperty("mapbox_clip_start")&&t.properties.hasOwnProperty("mapbox_clip_end"))return{start:+t.properties.mapbox_clip_start,end:+t.properties.mapbox_clip_end}}addFeature(t,r,c,u,h,m,g){const v=this.layers[0].layout,b=v.get("line-join").evaluate(t,{}),w=v.get("line-cap").evaluate(t,{}),A=v.get("line-miter-limit"),C=v.get("line-round-limit");this.lineClips=this.lineFeatureClips(t);for(const P of r)this.addLine(P,t,b,w,A,C);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,c,h,m,u,g)}addLine(t,r,c,u,h,m){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let W=0;W<t.length-1;W++)this.totalDistance+=t[W].dist(t[W+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const g=Ute[r.type]==="Polygon";let v=t.length;for(;v>=2&&t[v-1].equals(t[v-2]);)v--;let b=0;for(;b<v-1&&t[b].equals(t[b+1]);)b++;if(v<(g?3:2))return;c==="bevel"&&(h=1.05);const w=this.overscaling<=16?15*mt/(512*this.overscaling):0,A=this.segments.prepareSegment(10*v,this.layoutVertexArray,this.indexArray);let C,P,k,z,U;this.e1=this.e2=-1,g&&(C=t[v-2],U=t[b].sub(C)._unit()._perp());for(let W=b;W<v;W++){if(k=W===v-1?g?t[b+1]:void 0:t[W+1],k&&t[W].equals(k))continue;U&&(z=U),C&&(P=C),C=t[W],U=k?k.sub(C)._unit()._perp():z,z=z||U;let $=z.add(U);$.x===0&&$.y===0||$._unit();const Z=z.x*U.x+z.y*U.y,K=$.x*U.x+$.y*U.y,q=K!==0?1/K:1/0,J=2*Math.sqrt(2-2*K),re=K<Wte&&P&&k,ce=z.x*U.y-z.y*U.x>0;if(re&&W>b){const Ce=C.dist(P);if(Ce>2*w){const Ae=C.sub(C.sub(P)._mult(w/Ce)._round());this.updateDistance(P,Ae),this.addCurrentVertex(Ae,z,0,0,A),P=Ae}}const ge=P&&k;let ve=ge?c:g?"butt":u;if(ge&&ve==="round"&&(q<m?ve="miter":q<=2&&(ve="fakeround")),ve==="miter"&&q>h&&(ve="bevel"),ve==="bevel"&&(q>2&&(ve="flipbevel"),q<h&&(ve="miter")),P&&this.updateDistance(P,C),ve==="miter")$._mult(q),this.addCurrentVertex(C,$,0,0,A);else if(ve==="flipbevel"){if(q>100)$=U.mult(-1);else{const Ce=q*z.add(U).mag()/z.sub(U).mag();$._perp()._mult(Ce*(ce?-1:1))}this.addCurrentVertex(C,$,0,0,A),this.addCurrentVertex(C,$.mult(-1),0,0,A)}else if(ve==="bevel"||ve==="fakeround"){const Ce=-Math.sqrt(q*q-1),Ae=ce?Ce:0,Le=ce?0:Ce;if(P&&this.addCurrentVertex(C,z,Ae,Le,A),ve==="fakeround"){const Se=Math.round(180*J/Math.PI/20);for(let Ve=1;Ve<Se;Ve++){let Xe=Ve/Se;if(Xe!==.5){const We=Xe-.5;Xe+=Xe*We*(Xe-1)*((1.0904+Z*(Z*(3.55645-1.43519*Z)-3.2452))*We*We+(.848013+Z*(.215638*Z-1.06021)))}const nt=U.sub(z)._mult(Xe)._add(z)._unit()._mult(ce?-1:1);this.addHalfVertex(C,nt.x,nt.y,!1,ce,0,A)}}k&&this.addCurrentVertex(C,U,-Ae,-Le,A)}else if(ve==="butt")this.addCurrentVertex(C,$,0,0,A);else if(ve==="square"){const Ce=P?1:-1;P||this.addCurrentVertex(C,$,Ce,Ce,A),this.addCurrentVertex(C,$,0,0,A),P&&this.addCurrentVertex(C,$,Ce,Ce,A)}else ve==="round"&&(P&&(this.addCurrentVertex(C,z,0,0,A),this.addCurrentVertex(C,z,1,1,A,!0)),k&&(this.addCurrentVertex(C,U,-1,-1,A,!0),this.addCurrentVertex(C,U,0,0,A)));if(re&&W<v-1){const Ce=C.dist(k);if(Ce>2*w){const Ae=C.add(k.sub(C)._mult(w/Ce)._round());this.updateDistance(C,Ae),this.addCurrentVertex(Ae,U,0,0,A),C=Ae}}}}addCurrentVertex(t,r,c,u,h,m=!1){const g=r.y*u-r.x,v=-r.y-r.x*u;this.addHalfVertex(t,r.x+r.y*c,r.y-r.x*c,m,!1,c,h),this.addHalfVertex(t,g,v,m,!0,-u,h)}addHalfVertex({x:t,y:r},c,u,h,m,g,v){this.layoutVertexArray.emplaceBack((t<<1)+(h?1:0),(r<<1)+(m?1:0),Math.round(63*c)+128,Math.round(63*u)+128,1+(g===0?0:g<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);const b=v.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,b),v.primitiveLength++),m?this.e2=b:this.e1=b}updateScaledDistance(){if(this.lineClips){const t=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=t*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(t,r){this.distance+=t.dist(r),this.updateScaledDistance()}}un(g3,"LineBucket",{omit:["layers","patternFeatures"]});class vr{constructor(t,r,c,u){this.context=t,this.format=c,this.texture=t.gl.createTexture(),this.update(r,u)}update(t,r,c){const{width:u,height:h}=t,{context:m}=this,{gl:g}=m,{HTMLImageElement:v,HTMLCanvasElement:b,HTMLVideoElement:w,ImageData:A,ImageBitmap:C}=f;if(g.bindTexture(g.TEXTURE_2D,this.texture),m.pixelStoreUnpackFlipY.set(!1),m.pixelStoreUnpack.set(1),m.pixelStoreUnpackPremultiplyAlpha.set(this.format===g.RGBA&&(!r||r.premultiply!==!1)),c||this.size&&this.size[0]===u&&this.size[1]===h){const{x:P,y:k}=c||{x:0,y:0};if(t instanceof v||t instanceof b||t instanceof w||t instanceof A||C&&t instanceof C)g.texSubImage2D(g.TEXTURE_2D,0,P,k,g.RGBA,g.UNSIGNED_BYTE,t);else{let z=this.format,U=g.UNSIGNED_BYTE;this.format===g.R32F&&(z=g.RED,U=g.FLOAT),g.texSubImage2D(g.TEXTURE_2D,0,P,k,u,h,z,U,t.data)}}else if(this.size=[u,h],t instanceof v||t instanceof b||t instanceof w||t instanceof A||C&&t instanceof C){let P=this.format;this.format===g.R8&&(P=g.RED),g.texImage2D(g.TEXTURE_2D,0,this.format,P,g.UNSIGNED_BYTE,t)}else{let P=this.format,k=this.format,z=g.UNSIGNED_BYTE;this.format===g.DEPTH_COMPONENT&&(P=g.DEPTH_COMPONENT16,z=g.UNSIGNED_SHORT),this.format===g.R32F&&(z=g.FLOAT,k=g.RED),g.texImage2D(g.TEXTURE_2D,0,P,u,h,0,k,z,t.data)}this.useMipmap=!!(r&&r.useMipmap),this.useMipmap&&g.generateMipmap(g.TEXTURE_2D)}bind(t,r){const{context:c}=this,{gl:u}=c;u.bindTexture(u.TEXTURE_2D,this.texture),t!==this.minFilter&&(u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MAG_FILTER,t),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MIN_FILTER,this.useMipmap?t===u.NEAREST?u.NEAREST_MIPMAP_NEAREST:u.LINEAR_MIPMAP_NEAREST:t),this.minFilter=t),r!==this.wrapS&&(u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_S,r),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_T,r),this.wrapS=r)}bindExtraParam(t,r,c,u){const{context:h}=this,{gl:m}=h;m.bindTexture(m.TEXTURE_2D,this.texture),r!==this.magFilter&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MAG_FILTER,r),this.magFilter=r),t!==this.minFilter&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MIN_FILTER,this.useMipmap?t===m.NEAREST?m.NEAREST_MIPMAP_NEAREST:m.LINEAR_MIPMAP_NEAREST:t),this.minFilter=t),c!==this.wrapS&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_S,c),this.wrapS=c),u!==this.wrapT&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_T,u),this.wrapT=u)}destroy(){const{gl:t}=this.context;t.deleteTexture(this.texture),this.texture=null}}class y3{constructor(t,r){this.context=t,this.texture=r}bind(t,r){const{context:c}=this,{gl:u}=c;u.bindTexture(u.TEXTURE_2D,this.texture),t!==this.minFilter&&(u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MAG_FILTER,t),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MIN_FILTER,t),this.minFilter=t),r!==this.wrapS&&(u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_S,r),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_T,r),this.wrapS=r)}}const yc=32,qu=33,Pp=new Uint16Array(8184);for(let a=0;a<2046;a++){let t=a+2,r=0,c=0,u=0,h=0,m=0,g=0;for(1&t?u=h=m=yc:r=c=g=yc;(t>>=1)>1;){const b=r+u>>1,w=c+h>>1;1&t?(u=r,h=c,r=m,c=g):(r=u,c=h,u=m,h=g),m=b,g=w}const v=4*a;Pp[v+0]=r,Pp[v+1]=c,Pp[v+2]=u,Pp[v+3]=h}const Xu=new Uint16Array(2178),Ip=new Uint8Array(1089),v3=new Uint16Array(1089);function SF(a){return a===0?-.03125:a===32?.03125:0}var FP=B([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);const AF={type:2,extent:mt,loadGeometry:()=>[[new V(0,0),new V(mt+1,0),new V(mt+1,mt+1),new V(0,mt+1),new V(0,0)]]};class T1{constructor(t,r,c,u,h){this.tileID=t,this.uid=kt(),this.uses=0,this.tileSize=r,this.tileZoom=c,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=h,u&&u.style&&(this._lastUpdatedBrightness=u.style.getBrightness()),this.expiredRequestCount=0,this.state="loading",u&&u.transform&&(this.projection=u.transform.projection)}registerFadeDuration(t){const r=t+this.timeAdded;r<Cn.now()||this.fadeEndTime&&r<this.fadeEndTime||(this.fadeEndTime=r)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}get tileTransform(){return this._tileTransform||(this._tileTransform=Mm(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(t,r,c){if(this.unloadVectorData(),this.state="loaded",t){t.featureIndex&&(this.latestFeatureIndex=t.featureIndex,t.rawTileData?(this.latestRawTileData=t.rawTileData,this.latestFeatureIndex.rawTileData=t.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=t.collisionBoxArray,this.buckets=function(u,h){const m={};if(!h)return m;for(const g of u){const v=g.layerIds.map(b=>h.getLayer(b)).filter(Boolean);if(v.length!==0){g.layers=v,g.stateDependentLayerIds&&(g.stateDependentLayers=g.stateDependentLayerIds.map(b=>v.filter(w=>w.id===b)[0]));for(const b of v)m[b.fqid]=g}}return m}(t.buckets,r.style),this.hasSymbolBuckets=!1;for(const u in this.buckets){const h=this.buckets[u];if(h instanceof M1){if(this.hasSymbolBuckets=!0,!c)break;h.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const u in this.buckets){const h=this.buckets[u];if(h instanceof M1&&h.hasRTLText){this.hasRTLText=!0,Ds.isLoading()||Ds.isLoaded()||n1()!=="deferred"||A2();break}}this.queryPadding=0;for(const u in this.buckets){const h=this.buckets[u],m=r.style.getOwnLayer(u);if(!m)continue;const g=m.queryRadius(h);this.queryPadding=Math.max(this.queryPadding,g)}t.imageAtlas&&(this.imageAtlas=t.imageAtlas),t.glyphAtlasImage&&(this.glyphAtlasImage=t.glyphAtlasImage),t.lineAtlas&&(this.lineAtlas=t.lineAtlas),this._lastUpdatedBrightness=t.brightness}else this.collisionBoxArray=new IC}unloadVectorData(){if(this.hasData()){for(const t in this.buckets)this.buckets[t].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(t){return this.buckets[t.fqid]}upload(t){for(const c in this.buckets){const u=this.buckets[c];u.uploadPending()&&u.upload(t)}const r=t.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new vr(t,this.imageAtlas.image,r.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new vr(t,this.glyphAtlasImage,r.ALPHA),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new vr(t,this.lineAtlas.image,r.ALPHA),this.lineAtlas.uploaded=!0)}prepare(t,r,c){if(this.imageAtlas&&this.imageAtlas.patchUpdatedImages(t,this.imageAtlasTexture,c),!r||!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData)return;const u=r.style.getBrightness();(this._lastUpdatedBrightness||u)&&(this._lastUpdatedBrightness&&u&&Math.abs(this._lastUpdatedBrightness-u)<.001||(this._lastUpdatedBrightness=u,this.updateBuckets(void 0,r)))}queryRenderedFeatures(t,r,c,u,h,m,g,v){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({tileResult:u,pixelPosMatrix:g,transform:m,params:h,tileTransform:this.tileTransform},t,r,c):{}}querySourceFeatures(t,r){const c=this.latestFeatureIndex;if(!c||!c.rawTileData)return;const u=c.loadVTLayers(),h=r?r.sourceLayer:"",m=u._geojsonTileLayer||u[h];if(!m)return;const g=sm(r&&r.filter),{z:v,x:b,y:w}=this.tileID.canonical,A={z:v,x:b,y:w};for(let C=0;C<m.length;C++){const P=m.feature(C);if(g.needGeometry){const U=Sp(P,!0);if(!g.filter(new sa(this.tileID.overscaledZ),U,this.tileID.canonical))continue}else if(!g.filter(new sa(this.tileID.overscaledZ),P))continue;const k=c.getId(P,h),z=new Nz(P,v,b,w,k);z.tile=A,t.push(z)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}bucketsLoaded(){for(const t in this.buckets)if(this.buckets[t].uploadPending())return!1;return!0}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(t){const r=this.expirationTime;if(t.cacheControl){const c=Oe(t.cacheControl);c["max-age"]&&(this.expirationTime=Date.now()+1e3*c["max-age"])}else t.expires&&(this.expirationTime=new Date(t.expires).getTime());if(this.expirationTime){const c=Date.now();let u=!1;if(this.expirationTime>c)u=!1;else if(r)if(this.expirationTime<r)u=!0;else{const h=this.expirationTime-r;h?this.expirationTime=c+Math.max(h,3e4):u=!0}else u=!0;u?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(t,r){this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&Object.keys(t).length!==0&&r&&this.updateBuckets(t,r)}updateBuckets(t,r){if(!this.latestFeatureIndex)return;const c=this.latestFeatureIndex.loadVTLayers(),u=r.style.listImages(),h=r.style.getBrightness();for(const m in this.buckets){if(!r.style.hasLayer(m))continue;const g=this.buckets[m],v=g.layers[0].sourceLayer||"_geojsonTileLayer",b=c[v];let w={};if(t&&(w=t[v],!b||!w||Object.keys(w).length===0))continue;if(g.update(w,b,u,this.imageAtlas&&this.imageAtlas.patternPositions||{},h),g instanceof g3||g instanceof q2){const C=r.style.getOwnSourceCache(g.layers[0].source);r._terrain&&r._terrain.enabled&&C&&g.programConfigurations.needsUpload&&r._terrain._clearRenderCacheForTile(C.id,this.tileID)}const A=r&&r.style&&r.style.getOwnLayer(m);A&&(this.queryPadding=Math.max(this.queryPadding,A.queryRadius(g)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<Cn.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(t){this.symbolFadeHoldUntil=Cn.now()+t}setTexture(t,r){const c=r.context,u=c.gl;this.texture=this.texture||r.getTileTexture(t.width),this.texture?this.texture.update(t,{useMipmap:!0}):(this.texture=new vr(c,t,u.RGBA,{useMipmap:!0}),this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE))}setDependencies(t,r){const c={};for(const u of r)c[u]=!0;this.dependencies[t]=c}hasDependency(t,r){for(const c of t){const u=this.dependencies[c];if(u){for(const h of r)if(u[h])return!0}}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(t,r){if(!r||r.name==="mercator"||this._tileDebugBuffer)return;const c=$u(AF,this.tileID.canonical,this.tileTransform)[0],u=new ee,h=new r1;for(let m=0;m<c.length;m++){const{x:g,y:v}=c[m];u.emplaceBack(g,v),h.emplaceBack(m)}h.emplaceBack(0),this._tileDebugIndexBuffer=t.createIndexBuffer(h),this._tileDebugBuffer=t.createVertexBuffer(u,_p.members),this._tileDebugSegments=ji.simpleSegment(0,0,u.length,h.length)}_makeTileBoundsBuffers(t,r){if(this._tileBoundsBuffer||!r||r.name==="mercator")return;const c=$u(AF,this.tileID.canonical,this.tileTransform)[0];let u,h;if(this.isRaster){const m=function(g,v){const b=Mm(g,v),w=Math.pow(2,g.z);for(let U=0;U<qu;U++)for(let W=0;W<qu;W++){const $=sl((g.x+(W+SF(W))/yc)/w),Z=yr((g.y+(U+SF(U))/yc)/w),K=v.project($,Z),q=U*qu+W;Xu[2*q+0]=Math.round((K.x*b.scale-b.x)*mt),Xu[2*q+1]=Math.round((K.y*b.scale-b.y)*mt)}Ip.fill(0),v3.fill(0);for(let U=2045;U>=0;U--){const W=4*U,$=Pp[W+0],Z=Pp[W+1],K=Pp[W+2],q=Pp[W+3],J=$+K>>1,re=Z+q>>1,ce=J+re-Z,ge=re+$-J,ve=Z*qu+$,Ce=q*qu+K,Ae=re*qu+J,Le=Math.hypot((Xu[2*ve+0]+Xu[2*Ce+0])/2-Xu[2*Ae+0],(Xu[2*ve+1]+Xu[2*Ce+1])/2-Xu[2*Ae+1])>=16;Ip[Ae]=Ip[Ae]||(Le?1:0),U<1022&&(Ip[Ae]=Ip[Ae]||Ip[(Z+ge>>1)*qu+($+ce>>1)]||Ip[(q+ge>>1)*qu+(K+ce>>1)])}const A=new Ye,C=new Fn;let P=0;function k(U,W){const $=W*qu+U;return v3[$]===0&&(A.emplaceBack(Xu[2*$+0],Xu[2*$+1],U*mt/yc,W*mt/yc),v3[$]=++P),v3[$]-1}function z(U,W,$,Z,K,q){const J=U+$>>1,re=W+Z>>1;if(Math.abs(U-K)+Math.abs(W-q)>1&&Ip[re*qu+J])z(K,q,U,W,J,re),z($,Z,K,q,J,re);else{const ce=k(U,W),ge=k($,Z),ve=k(K,q);C.emplaceBack(ce,ge,ve)}}return z(0,0,yc,yc,yc,0),z(yc,yc,0,0,0,yc),{vertices:A,indices:C}}(this.tileID.canonical,r);u=m.vertices,h=m.indices}else{u=new Ye,h=new Fn;for(const{x:g,y:v}of c)u.emplaceBack(g,v,0,0);const m=Y2(u.int16,void 0,4);for(let g=0;g<m.length;g+=3)h.emplaceBack(m[g],m[g+1],m[g+2])}this._tileBoundsBuffer=t.createVertexBuffer(u,FP.members),this._tileBoundsIndexBuffer=t.createIndexBuffer(h),this._tileBoundsSegments=ji.simpleSegment(0,0,u.length,h.length)}_makeGlobeTileDebugBuffers(t,r){const c=r.projection;if(!c||c.name!=="globe"||r.freezeTileCoverage)return;const u=this.tileID.canonical,h=Sm(XN(u,r)),m=yo(r.zoom);let g;m>0&&(g=rt.invert(new Float64Array(16),r.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(t,u,r,h,g,m),this._makeGlobeTileDebugTextBuffer(t,u,r,h,g,m)}_globePoint(t,r,c,u,h,m,g){let v=h1(t,r,c);if(m){const b=1<<c.z,w=vo(u.center.lng),A=Co(u.center.lat),C=(c.x+.5)/b-w;let P=0;C>.5?P=-1:C<-.5&&(P=1);let k=(t/mt+c.x)/b+P,z=(r/mt+c.y)/b;k=(k-w)*u._pixelsPerMercatorPixel+w,z=(z-A)*u._pixelsPerMercatorPixel+A;const U=[k*u.worldSize,z*u.worldSize,0];ke.transformMat4(U,U,m),v=rh(v,U,g)}return ke.transformMat4(v,v,h)}_makeGlobeTileDebugBorderBuffer(t,r,c,u,h,m){const g=new ee,v=new r1,b=new oe,w=(C,P,k,z,U)=>{const W=(k-C)/(U-1),$=(z-P)/(U-1),Z=g.length;for(let K=0;K<U;K++){const q=C+K*W,J=P+K*$;g.emplaceBack(q,J);const re=this._globePoint(q,J,r,c,u,h,m);b.emplaceBack(re[0],re[1],re[2]),v.emplaceBack(Z+K)}},A=mt;w(0,0,A,0,16),w(A,0,A,A,16),w(A,A,0,A,16),w(0,A,0,0,16),this._tileDebugIndexBuffer=t.createIndexBuffer(v),this._tileDebugBuffer=t.createVertexBuffer(g,_p.members),this._globeTileDebugBorderBuffer=t.createVertexBuffer(b,VN.members),this._tileDebugSegments=ji.simpleSegment(0,0,g.length,v.length)}_makeGlobeTileDebugTextBuffer(t,r,c,u,h,m){const g=mt/4,v=new ee,b=new Fn,w=new oe,A=25;b.reserve(32),v.reserve(A),w.reserve(A);const C=(P,k)=>A*P+k;for(let P=0;P<A;P++){const k=P*g;for(let z=0;z<A;z++){const U=z*g;v.emplaceBack(U,k);const W=this._globePoint(U,k,r,c,u,h,m);w.emplaceBack(W[0],W[1],W[2])}}for(let P=0;P<4;P++)for(let k=0;k<4;k++){const z=C(P,k),U=C(P,k+1),W=C(P+1,k),$=C(P+1,k+1);b.emplaceBack(z,U,W),b.emplaceBack(W,U,$)}this._tileDebugTextIndexBuffer=t.createIndexBuffer(b),this._tileDebugTextBuffer=t.createVertexBuffer(v,_p.members),this._globeTileDebugTextBuffer=t.createVertexBuffer(w,VN.members),this._tileDebugTextSegments=ji.simpleSegment(0,0,A,32)}}class Vte{constructor(t,r){this.max=t,this.onRemove=r,this.reset()}reset(){for(const t in this.data)for(const r of this.data[t])r.timeout&&clearTimeout(r.timeout),this.onRemove(r.value);return this.data={},this.order=[],this}add(t,r,c){const u=t.wrapped().key;this.data[u]===void 0&&(this.data[u]=[]);const h={value:r,timeout:void 0};if(c!==void 0&&(h.timeout=setTimeout(()=>{this.remove(t,h)},c)),this.data[u].push(h),this.order.push(u),this.order.length>this.max){const m=this._getAndRemoveByKey(this.order[0]);m&&this.onRemove(m)}return this}has(t){return t.wrapped().key in this.data}getAndRemove(t){return this.has(t)?this._getAndRemoveByKey(t.wrapped().key):null}_getAndRemoveByKey(t){const r=this.data[t].shift();return r.timeout&&clearTimeout(r.timeout),this.data[t].length===0&&delete this.data[t],this.order.splice(this.order.indexOf(t),1),r.value}getByKey(t){const r=this.data[t];return r?r[0].value:null}get(t){return this.has(t)?this.data[t.wrapped().key][0].value:null}remove(t,r){if(!this.has(t))return this;const c=t.wrapped().key,u=r===void 0?0:this.data[c].indexOf(r),h=this.data[c][u];return this.data[c].splice(u,1),h.timeout&&clearTimeout(h.timeout),this.data[c].length===0&&delete this.data[c],this.onRemove(h.value),this.order.splice(this.order.indexOf(c),1),this}setMaxSize(t){for(this.max=t;this.order.length>this.max;){const r=this._getAndRemoveByKey(this.order[0]);r&&this.onRemove(r)}return this}filter(t){const r=[];for(const c in this.data)for(const u of this.data[c])t(u.value)||r.push(u);for(const c of r)this.remove(c.value.tileID,c)}}class Lp{constructor(t,r,c,u){this.id=Lp.uniqueIdxCounter,Lp.uniqueIdxCounter++,this.context=t;const h=t.gl;this.buffer=h.createBuffer(),this.dynamicDraw=!!c,this.context.unbindVAO(),t.bindElementBuffer.set(this.buffer),h.bufferData(h.ELEMENT_ARRAY_BUFFER,r.arrayBuffer,this.dynamicDraw?h.DYNAMIC_DRAW:h.STATIC_DRAW),this.dynamicDraw||u||r.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(t){this.id=Lp.uniqueIdxCounter,Lp.uniqueIdxCounter++;const r=this.context.gl;this.context.unbindVAO(),this.bind(),r.bufferSubData(r.ELEMENT_ARRAY_BUFFER,0,t.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}Lp.uniqueIdxCounter=0;const Gte={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Hte{constructor(t,r,c,u,h,m){this.length=r.length,this.attributes=c,this.itemSize=r.bytesPerElement,this.dynamicDraw=u,this.instanceCount=m,this.context=t;const g=t.gl;this.buffer=g.createBuffer(),t.bindVertexBuffer.set(this.buffer),g.bufferData(g.ARRAY_BUFFER,r.arrayBuffer,this.dynamicDraw?g.DYNAMIC_DRAW:g.STATIC_DRAW),this.dynamicDraw||h||r.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(t){const r=this.context.gl;this.bind(),r.bufferSubData(r.ARRAY_BUFFER,0,t.arrayBuffer)}enableAttributes(t,r){for(let c=0;c<this.attributes.length;c++){const u=r.attributes[this.attributes[c].name];u!==void 0&&t.enableVertexAttribArray(u)}}setVertexAttribPointers(t,r,c){for(let u=0;u<this.attributes.length;u++){const h=this.attributes[u],m=r.attributes[h.name];m!==void 0&&t.vertexAttribPointer(m,h.components,t[Gte[h.type]],!1,this.itemSize,h.offset+this.itemSize*(c||0))}}setVertexAttribDivisor(t,r,c){for(let u=0;u<this.attributes.length;u++){const h=r.attributes[this.attributes[u].name];h!==void 0&&this.instanceCount&&this.instanceCount>0&&t.vertexAttribDivisor(h,c)}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class ya{constructor(t){this.gl=t.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(t){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class jte extends ya{getDefault(){return Sn.transparent}set(t){const r=this.current;(t.r!==r.r||t.g!==r.g||t.b!==r.b||t.a!==r.a||this.dirty)&&(this.gl.clearColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class $te extends ya{getDefault(){return 1}set(t){(t!==this.current||this.dirty)&&(this.gl.clearDepth(t),this.current=t,this.dirty=!1)}}class Yte extends ya{getDefault(){return 0}set(t){(t!==this.current||this.dirty)&&(this.gl.clearStencil(t),this.current=t,this.dirty=!1)}}class qte extends ya{getDefault(){return[!0,!0,!0,!0]}set(t){const r=this.current;(t[0]!==r[0]||t[1]!==r[1]||t[2]!==r[2]||t[3]!==r[3]||this.dirty)&&(this.gl.colorMask(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class Xte extends ya{getDefault(){return!0}set(t){(t!==this.current||this.dirty)&&(this.gl.depthMask(t),this.current=t,this.dirty=!1)}}class Zte extends ya{getDefault(){return 255}set(t){(t!==this.current||this.dirty)&&(this.gl.stencilMask(t),this.current=t,this.dirty=!1)}}class Kte extends ya{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(t){const r=this.current;(t.func!==r.func||t.ref!==r.ref||t.mask!==r.mask||this.dirty)&&(this.gl.stencilFunc(t.func,t.ref,t.mask),this.current=t,this.dirty=!1)}}class Jte extends ya{getDefault(){const t=this.gl;return[t.KEEP,t.KEEP,t.KEEP]}set(t){const r=this.current;(t[0]!==r[0]||t[1]!==r[1]||t[2]!==r[2]||this.dirty)&&(this.gl.stencilOp(t[0],t[1],t[2]),this.current=t,this.dirty=!1)}}class Qte extends ya{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const r=this.gl;t?r.enable(r.STENCIL_TEST):r.disable(r.STENCIL_TEST),this.current=t,this.dirty=!1}}class ene extends ya{getDefault(){return[0,1]}set(t){const r=this.current;(t[0]!==r[0]||t[1]!==r[1]||this.dirty)&&(this.gl.depthRange(t[0],t[1]),this.current=t,this.dirty=!1)}}class tne extends ya{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const r=this.gl;t?r.enable(r.DEPTH_TEST):r.disable(r.DEPTH_TEST),this.current=t,this.dirty=!1}}class nne extends ya{getDefault(){return this.gl.LESS}set(t){(t!==this.current||this.dirty)&&(this.gl.depthFunc(t),this.current=t,this.dirty=!1)}}class ine extends ya{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const r=this.gl;t?r.enable(r.BLEND):r.disable(r.BLEND),this.current=t,this.dirty=!1}}class ane extends ya{getDefault(){const t=this.gl;return[t.ONE,t.ZERO,t.ONE,t.ZERO]}set(t){const r=this.current;(t[0]!==r[0]||t[1]!==r[1]||t[2]!==r[2]||t[3]!==r[3]||this.dirty)&&(this.gl.blendFuncSeparate(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class rne extends ya{getDefault(){return Sn.transparent}set(t){const r=this.current;(t.r!==r.r||t.g!==r.g||t.b!==r.b||t.a!==r.a||this.dirty)&&(this.gl.blendColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class one extends ya{getDefault(){return this.gl.FUNC_ADD}set(t){(t!==this.current||this.dirty)&&(this.gl.blendEquationSeparate(t,t),this.current=t,this.dirty=!1)}}class sne extends ya{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const r=this.gl;t?r.enable(r.CULL_FACE):r.disable(r.CULL_FACE),this.current=t,this.dirty=!1}}class lne extends ya{getDefault(){return this.gl.BACK}set(t){(t!==this.current||this.dirty)&&(this.gl.cullFace(t),this.current=t,this.dirty=!1)}}class cne extends ya{getDefault(){return this.gl.CCW}set(t){(t!==this.current||this.dirty)&&(this.gl.frontFace(t),this.current=t,this.dirty=!1)}}let une=class extends ya{getDefault(){return null}set(a){(a!==this.current||this.dirty)&&(this.gl.useProgram(a),this.current=a,this.dirty=!1)}};class dne extends ya{getDefault(){return this.gl.TEXTURE0}set(t){(t!==this.current||this.dirty)&&(this.gl.activeTexture(t),this.current=t,this.dirty=!1)}}class hne extends ya{getDefault(){const t=this.gl;return[0,0,t.drawingBufferWidth,t.drawingBufferHeight]}set(t){const r=this.current;(t[0]!==r[0]||t[1]!==r[1]||t[2]!==r[2]||t[3]!==r[3]||this.dirty)&&(this.gl.viewport(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class pne extends ya{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const r=this.gl;r.bindFramebuffer(r.FRAMEBUFFER,t),this.current=t,this.dirty=!1}}class fne extends ya{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const r=this.gl;r.bindRenderbuffer(r.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class mne extends ya{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const r=this.gl;r.bindTexture(r.TEXTURE_2D,t),this.current=t,this.dirty=!1}}class gne extends ya{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const r=this.gl;r.bindBuffer(r.ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class yne extends ya{getDefault(){return null}set(t){const r=this.gl;r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class vne extends ya{getDefault(){return null}set(t){this.gl&&(t!==this.current||this.dirty)&&(this.gl.bindVertexArray(t),this.current=t,this.dirty=!1)}}class _ne extends ya{getDefault(){return 4}set(t){if(t===this.current&&!this.dirty)return;const r=this.gl;r.pixelStorei(r.UNPACK_ALIGNMENT,t),this.current=t,this.dirty=!1}}class bne extends ya{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const r=this.gl;r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t),this.current=t,this.dirty=!1}}class xne extends ya{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const r=this.gl;r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,t),this.current=t,this.dirty=!1}}class BP extends ya{constructor(t,r){super(t),this.context=t,this.parent=r}getDefault(){return null}}class wne extends BP{setDirty(){this.dirty=!0}set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const r=this.gl;r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,t,0),this.current=t,this.dirty=!1}}class EF extends BP{attachment(){return this.gl.DEPTH_ATTACHMENT}set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const r=this.gl;r.framebufferRenderbuffer(r.FRAMEBUFFER,this.attachment(),r.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class Sne extends BP{attachment(){return this.gl.DEPTH_ATTACHMENT}set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const r=this.gl;r.framebufferTexture2D(r.FRAMEBUFFER,this.attachment(),r.TEXTURE_2D,t,0),this.current=t,this.dirty=!1}}class Ane extends EF{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class Ene{constructor(t,r,c,u,h){this.context=t,this.width=r,this.height=c;const m=this.framebuffer=t.gl.createFramebuffer();u&&(this.colorAttachment=new wne(t,m)),h&&(this.depthAttachmentType=h,this.depthAttachment=h==="renderbuffer"?new EF(t,m):new Sne(t,m))}destroy(){const t=this.context.gl;if(this.colorAttachment){const r=this.colorAttachment.get();r&&t.deleteTexture(r)}if(this.depthAttachment&&this.depthAttachmentType)if(this.depthAttachmentType==="renderbuffer"){const r=this.depthAttachment.get();r&&t.deleteRenderbuffer(r)}else{const r=this.depthAttachment.get();r&&t.deleteTexture(r)}t.deleteFramebuffer(this.framebuffer)}}class Nn{constructor(t,r,c){this.func=t,this.mask=r,this.range=c}}Nn.ReadOnly=!1,Nn.ReadWrite=!0,Nn.disabled=new Nn(519,Nn.ReadOnly,[0,1]);const UP=7680;class ui{constructor(t,r,c,u,h,m){this.test=t,this.ref=r,this.mask=c,this.fail=u,this.depthFail=h,this.pass=m}}ui.disabled=new ui({func:519,mask:0},0,0,UP,UP,UP);const _3=771;class Ci{constructor(t,r,c,u){this.blendFunction=t,this.blendColor=r,this.mask=c,this.blendEquation=u}}Ci.Replace=[1,0,1,0],Ci.disabled=new Ci(Ci.Replace,Sn.transparent,[!1,!1,!1,!1]),Ci.unblended=new Ci(Ci.Replace,Sn.transparent,[!0,!0,!0,!0]),Ci.alphaBlended=new Ci([1,_3,1,_3],Sn.transparent,[!0,!0,!0,!0]),Ci.multiply=new Ci([774,0,774,0],Sn.transparent,[!0,!0,!0,!0]);const WP=1029,VP=2305;class hi{constructor(t,r,c){this.enable=t,this.mode=r,this.frontFace=c}}hi.disabled=new hi(!1,WP,VP),hi.backCCW=new hi(!0,WP,VP),hi.backCW=new hi(!0,WP,2304),hi.frontCW=new hi(!0,1028,2304),hi.frontCCW=new hi(!0,1028,VP);class Mne{constructor(t){this.gl=t,this.clearColor=new jte(this),this.clearDepth=new $te(this),this.clearStencil=new Yte(this),this.colorMask=new qte(this),this.depthMask=new Xte(this),this.stencilMask=new Zte(this),this.stencilFunc=new Kte(this),this.stencilOp=new Jte(this),this.stencilTest=new Qte(this),this.depthRange=new ene(this),this.depthTest=new tne(this),this.depthFunc=new nne(this),this.blend=new ine(this),this.blendFunc=new ane(this),this.blendColor=new rne(this),this.blendEquation=new one(this),this.cullFace=new sne(this),this.cullFaceSide=new lne(this),this.frontFace=new cne(this),this.program=new une(this),this.activeTexture=new dne(this),this.viewport=new hne(this),this.bindFramebuffer=new pne(this),this.bindRenderbuffer=new fne(this),this.bindTexture=new mne(this),this.bindVertexBuffer=new gne(this),this.bindElementBuffer=new yne(this),this.bindVertexArrayOES=new vne(this),this.pixelStoreUnpack=new _ne(this),this.pixelStoreUnpackPremultiplyAlpha=new bne(this),this.pixelStoreUnpackFlipY=new xne(this),this.extTextureFilterAnisotropic=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=t.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureFilterAnisotropicForceOff=!1,this.extStandardDerivativesForceOff=!1,this.extDebugRendererInfo=t.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=t.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=t.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),this.extTextureFloatLinear=t.getExtension("OES_texture_float_linear"),this.extRenderToTextureHalfFloat=t.getExtension("EXT_color_buffer_half_float"),this.extTimerQuery=t.getExtension("EXT_disjoint_timer_query_webgl2"),this.maxTextureSize=t.getParameter(t.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArrayOES.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(t,r,c){return new Lp(this,t,r,c)}createVertexBuffer(t,r,c,u,h){return new Hte(this,t,r,c,u,h)}createRenderbuffer(t,r,c){const u=this.gl,h=u.createRenderbuffer();return this.bindRenderbuffer.set(h),u.renderbufferStorage(u.RENDERBUFFER,t,r,c),this.bindRenderbuffer.set(null),h}createFramebuffer(t,r,c,u){return new Ene(this,t,r,c,u)}clear({color:t,depth:r,stencil:c,colorMask:u}){const h=this.gl;let m=0;t&&(m|=h.COLOR_BUFFER_BIT,this.clearColor.set(t),this.colorMask.set(u||[!0,!0,!0,!0])),r!==void 0&&(m|=h.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(r),this.depthMask.set(!0)),c!==void 0&&(m|=h.STENCIL_BUFFER_BIT,this.clearStencil.set(c),this.stencilMask.set(255)),h.clear(m)}setCullFace(t){t.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(t.mode),this.frontFace.set(t.frontFace))}setDepthMode(t){t.func!==this.gl.ALWAYS||t.mask?(this.depthTest.set(!0),this.depthFunc.set(t.func),this.depthMask.set(t.mask),this.depthRange.set(t.range)):this.depthTest.set(!1)}setStencilMode(t){t.test.func!==this.gl.ALWAYS||t.mask?(this.stencilTest.set(!0),this.stencilMask.set(t.mask),this.stencilOp.set([t.fail,t.depthFail,t.pass]),this.stencilFunc.set({func:t.test.func,ref:t.ref,mask:t.test.mask})):this.stencilTest.set(!1)}setColorMode(t){Q(t.blendFunction,Ci.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(t.blendFunction),this.blendColor.set(t.blendColor),t.blendEquation?this.blendEquation.set(t.blendEquation):this.blendEquation.setDefault()),this.colorMask.set(t.mask)}unbindVAO(){this.bindVertexArrayOES.set(null)}}class Xc extends Un{constructor(t,r,c){super(),this.id=t,this._onlySymbols=c,r.on("data",u=>{u.dataType==="source"&&u.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&u.dataType==="source"&&u.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))}),r.on("error",()=>{this._sourceErrored=!0}),this._source=r,this._tiles={},this._cache=new Vte(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=r.minTileCacheSize,this._maxTileCacheSize=r.maxTileCacheSize,this._loadedParentTiles={},this.castsShadows=!1,this._coveredTiles={},this._shadowCasterTiles={},this._state=new qee,this._isRaster=this._source.type==="raster"||this._source.type==="raster-dem"||this._source.type==="custom"&&this._source._dataType==="raster"}onAdd(t){this.map=t,this._minTileCacheSize=this._minTileCacheSize===void 0&&t?t._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=this._maxTileCacheSize===void 0&&t?t._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const t in this._tiles){const r=this._tiles[t];if(r.state!=="errored"&&(r.state!=="loaded"||!r.bucketsLoaded()))return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const t=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,t&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(t,r){return t.isSymbolTile=this._onlySymbols,t.isExtraShadowCaster=this._shadowCasterTiles[t.tileID.key],this._source.loadTile(t,r)}_unloadTile(t){if(this._source.unloadTile)return this._source.unloadTile(t,()=>{})}_abortTile(t){if(this._source.abortTile)return this._source.abortTile(t,()=>{})}serialize(){return this._source.serialize()}prepare(t){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const r in this._tiles){const c=this._tiles[r];c.upload(t),c.prepare(this.map.style.imageManager,this.map?this.map.painter:null,this._source.scope)}}getIds(){return Ke(this._tiles).map(t=>t.tileID).sort(MF).map(t=>t.key)}getRenderableIds(t,r){const c=[];for(const u in this._tiles)this._isIdRenderable(+u,t,r)&&c.push(this._tiles[u]);return t?c.sort((u,h)=>{const m=u.tileID,g=h.tileID,v=new V(m.canonical.x,m.canonical.y)._rotate(this.transform.angle),b=new V(g.canonical.x,g.canonical.y)._rotate(this.transform.angle);return m.overscaledZ-g.overscaledZ||b.y-v.y||b.x-v.x}).map(u=>u.tileID.key):c.map(u=>u.tileID).sort(MF).map(u=>u.key)}hasRenderableParent(t){const r=this.findLoadedParent(t,0);return!!r&&this._isIdRenderable(r.tileID.key)}_isIdRenderable(t,r,c){return this._tiles[t]&&this._tiles[t].hasData()&&!this._coveredTiles[t]&&(r||!this._tiles[t].holdingForFade())&&(c||!this._shadowCasterTiles[t])}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const t in this._tiles)this._tiles[t].state!=="errored"&&this._reloadTile(+t,"reloading")}}_reloadTile(t,r){const c=this._tiles[t];c&&(c.state!=="loading"&&(c.state=r),this._loadTile(c,this._tileLoaded.bind(this,c,t,r)))}_tileLoaded(t,r,c,u){if(u)if(t.state="errored",u.status!==404)this._source.fire(new bn(u,{tile:t}));else if(this._source.type==="raster-dem"&&this.usedForTerrain&&this.map.painter.terrain){const h=this.map.painter.terrain;this.update(this.transform,h.getScaledDemTileSize(),!0),h.resetTileLookupCache(this.id)}else this.update(this.transform);else t.timeAdded=Cn.now(),c==="expired"&&(t.refreshedUponExpiration=!0),this._setTileReloadTimer(r,t),this._source.type==="raster-dem"&&t.dem&&this._backfillDEM(t),this._state.initializeTileState(t,this.map?this.map.painter:null),this._source.fire(new $t("data",{dataType:"source",tile:t,coord:t.tileID,sourceCacheId:this.id}))}_backfillDEM(t){const r=this.getRenderableIds();for(let u=0;u<r.length;u++){const h=r[u];if(t.neighboringTiles&&t.neighboringTiles[h]){const m=this.getTileByID(h);c(t,m),c(m,t)}}function c(u,h){if(!u.dem||u.dem.borderReady)return;u.needsHillshadePrepare=!0,u.needsDEMTextureUpload=!0;let m=h.tileID.canonical.x-u.tileID.canonical.x;const g=h.tileID.canonical.y-u.tileID.canonical.y,v=Math.pow(2,u.tileID.canonical.z),b=h.tileID.key;m===0&&g===0||Math.abs(g)>1||(Math.abs(m)>1&&(Math.abs(m+v)===1?m+=v:Math.abs(m-v)===1&&(m-=v)),h.dem&&u.dem&&(u.dem.backfillBorder(h.dem,m,g),u.neighboringTiles&&u.neighboringTiles[b]&&(u.neighboringTiles[b].backfilled=!0)))}}getTile(t){return this.getTileByID(t.key)}getTileByID(t){return this._tiles[t]}_retainLoadedChildren(t,r,c,u){for(const h in this._tiles){let m=this._tiles[h];if(u[h]||!m.hasData()||m.tileID.overscaledZ<=r||m.tileID.overscaledZ>c)continue;let g=m.tileID;for(;m&&m.tileID.overscaledZ>r+1;){const b=m.tileID.scaledTo(m.tileID.overscaledZ-1);m=this._tiles[b.key],m&&m.hasData()&&(g=b)}let v=g;for(;v.overscaledZ>r;)if(v=v.scaledTo(v.overscaledZ-1),t[v.key]){u[g.key]=g;break}}}findLoadedParent(t,r){if(t.key in this._loadedParentTiles){const c=this._loadedParentTiles[t.key];return c&&c.tileID.overscaledZ>=r?c:null}for(let c=t.overscaledZ-1;c>=r;c--){const u=t.scaledTo(c),h=this._getLoadedTile(u);if(h)return h}}_getLoadedTile(t){const r=this._tiles[t.key];return r&&r.hasData()?r:this._cache.getByKey(this._source.reparseOverscaled?t.wrapped().key:t.canonical.key)}updateCacheSize(t,r){r=r||this._source.tileSize;const c=Math.ceil(t.width/r)+1,u=Math.ceil(t.height/r)+1,h=Math.floor(c*u*5),m=typeof this._minTileCacheSize=="number"?Math.max(this._minTileCacheSize,h):h,g=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,m):m;this._cache.setMaxSize(g)}handleWrapJump(t){const r=Math.round((t-(this._prevLng===void 0?t:this._prevLng))/360);if(this._prevLng=t,r){const c={};for(const u in this._tiles){const h=this._tiles[u];h.tileID=h.tileID.unwrapTo(h.tileID.wrap+r),c[h.tileID.key]=h}this._tiles=c;for(const u in this._timers)clearTimeout(this._timers[u]),delete this._timers[u];for(const u in this._tiles)this._setTileReloadTimer(+u,this._tiles[u])}}update(t,r,c,u){if(this.transform=t,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!c)return;let h;if(this.updateCacheSize(t,r),this.transform.projection.name!=="globe"&&this.handleWrapJump(this.transform.center.lng),this._shadowCasterTiles={},this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?h=t.getVisibleUnwrappedCoordinates(this._source.tileID).map(v=>new Li(v.canonical.z,v.wrap,v.canonical.z,v.canonical.x,v.canonical.y)):(h=t.coveringTiles({tileSize:r||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!c,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(h=h.filter(v=>this._source.hasTile(v)))):h=[],h.length>0&&this.castsShadows&&u&&this.transform.projection.name!=="globe"&&!this.usedForTerrain&&!GP(this._source.type)){const v=t.coveringZoomLevel({tileSize:r||this._source.tileSize,roundZoom:this._source.roundZoom&&!c}),b=Math.min(v,this._source.maxzoom),w=t.extendTileCoverForShadows(h,u,b);for(const A of w)this._shadowCasterTiles[A.key]=!0,h.push(A)}const m=this._updateRetainedTiles(h);if(GP(this._source.type)&&h.length!==0){const v={},b={},w=Object.keys(m);for(const C of w){const P=m[C],k=this._tiles[C];if(!k||k.fadeEndTime&&k.fadeEndTime<=Cn.now())continue;const z=this.findLoadedParent(P,Math.max(P.overscaledZ-Xc.maxOverzooming,this._source.minzoom));z&&(this._addTile(z.tileID),v[z.tileID.key]=z.tileID),b[C]=P}const A=h[h.length-1].overscaledZ;for(const C in this._tiles){const P=this._tiles[C];if(m[C]||!P.hasData())continue;let k=P.tileID;for(;k.overscaledZ>A;){k=k.scaledTo(k.overscaledZ-1);const z=this._tiles[k.key];if(z&&z.hasData()&&b[k.key]){m[C]=P.tileID;break}}}for(const C in v)m[C]||(this._coveredTiles[C]=!0,m[C]=v[C])}for(const v in m)this._tiles[v].clearFadeHold();const g=function(v,b){const w=[];for(const A in v)A in b||w.push(A);return w}(this._tiles,m);for(const v of g){const b=this._tiles[v];b.hasSymbolBuckets&&!b.holdingForFade()?b.setHoldDuration(this.map._fadeDuration):b.hasSymbolBuckets&&!b.symbolFadeFinished()||this._removeTile(+v)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const t in this._tiles)this._tiles[t].holdingForFade()&&this._removeTile(+t)}_updateRetainedTiles(t){const r={};if(t.length===0)return r;const c={},u=t.reduce((b,w)=>Math.min(b,w.overscaledZ),1/0),h=t[0].overscaledZ,m=Math.max(h-Xc.maxOverzooming,this._source.minzoom),g=Math.max(h+Xc.maxUnderzooming,this._source.minzoom),v={};for(const b of t){const w=this._addTile(b);r[b.key]=b,w.hasData()||u<this._source.maxzoom&&(v[b.key]=b)}this._retainLoadedChildren(v,u,g,r);for(const b of t){let w=this._tiles[b.key];if(w.hasData())continue;if(b.canonical.z>=this._source.maxzoom){const C=b.children(this._source.maxzoom)[0],P=this.getTile(C);if(P&&P.hasData()){r[C.key]=C;continue}}else{const C=b.children(this._source.maxzoom);if(r[C[0].key]&&r[C[1].key]&&r[C[2].key]&&r[C[3].key])continue}let A=w.wasRequested();for(let C=b.overscaledZ-1;C>=m;--C){const P=b.scaledTo(C);if(c[P.key]||(c[P.key]=!0,w=this.getTile(P),!w&&A&&(w=this._addTile(P)),w&&(r[P.key]=P,A=w.wasRequested(),w.hasData())))break}}return r}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const t in this._tiles){const r=[];let c,u=this._tiles[t].tileID;for(;u.overscaledZ>0;){if(u.key in this._loadedParentTiles){c=this._loadedParentTiles[u.key];break}r.push(u.key);const h=u.scaledTo(u.overscaledZ-1);if(c=this._getLoadedTile(h),c)break;u=h}for(const h of r)this._loadedParentTiles[h]=c}}_addTile(t){let r=this._tiles[t.key];if(r)return r.isExtraShadowCaster!==!0||this._shadowCasterTiles[t.key]||this._reloadTile(t.key,"reloading"),r;r=this._cache.getAndRemove(t),r&&(this._setTileReloadTimer(t.key,r),r.tileID=t,this._state.initializeTileState(r,this.map?this.map.painter:null),this._cacheTimers[t.key]&&(clearTimeout(this._cacheTimers[t.key]),delete this._cacheTimers[t.key],this._setTileReloadTimer(t.key,r)));const c=!!r;if(!c){const u=this.map?this.map.painter:null;r=new T1(t,this._source.tileSize*t.overscaleFactor(),this.transform.tileZoom,u,this._isRaster),this._loadTile(r,this._tileLoaded.bind(this,r,t.key,r.state))}return r?(r.uses++,this._tiles[t.key]=r,c||this._source.fire(new $t("dataloading",{tile:r,coord:r.tileID,dataType:"source"})),r):null}_setTileReloadTimer(t,r){t in this._timers&&(clearTimeout(this._timers[t]),delete this._timers[t]);const c=r.getExpiryTimeout();c&&(this._timers[t]=setTimeout(()=>{this._reloadTile(t,"expired"),delete this._timers[t]},c))}_removeTile(t){const r=this._tiles[t];r&&(r.uses--,delete this._tiles[t],this._timers[t]&&(clearTimeout(this._timers[t]),delete this._timers[t]),r.uses>0||(r.hasData()&&r.state!=="reloading"?this._cache.add(r.tileID,r,r.getExpiryTimeout()):(r.aborted=!0,this._abortTile(r),this._unloadTile(r))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const t in this._tiles)this._removeTile(+t);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(t,r,c){const u=[],h=this.transform;if(!h)return u;const m=h.projection.name==="globe",g=vo(h.center.lng);for(const v in this._tiles){const b=this._tiles[v];if(c&&b.clearQueryDebugViz(),b.holdingForFade())continue;let w;if(m){const A=b.tileID.canonical;if(A.z===0){const C=[Math.abs(ae(g,...C1(A,-1))-g),Math.abs(ae(g,...C1(A,1))-g)];w=[0,2*C.indexOf(Math.min(...C))-1]}else{const C=[Math.abs(ae(g,...C1(A,-1))-g),Math.abs(ae(g,...C1(A,0))-g),Math.abs(ae(g,...C1(A,1))-g)];w=[C.indexOf(Math.min(...C))-1]}}else w=[0];for(const A of w){const C=t.containsTile(b,h,r,A);C&&u.push(C)}}return u}getShadowCasterCoordinates(){return this._getRenderableCoordinates(!1,!0)}getVisibleCoordinates(t){return this._getRenderableCoordinates(t)}_getRenderableCoordinates(t,r){const c=this.getRenderableIds(t,r).map(u=>this._tiles[u].tileID);for(const u of c)u.projMatrix=this.transform.calculateProjMatrix(u.toUnwrapped());return c}sortCoordinatesByDistance(t){const r=t.slice(),c=this.transform._camera.position,u=this.transform._camera.forward(),h={};for(const m of r){const g=1/(1<<m.canonical.z);h[m.key]=((m.canonical.x+.5)*g+m.wrap-c[0])*u[0]+((m.canonical.y+.5)*g-c[1])*u[1]-c[2]*u[2]}return r.sort((m,g)=>h[m.key]-h[g.key]),r}hasTransition(){if(this._source.hasTransition())return!0;if(GP(this._source.type))for(const t in this._tiles){const r=this._tiles[t];if(r.fadeEndTime!==void 0&&r.fadeEndTime>=Cn.now())return!0}return!1}setFeatureState(t,r,c){this._state.updateState(t=t||"_geojsonTileLayer",r,c)}removeFeatureState(t,r,c){this._state.removeFeatureState(t=t||"_geojsonTileLayer",r,c)}getFeatureState(t,r){return this._state.getState(t=t||"_geojsonTileLayer",r)}setDependencies(t,r,c){const u=this._tiles[t];u&&u.setDependencies(r,c)}reloadTilesForDependencies(t,r){for(const c in this._tiles)this._tiles[c].hasDependency(t,r)&&this._reloadTile(+c,"reloading");this._cache.filter(c=>!c.hasDependency(t,r))}_preloadTiles(t,r){if(!this._sourceLoaded){const g=()=>{this._sourceLoaded&&(this._source.off("data",g),this._preloadTiles(t,r))};return void this._source.on("data",g)}const c=new Map,u=Array.isArray(t)?t:[t],h=this.map.painter.terrain,m=this.usedForTerrain&&h?h.getScaledDemTileSize():this._source.tileSize;for(const g of u){const v=g.coveringTiles({tileSize:m,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const b of v)c.set(b.key,b);this.usedForTerrain&&g.updateElevation(!1)}Ze(Array.from(c.values()),(g,v)=>{const b=new T1(g,this._source.tileSize*g.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(b,w=>{this._source.type==="raster-dem"&&b.dem&&this._backfillDEM(b),v(w,b)})},r)}}function MF(a,t){const r=Math.abs(2*a.wrap)-+(a.wrap<0),c=Math.abs(2*t.wrap)-+(t.wrap<0);return a.overscaledZ-t.overscaledZ||c-r||t.canonical.y-a.canonical.y||t.canonical.x-a.canonical.x}function GP(a){return a==="raster"||a==="image"||a==="video"||a==="custom"}function C1(a,t){const r=1<<a.z;return[a.x/r+t,(a.x+1)/r+t]}Xc.maxOverzooming=10,Xc.maxUnderzooming=3;const Tne=B([{name:"a_pos_3f",components:3,type:"Float32"}]),Cne=B([{name:"a_color_3f",components:3,type:"Float32"}]),Pne=B([{name:"a_color_4f",components:4,type:"Float32"}]),Ine=B([{name:"a_uv_2f",components:2,type:"Float32"}]),Lne=B([{name:"a_normal_3f",components:3,type:"Float32"}]),Rne=B([{name:"a_normal_matrix0",components:4,type:"Float32"},{name:"a_normal_matrix1",components:4,type:"Float32"},{name:"a_normal_matrix2",components:4,type:"Float32"},{name:"a_normal_matrix3",components:4,type:"Float32"}]),kne=B([{name:"a_pbr",components:4,type:"Uint16"},{name:"a_heightBasedEmissiveStrength",components:3,type:"Float32"}]);class HP{constructor(t=0,r=0,c=0,u=0){if(isNaN(t)||t<0||isNaN(r)||r<0||isNaN(c)||c<0||isNaN(u)||u<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=t,this.bottom=r,this.left=c,this.right=u}interpolate(t,r,c){return r.top!=null&&t.top!=null&&(this.top=Ln(t.top,r.top,c)),r.bottom!=null&&t.bottom!=null&&(this.bottom=Ln(t.bottom,r.bottom,c)),r.left!=null&&t.left!=null&&(this.left=Ln(t.left,r.left,c)),r.right!=null&&t.right!=null&&(this.right=Ln(t.right,r.right,c)),this}getCenter(t,r){const c=ae((this.left+t-this.right)/2,0,t),u=ae((this.top+r-this.bottom)/2,0,r);return new V(c,u)}equals(t){return this.top===t.top&&this.bottom===t.bottom&&this.left===t.left&&this.right===t.right}clone(){return new HP(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function TF(a,t){const r=Et(a,3);rt.fromQuat(a,t),Ut(a,3,r)}function jP(a,t){const r=To.identity([]);return To.rotateZ(r,r,-t),To.rotateX(r,r,-a),r}function CF(a,t){const r=[a[0],a[1],0],c=[t[0],t[1],0];if(ke.length(r)>=1e-15){const m=ke.normalize([],r);ke.scale(c,m,ke.dot(c,m)),t[0]=c[0],t[1]=c[1]}const u=ke.cross([],t,a);if(ke.len(u)<1e-15)return null;const h=Math.atan2(-u[1],u[0]);return jP(Math.atan2(Math.sqrt(a[0]*a[0]+a[1]*a[1]),-a[2]),h)}class PF{constructor(t,r){this.position=t,this.orientation=r}get position(){return this._position}set position(t){if(t){const r=t instanceof vi?t:new vi(t[0],t[1],t[2]);this._renderWorldCopies&&(r.x=Je(r.x,0,1)),this._position=r}else this._position=null}lookAtPoint(t,r){if(this.orientation=null,!this.position)return;const c=this.position,u=this._elevation?this._elevation.getAtPointOrZero(vi.fromLngLat(t)):0,h=vi.fromLngLat(t,u),m=[h.x-c.x,h.y-c.y,h.z-c.z];r||(r=[0,0,1]),r[2]=Math.abs(r[2]),this.orientation=CF(m,r)}setPitchBearing(t,r){this.orientation=jP(ye(t),ye(-r))}}class b3{constructor(t,r){this._transform=rt.identity([]),this.orientation=r,this.position=t}get mercatorPosition(){const t=this.position;return new vi(t[0],t[1],t[2])}get position(){const t=Et(this._transform,3);return[t[0],t[1],t[2]]}set position(t){var r;t&&Ut(this._transform,3,[(r=t)[0],r[1],r[2],1])}get orientation(){return this._orientation}set orientation(t){this._orientation=t||To.identity([]),t&&TF(this._transform,this._orientation)}getPitchBearing(){const t=this.forward(),r=this.right();return{bearing:Math.atan2(-r[1],r[0]),pitch:Math.atan2(Math.sqrt(t[0]*t[0]+t[1]*t[1]),-t[2])}}setPitchBearing(t,r){this._orientation=jP(t,r),TF(this._transform,this._orientation)}forward(){const t=Et(this._transform,2);return[-t[0],-t[1],-t[2]]}up(){const t=Et(this._transform,1);return[-t[0],-t[1],-t[2]]}right(){const t=Et(this._transform,0);return[t[0],t[1],t[2]]}getCameraToWorld(t,r){const c=new Float64Array(16);return rt.invert(c,this.getWorldToCamera(t,r)),c}getCameraToWorldMercator(){return this._transform}getWorldToCameraPosition(t,r,c){const u=this.position;ke.scale(u,u,-t);const h=new Float64Array(16);return rt.fromScaling(h,[c,c,c]),rt.translate(h,h,u),h[10]*=r,h}getWorldToCamera(t,r){const c=new Float64Array(16),u=new Float64Array(4),h=this.position;return To.conjugate(u,this._orientation),ke.scale(h,h,-t),rt.fromQuat(c,u),rt.translate(c,c,h),c[1]*=-1,c[5]*=-1,c[9]*=-1,c[13]*=-1,c[8]*=r,c[9]*=r,c[10]*=r,c[11]*=r,c}getCameraToClipPerspective(t,r,c,u){const h=new Float64Array(16);return rt.perspective(h,t,r,c,u),h}getCameraToClipOrthographic(t,r,c,u,h,m){const g=new Float64Array(16);return rt.ortho(g,t,r,c,u,h,m),g}getDistanceToElevation(t,r=!1){const c=t===0?0:$i(t,r?yr(this.position[1]):this.position[1]),u=this.forward();return(c-this.position[2])/u[2]}clone(){return new b3([...this.position],[...this.orientation])}}function IF(a,t){const r=P1(a.projection,a.zoom,a.width,a.height),c=function(h,m,g,v,b){const w=new On(g.lng-180*Rp,g.lat),A=new On(g.lng+180*Rp,g.lat),C=h.project(w.lng,w.lat),P=h.project(A.lng,A.lat),k=-Math.atan2(P.y-C.y,P.x-C.x),z=vi.fromLngLat(g);z.y=ae(z.y,-1+Rp,1-Rp);const U=z.toLngLat(),W=h.project(U.lng,U.lat),$=vi.fromLngLat(U);$.x+=Rp;const Z=$.toLngLat(),K=h.project(Z.lng,Z.lat),q=kF(K.x-W.x,K.y-W.y,k),J=vi.fromLngLat(U);J.y+=Rp;const re=J.toLngLat(),ce=h.project(re.lng,re.lat),ge=kF(ce.x-W.x,ce.y-W.y,k),ve=Math.abs(q.x)/Math.abs(ge.y),Ce=rt.identity([]);rt.rotateZ(Ce,Ce,-k*(1-(b?0:v)));const Ae=rt.identity([]);return rt.scale(Ae,Ae,[1,1-(1-ve)*v,1]),Ae[4]=-ge.x/ge.y*v,rt.rotateZ(Ae,Ae,k),rt.multiply(Ae,Ce,Ae),Ae}(a.projection,0,a.center,r,t),u=LF(a);return rt.scale(c,c,[u,u,1]),c}function LF(a){const t=a.projection,r=P1(a.projection,a.zoom,a.width,a.height),c=RF(t,a.center),u=RF(t,On.convert(t.center));return Math.pow(2,c*r+(1-r)*u)}function P1(a,t,r,c,u=1/0){const h=a.range;if(!h)return 0;const m=Math.min(u,Math.max(r,c)),g=Math.log(m/1024)/Math.LN2;return Ee(h[0]+g,h[1]+g,t)}const Rp=1/4e4;function RF(a,t){const r=ae(t.lat,-qa,qa),c=new On(t.lng-180*Rp,r),u=new On(t.lng+180*Rp,r),h=a.project(c.lng,r),m=a.project(u.lng,r),g=vi.fromLngLat(c),v=vi.fromLngLat(u),b=m.x-h.x,w=m.y-h.y,A=v.x-g.x,C=v.y-g.y,P=Math.sqrt((A*A+C*C)/(b*b+w*w));return Math.log(P)/Math.LN2}function kF(a,t,r){const c=Math.cos(r),u=Math.sin(r);return{x:a*c-t*u,y:a*u+t*c}}function Tm(a,t,r){return t*(mt/(a.tileSize*Math.pow(2,r-a.tileID.overscaledZ)))}const xv={unknown:0,flipRequired:1,flipNotRequired:2},Dne=Math.tan(85*Math.PI/180);function x3(a,t,r,c,u,h,m){const g=rt.create();if(r)if(h.name==="globe"){const v=function(b,w){const{x:A,y:C}=b.point,P=QN(A,C,b.worldSize/b._pixelsPerMercatorPixel,0,0);return rt.multiply(P,P,nP(gc(w)))}(u,t);rt.multiply(g,g,v)}else{const v=av.invert([],m);g[0]=v[0],g[1]=v[1],g[4]=v[2],g[5]=v[3],c||rt.rotateZ(g,g,u.angle)}else rt.multiply(g,u.labelPlaneMatrix,a);return g}function DF(a,t,r,c,u,h,m){const g=x3(a,t,r,c,u,h,m);return h.name==="globe"&&r||(g[2]=g[6]=g[10]=g[14]=0),g}function OF(a,t,r,c,u,h,m){if(r){if(h.name==="globe"){const g=x3(a,t,r,c,u,h,m);return rt.invert(g,g),rt.multiply(g,a,g),g}{const g=rt.clone(a),v=rt.identity([]);return v[0]=m[0],v[1]=m[1],v[4]=m[2],v[5]=m[3],rt.multiply(g,g,v),c||rt.rotateZ(g,g,-u.angle),g}}return u.glCoordMatrix}function Zc(a,t,r,c){const u=[a,t,r,1];r?Hi.transformMat4(u,u,c):VF(u,u,c);const h=u[3];return u[0]/=h,u[1]/=h,u[2]/=h,u}function NF(a,t){return Math.min(.5+a/t*.5,1.5)}function One(a,t){const r=a[0]/a[3],c=a[1]/a[3];return r>=-t[0]&&r<=t[0]&&c>=-t[1]&&c<=t[1]}function Nne(a,t,r,c,u,h,m,g,v,b){const w=r.transform,A=c?a.textSizeData:a.iconSizeData,C=Yu(A,r.transform.zoom),P=w.projection.name==="globe",k=[256/r.width*2+1,256/r.height*2+1],z=c?a.text.dynamicLayoutVertexArray:a.icon.dynamicLayoutVertexArray;z.clear();let U=null;P&&(U=c?a.text.globeExtVertexArray:a.icon.globeExtVertexArray);const W=a.lineVertexArray,$=c?a.text.placedSymbolArray:a.icon.placedSymbolArray,Z=r.transform.width/r.transform.height;let K,q=!1;for(let J=0;J<$.length;J++){const re=$.get(J),{numGlyphs:ce,writingMode:ge}=re;if(ge!==Aa.vertical||q||K===Aa.horizontal||(q=!0),K=ge,(re.hidden||ge===Aa.vertical)&&!q){wv(ce,z);continue}q=!1;const ve=new V(re.tileAnchorX,re.tileAnchorY);let{x:Ce,y:Ae,z:Le}=w.projection.projectTilePoint(ve.x,ve.y,b.canonical);if(v){const[Rt,Ft,St]=v(ve);Ce+=Rt,Ae+=Ft,Le+=St}const Se=[Ce,Ae,Le,1];if(Hi.transformMat4(Se,Se,t),!One(Se,k)){wv(ce,z);continue}const Ve=Se[3],Xe=NF(r.transform.getCameraToCenterDistance(w.projection),Ve),nt=y1(A,C,re),We=m?nt/Xe:nt*Xe,Ge=Zc(Ce,Ae,Le,u);if(Ge[3]<=0){wv(ce,z);continue}let ot={};const yt=m?null:v,pt=BF(re,We,!1,g,t,u,h,a.glyphOffsetArray,W,z,U,Ge,ve,ot,Z,yt,w.projection,b,m);q=pt.useVertical,yt&&pt.needsFlipping&&(ot={}),(pt.notEnoughRoom||q||pt.needsFlipping&&BF(re,We,!0,g,t,u,h,a.glyphOffsetArray,W,z,U,Ge,ve,ot,Z,yt,w.projection,b,m).notEnoughRoom)&&wv(ce,z)}c?(a.text.dynamicLayoutVertexBuffer.updateData(z),U&&a.text.globeExtVertexBuffer&&a.text.globeExtVertexBuffer.updateData(U)):(a.icon.dynamicLayoutVertexBuffer.updateData(z),U&&a.icon.globeExtVertexBuffer&&a.icon.globeExtVertexBuffer.updateData(U))}function zF(a,t,r,c,u,h,m,g,v,b,w,A,C,P,k,z){const{lineStartIndex:U,glyphStartIndex:W,segment:$}=g,Z=W+g.numGlyphs,K=U+g.lineLength,q=t.getoffsetX(W),J=t.getoffsetX(Z-1),re=w3(a*q,r,c,u,h,m,$,U,K,v,b,w,A,C,!0,P,k,z);if(!re)return null;const ce=w3(a*J,r,c,u,h,m,$,U,K,v,b,w,A,C,!0,P,k,z);return ce?{first:re,last:ce}:null}function FF(a,t,r,c){return a===Aa.horizontal&&Math.abs(c)>Math.abs(r)?{useVertical:!0}:a===Aa.vertical?c>0?{needsFlipping:!0}:null:t!==xv.unknown&&function(u,h){return u===0||Math.abs(h/u)>Dne}(r,c)?t===xv.flipRequired?{needsFlipping:!0}:null:r<0?{needsFlipping:!0}:null}function BF(a,t,r,c,u,h,m,g,v,b,w,A,C,P,k,z,U,W,$){const Z=t/24,K=a.lineOffsetX*Z,q=a.lineOffsetY*Z,{lineStartIndex:J,glyphStartIndex:re,numGlyphs:ce,segment:ge,writingMode:ve,flipState:Ce}=a,Ae=J+a.lineLength,Le=Se=>{if(w){const[We,Ge,ot]=Se.up,yt=b.length;f3(w,yt+0,We,Ge,ot),f3(w,yt+1,We,Ge,ot),f3(w,yt+2,We,Ge,ot),f3(w,yt+3,We,Ge,ot)}const[Ve,Xe,nt]=Se.point;bv(b,Ve,Xe,nt,Se.angle)};if(ce>1){const Se=zF(Z,g,K,q,r,A,C,a,v,h,P,z,!1,U,W,$);if(!Se)return{notEnoughRoom:!0};if(c&&!r){let[Ve,Xe,nt]=Se.first.point,[We,Ge,ot]=Se.last.point;[Ve,Xe]=Zc(Ve,Xe,nt,m),[We,Ge]=Zc(We,Ge,ot,m);const yt=FF(ve,Ce,(We-Ve)*k,Ge-Xe);if(a.flipState=yt&&yt.needsFlipping?xv.flipRequired:xv.flipNotRequired,yt)return yt}Le(Se.first);for(let Ve=re+1;Ve<re+ce-1;Ve++){const Xe=w3(Z*g.getoffsetX(Ve),K,q,r,A,C,ge,J,Ae,v,h,P,z,!1,!1,U,W,$);if(!Xe)return b.length-=4*(Ve-re),{notEnoughRoom:!0};Le(Xe)}Le(Se.last)}else{if(c&&!r){const Ve=Zc(C.x,C.y,0,u),Xe=J+ge+1,nt=new V(v.getx(Xe),v.gety(Xe)),We=Zc(nt.x,nt.y,0,u),Ge=We[3]>0?We:WF(C,nt,Ve,1,u,void 0,U,W.canonical),ot=FF(ve,Ce,(Ge[0]-Ve[0])*k,Ge[1]-Ve[1]);if(a.flipState=ot&&ot.needsFlipping?xv.flipRequired:xv.flipNotRequired,ot)return ot}const Se=w3(Z*g.getoffsetX(re),K,q,r,A,C,ge,J,Ae,v,h,P,z,!1,!1,U,W,$);if(!Se)return{notEnoughRoom:!0};Le(Se)}return{}}function UF(a,t,r,c,u){const{x:h,y:m,z:g}=c.projectTilePoint(a.x,a.y,t);if(!u)return Zc(h,m,g,r);const[v,b,w]=u(a);return Zc(h+v,m+b,g+w,r)}function WF(a,t,r,c,u,h,m,g){const v=UF(a.sub(t)._unit()._add(a),g,u,m,h);return ke.sub(v,r,v),ke.normalize(v,v),ke.scaleAndAdd(v,r,v,c)}function w3(a,t,r,c,u,h,m,g,v,b,w,A,C,P,k,z,U,W){const $=c?a-t:a+t;let Z=$>0?1:-1,K=0;c&&(Z*=-1,K=Math.PI),Z<0&&(K+=Math.PI);let q=g+m+(Z>0?0:1)|0,J=u,re=u,ce=0,ge=0;const ve=Math.abs($),Ce=[],Ae=[];let Le=h,Se=Le;const Ve=()=>WF(Se,Le,re,ve-ce+1,w,C,z,U.canonical);for(;ce+ge<=ve;){if(q+=Z,q<g||q>=v)return null;if(re=J,Se=Le,Ce.push(re),P&&Ae.push(Se),Le=new V(b.getx(q),b.gety(q)),J=A[q],!J){const Ft=UF(Le,U.canonical,w,z,C);J=Ft[3]>0?A[q]=Ft:Ve()}ce+=ge,ge=ke.distance(re,J)}k&&C&&(A[q]&&(J=Ve(),ge=ke.distance(re,J)),A[q]=J);const Xe=(ve-ce)/ge,nt=Le.sub(Se)._mult(Xe)._add(Se),We=ke.sub([],J,re),Ge=ke.scaleAndAdd([],re,We,Xe);let ot=[0,0,1],yt=We[0],pt=We[1];if(W&&(ot=z.upVector(U.canonical,nt.x,nt.y),ot[0]!==0||ot[1]!==0||ot[2]!==1)){const Ft=[ot[2],0,-ot[0]],St=ke.cross([],ot,Ft);ke.normalize(Ft,Ft),ke.normalize(St,St),yt=ke.dot(We,Ft),pt=ke.dot(We,St)}if(r){const Ft=ke.cross([],ot,We);ke.normalize(Ft,Ft),ke.scaleAndAdd(Ge,Ge,Ft,r*Z)}const Rt=K+Math.atan2(pt,yt);return Ce.push(Ge),P&&Ae.push(nt),{point:Ge,angle:Rt,path:Ce,tilePath:Ae,up:ot}}function wv(a,t){const r=t.length,c=r+4*a;t.resize(c),t.float32.fill(-1/0,4*r,4*c)}function VF(a,t,r){const c=t[0],u=t[1];return a[0]=r[0]*c+r[4]*u+r[12],a[1]=r[1]*c+r[5]*u+r[13],a[3]=r[3]*c+r[7]*u+r[15],a}const GF=(a,t,r)=>(1-r)*a+r*t,HF=a=>a*a*a*a*a;class $P{constructor(t,r,c,u,h,m,g){this.tileSize=512,this._renderWorldCopies=h===void 0||h,this._minZoom=t||0,this._maxZoom=r||22,this._minPitch=c??0,this._maxPitch=u??60,this.setProjection(m),this.setMaxBounds(g),this.width=0,this.height=0,this._center=new On(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new HP,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._distanceTileDataCache={},this._camera=new b3,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._horizonShift=.1,this._orthographicProjectionAtLowPitch=!1}clone(){const t=new $P(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return t._elevation=this._elevation,t._centerAltitude=this._centerAltitude,t._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,t.tileSize=this.tileSize,t.mercatorFromTransition=this.mercatorFromTransition,t.width=this.width,t.height=this.height,t.cameraElevationReference=this.cameraElevationReference,t._center=this._center,t._setZoom(this.zoom),t._seaLevelZoom=this._seaLevelZoom,t.angle=this.angle,t._fov=this._fov,t._pitch=this._pitch,t._nearZ=this._nearZ,t._farZ=this._farZ,t._averageElevation=this._averageElevation,t._unmodified=this._unmodified,t._edgeInsets=this._edgeInsets.clone(),t._camera=this._camera.clone(),t._calcMatrices(),t.freezeTileCoverage=this.freezeTileCoverage,t.frustumCorners=this.frustumCorners,t}get isOrthographic(){return this.projection.name!=="globe"&&this._orthographicProjectionAtLowPitch&&this.pitch<15}get elevation(){return this._elevation}set elevation(t){this._elevation!==t&&(this._elevation=t,this._updateCameraOnTerrain(),this._calcMatrices())}updateElevation(t,r=!1){const c=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(this._seaLevelZoom==null||c)&&this._updateCameraOnTerrain(),(t||c)&&this._constrainCamera(r),this._calcMatrices()}getProjection(){return ct(this.projection,["name","center","parallels"])}setProjection(t){this.projectionOptions=t||{name:"mercator"};const r=this.projection?this.getProjection():void 0;this.projection=c3(this.projectionOptions);const c=!Q(r,this.getProjection());return c&&this._calcMatrices(),this.mercatorFromTransition=!1,c}setOrthographicProjectionAtLowPitch(t){return this._orthographicProjectionAtLowPitch!==t&&(this._orthographicProjectionAtLowPitch=t,this._calcMatrices(),!0)}setMercatorFromTransition(){const t=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=c3({name:"mercator"});const r=t!==this.projection.name;return r&&this._calcMatrices(),r}get minZoom(){return this._minZoom}set minZoom(t){this._minZoom!==t&&(this._minZoom=t,this.zoom=Math.max(this.zoom,t))}get maxZoom(){return this._maxZoom}set maxZoom(t){this._maxZoom!==t&&(this._maxZoom=t,this.zoom=Math.min(this.zoom,t))}get minPitch(){return this._minPitch}set minPitch(t){this._minPitch!==t&&(this._minPitch=t,this.pitch=Math.max(this.pitch,t))}get maxPitch(){return this._maxPitch}set maxPitch(t){this._maxPitch!==t&&(this._maxPitch=t,this.pitch=Math.min(this.pitch,t))}get renderWorldCopies(){return this._renderWorldCopies&&this.projection.supportsWorldCopies===!0}set renderWorldCopies(t){t===void 0?t=!0:t===null&&(t=!1),this._renderWorldCopies=t}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const t=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(t))}get cameraWorldSize(){const t=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(t))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return $i(1,this.center.lat)*this.cameraWorldSizeForFog}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new V(this.width,this.height)}get bearing(){return Je(this.rotation,-180,180)}set bearing(t){this.rotation=t}get rotation(){return-this.angle/Math.PI*180}set rotation(t){const r=-t*Math.PI/180;this.angle!==r&&(this._unmodified=!1,this.angle=r,this._calcMatrices(),this.rotationMatrix=av.create(),av.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(t){const r=ae(t,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==r&&(this._unmodified=!1,this._pitch=r,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}get fovX(){return this._fov}get fovY(){const t=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/t)}set fov(t){t=Math.max(.01,Math.min(60,t)),this._fov!==t&&(this._unmodified=!1,this._fov=ye(t),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(t){this._averageElevation=t,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(t){const r=Math.min(Math.max(t,this.minZoom),this.maxZoom);this._zoom!==r&&(this._unmodified=!1,this._setZoom(r),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(t){this._zoom=t,this.scale=this.zoomScale(t),this.tileZoom=Math.floor(t),this.zoomFraction=t-this.tileZoom}_updateCameraOnTerrain(){const t=this.elevation?this.elevation.getAtPoint(this.locationCoordinate(this.center),Number.NEGATIVE_INFINITY):Number.NEGATIVE_INFINITY,r=this.elevation&&t===Number.NEGATIVE_INFINITY&&this.elevation.visibleDemTiles.length>0&&this.elevation.exaggeration()>0&&this._centerAltitudeValidForExaggeration;if(!this._elevation||t===Number.NEGATIVE_INFINITY&&(!r||!this._centerAltitude))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const c=this._elevation;r||this._centerAltitude&&this._centerAltitudeValidForExaggeration&&c.exaggeration()&&this._centerAltitudeValidForExaggeration!==c.exaggeration()?(this._centerAltitude=this._centerAltitude/this._centerAltitudeValidForExaggeration*c.exaggeration(),this._centerAltitudeValidForExaggeration=c.exaggeration()):(this._centerAltitude=t||0,this._centerAltitudeValidForExaggeration=c.exaggeration()),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){this._centerAltitudeValidForExaggeration!==void 0&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const t=this._elevation,r=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],c=this.horizonLineFromTop();let u=0,h=0;for(let m=0;m<r.length;m++){const g=new V(r[m][0]*this.width,c+r[m][1]*(this.height-c)),v=t.pointCoordinate(g);if(!v)continue;const b=1/Math.hypot(v[0]-this._camera.position[0],v[1]-this._camera.position[1]);u+=v[3]*b,h+=b}return h===0?NaN:u/h}get center(){return this._center}set center(t){t.lat===this._center.lat&&t.lng===this._center.lng||(this._unmodified=!1,this._center=t,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._seaLevelZoom==null||!this._elevation)return;const t=this._seaLevelZoom,r=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),c=this.pixelsPerMeter/this.worldSize*r,u=this._mercatorZfromZoom(t),h=this._mercatorZfromZoom(this._maxZoom),m=Math.max(u-c,h);this._setZoom(this._zoomFromMercatorZ(m))}get padding(){return this._edgeInsets.toJSON()}set padding(t){this._edgeInsets.equals(t)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,t,1),this._calcMatrices())}computeZoomRelativeTo(t){const r=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,t.toAltitude()));let c;c=t.z<this._camera.position[2]?[r.x,r.y,r.z]:[t.x,t.y,t.z];const u=ke.length(ke.sub([],this._camera.position,c));return ae(this._zoomFromMercatorZ(u),this._minZoom,this._maxZoom)}setFreeCameraOptions(t){if(!this.height||!t.position&&!t.orientation)return;this._updateCameraState();let r=!1;if(t.orientation&&!To.exactEquals(t.orientation,this._camera.orientation)&&(r=this._setCameraOrientation(t.orientation)),t.position){const c=[t.position.x,t.position.y,t.position.z];ke.exactEquals(c,this._camera.position)||(this._setCameraPosition(c),r=!0)}r&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const t=this._camera.position,r=new PF;return r.position=new vi(t[0],t[1],t[2]),r.orientation=this._camera.orientation,r._elevation=this.elevation,r._renderWorldCopies=this.renderWorldCopies,r}_setCameraOrientation(t){if(!To.length(t))return!1;To.normalize(t,t);const r=ke.transformQuat([],[0,0,-1],t),c=ke.transformQuat([],[0,-1,0],t);if(c[2]<0)return!1;const u=CF(r,c);return!!u&&(this._camera.orientation=u,!0)}_setCameraPosition(t){const r=this.zoomScale(this.minZoom)*this.tileSize,c=this.zoomScale(this.maxZoom)*this.tileSize,u=this.cameraToCenterDistance;t[2]=ae(t[2],u/c,u/r),this._camera.position=t}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(t){return this._edgeInsets.equals(t)}interpolatePadding(t,r,c){this._unmodified=!1,this._edgeInsets.interpolate(t,r,c),this._constrain(),this._calcMatrices()}coveringZoomLevel(t){const r=(t.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/t.tileSize));return Math.max(0,r)}getVisibleUnwrappedCoordinates(t){const r=[new ZC(0,t)];if(this.renderWorldCopies){const c=this.pointCoordinate(new V(0,0)),u=this.pointCoordinate(new V(this.width,0)),h=this.pointCoordinate(new V(this.width,this.height)),m=this.pointCoordinate(new V(0,this.height)),g=Math.floor(Math.min(c.x,u.x,h.x,m.x)),v=Math.floor(Math.max(c.x,u.x,h.x,m.x)),b=1;for(let w=g-b;w<=v+b;w++)w!==0&&r.push(new ZC(w,t))}return r}isLODDisabled(t){return(!t||this.pitch<=60)&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace}extendTileCoverForShadows(t,r,c){let u=[];if(r[0]===0&&r[1]===0)return u;for(const m of t){const g=m.canonical,v=m.overscaledZ,b=m.wrap,w=1<<g.z,A=g.x+1<w,C=g.x>0,P=g.y+1<w,k=g.y>0,z=m.wrap-(C?0:1),U=m.wrap+(A?0:1),W=C?g.x-1:w-1,$=A?g.x+1:0;r[0]<0?(u.push(new Li(v,U,g.z,$,g.y)),r[1]<0&&P&&(u.push(new Li(v,b,g.z,g.x,g.y+1)),u.push(new Li(v,U,g.z,$,g.y+1))),r[1]>0&&k&&(u.push(new Li(v,b,g.z,g.x,g.y-1)),u.push(new Li(v,U,g.z,$,g.y-1)))):r[0]>0?(u.push(new Li(v,z,g.z,W,g.y)),r[1]<0&&P&&(u.push(new Li(v,b,g.z,g.x,g.y+1)),u.push(new Li(v,z,g.z,W,g.y+1))),r[1]>0&&k&&(u.push(new Li(v,b,g.z,g.x,g.y-1)),u.push(new Li(v,z,g.z,W,g.y-1)))):r[1]<0&&P?u.push(new Li(v,b,g.z,g.x,g.y+1)):k&&u.push(new Li(v,b,g.z,g.x,g.y-1))}if(u.length>1){u.sort((v,b)=>v.overscaledZ-b.overscaledZ||v.wrap-b.wrap||v.canonical.z-b.canonical.z||v.canonical.x-b.canonical.x||v.canonical.y-b.canonical.y);let m=0,g=0;for(;g<u.length;)u[g].equals(u[m])?++g:u[++m]=u[g++];u.length=m+1}const h=[];for(const m of u)u.some(g=>m.isChildOf(g))||h.push(m);return u=h.filter(m=>!t.some(g=>!!(m.overscaledZ<c&&g.isChildOf(m))||m.equals(g)||m.isChildOf(g))),u}coveringTiles(t){let r=this.coveringZoomLevel(t);const c=r,u=this.elevation&&this.elevation.exaggeration(),h=u&&!t.isTerrainDEM,m=this.projection.name==="mercator";if(t.minzoom!==void 0&&r<t.minzoom)return[];t.maxzoom!==void 0&&r>t.maxzoom&&(r=t.maxzoom);const g=this.locationCoordinate(this.center),v=this.center.lat,b=1<<r,w=[b*g.x,b*g.y,0],A=this.projection.name==="globe",C=!A,P=ah.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,r,C),k=A?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),z=b*$i(1,this.center.lat),U=this._camera.position[2]/$i(1,this.center.lat),W=[b*k.x,b*k.y,U*(C?1:z)],$=A||u,Z=this.cameraToCenterDistance/t.tileSize*(t.roundZoom?1:.502),K=this.isLODDisabled(!0)?r:0,q=t.isTerrainDEM&&this._elevation?1e4*this._elevation.exaggeration():this._centerAltitude,J=t.isTerrainDEM?-q:this._elevation?this._elevation.getMinElevationBelowMSL():0,re=this.projection.isReprojectedInTileSpace?LF(this):1,ce=We=>{const ot=new vi(We.x+25e-6,We.y,We.z),yt=new vi(We.x,We.y+25e-6,We.z),pt=We.toLngLat(),Rt=ot.toLngLat(),Ft=yt.toLngLat(),St=this.locationCoordinate(pt),Tt=this.locationCoordinate(Rt),nn=this.locationCoordinate(Ft),sn=Math.hypot(Tt.x-St.x,Tt.y-St.y),on=Math.hypot(nn.x-St.x,nn.y-St.y);return Math.sqrt(sn*on)*re/25e-6},ge=We=>{const Ge=q,ot=J;return{aabb:mF(this,b,0,0,0,We,ot,Ge,this.projection),zoom:0,x:0,y:0,minZ:ot,maxZ:Ge,wrap:We,fullyVisible:!1}},ve=[];let Ce=[];const Ae=r,Le=t.reparseOverscaled?c:r,Se=We=>We*We,Ve=Se((U-this._centerAltitude)*z),Xe=We=>{if(!this._elevation||!We.tileID||!m)return;const Ge=this._elevation.getMinMaxForTile(We.tileID),ot=We.aabb;Ge?(ot.min[2]=Ge.min,ot.max[2]=Ge.max,ot.center[2]=(ot.min[2]+ot.max[2])/2):(We.shouldSplit=nt(We),We.shouldSplit||(ot.min[2]=ot.max[2]=ot.center[2]=this._centerAltitude))},nt=We=>{if(We.zoom<K)return!0;if(We.zoom===Ae)return!1;if(We.shouldSplit!=null)return We.shouldSplit;const Ge=We.aabb.distanceX(W),ot=We.aabb.distanceY(W);let yt=Ve,pt=1;if(A){yt=Se(We.aabb.distanceZ(W));const St=Math.pow(2,We.zoom),Tt=yr((We.y+1)/St),nn=yr(We.y/St),sn=Math.min(Math.max(v,Tt),nn),on=F2(sn)/F2(v);if(pt=sn===v?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,on/this._mercatorScaleRatio),this.zoom<=d1&&We.zoom===Ae-1&&on>=.9)return!0}else if(h&&(yt=Se(We.aabb.distanceZ(W)*z)),this.projection.isReprojectedInTileSpace&&c<=5){const St=Math.pow(2,We.zoom),Tt=ce(new vi((We.x+.5)/St,(We.y+.5)/St));pt=Tt>.85?1:Tt}const Rt=Ge*Ge+ot*ot+yt,Ft=Se((1<<Ae-We.zoom)*Z*pt*((St,Tt)=>{if(Tt*Se(.707)<St)return 1;const nn=Math.sqrt(Tt/St);return nn/(1.4144271570014144+(Math.pow(1.1,nn-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(yt,Ve),Rt));return Rt<Ft};if(this.renderWorldCopies)for(let We=1;We<=3;We++)ve.push(ge(-We)),ve.push(ge(We));for(ve.push(ge(0));ve.length>0;){const We=ve.pop(),Ge=We.x,ot=We.y;let yt=We.fullyVisible;const pt=()=>this.projection.name==="globe"&&(We.y===0||We.y===(1<<We.zoom)-1);if(!yt){let Rt=$?We.aabb.intersects(P):We.aabb.intersectsFlat(P);if(Rt===0&&pt()){const Ft=new ju(We.zoom,Ge,ot);Rt=eP(this,b,Ft,!0).intersects(P)}if(Rt===0)continue;yt=Rt===2}if(We.zoom!==Ae&&nt(We))for(let Rt=0;Rt<4;Rt++){const Ft=(Ge<<1)+Rt%2,St=(ot<<1)+(Rt>>1),Tt={aabb:m?We.aabb.quadrant(Rt):mF(this,b,We.zoom+1,Ft,St,We.wrap,We.minZ,We.maxZ,this.projection),zoom:We.zoom+1,x:Ft,y:St,wrap:We.wrap,fullyVisible:yt,tileID:void 0,shouldSplit:void 0,minZ:We.minZ,maxZ:We.maxZ};h&&!A&&(Tt.tileID=new Li(We.zoom+1===Ae?Le:We.zoom+1,We.wrap,We.zoom+1,Ft,St),Xe(Tt)),ve.push(Tt)}else{const Rt=We.zoom===Ae?Le:We.zoom;if(t.minzoom&&t.minzoom>Rt)continue;if(!yt){let nn=$?We.aabb.intersectsPrecise(P):We.aabb.intersectsPreciseFlat(P);if(nn===0&&pt()){const sn=new ju(We.zoom,Ge,ot);nn=eP(this,b,sn,!0).intersectsPrecise(P)}if(nn===0)continue}const Ft=w[0]-(.5+Ge+(We.wrap<<We.zoom))*(1<<r-We.zoom),St=w[1]-.5-ot,Tt=We.tileID?We.tileID:new Li(Rt,We.wrap,We.zoom,Ge,ot);Ce.push({tileID:Tt,distanceSq:Ft*Ft+St*St})}}if(this.fogCullDistSq){const We=this.fogCullDistSq,Ge=this.horizonLineFromTop();Ce=Ce.filter(ot=>{const yt=[0,0,0,1],pt=[mt,mt,0,1],Rt=this.calculateFogTileMatrix(ot.tileID.toUnwrapped());Hi.transformMat4(yt,yt,Rt),Hi.transformMat4(pt,pt,Rt);const Ft=function(nn,sn,on){let cn=0;for(let yn=0;yn<2;++yn)nn[yn]>0&&(cn+=(nn[yn]-0)*(nn[yn]-0)),sn[yn]<0&&(cn+=(0-sn[yn])*(0-sn[yn]));return cn}(Hi.min([],yt,pt),Hi.max([],yt,pt));if(Ft===0)return!0;let St=!1;const Tt=this._elevation;if(Tt&&Ft>We&&Ge!==0){const nn=this.calculateProjMatrix(ot.tileID.toUnwrapped());let sn;t.isTerrainDEM||(sn=Tt.getMinMaxForTile(ot.tileID)),sn||(sn={min:J,max:q});const on=function(yn){const kn=Math.round((yn+45+360)%360/90)%4;return Me[kn]}(this.rotation),cn=[on[0]*mt,on[1]*mt,sn.max];ke.transformMat4(cn,cn,nn),St=(1-cn[1])*this.height*.5<Ge}return Ft<We||St})}return Ce.sort((We,Ge)=>We.distanceSq-Ge.distanceSq).map(We=>We.tileID)}resize(t,r){this.width=t,this.height=r,this.pixelsToGLUnits=[2/t,-2/r],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(t){return Math.pow(2,t)}scaleZoom(t){return Math.log(t)/Math.LN2}project(t){const r=ae(t.lat,-qa,qa),c=this.projection.project(t.lng,r);return new V(c.x*this.worldSize,c.y*this.worldSize)}unproject(t){return this.projection.unproject(t.x/this.worldSize,t.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/$i(1,this.center.lat)/this.worldSize}setLocationAtPoint(t,r){let c,u;const h=this.centerPoint;if(this.projection.name==="globe"){const g=this.worldSize;c=(r.x-h.x)/g,u=(r.y-h.y)/g}else{const g=this.pointCoordinate(r),v=this.pointCoordinate(h);c=g.x-v.x,u=g.y-v.y}const m=this.locationCoordinate(t);this.setLocation(new vi(m.x-c,m.y-u))}setLocation(t){this.center=this.coordinateLocation(t),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(t){return this.projection.locationPoint(this,t)}locationPoint3D(t){return this.projection.locationPoint(this,t,!0)}pointLocation(t){return this.coordinateLocation(this.pointCoordinate(t))}pointLocation3D(t){return this.coordinateLocation(this.pointCoordinate3D(t))}locationCoordinate(t,r){const c=r?$i(r,t.lat):void 0,u=this.projection.project(t.lng,t.lat);return new vi(u.x,u.y,c)}coordinateLocation(t){return this.projection.unproject(t.x,t.y)}pointRayIntersection(t,r){const c=r??this._centerAltitude,u=[t.x,t.y,0,1],h=[t.x,t.y,1,1];Hi.transformMat4(u,u,this.pixelMatrixInverse),Hi.transformMat4(h,h,this.pixelMatrixInverse);const m=h[3];Hi.scale(u,u,1/u[3]),Hi.scale(h,h,1/m);const g=u[2],v=h[2];return{p0:u,p1:h,t:g===v?0:(c-g)/(v-g)}}screenPointToMercatorRay(t){const r=[t.x,t.y,0,1],c=[t.x,t.y,1,1];return Hi.transformMat4(r,r,this.pixelMatrixInverse),Hi.transformMat4(c,c,this.pixelMatrixInverse),Hi.scale(r,r,1/r[3]),Hi.scale(c,c,1/c[3]),r[2]=$i(r[2],this._center.lat)*this.worldSize,c[2]=$i(c[2],this._center.lat)*this.worldSize,Hi.scale(r,r,1/this.worldSize),Hi.scale(c,c,1/this.worldSize),new k2([r[0],r[1],r[2]],ke.normalize([],ke.sub([],c,r)))}rayIntersectionCoordinate(t){const{p0:r,p1:c,t:u}=t,h=$i(r[2],this._center.lat),m=$i(c[2],this._center.lat);return new vi(Ln(r[0],c[0],u)/this.worldSize,Ln(r[1],c[1],u)/this.worldSize,Ln(h,m,u))}pointCoordinate(t,r=this._centerAltitude){return this.projection.pointCoordinate(this,t.x,t.y,r)}pointCoordinate3D(t){if(!this.elevation)return this.pointCoordinate(t);let r=this.projection.pointCoordinate3D(this,t.x,t.y);if(r)return new vi(r[0],r[1],r[2]);let c=0,u=this.horizonLineFromTop();if(t.y>u)return this.pointCoordinate(t);const h=.02*u,m=t.clone();for(let g=0;g<10&&u-c>h;g++){m.y=Ln(c,u,.66);const v=this.projection.pointCoordinate3D(this,m.x,m.y);v?(u=m.y,r=v):c=m.y}return r?new vi(r[0],r[1],r[2]):this.pointCoordinate(t)}isPointAboveHorizon(t){return this.projection.isPointAboveHorizon(this,t)}isPointOnSurface(t){if(t.y<0||t.y>this.height||t.x<0||t.x>this.width)return!1;if(this.elevation||this.zoom>=bp)return!this.isPointAboveHorizon(t);const r=this.pointCoordinate(t);return r.y>=0&&r.y<=1}_coordinatePoint(t,r){const c=r&&this.elevation?this.elevation.getAtPointOrZero(t,this._centerAltitude):this._centerAltitude,u=[t.x*this.worldSize,t.y*this.worldSize,c+t.toAltitude(),1];return Hi.transformMat4(u,u,this.pixelMatrix),u[3]>0?new V(u[0]/u[3],u[1]/u[3]):new V(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:t,left:r}=this._edgeInsets,c=this.height-this._edgeInsets.bottom,u=this.width-this._edgeInsets.right,h=this.pointLocation3D(new V(r,t)),m=this.pointLocation3D(new V(u,t)),g=this.pointLocation3D(new V(u,c)),v=this.pointLocation3D(new V(r,c));let b=Math.min(h.lng,m.lng,g.lng,v.lng),w=Math.max(h.lng,m.lng,g.lng,v.lng),A=Math.min(h.lat,m.lat,g.lat,v.lat),C=Math.max(h.lat,m.lat,g.lat,v.lat);const P=Math.pow(2,-this.zoom)/16*270,k=this.projection.name==="globe"?1:4,z=(U,W,$,Z,K)=>{const q=(U+$)/2,J=(W+Z)/2,re=new V(q,J),{lng:ce,lat:ge}=this.pointLocation3D(re),ve=Math.max(0,b-ce,A-ge,ce-w,ge-C);b=Math.min(b,ce),w=Math.max(w,ce),A=Math.min(A,ge),C=Math.max(C,ge),(K<k||ve>P)&&(z(U,W,q,J,K+1),z(q,J,$,Z,K+1))};if(z(r,t,u,t,1),z(u,t,u,c,1),z(u,c,r,c,1),z(r,c,r,t,1),this.projection.name==="globe"){const[U,W]=function($){const Z=rt.identity(new Float64Array(16));rt.multiply(Z,$.pixelMatrix,$.globeMatrix);const K=[0,fc,0],q=[0,mc,0];return ke.transformMat4(K,K,Z),ke.transformMat4(q,q,Z),[K[0]>0&&K[0]<=$.width&&K[1]>0&&K[1]<=$.height&&!z2($,new On($.center.lat,90)),q[0]>0&&q[0]<=$.width&&q[1]>0&&q[1]<=$.height&&!z2($,new On($.center.lat,-90))]}(this);U?(C=90,w=180,b=-180):W&&(A=-90,w=180,b=-180)}return new Ol(new On(b,A),new On(w,C))}_getBoundsRectangular(t,r){const{top:c,left:u}=this._edgeInsets,h=this.height-this._edgeInsets.bottom,m=this.width-this._edgeInsets.right,g=new V(u,c),v=new V(m,c),b=new V(m,h),w=new V(u,h);let A=this.pointCoordinate(g,t),C=this.pointCoordinate(v,t);const P=this.pointCoordinate(b,r),k=this.pointCoordinate(w,r),z=(U,W)=>(W.y-U.y)/(W.x-U.x);return A.y>1&&C.y>=0?A=new vi((1-k.y)/z(k,A)+k.x,1):A.y<0&&C.y<=1&&(A=new vi(-k.y/z(k,A)+k.x,0)),C.y>1&&A.y>=0?C=new vi((1-P.y)/z(P,C)+P.x,1):C.y<0&&A.y<=1&&(C=new vi(-P.y/z(P,C)+P.x,0)),new Ol().extend(this.coordinateLocation(A)).extend(this.coordinateLocation(C)).extend(this.coordinateLocation(k)).extend(this.coordinateLocation(P))}_getBoundsRectangularTerrain(){const t=this.elevation;if(!t.visibleDemTiles.length||t.isUsingMockSource())return this._getBoundsRectangular(0,0);const r=t.visibleDemTiles.reduce((c,u)=>{if(u.dem){const h=u.dem.tree;c.min=Math.min(c.min,h.minimums[0]),c.max=Math.max(c.max,h.maximums[0])}return c},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(r.min*t.exaggeration(),r.max*t.exaggeration())}getBounds(){return this.projection.name==="mercator"||this.projection.name==="equirectangular"?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(t=!0){const r=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))-this.centerOffset.y,c=this.height/2-r*(1-this._horizonShift);return t?Math.max(0,c):c}getMaxBounds(){return this.maxBounds}setMaxBounds(t){this.maxBounds=t,this.minLat=-qa,this.maxLat=qa,this.minLng=-180,this.maxLng=180,t&&(this.minLat=t.getSouth(),this.maxLat=t.getNorth(),this.minLng=t.getWest(),this.maxLng=t.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=vo(this.minLng)*this.tileSize,this.worldMaxX=vo(this.maxLng)*this.tileSize,this.worldMinY=Co(this.maxLat)*this.tileSize,this.worldMaxY=Co(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(t,r){return this.projection.createTileMatrix(this,r,t)}calculateDistanceTileData(t){const r=t.key,c=this._distanceTileDataCache;if(c[r])return c[r];const u=t.canonical,h=1/this.height,m=this.cameraWorldSize,g=m/this.zoomScale(u.z),v=(u.x+Math.pow(2,u.z)*t.wrap)*g,b=u.y*g,w=this.point;w.x*=m/this.worldSize,w.y*=m/this.worldSize;const A=this.angle,C=Math.sin(-A),P=-Math.cos(-A);return c[r]={bearing:[C,P],center:[(w.x-v)*h,(w.y-b)*h],scale:g/mt*h},c[r]}calculateFogTileMatrix(t){const r=t.key,c=this._fogTileMatrixCache;if(c[r])return c[r];const u=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,t);return rt.multiply(u,this.worldToFogMatrix,u),c[r]=new Float32Array(u),c[r]}calculateProjMatrix(t,r=!1){const c=t.key,u=r?this._alignedProjMatrixCache:this._projMatrixCache;if(u[c])return u[c];const h=this.calculatePosMatrix(t,this.worldSize);return rt.multiply(h,this.projection.isReprojectedInTileSpace?this.mercatorMatrix:r?this.alignedProjMatrix:this.projMatrix,h),u[c]=new Float32Array(h),u[c]}calculatePixelsToTileUnitsMatrix(t){const r=t.tileID.key,c=this._pixelsToTileUnitsCache;if(c[r])return c[r];const u=function(h,m){const{scale:g}=h.tileTransform,v=g*mt/(h.tileSize*Math.pow(2,m.zoom-h.tileID.overscaledZ+h.tileID.canonical.z));return av.scale(new Float32Array(4),m.inverseAdjustmentMatrix,[v,v])}(t,this);return c[r]=u,c[r]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if(this.projection.name==="globe"){const t=1/this.worldSize,r=rt.fromScaling([],[t,t,t]);return rt.multiply(r,r,this.globeMatrix),r}}recenterOnTerrain(){if(!this._elevation||this.projection.name==="globe")return;const t=this._elevation;this._updateCameraState();const r=$i(1,this._center.lat)*this.worldSize,c=this._computeCameraPosition(r),u=this._camera.forward(),h=$i(1,this._center.lat);c[2]/=h,u[2]/=h,ke.normalize(u,u);const m=t.raycast(c,u,t.exaggeration());if(m){const g=ke.scaleAndAdd([],c,u,m),v=new vi(g[0],g[1],$i(g[2],yr(g[1]))),b=(v.z+ke.length([v.x-c[0],v.y-c[1],v.z-c[2]*h]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(b),this._centerAltitude=v.toAltitude(),this._center=this.coordinateLocation(v),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(t=!1){if(!this._elevation)return;const r=this._elevation,c=$i(1,this._center.lat)*this.worldSize,u=this._computeCameraPosition(c),h=r.getAtPointOrZero(new vi(...u)),m=this.pixelsPerMeter/this.worldSize*h,g=this._minimumHeightOverTerrain(),v=u[2]-m;if(v<=g)if(v<0||t){const b=this.locationCoordinate(this._center,this._centerAltitude),w=[u[0],u[1],b.z-u[2]],A=ke.length(w);w[2]-=(g-v)/this._pixelsPerMercatorPixel;const C=ke.length(w);if(C===0)return;ke.scale(w,w,A/C*this._pixelsPerMercatorPixel),this._camera.position=[u[0],u[1],b.z*this._pixelsPerMercatorPixel-w[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const t=this.projection.name==="globe"||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||t){const C=this.center;return C.lat=ae(C.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!t)&&(C.lng=ae(C.lng,this.minLng,this.maxLng)),this.center=C,void(this._constraining=!1)}const r=this._unmodified,{x:c,y:u}=this.point;let h=0,m=c,g=u;const v=this.width/2,b=this.height/2,w=this.worldMinY*this.scale,A=this.worldMaxY*this.scale;if(u-b<w&&(g=w+b),u+b>A&&(g=A-b),A-w<this.height&&(h=Math.max(h,this.height/(A-w)),g=(A+w)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const C=this.worldMinX*this.scale,P=this.worldMaxX*this.scale,k=this.worldSize/2-(C+P)/2;m=(c+k+this.worldSize)%this.worldSize-k,m-v<C&&(m=C+v),m+v>P&&(m=P-v),P-C<this.width&&(h=Math.max(h,this.width/(P-C)),m=(P+C)/2)}m===c&&g===u||(this.center=this.unproject(new V(m,g))),h&&(this.zoom+=this.scaleZoom(h)),this._constrainCamera(),this._unmodified=r,this._constraining=!1}_minZoomForBounds(){let t=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(t=Math.max(t,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),t}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const t=this.centerOffset,r=this.projection.name==="globe",c=this.pixelsPerMeter;this.projection.name==="globe"&&(this._mercatorScaleRatio=$i(1,this.center.lat)/$i(1,45));const u=P1(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,u),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const h=this.projection.zAxisUnit==="meters"?c:1,m=this._camera.getWorldToCamera(this.worldSize,h);let g;const v=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);if(v[8]=2*-t.x/this.width,v[9]=2*t.y/this.height,this.isOrthographic){let ge=.5*this.height/Math.tan(this._fov/2)*1*Math.tan(.5*this._fov),ve=ge*this.aspect,Ce=-ve,Ae=-ge;ve-=t.x,Ce-=t.x,ge+=t.y,Ae+=t.y,g=this._camera.getCameraToClipOrthographic(Ce,ve,Ae,ge,this._nearZ,this._farZ),((Le,Se,Ve,Xe)=>{for(let nt=0;nt<16;nt++)Le[nt]=GF(Se[nt],Ve[nt],Xe)})(g,g,v,HF(this.pitch>=15?1:this.pitch/15))}else g=v;const b=rt.mul([],v,m);let w=rt.mul([],g,m);if(this.projection.isReprojectedInTileSpace){const ge=this.locationCoordinate(this.center),ve=rt.identity([]);rt.translate(ve,ve,[ge.x*this.worldSize,ge.y*this.worldSize,0]),rt.multiply(ve,ve,IF(this)),rt.translate(ve,ve,[-ge.x*this.worldSize,-ge.y*this.worldSize,0]),rt.multiply(w,w,ve),rt.multiply(b,b,ve),this.inverseAdjustmentMatrix=function(Ce){const Ae=IF(Ce,!0);return av.invert([],[Ae[0],Ae[1],Ae[4],Ae[5]])}(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];this.mercatorMatrix=rt.scale([],w,[this.worldSize,this.worldSize,this.worldSize/h,1]),this.projMatrix=w,this.invProjMatrix=rt.invert(new Float64Array(16),this.projMatrix);const A=rt.invert([],g);this.frustumCorners=KC.fromInvProjectionMatrix(A,this.horizonLineFromTop(),this.height),this.cameraFrustum=ah.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,0,!r);const C=new Float32Array(16);rt.identity(C),rt.scale(C,C,[1,-1,1]),rt.rotateX(C,C,this._pitch),rt.rotateZ(C,C,this.angle);const P=rt.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ);this.starsProjMatrix=rt.clone(P);const k=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;P[8]=2*-t.x/this.width,P[9]=2*(t.y+k)/this.height,this.skyboxMatrix=rt.multiply(C,P,C);const z=this.point,U=z.x,W=z.y,$=this.width%2/2,Z=this.height%2/2,K=Math.cos(this.angle),q=Math.sin(this.angle),J=U-Math.round(U)+K*$+q*Z,re=W-Math.round(W)+K*Z+q*$,ce=new Float64Array(w);if(rt.translate(ce,ce,[J>.5?J-1:J,re>.5?re-1:re,0]),this.alignedProjMatrix=ce,w=rt.create(),rt.scale(w,w,[this.width/2,-this.height/2,1]),rt.translate(w,w,[1,-1,0]),this.labelPlaneMatrix=w,w=rt.create(),rt.scale(w,w,[1,-1,1]),rt.translate(w,w,[-1,-1,0]),rt.scale(w,w,[2/this.width,2/this.height,1]),this.glCoordMatrix=w,this.pixelMatrix=rt.multiply(new Float64Array(16),this.labelPlaneMatrix,b),this._calcFogMatrices(),this._distanceTileDataCache={},w=rt.invert(new Float64Array(16),this.pixelMatrix),!w)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=w,this.projection.name==="globe"||this.mercatorFromTransition){this.globeMatrix=function(ve){const{x:Ce,y:Ae}=ve.point,{lng:Le,lat:Se}=ve._center;return QN(Ce,Ae,ve.worldSize,Le,Se)}(this);const ge=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=ke.transformMat4(ge,ge,m),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=w;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const t=this.cameraWorldSizeForFog,r=this.cameraPixelsPerMeter,c=this._camera.position,u=1/this.height/this._pixelsPerMercatorPixel,h=[t,t,r];ke.scale(h,h,u),ke.scale(c,c,-1),ke.multiply(c,c,h);const m=rt.create();rt.translate(m,m,c),rt.scale(m,m,h),this.mercatorFogMatrix=m,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(t,r,u)}_computeCameraPosition(t){const r=(t=t||this.pixelsPerMeter)/this.pixelsPerMeter,c=this._camera.forward(),u=this.point,h=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*r-t/this.worldSize*this._centerAltitude;return[u.x/this.worldSize-c[0]*h,u.y/this.worldSize-c[1]*h,t/this.worldSize*this._centerAltitude-c[2]*h]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(t){const r=this._maxCameraBoundsDistance()*Math.cos(this._pitch),c=this._camera.position[2],u=t[2];let h=1;this.projection.wrap&&(this.center=this.center.wrap()),u>0&&(h=Math.min((r-c)/u,1)),this._camera.position=ke.scaleAndAdd([],this._camera.position,t,h),this._updateStateFromCamera()}_updateStateFromCamera(){const t=this._camera.position,r=this._camera.forward(),{pitch:c,bearing:u}=this._camera.getPitchBearing(),h=$i(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,m=this._mercatorZfromZoom(this._maxZoom)*Math.cos(ye(this._maxPitch)),g=Math.max((t[2]-h)/Math.cos(c),m),v=this._zoomFromMercatorZ(g);ke.scaleAndAdd(t,t,r,g),this._pitch=ae(c,ye(this.minPitch),ye(this.maxPitch)),this.angle=Je(u,-Math.PI,Math.PI),this._setZoom(ae(v,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new vi(t[0],t[1],t[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(t){return Math.pow(2,t)*this.tileSize}_mercatorZfromZoom(t){return this.cameraToCenterDistance/this._worldSizeFromZoom(t)}_minimumHeightOverTerrain(){const t=Math.min((this._seaLevelZoom!=null?this._seaLevelZoom:this._zoom)+4,this._maxZoom);return this._mercatorZfromZoom(t)}_zoomFromMercatorZ(t){return this.scaleZoom(this.cameraToCenterDistance/(t*this.tileSize))}zoomFromMercatorZAdjusted(t){let r=0,c=bp,u=0,h=1/0;for(;c-r>1e-6&&c>r;){const m=r+.5*(c-r),g=this.tileSize*Math.pow(2,m),v=this.getCameraToCenterDistance(this.projection,m,g),b=this.scaleZoom(v/(t*this.tileSize)),w=Math.abs(m-b);w<h&&(h=w,u=m),m<b?r=m:c=m}return u}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(_e("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(t,r){const c=Math.min(t.x,r.x),u=Math.max(t.x,r.x),h=Math.min(t.y,r.y),m=Math.max(t.y,r.y);if(h<this.horizonLineFromTop(!1))return!0;if(this.projection.name!=="mercator")return!1;const g=[new V(c,h),new V(u,m),new V(c,m),new V(u,h)],v=this.renderWorldCopies?-3:0,b=this.renderWorldCopies?4:1;for(const w of g){const A=this.pointRayIntersection(w);if(A.t<0)return!0;const C=this.rayIntersectionCoordinate(A);if(C.x<v||C.y<0||C.x>b||C.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+pe(this.fovAboveCenter)>88||this.anyCornerOffEdge(new V(0,0),new V(this.width,this.height))}zoomDeltaToMovement(t,r){const c=ke.length(ke.sub([],this._camera.position,t)),u=this._zoomFromMercatorZ(c)+r;return c-this._mercatorZfromZoom(u)}getCameraPoint(){if(this.projection.name==="globe"){const t=function([r,c,u],h){const m=[r,c,u,1];Hi.transformMat4(m,m,h);const g=m[3]=Math.max(m[3],1e-6);return m[0]/=g,m[1]/=g,m[2]/=g,m}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new V(t[0],t[1])}{const t=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new V(0,t))}}getCameraToCenterDistance(t,r=this.zoom,c=this.worldSize){const u=P1(t,r,this.width,this.height,1024),h=t.pixelSpaceConversion(this.center.lat,c,u);let m=.5/Math.tan(.5*this._fov)*this.height*h;return this.isOrthographic&&(m=GF(1,m,HF(this.pitch>=15?1:this.pitch/15))),m}getWorldToCameraMatrix(){const t=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?this.pixelsPerMeter:1);return this.projection.name==="globe"&&rt.multiply(t,t,this.globeMatrix),t}getFrustum(t){return ah.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,t,this.projection.zAxisUnit==="meters")}}function jF(a,t,r){rt.identity(a),rt.rotateZ(a,a,ye(t[2])),rt.rotateX(a,a,ye(t[0])),rt.rotateY(a,a,ye(t[1])),rt.scale(a,a,r),rt.multiply(a,a,[1,0,0,0,0,0,1,0,0,1,0,0,0,0,0,1])}function S3(a,t,r,c,u,h,m,g){const v=[r[0]-t[0],r[1]-t[1],0],b=[c[0]-t[0],c[1]-t[1],0];if(ke.length(v)<1e-12||ke.length(b)<1e-12)return To.identity(a);const w=ke.cross([],v,b);ke.normalize(w,w),ke.subtract(b,c,t),v[2]=(h-u)*g,b[2]=(m-u)*g;const A=v;return ke.cross(A,v,b),ke.normalize(A,A),To.rotationTo(a,w,A)}function $F(a,t,r=!1){const c=yo(t.zoom),u=function(h,m,g){const v=m.worldSize,b=[h[12],h[13],h[14]],w=yr(b[1]/v),A=sl(b[0]/v),C=rt.identity([]),P=$i(1,w)*v,k=$i(1,0)*v*wp(w,m.zoom),z=1/iP(v);let U=k*z;if(g){const K=P1(m.projection,m.zoom,m.width,m.height,1024);U=z*m.projection.pixelSpaceConversion(m.center.lat,v,K)}const W=zs(w,A);ke.add(W,W,ke.scale([],ke.normalize([],W),P*U*b[2]));const $=function(K){const q=[K[0],K[1],K[2]];let J=[0,1,0];const re=ke.cross([],J,q);return ke.cross(J,q,re),ke.squaredLength(J)===0&&(J=[0,1,0],ke.cross(re,q,J)),ke.normalize(re,re),ke.normalize(J,J),ke.normalize(q,q),[re[0],re[1],re[2],0,J[0],J[1],J[2],0,q[0],q[1],q[2],0,K[0],K[1],K[2],1]}(W);rt.scale(C,C,[U,U,U*P]),rt.translate(C,C,[-b[0],-b[1],-b[2]]);const Z=rt.multiply([],m.globeMatrix,$);return rt.multiply(Z,Z,C),rt.multiply(Z,Z,h),Z}(a,t,r);if(c>0){const h=function(m,g){const v=g.worldSize,b=$i(1,0)*v*wp(g.center.lat,g.zoom)/iP(v),w=$i(1,g.center.lat)*v,A=rt.identity([]);return rt.rotateY(A,A,ye(g.center.lng)),rt.rotateX(A,A,ye(g.center.lat)),rt.translate(A,A,[0,0,cs]),rt.scale(A,A,[b,b,b*w]),rt.translate(A,A,[g.point.x-.5*v,g.point.y-.5*v,0]),rt.multiply(A,A,m),rt.multiply(A,g.globeMatrix,A)}(a,t);return function(m,g,v){const b=(k,z,U)=>{const W=ke.length(k),$=ke.length(z),Z=rh(k,z,U);return ke.scale(Z,Z,1/ke.length(Z)*Ln(W,$,U))},w=b([m[0],m[1],m[2]],[g[0],g[1],g[2]],v),A=b([m[4],m[5],m[6]],[g[4],g[5],g[6]],v),C=b([m[8],m[9],m[10]],[g[8],g[9],g[10]],v),P=rh([m[12],m[13],m[14]],[g[12],g[13],g[14]],v);return[w[0],w[1],w[2],0,A[0],A[1],A[2],0,C[0],C[1],C[2],0,P[0],P[1],P[2],1]}(u,h,c)}return u}const Cm=64,zne=[1,1,1];class YF{constructor(t,r,c,u){this.id=t,this.position=r!=null?new On(r[0],r[1]):new On(0,0),this.orientation=c??[0,0,0],this.nodes=u,this.uploaded=!1,this.aabb=new ga([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),this.matrix=[]}_applyTransformations(t,r){if(rt.multiply(t.matrix,r,t.matrix),t.meshes)for(const c of t.meshes){const u=ga.applyTransform(c.aabb,t.matrix);this.aabb.encapsulate(u)}if(t.children)for(const c of t.children)this._applyTransformations(c,t.matrix)}computeBoundsAndApplyParent(){const t=rt.identity([]);for(const r of this.nodes)this._applyTransformations(r,t)}_positionModelOnTerrain(t,r){const c=t.elevation;if(!c)return 0;const u=ga.projectAabbCorners(this.aabb,this.matrix),h=$i(1,this.position.lat)*t.worldSize,m=function(W,$){const Z=[0,0,1],K=[{corners:[0,1,3,2],dotProductWithUp:0},{corners:[1,5,2,6],dotProductWithUp:0},{corners:[0,4,1,5],dotProductWithUp:0},{corners:[2,6,3,7],dotProductWithUp:0},{corners:[4,7,5,6],dotProductWithUp:0},{corners:[0,3,4,7],dotProductWithUp:0}];for(const q of K){const J=W[q.corners[0]],re=W[q.corners[1]],ce=W[q.corners[2]],ge=[re[0]-J[0],re[1]-J[1],$*(re[2]-J[2])],ve=ke.cross(ge,ge,[ce[0]-J[0],ce[1]-J[1],$*(ce[2]-J[2])]);ke.normalize(ve,ve),q.dotProductWithUp=ke.dot(ve,Z)}return K.sort((q,J)=>q.dotProductWithUp-J.dotProductWithUp),K[0].corners}(u,h),g=u[m[0]],v=u[m[1]],b=u[m[2]],w=u[m[3]],A=c.getAtPointOrZero(new vi(g[0]/t.worldSize,g[1]/t.worldSize),0),C=c.getAtPointOrZero(new vi(v[0]/t.worldSize,v[1]/t.worldSize),0),P=c.getAtPointOrZero(new vi(b[0]/t.worldSize,b[1]/t.worldSize),0),k=c.getAtPointOrZero(new vi(w[0]/t.worldSize,w[1]/t.worldSize),0),z=(A+k)/2,U=(C+P)/2;return z>U?C<P?S3(r,v,w,g,C,k,A,h):S3(r,b,g,w,P,A,k,h):A<k?S3(r,g,v,b,A,C,P,h):S3(r,w,b,v,k,P,C,h),Math.max(z,U)}computeModelMatrix(t,r,c,u,h,m,g=!1){const v=t.transform,b=v.zoom,w=v.project(this.position),A=wp(this.position.lat,b),C=1/A;rt.identity(this.matrix),rt.translate(this.matrix,this.matrix,[w.x+u[0]*C,w.y+u[1]*C,u[2]]);let P=1,k=1;const z=v.worldSize;if(g){if(v.projection.name==="mercator"){let Z=0;v.elevation&&(Z=v.elevation.getAtPointOrZero(new vi(w.x/z,w.y/z),0));const K=Hi.transformMat4([],[w.x,w.y,Z,1],v.projMatrix)[3]/v.cameraToCenterDistance;P=K,k=K*wp(v.center.lat,b)}else if(v.projection.name==="globe"){const Z=$F(this.matrix,v),K=rt.multiply([],v.projMatrix,Z),q=[0,0,0,1];Hi.transformMat4(q,q,K);const J=q[3]/v.cameraToCenterDistance,re=yo(b),ce=v.projection.pixelsPerMeter(this.position.lat,z)*wp(this.position.lat,b),ge=v.projection.pixelsPerMeter(v.center.lat,z)*wp(v.center.lat,b);P=J/Ln(ce,oz(v.center.lat),re),k=J*A/ce,P*=ge,k*=ge}}else P=C;rt.scale(this.matrix,this.matrix,[P,P,k]);const U=[...this.matrix],W=this.orientation,$=[];if(jF($,[W[0]+r[0],W[1]+r[1],W[2]+r[2]],c),rt.multiply(this.matrix,U,$),h&&v.elevation){let Z=0;const K=[];if(m&&v.elevation){Z=this._positionModelOnTerrain(v,K);const q=rt.fromQuat([],K),J=rt.multiply([],q,$);rt.multiply(this.matrix,U,J)}else Z=v.elevation.getAtPointOrZero(new vi(w.x/z,w.y/z),0);Z!==0&&(this.matrix[14]+=Z)}}upload(t){if(!this.uploaded){for(const r of this.nodes)YP(r,t);for(const r of this.nodes)A3(r);this.uploaded=!0}}destroy(){for(const t of this.nodes)E3(t)}}function I1(a,t,r=!1){a.uploaded||(a.gfxTexture=new vr(t,a.image,r?t.gl.R8:t.gl.RGBA,{useMipmap:a.sampler.minFilter>=t.gl.NEAREST_MIPMAP_NEAREST}),a.uploaded=!0,a.image=null)}function Fne(a,t,r){a.indexBuffer=t.createIndexBuffer(a.indexArray,!1,!0),a.vertexBuffer=t.createVertexBuffer(a.vertexArray,Tne.members,!1,!0),a.normalArray&&(a.normalBuffer=t.createVertexBuffer(a.normalArray,Lne.members,!1,!0)),a.texcoordArray&&(a.texcoordBuffer=t.createVertexBuffer(a.texcoordArray,Ine.members,!1,!0)),a.colorArray&&(a.colorBuffer=t.createVertexBuffer(a.colorArray,(a.colorArray.bytesPerElement===12?Cne:Pne).members,!1,!0)),a.featureArray&&(a.pbrBuffer=t.createVertexBuffer(a.featureArray,kne.members,!0)),a.segments=ji.simpleSegment(0,0,a.vertexArray.length,a.indexArray.length);const c=a.material;c.pbrMetallicRoughness.baseColorTexture&&I1(c.pbrMetallicRoughness.baseColorTexture,t),c.pbrMetallicRoughness.metallicRoughnessTexture&&I1(c.pbrMetallicRoughness.metallicRoughnessTexture,t),c.normalTexture&&I1(c.normalTexture,t),c.occlusionTexture&&I1(c.occlusionTexture,t,r),c.emissionTexture&&I1(c.emissionTexture,t)}function YP(a,t,r){if(a.meshes)for(const c of a.meshes)Fne(c,t,r);if(a.children)for(const c of a.children)YP(c,t,r)}function A3(a){if(a.meshes)for(const t of a.meshes)t.indexArray.destroy(),t.vertexArray.destroy(),t.colorArray&&t.colorArray.destroy(),t.normalArray&&t.normalArray.destroy(),t.texcoordArray&&t.texcoordArray.destroy(),t.featureArray&&t.featureArray.destroy();if(a.children)for(const t of a.children)A3(t)}function E3(a){if(a.meshes)for(const r of a.meshes)r.vertexBuffer&&(r.vertexBuffer.destroy(),r.indexBuffer.destroy(),r.normalBuffer&&r.normalBuffer.destroy(),r.texcoordBuffer&&r.texcoordBuffer.destroy(),r.colorBuffer&&r.colorBuffer.destroy(),r.pbrBuffer&&r.pbrBuffer.destroy(),r.segments.destroy(),r.material&&((t=r.material).pbrMetallicRoughness.baseColorTexture&&t.pbrMetallicRoughness.baseColorTexture.gfxTexture&&t.pbrMetallicRoughness.baseColorTexture.gfxTexture.destroy(),t.pbrMetallicRoughness.metallicRoughnessTexture&&t.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture&&t.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture.destroy(),t.normalTexture&&t.normalTexture.gfxTexture&&t.normalTexture.gfxTexture.destroy(),t.emissionTexture&&t.emissionTexture.gfxTexture&&t.emissionTexture.gfxTexture.destroy(),t.occlusionTexture&&t.occlusionTexture.gfxTexture&&t.occlusionTexture.gfxTexture.destroy()));var t;if(a.children)for(const r of a.children)E3(r)}class qF{constructor(t,r){this.feature=t,this.instancedDataOffset=r,this.instancedDataCount=0,this.rotation=[0,0,0],this.scale=[1,1,1],this.translation=[0,0,0]}}class XF{constructor(){this.instancedDataArray=new CC,this.instancesEvaluatedElevation=[],this.features=[],this.idToFeaturesIndex={}}}class ZF{constructor(t){this.zoom=t.zoom,this.canonical=t.canonical,this.layers=t.layers,this.layerIds=this.layers.map(r=>r.fqid),this.projection=t.projection,this.index=t.index,this.hasZoomDependentProperties=this.layers[0].isZoomDependent(),this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id),this.hasPattern=!1,this.instancesPerModel={},this.validForExaggeration=0,this.maxVerticalOffset=0,this.maxScale=0,this.maxHeight=0,this.lookupDim=this.zoom>this.canonical.z?256:this.zoom>15?75:100,this.instanceCount=0,this.terrainElevationMin=0,this.terrainElevationMax=0,this.validForDEMTile={id:null,timestamp:0}}populate(t,r,c,u){this.tileToMeter=p1(c);const h=this.layers[0]._featureFilter.needGeometry;this.lookup=new Uint8Array(this.lookupDim*this.lookupDim);for(const{feature:m,id:g,index:v,sourceLayerIndex:b}of t){const w=Sp(m,h);if(!this.layers[0]._featureFilter.filter(new sa(this.zoom),w,c))continue;const A={id:g,sourceLayerIndex:b,index:v,geometry:h?w.geometry:$u(m,c,u),properties:m.properties,type:m.type,patterns:{}},C=this.addFeature(A,A.geometry,w);C&&r.featureIndex.insert(m,A.geometry,v,b,this.index,this.instancesPerModel[C].instancedDataArray.length)}this.lookup=null}update(t,r,c,u){for(const h in this.instancesPerModel){const m=this.instancesPerModel[h];for(const g in t)m.idToFeaturesIndex.hasOwnProperty(g)&&this.evaluate(m.features[m.idToFeaturesIndex[g]],t[g],m,!0)}this.maxHeight=0}updateZoomBasedPaintProperties(){if(!this.hasZoomDependentProperties)return!1;let t=!1;for(const r in this.instancesPerModel){const c=this.instancesPerModel[r];for(const u of c.features){const h=this.layers[0],m=u.feature,g=this.canonical,v=h.paint.get("model-rotation").evaluate(m,{},g),b=h.paint.get("model-scale").evaluate(m,{},g),w=h.paint.get("model-translation").evaluate(m,{},g);ke.exactEquals(u.rotation,v)&&ke.exactEquals(u.scale,b)&&ke.exactEquals(u.translation,w)||(this.evaluate(u,u.featureStates,c,!0),t=!0)}}return t}isEmpty(){for(const t in this.instancesPerModel)if(this.instancesPerModel[t].instancedDataArray.length!==0)return!1;return!0}uploadPending(){return!this.uploaded}upload(t){if(!this.uploaded)for(const r in this.instancesPerModel){const c=this.instancesPerModel[r];c.instancedDataArray.length<0||c.instancedDataArray.length===0||(c.instancedDataBuffer?c.instancedDataBuffer.updateData(c.instancedDataArray):c.instancedDataBuffer=t.createVertexBuffer(c.instancedDataArray,Rne.members,!0,void 0,this.instanceCount))}this.uploaded=!0}destroy(){for(const t in this.instancesPerModel){const r=this.instancesPerModel[t];r.instancedDataArray.length!==0&&r.instancedDataBuffer&&r.instancedDataBuffer.destroy()}}addFeature(t,r,c){const u=this.layers[0],h=u.layout.get("model-id").evaluate(c,{},this.canonical);if(!h)return _e(`modelId is not evaluated for layer ${u.id} and it is not going to get rendered.`),h;this.instancesPerModel[h]||(this.instancesPerModel[h]=new XF);const m=this.instancesPerModel[h],g=m.instancedDataArray,v=new qF(c,g.length);for(const b of r)for(const w of b){if(w.x<0||w.x>=mt||w.y<0||w.y>=mt)continue;const A=(this.lookupDim-1)/mt,C=this.lookupDim*(w.y*A|0)+w.x*A|0;if(this.lookup){if(this.lookup[C]!==0)continue;this.lookup[C]=1}this.instanceCount++;const P=g.length;g.resize(P+1),m.instancesEvaluatedElevation.push(0),g.float32[16*P]=w.x,g.float32[16*P+1]=w.y}return v.instancedDataCount=m.instancedDataArray.length-v.instancedDataOffset,v.instancedDataCount>0&&(t.id&&(m.idToFeaturesIndex[t.id]=m.features.length),m.features.push(v),this.evaluate(v,{},m,!1)),h}evaluate(t,r,c,u){const h=this.layers[0],m=t.feature,g=this.canonical,v=t.rotation=h.paint.get("model-rotation").evaluate(m,r,g),b=t.scale=h.paint.get("model-scale").evaluate(m,r,g),w=t.translation=h.paint.get("model-translation").evaluate(m,r,g),A=h.paint.get("model-color").evaluate(m,r,g);A.a=h.paint.get("model-color-mix-intensity").evaluate(m,r,g);const C=[];this.maxVerticalOffset<w[2]&&(this.maxVerticalOffset=w[2]),this.maxScale=Math.max(Math.max(this.maxScale,b[0]),Math.max(b[1],b[2])),jF(C,v,b);const P=Math.round(100*A.a)+A.b/1.05;for(let k=0;k<t.instancedDataCount;++k){const z=t.instancedDataOffset+k,U=16*z,W=c.instancedDataArray.float32;let $=0;u&&($=W[U+6]-c.instancesEvaluatedElevation[z]);const Z=0|W[U+1];W[U]=(0|W[U])+A.r/1.05,W[U+1]=Z+A.g/1.05,W[U+2]=P,W[U+3]=1/(g.z>10?this.tileToMeter:p1(g,Z)),W[U+4]=w[0],W[U+5]=w[1],W[U+6]=w[2]+$,W[U+7]=C[0],W[U+8]=C[1],W[U+9]=C[2],W[U+10]=C[4],W[U+11]=C[5],W[U+12]=C[6],W[U+13]=C[8],W[U+14]=C[9],W[U+15]=C[10],c.instancesEvaluatedElevation[z]=w[2]}}}un(ZF,"ModelBucket",{omit:["layers"]}),un(XF,"PerModelAttributes"),un(qF,"ModelFeature");const Bne=new xa({visibility:new Zt(at.layout_model.visibility),"model-id":new _n(at.layout_model["model-id"])});var Une={paint:new xa({"model-opacity":new Zt(at.paint_model["model-opacity"]),"model-rotation":new _n(at.paint_model["model-rotation"]),"model-scale":new _n(at.paint_model["model-scale"]),"model-translation":new _n(at.paint_model["model-translation"]),"model-color":new _n(at.paint_model["model-color"]),"model-color-mix-intensity":new _n(at.paint_model["model-color-mix-intensity"]),"model-type":new Zt(at.paint_model["model-type"]),"model-cast-shadows":new Zt(at.paint_model["model-cast-shadows"]),"model-receive-shadows":new Zt(at.paint_model["model-receive-shadows"]),"model-ambient-occlusion-intensity":new Zt(at.paint_model["model-ambient-occlusion-intensity"]),"model-emissive-strength":new _n(at.paint_model["model-emissive-strength"]),"model-roughness":new _n(at.paint_model["model-roughness"]),"model-height-based-emissive-strength-multiplier":new _n(at.paint_model["model-height-based-emissive-strength-multiplier"]),"model-cutoff-fade-range":new Zt(at.paint_model["model-cutoff-fade-range"])}),layout:Bne};const qP=new Float32Array(262144),Pm=new Uint8Array(262144);function KF(a){let t=0;if(a.meshes)for(const r of a.meshes)t=Math.max(t,r.aabb.max[2]);if(a.children)for(const r of a.children)t=Math.max(t,KF(r));return t}const JF=["","wall","door","roof","window","lamp","logo"];class QF{constructor(t){this.node=t,this.evaluatedRMEA=[[1,0,0,1],[1,0,0,1],[1,0,0,1],[1,0,0,1],[.4,1,0,1],[1,0,0,1],[1,0,0,1]],this.hiddenByReplacement=!1,this.evaluatedScale=[1,1,1],this.evaluatedColor=[],this.emissionHeightBasedParams=[],this.feature={type:"Point",id:t.id,geometry:[],properties:{height:KF(t)}}}}class eB{constructor(t,r,c,u){this.nodes=t,this.id=r,this.modelTraits|=1,this.uploaded=!1,this.hasPattern=!1,c&&(this.modelTraits|=4),this.zoom=-1,this.terrainExaggeration=1,this.projection={name:"mercator"},this.replacementUpdateTime=0,this.elevationReadFromZ=255,this.brightness=u,this.dirty=!0,this.needsUpload=!1}update(){console.log("Update 3D model bucket")}populate(){console.log("populate 3D model bucket")}uploadPending(){return!this.uploaded||this.needsUpload}upload(t){if(!this.needsUpload)return;const r=this.getNodesInfo();for(const c of r){const u=c.node;this.uploaded?this.updatePbrBuffer(u):YP(u,t,!0)}for(const c of r)A3(c.node);this.uploaded=!0,this.needsUpload=!1}updatePbrBuffer(t){let r=!1;if(!t.meshes)return r;for(const c of t.meshes)c.pbrBuffer&&(c.pbrBuffer.updateData(c.featureArray),r=!0);return r}needsReEvaluation(t,r,c){const u=t.transform.projectionOptions,h=t.style.getBrightness(),m=this.brightness!==h;return!!(!this.uploaded||this.dirty||u.name!==this.projection.name||L1(c.paint.get("model-color").value,m)||L1(c.paint.get("model-color-mix-intensity").value,m)||L1(c.paint.get("model-roughness").value,m)||L1(c.paint.get("model-emissive-strength").value,m)||L1(c.paint.get("model-height-based-emissive-strength-multiplier").value,m))&&(this.projection=u,this.brightness=h,!0)}evaluateScale(t,r){if(t.transform.zoom===this.zoom)return;this.zoom=t.transform.zoom;const c=this.getNodesInfo(),u=this.id.canonical;for(const h of c){const m=h.feature;h.evaluatedScale=r.paint.get("model-scale").evaluate(m,{},u)}}evaluate(t){const r=this.getNodesInfo();for(const c of r){if(!c.node.meshes)continue;const u=c.feature,h=c.node.meshes&&c.node.meshes[0].featureData,m=c.evaluatedColor[2],g=c.evaluatedRMEA[2],v=this.id.canonical;if(c.hasTranslucentParts=!1,h){for(let b=0;b<JF.length;b++){const w=JF[b];w.length&&(u.properties.part=w);const A=t.paint.get("model-color").evaluate(u,{},v),C=t.paint.get("model-color-mix-intensity").evaluate(u,{},v);c.evaluatedColor[b]=[A.r,A.g,A.b,C],c.evaluatedRMEA[b][0]=t.paint.get("model-roughness").evaluate(u,{},v),c.evaluatedRMEA[b][2]=t.paint.get("model-emissive-strength").evaluate(u,{},v),c.evaluatedRMEA[b][3]=A.a,c.emissionHeightBasedParams[b]=t.paint.get("model-height-based-emissive-strength-multiplier").evaluate(u,{},v),!c.hasTranslucentParts&&A.a<1&&(c.hasTranslucentParts=!0)}delete u.properties.part,Vne(c,m!==c.evaluatedColor[2]||g!==c.evaluatedRMEA[2])}c.evaluatedScale=t.paint.get("model-scale").evaluate(u,{},v),this.updatePbrBuffer(c.node)||(this.needsUpload=!0)}this.dirty=!1}elevationUpdate(t,r,c,u){const h=t.findDEMTileFor(c);if(h&&(h.tileID.canonical!==this.terrainTile||r!==this.terrainExaggeration)){if(h.dem&&h.tileID.overscaledZ!==this.elevationReadFromZ){this.elevationReadFromZ=h.tileID.overscaledZ;const m=fv.create(t,c,h);if(!m)return;4&this.modelTraits&&this.updateDEM(t,m,c,u);for(const g of this.getNodesInfo()){const v=g.node;if(!v.footprint||!v.footprint.vertices||!v.footprint.vertices.length)continue;const b=v.footprint.vertices;let w=m.getElevationAt(b[0].x,b[0].y,!0,!0);for(let A=1;A<b.length;A++)w=Math.min(w,m.getElevationAt(b[A].x,b[A].y,!0,!0));v.elevation=w}}this.terrainTile=h.tileID.canonical,this.terrainExaggeration=r}}updateDEM(t,r,c,u){let h=r._dem._modifiedForSources[u];if(h===void 0&&(r._dem._modifiedForSources[u]=[],h=r._dem._modifiedForSources[u]),h.includes(c.canonical))return;const m=r._dem.dim;h.push(c.canonical);let g=!1;for(const v of this.getNodesInfo()){const b=v.node;if(!b.footprint||!b.footprint.grid)continue;const w=b.footprint.grid,A=r.tileCoordToPixel(w.min.x,w.min.y),C=r.tileCoordToPixel(w.max.x,w.max.y),P=Math.min(Math.min(m-C.y,A.x),Math.min(A.y,m-C.x));if(P<0)continue;const k=ae(P,2,5);let z=Math.max(0,A.x-k),U=Math.max(0,A.y-k),W=Math.min(C.x+k,m-1),$=Math.min(C.y+k,m-1);for(let J=U;J<=$;++J)for(let re=z;re<=W;++re)Pm[J*m+re]=255;let Z=0,K=0;for(let J=0;J<w.cellsY;++J)for(let re=0;re<w.cellsX;++re){if(!w.cells[J*w.cellsX+re])continue;const ce=r.tileCoordToPixel(w.min.x+re/w.xScale,w.min.y+J/w.yScale),ge=r.tileCoordToPixel(w.min.x+(re+1)/w.xScale,w.min.y+(J+1)/w.yScale);for(let ve=ce.y;ve<=Math.min(ge.y+1,m-1);++ve)for(let Ce=ce.x;Ce<=Math.min(ge.x+1,m-1);++Ce)Pm[ve*m+Ce]===255&&(Pm[ve*m+Ce]=0,Z+=r.getElevationAtPixel(Ce,ve),K++)}const q=Z/K;z=Math.max(1,A.x-k),U=Math.max(1,A.y-k),W=Math.min(C.x+k,m-2),$=Math.min(C.y+k,m-2),g=!0;for(let J=U;J<=$;++J)for(let re=z;re<=W;++re)Pm[J*m+re]===0&&(qP[J*m+re]=r._dem.set(re,J,q));for(let J=1;J<k;++J){z=Math.max(1,A.x-J),U=Math.max(1,A.y-J),W=Math.min(C.x+J,m-2),$=Math.min(C.y+J,m-2);for(let re=U;re<=$;++re)for(let ce=z;ce<=W;++ce){const ge=re*m+ce;if(Pm[ge]===255){let ve=0,Ce=0,Ae=-1,Le=-1;for(let Se=-1;Se<=1;++Se)for(let Ve=-1;Ve<=1;++Ve){const Xe=(re+Se)*m+ce+Ve;if(Pm[Xe]>=J)continue;const nt=qP[Xe],We=Math.abs(nt);We>Ce&&(ve=nt,Ce=We,Ae=Ve,Le=Se)}if(Ce>.1){const Se=1-(J+.5*Math.abs(Ae*Le))/k;let Ve=r._dem.get(ce,re)+ve*Se;const Xe=r._dem.get(ce+Ae,re+Le),nt=r._dem.get(ce-Ae,re-Le,!0);(Ve-Xe)*(Ve-nt)>0&&(Ve=(Xe+nt)/2),qP[ge]=r._dem.set(ce,re,Ve),Pm[ge]=J}}}}}g&&(r._demTile.needsDEMTextureUpload=!0,r._dem._timestamp=Cn.now())}getNodesInfo(){if(!this.nodesInfo){this.nodesInfo=[];for(const t of this.nodes)this.nodesInfo.push(new QF(t));this.freeNodes()}return this.nodesInfo}freeNodes(){if(this.nodes){for(const t of this.nodes)E3(t);this.nodes.splice(0,this.nodes.length)}}destroy(){this.freeNodes();const t=this.getNodesInfo();for(const r of t)A3(r.node),E3(r.node)}isEmpty(){return!this.nodes.length}updateReplacement(t,r){if(r.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=r.updateTime;const c=r.getReplacementRegionsForTile(t.toUnwrapped()),u=this.getNodesInfo();for(let h=0;h<this.nodesInfo.length;h++){const m=u[h].node;u[h].hiddenByReplacement=!!m.footprint&&!c.find(g=>g.footprint===m.footprint)}}getHeightAtTileCoord(t,r){const c=this.getNodesInfo(),u=[];for(let h=0;h<this.nodesInfo.length;h++){const m=c[h],g=m.node.meshes[0];if(t<g.aabb.min[0]||r<g.aabb.min[1]||t>g.aabb.max[0]||r>g.aabb.max[1])continue;const v=(t-g.aabb.min[0])/(g.aabb.max[0]-g.aabb.min[0])*Cm|0,b=Math.min(63,(r-g.aabb.min[1])/(g.aabb.max[1]-g.aabb.min[1])*Cm|0)*Cm+Math.min(63,v);if(!(g.heightmap[b]<0&&m.node.footprint))return m.hiddenByReplacement?void 0:{height:g.heightmap[b],maxHeight:m.feature.properties.height,hidden:!1,verticalScale:m.evaluatedScale[2]};if(m.node.footprint.grid.query(new V(t,r),new V(t,r),u),u.length>0)return{height:void 0,maxHeight:m.feature.properties.height,hidden:m.hiddenByReplacement,verticalScale:m.evaluatedScale[2]}}}}function L1(a,t){return!a.isLightConstant&&t}function Wne(a,t,r,c,u,h,m,g){let v=(61440&t|(61440&t)>>4)>>8,b=(3840&t|(3840&t)>>4)>>4,w=240&t|(240&t)>>4;r[3]>0&&(v=Ln(v,255*r[0],r[3]),b=Ln(b,255*r[1],r[3]),w=Ln(w,255*r[2],r[3]));const A=v<<8|b,C=w<<8|Math.floor(255*c[3]),P=function(J){const re=ae(J,0,2);return Math.min(Math.round(.5*re*255),255)}(c[2])<<8|15*c[0]<<4|15*c[1],k=ae(u[0],0,1),z=ae(u[1],0,1),U=ae(u[2],0,1),W=ae(u[3],0,1);let $,Z,K,q;if(k!==z&&m!==h&&z!==k){const J=m-h;Z=1/(J*(z-k)),K=-(h+J*k)/(J*(z-k));const re=ae(u[4],-1,1);q=Math.pow(10,re),$=255*U<<8|255*W}else $=65535,Z=0,K=1,q=1;if(a.emplaceBack(A,C,P,$,Z,K,q),g){const J=g.length;g.clear();for(let re=0;re<J;re++)g.emplaceBack(A,C,P,$,Z,K,q)}}function Vne(a,t){const r=a.node;let c=0;for(const u of r.meshes){if(r.lights&&r.lightMeshIndex===c||!u.featureData)continue;u.featureArray=new M2,u.featureArray.reserve(u.featureData.length);let h=t;for(const m of u.featureData){let g;const v=65535&m,b=(15&v)<8?15&v:0,w=m>>16&65535,A=a.evaluatedRMEA[b],C=a.evaluatedColor[b],P=a.emissionHeightBasedParams[b];if(h&&b===2&&r.lights&&(g=new M2,g.resize(10*r.lights.length)),Wne(u.featureArray,w,C,A,P,u.aabb.min[2],u.aabb.max[2],g),g&&h){h=!1;const k=r.meshes[r.lightMeshIndex];k.featureArray=g,k.featureArray._trim()}}u.featureArray._trim(),c++}}un(eB,"Tiled3dModelBucket",{omit:["layers"]}),un(QF,"Tiled3dModelFeature");class Gne{constructor(){this._updateTime=0,this._sourceIds=[],this._activeRegions=[],this._prevRegions=[]}clear(){this._activeRegions.length>0&&++this._updateTime,this._activeRegions=[],this._prevRegions=[]}get updateTime(){return this._updateTime}getReplacementRegionsForTile(t){const r=iB(new V(0,0),new V(mt,mt),t),c=[];for(const u of this._activeRegions){if(u.hiddenByOverlap||!nB(r,u))continue;const h=Hne(u.min,u.max,t);c.push({min:h.min,max:h.max,sourceId:this._sourceIds[u.priority],footprint:u.footprint,footprintTileId:u.tileId})}return c}setSources(t){this._setSources(t.map(r=>({getSourceId:()=>r.cache.id,getFootprints:()=>{const c=[];for(const u of r.cache.getVisibleCoordinates()){const h=r.cache.getTile(u).buckets[r.layer];if(h)for(const m of h.getNodesInfo()){const g=m.node;g.footprint&&c.push({footprint:g.footprint,id:u.toUnwrapped()})}}return c}})))}_addSource(t){const r=t.getFootprints();if(r.length!==0){for(const c of r){if(!c.footprint)continue;const u=iB(c.footprint.min,c.footprint.max,c.id);this._activeRegions.push({min:u.min,max:u.max,hiddenByOverlap:!1,priority:this._sourceIds.length,tileId:c.id,footprint:c.footprint})}this._sourceIds.push(t.getSourceId())}}_computeReplacement(){this._activeRegions.sort((r,c)=>r.priority-c.priority||M3(r.min,c.min)||M3(r.max,c.max));let t=this._activeRegions.length!==this._prevRegions.length;if(!t){let r=0,c=0;for(;!t&&r!==this._activeRegions.length;){const u=this._activeRegions[r],h=this._prevRegions[c];t=u.priority!==h.priority||!tB(u,h),++r,++c}}if(t){++this._updateTime;const r=c=>{const u=this._activeRegions;if(c>=u.length)return c;const h=u[c].priority;for(;c<u.length&&u[c].priority===h;)++c;return c};if(this._sourceIds.length>1){let c=0,u=r(c);for(;c!==u;){let h=c;const m=c;for(;h!==u;){const g=this._activeRegions[h];g.hiddenByOverlap=!1;for(let v=0;v<m;v++){const b=this._activeRegions[v];if(!b.hiddenByOverlap&&nB(g,b)&&(g.hiddenByOverlap=rB(g.footprint,g.tileId,b.footprint,b.tileId),g.hiddenByOverlap))break}++h}c=u,u=r(c)}}}}_setSources(t){[this._prevRegions,this._activeRegions]=[this._activeRegions,[]],this._sourceIds=[];for(let r=t.length-1;r>=0;r--)this._addSource(t[r]);this._computeReplacement()}}function M3(a,t){return a.x-t.x||a.y-t.y}function tB(a,t){return M3(a.min,t.min)===0&&M3(a.max,t.max)===0}function nB(a,t){return!(a.min.x>t.max.x||a.max.x<t.min.x||a.min.y>t.max.y||a.max.y<t.min.y)}function iB(a,t,r){const c=1/mt,u=1/(1<<r.canonical.z),h=(t.x*c+r.canonical.x)*u+r.wrap,m=(t.y*c+r.canonical.y)*u;return{min:new V((a.x*c+r.canonical.x)*u+r.wrap,(a.y*c+r.canonical.y)*u),max:new V(h,m)}}function Hne(a,t,r){const c=1<<r.canonical.z,u=((t.x-r.wrap)*c-r.canonical.x)*mt,h=(t.y*c-r.canonical.y)*mt;return{min:new V(((a.x-r.wrap)*c-r.canonical.x)*mt,(a.y*c-r.canonical.y)*mt),max:new V(u,h)}}function aB(a,t,r,c,u,h,m){const g=a.indices,v=a.vertices,b=[];for(let w=c;w<c+u;w+=3){const A=t[r[w+0]+h],C=t[r[w+1]+h],P=t[r[w+2]+h],k=Math.min(A.x,C.x,P.x),z=Math.max(A.x,C.x,P.x),U=Math.min(A.y,C.y,P.y),W=Math.max(A.y,C.y,P.y);b.length=0,a.grid.query(new V(k,U),new V(z,W),b);for(let $=0;$<b.length;$++){const Z=b[$];if(hP(v[g[3*Z+0]],v[g[3*Z+1]],v[g[3*Z+2]],A,C,P,m))return!0}}return!1}function rB(a,t,r,c){if(!a||!r)return!1;let u=a.vertices;if(!t.canonical.equals(c.canonical)||t.wrap!==c.wrap){if(r.vertices.length<a.vertices.length)return rB(r,c,a,t);const h=t.canonical,m=c.canonical,g=Math.pow(2,m.z-h.z);u=a.vertices.map(v=>new V(v.x*h.x*mt*g-m.x*mt,v.y*h.y*mt*g-m.y*mt))}return aB(r,u,a.indices,0,a.indices.length,0,0)}const jne=Z2.types,$ne=["fill-extrusion-base","fill-extrusion-height","fill-extrusion-color","fill-extrusion-pattern","fill-extrusion-flood-light-wall-radius"],Yne=["fill-extrusion-flood-light-ground-radius"],qne=Math.pow(2,13),Xne=Math.pow(2,15)-1,oB=new V(0,1),Zu=2147483648;function R1(a,t,r,c,u,h,m,g){a.emplaceBack((t<<1)+m,(r<<1)+h,(Math.floor(c*qne)<<1)+u,Math.round(g))}function T3(a,t,r,c,u,h){a.emplaceBack(t.x,t.y,(r.x<<1)+c,(r.y<<1)+u,h)}function k1(a,t,r){a.emplaceBack(t.x,t.y,t.z,r[0]*16384,r[1]*16384,r[2]*16384)}class sB{constructor(){this.vertexOffset=0,this.vertexCount=0,this.indexOffset=0,this.indexCount=0}}class lB{constructor(){this.centroidXY=new V(0,0),this.vertexArrayOffset=0,this.vertexCount=0,this.groundVertexArrayOffset=0,this.groundVertexCount=0,this.flags=0,this.footprintSegIdx=-1,this.footprintSegLen=0,this.min=new V(Number.MAX_VALUE,Number.MAX_VALUE),this.max=new V(-Number.MAX_VALUE,-Number.MAX_VALUE),this.height=0}span(){return new V(this.max.x-this.min.x,this.max.y-this.min.y)}}class cB{constructor(){this.acc=new V(0,0),this.accCount=0,this.centroidDataIndex=0}startRing(t,r){t.min.x===Number.MAX_VALUE&&(t.min.x=t.max.x=r.x,t.min.y=t.max.y=r.y)}appendEdge(t,r,c){this.accCount++,this.acc._add(r);let u=!!this.borders;r.x<t.min.x?(t.min.x=r.x,u=!0):r.x>t.max.x&&(t.max.x=r.x,u=!0),r.y<t.min.y?(t.min.y=r.y,u=!0):r.y>t.max.y&&(t.max.y=r.y,u=!0),((r.x===0||r.x===mt)&&r.x===c.x)!=((r.y===0||r.y===mt)&&r.y===c.y)&&this.processBorderOverlap(r,c),u&&this.checkBorderIntersection(r,c)}checkBorderIntersection(t,r){r.x<0!=t.x<0&&this.addBorderIntersection(0,Ln(r.y,t.y,(0-r.x)/(t.x-r.x))),r.x>mt!=t.x>mt&&this.addBorderIntersection(1,Ln(r.y,t.y,(mt-r.x)/(t.x-r.x))),r.y<0!=t.y<0&&this.addBorderIntersection(2,Ln(r.x,t.x,(0-r.y)/(t.y-r.y))),r.y>mt!=t.y>mt&&this.addBorderIntersection(3,Ln(r.x,t.x,(mt-r.y)/(t.y-r.y)))}addBorderIntersection(t,r){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const c=this.borders[t];r<c[0]&&(c[0]=r),r>c[1]&&(c[1]=r)}processBorderOverlap(t,r){if(t.x===r.x){if(t.y===r.y)return;const c=t.x===0?0:1;this.addBorderIntersection(c,r.y),this.addBorderIntersection(c,t.y)}else{const c=t.y===0?2:3;this.addBorderIntersection(c,r.x),this.addBorderIntersection(c,t.x)}}centroid(){return this.accCount===0?new V(0,0):new V(Math.floor(Math.max(0,this.acc.x)/this.accCount),Math.floor(Math.max(0,this.acc.y)/this.accCount))}intersectsCount(){return this.borders?this.borders.reduce((t,r)=>t+ +(r[0]!==Number.MAX_VALUE),0):0}}function uB(a,t){const r=a.add(t)._unit(),c=ae(a.x*r.x+a.y*r.y,-1,1);var u,h,m;return u=Math.acos(c),Math.min(4,Math.max(-4,Math.tan(u)))/4*Xne*((h=a).x*(m=t).y-h.y*m.x<0?-1:1)}const Zne=[a=>a.x<0,a=>a.x>mt,a=>a.y<0,a=>a.y>mt];function Kne(a,t,r,c){const u=[4];if(c===0)return u;r._mult(c);const h=a.sub(r),m=t.sub(r),g=[a,t,h,m];for(let v=0;v<4;v++)for(const b of g)if(Zne[v](b)){u.push(v);break}return u}class dB{constructor(t){this.vertexArray=new xt,this.indexArray=new Fn,this.programConfigurations=new yp(t.layers,t.zoom,r=>Yne.includes(r)),this._segments=new ji,this.hiddenByLandmarkVertexArray=new PC,this._segmentToGroundQuads={},this._segmentToGroundQuads[0]=[],this._segmentToRegionTriCounts={},this._segmentToRegionTriCounts[0]=[0,0,0,0,0],this.regionSegments={},this.regionSegments[4]=new ji}getDefaultSegment(){return this.regionSegments[4]}hasData(){return this.vertexArray.length!==0}addData(t,r,c){const u=t.length;if(u>2){let h=Math.max(0,this._segments.get().length-1);const m=this._segments._prepareSegment(4*u,this.vertexArray.length,2*this._segmentToGroundQuads[h].length);let g;h!==this._segments.get().length-1&&(h++,this._segmentToGroundQuads[h]=[],this._segmentToRegionTriCounts[h]=[0,0,0,0,0]);{const v=t[0],b=t[1];g=uB(v.sub(t[u-1])._perp()._unit(),b.sub(v)._perp()._unit())}for(let v=0;v<u;v++){const b=v===u-1?0:v+1,w=t[v],A=t[b],C=t[b===u-1?0:b+1],P=A.sub(w)._perp()._unit(),k=uB(P,C.sub(A)._perp()._unit()),z=g,U=k;if(XP(w,A,r)||fB(w,r)&&fB(A,r)){g=k;continue}const W=m.vertexLength;T3(this.vertexArray,w,A,1,1,z),T3(this.vertexArray,w,A,1,0,z),T3(this.vertexArray,w,A,0,1,U),T3(this.vertexArray,w,A,0,0,U),m.vertexLength+=4;const $=Kne(w,A,P,c);for(const Z of $)this._segmentToGroundQuads[h].push({id:W,region:Z}),this._segmentToRegionTriCounts[h][Z]+=2,m.primitiveLength+=2;g=k}}}prepareBorderSegments(){if(!this.hasData())return;const t=this._segments.get(),r=t.length;for(let c=0;c<r;c++)this._segmentToGroundQuads[c].sort((u,h)=>u.region-h.region);for(let c=0;c<r;c++){const u=this._segmentToGroundQuads[c],h=t[c],m=this._segmentToRegionTriCounts[c];m.reduce((v,b)=>v+b,0);let g=0;for(let v=0;v<=4;v++){const b=m[v];if(b!==0){let w=this.regionSegments[v];w||(w=this.regionSegments[v]=new ji);const A={vertexOffset:h.vertexOffset,primitiveOffset:h.primitiveOffset+g,vertexLength:h.vertexLength,primitiveLength:b};w.get().push(A)}g+=b}for(let v=0;v<u.length;v++){const b=u[v].id;this.indexArray.emplaceBack(b,b+1,b+3),this.indexArray.emplaceBack(b,b+3,b+2)}}this._segmentToGroundQuads=null,this._segmentToRegionTriCounts=null,this._segments.destroy(),this._segments=null}addPaintPropertiesData(t,r,c,u,h,m){this.hasData()&&this.programConfigurations.populatePaintArrays(this.vertexArray.length,t,r,c,u,h,m)}upload(t){this.hasData()&&(this.vertexBuffer=t.createVertexBuffer(this.vertexArray,Eee.members),this.indexBuffer=t.createIndexBuffer(this.indexArray))}uploadPaintProperties(t){this.hasData()&&this.programConfigurations.upload(t)}update(t,r,c,u,h,m){this.hasData()&&this.programConfigurations.updatePaintArrays(t,r,c,u,h,m)}updateHiddenByLandmark(t){if(!this.hasData())return;const r=t.groundVertexCount+t.groundVertexArrayOffset;if(t.groundVertexCount===0)return;const c=t.flags&Zu?1:0;for(let u=t.groundVertexArrayOffset;u<r;++u)this.hiddenByLandmarkVertexArray.emplace(u,c);this._needsHiddenByLandmarkUpdate=!0}uploadHiddenByLandmark(t){this.hasData()&&this._needsHiddenByLandmarkUpdate&&(!this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexArray.length>0?this.hiddenByLandmarkVertexBuffer=t.createVertexBuffer(this.hiddenByLandmarkVertexArray,Tee.members,!0):this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.updateData(this.hiddenByLandmarkVertexArray),this._needsHiddenByLandmarkUpdate=!1)}destroy(){if(this.vertexBuffer){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.destroy(),this._segments&&this._segments.destroy(),this.programConfigurations.destroy();for(let t=0;t<=4;t++){const r=this.regionSegments[t];r&&r.destroy()}}}}class D1{constructor(t){this.zoom=t.zoom,this.canonical=t.canonical,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(r=>r.fqid),this.index=t.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=t.projection,this.activeReplacements=[],this.replacementUpdateTime=0,this.centroidData=[],this.footprintIndices=new Fn,this.footprintVertices=new ee,this.footprintSegments=[],this.layoutVertexArray=new Ye,this.centroidVertexArray=new xO,this.indexArray=new Fn,this.programConfigurations=new yp(t.layers,t.zoom,r=>$ne.includes(r)),this.segments=new ji,this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id),this.groundEffect=new dB(t),this.maxHeight=0,this.partLookup={}}populate(t,r,c,u){this.features=[],this.hasPattern=_P("fill-extrusion",this.layers,r),this.featuresOnBorder=[],this.borderFeatureIndices=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=p1(c),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter;for(const{feature:h,id:m,index:g,sourceLayerIndex:v}of t){const b=this.layers[0]._featureFilter.needGeometry,w=Sp(h,b);if(!this.layers[0]._featureFilter.filter(new sa(this.zoom),w,c))continue;const A={id:m,sourceLayerIndex:v,index:g,geometry:b?w.geometry:$u(h,c,u),properties:h.properties,type:h.type,patterns:{}},C=this.layoutVertexArray.length;this.hasPattern?this.features.push(bP("fill-extrusion",this.layers,A,this.zoom,r)):this.addFeature(A,A.geometry,g,c,{},r.availableImages,u,r.brightness),r.featureIndex.insert(h,A.geometry,g,v,this.index,C)}this.sortBorders(),this.groundEffect.prepareBorderSegments()}addFeatures(t,r,c,u,h,m){for(const g of this.features){const{geometry:v}=g;this.addFeature(g,v,g.index,r,c,u,h,m)}this.sortBorders()}update(t,r,c,u,h){const m=Object.keys(t).length!==0;if(m&&!this.stateDependentLayers.length)return;const g=m?this.stateDependentLayers:this.layers;this.programConfigurations.updatePaintArrays(t,r,g,c,u,h),this.groundEffect.update(t,r,g,c,u,h)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload||this.groundEffect.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Pee),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=t.createVertexBuffer(this.layoutVertexExtArray,Cee.members,!0)),this.groundEffect.upload(t)),this.groundEffect.uploadPaintProperties(t),this.programConfigurations.upload(t),this.uploaded=!0}uploadCentroid(t){this.groundEffect.uploadHiddenByLandmark(t),this.needsCentroidUpdate&&(!this.centroidVertexBuffer&&this.centroidVertexArray.length>0?this.centroidVertexBuffer=t.createVertexBuffer(this.centroidVertexArray,Mee.members,!0):this.centroidVertexBuffer&&this.centroidVertexBuffer.updateData(this.centroidVertexArray),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.groundEffect.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(t,r,c,u,h,m,g,v){const b=this.layers[0].paint.get("fill-extrusion-flood-light-ground-radius").evaluate(t,{})/this.tileToMeter,w=[new V(0,0),new V(mt,mt)],A=g.projection,C=A.name==="globe",P=jne[t.type]==="Polygon",k=new cB;k.centroidDataIndex=this.centroidData.length;const z=new lB,U=this.layers[0].paint.get("fill-extrusion-base").evaluate(t,{},u)<=0,W=this.layers[0].paint.get("fill-extrusion-height").evaluate(t,{},u);z.height=W,z.vertexArrayOffset=this.layoutVertexArray.length,z.groundVertexArrayOffset=this.groundEffect.vertexArray.length,C&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new ti);const $=vP(r,500);for(let ce=$.length-1;ce>=0;ce--){const ge=$[ce];(ge.length===0||(Z=ge[0]).every(ve=>ve.x<=0)||Z.every(ve=>ve.x>=mt)||Z.every(ve=>ve.y<=0)||Z.every(ve=>ve.y>=mt))&&$.splice(ce,1)}var Z;let K;if(C)K=vB($,w,u);else{K=[];for(const ce of $)K.push({polygon:ce,bounds:w})}const q=P?this.edgeRadius:0,J=q>0&&this.zoom<17,re=(ce,ge)=>{if(ce.length===0)return!1;const ve=ce[ce.length-1];return ge.x===ve.x&&ge.y===ve.y};for(const{polygon:ce,bounds:ge}of K){let ve=0,Ce=0;for(const Se of ce)P&&!Se[0].equals(Se[Se.length-1])&&Se.push(Se[0]),Ce+=P?Se.length-1:Se.length;const Ae=this.segments.prepareSegment((P?5:4)*Ce,this.layoutVertexArray,this.indexArray);z.footprintSegIdx<0&&(z.footprintSegIdx=this.footprintSegments.length);const Le=new sB;if(Le.vertexOffset=this.footprintVertices.length,Le.indexOffset=3*this.footprintIndices.length,Le.ringIndices=[],P){const Se=[],Ve=[];ve=Ae.vertexLength;for(let nt=0;nt<ce.length;nt++){const We=ce[nt];We.length&&nt!==0&&Ve.push(Se.length/2);const Ge=[];let ot,yt;ot=We[1].sub(We[0])._perp()._unit(),Le.ringIndices.push(We.length-1);for(let pt=1;pt<We.length;pt++){const Rt=We[pt],Ft=We[pt===We.length-1?1:pt+1],St=Rt.clone();if(q){yt=Ft.sub(Rt)._perp()._unit();const Tt=ot.add(yt)._unit(),nn=q*Math.min(4,1/(ot.x*Tt.x+ot.y*Tt.y));St.x+=nn*Tt.x,St.y+=nn*Tt.y,St.x=Math.round(St.x),St.y=Math.round(St.y),ot=yt}!U||q!==0&&!J||re(Ge,St)||Ge.push(St),R1(this.layoutVertexArray,St.x,St.y,0,0,1,1,0),Ae.vertexLength++,this.footprintVertices.emplaceBack(Rt.x,Rt.y),Se.push(Rt.x,Rt.y),C&&k1(this.layoutVertexExtArray,A.projectTilePoint(St.x,St.y,u),A.upVector(u,St.x,St.y))}U&&(q===0||J)&&(Ge.length!==0&&re(Ge,Ge[0])&&Ge.pop(),this.groundEffect.addData(Ge,ge,b))}const Xe=Y2(Se,Ve);for(let nt=0;nt<Xe.length;nt+=3)this.footprintIndices.emplaceBack(Le.vertexOffset+Xe[nt+0],Le.vertexOffset+Xe[nt+1],Le.vertexOffset+Xe[nt+2]),this.indexArray.emplaceBack(ve+Xe[nt],ve+Xe[nt+2],ve+Xe[nt+1]),Ae.primitiveLength++;Le.indexCount+=Xe.length,Le.vertexCount+=this.footprintVertices.length-Le.vertexOffset}for(let Se=0;Se<ce.length;Se++){const Ve=ce[Se];k.startRing(z,Ve[0]);let Xe=Ve.length>4&&mB(Ve[Ve.length-2],Ve[0],Ve[1]),nt=q?Jne(Ve[Ve.length-2],Ve[0],Ve[1],q):0;const We=[];let Ge,ot,yt;ot=Ve[1].sub(Ve[0])._perp()._unit();let pt=!0;for(let Rt=1,Ft=0;Rt<Ve.length;Rt++){let St=Ve[Rt-1],Tt=Ve[Rt];const nn=Ve[Rt===Ve.length-1?1:Rt+1];if(k.appendEdge(z,Tt,St),XP(Tt,St,ge)){q&&(ot=nn.sub(Tt)._perp()._unit(),pt=!pt);continue}const sn=Tt.sub(St)._perp(),on=sn.x/(Math.abs(sn.x)+Math.abs(sn.y)),cn=sn.y>0?1:0,yn=St.dist(Tt);if(Ft+yn>32768&&(Ft=0),q){yt=nn.sub(Tt)._perp()._unit();let Yn=pB(St,Tt,nn,hB(ot,yt),q);isNaN(Yn)&&(Yn=0);const Wn=Tt.sub(St)._unit();St=St.add(Wn.mult(nt))._round(),Tt=Tt.add(Wn.mult(-Yn))._round(),nt=Yn,ot=yt,U&&this.zoom>=17&&(re(We,St)||We.push(St),re(We,Tt)||We.push(Tt))}const kn=Ae.vertexLength,ii=Ve.length>4&&mB(St,Tt,nn);let Ai=gB(Ft,Xe,pt);if(R1(this.layoutVertexArray,St.x,St.y,on,cn,0,0,Ai),R1(this.layoutVertexArray,St.x,St.y,on,cn,0,1,Ai),Ft+=yn,Ai=gB(Ft,ii,!pt),Xe=ii,R1(this.layoutVertexArray,Tt.x,Tt.y,on,cn,0,0,Ai),R1(this.layoutVertexArray,Tt.x,Tt.y,on,cn,0,1,Ai),Ae.vertexLength+=4,this.indexArray.emplaceBack(kn+0,kn+1,kn+2),this.indexArray.emplaceBack(kn+1,kn+3,kn+2),Ae.primitiveLength+=2,q){const Yn=ve+(Rt===1?Ve.length-2:Rt-2),Wn=Rt===1?ve:Yn+1;if(this.indexArray.emplaceBack(kn+1,Yn,kn+3),this.indexArray.emplaceBack(Yn,Wn,kn+3),Ae.primitiveLength+=2,Ge===void 0&&(Ge=kn),!XP(nn,Ve[Rt],ge)){const In=Rt===Ve.length-1?Ge:Ae.vertexLength;this.indexArray.emplaceBack(kn+2,kn+3,In),this.indexArray.emplaceBack(kn+3,In+1,In),this.indexArray.emplaceBack(kn+3,Wn,In+1),Ae.primitiveLength+=3}pt=!pt}if(C){const Yn=this.layoutVertexExtArray,Wn=A.projectTilePoint(St.x,St.y,u),In=A.projectTilePoint(Tt.x,Tt.y,u),Mn=A.upVector(u,St.x,St.y),mi=A.upVector(u,Tt.x,Tt.y);k1(Yn,Wn,Mn),k1(Yn,Wn,Mn),k1(Yn,In,mi),k1(Yn,In,mi)}}P&&(ve+=Ve.length-1),U&&q&&this.zoom>=17&&(We.length!==0&&re(We,We[0])&&We.pop(),this.groundEffect.addData(We,ge,b))}this.footprintSegments.push(Le),++z.footprintSegLen}if(z.vertexCount=this.layoutVertexArray.length-z.vertexArrayOffset,z.groundVertexCount=this.groundEffect.vertexArray.length-z.groundVertexArrayOffset,z.vertexCount!==0){if(z.centroidXY=k.borders?oB:this.encodeCentroid(k,z),this.centroidData.push(z),k.borders){this.featuresOnBorder.push(k);const ce=this.featuresOnBorder.length-1;for(let ge=0;ge<k.borders.length;ge++)k.borders[ge][0]!==Number.MAX_VALUE&&this.borderFeatureIndices[ge].push(ce)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,c,h,m,u,v),this.groundEffect.addPaintPropertiesData(t,c,h,m,u,v),this.maxHeight=Math.max(this.maxHeight,W)}}sortBorders(){for(let t=0;t<this.borderFeatureIndices.length;t++)this.borderFeatureIndices[t].sort((r,c)=>this.featuresOnBorder[r].borders[t][0]-this.featuresOnBorder[c].borders[t][0])}encodeCentroid(t,r){const c=t.centroid(),u=r.span(),h=Math.min(7,Math.round(u.x*this.tileToMeter/10)),m=Math.min(7,Math.round(u.y*this.tileToMeter/10));return new V(ae(c.x,1,mt-1)<<3|h,ae(c.y,1,mt-1)<<3|m)}showCentroid(t){const r=this.centroidData[t.centroidDataIndex];r.flags&=Zu,r.centroidXY.x=0,r.centroidXY.y=0,this.writeCentroidToBuffer(r)}writeCentroidToBuffer(t){this.groundEffect.updateHiddenByLandmark(t);const r=t.vertexArrayOffset,c=t.vertexCount+t.vertexArrayOffset,u=t.flags&Zu?oB:t.centroidXY,h=this.centroidVertexArray.geta_centroid_pos0(r);if(this.centroidVertexArray.geta_centroid_pos1(r)!==u.y||h!==u.x){for(let m=r;m<c;++m)this.centroidVertexArray.emplace(m,u.x,u.y);this.needsCentroidUpdate=!0}}createCentroidsBuffer(){this.centroidVertexArray.resize(this.layoutVertexArray.length),this.groundEffect.hiddenByLandmarkVertexArray.resize(this.groundEffect.vertexArray.length);for(const t of this.centroidData)this.writeCentroidToBuffer(t)}updateReplacement(t,r){if(r.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=r.updateTime;const c=r.getReplacementRegionsForTile(t.toUnwrapped());if(function(h,m){if(h.length!==m.length)return!1;for(let g=0;g<h.length;g++)if(h[g].sourceId!==m[g].sourceId||!tB(h[g],m[g]))return!1;return!0}(this.activeReplacements,c))return;if(this.activeReplacements=c,this.centroidVertexArray.length===0)this.createCentroidsBuffer();else for(const h of this.centroidData)h.flags&=2147483647;const u=[];for(const h of this.activeReplacements){const m=Math.pow(2,h.footprintTileId.canonical.z-t.canonical.z);for(const g of this.centroidData)if(!(g.flags&Zu||h.min.x>g.max.x||g.min.x>h.max.x||h.min.y>g.max.y||g.min.y>h.max.y))for(let v=0;v<g.footprintSegLen;v++){const b=this.footprintSegments[g.footprintSegIdx+v];if(u.length=0,Qne(this.footprintVertices,b.vertexOffset,b.vertexCount,h.footprintTileId.canonical,t.canonical,u),aB(h.footprint,u,this.footprintIndices.uint16,b.indexOffset,b.indexCount,-b.vertexOffset,-m)){g.flags|=Zu;break}}}for(const h of this.centroidData)this.writeCentroidToBuffer(h);this.borderDoneWithNeighborZ=[-1,-1,-1,-1]}footprintContainsPoint(t,r,c){let u=!1;for(let h=0;h<c.footprintSegLen;h++){const m=this.footprintSegments[c.footprintSegIdx+h];let g=0;for(const v of m.ringIndices){for(let b=g,w=v+g-1;b<v+g;w=b++){const A=this.footprintVertices.int16[2*(b+m.vertexOffset)+0],C=this.footprintVertices.int16[2*(b+m.vertexOffset)+1],P=this.footprintVertices.int16[2*(w+m.vertexOffset)+1];C>r!=P>r&&t<(this.footprintVertices.int16[2*(w+m.vertexOffset)+0]-A)*(r-C)/(P-C)+A&&(u=!u)}g=v}}return u}getHeightAtTileCoord(t,r){let c=Number.NEGATIVE_INFINITY,u=!0;const h=4*(t+mt)*mt+(r+mt);if(this.partLookup.hasOwnProperty(h)){const m=this.partLookup[h];return m?{height:m.height,hidden:!!(m.flags&Zu)}:void 0}for(const m of this.centroidData)t>m.max.x||m.min.x>t||r>m.max.y||m.min.y>r||this.footprintContainsPoint(t,r,m)&&m&&m.height>c&&(c=m.height,this.partLookup[h]=m,u=!!(m.flags&Zu));if(c!==Number.NEGATIVE_INFINITY)return{height:c,hidden:u};this.partLookup[h]=void 0}}function hB(a,t){const r=a.add(t)._unit();return a.x*r.x+a.y*r.y}function Jne(a,t,r,c){const u=t.sub(a)._perp()._unit(),h=r.sub(t)._perp()._unit();return pB(a,t,r,hB(u,h),c)}function pB(a,t,r,c,u){const h=Math.sqrt(1-c*c);return Math.min(a.dist(t)/3,t.dist(r)/3,u*h/c)}function XP(a,t,r){return a.x<r[0].x&&t.x<r[0].x||a.x>r[1].x&&t.x>r[1].x||a.y<r[0].y&&t.y<r[0].y||a.y>r[1].y&&t.y>r[1].y}function fB(a,t){return a.x<t[0].x||a.x>t[1].x||a.y<t[0].y||a.y>t[1].y}function mB(a,t,r){if(a.x<0||a.x>=mt||t.x<0||t.x>=mt||r.x<0||r.x>=mt)return!1;const c=r.sub(t),u=c.perp(),h=a.sub(t);return(c.x*h.x+c.y*h.y)/Math.sqrt((c.x*c.x+c.y*c.y)*(h.x*h.x+h.y*h.y))>-.866&&u.x*h.x+u.y*h.y<0}function gB(a,t,r){const c=t?2|a:-3&a;return r?1|c:-2&c}function yB(){const a=Math.PI/32,t=Math.tan(a),r=sv;return r*Math.sqrt(1+2*t*t)-r}function vB(a,t,r){const c=1<<r.z,u=sl(r.x/c),h=sl((r.x+1)/c),m=yr(r.y/c),g=yr((r.y+1)/c);return function(v,b,w,A,C=0,P){const k=[];if(!v.length||!w||!A)return k;const z=(J,re)=>{for(const ce of J)k.push({polygon:ce,bounds:re})},U=Math.ceil(Math.log2(w)),W=Math.ceil(Math.log2(A)),$=U-W,Z=[];for(let J=0;J<Math.abs($);J++)Z.push($>0?0:1);for(let J=0;J<Math.min(U,W);J++)Z.push(0),Z.push(1);let K=v;if(K=K2(K,b[0].y-C,b[1].y+C,1),K=K2(K,b[0].x-C,b[1].x+C,0),!K.length)return k;const q=[];for(Z.length?q.push({polygons:K,bounds:b,depth:0}):z(K,b);q.length;){const J=q.pop(),re=J.depth,ce=Z[re],ge=J.bounds[0],ve=J.bounds[1],Ce=ce===0?ge.x:ge.y,Ae=ce===0?ve.x:ve.y,Le=P?P(ce,Ce,Ae):.5*(Ce+Ae),Se=K2(J.polygons,Ce-C,Le+C,ce),Ve=K2(J.polygons,Le-C,Ae+C,ce);if(Se.length){const Xe=[ge,new V(ce===0?Le:ve.x,ce===1?Le:ve.y)];Z.length>re+1?q.push({polygons:Se,bounds:Xe,depth:re+1}):z(Se,Xe)}if(Ve.length){const Xe=[new V(ce===0?Le:ge.x,ce===1?Le:ge.y),ve];Z.length>re+1?q.push({polygons:Ve,bounds:Xe,depth:re+1}):z(Ve,Xe)}}return k}(a,t,Math.ceil((h-u)/11.25),Math.ceil((m-g)/11.25),1,(v,b,w)=>{if(v===0)return .5*(b+w);{const A=yr((r.y+b/mt)/c);return(Co(.5*(yr((r.y+w/mt)/c)+A))*c-r.y)*mt}})}function Qne(a,t,r,c,u,h){const m=Math.pow(2,c.z-u.z);for(let g=0;g<r;g++){let v=a.int16[2*(g+t)+0],b=a.int16[2*(g+t)+1];v=(v+u.x*mt)*m-c.x*mt,b=(b+u.y*mt)*m-c.y*mt,h.push(new V(v,b))}}un(D1,"FillExtrusionBucket",{omit:["layers","features"]}),un(lB,"PartData"),un(sB,"FootprintSegment"),un(cB,"BorderCentroidData"),un(dB,"GroundEffect");const eie=new xa({visibility:new Zt(at["layout_fill-extrusion"].visibility),"fill-extrusion-edge-radius":new Zt(at["layout_fill-extrusion"]["fill-extrusion-edge-radius"])});var tie={paint:new xa({"fill-extrusion-opacity":new Zt(at["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new _n(at["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Zt(at["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Zt(at["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new _n(at["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new _n(at["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new _n(at["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Zt(at["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new Zt(at["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new Zt(at["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-ambient-occlusion-wall-radius":new Zt(at["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-wall-radius"]),"fill-extrusion-ambient-occlusion-ground-radius":new Zt(at["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-radius"]),"fill-extrusion-ambient-occlusion-ground-attenuation":new Zt(at["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-attenuation"]),"fill-extrusion-flood-light-color":new Zt(at["paint_fill-extrusion"]["fill-extrusion-flood-light-color"]),"fill-extrusion-flood-light-intensity":new Zt(at["paint_fill-extrusion"]["fill-extrusion-flood-light-intensity"]),"fill-extrusion-flood-light-wall-radius":new _n(at["paint_fill-extrusion"]["fill-extrusion-flood-light-wall-radius"]),"fill-extrusion-flood-light-ground-radius":new _n(at["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-radius"]),"fill-extrusion-flood-light-ground-attenuation":new Zt(at["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-attenuation"]),"fill-extrusion-vertical-scale":new Zt(at["paint_fill-extrusion"]["fill-extrusion-vertical-scale"]),"fill-extrusion-rounded-roof":new Zt(at["paint_fill-extrusion"]["fill-extrusion-rounded-roof"]),"fill-extrusion-cutoff-fade-range":new Zt(at["paint_fill-extrusion"]["fill-extrusion-cutoff-fade-range"])}),layout:eie};class Sv extends V{constructor(t,r,c){super(t,r),this.z=c}}function O1(a,t){return a.x*t.x+a.y*t.y}function _B(a,t){if(a.length===1){let r=0;const c=t[r++];let u;for(;!u||c.equals(u);)if(u=t[r++],!u)return 1/0;for(;r<t.length;r++){const h=t[r],m=a[0],g=u.sub(c),v=h.sub(c),b=m.sub(c),w=O1(g,g),A=O1(g,v),C=O1(v,v),P=O1(b,g),k=O1(b,v),z=w*C-A*A,U=(C*P-A*k)/z,W=(w*k-A*P)/z,$=c.z*(1-U-W)+u.z*U+h.z*W;if(isFinite($))return $}return 1/0}{let r=1/0;for(const c of t)r=Math.min(r,c.z);return r}}function bB(a,t,r,c,u,h,m,g){const v=m*u.getElevationAt(a,t,!0,!0),b=h[0]!==0,w=b?h[1]===0?m*(h[0]/7-450):m*function(A,C,P){const k=Math.floor(C[0]/8),z=Math.floor(C[1]/8),U=10*(C[0]-8*k),W=10*(C[1]-8*z),$=A.getElevationAt(k,z,!0,!0),Z=A.getMeterToDEM(P),K=Math.floor(.5*(U*Z-1)),q=Math.floor(.5*(W*Z-1)),J=A.tileCoordToPixel(k,z),re=2*K+1,ce=2*q+1,ge=function(Ve,Xe,nt,We,Ge){return[Ve.getElevationAtPixel(Xe,nt,!0),Ve.getElevationAtPixel(Xe+Ge,nt,!0),Ve.getElevationAtPixel(Xe,nt+Ge,!0),Ve.getElevationAtPixel(Xe+We,nt+Ge,!0)]}(A,J.x-K,J.y-q,re,ce),ve=Math.abs(ge[0]-ge[1]),Ce=Math.abs(ge[2]-ge[3]),Ae=Math.abs(ge[0]-ge[2])+Math.abs(ge[1]-ge[3]),Le=Math.min(.25,.5*Z*(ve+Ce)/re),Se=Math.min(.25,.5*Z*Ae/ce);return $+Math.max(Le*U,Se*W)}(u,h,g):v;return{base:v+(r===0)?-1:r,top:b?Math.max(w+c,v+r+2):v+c}}const nie=new xa({"line-cap":new _n(at.layout_line["line-cap"]),"line-join":new _n(at.layout_line["line-join"]),"line-miter-limit":new Zt(at.layout_line["line-miter-limit"]),"line-round-limit":new Zt(at.layout_line["line-round-limit"]),"line-sort-key":new _n(at.layout_line["line-sort-key"]),visibility:new Zt(at.layout_line.visibility)});var xB={paint:new xa({"line-opacity":new _n(at.paint_line["line-opacity"]),"line-color":new _n(at.paint_line["line-color"]),"line-translate":new Zt(at.paint_line["line-translate"]),"line-translate-anchor":new Zt(at.paint_line["line-translate-anchor"]),"line-width":new _n(at.paint_line["line-width"]),"line-gap-width":new _n(at.paint_line["line-gap-width"]),"line-offset":new _n(at.paint_line["line-offset"]),"line-blur":new _n(at.paint_line["line-blur"]),"line-dasharray":new _n(at.paint_line["line-dasharray"]),"line-pattern":new _n(at.paint_line["line-pattern"]),"line-gradient":new _m(at.paint_line["line-gradient"]),"line-trim-offset":new Zt(at.paint_line["line-trim-offset"]),"line-emissive-strength":new Zt(at.paint_line["line-emissive-strength"]),"line-border-width":new _n(at.paint_line["line-border-width"]),"line-border-color":new _n(at.paint_line["line-border-color"])}),layout:nie};const iie=(a,t,r,c,u,h,m)=>{const g=a.transform,v=g.calculatePixelsToTileUnitsMatrix(t);return{u_matrix:SB(a,t,r,c),u_pixels_to_tile_units:v,u_device_pixel_ratio:h,u_units_to_pixels:[1/g.pixelsToGLUnits[0],1/g.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:u,u_texsize:EB(r)?t.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:wB(t,a.transform),u_alpha_discard_threshold:0,u_trim_offset:m,u_emissive_strength:r.paint.get("line-emissive-strength")}},aie=(a,t,r,c,u)=>{const h=a.transform;return{u_matrix:SB(a,t,r,c),u_texsize:t.imageAtlasTexture.size,u_pixels_to_tile_units:h.calculatePixelsToTileUnitsMatrix(t),u_device_pixel_ratio:u,u_image:0,u_tile_units_to_pixels:wB(t,h),u_units_to_pixels:[1/h.pixelsToGLUnits[0],1/h.pixelsToGLUnits[1]],u_alpha_discard_threshold:0}};function wB(a,t){return 1/Tm(a,1,t.tileZoom)}function SB(a,t,r,c){return a.translatePosMatrix(c||t.tileID.projMatrix,t,r.paint.get("line-translate"),r.paint.get("line-translate-anchor"))}const AB=a=>{const t=[];EB(a)&&t.push("RENDER_LINE_DASH"),a.paint.get("line-gradient")&&t.push("RENDER_LINE_GRADIENT");const r=a.paint.get("line-trim-offset");return r[0]===0&&r[1]===0||t.push("RENDER_LINE_TRIM_OFFSET"),a.paint.get("line-border-width").constantOr(1)!==0&&t.push("RENDER_LINE_BORDER"),t};function EB(a){const t=a.paint.get("line-dasharray").value;return t.value||t.kind!=="constant"}const MB=new class extends _n{possiblyEvaluate(a,t){return t=new sa(Math.floor(t.zoom),{now:t.now,fadeDuration:t.fadeDuration,transition:t.transition}),super.possiblyEvaluate(a,t)}evaluate(a,t,r,c){return t=Fe({},t,{zoom:Math.floor(t.zoom)}),super.evaluate(a,t,r,c)}}(xB.paint.properties["line-width"].specification);function TB(a,t){return t>0?t+2*a:a}MB.useIntegerZoom=!0;const rie=new xa({visibility:new Zt(at.layout_background.visibility)});var oie={paint:new xa({"background-color":new Zt(at.paint_background["background-color"]),"background-pattern":new Zt(at.paint_background["background-pattern"]),"background-opacity":new Zt(at.paint_background["background-opacity"]),"background-emissive-strength":new Zt(at.paint_background["background-emissive-strength"])}),layout:rie};const sie=new xa({visibility:new Zt(at.layout_raster.visibility)});var lie={paint:new xa({"raster-opacity":new Zt(at.paint_raster["raster-opacity"]),"raster-color":new _m(at.paint_raster["raster-color"]),"raster-color-mix":new Zt(at.paint_raster["raster-color-mix"]),"raster-color-range":new Zt(at.paint_raster["raster-color-range"]),"raster-hue-rotate":new Zt(at.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Zt(at.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Zt(at.paint_raster["raster-brightness-max"]),"raster-saturation":new Zt(at.paint_raster["raster-saturation"]),"raster-contrast":new Zt(at.paint_raster["raster-contrast"]),"raster-resampling":new Zt(at.paint_raster["raster-resampling"]),"raster-fade-duration":new Zt(at.paint_raster["raster-fade-duration"])}),layout:sie};function CB(a,t,r,c,u,h,m,g){const v=[a,r,u,t,c,h,1,1,1],b=[m,g,1],w=Ns.adjoint([],v),[A,C,P]=ke.transformMat3(b,b,Ns.transpose(w,w));return Ns.multiply(v,[A,0,0,0,C,0,0,0,P],v)}class Ku extends Un{constructor(t,r,c,u){super(),this.id=t,this.dispatcher=c,this.coordinates=r.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.onNorthPole=!1,this.onSouthPole=!1,this.setEventedParent(u),this.options=r,this._dirty=!1}load(t,r){if(this._loaded=r||!1,this.fire(new $t("dataloading",{dataType:"source"})),this.url=this.options.url,!this.url)return t&&(this.coordinates=t),this._loaded=!0,void this._finishLoading();this._imageRequest=Qt(this.map._requestManager.transformRequest(this.url,we.Image),(c,u)=>{if(this._imageRequest=null,this._loaded=!0,c)this.fire(new bn(c));else if(u){const{HTMLImageElement:h}=f;this.image=u instanceof h?Cn.getImageData(u):u,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,t&&(this.coordinates=t),this._finishLoading()}})}loaded(){return this._loaded}updateImage(t){return this.image&&t.url?(this._imageRequest&&t.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=t.url,this.load(t.coordinates,this._loaded),this):this}setTexture(t){if(!(t.handle instanceof WebGLTexture))throw new Error("The provided handle is not a WebGLTexture instance");return this.texture=new y3(this.map.painter.context,t.handle),this.width=t.dimensions[0],this.height=t.dimensions[1],this._dirty=!1,this._loaded=!0,this._finishLoading(),this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new $t("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(t){this.map=t,this.load()}onRemove(){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),!this.texture||this.texture instanceof y3||this.texture.destroy()}setCoordinates(t){if(this.coordinates=t,this._boundsArray=void 0,!t.length)return this;this.onNorthPole=!1,this.onSouthPole=!1;let r=t[0][1],c=t[0][1];for(const h of t)h[1]>c&&(c=h[1]),h[1]<r&&(r=h[1]);const u=(c+r)/2;if(u>qa?this.onNorthPole=!0:u<-qa&&(this.onSouthPole=!0),!this.onNorthPole&&!this.onSouthPole){const h=t.map(vi.fromLngLat);this.tileID=function(m){let g=1/0,v=1/0,b=-1/0,w=-1/0;for(const k of m)g=Math.min(g,k.x),v=Math.min(v,k.y),b=Math.max(b,k.x),w=Math.max(w,k.y);const A=Math.max(b-g,w-v),C=Math.max(0,Math.floor(-Math.log(A)/Math.LN2)),P=Math.pow(2,C);return new ju(C,Math.floor((g+b)/2*P),Math.floor((v+w)/2*P))}(h),this.minzoom=this.maxzoom=this.tileID.z}return this.fire(new $t("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0}_prepareData(t){for(const v in this.tiles){const b=this.tiles[v];b.state!=="loaded"&&(b.state="loaded",b.texture=this.texture)}if(this._boundsArray)return;const r=Mm(this.tileID,this.map.transform.projection),[c,u,h,m]=this.coordinates.map(v=>{const b=r.projection.project(v[0],v[1]);return gF(r,b)._round()});this.perspectiveTransform=function(v,b,w,A,C,P,k,z,U,W){const $=CB(0,0,v,0,0,b,v,b),Z=CB(w,A,C,P,k,z,U,W);return Ns.multiply(Z,Ns.adjoint($,$),Z),[Z[6]/Z[8]*v/mt,Z[7]/Z[8]*b/mt]}(this.width,this.height,c.x,c.y,u.x,u.y,m.x,m.y,h.x,h.y);const g=this._boundsArray=new Ye;g.emplaceBack(c.x,c.y,0,0),g.emplaceBack(u.x,u.y,mt,0),g.emplaceBack(m.x,m.y,0,mt),g.emplaceBack(h.x,h.y,mt,mt),this.boundsBuffer&&this.boundsBuffer.destroy(),this.boundsBuffer=t.createVertexBuffer(g,FP.members),this.boundsSegments=ji.simpleSegment(0,0,4,2)}prepare(){const t=Object.keys(this.tiles).length!==0;if(this.tileID&&!t)return;const r=this.map.painter.context,c=r.gl;!this._dirty||this.texture instanceof y3||(this.texture?this.texture.update(this.image):(this.texture=new vr(r,this.image,c.RGBA),this.texture.bind(c.LINEAR,c.CLAMP_TO_EDGE)),this._dirty=!1),t&&this._prepareData(r)}loadTile(t,r){this.tileID&&this.tileID.equals(t.tileID.canonical)?(this.tiles[String(t.tileID.wrap)]=t,t.buckets={},r(null)):(t.state="errored",r(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}class cie extends qo{constructor(t){super(t,{}),this.implementation=t,t.slot&&(this.slot=t.slot)}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}isLayerDraped(t){return this.implementation.renderToTile!==void 0}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(t){this.implementation.onAdd&&this.implementation.onAdd(t,t.painter.context.gl)}onRemove(t){this.implementation.onRemove&&this.implementation.onRemove(t,t.painter.context.gl)}}const uie=new xa({visibility:new Zt(at.layout_sky.visibility)});var die={paint:new xa({"sky-type":new Zt(at.paint_sky["sky-type"]),"sky-atmosphere-sun":new Zt(at.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new Zt(at.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new Zt(at.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new Zt(at.paint_sky["sky-gradient-radius"]),"sky-gradient":new _m(at.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new Zt(at.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new Zt(at.paint_sky["sky-atmosphere-color"]),"sky-opacity":new Zt(at.paint_sky["sky-opacity"])}),layout:uie};function ZP(a,t,r){const c=[0,0,1],u=To.identity([]);return To.rotateY(u,u,r?-ye(a)+Math.PI:ye(a)),To.rotateX(u,u,-ye(t)),ke.transformQuat(c,c,u),ke.normalize(c,c)}var hie={paint:new xa({})};const pie={circle:class extends qo{constructor(a,t){super(a,eee,t)}createBucket(a){return new cP(a)}queryRadius(a){const t=a;return cv("circle-radius",this,t)+cv("circle-stroke-width",this,t)+W2(this.paint.get("circle-translate"))}queryIntersectsFeature(a,t,r,c,u,h,m,g){const v=mz(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),h.angle,a.pixelToTileUnitsFactor),b=this.paint.get("circle-radius").evaluate(t,r)+this.paint.get("circle-stroke-width").evaluate(t,r);return yz(a,c,h,m,g,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",v,b)}getProgramIds(){return["circle"]}getDefaultProgramParams(a,t){const r=gz(this);return{config:new bm(this,t),defines:r,overrideFog:!1}}},heatmap:class extends qo{createBucket(a){return new _z(a)}constructor(a,t){super(a,see,t),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(a){a==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=V2({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(a){return cv("heatmap-radius",this,a)}queryIntersectsFeature(a,t,r,c,u,h,m,g){const v=this.paint.get("heatmap-radius").evaluate(t,r);return yz(a,c,h,m,g,!0,!0,new V(0,0),v)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getDefaultProgramParams(a,t){return a==="heatmap"?{config:new bm(this,t),overrideFog:!1}:{}}},hillshade:class extends qo{constructor(a,t){super(a,cee,t)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}getDefaultProgramParams(a,t){return{overrideFog:!1}}},fill:class extends qo{constructor(a,t){super(a,See,t)}getProgramIds(){const a=this.paint.get("fill-pattern"),t=a&&a.constantOr(1),r=[t?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&r.push(t&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),r}getDefaultProgramParams(a,t){return{config:new bm(this,t),overrideFog:!1}}recalculate(a,t){super.recalculate(a,t);const r=this.paint._values["fill-outline-color"];r.value.kind==="constant"&&r.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(a){return new q2(a)}queryRadius(){return W2(this.paint.get("fill-translate"))}queryIntersectsFeature(a,t,r,c,u,h){return!a.queryGeometry.isAboveHorizon&&uz(fz(a.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),h.angle,a.pixelToTileUnitsFactor),c)}isTileClipped(){return!0}},"fill-extrusion":class extends qo{constructor(a,t){super(a,tie,t)}createBucket(a){return new D1(a)}queryRadius(){return W2(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}hasShadowPass(){return!0}cutoffRange(){return this.paint.get("fill-extrusion-cutoff-fade-range")}canCastShadows(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}queryIntersectsFeature(a,t,r,c,u,h,m,g,v){const b=mz(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),h.angle,a.pixelToTileUnitsFactor),w=this.paint.get("fill-extrusion-height").evaluate(t,r),A=this.paint.get("fill-extrusion-base").evaluate(t,r),C=[0,0],P=g&&h.elevation,k=h.elevation?h.elevation.exaggeration():1,z=a.tile.getBucket(this);if(P&&z instanceof D1){const K=z.centroidVertexArray,q=v+1;q<K.length&&(C[0]=K.geta_centroid_pos0(q),C[1]=K.geta_centroid_pos1(q))}if(C[0]===0&&C[1]===1)return!1;h.projection.name==="globe"&&(c=vB([c],[new V(0,0),new V(mt,mt)],a.tileID.canonical).map(K=>K.polygon).flat());const U=P?g:null,[W,$]=function(K,q,J,re,ce,ge,ve,Ce,Ae,Le,Se){return K.projection.name==="globe"?function(Ve,Xe,nt,We,Ge,ot,yt,pt,Rt,Ft,St){const Tt=[],nn=[],sn=Ve.projection.upVectorScale(St,Ve.center.lat,Ve.worldSize).metersToTile,on=[0,0,0,1],cn=[0,0,0,1],yn=(ii,Ai,Yn,Wn)=>{ii[0]=Ai,ii[1]=Yn,ii[2]=Wn,ii[3]=1},kn=yB();nt>0&&(nt+=kn),We+=kn;for(const ii of Xe){const Ai=[],Yn=[];for(const Wn of ii){const In=Wn.x+Ge.x,Mn=Wn.y+Ge.y,mi=Ve.projection.projectTilePoint(In,Mn,St),Pi=Ve.projection.upVector(St,Wn.x,Wn.y);let ni=nt,qi=We;if(yt){const Ea=bB(In,Mn,nt,We,yt,pt,Rt,Ft);ni+=Ea.base,qi+=Ea.top}nt!==0?yn(on,mi.x+Pi[0]*sn*ni,mi.y+Pi[1]*sn*ni,mi.z+Pi[2]*sn*ni):yn(on,mi.x,mi.y,mi.z),yn(cn,mi.x+Pi[0]*sn*qi,mi.y+Pi[1]*sn*qi,mi.z+Pi[2]*sn*qi),ke.transformMat4(on,on,ot),ke.transformMat4(cn,cn,ot),Ai.push(new Sv(on[0],on[1],on[2])),Yn.push(new Sv(cn[0],cn[1],cn[2]))}Tt.push(Ai),nn.push(Yn)}return[Tt,nn]}(K,q,J,re,ce,ge,ve,Ce,Ae,Le,Se):ve?function(Ve,Xe,nt,We,Ge,ot,yt,pt,Rt){const Ft=[],St=[],Tt=[0,0,0,1];for(const nn of Ve){const sn=[],on=[];for(const cn of nn){const yn=cn.x+We.x,kn=cn.y+We.y,ii=bB(yn,kn,Xe,nt,ot,yt,pt,Rt);Tt[0]=yn,Tt[1]=kn,Tt[2]=ii.base,Tt[3]=1,Hi.transformMat4(Tt,Tt,Ge),Tt[3]=Math.max(Tt[3],1e-5);const Ai=new Sv(Tt[0]/Tt[3],Tt[1]/Tt[3],Tt[2]/Tt[3]);Tt[0]=yn,Tt[1]=kn,Tt[2]=ii.top,Tt[3]=1,Hi.transformMat4(Tt,Tt,Ge),Tt[3]=Math.max(Tt[3],1e-5);const Yn=new Sv(Tt[0]/Tt[3],Tt[1]/Tt[3],Tt[2]/Tt[3]);sn.push(Ai),on.push(Yn)}Ft.push(sn),St.push(on)}return[Ft,St]}(q,J,re,ce,ge,ve,Ce,Ae,Le):function(Ve,Xe,nt,We,Ge){const ot=[],yt=[],pt=Ge[8]*Xe,Rt=Ge[9]*Xe,Ft=Ge[10]*Xe,St=Ge[11]*Xe,Tt=Ge[8]*nt,nn=Ge[9]*nt,sn=Ge[10]*nt,on=Ge[11]*nt;for(const cn of Ve){const yn=[],kn=[];for(const ii of cn){const Ai=ii.x+We.x,Yn=ii.y+We.y,Wn=Ge[0]*Ai+Ge[4]*Yn+Ge[12],In=Ge[1]*Ai+Ge[5]*Yn+Ge[13],Mn=Ge[2]*Ai+Ge[6]*Yn+Ge[14],mi=Ge[3]*Ai+Ge[7]*Yn+Ge[15],Pi=Wn+pt,ni=In+Rt,qi=Mn+Ft,Ea=Math.max(mi+St,1e-5),la=Wn+Tt,ta=In+nn,or=Mn+sn,Ma=Math.max(mi+on,1e-5);yn.push(new Sv(Pi/Ea,ni/Ea,qi/Ea)),kn.push(new Sv(la/Ma,ta/Ma,or/Ma))}ot.push(yn),yt.push(kn)}return[ot,yt]}(q,J,re,ce,ge)}(h,c,A,w,b,m,U,C,k,h.center.lat,a.tileID.canonical),Z=a.queryGeometry;return function(K,q,J){let re=1/0;uz(J,q)&&(re=_B(J,q[0]));for(let ce=0;ce<q.length;ce++){const ge=q[ce],ve=K[ce];for(let Ce=0;Ce<ge.length-1;Ce++){const Ae=ge[Ce],Le=[Ae,ge[Ce+1],ve[Ce+1],ve[Ce],Ae];cz(J,Le)&&(re=Math.min(re,_B(J,Le)))}}return re!==1/0&&re}(W,$,Z.isPointQuery()?Z.screenBounds:Z.screenGeometry)}},line:class extends qo{constructor(a,t){super(a,xB,t),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(a){if(a==="line-gradient"){const t=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=t._styleExpression&&t._styleExpression.expression instanceof op,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(a,t){super.recalculate(a,t),this.paint._values["line-floorwidth"]=MB.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,a)}createBucket(a){return new g3(a)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getDefaultProgramParams(a,t){const r=AB(this);return{config:new bm(this,t),defines:r,overrideFog:!1}}queryRadius(a){const t=a,r=TB(cv("line-width",this,t),cv("line-gap-width",this,t)),c=cv("line-offset",this,t);return r/2+Math.abs(c)+W2(this.paint.get("line-translate"))}queryIntersectsFeature(a,t,r,c,u,h){if(a.queryGeometry.isAboveHorizon)return!1;const m=fz(a.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),h.angle,a.pixelToTileUnitsFactor),g=a.pixelToTileUnitsFactor/2*TB(this.paint.get("line-width").evaluate(t,r),this.paint.get("line-gap-width").evaluate(t,r)),v=this.paint.get("line-offset").evaluate(t,r);return v&&(c=function(b,w){const A=[],C=new V(0,0);for(let P=0;P<b.length;P++){const k=b[P],z=[];for(let U=0;U<k.length;U++){const W=k[U],$=k[U+1],Z=U===0?C:W.sub(k[U-1])._unit()._perp(),K=U===k.length-1?C:$.sub(W)._unit()._perp(),q=Z._add(K)._unit();q._mult(1/(q.x*K.x+q.y*K.y)),z.push(q._mult(w)._add(W))}A.push(z)}return A}(c,v*a.pixelToTileUnitsFactor)),function(b,w,A){for(let C=0;C<w.length;C++){const P=w[C];if(b.length>=3){for(let k=0;k<P.length;k++)if(Ap(b,P[k]))return!0}if(ZQ(b,P,A))return!0}return!1}(m,c,g)}isTileClipped(){return!0}},symbol:u3,background:class extends qo{constructor(a,t){super(a,oie,t)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}getDefaultProgramParams(a,t){return{overrideFog:!1}}},raster:class extends qo{constructor(a,t){super(a,lie,t),this._updateColorRamp()}getProgramIds(){return["raster"]}hasColorMap(){return!!this._transitionablePaint._values["raster-color"].value.value}isLayerDraped(a){return!(a&&a._source instanceof Ku&&(a._source.onNorthPole||a._source.onSouthPole))}_handleSpecialPaintPropertyUpdate(a){a!=="raster-color"&&a!=="raster-color-range"||this._updateColorRamp()}_updateColorRamp(){if(!this.hasColorMap())return;const a=this._transitionablePaint._values["raster-color"].value.expression,[t,r]=this._transitionablePaint._values["raster-color-range"].value.expression.evaluate({zoom:0});this.colorRamp=V2({expression:a,evaluationKey:"rasterValue",image:this.colorRamp,clips:[{start:t,end:r}],resolution:256}),this.colorRampTexture=null}},sky:class extends qo{constructor(a,t){super(a,die,t),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(a){a==="sky-gradient"?this._updateColorRamp():a!=="sky-atmosphere-sun"&&a!=="sky-atmosphere-halo-color"&&a!=="sky-atmosphere-color"&&a!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=V2({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(a){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const t=a.style.light.properties.get("position");return this._lightPosition.azimuthal!==t.azimuthal||this._lightPosition.polar!==t.polar}return!1}getCenter(a,t){if(this.paint.get("sky-type")==="atmosphere"){const c=this.paint.get("sky-atmosphere-sun"),u=!c,h=a.style.light,m=h.properties.get("position");return u&&h.properties.get("anchor")==="viewport"&&_e("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),u?ZP(m.azimuthal,90-m.polar,t):ZP(c[0],90-c[1],t)}const r=this.paint.get("sky-gradient-center");return ZP(r[0],90-r[1],t)}isSky(){return!0}markSkyboxValid(a){this._skyboxInvalidated=!1,this._lightPosition=a.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const a=this.paint.get("sky-type");return a==="atmosphere"?["skyboxCapture","skybox"]:a==="gradient"?["skyboxGradient"]:null}},slot:class extends qo{constructor(a,t){super(a,hie)}},model:class extends qo{constructor(a,t){super(a,Une,t)}createBucket(a){return new ZF(a)}getProgramIds(){return["model"]}is3D(){return!0}hasShadowPass(){return!0}canCastShadows(){return!0}hasLightBeamPass(){return!0}cutoffRange(){return this.paint.get("model-cutoff-fade-range")}queryRadius(){return 0}_handleOverridablePaintPropertyUpdate(a,t,r){return!(!this.layout||t.isDataDriven()||r.isDataDriven()||a!=="model-color"&&a!=="model-color-mix-intensity"&&a!=="model-rotation"&&a!=="model-scale"&&a!=="model-translation"&&a!=="model-emissive-strength")}_isPropertyZoomDependent(a){const t=this._transitionablePaint._values[a];return t!=null&&t.value!=null&&t.value.expression!=null&&t.value.expression instanceof Bc}isZoomDependent(){return this._isPropertyZoomDependent("model-scale")||this._isPropertyZoomDependent("model-rotation")||this._isPropertyZoomDependent("model-translation")}}};function C3(a,t){return a.type==="custom"?new cie(a):new pie[a.type](a,t)}function fie(a){const{userImage:t}=a;return!!(t&&t.render&&t.render())&&(a.data.replace(new Uint8Array(t.data.buffer)),!0)}class mie extends Un{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded={},this.requestors=[],this.patterns={},this.atlasImage={},this.atlasTexture={},this.dirty=!0}createScope(t){this.images[t]={},this.loaded[t]=!1,this.updatedImages[t]={},this.patterns[t]={},this.callbackDispatchedThisFrame[t]={},this.atlasImage[t]=new Xa({width:1,height:1})}isLoaded(){for(const t in this.loaded)if(!this.loaded[t])return!1;return!0}setLoaded(t,r){if(this.loaded[r]!==t&&(this.loaded[r]=t,t)){for(const{ids:c,callback:u}of this.requestors)this._notify(c,r,u);this.requestors=[]}}hasImage(t,r){return!!this.getImage(t,r)}getImage(t,r){return this.images[r][t]}addImage(t,r,c){this._validate(t,c)&&(this.images[r][t]=c)}_validate(t,r){let c=!0;return this._validateStretch(r.stretchX,r.data&&r.data.width)||(this.fire(new bn(new Error(`Image "${t}" has invalid "stretchX" value`))),c=!1),this._validateStretch(r.stretchY,r.data&&r.data.height)||(this.fire(new bn(new Error(`Image "${t}" has invalid "stretchY" value`))),c=!1),this._validateContent(r.content,r)||(this.fire(new bn(new Error(`Image "${t}" has invalid "content" value`))),c=!1),c}_validateStretch(t,r){if(!t)return!0;let c=0;for(const u of t){if(u[0]<c||u[1]<u[0]||r<u[1])return!1;c=u[1]}return!0}_validateContent(t,r){return!(t&&(t.length!==4||t[0]<0||r.data.width<t[0]||t[1]<0||r.data.height<t[1]||t[2]<0||r.data.width<t[2]||t[3]<0||r.data.height<t[3]||t[2]<t[0]||t[3]<t[1]))}updateImage(t,r,c){c.version=this.images[r][t].version+1,this.images[r][t]=c,this.updatedImages[r][t]=!0}removeImage(t,r){const c=this.images[r][t];delete this.images[r][t],delete this.patterns[r][t],c.userImage&&c.userImage.onRemove&&c.userImage.onRemove()}listImages(t){return Object.keys(this.images[t])}getImages(t,r,c){let u=!0;const h=!!this.loaded[r];if(!h)for(const m of t)this.images[r][m]||(u=!1);h||u?this._notify(t,r,c):this.requestors.push({ids:t,scope:r,callback:c})}getUpdatedImages(t){return this.updatedImages[t]}_notify(t,r,c){const u={};for(const h of t){this.images[r][h]||this.fire(new $t("styleimagemissing",{id:h}));const m=this.images[r][h];m?u[h]={data:m.data.clone(),pixelRatio:m.pixelRatio,sdf:m.sdf,version:m.version,stretchX:m.stretchX,stretchY:m.stretchY,content:m.content,hasRenderCallback:!!(m.userImage&&m.userImage.render)}:_e(`Image "${h}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}c(null,u)}getPixelSize(t){const{width:r,height:c}=this.atlasImage[t];return{width:r,height:c}}getPattern(t,r){const c=this.patterns[r][t],u=this.getImage(t,r);if(!u)return null;if(c&&c.position.version===u.version)return c.position;if(c)c.position.version=u.version;else{const h={w:u.data.width+2,h:u.data.height+2,x:0,y:0},m=new PP(h,u);this.patterns[r][t]={bin:h,position:m}}return this._updatePatternAtlas(r),this.patterns[r][t].position}bind(t,r){const c=t.gl;let u=this.atlasTexture[r];u?this.dirty&&(u.update(this.atlasImage[r]),this.dirty=!1):(u=new vr(t,this.atlasImage[r],c.RGBA),this.atlasTexture[r]=u),u.bind(c.LINEAR,c.CLAMP_TO_EDGE)}_updatePatternAtlas(t){const r=[];for(const m in this.patterns[t])r.push(this.patterns[t][m].bin);const{w:c,h:u}=CP(r),h=this.atlasImage[t];h.resize({width:c||1,height:u||1});for(const m in this.patterns[t]){const{bin:g}=this.patterns[t][m],v=g.x+1,b=g.y+1,w=this.images[t][m].data,A=w.width,C=w.height;Xa.copy(w,h,{x:0,y:0},{x:v,y:b},{width:A,height:C}),Xa.copy(w,h,{x:0,y:C-1},{x:v,y:b-1},{width:A,height:1}),Xa.copy(w,h,{x:0,y:0},{x:v,y:b+C},{width:A,height:1}),Xa.copy(w,h,{x:A-1,y:0},{x:v-1,y:b},{width:1,height:C}),Xa.copy(w,h,{x:0,y:0},{x:v+A,y:b},{width:1,height:C})}this.dirty=!0}beginFrame(){for(const t in this.images)this.callbackDispatchedThisFrame[t]={}}dispatchRenderCallbacks(t,r){for(const c of t){if(this.callbackDispatchedThisFrame[r][c])continue;this.callbackDispatchedThisFrame[r][c]=!0;const u=this.images[r][c];fie(u)&&this.updateImage(c,r,u)}}}const gie=new xa({anchor:new Zt(at.light.anchor),position:new class{constructor(a){this.specification=a}possiblyEvaluate(a,t){return st(a.expression.evaluate(t))}interpolate(a,t,r){return{x:Ln(a.x,t.x,r),y:Ln(a.y,t.y,r),z:Ln(a.z,t.z,r),azimuthal:Ln(a.azimuthal,t.azimuthal,r),polar:Ln(a.polar,t.polar,r)}}}(at.light.position),color:new Zt(at.light.color),intensity:new Zt(at.light.intensity)});class PB extends Un{constructor(t,r="flat"){super(),this._transitionable=new Kd(gie),this.setLight(t,r),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(t,r,c={}){this._validate(Hy,t,c)||(this._transitionable.setTransitionOrValue(t),this.id=r)}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}_validate(t,r,c){return(!c||c.validate!==!1)&&mo(this,t.call(Fu,Fe({value:r,style:{glyphs:!0,sprite:!0},styleSpec:at})))}}const yie=new xa({source:new Zt(at.terrain.source),exaggeration:new Zt(at.terrain.exaggeration)});let vie=class extends Un{constructor(a,t){super(),this._transitionable=new Kd(yie),this.set(a),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=t}setScope(a){this.scope=a}get(){return this._transitionable.serialize()}set(a){this._transitionable.setTransitionOrValue(a)}updateTransitions(a){this._transitioning=this._transitionable.transitioned(a,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(a){this.properties=this._transitioning.possiblyEvaluate(a)}getExaggeration(a){return this._transitioning.possiblyEvaluate(new sa(a)).get("exaggeration")}isZoomDependent(){const a=this._transitionable._values.exaggeration;return a!=null&&a.value!=null&&a.value.expression!=null&&a.value.expression instanceof Bc}};const IB=45,LB=65,Im=.05;function P3(a,t,r,c){const u=Ee(IB,LB,r),[h,m]=RB(a,c);let g=1-Math.min(1,Math.exp((t-h)/(m-h)*-6));return g*=g*g,g=Math.min(1,1.00747*g),g*u*a.alpha}function RB(a,t){const r=.5/Math.tan(.5*t);return[a.range[0]+r,a.range[1]+r]}function kB(a,t,r,c,u){const h=ke.transformMat4([],[t,r,c],u.mercatorFogMatrix);return P3(a,ke.length(h),u.pitch,u._fov)}function DB(a,t,r,c,u,h,m){const g=[[r,c,0],[u,c,0],[u,h,0],[r,h,0]];let v=Number.MAX_VALUE,b=-Number.MAX_VALUE;for(const w of g){const A=ke.transformMat4([],w,t),C=ke.length(A);v=Math.min(v,C),b=Math.max(b,C)}return[P3(a,v,m.pitch,m._fov),P3(a,b,m.pitch,m._fov)]}const _ie=new xa({range:new Zt(at.fog.range),color:new Zt(at.fog.color),"high-color":new Zt(at.fog["high-color"]),"space-color":new Zt(at.fog["space-color"]),"horizon-blend":new Zt(at.fog["horizon-blend"]),"star-intensity":new Zt(at.fog["star-intensity"]),"vertical-range":new Zt(at.fog["vertical-range"])});class bie extends Un{constructor(t,r){super(),this._transitionable=new Kd(_ie),this.set(t),this._transitioning=this._transitionable.untransitioned(),this._transform=r}get state(){const t=this._transform,r=t.projection.name==="globe",c=yo(t.zoom),u=this.properties.get("range"),h=[.5,3];return{range:r?[Ln(h[0],u[0],c),Ln(h[1],u[1],c)]:u,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(t,r={}){if(this._validate(jy,t,r))return;const c=Fe({},t);for(const u of Object.keys(at.fog))c[u]===void 0&&(c[u]=at.fog[u].default);this._transitionable.setTransitionOrValue(c)}getOpacity(t){if(!this._transform.projection.supportsFog)return 0;const r=this.properties&&this.properties.get("color")||1;return(this._transform.projection.name==="globe"?1:Ee(IB,LB,t))*r.a}getOpacityAtLatLng(t,r){return this._transform.projection.supportsFog?function(c,u,h){const m=vi.fromLngLat(u),g=h.elevation?h.elevation.getAtPointOrZero(m):0;return kB(c,m.x,m.y,g,h)}(this.state,t,r):0}getOpacityForTile(t){if(!this._transform.projection.supportsFog)return[1,1];const r=this._transform.calculateFogTileMatrix(t.toUnwrapped());return DB(this.state,r,0,0,mt,mt,this._transform)}getOpacityForBounds(t,r,c,u,h){return this._transform.projection.supportsFog?DB(this.state,t,r,c,u,h,this._transform):[1,1]}getFovAdjustedRange(t){return this._transform.projection.supportsFog?RB(this.state,t):[0,1]}isVisibleOnFrustum(t){if(!this._transform.projection.supportsFog)return!1;const r=[4,5,6,7];for(const c of r){const u=t.points[c];let h;if(u[2]>=0)h=u;else{const m=t.points[c-4];h=sp(m,u,m[2]/(m[2]-u[2]))}if(kB(this.state,h[0],h[1],0,this._transform)>=Im)return!0}return!1}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}_validate(t,r,c){return(!c||c.validate!==!1)&&mo(this,t.call(Fu,Fe({value:r,style:{glyphs:!0,sprite:!0},styleSpec:at})))}}class xie{constructor(t){this._callback=t,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class wie{constructor(){this.tasks={},this.taskQueue=[],ft(["process"],this),this.invoker=new xie(this.process),this.nextId=0}add(t,r){const c=this.nextId++,u=function({type:h,isSymbolTile:m,zoom:g}){return g=g||0,h==="message"?0:h!=="maybePrepare"||m?h!=="parseTile"||m?h==="parseTile"&&m?300-g:h==="maybePrepare"&&m?400-g:500:200-g:100-g}(r);if(u===0){ne();try{t()}finally{}return{cancel:()=>{}}}return this.tasks[c]={fn:t,metadata:r,priority:u,id:c},this.taskQueue.push(c),this.invoker.trigger(),{cancel:()=>{delete this.tasks[c]}}}process(){ne();try{if(this.taskQueue=this.taskQueue.filter(c=>!!this.tasks[c]),!this.taskQueue.length)return;const t=this.pick();if(t===null)return;const r=this.tasks[t];if(delete this.tasks[t],this.taskQueue.length&&this.invoker.trigger(),!r)return;r.fn()}finally{}}pick(){let t=null,r=1/0;for(let u=0;u<this.taskQueue.length;u++){const h=this.tasks[this.taskQueue[u]];h.priority<r&&(r=h.priority,t=u)}if(t===null)return null;const c=this.taskQueue[t];return this.taskQueue.splice(t,1),c}remove(){this.invoker.remove()}}class OB{constructor(t,r,c){this.target=t,this.parent=r,this.mapId=c,this.callbacks={},this.cancelCallbacks={},ft(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.scheduler=new wie}send(t,r,c,u,h=!1,m){const g=Math.round(1e18*Math.random()).toString(36).substring(0,10);c&&(c.metadata=m,this.callbacks[g]=c);const v=new Set;return this.target.postMessage({id:g,type:t,hasCallback:!!c,targetMapId:u,mustQueue:h,sourceMapId:this.mapId,data:ks(r,v)},v),{cancel:()=>{c&&delete this.callbacks[g],this.target.postMessage({id:g,type:"<cancel>",targetMapId:u,sourceMapId:this.mapId})}}}receive(t){const r=t.data,c=r.id;if(c&&(!r.targetMapId||this.mapId===r.targetMapId))if(r.type==="<cancel>"){const u=this.cancelCallbacks[c];delete this.cancelCallbacks[c],u&&u.cancel()}else if(r.mustQueue||ne()){const u=this.callbacks[c];this.cancelCallbacks[c]=this.scheduler.add(()=>this.processTask(c,r),u&&u.metadata||{type:"message"})}else this.processTask(c,r)}processTask(t,r){if(r.type==="<response>"){const c=this.callbacks[t];delete this.callbacks[t],c&&(r.error?c(Xd(r.error)):c(null,Xd(r.data)))}else{const c=new Set,u=r.hasCallback?(m,g)=>{delete this.cancelCallbacks[t],this.target.postMessage({id:t,type:"<response>",sourceMapId:this.mapId,error:m?ks(m):null,data:ks(g,c)},c)}:m=>{},h=Xd(r.data);if(this.parent[r.type])this.parent[r.type](r.sourceMapId,h,u);else if(this.parent.getWorkerSource){const m=r.type.split(".");this.parent.getWorkerSource(r.sourceMapId,m[0],h.source,h.scope)[m[1]](h,u)}else u(new Error(`Could not find function ${r.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}}class Lm{constructor(t,r){this.workerPool=t,this.actors=[],this.currentActor=0,this.id=kt();const c=this.workerPool.acquire(this.id);for(let u=0;u<c.length;u++){const h=new Lm.Actor(c[u],r,this.id);h.name=`Worker ${u}`,this.actors.push(h)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(t,r,c){Ze(this.actors,(u,h)=>{u.send(t,r,h)},c=c||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(t=>{t.remove()}),this.actors=[],this.workerPool.release(this.id)}}Lm.Actor=OB;class NB extends Un{constructor(t,r,c,u){super(),this.scope=c,this._options=t,this.properties=new Vu(r),this._transitionable=new Kd(r,new Map(u)),this._transitionable.setTransitionOrValue(t.properties),this._transitioning=this._transitionable.untransitioned()}updateConfig(t){this._transitionable.setTransitionOrValue(this._options.properties,new Map(t))}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}get(){return this._options.properties=this._transitionable.serialize(),this._options}set(t,r){this._options=t,this._transitionable.setTransitionOrValue(t.properties,r)}shadowsEnabled(){return!!this.properties&&this.properties.get("cast-shadows")===!0}}const Sie=new xa({color:new Zt(at.properties_light_ambient.color),intensity:new Zt(at.properties_light_ambient.intensity)}),Aie=new xa({direction:new class{constructor(a){this.specification=a}possiblyEvaluate(a,t){return function([r,c]){const u=st([1,r,c]);return{x:u.x,y:u.y,z:u.z}}(a.expression.evaluate(t))}interpolate(a,t,r){return{x:Ln(a.x,t.x,r),y:Ln(a.y,t.y,r),z:Ln(a.z,t.z,r)}}}(at.properties_light_directional.direction),color:new Zt(at.properties_light_directional.color),intensity:new Zt(at.properties_light_directional.intensity),"cast-shadows":new Zt(at.properties_light_directional["cast-shadows"]),"shadow-intensity":new Zt(at.properties_light_directional["shadow-intensity"])});class KP{constructor(t,r,c,u){this.screenBounds=t,this.cameraPoint=r,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=c,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,u)}static createFromScreenPoints(t,r){let c,u;if(t instanceof V||typeof t[0]=="number"){const h=V.convert(t);c=[h],u=r.isPointAboveHorizon(h)}else{const h=V.convert(t[0]),m=V.convert(t[1]);c=[h,m],u=le(h,m).every(g=>r.isPointAboveHorizon(g))}return new KP(c,r.getCameraPoint(),u,r)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(t){return le(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],t)}bufferedCameraGeometry(t){const r=this.screenBounds[0],c=this.screenBounds.length===1?this.screenBounds[0].add(new V(1,1)):this.screenBounds[1],u=le(r,c,0,!1);return this.cameraPoint.y>c.y&&(this.cameraPoint.x>r.x&&this.cameraPoint.x<c.x?u.splice(3,0,this.cameraPoint):this.cameraPoint.x>=c.x?u[2]=this.cameraPoint:this.cameraPoint.x<=r.x&&(u[3]=this.cameraPoint)),function(h,m){const g=[];for(let v=0;v<h.length;v++){const b=Je(v-1,-1,h.length-1),w=Je(v+1,-1,h.length-1),A=h[v],C=h[w],P=h[b].sub(A).unit(),k=C.sub(A).unit(),z=k.angleWithSep(P.x,P.y),U=P.add(k).unit().mult(-1*m/Math.sin(z/2));g.push(A.add(U))}return g}(u,t)}bufferedCameraGeometryGlobe(t){const r=this.screenBounds[0],c=this.screenBounds.length===1?this.screenBounds[0].add(new V(1,1)):this.screenBounds[1],u=le(r,c,t),h=this.cameraPoint.clone();switch(3*((h.y>r.y)+(h.y>c.y))+((h.x>r.x)+(h.x>c.x))){case 0:u[0]=h,u[4]=h.clone();break;case 1:u.splice(1,0,h);break;case 2:u[1]=h;break;case 3:u.splice(4,0,h);break;case 5:u.splice(2,0,h);break;case 6:u[3]=h;break;case 7:u.splice(3,0,h);break;case 8:u[2]=h}return u}containsTile(t,r,c,u=0){const h=t.queryPadding/r._pixelsPerMercatorPixel+1,m=c?this._bufferedCameraMercator(h,r):this._bufferedScreenMercator(h,r);let g=t.tileID.wrap+(m.unwrapped?u:0);const v=m.polygon.map(U=>gF(t.tileTransform,U,g));if(!pz(v,0,0,mt,mt))return;g=t.tileID.wrap+(this.screenGeometryMercator.unwrapped?u:0);const b=this.screenGeometryMercator.polygon.map(U=>yF(t.tileTransform,U,g)),w=b.map(U=>new V(U[0],U[1])),A=r.getFreeCameraOptions().position||new vi(0,0,0),C=yF(t.tileTransform,A,g),P=b.map(U=>{const W=ke.sub(U,U,C);return ke.normalize(W,W),new k2(C,W)}),k=Tm(t,1,r.zoom)*r._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:w,tilespaceRays:P,bufferedTilespaceGeometry:v,bufferedTilespaceBounds:(z=ze(v),z.min.x=ae(z.min.x,0,mt),z.min.y=ae(z.min.y,0,mt),z.max.x=ae(z.max.x,0,mt),z.max.y=ae(z.max.y,0,mt),z),tile:t,tileID:t.tileID,pixelToTileUnitsFactor:k};var z}_bufferedScreenMercator(t,r){const c=zB(t);if(this._screenRaycastCache[c])return this._screenRaycastCache[c];{let u;return u=r.projection.name==="globe"?this._projectAndResample(this.bufferedScreenGeometry(t),r):{polygon:this.bufferedScreenGeometry(t).map(h=>r.pointCoordinate3D(h)),unwrapped:!0},this._screenRaycastCache[c]=u,u}}_bufferedCameraMercator(t,r){const c=zB(t);if(this._cameraRaycastCache[c])return this._cameraRaycastCache[c];{let u;return u=r.projection.name==="globe"?this._projectAndResample(this.bufferedCameraGeometryGlobe(t),r):{polygon:this.bufferedCameraGeometry(t).map(h=>r.pointCoordinate3D(h)),unwrapped:!0},this._cameraRaycastCache[c]=u,u}}_projectAndResample(t,r){const c=function(h,m){const g=rt.multiply([],m.pixelMatrix,m.globeMatrix),v=[0,-cs,0,1],b=[0,cs,0,1],w=[0,0,0,1];Hi.transformMat4(v,v,g),Hi.transformMat4(b,b,g),Hi.transformMat4(w,w,g);const A=new V(v[0]/v[3],v[1]/v[3]),C=new V(b[0]/b[3],b[1]/b[3]),P=Ap(h,A)&&v[3]<w[3],k=Ap(h,C)&&b[3]<w[3];if(!P&&!k)return null;const z=function(re,ce,ge){for(let ve=1;ve<re.length;ve++){const Ce=N1(ce.pointCoordinate3D(re[ve-1]).x),Ae=N1(ce.pointCoordinate3D(re[ve]).x);if(ge<0){if(Ce<Ae)return{idx:ve,t:-Ce/(Ae-1-Ce)}}else if(Ae<Ce)return{idx:ve,t:(1-Ce)/(Ae+1-Ce)}}return null}(h,m,P?-1:1);if(!z)return null;const{idx:U,t:W}=z;let $=U>1?JP(h.slice(0,U),m):[],Z=U<h.length?JP(h.slice(U),m):[];$=$.map(re=>new V(N1(re.x),re.y)),Z=Z.map(re=>new V(N1(re.x),re.y));const K=[...$];K.length===0&&K.push(Z[Z.length-1]);const q=Ln(K[K.length-1].y,(Z.length===0?$[0]:Z[0]).y,W);let J;return J=P?[new V(0,q),new V(0,0),new V(1,0),new V(1,q)]:[new V(1,q),new V(1,1),new V(0,1),new V(0,q)],K.push(...J),Z.length===0?K.push($[0]):K.push(...Z),{polygon:K.map(re=>new vi(re.x,re.y)),unwrapped:!1}}(t,r);if(c)return c;const u=function(h,m){let g=!1,v=-1/0,b=0;for(let A=0;A<h.length-1;A++)h[A].x>v&&(v=h[A].x,b=A);for(let A=0;A<h.length-1;A++){const C=(b+A)%(h.length-1),P=h[C],k=h[C+1];Math.abs(P.x-k.x)>.5&&(P.x<k.x?(P.x+=1,C===0&&(h[h.length-1].x+=1)):(k.x+=1,C+1===h.length-1&&(h[0].x+=1)),g=!0)}const w=vo(m.center.lng);return g&&w<Math.abs(w-1)&&h.forEach(A=>{A.x-=1}),{polygon:h,unwrapped:g}}(JP(t,r).map(h=>new V(N1(h.x),h.y)),r);return{polygon:u.polygon.map(h=>new vi(h.x,h.y)),unwrapped:u.unwrapped}}}function JP(a,t){return sz(a,r=>{const c=t.pointCoordinate3D(r);r.x=c.x,r.y=c.y},1/256)}function N1(a){return a<0?1+a%1:a%1}function zB(a){return 100*a|0}function QP(a,t,r,c,u){const h=function(m,g){if(m)return u(m);if(g){a.url&&g.tiles&&a.tiles&&delete a.tiles;const v=ct(Fe(g,a),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);g.vector_layers&&(v.vectorLayers=g.vector_layers,v.vectorLayerIds=v.vectorLayers.map(b=>b.id)),v.tiles=t.canonicalizeTileset(v,a.url),u(null,v)}};return a.url?tt(t.transformRequest(t.normalizeSourceURL(a.url,null,r,c),we.Source),h):Cn.frame(()=>h(null,a))}class I3{constructor(t,r,c){this.bounds=Ol.convert(this.validateBounds(t)),this.minzoom=r||0,this.maxzoom=c||24}validateBounds(t){return Array.isArray(t)&&t.length===4?[Math.max(-180,t[0]),Math.max(-90,t[1]),Math.min(180,t[2]),Math.min(90,t[3])]:[-180,-90,180,90]}contains(t){const r=Math.pow(2,t.z),c=Math.floor(vo(this.bounds.getWest())*r),u=Math.floor(Co(this.bounds.getNorth())*r),h=Math.ceil(vo(this.bounds.getEast())*r),m=Math.ceil(Co(this.bounds.getSouth())*r);return t.x>=c&&t.x<h&&t.y>=u&&t.y<m}}class FB{constructor(t,r){this.width=t,this.height=r,this.nextRow=0,this.image=new oh({width:t,height:r}),this.positions={},this.uploaded=!1}getDash(t,r){const c=this.getKey(t,r);return this.positions[c]}trim(){const t=this.width,r=this.height=At(this.nextRow);this.image.resize({width:t,height:r})}getKey(t,r){return t.join(",")+r}getDashRanges(t,r,c){const u=[];let h=t.length%2==1?-t[t.length-1]*c:0,m=t[0]*c,g=!0;u.push({left:h,right:m,isDash:g,zeroLength:t[0]===0});let v=t[0];for(let b=1;b<t.length;b++){g=!g;const w=t[b];h=v*c,v+=w,m=v*c,u.push({left:h,right:m,isDash:g,zeroLength:w===0})}return u}addRoundDash(t,r,c){const u=r/2;for(let h=-c;h<=c;h++){const m=this.width*(this.nextRow+c+h);let g=0,v=t[g];for(let b=0;b<this.width;b++){b/v.right>1&&(v=t[++g]);const w=Math.abs(b-v.left),A=Math.abs(b-v.right),C=Math.min(w,A);let P;const k=h/c*(u+1);if(v.isDash){const z=u-Math.abs(k);P=Math.sqrt(C*C+z*z)}else P=u-Math.sqrt(C*C+k*k);this.image.data[m+b]=Math.max(0,Math.min(255,P+128))}}}addRegularDash(t,r){for(let v=t.length-1;v>=0;--v){const b=t[v],w=t[v+1];b.zeroLength?t.splice(v,1):w&&w.isDash===b.isDash&&(w.left=b.left,t.splice(v,1))}const c=t[0],u=t[t.length-1];c.isDash===u.isDash&&(c.left=u.left-this.width,u.right=c.right+this.width);const h=this.width*this.nextRow;let m=0,g=t[m];for(let v=0;v<this.width;v++){v/g.right>1&&(g=t[++m]);const b=Math.abs(v-g.left),w=Math.abs(v-g.right),A=Math.min(b,w);this.image.data[h+v]=Math.max(0,Math.min(255,(g.isDash?A:-A)+r+128))}}addDash(t,r){const c=this.getKey(t,r);if(this.positions[c])return this.positions[c];const u=r==="round",h=u?7:0,m=2*h+1;if(this.nextRow+m>this.height)return _e("LineAtlas out of space"),null;t.length===0&&t.push(1);let g=0;for(let w=0;w<t.length;w++)t[w]<0&&(_e("Negative value is found in line dasharray, replacing values with 0"),t[w]=0),g+=t[w];if(g!==0){const w=this.width/g,A=this.getDashRanges(t,this.width,w);u?this.addRoundDash(A,w,h):this.addRegularDash(A,r==="square"?.5*w:0)}const v=this.nextRow+h;this.nextRow+=m;const b={tl:[v,h],br:[g,0]};return this.positions[c]=b,b}}un(FB,"LineAtlas");const BB=1*qc;class UB{constructor(t){const r={},c=[];for(const g in t){const v=t[g],b=r[g]={};for(const w in v.glyphs){const A=v.glyphs[+w];if(!A||A.bitmap.width===0||A.bitmap.height===0)continue;const C=A.metrics.localGlyph?BB:1,P={x:0,y:0,w:A.bitmap.width+2*C,h:A.bitmap.height+2*C};c.push(P),b[w]=P}}const{w:u,h}=CP(c),m=new oh({width:u||1,height:h||1});for(const g in t){const v=t[g];for(const b in v.glyphs){const w=v.glyphs[+b];if(!w||w.bitmap.width===0||w.bitmap.height===0)continue;const A=r[g][b],C=w.metrics.localGlyph?BB:1;oh.copy(w.bitmap,m,{x:0,y:0},{x:A.x+C,y:A.y+C},w.bitmap)}}this.image=m,this.positions=r}}un(UB,"GlyphAtlas");class Eie{constructor(t){this.tileID=new Li(t.tileID.overscaledZ,t.tileID.wrap,t.tileID.canonical.z,t.tileID.canonical.x,t.tileID.canonical.y),this.tileZoom=t.tileZoom,this.uid=t.uid,this.zoom=t.zoom,this.canonical=t.tileID.canonical,this.pixelRatio=t.pixelRatio,this.tileSize=t.tileSize,this.source=t.source,this.scope=t.scope,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=t.showCollisionBoxes,this.collectResourceTiming=!!t.collectResourceTiming,this.promoteId=t.promoteId,this.isSymbolTile=t.isSymbolTile,this.tileTransform=Mm(t.tileID.canonical,t.projection),this.projection=t.projection,this.brightness=t.brightness,this.extraShadowCaster=!!t.extraShadowCaster}parse(t,r,c,u,h){this.status="parsing",this.data=t,this.collisionBoxArray=new IC;const m=new Iz(Object.keys(t.layers).sort()),g=new EP(this.tileID,this.promoteId);g.bucketLayerIDs=[];const v={},b=new FB(256,256),w={featureIndex:g,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:b,availableImages:c,brightness:this.brightness},A=r.familiesBySource[this.source];for(const $ in A){const Z=t.layers[$];if(!Z)continue;let K=!1,q=!1,J=!1;for(const ge of A[$])ge[0].type==="symbol"?K=!0:q=!0,ge[0].is3D()&&ge[0].type!=="model"&&(J=!0);if(this.extraShadowCaster&&!J||this.isSymbolTile===!0&&!K||this.isSymbolTile===!1&&!q)continue;Z.version===1&&_e(`Vector tile source "${this.source}" layer "${$}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const re=m.encode($),ce=[];for(let ge=0;ge<Z.length;ge++){const ve=Z.feature(ge),Ce=g.getId(ve,$);ce.push({feature:ve,id:Ce,index:ge,sourceLayerIndex:re})}for(const ge of A[$]){const ve=ge[0];(!this.extraShadowCaster||ve.is3D()&&ve.type!=="model")&&(this.isSymbolTile!==void 0&&ve.type==="symbol"!==this.isSymbolTile||ve.minzoom&&this.zoom<Math.floor(ve.minzoom)||ve.maxzoom&&this.zoom>=ve.maxzoom||ve.visibility!=="none"&&(e5(ge,this.zoom,w.brightness,c),(v[ve.id]=ve.createBucket({index:g.bucketLayerIDs.length,layers:ge,zoom:this.zoom,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:re,sourceID:this.source,projection:this.projection.spec})).populate(ce,w,this.tileID.canonical,this.tileTransform),g.bucketLayerIDs.push(ge.map(Ce=>Ce.id))))}}let C,P,k,z;b.trim();const U={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},W=()=>{if(C)return h(C);if(this.extraShadowCaster)this.status="done",h(null,{buckets:Ke(v).filter($=>!$.isEmpty()),featureIndex:g,collisionBoxArray:null,glyphAtlasImage:null,lineAtlas:null,imageAtlas:null,brightness:w.brightness,glyphMap:null,iconMap:null,glyphPositions:null});else if(P&&k&&z){const $=new UB(P),Z=new qz(k,z);for(const K in v){const q=v[K];q instanceof M1?(e5(q.layers,this.zoom,w.brightness,c),xte(q,P,$.positions,k,Z.iconPositions,this.showCollisionBoxes,c,this.tileID.canonical,this.tileZoom,this.projection,this.brightness)):q.hasPattern&&(q instanceof g3||q instanceof q2||q instanceof D1)&&(e5(q.layers,this.zoom,w.brightness,c),q.addFeatures(w,this.tileID.canonical,Z.patternPositions,c,this.tileTransform,this.brightness))}this.status="done",h(null,{buckets:Ke(v).filter(K=>!K.isEmpty()),featureIndex:g,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:$.image,lineAtlas:b,imageAtlas:Z,brightness:w.brightness})}};if(!this.extraShadowCaster){const $=_t(w.glyphDependencies,q=>Object.keys(q).map(Number));Object.keys($).length?u.send("getGlyphs",{uid:this.uid,stacks:$,scope:this.scope},(q,J)=>{C||(C=q,P=J,W())},void 0,!1,U):P={};const Z=Object.keys(w.iconDependencies);Z.length?u.send("getImages",{icons:Z,source:this.source,scope:this.scope,tileID:this.tileID,type:"icons"},(q,J)=>{C||(C=q,k=J,W())},void 0,!1,U):k={};const K=Object.keys(w.patternDependencies);K.length?u.send("getImages",{icons:K,source:this.source,scope:this.scope,tileID:this.tileID,type:"patterns"},(q,J)=>{C||(C=q,z=J,W())},void 0,!1,U):z={}}W()}}function e5(a,t,r,c){const u=new sa(t,{brightness:r});for(const h of a)h.recalculate(u,c)}class WB{constructor(t){this.entries={},this.scheduler=t}request(t,r,c,u){const h=this.entries[t]=this.entries[t]||{callbacks:[]};if(h.result){const[m,g]=h.result;return this.scheduler?this.scheduler.add(()=>{u(m,g)},r):u(m,g),()=>{}}return h.callbacks.push(u),h.cancel||(h.cancel=c((m,g)=>{h.result=[m,g];for(const v of h.callbacks)this.scheduler?this.scheduler.add(()=>{v(m,g)},r):v(m,g);setTimeout(()=>delete this.entries[t],3e3)})),()=>{h.result||(h.callbacks=h.callbacks.filter(m=>m!==u),h.callbacks.length||(h.cancel(),delete this.entries[t]))}}}function VB(a,t,r){const c=JSON.stringify(a.request);return a.data&&(this.deduped.entries[c]={result:[null,a.data]}),this.deduped.request(c,{type:"parseTile",isSymbolTile:a.isSymbolTile,zoom:a.tileZoom},u=>{const h=vt(a.request,(m,g,v,b)=>{m?u(m):g&&u(null,{vectorTile:r?void 0:new xP(new e3(g)),rawData:g,cacheControl:v,expires:b})});return()=>{h.cancel(),u()}},t)}class GB extends Un{constructor(t,r,c,u){if(super(),this.id=t,this.dispatcher=c,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,Fe(this,ct(r,["url","scheme","tileSize","promoteId"])),this._options=Fe({type:"vector"},r),this._collectResourceTiming=!!r.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(u),this._tileWorkers={},this._deduped=new WB}load(t){this._loaded=!1,this.fire(new $t("dataloading",{dataType:"source"}));const r=Array.isArray(this.map._language)?this.map._language.join():this.map._language,c=this.map._worldview;this._tileJSONRequest=QP(this._options,this.map._requestManager,r,c,(u,h)=>{this._tileJSONRequest=null,this._loaded=!0,u?(r&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${r}`),c&&c.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${c}`),this.fire(new bn(u))):h&&(Fe(this,h),h.bounds&&(this.tileBounds=new I3(h.bounds,this.minzoom,this.maxzoom)),jt(h.tiles,this.map._requestManager._customAccessToken),this.fire(new $t("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new $t("data",{dataType:"source",sourceDataType:"content"}))),t&&t(u)})}loaded(){return this._loaded}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}onAdd(t){this.map=t,this.load()}reload(){this.cancelTileJSONRequest();const t=Yo(this.id,this.scope);this.load(()=>this.map.style.clearSource(t))}setTiles(t){return this._options.tiles=t,this.reload(),this}setUrl(t){return this.url=t,this._options.url=t,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return Fe({},this._options)}loadTile(t,r){const c=this.map._requestManager.normalizeTileURL(t.tileID.canonical.url(this.tiles,this.scheme)),u={request:this.map._requestManager.transformRequest(c,we.Tile),data:void 0,uid:t.uid,tileID:t.tileID,tileZoom:t.tileZoom,zoom:t.tileID.overscaledZ,tileSize:this.tileSize*t.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,pixelRatio:Cn.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:t.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0,extraShadowCaster:t.isExtraShadowCaster};if(u.request.collectResourceTiming=this._collectResourceTiming,t.actor&&t.state!=="expired")t.state==="loading"?t.reloadCallback=r:t.request=t.actor.send("reloadTile",u,h.bind(this));else if(t.actor=this._tileWorkers[c]=this._tileWorkers[c]||this.dispatcher.getActor(),this.dispatcher.ready)t.request=t.actor.send("loadTile",u,h.bind(this),void 0,!0);else{const m=VB.call({deduped:this._deduped},u,(g,v)=>{g||!v?h.call(this,g):(u.data={cacheControl:v.cacheControl,expires:v.expires,rawData:v.rawData.slice(0)},t.actor&&t.actor.send("loadTile",u,h.bind(this),void 0,!0))},!0);t.request={cancel:m}}function h(m,g){return delete t.request,t.aborted?r(null):m&&m.status!==404?r(m):(g&&g.resourceTiming&&(t.resourceTiming=g.resourceTiming),this.map._refreshExpiredTiles&&g&&t.setExpiryData(g),t.loadVectorData(g,this.map.painter),Qe(this.dispatcher),r(null),void(t.reloadCallback&&(this.loadTile(t,t.reloadCallback),t.reloadCallback=null)))}}abortTile(t){t.request&&(t.request.cancel(),delete t.request),t.actor&&t.actor.send("abortTile",{uid:t.uid,type:this.type,source:this.id,scope:this.scope})}unloadTile(t){t.unloadVectorData(),t.actor&&t.actor.send("removeTile",{uid:t.uid,type:this.type,source:this.id,scope:this.scope})}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class z1 extends Un{constructor(t,r,c,u){super(),this.id=t,this.dispatcher=c,this.setEventedParent(u),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=Fe({type:"raster"},r),Fe(this,ct(r,["url","scheme","tileSize"]))}load(t){this._loaded=!1,this.fire(new $t("dataloading",{dataType:"source"})),this._tileJSONRequest=QP(this._options,this.map._requestManager,null,null,(r,c)=>{this._tileJSONRequest=null,this._loaded=!0,r?this.fire(new bn(r)):c&&(Fe(this,c),c.bounds&&(this.tileBounds=new I3(c.bounds,this.minzoom,this.maxzoom)),jt(c.tiles),this.fire(new $t("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new $t("data",{dataType:"source",sourceDataType:"content"}))),t&&t(r)})}loaded(){return this._loaded}onAdd(t){this.map=t,this.load()}reload(){this.cancelTileJSONRequest();const t=Yo(this.id,this.scope);this.load(()=>this.map.style.clearSource(t))}setTiles(t){return this._options.tiles=t,this.reload(),this}setUrl(t){return this.url=t,this._options.url=t,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return Fe({},this._options)}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}loadTile(t,r){const c=Cn.devicePixelRatio>=2,u=this.map._requestManager.normalizeTileURL(t.tileID.canonical.url(this.tiles,this.scheme),c,this.tileSize);t.request=Qt(this.map._requestManager.transformRequest(u,we.Tile),(h,m,g,v)=>(delete t.request,t.aborted?(t.state="unloaded",r(null)):h?(t.state="errored",r(h)):m?(this.map._refreshExpiredTiles&&t.setExpiryData({cacheControl:g,expires:v}),t.setTexture(m,this.map.painter),t.state="loaded",Qe(this.dispatcher),void r(null)):r(null)))}static loadTileData(t,r,c){t.setTexture(r,c)}static unloadTileData(t,r){t.texture&&r.saveTileTexture(t.texture)}abortTile(t,r){t.request&&(t.request.cancel(),delete t.request),r()}unloadTile(t,r){t.texture&&this.map.painter.saveTileTexture(t.texture),r()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}let t5;function Mie(){return J3.workerClass!=null?new J3.workerClass:new f.Worker(J3.workerUrl)}const n5="mapboxgl_preloaded_worker_pool";class Av{constructor(){this.active={}}acquire(t){if(!this.workers)for(this.workers=[];this.workers.length<Av.workerCount;)this.workers.push(new Mie);return this.active[t]=!0,this.workers.slice()}release(t){delete this.active[t],this.workers&&this.numActive()===0&&(this.workers.forEach(r=>{r.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[n5]}numActive(){return Object.keys(this.active).length}}let F1;function B1(){return F1||(F1=new Av),F1}Av.workerCount=2;let U1,i5,Kc,a5=null;function HB(){return ne()&&self.worker&&self.worker.dracoUrl?self.worker.dracoUrl:i5||x.DRACO_URL}const r5=5123,o5=5126,s5={5120:Int8Array,5121:Uint8Array,5122:Int16Array,[r5]:Uint16Array,5125:Uint32Array,[o5]:Float32Array},Tie={5120:"DT_INT8",5121:"DT_UINT8",5122:"DT_INT16",[r5]:"DT_UINT16",5125:"DT_UINT32",[o5]:"DT_FLOAT32"},l5={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16};function jB(a,t,r){const c=r.json.bufferViews.length,u=r.buffers.length;t.bufferView=c,r.json.bufferViews[c]={buffer:u,byteLength:a.byteLength},r.buffers[u]=a}const c5="KHR_draco_mesh_compression";function Cie(a,t){const r=a.extensions&&a.extensions[c5];if(!r)return;const c=new Kc.Decoder,u=XB(t,r.bufferView),h=new Kc.Mesh;if(!c.DecodeArrayToMesh(u,u.byteLength,h))throw new Error("Failed to decode Draco mesh");const m=t.json.accessors[a.indices],g=s5[m.componentType],v=m.count*g.BYTES_PER_ELEMENT,b=Kc._malloc(v);g===Uint16Array?c.GetTrianglesUInt16Array(h,v,b):c.GetTrianglesUInt32Array(h,v,b),jB(Kc.memory.buffer.slice(b,b+v),m,t),Kc._free(b);for(const w of Object.keys(r.attributes)){const A=c.GetAttributeByUniqueId(h,r.attributes[w]),C=t.json.accessors[a.attributes[w]],P=Tie[C.componentType],k=C.count*l5[C.type]*s5[C.componentType].BYTES_PER_ELEMENT,z=Kc._malloc(k);c.GetAttributeDataArrayForAllPoints(h,A,Kc[P],k,z),jB(Kc.memory.buffer.slice(z,z+k),C,t),Kc._free(z)}c.destroy(),h.destroy(),delete a.extensions[c5]}const $B=1179937895,YB=new TextDecoder("utf8");function qB(a,t){return new URL(a,t).href}async function Pie(a,t,r,c){const u=await fetch(qB(a.uri,c)),h=await u.arrayBuffer();t.buffers[r]=h}function XB(a,t){const r=a.json.bufferViews[t];return new Uint8Array(a.buffers[r.buffer],r.byteOffset||0,r.byteLength)}async function Iie(a,t,r,c){if(a.uri){const u=qB(a.uri,c),h=await fetch(u),m=await h.blob();t.images[r]=await f.createImageBitmap(m)}else if(a.bufferView!==void 0){const u=XB(t,a.bufferView),h=new f.Blob([u],{type:a.mimeType});t.images[r]=await f.createImageBitmap(h)}}async function ZB(a,t=0,r){const c={json:null,images:[],buffers:[]};if(new Uint32Array(a,t,1)[0]===$B){const w=new Uint32Array(a,t);let A=2;const C=(w[A++]>>2)-3,P=w[A++]>>2;if(A++,c.json=JSON.parse(YB.decode(w.subarray(A,A+P))),A+=P,A<C){const k=w[A++];A++;const z=t+(A<<2);c.buffers[0]=a.slice(z,z+k)}}else c.json=JSON.parse(YB.decode(new Uint8Array(a,t)));const{buffers:u,images:h,meshes:m,extensionsUsed:g}=c.json;if(u){const w=[];for(let A=0;A<u.length;A++){const C=u[A];C.uri?w.push(Pie(C,c,A,r)):c.buffers[A]||(c.buffers[A]=null)}await Promise.all(w)}const v=[],b=g&&g.includes(c5);if(b&&v.push(async function(){if(!Kc){if(U1)return U1;U1=async function(w){let A,C=null;function P(){A=new Uint8Array(C.buffer)}function k(){throw new Error("Unexpected Draco error.")}const z={a:{a:k,d:function(pt,Rt,Ft){return A.copyWithin(pt,Rt,Rt+Ft)},c:function(pt){const Rt=A.length,Ft=Math.max(pt>>>0,Math.ceil(1.2*Rt)),St=Math.ceil((Ft-Rt)/65536);try{return C.grow(St),P(),!0}catch{return!1}},b:k}},U=await(WebAssembly.instantiateStreaming?WebAssembly.instantiateStreaming(w,z):WebAssembly.instantiate(await(await w).arrayBuffer(),z)),{Rb:W,Qb:$,P:Z,T:K,X:q,Ja:J,La:re,Qa:ce,Va:ge,Wa:ve,eb:Ce,jb:Ae,f:Le,e:Se,yb:Ve,zb:Xe,Ab:nt,Bb:We,Db:Ge,Gb:ot}=U.instance.exports;C=Se;const yt=(()=>{let pt=0,Rt=0,Ft=0,St=0;return Tt=>{Ft&&(W(St),W(pt),Rt+=Ft,Ft=pt=0),pt||(Rt+=128,pt=$(Rt));const nn=Tt.length+7&-8;let sn=pt;nn>=Rt&&(Ft=nn,sn=St=$(nn));for(let on=0;on<Tt.length;on++)A[sn+on]=Tt[on];return sn}})();return P(),Le(),{memory:Se,_free:W,_malloc:$,Mesh:class{constructor(){this.ptr=Z()}destroy(){K(this.ptr)}},Decoder:class{constructor(){this.ptr=J()}destroy(){Ae(this.ptr)}DecodeArrayToMesh(pt,Rt,Ft){const St=yt(pt),Tt=re(this.ptr,St,Rt,Ft.ptr);return!!q(Tt)}GetAttributeByUniqueId(pt,Rt){return{ptr:ce(this.ptr,pt.ptr,Rt)}}GetTrianglesUInt16Array(pt,Rt,Ft){ge(this.ptr,pt.ptr,Rt,Ft)}GetTrianglesUInt32Array(pt,Rt,Ft){ve(this.ptr,pt.ptr,Rt,Ft)}GetAttributeDataArrayForAllPoints(pt,Rt,Ft,St,Tt){Ce(this.ptr,pt.ptr,Rt.ptr,Ft,St,Tt)}},DT_INT8:Ve(),DT_UINT8:Xe(),DT_INT16:nt(),DT_UINT16:We(),DT_UINT32:Ge(),DT_FLOAT32:ot()}}(fetch(HB())),Kc=await U1,U1=void 0}}()),h)for(let w=0;w<h.length;w++)v.push(Iie(h[w],c,w,r));if(v.length&&await Promise.all(v),b&&m)for(const{primitives:w}of m)for(const A of w)Cie(A,c);return c}async function KB(a){const t=await fetch(a);return ZB(await t.arrayBuffer(),0,a)}class JB{constructor(t,r,c){if(this.triangleCount=r.length/3,this.min=new V(0,0),this.max=new V(0,0),this.xScale=0,this.yScale=0,this.cellsX=0,this.cellsY=0,this.cells=[],this.payload=[],this.triangleCount===0||t.length===0||c===0)return;const u=t.map(w=>w.x),h=t.map(w=>w.y);this.min=new V(Math.min(...u),Math.min(...h)),this.max=new V(Math.max(...u),Math.max(...h));const m=this.max.sub(this.min);m.x=Math.max(m.x,1),m.y=Math.max(m.y,1);const g=Math.max(m.x,m.y)/c;this.cellsX=Math.max(1,Math.ceil(m.x/g)),this.cellsY=Math.max(1,Math.ceil(m.y/g)),this.xScale=1/g,this.yScale=1/g;const v=[];for(let w=0;w<this.triangleCount;w++){const A=t[r[3*w+0]].sub(this.min),C=t[r[3*w+1]].sub(this.min),P=t[r[3*w+2]].sub(this.min),k=kp(Math.floor(Math.min(A.x,C.x,P.x)),this.xScale,this.cellsX),z=kp(Math.floor(Math.max(A.x,C.x,P.x)),this.xScale,this.cellsX),U=kp(Math.floor(Math.min(A.y,C.y,P.y)),this.yScale,this.cellsY),W=kp(Math.floor(Math.max(A.y,C.y,P.y)),this.yScale,this.cellsY),$=new V(0,0),Z=new V(0,0),K=new V(0,0),q=new V(0,0);for(let J=U;J<=W;++J){$.y=Z.y=J*g,K.y=q.y=(J+1)*g;for(let re=k;re<=z;++re)$.x=K.x=re*g,Z.x=q.x=(re+1)*g,(hP(A,C,P,$,Z,q)||hP(A,C,P,$,q,K))&&v.push({cellIdx:J*this.cellsX+re,triIdx:w})}}if(v.length===0)return;v.sort((w,A)=>w.cellIdx-A.cellIdx||w.triIdx-A.triIdx);let b=0;for(;b<v.length;){const w=v[b].cellIdx,A={start:this.payload.length,len:0};for(;b<v.length&&v[b].cellIdx===w;)++A.len,this.payload.push(v[b++].triIdx);this.cells[w]=A}}query(t,r,c){if(this.triangleCount===0||this.cells.length===0||t.x>this.max.x||this.min.x>r.x||t.y>this.max.y||this.min.y>r.y)return;this.lookup||(this.lookup=new Uint8Array(Math.ceil(this.triangleCount/8)));for(let v=0;v<this.lookup.length;v++)this.lookup[v]=0;const u=kp(t.x-this.min.x,this.xScale,this.cellsX),h=kp(r.x-this.min.x,this.xScale,this.cellsX),m=kp(t.y-this.min.y,this.yScale,this.cellsY),g=kp(r.y-this.min.y,this.yScale,this.cellsY);for(let v=m;v<=g;v++)for(let b=u;b<=h;b++){const w=this.cells[v*this.cellsX+b];if(w)for(let A=0;A<w.len;A++){const C=this.payload[w.start+A],P=Math.floor(C/8),k=1<<C%8;if(!(this.lookup[P]&k)&&(this.lookup[P]|=k,c.push(C),c.length===this.triangleCount))return}}}}function kp(a,t,r){return Math.max(0,Math.min(r-1,Math.floor(a*t)))}function Rm(a,t){const r=a.json.bufferViews[t.bufferView];return new s5[t.componentType](a.buffers[r.buffer],(t.byteOffset||0)+(r.byteOffset||0),t.count*l5[t.type])}function Lie(a,t,r){const c=a.indices,u=a.attributes,h={};h.indexArray=new Fn;const m=t.json.accessors[c],g=m.count/3;h.indexArray.reserve(g);const v=Rm(t,m);for(let C=0;C<g;C++)h.indexArray.emplaceBack(v[3*C],v[3*C+1],v[3*C+2]);h.indexArray._trim(),h.vertexArray=new Dn;const b=t.json.accessors[u.POSITION];h.vertexArray.reserve(b.count);const w=Rm(t,b);for(let C=0;C<b.count;C++)h.vertexArray.emplaceBack(w[3*C],w[3*C+1],w[3*C+2]);if(h.vertexArray._trim(),h.aabb=new ga(b.min,b.max),h.centroid=function(C,P){const k=[0,0,0],z=C.length;if(z>0){for(let U=0;U<z;U++){const W=3*C[U];k[0]+=P[W],k[1]+=P[W+1],k[2]+=P[W+2]}k[0]/=z,k[1]/=z,k[2]/=z}return k}(v,w),u.COLOR_0!==void 0){const C=t.json.accessors[u.COLOR_0],P=l5[C.type];if(C.componentType===o5){h.colorArray=P===3?new Dn:new dn,h.colorArray.reserve(C.count);const k=Rm(t,C);if(P===3)for(let z=0;z<C.count;z++)h.colorArray.emplaceBack(k[3*z],k[3*z+1],k[3*z+2]);else for(let z=0;z<C.count;z++)h.colorArray.emplaceBack(k[4*z],k[4*z+1],k[4*z+2],k[4*z+3]);h.colorArray._trim()}else if(C.componentType===r5&&P===4){h.colorArray=new dn,h.colorArray.resize(C.count);const k=Rm(t,C),z=1/65535,U=h.colorArray.float32;for(let W=0;W<4*k.length;++W)U[W]=k[W]*z}else _e(`glTF color buffer parsing for accessor ${JSON.stringify(C)} is not supported`)}if(u.NORMAL!==void 0){h.normalArray=new Dn;const C=t.json.accessors[u.NORMAL];h.normalArray.reserve(C.count);const P=Rm(t,C);for(let k=0;k<C.count;k++)h.normalArray.emplaceBack(P[3*k],P[3*k+1],P[3*k+2]);h.normalArray._trim()}if(u.TEXCOORD_0!==void 0&&r.length>0){h.texcoordArray=new o1;const C=t.json.accessors[u.TEXCOORD_0];h.texcoordArray.reserve(C.count);const P=Rm(t,C);for(let k=0;k<C.count;k++)h.texcoordArray.emplaceBack(P[2*k],P[2*k+1]);h.texcoordArray._trim()}const A=a.material;return h.material=function(C,P){const{emissiveFactor:k=[0,0,0],alphaMode:z="OPAQUE",alphaCutoff:U=.5,normalTexture:W,occlusionTexture:$,emissiveTexture:Z,doubleSided:K}=C,{baseColorFactor:q=[1,1,1,1],metallicFactor:J=1,roughnessFactor:re=1,baseColorTexture:ce,metallicRoughnessTexture:ge}=C.pbrMetallicRoughness||{};return{pbrMetallicRoughness:{baseColorFactor:new Sn(...q),metallicFactor:J,roughnessFactor:re,baseColorTexture:ce?P[ce.index]:void 0,metallicRoughnessTexture:ge?P[ge.index]:void 0},doubleSided:K,emissiveFactor:k,alphaMode:z,alphaCutoff:U,normalTexture:W?P[W.index]:void 0,occlusionTexture:$?P[$.index]:void 0,emissionTexture:Z?P[Z.index]:void 0,defined:C.defined===void 0}}(A!==void 0?t.json.materials[A]:{defined:!1},r),u._FEATURE_RGBA4444!==void 0&&(h.featureData=new Uint32Array(Rm(t,t.json.accessors[u._FEATURE_RGBA4444]).buffer)),h}function QB(a,t,r){const{matrix:c,rotation:u,translation:h,scale:m,mesh:g,extras:v,children:b}=a,w={};if(w.matrix=c||rt.fromRotationTranslationScale([],u||[0,0,0,1],h||[0,0,0],m||[1,1,1]),g!==void 0){w.meshes=r[g];const A=w.anchor=[0,0];for(const C of w.meshes){const{min:P,max:k}=C.aabb;A[0]+=P[0]+k[0],A[1]+=P[1]+k[1]}A[0]=Math.floor(A[0]/w.meshes.length/2),A[1]=Math.floor(A[1]/w.meshes.length/2)}if(v&&(v.id&&(w.id=v.id),v.lights&&(w.lights=function(A){if(!A.length)return[];const C=function(W){const $=atob(W),Z=new Uint8Array($.length);for(let K=0;K<$.length;K++)Z[K]=$.codePointAt(K);return Z}(A),P=[],k=C.length/24,z=new Uint16Array(C.buffer),U=new Float32Array(C.buffer);for(let W=0;W<k;W++){const $=z[2*W*6]/30,Z=z[2*W*6+1]/30,K=z[2*W*6+10]/100,q=U[6*W+1],J=U[6*W+2],re=U[6*W+3],ce=U[6*W+4],ge=re-q,ve=ce-J,Ce=Math.hypot(ge,ve);P.push({pos:[q+.5*ge,J+.5*ve,Z],normal:[ve/Ce,-ge/Ce,0],width:Ce,height:$,depth:K,points:[q,J,re,ce]})}return P}(v.lights))),b){const A=[];for(const C of b)A.push(QB(t.json.nodes[C],t,r));w.children=A}return w}function Rie(a){if(a.vertices.length===0||a.indices.length===0)return null;const[t,r]=[a.vertices[0].clone(),a.vertices[0].clone()];for(let m=1;m<a.vertices.length;++m){const g=a.vertices[m];t.x=Math.min(t.x,g.x),t.y=Math.min(t.y,g.y),r.x=Math.max(r.x,g.x),r.y=Math.max(r.y,g.y)}const c=Math.ceil(Math.max(r.x-t.x,r.y-t.y)/256),u=Math.max(8,c),h=new JB(a.vertices,a.indices,u);return{vertices:a.vertices,indices:a.indices,grid:h,min:t,max:r}}function kie(a){if(!a.extras||!a.extras.ground)return null;const t=a.extras.ground;if(!t||!Array.isArray(t)||t.length===0)return null;const r=t[0];if(!r||!Array.isArray(r)||r.length===0)return null;const c=[];for(const m of r){if(!Array.isArray(m)||m.length!==2)continue;const g=m[0],v=m[1];typeof g=="number"&&typeof v=="number"&&c.push(new V(g,v))}if(c.length<3)return null;c.length>1&&c[c.length-1].equals(c[0])&&c.pop();let u=0;for(let m=0;m<c.length;m++){const g=c[m],v=c[(m+1)%c.length],b=c[(m+2)%c.length];u+=(g.x-v.x)*(b.y-v.y)-(b.x-v.x)*(g.y-v.y)}u>0&&c.reverse();const h=Y2(c.flatMap(m=>[m.x,m.y]),[]);return h.length===0?null:{vertices:c,indices:h}}function Die(a){const t=[],r=[];let c=0;for(const u of a){c=t.length;const h=u.vertexArray.float32,m=u.indexArray.uint16;for(let g=0;g<u.vertexArray.length;g++)t.push(new V(h[3*g+0],h[3*g+1]));for(let g=0;g<3*u.indexArray.length;g++)r.push(m[g]+c)}if(r.length%3!=0)return null;for(let u=0;u<r.length;u+=3){const h=t[r[u+0]],m=t[r[u+1]],g=t[r[u+2]];(h.x-m.x)*(g.y-m.y)-(g.x-m.x)*(h.y-m.y)>0&&([r[u+1],r[u+2]]=[r[u+2],r[u+1]])}return{vertices:t,indices:r}}function u5(a){const t=function(v,b){const w=[],A=f.WebGL2RenderingContext;if(v.json.textures)for(const C of v.json.textures){const P={magFilter:A.LINEAR,minFilter:A.NEAREST,wrapS:A.REPEAT,wrapT:A.REPEAT};C.sampler!==void 0&&Object.assign(P,v.json.samplers[C.sampler]),w.push({image:b[C.source],sampler:P,uploaded:!1})}return w}(a,a.images),r=function(v,b){const w=[];for(const A of v.json.meshes){const C=[];for(const P of A.primitives)C.push(Lie(P,v,b));w.push(C)}return w}(a,t),{scenes:c,scene:u,nodes:h}=a.json,m=c?c[u||0].nodes:h,g=[];for(const v of m)g.push(QB(h[v],a,r));return function(v,b,w){const A={},C=new Set;for(let P=0;P<v.length;P++){const k=w[b[P]];if(!k.extras)continue;const z=k.extras["mapbox:footprint:version"],U=k.extras["mapbox:footprint:id"];(z||U)&&C.add(P),z==="1.0.0"&&U&&(A[U]=P)}for(let P=0;P<v.length;P++){if(C.has(P))continue;const k=v[P],z=w[b[P]];if(!z.extras)continue;let U=null;k.id in A&&(U=Die(v[A[k.id]].meshes)),U||(U=kie(z)),U&&(k.footprint=Rie(U))}if(C.size>0){const P=Array.from(C.values()).sort((k,z)=>k-z);for(let k=P.length-1;k>=0;k--)v.splice(P[k],1)}}(g,m,a.json.nodes),g}function Oie(a){a.heightmap=new Float32Array(4096),a.heightmap.fill(-1);const t=a.vertexArray.float32,r=a.aabb.min[0]-1,c=a.aabb.min[1]-1,u=Cm/(a.aabb.max[0]-r+2),h=Cm/(a.aabb.max[1]-c+2);for(let m=0;m<t.length;m+=3){const g=t[m+2],v=(t[m+0]-r)*u|0,b=(t[m+1]-c)*h|0;g>a.heightmap[b*Cm+v]&&(a.heightmap[b*Cm+v]=g)}}function Nie(a,t){const r={};r.indexArray=new Fn,r.indexArray.reserve(4*a.length),r.vertexArray=new Dn,r.vertexArray.reserve(10*a.length),r.colorArray=new dn,r.vertexArray.reserve(10*a.length);let c=0;for(const m of a){const g=Math.min(10,Math.max(4,1.3*m.height))*t,v=[-m.normal[1],m.normal[0],0],b=Math.min(.29,.1*m.width/m.depth),w=m.width-2*m.depth*t*(b+.01),A=ke.scaleAndAdd([],m.pos,v,w/2),C=ke.scaleAndAdd([],m.pos,v,-w/2),P=[A[0],A[1],A[2]+m.height],k=[C[0],C[1],C[2]+m.height],z=ke.scaleAndAdd([],m.normal,v,b);ke.scale(z,z,g);const U=ke.scaleAndAdd([],m.normal,v,-b);ke.scale(U,U,g),ke.add(z,A,z),ke.add(U,C,U),A[2]+=.1,C[2]+=.1,r.vertexArray.emplaceBack(z[0],z[1],z[2]),r.vertexArray.emplaceBack(U[0],U[1],U[2]),r.vertexArray.emplaceBack(A[0],A[1],A[2]),r.vertexArray.emplaceBack(C[0],C[1],C[2]),r.vertexArray.emplaceBack(P[0],P[1],P[2]),r.vertexArray.emplaceBack(k[0],k[1],k[2]),r.vertexArray.emplaceBack(A[0],A[1],A[2]),r.vertexArray.emplaceBack(C[0],C[1],C[2]),r.vertexArray.emplaceBack(z[0],z[1],z[2]),r.vertexArray.emplaceBack(U[0],U[1],U[2]);const W=w/g/2;r.colorArray.emplaceBack(-W-b,-1,W,.8),r.colorArray.emplaceBack(W+b,-1,W,.8),r.colorArray.emplaceBack(-W,0,W,1.3),r.colorArray.emplaceBack(W,0,W,1.3),r.colorArray.emplaceBack(W+b,-.8,W,.7),r.colorArray.emplaceBack(W+b,-.8,W,.7),r.colorArray.emplaceBack(0,0,W,1.3),r.colorArray.emplaceBack(0,0,W,1.3),r.colorArray.emplaceBack(W+b,-1.2,W,.8),r.colorArray.emplaceBack(W+b,-1.2,W,.8),r.indexArray.emplaceBack(6+c,4+c,8+c),r.indexArray.emplaceBack(7+c,9+c,5+c),r.indexArray.emplaceBack(0+c,1+c,2+c),r.indexArray.emplaceBack(1+c,3+c,2+c),c+=10}const u={defined:!0,emissiveFactor:[0,0,0]},h={};return h.baseColorFactor=Sn.white,u.pbrMetallicRoughness=h,r.material=u,r.aabb=new ga([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),r}un(JB,"TriangleGridIndex");const d5={vector:GB,raster:z1,"raster-dem":class extends z1{constructor(a,t,r,c){super(a,t,r,c),this.type="raster-dem",this.maxzoom=22,this._options=Fe({type:"raster-dem"},t),this.encoding=t.encoding||"mapbox"}loadTile(a,t){var h,m;const r=this.map._requestManager.normalizeTileURL(a.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);a.request=Qt(this.map._requestManager.transformRequest(r,we.Tile),(function(g,v,b,w){if(delete a.request,a.aborted)a.state="unloaded",t(null);else if(g)a.state="errored",t(g);else if(v){this.map._refreshExpiredTiles&&a.setExpiryData({cacheControl:b,expires:w});const C=f.ImageBitmap&&v instanceof f.ImageBitmap&&(t5==null&&(t5=f.OffscreenCanvas&&new f.OffscreenCanvas(1,1).getContext("2d")&&typeof f.createImageBitmap=="function"),t5),P=1-(v.width-((A=v.width)<=1?1:Math.pow(2,Math.floor(Math.log(A)/Math.LN2))))/2;P<1||a.neighboringTiles||(a.neighboringTiles=this._getNeighboringTiles(a.tileID));const k=C?v:Cn.getImageData(v,P),z={uid:a.uid,coord:a.tileID,source:this.id,scope:this.scope,rawImageData:k,encoding:this.encoding,padding:P,convertToFloat:c};a.actor&&a.state!=="expired"||(a.actor=this.dispatcher.getActor(),a.actor.send("loadDEMTile",z,u.bind(this),void 0,!0))}var A}).bind(this));const c=(m=(h=this.map)==null?void 0:h.painter)==null?void 0:m.terrainUseFloatDEM();function u(g,v){g&&(a.state="errored",t(g)),v&&(a.dem=v,a.dem.onDeserialize(),a.needsHillshadePrepare=!0,a.needsDEMTextureUpload=!0,a.state="loaded",t(null))}}_getNeighboringTiles(a){const t=a.canonical,r=Math.pow(2,t.z),c=(t.x-1+r)%r,u=t.x===0?a.wrap-1:a.wrap,h=(t.x+1+r)%r,m=t.x+1===r?a.wrap+1:a.wrap,g={};return g[new Li(a.overscaledZ,u,t.z,c,t.y).key]={backfilled:!1},g[new Li(a.overscaledZ,m,t.z,h,t.y).key]={backfilled:!1},t.y>0&&(g[new Li(a.overscaledZ,u,t.z,c,t.y-1).key]={backfilled:!1},g[new Li(a.overscaledZ,a.wrap,t.z,t.x,t.y-1).key]={backfilled:!1},g[new Li(a.overscaledZ,m,t.z,h,t.y-1).key]={backfilled:!1}),t.y+1<r&&(g[new Li(a.overscaledZ,u,t.z,c,t.y+1).key]={backfilled:!1},g[new Li(a.overscaledZ,a.wrap,t.z,t.x,t.y+1).key]={backfilled:!1},g[new Li(a.overscaledZ,m,t.z,h,t.y+1).key]={backfilled:!1}),g}unloadTile(a){a.demTexture&&this.map.painter.saveTileTexture(a.demTexture),a.hillshadeFBO&&(a.hillshadeFBO.destroy(),delete a.hillshadeFBO),a.dem&&delete a.dem,delete a.neighboringTiles,a.state="unloaded"}},geojson:class extends Un{constructor(a,t,r,c){super(),this.id=a,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=r.getActor(),this.setEventedParent(c),this._data=t.data,this._options=Fe({},t),this._collectResourceTiming=t.collectResourceTiming,t.maxzoom!==void 0&&(this.maxzoom=t.maxzoom),t.type&&(this.type=t.type),t.attribution&&(this.attribution=t.attribution),this.promoteId=t.promoteId;const u=mt/this.tileSize;this.workerOptions=Fe({source:this.id,scope:this.scope,cluster:t.cluster||!1,geojsonVtOptions:{buffer:(t.buffer!==void 0?t.buffer:128)*u,tolerance:(t.tolerance!==void 0?t.tolerance:.375)*u,extent:mt,maxZoom:this.maxzoom,lineMetrics:t.lineMetrics||!1,generateId:t.generateId||!1},superclusterOptions:{maxZoom:t.clusterMaxZoom!==void 0?t.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,t.clusterMinPoints||2),extent:mt,radius:(t.clusterRadius!==void 0?t.clusterRadius:50)*u,log:!1,generateId:t.generateId||!1},clusterProperties:t.clusterProperties,filter:t.filter},t.workerOptions)}onAdd(a){this.map=a,this.setData(this._data)}setData(a){return this._data=a,this._updateWorkerData(),this}getClusterExpansionZoom(a,t){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:a,source:this.id,scope:this.scope},t),this}getClusterChildren(a,t){return this.actor.send("geojson.getClusterChildren",{clusterId:a,source:this.id,scope:this.scope},t),this}getClusterLeaves(a,t,r,c){return this.actor.send("geojson.getClusterLeaves",{source:this.id,scope:this.scope,clusterId:a,limit:t,offset:r},c),this}_updateWorkerData(){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new $t("dataloading",{dataType:"source"})),this._loaded=!1;const a=Fe({},this.workerOptions);a.scope=this.scope;const t=this._data;typeof t=="string"?(a.request=this.map._requestManager.transformRequest(Cn.resolveURL(t),we.Source),a.request.collectResourceTiming=this._collectResourceTiming):a.data=JSON.stringify(t),this._pendingLoad=this.actor.send(`${this.type}.loadData`,a,(r,c)=>{if(this._loaded=!0,this._pendingLoad=null,r)this.fire(new bn(r));else{const u={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&c&&c.resourceTiming&&c.resourceTiming[this.id]&&(u.resourceTiming=c.resourceTiming[this.id]),this.fire(new $t("data",u)),this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(a,t){const r=a.actor?"reloadTile":"loadTile";a.actor=this.actor;const c={type:this.type,uid:a.uid,tileID:a.tileID,tileZoom:a.tileZoom,zoom:a.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,scope:this.scope,pixelRatio:Cn.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,brightness:this.map.style&&this.map.style.getBrightness()||0};a.request=this.actor.send(r,c,(u,h)=>(delete a.request,a.unloadVectorData(),a.aborted?t(null):u?t(u):(a.loadVectorData(h,this.map.painter,r==="reloadTile"),t(null))),void 0,r==="loadTile")}abortTile(a){a.request&&(a.request.cancel(),delete a.request),a.aborted=!0}unloadTile(a){a.unloadVectorData(),this.actor.send("removeTile",{uid:a.uid,type:this.type,source:this.id,scope:this.scope})}onRemove(){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return Fe({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends Ku{constructor(a,t,r,c){super(a,t,r,c),this.roundZoom=!0,this.type="video",this.options=t}load(){this._loaded=!1;const a=this.options;this.urls=[];for(const t of a.urls)this.urls.push(this.map._requestManager.transformRequest(t,we.Source).url);(function(t,r){const c=f.document.createElement("video");c.muted=!0,c.onloadstart=function(){r(null,c)};for(let u=0;u<t.length;u++){const h=f.document.createElement("source");ht(t[u])||(c.crossOrigin="Anonymous"),h.src=t[u],c.appendChild(h)}})(this.urls,(t,r)=>{this._loaded=!0,t?this.fire(new bn(t)):r&&(this.video=r,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(a){if(this.video){const t=this.video.seekable;a<t.start(0)||a>t.end(0)?this.fire(new bn(new ln(`sources.${this.id}`,null,`Playback for this video can be set only between the ${t.start(0)} and ${t.end(0)}-second mark.`))):this.video.currentTime=a}}getVideo(){return this.video}onAdd(a){this.map||(this.map=a,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const a=this.map.painter.context,t=a.gl;this.texture?this.video.paused||(this.texture.bind(t.LINEAR,t.CLAMP_TO_EDGE),t.texSubImage2D(t.TEXTURE_2D,0,0,0,t.RGBA,t.UNSIGNED_BYTE,this.video)):(this.texture=new vr(a,this.video,t.RGBA),this.texture.bind(t.LINEAR,t.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(a)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:Ku,model:class extends Un{constructor(a,t,r,c){super(),this.id=a,this.type="model",this.models=[],this._loaded=!1,this._options=t}async load(){for(const a in this._options.models){const t=this._options.models[a],r=await KB(this.map._requestManager.transformRequest(t.uri,we.Model).url).catch(h=>{this.fire(new bn(new Error(`Could not load model ${a} from ${t.uri}: ${h.message}`)))});if(!r)continue;const c=u5(r),u=new YF(a,t.position,t.orientation,c);u.computeBoundsAndApplyParent(),this.models.push(u)}this._loaded=!0,this.fire(new $t("data",{dataType:"source",sourceDataType:"metadata"}))}onAdd(a){this.map=a,this.load()}hasTransition(){return!1}loaded(){return this._loaded}getModels(){return this.models}loadTile(a,t){}serialize(){return{type:"model"}}},"batched-model":class extends Un{constructor(a,t,r,c){super(),this.type="batched-model",this.id=a,this.tileSize=512,this._options=t,this.tiles=this._options.tiles,this.maxzoom=t.maxzoom||19,this.minzoom=t.minzoom||0,this.roundZoom=!0,this.usedInConflation=!0,this.dispatcher=r,this.reparseOverscaled=!1,this.scheme="xyz",this._loaded=!1,this.setEventedParent(c)}onAdd(a){this.map=a,this.load()}load(a){this._loaded=!1,this.fire(new $t("dataloading",{dataType:"source"}));const t=Array.isArray(this.map._language)?this.map._language.join():this.map._language,r=this.map._worldview;this._tileJSONRequest=QP(this._options,this.map._requestManager,t,r,(c,u)=>{this._tileJSONRequest=null,this._loaded=!0,c?(t&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${t}`),r&&r.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${r}`),this.fire(new bn(c))):u&&(Fe(this,u),u.bounds&&(this.tileBounds=new I3(u.bounds,this.minzoom,this.maxzoom)),jt(u.tiles,this.map._requestManager._customAccessToken),this.fire(new $t("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new $t("data",{dataType:"source",sourceDataType:"content"}))),a&&a(c)})}hasTransition(){return!1}hasTile(a){return!this.tileBounds||this.tileBounds.contains(a.canonical)}loaded(){return this._loaded}loadTile(a,t){const r=this.map._requestManager.normalizeTileURL(a.tileID.canonical.url(this.tiles,this.scheme)),c={request:this.map._requestManager.transformRequest(r,we.Tile),data:void 0,uid:a.uid,tileID:a.tileID,tileZoom:a.tileZoom,zoom:a.tileID.overscaledZ,tileSize:this.tileSize*a.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,showCollisionBoxes:this.map.showCollisionBoxes,isSymbolTile:a.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0};if(a.actor&&a.state!=="expired")if(a.state==="loading")a.reloadCallback=t;else{if(a.buckets){const h=Object.values(a.buckets);for(const m of h)m.dirty=!0;return void(a.state="loaded")}a.request=a.actor.send("reloadTile",c,u.bind(this))}else a.actor=this.dispatcher.getActor(),a.request=a.actor.send("loadTile",c,u.bind(this),void 0,!0);function u(h,m){return a.aborted?t(null):h&&h.status!==404?t(h):(m&&(m.resourceTiming&&(a.resourceTiming=m.resourceTiming),this.map._refreshExpiredTiles&&a.setExpiryData(m),a.buckets={...a.buckets,...m.buckets}),a.state="loaded",void t(null))}}serialize(){return Fe({},this._options)}},canvas:class extends Ku{constructor(a,t,r,c){super(a,t,r,c),t.coordinates?Array.isArray(t.coordinates)&&t.coordinates.length===4&&!t.coordinates.some(u=>!Array.isArray(u)||u.length!==2||u.some(h=>typeof h!="number"))||this.fire(new bn(new ln(`sources.${a}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new bn(new ln(`sources.${a}`,null,'missing required property "coordinates"'))),t.animate&&typeof t.animate!="boolean"&&this.fire(new bn(new ln(`sources.${a}`,null,'optional "animate" property must be a boolean value'))),t.canvas?typeof t.canvas=="string"||t.canvas instanceof f.HTMLCanvasElement||this.fire(new bn(new ln(`sources.${a}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new bn(new ln(`sources.${a}`,null,'missing required property "canvas"'))),this.options=t,this.animate=t.animate===void 0||t.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof f.HTMLCanvasElement?this.options.canvas:f.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new bn(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(a){this.map=a,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let a=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,a=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,a=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const t=this.map.painter.context;this.texture?!a&&!this._playing||this.texture instanceof y3||this.texture.update(this.canvas,{premultiply:!0}):this.texture=new vr(t,this.canvas,t.gl.RGBA,{premultiply:!0}),this._prepareData(t)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const a of[this.canvas.width,this.canvas.height])if(isNaN(a)||a<=0)return!0;return!1}},custom:class extends Un{constructor(a,t,r,c){super(),this.id=a,this.type="custom",this._dataType="raster",this._dispatcher=r,this._implementation=t,this.setEventedParent(c),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new bn(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new bn(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new I3(this._implementation.bounds,this.minzoom,this.maxzoom)),t.update=this._update.bind(this),t.clearTiles=this._clearTiles.bind(this),t.coveringTiles=this._coveringTiles.bind(this),Fe(this,ct(t,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return ct(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new $t("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new $t("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(a){this._map=a,this._loaded=!1,this.fire(new $t("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(a),this.load()}onRemove(a){this._implementation.onRemove&&this._implementation.onRemove(a)}hasTile(a){if(this._implementation.hasTile){const{x:t,y:r,z:c}=a.canonical;return this._implementation.hasTile({x:t,y:r,z:c})}return!this.tileBounds||this.tileBounds.contains(a.canonical)}loadTile(a,t){const{x:r,y:c,z:u}=a.tileID.canonical,h=new f.AbortController;a.request=Promise.resolve(this._implementation.loadTile({x:r,y:c,z:u},{signal:h.signal})).then((function(m){return delete a.request,a.aborted?(a.state="unloaded",t(null)):m===void 0?(a.state="errored",t(null)):m===null?(this.loadTileData(a,{width:this.tileSize,height:this.tileSize,data:null}),a.state="loaded",t(null)):function(g){return g instanceof f.ImageData||g instanceof f.HTMLCanvasElement||g instanceof f.ImageBitmap||g instanceof f.HTMLImageElement}(m)?(this.loadTileData(a,m),a.state="loaded",void t(null)):(a.state="errored",t(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)))}).bind(this)).catch(m=>{m.code!==20&&(a.state="errored",t(m))}),a.request.cancel=()=>h.abort()}loadTileData(a,t){z1.loadTileData(a,t,this._map.painter)}unloadTileData(a){z1.unloadTileData(a,this._map.painter)}unloadTile(a,t){if(this.unloadTileData(a),this._implementation.unloadTile){const{x:r,y:c,z:u}=a.tileID.canonical;this._implementation.unloadTile({x:r,y:c,z:u})}t()}abortTile(a,t){a.request&&a.request.cancel&&(a.request.cancel(),delete a.request),t()}hasTransition(){return!1}_coveringTiles(){return this._map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(a=>({x:a.canonical.x,y:a.canonical.y,z:a.canonical.z}))}_clearTiles(){const a=Yo(this.id,this.scope);this._map.style.clearSource(a)}_update(){this.fire(new $t("data",{dataType:"source",sourceDataType:"content"}))}}},h5=function(a,t,r,c){const u=new d5[t.type](a,t,r,c);if(u.id!==a)throw new Error(`Expected Source id to be ${a} instead of ${u.id}`);return ft(["load","abort","unload","serialize","prepare"],u),u};function zie(a,t){const r=rt.identity([]);return rt.scale(r,r,[.5*a.width,.5*-a.height,1]),rt.translate(r,r,[1,-1,0]),rt.multiply(r,r,a.calculateProjMatrix(t.toUnwrapped())),Float32Array.from(r)}function Fie(a,t,r,c,u,h,m,g=!1){const v=a.tilesIn(c,m,g);v.sort(e8);const b=[];for(const A of v)b.push({wrappedTileID:A.tile.tileID.wrapped().key,queryResults:A.tile.queryRenderedFeatures(t,r,a._state,A,u,h,zie(a.transform,A.tile.tileID),g)});const w=function(A){const C={},P={};for(const k of A){const z=k.queryResults,U=k.wrappedTileID,W=P[U]=P[U]||{};for(const $ in z){const Z=z[$],K=W[$]=W[$]||{},q=C[$]=C[$]||[];for(const J of Z)K[J.featureIndex]||(K[J.featureIndex]=!0,q.push(J))}}return C}(b);for(const A in w)w[A].forEach(C=>{const P=C.feature,k=P.layer;k&&k.type!=="background"&&k.type!=="sky"&&k.type!=="slot"&&(P.source=k.source,k["source-layer"]&&(P.sourceLayer=k["source-layer"]),P.state=P.id!==void 0?a.getFeatureState(k["source-layer"],P.id):{})});return w}function Bie(a,t){const r=a.getRenderableIds().map(h=>a.getTileByID(h)),c=[],u={};for(let h=0;h<r.length;h++){const m=r[h],g=m.tileID.canonical.key;u[g]||(u[g]=!0,m.querySourceFeatures(c,t))}return c}function e8(a,t){const r=a.tileID,c=t.tileID;return r.overscaledZ-c.overscaledZ||r.canonical.y-c.canonical.y||r.wrap-c.wrap||r.canonical.x-c.canonical.x}class Uie{constructor(t){this.style=t}processLayersChanged(){this.layers=[];for(const t in this.style._mergedLayers){const r=this.style._mergedLayers[t];if(r.type==="fill-extrusion")this.layers.push(r);else if(r.type==="model"){const c=this.style.getLayerSource(r);c&&c.type==="batched-model"&&this.layers.push(r)}}}updateZOffset(t,r){this.currentBuildingBuckets=[];for(let u=0;u<this.layers.length;++u){const h=this.layers[u],m=this.style.getLayerSourceCache(h);let g=1;h.type==="fill-extrusion"&&(g=h.paint.get("fill-extrusion-opacity")>0?h.paint.get("fill-extrusion-vertical-scale"):0);let v=m?m.getTile(r):null;if(!v&&m&&r.canonical.z>m.getSource().minzoom){let b=r.scaledTo(Math.min(m.getSource().maxzoom,r.overscaledZ-1));for(;b.overscaledZ>=m.getSource().minzoom&&(v=m.getTile(b),!v&&b.overscaledZ!==0);)b=b.scaledTo(b.overscaledZ-1)}this.currentBuildingBuckets.push({bucket:v?v.getBucket(h):null,tileID:v?v.tileID:r,verticalScale:g})}t.hasAnyZOffset=!1;let c=!1;for(let u=0;u<t.symbolInstances.length;u++){const h=t.symbolInstances.get(u),m=h.zOffset,g=this._getHeightAtTileOffset(r,h.tileAnchorX,h.tileAnchorY);h.zOffset=g!==-1?g:m,c||m===h.zOffset||(c=!0),t.hasAnyZOffset||h.zOffset===0||(t.hasAnyZOffset=!0)}c&&(t.zOffsetBuffersNeedUpload=!0,t.zOffsetSortDirty=!0)}_mapCoordToOverlappingTile(t,r,c,u){let h=r,m=c;if(t.canonical.z!==u.canonical.z){const g=u.canonical,v=1/(1<<t.canonical.z-g.z);h=(r+t.canonical.x*mt)*v-g.x*mt|0,m=(c+t.canonical.y*mt)*v-g.y*mt|0}return{tileX:h,tileY:m}}_getHeightAtTileOffset(t,r,c){let u;for(let h=0;h<this.layers.length;++h){if(this.layers[h].type!=="fill-extrusion")continue;const{bucket:m,tileID:g,verticalScale:v}=this.currentBuildingBuckets[h];if(!m)continue;const{tileX:b,tileY:w}=this._mapCoordToOverlappingTile(t,r,c,g),A=m.getHeightAtTileCoord(b,w);if(A&&A.height!==void 0){if(!A.hidden)return A.height*v;u=A.height}}for(let h=0;h<this.layers.length;++h){if(this.layers[h].type!=="model")continue;const{bucket:m,tileID:g}=this.currentBuildingBuckets[h];if(!m)continue;const{tileX:v,tileY:b}=this._mapCoordToOverlappingTile(t,r,c,g),w=m.getHeightAtTileCoord(v,b);if(w&&!w.hidden)return w.height===void 0&&u!==void 0?Math.min(w.maxHeight,u)*w.verticalScale:(w.height||0)*w.verticalScale}return-1}}var t8=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function Wie(a,t){const r={};for(const c in a)c!=="ref"&&(r[c]=a[c]);return t8.forEach(c=>{c in t&&(r[c]=t[c])}),r}function n8(a){a=a.slice();const t=Object.create(null);for(let r=0;r<a.length;r++)t[a[r].id]=a[r];for(let r=0;r<a.length;r++)"ref"in a[r]&&(a[r]=Wie(a[r],t[a[r].ref]));return a}const Bi={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setCamera:"setCamera",setLights:"setLights",setProjection:"setProjection",addImport:"addImport",removeImport:"removeImport",setImportUrl:"setImportUrl",setImportData:"setImportData"};function i8(a,t,r){r.push({command:Bi.addSource,args:[a,t[a]]})}function a8(a,t,r){t.push({command:Bi.removeSource,args:[a]}),r[a]=!0}function Vie(a,t,r,c){a8(a,r,c),i8(a,t,r)}function Gie(a,t,r){let c;for(c in a[r])if(a[r].hasOwnProperty(c)&&c!=="data"&&!Q(a[r][c],t[r][c]))return!1;for(c in t[r])if(t[r].hasOwnProperty(c)&&c!=="data"&&!Q(a[r][c],t[r][c]))return!1;return!0}function L3(a,t,r,c,u,h){let m;for(m in t=t||{},a=a||{})a.hasOwnProperty(m)&&(Q(a[m],t[m])||r.push({command:h,args:[c,m,t[m],u]}));for(m in t)t.hasOwnProperty(m)&&!a.hasOwnProperty(m)&&(Q(a[m],t[m])||r.push({command:h,args:[c,m,t[m],u]}))}function R3(a){return a.id}function k3(a,t){return a[t.id]=t,a}class Hie{constructor(t,r){this.reset(t,r)}reset(t,r){this.points=t||[],this._distances=[0];for(let c=1;c<this.points.length;c++)this._distances[c]=this._distances[c-1]+this.points[c].dist(this.points[c-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(r||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(t){if(this.points.length===1)return this.points[0];t=ae(t,0,1);let r=1,c=this._distances[r];const u=t*this.paddedLength+this.padding;for(;c<u&&r<this._distances.length;)c=this._distances[++r];const h=r-1,m=this._distances[h],g=c-m,v=g>0?(u-m)/g:0;return this.points[h].mult(1-v).add(this.points[r].mult(v))}}class r8{constructor(t,r,c){const u=this.boxCells=[],h=this.circleCells=[];this.xCellCount=Math.ceil(t/c),this.yCellCount=Math.ceil(r/c);for(let m=0;m<this.xCellCount*this.yCellCount;m++)u.push([]),h.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=t,this.height=r,this.xScale=this.xCellCount/t,this.yScale=this.yCellCount/r,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(t,r,c,u,h){this._forEachCell(r,c,u,h,this._insertBoxCell,this.boxUid++),this.boxKeys.push(t),this.bboxes.push(r),this.bboxes.push(c),this.bboxes.push(u),this.bboxes.push(h)}insertCircle(t,r,c,u){this._forEachCell(r-u,c-u,r+u,c+u,this._insertCircleCell,this.circleUid++),this.circleKeys.push(t),this.circles.push(r),this.circles.push(c),this.circles.push(u)}_insertBoxCell(t,r,c,u,h,m){this.boxCells[h].push(m)}_insertCircleCell(t,r,c,u,h,m){this.circleCells[h].push(m)}_query(t,r,c,u,h,m){if(c<0||t>this.width||u<0||r>this.height)return!h&&[];const g=[];if(t<=0&&r<=0&&this.width<=c&&this.height<=u){if(h)return!0;for(let v=0;v<this.boxKeys.length;v++)g.push({key:this.boxKeys[v],x1:this.bboxes[4*v],y1:this.bboxes[4*v+1],x2:this.bboxes[4*v+2],y2:this.bboxes[4*v+3]});for(let v=0;v<this.circleKeys.length;v++){const b=this.circles[3*v],w=this.circles[3*v+1],A=this.circles[3*v+2];g.push({key:this.circleKeys[v],x1:b-A,y1:w-A,x2:b+A,y2:w+A})}return m?g.filter(m):g}return this._forEachCell(t,r,c,u,this._queryCell,g,{hitTest:h,seenUids:{box:{},circle:{}}},m),h?g.length>0:g}_queryCircle(t,r,c,u,h){const m=t-c,g=t+c,v=r-c,b=r+c;if(g<0||m>this.width||b<0||v>this.height)return!u&&[];const w=[];return this._forEachCell(m,v,g,b,this._queryCellCircle,w,{hitTest:u,circle:{x:t,y:r,radius:c},seenUids:{box:{},circle:{}}},h),u?w.length>0:w}query(t,r,c,u,h){return this._query(t,r,c,u,!1,h)}hitTest(t,r,c,u,h){return this._query(t,r,c,u,!0,h)}hitTestCircle(t,r,c,u){return this._queryCircle(t,r,c,!0,u)}_queryCell(t,r,c,u,h,m,g,v){const b=g.seenUids,w=this.boxCells[h];if(w!==null){const C=this.bboxes;for(const P of w)if(!b.box[P]){b.box[P]=!0;const k=4*P;if(t<=C[k+2]&&r<=C[k+3]&&c>=C[k+0]&&u>=C[k+1]&&(!v||v(this.boxKeys[P]))){if(g.hitTest)return m.push(!0),!0;m.push({key:this.boxKeys[P],x1:C[k],y1:C[k+1],x2:C[k+2],y2:C[k+3]})}}}const A=this.circleCells[h];if(A!==null){const C=this.circles;for(const P of A)if(!b.circle[P]){b.circle[P]=!0;const k=3*P;if(this._circleAndRectCollide(C[k],C[k+1],C[k+2],t,r,c,u)&&(!v||v(this.circleKeys[P]))){if(g.hitTest)return m.push(!0),!0;{const z=C[k],U=C[k+1],W=C[k+2];m.push({key:this.circleKeys[P],x1:z-W,y1:U-W,x2:z+W,y2:U+W})}}}}}_queryCellCircle(t,r,c,u,h,m,g,v){const b=g.circle,w=g.seenUids,A=this.boxCells[h];if(A!==null){const P=this.bboxes;for(const k of A)if(!w.box[k]){w.box[k]=!0;const z=4*k;if(this._circleAndRectCollide(b.x,b.y,b.radius,P[z+0],P[z+1],P[z+2],P[z+3])&&(!v||v(this.boxKeys[k])))return m.push(!0),!0}}const C=this.circleCells[h];if(C!==null){const P=this.circles;for(const k of C)if(!w.circle[k]){w.circle[k]=!0;const z=3*k;if(this._circlesCollide(P[z],P[z+1],P[z+2],b.x,b.y,b.radius)&&(!v||v(this.circleKeys[k])))return m.push(!0),!0}}}_forEachCell(t,r,c,u,h,m,g,v){const b=this._convertToXCellCoord(t),w=this._convertToYCellCoord(r),A=this._convertToXCellCoord(c),C=this._convertToYCellCoord(u);for(let P=b;P<=A;P++)for(let k=w;k<=C;k++)if(h.call(this,t,r,c,u,this.xCellCount*k+P,m,g,v))return}_convertToXCellCoord(t){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(t*this.xScale)))}_convertToYCellCoord(t){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(t*this.yScale)))}_circlesCollide(t,r,c,u,h,m){const g=u-t,v=h-r,b=c+m;return b*b>g*g+v*v}_circleAndRectCollide(t,r,c,u,h,m,g){const v=(m-u)/2,b=Math.abs(t-(u+v));if(b>v+c)return!1;const w=(g-h)/2,A=Math.abs(r-(h+w));if(A>w+c)return!1;if(b<=v||A<=w)return!0;const C=b-v,P=A-w;return C*C+P*P<=c*c}}const Ju=100;class jie{constructor(t,r,c=new r8(t.width+200,t.height+200,25),u=new r8(t.width+200,t.height+200,25)){this.transform=t,this.grid=c,this.ignoredGrid=u,this.pitchfactor=Math.cos(t._pitch)*t.cameraToCenterDistance,this.screenRightBoundary=t.width+Ju,this.screenBottomBoundary=t.height+Ju,this.gridRightBoundary=t.width+200,this.gridBottomBoundary=t.height+200,this.fogState=r}placeCollisionBox(t,r,c,u,h,m,g,v){let b=c.projectedAnchorX,w=c.projectedAnchorY,A=c.projectedAnchorZ;const C=c.elevation,P=c.tileID,k=t.getProjection();if(C&&P){const[J,re,ce]=k.upVector(P.canonical,c.tileAnchorX,c.tileAnchorY),ge=k.upVectorScale(P.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;b+=J*C*ge,w+=re*C*ge,A+=ce*C*ge}const z=this.projectAndGetPerspectiveRatio(g,b,w,A,c.tileID,k.name==="globe"||!!C||this.transform.pitch>0,k),U=m*z.perspectiveRatio,W=(c.x1*r+u.x-c.padding)*U+z.point.x,$=(c.y1*r+u.y-c.padding)*U+z.point.y,Z=(c.x2*r+u.x+c.padding)*U+z.point.x,K=(c.y2*r+u.y+c.padding)*U+z.point.y,q=z.perspectiveRatio<=.55||z.occluded;return!this.isInsideGrid(W,$,Z,K)||!h&&this.grid.hitTest(W,$,Z,K,v)||q?{box:[],offscreen:!1,occluded:z.occluded}:{box:[W,$,Z,K],offscreen:this.isOffscreen(W,$,Z,K),occluded:!1}}placeCollisionCircles(t,r,c,u,h,m,g,v,b,w,A,C,P,k,z){const U=[],W=this.transform.elevation,$=t.getProjection(),Z=W?W.getAtTileOffsetFunc(z,this.transform.center.lat,this.transform.worldSize,$):null,K=new V(c.tileAnchorX,c.tileAnchorY);let{x:q,y:J,z:re}=$.projectTilePoint(K.x,K.y,z.canonical);if(Z){const[nt,We,Ge]=Z(K);q+=nt,J+=We,re+=Ge}const ce=$.name==="globe",ge=this.projectAndGetPerspectiveRatio(g,q,J,re,z,ce||!!W||this.transform.pitch>0,$),{perspectiveRatio:ve}=ge,Ce=(A?m/ve:m*ve)/io,Ae=Zc(q,J,re,v),Le=ge.signedDistanceFromCamera>0?zF(Ce,h,c.lineOffsetX*Ce,c.lineOffsetY*Ce,!1,Ae,K,c,u,v,{},W&&!A?Z:null,A&&!!W,$,z,A):null;let Se=!1,Ve=!1,Xe=!0;if(Le&&!ge.occluded){const nt=.5*P*ve+k,We=new V(-100,-100),Ge=new V(this.screenRightBoundary,this.screenBottomBoundary),ot=new Hie,{first:yt,last:pt}=Le,Rt=yt.path.length;let Ft=[];for(let nn=Rt-1;nn>=1;nn--)Ft.push(yt.path[nn]);for(let nn=1;nn<pt.path.length;nn++)Ft.push(pt.path[nn]);const St=2.5*nt;b&&(Ft=Ft.map(([nn,sn,on],cn)=>(Z&&!ce&&(on=Z(cn<Rt-1?yt.tilePath[Rt-1-cn]:pt.tilePath[cn-Rt+2])[2]),Zc(nn,sn,on,b))),Ft.some(nn=>nn[3]<=0)&&(Ft=[]));let Tt=[];if(Ft.length>0){let nn=1/0,sn=-1/0,on=1/0,cn=-1/0;for(const yn of Ft)nn=Math.min(nn,yn[0]),on=Math.min(on,yn[1]),sn=Math.max(sn,yn[0]),cn=Math.max(cn,yn[1]);sn>=We.x&&nn<=Ge.x&&cn>=We.y&&on<=Ge.y&&(Tt=[Ft.map(yn=>new V(yn[0],yn[1]))],(nn<We.x||sn>Ge.x||on<We.y||cn>Ge.y)&&(Tt=sF(Tt,We.x,We.y,Ge.x,Ge.y)))}for(const nn of Tt){ot.reset(nn,.25*nt);let sn=0;sn=ot.length<=.5*nt?1:Math.ceil(ot.paddedLength/St)+1;for(let on=0;on<sn;on++){const cn=on/Math.max(sn-1,1),yn=ot.lerp(cn),kn=yn.x+Ju,ii=yn.y+Ju;U.push(kn,ii,nt,0);const Ai=kn-nt,Yn=ii-nt,Wn=kn+nt,In=ii+nt;if(Xe=Xe&&this.isOffscreen(Ai,Yn,Wn,In),Ve=Ve||this.isInsideGrid(Ai,Yn,Wn,In),!r&&this.grid.hitTestCircle(kn,ii,nt,C)&&(Se=!0,!w))return{circles:[],offscreen:!1,collisionDetected:Se,occluded:!1}}}}return{circles:!w&&Se||!Ve?[]:U,offscreen:Xe,collisionDetected:Se,occluded:ge.occluded}}queryRenderedSymbols(t){if(t.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const r=[];let c=1/0,u=1/0,h=-1/0,m=-1/0;for(const w of t){const A=new V(w.x+Ju,w.y+Ju);c=Math.min(c,A.x),u=Math.min(u,A.y),h=Math.max(h,A.x),m=Math.max(m,A.y),r.push(A)}const g=this.grid.query(c,u,h,m).concat(this.ignoredGrid.query(c,u,h,m)),v={},b={};for(const w of g){const A=w.key;v[A.bucketInstanceId]===void 0&&(v[A.bucketInstanceId]={}),v[A.bucketInstanceId][A.featureIndex]||cz(r,[new V(w.x1,w.y1),new V(w.x2,w.y1),new V(w.x2,w.y2),new V(w.x1,w.y2)])&&(v[A.bucketInstanceId][A.featureIndex]=!0,b[A.bucketInstanceId]===void 0&&(b[A.bucketInstanceId]=[]),b[A.bucketInstanceId].push(A.featureIndex))}return b}insertCollisionBox(t,r,c,u,h){(r?this.ignoredGrid:this.grid).insert({bucketInstanceId:c,featureIndex:u,collisionGroupID:h},t[0],t[1],t[2],t[3])}insertCollisionCircles(t,r,c,u,h){const m=r?this.ignoredGrid:this.grid,g={bucketInstanceId:c,featureIndex:u,collisionGroupID:h};for(let v=0;v<t.length;v+=4)m.insertCircle(g,t[v],t[v+1],t[v+2])}projectAndGetPerspectiveRatio(t,r,c,u,h,m,g){const v=[r,c,u,1];let b=!1;u||this.transform.pitch>0?(Hi.transformMat4(v,v,t),this.fogState&&h&&g.name!=="globe"&&(b=function(C,P,k,z,U,W){const $=W.calculateFogTileMatrix(U),Z=[P,k,z];return ke.transformMat4(Z,Z,$),P3(C,ke.length(Z),W.pitch,W._fov)}(this.fogState,r,c,u,h.toUnwrapped(),this.transform)>.9)):VF(v,v,t);const w=v[3];return{point:new V((v[0]/w+1)/2*this.transform.width+Ju,(-v[1]/w+1)/2*this.transform.height+Ju),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(g)/w*.5,1.5),signedDistanceFromCamera:w,occluded:m&&v[2]>w||b}}isOffscreen(t,r,c,u){return c<Ju||t>=this.screenRightBoundary||u<Ju||r>this.screenBottomBoundary}isInsideGrid(t,r,c,u){return c>=0&&t<this.gridRightBoundary&&u>=0&&r<this.gridBottomBoundary}getViewportMatrix(){const t=rt.identity([]);return rt.translate(t,t,[-100,-100,0]),t}}function p5(a,t,r){const c=t.createTileMatrix(a,a.worldSize,r.toUnwrapped());return rt.multiply(new Float32Array(16),a.projMatrix,c)}function $ie(a,t,r){if(t.projection.name===r.projection.name)return a.projMatrix;const c=r.clone();return c.setProjection(t.projection),p5(c,t.getProjection(),a)}function f5(a,t,r){return t.name===r.projection.name?a.projMatrix:p5(r,t,a)}class o8{constructor(t,r,c,u){this.opacity=t?Math.max(0,Math.min(1,t.opacity+(t.placed?r:-r))):u&&c?1:0,this.placed=c}isHidden(){return this.opacity===0&&!this.placed}}class W1{constructor(t,r,c,u,h,m=!1){this.text=new o8(t?t.text:null,r,c,h),this.icon=new o8(t?t.icon:null,r,u,h),this.clipped=m}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class m5{constructor(t,r,c,u=!1){this.text=t,this.icon=r,this.skipFade=c,this.clipped=u}}class Yie{constructor(){this.invProjMatrix=rt.create(),this.viewportMatrix=rt.create(),this.circles=[]}}class qie{constructor(t,r,c,u,h){this.bucketInstanceId=t,this.featureIndex=r,this.sourceLayerIndex=c,this.bucketIndex=u,this.tileID=h}}class Xie{constructor(t){this.crossSourceCollisions=t,this.maxGroupID=0,this.collisionGroups={}}get(t){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[t]){const r=++this.maxGroupID;this.collisionGroups[t]={ID:r,predicate:c=>c.collisionGroupID===r}}return this.collisionGroups[t]}}function s8(a,t,r,c,u){const{horizontalAlign:h,verticalAlign:m}=n3(a),g=-(h-.5)*t,v=-(m-.5)*r,b=RP(a,c);return new V(g+b[0]*u,v+b[1]*u)}function g5(a,t,r,c,u){const h=new V(a,t);return r&&h._rotate(c?u:-u),h}class Zie{constructor(t,r,c,u,h,m){this.transform=t.clone(),this.projection=t.projection.name,this.collisionIndex=new jie(this.transform,h),this.buildingIndex=m,this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=r,this.retainedQueryData={},this.collisionGroups=new Xie(c),this.collisionCircleArrays={},this.prevPlacement=u,u&&(u.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(t,r,c,u){const h=c.getBucket(r),m=c.latestFeatureIndex;if(!h||!m||r.fqid!==h.layerIds[0])return;const g=h.layers[0].layout,v=c.collisionBoxArray,b=Math.pow(2,this.transform.zoom-c.tileID.overscaledZ),w=c.tileSize/mt,A=c.tileID.toUnwrapped();this.transform.setProjection(h.projection);const C=(P=c.tileID,k=h.getProjection(),z=this.transform,k.name===this.projection?z.calculateProjMatrix(P.toUnwrapped()):p5(z,k,P));var P,k,z;const U=g.get("text-pitch-alignment")==="map",W=g.get("text-rotation-alignment")==="map";r.compileFilter();const $=r.dynamicFilter(),Z=r.dynamicFilterNeedsFeature(),K=this.transform.calculatePixelsToTileUnitsMatrix(c),q=DF(C,c.tileID.canonical,U,W,this.transform,h.getProjection(),K);let J=null;if(U){const ge=OF(C,c.tileID.canonical,U,W,this.transform,h.getProjection(),K);J=rt.multiply([],this.transform.labelPlaneMatrix,ge)}let re=null;$&&c.latestFeatureIndex&&(re={unwrappedTileID:A,dynamicFilter:$,dynamicFilterNeedsFeature:Z,featureIndex:c.latestFeatureIndex}),this.retainedQueryData[h.bucketInstanceId]=new qie(h.bucketInstanceId,m,h.sourceLayerIndex,h.index,c.tileID);const ce={bucket:h,layout:g,posMatrix:C,textLabelPlaneMatrix:q,labelToScreenMatrix:J,clippingData:re,scale:b,textPixelRatio:w,holdingForFade:c.holdingForFade(),collisionBoxArray:v,partiallyEvaluatedTextSize:Yu(h.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:Yu(h.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(h.sourceID)};if(u)for(const ge of h.sortKeyRanges){const{sortKey:ve,symbolInstanceStart:Ce,symbolInstanceEnd:Ae}=ge;t.push({sortKey:ve,symbolInstanceStart:Ce,symbolInstanceEnd:Ae,parameters:ce})}else t.push({symbolInstanceStart:0,symbolInstanceEnd:h.symbolInstances.length,parameters:ce})}attemptAnchorPlacement(t,r,c,u,h,m,g,v,b,w,A,C,P,k,z,U,W,$){const{textOffset0:Z,textOffset1:K,crossTileID:q}=C,J=[Z,K],re=s8(t,c,u,J,h),ce=this.collisionIndex.placeCollisionBox(k,h,r,g5(re.x,re.y,m,g,this.transform.angle),A,v,b,w.predicate);if(U){const ge=k.getSymbolInstanceIconSize($,this.transform.zoom,C.placedIconSymbolIndex);if(this.collisionIndex.placeCollisionBox(k,ge,U,g5(re.x,re.y,m,g,this.transform.angle),A,v,b,w.predicate).box.length===0)return}if(ce.box.length>0){let ge;return this.prevPlacement&&this.prevPlacement.variableOffsets[q]&&this.prevPlacement.placements[q]&&this.prevPlacement.placements[q].text&&(ge=this.prevPlacement.variableOffsets[q].anchor),this.variableOffsets[q]={textOffset:J,width:c,height:u,anchor:t,textScale:h,prevAnchor:ge},this.markUsedJustification(k,t,C,z),k.allowVerticalPlacement&&(this.markUsedOrientation(k,z,C),this.placedOrientations[q]=z),{shift:re,placedGlyphBoxes:ce}}}placeLayerBucketPart(t,r,c,u){const{bucket:h,layout:m,posMatrix:g,textLabelPlaneMatrix:v,labelToScreenMatrix:b,clippingData:w,textPixelRatio:A,holdingForFade:C,collisionBoxArray:P,partiallyEvaluatedTextSize:k,partiallyEvaluatedIconSize:z,collisionGroup:U}=t.parameters,W=m.get("text-optional"),$=m.get("icon-optional"),Z=m.get("text-allow-overlap"),K=m.get("icon-allow-overlap"),q=m.get("text-rotation-alignment")==="map",J=m.get("text-pitch-alignment")==="map",re=m.get("symbol-z-order")==="viewport-y",ce=m.get("symbol-z-elevate");this.transform.setProjection(h.projection);let ge=Z&&(K||!h.hasIconData()||$),ve=K&&(Z||!h.hasTextData()||W);!h.collisionArrays&&P&&h.deserializeCollisionBoxes(P),c&&u&&h.updateCollisionDebugBuffers(this.transform.zoom,P);const Ce=(Ae,Le,Se)=>{const{crossTileID:Ve,numVerticalGlyphVertices:Xe}=Ae;if(w){const Wn={zoom:this.transform.zoom,pitch:this.transform.pitch};let In=null;if(w.dynamicFilterNeedsFeature){const Mn=this.retainedQueryData[h.bucketInstanceId];In=w.featureIndex.loadFeature({featureIndex:Ae.featureIndex,bucketIndex:Mn.bucketIndex,sourceLayerIndex:Mn.sourceLayerIndex,layoutVertexArrayOffset:0})}if(!(0,w.dynamicFilter)(Wn,In,this.retainedQueryData[h.bucketInstanceId].tileID.canonical,new V(Ae.tileAnchorX,Ae.tileAnchorY),this.transform.calculateDistanceTileData(w.unwrappedTileID)))return this.placements[Ve]=new m5(!1,!1,!1,!0),void r.add(Ve)}if(r.has(Ve))return;if(C)return void(this.placements[Ve]=new m5(!1,!1,!1));let nt=!1,We=!1,Ge=!0,ot=!1,yt=!1,pt=null,Rt={box:null,offscreen:null,occluded:null},Ft={box:null,offscreen:null,occluded:null},St=null,Tt=null,nn=null,sn=0,on=0,cn=0;Se.textFeatureIndex?sn=Se.textFeatureIndex:Ae.useRuntimeCollisionCircles&&(sn=Ae.featureIndex),Se.verticalTextFeatureIndex&&(on=Se.verticalTextFeatureIndex);const yn=Wn=>{Wn.tileID=this.retainedQueryData[h.bucketInstanceId].tileID;const In=this.transform.elevation;Wn.elevation=Ae.zOffset+(In?In.getAtTileOffset(Wn.tileID,Wn.tileAnchorX,Wn.tileAnchorY):0)},kn=Se.textBox;if(kn){yn(kn);const Wn=Mn=>{let mi=Aa.horizontal;if(h.allowVerticalPlacement&&!Mn&&this.prevPlacement){const Pi=this.prevPlacement.placedOrientations[Ve];Pi&&(this.placedOrientations[Ve]=Pi,mi=Pi,this.markUsedOrientation(h,mi,Ae))}return mi},In=(Mn,mi)=>{if(h.allowVerticalPlacement&&Xe>0&&Se.verticalTextBox){for(const Pi of h.writingModes)if(Pi===Aa.vertical?(Rt=mi(),Ft=Rt):Rt=Mn(),Rt&&Rt.box&&Rt.box.length)break}else Rt=Mn()};if(m.get("text-variable-anchor")){let Mn=m.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[Ve]){const ni=this.prevPlacement.variableOffsets[Ve];Mn.indexOf(ni.anchor)>0&&(Mn=Mn.filter(qi=>qi!==ni.anchor),Mn.unshift(ni.anchor))}const mi=(ni,qi,Ea)=>{const la=h.getSymbolInstanceTextSize(k,Ae,this.transform.zoom,Le),ta=(ni.x2-ni.x1)*la+2*ni.padding,or=(ni.y2-ni.y1)*la+2*ni.padding,Ma=Ae.hasIconTextFit&&!K?qi:null;Ma&&yn(Ma);let Fa={box:[],offscreen:!1,occluded:!1};const Xi=Z?2*Mn.length:Mn.length;for(let us=0;us<Xi;++us){const ed=this.attemptAnchorPlacement(Mn[us%Mn.length],ni,ta,or,la,q,J,A,g,U,us>=Mn.length,Ae,Le,h,Ea,Ma,k,z);if(ed&&(Fa=ed.placedGlyphBoxes,Fa&&Fa.box&&Fa.box.length)){nt=!0,pt=ed.shift;break}}return Fa};In(()=>mi(kn,Se.iconBox,Aa.horizontal),()=>{const ni=Se.verticalTextBox;return ni&&yn(ni),h.allowVerticalPlacement&&!(Rt&&Rt.box&&Rt.box.length)&&Xe>0&&ni?mi(ni,Se.verticalIconBox,Aa.vertical):{box:null,offscreen:null,occluded:null}}),Rt&&(nt=Rt.box,Ge=Rt.offscreen,ot=Rt.occluded);const Pi=Wn(!(!Rt||!Rt.box));if(!nt&&this.prevPlacement){const ni=this.prevPlacement.variableOffsets[Ve];ni&&(this.variableOffsets[Ve]=ni,this.markUsedJustification(h,ni.anchor,Ae,Pi))}}else{const Mn=(mi,Pi)=>{const ni=h.getSymbolInstanceTextSize(k,Ae,this.transform.zoom,Le),qi=this.collisionIndex.placeCollisionBox(h,ni,mi,new V(0,0),Z,A,g,U.predicate);return qi&&qi.box&&qi.box.length&&(this.markUsedOrientation(h,Pi,Ae),this.placedOrientations[Ve]=Pi),qi};In(()=>Mn(kn,Aa.horizontal),()=>{const mi=Se.verticalTextBox;return h.allowVerticalPlacement&&Xe>0&&mi?(yn(mi),Mn(mi,Aa.vertical)):{box:null,offscreen:null,occluded:null}}),Wn(!!(Rt&&Rt.box&&Rt.box.length))}}if(St=Rt,nt=St&&St.box&&St.box.length>0,Ge=St&&St.offscreen,ot=St&&St.occluded,Ae.useRuntimeCollisionCircles){const Wn=h.text.placedSymbolArray.get(Ae.centerJustifiedTextSymbolIndex>=0?Ae.centerJustifiedTextSymbolIndex:Ae.verticalPlacedTextSymbolIndex),In=y1(h.textSizeData,k,Wn),Mn=m.get("text-padding");Tt=this.collisionIndex.placeCollisionCircles(h,Z,Wn,h.lineVertexArray,h.glyphOffsetArray,In,g,v,b,c,J,U.predicate,Ae.collisionCircleDiameter*In/io,Mn,this.retainedQueryData[h.bucketInstanceId].tileID),nt=Z||Tt.circles.length>0&&!Tt.collisionDetected,Ge=Ge&&Tt.offscreen,ot=Tt.occluded}if(Se.iconFeatureIndex&&(cn=Se.iconFeatureIndex),Se.iconBox){const Wn=In=>{yn(In);const Mn=Ae.hasIconTextFit&&pt?g5(pt.x,pt.y,q,J,this.transform.angle):new V(0,0),mi=h.getSymbolInstanceIconSize(z,this.transform.zoom,Ae.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(h,mi,In,Mn,K,A,g,U.predicate)};Ft&&Ft.box&&Ft.box.length&&Se.verticalIconBox?(nn=Wn(Se.verticalIconBox),We=nn.box.length>0):(nn=Wn(Se.iconBox),We=nn.box.length>0),Ge=Ge&&nn.offscreen,yt=nn.occluded}const ii=W||Ae.numHorizontalGlyphVertices===0&&Xe===0,Ai=$||Ae.numIconVertices===0;if(ii||Ai?Ai?ii||(We=We&&nt):nt=We&&nt:We=nt=We&&nt,nt&&St&&St.box&&this.collisionIndex.insertCollisionBox(St.box,m.get("text-ignore-placement"),h.bucketInstanceId,Ft&&Ft.box&&on?on:sn,U.ID),We&&nn&&this.collisionIndex.insertCollisionBox(nn.box,m.get("icon-ignore-placement"),h.bucketInstanceId,cn,U.ID),Tt&&(nt&&this.collisionIndex.insertCollisionCircles(Tt.circles,m.get("text-ignore-placement"),h.bucketInstanceId,sn,U.ID),c)){const Wn=h.bucketInstanceId;let In=this.collisionCircleArrays[Wn];In===void 0&&(In=this.collisionCircleArrays[Wn]=new Yie);for(let Mn=0;Mn<Tt.circles.length;Mn+=4)In.circles.push(Tt.circles[Mn+0]),In.circles.push(Tt.circles[Mn+1]),In.circles.push(Tt.circles[Mn+2]),In.circles.push(Tt.collisionDetected?1:0)}const Yn=h.projection.name!=="globe";ge=ge&&(Yn||!ot),ve=ve&&(Yn||!yt),this.placements[Ve]=new m5(nt||ge,We||ve,Ge||h.justReloaded),r.add(Ve)};if(ce&&this.buildingIndex&&(this.buildingIndex.updateZOffset(h,this.retainedQueryData[h.bucketInstanceId].tileID),h.updateZOffset()),re){const Ae=h.getSortedSymbolIndexes(this.transform.angle);for(let Le=Ae.length-1;Le>=0;--Le){const Se=Ae[Le];Ce(h.symbolInstances.get(Se),Se,h.collisionArrays[Se])}h.hasAnyZOffset&&_e(`${h.layerIds[0]} layer symbol-z-elevate: symbols are not sorted by elevation if symbol-z-order is evaluated to viewport-y`)}else if(h.hasAnyZOffset){const Ae=h.getSortedIndexesByZOffset();for(let Le=0;Le<Ae.length;++Le){const Se=Ae[Le];Ce(h.symbolInstances.get(Se),Se,h.collisionArrays[Se])}}else for(let Ae=t.symbolInstanceStart;Ae<t.symbolInstanceEnd;Ae++)Ce(h.symbolInstances.get(Ae),Ae,h.collisionArrays[Ae]);if(c&&h.bucketInstanceId in this.collisionCircleArrays){const Ae=this.collisionCircleArrays[h.bucketInstanceId];rt.invert(Ae.invProjMatrix,g),Ae.viewportMatrix=this.collisionIndex.getViewportMatrix()}h.justReloaded=!1}markUsedJustification(t,r,c,u){const{leftJustifiedTextSymbolIndex:h,centerJustifiedTextSymbolIndex:m,rightJustifiedTextSymbolIndex:g,verticalPlacedTextSymbolIndex:v,crossTileID:b}=c,w=kP(r),A=u===Aa.vertical?v:w==="left"?h:w==="center"?m:w==="right"?g:-1;h>=0&&(t.text.placedSymbolArray.get(h).crossTileID=A>=0&&h!==A?0:b),m>=0&&(t.text.placedSymbolArray.get(m).crossTileID=A>=0&&m!==A?0:b),g>=0&&(t.text.placedSymbolArray.get(g).crossTileID=A>=0&&g!==A?0:b),v>=0&&(t.text.placedSymbolArray.get(v).crossTileID=A>=0&&v!==A?0:b)}markUsedOrientation(t,r,c){const u=r===Aa.horizontal||r===Aa.horizontalOnly?r:0,h=r===Aa.vertical?r:0,{leftJustifiedTextSymbolIndex:m,centerJustifiedTextSymbolIndex:g,rightJustifiedTextSymbolIndex:v,verticalPlacedTextSymbolIndex:b}=c,w=t.text.placedSymbolArray;m>=0&&(w.get(m).placedOrientation=u),g>=0&&(w.get(g).placedOrientation=u),v>=0&&(w.get(v).placedOrientation=u),b>=0&&(w.get(b).placedOrientation=h)}commit(t){this.commitTime=t,this.zoomAtLastRecencyCheck=this.transform.zoom;const r=this.prevPlacement;let c=!1;this.prevZoomAdjustment=r?r.zoomAdjustment(this.transform.zoom):0;const u=r?r.symbolFadeChange(t):1,h=r?r.opacities:{},m=r?r.variableOffsets:{},g=r?r.placedOrientations:{};for(const v in this.placements){const b=this.placements[v],w=h[v];w?(this.opacities[v]=new W1(w,u,b.text,b.icon,null,b.clipped),c=c||b.text!==w.text.placed||b.icon!==w.icon.placed):(this.opacities[v]=new W1(null,u,b.text,b.icon,b.skipFade,b.clipped),c=c||b.text||b.icon)}for(const v in h){const b=h[v];if(!this.opacities[v]){const w=new W1(b,u,!1,!1);w.isHidden()||(this.opacities[v]=w,c=c||b.text.placed||b.icon.placed)}}for(const v in m)this.variableOffsets[v]||!this.opacities[v]||this.opacities[v].isHidden()||(this.variableOffsets[v]=m[v]);for(const v in g)this.placedOrientations[v]||!this.opacities[v]||this.opacities[v].isHidden()||(this.placedOrientations[v]=g[v]);c?this.lastPlacementChangeTime=t:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=r?r.lastPlacementChangeTime:t)}updateLayerOpacities(t,r){const c=new Set;for(const u of r){const h=u.getBucket(t);h&&u.latestFeatureIndex&&t.fqid===h.layerIds[0]&&(this.updateBucketOpacities(h,c,u.collisionBoxArray),h.layers[0].layout.get("symbol-z-elevate")&&this.buildingIndex&&(this.buildingIndex.updateZOffset(h,u.tileID),h.updateZOffset()))}}updateBucketOpacities(t,r,c){t.hasTextData()&&t.text.opacityVertexArray.clear(),t.hasIconData()&&t.icon.opacityVertexArray.clear(),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexArray.clear(),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexArray.clear();const u=t.layers[0].layout,h=!!t.layers[0].dynamicFilter(),m=new W1(null,0,!1,!1,!0),g=u.get("text-allow-overlap"),v=u.get("icon-allow-overlap"),b=u.get("text-variable-anchor"),w=u.get("text-rotation-alignment")==="map",A=u.get("text-pitch-alignment")==="map",C=new W1(null,0,g&&(v||!t.hasIconData()||u.get("icon-optional")),v&&(g||!t.hasTextData()||u.get("text-optional")),!0);!t.collisionArrays&&c&&(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData())&&t.deserializeCollisionBoxes(c);const P=(z,U,W)=>{for(let $=0;$<U/4;$++)z.opacityVertexArray.emplaceBack(W)};let k=0;for(let z=0;z<t.symbolInstances.length;z++){const U=t.symbolInstances.get(z),{numHorizontalGlyphVertices:W,numVerticalGlyphVertices:$,crossTileID:Z,numIconVertices:K}=U,q=r.has(Z);let J=this.opacities[Z];q?J=m:J||(J=C,this.opacities[Z]=J),r.add(Z);const re=W>0||$>0,ce=K>0,ge=this.placedOrientations[Z],ve=ge===Aa.vertical,Ce=ge===Aa.horizontal||ge===Aa.horizontalOnly;if(!re&&!ce||J.isHidden()||k++,re){const Ae=l8(J.text);P(t.text,W,ve?O3:Ae),P(t.text,$,Ce?O3:Ae);const Le=J.text.isHidden(),{leftJustifiedTextSymbolIndex:Se,centerJustifiedTextSymbolIndex:Ve,rightJustifiedTextSymbolIndex:Xe,verticalPlacedTextSymbolIndex:nt}=U,We=t.text.placedSymbolArray,Ge=Le||ve?1:0;Se>=0&&(We.get(Se).hidden=Ge),Ve>=0&&(We.get(Ve).hidden=Ge),Xe>=0&&(We.get(Xe).hidden=Ge),nt>=0&&(We.get(nt).hidden=Le||Ce?1:0);const ot=this.variableOffsets[Z];ot&&this.markUsedJustification(t,ot.anchor,U,ge);const yt=this.placedOrientations[Z];yt&&(this.markUsedJustification(t,"left",U,yt),this.markUsedOrientation(t,yt,U))}if(ce){const Ae=l8(J.icon),{placedIconSymbolIndex:Le,verticalPlacedIconSymbolIndex:Se}=U,Ve=t.icon.placedSymbolArray,Xe=J.icon.isHidden()?1:0;Le>=0&&(P(t.icon,K,ve?O3:Ae),Ve.get(Le).hidden=Xe),Se>=0&&(P(t.icon,U.numVerticalIconVertices,Ce?O3:Ae),Ve.get(Se).hidden=Xe)}if(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData()){const Ae=t.collisionArrays[z];if(Ae){let Le=new V(0,0),Se=!0;if(Ae.textBox||Ae.verticalTextBox){if(b){const Xe=this.variableOffsets[Z];Xe?(Le=s8(Xe.anchor,Xe.width,Xe.height,Xe.textOffset,Xe.textScale),w&&Le._rotate(A?this.transform.angle:-this.transform.angle)):Se=!1}h&&(Se=!J.clipped),Ae.textBox&&D3(t.textCollisionBox.collisionVertexArray,J.text.placed,!Se||ve,Le.x,Le.y),Ae.verticalTextBox&&D3(t.textCollisionBox.collisionVertexArray,J.text.placed,!Se||Ce,Le.x,Le.y)}const Ve=Se&&!!(!Ce&&Ae.verticalIconBox);Ae.iconBox&&D3(t.iconCollisionBox.collisionVertexArray,J.icon.placed,Ve,U.hasIconTextFit?Le.x:0,U.hasIconTextFit?Le.y:0),Ae.verticalIconBox&&D3(t.iconCollisionBox.collisionVertexArray,J.icon.placed,!Ve,U.hasIconTextFit?Le.x:0,U.hasIconTextFit?Le.y:0)}}}if(t.fullyClipped=k===0,t.sortFeatures(this.transform.angle),this.retainedQueryData[t.bucketInstanceId]&&(this.retainedQueryData[t.bucketInstanceId].featureSortOrder=t.featureSortOrder),t.hasTextData()&&t.text.opacityVertexBuffer&&t.text.opacityVertexBuffer.updateData(t.text.opacityVertexArray),t.hasIconData()&&t.icon.opacityVertexBuffer&&t.icon.opacityVertexBuffer.updateData(t.icon.opacityVertexArray),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexBuffer&&t.iconCollisionBox.collisionVertexBuffer.updateData(t.iconCollisionBox.collisionVertexArray),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexBuffer&&t.textCollisionBox.collisionVertexBuffer.updateData(t.textCollisionBox.collisionVertexArray),t.bucketInstanceId in this.collisionCircleArrays){const z=this.collisionCircleArrays[t.bucketInstanceId];t.placementInvProjMatrix=z.invProjMatrix,t.placementViewportMatrix=z.viewportMatrix,t.collisionCircleArray=z.circles,delete this.collisionCircleArrays[t.bucketInstanceId]}}symbolFadeChange(t){return this.fadeDuration===0?1:(t-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(t){return Math.max(0,(this.transform.zoom-t)/1.5)}hasTransitions(t){return this.stale||t-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(t,r){const c=this.zoomAtLastRecencyCheck===r?1-this.zoomAdjustment(r):1;return this.zoomAtLastRecencyCheck=r,this.commitTime+this.fadeDuration*c>t}setStale(){this.stale=!0}}function D3(a,t,r,c,u){a.emplaceBack(t?1:0,r?1:0,c||0,u||0),a.emplaceBack(t?1:0,r?1:0,c||0,u||0),a.emplaceBack(t?1:0,r?1:0,c||0,u||0),a.emplaceBack(t?1:0,r?1:0,c||0,u||0)}const Kie=Math.pow(2,25),Jie=Math.pow(2,24),Qie=Math.pow(2,17),eae=Math.pow(2,16),tae=Math.pow(2,9),nae=Math.pow(2,8),iae=Math.pow(2,1);function l8(a){if(a.opacity===0&&!a.placed)return 0;if(a.opacity===1&&a.placed)return 4294967295;const t=a.placed?1:0,r=Math.floor(127*a.opacity);return r*Kie+t*Jie+r*Qie+t*eae+r*tae+t*nae+r*iae+t}const O3=0;class aae{constructor(t){this._sortAcrossTiles=t.layout.get("symbol-z-order")!=="viewport-y"&&t.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(t,r,c,u,h){const m=this._bucketParts;for(;this._currentTileIndex<t.length;)if(r.getBucketParts(m,u,t[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,h())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,m.sort((g,v)=>g.sortKey-v.sortKey));this._currentPartIndex<m.length;){const g=m[this._currentPartIndex];if(r.placeLayerBucketPart(g,this._seenCrossTileIDs,c,g.symbolInstanceStart===0),this._currentPartIndex++,h())return!0}return!1}}class rae{constructor(t,r,c,u,h,m,g,v,b){this.placement=new Zie(t,h,m,g,v,b),this._currentPlacementIndex=r.length-1,this._forceFullPlacement=c,this._showCollisionBoxes=u,this._done=!1}isDone(){return this._done}continuePlacement(t,r,c,u){const h=Cn.now(),m=()=>{const g=Cn.now()-h;return!this._forceFullPlacement&&g>2};for(;this._currentPlacementIndex>=0;){const g=r[t[this._currentPlacementIndex]],v=this.placement.collisionIndex.transform.zoom;if(g.type==="symbol"&&(!g.minzoom||g.minzoom<=v)&&(!g.maxzoom||g.maxzoom>v)){const b=g,w=b.layout.get("symbol-z-elevate");if(this._inProgressLayer||(this._inProgressLayer=new aae(b)),this._inProgressLayer.continuePlacement(w?u[g.source]:c[g.source],this.placement,this._showCollisionBoxes,g,m))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(t){return this.placement.commit(t),this.placement}}const c8=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class N3{static from(t){if(!(t instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[r,c]=new Uint8Array(t,0,2);if(r!==219)throw new Error("Data does not appear to be in a KDBush format.");const u=c>>4;if(u!==1)throw new Error(`Got v${u} data when expected v1.`);const h=c8[15&c];if(!h)throw new Error("Unrecognized array type.");const[m]=new Uint16Array(t,2,1),[g]=new Uint32Array(t,4,1);return new N3(g,m,h,t)}constructor(t,r=64,c=Float64Array,u){if(isNaN(t)||t<0)throw new Error(`Unpexpected numItems value: ${t}.`);this.numItems=+t,this.nodeSize=Math.min(Math.max(+r,2),65535),this.ArrayType=c,this.IndexArrayType=t<65536?Uint16Array:Uint32Array;const h=c8.indexOf(this.ArrayType),m=2*t*this.ArrayType.BYTES_PER_ELEMENT,g=t*this.IndexArrayType.BYTES_PER_ELEMENT,v=(8-g%8)%8;if(h<0)throw new Error(`Unexpected typed array class: ${c}.`);u&&u instanceof ArrayBuffer?(this.data=u,this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+g+v,2*t),this._pos=2*t,this._finished=!0):(this.data=new ArrayBuffer(8+m+g+v),this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+g+v,2*t),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+h]),new Uint16Array(this.data,2,1)[0]=r,new Uint32Array(this.data,4,1)[0]=t)}add(t,r){const c=this._pos>>1;return this.ids[c]=c,this.coords[this._pos++]=t,this.coords[this._pos++]=r,c}finish(){const t=this._pos>>1;if(t!==this.numItems)throw new Error(`Added ${t} items when expected ${this.numItems}.`);return y5(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(t,r,c,u){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:h,coords:m,nodeSize:g}=this,v=[0,h.length-1,0],b=[];for(;v.length;){const w=v.pop()||0,A=v.pop()||0,C=v.pop()||0;if(A-C<=g){for(let U=C;U<=A;U++){const W=m[2*U],$=m[2*U+1];W>=t&&W<=c&&$>=r&&$<=u&&b.push(h[U])}continue}const P=C+A>>1,k=m[2*P],z=m[2*P+1];k>=t&&k<=c&&z>=r&&z<=u&&b.push(h[P]),(w===0?t<=k:r<=z)&&(v.push(C),v.push(P-1),v.push(1-w)),(w===0?c>=k:u>=z)&&(v.push(P+1),v.push(A),v.push(1-w))}return b}within(t,r,c){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:u,coords:h,nodeSize:m}=this,g=[0,u.length-1,0],v=[],b=c*c;for(;g.length;){const w=g.pop()||0,A=g.pop()||0,C=g.pop()||0;if(A-C<=m){for(let U=C;U<=A;U++)d8(h[2*U],h[2*U+1],t,r)<=b&&v.push(u[U]);continue}const P=C+A>>1,k=h[2*P],z=h[2*P+1];d8(k,z,t,r)<=b&&v.push(u[P]),(w===0?t-c<=k:r-c<=z)&&(g.push(C),g.push(P-1),g.push(1-w)),(w===0?t+c>=k:r+c>=z)&&(g.push(P+1),g.push(A),g.push(1-w))}return v}}function y5(a,t,r,c,u,h){if(u-c<=r)return;const m=c+u>>1;u8(a,t,m,c,u,h),y5(a,t,r,c,m-1,1-h),y5(a,t,r,m+1,u,1-h)}function u8(a,t,r,c,u,h){for(;u>c;){if(u-c>600){const b=u-c+1,w=r-c+1,A=Math.log(b),C=.5*Math.exp(2*A/3),P=.5*Math.sqrt(A*C*(b-C)/b)*(w-b/2<0?-1:1);u8(a,t,r,Math.max(c,Math.floor(r-w*C/b+P)),Math.min(u,Math.floor(r+(b-w)*C/b+P)),h)}const m=t[2*r+h];let g=c,v=u;for(V1(a,t,c,r),t[2*u+h]>m&&V1(a,t,c,u);g<v;){for(V1(a,t,g,v),g++,v--;t[2*g+h]<m;)g++;for(;t[2*v+h]>m;)v--}t[2*c+h]===m?V1(a,t,c,v):(v++,V1(a,t,v,u)),v<=r&&(c=v+1),r<=v&&(u=v-1)}}function V1(a,t,r,c){v5(a,r,c),v5(t,2*r,2*c),v5(t,2*r+1,2*c+1)}function v5(a,t,r){const c=a[t];a[t]=a[r],a[r]=c}function d8(a,t,r,c){const u=a-r,h=t-c;return u*u+h*h}const _5=512/mt/2;class oae{constructor(t,r,c){this.tileID=t,this.bucketInstanceId=c,this.index=new N3(r.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];const u=t.canonical.x*mt,h=t.canonical.y*mt;for(let m=0;m<r.length;m++){const{key:g,crossTileID:v,tileAnchorX:b,tileAnchorY:w}=r.get(m),A=Math.floor((u+b)*_5),C=Math.floor((h+w)*_5);this.index.add(A,C),this.keys.push(g),this.crossTileIDs.push(v)}this.index.finish()}findMatches(t,r,c){const u=this.tileID.canonical.z<r.canonical.z?1:Math.pow(2,this.tileID.canonical.z-r.canonical.z),h=_5/Math.pow(2,r.canonical.z-this.tileID.canonical.z),m=r.canonical.x*mt,g=r.canonical.y*mt;for(let v=0;v<t.length;v++){const b=t.get(v);if(b.crossTileID)continue;const{key:w,tileAnchorX:A,tileAnchorY:C}=b,P=Math.floor((m+A)*h),k=Math.floor((g+C)*h),z=this.index.range(P-u,k-u,P+u,k+u);for(const U of z){const W=this.crossTileIDs[U];if(this.keys[U]===w&&!c.has(W)){c.add(W),b.crossTileID=W;break}}}}}class sae{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class lae{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(t){const r=Math.round((t-this.lng)/360);if(r!==0)for(const c in this.indexes){const u=this.indexes[c],h={};for(const m in u){const g=u[m];g.tileID=g.tileID.unwrapTo(g.tileID.wrap+r),h[g.tileID.key]=g}this.indexes[c]=h}this.lng=t}addBucket(t,r,c){if(this.indexes[t.overscaledZ]&&this.indexes[t.overscaledZ][t.key]){if(this.indexes[t.overscaledZ][t.key].bucketInstanceId===r.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(t.overscaledZ,this.indexes[t.overscaledZ][t.key])}for(let h=0;h<r.symbolInstances.length;h++)r.symbolInstances.get(h).crossTileID=0;this.usedCrossTileIDs[t.overscaledZ]||(this.usedCrossTileIDs[t.overscaledZ]=new Set);const u=this.usedCrossTileIDs[t.overscaledZ];for(const h in this.indexes){const m=this.indexes[h];if(Number(h)>t.overscaledZ)for(const g in m){const v=m[g];v.tileID.isChildOf(t)&&v.findMatches(r.symbolInstances,t,u)}else{const g=m[t.scaledTo(Number(h)).key];g&&g.findMatches(r.symbolInstances,t,u)}}for(let h=0;h<r.symbolInstances.length;h++){const m=r.symbolInstances.get(h);m.crossTileID||(m.crossTileID=c.generate(),u.add(m.crossTileID))}return this.indexes[t.overscaledZ]===void 0&&(this.indexes[t.overscaledZ]={}),this.indexes[t.overscaledZ][t.key]=new oae(t,r.symbolInstances,r.bucketInstanceId),!0}removeBucketCrossTileIDs(t,r){for(const c of r.crossTileIDs)this.usedCrossTileIDs[t].delete(c)}removeStaleBuckets(t){let r=!1;for(const c in this.indexes){const u=this.indexes[c];for(const h in u)t[u[h].bucketInstanceId]||(this.removeBucketCrossTileIDs(c,u[h]),delete u[h],r=!0)}return r}}class cae{constructor(){this.layerIndexes={},this.crossTileIDs=new sae,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(t,r,c,u){let h=this.layerIndexes[t.fqid];h===void 0&&(h=this.layerIndexes[t.fqid]=new lae);let m=!1;const g={};u.name!=="globe"&&h.handleWrapJump(c);for(const v of r){const b=v.getBucket(t);b&&t.fqid===b.layerIds[0]&&(b.bucketInstanceId||(b.bucketInstanceId=++this.maxBucketInstanceId),h.addBucket(v.tileID,b,this.crossTileIDs)&&(m=!0),g[b.bucketInstanceId]=!0)}return h.removeStaleBuckets(g)&&(m=!0),m}pruneUnusedLayers(t){const r={};t.forEach(c=>{r[c]=!0});for(const c in this.layerIndexes)r[c]||delete this.layerIndexes[c]}}var h8=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#define EXTENT 8192.0
#define HALF_PI PI/2.0
#define QUARTER_PI PI/4.0
#define RAD_TO_DEG 180.0/PI
#define DEG_TO_RAD PI/180.0
#define GLOBE_RADIUS EXTENT/PI/2.0
vec3 linearTosRGB(vec3 color)
{return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn)
{return pow(srgbIn,vec3(2.2));}vec3 linearProduct(vec3 srgbIn,vec3 k)
{return srgbIn*pow(k,vec3(1./2.2));}
#if __VERSION__ >=300
#define _HANDLE_WIREFRAME_DEPTH gl_FragDepth=gl_FragCoord.z-0.0001;
#else
#define _HANDLE_WIREFRAME_DEPTH
#endif
#ifdef DEBUG_WIREFRAME
#define HANDLE_WIREFRAME_DEBUG \\
gl_FragColor=vec4(0.7,0.0,0.0,0.7); \\
_HANDLE_WIREFRAME_DEPTH;
#else
#define HANDLE_WIREFRAME_DEBUG
#endif
#ifdef RENDER_CUTOFF
float cutoff_opacity(vec4 cutoff_params,float depth) {float near=cutoff_params.x;float far=cutoff_params.y;float cutoffStart=cutoff_params.z;float cutoffEnd=cutoff_params.w-0.0001;float linearDepth=(depth-near)/(far-near);return clamp((linearDepth-cutoffStart)/(cutoffEnd-cutoffStart),0.0,1.0);}
#endif`,p8="attribute highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;varying highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",f8=`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}
#else
vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif
const float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)
{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}
#ifdef TERRAIN
#ifdef TERRAIN_DEM_FLOAT_FORMAT
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;
#else
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;
#endif
uniform vec4 u_dem_unpack;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float decodeElevation(vec4 v) {return dot(vec4(v.xyz*255.0,-1.0),u_dem_unpack);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem,pos));float tr=decodeElevation(texture2D(u_dem,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem_prev,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem_prev,pos));float tr=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem_prev,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
return currentElevation(apos);}
#endif
highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture2D(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(
unpack_depth(texture2D(u_depth,uv-df.xz)),unpack_depth(texture2D(u_depth,uv+df.xz)),unpack_depth(texture2D(u_depth,uv-df.zy)),unpack_depth(texture2D(u_depth,uv+df.zy))
);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(off.x,0.0)).r;float bl=texture(u_dem,pos+vec2(0.0,off.y)).r;float br=texture(u_dem,pos+off).r;
#else
vec4 demtl=vec4(texture2D(u_dem,pos).xyz*255.0,-1.0);float tl=dot(demtl,u_dem_unpack);vec4 demtr=vec4(texture2D(u_dem,pos+vec2(off.x,0.0)).xyz*255.0,-1.0);float tr=dot(demtr,u_dem_unpack);vec4 dembl=vec4(texture2D(u_dem,pos+vec2(0.0,off.y)).xyz*255.0,-1.0);float bl=dot(dembl,u_dem_unpack);vec4 dembr=vec4(texture2D(u_dem,pos+off).xyz*255.0,-1.0);float br=dot(dembr,u_dem_unpack);
#endif
return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }
#endif`,m8=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;varying vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,g8=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump vec2 u_fog_vertical_limit;uniform mediump float u_fog_temporal_offset;varying vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,opacity);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec4 fog_apply_premultiplied(vec4 color,vec3 pos,float heightMeters) {float verticalProgress=(u_fog_vertical_limit.x > 0.0 || u_fog_vertical_limit.y > 0.0) ? smoothstep(u_fog_vertical_limit.x,u_fog_vertical_limit.y,heightMeters) : 0.0;float opacityLimit=1.0-smoothstep(0.9,1.0,fog_opacity(pos));return mix(fog_apply_premultiplied(color,pos),color,min(verticalProgress,opacityLimit));}vec3 fog_dither(vec3 color) {
#ifdef FOG_DITHERING
vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);
#else
return color;
#endif
}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`,y8=`#ifdef RENDER_SHADOWS
uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_normal_offset;vec3 shadow_normal_offset(vec3 normal) {float tileInMeters=u_shadow_normal_offset[0];vec3 n=vec3(-normal.xy,tileInMeters*normal.z);float dotScale=min(1.0-dot(normal,u_shadow_direction),1.0)*0.5+0.5;return n*dotScale;}vec3 shadow_normal_offset_model(vec3 normal) {float dotScale=min(1.0-dot(normal,u_shadow_direction),1.0)*0.5+0.5;return normal*dotScale;}float shadow_normal_offset_multiplier0() {return u_shadow_normal_offset[1];}float shadow_normal_offset_multiplier1() {return u_shadow_normal_offset[2];}
#endif//RENDER_SHADOWS`,v8=`#ifdef RENDER_SHADOWS
#if defined(NATIVE) && __VERSION__ >=300
#define TEXTURE_GATHER
#endif
#ifdef DEPTH_TEXTURE
uniform highp sampler2D u_shadowmap_0;uniform highp sampler2D u_shadowmap_1;
#else
uniform sampler2D u_shadowmap_0;uniform sampler2D u_shadowmap_1;
#endif
uniform float u_shadow_intensity;uniform float u_shadow_map_resolution;uniform float u_shadow_texel_size;uniform highp vec3 u_shadow_normal_offset;uniform vec2 u_fade_range;uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_bias;highp float shadow_sample_1(highp vec2 uv,highp float compare) {highp float shadow_depth;
#ifdef DEPTH_TEXTURE
shadow_depth=texture2D(u_shadowmap_1,uv).r;
#else
shadow_depth=unpack_depth(texture2D(u_shadowmap_1,uv))*0.5+0.5;
#endif
return step(shadow_depth,compare);}highp float shadow_sample_0(highp vec2 uv,highp float compare) {highp float shadow_depth;
#ifdef DEPTH_TEXTURE
shadow_depth=texture2D(u_shadowmap_0,uv).r;
#else
shadow_depth=unpack_depth(texture2D(u_shadowmap_0,uv))*0.5+0.5;
#endif
return step(shadow_depth,compare);}float shadow_occlusion_1(highp vec4 pos,highp float bias) {highp vec2 uv=pos.xy;return shadow_sample_1(uv,pos.z-bias);}float shadow_occlusion_0(highp vec4 pos,highp float bias) {highp float compare0=pos.z-bias;
#ifdef TEXTURE_GATHER
highp vec2 uv=pos.xy;highp vec4 samples=textureGather(u_shadowmap_0,uv,0);lowp vec4 stepSamples=step(samples,vec4(compare0));
#else
highp vec2 uv00=pos.xy-vec2(0.5*u_shadow_texel_size);highp vec2 uv10=uv00+vec2(u_shadow_texel_size,0.0);highp vec2 uv01=uv00+vec2(0.0,u_shadow_texel_size);highp vec2 uv11=uv01+vec2(u_shadow_texel_size,0.0);lowp vec4 stepSamples=vec4(
shadow_sample_0(uv01,compare0),shadow_sample_0(uv11,compare0),shadow_sample_0(uv10,compare0),shadow_sample_0(uv00,compare0)
);
#endif
vec2 f=fract(pos.xy*u_shadow_map_resolution-vec2(0.5));lowp vec2 lerpx=mix(stepSamples.wx,stepSamples.zy,f.xx);return mix(lerpx.x,lerpx.y,f.y);}float shadow_occlusion(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,highp float bias) {
#ifdef SHADOWS_SINGLE_CASCADE
light_view_pos0.xyz=light_view_pos0.xyz/light_view_pos0.w*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);
#else
light_view_pos0.xyz/=light_view_pos0.w;light_view_pos1.xyz/=light_view_pos1.w;vec4 uv=vec4(light_view_pos0.xy,light_view_pos1.xy);vec4 abs_bounds=abs(uv);if (abs_bounds.x < 1.0 && abs_bounds.y < 1.0) {light_view_pos0.xyz=light_view_pos0.xyz*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);}if (abs_bounds.z >=1.0 || abs_bounds.w >=1.0) {return 0.0;}light_view_pos1.xyz=light_view_pos1.xyz*0.5+0.5;float occlusion1=shadow_occlusion_1(light_view_pos1,bias);return mix(occlusion1,0.0,smoothstep(u_fade_range.x,u_fade_range.y,view_depth));
#endif
}highp float calculate_shadow_bias(float NDotL) {
#ifdef NORMAL_OFFSET
return 0.5*u_shadow_bias.x;
#else
return 0.5*(u_shadow_bias.x+clamp(u_shadow_bias.y*tan(acos(NDotL)),0.0,u_shadow_bias.z));
#endif
}float shadowed_light_factor_normal(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_unbiased(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return 1.0-(u_shadow_intensity*occlusion);}float shadow_occlusion(float ndotl,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=calculate_shadow_bias(ndotl);return shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);}
#endif`;const _8=[];B3(h8,_8);const z3={"_prelude_fog.vertex.glsl":m8,"_prelude_terrain.vertex.glsl":f8,"_prelude_shadow.vertex.glsl":y8,"_prelude_fog.fragment.glsl":g8,"_prelude_shadow.fragment.glsl":v8,"_prelude_lighting.glsl":`
#ifdef LIGHTING_3D_MODE
uniform mediump vec3 u_lighting_ambient_color;uniform mediump vec3 u_lighting_directional_dir;uniform mediump vec3 u_lighting_directional_color;uniform mediump vec3 u_ground_radiance;float calculate_ambient_directional_factor(vec3 normal) {float NdotL=dot(normal,u_lighting_directional_dir);const float factor_reduction_max=0.3;float dir_luminance=dot(u_lighting_directional_color,vec3(0.2126,0.7152,0.0722));float directional_factor_min=1.0-factor_reduction_max*min(dir_luminance,1.0);float ambient_directional_factor=mix(directional_factor_min,1.0,min((NdotL+1.0),1.0));const float vertical_factor_min=0.92;float vertical_factor=mix(vertical_factor_min,1.0,normal.z*0.5+0.5);return vertical_factor*ambient_directional_factor;}vec3 apply_lighting(vec3 color,vec3 normal,float dir_factor) {float ambient_directional_factor=calculate_ambient_directional_factor(normal);vec3 ambient_contrib=ambient_directional_factor*u_lighting_ambient_color;vec3 directional_contrib=u_lighting_directional_color*dir_factor;return linearProduct(color,ambient_contrib+directional_contrib);}vec4 apply_lighting(vec4 color,vec3 normal,float dir_factor) {return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting(vec3 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return apply_lighting(color.rgb,normal,dir_factor);}vec4 apply_lighting(vec4 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting_ground(vec3 color) {return color*u_ground_radiance;}vec4 apply_lighting_ground(vec4 color) {return vec4(apply_lighting_ground(color.rgb),color.a);}float calculate_NdotL(vec3 normal) {const float ext=0.70710678118;return (clamp(dot(normal,u_lighting_directional_dir),-ext,1.0)+ext)/(1.0+ext);}vec4 apply_lighting_with_emission_ground(vec4 color,float emissive_strength) {return mix(apply_lighting_ground(color),color,emissive_strength);}vec3 compute_flood_lighting(vec3 flood_light_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=flood_light_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);float occlusion_ramp=smoothstep(0.0,0.2,1.0-occlusion);return mix(fully_occluded_color,flood_light_color,occlusion_ramp);}vec3 compute_emissive_draped(vec3 unlit_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=unlit_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);return mix(fully_occluded_color,unlit_color,1.0-occlusion);}
#endif//LIGHTING_3D_MODE`},F3={};Gi("",f8),Gi(g8,m8),Gi(v8,y8);const b8=Gi(`
#if __VERSION__ >=300
#define varying in
#define gl_FragColor glFragColor
#define texture2D texture
#define textureCube texture
out vec4 glFragColor;
#endif
highp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}
#ifdef INDICATOR_CUTOUT
uniform vec2 u_indicator_cutout_centers;uniform vec4 u_indicator_cutout_params;
#endif
vec4 applyCutout(vec4 color) {
#ifdef INDICATOR_CUTOUT
float holeMinOpacity=u_indicator_cutout_params.x;float holeRadius=max(u_indicator_cutout_params.y,0.0);float holeAspectRatio=u_indicator_cutout_params.z;float fadeStart=u_indicator_cutout_params.w;float distA=distance(vec2(gl_FragCoord.x,gl_FragCoord.y*holeAspectRatio),vec2(u_indicator_cutout_centers[0],u_indicator_cutout_centers[1]*holeAspectRatio));return color*min(smoothstep(fadeStart,holeRadius,distA)+holeMinOpacity,1.0);
#else
return color;
#endif
}
#ifdef RENDER_CUTOFF
uniform highp vec4 u_cutoff_params;varying float v_cutoff_opacity;
#endif`,`
#if __VERSION__ >=300
#define attribute in
#define varying out
#define texture2D texture
#endif
float wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {
#ifndef PROJECTED_POS_ON_VIEWPORT
float tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;
#else
return vec3(0.0);
#endif
}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}
#ifdef RENDER_CUTOFF
uniform vec4 u_cutoff_params;varying float v_cutoff_opacity;
#endif
const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);//Normalized device coordinate that is not rendered.`),x8=h8,w8=`
#ifdef GL_ES
precision mediump float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`;var S8={background:Gi(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec4 u_color;uniform float u_opacity;
#ifdef LIGHTING_3D_MODE
varying vec4 v_color;
#endif
void main() {vec4 out_color;
#ifdef LIGHTING_3D_MODE
out_color=v_color;
#else
out_color=u_color;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_lighting.glsl"
attribute vec2 a_pos;uniform mat4 u_matrix;
#ifdef LIGHTING_3D_MODE
uniform mediump vec4 u_color;varying vec4 v_color;uniform float u_emissive_strength;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting_with_emission_ground(u_color,u_emissive_strength);
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:Gi(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform float u_emissive_strength;uniform sampler2D u_image;varying vec2 v_pos;void main() {vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),circle:Gi(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
uniform float u_emissive_strength;void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
gl_FragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
#ifdef PROJECTION_GLOBE_VIEW
return u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );
#else
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#endif
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);
#else 
surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);
#endif
vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;
#else
occlusion_world_center=world_center;occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
#ifdef PROJECTION_GLOBE_VIEW
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:Gi("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Gi(`#include "_prelude_fog.fragment.glsl"
uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
if (u_is_globe==0) {gl_FragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#else
pos=vec3(tilePos+extrude,elevation(tilePos));
#endif
gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:Gi(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,"attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:Gi("varying float v_placed;varying float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);gl_FragColor =mix(red,blue,step(0.5,v_placed))*0.5;gl_FragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`#include "_prelude_terrain.vertex.glsl"
attribute vec3 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;attribute float a_size_scale;attribute vec2 a_padding;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*elevation(a_anchor_pos),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:Gi("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}",`attribute vec2 a_pos_2f;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:Gi("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}",`#include "_prelude_terrain.vertex.glsl"
attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;
#endif
varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);
#else
gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);
#endif
}`),fill:Gi(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
uniform float u_emissive_strength;void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutline:Gi(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
varying vec2 v_pos;uniform float u_emissive_strength;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:Gi(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_emissive_strength;varying vec2 v_pos;varying vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;varying vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:Gi(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;uniform float u_emissive_strength;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:Gi(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
varying vec4 v_color;
#ifdef RENDER_SHADOWS
varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;
#endif
uniform lowp float u_opacity;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec2 v_ao;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
varying vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
varying highp vec3 v_normal;
#endif
uniform vec3 u_flood_light_color;uniform highp float u_vertical_scale;uniform float u_flood_light_intensity;uniform vec3 u_ground_shadow_factor;
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
varying float v_flood_radius;varying float v_has_floodlight;
#endif
varying float v_height;void main() {
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
vec3 normal=normalize(v_normal);
#endif
float z;vec4 color=v_color;
#ifdef ZERO_ROOF_RADIUS
z=float(normal.z > 0.00001);
#ifdef LIGHTING_3D_MODE
normal=mix(normal,vec3(0.0,0.0,1.0),z);
#else
color=mix(v_color,v_roof_color,z);
#endif
#endif
float h=max(0.0,v_height);float ao_shade=1.0;
#ifdef FAUX_AO
float intensity=u_ao[0];float h_floors=h/(u_ao[1]*u_vertical_scale);float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);ao_shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;
#ifdef ZERO_ROOF_RADIUS
concave*=(1.0-z);
#endif
float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);ao_shade*=mix(1.0,x_shade*x_shade*x_shade,concave);
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
color.rgb*=mix(ao_shade,1.0,v_has_floodlight);
#else
color.rgb*=ao_shade;
#endif
#else
color.rgb*=ao_shade;
#endif
#endif
#ifdef LIGHTING_3D_MODE
float flood_radiance=0.0;
#ifdef FLOOD_LIGHT
flood_radiance=(1.0-min(h/v_flood_radius,1.0))*u_flood_light_intensity*v_has_floodlight;
#endif
#ifdef RENDER_SHADOWS
#ifdef FLOOD_LIGHT
float ndotl_unclamped=dot(normal,u_shadow_direction);float ndotl=max(0.0,ndotl_unclamped);float occlusion=ndotl_unclamped < 0.0 ? 1.0 : shadow_occlusion(ndotl,v_pos_light_view_0,v_pos_light_view_1,v_depth);vec3 litColor=apply_lighting(color.rgb,normal,(1.0-u_shadow_intensity*occlusion)*ndotl);vec3 floodLitColor=compute_flood_lighting(u_flood_light_color*u_opacity,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=mix(litColor,floodLitColor,flood_radiance);
#else
float shadowed_lighting_factor=shadowed_light_factor_normal(normal,v_pos_light_view_0,v_pos_light_view_1,v_depth);color.rgb=apply_lighting(color.rgb,normal,shadowed_lighting_factor);
#endif
#else
color.rgb=apply_lighting(color.rgb,normal);
#ifdef FLOOD_LIGHT
color.rgb=mix(color.rgb,u_flood_light_color*u_opacity,flood_radiance);
#endif
#endif
color*=u_opacity;
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos,h));
#endif
#ifdef RENDER_CUTOFF
color*=v_cutoff_opacity;
#endif
#ifdef INDICATOR_CUTOUT
color=applyCutout(color);
#endif
gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_lighting.glsl"
#if __VERSION__ >=300
#ifdef RENDER_CUTOFF
invariant gl_Position;
#endif
#endif
uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
uniform highp float u_vertical_scale;varying vec4 v_color;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
varying vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
varying highp vec3 v_normal;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec2 v_ao;
#endif
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
varying float v_flood_radius;varying float v_has_floodlight;
#endif
varying float v_height;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
#pragma mapbox: define highp float flood_light_wall_radius
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize highp float flood_light_wall_radius
base*=u_vertical_scale;height*=u_vertical_scale;vec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
v_normal=normal;
#endif
base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=0.0;float c_ele;vec3 pos;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);pos=vec3(pos_nx.xy,h);
#else
h=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);h=h-ele;v_height=h;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=pos;vec3 shd_pos1=pos;
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(normal);shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
float NdotL=0.0;float colorvalue=0.0;
#ifndef LIGHTING_3D_MODE
colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);if (normal.y !=0.0) {float r=0.84;r=mix(0.7,0.98,1.0-u_lightintensity);NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#endif
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec2(mix(concave,-concave,start),y_ground);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
float is_wall=1.0-float(t > 0.0 && top_up_ny.y > 0.0);v_has_floodlight=float(flood_light_wall_radius > 0.0 && is_wall > 0.0);v_flood_radius=flood_light_wall_radius*u_vertical_scale;
#endif
v_color=vec4(color.rgb,1.0);
#else
v_color=vec4(0.0,0.0,0.0,1.0);v_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_color*=u_opacity;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
float roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color=vec4(0.0,0.0,0.0,1.0);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_roof_color*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
}`),fillExtrusionDepth:Gi(`varying highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
gl_FragColor=pack_depth(v_depth);
#endif
}`,`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_edge_radius;uniform float u_vertical_scale;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
varying highp float v_depth;void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
base*=u_vertical_scale;height*=u_vertical_scale;vec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
vec3 pos;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;float ele=elevation(pos_nx.xy);float c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;float h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base);pos=vec3(pos_nx.xy,h);
#else
pos=vec3(pos_nx.xy,t > 0.0 ? height : base);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);v_depth=gl_Position.z/gl_Position.w;}`),fillExtrusionPattern:Gi(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
varying vec3 v_normal;
#endif
varying vec2 v_pos;varying vec4 v_lighting;uniform lowp float u_opacity;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define highp float pixel_ratio
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize highp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color,normalize(v_normal))*u_opacity;
#else
out_color=out_color*v_lighting;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color);
#endif
gl_FragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_lighting.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
varying vec2 v_pos;varying vec4 v_lighting;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
varying vec3 v_normal;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define highp float pixel_ratio
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize highp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=z;vec3 p;float c_ele;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);p=vec3(pos_nx.xy,h);
#else
p=vec3(pos_nx.xy,z);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_normal=normal;
#else
v_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#endif 
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),groundShadow:Gi(`#include "_prelude_shadow.fragment.glsl"
#ifdef GL_ES
precision highp float;
#endif
uniform vec3 u_ground_shadow_factor;varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;
#ifdef FOG
varying float v_fog_opacity;
#endif
void main() {float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);vec3 shadow=mix(u_ground_shadow_factor,vec3(1.0),light);
#ifdef RENDER_CUTOFF
shadow=mix(vec3(1.0),shadow,cutoff_opacity(u_cutoff_params,v_depth));
#endif
#ifdef FOG
shadow=mix(shadow,vec3(1.0),v_fog_opacity);
#endif
#ifdef INDICATOR_CUTOUT
shadow=mix(shadow,vec3(1.0),1.0-applyCutout(vec4(1.0)).r);
#endif
gl_FragColor=vec4(shadow,1.0);}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;attribute vec2 a_pos;varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;
#ifdef FOG
varying float v_fog_opacity;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0.0,1.0);v_pos_light_view_0=u_light_matrix_0*vec4(a_pos,0.0,1.0);v_pos_light_view_1=u_light_matrix_1*vec4(a_pos,0.0,1.0);v_depth=gl_Position.w;
#ifdef FOG
v_fog_pos=fog_position(a_pos);v_fog_opacity=fog(v_fog_pos);
#endif
}`),fillExtrusionGroundEffect:Gi(`uniform highp float u_ao_pass;uniform highp float u_opacity;uniform highp float u_flood_light_intensity;uniform highp vec3 u_flood_light_color;uniform highp float u_attenuation;uniform sampler2D u_fb;uniform float u_fb_size;
#ifdef SDF_SUBPASS
varying highp vec2 v_pos;varying highp vec4 v_line_segment;varying highp float v_flood_light_radius_tile;varying highp vec2 v_ao;float line_df(highp vec2 a,highp vec2 b,highp vec2 p) {highp vec2 ba=b-a;highp vec2 pa=p-a;highp float r=clamp(dot(pa,ba)/dot(ba,ba),0.0,1.0);return length(pa-r*ba);}
#ifdef FOG
varying highp float v_fog;
#endif
#endif
void main() {
#ifdef CLEAR_SUBPASS
vec4 color=vec4(1.0);
#ifdef CLEAR_FROM_TEXTURE
color=texture2D(u_fb,gl_FragCoord.xy/vec2(u_fb_size));
#endif
gl_FragColor=color;
#else
#ifdef SDF_SUBPASS
highp float d=line_df(v_line_segment.xy,v_line_segment.zw,v_pos);highp float effect_radius=mix(v_flood_light_radius_tile,v_ao.y,u_ao_pass);d/=effect_radius;d=min(d,1.0);d=1.0-pow(1.0-d,u_attenuation);highp float effect_intensity=mix(u_flood_light_intensity,v_ao.x,u_ao_pass);highp float fog=1.0;
#ifdef FOG
fog=v_fog;
#endif
#ifdef RENDER_CUTOFF
fog*=v_cutoff_opacity;
#endif
gl_FragColor=vec4(vec3(0.0),mix(1.0,d,effect_intensity*u_opacity*fog));
#else
vec4 color=mix(vec4(u_flood_light_color,1.0),vec4(vec3(0.0),1.0),u_ao_pass);
#ifdef OVERDRAW_INSPECTOR
color=vec4(1.0);
#endif
gl_FragColor=color;HANDLE_WIREFRAME_DEBUG;
#endif
#endif
}`,`#include "_prelude_fog.vertex.glsl"
attribute highp vec4 a_pos_end;attribute highp float a_angular_offset_factor;attribute highp float a_hidden_by_landmark;
#ifdef SDF_SUBPASS
varying highp vec2 v_pos;varying highp vec4 v_line_segment;varying highp float v_flood_light_radius_tile;varying highp vec2 v_ao;
#ifdef FOG
varying highp float v_fog;
#endif
#endif
uniform highp float u_flood_light_intensity;uniform highp mat4 u_matrix;uniform highp float u_ao_pass;uniform highp float u_meter_to_tile;uniform highp float u_edge_radius;uniform highp vec2 u_ao;
#pragma mapbox: define highp float flood_light_ground_radius
const float TANGENT_CUTOFF=4.0;const float NORM=32767.0;void main() {
#pragma mapbox: initialize highp float flood_light_ground_radius
vec2 p=a_pos_end.xy;vec2 q=floor(a_pos_end.zw*0.5);vec2 start_bottom=a_pos_end.zw-q*2.0;float fl_ground_radius=flood_light_ground_radius;
#ifdef FORCE_ABS_FL_GROUND_RADIUS
fl_ground_radius=abs(flood_light_ground_radius);
#endif
float flood_radius_tile=fl_ground_radius*u_meter_to_tile;vec2 v=normalize(q-p);float ao_radius=u_ao.y/3.5;float effect_radius=mix(flood_radius_tile,ao_radius,u_ao_pass)+u_edge_radius;float angular_offset_factor=a_angular_offset_factor/NORM*TANGENT_CUTOFF;float angular_offset=angular_offset_factor*effect_radius;float top=1.0-start_bottom.y;float side=(0.5-start_bottom.x)*2.0;vec2 extrusion_parallel=v*side*mix(1.0,angular_offset,top);vec2 perp=vec2(v.y,-v.x);vec2 extrusion_perp=perp*effect_radius*top;vec3 pos=vec3(mix(q,p,start_bottom.x),0.0);pos.xy+=extrusion_parallel+extrusion_perp;
#ifdef SDF_SUBPASS
v_pos=pos.xy;v_line_segment=vec4(p,q)+perp.xyxy*u_edge_radius;v_flood_light_radius_tile=flood_radius_tile;v_ao=vec2(u_ao.x,ao_radius);
#ifdef FOG
v_fog_pos=fog_position(pos);v_fog=1.0-fog(v_fog_pos);
#endif
#endif
float hidden_by_landmark=0.0;
#ifdef HAS_CENTROID
hidden_by_landmark=a_hidden_by_landmark;
#endif
float isFloodlit=float(fl_ground_radius > 0.0 && u_flood_light_intensity > 0.0);float hidden=mix(1.0-isFloodlit,isFloodlit,u_ao_pass);hidden+=hidden_by_landmark;gl_Position=mix(u_matrix*vec4(pos,1.0),AWAY,float(hidden > 0.0));
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
}`),hillshadePrepare:Gi(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
return texture(u_image,coord).r/4.0;
#else
vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;
#endif
}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Gi(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;uniform float u_emissive_strength;void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef LIGHTING_3D_MODE
gl_FragColor=apply_lighting_with_emission_ground(gl_FragColor,u_emissive_strength);
#endif
#ifdef FOG
gl_FragColor=fog_dither(fog_apply_premultiplied(gl_FragColor,v_fog_pos));
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:Gi(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;varying vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;
#endif
float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}uniform float u_emissive_strength;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
float linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef RENDER_LINE_DASH
float sdfdist=texture2D(u_dash_image,v_tex).a;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;alpha*=linearstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);
#endif
highp vec4 out_color;
#ifdef RENDER_LINE_GRADIENT
out_color=texture2D(u_gradient_image,v_uv.xy);
#else
out_color=color;
#endif
float trimmed=1.0;
#ifdef RENDER_LINE_TRIM_OFFSET
highp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {out_color=vec4(0,0,0,0);trimmed=0.0;}}
#endif
if (u_alpha_discard_threshold !=0.0) {if (alpha < u_alpha_discard_threshold) {discard;}}
#ifdef RENDER_LINE_BORDER
float edgeBlur=(border_width+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);if (border_color.a==0.0) {    
float Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}} else {out_color.rgb=mix(border_color.rgb*border_color.a*trimmed,out_color.rgb,smoothAlpha);}}
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
out_color*=(alpha*opacity);
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color);
#endif
gl_FragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#define EXTRUDE_SCALE 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
attribute highp vec4 a_packed;
#endif
#ifdef RENDER_LINE_DASH
attribute float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;varying vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
float a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];
#ifdef RENDER_LINE_GRADIENT
highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);
#else
v_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);
#endif
#endif
#ifdef RENDER_LINE_DASH
float scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/floorwidth,(-normal.y*height+dash.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),linePattern:Gi(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;vec2 pattern_size=vec2(display_size.x/u_tile_units_to_pixels,display_size.y);float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x=mod(v_linesofar/pattern_size.x*aspect,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));vec4 color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
color=apply_lighting_ground(color);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=(alpha*opacity);
#ifdef INDICATOR_CUTOUT
color=applyCutout(color);
#endif
gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),raster:Gi(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;
#ifdef RASTER_COLOR
uniform sampler2D u_color_ramp;uniform highp vec2 u_colorization_scale;uniform highp vec4 u_colorization_mix;highp vec4 colormap (highp float value) {highp float scaled_value=value*u_colorization_scale.y+u_colorization_scale.x;highp vec2 coords=vec2(scaled_value,0.5);return texture2D(u_color_ramp,coords);}
#endif
void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);vec4 color;
#ifdef RASTER_COLOR
highp vec4 fadedColor=mix(color0,color1,u_fade_t);color=colormap(dot(vec4(fadedColor.rgb,1),u_colorization_mix));color.a*=fadedColor.a;if (color.a > 0.0) {color.rgb/=color.a;}
#else
if (color0.a > 0.0) {color0.rgb/=color0.a;}if (color1.a > 0.0) {color1.rgb/=color1.a;}color=mix(color0,color1,u_fade_t);
#endif
color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_ground(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply(out_color,v_fog_pos));
#endif
gl_FragColor=vec4(out_color*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_pos;attribute vec2 a_uv;
#else
attribute vec2 a_pos;attribute vec2 a_texture_pos;
#endif
varying vec2 v_pos0;varying vec2 v_pos1;void main() {vec2 uv;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*u_globe_matrix*vec4(a_globe_pos,1.0);uv=a_uv;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(a_globe_pos,1.0)).xyz);
#endif
#else
float w=1.0+dot(a_texture_pos,u_perspective_transform);gl_Position=u_matrix*vec4(a_pos*w,0,w);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
uv=a_texture_pos/8192.0;
#endif
v_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),symbolIcon:Gi(`#include "_prelude_lighting.glsl"
uniform sampler2D u_texture;
#ifdef ICON_TRANSITION
uniform float u_icon_transition;
#endif
varying float v_fade_opacity;varying vec2 v_tex_a;
#ifdef ICON_TRANSITION
varying vec2 v_tex_b;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float emissive_strength
lowp float alpha=opacity*v_fade_opacity;vec4 out_color;
#ifdef ICON_TRANSITION
vec4 a=texture2D(u_texture,v_tex_a)*(1.0-u_icon_transition);vec4 b=texture2D(u_texture,v_tex_b)*u_icon_transition;out_color=(a+b)*alpha;
#else
out_color=texture2D(u_texture,v_tex_a)*alpha;
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,emissive_strength);
#endif
gl_FragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef Z_OFFSET
attribute float a_z_offset;
#endif
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
#ifdef ICON_TRANSITION
attribute vec2 a_texb;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform vec3 u_up_vector;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec2 v_tex_a;
#ifdef ICON_TRANSITION
varying vec2 v_tex_b;
#endif
varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float emissive_strength
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=elevation(tile_anchor);
#ifdef Z_OFFSET
e+=a_z_offset;
#endif
vec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjected_point;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetProjected_point=u_matrix*vec4(a_globe_anchor+displacement,1);
#else
offsetProjected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);
#endif
vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetProjected_point.xy/offsetProjected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float out_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,hidden);
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,hidden);
#endif
v_tex_a=a_tex/u_texsize;
#ifdef ICON_TRANSITION
v_tex_b=a_texb/u_texsize;
#endif
v_fade_opacity=out_fade_opacity;}`),symbolSDF:Gi(`#include "_prelude_lighting.glsl"
#define SDF_PX 8.0
uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;uniform bool u_is_halo;
#if __VERSION__ >=300
flat varying float v_draw_halo;
#endif
varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;bool draw_halo;
#if __VERSION__ >=300
draw_halo=v_draw_halo > 0.0;
#else
draw_halo=u_is_halo;
#endif
if (draw_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);vec4 out_color=color*(alpha*opacity*fade_opacity);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,emissive_strength);
#endif
gl_FragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef Z_OFFSET
attribute float a_z_offset;
#endif
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform bool u_is_halo;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
#if __VERSION__ >=300
flat varying float v_draw_halo;
#endif
varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=elevation(tile_anchor);
#ifdef Z_OFFSET
e+=a_z_offset;
#endif
vec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);
#else
offsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);
#endif
vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float out_fade_opacity=interpolated_fade_opacity*projection_transition_fade;float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,hidden);
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,hidden);
#endif
float gamma_scale=gl_Position.w;
#if __VERSION__ >=300
v_draw_halo=(u_is_halo && float(gl_InstanceID)==0.0) ? 1.0 : 0.0;
#endif
v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,out_fade_opacity);}`),symbolTextAndIcon:Gi(`#include "_prelude_lighting.glsl"
#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_halo;
#if __VERSION__ >=300
flat varying float v_draw_halo;
#endif
varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;bool draw_halo;
#if __VERSION__ >=300
draw_halo=v_draw_halo > 0.0;
#else
draw_halo=u_is_halo;
#endif
if (draw_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);vec4 out_color=color*(alpha*opacity*fade_opacity);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,emissive_strength);
#endif
gl_FragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef Z_OFFSET
attribute float a_z_offset;
#endif
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;uniform bool u_is_halo;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
#if __VERSION__ >=300
flat varying float v_draw_halo;
#endif
varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=elevation(tile_anchor);
#ifdef Z_OFFSET
e+=a_z_offset;
#endif
vec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offset_projected_point=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offset_projected_point.xy/offset_projected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*font_scale);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
float out_fade_opacity=interpolated_fade_opacity*projection_transition_fade;float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,hidden);
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,hidden);
#endif
float gamma_scale=gl_Position.w;
#if __VERSION__ >=300
v_draw_halo=(u_is_halo && float(gl_InstanceID)==0.0) ? 1.0 : 0.0;
#endif
v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,out_fade_opacity,is_sdf);}`),terrainRaster:Gi(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;
#endif
uniform vec3 u_ground_shadow_factor;void main() {vec4 image_color=texture2D(u_image0,v_pos0);vec4 color;
#ifdef LIGHTING_3D_MODE
const vec3 normal=vec3(0.0,0.0,1.0);
#ifdef RENDER_SHADOWS
float cutoffOpacity=1.0;
#ifdef RENDER_CUTOFF
cutoffOpacity=cutoff_opacity(u_cutoff_params,v_depth);
#endif
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
vec3 unlit_base=image_color.rgb*(1.0-image_color.a);vec3 emissive_base=image_color.rgb*image_color.a;float ndotl=u_shadow_direction.z;float occlusion=ndotl < 0.0 ? 1.0 : shadow_occlusion(v_pos_light_view_0,v_pos_light_view_1,v_depth,0.0);ndotl=max(0.0,ndotl);vec3 lit=apply_lighting(unlit_base,normal,mix(1.0,(1.0-(u_shadow_intensity*occlusion))*ndotl,cutoffOpacity));vec3 emissive=compute_emissive_draped(emissive_base,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=lit+emissive;color.a=1.0;
#else
float lighting_factor=shadowed_light_factor_normal_unbiased(normal,v_pos_light_view_0,v_pos_light_view_1,v_depth);color=apply_lighting(image_color,normal,mix(1.0,lighting_factor,cutoffOpacity));
#endif
#else
float lighting_factor=u_lighting_directional_dir.z;color=apply_lighting(image_color,normal,lighting_factor);
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color.rgb=mix(color.rgb,image_color.rgb,image_color.a);color.a=1.0;
#endif
#endif
#else
color=image_color;
#endif
#ifdef FOG
#ifdef ZERO_EXAGGERATION
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#else
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
#endif
gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_skirt_height;attribute vec2 a_pos;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;
#endif
void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;v_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
#ifdef ZERO_EXAGGERATION
v_fog_pos=fog_position(decodedPos);
#else
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
#endif
#ifdef RENDER_SHADOWS
vec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);v_depth=gl_Position.w;
#endif
}`),terrainDepth:Gi(`#ifdef GL_ES
precision highp float;
#endif
varying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}`,`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;attribute vec2 a_pos;varying float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}`),skybox:Gi(`#include "_prelude_fog.fragment.glsl"
varying lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=textureCube(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);gl_FragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,p8),skyboxGradient:Gi(`#include "_prelude_fog.fragment.glsl"
varying highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture2D(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,p8),skyboxCapture:Gi(`
varying highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;
#ifdef GL_ES
precision highp float;
#endif
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;gl_FragColor=vec4(color,1.0);}`,"attribute highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;varying highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:Gi(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;varying vec2 v_pos0;
#ifndef FOG
uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;
#endif
void main() {vec4 color;
#ifdef CUSTOM_ANTIALIASING
vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture2D(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
raster=apply_lighting_with_emission_ground(raster,raster.a);color=vec4(raster.rgb*antialias,antialias);
#else
raster=apply_lighting_ground(raster);color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=texture2D(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color=apply_lighting_with_emission_ground(color,color.a);color.a=1.0;
#else
color=apply_lighting_ground(color);
#endif
#endif
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;
#ifdef GLOBE_POLES
attribute vec3 a_globe_pos;attribute vec2 a_uv;
#else
attribute vec2 a_pos;
#endif
varying vec2 v_pos0;float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(QUARTER_PI+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}void main() {
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;vec2 uv=a_uv;
#else
float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);
#endif
v_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;
#ifdef GLOBE_POLES
vec3 up_vector=globe_derived_up_vector;
#else
vec3 up_vector=elevationVector(tile_pos);
#endif
float height=elevation(tile_pos);globe_pos+=up_vector*height;
#ifndef GLOBE_POLES
globe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;
#endif
#ifdef GLOBE_POLES
vec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);
#else
vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);
#endif
gl_Position=u_proj_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
}`),globeAtmosphere:Gi(`#include "_prelude_fog.fragment.glsl"
uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec4 u_color;uniform vec4 u_high_color;uniform vec4 u_space_color;uniform float u_horizon_angle;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;
#ifdef PROJECTION_GLOBE_VIEW
globe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {
#ifdef ALPHA_PASS
gl_FragColor=vec4(0,0,0,0);return;
#else
#ifdef NATIVE
gl_FragColor=vec4(1,1,1,1);
#else
gl_FragColor=vec4(0,0,0,1);
#endif
return;
#endif
}
#endif
highp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?
0.0 : max(acos(clamp(dot(dir,horizon_dir),-1.0,1.0)),0.0);float horizon_angle;
#ifdef PROJECTION_GLOBE_VIEW
highp vec3 closest_point=globe_pos_dot_dir*dir;highp float closest_point_to_center=length(closest_point-u_globe_pos);highp float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?
PI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);
#else
horizon_angle=horizon_angle_mercator;
#endif
horizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;
#ifdef ALPHA_PASS
float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);gl_FragColor=vec4(1.0,1.0,1.0,a);
#else
vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c=c2;
#ifndef NATIVE
c=dither(c,gl_FragCoord.xy+u_temporal_offset);
#endif
gl_FragColor=vec4(c*t,t);
#endif
}`,`attribute vec3 a_pos;attribute vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(
mix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}`),model:Gi(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_opacity;uniform vec3 u_lightcolor;uniform vec3 u_lightpos;uniform float u_lightintensity;uniform vec4 u_baseColorFactor;uniform vec4 u_emissiveFactor;uniform float u_metallicFactor;uniform float u_roughnessFactor;uniform float u_emissive_strength;varying highp vec4 v_position_height;varying lowp vec4 v_color_mix;
#ifdef RENDER_SHADOWS
varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth_shadows;
#endif
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#ifdef HAS_ATTRIBUTE_a_pbr
varying lowp vec4 v_roughness_metallic_emissive_alpha;varying mediump vec4 v_height_based_emission_params;
#endif
#ifdef HAS_TEXTURE_u_baseColorTexture
uniform sampler2D u_baseColorTexture;uniform bool u_baseTextureIsAlpha;uniform bool u_alphaMask;uniform float u_alphaCutoff;
#endif
#ifdef HAS_TEXTURE_u_metallicRoughnessTexture
uniform sampler2D u_metallicRoughnessTexture;
#endif
#ifdef HAS_TEXTURE_u_occlusionTexture
uniform sampler2D u_occlusionTexture;uniform float u_aoIntensity;
#endif
#ifdef HAS_TEXTURE_u_normalTexture
uniform sampler2D u_normalTexture;
#endif
#ifdef HAS_TEXTURE_u_emissionTexture
uniform sampler2D u_emissionTexture;
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
varying highp float v_depth;uniform sampler2D u_depthTexture;uniform vec2 u_inv_depth_size;bool isOccluded() {vec2 coord=gl_FragCoord.xy*u_inv_depth_size;highp float depth=unpack_depth(texture2D(u_depthTexture,coord));return v_depth > depth+0.0005;}
#endif
const float M_PI=3.141592653589793;
#define saturate(_x) clamp(_x,0.,1.)
float calculate_NdotL(vec3 normal,vec3 lightDir) {const float ext=0.70710678118;return (clamp(dot(normal,lightDir),-ext,1.0)+ext)/(1.0+ext);}vec3 getDiffuseShadedColor(vec3 albedo,vec3 normal,vec3 lightDir,vec3 lightColor)
{
#ifdef LIGHTING_3D_MODE
vec3 transformed_normal=vec3(-normal.xy,normal.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=saturate(dot(transformed_normal,u_lighting_directional_dir));
#endif
return apply_lighting(albedo,transformed_normal,lighting_factor);
#else
vec3 n=normal;float colorvalue=((albedo.x*0.2126)+(albedo.y*0.7152))+(albedo.z*0.0722);vec3 c=vec3(0.03,0.03,0.03);float directional=clamp(dot(n,vec3(lightDir)),0.0,1.0);directional=mix(1.0-u_lightintensity,max((1.0-colorvalue)+u_lightintensity,1.0),directional);vec3 c3=c+clamp((albedo*directional)*lightColor,mix(vec3(0.0),vec3(0.3),vec3(1.0)-lightColor),vec3(1.0));return c3;
#endif
}vec4 getBaseColor() {vec4 albedo=u_baseColorFactor;
#ifdef HAS_ATTRIBUTE_a_color_3f
albedo*=vec4(color_3f,1.0);
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#else
#ifdef HAS_ATTRIBUTE_a_color_4f
albedo*=color_4f;
#endif
#endif
#if defined (HAS_TEXTURE_u_baseColorTexture) && defined (HAS_ATTRIBUTE_a_uv_2f)
vec4 texColor=texture2D(u_baseColorTexture,uv_2f);if(u_alphaMask) {if (texColor.w < u_alphaCutoff) {discard;}}
#ifdef UNPREMULT_TEXTURE_IN_SHADER
if(texColor.w > 0.0) {texColor.rgb/=texColor.w;}texColor.w=1.0;
#endif
texColor.rgb=sRGBToLinear(texColor.rgb);if(u_baseTextureIsAlpha) {if (texColor.w < 0.5) {discard;}albedo*=mix(vec4(texColor.rgb,texColor.a),vec4(texColor.a),float(u_baseTextureIsAlpha));} else {albedo*=texColor;}
#endif
return vec4(mix(albedo.rgb,v_color_mix.rgb,v_color_mix.a),albedo.a);}highp mat3 cotangentFrame(highp vec3 N,highp vec3 p,highp vec2 uv ) {
#ifdef HAS_TEXTURE_u_normalTexture
highp vec3 dp1=vec3(dFdx(p.x),dFdx(p.y),dFdx(p.z));highp vec3 dp2=vec3(dFdy(p.x),dFdy(p.y),dFdy(p.z));highp vec2 duv1=vec2(dFdx(uv.x),dFdx(uv.y));highp vec2 duv2=vec2(dFdy(uv.x),dFdy(uv.y));highp vec3 dp2perp=cross( dp2,N );highp vec3 dp1perp=cross( N,dp1 );highp vec3 T=dp2perp*duv1.x+dp1perp*duv2.x;highp vec3 B=dp2perp*duv1.y+dp1perp*duv2.y;highp float lengthT=dot(T,T);highp float lengthB=dot(B,B);highp float maxLength=max(lengthT,lengthB);highp float invmax=inversesqrt( maxLength );highp mat3 res=mat3( T*invmax,B*invmax,N );return res;
#else
return mat3(1.0);
#endif
}highp vec3 getNormal(){highp vec3 n;
#ifdef HAS_ATTRIBUTE_a_normal_3f
n=normalize(normal_3f);
#else
highp vec3 fdx=vec3(dFdx(v_position_height.x),dFdx(v_position_height.y),dFdx(v_position_height.z));highp vec3 fdy=vec3(dFdy(v_position_height.x),dFdy(v_position_height.y),dFdy(v_position_height.z));n=normalize(cross(fdx,fdy))*-1.0;
#endif
#if defined(HAS_TEXTURE_u_normalTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
vec3 nMap=texture2D( u_normalTexture,uv_2f).xyz;nMap=normalize(2.0*nMap-vec3(1.0));highp vec3 v=normalize(-v_position_height.xyz);highp mat3 TBN=cotangentFrame(n,v,uv_2f);n=normalize(TBN*nMap);
#endif
return n;}struct Material {float perceptualRoughness;float alphaRoughness;float metallic;vec3 f90;vec4 baseColor;vec3 diffuseColor;vec3 specularColor;highp vec3 normal;};Material getPBRMaterial() {Material mat;mat.baseColor=getBaseColor();mat.perceptualRoughness=u_roughnessFactor;mat.metallic=u_metallicFactor;
#ifdef HAS_ATTRIBUTE_a_pbr
mat.perceptualRoughness=v_roughness_metallic_emissive_alpha.x;mat.metallic=v_roughness_metallic_emissive_alpha.y;mat.baseColor.w*=v_roughness_metallic_emissive_alpha.w;
#endif
#if defined(HAS_TEXTURE_u_metallicRoughnessTexture) && defined(HAS_ATTRIBUTE_a_uv_2f) 
vec4 mrSample=texture2D(u_metallicRoughnessTexture,uv_2f);mat.perceptualRoughness*=mrSample.g;mat.metallic*=mrSample.b;
#endif
const float c_minRoughness=0.04;mat.perceptualRoughness=clamp(mat.perceptualRoughness,c_minRoughness,1.0);mat.metallic=saturate(mat.metallic);mat.alphaRoughness=mat.perceptualRoughness*mat.perceptualRoughness;const vec3 f0=vec3(0.04);mat.diffuseColor=mat.baseColor.rgb*(vec3(1.0)-f0);mat.diffuseColor*=1.0-mat.metallic;mat.specularColor=mix(f0,mat.baseColor.rgb,mat.metallic);highp float reflectance=max(max(mat.specularColor.r,mat.specularColor.g),mat.specularColor.b);highp float reflectance90=saturate(reflectance*25.0);mat.f90=vec3(reflectance90);mat.normal=getNormal();return mat;}float V_GGX(float NdotL,float NdotV,float roughness)
{float a2=roughness*roughness;float GGXV=NdotL*sqrt(NdotV*NdotV*(1.0-a2)+a2);float GGXL=NdotV*sqrt(NdotL*NdotL*(1.0-a2)+a2);return 0.5/(GGXV+GGXL);}float V_GGXFast(float NdotL,float NdotV,float roughness) {float a=roughness;float GGXV=NdotL*(NdotV*(1.0-a)+a);float GGXL=NdotV*(NdotL*(1.0-a)+a);return 0.5/(GGXV+GGXL);}vec3 F_Schlick(vec3 specularColor,vec3 f90,float VdotH)
{return specularColor+(f90-specularColor)*pow(clamp(1.0-VdotH,0.0,1.0),5.0);}vec3 F_SchlickFast(vec3 specularColor,float VdotH)
{float x=1.0-VdotH;float x4=x*x*x*x;return specularColor+(1.0-specularColor)*x4*x;}float D_GGX(highp float NdotH,float alphaRoughness)
{highp float a4=alphaRoughness*alphaRoughness;highp float f=(NdotH*a4-NdotH)*NdotH+1.0;return a4/(M_PI*f*f);}vec3 diffuseBurley(Material mat,float LdotH,float NdotL,float NdotV)
{float f90=2.0*LdotH*LdotH*mat.alphaRoughness-0.5;return (mat.diffuseColor/M_PI)*(1.0+f90*pow((1.0-NdotL),5.0))*(1.0+f90*pow((1.0-NdotV),5.0));}vec3 diffuseLambertian(Material mat)
{
#ifdef LIGHTING_3D_MODE
return mat.diffuseColor;
#else
return mat.diffuseColor/M_PI;
#endif
}vec3 EnvBRDFApprox(vec3 specularColor,float roughness,highp float NdotV)
{vec4 c0=vec4(-1,-0.0275,-0.572,0.022);vec4 c1=vec4(1,0.0425,1.04,-0.04);highp vec4 r=roughness*c0+c1;highp float a004=min(r.x*r.x,exp2(-9.28*NdotV))*r.x+r.y;vec2 AB=vec2(-1.04,1.04)*a004+r.zw;return specularColor*AB.x+AB.y;}vec3 computeIndirectLightContribution(Material mat,float NdotV,vec3 normal)
{vec3 env_light=vec3(0.65,0.65,0.65);
#ifdef LIGHTING_3D_MODE
float ambient_factor=calculate_ambient_directional_factor(normal);env_light=u_lighting_ambient_color*ambient_factor;
#endif
vec3 envBRDF=EnvBRDFApprox(mat.specularColor,mat.perceptualRoughness,NdotV);vec3 indirectSpecular= envBRDF*env_light;vec3 indirectDiffuse=mat.diffuseColor*env_light;return indirectSpecular+indirectDiffuse;}vec3 computeLightContribution(Material mat,vec3 lightPosition,vec3 lightColor)
{highp vec3 n=mat.normal;highp vec3 v=normalize(-v_position_height.xyz);highp vec3 l=normalize(lightPosition);highp vec3 h=normalize(v+l);float NdotV=clamp(abs(dot(n,v)),0.001,1.0);float NdotL=saturate(dot(n,l));highp float NdotH=saturate(dot(n,h));float VdotH=saturate(dot(v,h));vec3 f=F_SchlickFast(mat.specularColor,VdotH);float g=V_GGXFast(NdotL,NdotV,mat.alphaRoughness);float d=D_GGX(NdotH,mat.alphaRoughness);vec3 diffuseTerm=(1.0-f)*diffuseLambertian(mat);vec3 specularTerm=f*g*d;vec3 transformed_normal=vec3(-n.xy,n.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=NdotL;
#endif
vec3 directLightColor=(specularTerm+diffuseTerm)*lighting_factor*lightColor;vec3 indirectLightColor=computeIndirectLightContribution(mat,NdotV,transformed_normal);vec3 color=(saturate(directLightColor)+indirectLightColor);float intensityFactor=1.0;
#if !defined(LIGHTING_3D_MODE)
const vec3 luminosityFactor=vec3(0.2126,0.7152,0.0722);float luminance=dot(diffuseTerm,luminosityFactor);intensityFactor=mix((1.0-u_lightintensity),max((1.0-luminance+u_lightintensity),1.0),NdotL);
#endif
color*=intensityFactor;return color;}void main() {
#ifdef TERRAIN_FRAGMENT_OCCLUSION
if (isOccluded()) {discard;}
#endif
vec3 lightDir=u_lightpos;vec3 lightColor=u_lightcolor;
#ifdef LIGHTING_3D_MODE
lightDir=u_lighting_directional_dir;lightDir.xy=-lightDir.xy;lightColor=u_lighting_directional_color;
#endif
vec4 finalColor;
#ifdef DIFFUSE_SHADED
vec3 N=getNormal();vec3 diffuse=getDiffuseShadedColor(getBaseColor().rgb,N,lightDir,lightColor);
#ifdef HAS_TEXTURE_u_occlusionTexture
float ao=(texture2D(u_occlusionTexture,uv_2f).r-1.0)*u_aoIntensity+1.0;diffuse*=ao;
#endif
finalColor=vec4(diffuse,1.0)*u_opacity;
#else
Material mat=getPBRMaterial();vec3 color=computeLightContribution(mat,lightDir,lightColor);
#if defined (HAS_TEXTURE_u_occlusionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
float ao=(texture2D(u_occlusionTexture,uv_2f).x-1.0)*u_aoIntensity+1.0;color*=ao;
#endif
vec4 emissive=u_emissiveFactor;
#if defined(HAS_TEXTURE_u_emissionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
emissive.rgb*=sRGBToLinear(texture2D(u_emissionTexture,uv_2f).rgb);
#endif
color+=emissive.rgb;float opacity=mat.baseColor.w*u_opacity;
#ifdef HAS_ATTRIBUTE_a_pbr
float resEmission=v_roughness_metallic_emissive_alpha.z;resEmission*=v_height_based_emission_params.z+v_height_based_emission_params.w*pow(clamp(v_height_based_emission_params.x,0.0,1.0),v_height_based_emission_params.y);color=mix(color,v_color_mix.rgb,min(1.0,resEmission));
#ifdef HAS_ATTRIBUTE_a_color_4f
float distance=length(vec2(1.3*max(0.0,abs(color_4f.x)-color_4f.z),color_4f.y));distance+= mix(0.5,0.0,clamp(resEmission-1.0,0.0,1.0));opacity*=v_roughness_metallic_emissive_alpha.w*saturate(1.0-distance*distance);
#endif
#endif
color=mix(color,mat.baseColor.rgb,u_emissive_strength);color=linearTosRGB(color);color*=opacity;finalColor=vec4(color,opacity);
#endif
#ifdef FOG
finalColor=fog_dither(fog_apply_premultiplied(finalColor,v_fog_pos,v_position_height.w));
#endif
#ifdef RENDER_CUTOFF
finalColor*=v_cutoff_opacity;
#endif
#ifdef INDICATOR_CUTOUT
finalColor=applyCutout(finalColor);
#endif
gl_FragColor=finalColor;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
attribute vec3 a_pos_3f;
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute-vertex-shader-only highp vec4 pbr
#pragma mapbox: define-attribute-vertex-shader-only highp vec3 heightBasedEmissiveStrength
uniform mat4 u_matrix;uniform mat4 u_lighting_matrix;uniform vec3 u_camera_pos;uniform vec4 u_color_mix;
#ifdef INSTANCED_ARRAYS
attribute vec4 a_normal_matrix0;attribute vec4 a_normal_matrix1;attribute vec4 a_normal_matrix2;attribute vec4 a_normal_matrix3;
#else
uniform highp mat4 u_normal_matrix;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth_shadows;
#endif
varying vec4 v_position_height;varying lowp vec4 v_color_mix;
#ifdef TERRAIN_FRAGMENT_OCCLUSION
varying highp float v_depth;
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
varying lowp vec4 v_roughness_metallic_emissive_alpha;varying mediump vec4 v_height_based_emission_params;
#endif
void main() {
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute-custom highp vec4 pbr
#pragma mapbox: initialize-attribute-custom highp vec3 heightBasedEmissiveStrength
highp mat4 normal_matrix;
#ifdef INSTANCED_ARRAYS
normal_matrix=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
normal_matrix=u_normal_matrix;
#endif
vec3 local_pos;mat3 rs;
#ifdef MODEL_POSITION_ON_GPU
vec3 pos_color=normal_matrix[0].xyz;vec4 translate=normal_matrix[1];vec3 pos_a=floor(pos_color);vec3 rgb=1.05*(pos_color-pos_a);float color_mix=pos_a.z/100.0;v_color_mix=vec4(sRGBToLinear(rgb),color_mix);float meter_to_tile=normal_matrix[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);rs[0].x=normal_matrix[1].w;rs[0].yz=normal_matrix[2].xy;rs[1].xy=normal_matrix[2].zw;rs[1].z=normal_matrix[3].x;rs[2].xyz=normal_matrix[3].yzw;vec4 pos_node=u_lighting_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;local_pos=pos.xyz;gl_Position=u_matrix*pos;pos.z*=meter_to_tile;v_position_height.xyz=pos.xyz-u_camera_pos;
#else
local_pos=a_pos_3f;gl_Position=u_matrix*vec4(a_pos_3f,1);v_position_height.xyz=vec3(u_lighting_matrix*vec4(a_pos_3f,1));v_color_mix=vec4(sRGBToLinear(u_color_mix.rgb),u_color_mix.a);
#endif
v_position_height.w=a_pos_3f.z;
#ifdef HAS_ATTRIBUTE_a_pbr
vec4 albedo_c=decode_color(pbr.xy);vec2 e_r_m=unpack_float(pbr.z);vec2 r_m= unpack_float(e_r_m.y*16.0);r_m.r=r_m.r*16.0;v_color_mix=vec4(albedo_c.rgb,1.0);v_roughness_metallic_emissive_alpha=vec4(vec3(r_m,e_r_m.x)/255.0,albedo_c.a);v_roughness_metallic_emissive_alpha.z*=2.0;float heightBasedRelativeIntepolation=a_pos_3f.z*heightBasedEmissiveStrength.x+heightBasedEmissiveStrength.y;v_height_based_emission_params.x=heightBasedRelativeIntepolation;v_height_based_emission_params.y=heightBasedEmissiveStrength.z;vec2 emissionMultiplierValues=unpack_float(pbr.w)/256.0;v_height_based_emission_params.z=emissionMultiplierValues.x;v_height_based_emission_params.w=emissionMultiplierValues.y-emissionMultiplierValues.x;
#endif
#ifdef FOG
v_fog_pos=fog_position(local_pos);
#endif
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
float x_squared_scale=dot(rs[0],rs[0]);float y_squared_scale=dot(rs[1],rs[1]);float z_squared_scale=dot(rs[2],rs[2]);vec3 squared_scale=vec3(x_squared_scale,y_squared_scale,z_squared_scale);normal_3f=rs*((u_lighting_matrix*vec4(normal_3f,0.0)).xyz/squared_scale);normal_3f=normalize(normal_3f);
#else
normal_3f=vec3(normal_matrix*vec4(normal_3f,0));
#endif
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#ifdef HAS_ATTRIBUTE_a_color_4f
v_roughness_metallic_emissive_alpha.w=clamp(color_4f.a*v_roughness_metallic_emissive_alpha.w*(v_roughness_metallic_emissive_alpha.z-1.0),0.0,1.0);
#endif
#endif
#ifdef RENDER_SHADOWS
vec3 shadow_pos=local_pos;
#ifdef NORMAL_OFFSET
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
vec3 offset=shadow_normal_offset(vec3(-normal_3f.xy,normal_3f.z));shadow_pos+=offset*shadow_normal_offset_multiplier0();
#else
vec3 offset=shadow_normal_offset_model(normalize(normal_3f));shadow_pos+=offset*shadow_normal_offset_multiplier0();
#endif
#endif
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shadow_pos,1);v_pos_light_view_1=u_light_matrix_1*vec4(shadow_pos,1);v_depth_shadows=gl_Position.w;
#endif
}`),modelDepth:Gi(`varying highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
gl_FragColor=pack_depth(v_depth);
#endif
}`,`attribute vec3 a_pos_3f;uniform mat4 u_matrix;varying highp float v_depth;
#ifdef MODEL_POSITION_ON_GPU
#ifdef INSTANCED_ARRAYS
attribute vec4 a_normal_matrix0;attribute vec4 a_normal_matrix1;attribute vec4 a_normal_matrix2;attribute vec4 a_normal_matrix3;
#else
uniform highp mat4 u_instance;
#endif
uniform highp mat4 u_node_matrix;
#endif
void main() {
#ifdef MODEL_POSITION_ON_GPU
highp mat4 instance;
#ifdef INSTANCED_ARRAYS
instance=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
instance=u_instance;
#endif
vec3 pos_color=instance[0].xyz;vec4 translate=instance[1];vec3 pos_a=floor(pos_color);float meter_to_tile=instance[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);mat3 rs;rs[0].x=instance[1].w;rs[0].yz=instance[2].xy;rs[1].xy=instance[2].zw;rs[1].z=instance[3].x;rs[2].xyz=instance[3].yzw;vec4 pos_node=u_node_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;gl_Position=u_matrix*pos;
#else
gl_Position=u_matrix*vec4(a_pos_3f,1);
#endif
v_depth=gl_Position.z/gl_Position.w;}`),stars:Gi(`varying highp vec2 v_uv;varying mediump float v_intensity;float shapeCircle(in vec2 uv)
{float beginFade=0.6;float lengthFromCenter=length(v_uv);return 1.0-clamp((lengthFromCenter-beginFade)/(1.0-beginFade),0.0,1.0);}void main() {float alpha=shapeCircle(v_uv);vec3 color=vec3(1.0,1.0,1.0);alpha*=v_intensity;gl_FragColor=vec4(color*alpha,alpha);HANDLE_WIREFRAME_DEBUG;}`,`
attribute vec3 a_pos_3f;attribute vec2 a_uv;attribute float a_size_scale;attribute float a_fade_opacity;uniform mat4 u_matrix;uniform vec3 u_up;uniform vec3 u_right;uniform float u_intensity_multiplier;varying highp vec2 v_uv;varying mediump float v_intensity;void main() {v_uv=a_uv;v_intensity=a_fade_opacity*u_intensity_multiplier;vec3 pos=a_pos_3f;pos+=a_uv.x*u_right*a_size_scale;pos+=a_uv.y*u_up*a_size_scale;gl_Position=u_matrix*vec4(pos,1.0);}`)};function B3(a,t){const r=a.replace(/\s*\/\/[^\n]*\n/g,`
`).split(`
`);for(let c of r)if(c=c.trim(),c[0]==="#"&&c.includes("if")&&!c.includes("endif")){c=c.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const u=c.split(" ");for(const h of u)t.includes(h)||t.push(h)}}function Gi(a,t){const r=/#include\s+"([^"]+)"/g,c=/#pragma mapbox: ([\w\-]+) ([\w]+) ([\w]+) ([\w]+)/g;let u=t.match(/attribute(\S*) (highp |mediump |lowp )?([\w]+) ([\w]+)/g);u&&(u=u.filter((b,w)=>u.indexOf(b)===w));const h={},m=[],g=[];a=a.replace(r,(b,w)=>(g.push(w),"")),t=t.replace(r,(b,w)=>(m.push(w),""));let v=[..._8];B3(a,v),B3(t,v);for(const b of[...m,...g])z3[b]||console.error(`Undefined include: ${b}`),F3[b]||(F3[b]=[],B3(z3[b],F3[b])),v=[...v,...F3[b]];return{fragmentSource:a=a.replace(c,(b,w,A,C,P)=>(h[P]=!0,w==="define"?`
#ifndef HAS_UNIFORM_u_${P}
varying ${A} ${C} ${P};
#else
uniform ${A} ${C} u_${P};
#endif
`:w==="initialize"?`
#ifdef HAS_UNIFORM_u_${P}
    ${A} ${C} ${P} = u_${P};
#endif
`:w==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${P}
    varying ${A} ${C} ${P};
#endif
`:w==="initialize-attribute"?"":void 0)),vertexSource:t=t.replace(c,(b,w,A,C,P)=>{const k=C==="float"?"vec2":C,z=P.match(/color/)?"color":k;return w==="define-attribute-vertex-shader-only"?`
#ifdef HAS_ATTRIBUTE_a_${P}
attribute ${A} ${C} a_${P};
#endif
`:h[P]?w==="define"?`
#ifndef HAS_UNIFORM_u_${P}
uniform lowp float u_${P}_t;
attribute ${A} ${k} a_${P};
varying ${A} ${C} ${P};
#else
uniform ${A} ${C} u_${P};
#endif
`:w==="initialize"?z==="vec4"?`
#ifndef HAS_UNIFORM_u_${P}
    ${P} = a_${P};
#else
    ${A} ${C} ${P} = u_${P};
#endif
`:`
#ifndef HAS_UNIFORM_u_${P}
    ${P} = unpack_mix_${z}(a_${P}, u_${P}_t);
#else
    ${A} ${C} ${P} = u_${P};
#endif
`:w==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${P}
    attribute ${A} ${C} a_${P};
    varying ${A} ${C} ${P};
#endif
`:w==="initialize-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${P}
    ${P} = a_${P};
#endif
`:void 0:w==="define"?`
#ifndef HAS_UNIFORM_u_${P}
uniform lowp float u_${P}_t;
attribute ${A} ${k} a_${P};
#else
uniform ${A} ${C} u_${P};
#endif
`:w==="define-instanced"?z==="mat4"?`
#ifdef INSTANCED_ARRAYS
attribute vec4 a_${P}0;
attribute vec4 a_${P}1;
attribute vec4 a_${P}2;
attribute vec4 a_${P}3;
#else
uniform ${A} ${C} u_${P};
#endif
`:`
#ifdef INSTANCED_ARRAYS
attribute ${A} ${k} a_${P};
#else
uniform ${A} ${C} u_${P};
#endif
`:w==="initialize-attribute-custom"?`
#ifdef HAS_ATTRIBUTE_a_${P}
    ${A} ${C} ${P} = a_${P};
#endif
`:z==="vec4"?`
#ifndef HAS_UNIFORM_u_${P}
    ${A} ${C} ${P} = a_${P};
#else
    ${A} ${C} ${P} = u_${P};
#endif
`:`
#ifndef HAS_UNIFORM_u_${P}
    ${A} ${C} ${P} = unpack_mix_${z}(a_${P}, u_${P}_t);
#else
    ${A} ${C} ${P} = u_${P};
#endif
`}),staticAttributes:u,usedDefines:v,vertexIncludes:m,fragmentIncludes:g}}class uae{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(t,r,c,u,h,m,g,v){this.context=t;let b=this.boundPaintVertexBuffers.length!==u.length;for(let A=0;!b&&A<u.length;A++)this.boundPaintVertexBuffers[A]!==u[A]&&(b=!0);let w=this.boundDynamicVertexBuffers.length!==g.length;for(let A=0;!w&&A<g.length;A++)this.boundDynamicVertexBuffers[A]!==g[A]&&(w=!0);if(!this.vao||this.boundProgram!==r||this.boundLayoutVertexBuffer!==c||b||w||this.boundIndexBuffer!==h||this.boundVertexOffset!==m)this.freshBind(r,c,u,h,m,g,v);else{t.bindVertexArrayOES.set(this.vao);for(const A of g)A&&(A.bind(),v&&A.instanceCount&&A.setVertexAttribDivisor(t.gl,r,v));h&&h.dynamicDraw&&h.bind()}}freshBind(t,r,c,u,h,m,g){const v=t.numAttributes,b=this.context,w=b.gl;this.vao&&this.destroy(),this.vao=b.gl.createVertexArray(),b.bindVertexArrayOES.set(this.vao),this.boundProgram=t,this.boundLayoutVertexBuffer=r,this.boundPaintVertexBuffers=c,this.boundIndexBuffer=u,this.boundVertexOffset=h,this.boundDynamicVertexBuffers=m,r.enableAttributes(w,t),r.bind(),r.setVertexAttribPointers(w,t,h);for(const A of c)A.enableAttributes(w,t),A.bind(),A.setVertexAttribPointers(w,t,h);for(const A of m)A&&(A.enableAttributes(w,t),A.bind(),A.setVertexAttribPointers(w,t,h),g&&A.instanceCount&&A.setVertexAttribDivisor(w,t,g));u&&u.bind(),b.currentNumAttributes=v}destroy(){this.vao&&(this.context.gl.deleteVertexArray(this.vao),this.vao=null)}}function dae(a,t){const r=Math.pow(2,t.canonical.z),c=t.canonical.y;return[new vi(0,c/r).toLngLat().lat,new vi(0,(c+1)/r).toLngLat().lat]}function hae(a,t,r,c,u,h,m){const g=a.context,v=g.gl,b=r.hillshadeFBO;if(!b)return;a.prepareDrawTile();const w=a.isTileAffectedByFog(t),A=a.getOrCreateProgram("hillshade",{overrideFog:w});g.activeTexture.set(v.TEXTURE0),v.bindTexture(v.TEXTURE_2D,b.colorAttachment.get());const C=((U,W,$,Z)=>{const K=$.paint.get("hillshade-shadow-color"),q=$.paint.get("hillshade-highlight-color"),J=$.paint.get("hillshade-accent-color"),re=$.paint.get("hillshade-emissive-strength");let ce=ye($.paint.get("hillshade-illumination-direction"));if($.paint.get("hillshade-illumination-anchor")==="viewport")ce-=U.transform.angle;else if(U.style&&U.style.enable3dLights()&&U.style.directionalLight){const ve=U.style.directionalLight.properties.get("direction");ce=ye(de(ve.x,ve.y,ve.z)[1])}const ge=!U.options.moving;return{u_matrix:Z||U.transform.calculateProjMatrix(W.tileID.toUnwrapped(),ge),u_image:0,u_latrange:dae(0,W.tileID),u_light:[$.paint.get("hillshade-exaggeration"),ce],u_shadow:K,u_highlight:q,u_emissive_strength:re,u_accent:J}})(a,r,c,a.terrain?t.projMatrix:null);a.uploadCommonUniforms(g,A,t.toUnwrapped());const{tileBoundsBuffer:P,tileBoundsIndexBuffer:k,tileBoundsSegments:z}=a.getTileBoundsBuffers(r);A.draw(a,v.TRIANGLES,u,h,m,hi.disabled,C,c.id,P,k,z)}function A8(a,t,r){if(!t.needsDEMTextureUpload)return;const c=a.context,u=c.gl;c.pixelStoreUnpackPremultiplyAlpha.set(!1),t.demTexture=t.demTexture||a.getTileTexture(r.stride);const h=r.getPixels();t.demTexture?t.demTexture.update(h,{premultiply:!1}):t.demTexture=new vr(c,h,a.terrainUseFloatDEM()?u.R32F:u.RGBA,{premultiply:!1}),t.needsDEMTextureUpload=!1}function pae(a,t,r){const c=a.context,u=c.gl;if(!t.dem)return;const h=t.dem;if(c.activeTexture.set(u.TEXTURE1),A8(a,t,h),!t.demTexture)return;t.demTexture.bind(u.NEAREST,u.CLAMP_TO_EDGE);const m=h.dim;c.activeTexture.set(u.TEXTURE0);let g=t.hillshadeFBO;if(!g){const C=new vr(c,{width:m,height:m,data:null},u.RGBA);C.bind(u.LINEAR,u.CLAMP_TO_EDGE),g=t.hillshadeFBO=c.createFramebuffer(m,m,!0,"renderbuffer"),g.colorAttachment.set(C.texture)}c.bindFramebuffer.set(g.framebuffer),c.viewport.set([0,0,m,m]);const{tileBoundsBuffer:v,tileBoundsIndexBuffer:b,tileBoundsSegments:w}=a.getMercatorTileBoundsBuffers(),A=[];a.terrainUseFloatDEM()&&A.push("TERRAIN_DEM_FLOAT_FORMAT"),a.getOrCreateProgram("hillshadePrepare",{defines:A}).draw(a,u.TRIANGLES,Nn.disabled,ui.disabled,Ci.unblended,hi.disabled,((C,P)=>{const k=P.stride,z=rt.create();return rt.ortho(z,0,mt,-mt,0,0,1),rt.translate(z,z,[0,-mt,0]),{u_matrix:z,u_image:1,u_dimension:[k,k],u_zoom:C.overscaledZ,u_unpack:P.unpackVector}})(t.tileID,h),r.id,v,b,w),t.needsHillshadePrepare=!1}const E8=a=>({u_matrix:new $n(a),u_image0:new ci(a),u_skirt_height:new Jt(a),u_ground_shadow_factor:new Zn(a)}),M8=(a,t,r)=>({u_matrix:a,u_image0:0,u_skirt_height:t,u_ground_shadow_factor:r}),T8=(a,t,r,c,u,h,m,g,v,b,w,A,C,P,k)=>({u_proj_matrix:Float32Array.from(a),u_globe_matrix:t,u_normalize_matrix:Float32Array.from(c),u_merc_matrix:r,u_zoom_transition:u,u_merc_center:h,u_image0:0,u_frustum_tl:m,u_frustum_tr:g,u_frustum_br:v,u_frustum_bl:b,u_globe_pos:w,u_globe_radius:A,u_viewport:C,u_grid_matrix:k?Float32Array.from(k):new Float32Array(9),u_skirt_height:P}),Ev=(a,t)=>{if(t>0&&a.terrain&&_e("Cutoff is currently disabled on terrain"),t<=0||a.terrain)return{shouldRenderCutoff:!1,uniformValues:{u_cutoff_params:[0,0,0,0]}};const r=a.transform,c=Math.max(Math.abs(r._zoom-(a.minCutoffZoom-1)),1),u=r.isLODDisabled(!1)?Ee(60,45,r.pitch):Ee(30,15,r.pitch),h=r._farZ-r._nearZ,m=t*r.height,g=((1-(v=u))*(.75*r.cameraToCenterDistance)+v*(r._farZ+m))*c;var v;return{shouldRenderCutoff:u<1,uniformValues:{u_cutoff_params:[r._nearZ,r._farZ,(g-r._nearZ)/h,(g-m-r._nearZ)/h]}}};function C8(a,t){return a!=null&&t!=null&&!(!a.hasData()||!t.hasData())&&a.demTexture!=null&&t.demTexture!=null&&a.tileID.key!==t.tileID.key}const Mv=new class{constructor(){this.operations={}}newMorphing(a,t,r,c,u){if(a in this.operations){const h=this.operations[a];h.to.tileID.key!==r.tileID.key&&(h.queued=r)}else this.operations[a]={startTime:c,phase:0,duration:u,from:t,to:r,queued:null}}getMorphValuesForProxy(a){if(!(a in this.operations))return null;const t=this.operations[a];return{from:t.from,to:t.to,phase:t.phase}}update(a){for(const t in this.operations){const r=this.operations[t];for(r.phase=(a-r.startTime)/r.duration;r.phase>=1||!this._validOp(r);)if(!this._nextOp(r,a)){delete this.operations[t];break}}}_nextOp(a,t){return!!a.queued&&(a.from=a.to,a.to=a.queued,a.queued=null,a.phase=0,a.startTime=t,!0)}_validOp(a){return a.from.hasData()&&a.to.hasData()}},P8={0:null,1:"TERRAIN_VERTEX_MORPHING"};function I8(a,t,r){if(t===0)return 0;const c=t<1&&r===514?.25/t:1;return 6*Math.pow(1.5,22-a)*Math.max(t,1)*c}function fae(a,t){const r=1<<a.z;return!t&&(a.x===0||a.x===r-1)||a.y===0||a.y===r-1}const b5=a=>({u_matrix:a});function L8(a,t,r,c,u){if(u>0){const h=Cn.now(),m=(h-a.timeAdded)/u,g=t?(h-t.timeAdded)/u:-1,v=r.getSource(),b=c.coveringZoomLevel({tileSize:v.tileSize,roundZoom:v.roundZoom}),w=!t||Math.abs(t.tileID.overscaledZ-b)>Math.abs(a.tileID.overscaledZ-b),A=w&&a.refreshedUponExpiration?1:ae(w?m:1-g,0,1);return a.refreshedUponExpiration&&m>=1&&(a.refreshedUponExpiration=!1),t?{opacity:1,mix:1-A}:{opacity:A,mix:0}}return{opacity:1,mix:0}}class mae extends Xc{constructor(t){const r={type:"raster-dem",maxzoom:t.transform.maxZoom},c=new Lm(B1(),null),u=h5("mock-dem",r,c,t.style);super("mock-dem",u,!1),u.setEventedParent(this),this._sourceLoaded=!0}_loadTile(t,r){t.state="loaded",r(null)}}class gae extends Xc{constructor(t){const r=h5("proxy",{type:"geojson",maxzoom:t.transform.maxZoom},new Lm(B1(),null),t.style);super("proxy",r,!1),r.setEventedParent(this),this.map=this.getSource().map=t,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(t,r,c){if(t.freezeTileCoverage)return;this.transform=t;const u=t.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((h,m)=>{if(h[m.key]="",!this._tiles[m.key]){const g=new T1(m,this._source.tileSize*m.overscaleFactor(),t.tileZoom);g.state="loaded",this._tiles[m.key]=g}return h},{});for(const h in this._tiles)h in u||(this.freeFBO(h),this._tiles[h].unloadVectorData(),delete this._tiles[h])}freeFBO(t){const r=this.proxyCachedFBO[t];if(r!==void 0){const c=Object.values(r);this.renderCachePool.push(...c),delete this.proxyCachedFBO[t]}}deallocRenderCache(){this.renderCache.forEach(t=>t.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class R8 extends Li{constructor(t,r,c){super(t.overscaledZ,t.wrap,t.canonical.z,t.canonical.x,t.canonical.y),this.proxyTileKey=r,this.projMatrix=c}}class yae extends Xee{constructor(t,r){super(),this.painter=t,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[c,u,h]=function(v){const b=new ee,w=new Fn,A=131;b.reserve(17161),w.reserve(33800);const C=mt/128,P=mt+C/2,k=P+C;for(let U=-C;U<k;U+=C)for(let W=-C;W<k;W+=C){const $=W<0||W>P||U<0||U>P?24575:0,Z=ae(Math.round(W),0,mt),K=ae(Math.round(U),0,mt);b.emplaceBack(Z+$,K)}const z=(U,W)=>{const $=W*A+U;w.emplaceBack($+1,$,$+A),w.emplaceBack($+A,$+A+1,$+1)};for(let U=1;U<129;U++)for(let W=1;W<129;W++)z(W,U);return[0,129].forEach(U=>{for(let W=0;W<130;W++)z(W,U),z(U,W)}),[b,w,32768]}(),m=t.context;this.gridBuffer=m.createVertexBuffer(c,_p.members),this.gridIndexBuffer=m.createIndexBuffer(u),this.gridSegments=ji.simpleSegment(0,0,c.length,u.length),this.gridNoSkirtSegments=ji.simpleSegment(0,0,c.length,h),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new gae(r.map),this.orthoMatrix=rt.create(),rt.ortho(this.orthoMatrix,this.painter.transform.projection.name==="globe"?.015:0,mt,0,mt,0,1);const g=m.gl;this._overlapStencilMode=new ui({func:g.GEQUAL,mask:255},0,255,g.KEEP,g.KEEP,g.REPLACE),this._previousZoom=t.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=r,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new mae(r.map),this._pendingGroundEffectLayers=[]}set style(t){t.on("data",this._onStyleDataEvent.bind(this)),this._style=t,this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(t,r,c){if(t&&t.terrain){this._style!==t&&(this.style=t,this._evaluationZoom=void 0);const u=t.terrain.properties,h=t.terrain.drapeRenderMode===0,m=t.terrain.isZoomDependent();this._previousUpdateTimestamp=this.enabled?this._updateTimestamp:void 0,this._updateTimestamp=Cn.now();const g=t.terrain&&t.terrain.scope,v=u.get("source"),b=h?this._mockSourceCache:t.getSourceCache(v,g);if(!b)return void _e(`Couldn't find terrain source "${v}".`);if(this.sourceCache=b,this._exaggeration=m?this.calculateExaggeration(r):u.get("exaggeration"),!r.projection.requiresDraping&&m&&this._exaggeration===0)return void this._disable();this.enabled=!0;const w=()=>{this.sourceCache.used&&_e(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const A=this.getScaledDemTileSize();this.sourceCache.update(r,A,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,w(),this._initializing=!0),w(),r.updateElevation(!0,c),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(r),this._emptyDEMTextureDirty=!0,this._previousZoom=r.zoom}else this._disable()}calculateExaggeration(t){const r=this._previousCameraAltitude,c=t.getFreeCameraOptions().position.z/t.pixelsPerMeter*t.worldSize;this._previousCameraAltitude=c;const u=r!=null?c-r:Number.MAX_VALUE;if(Math.abs(u)<2)return this._exaggeration;const h=t.zoom,m=this._style.terrain;if(!this._previousUpdateTimestamp)return m.getExaggeration(h);let g=h-this._previousZoom;const v=this._previousUpdateTimestamp;let b=h;this._evaluationZoom!=null&&(b=this._evaluationZoom,Math.abs(h-b)>.5&&(g=.5*(h-b+g)),g*u<0&&(b+=g)),this._evaluationZoom=b;const w=m.getExaggeration(b),A=w===m.getExaggeration(Math.max(0,b-.1));if(A&&Math.abs(w-this._exaggeration)<.01)return w;let C=Math.min(.1,.00375*(this._updateTimestamp-v));return(A||w<.1||Math.abs(g)<1e-4)&&(C=Math.min(.2,4*C)),Ln(this._exaggeration,w,C)}resetTileLookupCache(t){this._findCoveringTileCache[t]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_onStyleDataEvent(t){t.coord&&t.dataType==="source"?this._clearRenderCacheForTile(t.sourceCacheId,t.coord):t.dataType==="style"&&(this.invalidateRenderCache=!0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this._previousCameraAltitude=void 0)}_disable(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const t in this._style._mergedSourceCaches)this._style._mergedSourceCaches[t].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this._emptyDepthBufferTexture&&this._emptyDepthBufferTexture.destroy(),this.pool.forEach(t=>t.fb.destroy()),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),this.framebufferCopyTexture&&this.framebufferCopyTexture.destroy()}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this._exaggeration}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const t=2*this.proxySourceCache.getSource().tileSize;return[t,t]}set useVertexMorphing(t){this._useVertexMorphing=t}updateTileBinding(t){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const r=this.proxySourceCache,c=this.painter.transform;this._initializing&&(this._initializing=c._centerAltitude===0&&this.getAtPointOrZero(vi.fromLngLat(c.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);const u=this.proxyCoords=r.getIds().map(v=>{const b=r.getTileByID(v).tileID;return b.projMatrix=c.calculateProjMatrix(b.toUnwrapped()),b});(function(v,b){const w=b.transform.pointCoordinate(b.transform.getCameraPoint()),A=new V(w.x,w.y);v.sort((C,P)=>{if(P.overscaledZ-C.overscaledZ)return P.overscaledZ-C.overscaledZ;const k=new V(C.canonical.x+(1<<C.canonical.z)*C.wrap,C.canonical.y),z=new V(P.canonical.x+(1<<P.canonical.z)*P.wrap,P.canonical.y),U=A.mult(1<<C.canonical.z);return U.x-=.5,U.y-=.5,U.distSqr(k)-U.distSqr(z)})})(u,this.painter);const h=this.proxyToSource||{};this.proxyToSource={},u.forEach(v=>{this.proxyToSource[v.key]={}}),this.terrainTileForTile={};const m=this._style._mergedSourceCaches;for(const v in m){const b=m[v];if(!b.used||(b!==this.sourceCache&&this.resetTileLookupCache(b.id),this._setupProxiedCoordsForOrtho(b,t[v],h),b.usedForTerrain))continue;const w=t[v];b.getSource().reparseOverscaled&&this._assignTerrainTiles(w)}this.proxiedCoords[r.id]=u.map(v=>new R8(v,v.key,this.orthoMatrix)),this._assignTerrainTiles(u),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(h),this.renderingToTexture=!1;const g={};this._visibleDemTiles=[];for(const v of this.proxyCoords){const b=this.terrainTileForTile[v.key];if(!b)continue;const w=b.tileID.key;w in g||(this._visibleDemTiles.push(b),g[w]=w)}}_assignTerrainTiles(t){this._initializing||t.forEach(r=>{if(this.terrainTileForTile[r.key])return;const c=this._findTileCoveringTileID(r,this.sourceCache);c&&(this.terrainTileForTile[r.key]=c)})}_prepareDEMTextures(){const t=this.painter.context,r=t.gl;for(const c in this.terrainTileForTile){const u=this.terrainTileForTile[c],h=u.dem;!h||u.demTexture&&!u.needsDEMTextureUpload||(t.activeTexture.set(r.TEXTURE1),A8(this.painter,u,h))}}_prepareDemTileUniforms(t,r,c,u){if(!r||r.demTexture==null)return!1;const h=t.tileID.canonical,m=Math.pow(2,r.tileID.canonical.z-h.z),g=u||"";return c[`u_dem_tl${g}`]=[h.x*m%1,h.y*m%1],c[`u_dem_scale${g}`]=m,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}get emptyDepthBufferTexture(){const t=this.painter.context,r=t.gl;if(!this._emptyDepthBufferTexture){const c=new Xa({width:1,height:1},Uint8Array.of(255,255,255,255));this._emptyDepthBufferTexture=new vr(t,c,r.RGBA,{premultiply:!1})}return this._emptyDepthBufferTexture}_getLoadedAreaMinimum(){let t=0;const r=this._visibleDemTiles.reduce((c,u)=>{if(!u.dem)return c;const h=u.dem.tree.minimums[0];return h>0&&t++,c+h},0);return t?r/t:0}_updateEmptyDEMTexture(){const t=this.painter.context,r=t.gl;t.activeTexture.set(r.TEXTURE2);const c=this._getLoadedAreaMinimum(),[u,h]=(()=>{if(this.painter.terrainUseFloatDEM()){const g=new wz({width:1,height:1},new Float32Array([c]));return[r.R32F,g]}{const g=new Xa({width:1,height:1},new Uint8Array(Em.pack(c,this.sourceCache.getSource().encoding)));return[r.RGBA,g]}})();this._emptyDEMTextureDirty=!1;let m=this._emptyDEMTexture;return m?m.update(h,{premultiply:!1}):m=this._emptyDEMTexture=new vr(t,h,u,{premultiply:!1}),m}setupElevationDraw(t,r,c){const u=this.painter.context,h=u.gl,m=(g=this.sourceCache.getSource().encoding,{u_dem:2,u_dem_prev:4,u_dem_unpack:Em.getUnpackVector(g),u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0});var g;m.u_exaggeration=this.exaggeration();let v=null,b=null,w=1;if(c&&c.morphing&&this._useVertexMorphing){const P=c.morphing.srcDemTile,k=c.morphing.dstDemTile;w=c.morphing.phase,P&&k&&(this._prepareDemTileUniforms(t,P,m,"_prev")&&(b=P),this._prepareDemTileUniforms(t,k,m)&&(v=k))}const A=P=>P&&P.demTexture&&this.painter.terrainUseFloatDEM()?h.LINEAR:h.NEAREST,C=P=>{m.u_dem_size=P.size[0]===1?1:P.size[0]-2};if(b&&v)u.activeTexture.set(h.TEXTURE2),v.demTexture.bind(A(v),h.CLAMP_TO_EDGE),u.activeTexture.set(h.TEXTURE4),b.demTexture.bind(A(b),h.CLAMP_TO_EDGE),v.demTexture&&C(v.demTexture),m.u_dem_lerp=w;else{v=this.terrainTileForTile[t.tileID.key],u.activeTexture.set(h.TEXTURE2);const P=this._prepareDemTileUniforms(t,v,m)?v.demTexture:this.emptyDEMTexture;P.bind(A(v),h.CLAMP_TO_EDGE),C(P)}if(u.activeTexture.set(h.TEXTURE3),c&&c.useDepthForOcclusion?(this._depthTexture&&this._depthTexture.bind(h.NEAREST,h.CLAMP_TO_EDGE),this._depthFBO&&(m.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height])):(this.emptyDepthBufferTexture.bind(h.NEAREST,h.CLAMP_TO_EDGE),m.u_depth_size_inv=[1,1]),c&&c.useMeterToDem&&v){const P=(1<<v.tileID.canonical.z)*$i(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;m.u_meter_to_dem=P}if(c&&c.labelPlaneMatrixInv&&(m.u_label_plane_matrix_inv=c.labelPlaneMatrixInv),r.setTerrainUniformValues(u,m),this.painter.transform.projection.name==="globe"){const P=this.globeUniformValues(this.painter.transform,t.tileID.canonical,c&&c.useDenormalizedUpVectorScale);r.setGlobeUniformValues(u,P)}}globeUniformValues(t,r,c){const u=t.projection;return{u_tile_tl_up:u.upVector(r,0,0),u_tile_tr_up:u.upVector(r,mt,0),u_tile_br_up:u.upVector(r,mt,mt),u_tile_bl_up:u.upVector(r,0,mt),u_tile_up_scale:c?D2(1):u.upVectorScale(r,t.center.lat,t.worldSize).metersToTile}}renderToBackBuffer(t){const r=this.painter,c=this.painter.context;t.length!==0&&(c.bindFramebuffer.set(null),c.viewport.set([0,0,r.width,r.height]),r.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(u,h,m,g,v){if(u.transform.projection.name==="globe")(function(b,w,A,C,P){const k=b.context,z=k.gl;let U,W;const $=b.transform,Z=tz(b,k,$),K=(Le,Se)=>{if(W===Se)return;const Ve=[P8[Se],"PROJECTION_GLOBE_VIEW"];Z&&Ve.push("CUSTOM_ANTIALIASING");const Xe=b.isTileAffectedByFog(Le);U=b.getOrCreateProgram("globeRaster",{defines:Ve,overrideFog:Xe}),W=Se},q=b.colorModeForRenderPass(),J=new Nn(z.LEQUAL,Nn.ReadWrite,b.depthRangeFor3D);Mv.update(P);const re=function(Le){const Se=Le.pixelsPerMeter,Ve=Se/$i(1,Le.center.lat),Xe=rt.identity(new Float64Array(16));return rt.translate(Xe,Xe,[Le.point.x,Le.point.y,0]),rt.scale(Xe,Xe,[Ve,Ve,Se]),Float32Array.from(Xe)}($),ce=[vo($.center.lng),Co($.center.lat)],ge=b.globeSharedBuffers,ve=[$.width*Cn.devicePixelRatio,$.height*Cn.devicePixelRatio],Ce=Float32Array.from($.globeMatrix),Ae={useDenormalizedUpVectorScale:!0};{const Le=b.transform,Se=I8(Le.zoom,w.exaggeration(),w.sourceCache._source.tileSize);W=-1;const Ve=z.TRIANGLES;for(const Xe of C){const nt=A.getTile(Xe),We=ui.disabled,Ge=w.prevTerrainTileForTile[Xe.key],ot=w.terrainTileForTile[Xe.key];C8(Ge,ot)&&Mv.newMorphing(Xe.key,Ge,ot,P,250),k.activeTexture.set(z.TEXTURE0),nt.texture.bind(z.LINEAR,z.CLAMP_TO_EDGE);const yt=Mv.getMorphValuesForProxy(Xe.key),pt=yt?1:0;yt&&Cs(Ae,{morphing:{srcDemTile:yt.from,dstDemTile:yt.to,phase:Ie(yt.phase)}});const Rt=O2(Xe.canonical),Ft=WQ(Rt.getCenter().lat),St=UQ(Xe.canonical,Rt,Ft,Le.worldSize/Le._pixelsPerMercatorPixel),Tt=Sm(gc(Xe.canonical)),nn=T8(Le.projMatrix,Ce,re,Tt,yo(Le.zoom),ce,Le.frustumCorners.TL,Le.frustumCorners.TR,Le.frustumCorners.BR,Le.frustumCorners.BL,Le.globeCenterInViewSpace,Le.globeRadius,ve,Se,St);if(K(Xe,pt),U&&(w.setupElevationDraw(nt,U,Ae),b.uploadCommonUniforms(k,U,Xe.toUnwrapped()),ge)){const[sn,on,cn]=ge.getGridBuffers(Ft,Se!==0);U.draw(b,Ve,J,We,q,hi.backCCW,nn,"globe_raster",sn,on,cn)}}}if(ge&&(b.renderDefaultNorthPole||b.renderDefaultSouthPole)){const Le=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];Z&&Le.push("CUSTOM_ANTIALIASING"),U=b.getOrCreateProgram("globeRaster",{defines:Le});for(const Se of C){const{x:Ve,y:Xe,z:nt}=Se.canonical,We=Xe===0,Ge=Xe===(1<<nt)-1,[ot,yt,pt,Rt]=ge.getPoleBuffers(nt,!1);if(Rt&&(We||Ge)){const Ft=A.getTile(Se);k.activeTexture.set(z.TEXTURE0),Ft.texture.bind(z.LINEAR,z.CLAMP_TO_EDGE);let St=ez(nt,Ve,$);const Tt=Sm(gc(Se.canonical)),nn=(sn,on)=>sn.draw(b,z.TRIANGLES,J,ui.disabled,q,hi.disabled,T8($.projMatrix,St,St,Tt,0,ce,$.frustumCorners.TL,$.frustumCorners.TR,$.frustumCorners.BR,$.frustumCorners.BL,$.globeCenterInViewSpace,$.globeRadius,ve,0),"globe_pole_raster",on,pt,Rt);w.setupElevationDraw(Ft,U,Ae),b.uploadCommonUniforms(k,U,Se.toUnwrapped()),We&&b.renderDefaultNorthPole&&nn(U,ot),Ge&&b.renderDefaultSouthPole&&(St=rt.scale(rt.create(),St,[1,-1,1]),nn(U,yt))}}}})(u,h,m,g,v);else{const b=u.context,w=b.gl;let A,C;const P=u.shadowRenderer,k=Ev(u,u.longestCutoffRange),z=q=>{if(C===q)return;const J=[];J.push(P8[q]),k.shouldRenderCutoff&&J.push("RENDER_CUTOFF"),A=u.getOrCreateProgram("terrainRaster",{defines:J}),C=q},U=u.colorModeForRenderPass(),W=new Nn(w.LEQUAL,Nn.ReadWrite,u.depthRangeFor3D);Mv.update(v);const $=u.transform,Z=I8($.zoom,h.exaggeration(),h.sourceCache._source.tileSize);let K=[0,0,0];if(P){const q=u.style.directionalLight,J=u.style.ambientLight;q&&J&&(K=E5(q,J))}{C=-1;const q=w.TRIANGLES,[J,re]=[h.gridIndexBuffer,h.gridSegments];for(const ce of g){const ge=m.getTile(ce),ve=ui.disabled,Ce=h.prevTerrainTileForTile[ce.key],Ae=h.terrainTileForTile[ce.key];C8(Ce,Ae)&&Mv.newMorphing(ce.key,Ce,Ae,v,250),b.activeTexture.set(w.TEXTURE0),ge.texture.bind(w.LINEAR,w.CLAMP_TO_EDGE,w.LINEAR_MIPMAP_NEAREST);const Le=Mv.getMorphValuesForProxy(ce.key),Se=Le?1:0;let Ve;Le&&(Ve={morphing:{srcDemTile:Le.from,dstDemTile:Le.to,phase:Ie(Le.phase)}});const Xe=M8(ce.projMatrix,fae(ce.canonical,$.renderWorldCopies)?Z/10:Z,K);if(z(Se),!A)continue;h.setupElevationDraw(ge,A,Ve);const nt=ce.toUnwrapped();P&&P.setupShadows(nt,A),u.uploadCommonUniforms(b,A,nt,null,k),A.draw(u,q,W,ve,U,hi.backCCW,Xe,"terrain_raster",h.gridBuffer,J,re)}}}}(r,this,this.proxySourceCache,t,this._updateTimestamp),this.renderingToTexture=!0,r.gpuTimingDeferredRenderEnd(),t.splice(0,t.length))}renderBatch(t){if(this._drapedRenderBatches.length===0)return t+1;this.renderingToTexture=!0;const r=this.painter,c=this.painter.context,u=this.proxySourceCache,h=this.proxiedCoords[u.id],m=this._drapedRenderBatches.shift(),g=r.style.order,v=[];let b=0;for(const w of h){const A=u.getTileByID(w.proxyTileKey),C=u.proxyCachedFBO[w.key]?u.proxyCachedFBO[w.key][t]:void 0,P=C!==void 0?u.renderCache[C]:this.pool[b++],k=C!==void 0;if(A.texture=P.tex,k&&!P.dirty){v.push(A.tileID);continue}let z;c.bindFramebuffer.set(P.fb.framebuffer),this.renderedToTile=!1,P.dirty&&(c.clear({color:Sn.transparent,stencil:0}),P.dirty=!1);for(let U=m.start;U<=m.end;++U){const W=r.style._mergedLayers[g[U]];if(W.isHidden(r.transform.zoom))continue;const $=r.style.getLayerSourceCache(W),Z=$?this.proxyToSource[w.key][$.id]:[w];if(!Z)continue;const K=Z;c.viewport.set([0,0,P.fb.width,P.fb.height]),z!==($?$.id:null)&&(this._setupStencil(P,Z,W,$),z=$?$.id:null),r.renderLayer(r,$,W,K)}if(this._drapedRenderBatches.length===0)for(const U of this._pendingGroundEffectLayers){const W=r.style._mergedLayers[g[U]];if(W.isHidden(r.transform.zoom))continue;const $=r.style.getLayerSourceCache(W),Z=$?this.proxyToSource[w.key][$.id]:[w];if(!Z)continue;const K=Z;c.viewport.set([0,0,P.fb.width,P.fb.height]),z!==($?$.id:null)&&(this._setupStencil(P,Z,W,$),z=$?$.id:null),r.renderLayer(r,$,W,K)}this.renderedToTile?(P.dirty=!0,v.push(A.tileID)):k||--b,b===5&&(b=0,this.renderToBackBuffer(v))}return this.renderToBackBuffer(v),this.renderingToTexture=!1,c.bindFramebuffer.set(null),c.viewport.set([0,0,r.width,r.height]),m.end+1}postRender(){}isLayerOrderingCorrect(t){const r=t.order.length;let c=-1,u=r;for(let h=0;h<r;++h)this._style.isLayerDraped(t._mergedLayers[t.order[h]])?c=Math.max(c,h):u=Math.min(u,h);return u>c}getMinElevationBelowMSL(){let t=0;return this._visibleDemTiles.filter(r=>r.dem).forEach(r=>{t=Math.min(t,r.dem.tree.minimums[0])}),t===0?t:(t-30)*this._exaggeration}raycast(t,r,c){if(!this._visibleDemTiles)return null;const u=this._visibleDemTiles.filter(h=>h.dem).map(h=>{const m=h.tileID,g=1<<m.overscaledZ,{x:v,y:b}=m.canonical,w=v/g,A=(v+1)/g,C=b/g,P=(b+1)/g;return{minx:w,miny:C,maxx:A,maxy:P,t:h.dem.tree.raycastRoot(w,C,A,P,t,r,c),tile:h}});u.sort((h,m)=>(h.t!==null?h.t:Number.MAX_VALUE)-(m.t!==null?m.t:Number.MAX_VALUE));for(const h of u){if(h.t==null)return null;const m=h.tile.dem.tree.raycast(h.minx,h.miny,h.maxx,h.maxy,t,r,c);if(m!=null)return m}return null}_createFBO(){const t=this.painter.context,r=t.gl,c=this.drapeBufferSize;t.activeTexture.set(r.TEXTURE0);const u=new vr(t,{width:c[0],height:c[1],data:null},r.RGBA);u.bind(r.LINEAR,r.CLAMP_TO_EDGE);const h=t.createFramebuffer(c[0],c[1],!0,null);return h.colorAttachment.set(u.texture),h.depthAttachment=new Ane(t,h.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=t.createRenderbuffer(t.gl.DEPTH_STENCIL,c[0],c[1]),this._stencilRef=0,h.depthAttachment.set(this._sharedDepthStencil),t.clear({stencil:0})):h.depthAttachment.set(this._sharedDepthStencil),t.extTextureFilterAnisotropic&&!t.extTextureFilterAnisotropicForceOff&&r.texParameterf(r.TEXTURE_2D,t.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,t.extTextureFilterAnisotropicMax),{fb:h,tex:u,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._style.hasLightTransitions())return!0;for(const t in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[t].hasTransition())return!0;return this._style.order.some(t=>{const r=this._style._mergedLayers[t],c=r.isHidden(this.painter.transform.zoom);return r.type==="custom"?!c&&r.shouldRedrape():!c&&r.hasTransition()})}_clearLineLayersFromRenderCache(){let t=!1;for(const c of this._style.getSources())if(c instanceof GB){t=!0;break}if(!t)return;const r={};for(let c=0;c<this._style.order.length;++c){const u=this._style._mergedLayers[this._style.order[c]],h=this._style.getLayerSourceCache(u);if(h&&!r[h.id]&&!u.isHidden(this.painter.transform.zoom)&&u.type==="line"&&u.widthExpression()instanceof Bc){r[h.id]=!0;for(const m of this.proxyCoords){const g=this.proxyToSource[m.key][h.id];if(g)for(const v of g)this._clearRenderCacheForTile(h.id,v)}}}}_clearRasterLayersFromRenderCache(){let t=!1;for(const c in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[c]._source instanceof z1){t=!0;break}if(!t)return;const r={};for(let c=0;c<this._style.order.length;++c){const u=this._style._mergedLayers[this._style.order[c]],h=this._style.getLayerSourceCache(u);if(!h||r[h.id]||u.isHidden(this.painter.transform.zoom)||u.type!=="raster")continue;const m=u.paint.get("raster-fade-duration");for(const g of this.proxyCoords){const v=this.proxyToSource[g.key][h.id];if(v)for(const b of v){const w=L8(h.getTile(b),h.findLoadedParent(b,0),h,this.painter.transform,m);(w.opacity!==1||w.mix!==0)&&this._clearRenderCacheForTile(h.id,b)}}}}_setupDrapedRenderBatches(){const t=this._style.order,r=t.length;if(r===0)return;const c=[];this._pendingGroundEffectLayers=[];let u,h=0,m=this._style._mergedLayers[t[h]];for(;!this._style.isLayerDraped(m)&&m.isHidden(this.painter.transform.zoom)&&++h<r;)m=this._style._mergedLayers[t[h]];for(;h<r;++h){const g=this._style._mergedLayers[t[h]];g.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(g)?u===void 0&&(u=h):(g.type==="fill-extrusion"&&this._pendingGroundEffectLayers.push(h),u!==void 0&&(c.push({start:u,end:h-1}),u=void 0)))}if(u!==void 0&&c.push({start:u,end:h-1}),c.length!==0){const g=c[c.length-1];this._pendingGroundEffectLayers.every(b=>b>g.end)||_e("fill-extrusion with flood lighting and/or ground ambient occlusion should be moved to be on top of all draped layers.")}this._drapedRenderBatches=c}_setupRenderCache(t){const r=this.proxySourceCache;if(this._shouldDisableRenderCache()||this.invalidateRenderCache){if(this.invalidateRenderCache=!1,r.renderCache.length>r.renderCachePool.length){const m=Object.values(r.proxyCachedFBO);r.proxyCachedFBO={};for(let g=0;g<m.length;++g){const v=Object.values(m[g]);r.renderCachePool.push(...v)}}return}this._clearRasterLayersFromRenderCache();const c=this.proxyCoords,u=this._tilesDirty;for(let m=c.length-1;m>=0;m--){const g=c[m];if(r.getTileByID(g.key),r.proxyCachedFBO[g.key]!==void 0){const v=t[g.key],b=this.proxyToSource[g.key];let w=0;for(const A in b){const C=b[A],P=v[A];if(!P||P.length!==C.length||C.some((k,z)=>k!==P[z]||u[A]&&u[A].hasOwnProperty(k.key))){w=-1;break}++w}for(const A in r.proxyCachedFBO[g.key])r.renderCache[r.proxyCachedFBO[g.key][A]].dirty=w<0||w!==Object.values(v).length}}const h=[...this._drapedRenderBatches];h.sort((m,g)=>g.end-g.start-(m.end-m.start));for(const m of h)for(const g of c){if(r.proxyCachedFBO[g.key])continue;let v=r.renderCachePool.pop();v===void 0&&r.renderCache.length<50&&(v=r.renderCache.length,r.renderCache.push(this._createFBO())),v!==void 0&&(r.proxyCachedFBO[g.key]={},r.proxyCachedFBO[g.key][m.start]=v,r.renderCache[v].dirty=!0)}this._tilesDirty={}}_setupStencil(t,r,c,u){if(!u||!this._sourceTilesOverlap[u.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const h=this.painter.context,m=h.gl;if(r.length<=1)return void(this._overlapStencilType=!1);let g;if(c.isTileClipped())g=r.length,this._overlapStencilMode.test={func:m.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(r[0].overscaledZ>r[r.length-1].overscaledZ))return void(this._overlapStencilType=!1);g=1,this._overlapStencilMode.test={func:m.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+g>255&&(h.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=g,this._overlapStencilMode.ref=this._stencilRef,c.isTileClipped()&&this._renderTileClippingMasks(r,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return this._overlapStencilType==="Clip"||this._overlapStencilType==="Mask"}stencilModeForRTTOverlap(t){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[t.key]),this._overlapStencilMode):ui.disabled}_renderTileClippingMasks(t,r){const c=this.painter,u=this.painter.context,h=u.gl;c._tileClippingMaskIDs={},u.setColorMode(Ci.disabled),u.setDepthMode(Nn.disabled);const m=c.getOrCreateProgram("clippingMask");for(const g of t){const v=c._tileClippingMaskIDs[g.key]=--r;m.draw(c,h.TRIANGLES,Nn.disabled,new ui({func:h.ALWAYS,mask:0},v,255,h.KEEP,h.KEEP,h.REPLACE),Ci.disabled,hi.disabled,b5(g.projMatrix),"$clipping",c.tileExtentBuffer,c.quadTriangleIndexBuffer,c.tileExtentSegments)}}pointCoordinate(t){const r=this.painter.transform;if(t.x<0||t.x>r.width||t.y<0||t.y>r.height)return null;const c=[t.x,t.y,1,1];Hi.transformMat4(c,c,r.pixelMatrixInverse),Hi.scale(c,c,1/c[3]),c[0]/=r.worldSize,c[1]/=r.worldSize;const u=r._camera.position,h=$i(1,r.center.lat),m=[u[0],u[1],u[2]/h,0],g=ke.subtract([],c.slice(0,3),m);ke.normalize(g,g);const v=this.raycast(m,g,this._exaggeration);return v!==null&&v?(ke.scaleAndAdd(m,m,g,v),m[3]=m[2],m[2]*=h,m):null}drawDepth(){const t=this.painter,r=t.context,c=this.proxySourceCache,u=Math.ceil(t.width),h=Math.ceil(t.height);if(!this._depthFBO||this._depthFBO.width===u&&this._depthFBO.height===h||(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),!this._depthFBO){const m=r.gl,g=r.createFramebuffer(u,h,!0,"renderbuffer");r.activeTexture.set(m.TEXTURE0);const v=new vr(r,{width:u,height:h,data:null},m.RGBA);v.bind(m.NEAREST,m.CLAMP_TO_EDGE),g.colorAttachment.set(v.texture);const b=r.createRenderbuffer(r.gl.DEPTH_COMPONENT16,u,h);g.depthAttachment.set(b),this._depthFBO=g,this._depthTexture=v}r.bindFramebuffer.set(this._depthFBO.framebuffer),r.viewport.set([0,0,u,h]),function(m,g,v,b){if(m.transform.projection.name==="globe")return;const w=m.context,A=w.gl;w.clear({depth:1});const C=m.getOrCreateProgram("terrainDepth"),P=new Nn(A.LESS,Nn.ReadWrite,m.depthRangeFor3D);for(const k of b){const z=v.getTile(k),U=M8(k.projMatrix,0,[0,0,0]);g.setupElevationDraw(z,C),C.draw(m,A.TRIANGLES,P,ui.disabled,Ci.unblended,hi.backCCW,U,"terrain_depth",g.gridBuffer,g.gridIndexBuffer,g.gridNoSkirtSegments)}}(t,this,c,this.proxyCoords)}_setupProxiedCoordsForOrtho(t,r,c){if(t.getSource()instanceof Ku)return this._setupProxiedCoordsForImageSource(t,r,c);this._findCoveringTileCache[t.id]=this._findCoveringTileCache[t.id]||{};const u=this.proxiedCoords[t.id]=[],h=this.proxyCoords;for(let g=0;g<h.length;g++){const v=h[g],b=this._findTileCoveringTileID(v,t);if(b){const w=this._createProxiedId(v,b,c[v.key]&&c[v.key][t.id]);u.push(w),this.proxyToSource[v.key][t.id]=[w]}}let m=!1;for(let g=0;g<r.length;g++){const v=t.getTile(r[g]);if(!v||!v.hasData())continue;const b=this._findTileCoveringTileID(v.tileID,this.proxySourceCache);if(b&&b.tileID.canonical.z!==v.tileID.canonical.z){const w=this.proxyToSource[b.tileID.key][t.id],A=this._createProxiedId(b.tileID,v,c[b.tileID.key]&&c[b.tileID.key][t.id]);w?w.splice(w.length-1,0,A):this.proxyToSource[b.tileID.key][t.id]=[A],u.push(A),m=!0}}this._sourceTilesOverlap[t.id]=m}_setupProxiedCoordsForImageSource(t,r,c){if(!t.getSource().loaded())return;const u=this.proxiedCoords[t.id]=[],h=this.proxyCoords,m=t.getSource(),g=m.tileID;if(!g)return;const v=new V(g.x,g.y)._div(1<<g.z),b=m.coordinates.map(vi.fromLngLat).reduce((A,C)=>(A.min.x=Math.min(A.min.x,C.x-v.x),A.min.y=Math.min(A.min.y,C.y-v.y),A.max.x=Math.max(A.max.x,C.x-v.x),A.max.y=Math.max(A.max.y,C.y-v.y),A),{min:new V(Number.MAX_VALUE,Number.MAX_VALUE),max:new V(-Number.MAX_VALUE,-Number.MAX_VALUE)}),w=(A,C)=>{const P=A.wrap+A.canonical.x/(1<<A.canonical.z),k=A.canonical.y/(1<<A.canonical.z),z=mt/(1<<A.canonical.z),U=C.wrap+C.canonical.x/(1<<C.canonical.z),W=C.canonical.y/(1<<C.canonical.z);return P+z<U+b.min.x||P>U+b.max.x||k+z<W+b.min.y||k>W+b.max.y};for(let A=0;A<h.length;A++){const C=h[A];for(let P=0;P<r.length;P++){const k=t.getTile(r[P]);if(!k||!k.hasData()||w(C,k.tileID))continue;const z=this._createProxiedId(C,k,c[C.key]&&c[C.key][t.id]),U=this.proxyToSource[C.key][t.id];U?U.push(z):this.proxyToSource[C.key][t.id]=[z],u.push(z)}}}_createProxiedId(t,r,c){let u=this.orthoMatrix;if(c){const h=c.find(m=>m.key===r.tileID.key);if(h)return h}if(r.tileID.key!==t.key){const h=t.canonical.z-r.tileID.canonical.z;let m,g,v;u=rt.create();const b=r.tileID.wrap-t.wrap<<t.overscaledZ;h>0?(m=mt>>h,g=m*((r.tileID.canonical.x<<h)-t.canonical.x+b),v=m*((r.tileID.canonical.y<<h)-t.canonical.y)):(m=mt<<-h,g=mt*(r.tileID.canonical.x-(t.canonical.x+b<<-h)),v=mt*(r.tileID.canonical.y-(t.canonical.y<<-h))),rt.ortho(u,0,m,0,m,0,1),rt.translate(u,u,[g,v,0])}return new R8(r.tileID,t.key,u)}_findTileCoveringTileID(t,r){let c=r.getTile(t);if(c&&c.hasData())return c;const u=this._findCoveringTileCache[r.id],h=u[t.key];if(c=h?r.getTileByID(h):null,c&&c.hasData()||h===null)return c;let m=c?c.tileID:t,g=m.overscaledZ;const v=r.getSource().minzoom,b=[];if(!h){const A=r.getSource().maxzoom;if(t.canonical.z>=A){const C=t.canonical.z-A;r.getSource().reparseOverscaled?(g=Math.max(t.canonical.z+2,r.transform.tileZoom),m=new Li(g,t.wrap,A,t.canonical.x>>C,t.canonical.y>>C)):C!==0&&(g=A,m=new Li(g,t.wrap,A,t.canonical.x>>C,t.canonical.y>>C))}m.key!==t.key&&(b.push(m.key),c=r.getTile(m))}const w=A=>{b.forEach(C=>{u[C]=A}),b.length=0};for(g-=1;g>=v&&(!c||!c.hasData());g--){c&&w(c.tileID.key);const A=m.calculateScaledKey(g);if(c=r.getTileByID(A),c&&c.hasData())break;const C=u[A];if(C===null)break;C===void 0?b.push(A):c=r.getTileByID(C)}return w(c?c.tileID.key:null),c&&c.hasData()?c:null}findDEMTileFor(t){return this.enabled?this._findTileCoveringTileID(t,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(t,r){let c=this._tilesDirty[t];c||(c=this._tilesDirty[t]={}),c[r.key]=!0}}function vae(a,t,r){const c=function(g,v,b){const w=ke.dot(v,g),A=ke.dot(b,[.2126,.7152,.0722]),C=(k,z,U)=>(1-U)*k+U*z,P=C(1-.3*Math.min(A,1),1,Math.min(w+1,1));return C(.92,1,Math.asin(ae(v[2],-1,1))/Math.PI+.5)*P}(a,[0,0,1],t),u=[0,0,0];ke.scale(u,r.slice(0,3),c);const h=[0,0,0];ke.scale(h,t.slice(0,3),a[2]);const m=[0,0,0];return ke.add(m,u,h),Ht(m)}const _ae=["fill","fillOutline","fillPattern","line","linePattern","background","backgroundPattern","hillshade","raster"],bae=["stars","fillExtrusion","fillExtrusionGroundEffect","model","symbolSDF","symbolIcon","symbolTextAndIcon"];class k8{static cacheKey(t,r,c,u){let h=`${r}${u?u.cacheKey:""}`;for(const m of c)t.usedDefines.includes(m)&&(h+=`/${m}`);return h}constructor(t,r,c,u,h,m){const g=t.gl;this.program=g.createProgram(),this.configuration=u,this.name=r,this.fixedDefines=[...m];const v=function(W){const $=[];for(let Z=0;Z<W.length;Z++){if(W[Z]===null)continue;const K=W[Z].split(" ");$.push(K.pop())}return $}(c.staticAttributes),b=u?u.getBinderAttributes():[],w=v.concat(b);let A=u?u.defines():[];A=A.concat(m.map(W=>`#define ${W}`));const C=`#version 300 es
`;let P=C+A.concat(w8,w8,x8,b8.fragmentSource).join(`
`);for(const W of c.fragmentIncludes)P+=`
${z3[W]}`;P+=`
${c.fragmentSource}`;let k=C+A.concat(`
#ifdef GL_ES
precision highp float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`,x8,b8.vertexSource).join(`
`);for(const W of c.vertexIncludes)k+=`
${z3[W]}`;k+=`
${c.vertexSource}`;const z=g.createShader(g.FRAGMENT_SHADER);if(g.isContextLost())return void(this.failedToCreate=!0);g.shaderSource(z,P),g.compileShader(z),g.attachShader(this.program,z);const U=g.createShader(g.VERTEX_SHADER);if(g.isContextLost())this.failedToCreate=!0;else{g.shaderSource(U,k),g.compileShader(U),g.attachShader(this.program,U),this.attributes={},this.numAttributes=w.length;for(let W=0;W<this.numAttributes;W++)if(w[W]){const $=w[W].startsWith("a_")?w[W]:`a_${w[W]}`;g.bindAttribLocation(this.program,W,$),this.attributes[$]=W}g.linkProgram(this.program),g.deleteShader(U),g.deleteShader(z),this.fixedUniforms=h(t),this.binderUniforms=u?u.getUniforms(t):[],m.includes("TERRAIN")&&(this.terrainUniforms=(W=>({u_dem:new ci(W),u_dem_prev:new ci(W),u_dem_unpack:new ol(W),u_dem_tl:new pi(W),u_dem_scale:new Jt(W),u_dem_tl_prev:new pi(W),u_dem_scale_prev:new Jt(W),u_dem_size:new Jt(W),u_dem_lerp:new Jt(W),u_exaggeration:new Jt(W),u_depth:new ci(W),u_depth_size_inv:new pi(W),u_meter_to_dem:new Jt(W),u_label_plane_matrix_inv:new $n(W)}))(t)),m.includes("GLOBE")&&(this.globeUniforms=(W=>({u_tile_tl_up:new Zn(W),u_tile_tr_up:new Zn(W),u_tile_br_up:new Zn(W),u_tile_bl_up:new Zn(W),u_tile_up_scale:new Jt(W)}))(t)),m.includes("FOG")&&(this.fogUniforms=(W=>({u_fog_matrix:new $n(W),u_fog_range:new pi(W),u_fog_color:new ol(W),u_fog_horizon_blend:new Jt(W),u_fog_vertical_limit:new pi(W),u_fog_temporal_offset:new Jt(W),u_frustum_tl:new Zn(W),u_frustum_tr:new Zn(W),u_frustum_br:new Zn(W),u_frustum_bl:new Zn(W),u_globe_pos:new Zn(W),u_globe_radius:new Jt(W),u_globe_transition:new Jt(W),u_is_globe:new ci(W),u_viewport:new pi(W)}))(t)),m.includes("RENDER_CUTOFF")&&(this.cutoffUniforms=(W=>({u_cutoff_params:new ol(W)}))(t)),m.includes("LIGHTING_3D_MODE")&&(this.lightsUniforms=(W=>({u_lighting_ambient_color:new Zn(W),u_lighting_directional_dir:new Zn(W),u_lighting_directional_color:new Zn(W),u_ground_radiance:new Zn(W)}))(t)),m.includes("RENDER_SHADOWS")&&(this.shadowUniforms=(W=>({u_light_matrix_0:new $n(W),u_light_matrix_1:new $n(W),u_fade_range:new pi(W),u_shadow_normal_offset:new Zn(W),u_shadow_intensity:new Jt(W),u_shadow_texel_size:new Jt(W),u_shadow_map_resolution:new Jt(W),u_shadow_direction:new Zn(W),u_shadow_bias:new Zn(W),u_shadowmap_0:new ci(W),u_shadowmap_1:new ci(W)}))(t))}}setTerrainUniformValues(t,r){if(!this.terrainUniforms)return;const c=this.terrainUniforms;if(!this.failedToCreate){t.program.set(this.program);for(const u in r)c[u]&&c[u].set(this.program,u,r[u])}}setGlobeUniformValues(t,r){if(!this.globeUniforms)return;const c=this.globeUniforms;if(!this.failedToCreate){t.program.set(this.program);for(const u in r)c[u]&&c[u].set(this.program,u,r[u])}}setFogUniformValues(t,r){if(!this.fogUniforms)return;const c=this.fogUniforms;if(!this.failedToCreate){t.program.set(this.program);for(const u in r)c[u].set(this.program,u,r[u])}}setCutoffUniformValues(t,r){if(!this.cutoffUniforms)return;const c=this.cutoffUniforms;if(!this.failedToCreate){t.program.set(this.program);for(const u in r)c[u].set(this.program,u,r[u])}}setLightsUniformValues(t,r){if(!this.lightsUniforms)return;const c=this.lightsUniforms;if(!this.failedToCreate){t.program.set(this.program);for(const u in r)c[u].set(this.program,u,r[u])}}setShadowUniformValues(t,r){if(this.failedToCreate||!this.shadowUniforms)return;const c=this.shadowUniforms;t.program.set(this.program);for(const u in r)c[u].set(this.program,u,r[u])}_drawDebugWireframe(t,r,c,u,h,m,g,v,b,w){const A=t.options.wireframe;if(A.terrain===!1&&A.layers2D===!1&&A.layers3D===!1)return;const C=t.context;if(!(()=>!(!A.terrain||this.name!=="terrainRaster"&&this.name!=="globeRaster")||!(!A.layers2D||t._terrain&&t._terrain.renderingToTexture||!_ae.includes(this.name))||!(!A.layers3D||!bae.includes(this.name)))())return;const P=C.gl,k=t.wireframeDebugCache.getLinesFromTrianglesBuffer(t.frameCounter,h,C);if(!k)return;const z=[...this.fixedDefines];z.push("DEBUG_WIREFRAME");const U=t.getOrCreateProgram(this.name,{config:this.configuration,defines:z});C.program.set(U.program);const W=(K,q,J)=>{if(q[K]&&J[K])for(const re in q[K])J[K][re]&&J[K][re].set(J.program,re,q[K][re].current)};b&&b.setUniforms(U.program,C,U.binderUniforms,g,{zoom:v}),W("fixedUniforms",this,U),W("terrainUniforms",this,U),W("globeUniforms",this,U),W("fogUniforms",this,U),W("lightsUniforms",this,U),W("shadowUniforms",this,U),k.bind(),C.setColorMode(new Ci([P.ONE,P.ONE_MINUS_SRC_ALPHA,P.ZERO,P.ONE],Sn.transparent,[!0,!0,!0,!1])),C.setDepthMode(new Nn(r.func===P.LESS?P.LEQUAL:r.func,Nn.ReadOnly,r.range)),C.setStencilMode(ui.disabled);const $=3*m.primitiveLength*2,Z=3*m.primitiveOffset*2*2;w&&w>1?P.drawElementsInstanced(P.LINES,$,P.UNSIGNED_SHORT,Z,w):P.drawElements(P.LINES,$,P.UNSIGNED_SHORT,Z),h.bind(),C.program.set(this.program),C.setDepthMode(r),C.setStencilMode(c),C.setColorMode(u)}draw(t,r,c,u,h,m,g,v,b,w,A,C,P,k,z,U){const W=t.context,$=W.gl;if(this.failedToCreate)return;W.program.set(this.program),W.setDepthMode(c),W.setStencilMode(u),W.setColorMode(h),W.setCullFace(m);for(const q of Object.keys(this.fixedUniforms))this.fixedUniforms[q].set(this.program,q,g[q]);k&&k.setUniforms(this.program,W,this.binderUniforms,C,{zoom:P});const Z={[$.LINES]:2,[$.TRIANGLES]:3,[$.LINE_STRIP]:1}[r],K=U&&U>0?1:void 0;for(const q of A.get()){const J=q.vaos||(q.vaos={});(J[v]||(J[v]=new uae)).bind(W,this,b,k?k.getPaintVertexBuffers():[],w,q.vertexOffset,z||[],K),U&&U>1?$.drawElementsInstanced(r,q.primitiveLength*Z,$.UNSIGNED_SHORT,q.primitiveOffset*Z*2,U):$.drawElements(r,q.primitiveLength*Z,$.UNSIGNED_SHORT,q.primitiveOffset*Z*2),r===$.TRIANGLES&&this._drawDebugWireframe(t,c,u,h,w,q,C,P,k,U)}}}function D8(a,t){const r=Math.pow(2,t.tileID.overscaledZ),c=t.tileSize*Math.pow(2,a.transform.tileZoom)/r,u=c*(t.tileID.canonical.x+t.tileID.wrap*r),h=c*t.tileID.canonical.y;return{u_image:0,u_texsize:t.imageAtlasTexture.size,u_tile_units_to_pixels:1/Tm(t,1,a.transform.tileZoom),u_pixel_coord_upper:[u>>16,h>>16],u_pixel_coord_lower:[65535&u,65535&h]}}const xae=rt.create(),O8=(a,t,r,c,u,h,m,g,v,b,w,A,C,P,k)=>{const z=t.style.light,U=z.properties.get("position"),W=[U.x,U.y,U.z],$=Ns.create();z.properties.get("anchor")==="viewport"&&(Ns.fromRotation($,-t.transform.angle),ke.transformMat3(W,W,$));const Z=z.properties.get("color"),K=t.transform,q={u_matrix:a,u_lightpos:W,u_lightintensity:z.properties.get("intensity"),u_lightcolor:[Z.r,Z.g,Z.b],u_vertical_gradient:+r,u_opacity:c,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:xae,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_ao:u,u_edge_radius:h,u_flood_light_color:A,u_vertical_scale:C,u_flood_light_intensity:P,u_ground_shadow_factor:k};return K.projection.name==="globe"&&(q.u_tile_id=[m.canonical.x,m.canonical.y,1<<m.canonical.z],q.u_zoom_transition=v,q.u_inv_rot_matrix=w,q.u_merc_center=b,q.u_up_dir=K.projection.upVector(new ju(0,0,0),b[0]*mt,b[1]*mt),q.u_height_lift=g),q},wae=(a,t,r)=>({u_matrix:a,u_edge_radius:t,u_vertical_scale:r}),Sae=(a,t,r,c,u,h,m,g,v,b,w,A,C,P)=>{const k=O8(a,t,r,c,u,h,m,v,b,w,A,C,P,1,[0,0,0]),z={u_height_factor:-Math.pow(2,m.overscaledZ)/g.tileSize/8};return Fe(k,D8(t,g),z)},N8=(a,t)=>({u_matrix:a,u_emissive_strength:t}),z8=(a,t,r,c)=>Fe(N8(a,t),D8(r,c)),Aae=(a,t,r)=>({u_matrix:a,u_world:r,u_emissive_strength:t}),Eae=(a,t,r,c,u)=>Fe(z8(a,t,r,c),{u_world:u}),Mae=(a,t,r,c)=>{const u=mt/r.tileSize;return{u_matrix:a,u_camera_to_center_distance:t.getCameraToCenterDistance(c),u_extrude_scale:[t.pixelsToGLUnits[0]/u,t.pixelsToGLUnits[1]/u]}},F8=(a,t,r=1)=>({u_matrix:a,u_color:t,u_overlay:0,u_overlay_scale:r}),Tae=rt.create(),Cae=(a,t,r,c,u,h,m)=>{const g=a.transform,v=g.projection.name==="globe",b=v?JN(g.zoom,t.canonical)*g._pixelsPerMercatorPixel:Tm(r,1,h),w={u_matrix:t.projMatrix,u_extrude_scale:b,u_intensity:m,u_inv_rot_matrix:Tae,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(v){w.u_inv_rot_matrix=c,w.u_merc_center=u,w.u_tile_id=[t.canonical.x,t.canonical.y,1<<t.canonical.z],w.u_zoom_transition=yo(g.zoom);const A=u[0]*mt,C=u[1]*mt;w.u_up_dir=g.projection.upVector(new ju(0,0,0),A,C)}return w},B8=(a,t,r,c,u,h,m,g,v,b,w)=>{return{u_matrix:a,u_normalize_matrix:t,u_globe_matrix:r,u_tl_parent:c,u_scale_parent:u,u_fade_t:h.mix,u_opacity:h.opacity*m.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:m.paint.get("raster-brightness-min"),u_brightness_high:m.paint.get("raster-brightness-max"),u_saturation_factor:(C=m.paint.get("raster-saturation"),C>0?1-1/(1.001-C):-C),u_contrast_factor:(A=m.paint.get("raster-contrast"),A>0?1/(1-A):1+A),u_spin_weights:Pae(m.paint.get("raster-hue-rotate")),u_perspective_transform:g,u_colorization_mix:b,u_colorization_scale:Iae(w),u_color_ramp:v};var A,C};function Pae(a){a*=Math.PI/180;const t=Math.sin(a),r=Math.cos(a);return[(2*r+1)/3,(-Math.sqrt(3)*t-r+1)/3,(Math.sqrt(3)*t-r+1)/3]}function Iae([a,t]){if(a===t)return[a,t];const r=(t+a)/2,c=(t-a)/2*256/255;return[-(a=r-c)/((t=r+c)-a),1/(t-a)]}const U8=rt.create(),W8=(a,t,r,c,u,h,m,g,v,b,w,A,C,P,k,z,U)=>{const W=u.transform,$={u_is_size_zoom_constant:+(a==="constant"||a==="source"),u_is_size_feature_constant:+(a==="constant"||a==="camera"),u_size_t:t?t.uSizeT:0,u_size:t?t.uSize:0,u_camera_to_center_distance:W.getCameraToCenterDistance(z),u_rotate_symbol:+r,u_aspect_ratio:W.width/W.height,u_fade_change:u.options.fadeDuration?u.symbolFadeChange:1,u_matrix:h,u_label_plane_matrix:m,u_coord_matrix:g,u_is_text:+v,u_pitch_with_map:+c,u_texsize:b,u_texture:0,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:U8,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:U8,u_up_vector:[0,-1,0],u_icon_transition:U||0};return z.name==="globe"&&($.u_tile_id=[w.canonical.x,w.canonical.y,1<<w.canonical.z],$.u_zoom_transition=A,$.u_inv_rot_matrix=P,$.u_merc_center=C,$.u_camera_forward=W._camera.forward(),$.u_ecef_origin=function(Z,K){const q=[0,0,0],J=Sm(gc(K.canonical));return ke.transformMat4(q,q,J),ke.transformMat4(q,q,Z),q}(W.globeMatrix,w.toUnwrapped()),$.u_tile_matrix=Float32Array.from(W.globeMatrix),$.u_up_vector=k),$},V8=(a,t,r,c,u,h,m,g,v,b,w,A,C,P,k,z,U)=>Fe(W8(a,t,r,c,u,h,m,g,v,b,A,C,P,k,z,U),{u_gamma_scale:c?u.transform.getCameraToCenterDistance(U)*Math.cos(u.terrain?0:u.transform._pitch):1,u_device_pixel_ratio:Cn.devicePixelRatio,u_is_halo:+w,undefined:void 0}),Lae=(a,t,r,c,u,h,m,g,v,b,w,A,C,P,k,z)=>Fe(V8(a,t,r,c,u,h,m,g,!0,v,!0,w,A,C,P,k,z),{u_texsize_icon:b,u_texture_icon:1}),Rae=(a,t,r,c)=>({u_matrix:a,u_emissive_strength:t,u_opacity:r,u_color:c}),kae=(a,t,r,c,u,h,m)=>Fe(function(g,v,b,w){const A=b.imageManager.getPattern(g.toString(),v),{width:C,height:P}=b.imageManager.getPixelSize(v),k=Math.pow(2,w.tileID.overscaledZ),z=w.tileSize*Math.pow(2,b.transform.tileZoom)/k,U=z*(w.tileID.canonical.x+w.tileID.wrap*k),W=z*w.tileID.canonical.y;return{u_image:0,u_pattern_tl:A.tl,u_pattern_br:A.br,u_texsize:[C,P],u_pattern_size:A.displaySize,u_tile_units_to_pixels:1/Tm(w,1,b.transform.tileZoom),u_pixel_coord_upper:[U>>16,W>>16],u_pixel_coord_lower:[65535&U,65535&W]}}(u,h,c,m),{u_matrix:a,u_emissive_strength:t,u_opacity:r}),ll={BaseColor:5,MetallicRoughness:6,Normal:7,Occlusion:8,Emission:9,ShadowMap0:10},x5=(a,t,r,c,u,h,m,g,v,b,w,A=[0,0,0])=>{const C=c.style.light,P=C.properties.get("position"),k=[-P.x,-P.y,P.z],z=Ns.create();C.properties.get("anchor")==="viewport"&&(Ns.fromRotation(z,-c.transform.angle),ke.transformMat3(k,k,z));const U=b.alphaMode==="MASK",W=C.properties.get("color"),$=w.paint.get("model-ambient-occlusion-intensity"),Z=w.paint.get("model-color").constantOr(Sn.white),K=w.paint.get("model-color-mix-intensity").constantOr(0);return{u_matrix:a,u_lighting_matrix:t,u_normal_matrix:r,u_lightpos:k,u_lightintensity:C.properties.get("intensity"),u_lightcolor:[W.r,W.g,W.b],u_camera_pos:A,u_opacity:u,u_baseTextureIsAlpha:0,u_alphaMask:+U,u_alphaCutoff:b.alphaCutoff,u_baseColorFactor:[h.r,h.g,h.b,h.a],u_emissiveFactor:[m[0],m[1],m[2],1],u_metallicFactor:g,u_roughnessFactor:v,u_baseColorTexture:ll.BaseColor,u_metallicRoughnessTexture:ll.MetallicRoughness,u_normalTexture:ll.Normal,u_occlusionTexture:ll.Occlusion,u_emissionTexture:ll.Emission,u_color_mix:[Z.r,Z.g,Z.b,K],u_aoIntensity:$}},G8=new Float32Array(16),H8=(a,t=G8,r=G8)=>({u_matrix:a,u_instance:t,u_node_matrix:r}),Dae={fillExtrusion:a=>({u_matrix:new $n(a),u_lightpos:new Zn(a),u_lightintensity:new Jt(a),u_lightcolor:new Zn(a),u_vertical_gradient:new Jt(a),u_opacity:new Jt(a),u_edge_radius:new Jt(a),u_ao:new pi(a),u_tile_id:new Zn(a),u_zoom_transition:new Jt(a),u_inv_rot_matrix:new $n(a),u_merc_center:new pi(a),u_up_dir:new Zn(a),u_height_lift:new Jt(a),u_flood_light_color:new Zn(a),u_vertical_scale:new Jt(a),u_flood_light_intensity:new Jt(a),u_ground_shadow_factor:new Zn(a)}),fillExtrusionDepth:a=>({u_matrix:new $n(a),u_edge_radius:new Jt(a),u_vertical_scale:new Jt(a)}),fillExtrusionPattern:a=>({u_matrix:new $n(a),u_lightpos:new Zn(a),u_lightintensity:new Jt(a),u_lightcolor:new Zn(a),u_vertical_gradient:new Jt(a),u_height_factor:new Jt(a),u_edge_radius:new Jt(a),u_ao:new pi(a),u_tile_id:new Zn(a),u_zoom_transition:new Jt(a),u_inv_rot_matrix:new $n(a),u_merc_center:new pi(a),u_up_dir:new Zn(a),u_height_lift:new Jt(a),u_image:new ci(a),u_texsize:new pi(a),u_pixel_coord_upper:new pi(a),u_pixel_coord_lower:new pi(a),u_tile_units_to_pixels:new Jt(a),u_opacity:new Jt(a)}),fillExtrusionGroundEffect:a=>({u_matrix:new $n(a),u_opacity:new Jt(a),u_ao_pass:new Jt(a),u_meter_to_tile:new Jt(a),u_ao:new pi(a),u_flood_light_intensity:new Jt(a),u_flood_light_color:new Zn(a),u_attenuation:new Jt(a),u_edge_radius:new Jt(a),u_fb:new ci(a),u_fb_size:new Jt(a)}),fill:a=>({u_matrix:new $n(a),u_emissive_strength:new Jt(a)}),fillPattern:a=>({u_matrix:new $n(a),u_emissive_strength:new Jt(a),u_image:new ci(a),u_texsize:new pi(a),u_pixel_coord_upper:new pi(a),u_pixel_coord_lower:new pi(a),u_tile_units_to_pixels:new Jt(a)}),fillOutline:a=>({u_matrix:new $n(a),u_emissive_strength:new Jt(a),u_world:new pi(a)}),fillOutlinePattern:a=>({u_matrix:new $n(a),u_emissive_strength:new Jt(a),u_world:new pi(a),u_image:new ci(a),u_texsize:new pi(a),u_pixel_coord_upper:new pi(a),u_pixel_coord_lower:new pi(a),u_tile_units_to_pixels:new Jt(a)}),circle:a=>({u_camera_to_center_distance:new Jt(a),u_extrude_scale:new kC(a),u_device_pixel_ratio:new Jt(a),u_matrix:new $n(a),u_inv_rot_matrix:new $n(a),u_merc_center:new pi(a),u_tile_id:new Zn(a),u_zoom_transition:new Jt(a),u_up_dir:new Zn(a),u_emissive_strength:new Jt(a)}),collisionBox:a=>({u_matrix:new $n(a),u_camera_to_center_distance:new Jt(a),u_extrude_scale:new pi(a)}),collisionCircle:a=>({u_matrix:new $n(a),u_inv_matrix:new $n(a),u_camera_to_center_distance:new Jt(a),u_viewport_size:new pi(a)}),debug:a=>({u_color:new nv(a),u_matrix:new $n(a),u_overlay:new ci(a),u_overlay_scale:new Jt(a)}),clippingMask:a=>({u_matrix:new $n(a)}),heatmap:a=>({u_extrude_scale:new Jt(a),u_intensity:new Jt(a),u_matrix:new $n(a),u_inv_rot_matrix:new $n(a),u_merc_center:new pi(a),u_tile_id:new Zn(a),u_zoom_transition:new Jt(a),u_up_dir:new Zn(a)}),heatmapTexture:a=>({u_image:new ci(a),u_color_ramp:new ci(a),u_opacity:new Jt(a)}),hillshade:a=>({u_matrix:new $n(a),u_image:new ci(a),u_latrange:new pi(a),u_light:new pi(a),u_shadow:new nv(a),u_highlight:new nv(a),u_emissive_strength:new Jt(a),u_accent:new nv(a)}),hillshadePrepare:a=>({u_matrix:new $n(a),u_image:new ci(a),u_dimension:new pi(a),u_zoom:new Jt(a),u_unpack:new ol(a)}),line:a=>({u_matrix:new $n(a),u_pixels_to_tile_units:new kC(a),u_device_pixel_ratio:new Jt(a),u_units_to_pixels:new pi(a),u_dash_image:new ci(a),u_gradient_image:new ci(a),u_image_height:new Jt(a),u_texsize:new pi(a),u_tile_units_to_pixels:new Jt(a),u_alpha_discard_threshold:new Jt(a),u_trim_offset:new pi(a),u_emissive_strength:new Jt(a)}),linePattern:a=>({u_matrix:new $n(a),u_texsize:new pi(a),u_pixels_to_tile_units:new kC(a),u_device_pixel_ratio:new Jt(a),u_image:new ci(a),u_units_to_pixels:new pi(a),u_tile_units_to_pixels:new Jt(a),u_alpha_discard_threshold:new Jt(a)}),raster:a=>({u_matrix:new $n(a),u_normalize_matrix:new $n(a),u_globe_matrix:new $n(a),u_tl_parent:new pi(a),u_scale_parent:new Jt(a),u_fade_t:new Jt(a),u_opacity:new Jt(a),u_image0:new ci(a),u_image1:new ci(a),u_brightness_low:new Jt(a),u_brightness_high:new Jt(a),u_saturation_factor:new Jt(a),u_contrast_factor:new Jt(a),u_spin_weights:new Zn(a),u_perspective_transform:new pi(a),u_colorization_mix:new ol(a),u_colorization_scale:new pi(a),u_color_ramp:new ci(a)}),symbolIcon:a=>({u_is_size_zoom_constant:new ci(a),u_is_size_feature_constant:new ci(a),u_size_t:new Jt(a),u_size:new Jt(a),u_camera_to_center_distance:new Jt(a),u_rotate_symbol:new ci(a),u_aspect_ratio:new Jt(a),u_fade_change:new Jt(a),u_matrix:new $n(a),u_label_plane_matrix:new $n(a),u_coord_matrix:new $n(a),u_is_text:new ci(a),u_pitch_with_map:new ci(a),u_texsize:new pi(a),u_tile_id:new Zn(a),u_zoom_transition:new Jt(a),u_inv_rot_matrix:new $n(a),u_merc_center:new pi(a),u_camera_forward:new Zn(a),u_tile_matrix:new $n(a),u_up_vector:new Zn(a),u_ecef_origin:new Zn(a),u_texture:new ci(a),u_icon_transition:new Jt(a)}),symbolSDF:a=>({u_is_size_zoom_constant:new ci(a),u_is_size_feature_constant:new ci(a),u_size_t:new Jt(a),u_size:new Jt(a),u_camera_to_center_distance:new Jt(a),u_rotate_symbol:new ci(a),u_aspect_ratio:new Jt(a),u_fade_change:new Jt(a),u_matrix:new $n(a),u_label_plane_matrix:new $n(a),u_coord_matrix:new $n(a),u_is_text:new ci(a),u_pitch_with_map:new ci(a),u_texsize:new pi(a),u_texture:new ci(a),u_gamma_scale:new Jt(a),u_device_pixel_ratio:new Jt(a),u_tile_id:new Zn(a),u_zoom_transition:new Jt(a),u_inv_rot_matrix:new $n(a),u_merc_center:new pi(a),u_camera_forward:new Zn(a),u_tile_matrix:new $n(a),u_up_vector:new Zn(a),u_ecef_origin:new Zn(a),u_is_halo:new ci(a)}),symbolTextAndIcon:a=>({u_is_size_zoom_constant:new ci(a),u_is_size_feature_constant:new ci(a),u_size_t:new Jt(a),u_size:new Jt(a),u_camera_to_center_distance:new Jt(a),u_rotate_symbol:new ci(a),u_aspect_ratio:new Jt(a),u_fade_change:new Jt(a),u_matrix:new $n(a),u_label_plane_matrix:new $n(a),u_coord_matrix:new $n(a),u_is_text:new ci(a),u_pitch_with_map:new ci(a),u_texsize:new pi(a),u_texsize_icon:new pi(a),u_texture:new ci(a),u_texture_icon:new ci(a),u_gamma_scale:new Jt(a),u_device_pixel_ratio:new Jt(a),u_is_halo:new ci(a)}),background:a=>({u_matrix:new $n(a),u_emissive_strength:new Jt(a),u_opacity:new Jt(a),u_color:new nv(a)}),backgroundPattern:a=>({u_matrix:new $n(a),u_emissive_strength:new Jt(a),u_opacity:new Jt(a),u_image:new ci(a),u_pattern_tl:new pi(a),u_pattern_br:new pi(a),u_texsize:new pi(a),u_pattern_size:new pi(a),u_pixel_coord_upper:new pi(a),u_pixel_coord_lower:new pi(a),u_tile_units_to_pixels:new Jt(a)}),terrainRaster:E8,terrainDepth:E8,skybox:a=>({u_matrix:new $n(a),u_sun_direction:new Zn(a),u_cubemap:new ci(a),u_opacity:new Jt(a),u_temporal_offset:new Jt(a)}),skyboxGradient:a=>({u_matrix:new $n(a),u_color_ramp:new ci(a),u_center_direction:new Zn(a),u_radius:new Jt(a),u_opacity:new Jt(a),u_temporal_offset:new Jt(a)}),skyboxCapture:a=>({u_matrix_3f:new TO(a),u_sun_direction:new Zn(a),u_sun_intensity:new Jt(a),u_color_tint_r:new ol(a),u_color_tint_m:new ol(a),u_luminance:new Jt(a)}),globeRaster:a=>({u_proj_matrix:new $n(a),u_globe_matrix:new $n(a),u_normalize_matrix:new $n(a),u_merc_matrix:new $n(a),u_zoom_transition:new Jt(a),u_merc_center:new pi(a),u_image0:new ci(a),u_grid_matrix:new TO(a),u_skirt_height:new Jt(a),u_frustum_tl:new Zn(a),u_frustum_tr:new Zn(a),u_frustum_br:new Zn(a),u_frustum_bl:new Zn(a),u_globe_pos:new Zn(a),u_globe_radius:new Jt(a),u_viewport:new pi(a)}),globeAtmosphere:a=>({u_frustum_tl:new Zn(a),u_frustum_tr:new Zn(a),u_frustum_br:new Zn(a),u_frustum_bl:new Zn(a),u_horizon:new Jt(a),u_transition:new Jt(a),u_fadeout_range:new Jt(a),u_color:new ol(a),u_high_color:new ol(a),u_space_color:new ol(a),u_temporal_offset:new Jt(a),u_horizon_angle:new Jt(a)}),model:a=>({u_matrix:new $n(a),u_lighting_matrix:new $n(a),u_normal_matrix:new $n(a),u_lightpos:new Zn(a),u_lightintensity:new Jt(a),u_lightcolor:new Zn(a),u_camera_pos:new Zn(a),u_opacity:new Jt(a),u_baseColorFactor:new ol(a),u_emissiveFactor:new ol(a),u_metallicFactor:new Jt(a),u_roughnessFactor:new Jt(a),u_baseTextureIsAlpha:new ci(a),u_alphaMask:new ci(a),u_alphaCutoff:new Jt(a),u_baseColorTexture:new ci(a),u_metallicRoughnessTexture:new ci(a),u_normalTexture:new ci(a),u_occlusionTexture:new ci(a),u_emissionTexture:new ci(a),u_color_mix:new ol(a),u_aoIntensity:new Jt(a)}),modelDepth:a=>({u_matrix:new $n(a),u_instance:new $n(a),u_node_matrix:new $n(a)}),groundShadow:a=>({u_matrix:new $n(a),u_ground_shadow_factor:new Zn(a)}),stars:a=>({u_matrix:new $n(a),u_up:new Zn(a),u_right:new Zn(a),u_intensity_multiplier:new Jt(a)})};let U3;function j8(a,t,r,c,u,h,m){const g=a.context,v=g.gl,b=a.transform,w=a.getOrCreateProgram("collisionBox"),A=[];let C=0,P=0;for(let K=0;K<c.length;K++){const q=c[K],J=t.getTile(q),re=J.getBucket(r);if(!re)continue;const ce=$ie(q,re,b);let ge=ce;u[0]===0&&u[1]===0||(ge=a.translatePosMatrix(ce,J,u,h));const ve=m?re.textCollisionBox:re.iconCollisionBox,Ce=re.collisionCircleArray;if(Ce.length>0){const Ae=rt.create(),Le=ge;rt.mul(Ae,re.placementInvProjMatrix,b.glCoordMatrix),rt.mul(Ae,Ae,re.placementViewportMatrix),A.push({circleArray:Ce,circleOffset:P,transform:Le,invTransform:Ae,projection:re.getProjection()}),C+=Ce.length/4,P=C}ve&&(a.terrain&&a.terrain.setupElevationDraw(J,w),w.draw(a,v.LINES,Nn.disabled,ui.disabled,a.colorModeForRenderPass(),hi.disabled,Mae(ge,b,J,re.getProjection()),r.id,ve.layoutVertexBuffer,ve.indexBuffer,ve.segments,null,b.zoom,null,[ve.collisionVertexBuffer,ve.collisionVertexBufferExt]))}if(!m||!A.length)return;const k=a.getOrCreateProgram("collisionCircle"),z=new Gt;z.resize(4*C),z._trim();let U=0;for(const K of A)for(let q=0;q<K.circleArray.length/4;q++){const J=4*q,re=K.circleArray[J+0],ce=K.circleArray[J+1],ge=K.circleArray[J+2],ve=K.circleArray[J+3];z.emplace(U++,re,ce,ge,ve,0),z.emplace(U++,re,ce,ge,ve,1),z.emplace(U++,re,ce,ge,ve,2),z.emplace(U++,re,ce,ge,ve,3)}(!U3||U3.length<2*C)&&(U3=function(K){const q=2*K,J=new Fn;J.resize(q),J._trim();for(let re=0;re<q;re++){const ce=6*re;J.uint16[ce+0]=4*re+0,J.uint16[ce+1]=4*re+1,J.uint16[ce+2]=4*re+2,J.uint16[ce+3]=4*re+2,J.uint16[ce+4]=4*re+3,J.uint16[ce+5]=4*re+0}return J}(C));const W=g.createIndexBuffer(U3,!0),$=g.createVertexBuffer(z,ate.members,!0);for(const K of A){const q={u_matrix:K.transform,u_inv_matrix:K.invTransform,u_camera_to_center_distance:(Z=b).getCameraToCenterDistance(K.projection),u_viewport_size:[Z.width,Z.height]};k.draw(a,v.TRIANGLES,Nn.disabled,ui.disabled,a.colorModeForRenderPass(),hi.disabled,q,r.id,$,W,ji.simpleSegment(0,2*K.circleOffset,K.circleArray.length,K.circleArray.length/2),null,b.zoom)}var Z;$.destroy(),W.destroy()}const $8=rt.create();function Oae({width:a,height:t,anchor:r,textOffset:c,textScale:u},h){const{horizontalAlign:m,verticalAlign:g}=n3(r),v=-(m-.5)*a,b=-(g-.5)*t,w=RP(r,c);return new V((v/u+w[0])*h,(b/u+w[1])*h)}function Nae(a,t,r,c,u,h,m,g,v,b,w){const A=a.text.placedSymbolArray,C=a.text.dynamicLayoutVertexArray,P=a.icon.dynamicLayoutVertexArray,k={},z=a.getProjection(),U=f5(g,z,h),W=h.elevation,$=z.upVectorScale(g.canonical,h.center.lat,h.worldSize).metersToTile;C.clear();for(let Z=0;Z<A.length;Z++){const K=A.get(Z),{tileAnchorX:q,tileAnchorY:J,numGlyphs:re}=K,ce=K.hidden||!K.crossTileID||a.allowVerticalPlacement&&!K.placedOrientation?null:c[K.crossTileID];if(ce){let ge=0,ve=0,Ce=0;if(W){const ot=W?W.getAtTileOffset(g,q,J):0,[yt,pt,Rt]=z.upVector(g.canonical,q,J);ge=ot*yt*$,ve=ot*pt*$,Ce=ot*Rt*$}let[Ae,Le,Se,Ve]=Zc(K.projectedAnchorX+ge,K.projectedAnchorY+ve,K.projectedAnchorZ+Ce,r?U:m);const Xe=NF(h.getCameraToCenterDistance(z),Ve);let nt=u.evaluateSizeForFeature(a.textSizeData,b,K)*Xe/io;r&&(nt*=a.tilePixelRatio/v);const We=Oae(ce,nt);r?({x:Ae,y:Le,z:Se}=z.projectTilePoint(q+We.x,J+We.y,g.canonical),[Ae,Le,Se]=Zc(Ae+ge,Le+ve,Se+Ce,m)):(t&&We._rotate(-h.angle),Ae+=We.x,Le+=We.y,Se=0);const Ge=a.allowVerticalPlacement&&K.placedOrientation===Aa.vertical?Math.PI/2:0;for(let ot=0;ot<re;ot++)bv(C,Ae,Le,Se,Ge);w&&K.associatedIconIndex>=0&&(k[K.associatedIconIndex]={x:Ae,y:Le,z:Se,angle:Ge})}else wv(re,C)}if(w){P.clear();const Z=a.icon.placedSymbolArray;for(let K=0;K<Z.length;K++){const q=Z.get(K),{numGlyphs:J}=q,re=k[K];if(q.hidden||!re)wv(J,P);else{const{x:ce,y:ge,z:ve,angle:Ce}=re;for(let Ae=0;Ae<J;Ae++)bv(P,ce,ge,ve,Ce)}}a.icon.dynamicLayoutVertexBuffer.updateData(P)}a.text.dynamicLayoutVertexBuffer.updateData(C)}function zae(a,t,r){return r.iconsInText&&t?"symbolTextAndIcon":a?"symbolSDF":"symbolIcon"}function Y8(a,t,r,c,u,h,m,g,v,b,w,A){const C=a.context,P=C.gl,k=a.transform,z=g==="map",U=v==="map",W=z&&r.layout.get("symbol-placement")!=="point",$=z&&!U&&!W,Z=r.layout.get("symbol-sort-key").constantOr(1)!==void 0;let K=!1;const q=a.depthModeForSublayer(0,Nn.ReadOnly),J=[vo(k.center.lng),Co(k.center.lat)],re=r.layout.get("text-variable-anchor"),ce=k.projection.name==="globe",ge=[],ve=[0,-1,0];let Ce=ve;!ce&&!k.mercatorFromTransition||z||(Ce=function(Ae){const Le=Ae._camera.getWorldToCamera(Ae.worldSize,1),Se=rt.multiply([],Le,Ae.globeMatrix);rt.invert(Se,Se);const Ve=[0,0,0],Xe=[0,1,0,0];return Hi.transformMat4(Xe,Xe,Se),Ve[0]=Xe[0],Ve[1]=Xe[1],Ve[2]=Xe[2],ke.normalize(Ve,Ve),Ve}(k));for(const Ae of c){const Le=t.getTile(Ae),Se=Le.getBucket(r);if(!Se||Se.projection.name==="mercator"&&ce)continue;const Ve=u?Se.text:Se.icon;if(!Ve||Se.fullyClipped||!Ve.segments.get().length)continue;const Xe=Ve.programConfigurations.get(r.id),nt=u||Se.sdfIcons,We=u?Se.textSizeData:Se.iconSizeData,Ge=U||k.pitch!==0,ot=Yu(We,k.zoom);let yt,pt,Rt,Ft,St=[0,0],Tt=null;if(u)pt=Le.glyphAtlasTexture,Rt=P.LINEAR,yt=Le.glyphAtlasTexture.size,Se.iconsInText&&(St=Le.imageAtlasTexture.size,Tt=Le.imageAtlasTexture,Ft=Ge||a.options.rotating||a.options.zooming||We.kind==="composite"||We.kind==="camera"?P.LINEAR:P.NEAREST);else{const Ma=r.layout.get("icon-size").constantOr(0)!==1||Se.iconsNeedLinear;pt=Le.imageAtlasTexture,Rt=nt||a.options.rotating||a.options.zooming||Ma||Ge?P.LINEAR:P.NEAREST,yt=Le.imageAtlasTexture.size}const nn=Se.projection.name==="globe",sn=nn?Ce:ve,on=nn?yo(k.zoom):0,cn=f5(Ae,Se.getProjection(),k),yn=k.calculatePixelsToTileUnitsMatrix(Le),kn=x3(cn,Le.tileID.canonical,U,z,k,Se.getProjection(),yn),ii=a.terrain&&U&&W?rt.invert(rt.create(),kn):$8,Ai=OF(cn,Le.tileID.canonical,U,z,k,Se.getProjection(),yn),Yn=re&&Se.hasTextData(),Wn=Se.hasIconTextFit()&&Yn&&Se.hasIconData();if(W){const Ma=k.elevation,Fa=Ma?Ma.getAtTileOffsetFunc(Ae,k.center.lat,k.worldSize,Se.getProjection()):null,Xi=DF(cn,Le.tileID.canonical,U,z,k,Se.getProjection(),yn);Nne(Se,cn,a,u,Xi,Ai,U,b,Fa,Ae)}const In=W||u&&re||Wn,Mn=a.translatePosMatrix(cn,Le,h,m),mi=In?$8:kn,Pi=a.translatePosMatrix(Ai,Le,h,m,!0),ni=Se.getProjection().createInversionMatrix(k,Ae.canonical),qi=r.paint.get("icon-image-cross-fade").constantOr(0),Ea=[];a.terrainRenderModeElevated()&&U&&Ea.push("PITCH_WITH_MAP_TERRAIN"),nn&&(Ea.push("PROJECTION_GLOBE_VIEW"),In&&Ea.push("PROJECTED_POS_ON_VIEWPORT")),qi>0&&Ea.push("ICON_TRANSITION"),Ve.zOffsetVertexBuffer&&Ea.push("Z_OFFSET");const la=nt&&r.paint.get(u?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let ta;ta=nt?Se.iconsInText?Lae(We.kind,ot,$,U,a,Mn,mi,Pi,yt,St,Ae,on,J,ni,sn,Se.getProjection()):V8(We.kind,ot,$,U,a,Mn,mi,Pi,u,yt,!0,Ae,on,J,ni,sn,Se.getProjection()):W8(We.kind,ot,$,U,a,Mn,mi,Pi,u,yt,Ae,on,J,ni,sn,Se.getProjection(),qi);const or={program:a.getOrCreateProgram(zae(nt,u,Se),{config:Xe,defines:Ea}),buffers:Ve,uniformValues:ta,atlasTexture:pt,atlasTextureIcon:Tt,atlasInterpolation:Rt,atlasInterpolationIcon:Ft,isSDF:nt,hasHalo:la,tile:Le,labelPlaneMatrixInv:ii};if(Z&&Se.canOverlap){K=!0;const Ma=Ve.segments.get();for(const Fa of Ma)ge.push({segments:new ji([Fa]),sortKey:Fa.sortKey,state:or})}else ge.push({segments:Ve.segments,sortKey:0,state:or})}K&&ge.sort((Ae,Le)=>Ae.sortKey-Le.sortKey);for(const Ae of ge){const Le=Ae.state;if(a.terrain&&a.terrain.setupElevationDraw(Le.tile,Le.program,{useDepthForOcclusion:!ce&&!k.isOrthographic,labelPlaneMatrixInv:Le.labelPlaneMatrixInv}),C.activeTexture.set(P.TEXTURE0),Le.atlasTexture.bind(Le.atlasInterpolation,P.CLAMP_TO_EDGE),Le.atlasTextureIcon&&(C.activeTexture.set(P.TEXTURE1),Le.atlasTextureIcon&&Le.atlasTextureIcon.bind(Le.atlasInterpolationIcon,P.CLAMP_TO_EDGE)),a.uploadCommonLightUniforms(a.context,Le.program),Le.hasHalo){const Se=Le.uniformValues;Se.u_is_halo=1,w5(Le.buffers,Ae.segments,r,a,Le.program,q,w,A,Se,2),Se.u_is_halo=0}else{if(Le.isSDF){const Se=Le.uniformValues;Le.hasHalo&&(Se.u_is_halo=1,w5(Le.buffers,Ae.segments,r,a,Le.program,q,w,A,Se,1)),Se.u_is_halo=0}w5(Le.buffers,Ae.segments,r,a,Le.program,q,w,A,Le.uniformValues,1)}}}function w5(a,t,r,c,u,h,m,g,v,b){const w=[a.dynamicLayoutVertexBuffer,a.opacityVertexBuffer,a.iconTransitioningVertexBuffer,a.globeExtVertexBuffer,a.zOffsetVertexBuffer];u.draw(c,c.context.gl.TRIANGLES,h,m,g,hi.disabled,v,r.id,a.layoutVertexBuffer,a.indexBuffer,t,r.paint,c.transform.zoom,a.programConfigurations.get(r.id),w,b)}function q8(a,t,r,c,u,h,m){const g=a.context.gl,v=r.paint.get("fill-pattern"),b=v&&v.constantOr(1);let w,A,C,P,k;m?(A=b&&!r.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",w=g.LINES):(A=b?"fillPattern":"fill",w=g.TRIANGLES);for(const z of c){const U=t.getTile(z);if(b&&!U.patternsLoaded())continue;const W=U.getBucket(r);if(!W)continue;a.prepareDrawTile();const $=W.programConfigurations.get(r.id),Z=a.isTileAffectedByFog(z),K=a.getOrCreateProgram(A,{config:$,overrideFog:Z});b&&(a.context.activeTexture.set(g.TEXTURE0),U.imageAtlasTexture.bind(g.LINEAR,g.CLAMP_TO_EDGE),$.updatePaintBuffers());const q=v.constantOr(null);if(q&&U.imageAtlas){const ce=U.imageAtlas.patternPositions[q.toString()];ce&&$.setConstantPatternPositions(ce)}const J=a.translatePosMatrix(z.projMatrix,U,r.paint.get("fill-translate"),r.paint.get("fill-translate-anchor")),re=r.paint.get("fill-emissive-strength");if(m){P=W.indexBuffer2,k=W.segments2;const ce=a.terrain&&a.terrain.renderingToTexture?a.terrain.drapeBufferSize:[g.drawingBufferWidth,g.drawingBufferHeight];C=A==="fillOutlinePattern"&&b?Eae(J,re,a,U,ce):Aae(J,re,ce)}else P=W.indexBuffer,k=W.segments,C=b?z8(J,re,a,U):N8(J,re);a.uploadCommonUniforms(a.context,K,z.toUnwrapped()),K.draw(a,w,u,a.stencilModeForClipping(z),h,hi.disabled,C,r.id,W.layoutVertexBuffer,P,k,r.paint,a.transform.zoom,$,void 0)}}function W3(a,t,r,c,u,h,m,g){const v=a.context,b=v.gl,w=a.transform,A=r.paint.get("fill-extrusion-pattern"),C=A.constantOr(1),P=r.paint.get("fill-extrusion-opacity"),k=a.style.enable3dLights(),z=r.paint.get(k&&!C?"fill-extrusion-ambient-occlusion-wall-radius":"fill-extrusion-ambient-occlusion-radius"),U=[r.paint.get("fill-extrusion-ambient-occlusion-intensity"),z],W=r.layout.get("fill-extrusion-edge-radius"),$=W>0&&!r.paint.get("fill-extrusion-rounded-roof"),Z=$?0:W,K=w.projection.name==="globe"?yB():0,q=w.projection.name==="globe",J=q?yo(w.zoom):0,re=[vo(w.center.lng),Co(w.center.lat)],ce=r.paint.get("fill-extrusion-flood-light-color").toArray01().slice(0,3),ge=r.paint.get("fill-extrusion-flood-light-intensity"),ve=r.paint.get("fill-extrusion-vertical-scale"),Ce=Ev(a,r.paint.get("fill-extrusion-cutoff-fade-range")),Ae=[];let Le;q&&Ae.push("PROJECTION_GLOBE_VIEW"),U[0]>0&&Ae.push("FAUX_AO"),$&&Ae.push("ZERO_ROOF_RADIUS"),g&&Ae.push("HAS_CENTROID"),ge>0&&Ae.push("FLOOD_LIGHT"),Ce.shouldRenderCutoff&&Ae.push("RENDER_CUTOFF");const Se=a.renderPass==="shadow",Ve=a.shadowRenderer,Xe=Se&&!!Ve;a.shadowRenderer&&(a.shadowRenderer.useNormalOffset=!0);let nt=[0,0,0];if(Ve){const Ge=a.style.directionalLight,ot=a.style.ambientLight;Ge&&ot&&(nt=E5(Ge,ot)),Le=Ae.concat(["SHADOWS_SINGLE_CASCADE"])}const We=Xe?"fillExtrusionDepth":C?"fillExtrusionPattern":"fillExtrusion";for(const Ge of c){const ot=t.getTile(Ge),yt=ot.getBucket(r);if(!yt||yt.projection.name!==w.projection.name)continue;let pt=!1;Ve&&(pt=Ve.getMaxCascadeForTile(Ge.toUnwrapped())===0);const Rt=a.isTileAffectedByFog(Ge),Ft=yt.programConfigurations.get(r.id),St=a.getOrCreateProgram(We,{config:Ft,defines:pt?Le:Ae,overrideFog:Rt});if(a.terrain){const cn=a.terrain;a.style.terrainSetForDrapingOnly(),cn.setupElevationDraw(ot,St,{useMeterToDem:!0})}if(!yt.centroidVertexBuffer){const cn=St.attributes.a_centroid_pos;cn!==void 0&&b.vertexAttrib2f(cn,0,0)}!Se&&Ve&&Ve.setupShadows(ot.tileID.toUnwrapped(),St,"vector-tile",ot.tileID.overscaledZ),C&&(a.context.activeTexture.set(b.TEXTURE0),ot.imageAtlasTexture.bind(b.LINEAR,b.CLAMP_TO_EDGE),Ft.updatePaintBuffers());const Tt=A.constantOr(null);if(Tt&&ot.imageAtlas){const cn=ot.imageAtlas.patternPositions[Tt.toString()];cn&&Ft.setConstantPatternPositions(cn)}const nn=r.paint.get("fill-extrusion-vertical-gradient");let sn;if(Se&&Ve){if(Vae(ot.tileID,yt,a))continue;const cn=Ve.calculateShadowPassMatrixFromTile(ot.tileID.toUnwrapped());sn=wae(cn,Z,ve)}else{const cn=a.translatePosMatrix(Ge.projMatrix,ot,r.paint.get("fill-extrusion-translate"),r.paint.get("fill-extrusion-translate-anchor")),yn=w.projection.createInversionMatrix(w,Ge.canonical);sn=C?Sae(cn,a,nn,P,U,Z,Ge,ot,K,J,re,yn,ce,ve):O8(cn,a,nn,P,U,Z,Ge,K,J,re,yn,ce,ve,ge,nt)}a.uploadCommonUniforms(v,St,Ge.toUnwrapped(),null,Ce);const on=[];(a.terrain||g)&&on.push(yt.centroidVertexBuffer),q&&on.push(yt.layoutVertexExtBuffer),St.draw(a,v.gl.TRIANGLES,u,h,m,hi.backCCW,sn,r.id,yt.layoutVertexBuffer,yt.indexBuffer,yt.segments,r.paint,a.transform.zoom,Ft,on)}a.shadowRenderer&&(a.shadowRenderer.useNormalOffset=!1)}function Tv(a,t,r,c,u,h,m,g,v,b,w,A,C,P,k,z,U,W,$){const Z=a.context,K=Z.gl,q=a.transform,J=a.transform.zoom,re=[],ce=Ev(a,r.paint.get("fill-extrusion-cutoff-fade-range"));b==="clear"?(re.push("CLEAR_SUBPASS"),$&&(re.push("CLEAR_FROM_TEXTURE"),Z.activeTexture.set(K.TEXTURE0),$.bind(K.LINEAR,K.CLAMP_TO_EDGE))):b==="sdf"&&re.push("SDF_SUBPASS"),U&&re.push("HAS_CENTROID"),ce.shouldRenderCutoff&&re.push("RENDER_CUTOFF");const ge=r.layout.get("fill-extrusion-edge-radius"),ve=(Ce,Ae,Le,Se,Ve)=>{const Xe=Ae.programConfigurations.get(r.id),nt=a.isTileAffectedByFog(Ce),We=a.getOrCreateProgram("fillExtrusionGroundEffect",{config:Xe,defines:re,overrideFog:nt}),Ge=((yt,pt,Rt,Ft,St,Tt,nn,sn,on,cn,yn)=>({u_matrix:pt,u_opacity:Rt,u_ao_pass:Ft?1:0,u_meter_to_tile:St,u_ao:Tt,u_flood_light_intensity:nn,u_flood_light_color:sn,u_attenuation:on,u_edge_radius:cn,u_fb:0,u_fb_size:yn}))(0,Se,w,v,Ve,[A,C*Ve],P,k,z,J>=17?0:ge*Ve,$?$.size[0]:0),ot=[];U&&ot.push(Ae.hiddenByLandmarkVertexBuffer),a.uploadCommonUniforms(Z,We,Ce.toUnwrapped(),null,ce),We.draw(a,Z.gl.TRIANGLES,u,h,m,g,Ge,r.id,Ae.vertexBuffer,Ae.indexBuffer,Le,r.paint,J,Xe,ot)};for(const Ce of c){const Ae=t.getTile(Ce),Le=Ae.getBucket(r);if(!Le||Le.projection.name!==q.projection.name||!Le.groundEffect||Le.groundEffect&&!Le.groundEffect.hasData())continue;const Se=Le.groundEffect,Ve=1/Le.tileToMeter;{const Xe=a.translatePosMatrix(Ce.projMatrix,Ae,r.paint.get("fill-extrusion-translate"),r.paint.get("fill-extrusion-translate-anchor")),nt=Se.getDefaultSegment();ve(Ce,Se,nt,Xe,Ve)}if(W)for(let Xe=0;Xe<4;Xe++){const nt=HN[Xe](Ce),We=t.getTile(nt);if(!We)continue;const Ge=We.getBucket(r);if(!Ge||Ge.projection.name!==q.projection.name||!Ge.groundEffect||Ge.groundEffect&&!Ge.groundEffect.hasData())continue;const ot=Ge.groundEffect;let yt,pt;Xe===0?(yt=[-mt,0,0],pt=1):Xe===1?(yt=[mt,0,0],pt=0):Xe===2?(yt=[0,-mt,0],pt=3):(yt=[0,mt,0],pt=2);const Rt=ot.regionSegments[pt];if(!Rt)continue;const Ft=new Float32Array(16);rt.translate(Ft,Ce.projMatrix,yt),ve(Ce,ot,Rt,a.translatePosMatrix(Ft,Ae,r.paint.get("fill-extrusion-translate"),r.paint.get("fill-extrusion-translate-anchor")),Ve)}}}function Fae(a,t,r,c,u,h,m){c.centroidVertexArray.length===0&&c.createCentroidsBuffer();const g=h?h.findDEMTileFor(r):null;if(!(g&&g.dem||m))return;const v=W=>{const $=t.getSource().minzoom,Z=q=>{const J=t.getTileByID(q);if(J&&J.hasData())return J.getBucket(u)},K=[0,-1,1];for(const q of K){if(W.overscaledZ+q<$)continue;const J=Z(W.calculateScaledKey(W.overscaledZ+q));if(J)return J}},b=[0,0,0],w=(W,$)=>(b[0]=Math.min(W.min.y,$.min.y),b[1]=Math.max(W.max.y,$.max.y),b[2]=mt-$.min.x>W.max.x?$.min.x-mt:W.max.x,b),A=(W,$)=>(b[0]=Math.min(W.min.x,$.min.x),b[1]=Math.max(W.max.x,$.max.x),b[2]=mt-$.min.y>W.max.y?$.min.y-mt:W.max.y,b),C=[(W,$)=>w(W,$),(W,$)=>w($,W),(W,$)=>A(W,$),(W,$)=>A($,W)],P=(W,$,Z,K,q,J,re)=>{if(!h)return 0;const ce=[[J?Z:W,J?W:Z,0],[J?Z:$,J?$:Z,0]],ge=re<0?mt+re:re,ve=[J?ge:(W+$)/2,J?(W+$)/2:ge,0];return Z===0&&re<0||Z!==0&&re>0?h.getForTilePoints(q,[ve],!0,K):ce.push(ve),h.getForTilePoints(r,ce,!0,g),Math.max(ce[0][2],ce[1][2],ve[2])/h.exaggeration()};for(let W=0;W<4;W++){const $=c.borderFeatureIndices[W];if($.length===0)continue;const Z=HN[W](r),K=v(Z);if(!(K&&K instanceof D1)||c.borderDoneWithNeighborZ[W]===K.canonical.z)continue;K.centroidVertexArray.length===0&&K.createCentroidsBuffer();const q=h?h.findDEMTileFor(Z):null;if(!(q&&q.dem||m))continue;const J=(W<2?1:5)-W,re=K.borderDoneWithNeighborZ[J]!==c.canonical.z,ce=K.borderFeatureIndices[J];let ge=0;if(c.canonical.z!==K.canonical.z){for(const ve of $)c.showCentroid(c.featuresOnBorder[ve]);if(re)for(const ve of ce)K.showCentroid(K.featuresOnBorder[ve]);c.borderDoneWithNeighborZ[W]=K.canonical.z,K.borderDoneWithNeighborZ[J]=c.canonical.z}for(const ve of $){const Ce=c.featuresOnBorder[ve],Ae=c.centroidData[Ce.centroidDataIndex],Le=Ce.borders[W];let Se;for(;ge<ce.length;){Se=K.featuresOnBorder[ce[ge]];const Ve=Se.borders[J];if(Ve[1]>Le[0]+3||Ve[0]>Le[0]-3)break;K.showCentroid(Se),ge++}if(Se&&ge<ce.length){const Ve=ge;let Xe=0;for(;!(Se.borders[J][0]>Le[1]-3)&&(Xe++,++ge!==ce.length);)Se=K.featuresOnBorder[ce[ge]];if(Se=K.featuresOnBorder[ce[Ve]],Xe>1){const Ge=Se.borders[J];Math.abs(Le[0]-Ge[0])<3&&Math.abs(Le[1]-Ge[1])<3&&(Xe=1,ge=Ve+1)}else if(Xe===0){c.showCentroid(Ce);continue}const nt=K.centroidData[Se.centroidDataIndex];m&&Xe===1&&(((z=Ae).flags|(U=nt).flags)&Zu?(z.flags|=Zu,U.flags|=Zu):(z.flags&=2147483647,U.flags&=2147483647));let We=new V(0,0);if(Xe>1)ge=Ve;else if(q&&q.dem&&!(Ce.intersectsCount()>1||Se.intersectsCount()>1)){const Ge=C[W](Ae,nt),ot=W%2?mt-1:0;k=P(Ge[0],Math.min(mt-1,Ge[1]),ot,q,Z,W<2,Ge[2]),We=new V(Math.ceil(7*(k+450)),0)}Ae.centroidXY=nt.centroidXY=We,c.writeCentroidToBuffer(Ae),K.writeCentroidToBuffer(nt)}else c.showCentroid(Ce)}c.borderDoneWithNeighborZ[W]=K.canonical.z,K.borderDoneWithNeighborZ[J]=c.canonical.z}var k,z,U;(c.needsCentroidUpdate||!c.centroidVertexBuffer&&c.centroidVertexArray.length!==0)&&c.uploadCentroid(a)}const Bae=[1,0,0],Uae=[0,1,0],Wae=[0,0,1];function Vae(a,t,r){const c=r.transform,u=r.shadowRenderer;if(!u)return!0;const h=a.toUnwrapped(),m=c.tileSize*u._cascades[r.currentShadowCascade].scale;let g=t.maxHeight;if(c.elevation){const z=c.elevation.getMinMaxForTile(a);z&&(g+=z.max)}const v=[...u.shadowDirection];v[2]=-v[2];const b=u.computeSimplifiedTileShadowVolume(h,g,m,v);if(!b)return!1;const w=[Bae,Uae,Wae,v,[v[0],0,v[2]],[0,v[1],v[2]]],A=c.projection.name==="globe",C=c.scaleZoom(m),P=ah.fromInvProjectionMatrix(c.invProjMatrix,c.worldSize,C,!A),k=u.getCurrentCascadeFrustum();return P.intersectsPrecise(b.vertices,b.planes,w)===0||k.intersectsPrecise(b.vertices,b.planes,w)===0}const Gae=new Sn(1,0,0,1),Hae=new Sn(0,1,0,1),jae=new Sn(0,0,1,1),$ae=new Sn(1,0,1,1),Yae=new Sn(0,1,1,1);function qae(a,t,r){const c=a.context,u=a.transform,h=c.gl,m=u.projection.name==="globe",g=m?["PROJECTION_GLOBE_VIEW"]:[];let v=r.projMatrix;if(m&&yo(u.zoom)>0){const ve=nP(XN(r.canonical,u));v=rt.multiply(new Float32Array(16),u.globeMatrix,ve),rt.multiply(v,u.projMatrix,v)}const b=a.getOrCreateProgram("debug",{defines:g}),w=t.getTileByID(r.key);a.terrain&&a.terrain.setupElevationDraw(w,b);const A=Nn.disabled,C=ui.disabled,P=a.colorModeForRenderPass(),k="$debug";c.activeTexture.set(h.TEXTURE0),a.emptyTexture.bind(h.LINEAR,h.CLAMP_TO_EDGE),m?w._makeGlobeTileDebugBuffers(a.context,u):w._makeDebugTileBoundsBuffers(a.context,u.projection);const z=w._tileDebugBuffer||a.debugBuffer,U=w._tileDebugIndexBuffer||a.debugIndexBuffer,W=w._tileDebugSegments||a.debugSegments;b.draw(a,h.LINE_STRIP,A,C,P,hi.disabled,F8(v,Sn.red),k,z,U,W,null,null,null,[w._globeTileDebugBorderBuffer]);const $=w.latestRawTileData,Z=Math.floor(($&&$.byteLength||0)/1024),K=t.getTile(r).tileSize,q=512/Math.min(K,512)*(r.overscaledZ/u.zoom)*.5;let J=r.canonical.toString();r.overscaledZ!==r.canonical.z&&(J+=` => ${r.overscaledZ}`),J+=` ${Z}kb`,function(ve,Ce){ve.initDebugOverlayCanvas();const Ae=ve.debugOverlayCanvas,Le=ve.context.gl,Se=ve.debugOverlayCanvas.getContext("2d");Se.clearRect(0,0,Ae.width,Ae.height),Se.shadowColor="white",Se.shadowBlur=2,Se.lineWidth=1.5,Se.strokeStyle="white",Se.textBaseline="top",Se.font="bold 36px Open Sans, sans-serif",Se.fillText(Ce,5,5),Se.strokeText(Ce,5,5),ve.debugOverlayTexture.update(Ae),ve.debugOverlayTexture.bind(Le.LINEAR,Le.CLAMP_TO_EDGE)}(a,J);const re=w._tileDebugTextBuffer||a.debugBuffer,ce=w._tileDebugTextIndexBuffer||a.quadTriangleIndexBuffer,ge=w._tileDebugTextSegments||a.debugSegments;b.draw(a,h.TRIANGLES,A,C,Ci.alphaBlended,hi.disabled,F8(v,Sn.transparent,q),k,re,ce,ge,null,null,null,[w._globeTileDebugTextBuffer])}function X8(a,t,r,c){V3(a,0,t+r/2,a.transform.width,r,c)}function Z8(a,t,r,c){V3(a,t-r/2,0,r,a.transform.height,c)}function V3(a,t,r,c,u,h){const m=a.context,g=m.gl;g.enable(g.SCISSOR_TEST),g.scissor(t*Cn.devicePixelRatio,r*Cn.devicePixelRatio,c*Cn.devicePixelRatio,u*Cn.devicePixelRatio),m.clear({color:h}),g.disable(g.SCISSOR_TEST)}const Xae=B([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:Zae}=Xae;function Dp(a,t,r,c){a.emplaceBack(t,r,c)}class K8{constructor(t){this.vertexArray=new Dn,this.indices=new Fn,Dp(this.vertexArray,-1,-1,1),Dp(this.vertexArray,1,-1,1),Dp(this.vertexArray,-1,1,1),Dp(this.vertexArray,1,1,1),Dp(this.vertexArray,-1,-1,-1),Dp(this.vertexArray,1,-1,-1),Dp(this.vertexArray,-1,1,-1),Dp(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=t.createVertexBuffer(this.vertexArray,Zae),this.indexBuffer=t.createIndexBuffer(this.indices),this.segment=ji.simpleSegment(0,0,36,12)}}function Cv(a,t,r,c,u,h){const m=a.context.gl,g=t.paint.get("sky-atmosphere-color"),v=t.paint.get("sky-atmosphere-halo-color"),b=t.paint.get("sky-atmosphere-sun-intensity"),w=((A,C,P,k,z)=>({u_matrix_3f:A,u_sun_direction:C,u_sun_intensity:P,u_color_tint_r:[k.r,k.g,k.b,k.a],u_color_tint_m:[z.r,z.g,z.b,z.a],u_luminance:5e-5}))(Ns.fromMat4(Ns.create(),c),u,b,g,v);m.framebufferTexture2D(m.FRAMEBUFFER,m.COLOR_ATTACHMENT0,m.TEXTURE_CUBE_MAP_POSITIVE_X+h,t.skyboxTexture,0),r.draw(a,m.TRIANGLES,Nn.disabled,ui.disabled,Ci.unblended,hi.frontCW,w,"skyboxCapture",t.skyboxGeometry.vertexBuffer,t.skyboxGeometry.indexBuffer,t.skyboxGeometry.segment)}const Kae=B([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class Jae{constructor(t){const r=new Vi;r.emplaceBack(-1,1,1,0,0),r.emplaceBack(1,1,1,1,0),r.emplaceBack(1,-1,1,1,1),r.emplaceBack(-1,-1,1,0,1);const c=new Fn;c.emplaceBack(0,1,2),c.emplaceBack(2,3,0),this.vertexBuffer=t.createVertexBuffer(r,Kae.members),this.indexBuffer=t.createIndexBuffer(c),this.segments=ji.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const Qae=B([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_size_scale",components:1},{type:"Float32",name:"a_fade_opacity",components:1}]);class ere{constructor(){this.colorModeAlphaBlendedWriteRGB=new Ci([1,_3,1,_3],Sn.transparent,[!0,!0,!0,!1]),this.colorModeWriteAlpha=new Ci([1,0,1,0],Sn.transparent,[!1,!1,!1,!0])}update(t){const r=t.context;if(!this.atmosphereBuffer){this.atmosphereBuffer=new Jae(r);const c=100,u=200,h=function(w){const A=Cy(30),C=[];for(let P=0;P<16e3;++P){const k=2*Math.PI*A(),z=Math.acos(1-2*A())-.5*Math.PI;C.push(ke.fromValues(Math.cos(z)*Math.cos(k),Math.cos(z)*Math.sin(k),Math.sin(z)))}return C}(),m=Cy(300),g=new hc,v=new Fn;let b=0;for(let w=0;w<h.length;++w){const A=ke.scale([],h[w],200),C=Math.max(0,1+.01*c*(1*m()-.5)),P=Math.max(0,1+.01*u*(1*m()-.5));g.emplaceBack(A[0],A[1],A[2],-1,-1,C,P),g.emplaceBack(A[0],A[1],A[2],1,-1,C,P),g.emplaceBack(A[0],A[1],A[2],1,1,C,P),g.emplaceBack(A[0],A[1],A[2],-1,1,C,P),v.emplaceBack(b+0,b+1,b+2),v.emplaceBack(b+0,b+2,b+3),b+=4}this.starsVx=r.createVertexBuffer(g,Qae.members),this.starsIdx=r.createIndexBuffer(v),this.starsSegments=ji.simpleSegment(0,0,g.length,v.length)}}destroy(){this.atmosphereBuffer&&this.atmosphereBuffer.destroy(),this.starsVx&&this.starsVx.destroy(),this.starsIdx&&this.starsIdx.destroy()}drawAtmosphereGlow(t,r){const c=t.context,u=c.gl,h=t.transform,m=new Nn(u.LEQUAL,Nn.ReadOnly,[0,1]),g=yo(h.zoom),v=r.properties.get("color").toArray01(),b=r.properties.get("high-color").toArray01(),w=r.properties.get("space-color").toArray01PremultipliedAlpha(),A=5e-4,C=ae((r.properties.get("horizon-blend")-0)/1*.2495+A,5e-4,.25),P=tz(t,c,h)&&C===A?h.worldSize/(2*Math.PI*1.025)-1:h.globeRadius,k=t.frameCounter/1e3%1,z=ke.length(h.globeCenterInViewSpace),U=Math.sqrt(Math.pow(z,2)-Math.pow(P,2)),W=Math.acos(U/z),$=Z=>{const K=h.projection.name==="globe"?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"];Z&&K.push("ALPHA_PASS");const q=t.getOrCreateProgram("globeAtmosphere",{defines:K}),J=((ce,ge,ve,Ce,Ae,Le,Se,Ve,Xe,nt,We,Ge)=>({u_frustum_tl:ce,u_frustum_tr:ge,u_frustum_br:ve,u_frustum_bl:Ce,u_horizon:Ae,u_transition:Le,u_fadeout_range:Se,u_color:Ve,u_high_color:Xe,u_space_color:nt,u_temporal_offset:We,u_horizon_angle:Ge}))(h.frustumCorners.TL,h.frustumCorners.TR,h.frustumCorners.BR,h.frustumCorners.BL,h.frustumCorners.horizon,g,C,v,b,w,k,W);t.uploadCommonUniforms(c,q);const re=this.atmosphereBuffer;re&&q.draw(t,u.TRIANGLES,m,ui.disabled,Z?this.colorModeWriteAlpha:this.colorModeAlphaBlendedWriteRGB,hi.backCW,J,Z?"atmosphere_glow_alpha":"atmosphere_glow",re.vertexBuffer,re.indexBuffer,re.segments)};$(!1),$(!0)}drawStars(t,r){const c=ae(r.properties.get("star-intensity"),0,1);if(c===0)return;const u=t.context,h=u.gl,m=t.transform,g=t.getOrCreateProgram("stars"),v=To.identity([]);To.rotateX(v,v,-m._pitch),To.rotateZ(v,v,-m.angle),To.rotateX(v,v,ye(m._center.lat)),To.rotateY(v,v,-ye(m._center.lng));const b=rt.fromQuat(new Float32Array(16),v),w=rt.multiply([],m.starsProjMatrix,b),A=Ns.fromMat4([],b),C=Ns.invert([],A),P=[0,1,0];ke.transformMat3(P,P,C),ke.scale(P,P,.15);const k=[1,0,0];ke.transformMat3(k,k,C),ke.scale(k,k,.15);const z=((U,W,$,Z)=>({u_matrix:Float32Array.from(U),u_up:W,u_right:$,u_intensity_multiplier:Z}))(w,P,k,c);t.uploadCommonUniforms(u,g),this.starsVx&&this.starsIdx&&g.draw(t,h.TRIANGLES,Nn.disabled,ui.disabled,this.colorModeAlphaBlendedWriteRGB,hi.disabled,z,"atmosphere_stars",this.starsVx,this.starsIdx,this.starsSegments)}}function J8(a,t){const r=[...a],c=t.cameraWorldSizeForFog/t.worldSize,u=rt.identity([]);return rt.scale(u,u,[c,c,1]),rt.multiply(r,u,r),rt.multiply(r,t.worldToFogMatrix,r),r}function S5(a,t,r,c){const u=r.material,h=c.context,{baseColorTexture:m,metallicRoughnessTexture:g}=u.pbrMetallicRoughness,{normalTexture:v,occlusionTexture:b,emissionTexture:w}=u;function A(C,P,k){if(C&&(a.push(P),h.activeTexture.set(h.gl.TEXTURE0+k),C.gfxTexture)){const{minFilter:z,magFilter:U,wrapS:W,wrapT:$}=C.sampler;C.gfxTexture.bindExtraParam(z,U,W,$)}}A(m,"HAS_TEXTURE_u_baseColorTexture",ll.BaseColor),A(g,"HAS_TEXTURE_u_metallicRoughnessTexture",ll.MetallicRoughness),A(v,"HAS_TEXTURE_u_normalTexture",ll.Normal),A(b,"HAS_TEXTURE_u_occlusionTexture",ll.Occlusion),A(w,"HAS_TEXTURE_u_emissionTexture",ll.Emission),r.texcoordBuffer&&(a.push("HAS_ATTRIBUTE_a_uv_2f"),t.push(r.texcoordBuffer)),r.colorBuffer&&(a.push(r.colorBuffer.itemSize===12?"HAS_ATTRIBUTE_a_color_3f":"HAS_ATTRIBUTE_a_color_4f"),t.push(r.colorBuffer)),r.normalBuffer&&(a.push("HAS_ATTRIBUTE_a_normal_3f"),t.push(r.normalBuffer)),r.pbrBuffer&&(a.push("HAS_ATTRIBUTE_a_pbr"),a.push("HAS_ATTRIBUTE_a_heightBasedEmissiveStrength"),t.push(r.pbrBuffer)),u.alphaMode!=="OPAQUE"&&u.alphaMode!=="MASK"||a.push("UNPREMULT_TEXTURE_IN_SHADER"),u.defined||a.push("DIFFUSE_SHADED"),a.push("USE_STANDARD_DERIVATIVES")}function G3(a,t,r,c,u,h){const m=r.paint.get("model-opacity"),g=t.context,v=new Nn(t.context.gl.LEQUAL,Nn.ReadWrite,t.depthRangeFor3D),b=t.transform,w=a.mesh,A=w.material,C=A.pbrMetallicRoughness,P=t.style.fog;let k;k=t.transform.projection.zAxisUnit==="pixels"?[...a.nodeModelMatrix]:rt.multiply([],c.zScaleMatrix,a.nodeModelMatrix),rt.multiply(k,c.negCameraPosMatrix,k);const z=rt.invert([],k);rt.transpose(z,z);const U=x5(new Float32Array(a.worldViewProjection),new Float32Array(k),new Float32Array(z),t,m,C.baseColorFactor,A.emissiveFactor,C.metallicFactor,C.roughnessFactor,A,r),W={defines:[]},$=[];S5(W.defines,$,w,t);const Z=t.shadowRenderer;Z&&(Z.useNormalOffset=!1);let K=null;if(P){const re=J8(a.nodeModelMatrix,t.transform);if(K=new Float32Array(re),b.projection.name!=="globe"){const ce=w.aabb.min,ge=w.aabb.max,[ve,Ce]=P.getOpacityForBounds(re,ce[0],ce[1],ge[0],ge[1]);W.overrideFog=ve>=Im||Ce>=Im}}const q=Ev(t,r.paint.get("model-cutoff-fade-range"));q.shouldRenderCutoff&&W.defines.push("RENDER_CUTOFF");const J=t.getOrCreateProgram("model",W);t.uploadCommonUniforms(g,J,null,K,q),t.renderPass!=="shadow"&&Z&&Z.setupShadowsFromMatrix(a.nodeModelMatrix,J),J.draw(t,g.gl.TRIANGLES,v,u,h,w.material.doubleSided?hi.disabled:hi.backCCW,U,r.id,w.vertexBuffer,w.indexBuffer,w.segments,r.paint,t.transform.zoom,void 0,$)}function Q8(a,t,r,c,u,h,m){let g;g=a.projection.name==="globe"?$F(r,a):[...r],rt.multiply(g,g,t.matrix);const v=rt.multiply([],c,g);if(t.meshes)for(const b of t.meshes){if(b.material.alphaMode!=="BLEND"){m.push({mesh:b,depth:0,modelIndex:u,worldViewProjection:v,nodeModelMatrix:g});continue}const w=ke.transformMat4([],b.centroid,v);w[2]>0&&h.push({mesh:b,depth:w[2],modelIndex:u,worldViewProjection:v,nodeModelMatrix:g})}if(t.children)for(const b of t.children)Q8(a,b,r,c,u,h,m)}function A5(a,t,r,c){const u=r.shadowRenderer;if(!u)return;const h=u.getShadowPassDepthMode(),m=u.getShadowPassColorMode(),g=u.calculateShadowPassMatrixFromMatrix(t),v=H8(g);r.getOrCreateProgram("modelDepth",{defines:["DEPTH_TEXTURE"]}).draw(r,r.context.gl.TRIANGLES,h,ui.disabled,m,hi.backCCW,v,c.id,a.vertexBuffer,a.indexBuffer,a.segments,c.paint,r.transform.zoom,void 0,void 0)}function tre(a,t,r){const c=t.updateZoomBasedPaintProperties(),u=function(h,m,g){let v,b,w,A=h.terrain?h.terrain.exaggeration():0;if(h.terrain&&A>0){const C=h.terrain,P=C.findDEMTileFor(g);P&&P.dem?v=fv.create(C,g,P):A=0}if(A===0&&(m.terrainElevationMin=0,m.terrainElevationMax=0),A===m.validForExaggeration&&(A===0||v&&v._demTile&&v._demTile.tileID===m.validForDEMTile.id&&v._dem._timestamp===m.validForDEMTile.timestamp))return!1;for(const C in m.instancesPerModel){const P=m.instancesPerModel[C];for(let k=0;k<P.instancedDataArray.length;++k){const z=(v?A*v.getElevationAt(0|P.instancedDataArray.float32[16*k],0|P.instancedDataArray.float32[16*k+1],!0,!0):0)+P.instancesEvaluatedElevation[k];P.instancedDataArray.float32[16*k+6]=z,b=b?Math.min(m.terrainElevationMin,z):z,w=w?Math.max(m.terrainElevationMax,z):z}}return m.terrainElevationMin=b||0,m.terrainElevationMax=w||0,m.validForExaggeration=A,m.validForDEMTile=v&&v._demTile?{id:v._demTile.tileID,timestamp:v._dem._timestamp}:{id:void 0,timestamp:0},!0}(a,t,r);(c||u)&&(t.uploaded=!1,t.upload(a.context))}const Qu={shadowUniformsInitialized:!1,useSingleShadowCascade:!1,tileMatrix:new Float64Array(16),shadowTileMatrix:new Float32Array(16),aabb:new ga([0,0,0],[mt,mt,0])};function nre(a,t){const r=1<<a.canonical.z,c=t.getFreeCameraOptions().position,u=t.elevation,h=a.canonical.x/r,m=(a.canonical.x+1)/r,g=a.canonical.y/r,v=(a.canonical.y+1)/r;let b=t._centerAltitude;if(u){const P=u.getMinMaxForTile(a);P&&P.max>b&&(b=P.max)}const w=ae(c.x,h,m)-c.x,A=ae(c.y,g,v)-c.y,C=$i(b,t.center.lat)-c.z;return t._zoomFromMercatorZ(Math.sqrt(w*w+A*A+C*C))}function e9(a,t,r,c,u,h,m){const g=a.context,v=a.renderPass==="shadow",b=a.shadowRenderer,w=v&&b?b.getShadowPassDepthMode():new Nn(g.gl.LEQUAL,Nn.ReadWrite,a.depthRangeFor3D),A=a.isTileAffectedByFog(h);if(r.meshes)for(const C of r.meshes){const P=["MODEL_POSITION_ON_GPU"],k=[];let z,U,W;c.instancedDataArray.length>20&&P.push("INSTANCED_ARRAYS");const $=Ev(a,t.paint.get("model-cutoff-fade-range"));if($.shouldRenderCutoff&&P.push("RENDER_CUTOFF"),v&&b)z=a.getOrCreateProgram("modelDepth",{defines:P}),U=H8(m.shadowTileMatrix,m.shadowTileMatrix,Float32Array.from(r.matrix)),W=b.getShadowPassColorMode();else{S5(P,k,C,a),z=a.getOrCreateProgram("model",{defines:P,overrideFog:A});const K=C.material,q=K.pbrMetallicRoughness,J=t.paint.get("model-opacity");U=x5(h.projMatrix,Float32Array.from(r.matrix),new Float32Array(16),a,J,q.baseColorFactor,K.emissiveFactor,q.metallicFactor,q.roughnessFactor,K,t,u),b&&(m.shadowUniformsInitialized?z.setShadowUniformValues(g,b.getShadowUniformValues()):(b.setupShadows(h.toUnwrapped(),z,"model-tile",h.overscaledZ),m.shadowUniformsInitialized=!0)),W=$.shouldRenderCutoff||J<1||K.alphaMode!=="OPAQUE"?Ci.alphaBlended:Ci.unblended}a.uploadCommonUniforms(g,z,h.toUnwrapped(),null,$);const Z=C.material.doubleSided?hi.disabled:hi.backCCW;if(c.instancedDataArray.length>20)k.push(c.instancedDataBuffer),z.draw(a,g.gl.TRIANGLES,w,ui.disabled,W,Z,U,t.id,C.vertexBuffer,C.indexBuffer,C.segments,t.paint,a.transform.zoom,void 0,k,c.instancedDataArray.length);else{const K=v?"u_instance":"u_normal_matrix";for(let q=0;q<c.instancedDataArray.length;++q)U[K]=new Float32Array(c.instancedDataArray.arrayBuffer,64*q,16),z.draw(a,g.gl.TRIANGLES,w,ui.disabled,W,Z,U,t.id,C.vertexBuffer,C.indexBuffer,C.segments,t.paint,a.transform.zoom,void 0,k)}}if(r.children)for(const C of r.children)e9(a,t,C,c,u,h,m)}const ire=[1,-1,1];function are(a,t,r,c){if(!r.modelManager)return!0;const u=r.modelManager;if(!r.shadowRenderer)return!0;const h=r.shadowRenderer,m=t.aabb;let g=!0,v=a.maxHeight;if(v===0){let w=0;for(const A in a.instancesPerModel){const C=u.getModel(A,c);C?w=Math.max(w,Math.max(Math.max(C.aabb.max[0],C.aabb.max[1]),C.aabb.max[2])):g=!1}v=a.maxScale*w*1.41+a.maxVerticalOffset,g&&(a.maxHeight=v)}m.max[2]=v,m.min[2]+=a.terrainElevationMin,m.max[2]+=a.terrainElevationMax,ke.transformMat4(m.min,m.min,t.tileMatrix),ke.transformMat4(m.max,m.max,t.tileMatrix);const b=m.intersects(h.getCurrentCascadeFrustum());return r.currentShadowCascade===0&&(a.isInsideFirstShadowMapFrustum=b===2),b===0}class rre{}class ore{constructor(){this._storage=new Map}getLinesFromTrianglesBuffer(t,r,c){{const A=this._storage.get(r.id);if(A)return A.lastUsedFrameIdx=t,A.buf}const u=c.gl,h=u.getBufferParameter(u.ELEMENT_ARRAY_BUFFER,u.BUFFER_SIZE),m=new ArrayBuffer(h),g=new Int16Array(m);u.getBufferSubData(u.ELEMENT_ARRAY_BUFFER,0,new Int16Array(m));const v=new eo;for(let A=0;A<h/2;A+=3){const C=g[A],P=g[A+1],k=g[A+2];v.emplaceBack(C,P),v.emplaceBack(P,k),v.emplaceBack(k,C)}const b=c.bindVertexArrayOES.current,w=new rre;return w.buf=new Lp(c,v),w.lastUsedFrameIdx=t,this._storage.set(r.id,w),c.bindVertexArrayOES.set(b),w.buf}update(t){for(const[r,c]of this._storage)t-c.lastUsedFrameIdx>30&&(c.buf.destroy(),this._storage.delete(r))}destroy(){for(const[t,r]of this._storage)r.buf.destroy(),this._storage.delete(t)}}const t9={symbol:function(a,t,r,c,u){if(a.renderPass!=="translucent")return;const h=ui.disabled,m=a.colorModeForRenderPass();r.layout.get("text-variable-anchor")&&function(g,v,b,w,A,C,P){const k=v.transform,z=A==="map",U=C==="map";for(const W of g){const $=w.getTile(W),Z=$.getBucket(b);if(!Z||!Z.text||!Z.text.segments.get().length)continue;const K=Yu(Z.textSizeData,k.zoom),q=f5(W,Z.getProjection(),k),J=k.calculatePixelsToTileUnitsMatrix($),re=x3(q,$.tileID.canonical,U,z,k,Z.getProjection(),J),ce=Z.hasIconTextFit()&&Z.hasIconData();if(K){const ge=Math.pow(2,k.zoom-$.tileID.overscaledZ);Nae(Z,z,U,P,rte,k,re,W,ge,K,ce)}}}(c,a,r,t,r.layout.get("text-rotation-alignment"),r.layout.get("text-pitch-alignment"),u),r.paint.get("icon-opacity").constantOr(1)!==0&&Y8(a,t,r,c,!1,r.paint.get("icon-translate"),r.paint.get("icon-translate-anchor"),r.layout.get("icon-rotation-alignment"),r.layout.get("icon-pitch-alignment"),r.layout.get("icon-keep-upright"),h,m),r.paint.get("text-opacity").constantOr(1)!==0&&Y8(a,t,r,c,!0,r.paint.get("text-translate"),r.paint.get("text-translate-anchor"),r.layout.get("text-rotation-alignment"),r.layout.get("text-pitch-alignment"),r.layout.get("text-keep-upright"),h,m),t.map.showCollisionBoxes&&(j8(a,t,r,c,r.paint.get("text-translate"),r.paint.get("text-translate-anchor"),!0),j8(a,t,r,c,r.paint.get("icon-translate"),r.paint.get("icon-translate-anchor"),!1))},circle:function(a,t,r,c){if(a.renderPass!=="translucent")return;const u=r.paint.get("circle-opacity"),h=r.paint.get("circle-stroke-width"),m=r.paint.get("circle-stroke-opacity"),g=r.layout.get("circle-sort-key").constantOr(1)!==void 0,v=r.paint.get("circle-emissive-strength");if(u.constantOr(1)===0&&(h.constantOr(1)===0||m.constantOr(1)===0))return;const b=a.context,w=b.gl,A=a.transform,C=a.depthModeForSublayer(0,Nn.ReadOnly),P=ui.disabled,k=a.colorModeForDrapableLayerRenderPass(v),z=A.projection.name==="globe",U=[vo(A.center.lng),Co(A.center.lat)],W=[];for(let Z=0;Z<c.length;Z++){const K=c[Z],q=t.getTile(K),J=q.getBucket(r);if(!J||J.projection.name!==A.projection.name)continue;const re=J.programConfigurations.get(r.id),ce=gz(r),ge=a.isTileAffectedByFog(K);z&&ce.push("PROJECTION_GLOBE_VIEW");const ve=a.getOrCreateProgram("circle",{config:re,defines:ce,overrideFog:ge}),Ce=J.layoutVertexBuffer,Ae=J.globeExtVertexBuffer,Le=J.indexBuffer,Se=A.projection.createInversionMatrix(A,K.canonical),Ve={programConfiguration:re,program:ve,layoutVertexBuffer:Ce,globeExtVertexBuffer:Ae,indexBuffer:Le,uniformValues:nee(a,K,q,Se,U,r),tile:q};if(g){const Xe=J.segments.get();for(const nt of Xe)W.push({segments:new ji([nt]),sortKey:nt.sortKey,state:Ve})}else W.push({segments:J.segments,sortKey:0,state:Ve})}g&&W.sort((Z,K)=>Z.sortKey-K.sortKey);const $={useDepthForOcclusion:!z};for(const Z of W){const{programConfiguration:K,program:q,layoutVertexBuffer:J,globeExtVertexBuffer:re,indexBuffer:ce,uniformValues:ge,tile:ve}=Z.state,Ce=Z.segments;a.terrain&&a.terrain.setupElevationDraw(ve,q,$),a.uploadCommonUniforms(b,q,ve.tileID.toUnwrapped()),q.draw(a,w.TRIANGLES,C,P,k,hi.disabled,ge,r.id,J,ce,Ce,r.paint,A.zoom,K,[re])}},heatmap:function(a,t,r,c){if(r.paint.get("heatmap-opacity")!==0)if(a.renderPass==="offscreen"){const u=a.context,h=u.gl,m=ui.disabled,g=new Ci([h.ONE,h.ONE,h.ONE,h.ONE],Sn.transparent,[!0,!0,!0,!0]);(function(P,k,z,U){const W=P.gl,$=k.width*U,Z=k.height*U;P.activeTexture.set(W.TEXTURE1),P.viewport.set([0,0,$,Z]);let K=z.heatmapFbo;if(!K||K&&(K.width!==$||K.height!==Z)){K&&K.destroy();const q=W.createTexture();W.bindTexture(W.TEXTURE_2D,q),W.texParameteri(W.TEXTURE_2D,W.TEXTURE_WRAP_S,W.CLAMP_TO_EDGE),W.texParameteri(W.TEXTURE_2D,W.TEXTURE_WRAP_T,W.CLAMP_TO_EDGE),W.texParameteri(W.TEXTURE_2D,W.TEXTURE_MIN_FILTER,W.LINEAR),W.texParameteri(W.TEXTURE_2D,W.TEXTURE_MAG_FILTER,W.LINEAR),K=z.heatmapFbo=P.createFramebuffer($,Z,!0,null),function(J,re,ce,ge,ve,Ce){const Ae=J.gl;Ae.texImage2D(Ae.TEXTURE_2D,0,J.extRenderToTextureHalfFloat?Ae.RGBA16F:Ae.RGBA,ve,Ce,0,Ae.RGBA,J.extRenderToTextureHalfFloat?Ae.HALF_FLOAT:Ae.UNSIGNED_BYTE,null),ge.colorAttachment.set(ce)}(P,0,q,K,$,Z)}else W.bindTexture(W.TEXTURE_2D,K.colorAttachment.get()),P.bindFramebuffer.set(K.framebuffer)})(u,a,r,a.transform.projection.name==="globe"?.5:.25),u.clear({color:Sn.transparent});const v=a.transform,b=v.projection.name==="globe",w=b?["PROJECTION_GLOBE_VIEW"]:[],A=b?hi.frontCCW:hi.disabled,C=[vo(v.center.lng),Co(v.center.lat)];for(let P=0;P<c.length;P++){const k=c[P];if(t.hasRenderableParent(k))continue;const z=t.getTile(k),U=z.getBucket(r);if(!U||U.projection.name!==v.projection.name)continue;const W=a.isTileAffectedByFog(k),$=U.programConfigurations.get(r.id),Z=a.getOrCreateProgram("heatmap",{config:$,defines:w,overrideFog:W}),{zoom:K}=a.transform;a.terrain&&a.terrain.setupElevationDraw(z,Z),a.uploadCommonUniforms(u,Z,k.toUnwrapped());const q=v.projection.createInversionMatrix(v,k.canonical);Z.draw(a,h.TRIANGLES,Nn.disabled,m,g,A,Cae(a,k,z,q,C,K,r.paint.get("heatmap-intensity")),r.id,U.layoutVertexBuffer,U.indexBuffer,U.segments,r.paint,a.transform.zoom,$,b?[U.globeExtVertexBuffer]:null)}u.viewport.set([0,0,a.width,a.height])}else a.renderPass==="translucent"&&(a.context.setColorMode(a.colorModeForRenderPass()),function(u,h){const m=u.context,g=m.gl,v=h.heatmapFbo;if(!v)return;m.activeTexture.set(g.TEXTURE0),g.bindTexture(g.TEXTURE_2D,v.colorAttachment.get()),m.activeTexture.set(g.TEXTURE1);let b=h.colorRampTexture;b||(b=h.colorRampTexture=new vr(m,h.colorRamp,g.RGBA)),b.bind(g.LINEAR,g.CLAMP_TO_EDGE),u.getOrCreateProgram("heatmapTexture").draw(u,g.TRIANGLES,Nn.disabled,ui.disabled,u.colorModeForRenderPass(),hi.disabled,((w,A,C,P)=>({u_image:0,u_color_ramp:1,u_opacity:A.paint.get("heatmap-opacity")}))(0,h),h.id,u.viewportBuffer,u.quadTriangleIndexBuffer,u.viewportSegments,h.paint,u.transform.zoom)}(a,r))},line:function(a,t,r,c){if(a.renderPass!=="translucent")return;const u=r.paint.get("line-opacity"),h=r.paint.get("line-width");if(u.constantOr(1)===0||h.constantOr(1)===0)return;const m=r.paint.get("line-emissive-strength"),g=a.depthModeForSublayer(0,Nn.ReadOnly),v=a.colorModeForDrapableLayerRenderPass(m),b=a.terrain&&a.terrain.renderingToTexture?1:Cn.devicePixelRatio,w=r.paint.get("line-dasharray"),A=w.constantOr(1),C=r.layout.get("line-cap"),P=r.paint.get("line-pattern"),k=P.constantOr(1),z=r.paint.get("line-pattern").constantOr(1),U=r.paint.get("line-opacity").constantOr(1)!==1;let W=!z&&U;const $=r.paint.get("line-gradient"),Z=k?"linePattern":"line",K=a.context,q=K.gl,J=AB(r);a.terrain&&a.terrain.clipOrMaskOverlapStencilType()&&(W=!1);for(const re of c){const ce=t.getTile(re);if(k&&!ce.patternsLoaded())continue;const ge=ce.getBucket(r);if(!ge)continue;a.prepareDrawTile();const ve=ge.programConfigurations.get(r.id),Ce=a.isTileAffectedByFog(re),Ae=a.getOrCreateProgram(Z,{config:ve,defines:J,overrideFog:Ce}),Le=P.constantOr(null);if(Le&&ce.imageAtlas){const yt=ce.imageAtlas.patternPositions[Le.toString()];yt&&ve.setConstantPatternPositions(yt)}const Se=w.constantOr(null),Ve=C.constantOr(null);if(!k&&Se&&Ve&&ce.lineAtlas){const yt=ce.lineAtlas.getDash(Se,Ve);yt&&ve.setConstantPatternPositions(yt)}let[Xe,nt]=r.paint.get("line-trim-offset");(Ve==="round"||Ve==="square")&&Xe!==nt&&(Xe===0&&(Xe-=1),nt===1&&(nt+=1));const We=a.terrain?re.projMatrix:null,Ge=k?aie(a,ce,r,We,b):iie(a,ce,r,We,ge.lineClipsArray.length,b,[Xe,nt]);if($){const yt=ge.gradients[r.id];let pt=yt.texture;if(r.gradientVersion!==yt.version){let Rt=256;if(r.stepInterpolant){const Ft=t.getSource().maxzoom,St=re.canonical.z===Ft?Math.ceil(1<<a.transform.maxZoom-re.canonical.z):1;Rt=ae(At(ge.maxLineLength/mt*1024*St),256,K.maxTextureSize)}yt.gradient=V2({expression:r.gradientExpression(),evaluationKey:"lineProgress",resolution:Rt,image:yt.gradient||void 0,clips:ge.lineClipsArray}),yt.texture?yt.texture.update(yt.gradient):yt.texture=new vr(K,yt.gradient,q.RGBA),yt.version=r.gradientVersion,pt=yt.texture}K.activeTexture.set(q.TEXTURE1),pt.bind(r.stepInterpolant?q.NEAREST:q.LINEAR,q.CLAMP_TO_EDGE)}A&&(K.activeTexture.set(q.TEXTURE0),ce.lineAtlasTexture.bind(q.LINEAR,q.REPEAT),ve.updatePaintBuffers()),k&&(K.activeTexture.set(q.TEXTURE0),ce.imageAtlasTexture.bind(q.LINEAR,q.CLAMP_TO_EDGE),ve.updatePaintBuffers()),a.uploadCommonUniforms(K,Ae,re.toUnwrapped());const ot=yt=>{Ae.draw(a,q.TRIANGLES,g,yt,v,hi.disabled,Ge,r.id,ge.layoutVertexBuffer,ge.indexBuffer,ge.segments,r.paint,a.transform.zoom,ve,[ge.layoutVertexBuffer2])};if(W){const yt=a.stencilModeForClipping(re).ref;yt===0&&a.terrain&&K.clear({stencil:0});const pt={func:q.EQUAL,mask:255};Ge.u_alpha_discard_threshold=.8,ot(new ui(pt,yt,255,q.KEEP,q.KEEP,q.INVERT)),Ge.u_alpha_discard_threshold=0,ot(new ui(pt,yt,255,q.KEEP,q.KEEP,q.KEEP))}else ot(a.stencilModeForClipping(re))}W&&(a.resetStencilClippingMasks(),a.terrain&&K.clear({stencil:0}))},fill:function(a,t,r,c){const u=r.paint.get("fill-color"),h=r.paint.get("fill-opacity");if(h.constantOr(1)===0)return;const m=r.paint.get("fill-emissive-strength"),g=a.colorModeForDrapableLayerRenderPass(m),v=r.paint.get("fill-pattern"),b=a.opaquePassEnabledForLayer()&&!v.constantOr(1)&&u.constantOr(Sn.transparent).a===1&&h.constantOr(0)===1?"opaque":"translucent";if(a.renderPass===b){const w=a.depthModeForSublayer(1,a.renderPass==="opaque"?Nn.ReadWrite:Nn.ReadOnly);q8(a,t,r,c,w,g,!1)}if(a.renderPass==="translucent"&&r.paint.get("fill-antialias")){const w=a.depthModeForSublayer(r.getPaintProperty("fill-outline-color")?2:0,Nn.ReadOnly);q8(a,t,r,c,w,g,!0)}},"fill-extrusion":function(a,t,r,c){const u=r.paint.get("fill-extrusion-opacity"),h=a.context,m=h.gl,g=a.terrain,v=g&&g.renderingToTexture,b=r.paint.get("fill-extrusion-cutoff-fade-range");if(u===0)return;const w=a.conflationActive&&a.layerUsedInConflation(r,t.getSource());if(w&&function(A,C,P,k){for(const z of k){const U=C.getTile(z).getBucket(P);U&&(U.updateReplacement(z,A.replacementSource),U.uploadCentroid(A.context))}}(a,t,r,c),g||w)for(const A of c){const C=t.getTile(A).getBucket(r);C&&Fae(a.context,t,A,C,r,g,w)}if(a.renderPass==="shadow"&&a.shadowRenderer){const A=a.shadowRenderer;if(g&&u<.65&&r._transitionablePaint._values["fill-extrusion-opacity"].value.expression instanceof Bc)return;const C=A.getShadowPassDepthMode(),P=A.getShadowPassColorMode();W3(a,t,r,c,C,ui.disabled,P,w)}else if(a.renderPass==="translucent"){const A=!r.paint.get("fill-extrusion-pattern").constantOr(1);if(!v){const C=new Nn(a.context.gl.LEQUAL,Nn.ReadWrite,a.depthRangeFor3D);b===0&&u===1&&A?W3(a,t,r,c,C,ui.disabled,Ci.unblended,w):(W3(a,t,r,c,C,ui.disabled,Ci.disabled,w),W3(a,t,r,c,C,a.stencilModeFor3D(),a.colorModeForRenderPass(),w),a.resetStencilClippingMasks())}if(a.style.enable3dLights()&&A&&(!g&&a.transform.projection.name!=="globe"||v)){const C=r.paint.get("fill-extrusion-opacity"),P=r.paint.get("fill-extrusion-ambient-occlusion-intensity"),k=r.paint.get("fill-extrusion-ambient-occlusion-ground-radius"),z=r.paint.get("fill-extrusion-flood-light-intensity"),U=r.paint.get("fill-extrusion-flood-light-color").toArray01().slice(0,3),W=P>0&&k>0,$=z>0,Z=(q,J,re)=>(1-re)*q+re*J,K=q=>{const J=a.depthModeForSublayer(1,Nn.ReadOnly,m.LEQUAL,!0),re=r.paint.get(q?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),ce=Z(.1,3,re),ge=a._showOverdrawInspector;if(!ge){const ve=new ui({func:m.ALWAYS,mask:255},255,255,m.KEEP,m.KEEP,m.REPLACE),Ce=new Ci([m.ONE,m.ONE,m.ONE,m.ONE],Sn.transparent,[!1,!1,!1,!0],m.MIN);Tv(a,t,r,c,J,ve,Ce,hi.disabled,q,"sdf",C,P,k,z,U,ce,w,!1)}{const ve=ge?ui.disabled:new ui({func:m.EQUAL,mask:255},255,255,m.KEEP,m.DECR,m.DECR),Ce=ge?a.colorModeForRenderPass():new Ci([m.ONE_MINUS_DST_ALPHA,m.DST_ALPHA,m.ONE,m.ONE],Sn.transparent,[!0,!0,!0,!0]);Tv(a,t,r,c,J,ve,Ce,hi.disabled,q,"color",C,P,k,z,U,ce,w,!1)}};if(v){const q=(J,re,ce)=>{const ge=a.depthModeForSublayer(1,Nn.ReadOnly,m.LEQUAL,!1),ve=r.paint.get(J?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),Ce=Z(.1,3,ve);{const Ae=new Ci([m.ONE,m.ONE,m.ONE,m.ONE],Sn.transparent,[!1,!1,!1,!0]);Tv(a,t,r,c,ge,ui.disabled,Ae,hi.disabled,J,"clear",C,P,k,z,U,Ce,w,re)}{const Ae=new ui({func:m.ALWAYS,mask:255},255,255,m.KEEP,m.KEEP,m.REPLACE),Le=new Ci([m.ONE,m.ONE,m.ONE,m.ONE],Sn.transparent,[!1,!1,!1,!0],m.MIN);Tv(a,t,r,c,ge,Ae,Le,hi.disabled,J,"sdf",C,P,k,z,U,Ce,w,re)}{const Ae=J?m.ZERO:m.ONE_MINUS_DST_ALPHA,Le=new ui({func:m.EQUAL,mask:255},255,255,m.KEEP,m.DECR,m.DECR),Se=new Ci([Ae,m.DST_ALPHA,m.ONE_MINUS_DST_ALPHA,m.ZERO],Sn.transparent,[!0,!0,!0,!0]);Tv(a,t,r,c,ge,Le,Se,hi.disabled,J,"color",C,P,k,z,U,Ce,w,re)}{const Ae=new Ci([m.ONE,m.ONE,m.ONE,J?m.ZERO:m.ONE],Sn.transparent,[!1,!1,!1,!0],J?m.FUNC_ADD:m.MAX);Tv(a,t,r,c,ge,ui.disabled,Ae,hi.disabled,J,"clear",C,P,k,z,U,Ce,w,re,ce)}};if(W||$){let J;if(a.prepareDrawTile(),g){const re=g.drapeBufferSize[0],ce=g.drapeBufferSize[1];J=g.framebufferCopyTexture,J&&(!J||J.size[0]===re&&J.size[1]===ce)||(J&&J.destroy(),J=g.framebufferCopyTexture=new vr(h,new Xa({width:re,height:ce}),m.RGBA)),J.bind(m.LINEAR,m.CLAMP_TO_EDGE),m.copyTexImage2D(m.TEXTURE_2D,0,m.RGBA,0,0,re,ce,0)}W&&q(!0,!1,J),$&&q(!1,!0,J)}}else W&&K(!0),$&&K(!1)}}},hillshade:function(a,t,r,c){if(a.renderPass!=="offscreen"&&a.renderPass!=="translucent")return;const u=a.context,h=a.terrain&&a.terrain.renderingToTexture,[m,g]=a.renderPass!=="translucent"||h?[{},c]:a.stencilConfigForOverlap(c);for(const v of g){const b=t.getTile(v);if(b.needsHillshadePrepare&&a.renderPass==="offscreen")pae(a,b,r);else if(a.renderPass==="translucent"){const w=a.depthModeForSublayer(0,Nn.ReadOnly),A=r.paint.get("hillshade-emissive-strength"),C=a.colorModeForDrapableLayerRenderPass(A),P=h&&a.terrain?a.terrain.stencilModeForRTTOverlap(v):m[v.overscaledZ];hae(a,v,b,r,w,P,C)}}u.viewport.set([0,0,a.width,a.height]),a.resetStencilClippingMasks()},raster:function(a,t,r,c,u,h){if(a.renderPass!=="translucent"||r.paint.get("raster-opacity")===0)return;const m=a.context,g=m.gl,v=t.getSource(),b=function(Z,K,q){const J=[];let re,ce;if(Z.paint.get("raster-color")){J.push("RASTER_COLOR"),re=Z.paint.get("raster-color-mix"),ce=Z.paint.get("raster-color-range"),K.activeTexture.set(q.TEXTURE2);let ge=Z.colorRampTexture;ge||(ge=Z.colorRampTexture=new vr(K,Z.colorRamp,q.RGBA)),ge.bind(q.LINEAR,q.CLAMP_TO_EDGE)}return{mix:re,range:ce,defines:J}}(r,m,g),w=b.defines;let A=!1;if(v instanceof Ku&&!c.length){if(a.transform.projection.name!=="globe")return;if(v.onNorthPole)A=!0,w.push("PROJECTION_GLOBE_VIEW");else{if(!v.onSouthPole)return;A=!0,w.push("PROJECTION_GLOBE_VIEW")}}const C=a.colorModeForDrapableLayerRenderPass(),P=a.terrain&&a.terrain.renderingToTexture,k=!a.options.moving,z=r.paint.get("raster-resampling")==="nearest"?g.NEAREST:g.LINEAR;if(A){const Z=t.getSource();if(!(Z instanceof Ku))return;const K=Z.texture;if(!K)return;const q=a.globeSharedBuffers;if(!q)return;const J=new Nn(g.LEQUAL,Nn.ReadWrite,a.depthRangeFor3D),re=Float32Array.from(a.transform.projMatrix);let ce=ez(0,0,a.transform);const ge=Float32Array.from(Sm(gc(new ju(0,0,0)))),ve={opacity:1,mix:0};a.terrain&&a.terrain.prepareDrawTile(),m.activeTexture.set(g.TEXTURE0),K.bind(z,g.CLAMP_TO_EDGE),m.activeTexture.set(g.TEXTURE1),K.bind(z,g.CLAMP_TO_EDGE),K.useMipmap&&m.extTextureFilterAnisotropic&&a.transform.pitch>20&&g.texParameterf(g.TEXTURE_2D,m.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,m.extTextureFilterAnisotropicMax);const[Ce,Ae,Le,Se]=q.getPoleBuffers(0,!0);let Ve;Z.onNorthPole?(Ve=Ce,a.renderDefaultNorthPole=!1):(ce=rt.scale(rt.create(),ce,[1,-1,1]),Ve=Ae,a.renderDefaultSouthPole=!1);const Xe=B8(re,ge,ce,[0,0],1,ve,r,Z.perspectiveTransform||[0,0],2,b.mix||[0,0,0,0],b.range||[0,0]),nt=a.getOrCreateProgram("raster",{defines:b.defines});return a.uploadCommonUniforms(m,nt,null),void nt.draw(a,g.TRIANGLES,J,ui.disabled,C,hi.disabled,Xe,r.id,Ve,Le,Se)}if(!c.length)return;const[U,W]=v instanceof Ku||P?[{},c]:a.stencilConfigForOverlap(c),$=W[W.length-1].overscaledZ;for(const Z of W){const K=P?Nn.disabled:a.depthModeForSublayer(Z.overscaledZ-$,r.paint.get("raster-opacity")===1?Nn.ReadWrite:Nn.ReadOnly,g.LESS),q=Z.toUnwrapped(),J=t.getTile(Z);if(P&&(!J||!J.hasData())||!J.texture)continue;const re=P?Z.projMatrix:a.transform.calculateProjMatrix(q,k),ce=a.terrain&&P?a.terrain.stencilModeForRTTOverlap(Z):U[Z.overscaledZ],ge=h?0:r.paint.get("raster-fade-duration");J.registerFadeDuration(ge);const ve=t.findLoadedParent(Z,0),Ce=L8(J,ve,t,a.transform,ge);let Ae,Le;a.terrain&&a.terrain.prepareDrawTile(),m.activeTexture.set(g.TEXTURE0),J.texture.bind(z,g.CLAMP_TO_EDGE),m.activeTexture.set(g.TEXTURE1),ve?(ve.texture.bind(z,g.CLAMP_TO_EDGE),Ae=Math.pow(2,ve.tileID.overscaledZ-J.tileID.overscaledZ),Le=[J.tileID.canonical.x*Ae%1,J.tileID.canonical.y*Ae%1]):J.texture.bind(z,g.CLAMP_TO_EDGE),J.texture.useMipmap&&m.extTextureFilterAnisotropic&&a.transform.pitch>20&&g.texParameterf(g.TEXTURE_2D,m.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,m.extTextureFilterAnisotropicMax);const Se=v instanceof Ku?v.perspectiveTransform:[0,0],Ve=new Float32Array(16),Xe=B8(re,Ve,Ve,Le||[0,0],Ae||1,Ce,r,Se,2,b.mix||[0,0,0,0],b.range||[0,0]),nt=a.isTileAffectedByFog(Z),We=a.getOrCreateProgram("raster",{defines:b.defines,overrideFog:nt});if(a.uploadCommonUniforms(m,We,q),v instanceof Ku)v.boundsBuffer&&v.boundsSegments&&We.draw(a,g.TRIANGLES,K,ui.disabled,C,hi.disabled,Xe,r.id,v.boundsBuffer,a.quadTriangleIndexBuffer,v.boundsSegments);else{const{tileBoundsBuffer:Ge,tileBoundsIndexBuffer:ot,tileBoundsSegments:yt}=a.getTileBoundsBuffers(J);We.draw(a,g.TRIANGLES,K,ce,C,hi.disabled,Xe,r.id,Ge,ot,yt)}}a.resetStencilClippingMasks()},background:function(a,t,r,c){const u=r.paint.get("background-color"),h=r.paint.get("background-opacity"),m=r.paint.get("background-emissive-strength");if(h===0)return;const g=a.context,v=g.gl,b=a.transform,w=b.tileSize,A=r.paint.get("background-pattern");if(a.isPatternMissing(A,r.scope))return;const C=!A&&u.a===1&&h===1&&a.opaquePassEnabledForLayer()?"opaque":"translucent";if(a.renderPass!==C)return;const P=ui.disabled,k=a.depthModeForSublayer(0,C==="opaque"?Nn.ReadWrite:Nn.ReadOnly),z=a.colorModeForDrapableLayerRenderPass(m),U=A?"backgroundPattern":"background";let W,$=c;$||(W=a.getBackgroundTiles(),$=Object.values(W).map(Z=>Z.tileID)),A&&(g.activeTexture.set(v.TEXTURE0),a.imageManager.bind(a.context,r.scope));for(const Z of $){const K=a.isTileAffectedByFog(Z),q=a.getOrCreateProgram(U,{overrideFog:K}),J=Z.toUnwrapped(),re=c?Z.projMatrix:a.transform.calculateProjMatrix(J);a.prepareDrawTile();const ce=t?t.getTile(Z):W?W[Z.key]:new T1(Z,w,b.zoom,a),ge=A?kae(re,m,h,a,A,r.scope,{tileID:Z,tileSize:w}):Rae(re,m,h,u);a.uploadCommonUniforms(g,q,J);const{tileBoundsBuffer:ve,tileBoundsIndexBuffer:Ce,tileBoundsSegments:Ae}=a.getTileBoundsBuffers(ce);q.draw(a,v.TRIANGLES,k,P,z,hi.disabled,ge,r.id,ve,Ce,Ae)}},sky:function(a,t,r){const c=a._atmosphere?yo(a.transform.zoom):1,u=r.paint.get("sky-opacity")*c;if(u===0)return;const h=a.context,m=r.paint.get("sky-type"),g=new Nn(h.gl.LEQUAL,Nn.ReadOnly,[0,1]),v=a.frameCounter/1e3%1;m==="atmosphere"?a.renderPass==="offscreen"?r.needsSkyboxCapture(a)&&(function(b,w,A,C){const P=b.context,k=P.gl;let z=w.skyboxFbo;if(!z){z=w.skyboxFbo=P.createFramebuffer(32,32,!0,null),w.skyboxGeometry=new K8(P),w.skyboxTexture=P.gl.createTexture(),k.bindTexture(k.TEXTURE_CUBE_MAP,w.skyboxTexture),k.texParameteri(k.TEXTURE_CUBE_MAP,k.TEXTURE_WRAP_S,k.CLAMP_TO_EDGE),k.texParameteri(k.TEXTURE_CUBE_MAP,k.TEXTURE_WRAP_T,k.CLAMP_TO_EDGE),k.texParameteri(k.TEXTURE_CUBE_MAP,k.TEXTURE_MIN_FILTER,k.LINEAR),k.texParameteri(k.TEXTURE_CUBE_MAP,k.TEXTURE_MAG_FILTER,k.LINEAR);for(let Z=0;Z<6;++Z)k.texImage2D(k.TEXTURE_CUBE_MAP_POSITIVE_X+Z,0,k.RGBA,32,32,0,k.RGBA,k.UNSIGNED_BYTE,null)}P.bindFramebuffer.set(z.framebuffer),P.viewport.set([0,0,32,32]);const U=w.getCenter(b,!0),W=b.getOrCreateProgram("skyboxCapture"),$=new Float64Array(16);rt.identity($),rt.rotateY($,$,.5*-Math.PI),Cv(b,w,W,$,U,0),rt.identity($),rt.rotateY($,$,.5*Math.PI),Cv(b,w,W,$,U,1),rt.identity($),rt.rotateX($,$,.5*-Math.PI),Cv(b,w,W,$,U,2),rt.identity($),rt.rotateX($,$,.5*Math.PI),Cv(b,w,W,$,U,3),rt.identity($),Cv(b,w,W,$,U,4),rt.identity($),rt.rotateY($,$,Math.PI),Cv(b,w,W,$,U,5),P.viewport.set([0,0,b.width,b.height])}(a,r),r.markSkyboxValid(a)):a.renderPass==="sky"&&function(b,w,A,C,P){const k=b.context,z=k.gl,U=b.transform,W=b.getOrCreateProgram("skybox");k.activeTexture.set(z.TEXTURE0),z.bindTexture(z.TEXTURE_CUBE_MAP,w.skyboxTexture);const $=((Z,K,q,J,re)=>({u_matrix:Z,u_sun_direction:K,u_cubemap:0,u_opacity:J,u_temporal_offset:re}))(U.skyboxMatrix,w.getCenter(b,!1),0,C,P);b.uploadCommonUniforms(k,W),W.draw(b,z.TRIANGLES,A,ui.disabled,b.colorModeForRenderPass(),hi.backCW,$,"skybox",w.skyboxGeometry.vertexBuffer,w.skyboxGeometry.indexBuffer,w.skyboxGeometry.segment)}(a,r,g,u,v):m==="gradient"&&a.renderPass==="sky"&&function(b,w,A,C,P){const k=b.context,z=k.gl,U=b.transform,W=b.getOrCreateProgram("skyboxGradient");w.skyboxGeometry||(w.skyboxGeometry=new K8(k)),k.activeTexture.set(z.TEXTURE0);let $=w.colorRampTexture;$||($=w.colorRampTexture=new vr(k,w.colorRamp,z.RGBA)),$.bind(z.LINEAR,z.CLAMP_TO_EDGE);const Z=((K,q,J,re,ce)=>({u_matrix:K,u_color_ramp:0,u_center_direction:q,u_radius:ye(J),u_opacity:re,u_temporal_offset:ce}))(U.skyboxMatrix,w.getCenter(b,!1),w.paint.get("sky-gradient-radius"),C,P);b.uploadCommonUniforms(k,W),W.draw(b,z.TRIANGLES,A,ui.disabled,b.colorModeForRenderPass(),hi.backCW,Z,"skyboxGradient",w.skyboxGeometry.vertexBuffer,w.skyboxGeometry.indexBuffer,w.skyboxGeometry.segment)}(a,r,g,u,v)},debug:function(a,t,r){for(let c=0;c<r.length;c++)qae(a,t,r[c])},custom:function(a,t,r,c){const u=a.context,h=r.implementation;if(!a.transform.projection.unsupportedLayers||!a.transform.projection.unsupportedLayers.includes("custom")||a.terrain&&(a.terrain.renderingToTexture||a.renderPass==="offscreen")&&r.isLayerDraped(t)){if(a.renderPass==="offscreen"){const m=h.prerender;if(m){if(a.setCustomLayerDefaults(),u.setColorMode(a.colorModeForRenderPass()),a.transform.projection.name==="globe"){const g=a.transform.pointMerc;m.call(h,u.gl,a.transform.customLayerMatrix(),a.transform.getProjection(),a.transform.globeToMercatorMatrix(),yo(a.transform.zoom),[g.x,g.y],a.transform.pixelsPerMeterRatio)}else m.call(h,u.gl,a.transform.customLayerMatrix());u.setDirty(),a.setBaseState()}}else if(a.renderPass==="translucent"){if(a.terrain&&a.terrain.renderingToTexture){const g=h.renderToTile;if(g){const v=c[0].canonical,b=new vi(v.x+c[0].wrap*(1<<v.z),v.y,v.z);u.setDepthMode(Nn.disabled),u.setStencilMode(ui.disabled),u.setColorMode(a.colorModeForRenderPass()),a.setCustomLayerDefaults(),g.call(h,u.gl,b),u.setDirty(),a.setBaseState()}return}a.setCustomLayerDefaults(),u.setColorMode(a.colorModeForRenderPass()),u.setStencilMode(ui.disabled);const m=h.renderingMode==="3d"?new Nn(a.context.gl.LEQUAL,Nn.ReadWrite,a.depthRangeFor3D):a.depthModeForSublayer(0,Nn.ReadOnly);if(u.setDepthMode(m),a.transform.projection.name==="globe"){const g=a.transform.pointMerc;h.render(u.gl,a.transform.customLayerMatrix(),a.transform.getProjection(),a.transform.globeToMercatorMatrix(),yo(a.transform.zoom),[g.x,g.y],a.transform.pixelsPerMeterRatio)}else h.render(u.gl,a.transform.customLayerMatrix());u.setDirty(),a.setBaseState(),u.bindFramebuffer.set(null)}}else _e("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")},model:function(a,t,r,c){if(a.renderPass==="opaque")return;const u=r.paint.get("model-opacity");if(u===0)return;const h=r.paint.get("model-cast-shadows");if(a.renderPass==="shadow"&&(!h||a.terrain&&u<.65&&r._transitionablePaint._values["model-opacity"].value.expression instanceof Bc))return;const m=a.shadowRenderer,g=r.paint.get("model-receive-shadows");m&&(m.useNormalOffset=!0,g||(m.enabled=!1));const v=()=>{m&&(m.useNormalOffset=!0,g||(m.enabled=!0))},b=t.getSource();if(a.renderPass==="light-beam"&&b.type!=="batched-model")return;if(b.type==="vector"||b.type==="geojson")return function(W,$,Z,K){const q=W.transform;if(q.projection.name!=="mercator")return void _e(`Drawing 3D models for ${q.projection.name} projection is not yet implemented`);const J=q.getFreeCameraOptions().position;if(!W.modelManager)return;const re=W.modelManager,ce=W.shadowRenderer;if(!Z._unevaluatedLayout._values.hasOwnProperty("model-id"))return;const ge=Z._unevaluatedLayout._values["model-id"],ve={...Z.layout.get("model-id").parameters};for(const Ce of K){const Ae=$.getTile(Ce).getBucket(Z);if(!Ae||Ae.projection.name!==q.projection.name)continue;const Le=nre(Ce,q);ve.zoom=Le;const Se=ge.possiblyEvaluate(ve);if(tre(W,Ae,Ce),Qu.shadowUniformsInitialized=!1,Qu.useSingleShadowCascade=!!ce&&ce.getMaxCascadeForTile(Ce.toUnwrapped())===0,W.renderPass==="shadow"&&ce){if(W.currentShadowCascade===1&&Ae.isInsideFirstShadowMapFrustum)continue;const nt=q.calculatePosMatrix(Ce.toUnwrapped(),q.worldSize);if(Qu.tileMatrix.set(nt),Qu.shadowTileMatrix=Float32Array.from(ce.calculateShadowPassMatrixFromMatrix(nt)),Qu.aabb.min.fill(0),Qu.aabb.max[0]=Qu.aabb.max[1]=mt,Qu.aabb.max[2]=0,are(Ae,Qu,W,Z.scope))continue}const Ve=1<<Ce.canonical.z,Xe=[((J.x-Ce.wrap)*Ve-Ce.canonical.x)*mt,(J.y*Ve-Ce.canonical.y)*mt,J.z*Ve*mt];for(let nt in Ae.instancesPerModel){const We=Ae.instancesPerModel[nt];We.features.length>0&&(nt=Se.evaluate(We.features[0].feature,{}));const Ge=re.getModel(nt,Z.scope);if(Ge&&Ge.uploaded)for(const ot of Ge.nodes)e9(W,Z,ot,We,Xe,Ce,Qu)}}}(a,t,r,c),void v();if(!b.loaded())return;if(b.type==="batched-model")return function(W,$,Z,K){const q=W.context,J=W.transform,re=W.style.fog,ce=W.shadowRenderer;if(J.projection.name!=="mercator")return void _e(`Drawing 3D landmark models for ${J.projection.name} projection is not yet implemented`);const ge=W.transform.getFreeCameraOptions().position,ve=ke.scale([],[ge.x,ge.y,ge.z],W.transform.worldSize);ke.negate(ve,ve);const Ce=rt.identity([]),Ae=wp(J.center.lat,J.zoom),Le=rt.fromScaling([],[1,1,1/Ae]);rt.translate(Ce,Ce,ve);const Se=Z.paint.get("model-opacity"),Ve=new Nn(q.gl.LEQUAL,Nn.ReadWrite,W.depthRangeFor3D),Xe=new Nn(q.gl.LEQUAL,Nn.ReadOnly,W.depthRangeFor3D),nt=function(We,Ge){for(const ot of K){const yt=$.getTile(ot).getBucket(Z);if(!yt||!yt.uploaded)continue;let pt=!1;ce&&(pt=ce.getMaxCascadeForTile(ot.toUnwrapped())===0);const Rt=J.calculatePosMatrix(ot.toUnwrapped(),J.worldSize),Ft=yt.modelTraits;for(const St of yt.getNodesInfo()){if(St.hiddenByReplacement||!St.node.meshes)continue;const Tt=St.node,nn=W.renderPass==="light-beam",sn=[...Rt],on=St.evaluatedScale;let cn=0;W.terrain&&Tt.elevation&&(cn=Tt.elevation*W.terrain.exaggeration()),rt.translate(sn,sn,[(Tt.anchor?Tt.anchor[0]:0)*(on[0]-1),(Tt.anchor?Tt.anchor[1]:0)*(on[1]-1),cn]),on!==zne&&rt.scale(sn,sn,on),rt.multiply(sn,sn,Tt.matrix);const yn=rt.multiply([],Le,sn);rt.multiply(yn,Ce,yn);const kn=rt.invert([],yn);rt.transpose(kn,kn),rt.scale(kn,kn,ire);const ii=rt.multiply([],J.projMatrix,sn);for(let Ai=0;Ai<Tt.meshes.length;++Ai){const Yn=Tt.meshes[Ai],Wn=Ai===Tt.lightMeshIndex;if(Wn){if(!nn&&!W.terrain&&W.shadowRenderer){W.currentLayer<W.firstLightBeamLayer&&(W.firstLightBeamLayer=W.currentLayer);continue}}else if(nn)continue;const In={defines:[]},Mn=[];S5(In.defines,Mn,Yn,W),4&Ft||In.defines.push("DIFFUSE_SHADED"),pt&&In.defines.push("SHADOWS_SINGLE_CASCADE");const mi=W.renderPass==="shadow";if(mi){A5(Yn,sn,W,Z);continue}let Pi=null;if(re){const ta=J8(sn,W.transform);if(Pi=new Float32Array(ta),J.projection.name!=="globe"){const or=Yn.aabb.min,Ma=Yn.aabb.max,[Fa,Xi]=re.getOpacityForBounds(ta,or[0],or[1],Ma[0],Ma[1]);In.overrideFog=Fa>=Im||Xi>=Im}}const ni=W.getOrCreateProgram("model",In);!mi&&ce&&(ce.useNormalOffset=!!Yn.normalBuffer,ce.setupShadowsFromMatrix(sn,ni,ce.useNormalOffset)),W.uploadCommonUniforms(q,ni,ot.toUnwrapped(),Pi);const qi=Yn.material,Ea=qi.pbrMetallicRoughness;Ea.metallicFactor=.9,Ea.roughnessFactor=.5;const la=x5(new Float32Array(ii),new Float32Array(yn),new Float32Array(kn),W,Se,Ea.baseColorFactor,qi.emissiveFactor,Ea.metallicFactor,Ea.roughnessFactor,qi,Z);ni.draw(W,q.gl.TRIANGLES,Ge&&!Wn?Ve:Xe,ui.disabled,We?Wn||Se<1||St.hasTranslucentParts?Ci.alphaBlended:Ci.unblended:Ci.disabled,hi.backCCW,la,Z.id,Yn.vertexBuffer,Yn.indexBuffer,Yn.segments,Z.paint,W.transform.zoom,void 0,Mn)}}}};(function(We,Ge,ot,yt){const pt=We.terrain?We.terrain.exaggeration():0,Rt=We.transform.zoom;for(const Ft of yt){const St=Ge.getTile(Ft).getBucket(ot);St&&(We.conflationActive&&St.updateReplacement(Ft,We.replacementSource),St.evaluateScale(We,ot),We.terrain&&pt>0&&St.elevationUpdate(We.terrain,pt,Ft,ot.source),St.needsReEvaluation(We,Rt,ot)&&St.evaluate(ot))}})(W,$,Z,K),Se===1?nt(!0,!0):(nt(!1,!0),nt(!0,!1))}(a,t,r,c),void v();const w=b.getModels(),A=[],C=a.transform.getFreeCameraOptions().position,P=ke.scale([],[C.x,C.y,C.z],a.transform.worldSize);ke.negate(P,P);const k=[],z=[];let U=0;for(const W of w){const $=r.paint.get("model-rotation").constantOr(null),Z=r.paint.get("model-scale").constantOr(null),K=r.paint.get("model-translation").constantOr(null);W.computeModelMatrix(a,$,Z,K,!0,!0,!1);const q=rt.identity([]),J=wp(W.position.lat,a.transform.zoom),re=rt.fromScaling([],[1,1,1/J]);rt.translate(q,q,P),A.push({zScaleMatrix:re,negCameraPosMatrix:q});for(const ce of W.nodes)Q8(a.transform,ce,W.matrix,a.transform.projMatrix,U,k,z);U++}if(k.sort((W,$)=>$.depth-W.depth),a.renderPass!=="shadow"){if(u===1)for(const W of z)G3(W,a,r,A[W.modelIndex],ui.disabled,a.colorModeForRenderPass());else{for(const W of z)G3(W,a,r,A[W.modelIndex],ui.disabled,Ci.disabled);for(const W of z)G3(W,a,r,A[W.modelIndex],a.stencilModeFor3D(),a.colorModeForRenderPass());a.resetStencilClippingMasks()}for(const W of k)G3(W,a,r,A[W.modelIndex],ui.disabled,a.colorModeForRenderPass());v()}else{for(const W of z)A5(W.mesh,W.nodeModelMatrix,a,r);for(const W of k)A5(W.mesh,W.nodeModelMatrix,a,r);v()}}},n9={modelUpload:function(a,t,r){const c=t.getSource();if(!c.loaded())return;if(c.type==="vector"||c.type==="geojson")return void(a.modelManager&&a.modelManager.upload(a,r));if(c.type==="batched-model")return;const u=c.getModels();for(const h of u)h.upload(a.context)}};class sre{constructor(t,r){this.context=new Mne(t),this.transform=r,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.setup(),this.numSublayers=Xc.maxUnderzooming+Xc.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={},this.conflationActive=!1,this.replacementSource=new Gne,this.longestCutoffRange=0,this.minCutoffZoom=0,this._fogVisible=!1,this._cachedTileFogOpacities={},this._shadowRenderer=new ure(this),this._wireframeDebugCache=new ore,this.renderDefaultNorthPole=!0,this.renderDefaultSouthPole=!0}updateTerrain(t,r){const c=!!t&&!!t.terrain&&this.transform.projection.supportsTerrain;if(!(c||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new yae(this,t));const u=this._terrain;this.transform.elevation=c?u:null,u.update(t,this.transform,r),this.transform.elevation&&!u.enabled&&(this.transform.elevation=null)}_updateFog(t){const r=t.fog;if(!r||this.transform.projection.name==="globe"||r.getOpacity(this.transform.pitch)<1||r.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[c,u]=r.getFovAdjustedRange(this.transform._fov);if(c>u)return void(this.transform.fogCullDistSq=null);const h=c+.78*(u-c);this.transform.fogCullDistSq=h*h}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled?this._terrain:null}get shadowRenderer(){return this._shadowRenderer&&this._shadowRenderer.enabled?this._shadowRenderer:null}get wireframeDebugCache(){return this._wireframeDebugCache}resize(t,r){if(this.width=t*Cn.devicePixelRatio,this.height=r*Cn.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const c of this.style.order)this.style._mergedLayers[c].resize()}setup(){const t=this.context,r=new ee;r.emplaceBack(0,0),r.emplaceBack(mt,0),r.emplaceBack(0,mt),r.emplaceBack(mt,mt),this.tileExtentBuffer=t.createVertexBuffer(r,_p.members),this.tileExtentSegments=ji.simpleSegment(0,0,4,2);const c=new ee;c.emplaceBack(0,0),c.emplaceBack(mt,0),c.emplaceBack(0,mt),c.emplaceBack(mt,mt),this.debugBuffer=t.createVertexBuffer(c,_p.members),this.debugSegments=ji.simpleSegment(0,0,4,5);const u=new ee;u.emplaceBack(-1,-1),u.emplaceBack(1,-1),u.emplaceBack(-1,1),u.emplaceBack(1,1),this.viewportBuffer=t.createVertexBuffer(u,_p.members),this.viewportSegments=ji.simpleSegment(0,0,4,2);const h=new Ye;h.emplaceBack(0,0,0,0),h.emplaceBack(mt,0,mt,0),h.emplaceBack(0,mt,0,mt),h.emplaceBack(mt,mt,mt,mt),this.mercatorBoundsBuffer=t.createVertexBuffer(h,FP.members),this.mercatorBoundsSegments=ji.simpleSegment(0,0,4,2);const m=new Fn;m.emplaceBack(0,1,2),m.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=t.createIndexBuffer(m);const g=new r1;for(const b of[0,1,3,2,0])g.emplaceBack(b);this.debugIndexBuffer=t.createIndexBuffer(g),this.emptyTexture=new vr(t,new Xa({width:1,height:1},Uint8Array.of(0,0,0,0)),t.gl.RGBA),this.identityMat=rt.create();const v=this.context.gl;this.stencilClearMode=new ui({func:v.ALWAYS,mask:0},0,255,v.ZERO,v.ZERO,v.ZERO),this.loadTimeStamps.push(f.performance.now())}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(t){return t._makeTileBoundsBuffers(this.context,this.transform.projection),t._tileBoundsBuffer?{tileBoundsBuffer:t._tileBoundsBuffer,tileBoundsIndexBuffer:t._tileBoundsIndexBuffer,tileBoundsSegments:t._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const t=this.context.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.getOrCreateProgram("clippingMask").draw(this,t.TRIANGLES,Nn.disabled,this.stencilClearMode,Ci.disabled,hi.disabled,b5(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(t,r,c){if(!r||this.currentStencilSource===r.id||!t.isTileClipped()||!c||c.length===0)return;if(this._tileClippingMaskIDs&&!this.terrain){let g=!1;for(const v of c)if(this._tileClippingMaskIDs[v.key]===void 0){g=!0;break}if(!g)return}this.currentStencilSource=r.id;const u=this.context,h=u.gl;this.nextStencilID+c.length>256&&this.clearStencil(),u.setColorMode(Ci.disabled),u.setDepthMode(Nn.disabled);const m=this.getOrCreateProgram("clippingMask");this._tileClippingMaskIDs={};for(const g of c){const v=r.getTile(g),b=this._tileClippingMaskIDs[g.key]=this.nextStencilID++,{tileBoundsBuffer:w,tileBoundsIndexBuffer:A,tileBoundsSegments:C}=this.getTileBoundsBuffers(v);m.draw(this,h.TRIANGLES,Nn.disabled,new ui({func:h.ALWAYS,mask:0},b,255,h.KEEP,h.KEEP,h.REPLACE),Ci.disabled,hi.disabled,b5(g.projMatrix),"$clipping",w,A,C)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const t=this.nextStencilID++,r=this.context.gl;return new ui({func:r.NOTEQUAL,mask:255},t,255,r.KEEP,r.KEEP,r.REPLACE)}stencilModeForClipping(t){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(t);const r=this.context.gl;return new ui({func:r.EQUAL,mask:255},this._tileClippingMaskIDs[t.key],0,r.KEEP,r.KEEP,r.REPLACE)}stencilConfigForOverlap(t){const r=this.context.gl,c=t.sort((m,g)=>g.overscaledZ-m.overscaledZ),u=c[c.length-1].overscaledZ,h=c[0].overscaledZ-u+1;if(h>1){this.currentStencilSource=void 0,this.nextStencilID+h>256&&this.clearStencil();const m={};for(let g=0;g<h;g++)m[g+u]=new ui({func:r.GEQUAL,mask:255},g+this.nextStencilID,255,r.KEEP,r.KEEP,r.REPLACE);return this.nextStencilID+=h,[m,c]}return[{[u]:ui.disabled},c]}colorModeForRenderPass(){const t=this.context.gl;return this._showOverdrawInspector?new Ci([t.CONSTANT_COLOR,t.ONE,t.CONSTANT_COLOR,t.ONE],new Sn(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Ci.unblended:Ci.alphaBlended}colorModeForDrapableLayerRenderPass(t){const r=this.context.gl;return(()=>this.style&&this.style.enable3dLights()&&this.terrain&&this.terrain.renderingToTexture)()&&this.renderPass==="translucent"?new Ci([r.ONE,r.ONE_MINUS_SRC_ALPHA,r.CONSTANT_ALPHA,r.ONE_MINUS_SRC_ALPHA],new Sn(0,0,0,t===void 0?0:t),[!0,!0,!0,!0]):this.colorModeForRenderPass()}depthModeForSublayer(t,r,c,u=!1){if(!this.opaquePassEnabledForLayer()&&!u)return Nn.disabled;const h=1-((1+this.currentLayer)*this.numSublayers+t)*this.depthEpsilon;return new Nn(c||this.context.gl.LEQUAL,r,[h,h])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(t,r){this._wireframeDebugCache.update(this.frameCounter),this.style=t,this.options=r;const c=this.style._mergedLayers,u=this.style.order,h=u.map(q=>c[q]),m=this.style._mergedSourceCaches;this.imageManager=t.imageManager,this.modelManager=t.modelManager,this.symbolFadeChange=t.placement.symbolFadeChange(Cn.now()),this.imageManager.beginFrame();let g=0,v=!1;for(const q in m){const J=m[q];J.used&&(J.prepare(this.context),J.getSource().usedInConflation&&++g)}const b={},w={},A={},C={},P={};for(const q in m){const J=m[q];b[q]=J.getVisibleCoordinates(),w[q]=b[q].slice().reverse(),A[q]=J.getVisibleCoordinates(!0).reverse(),C[q]=J.getShadowCasterCoordinates(),P[q]=J.sortCoordinatesByDistance(b[q])}const k=q=>{const J=this.style.getLayerSourceCache(q);return J&&J.used?J.getSource():null};if(g){const q=[];for(const J of h)this.layerUsedInConflation(J,k(J))&&q.push(J);if(q&&q.length>1){const J=[];for(const re of q){const ce=this.style.getLayerSourceCache(re);ce&&ce.used&&ce.getSource().usedInConflation&&J.push({layer:re.fqid,cache:ce})}this.replacementSource.setSources(J),v=!0}}v||this.replacementSource.clear(),this.conflationActive=v,this.minCutoffZoom=0,this.longestCutoffRange=0;for(const q of h){const J=q.cutoffRange();if(this.longestCutoffRange=Math.max(J,this.longestCutoffRange),J>0){const re=k(q);re&&(this.minCutoffZoom=Math.max(re.minzoom,this.minCutoffZoom)),q.minzoom&&(this.minCutoffZoom=Math.max(q.minzoom,this.minCutoffZoom))}}this.opaquePassCutoff=1/0;for(let q=0;q<h.length;q++)if(h[q].is3D()){this.opaquePassCutoff=q;break}const z=this.style&&this.style.fog;z?(this._fogVisible=z.getOpacity(this.transform.pitch)!==0,this._fogVisible&&this.transform.projection.name!=="globe"&&(this._fogVisible=z.isVisibleOnFrustum(this.transform.cameraFrustum))):this._fogVisible=!1,this._cachedTileFogOpacities={},this.terrain&&(this.terrain.updateTileBinding(A),this.opaquePassCutoff=0);const U=this._shadowRenderer;if(U){U.updateShadowParameters(this.transform,this.style.directionalLight);for(const q in m)for(const J of b[q]){let re={min:0,max:0};this.terrain&&(re=this.terrain.getMinMaxForTile(J)||re),U.addShadowReceiver(J.toUnwrapped(),re.min,re.max)}}this.transform.projection.name!=="globe"||this.globeSharedBuffers||(this.globeSharedBuffers=new HQ(this.context));for(const q of h){if(q.isHidden(this.transform.zoom))continue;const J=t.getLayerSourceCache(q);this.uploadLayer(this,q,J)}if(this.style.fog&&this.transform.projection.supportsFog?(this._atmosphere||(this._atmosphere=new ere),this._atmosphere.update(this)):this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0),!ra.has(this.context.gl))return;this.renderPass="offscreen";for(const q of h){const J=t.getLayerSourceCache(q);if(!q.hasOffscreenPass()||q.isHidden(this.transform.zoom))continue;const re=J?w[J.id]:void 0;(q.type==="custom"||q.type==="raster"||q.isSky()||re&&re.length)&&this.renderLayer(this,J,q,re)}this.depthRangeFor3D=[0,1-(h.length+2)*this.numSublayers*this.depthEpsilon];const W=this.terrain;W&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&!this.transform.isOrthographic&&W.drawDepth(),this._shadowRenderer&&(this.renderPass="shadow",this._shadowRenderer.drawShadowPass(this.style,C)),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]);const $=this.transform.projection.name==="globe"||this.transform.isHorizonVisible(),Z=(()=>{if(r.showOverdrawInspector)return Sn.black;if(this.style.fog&&this.transform.projection.supportsFog&&!$){const q=this.style.fog.properties.get("color").toArray01();return new Sn(...q)}if(this.style.fog&&this.transform.projection.supportsFog&&$){const q=this.style.fog.properties.get("space-color").toArray01();return new Sn(...q)}return Sn.transparent})();if(this.context.clear({color:Z,depth:1}),this.clearStencil(),this._showOverdrawInspector=r.showOverdrawInspector,this.renderPass="opaque",this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&$&&this._atmosphere.drawStars(this,this.style.fog),!this.terrain)for(this.currentLayer=u.length-1;this.currentLayer>=0;this.currentLayer--){const q=h[this.currentLayer],J=t.getLayerSourceCache(q);if(q.isSky())continue;const re=J?(q.is3D()?P:w)[J.id]:void 0;this._renderTileClippingMasks(q,J,re),this.renderLayer(this,J,q,re)}if(this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&$&&this._atmosphere.drawAtmosphereGlow(this,this.style.fog),this.renderPass="sky",(!this._atmosphere||yo(this.transform.zoom)>0)&&(this.transform.projection.name==="globe"||this.transform.isHorizonVisible()))for(this.currentLayer=0;this.currentLayer<u.length;this.currentLayer++){const q=h[this.currentLayer],J=t.getLayerSourceCache(q);q.isSky()&&this.renderLayer(this,J,q,J?w[J.id]:void 0)}this.renderPass="translucent",this.currentLayer=0,this.firstLightBeamLayer=Number.MAX_SAFE_INTEGER;let K=0;for(U&&(K=U.getShadowCastingLayerCount());this.currentLayer<u.length;){const q=h[this.currentLayer],J=t.getLayerSourceCache(q);if(q.isSky()){++this.currentLayer;continue}if(W&&this.style.isLayerDraped(q)){if(q.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=W.renderBatch(this.currentLayer);continue}let re;if(J&&(re=(q.type==="symbol"?A:q.is3D()?P:w)[J.id]),this._renderTileClippingMasks(q,J,J?b[J.id]:void 0),this.renderLayer(this,J,q,re),!W&&U&&K>0&&q.hasShadowPass()&&--K==0&&(U.drawGroundShadows(),this.firstLightBeamLayer<=this.currentLayer)){const ce=this.currentLayer;for(this.renderPass="light-beam",this.currentLayer=this.firstLightBeamLayer;this.currentLayer<=ce;this.currentLayer++){const ge=h[this.currentLayer];if(!ge.hasLightBeamPass())continue;const ve=t.getLayerSourceCache(ge);this.renderLayer(this,ve,ge,ve?w[ve.id]:void 0)}this.currentLayer=ce,this.renderPass="translucent"}++this.currentLayer}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let q=null;h.forEach(J=>{const re=t.getLayerSourceCache(J);re&&!J.isHidden(this.transform.zoom)&&re.getVisibleCoordinates().length&&(!q||q.getSource().maxzoom<re.getSource().maxzoom)&&(q=re)}),q&&this.options.showTileBoundaries&&t9.debug(this,q,q.getVisibleCoordinates())}this.options.showPadding&&function(q){const J=q.transform.padding;X8(q,q.transform.height-(J.top||0),3,Gae),X8(q,J.bottom||0,3,Hae),Z8(q,J.left||0,3,jae),Z8(q,q.transform.width-(J.right||0),3,$ae);const re=q.transform.centerPoint;(function(ce,ge,ve,Ce){V3(ce,ge-1,ve-10,2,20,Ce),V3(ce,ge-10,ve-1,20,2,Ce)})(q,re.x,q.transform.height-re.y,Yae)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(f.performance.now()),this.saveCanvasCopy()),v||(this.conflationActive=!1)}uploadLayer(t,r,c){this.gpuTimingStart(r),(!t.transform.projection.unsupportedLayers||!t.transform.projection.unsupportedLayers.includes(r.type)||t.terrain&&r.type==="custom")&&n9[`${r.type}Upload`]&&n9[`${r.type}Upload`](t,c,r.scope),this.gpuTimingEnd()}renderLayer(t,r,c,u){c.isHidden(this.transform.zoom)||(c.type==="background"||c.type==="sky"||c.type==="custom"||c.type==="model"||c.type==="raster"||u&&u.length)&&(this.id=c.id,this.gpuTimingStart(c),(!t.transform.projection.unsupportedLayers||!t.transform.projection.unsupportedLayers.includes(c.type)||t.terrain&&c.type==="custom")&&t9[c.type](t,r,c,u,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(t){if(!this.options.gpuTiming)return;const r=this.context.extTimerQuery,c=this.context.gl;let u=this.gpuTimers[t.id];u||(u=this.gpuTimers[t.id]={calls:0,cpuTime:0,query:c.createQuery()}),u.calls++,c.beginQuery(r.TIME_ELAPSED_EXT,u.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const t=this.context.extTimerQuery,r=this.context.gl,c=r.createQuery();this.deferredRenderGpuTimeQueries.push(c),r.beginQuery(t.TIME_ELAPSED_EXT,c)}}gpuTimingDeferredRenderEnd(){this.options.gpuTimingDeferredRender&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}gpuTimingEnd(){this.options.gpuTiming&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}collectGpuTimers(){const t=this.gpuTimers;return this.gpuTimers={},t}collectDeferredRenderGpuQueries(){const t=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],t}queryGpuTimers(t){const r={};for(const c in t){const u=t[c],h=this.context.extTimerQuery,m=h.getQueryParameter(u.query,this.context.gl.QUERY_RESULT)/1e6;h.deleteQueryEXT(u.query),r[c]=m}return r}queryGpuTimeDeferredRender(t){if(!this.options.gpuTimingDeferredRender)return 0;const r=this.context.extTimerQuery,c=this.context.gl;let u=0;for(const h of t)u+=r.getQueryParameter(h,c.QUERY_RESULT)/1e6,r.deleteQueryEXT(h);return u}translatePosMatrix(t,r,c,u,h){if(!c[0]&&!c[1])return t;const m=h?u==="map"?this.transform.angle:0:u==="viewport"?-this.transform.angle:0;if(m){const b=Math.sin(m),w=Math.cos(m);c=[c[0]*w-c[1]*b,c[0]*b+c[1]*w]}const g=[h?c[0]:Tm(r,c[0],this.transform.zoom),h?c[1]:Tm(r,c[1],this.transform.zoom),0],v=new Float32Array(16);return rt.translate(v,t,g),v}saveTileTexture(t){const r=this._tileTextures[t.size[0]];r?r.push(t):this._tileTextures[t.size[0]]=[t]}getTileTexture(t){const r=this._tileTextures[t];return r&&r.length>0?r.pop():null}isPatternMissing(t,r){return t===null||t!==void 0&&!this.imageManager.getPattern(t.toString(),r)}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture}terrainUseFloatDEM(){return this.context.extTextureFloatLinear!=null}currentGlobalDefines(t,r,c){const u=c===void 0?this.terrain&&this.terrain.renderingToTexture:c,h=this.terrain&&this.terrain.exaggeration()===0,m=[];return this.style&&this.style.enable3dLights()&&(t==="globeRaster"||t==="terrainRaster"?(m.push("LIGHTING_3D_MODE"),m.push("LIGHTING_3D_ALPHA_EMISSIVENESS")):u||m.push("LIGHTING_3D_MODE")),this.renderPass==="shadow"?this._shadowMapDebug||m.push("DEPTH_TEXTURE"):this.shadowRenderer&&(this.shadowRenderer.useNormalOffset?m.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET"):m.push("RENDER_SHADOWS","DEPTH_TEXTURE")),this.terrainRenderModeElevated()&&(m.push("TERRAIN"),this.terrainUseFloatDEM()&&m.push("TERRAIN_DEM_FLOAT_FORMAT"),h&&m.push("ZERO_EXAGGERATION")),this.transform.projection.name==="globe"&&m.push("GLOBE"),!this._fogVisible||u||r!==void 0&&!r||m.push("FOG","FOG_DITHERING"),u&&m.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&m.push("OVERDRAW_INSPECTOR"),m}getOrCreateProgram(t,r){this.cache=this.cache||{};const c=r&&r.defines||[],u=r&&r.config,h=this.currentGlobalDefines(t,r&&r.overrideFog,r&&r.overrideRtt).concat(c),m=k8.cacheKey(S8[t],t,h,u);return this.cache[m]||(this.cache[m]=new k8(this.context,t,S8[t],u,Dae[t],h)),this.cache[m]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const t=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(t.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=f.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new vr(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this._wireframeDebugCache.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}uploadCommonLightUniforms(t,r){if(this.style.enable3dLights()){const c=this.style.directionalLight,u=this.style.ambientLight;if(c&&u){const h=((m,g)=>{const v=m.properties.get("direction"),b=m.properties.get("color").toArray01(),w=m.properties.get("intensity"),A=g.properties.get("color").toArray01(),C=g.properties.get("intensity"),P=[v.x,v.y,v.z],k=Wt(A,C),z=Wt(b,w);return{u_lighting_ambient_color:k,u_lighting_directional_dir:P,u_lighting_directional_color:z,u_ground_radiance:vae(P,z,k)}})(c,u);r.setLightsUniformValues(t,h)}}}uploadCommonUniforms(t,r,c,u,h){if(this.uploadCommonLightUniforms(t,r),this.terrain&&this.terrain.renderingToTexture)return;const m=this.style.fog;if(m){const g=m.getOpacity(this.transform.pitch),v=((b,w,A,C,P,k,z,U,W,$,Z,K)=>{const q=b.transform,J=w.properties.get("color").toArray01();J[3]=C;const re=b.frameCounter/1e3%1,[ce,ge]=w.properties.get("vertical-range");return{u_fog_matrix:A?q.calculateFogTileMatrix(A):K||b.identityMat,u_fog_range:w.getFovAdjustedRange(q._fov),u_fog_color:J,u_fog_horizon_blend:w.properties.get("horizon-blend"),u_fog_vertical_limit:[Math.min(ce,ge),ge],u_fog_temporal_offset:re,u_frustum_tl:P,u_frustum_tr:k,u_frustum_br:z,u_frustum_bl:U,u_globe_pos:W,u_globe_radius:$,u_viewport:Z,u_globe_transition:yo(q.zoom),u_is_globe:+(q.projection.name==="globe")}})(this,m,c,g,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*Cn.devicePixelRatio,this.transform.height*Cn.devicePixelRatio],u);r.setFogUniformValues(t,v)}h&&r.setCutoffUniformValues(t,h.uniformValues)}setTileLoadedFlag(t){this.tileLoaded=t}saveCanvasCopy(){const t=this.canvasCopy();t&&(this.frameCopies.push(t),this.tileLoaded=!1)}canvasCopy(){const t=this.context.gl,r=t.createTexture();return t.bindTexture(t.TEXTURE_2D,r),t.copyTexImage2D(t.TEXTURE_2D,0,t.RGBA,0,0,t.drawingBufferWidth,t.drawingBufferHeight,0),r}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const t=this.style&&this.style.fog;return!!t&&t.getOpacity(this.transform.pitch)!==0}getBackgroundTiles(){const t=this._backgroundTiles,r=this._backgroundTiles={},c=this.transform.coveringTiles({tileSize:512});for(const u of c)r[u.key]=t[u.key]||new T1(u,512,this.transform.tileZoom,this);return r}clearBackgroundTiles(){this._backgroundTiles={}}layerUsedInConflation(t,r){return!(!t.is3D()||t.minzoom&&t.minzoom>this.transform.zoom||t.sourceLayer!=="building"&&(!r||r.type!=="batched-model"))}isTileAffectedByFog(t){if(!this.style||!this.style.fog)return!1;if(this.transform.projection.name==="globe")return!0;let r=this._cachedTileFogOpacities[t.key];return r||(this._cachedTileFogOpacities[t.key]=r=this.style.fog.getOpacityForTile(t)),r[0]>=Im||r[1]>=Im}}const km=2048;class lre{constructor(t,r){this.aabb=t,this.lastCascade=r}}class cre{add(t,r){const c=this.receivers[t.key];c!==void 0?(c.aabb.min[0]=Math.min(c.aabb.min[0],r.min[0]),c.aabb.min[1]=Math.min(c.aabb.min[1],r.min[1]),c.aabb.min[2]=Math.min(c.aabb.min[2],r.min[2]),c.aabb.max[0]=Math.max(c.aabb.max[0],r.max[0]),c.aabb.max[1]=Math.max(c.aabb.max[1],r.max[1]),c.aabb.max[2]=Math.max(c.aabb.max[2],r.max[2])):this.receivers[t.key]=new lre(r,null)}clear(){this.receivers={}}get(t){return this.receivers[t.key]}computeRequiredCascades(t,r,c){const u=ga.fromPoints(t.points);let h=0;for(const m in this.receivers){const g=this.receivers[m];if(!g||!u.intersectsAabb(g.aabb))continue;g.aabb.min=u.closestPoint(g.aabb.min),g.aabb.max=u.closestPoint(g.aabb.max);const v=g.aabb.getCorners();for(let b=0;b<c.length;b++){let w=!0;for(const A of v){const C=[A[0]*r,A[1]*r,A[2]];if(ke.transformMat4(C,C,c[b].matrix),C[0]<-1||C[0]>1||C[1]<-1||C[1]>1){w=!1;break}}if(g.lastCascade=b,h=Math.max(h,b),w)break}}return h+1}}class ure{constructor(t){this.painter=t,this._enabled=!1,this._shadowLayerCount=0,this._numCascadesToRender=0,this._cascades=[],this._groundShadowTiles=[],this._receivers=new cre,this._depthMode=new Nn(t.context.gl.LEQUAL,Nn.ReadWrite,[0,1]),this._uniformValues={u_light_matrix_0:new Float32Array(16),u_light_matrix_1:new Float32Array(16),u_shadow_intensity:0,u_fade_range:[0,0],u_shadow_normal_offset:[1,1,1],u_shadow_texel_size:1,u_shadow_map_resolution:1,u_shadow_direction:[0,0,1],u_shadow_bias:[36e-5,.0012,.012],u_shadowmap_0:0,u_shadowmap_1:0},this.useNormalOffset=!1}destroy(){for(const t of this._cascades)t.texture.destroy(),t.framebuffer.destroy();this._cascades=[]}updateShadowParameters(t,r){const c=this.painter;if(this._enabled=!1,this._shadowLayerCount=0,this._receivers.clear(),!r||!r.properties)return;const u=r.properties.get("shadow-intensity");if(!r.shadowsEnabled()||u<=0||(this._shadowLayerCount=c.style.order.reduce((P,k)=>{const z=c.style._mergedLayers[k];return P+(z.hasShadowPass()&&!z.isHidden(t.zoom)?1:0)},0),this._enabled=this._shadowLayerCount>0,!this._enabled))return;const h=c.context,m=km,g=km;if(this._cascades.length===0)for(let P=0;P<2;++P){const k=c._shadowMapDebug,z=h.gl,U=h.createFramebuffer(m,g,k,"texture"),W=new vr(h,{width:m,height:g,data:null},z.DEPTH_COMPONENT);if(U.depthAttachment.set(W.texture),k){const $=new vr(h,{width:m,height:g,data:null},z.RGBA);U.colorAttachment.set($.texture)}this._cascades.push({framebuffer:U,texture:W,matrix:[],far:0,boundingSphereRadius:0,frustum:new ah,scale:0})}this.shadowDirection=i9(r);let v=0;if(t.elevation){const P=t.elevation,k=[1e4,-1e4];P.visibleDemTiles.filter(z=>z.dem).forEach(z=>{const U=z.dem.tree;k[0]=Math.min(k[0],U.minimums[0]),k[1]=Math.max(k[1],U.maximums[0])}),k[0]!==1e4&&(v=(k[1]-k[0])*P.exaggeration())}const b=1.5*t.cameraToCenterDistance,w=3*b,A=new Float64Array(16);for(let P=0;P<2;++P){const k=this._cascades[P];let z=t.height/50,U=1;P===0?U=b:(z=b,U=w);const[W,$]=dre(t,this.shadowDirection,z,U,km,v);k.scale=t.scale,k.matrix=W,k.boundingSphereRadius=$,rt.invert(A,k.matrix),k.frustum=ah.fromInvProjectionMatrix(A,1,0,!0),k.far=U}this._uniformValues.u_fade_range=[.75*this._cascades[1].far,this._cascades[1].far],this._uniformValues.u_shadow_intensity=u,this._uniformValues.u_shadow_direction=[this.shadowDirection[0],this.shadowDirection[1],this.shadowDirection[2]],this._uniformValues.u_shadow_texel_size=.00048828125,this._uniformValues.u_shadow_map_resolution=km,this._uniformValues.u_shadowmap_0=ll.ShadowMap0,this._uniformValues.u_shadowmap_1=ll.ShadowMap0+1,this._groundShadowTiles=c.transform.coveringTiles({tileSize:512,renderWorldCopies:!0});const C=c.transform.elevation;for(const P of this._groundShadowTiles){let k={min:0,max:0};if(C){const z=C.getMinMaxForTile(P);z&&(k=z)}this.addShadowReceiver(P.toUnwrapped(),k.min,k.max)}}get enabled(){return this._enabled}set enabled(t){this._enabled=t}drawShadowPass(t,r){if(!this._enabled)return;const c=this.painter,u=c.context;this._numCascadesToRender=this._receivers.computeRequiredCascades(c.transform.getFrustum(0),c.transform.worldSize,this._cascades),u.viewport.set([0,0,km,km]);for(let h=0;h<this._numCascadesToRender;++h){c.currentShadowCascade=h,u.bindFramebuffer.set(this._cascades[h].framebuffer.framebuffer),u.clear({color:Sn.white,depth:1});for(const m of t.order){const g=t._mergedLayers[m];if(!g.hasShadowPass()||g.isHidden(c.transform.zoom))continue;const v=t.getLayerSourceCache(g),b=v?r[v.id]:void 0;(g.type==="model"||b&&b.length)&&c.renderLayer(c,v,g,b)}}c.currentShadowCascade=0}drawGroundShadows(){if(!this._enabled)return;const t=this.painter,r=t.style,c=t.context,u=r.directionalLight,h=r.ambientLight;if(!u||!h)return;const m=[],g=Ev(t,t.longestCutoffRange);g.shouldRenderCutoff&&m.push("RENDER_CUTOFF");const v=E5(u,h),b=new Nn(c.gl.LEQUAL,Nn.ReadOnly,t.depthRangeFor3D);for(const w of this._groundShadowTiles){const A=w.toUnwrapped(),C=t.isTileAffectedByFog(w),P=t.getOrCreateProgram("groundShadow",{defines:m,overrideFog:C});this.setupShadows(A,P),t.uploadCommonUniforms(c,P,A,null,g);const k={u_matrix:t.transform.calculateProjMatrix(A),u_ground_shadow_factor:v};P.draw(t,c.gl.TRIANGLES,b,ui.disabled,Ci.multiply,hi.disabled,k,"ground_shadow",t.tileExtentBuffer,t.quadTriangleIndexBuffer,t.tileExtentSegments,{},t.transform.zoom,null,null)}}getShadowPassColorMode(){return this.painter._shadowMapDebug?Ci.unblended:Ci.disabled}getShadowPassDepthMode(){return this._depthMode}getShadowCastingLayerCount(){return this._shadowLayerCount}calculateShadowPassMatrixFromTile(t){const r=this.painter.transform,c=r.calculatePosMatrix(t,r.worldSize);return rt.multiply(c,this._cascades[this.painter.currentShadowCascade].matrix,c),Float32Array.from(c)}calculateShadowPassMatrixFromMatrix(t){return rt.multiply(t,this._cascades[this.painter.currentShadowCascade].matrix,t),Float32Array.from(t)}setupShadows(t,r,c,u=0){if(!this._enabled)return;const h=this.painter.transform,m=this.painter.context,g=m.gl,v=this._uniformValues,b=new Float64Array(16),w=h.calculatePosMatrix(t,h.worldSize);for(let A=0;A<2;A++)rt.multiply(b,this._cascades[A].matrix,w),v[A===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(b),m.activeTexture.set(g.TEXTURE0+ll.ShadowMap0+A),this._cascades[A].texture.bind(g.NEAREST,g.CLAMP_TO_EDGE);if(this.useNormalOffset=!!c,this.useNormalOffset){const A=p1(t.canonical),C=2/h.tileSize*mt/km,P=C*this._cascades[0].boundingSphereRadius,k=C*this._cascades[1].boundingSphereRadius,z=(c==="vector-tile"?1:3)/Math.pow(2,u-t.canonical.z-(1-h.zoom+Math.floor(h.zoom)));v.u_shadow_normal_offset=[A,P*z,k*z],v.u_shadow_bias=[6e-5,.0012,.012]}else v.u_shadow_bias=[36e-5,.0012,.012];r.setShadowUniformValues(m,v)}setupShadowsFromMatrix(t,r,c=!1){if(!this._enabled)return;const u=this.painter.context,h=u.gl,m=this._uniformValues,g=new Float64Array(16);for(let v=0;v<2;v++)rt.multiply(g,this._cascades[v].matrix,t),m[v===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(g),u.activeTexture.set(h.TEXTURE0+ll.ShadowMap0+v),this._cascades[v].texture.bind(h.NEAREST,h.CLAMP_TO_EDGE);this.useNormalOffset=c,c?(m.u_shadow_normal_offset=[1,5,5],m.u_shadow_bias=[6e-5,.0012,.012]):m.u_shadow_bias=[36e-5,.0012,.012],r.setShadowUniformValues(u,m)}getShadowUniformValues(){return this._uniformValues}getCurrentCascadeFrustum(){return this._cascades[this.painter.currentShadowCascade].frustum}computeSimplifiedTileShadowVolume(t,r,c,u){if(u[2]>=0)return{};const h=function(v,b,w){const A=w/(1<<v.canonical.z);return new ga([v.canonical.x*A+v.wrap*w,v.canonical.y*A+v.wrap*w,0],[(v.canonical.x+1)*A+v.wrap*w,(v.canonical.y+1)*A+v.wrap*w,b])}(t,r,c).getCorners(),m=r/-u[2];u[0]<0?(ke.add(h[0],h[0],[u[0]*m,0,0]),ke.add(h[3],h[3],[u[0]*m,0,0])):u[0]>0&&(ke.add(h[1],h[1],[u[0]*m,0,0]),ke.add(h[2],h[2],[u[0]*m,0,0])),u[1]<0?(ke.add(h[0],h[0],[0,u[1]*m,0]),ke.add(h[1],h[1],[0,u[1]*m,0])):u[1]>0&&(ke.add(h[2],h[2],[0,u[1]*m,0]),ke.add(h[3],h[3],[0,u[1]*m,0]));const g={};return g.vertices=h,g.planes=[H3(h[1],h[0],h[4]),H3(h[2],h[1],h[5]),H3(h[3],h[2],h[6]),H3(h[0],h[3],h[7])],g}addShadowReceiver(t,r,c){this._receivers.add(t,ga.fromTileIdAndHeight(t,r,c))}getMaxCascadeForTile(t){const r=this._receivers.get(t);return r&&r.lastCascade?r.lastCascade:0}}function H3(a,t,r){const c=ke.sub([],r,t),u=ke.sub([],a,t),h=ke.cross([],c,u),m=ke.length(h);return m===0?[0,0,1,0]:(ke.scale(h,h,1/m),[h[0],h[1],h[2],-ke.dot(h,t)])}function i9(a){const t=a.properties.get("direction"),r=de(t.x,t.y,t.z);r[2]=ae(r[2],0,75);const c=st([r[0],r[1],r[2]]);return ke.fromValues(c.x,c.y,c.z)}function E5(a,t){const r=a.properties.get("color"),c=a.properties.get("intensity"),u=a.properties.get("direction"),h=[u.x,u.y,u.z],m=t.properties.get("color"),g=t.properties.get("intensity"),v=Math.max(ke.dot([0,0,1],h),0),b=[0,0,0];ke.scale(b,m.toArray01Linear().slice(0,3),g);const w=[0,0,0];return ke.scale(w,r.toArray01Linear().slice(0,3),v*c),Ht([b[0]>0?b[0]/(b[0]+w[0]):0,b[1]>0?b[1]/(b[1]+w[1]):0,b[2]>0?b[2]/(b[2]+w[2]):0])}function dre(a,t,r,c,u,h){const m=a.zoom,g=a.scale,v=a.worldSize,b=1/v,w=a.aspect,A=Math.sqrt(1+w*w)*Math.tan(.5*a.fovX),C=A*A,P=c-r,k=c+r;let z,U;C>P/k?(z=c,U=c*A):(z=.5*k*(1+C),U=.5*Math.sqrt(P*P+2*(c*c+r*r)*C+k*k*C*C));const W=a.projection.pixelsPerMeter(a.center.lat,v),$=a._camera.getCameraToWorldMercator(),Z=[0,0,-z*b];ke.transformMat4(Z,Z,$);let K=U*b;const q=a._edgeInsets;if(!(q.left===0&&q.top===0&&q.right===0&&q.bottom===0||q.left===q.right&&q.top===q.bottom)){const yt=a._camera.getWorldToCamera(a.worldSize,a.projection.zAxisUnit==="meters"?W:1),pt=a._camera.getCameraToClipPerspective(a._fov,a.width/a.height,r,c);pt[8]=2*-a.centerOffset.x/a.width,pt[9]=2*a.centerOffset.y/a.height;const Rt=new Float64Array(16);rt.mul(Rt,pt,yt);const Ft=new Float64Array(16);rt.invert(Ft,Rt);const St=ah.fromInvProjectionMatrix(Ft,v,m,!0);for(const Tt of St.points){const nn=((J=Tt)[0]/=g,J[1]/=g,J[2]=$i(J[2],a._center.lat),J);K=Math.max(K,ke.len(ke.subtract([],Z,nn)))}}var J;K*=u/(u-1);const re=Math.acos(t[2]),ce=Math.atan2(-t[0],-t[1]),ge=new b3;ge.position=Z,ge.setPitchBearing(re,ce);const ve=ge.getWorldToCamera(v,W),Ce=K*v,Ae=Math.min(a._mercatorZfromZoom(17)*v*-2,-2*Ce),Le=ge.getCameraToClipOrthographic(-Ce,Ce,-Ce,Ce,Ae,(Ce+h*W)/t[2]),Se=new Float64Array(16);rt.multiply(Se,Le,ve);const Ve=ke.fromValues(Math.floor(1e6*Z[0])/1e6*v,Math.floor(1e6*Z[1])/1e6*v,0),Xe=.5*u,nt=[0,0,0];ke.transformMat4(nt,Ve,Se),ke.scale(nt,nt,Xe);const We=[Math.floor(nt[0]),Math.floor(nt[1]),Math.floor(nt[2])],Ge=[0,0,0];ke.sub(Ge,nt,We),ke.scale(Ge,Ge,-1/Xe);const ot=new Float64Array(16);return rt.identity(ot),rt.translate(ot,ot,Ge),rt.multiply(Se,ot,Se),[Se,Ce]}class hre extends Un{constructor(t){super(),this.requestManager=t,this.models={"":{}},this.numModelsLoading={}}async loadModel(t,r){const c=await KB(this.requestManager.transformRequest(r,we.Model).url).catch(m=>{this.fire(new bn(new Error(`Could not load model ${t} from ${r}: ${m.message}`)))});if(!c)return;const u=u5(c),h=new YF(t,void 0,void 0,u);return h.computeBoundsAndApplyParent(),h}async load(t,r){this.models[r]||(this.models[r]={});const c=Object.keys(t);this.numModelsLoading[r]=(this.numModelsLoading[r]||0)+c.length;const u=[];for(const m of c)u.push(this.loadModel(m,t[m]));const h=await Promise.allSettled(u);for(let m=0;m<h.length;m++){const{status:g,value:v}=h[m];g==="fulfilled"&&v&&(this.models[r][c[m]]=v)}this.numModelsLoading[r]-=c.length,this.fire(new $t("data",{dataType:"style"}))}isLoaded(){for(const t in this.numModelsLoading)if(this.numModelsLoading[t]>0)return!1;return!0}hasModel(t,r){return!!this.getModel(t,r)}getModel(t,r){return this.models[r]||(this.models[r]={}),this.models[r][t]}async addModel(t,r,c){this.models[c]||(this.models[c]={}),this.hasModel(t,c)&&this.removeModel(t,c),this.load({[t]:this.requestManager.normalizeModelURL(r)},c)}addModels(t,r){const c={};for(const u in t)c[u]=this.requestManager.normalizeModelURL(t[u]);this.load(c,r)}removeModel(t,r){this.models[r]||(this.models[r]={});const c=this.models[r][t];delete this.models[r][t],c.destroy()}listModels(t){return this.models[t]||(this.models[t]={}),Object.keys(this.models[t])}upload(t,r){this.models[r]||(this.models[r]={});for(const c in this.models[r])this.models[r][c].upload(t.context)}}const G1=(a,t)=>mo(a,t&&t.filter(r=>r.identifier!=="source.canvas")),pre=ct(Bi,["addLayer","removeLayer","setLights","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection","setCamera","addImport","removeImport","setImportUrl","setImportData"]),fre=ct(Bi,["setCenter","setZoom","setBearing","setPitch"]),a9={version:8,layers:[],sources:{}},r9={duration:300,delay:0},mre=new Set(["fill","line","background","hillshade","raster"]);class Jc extends Un{constructor(t,r={}){super(),this.map=t,this.scope=r.scope||"",this.fragments=[],this.importDepth=r.importDepth||0,this.importsCache=r.importsCache||new Map,this.resolvedImports=r.resolvedImports||new Set,this.transition=Fe({},r9),this._buildingIndex=new Uie(this),this.crossTileSymbolIndex=new cae,this._mergedOrder=[],this._drapedFirstOrder=[],this._mergedLayers={},this._mergedSourceCaches={},this._mergedOtherSourceCaches={},this._mergedSymbolSourceCaches={},this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this._changes=r.styleChanges||new MC,this.dispatcher=r.dispatcher?r.dispatcher:new Lm(B1(),this),r.imageManager?this.imageManager=r.imageManager:(this.imageManager=new mie,this.imageManager.setEventedParent(this)),this.imageManager.createScope(this.scope),this.glyphManager=r.glyphManager?r.glyphManager:new gv(t._requestManager,r.localFontFamily?2:r.localIdeographFontFamily?1:0,r.localFontFamily||r.localIdeographFontFamily),r.modelManager?this.modelManager=r.modelManager:(this.modelManager=new hre(t._requestManager),this.modelManager.setEventedParent(this)),this._layers={},this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._precompileDone=!1,this._shouldPrecompile=!1,this._availableImages=[],this._order=[],this._markersNeedUpdate=!1,this.options=r.config||new Map,this._configDependentLayers=new Set,this._changes.reset(),this.dispatcher.broadcast("setReferrer",Ne());const c=this;this._rtlTextPluginCallback=Jc.registerForPluginStateChange(u=>{c.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:u.pluginStatus,pluginURL:u.pluginURL},(h,m)=>{if($o(h),m&&m.every(g=>g))for(const g in c._sourceCaches){const v=c._sourceCaches[g],b=v.getSource().type;b!=="vector"&&b!=="geojson"||v.reload()}})}),this.on("data",u=>{if(u.dataType!=="source"||u.sourceDataType!=="metadata")return;const h=this.getOwnSource(u.sourceId);if(h&&h.vectorLayerIds)for(const m in this._layers){const g=this._layers[m];g.source===h.id&&this._validateLayer(g)}})}loadURL(t,r={}){this.fire(new $t("dataloading",{dataType:"style"}));const c=typeof r.validate=="boolean"?r.validate:!vn(t);t=this.map._requestManager.normalizeStyleURL(t,r.accessToken),this.resolvedImports.add(t);const u=this.importsCache.get(t);if(u)return this._load(u,c);const h=this.map._requestManager.transformRequest(t,we.Style);this._request=tt(h,(m,g)=>{if(this._request=null,m)this.fire(new bn(m));else if(g)return this.importsCache.set(t,g),this._load(g,c)})}loadJSON(t,r={}){this.fire(new $t("dataloading",{dataType:"style"})),this._request=Cn.frame(()=>{this._request=null,this._load(t,r.validate!==!1)})}loadEmpty(){this.fire(new $t("dataloading",{dataType:"style"})),this._load(a9,!1)}_loadImports(t,r){if(this.importDepth>=4)return _e("Style doesn't support nesting deeper than 5"),this._reloadImports();const c=[];for(const u of t){const h=this._createFragmentStyle(u),m=new Promise(v=>h.on("style.import.load",v));if(c.push(m),this.resolvedImports.has(u.url)){h.loadEmpty();continue}const g=u.data||this.importsCache.get(u.url);g?h.loadJSON(g,{validate:r}):u.url?h.loadURL(u.url,{validate:r}):h.loadEmpty(),this.fragments.push({style:h,id:u.id,config:u.config})}Promise.all(c).then(()=>this._reloadImports())}_createFragmentStyle(t){const r=this.scope?Yo(t.id,this.scope):t.id,c=new Map,u=t.config;if(u)for(const m of Object.keys(u)){const g=Fc(u[m]);g.result==="success"&&c.set(m,g.value.expression)}const h=new Jc(this.map,{scope:r,config:c,styleChanges:this._changes,importDepth:this.importDepth+1,importsCache:this.importsCache,resolvedImports:new Set(this.resolvedImports),dispatcher:this.dispatcher,imageManager:this.imageManager,glyphManager:this.glyphManager,modelManager:this.modelManager});return h.setEventedParent(this.map,{style:h}),h}_reloadImports(){this.mergeAll(),this._updateMapProjection(),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),this._shouldPrecompile=this.importDepth===0,this.fire(new $t("data",{dataType:"style"})),this.fire(new $t(this.importDepth===0?"style.load":"style.import.load"))}_load(t,r){const c=t.schema;if(this.importDepth===0&&(t.fragment||c&&t.fragment!==!1)){const m=Fe({},a9,{imports:[{id:"basemap",data:t,url:""}]});return void this._load(m,r)}if(c)for(const m of Object.keys(c)){if(this.options.has(m))continue;const g=Fc(c[m].default);g.result==="success"&&this.options.set(m,g.value.expression)}if(r&&G1(this,Fu(t)))return;this._loaded=!0,this.stylesheet=ue(t);for(const m in t.sources)this.addSource(m,t.sources[m],{validate:!1});this._changes.changed=!1,t.sprite?this._loadSprite(t.sprite):(this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0})),this.glyphManager.setURL(t.glyphs,this.scope);const u=n8(this.stylesheet.layers);if(this._order=u.map(m=>m.id),this.stylesheet.light&&_e("The `light` root property is deprecated, prefer using `lights` with `flat` light type instead."),this.stylesheet.lights)if(this.stylesheet.lights.length===1&&this.stylesheet.lights[0].type==="flat"){const m=this.stylesheet.lights[0];this.light=new PB(m.properties,m.id)}else this.setLights(this.stylesheet.lights);this.light||(this.light=new PB(this.stylesheet.light)),this._layers={},this._serializedLayers={};for(const m of u){const g=C3(m,this.options);g.setScope(this.scope),g.isConfigDependent&&this._configDependentLayers.add(g.fqid),g.setEventedParent(this,{layer:{id:g.id}}),this._layers[g.id]=g,this._layers[g.id]=g,this._serializedLayers[g.id]=g.serialize();const v=this.getOwnLayerSourceCache(g),b=!!this.directionalLight&&this.directionalLight.shadowsEnabled();v&&g.canCastShadows()&&b&&(v.castsShadows=!0)}this.stylesheet.models&&this.modelManager.addModels(this.stylesheet.models,this.scope);const h=this.stylesheet.terrain;h&&!this.terrainSetForDrapingOnly()&&this._createTerrain(h,1),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this.stylesheet.transition&&this.setTransition(this.stylesheet.transition),this.mergeAll(),this._updateMapProjection(),this.map._triggerCameraUpdate(this.camera),this.fire(new $t("data",{dataType:"style"})),t.imports?this._loadImports(t.imports,r):(this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),this._shouldPrecompile=this.importDepth===0,this.fire(new $t(this.importDepth===0?"style.load":"style.import.load")))}mergeAll(){let t,r,c,u,h,m,g,v;this.forEachFragmentStyle(b=>{b.light!=null&&(t=b.light),b.ambientLight!=null&&(r=b.ambientLight),b.directionalLight!=null&&(c=b.directionalLight),b.terrain!=null&&(!u||u&&u.drapeRenderMode===0||b.terrain.drapeRenderMode===1)&&(u=b.terrain),b.fog!=null&&(h=b.fog),b.stylesheet&&(b.stylesheet.camera!=null&&(v=b.stylesheet.camera),b.stylesheet.projection!=null&&(m=b.stylesheet.projection),b.stylesheet.transition!=null&&(g=b.stylesheet.transition))}),this.light=t,this.ambientLight=r,this.directionalLight=c,this.terrain=u,this.fog=h,this.camera=v||{"camera-projection":"perspective"},this.projection=m||{name:"mercator"},this.transition=Fe({},r9,g),this.mergeSources(),this.mergeLayers()}forEachFragmentStyle(t){const r=c=>{for(const u of c.fragments)r(u.style);t(c)};r(this)}mergeTerrain(){let t;this.forEachFragmentStyle(r=>{r.terrain!=null&&(!t||t&&t.drapeRenderMode===0||r.terrain.drapeRenderMode===1)&&(t=r.terrain)}),this.terrain=t}mergeProjection(){let t;this.forEachFragmentStyle(r=>{r.stylesheet.projection!=null&&(t=r.stylesheet.projection)}),this.projection=t||{name:"mercator"}}mergeSources(){const t={},r={},c={};this.forEachFragmentStyle(u=>{for(const h in u._sourceCaches){const m=Yo(h,u.scope);t[m]=u._sourceCaches[h]}for(const h in u._otherSourceCaches){const m=Yo(h,u.scope);r[m]=u._otherSourceCaches[h]}for(const h in u._symbolSourceCaches){const m=Yo(h,u.scope);c[m]=u._symbolSourceCaches[h]}}),this._mergedSourceCaches=t,this._mergedOtherSourceCaches=r,this._mergedSymbolSourceCaches=c}mergeLayers(){const t={},r=[],c={};this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this.forEachFragmentStyle(h=>{for(const m of h._order){const g=h._layers[m];if(g.type==="slot"){const v=tv(m);if(t[v])continue;t[v]=[]}g.slot&&t[g.slot]?t[g.slot].push(g):r.push(g)}}),this._mergedOrder=[];const u=(h=[])=>{for(const m of h)if(m.type==="slot"){const g=tv(m.id);t[g]&&u(t[g])}else{const g=Yo(m.id,m.scope);this._mergedOrder.push(g),c[g]=m,m.is3D()&&(this._has3DLayers=!0),m.type==="circle"&&(this._hasCircleLayers=!0),m.type==="symbol"&&(this._hasSymbolLayers=!0)}};u(r),this._mergedLayers=c,this.updateDrapeFirstLayers(),this._buildingIndex.processLayersChanged()}terrainSetForDrapingOnly(){return!!this.terrain&&this.terrain.drapeRenderMode===0}getCamera(){return this.stylesheet.camera}setCamera(t){return this.stylesheet.camera=Fe({},this.stylesheet.camera,t),this.camera=this.stylesheet.camera,this}setProjection(t){t?this.stylesheet.projection=t:delete this.stylesheet.projection,this.mergeProjection(),this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?this.getTerrain()||this.stylesheet.terrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null))}_updateMapProjection(){this.importDepth>0||(this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.projection))}_loadSprite(t){this._spriteRequest=function(r,c,u){let h,m,g;const v=Cn.devicePixelRatio>1?"@2x":"";let b=tt(c.transformRequest(c.normalizeSpriteURL(r,v,".json"),we.SpriteJSON),(C,P)=>{b=null,g||(g=C,h=P,A())}),w=Qt(c.transformRequest(c.normalizeSpriteURL(r,v,".png"),we.SpriteImage),(C,P)=>{w=null,g||(g=C,m=P,A())});function A(){if(g)u(g);else if(h&&m){const C=Cn.getImageData(m),P={};for(const k in h){const{width:z,height:U,x:W,y:$,sdf:Z,pixelRatio:K,stretchX:q,stretchY:J,content:re}=h[k],ce=new Xa({width:z,height:U});Xa.copy(C,ce,{x:W,y:$},{x:0,y:0},{width:z,height:U}),P[k]={data:ce,pixelRatio:K,sdf:Z,stretchX:q,stretchY:J,content:re}}u(null,P)}}return{cancel(){b&&(b.cancel(),b=null),w&&(w.cancel(),w=null)}}}(t,this.map._requestManager,(r,c)=>{if(this._spriteRequest=null,r)this.fire(new bn(r));else if(c)for(const u in c)this.imageManager.addImage(u,this.scope,c[u]);this.imageManager.setLoaded(!0,this.scope),this._availableImages=this.imageManager.listImages(this.scope),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages}),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0}),this.fire(new $t("data",{dataType:"style"}))})}_validateLayer(t){const r=this.getOwnSource(t.source);if(!r)return;const c=t.sourceLayer;c&&(r.type==="geojson"||r.vectorLayerIds&&r.vectorLayerIds.indexOf(c)===-1)&&this.fire(new bn(new Error(`Source layer "${c}" does not exist on source "${r.id}" as specified by style layer "${t.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._changes.updatedSourceCaches).length)return!1;for(const t in this._sourceCaches)if(!this._sourceCaches[t].loaded())return!1;if(!this.imageManager.isLoaded()||!this.modelManager.isLoaded())return!1;for(const{style:t}of this.fragments)if(!t.loaded())return!1;return!0}_serializeImports(){if(this.stylesheet.imports)return this.stylesheet.imports.map((t,r)=>{const c=this.fragments[r];return c&&c.style&&(t.data=c.style.serialize()),t})}_serializeSources(){const t={};for(const r in this._sourceCaches){const c=this._sourceCaches[r].getSource();t[c.id]||(t[c.id]=c.serialize())}return t}_serializeLayers(t){const r=[];for(const c of t){const u=this._layers[c];u&&u.type!=="custom"&&r.push(u.serialize())}return r}hasLightTransitions(){return!(!this.light||!this.light.hasTransition())||!(!this.ambientLight||!this.ambientLight.hasTransition())||!(!this.directionalLight||!this.directionalLight.hasTransition())}hasFogTransition(){return!!this.fog&&this.fog.hasTransition()}hasTransitions(){if(this.hasLightTransitions()||this.hasFogTransition())return!0;for(const t in this._sourceCaches)if(this._sourceCaches[t].hasTransition())return!0;for(const t in this._layers)if(this._layers[t].hasTransition())return!0;return!1}get order(){return this.terrain?this._drapedFirstOrder:this._mergedOrder}isLayerDraped(t){return!!this.terrain&&(typeof t.isLayerDraped=="function"?t.isLayerDraped(this.getLayerSourceCache(t)):mre.has(t.type))}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}update(t){if(!this._loaded)return;this.ambientLight&&this.ambientLight.recalculate(t),this.directionalLight&&this.directionalLight.recalculate(t);const r=this.calculateLightsBrightness();t.brightness=r||0,r!==this._brightness&&(this._brightness=r,this.dispatcher.broadcast("setBrightness",r));const c=this._changes.changed;if(this._changes.changed){const h=this._changes.getLayerUpdatesByScope();for(const m in h){const{updatedIds:g,removedIds:v}=h[m];(g||v)&&this._updateWorkerLayers(m,g,v)}this.updateSourceCaches(),this._updateTilesForChangedImages(),this.updateLayers(t),this.light&&this.light.updateTransitions(t),this.ambientLight&&this.ambientLight.updateTransitions(t),this.directionalLight&&this.directionalLight.updateTransitions(t),this.fog&&this.fog.updateTransitions(t),this._changes.reset()}const u={};for(const h in this._mergedSourceCaches){const m=this._mergedSourceCaches[h];u[h]=m.used,m.used=!1}for(const h of this._mergedOrder){const m=this._mergedLayers[h];if(m.recalculate(t,this._availableImages),!m.isHidden(t.zoom)){const g=this.getOwnLayerSourceCache(m);g&&(g.used=!0)}if(!this._precompileDone&&this._shouldPrecompile)for(let g=m.minzoom||0;g<(m.maxzoom||25.5);g++){const v=this.map.painter;if(v){const b=m.getProgramIds();if(!b)continue;for(const w of b){const A=m.getDefaultProgramParams(w,t.zoom);A&&(v.style=this,this.fog&&(v._fogVisible=!0,A.overrideFog=!0,v.getOrCreateProgram(w,A)),v._fogVisible=!1,A.overrideFog=!1,v.getOrCreateProgram(w,A),(this.stylesheet.terrain||this.stylesheet.projection&&this.stylesheet.projection.name==="globe")&&(A.overrideRtt=!0,v.getOrCreateProgram(w,A)))}}}}this._shouldPrecompile&&(this._precompileDone=!0);for(const h in u){const m=this._mergedSourceCaches[h];u[h]!==m.used&&m.getSource().fire(new $t("data",{sourceDataType:"visibility",dataType:"source",sourceId:m.getSource().id}))}this.light&&this.light.recalculate(t),this.terrain&&this.terrain.recalculate(t),this.fog&&this.fog.recalculate(t),this.z=t.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),c&&this.fire(new $t("data",{dataType:"style"}));for(const{style:h}of this.fragments)h.update(t)}_updateTilesForChangedImages(){const t=Array.from(this._changes.changedImages.keys());if(t.length){for(const r in this._sourceCaches)this._sourceCaches[r].reloadTilesForDependencies(["icons","patterns"],t);this._changes.changedImages.clear()}}_updateWorkerLayers(t,r,c){const u=this.getFragmentStyle(t);this.dispatcher.broadcast("updateLayers",{layers:r?u._serializeLayers(r):[],scope:t,removedIds:c||[],options:u.options})}setState(t){if(this._checkLoaded(),G1(this,Fu(t)))return!1;(t=ue(t)).layers=n8(t.layers);const r=function(u,h){if(!u)return[{command:Bi.setStyle,args:[h]}];let m=[];try{if(!Q(u.version,h.version))return[{command:Bi.setStyle,args:[h]}];Q(u.center,h.center)||m.push({command:Bi.setCenter,args:[h.center]}),Q(u.zoom,h.zoom)||m.push({command:Bi.setZoom,args:[h.zoom]}),Q(u.bearing,h.bearing)||m.push({command:Bi.setBearing,args:[h.bearing]}),Q(u.pitch,h.pitch)||m.push({command:Bi.setPitch,args:[h.pitch]}),Q(u.sprite,h.sprite)||m.push({command:Bi.setSprite,args:[h.sprite]}),Q(u.glyphs,h.glyphs)||m.push({command:Bi.setGlyphs,args:[h.glyphs]}),Q(u.transition,h.transition)||m.push({command:Bi.setTransition,args:[h.transition]}),Q(u.light,h.light)||m.push({command:Bi.setLight,args:[h.light]}),Q(u.fog,h.fog)||m.push({command:Bi.setFog,args:[h.fog]}),Q(u.projection,h.projection)||m.push({command:Bi.setProjection,args:[h.projection]}),Q(u.lights,h.lights)||m.push({command:Bi.setLights,args:[h.lights]}),Q(u.camera,h.camera)||m.push({command:Bi.setCamera,args:[h.camera]});const g={},v=[];(function(A,C,P,k){let z;for(z in C=C||{},A=A||{})A.hasOwnProperty(z)&&(C.hasOwnProperty(z)||a8(z,P,k));for(z in C){if(!C.hasOwnProperty(z))continue;const U=C[z];A.hasOwnProperty(z)?Q(A[z],U)||(A[z].type==="geojson"&&U.type==="geojson"&&Gie(A,C,z)?P.push({command:Bi.setGeoJSONSourceData,args:[z,U.data]}):Vie(z,C,P,k)):i8(z,C,P)}})(u.sources,h.sources,v,g);const b=[];u.layers&&u.layers.forEach(A=>{A.source&&g[A.source]?m.push({command:Bi.removeLayer,args:[A.id]}):b.push(A)});let w=u.terrain;w&&g[w.source]&&(m.push({command:Bi.setTerrain,args:[void 0]}),w=void 0),m=m.concat(v),Q(w,h.terrain)||m.push({command:Bi.setTerrain,args:[h.terrain]}),function(A,C,P){C=C||[];const k=(A=A||[]).map(R3),z=C.map(R3),U=A.reduce(k3,{}),W=C.reduce(k3,{}),$=k.slice(),Z=Object.create(null);let K,q,J,re,ce,ge,ve;for(K=0,q=0;K<k.length;K++)J=k[K],W.hasOwnProperty(J)?q++:(P.push({command:Bi.removeLayer,args:[J]}),$.splice($.indexOf(J,q),1));for(K=0,q=0;K<z.length;K++)J=z[z.length-1-K],$[$.length-1-K]!==J&&(U.hasOwnProperty(J)?(P.push({command:Bi.removeLayer,args:[J]}),$.splice($.lastIndexOf(J,$.length-q),1)):q++,ge=$[$.length-K],P.push({command:Bi.addLayer,args:[W[J],ge]}),$.splice($.length-K,0,J),Z[J]=!0);for(K=0;K<z.length;K++)if(J=z[K],re=U[J],ce=W[J],!Z[J]&&!Q(re,ce))if(Q(re.source,ce.source)&&Q(re["source-layer"],ce["source-layer"])&&Q(re.type,ce.type)){for(ve in L3(re.layout,ce.layout,P,J,null,Bi.setLayoutProperty),L3(re.paint,ce.paint,P,J,null,Bi.setPaintProperty),Q(re.filter,ce.filter)||P.push({command:Bi.setFilter,args:[J,ce.filter]}),Q(re.minzoom,ce.minzoom)&&Q(re.maxzoom,ce.maxzoom)||P.push({command:Bi.setLayerZoomRange,args:[J,ce.minzoom,ce.maxzoom]}),re)re.hasOwnProperty(ve)&&ve!=="layout"&&ve!=="paint"&&ve!=="filter"&&ve!=="metadata"&&ve!=="minzoom"&&ve!=="maxzoom"&&(ve.indexOf("paint.")===0?L3(re[ve],ce[ve],P,J,ve.slice(6),Bi.setPaintProperty):Q(re[ve],ce[ve])||P.push({command:Bi.setLayerProperty,args:[J,ve,ce[ve]]}));for(ve in ce)ce.hasOwnProperty(ve)&&!re.hasOwnProperty(ve)&&ve!=="layout"&&ve!=="paint"&&ve!=="filter"&&ve!=="metadata"&&ve!=="minzoom"&&ve!=="maxzoom"&&(ve.indexOf("paint.")===0?L3(re[ve],ce[ve],P,J,ve.slice(6),Bi.setPaintProperty):Q(re[ve],ce[ve])||P.push({command:Bi.setLayerProperty,args:[J,ve,ce[ve]]}))}else P.push({command:Bi.removeLayer,args:[J]}),ge=$[$.lastIndexOf(J)+1],P.push({command:Bi.addLayer,args:[ce,ge]})}(b,h.layers,m),function(A=[],C=[],P){C=C||[];const k=(A=A||[]).map(R3),z=C.map(R3),U=A.reduce(k3,{}),W=C.reduce(k3,{}),$=k.slice();let Z,K,q,J;for(Z=0,K=0;Z<k.length;Z++)q=k[Z],W.hasOwnProperty(q)?K++:(P.push({command:Bi.removeImport,args:[q]}),$.splice($.indexOf(q,K),1));for(Z=0,K=0;Z<z.length;Z++)q=z[z.length-1-Z],$[$.length-1-Z]!==q&&(U.hasOwnProperty(q)?(P.push({command:Bi.removeImport,args:[q]}),$.splice($.lastIndexOf(q,$.length-K),1)):K++,J=$[$.length-Z],P.push({command:Bi.addImport,args:[W[q],J]}),$.splice($.length-Z,0,q));for(const re of C){const ce=U[re.id];if(!ce||Q(ce,re))continue;Q(ce.url,re.url)||P.push({command:Bi.setImportUrl,args:[re.id,re.url]});const ge=re.data;Q(ce&&ce.data,ge)||P.push({command:Bi.setImportData,args:[re.id,ge]})}}(u.imports,h.imports,m)}catch(g){console.warn("Unable to compute style diff:",g),m=[{command:Bi.setStyle,args:[h]}]}return m}(this.serialize(),t).filter(u=>!(u.command in fre));if(r.length===0)return!1;const c=r.filter(u=>!(u.command in pre));if(c.length>0)throw new Error(`Unimplemented: ${c.map(u=>u.command).join(", ")}.`);return r.forEach(u=>{this[u.command].apply(this,u.args)}),this.stylesheet=t,this.mergeAll(),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),!0}addImage(t,r){return this.getImage(t)?this.fire(new bn(new Error("An image with this name already exists."))):(this.imageManager.addImage(t,this.scope,r),this._afterImageUpdated(t),this)}updateImage(t,r){this.imageManager.updateImage(t,this.scope,r)}getImage(t){return this.imageManager.getImage(t,this.scope)}removeImage(t){return this.getImage(t)?(this.imageManager.removeImage(t,this.scope),this._afterImageUpdated(t),this):this.fire(new bn(new Error("No image with this name exists.")))}_afterImageUpdated(t){this._availableImages=this.imageManager.listImages(this.scope),this._changes.changedImages.add(t),this._changes.changed=!0,this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages}),this.fire(new $t("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addModel(t,r,c={}){return this._checkLoaded(),this._validate($y,`models.${t}`,r,null,c)||(this.modelManager.addModel(t,r,this.scope),this._changes.changed=!0),this}hasModel(t){return this.modelManager.hasModel(t,this.scope)}removeModel(t){return this.hasModel(t)?(this.modelManager.removeModel(t,this.scope),this):this.fire(new bn(new Error("No model with this ID exists.")))}listModels(){return this._checkLoaded(),this.modelManager.listModels(this.scope)}addSource(t,r,c={}){if(this._checkLoaded(),this.getOwnSource(t)!==void 0)throw new Error(`There is already a source with ID "${t}".`);if(!r.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(r).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(r.type)>=0&&this._validate(fp,`sources.${t}`,r,null,c))return;this.map&&this.map._collectResourceTiming&&(r.collectResourceTiming=!0);const u=h5(t,r,this.dispatcher,this);u.scope=this.scope,u.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(u.id),source:u.serialize(),sourceId:u.id}));const h=m=>{const g=(m?"symbol:":"other:")+u.id,v=Yo(g,this.scope),b=this._sourceCaches[g]=new Xc(v,u,m);(m?this._symbolSourceCaches:this._otherSourceCaches)[u.id]=b,b.onAdd(this.map)};h(!1),r.type!=="vector"&&r.type!=="geojson"||h(!0),u.onAdd&&u.onAdd(this.map),this.mergeSources(),this._changes.changed=!0}removeSource(t){this._checkLoaded();const r=this.getOwnSource(t);if(!r)throw new Error("There is no source with this ID");for(const u in this._layers)if(this._layers[u].source===t)return this.fire(new bn(new Error(`Source "${t}" cannot be removed while layer "${u}" is using it.`)));if(this.terrain&&this.terrain.get().source===t)return this.fire(new bn(new Error(`Source "${t}" cannot be removed while terrain is using it.`)));const c=this.getOwnSourceCaches(t);for(const u of c){const h=tv(u.id);delete this._sourceCaches[h],delete this._changes.updatedSourceCaches[u.id],u.fire(new $t("data",{sourceDataType:"metadata",dataType:"source",sourceId:u.getSource().id})),u.setEventedParent(null),u.clearTiles()}return delete this._otherSourceCaches[t],delete this._symbolSourceCaches[t],this.mergeSources(),r.setEventedParent(null),r.onRemove&&r.onRemove(this.map),this._changes.changed=!0,this}setGeoJSONSourceData(t,r){this._checkLoaded(),this.getOwnSource(t).setData(r),this._changes.changed=!0}getOwnSource(t){const r=this.getOwnSourceCache(t);return r&&r.getSource()}getOwnSources(){const t=[];for(const r in this._otherSourceCaches){const c=this.getOwnSourceCache(r);c&&t.push(c.getSource())}return t}setLights(t){if(this._checkLoaded(),!t)return delete this.ambientLight,void delete this.directionalLight;const r=this._getTransitionParameters();for(const u of t){if(this._validate(J_,"lights",u))return;switch(u.type){case"ambient":if(this.ambientLight){const h=this.ambientLight;h.set(u),h.updateTransitions(r)}else this.ambientLight=new NB(u,Sie,this.scope,this.options);break;case"directional":if(this.directionalLight){const h=this.directionalLight;h.set(u),h.updateTransitions(r)}else this.directionalLight=new NB(u,Aie,this.scope,this.options)}}const c=new sa(this.z||0,r);this.ambientLight&&this.ambientLight.recalculate(c),this.directionalLight&&this.directionalLight.recalculate(c),this._brightness=this.calculateLightsBrightness(),this.dispatcher.broadcast("setBrightness",this._brightness)}calculateLightsBrightness(){const t=this.directionalLight,r=this.ambientLight;if(!t||!r)return;const c=A=>.2126*(A[0]<=.03928?A[0]/12.92:Math.pow((A[0]+.055)/1.055,2.4))+.7152*(A[1]<=.03928?A[1]/12.92:Math.pow((A[1]+.055)/1.055,2.4))+.0722*(A[2]<=.03928?A[2]/12.92:Math.pow((A[2]+.055)/1.055,2.4)),u=t.properties.get("color").toArray01(),h=t.properties.get("intensity"),m=t.properties.get("direction"),g=1-de(m.x,m.y,m.z)[2]/90,v=c(u)*h*g,b=r.properties.get("color").toArray01(),w=r.properties.get("intensity");return(v+c(b)*w)/2}getBrightness(){return this._brightness}getLights(){if(!this.enable3dLights())return null;const t=[];return this.directionalLight&&t.push(this.directionalLight.get()),this.ambientLight&&t.push(this.ambientLight.get()),t}enable3dLights(){return!!this.ambientLight&&!!this.directionalLight}getFragmentStyle(t){if(!t)return this;const r=this.fragments.find(({id:c})=>c===t);if(!r)throw new Error(`Style import not found: ${t}`);return r.style}setConfigProperty(t,r,c){const u=Fc(c);if(u.result!=="success")return void G1(this,u.value);const h=u.value.expression,m=this.getFragmentStyle(t);m.options.set(r,h);for(const g of m._configDependentLayers){const v=this.getLayer(g);v&&(v.possiblyEvaluateVisibility(),this._updateLayer(v))}this.ambientLight&&this.ambientLight.scope===t&&this.ambientLight.updateConfig(m.options),this.directionalLight&&this.directionalLight.scope===t&&this.directionalLight.updateConfig(m.options),this._changes.changed=!0}addLayer(t,r,c={}){this._checkLoaded();const u=t.id;if(this._layers[u])return void this.fire(new bn(new Error(`Layer with id "${u}" already exists on this map`)));let h;if(t.type==="custom"){if(G1(this,function(w){const A=[],C=w.id;return C===void 0&&A.push({message:`layers.${C}: missing required property "id"`}),w.render===void 0&&A.push({message:`layers.${C}: missing required method "render"`}),w.renderingMode&&w.renderingMode!=="2d"&&w.renderingMode!=="3d"&&A.push({message:`layers.${C}: property "renderingMode" must be either "2d" or "3d"`}),A}(t)))return;h=C3(t,this.options)}else{if(typeof t.source=="object"&&(this.addSource(u,t.source),t=Fe(t=ue(t),{source:u})),this._validate(Uu,`layers.${u}`,t,{arrayIndex:-1},c))return;h=C3(t,this.options),this._validateLayer(h),h.setEventedParent(this,{layer:{id:u}}),this._serializedLayers[h.id]=h.serialize()}h.isConfigDependent&&this._configDependentLayers.add(h.fqid),h.setScope(this.scope);const m=r?this._order.indexOf(r):this._order.length;if(r&&m===-1)return void this.fire(new bn(new Error(`Layer with id "${r}" does not exist on this map.`)));this._order.splice(m,0,u),this._layerOrderChanged=!0,this._layers[u]=h;const g=this.getOwnLayerSourceCache(h),v=!!this.directionalLight&&this.directionalLight.shadowsEnabled();g&&h.canCastShadows()&&v&&(g.castsShadows=!0);const b=this._changes.getRemovedLayer(h);if(b&&h.source&&g&&h.type!=="custom"){this._changes.discardLayerRemoval(h);const w=Yo(h.source,h.scope);b.type!==h.type?this._changes.updatedSourceCaches[w]="clear":(this._changes.updatedSourceCaches[w]="reload",g.pause())}this._updateLayer(h),h.onAdd&&h.onAdd(this.map),h.scope=this.scope,this.mergeLayers()}moveLayer(t,r){if(this._checkLoaded(),this._changes.changed=!0,!this._layers[t])return void this.fire(new bn(new Error(`The layer '${t}' does not exist in the map's style and cannot be moved.`)));if(t===r)return;const c=this._order.indexOf(t);this._order.splice(c,1);const u=r?this._order.indexOf(r):this._order.length;r&&u===-1?this.fire(new bn(new Error(`Layer with id "${r}" does not exist on this map.`))):(this._order.splice(u,0,t),this._layerOrderChanged=!0,this.mergeLayers())}removeLayer(t){this._checkLoaded();const r=this._layers[t];if(!r)return void this.fire(new bn(new Error(`The layer '${t}' does not exist in the map's style and cannot be removed.`)));r.setEventedParent(null);const c=this._order.indexOf(t);this._order.splice(c,1),delete this._layers[t],delete this._serializedLayers[t],this._changes.changed=!0,this._layerOrderChanged=!0,this._configDependentLayers.delete(r.fqid),this._changes.removeLayer(r);const u=this.getOwnLayerSourceCache(r);if(u&&u.castsShadows){let h=!1;for(const m in this._layers)if(this._layers[m].source===r.source&&this._layers[m].canCastShadows()){h=!0;break}u.castsShadows=h}r.onRemove&&r.onRemove(this.map),this.mergeLayers()}getOwnLayer(t){return this._layers[t]}hasLayer(t){return t in this._mergedLayers}hasLayerType(t){for(const r in this._layers)if(this._layers[r].type===t)return!0;return!1}setLayerZoomRange(t,r,c){this._checkLoaded();const u=this.getOwnLayer(t);u?u.minzoom===r&&u.maxzoom===c||(r!=null&&(u.minzoom=r),c!=null&&(u.maxzoom=c),this._updateLayer(u)):this.fire(new bn(new Error(`The layer '${t}' does not exist in the map's style and cannot have zoom extent.`)))}setFilter(t,r,c={}){this._checkLoaded();const u=this.getOwnLayer(t);if(u){if(!Q(u.filter,r))return r==null?(u.filter=void 0,void this._updateLayer(u)):void(this._validate(mp,`layers.${u.id}.filter`,r,{layerType:u.type},c)||(u.filter=ue(r),this._updateLayer(u)))}else this.fire(new bn(new Error(`The layer '${t}' does not exist in the map's style and cannot be filtered.`)))}getFilter(t){const r=this.getOwnLayer(t);if(r)return ue(r.filter);this.fire(new bn(new Error(`The layer '${t}' does not exist in the map's style and cannot be filtered.`)))}setLayoutProperty(t,r,c,u={}){this._checkLoaded();const h=this.getOwnLayer(t);h?Q(h.getLayoutProperty(r),c)||(h.setLayoutProperty(r,c,u),h.isConfigDependent&&this._configDependentLayers.add(h.fqid),this._updateLayer(h)):this.fire(new bn(new Error(`The layer '${t}' does not exist in the map's style and cannot be styled.`)))}getLayoutProperty(t,r){const c=this.getOwnLayer(t);if(c)return c.getLayoutProperty(r);this.fire(new bn(new Error(`The layer '${t}' does not exist in the map's style.`)))}setPaintProperty(t,r,c,u={}){this._checkLoaded();const h=this.getOwnLayer(t);if(!h)return void this.fire(new bn(new Error(`The layer '${t}' does not exist in the map's style and cannot be styled.`)));if(Q(h.getPaintProperty(r),c))return;const m=h.setPaintProperty(r,c,u);h.isConfigDependent&&this._configDependentLayers.add(h.fqid),m&&this._updateLayer(h),this._changes.changed=!0,this._changes.updatedPaintProps.add(h.fqid)}getPaintProperty(t,r){const c=this.getOwnLayer(t);if(c)return c.getPaintProperty(r);this.fire(new bn(new Error(`The layer '${t}' does not exist in the map's style and cannot be styled.`)))}setFeatureState(t,r){this._checkLoaded();const c=t.source,u=t.sourceLayer,h=this.getOwnSource(c);if(!h)return void this.fire(new bn(new Error(`The source '${c}' does not exist in the map's style.`)));const m=h.type;if(m==="geojson"&&u)return void this.fire(new bn(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if(m==="vector"&&!u)return void this.fire(new bn(new Error("The sourceLayer parameter must be provided for vector source types.")));t.id===void 0&&this.fire(new bn(new Error("The feature id parameter must be provided.")));const g=this.getOwnSourceCaches(c);for(const v of g)v.setFeatureState(u,t.id,r)}removeFeatureState(t,r){this._checkLoaded();const c=t.source,u=this.getOwnSource(c);if(!u)return void this.fire(new bn(new Error(`The source '${c}' does not exist in the map's style.`)));const h=u.type,m=h==="vector"?t.sourceLayer:void 0;if(h==="vector"&&!m)return void this.fire(new bn(new Error("The sourceLayer parameter must be provided for vector source types.")));if(r&&typeof t.id!="string"&&typeof t.id!="number")return void this.fire(new bn(new Error("A feature id is required to remove its specific state property.")));const g=this.getOwnSourceCaches(c);for(const v of g)v.removeFeatureState(m,t.id,r)}getFeatureState(t){this._checkLoaded();const r=t.source,c=t.sourceLayer,u=this.getOwnSource(r);if(u){if(u.type!=="vector"||c)return t.id===void 0&&this.fire(new bn(new Error("The feature id parameter must be provided."))),this.getOwnSourceCaches(r)[0].getFeatureState(c,t.id);this.fire(new bn(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new bn(new Error(`The source '${r}' does not exist in the map's style.`)))}setTransition(t){return this.stylesheet.transition=Fe({},this.stylesheet.transition,t),this.transition=this.stylesheet.transition,this}getTransition(){return Fe({},this.stylesheet.transition)}serialize(){this._checkLoaded();const t=this.getTerrain(),r=t&&this.terrain&&this.terrain.scope===this.scope?t:void 0;return Be({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,imports:this._serializeImports(),schema:this.stylesheet.schema,camera:this.stylesheet.camera,light:this.stylesheet.light,lights:this.stylesheet.lights,terrain:r,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:this._serializeSources(),layers:this._serializeLayers(this._order)},c=>c!==void 0)}_updateLayer(t){this._changes.updateLayer(t);const r=this.getLayerSourceCache(t),c=Yo(t.source,t.scope);t.source&&!this._changes.updatedSourceCaches[c]&&r&&r.getSource().type!=="raster"&&(this._changes.updatedSourceCaches[c]="reload",r.pause()),this._changes.changed=!0,t.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(t){const r=g=>this._mergedLayers[g].type==="fill-extrusion",c=this.order,u={},h=[];for(let g=c.length-1;g>=0;g--){const v=c[g];if(r(v)){u[v]=g;for(const b of t){const w=b[v];if(w)for(const A of w)h.push(A)}}}h.sort((g,v)=>v.intersectionZ-g.intersectionZ);const m=[];for(let g=c.length-1;g>=0;g--){const v=c[g];if(r(v))for(let b=h.length-1;b>=0;b--){const w=h[b].feature;if(u[w.layer.id]<g)break;m.push(w),h.pop()}else for(const b of t){const w=b[v];if(w)for(const A of w)m.push(A.feature)}}return m}queryRenderedFeatures(t,r,c){r&&r.filter&&this._validate(mp,"queryRenderedFeatures.filter",r.filter,null,r),r.scope=this.scope,r.availableImages=this._availableImages,r.serializedLayers=this._serializedLayers;const u={};if(r&&r.layers){if(!Array.isArray(r.layers))return this.fire(new bn(new Error("parameters.layers must be an Array."))),[];for(const b of r.layers){const w=this._mergedLayers[b];if(!w)return this.fire(new bn(new Error(`The layer '${b}' does not exist in the map's style and cannot be queried for features.`))),[];u[w.source]=!0}}const h=[],m=r.serializedLayers||{},g=r&&r.layers?r.layers.some(b=>{const w=this.getLayer(b);return w&&w.is3D()}):this.has3DLayers(),v=KP.createFromScreenPoints(t,c);for(const b in this._mergedSourceCaches){const w=this._mergedSourceCaches[b].getSource();if(!w||w.scope!==r.scope)continue;const A=this._mergedSourceCaches[b].getSource().id;r.layers&&!u[A]||h.push(Fie(this._mergedSourceCaches[b],this._mergedLayers,m,v,r,c,g,!!this.map._showQueryGeometry))}return this.placement&&h.push(function(b,w,A,C,P,k,z){const U={},W=k.queryRenderedSymbols(C),$=[];for(const Z of Object.keys(W).map(Number))$.push(z[Z]);$.sort(e8);for(const Z of $){const K=Z.featureIndex.lookupSymbolFeatures(W[Z.bucketInstanceId],w,Z.bucketIndex,Z.sourceLayerIndex,P.filter,P.layers,P.availableImages,b);for(const q in K){const J=U[q]=U[q]||[],re=K[q];re.sort((ce,ge)=>{const ve=Z.featureSortOrder;if(ve){const Ce=ve.indexOf(ce.featureIndex);return ve.indexOf(ge.featureIndex)-Ce}return ge.featureIndex-ce.featureIndex});for(const ce of re)J.push(ce)}}for(const Z in U)U[Z].forEach(K=>{const q=K.feature,J=A(b[Z]);if(!J)return;const re=J.getFeatureState(q.layer["source-layer"],q.id);q.source=q.layer.source,q.layer["source-layer"]&&(q.sourceLayer=q.layer["source-layer"]),q.state=re});return U}(this._mergedLayers,m,this.getLayerSourceCache.bind(this),v.screenGeometry,r,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(h)}querySourceFeatures(t,r){r&&r.filter&&this._validate(mp,"querySourceFeatures.filter",r.filter,null,r);const c=this.getOwnSourceCaches(t);let u=[];for(const h of c)u=u.concat(Bie(h,r));return u}addSourceType(t,r,c){return Jc.getSourceType(t)?c(new Error(`A source type called "${t}" already exists.`)):(Jc.setSourceType(t,r),r.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:t,url:r.workerSourceURL},c):c(null,null))}getFlatLight(){return this.light.getLight()}setFlatLight(t,r,c={}){this._checkLoaded();const u=this.light.getLight();let h=!1;for(const g in t)if(!Q(t[g],u[g])){h=!0;break}if(!h)return;const m=this._getTransitionParameters();this.light.setLight(t,r,c),this.light.updateTransitions(m)}getTerrain(){return this.terrain&&this.terrain.drapeRenderMode===1?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}setTerrain(t,r=1){if(this._checkLoaded(),!t)return delete this.terrain,delete this.stylesheet.terrain,this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);let c=t;if(r===1){if(typeof c.source=="object"){const u="terrain-dem-src";this.addSource(u,c.source),c=ue(c),c=Fe(c,{source:u})}if(this._validate(Bu,"terrain",c))return}if(!this.terrain||this.terrain&&r!==this.terrain.drapeRenderMode){if(!c)return;this._createTerrain(c,r),this.fire(new $t("data",{dataType:"style"}))}else{const u=this.terrain,h=u.get();for(const m of Object.keys(at.terrain))!c.hasOwnProperty(m)&&at.terrain[m].default&&(c[m]=at.terrain[m].default);for(const m in t)if(!Q(t[m],h[m])){u.set(t),this.stylesheet.terrain=t;const g=this._getTransitionParameters({duration:0});u.updateTransitions(g),this.fire(new $t("data",{dataType:"style"}));break}}this.mergeTerrain(),this.updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(t){const r=this.fog=new bie(t,this.map.transform);this.stylesheet.fog=r.get();const c=this._getTransitionParameters({duration:0});r.updateTransitions(c)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask(()=>{for(const t of this.map._markers)t._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(t){if(this._checkLoaded(),!t)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const r=this.fog;if(!Q(r.get(),t)){r.set(t),this.stylesheet.fog=r.get();const c=this._getTransitionParameters({duration:0});r.updateTransitions(c)}}else this._createFog(t);this._markersNeedUpdate=!0}_getTransitionParameters(t){return{now:Cn.now(),transition:Fe(this.transition,t)}}updateDrapeFirstLayers(){if(!this.terrain)return;const t=[],r=[];for(const c in this._mergedLayers)this.isLayerDraped(this._mergedLayers[c])?t.push(c):r.push(c);this._drapedFirstOrder=[],this._drapedFirstOrder.push(...t),this._drapedFirstOrder.push(...r)}_createTerrain(t,r){const c=this.terrain=new vie(t,r);c.setScope(this.scope),this.stylesheet.terrain=t,this.mergeTerrain(),this.updateDrapeFirstLayers(),this._force3DLayerUpdate();const u=this._getTransitionParameters({duration:0});c.updateTransitions(u)}_force3DLayerUpdate(){for(const t in this._layers){const r=this._layers[t];r.type==="fill-extrusion"&&this._updateLayer(r)}}_forceSymbolLayerUpdate(){for(const t in this._layers){const r=this._layers[t];r.type==="symbol"&&this._updateLayer(r)}}_validate(t,r,c,u,h={}){if(h&&h.validate===!1)return!1;const m=Fe({},this.serialize());return G1(this,t.call(Fu,Fe({key:r,style:m,value:c,styleSpec:at},u)))}_remove(){for(const{style:t}of this.fragments)t._remove();this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),Jy.off("pluginStateChange",this._rtlTextPluginCallback),this.mergeLayers(),this.mergeSources();for(const t in this._layers)this._layers[t].setEventedParent(null);for(const t in this._sourceCaches)this._sourceCaches[t].clearTiles(),this._sourceCaches[t].setEventedParent(null);this.setEventedParent(null),delete this.ambientLight,delete this.directionalLight,this.importDepth===0&&(this.imageManager.setEventedParent(null),this.modelManager.setEventedParent(null),this.dispatcher.remove())}clearSource(t){const r=this.getSourceCaches(t);for(const c of r)c.clearTiles()}reloadSource(t){const r=this.getSourceCaches(t);for(const c of r)c.resume(),c.reload()}reloadSources(){for(const t of this.getSources())t.reload&&t.reload()}updateSources(t){let r;this.directionalLight&&(r=i9(this.directionalLight));for(const c in this._mergedSourceCaches)this._mergedSourceCaches[c].update(t,void 0,void 0,r)}_generateCollisionBoxes(){for(const t in this._sourceCaches){const r=this._sourceCaches[t];r.resume(),r.reload()}}_updatePlacement(t,r,c,u,h=!1){let m=!1,g=!1;const v={},b={};for(const w of this._mergedOrder){const A=this._mergedLayers[w];if(A.type!=="symbol")continue;if(!v[A.source]){const P=this.getLayerSourceCache(A);if(!P)continue;const k=P.getRenderableIds(!0).map(z=>P.getTileByID(z));b[A.source]=k.slice(),v[A.source]=k.sort((z,U)=>U.tileID.overscaledZ-z.tileID.overscaledZ||(z.tileID.isLessThan(U.tileID)?-1:1))}const C=this.crossTileSymbolIndex.addLayer(A,v[A.source],t.center.lng,t.projection);m=m||C}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._mergedOrder),h=h||this._layerOrderChanged||c===0,this._layerOrderChanged&&this.fire(new $t("neworder")),(h||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(Cn.now(),t.zoom))&&(this.pauseablePlacement=new rae(t,this._mergedOrder,h,r,c,u,this.placement,this.fog&&t.projection.supportsFog?this.fog.state:null,this._buildingIndex),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._mergedOrder,this._mergedLayers,v,b),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(Cn.now()),g=!0),m&&this.pauseablePlacement.placement.setStale()),g||m)for(const w of this._mergedOrder){const A=this._mergedLayers[w];A.type==="symbol"&&this.placement.updateLayerOpacities(A,v[A.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(Cn.now())}_releaseSymbolFadeTiles(){for(const t in this._sourceCaches)this._sourceCaches[t].releaseSymbolFadeTiles()}addImport(t){this._checkLoaded();const r=this.stylesheet.imports;return r?r.findIndex(({id:u})=>u===t.id)!==-1?(this.fire(new bn(new Error(`Import with id '${t.id}' already exists in the map's style.`))),this):(this.stylesheet.imports?this.stylesheet.imports.push(t):this.stylesheet.imports=[t],this._loadImports([t],!0),this):this}setImportUrl(t,r){this._checkLoaded();const c=this.stylesheet.imports;if(!c)return this;const u=this.getImportIndex(t);if(u===-1)return this;c[u].url=r;const h=this.fragments[u];h.style=this._createFragmentStyle({id:t,url:r});const m=new Promise(g=>h.style.on("style.import.load",g));return h.style.loadURL(r),m.then(()=>this._reloadImports()),this}setImportData(t,r){this._checkLoaded();const c=this.stylesheet.imports;if(!c)return this;const u=this.getImportIndex(t);return u===-1?this:r?(this.fragments[u].style.setState(r),this._reloadImports(),this):(delete c[u].data,this.setImportUrl(t,c[u].url))}removeImport(t){this._checkLoaded();const r=this.stylesheet.imports;if(!r)return this;const c=this.getImportIndex(t);return c===-1||(r.splice(c,1),this.fragments[c].style._remove(),this.fragments.splice(c,1),this._reloadImports()),this}getImportIndex(t){const r=this.stylesheet.imports;if(!r)return-1;const c=r.findIndex(u=>u.id===t);return c===-1&&this.fire(new bn(new Error(`Import '${t}' does not exist in the map's style and cannot be updated.`))),c}getLayer(t){return this._mergedLayers[t]}getSources(){const t=[];for(const r in this._mergedOtherSourceCaches){const c=this._mergedOtherSourceCaches[r];c&&t.push(c.getSource())}return t}getSource(t,r){const c=this.getSourceCache(t,r);return c&&c.getSource()}getLayerSource(t){const r=this.getLayerSourceCache(t);return r&&r.getSource()}getSourceCache(t,r){const c=Yo(t,r);return this._mergedOtherSourceCaches[c]}getLayerSourceCache(t){const r=Yo(t.source,t.scope);return t.type==="symbol"?this._mergedSymbolSourceCaches[r]:this._mergedOtherSourceCaches[r]}getSourceCaches(t){const r=[];return this._mergedOtherSourceCaches[t]&&r.push(this._mergedOtherSourceCaches[t]),this._mergedSymbolSourceCaches[t]&&r.push(this._mergedSymbolSourceCaches[t]),r}updateSourceCaches(){for(const t in this._changes.updatedSourceCaches){const r=this._changes.updatedSourceCaches[t];r==="reload"?this.reloadSource(t):r==="clear"&&this.clearSource(t)}}updateLayers(t){for(const r of this._changes.updatedPaintProps){const c=this.getLayer(r);c&&c.updateTransitions(t)}}getImages(t,r,c){this.imageManager.getImages(r.icons,r.scope,c),this._updateTilesForChangedImages();const u=h=>{h&&h.setDependencies(r.tileID.key,r.type,r.icons)};u(this._otherSourceCaches[r.source]),u(this._symbolSourceCaches[r.source])}getGlyphs(t,r,c){this.glyphManager.getGlyphs(r.stacks,r.scope,c)}getResource(t,r,c){return et(r,c)}getOwnSourceCache(t){return this._otherSourceCaches[t]}getOwnLayerSourceCache(t){return t.type==="symbol"?this._symbolSourceCaches[t.source]:this._otherSourceCaches[t.source]}getOwnSourceCaches(t){const r=[];return this._otherSourceCaches[t]&&r.push(this._otherSourceCaches[t]),this._symbolSourceCaches[t]&&r.push(this._symbolSourceCaches[t]),r}_isSourceCacheLoaded(t){const r=this.getOwnSourceCaches(t);return r.length===0?(this.fire(new bn(new Error(`There is no source with ID '${t}'`))),!1):r.every(c=>c.loaded())}has3DLayers(){return this._has3DLayers}hasSymbolLayers(){return this._hasSymbolLayers}hasCircleLayers(){return this._hasCircleLayers}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}function o9(a,t){let r=!1,c=null;const u=()=>{c=null,r&&(a(),c=setTimeout(u,t),r=!1)};return()=>(r=!0,c||u(),c)}Jc.getSourceType=function(a){return d5[a]},Jc.setSourceType=function(a,t){d5[a]=t},Jc.registerForPluginStateChange=function(a){return a({pluginStatus:Wr,pluginURL:Vc}),Jy.on("pluginStateChange",a),a};class gre{constructor(t){this._hashName=t&&encodeURIComponent(t),ft(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=o9(this._updateHashUnthrottled.bind(this),300)}addTo(t){return this._map=t,f.addEventListener("hashchange",this._onHashChange,!1),t.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),f.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const t=this._map;if(!t)return"";const r=s9(t);if(this._hashName){const c=this._hashName;let u=!1;const h=f.location.hash.slice(1).split("&").map(m=>{const g=m.split("=")[0];return g===c?(u=!0,`${g}=${r}`):m}).filter(m=>m);return u||h.push(`${c}=${r}`),`#${h.join("&")}`}return`#${r}`}_getCurrentHash(){const t=f.location.hash.replace("#","");if(this._hashName){let r;return t.split("&").map(c=>c.split("=")).forEach(c=>{c[0]===this._hashName&&(r=c)}),(r&&r[1]||"").split("/")}return t.split("/")}_onHashChange(){const t=this._map;if(!t)return!1;const r=this._getCurrentHash();if(r.length>=3&&!r.some(c=>isNaN(c))){const c=t.dragRotate.isEnabled()&&t.touchZoomRotate.isEnabled()?+(r[3]||0):t.getBearing();return t.jumpTo({center:[+r[2],+r[1]],zoom:+r[0],bearing:c,pitch:+(r[4]||0)}),!0}return!1}_updateHashUnthrottled(){const t=f.location.href.replace(/(#.+)?$/,this.getHashString());f.history.replaceState(f.history.state,null,t)}}function s9(a,t){const r=a.getCenter(),c=Math.round(100*a.getZoom())/100,u=Math.ceil((c*Math.LN2+Math.log(512/360/.5))/Math.LN10),h=Math.pow(10,u),m=Math.round(r.lng*h)/h,g=Math.round(r.lat*h)/h,v=a.getBearing(),b=a.getPitch();let w=t?`/${m}/${g}/${c}`:`${c}/${g}/${m}`;return(v||b)&&(w+="/"+Math.round(10*v)/10),b&&(w+=`/${Math.round(b)}`),w}const j3={linearity:.3,easing:me(0,0,.3,1)},yre=Fe({deceleration:2500,maxSpeed:1400},j3),vre=Fe({deceleration:20,maxSpeed:1400},j3),_re=Fe({deceleration:1e3,maxSpeed:360},j3),bre=Fe({deceleration:1e3,maxSpeed:90},j3);class xre{constructor(t){this._map=t,this.clear()}clear(){this._inertiaBuffer=[]}record(t){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:Cn.now(),settings:t})}_drainInertiaBuffer(){const t=this._inertiaBuffer,r=Cn.now();for(;t.length>0&&r-t[0].time>160;)t.shift()}_onMoveEnd(t){if(this._map._prefersReducedMotion()||(this._drainInertiaBuffer(),this._inertiaBuffer.length<2))return;const r={zoom:0,bearing:0,pitch:0,pan:new V(0,0),pinchAround:void 0,around:void 0};for(const{settings:h}of this._inertiaBuffer)r.zoom+=h.zoomDelta||0,r.bearing+=h.bearingDelta||0,r.pitch+=h.pitchDelta||0,h.panDelta&&r.pan._add(h.panDelta),h.around&&(r.around=h.around),h.pinchAround&&(r.pinchAround=h.pinchAround);const c=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,u={};if(r.pan.mag()){const h=Y3(r.pan.mag(),c,Fe({},yre,t||{}));u.offset=r.pan.mult(h.amount/r.pan.mag()),u.center=this._map.transform.center,$3(u,h)}if(r.zoom){const h=Y3(r.zoom,c,vre);u.zoom=this._map.transform.zoom+h.amount,$3(u,h)}if(r.bearing){const h=Y3(r.bearing,c,_re);u.bearing=this._map.transform.bearing+ae(h.amount,-179,179),$3(u,h)}if(r.pitch){const h=Y3(r.pitch,c,bre);u.pitch=this._map.transform.pitch+h.amount,$3(u,h)}if(u.zoom||u.bearing){const h=r.pinchAround===void 0?r.around:r.pinchAround;u.around=h?this._map.unproject(h):this._map.getCenter()}return this.clear(),u.noMoveStart=!0,u}}function $3(a,t){(!a.duration||a.duration<t.duration)&&(a.duration=t.duration,a.easing=t.easing)}function Y3(a,t,r){const{maxSpeed:c,linearity:u,deceleration:h}=r,m=ae(a*u/(t/1e3),-c,c),g=Math.abs(m)/(h*u);return{easing:r.easing,duration:1e3*g,amount:m*(g/2)}}class Fl extends $t{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,r,c,u={}){const h=Il(r.getCanvasContainer(),c);super(t,Fe({point:h,lngLat:r.unproject(h),originalEvent:c},u)),this._defaultPrevented=!1,this.target=r}}class q3 extends $t{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,r,c){const u=t==="touchend"?c.changedTouches:c.touches,h=Pd(r.getCanvasContainer(),u),m=h.map(v=>r.unproject(v)),g=h.reduce((v,b,w,A)=>v.add(b.div(A.length)),new V(0,0));super(t,{points:h,point:g,lngLats:m,lngLat:r.unproject(g),originalEvent:c}),this._defaultPrevented=!1}}class wre extends $t{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,r,c){super(t,{originalEvent:c}),this._defaultPrevented=!1}}class Sre{constructor(t,r){this._map=t,this._clickTolerance=r.clickTolerance}reset(){this._mousedownPos=void 0}wheel(t){return this._firePreventable(new wre(t.type,this._map,t))}mousedown(t,r){return this._mousedownPos=r,this._firePreventable(new Fl(t.type,this._map,t))}mouseup(t){this._map.fire(new Fl(t.type,this._map,t))}preclick(t){const r=Fe({},t);r.type="preclick",this._map.fire(new Fl(r.type,this._map,r))}click(t,r){this._mousedownPos&&this._mousedownPos.dist(r)>=this._clickTolerance||(this.preclick(t),this._map.fire(new Fl(t.type,this._map,t)))}dblclick(t){return this._firePreventable(new Fl(t.type,this._map,t))}mouseover(t){this._map.fire(new Fl(t.type,this._map,t))}mouseout(t){this._map.fire(new Fl(t.type,this._map,t))}touchstart(t){return this._firePreventable(new q3(t.type,this._map,t))}touchmove(t){this._map.fire(new q3(t.type,this._map,t))}touchend(t){this._map.fire(new q3(t.type,this._map,t))}touchcancel(t){this._map.fire(new q3(t.type,this._map,t))}_firePreventable(t){if(this._map.fire(t),t.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Are{constructor(t){this._map=t}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(t){this._map.fire(new Fl(t.type,this._map,t))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Fl("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(t){this._delayContextMenu?this._contextMenuEvent=t:this._map.fire(new Fl(t.type,this._map,t)),this._map.listens("contextmenu")&&t.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Ere{constructor(t,r){this._map=t,this._el=t.getCanvasContainer(),this._container=t.getContainer(),this._clickTolerance=r.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(t,r){this.isEnabled()&&t.shiftKey&&t.button===0&&(Nf(),this._startPos=this._lastPos=r,this._active=!0)}mousemoveWindow(t,r){if(!this._active)return;const c=r,u=this._startPos,h=this._lastPos;if(!u||!h||h.equals(c)||!this._box&&c.dist(u)<this._clickTolerance)return;this._lastPos=c,this._box||(this._box=Jn("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",t));const m=Math.min(u.x,c.x),g=Math.max(u.x,c.x),v=Math.min(u.y,c.y),b=Math.max(u.y,c.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${m}px,${v}px)`,this._box.style.width=g-m+"px",this._box.style.height=b-v+"px")})}mouseupWindow(t,r){if(!this._active)return;const c=this._startPos,u=r;if(c&&t.button===0){if(this.reset(),Pl(),c.x!==u.x||c.y!==u.y)return this._map.fire(new $t("boxzoomend",{originalEvent:t})),{cameraAnimation:h=>h.fitScreenCoordinates(c,u,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",t)}}keydown(t){this._active&&t.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",t))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),ic(),delete this._startPos,delete this._lastPos}_fireEvent(t,r){return this._map.fire(new $t(t,{originalEvent:r}))}}function M5(a,t){const r={};for(let c=0;c<a.length;c++)r[a[c].identifier]=t[c];return r}class Mre{constructor(t){this.reset(),this.numTouches=t.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(t,r,c){(this.centroid||c.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===0&&(this.startTime=t.timeStamp),c.length===this.numTouches&&(this.centroid=function(u){const h=new V(0,0);for(const m of u)h._add(m);return h.div(u.length)}(r),this.touches=M5(c,r)))}touchmove(t,r,c){if(this.aborted||!this.centroid)return;const u=M5(c,r);for(const h in this.touches){const m=u[h];(!m||m.dist(this.touches[h])>30)&&(this.aborted=!0)}}touchend(t,r,c){if((!this.centroid||t.timeStamp-this.startTime>500)&&(this.aborted=!0),c.length===0){const u=!this.aborted&&this.centroid;if(this.reset(),u)return u}}}class T5{constructor(t){this.singleTap=new Mre(t),this.numTaps=t.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(t,r,c){this.singleTap.touchstart(t,r,c)}touchmove(t,r,c){this.singleTap.touchmove(t,r,c)}touchend(t,r,c){const u=this.singleTap.touchend(t,r,c);if(u){const h=t.timeStamp-this.lastTime<500,m=!this.lastTap||this.lastTap.dist(u)<30;if(h&&m||this.reset(),this.count++,this.lastTime=t.timeStamp,this.lastTap=u,this.count===this.numTaps)return this.reset(),u}}}class Tre{constructor(){this._zoomIn=new T5({numTouches:1,numTaps:2}),this._zoomOut=new T5({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(t,r,c){this._zoomIn.touchstart(t,r,c),this._zoomOut.touchstart(t,r,c)}touchmove(t,r,c){this._zoomIn.touchmove(t,r,c),this._zoomOut.touchmove(t,r,c)}touchend(t,r,c){const u=this._zoomIn.touchend(t,r,c),h=this._zoomOut.touchend(t,r,c);return u?(this._active=!0,t.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:m=>m.easeTo({duration:300,zoom:m.getZoom()+1,around:m.unproject(u)},{originalEvent:t})}):h?(this._active=!0,t.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:m=>m.easeTo({duration:300,zoom:m.getZoom()-1,around:m.unproject(h)},{originalEvent:t})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const Cre={0:1,2:2};class C5{constructor(t){this.reset(),this._clickTolerance=t.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(t,r){return!1}_move(t,r){return{}}mousedown(t,r){if(this._lastPoint)return;const c=Zh(t);this._correctButton(t,c)&&(this._lastPoint=r,this._eventButton=c)}mousemoveWindow(t,r){const c=this._lastPoint;if(c){if(t.preventDefault(),this._eventButton!=null&&function(u,h){const m=Cre[h];return u.buttons===void 0||(u.buttons&m)!==m}(t,this._eventButton))this.reset();else if(this._moved||!(r.dist(c)<this._clickTolerance))return this._moved=!0,this._lastPoint=r,this._move(c,r)}}mouseupWindow(t){this._lastPoint&&Zh(t)===this._eventButton&&(this._moved&&Pl(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Pre extends C5{mousedown(t,r){super.mousedown(t,r),this._lastPoint&&(this._active=!0)}_correctButton(t,r){return r===0&&!t.ctrlKey}_move(t,r){return{around:r,panDelta:r.sub(t)}}}class l9 extends C5{_correctButton(t,r){return r===0&&t.ctrlKey||r===2}_move(t,r){const c=.8*(r.x-t.x);if(c)return this._active=!0,{bearingDelta:c}}contextmenu(t){t.preventDefault()}}class c9 extends C5{_correctButton(t,r){return r===0&&t.ctrlKey||r===2}_move(t,r){const c=-.5*(r.y-t.y);if(c)return this._active=!0,{pitchDelta:c}}contextmenu(t){t.preventDefault()}}class Ire{constructor(t,r){this._map=t,this._el=t.getCanvasContainer(),this._minTouches=1,this._clickTolerance=r.clickTolerance||1,this.reset(),ft(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new V(0,0)}touchstart(t,r,c){return this._calculateTransform(t,r,c)}touchmove(t,r,c){if(this._active&&!(c.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(c.length===1&&!it())return void this._showTouchPanBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return t.cancelable&&t.preventDefault(),this._calculateTransform(t,r,c)}}touchend(t,r,c){this._calculateTransform(t,r,c),this._active&&c.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(t,r,c){c.length>0&&(this._active=!0);const u=M5(c,r),h=new V(0,0),m=new V(0,0);let g=0;for(const b in u){const w=u[b],A=this._touches[b];A&&(h._add(w),m._add(w.sub(A)),g++,u[b]=w)}if(this._touches=u,g<this._minTouches||!m.mag())return;const v=m.div(g);return this._sum._add(v),this._sum.mag()<this._clickTolerance?void 0:{around:h.div(g),panDelta:v}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=Jn("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","null")},500)}}class P5{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(t){}_move(t,r,c){return{}}touchstart(t,r,c){this._firstTwoTouches||c.length<2||(this._firstTwoTouches=[c[0].identifier,c[1].identifier],this._start([r[0],r[1]]))}touchmove(t,r,c){const u=this._firstTwoTouches;if(!u)return;t.preventDefault();const[h,m]=u,g=X3(c,r,h),v=X3(c,r,m);if(!g||!v)return;const b=this._aroundCenter?null:g.add(v).div(2);return this._move([g,v],b,t)}touchend(t,r,c){if(!this._firstTwoTouches)return;const[u,h]=this._firstTwoTouches,m=X3(c,r,u),g=X3(c,r,h);m&&g||(this._active&&Pl(),this.reset())}touchcancel(){this.reset()}enable(t){this._enabled=!0,this._aroundCenter=!!t&&t.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function X3(a,t,r){for(let c=0;c<a.length;c++)if(a[c].identifier===r)return t[c]}function u9(a,t){return Math.log(a/t)/Math.LN2}class Lre extends P5{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(t){this._startDistance=this._distance=t[0].dist(t[1])}_move(t,r){const c=this._distance;if(this._distance=t[0].dist(t[1]),this._active||!(Math.abs(u9(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:u9(this._distance,c),pinchAround:r}}}function d9(a,t){return 180*a.angleWith(t)/Math.PI}class Rre extends P5{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(t){this._startVector=this._vector=t[0].sub(t[1]),this._minDiameter=t[0].dist(t[1])}_move(t,r){const c=this._vector;if(this._vector=t[0].sub(t[1]),c&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:d9(this._vector,c),pinchAround:r}}_isBelowThreshold(t){this._minDiameter=Math.min(this._minDiameter,t.mag());const r=25/(Math.PI*this._minDiameter)*360,c=this._startVector;if(!c)return!1;const u=d9(t,c);return Math.abs(u)<r}}function I5(a){return Math.abs(a.y)>Math.abs(a.x)}class kre extends P5{constructor(t){super(),this._map=t}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(t){this._lastPoints=t,I5(t[0].sub(t[1]))&&(this._valid=!1)}_move(t,r,c){const u=this._lastPoints;if(!u)return;const h=t[0].sub(u[0]),m=t[1].sub(u[1]);return this._map._cooperativeGestures&&!it()&&c.touches.length<3||(this._valid=this.gestureBeginsVertically(h,m,c.timeStamp),!this._valid)?void 0:(this._lastPoints=t,this._active=!0,{pitchDelta:(h.y+m.y)/2*-.5})}gestureBeginsVertically(t,r,c){if(this._valid!==void 0)return this._valid;const u=t.mag()>=2,h=r.mag()>=2;if(!u&&!h)return;if(!u||!h)return this._firstMove==null&&(this._firstMove=c),c-this._firstMove<100&&void 0;const m=t.y>0==r.y>0;return I5(t)&&I5(r)&&m}}const Dre={panStep:100,bearingStep:15,pitchStep:10};class Ore{constructor(){const t=Dre;this._panStep=t.panStep,this._bearingStep=t.bearingStep,this._pitchStep=t.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(t){if(t.altKey||t.ctrlKey||t.metaKey)return;let r=0,c=0,u=0,h=0,m=0;switch(t.keyCode){case 61:case 107:case 171:case 187:r=1;break;case 189:case 109:case 173:r=-1;break;case 37:t.shiftKey?c=-1:(t.preventDefault(),h=-1);break;case 39:t.shiftKey?c=1:(t.preventDefault(),h=1);break;case 38:t.shiftKey?u=1:(t.preventDefault(),m=-1);break;case 40:t.shiftKey?u=-1:(t.preventDefault(),m=1);break;default:return}return this._rotationDisabled&&(c=0,u=0),{cameraAnimation:g=>{const v=g.getZoom();g.easeTo({duration:300,easeId:"keyboardHandler",easing:Nre,zoom:r?Math.round(v)+r*(t.shiftKey?2:1):v,bearing:g.getBearing()+c*this._bearingStep,pitch:g.getPitch()+u*this._pitchStep,offset:[-h*this._panStep,-m*this._panStep],center:g.getCenter()},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Nre(a){return a*(2-a)}const h9=4.000244140625;class zre{constructor(t,r){this._map=t,this._el=t.getCanvasContainer(),this._handler=r,this._delta=0,this._lastDelta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,ft(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(t){this._defaultZoomRate=t}setWheelZoomRate(t){this._wheelZoomRate=t}isEnabled(){return!!this._enabled}isActive(){return this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(t){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!t&&t.around==="center",this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(t){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(t.ctrlKey||t.metaKey||this.isZooming()||it()))return void this._showBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let r=t.deltaMode===f.WheelEvent.DOM_DELTA_LINE?40*t.deltaY:t.deltaY;const c=Cn.now(),u=c-(this._lastWheelEventTime||0);this._lastWheelEventTime=c,r!==0&&r%h9==0?this._type="wheel":r!==0&&Math.abs(r)<4?this._type="trackpad":u>400?(this._type=null,this._lastValue=r,this._timeout=setTimeout(this._onTimeout,40,t)):this._type||(this._type=Math.abs(u*r)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,r+=this._lastValue)),t.shiftKey&&r&&(r/=4),this._type&&(this._lastWheelEvent=t,this._delta-=r,this._active||this._start(t)),t.preventDefault()}_onTimeout(t){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(t)}_start(t){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const r=Il(this._el,t);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:r,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const t=this._map.transform;this._type==="wheel"&&t.projection.wrap&&(t._center.lng>=180||t._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const r=()=>t._terrainEnabled()&&this._aroundCoord?t.computeZoomRelativeTo(this._aroundCoord):t.zoom;if(this._delta!==0){const b=this._type==="wheel"&&Math.abs(this._delta)>h9?this._wheelZoomRate:this._defaultZoomRate;let w=2/(1+Math.exp(-Math.abs(this._delta*b)));this._delta<0&&w!==0&&(w=1/w);const A=r(),C=Math.pow(2,A),P=typeof this._targetZoom=="number"?t.zoomScale(this._targetZoom):C;this._targetZoom=Math.min(t.maxZoom,Math.max(t.minZoom,t.scaleZoom(P*w))),this._type==="wheel"&&(this._startZoom=A,this._easing=this._smoothOutEasing(200)),this._lastDelta=this._delta,this._delta=0}const c=typeof this._targetZoom=="number"?this._targetZoom:r(),u=this._startZoom,h=this._easing;let m,g=!1;if(this._type==="wheel"&&u&&h){const b=Math.min((Cn.now()-this._lastWheelEventTime)/200,1);m=Ln(u,c,h(b)),b<1?this._frameId||(this._frameId=!0):g=!0}else m=c,g=!0;this._active=!0,g&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200));let v=m-r();return v*this._lastDelta<0&&(v=0),{noInertia:!0,needsRenderFrame:!g,zoomDelta:v,around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(t){let r=xe;if(this._prevEase){const c=this._prevEase,u=(Cn.now()-c.start)/c.duration,h=c.easing(u+.01)-c.easing(u),m=.27/Math.sqrt(h*h+1e-4)*.01;r=me(m,Math.sqrt(.0729-m*m),.25,1)}return this._prevEase={start:Cn.now(),duration:t,easing:r},r}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=Jn("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(f.navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","null")},200)}}class Fre{constructor(t,r){this._clickZoom=t,this._tapZoom=r}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Bre{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(t,r){return t.preventDefault(),{cameraAnimation:c=>{c.easeTo({duration:300,zoom:c.getZoom()+(t.shiftKey?-1:1),around:c.unproject(r)},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ure{constructor(){this._tap=new T5({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(t,r,c){this._swipePoint||(this._tapTime&&t.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?c.length>0&&(this._swipePoint=r[0],this._swipeTouch=c[0].identifier):this._tap.touchstart(t,r,c))}touchmove(t,r,c){if(this._tapTime){if(this._swipePoint){if(c[0].identifier!==this._swipeTouch)return;const u=r[0],h=u.y-this._swipePoint.y;return this._swipePoint=u,t.preventDefault(),this._active=!0,{zoomDelta:h/128}}}else this._tap.touchmove(t,r,c)}touchend(t,r,c){this._tapTime?this._swipePoint&&c.length===0&&this.reset():this._tap.touchend(t,r,c)&&(this._tapTime=t.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Wre{constructor(t,r,c){this._el=t,this._mousePan=r,this._touchPan=c}enable(t){this._inertiaOptions=t||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Vre{constructor(t,r,c){this._pitchWithRotate=t.pitchWithRotate,this._mouseRotate=r,this._mousePitch=c}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class Gre{constructor(t,r,c,u){this._el=t,this._touchZoom=r,this._touchRotate=c,this._tapDragZoom=u,this._rotationDisabled=!1,this._enabled=!0}enable(t){this._touchZoom.enable(t),this._rotationDisabled||this._touchRotate.enable(t),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const Z3=a=>a.zoom||a.drag||a.pitch||a.rotate;class Hre extends $t{}class jre{constructor(){this.constants=[1,1,.01],this.radius=0}setup(t,r){const c=ke.sub([],r,t);this.radius=ke.length(c[2]<0?ke.div([],c,this.constants):[c[0],c[1],0])}projectRay(t){ke.div(t,t,this.constants),ke.normalize(t,t),ke.mul(t,t,this.constants);const r=ke.scale([],t,this.radius);if(r[2]>0){const c=ke.scale([],[0,0,1],ke.dot(r,[0,0,1])),u=ke.scale([],ke.normalize([],[r[0],r[1],0]),this.radius),h=ke.add([],r,ke.scale([],ke.sub([],ke.add([],u,c),r),2));r[0]=h[0],r[1]=h[1]}return r}}function K3(a){return a.panDelta&&a.panDelta.mag()||a.zoomDelta||a.bearingDelta||a.pitchDelta}class $re{constructor(t,r){this._map=t,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new xre(t),this._bearingSnap=r.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new jre,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(r),ft(["handleEvent","handleWindowEvent"],this);const c=this._el;this._listeners=[[c,"touchstart",{passive:!0}],[c,"touchmove",{passive:!1}],[c,"touchend",void 0],[c,"touchcancel",void 0],[c,"mousedown",void 0],[c,"mousemove",void 0],[c,"mouseup",void 0],[f.document,"mousemove",{capture:!0}],[f.document,"mouseup",void 0],[c,"mouseover",void 0],[c,"mouseout",void 0],[c,"dblclick",void 0],[c,"click",void 0],[c,"keydown",{capture:!1}],[c,"keyup",void 0],[c,"wheel",{passive:!1}],[c,"contextmenu",void 0],[f,"blur",void 0]];for(const[u,h,m]of this._listeners)u.addEventListener(h,u===f.document?this.handleWindowEvent:this.handleEvent,m)}destroy(){for(const[t,r,c]of this._listeners)t.removeEventListener(r,t===f.document?this.handleWindowEvent:this.handleEvent,c)}_addDefaultHandlers(t){const r=this._map,c=r.getCanvasContainer();this._add("mapEvent",new Sre(r,t));const u=r.boxZoom=new Ere(r,t);this._add("boxZoom",u);const h=new Tre,m=new Bre;r.doubleClickZoom=new Fre(m,h),this._add("tapZoom",h),this._add("clickZoom",m);const g=new Ure;this._add("tapDragZoom",g);const v=r.touchPitch=new kre(r);this._add("touchPitch",v);const b=new l9(t),w=new c9(t);r.dragRotate=new Vre(t,b,w),this._add("mouseRotate",b,["mousePitch"]),this._add("mousePitch",w,["mouseRotate"]);const A=new Pre(t),C=new Ire(r,t);r.dragPan=new Wre(c,A,C),this._add("mousePan",A),this._add("touchPan",C,["touchZoom","touchRotate"]);const P=new Rre,k=new Lre;r.touchZoomRotate=new Gre(c,k,P,g),this._add("touchRotate",P,["touchPan","touchZoom"]),this._add("touchZoom",k,["touchPan","touchRotate"]),this._add("blockableMapEvent",new Are(r));const z=r.scrollZoom=new zre(r,this);this._add("scrollZoom",z,["mousePan"]);const U=r.keyboard=new Ore;this._add("keyboard",U);for(const W of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])t.interactive&&t[W]&&r[W].enable(t[W])}_add(t,r,c){this._handlers.push({handlerName:t,handler:r,allowed:c}),this._handlersById[t]=r}stop(t){if(!this._updatingCamera){for(const{handler:r}of this._handlers)r.reset();this._inertia.clear(),this._fireEvents({},{},t),this._changes=[],this._originalZoom=void 0}}isActive(){for(const{handler:t}of this._handlers)if(t.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Z3(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(t,r,c){for(const u in t)if(u!==c&&(!r||r.indexOf(u)<0))return!0;return!1}handleWindowEvent(t){this.handleEvent(t,`${t.type}Window`)}_getMapTouches(t){const r=[];for(const c of t)this._el.contains(c.target)&&r.push(c);return r}handleEvent(t,r){this._updatingCamera=!0;const c=t.type==="renderFrame",u=c?void 0:t,h={needsRenderFrame:!1},m={},g={},v=t.touches?this._getMapTouches(t.touches):void 0,b=v?Pd(this._el,v):c?void 0:Il(this._el,t);for(const{handlerName:C,handler:P,allowed:k}of this._handlers){if(!P.isEnabled())continue;let z;this._blockedByActive(g,k,C)?P.reset():P[r||t.type]&&(z=P[r||t.type](t,b,v),this.mergeHandlerResult(h,m,z,C,u),z&&z.needsRenderFrame&&this._triggerRenderFrame()),(z||P.isActive())&&(g[C]=P)}const w={};for(const C in this._previousActiveHandlers)g[C]||(w[C]=u);this._previousActiveHandlers=g,(Object.keys(w).length||K3(h))&&(this._changes.push([h,m,w]),this._triggerRenderFrame()),(Object.keys(g).length||K3(h))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:A}=h;A&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],A(this._map))}mergeHandlerResult(t,r,c,u,h){if(!c)return;Fe(t,c);const m={handlerName:u,originalEvent:c.originalEvent||h};c.zoomDelta!==void 0&&(r.zoom=m),c.panDelta!==void 0&&(r.drag=m),c.pitchDelta!==void 0&&(r.pitch=m),c.bearingDelta!==void 0&&(r.rotate=m)}_applyChanges(){const t={},r={},c={};for(const[u,h,m]of this._changes)u.panDelta&&(t.panDelta=(t.panDelta||new V(0,0))._add(u.panDelta)),u.zoomDelta&&(t.zoomDelta=(t.zoomDelta||0)+u.zoomDelta),u.bearingDelta&&(t.bearingDelta=(t.bearingDelta||0)+u.bearingDelta),u.pitchDelta&&(t.pitchDelta=(t.pitchDelta||0)+u.pitchDelta),u.around!==void 0&&(t.around=u.around),u.aroundCoord!==void 0&&(t.aroundCoord=u.aroundCoord),u.pinchAround!==void 0&&(t.pinchAround=u.pinchAround),u.noInertia&&(t.noInertia=u.noInertia),Fe(r,h),Fe(c,m);this._updateMapTransform(t,r,c),this._changes=[]}_updateMapTransform(t,r,c){const u=this._map,h=u.transform,m=$=>[$.x,$.y,$.z];if(($=>{const Z=this._eventsInProgress.drag;return Z&&!this._handlersById[Z.handlerName].isActive()})()&&!K3(t)){const $=h.zoom;h.cameraElevationReference="sea",this._originalZoom!=null&&h._orthographicProjectionAtLowPitch&&h.projection.name!=="globe"&&h.pitch===0?(h.cameraElevationReference="ground",h.zoom=this._originalZoom):(h.recenterOnTerrain(),h.cameraElevationReference="ground"),$!==h.zoom&&this._map._update(!0)}if(h._isCameraConstrained&&u._stop(!0),!K3(t))return void this._fireEvents(r,c,!0);let{panDelta:g,zoomDelta:v,bearingDelta:b,pitchDelta:w,around:A,aroundCoord:C,pinchAround:P}=t;h._isCameraConstrained&&(v>0&&(v=0),h._isCameraConstrained=!1),P!==void 0&&(A=P),(v||($=>r[$]&&!this._eventsInProgress[$])("drag"))&&A&&(this._dragOrigin=m(h.pointCoordinate3D(A)),this._originalZoom=h.zoom,this._trackingEllipsoid.setup(h._camera.position,this._dragOrigin)),h.cameraElevationReference="sea",u._stop(!0),A=A||u.transform.centerPoint,b&&(h.bearing+=b),w&&(h.pitch+=w),h._updateCameraState();const k=[0,0,0];if(g)if(h.projection.name==="mercator"){const $=this._trackingEllipsoid.projectRay(h.screenPointToMercatorRay(A).dir),Z=this._trackingEllipsoid.projectRay(h.screenPointToMercatorRay(A.sub(g)).dir);k[0]=Z[0]-$[0],k[1]=Z[1]-$[1]}else{const $=h.pointCoordinate(A);if(h.projection.name==="globe"){g=g.rotate(-h.angle);const Z=h._pixelsPerMercatorPixel/h.worldSize;k[0]=-g.x*rP(yr($.y))*Z,k[1]=-g.y*rP(h.center.lat)*Z}else{const Z=h.pointCoordinate(A.sub(g));$&&Z&&(k[0]=Z.x-$.x,k[1]=Z.y-$.y)}}const z=h.zoom,U=[0,0,0];if(v){const $=m(C||h.pointCoordinate3D(A)),Z={dir:ke.normalize([],ke.sub([],$,h._camera.position))};if(Z.dir[2]<0){const K=h.zoomDeltaToMovement($,v);ke.scale(U,Z.dir,K)}}const W=ke.add(k,k,U);h._translateCameraConstrained(W),v&&Math.abs(h.zoom-z)>1e-4&&h.recenterOnTerrain(),h.cameraElevationReference="ground",this._map._update(),t.noInertia||this._inertia.record(t),this._fireEvents(r,c,!0)}_fireEvents(t,r,c){const u=Z3(this._eventsInProgress),h=Z3(t),m={};for(const w in t){const{originalEvent:A}=t[w];this._eventsInProgress[w]||(m[`${w}start`]=A),this._eventsInProgress[w]=t[w]}!u&&h&&this._fireEvent("movestart",h.originalEvent);for(const w in m)this._fireEvent(w,m[w]);h&&this._fireEvent("move",h.originalEvent);for(const w in t){const{originalEvent:A}=t[w];this._fireEvent(w,A)}const g={};let v;for(const w in this._eventsInProgress){const{handlerName:A,originalEvent:C}=this._eventsInProgress[w];this._handlersById[A].isActive()||(delete this._eventsInProgress[w],v=r[A]||C,g[`${w}end`]=v)}for(const w in g)this._fireEvent(w,g[w]);const b=Z3(this._eventsInProgress);if(c&&(u||h)&&!b){this._updatingCamera=!0;const w=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),A=C=>C!==0&&-this._bearingSnap<C&&C<this._bearingSnap;w?(A(w.bearing||this._map.getBearing())&&(w.bearing=0),this._map.easeTo(w,{originalEvent:v})):(this._map.fire(new $t("moveend",{originalEvent:v})),A(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(t,r){this._map.fire(new $t(t,r?{originalEvent:r}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(t=>{this._frameId=void 0,this.handleEvent(new Hre("renderFrame",{timeStamp:t})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const p9="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class Yre extends Un{constructor(t,r){super(),this._moving=!1,this._zooming=!1,this.transform=t,this._bearingSnap=r.bearingSnap,this._respectPrefersReducedMotion=r.respectPrefersReducedMotion!==!1,ft(["_renderFrameCallback"],this)}getCenter(){return new On(this.transform.center.lng,this.transform.center.lat)}setCenter(t,r){return this.jumpTo({center:t},r)}panBy(t,r,c){return t=V.convert(t).mult(-1),this.panTo(this.transform.center,Fe({offset:t},r),c)}panTo(t,r,c){return this.easeTo(Fe({center:t},r),c)}getZoom(){return this.transform.zoom}setZoom(t,r){return this.jumpTo({zoom:t},r),this}zoomTo(t,r,c){return this.easeTo(Fe({zoom:t},r),c)}zoomIn(t,r){return this.zoomTo(this.getZoom()+1,t,r),this}zoomOut(t,r){return this.zoomTo(this.getZoom()-1,t,r),this}getBearing(){return this.transform.bearing}setBearing(t,r){return this.jumpTo({bearing:t},r),this}getPadding(){return this.transform.padding}setPadding(t,r){return this.jumpTo({padding:t},r),this}rotateTo(t,r,c){return this.easeTo(Fe({bearing:t},r),c)}resetNorth(t,r){return this.rotateTo(0,Fe({duration:1e3},t),r),this}resetNorthPitch(t,r){return this.easeTo(Fe({bearing:0,pitch:0,duration:1e3},t),r),this}snapToNorth(t,r){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(t,r):this}getPitch(){return this.transform.pitch}setPitch(t,r){return this.jumpTo({pitch:t},r),this}cameraForBounds(t,r){t=Ol.convert(t);const c=r&&r.bearing||0,u=r&&r.pitch||0,h=t.getNorthWest(),m=t.getSouthEast();return this._cameraForBounds(this.transform,h,m,c,u,r)}_extendCameraOptions(t){const r={top:0,bottom:0,right:0,left:0};if(typeof(t=Fe({padding:r,offset:[0,0],maxZoom:this.transform.maxZoom},t)).padding=="number"){const c=t.padding;t.padding={top:c,bottom:c,right:c,left:c}}return t.padding=Fe(r,t.padding),t}_minimumAABBFrustumDistance(t,r){const c=r.max[0]-r.min[0],u=r.max[1]-r.min[1];return c/u>t.aspect?c/(2*Math.tan(.5*t.fovX)*t.aspect):u/(2*Math.tan(.5*t.fovY)*t.aspect)}_cameraForBoundsOnGlobe(t,r,c,u,h,m){const g=t.clone(),v=this._extendCameraOptions(m);g.bearing=u,g.pitch=h;const b=On.convert(r),w=On.convert(c),A=.5*(b.lat+w.lat),C=.5*(b.lng+w.lng),P=zs(A,C),k=ke.normalize([],P),z=ke.normalize([],ke.cross([],k,[0,1,0])),U=ke.cross([],z,k),W=[z[0],z[1],z[2],0,U[0],U[1],U[2],0,k[0],k[1],k[2],0,0,0,0,1],$=[P,zs(b.lat,b.lng),zs(w.lat,b.lng),zs(w.lat,w.lng),zs(b.lat,w.lng),zs(A,b.lng),zs(A,w.lng),zs(b.lat,C),zs(w.lat,C)];let Z=ga.fromPoints($.map(Ge=>[ke.dot(z,Ge),ke.dot(U,Ge),ke.dot(k,Ge)]));const K=ke.transformMat4([],Z.center,W);ke.squaredLength(K)===0&&ke.set(K,0,0,1),ke.normalize(K,K),ke.scale(K,K,cs),g.center=function([Ge,ot,yt]){const pt=Math.hypot(Ge,ot,yt),Rt=Math.atan2(Ge,yt),Ft=.5*Math.PI-Math.acos(-ot/pt);return new On(pe(Rt),pe(Ft))}(K);const q=g.getWorldToCameraMatrix(),J=rt.invert(new Float64Array(16),q);Z=ga.applyTransform(Z,rt.multiply([],q,W)),ke.transformMat4(K,K,q);const re=.5*(Z.max[2]-Z.min[2]),ce=this._minimumAABBFrustumDistance(g,Z),ge=ke.scale([],[0,0,1],re),ve=ke.add(ge,K,ge),Ce=ce+(g.pitch===0?0:ke.distance(K,ve)),Ae=g.globeCenterInViewSpace,Le=ke.sub([],K,[Ae[0],Ae[1],Ae[2]]);ke.normalize(Le,Le),ke.scale(Le,Le,Ce);const Se=ke.add([],K,Le);ke.transformMat4(Se,Se,J);const Ve=sv/cs,Xe=ke.length(Se),nt=$i(Math.max(Xe*Ve-sv,Number.EPSILON),0),We=Math.min(g.zoomFromMercatorZAdjusted(nt),v.maxZoom);return We>.5*(d1+bp)?(g.setProjection({name:"mercator"}),g.zoom=We,this._cameraForBounds(g,r,c,u,h,m)):{center:g.center,zoom:We,bearing:u,pitch:h}}queryTerrainElevation(t,r){const c=this.transform.elevation;return c?(r=Fe({},{exaggerated:!0},r),c.getAtPoint(vi.fromLngLat(t),null,r.exaggerated)):null}_cameraForBounds(t,r,c,u,h,m){if(t.projection.name==="globe")return this._cameraForBoundsOnGlobe(t,r,c,u,h,m);const g=t.clone(),v=this._extendCameraOptions(m),b=g.padding;g.bearing=u,g.pitch=h;const w=On.convert(r),A=On.convert(c),C=new On(w.lng,A.lat),P=new On(A.lng,w.lat),k=g.project(w),z=g.project(A),U=this.queryTerrainElevation(w),W=this.queryTerrainElevation(A),$=this.queryTerrainElevation(C),Z=this.queryTerrainElevation(P),K=[[k.x,k.y,Math.min(U||0,W||0,$||0,Z||0)],[z.x,z.y,Math.max(U||0,W||0,$||0,Z||0)]];let q=ga.fromPoints(K);const J=g.getWorldToCameraMatrix(),re=rt.invert(new Float64Array(16),J);q=ga.applyTransform(q,J);const ce=ke.sub([],q.max,q.min),ge=b.left||0,ve=b.right||0,Ce=b.bottom||0,Ae=b.top||0,{left:Le,right:Se,top:Ve,bottom:Xe}=v.padding,nt=.5*(ge+ve),We=.5*(Ae+Ce),Ge=Math.min(g.scaleZoom(g.scale*Math.min((g.width-(ge+ve+Le+Se))/ce[0],(g.height-(Ce+Ae+Xe+Ve))/ce[1])),v.maxZoom),ot=g.scale/g.zoomScale(Ge);q=new ga([q.min[0]-(Le+nt)*ot,q.min[1]-(Xe+We)*ot,q.min[2]],[q.max[0]+(Se+nt)*ot,q.max[1]+(Ve+We)*ot,q.max[2]]);const yt=.5*ce[2],pt=this._minimumAABBFrustumDistance(g,q),Rt=[0,0,1,0];Hi.transformMat4(Rt,Rt,J),Hi.normalize(Rt,Rt);const Ft=ke.scale([],Rt,pt+yt),St=ke.add([],q.center,Ft),Tt=(typeof v.offset.x=="number"&&typeof v.offset.y=="number"?new V(v.offset.x,v.offset.y):V.convert(v.offset)).rotate(-ye(u));q.center[0]-=Tt.x*ot,q.center[1]+=Tt.y*ot,ke.transformMat4(q.center,q.center,re),ke.transformMat4(St,St,re);const nn=[q.center[0],q.center[1],St[2]*g.pixelsPerMeter];ke.scale(nn,nn,1/g.worldSize);const sn=sl(nn[0]),on=yr(nn[1]),cn=Math.min(g._zoomFromMercatorZ(nn[2]),v.maxZoom),yn=new On(sn,on);return g.mercatorFromTransition&&cn<.5*(d1+bp)?(g.setProjection({name:"globe"}),g.zoom=cn,this._cameraForBounds(g,r,c,u,h,m)):{center:yn,zoom:cn,bearing:u,pitch:h}}fitBounds(t,r,c){const u=this.cameraForBounds(t,r);return this._fitInternal(u,r,c)}fitScreenCoordinates(t,r,c,u,h){const m=V.convert(t),g=V.convert(r),v=new V(Math.min(m.x,g.x),Math.min(m.y,g.y)),b=new V(Math.max(m.x,g.x),Math.max(m.y,g.y));if(this.transform.projection.name==="mercator"&&this.transform.anyCornerOffEdge(m,g))return this;const w=this.transform.pointLocation3D(v),A=this.transform.pointLocation3D(b),C=this.transform.pointLocation3D(new V(v.x,b.y)),P=this.transform.pointLocation3D(new V(b.x,v.y)),k=[Math.min(w.lng,A.lng,C.lng,P.lng),Math.min(w.lat,A.lat,C.lat,P.lat)],z=[Math.max(w.lng,A.lng,C.lng,P.lng),Math.max(w.lat,A.lat,C.lat,P.lat)],U=u&&u.pitch?u.pitch:this.getPitch(),W=this._cameraForBounds(this.transform,k,z,c,U,u);return this._fitInternal(W,u,h)}_fitInternal(t,r,c){return t?(delete(r=Fe(t,r)).padding,r.linear?this.easeTo(r,c):this.flyTo(r,c)):this}jumpTo(t,r){this.stop();const c=t.preloadOnly?this.transform.clone():this.transform;let u=!1,h=!1,m=!1;return"zoom"in t&&c.zoom!==+t.zoom&&(u=!0,c.zoom=+t.zoom),t.center!==void 0&&(c.center=On.convert(t.center)),"bearing"in t&&c.bearing!==+t.bearing&&(h=!0,c.bearing=+t.bearing),"pitch"in t&&c.pitch!==+t.pitch&&(m=!0,c.pitch=+t.pitch),t.padding==null||c.isPaddingEqual(t.padding)||(c.padding=t.padding),t.preloadOnly?(this._preloadTiles(c),this):(this.fire(new $t("movestart",r)).fire(new $t("move",r)),u&&this.fire(new $t("zoomstart",r)).fire(new $t("zoom",r)).fire(new $t("zoomend",r)),h&&this.fire(new $t("rotatestart",r)).fire(new $t("rotate",r)).fire(new $t("rotateend",r)),m&&this.fire(new $t("pitchstart",r)).fire(new $t("pitch",r)).fire(new $t("pitchend",r)),this.fire(new $t("moveend",r)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||_e(p9),this.transform.getFreeCameraOptions()}setFreeCameraOptions(t,r){const c=this.transform;if(!c.projection.supportsFreeCamera)return _e(p9),this;this.stop();const u=c.zoom,h=c.pitch,m=c.bearing;c.setFreeCameraOptions(t);const g=u!==c.zoom,v=h!==c.pitch,b=m!==c.bearing;return this.fire(new $t("movestart",r)).fire(new $t("move",r)),g&&this.fire(new $t("zoomstart",r)).fire(new $t("zoom",r)).fire(new $t("zoomend",r)),b&&this.fire(new $t("rotatestart",r)).fire(new $t("rotate",r)).fire(new $t("rotateend",r)),v&&this.fire(new $t("pitchstart",r)).fire(new $t("pitch",r)).fire(new $t("pitchend",r)),this.fire(new $t("moveend",r)),this}easeTo(t,r){this._stop(!1,t.easeId),((t=Fe({offset:[0,0],duration:500,easing:xe},t)).animate===!1||this._prefersReducedMotion(t))&&(t.duration=0);const c=this.transform,u=this.getZoom(),h=this.getBearing(),m=this.getPitch(),g=this.getPadding(),v="zoom"in t?+t.zoom:u,b="bearing"in t?this._normalizeBearing(t.bearing,h):h,w="pitch"in t?+t.pitch:m,A="padding"in t?t.padding:c.padding,C=V.convert(t.offset);let P,k,z;if(c.projection.name==="globe"){const ge=vi.fromLngLat(c.center),ve=C.rotate(-c.angle);ge.x+=ve.x/c.worldSize,ge.y+=ve.y/c.worldSize;const Ce=ge.toLngLat(),Ae=On.convert(t.center||Ce);this._normalizeCenter(Ae),P=c.centerPoint.add(ve),k=new V(ge.x,ge.y).mult(c.worldSize),z=new V(vo(Ae.lng),Co(Ae.lat)).mult(c.worldSize).sub(k)}else{P=c.centerPoint.add(C);const ge=c.pointLocation(P),ve=On.convert(t.center||ge);this._normalizeCenter(ve),k=c.project(ge),z=c.project(ve).sub(k)}const U=c.zoomScale(v-u);let W,$;t.around&&(W=On.convert(t.around),$=c.locationPoint(W));const Z=this._zooming||v!==u,K=this._rotating||h!==b,q=this._pitching||w!==m,J=!c.isPaddingEqual(A),re=ge=>ve=>{if(Z&&(ge.zoom=Ln(u,v,ve)),K&&(ge.bearing=Ln(h,b,ve)),q&&(ge.pitch=Ln(m,w,ve)),J&&(ge.interpolatePadding(g,A,ve),P=ge.centerPoint.add(C)),W)ge.setLocationAtPoint(W,$);else{const Ce=ge.zoomScale(ge.zoom-u),Ae=v>u?Math.min(2,U):Math.max(.5,U),Le=Math.pow(Ae,1-ve),Se=ge.unproject(k.add(z.mult(ve*Le)).mult(Ce));ge.setLocationAtPoint(ge.renderWorldCopies?Se.wrap():Se,P)}return t.preloadOnly||this._fireMoveEvents(r),ge};if(t.preloadOnly){const ge=this._emulate(re,t.duration,c);return this._preloadTiles(ge),this}const ce={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=Z,this._rotating=K,this._pitching=q,this._padding=J,this._easeId=t.easeId,this._prepareEase(r,t.noMoveStart,ce),this._ease(re(c),ge=>{c.cameraElevationReference==="sea"&&c.recenterOnTerrain(),this._afterEase(r,ge)},t),this}_prepareEase(t,r,c={}){this._moving=!0,this.transform.cameraElevationReference="sea",this.transform._orthographicProjectionAtLowPitch&&this.transform.pitch===0&&this.transform.projection.name!=="globe"&&(this.transform.cameraElevationReference="ground"),r||c.moving||this.fire(new $t("movestart",t)),this._zooming&&!c.zooming&&this.fire(new $t("zoomstart",t)),this._rotating&&!c.rotating&&this.fire(new $t("rotatestart",t)),this._pitching&&!c.pitching&&this.fire(new $t("pitchstart",t))}_fireMoveEvents(t){this.fire(new $t("move",t)),this._zooming&&this.fire(new $t("zoom",t)),this._rotating&&this.fire(new $t("rotate",t)),this._pitching&&this.fire(new $t("pitch",t))}_afterEase(t,r){if(this._easeId&&r&&this._easeId===r)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const c=this._zooming,u=this._rotating,h=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,c&&this.fire(new $t("zoomend",t)),u&&this.fire(new $t("rotateend",t)),h&&this.fire(new $t("pitchend",t)),this.fire(new $t("moveend",t))}flyTo(t,r){if(this._prefersReducedMotion(t)){const Ge=ct(t,["center","zoom","bearing","pitch","around"]);return this.jumpTo(Ge,r)}this.stop(),t=Fe({offset:[0,0],speed:1.2,curve:1.42,easing:xe},t);const c=this.transform,u=this.getZoom(),h=this.getBearing(),m=this.getPitch(),g=this.getPadding(),v="zoom"in t?ae(+t.zoom,c.minZoom,c.maxZoom):u,b="bearing"in t?this._normalizeBearing(t.bearing,h):h,w="pitch"in t?+t.pitch:m,A="padding"in t?t.padding:c.padding,C=c.zoomScale(v-u),P=V.convert(t.offset);let k=c.centerPoint.add(P);const z=c.pointLocation(k),U=On.convert(t.center||z);this._normalizeCenter(U);const W=c.project(z),$=c.project(U).sub(W);let Z=t.curve;const K=Math.max(c.width,c.height),q=K/C,J=$.mag();if("minZoom"in t){const Ge=ae(Math.min(t.minZoom,u,v),c.minZoom,c.maxZoom),ot=K/c.zoomScale(Ge-u);Z=Math.sqrt(ot/J*2)}const re=Z*Z;function ce(Ge){const ot=(q*q-K*K+(Ge?-1:1)*re*re*J*J)/(2*(Ge?q:K)*re*J);return Math.log(Math.sqrt(ot*ot+1)-ot)}function ge(Ge){return(Math.exp(Ge)-Math.exp(-Ge))/2}function ve(Ge){return(Math.exp(Ge)+Math.exp(-Ge))/2}const Ce=ce(0);let Ae=function(Ge){return ve(Ce)/ve(Ce+Z*Ge)},Le=function(Ge){return K*((ve(Ce)*(ge(ot=Ce+Z*Ge)/ve(ot))-ge(Ce))/re)/J;var ot},Se=(ce(1)-Ce)/Z;if(Math.abs(J)<1e-6||!isFinite(Se)){if(Math.abs(K-q)<1e-6)return this.easeTo(t,r);const Ge=q<K?-1:1;Se=Math.abs(Math.log(q/K))/Z,Le=function(){return 0},Ae=function(ot){return Math.exp(Ge*Z*ot)}}t.duration="duration"in t?+t.duration:1e3*Se/("screenSpeed"in t?+t.screenSpeed/Z:+t.speed),t.maxDuration&&t.duration>t.maxDuration&&(t.duration=0);const Ve=h!==b,Xe=w!==m,nt=!c.isPaddingEqual(A),We=Ge=>ot=>{const yt=ot*Se,pt=1/Ae(yt);Ge.zoom=ot===1?v:u+Ge.scaleZoom(pt),Ve&&(Ge.bearing=Ln(h,b,ot)),Xe&&(Ge.pitch=Ln(m,w,ot)),nt&&(Ge.interpolatePadding(g,A,ot),k=Ge.centerPoint.add(P));const Rt=ot===1?U:Ge.unproject(W.add($.mult(Le(yt))).mult(pt));return Ge.setLocationAtPoint(Ge.renderWorldCopies?Rt.wrap():Rt,k),Ge._updateCameraOnTerrain(),t.preloadOnly||this._fireMoveEvents(r),Ge};if(t.preloadOnly){const Ge=this._emulate(We,t.duration,c);return this._preloadTiles(Ge),this}return this._zooming=!0,this._rotating=Ve,this._pitching=Xe,this._padding=nt,this._prepareEase(r,!1),this._ease(We(c),()=>this._afterEase(r),t),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(t,r){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const c=this._onEaseEnd;this._onEaseEnd=void 0,c.call(this,r)}if(!t){const c=this.handlers;c&&c.stop(!1)}return this}_ease(t,r,c){c.animate===!1||c.duration===0?(t(1),r()):(this._easeStart=Cn.now(),this._easeOptions=c,this._onEaseFrame=t,this._onEaseEnd=r,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const t=Math.min((Cn.now()-this._easeStart)/this._easeOptions.duration,1),r=this._onEaseFrame;r&&r(this._easeOptions.easing(t)),t<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(t,r){t=Je(t,-180,180);const c=Math.abs(t-r);return Math.abs(t-360-r)<c&&(t-=360),Math.abs(t+360-r)<c&&(t+=360),t}_normalizeCenter(t){const r=this.transform;if(!r.renderWorldCopies||r.maxBounds)return;const c=t.lng-r.center.lng;t.lng+=c>180?-360:c<-180?360:0}_prefersReducedMotion(t){return this._respectPrefersReducedMotion&&Cn.prefersReducedMotion&&!(t&&t.essential)}_emulate(t,r,c){const u=Math.ceil(15*r/1e3),h=[],m=t(c.clone());for(let g=0;g<=u;g++){const v=m(g/u);h.push(v.clone())}return h}}class f9{constructor(t={}){this.options=t,ft(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(t){const r=this.options&&this.options.compact;return this._map=t,this._container=Jn("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=Jn("button","mapboxgl-ctrl-attrib-button",this._container),Jn("span","mapboxgl-ctrl-icon",this._compactButton).setAttribute("aria-hidden","true"),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=Jn("div","mapboxgl-ctrl-attrib-inner",this._container),r&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),r===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(t,r){const c=this._map._getUIString(`AttributionControl.${r}`);t.setAttribute("aria-label",c),t.removeAttribute("title"),t.firstElementChild&&t.firstElementChild.setAttribute("title",c)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let t=this._editLink;t||(t=this._editLink=this._container.querySelector(".mapbox-improve-map"));const r=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||x.ACCESS_TOKEN}];if(t){const c=r.reduce((u,h,m)=>(h.value&&(u+=`${h.key}=${h.value}${m<r.length-1?"&":""}`),u),"?");t.href=`${x.FEEDBACK_URL}/${c}#${s9(this._map,!0)}`,t.rel="noopener nofollow",this._setElementTitle(t,"MapFeedback")}}_updateData(t){!t||t.sourceDataType!=="metadata"&&t.sourceDataType!=="visibility"&&t.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let t=[];if(this._map.style.stylesheet){const u=this._map.style.stylesheet;this.styleOwner=u.owner,this.styleId=u.id}const r=this._map.style._sourceCaches;for(const u in r){const h=r[u];if(h.used){const m=h.getSource();m.attribution&&t.indexOf(m.attribution)<0&&t.push(m.attribution)}}t.sort((u,h)=>u.length-h.length),t=t.filter((u,h)=>{for(let m=h+1;m<t.length;m++)if(t[m].indexOf(u)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?t=[...this.options.customAttribution,...t]:t.unshift(this.options.customAttribution));const c=t.join(" | ");c!==this._attribHTML&&(this._attribHTML=c,t.length?(this._innerContainer.innerHTML=c,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class m9{constructor(){ft(["_updateLogo","_updateCompact"],this)}onAdd(t){this._map=t,this._container=Jn("div","mapboxgl-ctrl");const r=Jn("a","mapboxgl-ctrl-logo");return r.target="_blank",r.rel="noopener nofollow",r.href="https://www.mapbox.com/",r.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),r.setAttribute("rel","noopener nofollow"),this._container.appendChild(r),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(t){t&&t.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const t=this._map.style._sourceCaches;if(Object.entries(t).length===0)return!0;for(const r in t){const c=t[r].getSource();if(c.hasOwnProperty("mapbox_logo")&&!c.mapbox_logo)return!1}return!0}_updateCompact(){const t=this._container.children;if(t.length){const r=t[0];this._map.getCanvasContainer().offsetWidth<250?r.classList.add("mapboxgl-compact"):r.classList.remove("mapboxgl-compact")}}}class g9{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(t){const r=++this._id;return this._queue.push({callback:t,id:r,cancelled:!1}),r}remove(t){const r=this._currentlyRunning,c=r?this._queue.concat(r):this._queue;for(const u of c)if(u.id===t)return void(u.cancelled=!0)}run(t=0){const r=this._currentlyRunning=this._queue;this._queue=[];for(const c of r)if(!c.cancelled&&(c.callback(t),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function y9(a,t,r){if(a=new On(a.lng,a.lat),t){const c=new On(a.lng-360,a.lat),u=new On(a.lng+360,a.lat),h=360*Math.ceil(Math.abs(a.lng-r.center.lng)/360),m=r.locationPoint(a).distSqr(t),g=t.x<0||t.y<0||t.x>r.width||t.y>r.height;r.locationPoint(c).distSqr(t)<m&&(g||Math.abs(c.lng-r.center.lng)<h)?a=c:r.locationPoint(u).distSqr(t)<m&&(g||Math.abs(u.lng-r.center.lng)<h)&&(a=u)}for(;Math.abs(a.lng-r.center.lng)>180;){const c=r.locationPoint(a);if(c.x>=0&&c.y>=0&&c.x<=r.width&&c.y<=r.height)break;a.lng>r.center.lng?a.lng-=360:a.lng+=360}return a}const L5={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class R5 extends Un{constructor(t,r){if(super(),(t instanceof f.HTMLElement||r)&&(t=Fe({element:t},r)),ft(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=t&&t.anchor||"center",this._color=t&&t.color||"#3FB1CE",this._scale=t&&t.scale||1,this._draggable=t&&t.draggable||!1,this._clickTolerance=t&&t.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=t&&t.rotation||0,this._rotationAlignment=t&&t.rotationAlignment||"auto",this._pitchAlignment=t&&t.pitchAlignment&&t.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=t&&t.occludedOpacity||.2,t&&t.element)this._element=t.element,this._offset=V.convert(t&&t.offset||[0,0]);else{this._defaultMarker=!0,this._element=Jn("div");const h=41,m=27,g=ja("svg",{display:"block",height:h*this._scale+"px",width:m*this._scale+"px",viewBox:`0 0 ${m} ${h}`},this._element),v=ja("radialGradient",{id:"shadowGradient"},ja("defs",{},g));ja("stop",{offset:"10%","stop-opacity":.4},v),ja("stop",{offset:"100%","stop-opacity":.05},v),ja("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},g),ja("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},g),ja("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},g),ja("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},g),this._offset=V.convert(t&&t.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.hasAttribute("role")||this._element.setAttribute("role","img"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",h=>{h.preventDefault()}),this._element.addEventListener("mousedown",h=>{h.preventDefault()});const c=this._element.classList;for(const h in L5)c.remove(`mapboxgl-marker-anchor-${h}`);c.add(`mapboxgl-marker-anchor-${this._anchor}`);const u=t&&t.className?t.className.trim().split(/\s+/):[];c.add(...u),this._popup=null}addTo(t){return t===this._map||(this.remove(),this._map=t,t.getCanvasContainer().appendChild(this._element),t.on("move",this._updateMoving),t.on("moveend",this._update),t.on("remove",this._clearFadeTimer),t._addMarker(this),this.setDraggable(this._draggable),this._update(),t.on("click",this._onMapClick)),this}remove(){const t=this._map;return t&&(t.off("click",this._onMapClick),t.off("move",this._updateMoving),t.off("moveend",this._update),t.off("mousedown",this._addDragHandler),t.off("touchstart",this._addDragHandler),t.off("mouseup",this._onUp),t.off("touchend",this._onUp),t.off("mousemove",this._onMove),t.off("touchmove",this._onMove),t.off("remove",this._clearFadeTimer),t._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(t){return this._lngLat=On.convert(t),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(t){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),t){if(!("offset"in t.options)){const u=Math.sqrt(Math.pow(13.5,2)/2);t.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[u,-1*(38.1-13.5+u)],"bottom-right":[-u,-1*(38.1-13.5+u)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=t,t._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(t){const r=t.code,c=t.charCode||t.keyCode;r!=="Space"&&r!=="Enter"&&c!==32&&c!==13||this.togglePopup()}_onMapClick(t){const r=t.originalEvent.target,c=this._element;this._popup&&(r===c||c.contains(r))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const t=this._popup;return t?(t.isOpen()?(t.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(t.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const t=this._map,r=this._pos;if(!t||!r)return!1;const c=t.unproject(r),u=t.getFreeCameraOptions();if(!u.position)return!1;const h=u.position.toLngLat();return h.distanceTo(c)<.9*h.distanceTo(this._lngLat)}_evaluateOpacity(){const t=this._map;if(!t)return;const r=this._pos;if(!r||r.x<0||r.x>t.transform.width||r.y<0||r.y>t.transform.height)return void this._clearFadeTimer();const c=t.unproject(r);let u;t._showingGlobe()&&z2(t.transform,this._lngLat)?u=0:(u=1-t._queryFogOpacity(c),t.transform._terrainEnabled()&&t.getTerrain()&&this._behindTerrain()&&(u*=this._occludedOpacity)),this._element.style.opacity=`${u}`,this._element.style.pointerEvents=u>0?"auto":"none",this._popup&&this._popup._setOpacity(u),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const t=this._pos;if(!t||!this._map)return;const r=this._offset.mult(this._scale);this._element.style.transform=`
            translate(${t.x}px,${t.y}px)
            ${L5[this._anchor]}
            ${this._calculateXYTransform()} ${this._calculateZTransform()}
            translate(${r.x}px,${r.y}px)
        `}_calculateXYTransform(){const t=this._pos,r=this._map,c=this.getPitchAlignment();if(!r||!t||c!=="map")return"";if(!r._showingGlobe()){const v=r.getPitch();return v?`rotateX(${v}deg)`:""}const u=pe(iz(r.transform,this._lngLat)),h=t.sub(nz(r.transform)),m=Math.abs(h.x)+Math.abs(h.y);if(m===0)return"";const g=u/m;return`rotateX(${-h.y*g}deg) rotateY(${h.x*g}deg)`}_calculateZTransform(){const t=this._pos,r=this._map;if(!r||!t)return"";let c=0;const u=this.getRotationAlignment();if(u==="map")if(r._showingGlobe()){const h=r.project(new On(this._lngLat.lng,this._lngLat.lat+.001)),m=r.project(new On(this._lngLat.lng,this._lngLat.lat-.001)).sub(h);c=pe(Math.atan2(m.y,m.x))-90}else c=-r.getBearing();else if(u==="horizon"){const h=Ee(4,6,r.getZoom()),m=nz(r.transform);m.y+=h*r.transform.height;const g=t.sub(m),v=pe(Math.atan2(g.y,g.x));c=(v>90?v-270:v+90)*(1-h)}return c+=this._rotation,c?`rotateZ(${c}deg)`:""}_update(t){f.cancelAnimationFrame(this._updateFrameId);const r=this._map;r&&(r.transform.renderWorldCopies&&(this._lngLat=y9(this._lngLat,this._pos,r.transform)),this._pos=r.project(this._lngLat),t===!0?this._updateFrameId=f.requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),r._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(r._showingGlobe()||r.getTerrain()||r.getFog())&&!this._fadeTimer&&(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(t){return this._offset=V.convert(t),this._update(),this}addClassName(t){return this._element.classList.add(t),this}removeClassName(t){return this._element.classList.remove(t),this}toggleClassName(t){return this._element.classList.toggle(t)}_onMove(t){const r=this._map;if(!r)return;const c=this._pointerdownPos,u=this._positionDelta;if(c&&u){if(!this._isDragging){const h=this._clickTolerance||r._clickTolerance;if(t.point.dist(c)<h)return;this._isDragging=!0}this._pos=t.point.sub(u),this._lngLat=r.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new $t("dragstart"))),this.fire(new $t("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const t=this._map;t&&(t.off("mousemove",this._onMove),t.off("touchmove",this._onMove)),this._state==="active"&&this.fire(new $t("dragend")),this._state="inactive"}_addDragHandler(t){const r=this._map,c=this._pos;r&&c&&this._element.contains(t.originalEvent.target)&&(t.preventDefault(),this._positionDelta=t.point.sub(c),this._pointerdownPos=t.point,this._state="pending",r.on("mousemove",this._onMove),r.on("touchmove",this._onMove),r.once("mouseup",this._onUp),r.once("touchend",this._onUp))}setDraggable(t){this._draggable=!!t;const r=this._map;return r&&(t?(r.on("mousedown",this._addDragHandler),r.on("touchstart",this._addDragHandler)):(r.off("mousedown",this._addDragHandler),r.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(t){return this._rotation=t||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(t){return this._rotationAlignment=t||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment==="auto"||this._rotationAlignment==="horizon"&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(t){return this._pitchAlignment=t||"auto",this._update(),this}getPitchAlignment(){return this._pitchAlignment==="auto"?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(t){return this._occludedOpacity=t||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const qre={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},Xre=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function v9(a=new V(0,0),t="bottom"){if(typeof a=="number"){const r=Math.round(Math.sqrt(.5*Math.pow(a,2)));switch(t){case"top":return new V(0,a);case"top-left":return new V(r,r);case"top-right":return new V(-r,r);case"bottom":return new V(0,-a);case"bottom-left":return new V(r,-r);case"bottom-right":return new V(-r,-r);case"left":return new V(a,0);case"right":return new V(-a,0)}return new V(0,0)}return a instanceof V||Array.isArray(a)?V.convert(a):V.convert(a[t]||[0,0])}class Zre{constructor(t){this.jumpTo(t)}getValue(t){if(t<=this._startTime)return this._start;if(t>=this._endTime)return this._end;const r=Ie((t-this._startTime)/(this._endTime-this._startTime));return this._start*(1-r)+this._end*r}isEasing(t){return t>=this._startTime&&t<=this._endTime}jumpTo(t){this._startTime=-1/0,this._endTime=-1/0,this._start=t,this._end=t}easeTo(t,r,c){this._start=this.getValue(r),this._end=t,this._startTime=r,this._endTime=r+c}}const Kre={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use ⌘ + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},Jre={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,antialias:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0,collectResourceTiming:!1,testMode:!1},Qre={showCompass:!0,showZoom:!0,visualizePitch:!1};class eoe{constructor(t,r,c=!1){this._clickTolerance=10,this.element=r,this.mouseRotate=new l9({clickTolerance:t.dragRotate._mouseRotate._clickTolerance}),this.map=t,c&&(this.mousePitch=new c9({clickTolerance:t.dragRotate._mousePitch._clickTolerance})),ft(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),r.addEventListener("mousedown",this.mousedown),r.addEventListener("touchstart",this.touchstart,{passive:!1}),r.addEventListener("touchmove",this.touchmove),r.addEventListener("touchend",this.touchend),r.addEventListener("touchcancel",this.reset)}down(t,r){this.mouseRotate.mousedown(t,r),this.mousePitch&&this.mousePitch.mousedown(t,r),Nf()}move(t,r){const c=this.map,u=this.mouseRotate.mousemoveWindow(t,r),h=u&&u.bearingDelta;if(h&&c.setBearing(c.getBearing()+h),this.mousePitch){const m=this.mousePitch.mousemoveWindow(t,r),g=m&&m.pitchDelta;g&&c.setPitch(c.getPitch()+g)}}off(){const t=this.element;t.removeEventListener("mousedown",this.mousedown),t.removeEventListener("touchstart",this.touchstart,{passive:!1}),t.removeEventListener("touchmove",this.touchmove),t.removeEventListener("touchend",this.touchend),t.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){ic(),f.removeEventListener("mousemove",this.mousemove),f.removeEventListener("mouseup",this.mouseup)}mousedown(t){this.down(Fe({},t,{ctrlKey:!0,preventDefault:()=>t.preventDefault()}),Il(this.element,t)),f.addEventListener("mousemove",this.mousemove),f.addEventListener("mouseup",this.mouseup)}mousemove(t){this.move(t,Il(this.element,t))}mouseup(t){this.mouseRotate.mouseupWindow(t),this.mousePitch&&this.mousePitch.mouseupWindow(t),this.offTemp()}touchstart(t){t.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=Pd(this.element,t.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>t.preventDefault()},this._startPos))}touchmove(t){t.targetTouches.length!==1?this.reset():(this._lastPos=Pd(this.element,t.targetTouches)[0],this.move({preventDefault:()=>t.preventDefault()},this._lastPos))}touchend(t){t.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const toe={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},noe={maxWidth:100,unit:"metric"},ioe={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"},J3={version:y,supported:Di,setRTLTextPlugin:function(a,t,r=!1){if(Wr===Zy||Wr===Ky||Wr===Wc)throw new Error("setRTLTextPlugin cannot be called multiple times.");Vc=Cn.resolveURL(a),Wr=Zy,e1=t,t1(),r||A2()},getRTLTextPluginStatus:n1,Map:class extends Yre{constructor(a){if(Ka.mark(ia.create),(a=Fe({},Jre,a)).minZoom!=null&&a.maxZoom!=null&&a.minZoom>a.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(a.minPitch!=null&&a.maxPitch!=null&&a.minPitch>a.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(a.minPitch!=null&&a.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(a.maxPitch!=null&&a.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(a.antialias&&function(t){const r=t.navigator?t.navigator.userAgent:null;return!!function(c){if(ut==null){const u=c.navigator?c.navigator.userAgent:null;ut=!!c.safari||!(!u||!(/\b(iPad|iPhone|iPod)\b/.test(u)||u.match("Safari")&&!u.match("Chrome")))}return ut}(t)&&r&&(r.match("Version/15.4")||r.match("Version/15.5")||r.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))}(f)&&(a.antialias=!1,_e("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new $P(a.minZoom,a.maxZoom,a.minPitch,a.maxPitch,a.renderWorldCopies),a),this._interactive=a.interactive,this._minTileCacheSize=a.minTileCacheSize,this._maxTileCacheSize=a.maxTileCacheSize,this._failIfMajorPerformanceCaveat=a.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=a.preserveDrawingBuffer,this._antialias=a.antialias,this._trackResize=a.trackResize,this._bearingSnap=a.bearingSnap,this._refreshExpiredTiles=a.refreshExpiredTiles,this._fadeDuration=a.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=a.crossSourceCollisions,this._collectResourceTiming=a.collectResourceTiming,this._language=this._parseLanguage(a.language),this._worldview=a.worldview,this._renderTaskQueue=new g9,this._domRenderTaskQueue=new g9,this._controls=[],this._markers=[],this._popups=[],this._mapId=kt(),this._locale=Fe({},Kre,a.locale),this._clickTolerance=a.clickTolerance,this._cooperativeGestures=a.cooperativeGestures,this._performanceMetricsCollection=a.performanceMetricsCollection,this._containerWidth=0,this._containerHeight=0,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new Zre(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._requestManager=new en(a.transformRequest,a.accessToken,a.testMode),this._silenceAuthErrors=!!a.testMode,typeof a.container=="string"){if(this._container=f.document.getElementById(a.container),!this._container)throw new Error(`Container '${a.container.toString()}' not found.`)}else{if(!(a.container instanceof f.HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=a.container}if(this._container.childNodes.length>0&&_e("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),a.maxBounds&&this.setMaxBounds(a.maxBounds),ft(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");if(this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),f!==void 0&&(this._fullscreenchangeEvent="onfullscreenchange"in f.document?"fullscreenchange":"webkitfullscreenchange",f.addEventListener("online",this._onWindowOnline,!1),f.addEventListener("resize",this._onWindowResize,!1),f.addEventListener("orientationchange",this._onWindowResize,!1),f.addEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),f.addEventListener("visibilitychange",this._onVisibilityChange,!1)),this.handlers=new $re(this,a),this._localFontFamily=a.localFontFamily,this._localIdeographFontFamily=a.localIdeographFontFamily,(a.style||!a.testMode)&&this.setStyle(a.style||x.DEFAULT_STYLE,{localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),a.projection&&this.setProjection(a.projection),a.hash&&(this._hash=new gre(typeof a.hash=="string"&&a.hash||void 0).addTo(this)),!this._hash||!this._hash._onHashChange()){this.jumpTo({center:a.center,zoom:a.zoom,bearing:a.bearing,pitch:a.pitch});const t=a.bounds;t&&(this.resize(),this.fitBounds(t,Fe({},a.fitBoundsOptions,{duration:0})))}this.resize(),a.attributionControl&&this.addControl(new f9({customAttribution:a.customAttribution})),this._logoControl=new m9,this.addControl(this._logoControl,a.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",t=>{this._update(t.dataType==="style"),this.fire(new $t(`${t.dataType}data`,t))}),this.on("dataloading",t=>{this.fire(new $t(`${t.dataType}dataloading`,t))})}_getMapId(){return this._mapId}addControl(a,t){if(t===void 0&&(t=a.getDefaultPosition?a.getDefaultPosition():"top-right"),!a||!a.onAdd)return this.fire(new bn(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const r=a.onAdd(this);this._controls.push(a);const c=this._controlPositions[t];return t.indexOf("bottom")!==-1?c.insertBefore(r,c.firstChild):c.appendChild(r),this}removeControl(a){if(!a||!a.onRemove)return this.fire(new bn(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const t=this._controls.indexOf(a);return t>-1&&this._controls.splice(t,1),a.onRemove(this),this}hasControl(a){return this._controls.indexOf(a)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(a){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const t=!this._moving;return t&&this.fire(new $t("movestart",a)).fire(new $t("move",a)),this.fire(new $t("resize",a)),t&&this.fire(new $t("moveend",a)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(a){return this.transform.setMaxBounds(Ol.convert(a)),this._update()}setMinZoom(a){if((a=a??-2)>=-2&&a<=this.transform.maxZoom)return this.transform.minZoom=a,this._update(),this.getZoom()<a?this.setZoom(a):this.fire(new $t("zoomstart")).fire(new $t("zoom")).fire(new $t("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(a){if((a=a??22)>=this.transform.minZoom)return this.transform.maxZoom=a,this._update(),this.getZoom()>a?this.setZoom(a):this.fire(new $t("zoomstart")).fire(new $t("zoom")).fire(new $t("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(a){if((a=a??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(a>=0&&a<=this.transform.maxPitch)return this.transform.minPitch=a,this._update(),this.getPitch()<a?this.setPitch(a):this.fire(new $t("pitchstart")).fire(new $t("pitch")).fire(new $t("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(a){if((a=a??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(a>=this.transform.minPitch)return this.transform.maxPitch=a,this._update(),this.getPitch()>a?this.setPitch(a):this.fire(new $t("pitchstart")).fire(new $t("pitch")).fire(new $t("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(a){return this.transform.renderWorldCopies=a,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(a){return a==="auto"?f.navigator.language:Array.isArray(a)?a.length===0?void 0:a.map(t=>t==="auto"?f.navigator.language:t):a}setLanguage(a){const t=this._parseLanguage(a);if(!this.style||t===this._language)return this;this._language=t,this.style.reloadSources();for(const r of this._controls)r._setLanguage&&r._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(a){return this.style&&a!==this._worldview?(this._worldview=a,this.style.reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return this.transform.projection.name==="globe"}setProjection(a){return this._lazyInitEmptyStyle(),a?typeof a=="string"&&(a={name:a}):a=null,this._useExplicitProjection=!!a,this._prioritizeAndUpdateProjection(a,this.style.projection)}_updateProjectionTransition(){if(this.getProjection().name!=="globe")return;const a=this.transform,t=a.projection.name;let r;t==="globe"&&a.zoom>=bp?(a.setMercatorFromTransition(),r=!0):t==="mercator"&&a.zoom<bp&&(a.setProjection({name:"globe"}),r=!0),r&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(a,t){return this._updateProjection(a||t||{name:"mercator"})}_updateProjection(a){let t;if(t=a.name==="globe"&&this.transform.zoom>=bp?this.transform.setMercatorFromTransition():this.transform.setProjection(a),this.style.applyProjectionUpdate(),t){this.painter.clearBackgroundTiles();for(const r in this.style._sourceCaches)this.style._sourceCaches[r].clearTiles();this._update(!0),this._forceMarkerAndPopupUpdate(!0)}return this}project(a){return this.transform.locationPoint3D(On.convert(a))}unproject(a){return this.transform.pointLocation3D(V.convert(a))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(a,t,r){if(a==="mouseenter"||a==="mouseover"){let c=!1;const u=m=>{const g=t.filter(b=>this.getLayer(b)),v=g.length?this.queryRenderedFeatures(m.point,{layers:g}):[];v.length?c||(c=!0,r.call(this,new Fl(a,this,m.originalEvent,{features:v}))):c=!1},h=()=>{c=!1};return{layers:new Set(t),listener:r,delegates:{mousemove:u,mouseout:h}}}if(a==="mouseleave"||a==="mouseout"){let c=!1;const u=m=>{const g=t.filter(v=>this.getLayer(v));(g.length?this.queryRenderedFeatures(m.point,{layers:g}):[]).length?c=!0:c&&(c=!1,r.call(this,new Fl(a,this,m.originalEvent)))},h=m=>{c&&(c=!1,r.call(this,new Fl(a,this,m.originalEvent)))};return{layers:new Set(t),listener:r,delegates:{mousemove:u,mouseout:h}}}{const c=u=>{const h=t.filter(g=>this.getLayer(g)),m=h.length?this.queryRenderedFeatures(u.point,{layers:h}):[];m.length&&(u.features=m,r.call(this,u),delete u.features)};return{layers:new Set(t),listener:r,delegates:{[a]:c}}}}on(a,t,r){if(r===void 0)return super.on(a,t);if(Array.isArray(t)||(t=[t]),t){for(const u of t)if(!this._isValidId(u))return this}const c=this._createDelegatedListener(a,t,r);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[a]=this._delegatedListeners[a]||[],this._delegatedListeners[a].push(c);for(const u in c.delegates)this.on(u,c.delegates[u]);return this}once(a,t,r){if(r===void 0)return super.once(a,t);if(Array.isArray(t)||(t=[t]),t){for(const u of t)if(!this._isValidId(u))return this}const c=this._createDelegatedListener(a,t,r);for(const u in c.delegates)this.once(u,c.delegates[u]);return this}off(a,t,r){if(r===void 0)return super.off(a,t);t=new Set(Array.isArray(t)?t:[t]);for(const h of t)if(!this._isValidId(h))return this;const c=(h,m)=>{if(h.size!==m.size)return!1;for(const g of h)if(!m.has(g))return!1;return!0},u=this._delegatedListeners?this._delegatedListeners[a]:void 0;return u&&(h=>{for(let m=0;m<h.length;m++){const g=h[m];if(g.listener===r&&c(g.layers,t)){for(const v in g.delegates)this.off(v,g.delegates[v]);return h.splice(m,1),this}}})(u),this}queryRenderedFeatures(a,t){if(!this.style)return[];if(t!==void 0||a===void 0||a instanceof V||Array.isArray(a)||(t=a,a=void 0),a=a||[[0,0],[this.transform.width,this.transform.height]],(t=t||{}).layers&&Array.isArray(t.layers)){for(const r of t.layers)if(!this._isValidId(r))return[]}return this.style.queryRenderedFeatures(a,t,this.transform)}querySourceFeatures(a,t){return this._isValidId(a)?this.style.querySourceFeatures(a,t):[]}isPointOnSurface(a){const{name:t}=this.transform.projection;return t!=="globe"&&t!=="mercator"&&_e(`${t} projection does not support isPointOnSurface, this API may behave unexpectedly.`),this.transform.isPointOnSurface(V.convert(a))}setStyle(a,t){return(t=Fe({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},t)).diff!==!1&&t.localIdeographFontFamily===this._localIdeographFontFamily&&t.localFontFamily===this._localFontFamily&&this.style&&a?(this._diffStyle(a,t),this):(this._localIdeographFontFamily=t.localIdeographFontFamily,this._localFontFamily=t.localFontFamily,this._updateStyle(a,t))}_getUIString(a){const t=this._locale[a];if(t==null)throw new Error(`Missing UI string '${a}'`);return t}_updateStyle(a,t){return this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),a&&(this.style=new Jc(this,t||{}),this.style.setEventedParent(this,{style:this.style}),typeof a=="string"?this.style.loadURL(a):this.style.loadJSON(a)),this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new Jc(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(a,t){if(typeof a=="string"){const r=this._requestManager.normalizeStyleURL(a),c=this._requestManager.transformRequest(r,we.Style);tt(c,(u,h)=>{u?this.fire(new bn(u)):h&&this._updateDiff(h,t)})}else typeof a=="object"&&this._updateDiff(a,t)}_updateDiff(a,t){try{this.style.setState(a)&&this._update(!0)}catch(r){_e(`Unable to perform style diff: ${r.message||r.error||r}.  Rebuilding the style from scratch.`),this._updateStyle(a,t)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(_e("There is no style added to the map."),!1)}_isValidId(a){return!function(t){return t.indexOf("")>=0}(a)||(this.fire(new bn(new Error(`IDs can't contain special symbols: "${a}".`))),!1)}addSource(a,t){return this._isValidId(a)?(this._lazyInitEmptyStyle(),this.style.addSource(a,t),this._update(!0)):this}isSourceLoaded(a){return!!this._isValidId(a)&&!!this.style&&this.style._isSourceCacheLoaded(a)}areTilesLoaded(){const a=this.style&&this.style._sourceCaches;for(const t in a){const r=a[t]._tiles;for(const c in r){const u=r[c];if(u.state!=="loaded"&&u.state!=="errored")return!1}}return!0}addSourceType(a,t,r){this._lazyInitEmptyStyle(),this.style.addSourceType(a,t,r)}removeSource(a){return this._isValidId(a)?(this.style.removeSource(a),this._updateTerrain(),this._update(!0)):this}getSource(a){return this._isValidId(a)?this.style.getOwnSource(a):null}addImage(a,t,{pixelRatio:r=1,sdf:c=!1,stretchX:u,stretchY:h,content:m}={}){if(this._lazyInitEmptyStyle(),t instanceof f.HTMLImageElement||f.ImageBitmap&&t instanceof f.ImageBitmap){const{width:g,height:v,data:b}=Cn.getImageData(t);this.style.addImage(a,{data:new Xa({width:g,height:v},b),pixelRatio:r,stretchX:u,stretchY:h,content:m,sdf:c,version:0})}else if(t.width===void 0||t.height===void 0)this.fire(new bn(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:g,height:v}=t,b=t;this.style.addImage(a,{data:new Xa({width:g,height:v},new Uint8Array(b.data)),pixelRatio:r,stretchX:u,stretchY:h,content:m,sdf:c,version:0,userImage:b}),b.onAdd&&b.onAdd(this,a)}}updateImage(a,t){this._lazyInitEmptyStyle();const r=this.style.getImage(a);if(!r)return void this.fire(new bn(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const c=t instanceof f.HTMLImageElement||f.ImageBitmap&&t instanceof f.ImageBitmap?Cn.getImageData(t):t,{width:u,height:h}=c;u!==void 0&&h!==void 0?u===r.data.width&&h===r.data.height?(r.data.replace(c.data,!(t instanceof f.HTMLImageElement||f.ImageBitmap&&t instanceof f.ImageBitmap)),this.style.updateImage(a,r)):this.fire(new bn(new Error(`The width and height of the updated image (${u}, ${h})
                must be that same as the previous version of the image
                (${r.data.width}, ${r.data.height})`))):this.fire(new bn(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")))}hasImage(a){return a?!!this.style&&!!this.style.getImage(a):(this.fire(new bn(new Error("Missing required image id"))),!1)}removeImage(a){this.style.removeImage(a)}loadImage(a,t){Qt(this._requestManager.transformRequest(a,we.Image),(r,c)=>{t(r,c instanceof f.HTMLImageElement?Cn.getImageData(c):c)})}listImages(){return this.style.listImages()}addModel(a,t){this._lazyInitEmptyStyle(),this.style.addModel(a,t)}hasModel(a){return a?this.style.hasModel(a):(this.fire(new bn(new Error("Missing required model id"))),!1)}removeModel(a){this.style.removeModel(a)}listModels(){return this.style.listModels()}addLayer(a,t){return this._isValidId(a.id)?(this._lazyInitEmptyStyle(),this.style.addLayer(a,t),this._update(!0)):this}moveLayer(a,t){return this._isValidId(a)?(this.style.moveLayer(a,t),this._update(!0)):this}removeLayer(a){return this._isValidId(a)?(this.style.removeLayer(a),this._update(!0)):this}setLights(a){if(this._lazyInitEmptyStyle(),a&&a.length===1&&a[0].type==="flat"){const t=a[0];t.properties?this.style.setFlatLight(t.properties,t.id,{}):this.style.setFlatLight({},"flat")}else this.style.setLights(a),this.painter.terrain&&(this.painter.terrain.invalidateRenderCache=!0);return this._update(!0)}getLights(){const a=this.style.getLights()||[];return a.length===0&&a.push({id:this.style.light.id,type:"flat",properties:this.style.getFlatLight()}),a}getLayer(a){return this._isValidId(a)?this.style.getOwnLayer(a):null}setLayerZoomRange(a,t,r){return this._isValidId(a)?(this.style.setLayerZoomRange(a,t,r),this._update(!0)):this}setFilter(a,t,r={}){return this._isValidId(a)?(this.style.setFilter(a,t,r),this._update(!0)):this}getFilter(a){return this._isValidId(a)?this.style.getFilter(a):null}setPaintProperty(a,t,r,c={}){return this._isValidId(a)?(this.style.setPaintProperty(a,t,r,c),this._update(!0)):this}getPaintProperty(a,t){return this._isValidId(a)?this.style.getPaintProperty(a,t):null}setLayoutProperty(a,t,r,c={}){return this._isValidId(a)?(this.style.setLayoutProperty(a,t,r,c),this._update(!0)):this}getLayoutProperty(a,t){return this._isValidId(a)?this.style.getLayoutProperty(a,t):null}setConfigProperty(a,t,r){return this.style.setConfigProperty(a,t,r),this._update(!0)}setLight(a,t={}){return console.log("The `map.setLight` function is deprecated, prefer using `map.setLights` with `flat` light type instead."),this.setLights([{id:"flat",type:"flat",properties:a}])}getLight(){return console.log("The `map.getLight` function is deprecated, prefer using `map.getLights` instead."),this.style.getFlatLight()}setTerrain(a){return this._lazyInitEmptyStyle(),!a&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(a),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(a){return this._lazyInitEmptyStyle(),this.style.setFog(a),this._update(!0)}getFog(){return this.style?this.style.getFog():null}setCamera(a){return this.style.setCamera(a),this._triggerCameraUpdate(a)}_triggerCameraUpdate(a){return this._update(this.transform.setOrthographicProjectionAtLowPitch(a["camera-projection"]==="orthographic"))}getCamera(){return this.style.camera}_queryFogOpacity(a){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(On.convert(a),this.transform):0}setFeatureState(a,t){return this._isValidId(a.source)?(this.style.setFeatureState(a,t),this._update()):this}removeFeatureState(a,t){return this._isValidId(a.source)?(this.style.removeFeatureState(a,t),this._update()):this}getFeatureState(a){return this._isValidId(a.source)?this.style.getFeatureState(a):null}_updateContainerDimensions(){if(!this._container)return;const a=this._container.getBoundingClientRect().width||400,t=this._container.getBoundingClientRect().height||300;let r,c,u,h=this._container;for(;h&&(!c||!u);){const m=f.getComputedStyle(h).transform;m&&m!=="none"&&(r=m.match(/matrix.*\((.+)\)/)[1].split(", "),r[0]&&r[0]!=="0"&&r[0]!=="1"&&(c=r[0]),r[3]&&r[3]!=="0"&&r[3]!=="1"&&(u=r[3])),h=h.parentElement}this._containerWidth=c?Math.abs(a/c):a,this._containerHeight=u?Math.abs(t/u):t}_detectMissingCSS(){f.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&_e("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const a=this._container;a.classList.add("mapboxgl-map"),(this._missingCSSCanary=Jn("div","mapboxgl-canary",a)).style.visibility="hidden",this._detectMissingCSS();const t=this._canvasContainer=Jn("div","mapboxgl-canvas-container",a);this._canvas=Jn("canvas","mapboxgl-canvas",t),this._interactive&&(t.classList.add("mapboxgl-interactive"),this._canvas.setAttribute("tabindex","0")),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const r=this._controlContainer=Jn("div","mapboxgl-control-container",a),c=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(u=>{c[u]=Jn("div",`mapboxgl-ctrl-${u}`,r)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(a,t){const r=Cn.devicePixelRatio||1;this._canvas.width=r*Math.ceil(a),this._canvas.height=r*Math.ceil(t),this._canvas.style.width=`${a}px`,this._canvas.style.height=`${t}px`}_addMarker(a){this._markers.push(a)}_removeMarker(a){const t=this._markers.indexOf(a);t!==-1&&this._markers.splice(t,1)}_addPopup(a){this._popups.push(a)}_removePopup(a){const t=this._popups.indexOf(a);t!==-1&&this._popups.splice(t,1)}_setupPainter(){const a=Fe({},Di.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),t=this._canvas.getContext("webgl2",a);t?(wr(t,!0),this.painter=new sre(t,this.transform),this.on("data",r=>{r.dataType==="source"&&this.painter.setTileLoadedFlag(!0)}),S.testSupport(t)):this.fire(new bn(new Error("Failed to initialize WebGL")))}_contextLost(a){a.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new $t("webglcontextlost",{originalEvent:a}))}_contextRestored(a){this._setupPainter(),this.resize(),this._update(),this.fire(new $t("webglcontextrestored",{originalEvent:a}))}_onMapScroll(a){if(a.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(a){return this.style?(this._styleDirty=this._styleDirty||a,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(a){return this._update(),this._renderTaskQueue.add(a)}_cancelRenderFrame(a){this._renderTaskQueue.remove(a)}_requestDomTask(a){!this.loaded()||this.loaded()&&!this.isMoving()?a():this._domRenderTaskQueue.add(a)}_render(a){let t;this.fire(new $t("renderstart"));const r=this.painter.context.extTimerQuery,c=Cn.now(),u=this.painter.context.gl;if(this.listens("gpu-timing-frame")&&(t=u.createQuery(),u.beginQuery(r.TIME_ELAPSED_EXT,t)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],f.performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],f.performance.now())),this._renderTaskQueue.run(a),this._domRenderTaskQueue.run(a),this._removed)return;this._updateProjectionTransition();const h=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const v=this.transform.zoom,b=this.transform.pitch,w=Cn.now(),A=new sa(v,{now:w,fadeDuration:h,pitch:b,transition:this.style.transition});this.style.update(A)}this.style&&this.style.hasFogTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let m=!1;if(this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),m=this._updateAverageElevation(c),this.style.updateSources(this.transform),this._forceMarkerAndPopupUpdate()):m=this._updateAverageElevation(c),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,h,this._crossSourceCollisions),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,wireframe:{terrain:this.showTerrainWireframe,layers2D:this.showLayers2DWireframe,layers3D:this.showLayers3DWireframe},showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:h,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new $t("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new $t("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),t){const v=Cn.now()-c;u.endQuery(r.TIME_ELAPSED_EXT),setTimeout(()=>{const b=u.getQueryParameter(t,u.QUERY_RESULT)/1e6;u.deleteQuery(t),this.fire(new $t("gpu-timing-frame",{cpuTime:v,gpuTime:b})),f.performance.mark("frame-gpu",{startTime:c,detail:{gpuTime:b}})},50)}if(this.listens("gpu-timing-layer")){const v=this.painter.collectGpuTimers();setTimeout(()=>{const b=this.painter.queryGpuTimers(v);this.fire(new $t("gpu-timing-layer",{layerTimes:b}))},50)}if(this.listens("gpu-timing-deferred-render")){const v=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const b=this.painter.queryGpuTimeDeferredRender(v);this.fire(new $t("gpu-timing-deferred-render",{gpuTime:b}))},50)}const g=this._sourcesDirty||this._styleDirty||this._placementDirty||m;if(g||this._repaint)this.triggerRepaint();else{const v=!this.isMoving()&&this.loaded();if(v&&(m=this._updateAverageElevation(c,!0)),m)this.triggerRepaint();else if(this._triggerFrame(!1),v&&(this.fire(new $t("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const b=this._calculateSpeedIndex();this.fire(new $t("speedindexcompleted",{speedIndex:b})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||g||(this._fullyLoaded=!0,Ka.mark(ia.fullLoad),this._performanceMetricsCollection&&di(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(a){for(const t of this._markers)a&&!this.getRenderWorldCopies()&&(t._lngLat=t._lngLat.wrap()),t._update();for(const t of this._popups)!a||this.getRenderWorldCopies()||t._trackPointer||(t._lngLat=t._lngLat.wrap()),t._update()}_updateAverageElevation(a,t=!1){const r=u=>(this.transform.averageElevation=u,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&r(0);const c=this.transform.elevation&&this.transform.elevation.exaggeration()!==this._averageElevationExaggeration;if(c||(t||a-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(a)){const u=this.transform.averageElevation;let h=this.transform.sampleAverageElevation();this.transform.elevation&&(this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(h)?h=0:this._averageElevationLastSampledAt=a;const m=Math.abs(u-h);if(m>1){if(this._isInitialLoad||c)return this._averageElevation.jumpTo(h),r(h);this._averageElevation.easeTo(h,a,300)}else if(m>1e-4)return this._averageElevation.jumpTo(h),r(h)}return!!this._averageElevation.isEasing(a)&&r(this._averageElevation.getValue(a))}_authenticate(){li(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,a=>{if(a&&(a.message===fn||a.status===401)){const t=this.painter.context.gl;wr(t,!1),this._logoControl instanceof m9&&this._logoControl._updateLogo(),t&&t.clear(t.DEPTH_BUFFER_BIT|t.COLOR_BUFFER_BIT|t.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new bn(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),Xn(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_updateTerrain(){const a=this._isDragging();this.painter.updateTerrain(this.style,a)}_calculateSpeedIndex(){const a=this.painter.canvasCopy(),t=this.painter.getCanvasCopiesAndTimestamps();t.timeStamps.push(performance.now());const r=this.painter.context.gl,c=r.createFramebuffer();function u(h){r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,h,0);const m=new Uint8Array(r.drawingBufferWidth*r.drawingBufferHeight*4);return r.readPixels(0,0,r.drawingBufferWidth,r.drawingBufferHeight,r.RGBA,r.UNSIGNED_BYTE,m),m}return r.bindFramebuffer(r.FRAMEBUFFER,c),this._canvasPixelComparison(u(a),t.canvasCopies.map(u),t.timeStamps)}_canvasPixelComparison(a,t,r){let c=r[1]-r[0];const u=a.length/4;for(let h=0;h<t.length;h++){const m=t[h];let g=0;for(let v=0;v<m.length;v+=4)m[v]===a[v]&&m[v+1]===a[v+1]&&m[v+2]===a[v+2]&&m[v+3]===a[v+3]&&(g+=1);c+=(r[h+2]-r[h+1])*(1-g/u)}return c}remove(){this._hash&&this._hash.remove();for(const t of this._controls)t.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),f!==void 0&&(f.removeEventListener("resize",this._onWindowResize,!1),f.removeEventListener("orientationchange",this._onWindowResize,!1),f.removeEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),f.removeEventListener("online",this._onWindowOnline,!1),f.removeEventListener("visibilitychange",this._onVisibilityChange,!1));const a=this.painter.context.gl.getExtension("WEBGL_lose_context");a&&a.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),ra.delete(this.painter.context.gl),this._removed=!0,this.fire(new $t("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(a){this._renderNextFrame=this._renderNextFrame||a,this.style&&!this._frame&&(this._frame=Cn.frame(t=>{const r=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,r&&this._render(t)}))}_preloadTiles(a){return Ze(this.style?Object.values(this.style._sourceCaches):[],(t,r)=>t._preloadTiles(a,r),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(a){this._trackResize&&this.resize({originalEvent:a})._update()}_onVisibilityChange(){f.document.visibilityState==="hidden"&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(a){this._showTileBoundaries!==a&&(this._showTileBoundaries=a,this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(a){this._showTerrainWireframe!==a&&(this._showTerrainWireframe=a,this._update())}get showLayers2DWireframe(){return!!this._showLayers2DWireframe}set showLayers2DWireframe(a){this._showLayers2DWireframe!==a&&(this._showLayers2DWireframe=a,this._update())}get showLayers3DWireframe(){return!!this._showLayers3DWireframe}set showLayers3DWireframe(a){this._showLayers3DWireframe!==a&&(this._showLayers3DWireframe=a,this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(a){this._speedIndexTiming!==a&&(this._speedIndexTiming=a,this._update())}get showPadding(){return!!this._showPadding}set showPadding(a){this._showPadding!==a&&(this._showPadding=a,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(a){this._showCollisionBoxes!==a&&(this._showCollisionBoxes=a,a?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(a){this._showOverdrawInspector!==a&&(this._showOverdrawInspector=a,this._update())}get repaint(){return!!this._repaint}set repaint(a){this._repaint!==a&&(this._repaint=a,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(a){this._vertices=a,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(a){this._showTileAABBs!==a&&(this._showTileAABBs=a,a&&this._update())}_setCacheLimits(a,t){(function(r,c){wt=r,Xt=c})(a,t)}get version(){return y}},NavigationControl:class{constructor(a){this.options=Fe({},Qre,a),this._container=Jn("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",t=>t.preventDefault()),this.options.showZoom&&(ft(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",t=>{this._map&&this._map.zoomIn({},{originalEvent:t})}),Jn("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",t=>{this._map&&this._map.zoomOut({},{originalEvent:t})}),Jn("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(ft(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",t=>{const r=this._map;r&&(this.options.visualizePitch?r.resetNorthPitch({},{originalEvent:t}):r.resetNorth({},{originalEvent:t}))}),this._compassIcon=Jn("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const a=this._map;if(!a)return;const t=a.getZoom(),r=t===a.getMaxZoom(),c=t===a.getMinZoom();this._zoomInButton.disabled=r,this._zoomOutButton.disabled=c,this._zoomInButton.setAttribute("aria-disabled",r.toString()),this._zoomOutButton.setAttribute("aria-disabled",c.toString())}_rotateCompassArrow(){const a=this._map;if(!a)return;const t=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(a.transform.pitch*(Math.PI/180)),.5)}) rotateX(${a.transform.pitch}deg) rotateZ(${a.transform.angle*(180/Math.PI)}deg)`:`rotate(${a.transform.angle*(180/Math.PI)}deg)`;a._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=t)})}onAdd(a){return this._map=a,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),a.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&a.on("pitch",this._rotateCompassArrow),a.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new eoe(a,this._compass,this.options.visualizePitch)),this._container}onRemove(){const a=this._map;a&&(this._container.remove(),this.options.showZoom&&a.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&a.off("pitch",this._rotateCompassArrow),a.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(a,t){const r=Jn("button",a,this._container);return r.type="button",r.addEventListener("click",t),r}_setButtonTitle(a,t){if(!this._map)return;const r=this._map._getUIString(`NavigationControl.${t}`);a.setAttribute("aria-label",r),a.firstElementChild&&a.firstElementChild.setAttribute("title",r)}},GeolocateControl:class extends Un{constructor(a){super(),this.options=Fe({geolocation:f.navigator.geolocation},toe,a),ft(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=o9(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(a){return this._map=a,this._container=Jn("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(a){const t=(r=!!this.options.geolocation)=>{this._supportsGeolocation=r,a(r)};this._supportsGeolocation!==void 0?a(this._supportsGeolocation):f.navigator.permissions!==void 0?f.navigator.permissions.query({name:"geolocation"}).then(r=>t(r.state!=="denied")).catch(()=>t()):t()}_isOutOfMapMaxBounds(a){const t=this._map.getMaxBounds(),r=a.coords;return!!t&&(r.longitude<t.getWest()||r.longitude>t.getEast()||r.latitude<t.getSouth()||r.latitude>t.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(a){if(this._map){if(this._isOutOfMapMaxBounds(a))return this._setErrorState(),this.fire(new $t("outofmaxbounds",a)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=a,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(a),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(a),this.options.showUserLocation&&this._userLocationDotMarker.removeClassName("mapboxgl-user-location-dot-stale"),this.fire(new $t("geolocate",a)),this._finish()}}_updateCamera(a){const t=new On(a.coords.longitude,a.coords.latitude),r=a.coords.accuracy,c=Fe({bearing:this._map.getBearing()},this.options.fitBoundsOptions);this._map.fitBounds(t.toBounds(r),c,{geolocateSource:!0})}_updateMarker(a){if(a){const t=new On(a.coords.longitude,a.coords.latitude);this._accuracyCircleMarker.setLngLat(t).addTo(this._map),this._userLocationDotMarker.setLngLat(t).addTo(this._map),this._accuracy=a.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const a=this._map.transform,t=$i(1,a._center.lat)*a.worldSize,r=Math.ceil(2*this._accuracy*t);this._circleElement.style.width=`${r}px`,this._circleElement.style.height=`${r}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._userLocationDotMarker.addClassName("mapboxgl-user-location-show-heading")):(this._userLocationDotMarker.removeClassName("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(a){if(this._map){if(this.options.trackUserLocation)if(a.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const t=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",t),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",t),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(a.code===3&&this._noTimeout)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._userLocationDotMarker.addClassName("mapboxgl-user-location-dot-stale"),this.fire(new $t("error",a)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(a){if(this._map!==void 0){if(this._container.addEventListener("contextmenu",t=>t.preventDefault()),this._geolocateButton=Jn("button","mapboxgl-ctrl-geolocate",this._container),Jn("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",a===!1){_e("Geolocation support is not available so the GeolocateControl will be disabled.");const t=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",t),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",t)}else{const t=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",t),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",t)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=Jn("div","mapboxgl-user-location"),this._dotElement.appendChild(Jn("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(Jn("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new R5({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=Jn("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new R5({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",t=>{t.geolocateSource||this._watchState!=="ACTIVE_LOCK"||t.originalEvent&&t.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new $t("trackuserlocationend")))})}}_onDeviceOrientation(a){this._userLocationDotMarker&&(a.webkitCompassHeading?this._heading=a.webkitCompassHeading:a.absolute===!0&&(this._heading=-1*a.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return _e("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new $t("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new $t("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new $t("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let a;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(a={maximumAge:6e5,timeout:0},this._noTimeout=!0):(a=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,a),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const a=()=>{f.addEventListener("ondeviceorientationabsolute"in f?"deviceorientationabsolute":"deviceorientation",this._onDeviceOrientation)};f.DeviceMotionEvent!==void 0&&typeof f.DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(t=>{t==="granted"&&a()}).catch(console.error):a()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),f.removeEventListener("deviceorientation",this._onDeviceOrientation),f.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:f9,ScaleControl:class{constructor(a){this.options=Fe({},noe,a),this._isNumberFormatSupported=function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch{return!1}}(),ft(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const a=this.options.maxWidth||100,t=this._map,r=t._containerHeight/2,c=t._containerWidth/2-a/2,u=t.unproject([c,r]),h=t.unproject([c+a,r]),m=u.distanceTo(h);if(this.options.unit==="imperial"){const g=3.2808*m;g>5280?this._setScale(a,g/5280,"mile"):this._setScale(a,g,"foot")}else this.options.unit==="nautical"?this._setScale(a,m/1852,"nautical-mile"):m>=1e3?this._setScale(a,m/1e3,"kilometer"):this._setScale(a,m,"meter")}_setScale(a,t,r){this._map._requestDomTask(()=>{const c=function(h){const m=Math.pow(10,`${Math.floor(h)}`.length-1);let g=h/m;return g=g>=10?10:g>=5?5:g>=3?3:g>=2?2:g>=1?1:function(v){const b=Math.pow(10,Math.ceil(-Math.log(v)/Math.LN10));return Math.round(v*b)/b}(g),m*g}(t),u=c/t;this._container.innerHTML=this._isNumberFormatSupported&&r!=="nautical-mile"?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:r}).format(c):`${c}&nbsp;${ioe[r]}`,this._container.style.width=a*u+"px"})}onAdd(a){return this._map=a,this._language=a.getLanguage(),this._container=Jn("div","mapboxgl-ctrl mapboxgl-ctrl-scale",a.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(a){this._language=a,this._update()}setUnit(a){this.options.unit=a,this._update()}},FullscreenControl:class{constructor(a){this._fullscreen=!1,a&&a.container&&(a.container instanceof f.HTMLElement?this._container=a.container:_e("Full screen control 'container' must be a DOM element.")),ft(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in f.document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in f.document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(a){return this._map=a,this._container||(this._container=this._map.getContainer()),this._controlContainer=Jn("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",_e("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,f.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!f.document.fullscreenEnabled&&!f.document.webkitFullscreenEnabled)}_setupUI(){const a=this._fullscreenButton=Jn("button","mapboxgl-ctrl-fullscreen",this._controlContainer);Jn("span","mapboxgl-ctrl-icon",a).setAttribute("aria-hidden","true"),a.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),f.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const a=this._getTitle();this._fullscreenButton.setAttribute("aria-label",a),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",a)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(f.document.fullscreenElement||f.document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?f.document.exitFullscreen?f.document.exitFullscreen():f.document.webkitCancelFullScreen&&f.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends Un{constructor(a){super(),this.options=Fe(Object.create(qre),a),ft(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(a&&a.className?a.className.trim().split(/\s+/):[])}addTo(a){return this._map&&this.remove(),this._map=a,this.options.closeOnClick&&a.on("preclick",this._onClose),this.options.closeOnMove&&a.on("move",this._onClose),a.on("remove",this.remove),this._update(),a._addPopup(this),this._focusFirstElement(),this._trackPointer?(a.on("mousemove",this._onMouseEvent),a.on("mouseup",this._onMouseEvent),a._canvasContainer.classList.add("mapboxgl-track-pointer")):a.on("move",this._update),this.fire(new $t("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const a=this._map;return a&&(a.off("move",this._update),a.off("move",this._onClose),a.off("preclick",this._onClose),a.off("click",this._onClose),a.off("remove",this.remove),a.off("mousemove",this._onMouseEvent),a.off("mouseup",this._onMouseEvent),a.off("drag",this._onMouseEvent),a._canvasContainer&&a._canvasContainer.classList.remove("mapboxgl-track-pointer"),a._removePopup(this),this._map=void 0),this.fire(new $t("close")),this}getLngLat(){return this._lngLat}setLngLat(a){this._lngLat=On.convert(a),this._pos=null,this._trackPointer=!1,this._update();const t=this._map;return t&&(t.on("move",this._update),t.off("mousemove",this._onMouseEvent),t._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const a=this._map;return a&&(a.off("move",this._update),a.on("mousemove",this._onMouseEvent),a.on("drag",this._onMouseEvent),a._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(a){return this.setDOMContent(f.document.createTextNode(a))}setHTML(a){const t=f.document.createDocumentFragment(),r=f.document.createElement("body");let c;for(r.innerHTML=a;c=r.firstChild,c;)t.appendChild(c);return this.setDOMContent(t)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(a){return this.options.maxWidth=a,this._update(),this}setDOMContent(a){let t=this._content;if(t)for(;t.hasChildNodes();)t.firstChild&&t.removeChild(t.firstChild);else t=this._content=Jn("div","mapboxgl-popup-content",this._container||void 0);if(t.appendChild(a),this.options.closeButton){const r=this._closeButton=Jn("button","mapboxgl-popup-close-button",t);r.type="button",r.setAttribute("aria-label","Close popup"),r.setAttribute("aria-hidden","true"),r.innerHTML="&#215;",r.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(a){return this._classList.add(a),this._updateClassList(),this}removeClassName(a){return this._classList.delete(a),this._updateClassList(),this}setOffset(a){return this.options.offset=a,this._update(),this}toggleClassName(a){let t;return this._classList.delete(a)?t=!1:(this._classList.add(a),t=!0),this._updateClassList(),t}_onMouseEvent(a){this._update(a.point)}_getAnchor(a){if(this.options.anchor)return this.options.anchor;const t=this._map,r=this._container,c=this._pos;if(!t||!r||!c)return"bottom";const u=r.offsetWidth,h=r.offsetHeight,m=c.x<u/2,g=c.x>t.transform.width-u/2;if(c.y+a<h)return m?"top-left":g?"top-right":"top";if(c.y>t.transform.height-h){if(m)return"bottom-left";if(g)return"bottom-right"}return m?"left":g?"right":"bottom"}_updateClassList(){const a=this._container;if(!a)return;const t=[...this._classList];t.push("mapboxgl-popup"),this._anchor&&t.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&t.push("mapboxgl-popup-track-pointer"),a.className=t.join(" ")}_update(a){const t=this._map,r=this._content;if(!t||!this._lngLat&&!this._trackPointer||!r)return;let c=this._container;if(c||(c=this._container=Jn("div","mapboxgl-popup",t.getContainer()),this._tip=Jn("div","mapboxgl-popup-tip",c),c.appendChild(r)),this.options.maxWidth&&c.style.maxWidth!==this.options.maxWidth&&(c.style.maxWidth=this.options.maxWidth),t.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=y9(this._lngLat,this._pos,t.transform)),!this._trackPointer||a){const u=this._pos=this._trackPointer&&a?a:t.project(this._lngLat),h=v9(this.options.offset),m=this._anchor=this._getAnchor(h.y),g=v9(this.options.offset,m),v=u.add(g).round();t._requestDomTask(()=>{this._container&&m&&(this._container.style.transform=`${L5[m]} translate(${v.x}px,${v.y}px)`)})}if(!this._marker&&t._showingGlobe()){const u=z2(t.transform,this._lngLat)?0:1;this._setOpacity(u)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const a=this._container.querySelector(Xre);a&&a.focus()}_onClose(){this.remove()}_setOpacity(a){this._container&&(this._container.style.opacity=`${a}`),this._content&&(this._content.style.pointerEvents=a?"auto":"none")}},Marker:R5,Style:Jc,LngLat:On,LngLatBounds:Ol,Point:V,MercatorCoordinate:vi,FreeCameraOptions:PF,Evented:Un,config:x,prewarm:function(){B1().acquire(n5)},clearPrewarmedResources:function(){const a=F1;a&&(a.isPreloaded()&&a.numActive()===1?(a.release(n5),F1=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return x.ACCESS_TOKEN},set accessToken(a){x.ACCESS_TOKEN=a},get baseApiUrl(){return x.API_URL},set baseApiUrl(a){x.API_URL=a},get workerCount(){return Av.workerCount},set workerCount(a){Av.workerCount=a},get maxParallelImageRequests(){return x.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(a){x.MAX_PARALLEL_IMAGE_REQUESTS=a},clearStorage(a){(function(t){if(!qt())return;const r=f.caches.delete(Dt);t&&r.catch(t).then(()=>t())})(a)},workerUrl:"",workerClass:null,get dracoUrl(){return HB()},set dracoUrl(a){(function(t){i5=Cn.resolveURL(t),a5||(a5=new Lm(B1(),new Un)),a5.broadcast("setDracoUrl",i5)})(a)},setNow:Cn.setNow,restoreNow:Cn.restoreNow};p.A=OB,p.D=Em,p.E=mt,p.F=EP,p.K=N3,p.O=Li,p.P=V,p.T=eB,p.V=Z2,p.a=X2,p.b=Lz,p.c=C3,p.d=class extends Un{constructor(a,t,r,c,u,h){super(),this.actor=a,this.layerIndex=t,this.availableImages=r,this.loadVectorData=u||VB,this.loading={},this.loaded={},this.deduped=new WB(a.scheduler),this.isSpriteLoaded=c,this.scheduler=a.scheduler,this.brightness=h}loadTile(a,t){const r=a.uid,c=a&&a.request,u=c&&c.collectResourceTiming,h=this.loading[r]=new Eie(a);h.abort=this.loadVectorData(a,(m,g)=>{const v=!this.loading[r];if(delete this.loading[r],v||m||!g)return h.status="done",v||(this.loaded[r]=h),t(m);const b=g.rawData,w={};g.expires&&(w.expires=g.expires),g.cacheControl&&(w.cacheControl=g.cacheControl),h.vectorTile=g.vectorTile||new xP(new e3(b));const A=()=>{h.parse(h.vectorTile,this.layerIndex,this.availableImages,this.actor,(C,P)=>{if(C||!P)return t(C);const k={};if(u){const z=uo(c);z.length>0&&(k.resourceTiming=JSON.parse(JSON.stringify(z)))}t(null,Fe({rawTileData:b.slice(0)},P,w,k))})};this.isSpriteLoaded?A():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(A,{type:"parseTile",isSymbolTile:a.isSymbolTile,zoom:a.tileZoom}):A()}),this.loaded=this.loaded||{},this.loaded[r]=h})}reloadTile(a,t){const r=this.loaded,c=a.uid,u=this;if(r&&r[c]){const h=r[c];h.showCollisionBoxes=a.showCollisionBoxes,h.projection=a.projection,h.brightness=a.brightness,h.tileTransform=Mm(a.tileID.canonical,a.projection),h.extraShadowCaster=a.extraShadowCaster;const m=(g,v)=>{const b=h.reloadCallback;b&&(delete h.reloadCallback,h.parse(h.vectorTile,u.layerIndex,this.availableImages,u.actor,b)),t(g,v)};h.status==="parsing"?h.reloadCallback=m:h.status==="done"&&(h.vectorTile?h.parse(h.vectorTile,this.layerIndex,this.availableImages,this.actor,m):m())}}abortTile(a,t){const r=a.uid,c=this.loading[r];c&&(c.abort&&c.abort(),delete this.loading[r]),t()}removeTile(a,t){const r=this.loaded,c=a.uid;r&&r[c]&&delete r[c],t()}},p.e=Fc,p.f=uo,p.g=N,p.h=tt,p.i=vt,p.j=function(a,t){const r=u5(a);for(const c of r){for(const u of c.meshes)Oie(u);c.lights&&(c.lightMeshIndex=c.meshes.length,c.meshes.push(Nie(c.lights,t)))}return r},p.k=sa,p.l=async function(a){let t=0;if(new Uint32Array(a,0,1)[0]!==$B){const r=new Uint32Array(a,0,7),[,,c,u,h,m]=r;t=r.byteLength+u+h+m+h,(c!==a.byteLength||t>=a.byteLength)&&_e("Invalid b3dm header information.")}return ZB(a,t)},p.m=c3,p.n=Ds,p.o=$t,p.p=Y,p.q=function(a){Nt(),He&&He.then(t=>{t.keys().then(r=>{for(let c=0;c<r.length-a;c++)t.delete(r[c])})})},p.r=t8,p.s=J3,p.t=p1,p.v=Ke,p.w=f}),l(["./shared"],function(p){function f(Be){if(typeof Be=="number"||typeof Be=="boolean"||typeof Be=="string"||Be==null)return JSON.stringify(Be);if(Array.isArray(Be)){let se="[";for(const _e of Be)se+=`${f(_e)},`;return`${se}]`}let ue="{";for(const se of Object.keys(Be).sort())ue+=`${se}:${f(Be[se])},`;return`${ue}}`}function y(Be){let ue="";for(const se of p.r)ue+=`/${f(Be[se])}`;return ue}class _{constructor(ue){this.keyCache={},ue&&this.replace(ue)}replace(ue,se){this._layerConfigs={},this._layers={},this.update(ue,[],se)}update(ue,se,_e){this._options=_e;for(const De of ue){this._layerConfigs[De.id]=De;const st=this._layers[De.id]=p.c(De,this._options);st.setScope(this.scope),st.compileFilter(),this.keyCache[De.id]&&delete this.keyCache[De.id]}for(const De of se)delete this.keyCache[De],delete this._layerConfigs[De],delete this._layers[De];this.familiesBySource={};const je=function(De,st){const de={};for(let Oe=0;Oe<De.length;Oe++){const ut=st&&st[De[Oe].id]||y(De[Oe]);st&&(st[De[Oe].id]=ut);let it=de[ut];it||(it=de[ut]=[]),it.push(De[Oe])}const ne=[];for(const Oe in de)ne.push(de[Oe]);return ne}(p.v(this._layerConfigs),this.keyCache);for(const De of je){const st=De.map(lt=>this._layers[lt.id]),de=st[0];if(de.visibility==="none")continue;const ne=de.source||"";let Oe=this.familiesBySource[ne];Oe||(Oe=this.familiesBySource[ne]={});const ut=de.sourceLayer||"_geojsonTileLayer";let it=Oe[ut];it||(it=Oe[ut]=[]),it.push(st)}}}class x{loadTile(ue,se){const{uid:_e,encoding:je,rawImageData:De,padding:st}=ue,de=p.w.ImageBitmap&&De instanceof p.w.ImageBitmap?this.getImageData(De,st):De;se(null,new p.D(_e,de,je,ue.convertToFloat,st<1))}getImageData(ue,se){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(ue.width,ue.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=ue.width,this.offscreenCanvas.height=ue.height,this.offscreenCanvasContext.drawImage(ue,0,0,ue.width,ue.height);const _e=this.offscreenCanvasContext.getImageData(-se,-se,ue.width+2*se,ue.height+2*se);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),_e}}function S(Be,ue){if(Be.length!==0){T(Be[0],ue);for(var se=1;se<Be.length;se++)T(Be[se],!ue)}}function T(Be,ue){for(var se=0,_e=0,je=0,De=Be.length,st=De-1;je<De;st=je++){var de=(Be[je][0]-Be[st][0])*(Be[st][1]+Be[je][1]),ne=se+de;_e+=Math.abs(se)>=Math.abs(de)?se-ne+de:de-ne+se,se=ne}se+_e>=0!=!!ue&&Be.reverse()}var I=p.g(function Be(ue,se){var _e,je=ue&&ue.type;if(je==="FeatureCollection")for(_e=0;_e<ue.features.length;_e++)Be(ue.features[_e],se);else if(je==="GeometryCollection")for(_e=0;_e<ue.geometries.length;_e++)Be(ue.geometries[_e],se);else if(je==="Feature")Be(ue.geometry,se);else if(je==="Polygon")S(ue.coordinates,se);else if(je==="MultiPolygon")for(_e=0;_e<ue.coordinates.length;_e++)S(ue.coordinates[_e],se);return ue});const R=p.V.prototype.toGeoJSON;var D={exports:{}},L=p.p,O=p.a.VectorTileFeature,N=F;function F(Be,ue){this.options=ue||{},this.features=Be,this.length=Be.length}function G(Be,ue){this.id=typeof Be.id=="number"?Be.id:void 0,this.type=Be.type,this.rawGeometry=Be.type===1?[Be.geometry]:Be.geometry,this.properties=Be.tags,this.extent=ue||4096}F.prototype.feature=function(Be){return new G(this.features[Be],this.options.extent)},G.prototype.loadGeometry=function(){var Be=this.rawGeometry;this.geometry=[];for(var ue=0;ue<Be.length;ue++){for(var se=Be[ue],_e=[],je=0;je<se.length;je++)_e.push(new L(se[je][0],se[je][1]));this.geometry.push(_e)}return this.geometry},G.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var Be=this.geometry,ue=1/0,se=-1/0,_e=1/0,je=-1/0,De=0;De<Be.length;De++)for(var st=Be[De],de=0;de<st.length;de++){var ne=st[de];ue=Math.min(ue,ne.x),se=Math.max(se,ne.x),_e=Math.min(_e,ne.y),je=Math.max(je,ne.y)}return[ue,_e,se,je]},G.prototype.toGeoJSON=O.prototype.toGeoJSON;var j=p.b,Y=N;function te(Be){var ue=new j;return function(se,_e){for(var je in se.layers)_e.writeMessage(3,V,se.layers[je])}(Be,ue),ue.finish()}function V(Be,ue){var se;ue.writeVarintField(15,Be.version||1),ue.writeStringField(1,Be.name||""),ue.writeVarintField(5,Be.extent||4096);var _e={keys:[],values:[],keycache:{},valuecache:{}};for(se=0;se<Be.length;se++)_e.feature=Be.feature(se),ue.writeMessage(2,Q,_e);var je=_e.keys;for(se=0;se<je.length;se++)ue.writeStringField(3,je[se]);var De=_e.values;for(se=0;se<De.length;se++)ue.writeMessage(4,Me,De[se])}function Q(Be,ue){var se=Be.feature;se.id!==void 0&&ue.writeVarintField(1,se.id),ue.writeMessage(2,he,Be),ue.writeVarintField(3,se.type),ue.writeMessage(4,pe,se)}function he(Be,ue){var se=Be.feature,_e=Be.keys,je=Be.values,De=Be.keycache,st=Be.valuecache;for(var de in se.properties){var ne=se.properties[de],Oe=De[de];if(ne!==null){Oe===void 0&&(_e.push(de),De[de]=Oe=_e.length-1),ue.writeVarint(Oe);var ut=typeof ne;ut!=="string"&&ut!=="boolean"&&ut!=="number"&&(ne=JSON.stringify(ne));var it=ut+":"+ne,lt=st[it];lt===void 0&&(je.push(ne),st[it]=lt=je.length-1),ue.writeVarint(lt)}}}function fe(Be,ue){return(ue<<3)+(7&Be)}function ye(Be){return Be<<1^Be>>31}function pe(Be,ue){for(var se=Be.loadGeometry(),_e=Be.type,je=0,De=0,st=se.length,de=0;de<st;de++){var ne=se[de],Oe=1;_e===1&&(Oe=ne.length),ue.writeVarint(fe(1,Oe));for(var ut=_e===3?ne.length-1:ne.length,it=0;it<ut;it++){it===1&&_e!==1&&ue.writeVarint(fe(2,ut-1));var lt=ne[it].x-je,Et=ne[it].y-De;ue.writeVarint(ye(lt)),ue.writeVarint(ye(Et)),je+=lt,De+=Et}_e===3&&ue.writeVarint(fe(7,1))}}function Me(Be,ue){var se=typeof Be;se==="string"?ue.writeStringField(1,Be):se==="boolean"?ue.writeBooleanField(7,Be):se==="number"&&(Be%1!=0?ue.writeDoubleField(3,Be):Be<0?ue.writeSVarintField(6,Be):ue.writeVarintField(5,Be))}D.exports=te,D.exports.fromVectorTileJs=te,D.exports.fromGeojsonVt=function(Be,ue){ue=ue||{};var se={};for(var _e in Be)se[_e]=new Y(Be[_e].features,ue),se[_e].name=_e,se[_e].version=ue.version,se[_e].extent=ue.extent;return te({layers:se})},D.exports.GeoJSONWrapper=Y;var Ie=p.g(D.exports);const ze={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:Be=>Be},le=Math.fround||(me=new Float32Array(1),Be=>(me[0]=+Be,me[0]));var me;const xe=3,ae=5,Ee=6;class Je{constructor(ue){this.options=Object.assign(Object.create(ze),ue),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(ue){const{log:se,minZoom:_e,maxZoom:je}=this.options;se&&console.time("total time");const De=`prepare ${ue.length} points`;se&&console.time(De),this.points=ue;const st=[];for(let ne=0;ne<ue.length;ne++){const Oe=ue[ne];if(!Oe.geometry)continue;const[ut,it]=Oe.geometry.coordinates,lt=le(Fe(ut)),Et=le(ct(it));st.push(lt,Et,1/0,ne,-1,1),this.options.reduce&&st.push(0)}let de=this.trees[je+1]=this._createTree(st);se&&console.timeEnd(De);for(let ne=je;ne>=_e;ne--){const Oe=+Date.now();de=this.trees[ne]=this._createTree(this._cluster(de,ne)),se&&console.log("z%d: %d clusters in %dms",ne,de.numItems,+Date.now()-Oe)}return se&&console.timeEnd("total time"),this}getClusters(ue,se){let _e=((ue[0]+180)%360+360)%360-180;const je=Math.max(-90,Math.min(90,ue[1]));let De=ue[2]===180?180:((ue[2]+180)%360+360)%360-180;const st=Math.max(-90,Math.min(90,ue[3]));if(ue[2]-ue[0]>=360)_e=-180,De=180;else if(_e>De){const it=this.getClusters([_e,je,180,st],se),lt=this.getClusters([-180,je,De,st],se);return it.concat(lt)}const de=this.trees[this._limitZoom(se)],ne=de.range(Fe(_e),ct(st),Fe(De),ct(je)),Oe=de.data,ut=[];for(const it of ne){const lt=this.stride*it;ut.push(Oe[lt+ae]>1?Ze(Oe,lt,this.clusterProps):this.points[Oe[lt+xe]])}return ut}getChildren(ue){const se=this._getOriginId(ue),_e=this._getOriginZoom(ue),je="No cluster with the specified id.",De=this.trees[_e];if(!De)throw new Error(je);const st=De.data;if(se*this.stride>=st.length)throw new Error(je);const de=this.options.radius/(this.options.extent*Math.pow(2,_e-1)),ne=De.within(st[se*this.stride],st[se*this.stride+1],de),Oe=[];for(const ut of ne){const it=ut*this.stride;st[it+4]===ue&&Oe.push(st[it+ae]>1?Ze(st,it,this.clusterProps):this.points[st[it+xe]])}if(Oe.length===0)throw new Error(je);return Oe}getLeaves(ue,se,_e){const je=[];return this._appendLeaves(je,ue,se=se||10,_e=_e||0,0),je}getTile(ue,se,_e){const je=this.trees[this._limitZoom(ue)],De=Math.pow(2,ue),{extent:st,radius:de}=this.options,ne=de/st,Oe=(_e-ne)/De,ut=(_e+1+ne)/De,it={features:[]};return this._addTileFeatures(je.range((se-ne)/De,Oe,(se+1+ne)/De,ut),je.data,se,_e,De,it),se===0&&this._addTileFeatures(je.range(1-ne/De,Oe,1,ut),je.data,De,_e,De,it),se===De-1&&this._addTileFeatures(je.range(0,Oe,ne/De,ut),je.data,-1,_e,De,it),it.features.length?it:null}getClusterExpansionZoom(ue){let se=this._getOriginZoom(ue)-1;for(;se<=this.options.maxZoom;){const _e=this.getChildren(ue);if(se++,_e.length!==1)break;ue=_e[0].properties.cluster_id}return se}_appendLeaves(ue,se,_e,je,De){const st=this.getChildren(se);for(const de of st){const ne=de.properties;if(ne&&ne.cluster?De+ne.point_count<=je?De+=ne.point_count:De=this._appendLeaves(ue,ne.cluster_id,_e,je,De):De<je?De++:ue.push(de),ue.length===_e)break}return De}_createTree(ue){const se=new p.K(ue.length/this.stride|0,this.options.nodeSize,Float32Array);for(let _e=0;_e<ue.length;_e+=this.stride)se.add(ue[_e],ue[_e+1]);return se.finish(),se.data=ue,se}_addTileFeatures(ue,se,_e,je,De,st){for(const de of ue){const ne=de*this.stride,Oe=se[ne+ae]>1;let ut,it,lt;if(Oe)ut=Ke(se,ne,this.clusterProps),it=se[ne],lt=se[ne+1];else{const Wt=this.points[se[ne+xe]];ut=Wt.properties;const[Ht,Dt]=Wt.geometry.coordinates;it=Fe(Ht),lt=ct(Dt)}const Et={type:1,geometry:[[Math.round(this.options.extent*(it*De-_e)),Math.round(this.options.extent*(lt*De-je))]],tags:ut};let Ut;Ut=Oe||this.options.generateId?se[ne+xe]:this.points[se[ne+xe]].id,Ut!==void 0&&(Et.id=Ut),st.features.push(Et)}}_limitZoom(ue){return Math.max(this.options.minZoom,Math.min(Math.floor(+ue),this.options.maxZoom+1))}_cluster(ue,se){const{radius:_e,extent:je,reduce:De,minPoints:st}=this.options,de=_e/(je*Math.pow(2,se)),ne=ue.data,Oe=[],ut=this.stride;for(let it=0;it<ne.length;it+=ut){if(ne[it+2]<=se)continue;ne[it+2]=se;const lt=ne[it],Et=ne[it+1],Ut=ue.within(ne[it],ne[it+1],de),Wt=ne[it+ae];let Ht=Wt;for(const Dt of Ut){const wt=Dt*ut;ne[wt+2]>se&&(Ht+=ne[wt+ae])}if(Ht>Wt&&Ht>=st){let Dt,wt=lt*Wt,Xt=Et*Wt,He=-1;const Pt=((it/ut|0)<<5)+(se+1)+this.points.length;for(const qt of Ut){const Nt=qt*ut;if(ne[Nt+2]<=se)continue;ne[Nt+2]=se;const hn=ne[Nt+ae];wt+=ne[Nt]*hn,Xt+=ne[Nt+1]*hn,ne[Nt+4]=Pt,De&&(Dt||(Dt=this._map(ne,it,!0),He=this.clusterProps.length,this.clusterProps.push(Dt)),De(Dt,this._map(ne,Nt)))}ne[it+4]=Pt,Oe.push(wt/Ht,Xt/Ht,1/0,Pt,-1,Ht),De&&Oe.push(He)}else{for(let Dt=0;Dt<ut;Dt++)Oe.push(ne[it+Dt]);if(Ht>1)for(const Dt of Ut){const wt=Dt*ut;if(!(ne[wt+2]<=se)){ne[wt+2]=se;for(let Xt=0;Xt<ut;Xt++)Oe.push(ne[wt+Xt])}}}}return Oe}_getOriginId(ue){return ue-this.points.length>>5}_getOriginZoom(ue){return(ue-this.points.length)%32}_map(ue,se,_e){if(ue[se+ae]>1){const st=this.clusterProps[ue[se+Ee]];return _e?Object.assign({},st):st}const je=this.points[ue[se+xe]].properties,De=this.options.map(je);return _e&&De===je?Object.assign({},De):De}}function Ze(Be,ue,se){return{type:"Feature",id:Be[ue+xe],properties:Ke(Be,ue,se),geometry:{type:"Point",coordinates:[(_e=Be[ue],360*(_e-.5)),Ct(Be[ue+1])]}};var _e}function Ke(Be,ue,se){const _e=Be[ue+ae],je=_e>=1e4?`${Math.round(_e/1e3)}k`:_e>=1e3?Math.round(_e/100)/10+"k":_e,De=Be[ue+Ee],st=De===-1?{}:Object.assign({},se[De]);return Object.assign(st,{cluster:!0,cluster_id:Be[ue+xe],point_count:_e,point_count_abbreviated:je})}function Fe(Be){return Be/360+.5}function ct(Be){const ue=Math.sin(Be*Math.PI/180),se=.5-.25*Math.log((1+ue)/(1-ue))/Math.PI;return se<0?0:se>1?1:se}function Ct(Be){const ue=(180-360*Be)*Math.PI/180;return 360*Math.atan(Math.exp(ue))/Math.PI-90}var kt={exports:{}};kt.exports=function(){function Be(we,Te,Ne,et){for(var tt,vt=et,ht=Ne-Te>>1,dt=Ne-Te,Vt=we[Te],It=we[Te+1],Qt=we[Ne],fn=we[Ne+1],en=Te+3;en<Ne;en+=3){var vn=ue(we[en],we[en+1],Vt,It,Qt,fn);if(vn>vt)tt=en,vt=vn;else if(vn===vt){var Vn=Math.abs(en-ht);Vn<dt&&(tt=en,dt=Vn)}}vt>et&&(tt-Te>3&&Be(we,Te,tt,et),we[tt+2]=vt,Ne-tt>3&&Be(we,tt,Ne,et))}function ue(we,Te,Ne,et,tt,vt){var ht=tt-Ne,dt=vt-et;if(ht!==0||dt!==0){var Vt=((we-Ne)*ht+(Te-et)*dt)/(ht*ht+dt*dt);Vt>1?(Ne=tt,et=vt):Vt>0&&(Ne+=ht*Vt,et+=dt*Vt)}return(ht=we-Ne)*ht+(dt=Te-et)*dt}function se(we,Te,Ne,et){var tt={id:we===void 0?null:we,type:Te,geometry:Ne,tags:et,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(vt){var ht=vt.geometry,dt=vt.type;if(dt==="Point"||dt==="MultiPoint"||dt==="LineString")_e(vt,ht);else if(dt==="Polygon"||dt==="MultiLineString")for(var Vt=0;Vt<ht.length;Vt++)_e(vt,ht[Vt]);else if(dt==="MultiPolygon")for(Vt=0;Vt<ht.length;Vt++)for(var It=0;It<ht[Vt].length;It++)_e(vt,ht[Vt][It])}(tt),tt}function _e(we,Te){for(var Ne=0;Ne<Te.length;Ne+=3)we.minX=Math.min(we.minX,Te[Ne]),we.minY=Math.min(we.minY,Te[Ne+1]),we.maxX=Math.max(we.maxX,Te[Ne]),we.maxY=Math.max(we.maxY,Te[Ne+1])}function je(we,Te,Ne,et){if(Te.geometry){var tt=Te.geometry.coordinates,vt=Te.geometry.type,ht=Math.pow(Ne.tolerance/((1<<Ne.maxZoom)*Ne.extent),2),dt=[],Vt=Te.id;if(Ne.promoteId?Vt=Te.properties[Ne.promoteId]:Ne.generateId&&(Vt=et||0),vt==="Point")De(tt,dt);else if(vt==="MultiPoint")for(var It=0;It<tt.length;It++)De(tt[It],dt);else if(vt==="LineString")st(tt,dt,ht,!1);else if(vt==="MultiLineString"){if(Ne.lineMetrics){for(It=0;It<tt.length;It++)st(tt[It],dt=[],ht,!1),we.push(se(Vt,"LineString",dt,Te.properties));return}de(tt,dt,ht,!1)}else if(vt==="Polygon")de(tt,dt,ht,!0);else{if(vt!=="MultiPolygon"){if(vt==="GeometryCollection"){for(It=0;It<Te.geometry.geometries.length;It++)je(we,{id:Vt,geometry:Te.geometry.geometries[It],properties:Te.properties},Ne,et);return}throw new Error("Input data is not a valid GeoJSON object.")}for(It=0;It<tt.length;It++){var Qt=[];de(tt[It],Qt,ht,!0),dt.push(Qt)}}we.push(se(Vt,vt,dt,Te.properties))}}function De(we,Te){Te.push(ne(we[0])),Te.push(Oe(we[1])),Te.push(0)}function st(we,Te,Ne,et){for(var tt,vt,ht=0,dt=0;dt<we.length;dt++){var Vt=ne(we[dt][0]),It=Oe(we[dt][1]);Te.push(Vt),Te.push(It),Te.push(0),dt>0&&(ht+=et?(tt*It-Vt*vt)/2:Math.sqrt(Math.pow(Vt-tt,2)+Math.pow(It-vt,2))),tt=Vt,vt=It}var Qt=Te.length-3;Te[2]=1,Be(Te,0,Qt,Ne),Te[Qt+2]=1,Te.size=Math.abs(ht),Te.start=0,Te.end=Te.size}function de(we,Te,Ne,et){for(var tt=0;tt<we.length;tt++){var vt=[];st(we[tt],vt,Ne,et),Te.push(vt)}}function ne(we){return we/360+.5}function Oe(we){var Te=Math.sin(we*Math.PI/180),Ne=.5-.25*Math.log((1+Te)/(1-Te))/Math.PI;return Ne<0?0:Ne>1?1:Ne}function ut(we,Te,Ne,et,tt,vt,ht,dt){if(et/=Te,vt>=(Ne/=Te)&&ht<et)return we;if(ht<Ne||vt>=et)return null;for(var Vt=[],It=0;It<we.length;It++){var Qt=we[It],fn=Qt.geometry,en=Qt.type,vn=tt===0?Qt.minX:Qt.minY,Vn=tt===0?Qt.maxX:Qt.maxY;if(vn>=Ne&&Vn<et)Vt.push(Qt);else if(!(Vn<Ne||vn>=et)){var ei=[];if(en==="Point"||en==="MultiPoint")it(fn,ei,Ne,et,tt);else if(en==="LineString")lt(fn,ei,Ne,et,tt,!1,dt.lineMetrics);else if(en==="MultiLineString")Ut(fn,ei,Ne,et,tt,!1);else if(en==="Polygon")Ut(fn,ei,Ne,et,tt,!0);else if(en==="MultiPolygon")for(var xi=0;xi<fn.length;xi++){var wi=[];Ut(fn[xi],wi,Ne,et,tt,!0),wi.length&&ei.push(wi)}if(ei.length){if(dt.lineMetrics&&en==="LineString"){for(xi=0;xi<ei.length;xi++)Vt.push(se(Qt.id,en,ei[xi],Qt.tags));continue}en!=="LineString"&&en!=="MultiLineString"||(ei.length===1?(en="LineString",ei=ei[0]):en="MultiLineString"),en!=="Point"&&en!=="MultiPoint"||(en=ei.length===3?"Point":"MultiPoint"),Vt.push(se(Qt.id,en,ei,Qt.tags))}}}return Vt.length?Vt:null}function it(we,Te,Ne,et,tt){for(var vt=0;vt<we.length;vt+=3){var ht=we[vt+tt];ht>=Ne&&ht<=et&&(Te.push(we[vt]),Te.push(we[vt+1]),Te.push(we[vt+2]))}}function lt(we,Te,Ne,et,tt,vt,ht){for(var dt,Vt,It=Et(we),Qt=tt===0?Ht:Dt,fn=we.start,en=0;en<we.length-3;en+=3){var vn=we[en],Vn=we[en+1],ei=we[en+2],xi=we[en+3],wi=we[en+4],pa=tt===0?vn:Vn,na=tt===0?xi:wi,Re=!1;ht&&(dt=Math.sqrt(Math.pow(vn-xi,2)+Math.pow(Vn-wi,2))),pa<Ne?na>Ne&&(Vt=Qt(It,vn,Vn,xi,wi,Ne),ht&&(It.start=fn+dt*Vt)):pa>et?na<et&&(Vt=Qt(It,vn,Vn,xi,wi,et),ht&&(It.start=fn+dt*Vt)):Wt(It,vn,Vn,ei),na<Ne&&pa>=Ne&&(Vt=Qt(It,vn,Vn,xi,wi,Ne),Re=!0),na>et&&pa<=et&&(Vt=Qt(It,vn,Vn,xi,wi,et),Re=!0),!vt&&Re&&(ht&&(It.end=fn+dt*Vt),Te.push(It),It=Et(we)),ht&&(fn+=dt)}var bt=we.length-3;vn=we[bt],Vn=we[bt+1],ei=we[bt+2],(pa=tt===0?vn:Vn)>=Ne&&pa<=et&&Wt(It,vn,Vn,ei),bt=It.length-3,vt&&bt>=3&&(It[bt]!==It[0]||It[bt+1]!==It[1])&&Wt(It,It[0],It[1],It[2]),It.length&&Te.push(It)}function Et(we){var Te=[];return Te.size=we.size,Te.start=we.start,Te.end=we.end,Te}function Ut(we,Te,Ne,et,tt,vt){for(var ht=0;ht<we.length;ht++)lt(we[ht],Te,Ne,et,tt,vt,!1)}function Wt(we,Te,Ne,et){we.push(Te),we.push(Ne),we.push(et)}function Ht(we,Te,Ne,et,tt,vt){var ht=(vt-Te)/(et-Te);return we.push(vt),we.push(Ne+(tt-Ne)*ht),we.push(1),ht}function Dt(we,Te,Ne,et,tt,vt){var ht=(vt-Ne)/(tt-Ne);return we.push(Te+(et-Te)*ht),we.push(vt),we.push(1),ht}function wt(we,Te){for(var Ne=[],et=0;et<we.length;et++){var tt,vt=we[et],ht=vt.type;if(ht==="Point"||ht==="MultiPoint"||ht==="LineString")tt=Xt(vt.geometry,Te);else if(ht==="MultiLineString"||ht==="Polygon"){tt=[];for(var dt=0;dt<vt.geometry.length;dt++)tt.push(Xt(vt.geometry[dt],Te))}else if(ht==="MultiPolygon")for(tt=[],dt=0;dt<vt.geometry.length;dt++){for(var Vt=[],It=0;It<vt.geometry[dt].length;It++)Vt.push(Xt(vt.geometry[dt][It],Te));tt.push(Vt)}Ne.push(se(vt.id,ht,tt,vt.tags))}return Ne}function Xt(we,Te){var Ne=[];Ne.size=we.size,we.start!==void 0&&(Ne.start=we.start,Ne.end=we.end);for(var et=0;et<we.length;et+=3)Ne.push(we[et]+Te,we[et+1],we[et+2]);return Ne}function He(we,Te){if(we.transformed)return we;var Ne,et,tt,vt=1<<we.z,ht=we.x,dt=we.y;for(Ne=0;Ne<we.features.length;Ne++){var Vt=we.features[Ne],It=Vt.geometry,Qt=Vt.type;if(Vt.geometry=[],Qt===1)for(et=0;et<It.length;et+=2)Vt.geometry.push(Pt(It[et],It[et+1],Te,vt,ht,dt));else for(et=0;et<It.length;et++){var fn=[];for(tt=0;tt<It[et].length;tt+=2)fn.push(Pt(It[et][tt],It[et][tt+1],Te,vt,ht,dt));Vt.geometry.push(fn)}}return we.transformed=!0,we}function Pt(we,Te,Ne,et,tt,vt){return[Math.round(Ne*(we*et-tt)),Math.round(Ne*(Te*et-vt))]}function qt(we,Te,Ne,et,tt){for(var vt=Te===tt.maxZoom?0:tt.tolerance/((1<<Te)*tt.extent),ht={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:Ne,y:et,z:Te,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},dt=0;dt<we.length;dt++){ht.numFeatures++,Nt(ht,we[dt],vt,tt);var Vt=we[dt].minX,It=we[dt].minY,Qt=we[dt].maxX,fn=we[dt].maxY;Vt<ht.minX&&(ht.minX=Vt),It<ht.minY&&(ht.minY=It),Qt>ht.maxX&&(ht.maxX=Qt),fn>ht.maxY&&(ht.maxY=fn)}return ht}function Nt(we,Te,Ne,et){var tt=Te.geometry,vt=Te.type,ht=[];if(vt==="Point"||vt==="MultiPoint")for(var dt=0;dt<tt.length;dt+=3)ht.push(tt[dt]),ht.push(tt[dt+1]),we.numPoints++,we.numSimplified++;else if(vt==="LineString")hn(ht,tt,we,Ne,!1,!1);else if(vt==="MultiLineString"||vt==="Polygon")for(dt=0;dt<tt.length;dt++)hn(ht,tt[dt],we,Ne,vt==="Polygon",dt===0);else if(vt==="MultiPolygon")for(var Vt=0;Vt<tt.length;Vt++){var It=tt[Vt];for(dt=0;dt<It.length;dt++)hn(ht,It[dt],we,Ne,!0,dt===0)}if(ht.length){var Qt=Te.tags||null;if(vt==="LineString"&&et.lineMetrics){for(var fn in Qt={},Te.tags)Qt[fn]=Te.tags[fn];Qt.mapbox_clip_start=tt.start/tt.size,Qt.mapbox_clip_end=tt.end/tt.size}var en={geometry:ht,type:vt==="Polygon"||vt==="MultiPolygon"?3:vt==="LineString"||vt==="MultiLineString"?2:1,tags:Qt};Te.id!==null&&(en.id=Te.id),we.features.push(en)}}function hn(we,Te,Ne,et,tt,vt){var ht=et*et;if(et>0&&Te.size<(tt?ht:et))Ne.numPoints+=Te.length/3;else{for(var dt=[],Vt=0;Vt<Te.length;Vt+=3)(et===0||Te[Vt+2]>ht)&&(Ne.numSimplified++,dt.push(Te[Vt]),dt.push(Te[Vt+1])),Ne.numPoints++;tt&&function(It,Qt){for(var fn=0,en=0,vn=It.length,Vn=vn-2;en<vn;Vn=en,en+=2)fn+=(It[en]-It[Vn])*(It[en+1]+It[Vn+1]);if(fn>0===Qt)for(en=0,vn=It.length;en<vn/2;en+=2){var ei=It[en],xi=It[en+1];It[en]=It[vn-2-en],It[en+1]=It[vn-1-en],It[vn-2-en]=ei,It[vn-1-en]=xi}}(dt,vt),we.push(dt)}}function be(we,Te){var Ne=(Te=this.options=function(tt,vt){for(var ht in vt)tt[ht]=vt[ht];return tt}(Object.create(this.options),Te)).debug;if(Ne&&console.time("preprocess data"),Te.maxZoom<0||Te.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(Te.promoteId&&Te.generateId)throw new Error("promoteId and generateId cannot be used together.");var et=function(tt,vt){var ht=[];if(tt.type==="FeatureCollection")for(var dt=0;dt<tt.features.length;dt++)je(ht,tt.features[dt],vt,dt);else je(ht,tt.type==="Feature"?tt:{geometry:tt},vt);return ht}(we,Te);this.tiles={},this.tileCoords=[],Ne&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",Te.indexMaxZoom,Te.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(et=function(tt,vt){var ht=vt.buffer/vt.extent,dt=tt,Vt=ut(tt,1,-1-ht,ht,0,-1,2,vt),It=ut(tt,1,1-ht,2+ht,0,-1,2,vt);return(Vt||It)&&(dt=ut(tt,1,-ht,1+ht,0,-1,2,vt)||[],Vt&&(dt=wt(Vt,1).concat(dt)),It&&(dt=dt.concat(wt(It,-1)))),dt}(et,Te)).length&&this.splitTile(et,0,0,0),Ne&&(et.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function Qe(we,Te,Ne){return 32*((1<<we)*Ne+Te)+we}return be.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},be.prototype.splitTile=function(we,Te,Ne,et,tt,vt,ht){for(var dt=[we,Te,Ne,et],Vt=this.options,It=Vt.debug;dt.length;){et=dt.pop(),Ne=dt.pop(),Te=dt.pop(),we=dt.pop();var Qt=1<<Te,fn=Qe(Te,Ne,et),en=this.tiles[fn];if(!en&&(It>1&&console.time("creation"),en=this.tiles[fn]=qt(we,Te,Ne,et,Vt),this.tileCoords.push({z:Te,x:Ne,y:et}),It)){It>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",Te,Ne,et,en.numFeatures,en.numPoints,en.numSimplified),console.timeEnd("creation"));var vn="z"+Te;this.stats[vn]=(this.stats[vn]||0)+1,this.total++}if(en.source=we,tt){if(Te===Vt.maxZoom||Te===tt)continue;var Vn=1<<tt-Te;if(Ne!==Math.floor(vt/Vn)||et!==Math.floor(ht/Vn))continue}else if(Te===Vt.indexMaxZoom||en.numPoints<=Vt.indexMaxPoints)continue;if(en.source=null,we.length!==0){It>1&&console.time("clipping");var ei,xi,wi,pa,na,Re,bt=.5*Vt.buffer/Vt.extent,Ot=.5-bt,Lt=.5+bt,zt=1+bt;ei=xi=wi=pa=null,na=ut(we,Qt,Ne-bt,Ne+Lt,0,en.minX,en.maxX,Vt),Re=ut(we,Qt,Ne+Ot,Ne+zt,0,en.minX,en.maxX,Vt),we=null,na&&(ei=ut(na,Qt,et-bt,et+Lt,1,en.minY,en.maxY,Vt),xi=ut(na,Qt,et+Ot,et+zt,1,en.minY,en.maxY,Vt),na=null),Re&&(wi=ut(Re,Qt,et-bt,et+Lt,1,en.minY,en.maxY,Vt),pa=ut(Re,Qt,et+Ot,et+zt,1,en.minY,en.maxY,Vt),Re=null),It>1&&console.timeEnd("clipping"),dt.push(ei||[],Te+1,2*Ne,2*et),dt.push(xi||[],Te+1,2*Ne,2*et+1),dt.push(wi||[],Te+1,2*Ne+1,2*et),dt.push(pa||[],Te+1,2*Ne+1,2*et+1)}}},be.prototype.getTile=function(we,Te,Ne){var et=this.options,tt=et.extent,vt=et.debug;if(we<0||we>24)return null;var ht=1<<we,dt=Qe(we,Te=(Te%ht+ht)%ht,Ne);if(this.tiles[dt])return He(this.tiles[dt],tt);vt>1&&console.log("drilling down to z%d-%d-%d",we,Te,Ne);for(var Vt,It=we,Qt=Te,fn=Ne;!Vt&&It>0;)It--,Qt=Math.floor(Qt/2),fn=Math.floor(fn/2),Vt=this.tiles[Qe(It,Qt,fn)];return Vt&&Vt.source?(vt>1&&console.log("found parent tile z%d-%d-%d",It,Qt,fn),vt>1&&console.time("drilling down"),this.splitTile(Vt.source,It,Qt,fn,we,Te,Ne),vt>1&&console.timeEnd("drilling down"),this.tiles[dt]?He(this.tiles[dt],tt):null):null},function(we,Te){return new be(we,Te)}}();var Kt=p.g(kt.exports);function At(Be,ue){const se=Be.tileID.canonical;if(!this._geoJSONIndex)return ue(null,null);const _e=this._geoJSONIndex.getTile(se.z,se.x,se.y);if(!_e)return ue(null,null);const je=new class{constructor(st){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=p.E,this.length=st.length,this._features=st}feature(st){return new class{constructor(de){this._feature=de,this.extent=p.E,this.type=de.type,this.properties=de.tags,"id"in de&&!isNaN(de.id)&&(this.id=parseInt(de.id,10))}loadGeometry(){if(this._feature.type===1){const de=[];for(const ne of this._feature.geometry)de.push([new p.P(ne[0],ne[1])]);return de}{const de=[];for(const ne of this._feature.geometry){const Oe=[];for(const ut of ne)Oe.push(new p.P(ut[0],ut[1]));de.push(Oe)}return de}}toGeoJSON(de,ne,Oe){return R.call(this,de,ne,Oe)}}(this._features[st])}}(_e.features);let De=Ie(je);De.byteOffset===0&&De.byteLength===De.buffer.byteLength||(De=new Uint8Array(De)),ue(null,{vectorTile:je,rawData:De.buffer})}class Pe extends p.d{constructor(ue,se,_e,je,De,st){super(ue,se,_e,je,At,st),De&&(this.loadGeoJSON=De)}loadData(ue,se){const _e=ue&&ue.request,je=_e&&_e.collectResourceTiming;this.loadGeoJSON(ue,(De,st)=>{if(De||!st)return se(De);if(typeof st!="object")return se(new Error(`Input data given to '${ue.source}' is not a valid GeoJSON object.`));{I(st,!0);try{if(ue.filter){const ne=p.e(ue.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(ne.result==="error")throw new Error(ne.value.map(ut=>`${ut.key}: ${ut.message}`).join(", "));st={type:"FeatureCollection",features:st.features.filter(ut=>ne.value.evaluate({zoom:0},ut))}}this._geoJSONIndex=ue.cluster?new Je(function({superclusterOptions:ne,clusterProperties:Oe}){if(!Oe||!ne)return ne;const ut={},it={},lt={accumulated:null,zoom:0},Et={properties:null},Ut=Object.keys(Oe);for(const Wt of Ut){const[Ht,Dt]=Oe[Wt],wt=p.e(Dt),Xt=p.e(typeof Ht=="string"?[Ht,["accumulated"],["get",Wt]]:Ht);ut[Wt]=wt.value,it[Wt]=Xt.value}return ne.map=Wt=>{Et.properties=Wt;const Ht={};for(const Dt of Ut)Ht[Dt]=ut[Dt].evaluate(lt,Et);return Ht},ne.reduce=(Wt,Ht)=>{Et.properties=Ht;for(const Dt of Ut)lt.accumulated=Wt[Dt],Wt[Dt]=it[Dt].evaluate(lt,Et)},ne}(ue)).load(st.features):Kt(st,ue.geojsonVtOptions)}catch(ne){return se(ne)}this.loaded={};const de={};if(je){const ne=p.f(_e);ne&&(de.resourceTiming={},de.resourceTiming[ue.source]=JSON.parse(JSON.stringify(ne)))}se(null,de)}})}reloadTile(ue,se){const _e=this.loaded;return _e&&_e[ue.uid]?super.reloadTile(ue,se):this.loadTile(ue,se)}loadGeoJSON(ue,se){if(ue.request)p.h(ue.request,se);else{if(typeof ue.data!="string")return se(new Error(`Input data given to '${ue.source}' is not a valid GeoJSON object.`));try{return se(null,JSON.parse(ue.data))}catch{return se(new Error(`Input data given to '${ue.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(ue,se){try{se(null,this._geoJSONIndex.getClusterExpansionZoom(ue.clusterId))}catch(_e){se(_e)}}getClusterChildren(ue,se){try{se(null,this._geoJSONIndex.getChildren(ue.clusterId))}catch(_e){se(_e)}}getClusterLeaves(ue,se){try{se(null,this._geoJSONIndex.getLeaves(ue.clusterId,ue.limit,ue.offset))}catch(_e){se(_e)}}}class ft{constructor(ue,se){this.tileID=new p.O(ue.tileID.overscaledZ,ue.tileID.wrap,ue.tileID.canonical.z,ue.tileID.canonical.x,ue.tileID.canonical.y),this.tileZoom=ue.tileZoom,this.uid=ue.uid,this.zoom=ue.zoom,this.canonical=ue.tileID.canonical,this.pixelRatio=ue.pixelRatio,this.tileSize=ue.tileSize,this.source=ue.source,this.overscaling=this.tileID.overscaleFactor(),this.projection=ue.projection,this.brightness=se}async parse(ue,se,_e,je){this.status="parsing";const De=new p.O(_e.tileID.overscaledZ,_e.tileID.wrap,_e.tileID.canonical.z,_e.tileID.canonical.x,_e.tileID.canonical.y),st={},de=se.familiesBySource[_e.source],ne=new p.F(De,_e.promoteId);ne.bucketLayerIDs=[];const Oe=await p.l(ue).catch(Et=>je(new Error(Et.message)));if(!Oe)return je(new Error("Could not parse tile"));const ut=p.j(Oe,1/p.t(_e.tileID.canonical)),it=Oe.json.extensionsUsed&&Oe.json.extensionsUsed.includes("MAPBOX_mesh_features"),lt=new p.k(this.zoom,{brightness:this.brightness});for(const Et in de)for(const Ut of de[Et]){const Wt=Ut[0],Ht=Oe.json.extensionsUsed;Wt.recalculate(lt,[]);const Dt=new p.T(ut,De,Ht&&Ht.includes("MAPBOX_mesh_features"),this.brightness);it||(Dt.needsUpload=!0),st[Wt.fqid]=Dt,Dt.evaluate(Wt)}this.status="done",je(null,{buckets:st,featureIndex:ne})}}class gt{constructor(ue,se,_e,je,De,st){this.actor=ue,this.layerIndex=se,this.brightness=st,this.loading={},this.loaded={}}loadTile(ue,se){const _e=ue.uid,je=this.loading[_e]=new ft(ue,this.brightness);p.i(ue.request,(De,st)=>{const de=!this.loading[_e];return delete this.loading[_e],de||De?(je.status="done",de||(this.loaded[_e]=je),se(De)):st&&st.byteLength!==0?void je.parse(st,this.layerIndex,ue,(ne,Oe)=>{je.status="done",this.loaded=this.loaded||{},this.loaded[_e]=je,ne||!Oe?se(ne):se(null,Oe)}):(je.status="done",this.loaded[_e]=je,se())})}reloadTile(ue,se){const _e=this.loaded,je=ue.uid;if(_e&&_e[je]){const De=_e[je];De.projection=ue.projection,De.brightness=ue.brightness;const st=(de,ne)=>{De.reloadCallback&&(delete De.reloadCallback,this.loadTile(ue,se)),se(de,ne)};De.status==="parsing"?De.reloadCallback=st:De.status==="done"&&this.loadTile(ue,se)}}abortTile(ue,se){const _e=ue.uid;this.loading[_e]&&delete this.loading[_e],se()}removeTile(ue,se){const _e=this.loaded,je=ue.uid;_e&&_e[je]&&delete _e[je],se()}}class _t{constructor(ue){this.self=ue,this.actor=new p.A(ue,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=p.m({name:"mercator"}),this.workerSourceTypes={vector:p.d,geojson:Pe,"batched-model":gt},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(se,_e)=>{if(this.workerSourceTypes[se])throw new Error(`Worker source with name "${se}" already registered.`);this.workerSourceTypes[se]=_e},this.self.registerRTLTextPlugin=se=>{if(p.n.isParsed())throw new Error("RTL text plugin already registered.");p.n.applyArabicShaping=se.applyArabicShaping,p.n.processBidirectionalText=se.processBidirectionalText,p.n.processStyledBidirectionalText=se.processStyledBidirectionalText}}clearCaches(ue,se,_e){delete this.layerIndexes[ue],delete this.availableImages[ue],delete this.workerSources[ue],delete this.demWorkerSources[ue],_e()}checkIfReady(ue,se,_e){_e()}setReferrer(ue,se){this.referrer=se}spriteLoaded(ue,{scope:se,isLoaded:_e}){if(this.isSpriteLoaded[ue]||(this.isSpriteLoaded[ue]={}),this.isSpriteLoaded[ue][se]=_e,this.workerSources[ue]&&this.workerSources[ue][se])for(const je in this.workerSources[ue][se]){const De=this.workerSources[ue][se][je];for(const st in De)De[st]instanceof p.d&&(De[st].isSpriteLoaded=_e,De[st].fire(new p.o("isSpriteLoaded")))}}setImages(ue,{scope:se,images:_e},je){if(this.availableImages[ue]||(this.availableImages[ue]={}),this.availableImages[ue][se]=_e,this.workerSources[ue]&&this.workerSources[ue][se]){for(const De in this.workerSources[ue][se]){const st=this.workerSources[ue][se][De];for(const de in st)st[de].availableImages=_e}je()}else je()}setProjection(ue,se){this.projections[ue]=p.m(se)}setBrightness(ue,se,_e){this.brightness=se,_e()}setLayers(ue,se,_e){this.getLayerIndex(ue,se.scope).replace(se.layers,se.options),_e()}updateLayers(ue,se,_e){this.getLayerIndex(ue,se.scope).update(se.layers,se.removedIds,se.options),_e()}loadTile(ue,se,_e){se.projection=this.projections[ue]||this.defaultProjection,this.getWorkerSource(ue,se.type,se.source,se.scope).loadTile(se,_e)}loadDEMTile(ue,se,_e){this.getDEMWorkerSource(ue,se.source,se.scope).loadTile(se,_e)}reloadTile(ue,se,_e){se.projection=this.projections[ue]||this.defaultProjection,this.getWorkerSource(ue,se.type,se.source,se.scope).reloadTile(se,_e)}abortTile(ue,se,_e){this.getWorkerSource(ue,se.type,se.source,se.scope).abortTile(se,_e)}removeTile(ue,se,_e){this.getWorkerSource(ue,se.type,se.source,se.scope).removeTile(se,_e)}removeSource(ue,se,_e){if(!(this.workerSources[ue]&&this.workerSources[ue][se.scope]&&this.workerSources[ue][se.scope][se.type]&&this.workerSources[ue][se.scope][se.type][se.source]))return;const je=this.workerSources[ue][se.scope][se.type][se.source];delete this.workerSources[ue][se.scope][se.type][se.source],je.removeSource!==void 0?je.removeSource(se,_e):_e()}loadWorkerSource(ue,se,_e){try{this.self.importScripts(se.url),_e()}catch(je){_e(je.toString())}}syncRTLPluginState(ue,se,_e){try{p.n.setState(se);const je=p.n.getPluginURL();if(p.n.isLoaded()&&!p.n.isParsed()&&je!=null){this.self.importScripts(je);const De=p.n.isParsed();_e(De?void 0:new Error(`RTL Text Plugin failed to import scripts from ${je}`),De)}}catch(je){_e(je.toString())}}setDracoUrl(ue,se){this.dracoUrl=se}getAvailableImages(ue,se){this.availableImages[ue]||(this.availableImages[ue]={});let _e=this.availableImages[ue][se];return _e||(_e=[]),_e}getLayerIndex(ue,se){this.layerIndexes[ue]||(this.layerIndexes[ue]={});let _e=this.layerIndexes[ue][se];return _e||(_e=this.layerIndexes[ue][se]=new _,_e.scope=se),_e}getWorkerSource(ue,se,_e,je){if(this.workerSources[ue]||(this.workerSources[ue]={}),this.workerSources[ue][je]||(this.workerSources[ue][je]={}),this.workerSources[ue][je][se]||(this.workerSources[ue][je][se]={}),this.isSpriteLoaded[ue]||(this.isSpriteLoaded[ue]={}),!this.workerSources[ue][je][se][_e]){const De={send:(st,de,ne,Oe,ut,it)=>{this.actor.send(st,de,ne,ue,ut,it)},scheduler:this.actor.scheduler};this.workerSources[ue][je][se][_e]=new this.workerSourceTypes[se](De,this.getLayerIndex(ue,je),this.getAvailableImages(ue,je),this.isSpriteLoaded[ue][je],void 0,this.brightness)}return this.workerSources[ue][je][se][_e]}getDEMWorkerSource(ue,se,_e){return this.demWorkerSources[ue]||(this.demWorkerSources[ue]={}),this.demWorkerSources[ue][_e]||(this.demWorkerSources[ue][_e]={}),this.demWorkerSources[ue][_e][se]||(this.demWorkerSources[ue][_e][se]=new x),this.demWorkerSources[ue][_e][se]}enforceCacheSizeLimit(ue,se){p.q(se)}getWorkerPerformanceMetrics(ue,se,_e){_e(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new _t(self)),_t}),l(["./shared"],function(p){return p.s});var d=s;return d})})(UK);var VMe=UK.exports;const Ed=Iw(VMe);const GMe=({setMap:n,setSelectedCity:e})=>{Ed.accessToken="pk.eyJ1Ijoic3RhbnJvbnpoaW4iLCJhIjoiY2xvaGF3ZmFzMWdodDJxbjByeHMzanE2dCJ9.3uz_EG8N_d7isS1h5wV46w";const i=ie.useRef(null),o=ie.useRef(null),[s,l]=ie.useState(!1);let d=null;return ie.useEffect(()=>{o.current||!i.current||(o.current=new Ed.Map({attributionControl:!1,container:i.current,style:"mapbox://styles/stanronzhin/clok1b9my006901o4gkfc25b2",center:[30,40],zoom:2,pitch:25}),o.current.on("load",()=>{o.current&&(o.current.addSource("city_points",{type:"geojson",data:"data/esg_city_points.geojson",cluster:!0,clusterMaxZoom:7,clusterRadius:20}).addSource("city_clusters",{type:"geojson",data:"data/esg_urban_clusters.geojson"}),o.current.addLayer({id:"city_point_clusters",type:"circle",source:"city_points",filter:["has","point_count"],paint:{"circle-color":["step",["get","point_count"],"#f7f7f7",100,"#f1f075",750,"#f28cb1"],"circle-radius":["step",["get","point_count"],15,100,30,750,40]}}),o.current.addLayer({id:"city_point_cluster-count",type:"symbol",source:"city_points",filter:["has","point_count"],layout:{"text-field":["get","point_count_abbreviated"],"text-font":["Suisse Intl Regular","Arial Unicode MS Bold"],"text-size":20}}),o.current.addLayer({id:"city_point_points",type:"symbol",source:"city_points",paint:{},layout:{"icon-image":["match",["get","Category"],["C1"],"esg_point_C1",["C3"],"esg_point_C3",["B2"],"esg_point_B2",["B3"],"esg_point_B3",["C2"],"esg_point_C2",["A1"],"esg_point_A1",["A2"],"esg_point_A2",["A3"],"esg_point_A3",["B1"],"esg_point_B1","esg_point_new"],"icon-size":["interpolate",["linear"],["zoom"],1,.35,2,.5,3,.6,6,.7,10,.8,22,.7]},filter:["!",["has","point_count"]]},"city_point_cluster-count"),o.current.addLayer({id:"city_point_labels",type:"symbol",source:"city_points",layout:{"text-line-height":0,"text-size":["interpolate",["linear"],["zoom"],0,12,1,15,2,20,3,25,6,30,10,35,22,25],"text-radial-offset":0,"symbol-avoid-edges":!0,"text-font":["Suisse Intl Regular","Arial Unicode MS Regular"],"text-offset":[0,-1.2],"text-anchor":"bottom","text-field":["to-string",["get","City_Name"]]},paint:{"text-color":"#ffffff"}}),o.current.addLayer({id:"city_cluster_hover",source:"city_clusters",type:"fill",paint:{"fill-color":"#ffffff","fill-opacity":["case",["boolean",["feature-state","hover"],!1],0,.07]}}),o.current.addLayer({id:"city_cluster_line",source:"city_clusters",type:"line",paint:{"line-color":"#ffffff","line-opacity":["interpolate",["linear"],["zoom"],0,0,8,0,10,1,22,1]}}),o.current.on("click","city_point_clusters",p=>{const f=o.current.queryRenderedFeatures(p.point,{layers:["city_point_clusters"]}),y=f[0].properties.cluster_id;p.features[0].properties.City_Name,o.current.getSource("city_points").getClusterExpansionZoom(y,(_,x)=>{_||o.current.easeTo({center:f[0].geometry.coordinates,zoom:x+3.2,duration:3e3})})}),o.current.on("click","city_point_labels",p=>{o.current&&o.current.flyTo({center:JSON.parse(p.features[0].properties.center),zoom:p.features[0].properties.zoom,bearing:p.features[0].properties.bearing,pitch:p.features[0].properties.pitch,essential:!0})}),o.current.on("click","city_point_points",p=>{if(!o.current)return;const f=p.features[0].properties.City_Name;e(f),o.current.flyTo({center:JSON.parse(p.features[0].properties.center),zoom:p.features[0].properties.zoom,bearing:p.features[0].properties.bearing,pitch:p.features[0].properties.pitch,essential:!0})}),o.current.on("mouseenter","city_point_labels",()=>{o.current&&(o.current.getCanvas().style.cursor="pointer")}),o.current.on("mouseenter","city_point_points",()=>{o.current&&(o.current.getCanvas().style.cursor="pointer")}),o.current.on("mouseleave","city_point_labels",()=>{o.current&&(o.current.getCanvas().style.cursor="")}),o.current.on("mouseleave","city_point_points",()=>{o.current&&(o.current.getCanvas().style.cursor="")}),o.current.on("mouseenter","city_point_clusters",()=>{o.current&&(o.current.getCanvas().style.cursor="pointer")}),o.current.on("mouseleave","city_point_clusters",()=>{o.current&&(o.current.getCanvas().style.cursor="")}),o.current.on("click","city_cluster_hover",p=>{o.current&&p.features[0].properties.City_Name}),o.current.on("mousemove","city_cluster_hover",p=>{if(p.features.length>0){if(!o.current)return;d!==null&&o.current.setFeatureState({source:"city_clusters",id:d},{hover:!1}),d=p.features[0].id,o.current.setFeatureState({source:"city_clusters",id:d},{hover:!0})}}),o.current.on("mouseleave","city_cluster_hover",()=>{if(d!==null){if(!o.current)return;o.current.setFeatureState({source:"city_clusters",id:d},{hover:!1})}d=null}))}),n(o.current))},[]),ie.useEffect(()=>{o.current&&o.current.easeTo({center:[55,25],duration:5e3,zoom:2.5,pitch:15,easing:p=>p})},[s]),X("div",{ref:i,style:{position:"absolute",top:0,left:0,width:"100%",height:"100%"}})},_I=({color:n,title:e,value:i,status:o})=>{const{classes:s}=kT();return $e("div",{className:s.statItem,children:[X("div",{className:s.statTitle,children:e}),X("div",{className:s.statValue,children:i}),X("div",{className:s.statStatus,style:{color:n,borderColor:`${n}30`},children:o})]})},Hs={VERY_LOW:"#FF3B29",LOW:"#FF632F",AVERAGE:"#FF9B3F",STRONG:"#A0DA8B",VERY_STRONG:"#35CB00"},uu=({label:n,status:e,style:i})=>{const{classes:o}=kT();return e?$e("div",{className:o.smallRowWrapper,children:[$e("div",{style:{display:"block",float:"left",height:"100%",padding:"8px 0",marginRight:"3vh",width:"14vh"},children:[" ",X("div",{className:o.statsSmallText,style:i,children:n})]}),X("div",{style:{flex:1,display:"flex",justifyContent:"flex-start"},children:X("div",{className:o.statStatus,style:{color:Hs[e.toUpperCase()],borderColor:`${Hs[e.toUpperCase()]}30`},children:e})})]}):null},pM={A1:"#35CB00",A2:"#75D652",A3:"#B7DE86",B1:"#ECE38E",B2:"#FFD748",B3:"#FFC700",C1:"#FF9B3F",C2:"#FF632F",C3:"#F74B3C"},f0=({label:n,subLabel:e,status:i,isFirst:o})=>{const{classes:s}=kT();if(!i)return null;const l=i.replace("-","").toUpperCase();return $e("div",{style:{display:"flex",flexDirection:"column",gap:"1.3vh",alignItems:o?"flex-start":"center"},children:[X("div",{className:s.statsBigText,style:{textAlign:o?"left":"center"},children:n==="Urban resilience index"?$e("div",{children:["Urban",X("br",{}),"resilience index"]}):n}),e&&X("div",{className:s.lowOpacityLabel,style:{marginTop:"-.6vh"},children:e}),X("div",{className:s.statStatusBig,style:{color:"#fff",marginTop:o?"0":"1.5vh",padding:"1vh 3vh",backgroundColor:o?pM[l]:"rgba(255, 255, 255, 0.07)"},children:i})]})},HMe=[{type:"Feature",properties:{fid:76,City_Name:"Amman",center:[35.96718879043169,32.00280698304451],zoom:10.000000000000009,bearing:101.60000000000173,pitch:49.99999999999967,vscale:.7},geometry:{type:"Point",coordinates:[35.91933631448545,31.951386464751504]}},{type:"Feature",properties:{fid:336,City_Name:"Mexico City",center:[-99.09309081576346,19.34983411479375],zoom:9.867175623863696,bearing:0,pitch:38.1352704054439,vscale:.9},geometry:{type:"Point",coordinates:[-99.1010915812256,19.457659604398632]}},{type:"Feature",properties:{fid:799,City_Name:"Bangkok",center:[100.50324135863775,13.719555607290715],zoom:9.818587811931847,bearing:0,pitch:50,vscale:1},geometry:{type:"Point",coordinates:[100.56813228239119,13.778801078899539]}},{type:"Feature",properties:{fid:892,City_Name:"Panama City",center:[-79.48226179199627,9.083198866519695],zoom:10.591526871591094,bearing:-20.799999999999727,pitch:47.51373809516402,vscale:.7},geometry:{type:"Point",coordinates:[-79.49751526014956,9.013829150641525]}},{type:"Feature",properties:{fid:1165,City_Name:"Colombo",center:[80.07050699310525,6.823336439561302],zoom:9.81,bearing:-20.000000000000114,pitch:62,vscale:.9},geometry:{type:"Point",coordinates:[79.9583239444924,6.932357722680249]}},{type:"Feature",properties:{fid:2311,City_Name:"Jakarta",center:[106.82667518481037,-6.350464399947057],zoom:9.099467639422393,bearing:-153.5999999999998,pitch:46.99999999999997,vscale:1},geometry:{type:"Point",coordinates:[106.81547517179841,-6.172653326038387]}},{type:"Feature",properties:{fid:2873,City_Name:"Cape Town",center:[18.579160832283065,-33.973034474213975],zoom:10.174985293257919,bearing:0,pitch:39.98000000000012,vscale:.8},geometry:{type:"Point",coordinates:[18.600086702400798,-33.98288982976307]}},{type:"Feature",properties:{fid:10,City_Name:"Valparaiso",center:[-71.48427166516629,-33.02603685224794],zoom:10.663321631643026,bearing:167.86383725437076,pitch:41.000000000000135,vscale:1.5,Category:"C1"},geometry:{type:"Point",coordinates:[-71.62739583920451,-33.0425755449797]}},{type:"Feature",properties:{fid:11,City_Name:"Natal",center:[-35.25026461835907,-5.795680924221671],zoom:11.194733819711187,bearing:-151.19999999999965,pitch:43.980000000000125,vscale:.7,Category:"B2"},geometry:{type:"Point",coordinates:[-35.21222333226075,-5.814877064286144]}},{type:"Feature",properties:{fid:12,City_Name:"Dar es Salaam",center:[39.179162094870094,-6.884904593781215],zoom:9.51190944357489,bearing:0,pitch:52,vscale:.6,Category:"C2"},geometry:{type:"Point",coordinates:[39.21870804117781,-6.825200004764525]}},{type:"Feature",properties:{fid:13,City_Name:"Brazzaville",center:[15.286496264601823,-4.2411132990048515],zoom:11.378416402173768,bearing:-76.7999999999999,pitch:47.499999999999844,vscale:.15,Category:"C1"},geometry:{type:"Point",coordinates:[15.268282806301356,-4.253046135825453]}},{type:"Feature",properties:{fid:14,City_Name:"Dubai",center:[55.33641246251963,25.078748811928463],zoom:9.591526871591089,bearing:0,pitch:56.98,vscale:1,Category:"A2"},geometry:{type:"Point",coordinates:[55.23468568314278,25.177065811310452]}},{type:"Feature",properties:{fid:15,City_Name:"Expo City Dubai",center:[55.33641246251963,25.078748811928463],zoom:9.591526871591089,bearing:0,pitch:56.98,vscale:1,Category:"A3"},geometry:{type:"Point",coordinates:[55.15094645583921,24.96152906476464]}},{type:"Feature",properties:{fid:16,City_Name:"Almaty",center:[76.88647818381759,43.256008733418724],zoom:10.249467639422363,bearing:0,pitch:44.97999999999996,vscale:1.5,Category:"B1"},geometry:{type:"Point",coordinates:[76.8984883098032,43.26555910249282]}},{type:"Feature",properties:{fid:17,City_Name:"Adoni",center:[77.2747162313259,15.633478866808957],zoom:11.643190533205994,bearing:0,pitch:44.94535508727158,vscale:.35,Category:"C2"},geometry:{type:"Point",coordinates:[77.27318970081716,15.62514604003816]}}],jMe=({selectedCityName:n})=>{Ed.accessToken="pk.eyJ1Ijoic3RhbnJvbnpoaW4iLCJhIjoiY2xvaGF3ZmFzMWdodDJxbjByeHMzanE2dCJ9.3uz_EG8N_d7isS1h5wV46w";const e=ie.useRef(null),i=ie.useRef(null);return ie.useEffect(()=>{var s;if(i.current||!e.current)return;const o=(s=HMe.find(l=>l.properties.City_Name===n))==null?void 0:s.properties;i.current=new Ed.Map({attributionControl:!1,container:e.current,style:"mapbox://styles/stanronzhin/clpdlsmlk00bt01p9e53lgin4",center:o==null?void 0:o.center,zoom:o==null?void 0:o.zoom,bearing:o==null?void 0:o.bearing,pitch:o==null?void 0:o.pitch}),i.current.on("load",()=>{if(!i.current)return;i.current.resize();let l,d,p=!1;function f(y){l===void 0&&(l=y);const _=y-l;if(d!==y){const x=Math.min((o==null?void 0:o.vscale)/2500*_,o==null?void 0:o.vscale);i.current.setPaintProperty("bars-14-cities-shp-8gys15","fill-extrusion-vertical-scale",x),x===1&&(p=!0)}_<2500&&(d=y,p||requestAnimationFrame(f))}f(0)})},[]),X("div",{ref:e,style:{pointerEvents:"none",position:"absolute",top:"20vh",right:"0",width:"60%",height:"80vh"}})},Us={Adoni:"Adoni_IEC_A&S_Report.pdf",Almaty:"Almaty_IEC_A&S_Report.pdf",Brazzaville:"Brazzaville_IEC_A&S_Report.pdf",DarEsSalaam:"Dar es Salaam_IEC_A&S_Report.pdf",DubaiExpo:"Dubai_Expo_IEC_A&S_Report.pdf",Dubai:"Dubai_IEC_A&S_Report.pdf",Natal:"Natal_IEC_A&S_Report.pdf",Valparaiso:"Valparaiso_IEC_A&S_Report.pdf"},H6=[{City:"Dubai",Country:"UAE","Text description":"Largest city of the UAE, one of the main global cities",Population:"4 865 222","Population description":"large","Population density":40.6,"Population density description":"medium","Population city proper":"3 549 900","Population density city proper":22.049068322981366,Climate:"28°C, 14 kph, 68 mm ","Climate description":"Arid, desert, hot","Urban Resilience Index":"A-3",Environmental:"Strong",Social:"Strong",Governmental:"Strong","Current state":"Very strong","Ability & Willingness":"Average","Basic needs Scope":"A-2","Natural Risk Exposure":"Strong","Transport Resilience Index":"Strong","Urban Sentiment Index":"Average","Poverty headcount ratio at national poverty lines":.053,"Poverty headcount ratio at national poverty lines description":"strong","Mean salary":"7 854","Mean salary description":"very strong","Literacy rate among population":.97,"Literacy rate among population description":"very strong","Air pollution":"Low","Water pollution":"Strong","Land use and waste":"Very strong","Natural disaster hazards":"Very strong","Water availability":"Strong","Food availability":"Very strong","Energy availability":"Strong",Health:"Strong",Education:"Very strong",Wealth:"Very strong",Safety:"Very strong",Livability:"Very strong",Transport:"Very strong",Inclusion:"Low",Accountability:"Very strong","City budget":"Strong",SME:"Strong","Public services":"Very strong","Sustainability commitment":"Very strong",Satisfaction:"Average",Efficiency:"Strong",Accessibility:"Strong",Safety_1:"Very strong",Affordability:"Low","Environmental impact":"Very low",tr_graph:{Satisfaction:3,Efficiency:4,Accessibility:4,Safety:5,Affordability:2,"Environmental impact":1},images:["/assets/Dubai/1.jpg","/assets/Dubai/2.jpg","/assets/Dubai/3.jpg","/assets/Dubai/4.jpg","/assets/Dubai/5.jpg"],pdfName:Us.Dubai},{City:"Expo City Dubai",Country:"UAE","Text description":"New city of innovation and advanced technologies",Population:"2 275","Population description":"small","Population density":8.8,"Population density description":"small","Population city proper":"2 275","Population density city proper":8.8,Climate:"28°C, 14 kph, 68 mm ","Climate description":"Arid, desert, hot","Urban Resilience Index":"A-2",Environmental:"Strong",Social:"Strong",Governmental:"Strong","Current state":"Very strong","Ability & Willingness":"Average","Basic needs Scope":"A-2","Natural Risk Exposure":"Strong","Transport Resilience Index":"Very strong","Urban Sentiment Index":"Strong","Poverty headcount ratio at national poverty lines":0,"Poverty headcount ratio at national poverty lines description":"very strong","Mean salary":"7 854","Mean salary description":"very strong","Literacy rate among population":.97,"Literacy rate among population description":"very strong","Air pollution":"Low","Water pollution":"Strong","Land use and waste":"Strong","Natural disaster hazards":"Very strong","Water availability":"Strong","Food availability":"Very strong","Energy availability":"Strong",Health:"Strong",Education:"Very strong",Wealth:"Very strong",Safety:"Very strong",Livability:"Very strong",Transport:"Very strong",Inclusion:"Low",Accountability:"Very strong","City budget":"Strong",SME:"Strong","Public services":"Very strong","Sustainability commitment":"Very strong",Satisfaction:"Very strong",Efficiency:"Very strong",Accessibility:"Strong",Safety_1:"Very strong",Affordability:"Low","Environmental impact":"Very low",tr_graph:{Satisfaction:5,Efficiency:5,Accessibility:4,Safety:5,Affordability:2,"Environmental impact":1},images:["/assets/Expo/1.jpg","/assets/Expo/2.jpg","/assets/Expo/3.jpg","/assets/Expo/4.jpg","/assets/Expo/5.jpg"],pdfName:Us.DubaiExpo},{City:"Valparaiso",Country:"Chile","Text description":"Second largest city of the country, the major Chile's port",Population:"965 937","Population description":"large","Population density":41.7,"Population density description":"medium","Population city proper":"252 888","Population density city proper":52.739937434827944,Climate:"14°C, 16 kph, 345 mm ","Climate description":"Temperate, dry and warm summer","Urban Resilience Index":"C-1",Environmental:"Low",Social:"Low",Governmental:"Low","Current state":"Very low","Ability & Willingness":"Average","Basic needs Scope":"B-2","Natural Risk Exposure":"Average","Transport Resilience Index":"Strong","Urban Sentiment Index":"Very strong","Poverty headcount ratio at national poverty lines":.21,"Poverty headcount ratio at national poverty lines description":"low","Mean salary":"11 082","Mean salary description":"very strong","Literacy rate among population":.992,"Literacy rate among population description":"very strong","Air pollution":"Low","Water pollution":"Strong","Land use and waste":"Average","Natural disaster hazards":"Very strong","Water availability":"Average","Food availability":"Strong","Energy availability":"Very strong",Health:"Average",Education:"Average",Wealth:"Average",Safety:"Low",Livability:"Low",Transport:"Low",Inclusion:"Strong",Accountability:"Very low","City budget":"Average",SME:"Very low","Public services":"Very strong","Sustainability commitment":"Very strong",Satisfaction:"Strong",Efficiency:"Low",Accessibility:"Average",Safety_1:"Strong",Affordability:"Average","Environmental impact":"Low",tr_graph:{Satisfaction:4,Efficiency:2,Accessibility:3,Safety:4,Affordability:3,"Environmental impact":2},images:["/assets/Valparaiso/1.jpg","/assets/Valparaiso/2.jpg","/assets/Valparaiso/3.jpg","/assets/Valparaiso/4.jpg","/assets/Valparaiso/5.jpg"],pdfName:Us.Valparaiso},{City:"Dar es Salaam",Country:"Tanzania","Text description":"Largest city of the country, one of the Africa's main centres",Population:"9 314 731","Population description":"very large","Population density":71.9,"Population density description":"large","Population city proper":"5 383 728","Population density city proper":163.14327272727272,Climate:"27°C, 17 kph, 1 114 mm ","Climate description":"Tropical, dry winter","Urban Resilience Index":"C-2",Environmental:"Low",Social:"Low",Governmental:"Low","Current state":"Very low","Ability & Willingness":"Very low","Basic needs Scope":"C-1","Natural Risk Exposure":"Average","Transport Resilience Index":"Very low","Urban Sentiment Index":"Low","Poverty headcount ratio at national poverty lines":.333,"Poverty headcount ratio at national poverty lines description":"very low","Mean salary":199,"Mean salary description":"very low","Literacy rate among population":.867,"Literacy rate among population description":"strong","Air pollution":"Average","Water pollution":"Very low","Land use and waste":"Low","Natural disaster hazards":"Strong","Water availability":"Low","Food availability":"Strong","Energy availability":"Average",Health:"Low",Education:"Low",Wealth:"Low",Safety:"Low",Livability:"Low",Transport:"Low",Inclusion:"Strong",Accountability:"Average","City budget":"Average",SME:"Low","Public services":"Average","Sustainability commitment":"Average",Satisfaction:"Average",Efficiency:"Average",Accessibility:"Low",Safety_1:"Very low",Affordability:"Strong","Environmental impact":"Very strong",tr_graph:{Satisfaction:3,Efficiency:3,Accessibility:2,Safety:1,Affordability:4,"Environmental impact":5},images:["/assets/DarEsSalaam/1.jpg","/assets/DarEsSalaam/2.jpg","/assets/DarEsSalaam/3.jpg","/assets/DarEsSalaam/4.jpg","/assets/DarEsSalaam/5.jpg"],pdfName:Us.DarEsSalaam},{City:"Adoni",Country:"India","Text description":"A historical city and an agricultural centre in Andhra Pradesh",Population:"232 552","Population description":"medium","Population density":64.4,"Population density description":"large","Population city proper":"184 625","Population density city proper":93.71827411167513,Climate:"27°C, 17 kph, 691 mm ","Climate description":"Temperate, desert, hot summer","Urban Resilience Index":"C-2",Environmental:"Low",Social:"Very low",Governmental:"Low","Current state":"Very low","Ability & Willingness":"Very low","Basic needs Scope":"B-3","Natural Risk Exposure":"Average","Transport Resilience Index":"Strong","Urban Sentiment Index":"Very low","Poverty headcount ratio at national poverty lines":.273,"Poverty headcount ratio at national poverty lines description":"low","Mean salary":"2 769","Mean salary description":"average","Literacy rate among population":.774,"Literacy rate among population description":"average","Air pollution":"Average","Water pollution":"Low","Land use and waste":"Strong","Natural disaster hazards":"Strong","Water availability":"Strong","Food availability":"Average","Energy availability":"Strong",Health:"Low",Education:"Low",Wealth:"Low",Safety:"Very low",Livability:"Low",Transport:"Low",Inclusion:"Strong",Accountability:"Very low","City budget":"Strong",SME:"Low","Public services":"Very strong","Sustainability commitment":"Very strong",Satisfaction:"Low",Efficiency:"Strong",Accessibility:"Average",Safety_1:"Strong",Affordability:"Average","Environmental impact":"Strong",tr_graph:{Satisfaction:2,Efficiency:4,Accessibility:3,Safety:4,Affordability:3,"Environmental impact":4},images:["/assets/Adoni/1.jpg","/assets/Adoni/2.jpeg","/assets/Adoni/3.jpeg","/assets/Adoni/4.jpg","/assets/Adoni/5.jpeg","/assets/Adoni/6.png"],pdfName:Us.Adoni},{City:"Natal",Country:"Brazil","Text description":"Regional centre of the Rio Grande do Norte",Population:"1 318 291","Population description":"large","Population density":53,"Population density description":"large","Population city proper":"896 710","Population density city proper":52.74764705882353,Climate:"26°C, 23 kph, 1 225 mm ","Climate description":"Tropical, dry summer","Urban Resilience Index":"B-2",Environmental:"Average",Social:"Average",Governmental:"Average","Current state":"Average","Ability & Willingness":"Average","Basic needs Scope":"B-2","Natural Risk Exposure":"Low","Transport Resilience Index":"Strong","Urban Sentiment Index":"Strong","Poverty headcount ratio at national poverty lines":.15,"Poverty headcount ratio at national poverty lines description":"average","Mean salary":"1 794","Mean salary description":"average","Literacy rate among population":.993,"Literacy rate among population description":"very strong","Air pollution":"Strong","Water pollution":"Average","Land use and waste":"Very strong","Natural disaster hazards":"Strong","Water availability":"Average","Food availability":"Average","Energy availability":"Average",Health:"Average",Education:"Average",Wealth:"Average",Safety:"Very low",Livability:"Average",Transport:"Average",Inclusion:"Average",Accountability:"Very low","City budget":"Strong",SME:"Low","Public services":"Average","Sustainability commitment":"Average",Satisfaction:"Strong",Efficiency:"Low",Accessibility:"Average",Safety_1:"Low",Affordability:"Strong","Environmental impact":"Very strong",tr_graph:{Satisfaction:4,Efficiency:2,Accessibility:3,Safety:2,Affordability:4,"Environmental impact":5},images:["/assets/Natal/1.png","/assets/Natal/2.png","/assets/Natal/3.jpeg","/assets/Natal/4.jpeg"],pdfName:Us.Natal},{City:"Brazzaville",Country:"Congo","Text description":"Capital and largest city of the Republic of the Congo",Population:"3 186 838","Population description":"large","Population density":374,"Population density description":"very large","Population city proper":"1 932 610","Population density city proper":193.261,Climate:"25°C, 8 kph, 1 095 mm ","Climate description":"Tropical, dry winter","Urban Resilience Index":"C-1",Environmental:"Average",Social:"Very low",Governmental:"Average","Current state":"Average","Ability & Willingness":"Very low","Basic needs Scope":"B-3","Natural Risk Exposure":"Strong","Transport Resilience Index":"Low","Urban Sentiment Index":"Very strong","Poverty headcount ratio at national poverty lines":.193,"Poverty headcount ratio at national poverty lines description":"low","Mean salary":"1 282","Mean salary description":"average","Literacy rate among population":.818,"Literacy rate among population description":"average","Air pollution":"Strong","Water pollution":"Very low","Land use and waste":"Average","Natural disaster hazards":"Strong","Water availability":"Strong","Food availability":"Low","Energy availability":"Average",Health:"Very low",Education:"Average",Wealth:"Low",Safety:"Very low",Livability:"Average",Transport:"Average",Inclusion:"Very low",Accountability:"Very low","City budget":"Very low",SME:"Very low","Public services":"Average","Sustainability commitment":"Average",Satisfaction:"Strong",Efficiency:"Very low",Accessibility:"Low",Safety_1:"Average",Affordability:"Strong","Environmental impact":"Strong",tr_graph:{Satisfaction:4,Efficiency:1,Accessibility:2,Safety:3,Affordability:4,"Environmental impact":4},images:["/assets/Brazzaville/1.jpeg","/assets/Brazzaville/2.jpg","/assets/Brazzaville/3.jpeg","/assets/Brazzaville/4.jpeg"],pdfName:Us.Brazzaville},{City:"Almaty",Country:"Kazakhstan","Text description":"Largest city in the country",Population:"2 539 108","Population description":"large","Population density":37.7,"Population density description":"medium","Population city proper":"2 211 198","Population density city proper":32.35110460863204,Climate:"7°C, 10 kph, 891 mm ","Climate description":"Continental, humid, warm summer","Urban Resilience Index":"B-1",Environmental:"Average",Social:"Strong",Governmental:"Average","Current state":"Average","Ability & Willingness":"Average","Basic needs Scope":"A-3","Natural Risk Exposure":"Strong","Transport Resilience Index":"Strong","Urban Sentiment Index":"Low","Poverty headcount ratio at national poverty lines":.187,"Poverty headcount ratio at national poverty lines description":"average","Mean salary":"2 901","Mean salary description":"average","Literacy rate among population":.999,"Literacy rate among population description":"very strong","Air pollution":"Strong","Water pollution":"Average","Land use and waste":"Very strong","Natural disaster hazards":"Very strong","Water availability":"Very strong","Food availability":"Strong","Energy availability":"Strong",Health:"Very strong",Education:"Strong",Wealth:"Strong",Safety:"Strong",Livability:"Strong",Transport:"Strong",Inclusion:"Low",Accountability:"Average","City budget":"Strong",SME:"Strong","Public services":"Very strong","Sustainability commitment":"Very strong",Satisfaction:"Very low",Efficiency:"Low",Accessibility:"Average",Safety_1:"Strong",Affordability:"Low","Environmental impact":"Strong",tr_graph:{Satisfaction:1,Efficiency:2,Accessibility:3,Safety:4,Affordability:2,"Environmental impact":4},images:["/assets/Almaty/1.jpg","/assets/Almaty/2.jpg","/assets/Almaty/3.jpg","/assets/Almaty/4.jpg"],pdfName:Us.Almaty},{City:"Cape Town",Country:"South Africa","Text description":"Second largest city of the country, the regional centre of the Western Cape",Population:"4 293 836","Population description":"large","Population density":67.7,"Population density description":"large","Population city proper":"4 005 016","Population density city proper":16.38043353783231,Climate:"16°C, 20 kph, 621 mm ","Climate description":"Temperate, dry and warm summer","Urban Resilience Index":"B-2",Environmental:"Average",Social:"Average",Governmental:"Strong","Current state":"Strong","Ability & Willingness":"Average","Basic needs Scope":"B-1","Natural Risk Exposure":"Strong","Transport Resilience Index":"Low","Urban Sentiment Index":"Strong","Poverty headcount ratio at national poverty lines":.555,"Poverty headcount ratio at national poverty lines description":"very low","Mean salary":"1 686","Mean salary description":"average","Literacy rate among population":.971,"Literacy rate among population description":"very strong","Air pollution":"Strong","Water pollution":"Low","Land use and waste":"Low","Natural disaster hazards":"Strong","Water availability":"Low","Food availability":"Low","Energy availability":"Low",Health:"Very low",Education:"Average",Wealth:"Average",Safety:"Low",Livability:"Average",Transport:"Strong",Inclusion:"Strong",Accountability:"Strong","City budget":"Low",SME:"Average","Public services":"Strong","Sustainability commitment":"Very strong",Satisfaction:"Average",Efficiency:"Average",Accessibility:"Average",Safety_1:"Average",Affordability:"Average","Environmental impact":"Average",tr_graph:{Satisfaction:3,Efficiency:3,Accessibility:3,Safety:3,Affordability:3,"Environmental impact":3},images:["/assets/CapeTown/1.jpg","/assets/CapeTown/2.jpg","/assets/CapeTown/3.jpg","/assets/CapeTown/4.jpg"],pdfName:Us.Dubai},{City:"Mexico City",Country:"Mexico","Text description":"Capital and the largest city of Mexico, one of the largest urban areas in the World",Population:"17 317 588","Population description":"very large","Population density":88.5,"Population density description":"large","Population city proper":"8 843 706","Population density city proper":120.3225306122449,Climate:"16°C, 8 kph, 1 058 mm ","Climate description":"Temperate, dry winter, hot summmer","Urban Resilience Index":"C-2",Environmental:"Low",Social:"Low",Governmental:"Low","Current state":"Low","Ability & Willingness":"Low","Basic needs Scope":"C-2","Natural Risk Exposure":"Average","Transport Resilience Index":"Strong","Urban Sentiment Index":"Low","Poverty headcount ratio at national poverty lines":.363,"Poverty headcount ratio at national poverty lines description":"very low","Mean salary":891,"Mean salary description":"low","Literacy rate among population":.991,"Literacy rate among population description":"very strong","Air pollution":"Very low","Water pollution":"Very low","Land use and waste":"Average","Natural disaster hazards":"Low ","Water availability":"Average","Food availability":"Very low","Energy availability":"Average",Health:"Average",Education:"Average",Wealth:"Average",Safety:"Very low",Livability:"Low",Transport:"Low",Inclusion:"Very low",Accountability:"Low","City budget":"Low",SME:"Low","Public services":"Average","Sustainability commitment":"Low",Satisfaction:"Low",Efficiency:"Very low",Accessibility:"Average",Safety_1:"Strong",Affordability:"Strong","Environmental impact":"Low",tr_graph:{Satisfaction:2,Efficiency:1,Accessibility:3,Safety:4,Affordability:4,"Environmental impact":2},images:["/assets/Mexico/1.jpg","/assets/Mexico/2.png","/assets/Mexico/3.jpeg","/assets/Mexico/4.jpg","/assets/Mexico/5.jpeg","/assets/Mexico/6.jpeg"],pdfName:Us.Dubai},{City:"Jakarta",Country:"Indonesia","Text description":"Capital and the largest city of Indonesia, one of the largest urban areas in the World",Population:"38 758 456","Population description":"very large","Population density":91.8,"Population density description":"very large","Population city proper":"10 679 951","Population density city proper":161.51643149887332,Climate:"26°C, 10 kph, 2 097 mm ","Climate description":"Tropical, humid","Urban Resilience Index":"B-3",Environmental:"Low",Social:"Average",Governmental:"Average","Current state":"Average","Ability & Willingness":"Average","Basic needs Scope":"B-2","Natural Risk Exposure":"Low","Transport Resilience Index":"Low","Urban Sentiment Index":"Average","Poverty headcount ratio at national poverty lines":.047,"Poverty headcount ratio at national poverty lines description":"strong","Mean salary":554,"Mean salary description":"low","Literacy rate among population":.999,"Literacy rate among population description":"very strong","Air pollution":"Very low","Water pollution":"Average","Land use and waste":"Average","Natural disaster hazards":"Low ","Water availability":"Average","Food availability":"Low","Energy availability":"Average",Health:"Low",Education:"Low",Wealth:"Low",Safety:"Strong",Livability:"Average",Transport:"Average",Inclusion:"Low",Accountability:"Very strong","City budget":"Low",SME:"Strong","Public services":"Average","Sustainability commitment":"Average",Satisfaction:"Average",Efficiency:"Low",Accessibility:"Average",Safety_1:"Strong",Affordability:"Strong","Environmental impact":"Low",tr_graph:{Satisfaction:3,Efficiency:2,Accessibility:3,Safety:4,Affordability:4,"Environmental impact":2},images:["/assets/Jakarta/1.jpg","/assets/Jakarta/2.jpg","/assets/Jakarta/3.jpg","/assets/Jakarta/4.jpeg","/assets/Jakarta/5.jpeg","/assets/Jakarta/6.jpeg"],pdfName:Us.Dubai},{City:"Panama City",Country:"Panama","Text description":"Capital and the largest city of Panama",Population:"1 584 643","Population description":"large","Population density":66.6,"Population density description":"large","Population city proper":"1 367 767","Population density city proper":47.40302904276703,Climate:"26°C, 17 kph, 2 088 mm ","Climate description":"Tropical, monsoonal","Urban Resilience Index":"B-1",Environmental:"Average",Social:"Strong",Governmental:"Average","Current state":"Average","Ability & Willingness":"Average","Basic needs Scope":"B-1","Natural Risk Exposure":"Average","Transport Resilience Index":"Strong","Urban Sentiment Index":"Average","Poverty headcount ratio at national poverty lines":.046,"Poverty headcount ratio at national poverty lines description":"strong","Mean salary":"1 279","Mean salary description":"average","Literacy rate among population":.988,"Literacy rate among population description":"very strong","Air pollution":"Average","Water pollution":"Strong","Land use and waste":"Strong","Natural disaster hazards":"Average","Water availability":"Strong","Food availability":"Strong","Energy availability":"Very strong",Health:"Strong",Education:"Very low",Wealth:"Low",Safety:"Strong",Livability:"Low",Transport:"Average",Inclusion:"Average",Accountability:"Average","City budget":"Average",SME:"Low","Public services":"Strong","Sustainability commitment":"Strong",Satisfaction:"Low",Efficiency:"Low",Accessibility:"Average",Safety_1:"Strong",Affordability:"Strong","Environmental impact":"Strong",tr_graph:{Satisfaction:2,Efficiency:2,Accessibility:3,Safety:4,Affordability:4,"Environmental impact":4},images:["/assets/Panama/1.jpg","/assets/Panama/2.jpeg","/assets/Panama/3.jpeg","/assets/Panama/4.jpg","/assets/Panama/5.jpeg","/assets/Panama/6.jpeg","/assets/Panama/7.jpg"],pdfName:Us.Dubai},{City:"Amman",Country:"Jordan","Text description":"Capital and the largest city of Jordan",Population:"6 366 731","Population description":"very large","Population density":137.1,"Population density description":"very large","Population city proper":"1 812 059","Population density city proper":119.68685601056804,Climate:"17°C, 13 kph, 187 mm ","Climate description":"Arid, dry summer, cold","Urban Resilience Index":"B-1",Environmental:"Low",Social:"Strong",Governmental:"Strong","Current state":"Average","Ability & Willingness":"Average","Basic needs Scope":"B-1","Natural Risk Exposure":"Average","Transport Resilience Index":"Low","Urban Sentiment Index":"Low","Poverty headcount ratio at national poverty lines":.157,"Poverty headcount ratio at national poverty lines description":"average","Mean salary":"2 284","Mean salary description":"average","Literacy rate among population":.994,"Literacy rate among population description":"very strong","Air pollution":"Low","Water pollution":"Low","Land use and waste":"Average","Natural disaster hazards":"Average","Water availability":"Strong","Food availability":"Strong","Energy availability":"Average",Health:"Average",Education:"Average",Wealth:"Strong",Safety:"Strong",Livability:"Strong",Transport:"Average",Inclusion:"Low",Accountability:"Very strong","City budget":"Average",SME:"Average","Public services":"Average","Sustainability commitment":"Average",Satisfaction:"Strong",Efficiency:"Low",Accessibility:"Average",Safety_1:"Low",Affordability:"Average","Environmental impact":"Low",tr_graph:{Satisfaction:4,Efficiency:2,Accessibility:3,Safety:2,Affordability:3,"Environmental impact":2},images:["/assets/Amman/1.jpg","/assets/Amman/2.jpeg","/assets/Amman/3.jpeg","/assets/Amman/4.jpeg","/assets/Amman/5.jpeg"],pdfName:Us.Dubai},{City:"Bangkok",Country:"Thailand","Text description":"Capital and the largest city of Thailand",Population:"19 005 476","Population description":"very large","Population density":70.8,"Population density description":"large","Population city proper":"5 666 264","Population density city proper":36.11385595920969,Climate:"28°C, 10 kph, 1 207 mm ","Climate description":"Tropical, dry winter","Urban Resilience Index":"B-3",Environmental:"Low",Social:"Average",Governmental:"Low","Current state":"Low","Ability & Willingness":"Average","Basic needs Scope":"B-3","Natural Risk Exposure":"Average","Transport Resilience Index":"Low","Urban Sentiment Index":"Strong","Poverty headcount ratio at national poverty lines":.063,"Poverty headcount ratio at national poverty lines description":"strong","Mean salary":421,"Mean salary description":"low","Literacy rate among population":.988,"Literacy rate among population description":"very strong","Air pollution":"Low","Water pollution":"Low","Land use and waste":"Low","Natural disaster hazards":"Low ","Water availability":"Strong","Food availability":"Low","Energy availability":"Strong",Health:"Strong",Education:"Low",Wealth:"Average",Safety:"Very strong",Livability:"Average",Transport:"Low",Inclusion:"Strong",Accountability:"Low","City budget":"Very low",SME:"Very strong","Public services":"Low","Sustainability commitment":"Strong",Satisfaction:"Average",Efficiency:"Very low",Accessibility:"Average",Safety_1:"Low",Affordability:"Average","Environmental impact":"Average",tr_graph:{Satisfaction:3,Efficiency:1,Accessibility:3,Safety:2,Affordability:3,"Environmental impact":3},images:["/assets/Bangkok/1.jpg","/assets/Bangkok/2.jpg","/assets/Bangkok/3.jpg","/assets/Bangkok/4.jpg","/assets/Bangkok/5.jpg"],pdfName:Us.Dubai},{City:"Colombo",Country:"Sri Lanka","Text description":"Largest city and commercial capital of Sri Lanka",Population:"4 938 510","Population description":"large","Population density":38,"Population density description":"medium","Population city proper":"2 324 349","Population density city proper":33.25248927038626,Climate:"26°C, 16 kph, 2 387 mm ","Climate description":"Tropical, humid","Urban Resilience Index":"B-2",Environmental:"Average",Social:"Average",Governmental:"Average","Current state":"Average","Ability & Willingness":"Low","Basic needs Scope":"B-2","Natural Risk Exposure":"Average","Transport Resilience Index":"Average","Urban Sentiment Index":"Average","Poverty headcount ratio at national poverty lines":.143,"Poverty headcount ratio at national poverty lines description":"average","Mean salary":183,"Mean salary description":"very low","Literacy rate among population":.99,"Literacy rate among population description":"very strong","Air pollution":"Average","Water pollution":"Strong","Land use and waste":"Low","Natural disaster hazards":"Strong","Water availability":"Average","Food availability":"Low","Energy availability":"Very strong",Health:"Strong",Education:"Very low",Wealth:"Low",Safety:"Strong",Livability:"Low",Transport:"Strong",Inclusion:"Average",Accountability:"Very low","City budget":"Low",SME:"Average","Public services":"Average","Sustainability commitment":"Low",Satisfaction:"Low",Efficiency:"Low",Accessibility:"Average",Safety_1:"Average",Affordability:"Average","Environmental impact":"Average",tr_graph:{Satisfaction:2,Efficiency:2,Accessibility:3,Safety:3,Affordability:3,"Environmental impact":3},images:["/assets/Colombo/1.jpg","/assets/Colombo/2.jpg","/assets/Colombo/3.jpg","/assets/Colombo/4.jpg"],pdfName:Us.Dubai}],fM=["Dubai","Expo City Dubai","Valparaiso","Dar es Salaam","Adoni","Natal","Brazzaville","Almaty","Cape Town","Mexico City","Jakarta","Panama City","Amman","Bangkok","Colombo"],$Me=[{city:"Dubai",E:`Mitigate effects of air pollution, especially SO2, NO2:\r
- promoting electric vehicles,\r
- implementation of urban planning policies aimed at reducing long-distance travel within the city, providing new communities with the leisure, and social infrastructure.\r
\r
Introduction of modern technologies for construction waste.`,S:"Strengthen social policy eradicating poverty and ensuring equality in a city (poverty headcount ratio at national poverty lines is still around 5%).",G:`Gender-balancing of bureaucratic procedures.\r
\r
Strengthening labor conditions regulation, primarily for low-skilled personnel (relatively high slavery index – 40% vulnerability to modern slavery).`},{city:"Expo City Dubai",E:`Mitigate the effects of pollution, especially particulate matter.\r
- For instance, expand the deployment of regenerative-air vacuum sweepers for both streets and sidewalks. Introduce technologies for indoor air purification in buildings.\r
- Continue planting trees.`,S:"Develop healthcare policies aimed to expand hospital capacity and training of doctors.",G:`Streamline SME access to become ECD residents by minimizing obstacles to renting and launching an entrepreneurship support program.\r
\r
Establish one-stop shop platform for all municipal and state services, creating a one-stop-shop approach.`},{city:"Valparaiso",E:"Strengthening control over SO2 emissions, increasing environmental requirements for ships entering the port.",S:"A programme for the development of public spaces in the city, involving the creation of leisure facilities.",G:"Creation of an ecosystem for start-ups and entrepreneurship (low level of officially registered small businesses per 1 inhabitant – 383,7)."},{city:"Dar es Salaam",E:"Policy on treatment of drinking water sources (high average of pH concentration in water (8,5) and high toxins metrics), including modernisation of sewerage and construction of treatment plants, improvement of financial management. Attracting investments of development institutions in water supply and sewage systems.",S:`Community Literacy Programme (literacy rate – 76,8%). Development of teacher training system, development of online education with the involvement of teachers from swahili and english speaking countries.\r
\r
 Remote employment promotion.`,G:"Statistics and accounting quality improvement."},{city:"Adoni",E:"Policy on reclamation of landfills and degraded lands. Construction of waste incineration plants, which will also improve energy supply to certain areas.",S:"A programme to improve road safety (+20,8% road fatalities in 2019-2022). Attracting investment to improve the quality of roads. ",G:"Development of mobile communication infrastructure."},{city:"Natal",E:"Natural disasters mitigation policy (increasing frequency of hurricanes and the rise on the sea level).",S:`Social inclusion policy as a response for high number of violence crimes (violent crime rate – 31,9 per 1,000 population), including those aimed at the integration of residents of favelas into the labour market, entrepreneurship and social support.\r
\r
Development of social and communal infrastructure outside the administrative boundaries of the city in areas of active housing construction.\r
\r
Organisation of volunteer programmes (the lowest volunteerism rate among the cities – less than 0,1 volunteer per capita).`,G:"Increasing transparency of city finances and reporting."},{city:"Brazzaville",E:`Strengthen waste management strategy due to relatively low levels of waste recycling.\r
\r
Extensive urban sprawl requires urgent measures to preserve green areas.`,S:`Expansion of hospital capacity and training of doctors. \r
\r
Providing slums with basic infrastructure (energy, clean water, waste collection).\r
\r
Establishment of a programme to support micro-enterprises and trade infrastructure development projects.`,G:"Mandatory publication of the city budget and its discussion with stakeholders."},{city:"Almaty",E:"Replacing coal with gas as the main source of energy.",S:"Transport policy aimed at making public transport more attractive, implementation of LRT and BRT projects; polycentric urban development.",G:"Strengthening controls over financial flows and anti-corruption policies (high number of news on bribery scandals)."},{city:"Cape Town",E:"Strengthen waste management strategy due to relatively low levels of waste recycling.",S:`Develop complex programs to decrease child mortality rate (women’s healthcare programs, trainings of doctors, hospital equipment).\r
\r
Country-level system to increase literacy rate. Training programs for teachers which will also allow to decrease average number of pupils in the class.\r
\r
Social inclusion policy as a response to high violent crime rates.`,G:"Develop city policies to increase small and medium enterprises’ activity."},{city:"Mexico City",E:"Mitigate effects of air pollution. Especially SO2, NO2.",S:"Reform healthcare system paying special attention to implementation of effective city ambulance system. Develop plan aimed at increasing life expectancy at birth. ",G:`Pay attention to ESG planning and reporting as currently no policies are implemented.\r
\r
Increase transparency of city finance and reporting.`},{city:"Jakarta",E:`Mitigate effects of high CO2 emissions and concentrations.\r
\r
Increase parks and green zones ares.`,S:`Develop programs aimed at transport system transformation (decrease of heavy traffic).\r
\r
Diversify importers of cereal and food to decrease risks implemented by high level of dependency on imports.`,G:"Increase transparency of city finance and reporting."},{city:"Panama City",E:"Improve policy on reclamation of landfills and degraded lands.",S:`Develop special programs aimed at increase in school attendance. Develop trainings of teachers.\r
\r
Strengthen inclusion policies, especially — for women and refugees.`,G:`Increase financial transparency of city government companies.\r
\r
Build up government system to intensify e-gov services provision.`},{city:"Amman",E:`Mitigate effects of high NO2 concentrations.\r
\r
Strengthen construction waste management strategy.`,S:"Develop measures that will allow to decrease number of road fatalities.",G:"Develop system that will allow to implement free phone to call the police, ambulance, firefighters at least for citizens."},{city:"Bangkok",E:"Improve waste management system and introduce more effective natural disaster mitigation measures.",S:`Reform system of ambulance due to extremely long time needed.\r
\r
Increase investments in the compulsory education system.`,G:"Despite strong SME support measures public services system needs to be reshaped in order to standardize procedures and reduce waiting times"},{city:"Colombo",E:"While significant improvements have been made in natural disaster risk mitigation, the city still needs to turn its attention to air and water pollution where policies lag behind.",S:"Introduction of new social welfare policies to combat poverty. Despite relatively high levels of safety and healthcare the city is still behind its peers in terms of food availability and wealth.",G:`Strengthen budget policies and regulations to be able to plan long term measures.\r
\r
The city needs to invest into ESG strategies and reporting.`}],YMe=({selectedCityName:n})=>{const{classes:e}=kT(),i=vu(),o=H6.find(s=>s.City===n);return $e(_s,{children:[o&&$e("div",{className:e.root,children:[$e("div",{className:e.titleWrapper,children:[$e("div",{className:e.cityNameAndCountryNameWrapper,children:[X("div",{className:e.cityName,children:n}),X("div",{className:e.countryName,children:o.Country})]}),$e("div",{className:e.cityDescription,children:["Largest city in the",X("br",{}),"country, centre ",X("br",{}),"of region",X("br",{})]})]}),$e("div",{className:e.statWrapper,children:[X(_I,{color:"#FF3B29",title:"Population",value:o.Population,status:o["Population description"]}),X(_I,{color:"#FF3B29",title:"Population density",value:o["Population density"]+" people/ha",status:o["Population density description"]}),X(_I,{color:"#2D67FF",title:"Climate",value:o.Climate,status:o["Climate description"]})]}),$e("div",{style:{display:"flex",marginTop:"3.7vh",marginLeft:"-2.1vh",paddingLeft:"2vh",borderLeft:"1px solid #fff",height:"auto"},children:[$e("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",height:"auto"},children:[X(f0,{label:"Urban resilience index",status:o["Urban Resilience Index"],isFirst:!0}),$e("div",{className:e.smallItemsListWrapper,children:[X(uu,{label:"Environmental",status:o.Environmental}),X(uu,{label:"Social",status:o.Social}),X(uu,{label:"Governmental",status:o.Governmental})]}),X("div",{className:e.smallItemsListWrapper,style:{marginTop:"2.7vh"},children:X(uu,{label:"Ability & Willingness",status:o["Ability & Willingness"]})})]}),$e("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",height:"auto",marginLeft:"1.5vh",gap:"3.2vh"},children:[X(f0,{label:"Basic needs",subLabel:"Scope 0",status:o["Basic needs Scope"]}),X(f0,{label:"Transport resilience index",status:o["Transport Resilience Index"]})]}),$e("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",height:"auto",marginLeft:"1.5vh",gap:"3.2vh"},children:[X(f0,{label:"Natural risk exposure",status:o["Natural Risk Exposure"]}),X(f0,{label:"Urban sentiment index",status:o["Urban Sentiment Index"]})]})]})]}),X(jMe,{selectedCityName:n}),X(xr,{onClick:()=>{i("/city/"+n)},style:{position:"absolute",bottom:"9vh",right:"10vh",width:"20vh",height:"6.5vh",borderRadius:50,zIndex:1e3,background:"#2D67FF",color:"#fff",fontFamily:"SuisseIntl-Regular",fontSize:"3vh",fontWeight:100,textTransform:"none"},children:"Subscribe"}),X("div",{className:e.bottomWrapper,style:{position:"absolute",margin:"unset",bottom:"3vh"},children:$e("div",{className:e.smallTextWrapper,onClick:()=>{const s="Methodology_v05_AP_BK_v2.pdf",l=document.createElement("a");l.href=`/pdf/${s}`,l.download=s,l.click()},children:[X(Ii,{className:e.smallText,children:"How the rating works"}),X("img",{src:"/assets/questionGray.svg",alt:"hint",style:{opacity:.6}})]})}),X("div",{style:{position:"absolute",fontFamily:"SuisseIntl-Light",fontWeight:100,fontSize:"1.4vh",color:"rgba(255, 255, 255, 0.4)",bottom:"15vh",right:"30%",transform:"translateX(65%)",width:"30%"},children:"The height of a bar represents the total number of people in a grid cell."})]})},qMe=[{name:"Mainpage",link:"/"},{name:"Urban Rating & Monitoring",link:"/urban"},{name:"Corporate Rating & Monitoring",link:"/",disabled:!0},{name:"Project Marketplace",link:"/marketplace"},{name:"Expo City Dubai",link:"/expo_city_dubai"},{name:"Governance"},{name:"Data & Insights"},{name:"Resilience News"}],T_=({setVisible:n})=>$e("div",{children:[X("div",{style:{position:"absolute",width:"100%",height:"100%",top:0,left:0,zIndex:9999,background:"rgba(0, 0, 0, 0.3)",backdropFilter:"blur(30px)"}}),$e("div",{style:{position:"absolute",width:"100%",height:"100%",backgroundColor:"rgba(0,0,0,0.5)",zIndex:9999,paddingLeft:"15vh",paddingTop:"4vh"},children:[$e("div",{onClick:()=>n(!1),style:{cursor:"pointer",display:"flex",alignItems:"center",gap:"2vh",color:"#FFFFFF",fontSize:"3vh",fontFamily:"SuisseIntl-Light",fontWeight:600,marginBottom:"10vh"},children:[X("img",{src:"/assets/closeBtn.svg",alt:"close"}),"Close menu"]}),X("div",{children:qMe.map(e=>X(XMe,{name:e.name,link:e.link,isDisabled:e.disabled},e.name))})]})]}),XMe=({name:n,link:e,isDisabled:i})=>{const o=vu(),[s,l]=ie.useState(!1);return $e("div",{onMouseEnter:()=>l(!0),onMouseLeave:()=>l(!1),onClick:()=>{e&&o(e)},style:{pointerEvents:i?"none":"auto",userSelect:"none",cursor:"pointer",fontFamily:"SuisseIntl-Light",fontWeight:400,color:s?"#2D67FF":"#FFFFFF",fontSize:"8vh",display:"flex",alignItems:"center",flexDirection:"row",gap:"2vh"},children:[$e("div",{style:{opacity:i?.1:1},children:[s&&X("img",{src:"/assets/menuArrow.svg",alt:"arrow",style:{marginRight:"2vh"}}),n]}),i&&X("div",{style:{fontFamily:"SuisseIntl-Light",fontWeight:600,color:"#FFFFFF",fontSize:"2vh",opacity:1,width:"fit-content",borderRadius:"4vh",backgroundColor:"rgba(255,255,255,0.1)",padding:"1vh 2vh"},children:"Coming soon"})]})},ZMe=()=>{const[n,e]=ie.useState("map"),[i,o]=ie.useState(null),[s,l]=ie.useState(null),[d,p]=ie.useState(!1);return $e("div",{children:[d&&X(T_,{setVisible:p}),$e(Q_e,{backgroundColor:"#2429B5",children:[X(t1e,{isCitySelected:!!s,setSelectedCity:l,setMenuVisible:p}),s?X(YMe,{selectedCityName:s}):X(OMe,{map:i,currentView:n,setCurrentView:e,isZoomButtonsVisible:n==="map"}),n==="graph"&&!s&&X(WMe,{setSelectedCity:l}),n==="map"&&!s&&X(GMe,{setMap:o,setSelectedCity:l})]})]})},VK=pr()({root:{position:"absolute",overflowY:"scroll",backgroundColor:"#203CBF",width:"100vw",height:"100vh","&::-webkit-scrollbar":{width:"0em"}},sectionWrapper:{position:"relative",height:"100%",width:"100%"},sticky:{position:"sticky",top:0,left:0,right:0,zIndex:1}}),C_=pr()({root:{padding:0,margin:0,color:"#fff",height:"100vh"},contentWrapper:{height:"100%",width:"100%",margin:"0 auto",padding:"0 5%",boxSizing:"border-box"},pageContainer:{position:"relative",display:"block",float:"left",width:"100%",height:"100vh"},titleWrapper:{position:"absolute",top:"11vh",textAlign:"center",width:"100%"},bigText:{paddingTop:"18px",fontFamily:"SuisseIntl-Light",fontWeight:300,lineHeight:"9vh",letterSpacing:"-0.5vh",fontSize:"10.7vh",color:"#fff"},bigTextSubtitle:{paddingTop:"18px",fontFamily:"SuisseIntl-Light",fontWeight:400,lineHeight:"2",letterSpacing:"0",fontSize:"2vh",color:"#fff"},smallItemsListWrapper:{marginTop:"4vh",display:"flex",flexDirection:"column",gap:"1.1vh"},bottomWrapper:{position:"absolute",bottom:"0",zIndex:1,display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:"4vh",pointerEvents:"none",width:"100%"},smallTextWrapper:{pointerEvents:"all",display:"flex",flexDirection:"row",gap:"10px"},smallText:{fontFamily:"SuisseIntl-Light",fontSize:"1.8vh",color:"#fff",opacity:"0.6",cursor:"pointer"}}),AG=({label:n,color:e,cities:i,position:o,onClick:s})=>{const[l,d]=ie.useState(n),[p,f]=ie.useState(null),y=!!p,_=S=>{f(S.currentTarget)},x=()=>{f(null)};return $e("div",{children:[X(xr,{id:"demo-positioned-button","aria-controls":y?"demo-positioned-menu":void 0,"aria-haspopup":"true","aria-expanded":y?"true":void 0,onClick:i?_:void 0,disabled:!i,children:$e("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"},children:[X("div",{style:{width:"1.2vh",height:"1.2vh",borderRadius:"50%",backgroundColor:e,marginRight:"1vh"}}),X("div",{style:{fontFamily:o===0?"SuisseIntl-Regular":"SuisseIntl-Light",fontSize:"3.1vh",fontWeight:600,textAlign:"center",color:o===0?"#2D67FF":"#000",textTransform:"none"},children:l}),o!==0&&X("div",{style:{marginLeft:"1vh"},children:X("img",{src:"/assets/smallArrowDown.svg",alt:"arrow down"})})]})}),X(w_,{id:"demo-positioned-menu","aria-labelledby":"demo-positioned-button",anchorEl:p,open:y,onClose:x,anchorOrigin:{vertical:"top",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"},children:i==null?void 0:i.map((S,T)=>X(Fg,{onClick:()=>{d(S),s==null||s(S,o),x()},children:S},S))})]})};/*!
 * @kurkle/color v0.3.2
 * https://github.com/kurkle/color#readme
 * (c) 2023 Jukka Kurkela
 * Released under the MIT License
 */function i2(n){return n+.5|0}const ef=(n,e,i)=>Math.max(Math.min(n,i),e);function Gb(n){return ef(i2(n*2.55),0,255)}function yf(n){return ef(i2(n*255),0,255)}function Eh(n){return ef(i2(n/2.55)/100,0,1)}function EG(n){return ef(i2(n*100),0,100)}const _c={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},YR=[..."0123456789ABCDEF"],KMe=n=>YR[n&15],JMe=n=>YR[(n&240)>>4]+YR[n&15],_A=n=>(n&240)>>4===(n&15),QMe=n=>_A(n.r)&&_A(n.g)&&_A(n.b)&&_A(n.a);function eTe(n){var e=n.length,i;return n[0]==="#"&&(e===4||e===5?i={r:255&_c[n[1]]*17,g:255&_c[n[2]]*17,b:255&_c[n[3]]*17,a:e===5?_c[n[4]]*17:255}:(e===7||e===9)&&(i={r:_c[n[1]]<<4|_c[n[2]],g:_c[n[3]]<<4|_c[n[4]],b:_c[n[5]]<<4|_c[n[6]],a:e===9?_c[n[7]]<<4|_c[n[8]]:255})),i}const tTe=(n,e)=>n<255?e(n):"";function nTe(n){var e=QMe(n)?KMe:JMe;return n?"#"+e(n.r)+e(n.g)+e(n.b)+tTe(n.a,e):void 0}const iTe=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function GK(n,e,i){const o=e*Math.min(i,1-i),s=(l,d=(l+n/30)%12)=>i-o*Math.max(Math.min(d-3,9-d,1),-1);return[s(0),s(8),s(4)]}function aTe(n,e,i){const o=(s,l=(s+n/60)%6)=>i-i*e*Math.max(Math.min(l,4-l,1),0);return[o(5),o(3),o(1)]}function rTe(n,e,i){const o=GK(n,1,.5);let s;for(e+i>1&&(s=1/(e+i),e*=s,i*=s),s=0;s<3;s++)o[s]*=1-e-i,o[s]+=e;return o}function oTe(n,e,i,o,s){return n===s?(e-i)/o+(e<i?6:0):e===s?(i-n)/o+2:(n-e)/o+4}function j6(n){const i=n.r/255,o=n.g/255,s=n.b/255,l=Math.max(i,o,s),d=Math.min(i,o,s),p=(l+d)/2;let f,y,_;return l!==d&&(_=l-d,y=p>.5?_/(2-l-d):_/(l+d),f=oTe(i,o,s,_,l),f=f*60+.5),[f|0,y||0,p]}function $6(n,e,i,o){return(Array.isArray(e)?n(e[0],e[1],e[2]):n(e,i,o)).map(yf)}function Y6(n,e,i){return $6(GK,n,e,i)}function sTe(n,e,i){return $6(rTe,n,e,i)}function lTe(n,e,i){return $6(aTe,n,e,i)}function HK(n){return(n%360+360)%360}function cTe(n){const e=iTe.exec(n);let i=255,o;if(!e)return;e[5]!==o&&(i=e[6]?Gb(+e[5]):yf(+e[5]));const s=HK(+e[2]),l=+e[3]/100,d=+e[4]/100;return e[1]==="hwb"?o=sTe(s,l,d):e[1]==="hsv"?o=lTe(s,l,d):o=Y6(s,l,d),{r:o[0],g:o[1],b:o[2],a:i}}function uTe(n,e){var i=j6(n);i[0]=HK(i[0]+e),i=Y6(i),n.r=i[0],n.g=i[1],n.b=i[2]}function dTe(n){if(!n)return;const e=j6(n),i=e[0],o=EG(e[1]),s=EG(e[2]);return n.a<255?`hsla(${i}, ${o}%, ${s}%, ${Eh(n.a)})`:`hsl(${i}, ${o}%, ${s}%)`}const MG={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},TG={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function hTe(){const n={},e=Object.keys(TG),i=Object.keys(MG);let o,s,l,d,p;for(o=0;o<e.length;o++){for(d=p=e[o],s=0;s<i.length;s++)l=i[s],p=p.replace(l,MG[l]);l=parseInt(TG[d],16),n[p]=[l>>16&255,l>>8&255,l&255]}return n}let bA;function pTe(n){bA||(bA=hTe(),bA.transparent=[0,0,0,0]);const e=bA[n.toLowerCase()];return e&&{r:e[0],g:e[1],b:e[2],a:e.length===4?e[3]:255}}const fTe=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function mTe(n){const e=fTe.exec(n);let i=255,o,s,l;if(e){if(e[7]!==o){const d=+e[7];i=e[8]?Gb(d):ef(d*255,0,255)}return o=+e[1],s=+e[3],l=+e[5],o=255&(e[2]?Gb(o):ef(o,0,255)),s=255&(e[4]?Gb(s):ef(s,0,255)),l=255&(e[6]?Gb(l):ef(l,0,255)),{r:o,g:s,b:l,a:i}}}function gTe(n){return n&&(n.a<255?`rgba(${n.r}, ${n.g}, ${n.b}, ${Eh(n.a)})`:`rgb(${n.r}, ${n.g}, ${n.b})`)}const bI=n=>n<=.0031308?n*12.92:Math.pow(n,1/2.4)*1.055-.055,s0=n=>n<=.04045?n/12.92:Math.pow((n+.055)/1.055,2.4);function yTe(n,e,i){const o=s0(Eh(n.r)),s=s0(Eh(n.g)),l=s0(Eh(n.b));return{r:yf(bI(o+i*(s0(Eh(e.r))-o))),g:yf(bI(s+i*(s0(Eh(e.g))-s))),b:yf(bI(l+i*(s0(Eh(e.b))-l))),a:n.a+i*(e.a-n.a)}}function xA(n,e,i){if(n){let o=j6(n);o[e]=Math.max(0,Math.min(o[e]+o[e]*i,e===0?360:1)),o=Y6(o),n.r=o[0],n.g=o[1],n.b=o[2]}}function jK(n,e){return n&&Object.assign(e||{},n)}function CG(n){var e={r:0,g:0,b:0,a:255};return Array.isArray(n)?n.length>=3&&(e={r:n[0],g:n[1],b:n[2],a:255},n.length>3&&(e.a=yf(n[3]))):(e=jK(n,{r:0,g:0,b:0,a:1}),e.a=yf(e.a)),e}function vTe(n){return n.charAt(0)==="r"?mTe(n):cTe(n)}class ww{constructor(e){if(e instanceof ww)return e;const i=typeof e;let o;i==="object"?o=CG(e):i==="string"&&(o=eTe(e)||pTe(e)||vTe(e)),this._rgb=o,this._valid=!!o}get valid(){return this._valid}get rgb(){var e=jK(this._rgb);return e&&(e.a=Eh(e.a)),e}set rgb(e){this._rgb=CG(e)}rgbString(){return this._valid?gTe(this._rgb):void 0}hexString(){return this._valid?nTe(this._rgb):void 0}hslString(){return this._valid?dTe(this._rgb):void 0}mix(e,i){if(e){const o=this.rgb,s=e.rgb;let l;const d=i===l?.5:i,p=2*d-1,f=o.a-s.a,y=((p*f===-1?p:(p+f)/(1+p*f))+1)/2;l=1-y,o.r=255&y*o.r+l*s.r+.5,o.g=255&y*o.g+l*s.g+.5,o.b=255&y*o.b+l*s.b+.5,o.a=d*o.a+(1-d)*s.a,this.rgb=o}return this}interpolate(e,i){return e&&(this._rgb=yTe(this._rgb,e._rgb,i)),this}clone(){return new ww(this.rgb)}alpha(e){return this._rgb.a=yf(e),this}clearer(e){const i=this._rgb;return i.a*=1-e,this}greyscale(){const e=this._rgb,i=i2(e.r*.3+e.g*.59+e.b*.11);return e.r=e.g=e.b=i,this}opaquer(e){const i=this._rgb;return i.a*=1+e,this}negate(){const e=this._rgb;return e.r=255-e.r,e.g=255-e.g,e.b=255-e.b,this}lighten(e){return xA(this._rgb,2,e),this}darken(e){return xA(this._rgb,2,-e),this}saturate(e){return xA(this._rgb,1,e),this}desaturate(e){return xA(this._rgb,1,-e),this}rotate(e){return uTe(this._rgb,e),this}}/*!
 * Chart.js v4.4.0
 * https://www.chartjs.org
 * (c) 2023 Chart.js Contributors
 * Released under the MIT License
 */function vh(){}const _Te=(()=>{let n=0;return()=>n++})();function da(n){return n===null||typeof n>"u"}function cr(n){if(Array.isArray&&Array.isArray(n))return!0;const e=Object.prototype.toString.call(n);return e.slice(0,7)==="[object"&&e.slice(-6)==="Array]"}function Qi(n){return n!==null&&Object.prototype.toString.call(n)==="[object Object]"}function Xr(n){return(typeof n=="number"||n instanceof Number)&&isFinite(+n)}function Wl(n,e){return Xr(n)?n:e}function Fi(n,e){return typeof n>"u"?e:n}const bTe=(n,e)=>typeof n=="string"&&n.endsWith("%")?parseFloat(n)/100:+n/e,$K=(n,e)=>typeof n=="string"&&n.endsWith("%")?parseFloat(n)/100*e:+n;function nr(n,e,i){if(n&&typeof n.call=="function")return n.apply(i,e)}function Ua(n,e,i,o){let s,l,d;if(cr(n))if(l=n.length,o)for(s=l-1;s>=0;s--)e.call(i,n[s],s);else for(s=0;s<l;s++)e.call(i,n[s],s);else if(Qi(n))for(d=Object.keys(n),l=d.length,s=0;s<l;s++)e.call(i,n[d[s]],d[s])}function mM(n,e){let i,o,s,l;if(!n||!e||n.length!==e.length)return!1;for(i=0,o=n.length;i<o;++i)if(s=n[i],l=e[i],s.datasetIndex!==l.datasetIndex||s.index!==l.index)return!1;return!0}function gM(n){if(cr(n))return n.map(gM);if(Qi(n)){const e=Object.create(null),i=Object.keys(n),o=i.length;let s=0;for(;s<o;++s)e[i[s]]=gM(n[i[s]]);return e}return n}function YK(n){return["__proto__","prototype","constructor"].indexOf(n)===-1}function xTe(n,e,i,o){if(!YK(n))return;const s=e[n],l=i[n];Qi(s)&&Qi(l)?Sw(s,l,o):e[n]=gM(l)}function Sw(n,e,i){const o=cr(e)?e:[e],s=o.length;if(!Qi(n))return n;i=i||{};const l=i.merger||xTe;let d;for(let p=0;p<s;++p){if(d=o[p],!Qi(d))continue;const f=Object.keys(d);for(let y=0,_=f.length;y<_;++y)l(f[y],n,d,i)}return n}function xx(n,e){return Sw(n,e,{merger:wTe})}function wTe(n,e,i){if(!YK(n))return;const o=e[n],s=i[n];Qi(o)&&Qi(s)?xx(o,s):Object.prototype.hasOwnProperty.call(e,n)||(e[n]=gM(s))}const PG={"":n=>n,x:n=>n.x,y:n=>n.y};function STe(n){const e=n.split("."),i=[];let o="";for(const s of e)o+=s,o.endsWith("\\")?o=o.slice(0,-1)+".":(i.push(o),o="");return i}function ATe(n){const e=STe(n);return i=>{for(const o of e){if(o==="")break;i=i&&i[o]}return i}}function Ef(n,e){return(PG[e]||(PG[e]=ATe(e)))(n)}function q6(n){return n.charAt(0).toUpperCase()+n.slice(1)}const Aw=n=>typeof n<"u",Mf=n=>typeof n=="function",IG=(n,e)=>{if(n.size!==e.size)return!1;for(const i of n)if(!e.has(i))return!1;return!0};function ETe(n){return n.type==="mouseup"||n.type==="click"||n.type==="contextmenu"}const hr=Math.PI,dr=2*hr,MTe=dr+hr,yM=Number.POSITIVE_INFINITY,TTe=hr/180,co=hr/2,Ym=hr/4,LG=hr*2/3,tf=Math.log10,_d=Math.sign;function wx(n,e,i){return Math.abs(n-e)<i}function RG(n){const e=Math.round(n);n=wx(n,e,n/1e3)?e:n;const i=Math.pow(10,Math.floor(tf(n))),o=n/i;return(o<=1?1:o<=2?2:o<=5?5:10)*i}function CTe(n){const e=[],i=Math.sqrt(n);let o;for(o=1;o<i;o++)n%o===0&&(e.push(o),e.push(n/o));return i===(i|0)&&e.push(i),e.sort((s,l)=>s-l).pop(),e}function f_(n){return!isNaN(parseFloat(n))&&isFinite(n)}function PTe(n,e){const i=Math.round(n);return i-e<=n&&i+e>=n}function qK(n,e,i){let o,s,l;for(o=0,s=n.length;o<s;o++)l=n[o][i],isNaN(l)||(e.min=Math.min(e.min,l),e.max=Math.max(e.max,l))}function du(n){return n*(hr/180)}function X6(n){return n*(180/hr)}function kG(n){if(!Xr(n))return;let e=1,i=0;for(;Math.round(n*e)/e!==n;)e*=10,i++;return i}function XK(n,e){const i=e.x-n.x,o=e.y-n.y,s=Math.sqrt(i*i+o*o);let l=Math.atan2(o,i);return l<-.5*hr&&(l+=dr),{angle:l,distance:s}}function qR(n,e){return Math.sqrt(Math.pow(e.x-n.x,2)+Math.pow(e.y-n.y,2))}function ITe(n,e){return(n-e+MTe)%dr-hr}function Gl(n){return(n%dr+dr)%dr}function Ew(n,e,i,o){const s=Gl(n),l=Gl(e),d=Gl(i),p=Gl(l-s),f=Gl(d-s),y=Gl(s-l),_=Gl(s-d);return s===l||s===d||o&&l===d||p>f&&y<_}function Uo(n,e,i){return Math.max(e,Math.min(i,n))}function LTe(n){return Uo(n,-32768,32767)}function kh(n,e,i,o=1e-6){return n>=Math.min(e,i)-o&&n<=Math.max(e,i)+o}function Z6(n,e,i){i=i||(d=>n[d]<e);let o=n.length-1,s=0,l;for(;o-s>1;)l=s+o>>1,i(l)?s=l:o=l;return{lo:s,hi:o}}const Dh=(n,e,i,o)=>Z6(n,i,o?s=>{const l=n[s][e];return l<i||l===i&&n[s+1][e]===i}:s=>n[s][e]<i),RTe=(n,e,i)=>Z6(n,i,o=>n[o][e]>=i);function kTe(n,e,i){let o=0,s=n.length;for(;o<s&&n[o]<e;)o++;for(;s>o&&n[s-1]>i;)s--;return o>0||s<n.length?n.slice(o,s):n}const ZK=["push","pop","shift","splice","unshift"];function DTe(n,e){if(n._chartjs){n._chartjs.listeners.push(e);return}Object.defineProperty(n,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[e]}}),ZK.forEach(i=>{const o="_onData"+q6(i),s=n[i];Object.defineProperty(n,i,{configurable:!0,enumerable:!1,value(...l){const d=s.apply(this,l);return n._chartjs.listeners.forEach(p=>{typeof p[o]=="function"&&p[o](...l)}),d}})})}function DG(n,e){const i=n._chartjs;if(!i)return;const o=i.listeners,s=o.indexOf(e);s!==-1&&o.splice(s,1),!(o.length>0)&&(ZK.forEach(l=>{delete n[l]}),delete n._chartjs)}function KK(n){const e=new Set(n);return e.size===n.length?n:Array.from(e)}const JK=function(){return typeof window>"u"?function(n){return n()}:window.requestAnimationFrame}();function QK(n,e){let i=[],o=!1;return function(...s){i=s,o||(o=!0,JK.call(window,()=>{o=!1,n.apply(e,i)}))}}function OTe(n,e){let i;return function(...o){return e?(clearTimeout(i),i=setTimeout(n,e,o)):n.apply(this,o),e}}const K6=n=>n==="start"?"left":n==="end"?"right":"center",ys=(n,e,i)=>n==="start"?e:n==="end"?i:(e+i)/2,NTe=(n,e,i,o)=>n===(o?"left":"right")?i:n==="center"?(e+i)/2:e;function eJ(n,e,i){const o=e.length;let s=0,l=o;if(n._sorted){const{iScale:d,_parsed:p}=n,f=d.axis,{min:y,max:_,minDefined:x,maxDefined:S}=d.getUserBounds();x&&(s=Uo(Math.min(Dh(p,f,y).lo,i?o:Dh(e,f,d.getPixelForValue(y)).lo),0,o-1)),S?l=Uo(Math.max(Dh(p,d.axis,_,!0).hi+1,i?0:Dh(e,f,d.getPixelForValue(_),!0).hi+1),s,o)-s:l=o-s}return{start:s,count:l}}function tJ(n){const{xScale:e,yScale:i,_scaleRanges:o}=n,s={xmin:e.min,xmax:e.max,ymin:i.min,ymax:i.max};if(!o)return n._scaleRanges=s,!0;const l=o.xmin!==e.min||o.xmax!==e.max||o.ymin!==i.min||o.ymax!==i.max;return Object.assign(o,s),l}const wA=n=>n===0||n===1,OG=(n,e,i)=>-(Math.pow(2,10*(n-=1))*Math.sin((n-e)*dr/i)),NG=(n,e,i)=>Math.pow(2,-10*n)*Math.sin((n-e)*dr/i)+1,Sx={linear:n=>n,easeInQuad:n=>n*n,easeOutQuad:n=>-n*(n-2),easeInOutQuad:n=>(n/=.5)<1?.5*n*n:-.5*(--n*(n-2)-1),easeInCubic:n=>n*n*n,easeOutCubic:n=>(n-=1)*n*n+1,easeInOutCubic:n=>(n/=.5)<1?.5*n*n*n:.5*((n-=2)*n*n+2),easeInQuart:n=>n*n*n*n,easeOutQuart:n=>-((n-=1)*n*n*n-1),easeInOutQuart:n=>(n/=.5)<1?.5*n*n*n*n:-.5*((n-=2)*n*n*n-2),easeInQuint:n=>n*n*n*n*n,easeOutQuint:n=>(n-=1)*n*n*n*n+1,easeInOutQuint:n=>(n/=.5)<1?.5*n*n*n*n*n:.5*((n-=2)*n*n*n*n+2),easeInSine:n=>-Math.cos(n*co)+1,easeOutSine:n=>Math.sin(n*co),easeInOutSine:n=>-.5*(Math.cos(hr*n)-1),easeInExpo:n=>n===0?0:Math.pow(2,10*(n-1)),easeOutExpo:n=>n===1?1:-Math.pow(2,-10*n)+1,easeInOutExpo:n=>wA(n)?n:n<.5?.5*Math.pow(2,10*(n*2-1)):.5*(-Math.pow(2,-10*(n*2-1))+2),easeInCirc:n=>n>=1?n:-(Math.sqrt(1-n*n)-1),easeOutCirc:n=>Math.sqrt(1-(n-=1)*n),easeInOutCirc:n=>(n/=.5)<1?-.5*(Math.sqrt(1-n*n)-1):.5*(Math.sqrt(1-(n-=2)*n)+1),easeInElastic:n=>wA(n)?n:OG(n,.075,.3),easeOutElastic:n=>wA(n)?n:NG(n,.075,.3),easeInOutElastic(n){return wA(n)?n:n<.5?.5*OG(n*2,.1125,.45):.5+.5*NG(n*2-1,.1125,.45)},easeInBack(n){return n*n*((1.70158+1)*n-1.70158)},easeOutBack(n){return(n-=1)*n*((1.70158+1)*n+1.70158)+1},easeInOutBack(n){let e=1.70158;return(n/=.5)<1?.5*(n*n*(((e*=1.525)+1)*n-e)):.5*((n-=2)*n*(((e*=1.525)+1)*n+e)+2)},easeInBounce:n=>1-Sx.easeOutBounce(1-n),easeOutBounce(n){return n<1/2.75?7.5625*n*n:n<2/2.75?7.5625*(n-=1.5/2.75)*n+.75:n<2.5/2.75?7.5625*(n-=2.25/2.75)*n+.9375:7.5625*(n-=2.625/2.75)*n+.984375},easeInOutBounce:n=>n<.5?Sx.easeInBounce(n*2)*.5:Sx.easeOutBounce(n*2-1)*.5+.5};function J6(n){if(n&&typeof n=="object"){const e=n.toString();return e==="[object CanvasPattern]"||e==="[object CanvasGradient]"}return!1}function zG(n){return J6(n)?n:new ww(n)}function xI(n){return J6(n)?n:new ww(n).saturate(.5).darken(.1).hexString()}const zTe=["x","y","borderWidth","radius","tension"],FTe=["color","borderColor","backgroundColor"];function BTe(n){n.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),n.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:e=>e!=="onProgress"&&e!=="onComplete"&&e!=="fn"}),n.set("animations",{colors:{type:"color",properties:FTe},numbers:{type:"number",properties:zTe}}),n.describe("animations",{_fallback:"animation"}),n.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:e=>e|0}}}})}function UTe(n){n.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}const FG=new Map;function WTe(n,e){e=e||{};const i=n+JSON.stringify(e);let o=FG.get(i);return o||(o=new Intl.NumberFormat(n,e),FG.set(i,o)),o}function a2(n,e,i){return WTe(e,i).format(n)}const nJ={values(n){return cr(n)?n:""+n},numeric(n,e,i){if(n===0)return"0";const o=this.chart.options.locale;let s,l=n;if(i.length>1){const y=Math.max(Math.abs(i[0].value),Math.abs(i[i.length-1].value));(y<1e-4||y>1e15)&&(s="scientific"),l=VTe(n,i)}const d=tf(Math.abs(l)),p=isNaN(d)?1:Math.max(Math.min(-1*Math.floor(d),20),0),f={notation:s,minimumFractionDigits:p,maximumFractionDigits:p};return Object.assign(f,this.options.ticks.format),a2(n,o,f)},logarithmic(n,e,i){if(n===0)return"0";const o=i[e].significand||n/Math.pow(10,Math.floor(tf(n)));return[1,2,3,5,10,15].includes(o)||e>.8*i.length?nJ.numeric.call(this,n,e,i):""}};function VTe(n,e){let i=e.length>3?e[2].value-e[1].value:e[1].value-e[0].value;return Math.abs(i)>=1&&n!==Math.floor(n)&&(i=n-Math.floor(n)),i}var pC={formatters:nJ};function GTe(n){n.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(e,i)=>i.lineWidth,tickColor:(e,i)=>i.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:pC.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),n.route("scale.ticks","color","","color"),n.route("scale.grid","color","","borderColor"),n.route("scale.border","color","","borderColor"),n.route("scale.title","color","","color"),n.describe("scale",{_fallback:!1,_scriptable:e=>!e.startsWith("before")&&!e.startsWith("after")&&e!=="callback"&&e!=="parser",_indexable:e=>e!=="borderDash"&&e!=="tickBorderDash"&&e!=="dash"}),n.describe("scales",{_fallback:"scale"}),n.describe("scale.ticks",{_scriptable:e=>e!=="backdropPadding"&&e!=="callback",_indexable:e=>e!=="backdropPadding"})}const Hg=Object.create(null),XR=Object.create(null);function Ax(n,e){if(!e)return n;const i=e.split(".");for(let o=0,s=i.length;o<s;++o){const l=i[o];n=n[l]||(n[l]=Object.create(null))}return n}function wI(n,e,i){return typeof e=="string"?Sw(Ax(n,e),i):Sw(Ax(n,""),e)}class HTe{constructor(e,i){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=o=>o.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(o,s)=>xI(s.backgroundColor),this.hoverBorderColor=(o,s)=>xI(s.borderColor),this.hoverColor=(o,s)=>xI(s.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(e),this.apply(i)}set(e,i){return wI(this,e,i)}get(e){return Ax(this,e)}describe(e,i){return wI(XR,e,i)}override(e,i){return wI(Hg,e,i)}route(e,i,o,s){const l=Ax(this,e),d=Ax(this,o),p="_"+i;Object.defineProperties(l,{[p]:{value:l[i],writable:!0},[i]:{enumerable:!0,get(){const f=this[p],y=d[s];return Qi(f)?Object.assign({},y,f):Fi(f,y)},set(f){this[p]=f}}})}apply(e){e.forEach(i=>i(this))}}var Zr=new HTe({_scriptable:n=>!n.startsWith("on"),_indexable:n=>n!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[BTe,UTe,GTe]);function jTe(n){return!n||da(n.size)||da(n.family)?null:(n.style?n.style+" ":"")+(n.weight?n.weight+" ":"")+n.size+"px "+n.family}function vM(n,e,i,o,s){let l=e[s];return l||(l=e[s]=n.measureText(s).width,i.push(s)),l>o&&(o=l),o}function $Te(n,e,i,o){o=o||{};let s=o.data=o.data||{},l=o.garbageCollect=o.garbageCollect||[];o.font!==e&&(s=o.data={},l=o.garbageCollect=[],o.font=e),n.save(),n.font=e;let d=0;const p=i.length;let f,y,_,x,S;for(f=0;f<p;f++)if(x=i[f],x!=null&&!cr(x))d=vM(n,s,l,d,x);else if(cr(x))for(y=0,_=x.length;y<_;y++)S=x[y],S!=null&&!cr(S)&&(d=vM(n,s,l,d,S));n.restore();const T=l.length/2;if(T>i.length){for(f=0;f<T;f++)delete s[l[f]];l.splice(0,T)}return d}function qm(n,e,i){const o=n.currentDevicePixelRatio,s=i!==0?Math.max(i/2,.5):0;return Math.round((e-s)*o)/o+s}function BG(n,e){e=e||n.getContext("2d"),e.save(),e.resetTransform(),e.clearRect(0,0,n.width,n.height),e.restore()}function ZR(n,e,i,o){iJ(n,e,i,o,null)}function iJ(n,e,i,o,s){let l,d,p,f,y,_,x,S;const T=e.pointStyle,I=e.rotation,R=e.radius;let D=(I||0)*TTe;if(T&&typeof T=="object"&&(l=T.toString(),l==="[object HTMLImageElement]"||l==="[object HTMLCanvasElement]")){n.save(),n.translate(i,o),n.rotate(D),n.drawImage(T,-T.width/2,-T.height/2,T.width,T.height),n.restore();return}if(!(isNaN(R)||R<=0)){switch(n.beginPath(),T){default:s?n.ellipse(i,o,s/2,R,0,0,dr):n.arc(i,o,R,0,dr),n.closePath();break;case"triangle":_=s?s/2:R,n.moveTo(i+Math.sin(D)*_,o-Math.cos(D)*R),D+=LG,n.lineTo(i+Math.sin(D)*_,o-Math.cos(D)*R),D+=LG,n.lineTo(i+Math.sin(D)*_,o-Math.cos(D)*R),n.closePath();break;case"rectRounded":y=R*.516,f=R-y,d=Math.cos(D+Ym)*f,x=Math.cos(D+Ym)*(s?s/2-y:f),p=Math.sin(D+Ym)*f,S=Math.sin(D+Ym)*(s?s/2-y:f),n.arc(i-x,o-p,y,D-hr,D-co),n.arc(i+S,o-d,y,D-co,D),n.arc(i+x,o+p,y,D,D+co),n.arc(i-S,o+d,y,D+co,D+hr),n.closePath();break;case"rect":if(!I){f=Math.SQRT1_2*R,_=s?s/2:f,n.rect(i-_,o-f,2*_,2*f);break}D+=Ym;case"rectRot":x=Math.cos(D)*(s?s/2:R),d=Math.cos(D)*R,p=Math.sin(D)*R,S=Math.sin(D)*(s?s/2:R),n.moveTo(i-x,o-p),n.lineTo(i+S,o-d),n.lineTo(i+x,o+p),n.lineTo(i-S,o+d),n.closePath();break;case"crossRot":D+=Ym;case"cross":x=Math.cos(D)*(s?s/2:R),d=Math.cos(D)*R,p=Math.sin(D)*R,S=Math.sin(D)*(s?s/2:R),n.moveTo(i-x,o-p),n.lineTo(i+x,o+p),n.moveTo(i+S,o-d),n.lineTo(i-S,o+d);break;case"star":x=Math.cos(D)*(s?s/2:R),d=Math.cos(D)*R,p=Math.sin(D)*R,S=Math.sin(D)*(s?s/2:R),n.moveTo(i-x,o-p),n.lineTo(i+x,o+p),n.moveTo(i+S,o-d),n.lineTo(i-S,o+d),D+=Ym,x=Math.cos(D)*(s?s/2:R),d=Math.cos(D)*R,p=Math.sin(D)*R,S=Math.sin(D)*(s?s/2:R),n.moveTo(i-x,o-p),n.lineTo(i+x,o+p),n.moveTo(i+S,o-d),n.lineTo(i-S,o+d);break;case"line":d=s?s/2:Math.cos(D)*R,p=Math.sin(D)*R,n.moveTo(i-d,o-p),n.lineTo(i+d,o+p);break;case"dash":n.moveTo(i,o),n.lineTo(i+Math.cos(D)*(s?s/2:R),o+Math.sin(D)*R);break;case!1:n.closePath();break}n.fill(),e.borderWidth>0&&n.stroke()}}function Oh(n,e,i){return i=i||.5,!e||n&&n.x>e.left-i&&n.x<e.right+i&&n.y>e.top-i&&n.y<e.bottom+i}function fC(n,e){n.save(),n.beginPath(),n.rect(e.left,e.top,e.right-e.left,e.bottom-e.top),n.clip()}function mC(n){n.restore()}function YTe(n,e,i,o,s){if(!e)return n.lineTo(i.x,i.y);if(s==="middle"){const l=(e.x+i.x)/2;n.lineTo(l,e.y),n.lineTo(l,i.y)}else s==="after"!=!!o?n.lineTo(e.x,i.y):n.lineTo(i.x,e.y);n.lineTo(i.x,i.y)}function qTe(n,e,i,o){if(!e)return n.lineTo(i.x,i.y);n.bezierCurveTo(o?e.cp1x:e.cp2x,o?e.cp1y:e.cp2y,o?i.cp2x:i.cp1x,o?i.cp2y:i.cp1y,i.x,i.y)}function XTe(n,e){e.translation&&n.translate(e.translation[0],e.translation[1]),da(e.rotation)||n.rotate(e.rotation),e.color&&(n.fillStyle=e.color),e.textAlign&&(n.textAlign=e.textAlign),e.textBaseline&&(n.textBaseline=e.textBaseline)}function ZTe(n,e,i,o,s){if(s.strikethrough||s.underline){const l=n.measureText(o),d=e-l.actualBoundingBoxLeft,p=e+l.actualBoundingBoxRight,f=i-l.actualBoundingBoxAscent,y=i+l.actualBoundingBoxDescent,_=s.strikethrough?(f+y)/2:y;n.strokeStyle=n.fillStyle,n.beginPath(),n.lineWidth=s.decorationWidth||2,n.moveTo(d,_),n.lineTo(p,_),n.stroke()}}function KTe(n,e){const i=n.fillStyle;n.fillStyle=e.color,n.fillRect(e.left,e.top,e.width,e.height),n.fillStyle=i}function jg(n,e,i,o,s,l={}){const d=cr(e)?e:[e],p=l.strokeWidth>0&&l.strokeColor!=="";let f,y;for(n.save(),n.font=s.string,XTe(n,l),f=0;f<d.length;++f)y=d[f],l.backdrop&&KTe(n,l.backdrop),p&&(l.strokeColor&&(n.strokeStyle=l.strokeColor),da(l.strokeWidth)||(n.lineWidth=l.strokeWidth),n.strokeText(y,i,o,l.maxWidth)),n.fillText(y,i,o,l.maxWidth),ZTe(n,i,o,y,l),o+=Number(s.lineHeight);n.restore()}function Mw(n,e){const{x:i,y:o,w:s,h:l,radius:d}=e;n.arc(i+d.topLeft,o+d.topLeft,d.topLeft,1.5*hr,hr,!0),n.lineTo(i,o+l-d.bottomLeft),n.arc(i+d.bottomLeft,o+l-d.bottomLeft,d.bottomLeft,hr,co,!0),n.lineTo(i+s-d.bottomRight,o+l),n.arc(i+s-d.bottomRight,o+l-d.bottomRight,d.bottomRight,co,0,!0),n.lineTo(i+s,o+d.topRight),n.arc(i+s-d.topRight,o+d.topRight,d.topRight,0,-co,!0),n.lineTo(i+d.topLeft,o)}const JTe=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,QTe=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function eCe(n,e){const i=(""+n).match(JTe);if(!i||i[1]==="normal")return e*1.2;switch(n=+i[2],i[3]){case"px":return n;case"%":n/=100;break}return e*n}const tCe=n=>+n||0;function Q6(n,e){const i={},o=Qi(e),s=o?Object.keys(e):e,l=Qi(n)?o?d=>Fi(n[d],n[e[d]]):d=>n[d]:()=>n;for(const d of s)i[d]=tCe(l(d));return i}function aJ(n){return Q6(n,{top:"y",right:"x",bottom:"y",left:"x"})}function Cg(n){return Q6(n,["topLeft","topRight","bottomLeft","bottomRight"])}function Ms(n){const e=aJ(n);return e.width=e.left+e.right,e.height=e.top+e.bottom,e}function Ro(n,e){n=n||{},e=e||Zr.font;let i=Fi(n.size,e.size);typeof i=="string"&&(i=parseInt(i,10));let o=Fi(n.style,e.style);o&&!(""+o).match(QTe)&&(console.warn('Invalid font style specified: "'+o+'"'),o=void 0);const s={family:Fi(n.family,e.family),lineHeight:eCe(Fi(n.lineHeight,e.lineHeight),i),size:i,style:o,weight:Fi(n.weight,e.weight),string:""};return s.string=jTe(s),s}function Hb(n,e,i,o){let s=!0,l,d,p;for(l=0,d=n.length;l<d;++l)if(p=n[l],p!==void 0&&(e!==void 0&&typeof p=="function"&&(p=p(e),s=!1),i!==void 0&&cr(p)&&(p=p[i%p.length],s=!1),p!==void 0))return o&&!s&&(o.cacheable=!1),p}function nCe(n,e,i){const{min:o,max:s}=n,l=$K(e,(s-o)/2),d=(p,f)=>i&&p===0?0:p+f;return{min:d(o,-Math.abs(l)),max:d(s,l)}}function Of(n,e){return Object.assign(Object.create(n),e)}function eO(n,e=[""],i,o,s=()=>n[0]){const l=i||n;typeof o>"u"&&(o=lJ("_fallback",n));const d={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:n,_rootScopes:l,_fallback:o,_getTarget:s,override:p=>eO([p,...n],e,l,o)};return new Proxy(d,{deleteProperty(p,f){return delete p[f],delete p._keys,delete n[0][f],!0},get(p,f){return oJ(p,f,()=>uCe(f,e,n,p))},getOwnPropertyDescriptor(p,f){return Reflect.getOwnPropertyDescriptor(p._scopes[0],f)},getPrototypeOf(){return Reflect.getPrototypeOf(n[0])},has(p,f){return WG(p).includes(f)},ownKeys(p){return WG(p)},set(p,f,y){const _=p._storage||(p._storage=s());return p[f]=_[f]=y,delete p._keys,!0}})}function m_(n,e,i,o){const s={_cacheable:!1,_proxy:n,_context:e,_subProxy:i,_stack:new Set,_descriptors:rJ(n,o),setContext:l=>m_(n,l,i,o),override:l=>m_(n.override(l),e,i,o)};return new Proxy(s,{deleteProperty(l,d){return delete l[d],delete n[d],!0},get(l,d,p){return oJ(l,d,()=>aCe(l,d,p))},getOwnPropertyDescriptor(l,d){return l._descriptors.allKeys?Reflect.has(n,d)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(n,d)},getPrototypeOf(){return Reflect.getPrototypeOf(n)},has(l,d){return Reflect.has(n,d)},ownKeys(){return Reflect.ownKeys(n)},set(l,d,p){return n[d]=p,delete l[d],!0}})}function rJ(n,e={scriptable:!0,indexable:!0}){const{_scriptable:i=e.scriptable,_indexable:o=e.indexable,_allKeys:s=e.allKeys}=n;return{allKeys:s,scriptable:i,indexable:o,isScriptable:Mf(i)?i:()=>i,isIndexable:Mf(o)?o:()=>o}}const iCe=(n,e)=>n?n+q6(e):e,tO=(n,e)=>Qi(e)&&n!=="adapters"&&(Object.getPrototypeOf(e)===null||e.constructor===Object);function oJ(n,e,i){if(Object.prototype.hasOwnProperty.call(n,e))return n[e];const o=i();return n[e]=o,o}function aCe(n,e,i){const{_proxy:o,_context:s,_subProxy:l,_descriptors:d}=n;let p=o[e];return Mf(p)&&d.isScriptable(e)&&(p=rCe(e,p,n,i)),cr(p)&&p.length&&(p=oCe(e,p,n,d.isIndexable)),tO(e,p)&&(p=m_(p,s,l&&l[e],d)),p}function rCe(n,e,i,o){const{_proxy:s,_context:l,_subProxy:d,_stack:p}=i;if(p.has(n))throw new Error("Recursion detected: "+Array.from(p).join("->")+"->"+n);p.add(n);let f=e(l,d||o);return p.delete(n),tO(n,f)&&(f=nO(s._scopes,s,n,f)),f}function oCe(n,e,i,o){const{_proxy:s,_context:l,_subProxy:d,_descriptors:p}=i;if(typeof l.index<"u"&&o(n))return e[l.index%e.length];if(Qi(e[0])){const f=e,y=s._scopes.filter(_=>_!==f);e=[];for(const _ of f){const x=nO(y,s,n,_);e.push(m_(x,l,d&&d[n],p))}}return e}function sJ(n,e,i){return Mf(n)?n(e,i):n}const sCe=(n,e)=>n===!0?e:typeof n=="string"?Ef(e,n):void 0;function lCe(n,e,i,o,s){for(const l of e){const d=sCe(i,l);if(d){n.add(d);const p=sJ(d._fallback,i,s);if(typeof p<"u"&&p!==i&&p!==o)return p}else if(d===!1&&typeof o<"u"&&i!==o)return null}return!1}function nO(n,e,i,o){const s=e._rootScopes,l=sJ(e._fallback,i,o),d=[...n,...s],p=new Set;p.add(o);let f=UG(p,d,i,l||i,o);return f===null||typeof l<"u"&&l!==i&&(f=UG(p,d,l,f,o),f===null)?!1:eO(Array.from(p),[""],s,l,()=>cCe(e,i,o))}function UG(n,e,i,o,s){for(;i;)i=lCe(n,e,i,o,s);return i}function cCe(n,e,i){const o=n._getTarget();e in o||(o[e]={});const s=o[e];return cr(s)&&Qi(i)?i:s||{}}function uCe(n,e,i,o){let s;for(const l of e)if(s=lJ(iCe(l,n),i),typeof s<"u")return tO(n,s)?nO(i,o,n,s):s}function lJ(n,e){for(const i of e){if(!i)continue;const o=i[n];if(typeof o<"u")return o}}function WG(n){let e=n._keys;return e||(e=n._keys=dCe(n._scopes)),e}function dCe(n){const e=new Set;for(const i of n)for(const o of Object.keys(i).filter(s=>!s.startsWith("_")))e.add(o);return Array.from(e)}function cJ(n,e,i,o){const{iScale:s}=n,{key:l="r"}=this._parsing,d=new Array(o);let p,f,y,_;for(p=0,f=o;p<f;++p)y=p+i,_=e[y],d[p]={r:s.parse(Ef(_,l),y)};return d}const hCe=Number.EPSILON||1e-14,g_=(n,e)=>e<n.length&&!n[e].skip&&n[e],uJ=n=>n==="x"?"y":"x";function pCe(n,e,i,o){const s=n.skip?e:n,l=e,d=i.skip?e:i,p=qR(l,s),f=qR(d,l);let y=p/(p+f),_=f/(p+f);y=isNaN(y)?0:y,_=isNaN(_)?0:_;const x=o*y,S=o*_;return{previous:{x:l.x-x*(d.x-s.x),y:l.y-x*(d.y-s.y)},next:{x:l.x+S*(d.x-s.x),y:l.y+S*(d.y-s.y)}}}function fCe(n,e,i){const o=n.length;let s,l,d,p,f,y=g_(n,0);for(let _=0;_<o-1;++_)if(f=y,y=g_(n,_+1),!(!f||!y)){if(wx(e[_],0,hCe)){i[_]=i[_+1]=0;continue}s=i[_]/e[_],l=i[_+1]/e[_],p=Math.pow(s,2)+Math.pow(l,2),!(p<=9)&&(d=3/Math.sqrt(p),i[_]=s*d*e[_],i[_+1]=l*d*e[_])}}function mCe(n,e,i="x"){const o=uJ(i),s=n.length;let l,d,p,f=g_(n,0);for(let y=0;y<s;++y){if(d=p,p=f,f=g_(n,y+1),!p)continue;const _=p[i],x=p[o];d&&(l=(_-d[i])/3,p[`cp1${i}`]=_-l,p[`cp1${o}`]=x-l*e[y]),f&&(l=(f[i]-_)/3,p[`cp2${i}`]=_+l,p[`cp2${o}`]=x+l*e[y])}}function gCe(n,e="x"){const i=uJ(e),o=n.length,s=Array(o).fill(0),l=Array(o);let d,p,f,y=g_(n,0);for(d=0;d<o;++d)if(p=f,f=y,y=g_(n,d+1),!!f){if(y){const _=y[e]-f[e];s[d]=_!==0?(y[i]-f[i])/_:0}l[d]=p?y?_d(s[d-1])!==_d(s[d])?0:(s[d-1]+s[d])/2:s[d-1]:s[d]}fCe(n,s,l),mCe(n,l,e)}function SA(n,e,i){return Math.max(Math.min(n,i),e)}function yCe(n,e){let i,o,s,l,d,p=Oh(n[0],e);for(i=0,o=n.length;i<o;++i)d=l,l=p,p=i<o-1&&Oh(n[i+1],e),l&&(s=n[i],d&&(s.cp1x=SA(s.cp1x,e.left,e.right),s.cp1y=SA(s.cp1y,e.top,e.bottom)),p&&(s.cp2x=SA(s.cp2x,e.left,e.right),s.cp2y=SA(s.cp2y,e.top,e.bottom)))}function vCe(n,e,i,o,s){let l,d,p,f;if(e.spanGaps&&(n=n.filter(y=>!y.skip)),e.cubicInterpolationMode==="monotone")gCe(n,s);else{let y=o?n[n.length-1]:n[0];for(l=0,d=n.length;l<d;++l)p=n[l],f=pCe(y,p,n[Math.min(l+1,d-(o?0:1))%d],e.tension),p.cp1x=f.previous.x,p.cp1y=f.previous.y,p.cp2x=f.next.x,p.cp2y=f.next.y,y=p}e.capBezierPoints&&yCe(n,i)}function dJ(){return typeof window<"u"&&typeof document<"u"}function iO(n){let e=n.parentNode;return e&&e.toString()==="[object ShadowRoot]"&&(e=e.host),e}function _M(n,e,i){let o;return typeof n=="string"?(o=parseInt(n,10),n.indexOf("%")!==-1&&(o=o/100*e.parentNode[i])):o=n,o}const gC=n=>n.ownerDocument.defaultView.getComputedStyle(n,null);function _Ce(n,e){return gC(n).getPropertyValue(e)}const bCe=["top","right","bottom","left"];function Pg(n,e,i){const o={};i=i?"-"+i:"";for(let s=0;s<4;s++){const l=bCe[s];o[l]=parseFloat(n[e+"-"+l+i])||0}return o.width=o.left+o.right,o.height=o.top+o.bottom,o}const xCe=(n,e,i)=>(n>0||e>0)&&(!i||!i.shadowRoot);function wCe(n,e){const i=n.touches,o=i&&i.length?i[0]:n,{offsetX:s,offsetY:l}=o;let d=!1,p,f;if(xCe(s,l,n.target))p=s,f=l;else{const y=e.getBoundingClientRect();p=o.clientX-y.left,f=o.clientY-y.top,d=!0}return{x:p,y:f,box:d}}function rg(n,e){if("native"in n)return n;const{canvas:i,currentDevicePixelRatio:o}=e,s=gC(i),l=s.boxSizing==="border-box",d=Pg(s,"padding"),p=Pg(s,"border","width"),{x:f,y,box:_}=wCe(n,i),x=d.left+(_&&p.left),S=d.top+(_&&p.top);let{width:T,height:I}=e;return l&&(T-=d.width+p.width,I-=d.height+p.height),{x:Math.round((f-x)/T*i.width/o),y:Math.round((y-S)/I*i.height/o)}}function SCe(n,e,i){let o,s;if(e===void 0||i===void 0){const l=iO(n);if(!l)e=n.clientWidth,i=n.clientHeight;else{const d=l.getBoundingClientRect(),p=gC(l),f=Pg(p,"border","width"),y=Pg(p,"padding");e=d.width-y.width-f.width,i=d.height-y.height-f.height,o=_M(p.maxWidth,l,"clientWidth"),s=_M(p.maxHeight,l,"clientHeight")}}return{width:e,height:i,maxWidth:o||yM,maxHeight:s||yM}}const AA=n=>Math.round(n*10)/10;function ACe(n,e,i,o){const s=gC(n),l=Pg(s,"margin"),d=_M(s.maxWidth,n,"clientWidth")||yM,p=_M(s.maxHeight,n,"clientHeight")||yM,f=SCe(n,e,i);let{width:y,height:_}=f;if(s.boxSizing==="content-box"){const S=Pg(s,"border","width"),T=Pg(s,"padding");y-=T.width+S.width,_-=T.height+S.height}return y=Math.max(0,y-l.width),_=Math.max(0,o?y/o:_-l.height),y=AA(Math.min(y,d,f.maxWidth)),_=AA(Math.min(_,p,f.maxHeight)),y&&!_&&(_=AA(y/2)),(e!==void 0||i!==void 0)&&o&&f.height&&_>f.height&&(_=f.height,y=AA(Math.floor(_*o))),{width:y,height:_}}function VG(n,e,i){const o=e||1,s=Math.floor(n.height*o),l=Math.floor(n.width*o);n.height=Math.floor(n.height),n.width=Math.floor(n.width);const d=n.canvas;return d.style&&(i||!d.style.height&&!d.style.width)&&(d.style.height=`${n.height}px`,d.style.width=`${n.width}px`),n.currentDevicePixelRatio!==o||d.height!==s||d.width!==l?(n.currentDevicePixelRatio=o,d.height=s,d.width=l,n.ctx.setTransform(o,0,0,o,0,0),!0):!1}const ECe=function(){let n=!1;try{const e={get passive(){return n=!0,!1}};window.addEventListener("test",null,e),window.removeEventListener("test",null,e)}catch{}return n}();function GG(n,e){const i=_Ce(n,e),o=i&&i.match(/^(\d+)(\.\d+)?px$/);return o?+o[1]:void 0}function og(n,e,i,o){return{x:n.x+i*(e.x-n.x),y:n.y+i*(e.y-n.y)}}function MCe(n,e,i,o){return{x:n.x+i*(e.x-n.x),y:o==="middle"?i<.5?n.y:e.y:o==="after"?i<1?n.y:e.y:i>0?e.y:n.y}}function TCe(n,e,i,o){const s={x:n.cp2x,y:n.cp2y},l={x:e.cp1x,y:e.cp1y},d=og(n,s,i),p=og(s,l,i),f=og(l,e,i),y=og(d,p,i),_=og(p,f,i);return og(y,_,i)}const CCe=function(n,e){return{x(i){return n+n+e-i},setWidth(i){e=i},textAlign(i){return i==="center"?i:i==="right"?"left":"right"},xPlus(i,o){return i-o},leftForLtr(i,o){return i-o}}},PCe=function(){return{x(n){return n},setWidth(n){},textAlign(n){return n},xPlus(n,e){return n+e},leftForLtr(n,e){return n}}};function j0(n,e,i){return n?CCe(e,i):PCe()}function hJ(n,e){let i,o;(e==="ltr"||e==="rtl")&&(i=n.canvas.style,o=[i.getPropertyValue("direction"),i.getPropertyPriority("direction")],i.setProperty("direction",e,"important"),n.prevTextDirection=o)}function pJ(n,e){e!==void 0&&(delete n.prevTextDirection,n.canvas.style.setProperty("direction",e[0],e[1]))}function fJ(n){return n==="angle"?{between:Ew,compare:ITe,normalize:Gl}:{between:kh,compare:(e,i)=>e-i,normalize:e=>e}}function HG({start:n,end:e,count:i,loop:o,style:s}){return{start:n%i,end:e%i,loop:o&&(e-n+1)%i===0,style:s}}function ICe(n,e,i){const{property:o,start:s,end:l}=i,{between:d,normalize:p}=fJ(o),f=e.length;let{start:y,end:_,loop:x}=n,S,T;if(x){for(y+=f,_+=f,S=0,T=f;S<T&&d(p(e[y%f][o]),s,l);++S)y--,_--;y%=f,_%=f}return _<y&&(_+=f),{start:y,end:_,loop:x,style:n.style}}function mJ(n,e,i){if(!i)return[n];const{property:o,start:s,end:l}=i,d=e.length,{compare:p,between:f,normalize:y}=fJ(o),{start:_,end:x,loop:S,style:T}=ICe(n,e,i),I=[];let R=!1,D=null,L,O,N;const F=()=>f(s,N,L)&&p(s,N)!==0,G=()=>p(l,L)===0||f(l,N,L),j=()=>R||F(),Y=()=>!R||G();for(let te=_,V=_;te<=x;++te)O=e[te%d],!O.skip&&(L=y(O[o]),L!==N&&(R=f(L,s,l),D===null&&j()&&(D=p(L,s)===0?te:V),D!==null&&Y()&&(I.push(HG({start:D,end:te,loop:S,count:d,style:T})),D=null),V=te,N=L));return D!==null&&I.push(HG({start:D,end:x,loop:S,count:d,style:T})),I}function gJ(n,e){const i=[],o=n.segments;for(let s=0;s<o.length;s++){const l=mJ(o[s],n.points,e);l.length&&i.push(...l)}return i}function LCe(n,e,i,o){let s=0,l=e-1;if(i&&!o)for(;s<e&&!n[s].skip;)s++;for(;s<e&&n[s].skip;)s++;for(s%=e,i&&(l+=s);l>s&&n[l%e].skip;)l--;return l%=e,{start:s,end:l}}function RCe(n,e,i,o){const s=n.length,l=[];let d=e,p=n[e],f;for(f=e+1;f<=i;++f){const y=n[f%s];y.skip||y.stop?p.skip||(o=!1,l.push({start:e%s,end:(f-1)%s,loop:o}),e=d=y.stop?f:null):(d=f,p.skip&&(e=f)),p=y}return d!==null&&l.push({start:e%s,end:d%s,loop:o}),l}function kCe(n,e){const i=n.points,o=n.options.spanGaps,s=i.length;if(!s)return[];const l=!!n._loop,{start:d,end:p}=LCe(i,s,l,o);if(o===!0)return jG(n,[{start:d,end:p,loop:l}],i,e);const f=p<d?p+s:p,y=!!n._fullLoop&&d===0&&p===s-1;return jG(n,RCe(i,d,f,y),i,e)}function jG(n,e,i,o){return!o||!o.setContext||!i?e:DCe(n,e,i,o)}function DCe(n,e,i,o){const s=n._chart.getContext(),l=$G(n.options),{_datasetIndex:d,options:{spanGaps:p}}=n,f=i.length,y=[];let _=l,x=e[0].start,S=x;function T(I,R,D,L){const O=p?-1:1;if(I!==R){for(I+=f;i[I%f].skip;)I-=O;for(;i[R%f].skip;)R+=O;I%f!==R%f&&(y.push({start:I%f,end:R%f,loop:D,style:L}),_=L,x=R%f)}}for(const I of e){x=p?x:I.start;let R=i[x%f],D;for(S=x+1;S<=I.end;S++){const L=i[S%f];D=$G(o.setContext(Of(s,{type:"segment",p0:R,p1:L,p0DataIndex:(S-1)%f,p1DataIndex:S%f,datasetIndex:d}))),OCe(D,_)&&T(x,S-1,I.loop,_),R=L,_=D}x<S-1&&T(x,S-1,I.loop,_)}return y}function $G(n){return{backgroundColor:n.backgroundColor,borderCapStyle:n.borderCapStyle,borderDash:n.borderDash,borderDashOffset:n.borderDashOffset,borderJoinStyle:n.borderJoinStyle,borderWidth:n.borderWidth,borderColor:n.borderColor}}function OCe(n,e){if(!e)return!1;const i=[],o=function(s,l){return J6(l)?(i.includes(l)||i.push(l),i.indexOf(l)):l};return JSON.stringify(n,o)!==JSON.stringify(e,o)}/*!
 * Chart.js v4.4.0
 * https://www.chartjs.org
 * (c) 2023 Chart.js Contributors
 * Released under the MIT License
 */class NCe{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(e,i,o,s){const l=i.listeners[s],d=i.duration;l.forEach(p=>p({chart:e,initial:i.initial,numSteps:d,currentStep:Math.min(o-i.start,d)}))}_refresh(){this._request||(this._running=!0,this._request=JK.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(e=Date.now()){let i=0;this._charts.forEach((o,s)=>{if(!o.running||!o.items.length)return;const l=o.items;let d=l.length-1,p=!1,f;for(;d>=0;--d)f=l[d],f._active?(f._total>o.duration&&(o.duration=f._total),f.tick(e),p=!0):(l[d]=l[l.length-1],l.pop());p&&(s.draw(),this._notify(s,o,e,"progress")),l.length||(o.running=!1,this._notify(s,o,e,"complete"),o.initial=!1),i+=l.length}),this._lastDate=e,i===0&&(this._running=!1)}_getAnims(e){const i=this._charts;let o=i.get(e);return o||(o={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},i.set(e,o)),o}listen(e,i,o){this._getAnims(e).listeners[i].push(o)}add(e,i){!i||!i.length||this._getAnims(e).items.push(...i)}has(e){return this._getAnims(e).items.length>0}start(e){const i=this._charts.get(e);i&&(i.running=!0,i.start=Date.now(),i.duration=i.items.reduce((o,s)=>Math.max(o,s._duration),0),this._refresh())}running(e){if(!this._running)return!1;const i=this._charts.get(e);return!(!i||!i.running||!i.items.length)}stop(e){const i=this._charts.get(e);if(!i||!i.items.length)return;const o=i.items;let s=o.length-1;for(;s>=0;--s)o[s].cancel();i.items=[],this._notify(e,i,Date.now(),"complete")}remove(e){return this._charts.delete(e)}}var bh=new NCe;const YG="transparent",zCe={boolean(n,e,i){return i>.5?e:n},color(n,e,i){const o=zG(n||YG),s=o.valid&&zG(e||YG);return s&&s.valid?s.mix(o,i).hexString():e},number(n,e,i){return n+(e-n)*i}};class FCe{constructor(e,i,o,s){const l=i[o];s=Hb([e.to,s,l,e.from]);const d=Hb([e.from,l,s]);this._active=!0,this._fn=e.fn||zCe[e.type||typeof d],this._easing=Sx[e.easing]||Sx.linear,this._start=Math.floor(Date.now()+(e.delay||0)),this._duration=this._total=Math.floor(e.duration),this._loop=!!e.loop,this._target=i,this._prop=o,this._from=d,this._to=s,this._promises=void 0}active(){return this._active}update(e,i,o){if(this._active){this._notify(!1);const s=this._target[this._prop],l=o-this._start,d=this._duration-l;this._start=o,this._duration=Math.floor(Math.max(d,e.duration)),this._total+=l,this._loop=!!e.loop,this._to=Hb([e.to,i,s,e.from]),this._from=Hb([e.from,s,i])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(e){const i=e-this._start,o=this._duration,s=this._prop,l=this._from,d=this._loop,p=this._to;let f;if(this._active=l!==p&&(d||i<o),!this._active){this._target[s]=p,this._notify(!0);return}if(i<0){this._target[s]=l;return}f=i/o%2,f=d&&f>1?2-f:f,f=this._easing(Math.min(1,Math.max(0,f))),this._target[s]=this._fn(l,p,f)}wait(){const e=this._promises||(this._promises=[]);return new Promise((i,o)=>{e.push({res:i,rej:o})})}_notify(e){const i=e?"res":"rej",o=this._promises||[];for(let s=0;s<o.length;s++)o[s][i]()}}class yJ{constructor(e,i){this._chart=e,this._properties=new Map,this.configure(i)}configure(e){if(!Qi(e))return;const i=Object.keys(Zr.animation),o=this._properties;Object.getOwnPropertyNames(e).forEach(s=>{const l=e[s];if(!Qi(l))return;const d={};for(const p of i)d[p]=l[p];(cr(l.properties)&&l.properties||[s]).forEach(p=>{(p===s||!o.has(p))&&o.set(p,d)})})}_animateOptions(e,i){const o=i.options,s=UCe(e,o);if(!s)return[];const l=this._createAnimations(s,o);return o.$shared&&BCe(e.options.$animations,o).then(()=>{e.options=o},()=>{}),l}_createAnimations(e,i){const o=this._properties,s=[],l=e.$animations||(e.$animations={}),d=Object.keys(i),p=Date.now();let f;for(f=d.length-1;f>=0;--f){const y=d[f];if(y.charAt(0)==="$")continue;if(y==="options"){s.push(...this._animateOptions(e,i));continue}const _=i[y];let x=l[y];const S=o.get(y);if(x)if(S&&x.active()){x.update(S,_,p);continue}else x.cancel();if(!S||!S.duration){e[y]=_;continue}l[y]=x=new FCe(S,e,y,_),s.push(x)}return s}update(e,i){if(this._properties.size===0){Object.assign(e,i);return}const o=this._createAnimations(e,i);if(o.length)return bh.add(this._chart,o),!0}}function BCe(n,e){const i=[],o=Object.keys(e);for(let s=0;s<o.length;s++){const l=n[o[s]];l&&l.active()&&i.push(l.wait())}return Promise.all(i)}function UCe(n,e){if(!e)return;let i=n.options;if(!i){n.options=e;return}return i.$shared&&(n.options=i=Object.assign({},i,{$shared:!1,$animations:{}})),i}function qG(n,e){const i=n&&n.options||{},o=i.reverse,s=i.min===void 0?e:0,l=i.max===void 0?e:0;return{start:o?l:s,end:o?s:l}}function WCe(n,e,i){if(i===!1)return!1;const o=qG(n,i),s=qG(e,i);return{top:s.end,right:o.end,bottom:s.start,left:o.start}}function VCe(n){let e,i,o,s;return Qi(n)?(e=n.top,i=n.right,o=n.bottom,s=n.left):e=i=o=s=n,{top:e,right:i,bottom:o,left:s,disabled:n===!1}}function vJ(n,e){const i=[],o=n._getSortedDatasetMetas(e);let s,l;for(s=0,l=o.length;s<l;++s)i.push(o[s].index);return i}function XG(n,e,i,o={}){const s=n.keys,l=o.mode==="single";let d,p,f,y;if(e!==null){for(d=0,p=s.length;d<p;++d){if(f=+s[d],f===i){if(o.all)continue;break}y=n.values[f],Xr(y)&&(l||e===0||_d(e)===_d(y))&&(e+=y)}return e}}function GCe(n){const e=Object.keys(n),i=new Array(e.length);let o,s,l;for(o=0,s=e.length;o<s;++o)l=e[o],i[o]={x:l,y:n[l]};return i}function ZG(n,e){const i=n&&n.options.stacked;return i||i===void 0&&e.stack!==void 0}function HCe(n,e,i){return`${n.id}.${e.id}.${i.stack||i.type}`}function jCe(n){const{min:e,max:i,minDefined:o,maxDefined:s}=n.getUserBounds();return{min:o?e:Number.NEGATIVE_INFINITY,max:s?i:Number.POSITIVE_INFINITY}}function $Ce(n,e,i){const o=n[e]||(n[e]={});return o[i]||(o[i]={})}function KG(n,e,i,o){for(const s of e.getMatchingVisibleMetas(o).reverse()){const l=n[s.index];if(i&&l>0||!i&&l<0)return s.index}return null}function JG(n,e){const{chart:i,_cachedMeta:o}=n,s=i._stacks||(i._stacks={}),{iScale:l,vScale:d,index:p}=o,f=l.axis,y=d.axis,_=HCe(l,d,o),x=e.length;let S;for(let T=0;T<x;++T){const I=e[T],{[f]:R,[y]:D}=I,L=I._stacks||(I._stacks={});S=L[y]=$Ce(s,_,R),S[p]=D,S._top=KG(S,d,!0,o.type),S._bottom=KG(S,d,!1,o.type);const O=S._visualValues||(S._visualValues={});O[p]=D}}function SI(n,e){const i=n.scales;return Object.keys(i).filter(o=>i[o].axis===e).shift()}function YCe(n,e){return Of(n,{active:!1,dataset:void 0,datasetIndex:e,index:e,mode:"default",type:"dataset"})}function qCe(n,e,i){return Of(n,{active:!1,dataIndex:e,parsed:void 0,raw:void 0,element:i,index:e,mode:"default",type:"data"})}function Mb(n,e){const i=n.controller.index,o=n.vScale&&n.vScale.axis;if(o){e=e||n._parsed;for(const s of e){const l=s._stacks;if(!l||l[o]===void 0||l[o][i]===void 0)return;delete l[o][i],l[o]._visualValues!==void 0&&l[o]._visualValues[i]!==void 0&&delete l[o]._visualValues[i]}}}const AI=n=>n==="reset"||n==="none",QG=(n,e)=>e?n:Object.assign({},n),XCe=(n,e,i)=>n&&!e.hidden&&e._stacked&&{keys:vJ(i,!0),values:null};class fu{constructor(e,i){this.chart=e,this._ctx=e.ctx,this.index=i,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const e=this._cachedMeta;this.configure(),this.linkScales(),e._stacked=ZG(e.vScale,e),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(e){this.index!==e&&Mb(this._cachedMeta),this.index=e}linkScales(){const e=this.chart,i=this._cachedMeta,o=this.getDataset(),s=(x,S,T,I)=>x==="x"?S:x==="r"?I:T,l=i.xAxisID=Fi(o.xAxisID,SI(e,"x")),d=i.yAxisID=Fi(o.yAxisID,SI(e,"y")),p=i.rAxisID=Fi(o.rAxisID,SI(e,"r")),f=i.indexAxis,y=i.iAxisID=s(f,l,d,p),_=i.vAxisID=s(f,d,l,p);i.xScale=this.getScaleForId(l),i.yScale=this.getScaleForId(d),i.rScale=this.getScaleForId(p),i.iScale=this.getScaleForId(y),i.vScale=this.getScaleForId(_)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(e){return this.chart.scales[e]}_getOtherScale(e){const i=this._cachedMeta;return e===i.iScale?i.vScale:i.iScale}reset(){this._update("reset")}_destroy(){const e=this._cachedMeta;this._data&&DG(this._data,this),e._stacked&&Mb(e)}_dataCheck(){const e=this.getDataset(),i=e.data||(e.data=[]),o=this._data;if(Qi(i))this._data=GCe(i);else if(o!==i){if(o){DG(o,this);const s=this._cachedMeta;Mb(s),s._parsed=[]}i&&Object.isExtensible(i)&&DTe(i,this),this._syncList=[],this._data=i}}addElements(){const e=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(e.dataset=new this.datasetElementType)}buildOrUpdateElements(e){const i=this._cachedMeta,o=this.getDataset();let s=!1;this._dataCheck();const l=i._stacked;i._stacked=ZG(i.vScale,i),i.stack!==o.stack&&(s=!0,Mb(i),i.stack=o.stack),this._resyncElements(e),(s||l!==i._stacked)&&JG(this,i._parsed)}configure(){const e=this.chart.config,i=e.datasetScopeKeys(this._type),o=e.getOptionScopes(this.getDataset(),i,!0);this.options=e.createResolver(o,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(e,i){const{_cachedMeta:o,_data:s}=this,{iScale:l,_stacked:d}=o,p=l.axis;let f=e===0&&i===s.length?!0:o._sorted,y=e>0&&o._parsed[e-1],_,x,S;if(this._parsing===!1)o._parsed=s,o._sorted=!0,S=s;else{cr(s[e])?S=this.parseArrayData(o,s,e,i):Qi(s[e])?S=this.parseObjectData(o,s,e,i):S=this.parsePrimitiveData(o,s,e,i);const T=()=>x[p]===null||y&&x[p]<y[p];for(_=0;_<i;++_)o._parsed[_+e]=x=S[_],f&&(T()&&(f=!1),y=x);o._sorted=f}d&&JG(this,S)}parsePrimitiveData(e,i,o,s){const{iScale:l,vScale:d}=e,p=l.axis,f=d.axis,y=l.getLabels(),_=l===d,x=new Array(s);let S,T,I;for(S=0,T=s;S<T;++S)I=S+o,x[S]={[p]:_||l.parse(y[I],I),[f]:d.parse(i[I],I)};return x}parseArrayData(e,i,o,s){const{xScale:l,yScale:d}=e,p=new Array(s);let f,y,_,x;for(f=0,y=s;f<y;++f)_=f+o,x=i[_],p[f]={x:l.parse(x[0],_),y:d.parse(x[1],_)};return p}parseObjectData(e,i,o,s){const{xScale:l,yScale:d}=e,{xAxisKey:p="x",yAxisKey:f="y"}=this._parsing,y=new Array(s);let _,x,S,T;for(_=0,x=s;_<x;++_)S=_+o,T=i[S],y[_]={x:l.parse(Ef(T,p),S),y:d.parse(Ef(T,f),S)};return y}getParsed(e){return this._cachedMeta._parsed[e]}getDataElement(e){return this._cachedMeta.data[e]}applyStack(e,i,o){const s=this.chart,l=this._cachedMeta,d=i[e.axis],p={keys:vJ(s,!0),values:i._stacks[e.axis]._visualValues};return XG(p,d,l.index,{mode:o})}updateRangeFromParsed(e,i,o,s){const l=o[i.axis];let d=l===null?NaN:l;const p=s&&o._stacks[i.axis];s&&p&&(s.values=p,d=XG(s,l,this._cachedMeta.index)),e.min=Math.min(e.min,d),e.max=Math.max(e.max,d)}getMinMax(e,i){const o=this._cachedMeta,s=o._parsed,l=o._sorted&&e===o.iScale,d=s.length,p=this._getOtherScale(e),f=XCe(i,o,this.chart),y={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:_,max:x}=jCe(p);let S,T;function I(){T=s[S];const R=T[p.axis];return!Xr(T[e.axis])||_>R||x<R}for(S=0;S<d&&!(!I()&&(this.updateRangeFromParsed(y,e,T,f),l));++S);if(l){for(S=d-1;S>=0;--S)if(!I()){this.updateRangeFromParsed(y,e,T,f);break}}return y}getAllParsedValues(e){const i=this._cachedMeta._parsed,o=[];let s,l,d;for(s=0,l=i.length;s<l;++s)d=i[s][e.axis],Xr(d)&&o.push(d);return o}getMaxOverflow(){return!1}getLabelAndValue(e){const i=this._cachedMeta,o=i.iScale,s=i.vScale,l=this.getParsed(e);return{label:o?""+o.getLabelForValue(l[o.axis]):"",value:s?""+s.getLabelForValue(l[s.axis]):""}}_update(e){const i=this._cachedMeta;this.update(e||"default"),i._clip=VCe(Fi(this.options.clip,WCe(i.xScale,i.yScale,this.getMaxOverflow())))}update(e){}draw(){const e=this._ctx,i=this.chart,o=this._cachedMeta,s=o.data||[],l=i.chartArea,d=[],p=this._drawStart||0,f=this._drawCount||s.length-p,y=this.options.drawActiveElementsOnTop;let _;for(o.dataset&&o.dataset.draw(e,l,p,f),_=p;_<p+f;++_){const x=s[_];x.hidden||(x.active&&y?d.push(x):x.draw(e,l))}for(_=0;_<d.length;++_)d[_].draw(e,l)}getStyle(e,i){const o=i?"active":"default";return e===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(o):this.resolveDataElementOptions(e||0,o)}getContext(e,i,o){const s=this.getDataset();let l;if(e>=0&&e<this._cachedMeta.data.length){const d=this._cachedMeta.data[e];l=d.$context||(d.$context=qCe(this.getContext(),e,d)),l.parsed=this.getParsed(e),l.raw=s.data[e],l.index=l.dataIndex=e}else l=this.$context||(this.$context=YCe(this.chart.getContext(),this.index)),l.dataset=s,l.index=l.datasetIndex=this.index;return l.active=!!i,l.mode=o,l}resolveDatasetElementOptions(e){return this._resolveElementOptions(this.datasetElementType.id,e)}resolveDataElementOptions(e,i){return this._resolveElementOptions(this.dataElementType.id,i,e)}_resolveElementOptions(e,i="default",o){const s=i==="active",l=this._cachedDataOpts,d=e+"-"+i,p=l[d],f=this.enableOptionSharing&&Aw(o);if(p)return QG(p,f);const y=this.chart.config,_=y.datasetElementScopeKeys(this._type,e),x=s?[`${e}Hover`,"hover",e,""]:[e,""],S=y.getOptionScopes(this.getDataset(),_),T=Object.keys(Zr.elements[e]),I=()=>this.getContext(o,s,i),R=y.resolveNamedOptions(S,T,I,x);return R.$shared&&(R.$shared=f,l[d]=Object.freeze(QG(R,f))),R}_resolveAnimations(e,i,o){const s=this.chart,l=this._cachedDataOpts,d=`animation-${i}`,p=l[d];if(p)return p;let f;if(s.options.animation!==!1){const _=this.chart.config,x=_.datasetAnimationScopeKeys(this._type,i),S=_.getOptionScopes(this.getDataset(),x);f=_.createResolver(S,this.getContext(e,o,i))}const y=new yJ(s,f&&f.animations);return f&&f._cacheable&&(l[d]=Object.freeze(y)),y}getSharedOptions(e){if(e.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},e))}includeOptions(e,i){return!i||AI(e)||this.chart._animationsDisabled}_getSharedOptions(e,i){const o=this.resolveDataElementOptions(e,i),s=this._sharedOptions,l=this.getSharedOptions(o),d=this.includeOptions(i,l)||l!==s;return this.updateSharedOptions(l,i,o),{sharedOptions:l,includeOptions:d}}updateElement(e,i,o,s){AI(s)?Object.assign(e,o):this._resolveAnimations(i,s).update(e,o)}updateSharedOptions(e,i,o){e&&!AI(i)&&this._resolveAnimations(void 0,i).update(e,o)}_setStyle(e,i,o,s){e.active=s;const l=this.getStyle(i,s);this._resolveAnimations(i,o,s).update(e,{options:!s&&this.getSharedOptions(l)||l})}removeHoverStyle(e,i,o){this._setStyle(e,o,"active",!1)}setHoverStyle(e,i,o){this._setStyle(e,o,"active",!0)}_removeDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!1)}_setDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!0)}_resyncElements(e){const i=this._data,o=this._cachedMeta.data;for(const[p,f,y]of this._syncList)this[p](f,y);this._syncList=[];const s=o.length,l=i.length,d=Math.min(l,s);d&&this.parse(0,d),l>s?this._insertElements(s,l-s,e):l<s&&this._removeElements(l,s-l)}_insertElements(e,i,o=!0){const s=this._cachedMeta,l=s.data,d=e+i;let p;const f=y=>{for(y.length+=i,p=y.length-1;p>=d;p--)y[p]=y[p-i]};for(f(l),p=e;p<d;++p)l[p]=new this.dataElementType;this._parsing&&f(s._parsed),this.parse(e,i),o&&this.updateElements(l,e,i,"reset")}updateElements(e,i,o,s){}_removeElements(e,i){const o=this._cachedMeta;if(this._parsing){const s=o._parsed.splice(e,i);o._stacked&&Mb(o,s)}o.data.splice(e,i)}_sync(e){if(this._parsing)this._syncList.push(e);else{const[i,o,s]=e;this[i](o,s)}this.chart._dataChanges.push([this.index,...e])}_onDataPush(){const e=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-e,e])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(e,i){i&&this._sync(["_removeElements",e,i]);const o=arguments.length-2;o&&this._sync(["_insertElements",e,o])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}xn(fu,"defaults",{}),xn(fu,"datasetElementType",null),xn(fu,"dataElementType",null);function ZCe(n,e){if(!n._cache.$bar){const i=n.getMatchingVisibleMetas(e);let o=[];for(let s=0,l=i.length;s<l;s++)o=o.concat(i[s].controller.getAllParsedValues(n));n._cache.$bar=KK(o.sort((s,l)=>s-l))}return n._cache.$bar}function KCe(n){const e=n.iScale,i=ZCe(e,n.type);let o=e._length,s,l,d,p;const f=()=>{d===32767||d===-32768||(Aw(p)&&(o=Math.min(o,Math.abs(d-p)||o)),p=d)};for(s=0,l=i.length;s<l;++s)d=e.getPixelForValue(i[s]),f();for(p=void 0,s=0,l=e.ticks.length;s<l;++s)d=e.getPixelForTick(s),f();return o}function JCe(n,e,i,o){const s=i.barThickness;let l,d;return da(s)?(l=e.min*i.categoryPercentage,d=i.barPercentage):(l=s*o,d=1),{chunk:l/o,ratio:d,start:e.pixels[n]-l/2}}function QCe(n,e,i,o){const s=e.pixels,l=s[n];let d=n>0?s[n-1]:null,p=n<s.length-1?s[n+1]:null;const f=i.categoryPercentage;d===null&&(d=l-(p===null?e.end-e.start:p-l)),p===null&&(p=l+l-d);const y=l-(l-Math.min(d,p))/2*f;return{chunk:Math.abs(p-d)/2*f/o,ratio:i.barPercentage,start:y}}function ePe(n,e,i,o){const s=i.parse(n[0],o),l=i.parse(n[1],o),d=Math.min(s,l),p=Math.max(s,l);let f=d,y=p;Math.abs(d)>Math.abs(p)&&(f=p,y=d),e[i.axis]=y,e._custom={barStart:f,barEnd:y,start:s,end:l,min:d,max:p}}function _J(n,e,i,o){return cr(n)?ePe(n,e,i,o):e[i.axis]=i.parse(n,o),e}function eH(n,e,i,o){const s=n.iScale,l=n.vScale,d=s.getLabels(),p=s===l,f=[];let y,_,x,S;for(y=i,_=i+o;y<_;++y)S=e[y],x={},x[s.axis]=p||s.parse(d[y],y),f.push(_J(S,x,l,y));return f}function EI(n){return n&&n.barStart!==void 0&&n.barEnd!==void 0}function tPe(n,e,i){return n!==0?_d(n):(e.isHorizontal()?1:-1)*(e.min>=i?1:-1)}function nPe(n){let e,i,o,s,l;return n.horizontal?(e=n.base>n.x,i="left",o="right"):(e=n.base<n.y,i="bottom",o="top"),e?(s="end",l="start"):(s="start",l="end"),{start:i,end:o,reverse:e,top:s,bottom:l}}function iPe(n,e,i,o){let s=e.borderSkipped;const l={};if(!s){n.borderSkipped=l;return}if(s===!0){n.borderSkipped={top:!0,right:!0,bottom:!0,left:!0};return}const{start:d,end:p,reverse:f,top:y,bottom:_}=nPe(n);s==="middle"&&i&&(n.enableBorderRadius=!0,(i._top||0)===o?s=y:(i._bottom||0)===o?s=_:(l[tH(_,d,p,f)]=!0,s=y)),l[tH(s,d,p,f)]=!0,n.borderSkipped=l}function tH(n,e,i,o){return o?(n=aPe(n,e,i),n=nH(n,i,e)):n=nH(n,e,i),n}function aPe(n,e,i){return n===e?i:n===i?e:n}function nH(n,e,i){return n==="start"?e:n==="end"?i:n}function rPe(n,{inflateAmount:e},i){n.inflateAmount=e==="auto"?i===1?.33:0:e}class mE extends fu{parsePrimitiveData(e,i,o,s){return eH(e,i,o,s)}parseArrayData(e,i,o,s){return eH(e,i,o,s)}parseObjectData(e,i,o,s){const{iScale:l,vScale:d}=e,{xAxisKey:p="x",yAxisKey:f="y"}=this._parsing,y=l.axis==="x"?p:f,_=d.axis==="x"?p:f,x=[];let S,T,I,R;for(S=o,T=o+s;S<T;++S)R=i[S],I={},I[l.axis]=l.parse(Ef(R,y),S),x.push(_J(Ef(R,_),I,d,S));return x}updateRangeFromParsed(e,i,o,s){super.updateRangeFromParsed(e,i,o,s);const l=o._custom;l&&i===this._cachedMeta.vScale&&(e.min=Math.min(e.min,l.min),e.max=Math.max(e.max,l.max))}getMaxOverflow(){return 0}getLabelAndValue(e){const i=this._cachedMeta,{iScale:o,vScale:s}=i,l=this.getParsed(e),d=l._custom,p=EI(d)?"["+d.start+", "+d.end+"]":""+s.getLabelForValue(l[s.axis]);return{label:""+o.getLabelForValue(l[o.axis]),value:p}}initialize(){this.enableOptionSharing=!0,super.initialize();const e=this._cachedMeta;e.stack=this.getDataset().stack}update(e){const i=this._cachedMeta;this.updateElements(i.data,0,i.data.length,e)}updateElements(e,i,o,s){const l=s==="reset",{index:d,_cachedMeta:{vScale:p}}=this,f=p.getBasePixel(),y=p.isHorizontal(),_=this._getRuler(),{sharedOptions:x,includeOptions:S}=this._getSharedOptions(i,s);for(let T=i;T<i+o;T++){const I=this.getParsed(T),R=l||da(I[p.axis])?{base:f,head:f}:this._calculateBarValuePixels(T),D=this._calculateBarIndexPixels(T,_),L=(I._stacks||{})[p.axis],O={horizontal:y,base:R.base,enableBorderRadius:!L||EI(I._custom)||d===L._top||d===L._bottom,x:y?R.head:D.center,y:y?D.center:R.head,height:y?D.size:Math.abs(R.size),width:y?Math.abs(R.size):D.size};S&&(O.options=x||this.resolveDataElementOptions(T,e[T].active?"active":s));const N=O.options||e[T].options;iPe(O,N,L,d),rPe(O,N,_.ratio),this.updateElement(e[T],T,O,s)}}_getStacks(e,i){const{iScale:o}=this._cachedMeta,s=o.getMatchingVisibleMetas(this._type).filter(f=>f.controller.options.grouped),l=o.options.stacked,d=[],p=f=>{const y=f.controller.getParsed(i),_=y&&y[f.vScale.axis];if(da(_)||isNaN(_))return!0};for(const f of s)if(!(i!==void 0&&p(f))&&((l===!1||d.indexOf(f.stack)===-1||l===void 0&&f.stack===void 0)&&d.push(f.stack),f.index===e))break;return d.length||d.push(void 0),d}_getStackCount(e){return this._getStacks(void 0,e).length}_getStackIndex(e,i,o){const s=this._getStacks(e,o),l=i!==void 0?s.indexOf(i):-1;return l===-1?s.length-1:l}_getRuler(){const e=this.options,i=this._cachedMeta,o=i.iScale,s=[];let l,d;for(l=0,d=i.data.length;l<d;++l)s.push(o.getPixelForValue(this.getParsed(l)[o.axis],l));const p=e.barThickness;return{min:p||KCe(i),pixels:s,start:o._startPixel,end:o._endPixel,stackCount:this._getStackCount(),scale:o,grouped:e.grouped,ratio:p?1:e.categoryPercentage*e.barPercentage}}_calculateBarValuePixels(e){const{_cachedMeta:{vScale:i,_stacked:o,index:s},options:{base:l,minBarLength:d}}=this,p=l||0,f=this.getParsed(e),y=f._custom,_=EI(y);let x=f[i.axis],S=0,T=o?this.applyStack(i,f,o):x,I,R;T!==x&&(S=T-x,T=x),_&&(x=y.barStart,T=y.barEnd-y.barStart,x!==0&&_d(x)!==_d(y.barEnd)&&(S=0),S+=x);const D=!da(l)&&!_?l:S;let L=i.getPixelForValue(D);if(this.chart.getDataVisibility(e)?I=i.getPixelForValue(S+T):I=L,R=I-L,Math.abs(R)<d){R=tPe(R,i,p)*d,x===p&&(L-=R/2);const O=i.getPixelForDecimal(0),N=i.getPixelForDecimal(1),F=Math.min(O,N),G=Math.max(O,N);L=Math.max(Math.min(L,G),F),I=L+R,o&&!_&&(f._stacks[i.axis]._visualValues[s]=i.getValueForPixel(I)-i.getValueForPixel(L))}if(L===i.getPixelForValue(p)){const O=_d(R)*i.getLineWidthForValue(p)/2;L+=O,R-=O}return{size:R,base:L,head:I,center:I+R/2}}_calculateBarIndexPixels(e,i){const o=i.scale,s=this.options,l=s.skipNull,d=Fi(s.maxBarThickness,1/0);let p,f;if(i.grouped){const y=l?this._getStackCount(e):i.stackCount,_=s.barThickness==="flex"?QCe(e,i,s,y):JCe(e,i,s,y),x=this._getStackIndex(this.index,this._cachedMeta.stack,l?e:void 0);p=_.start+_.chunk*x+_.chunk/2,f=Math.min(d,_.chunk*_.ratio)}else p=o.getPixelForValue(this.getParsed(e)[o.axis],e),f=Math.min(d,i.min*i.ratio);return{base:p-f/2,head:p+f/2,center:p,size:f}}draw(){const e=this._cachedMeta,i=e.vScale,o=e.data,s=o.length;let l=0;for(;l<s;++l)this.getParsed(l)[i.axis]!==null&&o[l].draw(this._ctx)}}xn(mE,"id","bar"),xn(mE,"defaults",{datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}}),xn(mE,"overrides",{scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}});class gE extends fu{initialize(){this.enableOptionSharing=!0,super.initialize()}parsePrimitiveData(e,i,o,s){const l=super.parsePrimitiveData(e,i,o,s);for(let d=0;d<l.length;d++)l[d]._custom=this.resolveDataElementOptions(d+o).radius;return l}parseArrayData(e,i,o,s){const l=super.parseArrayData(e,i,o,s);for(let d=0;d<l.length;d++){const p=i[o+d];l[d]._custom=Fi(p[2],this.resolveDataElementOptions(d+o).radius)}return l}parseObjectData(e,i,o,s){const l=super.parseObjectData(e,i,o,s);for(let d=0;d<l.length;d++){const p=i[o+d];l[d]._custom=Fi(p&&p.r&&+p.r,this.resolveDataElementOptions(d+o).radius)}return l}getMaxOverflow(){const e=this._cachedMeta.data;let i=0;for(let o=e.length-1;o>=0;--o)i=Math.max(i,e[o].size(this.resolveDataElementOptions(o))/2);return i>0&&i}getLabelAndValue(e){const i=this._cachedMeta,o=this.chart.data.labels||[],{xScale:s,yScale:l}=i,d=this.getParsed(e),p=s.getLabelForValue(d.x),f=l.getLabelForValue(d.y),y=d._custom;return{label:o[e]||"",value:"("+p+", "+f+(y?", "+y:"")+")"}}update(e){const i=this._cachedMeta.data;this.updateElements(i,0,i.length,e)}updateElements(e,i,o,s){const l=s==="reset",{iScale:d,vScale:p}=this._cachedMeta,{sharedOptions:f,includeOptions:y}=this._getSharedOptions(i,s),_=d.axis,x=p.axis;for(let S=i;S<i+o;S++){const T=e[S],I=!l&&this.getParsed(S),R={},D=R[_]=l?d.getPixelForDecimal(.5):d.getPixelForValue(I[_]),L=R[x]=l?p.getBasePixel():p.getPixelForValue(I[x]);R.skip=isNaN(D)||isNaN(L),y&&(R.options=f||this.resolveDataElementOptions(S,T.active?"active":s),l&&(R.options.radius=0)),this.updateElement(T,S,R,s)}}resolveDataElementOptions(e,i){const o=this.getParsed(e);let s=super.resolveDataElementOptions(e,i);s.$shared&&(s=Object.assign({},s,{$shared:!1}));const l=s.radius;return i!=="active"&&(s.radius=0),s.radius+=Fi(o&&o._custom,l),s}}xn(gE,"id","bubble"),xn(gE,"defaults",{datasetElementType:!1,dataElementType:"point",animations:{numbers:{type:"number",properties:["x","y","borderWidth","radius"]}}}),xn(gE,"overrides",{scales:{x:{type:"linear"},y:{type:"linear"}}});function oPe(n,e,i){let o=1,s=1,l=0,d=0;if(e<dr){const p=n,f=p+e,y=Math.cos(p),_=Math.sin(p),x=Math.cos(f),S=Math.sin(f),T=(N,F,G)=>Ew(N,p,f,!0)?1:Math.max(F,F*i,G,G*i),I=(N,F,G)=>Ew(N,p,f,!0)?-1:Math.min(F,F*i,G,G*i),R=T(0,y,x),D=T(co,_,S),L=I(hr,y,x),O=I(hr+co,_,S);o=(R-L)/2,s=(D-O)/2,l=-(R+L)/2,d=-(D+O)/2}return{ratioX:o,ratioY:s,offsetX:l,offsetY:d}}class vg extends fu{constructor(e,i){super(e,i),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(e,i){const o=this.getDataset().data,s=this._cachedMeta;if(this._parsing===!1)s._parsed=o;else{let l=f=>+o[f];if(Qi(o[e])){const{key:f="value"}=this._parsing;l=y=>+Ef(o[y],f)}let d,p;for(d=e,p=e+i;d<p;++d)s._parsed[d]=l(d)}}_getRotation(){return du(this.options.rotation-90)}_getCircumference(){return du(this.options.circumference)}_getRotationExtents(){let e=dr,i=-dr;for(let o=0;o<this.chart.data.datasets.length;++o)if(this.chart.isDatasetVisible(o)&&this.chart.getDatasetMeta(o).type===this._type){const s=this.chart.getDatasetMeta(o).controller,l=s._getRotation(),d=s._getCircumference();e=Math.min(e,l),i=Math.max(i,l+d)}return{rotation:e,circumference:i-e}}update(e){const i=this.chart,{chartArea:o}=i,s=this._cachedMeta,l=s.data,d=this.getMaxBorderWidth()+this.getMaxOffset(l)+this.options.spacing,p=Math.max((Math.min(o.width,o.height)-d)/2,0),f=Math.min(bTe(this.options.cutout,p),1),y=this._getRingWeight(this.index),{circumference:_,rotation:x}=this._getRotationExtents(),{ratioX:S,ratioY:T,offsetX:I,offsetY:R}=oPe(x,_,f),D=(o.width-d)/S,L=(o.height-d)/T,O=Math.max(Math.min(D,L)/2,0),N=$K(this.options.radius,O),F=Math.max(N*f,0),G=(N-F)/this._getVisibleDatasetWeightTotal();this.offsetX=I*N,this.offsetY=R*N,s.total=this.calculateTotal(),this.outerRadius=N-G*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-G*y,0),this.updateElements(l,0,l.length,e)}_circumference(e,i){const o=this.options,s=this._cachedMeta,l=this._getCircumference();return i&&o.animation.animateRotate||!this.chart.getDataVisibility(e)||s._parsed[e]===null||s.data[e].hidden?0:this.calculateCircumference(s._parsed[e]*l/dr)}updateElements(e,i,o,s){const l=s==="reset",d=this.chart,p=d.chartArea,y=d.options.animation,_=(p.left+p.right)/2,x=(p.top+p.bottom)/2,S=l&&y.animateScale,T=S?0:this.innerRadius,I=S?0:this.outerRadius,{sharedOptions:R,includeOptions:D}=this._getSharedOptions(i,s);let L=this._getRotation(),O;for(O=0;O<i;++O)L+=this._circumference(O,l);for(O=i;O<i+o;++O){const N=this._circumference(O,l),F=e[O],G={x:_+this.offsetX,y:x+this.offsetY,startAngle:L,endAngle:L+N,circumference:N,outerRadius:I,innerRadius:T};D&&(G.options=R||this.resolveDataElementOptions(O,F.active?"active":s)),L+=N,this.updateElement(F,O,G,s)}}calculateTotal(){const e=this._cachedMeta,i=e.data;let o=0,s;for(s=0;s<i.length;s++){const l=e._parsed[s];l!==null&&!isNaN(l)&&this.chart.getDataVisibility(s)&&!i[s].hidden&&(o+=Math.abs(l))}return o}calculateCircumference(e){const i=this._cachedMeta.total;return i>0&&!isNaN(e)?dr*(Math.abs(e)/i):0}getLabelAndValue(e){const i=this._cachedMeta,o=this.chart,s=o.data.labels||[],l=a2(i._parsed[e],o.options.locale);return{label:s[e]||"",value:l}}getMaxBorderWidth(e){let i=0;const o=this.chart;let s,l,d,p,f;if(!e){for(s=0,l=o.data.datasets.length;s<l;++s)if(o.isDatasetVisible(s)){d=o.getDatasetMeta(s),e=d.data,p=d.controller;break}}if(!e)return 0;for(s=0,l=e.length;s<l;++s)f=p.resolveDataElementOptions(s),f.borderAlign!=="inner"&&(i=Math.max(i,f.borderWidth||0,f.hoverBorderWidth||0));return i}getMaxOffset(e){let i=0;for(let o=0,s=e.length;o<s;++o){const l=this.resolveDataElementOptions(o);i=Math.max(i,l.offset||0,l.hoverOffset||0)}return i}_getRingWeightOffset(e){let i=0;for(let o=0;o<e;++o)this.chart.isDatasetVisible(o)&&(i+=this._getRingWeight(o));return i}_getRingWeight(e){return Math.max(Fi(this.chart.data.datasets[e].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}xn(vg,"id","doughnut"),xn(vg,"defaults",{datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"}),xn(vg,"descriptors",{_scriptable:e=>e!=="spacing",_indexable:e=>e!=="spacing"&&!e.startsWith("borderDash")&&!e.startsWith("hoverBorderDash")}),xn(vg,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels(e){const i=e.data;if(i.labels.length&&i.datasets.length){const{labels:{pointStyle:o,color:s}}=e.legend.options;return i.labels.map((l,d)=>{const f=e.getDatasetMeta(0).controller.getStyle(d);return{text:l,fillStyle:f.backgroundColor,strokeStyle:f.borderColor,fontColor:s,lineWidth:f.borderWidth,pointStyle:o,hidden:!e.getDataVisibility(d),index:d}})}return[]}},onClick(e,i,o){o.chart.toggleDataVisibility(i.index),o.chart.update()}}}});class Ex extends fu{initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(e){const i=this._cachedMeta,{dataset:o,data:s=[],_dataset:l}=i,d=this.chart._animationsDisabled;let{start:p,count:f}=eJ(i,s,d);this._drawStart=p,this._drawCount=f,tJ(i)&&(p=0,f=s.length),o._chart=this.chart,o._datasetIndex=this.index,o._decimated=!!l._decimated,o.points=s;const y=this.resolveDatasetElementOptions(e);this.options.showLine||(y.borderWidth=0),y.segment=this.options.segment,this.updateElement(o,void 0,{animated:!d,options:y},e),this.updateElements(s,p,f,e)}updateElements(e,i,o,s){const l=s==="reset",{iScale:d,vScale:p,_stacked:f,_dataset:y}=this._cachedMeta,{sharedOptions:_,includeOptions:x}=this._getSharedOptions(i,s),S=d.axis,T=p.axis,{spanGaps:I,segment:R}=this.options,D=f_(I)?I:Number.POSITIVE_INFINITY,L=this.chart._animationsDisabled||l||s==="none",O=i+o,N=e.length;let F=i>0&&this.getParsed(i-1);for(let G=0;G<N;++G){const j=e[G],Y=L?j:{};if(G<i||G>=O){Y.skip=!0;continue}const te=this.getParsed(G),V=da(te[T]),Q=Y[S]=d.getPixelForValue(te[S],G),he=Y[T]=l||V?p.getBasePixel():p.getPixelForValue(f?this.applyStack(p,te,f):te[T],G);Y.skip=isNaN(Q)||isNaN(he)||V,Y.stop=G>0&&Math.abs(te[S]-F[S])>D,R&&(Y.parsed=te,Y.raw=y.data[G]),x&&(Y.options=_||this.resolveDataElementOptions(G,j.active?"active":s)),L||this.updateElement(j,G,Y,s),F=te}}getMaxOverflow(){const e=this._cachedMeta,i=e.dataset,o=i.options&&i.options.borderWidth||0,s=e.data||[];if(!s.length)return o;const l=s[0].size(this.resolveDataElementOptions(0)),d=s[s.length-1].size(this.resolveDataElementOptions(s.length-1));return Math.max(o,l,d)/2}draw(){const e=this._cachedMeta;e.dataset.updateControlPoints(this.chart.chartArea,e.iScale.axis),super.draw()}}xn(Ex,"id","line"),xn(Ex,"defaults",{datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1}),xn(Ex,"overrides",{scales:{_index_:{type:"category"},_value_:{type:"linear"}}});class Mx extends fu{constructor(e,i){super(e,i),this.innerRadius=void 0,this.outerRadius=void 0}getLabelAndValue(e){const i=this._cachedMeta,o=this.chart,s=o.data.labels||[],l=a2(i._parsed[e].r,o.options.locale);return{label:s[e]||"",value:l}}parseObjectData(e,i,o,s){return cJ.bind(this)(e,i,o,s)}update(e){const i=this._cachedMeta.data;this._updateRadius(),this.updateElements(i,0,i.length,e)}getMinMax(){const e=this._cachedMeta,i={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};return e.data.forEach((o,s)=>{const l=this.getParsed(s).r;!isNaN(l)&&this.chart.getDataVisibility(s)&&(l<i.min&&(i.min=l),l>i.max&&(i.max=l))}),i}_updateRadius(){const e=this.chart,i=e.chartArea,o=e.options,s=Math.min(i.right-i.left,i.bottom-i.top),l=Math.max(s/2,0),d=Math.max(o.cutoutPercentage?l/100*o.cutoutPercentage:1,0),p=(l-d)/e.getVisibleDatasetCount();this.outerRadius=l-p*this.index,this.innerRadius=this.outerRadius-p}updateElements(e,i,o,s){const l=s==="reset",d=this.chart,f=d.options.animation,y=this._cachedMeta.rScale,_=y.xCenter,x=y.yCenter,S=y.getIndexAngle(0)-.5*hr;let T=S,I;const R=360/this.countVisibleElements();for(I=0;I<i;++I)T+=this._computeAngle(I,s,R);for(I=i;I<i+o;I++){const D=e[I];let L=T,O=T+this._computeAngle(I,s,R),N=d.getDataVisibility(I)?y.getDistanceFromCenterForValue(this.getParsed(I).r):0;T=O,l&&(f.animateScale&&(N=0),f.animateRotate&&(L=O=S));const F={x:_,y:x,innerRadius:0,outerRadius:N,startAngle:L,endAngle:O,options:this.resolveDataElementOptions(I,D.active?"active":s)};this.updateElement(D,I,F,s)}}countVisibleElements(){const e=this._cachedMeta;let i=0;return e.data.forEach((o,s)=>{!isNaN(this.getParsed(s).r)&&this.chart.getDataVisibility(s)&&i++}),i}_computeAngle(e,i,o){return this.chart.getDataVisibility(e)?du(this.resolveDataElementOptions(e,i).angle||o):0}}xn(Mx,"id","polarArea"),xn(Mx,"defaults",{dataElementType:"arc",animation:{animateRotate:!0,animateScale:!0},animations:{numbers:{type:"number",properties:["x","y","startAngle","endAngle","innerRadius","outerRadius"]}},indexAxis:"r",startAngle:0}),xn(Mx,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels(e){const i=e.data;if(i.labels.length&&i.datasets.length){const{labels:{pointStyle:o,color:s}}=e.legend.options;return i.labels.map((l,d)=>{const f=e.getDatasetMeta(0).controller.getStyle(d);return{text:l,fillStyle:f.backgroundColor,strokeStyle:f.borderColor,fontColor:s,lineWidth:f.borderWidth,pointStyle:o,hidden:!e.getDataVisibility(d),index:d}})}return[]}},onClick(e,i,o){o.chart.toggleDataVisibility(i.index),o.chart.update()}}},scales:{r:{type:"radialLinear",angleLines:{display:!1},beginAtZero:!0,grid:{circular:!0},pointLabels:{display:!1},startAngle:0}}});class KR extends vg{}xn(KR,"id","pie"),xn(KR,"defaults",{cutout:0,rotation:0,circumference:360,radius:"100%"});class Tx extends fu{getLabelAndValue(e){const i=this._cachedMeta.vScale,o=this.getParsed(e);return{label:i.getLabels()[e],value:""+i.getLabelForValue(o[i.axis])}}parseObjectData(e,i,o,s){return cJ.bind(this)(e,i,o,s)}update(e){const i=this._cachedMeta,o=i.dataset,s=i.data||[],l=i.iScale.getLabels();if(o.points=s,e!=="resize"){const d=this.resolveDatasetElementOptions(e);this.options.showLine||(d.borderWidth=0);const p={_loop:!0,_fullLoop:l.length===s.length,options:d};this.updateElement(o,void 0,p,e)}this.updateElements(s,0,s.length,e)}updateElements(e,i,o,s){const l=this._cachedMeta.rScale,d=s==="reset";for(let p=i;p<i+o;p++){const f=e[p],y=this.resolveDataElementOptions(p,f.active?"active":s),_=l.getPointPositionForValue(p,this.getParsed(p).r),x=d?l.xCenter:_.x,S=d?l.yCenter:_.y,T={x,y:S,angle:_.angle,skip:isNaN(x)||isNaN(S),options:y};this.updateElement(f,p,T,s)}}}xn(Tx,"id","radar"),xn(Tx,"defaults",{datasetElementType:"line",dataElementType:"point",indexAxis:"r",showLine:!0,elements:{line:{fill:"start"}}}),xn(Tx,"overrides",{aspectRatio:1,scales:{r:{type:"radialLinear"}}});class yE extends fu{getLabelAndValue(e){const i=this._cachedMeta,o=this.chart.data.labels||[],{xScale:s,yScale:l}=i,d=this.getParsed(e),p=s.getLabelForValue(d.x),f=l.getLabelForValue(d.y);return{label:o[e]||"",value:"("+p+", "+f+")"}}update(e){const i=this._cachedMeta,{data:o=[]}=i,s=this.chart._animationsDisabled;let{start:l,count:d}=eJ(i,o,s);if(this._drawStart=l,this._drawCount=d,tJ(i)&&(l=0,d=o.length),this.options.showLine){this.datasetElementType||this.addElements();const{dataset:p,_dataset:f}=i;p._chart=this.chart,p._datasetIndex=this.index,p._decimated=!!f._decimated,p.points=o;const y=this.resolveDatasetElementOptions(e);y.segment=this.options.segment,this.updateElement(p,void 0,{animated:!s,options:y},e)}else this.datasetElementType&&(delete i.dataset,this.datasetElementType=!1);this.updateElements(o,l,d,e)}addElements(){const{showLine:e}=this.options;!this.datasetElementType&&e&&(this.datasetElementType=this.chart.registry.getElement("line")),super.addElements()}updateElements(e,i,o,s){const l=s==="reset",{iScale:d,vScale:p,_stacked:f,_dataset:y}=this._cachedMeta,_=this.resolveDataElementOptions(i,s),x=this.getSharedOptions(_),S=this.includeOptions(s,x),T=d.axis,I=p.axis,{spanGaps:R,segment:D}=this.options,L=f_(R)?R:Number.POSITIVE_INFINITY,O=this.chart._animationsDisabled||l||s==="none";let N=i>0&&this.getParsed(i-1);for(let F=i;F<i+o;++F){const G=e[F],j=this.getParsed(F),Y=O?G:{},te=da(j[I]),V=Y[T]=d.getPixelForValue(j[T],F),Q=Y[I]=l||te?p.getBasePixel():p.getPixelForValue(f?this.applyStack(p,j,f):j[I],F);Y.skip=isNaN(V)||isNaN(Q)||te,Y.stop=F>0&&Math.abs(j[T]-N[T])>L,D&&(Y.parsed=j,Y.raw=y.data[F]),S&&(Y.options=x||this.resolveDataElementOptions(F,G.active?"active":s)),O||this.updateElement(G,F,Y,s),N=j}this.updateSharedOptions(x,s,_)}getMaxOverflow(){const e=this._cachedMeta,i=e.data||[];if(!this.options.showLine){let p=0;for(let f=i.length-1;f>=0;--f)p=Math.max(p,i[f].size(this.resolveDataElementOptions(f))/2);return p>0&&p}const o=e.dataset,s=o.options&&o.options.borderWidth||0;if(!i.length)return s;const l=i[0].size(this.resolveDataElementOptions(0)),d=i[i.length-1].size(this.resolveDataElementOptions(i.length-1));return Math.max(s,l,d)/2}}xn(yE,"id","scatter"),xn(yE,"defaults",{datasetElementType:!1,dataElementType:"point",showLine:!1,fill:!1}),xn(yE,"overrides",{interaction:{mode:"point"},scales:{x:{type:"linear"},y:{type:"linear"}}});var sPe=Object.freeze({__proto__:null,BarController:mE,BubbleController:gE,DoughnutController:vg,LineController:Ex,PieController:KR,PolarAreaController:Mx,RadarController:Tx,ScatterController:yE});function Xm(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class aO{constructor(e){xn(this,"options");this.options=e||{}}static override(e){Object.assign(aO.prototype,e)}init(){}formats(){return Xm()}parse(){return Xm()}format(){return Xm()}add(){return Xm()}diff(){return Xm()}startOf(){return Xm()}endOf(){return Xm()}}var lPe={_date:aO};function cPe(n,e,i,o){const{controller:s,data:l,_sorted:d}=n,p=s._cachedMeta.iScale;if(p&&e===p.axis&&e!=="r"&&d&&l.length){const f=p._reversePixels?RTe:Dh;if(o){if(s._sharedOptions){const y=l[0],_=typeof y.getRange=="function"&&y.getRange(e);if(_){const x=f(l,e,i-_),S=f(l,e,i+_);return{lo:x.lo,hi:S.hi}}}}else return f(l,e,i)}return{lo:0,hi:l.length-1}}function r2(n,e,i,o,s){const l=n.getSortedVisibleDatasetMetas(),d=i[e];for(let p=0,f=l.length;p<f;++p){const{index:y,data:_}=l[p],{lo:x,hi:S}=cPe(l[p],e,d,s);for(let T=x;T<=S;++T){const I=_[T];I.skip||o(I,y,T)}}}function uPe(n){const e=n.indexOf("x")!==-1,i=n.indexOf("y")!==-1;return function(o,s){const l=e?Math.abs(o.x-s.x):0,d=i?Math.abs(o.y-s.y):0;return Math.sqrt(Math.pow(l,2)+Math.pow(d,2))}}function MI(n,e,i,o,s){const l=[];return!s&&!n.isPointInArea(e)||r2(n,i,e,function(p,f,y){!s&&!Oh(p,n.chartArea,0)||p.inRange(e.x,e.y,o)&&l.push({element:p,datasetIndex:f,index:y})},!0),l}function dPe(n,e,i,o){let s=[];function l(d,p,f){const{startAngle:y,endAngle:_}=d.getProps(["startAngle","endAngle"],o),{angle:x}=XK(d,{x:e.x,y:e.y});Ew(x,y,_)&&s.push({element:d,datasetIndex:p,index:f})}return r2(n,i,e,l),s}function hPe(n,e,i,o,s,l){let d=[];const p=uPe(i);let f=Number.POSITIVE_INFINITY;function y(_,x,S){const T=_.inRange(e.x,e.y,s);if(o&&!T)return;const I=_.getCenterPoint(s);if(!(!!l||n.isPointInArea(I))&&!T)return;const D=p(e,I);D<f?(d=[{element:_,datasetIndex:x,index:S}],f=D):D===f&&d.push({element:_,datasetIndex:x,index:S})}return r2(n,i,e,y),d}function TI(n,e,i,o,s,l){return!l&&!n.isPointInArea(e)?[]:i==="r"&&!o?dPe(n,e,i,s):hPe(n,e,i,o,s,l)}function iH(n,e,i,o,s){const l=[],d=i==="x"?"inXRange":"inYRange";let p=!1;return r2(n,i,e,(f,y,_)=>{f[d](e[i],s)&&(l.push({element:f,datasetIndex:y,index:_}),p=p||f.inRange(e.x,e.y,s))}),o&&!p?[]:l}var pPe={evaluateInteractionItems:r2,modes:{index(n,e,i,o){const s=rg(e,n),l=i.axis||"x",d=i.includeInvisible||!1,p=i.intersect?MI(n,s,l,o,d):TI(n,s,l,!1,o,d),f=[];return p.length?(n.getSortedVisibleDatasetMetas().forEach(y=>{const _=p[0].index,x=y.data[_];x&&!x.skip&&f.push({element:x,datasetIndex:y.index,index:_})}),f):[]},dataset(n,e,i,o){const s=rg(e,n),l=i.axis||"xy",d=i.includeInvisible||!1;let p=i.intersect?MI(n,s,l,o,d):TI(n,s,l,!1,o,d);if(p.length>0){const f=p[0].datasetIndex,y=n.getDatasetMeta(f).data;p=[];for(let _=0;_<y.length;++_)p.push({element:y[_],datasetIndex:f,index:_})}return p},point(n,e,i,o){const s=rg(e,n),l=i.axis||"xy",d=i.includeInvisible||!1;return MI(n,s,l,o,d)},nearest(n,e,i,o){const s=rg(e,n),l=i.axis||"xy",d=i.includeInvisible||!1;return TI(n,s,l,i.intersect,o,d)},x(n,e,i,o){const s=rg(e,n);return iH(n,s,"x",i.intersect,o)},y(n,e,i,o){const s=rg(e,n);return iH(n,s,"y",i.intersect,o)}}};const bJ=["left","top","right","bottom"];function Tb(n,e){return n.filter(i=>i.pos===e)}function aH(n,e){return n.filter(i=>bJ.indexOf(i.pos)===-1&&i.box.axis===e)}function Cb(n,e){return n.sort((i,o)=>{const s=e?o:i,l=e?i:o;return s.weight===l.weight?s.index-l.index:s.weight-l.weight})}function fPe(n){const e=[];let i,o,s,l,d,p;for(i=0,o=(n||[]).length;i<o;++i)s=n[i],{position:l,options:{stack:d,stackWeight:p=1}}=s,e.push({index:i,box:s,pos:l,horizontal:s.isHorizontal(),weight:s.weight,stack:d&&l+d,stackWeight:p});return e}function mPe(n){const e={};for(const i of n){const{stack:o,pos:s,stackWeight:l}=i;if(!o||!bJ.includes(s))continue;const d=e[o]||(e[o]={count:0,placed:0,weight:0,size:0});d.count++,d.weight+=l}return e}function gPe(n,e){const i=mPe(n),{vBoxMaxWidth:o,hBoxMaxHeight:s}=e;let l,d,p;for(l=0,d=n.length;l<d;++l){p=n[l];const{fullSize:f}=p.box,y=i[p.stack],_=y&&p.stackWeight/y.weight;p.horizontal?(p.width=_?_*o:f&&e.availableWidth,p.height=s):(p.width=o,p.height=_?_*s:f&&e.availableHeight)}return i}function yPe(n){const e=fPe(n),i=Cb(e.filter(y=>y.box.fullSize),!0),o=Cb(Tb(e,"left"),!0),s=Cb(Tb(e,"right")),l=Cb(Tb(e,"top"),!0),d=Cb(Tb(e,"bottom")),p=aH(e,"x"),f=aH(e,"y");return{fullSize:i,leftAndTop:o.concat(l),rightAndBottom:s.concat(f).concat(d).concat(p),chartArea:Tb(e,"chartArea"),vertical:o.concat(s).concat(f),horizontal:l.concat(d).concat(p)}}function rH(n,e,i,o){return Math.max(n[i],e[i])+Math.max(n[o],e[o])}function xJ(n,e){n.top=Math.max(n.top,e.top),n.left=Math.max(n.left,e.left),n.bottom=Math.max(n.bottom,e.bottom),n.right=Math.max(n.right,e.right)}function vPe(n,e,i,o){const{pos:s,box:l}=i,d=n.maxPadding;if(!Qi(s)){i.size&&(n[s]-=i.size);const x=o[i.stack]||{size:0,count:1};x.size=Math.max(x.size,i.horizontal?l.height:l.width),i.size=x.size/x.count,n[s]+=i.size}l.getPadding&&xJ(d,l.getPadding());const p=Math.max(0,e.outerWidth-rH(d,n,"left","right")),f=Math.max(0,e.outerHeight-rH(d,n,"top","bottom")),y=p!==n.w,_=f!==n.h;return n.w=p,n.h=f,i.horizontal?{same:y,other:_}:{same:_,other:y}}function _Pe(n){const e=n.maxPadding;function i(o){const s=Math.max(e[o]-n[o],0);return n[o]+=s,s}n.y+=i("top"),n.x+=i("left"),i("right"),i("bottom")}function bPe(n,e){const i=e.maxPadding;function o(s){const l={left:0,top:0,right:0,bottom:0};return s.forEach(d=>{l[d]=Math.max(e[d],i[d])}),l}return o(n?["left","right"]:["top","bottom"])}function jb(n,e,i,o){const s=[];let l,d,p,f,y,_;for(l=0,d=n.length,y=0;l<d;++l){p=n[l],f=p.box,f.update(p.width||e.w,p.height||e.h,bPe(p.horizontal,e));const{same:x,other:S}=vPe(e,i,p,o);y|=x&&s.length,_=_||S,f.fullSize||s.push(p)}return y&&jb(s,e,i,o)||_}function EA(n,e,i,o,s){n.top=i,n.left=e,n.right=e+o,n.bottom=i+s,n.width=o,n.height=s}function oH(n,e,i,o){const s=i.padding;let{x:l,y:d}=e;for(const p of n){const f=p.box,y=o[p.stack]||{count:1,placed:0,weight:1},_=p.stackWeight/y.weight||1;if(p.horizontal){const x=e.w*_,S=y.size||f.height;Aw(y.start)&&(d=y.start),f.fullSize?EA(f,s.left,d,i.outerWidth-s.right-s.left,S):EA(f,e.left+y.placed,d,x,S),y.start=d,y.placed+=x,d=f.bottom}else{const x=e.h*_,S=y.size||f.width;Aw(y.start)&&(l=y.start),f.fullSize?EA(f,l,s.top,S,i.outerHeight-s.bottom-s.top):EA(f,l,e.top+y.placed,S,x),y.start=l,y.placed+=x,l=f.right}}e.x=l,e.y=d}var xs={addBox(n,e){n.boxes||(n.boxes=[]),e.fullSize=e.fullSize||!1,e.position=e.position||"top",e.weight=e.weight||0,e._layers=e._layers||function(){return[{z:0,draw(i){e.draw(i)}}]},n.boxes.push(e)},removeBox(n,e){const i=n.boxes?n.boxes.indexOf(e):-1;i!==-1&&n.boxes.splice(i,1)},configure(n,e,i){e.fullSize=i.fullSize,e.position=i.position,e.weight=i.weight},update(n,e,i,o){if(!n)return;const s=Ms(n.options.layout.padding),l=Math.max(e-s.width,0),d=Math.max(i-s.height,0),p=yPe(n.boxes),f=p.vertical,y=p.horizontal;Ua(n.boxes,R=>{typeof R.beforeLayout=="function"&&R.beforeLayout()});const _=f.reduce((R,D)=>D.box.options&&D.box.options.display===!1?R:R+1,0)||1,x=Object.freeze({outerWidth:e,outerHeight:i,padding:s,availableWidth:l,availableHeight:d,vBoxMaxWidth:l/2/_,hBoxMaxHeight:d/2}),S=Object.assign({},s);xJ(S,Ms(o));const T=Object.assign({maxPadding:S,w:l,h:d,x:s.left,y:s.top},s),I=gPe(f.concat(y),x);jb(p.fullSize,T,x,I),jb(f,T,x,I),jb(y,T,x,I)&&jb(f,T,x,I),_Pe(T),oH(p.leftAndTop,T,x,I),T.x+=T.w,T.y+=T.h,oH(p.rightAndBottom,T,x,I),n.chartArea={left:T.left,top:T.top,right:T.left+T.w,bottom:T.top+T.h,height:T.h,width:T.w},Ua(p.chartArea,R=>{const D=R.box;Object.assign(D,n.chartArea),D.update(T.w,T.h,{left:0,top:0,right:0,bottom:0})})}};class wJ{acquireContext(e,i){}releaseContext(e){return!1}addEventListener(e,i,o){}removeEventListener(e,i,o){}getDevicePixelRatio(){return 1}getMaximumSize(e,i,o,s){return i=Math.max(0,i||e.width),o=o||e.height,{width:i,height:Math.max(0,s?Math.floor(i/s):o)}}isAttached(e){return!0}updateConfig(e){}}class xPe extends wJ{acquireContext(e){return e&&e.getContext&&e.getContext("2d")||null}updateConfig(e){e.options.animation=!1}}const vE="$chartjs",wPe={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},sH=n=>n===null||n==="";function SPe(n,e){const i=n.style,o=n.getAttribute("height"),s=n.getAttribute("width");if(n[vE]={initial:{height:o,width:s,style:{display:i.display,height:i.height,width:i.width}}},i.display=i.display||"block",i.boxSizing=i.boxSizing||"border-box",sH(s)){const l=GG(n,"width");l!==void 0&&(n.width=l)}if(sH(o))if(n.style.height==="")n.height=n.width/(e||2);else{const l=GG(n,"height");l!==void 0&&(n.height=l)}return n}const SJ=ECe?{passive:!0}:!1;function APe(n,e,i){n.addEventListener(e,i,SJ)}function EPe(n,e,i){n.canvas.removeEventListener(e,i,SJ)}function MPe(n,e){const i=wPe[n.type]||n.type,{x:o,y:s}=rg(n,e);return{type:i,chart:e,native:n,x:o!==void 0?o:null,y:s!==void 0?s:null}}function bM(n,e){for(const i of n)if(i===e||i.contains(e))return!0}function TPe(n,e,i){const o=n.canvas,s=new MutationObserver(l=>{let d=!1;for(const p of l)d=d||bM(p.addedNodes,o),d=d&&!bM(p.removedNodes,o);d&&i()});return s.observe(document,{childList:!0,subtree:!0}),s}function CPe(n,e,i){const o=n.canvas,s=new MutationObserver(l=>{let d=!1;for(const p of l)d=d||bM(p.removedNodes,o),d=d&&!bM(p.addedNodes,o);d&&i()});return s.observe(document,{childList:!0,subtree:!0}),s}const Tw=new Map;let lH=0;function AJ(){const n=window.devicePixelRatio;n!==lH&&(lH=n,Tw.forEach((e,i)=>{i.currentDevicePixelRatio!==n&&e()}))}function PPe(n,e){Tw.size||window.addEventListener("resize",AJ),Tw.set(n,e)}function IPe(n){Tw.delete(n),Tw.size||window.removeEventListener("resize",AJ)}function LPe(n,e,i){const o=n.canvas,s=o&&iO(o);if(!s)return;const l=QK((p,f)=>{const y=s.clientWidth;i(p,f),y<s.clientWidth&&i()},window),d=new ResizeObserver(p=>{const f=p[0],y=f.contentRect.width,_=f.contentRect.height;y===0&&_===0||l(y,_)});return d.observe(s),PPe(n,l),d}function CI(n,e,i){i&&i.disconnect(),e==="resize"&&IPe(n)}function RPe(n,e,i){const o=n.canvas,s=QK(l=>{n.ctx!==null&&i(MPe(l,n))},n);return APe(o,e,s),s}class kPe extends wJ{acquireContext(e,i){const o=e&&e.getContext&&e.getContext("2d");return o&&o.canvas===e?(SPe(e,i),o):null}releaseContext(e){const i=e.canvas;if(!i[vE])return!1;const o=i[vE].initial;["height","width"].forEach(l=>{const d=o[l];da(d)?i.removeAttribute(l):i.setAttribute(l,d)});const s=o.style||{};return Object.keys(s).forEach(l=>{i.style[l]=s[l]}),i.width=i.width,delete i[vE],!0}addEventListener(e,i,o){this.removeEventListener(e,i);const s=e.$proxies||(e.$proxies={}),d={attach:TPe,detach:CPe,resize:LPe}[i]||RPe;s[i]=d(e,i,o)}removeEventListener(e,i){const o=e.$proxies||(e.$proxies={}),s=o[i];if(!s)return;({attach:CI,detach:CI,resize:CI}[i]||EPe)(e,i,s),o[i]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(e,i,o,s){return ACe(e,i,o,s)}isAttached(e){const i=iO(e);return!!(i&&i.isConnected)}}function DPe(n){return!dJ()||typeof OffscreenCanvas<"u"&&n instanceof OffscreenCanvas?xPe:kPe}var UA;let Xh=(UA=class{constructor(){xn(this,"x");xn(this,"y");xn(this,"active",!1);xn(this,"options");xn(this,"$animations")}tooltipPosition(e){const{x:i,y:o}=this.getProps(["x","y"],e);return{x:i,y:o}}hasValue(){return f_(this.x)&&f_(this.y)}getProps(e,i){const o=this.$animations;if(!i||!o)return this;const s={};return e.forEach(l=>{s[l]=o[l]&&o[l].active()?o[l]._to:this[l]}),s}},xn(UA,"defaults",{}),xn(UA,"defaultRoutes"),UA);function OPe(n,e){const i=n.options.ticks,o=NPe(n),s=Math.min(i.maxTicksLimit||o,o),l=i.major.enabled?FPe(e):[],d=l.length,p=l[0],f=l[d-1],y=[];if(d>s)return BPe(e,y,l,d/s),y;const _=zPe(l,e,s);if(d>0){let x,S;const T=d>1?Math.round((f-p)/(d-1)):null;for(MA(e,y,_,da(T)?0:p-T,p),x=0,S=d-1;x<S;x++)MA(e,y,_,l[x],l[x+1]);return MA(e,y,_,f,da(T)?e.length:f+T),y}return MA(e,y,_),y}function NPe(n){const e=n.options.offset,i=n._tickSize(),o=n._length/i+(e?0:1),s=n._maxLength/i;return Math.floor(Math.min(o,s))}function zPe(n,e,i){const o=UPe(n),s=e.length/i;if(!o)return Math.max(s,1);const l=CTe(o);for(let d=0,p=l.length-1;d<p;d++){const f=l[d];if(f>s)return f}return Math.max(s,1)}function FPe(n){const e=[];let i,o;for(i=0,o=n.length;i<o;i++)n[i].major&&e.push(i);return e}function BPe(n,e,i,o){let s=0,l=i[0],d;for(o=Math.ceil(o),d=0;d<n.length;d++)d===l&&(e.push(n[d]),s++,l=i[s*o])}function MA(n,e,i,o,s){const l=Fi(o,0),d=Math.min(Fi(s,n.length),n.length);let p=0,f,y,_;for(i=Math.ceil(i),s&&(f=s-o,i=f/Math.floor(f/i)),_=l;_<0;)p++,_=Math.round(l+p*i);for(y=Math.max(l,0);y<d;y++)y===_&&(e.push(n[y]),p++,_=Math.round(l+p*i))}function UPe(n){const e=n.length;let i,o;if(e<2)return!1;for(o=n[0],i=1;i<e;++i)if(n[i]-n[i-1]!==o)return!1;return o}const WPe=n=>n==="left"?"right":n==="right"?"left":n,cH=(n,e,i)=>e==="top"||e==="left"?n[e]+i:n[e]-i,uH=(n,e)=>Math.min(e||n,n);function dH(n,e){const i=[],o=n.length/e,s=n.length;let l=0;for(;l<s;l+=o)i.push(n[Math.floor(l)]);return i}function VPe(n,e,i){const o=n.ticks.length,s=Math.min(e,o-1),l=n._startPixel,d=n._endPixel,p=1e-6;let f=n.getPixelForTick(s),y;if(!(i&&(o===1?y=Math.max(f-l,d-f):e===0?y=(n.getPixelForTick(1)-f)/2:y=(f-n.getPixelForTick(s-1))/2,f+=s<e?y:-y,f<l-p||f>d+p)))return f}function GPe(n,e){Ua(n,i=>{const o=i.gc,s=o.length/2;let l;if(s>e){for(l=0;l<s;++l)delete i.data[o[l]];o.splice(0,s)}})}function Pb(n){return n.drawTicks?n.tickLength:0}function hH(n,e){if(!n.display)return 0;const i=Ro(n.font,e),o=Ms(n.padding);return(cr(n.text)?n.text.length:1)*i.lineHeight+o.height}function HPe(n,e){return Of(n,{scale:e,type:"scale"})}function jPe(n,e,i){return Of(n,{tick:i,index:e,type:"tick"})}function $Pe(n,e,i){let o=K6(n);return(i&&e!=="right"||!i&&e==="right")&&(o=WPe(o)),o}function YPe(n,e,i,o){const{top:s,left:l,bottom:d,right:p,chart:f}=n,{chartArea:y,scales:_}=f;let x=0,S,T,I;const R=d-s,D=p-l;if(n.isHorizontal()){if(T=ys(o,l,p),Qi(i)){const L=Object.keys(i)[0],O=i[L];I=_[L].getPixelForValue(O)+R-e}else i==="center"?I=(y.bottom+y.top)/2+R-e:I=cH(n,i,e);S=p-l}else{if(Qi(i)){const L=Object.keys(i)[0],O=i[L];T=_[L].getPixelForValue(O)-D+e}else i==="center"?T=(y.left+y.right)/2-D+e:T=cH(n,i,e);I=ys(o,d,s),x=i==="left"?-co:co}return{titleX:T,titleY:I,maxWidth:S,rotation:x}}class ny extends Xh{constructor(e){super(),this.id=e.id,this.type=e.type,this.options=void 0,this.ctx=e.ctx,this.chart=e.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(e){this.options=e.setContext(this.getContext()),this.axis=e.axis,this._userMin=this.parse(e.min),this._userMax=this.parse(e.max),this._suggestedMin=this.parse(e.suggestedMin),this._suggestedMax=this.parse(e.suggestedMax)}parse(e,i){return e}getUserBounds(){let{_userMin:e,_userMax:i,_suggestedMin:o,_suggestedMax:s}=this;return e=Wl(e,Number.POSITIVE_INFINITY),i=Wl(i,Number.NEGATIVE_INFINITY),o=Wl(o,Number.POSITIVE_INFINITY),s=Wl(s,Number.NEGATIVE_INFINITY),{min:Wl(e,o),max:Wl(i,s),minDefined:Xr(e),maxDefined:Xr(i)}}getMinMax(e){let{min:i,max:o,minDefined:s,maxDefined:l}=this.getUserBounds(),d;if(s&&l)return{min:i,max:o};const p=this.getMatchingVisibleMetas();for(let f=0,y=p.length;f<y;++f)d=p[f].controller.getMinMax(this,e),s||(i=Math.min(i,d.min)),l||(o=Math.max(o,d.max));return i=l&&i>o?o:i,o=s&&i>o?i:o,{min:Wl(i,Wl(o,i)),max:Wl(o,Wl(i,o))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const e=this.chart.data;return this.options.labels||(this.isHorizontal()?e.xLabels:e.yLabels)||e.labels||[]}getLabelItems(e=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(e))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){nr(this.options.beforeUpdate,[this])}update(e,i,o){const{beginAtZero:s,grace:l,ticks:d}=this.options,p=d.sampleSize;this.beforeUpdate(),this.maxWidth=e,this.maxHeight=i,this._margins=o=Object.assign({left:0,right:0,top:0,bottom:0},o),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+o.left+o.right:this.height+o.top+o.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=nCe(this,l,s),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const f=p<this.ticks.length;this._convertTicksToLabels(f?dH(this.ticks,p):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),d.display&&(d.autoSkip||d.source==="auto")&&(this.ticks=OPe(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),f&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let e=this.options.reverse,i,o;this.isHorizontal()?(i=this.left,o=this.right):(i=this.top,o=this.bottom,e=!e),this._startPixel=i,this._endPixel=o,this._reversePixels=e,this._length=o-i,this._alignToPixels=this.options.alignToPixels}afterUpdate(){nr(this.options.afterUpdate,[this])}beforeSetDimensions(){nr(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){nr(this.options.afterSetDimensions,[this])}_callHooks(e){this.chart.notifyPlugins(e,this.getContext()),nr(this.options[e],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){nr(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(e){const i=this.options.ticks;let o,s,l;for(o=0,s=e.length;o<s;o++)l=e[o],l.label=nr(i.callback,[l.value,o,e],this)}afterTickToLabelConversion(){nr(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){nr(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const e=this.options,i=e.ticks,o=uH(this.ticks.length,e.ticks.maxTicksLimit),s=i.minRotation||0,l=i.maxRotation;let d=s,p,f,y;if(!this._isVisible()||!i.display||s>=l||o<=1||!this.isHorizontal()){this.labelRotation=s;return}const _=this._getLabelSizes(),x=_.widest.width,S=_.highest.height,T=Uo(this.chart.width-x,0,this.maxWidth);p=e.offset?this.maxWidth/o:T/(o-1),x+6>p&&(p=T/(o-(e.offset?.5:1)),f=this.maxHeight-Pb(e.grid)-i.padding-hH(e.title,this.chart.options.font),y=Math.sqrt(x*x+S*S),d=X6(Math.min(Math.asin(Uo((_.highest.height+6)/p,-1,1)),Math.asin(Uo(f/y,-1,1))-Math.asin(Uo(S/y,-1,1)))),d=Math.max(s,Math.min(l,d))),this.labelRotation=d}afterCalculateLabelRotation(){nr(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){nr(this.options.beforeFit,[this])}fit(){const e={width:0,height:0},{chart:i,options:{ticks:o,title:s,grid:l}}=this,d=this._isVisible(),p=this.isHorizontal();if(d){const f=hH(s,i.options.font);if(p?(e.width=this.maxWidth,e.height=Pb(l)+f):(e.height=this.maxHeight,e.width=Pb(l)+f),o.display&&this.ticks.length){const{first:y,last:_,widest:x,highest:S}=this._getLabelSizes(),T=o.padding*2,I=du(this.labelRotation),R=Math.cos(I),D=Math.sin(I);if(p){const L=o.mirror?0:D*x.width+R*S.height;e.height=Math.min(this.maxHeight,e.height+L+T)}else{const L=o.mirror?0:R*x.width+D*S.height;e.width=Math.min(this.maxWidth,e.width+L+T)}this._calculatePadding(y,_,D,R)}}this._handleMargins(),p?(this.width=this._length=i.width-this._margins.left-this._margins.right,this.height=e.height):(this.width=e.width,this.height=this._length=i.height-this._margins.top-this._margins.bottom)}_calculatePadding(e,i,o,s){const{ticks:{align:l,padding:d},position:p}=this.options,f=this.labelRotation!==0,y=p!=="top"&&this.axis==="x";if(this.isHorizontal()){const _=this.getPixelForTick(0)-this.left,x=this.right-this.getPixelForTick(this.ticks.length-1);let S=0,T=0;f?y?(S=s*e.width,T=o*i.height):(S=o*e.height,T=s*i.width):l==="start"?T=i.width:l==="end"?S=e.width:l!=="inner"&&(S=e.width/2,T=i.width/2),this.paddingLeft=Math.max((S-_+d)*this.width/(this.width-_),0),this.paddingRight=Math.max((T-x+d)*this.width/(this.width-x),0)}else{let _=i.height/2,x=e.height/2;l==="start"?(_=0,x=e.height):l==="end"&&(_=i.height,x=0),this.paddingTop=_+d,this.paddingBottom=x+d}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){nr(this.options.afterFit,[this])}isHorizontal(){const{axis:e,position:i}=this.options;return i==="top"||i==="bottom"||e==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(e){this.beforeTickToLabelConversion(),this.generateTickLabels(e);let i,o;for(i=0,o=e.length;i<o;i++)da(e[i].label)&&(e.splice(i,1),o--,i--);this.afterTickToLabelConversion()}_getLabelSizes(){let e=this._labelSizes;if(!e){const i=this.options.ticks.sampleSize;let o=this.ticks;i<o.length&&(o=dH(o,i)),this._labelSizes=e=this._computeLabelSizes(o,o.length,this.options.ticks.maxTicksLimit)}return e}_computeLabelSizes(e,i,o){const{ctx:s,_longestTextCache:l}=this,d=[],p=[],f=Math.floor(i/uH(i,o));let y=0,_=0,x,S,T,I,R,D,L,O,N,F,G;for(x=0;x<i;x+=f){if(I=e[x].label,R=this._resolveTickFontOptions(x),s.font=D=R.string,L=l[D]=l[D]||{data:{},gc:[]},O=R.lineHeight,N=F=0,!da(I)&&!cr(I))N=vM(s,L.data,L.gc,N,I),F=O;else if(cr(I))for(S=0,T=I.length;S<T;++S)G=I[S],!da(G)&&!cr(G)&&(N=vM(s,L.data,L.gc,N,G),F+=O);d.push(N),p.push(F),y=Math.max(N,y),_=Math.max(F,_)}GPe(l,i);const j=d.indexOf(y),Y=p.indexOf(_),te=V=>({width:d[V]||0,height:p[V]||0});return{first:te(0),last:te(i-1),widest:te(j),highest:te(Y),widths:d,heights:p}}getLabelForValue(e){return e}getPixelForValue(e,i){return NaN}getValueForPixel(e){}getPixelForTick(e){const i=this.ticks;return e<0||e>i.length-1?null:this.getPixelForValue(i[e].value)}getPixelForDecimal(e){this._reversePixels&&(e=1-e);const i=this._startPixel+e*this._length;return LTe(this._alignToPixels?qm(this.chart,i,0):i)}getDecimalForPixel(e){const i=(e-this._startPixel)/this._length;return this._reversePixels?1-i:i}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:e,max:i}=this;return e<0&&i<0?i:e>0&&i>0?e:0}getContext(e){const i=this.ticks||[];if(e>=0&&e<i.length){const o=i[e];return o.$context||(o.$context=jPe(this.getContext(),e,o))}return this.$context||(this.$context=HPe(this.chart.getContext(),this))}_tickSize(){const e=this.options.ticks,i=du(this.labelRotation),o=Math.abs(Math.cos(i)),s=Math.abs(Math.sin(i)),l=this._getLabelSizes(),d=e.autoSkipPadding||0,p=l?l.widest.width+d:0,f=l?l.highest.height+d:0;return this.isHorizontal()?f*o>p*s?p/o:f/s:f*s<p*o?f/o:p/s}_isVisible(){const e=this.options.display;return e!=="auto"?!!e:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(e){const i=this.axis,o=this.chart,s=this.options,{grid:l,position:d,border:p}=s,f=l.offset,y=this.isHorizontal(),x=this.ticks.length+(f?1:0),S=Pb(l),T=[],I=p.setContext(this.getContext()),R=I.display?I.width:0,D=R/2,L=function(Ie){return qm(o,Ie,R)};let O,N,F,G,j,Y,te,V,Q,he,fe,ye;if(d==="top")O=L(this.bottom),Y=this.bottom-S,V=O-D,he=L(e.top)+D,ye=e.bottom;else if(d==="bottom")O=L(this.top),he=e.top,ye=L(e.bottom)-D,Y=O+D,V=this.top+S;else if(d==="left")O=L(this.right),j=this.right-S,te=O-D,Q=L(e.left)+D,fe=e.right;else if(d==="right")O=L(this.left),Q=e.left,fe=L(e.right)-D,j=O+D,te=this.left+S;else if(i==="x"){if(d==="center")O=L((e.top+e.bottom)/2+.5);else if(Qi(d)){const Ie=Object.keys(d)[0],ze=d[Ie];O=L(this.chart.scales[Ie].getPixelForValue(ze))}he=e.top,ye=e.bottom,Y=O+D,V=Y+S}else if(i==="y"){if(d==="center")O=L((e.left+e.right)/2);else if(Qi(d)){const Ie=Object.keys(d)[0],ze=d[Ie];O=L(this.chart.scales[Ie].getPixelForValue(ze))}j=O-D,te=j-S,Q=e.left,fe=e.right}const pe=Fi(s.ticks.maxTicksLimit,x),Me=Math.max(1,Math.ceil(x/pe));for(N=0;N<x;N+=Me){const Ie=this.getContext(N),ze=l.setContext(Ie),le=p.setContext(Ie),me=ze.lineWidth,xe=ze.color,ae=le.dash||[],Ee=le.dashOffset,Je=ze.tickWidth,Ze=ze.tickColor,Ke=ze.tickBorderDash||[],Fe=ze.tickBorderDashOffset;F=VPe(this,N,f),F!==void 0&&(G=qm(o,F,me),y?j=te=Q=fe=G:Y=V=he=ye=G,T.push({tx1:j,ty1:Y,tx2:te,ty2:V,x1:Q,y1:he,x2:fe,y2:ye,width:me,color:xe,borderDash:ae,borderDashOffset:Ee,tickWidth:Je,tickColor:Ze,tickBorderDash:Ke,tickBorderDashOffset:Fe}))}return this._ticksLength=x,this._borderValue=O,T}_computeLabelItems(e){const i=this.axis,o=this.options,{position:s,ticks:l}=o,d=this.isHorizontal(),p=this.ticks,{align:f,crossAlign:y,padding:_,mirror:x}=l,S=Pb(o.grid),T=S+_,I=x?-_:T,R=-du(this.labelRotation),D=[];let L,O,N,F,G,j,Y,te,V,Q,he,fe,ye="middle";if(s==="top")j=this.bottom-I,Y=this._getXAxisLabelAlignment();else if(s==="bottom")j=this.top+I,Y=this._getXAxisLabelAlignment();else if(s==="left"){const Me=this._getYAxisLabelAlignment(S);Y=Me.textAlign,G=Me.x}else if(s==="right"){const Me=this._getYAxisLabelAlignment(S);Y=Me.textAlign,G=Me.x}else if(i==="x"){if(s==="center")j=(e.top+e.bottom)/2+T;else if(Qi(s)){const Me=Object.keys(s)[0],Ie=s[Me];j=this.chart.scales[Me].getPixelForValue(Ie)+T}Y=this._getXAxisLabelAlignment()}else if(i==="y"){if(s==="center")G=(e.left+e.right)/2-T;else if(Qi(s)){const Me=Object.keys(s)[0],Ie=s[Me];G=this.chart.scales[Me].getPixelForValue(Ie)}Y=this._getYAxisLabelAlignment(S).textAlign}i==="y"&&(f==="start"?ye="top":f==="end"&&(ye="bottom"));const pe=this._getLabelSizes();for(L=0,O=p.length;L<O;++L){N=p[L],F=N.label;const Me=l.setContext(this.getContext(L));te=this.getPixelForTick(L)+l.labelOffset,V=this._resolveTickFontOptions(L),Q=V.lineHeight,he=cr(F)?F.length:1;const Ie=he/2,ze=Me.color,le=Me.textStrokeColor,me=Me.textStrokeWidth;let xe=Y;d?(G=te,Y==="inner"&&(L===O-1?xe=this.options.reverse?"left":"right":L===0?xe=this.options.reverse?"right":"left":xe="center"),s==="top"?y==="near"||R!==0?fe=-he*Q+Q/2:y==="center"?fe=-pe.highest.height/2-Ie*Q+Q:fe=-pe.highest.height+Q/2:y==="near"||R!==0?fe=Q/2:y==="center"?fe=pe.highest.height/2-Ie*Q:fe=pe.highest.height-he*Q,x&&(fe*=-1),R!==0&&!Me.showLabelBackdrop&&(G+=Q/2*Math.sin(R))):(j=te,fe=(1-he)*Q/2);let ae;if(Me.showLabelBackdrop){const Ee=Ms(Me.backdropPadding),Je=pe.heights[L],Ze=pe.widths[L];let Ke=fe-Ee.top,Fe=0-Ee.left;switch(ye){case"middle":Ke-=Je/2;break;case"bottom":Ke-=Je;break}switch(Y){case"center":Fe-=Ze/2;break;case"right":Fe-=Ze;break}ae={left:Fe,top:Ke,width:Ze+Ee.width,height:Je+Ee.height,color:Me.backdropColor}}D.push({label:F,font:V,textOffset:fe,options:{rotation:R,color:ze,strokeColor:le,strokeWidth:me,textAlign:xe,textBaseline:ye,translation:[G,j],backdrop:ae}})}return D}_getXAxisLabelAlignment(){const{position:e,ticks:i}=this.options;if(-du(this.labelRotation))return e==="top"?"left":"right";let s="center";return i.align==="start"?s="left":i.align==="end"?s="right":i.align==="inner"&&(s="inner"),s}_getYAxisLabelAlignment(e){const{position:i,ticks:{crossAlign:o,mirror:s,padding:l}}=this.options,d=this._getLabelSizes(),p=e+l,f=d.widest.width;let y,_;return i==="left"?s?(_=this.right+l,o==="near"?y="left":o==="center"?(y="center",_+=f/2):(y="right",_+=f)):(_=this.right-p,o==="near"?y="right":o==="center"?(y="center",_-=f/2):(y="left",_=this.left)):i==="right"?s?(_=this.left+l,o==="near"?y="right":o==="center"?(y="center",_-=f/2):(y="left",_-=f)):(_=this.left+p,o==="near"?y="left":o==="center"?(y="center",_+=f/2):(y="right",_=this.right)):y="right",{textAlign:y,x:_}}_computeLabelArea(){if(this.options.ticks.mirror)return;const e=this.chart,i=this.options.position;if(i==="left"||i==="right")return{top:0,left:this.left,bottom:e.height,right:this.right};if(i==="top"||i==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:e.width}}drawBackground(){const{ctx:e,options:{backgroundColor:i},left:o,top:s,width:l,height:d}=this;i&&(e.save(),e.fillStyle=i,e.fillRect(o,s,l,d),e.restore())}getLineWidthForValue(e){const i=this.options.grid;if(!this._isVisible()||!i.display)return 0;const s=this.ticks.findIndex(l=>l.value===e);return s>=0?i.setContext(this.getContext(s)).lineWidth:0}drawGrid(e){const i=this.options.grid,o=this.ctx,s=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(e));let l,d;const p=(f,y,_)=>{!_.width||!_.color||(o.save(),o.lineWidth=_.width,o.strokeStyle=_.color,o.setLineDash(_.borderDash||[]),o.lineDashOffset=_.borderDashOffset,o.beginPath(),o.moveTo(f.x,f.y),o.lineTo(y.x,y.y),o.stroke(),o.restore())};if(i.display)for(l=0,d=s.length;l<d;++l){const f=s[l];i.drawOnChartArea&&p({x:f.x1,y:f.y1},{x:f.x2,y:f.y2},f),i.drawTicks&&p({x:f.tx1,y:f.ty1},{x:f.tx2,y:f.ty2},{color:f.tickColor,width:f.tickWidth,borderDash:f.tickBorderDash,borderDashOffset:f.tickBorderDashOffset})}}drawBorder(){const{chart:e,ctx:i,options:{border:o,grid:s}}=this,l=o.setContext(this.getContext()),d=o.display?l.width:0;if(!d)return;const p=s.setContext(this.getContext(0)).lineWidth,f=this._borderValue;let y,_,x,S;this.isHorizontal()?(y=qm(e,this.left,d)-d/2,_=qm(e,this.right,p)+p/2,x=S=f):(x=qm(e,this.top,d)-d/2,S=qm(e,this.bottom,p)+p/2,y=_=f),i.save(),i.lineWidth=l.width,i.strokeStyle=l.color,i.beginPath(),i.moveTo(y,x),i.lineTo(_,S),i.stroke(),i.restore()}drawLabels(e){if(!this.options.ticks.display)return;const o=this.ctx,s=this._computeLabelArea();s&&fC(o,s);const l=this.getLabelItems(e);for(const d of l){const p=d.options,f=d.font,y=d.label,_=d.textOffset;jg(o,y,0,_,f,p)}s&&mC(o)}drawTitle(){const{ctx:e,options:{position:i,title:o,reverse:s}}=this;if(!o.display)return;const l=Ro(o.font),d=Ms(o.padding),p=o.align;let f=l.lineHeight/2;i==="bottom"||i==="center"||Qi(i)?(f+=d.bottom,cr(o.text)&&(f+=l.lineHeight*(o.text.length-1))):f+=d.top;const{titleX:y,titleY:_,maxWidth:x,rotation:S}=YPe(this,f,i,p);jg(e,o.text,0,0,l,{color:o.color,maxWidth:x,rotation:S,textAlign:$Pe(p,i,s),textBaseline:"middle",translation:[y,_]})}draw(e){this._isVisible()&&(this.drawBackground(),this.drawGrid(e),this.drawBorder(),this.drawTitle(),this.drawLabels(e))}_layers(){const e=this.options,i=e.ticks&&e.ticks.z||0,o=Fi(e.grid&&e.grid.z,-1),s=Fi(e.border&&e.border.z,0);return!this._isVisible()||this.draw!==ny.prototype.draw?[{z:i,draw:l=>{this.draw(l)}}]:[{z:o,draw:l=>{this.drawBackground(),this.drawGrid(l),this.drawTitle()}},{z:s,draw:()=>{this.drawBorder()}},{z:i,draw:l=>{this.drawLabels(l)}}]}getMatchingVisibleMetas(e){const i=this.chart.getSortedVisibleDatasetMetas(),o=this.axis+"AxisID",s=[];let l,d;for(l=0,d=i.length;l<d;++l){const p=i[l];p[o]===this.id&&(!e||p.type===e)&&s.push(p)}return s}_resolveTickFontOptions(e){const i=this.options.ticks.setContext(this.getContext(e));return Ro(i.font)}_maxDigits(){const e=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/e}}class TA{constructor(e,i,o){this.type=e,this.scope=i,this.override=o,this.items=Object.create(null)}isForType(e){return Object.prototype.isPrototypeOf.call(this.type.prototype,e.prototype)}register(e){const i=Object.getPrototypeOf(e);let o;ZPe(i)&&(o=this.register(i));const s=this.items,l=e.id,d=this.scope+"."+l;if(!l)throw new Error("class does not have id: "+e);return l in s||(s[l]=e,qPe(e,d,o),this.override&&Zr.override(e.id,e.overrides)),d}get(e){return this.items[e]}unregister(e){const i=this.items,o=e.id,s=this.scope;o in i&&delete i[o],s&&o in Zr[s]&&(delete Zr[s][o],this.override&&delete Hg[o])}}function qPe(n,e,i){const o=Sw(Object.create(null),[i?Zr.get(i):{},Zr.get(e),n.defaults]);Zr.set(e,o),n.defaultRoutes&&XPe(e,n.defaultRoutes),n.descriptors&&Zr.describe(e,n.descriptors)}function XPe(n,e){Object.keys(e).forEach(i=>{const o=i.split("."),s=o.pop(),l=[n].concat(o).join("."),d=e[i].split("."),p=d.pop(),f=d.join(".");Zr.route(l,s,f,p)})}function ZPe(n){return"id"in n&&"defaults"in n}class KPe{constructor(){this.controllers=new TA(fu,"datasets",!0),this.elements=new TA(Xh,"elements"),this.plugins=new TA(Object,"plugins"),this.scales=new TA(ny,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...e){this._each("register",e)}remove(...e){this._each("unregister",e)}addControllers(...e){this._each("register",e,this.controllers)}addElements(...e){this._each("register",e,this.elements)}addPlugins(...e){this._each("register",e,this.plugins)}addScales(...e){this._each("register",e,this.scales)}getController(e){return this._get(e,this.controllers,"controller")}getElement(e){return this._get(e,this.elements,"element")}getPlugin(e){return this._get(e,this.plugins,"plugin")}getScale(e){return this._get(e,this.scales,"scale")}removeControllers(...e){this._each("unregister",e,this.controllers)}removeElements(...e){this._each("unregister",e,this.elements)}removePlugins(...e){this._each("unregister",e,this.plugins)}removeScales(...e){this._each("unregister",e,this.scales)}_each(e,i,o){[...i].forEach(s=>{const l=o||this._getRegistryForType(s);o||l.isForType(s)||l===this.plugins&&s.id?this._exec(e,l,s):Ua(s,d=>{const p=o||this._getRegistryForType(d);this._exec(e,p,d)})})}_exec(e,i,o){const s=q6(e);nr(o["before"+s],[],o),i[e](o),nr(o["after"+s],[],o)}_getRegistryForType(e){for(let i=0;i<this._typedRegistries.length;i++){const o=this._typedRegistries[i];if(o.isForType(e))return o}return this.plugins}_get(e,i,o){const s=i.get(e);if(s===void 0)throw new Error('"'+e+'" is not a registered '+o+".");return s}}var rd=new KPe;class JPe{constructor(){this._init=[]}notify(e,i,o,s){i==="beforeInit"&&(this._init=this._createDescriptors(e,!0),this._notify(this._init,e,"install"));const l=s?this._descriptors(e).filter(s):this._descriptors(e),d=this._notify(l,e,i,o);return i==="afterDestroy"&&(this._notify(l,e,"stop"),this._notify(this._init,e,"uninstall")),d}_notify(e,i,o,s){s=s||{};for(const l of e){const d=l.plugin,p=d[o],f=[i,s,l.options];if(nr(p,f,d)===!1&&s.cancelable)return!1}return!0}invalidate(){da(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(e){if(this._cache)return this._cache;const i=this._cache=this._createDescriptors(e);return this._notifyStateChanges(e),i}_createDescriptors(e,i){const o=e&&e.config,s=Fi(o.options&&o.options.plugins,{}),l=QPe(o);return s===!1&&!i?[]:t5e(e,l,s,i)}_notifyStateChanges(e){const i=this._oldCache||[],o=this._cache,s=(l,d)=>l.filter(p=>!d.some(f=>p.plugin.id===f.plugin.id));this._notify(s(i,o),e,"stop"),this._notify(s(o,i),e,"start")}}function QPe(n){const e={},i=[],o=Object.keys(rd.plugins.items);for(let l=0;l<o.length;l++)i.push(rd.getPlugin(o[l]));const s=n.plugins||[];for(let l=0;l<s.length;l++){const d=s[l];i.indexOf(d)===-1&&(i.push(d),e[d.id]=!0)}return{plugins:i,localIds:e}}function e5e(n,e){return!e&&n===!1?null:n===!0?{}:n}function t5e(n,{plugins:e,localIds:i},o,s){const l=[],d=n.getContext();for(const p of e){const f=p.id,y=e5e(o[f],s);y!==null&&l.push({plugin:p,options:n5e(n.config,{plugin:p,local:i[f]},y,d)})}return l}function n5e(n,{plugin:e,local:i},o,s){const l=n.pluginScopeKeys(e),d=n.getOptionScopes(o,l);return i&&e.defaults&&d.push(e.defaults),n.createResolver(d,s,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function JR(n,e){const i=Zr.datasets[n]||{};return((e.datasets||{})[n]||{}).indexAxis||e.indexAxis||i.indexAxis||"x"}function i5e(n,e){let i=n;return n==="_index_"?i=e:n==="_value_"&&(i=e==="x"?"y":"x"),i}function a5e(n,e){return n===e?"_index_":"_value_"}function pH(n){if(n==="x"||n==="y"||n==="r")return n}function r5e(n){if(n==="top"||n==="bottom")return"x";if(n==="left"||n==="right")return"y"}function QR(n,...e){if(pH(n))return n;for(const i of e){const o=i.axis||r5e(i.position)||n.length>1&&pH(n[0].toLowerCase());if(o)return o}throw new Error(`Cannot determine type of '${n}' axis. Please provide 'axis' or 'position' option.`)}function fH(n,e,i){if(i[e+"AxisID"]===n)return{axis:e}}function o5e(n,e){if(e.data&&e.data.datasets){const i=e.data.datasets.filter(o=>o.xAxisID===n||o.yAxisID===n);if(i.length)return fH(n,"x",i[0])||fH(n,"y",i[0])}return{}}function s5e(n,e){const i=Hg[n.type]||{scales:{}},o=e.scales||{},s=JR(n.type,e),l=Object.create(null);return Object.keys(o).forEach(d=>{const p=o[d];if(!Qi(p))return console.error(`Invalid scale configuration for scale: ${d}`);if(p._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${d}`);const f=QR(d,p,o5e(d,n),Zr.scales[p.type]),y=a5e(f,s),_=i.scales||{};l[d]=xx(Object.create(null),[{axis:f},p,_[f],_[y]])}),n.data.datasets.forEach(d=>{const p=d.type||n.type,f=d.indexAxis||JR(p,e),_=(Hg[p]||{}).scales||{};Object.keys(_).forEach(x=>{const S=i5e(x,f),T=d[S+"AxisID"]||S;l[T]=l[T]||Object.create(null),xx(l[T],[{axis:S},o[T],_[x]])})}),Object.keys(l).forEach(d=>{const p=l[d];xx(p,[Zr.scales[p.type],Zr.scale])}),l}function EJ(n){const e=n.options||(n.options={});e.plugins=Fi(e.plugins,{}),e.scales=s5e(n,e)}function MJ(n){return n=n||{},n.datasets=n.datasets||[],n.labels=n.labels||[],n}function l5e(n){return n=n||{},n.data=MJ(n.data),EJ(n),n}const mH=new Map,TJ=new Set;function CA(n,e){let i=mH.get(n);return i||(i=e(),mH.set(n,i),TJ.add(i)),i}const Ib=(n,e,i)=>{const o=Ef(e,i);o!==void 0&&n.add(o)};class c5e{constructor(e){this._config=l5e(e),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(e){this._config.type=e}get data(){return this._config.data}set data(e){this._config.data=MJ(e)}get options(){return this._config.options}set options(e){this._config.options=e}get plugins(){return this._config.plugins}update(){const e=this._config;this.clearCache(),EJ(e)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(e){return CA(e,()=>[[`datasets.${e}`,""]])}datasetAnimationScopeKeys(e,i){return CA(`${e}.transition.${i}`,()=>[[`datasets.${e}.transitions.${i}`,`transitions.${i}`],[`datasets.${e}`,""]])}datasetElementScopeKeys(e,i){return CA(`${e}-${i}`,()=>[[`datasets.${e}.elements.${i}`,`datasets.${e}`,`elements.${i}`,""]])}pluginScopeKeys(e){const i=e.id,o=this.type;return CA(`${o}-plugin-${i}`,()=>[[`plugins.${i}`,...e.additionalOptionScopes||[]]])}_cachedScopes(e,i){const o=this._scopeCache;let s=o.get(e);return(!s||i)&&(s=new Map,o.set(e,s)),s}getOptionScopes(e,i,o){const{options:s,type:l}=this,d=this._cachedScopes(e,o),p=d.get(i);if(p)return p;const f=new Set;i.forEach(_=>{e&&(f.add(e),_.forEach(x=>Ib(f,e,x))),_.forEach(x=>Ib(f,s,x)),_.forEach(x=>Ib(f,Hg[l]||{},x)),_.forEach(x=>Ib(f,Zr,x)),_.forEach(x=>Ib(f,XR,x))});const y=Array.from(f);return y.length===0&&y.push(Object.create(null)),TJ.has(i)&&d.set(i,y),y}chartOptionScopes(){const{options:e,type:i}=this;return[e,Hg[i]||{},Zr.datasets[i]||{},{type:i},Zr,XR]}resolveNamedOptions(e,i,o,s=[""]){const l={$shared:!0},{resolver:d,subPrefixes:p}=gH(this._resolverCache,e,s);let f=d;if(d5e(d,i)){l.$shared=!1,o=Mf(o)?o():o;const y=this.createResolver(e,o,p);f=m_(d,o,y)}for(const y of i)l[y]=f[y];return l}createResolver(e,i,o=[""],s){const{resolver:l}=gH(this._resolverCache,e,o);return Qi(i)?m_(l,i,void 0,s):l}}function gH(n,e,i){let o=n.get(e);o||(o=new Map,n.set(e,o));const s=i.join();let l=o.get(s);return l||(l={resolver:eO(e,i),subPrefixes:i.filter(p=>!p.toLowerCase().includes("hover"))},o.set(s,l)),l}const u5e=n=>Qi(n)&&Object.getOwnPropertyNames(n).reduce((e,i)=>e||Mf(n[i]),!1);function d5e(n,e){const{isScriptable:i,isIndexable:o}=rJ(n);for(const s of e){const l=i(s),d=o(s),p=(d||l)&&n[s];if(l&&(Mf(p)||u5e(p))||d&&cr(p))return!0}return!1}var h5e="4.4.0";const p5e=["top","bottom","left","right","chartArea"];function yH(n,e){return n==="top"||n==="bottom"||p5e.indexOf(n)===-1&&e==="x"}function vH(n,e){return function(i,o){return i[n]===o[n]?i[e]-o[e]:i[n]-o[n]}}function _H(n){const e=n.chart,i=e.options.animation;e.notifyPlugins("afterRender"),nr(i&&i.onComplete,[n],e)}function f5e(n){const e=n.chart,i=e.options.animation;nr(i&&i.onProgress,[n],e)}function CJ(n){return dJ()&&typeof n=="string"?n=document.getElementById(n):n&&n.length&&(n=n[0]),n&&n.canvas&&(n=n.canvas),n}const _E={},bH=n=>{const e=CJ(n);return Object.values(_E).filter(i=>i.canvas===e).pop()};function m5e(n,e,i){const o=Object.keys(n);for(const s of o){const l=+s;if(l>=e){const d=n[s];delete n[s],(i>0||l>e)&&(n[l+i]=d)}}}function g5e(n,e,i,o){return!i||n.type==="mouseout"?null:o?e:n}function PA(n,e,i){return n.options.clip?n[i]:e[i]}function y5e(n,e){const{xScale:i,yScale:o}=n;return i&&o?{left:PA(i,e,"left"),right:PA(i,e,"right"),top:PA(o,e,"top"),bottom:PA(o,e,"bottom")}:e}var Hp;let o2=(Hp=class{static register(...e){rd.add(...e),xH()}static unregister(...e){rd.remove(...e),xH()}constructor(e,i){const o=this.config=new c5e(i),s=CJ(e),l=bH(s);if(l)throw new Error("Canvas is already in use. Chart with ID '"+l.id+"' must be destroyed before the canvas with ID '"+l.canvas.id+"' can be reused.");const d=o.createResolver(o.chartOptionScopes(),this.getContext());this.platform=new(o.platform||DPe(s)),this.platform.updateConfig(o);const p=this.platform.acquireContext(s,d.aspectRatio),f=p&&p.canvas,y=f&&f.height,_=f&&f.width;if(this.id=_Te(),this.ctx=p,this.canvas=f,this.width=_,this.height=y,this._options=d,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new JPe,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=OTe(x=>this.update(x),d.resizeDelay||0),this._dataChanges=[],_E[this.id]=this,!p||!f){console.error("Failed to create chart: can't acquire context from the given item");return}bh.listen(this,"complete",_H),bh.listen(this,"progress",f5e),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:e,maintainAspectRatio:i},width:o,height:s,_aspectRatio:l}=this;return da(e)?i&&l?l:s?o/s:null:e}get data(){return this.config.data}set data(e){this.config.data=e}get options(){return this._options}set options(e){this.config.options=e}get registry(){return rd}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():VG(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return BG(this.canvas,this.ctx),this}stop(){return bh.stop(this),this}resize(e,i){bh.running(this)?this._resizeBeforeDraw={width:e,height:i}:this._resize(e,i)}_resize(e,i){const o=this.options,s=this.canvas,l=o.maintainAspectRatio&&this.aspectRatio,d=this.platform.getMaximumSize(s,e,i,l),p=o.devicePixelRatio||this.platform.getDevicePixelRatio(),f=this.width?"resize":"attach";this.width=d.width,this.height=d.height,this._aspectRatio=this.aspectRatio,VG(this,p,!0)&&(this.notifyPlugins("resize",{size:d}),nr(o.onResize,[this,d],this),this.attached&&this._doResize(f)&&this.render())}ensureScalesHaveIDs(){const i=this.options.scales||{};Ua(i,(o,s)=>{o.id=s})}buildOrUpdateScales(){const e=this.options,i=e.scales,o=this.scales,s=Object.keys(o).reduce((d,p)=>(d[p]=!1,d),{});let l=[];i&&(l=l.concat(Object.keys(i).map(d=>{const p=i[d],f=QR(d,p),y=f==="r",_=f==="x";return{options:p,dposition:y?"chartArea":_?"bottom":"left",dtype:y?"radialLinear":_?"category":"linear"}}))),Ua(l,d=>{const p=d.options,f=p.id,y=QR(f,p),_=Fi(p.type,d.dtype);(p.position===void 0||yH(p.position,y)!==yH(d.dposition))&&(p.position=d.dposition),s[f]=!0;let x=null;if(f in o&&o[f].type===_)x=o[f];else{const S=rd.getScale(_);x=new S({id:f,type:_,ctx:this.ctx,chart:this}),o[x.id]=x}x.init(p,e)}),Ua(s,(d,p)=>{d||delete o[p]}),Ua(o,d=>{xs.configure(this,d,d.options),xs.addBox(this,d)})}_updateMetasets(){const e=this._metasets,i=this.data.datasets.length,o=e.length;if(e.sort((s,l)=>s.index-l.index),o>i){for(let s=i;s<o;++s)this._destroyDatasetMeta(s);e.splice(i,o-i)}this._sortedMetasets=e.slice(0).sort(vH("order","index"))}_removeUnreferencedMetasets(){const{_metasets:e,data:{datasets:i}}=this;e.length>i.length&&delete this._stacks,e.forEach((o,s)=>{i.filter(l=>l===o._dataset).length===0&&this._destroyDatasetMeta(s)})}buildOrUpdateControllers(){const e=[],i=this.data.datasets;let o,s;for(this._removeUnreferencedMetasets(),o=0,s=i.length;o<s;o++){const l=i[o];let d=this.getDatasetMeta(o);const p=l.type||this.config.type;if(d.type&&d.type!==p&&(this._destroyDatasetMeta(o),d=this.getDatasetMeta(o)),d.type=p,d.indexAxis=l.indexAxis||JR(p,this.options),d.order=l.order||0,d.index=o,d.label=""+l.label,d.visible=this.isDatasetVisible(o),d.controller)d.controller.updateIndex(o),d.controller.linkScales();else{const f=rd.getController(p),{datasetElementType:y,dataElementType:_}=Zr.datasets[p];Object.assign(f,{dataElementType:rd.getElement(_),datasetElementType:y&&rd.getElement(y)}),d.controller=new f(this,o),e.push(d.controller)}}return this._updateMetasets(),e}_resetElements(){Ua(this.data.datasets,(e,i)=>{this.getDatasetMeta(i).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(e){const i=this.config;i.update();const o=this._options=i.createResolver(i.chartOptionScopes(),this.getContext()),s=this._animationsDisabled=!o.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:e,cancelable:!0})===!1)return;const l=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let d=0;for(let y=0,_=this.data.datasets.length;y<_;y++){const{controller:x}=this.getDatasetMeta(y),S=!s&&l.indexOf(x)===-1;x.buildOrUpdateElements(S),d=Math.max(+x.getMaxOverflow(),d)}d=this._minPadding=o.layout.autoPadding?d:0,this._updateLayout(d),s||Ua(l,y=>{y.reset()}),this._updateDatasets(e),this.notifyPlugins("afterUpdate",{mode:e}),this._layers.sort(vH("z","_idx"));const{_active:p,_lastEvent:f}=this;f?this._eventHandler(f,!0):p.length&&this._updateHoverStyles(p,p,!0),this.render()}_updateScales(){Ua(this.scales,e=>{xs.removeBox(this,e)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const e=this.options,i=new Set(Object.keys(this._listeners)),o=new Set(e.events);(!IG(i,o)||!!this._responsiveListeners!==e.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:e}=this,i=this._getUniformDataChanges()||[];for(const{method:o,start:s,count:l}of i){const d=o==="_removeElements"?-l:l;m5e(e,s,d)}}_getUniformDataChanges(){const e=this._dataChanges;if(!e||!e.length)return;this._dataChanges=[];const i=this.data.datasets.length,o=l=>new Set(e.filter(d=>d[0]===l).map((d,p)=>p+","+d.splice(1).join(","))),s=o(0);for(let l=1;l<i;l++)if(!IG(s,o(l)))return;return Array.from(s).map(l=>l.split(",")).map(l=>({method:l[1],start:+l[2],count:+l[3]}))}_updateLayout(e){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;xs.update(this,this.width,this.height,e);const i=this.chartArea,o=i.width<=0||i.height<=0;this._layers=[],Ua(this.boxes,s=>{o&&s.position==="chartArea"||(s.configure&&s.configure(),this._layers.push(...s._layers()))},this),this._layers.forEach((s,l)=>{s._idx=l}),this.notifyPlugins("afterLayout")}_updateDatasets(e){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:e,cancelable:!0})!==!1){for(let i=0,o=this.data.datasets.length;i<o;++i)this.getDatasetMeta(i).controller.configure();for(let i=0,o=this.data.datasets.length;i<o;++i)this._updateDataset(i,Mf(e)?e({datasetIndex:i}):e);this.notifyPlugins("afterDatasetsUpdate",{mode:e})}}_updateDataset(e,i){const o=this.getDatasetMeta(e),s={meta:o,index:e,mode:i,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",s)!==!1&&(o.controller._update(i),s.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",s))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(bh.has(this)?this.attached&&!bh.running(this)&&bh.start(this):(this.draw(),_H({chart:this})))}draw(){let e;if(this._resizeBeforeDraw){const{width:o,height:s}=this._resizeBeforeDraw;this._resize(o,s),this._resizeBeforeDraw=null}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const i=this._layers;for(e=0;e<i.length&&i[e].z<=0;++e)i[e].draw(this.chartArea);for(this._drawDatasets();e<i.length;++e)i[e].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(e){const i=this._sortedMetasets,o=[];let s,l;for(s=0,l=i.length;s<l;++s){const d=i[s];(!e||d.visible)&&o.push(d)}return o}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const e=this.getSortedVisibleDatasetMetas();for(let i=e.length-1;i>=0;--i)this._drawDataset(e[i]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(e){const i=this.ctx,o=e._clip,s=!o.disabled,l=y5e(e,this.chartArea),d={meta:e,index:e.index,cancelable:!0};this.notifyPlugins("beforeDatasetDraw",d)!==!1&&(s&&fC(i,{left:o.left===!1?0:l.left-o.left,right:o.right===!1?this.width:l.right+o.right,top:o.top===!1?0:l.top-o.top,bottom:o.bottom===!1?this.height:l.bottom+o.bottom}),e.controller.draw(),s&&mC(i),d.cancelable=!1,this.notifyPlugins("afterDatasetDraw",d))}isPointInArea(e){return Oh(e,this.chartArea,this._minPadding)}getElementsAtEventForMode(e,i,o,s){const l=pPe.modes[i];return typeof l=="function"?l(this,e,o,s):[]}getDatasetMeta(e){const i=this.data.datasets[e],o=this._metasets;let s=o.filter(l=>l&&l._dataset===i).pop();return s||(s={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:i&&i.order||0,index:e,_dataset:i,_parsed:[],_sorted:!1},o.push(s)),s}getContext(){return this.$context||(this.$context=Of(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(e){const i=this.data.datasets[e];if(!i)return!1;const o=this.getDatasetMeta(e);return typeof o.hidden=="boolean"?!o.hidden:!i.hidden}setDatasetVisibility(e,i){const o=this.getDatasetMeta(e);o.hidden=!i}toggleDataVisibility(e){this._hiddenIndices[e]=!this._hiddenIndices[e]}getDataVisibility(e){return!this._hiddenIndices[e]}_updateVisibility(e,i,o){const s=o?"show":"hide",l=this.getDatasetMeta(e),d=l.controller._resolveAnimations(void 0,s);Aw(i)?(l.data[i].hidden=!o,this.update()):(this.setDatasetVisibility(e,o),d.update(l,{visible:o}),this.update(p=>p.datasetIndex===e?s:void 0))}hide(e,i){this._updateVisibility(e,i,!1)}show(e,i){this._updateVisibility(e,i,!0)}_destroyDatasetMeta(e){const i=this._metasets[e];i&&i.controller&&i.controller._destroy(),delete this._metasets[e]}_stop(){let e,i;for(this.stop(),bh.remove(this),e=0,i=this.data.datasets.length;e<i;++e)this._destroyDatasetMeta(e)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:e,ctx:i}=this;this._stop(),this.config.clearCache(),e&&(this.unbindEvents(),BG(e,i),this.platform.releaseContext(i),this.canvas=null,this.ctx=null),delete _E[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...e){return this.canvas.toDataURL(...e)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const e=this._listeners,i=this.platform,o=(l,d)=>{i.addEventListener(this,l,d),e[l]=d},s=(l,d,p)=>{l.offsetX=d,l.offsetY=p,this._eventHandler(l)};Ua(this.options.events,l=>o(l,s))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const e=this._responsiveListeners,i=this.platform,o=(f,y)=>{i.addEventListener(this,f,y),e[f]=y},s=(f,y)=>{e[f]&&(i.removeEventListener(this,f,y),delete e[f])},l=(f,y)=>{this.canvas&&this.resize(f,y)};let d;const p=()=>{s("attach",p),this.attached=!0,this.resize(),o("resize",l),o("detach",d)};d=()=>{this.attached=!1,s("resize",l),this._stop(),this._resize(0,0),o("attach",p)},i.isAttached(this.canvas)?p():d()}unbindEvents(){Ua(this._listeners,(e,i)=>{this.platform.removeEventListener(this,i,e)}),this._listeners={},Ua(this._responsiveListeners,(e,i)=>{this.platform.removeEventListener(this,i,e)}),this._responsiveListeners=void 0}updateHoverStyle(e,i,o){const s=o?"set":"remove";let l,d,p,f;for(i==="dataset"&&(l=this.getDatasetMeta(e[0].datasetIndex),l.controller["_"+s+"DatasetHoverStyle"]()),p=0,f=e.length;p<f;++p){d=e[p];const y=d&&this.getDatasetMeta(d.datasetIndex).controller;y&&y[s+"HoverStyle"](d.element,d.datasetIndex,d.index)}}getActiveElements(){return this._active||[]}setActiveElements(e){const i=this._active||[],o=e.map(({datasetIndex:l,index:d})=>{const p=this.getDatasetMeta(l);if(!p)throw new Error("No dataset found at index "+l);return{datasetIndex:l,element:p.data[d],index:d}});!mM(o,i)&&(this._active=o,this._lastEvent=null,this._updateHoverStyles(o,i))}notifyPlugins(e,i,o){return this._plugins.notify(this,e,i,o)}isPluginEnabled(e){return this._plugins._cache.filter(i=>i.plugin.id===e).length===1}_updateHoverStyles(e,i,o){const s=this.options.hover,l=(f,y)=>f.filter(_=>!y.some(x=>_.datasetIndex===x.datasetIndex&&_.index===x.index)),d=l(i,e),p=o?e:l(e,i);d.length&&this.updateHoverStyle(d,s.mode,!1),p.length&&s.mode&&this.updateHoverStyle(p,s.mode,!0)}_eventHandler(e,i){const o={event:e,replay:i,cancelable:!0,inChartArea:this.isPointInArea(e)},s=d=>(d.options.events||this.options.events).includes(e.native.type);if(this.notifyPlugins("beforeEvent",o,s)===!1)return;const l=this._handleEvent(e,i,o.inChartArea);return o.cancelable=!1,this.notifyPlugins("afterEvent",o,s),(l||o.changed)&&this.render(),this}_handleEvent(e,i,o){const{_active:s=[],options:l}=this,d=i,p=this._getActiveElements(e,s,o,d),f=ETe(e),y=g5e(e,this._lastEvent,o,f);o&&(this._lastEvent=null,nr(l.onHover,[e,p,this],this),f&&nr(l.onClick,[e,p,this],this));const _=!mM(p,s);return(_||i)&&(this._active=p,this._updateHoverStyles(p,s,i)),this._lastEvent=y,_}_getActiveElements(e,i,o,s){if(e.type==="mouseout")return[];if(!o)return i;const l=this.options.hover;return this.getElementsAtEventForMode(e,l.mode,l,s)}},xn(Hp,"defaults",Zr),xn(Hp,"instances",_E),xn(Hp,"overrides",Hg),xn(Hp,"registry",rd),xn(Hp,"version",h5e),xn(Hp,"getChart",bH),Hp);function xH(){return Ua(o2.instances,n=>n._plugins.invalidate())}function v5e(n,e,i){const{startAngle:o,pixelMargin:s,x:l,y:d,outerRadius:p,innerRadius:f}=e;let y=s/p;n.beginPath(),n.arc(l,d,p,o-y,i+y),f>s?(y=s/f,n.arc(l,d,f,i+y,o-y,!0)):n.arc(l,d,s,i+co,o-co),n.closePath(),n.clip()}function _5e(n){return Q6(n,["outerStart","outerEnd","innerStart","innerEnd"])}function b5e(n,e,i,o){const s=_5e(n.options.borderRadius),l=(i-e)/2,d=Math.min(l,o*e/2),p=f=>{const y=(i-Math.min(l,f))*o/2;return Uo(f,0,Math.min(l,y))};return{outerStart:p(s.outerStart),outerEnd:p(s.outerEnd),innerStart:Uo(s.innerStart,0,d),innerEnd:Uo(s.innerEnd,0,d)}}function l0(n,e,i,o){return{x:i+n*Math.cos(e),y:o+n*Math.sin(e)}}function xM(n,e,i,o,s,l){const{x:d,y:p,startAngle:f,pixelMargin:y,innerRadius:_}=e,x=Math.max(e.outerRadius+o+i-y,0),S=_>0?_+o+i+y:0;let T=0;const I=s-f;if(o){const Me=_>0?_-o:0,Ie=x>0?x-o:0,ze=(Me+Ie)/2,le=ze!==0?I*ze/(ze+o):I;T=(I-le)/2}const R=Math.max(.001,I*x-i/hr)/x,D=(I-R)/2,L=f+D+T,O=s-D-T,{outerStart:N,outerEnd:F,innerStart:G,innerEnd:j}=b5e(e,S,x,O-L),Y=x-N,te=x-F,V=L+N/Y,Q=O-F/te,he=S+G,fe=S+j,ye=L+G/he,pe=O-j/fe;if(n.beginPath(),l){const Me=(V+Q)/2;if(n.arc(d,p,x,V,Me),n.arc(d,p,x,Me,Q),F>0){const me=l0(te,Q,d,p);n.arc(me.x,me.y,F,Q,O+co)}const Ie=l0(fe,O,d,p);if(n.lineTo(Ie.x,Ie.y),j>0){const me=l0(fe,pe,d,p);n.arc(me.x,me.y,j,O+co,pe+Math.PI)}const ze=(O-j/S+(L+G/S))/2;if(n.arc(d,p,S,O-j/S,ze,!0),n.arc(d,p,S,ze,L+G/S,!0),G>0){const me=l0(he,ye,d,p);n.arc(me.x,me.y,G,ye+Math.PI,L-co)}const le=l0(Y,L,d,p);if(n.lineTo(le.x,le.y),N>0){const me=l0(Y,V,d,p);n.arc(me.x,me.y,N,L-co,V)}}else{n.moveTo(d,p);const Me=Math.cos(V)*x+d,Ie=Math.sin(V)*x+p;n.lineTo(Me,Ie);const ze=Math.cos(Q)*x+d,le=Math.sin(Q)*x+p;n.lineTo(ze,le)}n.closePath()}function x5e(n,e,i,o,s){const{fullCircles:l,startAngle:d,circumference:p}=e;let f=e.endAngle;if(l){xM(n,e,i,o,f,s);for(let y=0;y<l;++y)n.fill();isNaN(p)||(f=d+(p%dr||dr))}return xM(n,e,i,o,f,s),n.fill(),f}function w5e(n,e,i,o,s){const{fullCircles:l,startAngle:d,circumference:p,options:f}=e,{borderWidth:y,borderJoinStyle:_,borderDash:x,borderDashOffset:S}=f,T=f.borderAlign==="inner";if(!y)return;n.setLineDash(x||[]),n.lineDashOffset=S,T?(n.lineWidth=y*2,n.lineJoin=_||"round"):(n.lineWidth=y,n.lineJoin=_||"bevel");let I=e.endAngle;if(l){xM(n,e,i,o,I,s);for(let R=0;R<l;++R)n.stroke();isNaN(p)||(I=d+(p%dr||dr))}T&&v5e(n,e,I),l||(xM(n,e,i,o,I,s),n.stroke())}class $b extends Xh{constructor(i){super();xn(this,"circumference");xn(this,"endAngle");xn(this,"fullCircles");xn(this,"innerRadius");xn(this,"outerRadius");xn(this,"pixelMargin");xn(this,"startAngle");this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,i&&Object.assign(this,i)}inRange(i,o,s){const l=this.getProps(["x","y"],s),{angle:d,distance:p}=XK(l,{x:i,y:o}),{startAngle:f,endAngle:y,innerRadius:_,outerRadius:x,circumference:S}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],s),T=(this.options.spacing+this.options.borderWidth)/2,R=Fi(S,y-f)>=dr||Ew(d,f,y),D=kh(p,_+T,x+T);return R&&D}getCenterPoint(i){const{x:o,y:s,startAngle:l,endAngle:d,innerRadius:p,outerRadius:f}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],i),{offset:y,spacing:_}=this.options,x=(l+d)/2,S=(p+f+_+y)/2;return{x:o+Math.cos(x)*S,y:s+Math.sin(x)*S}}tooltipPosition(i){return this.getCenterPoint(i)}draw(i){const{options:o,circumference:s}=this,l=(o.offset||0)/4,d=(o.spacing||0)/2,p=o.circular;if(this.pixelMargin=o.borderAlign==="inner"?.33:0,this.fullCircles=s>dr?Math.floor(s/dr):0,s===0||this.innerRadius<0||this.outerRadius<0)return;i.save();const f=(this.startAngle+this.endAngle)/2;i.translate(Math.cos(f)*l,Math.sin(f)*l);const y=1-Math.sin(Math.min(hr,s||0)),_=l*y;i.fillStyle=o.backgroundColor,i.strokeStyle=o.borderColor,x5e(i,this,_,d,p),w5e(i,this,_,d,p),i.restore()}}xn($b,"id","arc"),xn($b,"defaults",{borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0}),xn($b,"defaultRoutes",{backgroundColor:"backgroundColor"}),xn($b,"descriptors",{_scriptable:!0,_indexable:i=>i!=="borderDash"});function PJ(n,e,i=e){n.lineCap=Fi(i.borderCapStyle,e.borderCapStyle),n.setLineDash(Fi(i.borderDash,e.borderDash)),n.lineDashOffset=Fi(i.borderDashOffset,e.borderDashOffset),n.lineJoin=Fi(i.borderJoinStyle,e.borderJoinStyle),n.lineWidth=Fi(i.borderWidth,e.borderWidth),n.strokeStyle=Fi(i.borderColor,e.borderColor)}function S5e(n,e,i){n.lineTo(i.x,i.y)}function A5e(n){return n.stepped?YTe:n.tension||n.cubicInterpolationMode==="monotone"?qTe:S5e}function IJ(n,e,i={}){const o=n.length,{start:s=0,end:l=o-1}=i,{start:d,end:p}=e,f=Math.max(s,d),y=Math.min(l,p),_=s<d&&l<d||s>p&&l>p;return{count:o,start:f,loop:e.loop,ilen:y<f&&!_?o+y-f:y-f}}function E5e(n,e,i,o){const{points:s,options:l}=e,{count:d,start:p,loop:f,ilen:y}=IJ(s,i,o),_=A5e(l);let{move:x=!0,reverse:S}=o||{},T,I,R;for(T=0;T<=y;++T)I=s[(p+(S?y-T:T))%d],!I.skip&&(x?(n.moveTo(I.x,I.y),x=!1):_(n,R,I,S,l.stepped),R=I);return f&&(I=s[(p+(S?y:0))%d],_(n,R,I,S,l.stepped)),!!f}function M5e(n,e,i,o){const s=e.points,{count:l,start:d,ilen:p}=IJ(s,i,o),{move:f=!0,reverse:y}=o||{};let _=0,x=0,S,T,I,R,D,L;const O=F=>(d+(y?p-F:F))%l,N=()=>{R!==D&&(n.lineTo(_,D),n.lineTo(_,R),n.lineTo(_,L))};for(f&&(T=s[O(0)],n.moveTo(T.x,T.y)),S=0;S<=p;++S){if(T=s[O(S)],T.skip)continue;const F=T.x,G=T.y,j=F|0;j===I?(G<R?R=G:G>D&&(D=G),_=(x*_+F)/++x):(N(),n.lineTo(F,G),I=j,x=0,R=D=G),L=G}N()}function ek(n){const e=n.options,i=e.borderDash&&e.borderDash.length;return!n._decimated&&!n._loop&&!e.tension&&e.cubicInterpolationMode!=="monotone"&&!e.stepped&&!i?M5e:E5e}function T5e(n){return n.stepped?MCe:n.tension||n.cubicInterpolationMode==="monotone"?TCe:og}function C5e(n,e,i,o){let s=e._path;s||(s=e._path=new Path2D,e.path(s,i,o)&&s.closePath()),PJ(n,e.options),n.stroke(s)}function P5e(n,e,i,o){const{segments:s,options:l}=e,d=ek(e);for(const p of s)PJ(n,l,p.style),n.beginPath(),d(n,e,p,{start:i,end:i+o-1})&&n.closePath(),n.stroke()}const I5e=typeof Path2D=="function";function L5e(n,e,i,o){I5e&&!e.options.segment?C5e(n,e,i,o):P5e(n,e,i,o)}class nf extends Xh{constructor(e){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,e&&Object.assign(this,e)}updateControlPoints(e,i){const o=this.options;if((o.tension||o.cubicInterpolationMode==="monotone")&&!o.stepped&&!this._pointsUpdated){const s=o.spanGaps?this._loop:this._fullLoop;vCe(this._points,o,e,s,i),this._pointsUpdated=!0}}set points(e){this._points=e,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=kCe(this,this.options.segment))}first(){const e=this.segments,i=this.points;return e.length&&i[e[0].start]}last(){const e=this.segments,i=this.points,o=e.length;return o&&i[e[o-1].end]}interpolate(e,i){const o=this.options,s=e[i],l=this.points,d=gJ(this,{property:i,start:s,end:s});if(!d.length)return;const p=[],f=T5e(o);let y,_;for(y=0,_=d.length;y<_;++y){const{start:x,end:S}=d[y],T=l[x],I=l[S];if(T===I){p.push(T);continue}const R=Math.abs((s-T[i])/(I[i]-T[i])),D=f(T,I,R,o.stepped);D[i]=e[i],p.push(D)}return p.length===1?p[0]:p}pathSegment(e,i,o){return ek(this)(e,this,i,o)}path(e,i,o){const s=this.segments,l=ek(this);let d=this._loop;i=i||0,o=o||this.points.length-i;for(const p of s)d&=l(e,this,p,{start:i,end:i+o-1});return!!d}draw(e,i,o,s){const l=this.options||{};(this.points||[]).length&&l.borderWidth&&(e.save(),L5e(e,this,o,s),e.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}xn(nf,"id","line"),xn(nf,"defaults",{borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0}),xn(nf,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"}),xn(nf,"descriptors",{_scriptable:!0,_indexable:e=>e!=="borderDash"&&e!=="fill"});function wH(n,e,i,o){const s=n.options,{[i]:l}=n.getProps([i],o);return Math.abs(e-l)<s.radius+s.hitRadius}class bE extends Xh{constructor(i){super();xn(this,"parsed");xn(this,"skip");xn(this,"stop");this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,i&&Object.assign(this,i)}inRange(i,o,s){const l=this.options,{x:d,y:p}=this.getProps(["x","y"],s);return Math.pow(i-d,2)+Math.pow(o-p,2)<Math.pow(l.hitRadius+l.radius,2)}inXRange(i,o){return wH(this,i,"x",o)}inYRange(i,o){return wH(this,i,"y",o)}getCenterPoint(i){const{x:o,y:s}=this.getProps(["x","y"],i);return{x:o,y:s}}size(i){i=i||this.options||{};let o=i.radius||0;o=Math.max(o,o&&i.hoverRadius||0);const s=o&&i.borderWidth||0;return(o+s)*2}draw(i,o){const s=this.options;this.skip||s.radius<.1||!Oh(this,o,this.size(s)/2)||(i.strokeStyle=s.borderColor,i.lineWidth=s.borderWidth,i.fillStyle=s.backgroundColor,ZR(i,s,this.x,this.y))}getRange(){const i=this.options||{};return i.radius+i.hitRadius}}xn(bE,"id","point"),xn(bE,"defaults",{borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0}),xn(bE,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});function LJ(n,e){const{x:i,y:o,base:s,width:l,height:d}=n.getProps(["x","y","base","width","height"],e);let p,f,y,_,x;return n.horizontal?(x=d/2,p=Math.min(i,s),f=Math.max(i,s),y=o-x,_=o+x):(x=l/2,p=i-x,f=i+x,y=Math.min(o,s),_=Math.max(o,s)),{left:p,top:y,right:f,bottom:_}}function af(n,e,i,o){return n?0:Uo(e,i,o)}function R5e(n,e,i){const o=n.options.borderWidth,s=n.borderSkipped,l=aJ(o);return{t:af(s.top,l.top,0,i),r:af(s.right,l.right,0,e),b:af(s.bottom,l.bottom,0,i),l:af(s.left,l.left,0,e)}}function k5e(n,e,i){const{enableBorderRadius:o}=n.getProps(["enableBorderRadius"]),s=n.options.borderRadius,l=Cg(s),d=Math.min(e,i),p=n.borderSkipped,f=o||Qi(s);return{topLeft:af(!f||p.top||p.left,l.topLeft,0,d),topRight:af(!f||p.top||p.right,l.topRight,0,d),bottomLeft:af(!f||p.bottom||p.left,l.bottomLeft,0,d),bottomRight:af(!f||p.bottom||p.right,l.bottomRight,0,d)}}function D5e(n){const e=LJ(n),i=e.right-e.left,o=e.bottom-e.top,s=R5e(n,i/2,o/2),l=k5e(n,i/2,o/2);return{outer:{x:e.left,y:e.top,w:i,h:o,radius:l},inner:{x:e.left+s.l,y:e.top+s.t,w:i-s.l-s.r,h:o-s.t-s.b,radius:{topLeft:Math.max(0,l.topLeft-Math.max(s.t,s.l)),topRight:Math.max(0,l.topRight-Math.max(s.t,s.r)),bottomLeft:Math.max(0,l.bottomLeft-Math.max(s.b,s.l)),bottomRight:Math.max(0,l.bottomRight-Math.max(s.b,s.r))}}}}function PI(n,e,i,o){const s=e===null,l=i===null,p=n&&!(s&&l)&&LJ(n,o);return p&&(s||kh(e,p.left,p.right))&&(l||kh(i,p.top,p.bottom))}function O5e(n){return n.topLeft||n.topRight||n.bottomLeft||n.bottomRight}function N5e(n,e){n.rect(e.x,e.y,e.w,e.h)}function II(n,e,i={}){const o=n.x!==i.x?-e:0,s=n.y!==i.y?-e:0,l=(n.x+n.w!==i.x+i.w?e:0)-o,d=(n.y+n.h!==i.y+i.h?e:0)-s;return{x:n.x+o,y:n.y+s,w:n.w+l,h:n.h+d,radius:n.radius}}class xE extends Xh{constructor(e){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,e&&Object.assign(this,e)}draw(e){const{inflateAmount:i,options:{borderColor:o,backgroundColor:s}}=this,{inner:l,outer:d}=D5e(this),p=O5e(d.radius)?Mw:N5e;e.save(),(d.w!==l.w||d.h!==l.h)&&(e.beginPath(),p(e,II(d,i,l)),e.clip(),p(e,II(l,-i,d)),e.fillStyle=o,e.fill("evenodd")),e.beginPath(),p(e,II(l,i)),e.fillStyle=s,e.fill(),e.restore()}inRange(e,i,o){return PI(this,e,i,o)}inXRange(e,i){return PI(this,e,null,i)}inYRange(e,i){return PI(this,null,e,i)}getCenterPoint(e){const{x:i,y:o,base:s,horizontal:l}=this.getProps(["x","y","base","horizontal"],e);return{x:l?(i+s)/2:i,y:l?o:(o+s)/2}}getRange(e){return e==="x"?this.width/2:this.height/2}}xn(xE,"id","bar"),xn(xE,"defaults",{borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0}),xn(xE,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});var z5e=Object.freeze({__proto__:null,ArcElement:$b,BarElement:xE,LineElement:nf,PointElement:bE});const tk=["rgb(54, 162, 235)","rgb(255, 99, 132)","rgb(255, 159, 64)","rgb(255, 205, 86)","rgb(75, 192, 192)","rgb(153, 102, 255)","rgb(201, 203, 207)"],SH=tk.map(n=>n.replace("rgb(","rgba(").replace(")",", 0.5)"));function RJ(n){return tk[n%tk.length]}function kJ(n){return SH[n%SH.length]}function F5e(n,e){return n.borderColor=RJ(e),n.backgroundColor=kJ(e),++e}function B5e(n,e){return n.backgroundColor=n.data.map(()=>RJ(e++)),e}function U5e(n,e){return n.backgroundColor=n.data.map(()=>kJ(e++)),e}function W5e(n){let e=0;return(i,o)=>{const s=n.getDatasetMeta(o).controller;s instanceof vg?e=B5e(i,e):s instanceof Mx?e=U5e(i,e):s&&(e=F5e(i,e))}}function AH(n){let e;for(e in n)if(n[e].borderColor||n[e].backgroundColor)return!0;return!1}function V5e(n){return n&&(n.borderColor||n.backgroundColor)}var G5e={id:"colors",defaults:{enabled:!0,forceOverride:!1},beforeLayout(n,e,i){if(!i.enabled)return;const{data:{datasets:o},options:s}=n.config,{elements:l}=s;if(!i.forceOverride&&(AH(o)||V5e(s)||l&&AH(l)))return;const d=W5e(n);o.forEach(d)}};function H5e(n,e,i,o,s){const l=s.samples||o;if(l>=i)return n.slice(e,e+i);const d=[],p=(i-2)/(l-2);let f=0;const y=e+i-1;let _=e,x,S,T,I,R;for(d[f++]=n[_],x=0;x<l-2;x++){let D=0,L=0,O;const N=Math.floor((x+1)*p)+1+e,F=Math.min(Math.floor((x+2)*p)+1,i)+e,G=F-N;for(O=N;O<F;O++)D+=n[O].x,L+=n[O].y;D/=G,L/=G;const j=Math.floor(x*p)+1+e,Y=Math.min(Math.floor((x+1)*p)+1,i)+e,{x:te,y:V}=n[_];for(T=I=-1,O=j;O<Y;O++)I=.5*Math.abs((te-D)*(n[O].y-V)-(te-n[O].x)*(L-V)),I>T&&(T=I,S=n[O],R=O);d[f++]=S,_=R}return d[f++]=n[y],d}function j5e(n,e,i,o){let s=0,l=0,d,p,f,y,_,x,S,T,I,R;const D=[],L=e+i-1,O=n[e].x,F=n[L].x-O;for(d=e;d<e+i;++d){p=n[d],f=(p.x-O)/F*o,y=p.y;const G=f|0;if(G===_)y<I?(I=y,x=d):y>R&&(R=y,S=d),s=(l*s+p.x)/++l;else{const j=d-1;if(!da(x)&&!da(S)){const Y=Math.min(x,S),te=Math.max(x,S);Y!==T&&Y!==j&&D.push({...n[Y],x:s}),te!==T&&te!==j&&D.push({...n[te],x:s})}d>0&&j!==T&&D.push(n[j]),D.push(p),_=G,l=0,I=R=y,x=S=T=d}}return D}function DJ(n){if(n._decimated){const e=n._data;delete n._decimated,delete n._data,Object.defineProperty(n,"data",{configurable:!0,enumerable:!0,writable:!0,value:e})}}function EH(n){n.data.datasets.forEach(e=>{DJ(e)})}function $5e(n,e){const i=e.length;let o=0,s;const{iScale:l}=n,{min:d,max:p,minDefined:f,maxDefined:y}=l.getUserBounds();return f&&(o=Uo(Dh(e,l.axis,d).lo,0,i-1)),y?s=Uo(Dh(e,l.axis,p).hi+1,o,i)-o:s=i-o,{start:o,count:s}}var Y5e={id:"decimation",defaults:{algorithm:"min-max",enabled:!1},beforeElementsUpdate:(n,e,i)=>{if(!i.enabled){EH(n);return}const o=n.width;n.data.datasets.forEach((s,l)=>{const{_data:d,indexAxis:p}=s,f=n.getDatasetMeta(l),y=d||s.data;if(Hb([p,n.options.indexAxis])==="y"||!f.controller.supportsDecimation)return;const _=n.scales[f.xAxisID];if(_.type!=="linear"&&_.type!=="time"||n.options.parsing)return;let{start:x,count:S}=$5e(f,y);const T=i.threshold||4*o;if(S<=T){DJ(s);return}da(d)&&(s._data=y,delete s.data,Object.defineProperty(s,"data",{configurable:!0,enumerable:!0,get:function(){return this._decimated},set:function(R){this._data=R}}));let I;switch(i.algorithm){case"lttb":I=H5e(y,x,S,o,i);break;case"min-max":I=j5e(y,x,S,o);break;default:throw new Error(`Unsupported decimation algorithm '${i.algorithm}'`)}s._decimated=I})},destroy(n){EH(n)}};function q5e(n,e,i){const o=n.segments,s=n.points,l=e.points,d=[];for(const p of o){let{start:f,end:y}=p;y=rO(f,y,s);const _=nk(i,s[f],s[y],p.loop);if(!e.segments){d.push({source:p,target:_,start:s[f],end:s[y]});continue}const x=gJ(e,_);for(const S of x){const T=nk(i,l[S.start],l[S.end],S.loop),I=mJ(p,s,T);for(const R of I)d.push({source:R,target:S,start:{[i]:MH(_,T,"start",Math.max)},end:{[i]:MH(_,T,"end",Math.min)}})}}return d}function nk(n,e,i,o){if(o)return;let s=e[n],l=i[n];return n==="angle"&&(s=Gl(s),l=Gl(l)),{property:n,start:s,end:l}}function X5e(n,e){const{x:i=null,y:o=null}=n||{},s=e.points,l=[];return e.segments.forEach(({start:d,end:p})=>{p=rO(d,p,s);const f=s[d],y=s[p];o!==null?(l.push({x:f.x,y:o}),l.push({x:y.x,y:o})):i!==null&&(l.push({x:i,y:f.y}),l.push({x:i,y:y.y}))}),l}function rO(n,e,i){for(;e>n;e--){const o=i[e];if(!isNaN(o.x)&&!isNaN(o.y))break}return e}function MH(n,e,i,o){return n&&e?o(n[i],e[i]):n?n[i]:e?e[i]:0}function OJ(n,e){let i=[],o=!1;return cr(n)?(o=!0,i=n):i=X5e(n,e),i.length?new nf({points:i,options:{tension:0},_loop:o,_fullLoop:o}):null}function TH(n){return n&&n.fill!==!1}function Z5e(n,e,i){let s=n[e].fill;const l=[e];let d;if(!i)return s;for(;s!==!1&&l.indexOf(s)===-1;){if(!Xr(s))return s;if(d=n[s],!d)return!1;if(d.visible)return s;l.push(s),s=d.fill}return!1}function K5e(n,e,i){const o=t4e(n);if(Qi(o))return isNaN(o.value)?!1:o;let s=parseFloat(o);return Xr(s)&&Math.floor(s)===s?J5e(o[0],e,s,i):["origin","start","end","stack","shape"].indexOf(o)>=0&&o}function J5e(n,e,i,o){return(n==="-"||n==="+")&&(i=e+i),i===e||i<0||i>=o?!1:i}function Q5e(n,e){let i=null;return n==="start"?i=e.bottom:n==="end"?i=e.top:Qi(n)?i=e.getPixelForValue(n.value):e.getBasePixel&&(i=e.getBasePixel()),i}function e4e(n,e,i){let o;return n==="start"?o=i:n==="end"?o=e.options.reverse?e.min:e.max:Qi(n)?o=n.value:o=e.getBaseValue(),o}function t4e(n){const e=n.options,i=e.fill;let o=Fi(i&&i.target,i);return o===void 0&&(o=!!e.backgroundColor),o===!1||o===null?!1:o===!0?"origin":o}function n4e(n){const{scale:e,index:i,line:o}=n,s=[],l=o.segments,d=o.points,p=i4e(e,i);p.push(OJ({x:null,y:e.bottom},o));for(let f=0;f<l.length;f++){const y=l[f];for(let _=y.start;_<=y.end;_++)a4e(s,d[_],p)}return new nf({points:s,options:{}})}function i4e(n,e){const i=[],o=n.getMatchingVisibleMetas("line");for(let s=0;s<o.length;s++){const l=o[s];if(l.index===e)break;l.hidden||i.unshift(l.dataset)}return i}function a4e(n,e,i){const o=[];for(let s=0;s<i.length;s++){const l=i[s],{first:d,last:p,point:f}=r4e(l,e,"x");if(!(!f||d&&p)){if(d)o.unshift(f);else if(n.push(f),!p)break}}n.push(...o)}function r4e(n,e,i){const o=n.interpolate(e,i);if(!o)return{};const s=o[i],l=n.segments,d=n.points;let p=!1,f=!1;for(let y=0;y<l.length;y++){const _=l[y],x=d[_.start][i],S=d[_.end][i];if(kh(s,x,S)){p=s===x,f=s===S;break}}return{first:p,last:f,point:o}}class NJ{constructor(e){this.x=e.x,this.y=e.y,this.radius=e.radius}pathSegment(e,i,o){const{x:s,y:l,radius:d}=this;return i=i||{start:0,end:dr},e.arc(s,l,d,i.end,i.start,!0),!o.bounds}interpolate(e){const{x:i,y:o,radius:s}=this,l=e.angle;return{x:i+Math.cos(l)*s,y:o+Math.sin(l)*s,angle:l}}}function o4e(n){const{chart:e,fill:i,line:o}=n;if(Xr(i))return s4e(e,i);if(i==="stack")return n4e(n);if(i==="shape")return!0;const s=l4e(n);return s instanceof NJ?s:OJ(s,o)}function s4e(n,e){const i=n.getDatasetMeta(e);return i&&n.isDatasetVisible(e)?i.dataset:null}function l4e(n){return(n.scale||{}).getPointPositionForValue?u4e(n):c4e(n)}function c4e(n){const{scale:e={},fill:i}=n,o=Q5e(i,e);if(Xr(o)){const s=e.isHorizontal();return{x:s?o:null,y:s?null:o}}return null}function u4e(n){const{scale:e,fill:i}=n,o=e.options,s=e.getLabels().length,l=o.reverse?e.max:e.min,d=e4e(i,e,l),p=[];if(o.grid.circular){const f=e.getPointPositionForValue(0,l);return new NJ({x:f.x,y:f.y,radius:e.getDistanceFromCenterForValue(d)})}for(let f=0;f<s;++f)p.push(e.getPointPositionForValue(f,d));return p}function LI(n,e,i){const o=o4e(e),{line:s,scale:l,axis:d}=e,p=s.options,f=p.fill,y=p.backgroundColor,{above:_=y,below:x=y}=f||{};o&&s.points.length&&(fC(n,i),d4e(n,{line:s,target:o,above:_,below:x,area:i,scale:l,axis:d}),mC(n))}function d4e(n,e){const{line:i,target:o,above:s,below:l,area:d,scale:p}=e,f=i._loop?"angle":e.axis;n.save(),f==="x"&&l!==s&&(CH(n,o,d.top),PH(n,{line:i,target:o,color:s,scale:p,property:f}),n.restore(),n.save(),CH(n,o,d.bottom)),PH(n,{line:i,target:o,color:l,scale:p,property:f}),n.restore()}function CH(n,e,i){const{segments:o,points:s}=e;let l=!0,d=!1;n.beginPath();for(const p of o){const{start:f,end:y}=p,_=s[f],x=s[rO(f,y,s)];l?(n.moveTo(_.x,_.y),l=!1):(n.lineTo(_.x,i),n.lineTo(_.x,_.y)),d=!!e.pathSegment(n,p,{move:d}),d?n.closePath():n.lineTo(x.x,i)}n.lineTo(e.first().x,i),n.closePath(),n.clip()}function PH(n,e){const{line:i,target:o,property:s,color:l,scale:d}=e,p=q5e(i,o,s);for(const{source:f,target:y,start:_,end:x}of p){const{style:{backgroundColor:S=l}={}}=f,T=o!==!0;n.save(),n.fillStyle=S,h4e(n,d,T&&nk(s,_,x)),n.beginPath();const I=!!i.pathSegment(n,f);let R;if(T){I?n.closePath():IH(n,o,x,s);const D=!!o.pathSegment(n,y,{move:I,reverse:!0});R=I&&D,R||IH(n,o,_,s)}n.closePath(),n.fill(R?"evenodd":"nonzero"),n.restore()}}function h4e(n,e,i){const{top:o,bottom:s}=e.chart.chartArea,{property:l,start:d,end:p}=i||{};l==="x"&&(n.beginPath(),n.rect(d,o,p-d,s-o),n.clip())}function IH(n,e,i,o){const s=e.interpolate(i,o);s&&n.lineTo(s.x,s.y)}var p4e={id:"filler",afterDatasetsUpdate(n,e,i){const o=(n.data.datasets||[]).length,s=[];let l,d,p,f;for(d=0;d<o;++d)l=n.getDatasetMeta(d),p=l.dataset,f=null,p&&p.options&&p instanceof nf&&(f={visible:n.isDatasetVisible(d),index:d,fill:K5e(p,d,o),chart:n,axis:l.controller.options.indexAxis,scale:l.vScale,line:p}),l.$filler=f,s.push(f);for(d=0;d<o;++d)f=s[d],!(!f||f.fill===!1)&&(f.fill=Z5e(s,d,i.propagate))},beforeDraw(n,e,i){const o=i.drawTime==="beforeDraw",s=n.getSortedVisibleDatasetMetas(),l=n.chartArea;for(let d=s.length-1;d>=0;--d){const p=s[d].$filler;p&&(p.line.updateControlPoints(l,p.axis),o&&p.fill&&LI(n.ctx,p,l))}},beforeDatasetsDraw(n,e,i){if(i.drawTime!=="beforeDatasetsDraw")return;const o=n.getSortedVisibleDatasetMetas();for(let s=o.length-1;s>=0;--s){const l=o[s].$filler;TH(l)&&LI(n.ctx,l,n.chartArea)}},beforeDatasetDraw(n,e,i){const o=e.meta.$filler;!TH(o)||i.drawTime!=="beforeDatasetDraw"||LI(n.ctx,o,n.chartArea)},defaults:{propagate:!0,drawTime:"beforeDatasetDraw"}};const LH=(n,e)=>{let{boxHeight:i=e,boxWidth:o=e}=n;return n.usePointStyle&&(i=Math.min(i,e),o=n.pointStyleWidth||Math.min(o,e)),{boxWidth:o,boxHeight:i,itemHeight:Math.max(e,i)}},f4e=(n,e)=>n!==null&&e!==null&&n.datasetIndex===e.datasetIndex&&n.index===e.index;class RH extends Xh{constructor(e){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,i,o){this.maxWidth=e,this.maxHeight=i,this._margins=o,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const e=this.options.labels||{};let i=nr(e.generateLabels,[this.chart],this)||[];e.filter&&(i=i.filter(o=>e.filter(o,this.chart.data))),e.sort&&(i=i.sort((o,s)=>e.sort(o,s,this.chart.data))),this.options.reverse&&i.reverse(),this.legendItems=i}fit(){const{options:e,ctx:i}=this;if(!e.display){this.width=this.height=0;return}const o=e.labels,s=Ro(o.font),l=s.size,d=this._computeTitleHeight(),{boxWidth:p,itemHeight:f}=LH(o,l);let y,_;i.font=s.string,this.isHorizontal()?(y=this.maxWidth,_=this._fitRows(d,l,p,f)+10):(_=this.maxHeight,y=this._fitCols(d,s,p,f)+10),this.width=Math.min(y,e.maxWidth||this.maxWidth),this.height=Math.min(_,e.maxHeight||this.maxHeight)}_fitRows(e,i,o,s){const{ctx:l,maxWidth:d,options:{labels:{padding:p}}}=this,f=this.legendHitBoxes=[],y=this.lineWidths=[0],_=s+p;let x=e;l.textAlign="left",l.textBaseline="middle";let S=-1,T=-_;return this.legendItems.forEach((I,R)=>{const D=o+i/2+l.measureText(I.text).width;(R===0||y[y.length-1]+D+2*p>d)&&(x+=_,y[y.length-(R>0?0:1)]=0,T+=_,S++),f[R]={left:0,top:T,row:S,width:D,height:s},y[y.length-1]+=D+p}),x}_fitCols(e,i,o,s){const{ctx:l,maxHeight:d,options:{labels:{padding:p}}}=this,f=this.legendHitBoxes=[],y=this.columnSizes=[],_=d-e;let x=p,S=0,T=0,I=0,R=0;return this.legendItems.forEach((D,L)=>{const{itemWidth:O,itemHeight:N}=m4e(o,i,l,D,s);L>0&&T+N+2*p>_&&(x+=S+p,y.push({width:S,height:T}),I+=S+p,R++,S=T=0),f[L]={left:I,top:T,col:R,width:O,height:N},S=Math.max(S,O),T+=N+p}),x+=S,y.push({width:S,height:T}),x}adjustHitBoxes(){if(!this.options.display)return;const e=this._computeTitleHeight(),{legendHitBoxes:i,options:{align:o,labels:{padding:s},rtl:l}}=this,d=j0(l,this.left,this.width);if(this.isHorizontal()){let p=0,f=ys(o,this.left+s,this.right-this.lineWidths[p]);for(const y of i)p!==y.row&&(p=y.row,f=ys(o,this.left+s,this.right-this.lineWidths[p])),y.top+=this.top+e+s,y.left=d.leftForLtr(d.x(f),y.width),f+=y.width+s}else{let p=0,f=ys(o,this.top+e+s,this.bottom-this.columnSizes[p].height);for(const y of i)y.col!==p&&(p=y.col,f=ys(o,this.top+e+s,this.bottom-this.columnSizes[p].height)),y.top=f,y.left+=this.left+s,y.left=d.leftForLtr(d.x(y.left),y.width),f+=y.height+s}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){const e=this.ctx;fC(e,this),this._draw(),mC(e)}}_draw(){const{options:e,columnSizes:i,lineWidths:o,ctx:s}=this,{align:l,labels:d}=e,p=Zr.color,f=j0(e.rtl,this.left,this.width),y=Ro(d.font),{padding:_}=d,x=y.size,S=x/2;let T;this.drawTitle(),s.textAlign=f.textAlign("left"),s.textBaseline="middle",s.lineWidth=.5,s.font=y.string;const{boxWidth:I,boxHeight:R,itemHeight:D}=LH(d,x),L=function(j,Y,te){if(isNaN(I)||I<=0||isNaN(R)||R<0)return;s.save();const V=Fi(te.lineWidth,1);if(s.fillStyle=Fi(te.fillStyle,p),s.lineCap=Fi(te.lineCap,"butt"),s.lineDashOffset=Fi(te.lineDashOffset,0),s.lineJoin=Fi(te.lineJoin,"miter"),s.lineWidth=V,s.strokeStyle=Fi(te.strokeStyle,p),s.setLineDash(Fi(te.lineDash,[])),d.usePointStyle){const Q={radius:R*Math.SQRT2/2,pointStyle:te.pointStyle,rotation:te.rotation,borderWidth:V},he=f.xPlus(j,I/2),fe=Y+S;iJ(s,Q,he,fe,d.pointStyleWidth&&I)}else{const Q=Y+Math.max((x-R)/2,0),he=f.leftForLtr(j,I),fe=Cg(te.borderRadius);s.beginPath(),Object.values(fe).some(ye=>ye!==0)?Mw(s,{x:he,y:Q,w:I,h:R,radius:fe}):s.rect(he,Q,I,R),s.fill(),V!==0&&s.stroke()}s.restore()},O=function(j,Y,te){jg(s,te.text,j,Y+D/2,y,{strikethrough:te.hidden,textAlign:f.textAlign(te.textAlign)})},N=this.isHorizontal(),F=this._computeTitleHeight();N?T={x:ys(l,this.left+_,this.right-o[0]),y:this.top+_+F,line:0}:T={x:this.left+_,y:ys(l,this.top+F+_,this.bottom-i[0].height),line:0},hJ(this.ctx,e.textDirection);const G=D+_;this.legendItems.forEach((j,Y)=>{s.strokeStyle=j.fontColor,s.fillStyle=j.fontColor;const te=s.measureText(j.text).width,V=f.textAlign(j.textAlign||(j.textAlign=d.textAlign)),Q=I+S+te;let he=T.x,fe=T.y;f.setWidth(this.width),N?Y>0&&he+Q+_>this.right&&(fe=T.y+=G,T.line++,he=T.x=ys(l,this.left+_,this.right-o[T.line])):Y>0&&fe+G>this.bottom&&(he=T.x=he+i[T.line].width+_,T.line++,fe=T.y=ys(l,this.top+F+_,this.bottom-i[T.line].height));const ye=f.x(he);if(L(ye,fe,j),he=NTe(V,he+I+S,N?he+Q:this.right,e.rtl),O(f.x(he),fe,j),N)T.x+=Q+_;else if(typeof j.text!="string"){const pe=y.lineHeight;T.y+=zJ(j,pe)+_}else T.y+=G}),pJ(this.ctx,e.textDirection)}drawTitle(){const e=this.options,i=e.title,o=Ro(i.font),s=Ms(i.padding);if(!i.display)return;const l=j0(e.rtl,this.left,this.width),d=this.ctx,p=i.position,f=o.size/2,y=s.top+f;let _,x=this.left,S=this.width;if(this.isHorizontal())S=Math.max(...this.lineWidths),_=this.top+y,x=ys(e.align,x,this.right-S);else{const I=this.columnSizes.reduce((R,D)=>Math.max(R,D.height),0);_=y+ys(e.align,this.top,this.bottom-I-e.labels.padding-this._computeTitleHeight())}const T=ys(p,x,x+S);d.textAlign=l.textAlign(K6(p)),d.textBaseline="middle",d.strokeStyle=i.color,d.fillStyle=i.color,d.font=o.string,jg(d,i.text,T,_,o)}_computeTitleHeight(){const e=this.options.title,i=Ro(e.font),o=Ms(e.padding);return e.display?i.lineHeight+o.height:0}_getLegendItemAt(e,i){let o,s,l;if(kh(e,this.left,this.right)&&kh(i,this.top,this.bottom)){for(l=this.legendHitBoxes,o=0;o<l.length;++o)if(s=l[o],kh(e,s.left,s.left+s.width)&&kh(i,s.top,s.top+s.height))return this.legendItems[o]}return null}handleEvent(e){const i=this.options;if(!v4e(e.type,i))return;const o=this._getLegendItemAt(e.x,e.y);if(e.type==="mousemove"||e.type==="mouseout"){const s=this._hoveredItem,l=f4e(s,o);s&&!l&&nr(i.onLeave,[e,s,this],this),this._hoveredItem=o,o&&!l&&nr(i.onHover,[e,o,this],this)}else o&&nr(i.onClick,[e,o,this],this)}}function m4e(n,e,i,o,s){const l=g4e(o,n,e,i),d=y4e(s,o,e.lineHeight);return{itemWidth:l,itemHeight:d}}function g4e(n,e,i,o){let s=n.text;return s&&typeof s!="string"&&(s=s.reduce((l,d)=>l.length>d.length?l:d)),e+i.size/2+o.measureText(s).width}function y4e(n,e,i){let o=n;return typeof e.text!="string"&&(o=zJ(e,i)),o}function zJ(n,e){const i=n.text?n.text.length:0;return e*i}function v4e(n,e){return!!((n==="mousemove"||n==="mouseout")&&(e.onHover||e.onLeave)||e.onClick&&(n==="click"||n==="mouseup"))}var _4e={id:"legend",_element:RH,start(n,e,i){const o=n.legend=new RH({ctx:n.ctx,options:i,chart:n});xs.configure(n,o,i),xs.addBox(n,o)},stop(n){xs.removeBox(n,n.legend),delete n.legend},beforeUpdate(n,e,i){const o=n.legend;xs.configure(n,o,i),o.options=i},afterUpdate(n){const e=n.legend;e.buildLabels(),e.adjustHitBoxes()},afterEvent(n,e){e.replay||n.legend.handleEvent(e.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(n,e,i){const o=e.datasetIndex,s=i.chart;s.isDatasetVisible(o)?(s.hide(o),e.hidden=!0):(s.show(o),e.hidden=!1)},onHover:null,onLeave:null,labels:{color:n=>n.chart.options.color,boxWidth:40,padding:10,generateLabels(n){const e=n.data.datasets,{labels:{usePointStyle:i,pointStyle:o,textAlign:s,color:l,useBorderRadius:d,borderRadius:p}}=n.legend.options;return n._getSortedDatasetMetas().map(f=>{const y=f.controller.getStyle(i?0:void 0),_=Ms(y.borderWidth);return{text:e[f.index].label,fillStyle:y.backgroundColor,fontColor:l,hidden:!f.visible,lineCap:y.borderCapStyle,lineDash:y.borderDash,lineDashOffset:y.borderDashOffset,lineJoin:y.borderJoinStyle,lineWidth:(_.width+_.height)/4,strokeStyle:y.borderColor,pointStyle:o||y.pointStyle,rotation:y.rotation,textAlign:s||y.textAlign,borderRadius:d&&(p||y.borderRadius),datasetIndex:f.index}},this)}},title:{color:n=>n.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:n=>!n.startsWith("on"),labels:{_scriptable:n=>!["generateLabels","filter","sort"].includes(n)}}};let oO=class extends Xh{constructor(e){super(),this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,i){const o=this.options;if(this.left=0,this.top=0,!o.display){this.width=this.height=this.right=this.bottom=0;return}this.width=this.right=e,this.height=this.bottom=i;const s=cr(o.text)?o.text.length:1;this._padding=Ms(o.padding);const l=s*Ro(o.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=l:this.width=l}isHorizontal(){const e=this.options.position;return e==="top"||e==="bottom"}_drawArgs(e){const{top:i,left:o,bottom:s,right:l,options:d}=this,p=d.align;let f=0,y,_,x;return this.isHorizontal()?(_=ys(p,o,l),x=i+e,y=l-o):(d.position==="left"?(_=o+e,x=ys(p,s,i),f=hr*-.5):(_=l-e,x=ys(p,i,s),f=hr*.5),y=s-i),{titleX:_,titleY:x,maxWidth:y,rotation:f}}draw(){const e=this.ctx,i=this.options;if(!i.display)return;const o=Ro(i.font),l=o.lineHeight/2+this._padding.top,{titleX:d,titleY:p,maxWidth:f,rotation:y}=this._drawArgs(l);jg(e,i.text,0,0,o,{color:i.color,maxWidth:f,rotation:y,textAlign:K6(i.align),textBaseline:"middle",translation:[d,p]})}};function b4e(n,e){const i=new oO({ctx:n.ctx,options:e,chart:n});xs.configure(n,i,e),xs.addBox(n,i),n.titleBlock=i}var x4e={id:"title",_element:oO,start(n,e,i){b4e(n,i)},stop(n){const e=n.titleBlock;xs.removeBox(n,e),delete n.titleBlock},beforeUpdate(n,e,i){const o=n.titleBlock;xs.configure(n,o,i),o.options=i},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const IA=new WeakMap;var w4e={id:"subtitle",start(n,e,i){const o=new oO({ctx:n.ctx,options:i,chart:n});xs.configure(n,o,i),xs.addBox(n,o),IA.set(n,o)},stop(n){xs.removeBox(n,IA.get(n)),IA.delete(n)},beforeUpdate(n,e,i){const o=IA.get(n);xs.configure(n,o,i),o.options=i},defaults:{align:"center",display:!1,font:{weight:"normal"},fullSize:!0,padding:0,position:"top",text:"",weight:1500},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const Yb={average(n){if(!n.length)return!1;let e,i,o=0,s=0,l=0;for(e=0,i=n.length;e<i;++e){const d=n[e].element;if(d&&d.hasValue()){const p=d.tooltipPosition();o+=p.x,s+=p.y,++l}}return{x:o/l,y:s/l}},nearest(n,e){if(!n.length)return!1;let i=e.x,o=e.y,s=Number.POSITIVE_INFINITY,l,d,p;for(l=0,d=n.length;l<d;++l){const f=n[l].element;if(f&&f.hasValue()){const y=f.getCenterPoint(),_=qR(e,y);_<s&&(s=_,p=f)}}if(p){const f=p.tooltipPosition();i=f.x,o=f.y}return{x:i,y:o}}};function id(n,e){return e&&(cr(e)?Array.prototype.push.apply(n,e):n.push(e)),n}function xh(n){return(typeof n=="string"||n instanceof String)&&n.indexOf(`
`)>-1?n.split(`
`):n}function S4e(n,e){const{element:i,datasetIndex:o,index:s}=e,l=n.getDatasetMeta(o).controller,{label:d,value:p}=l.getLabelAndValue(s);return{chart:n,label:d,parsed:l.getParsed(s),raw:n.data.datasets[o].data[s],formattedValue:p,dataset:l.getDataset(),dataIndex:s,datasetIndex:o,element:i}}function kH(n,e){const i=n.chart.ctx,{body:o,footer:s,title:l}=n,{boxWidth:d,boxHeight:p}=e,f=Ro(e.bodyFont),y=Ro(e.titleFont),_=Ro(e.footerFont),x=l.length,S=s.length,T=o.length,I=Ms(e.padding);let R=I.height,D=0,L=o.reduce((F,G)=>F+G.before.length+G.lines.length+G.after.length,0);if(L+=n.beforeBody.length+n.afterBody.length,x&&(R+=x*y.lineHeight+(x-1)*e.titleSpacing+e.titleMarginBottom),L){const F=e.displayColors?Math.max(p,f.lineHeight):f.lineHeight;R+=T*F+(L-T)*f.lineHeight+(L-1)*e.bodySpacing}S&&(R+=e.footerMarginTop+S*_.lineHeight+(S-1)*e.footerSpacing);let O=0;const N=function(F){D=Math.max(D,i.measureText(F).width+O)};return i.save(),i.font=y.string,Ua(n.title,N),i.font=f.string,Ua(n.beforeBody.concat(n.afterBody),N),O=e.displayColors?d+2+e.boxPadding:0,Ua(o,F=>{Ua(F.before,N),Ua(F.lines,N),Ua(F.after,N)}),O=0,i.font=_.string,Ua(n.footer,N),i.restore(),D+=I.width,{width:D,height:R}}function A4e(n,e){const{y:i,height:o}=e;return i<o/2?"top":i>n.height-o/2?"bottom":"center"}function E4e(n,e,i,o){const{x:s,width:l}=o,d=i.caretSize+i.caretPadding;if(n==="left"&&s+l+d>e.width||n==="right"&&s-l-d<0)return!0}function M4e(n,e,i,o){const{x:s,width:l}=i,{width:d,chartArea:{left:p,right:f}}=n;let y="center";return o==="center"?y=s<=(p+f)/2?"left":"right":s<=l/2?y="left":s>=d-l/2&&(y="right"),E4e(y,n,e,i)&&(y="center"),y}function DH(n,e,i){const o=i.yAlign||e.yAlign||A4e(n,i);return{xAlign:i.xAlign||e.xAlign||M4e(n,e,i,o),yAlign:o}}function T4e(n,e){let{x:i,width:o}=n;return e==="right"?i-=o:e==="center"&&(i-=o/2),i}function C4e(n,e,i){let{y:o,height:s}=n;return e==="top"?o+=i:e==="bottom"?o-=s+i:o-=s/2,o}function OH(n,e,i,o){const{caretSize:s,caretPadding:l,cornerRadius:d}=n,{xAlign:p,yAlign:f}=i,y=s+l,{topLeft:_,topRight:x,bottomLeft:S,bottomRight:T}=Cg(d);let I=T4e(e,p);const R=C4e(e,f,y);return f==="center"?p==="left"?I+=y:p==="right"&&(I-=y):p==="left"?I-=Math.max(_,S)+s:p==="right"&&(I+=Math.max(x,T)+s),{x:Uo(I,0,o.width-e.width),y:Uo(R,0,o.height-e.height)}}function LA(n,e,i){const o=Ms(i.padding);return e==="center"?n.x+n.width/2:e==="right"?n.x+n.width-o.right:n.x+o.left}function NH(n){return id([],xh(n))}function P4e(n,e,i){return Of(n,{tooltip:e,tooltipItems:i,type:"tooltip"})}function zH(n,e){const i=e&&e.dataset&&e.dataset.tooltip&&e.dataset.tooltip.callbacks;return i?n.override(i):n}const FJ={beforeTitle:vh,title(n){if(n.length>0){const e=n[0],i=e.chart.data.labels,o=i?i.length:0;if(this&&this.options&&this.options.mode==="dataset")return e.dataset.label||"";if(e.label)return e.label;if(o>0&&e.dataIndex<o)return i[e.dataIndex]}return""},afterTitle:vh,beforeBody:vh,beforeLabel:vh,label(n){if(this&&this.options&&this.options.mode==="dataset")return n.label+": "+n.formattedValue||n.formattedValue;let e=n.dataset.label||"";e&&(e+=": ");const i=n.formattedValue;return da(i)||(e+=i),e},labelColor(n){const i=n.chart.getDatasetMeta(n.datasetIndex).controller.getStyle(n.dataIndex);return{borderColor:i.borderColor,backgroundColor:i.backgroundColor,borderWidth:i.borderWidth,borderDash:i.borderDash,borderDashOffset:i.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(n){const i=n.chart.getDatasetMeta(n.datasetIndex).controller.getStyle(n.dataIndex);return{pointStyle:i.pointStyle,rotation:i.rotation}},afterLabel:vh,afterBody:vh,beforeFooter:vh,footer:vh,afterFooter:vh};function dl(n,e,i,o){const s=n[e].call(i,o);return typeof s>"u"?FJ[e].call(i,o):s}class ik extends Xh{constructor(e){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=e.chart,this.options=e.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(e){this.options=e,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const e=this._cachedAnimations;if(e)return e;const i=this.chart,o=this.options.setContext(this.getContext()),s=o.enabled&&i.options.animation&&o.animations,l=new yJ(this.chart,s);return s._cacheable&&(this._cachedAnimations=Object.freeze(l)),l}getContext(){return this.$context||(this.$context=P4e(this.chart.getContext(),this,this._tooltipItems))}getTitle(e,i){const{callbacks:o}=i,s=dl(o,"beforeTitle",this,e),l=dl(o,"title",this,e),d=dl(o,"afterTitle",this,e);let p=[];return p=id(p,xh(s)),p=id(p,xh(l)),p=id(p,xh(d)),p}getBeforeBody(e,i){return NH(dl(i.callbacks,"beforeBody",this,e))}getBody(e,i){const{callbacks:o}=i,s=[];return Ua(e,l=>{const d={before:[],lines:[],after:[]},p=zH(o,l);id(d.before,xh(dl(p,"beforeLabel",this,l))),id(d.lines,dl(p,"label",this,l)),id(d.after,xh(dl(p,"afterLabel",this,l))),s.push(d)}),s}getAfterBody(e,i){return NH(dl(i.callbacks,"afterBody",this,e))}getFooter(e,i){const{callbacks:o}=i,s=dl(o,"beforeFooter",this,e),l=dl(o,"footer",this,e),d=dl(o,"afterFooter",this,e);let p=[];return p=id(p,xh(s)),p=id(p,xh(l)),p=id(p,xh(d)),p}_createItems(e){const i=this._active,o=this.chart.data,s=[],l=[],d=[];let p=[],f,y;for(f=0,y=i.length;f<y;++f)p.push(S4e(this.chart,i[f]));return e.filter&&(p=p.filter((_,x,S)=>e.filter(_,x,S,o))),e.itemSort&&(p=p.sort((_,x)=>e.itemSort(_,x,o))),Ua(p,_=>{const x=zH(e.callbacks,_);s.push(dl(x,"labelColor",this,_)),l.push(dl(x,"labelPointStyle",this,_)),d.push(dl(x,"labelTextColor",this,_))}),this.labelColors=s,this.labelPointStyles=l,this.labelTextColors=d,this.dataPoints=p,p}update(e,i){const o=this.options.setContext(this.getContext()),s=this._active;let l,d=[];if(!s.length)this.opacity!==0&&(l={opacity:0});else{const p=Yb[o.position].call(this,s,this._eventPosition);d=this._createItems(o),this.title=this.getTitle(d,o),this.beforeBody=this.getBeforeBody(d,o),this.body=this.getBody(d,o),this.afterBody=this.getAfterBody(d,o),this.footer=this.getFooter(d,o);const f=this._size=kH(this,o),y=Object.assign({},p,f),_=DH(this.chart,o,y),x=OH(o,y,_,this.chart);this.xAlign=_.xAlign,this.yAlign=_.yAlign,l={opacity:1,x:x.x,y:x.y,width:f.width,height:f.height,caretX:p.x,caretY:p.y}}this._tooltipItems=d,this.$context=void 0,l&&this._resolveAnimations().update(this,l),e&&o.external&&o.external.call(this,{chart:this.chart,tooltip:this,replay:i})}drawCaret(e,i,o,s){const l=this.getCaretPosition(e,o,s);i.lineTo(l.x1,l.y1),i.lineTo(l.x2,l.y2),i.lineTo(l.x3,l.y3)}getCaretPosition(e,i,o){const{xAlign:s,yAlign:l}=this,{caretSize:d,cornerRadius:p}=o,{topLeft:f,topRight:y,bottomLeft:_,bottomRight:x}=Cg(p),{x:S,y:T}=e,{width:I,height:R}=i;let D,L,O,N,F,G;return l==="center"?(F=T+R/2,s==="left"?(D=S,L=D-d,N=F+d,G=F-d):(D=S+I,L=D+d,N=F-d,G=F+d),O=D):(s==="left"?L=S+Math.max(f,_)+d:s==="right"?L=S+I-Math.max(y,x)-d:L=this.caretX,l==="top"?(N=T,F=N-d,D=L-d,O=L+d):(N=T+R,F=N+d,D=L+d,O=L-d),G=N),{x1:D,x2:L,x3:O,y1:N,y2:F,y3:G}}drawTitle(e,i,o){const s=this.title,l=s.length;let d,p,f;if(l){const y=j0(o.rtl,this.x,this.width);for(e.x=LA(this,o.titleAlign,o),i.textAlign=y.textAlign(o.titleAlign),i.textBaseline="middle",d=Ro(o.titleFont),p=o.titleSpacing,i.fillStyle=o.titleColor,i.font=d.string,f=0;f<l;++f)i.fillText(s[f],y.x(e.x),e.y+d.lineHeight/2),e.y+=d.lineHeight+p,f+1===l&&(e.y+=o.titleMarginBottom-p)}}_drawColorBox(e,i,o,s,l){const d=this.labelColors[o],p=this.labelPointStyles[o],{boxHeight:f,boxWidth:y}=l,_=Ro(l.bodyFont),x=LA(this,"left",l),S=s.x(x),T=f<_.lineHeight?(_.lineHeight-f)/2:0,I=i.y+T;if(l.usePointStyle){const R={radius:Math.min(y,f)/2,pointStyle:p.pointStyle,rotation:p.rotation,borderWidth:1},D=s.leftForLtr(S,y)+y/2,L=I+f/2;e.strokeStyle=l.multiKeyBackground,e.fillStyle=l.multiKeyBackground,ZR(e,R,D,L),e.strokeStyle=d.borderColor,e.fillStyle=d.backgroundColor,ZR(e,R,D,L)}else{e.lineWidth=Qi(d.borderWidth)?Math.max(...Object.values(d.borderWidth)):d.borderWidth||1,e.strokeStyle=d.borderColor,e.setLineDash(d.borderDash||[]),e.lineDashOffset=d.borderDashOffset||0;const R=s.leftForLtr(S,y),D=s.leftForLtr(s.xPlus(S,1),y-2),L=Cg(d.borderRadius);Object.values(L).some(O=>O!==0)?(e.beginPath(),e.fillStyle=l.multiKeyBackground,Mw(e,{x:R,y:I,w:y,h:f,radius:L}),e.fill(),e.stroke(),e.fillStyle=d.backgroundColor,e.beginPath(),Mw(e,{x:D,y:I+1,w:y-2,h:f-2,radius:L}),e.fill()):(e.fillStyle=l.multiKeyBackground,e.fillRect(R,I,y,f),e.strokeRect(R,I,y,f),e.fillStyle=d.backgroundColor,e.fillRect(D,I+1,y-2,f-2))}e.fillStyle=this.labelTextColors[o]}drawBody(e,i,o){const{body:s}=this,{bodySpacing:l,bodyAlign:d,displayColors:p,boxHeight:f,boxWidth:y,boxPadding:_}=o,x=Ro(o.bodyFont);let S=x.lineHeight,T=0;const I=j0(o.rtl,this.x,this.width),R=function(te){i.fillText(te,I.x(e.x+T),e.y+S/2),e.y+=S+l},D=I.textAlign(d);let L,O,N,F,G,j,Y;for(i.textAlign=d,i.textBaseline="middle",i.font=x.string,e.x=LA(this,D,o),i.fillStyle=o.bodyColor,Ua(this.beforeBody,R),T=p&&D!=="right"?d==="center"?y/2+_:y+2+_:0,F=0,j=s.length;F<j;++F){for(L=s[F],O=this.labelTextColors[F],i.fillStyle=O,Ua(L.before,R),N=L.lines,p&&N.length&&(this._drawColorBox(i,e,F,I,o),S=Math.max(x.lineHeight,f)),G=0,Y=N.length;G<Y;++G)R(N[G]),S=x.lineHeight;Ua(L.after,R)}T=0,S=x.lineHeight,Ua(this.afterBody,R),e.y-=l}drawFooter(e,i,o){const s=this.footer,l=s.length;let d,p;if(l){const f=j0(o.rtl,this.x,this.width);for(e.x=LA(this,o.footerAlign,o),e.y+=o.footerMarginTop,i.textAlign=f.textAlign(o.footerAlign),i.textBaseline="middle",d=Ro(o.footerFont),i.fillStyle=o.footerColor,i.font=d.string,p=0;p<l;++p)i.fillText(s[p],f.x(e.x),e.y+d.lineHeight/2),e.y+=d.lineHeight+o.footerSpacing}}drawBackground(e,i,o,s){const{xAlign:l,yAlign:d}=this,{x:p,y:f}=e,{width:y,height:_}=o,{topLeft:x,topRight:S,bottomLeft:T,bottomRight:I}=Cg(s.cornerRadius);i.fillStyle=s.backgroundColor,i.strokeStyle=s.borderColor,i.lineWidth=s.borderWidth,i.beginPath(),i.moveTo(p+x,f),d==="top"&&this.drawCaret(e,i,o,s),i.lineTo(p+y-S,f),i.quadraticCurveTo(p+y,f,p+y,f+S),d==="center"&&l==="right"&&this.drawCaret(e,i,o,s),i.lineTo(p+y,f+_-I),i.quadraticCurveTo(p+y,f+_,p+y-I,f+_),d==="bottom"&&this.drawCaret(e,i,o,s),i.lineTo(p+T,f+_),i.quadraticCurveTo(p,f+_,p,f+_-T),d==="center"&&l==="left"&&this.drawCaret(e,i,o,s),i.lineTo(p,f+x),i.quadraticCurveTo(p,f,p+x,f),i.closePath(),i.fill(),s.borderWidth>0&&i.stroke()}_updateAnimationTarget(e){const i=this.chart,o=this.$animations,s=o&&o.x,l=o&&o.y;if(s||l){const d=Yb[e.position].call(this,this._active,this._eventPosition);if(!d)return;const p=this._size=kH(this,e),f=Object.assign({},d,this._size),y=DH(i,e,f),_=OH(e,f,y,i);(s._to!==_.x||l._to!==_.y)&&(this.xAlign=y.xAlign,this.yAlign=y.yAlign,this.width=p.width,this.height=p.height,this.caretX=d.x,this.caretY=d.y,this._resolveAnimations().update(this,_))}}_willRender(){return!!this.opacity}draw(e){const i=this.options.setContext(this.getContext());let o=this.opacity;if(!o)return;this._updateAnimationTarget(i);const s={width:this.width,height:this.height},l={x:this.x,y:this.y};o=Math.abs(o)<.001?0:o;const d=Ms(i.padding),p=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;i.enabled&&p&&(e.save(),e.globalAlpha=o,this.drawBackground(l,e,s,i),hJ(e,i.textDirection),l.y+=d.top,this.drawTitle(l,e,i),this.drawBody(l,e,i),this.drawFooter(l,e,i),pJ(e,i.textDirection),e.restore())}getActiveElements(){return this._active||[]}setActiveElements(e,i){const o=this._active,s=e.map(({datasetIndex:p,index:f})=>{const y=this.chart.getDatasetMeta(p);if(!y)throw new Error("Cannot find a dataset at index "+p);return{datasetIndex:p,element:y.data[f],index:f}}),l=!mM(o,s),d=this._positionChanged(s,i);(l||d)&&(this._active=s,this._eventPosition=i,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(e,i,o=!0){if(i&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const s=this.options,l=this._active||[],d=this._getActiveElements(e,l,i,o),p=this._positionChanged(d,e),f=i||!mM(d,l)||p;return f&&(this._active=d,(s.enabled||s.external)&&(this._eventPosition={x:e.x,y:e.y},this.update(!0,i))),f}_getActiveElements(e,i,o,s){const l=this.options;if(e.type==="mouseout")return[];if(!s)return i;const d=this.chart.getElementsAtEventForMode(e,l.mode,l,o);return l.reverse&&d.reverse(),d}_positionChanged(e,i){const{caretX:o,caretY:s,options:l}=this,d=Yb[l.position].call(this,e,i);return d!==!1&&(o!==d.x||s!==d.y)}}xn(ik,"positioners",Yb);var I4e={id:"tooltip",_element:ik,positioners:Yb,afterInit(n,e,i){i&&(n.tooltip=new ik({chart:n,options:i}))},beforeUpdate(n,e,i){n.tooltip&&n.tooltip.initialize(i)},reset(n,e,i){n.tooltip&&n.tooltip.initialize(i)},afterDraw(n){const e=n.tooltip;if(e&&e._willRender()){const i={tooltip:e};if(n.notifyPlugins("beforeTooltipDraw",{...i,cancelable:!0})===!1)return;e.draw(n.ctx),n.notifyPlugins("afterTooltipDraw",i)}},afterEvent(n,e){if(n.tooltip){const i=e.replay;n.tooltip.handleEvent(e.event,i,e.inChartArea)&&(e.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(n,e)=>e.bodyFont.size,boxWidth:(n,e)=>e.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:FJ},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:n=>n!=="filter"&&n!=="itemSort"&&n!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]},L4e=Object.freeze({__proto__:null,Colors:G5e,Decimation:Y5e,Filler:p4e,Legend:_4e,SubTitle:w4e,Title:x4e,Tooltip:I4e});const R4e=(n,e,i,o)=>(typeof e=="string"?(i=n.push(e)-1,o.unshift({index:i,label:e})):isNaN(e)&&(i=null),i);function k4e(n,e,i,o){const s=n.indexOf(e);if(s===-1)return R4e(n,e,i,o);const l=n.lastIndexOf(e);return s!==l?i:s}const D4e=(n,e)=>n===null?null:Uo(Math.round(n),0,e);function FH(n){const e=this.getLabels();return n>=0&&n<e.length?e[n]:n}class ak extends ny{constructor(e){super(e),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(e){const i=this._addedLabels;if(i.length){const o=this.getLabels();for(const{index:s,label:l}of i)o[s]===l&&o.splice(s,1);this._addedLabels=[]}super.init(e)}parse(e,i){if(da(e))return null;const o=this.getLabels();return i=isFinite(i)&&o[i]===e?i:k4e(o,e,Fi(i,e),this._addedLabels),D4e(i,o.length-1)}determineDataLimits(){const{minDefined:e,maxDefined:i}=this.getUserBounds();let{min:o,max:s}=this.getMinMax(!0);this.options.bounds==="ticks"&&(e||(o=0),i||(s=this.getLabels().length-1)),this.min=o,this.max=s}buildTicks(){const e=this.min,i=this.max,o=this.options.offset,s=[];let l=this.getLabels();l=e===0&&i===l.length-1?l:l.slice(e,i+1),this._valueRange=Math.max(l.length-(o?0:1),1),this._startValue=this.min-(o?.5:0);for(let d=e;d<=i;d++)s.push({value:d});return s}getLabelForValue(e){return FH.call(this,e)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(e){return typeof e!="number"&&(e=this.parse(e)),e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getPixelForTick(e){const i=this.ticks;return e<0||e>i.length-1?null:this.getPixelForValue(i[e].value)}getValueForPixel(e){return Math.round(this._startValue+this.getDecimalForPixel(e)*this._valueRange)}getBasePixel(){return this.bottom}}xn(ak,"id","category"),xn(ak,"defaults",{ticks:{callback:FH}});function O4e(n,e){const i=[],{bounds:s,step:l,min:d,max:p,precision:f,count:y,maxTicks:_,maxDigits:x,includeBounds:S}=n,T=l||1,I=_-1,{min:R,max:D}=e,L=!da(d),O=!da(p),N=!da(y),F=(D-R)/(x+1);let G=RG((D-R)/I/T)*T,j,Y,te,V;if(G<1e-14&&!L&&!O)return[{value:R},{value:D}];V=Math.ceil(D/G)-Math.floor(R/G),V>I&&(G=RG(V*G/I/T)*T),da(f)||(j=Math.pow(10,f),G=Math.ceil(G*j)/j),s==="ticks"?(Y=Math.floor(R/G)*G,te=Math.ceil(D/G)*G):(Y=R,te=D),L&&O&&l&&PTe((p-d)/l,G/1e3)?(V=Math.round(Math.min((p-d)/G,_)),G=(p-d)/V,Y=d,te=p):N?(Y=L?d:Y,te=O?p:te,V=y-1,G=(te-Y)/V):(V=(te-Y)/G,wx(V,Math.round(V),G/1e3)?V=Math.round(V):V=Math.ceil(V));const Q=Math.max(kG(G),kG(Y));j=Math.pow(10,da(f)?Q:f),Y=Math.round(Y*j)/j,te=Math.round(te*j)/j;let he=0;for(L&&(S&&Y!==d?(i.push({value:d}),Y<d&&he++,wx(Math.round((Y+he*G)*j)/j,d,BH(d,F,n))&&he++):Y<d&&he++);he<V;++he){const fe=Math.round((Y+he*G)*j)/j;if(O&&fe>p)break;i.push({value:fe})}return O&&S&&te!==p?i.length&&wx(i[i.length-1].value,p,BH(p,F,n))?i[i.length-1].value=p:i.push({value:p}):(!O||te===p)&&i.push({value:te}),i}function BH(n,e,{horizontal:i,minRotation:o}){const s=du(o),l=(i?Math.sin(s):Math.cos(s))||.001,d=.75*e*(""+n).length;return Math.min(e/l,d)}class wM extends ny{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(e,i){return da(e)||(typeof e=="number"||e instanceof Number)&&!isFinite(+e)?null:+e}handleTickRangeOptions(){const{beginAtZero:e}=this.options,{minDefined:i,maxDefined:o}=this.getUserBounds();let{min:s,max:l}=this;const d=f=>s=i?s:f,p=f=>l=o?l:f;if(e){const f=_d(s),y=_d(l);f<0&&y<0?p(0):f>0&&y>0&&d(0)}if(s===l){let f=l===0?1:Math.abs(l*.05);p(l+f),e||d(s-f)}this.min=s,this.max=l}getTickLimit(){const e=this.options.ticks;let{maxTicksLimit:i,stepSize:o}=e,s;return o?(s=Math.ceil(this.max/o)-Math.floor(this.min/o)+1,s>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${o} would result generating up to ${s} ticks. Limiting to 1000.`),s=1e3)):(s=this.computeTickLimit(),i=i||11),i&&(s=Math.min(i,s)),s}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const e=this.options,i=e.ticks;let o=this.getTickLimit();o=Math.max(2,o);const s={maxTicks:o,bounds:e.bounds,min:e.min,max:e.max,precision:i.precision,step:i.stepSize,count:i.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:i.minRotation||0,includeBounds:i.includeBounds!==!1},l=this._range||this,d=O4e(s,l);return e.bounds==="ticks"&&qK(d,this,"value"),e.reverse?(d.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),d}configure(){const e=this.ticks;let i=this.min,o=this.max;if(super.configure(),this.options.offset&&e.length){const s=(o-i)/Math.max(e.length-1,1)/2;i-=s,o+=s}this._startValue=i,this._endValue=o,this._valueRange=o-i}getLabelForValue(e){return a2(e,this.chart.options.locale,this.options.ticks.format)}}class rk extends wM{determineDataLimits(){const{min:e,max:i}=this.getMinMax(!0);this.min=Xr(e)?e:0,this.max=Xr(i)?i:1,this.handleTickRangeOptions()}computeTickLimit(){const e=this.isHorizontal(),i=e?this.width:this.height,o=du(this.options.ticks.minRotation),s=(e?Math.sin(o):Math.cos(o))||.001,l=this._resolveTickFontOptions(0);return Math.ceil(i/Math.min(40,l.lineHeight/s))}getPixelForValue(e){return e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getValueForPixel(e){return this._startValue+this.getDecimalForPixel(e)*this._valueRange}}xn(rk,"id","linear"),xn(rk,"defaults",{ticks:{callback:pC.formatters.numeric}});const Cw=n=>Math.floor(tf(n)),Zm=(n,e)=>Math.pow(10,Cw(n)+e);function UH(n){return n/Math.pow(10,Cw(n))===1}function WH(n,e,i){const o=Math.pow(10,i),s=Math.floor(n/o);return Math.ceil(e/o)-s}function N4e(n,e){const i=e-n;let o=Cw(i);for(;WH(n,e,o)>10;)o++;for(;WH(n,e,o)<10;)o--;return Math.min(o,Cw(n))}function z4e(n,{min:e,max:i}){e=Wl(n.min,e);const o=[],s=Cw(e);let l=N4e(e,i),d=l<0?Math.pow(10,Math.abs(l)):1;const p=Math.pow(10,l),f=s>l?Math.pow(10,s):0,y=Math.round((e-f)*d)/d,_=Math.floor((e-f)/p/10)*p*10;let x=Math.floor((y-_)/Math.pow(10,l)),S=Wl(n.min,Math.round((f+_+x*Math.pow(10,l))*d)/d);for(;S<i;)o.push({value:S,major:UH(S),significand:x}),x>=10?x=x<15?15:20:x++,x>=20&&(l++,x=2,d=l>=0?1:d),S=Math.round((f+_+x*Math.pow(10,l))*d)/d;const T=Wl(n.max,S);return o.push({value:T,major:UH(T),significand:x}),o}class ok extends ny{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._valueRange=0}parse(e,i){const o=wM.prototype.parse.apply(this,[e,i]);if(o===0){this._zero=!0;return}return Xr(o)&&o>0?o:null}determineDataLimits(){const{min:e,max:i}=this.getMinMax(!0);this.min=Xr(e)?Math.max(0,e):null,this.max=Xr(i)?Math.max(0,i):null,this.options.beginAtZero&&(this._zero=!0),this._zero&&this.min!==this._suggestedMin&&!Xr(this._userMin)&&(this.min=e===Zm(this.min,0)?Zm(this.min,-1):Zm(this.min,0)),this.handleTickRangeOptions()}handleTickRangeOptions(){const{minDefined:e,maxDefined:i}=this.getUserBounds();let o=this.min,s=this.max;const l=p=>o=e?o:p,d=p=>s=i?s:p;o===s&&(o<=0?(l(1),d(10)):(l(Zm(o,-1)),d(Zm(s,1)))),o<=0&&l(Zm(s,-1)),s<=0&&d(Zm(o,1)),this.min=o,this.max=s}buildTicks(){const e=this.options,i={min:this._userMin,max:this._userMax},o=z4e(i,this);return e.bounds==="ticks"&&qK(o,this,"value"),e.reverse?(o.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),o}getLabelForValue(e){return e===void 0?"0":a2(e,this.chart.options.locale,this.options.ticks.format)}configure(){const e=this.min;super.configure(),this._startValue=tf(e),this._valueRange=tf(this.max)-tf(e)}getPixelForValue(e){return(e===void 0||e===0)&&(e=this.min),e===null||isNaN(e)?NaN:this.getPixelForDecimal(e===this.min?0:(tf(e)-this._startValue)/this._valueRange)}getValueForPixel(e){const i=this.getDecimalForPixel(e);return Math.pow(10,this._startValue+i*this._valueRange)}}xn(ok,"id","logarithmic"),xn(ok,"defaults",{ticks:{callback:pC.formatters.logarithmic,major:{enabled:!0}}});function sk(n){const e=n.ticks;if(e.display&&n.display){const i=Ms(e.backdropPadding);return Fi(e.font&&e.font.size,Zr.font.size)+i.height}return 0}function F4e(n,e,i){return i=cr(i)?i:[i],{w:$Te(n,e.string,i),h:i.length*e.lineHeight}}function VH(n,e,i,o,s){return n===o||n===s?{start:e-i/2,end:e+i/2}:n<o||n>s?{start:e-i,end:e}:{start:e,end:e+i}}function B4e(n){const e={l:n.left+n._padding.left,r:n.right-n._padding.right,t:n.top+n._padding.top,b:n.bottom-n._padding.bottom},i=Object.assign({},e),o=[],s=[],l=n._pointLabels.length,d=n.options.pointLabels,p=d.centerPointLabels?hr/l:0;for(let f=0;f<l;f++){const y=d.setContext(n.getPointLabelContext(f));s[f]=y.padding;const _=n.getPointPosition(f,n.drawingArea+s[f],p),x=Ro(y.font),S=F4e(n.ctx,x,n._pointLabels[f]);o[f]=S;const T=Gl(n.getIndexAngle(f)+p),I=Math.round(X6(T)),R=VH(I,_.x,S.w,0,180),D=VH(I,_.y,S.h,90,270);U4e(i,e,T,R,D)}n.setCenterPoint(e.l-i.l,i.r-e.r,e.t-i.t,i.b-e.b),n._pointLabelItems=G4e(n,o,s)}function U4e(n,e,i,o,s){const l=Math.abs(Math.sin(i)),d=Math.abs(Math.cos(i));let p=0,f=0;o.start<e.l?(p=(e.l-o.start)/l,n.l=Math.min(n.l,e.l-p)):o.end>e.r&&(p=(o.end-e.r)/l,n.r=Math.max(n.r,e.r+p)),s.start<e.t?(f=(e.t-s.start)/d,n.t=Math.min(n.t,e.t-f)):s.end>e.b&&(f=(s.end-e.b)/d,n.b=Math.max(n.b,e.b+f))}function W4e(n,e,i){const o=n.drawingArea,{extra:s,additionalAngle:l,padding:d,size:p}=i,f=n.getPointPosition(e,o+s+d,l),y=Math.round(X6(Gl(f.angle+co))),_=$4e(f.y,p.h,y),x=H4e(y),S=j4e(f.x,p.w,x);return{visible:!0,x:f.x,y:_,textAlign:x,left:S,top:_,right:S+p.w,bottom:_+p.h}}function V4e(n,e){if(!e)return!0;const{left:i,top:o,right:s,bottom:l}=n;return!(Oh({x:i,y:o},e)||Oh({x:i,y:l},e)||Oh({x:s,y:o},e)||Oh({x:s,y:l},e))}function G4e(n,e,i){const o=[],s=n._pointLabels.length,l=n.options,{centerPointLabels:d,display:p}=l.pointLabels,f={extra:sk(l)/2,additionalAngle:d?hr/s:0};let y;for(let _=0;_<s;_++){f.padding=i[_],f.size=e[_];const x=W4e(n,_,f);o.push(x),p==="auto"&&(x.visible=V4e(x,y),x.visible&&(y=x))}return o}function H4e(n){return n===0||n===180?"center":n<180?"left":"right"}function j4e(n,e,i){return i==="right"?n-=e:i==="center"&&(n-=e/2),n}function $4e(n,e,i){return i===90||i===270?n-=e/2:(i>270||i<90)&&(n-=e),n}function Y4e(n,e,i){const{left:o,top:s,right:l,bottom:d}=i,{backdropColor:p}=e;if(!da(p)){const f=Cg(e.borderRadius),y=Ms(e.backdropPadding);n.fillStyle=p;const _=o-y.left,x=s-y.top,S=l-o+y.width,T=d-s+y.height;Object.values(f).some(I=>I!==0)?(n.beginPath(),Mw(n,{x:_,y:x,w:S,h:T,radius:f}),n.fill()):n.fillRect(_,x,S,T)}}function q4e(n,e){const{ctx:i,options:{pointLabels:o}}=n;for(let s=e-1;s>=0;s--){const l=n._pointLabelItems[s];if(!l.visible)continue;const d=o.setContext(n.getPointLabelContext(s));Y4e(i,d,l);const p=Ro(d.font),{x:f,y,textAlign:_}=l;jg(i,n._pointLabels[s],f,y+p.lineHeight/2,p,{color:d.color,textAlign:_,textBaseline:"middle"})}}function BJ(n,e,i,o){const{ctx:s}=n;if(i)s.arc(n.xCenter,n.yCenter,e,0,dr);else{let l=n.getPointPosition(0,e);s.moveTo(l.x,l.y);for(let d=1;d<o;d++)l=n.getPointPosition(d,e),s.lineTo(l.x,l.y)}}function X4e(n,e,i,o,s){const l=n.ctx,d=e.circular,{color:p,lineWidth:f}=e;!d&&!o||!p||!f||i<0||(l.save(),l.strokeStyle=p,l.lineWidth=f,l.setLineDash(s.dash),l.lineDashOffset=s.dashOffset,l.beginPath(),BJ(n,i,d,o),l.closePath(),l.stroke(),l.restore())}function Z4e(n,e,i){return Of(n,{label:i,index:e,type:"pointLabel"})}class qb extends wM{constructor(e){super(e),this.xCenter=void 0,this.yCenter=void 0,this.drawingArea=void 0,this._pointLabels=[],this._pointLabelItems=[]}setDimensions(){const e=this._padding=Ms(sk(this.options)/2),i=this.width=this.maxWidth-e.width,o=this.height=this.maxHeight-e.height;this.xCenter=Math.floor(this.left+i/2+e.left),this.yCenter=Math.floor(this.top+o/2+e.top),this.drawingArea=Math.floor(Math.min(i,o)/2)}determineDataLimits(){const{min:e,max:i}=this.getMinMax(!1);this.min=Xr(e)&&!isNaN(e)?e:0,this.max=Xr(i)&&!isNaN(i)?i:0,this.handleTickRangeOptions()}computeTickLimit(){return Math.ceil(this.drawingArea/sk(this.options))}generateTickLabels(e){wM.prototype.generateTickLabels.call(this,e),this._pointLabels=this.getLabels().map((i,o)=>{const s=nr(this.options.pointLabels.callback,[i,o],this);return s||s===0?s:""}).filter((i,o)=>this.chart.getDataVisibility(o))}fit(){const e=this.options;e.display&&e.pointLabels.display?B4e(this):this.setCenterPoint(0,0,0,0)}setCenterPoint(e,i,o,s){this.xCenter+=Math.floor((e-i)/2),this.yCenter+=Math.floor((o-s)/2),this.drawingArea-=Math.min(this.drawingArea/2,Math.max(e,i,o,s))}getIndexAngle(e){const i=dr/(this._pointLabels.length||1),o=this.options.startAngle||0;return Gl(e*i+du(o))}getDistanceFromCenterForValue(e){if(da(e))return NaN;const i=this.drawingArea/(this.max-this.min);return this.options.reverse?(this.max-e)*i:(e-this.min)*i}getValueForDistanceFromCenter(e){if(da(e))return NaN;const i=e/(this.drawingArea/(this.max-this.min));return this.options.reverse?this.max-i:this.min+i}getPointLabelContext(e){const i=this._pointLabels||[];if(e>=0&&e<i.length){const o=i[e];return Z4e(this.getContext(),e,o)}}getPointPosition(e,i,o=0){const s=this.getIndexAngle(e)-co+o;return{x:Math.cos(s)*i+this.xCenter,y:Math.sin(s)*i+this.yCenter,angle:s}}getPointPositionForValue(e,i){return this.getPointPosition(e,this.getDistanceFromCenterForValue(i))}getBasePosition(e){return this.getPointPositionForValue(e||0,this.getBaseValue())}getPointLabelPosition(e){const{left:i,top:o,right:s,bottom:l}=this._pointLabelItems[e];return{left:i,top:o,right:s,bottom:l}}drawBackground(){const{backgroundColor:e,grid:{circular:i}}=this.options;if(e){const o=this.ctx;o.save(),o.beginPath(),BJ(this,this.getDistanceFromCenterForValue(this._endValue),i,this._pointLabels.length),o.closePath(),o.fillStyle=e,o.fill(),o.restore()}}drawGrid(){const e=this.ctx,i=this.options,{angleLines:o,grid:s,border:l}=i,d=this._pointLabels.length;let p,f,y;if(i.pointLabels.display&&q4e(this,d),s.display&&this.ticks.forEach((_,x)=>{if(x!==0){f=this.getDistanceFromCenterForValue(_.value);const S=this.getContext(x),T=s.setContext(S),I=l.setContext(S);X4e(this,T,f,d,I)}}),o.display){for(e.save(),p=d-1;p>=0;p--){const _=o.setContext(this.getPointLabelContext(p)),{color:x,lineWidth:S}=_;!S||!x||(e.lineWidth=S,e.strokeStyle=x,e.setLineDash(_.borderDash),e.lineDashOffset=_.borderDashOffset,f=this.getDistanceFromCenterForValue(i.ticks.reverse?this.min:this.max),y=this.getPointPosition(p,f),e.beginPath(),e.moveTo(this.xCenter,this.yCenter),e.lineTo(y.x,y.y),e.stroke())}e.restore()}}drawBorder(){}drawLabels(){const e=this.ctx,i=this.options,o=i.ticks;if(!o.display)return;const s=this.getIndexAngle(0);let l,d;e.save(),e.translate(this.xCenter,this.yCenter),e.rotate(s),e.textAlign="center",e.textBaseline="middle",this.ticks.forEach((p,f)=>{if(f===0&&!i.reverse)return;const y=o.setContext(this.getContext(f)),_=Ro(y.font);if(l=this.getDistanceFromCenterForValue(this.ticks[f].value),y.showLabelBackdrop){e.font=_.string,d=e.measureText(p.label).width,e.fillStyle=y.backdropColor;const x=Ms(y.backdropPadding);e.fillRect(-d/2-x.left,-l-_.size/2-x.top,d+x.width,_.size+x.height)}jg(e,p.label,0,-l,_,{color:y.color,strokeColor:y.textStrokeColor,strokeWidth:y.textStrokeWidth})}),e.restore()}drawTitle(){}}xn(qb,"id","radialLinear"),xn(qb,"defaults",{display:!0,animate:!0,position:"chartArea",angleLines:{display:!0,lineWidth:1,borderDash:[],borderDashOffset:0},grid:{circular:!1},startAngle:0,ticks:{showLabelBackdrop:!0,callback:pC.formatters.numeric},pointLabels:{backdropColor:void 0,backdropPadding:2,display:!0,font:{size:10},callback(e){return e},padding:5,centerPointLabels:!1}}),xn(qb,"defaultRoutes",{"angleLines.color":"borderColor","pointLabels.color":"color","ticks.color":"color"}),xn(qb,"descriptors",{angleLines:{_fallback:"grid"}});const yC={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},yl=Object.keys(yC);function GH(n,e){return n-e}function HH(n,e){if(da(e))return null;const i=n._adapter,{parser:o,round:s,isoWeekday:l}=n._parseOpts;let d=e;return typeof o=="function"&&(d=o(d)),Xr(d)||(d=typeof o=="string"?i.parse(d,o):i.parse(d)),d===null?null:(s&&(d=s==="week"&&(f_(l)||l===!0)?i.startOf(d,"isoWeek",l):i.startOf(d,s)),+d)}function jH(n,e,i,o){const s=yl.length;for(let l=yl.indexOf(n);l<s-1;++l){const d=yC[yl[l]],p=d.steps?d.steps:Number.MAX_SAFE_INTEGER;if(d.common&&Math.ceil((i-e)/(p*d.size))<=o)return yl[l]}return yl[s-1]}function K4e(n,e,i,o,s){for(let l=yl.length-1;l>=yl.indexOf(i);l--){const d=yl[l];if(yC[d].common&&n._adapter.diff(s,o,d)>=e-1)return d}return yl[i?yl.indexOf(i):0]}function J4e(n){for(let e=yl.indexOf(n)+1,i=yl.length;e<i;++e)if(yC[yl[e]].common)return yl[e]}function $H(n,e,i){if(!i)n[e]=!0;else if(i.length){const{lo:o,hi:s}=Z6(i,e),l=i[o]>=e?i[o]:i[s];n[l]=!0}}function Q4e(n,e,i,o){const s=n._adapter,l=+s.startOf(e[0].value,o),d=e[e.length-1].value;let p,f;for(p=l;p<=d;p=+s.add(p,1,o))f=i[p],f>=0&&(e[f].major=!0);return e}function YH(n,e,i){const o=[],s={},l=e.length;let d,p;for(d=0;d<l;++d)p=e[d],s[p]=d,o.push({value:p,major:!1});return l===0||!i?o:Q4e(n,o,s,i)}class Pw extends ny{constructor(e){super(e),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(e,i={}){const o=e.time||(e.time={}),s=this._adapter=new lPe._date(e.adapters.date);s.init(i),xx(o.displayFormats,s.formats()),this._parseOpts={parser:o.parser,round:o.round,isoWeekday:o.isoWeekday},super.init(e),this._normalized=i.normalized}parse(e,i){return e===void 0?null:HH(this,e)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const e=this.options,i=this._adapter,o=e.time.unit||"day";let{min:s,max:l,minDefined:d,maxDefined:p}=this.getUserBounds();function f(y){!d&&!isNaN(y.min)&&(s=Math.min(s,y.min)),!p&&!isNaN(y.max)&&(l=Math.max(l,y.max))}(!d||!p)&&(f(this._getLabelBounds()),(e.bounds!=="ticks"||e.ticks.source!=="labels")&&f(this.getMinMax(!1))),s=Xr(s)&&!isNaN(s)?s:+i.startOf(Date.now(),o),l=Xr(l)&&!isNaN(l)?l:+i.endOf(Date.now(),o)+1,this.min=Math.min(s,l-1),this.max=Math.max(s+1,l)}_getLabelBounds(){const e=this.getLabelTimestamps();let i=Number.POSITIVE_INFINITY,o=Number.NEGATIVE_INFINITY;return e.length&&(i=e[0],o=e[e.length-1]),{min:i,max:o}}buildTicks(){const e=this.options,i=e.time,o=e.ticks,s=o.source==="labels"?this.getLabelTimestamps():this._generate();e.bounds==="ticks"&&s.length&&(this.min=this._userMin||s[0],this.max=this._userMax||s[s.length-1]);const l=this.min,d=this.max,p=kTe(s,l,d);return this._unit=i.unit||(o.autoSkip?jH(i.minUnit,this.min,this.max,this._getLabelCapacity(l)):K4e(this,p.length,i.minUnit,this.min,this.max)),this._majorUnit=!o.major.enabled||this._unit==="year"?void 0:J4e(this._unit),this.initOffsets(s),e.reverse&&p.reverse(),YH(this,p,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(e=>+e.value))}initOffsets(e=[]){let i=0,o=0,s,l;this.options.offset&&e.length&&(s=this.getDecimalForValue(e[0]),e.length===1?i=1-s:i=(this.getDecimalForValue(e[1])-s)/2,l=this.getDecimalForValue(e[e.length-1]),e.length===1?o=l:o=(l-this.getDecimalForValue(e[e.length-2]))/2);const d=e.length<3?.5:.25;i=Uo(i,0,d),o=Uo(o,0,d),this._offsets={start:i,end:o,factor:1/(i+1+o)}}_generate(){const e=this._adapter,i=this.min,o=this.max,s=this.options,l=s.time,d=l.unit||jH(l.minUnit,i,o,this._getLabelCapacity(i)),p=Fi(s.ticks.stepSize,1),f=d==="week"?l.isoWeekday:!1,y=f_(f)||f===!0,_={};let x=i,S,T;if(y&&(x=+e.startOf(x,"isoWeek",f)),x=+e.startOf(x,y?"day":d),e.diff(o,i,d)>1e5*p)throw new Error(i+" and "+o+" are too far apart with stepSize of "+p+" "+d);const I=s.ticks.source==="data"&&this.getDataTimestamps();for(S=x,T=0;S<o;S=+e.add(S,p,d),T++)$H(_,S,I);return(S===o||s.bounds==="ticks"||T===1)&&$H(_,S,I),Object.keys(_).sort(GH).map(R=>+R)}getLabelForValue(e){const i=this._adapter,o=this.options.time;return o.tooltipFormat?i.format(e,o.tooltipFormat):i.format(e,o.displayFormats.datetime)}format(e,i){const s=this.options.time.displayFormats,l=this._unit,d=i||s[l];return this._adapter.format(e,d)}_tickFormatFunction(e,i,o,s){const l=this.options,d=l.ticks.callback;if(d)return nr(d,[e,i,o],this);const p=l.time.displayFormats,f=this._unit,y=this._majorUnit,_=f&&p[f],x=y&&p[y],S=o[i],T=y&&x&&S&&S.major;return this._adapter.format(e,s||(T?x:_))}generateTickLabels(e){let i,o,s;for(i=0,o=e.length;i<o;++i)s=e[i],s.label=this._tickFormatFunction(s.value,i,e)}getDecimalForValue(e){return e===null?NaN:(e-this.min)/(this.max-this.min)}getPixelForValue(e){const i=this._offsets,o=this.getDecimalForValue(e);return this.getPixelForDecimal((i.start+o)*i.factor)}getValueForPixel(e){const i=this._offsets,o=this.getDecimalForPixel(e)/i.factor-i.end;return this.min+o*(this.max-this.min)}_getLabelSize(e){const i=this.options.ticks,o=this.ctx.measureText(e).width,s=du(this.isHorizontal()?i.maxRotation:i.minRotation),l=Math.cos(s),d=Math.sin(s),p=this._resolveTickFontOptions(0).size;return{w:o*l+p*d,h:o*d+p*l}}_getLabelCapacity(e){const i=this.options.time,o=i.displayFormats,s=o[i.unit]||o.millisecond,l=this._tickFormatFunction(e,0,YH(this,[e],this._majorUnit),s),d=this._getLabelSize(l),p=Math.floor(this.isHorizontal()?this.width/d.w:this.height/d.h)-1;return p>0?p:1}getDataTimestamps(){let e=this._cache.data||[],i,o;if(e.length)return e;const s=this.getMatchingVisibleMetas();if(this._normalized&&s.length)return this._cache.data=s[0].controller.getAllParsedValues(this);for(i=0,o=s.length;i<o;++i)e=e.concat(s[i].controller.getAllParsedValues(this));return this._cache.data=this.normalize(e)}getLabelTimestamps(){const e=this._cache.labels||[];let i,o;if(e.length)return e;const s=this.getLabels();for(i=0,o=s.length;i<o;++i)e.push(HH(this,s[i]));return this._cache.labels=this._normalized?e:this.normalize(e)}normalize(e){return KK(e.sort(GH))}}xn(Pw,"id","time"),xn(Pw,"defaults",{bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}});function RA(n,e,i){let o=0,s=n.length-1,l,d,p,f;i?(e>=n[o].pos&&e<=n[s].pos&&({lo:o,hi:s}=Dh(n,"pos",e)),{pos:l,time:p}=n[o],{pos:d,time:f}=n[s]):(e>=n[o].time&&e<=n[s].time&&({lo:o,hi:s}=Dh(n,"time",e)),{time:l,pos:p}=n[o],{time:d,pos:f}=n[s]);const y=d-l;return y?p+(f-p)*(e-l)/y:p}class lk extends Pw{constructor(e){super(e),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const e=this._getTimestampsForTable(),i=this._table=this.buildLookupTable(e);this._minPos=RA(i,this.min),this._tableRange=RA(i,this.max)-this._minPos,super.initOffsets(e)}buildLookupTable(e){const{min:i,max:o}=this,s=[],l=[];let d,p,f,y,_;for(d=0,p=e.length;d<p;++d)y=e[d],y>=i&&y<=o&&s.push(y);if(s.length<2)return[{time:i,pos:0},{time:o,pos:1}];for(d=0,p=s.length;d<p;++d)_=s[d+1],f=s[d-1],y=s[d],Math.round((_+f)/2)!==y&&l.push({time:y,pos:d/(p-1)});return l}_generate(){const e=this.min,i=this.max;let o=super.getDataTimestamps();return(!o.includes(e)||!o.length)&&o.splice(0,0,e),(!o.includes(i)||o.length===1)&&o.push(i),o.sort((s,l)=>s-l)}_getTimestampsForTable(){let e=this._cache.all||[];if(e.length)return e;const i=this.getDataTimestamps(),o=this.getLabelTimestamps();return i.length&&o.length?e=this.normalize(i.concat(o)):e=i.length?i:o,e=this._cache.all=e,e}getDecimalForValue(e){return(RA(this._table,e)-this._minPos)/this._tableRange}getValueForPixel(e){const i=this._offsets,o=this.getDecimalForPixel(e)/i.factor-i.end;return RA(this._table,o*this._tableRange+this._minPos,!0)}}xn(lk,"id","timeseries"),xn(lk,"defaults",Pw.defaults);var eIe=Object.freeze({__proto__:null,CategoryScale:ak,LinearScale:rk,LogarithmicScale:ok,RadialLinearScale:qb,TimeScale:Pw,TimeSeriesScale:lk});const tIe=[sPe,z5e,L4e,eIe];o2.register(...tIe);const nIe=({chartData:n})=>{const e=s=>n,i=ie.useRef(null),o=s=>{var d;if(!s)return;const l=s.getContext("2d");l&&((d=i.current)==null||d.destroy(),i.current=new o2(l,{type:"radar",data:e(),options:{plugins:{tooltip:{enabled:!0},legend:{display:!1}},scales:{r:{pointLabels:{font:{size:18}}}}}}))};return ie.useEffect(()=>{i.current&&(i.current.data=e(),i.current.update())},[n]),X("canvas",{ref:o})},UJ=ie.createContext(void 0),Kl=()=>{const n=ie.useContext(UJ);if(!n)throw new Error("useSelectedCityData must be used within a CityDataProvider");return n},iIe=({children:n})=>{const{classes:e}=C_(),i=Kl();return $e("div",{className:e.contentWrapper,children:[$e("div",{style:{position:"absolute",top:"15.5%",left:"9vh",display:"flex",flexDirection:"column",zIndex:1e3},children:[$e("div",{style:{fontFamily:"SuisseIntl-Light",fontSize:"6.25vh",color:"#000"},children:[i==null?void 0:i.City,": ",X("br",{}),X("b",{children:"Transport"})," resilience",X("br",{}),"index",X("span",{style:{paddingTop:"-1.5vh",marginLeft:"1.2vh",fontFamily:"SuisseIntl-Light",fontSize:"3.1vh",fontWeight:400,marginTop:"1.45vh",textAlign:"center",padding:"1.4vh 2vh",verticalAlign:"middle",backgroundColor:Hs[i==null?void 0:i["Transport Resilience Index"].toUpperCase().replace(" ","_")],color:"#000",borderRadius:50,width:"fit-content"},children:i==null?void 0:i["Transport Resilience Index"]})]}),X("div",{style:{display:"flex",flexDirection:"column",gap:".5vh",marginTop:"17vh"},children:n})]}),X(Ii,{style:{position:"absolute",top:"41vh",left:"9.5vh",width:"35vw",color:"#000000",fontFamily:"SuisseIntl-Light",fontSize:"1.8vh"},children:"The graph highlights the strengths and weaknesses of cities across various aspects of transport system. The further the vertices of the shape are from the center of the diagram, the better the city's performance in that particular metrics. The larger the area of the shape, the higher the overall assessment in Transport resilience."}),X("div",{className:e.pageContainer,children:$e("div",{className:e.bottomWrapper,children:[X("div",{className:e.smallTextWrapper}),X("div",{}),$e(xr,{style:{pointerEvents:"all",color:"#fff",backgroundColor:"#2D67FF",borderRadius:50,padding:"1vh 2.5vh",textTransform:"none",fontFamily:"SuisseIntl-Light",fontSize:"1.7vh",display:"flex",flexDirection:"row",gap:"1.2vh"},onClick:()=>{const o=i.pdfName,s=document.createElement("a");s.href=`/pdf/${o}`,s.download=o,s.click()},children:[X("div",{children:"Download report"}),X("img",{src:"/assets/downloadIcon.svg",alt:"arrow down"})]})]})})]})},Lb=["#2D67FF","#00BCF8","#00DDD0","#8490FF","#AD00FF","#FF7AE2"],aIe=()=>{const{classes:n}=C_(),[e,i]=ie.useState({}),o=Kl(),s=fM.filter(f=>f!==o.City),[l,d]=ie.useState(s.slice(0,5));ie.useEffect(()=>{const f=H6.filter(x=>l.includes(x.City)),y=[o,...f].map((x,S)=>({label:x.City,backgroundColor:"transparent",borderWidth:S===0?8:1,borderColor:Lb[S],pointBackgroundColor:Lb[S],pointBorderColor:Lb[S],pointHoverBackgroundColor:"#fff",pointHoverBorderColor:"rgba(34, 202, 236, 1)",pointRadius:5,data:[x.tr_graph.Efficiency,x.tr_graph.Accessibility,x.tr_graph.Safety,x.tr_graph.Affordability,x.tr_graph["Environmental impact"],x.tr_graph.Satisfaction]}));i({labels:["Efficiency","Accessibility","Safety","Affordability","Environmental impact","Satisfaction"],datasets:y})},[l]);const p=(f,y)=>{d(_=>{const x=[..._];return x[y-1]=f,x})};return X("div",{style:{position:"relative",backgroundColor:"#fff"},children:$e("div",{className:n.root,children:[X("div",{style:{position:"absolute",top:"15vh",right:"35vh",width:"80vh",zIndex:10},children:X(nIe,{chartData:e})}),$e(iIe,{children:[X(AG,{label:o.City,color:Lb[0],position:0}),l.map((f,y)=>X(AG,{label:f,color:Lb[y+1],cities:s,position:y+1,onClick:p},f))]})]})})},rIe={menu:"Menu",login:"Log in",signup:"Sign up",back:"Back to globe"},WJ=({invertColors:n,setMenuVisible:e,displayBackButton:i,marginLogo:o})=>{const s=p=>rIe[p],{classes:l}=DT(),d=vu();return $e("div",{className:l.root,style:{margin:"0 10vh 0 10vh",borderBottom:n?"1px solid #000":"1px solid #fff"},children:[X("div",{style:{display:"flex",gap:"2.5vh",alignItems:"center"},children:$e("div",{className:l.menuIconWrapper,children:[!i&&$e("div",{onClick:()=>{d("/urban")},style:{display:"flex",gap:"1vh",alignItems:"center",cursor:"pointer",marginRight:"2vh"},children:[X("img",{style:{width:"4.7vh"},src:"/assets/backToGlobeIcon.svg",width:45,alt:"logo"}),X(Ii,{className:l.whiteText,style:{color:n?"#000":"#fff"},children:s("back")})]}),$e("div",{onClick:()=>e(!0),style:{display:"flex",gap:"1vh",flexDirection:"row",alignItems:"center"},children:[n?X("img",{style:{width:"4.7vh"},src:"/assets/blackMenuIcon.svg",width:45,alt:"logo"}):X("img",{style:{width:"4.7vh"},src:"/assets/menuIcon.svg",width:45,alt:"logo"}),X(Ii,{className:l.whiteText,style:{color:n?"#000":"#fff"},children:s("menu")})]})]})}),n?X("img",{style:{width:"7.8vh",marginLeft:o||"0"},src:"/assets/blackLogo.svg",alt:"logo"}):X("img",{style:{width:"7.8vh",marginLeft:o||"0"},src:"/assets/logo.svg",alt:"logo"}),$e("div",{className:l.buttonsWrapper,children:[X("div",{style:{width:"19vh"}}),n?X("img",{src:"/assets/blackAvatarIcon.svg",alt:"user icon"}):X("div",{style:{fontFamily:"SuisseIntl-Light",fontWeight:600,color:"#fff",textTransform:"none",fontSize:"1.8vh",height:"4.6vh",width:"fit-content",padding:"0 1.5vh",backgroundColor:"#fff",borderRadius:"50px",display:"flex",alignItems:"center"},children:X("img",{src:"/assets/avatarIcon.svg",alt:"user icon",style:{width:"2.5vh"}})})]})]})},Rb=({children:n,isActive:e})=>{const{classes:i}=VK();return X("div",{className:`${i.sectionWrapper} `,children:n})},VJ=pr()({root:{padding:0,margin:0,backgroundColor:"#1433AE",color:"#fff",height:"100vh"},contentWrapper:{height:"100%",width:"100%",margin:"0 auto",padding:"0 5%",boxSizing:"border-box"},pageContainer:{position:"relative",display:"block",float:"left",width:"100%",height:"100vh"},titleWrapper:{position:"absolute",top:"11vh",textAlign:"center",width:"100%"},bigText:{paddingTop:"18px",fontFamily:"SuisseIntl-Light",fontWeight:300,lineHeight:"9vh",letterSpacing:"-0.5vh",fontSize:"10.7vh",color:"#fff"},bigTextSubtitle:{paddingTop:"18px",fontFamily:"SuisseIntl-Light",fontWeight:400,lineHeight:"2",letterSpacing:"0",fontSize:"2vh",color:"#fff"},smallItemsListWrapper:{marginTop:"4vh",display:"flex",flexDirection:"column",gap:"1.1vh"},bottomWrapper:{position:"absolute",bottom:"0",zIndex:1,display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:"4vh",pointerEvents:"none",width:"100%"},smallTextWrapper:{pointerEvents:"all",display:"flex",flexDirection:"row",gap:"10px"},smallText:{fontFamily:"SuisseIntl-Light",fontSize:"1.8vh",color:"#fff",opacity:"0.6",cursor:"pointer"}}),oIe=({children:n})=>{const{classes:e}=KD();return X("div",{className:e.root,children:X("div",{className:e.contentWrapper,children:n})})},sIe=({cityName:n,countryName:e})=>{const{classes:i}=VJ();return $e("div",{className:i.titleWrapper,children:[$e(Ii,{className:i.bigText,children:[n," ",X("span",{style:{color:"#fff",opacity:.5,letterSpacing:"-0.1vh",fontSize:"6vh"},children:"in indices"})]}),X(Ii,{className:i.bigTextSubtitle,children:e})]})},kA=({label:n,subLabel:e,status:i,isFirst:o,filled:s})=>{const l=i.replace("-","");return X(_s,{children:o?$e("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"},children:[X("div",{style:{fontFamily:"SuisseIntl-Light",fontWeight:100,fontSize:"2.4vh",textAlign:"center"},children:n}),X("div",{style:{fontFamily:"SuisseIntl-Light",fontWeight:200,fontSize:"1.8vh",opacity:.6},children:e}),X("div",{style:{fontFamily:"SuisseIntl-Light",fontWeight:200,fontSize:"1.5vh",border:"1px solid #fff",borderRadius:50,padding:"1vh 3vh",marginTop:"1.4vh",color:pM[l],borderColor:`${pM[l]}30`},children:i})]}):$e("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"},children:[X("div",{style:{fontFamily:"SuisseIntl-Light",fontWeight:100,fontSize:"2.4vh",textAlign:"center"},children:n}),X("div",{style:{fontFamily:"SuisseIntl-Light",fontWeight:200,fontSize:"1.8vh",border:"1px solid #fff",borderRadius:50,padding:"1vh 3vh",marginTop:"1.4vh",color:Hs[i.toUpperCase().replace(" ","_")],borderColor:`${Hs[i.toUpperCase().replace(" ","_")]}30`,borderWidth:1,backgroundColor:s?`${Hs[i.toUpperCase()]}30`:"transparent"},children:i})]})})},lIe=[{type:"Feature",properties:{fid:76,City_Name:"Amman",center:[35.9294491509595,31.99991210008109],zoom:10.302824376136313,bearing:101.60000000000173,pitch:49.99999999999965},geometry:{type:"Point",coordinates:[35.91933631448545,31.951386464751504]}},{type:"Feature",properties:{fid:336,City_Name:"Mexico City",center:[-99.09309081576346,19.34983411479375],zoom:9.867175623863696,bearing:0,pitch:38.1352704054439},geometry:{type:"Point",coordinates:[-99.1010915812256,19.457659604398632]}},{type:"Feature",properties:{fid:799,City_Name:"Bangkok",center:[100.50324135863775,13.719555607290715],zoom:9.818587811931847,bearing:0,pitch:50},geometry:{type:"Point",coordinates:[100.56813228239119,13.778801078899539]}},{type:"Feature",properties:{fid:892,City_Name:"Panama City",center:[-79.4827698424715,9.050655704984095],zoom:10.591526871591094,bearing:0,pitch:50.01373809516397},geometry:{type:"Point",coordinates:[-79.49751526014956,9.013829150641525]}},{type:"Feature",properties:{fid:1165,City_Name:"Colombo",center:[80.07050699310525,6.823336439561302],zoom:9.81,bearing:-20.000000000000114,pitch:62},geometry:{type:"Point",coordinates:[79.9583239444924,6.932357722680249]}},{type:"Feature",properties:{fid:2311,City_Name:"Jakarta",center:[106.7549140865068,-6.279782111773116],zoom:9.250879827490543,bearing:-171.20000000000033,pitch:43.5},geometry:{type:"Point",coordinates:[106.81547517179841,-6.172653326038387]}},{type:"Feature",properties:{fid:2873,City_Name:"Cape Town",center:[18.595325073248517,-33.98842317442896],zoom:10.326397481326069,bearing:12.8,pitch:35.48000000000009},geometry:{type:"Point",coordinates:[18.600086702400798,-33.98288982976307]}},{type:"Feature",properties:{fid:10,City_Name:"Valparaiso",center:[-71.49418255077882,-33.02916530602038],zoom:10.663321631643026,bearing:179.0638372543699,pitch:54.5411711309316,Category:"C1"},geometry:{type:"Point",coordinates:[-71.62739583920451,-33.0425755449797]}},{type:"Feature",properties:{fid:11,City_Name:"Natal",center:[-35.25026461835907,-5.795680924221671],zoom:11.194733819711187,bearing:-151.19999999999965,pitch:43.980000000000125,Category:"B2"},geometry:{type:"Point",coordinates:[-35.21222333226075,-5.814877064286144]}},{type:"Feature",properties:{fid:12,City_Name:"Dar es Salaam",center:[39.179162094870094,-6.884904593781215],zoom:9.51190944357489,bearing:0,pitch:52,Category:"C2"},geometry:{type:"Point",coordinates:[39.21870804117781,-6.825200004764525]}},{type:"Feature",properties:{fid:13,City_Name:"Brazzaville",center:[15.258412531048407,-4.0848396587145],zoom:10.033264905407863,bearing:0,pitch:50,Category:"C1"},geometry:{type:"Point",coordinates:[15.268282806301356,-4.253046135825453]}},{type:"Feature",properties:{fid:14,City_Name:"Dubai",center:[55.33641246251963,25.078748811928463],zoom:9.591526871591089,bearing:0,pitch:56.98,Category:"A2"},geometry:{type:"Point",coordinates:[55.23468568314278,25.177065811310452]}},{type:"Feature",properties:{fid:15,City_Name:"Expo City Dubai",center:[55.33641246251963,25.078748811928463],zoom:9.591526871591089,bearing:0,pitch:56.98,Category:"A3"},geometry:{type:"Point",coordinates:[55.15094645583921,24.96152906476464]}},{type:"Feature",properties:{fid:16,City_Name:"Almaty",center:[76.89615639234319,43.22632526745298],zoom:10.552292015558665,bearing:0,pitch:56.979999999999954,Category:"B1"},geometry:{type:"Point",coordinates:[76.8984883098032,43.26555910249282]}},{type:"Feature",properties:{fid:17,City_Name:"Adoni",center:[77.27052715393592,15.658568511522205],zoom:11.055099976780857,bearing:0,pitch:44.94535508727158,Category:"C2"},geometry:{type:"Point",coordinates:[77.27318970081716,15.62514604003816]}}],cIe=({selectedCityName:n,setMap:e})=>{Ed.accessToken="pk.eyJ1Ijoic3RhbnJvbnpoaW4iLCJhIjoiY2xvaGF3ZmFzMWdodDJxbjByeHMzanE2dCJ9.3uz_EG8N_d7isS1h5wV46w";const i=ie.useRef(null),o=ie.useRef(null);return ie.useEffect(()=>{var l;if(o.current||!i.current)return;const s=(l=lIe.find(d=>d.properties.City_Name===n))==null?void 0:l.properties;o.current=new Ed.Map({attributionControl:!0,container:i.current,style:"mapbox://styles/stanronzhin/clpdlsmlk00bt01p9e53lgin4",center:s==null?void 0:s.center,zoom:s==null?void 0:s.zoom,bearing:s==null?void 0:s.bearing,pitch:s==null?void 0:s.pitch}),o.current.on("load",()=>{if(!o.current)return;o.current.resize();let d,p,f=!1;function y(_){d===void 0&&(d=_);const x=_-d;if(p!==_){const S=Math.min(24e-5*x,.6);o.current.setPaintProperty("bars-14-cities-shp-8gys15","fill-extrusion-vertical-scale",S),S===1&&(f=!0)}x<2500&&(p=_,f||requestAnimationFrame(y))}y(0)}),e(o.current)},[]),X("div",{ref:i,style:{pointerEvents:"none",position:"absolute",top:"10vh",right:"0",width:"100%",height:"90vh"}})},uIe=({map:n})=>$e("div",{style:{userSelect:"none",position:"absolute",right:"40vh",bottom:"3vh",zIndex:2,marginRight:"15px",height:"10.5vh",width:"4.7vh",display:"flex",flexDirection:"column",backgroundColor:"#fff",borderRadius:"50px",overflow:"hidden",padding:0,margin:0,pointerEvents:"all"},children:[X("div",{onClick:()=>{n&&n.zoomIn()},style:{userSelect:"none",cursor:"pointer",height:"50%",display:"flex",justifyContent:"center",alignItems:"center",backgroundColor:"#fff",borderRadius:"50px",overflow:"hidden",padding:0,margin:0},children:X("img",{style:{userSelect:"none"},src:"/assets/plusIcon.svg",width:"45%",alt:"zoom in"})}),X("div",{onClick:()=>{if(!n)return;n.getZoom()>10.5&&n.zoomOut()},style:{cursor:"pointer",height:"50%",display:"flex",justifyContent:"center",alignItems:"center",backgroundColor:"#fff",borderRadius:"50px",overflow:"hidden",padding:0,margin:0,userSelect:"none"},children:X("img",{src:"/assets/minusIcon.svg",width:"45%",alt:"zoom out"})})]}),dIe=({setActiveSection:n})=>{const{classes:e}=VJ(),[i,o]=ie.useState(null),s=Kl();return $e("div",{style:{position:"relative"},children:[X(cIe,{setMap:o,selectedCityName:s.City}),$e(oIe,{children:[$e("div",{className:e.pageContainer,children:[X(sIe,{cityName:s.City,countryName:s.Country}),$e("div",{style:{position:"absolute",top:"30%",left:"2vh",borderLeft:"1px solid #fff",paddingLeft:"2vh",height:"auto",transform:"scale(1.2)"},children:[X("div",{style:{cursor:"pointer"},onClick:()=>{const l=document.getElementById("landing");l.scrollTo({top:l.clientHeight*2,behavior:"smooth"})},children:X(f0,{label:"Urban resilience index",status:s["Urban Resilience Index"],isFirst:!0})}),$e("div",{className:e.smallItemsListWrapper,children:[X(uu,{label:"Environmental",status:s.Environmental,style:{fontSize:"2.1vh"}}),X(uu,{label:"Social",status:s.Social,style:{fontSize:"2.1vh"}}),X(uu,{label:"Governmental",status:s.Governmental,style:{fontSize:"2.1vh"}})]}),X("div",{className:e.smallItemsListWrapper,style:{marginTop:"2.7vh"},children:X(uu,{label:"Ability & Willingness",status:s["Ability & Willingness"],style:{fontSize:"2.1vh"}})})]}),$e("div",{style:{position:"absolute",top:"27%",right:"9vh",display:"flex",flexDirection:"column",gap:"3.2vh",height:"43.5vh"},children:[X("div",{style:{fontFamily:"SuisseIntl-Light",fontWeight:100,fontSize:"3vh",textAlign:"center"},children:"Related indices"}),X("div",{children:X(kA,{isFirst:!0,label:"Basic needs index",subLabel:"Scope 0",status:s["Basic needs Scope"]})}),X(kA,{label:"Social sentiment index",status:s["Urban Sentiment Index"],filled:!0}),X(kA,{label:"Natural risk exposure index",status:s["Natural Risk Exposure"]}),X("div",{onClick:()=>{const l=document.getElementById("landing");l.scrollTo({top:l.clientHeight*3,behavior:"smooth"})},style:{cursor:"pointer"},children:X(kA,{label:"Transport resilience index",status:s["Transport Resilience Index"],filled:!0})})]}),$e("div",{className:e.bottomWrapper,children:[$e("div",{className:e.smallTextWrapper,onClick:()=>{const l="Methodology_v05_AP_BK_v2.pdf",d=document.createElement("a");d.href=`/pdf/${l}`,d.download=l,d.click()},children:[X(Ii,{className:e.smallText,children:"How the rating works"}),X("img",{src:"/assets/questionGray.svg",alt:"hint",style:{opacity:.6}})]}),$e("div",{children:[(s.City==="Dubai"||s.City==="Dar es Salaam")&&X(xr,{onClick:()=>{const l=document.getElementById("landing");l.scrollTo({top:l.clientHeight*5,behavior:"smooth"})},style:{marginBottom:"5vh",backgroundColor:"#3752BA",color:"#fff",borderRadius:50,padding:"1vh 2.5vh",textTransform:"none",pointerEvents:"all",cursor:"pointer",fontFamily:"SuisseIntl-Light",fontSize:"1.7vh",alignItems:"center"},children:"Geoanalytics"}),$e("div",{onClick:()=>{const l=document.getElementById("landing");l.scrollTo({top:l.clientHeight,behavior:"smooth"})},style:{pointerEvents:"all",cursor:"pointer",fontFamily:"SuisseIntl-Light",fontSize:"1.7vh",display:"flex",flexDirection:"column",gap:"1.2vh",alignItems:"center"},children:[X("div",{children:"Scroll down"}),X("img",{src:"/assets/arrowDown.svg",alt:"arrow down",style:{animation:"bounce 2s infinite"}})]})]}),$e(xr,{style:{pointerEvents:"all",color:"#fff",backgroundColor:"#2D67FF",borderRadius:50,padding:"1vh 2.5vh",textTransform:"none",fontFamily:"SuisseIntl-Light",fontSize:"1.7vh",display:"flex",flexDirection:"row",gap:"1.2vh"},onClick:()=>{const l=s.pdfName,d=document.createElement("a");d.href=`/pdf/${l}`,d.download=l,d.click()},children:[X("div",{children:"Download report"}),X("img",{src:"/assets/downloadIcon.svg",alt:"arrow down"})]})]})]}),X("div",{style:{position:"absolute",fontFamily:"SuisseIntl-Light",fontWeight:100,fontSize:"1.4vh",color:"rgba(255, 255, 255, 0.4)",bottom:"22vh",right:"50%",transform:"translateX(65%)",width:"30%"},children:"The height of a bar represents the total number of people in a grid cell."}),X(uIe,{map:i})]})]})},c0=({label:n,value:e,status:i,color:o})=>$e("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"flex-end"},children:[X("div",{style:{fontFamily:"SuisseIntl-Light",fontSize:"2vh",textAlign:"center"},children:n}),X("div",{style:{fontFamily:"SuisseIntl-Light",fontSize:"2.5vh",marginTop:".7vh",textAlign:"center"},children:e}),X("div",{style:{fontFamily:"SuisseIntl-Light",fontSize:"2vh",fontWeight:600,marginTop:"1.45vh",textAlign:"center",padding:"1vh 3vh",backgroundColor:"#fff",color:o,borderRadius:50,width:"fit-content"},children:i})]}),GJ=({bgUrl:n,isActive:e,onClick:i})=>X("div",{onClick:i,style:{pointerEvents:"all",cursor:"pointer",height:"4.5vh",width:"4.5vh",borderRadius:"50%",border:"1px solid #fff",backgroundImage:e?"none":`url(${n})`,backgroundSize:"cover",backgroundPosition:"center",display:"flex",justifyContent:"center",alignItems:"center"},children:e&&X("div",{style:{height:"10px",width:"10px",borderRadius:"50%",backgroundColor:"#fff"}})}),HJ=({imagesUrls:n,activeImageIndex:e})=>X("div",{style:{position:"absolute",width:"100%",height:"100%"},children:n.map((i,o)=>X("div",{style:{position:"absolute",width:"100%",height:"100%",backgroundImage:`url(${i})`,backgroundSize:"cover",backgroundPosition:"center",opacity:e===o?1:0,transition:"opacity 0.5s ease"}},o))}),hIe=({setActiveSection:n})=>{const[e,i]=ie.useState(0),{classes:o}=C_(),s=Kl(),l=s.Climate.replace(/,/g,"/"),d=(s["Poverty headcount ratio at national poverty lines"]*100).toFixed(1)+"% ",p=(s["Literacy rate among population"]*100).toFixed(1)+"% ";return $e("div",{style:{position:"relative"},children:[X(HJ,{imagesUrls:s.images,activeImageIndex:e}),$e("div",{className:o.root,children:[X("div",{style:{position:"absolute",top:"0",left:"0",width:"100%",height:"100%",background:"linear-gradient(180deg, rgba(0,0,0,0.5) 90%, rgba(0,0,0,0.5))"}}),X("div",{className:o.contentWrapper,children:$e("div",{className:o.pageContainer,children:[$e("div",{style:{position:"absolute",top:"15vh",justifyContent:"center",width:"100%",margin:"0 auto",gap:"4vh",textAlign:"center",fontFamily:"SuisseIntl-Light",fontWeight:300,lineHeight:"9vh",letterSpacing:"-0.5vh",fontSize:"8vh",color:"#fff"},children:[s.City," in Pictures and Numbers"]}),$e("div",{style:{position:"absolute",top:"28vh",display:"flex",flexDirection:"row",justifyContent:"center",width:"100%",margin:"0 auto",gap:"4vh"},children:[X(c0,{label:X("div",{children:"Population"}),value:s.Population,status:s["Population description"],color:"#FF3B29"}),X(c0,{label:X("div",{children:"Population density"}),value:s["Population density"]+" people/ha",status:s["Population density description"],color:"#FF3B29"}),X(c0,{label:X("div",{children:"Mean salary"}),value:s["Mean salary"]+" PPP$",status:s["Mean salary description"],color:"#FF3B29"}),X(c0,{label:$e("div",{children:["Poverty headcount ratio ",X("br",{})," at national poverty lines"]}),value:d+"of population",status:s["Poverty headcount ratio at national poverty lines description"],color:"#A0DA8B"}),X(c0,{label:$e("div",{children:["Literacy rate among ",X("br",{}),"population (15-24 Years)"]}),value:p,status:s["Literacy rate among population description"],color:"#A0DA8B"}),X(c0,{label:X("div",{children:"Climate"}),value:l,status:s["Climate description"],color:"#2D67FF"})]}),$e("div",{className:o.bottomWrapper,children:[X("div",{}),X("div",{style:{position:"absolute",width:"100%",display:"flex",flexDirection:"row",justifyContent:"center",gap:"1.6vh"},children:s.images.map((f,y)=>X(GJ,{bgUrl:f,onClick:()=>{i(y)},isActive:e===y},y))}),$e("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",gap:"10vh",fontSize:"1.7vh",fontFamily:"SuisseIntl-Light"},children:[X("a",{children:$e("div",{style:{pointerEvents:"all",color:"#fff",cursor:"pointer",textDecoration:"underline"},children:["Become our reporter",X("br",{}),"Suggest another image"]})}),$e(xr,{style:{pointerEvents:"all",color:"#fff",backgroundColor:"#2D67FF",borderRadius:50,padding:"1vh 2.5vh",textTransform:"none",fontFamily:"SuisseIntl-Light",fontSize:"1.7vh",display:"flex",flexDirection:"row",justifyContent:"center",gap:"1.2vh"},onClick:()=>{const f=s.pdfName,y=document.createElement("a");y.href=`/pdf/${f}`,y.download=f,y.click()},children:[X("div",{children:"Download report"}),X("img",{src:"/assets/downloadIcon.svg",alt:"arrow down"})]})]})]})]})})]})]})},RI=({children:n,side:e,setHoveredSide:i,setClickedCategory:o})=>{const[s,l]=ie.useState(!1);return $e("div",{onMouseEnter:()=>{l(!0),i(e)},onMouseLeave:()=>{l(!1),i(null)},style:{border:s?"1px solid #fff":"none",position:"absolute",backgroundImage:"url(/assets/cube_solid_bg.png)",backgroundRepeat:"no-repeat",backgroundSize:"cover",backgroundPosition:"center",height:e==="top"?"40.6vh":"45vh",width:e==="top"?"45.6vh":"45vh",padding:"2vh 1vh",boxSizing:"border-box",top:e==="left"?"40vh":e==="right"?"40.1vh":"16.4vh",right:e==="left"?"55.1vh":e==="right"?"24.9vh":"39.7vh",transform:e==="left"?"skew(0deg, 35.5deg) scale(0.67)":e==="right"?"skew(0deg, -35.5deg) scale(0.67)":"rotate3d(1.1, 0.7, 1.2, -63.7deg)"},children:[n,X("div",{style:{position:"absolute",bottom:"2vh",right:"2vh",fontFamily:"SuisseIntl-Light",fontSize:"2vh",opacity:s?1:.7},children:e==="left"?"Environment":e==="right"?"Governmental":"Social"})]})},kI=({title:n,color:e,setClickedCategory:i})=>{const[o,s]=ie.useState(!1);return X("div",{onClick:()=>{i(n)},onMouseOver:()=>{s(!0)},onMouseOut:()=>{s(!1)},style:{cursor:"pointer",fontFamily:"SuisseIntl-Light",fontSize:"2.1vh",color:"#fff"},children:$e("div",{style:{width:"fit-content",height:"fit-content",backgroundColor:o?e:"transparent",borderRadius:"32px",display:"flex",alignItems:"center",flexDirection:"row",padding:".6vh 2vh",gap:"1.5vh"},children:[X("div",{children:n}),X("div",{style:{width:"2vh",height:"2vh",backgroundColor:o?"#fff":e,borderRadius:"50%"}})]})})},DI=[{City:"Dubai",Country:"UAE","Urban Resilience Index":"A-3",Environmental:4,Social:4,Governmental:4,"Air pollution":2,"Water pollution":4,"Land use and waste":5,"Natural disaster hazards":5,"Water availability":4,"Food availability":5,"Energy availability":4,Health:4,Education:5,Wealth:5,Safety:5,Livability:5,Transport:5,Inclusion:2,Accountability:5,"City budget":4,SME:4,"Public services":5,"Sustainability commitment":5},{City:"Expo City Dubai",Country:"UAE","Urban Resilience Index":"A-2",Environmental:4,Social:4,Governmental:4,"Air pollution":2,"Water pollution":4,"Land use and waste":4,"Natural disaster hazards":5,"Water availability":4,"Food availability":5,"Energy availability":4,Health:4,Education:5,Wealth:5,Safety:5,Livability:5,Transport:5,Inclusion:2,Accountability:5,"City budget":4,SME:4,"Public services":5,"Sustainability commitment":5},{City:"Valparaiso",Country:"Chile","Urban Resilience Index":"C-1",Environmental:2,Social:2,Governmental:2,"Air pollution":2,"Water pollution":4,"Land use and waste":3,"Natural disaster hazards":5,"Water availability":3,"Food availability":4,"Energy availability":5,Health:3,Education:3,Wealth:3,Safety:2,Livability:2,Transport:2,Inclusion:4,Accountability:1,"City budget":3,SME:1,"Public services":5,"Sustainability commitment":5},{City:"Dar es Salaam",Country:"Tanzania","Urban Resilience Index":"C-2",Environmental:2,Social:2,Governmental:2,"Air pollution":3,"Water pollution":1,"Land use and waste":2,"Natural disaster hazards":4,"Water availability":2,"Food availability":4,"Energy availability":3,Health:2,Education:2,Wealth:2,Safety:2,Livability:2,Transport:2,Inclusion:4,Accountability:3,"City budget":3,SME:2,"Public services":3,"Sustainability commitment":3},{City:"Adoni",Country:"India","Urban Resilience Index":"C-2",Environmental:2,Social:1,Governmental:2,"Air pollution":3,"Water pollution":2,"Land use and waste":4,"Natural disaster hazards":4,"Water availability":4,"Food availability":3,"Energy availability":4,Health:2,Education:2,Wealth:2,Safety:1,Livability:2,Transport:2,Inclusion:4,Accountability:1,"City budget":4,SME:2,"Public services":5,"Sustainability commitment":5},{City:"Natal",Country:"Brazil","Urban Resilience Index":"B-2",Environmental:3,Social:3,Governmental:3,"Air pollution":4,"Water pollution":3,"Land use and waste":5,"Natural disaster hazards":4,"Water availability":3,"Food availability":3,"Energy availability":3,Health:3,Education:3,Wealth:3,Safety:1,Livability:3,Transport:3,Inclusion:3,Accountability:1,"City budget":4,SME:2,"Public services":3,"Sustainability commitment":3},{City:"Brazzaville",Country:"Congo","Urban Resilience Index":"C-1",Environmental:3,Social:1,Governmental:3,"Air pollution":4,"Water pollution":1,"Land use and waste":3,"Natural disaster hazards":4,"Water availability":4,"Food availability":2,"Energy availability":3,Health:1,Education:3,Wealth:2,Safety:1,Livability:3,Transport:3,Inclusion:1,Accountability:1,"City budget":1,SME:1,"Public services":3,"Sustainability commitment":3},{City:"Almaty",Country:"Kazakhstan","Urban Resilience Index":"B-1",Environmental:3,Social:4,Governmental:3,"Air pollution":4,"Water pollution":3,"Land use and waste":5,"Natural disaster hazards":5,"Water availability":5,"Food availability":4,"Energy availability":4,Health:5,Education:4,Wealth:4,Safety:4,Livability:4,Transport:4,Inclusion:2,Accountability:3,"City budget":4,SME:4,"Public services":5,"Sustainability commitment":5},{City:"Cape Town",Country:"South Africa","Urban Resilience Index":"B-2",Environmental:3,Social:3,Governmental:4,"Air pollution":4,"Water pollution":2,"Land use and waste":2,"Natural disaster hazards":4,"Water availability":2,"Food availability":2,"Energy availability":2,Health:1,Education:3,Wealth:3,Safety:2,Livability:3,Transport:4,Inclusion:4,Accountability:4,"City budget":2,SME:3,"Public services":4,"Sustainability commitment":5},{City:"Mexico City",Country:"Mexico","Urban Resilience Index":"C-2",Environmental:2,Social:2,Governmental:2,"Air pollution":1,"Water pollution":1,"Land use and waste":3,"Natural disaster hazards":"Low ","Water availability":3,"Food availability":1,"Energy availability":3,Health:3,Education:3,Wealth:3,Safety:1,Livability:2,Transport:2,Inclusion:1,Accountability:2,"City budget":2,SME:2,"Public services":3,"Sustainability commitment":2},{City:"Jakarta",Country:"Indonesia","Urban Resilience Index":"B-3",Environmental:2,Social:3,Governmental:3,"Air pollution":1,"Water pollution":3,"Land use and waste":3,"Natural disaster hazards":"Low ","Water availability":3,"Food availability":2,"Energy availability":3,Health:2,Education:2,Wealth:2,Safety:4,Livability:3,Transport:3,Inclusion:2,Accountability:5,"City budget":2,SME:4,"Public services":3,"Sustainability commitment":3},{City:"Panama City",Country:"Panama","Urban Resilience Index":"B-1",Environmental:3,Social:4,Governmental:3,"Air pollution":3,"Water pollution":4,"Land use and waste":4,"Natural disaster hazards":3,"Water availability":4,"Food availability":4,"Energy availability":5,Health:4,Education:1,Wealth:2,Safety:4,Livability:2,Transport:3,Inclusion:3,Accountability:3,"City budget":3,SME:2,"Public services":4,"Sustainability commitment":4},{City:"Amman",Country:"Jordan","Urban Resilience Index":"B-1",Environmental:2,Social:4,Governmental:4,"Air pollution":2,"Water pollution":2,"Land use and waste":3,"Natural disaster hazards":3,"Water availability":4,"Food availability":4,"Energy availability":3,Health:3,Education:3,Wealth:4,Safety:4,Livability:4,Transport:3,Inclusion:2,Accountability:5,"City budget":3,SME:3,"Public services":3,"Sustainability commitment":3},{City:"Bangkok",Country:"Thailand","Urban Resilience Index":"B-3",Environmental:2,Social:3,Governmental:2,"Air pollution":2,"Water pollution":2,"Land use and waste":2,"Natural disaster hazards":2,"Water availability":4,"Food availability":2,"Energy availability":4,Health:4,Education:2,Wealth:3,Safety:5,Livability:3,Transport:2,Inclusion:4,Accountability:2,"City budget":1,SME:5,"Public services":2,"Sustainability commitment":4},{City:"Colombo",Country:"Sri Lanka","Urban Resilience Index":"B-2",Environmental:3,Social:3,Governmental:3,"Air pollution":3,"Water pollution":4,"Land use and waste":2,"Natural disaster hazards":4,"Water availability":3,"Food availability":2,"Energy availability":5,Health:4,Education:1,Wealth:2,Safety:4,Livability:2,Transport:4,Inclusion:3,Accountability:1,"City budget":2,SME:3,"Public services":3,"Sustainability commitment":2}],DA=["#FF3B29","#FF632F","#FF9B3F","#A0DA8B","#35CB00"],OI={left:["Air pollution","Water pollution","Land use and waste","Natural disaster hazards"],right:["Accountability","City budget","SME","Public services","Sustainability commitment"],top:["Water availability","Food availability","Energy availability","Health","Education","Wealth","Safety","Livability","Transport","Inclusion"]},pIe=({setHoveredSide:n,setClickedCategory:e})=>$e("div",{style:{zIndex:1,width:"60vw",height:"100vh",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",display:"flex",alignItems:"center",justifyContent:"center"},children:[X(RI,{side:"left",setHoveredSide:n,children:X("div",{style:{display:"flex",flexDirection:"column",gap:"2vh"},children:OI.left.map(i=>{const s=Kl().City,d=DI.find(f=>f.City===s)[i],p=DA[d-1]?DA[d-1]:"#FF632F";return X(kI,{title:i,color:p,setClickedCategory:e},i)})})}),X(RI,{side:"right",setHoveredSide:n,setClickedCategory:e,children:X("div",{style:{display:"flex",flexDirection:"column",gap:"2vh"},children:OI.right.map(i=>{const s=Kl().City,d=DI.find(p=>p.City===s)[i];return X(kI,{title:i,color:DA[d-1],setClickedCategory:e},i)})})}),X(RI,{side:"top",setHoveredSide:n,setClickedCategory:e,children:X("div",{style:{display:"flex",flexDirection:"column",gap:"-1vh"},children:OI.top.map(i=>{const s=Kl().City,d=DI.find(p=>p.City===s)[i];return X(kI,{title:i,color:DA[d-1],setClickedCategory:e},i)})})})]}),fIe=({clickedCategory:n,setClickedCategory:e,setTablePopupOpen:i})=>{const{classes:o}=C_(),[s,l]=ie.useState(null),[d,p]=ie.useState(null),f=Kl();return ie.useEffect(()=>{const y=$Me.find(T=>T.city===f.City),_=y.E,x=y.S,S=y.G;p(s==="left"?_:s==="top"?x:s==="right"?S:null)},[s]),X(_s,{children:X("div",{style:{position:"relative",backgroundImage:"url(/assets/new_bg_cube.png)",backgroundSize:"cover",backgroundRepeat:"no-repeat",backgroundPosition:"center"},children:$e("div",{className:o.root,children:[X(pIe,{setHoveredSide:l,setClickedCategory:e}),$e("div",{className:o.contentWrapper,children:[$e("div",{style:{position:"absolute",top:"15.5%",left:"9vh",display:"flex",flexDirection:"column"},children:[$e("div",{style:{fontFamily:"SuisseIntl-Light",fontSize:"6.25vh",color:"#fff",zIndex:1},children:[f.City,": ","",X("br",{}),"Urban ",X("b",{children:"resilience"}),X("br",{}),"index",X("span",{style:{paddingTop:"-1.5vh",verticalAlign:"middle",marginLeft:"1.2vh",fontFamily:"SuisseIntl-Light",fontSize:"3vh",fontWeight:400,marginTop:"1.45vh",textAlign:"center",padding:"1vh 3vh",backgroundColor:pM[f["Urban Resilience Index"].replace("-","")],color:"#fff",borderRadius:50,width:"fit-content"},children:f["Urban Resilience Index"]})]}),X("div",{style:{position:"absolute",top:"25vh",paddingLeft:"2vh",height:"auto",transform:"scale(1.2)"},children:$e("div",{className:o.smallItemsListWrapper,children:[X(uu,{label:"Environmental",status:f.Environmental,style:{fontSize:"2.1vh"}}),X(uu,{label:"Social",status:f.Social,style:{fontSize:"2.1vh"}}),X(uu,{label:"Governmental",status:f.Governmental,style:{fontSize:"2.1vh"}})]})})]}),$e("div",{style:{position:"absolute",top:"33%",lineHeight:"1.5",right:"5vh",width:"30vh",fontFamily:"SuisseIntl-Light",fontSize:"2.1vh"},children:[s==="left"||s==="top"||s==="right"?"Policy hints":"",X("br",{}),X("br",{}),d]}),X("div",{className:o.pageContainer,children:$e("div",{className:o.bottomWrapper,children:[$e("div",{className:o.smallTextWrapper,onClick:()=>{const y="Methodology_v05_AP_BK_v2.pdf",_=document.createElement("a");_.href=`/pdf/${y}`,_.download=y,_.click()},children:[X(Ii,{className:o.smallText,children:"How the rating works"}),X("img",{src:"/assets/questionGray.svg",alt:"hint",style:{opacity:.6}})]}),X(xr,{onClick:()=>{i(!0)},style:{pointerEvents:"all",color:"#fff",backgroundColor:"transparent",border:"1px solid rgba(255, 255, 255, 0.3)",borderRadius:50,padding:"1vh 2.5vh",textTransform:"none",fontFamily:"SuisseIntl-Light",fontSize:"1.7vh",display:"flex",flexDirection:"row",gap:"1.2vh"},children:X("div",{children:"Table view"})}),$e(xr,{style:{pointerEvents:"all",color:"#fff",backgroundColor:"#2D67FF",borderRadius:50,padding:"1vh 2.5vh",textTransform:"none",fontFamily:"SuisseIntl-Light",fontSize:"1.7vh",display:"flex",flexDirection:"row",gap:"1.2vh"},onClick:()=>{const y=f.pdfName,_=document.createElement("a");_.href=`/pdf/${y}`,_.download=y,_.click()},children:[X("div",{children:"Download report"}),X("img",{src:"/assets/downloadIcon.svg",alt:"arrow down"})]})]})})]})]})})})},mIe=({cityData:n,children:e})=>X(UJ.Provider,{value:n,children:e}),gIe=({setMap:n})=>{Ed.accessToken="pk.eyJ1Ijoic3RhbnJvbnpoaW4iLCJhIjoiY2xvaGF3ZmFzMWdodDJxbjByeHMzanE2dCJ9.3uz_EG8N_d7isS1h5wV46w";const e=ie.useRef(null),i=ie.useRef(null);return ie.useEffect(()=>{i.current||!e.current||(i.current=new Ed.Map({attributionControl:!1,container:e.current,style:"mapbox://styles/stanronzhin/cloycy6uc012f01qye3qz7lc4",center:[55.28314923749909,25.02940197161118],zoom:10.5,bearing:0,pitch:60}),i.current.on("load",()=>{i.current.scrollZoom.disable(),i.current.addSource("build_up",{type:"raster",url:"mapbox://stanronzhin.bly9vkw2"}),i.current.addLayer({id:"Build up",source:"build_up",type:"raster",paint:{"raster-opacity":.8,"raster-fade-duration":500},layout:{visibility:"none"}},"land-structure-line"),i.current.addSource("pop_raster",{type:"raster",url:"mapbox://stanronzhin.3wcn7mfu"}),i.current.addLayer({id:"Population 2D",source:"pop_raster",type:"raster",paint:{"raster-opacity":1,"raster-fade-duration":500},layout:{visibility:"none"}},"land-structure-line"),i.current.addSource("pop_bars",{type:"vector",url:"mapbox://stanronzhin.6j7olk89"}),i.current.addLayer({id:"Population 3D",type:"fill-extrusion",source:"pop_bars","source-layer":"Dubai_Population_Bars_NO2_SO2-cpdzjb",layout:{visibility:"none"},paint:{"fill-extrusion-height":["get","Population"],"fill-extrusion-vertical-scale":2,"fill-extrusion-color":["interpolate",["linear"],["get","Population"],1,"#fefefe",12196,"#828282"],"fill-extrusion-opacity":.9}},"expo-city-dubai-label"),i.current.addLayer({id:"Population 3D x SO2",type:"fill-extrusion",source:"pop_bars","source-layer":"Dubai_Population_Bars_NO2_SO2-cpdzjb",layout:{visibility:"none"},paint:{"fill-extrusion-height":["get","Population"],"fill-extrusion-vertical-scale":2,"fill-extrusion-color":["interpolate",["linear"],["get","SO2_mean"],2.109820365905762,"#000004",5.94,"#50127b",9.78,"#b6377a",13.62,"#fb8761",17.892879486083984,"#fcfdbf"],"fill-extrusion-opacity":.9}},"expo-city-dubai-label"),i.current.addLayer({id:"Population 3D x NO2",type:"fill-extrusion",source:"pop_bars","source-layer":"Dubai_Population_Bars_NO2_SO2-cpdzjb",layout:{visibility:"none"},paint:{"fill-extrusion-height":["get","Population"],"fill-extrusion-vertical-scale":2,"fill-extrusion-color":["interpolate",["linear"],["get","No2_mean"],1.002105474472046,"#440154",4,"#3b528b",7,"#21908d",10,"#5dc963",12.314108322964207,"#fde725"],"fill-extrusion-opacity":.9}},"expo-city-dubai-label"),i.current.addLayer({id:"Population 3D x O3",type:"fill-extrusion",source:"pop_bars","source-layer":"Dubai_Population_Bars_NO2_SO2-cpdzjb",layout:{visibility:"none"},paint:{"fill-extrusion-height":["get","Population"],"fill-extrusion-vertical-scale":2,"fill-extrusion-color":["interpolate",["linear"],["get","O3_mean"],5989.198242187499,"#edf8fb",6005,"#b2e2e2",6021,"#66c2a4",6037.02,"#2ca25f",6053.04296875,"#006d2c"],"fill-extrusion-opacity":.9}},"expo-city-dubai-label"),i.current.addLayer({id:"Population 3D x CO",type:"fill-extrusion",source:"pop_bars","source-layer":"Dubai_Population_Bars_NO2_SO2-cpdzjb",layout:{visibility:"none"},paint:{"fill-extrusion-height":["get","Population"],"fill-extrusion-vertical-scale":2,"fill-extrusion-color":["interpolate",["linear"],["get","CO_mean"],781,"#f6eff7",862.3,"#d0d6e8",925.4,"#a0bedb",939,"#67a9cf",953,"#3598ab",965,"#138484",998.3495483398436,"#016c59"],"fill-extrusion-opacity":.9}},"expo-city-dubai-label"),i.current.addLayer({id:"Population 3D x PM10",type:"fill-extrusion",source:"pop_bars","source-layer":"Dubai_Population_Bars_NO2_SO2-cpdzjb",layout:{visibility:"none"},paint:{"fill-extrusion-height":["get","Population"],"fill-extrusion-vertical-scale":2,"fill-extrusion-color":["interpolate",["linear"],["get","UV_mean"],.703,"#cfcfcf",.85,"#b1b0af",1.1,"#a79e75",1.16,"#c5b56c",1.32,"#e5d05a",1.479856308970643,"#ffea46"],"fill-extrusion-opacity":.9}},"expo-city-dubai-label"),i.current.addSource("SO2",{type:"raster",url:"mapbox://stanronzhin.45878sao"}),i.current.addLayer({id:"SO2 2D",type:"raster",paint:{"raster-opacity":.8,"raster-fade-duration":500},layout:{visibility:"none"},source:"SO2"},"land-structure-line"),i.current.addSource("NO2",{type:"raster",url:"mapbox://stanronzhin.cazbwhrj"}),i.current.addLayer({id:"NO2 2D",type:"raster",paint:{"raster-opacity":.8,"raster-fade-duration":500},layout:{visibility:"none"},source:"NO2"},"land-structure-line"),i.current.addSource("O3",{type:"raster",url:"mapbox://stanronzhin.cbntwjd4"}),i.current.addLayer({id:"O3 2D",type:"raster",paint:{"raster-opacity":.8,"raster-fade-duration":500},layout:{visibility:"none"},source:"O3"},"land-structure-line"),i.current.addSource("CO",{type:"raster",url:"mapbox://stanronzhin.446ij1ot"}),i.current.addLayer({id:"CO 2D",type:"raster",paint:{"raster-opacity":.8,"raster-fade-duration":500},layout:{visibility:"none"},source:"CO"},"land-structure-line"),i.current.addSource("PM10",{type:"raster",url:"mapbox://stanronzhin.a1bmhhk8"}),i.current.addLayer({id:"PM10 2D",type:"raster",paint:{"raster-opacity":.8,"raster-fade-duration":500},layout:{visibility:"none"},source:"PM10"},"land-structure-line"),i.current.addSource("schools",{type:"vector",url:"mapbox://stanronzhin.862v1tre"}),i.current.addLayer({id:"Schools",source:"schools","source-layer":"Schools_Dubai_DarEsSalaam_shp-2dp8hn",minzoom:0,maxzoom:22,type:"circle",layout:{visibility:"none"},paint:{"circle-color":"#00ff91","circle-radius":2,"circle-stroke-color":"#75ffd6","circle-stroke-width":1}}),i.current.addSource("sa_schools",{type:"vector",url:"mapbox://stanronzhin.db4zco7s"}),i.current.addLayer({id:"School service areas",source:"sa_schools","source-layer":"Schools_Service_Areas_Dubai_D-dcr4b6",minzoom:0,maxzoom:22,type:"fill",paint:{"fill-outline-color":"rgba(255, 255, 255, 0)","fill-color":"#00ffda","fill-opacity":.5},layout:{visibility:"none"}},"Schools"),i.current.addSource("transport_stops",{type:"vector",url:"mapbox://stanronzhin.baw4ssp1"}),i.current.addLayer({id:"Transport stops",source:"transport_stops","source-layer":"Transport_stops_Dubai_DarEsSa-2e5jzv",minzoom:0,maxzoom:22,type:"circle",layout:{visibility:"none"},paint:{"circle-color":"#ff00f6","circle-radius":2,"circle-stroke-color":"#ffffff","circle-stroke-width":1}}),i.current.addSource("sa_transport",{type:"vector",url:"mapbox://stanronzhin.ayut4ft2"}),i.current.addLayer({id:"Transport service areas",source:"sa_transport","source-layer":"Transport_Service_Areas_Dubai-8rypml",minzoom:0,maxzoom:22,type:"fill",paint:{"fill-outline-color":"rgba(255, 255, 255, 0)","fill-color":"#e684dc","fill-opacity":.5},layout:{visibility:"none"}}),i.current.addSource("parks",{type:"vector",url:"mapbox://stanronzhin.bberinf0"}),i.current.addLayer({id:"Parks",source:"parks","source-layer":"Parks_Dubai_DarEsSalaam_shp-4ar5jy",minzoom:0,maxzoom:22,type:"fill",paint:{"fill-color":"#00db63"},layout:{visibility:"none"}}),i.current.addSource("sa_parks",{type:"vector",url:"mapbox://stanronzhin.5g64w2gy"}),i.current.addLayer({id:"Parks service area",source:"sa_parks","source-layer":"Parks_Service_Areas_Dubai_Dar-3u1qpp",minzoom:0,maxzoom:22,type:"fill",paint:{"fill-color":"#00ddd0"},layout:{visibility:"none"}},"Parks"),i.current.addSource("water",{type:"raster",url:"mapbox://stanronzhin.87imwe7u"}),i.current.addLayer({id:"Fresh water",source:"water",type:"raster",paint:{"raster-opacity":.8,"raster-fade-duration":500},layout:{visibility:"none"}}),i.current.addSource("damagedLand",{type:"raster",url:"mapbox://stanronzhin.ddx873qu"}),i.current.addLayer({id:"Damaged land",source:"damagedLand",type:"raster",paint:{"raster-opacity":.8,"raster-fade-duration":500},layout:{visibility:"none"}}),i.current.addSource("green_areas",{type:"raster",url:"mapbox://stanronzhin.d77lnwg2"}),i.current.addLayer({id:"Green areas",type:"raster",paint:{"raster-opacity":.8,"raster-fade-duration":500},layout:{visibility:"none"},source:"green_areas"},"land-structure-line")}),i.current.on("idle",()=>{if(!i.current.getLayer("Build up")||!i.current.getLayer("Population 2D")||!i.current.getLayer("Population 3D x SO2")||!i.current.getLayer("Population 3D x NO2")||!i.current.getLayer("Population 3D x O3")||!i.current.getLayer("Population 3D x CO")||!i.current.getLayer("Population 3D x PM10")||!i.current.getLayer("SO2 2D")||!i.current.getLayer("NO2 2D")||!i.current.getLayer("O3 2D")||!i.current.getLayer("CO 2D")||!i.current.getLayer("PM10 2D")||!i.current.getLayer("Schools")||!i.current.getLayer("School service areas")||!i.current.getLayer("Transport stops")||!i.current.getLayer("Transport service areas")||!i.current.getLayer("Parks")||!i.current.getLayer("Parks service area")||!i.current.getLayer("Fresh water")||!i.current.getLayer("Damaged land")||!i.current.getLayer("Green areas")||!i.current.getLayer("urban cluster")||!i.current.getLayer("Population 3D"))return;const o=["Build up","Population 2D","Population 3D","Population 3D x SO2","Population 3D x NO2","Population 3D x O3","Population 3D x CO","Population 3D x PM10","SO2 2D","NO2 2D","O3 2D","CO 2D","PM10 2D","Schools","School service areas","Transport stops","Transport service areas","Parks","Parks service area","Fresh water","Damaged land","Green areas","urban cluster"];for(const s of o){if(document.getElementById(s))continue;const l=document.createElement("a");l.id=s,l.href="#",l.textContent=s,l.className="active",l.onclick=function(p){const f=this.textContent;p.preventDefault(),p.stopPropagation(),i.getLayoutProperty(f,"visibility")==="none"?(i.current.setLayoutProperty(f,"visibility","visible"),this.className=""):(this.className="active",i.current.setLayoutProperty(f,"visibility","none"))},document.getElementById("menu").appendChild(l)}}),n(i.current))},[]),X("div",{ref:e,style:{position:"absolute",top:0,left:0,width:"100%",height:"100%"}})},yIe=({children:n})=>X("div",{style:{position:"relative",height:"100%",width:"100%",backgroundColor:"#fff"},children:n}),vIe=({children:n})=>X("div",{style:{position:"absolute",left:"10vh",top:"15vh",zIndex:1},children:n}),_Ie=pr()({title:{fontFamily:"SuisseIntl-Light",fontSize:"6.25vh",color:"#000"},subTitle:{fontFamily:"SuisseIntl-Light",fontSize:"2vh",color:"#000",maxWidth:"30vh",marginTop:"3vh"}}),bIe=pr()({root:{backgroundColor:"#fff",padding:"2vh 2vh",borderRadius:20,marginTop:"3vh",display:"flex",flexDirection:"column",gap:"2vh",width:"fit-content"},populationWrapper:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between"}}),qH=({label:n,isTitle:e,isActive:i,onClick:o})=>{const[s,l]=ie.useState(!1);return X("button",{onClick:o,onMouseOut:()=>!e&&l(!1),onMouseOver:()=>!e&&l(!0),style:{cursor:s?"pointer":"default",fontFamily:s||i?"SuisseIntl-Regular":"SuisseIntl-Light",fontWeight:s||i?600:400,backgroundColor:"#fff",color:i?"#2D67FF":"#000",border:"none",textAlign:"left"},children:$e("div",{style:{pointerEvents:"all",position:"relative",fontSize:"1.8vh",width:"100%"},children:[n,n==="Population"&&X(O0e,{checked:i})]})})},xIe={buildUp:{label:"Build up",mapboxId:"Build up",legendSvgUrl:"/legends/builtupAreas.svg",order:1,align:"left"},population2D:{label:"Population 2D",mapboxId:"Population 2D",legendSvgUrl:"/legends/population2d.svg",order:2,align:"left"},population3D:{label:"Population 3D",mapboxId:"Population 3D",order:3,align:"left"},population3DxSO2:{label:"Population 3D x SO2",mapboxId:"Population 3D x SO2",legendSvgUrl:"/legends/population3dxso2.svg",order:14,align:"right"},population3DxNO2:{label:"Population 3D x NO2",mapboxId:"Population 3D x NO2",legendSvgUrl:"/legends/population3dxno2.svg",order:15,align:"right"},population3DxO3:{label:"Population 3D x O3",mapboxId:"Population 3D x O3",legendSvgUrl:"/legends/population3dxo3.svg",order:16,align:"right"},population3DxCO:{label:"Population 3D x CO",mapboxId:"Population 3D x CO",legendSvgUrl:"/legends/population3dxco.svg",order:17,align:"right"},population3DxPM10:{label:"Population 3D x PM10",mapboxId:"Population 3D x PM10",legendSvgUrl:"/legends/population3dxpm10.svg",order:18,align:"right"},so2:{label:"SO2 2D",mapboxId:"SO2 2D",legendSvgUrl:"/legends/so2.svg",order:19,align:"right"},no2:{label:"NO2 2D",mapboxId:"NO2 2D",legendSvgUrl:"/legends/no2.svg",order:20,align:"right"},o3:{label:"O3 2D",mapboxId:"O3 2D",legendSvgUrl:"/legends/o3.svg",order:21,align:"right"},co:{label:"CO 2D",mapboxId:"CO 2D",legendSvgUrl:"/legends/co.svg",order:22,align:"right"},pm10:{label:"PM10 2D",mapboxId:"PM10 2D",legendSvgUrl:"/legends/pm10.svg",order:23,align:"right"},schools:{label:"Schools",mapboxId:"Schools",order:4,align:"left"},schoolsServiceAreas:{label:"School service areas",mapboxId:"School service areas",legendText:"The 1 kilometre service area is an area where at least one park can be reached in a distance of less than one kilometre.",order:5,align:"left"},transportStops:{label:"Transport stops",mapboxId:"Transport stops",order:6,align:"left"},transportServiceAreas:{label:"Transport service areas",mapboxId:"Transport service areas",legendText:"The 1 kilometre service area is an area where at least one transport stop can be reached in a distance of less than one kilometre.",order:7,align:"left"},parks:{label:"Parks",mapboxId:"Parks",order:8,align:"left"},parksServiceArea:{label:"Parks service area",mapboxId:"Parks service area",legendText:"The 1 kilometre service area is an area where at least one park can be reached in a distance of less than one kilometre.",order:9,align:"left"},freshWater:{label:"Fresh water",mapboxId:"Fresh water",order:10,align:"left"},damagedLand:{label:"Damaged land",mapboxId:"Damaged land",order:11,align:"left"},greenAreas:{label:"Green areas",mapboxId:"Green areas",order:12,align:"left"}},wIe={buildUp:{label:"Build up",mapboxId:"Build up",legendSvgUrl:"/legends/buildupAreasDarEsSalaam.svg",order:1,align:"left"},population2D:{label:"Population 2D",mapboxId:"Population 2D",legendSvgUrl:"/legends/population2dDarEsSalam.svg",order:2,align:"left"},population3D:{label:"Population 3D",mapboxId:"Population 3D",order:3,align:"left"},schools:{label:"Schools",mapboxId:"Schools",order:4,align:"left"},schoolsServiceAreas:{label:"School service areas",mapboxId:"School service areas",legendText:"The 1 kilometre service area is an area where at least one park can be reached in a distance of less than one kilometre.",order:5,align:"left"},transportStops:{label:"Transport stops",mapboxId:"Transport stops",order:6,align:"left"},transportServiceAreas:{label:"Transport service areas",mapboxId:"Transport service areas",legendText:"The 1 kilometre service area is an area where at least one transport stop can be reached in a distance of less than one kilometre.",order:7,align:"left"},freshWater:{label:"Fresh water",mapboxId:"Fresh water",order:8,align:"left"},damagedLand:{label:"Damaged land",mapboxId:"Damaged land",order:9,align:"left"},greenAreas:{label:"Green areas",mapboxId:"Green areas",order:10,align:"left"},population3DxSO2:{label:"Population 3D x SO2",mapboxId:"Population 3D x SO2",legendSvgUrl:"/legends/population3dxso2DarEsSalam.svg",order:14,align:"right"},population3DxNO2:{label:"Population 3D x NO2",mapboxId:"Population 3D x NO2",legendSvgUrl:"/legends/population3dxno2DarEsSalam.svg",order:15,align:"right"},population3DxO3:{label:"Population 3D x O3",mapboxId:"Population 3D x O3",legendSvgUrl:"/legends/population3dxo3DarEsSalam.svg",order:16,align:"right"},population3DxCO:{label:"Population 3D x CO",mapboxId:"Population 3D x CO",legendSvgUrl:"/legends/population3dxcoDarEsSalam.svg",order:17,align:"right"},population3DxPM10:{label:"Population 3D x PM10",mapboxId:"Population 3D x PM10",legendSvgUrl:"/legends/population3dxpm10DarEsSalam.svg",order:18,align:"right"},so2:{label:"SO2 2D",mapboxId:"SO2 2D",legendSvgUrl:"/legends/so2DarEsSalam.svg",order:19,align:"right"},no2:{label:"NO2 2D",mapboxId:"NO2 2D",legendSvgUrl:"/legends/no2DarEsSalam.svg",order:20,align:"right"},o3:{label:"O3 2D",mapboxId:"O3 2D",legendSvgUrl:"/legends/o3DarEsSalam.svg",order:21,align:"right"},co:{label:"CO 2D",mapboxId:"CO 2D",legendSvgUrl:"/legends/coDarEsSalam.svg",order:22,align:"right"},pm10:{label:"PM10 2D",mapboxId:"PM10 2D",legendSvgUrl:"/legends/pm10DarEsSalam.svg",order:23,align:"right"}},SIe=({map:n,setLegend:e})=>{const{classes:i}=bIe(),[o,s]=ie.useState({}),p=Kl().City==="Dubai"?xIe:wIe;ie.useEffect(()=>{n&&Object.keys(o).forEach(_=>{n.setLayoutProperty(_,"visibility",o[_]?"visible":"none")})},[o]);const f=Object.keys(p).filter(_=>p[_].align==="left"),y=Object.keys(p).filter(_=>p[_].align==="right");return X("div",{className:i.root,children:$e("div",{style:{display:"flex",flexDirection:"row",gap:"2vh"},children:[X("div",{style:{display:"flex",flexDirection:"column",gap:"1vh"},children:f.map(_=>{const x=p[_],{label:S,mapboxId:T,order:I}=x,R=o[T];return X(qH,{label:S,isActive:R,onClick:()=>{const D=Object.keys(o).reduce((L,O)=>(L[O]=!1,L),{});s({...D,[T]:!R}),e(x.legendSvgUrl?x.legendSvgUrl:x.legendText?x.legendText:null)}},T)})}),X("div",{style:{display:"flex",flexDirection:"column",gap:"1vh"},children:y.map(_=>{const x=p[_],{label:S,mapboxId:T,order:I}=x,R=o[T];return X(qH,{label:S,isActive:R,onClick:()=>{const D=Object.keys(o).reduce((L,O)=>(L[O]=!1,L),{});s({...D,[T]:!R}),e(x.legendSvgUrl||null)}},T)})})]})})},AIe=({map:n})=>$e("div",{style:{userSelect:"none",position:"relative",zIndex:2,height:"10.5vh",width:"4.7vh",display:"flex",flexDirection:"column",backgroundColor:"#fff",borderRadius:"50px",overflow:"hidden",padding:0,margin:0,pointerEvents:"all"},children:[X("div",{onClick:()=>{n&&n.zoomIn()},style:{userSelect:"none",cursor:"pointer",height:"50%",display:"flex",justifyContent:"center",alignItems:"center",backgroundColor:"#fff",borderRadius:"50px",overflow:"hidden",padding:0,margin:0},children:X("img",{style:{userSelect:"none"},src:"/assets/plusIcon.svg",width:"45%",alt:"zoom in"})}),X("div",{onClick:()=>{if(!n)return;n.getZoom()>10.5&&n.zoomOut()},style:{cursor:"pointer",height:"50%",display:"flex",justifyContent:"center",alignItems:"center",backgroundColor:"#fff",borderRadius:"50px",overflow:"hidden",padding:0,margin:0,userSelect:"none"},children:X("img",{src:"/assets/minusIcon.svg",width:"45%",alt:"zoom out"})})]}),EIe=({setMap:n})=>{Ed.accessToken="pk.eyJ1Ijoic3RhbnJvbnpoaW4iLCJhIjoiY2xvaGF3ZmFzMWdodDJxbjByeHMzanE2dCJ9.3uz_EG8N_d7isS1h5wV46w";const e=ie.useRef(null),i=ie.useRef(null);return ie.useEffect(()=>{i.current||!e.current||(i.current=new Ed.Map({attributionControl:!1,container:e.current,style:"mapbox://styles/stanronzhin/cloycy6uc012f01qye3qz7lc4",center:[39.11395379366985,-6.795093628568665],zoom:9.8,bearing:0,pitch:63}),i.current.on("load",()=>{i.current.scrollZoom.disable(),i.current.addSource("build_up",{type:"raster",url:"mapbox://stanronzhin.dpou9n43"}),i.current.addLayer({id:"Build up",source:"build_up",type:"raster",paint:{"raster-opacity":.8,"raster-fade-duration":500},layout:{visibility:"none"}},"land-structure-line"),i.current.addSource("pop_raster",{type:"raster",url:"mapbox://stanronzhin.8brf2wm2"}),i.current.addLayer({id:"Population 2D",source:"pop_raster",type:"raster",paint:{"raster-opacity":1,"raster-fade-duration":500},layout:{visibility:"none"}},"land-structure-line"),i.current.addSource("pop_bars",{type:"vector",url:"mapbox://stanronzhin.2xkqu3zj"}),i.current.addLayer({id:"Population 3D",type:"fill-extrusion",source:"pop_bars","source-layer":"DarEsSalaam_Population_Bars_N-bf9acs",layout:{visibility:"none"},paint:{"fill-extrusion-height":["get","Population"],"fill-extrusion-vertical-scale":1,"fill-extrusion-color":["interpolate",["linear"],["get","Population"],1,"#fefefe",21877,"#828282"],"fill-extrusion-opacity":.9}},"expo-city-dubai-label"),i.current.addLayer({id:"Population 3D x SO2",type:"fill-extrusion",source:"pop_bars","source-layer":"DarEsSalaam_Population_Bars_N-bf9acs",layout:{visibility:"none"},paint:{"fill-extrusion-height":["get","Population"],"fill-extrusion-vertical-scale":1,"fill-extrusion-color":["interpolate",["linear"],["get","SO2_mean"],0,"#ffffff",1.35,"#570f6e",2.7,"#bb3755",4.05,"#f98d0a",5.358946323394775,"#fcffa4"],"fill-extrusion-opacity":.9}},"expo-city-dubai-label"),i.current.addLayer({id:"Population 3D x NO2",type:"fill-extrusion",source:"pop_bars","source-layer":"DarEsSalaam_Population_Bars_N-bf9acs",layout:{visibility:"none"},paint:{"fill-extrusion-height":["get","Population"],"fill-extrusion-vertical-scale":1,"fill-extrusion-color":["interpolate",["linear"],["get","NO2_mean"],2.05233907699585,"#440154",2.2,"#3b528b",2.4,"#21908d",2.6,"#5dc962",2.772989511489868,"#fde725"],"fill-extrusion-opacity":.9}},"expo-city-dubai-label"),i.current.addLayer({id:"Population 3D x O3",type:"fill-extrusion",source:"pop_bars","source-layer":"DarEsSalaam_Population_Bars_N-bf9acs",layout:{visibility:"none"},paint:{"fill-extrusion-height":["get","Population"],"fill-extrusion-vertical-scale":1,"fill-extrusion-color":["interpolate",["linear"],["get","O3_mean"],5762.0478515625,"#edf8fb",5771.03,"#b2e2e2",5780.02,"#66c2a4",5789.01,"#2ca25f",5797.997504716548,"#006d2c"],"fill-extrusion-opacity":.9}},"expo-city-dubai-label"),i.current.addLayer({id:"Population 3D x CO",type:"fill-extrusion",source:"pop_bars","source-layer":"DarEsSalaam_Population_Bars_N-bf9acs",layout:{visibility:"none"},paint:{"fill-extrusion-height":["get","Population"],"fill-extrusion-vertical-scale":1,"fill-extrusion-color":["interpolate",["linear"],["get","CO_mean"],802.5854707726206,"#f6eff7",821,"#bdc9e1",836,"#67a9cf",851.48,"#1c9099",867.7780797321312,"#016c59"],"fill-extrusion-opacity":.9}},"expo-city-dubai-label"),i.current.addLayer({id:"Population 3D x PM10",type:"fill-extrusion",source:"pop_bars","source-layer":"DarEsSalaam_Population_Bars_N-bf9acs",layout:{visibility:"none"},paint:{"fill-extrusion-height":["get","Population"],"fill-extrusion-vertical-scale":1,"fill-extrusion-color":["interpolate",["linear"],["get","PM10_mean"],-.560415429762831,"#ffffff",-.463,"#f0f0f0",-.365,"#7d7c78",-.268,"#beaf6f",-.170282865193472,"#ffea46"],"fill-extrusion-opacity":.9}},"expo-city-dubai-label"),i.current.addSource("SO2",{type:"raster",url:"mapbox://stanronzhin.8z6owmcr"}),i.current.addLayer({id:"SO2 2D",type:"raster",paint:{"raster-opacity":.8,"raster-fade-duration":500},layout:{visibility:"none"},source:"SO2"},"land-structure-line"),i.current.addSource("NO2",{type:"raster",url:"mapbox://stanronzhin.20jvy6c8"}),i.current.addLayer({id:"NO2 2D",type:"raster",paint:{"raster-opacity":.8,"raster-fade-duration":500},layout:{visibility:"none"},source:"NO2"},"land-structure-line"),i.current.addSource("O3",{type:"raster",url:"mapbox://stanronzhin.76qo6b2w"}),i.current.addLayer({id:"O3 2D",type:"raster",paint:{"raster-opacity":.8,"raster-fade-duration":500},layout:{visibility:"none"},source:"O3"},"land-structure-line"),i.current.addSource("CO",{type:"raster",url:"mapbox://stanronzhin.co2x6sdc"}),i.current.addLayer({id:"CO 2D",type:"raster",paint:{"raster-opacity":.8,"raster-fade-duration":500},layout:{visibility:"none"},source:"CO"},"land-structure-line"),i.current.addSource("PM10",{type:"raster",url:"mapbox://stanronzhin.couih9de"}),i.current.addLayer({id:"PM10 2D",type:"raster",paint:{"raster-opacity":.8,"raster-fade-duration":500},layout:{visibility:"none"},source:"PM10"},"land-structure-line"),i.current.addSource("schools",{type:"vector",url:"mapbox://stanronzhin.862v1tre"}),i.current.addLayer({id:"Schools",source:"schools","source-layer":"Schools_Dubai_DarEsSalaam_shp-2dp8hn",minzoom:0,maxzoom:22,type:"circle",layout:{visibility:"none"},paint:{"circle-color":"#00ff91","circle-radius":2,"circle-stroke-color":"#75ffd6","circle-stroke-width":1}}),i.current.addSource("sa_schools",{type:"vector",url:"mapbox://stanronzhin.db4zco7s"}),i.current.addLayer({id:"School service areas",source:"sa_schools","source-layer":"Schools_Service_Areas_Dubai_D-dcr4b6",minzoom:0,maxzoom:22,type:"fill",paint:{"fill-outline-color":"rgba(255, 255, 255, 0)","fill-color":"#00ffda","fill-opacity":.5},layout:{visibility:"none"}},"Schools"),i.current.addSource("transport_stops",{type:"vector",url:"mapbox://stanronzhin.baw4ssp1"}),i.current.addLayer({id:"Transport stops",source:"transport_stops","source-layer":"Transport_stops_Dubai_DarEsSa-2e5jzv",minzoom:0,maxzoom:22,type:"circle",layout:{visibility:"none"},paint:{"circle-color":"#ff00f6","circle-radius":2,"circle-stroke-color":"#ffffff","circle-stroke-width":1}}),i.current.addSource("sa_transport",{type:"vector",url:"mapbox://stanronzhin.ayut4ft2"}),i.current.addLayer({id:"Transport service areas",source:"sa_transport","source-layer":"Transport_Service_Areas_Dubai-8rypml",minzoom:0,maxzoom:22,type:"fill",paint:{"fill-outline-color":"rgba(255, 255, 255, 0)","fill-color":"#e684dc","fill-opacity":.5},layout:{visibility:"none"}}),i.current.addSource("parks",{type:"vector",url:"mapbox://stanronzhin.bberinf0"}),i.current.addLayer({id:"Parks",source:"parks","source-layer":"Parks_Dubai_DarEsSalaam_shp-4ar5jy",minzoom:0,maxzoom:22,type:"fill",paint:{"fill-color":"#00db63"},layout:{visibility:"none"}}),i.current.addSource("sa_parks",{type:"vector",url:"mapbox://stanronzhin.5g64w2gy"}),i.current.addLayer({id:"Parks service area",source:"sa_parks","source-layer":"Parks_Service_Areas_Dubai_Dar-3u1qpp",minzoom:0,maxzoom:22,type:"fill",paint:{"fill-color":"#00ddd0"},layout:{visibility:"none"}},"Parks"),i.current.addSource("water",{type:"raster",url:"mapbox://stanronzhin.2vtfxzn2"}),i.current.addLayer({id:"Fresh water",source:"water",type:"raster",paint:{"raster-opacity":.8,"raster-fade-duration":500},layout:{visibility:"none"}}),i.current.addSource("damagedLand",{type:"raster",url:"mapbox://stanronzhin.cxu2vccw"}),i.current.addLayer({id:"Damaged land",source:"damagedLand",type:"raster",paint:{"raster-opacity":.8,"raster-fade-duration":500},layout:{visibility:"none"}}),i.current.addSource("green_areas",{type:"raster",url:"mapbox://stanronzhin.8u6mbzcw"}),i.current.addLayer({id:"Green areas",type:"raster",paint:{"raster-opacity":.8,"raster-fade-duration":500},layout:{visibility:"none"},source:"green_areas"},"land-structure-line")}),i.current.on("idle",()=>{if(!i.current.getLayer("Build up")||!i.current.getLayer("Population 2D")||!i.current.getLayer("Population 3D x SO2")||!i.current.getLayer("Population 3D x NO2")||!i.current.getLayer("Population 3D x O3")||!i.current.getLayer("Population 3D x CO")||!i.current.getLayer("Population 3D x PM10")||!i.current.getLayer("SO2 2D")||!i.current.getLayer("NO2 2D")||!i.current.getLayer("O3 2D")||!i.current.getLayer("CO 2D")||!i.current.getLayer("PM10 2D")||!i.current.getLayer("Schools")||!i.current.getLayer("School service areas")||!i.current.getLayer("Transport stops")||!i.current.getLayer("Transport service areas")||!i.current.getLayer("Parks")||!i.current.getLayer("Parks service area")||!i.current.getLayer("Fresh water")||!i.current.getLayer("Damaged land")||!i.current.getLayer("Green areas")||!i.current.getLayer("Population 3D"))return;const o=["Build up","Population 2D","Population 3D","Population 3D x SO2","Population 3D x NO2","Population 3D x O3","Population 3D x CO","Population 3D x PM10","SO2 2D","NO2 2D","O3 2D","CO 2D","PM10 2D","Schools","School service areas","Transport stops","Transport service areas","Parks","Parks service area","Fresh water","Damaged land","Green areas"];for(const s of o){if(document.getElementById(s))continue;const l=document.createElement("a");l.id=s,l.href="#",l.textContent=s,l.className="active",l.onclick=function(p){const f=this.textContent;p.preventDefault(),p.stopPropagation(),i.current.getLayoutProperty(f,"visibility")==="none"?(i.current.setLayoutProperty(f,"visibility","visible"),this.className=""):(this.className="active",i.current.setLayoutProperty(f,"visibility","none"))},document.getElementById("menu").appendChild(l)}}),n(i.current))},[]),X("div",{ref:e,style:{position:"absolute",top:0,left:0,width:"100%",height:"100%"}})},MIe=()=>{const{classes:n}=_Ie(),e=Kl(),[i,o]=ie.useState(null),[s,l]=ie.useState(null),p=Kl().City;return ie.useEffect(()=>{},[s]),$e(yIe,{children:[$e(vIe,{children:[$e("div",{className:n.title,children:[e==null?void 0:e.City,": Geoanalytics"]}),X("img",{src:"/legends/bordersLegend.svg",style:{marginTop:"3vh",width:"30vh"}}),X(SIe,{map:i,setLegend:l})]}),p==="Dubai"&&X(gIe,{setMap:o}),p==="Dar es Salaam"&&X(EIe,{setMap:o}),$e("div",{style:{position:"absolute",bottom:"5vh",right:"5vh",zIndex:1e3,display:"flex",flexDirection:"row",width:"fit-content",gap:"4vh",alignItems:"center"},children:[X(AIe,{map:i}),s&&s.includes("/")?X("img",{src:s}):s&&X("div",{style:{fontFamily:"SuisseIntl-Light",fontSize:"1.8vh",width:"10vw"},children:s})]})]})},TIe=pr()({backgroundWrapper:{position:"absolute",top:0,left:0,backgroundColor:"#0C1F68",width:"100vw",height:"100vh",overflowY:"scroll","&::-webkit-scrollbar":{width:"0em"},zIndex:"1200"},content:{position:"relative",width:"90%",margin:"12vh 5% 5vh",borderRadius:"3vh",overflow:"hidden"},blueSection:{position:"relative",display:"box",width:"100%",height:"100vh",float:"left",background:"#1433AE"},whiteSection:{position:"relative",display:"box",width:"100%",height:"100vh",float:"left",background:"#ffffff"},blackSection:{position:"relative",display:"box",width:"100%",height:"100vh",float:"left",background:"#000000"},returnBack:{position:"absolute",top:"4vh",left:"5%",display:"flex",flexDirection:"row",alignItems:"center",gap:"1vh",cursor:"pointer"},returnBackIcon:{height:"4vh"},returnBackText:{fontFamily:"SuisseIntl-Light",fontWeight:400,color:"#fff",textTransform:"none",fontSize:"1.8vh","&:hover":{backgroundColor:"inherit"}},title:{fontFamily:"SuisseIntl-Regular",fontWeight:400,lineHeight:"9vh",letterSpacing:"-0.2vh",fontSize:"8vh",color:"#fff",width:"100%"}}),CIe=pr()({wrapper:{display:"flex",flexDirection:"row",justifyContent:"space-between",width:"100%",padding:"4vh 8vh",boxSizing:"border-box"},titleWrapper:{width:"50%"},title:{fontFamily:"SuisseIntl-Regular",fontWeight:400,lineHeight:"9vh",letterSpacing:"-0.2vh",fontSize:"8vh",color:"#fff",width:"100%"},subTitle:{fontFamily:"SuisseIntl-Light",fontWeight:200,lineHeight:"9vh",letterSpacing:"-0.2vh",fontSize:"6vh",color:"#fff",width:"100%"},text:{fontFamily:"SuisseIntl-Light",fontWeight:400,lineHeight:"3vh",letterSpacing:"0vh",fontSize:"2vh",color:"#fff",width:"55%",paddingTop:"3vh"}}),PIe=({title:n,text:e})=>{const{classes:i}=CIe();return $e("div",{className:i.wrapper,children:[X("div",{className:i.titleWrapper,children:X(Ii,{className:i.title,children:n})}),X(Ii,{className:i.text,children:e})]})},jJ="label";function XH(n,e){typeof n=="function"?n(e):n&&(n.current=e)}function IIe(n,e){const i=n.options;i&&e&&Object.assign(i,e)}function $J(n,e){n.labels=e}function YJ(n,e){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:jJ;const o=[];n.datasets=e.map(s=>{const l=n.datasets.find(d=>d[i]===s[i]);return!l||!s.data||o.includes(l)?{...s}:(o.push(l),Object.assign(l,s),l)})}function LIe(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:jJ;const i={labels:[],datasets:[]};return $J(i,n.labels),YJ(i,n.datasets,e),i}function RIe(n,e){const{height:i=150,width:o=300,redraw:s=!1,datasetIdKey:l,type:d,data:p,options:f,plugins:y=[],fallbackContent:_,updateMode:x,...S}=n,T=ie.useRef(null),I=ie.useRef(),R=()=>{T.current&&(I.current=new o2(T.current,{type:d,data:LIe(p,l),options:f&&{...f},plugins:y}),XH(e,I.current))},D=()=>{XH(e,null),I.current&&(I.current.destroy(),I.current=null)};return ie.useEffect(()=>{!s&&I.current&&f&&IIe(I.current,f)},[s,f]),ie.useEffect(()=>{!s&&I.current&&$J(I.current.config.data,p.labels)},[s,p.labels]),ie.useEffect(()=>{!s&&I.current&&p.datasets&&YJ(I.current.config.data,p.datasets,l)},[s,p.datasets]),ie.useEffect(()=>{I.current&&(s?(D(),setTimeout(R)):I.current.update(x))},[s,f,p.labels,p.datasets,x]),ie.useEffect(()=>{I.current&&(D(),setTimeout(R))},[d]),ie.useEffect(()=>(R(),()=>D()),[]),X("canvas",{...Object.assign({ref:T,role:"img",height:i,width:o},S),children:_})}const kIe=ie.forwardRef(RIe);function qJ(n,e){return o2.register(e),ie.forwardRef((i,o)=>X(kIe,{...Object.assign({},i,{ref:o,type:n})}))}const XJ=qJ("line",Ex),DIe=qJ("radar",Tx),OIe=n=>{const e=document.createElement("canvas"),i=e.getContext("2d"),o=e.width/2,s=e.height/2,l=15,d=23;return i.beginPath(),i.arc(o,s,l,0,2*Math.PI,!1),i.fillStyle=n,i.fill(),i.beginPath(),i.arc(o,s,d,0,2*Math.PI,!1),i.lineWidth=1,i.strokeStyle=n,i.stroke(),e},NIe=(n,e)=>i=>({responsive:!0,elements:{line:{},point:{radius:23,hoverRadius:23}},scales:{x:{type:"category",labels:i,offset:!0,grid:{display:!1},ticks:{display:!1},border:{color:"rgb(255, 255, 255)"}},y:{type:"category",offset:!0,labels:n,reverse:!0,ticks:{color:e,font:{size:20},padding:10},grid:{color:"rgba(255, 255, 255, 0.15)"},border:{display:!1}}},plugins:{legend:{display:!1},tooltip:{enabled:!1}}}),zIe=(n,e)=>(i,o,s)=>{const l=[i,...o],p=l.map(y=>y[s]).map(y=>n[y-1]),f=y=>{const _=n.indexOf(y);if(_===-1)throw new Error("Invalid value");return e[_]};return{xLabels:l.map(y=>y.City),yLabels:n,datasets:p.map((y,_)=>({label:y,data:new Array(6).fill(null).map((x,S)=>_===S?y:null),pointStyle:OIe(f(y)),showLine:!1}))}};var sO={},ZJ={exports:{}};(function(n){function e(i){return i&&i.__esModule?i:{default:i}}n.exports=e,n.exports.__esModule=!0,n.exports.default=n.exports})(ZJ);var KJ=ZJ.exports,NI={};const FIe=lj(Ppe);var ZH;function JJ(){return ZH||(ZH=1,function(n){"use client";Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"default",{enumerable:!0,get:function(){return e.createSvgIcon}});var e=FIe}(NI)),NI}const QJ=lj(xde);var BIe=KJ;Object.defineProperty(sO,"__esModule",{value:!0});var lO=sO.default=void 0,UIe=BIe(JJ()),WIe=QJ,VIe=(0,UIe.default)((0,WIe.jsx)("path",{d:"M7.41 8.59 12 13.17l4.59-4.58L18 10l-6 6-6-6 1.41-1.41z"}),"KeyboardArrowDown");lO=sO.default=VIe;var cO={},GIe=KJ;Object.defineProperty(cO,"__esModule",{value:!0});var uO=cO.default=void 0,HIe=GIe(JJ()),jIe=QJ,$Ie=(0,HIe.default)((0,jIe.jsx)("path",{d:"M7.41 15.41 12 10.83l4.59 4.58L18 14l-6-6-6 6z"}),"KeyboardArrowUp");uO=cO.default=$Ie;const YIe=({cities:n,value:e,onChange:i})=>{const[o,s]=ie.useState(null),l=!!o,d=f=>{s(f.currentTarget)},p=()=>{s(null)};return $e("div",{style:{width:220,marginTop:0},children:[X(xr,{onClick:d,endIcon:l?X(uO,{}):X(lO,{}),style:{textTransform:"none",color:"#fff",fontSize:"2.5vh",fontWeight:400},children:e}),X(w_,{anchorEl:o,open:l,onClose:p,children:n.map(f=>X(Fg,{selected:f===e,onClick:()=>{p(),i(f)},children:f},f))})]})},qIe=({currentCity:n,selectedCities:e,cities:i,onChange:o})=>$e("div",{style:{display:"flex",textAlign:"center",paddingLeft:93,paddingRight:10,justifyContent:"space-around"},children:[X("div",{style:{width:220,height:35,marginTop:0,display:"flex",justifyContent:"center",alignItems:"center"},children:X("span",{style:{color:"#fff",fontSize:"2.5vh",fontWeight:400,fontFamily:"'Roboto', 'Helvetica', 'Arial', sans-serif"},children:n})}),e.map((s,l)=>X(YIe,{cities:i.filter(d=>!e.includes(d)&&d!==n),value:s,onChange:o(l)},s))]}),XIe=(n,e,i,o)=>{const[s,l]=ie.useState(i.filter(p=>p!==e).map(p=>o.find(f=>f.City===p)).slice(0,5).toSorted((p,f)=>p[n]-f[n]));return[s,p=>f=>{const y=o.find(_=>_.City===f);l(s.map((_,x)=>x===p?y:_).toSorted((_,x)=>_[n]-x[n]))}]},zI=[{City:"Dubai",Country:"UAE","Urban Resilience Index":"A-3",Environmental:4,Social:4,Governmental:4,"Air pollution":2,"Water pollution":4,"Land use and waste":5,"Natural disaster hazards":5,"Water availability":4,"Food availability":5,"Energy availability":4,Health:4,Education:5,Wealth:5,Safety:5,Livability:5,Transport:5,Inclusion:2,Accountability:5,"City budget":4,SME:4,"Public services":5,"Sustainability commitment":5},{City:"Expo City Dubai",Country:"UAE","Urban Resilience Index":"A-2",Environmental:4,Social:4,Governmental:4,"Air pollution":2,"Water pollution":4,"Land use and waste":4,"Natural disaster hazards":5,"Water availability":4,"Food availability":5,"Energy availability":4,Health:4,Education:5,Wealth:5,Safety:5,Livability:5,Transport:5,Inclusion:2,Accountability:5,"City budget":4,SME:4,"Public services":5,"Sustainability commitment":5},{City:"Valparaiso",Country:"Chile","Urban Resilience Index":"C-1",Environmental:2,Social:2,Governmental:2,"Air pollution":2,"Water pollution":4,"Land use and waste":3,"Natural disaster hazards":5,"Water availability":3,"Food availability":4,"Energy availability":5,Health:3,Education:3,Wealth:3,Safety:2,Livability:2,Transport:2,Inclusion:4,Accountability:1,"City budget":3,SME:1,"Public services":5,"Sustainability commitment":5},{City:"Dar es Salaam",Country:"Tanzania","Urban Resilience Index":"C-2",Environmental:2,Social:2,Governmental:2,"Air pollution":3,"Water pollution":1,"Land use and waste":2,"Natural disaster hazards":4,"Water availability":2,"Food availability":4,"Energy availability":3,Health:2,Education:2,Wealth:2,Safety:2,Livability:2,Transport:2,Inclusion:4,Accountability:3,"City budget":3,SME:2,"Public services":3,"Sustainability commitment":3},{City:"Adoni",Country:"India","Urban Resilience Index":"C-2",Environmental:2,Social:1,Governmental:2,"Air pollution":3,"Water pollution":2,"Land use and waste":4,"Natural disaster hazards":4,"Water availability":4,"Food availability":3,"Energy availability":4,Health:2,Education:2,Wealth:2,Safety:1,Livability:2,Transport:2,Inclusion:4,Accountability:1,"City budget":4,SME:2,"Public services":5,"Sustainability commitment":5},{City:"Natal",Country:"Brazil","Urban Resilience Index":"B-2",Environmental:3,Social:3,Governmental:3,"Air pollution":4,"Water pollution":3,"Land use and waste":5,"Natural disaster hazards":4,"Water availability":3,"Food availability":3,"Energy availability":3,Health:3,Education:3,Wealth:3,Safety:1,Livability:3,Transport:3,Inclusion:3,Accountability:1,"City budget":4,SME:2,"Public services":3,"Sustainability commitment":3},{City:"Brazzaville",Country:"Congo","Urban Resilience Index":"C-1",Environmental:3,Social:1,Governmental:3,"Air pollution":4,"Water pollution":1,"Land use and waste":3,"Natural disaster hazards":4,"Water availability":4,"Food availability":2,"Energy availability":3,Health:1,Education:3,Wealth:2,Safety:1,Livability:3,Transport:3,Inclusion:1,Accountability:1,"City budget":1,SME:1,"Public services":3,"Sustainability commitment":3},{City:"Almaty",Country:"Kazakhstan","Urban Resilience Index":"B-1",Environmental:3,Social:4,Governmental:3,"Air pollution":4,"Water pollution":3,"Land use and waste":5,"Natural disaster hazards":5,"Water availability":5,"Food availability":4,"Energy availability":4,Health:5,Education:4,Wealth:4,Safety:4,Livability:4,Transport:4,Inclusion:2,Accountability:3,"City budget":4,SME:4,"Public services":5,"Sustainability commitment":5},{City:"Cape Town",Country:"South Africa","Urban Resilience Index":"B-2",Environmental:3,Social:3,Governmental:4,"Air pollution":4,"Water pollution":2,"Land use and waste":2,"Natural disaster hazards":4,"Water availability":2,"Food availability":2,"Energy availability":2,Health:1,Education:3,Wealth:3,Safety:2,Livability:3,Transport:4,Inclusion:4,Accountability:4,"City budget":2,SME:3,"Public services":4,"Sustainability commitment":5},{City:"Mexico City",Country:"Mexico","Urban Resilience Index":"C-2",Environmental:2,Social:2,Governmental:2,"Air pollution":1,"Water pollution":1,"Land use and waste":3,"Natural disaster hazards":1,"Water availability":3,"Food availability":1,"Energy availability":3,Health:3,Education:3,Wealth:3,Safety:1,Livability:2,Transport:2,Inclusion:1,Accountability:2,"City budget":2,SME:2,"Public services":3,"Sustainability commitment":2},{City:"Jakarta",Country:"Indonesia","Urban Resilience Index":"B-3",Environmental:2,Social:3,Governmental:3,"Air pollution":1,"Water pollution":3,"Land use and waste":3,"Natural disaster hazards":1,"Water availability":3,"Food availability":2,"Energy availability":3,Health:2,Education:2,Wealth:2,Safety:4,Livability:3,Transport:3,Inclusion:2,Accountability:5,"City budget":2,SME:4,"Public services":3,"Sustainability commitment":3},{City:"Panama City",Country:"Panama","Urban Resilience Index":"B-1",Environmental:3,Social:4,Governmental:3,"Air pollution":3,"Water pollution":4,"Land use and waste":4,"Natural disaster hazards":3,"Water availability":4,"Food availability":4,"Energy availability":5,Health:4,Education:1,Wealth:2,Safety:4,Livability:2,Transport:3,Inclusion:3,Accountability:3,"City budget":3,SME:2,"Public services":4,"Sustainability commitment":4},{City:"Amman",Country:"Jordan","Urban Resilience Index":"B-1",Environmental:2,Social:4,Governmental:4,"Air pollution":2,"Water pollution":2,"Land use and waste":3,"Natural disaster hazards":3,"Water availability":4,"Food availability":4,"Energy availability":3,Health:3,Education:3,Wealth:4,Safety:4,Livability:4,Transport:3,Inclusion:2,Accountability:5,"City budget":3,SME:3,"Public services":3,"Sustainability commitment":3},{City:"Bangkok",Country:"Thailand","Urban Resilience Index":"B-3",Environmental:2,Social:3,Governmental:2,"Air pollution":2,"Water pollution":2,"Land use and waste":2,"Natural disaster hazards":1,"Water availability":4,"Food availability":2,"Energy availability":4,Health:4,Education:2,Wealth:3,Safety:5,Livability:3,Transport:2,Inclusion:4,Accountability:2,"City budget":1,SME:5,"Public services":2,"Sustainability commitment":4},{City:"Colombo",Country:"Sri Lanka","Urban Resilience Index":"B-2",Environmental:3,Social:3,Governmental:3,"Air pollution":3,"Water pollution":4,"Land use and waste":2,"Natural disaster hazards":4,"Water availability":3,"Food availability":2,"Energy availability":5,Health:4,Education:1,Wealth:2,Safety:4,Livability:2,Transport:4,Inclusion:3,Accountability:1,"City budget":2,SME:3,"Public services":3,"Sustainability commitment":2}],KH=["Very low","Low","Average","Strong","Very strong"],JH=["#FF3B29","#FF632F","#FF9B3F","#A0DA8B","#35CB00"],ZIe=({currentCity:n,cities:e,category:i})=>{const o=zI.find(f=>f.City===n),[s,l]=XIe(i,n,e,zI),d=NIe(KH,JH)([o,...s].map(f=>f.City)),p=zIe(KH,JH)(o,s,i);return $e("div",{style:{width:"100%",height:"auto",position:"absolute",bottom:"5vh",left:"0"},children:[X(XJ,{width:"1260px",height:"330px",options:d,data:p}),X(qIe,{currentCity:o.City,selectedCities:s.map(f=>f.City),cities:zI.map(f=>f.City),onChange:l})]})},QH=({label:n,color:e,cities:i,position:o,onClick:s})=>{const[l,d]=ie.useState(n),[p,f]=ie.useState(null),y=!!p,_=S=>{f(S.currentTarget)},x=()=>{f(null)};return $e("div",{children:[X(xr,{onClick:_,children:$e("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"},children:[X("div",{style:{width:"1.2vh",height:"1.2vh",borderRadius:"50%",backgroundColor:e,marginRight:"1vh"}}),X("div",{style:{fontFamily:o===0?"SuisseIntl-Regular":"SuisseIntl-Light",fontSize:"3.1vh",fontWeight:600,textAlign:"center",color:o===0?"#2D67FF":"#000",textTransform:"none"},children:l}),o!==0&&X("div",{style:{marginLeft:"1vh"},children:X("img",{src:"/assets/smallArrowDown.svg",alt:"arrow down"})})]})}),X(w_,{id:"demo-positioned-menu","aria-labelledby":"demo-positioned-button",anchorEl:p,open:y,onClose:x,anchorOrigin:{vertical:"top",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"},children:i==null?void 0:i.map((S,T)=>X(Fg,{onClick:()=>{d(S),s==null||s(S,o),x()},children:S},S))})]})},KIe=[{city:"Dubai",data:[{category:"Air pollution",indicator:"CO2 emissions",value:1,natural_value:20.3},{category:"Air pollution",indicator:"CO2 emissions (change in last 3 years)",value:2,natural_value:3.2},{category:"Air pollution",indicator:"CO2 concentration",value:1,natural_value:465},{category:"Air pollution",indicator:"CO2 concentration (change in last 3 years)",value:3,natural_value:1.8},{category:"Air pollution",indicator:"Annual average of SO2 concentration in ambient air",value:2,natural_value:27.1},{category:"Air pollution",indicator:"Annual Average of SO2 Concentration in Ambient Air (change in last 3 years)",value:1,natural_value:17.7},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air",value:1,natural_value:77.4},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air"},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:1.4},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air, microgram/m3",value:1,natural_value:132.1},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:.2},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air, microgram/m3",value:3,natural_value:.5},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:1.9},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air, microgram/m3",value:1,natural_value:128},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air (change in last 3 years), microgram/m3",value:2,natural_value:12.8},{category:"Air pollution",indicator:"Volatile organic compounds/reactive organic gases emissions",value:1,natural_value:2.8},{category:"Air pollution",indicator:"Perception of air pollution index",value:3,natural_value:1.2},{category:"Air pollution",indicator:"Paris Agreement",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Annual average of dissolved oxygen (DO) concentration in water",value:2,natural_value:6.401},{category:"Water pollution",indicator:"Annual average of pH concentration in water",value:2,natural_value:7.876666666666666},{category:"Water pollution",indicator:"Annual average dissolved solids in drinking-water",value:4,natural_value:3.1},{category:"Water pollution",indicator:"Water management strategy in a city",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Perception of water pollution index",value:3,natural_value:1.5469712757516376},{category:"Land use and waste",indicator:"Share of devastated and degraded land area requiring reclamation",value:3,natural_value:3.1},{category:"Land use and waste",indicator:"3-year average growth rate of devastated and degraded land area requiring reclamation",value:4,natural_value:-.08},{category:"Land use and waste",indicator:"Waste deposits",value:3,natural_value:1e-4},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous)",value:2,natural_value:5945.914771596275},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous), (change in last 3 years)",value:2,natural_value:16.53405312},{category:"Land use and waste",indicator:"Total recycled construction waste",value:3,natural_value:.000173996963487571},{category:"Land use and waste",indicator:"Share of recycled construction and demolish waste in total generated construction and demolish waste",value:4,natural_value:.57866431255714},{category:"Land use and waste",indicator:"Total area of impervious surfaces and percentage to total city area",value:3,natural_value:3.1},{category:"Land use and waste",indicator:"Productive urban land (in percent total land)",value:2,natural_value:32.2},{category:"Land use and waste",indicator:"Waste managenet strategy",value:5,natural_value:"yes"},{category:"Land use and waste",indicator:"Perception of waste index",value:3,natural_value:2.155183475682713},{category:"Land use and waste",indicator:"Green spaces, % city area",value:2,natural_value:.0292},{category:"Land use and waste",indicator:"Green spaces, change in last 3 years",value:4,natural_value:1.6},{category:"Land use and waste",indicator:"NDVI",value:3,natural_value:1.1},{category:"Natural disaster hazards",indicator:"Share of total area with altitude above sea level less than 0,5 meters",value:3,natural_value:.12},{category:"Natural disaster hazards",indicator:"Growth rate of freshwater mirror area",value:5,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of registered heavy rain, flood and thunderbolt (change in last 3 years)",value:5,natural_value:-.173191044314075},{category:"Natural disaster hazards",indicator:"Number of registered sand storm (change in last 3 years)",value:5,natural_value:-.170173466633757},{category:"Natural disaster hazards",indicator:"Environmental/natural disasters’ risk mitigation",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Strategy/policy/government officials’ statement on environmental issues ",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Total overall losses from natural disaster hazards",value:5,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of days with average daily temperature above the threshold for 1990-2010",value:2,natural_value:73},{category:"Natural disaster hazards",indicator:"Number of disruptions to basic services, attributed to disasters",value:5,natural_value:0},{category:"Water availability",indicator:"Water consumption per capita",value:3,natural_value:.00016922114759669515},{category:"Water availability",indicator:"Water tariff to disposable income ratio",value:1,natural_value:4.033333333333333},{category:"Water availability",indicator:"Sanitary facilities tariff to disposable income ratio",value:5,natural_value:.5},{category:"Water availability",indicator:"Water consumption per capita (change in last 3 years)",value:5,natural_value:-.03},{category:"Water availability",indicator:"Percentage of population with access to drinking water",value:5,natural_value:.99},{category:"Water availability",indicator:"Percentage of population with access to drinking water (change in last 3 years)",value:5,natural_value:0},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities",value:5,natural_value:.99},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities (change in last 3 years)",value:5,natural_value:0},{category:"Food availability",indicator:"Cereal import dependency ratio (5-years average)",value:5,natural_value:.969},{category:"Food availability",indicator:"Cereal import dependency ratio (change in last 3 years)",value:3,natural_value:.02451091909},{category:"Food availability",indicator:"Prevalence of undernourishment",value:5,natural_value:2.5},{category:"Food availability",indicator:"Prevalence of undernourishment (change in last 3 years)",value:5,natural_value:-.0333584789974298},{category:"Food availability",indicator:"Prevalence of undernourishment children",value:5,natural_value:1.3},{category:"Food availability",indicator:"Prevalence of undernourishment children (change in last 3 years)",value:5,natural_value:0},{category:"Food availability",indicator:"Prevalence of moderate or severe food insecurity in the population",value:3,natural_value:.075},{category:"Food availability",indicator:"Share of imports in food resources",value:3,natural_value:43.1},{category:"Food availability",indicator:"Percentage of people with access to at least one food vendor/retailer within 15 minutes of walking",value:3,natural_value:91},{category:"Food availability",indicator:"Perception of food availability index",value:2,natural_value:2.4758589112947105},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity",value:5,natural_value:1},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity (change in last 3 years)",value:5,natural_value:0},{category:"Energy availability",indicator:"Consumption of electricity per capita",value:2,natural_value:13484.260097442204},{category:"Energy availability",indicator:"Consumption of electricity per capita (change in last 3 years)",value:4,natural_value:-.0328884973674617},{category:"Energy availability",indicator:"Electricity tariff to disposable income ratio",value:2,natural_value:.3025},{category:"Energy availability",indicator:"Share of renewable sources in electricity consumption",value:4,natural_value:21.1},{category:"Energy availability",indicator:"Perception of energy availability index",value:4,natural_value:.8121750320262275},{category:"Health",indicator:"Child mortality rate (under 5 years-old)",value:5,natural_value:.047},{category:"Health",indicator:"City ambulance",value:5,natural_value:"yes"},{category:"Health",indicator:"Life expectancy at birth, years",value:5,natural_value:79.12733333333334},{category:"Health",indicator:"Life expectancy at birth goals",value:2,natural_value:"1. No plans aimed at achieving any of components of Goal 3 or increasing LEaB"},{category:"Health",indicator:"Number of hospital beds per 1,000 population",value:3,natural_value:1.7038581393098866},{category:"Health",indicator:"Number of doctors per 1,000 population",value:3,natural_value:3.1534720263756366},{category:"Health",indicator:"Maternal mortality ratio",value:4,natural_value:1.3},{category:"Health",indicator:"Ambulance arrival speed, min",value:4,natural_value:7},{category:"Education",indicator:"Literacy rate among population (15-24 Years)",value:4,natural_value:.969935633333333},{category:"Education",indicator:"Literacy rate among population (15-24 Years) (change in last 3 years)",value:4,natural_value:.0160766595564663},{category:"Education",indicator:"Primary education engagement",value:5,natural_value:.996036433333333},{category:"Education",indicator:"Pupils per teacher rate",value:3,natural_value:10.305960905809698},{category:"Education",indicator:"Proportion of population with post-secondary and higher education",value:4,natural_value:.5491613261},{category:"Wealth",indicator:"Percentage of population with food expenditure is above 52% of total expenditure",value:5,natural_value:.023},{category:"Wealth",indicator:"Mean monthly salary",value:5,natural_value:7854.14666666667},{category:"Wealth",indicator:"Mean monthly salary, change in last 3 years",value:4,natural_value:706225149202933e-19},{category:"Wealth",indicator:"Disposable monthly income",value:5,natural_value:2355.1463883362276},{category:"Wealth",indicator:"Disposable monthly income (change in last 3 years)",value:5,natural_value:.0584373085440772},{category:"Wealth",indicator:"Debt to salary ratio",value:5,natural_value:.92},{category:"Wealth",indicator:"Number of mobile phones per 1,000 population",value:5,natural_value:113.16800083893004},{category:"Wealth",indicator:"Decile income coefficient",value:4,natural_value:5.9021739130434785},{category:"Wealth",indicator:"Decile income coefficient (change in last 3 years)",value:5,natural_value:-.481645306006547},{category:"Wealth",indicator:"Poverty headcount ratio at national poverty lines",value:5,natural_value:.0533333333333333},{category:"Wealth",indicator:"Working poverty rate (percentage of employed living below US$1.90 PPP), 15+ age (%) ",value:5,natural_value:.001},{category:"Wealth",indicator:"Poverty headcount ratio at $2.15 PPP 2017 a day",value:5,natural_value:.00133333333333333},{category:"Wealth",indicator:"Living spaces per capita, sq m (change in last 3 years)",value:5,natural_value:.00224274214415088},{category:"Wealth",indicator:"Population living in slums (% of urban population)",value:5,natural_value:4.1},{category:"Wealth",indicator:"Availability of finance (consumer loans)",value:3,natural_value:.5},{category:"Wealth",indicator:"Perception of wealth & poverty index",value:2,natural_value:2.1140395253368003},{category:"Safety",indicator:"Road fatalities rate per 100,000 population",value:4,natural_value:3.3516579451976907},{category:"Safety",indicator:"Road fatalities rate per 100,000 population (change in last 3 years)",value:5,natural_value:-.0617566486884363},{category:"Safety",indicator:"Violent crime rate per 100,000 population",value:5,natural_value:.26666666666666666},{category:"Safety",indicator:"Violent crime rate per 100,000 population (change in last 3 years)",value:5,natural_value:0},{category:"Safety",indicator:"Crime rate per 100,000 population",value:5,natural_value:31.433333333333334},{category:"Safety",indicator:"Crime rate per 100,000 population  (change in last 3 years)",value:5,natural_value:0},{category:"Safety",indicator:"Police arrival speed",value:5,natural_value:2.34},{category:"Safety",indicator:"Perception of safety index",value:3,natural_value:3.295},{category:"Livability",indicator:"Number of LEED certified green buildings",value:5,natural_value:1.378},{category:"Livability",indicator:"Number of CEEQUAL certified projects",value:5,natural_value:8},{category:"Livability",indicator:"Whether or not the city has ISO 37120 certification",value:5,natural_value:"yes"},{category:"Livability",indicator:"Mobile connection coverage",value:5,natural_value:1},{category:"Livability",indicator:"Internet coverage",value:5,natural_value:1},{category:"Livability",indicator:"Perception of livability index",value:3,natural_value:1.082731807619587},{category:"Livability",indicator:"Share of population in 1 km from hospitals",value:4,natural_value:41.8},{category:"Livability",indicator:"Share of population in 1 km from parks",value:4,natural_value:51.5},{category:"Transport",indicator:"Time loss in traffic",value:2,natural_value:3.4},{category:"Transport",indicator:"Share of the population in 1 km from public transport stop",value:4,natural_value:82},{category:"Transport",indicator:"Ratio of the cost of monthly public transport usage Ithe cheapest option) to average mobthly income",value:4,natural_value:.01},{category:"Transport",indicator:"Ratio of the cost of a 1-kilometer taxi ride to average mobthly income",value:2,natural_value:.08},{category:"Transport",indicator:"Percentage of city's roads that are segregated and/or has specialized lane for cyclists",value:2,natural_value:.06},{category:"Transport",indicator:"Number of public electric vehicle (EV) charging points per 100,000 population",value:3,natural_value:1e3},{category:"Transport",indicator:"Public transport (excluding subway) operates by schedule ",value:5,natural_value:"yes"},{category:"Transport",indicator:"Perception of transport index",value:2,natural_value:1.082731807619587},{category:"Inclusion",indicator:"Female-friendly city",value:2,natural_value:3},{category:"Inclusion",indicator:"Number of refugees per 1,000 population",value:4,natural_value:.3817158061663018},{category:"Inclusion",indicator:"Homeless people per 1,000 population",value:5,natural_value:1.8687289767990112},{category:"Inclusion",indicator:"Difference in number of years of schooling between woman and man, woman to man ratio ",value:4,natural_value:.9666666666666667},{category:"Inclusion",indicator:"Slavery index",value:2,natural_value:13.4},{category:"Inclusion",indicator:"Percentage of women aged 25-34 years old that have successfully completed secondary education",value:4,natural_value:56.7},{category:"Inclusion",indicator:"Regulations for building construction and equipment, public transport for people with disabilities",value:1,natural_value:"no"},{category:"Inclusion",indicator:"Perception of inclusion index",value:2,natural_value:3.237203544701542},{category:"Accountability",indicator:"City budget execution publication",value:5,natural_value:"yes"},{category:"Accountability",indicator:"City budget publication",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Financial transparency on city government companies",value:1,natural_value:"no"},{category:"Accountability",indicator:"ISO certification",value:5,natural_value:"yes"},{category:"Accountability",indicator:"City council checks and balances",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Plans to obtain ISO certification",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Perception of accountability index",value:3,natural_value:1.1200372913104772},{category:"City budget",indicator:"Poor financial condition",value:5,natural_value:"no"},{category:"City budget",indicator:"Central/higher level government financial intervention taking place",value:5,natural_value:"no"},{category:"City budget",indicator:"Long-term financial planning",value:1,natural_value:"no"},{category:"City budget",indicator:"Central/higher level government financial intervention is considered",value:1,natural_value:"no"},{category:"City budget",indicator:"Prudent fiscal policy requirements",value:1,natural_value:"no"},{category:"City budget",indicator:"Medium-term planning",value:5,natural_value:"yes"},{category:"SME",indicator:"Number of SMEs per 100,000 population",value:3,natural_value:5235.1},{category:"SME",indicator:"Number of start-ups",value:5,natural_value:3802},{category:"SME",indicator:"Global Startup Ecosystem Index",value:5,natural_value:11.527},{category:"SME",indicator:"Number of SMEs per capita/100 000 population (change in last 3 years)",value:2,natural_value:-.127},{category:"SME",indicator:"Number of start-ups (change in last 3 years)",value:3,natural_value:.179},{category:"Public services",indicator:"Free phone to call the police, ambulance, firefighters",value:5,natural_value:"yes"},{category:"Public services",indicator:"Services for working with citizens' appeals and complaint",value:5,natural_value:"yes"},{category:"Public services",indicator:"E-gov services",value:5,natural_value:"yes"},{category:"Public services",indicator:"Perception of public services index: Public Services",value:3,natural_value:.709659690294386},{category:"Sustainability commitment",indicator:"City ESG reporting",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"City ESG reporting verification",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"ESG planning",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"Plan with specific targets to develop and implement smart city principles",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"Rollout and status of ESG / UN SDG training across the municipal/asset workforce",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"City municipality involved in network or partnership promoting sustainable development (for example, C40 Cities network)",value:5,natural_value:"yes"}]},{city:"Expo City Dubai",data:[{category:"Air pollution",indicator:"CO2 emissions",value:1,natural_value:20.3},{category:"Air pollution",indicator:"CO2 emissions (change in last 3 years)",value:4,natural_value:-1.5},{category:"Air pollution",indicator:"CO2 concentration",value:1,natural_value:468.5},{category:"Air pollution",indicator:"CO2 concentration (change in last 3 years)",value:1,natural_value:15.5},{category:"Air pollution",indicator:"Annual average of SO2 concentration in ambient air",value:2,natural_value:28.1},{category:"Air pollution",indicator:"Annual Average of SO2 Concentration in Ambient Air (change in last 3 years)",value:3,natural_value:1.2},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air",value:1,natural_value:81},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air"},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:1.2},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air, microgram/m3",value:1,natural_value:133.8},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:.1},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air, microgram/m3",value:3,natural_value:.5},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:1.5},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air, microgram/m3",value:1,natural_value:131.7},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air (change in last 3 years), microgram/m3",value:2,natural_value:12.4},{category:"Air pollution",indicator:"Volatile organic compounds/reactive organic gases emissions",value:1,natural_value:2.8},{category:"Air pollution",indicator:"Perception of air pollution index",value:2,natural_value:2.08},{category:"Air pollution",indicator:"Paris Agreement",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Annual average of dissolved oxygen (DO) concentration in water",value:2,natural_value:6.507},{category:"Water pollution",indicator:"Annual average of pH concentration in water",value:2,natural_value:7.876666666666666},{category:"Water pollution",indicator:"Annual average dissolved solids in drinking-water",value:4,natural_value:3.1},{category:"Water pollution",indicator:"Water management strategy in a city",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Perception of water pollution index",value:3,natural_value:2.3439938519744623},{category:"Land use and waste",indicator:"Share of devastated and degraded land area requiring reclamation",value:3,natural_value:3.1},{category:"Land use and waste",indicator:"3-year average growth rate of devastated and degraded land area requiring reclamation",value:4,natural_value:-.072},{category:"Land use and waste",indicator:"Waste deposits",value:3,natural_value:1e-4},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous)",value:3,natural_value:40.3809523809524},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous), (change in last 3 years)",value:2,natural_value:24.28930024},{category:"Land use and waste",indicator:"Total recycled construction waste",value:4,natural_value:15.171599047619047},{category:"Land use and waste",indicator:"Share of recycled construction and demolish waste in total generated construction and demolish waste",value:5,natural_value:.760247651924017},{category:"Land use and waste",indicator:"Total area of impervious surfaces and percentage to total city area",value:3,natural_value:3.1},{category:"Land use and waste",indicator:"Productive urban land (in percent total land)",value:2,natural_value:32.2},{category:"Land use and waste",indicator:"Waste managenet strategy",value:5,natural_value:"yes"},{category:"Land use and waste",indicator:"Perception of waste index",value:2,natural_value:3.4442358641257407},{category:"Land use and waste",indicator:"Green spaces, % city area",value:2,natural_value:.0241},{category:"Land use and waste",indicator:"Green spaces, change in last 3 years",value:3,natural_value:0},{category:"Land use and waste",indicator:"NDVI",value:3,natural_value:1.1},{category:"Natural disaster hazards",indicator:"Share of total area with altitude above sea level less than 0,5 meters",value:3,natural_value:.12},{category:"Natural disaster hazards",indicator:"Growth rate of freshwater mirror area",value:5,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of registered heavy rain, flood and thunderbolt (change in last 3 years)",value:5,natural_value:-.173191044314075},{category:"Natural disaster hazards",indicator:"Number of registered sand storm (change in last 3 years)",value:5,natural_value:-.170173466633757},{category:"Natural disaster hazards",indicator:"Environmental/natural disasters’ risk mitigation",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Strategy/policy/government officials’ statement on environmental issues ",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Total overall losses from natural disaster hazards",value:5,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of days with average daily temperature above the threshold for 1990-2010",value:2,natural_value:73},{category:"Natural disaster hazards",indicator:"Number of disruptions to basic services, attributed to disasters",value:5,natural_value:0},{category:"Water availability",indicator:"Water consumption per capita",value:3,natural_value:20665380952380953e-23},{category:"Water availability",indicator:"Water tariff to disposable income ratio",value:1,natural_value:4.033333333333333},{category:"Water availability",indicator:"Sanitary facilities tariff to disposable income ratio",value:5,natural_value:.5},{category:"Water availability",indicator:"Water consumption per capita (change in last 3 years)",value:5,natural_value:-.207},{category:"Water availability",indicator:"Percentage of population with access to drinking water",value:5,natural_value:.99},{category:"Water availability",indicator:"Percentage of population with access to drinking water (change in last 3 years)",value:5,natural_value:0},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities",value:5,natural_value:.99},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities (change in last 3 years)",value:5,natural_value:0},{category:"Food availability",indicator:"Cereal import dependency ratio (5-years average)",value:5,natural_value:.969},{category:"Food availability",indicator:"Cereal import dependency ratio (change in last 3 years)",value:3,natural_value:.02451091909},{category:"Food availability",indicator:"Prevalence of undernourishment",value:5,natural_value:2.5},{category:"Food availability",indicator:"Prevalence of undernourishment (change in last 3 years)",value:5,natural_value:-.0333584789974298},{category:"Food availability",indicator:"Prevalence of undernourishment children",value:5,natural_value:1.3},{category:"Food availability",indicator:"Prevalence of undernourishment children (change in last 3 years)",value:5,natural_value:0},{category:"Food availability",indicator:"Prevalence of moderate or severe food insecurity in the population",value:3,natural_value:.075},{category:"Food availability",indicator:"Share of imports in food resources",value:3,natural_value:43.1},{category:"Food availability",indicator:"Percentage of people with access to at least one food vendor/retailer within 15 minutes of walking",value:3,natural_value:91},{category:"Food availability",indicator:"Perception of food availability index",value:3,natural_value:1.6876755734216127},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity",value:5,natural_value:1},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity (change in last 3 years)",value:5,natural_value:0},{category:"Energy availability",indicator:"Consumption of electricity per capita",value:2,natural_value:21791.14485714286},{category:"Energy availability",indicator:"Consumption of electricity per capita (change in last 3 years)",value:2,natural_value:.158604595786555},{category:"Energy availability",indicator:"Electricity tariff to disposable income ratio",value:2,natural_value:.3025},{category:"Energy availability",indicator:"Share of renewable sources in electricity consumption",value:4,natural_value:21.1},{category:"Energy availability",indicator:"Perception of energy availability index",value:4,natural_value:.07780892454687012},{category:"Health",indicator:"Child mortality rate (under 5 years-old)",value:5,natural_value:.047},{category:"Health",indicator:"City ambulance",value:5,natural_value:"yes"},{category:"Health",indicator:"Life expectancy at birth, years",value:5,natural_value:79.12733333333334},{category:"Health",indicator:"Life expectancy at birth goals",value:2,natural_value:"1. No plans aimed at achieving any of components of Goal 3 or increasing LEaB"},{category:"Health",indicator:"Number of hospital beds per 1,000 population",value:3,natural_value:1.7038581393098866},{category:"Health",indicator:"Number of doctors per 1,000 population",value:3,natural_value:3.1534720263756366},{category:"Health",indicator:"Maternal mortality ratio",value:4,natural_value:1.3},{category:"Health",indicator:"Ambulance arrival speed, min",value:4,natural_value:7},{category:"Education",indicator:"Literacy rate among population (15-24 Years)",value:4,natural_value:.969935633333333},{category:"Education",indicator:"Literacy rate among population (15-24 Years) (change in last 3 years)",value:4,natural_value:.0160766595564663},{category:"Education",indicator:"Primary education engagement",value:5,natural_value:.996036433333333},{category:"Education",indicator:"Pupils per teacher rate",value:3,natural_value:10.305960905809698},{category:"Education",indicator:"Proportion of population with post-secondary and higher education",value:4,natural_value:.5491613261},{category:"Wealth",indicator:"Percentage of population with food expenditure is above 52% of total expenditure",value:5,natural_value:.001},{category:"Wealth",indicator:"Mean monthly salary",value:5,natural_value:7854.14666666667},{category:"Wealth",indicator:"Mean monthly salary, change in last 3 years",value:4,natural_value:706225149202933e-19},{category:"Wealth",indicator:"Disposable monthly income",value:5,natural_value:2355.1463883362276},{category:"Wealth",indicator:"Disposable monthly income (change in last 3 years)",value:5,natural_value:.0584373085440772},{category:"Wealth",indicator:"Debt to salary ratio",value:5,natural_value:.92},{category:"Wealth",indicator:"Number of mobile phones per 1,000 population",value:5,natural_value:113.16800083893004},{category:"Wealth",indicator:"Decile income coefficient",value:4,natural_value:5.9021739130434785},{category:"Wealth",indicator:"Decile income coefficient (change in last 3 years)",value:5,natural_value:-.481645306006547},{category:"Wealth",indicator:"Poverty headcount ratio at national poverty lines",value:5,natural_value:0},{category:"Wealth",indicator:"Working poverty rate (percentage of employed living below US$1.90 PPP), 15+ age (%) ",value:5,natural_value:.001},{category:"Wealth",indicator:"Poverty headcount ratio at $2.15 PPP 2017 a day",value:5,natural_value:.000666666666666667},{category:"Wealth",indicator:"Living spaces per capita, sq m (change in last 3 years)",value:5,natural_value:.00224274214415088},{category:"Wealth",indicator:"Population living in slums (% of urban population)",value:5,natural_value:4.1},{category:"Wealth",indicator:"Availability of finance (consumer loans)",value:3,natural_value:.5},{category:"Wealth",indicator:"Perception of wealth & poverty index",value:2,natural_value:1.87519508157957},{category:"Safety",indicator:"Road fatalities rate per 100,000 population",value:4,natural_value:3.3516579451976907},{category:"Safety",indicator:"Road fatalities rate per 100,000 population (change in last 3 years)",value:5,natural_value:-.0617566486884363},{category:"Safety",indicator:"Violent crime rate per 100,000 population",value:5,natural_value:.26666666666666666},{category:"Safety",indicator:"Violent crime rate per 100,000 population (change in last 3 years)",value:5,natural_value:0},{category:"Safety",indicator:"Crime rate per 100,000 population",value:5,natural_value:31.433333333333334},{category:"Safety",indicator:"Crime rate per 100,000 population  (change in last 3 years)",value:5,natural_value:0},{category:"Safety",indicator:"Police arrival speed",value:5,natural_value:2.34},{category:"Safety",indicator:"Perception of safety index",value:3,natural_value:2.445},{category:"Livability",indicator:"Number of LEED certified green buildings",value:5,natural_value:126.95604827857144},{category:"Livability",indicator:"Number of CEEQUAL certified projects",value:5,natural_value:8},{category:"Livability",indicator:"Whether or not the city has ISO 37120 certification",value:5,natural_value:"yes"},{category:"Livability",indicator:"Mobile connection coverage",value:5,natural_value:1},{category:"Livability",indicator:"Internet coverage",value:5,natural_value:1},{category:"Livability",indicator:"Perception of livability index",value:3,natural_value:.27468677952825726},{category:"Livability",indicator:"Share of population in 1 km from hospitals",value:4,natural_value:41.8},{category:"Livability",indicator:"Share of population in 1 km from parks",value:4,natural_value:51.5},{category:"Transport",indicator:"Time loss in traffic",value:2,natural_value:3.4},{category:"Transport",indicator:"Share of the population in 1 km from public transport stop",value:4,natural_value:82},{category:"Transport",indicator:"Ratio of the cost of monthly public transport usage Ithe cheapest option) to average mobthly income",value:4,natural_value:.01},{category:"Transport",indicator:"Ratio of the cost of a 1-kilometer taxi ride to average mobthly income",value:2,natural_value:.08},{category:"Transport",indicator:"Percentage of city's roads that are segregated and/or has specialized lane for cyclists",value:2,natural_value:.06},{category:"Transport",indicator:"Number of public electric vehicle (EV) charging points per 100,000 population",value:3,natural_value:1e3},{category:"Transport",indicator:"Public transport (excluding subway) operates by schedule ",value:5,natural_value:"yes"},{category:"Transport",indicator:"Perception of transport index",value:2,natural_value:.27468677952825726},{category:"Inclusion",indicator:"Female-friendly city",value:2,natural_value:3},{category:"Inclusion",indicator:"Number of refugees per 1,000 population",value:4,natural_value:.3817158061663018},{category:"Inclusion",indicator:"Homeless people per 1,000 population",value:5,natural_value:1.8687289767990112},{category:"Inclusion",indicator:"Difference in number of years of schooling between woman and man, woman to man ratio ",value:4,natural_value:.9666666666666667},{category:"Inclusion",indicator:"Slavery index",value:2,natural_value:13.4},{category:"Inclusion",indicator:"Percentage of women aged 25-34 years old that have successfully completed secondary education",value:4,natural_value:56.7},{category:"Inclusion",indicator:"Regulations for building construction and equipment, public transport for people with disabilities",value:1,natural_value:"no"},{category:"Inclusion",indicator:"Perception of inclusion index",value:2,natural_value:3.217790376675001},{category:"Accountability",indicator:"City budget execution publication",value:5,natural_value:"yes"},{category:"Accountability",indicator:"City budget publication",value:5,natural_value:"no"},{category:"Accountability",indicator:"Financial transparency on city government companies",value:1,natural_value:"no"},{category:"Accountability",indicator:"ISO certification",value:5,natural_value:"yes"},{category:"Accountability",indicator:"City council checks and balances",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Plans to obtain ISO certification",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Perception of accountability index",value:3,natural_value:.7813312839914873},{category:"City budget",indicator:"Poor financial condition",value:5,natural_value:"no"},{category:"City budget",indicator:"Central/higher level government financial intervention taking place",value:5,natural_value:"no"},{category:"City budget",indicator:"Long-term financial planning",value:1,natural_value:"no"},{category:"City budget",indicator:"Central/higher level government financial intervention is considered",value:1,natural_value:"no"},{category:"City budget",indicator:"Prudent fiscal policy requirements",value:1,natural_value:"no"},{category:"City budget",indicator:"Medium-term planning",value:5,natural_value:"yes"},{category:"SME",indicator:"Number of SMEs per 100,000 population",value:3,natural_value:5235.1},{category:"SME",indicator:"Number of start-ups",value:5,natural_value:3802},{category:"SME",indicator:"Global Startup Ecosystem Index",value:5,natural_value:11.527},{category:"SME",indicator:"Number of SMEs per capita/100 000 population (change in last 3 years)",value:2,natural_value:-.127},{category:"SME",indicator:"Number of start-ups (change in last 3 years)",value:3,natural_value:.179},{category:"Public services",indicator:"Free phone to call the police, ambulance, firefighters",value:5,natural_value:"yes"},{category:"Public services",indicator:"Services for working with citizens' appeals and complaint",value:5,natural_value:"yes"},{category:"Public services",indicator:"E-gov services",value:5,natural_value:"yes"},{category:"Public services",indicator:"Perception of public services index: Public Services",value:3,natural_value:.6250650271931899},{category:"Sustainability commitment",indicator:"City ESG reporting",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"City ESG reporting verification",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"ESG planning",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"Plan with specific targets to develop and implement smart city principles",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"Rollout and status of ESG / UN SDG training across the municipal/asset workforce",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"City municipality involved in network or partnership promoting sustainable development (for example, C40 Cities network)",value:5,natural_value:"yes"}]},{city:"Valparaiso",data:[{category:"Air pollution",indicator:"CO2 emissions",value:3,natural_value:4.4},{category:"Air pollution",indicator:"CO2 emissions (change in last 3 years)",value:3,natural_value:1.6},{category:"Air pollution",indicator:"CO2 concentration",value:4,natural_value:417.7},{category:"Air pollution",indicator:"CO2 concentration (change in last 3 years)",value:3,natural_value:1.7},{category:"Air pollution",indicator:"Annual average of SO2 concentration in ambient air",value:3,natural_value:52.1},{category:"Air pollution",indicator:"Annual Average of SO2 Concentration in Ambient Air (change in last 3 years)",value:1,natural_value:369.9},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air",value:1,natural_value:26.9},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air"},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:1,natural_value:1.6},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air, microgram/m3",value:3,natural_value:53.8},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:4,natural_value:-4.5},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air, microgram/m3",value:1,natural_value:.9},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air (change in last 3 years), microgram/m3",value:1,natural_value:17},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air, microgram/m3",value:2,natural_value:90.4},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air (change in last 3 years), microgram/m3",value:1,natural_value:17.3},{category:"Air pollution",indicator:"Volatile organic compounds/reactive organic gases emissions",value:4,natural_value:1},{category:"Air pollution",indicator:"Perception of air pollution index",value:3,natural_value:1.53},{category:"Air pollution",indicator:"Paris Agreement",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Annual average of dissolved oxygen (DO) concentration in water",value:3,natural_value:6.313333333333333},{category:"Water pollution",indicator:"Annual average of pH concentration in water",value:2,natural_value:8.06},{category:"Water pollution",indicator:"Annual average dissolved solids in drinking-water",value:3,natural_value:139},{category:"Water pollution",indicator:"Water management strategy in a city",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Perception of water pollution index",value:4,natural_value:1.0452113628976973},{category:"Land use and waste",indicator:"Share of devastated and degraded land area requiring reclamation",value:4,natural_value:4.5},{category:"Land use and waste",indicator:"3-year average growth rate of devastated and degraded land area requiring reclamation",value:1,natural_value:.112},{category:"Land use and waste",indicator:"Waste deposits",value:5,natural_value:16e-5},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous)",value:5,natural_value:17.469310981854},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous), (change in last 3 years)",value:5,natural_value:-1.80539164},{category:"Land use and waste",indicator:"Total recycled construction waste",value:1,natural_value:.0010518},{category:"Land use and waste",indicator:"Share of recycled construction and demolish waste in total generated construction and demolish waste",value:2,natural_value:.084},{category:"Land use and waste",indicator:"Total area of impervious surfaces and percentage to total city area",value:3,natural_value:.015},{category:"Land use and waste",indicator:"Productive urban land (in percent total land)",value:3,natural_value:32.2},{category:"Land use and waste",indicator:"Waste managenet strategy",value:1,natural_value:"no"},{category:"Land use and waste",indicator:"Perception of waste index",value:2,natural_value:1.0917886963814378},{category:"Land use and waste",indicator:"Green spaces, % city area",value:3,natural_value:.3008},{category:"Land use and waste",indicator:"Green spaces, change in last 3 years",value:2,natural_value:-4},{category:"Land use and waste",indicator:"NDVI",value:4,natural_value:.22},{category:"Natural disaster hazards",indicator:"Share of total area with altitude above sea level less than 0,5 meters",value:1,natural_value:.16},{category:"Natural disaster hazards",indicator:"Growth rate of freshwater mirror area",value:5,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of registered heavy rain, flood and thunderbolt (change in last 3 years)",value:3,natural_value:-.0312706938485358},{category:"Natural disaster hazards",indicator:"Number of registered sand storm (change in last 3 years)",value:3,natural_value:0},{category:"Natural disaster hazards",indicator:"Environmental/natural disasters’ risk mitigation",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Strategy/policy/government officials’ statement on environmental issues ",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Total overall losses from natural disaster hazards",value:3,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of days with average daily temperature above the threshold for 1990-2010",value:3,natural_value:15},{category:"Natural disaster hazards",indicator:"Number of disruptions to basic services, attributed to disasters",value:3,natural_value:0},{category:"Water availability",indicator:"Water consumption per capita",value:3,natural_value:.0003085905057588588},{category:"Water availability",indicator:"Water tariff to disposable income ratio",value:3,natural_value:1.3},{category:"Water availability",indicator:"Sanitary facilities tariff to disposable income ratio",value:2,natural_value:1.7},{category:"Water availability",indicator:"Water consumption per capita (change in last 3 years)",value:3,natural_value:0},{category:"Water availability",indicator:"Percentage of population with access to drinking water",value:2,natural_value:.988},{category:"Water availability",indicator:"Percentage of population with access to drinking water (change in last 3 years)",value:2,natural_value:0},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities",value:2,natural_value:.771666666666667},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities (change in last 3 years)",value:2,natural_value:.013},{category:"Food availability",indicator:"Cereal import dependency ratio (5-years average)",value:3,natural_value:.437333333333333},{category:"Food availability",indicator:"Cereal import dependency ratio (change in last 3 years)",value:3,natural_value:.04245544122},{category:"Food availability",indicator:"Prevalence of undernourishment",value:3,natural_value:.056},{category:"Food availability",indicator:"Prevalence of undernourishment (change in last 3 years)",value:3,natural_value:-.0125013105308766},{category:"Food availability",indicator:"Prevalence of undernourishment children",value:3,natural_value:.357},{category:"Food availability",indicator:"Prevalence of undernourishment children (change in last 3 years)",value:4,natural_value:0},{category:"Food availability",indicator:"Prevalence of moderate or severe food insecurity in the population",value:3,natural_value:.166666666666667},{category:"Food availability",indicator:"Share of imports in food resources",value:3,natural_value:.36},{category:"Food availability",indicator:"Percentage of people with access to at least one food vendor/retailer within 15 minutes of walking",value:3,natural_value:91},{category:"Food availability",indicator:"Perception of food availability index",value:2,natural_value:1.8640920844764555},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity",value:5,natural_value:1},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity (change in last 3 years)",value:3,natural_value:0},{category:"Energy availability",indicator:"Consumption of electricity per capita",value:3,natural_value:4079.2666666666664},{category:"Energy availability",indicator:"Consumption of electricity per capita (change in last 3 years)",value:3,natural_value:.00892969688080547},{category:"Energy availability",indicator:"Electricity tariff to disposable income ratio",value:5,natural_value:.002},{category:"Energy availability",indicator:"Share of renewable sources in electricity consumption",value:3,natural_value:.21},{category:"Energy availability",indicator:"Perception of energy availability index",value:4,natural_value:.6397959193215885},{category:"Health",indicator:"Child mortality rate (under 5 years-old)",value:3,natural_value:6.866666666666667},{category:"Health",indicator:"City ambulance",value:5,natural_value:"yes"},{category:"Health",indicator:"Life expectancy at birth, years",value:5,natural_value:79.94666666666666},{category:"Health",indicator:"Life expectancy at birth goals",value:1,natural_value:"1. No plans aimed at achieving any of components of Goal 3 or increasing LEaB"},{category:"Health",indicator:"Number of hospital beds per 1,000 population",value:3,natural_value:2.466666666666667},{category:"Health",indicator:"Number of doctors per 1,000 population",value:3,natural_value:6.6585},{category:"Health",indicator:"Maternal mortality ratio",value:3,natural_value:49},{category:"Health",indicator:"Ambulance arrival speed, min",value:3,natural_value:70},{category:"Education",indicator:"Literacy rate among population (15-24 Years)",value:4,natural_value:.991542002360026},{category:"Education",indicator:"Literacy rate among population (15-24 Years) (change in last 3 years)",value:2,natural_value:-.000852712549205825},{category:"Education",indicator:"Primary education engagement",value:5,natural_value:.9921428},{category:"Education",indicator:"Pupils per teacher rate",value:3,natural_value:18.877333333333336},{category:"Education",indicator:"Proportion of population with post-secondary and higher education",value:4,natural_value:.405},{category:"Wealth",indicator:"Percentage of population with food expenditure is above 52% of total expenditure",value:3,natural_value:.27},{category:"Wealth",indicator:"Mean monthly salary",value:3,natural_value:1082.1000000000001},{category:"Wealth",indicator:"Mean monthly salary, change in last 3 years",value:2,natural_value:-.0734334645124871},{category:"Wealth",indicator:"Disposable monthly income",value:2,natural_value:254.3964760687164},{category:"Wealth",indicator:"Disposable monthly income (change in last 3 years)",value:2,natural_value:-.0183481759621801},{category:"Wealth",indicator:"Debt to salary ratio",value:2,natural_value:18.240000000000002},{category:"Wealth",indicator:"Number of mobile phones per 1,000 population",value:4,natural_value:132.66666666666669},{category:"Wealth",indicator:"Decile income coefficient",value:3,natural_value:16.41333333333333},{category:"Wealth",indicator:"Decile income coefficient (change in last 3 years)",value:3,natural_value:.0128157365967749},{category:"Wealth",indicator:"Poverty headcount ratio at national poverty lines",value:3,natural_value:.21},{category:"Wealth",indicator:"Working poverty rate (percentage of employed living below US$1.90 PPP), 15+ age (%) ",value:3,natural_value:.022},{category:"Wealth",indicator:"Poverty headcount ratio at $2.15 PPP 2017 a day",value:3,natural_value:.0236666666666667},{category:"Wealth",indicator:"Living spaces per capita, sq m (change in last 3 years)",value:5,natural_value:.2213},{category:"Wealth",indicator:"Population living in slums (% of urban population)",value:3,natural_value:.17},{category:"Wealth",indicator:"Availability of finance (consumer loans)",value:3,natural_value:.5},{category:"Wealth",indicator:"Perception of wealth & poverty index",value:1,natural_value:1.3257846667649562},{category:"Safety",indicator:"Road fatalities rate per 100,000 population",value:4,natural_value:11.483333333333334},{category:"Safety",indicator:"Road fatalities rate per 100,000 population (change in last 3 years)",value:4,natural_value:.0786864009887851},{category:"Safety",indicator:"Violent crime rate per 100,000 population",value:3,natural_value:7.266666666666667},{category:"Safety",indicator:"Violent crime rate per 100,000 population (change in last 3 years)",value:4,natural_value:-.0682183289213857},{category:"Safety",indicator:"Crime rate per 100,000 population",value:3,natural_value:6270.933333333334},{category:"Safety",indicator:"Crime rate per 100,000 population  (change in last 3 years)",value:2,natural_value:-.0682183289213857},{category:"Safety",indicator:"Police arrival speed",value:2,natural_value:28},{category:"Safety",indicator:"Perception of safety index",value:4,natural_value:1.9649999999999999},{category:"Livability",indicator:"Number of LEED certified green buildings",value:3,natural_value:.35192599731186175},{category:"Livability",indicator:"Number of CEEQUAL certified projects",value:1,natural_value:0},{category:"Livability",indicator:"Whether or not the city has ISO 37120 certification",value:1,natural_value:"no"},{category:"Livability",indicator:"Mobile connection coverage",value:3,natural_value:.966666666666667},{category:"Livability",indicator:"Internet coverage",value:4,natural_value:.95},{category:"Livability",indicator:"Perception of livability index",value:4,natural_value:.8453069904609392},{category:"Livability",indicator:"Share of population in 1 km from hospitals",value:4,natural_value:98.6},{category:"Livability",indicator:"Share of population in 1 km from parks",value:5,natural_value:93.2},{category:"Transport",indicator:"Time loss in traffic",value:2,natural_value:34.8},{category:"Transport",indicator:"Share of the population in 1 km from public transport stop",value:3,natural_value:90.2},{category:"Transport",indicator:"Ratio of the cost of monthly public transport usage Ithe cheapest option) to average mobthly income",value:3,natural_value:.04},{category:"Transport",indicator:"Ratio of the cost of a 1-kilometer taxi ride to average mobthly income",value:3,natural_value:.04},{category:"Transport",indicator:"Percentage of city's roads that are segregated and/or has specialized lane for cyclists",value:3,natural_value:.06},{category:"Transport",indicator:"Number of public electric vehicle (EV) charging points per 100,000 population",value:3,natural_value:1.4},{category:"Transport",indicator:"Public transport (excluding subway) operates by schedule ",value:5,natural_value:"yes"},{category:"Transport",indicator:"Perception of transport index",value:4,natural_value:.8453069904609392},{category:"Inclusion",indicator:"Female-friendly city",value:4,natural_value:2},{category:"Inclusion",indicator:"Number of refugees per 1,000 population",value:4,natural_value:.051},{category:"Inclusion",indicator:"Homeless people per 1,000 population",value:4,natural_value:.736},{category:"Inclusion",indicator:"Difference in number of years of schooling between woman and man, woman to man ratio ",value:3,natural_value:.97791},{category:"Inclusion",indicator:"Slavery index",value:5,natural_value:3.2},{category:"Inclusion",indicator:"Percentage of women aged 25-34 years old that have successfully completed secondary education",value:3,natural_value:.451},{category:"Inclusion",indicator:"Regulations for building construction and equipment, public transport for people with disabilities",value:5,natural_value:"yes"},{category:"Inclusion",indicator:"Perception of inclusion index",value:4,natural_value:1.608933747267902},{category:"Accountability",indicator:"City budget execution publication",value:5,natural_value:"yes"},{category:"Accountability",indicator:"City budget publication",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Financial transparency on city government companies",value:1,natural_value:"no"},{category:"Accountability",indicator:"ISO certification",value:1,natural_value:"no"},{category:"Accountability",indicator:"City council checks and balances",value:1,natural_value:"no"},{category:"Accountability",indicator:"Plans to obtain ISO certification",value:1,natural_value:"no"},{category:"Accountability",indicator:"Perception of accountability index",value:3,natural_value:.9155840858082012},{category:"City budget",indicator:"Poor financial condition",value:5,natural_value:"no"},{category:"City budget",indicator:"Central/higher level government financial intervention taking place",value:5,natural_value:"no"},{category:"City budget",indicator:"Long-term financial planning",value:1,natural_value:"no"},{category:"City budget",indicator:"Central/higher level government financial intervention is considered",value:1,natural_value:"no"},{category:"City budget",indicator:"Prudent fiscal policy requirements",value:1,natural_value:"no"},{category:"City budget",indicator:"Medium-term planning",value:1,natural_value:"no"},{category:"SME",indicator:"Number of SMEs per 100,000 population",value:5,natural_value:32477.9},{category:"SME",indicator:"Number of start-ups",value:3,natural_value:4},{category:"SME",indicator:"Global Startup Ecosystem Index",value:1,natural_value:.178},{category:"SME",indicator:"Number of SMEs per capita/100 000 population (change in last 3 years)",value:3,natural_value:.00427846538976695},{category:"SME",indicator:"Number of start-ups (change in last 3 years)",value:5,natural_value:0},{category:"Public services",indicator:"Free phone to call the police, ambulance, firefighters",value:5,natural_value:"yes"},{category:"Public services",indicator:"Services for working with citizens' appeals and complaint",value:5,natural_value:"yes"},{category:"Public services",indicator:"E-gov services",value:5,natural_value:"yes"},{category:"Public services",indicator:"Perception of public services index: Public Services",value:4,natural_value:.9361290524476109},{category:"Sustainability commitment",indicator:"City ESG reporting",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"City ESG reporting verification",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"ESG planning",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"Plan with specific targets to develop and implement smart city principles",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"Rollout and status of ESG / UN SDG training across the municipal/asset workforce",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"City municipality involved in network or partnership promoting sustainable development (for example, C40 Cities network)",value:5,natural_value:"yes"}]},{city:"Dar es Salaam",data:[{category:"Air pollution",indicator:"CO2 emissions",value:5,natural_value:.2},{category:"Air pollution",indicator:"CO2 emissions (change in last 3 years)",value:2,natural_value:4.6},{category:"Air pollution",indicator:"CO2 concentration",value:5,natural_value:412.5},{category:"Air pollution",indicator:"CO2 concentration (change in last 3 years)",value:3,natural_value:1.6},{category:"Air pollution",indicator:"Annual average of SO2 concentration in ambient air",value:5,natural_value:.2},{category:"Air pollution",indicator:"Annual Average of SO2 Concentration in Ambient Air (change in last 3 years)",value:5,natural_value:-67.3},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air",value:1,natural_value:.4},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air"},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:5,natural_value:-8.2},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air, microgram/m3",value:3,natural_value:49.6},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:2,natural_value:3.8},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air, microgram/m3",value:5,natural_value:.1},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air (change in last 3 years), microgram/m3",value:5,natural_value:-7.2},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air, microgram/m3",value:5,natural_value:16.8},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air (change in last 3 years), microgram/m3",value:1,natural_value:12.1},{category:"Air pollution",indicator:"Volatile organic compounds/reactive organic gases emissions",value:5,natural_value:.6},{category:"Air pollution",indicator:"Perception of air pollution index",value:3,natural_value:1.84},{category:"Air pollution",indicator:"Paris Agreement",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Annual average of dissolved oxygen (DO) concentration in water",value:5,natural_value:4.6},{category:"Water pollution",indicator:"Annual average of pH concentration in water",value:5,natural_value:4.2},{category:"Water pollution",indicator:"Annual average dissolved solids in drinking-water",value:3,natural_value:139},{category:"Water pollution",indicator:"Water management strategy in a city",value:1,natural_value:"no"},{category:"Water pollution",indicator:"Perception of water pollution index",value:4,natural_value:1.5753920145654807},{category:"Land use and waste",indicator:"Share of devastated and degraded land area requiring reclamation",value:3,natural_value:6.7},{category:"Land use and waste",indicator:"3-year average growth rate of devastated and degraded land area requiring reclamation",value:4,natural_value:-.018},{category:"Land use and waste",indicator:"Waste deposits",value:2,natural_value:.013},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous)",value:5,natural_value:16.761630773179},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous), (change in last 3 years)",value:4,natural_value:.94309270238},{category:"Land use and waste",indicator:"Total recycled construction waste",value:3,natural_value:2.041343669},{category:"Land use and waste",indicator:"Share of recycled construction and demolish waste in total generated construction and demolish waste",value:2,natural_value:.06},{category:"Land use and waste",indicator:"Total area of impervious surfaces and percentage to total city area",value:3,natural_value:.02},{category:"Land use and waste",indicator:"Productive urban land (in percent total land)",value:3,natural_value:32.2},{category:"Land use and waste",indicator:"Waste managenet strategy",value:1,natural_value:"no"},{category:"Land use and waste",indicator:"Perception of waste index",value:5,natural_value:2.0883519403371764},{category:"Land use and waste",indicator:"Green spaces, % city area",value:3,natural_value:.1989},{category:"Land use and waste",indicator:"Green spaces, change in last 3 years",value:2,natural_value:-1.6},{category:"Land use and waste",indicator:"NDVI",value:3,natural_value:.25},{category:"Natural disaster hazards",indicator:"Share of total area with altitude above sea level less than 0,5 meters",value:2,natural_value:.15},{category:"Natural disaster hazards",indicator:"Growth rate of freshwater mirror area",value:4,natural_value:-.05},{category:"Natural disaster hazards",indicator:"Number of registered heavy rain, flood and thunderbolt (change in last 3 years)",value:4,natural_value:-.0670521428844533},{category:"Natural disaster hazards",indicator:"Number of registered sand storm (change in last 3 years)",value:4,natural_value:-.186448788952852},{category:"Natural disaster hazards",indicator:"Environmental/natural disasters’ risk mitigation",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Strategy/policy/government officials’ statement on environmental issues ",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Total overall losses from natural disaster hazards",value:3,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of days with average daily temperature above the threshold for 1990-2010",value:3,natural_value:15},{category:"Natural disaster hazards",indicator:"Number of disruptions to basic services, attributed to disasters",value:3,natural_value:0},{category:"Water availability",indicator:"Water consumption per capita",value:3,natural_value:9489999999999999e-21},{category:"Water availability",indicator:"Water tariff to disposable income ratio",value:3,natural_value:.7},{category:"Water availability",indicator:"Sanitary facilities tariff to disposable income ratio",value:2,natural_value:2.1},{category:"Water availability",indicator:"Water consumption per capita (change in last 3 years)",value:3,natural_value:0},{category:"Water availability",indicator:"Percentage of population with access to drinking water",value:3,natural_value:.6},{category:"Water availability",indicator:"Percentage of population with access to drinking water (change in last 3 years)",value:3,natural_value:.011},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities",value:3,natural_value:.311666666666667},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities (change in last 3 years)",value:1,natural_value:.018},{category:"Food availability",indicator:"Cereal import dependency ratio (5-years average)",value:4,natural_value:.042},{category:"Food availability",indicator:"Cereal import dependency ratio (change in last 3 years)",value:4,natural_value:-.1398613725},{category:"Food availability",indicator:"Prevalence of undernourishment",value:3,natural_value:.056},{category:"Food availability",indicator:"Prevalence of undernourishment (change in last 3 years)",value:3,natural_value:-.0101163005900995},{category:"Food availability",indicator:"Prevalence of undernourishment children",value:3,natural_value:.357},{category:"Food availability",indicator:"Prevalence of undernourishment children (change in last 3 years)",value:3,natural_value:-.0158254476471159},{category:"Food availability",indicator:"Prevalence of moderate or severe food insecurity in the population",value:2,natural_value:.5685},{category:"Food availability",indicator:"Share of imports in food resources",value:3,natural_value:.36},{category:"Food availability",indicator:"Percentage of people with access to at least one food vendor/retailer within 15 minutes of walking",value:3,natural_value:91},{category:"Food availability",indicator:"Perception of food availability index",value:5,natural_value:3.3307200778133215},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity",value:1,natural_value:.401},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity (change in last 3 years)",value:5,natural_value:.0423866522560024},{category:"Energy availability",indicator:"Consumption of electricity per capita",value:4,natural_value:915.5},{category:"Energy availability",indicator:"Consumption of electricity per capita (change in last 3 years)",value:2,natural_value:.195999685612988},{category:"Energy availability",indicator:"Electricity tariff to disposable income ratio",value:3,natural_value:.09866666666666668},{category:"Energy availability",indicator:"Share of renewable sources in electricity consumption",value:3,natural_value:.21},{category:"Energy availability",indicator:"Perception of energy availability index",value:2,natural_value:1.7464372477518388},{category:"Health",indicator:"Child mortality rate (under 5 years-old)",value:4,natural_value:4.86666666666667},{category:"Health",indicator:"City ambulance",value:5,natural_value:"yes"},{category:"Health",indicator:"Life expectancy at birth, years",value:2,natural_value:66.33333333333333},{category:"Health",indicator:"Life expectancy at birth goals",value:5,natural_value:"3. Country/city has a plan aimed directly at achieving of increasing LEaB"},{category:"Health",indicator:"Number of hospital beds per 1,000 population",value:4,natural_value:.9},{category:"Health",indicator:"Number of doctors per 1,000 population",value:4,natural_value:.1},{category:"Health",indicator:"Maternal mortality ratio",value:3,natural_value:49},{category:"Health",indicator:"Ambulance arrival speed, min",value:3,natural_value:70},{category:"Education",indicator:"Literacy rate among population (15-24 Years)",value:2,natural_value:.866666666666667},{category:"Education",indicator:"Literacy rate among population (15-24 Years) (change in last 3 years)",value:4,natural_value:.00769260999601173},{category:"Education",indicator:"Primary education engagement",value:3,natural_value:.8430377},{category:"Education",indicator:"Pupils per teacher rate",value:1,natural_value:41},{category:"Education",indicator:"Proportion of population with post-secondary and higher education",value:2,natural_value:.02555639982},{category:"Wealth",indicator:"Percentage of population with food expenditure is above 52% of total expenditure",value:3,natural_value:.143333333333333},{category:"Wealth",indicator:"Mean monthly salary",value:2,natural_value:198.89333333333332},{category:"Wealth",indicator:"Mean monthly salary, change in last 3 years",value:2,natural_value:-.0647021383543841},{category:"Wealth",indicator:"Disposable monthly income",value:2,natural_value:277.8994829014047},{category:"Wealth",indicator:"Disposable monthly income (change in last 3 years)",value:2,natural_value:-.0154922656223049},{category:"Wealth",indicator:"Debt to salary ratio",value:3,natural_value:3.83754800973528},{category:"Wealth",indicator:"Number of mobile phones per 1,000 population",value:4,natural_value:82.66666666666666},{category:"Wealth",indicator:"Decile income coefficient",value:3,natural_value:11.391264367816092},{category:"Wealth",indicator:"Decile income coefficient (change in last 3 years)",value:3,natural_value:-.036482129845679},{category:"Wealth",indicator:"Poverty headcount ratio at national poverty lines",value:3,natural_value:.333333333333333},{category:"Wealth",indicator:"Working poverty rate (percentage of employed living below US$1.90 PPP), 15+ age (%) ",value:3,natural_value:.032},{category:"Wealth",indicator:"Poverty headcount ratio at $2.15 PPP 2017 a day",value:3,natural_value:.0346666666666667},{category:"Wealth",indicator:"Living spaces per capita, sq m (change in last 3 years)",value:1,natural_value:0},{category:"Wealth",indicator:"Population living in slums (% of urban population)",value:3,natural_value:.17},{category:"Wealth",indicator:"Availability of finance (consumer loans)",value:3,natural_value:.5},{category:"Wealth",indicator:"Perception of wealth & poverty index",value:2,natural_value:1.8715798707389055},{category:"Safety",indicator:"Road fatalities rate per 100,000 population",value:1,natural_value:383.3333333333333},{category:"Safety",indicator:"Road fatalities rate per 100,000 population (change in last 3 years)",value:2,natural_value:-.14},{category:"Safety",indicator:"Violent crime rate per 100,000 population",value:3,natural_value:7.240165689817097},{category:"Safety",indicator:"Violent crime rate per 100,000 population (change in last 3 years)",value:3,natural_value:-.00832504805114254},{category:"Safety",indicator:"Crime rate per 100,000 population",value:4,natural_value:56},{category:"Safety",indicator:"Crime rate per 100,000 population  (change in last 3 years)",value:4,natural_value:-.00832504805114254},{category:"Safety",indicator:"Police arrival speed",value:2,natural_value:28},{category:"Safety",indicator:"Perception of safety index",value:2,natural_value:3.475},{category:"Livability",indicator:"Number of LEED certified green buildings",value:2,natural_value:.0009965494125590817},{category:"Livability",indicator:"Number of CEEQUAL certified projects",value:1,natural_value:0},{category:"Livability",indicator:"Whether or not the city has ISO 37120 certification",value:1,natural_value:"no"},{category:"Livability",indicator:"Mobile connection coverage",value:3,natural_value:.95},{category:"Livability",indicator:"Internet coverage",value:2,natural_value:.85},{category:"Livability",indicator:"Perception of livability index",value:3,natural_value:1.4694013205984446},{category:"Livability",indicator:"Share of population in 1 km from hospitals",value:4,natural_value:97.5},{category:"Livability",indicator:"Share of population in 1 km from parks",value:2,natural_value:34.4},{category:"Transport",indicator:"Time loss in traffic",value:3,natural_value:22.9},{category:"Transport",indicator:"Share of the population in 1 km from public transport stop",value:2,natural_value:48.2},{category:"Transport",indicator:"Ratio of the cost of monthly public transport usage Ithe cheapest option) to average mobthly income",value:3,natural_value:.04},{category:"Transport",indicator:"Ratio of the cost of a 1-kilometer taxi ride to average mobthly income",value:3,natural_value:.04},{category:"Transport",indicator:"Percentage of city's roads that are segregated and/or has specialized lane for cyclists",value:3,natural_value:.06},{category:"Transport",indicator:"Number of public electric vehicle (EV) charging points per 100,000 population",value:3,natural_value:1.4},{category:"Transport",indicator:"Public transport (excluding subway) operates by schedule ",value:5,natural_value:"yes"},{category:"Transport",indicator:"Perception of transport index",value:3,natural_value:1.4694013205984446},{category:"Inclusion",indicator:"Female-friendly city",value:4,natural_value:"2"},{category:"Inclusion",indicator:"Number of refugees per 1,000 population",value:4,natural_value:.034},{category:"Inclusion",indicator:"Homeless people per 1,000 population",value:3,natural_value:1.889719188959608},{category:"Inclusion",indicator:"Difference in number of years of schooling between woman and man, woman to man ratio ",value:1,natural_value:5.45},{category:"Inclusion",indicator:"Slavery index",value:5,natural_value:2.9},{category:"Inclusion",indicator:"Percentage of women aged 25-34 years old that have successfully completed secondary education",value:3,natural_value:.423},{category:"Inclusion",indicator:"Regulations for building construction and equipment, public transport for people with disabilities",value:1,natural_value:"no"},{category:"Inclusion",indicator:"Perception of inclusion index",value:4,natural_value:2.0596216601999084},{category:"Accountability",indicator:"City budget execution publication",value:1,natural_value:"no"},{category:"Accountability",indicator:"City budget publication",value:1,natural_value:"no"},{category:"Accountability",indicator:"Financial transparency on city government companies",value:5,natural_value:"yes"},{category:"Accountability",indicator:"ISO certification",value:1,natural_value:"no"},{category:"Accountability",indicator:"City council checks and balances",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Plans to obtain ISO certification",value:1,natural_value:"no"},{category:"Accountability",indicator:"Perception of accountability index",value:1,natural_value:1.2774937108588444},{category:"City budget",indicator:"Poor financial condition",value:5,natural_value:"no"},{category:"City budget",indicator:"Central/higher level government financial intervention taking place",value:5,natural_value:"no"},{category:"City budget",indicator:"Long-term financial planning",value:1,natural_value:"no"},{category:"City budget",indicator:"Central/higher level government financial intervention is considered",value:1,natural_value:"no"},{category:"City budget",indicator:"Prudent fiscal policy requirements",value:1,natural_value:"no"},{category:"City budget",indicator:"Medium-term planning",value:5,natural_value:"yes"},{category:"SME",indicator:"Number of SMEs per 100,000 population",value:1,natural_value:32893.42962791773},{category:"SME",indicator:"Number of start-ups",value:3,natural_value:334.3530666666667},{category:"SME",indicator:"Global Startup Ecosystem Index",value:1,natural_value:.336},{category:"SME",indicator:"Number of SMEs per capita/100 000 population (change in last 3 years)",value:3,natural_value:0},{category:"SME",indicator:"Number of start-ups (change in last 3 years)",value:1,natural_value:.396709338846017},{category:"Public services",indicator:"Free phone to call the police, ambulance, firefighters",value:5,natural_value:"yes"},{category:"Public services",indicator:"Services for working with citizens' appeals and complaint",value:5,natural_value:"yes"},{category:"Public services",indicator:"E-gov services",value:5,natural_value:"yes"},{category:"Public services",indicator:"Perception of public services index: Public Services",value:2,natural_value:2.221932145814465},{category:"Sustainability commitment",indicator:"City ESG reporting",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"City ESG reporting verification",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"ESG planning",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"Plan with specific targets to develop and implement smart city principles",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"Rollout and status of ESG / UN SDG training across the municipal/asset workforce",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"City municipality involved in network or partnership promoting sustainable development (for example, C40 Cities network)",value:1,natural_value:"no"}]},{city:"Adoni",data:[{category:"Air pollution",indicator:"CO2 emissions",value:4,natural_value:1.6},{category:"Air pollution",indicator:"CO2 emissions (change in last 3 years)",value:3,natural_value:2.7},{category:"Air pollution",indicator:"CO2 concentration",value:3,natural_value:435.7},{category:"Air pollution",indicator:"CO2 concentration (change in last 3 years)",value:3,natural_value:2.4},{category:"Air pollution",indicator:"Annual average of SO2 concentration in ambient air",value:4,natural_value:5.1},{category:"Air pollution",indicator:"Annual Average of SO2 Concentration in Ambient Air (change in last 3 years)",value:4,natural_value:-52.2},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air",value:2,natural_value:10.2},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air"},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:4,natural_value:-1.6},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air, microgram/m3",value:2,natural_value:73.1},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:2,natural_value:3.1},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air, microgram/m3",value:3,natural_value:.4},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:.1},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air, microgram/m3",value:4,natural_value:53.6},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air (change in last 3 years), microgram/m3",value:1,natural_value:21.7},{category:"Air pollution",indicator:"Volatile organic compounds/reactive organic gases emissions",value:2,natural_value:2.1},{category:"Air pollution",indicator:"Perception of air pollution index",value:1,natural_value:3.51},{category:"Air pollution",indicator:"Paris Agreement",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Annual average of dissolved oxygen (DO) concentration in water",value:3,natural_value:6.364666666666667},{category:"Water pollution",indicator:"Annual average of pH concentration in water",value:2,natural_value:7.48},{category:"Water pollution",indicator:"Annual average dissolved solids in drinking-water",value:3,natural_value:139},{category:"Water pollution",indicator:"Water management strategy in a city",value:1,natural_value:"no"},{category:"Water pollution",indicator:"Perception of water pollution index",value:1,natural_value:4.237722036452691},{category:"Land use and waste",indicator:"Share of devastated and degraded land area requiring reclamation",value:4,natural_value:3.2},{category:"Land use and waste",indicator:"3-year average growth rate of devastated and degraded land area requiring reclamation",value:2,natural_value:.034},{category:"Land use and waste",indicator:"Waste deposits",value:1,natural_value:.02467},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous)",value:5,natural_value:43.57403004271947},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous), (change in last 3 years)",value:3,natural_value:3.0448031884},{category:"Land use and waste",indicator:"Total recycled construction waste",value:1,natural_value:.001049303},{category:"Land use and waste",indicator:"Share of recycled construction and demolish waste in total generated construction and demolish waste",value:3,natural_value:.137},{category:"Land use and waste",indicator:"Total area of impervious surfaces and percentage to total city area",value:3,natural_value:.02},{category:"Land use and waste",indicator:"Productive urban land (in percent total land)",value:3,natural_value:32.2},{category:"Land use and waste",indicator:"Waste managenet strategy",value:1,natural_value:"no"},{category:"Land use and waste",indicator:"Perception of waste index",value:4,natural_value:2.4809015475033926},{category:"Land use and waste",indicator:"Green spaces, % city area",value:4,natural_value:.4061},{category:"Land use and waste",indicator:"Green spaces, change in last 3 years",value:3,natural_value:.9},{category:"Land use and waste",indicator:"NDVI",value:3,natural_value:.24},{category:"Natural disaster hazards",indicator:"Share of total area with altitude above sea level less than 0,5 meters",value:5,natural_value:0},{category:"Natural disaster hazards",indicator:"Growth rate of freshwater mirror area",value:3,natural_value:-.1},{category:"Natural disaster hazards",indicator:"Number of registered heavy rain, flood and thunderbolt (change in last 3 years)",value:3,natural_value:-.0390013286126644},{category:"Natural disaster hazards",indicator:"Number of registered sand storm (change in last 3 years)",value:3,natural_value:-.068012954951526},{category:"Natural disaster hazards",indicator:"Environmental/natural disasters’ risk mitigation",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Strategy/policy/government officials’ statement on environmental issues ",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Total overall losses from natural disaster hazards",value:3,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of days with average daily temperature above the threshold for 1990-2010",value:3,natural_value:15},{category:"Natural disaster hazards",indicator:"Number of disruptions to basic services, attributed to disasters",value:3,natural_value:0},{category:"Water availability",indicator:"Water consumption per capita",value:3,natural_value:.0005761166037365854},{category:"Water availability",indicator:"Water tariff to disposable income ratio",value:5,natural_value:0},{category:"Water availability",indicator:"Sanitary facilities tariff to disposable income ratio",value:1,natural_value:2.5},{category:"Water availability",indicator:"Water consumption per capita (change in last 3 years)",value:3,natural_value:0},{category:"Water availability",indicator:"Percentage of population with access to drinking water",value:3,natural_value:.94},{category:"Water availability",indicator:"Percentage of population with access to drinking water (change in last 3 years)",value:3,natural_value:0},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities",value:3,natural_value:.683333333333333},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities (change in last 3 years)",value:3,natural_value:.029},{category:"Food availability",indicator:"Cereal import dependency ratio (5-years average)",value:4,natural_value:-.0563333333333333},{category:"Food availability",indicator:"Cereal import dependency ratio (change in last 3 years)",value:2,natural_value:.06488171074},{category:"Food availability",indicator:"Prevalence of undernourishment",value:3,natural_value:.056},{category:"Food availability",indicator:"Prevalence of undernourishment (change in last 3 years)",value:3,natural_value:.0666991349319599},{category:"Food availability",indicator:"Prevalence of undernourishment children",value:3,natural_value:.357},{category:"Food availability",indicator:"Prevalence of undernourishment children (change in last 3 years)",value:3,natural_value:-.0182411646604512},{category:"Food availability",indicator:"Prevalence of moderate or severe food insecurity in the population",value:3,natural_value:.406},{category:"Food availability",indicator:"Share of imports in food resources",value:3,natural_value:.36},{category:"Food availability",indicator:"Percentage of people with access to at least one food vendor/retailer within 15 minutes of walking",value:3,natural_value:91},{category:"Food availability",indicator:"Perception of food availability index",value:3,natural_value:2.0123986386340906},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity",value:3,natural_value:.973333333333333},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity (change in last 3 years)",value:4,natural_value:.0126986796536908},{category:"Energy availability",indicator:"Consumption of electricity per capita",value:4,natural_value:758.3852989040864},{category:"Energy availability",indicator:"Consumption of electricity per capita (change in last 3 years)",value:3,natural_value:.0299415138727994},{category:"Energy availability",indicator:"Electricity tariff to disposable income ratio",value:3,natural_value:.09233333333333334},{category:"Energy availability",indicator:"Share of renewable sources in electricity consumption",value:3,natural_value:.21},{category:"Energy availability",indicator:"Perception of energy availability index",value:3,natural_value:1.115973148644494},{category:"Health",indicator:"Child mortality rate (under 5 years-old)",value:4,natural_value:5.86666666666667},{category:"Health",indicator:"City ambulance",value:5,natural_value:"yes"},{category:"Health",indicator:"Life expectancy at birth, years",value:2,natural_value:71.85},{category:"Health",indicator:"Life expectancy at birth goals",value:1,natural_value:"1. No plans aimed at achieving any of components of Goal 3 or increasing LEaB"},{category:"Health",indicator:"Number of hospital beds per 1,000 population",value:4,natural_value:.4841105354058722},{category:"Health",indicator:"Number of doctors per 1,000 population",value:4,natural_value:.7530765255860573},{category:"Health",indicator:"Maternal mortality ratio",value:3,natural_value:49},{category:"Health",indicator:"Ambulance arrival speed, min",value:3,natural_value:70},{category:"Education",indicator:"Literacy rate among population (15-24 Years)",value:2,natural_value:.774433333333333},{category:"Education",indicator:"Literacy rate among population (15-24 Years) (change in last 3 years)",value:3,natural_value:0},{category:"Education",indicator:"Primary education engagement",value:5,natural_value:.9706456},{category:"Education",indicator:"Pupils per teacher rate",value:2,natural_value:30},{category:"Education",indicator:"Proportion of population with post-secondary and higher education",value:2,natural_value:.0911604537342698},{category:"Wealth",indicator:"Percentage of population with food expenditure is above 52% of total expenditure",value:3,natural_value:.213333333333333},{category:"Wealth",indicator:"Mean monthly salary",value:3,natural_value:2768.8000000000006},{category:"Wealth",indicator:"Mean monthly salary, change in last 3 years",value:3,natural_value:.0196642582706827},{category:"Wealth",indicator:"Disposable monthly income",value:3,natural_value:733.0256252983403},{category:"Wealth",indicator:"Disposable monthly income (change in last 3 years)",value:5,natural_value:.125516966254866},{category:"Wealth",indicator:"Debt to salary ratio",value:3,natural_value:9.29401497117486},{category:"Wealth",indicator:"Number of mobile phones per 1,000 population",value:3,natural_value:82.66666666666666},{category:"Wealth",indicator:"Decile income coefficient",value:3,natural_value:8.6890756302521},{category:"Wealth",indicator:"Decile income coefficient (change in last 3 years)",value:3,natural_value:.011},{category:"Wealth",indicator:"Poverty headcount ratio at national poverty lines",value:3,natural_value:.273333333333333},{category:"Wealth",indicator:"Working poverty rate (percentage of employed living below US$1.90 PPP), 15+ age (%) ",value:3,natural_value:.03},{category:"Wealth",indicator:"Poverty headcount ratio at $2.15 PPP 2017 a day",value:3,natural_value:.042},{category:"Wealth",indicator:"Living spaces per capita, sq m (change in last 3 years)",value:1,natural_value:0},{category:"Wealth",indicator:"Population living in slums (% of urban population)",value:3,natural_value:.17},{category:"Wealth",indicator:"Availability of finance (consumer loans)",value:3,natural_value:.5},{category:"Wealth",indicator:"Perception of wealth & poverty index",value:4,natural_value:1.4613529663376146},{category:"Safety",indicator:"Road fatalities rate per 100,000 population",value:4,natural_value:10.666666666666666},{category:"Safety",indicator:"Road fatalities rate per 100,000 population (change in last 3 years)",value:5,natural_value:.208},{category:"Safety",indicator:"Violent crime rate per 100,000 population",value:2,natural_value:16.48181321670989},{category:"Safety",indicator:"Violent crime rate per 100,000 population (change in last 3 years)",value:3,natural_value:.0275130980808507},{category:"Safety",indicator:"Crime rate per 100,000 population",value:3,natural_value:2391.3621676725943},{category:"Safety",indicator:"Crime rate per 100,000 population  (change in last 3 years)",value:5,natural_value:.0275130980808507},{category:"Safety",indicator:"Police arrival speed",value:2,natural_value:24.89},{category:"Safety",indicator:"Perception of safety index",value:2,natural_value:3.665},{category:"Livability",indicator:"Number of LEED certified green buildings",value:2,natural_value:.01973773861260913},{category:"Livability",indicator:"Number of CEEQUAL certified projects",value:1,natural_value:0},{category:"Livability",indicator:"Whether or not the city has ISO 37120 certification",value:1,natural_value:"no"},{category:"Livability",indicator:"Mobile connection coverage",value:3,natural_value:.9},{category:"Livability",indicator:"Internet coverage",value:4,natural_value:.967666666666667},{category:"Livability",indicator:"Perception of livability index",value:3,natural_value:2.068296237483395},{category:"Livability",indicator:"Share of population in 1 km from hospitals",value:4,natural_value:98.3},{category:"Livability",indicator:"Share of population in 1 km from parks",value:4,natural_value:70.4},{category:"Transport",indicator:"Time loss in traffic",value:4,natural_value:7.8},{category:"Transport",indicator:"Share of the population in 1 km from public transport stop",value:3,natural_value:26.6},{category:"Transport",indicator:"Ratio of the cost of monthly public transport usage Ithe cheapest option) to average mobthly income",value:3,natural_value:.04},{category:"Transport",indicator:"Ratio of the cost of a 1-kilometer taxi ride to average mobthly income",value:3,natural_value:.04},{category:"Transport",indicator:"Percentage of city's roads that are segregated and/or has specialized lane for cyclists",value:3,natural_value:.06},{category:"Transport",indicator:"Number of public electric vehicle (EV) charging points per 100,000 population",value:3,natural_value:1.4},{category:"Transport",indicator:"Public transport (excluding subway) operates by schedule ",value:5,natural_value:"yes"},{category:"Transport",indicator:"Perception of transport index",value:2,natural_value:2.068296237483395},{category:"Inclusion",indicator:"Female-friendly city",value:4,natural_value:2},{category:"Inclusion",indicator:"Number of refugees per 1,000 population",value:4,natural_value:.154},{category:"Inclusion",indicator:"Homeless people per 1,000 population",value:3,natural_value:1.889719188959608},{category:"Inclusion",indicator:"Difference in number of years of schooling between woman and man, woman to man ratio ",value:1,natural_value:6.365},{category:"Inclusion",indicator:"Slavery index",value:4,natural_value:8},{category:"Inclusion",indicator:"Percentage of women aged 25-34 years old that have successfully completed secondary education",value:3,natural_value:.348},{category:"Inclusion",indicator:"Regulations for building construction and equipment, public transport for people with disabilities",value:1,natural_value:"no"},{category:"Inclusion",indicator:"Perception of inclusion index",value:1,natural_value:3.724379588475344},{category:"Accountability",indicator:"City budget execution publication",value:1,natural_value:"no"},{category:"Accountability",indicator:"City budget publication",value:1,natural_value:"no"},{category:"Accountability",indicator:"Financial transparency on city government companies",value:1,natural_value:"no"},{category:"Accountability",indicator:"ISO certification",value:1,natural_value:"no"},{category:"Accountability",indicator:"City council checks and balances",value:1,natural_value:"no"},{category:"Accountability",indicator:"Plans to obtain ISO certification",value:1,natural_value:"no"},{category:"Accountability",indicator:"Perception of accountability index",value:4,natural_value:.5427410395046992},{category:"City budget",indicator:"Poor financial condition",value:5,natural_value:"no"},{category:"City budget",indicator:"Central/higher level government financial intervention taking place",value:5,natural_value:"no"},{category:"City budget",indicator:"Long-term financial planning",value:1,natural_value:"no"},{category:"City budget",indicator:"Central/higher level government financial intervention is considered",value:1,natural_value:"no"},{category:"City budget",indicator:"Prudent fiscal policy requirements",value:1,natural_value:"no"},{category:"City budget",indicator:"Medium-term planning",value:1,natural_value:"no"},{category:"SME",indicator:"Number of SMEs per 100,000 population",value:3,natural_value:383.68866652411435},{category:"SME",indicator:"Number of start-ups",value:2,natural_value:818.3333333333334},{category:"SME",indicator:"Global Startup Ecosystem Index",value:4,natural_value:11.982},{category:"SME",indicator:"Number of SMEs per capita/100 000 population (change in last 3 years)",value:5,natural_value:.595855801785293},{category:"SME",indicator:"Number of start-ups (change in last 3 years)",value:2,natural_value:.245817774855551},{category:"Public services",indicator:"Free phone to call the police, ambulance, firefighters",value:5,natural_value:"yes"},{category:"Public services",indicator:"Services for working with citizens' appeals and complaint",value:5,natural_value:"yes"},{category:"Public services",indicator:"E-gov services",value:5,natural_value:"yes"},{category:"Public services",indicator:"Perception of public services index: Public Services",value:1,natural_value:4.805884365936772},{category:"Sustainability commitment",indicator:"City ESG reporting",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"City ESG reporting verification",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"ESG planning",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"Plan with specific targets to develop and implement smart city principles",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"Rollout and status of ESG / UN SDG training across the municipal/asset workforce",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"City municipality involved in network or partnership promoting sustainable development (for example, C40 Cities network)",value:1,natural_value:"no"}]},{city:"Natal",data:[{category:"Air pollution",indicator:"CO2 emissions",value:4,natural_value:1.9},{category:"Air pollution",indicator:"CO2 emissions (change in last 3 years)",value:5,natural_value:-1.2},{category:"Air pollution",indicator:"CO2 concentration",value:5,natural_value:412},{category:"Air pollution",indicator:"CO2 concentration (change in last 3 years)",value:3,natural_value:1.6},{category:"Air pollution",indicator:"Annual average of SO2 concentration in ambient air",value:5,natural_value:.7},{category:"Air pollution",indicator:"Annual Average of SO2 Concentration in Ambient Air (change in last 3 years)",value:4,natural_value:-45.5},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air",value:5,natural_value:1.2},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air"},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:4,natural_value:-2.4},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air, microgram/m3",value:3,natural_value:55.1},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:1,natural_value:6.1},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air, microgram/m3",value:5,natural_value:.1},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:.4},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air, microgram/m3",value:5,natural_value:14.8},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air (change in last 3 years), microgram/m3",value:1,natural_value:21.3},{category:"Air pollution",indicator:"Volatile organic compounds/reactive organic gases emissions",value:4,natural_value:1.3},{category:"Air pollution",indicator:"Perception of air pollution index",value:5,natural_value:.45},{category:"Air pollution",indicator:"Paris Agreement",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Annual average of dissolved oxygen (DO) concentration in water",value:3,natural_value:6.21},{category:"Water pollution",indicator:"Annual average of pH concentration in water",value:2,natural_value:8.05},{category:"Water pollution",indicator:"Annual average dissolved solids in drinking-water",value:3,natural_value:139},{category:"Water pollution",indicator:"Water management strategy in a city",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Perception of water pollution index",value:4,natural_value:1.3706361563678544},{category:"Land use and waste",indicator:"Share of devastated and degraded land area requiring reclamation",value:5,natural_value:1.4},{category:"Land use and waste",indicator:"3-year average growth rate of devastated and degraded land area requiring reclamation",value:3,natural_value:0},{category:"Land use and waste",indicator:"Waste deposits",value:5,natural_value:202e-6},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous)",value:3,natural_value:165.8668566967861},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous), (change in last 3 years)",value:1,natural_value:28.45430686667},{category:"Land use and waste",indicator:"Total recycled construction waste",value:3,natural_value:.02021146977159802},{category:"Land use and waste",indicator:"Share of recycled construction and demolish waste in total generated construction and demolish waste",value:3,natural_value:.21},{category:"Land use and waste",indicator:"Total area of impervious surfaces and percentage to total city area",value:3,natural_value:.02},{category:"Land use and waste",indicator:"Productive urban land (in percent total land)",value:3,natural_value:32.2},{category:"Land use and waste",indicator:"Waste managenet strategy",value:1,natural_value:"no"},{category:"Land use and waste",indicator:"Perception of waste index",value:3,natural_value:1.514098740830482},{category:"Land use and waste",indicator:"Green spaces, % city area",value:4,natural_value:.4585},{category:"Land use and waste",indicator:"Green spaces, change in last 3 years",value:5,natural_value:6.3},{category:"Land use and waste",indicator:"NDVI",value:3,natural_value:.29},{category:"Natural disaster hazards",indicator:"Share of total area with altitude above sea level less than 0,5 meters",value:2,natural_value:.13},{category:"Natural disaster hazards",indicator:"Growth rate of freshwater mirror area",value:5,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of registered heavy rain, flood and thunderbolt (change in last 3 years)",value:3,natural_value:.0549016607508779},{category:"Natural disaster hazards",indicator:"Number of registered sand storm (change in last 3 years)",value:3,natural_value:.02704},{category:"Natural disaster hazards",indicator:"Environmental/natural disasters’ risk mitigation",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Strategy/policy/government officials’ statement on environmental issues ",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Total overall losses from natural disaster hazards",value:3,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of days with average daily temperature above the threshold for 1990-2010",value:3,natural_value:15},{category:"Natural disaster hazards",indicator:"Number of disruptions to basic services, attributed to disasters",value:3,natural_value:0},{category:"Water availability",indicator:"Water consumption per capita",value:2,natural_value:3621e-8},{category:"Water availability",indicator:"Water tariff to disposable income ratio",value:4,natural_value:.8},{category:"Water availability",indicator:"Sanitary facilities tariff to disposable income ratio",value:2,natural_value:1.972},{category:"Water availability",indicator:"Water consumption per capita (change in last 3 years)",value:3,natural_value:-.0743369778509908},{category:"Water availability",indicator:"Percentage of population with access to drinking water",value:4,natural_value:.988666666666667},{category:"Water availability",indicator:"Percentage of population with access to drinking water (change in last 3 years)",value:3,natural_value:.001},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities",value:2,natural_value:.893},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities (change in last 3 years)",value:3,natural_value:.006},{category:"Food availability",indicator:"Cereal import dependency ratio (5-years average)",value:4,natural_value:-.239666666666667},{category:"Food availability",indicator:"Cereal import dependency ratio (change in last 3 years)",value:1,natural_value:.1737694332},{category:"Food availability",indicator:"Prevalence of undernourishment",value:3,natural_value:.056},{category:"Food availability",indicator:"Prevalence of undernourishment (change in last 3 years)",value:3,natural_value:.083},{category:"Food availability",indicator:"Prevalence of undernourishment children",value:3,natural_value:.357},{category:"Food availability",indicator:"Prevalence of undernourishment children (change in last 3 years)",value:3,natural_value:0},{category:"Food availability",indicator:"Prevalence of moderate or severe food insecurity in the population",value:3,natural_value:.284},{category:"Food availability",indicator:"Share of imports in food resources",value:3,natural_value:.36},{category:"Food availability",indicator:"Percentage of people with access to at least one food vendor/retailer within 15 minutes of walking",value:3,natural_value:91},{category:"Food availability",indicator:"Perception of food availability index",value:3,natural_value:2.0848544311905264},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity",value:3,natural_value:.996549443562825},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity (change in last 3 years)",value:1,natural_value:-.001},{category:"Energy availability",indicator:"Consumption of electricity per capita",value:3,natural_value:2554.644235196744},{category:"Energy availability",indicator:"Consumption of electricity per capita (change in last 3 years)",value:3,natural_value:.016},{category:"Energy availability",indicator:"Electricity tariff to disposable income ratio",value:3,natural_value:.159},{category:"Energy availability",indicator:"Share of renewable sources in electricity consumption",value:3,natural_value:.21},{category:"Energy availability",indicator:"Perception of energy availability index",value:2,natural_value:1.6479892845366555},{category:"Health",indicator:"Child mortality rate (under 5 years-old)",value:5,natural_value:1.83},{category:"Health",indicator:"City ambulance",value:5,natural_value:"yes"},{category:"Health",indicator:"Life expectancy at birth, years",value:3,natural_value:74.03233333333333},{category:"Health",indicator:"Life expectancy at birth goals",value:3,natural_value:"2. Country/city has a plan aimed at achieving any of components of Goal 3"},{category:"Health",indicator:"Number of hospital beds per 1,000 population",value:3,natural_value:2.1166666666666667},{category:"Health",indicator:"Number of doctors per 1,000 population",value:4,natural_value:1.26},{category:"Health",indicator:"Maternal mortality ratio",value:3,natural_value:49},{category:"Health",indicator:"Ambulance arrival speed, min",value:3,natural_value:70},{category:"Education",indicator:"Literacy rate among population (15-24 Years)",value:4,natural_value:.992531941731771},{category:"Education",indicator:"Literacy rate among population (15-24 Years) (change in last 3 years)",value:3,natural_value:.001},{category:"Education",indicator:"Primary education engagement",value:5,natural_value:.954859166666667},{category:"Education",indicator:"Pupils per teacher rate",value:3,natural_value:23.826666666666668},{category:"Education",indicator:"Proportion of population with post-secondary and higher education",value:4,natural_value:.377},{category:"Wealth",indicator:"Percentage of population with food expenditure is above 52% of total expenditure",value:3,natural_value:.173333333333333},{category:"Wealth",indicator:"Mean monthly salary",value:3,natural_value:1794.2433333333336},{category:"Wealth",indicator:"Mean monthly salary, change in last 3 years",value:3,natural_value:.00116669528203617},{category:"Wealth",indicator:"Disposable monthly income",value:2,natural_value:312.1303401590869},{category:"Wealth",indicator:"Disposable monthly income (change in last 3 years)",value:2,natural_value:-.0307054183800864},{category:"Wealth",indicator:"Debt to salary ratio",value:2,natural_value:19.4310686264357},{category:"Wealth",indicator:"Number of mobile phones per 1,000 population",value:1,natural_value:98.14033017333333},{category:"Wealth",indicator:"Decile income coefficient",value:3,natural_value:37.56018518518518},{category:"Wealth",indicator:"Decile income coefficient (change in last 3 years)",value:3,natural_value:-.0375928051939775},{category:"Wealth",indicator:"Poverty headcount ratio at national poverty lines",value:3,natural_value:.15},{category:"Wealth",indicator:"Working poverty rate (percentage of employed living below US$1.90 PPP), 15+ age (%) ",value:3,natural_value:.0233333333333333},{category:"Wealth",indicator:"Poverty headcount ratio at $2.15 PPP 2017 a day",value:3,natural_value:.027},{category:"Wealth",indicator:"Living spaces per capita, sq m (change in last 3 years)",value:3,natural_value:.026192},{category:"Wealth",indicator:"Population living in slums (% of urban population)",value:3,natural_value:.17},{category:"Wealth",indicator:"Availability of finance (consumer loans)",value:3,natural_value:.5},{category:"Wealth",indicator:"Perception of wealth & poverty index",value:2,natural_value:2.099160121450789},{category:"Safety",indicator:"Road fatalities rate per 100,000 population",value:2,natural_value:19.073333333333334},{category:"Safety",indicator:"Road fatalities rate per 100,000 population (change in last 3 years)",value:2,natural_value:-.118},{category:"Safety",indicator:"Violent crime rate per 100,000 population",value:2,natural_value:31.899999999999995},{category:"Safety",indicator:"Violent crime rate per 100,000 population (change in last 3 years)",value:3,natural_value:-.00952438823708124},{category:"Safety",indicator:"Crime rate per 100,000 population",value:3,natural_value:67.49},{category:"Safety",indicator:"Crime rate per 100,000 population  (change in last 3 years)",value:4,natural_value:-.00952438823708124},{category:"Safety",indicator:"Police arrival speed",value:3,natural_value:22.5},{category:"Safety",indicator:"Perception of safety index",value:4,natural_value:2.54},{category:"Livability",indicator:"Number of LEED certified green buildings",value:3,natural_value:.09697838620283454},{category:"Livability",indicator:"Number of CEEQUAL certified projects",value:1,natural_value:0},{category:"Livability",indicator:"Whether or not the city has ISO 37120 certification",value:1,natural_value:"no"},{category:"Livability",indicator:"Mobile connection coverage",value:5,natural_value:1},{category:"Livability",indicator:"Internet coverage",value:2,natural_value:.922533333333333},{category:"Livability",indicator:"Perception of livability index",value:4,natural_value:.8072949066928007},{category:"Livability",indicator:"Share of population in 1 km from hospitals",value:4,natural_value:95.6},{category:"Livability",indicator:"Share of population in 1 km from parks",value:4,natural_value:83.6},{category:"Transport",indicator:"Time loss in traffic",value:2,natural_value:34.4},{category:"Transport",indicator:"Share of the population in 1 km from public transport stop",value:3,natural_value:77.3},{category:"Transport",indicator:"Ratio of the cost of monthly public transport usage Ithe cheapest option) to average mobthly income",value:3,natural_value:.04},{category:"Transport",indicator:"Ratio of the cost of a 1-kilometer taxi ride to average mobthly income",value:3,natural_value:.04},{category:"Transport",indicator:"Percentage of city's roads that are segregated and/or has specialized lane for cyclists",value:3,natural_value:.06},{category:"Transport",indicator:"Number of public electric vehicle (EV) charging points per 100,000 population",value:3,natural_value:1.4},{category:"Transport",indicator:"Public transport (excluding subway) operates by schedule ",value:5,natural_value:"yes"},{category:"Transport",indicator:"Perception of transport index",value:4,natural_value:.8072949066928007},{category:"Inclusion",indicator:"Female-friendly city",value:4,natural_value:"2"},{category:"Inclusion",indicator:"Number of refugees per 1,000 population",value:4,natural_value:.24},{category:"Inclusion",indicator:"Homeless people per 1,000 population",value:4,natural_value:1.242280047916944},{category:"Inclusion",indicator:"Difference in number of years of schooling between woman and man, woman to man ratio ",value:3,natural_value:1.05},{category:"Inclusion",indicator:"Slavery index",value:4,natural_value:5},{category:"Inclusion",indicator:"Percentage of women aged 25-34 years old that have successfully completed secondary education",value:4,natural_value:.514},{category:"Inclusion",indicator:"Regulations for building construction and equipment, public transport for people with disabilities",value:5,natural_value:"yes"},{category:"Inclusion",indicator:"Perception of inclusion index",value:4,natural_value:1.6419624913097781},{category:"Accountability",indicator:"City budget execution publication",value:5,natural_value:"yes"},{category:"Accountability",indicator:"City budget publication",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Financial transparency on city government companies",value:1,natural_value:"no"},{category:"Accountability",indicator:"ISO certification",value:1,natural_value:"no"},{category:"Accountability",indicator:"City council checks and balances",value:1,natural_value:"no"},{category:"Accountability",indicator:"Plans to obtain ISO certification",value:1,natural_value:"no"},{category:"Accountability",indicator:"Perception of accountability index",value:2,natural_value:1.0203402004058097},{category:"City budget",indicator:"Poor financial condition",value:5,natural_value:"no"},{category:"City budget",indicator:"Central/higher level government financial intervention taking place",value:5,natural_value:"no"},{category:"City budget",indicator:"Long-term financial planning",value:1,natural_value:"no"},{category:"City budget",indicator:"Central/higher level government financial intervention is considered",value:1,natural_value:"no"},{category:"City budget",indicator:"Prudent fiscal policy requirements",value:1,natural_value:"no"},{category:"City budget",indicator:"Medium-term planning",value:5,natural_value:"yes"},{category:"SME",indicator:"Number of SMEs per 100,000 population",value:1,natural_value:5341.05},{category:"SME",indicator:"Number of start-ups",value:2,natural_value:3},{category:"SME",indicator:"Global Startup Ecosystem Index",value:1,natural_value:.143},{category:"SME",indicator:"Number of SMEs per capita/100 000 population (change in last 3 years)",value:3,natural_value:0},{category:"SME",indicator:"Number of start-ups (change in last 3 years)",value:5,natural_value:0},{category:"Public services",indicator:"Free phone to call the police, ambulance, firefighters",value:5,natural_value:"yes"},{category:"Public services",indicator:"Services for working with citizens' appeals and complaint",value:5,natural_value:"yes"},{category:"Public services",indicator:"E-gov services",value:5,natural_value:"yes"},{category:"Public services",indicator:"Perception of public services index: Public Services",value:4,natural_value:1.398629594433814},{category:"Sustainability commitment",indicator:"City ESG reporting",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"City ESG reporting verification",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"ESG planning",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"Plan with specific targets to develop and implement smart city principles",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"Rollout and status of ESG / UN SDG training across the municipal/asset workforce",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"City municipality involved in network or partnership promoting sustainable development (for example, C40 Cities network)",value:5,natural_value:"yes"}]},{city:"Brazzaville",data:[{category:"Air pollution",indicator:"CO2 emissions",value:4,natural_value:1.25},{category:"Air pollution",indicator:"CO2 emissions (change in last 3 years)",value:3,natural_value:1.2},{category:"Air pollution",indicator:"CO2 concentration",value:2,natural_value:453.6},{category:"Air pollution",indicator:"CO2 concentration (change in last 3 years)",value:3,natural_value:.2},{category:"Air pollution",indicator:"Annual average of SO2 concentration in ambient air",value:4,natural_value:3.3},{category:"Air pollution",indicator:"Annual Average of SO2 Concentration in Ambient Air (change in last 3 years)",value:3,natural_value:23.5},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air",value:4,natural_value:7.5},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air"},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:4,natural_value:-1.9},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air, microgram/m3",value:4,natural_value:42.7},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:5,natural_value:-4.3},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air, microgram/m3",value:2,natural_value:.7},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air (change in last 3 years), microgram/m3",value:4,natural_value:-1.8},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air, microgram/m3",value:3,natural_value:85.2},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:5},{category:"Air pollution",indicator:"Volatile organic compounds/reactive organic gases emissions",value:3,natural_value:1.7},{category:"Air pollution",indicator:"Perception of air pollution index",value:5,natural_value:.73},{category:"Air pollution",indicator:"Paris Agreement",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Annual average of dissolved oxygen (DO) concentration in water",value:5,natural_value:4.45},{category:"Water pollution",indicator:"Annual average of pH concentration in water",value:5,natural_value:4.06},{category:"Water pollution",indicator:"Annual average dissolved solids in drinking-water",value:3,natural_value:139},{category:"Water pollution",indicator:"Water management strategy in a city",value:1,natural_value:"no"},{category:"Water pollution",indicator:"Perception of water pollution index",value:5,natural_value:.45536897331942433},{category:"Land use and waste",indicator:"Share of devastated and degraded land area requiring reclamation",value:5,natural_value:1.8},{category:"Land use and waste",indicator:"3-year average growth rate of devastated and degraded land area requiring reclamation",value:2,natural_value:.091},{category:"Land use and waste",indicator:"Waste deposits",value:5,natural_value:17e-5},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous)",value:3,natural_value:184.6411523451221},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous), (change in last 3 years)",value:4,natural_value:1.08639431138},{category:"Land use and waste",indicator:"Total recycled construction waste",value:3,natural_value:.0202},{category:"Land use and waste",indicator:"Share of recycled construction and demolish waste in total generated construction and demolish waste",value:3,natural_value:.293},{category:"Land use and waste",indicator:"Total area of impervious surfaces and percentage to total city area",value:3,natural_value:.02},{category:"Land use and waste",indicator:"Productive urban land (in percent total land)",value:3,natural_value:32.2},{category:"Land use and waste",indicator:"Waste managenet strategy",value:1,natural_value:"no"},{category:"Land use and waste",indicator:"Perception of waste index",value:4,natural_value:1.810424467560072},{category:"Land use and waste",indicator:"Green spaces, % city area",value:2,natural_value:.0811},{category:"Land use and waste",indicator:"Green spaces, change in last 3 years",value:1,natural_value:-5.5},{category:"Land use and waste",indicator:"NDVI",value:4,natural_value:.15},{category:"Natural disaster hazards",indicator:"Share of total area with altitude above sea level less than 0,5 meters",value:5,natural_value:0},{category:"Natural disaster hazards",indicator:"Growth rate of freshwater mirror area",value:1,natural_value:-.3},{category:"Natural disaster hazards",indicator:"Number of registered heavy rain, flood and thunderbolt (change in last 3 years)",value:3,natural_value:-.0319126617675967},{category:"Natural disaster hazards",indicator:"Number of registered sand storm (change in last 3 years)",value:3,natural_value:-.0395901759852154},{category:"Natural disaster hazards",indicator:"Environmental/natural disasters’ risk mitigation",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Strategy/policy/government officials’ statement on environmental issues ",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Total overall losses from natural disaster hazards",value:3,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of days with average daily temperature above the threshold for 1990-2010",value:3,natural_value:15},{category:"Natural disaster hazards",indicator:"Number of disruptions to basic services, attributed to disasters",value:3,natural_value:0},{category:"Water availability",indicator:"Water consumption per capita",value:2,natural_value:11437737370684483e-21},{category:"Water availability",indicator:"Water tariff to disposable income ratio",value:4,natural_value:.6},{category:"Water availability",indicator:"Sanitary facilities tariff to disposable income ratio",value:4,natural_value:.4},{category:"Water availability",indicator:"Water consumption per capita (change in last 3 years)",value:3,natural_value:-.015502986483292},{category:"Water availability",indicator:"Percentage of population with access to drinking water",value:2,natural_value:.736},{category:"Water availability",indicator:"Percentage of population with access to drinking water (change in last 3 years)",value:3,natural_value:.002},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities",value:3,natural_value:.204},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities (change in last 3 years)",value:2,natural_value:.003},{category:"Food availability",indicator:"Cereal import dependency ratio (5-years average)",value:2,natural_value:.939},{category:"Food availability",indicator:"Cereal import dependency ratio (change in last 3 years)",value:3,natural_value:.01425708551},{category:"Food availability",indicator:"Prevalence of undernourishment",value:3,natural_value:.056},{category:"Food availability",indicator:"Prevalence of undernourishment (change in last 3 years)",value:3,natural_value:.023},{category:"Food availability",indicator:"Prevalence of undernourishment children",value:3,natural_value:.357},{category:"Food availability",indicator:"Prevalence of undernourishment children (change in last 3 years)",value:3,natural_value:-.025},{category:"Food availability",indicator:"Prevalence of moderate or severe food insecurity in the population",value:1,natural_value:.884},{category:"Food availability",indicator:"Share of imports in food resources",value:3,natural_value:.36},{category:"Food availability",indicator:"Percentage of people with access to at least one food vendor/retailer within 15 minutes of walking",value:3,natural_value:91},{category:"Food availability",indicator:"Perception of food availability index",value:2,natural_value:1.7694823312081864},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity",value:2,natural_value:.486883850097656},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity (change in last 3 years)",value:3,natural_value:.013},{category:"Energy availability",indicator:"Consumption of electricity per capita",value:5,natural_value:233.8543925649949},{category:"Energy availability",indicator:"Consumption of electricity per capita (change in last 3 years)",value:1,natural_value:.212},{category:"Energy availability",indicator:"Electricity tariff to disposable income ratio",value:3,natural_value:.15757312},{category:"Energy availability",indicator:"Share of renewable sources in electricity consumption",value:3,natural_value:.21},{category:"Energy availability",indicator:"Perception of energy availability index",value:2,natural_value:1.4623815285284214},{category:"Health",indicator:"Child mortality rate (under 5 years-old)",value:5,natural_value:3.13},{category:"Health",indicator:"City ambulance",value:5,natural_value:"yes"},{category:"Health",indicator:"Life expectancy at birth, years",value:4,natural_value:63.35033333333333},{category:"Health",indicator:"Life expectancy at birth goals",value:1,natural_value:"1. No plans aimed at achieving any of components of Goal 3 or increasing LEaB"},{category:"Health",indicator:"Number of hospital beds per 1,000 population",value:4,natural_value:.8409929205874421},{category:"Health",indicator:"Number of doctors per 1,000 population",value:4,natural_value:.18714517624971974},{category:"Health",indicator:"Maternal mortality ratio",value:3,natural_value:49},{category:"Health",indicator:"Ambulance arrival speed, min",value:3,natural_value:70},{category:"Education",indicator:"Literacy rate among population (15-24 Years)",value:2,natural_value:.817762451171875},{category:"Education",indicator:"Literacy rate among population (15-24 Years) (change in last 3 years)",value:3,natural_value:.006},{category:"Education",indicator:"Primary education engagement",value:3,natural_value:.8437051},{category:"Education",indicator:"Pupils per teacher rate",value:1,natural_value:42.71358024691358},{category:"Education",indicator:"Proportion of population with post-secondary and higher education",value:4,natural_value:.377},{category:"Wealth",indicator:"Percentage of population with food expenditure is above 52% of total expenditure",value:3,natural_value:.156666666666667},{category:"Wealth",indicator:"Mean monthly salary",value:3,natural_value:1282.4291856666666},{category:"Wealth",indicator:"Mean monthly salary, change in last 3 years",value:3,natural_value:-.0266873352529554},{category:"Wealth",indicator:"Disposable monthly income",value:2,natural_value:302.3992620874996},{category:"Wealth",indicator:"Disposable monthly income (change in last 3 years)",value:4,natural_value:.0871101353185355},{category:"Wealth",indicator:"Debt to salary ratio",value:3,natural_value:8.072656977014631},{category:"Wealth",indicator:"Number of mobile phones per 1,000 population",value:1,natural_value:95.70893438666667},{category:"Wealth",indicator:"Decile income coefficient",value:4,natural_value:21.068749999999998},{category:"Wealth",indicator:"Decile income coefficient (change in last 3 years)",value:1,natural_value:.133082229475596},{category:"Wealth",indicator:"Poverty headcount ratio at national poverty lines",value:5,natural_value:19.3333333333333},{category:"Wealth",indicator:"Working poverty rate (percentage of employed living below US$1.90 PPP), 15+ age (%) ",value:4,natural_value:.011},{category:"Wealth",indicator:"Poverty headcount ratio at $2.15 PPP 2017 a day",value:4,natural_value:.0186666666666667},{category:"Wealth",indicator:"Living spaces per capita, sq m (change in last 3 years)",value:1,natural_value:0},{category:"Wealth",indicator:"Population living in slums (% of urban population)",value:3,natural_value:.17},{category:"Wealth",indicator:"Availability of finance (consumer loans)",value:3,natural_value:.5},{category:"Wealth",indicator:"Perception of wealth & poverty index",value:4,natural_value:.7426272126444186},{category:"Safety",indicator:"Road fatalities rate per 100,000 population",value:3,natural_value:29.166666666666668},{category:"Safety",indicator:"Road fatalities rate per 100,000 population (change in last 3 years)",value:3,natural_value:.013},{category:"Safety",indicator:"Violent crime rate per 100,000 population",value:2,natural_value:34.750798202781176},{category:"Safety",indicator:"Violent crime rate per 100,000 population (change in last 3 years)",value:3,natural_value:-.00195060506205014},{category:"Safety",indicator:"Crime rate per 100,000 population",value:3,natural_value:511.29593711362435},{category:"Safety",indicator:"Crime rate per 100,000 population  (change in last 3 years)",value:4,natural_value:-.00195060506205014},{category:"Safety",indicator:"Police arrival speed",value:2,natural_value:31},{category:"Safety",indicator:"Perception of safety index",value:5,natural_value:1.7149999999999999},{category:"Livability",indicator:"Number of LEED certified green buildings",value:2,natural_value:.001253900252388248},{category:"Livability",indicator:"Number of CEEQUAL certified projects",value:1,natural_value:0},{category:"Livability",indicator:"Whether or not the city has ISO 37120 certification",value:1,natural_value:"no"},{category:"Livability",indicator:"Mobile connection coverage",value:1,natural_value:.548333333333333},{category:"Livability",indicator:"Internet coverage",value:1,natural_value:.548333333333333},{category:"Livability",indicator:"Perception of livability index",value:4,natural_value:.9380400918704376},{category:"Livability",indicator:"Share of population in 1 km from hospitals",value:4,natural_value:98.6},{category:"Livability",indicator:"Share of population in 1 km from parks",value:1,natural_value:32.8},{category:"Transport",indicator:"Time loss in traffic",value:1,natural_value:15.7},{category:"Transport",indicator:"Share of the population in 1 km from public transport stop",value:2,natural_value:52.5},{category:"Transport",indicator:"Ratio of the cost of monthly public transport usage Ithe cheapest option) to average mobthly income",value:3,natural_value:.04},{category:"Transport",indicator:"Ratio of the cost of a 1-kilometer taxi ride to average mobthly income",value:3,natural_value:.04},{category:"Transport",indicator:"Percentage of city's roads that are segregated and/or has specialized lane for cyclists",value:3,natural_value:.06},{category:"Transport",indicator:"Number of public electric vehicle (EV) charging points per 100,000 population",value:3,natural_value:1.4},{category:"Transport",indicator:"Public transport (excluding subway) operates by schedule ",value:5,natural_value:"yes"},{category:"Transport",indicator:"Perception of transport index",value:4,natural_value:.9380400918704376},{category:"Inclusion",indicator:"Female-friendly city",value:4,natural_value:"2"},{category:"Inclusion",indicator:"Number of refugees per 1,000 population",value:3,natural_value:9.399},{category:"Inclusion",indicator:"Homeless people per 1,000 population",value:1,natural_value:73.28310431478172},{category:"Inclusion",indicator:"Difference in number of years of schooling between woman and man, woman to man ratio ",value:3,natural_value:1.05},{category:"Inclusion",indicator:"Slavery index",value:4,natural_value:8},{category:"Inclusion",indicator:"Percentage of women aged 25-34 years old that have successfully completed secondary education",value:4,natural_value:.542},{category:"Inclusion",indicator:"Regulations for building construction and equipment, public transport for people with disabilities",value:1,natural_value:"no"},{category:"Inclusion",indicator:"Perception of inclusion index",value:5,natural_value:.8545100144780505},{category:"Accountability",indicator:"City budget execution publication",value:1,natural_value:"no"},{category:"Accountability",indicator:"City budget publication",value:1,natural_value:"no"},{category:"Accountability",indicator:"Financial transparency on city government companies",value:1,natural_value:"no"},{category:"Accountability",indicator:"ISO certification",value:1,natural_value:"no"},{category:"Accountability",indicator:"City council checks and balances",value:1,natural_value:"no"},{category:"Accountability",indicator:"Plans to obtain ISO certification",value:1,natural_value:"no"},{category:"Accountability",indicator:"Perception of accountability index",value:5,natural_value:.3307362014059618},{category:"City budget",indicator:"Poor financial condition",value:1,natural_value:"yes"},{category:"City budget",indicator:"Central/higher level government financial intervention taking place",value:5,natural_value:"no"},{category:"City budget",indicator:"Long-term financial planning",value:1,natural_value:"no"},{category:"City budget",indicator:"Central/higher level government financial intervention is considered",value:1,natural_value:"no"},{category:"City budget",indicator:"Prudent fiscal policy requirements",value:1,natural_value:"no"},{category:"City budget",indicator:"Medium-term planning",value:5,natural_value:"yes"},{category:"SME",indicator:"Number of SMEs per 100,000 population",value:3,natural_value:44.353002254907814},{category:"SME",indicator:"Number of start-ups",value:5,natural_value:2},{category:"SME",indicator:"Global Startup Ecosystem Index",value:1,natural_value:0},{category:"SME",indicator:"Number of SMEs per capita/100 000 population (change in last 3 years)",value:3,natural_value:0},{category:"SME",indicator:"Number of start-ups (change in last 3 years)",value:5,natural_value:0},{category:"Public services",indicator:"Free phone to call the police, ambulance, firefighters",value:5,natural_value:"yes"},{category:"Public services",indicator:"Services for working with citizens' appeals and complaint",value:5,natural_value:"yes"},{category:"Public services",indicator:"E-gov services",value:5,natural_value:"yes"},{category:"Public services",indicator:"Perception of public services index: Public Services",value:5,natural_value:.6852289874246976},{category:"Sustainability commitment",indicator:"City ESG reporting",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"City ESG reporting verification",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"ESG planning",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"Plan with specific targets to develop and implement smart city principles",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"Rollout and status of ESG / UN SDG training across the municipal/asset workforce",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"City municipality involved in network or partnership promoting sustainable development (for example, C40 Cities network)",value:1,natural_value:"no"}]},{city:"Almaty",data:[{category:"Air pollution",indicator:"CO2 emissions",value:2,natural_value:11.3},{category:"Air pollution",indicator:"CO2 emissions (change in last 3 years)",value:3,natural_value:.6},{category:"Air pollution",indicator:"CO2 concentration",value:3,natural_value:433.9},{category:"Air pollution",indicator:"CO2 concentration (change in last 3 years)",value:3,natural_value:2.1},{category:"Air pollution",indicator:"Annual average of SO2 concentration in ambient air",value:4,natural_value:7.2},{category:"Air pollution",indicator:"Annual Average of SO2 Concentration in Ambient Air (change in last 3 years)",value:4,natural_value:-28.2},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air",value:5,natural_value:9.2},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air"},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:4,natural_value:-1.3},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air, microgram/m3",value:2,natural_value:76.6},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:5,natural_value:-5.5},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air, microgram/m3",value:4,natural_value:.2},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air (change in last 3 years), microgram/m3",value:4,natural_value:-4.9},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air, microgram/m3",value:5,natural_value:18.6},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air (change in last 3 years), microgram/m3",value:5,natural_value:-11.3},{category:"Air pollution",indicator:"Volatile organic compounds/reactive organic gases emissions",value:4,natural_value:1.2},{category:"Air pollution",indicator:"Perception of air pollution index",value:3,natural_value:1.77},{category:"Air pollution",indicator:"Paris Agreement",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Annual average of dissolved oxygen (DO) concentration in water",value:3,natural_value:6.32},{category:"Water pollution",indicator:"Annual average of pH concentration in water",value:2,natural_value:7.933333333333334},{category:"Water pollution",indicator:"Annual average dissolved solids in drinking-water",value:3,natural_value:139},{category:"Water pollution",indicator:"Water management strategy in a city",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Perception of water pollution index",value:2,natural_value:2.4280063619803385},{category:"Land use and waste",indicator:"Share of devastated and degraded land area requiring reclamation",value:5,natural_value:1.7},{category:"Land use and waste",indicator:"3-year average growth rate of devastated and degraded land area requiring reclamation",value:4,natural_value:-.05},{category:"Land use and waste",indicator:"Waste deposits",value:5,natural_value:21e-5},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous)",value:3,natural_value:218.70589992818873},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous), (change in last 3 years)",value:4,natural_value:2.06527603657},{category:"Land use and waste",indicator:"Total recycled construction waste",value:3,natural_value:.0202},{category:"Land use and waste",indicator:"Share of recycled construction and demolish waste in total generated construction and demolish waste",value:2,natural_value:.018},{category:"Land use and waste",indicator:"Total area of impervious surfaces and percentage to total city area",value:3,natural_value:.02},{category:"Land use and waste",indicator:"Productive urban land (in percent total land)",value:3,natural_value:32.2},{category:"Land use and waste",indicator:"Waste managenet strategy",value:1,natural_value:"no"},{category:"Land use and waste",indicator:"Perception of waste index",value:4,natural_value:3.672950776137062},{category:"Land use and waste",indicator:"Green spaces, % city area",value:3,natural_value:.2334},{category:"Land use and waste",indicator:"Green spaces, change in last 3 years",value:4,natural_value:1.8},{category:"Land use and waste",indicator:"NDVI",value:4,natural_value:.18},{category:"Natural disaster hazards",indicator:"Share of total area with altitude above sea level less than 0,5 meters",value:5,natural_value:0},{category:"Natural disaster hazards",indicator:"Growth rate of freshwater mirror area",value:5,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of registered heavy rain, flood and thunderbolt (change in last 3 years)",value:2,natural_value:.0971033487259057},{category:"Natural disaster hazards",indicator:"Number of registered sand storm (change in last 3 years)",value:2,natural_value:.310370697104448},{category:"Natural disaster hazards",indicator:"Environmental/natural disasters’ risk mitigation",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Strategy/policy/government officials’ statement on environmental issues ",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Total overall losses from natural disaster hazards",value:3,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of days with average daily temperature above the threshold for 1990-2010",value:3,natural_value:15},{category:"Natural disaster hazards",indicator:"Number of disruptions to basic services, attributed to disasters",value:3,natural_value:0},{category:"Water availability",indicator:"Water consumption per capita",value:4,natural_value:3.483},{category:"Water availability",indicator:"Water tariff to disposable income ratio",value:3,natural_value:1.2},{category:"Water availability",indicator:"Sanitary facilities tariff to disposable income ratio",value:5,natural_value:.056},{category:"Water availability",indicator:"Water consumption per capita (change in last 3 years)",value:3,natural_value:-.005},{category:"Water availability",indicator:"Percentage of population with access to drinking water",value:3,natural_value:.976},{category:"Water availability",indicator:"Percentage of population with access to drinking water (change in last 3 years)",value:3,natural_value:.003},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities",value:3,natural_value:.722},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities (change in last 3 years)",value:3,natural_value:.024},{category:"Food availability",indicator:"Cereal import dependency ratio (5-years average)",value:5,natural_value:-.823333333333333},{category:"Food availability",indicator:"Cereal import dependency ratio (change in last 3 years)",value:3,natural_value:.0689057773},{category:"Food availability",indicator:"Prevalence of undernourishment",value:3,natural_value:.056},{category:"Food availability",indicator:"Prevalence of undernourishment (change in last 3 years)",value:1,natural_value:.223},{category:"Food availability",indicator:"Prevalence of undernourishment children",value:3,natural_value:.357},{category:"Food availability",indicator:"Prevalence of undernourishment children (change in last 3 years)",value:2,natural_value:-.055},{category:"Food availability",indicator:"Prevalence of moderate or severe food insecurity in the population",value:5,natural_value:.052},{category:"Food availability",indicator:"Share of imports in food resources",value:3,natural_value:.36},{category:"Food availability",indicator:"Percentage of people with access to at least one food vendor/retailer within 15 minutes of walking",value:3,natural_value:91},{category:"Food availability",indicator:"Perception of food availability index",value:4,natural_value:2.7911336002553444},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity",value:5,natural_value:1},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity (change in last 3 years)",value:3,natural_value:0},{category:"Energy availability",indicator:"Consumption of electricity per capita",value:4,natural_value:744.0523414104803},{category:"Energy availability",indicator:"Consumption of electricity per capita (change in last 3 years)",value:4,natural_value:0},{category:"Energy availability",indicator:"Electricity tariff to disposable income ratio",value:4,natural_value:.046000000000000006},{category:"Energy availability",indicator:"Share of renewable sources in electricity consumption",value:3,natural_value:.21},{category:"Energy availability",indicator:"Perception of energy availability index",value:1,natural_value:2.215077404374128},{category:"Health",indicator:"Child mortality rate (under 5 years-old)",value:5,natural_value:.949666666666667},{category:"Health",indicator:"City ambulance",value:5,natural_value:"yes"},{category:"Health",indicator:"Life expectancy at birth, years",value:3,natural_value:74.43666666666667},{category:"Health",indicator:"Life expectancy at birth goals",value:5,natural_value:"3. Country/city has a plan aimed directly at achieving of increasing LEaB"},{category:"Health",indicator:"Number of hospital beds per 1,000 population",value:2,natural_value:5.311479254299262},{category:"Health",indicator:"Number of doctors per 1,000 population",value:3,natural_value:6.822767921629207},{category:"Health",indicator:"Maternal mortality ratio",value:3,natural_value:49},{category:"Health",indicator:"Ambulance arrival speed, min",value:3,natural_value:70},{category:"Education",indicator:"Literacy rate among population (15-24 Years)",value:5,natural_value:.998982416788737},{category:"Education",indicator:"Literacy rate among population (15-24 Years) (change in last 3 years)",value:3,natural_value:0},{category:"Education",indicator:"Primary education engagement",value:5,natural_value:.961578066666667},{category:"Education",indicator:"Pupils per teacher rate",value:3,natural_value:18.502333333333333},{category:"Education",indicator:"Proportion of population with post-secondary and higher education",value:5,natural_value:.634474207560221},{category:"Wealth",indicator:"Percentage of population with food expenditure is above 52% of total expenditure",value:3,natural_value:.14},{category:"Wealth",indicator:"Mean monthly salary",value:3,natural_value:2901.12},{category:"Wealth",indicator:"Mean monthly salary, change in last 3 years",value:5,natural_value:.0970823344626255},{category:"Wealth",indicator:"Disposable monthly income",value:3,natural_value:521.0737469923129},{category:"Wealth",indicator:"Disposable monthly income (change in last 3 years)",value:3,natural_value:-.0155428529827583},{category:"Wealth",indicator:"Debt to salary ratio",value:4,natural_value:2.6836602741196},{category:"Wealth",indicator:"Number of mobile phones per 1,000 population",value:2,natural_value:90.56666666666668},{category:"Wealth",indicator:"Decile income coefficient",value:5,natural_value:5.4751039235044985},{category:"Wealth",indicator:"Decile income coefficient (change in last 3 years)",value:3,natural_value:-.036},{category:"Wealth",indicator:"Poverty headcount ratio at national poverty lines",value:3,natural_value:.186666666666667},{category:"Wealth",indicator:"Working poverty rate (percentage of employed living below US$1.90 PPP), 15+ age (%) ",value:4,natural_value:.0156666666666667},{category:"Wealth",indicator:"Poverty headcount ratio at $2.15 PPP 2017 a day",value:4,natural_value:.0163333333333333},{category:"Wealth",indicator:"Living spaces per capita, sq m (change in last 3 years)",value:2,natural_value:.0117657852745596},{category:"Wealth",indicator:"Population living in slums (% of urban population)",value:3,natural_value:.17},{category:"Wealth",indicator:"Availability of finance (consumer loans)",value:3,natural_value:.5},{category:"Wealth",indicator:"Perception of wealth & poverty index",value:1,natural_value:1.7232024487028685},{category:"Safety",indicator:"Road fatalities rate per 100,000 population",value:4,natural_value:8.586666666666666},{category:"Safety",indicator:"Road fatalities rate per 100,000 population (change in last 3 years)",value:1,natural_value:-.224},{category:"Safety",indicator:"Violent crime rate per 100,000 population",value:4,natural_value:3.3666666666666667},{category:"Safety",indicator:"Violent crime rate per 100,000 population (change in last 3 years)",value:5,natural_value:-.084},{category:"Safety",indicator:"Crime rate per 100,000 population",value:3,natural_value:1605},{category:"Safety",indicator:"Crime rate per 100,000 population  (change in last 3 years)",value:1,natural_value:-.084},{category:"Safety",indicator:"Police arrival speed",value:2,natural_value:26},{category:"Safety",indicator:"Perception of safety index",value:2,natural_value:3.2249999999999996},{category:"Livability",indicator:"Number of LEED certified green buildings",value:2,natural_value:0},{category:"Livability",indicator:"Number of CEEQUAL certified projects",value:1,natural_value:0},{category:"Livability",indicator:"Whether or not the city has ISO 37120 certification",value:1,natural_value:"no"},{category:"Livability",indicator:"Mobile connection coverage",value:2,natural_value:.922},{category:"Livability",indicator:"Internet coverage",value:2,natural_value:.880666666666667},{category:"Livability",indicator:"Perception of livability index",value:1,natural_value:4.173213808617591},{category:"Livability",indicator:"Share of population in 1 km from hospitals",value:4,natural_value:97},{category:"Livability",indicator:"Share of population in 1 km from parks",value:3,natural_value:70.1},{category:"Transport",indicator:"Time loss in traffic",value:2,natural_value:60.7},{category:"Transport",indicator:"Share of the population in 1 km from public transport stop",value:3,natural_value:75.4},{category:"Transport",indicator:"Ratio of the cost of monthly public transport usage Ithe cheapest option) to average mobthly income",value:3,natural_value:.04},{category:"Transport",indicator:"Ratio of the cost of a 1-kilometer taxi ride to average mobthly income",value:3,natural_value:.04},{category:"Transport",indicator:"Percentage of city's roads that are segregated and/or has specialized lane for cyclists",value:3,natural_value:.06},{category:"Transport",indicator:"Number of public electric vehicle (EV) charging points per 100,000 population",value:3,natural_value:1.4},{category:"Transport",indicator:"Public transport (excluding subway) operates by schedule ",value:5,natural_value:"yes"},{category:"Transport",indicator:"Perception of transport index",value:1,natural_value:4.173213808617591},{category:"Inclusion",indicator:"Female-friendly city",value:3,natural_value:"3"},{category:"Inclusion",indicator:"Number of refugees per 1,000 population",value:3,natural_value:4.1},{category:"Inclusion",indicator:"Homeless people per 1,000 population",value:3,natural_value:1.889719188959608},{category:"Inclusion",indicator:"Difference in number of years of schooling between woman and man, woman to man ratio ",value:3,natural_value:1.05},{category:"Inclusion",indicator:"Slavery index",value:3,natural_value:"11,1"},{category:"Inclusion",indicator:"Percentage of women aged 25-34 years old that have successfully completed secondary education",value:5,natural_value:.6729999999999999},{category:"Inclusion",indicator:"Regulations for building construction and equipment, public transport for people with disabilities",value:5,natural_value:"yes"},{category:"Inclusion",indicator:"Perception of inclusion index",value:4,natural_value:1.6634254646800826},{category:"Accountability",indicator:"City budget execution publication",value:5,natural_value:"yes"},{category:"Accountability",indicator:"City budget publication",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Financial transparency on city government companies",value:1,natural_value:"no"},{category:"Accountability",indicator:"ISO certification",value:1,natural_value:"no"},{category:"Accountability",indicator:"City council checks and balances",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Plans to obtain ISO certification",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Perception of accountability index",value:1,natural_value:1.359106447444682},{category:"City budget",indicator:"Poor financial condition",value:5,natural_value:"no"},{category:"City budget",indicator:"Central/higher level government financial intervention taking place",value:5,natural_value:"no"},{category:"City budget",indicator:"Long-term financial planning",value:1,natural_value:"no"},{category:"City budget",indicator:"Central/higher level government financial intervention is considered",value:1,natural_value:"no"},{category:"City budget",indicator:"Prudent fiscal policy requirements",value:5,natural_value:"yes"},{category:"City budget",indicator:"Medium-term planning",value:5,natural_value:"yes"},{category:"SME",indicator:"Number of SMEs per 100,000 population",value:1,natural_value:11505.543278417088},{category:"SME",indicator:"Number of start-ups",value:2,natural_value:7567.666666666667},{category:"SME",indicator:"Global Startup Ecosystem Index",value:1,natural_value:0},{category:"SME",indicator:"Number of SMEs per capita/100 000 population (change in last 3 years)",value:3,natural_value:0},{category:"SME",indicator:"Number of start-ups (change in last 3 years)",value:3,natural_value:0},{category:"Public services",indicator:"Free phone to call the police, ambulance, firefighters",value:5,natural_value:"yes"},{category:"Public services",indicator:"Services for working with citizens' appeals and complaint",value:5,natural_value:"yes"},{category:"Public services",indicator:"E-gov services",value:5,natural_value:"yes"},{category:"Public services",indicator:"Perception of public services index: Public Services",value:2,natural_value:2.7906076049115165},{category:"Sustainability commitment",indicator:"City ESG reporting",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"City ESG reporting verification",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"ESG planning",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"Plan with specific targets to develop and implement smart city principles",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"Rollout and status of ESG / UN SDG training across the municipal/asset workforce",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"City municipality involved in network or partnership promoting sustainable development (for example, C40 Cities network)",value:5,natural_value:"yes"}]},{city:"Cape Town",data:[{category:"Air pollution",indicator:"CO2 emissions",value:4,natural_value:1.83141622},{category:"Air pollution",indicator:"CO2 emissions (change in last 3 years)",value:3,natural_value:.038347905482194224},{category:"Air pollution",indicator:"CO2 concentration",value:5,natural_value:410.982591},{category:"Air pollution",indicator:"CO2 concentration (change in last 3 years)",value:5,natural_value:.00947134212255332},{category:"Air pollution",indicator:"Annual average of SO2 concentration in ambient air",value:4,natural_value:2.959491114},{category:"Air pollution",indicator:"Annual Average of SO2 Concentration in Ambient Air (change in last 3 years)",value:3,natural_value:.053096182207327494},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air",value:3,natural_value:12.6},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air"},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:.05843338090840398},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air, microgram/m3",value:5,natural_value:41.0593754},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:.004064526034607794},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air, microgram/m3",value:4,natural_value:.183141622},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:.038347905482194224},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air, microgram/m3",value:4,natural_value:30.61868568},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:.06188768470920251},{category:"Air pollution",indicator:"Volatile organic compounds/reactive organic gases emissions",value:3,natural_value:1.7},{category:"Air pollution",indicator:"Perception of air pollution index",value:3,natural_value:1.6},{category:"Air pollution",indicator:"Paris Agreement",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Annual average of dissolved oxygen (DO) concentration in water",value:1,natural_value:7.4},{category:"Water pollution",indicator:"Annual average of pH concentration in water",value:1,natural_value:8.608333333333334},{category:"Water pollution",indicator:"Annual average dissolved solids in drinking-water",value:2,natural_value:246.15384615384616},{category:"Water pollution",indicator:"Water management strategy in a city",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Perception of water pollution index",value:3,natural_value:1.9},{category:"Land use and waste",indicator:"Share of devastated and degraded land area requiring reclamation",value:3,natural_value:7},{category:"Land use and waste",indicator:"3-year average growth rate of devastated and degraded land area requiring reclamation",value:3,natural_value:.002},{category:"Land use and waste",indicator:"Waste deposits",value:3,natural_value:.005},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous)",value:3,natural_value:487.0252454957336},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous), (change in last 3 years)",value:4,natural_value:-.10465563349646823},{category:"Land use and waste",indicator:"Total recycled construction waste",value:2,natural_value:.007102473498233216},{category:"Land use and waste",indicator:"Share of recycled construction and demolish waste in total generated construction and demolish waste",value:2,natural_value:.1},{category:"Land use and waste",indicator:"Total area of impervious surfaces and percentage to total city area",value:3,natural_value:.02},{category:"Land use and waste",indicator:"Productive urban land (in percent total land)",value:3,natural_value:32.2},{category:"Land use and waste",indicator:"Waste managenet strategy",value:5,natural_value:"yes"},{category:"Land use and waste",indicator:"Perception of waste index",value:2,natural_value:2.3},{category:"Land use and waste",indicator:"Green spaces, % city area",value:3,natural_value:.24},{category:"Land use and waste",indicator:"Green spaces, change in last 3 years",value:3,natural_value:-.06},{category:"Land use and waste",indicator:"NDVI",value:3,natural_value:.334},{category:"Natural disaster hazards",indicator:"Share of total area with altitude above sea level less than 0,5 meters",value:3,natural_value:.085},{category:"Natural disaster hazards",indicator:"Growth rate of freshwater mirror area",value:3,natural_value:-.06},{category:"Natural disaster hazards",indicator:"Number of registered heavy rain, flood and thunderbolt (change in last 3 years)",value:3,natural_value:.006622709560113016},{category:"Natural disaster hazards",indicator:"Number of registered sand storm (change in last 3 years)",value:3,natural_value:.006622709560113016},{category:"Natural disaster hazards",indicator:"Environmental/natural disasters’ risk mitigation",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Strategy/policy/government officials’ statement on environmental issues ",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Total overall losses from natural disaster hazards",value:3,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of days with average daily temperature above the threshold for 1990-2010",value:4,natural_value:8},{category:"Natural disaster hazards",indicator:"Number of disruptions to basic services, attributed to disasters",value:3,natural_value:0},{category:"Water availability",indicator:"Water consumption per capita",value:3,natural_value:.0006548780200194737},{category:"Water availability",indicator:"Water tariff to disposable income ratio",value:3,natural_value:1.943333333},{category:"Water availability",indicator:"Sanitary facilities tariff to disposable income ratio",value:3,natural_value:1.626},{category:"Water availability",indicator:"Water consumption per capita (change in last 3 years)",value:3,natural_value:.001543290127960395},{category:"Water availability",indicator:"Percentage of population with access to drinking water",value:3,natural_value:.939},{category:"Water availability",indicator:"Percentage of population with access to drinking water (change in last 3 years)",value:3,natural_value:.002856138323718005},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities",value:3,natural_value:.785},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities (change in last 3 years)",value:3,natural_value:.007762276945399327},{category:"Food availability",indicator:"Cereal import dependency ratio (5-years average)",value:3,natural_value:.1336},{category:"Food availability",indicator:"Cereal import dependency ratio (change in last 3 years)",value:5,natural_value:-.19939738387128758},{category:"Food availability",indicator:"Prevalence of undernourishment",value:2,natural_value:.079},{category:"Food availability",indicator:"Prevalence of undernourishment (change in last 3 years)",value:3,natural_value:.018000000000000002},{category:"Food availability",indicator:"Prevalence of undernourishment children",value:4,natural_value:.121},{category:"Food availability",indicator:"Prevalence of undernourishment children (change in last 3 years)",value:3,natural_value:-.010782511350259871},{category:"Food availability",indicator:"Prevalence of moderate or severe food insecurity in the population",value:3,natural_value:.213},{category:"Food availability",indicator:"Share of imports in food resources",value:4,natural_value:.078},{category:"Food availability",indicator:"Percentage of people with access to at least one food vendor/retailer within 15 minutes of walking",value:3,natural_value:91},{category:"Food availability",indicator:"Perception of food availability index",value:3,natural_value:2.2},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity",value:3,natural_value:.873669662475586},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity (change in last 3 years)",value:3,natural_value:.0003793691719999881},{category:"Energy availability",indicator:"Consumption of electricity per capita",value:3,natural_value:1791.8035267072164},{category:"Energy availability",indicator:"Consumption of electricity per capita (change in last 3 years)",value:5,natural_value:-.03615737083310333},{category:"Energy availability",indicator:"Electricity tariff to disposable income ratio",value:4,natural_value:.038868},{category:"Energy availability",indicator:"Share of renewable sources in electricity consumption",value:1,natural_value:.0976},{category:"Energy availability",indicator:"Perception of energy availability index",value:3,natural_value:1.07},{category:"Health",indicator:"Child mortality rate (under 5 years-old)",value:1,natural_value:32.85},{category:"Health",indicator:"City ambulance",value:5,natural_value:"yes"},{category:"Health",indicator:"Life expectancy at birth, years",value:5,natural_value:62.341},{category:"Health",indicator:"Life expectancy at birth goals",value:5,natural_value:"3. Country/city has a plan aimed directly at achieving of increasing LEaB"},{category:"Health",indicator:"Number of hospital beds per 1,000 population",value:3,natural_value:1.9},{category:"Health",indicator:"Number of doctors per 1,000 population",value:3,natural_value:4.600528619222334},{category:"Health",indicator:"Maternal mortality ratio",value:3,natural_value:82.4},{category:"Health",indicator:"Ambulance arrival speed, min",value:3,natural_value:70},{category:"Education",indicator:"Literacy rate among population (15-24 Years)",value:3,natural_value:.971},{category:"Education",indicator:"Literacy rate among population (15-24 Years) (change in last 3 years)",value:1,natural_value:-.0064386739444597385},{category:"Education",indicator:"Primary education engagement",value:5,natural_value:.9547},{category:"Education",indicator:"Pupils per teacher rate",value:2,natural_value:30.9},{category:"Education",indicator:"Proportion of population with post-secondary and higher education",value:2,natural_value:.1369382},{category:"Wealth",indicator:"Percentage of population with food expenditure is above 52% of total expenditure",value:1,natural_value:.667},{category:"Wealth",indicator:"Mean monthly salary",value:3,natural_value:1685.79},{category:"Wealth",indicator:"Mean monthly salary, change in last 3 years",value:2,natural_value:-.049376116118616475},{category:"Wealth",indicator:"Disposable monthly income",value:3,natural_value:796.6926340868529},{category:"Wealth",indicator:"Disposable monthly income (change in last 3 years)",value:3,natural_value:.0419292096217605},{category:"Wealth",indicator:"Debt to salary ratio",value:5,natural_value:.17357018007398073},{category:"Wealth",indicator:"Number of mobile phones per 1,000 population",value:2,natural_value:167.3958702},{category:"Wealth",indicator:"Decile income coefficient",value:1,natural_value:56.11111111111111},{category:"Wealth",indicator:"Decile income coefficient (change in last 3 years)",value:3,natural_value:.03033195142262146},{category:"Wealth",indicator:"Poverty headcount ratio at national poverty lines",value:3,natural_value:.555},{category:"Wealth",indicator:"Working poverty rate (percentage of employed living below US$1.90 PPP), 15+ age (%) ",value:2,natural_value:.07},{category:"Wealth",indicator:"Poverty headcount ratio at $2.15 PPP 2017 a day",value:3,natural_value:.205},{category:"Wealth",indicator:"Living spaces per capita, sq m (change in last 3 years)",value:3,natural_value:.033},{category:"Wealth",indicator:"Population living in slums (% of urban population)",value:3,natural_value:.242},{category:"Wealth",indicator:"Availability of finance (consumer loans)",value:1,natural_value:.094},{category:"Wealth",indicator:"Perception of wealth & poverty index",value:5,natural_value:1.7},{category:"Safety",indicator:"Road fatalities rate per 100,000 population",value:3,natural_value:25.079090734507815},{category:"Safety",indicator:"Road fatalities rate per 100,000 population (change in last 3 years)",value:3,natural_value:-.06410660306012106},{category:"Safety",indicator:"Violent crime rate per 100,000 population",value:1,natural_value:66},{category:"Safety",indicator:"Violent crime rate per 100,000 population (change in last 3 years)",value:3,natural_value:-.005000083544809186},{category:"Safety",indicator:"Crime rate per 100,000 population",value:3,natural_value:1284.6769493044394},{category:"Safety",indicator:"Crime rate per 100,000 population  (change in last 3 years)",value:1,natural_value:-.08128988581649332},{category:"Safety",indicator:"Police arrival speed",value:2,natural_value:30},{category:"Safety",indicator:"Perception of safety index",value:3,natural_value:2.79},{category:"Livability",indicator:"Number of LEED certified green buildings",value:2,natural_value:.00236896007406712},{category:"Livability",indicator:"Number of CEEQUAL certified projects",value:1,natural_value:0},{category:"Livability",indicator:"Whether or not the city has ISO 37120 certification",value:1,natural_value:"no"},{category:"Livability",indicator:"Mobile connection coverage",value:5,natural_value:.999},{category:"Livability",indicator:"Internet coverage",value:5,natural_value:.998},{category:"Livability",indicator:"Perception of livability index",value:3,natural_value:1.5},{category:"Livability",indicator:"Share of population in 1 km from hospitals",value:4,natural_value:88.8},{category:"Livability",indicator:"Share of population in 1 km from parks",value:3,natural_value:64.3},{category:"Transport",indicator:"Time loss in traffic",value:3,natural_value:.275},{category:"Transport",indicator:"Share of the population in 1 km from public transport stop",value:3,natural_value:36.4},{category:"Transport",indicator:"Ratio of the cost of monthly public transport usage Ithe cheapest option) to average mobthly income",value:1,natural_value:.06538576303528867},{category:"Transport",indicator:"Ratio of the cost of a 1-kilometer taxi ride to average mobthly income",value:5,natural_value:.00030252878472407596},{category:"Transport",indicator:"Percentage of city's roads that are segregated and/or has specialized lane for cyclists",value:3,natural_value:.06},{category:"Transport",indicator:"Number of public electric vehicle (EV) charging points per 100,000 population",value:2,natural_value:.23162888167891352},{category:"Transport",indicator:"Public transport (excluding subway) operates by schedule ",value:5,natural_value:"yes"},{category:"Transport",indicator:"Perception of transport index",value:3,natural_value:1.5},{category:"Inclusion",indicator:"Female-friendly city",value:3,natural_value:3},{category:"Inclusion",indicator:"Number of refugees per 1,000 population",value:3,natural_value:4.178214846228337},{category:"Inclusion",indicator:"Homeless people per 1,000 population",value:5,natural_value:.1895145395554747},{category:"Inclusion",indicator:"Difference in number of years of schooling between woman and man, woman to man ratio ",value:3,natural_value:.98},{category:"Inclusion",indicator:"Slavery index",value:4,natural_value:2.7},{category:"Inclusion",indicator:"Percentage of women aged 25-34 years old that have successfully completed secondary education",value:4,natural_value:.486074295},{category:"Inclusion",indicator:"Regulations for building construction and equipment, public transport for people with disabilities",value:5,natural_value:"yes"},{category:"Inclusion",indicator:"Perception of inclusion index",value:3,natural_value:2.3},{category:"Accountability",indicator:"City budget execution publication",value:5,natural_value:"yes"},{category:"Accountability",indicator:"City budget publication",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Financial transparency on city government companies",value:1,natural_value:"no"},{category:"Accountability",indicator:"ISO certification",value:1,natural_value:"no"},{category:"Accountability",indicator:"City council checks and balances",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Plans to obtain ISO certification",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Perception of accountability index",value:3,natural_value:.9},{category:"City budget",indicator:"Poor financial condition",value:1,natural_value:"yes"},{category:"City budget",indicator:"Central/higher level government financial intervention taking place",value:5,natural_value:"no"},{category:"City budget",indicator:"Long-term financial planning",value:5,natural_value:"yes"},{category:"City budget",indicator:"Central/higher level government financial intervention is considered",value:1,natural_value:"no"},{category:"City budget",indicator:"Prudent fiscal policy requirements",value:1,natural_value:"no"},{category:"City budget",indicator:"Medium-term planning",value:5,natural_value:"yes"},{category:"SME",indicator:"Number of SMEs per 100,000 population",value:3,natural_value:464.75262588672},{category:"SME",indicator:"Number of start-ups",value:3,natural_value:225},{category:"SME",indicator:"Global Startup Ecosystem Index",value:1,natural_value:5.188},{category:"SME",indicator:"Number of SMEs per capita/100 000 population (change in last 3 years)",value:1,natural_value:-.3690430901893693},{category:"SME",indicator:"Number of start-ups (change in last 3 years)",value:3,natural_value:.125},{category:"Public services",indicator:"Free phone to call the police, ambulance, firefighters",value:5,natural_value:"yes"},{category:"Public services",indicator:"Services for working with citizens' appeals and complaint",value:5,natural_value:"yes"},{category:"Public services",indicator:"E-gov services",value:5,natural_value:"yes"},{category:"Public services",indicator:"Perception of public services index: Public Services",value:3,natural_value:1.77},{category:"Sustainability commitment",indicator:"City ESG reporting",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"City ESG reporting verification",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"ESG planning",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"Plan with specific targets to develop and implement smart city principles",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"Rollout and status of ESG / UN SDG training across the municipal/asset workforce",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"City municipality involved in network or partnership promoting sustainable development (for example, C40 Cities network)",value:5,natural_value:"yes"}]},{city:"Mexico City",data:[{category:"Air pollution",indicator:"CO2 emissions",value:3,natural_value:3.94406729},{category:"Air pollution",indicator:"CO2 emissions (change in last 3 years)",value:3,natural_value:-.004250140841668175},{category:"Air pollution",indicator:"CO2 concentration",value:4,natural_value:417.6455595},{category:"Air pollution",indicator:"CO2 concentration (change in last 3 years)",value:5,natural_value:.01301563418143103},{category:"Air pollution",indicator:"Annual average of SO2 concentration in ambient air",value:1,natural_value:416.6828153},{category:"Air pollution",indicator:"Annual Average of SO2 Concentration in Ambient Air (change in last 3 years)",value:3,natural_value:.029396212805524676},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air",value:2,natural_value:35},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air"},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:-.002990856524339786},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air, microgram/m3",value:3,natural_value:49.19622362},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:.02331986649456455},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air, microgram/m3",value:3,natural_value:.394406729},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:-.004250140841668175},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air, microgram/m3",value:1,natural_value:141.6888279},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:.01619130675578221},{category:"Air pollution",indicator:"Volatile organic compounds/reactive organic gases emissions",value:3,natural_value:1.7},{category:"Air pollution",indicator:"Perception of air pollution index",value:3,natural_value:1.6},{category:"Air pollution",indicator:"Paris Agreement",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Annual average of dissolved oxygen (DO) concentration in water",value:1,natural_value:7.4},{category:"Water pollution",indicator:"Annual average of pH concentration in water",value:3,natural_value:7.1},{category:"Water pollution",indicator:"Annual average dissolved solids in drinking-water",value:1,natural_value:394.16},{category:"Water pollution",indicator:"Water management strategy in a city",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Perception of water pollution index",value:3,natural_value:1.9},{category:"Land use and waste",indicator:"Share of devastated and degraded land area requiring reclamation",value:3,natural_value:7},{category:"Land use and waste",indicator:"3-year average growth rate of devastated and degraded land area requiring reclamation",value:3,natural_value:.002},{category:"Land use and waste",indicator:"Waste deposits",value:3,natural_value:.005},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous)",value:3,natural_value:209.69890723087653},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous), (change in last 3 years)",value:4,natural_value:-.037697909969071075},{category:"Land use and waste",indicator:"Total recycled construction waste",value:3,natural_value:1.7},{category:"Land use and waste",indicator:"Share of recycled construction and demolish waste in total generated construction and demolish waste",value:3,natural_value:.249},{category:"Land use and waste",indicator:"Total area of impervious surfaces and percentage to total city area",value:3,natural_value:.02},{category:"Land use and waste",indicator:"Productive urban land (in percent total land)",value:3,natural_value:32.2},{category:"Land use and waste",indicator:"Waste managenet strategy",value:5,natural_value:"yes"},{category:"Land use and waste",indicator:"Perception of waste index",value:3,natural_value:2.3},{category:"Land use and waste",indicator:"Green spaces, % city area",value:3,natural_value:.21},{category:"Land use and waste",indicator:"Green spaces, change in last 3 years",value:3,natural_value:-.06},{category:"Land use and waste",indicator:"NDVI",value:3,natural_value:.262},{category:"Natural disaster hazards",indicator:"Share of total area with altitude above sea level less than 0,5 meters",value:3,natural_value:.085},{category:"Natural disaster hazards",indicator:"Growth rate of freshwater mirror area",value:3,natural_value:-.06},{category:"Natural disaster hazards",indicator:"Number of registered heavy rain, flood and thunderbolt (change in last 3 years)",value:3,natural_value:-.0379},{category:"Natural disaster hazards",indicator:"Number of registered sand storm (change in last 3 years)",value:3,natural_value:-.0379},{category:"Natural disaster hazards",indicator:"Environmental/natural disasters’ risk mitigation",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Strategy/policy/government officials’ statement on environmental issues ",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Total overall losses from natural disaster hazards",value:3,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of days with average daily temperature above the threshold for 1990-2010",value:1,natural_value:279},{category:"Natural disaster hazards",indicator:"Number of disruptions to basic services, attributed to disasters",value:3,natural_value:0},{category:"Water availability",indicator:"Water consumption per capita",value:3,natural_value:26240674667531622e-21},{category:"Water availability",indicator:"Water tariff to disposable income ratio",value:3,natural_value:.891333333},{category:"Water availability",indicator:"Sanitary facilities tariff to disposable income ratio",value:3,natural_value:1.1},{category:"Water availability",indicator:"Water consumption per capita (change in last 3 years)",value:5,natural_value:-.19799737528184247},{category:"Water availability",indicator:"Percentage of population with access to drinking water",value:5,natural_value:.99},{category:"Water availability",indicator:"Percentage of population with access to drinking water (change in last 3 years)",value:3,natural_value:.0016},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities",value:4,natural_value:.924},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities (change in last 3 years)",value:4,natural_value:.00510212913410224},{category:"Food availability",indicator:"Cereal import dependency ratio (5-years average)",value:3,natural_value:.3408},{category:"Food availability",indicator:"Cereal import dependency ratio (change in last 3 years)",value:4,natural_value:-.05401609914880312},{category:"Food availability",indicator:"Prevalence of undernourishment",value:3,natural_value:.025},{category:"Food availability",indicator:"Prevalence of undernourishment (change in last 3 years)",value:3,natural_value:-.002999999999999999},{category:"Food availability",indicator:"Prevalence of undernourishment children",value:4,natural_value:.126},{category:"Food availability",indicator:"Prevalence of undernourishment children (change in last 3 years)",value:3,natural_value:-.005235698025902069},{category:"Food availability",indicator:"Prevalence of moderate or severe food insecurity in the population",value:3,natural_value:.332},{category:"Food availability",indicator:"Share of imports in food resources",value:3,natural_value:.391},{category:"Food availability",indicator:"Percentage of people with access to at least one food vendor/retailer within 15 minutes of walking",value:3,natural_value:91},{category:"Food availability",indicator:"Perception of food availability index",value:3,natural_value:2.2},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity",value:5,natural_value:1},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity (change in last 3 years)",value:3,natural_value:.00133689998761799},{category:"Energy availability",indicator:"Consumption of electricity per capita",value:3,natural_value:4751.875097009815},{category:"Energy availability",indicator:"Consumption of electricity per capita (change in last 3 years)",value:4,natural_value:-.014927121837602364},{category:"Energy availability",indicator:"Electricity tariff to disposable income ratio",value:3,natural_value:.095},{category:"Energy availability",indicator:"Share of renewable sources in electricity consumption",value:2,natural_value:.1233},{category:"Energy availability",indicator:"Perception of energy availability index",value:3,natural_value:1.07},{category:"Health",indicator:"Child mortality rate (under 5 years-old)",value:3,natural_value:9.3},{category:"Health",indicator:"City ambulance",value:1,natural_value:"no"},{category:"Health",indicator:"Life expectancy at birth, years",value:2,natural_value:70.213},{category:"Health",indicator:"Life expectancy at birth goals",value:1,natural_value:"1. No plans aimed at achieving any of components of Goal 3 or increasing LEaB"},{category:"Health",indicator:"Number of hospital beds per 1,000 population",value:5,natural_value:6.008509648918856},{category:"Health",indicator:"Number of doctors per 1,000 population",value:3,natural_value:5.4},{category:"Health",indicator:"Maternal mortality ratio",value:3,natural_value:36},{category:"Health",indicator:"Ambulance arrival speed, min",value:3,natural_value:70},{category:"Education",indicator:"Literacy rate among population (15-24 Years)",value:3,natural_value:.990824127197266},{category:"Education",indicator:"Literacy rate among population (15-24 Years) (change in last 3 years)",value:3,natural_value:-.00014217945297922974},{category:"Education",indicator:"Primary education engagement",value:3,natural_value:.73},{category:"Education",indicator:"Pupils per teacher rate",value:3,natural_value:21.6},{category:"Education",indicator:"Proportion of population with post-secondary and higher education",value:2,natural_value:.1877145958},{category:"Wealth",indicator:"Percentage of population with food expenditure is above 52% of total expenditure",value:3,natural_value:.202},{category:"Wealth",indicator:"Mean monthly salary",value:2,natural_value:890.8545},{category:"Wealth",indicator:"Mean monthly salary, change in last 3 years",value:3,natural_value:0},{category:"Wealth",indicator:"Disposable monthly income",value:3,natural_value:784},{category:"Wealth",indicator:"Disposable monthly income (change in last 3 years)",value:3,natural_value:.02},{category:"Wealth",indicator:"Debt to salary ratio",value:5,natural_value:.05835306826207985},{category:"Wealth",indicator:"Number of mobile phones per 1,000 population",value:2,natural_value:523},{category:"Wealth",indicator:"Decile income coefficient",value:3,natural_value:19.72222222222222},{category:"Wealth",indicator:"Decile income coefficient (change in last 3 years)",value:3,natural_value:-.03918968586393867},{category:"Wealth",indicator:"Poverty headcount ratio at national poverty lines",value:3,natural_value:.363},{category:"Wealth",indicator:"Working poverty rate (percentage of employed living below US$1.90 PPP), 15+ age (%) ",value:4,natural_value:.017},{category:"Wealth",indicator:"Poverty headcount ratio at $2.15 PPP 2017 a day",value:4,natural_value:.031},{category:"Wealth",indicator:"Living spaces per capita, sq m (change in last 3 years)",value:3,natural_value:.033},{category:"Wealth",indicator:"Population living in slums (% of urban population)",value:3,natural_value:.176},{category:"Wealth",indicator:"Availability of finance (consumer loans)",value:3,natural_value:.25},{category:"Wealth",indicator:"Perception of wealth & poverty index",value:3,natural_value:1.7},{category:"Safety",indicator:"Road fatalities rate per 100,000 population",value:4,natural_value:1.1857707509881423},{category:"Safety",indicator:"Road fatalities rate per 100,000 population (change in last 3 years)",value:5,natural_value:.1725851631673272},{category:"Safety",indicator:"Violent crime rate per 100,000 population",value:3,natural_value:14},{category:"Safety",indicator:"Violent crime rate per 100,000 population (change in last 3 years)",value:3,natural_value:0},{category:"Safety",indicator:"Crime rate per 100,000 population",value:1,natural_value:46032},{category:"Safety",indicator:"Crime rate per 100,000 population  (change in last 3 years)",value:2,natural_value:-.04789415935857033},{category:"Safety",indicator:"Police arrival speed",value:3,natural_value:21.7},{category:"Safety",indicator:"Perception of safety index",value:3,natural_value:2.79},{category:"Livability",indicator:"Number of LEED certified green buildings",value:3,natural_value:.126343935797907},{category:"Livability",indicator:"Number of CEEQUAL certified projects",value:1,natural_value:0},{category:"Livability",indicator:"Whether or not the city has ISO 37120 certification",value:1,natural_value:"no"},{category:"Livability",indicator:"Mobile connection coverage",value:5,natural_value:.999},{category:"Livability",indicator:"Internet coverage",value:3,natural_value:.9},{category:"Livability",indicator:"Perception of livability index",value:3,natural_value:1.5},{category:"Livability",indicator:"Share of population in 1 km from hospitals",value:3,natural_value:70.7},{category:"Livability",indicator:"Share of population in 1 km from parks",value:3,natural_value:64.3},{category:"Transport",indicator:"Time loss in traffic",value:1,natural_value:.6645},{category:"Transport",indicator:"Share of the population in 1 km from public transport stop",value:3,natural_value:43.9},{category:"Transport",indicator:"Ratio of the cost of monthly public transport usage Ithe cheapest option) to average mobthly income",value:5,natural_value:.0599424485143197},{category:"Transport",indicator:"Ratio of the cost of a 1-kilometer taxi ride to average mobthly income",value:1,natural_value:.07857624337083104},{category:"Transport",indicator:"Percentage of city's roads that are segregated and/or has specialized lane for cyclists",value:3,natural_value:.06},{category:"Transport",indicator:"Number of public electric vehicle (EV) charging points per 100,000 population",value:4,natural_value:1.8319738823695886},{category:"Transport",indicator:"Public transport (excluding subway) operates by schedule ",value:5,natural_value:"yes"},{category:"Transport",indicator:"Perception of transport index",value:3,natural_value:1.5},{category:"Inclusion",indicator:"Female-friendly city",value:3,natural_value:3},{category:"Inclusion",indicator:"Number of refugees per 1,000 population",value:3,natural_value:4.1},{category:"Inclusion",indicator:"Homeless people per 1,000 population",value:3,natural_value:7.7},{category:"Inclusion",indicator:"Difference in number of years of schooling between woman and man, woman to man ratio ",value:3,natural_value:.97},{category:"Inclusion",indicator:"Slavery index",value:1,natural_value:58.1},{category:"Inclusion",indicator:"Percentage of women aged 25-34 years old that have successfully completed secondary education",value:1,natural_value:.1828479004},{category:"Inclusion",indicator:"Regulations for building construction and equipment, public transport for people with disabilities",value:5,natural_value:"yes"},{category:"Inclusion",indicator:"Perception of inclusion index",value:3,natural_value:2.3},{category:"Accountability",indicator:"City budget execution publication",value:5,natural_value:"yes"},{category:"Accountability",indicator:"City budget publication",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Financial transparency on city government companies",value:1,natural_value:"no"},{category:"Accountability",indicator:"ISO certification",value:1,natural_value:"no"},{category:"Accountability",indicator:"City council checks and balances",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Plans to obtain ISO certification",value:1,natural_value:"no"},{category:"Accountability",indicator:"Perception of accountability index",value:3,natural_value:.9},{category:"City budget",indicator:"Poor financial condition",value:1,natural_value:"yes"},{category:"City budget",indicator:"Central/higher level government financial intervention taking place",value:1,natural_value:"yes"},{category:"City budget",indicator:"Long-term financial planning",value:5,natural_value:"yes"},{category:"City budget",indicator:"Central/higher level government financial intervention is considered",value:1,natural_value:"no"},{category:"City budget",indicator:"Prudent fiscal policy requirements",value:5,natural_value:"yes"},{category:"City budget",indicator:"Medium-term planning",value:5,natural_value:"yes"},{category:"SME",indicator:"Number of SMEs per 100,000 population",value:3,natural_value:9336},{category:"SME",indicator:"Number of start-ups",value:3,natural_value:1211},{category:"SME",indicator:"Global Startup Ecosystem Index",value:3,natural_value:13.567},{category:"SME",indicator:"Number of SMEs per capita/100 000 population (change in last 3 years)",value:3,natural_value:-7e-4},{category:"SME",indicator:"Number of start-ups (change in last 3 years)",value:3,natural_value:.125},{category:"Public services",indicator:"Free phone to call the police, ambulance, firefighters",value:5,natural_value:"yes"},{category:"Public services",indicator:"Services for working with citizens' appeals and complaint",value:5,natural_value:"yes"},{category:"Public services",indicator:"E-gov services",value:5,natural_value:"yes"},{category:"Public services",indicator:"Perception of public services index: Public Services",value:3,natural_value:1.77},{category:"Sustainability commitment",indicator:"City ESG reporting",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"City ESG reporting verification",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"ESG planning",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"Plan with specific targets to develop and implement smart city principles",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"Rollout and status of ESG / UN SDG training across the municipal/asset workforce",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"City municipality involved in network or partnership promoting sustainable development (for example, C40 Cities network)",value:5,natural_value:"yes"}]},{city:"Jakarta",data:[{category:"Air pollution",indicator:"CO2 emissions",value:2,natural_value:7.06684134},{category:"Air pollution",indicator:"CO2 emissions (change in last 3 years)",value:3,natural_value:-.003920588646618603},{category:"Air pollution",indicator:"CO2 concentration",value:1,natural_value:488.0373113},{category:"Air pollution",indicator:"CO2 concentration (change in last 3 years)",value:5,natural_value:.017863350354496974},{category:"Air pollution",indicator:"Annual average of SO2 concentration in ambient air",value:3,natural_value:28.66047717},{category:"Air pollution",indicator:"Annual Average of SO2 Concentration in Ambient Air (change in last 3 years)",value:3,natural_value:-.0009916021541911573},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air",value:2,natural_value:24.2},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air"},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:.008889816360600893},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air, microgram/m3",value:4,natural_value:46.95295405},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:-.06267596465337597},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air, microgram/m3",value:2,natural_value:.706684134},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:-.003920588646618603},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air, microgram/m3",value:1,natural_value:131.8745867},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:.006113533484481624},{category:"Air pollution",indicator:"Volatile organic compounds/reactive organic gases emissions",value:3,natural_value:1.7},{category:"Air pollution",indicator:"Perception of air pollution index",value:3,natural_value:1.6},{category:"Air pollution",indicator:"Paris Agreement",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Annual average of dissolved oxygen (DO) concentration in water",value:3,natural_value:6.08},{category:"Water pollution",indicator:"Annual average of pH concentration in water",value:3,natural_value:7.1},{category:"Water pollution",indicator:"Annual average dissolved solids in drinking-water",value:4,natural_value:75},{category:"Water pollution",indicator:"Water management strategy in a city",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Perception of water pollution index",value:3,natural_value:1.9},{category:"Land use and waste",indicator:"Share of devastated and degraded land area requiring reclamation",value:3,natural_value:7},{category:"Land use and waste",indicator:"3-year average growth rate of devastated and degraded land area requiring reclamation",value:3,natural_value:.002},{category:"Land use and waste",indicator:"Waste deposits",value:3,natural_value:.005},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous)",value:3,natural_value:219},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous), (change in last 3 years)",value:3,natural_value:4.2},{category:"Land use and waste",indicator:"Total recycled construction waste",value:3,natural_value:1.7},{category:"Land use and waste",indicator:"Share of recycled construction and demolish waste in total generated construction and demolish waste",value:3,natural_value:.249},{category:"Land use and waste",indicator:"Total area of impervious surfaces and percentage to total city area",value:3,natural_value:.02},{category:"Land use and waste",indicator:"Productive urban land (in percent total land)",value:3,natural_value:32.2},{category:"Land use and waste",indicator:"Waste managenet strategy",value:1,natural_value:"no"},{category:"Land use and waste",indicator:"Perception of waste index",value:3,natural_value:2.3},{category:"Land use and waste",indicator:"Green spaces, % city area",value:2,natural_value:.0465},{category:"Land use and waste",indicator:"Green spaces, change in last 3 years",value:3,natural_value:-.06},{category:"Land use and waste",indicator:"NDVI",value:3,natural_value:.447},{category:"Natural disaster hazards",indicator:"Share of total area with altitude above sea level less than 0,5 meters",value:3,natural_value:.085},{category:"Natural disaster hazards",indicator:"Growth rate of freshwater mirror area",value:3,natural_value:-.06},{category:"Natural disaster hazards",indicator:"Number of registered heavy rain, flood and thunderbolt (change in last 3 years)",value:3,natural_value:-.0379},{category:"Natural disaster hazards",indicator:"Number of registered sand storm (change in last 3 years)",value:3,natural_value:-.0379},{category:"Natural disaster hazards",indicator:"Environmental/natural disasters’ risk mitigation",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Strategy/policy/government officials’ statement on environmental issues ",value:1,natural_value:"no"},{category:"Natural disaster hazards",indicator:"Total overall losses from natural disaster hazards",value:3,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of days with average daily temperature above the threshold for 1990-2010",value:3,natural_value:15},{category:"Natural disaster hazards",indicator:"Number of disruptions to basic services, attributed to disasters",value:3,natural_value:0},{category:"Water availability",indicator:"Water consumption per capita",value:3,natural_value:.11353959693443089},{category:"Water availability",indicator:"Water tariff to disposable income ratio",value:3,natural_value:1.29},{category:"Water availability",indicator:"Sanitary facilities tariff to disposable income ratio",value:3,natural_value:1.1},{category:"Water availability",indicator:"Water consumption per capita (change in last 3 years)",value:3,natural_value:-.004},{category:"Water availability",indicator:"Percentage of population with access to drinking water",value:3,natural_value:.9773},{category:"Water availability",indicator:"Percentage of population with access to drinking water (change in last 3 years)",value:5,natural_value:-.003421320060821298},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities",value:4,natural_value:.9279},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities (change in last 3 years)",value:4,natural_value:-.0008964755405916902},{category:"Food availability",indicator:"Cereal import dependency ratio (5-years average)",value:3,natural_value:.35},{category:"Food availability",indicator:"Cereal import dependency ratio (change in last 3 years)",value:3,natural_value:.002},{category:"Food availability",indicator:"Prevalence of undernourishment",value:3,natural_value:.065},{category:"Food availability",indicator:"Prevalence of undernourishment (change in last 3 years)",value:3,natural_value:.006000000000000005},{category:"Food availability",indicator:"Prevalence of undernourishment children",value:4,natural_value:.122},{category:"Food availability",indicator:"Prevalence of undernourishment children (change in last 3 years)",value:3,natural_value:-.0010000000000000009},{category:"Food availability",indicator:"Prevalence of moderate or severe food insecurity in the population",value:3,natural_value:.117},{category:"Food availability",indicator:"Share of imports in food resources",value:2,natural_value:.6},{category:"Food availability",indicator:"Percentage of people with access to at least one food vendor/retailer within 15 minutes of walking",value:3,natural_value:91},{category:"Food availability",indicator:"Perception of food availability index",value:3,natural_value:2.2},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity",value:3,natural_value:.9973},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity (change in last 3 years)",value:1,natural_value:-.0008675056905055323},{category:"Energy availability",indicator:"Consumption of electricity per capita",value:4,natural_value:1090},{category:"Energy availability",indicator:"Consumption of electricity per capita (change in last 3 years)",value:3,natural_value:.009346336118695842},{category:"Energy availability",indicator:"Electricity tariff to disposable income ratio",value:3,natural_value:.1},{category:"Energy availability",indicator:"Share of renewable sources in electricity consumption",value:2,natural_value:.14},{category:"Energy availability",indicator:"Perception of energy availability index",value:3,natural_value:1.07},{category:"Health",indicator:"Child mortality rate (under 5 years-old)",value:2,natural_value:22.17},{category:"Health",indicator:"City ambulance",value:5,natural_value:"yes"},{category:"Health",indicator:"Life expectancy at birth, years",value:3,natural_value:73.32},{category:"Health",indicator:"Life expectancy at birth goals",value:5,natural_value:"3. Country/city has a plan aimed directly at achieving of increasing LEaB"},{category:"Health",indicator:"Number of hospital beds per 1,000 population",value:3,natural_value:3.1},{category:"Health",indicator:"Number of doctors per 1,000 population",value:2,natural_value:23},{category:"Health",indicator:"Maternal mortality ratio",value:1,natural_value:173},{category:"Health",indicator:"Ambulance arrival speed, min",value:3,natural_value:120},{category:"Education",indicator:"Literacy rate among population (15-24 Years)",value:5,natural_value:.9996},{category:"Education",indicator:"Literacy rate among population (15-24 Years) (change in last 3 years)",value:3,natural_value:.00023353573945694706},{category:"Education",indicator:"Primary education engagement",value:3,natural_value:.5018},{category:"Education",indicator:"Pupils per teacher rate",value:3,natural_value:18.44},{category:"Education",indicator:"Proportion of population with post-secondary and higher education",value:4,natural_value:.4012},{category:"Wealth",indicator:"Percentage of population with food expenditure is above 52% of total expenditure",value:4,natural_value:.07},{category:"Wealth",indicator:"Mean monthly salary",value:2,natural_value:554.22},{category:"Wealth",indicator:"Mean monthly salary, change in last 3 years",value:3,natural_value:0},{category:"Wealth",indicator:"Disposable monthly income",value:3,natural_value:784},{category:"Wealth",indicator:"Disposable monthly income (change in last 3 years)",value:3,natural_value:.02},{category:"Wealth",indicator:"Debt to salary ratio",value:3,natural_value:5},{category:"Wealth",indicator:"Number of mobile phones per 1,000 population",value:3,natural_value:1300},{category:"Wealth",indicator:"Decile income coefficient",value:3,natural_value:16},{category:"Wealth",indicator:"Decile income coefficient (change in last 3 years)",value:3,natural_value:-.0685},{category:"Wealth",indicator:"Poverty headcount ratio at national poverty lines",value:3,natural_value:.0469},{category:"Wealth",indicator:"Working poverty rate (percentage of employed living below US$1.90 PPP), 15+ age (%) ",value:3,natural_value:.023},{category:"Wealth",indicator:"Poverty headcount ratio at $2.15 PPP 2017 a day",value:3,natural_value:.025},{category:"Wealth",indicator:"Living spaces per capita, sq m (change in last 3 years)",value:3,natural_value:.033},{category:"Wealth",indicator:"Population living in slums (% of urban population)",value:3,natural_value:.075},{category:"Wealth",indicator:"Availability of finance (consumer loans)",value:3,natural_value:.43},{category:"Wealth",indicator:"Perception of wealth & poverty index",value:3,natural_value:1.7},{category:"Safety",indicator:"Road fatalities rate per 100,000 population",value:4,natural_value:13.94},{category:"Safety",indicator:"Road fatalities rate per 100,000 population (change in last 3 years)",value:3,natural_value:-.03},{category:"Safety",indicator:"Violent crime rate per 100,000 population",value:5,natural_value:.33038999264164826},{category:"Safety",indicator:"Violent crime rate per 100,000 population (change in last 3 years)",value:4,natural_value:-.0484913742569858},{category:"Safety",indicator:"Crime rate per 100,000 population",value:3,natural_value:82.24439043689594},{category:"Safety",indicator:"Crime rate per 100,000 population  (change in last 3 years)",value:3,natural_value:-.03},{category:"Safety",indicator:"Police arrival speed",value:3,natural_value:21.7},{category:"Safety",indicator:"Perception of safety index",value:3,natural_value:2.79},{category:"Livability",indicator:"Number of LEED certified green buildings",value:3,natural_value:24.08014468999039},{category:"Livability",indicator:"Number of CEEQUAL certified projects",value:1,natural_value:0},{category:"Livability",indicator:"Whether or not the city has ISO 37120 certification",value:1,natural_value:1},{category:"Livability",indicator:"Mobile connection coverage",value:3,natural_value:.9676},{category:"Livability",indicator:"Internet coverage",value:4,natural_value:.9676},{category:"Livability",indicator:"Perception of livability index",value:3,natural_value:1.5},{category:"Livability",indicator:"Share of population in 1 km from hospitals",value:3,natural_value:54.7},{category:"Livability",indicator:"Share of population in 1 km from parks",value:3,natural_value:64.3},{category:"Transport",indicator:"Time loss in traffic",value:2,natural_value:.3624},{category:"Transport",indicator:"Share of the population in 1 km from public transport stop",value:3,natural_value:24.8},{category:"Transport",indicator:"Ratio of the cost of monthly public transport usage Ithe cheapest option) to average mobthly income",value:3,natural_value:.04},{category:"Transport",indicator:"Ratio of the cost of a 1-kilometer taxi ride to average mobthly income",value:3,natural_value:.04},{category:"Transport",indicator:"Percentage of city's roads that are segregated and/or has specialized lane for cyclists",value:3,natural_value:.06},{category:"Transport",indicator:"Number of public electric vehicle (EV) charging points per 100,000 population",value:3,natural_value:1.4},{category:"Transport",indicator:"Public transport (excluding subway) operates by schedule ",value:5,natural_value:"yes"},{category:"Transport",indicator:"Perception of transport index",value:3,natural_value:1.5},{category:"Inclusion",indicator:"Female-friendly city",value:3,natural_value:3},{category:"Inclusion",indicator:"Number of refugees per 1,000 population",value:5,natural_value:.19897699655230883},{category:"Inclusion",indicator:"Homeless people per 1,000 population",value:5,natural_value:.2491806348909074},{category:"Inclusion",indicator:"Difference in number of years of schooling between woman and man, woman to man ratio ",value:5,natural_value:.1},{category:"Inclusion",indicator:"Slavery index",value:1,natural_value:49},{category:"Inclusion",indicator:"Percentage of women aged 25-34 years old that have successfully completed secondary education",value:1,natural_value:.061},{category:"Inclusion",indicator:"Regulations for building construction and equipment, public transport for people with disabilities",value:5,natural_value:"yes"},{category:"Inclusion",indicator:"Perception of inclusion index",value:3,natural_value:2.3},{category:"Accountability",indicator:"City budget execution publication",value:5,natural_value:"yes"},{category:"Accountability",indicator:"City budget publication",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Financial transparency on city government companies",value:5,natural_value:"yes"},{category:"Accountability",indicator:"ISO certification",value:1,natural_value:"no"},{category:"Accountability",indicator:"City council checks and balances",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Plans to obtain ISO certification",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Perception of accountability index",value:3,natural_value:.9},{category:"City budget",indicator:"Poor financial condition",value:1,natural_value:""},{category:"City budget",indicator:"Central/higher level government financial intervention taking place",value:5,natural_value:"no"},{category:"City budget",indicator:"Long-term financial planning",value:1,natural_value:"no"},{category:"City budget",indicator:"Central/higher level government financial intervention is considered",value:1,natural_value:"no"},{category:"City budget",indicator:"Medium-term planning",value:1,natural_value:"no"},{category:"SME",indicator:"Number of SMEs per 100,000 population",value:2,natural_value:13350.342150446195},{category:"SME",indicator:"Number of start-ups",value:3,natural_value:473},{category:"SME",indicator:"Global Startup Ecosystem Index",value:4,natural_value:24.073},{category:"SME",indicator:"Number of SMEs per capita/100 000 population (change in last 3 years)",value:3,natural_value:-7e-4},{category:"SME",indicator:"Number of start-ups (change in last 3 years)",value:3,natural_value:.125},{category:"Public services",indicator:"Free phone to call the police, ambulance, firefighters",value:5,natural_value:"yes"},{category:"Public services",indicator:"Services for working with citizens' appeals and complaint",value:5,natural_value:"yes"},{category:"Public services",indicator:"E-gov services",value:1,natural_value:"no"},{category:"Public services",indicator:"Perception of public services index: Public Services",value:3,natural_value:1.77},{category:"Sustainability commitment",indicator:"City ESG reporting",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"City ESG reporting verification",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"ESG planning",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"Plan with specific targets to develop and implement smart city principles",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"Rollout and status of ESG / UN SDG training across the municipal/asset workforce",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"City municipality involved in network or partnership promoting sustainable development (for example, C40 Cities network)",value:5,natural_value:"yes"}]},{city:"Panama City",data:[{category:"Air pollution",indicator:"CO2 emissions",value:4,natural_value:1.07156422},{category:"Air pollution",indicator:"CO2 emissions (change in last 3 years)",value:3,natural_value:-.049160125068900634},{category:"Air pollution",indicator:"CO2 concentration",value:5,natural_value:415.3752444},{category:"Air pollution",indicator:"CO2 concentration (change in last 3 years)",value:5,natural_value:.009762337640858978},{category:"Air pollution",indicator:"Annual average of SO2 concentration in ambient air",value:5,natural_value:.565713238},{category:"Air pollution",indicator:"Annual Average of SO2 Concentration in Ambient Air (change in last 3 years)",value:3,natural_value:-.06442138720963429},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air",value:4,natural_value:4.8},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air"},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:-.05918882204541039},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air, microgram/m3",value:4,natural_value:44.18979582},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:-.029267096962324747},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air, microgram/m3",value:5,natural_value:.107156422},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:-.049160125068900634},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air, microgram/m3",value:5,natural_value:19.10546465},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:-.17542578581721666},{category:"Air pollution",indicator:"Volatile organic compounds/reactive organic gases emissions",value:3,natural_value:1.7},{category:"Air pollution",indicator:"Perception of air pollution index",value:3,natural_value:1.6},{category:"Air pollution",indicator:"Paris Agreement",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Annual average of dissolved oxygen (DO) concentration in water",value:4,natural_value:5},{category:"Water pollution",indicator:"Annual average of pH concentration in water",value:3,natural_value:7.1},{category:"Water pollution",indicator:"Annual average dissolved solids in drinking-water",value:4,natural_value:47},{category:"Water pollution",indicator:"Water management strategy in a city",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Perception of water pollution index",value:3,natural_value:1.9},{category:"Land use and waste",indicator:"Share of devastated and degraded land area requiring reclamation",value:3,natural_value:7},{category:"Land use and waste",indicator:"3-year average growth rate of devastated and degraded land area requiring reclamation",value:3,natural_value:.002},{category:"Land use and waste",indicator:"Waste deposits",value:3,natural_value:.005},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous)",value:5,natural_value:82.12135448591799},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous), (change in last 3 years)",value:3,natural_value:4.2},{category:"Land use and waste",indicator:"Total recycled construction waste",value:3,natural_value:.02564102564102564},{category:"Land use and waste",indicator:"Share of recycled construction and demolish waste in total generated construction and demolish waste",value:3,natural_value:.249},{category:"Land use and waste",indicator:"Total area of impervious surfaces and percentage to total city area",value:3,natural_value:.02},{category:"Land use and waste",indicator:"Productive urban land (in percent total land)",value:3,natural_value:32.2},{category:"Land use and waste",indicator:"Waste managenet strategy",value:1,natural_value:"no"},{category:"Land use and waste",indicator:"Perception of waste index",value:3,natural_value:2.3},{category:"Land use and waste",indicator:"Green spaces, % city area",value:3,natural_value:.21},{category:"Land use and waste",indicator:"Green spaces, change in last 3 years",value:3,natural_value:-.06},{category:"Land use and waste",indicator:"NDVI",value:3,natural_value:.384},{category:"Natural disaster hazards",indicator:"Share of total area with altitude above sea level less than 0,5 meters",value:3,natural_value:.085},{category:"Natural disaster hazards",indicator:"Growth rate of freshwater mirror area",value:3,natural_value:-.06},{category:"Natural disaster hazards",indicator:"Number of registered heavy rain, flood and thunderbolt (change in last 3 years)",value:3,natural_value:-.02},{category:"Natural disaster hazards",indicator:"Number of registered sand storm (change in last 3 years)",value:3,natural_value:-.02},{category:"Natural disaster hazards",indicator:"Environmental/natural disasters’ risk mitigation",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Strategy/policy/government officials’ statement on environmental issues ",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Total overall losses from natural disaster hazards",value:3,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of days with average daily temperature above the threshold for 1990-2010",value:3,natural_value:15},{category:"Natural disaster hazards",indicator:"Number of disruptions to basic services, attributed to disasters",value:3,natural_value:0},{category:"Water availability",indicator:"Water consumption per capita",value:3,natural_value:.507},{category:"Water availability",indicator:"Water tariff to disposable income ratio",value:5,natural_value:.0003910710654340107},{category:"Water availability",indicator:"Sanitary facilities tariff to disposable income ratio",value:5,natural_value:.0001173213196302032},{category:"Water availability",indicator:"Water consumption per capita (change in last 3 years)",value:3,natural_value:-.004},{category:"Water availability",indicator:"Percentage of population with access to drinking water",value:3,natural_value:.986},{category:"Water availability",indicator:"Percentage of population with access to drinking water (change in last 3 years)",value:3,natural_value:.0016},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities",value:4,natural_value:.97},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities (change in last 3 years)",value:4,natural_value:9e-5},{category:"Food availability",indicator:"Cereal import dependency ratio (5-years average)",value:3,natural_value:.35},{category:"Food availability",indicator:"Cereal import dependency ratio (change in last 3 years)",value:3,natural_value:.002},{category:"Food availability",indicator:"Prevalence of undernourishment",value:3,natural_value:.058},{category:"Food availability",indicator:"Prevalence of undernourishment (change in last 3 years)",value:3,natural_value:-.001999999999999995},{category:"Food availability",indicator:"Prevalence of undernourishment children",value:4,natural_value:.011},{category:"Food availability",indicator:"Prevalence of undernourishment children (change in last 3 years)",value:3,natural_value:-.005000000000000001},{category:"Food availability",indicator:"Prevalence of moderate or severe food insecurity in the population",value:3,natural_value:.26},{category:"Food availability",indicator:"Share of imports in food resources",value:1,natural_value:.66},{category:"Food availability",indicator:"Percentage of people with access to at least one food vendor/retailer within 15 minutes of walking",value:3,natural_value:91},{category:"Food availability",indicator:"Perception of food availability index",value:3,natural_value:2.2},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity",value:3,natural_value:.996},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity (change in last 3 years)",value:3,natural_value:.0003348962072196038},{category:"Energy availability",indicator:"Consumption of electricity per capita",value:3,natural_value:1838.495873103703},{category:"Energy availability",indicator:"Consumption of electricity per capita (change in last 3 years)",value:4,natural_value:-.029342853464357277},{category:"Energy availability",indicator:"Electricity tariff to disposable income ratio",value:5,natural_value:.0001321820201166956},{category:"Energy availability",indicator:"Share of renewable sources in electricity consumption",value:4,natural_value:.349},{category:"Energy availability",indicator:"Perception of energy availability index",value:3,natural_value:1.07},{category:"Health",indicator:"Child mortality rate (under 5 years-old)",value:3,natural_value:14},{category:"Health",indicator:"City ambulance",value:5,natural_value:"yes"},{category:"Health",indicator:"Life expectancy at birth, years",value:5,natural_value:79.91},{category:"Health",indicator:"Life expectancy at birth goals",value:3,natural_value:"2. Country/city has a plan aimed at achieving any of components of Goal 3"},{category:"Health",indicator:"Number of hospital beds per 1,000 population",value:3,natural_value:2.25},{category:"Health",indicator:"Number of doctors per 1,000 population",value:1,natural_value:21.0740203193033},{category:"Health",indicator:"Maternal mortality ratio",value:3,natural_value:50},{category:"Health",indicator:"Ambulance arrival speed, min",value:5,natural_value:16},{category:"Education",indicator:"Literacy rate among population (15-24 Years)",value:3,natural_value:.988},{category:"Education",indicator:"Literacy rate among population (15-24 Years) (change in last 3 years)",value:3,natural_value:-.0013458966466194378},{category:"Education",indicator:"Primary education engagement",value:2,natural_value:.136},{category:"Education",indicator:"Pupils per teacher rate",value:3,natural_value:21.96},{category:"Education",indicator:"Proportion of population with post-secondary and higher education",value:3,natural_value:.267},{category:"Wealth",indicator:"Percentage of population with food expenditure is above 52% of total expenditure",value:3,natural_value:.17},{category:"Wealth",indicator:"Mean monthly salary",value:3,natural_value:1278.54},{category:"Wealth",indicator:"Mean monthly salary, change in last 3 years",value:3,natural_value:.025692033293787775},{category:"Wealth",indicator:"Disposable monthly income",value:2,natural_value:338.4257548066175},{category:"Wealth",indicator:"Disposable monthly income (change in last 3 years)",value:2,natural_value:-.06742304531464682},{category:"Wealth",indicator:"Debt to salary ratio",value:3,natural_value:4.732742033882397},{category:"Wealth",indicator:"Number of mobile phones per 1,000 population",value:3,natural_value:1202.5015122755053},{category:"Wealth",indicator:"Decile income coefficient",value:3,natural_value:31.666666666666668},{category:"Wealth",indicator:"Decile income coefficient (change in last 3 years)",value:3,natural_value:-.011987456560442311},{category:"Wealth",indicator:"Poverty headcount ratio at national poverty lines",value:3,natural_value:.0458},{category:"Wealth",indicator:"Working poverty rate (percentage of employed living below US$1.90 PPP), 15+ age (%) ",value:4,natural_value:.008},{category:"Wealth",indicator:"Poverty headcount ratio at $2.15 PPP 2017 a day",value:5,natural_value:.01},{category:"Wealth",indicator:"Living spaces per capita, sq m (change in last 3 years)",value:3,natural_value:.033},{category:"Wealth",indicator:"Population living in slums (% of urban population)",value:3,natural_value:.221},{category:"Wealth",indicator:"Availability of finance (consumer loans)",value:3,natural_value:.43},{category:"Wealth",indicator:"Perception of wealth & poverty index",value:3,natural_value:1.7},{category:"Safety",indicator:"Road fatalities rate per 100,000 population",value:4,natural_value:4.247303994294455},{category:"Safety",indicator:"Road fatalities rate per 100,000 population (change in last 3 years)",value:3,natural_value:-.051691630918183074},{category:"Safety",indicator:"Violent crime rate per 100,000 population",value:3,natural_value:10.8},{category:"Safety",indicator:"Violent crime rate per 100,000 population (change in last 3 years)",value:3,natural_value:-.012049365987475635},{category:"Safety",indicator:"Crime rate per 100,000 population",value:4,natural_value:45.15},{category:"Safety",indicator:"Crime rate per 100,000 population  (change in last 3 years)",value:3,natural_value:-.03},{category:"Safety",indicator:"Police arrival speed",value:3,natural_value:21.7},{category:"Safety",indicator:"Perception of safety index",value:3,natural_value:2.79},{category:"Livability",indicator:"Number of LEED certified green buildings",value:5,natural_value:127},{category:"Livability",indicator:"Number of CEEQUAL certified projects",value:1,natural_value:0},{category:"Livability",indicator:"Whether or not the city has ISO 37120 certification",value:5,natural_value:"yes"},{category:"Livability",indicator:"Mobile connection coverage",value:3,natural_value:.93},{category:"Livability",indicator:"Internet coverage",value:3,natural_value:.9},{category:"Livability",indicator:"Perception of livability index",value:3,natural_value:1.5},{category:"Livability",indicator:"Share of population in 1 km from hospitals",value:3,natural_value:67.4},{category:"Livability",indicator:"Share of population in 1 km from parks",value:3,natural_value:64.3},{category:"Transport",indicator:"Time loss in traffic",value:2,natural_value:.3918},{category:"Transport",indicator:"Share of the population in 1 km from public transport stop",value:3,natural_value:68.2},{category:"Transport",indicator:"Ratio of the cost of monthly public transport usage Ithe cheapest option) to average mobthly income",value:3,natural_value:.04},{category:"Transport",indicator:"Ratio of the cost of a 1-kilometer taxi ride to average mobthly income",value:3,natural_value:.04},{category:"Transport",indicator:"Percentage of city's roads that are segregated and/or has specialized lane for cyclists",value:3,natural_value:.06},{category:"Transport",indicator:"Number of public electric vehicle (EV) charging points per 100,000 population",value:3,natural_value:1.4},{category:"Transport",indicator:"Public transport (excluding subway) operates by schedule ",value:5,natural_value:"yes"},{category:"Transport",indicator:"Perception of transport index",value:3,natural_value:1.5},{category:"Inclusion",indicator:"Female-friendly city",value:3,natural_value:3},{category:"Inclusion",indicator:"Number of refugees per 1,000 population",value:1,natural_value:32.98092392553436},{category:"Inclusion",indicator:"Homeless people per 1,000 population",value:3,natural_value:7.7},{category:"Inclusion",indicator:"Difference in number of years of schooling between woman and man, woman to man ratio ",value:3,natural_value:1.05},{category:"Inclusion",indicator:"Slavery index",value:2,natural_value:33},{category:"Inclusion",indicator:"Percentage of women aged 25-34 years old that have successfully completed secondary education",value:2,natural_value:.3},{category:"Inclusion",indicator:"Regulations for building construction and equipment, public transport for people with disabilities",value:5,natural_value:"yes"},{category:"Inclusion",indicator:"Perception of inclusion index",value:3,natural_value:2.3},{category:"Accountability",indicator:"City budget execution publication",value:5,natural_value:"yes"},{category:"Accountability",indicator:"City budget publication",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Financial transparency on city government companies",value:1,natural_value:"no"},{category:"Accountability",indicator:"ISO certification",value:5,natural_value:"yes"},{category:"Accountability",indicator:"City council checks and balances",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Plans to obtain ISO certification",value:1,natural_value:"no"},{category:"Accountability",indicator:"Perception of accountability index",value:3,natural_value:.9},{category:"City budget",indicator:"Poor financial condition",value:5,natural_value:"no"},{category:"City budget",indicator:"Central/higher level government financial intervention taking place",value:5,natural_value:"no"},{category:"City budget",indicator:"Long-term financial planning",value:5,natural_value:"yes"},{category:"City budget",indicator:"Central/higher level government financial intervention is considered",value:1,natural_value:"no"},{category:"City budget",indicator:"Prudent fiscal policy requirements",value:5,natural_value:"yes"},{category:"City budget",indicator:"Medium-term planning",value:5,natural_value:"yes"},{category:"SME",indicator:"Number of SMEs per 100,000 population",value:3,natural_value:1188.4164559871294},{category:"SME",indicator:"Number of start-ups",value:3,natural_value:775},{category:"SME",indicator:"Global Startup Ecosystem Index",value:5,natural_value:.662},{category:"SME",indicator:"Number of SMEs per capita/100 000 population (change in last 3 years)",value:3,natural_value:-.060895231200825406},{category:"SME",indicator:"Number of start-ups (change in last 3 years)",value:3,natural_value:.125},{category:"Public services",indicator:"Free phone to call the police, ambulance, firefighters",value:5,natural_value:"yes"},{category:"Public services",indicator:"Services for working with citizens' appeals and complaint",value:5,natural_value:"yes"},{category:"Public services",indicator:"E-gov services",value:1,natural_value:"no"},{category:"Public services",indicator:"Perception of public services index: Public Services",value:3,natural_value:1.77},{category:"Sustainability commitment",indicator:"City ESG reporting",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"City ESG reporting verification",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"ESG planning",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"Plan with specific targets to develop and implement smart city principles",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"Rollout and status of ESG / UN SDG training across the municipal/asset workforce",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"City municipality involved in network or partnership promoting sustainable development (for example, C40 Cities network)",value:5,natural_value:"yes"}]},{city:"Amman",data:[{category:"Air pollution",indicator:"CO2 emissions",value:4,natural_value:2.29819392},{category:"Air pollution",indicator:"CO2 emissions (change in last 3 years)",value:3,natural_value:-.0397125056600682},{category:"Air pollution",indicator:"CO2 concentration",value:4,natural_value:424.0303438},{category:"Air pollution",indicator:"CO2 concentration (change in last 3 years)",value:5,natural_value:.010229294125018148},{category:"Air pollution",indicator:"Annual average of SO2 concentration in ambient air",value:3,natural_value:19.05745758},{category:"Air pollution",indicator:"Annual Average of SO2 Concentration in Ambient Air (change in last 3 years)",value:3,natural_value:-.007976779262179951},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air",value:2,natural_value:27.8},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air"},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:.002166534267350411},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air, microgram/m3",value:2,natural_value:63.70975559},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:-.008936926031556151},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air, microgram/m3",value:4,natural_value:.229819392},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:-.0397125056600682},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air, microgram/m3",value:4,natural_value:56.1712303},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:-.02113665705443046},{category:"Air pollution",indicator:"Volatile organic compounds/reactive organic gases emissions",value:3,natural_value:1.7},{category:"Air pollution",indicator:"Perception of air pollution index",value:3,natural_value:1.6},{category:"Air pollution",indicator:"Paris Agreement",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Annual average of dissolved oxygen (DO) concentration in water",value:3,natural_value:6.08},{category:"Water pollution",indicator:"Annual average of pH concentration in water",value:3,natural_value:7.1},{category:"Water pollution",indicator:"Annual average dissolved solids in drinking-water",value:2,natural_value:319.4},{category:"Water pollution",indicator:"Water management strategy in a city",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Perception of water pollution index",value:3,natural_value:1.9},{category:"Land use and waste",indicator:"Share of devastated and degraded land area requiring reclamation",value:2,natural_value:23},{category:"Land use and waste",indicator:"3-year average growth rate of devastated and degraded land area requiring reclamation",value:3,natural_value:.002},{category:"Land use and waste",indicator:"Waste deposits",value:3,natural_value:.009},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous)",value:3,natural_value:635},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous), (change in last 3 years)",value:3,natural_value:4.2},{category:"Land use and waste",indicator:"Total recycled construction waste",value:3,natural_value:1.7},{category:"Land use and waste",indicator:"Share of recycled construction and demolish waste in total generated construction and demolish waste",value:2,natural_value:.07},{category:"Land use and waste",indicator:"Total area of impervious surfaces and percentage to total city area",value:4,natural_value:.00578},{category:"Land use and waste",indicator:"Productive urban land (in percent total land)",value:3,natural_value:32.2},{category:"Land use and waste",indicator:"Waste managenet strategy",value:5,natural_value:"yes"},{category:"Land use and waste",indicator:"Perception of waste index",value:3,natural_value:2.3},{category:"Land use and waste",indicator:"Green spaces, % city area",value:3,natural_value:.21},{category:"Land use and waste",indicator:"Green spaces, change in last 3 years",value:3,natural_value:-.06},{category:"Land use and waste",indicator:"NDVI",value:4,natural_value:.159},{category:"Natural disaster hazards",indicator:"Share of total area with altitude above sea level less than 0,5 meters",value:3,natural_value:.085},{category:"Natural disaster hazards",indicator:"Growth rate of freshwater mirror area",value:3,natural_value:-.06},{category:"Natural disaster hazards",indicator:"Number of registered heavy rain, flood and thunderbolt (change in last 3 years)",value:4,natural_value:-.115709},{category:"Natural disaster hazards",indicator:"Number of registered sand storm (change in last 3 years)",value:4,natural_value:-.115709},{category:"Natural disaster hazards",indicator:"Environmental/natural disasters’ risk mitigation",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Strategy/policy/government officials’ statement on environmental issues ",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Total overall losses from natural disaster hazards",value:3,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of days with average daily temperature above the threshold for 1990-2010",value:3,natural_value:15},{category:"Natural disaster hazards",indicator:"Number of disruptions to basic services, attributed to disasters",value:3,natural_value:0},{category:"Water availability",indicator:"Water consumption per capita",value:3,natural_value:61e-6},{category:"Water availability",indicator:"Water tariff to disposable income ratio",value:3,natural_value:1.29},{category:"Water availability",indicator:"Sanitary facilities tariff to disposable income ratio",value:3,natural_value:1.1},{category:"Water availability",indicator:"Water consumption per capita (change in last 3 years)",value:3,natural_value:.037490119437293856},{category:"Water availability",indicator:"Percentage of population with access to drinking water",value:3,natural_value:.98},{category:"Water availability",indicator:"Percentage of population with access to drinking water (change in last 3 years)",value:3,natural_value:-337e-6},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities",value:4,natural_value:.971},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities (change in last 3 years)",value:4,natural_value:-343e-6},{category:"Food availability",indicator:"Cereal import dependency ratio (5-years average)",value:1,natural_value:1},{category:"Food availability",indicator:"Cereal import dependency ratio (change in last 3 years)",value:3,natural_value:.002},{category:"Food availability",indicator:"Prevalence of undernourishment",value:3,natural_value:.169},{category:"Food availability",indicator:"Prevalence of undernourishment (change in last 3 years)",value:3,natural_value:.05700000000000001},{category:"Food availability",indicator:"Prevalence of undernourishment children",value:4,natural_value:.006},{category:"Food availability",indicator:"Prevalence of undernourishment children (change in last 3 years)",value:3,natural_value:-.018000000000000002},{category:"Food availability",indicator:"Prevalence of moderate or severe food insecurity in the population",value:3,natural_value:.26},{category:"Food availability",indicator:"Share of imports in food resources",value:3,natural_value:.43},{category:"Food availability",indicator:"Percentage of people with access to at least one food vendor/retailer within 15 minutes of walking",value:3,natural_value:91},{category:"Food availability",indicator:"Perception of food availability index",value:3,natural_value:2.2},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity",value:5,natural_value:1},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity (change in last 3 years)",value:3,natural_value:.01},{category:"Energy availability",indicator:"Consumption of electricity per capita",value:3,natural_value:4171},{category:"Energy availability",indicator:"Consumption of electricity per capita (change in last 3 years)",value:3,natural_value:.04},{category:"Energy availability",indicator:"Electricity tariff to disposable income ratio",value:3,natural_value:.1},{category:"Energy availability",indicator:"Share of renewable sources in electricity consumption",value:2,natural_value:.1104},{category:"Energy availability",indicator:"Perception of energy availability index",value:3,natural_value:1.07},{category:"Health",indicator:"Child mortality rate (under 5 years-old)",value:3,natural_value:14.6},{category:"Health",indicator:"City ambulance",value:5,natural_value:"yes"},{category:"Health",indicator:"Life expectancy at birth, years",value:4,natural_value:77.9},{category:"Health",indicator:"Life expectancy at birth goals",value:1,natural_value:"1. No plans aimed at achieving any of components of Goal 3 or increasing LEaB"},{category:"Health",indicator:"Number of hospital beds per 1,000 population",value:3,natural_value:1.47},{category:"Health",indicator:"Number of doctors per 1,000 population",value:3,natural_value:2.5},{category:"Health",indicator:"Maternal mortality ratio",value:4,natural_value:41},{category:"Health",indicator:"Ambulance arrival speed, min",value:5,natural_value:8.8},{category:"Education",indicator:"Literacy rate among population (15-24 Years)",value:4,natural_value:.994199982},{category:"Education",indicator:"Literacy rate among population (15-24 Years) (change in last 3 years)",value:3,natural_value:312e-6},{category:"Education",indicator:"Primary education engagement",value:3,natural_value:.5406670007324498},{category:"Education",indicator:"Pupils per teacher rate",value:3,natural_value:18.5},{category:"Education",indicator:"Proportion of population with post-secondary and higher education",value:3,natural_value:.325574417114258},{category:"Wealth",indicator:"Percentage of population with food expenditure is above 52% of total expenditure",value:4,natural_value:.071},{category:"Wealth",indicator:"Mean monthly salary",value:3,natural_value:2284.29},{category:"Wealth",indicator:"Mean monthly salary, change in last 3 years",value:3,natural_value:.01098},{category:"Wealth",indicator:"Disposable monthly income",value:3,natural_value:595.7819488480237},{category:"Wealth",indicator:"Disposable monthly income (change in last 3 years)",value:3,natural_value:.04442},{category:"Wealth",indicator:"Debt to salary ratio",value:5,natural_value:.088},{category:"Wealth",indicator:"Number of mobile phones per 1,000 population",value:4,natural_value:675.6799743},{category:"Wealth",indicator:"Decile income coefficient",value:4,natural_value:7.857142857142857},{category:"Wealth",indicator:"Decile income coefficient (change in last 3 years)",value:3,natural_value:-.011548},{category:"Wealth",indicator:"Poverty headcount ratio at national poverty lines",value:3,natural_value:.157},{category:"Wealth",indicator:"Working poverty rate (percentage of employed living below US$1.90 PPP), 15+ age (%) ",value:1,natural_value:.2},{category:"Wealth",indicator:"Poverty headcount ratio at $2.15 PPP 2017 a day",value:1,natural_value:.1},{category:"Wealth",indicator:"Living spaces per capita, sq m (change in last 3 years)",value:3,natural_value:.033},{category:"Wealth",indicator:"Population living in slums (% of urban population)",value:3,natural_value:.17},{category:"Wealth",indicator:"Availability of finance (consumer loans)",value:3,natural_value:.43},{category:"Wealth",indicator:"Perception of wealth & poverty index",value:3,natural_value:1.7},{category:"Safety",indicator:"Road fatalities rate per 100,000 population",value:2,natural_value:19.68},{category:"Safety",indicator:"Road fatalities rate per 100,000 population (change in last 3 years)",value:3,natural_value:-.095554},{category:"Safety",indicator:"Violent crime rate per 100,000 population",value:3,natural_value:11.418181818181818},{category:"Safety",indicator:"Violent crime rate per 100,000 population (change in last 3 years)",value:2,natural_value:.075114},{category:"Safety",indicator:"Crime rate per 100,000 population",value:3,natural_value:530.1151894060845},{category:"Safety",indicator:"Crime rate per 100,000 population  (change in last 3 years)",value:3,natural_value:-.03},{category:"Safety",indicator:"Police arrival speed",value:3,natural_value:21.7},{category:"Safety",indicator:"Perception of safety index",value:3,natural_value:2.79},{category:"Livability",indicator:"Number of LEED certified green buildings",value:4,natural_value:21.55},{category:"Livability",indicator:"Number of CEEQUAL certified projects",value:1,natural_value:0},{category:"Livability",indicator:"Whether or not the city has ISO 37120 certification",value:5,natural_value:"yes"},{category:"Livability",indicator:"Mobile connection coverage",value:3,natural_value:.93},{category:"Livability",indicator:"Internet coverage",value:3,natural_value:.9},{category:"Livability",indicator:"Perception of livability index",value:3,natural_value:1.5},{category:"Livability",indicator:"Share of population in 1 km from hospitals",value:3,natural_value:37.6},{category:"Livability",indicator:"Share of population in 1 km from parks",value:3,natural_value:64.3},{category:"Transport",indicator:"Time loss in traffic",value:2,natural_value:.3768},{category:"Transport",indicator:"Share of the population in 1 km from public transport stop",value:3,natural_value:29.1},{category:"Transport",indicator:"Ratio of the cost of monthly public transport usage Ithe cheapest option) to average mobthly income",value:5,natural_value:.01751091148672016},{category:"Transport",indicator:"Ratio of the cost of a 1-kilometer taxi ride to average mobthly income",value:5,natural_value:.0006566591807520061},{category:"Transport",indicator:"Percentage of city's roads that are segregated and/or has specialized lane for cyclists",value:3,natural_value:.06},{category:"Transport",indicator:"Number of public electric vehicle (EV) charging points per 100,000 population",value:2,natural_value:.28846153846153844},{category:"Transport",indicator:"Public transport (excluding subway) operates by schedule ",value:5,natural_value:"yes"},{category:"Transport",indicator:"Perception of transport index",value:3,natural_value:1.5},{category:"Inclusion",indicator:"Female-friendly city",value:5,natural_value:1},{category:"Inclusion",indicator:"Number of refugees per 1,000 population",value:3,natural_value:4.1},{category:"Inclusion",indicator:"Homeless people per 1,000 population",value:3,natural_value:7.7},{category:"Inclusion",indicator:"Difference in number of years of schooling between woman and man, woman to man ratio ",value:3,natural_value:.93},{category:"Inclusion",indicator:"Slavery index",value:1,natural_value:49},{category:"Inclusion",indicator:"Percentage of women aged 25-34 years old that have successfully completed secondary education",value:3,natural_value:.41},{category:"Inclusion",indicator:"Regulations for building construction and equipment, public transport for people with disabilities",value:5,natural_value:"yes"},{category:"Inclusion",indicator:"Perception of inclusion index",value:3,natural_value:2.3},{category:"Accountability",indicator:"City budget execution publication",value:5,natural_value:"yes"},{category:"Accountability",indicator:"City budget publication",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Financial transparency on city government companies",value:1,natural_value:"no"},{category:"Accountability",indicator:"ISO certification",value:5,natural_value:"yes"},{category:"Accountability",indicator:"City council checks and balances",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Plans to obtain ISO certification",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Perception of accountability index",value:3,natural_value:.9},{category:"City budget",indicator:"Poor financial condition",value:5,natural_value:"no"},{category:"City budget",indicator:"Central/higher level government financial intervention taking place",value:5,natural_value:"no"},{category:"City budget",indicator:"Central/higher level government financial intervention is considered",value:1,natural_value:"no"},{category:"City budget",indicator:"Prudent fiscal policy requirements",value:1,natural_value:"no"},{category:"City budget",indicator:"Medium-term planning",value:5,natural_value:"yes"},{category:"SME",indicator:"Number of SMEs per 100,000 population",value:3,natural_value:9336},{category:"SME",indicator:"Number of start-ups",value:2,natural_value:80},{category:"SME",indicator:"Global Startup Ecosystem Index",value:2,natural_value:2.425},{category:"SME",indicator:"Number of SMEs per capita/100 000 population (change in last 3 years)",value:3,natural_value:-7e-4},{category:"SME",indicator:"Number of start-ups (change in last 3 years)",value:3,natural_value:.125},{category:"Public services",indicator:"Free phone to call the police, ambulance, firefighters",value:1,natural_value:"no"},{category:"Public services",indicator:"Services for working with citizens' appeals and complaint",value:5,natural_value:"yes"},{category:"Public services",indicator:"E-gov services",value:5,natural_value:"yes"},{category:"Public services",indicator:"Perception of public services index: Public Services",value:3,natural_value:1.77},{category:"Sustainability commitment",indicator:"City ESG reporting",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"City ESG reporting verification",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"ESG planning",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"Plan with specific targets to develop and implement smart city principles",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"Rollout and status of ESG / UN SDG training across the municipal/asset workforce",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"City municipality involved in network or partnership promoting sustainable development (for example, C40 Cities network)",value:5,natural_value:"yes"}]},{city:"Bangkok",data:[{category:"Air pollution",indicator:"CO2 emissions",value:3,natural_value:4.43369794},{category:"Air pollution",indicator:"CO2 emissions (change in last 3 years)",value:3,natural_value:.07848997390501591},{category:"Air pollution",indicator:"CO2 concentration",value:2,natural_value:460.5116023},{category:"Air pollution",indicator:"CO2 concentration (change in last 3 years)",value:5,natural_value:.0058540614082655705},{category:"Air pollution",indicator:"Annual average of SO2 concentration in ambient air",value:3,natural_value:23.48326534},{category:"Air pollution",indicator:"Annual Average of SO2 Concentration in Ambient Air (change in last 3 years)",value:3,natural_value:.09924267894029333},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air",value:3,natural_value:21.5},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air"},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:.09681541685835517},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air, microgram/m3",value:5,natural_value:40.72419549},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:-.07769443975402442},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air, microgram/m3",value:3,natural_value:.443369794},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:.07848997390501591},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air, microgram/m3",value:3,natural_value:80.77055411},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:.0716916595957008},{category:"Air pollution",indicator:"Volatile organic compounds/reactive organic gases emissions",value:3,natural_value:1.7},{category:"Air pollution",indicator:"Perception of air pollution index",value:3,natural_value:1.6},{category:"Air pollution",indicator:"Paris Agreement",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Annual average of dissolved oxygen (DO) concentration in water",value:3,natural_value:6.08},{category:"Water pollution",indicator:"Annual average of pH concentration in water",value:3,natural_value:7.1},{category:"Water pollution",indicator:"Annual average dissolved solids in drinking-water",value:3,natural_value:139},{category:"Water pollution",indicator:"Water management strategy in a city",value:5,natural_value:"no"},{category:"Water pollution",indicator:"Perception of water pollution index",value:3,natural_value:1.9},{category:"Land use and waste",indicator:"Share of devastated and degraded land area requiring reclamation",value:2,natural_value:21},{category:"Land use and waste",indicator:"3-year average growth rate of devastated and degraded land area requiring reclamation",value:3,natural_value:.002},{category:"Land use and waste",indicator:"Waste deposits",value:3,natural_value:.009},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous)",value:3,natural_value:635},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous), (change in last 3 years)",value:3,natural_value:4.2},{category:"Land use and waste",indicator:"Total recycled construction waste",value:3,natural_value:1.7},{category:"Land use and waste",indicator:"Share of recycled construction and demolish waste in total generated construction and demolish waste",value:3,natural_value:.249},{category:"Land use and waste",indicator:"Total area of impervious surfaces and percentage to total city area",value:4,natural_value:.010827876520112254},{category:"Land use and waste",indicator:"Productive urban land (in percent total land)",value:3,natural_value:32.2},{category:"Land use and waste",indicator:"Waste managenet strategy",value:5,natural_value:"yes"},{category:"Land use and waste",indicator:"Perception of waste index",value:3,natural_value:2.3},{category:"Land use and waste",indicator:"Green spaces, % city area",value:3,natural_value:.21},{category:"Land use and waste",indicator:"Green spaces, change in last 3 years",value:3,natural_value:-.06},{category:"Land use and waste",indicator:"NDVI",value:3,natural_value:.373},{category:"Natural disaster hazards",indicator:"Share of total area with altitude above sea level less than 0,5 meters",value:3,natural_value:.085},{category:"Natural disaster hazards",indicator:"Growth rate of freshwater mirror area",value:3,natural_value:-.06},{category:"Natural disaster hazards",indicator:"Number of registered heavy rain, flood and thunderbolt (change in last 3 years)",value:1,natural_value:.5},{category:"Natural disaster hazards",indicator:"Number of registered sand storm (change in last 3 years)",value:1,natural_value:.5},{category:"Natural disaster hazards",indicator:"Environmental/natural disasters’ risk mitigation",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Strategy/policy/government officials’ statement on environmental issues ",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Total overall losses from natural disaster hazards",value:2,natural_value:606.681668405105},{category:"Natural disaster hazards",indicator:"Number of days with average daily temperature above the threshold for 1990-2010",value:3,natural_value:1},{category:"Natural disaster hazards",indicator:"Number of disruptions to basic services, attributed to disasters",value:3,natural_value:0},{category:"Water availability",indicator:"Water consumption per capita",value:3,natural_value:1095e-7},{category:"Water availability",indicator:"Water tariff to disposable income ratio",value:4,natural_value:.01731179318646874},{category:"Water availability",indicator:"Sanitary facilities tariff to disposable income ratio",value:3,natural_value:1.1},{category:"Water availability",indicator:"Water consumption per capita (change in last 3 years)",value:5,natural_value:-.004},{category:"Water availability",indicator:"Percentage of population with access to drinking water",value:5,natural_value:.99},{category:"Water availability",indicator:"Percentage of population with access to drinking water (change in last 3 years)",value:3,natural_value:.0016},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities",value:4,natural_value:.987},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities (change in last 3 years)",value:4,natural_value:.002035},{category:"Food availability",indicator:"Cereal import dependency ratio (5-years average)",value:2,natural_value:.57},{category:"Food availability",indicator:"Cereal import dependency ratio (change in last 3 years)",value:3,natural_value:.002},{category:"Food availability",indicator:"Prevalence of undernourishment",value:3,natural_value:.052},{category:"Food availability",indicator:"Prevalence of undernourishment (change in last 3 years)",value:3,natural_value:-.008},{category:"Food availability",indicator:"Prevalence of undernourishment children",value:4,natural_value:.077},{category:"Food availability",indicator:"Prevalence of undernourishment children (change in last 3 years)",value:5,natural_value:.023},{category:"Food availability",indicator:"Prevalence of moderate or severe food insecurity in the population",value:5,natural_value:.071},{category:"Food availability",indicator:"Share of imports in food resources",value:5,natural_value:.04},{category:"Food availability",indicator:"Percentage of people with access to at least one food vendor/retailer within 15 minutes of walking",value:3,natural_value:91},{category:"Food availability",indicator:"Perception of food availability index",value:3,natural_value:2.2},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity",value:5,natural_value:1},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity (change in last 3 years)",value:3,natural_value:601e-6},{category:"Energy availability",indicator:"Consumption of electricity per capita",value:3,natural_value:3748.45273},{category:"Energy availability",indicator:"Consumption of electricity per capita (change in last 3 years)",value:3,natural_value:.04},{category:"Energy availability",indicator:"Electricity tariff to disposable income ratio",value:5,natural_value:.001137782160890261},{category:"Energy availability",indicator:"Share of renewable sources in electricity consumption",value:2,natural_value:.1526},{category:"Energy availability",indicator:"Perception of energy availability index",value:3,natural_value:1.07},{category:"Health",indicator:"Child mortality rate (under 5 years-old)",value:3,natural_value:8.29},{category:"Health",indicator:"City ambulance",value:5,natural_value:"yes"},{category:"Health",indicator:"Life expectancy at birth, years",value:4,natural_value:77.74},{category:"Health",indicator:"Life expectancy at birth goals",value:5,natural_value:"3. Country/city has a plan aimed directly at achieving of increasing LEaB"},{category:"Health",indicator:"Number of hospital beds per 1,000 population",value:3,natural_value:2.41},{category:"Health",indicator:"Number of doctors per 1,000 population",value:4,natural_value:.95},{category:"Health",indicator:"Maternal mortality ratio",value:4,natural_value:29},{category:"Health",indicator:"Ambulance arrival speed, min",value:1,natural_value:300},{category:"Education",indicator:"Literacy rate among population (15-24 Years)",value:3,natural_value:.988000030517578},{category:"Education",indicator:"Literacy rate among population (15-24 Years) (change in last 3 years)",value:3,natural_value:943e-6},{category:"Education",indicator:"Primary education engagement",value:3,natural_value:.484145},{category:"Education",indicator:"Pupils per teacher rate",value:3,natural_value:16.6},{category:"Education",indicator:"Proportion of population with post-secondary and higher education",value:2,natural_value:.129012299},{category:"Wealth",indicator:"Percentage of population with food expenditure is above 52% of total expenditure",value:3,natural_value:.18},{category:"Wealth",indicator:"Mean monthly salary",value:2,natural_value:420.54},{category:"Wealth",indicator:"Mean monthly salary, change in last 3 years",value:3,natural_value:.016679},{category:"Wealth",indicator:"Disposable monthly income",value:3,natural_value:571.2868617059399},{category:"Wealth",indicator:"Disposable monthly income (change in last 3 years)",value:3,natural_value:-.024122},{category:"Wealth",indicator:"Debt to salary ratio",value:5,natural_value:.2270070622615472},{category:"Wealth",indicator:"Number of mobile phones per 1,000 population",value:4,natural_value:1763.169269},{category:"Wealth",indicator:"Decile income coefficient",value:4,natural_value:8.53125},{category:"Wealth",indicator:"Decile income coefficient (change in last 3 years)",value:3,natural_value:.011596},{category:"Wealth",indicator:"Poverty headcount ratio at national poverty lines",value:3,natural_value:.063},{category:"Wealth",indicator:"Working poverty rate (percentage of employed living below US$1.90 PPP), 15+ age (%) ",value:2,natural_value:.1},{category:"Wealth",indicator:"Poverty headcount ratio at $2.15 PPP 2017 a day",value:2,natural_value:.04},{category:"Wealth",indicator:"Living spaces per capita, sq m (change in last 3 years)",value:3,natural_value:.033},{category:"Wealth",indicator:"Population living in slums (% of urban population)",value:4,natural_value:.0679482},{category:"Wealth",indicator:"Availability of finance (consumer loans)",value:3,natural_value:.43},{category:"Wealth",indicator:"Perception of wealth & poverty index",value:3,natural_value:1.7},{category:"Safety",indicator:"Road fatalities rate per 100,000 population",value:2,natural_value:30.48},{category:"Safety",indicator:"Road fatalities rate per 100,000 population (change in last 3 years)",value:3,natural_value:-.0137},{category:"Safety",indicator:"Violent crime rate per 100,000 population",value:4,natural_value:2.58},{category:"Safety",indicator:"Violent crime rate per 100,000 population (change in last 3 years)",value:2,natural_value:.0481278275098662},{category:"Safety",indicator:"Crime rate per 100,000 population",value:4,natural_value:40.55},{category:"Safety",indicator:"Crime rate per 100,000 population  (change in last 3 years)",value:3,natural_value:-.03},{category:"Safety",indicator:"Police arrival speed",value:3,natural_value:20},{category:"Safety",indicator:"Perception of safety index",value:3,natural_value:2.79},{category:"Livability",indicator:"Number of LEED certified green buildings",value:4,natural_value:21.55},{category:"Livability",indicator:"Number of CEEQUAL certified projects",value:1,natural_value:0},{category:"Livability",indicator:"Whether or not the city has ISO 37120 certification",value:1,natural_value:"no"},{category:"Livability",indicator:"Mobile connection coverage",value:5,natural_value:1},{category:"Livability",indicator:"Internet coverage",value:5,natural_value:1},{category:"Livability",indicator:"Perception of livability index",value:3,natural_value:1.5},{category:"Livability",indicator:"Share of population in 1 km from hospitals",value:3,natural_value:29.4},{category:"Livability",indicator:"Share of population in 1 km from parks",value:3,natural_value:64.3},{category:"Transport",indicator:"Time loss in traffic",value:1,natural_value:.6456},{category:"Transport",indicator:"Share of the population in 1 km from public transport stop",value:3,natural_value:55.1},{category:"Transport",indicator:"Ratio of the cost of monthly public transport usage Ithe cheapest option) to average mobthly income",value:5,natural_value:.09120895596981358},{category:"Transport",indicator:"Ratio of the cost of a 1-kilometer taxi ride to average mobthly income",value:5,natural_value:.002687021448613687},{category:"Transport",indicator:"Percentage of city's roads that are segregated and/or has specialized lane for cyclists",value:3,natural_value:.06},{category:"Transport",indicator:"Number of public electric vehicle (EV) charging points per 100,000 population",value:5,natural_value:3.191340782122905},{category:"Transport",indicator:"Public transport (excluding subway) operates by schedule ",value:5,natural_value:"yes"},{category:"Transport",indicator:"Perception of transport index",value:3,natural_value:1.5},{category:"Inclusion",indicator:"Female-friendly city",value:1,natural_value:4},{category:"Inclusion",indicator:"Number of refugees per 1,000 population",value:3,natural_value:4.1},{category:"Inclusion",indicator:"Homeless people per 1,000 population",value:5,natural_value:.229357798},{category:"Inclusion",indicator:"Difference in number of years of schooling between woman and man, woman to man ratio ",value:3,natural_value:.97},{category:"Inclusion",indicator:"Slavery index",value:1,natural_value:46},{category:"Inclusion",indicator:"Percentage of women aged 25-34 years old that have successfully completed secondary education",value:3,natural_value:.41},{category:"Inclusion",indicator:"Regulations for building construction and equipment, public transport for people with disabilities",value:5,natural_value:"yes"},{category:"Inclusion",indicator:"Perception of inclusion index",value:3,natural_value:2.3},{category:"Accountability",indicator:"City budget execution publication",value:5,natural_value:"yes"},{category:"Accountability",indicator:"City budget publication",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Financial transparency on city government companies",value:1,natural_value:"no"},{category:"Accountability",indicator:"ISO certification",value:1,natural_value:"no"},{category:"Accountability",indicator:"City council checks and balances",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Plans to obtain ISO certification",value:1,natural_value:"no"},{category:"Accountability",indicator:"Perception of accountability index",value:3,natural_value:.9},{category:"City budget",indicator:"Poor financial condition",value:5,natural_value:"no"},{category:"City budget",indicator:"Central/higher level government financial intervention taking place",value:5,natural_value:"no"},{category:"City budget",indicator:"Long-term financial planning",value:1,natural_value:"no"},{category:"City budget",indicator:"Central/higher level government financial intervention is considered",value:1,natural_value:"no"},{category:"City budget",indicator:"Prudent fiscal policy requirements",value:1,natural_value:"no"},{category:"City budget",indicator:"Medium-term planning",value:1,natural_value:"no"},{category:"SME",indicator:"Number of SMEs per 100,000 population",value:3,natural_value:4558.664923782264},{category:"SME",indicator:"Number of start-ups",value:2,natural_value:184},{category:"SME",indicator:"Global Startup Ecosystem Index",value:4,natural_value:8.619},{category:"SME",indicator:"Number of SMEs per capita/100 000 population (change in last 3 years)",value:3,natural_value:.011495},{category:"SME",indicator:"Number of start-ups (change in last 3 years)",value:3,natural_value:.125},{category:"Public services",indicator:"Free phone to call the police, ambulance, firefighters",value:1,natural_value:"no"},{category:"Public services",indicator:"Services for working with citizens' appeals and complaint",value:1,natural_value:"no"},{category:"Public services",indicator:"E-gov services",value:1,natural_value:"no"},{category:"Public services",indicator:"Perception of public services index: Public Services",value:3,natural_value:1.77},{category:"Sustainability commitment",indicator:"City ESG reporting",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"City ESG reporting verification",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"ESG planning",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"Plan with specific targets to develop and implement smart city principles",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"Rollout and status of ESG / UN SDG training across the municipal/asset workforce",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"City municipality involved in network or partnership promoting sustainable development (for example, C40 Cities network)",value:5,natural_value:"yes"}]},{city:"Colombo",data:[{category:"Air pollution",indicator:"CO2 emissions",value:3,natural_value:3.6589237000000003},{category:"Air pollution",indicator:"CO2 emissions (change in last 3 years)",value:3,natural_value:.026410067738081355},{category:"Air pollution",indicator:"CO2 concentration",value:3,natural_value:436.697055},{category:"Air pollution",indicator:"CO2 concentration (change in last 3 years)",value:5,natural_value:.009401072323507535},{category:"Air pollution",indicator:"Annual average of SO2 concentration in ambient air",value:3,natural_value:18.4707334},{category:"Air pollution",indicator:"Annual Average of SO2 Concentration in Ambient Air (change in last 3 years)",value:3,natural_value:-.002810218110774317},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air",value:3,natural_value:13.5},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air"},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:-.015029913906318366},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air, microgram/m3",value:3,natural_value:48.62512501},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:.041136887700210525},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air, microgram/m3",value:3,natural_value:.36589237},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:.026410067738081355},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air, microgram/m3",value:3,natural_value:75.11740601},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air (change in last 3 years), microgram/m3",value:3,natural_value:.031062641636741342},{category:"Air pollution",indicator:"Volatile organic compounds/reactive organic gases emissions",value:3,natural_value:1.7},{category:"Air pollution",indicator:"Perception of air pollution index",value:3,natural_value:1.6},{category:"Air pollution",indicator:"Paris Agreement",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Annual average of dissolved oxygen (DO) concentration in water",value:3,natural_value:6.08},{category:"Water pollution",indicator:"Annual average of pH concentration in water",value:3,natural_value:7.1},{category:"Water pollution",indicator:"Annual average dissolved solids in drinking-water",value:4,natural_value:24.51},{category:"Water pollution",indicator:"Water management strategy in a city",value:5,natural_value:"yes"},{category:"Water pollution",indicator:"Perception of water pollution index",value:3,natural_value:1.9},{category:"Land use and waste",indicator:"Share of devastated and degraded land area requiring reclamation",value:3,natural_value:7},{category:"Land use and waste",indicator:"3-year average growth rate of devastated and degraded land area requiring reclamation",natural_value:.002},{category:"Land use and waste",indicator:"Waste deposits",natural_value:.005},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous)",value:3,natural_value:635},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous), (change in last 3 years)",value:3,natural_value:4.2},{category:"Land use and waste",indicator:"Total recycled construction waste",value:3,natural_value:1.7},{category:"Land use and waste",indicator:"Share of recycled construction and demolish waste in total generated construction and demolish waste",value:3,natural_value:.249},{category:"Land use and waste",indicator:"Total area of impervious surfaces and percentage to total city area",value:3,natural_value:.02},{category:"Land use and waste",indicator:"Productive urban land (in percent total land)",value:3,natural_value:32.2},{category:"Land use and waste",indicator:"Waste managenet strategy",value:1,natural_value:"no"},{category:"Land use and waste",indicator:"Perception of waste index",value:3,natural_value:2.3},{category:"Land use and waste",indicator:"Green spaces, % city area",value:3,natural_value:.24},{category:"Land use and waste",indicator:"Green spaces, change in last 3 years",value:3,natural_value:-.06},{category:"Land use and waste",indicator:"NDVI",value:2,natural_value:.575},{category:"Natural disaster hazards",indicator:"Share of total area with altitude above sea level less than 0,5 meters",value:3,natural_value:.085},{category:"Natural disaster hazards",indicator:"Growth rate of freshwater mirror area",value:3,natural_value:-.06},{category:"Natural disaster hazards",indicator:"Number of registered heavy rain, flood and thunderbolt (change in last 3 years)",value:5,natural_value:-.5},{category:"Natural disaster hazards",indicator:"Number of registered sand storm (change in last 3 years)",value:5,natural_value:-.5},{category:"Natural disaster hazards",indicator:"Environmental/natural disasters’ risk mitigation",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Strategy/policy/government officials’ statement on environmental issues ",value:5,natural_value:"yes"},{category:"Natural disaster hazards",indicator:"Total overall losses from natural disaster hazards",value:3,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of days with average daily temperature above the threshold for 1990-2010",value:3,natural_value:15},{category:"Natural disaster hazards",indicator:"Number of disruptions to basic services, attributed to disasters",value:3,natural_value:0},{category:"Water availability",indicator:"Water consumption per capita",value:3,natural_value:.11944},{category:"Water availability",indicator:"Water tariff to disposable income ratio",value:3,natural_value:1.29},{category:"Water availability",indicator:"Sanitary facilities tariff to disposable income ratio",value:3,natural_value:1.1},{category:"Water availability",indicator:"Water consumption per capita (change in last 3 years)",value:5,natural_value:-.004},{category:"Water availability",indicator:"Percentage of population with access to drinking water",value:5,natural_value:.99},{category:"Water availability",indicator:"Percentage of population with access to drinking water (change in last 3 years)",value:3,natural_value:.0016},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities",value:3,natural_value:.915},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities (change in last 3 years)",value:4,natural_value:9e-5},{category:"Food availability",indicator:"Cereal import dependency ratio (5-years average)",value:3,natural_value:.35},{category:"Food availability",indicator:"Cereal import dependency ratio (change in last 3 years)",value:3,natural_value:.002},{category:"Food availability",indicator:"Prevalence of undernourishment",value:3,natural_value:.058},{category:"Food availability",indicator:"Prevalence of undernourishment (change in last 3 years)",value:3,natural_value:-.001999999999999995},{category:"Food availability",indicator:"Prevalence of undernourishment children",value:4,natural_value:.151},{category:"Food availability",indicator:"Prevalence of undernourishment children (change in last 3 years)",value:1,natural_value:-.10834034891947486},{category:"Food availability",indicator:"Prevalence of moderate or severe food insecurity in the population",value:4,natural_value:.109},{category:"Food availability",indicator:"Share of imports in food resources",value:4,natural_value:.209},{category:"Food availability",indicator:"Percentage of people with access to at least one food vendor/retailer within 15 minutes of walking",value:3,natural_value:91},{category:"Food availability",indicator:"Perception of food availability index",value:3,natural_value:2.2},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity",value:3,natural_value:.986},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity (change in last 3 years)",value:5,natural_value:.04506506935002963},{category:"Energy availability",indicator:"Consumption of electricity per capita",value:4,natural_value:626},{category:"Energy availability",indicator:"Consumption of electricity per capita (change in last 3 years)",value:3,natural_value:.056395649590240904},{category:"Energy availability",indicator:"Electricity tariff to disposable income ratio",value:3,natural_value:.1},{category:"Energy availability",indicator:"Share of renewable sources in electricity consumption",value:5,natural_value:.4932},{category:"Energy availability",indicator:"Perception of energy availability index",value:3,natural_value:1.07},{category:"Health",indicator:"Child mortality rate (under 5 years-old)",value:3,natural_value:14.9},{category:"Health",indicator:"City ambulance",value:5,natural_value:"yes"},{category:"Health",indicator:"Life expectancy at birth, years",value:4,natural_value:76.9},{category:"Health",indicator:"Life expectancy at birth goals",value:1,natural_value:"1. No plans aimed at achieving any of components of Goal 3 or increasing LEaB"},{category:"Health",indicator:"Number of hospital beds per 1,000 population",value:3,natural_value:4.2},{category:"Health",indicator:"Number of doctors per 1,000 population",value:4,natural_value:1.2},{category:"Health",indicator:"Maternal mortality ratio",value:4,natural_value:29},{category:"Health",indicator:"Ambulance arrival speed, min",value:5,natural_value:10},{category:"Education",indicator:"Literacy rate among population (15-24 Years)",value:3,natural_value:.99},{category:"Education",indicator:"Literacy rate among population (15-24 Years) (change in last 3 years)",value:3,natural_value:.00033692724921396966},{category:"Education",indicator:"Primary education engagement",value:3,natural_value:.73},{category:"Education",indicator:"Pupils per teacher rate",value:5,natural_value:.217},{category:"Education",indicator:"Proportion of population with post-secondary and higher education",value:3,natural_value:.296},{category:"Wealth",indicator:"Percentage of population with food expenditure is above 52% of total expenditure",value:2,natural_value:.555},{category:"Wealth",indicator:"Mean monthly salary",value:2,natural_value:182.75},{category:"Wealth",indicator:"Mean monthly salary, change in last 3 years",value:3,natural_value:.020413775479336982},{category:"Wealth",indicator:"Disposable monthly income",value:3,natural_value:784},{category:"Wealth",indicator:"Disposable monthly income (change in last 3 years)",value:3,natural_value:.02},{category:"Wealth",indicator:"Debt to salary ratio",value:3,natural_value:5},{category:"Wealth",indicator:"Number of mobile phones per 1,000 population",value:4,natural_value:1410},{category:"Wealth",indicator:"Decile income coefficient",value:4,natural_value:9.935483870967742},{category:"Wealth",indicator:"Decile income coefficient (change in last 3 years)",value:3,natural_value:-.02237297581008335},{category:"Wealth",indicator:"Poverty headcount ratio at national poverty lines",value:3,natural_value:.143},{category:"Wealth",indicator:"Working poverty rate (percentage of employed living below US$1.90 PPP), 15+ age (%) ",value:5,natural_value:.004},{category:"Wealth",indicator:"Poverty headcount ratio at $2.15 PPP 2017 a day",value:5,natural_value:.04},{category:"Wealth",indicator:"Living spaces per capita, sq m (change in last 3 years)",value:3,natural_value:.033},{category:"Wealth",indicator:"Population living in slums (% of urban population)",value:1,natural_value:.5},{category:"Wealth",indicator:"Availability of finance (consumer loans)",value:3,natural_value:.43},{category:"Wealth",indicator:"Perception of wealth & poverty index",value:3,natural_value:1.7},{category:"Safety",indicator:"Road fatalities rate per 100,000 population",value:3,natural_value:11.340252707581227},{category:"Safety",indicator:"Road fatalities rate per 100,000 population (change in last 3 years)",value:3,natural_value:-.04507057046287022},{category:"Safety",indicator:"Violent crime rate per 100,000 population",value:4,natural_value:3.43},{category:"Safety",indicator:"Violent crime rate per 100,000 population (change in last 3 years)",value:1,natural_value:.14919896707064462},{category:"Safety",indicator:"Crime rate per 100,000 population",value:5,natural_value:3.43},{category:"Safety",indicator:"Crime rate per 100,000 population  (change in last 3 years)",value:3,natural_value:-.03},{category:"Safety",indicator:"Police arrival speed",value:3,natural_value:21.7},{category:"Safety",indicator:"Perception of safety index",value:3,natural_value:2.79},{category:"Livability",indicator:"Number of LEED certified green buildings",value:3,natural_value:.08486437677053825},{category:"Livability",indicator:"Number of CEEQUAL certified projects",value:1,natural_value:0},{category:"Livability",indicator:"Mobile connection coverage",value:2,natural_value:.87},{category:"Livability",indicator:"Internet coverage",value:2,natural_value:.75},{category:"Livability",indicator:"Perception of livability index",value:3,natural_value:1.5},{category:"Livability",indicator:"Share of population in 1 km from hospitals",value:3,natural_value:54.9},{category:"Livability",indicator:"Share of population in 1 km from parks",value:3,natural_value:64.3},{category:"Transport",indicator:"Time loss in traffic",value:2,natural_value:.2235},{category:"Transport",indicator:"Share of the population in 1 km from public transport stop",value:3,natural_value:44.1},{category:"Transport",indicator:"Ratio of the cost of monthly public transport usage Ithe cheapest option) to average mobthly income",value:3,natural_value:.04},{category:"Transport",indicator:"Ratio of the cost of a 1-kilometer taxi ride to average mobthly income",value:3,natural_value:.04},{category:"Transport",indicator:"Percentage of city's roads that are segregated and/or has specialized lane for cyclists",value:3,natural_value:.06},{category:"Transport",indicator:"Number of public electric vehicle (EV) charging points per 100,000 population",value:3,natural_value:1.4},{category:"Transport",indicator:"Public transport (excluding subway) operates by schedule ",value:5,natural_value:"yes"},{category:"Transport",indicator:"Perception of transport index",value:3,natural_value:1.5},{category:"Inclusion",indicator:"Female-friendly city",value:1,natural_value:4},{category:"Inclusion",indicator:"Number of refugees per 1,000 population",value:3,natural_value:1.227346570397112},{category:"Inclusion",indicator:"Homeless people per 1,000 population",value:3,natural_value:7.7},{category:"Inclusion",indicator:"Difference in number of years of schooling between woman and man, woman to man ratio ",value:3,natural_value:1.03},{category:"Inclusion",indicator:"Slavery index",value:1,natural_value:56},{category:"Inclusion",indicator:"Percentage of women aged 25-34 years old that have successfully completed secondary education",value:3,natural_value:.302},{category:"Inclusion",indicator:"Regulations for building construction and equipment, public transport for people with disabilities",value:5,natural_value:"yes"},{category:"Inclusion",indicator:"Perception of inclusion index",value:3,natural_value:2.3},{category:"Accountability",indicator:"City budget execution publication",value:1,natural_value:"no"},{category:"Accountability",indicator:"City budget publication",value:1,natural_value:"no"},{category:"Accountability",indicator:"Financial transparency on city government companies",value:1,natural_value:"no"},{category:"Accountability",indicator:"ISO certification",value:1,natural_value:"no"},{category:"Accountability",indicator:"City council checks and balances",value:5,natural_value:"yes"},{category:"Accountability",indicator:"Plans to obtain ISO certification",value:1,natural_value:"no"},{category:"Accountability",indicator:"Perception of accountability index",value:3,natural_value:.9},{category:"City budget",indicator:"Poor financial condition",value:1,natural_value:"yes"},{category:"City budget",indicator:"Central/higher level government financial intervention taking place",value:1,natural_value:"yes"},{category:"City budget",indicator:"Long-term financial planning",value:1,natural_value:"no"},{category:"City budget",indicator:"Central/higher level government financial intervention is considered",value:5,natural_value:"yes"},{category:"City budget",indicator:"Prudent fiscal policy requirements",value:5,natural_value:"yes"},{category:"City budget",indicator:"Medium-term planning",value:1,natural_value:"no"},{category:"SME",indicator:"Number of SMEs per 100,000 population",value:3,natural_value:4589.350180505415},{category:"SME",indicator:"Number of start-ups",value:2,natural_value:105},{category:"SME",indicator:"Global Startup Ecosystem Index",value:2,natural_value:1.144},{category:"SME",indicator:"Number of SMEs per capita/100 000 population (change in last 3 years)",value:3,natural_value:-7e-4},{category:"SME",indicator:"Number of start-ups (change in last 3 years)",value:3,natural_value:.125},{category:"Public services",indicator:"Free phone to call the police, ambulance, firefighters",value:5,natural_value:"yes"},{category:"Public services",indicator:"Services for working with citizens' appeals and complaint",value:5,natural_value:"yes"},{category:"Public services",indicator:"E-gov services",value:5,natural_value:"yes"},{category:"Public services",indicator:"Perception of public services index: Public Services",value:3,natural_value:1.77},{category:"Sustainability commitment",indicator:"City ESG reporting",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"City ESG reporting verification",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"ESG planning",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"Plan with specific targets to develop and implement smart city principles",value:5,natural_value:"yes"},{category:"Sustainability commitment",indicator:"Rollout and status of ESG / UN SDG training across the municipal/asset workforce",value:1,natural_value:"no"},{category:"Sustainability commitment",indicator:"City municipality involved in network or partnership promoting sustainable development (for example, C40 Cities network)",value:5,natural_value:"yes"}]}],JIe=n=>{const e=n.split(" "),i=[];let o="";for(let s=0;s<e.length;s++)o.length+e[s].length<30?o+=e[s]+" ":(i.push(o),o=e[s]+" ");return i.push(o),i},ej=(n,e)=>KIe.find(i=>i.city===n).data.filter(i=>i.category===e).map(({category:i,indicator:o,value:s})=>({category:i,indicator:o,value:s})),kb=["#2D67FF","#00BCF8","#00DDD0","#8490FF","#AD00FF","#FF7AE2"],QIe=({city:n,category:e})=>{C_();const i=fM.filter(_=>n!==_),[o,s]=ie.useState(i.slice(0,5)),l=ej(n,e),d=o.map(_=>ej(_,e)),p={labels:l.map(_=>JIe(_.indicator)),datasets:[l,...d].map((_,x)=>({label:x?o[x-1]:n,backgroundColor:"transparent",borderWidth:x===0?8:1,borderColor:kb[x],pointBackgroundColor:kb[x],pointBorderColor:kb[x],pointHoverBackgroundColor:"#fff",pointHoverBorderColor:"rgba(34, 202, 236, 1)",pointRadius:5,data:_.map(S=>S.value)}))},f=(_,x)=>{s(S=>{const T=[...S];return T[x-1]=_,T})};return $e(_s,{children:[X(DIe,{style:{position:"absolute",top:"50%",right:"4vh",transform:"translateY(-50%)",boxSizing:"border-box",display:"block",height:805,width:1e3},data:p,options:{responsive:!0,plugins:{tooltip:{enabled:!0},legend:{display:!1}},scales:{r:{ticks:{stepSize:1},angleLines:{display:!1},pointLabels:{font:{size:11}},suggestedMin:0}}}}),$e("div",{style:{boxSizing:"border-box",position:"absolute",left:"8vh",top:"50vh"},children:[X(QH,{label:n,color:kb[0],position:0}),o.map((_,x)=>X(QH,{label:_,color:kb[x+1],cities:i,position:x+1,onClick:f},_))]})]})},eLe=n=>{const e=document.createElement("canvas"),i=e.getContext("2d"),o=e.width/2,s=e.height/2,l=15,d=23;return i.beginPath(),i.arc(o,s,l,0,2*Math.PI,!1),i.fillStyle=n,i.fill(),i.beginPath(),i.arc(o,s,d,0,2*Math.PI,!1),i.lineWidth=1,i.strokeStyle=n,i.stroke(),e},tj=(n,e,i)=>({city:n.city,...n.data.find(o=>o.category===e&&o.indicator===i)}),tLe=(n,e)=>{const i=[n,...e],o=Math.min(...i.map(l=>l.natural_value)),s=i.map(l=>l.city);return{responsive:!0,elements:{line:{},point:{radius:23,hoverRadius:23}},scales:{x:{type:"category",labels:s,offset:!0,grid:{display:!1},border:{color:"rgb(255, 255, 255)"},ticks:{display:!1}},y:{suggestedMin:o>=0?0:o,ticks:{color:"rgba(255, 255, 255, 0.3)",font:{size:20},padding:10,maxTicksLimit:10},grid:{color:"rgba(255, 255, 255, 0.15)"},border:{display:!1}}},plugins:{legend:{display:!1},tooltip:{enabled:!1}}}},nLe=(n,e)=>(i,o)=>{const s=[i,...o],l=d=>e[d-1];return{xLabels:s.map(d=>d.city),yLabels:n,datasets:s.map((d,p)=>({label:d.city,data:new Array(s.length).fill(null).map((f,y)=>p===y?d.natural_value:null),pointStyle:eLe(l(d.value)),showLine:!1}))}},iLe=({cities:n,value:e,onChange:i})=>{const[o,s]=ie.useState(null),l=!!o,d=f=>{s(f.currentTarget)},p=()=>{s(null)};return $e("div",{style:{width:220,marginTop:0},children:[X(xr,{onClick:d,endIcon:l?X(uO,{}):X(lO,{}),style:{textTransform:"none",color:"#fff",fontSize:"2.5vh",fontWeight:400},children:e}),X(w_,{anchorEl:o,open:l,onClose:p,children:n.map(f=>X(Fg,{selected:f===e,onClick:()=>{p(),i(f)},children:f},f))})]})},aLe=({currentCity:n,selectedCities:e,cities:i,onChange:o})=>$e("div",{style:{display:"flex",textAlign:"center",paddingLeft:93,paddingRight:10,justifyContent:"space-around"},children:[X("div",{style:{width:220,height:35,marginTop:0,display:"flex",justifyContent:"center",alignItems:"center"},children:X("span",{style:{color:"#fff",fontSize:"2.5vh",fontWeight:400,fontFamily:"'Roboto', 'Helvetica', 'Arial', sans-serif"},children:n})}),e.map((s,l)=>X(iLe,{cities:i.filter(d=>!e.includes(d)&&d!==n),value:s,onChange:o(l)},s))]}),rLe=(n,e,i)=>{const[o,s]=ie.useState(e.filter(d=>d!==n).map(d=>i.find(p=>p.city===d)).slice(0,5).sort((d,p)=>d.natural_value-p.natural_value));return[o,d=>p=>{const f=i.find(y=>y.city===p);s(o.map((y,_)=>_===d?f:y).toSorted((y,_)=>y.natural_value-_.natural_value))}]},Cx=[{city:"Dubai",data:[{category:"Air pollution",indicator:"CO2 emissions",unit:"kt",value:1,natural_value:20.3},{category:"Air pollution",indicator:"CO2 emissions (change in last 3 years)",unit:"%",value:2,natural_value:3.2},{category:"Air pollution",indicator:"CO2 concentration",unit:"ppm",value:2,natural_value:465},{category:"Air pollution",indicator:"CO2 concentration (change in last 3 years)",unit:"%",value:3,natural_value:1.8},{category:"Air pollution",indicator:"Annual average of SO2 concentration in ambient air",unit:"microgram/m3",value:3,natural_value:27.1},{category:"Air pollution",indicator:"Annual Average of SO2 Concentration in Ambient Air (change in last 3 years)",unit:"%",value:3,natural_value:17.7},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air",unit:"microgram/m3",value:1,natural_value:77.4},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air (change in last 3 years), microgram/m3",unit:"%",value:2,natural_value:1.4},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air, microgram/m3",unit:"microgram/m3",value:1,natural_value:132.1},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air (change in last 3 years), microgram/m3",unit:"%",value:3,natural_value:.2},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air, microgram/m3",unit:"microgram/m3",value:2,natural_value:.5},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air (change in last 3 years), microgram/m3",unit:"%",value:3,natural_value:1.9},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air, microgram/m3",unit:"microgram/m3",value:1,natural_value:128},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air (change in last 3 years), microgram/m3",unit:"%",value:1,natural_value:12.8},{category:"Air pollution",indicator:"Volatile organic compounds/reactive organic gases emissions",unit:"microgram/m3",value:1,natural_value:2.8},{category:"Air pollution",indicator:"Perception of air pollution index",unit:"index",value:4,natural_value:1.2},{category:"Air pollution",indicator:"Paris Agreement",unit:"Yes/No",value:5,natural_value:0},{category:"Water pollution",indicator:"Annual average of dissolved oxygen (DO) concentration in water",unit:"%",value:3,natural_value:6.401},{category:"Water pollution",indicator:"Annual average of pH concentration in water",unit:"pH",value:2,natural_value:7.876666666666666},{category:"Water pollution",indicator:"Annual average dissolved solids in drinking-water",unit:"ppm",value:5,natural_value:3.1},{category:"Water pollution",indicator:"Water management strategy in a city",unit:"Yes/No",value:5,natural_value:1},{category:"Water pollution",indicator:"Perception of water pollution index",unit:"index",value:4,natural_value:1.5},{category:"Land use and waste",indicator:"Share of devastated and degraded land area requiring reclamation",unit:"%",value:4,natural_value:3.1},{category:"Land use and waste",indicator:"3-year average growth rate of devastated and degraded land area requiring reclamation",unit:"%",value:5,natural_value:-.08},{category:"Land use and waste",indicator:"Waste deposits",unit:"%",value:5,natural_value:0},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous)",unit:"kg per capita ",value:2,natural_value:5945.914771596275},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous), (change in last 3 years)",unit:"%",value:2,natural_value:16.53405312},{category:"Land use and waste",indicator:"Total recycled construction waste",unit:"tons per capita",value:2,natural_value:.000173996963487571},{category:"Land use and waste",indicator:"Share of recycled construction and demolish waste in total generated construction and demolish waste",unit:"%",value:4,natural_value:.57866431255714},{category:"Land use and waste",indicator:"Total area of impervious surfaces and percentage to total city area",unit:"%",value:2,natural_value:.03},{category:"Land use and waste",indicator:"Productive urban land (in percent total land)",unit:"%",value:3,natural_value:32.2},{category:"Land use and waste",indicator:"Waste managenet strategy",unit:"Yes/No",value:5,natural_value:1},{category:"Land use and waste",indicator:"Perception of waste index",unit:"index",value:3,natural_value:2.155183475682713},{category:"Land use and waste",indicator:"Green spaces, % city area",unit:"%",value:2,natural_value:.0292},{category:"Land use and waste",indicator:"Green spaces, change in last 3 years",unit:"%",value:4,natural_value:1.6},{category:"Land use and waste",indicator:"NDVI",unit:"%",value:5,natural_value:.1},{category:"Natural disaster hazards",indicator:"Share of total area with altitude above sea level less than 0,5 meters",unit:"%",value:2,natural_value:.12},{category:"Natural disaster hazards",indicator:"Growth rate of freshwater mirror area",unit:"%",value:5,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of registered heavy rain, flood and thunderbolt (change in last 3 years)",unit:"%",value:4,natural_value:-.173191044314075},{category:"Natural disaster hazards",indicator:"Number of registered sand storm (change in last 3 years)",unit:"%",value:4,natural_value:-.170173466633757},{category:"Natural disaster hazards",indicator:"Environmental/natural disasters’ risk mitigation",unit:"Yes/No",value:5,natural_value:1},{category:"Natural disaster hazards",indicator:"Strategy/policy/government officials’ statement on environmental issues ",unit:"Yes/No",value:5,natural_value:1},{category:"Natural disaster hazards",indicator:"Total overall losses from natural disaster hazards",unit:"US$ mln ",value:3,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of days with average daily temperature above the threshold for 1990-2010",unit:"days",value:2,natural_value:73},{category:"Natural disaster hazards",indicator:"Number of disruptions to basic services, attributed to disasters",unit:"%",value:3,natural_value:0},{category:"Water availability",indicator:"Water consumption per capita",unit:"mcm",value:3,natural_value:.00016922114759669515},{category:"Water availability",indicator:"Water tariff to disposable income ratio",unit:"ratio",value:1,natural_value:4.033333333333333},{category:"Water availability",indicator:"Sanitary facilities tariff to disposable income ratio",unit:"ratio",value:4,natural_value:.5},{category:"Water availability",indicator:"Water consumption per capita (change in last 3 years)",unit:"%",value:3,natural_value:-.03},{category:"Water availability",indicator:"Percentage of population with access to drinking water",unit:"%",value:5,natural_value:.99},{category:"Water availability",indicator:"Percentage of population with access to drinking water (change in last 3 years)",unit:"%",value:4,natural_value:0},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities",unit:"%",value:5,natural_value:.99},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities (change in last 3 years)",unit:"%",value:4,natural_value:0},{category:"Food availability",indicator:"Cereal import dependency ratio (5-years average)",unit:"%",value:1,natural_value:.969},{category:"Food availability",indicator:"Cereal import dependency ratio (change in last 3 years)",unit:"%",value:3,natural_value:.02451091909},{category:"Food availability",indicator:"Prevalence of undernourishment",unit:"%",value:5,natural_value:.025},{category:"Food availability",indicator:"Prevalence of undernourishment (change in last 3 years)",unit:"%",value:5,natural_value:-.0333584789974298},{category:"Food availability",indicator:"Prevalence of undernourishment children",unit:"%",value:1,natural_value:1.3},{category:"Food availability",indicator:"Prevalence of undernourishment children (change in last 3 years)",unit:"%",value:4,natural_value:0},{category:"Food availability",indicator:"Prevalence of moderate or severe food insecurity in the population",unit:"%",value:4,natural_value:.075},{category:"Food availability",indicator:"Share of imports in food resources",unit:"%",value:3,natural_value:.431},{category:"Food availability",indicator:"Percentage of people with access to at least one food vendor/retailer within 15 minutes of walking",unit:"%",value:3,natural_value:91},{category:"Food availability",indicator:"Perception of food availability index",unit:"index",value:4,natural_value:2.4758589112947105},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity",unit:"%",value:5,natural_value:1},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity (change in last 3 years)",unit:"%",value:3,natural_value:0},{category:"Energy availability",indicator:"Consumption of electricity per capita",unit:"kWh/person",value:2,natural_value:13484.260097442204},{category:"Energy availability",indicator:"Consumption of electricity per capita (change in last 3 years)",unit:"%",value:4,natural_value:-.0328884973674617},{category:"Energy availability",indicator:"Electricity tariff to disposable income ratio",unit:"ratio",value:2,natural_value:.3025},{category:"Energy availability",indicator:"Share of renewable sources in electricity consumption",unit:"%",value:3,natural_value:.211},{category:"Energy availability",indicator:"Perception of energy availability index",unit:"index",value:4,natural_value:.8121750320262275},{category:"Health",indicator:"Child mortality rate (under 5 years-old)",unit:"% of live births ",value:5,natural_value:.047},{category:"Health",indicator:"City ambulance",unit:"Yes/No",value:5,natural_value:1},{category:"Health",indicator:"Life expectancy at birth, years",unit:"Years",value:5,natural_value:79.12733333333334},{category:"Health",indicator:"Life expectancy at birth goals",unit:"categories",value:2,natural_value:1},{category:"Health",indicator:"Number of hospital beds per 1,000 population",unit:"per 1,000",value:3,natural_value:1.7038581393098866},{category:"Health",indicator:"Number of doctors per 1,000 population",unit:"per 1,000",value:3,natural_value:3.1534720263756366},{category:"Health",indicator:"Maternal mortality ratio",unit:"deaths per 1,000 live births",value:5,natural_value:1.3},{category:"Health",indicator:"Ambulance arrival speed, min",unit:"min",value:5,natural_value:7},{category:"Education",indicator:"Literacy rate among population (15-24 Years)",unit:"%",value:3,natural_value:.969935633333333},{category:"Education",indicator:"Literacy rate among population (15-24 Years) (change in last 3 years)",unit:"%",value:5,natural_value:.0160766595564663},{category:"Education",indicator:"Primary education engagement",unit:"%",value:5,natural_value:.996036433333333},{category:"Education",indicator:"Pupils per teacher rate",unit:"ratio",value:4,natural_value:10.305960905809698},{category:"Education",indicator:"Proportion of population with post-secondary and higher education",unit:"%",value:5,natural_value:.5491613261},{category:"Wealth",indicator:"Percentage of population with food expenditure is above 52% of total expenditure",unit:"%",value:5,natural_value:.023},{category:"Wealth",indicator:"Mean monthly salary",unit:"US dollars thousand",value:5,natural_value:7854.14666666667},{category:"Wealth",indicator:"Mean monthly salary, change in last 3 years",unit:"%",value:3,natural_value:706225149202933e-19},{category:"Wealth",indicator:"Disposable monthly income",unit:"US dollars thousand",value:5,natural_value:2355.1463883362276},{category:"Wealth",indicator:"Disposable monthly income (change in last 3 years)",unit:"%",value:4,natural_value:.0584373085440772},{category:"Wealth",indicator:"Debt to salary ratio",unit:"ratio",value:5,natural_value:.92},{category:"Wealth",indicator:"Number of mobile phones per 1,000 population",unit:"per 1,000",value:5,natural_value:113.16800083893004},{category:"Wealth",indicator:"Decile income coefficient",unit:"ratio",value:5,natural_value:5.9021739130434785},{category:"Wealth",indicator:"Decile income coefficient (change in last 3 years)",unit:"%",value:5,natural_value:-.481645306006547},{category:"Wealth",indicator:"Poverty headcount ratio at national poverty lines",unit:"%",value:5,natural_value:.0533333333333333},{category:"Wealth",indicator:"Working poverty rate (percentage of employed living below US$1.90 PPP), 15+ age (%) ",unit:"%",value:5,natural_value:.001},{category:"Wealth",indicator:"Poverty headcount ratio at $2.15 PPP 2017 a day",unit:"%",value:5,natural_value:.00133333333333333},{category:"Wealth",indicator:"Living spaces per capita, sq m (change in last 3 years)",unit:"%",value:1,natural_value:.00224274214415088},{category:"Wealth",indicator:"Population living in slums (% of urban population)",unit:"%",value:5,natural_value:.041},{category:"Wealth",indicator:"Availability of finance (consumer loans)",unit:"%",value:3,natural_value:.5},{category:"Wealth",indicator:"Perception of wealth & poverty index",unit:"index",value:2,natural_value:2.1140395253368003},{category:"Safety",indicator:"Road fatalities rate per 100,000 population",unit:"per 100,000",value:5,natural_value:3.3516579451976907},{category:"Safety",indicator:"Road fatalities rate per 100,000 population (change in last 3 years)",unit:"%",value:3,natural_value:-.0617566486884363},{category:"Safety",indicator:"Violent crime rate per 100,000 population",unit:"per 100,000",value:5,natural_value:.26666666666666666},{category:"Safety",indicator:"Violent crime rate per 100,000 population (change in last 3 years)",unit:"%",value:3,natural_value:0},{category:"Safety",indicator:"Crime rate per 100,000 population",unit:"per 100,000",value:4,natural_value:31.433333333333334},{category:"Safety",indicator:"Crime rate per 100,000 population  (change in last 3 years)",unit:"%",value:3,natural_value:-.03},{category:"Safety",indicator:"Police arrival speed",unit:"min",value:5,natural_value:2.34},{category:"Safety",indicator:"Perception of safety index",unit:"index",value:2,natural_value:3.295},{category:"Livability",indicator:"Number of LEED certified green buildings",unit:"Certified square meters per capita",value:3,natural_value:1.378},{category:"Livability",indicator:"Number of BREEAM certified projects",unit:"Certified square meters per capita",value:5,natural_value:8},{category:"Livability",indicator:"Whether or not the city has ISO 37120 certification",unit:"Yes/No",value:5,natural_value:1},{category:"Livability",indicator:"Mobile connection coverage",unit:"%",value:5,natural_value:1},{category:"Livability",indicator:"Internet coverage",unit:"%",value:5,natural_value:1},{category:"Livability",indicator:"Perception of livability index",unit:"index",value:3,natural_value:1.082731807619587},{category:"Livability",indicator:"Share of population in 1 km from schools",unit:"%",value:3,natural_value:36.9},{category:"Livability",indicator:"Share of population in 1 km from parks",unit:"%",value:5,natural_value:51.5},{category:"Transport",indicator:"Time loss in traffic",unit:"%",value:4,natural_value:12.9},{category:"Transport",indicator:"Share of the population in 1 km from public transport stop",unit:"%",value:4,natural_value:41.8},{category:"Transport",indicator:"Ratio of the cost of monthly public transport usage Ithe cheapest option) to average mobthly income",unit:"ratio",value:4,natural_value:.01},{category:"Transport",indicator:"Ratio of the cost of a 1-kilometer taxi ride to average mobthly income",unit:"%",value:2,natural_value:.08},{category:"Transport",indicator:"Percentage of city's roads that are segregated and/or has specialized lane for cyclists",unit:"%",value:3,natural_value:.06},{category:"Transport",indicator:"Number of public electric vehicle (EV) charging points per 100,000 population",unit:"per 100,000",value:3,natural_value:1.4},{category:"Transport",indicator:"Public transport (excluding subway) operates by schedule ",unit:"Yes/No",value:5,natural_value:1},{category:"Transport",indicator:"Perception of transport index",unit:"index",value:4,natural_value:1.082731807619587},{category:"Inclusion",indicator:"Female-friendly city",unit:"1,2,3,4,5",value:2,natural_value:3},{category:"Inclusion",indicator:"Number of refugees per 1,000 population",unit:"per 1,000",value:4,natural_value:.3817158061663018},{category:"Inclusion",indicator:"Homeless people per 1,000 population",unit:"per 1,000",value:3,natural_value:1.8687289767990112},{category:"Inclusion",indicator:"Difference in number of years of schooling between woman and man, woman to man ratio ",unit:"years",value:3,natural_value:.9666666666666667},{category:"Inclusion",indicator:"Slavery index",unit:"index",value:3,natural_value:13.4},{category:"Inclusion",indicator:"Percentage of women aged 25-34 years old that have successfully completed secondary education",unit:"%",value:4,natural_value:.5670000000000001},{category:"Inclusion",indicator:"Regulations for building construction and equipment, public transport for people with disabilities",unit:"Yes/No",value:1,natural_value:0},{category:"Inclusion",indicator:"Perception of inclusion index",unit:"index",value:2,natural_value:3.237203544701542},{category:"Accountability",indicator:"City budget execution publication",unit:"Yes/No",value:5,natural_value:1},{category:"Accountability",indicator:"City budget publication",unit:"Yes/No",value:5,natural_value:1},{category:"Accountability",indicator:"Financial transparency on city government companies",unit:"Yes/No",value:1,natural_value:0},{category:"Accountability",indicator:"ISO certification",unit:"Yes/No",value:5,natural_value:1},{category:"Accountability",indicator:"City council checks and balances",unit:"Yes/No",value:5,natural_value:1},{category:"Accountability",indicator:"Plans to obtain ISO certification",unit:"Yes/No",value:5,natural_value:1},{category:"Accountability",indicator:"Perception of accountability index",unit:"index",value:2,natural_value:1.1200372913104772},{category:"City budget",indicator:"Poor financial condition",unit:"Yes/No",value:5,natural_value:0},{category:"City budget",indicator:"Central/higher level government financial intervention taking place",unit:"Yes/No",value:5,natural_value:0},{category:"City budget",indicator:"Long-term financial planning",unit:"Yes/No",value:1,natural_value:0},{category:"City budget",indicator:"Central/higher level government financial intervention is considered",unit:"Yes/No",value:1,natural_value:0},{category:"City budget",indicator:"Prudent fiscal policy requirements",unit:"Yes/No",value:1,natural_value:0},{category:"City budget",indicator:"Medium-term planning",unit:"Yes/No",value:5,natural_value:1},{category:"SME",indicator:"Number of SMEs per 100,000 population",unit:"per 100,000",value:3,natural_value:5235.1},{category:"SME",indicator:"Number of start-ups",unit:"start-ups",value:4,natural_value:3802},{category:"SME",indicator:"Global Startup Ecosystem Index",unit:"index",value:4,natural_value:11.527},{category:"SME",indicator:"Number of SMEs per capita/100 000 population (change in last 3 years)",unit:"%",value:2,natural_value:-.127},{category:"SME",indicator:"Number of start-ups (change in last 3 years)",unit:"%",value:4,natural_value:.179},{category:"Public services",indicator:"Free phone to call the police, ambulance, firefighters",unit:"1,2,3,4,5",value:5,natural_value:1},{category:"Public services",indicator:"Services for working with citizens' appeals and complaint",unit:"Yes/No",value:5,natural_value:1},{category:"Public services",indicator:"E-gov services",unit:"Yes/No",value:5,natural_value:1},{category:"Public services",indicator:"Perception of public services index: Public Services",unit:"index",value:5,natural_value:.709659690294386},{category:"Sustainability commitment",indicator:"City ESG reporting",unit:"Yes/No",value:5,natural_value:1},{category:"Sustainability commitment",indicator:"City ESG reporting verification",unit:"Yes/No",value:1,natural_value:0},{category:"Sustainability commitment",indicator:"ESG planning",unit:"Yes/No",value:5,natural_value:1},{category:"Sustainability commitment",indicator:"Plan with specific targets to develop and implement smart city principles",unit:"Yes/No",value:5,natural_value:1},{category:"Sustainability commitment",indicator:"Rollout and status of ESG / UN SDG training across the municipal/asset workforce",unit:"Yes/No",value:5,natural_value:1},{category:"Sustainability commitment",indicator:"City municipality involved in network or partnership promoting sustainable development (for example, C40 Cities network)",unit:"Yes/No",value:5,natural_value:1}]},{city:"Expo City Dubai",data:[{category:"Air pollution",indicator:"CO2 emissions",unit:"kt",value:1,natural_value:20.3},{category:"Air pollution",indicator:"CO2 emissions (change in last 3 years)",unit:"%",value:5,natural_value:-1.5},{category:"Air pollution",indicator:"CO2 concentration",unit:"ppm",value:2,natural_value:468.5},{category:"Air pollution",indicator:"CO2 concentration (change in last 3 years)",unit:"%",value:1,natural_value:15.5},{category:"Air pollution",indicator:"Annual average of SO2 concentration in ambient air",unit:"microgram/m3",value:3,natural_value:28.1},{category:"Air pollution",indicator:"Annual Average of SO2 Concentration in Ambient Air (change in last 3 years)",unit:"%",value:3,natural_value:1.2},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air",unit:"microgram/m3",value:1,natural_value:81},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air (change in last 3 years), microgram/m3",unit:"%",value:2,natural_value:1.2},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air, microgram/m3",unit:"microgram/m3",value:1,natural_value:133.8},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air (change in last 3 years), microgram/m3",unit:"%",value:3,natural_value:.1},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air, microgram/m3",unit:"microgram/m3",value:2,natural_value:.5},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air (change in last 3 years), microgram/m3",unit:"%",value:3,natural_value:1.5},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air, microgram/m3",unit:"microgram/m3",value:1,natural_value:131.7},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air (change in last 3 years), microgram/m3",unit:"%",value:1,natural_value:12.4},{category:"Air pollution",indicator:"Volatile organic compounds/reactive organic gases emissions",unit:"microgram/m3",value:1,natural_value:2.8},{category:"Air pollution",indicator:"Perception of air pollution index",unit:"index",value:2,natural_value:2.08},{category:"Air pollution",indicator:"Paris Agreement",unit:"Yes/No",value:5,natural_value:1},{category:"Water pollution",indicator:"Annual average of dissolved oxygen (DO) concentration in water",unit:"%",value:3,natural_value:6.507},{category:"Water pollution",indicator:"Annual average of pH concentration in water",unit:"pH",value:2,natural_value:7.876666666666666},{category:"Water pollution",indicator:"Annual average dissolved solids in drinking-water",unit:"ppm",value:5,natural_value:3.1},{category:"Water pollution",indicator:"Water management strategy in a city",unit:"Yes/No",value:5,natural_value:1},{category:"Water pollution",indicator:"Perception of water pollution index",unit:"index",value:2,natural_value:2.3439938519744623},{category:"Land use and waste",indicator:"Share of devastated and degraded land area requiring reclamation",unit:"%",value:4,natural_value:3.1},{category:"Land use and waste",indicator:"3-year average growth rate of devastated and degraded land area requiring reclamation",unit:"%",value:5,natural_value:-.072},{category:"Land use and waste",indicator:"Waste deposits",unit:"%",value:5,natural_value:1e-4},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous)",unit:"kg per capita ",value:5,natural_value:40.3809523809524},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous), (change in last 3 years)",unit:"%",value:2,natural_value:24.28930024},{category:"Land use and waste",indicator:"Total recycled construction waste",unit:"tons per capita",value:4,natural_value:15.171599047619047},{category:"Land use and waste",indicator:"Share of recycled construction and demolish waste in total generated construction and demolish waste",unit:"%",value:4,natural_value:.760247651924017},{category:"Land use and waste",indicator:"Total area of impervious surfaces and percentage to total city area",unit:"%",value:2,natural_value:.03},{category:"Land use and waste",indicator:"Productive urban land (in percent total land)",unit:"%",value:3,natural_value:32.2},{category:"Land use and waste",indicator:"Waste managenet strategy",unit:"Yes/No",value:5,natural_value:1},{category:"Land use and waste",indicator:"Perception of waste index",unit:"index",value:2,natural_value:3.4442358641257407},{category:"Land use and waste",indicator:"Green spaces, % city area",unit:"%",value:2,natural_value:.0241},{category:"Land use and waste",indicator:"Green spaces, change in last 3 years",unit:"%",value:3,natural_value:0},{category:"Land use and waste",indicator:"NDVI",unit:"%",value:5,natural_value:.1},{category:"Natural disaster hazards",indicator:"Share of total area with altitude above sea level less than 0,5 meters",unit:"%",value:2,natural_value:.12},{category:"Natural disaster hazards",indicator:"Growth rate of freshwater mirror area",unit:"%",value:5,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of registered heavy rain, flood and thunderbolt (change in last 3 years)",unit:"%",value:4,natural_value:-.173191044314075},{category:"Natural disaster hazards",indicator:"Number of registered sand storm (change in last 3 years)",unit:"%",value:4,natural_value:-.170173466633757},{category:"Natural disaster hazards",indicator:"Environmental/natural disasters’ risk mitigation",unit:"Yes/No",value:5,natural_value:1},{category:"Natural disaster hazards",indicator:"Strategy/policy/government officials’ statement on environmental issues ",unit:"Yes/No",value:5,natural_value:1},{category:"Natural disaster hazards",indicator:"Total overall losses from natural disaster hazards",unit:"US$ mln ",value:3,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of days with average daily temperature above the threshold for 1990-2010",unit:"days",value:2,natural_value:73},{category:"Natural disaster hazards",indicator:"Number of disruptions to basic services, attributed to disasters",unit:"%",value:3,natural_value:0},{category:"Water availability",indicator:"Water consumption per capita",unit:"mcm",value:3,natural_value:20665380952380953e-23},{category:"Water availability",indicator:"Water tariff to disposable income ratio",unit:"ratio",value:1,natural_value:4.033333333333333},{category:"Water availability",indicator:"Sanitary facilities tariff to disposable income ratio",unit:"ratio",value:4,natural_value:.5},{category:"Water availability",indicator:"Water consumption per capita (change in last 3 years)",unit:"%",value:2,natural_value:-.207},{category:"Water availability",indicator:"Percentage of population with access to drinking water",unit:"%",value:5,natural_value:.99},{category:"Water availability",indicator:"Percentage of population with access to drinking water (change in last 3 years)",unit:"%",value:4,natural_value:0},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities",unit:"%",value:3,natural_value:.99},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities (change in last 3 years)",unit:"%",value:2,natural_value:0},{category:"Food availability",indicator:"Cereal import dependency ratio (5-years average)",unit:"%",value:1,natural_value:.969},{category:"Food availability",indicator:"Cereal import dependency ratio (change in last 3 years)",unit:"%",value:3,natural_value:.02451091909},{category:"Food availability",indicator:"Prevalence of undernourishment",unit:"%",value:5,natural_value:.025},{category:"Food availability",indicator:"Prevalence of undernourishment (change in last 3 years)",unit:"%",value:5,natural_value:-.0333584789974298},{category:"Food availability",indicator:"Prevalence of undernourishment children",unit:"%",value:1,natural_value:1.3},{category:"Food availability",indicator:"Prevalence of undernourishment children (change in last 3 years)",unit:"%",value:4,natural_value:0},{category:"Food availability",indicator:"Prevalence of moderate or severe food insecurity in the population",unit:"%",value:4,natural_value:.075},{category:"Food availability",indicator:"Share of imports in food resources",unit:"%",value:3,natural_value:.431},{category:"Food availability",indicator:"Percentage of people with access to at least one food vendor/retailer within 15 minutes of walking",unit:"%",value:3,natural_value:91},{category:"Food availability",indicator:"Perception of food availability index",unit:"index",value:1,natural_value:1.6876755734216127},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity",unit:"%",value:5,natural_value:1},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity (change in last 3 years)",unit:"%",value:3,natural_value:0},{category:"Energy availability",indicator:"Consumption of electricity per capita",unit:"kWh/person",value:1,natural_value:21791.14485714286},{category:"Energy availability",indicator:"Consumption of electricity per capita (change in last 3 years)",unit:"%",value:2,natural_value:.158604595786555},{category:"Energy availability",indicator:"Electricity tariff to disposable income ratio",unit:"ratio",value:2,natural_value:.3025},{category:"Energy availability",indicator:"Share of renewable sources in electricity consumption",unit:"%",value:3,natural_value:.211},{category:"Energy availability",indicator:"Perception of energy availability index",unit:"index",value:5,natural_value:.07780892454687012},{category:"Health",indicator:"Child mortality rate (under 5 years-old)",unit:"% of live births ",value:5,natural_value:.047},{category:"Health",indicator:"City ambulance",unit:"Yes/No",value:5,natural_value:1},{category:"Health",indicator:"Life expectancy at birth, years",unit:"Years",value:5,natural_value:79.12733333333334},{category:"Health",indicator:"Life expectancy at birth goals",unit:"categories",value:2,natural_value:1},{category:"Health",indicator:"Number of hospital beds per 1,000 population",unit:"per 1,000",value:3,natural_value:1.7038581393098866},{category:"Health",indicator:"Number of doctors per 1,000 population",unit:"per 1,000",value:3,natural_value:3.1534720263756366},{category:"Health",indicator:"Maternal mortality ratio",unit:"deaths per 1,000 live births",value:5,natural_value:1.3},{category:"Health",indicator:"Ambulance arrival speed, min",unit:"min",value:5,natural_value:7},{category:"Education",indicator:"Literacy rate among population (15-24 Years)",unit:"%",value:3,natural_value:.969935633333333},{category:"Education",indicator:"Literacy rate among population (15-24 Years) (change in last 3 years)",unit:"%",value:5,natural_value:.0160766595564663},{category:"Education",indicator:"Primary education engagement",unit:"%",value:5,natural_value:.996036433333333},{category:"Education",indicator:"Pupils per teacher rate",unit:"ratio",value:4,natural_value:10.305960905809698},{category:"Education",indicator:"Proportion of population with post-secondary and higher education",unit:"%",value:5,natural_value:.5491613261},{category:"Wealth",indicator:"Percentage of population with food expenditure is above 52% of total expenditure",unit:"%",value:5,natural_value:.001},{category:"Wealth",indicator:"Mean monthly salary",unit:"US dollars thousand",value:5,natural_value:7854.14666666667},{category:"Wealth",indicator:"Mean monthly salary, change in last 3 years",unit:"%",value:3,natural_value:706225149202933e-19},{category:"Wealth",indicator:"Disposable monthly income",unit:"US dollars thousand",value:5,natural_value:2355.1463883362276},{category:"Wealth",indicator:"Disposable monthly income (change in last 3 years)",unit:"%",value:4,natural_value:.0584373085440772},{category:"Wealth",indicator:"Debt to salary ratio",unit:"ratio",value:5,natural_value:.92},{category:"Wealth",indicator:"Number of mobile phones per 1,000 population",unit:"per 1,000",value:5,natural_value:113.16800083893004},{category:"Wealth",indicator:"Decile income coefficient",unit:"ratio",value:5,natural_value:5.9021739130434785},{category:"Wealth",indicator:"Decile income coefficient (change in last 3 years)",unit:"%",value:5,natural_value:-.481645306006547},{category:"Wealth",indicator:"Poverty headcount ratio at national poverty lines",unit:"%",value:5,natural_value:0},{category:"Wealth",indicator:"Working poverty rate (percentage of employed living below US$1.90 PPP), 15+ age (%) ",unit:"%",value:5,natural_value:.001},{category:"Wealth",indicator:"Poverty headcount ratio at $2.15 PPP 2017 a day",unit:"%",value:5,natural_value:.000666666666666667},{category:"Wealth",indicator:"Living spaces per capita, sq m (change in last 3 years)",unit:"%",value:1,natural_value:.00224274214415088},{category:"Wealth",indicator:"Population living in slums (% of urban population)",unit:"%",value:5,natural_value:.041},{category:"Wealth",indicator:"Availability of finance (consumer loans)",unit:"%",value:3,natural_value:.5},{category:"Wealth",indicator:"Perception of wealth & poverty index",unit:"index",value:2,natural_value:1.87519508157957},{category:"Safety",indicator:"Road fatalities rate per 100,000 population",unit:"per 100,000",value:5,natural_value:3.3516579451976907},{category:"Safety",indicator:"Road fatalities rate per 100,000 population (change in last 3 years)",unit:"%",value:3,natural_value:-.0617566486884363},{category:"Safety",indicator:"Violent crime rate per 100,000 population",unit:"per 100,000",value:5,natural_value:.26666666666666666},{category:"Safety",indicator:"Violent crime rate per 100,000 population (change in last 3 years)",unit:"%",value:3,natural_value:0},{category:"Safety",indicator:"Crime rate per 100,000 population",unit:"per 100,000",value:4,natural_value:31.433333333333334},{category:"Safety",indicator:"Crime rate per 100,000 population  (change in last 3 years)",unit:"%",value:4,natural_value:0},{category:"Safety",indicator:"Police arrival speed",unit:"min",value:5,natural_value:2.34},{category:"Safety",indicator:"Perception of safety index",unit:"index",value:4,natural_value:2.445},{category:"Livability",indicator:"Number of LEED certified green buildings",unit:"Certified square meters per capita",value:5,natural_value:126.95604827857144},{category:"Livability",indicator:"Number of BREEAM certified projects",unit:"Certified square meters per capita",value:5,natural_value:8},{category:"Livability",indicator:"Whether or not the city has ISO 37120 certification",unit:"Yes/No",value:5,natural_value:1},{category:"Livability",indicator:"Mobile connection coverage",unit:"%",value:5,natural_value:1},{category:"Livability",indicator:"Internet coverage",unit:"%",value:5,natural_value:1},{category:"Livability",indicator:"Perception of livability index",unit:"index",value:5,natural_value:.27468677952825726},{category:"Livability",indicator:"Share of population in 1 km from schools",unit:"%",value:3,natural_value:0},{category:"Livability",indicator:"Share of population in 1 km from parks",unit:"%",value:4,natural_value:78.4},{category:"Transport",indicator:"Time loss in traffic",unit:"%",value:5,natural_value:.5},{category:"Transport",indicator:"Share of the population in 1 km from public transport stop",unit:"%",value:4,natural_value:69.5},{category:"Transport",indicator:"Ratio of the cost of monthly public transport usage Ithe cheapest option) to average mobthly income",unit:"ratio",value:4,natural_value:.01},{category:"Transport",indicator:"Ratio of the cost of a 1-kilometer taxi ride to average mobthly income",unit:"%",value:2,natural_value:.08},{category:"Transport",indicator:"Percentage of city's roads that are segregated and/or has specialized lane for cyclists",unit:"%",value:3,natural_value:.06},{category:"Transport",indicator:"Number of public electric vehicle (EV) charging points per 100,000 population",unit:"per 100,000",value:3,natural_value:1.4},{category:"Transport",indicator:"Public transport (excluding subway) operates by schedule ",unit:"Yes/No",value:5,natural_value:1},{category:"Transport",indicator:"Perception of transport index",unit:"index",value:5,natural_value:.27468677952825726},{category:"Inclusion",indicator:"Female-friendly city",unit:"1,2,3,4,5",value:2,natural_value:3},{category:"Inclusion",indicator:"Number of refugees per 1,000 population",unit:"per 1,000",value:4,natural_value:.3817158061663018},{category:"Inclusion",indicator:"Homeless people per 1,000 population",unit:"per 1,000",value:3,natural_value:1.8687289767990112},{category:"Inclusion",indicator:"Difference in number of years of schooling between woman and man, woman to man ratio ",unit:"years",value:3,natural_value:.9666666666666667},{category:"Inclusion",indicator:"Slavery index",unit:"index",value:3,natural_value:13.4},{category:"Inclusion",indicator:"Percentage of women aged 25-34 years old that have successfully completed secondary education",unit:"%",value:4,natural_value:.5670000000000001},{category:"Inclusion",indicator:"Regulations for building construction and equipment, public transport for people with disabilities",unit:"Yes/No",value:1,natural_value:0},{category:"Inclusion",indicator:"Perception of inclusion index",unit:"index",value:2,natural_value:3.217790376675001},{category:"Accountability",indicator:"City budget execution publication",unit:"Yes/No",value:5,natural_value:1},{category:"Accountability",indicator:"City budget publication",unit:"Yes/No",value:1,natural_value:0},{category:"Accountability",indicator:"Financial transparency on city government companies",unit:"Yes/No",value:1,natural_value:0},{category:"Accountability",indicator:"ISO certification",unit:"Yes/No",value:5,natural_value:1},{category:"Accountability",indicator:"City council checks and balances",unit:"Yes/No",value:5,natural_value:1},{category:"Accountability",indicator:"Plans to obtain ISO certification",unit:"Yes/No",value:5,natural_value:1},{category:"Accountability",indicator:"Perception of accountability index",unit:"index",value:4,natural_value:.7813312839914873},{category:"City budget",indicator:"Poor financial condition",unit:"Yes/No",value:5,natural_value:0},{category:"City budget",indicator:"Central/higher level government financial intervention taking place",unit:"Yes/No",value:5,natural_value:0},{category:"City budget",indicator:"Long-term financial planning",unit:"Yes/No",value:1,natural_value:0},{category:"City budget",indicator:"Central/higher level government financial intervention is considered",unit:"Yes/No",value:1,natural_value:0},{category:"City budget",indicator:"Prudent fiscal policy requirements",unit:"Yes/No",value:1,natural_value:0},{category:"City budget",indicator:"Medium-term planning",unit:"Yes/No",value:5,natural_value:1},{category:"SME",indicator:"Number of SMEs per 100,000 population",unit:"per 100,000",value:5,natural_value:5235.1},{category:"SME",indicator:"Number of start-ups",unit:"start-ups",value:1,natural_value:3802},{category:"SME",indicator:"Global Startup Ecosystem Index",unit:"index",value:4,natural_value:11.527},{category:"SME",indicator:"Number of SMEs per capita/100 000 population (change in last 3 years)",unit:"%",value:2,natural_value:-.127},{category:"SME",indicator:"Number of start-ups (change in last 3 years)",unit:"%",value:4,natural_value:.179},{category:"Public services",indicator:"Free phone to call the police, ambulance, firefighters",unit:"1,2,3,4,5",value:5,natural_value:1},{category:"Public services",indicator:"Services for working with citizens' appeals and complaint",unit:"Yes/No",value:5,natural_value:1},{category:"Public services",indicator:"E-gov services",unit:"Yes/No",value:5,natural_value:1},{category:"Public services",indicator:"Perception of public services index: Public Services",unit:"index",value:5,natural_value:.6250650271931899},{category:"Sustainability commitment",indicator:"City ESG reporting",unit:"Yes/No",value:5,natural_value:1},{category:"Sustainability commitment",indicator:"City ESG reporting verification",unit:"Yes/No",value:5,natural_value:1},{category:"Sustainability commitment",indicator:"ESG planning",unit:"Yes/No",value:5,natural_value:1},{category:"Sustainability commitment",indicator:"Plan with specific targets to develop and implement smart city principles",unit:"Yes/No",value:5,natural_value:1},{category:"Sustainability commitment",indicator:"Rollout and status of ESG / UN SDG training across the municipal/asset workforce",unit:"Yes/No",value:5,natural_value:1},{category:"Sustainability commitment",indicator:"City municipality involved in network or partnership promoting sustainable development (for example, C40 Cities network)",unit:"Yes/No",value:5,natural_value:1}]},{city:"Valparaiso",data:[{category:"Air pollution",indicator:"CO2 emissions",unit:"kt",value:3,natural_value:4.4},{category:"Air pollution",indicator:"CO2 emissions (change in last 3 years)",unit:"%",value:3,natural_value:1.6},{category:"Air pollution",indicator:"CO2 concentration",unit:"ppm",value:4,natural_value:417.7},{category:"Air pollution",indicator:"CO2 concentration (change in last 3 years)",unit:"%",value:3,natural_value:1.7},{category:"Air pollution",indicator:"Annual average of SO2 concentration in ambient air",unit:"microgram/m3",value:3,natural_value:52.1},{category:"Air pollution",indicator:"Annual Average of SO2 Concentration in Ambient Air (change in last 3 years)",unit:"%",value:1,natural_value:369.9},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air",unit:"microgram/m3",value:1,natural_value:26.9},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air (change in last 3 years), microgram/m3",unit:"%",value:1,natural_value:1.6},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air, microgram/m3",unit:"microgram/m3",value:3,natural_value:53.8},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air (change in last 3 years), microgram/m3",unit:"%",value:4,natural_value:-4.5},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air, microgram/m3",unit:"microgram/m3",value:1,natural_value:.9},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air (change in last 3 years), microgram/m3",unit:"%",value:1,natural_value:17},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air, microgram/m3",unit:"microgram/m3",value:2,natural_value:90.4},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air (change in last 3 years), microgram/m3",unit:"%",value:1,natural_value:17.3},{category:"Air pollution",indicator:"Volatile organic compounds/reactive organic gases emissions",unit:"microgram/m3",value:4,natural_value:1},{category:"Air pollution",indicator:"Perception of air pollution index",unit:"index",value:3,natural_value:1.53},{category:"Air pollution",indicator:"Paris Agreement",unit:"Yes/No",value:5,natural_value:1},{category:"Water pollution",indicator:"Annual average of dissolved oxygen (DO) concentration in water",unit:"%",value:3,natural_value:6.313333333333333},{category:"Water pollution",indicator:"Annual average of pH concentration in water",unit:"pH",value:2,natural_value:8.06},{category:"Water pollution",indicator:"Annual average dissolved solids in drinking-water",unit:"ppm",value:3,natural_value:139},{category:"Water pollution",indicator:"Water management strategy in a city",unit:"Yes/No",value:5,natural_value:1},{category:"Water pollution",indicator:"Perception of water pollution index",unit:"index",value:4,natural_value:1.0452113628976973},{category:"Land use and waste",indicator:"Share of devastated and degraded land area requiring reclamation",unit:"%",value:4,natural_value:4.5},{category:"Land use and waste",indicator:"3-year average growth rate of devastated and degraded land area requiring reclamation",unit:"%",value:1,natural_value:.112},{category:"Land use and waste",indicator:"Waste deposits",unit:"%",value:5,natural_value:16e-5},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous)",unit:"kg per capita ",value:5,natural_value:17.469310981854},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous), (change in last 3 years)",unit:"%",value:5,natural_value:-1.80539164},{category:"Land use and waste",indicator:"Total recycled construction waste",unit:"tons per capita",value:1,natural_value:.0010518},{category:"Land use and waste",indicator:"Share of recycled construction and demolish waste in total generated construction and demolish waste",unit:"%",value:2,natural_value:.084},{category:"Land use and waste",indicator:"Total area of impervious surfaces and percentage to total city area",unit:"%",value:3,natural_value:.015},{category:"Land use and waste",indicator:"Productive urban land (in percent total land)",unit:"%",value:3,natural_value:32.2},{category:"Land use and waste",indicator:"Waste managenet strategy",unit:"Yes/No",value:1,natural_value:0},{category:"Land use and waste",indicator:"Perception of waste index",unit:"index",value:2,natural_value:1.0917886963814378},{category:"Land use and waste",indicator:"Green spaces, % city area",unit:"%",value:3,natural_value:.3008},{category:"Land use and waste",indicator:"Green spaces, change in last 3 years",unit:"%",value:2,natural_value:-4},{category:"Land use and waste",indicator:"NDVI",unit:"%",value:4,natural_value:.22},{category:"Natural disaster hazards",indicator:"Share of total area with altitude above sea level less than 0,5 meters",unit:"%",value:1,natural_value:.16},{category:"Natural disaster hazards",indicator:"Growth rate of freshwater mirror area",unit:"%",value:5,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of registered heavy rain, flood and thunderbolt (change in last 3 years)",unit:"%",value:3,natural_value:-.0312706938485358},{category:"Natural disaster hazards",indicator:"Number of registered sand storm (change in last 3 years)",unit:"%",value:3,natural_value:0},{category:"Natural disaster hazards",indicator:"Environmental/natural disasters’ risk mitigation",unit:"Yes/No",value:5,natural_value:1},{category:"Natural disaster hazards",indicator:"Strategy/policy/government officials’ statement on environmental issues ",unit:"Yes/No",value:5,natural_value:1},{category:"Natural disaster hazards",indicator:"Total overall losses from natural disaster hazards",unit:"US$ mln ",value:3,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of days with average daily temperature above the threshold for 1990-2010",unit:"days",value:3,natural_value:15},{category:"Natural disaster hazards",indicator:"Number of disruptions to basic services, attributed to disasters",unit:"%",value:3,natural_value:0},{category:"Water availability",indicator:"Water consumption per capita",unit:"mcm",value:3,natural_value:.0003085905057588588},{category:"Water availability",indicator:"Water tariff to disposable income ratio",unit:"ratio",value:3,natural_value:1.3},{category:"Water availability",indicator:"Sanitary facilities tariff to disposable income ratio",unit:"ratio",value:2,natural_value:1.7},{category:"Water availability",indicator:"Water consumption per capita (change in last 3 years)",unit:"%",value:3,natural_value:0},{category:"Water availability",indicator:"Percentage of population with access to drinking water",unit:"%",value:2,natural_value:.988},{category:"Water availability",indicator:"Percentage of population with access to drinking water (change in last 3 years)",unit:"%",value:2,natural_value:0},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities",unit:"%",value:2,natural_value:.771666666666667},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities (change in last 3 years)",unit:"%",value:2,natural_value:.013},{category:"Food availability",indicator:"Cereal import dependency ratio (5-years average)",unit:"%",value:3,natural_value:.437333333333333},{category:"Food availability",indicator:"Cereal import dependency ratio (change in last 3 years)",unit:"%",value:3,natural_value:.04245544122},{category:"Food availability",indicator:"Prevalence of undernourishment",unit:"%",value:3,natural_value:.056},{category:"Food availability",indicator:"Prevalence of undernourishment (change in last 3 years)",unit:"%",value:3,natural_value:-.0125013105308766},{category:"Food availability",indicator:"Prevalence of undernourishment children",unit:"%",value:3,natural_value:.357},{category:"Food availability",indicator:"Prevalence of undernourishment children (change in last 3 years)",unit:"%",value:4,natural_value:0},{category:"Food availability",indicator:"Prevalence of moderate or severe food insecurity in the population",unit:"%",value:3,natural_value:.166666666666667},{category:"Food availability",indicator:"Share of imports in food resources",unit:"%",value:3,natural_value:.36},{category:"Food availability",indicator:"Percentage of people with access to at least one food vendor/retailer within 15 minutes of walking",unit:"%",value:3,natural_value:91},{category:"Food availability",indicator:"Perception of food availability index",unit:"index",value:2,natural_value:1.8640920844764555},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity",unit:"%",value:5,natural_value:1},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity (change in last 3 years)",unit:"%",value:3,natural_value:0},{category:"Energy availability",indicator:"Consumption of electricity per capita",unit:"kWh/person",value:3,natural_value:4079.2666666666664},{category:"Energy availability",indicator:"Consumption of electricity per capita (change in last 3 years)",unit:"%",value:3,natural_value:.00892969688080547},{category:"Energy availability",indicator:"Electricity tariff to disposable income ratio",unit:"ratio",value:5,natural_value:.002},{category:"Energy availability",indicator:"Share of renewable sources in electricity consumption",unit:"%",value:3,natural_value:.21},{category:"Energy availability",indicator:"Perception of energy availability index",unit:"index",value:4,natural_value:.6397959193215885},{category:"Health",indicator:"Child mortality rate (under 5 years-old)",unit:"% of live births ",value:3,natural_value:6.866666666666667},{category:"Health",indicator:"City ambulance",unit:"Yes/No",value:5,natural_value:1},{category:"Health",indicator:"Life expectancy at birth, years",unit:"Years",value:5,natural_value:79.94666666666666},{category:"Health",indicator:"Life expectancy at birth goals",unit:"categories",value:1,natural_value:1},{category:"Health",indicator:"Number of hospital beds per 1,000 population",unit:"per 1,000",value:3,natural_value:2.466666666666667},{category:"Health",indicator:"Number of doctors per 1,000 population",unit:"per 1,000",value:3,natural_value:6.6585},{category:"Health",indicator:"Maternal mortality ratio",unit:"deaths per 1,000 live births",value:3,natural_value:49},{category:"Health",indicator:"Ambulance arrival speed, min",unit:"min",value:3,natural_value:70},{category:"Education",indicator:"Literacy rate among population (15-24 Years)",unit:"%",value:4,natural_value:.991542002360026},{category:"Education",indicator:"Literacy rate among population (15-24 Years) (change in last 3 years)",unit:"%",value:2,natural_value:-.000852712549205825},{category:"Education",indicator:"Primary education engagement",unit:"%",value:5,natural_value:.9921428},{category:"Education",indicator:"Pupils per teacher rate",unit:"ratio",value:3,natural_value:18.877333333333336},{category:"Education",indicator:"Proportion of population with post-secondary and higher education",unit:"%",value:4,natural_value:.405},{category:"Wealth",indicator:"Percentage of population with food expenditure is above 52% of total expenditure",unit:"%",value:3,natural_value:.27},{category:"Wealth",indicator:"Mean monthly salary",unit:"US dollars thousand",value:3,natural_value:1082.1000000000001},{category:"Wealth",indicator:"Mean monthly salary, change in last 3 years",unit:"%",value:2,natural_value:-.0734334645124871},{category:"Wealth",indicator:"Disposable monthly income",unit:"US dollars thousand",value:2,natural_value:254.3964760687164},{category:"Wealth",indicator:"Disposable monthly income (change in last 3 years)",unit:"%",value:2,natural_value:-.0183481759621801},{category:"Wealth",indicator:"Debt to salary ratio",unit:"ratio",value:2,natural_value:18.240000000000002},{category:"Wealth",indicator:"Number of mobile phones per 1,000 population",unit:"per 1,000",value:4,natural_value:132.66666666666669},{category:"Wealth",indicator:"Decile income coefficient",unit:"ratio",value:3,natural_value:16.41333333333333},{category:"Wealth",indicator:"Decile income coefficient (change in last 3 years)",unit:"%",value:3,natural_value:.0128157365967749},{category:"Wealth",indicator:"Poverty headcount ratio at national poverty lines",unit:"%",value:3,natural_value:.21},{category:"Wealth",indicator:"Working poverty rate (percentage of employed living below US$1.90 PPP), 15+ age (%) ",unit:"%",value:3,natural_value:.022},{category:"Wealth",indicator:"Poverty headcount ratio at $2.15 PPP 2017 a day",unit:"%",value:3,natural_value:.0236666666666667},{category:"Wealth",indicator:"Living spaces per capita, sq m (change in last 3 years)",unit:"%",value:5,natural_value:.2213},{category:"Wealth",indicator:"Population living in slums (% of urban population)",unit:"%",value:3,natural_value:.17},{category:"Wealth",indicator:"Availability of finance (consumer loans)",unit:"%",value:3,natural_value:.5},{category:"Wealth",indicator:"Perception of wealth & poverty index",unit:"index",value:1,natural_value:1.3257846667649562},{category:"Safety",indicator:"Road fatalities rate per 100,000 population",unit:"per 100,000",value:4,natural_value:11.483333333333334},{category:"Safety",indicator:"Road fatalities rate per 100,000 population (change in last 3 years)",unit:"%",value:4,natural_value:.0786864009887851},{category:"Safety",indicator:"Violent crime rate per 100,000 population",unit:"per 100,000",value:3,natural_value:7.266666666666667},{category:"Safety",indicator:"Violent crime rate per 100,000 population (change in last 3 years)",unit:"%",value:4,natural_value:-.0682183289213857},{category:"Safety",indicator:"Crime rate per 100,000 population",unit:"per 100,000",value:3,natural_value:6270.933333333334},{category:"Safety",indicator:"Crime rate per 100,000 population  (change in last 3 years)",unit:"%",value:2,natural_value:-.0682183289213857},{category:"Safety",indicator:"Police arrival speed",unit:"min",value:2,natural_value:28},{category:"Safety",indicator:"Perception of safety index",unit:"index",value:4,natural_value:1.9649999999999999},{category:"Livability",indicator:"Number of LEED certified green buildings",unit:"Certified square meters per capita",value:3,natural_value:.35192599731186175},{category:"Livability",indicator:"Number of BREEAM certified projects",unit:"Certified square meters per capita",value:1,natural_value:0},{category:"Livability",indicator:"Whether or not the city has ISO 37120 certification",unit:"Yes/No",value:1,natural_value:0},{category:"Livability",indicator:"Mobile connection coverage",unit:"%",value:3,natural_value:.966666666666667},{category:"Livability",indicator:"Internet coverage",unit:"%",value:4,natural_value:.95},{category:"Livability",indicator:"Perception of livability index",unit:"index",value:4,natural_value:.8453069904609392},{category:"Livability",indicator:"Share of population in 1 km from schools",unit:"%",value:4,natural_value:98.6},{category:"Livability",indicator:"Share of population in 1 km from parks",unit:"%",value:5,natural_value:93.2},{category:"Transport",indicator:"Time loss in traffic",unit:"%",value:2,natural_value:34.8},{category:"Transport",indicator:"Share of the population in 1 km from public transport stop",unit:"%",value:3,natural_value:90.2},{category:"Transport",indicator:"Ratio of the cost of monthly public transport usage Ithe cheapest option) to average mobthly income",unit:"ratio",value:3,natural_value:.04},{category:"Transport",indicator:"Ratio of the cost of a 1-kilometer taxi ride to average mobthly income",unit:"%",value:3,natural_value:.04},{category:"Transport",indicator:"Percentage of city's roads that are segregated and/or has specialized lane for cyclists",unit:"%",value:3,natural_value:.06},{category:"Transport",indicator:"Number of public electric vehicle (EV) charging points per 100,000 population",unit:"per 100,000",value:3,natural_value:1.4},{category:"Transport",indicator:"Public transport (excluding subway) operates by schedule ",unit:"Yes/No",value:5,natural_value:1},{category:"Transport",indicator:"Perception of transport index",unit:"index",value:4,natural_value:.8453069904609392},{category:"Inclusion",indicator:"Female-friendly city",unit:"1,2,3,4,5",value:4,natural_value:2},{category:"Inclusion",indicator:"Number of refugees per 1,000 population",unit:"per 1,000",value:4,natural_value:.051},{category:"Inclusion",indicator:"Homeless people per 1,000 population",unit:"per 1,000",value:4,natural_value:.736},{category:"Inclusion",indicator:"Difference in number of years of schooling between woman and man, woman to man ratio ",unit:"years",value:3,natural_value:.97791},{category:"Inclusion",indicator:"Slavery index",unit:"index",value:5,natural_value:3.2},{category:"Inclusion",indicator:"Percentage of women aged 25-34 years old that have successfully completed secondary education",unit:"%",value:3,natural_value:.451},{category:"Inclusion",indicator:"Regulations for building construction and equipment, public transport for people with disabilities",unit:"Yes/No",value:5,natural_value:1},{category:"Inclusion",indicator:"Perception of inclusion index",unit:"index",value:4,natural_value:1.608933747267902},{category:"Accountability",indicator:"City budget execution publication",unit:"Yes/No",value:5,natural_value:1},{category:"Accountability",indicator:"City budget publication",unit:"Yes/No",value:5,natural_value:1},{category:"Accountability",indicator:"Financial transparency on city government companies",unit:"Yes/No",value:1,natural_value:0},{category:"Accountability",indicator:"ISO certification",unit:"Yes/No",value:1,natural_value:0},{category:"Accountability",indicator:"City council checks and balances",unit:"Yes/No",value:1,natural_value:0},{category:"Accountability",indicator:"Plans to obtain ISO certification",unit:"Yes/No",value:1,natural_value:0},{category:"Accountability",indicator:"Perception of accountability index",unit:"index",value:3,natural_value:.9155840858082012},{category:"City budget",indicator:"Poor financial condition",unit:"Yes/No",value:5,natural_value:0},{category:"City budget",indicator:"Central/higher level government financial intervention taking place",unit:"Yes/No",value:5,natural_value:0},{category:"City budget",indicator:"Long-term financial planning",unit:"Yes/No",value:1,natural_value:0},{category:"City budget",indicator:"Central/higher level government financial intervention is considered",unit:"Yes/No",value:1,natural_value:0},{category:"City budget",indicator:"Prudent fiscal policy requirements",unit:"Yes/No",value:1,natural_value:0},{category:"City budget",indicator:"Medium-term planning",unit:"Yes/No",value:1,natural_value:0},{category:"SME",indicator:"Number of SMEs per 100,000 population",unit:"per 100,000",value:5,natural_value:32477.9},{category:"SME",indicator:"Number of start-ups",unit:"start-ups",value:3,natural_value:4},{category:"SME",indicator:"Global Startup Ecosystem Index",unit:"index",value:1,natural_value:.178},{category:"SME",indicator:"Number of SMEs per capita/100 000 population (change in last 3 years)",unit:"%",value:3,natural_value:.00427846538976695},{category:"SME",indicator:"Number of start-ups (change in last 3 years)",unit:"%",value:5,natural_value:0},{category:"Public services",indicator:"Free phone to call the police, ambulance, firefighters",unit:"1,2,3,4,5",value:5,natural_value:1},{category:"Public services",indicator:"Services for working with citizens' appeals and complaint",unit:"Yes/No",value:5,natural_value:1},{category:"Public services",indicator:"E-gov services",unit:"Yes/No",value:5,natural_value:1},{category:"Public services",indicator:"Perception of public services index: Public Services",unit:"index",value:4,natural_value:.9361290524476109},{category:"Sustainability commitment",indicator:"City ESG reporting",unit:"Yes/No",value:1,natural_value:0},{category:"Sustainability commitment",indicator:"City ESG reporting verification",unit:"Yes/No",value:1,natural_value:0},{category:"Sustainability commitment",indicator:"ESG planning",unit:"Yes/No",value:1,natural_value:0},{category:"Sustainability commitment",indicator:"Plan with specific targets to develop and implement smart city principles",unit:"Yes/No",value:5,natural_value:1},{category:"Sustainability commitment",indicator:"Rollout and status of ESG / UN SDG training across the municipal/asset workforce",unit:"Yes/No",value:1,natural_value:0},{category:"Sustainability commitment",indicator:"City municipality involved in network or partnership promoting sustainable development (for example, C40 Cities network)",unit:"Yes/No",value:5,natural_value:1}]},{city:"Dar es Salaam",data:[{category:"Air pollution",indicator:"CO2 emissions",unit:"kt",value:5,natural_value:.2},{category:"Air pollution",indicator:"CO2 emissions (change in last 3 years)",unit:"%",value:2,natural_value:4.6},{category:"Air pollution",indicator:"CO2 concentration",unit:"ppm",value:5,natural_value:412.5},{category:"Air pollution",indicator:"CO2 concentration (change in last 3 years)",unit:"%",value:3,natural_value:1.6},{category:"Air pollution",indicator:"Annual average of SO2 concentration in ambient air",unit:"microgram/m3",value:5,natural_value:.2},{category:"Air pollution",indicator:"Annual Average of SO2 Concentration in Ambient Air (change in last 3 years)",unit:"%",value:5,natural_value:-67.3},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air",unit:"microgram/m3",value:1,natural_value:.4},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air (change in last 3 years), microgram/m3",unit:"%",value:5,natural_value:-8.2},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air, microgram/m3",unit:"microgram/m3",value:3,natural_value:49.6},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air (change in last 3 years), microgram/m3",unit:"%",value:2,natural_value:3.8},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air, microgram/m3",unit:"microgram/m3",value:5,natural_value:.1},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air (change in last 3 years), microgram/m3",unit:"%",value:5,natural_value:-7.2},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air, microgram/m3",unit:"microgram/m3",value:5,natural_value:16.8},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air (change in last 3 years), microgram/m3",unit:"%",value:1,natural_value:12.1},{category:"Air pollution",indicator:"Volatile organic compounds/reactive organic gases emissions",unit:"microgram/m3",value:5,natural_value:.6},{category:"Air pollution",indicator:"Perception of air pollution index",unit:"index",value:3,natural_value:1.84},{category:"Air pollution",indicator:"Paris Agreement",unit:"Yes/No",value:5,natural_value:1},{category:"Water pollution",indicator:"Annual average of dissolved oxygen (DO) concentration in water",unit:"%",value:5,natural_value:4.6},{category:"Water pollution",indicator:"Annual average of pH concentration in water",unit:"pH",value:5,natural_value:4.2},{category:"Water pollution",indicator:"Annual average dissolved solids in drinking-water",unit:"ppm",value:3,natural_value:139},{category:"Water pollution",indicator:"Water management strategy in a city",unit:"Yes/No",value:1,natural_value:0},{category:"Water pollution",indicator:"Perception of water pollution index",unit:"index",value:4,natural_value:1.5753920145654807},{category:"Land use and waste",indicator:"Share of devastated and degraded land area requiring reclamation",unit:"%",value:3,natural_value:6.7},{category:"Land use and waste",indicator:"3-year average growth rate of devastated and degraded land area requiring reclamation",unit:"%",value:4,natural_value:-.018},{category:"Land use and waste",indicator:"Waste deposits",unit:"%",value:2,natural_value:.013},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous)",unit:"kg per capita ",value:5,natural_value:16.761630773179},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous), (change in last 3 years)",unit:"%",value:4,natural_value:.94309270238},{category:"Land use and waste",indicator:"Total recycled construction waste",unit:"tons per capita",value:3,natural_value:2.041343669},{category:"Land use and waste",indicator:"Share of recycled construction and demolish waste in total generated construction and demolish waste",unit:"%",value:2,natural_value:.06},{category:"Land use and waste",indicator:"Total area of impervious surfaces and percentage to total city area",unit:"%",value:3,natural_value:.02},{category:"Land use and waste",indicator:"Productive urban land (in percent total land)",unit:"%",value:3,natural_value:32.2},{category:"Land use and waste",indicator:"Waste managenet strategy",unit:"Yes/No",value:1,natural_value:0},{category:"Land use and waste",indicator:"Perception of waste index",unit:"index",value:5,natural_value:2.0883519403371764},{category:"Land use and waste",indicator:"Green spaces, % city area",unit:"%",value:3,natural_value:.1989},{category:"Land use and waste",indicator:"Green spaces, change in last 3 years",unit:"%",value:2,natural_value:-1.6},{category:"Land use and waste",indicator:"NDVI",unit:"%",value:3,natural_value:.25},{category:"Natural disaster hazards",indicator:"Share of total area with altitude above sea level less than 0,5 meters",unit:"%",value:2,natural_value:.15},{category:"Natural disaster hazards",indicator:"Growth rate of freshwater mirror area",unit:"%",value:4,natural_value:-.05},{category:"Natural disaster hazards",indicator:"Number of registered heavy rain, flood and thunderbolt (change in last 3 years)",unit:"%",value:4,natural_value:-.0670521428844533},{category:"Natural disaster hazards",indicator:"Number of registered sand storm (change in last 3 years)",unit:"%",value:4,natural_value:-.186448788952852},{category:"Natural disaster hazards",indicator:"Environmental/natural disasters’ risk mitigation",unit:"Yes/No",value:5,natural_value:1},{category:"Natural disaster hazards",indicator:"Strategy/policy/government officials’ statement on environmental issues ",unit:"Yes/No",value:5,natural_value:1},{category:"Natural disaster hazards",indicator:"Total overall losses from natural disaster hazards",unit:"US$ mln ",value:3,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of days with average daily temperature above the threshold for 1990-2010",unit:"days",value:3,natural_value:15},{category:"Natural disaster hazards",indicator:"Number of disruptions to basic services, attributed to disasters",unit:"%",value:3,natural_value:0},{category:"Water availability",indicator:"Water consumption per capita",unit:"mcm",value:3,natural_value:9489999999999999e-21},{category:"Water availability",indicator:"Water tariff to disposable income ratio",unit:"ratio",value:3,natural_value:.7},{category:"Water availability",indicator:"Sanitary facilities tariff to disposable income ratio",unit:"ratio",value:2,natural_value:2.1},{category:"Water availability",indicator:"Water consumption per capita (change in last 3 years)",unit:"%",value:3,natural_value:0},{category:"Water availability",indicator:"Percentage of population with access to drinking water",unit:"%",value:3,natural_value:.6},{category:"Water availability",indicator:"Percentage of population with access to drinking water (change in last 3 years)",unit:"%",value:3,natural_value:.011},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities",unit:"%",value:3,natural_value:.311666666666667},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities (change in last 3 years)",unit:"%",value:1,natural_value:.018},{category:"Food availability",indicator:"Cereal import dependency ratio (5-years average)",unit:"%",value:4,natural_value:.042},{category:"Food availability",indicator:"Cereal import dependency ratio (change in last 3 years)",unit:"%",value:4,natural_value:-.1398613725},{category:"Food availability",indicator:"Prevalence of undernourishment",unit:"%",value:3,natural_value:.056},{category:"Food availability",indicator:"Prevalence of undernourishment (change in last 3 years)",unit:"%",value:3,natural_value:-.0101163005900995},{category:"Food availability",indicator:"Prevalence of undernourishment children",unit:"%",value:3,natural_value:.357},{category:"Food availability",indicator:"Prevalence of undernourishment children (change in last 3 years)",unit:"%",value:3,natural_value:-.0158254476471159},{category:"Food availability",indicator:"Prevalence of moderate or severe food insecurity in the population",unit:"%",value:2,natural_value:.5685},{category:"Food availability",indicator:"Share of imports in food resources",unit:"%",value:3,natural_value:.36},{category:"Food availability",indicator:"Percentage of people with access to at least one food vendor/retailer within 15 minutes of walking",unit:"%",value:3,natural_value:91},{category:"Food availability",indicator:"Perception of food availability index",unit:"index",value:5,natural_value:3.3307200778133215},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity",unit:"%",value:1,natural_value:.401},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity (change in last 3 years)",unit:"%",value:5,natural_value:.0423866522560024},{category:"Energy availability",indicator:"Consumption of electricity per capita",unit:"kWh/person",value:4,natural_value:915.5},{category:"Energy availability",indicator:"Consumption of electricity per capita (change in last 3 years)",unit:"%",value:2,natural_value:.195999685612988},{category:"Energy availability",indicator:"Electricity tariff to disposable income ratio",unit:"ratio",value:3,natural_value:.09866666666666668},{category:"Energy availability",indicator:"Share of renewable sources in electricity consumption",unit:"%",value:3,natural_value:.21},{category:"Energy availability",indicator:"Perception of energy availability index",unit:"index",value:2,natural_value:1.7464372477518388},{category:"Health",indicator:"Child mortality rate (under 5 years-old)",unit:"% of live births ",value:4,natural_value:4.86666666666667},{category:"Health",indicator:"City ambulance",unit:"Yes/No",value:5,natural_value:1},{category:"Health",indicator:"Life expectancy at birth, years",unit:"Years",value:2,natural_value:66.33333333333333},{category:"Health",indicator:"Life expectancy at birth goals",unit:"categories",value:5,natural_value:3},{category:"Health",indicator:"Number of hospital beds per 1,000 population",unit:"per 1,000",value:4,natural_value:.9},{category:"Health",indicator:"Number of doctors per 1,000 population",unit:"per 1,000",value:4,natural_value:.1},{category:"Health",indicator:"Maternal mortality ratio",unit:"deaths per 1,000 live births",value:3,natural_value:49},{category:"Health",indicator:"Ambulance arrival speed, min",unit:"min",value:3,natural_value:70},{category:"Education",indicator:"Literacy rate among population (15-24 Years)",unit:"%",value:2,natural_value:.866666666666667},{category:"Education",indicator:"Literacy rate among population (15-24 Years) (change in last 3 years)",unit:"%",value:4,natural_value:.00769260999601173},{category:"Education",indicator:"Primary education engagement",unit:"%",value:3,natural_value:.8430377},{category:"Education",indicator:"Pupils per teacher rate",unit:"ratio",value:1,natural_value:41},{category:"Education",indicator:"Proportion of population with post-secondary and higher education",unit:"%",value:2,natural_value:.02555639982},{category:"Wealth",indicator:"Percentage of population with food expenditure is above 52% of total expenditure",unit:"%",value:3,natural_value:.143333333333333},{category:"Wealth",indicator:"Mean monthly salary",unit:"US dollars thousand",value:2,natural_value:198.89333333333332},{category:"Wealth",indicator:"Mean monthly salary, change in last 3 years",unit:"%",value:2,natural_value:-.0647021383543841},{category:"Wealth",indicator:"Disposable monthly income",unit:"US dollars thousand",value:2,natural_value:277.8994829014047},{category:"Wealth",indicator:"Disposable monthly income (change in last 3 years)",unit:"%",value:2,natural_value:-.0154922656223049},{category:"Wealth",indicator:"Debt to salary ratio",unit:"ratio",value:3,natural_value:3.83754800973528},{category:"Wealth",indicator:"Number of mobile phones per 1,000 population",unit:"per 1,000",value:4,natural_value:82.66666666666666},{category:"Wealth",indicator:"Decile income coefficient",unit:"ratio",value:3,natural_value:11.391264367816092},{category:"Wealth",indicator:"Decile income coefficient (change in last 3 years)",unit:"%",value:3,natural_value:-.036482129845679},{category:"Wealth",indicator:"Poverty headcount ratio at national poverty lines",unit:"%",value:3,natural_value:.333333333333333},{category:"Wealth",indicator:"Working poverty rate (percentage of employed living below US$1.90 PPP), 15+ age (%) ",unit:"%",value:3,natural_value:.032},{category:"Wealth",indicator:"Poverty headcount ratio at $2.15 PPP 2017 a day",unit:"%",value:3,natural_value:.0346666666666667},{category:"Wealth",indicator:"Living spaces per capita, sq m (change in last 3 years)",unit:"%",value:1,natural_value:0},{category:"Wealth",indicator:"Population living in slums (% of urban population)",unit:"%",value:3,natural_value:.17},{category:"Wealth",indicator:"Availability of finance (consumer loans)",unit:"%",value:3,natural_value:.5},{category:"Wealth",indicator:"Perception of wealth & poverty index",unit:"index",value:2,natural_value:1.8715798707389055},{category:"Safety",indicator:"Road fatalities rate per 100,000 population",unit:"per 100,000",value:1,natural_value:383.3333333333333},{category:"Safety",indicator:"Road fatalities rate per 100,000 population (change in last 3 years)",unit:"%",value:2,natural_value:-.14},{category:"Safety",indicator:"Violent crime rate per 100,000 population",unit:"per 100,000",value:3,natural_value:7.240165689817097},{category:"Safety",indicator:"Violent crime rate per 100,000 population (change in last 3 years)",unit:"%",value:3,natural_value:-.00832504805114254},{category:"Safety",indicator:"Crime rate per 100,000 population",unit:"per 100,000",value:4,natural_value:56},{category:"Safety",indicator:"Crime rate per 100,000 population  (change in last 3 years)",unit:"%",value:4,natural_value:-.00832504805114254},{category:"Safety",indicator:"Police arrival speed",unit:"min",value:2,natural_value:28},{category:"Safety",indicator:"Perception of safety index",unit:"index",value:2,natural_value:3.475},{category:"Livability",indicator:"Number of LEED certified green buildings",unit:"Certified square meters per capita",value:2,natural_value:.0009965494125590817},{category:"Livability",indicator:"Number of BREEAM certified projects",unit:"Certified square meters per capita",value:1,natural_value:0},{category:"Livability",indicator:"Whether or not the city has ISO 37120 certification",unit:"Yes/No",value:1,natural_value:0},{category:"Livability",indicator:"Mobile connection coverage",unit:"%",value:3,natural_value:.95},{category:"Livability",indicator:"Internet coverage",unit:"%",value:2,natural_value:.85},{category:"Livability",indicator:"Perception of livability index",unit:"index",value:3,natural_value:1.4694013205984446},{category:"Livability",indicator:"Share of population in 1 km from schools",unit:"%",value:4,natural_value:97.5},{category:"Livability",indicator:"Share of population in 1 km from parks",unit:"%",value:2,natural_value:34.4},{category:"Transport",indicator:"Time loss in traffic",unit:"%",value:3,natural_value:22.9},{category:"Transport",indicator:"Share of the population in 1 km from public transport stop",unit:"%",value:2,natural_value:48.2},{category:"Transport",indicator:"Ratio of the cost of monthly public transport usage Ithe cheapest option) to average mobthly income",unit:"ratio",value:3,natural_value:.04},{category:"Transport",indicator:"Ratio of the cost of a 1-kilometer taxi ride to average mobthly income",unit:"%",value:3,natural_value:.04},{category:"Transport",indicator:"Percentage of city's roads that are segregated and/or has specialized lane for cyclists",unit:"%",value:3,natural_value:.06},{category:"Transport",indicator:"Number of public electric vehicle (EV) charging points per 100,000 population",unit:"per 100,000",value:3,natural_value:1.4},{category:"Transport",indicator:"Public transport (excluding subway) operates by schedule ",unit:"Yes/No",value:5,natural_value:1},{category:"Transport",indicator:"Perception of transport index",unit:"index",value:3,natural_value:1.4694013205984446},{category:"Inclusion",indicator:"Female-friendly city",unit:"1,2,3,4,5",value:4,natural_value:"2"},{category:"Inclusion",indicator:"Number of refugees per 1,000 population",unit:"per 1,000",value:4,natural_value:.034},{category:"Inclusion",indicator:"Homeless people per 1,000 population",unit:"per 1,000",value:3,natural_value:1.889719188959608},{category:"Inclusion",indicator:"Difference in number of years of schooling between woman and man, woman to man ratio ",unit:"years",value:1,natural_value:5.45},{category:"Inclusion",indicator:"Slavery index",unit:"index",value:5,natural_value:2.9},{category:"Inclusion",indicator:"Percentage of women aged 25-34 years old that have successfully completed secondary education",unit:"%",value:3,natural_value:.423},{category:"Inclusion",indicator:"Regulations for building construction and equipment, public transport for people with disabilities",unit:"Yes/No",value:1,natural_value:0},{category:"Inclusion",indicator:"Perception of inclusion index",unit:"index",value:4,natural_value:2.0596216601999084},{category:"Accountability",indicator:"City budget execution publication",unit:"Yes/No",value:1,natural_value:0},{category:"Accountability",indicator:"City budget publication",unit:"Yes/No",value:1,natural_value:0},{category:"Accountability",indicator:"Financial transparency on city government companies",unit:"Yes/No",value:5,natural_value:1},{category:"Accountability",indicator:"ISO certification",unit:"Yes/No",value:1,natural_value:0},{category:"Accountability",indicator:"City council checks and balances",unit:"Yes/No",value:5,natural_value:1},{category:"Accountability",indicator:"Plans to obtain ISO certification",unit:"Yes/No",value:1,natural_value:0},{category:"Accountability",indicator:"Perception of accountability index",unit:"index",value:1,natural_value:1.2774937108588444},{category:"City budget",indicator:"Poor financial condition",unit:"Yes/No",value:5,natural_value:0},{category:"City budget",indicator:"Central/higher level government financial intervention taking place",unit:"Yes/No",value:5,natural_value:0},{category:"City budget",indicator:"Long-term financial planning",unit:"Yes/No",value:1,natural_value:0},{category:"City budget",indicator:"Central/higher level government financial intervention is considered",unit:"Yes/No",value:1,natural_value:0},{category:"City budget",indicator:"Prudent fiscal policy requirements",unit:"Yes/No",value:1,natural_value:0},{category:"City budget",indicator:"Medium-term planning",unit:"Yes/No",value:5,natural_value:1},{category:"SME",indicator:"Number of SMEs per 100,000 population",unit:"per 100,000",value:1,natural_value:32893.42962791773},{category:"SME",indicator:"Number of start-ups",unit:"start-ups",value:3,natural_value:334.3530666666667},{category:"SME",indicator:"Global Startup Ecosystem Index",unit:"index",value:1,natural_value:.336},{category:"SME",indicator:"Number of SMEs per capita/100 000 population (change in last 3 years)",unit:"%",value:3,natural_value:0},{category:"SME",indicator:"Number of start-ups (change in last 3 years)",unit:"%",value:1,natural_value:.396709338846017},{category:"Public services",indicator:"Free phone to call the police, ambulance, firefighters",unit:"1,2,3,4,5",value:5,natural_value:1},{category:"Public services",indicator:"Services for working with citizens' appeals and complaint",unit:"Yes/No",value:5,natural_value:1},{category:"Public services",indicator:"E-gov services",unit:"Yes/No",value:5,natural_value:1},{category:"Public services",indicator:"Perception of public services index: Public Services",unit:"index",value:2,natural_value:2.221932145814465},{category:"Sustainability commitment",indicator:"City ESG reporting",unit:"Yes/No",value:1,natural_value:0},{category:"Sustainability commitment",indicator:"City ESG reporting verification",unit:"Yes/No",value:1,natural_value:0},{category:"Sustainability commitment",indicator:"ESG planning",unit:"Yes/No",value:1,natural_value:0},{category:"Sustainability commitment",indicator:"Plan with specific targets to develop and implement smart city principles",unit:"Yes/No",value:1,natural_value:0},{category:"Sustainability commitment",indicator:"Rollout and status of ESG / UN SDG training across the municipal/asset workforce",unit:"Yes/No",value:1,natural_value:0},{category:"Sustainability commitment",indicator:"City municipality involved in network or partnership promoting sustainable development (for example, C40 Cities network)",unit:"Yes/No",value:1,natural_value:0}]},{city:"Adoni",data:[{category:"Air pollution",indicator:"CO2 emissions",unit:"kt",value:4,natural_value:1.6},{category:"Air pollution",indicator:"CO2 emissions (change in last 3 years)",unit:"%",value:3,natural_value:2.7},{category:"Air pollution",indicator:"CO2 concentration",unit:"ppm",value:3,natural_value:435.7},{category:"Air pollution",indicator:"CO2 concentration (change in last 3 years)",unit:"%",value:3,natural_value:2.4},{category:"Air pollution",indicator:"Annual average of SO2 concentration in ambient air",unit:"microgram/m3",value:4,natural_value:5.1},{category:"Air pollution",indicator:"Annual Average of SO2 Concentration in Ambient Air (change in last 3 years)",unit:"%",value:4,natural_value:-52.2},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air",unit:"microgram/m3",value:2,natural_value:10.2},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air (change in last 3 years), microgram/m3",unit:"%",value:4,natural_value:-1.6},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air, microgram/m3",unit:"microgram/m3",value:2,natural_value:73.1},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air (change in last 3 years), microgram/m3",unit:"%",value:2,natural_value:3.1},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air, microgram/m3",unit:"microgram/m3",value:3,natural_value:.4},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air (change in last 3 years), microgram/m3",unit:"%",value:3,natural_value:.1},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air, microgram/m3",unit:"microgram/m3",value:4,natural_value:53.6},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air (change in last 3 years), microgram/m3",unit:"%",value:1,natural_value:21.7},{category:"Air pollution",indicator:"Volatile organic compounds/reactive organic gases emissions",unit:"microgram/m3",value:2,natural_value:2.1},{category:"Air pollution",indicator:"Perception of air pollution index",unit:"index",value:1,natural_value:3.51},{category:"Air pollution",indicator:"Paris Agreement",unit:"Yes/No",value:5,natural_value:1},{category:"Water pollution",indicator:"Annual average of dissolved oxygen (DO) concentration in water",unit:"%",value:3,natural_value:6.364666666666667},{category:"Water pollution",indicator:"Annual average of pH concentration in water",unit:"pH",value:2,natural_value:7.48},{category:"Water pollution",indicator:"Annual average dissolved solids in drinking-water",unit:"ppm",value:3,natural_value:139},{category:"Water pollution",indicator:"Water management strategy in a city",unit:"Yes/No",value:1,natural_value:0},{category:"Water pollution",indicator:"Perception of water pollution index",unit:"index",value:1,natural_value:4.237722036452691},{category:"Land use and waste",indicator:"Share of devastated and degraded land area requiring reclamation",unit:"%",value:4,natural_value:3.2},{category:"Land use and waste",indicator:"3-year average growth rate of devastated and degraded land area requiring reclamation",unit:"%",value:2,natural_value:.034},{category:"Land use and waste",indicator:"Waste deposits",unit:"%",value:1,natural_value:.02467},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous)",unit:"kg per capita ",value:5,natural_value:43.57403004271947},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous), (change in last 3 years)",unit:"%",value:3,natural_value:3.0448031884},{category:"Land use and waste",indicator:"Total recycled construction waste",unit:"tons per capita",value:1,natural_value:.001049303},{category:"Land use and waste",indicator:"Share of recycled construction and demolish waste in total generated construction and demolish waste",unit:"%",value:3,natural_value:.137},{category:"Land use and waste",indicator:"Total area of impervious surfaces and percentage to total city area",unit:"%",value:3,natural_value:.02},{category:"Land use and waste",indicator:"Productive urban land (in percent total land)",unit:"%",value:3,natural_value:32.2},{category:"Land use and waste",indicator:"Waste managenet strategy",unit:"Yes/No",value:1,natural_value:0},{category:"Land use and waste",indicator:"Perception of waste index",unit:"index",value:4,natural_value:2.4809015475033926},{category:"Land use and waste",indicator:"Green spaces, % city area",unit:"%",value:4,natural_value:.4061},{category:"Land use and waste",indicator:"Green spaces, change in last 3 years",unit:"%",value:3,natural_value:.9},{category:"Land use and waste",indicator:"NDVI",unit:"%",value:3,natural_value:.24},{category:"Natural disaster hazards",indicator:"Share of total area with altitude above sea level less than 0,5 meters",unit:"%",value:5,natural_value:0},{category:"Natural disaster hazards",indicator:"Growth rate of freshwater mirror area",unit:"%",value:3,natural_value:-.1},{category:"Natural disaster hazards",indicator:"Number of registered heavy rain, flood and thunderbolt (change in last 3 years)",unit:"%",value:3,natural_value:-.0390013286126644},{category:"Natural disaster hazards",indicator:"Number of registered sand storm (change in last 3 years)",unit:"%",value:3,natural_value:-.068012954951526},{category:"Natural disaster hazards",indicator:"Environmental/natural disasters’ risk mitigation",unit:"Yes/No",value:5,natural_value:1},{category:"Natural disaster hazards",indicator:"Strategy/policy/government officials’ statement on environmental issues ",unit:"Yes/No",value:5,natural_value:1},{category:"Natural disaster hazards",indicator:"Total overall losses from natural disaster hazards",unit:"US$ mln ",value:3,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of days with average daily temperature above the threshold for 1990-2010",unit:"days",value:3,natural_value:15},{category:"Natural disaster hazards",indicator:"Number of disruptions to basic services, attributed to disasters",unit:"%",value:3,natural_value:0},{category:"Water availability",indicator:"Water consumption per capita",unit:"mcm",value:3,natural_value:.0005761166037365854},{category:"Water availability",indicator:"Water tariff to disposable income ratio",unit:"ratio",value:5,natural_value:0},{category:"Water availability",indicator:"Sanitary facilities tariff to disposable income ratio",unit:"ratio",value:1,natural_value:2.5},{category:"Water availability",indicator:"Water consumption per capita (change in last 3 years)",unit:"%",value:3,natural_value:0},{category:"Water availability",indicator:"Percentage of population with access to drinking water",unit:"%",value:3,natural_value:.94},{category:"Water availability",indicator:"Percentage of population with access to drinking water (change in last 3 years)",unit:"%",value:3,natural_value:0},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities",unit:"%",value:3,natural_value:.683333333333333},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities (change in last 3 years)",unit:"%",value:3,natural_value:.029},{category:"Food availability",indicator:"Cereal import dependency ratio (5-years average)",unit:"%",value:4,natural_value:-.0563333333333333},{category:"Food availability",indicator:"Cereal import dependency ratio (change in last 3 years)",unit:"%",value:2,natural_value:.06488171074},{category:"Food availability",indicator:"Prevalence of undernourishment",unit:"%",value:3,natural_value:.056},{category:"Food availability",indicator:"Prevalence of undernourishment (change in last 3 years)",unit:"%",value:3,natural_value:.0666991349319599},{category:"Food availability",indicator:"Prevalence of undernourishment children",unit:"%",value:3,natural_value:.357},{category:"Food availability",indicator:"Prevalence of undernourishment children (change in last 3 years)",unit:"%",value:3,natural_value:-.0182411646604512},{category:"Food availability",indicator:"Prevalence of moderate or severe food insecurity in the population",unit:"%",value:3,natural_value:.406},{category:"Food availability",indicator:"Share of imports in food resources",unit:"%",value:3,natural_value:.36},{category:"Food availability",indicator:"Percentage of people with access to at least one food vendor/retailer within 15 minutes of walking",unit:"%",value:3,natural_value:91},{category:"Food availability",indicator:"Perception of food availability index",unit:"index",value:3,natural_value:2.0123986386340906},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity",unit:"%",value:3,natural_value:.973333333333333},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity (change in last 3 years)",unit:"%",value:4,natural_value:.0126986796536908},{category:"Energy availability",indicator:"Consumption of electricity per capita",unit:"kWh/person",value:4,natural_value:758.3852989040864},{category:"Energy availability",indicator:"Consumption of electricity per capita (change in last 3 years)",unit:"%",value:3,natural_value:.0299415138727994},{category:"Energy availability",indicator:"Electricity tariff to disposable income ratio",unit:"ratio",value:3,natural_value:.09233333333333334},{category:"Energy availability",indicator:"Share of renewable sources in electricity consumption",unit:"%",value:3,natural_value:.21},{category:"Energy availability",indicator:"Perception of energy availability index",unit:"index",value:3,natural_value:1.115973148644494},{category:"Health",indicator:"Child mortality rate (under 5 years-old)",unit:"% of live births ",value:4,natural_value:5.86666666666667},{category:"Health",indicator:"City ambulance",unit:"Yes/No",value:5,natural_value:1},{category:"Health",indicator:"Life expectancy at birth, years",unit:"Years",value:2,natural_value:71.85},{category:"Health",indicator:"Life expectancy at birth goals",unit:"categories",value:1,natural_value:1},{category:"Health",indicator:"Number of hospital beds per 1,000 population",unit:"per 1,000",value:4,natural_value:.4841105354058722},{category:"Health",indicator:"Number of doctors per 1,000 population",unit:"per 1,000",value:4,natural_value:.7530765255860573},{category:"Health",indicator:"Maternal mortality ratio",unit:"deaths per 1,000 live births",value:3,natural_value:49},{category:"Health",indicator:"Ambulance arrival speed, min",unit:"min",value:3,natural_value:70},{category:"Education",indicator:"Literacy rate among population (15-24 Years)",unit:"%",value:2,natural_value:.774433333333333},{category:"Education",indicator:"Literacy rate among population (15-24 Years) (change in last 3 years)",unit:"%",value:3,natural_value:0},{category:"Education",indicator:"Primary education engagement",unit:"%",value:5,natural_value:.9706456},{category:"Education",indicator:"Pupils per teacher rate",unit:"ratio",value:2,natural_value:30},{category:"Education",indicator:"Proportion of population with post-secondary and higher education",unit:"%",value:2,natural_value:.0911604537342698},{category:"Wealth",indicator:"Percentage of population with food expenditure is above 52% of total expenditure",unit:"%",value:3,natural_value:.213333333333333},{category:"Wealth",indicator:"Mean monthly salary",unit:"US dollars thousand",value:3,natural_value:2768.8000000000006},{category:"Wealth",indicator:"Mean monthly salary, change in last 3 years",unit:"%",value:3,natural_value:.0196642582706827},{category:"Wealth",indicator:"Disposable monthly income",unit:"US dollars thousand",value:3,natural_value:733.0256252983403},{category:"Wealth",indicator:"Disposable monthly income (change in last 3 years)",unit:"%",value:5,natural_value:.125516966254866},{category:"Wealth",indicator:"Debt to salary ratio",unit:"ratio",value:3,natural_value:9.29401497117486},{category:"Wealth",indicator:"Number of mobile phones per 1,000 population",unit:"per 1,000",value:3,natural_value:82.66666666666666},{category:"Wealth",indicator:"Decile income coefficient",unit:"ratio",value:3,natural_value:8.6890756302521},{category:"Wealth",indicator:"Decile income coefficient (change in last 3 years)",unit:"%",value:3,natural_value:.011},{category:"Wealth",indicator:"Poverty headcount ratio at national poverty lines",unit:"%",value:3,natural_value:.273333333333333},{category:"Wealth",indicator:"Working poverty rate (percentage of employed living below US$1.90 PPP), 15+ age (%) ",unit:"%",value:3,natural_value:.03},{category:"Wealth",indicator:"Poverty headcount ratio at $2.15 PPP 2017 a day",unit:"%",value:3,natural_value:.042},{category:"Wealth",indicator:"Living spaces per capita, sq m (change in last 3 years)",unit:"%",value:1,natural_value:0},{category:"Wealth",indicator:"Population living in slums (% of urban population)",unit:"%",value:3,natural_value:.17},{category:"Wealth",indicator:"Availability of finance (consumer loans)",unit:"%",value:3,natural_value:.5},{category:"Wealth",indicator:"Perception of wealth & poverty index",unit:"index",value:4,natural_value:1.4613529663376146},{category:"Safety",indicator:"Road fatalities rate per 100,000 population",unit:"per 100,000",value:4,natural_value:10.666666666666666},{category:"Safety",indicator:"Road fatalities rate per 100,000 population (change in last 3 years)",unit:"%",value:5,natural_value:.208},{category:"Safety",indicator:"Violent crime rate per 100,000 population",unit:"per 100,000",value:2,natural_value:16.48181321670989},{category:"Safety",indicator:"Violent crime rate per 100,000 population (change in last 3 years)",unit:"%",value:3,natural_value:.0275130980808507},{category:"Safety",indicator:"Crime rate per 100,000 population",unit:"per 100,000",value:3,natural_value:2391.3621676725943},{category:"Safety",indicator:"Crime rate per 100,000 population  (change in last 3 years)",unit:"%",value:5,natural_value:.0275130980808507},{category:"Safety",indicator:"Police arrival speed",unit:"min",value:2,natural_value:24.89},{category:"Safety",indicator:"Perception of safety index",unit:"index",value:2,natural_value:3.665},{category:"Livability",indicator:"Number of LEED certified green buildings",unit:"Certified square meters per capita",value:2,natural_value:.01973773861260913},{category:"Livability",indicator:"Number of BREEAM certified projects",unit:"Certified square meters per capita",value:1,natural_value:0},{category:"Livability",indicator:"Whether or not the city has ISO 37120 certification",unit:"Yes/No",value:1,natural_value:0},{category:"Livability",indicator:"Mobile connection coverage",unit:"%",value:3,natural_value:.9},{category:"Livability",indicator:"Internet coverage",unit:"%",value:4,natural_value:.967666666666667},{category:"Livability",indicator:"Perception of livability index",unit:"index",value:3,natural_value:2.068296237483395},{category:"Livability",indicator:"Share of population in 1 km from schools",unit:"%",value:4,natural_value:98.3},{category:"Livability",indicator:"Share of population in 1 km from parks",unit:"%",value:4,natural_value:70.4},{category:"Transport",indicator:"Time loss in traffic",unit:"%",value:4,natural_value:7.8},{category:"Transport",indicator:"Share of the population in 1 km from public transport stop",unit:"%",value:3,natural_value:26.6},{category:"Transport",indicator:"Ratio of the cost of monthly public transport usage Ithe cheapest option) to average mobthly income",unit:"ratio",value:3,natural_value:.04},{category:"Transport",indicator:"Ratio of the cost of a 1-kilometer taxi ride to average mobthly income",unit:"%",value:3,natural_value:.04},{category:"Transport",indicator:"Percentage of city's roads that are segregated and/or has specialized lane for cyclists",unit:"%",value:3,natural_value:.06},{category:"Transport",indicator:"Number of public electric vehicle (EV) charging points per 100,000 population",unit:"per 100,000",value:3,natural_value:1.4},{category:"Transport",indicator:"Public transport (excluding subway) operates by schedule ",unit:"Yes/No",value:5,natural_value:1},{category:"Transport",indicator:"Perception of transport index",unit:"index",value:2,natural_value:2.068296237483395},{category:"Inclusion",indicator:"Female-friendly city",unit:"1,2,3,4,5",value:4,natural_value:2},{category:"Inclusion",indicator:"Number of refugees per 1,000 population",unit:"per 1,000",value:4,natural_value:.154},{category:"Inclusion",indicator:"Homeless people per 1,000 population",unit:"per 1,000",value:3,natural_value:1.889719188959608},{category:"Inclusion",indicator:"Difference in number of years of schooling between woman and man, woman to man ratio ",unit:"years",value:1,natural_value:6.365},{category:"Inclusion",indicator:"Slavery index",unit:"index",value:4,natural_value:8},{category:"Inclusion",indicator:"Percentage of women aged 25-34 years old that have successfully completed secondary education",unit:"%",value:3,natural_value:.348},{category:"Inclusion",indicator:"Regulations for building construction and equipment, public transport for people with disabilities",unit:"Yes/No",value:1,natural_value:0},{category:"Inclusion",indicator:"Perception of inclusion index",unit:"index",value:1,natural_value:3.724379588475344},{category:"Accountability",indicator:"City budget execution publication",unit:"Yes/No",value:1,natural_value:0},{category:"Accountability",indicator:"City budget publication",unit:"Yes/No",value:1,natural_value:0},{category:"Accountability",indicator:"Financial transparency on city government companies",unit:"Yes/No",value:1,natural_value:0},{category:"Accountability",indicator:"ISO certification",unit:"Yes/No",value:1,natural_value:0},{category:"Accountability",indicator:"City council checks and balances",unit:"Yes/No",value:1,natural_value:0},{category:"Accountability",indicator:"Plans to obtain ISO certification",unit:"Yes/No",value:1,natural_value:0},{category:"Accountability",indicator:"Perception of accountability index",unit:"index",value:4,natural_value:.5427410395046992},{category:"City budget",indicator:"Poor financial condition",unit:"Yes/No",value:5,natural_value:0},{category:"City budget",indicator:"Central/higher level government financial intervention taking place",unit:"Yes/No",value:5,natural_value:0},{category:"City budget",indicator:"Long-term financial planning",unit:"Yes/No",value:1,natural_value:0},{category:"City budget",indicator:"Central/higher level government financial intervention is considered",unit:"Yes/No",value:1,natural_value:0},{category:"City budget",indicator:"Prudent fiscal policy requirements",unit:"Yes/No",value:1,natural_value:0},{category:"City budget",indicator:"Medium-term planning",unit:"Yes/No",value:1,natural_value:0},{category:"SME",indicator:"Number of SMEs per 100,000 population",unit:"per 100,000",value:3,natural_value:383.68866652411435},{category:"SME",indicator:"Number of start-ups",unit:"start-ups",value:2,natural_value:818.3333333333334},{category:"SME",indicator:"Global Startup Ecosystem Index",unit:"index",value:4,natural_value:11.982},{category:"SME",indicator:"Number of SMEs per capita/100 000 population (change in last 3 years)",unit:"%",value:5,natural_value:.595855801785293},{category:"SME",indicator:"Number of start-ups (change in last 3 years)",unit:"%",value:2,natural_value:.245817774855551},{category:"Public services",indicator:"Free phone to call the police, ambulance, firefighters",unit:"1,2,3,4,5",value:5,natural_value:1},{category:"Public services",indicator:"Services for working with citizens' appeals and complaint",unit:"Yes/No",value:5,natural_value:1},{category:"Public services",indicator:"E-gov services",unit:"Yes/No",value:5,natural_value:1},{category:"Public services",indicator:"Perception of public services index: Public Services",unit:"index",value:1,natural_value:4.805884365936772},{category:"Sustainability commitment",indicator:"City ESG reporting",unit:"Yes/No",value:1,natural_value:0},{category:"Sustainability commitment",indicator:"City ESG reporting verification",unit:"Yes/No",value:1,natural_value:0},{category:"Sustainability commitment",indicator:"ESG planning",unit:"Yes/No",value:1,natural_value:0},{category:"Sustainability commitment",indicator:"Plan with specific targets to develop and implement smart city principles",unit:"Yes/No",value:1,natural_value:0},{category:"Sustainability commitment",indicator:"Rollout and status of ESG / UN SDG training across the municipal/asset workforce",unit:"Yes/No",value:1,natural_value:0},{category:"Sustainability commitment",indicator:"City municipality involved in network or partnership promoting sustainable development (for example, C40 Cities network)",unit:"Yes/No",value:1,natural_value:0}]},{city:"Natal",data:[{category:"Air pollution",indicator:"CO2 emissions",unit:"kt",value:4,natural_value:1.9},{category:"Air pollution",indicator:"CO2 emissions (change in last 3 years)",unit:"%",value:5,natural_value:-1.2},{category:"Air pollution",indicator:"CO2 concentration",unit:"ppm",value:5,natural_value:412},{category:"Air pollution",indicator:"CO2 concentration (change in last 3 years)",unit:"%",value:3,natural_value:1.6},{category:"Air pollution",indicator:"Annual average of SO2 concentration in ambient air",unit:"microgram/m3",value:5,natural_value:.7},{category:"Air pollution",indicator:"Annual Average of SO2 Concentration in Ambient Air (change in last 3 years)",unit:"%",value:4,natural_value:-45.5},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air",unit:"microgram/m3",value:5,natural_value:1.2},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air (change in last 3 years), microgram/m3",unit:"%",value:4,natural_value:-2.4},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air, microgram/m3",unit:"microgram/m3",value:3,natural_value:55.1},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air (change in last 3 years), microgram/m3",unit:"%",value:1,natural_value:6.1},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air, microgram/m3",unit:"microgram/m3",value:5,natural_value:.1},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air (change in last 3 years), microgram/m3",unit:"%",value:3,natural_value:.4},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air, microgram/m3",unit:"microgram/m3",value:5,natural_value:14.8},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air (change in last 3 years), microgram/m3",unit:"%",value:1,natural_value:21.3},{category:"Air pollution",indicator:"Volatile organic compounds/reactive organic gases emissions",unit:"microgram/m3",value:4,natural_value:1.3},{category:"Air pollution",indicator:"Perception of air pollution index",unit:"index",value:5,natural_value:.45},{category:"Air pollution",indicator:"Paris Agreement",unit:"Yes/No",value:5,natural_value:1},{category:"Water pollution",indicator:"Annual average of dissolved oxygen (DO) concentration in water",unit:"%",value:3,natural_value:6.21},{category:"Water pollution",indicator:"Annual average of pH concentration in water",unit:"pH",value:2,natural_value:8.05},{category:"Water pollution",indicator:"Annual average dissolved solids in drinking-water",unit:"ppm",value:3,natural_value:139},{category:"Water pollution",indicator:"Water management strategy in a city",unit:"Yes/No",value:5,natural_value:1},{category:"Water pollution",indicator:"Perception of water pollution index",unit:"index",value:4,natural_value:1.3706361563678544},{category:"Land use and waste",indicator:"Share of devastated and degraded land area requiring reclamation",unit:"%",value:5,natural_value:1.4},{category:"Land use and waste",indicator:"3-year average growth rate of devastated and degraded land area requiring reclamation",unit:"%",value:3,natural_value:0},{category:"Land use and waste",indicator:"Waste deposits",unit:"%",value:5,natural_value:202e-6},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous)",unit:"kg per capita ",value:3,natural_value:165.8668566967861},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous), (change in last 3 years)",unit:"%",value:1,natural_value:28.45430686667},{category:"Land use and waste",indicator:"Total recycled construction waste",unit:"tons per capita",value:3,natural_value:.02021146977159802},{category:"Land use and waste",indicator:"Share of recycled construction and demolish waste in total generated construction and demolish waste",unit:"%",value:3,natural_value:.21},{category:"Land use and waste",indicator:"Total area of impervious surfaces and percentage to total city area",unit:"%",value:3,natural_value:.02},{category:"Land use and waste",indicator:"Productive urban land (in percent total land)",unit:"%",value:3,natural_value:32.2},{category:"Land use and waste",indicator:"Waste managenet strategy",unit:"Yes/No",value:1,natural_value:0},{category:"Land use and waste",indicator:"Perception of waste index",unit:"index",value:3,natural_value:1.514098740830482},{category:"Land use and waste",indicator:"Green spaces, % city area",unit:"%",value:4,natural_value:.4585},{category:"Land use and waste",indicator:"Green spaces, change in last 3 years",unit:"%",value:5,natural_value:6.3},{category:"Land use and waste",indicator:"NDVI",unit:"%",value:3,natural_value:.29},{category:"Natural disaster hazards",indicator:"Share of total area with altitude above sea level less than 0,5 meters",unit:"%",value:2,natural_value:.13},{category:"Natural disaster hazards",indicator:"Growth rate of freshwater mirror area",unit:"%",value:5,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of registered heavy rain, flood and thunderbolt (change in last 3 years)",unit:"%",value:3,natural_value:.0549016607508779},{category:"Natural disaster hazards",indicator:"Number of registered sand storm (change in last 3 years)",unit:"%",value:3,natural_value:.02704},{category:"Natural disaster hazards",indicator:"Environmental/natural disasters’ risk mitigation",unit:"Yes/No",value:5,natural_value:1},{category:"Natural disaster hazards",indicator:"Strategy/policy/government officials’ statement on environmental issues ",unit:"Yes/No",value:5,natural_value:1},{category:"Natural disaster hazards",indicator:"Total overall losses from natural disaster hazards",unit:"US$ mln ",value:3,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of days with average daily temperature above the threshold for 1990-2010",unit:"days",value:3,natural_value:15},{category:"Natural disaster hazards",indicator:"Number of disruptions to basic services, attributed to disasters",unit:"%",value:3,natural_value:0},{category:"Water availability",indicator:"Water consumption per capita",unit:"mcm",value:2,natural_value:3621e-8},{category:"Water availability",indicator:"Water tariff to disposable income ratio",unit:"ratio",value:4,natural_value:.8},{category:"Water availability",indicator:"Sanitary facilities tariff to disposable income ratio",unit:"ratio",value:2,natural_value:1.972},{category:"Water availability",indicator:"Water consumption per capita (change in last 3 years)",unit:"%",value:3,natural_value:-.0743369778509908},{category:"Water availability",indicator:"Percentage of population with access to drinking water",unit:"%",value:4,natural_value:.988666666666667},{category:"Water availability",indicator:"Percentage of population with access to drinking water (change in last 3 years)",unit:"%",value:3,natural_value:.001},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities",unit:"%",value:2,natural_value:.893},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities (change in last 3 years)",unit:"%",value:3,natural_value:.006},{category:"Food availability",indicator:"Cereal import dependency ratio (5-years average)",unit:"%",value:4,natural_value:-.239666666666667},{category:"Food availability",indicator:"Cereal import dependency ratio (change in last 3 years)",unit:"%",value:1,natural_value:.1737694332},{category:"Food availability",indicator:"Prevalence of undernourishment",unit:"%",value:3,natural_value:.056},{category:"Food availability",indicator:"Prevalence of undernourishment (change in last 3 years)",unit:"%",value:3,natural_value:.083},{category:"Food availability",indicator:"Prevalence of undernourishment children",unit:"%",value:3,natural_value:.357},{category:"Food availability",indicator:"Prevalence of undernourishment children (change in last 3 years)",unit:"%",value:3,natural_value:0},{category:"Food availability",indicator:"Prevalence of moderate or severe food insecurity in the population",unit:"%",value:3,natural_value:.284},{category:"Food availability",indicator:"Share of imports in food resources",unit:"%",value:3,natural_value:.36},{category:"Food availability",indicator:"Percentage of people with access to at least one food vendor/retailer within 15 minutes of walking",unit:"%",value:3,natural_value:91},{category:"Food availability",indicator:"Perception of food availability index",unit:"index",value:3,natural_value:2.0848544311905264},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity",unit:"%",value:3,natural_value:.996549443562825},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity (change in last 3 years)",unit:"%",value:1,natural_value:-.001},{category:"Energy availability",indicator:"Consumption of electricity per capita",unit:"kWh/person",value:3,natural_value:2554.644235196744},{category:"Energy availability",indicator:"Consumption of electricity per capita (change in last 3 years)",unit:"%",value:3,natural_value:.016},{category:"Energy availability",indicator:"Electricity tariff to disposable income ratio",unit:"ratio",value:3,natural_value:.159},{category:"Energy availability",indicator:"Share of renewable sources in electricity consumption",unit:"%",value:3,natural_value:.21},{category:"Energy availability",indicator:"Perception of energy availability index",unit:"index",value:2,natural_value:1.6479892845366555},{category:"Health",indicator:"Child mortality rate (under 5 years-old)",unit:"% of live births ",value:5,natural_value:1.83},{category:"Health",indicator:"City ambulance",unit:"Yes/No",value:5,natural_value:1},{category:"Health",indicator:"Life expectancy at birth, years",unit:"Years",value:3,natural_value:74.03233333333333},{category:"Health",indicator:"Life expectancy at birth goals",unit:"categories",value:3,natural_value:2},{category:"Health",indicator:"Number of hospital beds per 1,000 population",unit:"per 1,000",value:3,natural_value:2.1166666666666667},{category:"Health",indicator:"Number of doctors per 1,000 population",unit:"per 1,000",value:4,natural_value:1.26},{category:"Health",indicator:"Maternal mortality ratio",unit:"deaths per 1,000 live births",value:3,natural_value:49},{category:"Health",indicator:"Ambulance arrival speed, min",unit:"min",value:3,natural_value:70},{category:"Education",indicator:"Literacy rate among population (15-24 Years)",unit:"%",value:4,natural_value:.992531941731771},{category:"Education",indicator:"Literacy rate among population (15-24 Years) (change in last 3 years)",unit:"%",value:3,natural_value:.001},{category:"Education",indicator:"Primary education engagement",unit:"%",value:5,natural_value:.954859166666667},{category:"Education",indicator:"Pupils per teacher rate",unit:"ratio",value:3,natural_value:23.826666666666668},{category:"Education",indicator:"Proportion of population with post-secondary and higher education",unit:"%",value:4,natural_value:.377},{category:"Wealth",indicator:"Percentage of population with food expenditure is above 52% of total expenditure",unit:"%",value:3,natural_value:.173333333333333},{category:"Wealth",indicator:"Mean monthly salary",unit:"US dollars thousand",value:3,natural_value:1794.2433333333336},{category:"Wealth",indicator:"Mean monthly salary, change in last 3 years",unit:"%",value:3,natural_value:.00116669528203617},{category:"Wealth",indicator:"Disposable monthly income",unit:"US dollars thousand",value:2,natural_value:312.1303401590869},{category:"Wealth",indicator:"Disposable monthly income (change in last 3 years)",unit:"%",value:2,natural_value:-.0307054183800864},{category:"Wealth",indicator:"Debt to salary ratio",unit:"ratio",value:2,natural_value:19.4310686264357},{category:"Wealth",indicator:"Number of mobile phones per 1,000 population",unit:"per 1,000",value:1,natural_value:98.14033017333333},{category:"Wealth",indicator:"Decile income coefficient",unit:"ratio",value:3,natural_value:37.56018518518518},{category:"Wealth",indicator:"Decile income coefficient (change in last 3 years)",unit:"%",value:3,natural_value:-.0375928051939775},{category:"Wealth",indicator:"Poverty headcount ratio at national poverty lines",unit:"%",value:3,natural_value:.15},{category:"Wealth",indicator:"Working poverty rate (percentage of employed living below US$1.90 PPP), 15+ age (%) ",unit:"%",value:3,natural_value:.0233333333333333},{category:"Wealth",indicator:"Poverty headcount ratio at $2.15 PPP 2017 a day",unit:"%",value:3,natural_value:.027},{category:"Wealth",indicator:"Living spaces per capita, sq m (change in last 3 years)",unit:"%",value:3,natural_value:.026192},{category:"Wealth",indicator:"Population living in slums (% of urban population)",unit:"%",value:3,natural_value:.17},{category:"Wealth",indicator:"Availability of finance (consumer loans)",unit:"%",value:3,natural_value:.5},{category:"Wealth",indicator:"Perception of wealth & poverty index",unit:"index",value:2,natural_value:2.099160121450789},{category:"Safety",indicator:"Road fatalities rate per 100,000 population",unit:"per 100,000",value:2,natural_value:19.073333333333334},{category:"Safety",indicator:"Road fatalities rate per 100,000 population (change in last 3 years)",unit:"%",value:2,natural_value:-.118},{category:"Safety",indicator:"Violent crime rate per 100,000 population",unit:"per 100,000",value:2,natural_value:31.899999999999995},{category:"Safety",indicator:"Violent crime rate per 100,000 population (change in last 3 years)",unit:"%",value:3,natural_value:-.00952438823708124},{category:"Safety",indicator:"Crime rate per 100,000 population",unit:"per 100,000",value:3,natural_value:67.49},{category:"Safety",indicator:"Crime rate per 100,000 population  (change in last 3 years)",unit:"%",value:4,natural_value:-.00952438823708124},{category:"Safety",indicator:"Police arrival speed",unit:"min",value:3,natural_value:22.5},{category:"Safety",indicator:"Perception of safety index",unit:"index",value:4,natural_value:2.54},{category:"Livability",indicator:"Number of LEED certified green buildings",unit:"Certified square meters per capita",value:3,natural_value:.09697838620283454},{category:"Livability",indicator:"Number of BREEAM certified projects",unit:"Certified square meters per capita",value:1,natural_value:0},{category:"Livability",indicator:"Whether or not the city has ISO 37120 certification",unit:"Yes/No",value:1,natural_value:0},{category:"Livability",indicator:"Mobile connection coverage",unit:"%",value:5,natural_value:1},{category:"Livability",indicator:"Internet coverage",unit:"%",value:2,natural_value:.922533333333333},{category:"Livability",indicator:"Perception of livability index",unit:"index",value:4,natural_value:.8072949066928007},{category:"Livability",indicator:"Share of population in 1 km from schools",unit:"%",value:4,natural_value:95.6},{category:"Livability",indicator:"Share of population in 1 km from parks",unit:"%",value:4,natural_value:83.6},{category:"Transport",indicator:"Time loss in traffic",unit:"%",value:2,natural_value:34.4},{category:"Transport",indicator:"Share of the population in 1 km from public transport stop",unit:"%",value:3,natural_value:77.3},{category:"Transport",indicator:"Ratio of the cost of monthly public transport usage Ithe cheapest option) to average mobthly income",unit:"ratio",value:3,natural_value:.04},{category:"Transport",indicator:"Ratio of the cost of a 1-kilometer taxi ride to average mobthly income",unit:"%",value:3,natural_value:.04},{category:"Transport",indicator:"Percentage of city's roads that are segregated and/or has specialized lane for cyclists",unit:"%",value:3,natural_value:.06},{category:"Transport",indicator:"Number of public electric vehicle (EV) charging points per 100,000 population",unit:"per 100,000",value:3,natural_value:1.4},{category:"Transport",indicator:"Public transport (excluding subway) operates by schedule ",unit:"Yes/No",value:5,natural_value:1},{category:"Transport",indicator:"Perception of transport index",unit:"index",value:4,natural_value:.8072949066928007},{category:"Inclusion",indicator:"Female-friendly city",unit:"1,2,3,4,5",value:4,natural_value:"2"},{category:"Inclusion",indicator:"Number of refugees per 1,000 population",unit:"per 1,000",value:4,natural_value:.24},{category:"Inclusion",indicator:"Homeless people per 1,000 population",unit:"per 1,000",value:4,natural_value:1.242280047916944},{category:"Inclusion",indicator:"Difference in number of years of schooling between woman and man, woman to man ratio ",unit:"years",value:3,natural_value:1.05},{category:"Inclusion",indicator:"Slavery index",unit:"index",value:4,natural_value:5},{category:"Inclusion",indicator:"Percentage of women aged 25-34 years old that have successfully completed secondary education",unit:"%",value:4,natural_value:.514},{category:"Inclusion",indicator:"Regulations for building construction and equipment, public transport for people with disabilities",unit:"Yes/No",value:5,natural_value:1},{category:"Inclusion",indicator:"Perception of inclusion index",unit:"index",value:4,natural_value:1.6419624913097781},{category:"Accountability",indicator:"City budget execution publication",unit:"Yes/No",value:5,natural_value:1},{category:"Accountability",indicator:"City budget publication",unit:"Yes/No",value:5,natural_value:1},{category:"Accountability",indicator:"Financial transparency on city government companies",unit:"Yes/No",value:1,natural_value:0},{category:"Accountability",indicator:"ISO certification",unit:"Yes/No",value:1,natural_value:0},{category:"Accountability",indicator:"City council checks and balances",unit:"Yes/No",value:1,natural_value:0},{category:"Accountability",indicator:"Plans to obtain ISO certification",unit:"Yes/No",value:1,natural_value:0},{category:"Accountability",indicator:"Perception of accountability index",unit:"index",value:2,natural_value:1.0203402004058097},{category:"City budget",indicator:"Poor financial condition",unit:"Yes/No",value:5,natural_value:0},{category:"City budget",indicator:"Central/higher level government financial intervention taking place",unit:"Yes/No",value:5,natural_value:0},{category:"City budget",indicator:"Long-term financial planning",unit:"Yes/No",value:1,natural_value:0},{category:"City budget",indicator:"Central/higher level government financial intervention is considered",unit:"Yes/No",value:1,natural_value:0},{category:"City budget",indicator:"Prudent fiscal policy requirements",unit:"Yes/No",value:1,natural_value:0},{category:"City budget",indicator:"Medium-term planning",unit:"Yes/No",value:5,natural_value:1},{category:"SME",indicator:"Number of SMEs per 100,000 population",unit:"per 100,000",value:1,natural_value:5341.05},{category:"SME",indicator:"Number of start-ups",unit:"start-ups",value:2,natural_value:3},{category:"SME",indicator:"Global Startup Ecosystem Index",unit:"index",value:1,natural_value:.143},{category:"SME",indicator:"Number of SMEs per capita/100 000 population (change in last 3 years)",unit:"%",value:3,natural_value:0},{category:"SME",indicator:"Number of start-ups (change in last 3 years)",unit:"%",value:5,natural_value:0},{category:"Public services",indicator:"Free phone to call the police, ambulance, firefighters",unit:"1,2,3,4,5",value:5,natural_value:1},{category:"Public services",indicator:"Services for working with citizens' appeals and complaint",unit:"Yes/No",value:5,natural_value:1},{category:"Public services",indicator:"E-gov services",unit:"Yes/No",value:5,natural_value:1},{category:"Public services",indicator:"Perception of public services index: Public Services",unit:"index",value:4,natural_value:1.398629594433814},{category:"Sustainability commitment",indicator:"City ESG reporting",unit:"Yes/No",value:1,natural_value:0},{category:"Sustainability commitment",indicator:"City ESG reporting verification",unit:"Yes/No",value:1,natural_value:0},{category:"Sustainability commitment",indicator:"ESG planning",unit:"Yes/No",value:1,natural_value:0},{category:"Sustainability commitment",indicator:"Plan with specific targets to develop and implement smart city principles",unit:"Yes/No",value:5,natural_value:1},{category:"Sustainability commitment",indicator:"Rollout and status of ESG / UN SDG training across the municipal/asset workforce",unit:"Yes/No",value:1,natural_value:0},{category:"Sustainability commitment",indicator:"City municipality involved in network or partnership promoting sustainable development (for example, C40 Cities network)",unit:"Yes/No",value:5,natural_value:1}]},{city:"Brazzaville",data:[{category:"Air pollution",indicator:"CO2 emissions",unit:"kt",value:4,natural_value:1.25},{category:"Air pollution",indicator:"CO2 emissions (change in last 3 years)",unit:"%",value:3,natural_value:1.2},{category:"Air pollution",indicator:"CO2 concentration",unit:"ppm",value:2,natural_value:453.6},{category:"Air pollution",indicator:"CO2 concentration (change in last 3 years)",unit:"%",value:3,natural_value:.2},{category:"Air pollution",indicator:"Annual average of SO2 concentration in ambient air",unit:"microgram/m3",value:4,natural_value:3.3},{category:"Air pollution",indicator:"Annual Average of SO2 Concentration in Ambient Air (change in last 3 years)",unit:"%",value:3,natural_value:23.5},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air",unit:"microgram/m3",value:4,natural_value:7.5},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air (change in last 3 years), microgram/m3",unit:"%",value:4,natural_value:-1.9},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air, microgram/m3",unit:"microgram/m3",value:4,natural_value:42.7},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air (change in last 3 years), microgram/m3",unit:"%",value:5,natural_value:-4.3},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air, microgram/m3",unit:"microgram/m3",value:2,natural_value:.7},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air (change in last 3 years), microgram/m3",unit:"%",value:4,natural_value:-1.8},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air, microgram/m3",unit:"microgram/m3",value:3,natural_value:85.2},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air (change in last 3 years), microgram/m3",unit:"%",value:3,natural_value:5},{category:"Air pollution",indicator:"Volatile organic compounds/reactive organic gases emissions",unit:"microgram/m3",value:3,natural_value:1.7},{category:"Air pollution",indicator:"Perception of air pollution index",unit:"index",value:5,natural_value:.73},{category:"Air pollution",indicator:"Paris Agreement",unit:"Yes/No",value:5,natural_value:1},{category:"Water pollution",indicator:"Annual average of dissolved oxygen (DO) concentration in water",unit:"%",value:5,natural_value:4.45},{category:"Water pollution",indicator:"Annual average of pH concentration in water",unit:"pH",value:5,natural_value:4.06},{category:"Water pollution",indicator:"Annual average dissolved solids in drinking-water",unit:"ppm",value:3,natural_value:139},{category:"Water pollution",indicator:"Water management strategy in a city",unit:"Yes/No",value:1,natural_value:0},{category:"Water pollution",indicator:"Perception of water pollution index",unit:"index",value:5,natural_value:.45536897331942433},{category:"Land use and waste",indicator:"Share of devastated and degraded land area requiring reclamation",unit:"%",value:5,natural_value:1.8},{category:"Land use and waste",indicator:"3-year average growth rate of devastated and degraded land area requiring reclamation",unit:"%",value:2,natural_value:.091},{category:"Land use and waste",indicator:"Waste deposits",unit:"%",value:5,natural_value:17e-5},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous)",unit:"kg per capita ",value:3,natural_value:184.6411523451221},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous), (change in last 3 years)",unit:"%",value:4,natural_value:1.08639431138},{category:"Land use and waste",indicator:"Total recycled construction waste",unit:"tons per capita",value:3,natural_value:.0202},{category:"Land use and waste",indicator:"Share of recycled construction and demolish waste in total generated construction and demolish waste",unit:"%",value:3,natural_value:.293},{category:"Land use and waste",indicator:"Total area of impervious surfaces and percentage to total city area",unit:"%",value:3,natural_value:.02},{category:"Land use and waste",indicator:"Productive urban land (in percent total land)",unit:"%",value:3,natural_value:32.2},{category:"Land use and waste",indicator:"Waste managenet strategy",unit:"Yes/No",value:1,natural_value:0},{category:"Land use and waste",indicator:"Perception of waste index",unit:"index",value:4,natural_value:1.810424467560072},{category:"Land use and waste",indicator:"Green spaces, % city area",unit:"%",value:2,natural_value:.0811},{category:"Land use and waste",indicator:"Green spaces, change in last 3 years",unit:"%",value:1,natural_value:-5.5},{category:"Land use and waste",indicator:"NDVI",unit:"%",value:4,natural_value:.15},{category:"Natural disaster hazards",indicator:"Share of total area with altitude above sea level less than 0,5 meters",unit:"%",value:5,natural_value:0},{category:"Natural disaster hazards",indicator:"Growth rate of freshwater mirror area",unit:"%",value:1,natural_value:-.3},{category:"Natural disaster hazards",indicator:"Number of registered heavy rain, flood and thunderbolt (change in last 3 years)",unit:"%",value:3,natural_value:-.0319126617675967},{category:"Natural disaster hazards",indicator:"Number of registered sand storm (change in last 3 years)",unit:"%",value:3,natural_value:-.0395901759852154},{category:"Natural disaster hazards",indicator:"Environmental/natural disasters’ risk mitigation",unit:"Yes/No",value:5,natural_value:1},{category:"Natural disaster hazards",indicator:"Strategy/policy/government officials’ statement on environmental issues ",unit:"Yes/No",value:5,natural_value:1},{category:"Natural disaster hazards",indicator:"Total overall losses from natural disaster hazards",unit:"US$ mln ",value:3,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of days with average daily temperature above the threshold for 1990-2010",unit:"days",value:3,natural_value:15},{category:"Natural disaster hazards",indicator:"Number of disruptions to basic services, attributed to disasters",unit:"%",value:3,natural_value:0},{category:"Water availability",indicator:"Water consumption per capita",unit:"mcm",value:2,natural_value:11437737370684483e-21},{category:"Water availability",indicator:"Water tariff to disposable income ratio",unit:"ratio",value:4,natural_value:.6},{category:"Water availability",indicator:"Sanitary facilities tariff to disposable income ratio",unit:"ratio",value:4,natural_value:.4},{category:"Water availability",indicator:"Water consumption per capita (change in last 3 years)",unit:"%",value:3,natural_value:-.015502986483292},{category:"Water availability",indicator:"Percentage of population with access to drinking water",unit:"%",value:2,natural_value:.736},{category:"Water availability",indicator:"Percentage of population with access to drinking water (change in last 3 years)",unit:"%",value:3,natural_value:.002},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities",unit:"%",value:3,natural_value:.204},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities (change in last 3 years)",unit:"%",value:2,natural_value:.003},{category:"Food availability",indicator:"Cereal import dependency ratio (5-years average)",unit:"%",value:2,natural_value:.939},{category:"Food availability",indicator:"Cereal import dependency ratio (change in last 3 years)",unit:"%",value:3,natural_value:.01425708551},{category:"Food availability",indicator:"Prevalence of undernourishment",unit:"%",value:3,natural_value:.056},{category:"Food availability",indicator:"Prevalence of undernourishment (change in last 3 years)",unit:"%",value:3,natural_value:.023},{category:"Food availability",indicator:"Prevalence of undernourishment children",unit:"%",value:3,natural_value:.357},{category:"Food availability",indicator:"Prevalence of undernourishment children (change in last 3 years)",unit:"%",value:3,natural_value:-.025},{category:"Food availability",indicator:"Prevalence of moderate or severe food insecurity in the population",unit:"%",value:1,natural_value:.884},{category:"Food availability",indicator:"Share of imports in food resources",unit:"%",value:3,natural_value:.36},{category:"Food availability",indicator:"Percentage of people with access to at least one food vendor/retailer within 15 minutes of walking",unit:"%",value:3,natural_value:91},{category:"Food availability",indicator:"Perception of food availability index",unit:"index",value:2,natural_value:1.7694823312081864},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity",unit:"%",value:2,natural_value:.486883850097656},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity (change in last 3 years)",unit:"%",value:3,natural_value:.013},{category:"Energy availability",indicator:"Consumption of electricity per capita",unit:"kWh/person",value:5,natural_value:233.8543925649949},{category:"Energy availability",indicator:"Consumption of electricity per capita (change in last 3 years)",unit:"%",value:1,natural_value:.212},{category:"Energy availability",indicator:"Electricity tariff to disposable income ratio",unit:"ratio",value:3,natural_value:.15757312},{category:"Energy availability",indicator:"Share of renewable sources in electricity consumption",unit:"%",value:3,natural_value:.21},{category:"Energy availability",indicator:"Perception of energy availability index",unit:"index",value:2,natural_value:1.4623815285284214},{category:"Health",indicator:"Child mortality rate (under 5 years-old)",unit:"% of live births ",value:5,natural_value:3.13},{category:"Health",indicator:"City ambulance",unit:"Yes/No",value:5,natural_value:1},{category:"Health",indicator:"Life expectancy at birth, years",unit:"Years",value:4,natural_value:63.35033333333333},{category:"Health",indicator:"Life expectancy at birth goals",unit:"categories",value:1,natural_value:1},{category:"Health",indicator:"Number of hospital beds per 1,000 population",unit:"per 1,000",value:4,natural_value:.8409929205874421},{category:"Health",indicator:"Number of doctors per 1,000 population",unit:"per 1,000",value:4,natural_value:.18714517624971974},{category:"Health",indicator:"Maternal mortality ratio",unit:"deaths per 1,000 live births",value:3,natural_value:49},{category:"Health",indicator:"Ambulance arrival speed, min",unit:"min",value:3,natural_value:70},{category:"Education",indicator:"Literacy rate among population (15-24 Years)",unit:"%",value:2,natural_value:.817762451171875},{category:"Education",indicator:"Literacy rate among population (15-24 Years) (change in last 3 years)",unit:"%",value:3,natural_value:.006},{category:"Education",indicator:"Primary education engagement",unit:"%",value:3,natural_value:.8437051},{category:"Education",indicator:"Pupils per teacher rate",unit:"ratio",value:1,natural_value:42.71358024691358},{category:"Education",indicator:"Proportion of population with post-secondary and higher education",unit:"%",value:4,natural_value:.377},{category:"Wealth",indicator:"Percentage of population with food expenditure is above 52% of total expenditure",unit:"%",value:3,natural_value:.156666666666667},{category:"Wealth",indicator:"Mean monthly salary",unit:"US dollars thousand",value:3,natural_value:1282.4291856666666},{category:"Wealth",indicator:"Mean monthly salary, change in last 3 years",unit:"%",value:3,natural_value:-.0266873352529554},{category:"Wealth",indicator:"Disposable monthly income",unit:"US dollars thousand",value:2,natural_value:302.3992620874996},{category:"Wealth",indicator:"Disposable monthly income (change in last 3 years)",unit:"%",value:4,natural_value:.0871101353185355},{category:"Wealth",indicator:"Debt to salary ratio",unit:"ratio",value:3,natural_value:8.072656977014631},{category:"Wealth",indicator:"Number of mobile phones per 1,000 population",unit:"per 1,000",value:1,natural_value:95.70893438666667},{category:"Wealth",indicator:"Decile income coefficient",unit:"ratio",value:4,natural_value:21.068749999999998},{category:"Wealth",indicator:"Decile income coefficient (change in last 3 years)",unit:"%",value:1,natural_value:.133082229475596},{category:"Wealth",indicator:"Poverty headcount ratio at national poverty lines",unit:"%",value:5,natural_value:19.3333333333333},{category:"Wealth",indicator:"Working poverty rate (percentage of employed living below US$1.90 PPP), 15+ age (%) ",unit:"%",value:4,natural_value:.011},{category:"Wealth",indicator:"Poverty headcount ratio at $2.15 PPP 2017 a day",unit:"%",value:4,natural_value:.0186666666666667},{category:"Wealth",indicator:"Living spaces per capita, sq m (change in last 3 years)",unit:"%",value:1,natural_value:0},{category:"Wealth",indicator:"Population living in slums (% of urban population)",unit:"%",value:3,natural_value:.17},{category:"Wealth",indicator:"Availability of finance (consumer loans)",unit:"%",value:3,natural_value:.5},{category:"Wealth",indicator:"Perception of wealth & poverty index",unit:"index",value:4,natural_value:.7426272126444186},{category:"Safety",indicator:"Road fatalities rate per 100,000 population",unit:"per 100,000",value:3,natural_value:29.166666666666668},{category:"Safety",indicator:"Road fatalities rate per 100,000 population (change in last 3 years)",unit:"%",value:3,natural_value:.013},{category:"Safety",indicator:"Violent crime rate per 100,000 population",unit:"per 100,000",value:2,natural_value:34.750798202781176},{category:"Safety",indicator:"Violent crime rate per 100,000 population (change in last 3 years)",unit:"%",value:3,natural_value:-.00195060506205014},{category:"Safety",indicator:"Crime rate per 100,000 population",unit:"per 100,000",value:3,natural_value:511.29593711362435},{category:"Safety",indicator:"Crime rate per 100,000 population  (change in last 3 years)",unit:"%",value:4,natural_value:-.00195060506205014},{category:"Safety",indicator:"Police arrival speed",unit:"min",value:2,natural_value:31},{category:"Safety",indicator:"Perception of safety index",unit:"index",value:5,natural_value:1.7149999999999999},{category:"Livability",indicator:"Number of LEED certified green buildings",unit:"Certified square meters per capita",value:2,natural_value:.001253900252388248},{category:"Livability",indicator:"Number of BREEAM certified projects",unit:"Certified square meters per capita",value:1,natural_value:0},{category:"Livability",indicator:"Whether or not the city has ISO 37120 certification",unit:"Yes/No",value:1,natural_value:0},{category:"Livability",indicator:"Mobile connection coverage",unit:"%",value:1,natural_value:.548333333333333},{category:"Livability",indicator:"Internet coverage",unit:"%",value:1,natural_value:.548333333333333},{category:"Livability",indicator:"Perception of livability index",unit:"index",value:4,natural_value:.9380400918704376},{category:"Livability",indicator:"Share of population in 1 km from schools",unit:"%",value:4,natural_value:98.6},{category:"Livability",indicator:"Share of population in 1 km from parks",unit:"%",value:1,natural_value:32.8},{category:"Transport",indicator:"Time loss in traffic",unit:"%",value:1,natural_value:15.7},{category:"Transport",indicator:"Share of the population in 1 km from public transport stop",unit:"%",value:2,natural_value:52.5},{category:"Transport",indicator:"Ratio of the cost of monthly public transport usage Ithe cheapest option) to average mobthly income",unit:"ratio",value:3,natural_value:.04},{category:"Transport",indicator:"Ratio of the cost of a 1-kilometer taxi ride to average mobthly income",unit:"%",value:3,natural_value:.04},{category:"Transport",indicator:"Percentage of city's roads that are segregated and/or has specialized lane for cyclists",unit:"%",value:3,natural_value:.06},{category:"Transport",indicator:"Number of public electric vehicle (EV) charging points per 100,000 population",unit:"per 100,000",value:3,natural_value:1.4},{category:"Transport",indicator:"Public transport (excluding subway) operates by schedule ",unit:"Yes/No",value:5,natural_value:1},{category:"Transport",indicator:"Perception of transport index",unit:"index",value:4,natural_value:.9380400918704376},{category:"Inclusion",indicator:"Female-friendly city",unit:"1,2,3,4,5",value:4,natural_value:"2"},{category:"Inclusion",indicator:"Number of refugees per 1,000 population",unit:"per 1,000",value:3,natural_value:9.399},{category:"Inclusion",indicator:"Homeless people per 1,000 population",unit:"per 1,000",value:1,natural_value:73.28310431478172},{category:"Inclusion",indicator:"Difference in number of years of schooling between woman and man, woman to man ratio ",unit:"years",value:3,natural_value:1.05},{category:"Inclusion",indicator:"Slavery index",unit:"index",value:4,natural_value:8},{category:"Inclusion",indicator:"Percentage of women aged 25-34 years old that have successfully completed secondary education",unit:"%",value:4,natural_value:.542},{category:"Inclusion",indicator:"Regulations for building construction and equipment, public transport for people with disabilities",unit:"Yes/No",value:1,natural_value:0},{category:"Inclusion",indicator:"Perception of inclusion index",unit:"index",value:5,natural_value:.8545100144780505},{category:"Accountability",indicator:"City budget execution publication",unit:"Yes/No",value:1,natural_value:0},{category:"Accountability",indicator:"City budget publication",unit:"Yes/No",value:1,natural_value:0},{category:"Accountability",indicator:"Financial transparency on city government companies",unit:"Yes/No",value:1,natural_value:0},{category:"Accountability",indicator:"ISO certification",unit:"Yes/No",value:1,natural_value:0},{category:"Accountability",indicator:"City council checks and balances",unit:"Yes/No",value:1,natural_value:0},{category:"Accountability",indicator:"Plans to obtain ISO certification",unit:"Yes/No",value:1,natural_value:0},{category:"Accountability",indicator:"Perception of accountability index",unit:"index",value:5,natural_value:.3307362014059618},{category:"City budget",indicator:"Poor financial condition",unit:"Yes/No",value:1,natural_value:1},{category:"City budget",indicator:"Central/higher level government financial intervention taking place",unit:"Yes/No",value:5,natural_value:0},{category:"City budget",indicator:"Long-term financial planning",unit:"Yes/No",value:1,natural_value:0},{category:"City budget",indicator:"Central/higher level government financial intervention is considered",unit:"Yes/No",value:1,natural_value:0},{category:"City budget",indicator:"Prudent fiscal policy requirements",unit:"Yes/No",value:1,natural_value:0},{category:"City budget",indicator:"Medium-term planning",unit:"Yes/No",value:5,natural_value:1},{category:"SME",indicator:"Number of SMEs per 100,000 population",unit:"per 100,000",value:3,natural_value:44.353002254907814},{category:"SME",indicator:"Number of start-ups",unit:"start-ups",value:5,natural_value:2},{category:"SME",indicator:"Global Startup Ecosystem Index",unit:"index",value:1,natural_value:0},{category:"SME",indicator:"Number of SMEs per capita/100 000 population (change in last 3 years)",unit:"%",value:3,natural_value:0},{category:"SME",indicator:"Number of start-ups (change in last 3 years)",unit:"%",value:5,natural_value:0},{category:"Public services",indicator:"Free phone to call the police, ambulance, firefighters",unit:"1,2,3,4,5",value:5,natural_value:1},{category:"Public services",indicator:"Services for working with citizens' appeals and complaint",unit:"Yes/No",value:5,natural_value:1},{category:"Public services",indicator:"E-gov services",unit:"Yes/No",value:5,natural_value:1},{category:"Public services",indicator:"Perception of public services index: Public Services",unit:"index",value:5,natural_value:.6852289874246976},{category:"Sustainability commitment",indicator:"City ESG reporting",unit:"Yes/No",value:1,natural_value:0},{category:"Sustainability commitment",indicator:"City ESG reporting verification",unit:"Yes/No",value:1,natural_value:0},{category:"Sustainability commitment",indicator:"ESG planning",unit:"Yes/No",value:1,natural_value:0},{category:"Sustainability commitment",indicator:"Plan with specific targets to develop and implement smart city principles",unit:"Yes/No",value:1,natural_value:0},{category:"Sustainability commitment",indicator:"Rollout and status of ESG / UN SDG training across the municipal/asset workforce",unit:"Yes/No",value:1,natural_value:0},{category:"Sustainability commitment",indicator:"City municipality involved in network or partnership promoting sustainable development (for example, C40 Cities network)",unit:"Yes/No",value:1,natural_value:0}]},{city:"Almaty",data:[{category:"Air pollution",indicator:"CO2 emissions",unit:"kt",value:2,natural_value:11.3},{category:"Air pollution",indicator:"CO2 emissions (change in last 3 years)",unit:"%",value:3,natural_value:.6},{category:"Air pollution",indicator:"CO2 concentration",unit:"ppm",value:3,natural_value:433.9},{category:"Air pollution",indicator:"CO2 concentration (change in last 3 years)",unit:"%",value:3,natural_value:2.1},{category:"Air pollution",indicator:"Annual average of SO2 concentration in ambient air",unit:"microgram/m3",value:4,natural_value:7.2},{category:"Air pollution",indicator:"Annual Average of SO2 Concentration in Ambient Air (change in last 3 years)",unit:"%",value:4,natural_value:-28.2},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air",unit:"microgram/m3",value:5,natural_value:9.2},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air (change in last 3 years), microgram/m3",unit:"%",value:4,natural_value:-1.3},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air, microgram/m3",unit:"microgram/m3",value:2,natural_value:76.6},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air (change in last 3 years), microgram/m3",unit:"%",value:5,natural_value:-5.5},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air, microgram/m3",unit:"microgram/m3",value:4,natural_value:.2},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air (change in last 3 years), microgram/m3",unit:"%",value:4,natural_value:-4.9},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air, microgram/m3",unit:"microgram/m3",value:5,natural_value:18.6},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air (change in last 3 years), microgram/m3",unit:"%",value:5,natural_value:-11.3},{category:"Air pollution",indicator:"Volatile organic compounds/reactive organic gases emissions",unit:"microgram/m3",value:4,natural_value:1.2},{category:"Air pollution",indicator:"Perception of air pollution index",unit:"index",value:3,natural_value:1.77},{category:"Air pollution",indicator:"Paris Agreement",unit:"Yes/No",value:5,natural_value:1},{category:"Water pollution",indicator:"Annual average of dissolved oxygen (DO) concentration in water",unit:"%",value:3,natural_value:6.32},{category:"Water pollution",indicator:"Annual average of pH concentration in water",unit:"pH",value:2,natural_value:7.933333333333334},{category:"Water pollution",indicator:"Annual average dissolved solids in drinking-water",unit:"ppm",value:3,natural_value:139},{category:"Water pollution",indicator:"Water management strategy in a city",unit:"Yes/No",value:5,natural_value:1},{category:"Water pollution",indicator:"Perception of water pollution index",unit:"index",value:2,natural_value:2.4280063619803385},{category:"Land use and waste",indicator:"Share of devastated and degraded land area requiring reclamation",unit:"%",value:5,natural_value:1.7},{category:"Land use and waste",indicator:"3-year average growth rate of devastated and degraded land area requiring reclamation",unit:"%",value:4,natural_value:-.05},{category:"Land use and waste",indicator:"Waste deposits",unit:"%",value:5,natural_value:21e-5},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous)",unit:"kg per capita ",value:3,natural_value:218.70589992818873},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous), (change in last 3 years)",unit:"%",value:4,natural_value:2.06527603657},{category:"Land use and waste",indicator:"Total recycled construction waste",unit:"tons per capita",value:3,natural_value:.0202},{category:"Land use and waste",indicator:"Share of recycled construction and demolish waste in total generated construction and demolish waste",unit:"%",value:2,natural_value:.018},{category:"Land use and waste",indicator:"Total area of impervious surfaces and percentage to total city area",unit:"%",value:3,natural_value:.02},{category:"Land use and waste",indicator:"Productive urban land (in percent total land)",unit:"%",value:3,natural_value:32.2},{category:"Land use and waste",indicator:"Waste managenet strategy",unit:"Yes/No",value:1,natural_value:0},{category:"Land use and waste",indicator:"Perception of waste index",unit:"index",value:4,natural_value:3.672950776137062},{category:"Land use and waste",indicator:"Green spaces, % city area",unit:"%",value:3,natural_value:.2334},{category:"Land use and waste",indicator:"Green spaces, change in last 3 years",unit:"%",value:4,natural_value:1.8},{category:"Land use and waste",indicator:"NDVI",unit:"%",value:4,natural_value:.18},{category:"Natural disaster hazards",indicator:"Share of total area with altitude above sea level less than 0,5 meters",unit:"%",value:5,natural_value:0},{category:"Natural disaster hazards",indicator:"Growth rate of freshwater mirror area",unit:"%",value:5,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of registered heavy rain, flood and thunderbolt (change in last 3 years)",unit:"%",value:2,natural_value:.0971033487259057},{category:"Natural disaster hazards",indicator:"Number of registered sand storm (change in last 3 years)",unit:"%",value:2,natural_value:.310370697104448},{category:"Natural disaster hazards",indicator:"Environmental/natural disasters’ risk mitigation",unit:"Yes/No",value:5,natural_value:1},{category:"Natural disaster hazards",indicator:"Strategy/policy/government officials’ statement on environmental issues ",unit:"Yes/No",value:5,natural_value:1},{category:"Natural disaster hazards",indicator:"Total overall losses from natural disaster hazards",unit:"US$ mln ",value:3,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of days with average daily temperature above the threshold for 1990-2010",unit:"days",value:3,natural_value:15},{category:"Natural disaster hazards",indicator:"Number of disruptions to basic services, attributed to disasters",unit:"%",value:3,natural_value:0},{category:"Water availability",indicator:"Water consumption per capita",unit:"mcm",value:4,natural_value:3.483},{category:"Water availability",indicator:"Water tariff to disposable income ratio",unit:"ratio",value:3,natural_value:1.2},{category:"Water availability",indicator:"Sanitary facilities tariff to disposable income ratio",unit:"ratio",value:5,natural_value:.056},{category:"Water availability",indicator:"Water consumption per capita (change in last 3 years)",unit:"%",value:3,natural_value:-.005},{category:"Water availability",indicator:"Percentage of population with access to drinking water",unit:"%",value:3,natural_value:.976},{category:"Water availability",indicator:"Percentage of population with access to drinking water (change in last 3 years)",unit:"%",value:3,natural_value:.003},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities",unit:"%",value:3,natural_value:.722},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities (change in last 3 years)",unit:"%",value:3,natural_value:.024},{category:"Food availability",indicator:"Cereal import dependency ratio (5-years average)",unit:"%",value:5,natural_value:-.823333333333333},{category:"Food availability",indicator:"Cereal import dependency ratio (change in last 3 years)",unit:"%",value:3,natural_value:.0689057773},{category:"Food availability",indicator:"Prevalence of undernourishment",unit:"%",value:3,natural_value:.056},{category:"Food availability",indicator:"Prevalence of undernourishment (change in last 3 years)",unit:"%",value:1,natural_value:.223},{category:"Food availability",indicator:"Prevalence of undernourishment children",unit:"%",value:3,natural_value:.357},{category:"Food availability",indicator:"Prevalence of undernourishment children (change in last 3 years)",unit:"%",value:2,natural_value:-.055},{category:"Food availability",indicator:"Prevalence of moderate or severe food insecurity in the population",unit:"%",value:5,natural_value:.052},{category:"Food availability",indicator:"Share of imports in food resources",unit:"%",value:3,natural_value:.36},{category:"Food availability",indicator:"Percentage of people with access to at least one food vendor/retailer within 15 minutes of walking",unit:"%",value:3,natural_value:91},{category:"Food availability",indicator:"Perception of food availability index",unit:"index",value:4,natural_value:2.7911336002553444},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity",unit:"%",value:5,natural_value:1},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity (change in last 3 years)",unit:"%",value:3,natural_value:0},{category:"Energy availability",indicator:"Consumption of electricity per capita",unit:"kWh/person",value:4,natural_value:744.0523414104803},{category:"Energy availability",indicator:"Consumption of electricity per capita (change in last 3 years)",unit:"%",value:4,natural_value:0},{category:"Energy availability",indicator:"Electricity tariff to disposable income ratio",unit:"ratio",value:4,natural_value:.046000000000000006},{category:"Energy availability",indicator:"Share of renewable sources in electricity consumption",unit:"%",value:3,natural_value:.21},{category:"Energy availability",indicator:"Perception of energy availability index",unit:"index",value:1,natural_value:2.215077404374128},{category:"Health",indicator:"Child mortality rate (under 5 years-old)",unit:"% of live births ",value:5,natural_value:.949666666666667},{category:"Health",indicator:"City ambulance",unit:"Yes/No",value:5,natural_value:1},{category:"Health",indicator:"Life expectancy at birth, years",unit:"Years",value:3,natural_value:74.43666666666667},{category:"Health",indicator:"Life expectancy at birth goals",unit:"categories",value:5,natural_value:3},{category:"Health",indicator:"Number of hospital beds per 1,000 population",unit:"per 1,000",value:2,natural_value:5.311479254299262},{category:"Health",indicator:"Number of doctors per 1,000 population",unit:"per 1,000",value:3,natural_value:6.822767921629207},{category:"Health",indicator:"Maternal mortality ratio",unit:"deaths per 1,000 live births",value:3,natural_value:49},{category:"Health",indicator:"Ambulance arrival speed, min",unit:"min",value:3,natural_value:70},{category:"Education",indicator:"Literacy rate among population (15-24 Years)",unit:"%",value:5,natural_value:.998982416788737},{category:"Education",indicator:"Literacy rate among population (15-24 Years) (change in last 3 years)",unit:"%",value:3,natural_value:0},{category:"Education",indicator:"Primary education engagement",unit:"%",value:5,natural_value:.961578066666667},{category:"Education",indicator:"Pupils per teacher rate",unit:"ratio",value:3,natural_value:18.502333333333333},{category:"Education",indicator:"Proportion of population with post-secondary and higher education",unit:"%",value:5,natural_value:.634474207560221},{category:"Wealth",indicator:"Percentage of population with food expenditure is above 52% of total expenditure",unit:"%",value:3,natural_value:.14},{category:"Wealth",indicator:"Mean monthly salary",unit:"US dollars thousand",value:3,natural_value:2901.12},{category:"Wealth",indicator:"Mean monthly salary, change in last 3 years",unit:"%",value:5,natural_value:.0970823344626255},{category:"Wealth",indicator:"Disposable monthly income",unit:"US dollars thousand",value:3,natural_value:521.0737469923129},{category:"Wealth",indicator:"Disposable monthly income (change in last 3 years)",unit:"%",value:3,natural_value:-.0155428529827583},{category:"Wealth",indicator:"Debt to salary ratio",unit:"ratio",value:4,natural_value:2.6836602741196},{category:"Wealth",indicator:"Number of mobile phones per 1,000 population",unit:"per 1,000",value:2,natural_value:90.56666666666668},{category:"Wealth",indicator:"Decile income coefficient",unit:"ratio",value:5,natural_value:5.4751039235044985},{category:"Wealth",indicator:"Decile income coefficient (change in last 3 years)",unit:"%",value:3,natural_value:-.036},{category:"Wealth",indicator:"Poverty headcount ratio at national poverty lines",unit:"%",value:3,natural_value:.186666666666667},{category:"Wealth",indicator:"Working poverty rate (percentage of employed living below US$1.90 PPP), 15+ age (%) ",unit:"%",value:4,natural_value:.0156666666666667},{category:"Wealth",indicator:"Poverty headcount ratio at $2.15 PPP 2017 a day",unit:"%",value:4,natural_value:.0163333333333333},{category:"Wealth",indicator:"Living spaces per capita, sq m (change in last 3 years)",unit:"%",value:2,natural_value:.0117657852745596},{category:"Wealth",indicator:"Population living in slums (% of urban population)",unit:"%",value:3,natural_value:.17},{category:"Wealth",indicator:"Availability of finance (consumer loans)",unit:"%",value:3,natural_value:.5},{category:"Wealth",indicator:"Perception of wealth & poverty index",unit:"index",value:1,natural_value:1.7232024487028685},{category:"Safety",indicator:"Road fatalities rate per 100,000 population",unit:"per 100,000",value:4,natural_value:8.586666666666666},{category:"Safety",indicator:"Road fatalities rate per 100,000 population (change in last 3 years)",unit:"%",value:1,natural_value:-.224},{category:"Safety",indicator:"Violent crime rate per 100,000 population",unit:"per 100,000",value:4,natural_value:3.3666666666666667},{category:"Safety",indicator:"Violent crime rate per 100,000 population (change in last 3 years)",unit:"%",value:5,natural_value:-.084},{category:"Safety",indicator:"Crime rate per 100,000 population",unit:"per 100,000",value:3,natural_value:1605},{category:"Safety",indicator:"Crime rate per 100,000 population  (change in last 3 years)",unit:"%",value:1,natural_value:-.084},{category:"Safety",indicator:"Police arrival speed",unit:"min",value:2,natural_value:26},{category:"Safety",indicator:"Perception of safety index",unit:"index",value:2,natural_value:3.2249999999999996},{category:"Livability",indicator:"Number of LEED certified green buildings",unit:"Certified square meters per capita",value:2,natural_value:0},{category:"Livability",indicator:"Number of BREEAM certified projects",unit:"Certified square meters per capita",value:1,natural_value:0},{category:"Livability",indicator:"Whether or not the city has ISO 37120 certification",unit:"Yes/No",value:1,natural_value:0},{category:"Livability",indicator:"Mobile connection coverage",unit:"%",value:2,natural_value:.922},{category:"Livability",indicator:"Internet coverage",unit:"%",value:2,natural_value:.880666666666667},{category:"Livability",indicator:"Perception of livability index",unit:"index",value:1,natural_value:4.173213808617591},{category:"Livability",indicator:"Share of population in 1 km from schools",unit:"%",value:4,natural_value:97},{category:"Livability",indicator:"Share of population in 1 km from parks",unit:"%",value:3,natural_value:70.1},{category:"Transport",indicator:"Time loss in traffic",unit:"%",value:2,natural_value:60.7},{category:"Transport",indicator:"Share of the population in 1 km from public transport stop",unit:"%",value:3,natural_value:75.4},{category:"Transport",indicator:"Ratio of the cost of monthly public transport usage Ithe cheapest option) to average mobthly income",unit:"ratio",value:3,natural_value:.04},{category:"Transport",indicator:"Ratio of the cost of a 1-kilometer taxi ride to average mobthly income",unit:"%",value:3,natural_value:.04},{category:"Transport",indicator:"Percentage of city's roads that are segregated and/or has specialized lane for cyclists",unit:"%",value:3,natural_value:.06},{category:"Transport",indicator:"Number of public electric vehicle (EV) charging points per 100,000 population",unit:"per 100,000",value:3,natural_value:1.4},{category:"Transport",indicator:"Public transport (excluding subway) operates by schedule ",unit:"Yes/No",value:5,natural_value:1},{category:"Transport",indicator:"Perception of transport index",unit:"index",value:1,natural_value:4.173213808617591},{category:"Inclusion",indicator:"Female-friendly city",unit:"1,2,3,4,5",value:3,natural_value:"3"},{category:"Inclusion",indicator:"Number of refugees per 1,000 population",unit:"per 1,000",value:3,natural_value:4.1},{category:"Inclusion",indicator:"Homeless people per 1,000 population",unit:"per 1,000",value:3,natural_value:1.889719188959608},{category:"Inclusion",indicator:"Difference in number of years of schooling between woman and man, woman to man ratio ",unit:"years",value:3,natural_value:1.05},{category:"Inclusion",indicator:"Slavery index",unit:"index",value:3,natural_value:"11,1"},{category:"Inclusion",indicator:"Percentage of women aged 25-34 years old that have successfully completed secondary education",unit:"%",value:5,natural_value:.6729999999999999},{category:"Inclusion",indicator:"Regulations for building construction and equipment, public transport for people with disabilities",unit:"Yes/No",value:5,natural_value:1},{category:"Inclusion",indicator:"Perception of inclusion index",unit:"index",value:4,natural_value:1.6634254646800826},{category:"Accountability",indicator:"City budget execution publication",unit:"Yes/No",value:5,natural_value:1},{category:"Accountability",indicator:"City budget publication",unit:"Yes/No",value:5,natural_value:1},{category:"Accountability",indicator:"Financial transparency on city government companies",unit:"Yes/No",value:1,natural_value:0},{category:"Accountability",indicator:"ISO certification",unit:"Yes/No",value:1,natural_value:0},{category:"Accountability",indicator:"City council checks and balances",unit:"Yes/No",value:5,natural_value:1},{category:"Accountability",indicator:"Plans to obtain ISO certification",unit:"Yes/No",value:5,natural_value:1},{category:"Accountability",indicator:"Perception of accountability index",unit:"index",value:1,natural_value:1.359106447444682},{category:"City budget",indicator:"Poor financial condition",unit:"Yes/No",value:5,natural_value:0},{category:"City budget",indicator:"Central/higher level government financial intervention taking place",unit:"Yes/No",value:5,natural_value:0},{category:"City budget",indicator:"Long-term financial planning",unit:"Yes/No",value:1,natural_value:0},{category:"City budget",indicator:"Central/higher level government financial intervention is considered",unit:"Yes/No",value:1,natural_value:0},{category:"City budget",indicator:"Prudent fiscal policy requirements",unit:"Yes/No",value:5,natural_value:1},{category:"City budget",indicator:"Medium-term planning",unit:"Yes/No",value:5,natural_value:1},{category:"SME",indicator:"Number of SMEs per 100,000 population",unit:"per 100,000",value:1,natural_value:11505.543278417088},{category:"SME",indicator:"Number of start-ups",unit:"start-ups",value:2,natural_value:7567.666666666667},{category:"SME",indicator:"Global Startup Ecosystem Index",unit:"index",value:1,natural_value:0},{category:"SME",indicator:"Number of SMEs per capita/100 000 population (change in last 3 years)",unit:"%",value:3,natural_value:0},{category:"SME",indicator:"Number of start-ups (change in last 3 years)",unit:"%",value:3,natural_value:0},{category:"Public services",indicator:"Free phone to call the police, ambulance, firefighters",unit:"1,2,3,4,5",value:5,natural_value:1},{category:"Public services",indicator:"Services for working with citizens' appeals and complaint",unit:"Yes/No",value:5,natural_value:1},{category:"Public services",indicator:"E-gov services",unit:"Yes/No",value:5,natural_value:1},{category:"Public services",indicator:"Perception of public services index: Public Services",unit:"index",value:2,natural_value:2.7906076049115165},{category:"Sustainability commitment",indicator:"City ESG reporting",unit:"Yes/No",value:1,natural_value:0},{category:"Sustainability commitment",indicator:"City ESG reporting verification",unit:"Yes/No",value:1,natural_value:0},{category:"Sustainability commitment",indicator:"ESG planning",unit:"Yes/No",value:1,natural_value:0},{category:"Sustainability commitment",indicator:"Plan with specific targets to develop and implement smart city principles",unit:"Yes/No",value:5,natural_value:1},{category:"Sustainability commitment",indicator:"Rollout and status of ESG / UN SDG training across the municipal/asset workforce",unit:"Yes/No",value:1,natural_value:0},{category:"Sustainability commitment",indicator:"City municipality involved in network or partnership promoting sustainable development (for example, C40 Cities network)",unit:"Yes/No",value:5,natural_value:1}]},{city:"Cape Town",data:[{category:"Air pollution",indicator:"CO2 emissions",unit:"kt",value:4,natural_value:1.83141622},{category:"Air pollution",indicator:"CO2 emissions (change in last 3 years)",unit:"%",value:3,natural_value:.038347905482194224},{category:"Air pollution",indicator:"CO2 concentration",unit:"ppm",value:5,natural_value:410.982591},{category:"Air pollution",indicator:"CO2 concentration (change in last 3 years)",unit:"%",value:5,natural_value:.00947134212255332},{category:"Air pollution",indicator:"Annual average of SO2 concentration in ambient air",unit:"microgram/m3",value:4,natural_value:2.959491114},{category:"Air pollution",indicator:"Annual Average of SO2 Concentration in Ambient Air (change in last 3 years)",unit:"%",value:3,natural_value:.053096182207327494},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air",unit:"microgram/m3",value:3,natural_value:12.6},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air (change in last 3 years), microgram/m3",unit:"%",value:3,natural_value:.05843338090840398},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air, microgram/m3",unit:"microgram/m3",value:5,natural_value:41.0593754},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air (change in last 3 years), microgram/m3",unit:"%",value:3,natural_value:.004064526034607794},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air, microgram/m3",unit:"microgram/m3",value:4,natural_value:.183141622},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air (change in last 3 years), microgram/m3",unit:"%",value:3,natural_value:.038347905482194224},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air, microgram/m3",unit:"microgram/m3",value:4,natural_value:30.61868568},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air (change in last 3 years), microgram/m3",unit:"%",value:3,natural_value:.06188768470920251},{category:"Air pollution",indicator:"Volatile organic compounds/reactive organic gases emissions",unit:"microgram/m3",value:3,natural_value:1.7},{category:"Air pollution",indicator:"Perception of air pollution index",unit:"index",value:3,natural_value:1.6},{category:"Air pollution",indicator:"Paris Agreement",unit:"Yes/No",value:5,natural_value:1},{category:"Water pollution",indicator:"Annual average of dissolved oxygen (DO) concentration in water",unit:"%",value:1,natural_value:7.4},{category:"Water pollution",indicator:"Annual average of pH concentration in water",unit:"pH",value:1,natural_value:8.608333333333334},{category:"Water pollution",indicator:"Annual average dissolved solids in drinking-water",unit:"ppm",value:2,natural_value:246.15384615384616},{category:"Water pollution",indicator:"Water management strategy in a city",unit:"Yes/No",value:5,natural_value:1},{category:"Water pollution",indicator:"Perception of water pollution index",unit:"index",value:3,natural_value:1.9},{category:"Land use and waste",indicator:"Share of devastated and degraded land area requiring reclamation",unit:"%",value:3,natural_value:7},{category:"Land use and waste",indicator:"3-year average growth rate of devastated and degraded land area requiring reclamation",unit:"%",value:3,natural_value:.002},{category:"Land use and waste",indicator:"Waste deposits",unit:"%",value:3,natural_value:.005},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous)",unit:"kg per capita ",value:3,natural_value:487.0252454957336},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous), (change in last 3 years)",unit:"%",value:4,natural_value:-.10465563349646823},{category:"Land use and waste",indicator:"Total recycled construction waste",unit:"tons per capita",value:2,natural_value:.007102473498233216},{category:"Land use and waste",indicator:"Share of recycled construction and demolish waste in total generated construction and demolish waste",unit:"%",value:2,natural_value:.1},{category:"Land use and waste",indicator:"Total area of impervious surfaces and percentage to total city area",unit:"%",value:3,natural_value:.02},{category:"Land use and waste",indicator:"Productive urban land (in percent total land)",unit:"%",value:3,natural_value:32.2},{category:"Land use and waste",indicator:"Waste managenet strategy",unit:"Yes/No",value:5,natural_value:1},{category:"Land use and waste",indicator:"Perception of waste index",unit:"index",value:2,natural_value:2.3},{category:"Land use and waste",indicator:"Green spaces, % city area",unit:"%",value:3,natural_value:.24},{category:"Land use and waste",indicator:"Green spaces, change in last 3 years",unit:"%",value:3,natural_value:-.06},{category:"Land use and waste",indicator:"NDVI",unit:"%",value:3,natural_value:.334},{category:"Natural disaster hazards",indicator:"Share of total area with altitude above sea level less than 0,5 meters",unit:"%",value:3,natural_value:.085},{category:"Natural disaster hazards",indicator:"Growth rate of freshwater mirror area",unit:"%",value:3,natural_value:-.06},{category:"Natural disaster hazards",indicator:"Number of registered heavy rain, flood and thunderbolt (change in last 3 years)",unit:"%",value:3,natural_value:.006622709560113016},{category:"Natural disaster hazards",indicator:"Number of registered sand storm (change in last 3 years)",unit:"%",value:3,natural_value:.006622709560113016},{category:"Natural disaster hazards",indicator:"Environmental/natural disasters’ risk mitigation",unit:"Yes/No",value:5,natural_value:1},{category:"Natural disaster hazards",indicator:"Strategy/policy/government officials’ statement on environmental issues ",unit:"Yes/No",value:5,natural_value:1},{category:"Natural disaster hazards",indicator:"Total overall losses from natural disaster hazards",unit:"US$ mln ",value:3,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of days with average daily temperature above the threshold for 1990-2010",unit:"days",value:4,natural_value:8},{category:"Natural disaster hazards",indicator:"Number of disruptions to basic services, attributed to disasters",unit:"%",value:3,natural_value:0},{category:"Water availability",indicator:"Water consumption per capita",unit:"mcm",value:3,natural_value:.0006548780200194737},{category:"Water availability",indicator:"Water tariff to disposable income ratio",unit:"ratio",value:3,natural_value:1.943333333},{category:"Water availability",indicator:"Sanitary facilities tariff to disposable income ratio",unit:"ratio",value:3,natural_value:1.626},{category:"Water availability",indicator:"Water consumption per capita (change in last 3 years)",unit:"%",value:3,natural_value:.001543290127960395},{category:"Water availability",indicator:"Percentage of population with access to drinking water",unit:"%",value:3,natural_value:.939},{category:"Water availability",indicator:"Percentage of population with access to drinking water (change in last 3 years)",unit:"%",value:3,natural_value:.002856138323718005},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities",unit:"%",value:3,natural_value:.785},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities (change in last 3 years)",unit:"%",value:3,natural_value:.007762276945399327},{category:"Food availability",indicator:"Cereal import dependency ratio (5-years average)",unit:"%",value:3,natural_value:.1336},{category:"Food availability",indicator:"Cereal import dependency ratio (change in last 3 years)",unit:"%",value:5,natural_value:-.19939738387128758},{category:"Food availability",indicator:"Prevalence of undernourishment",unit:"%",value:2,natural_value:.079},{category:"Food availability",indicator:"Prevalence of undernourishment (change in last 3 years)",unit:"%",value:3,natural_value:.018000000000000002},{category:"Food availability",indicator:"Prevalence of undernourishment children",unit:"%",value:4,natural_value:.121},{category:"Food availability",indicator:"Prevalence of undernourishment children (change in last 3 years)",unit:"%",value:3,natural_value:-.010782511350259871},{category:"Food availability",indicator:"Prevalence of moderate or severe food insecurity in the population",unit:"%",value:3,natural_value:.213},{category:"Food availability",indicator:"Share of imports in food resources",unit:"%",value:4,natural_value:.078},{category:"Food availability",indicator:"Percentage of people with access to at least one food vendor/retailer within 15 minutes of walking",unit:"%",value:3,natural_value:91},{category:"Food availability",indicator:"Perception of food availability index",unit:"index",value:3,natural_value:2.2},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity",unit:"%",value:3,natural_value:.873669662475586},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity (change in last 3 years)",unit:"%",value:3,natural_value:.0003793691719999881},{category:"Energy availability",indicator:"Consumption of electricity per capita",unit:"kWh/person",value:3,natural_value:1791.8035267072164},{category:"Energy availability",indicator:"Consumption of electricity per capita (change in last 3 years)",unit:"%",value:5,natural_value:-.03615737083310333},{category:"Energy availability",indicator:"Electricity tariff to disposable income ratio",unit:"ratio",value:4,natural_value:.038868},{category:"Energy availability",indicator:"Share of renewable sources in electricity consumption",unit:"%",value:1,natural_value:.0976},{category:"Energy availability",indicator:"Perception of energy availability index",unit:"index",value:3,natural_value:1.07},{category:"Health",indicator:"Child mortality rate (under 5 years-old)",unit:"% of live births ",value:1,natural_value:32.85},{category:"Health",indicator:"City ambulance",unit:"Yes/No",value:5,natural_value:1},{category:"Health",indicator:"Life expectancy at birth, years",unit:"Years",value:5,natural_value:62.341},{category:"Health",indicator:"Life expectancy at birth goals",unit:"categories",value:5,natural_value:3},{category:"Health",indicator:"Number of hospital beds per 1,000 population",unit:"per 1,000",value:3,natural_value:1.9},{category:"Health",indicator:"Number of doctors per 1,000 population",unit:"per 1,000",value:3,natural_value:4.600528619222334},{category:"Health",indicator:"Maternal mortality ratio",unit:"deaths per 1,000 live births",value:3,natural_value:82.4},{category:"Health",indicator:"Ambulance arrival speed, min",unit:"min",value:3,natural_value:70},{category:"Education",indicator:"Literacy rate among population (15-24 Years)",unit:"%",value:3,natural_value:.971},{category:"Education",indicator:"Literacy rate among population (15-24 Years) (change in last 3 years)",unit:"%",value:1,natural_value:-.0064386739444597385},{category:"Education",indicator:"Primary education engagement",unit:"%",value:5,natural_value:.9547},{category:"Education",indicator:"Pupils per teacher rate",unit:"ratio",value:2,natural_value:30.9},{category:"Education",indicator:"Proportion of population with post-secondary and higher education",unit:"%",value:2,natural_value:.1369382},{category:"Wealth",indicator:"Percentage of population with food expenditure is above 52% of total expenditure",unit:"%",value:1,natural_value:.667},{category:"Wealth",indicator:"Mean monthly salary",unit:"US dollars thousand",value:3,natural_value:1685.79},{category:"Wealth",indicator:"Mean monthly salary, change in last 3 years",unit:"%",value:2,natural_value:-.049376116118616475},{category:"Wealth",indicator:"Disposable monthly income",unit:"US dollars thousand",value:3,natural_value:796.6926340868529},{category:"Wealth",indicator:"Disposable monthly income (change in last 3 years)",unit:"%",value:3,natural_value:.0419292096217605},{category:"Wealth",indicator:"Debt to salary ratio",unit:"ratio",value:5,natural_value:.17357018007398073},{category:"Wealth",indicator:"Number of mobile phones per 1,000 population",unit:"per 1,000",value:2,natural_value:167.3958702},{category:"Wealth",indicator:"Decile income coefficient",unit:"ratio",value:1,natural_value:56.11111111111111},{category:"Wealth",indicator:"Decile income coefficient (change in last 3 years)",unit:"%",value:3,natural_value:.03033195142262146},{category:"Wealth",indicator:"Poverty headcount ratio at national poverty lines",unit:"%",value:3,natural_value:.555},{category:"Wealth",indicator:"Working poverty rate (percentage of employed living below US$1.90 PPP), 15+ age (%) ",unit:"%",value:2,natural_value:.07},{category:"Wealth",indicator:"Poverty headcount ratio at $2.15 PPP 2017 a day",unit:"%",value:3,natural_value:.205},{category:"Wealth",indicator:"Living spaces per capita, sq m (change in last 3 years)",unit:"%",value:3,natural_value:.033},{category:"Wealth",indicator:"Population living in slums (% of urban population)",unit:"%",value:3,natural_value:.242},{category:"Wealth",indicator:"Availability of finance (consumer loans)",unit:"%",value:1,natural_value:.094},{category:"Wealth",indicator:"Perception of wealth & poverty index",unit:"index",value:5,natural_value:1.7},{category:"Safety",indicator:"Road fatalities rate per 100,000 population",unit:"per 100,000",value:3,natural_value:25.079090734507815},{category:"Safety",indicator:"Road fatalities rate per 100,000 population (change in last 3 years)",unit:"%",value:3,natural_value:-.06410660306012106},{category:"Safety",indicator:"Violent crime rate per 100,000 population",unit:"per 100,000",value:1,natural_value:66},{category:"Safety",indicator:"Violent crime rate per 100,000 population (change in last 3 years)",unit:"%",value:3,natural_value:-.005000083544809186},{category:"Safety",indicator:"Crime rate per 100,000 population",unit:"per 100,000",value:3,natural_value:1284.6769493044394},{category:"Safety",indicator:"Crime rate per 100,000 population  (change in last 3 years)",unit:"%",value:1,natural_value:-.08128988581649332},{category:"Safety",indicator:"Police arrival speed",unit:"min",value:2,natural_value:30},{category:"Safety",indicator:"Perception of safety index",unit:"index",value:3,natural_value:2.79},{category:"Livability",indicator:"Number of LEED certified green buildings",unit:"Certified square meters per capita",value:2,natural_value:.00236896007406712},{category:"Livability",indicator:"Number of BREEAM certified projects",unit:"Certified square meters per capita",value:1,natural_value:0},{category:"Livability",indicator:"Whether or not the city has ISO 37120 certification",unit:"Yes/No",value:1,natural_value:0},{category:"Livability",indicator:"Mobile connection coverage",unit:"%",value:5,natural_value:.999},{category:"Livability",indicator:"Internet coverage",unit:"%",value:5,natural_value:.998},{category:"Livability",indicator:"Perception of livability index",unit:"index",value:3,natural_value:1.5},{category:"Livability",indicator:"Share of population in 1 km from schools",unit:"%",value:4,natural_value:88.8},{category:"Livability",indicator:"Share of population in 1 km from parks",unit:"%",value:3,natural_value:64.3},{category:"Transport",indicator:"Time loss in traffic",unit:"%",value:3,natural_value:.275},{category:"Transport",indicator:"Share of the population in 1 km from public transport stop",unit:"%",value:3,natural_value:36.4},{category:"Transport",indicator:"Ratio of the cost of monthly public transport usage Ithe cheapest option) to average mobthly income",unit:"ratio",value:1,natural_value:.06538576303528867},{category:"Transport",indicator:"Ratio of the cost of a 1-kilometer taxi ride to average mobthly income",unit:"%",value:5,natural_value:.00030252878472407596},{category:"Transport",indicator:"Percentage of city's roads that are segregated and/or has specialized lane for cyclists",unit:"%",value:3,natural_value:.06},{category:"Transport",indicator:"Number of public electric vehicle (EV) charging points per 100,000 population",unit:"per 100,000",value:2,natural_value:.23162888167891352},{category:"Transport",indicator:"Public transport (excluding subway) operates by schedule ",unit:"Yes/No",value:5,natural_value:1},{category:"Transport",indicator:"Perception of transport index",unit:"index",value:3,natural_value:1.5},{category:"Inclusion",indicator:"Female-friendly city",unit:"1,2,3,4,5",value:3,natural_value:3},{category:"Inclusion",indicator:"Number of refugees per 1,000 population",unit:"per 1,000",value:3,natural_value:4.178214846228337},{category:"Inclusion",indicator:"Homeless people per 1,000 population",unit:"per 1,000",value:5,natural_value:.1895145395554747},{category:"Inclusion",indicator:"Difference in number of years of schooling between woman and man, woman to man ratio ",unit:"years",value:3,natural_value:.98},{category:"Inclusion",indicator:"Slavery index",unit:"index",value:4,natural_value:2.7},{category:"Inclusion",indicator:"Percentage of women aged 25-34 years old that have successfully completed secondary education",unit:"%",value:4,natural_value:.486074295},{category:"Inclusion",indicator:"Regulations for building construction and equipment, public transport for people with disabilities",unit:"Yes/No",value:5,natural_value:1},{category:"Inclusion",indicator:"Perception of inclusion index",unit:"index",value:3,natural_value:2.3},{category:"Accountability",indicator:"City budget execution publication",unit:"Yes/No",value:5,natural_value:1},{category:"Accountability",indicator:"City budget publication",unit:"Yes/No",value:5,natural_value:1},{category:"Accountability",indicator:"Financial transparency on city government companies",unit:"Yes/No",value:1,natural_value:0},{category:"Accountability",indicator:"ISO certification",unit:"Yes/No",value:1,natural_value:0},{category:"Accountability",indicator:"City council checks and balances",unit:"Yes/No",value:5,natural_value:1},{category:"Accountability",indicator:"Plans to obtain ISO certification",unit:"Yes/No",value:5,natural_value:1},{category:"Accountability",indicator:"Perception of accountability index",unit:"index",value:3,natural_value:.9},{category:"City budget",indicator:"Poor financial condition",unit:"Yes/No",value:1,natural_value:1},{category:"City budget",indicator:"Central/higher level government financial intervention taking place",unit:"Yes/No",value:5,natural_value:0},{category:"City budget",indicator:"Long-term financial planning",unit:"Yes/No",value:5,natural_value:1},{category:"City budget",indicator:"Central/higher level government financial intervention is considered",unit:"Yes/No",value:1,natural_value:0},{category:"City budget",indicator:"Prudent fiscal policy requirements",unit:"Yes/No",value:1,natural_value:0},{category:"City budget",indicator:"Medium-term planning",unit:"Yes/No",value:5,natural_value:1},{category:"SME",indicator:"Number of SMEs per 100,000 population",unit:"per 100,000",value:3,natural_value:464.75262588672},{category:"SME",indicator:"Number of start-ups",unit:"start-ups",value:3,natural_value:225},{category:"SME",indicator:"Global Startup Ecosystem Index",unit:"index",value:1,natural_value:5.188},{category:"SME",indicator:"Number of SMEs per capita/100 000 population (change in last 3 years)",unit:"%",value:1,natural_value:-.3690430901893693},{category:"SME",indicator:"Number of start-ups (change in last 3 years)",unit:"%",value:3,natural_value:.125},{category:"Public services",indicator:"Free phone to call the police, ambulance, firefighters",unit:"1,2,3,4,5",value:5,natural_value:1},{category:"Public services",indicator:"Services for working with citizens' appeals and complaint",unit:"Yes/No",value:5,natural_value:1},{category:"Public services",indicator:"E-gov services",unit:"Yes/No",value:5,natural_value:1},{category:"Public services",indicator:"Perception of public services index: Public Services",unit:"index",value:3,natural_value:1.77},{category:"Sustainability commitment",indicator:"City ESG reporting",unit:"Yes/No",value:5,natural_value:1},{category:"Sustainability commitment",indicator:"City ESG reporting verification",unit:"Yes/No",value:5,natural_value:1},{category:"Sustainability commitment",indicator:"ESG planning",unit:"Yes/No",value:5,natural_value:1},{category:"Sustainability commitment",indicator:"Plan with specific targets to develop and implement smart city principles",unit:"Yes/No",value:5,natural_value:1},{category:"Sustainability commitment",indicator:"Rollout and status of ESG / UN SDG training across the municipal/asset workforce",unit:"Yes/No",value:5,natural_value:1},{category:"Sustainability commitment",indicator:"City municipality involved in network or partnership promoting sustainable development (for example, C40 Cities network)",unit:"Yes/No",value:5,natural_value:1}]},{city:"Mexico City",data:[{category:"Air pollution",indicator:"CO2 emissions",unit:"kt",value:3,natural_value:3.94406729},{category:"Air pollution",indicator:"CO2 emissions (change in last 3 years)",unit:"%",value:3,natural_value:-.004250140841668175},{category:"Air pollution",indicator:"CO2 concentration",unit:"ppm",value:4,natural_value:417.6455595},{category:"Air pollution",indicator:"CO2 concentration (change in last 3 years)",unit:"%",value:5,natural_value:.01301563418143103},{category:"Air pollution",indicator:"Annual average of SO2 concentration in ambient air",unit:"microgram/m3",value:1,natural_value:416.6828153},{category:"Air pollution",indicator:"Annual Average of SO2 Concentration in Ambient Air (change in last 3 years)",unit:"%",value:3,natural_value:.029396212805524676},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air",unit:"microgram/m3",value:2,natural_value:35},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air (change in last 3 years), microgram/m3",unit:"%",value:3,natural_value:-.002990856524339786},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air, microgram/m3",unit:"microgram/m3",value:3,natural_value:49.19622362},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air (change in last 3 years), microgram/m3",unit:"%",value:3,natural_value:.02331986649456455},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air, microgram/m3",unit:"microgram/m3",value:3,natural_value:.394406729},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air (change in last 3 years), microgram/m3",unit:"%",value:3,natural_value:-.004250140841668175},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air, microgram/m3",unit:"microgram/m3",value:1,natural_value:141.6888279},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air (change in last 3 years), microgram/m3",unit:"%",value:3,natural_value:.01619130675578221},{category:"Air pollution",indicator:"Volatile organic compounds/reactive organic gases emissions",unit:"microgram/m3",value:3,natural_value:1.7},{category:"Air pollution",indicator:"Perception of air pollution index",unit:"index",value:3,natural_value:1.6},{category:"Air pollution",indicator:"Paris Agreement",unit:"Yes/No",value:5,natural_value:1},{category:"Water pollution",indicator:"Annual average of dissolved oxygen (DO) concentration in water",unit:"%",value:1,natural_value:7.4},{category:"Water pollution",indicator:"Annual average of pH concentration in water",unit:"pH",value:3,natural_value:7.1},{category:"Water pollution",indicator:"Annual average dissolved solids in drinking-water",unit:"ppm",value:1,natural_value:394.16},{category:"Water pollution",indicator:"Water management strategy in a city",unit:"Yes/No",value:5,natural_value:1},{category:"Water pollution",indicator:"Perception of water pollution index",unit:"index",value:3,natural_value:1.9},{category:"Land use and waste",indicator:"Share of devastated and degraded land area requiring reclamation",unit:"%",value:3,natural_value:7},{category:"Land use and waste",indicator:"3-year average growth rate of devastated and degraded land area requiring reclamation",unit:"%",value:3,natural_value:.002},{category:"Land use and waste",indicator:"Waste deposits",unit:"%",value:3,natural_value:.005},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous)",unit:"kg per capita ",value:3,natural_value:209.69890723087653},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous), (change in last 3 years)",unit:"%",value:4,natural_value:-.037697909969071075},{category:"Land use and waste",indicator:"Total recycled construction waste",unit:"tons per capita",value:3,natural_value:1.7},{category:"Land use and waste",indicator:"Share of recycled construction and demolish waste in total generated construction and demolish waste",unit:"%",value:3,natural_value:.249},{category:"Land use and waste",indicator:"Total area of impervious surfaces and percentage to total city area",unit:"%",value:3,natural_value:.02},{category:"Land use and waste",indicator:"Productive urban land (in percent total land)",unit:"%",value:3,natural_value:32.2},{category:"Land use and waste",indicator:"Waste managenet strategy",unit:"Yes/No",value:5,natural_value:1},{category:"Land use and waste",indicator:"Perception of waste index",unit:"index",value:3,natural_value:2.3},{category:"Land use and waste",indicator:"Green spaces, % city area",unit:"%",value:3,natural_value:.21},{category:"Land use and waste",indicator:"Green spaces, change in last 3 years",unit:"%",value:3,natural_value:-.06},{category:"Land use and waste",indicator:"NDVI",unit:"%",value:3,natural_value:.262},{category:"Natural disaster hazards",indicator:"Share of total area with altitude above sea level less than 0,5 meters",unit:"%",value:3,natural_value:.085},{category:"Natural disaster hazards",indicator:"Growth rate of freshwater mirror area",unit:"%",value:3,natural_value:-.06},{category:"Natural disaster hazards",indicator:"Number of registered heavy rain, flood and thunderbolt (change in last 3 years)",unit:"%",value:3,natural_value:-.0379},{category:"Natural disaster hazards",indicator:"Number of registered sand storm (change in last 3 years)",unit:"%",value:3,natural_value:-.0379},{category:"Natural disaster hazards",indicator:"Environmental/natural disasters’ risk mitigation",unit:"Yes/No",value:5,natural_value:1},{category:"Natural disaster hazards",indicator:"Strategy/policy/government officials’ statement on environmental issues ",unit:"Yes/No",value:5,natural_value:1},{category:"Natural disaster hazards",indicator:"Total overall losses from natural disaster hazards",unit:"US$ mln ",value:3,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of days with average daily temperature above the threshold for 1990-2010",unit:"days",value:1,natural_value:279},{category:"Natural disaster hazards",indicator:"Number of disruptions to basic services, attributed to disasters",unit:"%",value:3,natural_value:0},{category:"Water availability",indicator:"Water consumption per capita",unit:"mcm",value:3,natural_value:26240674667531622e-21},{category:"Water availability",indicator:"Water tariff to disposable income ratio",unit:"ratio",value:3,natural_value:.891333333},{category:"Water availability",indicator:"Sanitary facilities tariff to disposable income ratio",unit:"ratio",value:3,natural_value:1.1},{category:"Water availability",indicator:"Water consumption per capita (change in last 3 years)",unit:"%",value:5,natural_value:-.19799737528184247},{category:"Water availability",indicator:"Percentage of population with access to drinking water",unit:"%",value:5,natural_value:.99},{category:"Water availability",indicator:"Percentage of population with access to drinking water (change in last 3 years)",unit:"%",value:3,natural_value:.0016},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities",unit:"%",value:4,natural_value:.924},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities (change in last 3 years)",unit:"%",value:4,natural_value:.00510212913410224},{category:"Food availability",indicator:"Cereal import dependency ratio (5-years average)",unit:"%",value:3,natural_value:.3408},{category:"Food availability",indicator:"Cereal import dependency ratio (change in last 3 years)",unit:"%",value:4,natural_value:-.05401609914880312},{category:"Food availability",indicator:"Prevalence of undernourishment",unit:"%",value:3,natural_value:.025},{category:"Food availability",indicator:"Prevalence of undernourishment (change in last 3 years)",unit:"%",value:3,natural_value:-.002999999999999999},{category:"Food availability",indicator:"Prevalence of undernourishment children",unit:"%",value:4,natural_value:.126},{category:"Food availability",indicator:"Prevalence of undernourishment children (change in last 3 years)",unit:"%",value:3,natural_value:-.005235698025902069},{category:"Food availability",indicator:"Prevalence of moderate or severe food insecurity in the population",unit:"%",value:3,natural_value:.332},{category:"Food availability",indicator:"Share of imports in food resources",unit:"%",value:3,natural_value:.391},{category:"Food availability",indicator:"Percentage of people with access to at least one food vendor/retailer within 15 minutes of walking",unit:"%",value:3,natural_value:91},{category:"Food availability",indicator:"Perception of food availability index",unit:"index",value:3,natural_value:2.2},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity",unit:"%",value:5,natural_value:1},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity (change in last 3 years)",unit:"%",value:3,natural_value:.00133689998761799},{category:"Energy availability",indicator:"Consumption of electricity per capita",unit:"kWh/person",value:3,natural_value:4751.875097009815},{category:"Energy availability",indicator:"Consumption of electricity per capita (change in last 3 years)",unit:"%",value:4,natural_value:-.014927121837602364},{category:"Energy availability",indicator:"Electricity tariff to disposable income ratio",unit:"ratio",value:3,natural_value:.095},{category:"Energy availability",indicator:"Share of renewable sources in electricity consumption",unit:"%",value:2,natural_value:.1233},{category:"Energy availability",indicator:"Perception of energy availability index",unit:"index",value:3,natural_value:1.07},{category:"Health",indicator:"Child mortality rate (under 5 years-old)",unit:"% of live births ",value:3,natural_value:9.3},{category:"Health",indicator:"City ambulance",unit:"Yes/No",value:1,natural_value:0},{category:"Health",indicator:"Life expectancy at birth, years",unit:"Years",value:2,natural_value:70.213},{category:"Health",indicator:"Life expectancy at birth goals",unit:"categories",value:1,natural_value:1},{category:"Health",indicator:"Number of hospital beds per 1,000 population",unit:"per 1,000",value:5,natural_value:6.008509648918856},{category:"Health",indicator:"Number of doctors per 1,000 population",unit:"per 1,000",value:3,natural_value:5.4},{category:"Health",indicator:"Maternal mortality ratio",unit:"deaths per 1,000 live births",value:3,natural_value:36},{category:"Health",indicator:"Ambulance arrival speed, min",unit:"min",value:3,natural_value:70},{category:"Education",indicator:"Literacy rate among population (15-24 Years)",unit:"%",value:3,natural_value:.990824127197266},{category:"Education",indicator:"Literacy rate among population (15-24 Years) (change in last 3 years)",unit:"%",value:3,natural_value:-.00014217945297922974},{category:"Education",indicator:"Primary education engagement",unit:"%",value:3,natural_value:.73},{category:"Education",indicator:"Pupils per teacher rate",unit:"ratio",value:3,natural_value:21.6},{category:"Education",indicator:"Proportion of population with post-secondary and higher education",unit:"%",value:2,natural_value:.1877145958},{category:"Wealth",indicator:"Percentage of population with food expenditure is above 52% of total expenditure",unit:"%",value:3,natural_value:.202},{category:"Wealth",indicator:"Mean monthly salary",unit:"US dollars thousand",value:2,natural_value:890.8545},{category:"Wealth",indicator:"Mean monthly salary, change in last 3 years",unit:"%",value:3,natural_value:0},{category:"Wealth",indicator:"Disposable monthly income",unit:"US dollars thousand",value:3,natural_value:784},{category:"Wealth",indicator:"Disposable monthly income (change in last 3 years)",unit:"%",value:3,natural_value:.02},{category:"Wealth",indicator:"Debt to salary ratio",unit:"ratio",value:5,natural_value:.05835306826207985},{category:"Wealth",indicator:"Number of mobile phones per 1,000 population",unit:"per 1,000",value:2,natural_value:523},{category:"Wealth",indicator:"Decile income coefficient",unit:"ratio",value:3,natural_value:19.72222222222222},{category:"Wealth",indicator:"Decile income coefficient (change in last 3 years)",unit:"%",value:3,natural_value:-.03918968586393867},{category:"Wealth",indicator:"Poverty headcount ratio at national poverty lines",unit:"%",value:3,natural_value:.363},{category:"Wealth",indicator:"Working poverty rate (percentage of employed living below US$1.90 PPP), 15+ age (%) ",unit:"%",value:4,natural_value:.017},{category:"Wealth",indicator:"Poverty headcount ratio at $2.15 PPP 2017 a day",unit:"%",value:4,natural_value:.031},{category:"Wealth",indicator:"Living spaces per capita, sq m (change in last 3 years)",unit:"%",value:3,natural_value:.033},{category:"Wealth",indicator:"Population living in slums (% of urban population)",unit:"%",value:3,natural_value:.176},{category:"Wealth",indicator:"Availability of finance (consumer loans)",unit:"%",value:3,natural_value:.25},{category:"Wealth",indicator:"Perception of wealth & poverty index",unit:"index",value:3,natural_value:1.7},{category:"Safety",indicator:"Road fatalities rate per 100,000 population",unit:"per 100,000",value:4,natural_value:1.1857707509881423},{category:"Safety",indicator:"Road fatalities rate per 100,000 population (change in last 3 years)",unit:"%",value:5,natural_value:.1725851631673272},{category:"Safety",indicator:"Violent crime rate per 100,000 population",unit:"per 100,000",value:3,natural_value:14},{category:"Safety",indicator:"Violent crime rate per 100,000 population (change in last 3 years)",unit:"%",value:3,natural_value:0},{category:"Safety",indicator:"Crime rate per 100,000 population",unit:"per 100,000",value:1,natural_value:46032},{category:"Safety",indicator:"Crime rate per 100,000 population  (change in last 3 years)",unit:"%",value:2,natural_value:-.04789415935857033},{category:"Safety",indicator:"Police arrival speed",unit:"min",value:3,natural_value:21.7},{category:"Safety",indicator:"Perception of safety index",unit:"index",value:3,natural_value:2.79},{category:"Livability",indicator:"Number of LEED certified green buildings",unit:"Certified square meters per capita",value:3,natural_value:.126343935797907},{category:"Livability",indicator:"Number of BREEAM certified projects",unit:"Certified square meters per capita",value:1,natural_value:0},{category:"Livability",indicator:"Whether or not the city has ISO 37120 certification",unit:"Yes/No",value:1,natural_value:0},{category:"Livability",indicator:"Mobile connection coverage",unit:"%",value:5,natural_value:.999},{category:"Livability",indicator:"Internet coverage",unit:"%",value:3,natural_value:.9},{category:"Livability",indicator:"Perception of livability index",unit:"index",value:3,natural_value:1.5},{category:"Livability",indicator:"Share of population in 1 km from schools",unit:"%",value:3,natural_value:70.7},{category:"Livability",indicator:"Share of population in 1 km from parks",unit:"%",value:3,natural_value:64.3},{category:"Transport",indicator:"Time loss in traffic",unit:"%",value:1,natural_value:.6645},{category:"Transport",indicator:"Share of the population in 1 km from public transport stop",unit:"%",value:3,natural_value:43.9},{category:"Transport",indicator:"Ratio of the cost of monthly public transport usage Ithe cheapest option) to average mobthly income",unit:"ratio",value:5,natural_value:.0599424485143197},{category:"Transport",indicator:"Ratio of the cost of a 1-kilometer taxi ride to average mobthly income",unit:"%",value:1,natural_value:.07857624337083104},{category:"Transport",indicator:"Percentage of city's roads that are segregated and/or has specialized lane for cyclists",unit:"%",value:3,natural_value:.06},{category:"Transport",indicator:"Number of public electric vehicle (EV) charging points per 100,000 population",unit:"per 100,000",value:4,natural_value:1.8319738823695886},{category:"Transport",indicator:"Public transport (excluding subway) operates by schedule ",unit:"Yes/No",value:5,natural_value:1},{category:"Transport",indicator:"Perception of transport index",unit:"index",value:3,natural_value:1.5},{category:"Inclusion",indicator:"Female-friendly city",unit:"1,2,3,4,5",value:3,natural_value:3},{category:"Inclusion",indicator:"Number of refugees per 1,000 population",unit:"per 1,000",value:3,natural_value:4.1},{category:"Inclusion",indicator:"Homeless people per 1,000 population",unit:"per 1,000",value:3,natural_value:7.7},{category:"Inclusion",indicator:"Difference in number of years of schooling between woman and man, woman to man ratio ",unit:"years",value:3,natural_value:.97},{category:"Inclusion",indicator:"Slavery index",unit:"index",value:1,natural_value:58.1},{category:"Inclusion",indicator:"Percentage of women aged 25-34 years old that have successfully completed secondary education",unit:"%",value:1,natural_value:.1828479004},{category:"Inclusion",indicator:"Regulations for building construction and equipment, public transport for people with disabilities",unit:"Yes/No",value:5,natural_value:1},{category:"Inclusion",indicator:"Perception of inclusion index",unit:"index",value:3,natural_value:2.3},{category:"Accountability",indicator:"City budget execution publication",unit:"Yes/No",value:5,natural_value:1},{category:"Accountability",indicator:"City budget publication",unit:"Yes/No",value:5,natural_value:1},{category:"Accountability",indicator:"Financial transparency on city government companies",unit:"Yes/No",value:1,natural_value:0},{category:"Accountability",indicator:"ISO certification",unit:"Yes/No",value:1,natural_value:0},{category:"Accountability",indicator:"City council checks and balances",unit:"Yes/No",value:5,natural_value:1},{category:"Accountability",indicator:"Plans to obtain ISO certification",unit:"Yes/No",value:1,natural_value:0},{category:"Accountability",indicator:"Perception of accountability index",unit:"index",value:3,natural_value:.9},{category:"City budget",indicator:"Poor financial condition",unit:"Yes/No",value:1,natural_value:1},{category:"City budget",indicator:"Central/higher level government financial intervention taking place",unit:"Yes/No",value:1,natural_value:1},{category:"City budget",indicator:"Long-term financial planning",unit:"Yes/No",value:5,natural_value:1},{category:"City budget",indicator:"Central/higher level government financial intervention is considered",unit:"Yes/No",value:1,natural_value:0},{category:"City budget",indicator:"Prudent fiscal policy requirements",unit:"Yes/No",value:5,natural_value:1},{category:"City budget",indicator:"Medium-term planning",unit:"Yes/No",value:5,natural_value:1},{category:"SME",indicator:"Number of SMEs per 100,000 population",unit:"per 100,000",value:3,natural_value:9336},{category:"SME",indicator:"Number of start-ups",unit:"start-ups",value:3,natural_value:1211},{category:"SME",indicator:"Global Startup Ecosystem Index",unit:"index",value:3,natural_value:13.567},{category:"SME",indicator:"Number of SMEs per capita/100 000 population (change in last 3 years)",unit:"%",value:3,natural_value:-7e-4},{category:"SME",indicator:"Number of start-ups (change in last 3 years)",unit:"%",value:3,natural_value:.125},{category:"Public services",indicator:"Free phone to call the police, ambulance, firefighters",unit:"1,2,3,4,5",value:5,natural_value:1},{category:"Public services",indicator:"Services for working with citizens' appeals and complaint",unit:"Yes/No",value:5,natural_value:1},{category:"Public services",indicator:"E-gov services",unit:"Yes/No",value:5,natural_value:1},{category:"Public services",indicator:"Perception of public services index: Public Services",unit:"index",value:3,natural_value:1.77},{category:"Sustainability commitment",indicator:"City ESG reporting",unit:"Yes/No",value:1,natural_value:0},{category:"Sustainability commitment",indicator:"City ESG reporting verification",unit:"Yes/No",value:1,natural_value:0},{category:"Sustainability commitment",indicator:"ESG planning",unit:"Yes/No",value:1,natural_value:0},{category:"Sustainability commitment",indicator:"Plan with specific targets to develop and implement smart city principles",unit:"Yes/No",value:5,natural_value:1},{category:"Sustainability commitment",indicator:"Rollout and status of ESG / UN SDG training across the municipal/asset workforce",unit:"Yes/No",value:1,natural_value:0},{category:"Sustainability commitment",indicator:"City municipality involved in network or partnership promoting sustainable development (for example, C40 Cities network)",unit:"Yes/No",value:5,natural_value:1}]},{city:"Jakarta",data:[{category:"Air pollution",indicator:"CO2 emissions",unit:"kt",value:2,natural_value:7.06684134},{category:"Air pollution",indicator:"CO2 emissions (change in last 3 years)",unit:"%",value:3,natural_value:-.003920588646618603},{category:"Air pollution",indicator:"CO2 concentration",unit:"ppm",value:1,natural_value:488.0373113},{category:"Air pollution",indicator:"CO2 concentration (change in last 3 years)",unit:"%",value:5,natural_value:.017863350354496974},{category:"Air pollution",indicator:"Annual average of SO2 concentration in ambient air",unit:"microgram/m3",value:3,natural_value:28.66047717},{category:"Air pollution",indicator:"Annual Average of SO2 Concentration in Ambient Air (change in last 3 years)",unit:"%",value:3,natural_value:-.0009916021541911573},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air",unit:"microgram/m3",value:2,natural_value:24.2},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air (change in last 3 years), microgram/m3",unit:"%",value:3,natural_value:.008889816360600893},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air, microgram/m3",unit:"microgram/m3",value:4,natural_value:46.95295405},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air (change in last 3 years), microgram/m3",unit:"%",value:3,natural_value:-.06267596465337597},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air, microgram/m3",unit:"microgram/m3",value:2,natural_value:.706684134},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air (change in last 3 years), microgram/m3",unit:"%",value:3,natural_value:-.003920588646618603},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air, microgram/m3",unit:"microgram/m3",value:1,natural_value:131.8745867},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air (change in last 3 years), microgram/m3",unit:"%",value:3,natural_value:.006113533484481624},{category:"Air pollution",indicator:"Volatile organic compounds/reactive organic gases emissions",unit:"microgram/m3",value:3,natural_value:1.7},{category:"Air pollution",indicator:"Perception of air pollution index",unit:"index",value:3,natural_value:1.6},{category:"Air pollution",indicator:"Paris Agreement",unit:"Yes/No",value:5,natural_value:1},{category:"Water pollution",indicator:"Annual average of dissolved oxygen (DO) concentration in water",unit:"%",value:3,natural_value:6.08},{category:"Water pollution",indicator:"Annual average of pH concentration in water",unit:"pH",value:3,natural_value:7.1},{category:"Water pollution",indicator:"Annual average dissolved solids in drinking-water",unit:"ppm",value:4,natural_value:75},{category:"Water pollution",indicator:"Water management strategy in a city",unit:"Yes/No",value:5,natural_value:1},{category:"Water pollution",indicator:"Perception of water pollution index",unit:"index",value:3,natural_value:1.9},{category:"Land use and waste",indicator:"Share of devastated and degraded land area requiring reclamation",unit:"%",value:3,natural_value:7},{category:"Land use and waste",indicator:"3-year average growth rate of devastated and degraded land area requiring reclamation",unit:"%",value:3,natural_value:.002},{category:"Land use and waste",indicator:"Waste deposits",unit:"%",value:3,natural_value:.005},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous)",unit:"kg per capita ",value:3,natural_value:219},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous), (change in last 3 years)",unit:"%",value:3,natural_value:4.2},{category:"Land use and waste",indicator:"Total recycled construction waste",unit:"tons per capita",value:3,natural_value:1.7},{category:"Land use and waste",indicator:"Share of recycled construction and demolish waste in total generated construction and demolish waste",unit:"%",value:3,natural_value:.249},{category:"Land use and waste",indicator:"Total area of impervious surfaces and percentage to total city area",unit:"%",value:3,natural_value:.02},{category:"Land use and waste",indicator:"Productive urban land (in percent total land)",unit:"%",value:3,natural_value:32.2},{category:"Land use and waste",indicator:"Waste managenet strategy",unit:"Yes/No",value:1,natural_value:0},{category:"Land use and waste",indicator:"Perception of waste index",unit:"index",value:3,natural_value:2.3},{category:"Land use and waste",indicator:"Green spaces, % city area",unit:"%",value:2,natural_value:.0465},{category:"Land use and waste",indicator:"Green spaces, change in last 3 years",unit:"%",value:3,natural_value:-.06},{category:"Land use and waste",indicator:"NDVI",unit:"%",value:3,natural_value:.447},{category:"Natural disaster hazards",indicator:"Share of total area with altitude above sea level less than 0,5 meters",unit:"%",value:3,natural_value:.085},{category:"Natural disaster hazards",indicator:"Growth rate of freshwater mirror area",unit:"%",value:3,natural_value:-.06},{category:"Natural disaster hazards",indicator:"Number of registered heavy rain, flood and thunderbolt (change in last 3 years)",unit:"%",value:3,natural_value:-.0379},{category:"Natural disaster hazards",indicator:"Number of registered sand storm (change in last 3 years)",unit:"%",value:3,natural_value:-.0379},{category:"Natural disaster hazards",indicator:"Environmental/natural disasters’ risk mitigation",unit:"Yes/No",value:5,natural_value:1},{category:"Natural disaster hazards",indicator:"Strategy/policy/government officials’ statement on environmental issues ",unit:"Yes/No",value:1,natural_value:0},{category:"Natural disaster hazards",indicator:"Total overall losses from natural disaster hazards",unit:"US$ mln ",value:3,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of days with average daily temperature above the threshold for 1990-2010",unit:"days",value:3,natural_value:15},{category:"Natural disaster hazards",indicator:"Number of disruptions to basic services, attributed to disasters",unit:"%",value:3,natural_value:0},{category:"Water availability",indicator:"Water consumption per capita",unit:"mcm",value:3,natural_value:.11353959693443089},{category:"Water availability",indicator:"Water tariff to disposable income ratio",unit:"ratio",value:3,natural_value:1.29},{category:"Water availability",indicator:"Sanitary facilities tariff to disposable income ratio",unit:"ratio",value:3,natural_value:1.1},{category:"Water availability",indicator:"Water consumption per capita (change in last 3 years)",unit:"%",value:3,natural_value:-.004},{category:"Water availability",indicator:"Percentage of population with access to drinking water",unit:"%",value:3,natural_value:.9773},{category:"Water availability",indicator:"Percentage of population with access to drinking water (change in last 3 years)",unit:"%",value:5,natural_value:-.003421320060821298},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities",unit:"%",value:4,natural_value:.9279},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities (change in last 3 years)",unit:"%",value:4,natural_value:-.0008964755405916902},{category:"Food availability",indicator:"Cereal import dependency ratio (5-years average)",unit:"%",value:3,natural_value:.35},{category:"Food availability",indicator:"Cereal import dependency ratio (change in last 3 years)",unit:"%",value:3,natural_value:.002},{category:"Food availability",indicator:"Prevalence of undernourishment",unit:"%",value:3,natural_value:.065},{category:"Food availability",indicator:"Prevalence of undernourishment (change in last 3 years)",unit:"%",value:3,natural_value:.006000000000000005},{category:"Food availability",indicator:"Prevalence of undernourishment children",unit:"%",value:4,natural_value:.122},{category:"Food availability",indicator:"Prevalence of undernourishment children (change in last 3 years)",unit:"%",value:3,natural_value:-.0010000000000000009},{category:"Food availability",indicator:"Prevalence of moderate or severe food insecurity in the population",unit:"%",value:3,natural_value:.117},{category:"Food availability",indicator:"Share of imports in food resources",unit:"%",value:2,natural_value:.6},{category:"Food availability",indicator:"Percentage of people with access to at least one food vendor/retailer within 15 minutes of walking",unit:"%",value:3,natural_value:91},{category:"Food availability",indicator:"Perception of food availability index",unit:"index",value:3,natural_value:2.2},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity",unit:"%",value:3,natural_value:.9973},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity (change in last 3 years)",unit:"%",value:1,natural_value:-.0008675056905055323},{category:"Energy availability",indicator:"Consumption of electricity per capita",unit:"kWh/person",value:4,natural_value:1090},{category:"Energy availability",indicator:"Consumption of electricity per capita (change in last 3 years)",unit:"%",value:3,natural_value:.009346336118695842},{category:"Energy availability",indicator:"Electricity tariff to disposable income ratio",unit:"ratio",value:3,natural_value:.1},{category:"Energy availability",indicator:"Share of renewable sources in electricity consumption",unit:"%",value:2,natural_value:.14},{category:"Energy availability",indicator:"Perception of energy availability index",unit:"index",value:3,natural_value:1.07},{category:"Health",indicator:"Child mortality rate (under 5 years-old)",unit:"% of live births ",value:2,natural_value:22.17},{category:"Health",indicator:"City ambulance",unit:"Yes/No",value:5,natural_value:1},{category:"Health",indicator:"Life expectancy at birth, years",unit:"Years",value:3,natural_value:73.32},{category:"Health",indicator:"Life expectancy at birth goals",unit:"categories",value:5,natural_value:3},{category:"Health",indicator:"Number of hospital beds per 1,000 population",unit:"per 1,000",value:3,natural_value:3.1},{category:"Health",indicator:"Number of doctors per 1,000 population",unit:"per 1,000",value:2,natural_value:23},{category:"Health",indicator:"Maternal mortality ratio",unit:"deaths per 1,000 live births",value:1,natural_value:173},{category:"Health",indicator:"Ambulance arrival speed, min",unit:"min",value:3,natural_value:120},{category:"Education",indicator:"Literacy rate among population (15-24 Years)",unit:"%",value:5,natural_value:.9996},{category:"Education",indicator:"Literacy rate among population (15-24 Years) (change in last 3 years)",unit:"%",value:3,natural_value:.00023353573945694706},{category:"Education",indicator:"Primary education engagement",unit:"%",value:3,natural_value:.5018},{category:"Education",indicator:"Pupils per teacher rate",unit:"ratio",value:3,natural_value:18.44},{category:"Education",indicator:"Proportion of population with post-secondary and higher education",unit:"%",value:4,natural_value:.4012},{category:"Wealth",indicator:"Percentage of population with food expenditure is above 52% of total expenditure",unit:"%",value:4,natural_value:.07},{category:"Wealth",indicator:"Mean monthly salary",unit:"US dollars thousand",value:2,natural_value:554.22},{category:"Wealth",indicator:"Mean monthly salary, change in last 3 years",unit:"%",value:3,natural_value:0},{category:"Wealth",indicator:"Disposable monthly income",unit:"US dollars thousand",value:3,natural_value:784},{category:"Wealth",indicator:"Disposable monthly income (change in last 3 years)",unit:"%",value:3,natural_value:.02},{category:"Wealth",indicator:"Debt to salary ratio",unit:"ratio",value:3,natural_value:5},{category:"Wealth",indicator:"Number of mobile phones per 1,000 population",unit:"per 1,000",value:3,natural_value:1300},{category:"Wealth",indicator:"Decile income coefficient",unit:"ratio",value:3,natural_value:16},{category:"Wealth",indicator:"Decile income coefficient (change in last 3 years)",unit:"%",value:3,natural_value:-.0685},{category:"Wealth",indicator:"Poverty headcount ratio at national poverty lines",unit:"%",value:3,natural_value:.0469},{category:"Wealth",indicator:"Working poverty rate (percentage of employed living below US$1.90 PPP), 15+ age (%) ",unit:"%",value:3,natural_value:.023},{category:"Wealth",indicator:"Poverty headcount ratio at $2.15 PPP 2017 a day",unit:"%",value:3,natural_value:.025},{category:"Wealth",indicator:"Living spaces per capita, sq m (change in last 3 years)",unit:"%",value:3,natural_value:.033},{category:"Wealth",indicator:"Population living in slums (% of urban population)",unit:"%",value:3,natural_value:.075},{category:"Wealth",indicator:"Availability of finance (consumer loans)",unit:"%",value:3,natural_value:.43},{category:"Wealth",indicator:"Perception of wealth & poverty index",unit:"index",value:3,natural_value:1.7},{category:"Safety",indicator:"Road fatalities rate per 100,000 population",unit:"per 100,000",value:4,natural_value:13.94},{category:"Safety",indicator:"Road fatalities rate per 100,000 population (change in last 3 years)",unit:"%",value:3,natural_value:-.03},{category:"Safety",indicator:"Violent crime rate per 100,000 population",unit:"per 100,000",value:5,natural_value:.33038999264164826},{category:"Safety",indicator:"Violent crime rate per 100,000 population (change in last 3 years)",unit:"%",value:4,natural_value:-.0484913742569858},{category:"Safety",indicator:"Crime rate per 100,000 population",unit:"per 100,000",value:3,natural_value:82.24439043689594},{category:"Safety",indicator:"Crime rate per 100,000 population  (change in last 3 years)",unit:"%",value:3,natural_value:-.03},{category:"Safety",indicator:"Police arrival speed",unit:"min",value:3,natural_value:21.7},{category:"Safety",indicator:"Perception of safety index",unit:"index",value:3,natural_value:2.79},{category:"Livability",indicator:"Number of LEED certified green buildings",unit:"Certified square meters per capita",value:3,natural_value:24.08014468999039},{category:"Livability",indicator:"Number of BREEAM certified projects",unit:"Certified square meters per capita",value:1,natural_value:0},{category:"Livability",indicator:"Whether or not the city has ISO 37120 certification",unit:"Yes/No",value:1,natural_value:1},{category:"Livability",indicator:"Mobile connection coverage",unit:"%",value:3,natural_value:.9676},{category:"Livability",indicator:"Internet coverage",unit:"%",value:4,natural_value:.9676},{category:"Livability",indicator:"Perception of livability index",unit:"index",value:3,natural_value:1.5},{category:"Livability",indicator:"Share of population in 1 km from schools",unit:"%",value:3,natural_value:54.7},{category:"Livability",indicator:"Share of population in 1 km from parks",unit:"%",value:3,natural_value:64.3},{category:"Transport",indicator:"Time loss in traffic",unit:"%",value:2,natural_value:.3624},{category:"Transport",indicator:"Share of the population in 1 km from public transport stop",unit:"%",value:3,natural_value:24.8},{category:"Transport",indicator:"Ratio of the cost of monthly public transport usage Ithe cheapest option) to average mobthly income",unit:"ratio",value:3,natural_value:.04},{category:"Transport",indicator:"Ratio of the cost of a 1-kilometer taxi ride to average mobthly income",unit:"%",value:3,natural_value:.04},{category:"Transport",indicator:"Percentage of city's roads that are segregated and/or has specialized lane for cyclists",unit:"%",value:3,natural_value:.06},{category:"Transport",indicator:"Number of public electric vehicle (EV) charging points per 100,000 population",unit:"per 100,000",value:3,natural_value:1.4},{category:"Transport",indicator:"Public transport (excluding subway) operates by schedule ",unit:"Yes/No",value:5,natural_value:1},{category:"Transport",indicator:"Perception of transport index",unit:"index",value:3,natural_value:1.5},{category:"Inclusion",indicator:"Female-friendly city",unit:"1,2,3,4,5",value:3,natural_value:3},{category:"Inclusion",indicator:"Number of refugees per 1,000 population",unit:"per 1,000",value:5,natural_value:.19897699655230883},{category:"Inclusion",indicator:"Homeless people per 1,000 population",unit:"per 1,000",value:5,natural_value:.2491806348909074},{category:"Inclusion",indicator:"Difference in number of years of schooling between woman and man, woman to man ratio ",unit:"years",value:5,natural_value:.1},{category:"Inclusion",indicator:"Slavery index",unit:"index",value:1,natural_value:49},{category:"Inclusion",indicator:"Percentage of women aged 25-34 years old that have successfully completed secondary education",unit:"%",value:1,natural_value:.061},{category:"Inclusion",indicator:"Regulations for building construction and equipment, public transport for people with disabilities",unit:"Yes/No",value:5,natural_value:1},{category:"Inclusion",indicator:"Perception of inclusion index",unit:"index",value:3,natural_value:2.3},{category:"Accountability",indicator:"City budget execution publication",unit:"Yes/No",value:5,natural_value:1},{category:"Accountability",indicator:"City budget publication",unit:"Yes/No",value:5,natural_value:1},{category:"Accountability",indicator:"Financial transparency on city government companies",unit:"Yes/No",value:5,natural_value:1},{category:"Accountability",indicator:"ISO certification",unit:"Yes/No",value:1,natural_value:0},{category:"Accountability",indicator:"City council checks and balances",unit:"Yes/No",value:5,natural_value:1},{category:"Accountability",indicator:"Plans to obtain ISO certification",unit:"Yes/No",value:5,natural_value:1},{category:"Accountability",indicator:"Perception of accountability index",unit:"index",value:3,natural_value:.9},{category:"City budget",indicator:"Poor financial condition",unit:"Yes/No",value:1,natural_value:""},{category:"City budget",indicator:"Central/higher level government financial intervention taking place",unit:"Yes/No",value:5,natural_value:0},{category:"City budget",indicator:"Long-term financial planning",unit:"Yes/No",value:1,natural_value:0},{category:"City budget",indicator:"Central/higher level government financial intervention is considered",unit:"Yes/No",value:1,natural_value:0},{category:"City budget",indicator:"Prudent fiscal policy requirements",unit:"Yes/No",value:"",natural_value:""},{category:"City budget",indicator:"Medium-term planning",unit:"Yes/No",value:1,natural_value:0},{category:"SME",indicator:"Number of SMEs per 100,000 population",unit:"per 100,000",value:2,natural_value:13350.342150446195},{category:"SME",indicator:"Number of start-ups",unit:"start-ups",value:3,natural_value:473},{category:"SME",indicator:"Global Startup Ecosystem Index",unit:"index",value:4,natural_value:24.073},{category:"SME",indicator:"Number of SMEs per capita/100 000 population (change in last 3 years)",unit:"%",value:3,natural_value:-7e-4},{category:"SME",indicator:"Number of start-ups (change in last 3 years)",unit:"%",value:3,natural_value:.125},{category:"Public services",indicator:"Free phone to call the police, ambulance, firefighters",unit:"1,2,3,4,5",value:5,natural_value:1},{category:"Public services",indicator:"Services for working with citizens' appeals and complaint",unit:"Yes/No",value:5,natural_value:1},{category:"Public services",indicator:"E-gov services",unit:"Yes/No",value:1,natural_value:0},{category:"Public services",indicator:"Perception of public services index: Public Services",unit:"index",value:3,natural_value:1.77},{category:"Sustainability commitment",indicator:"City ESG reporting",unit:"Yes/No",value:1,natural_value:0},{category:"Sustainability commitment",indicator:"City ESG reporting verification",unit:"Yes/No",value:1,natural_value:0},{category:"Sustainability commitment",indicator:"ESG planning",unit:"Yes/No",value:1,natural_value:0},{category:"Sustainability commitment",indicator:"Plan with specific targets to develop and implement smart city principles",unit:"Yes/No",value:5,natural_value:1},{category:"Sustainability commitment",indicator:"Rollout and status of ESG / UN SDG training across the municipal/asset workforce",unit:"Yes/No",value:1,natural_value:0},{category:"Sustainability commitment",indicator:"City municipality involved in network or partnership promoting sustainable development (for example, C40 Cities network)",unit:"Yes/No",value:5,natural_value:1}]},{city:"Panama City",data:[{category:"Air pollution",indicator:"CO2 emissions",unit:"kt",value:4,natural_value:1.07156422},{category:"Air pollution",indicator:"CO2 emissions (change in last 3 years)",unit:"%",value:3,natural_value:-.049160125068900634},{category:"Air pollution",indicator:"CO2 concentration",unit:"ppm",value:5,natural_value:415.3752444},{category:"Air pollution",indicator:"CO2 concentration (change in last 3 years)",unit:"%",value:5,natural_value:.009762337640858978},{category:"Air pollution",indicator:"Annual average of SO2 concentration in ambient air",unit:"microgram/m3",value:5,natural_value:.565713238},{category:"Air pollution",indicator:"Annual Average of SO2 Concentration in Ambient Air (change in last 3 years)",unit:"%",value:3,natural_value:-.06442138720963429},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air",unit:"microgram/m3",value:4,natural_value:4.8},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air (change in last 3 years), microgram/m3",unit:"%",value:3,natural_value:-.05918882204541039},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air, microgram/m3",unit:"microgram/m3",value:4,natural_value:44.18979582},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air (change in last 3 years), microgram/m3",unit:"%",value:3,natural_value:-.029267096962324747},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air, microgram/m3",unit:"microgram/m3",value:5,natural_value:.107156422},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air (change in last 3 years), microgram/m3",unit:"%",value:3,natural_value:-.049160125068900634},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air, microgram/m3",unit:"microgram/m3",value:5,natural_value:19.10546465},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air (change in last 3 years), microgram/m3",unit:"%",value:3,natural_value:-.17542578581721666},{category:"Air pollution",indicator:"Volatile organic compounds/reactive organic gases emissions",unit:"microgram/m3",value:3,natural_value:1.7},{category:"Air pollution",indicator:"Perception of air pollution index",unit:"index",value:3,natural_value:1.6},{category:"Air pollution",indicator:"Paris Agreement",unit:"Yes/No",value:5,natural_value:1},{category:"Water pollution",indicator:"Annual average of dissolved oxygen (DO) concentration in water",unit:"%",value:4,natural_value:5},{category:"Water pollution",indicator:"Annual average of pH concentration in water",unit:"pH",value:3,natural_value:7.1},{category:"Water pollution",indicator:"Annual average dissolved solids in drinking-water",unit:"ppm",value:4,natural_value:47},{category:"Water pollution",indicator:"Water management strategy in a city",unit:"Yes/No",value:5,natural_value:1},{category:"Water pollution",indicator:"Perception of water pollution index",unit:"index",value:3,natural_value:1.9},{category:"Land use and waste",indicator:"Share of devastated and degraded land area requiring reclamation",unit:"%",value:3,natural_value:7},{category:"Land use and waste",indicator:"3-year average growth rate of devastated and degraded land area requiring reclamation",unit:"%",value:3,natural_value:.002},{category:"Land use and waste",indicator:"Waste deposits",unit:"%",value:3,natural_value:.005},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous)",unit:"kg per capita ",value:5,natural_value:82.12135448591799},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous), (change in last 3 years)",unit:"%",value:3,natural_value:4.2},{category:"Land use and waste",indicator:"Total recycled construction waste",unit:"tons per capita",value:3,natural_value:.02564102564102564},{category:"Land use and waste",indicator:"Share of recycled construction and demolish waste in total generated construction and demolish waste",unit:"%",value:3,natural_value:.249},{category:"Land use and waste",indicator:"Total area of impervious surfaces and percentage to total city area",unit:"%",value:3,natural_value:.02},{category:"Land use and waste",indicator:"Productive urban land (in percent total land)",unit:"%",value:3,natural_value:32.2},{category:"Land use and waste",indicator:"Waste managenet strategy",unit:"Yes/No",value:1,natural_value:0},{category:"Land use and waste",indicator:"Perception of waste index",unit:"index",value:3,natural_value:2.3},{category:"Land use and waste",indicator:"Green spaces, % city area",unit:"%",value:3,natural_value:.21},{category:"Land use and waste",indicator:"Green spaces, change in last 3 years",unit:"%",value:3,natural_value:-.06},{category:"Land use and waste",indicator:"NDVI",unit:"%",value:3,natural_value:.384},{category:"Natural disaster hazards",indicator:"Share of total area with altitude above sea level less than 0,5 meters",unit:"%",value:3,natural_value:.085},{category:"Natural disaster hazards",indicator:"Growth rate of freshwater mirror area",unit:"%",value:3,natural_value:-.06},{category:"Natural disaster hazards",indicator:"Number of registered heavy rain, flood and thunderbolt (change in last 3 years)",unit:"%",value:3,natural_value:-.02},{category:"Natural disaster hazards",indicator:"Number of registered sand storm (change in last 3 years)",unit:"%",value:3,natural_value:-.02},{category:"Natural disaster hazards",indicator:"Environmental/natural disasters’ risk mitigation",unit:"Yes/No",value:5,natural_value:1},{category:"Natural disaster hazards",indicator:"Strategy/policy/government officials’ statement on environmental issues ",unit:"Yes/No",value:5,natural_value:1},{category:"Natural disaster hazards",indicator:"Total overall losses from natural disaster hazards",unit:"US$ mln ",value:3,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of days with average daily temperature above the threshold for 1990-2010",unit:"days",value:3,natural_value:15},{category:"Natural disaster hazards",indicator:"Number of disruptions to basic services, attributed to disasters",unit:"%",value:3,natural_value:0},{category:"Water availability",indicator:"Water consumption per capita",unit:"mcm",value:3,natural_value:.507},{category:"Water availability",indicator:"Water tariff to disposable income ratio",unit:"ratio",value:5,natural_value:.0003910710654340107},{category:"Water availability",indicator:"Sanitary facilities tariff to disposable income ratio",unit:"ratio",value:5,natural_value:.0001173213196302032},{category:"Water availability",indicator:"Water consumption per capita (change in last 3 years)",unit:"%",value:3,natural_value:-.004},{category:"Water availability",indicator:"Percentage of population with access to drinking water",unit:"%",value:3,natural_value:.986},{category:"Water availability",indicator:"Percentage of population with access to drinking water (change in last 3 years)",unit:"%",value:3,natural_value:.0016},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities",unit:"%",value:4,natural_value:.97},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities (change in last 3 years)",unit:"%",value:4,natural_value:9e-5},{category:"Food availability",indicator:"Cereal import dependency ratio (5-years average)",unit:"%",value:3,natural_value:.35},{category:"Food availability",indicator:"Cereal import dependency ratio (change in last 3 years)",unit:"%",value:3,natural_value:.002},{category:"Food availability",indicator:"Prevalence of undernourishment",unit:"%",value:3,natural_value:.058},{category:"Food availability",indicator:"Prevalence of undernourishment (change in last 3 years)",unit:"%",value:3,natural_value:-.001999999999999995},{category:"Food availability",indicator:"Prevalence of undernourishment children",unit:"%",value:4,natural_value:.011},{category:"Food availability",indicator:"Prevalence of undernourishment children (change in last 3 years)",unit:"%",value:3,natural_value:-.005000000000000001},{category:"Food availability",indicator:"Prevalence of moderate or severe food insecurity in the population",unit:"%",value:3,natural_value:.26},{category:"Food availability",indicator:"Share of imports in food resources",unit:"%",value:1,natural_value:.66},{category:"Food availability",indicator:"Percentage of people with access to at least one food vendor/retailer within 15 minutes of walking",unit:"%",value:3,natural_value:91},{category:"Food availability",indicator:"Perception of food availability index",unit:"index",value:3,natural_value:2.2},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity",unit:"%",value:3,natural_value:.996},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity (change in last 3 years)",unit:"%",value:3,natural_value:.0003348962072196038},{category:"Energy availability",indicator:"Consumption of electricity per capita",unit:"kWh/person",value:3,natural_value:1838.495873103703},{category:"Energy availability",indicator:"Consumption of electricity per capita (change in last 3 years)",unit:"%",value:4,natural_value:-.029342853464357277},{category:"Energy availability",indicator:"Electricity tariff to disposable income ratio",unit:"ratio",value:5,natural_value:.0001321820201166956},{category:"Energy availability",indicator:"Share of renewable sources in electricity consumption",unit:"%",value:4,natural_value:.349},{category:"Energy availability",indicator:"Perception of energy availability index",unit:"index",value:3,natural_value:1.07},{category:"Health",indicator:"Child mortality rate (under 5 years-old)",unit:"% of live births ",value:3,natural_value:14},{category:"Health",indicator:"City ambulance",unit:"Yes/No",value:5,natural_value:1},{category:"Health",indicator:"Life expectancy at birth, years",unit:"Years",value:5,natural_value:79.91},{category:"Health",indicator:"Life expectancy at birth goals",unit:"categories",value:3,natural_value:2},{category:"Health",indicator:"Number of hospital beds per 1,000 population",unit:"per 1,000",value:3,natural_value:2.25},{category:"Health",indicator:"Number of doctors per 1,000 population",unit:"per 1,000",value:1,natural_value:21.0740203193033},{category:"Health",indicator:"Maternal mortality ratio",unit:"deaths per 1,000 live births",value:3,natural_value:50},{category:"Health",indicator:"Ambulance arrival speed, min",unit:"min",value:5,natural_value:16},{category:"Education",indicator:"Literacy rate among population (15-24 Years)",unit:"%",value:3,natural_value:.988},{category:"Education",indicator:"Literacy rate among population (15-24 Years) (change in last 3 years)",unit:"%",value:3,natural_value:-.0013458966466194378},{category:"Education",indicator:"Primary education engagement",unit:"%",value:2,natural_value:.136},{category:"Education",indicator:"Pupils per teacher rate",unit:"ratio",value:3,natural_value:21.96},{category:"Education",indicator:"Proportion of population with post-secondary and higher education",unit:"%",value:3,natural_value:.267},{category:"Wealth",indicator:"Percentage of population with food expenditure is above 52% of total expenditure",unit:"%",value:3,natural_value:.17},{category:"Wealth",indicator:"Mean monthly salary",unit:"US dollars thousand",value:3,natural_value:1278.54},{category:"Wealth",indicator:"Mean monthly salary, change in last 3 years",unit:"%",value:3,natural_value:.025692033293787775},{category:"Wealth",indicator:"Disposable monthly income",unit:"US dollars thousand",value:2,natural_value:338.4257548066175},{category:"Wealth",indicator:"Disposable monthly income (change in last 3 years)",unit:"%",value:2,natural_value:-.06742304531464682},{category:"Wealth",indicator:"Debt to salary ratio",unit:"ratio",value:3,natural_value:4.732742033882397},{category:"Wealth",indicator:"Number of mobile phones per 1,000 population",unit:"per 1,000",value:3,natural_value:1202.5015122755053},{category:"Wealth",indicator:"Decile income coefficient",unit:"ratio",value:3,natural_value:31.666666666666668},{category:"Wealth",indicator:"Decile income coefficient (change in last 3 years)",unit:"%",value:3,natural_value:-.011987456560442311},{category:"Wealth",indicator:"Poverty headcount ratio at national poverty lines",unit:"%",value:3,natural_value:.0458},{category:"Wealth",indicator:"Working poverty rate (percentage of employed living below US$1.90 PPP), 15+ age (%) ",unit:"%",value:4,natural_value:.008},{category:"Wealth",indicator:"Poverty headcount ratio at $2.15 PPP 2017 a day",unit:"%",value:5,natural_value:.01},{category:"Wealth",indicator:"Living spaces per capita, sq m (change in last 3 years)",unit:"%",value:3,natural_value:.033},{category:"Wealth",indicator:"Population living in slums (% of urban population)",unit:"%",value:3,natural_value:.221},{category:"Wealth",indicator:"Availability of finance (consumer loans)",unit:"%",value:3,natural_value:.43},{category:"Wealth",indicator:"Perception of wealth & poverty index",unit:"index",value:3,natural_value:1.7},{category:"Safety",indicator:"Road fatalities rate per 100,000 population",unit:"per 100,000",value:4,natural_value:4.247303994294455},{category:"Safety",indicator:"Road fatalities rate per 100,000 population (change in last 3 years)",unit:"%",value:3,natural_value:-.051691630918183074},{category:"Safety",indicator:"Violent crime rate per 100,000 population",unit:"per 100,000",value:3,natural_value:10.8},{category:"Safety",indicator:"Violent crime rate per 100,000 population (change in last 3 years)",unit:"%",value:3,natural_value:-.012049365987475635},{category:"Safety",indicator:"Crime rate per 100,000 population",unit:"per 100,000",value:4,natural_value:45.15},{category:"Safety",indicator:"Crime rate per 100,000 population  (change in last 3 years)",unit:"%",value:3,natural_value:-.03},{category:"Safety",indicator:"Police arrival speed",unit:"min",value:3,natural_value:21.7},{category:"Safety",indicator:"Perception of safety index",unit:"index",value:3,natural_value:2.79},{category:"Livability",indicator:"Number of LEED certified green buildings",unit:"Certified square meters per capita",value:5,natural_value:127},{category:"Livability",indicator:"Number of BREEAM certified projects",unit:"Certified square meters per capita",value:1,natural_value:0},{category:"Livability",indicator:"Whether or not the city has ISO 37120 certification",unit:"Yes/No",value:5,natural_value:1},{category:"Livability",indicator:"Mobile connection coverage",unit:"%",value:3,natural_value:.93},{category:"Livability",indicator:"Internet coverage",unit:"%",value:3,natural_value:.9},{category:"Livability",indicator:"Perception of livability index",unit:"index",value:3,natural_value:1.5},{category:"Livability",indicator:"Share of population in 1 km from schools",unit:"%",value:3,natural_value:67.4},{category:"Livability",indicator:"Share of population in 1 km from parks",unit:"%",value:3,natural_value:64.3},{category:"Transport",indicator:"Time loss in traffic",unit:"%",value:2,natural_value:.3918},{category:"Transport",indicator:"Share of the population in 1 km from public transport stop",unit:"%",value:3,natural_value:68.2},{category:"Transport",indicator:"Ratio of the cost of monthly public transport usage Ithe cheapest option) to average mobthly income",unit:"ratio",value:3,natural_value:.04},{category:"Transport",indicator:"Ratio of the cost of a 1-kilometer taxi ride to average mobthly income",unit:"%",value:3,natural_value:.04},{category:"Transport",indicator:"Percentage of city's roads that are segregated and/or has specialized lane for cyclists",unit:"%",value:3,natural_value:.06},{category:"Transport",indicator:"Number of public electric vehicle (EV) charging points per 100,000 population",unit:"per 100,000",value:3,natural_value:1.4},{category:"Transport",indicator:"Public transport (excluding subway) operates by schedule ",unit:"Yes/No",value:5,natural_value:1},{category:"Transport",indicator:"Perception of transport index",unit:"index",value:3,natural_value:1.5},{category:"Inclusion",indicator:"Female-friendly city",unit:"1,2,3,4,5",value:3,natural_value:3},{category:"Inclusion",indicator:"Number of refugees per 1,000 population",unit:"per 1,000",value:1,natural_value:32.98092392553436},{category:"Inclusion",indicator:"Homeless people per 1,000 population",unit:"per 1,000",value:3,natural_value:7.7},{category:"Inclusion",indicator:"Difference in number of years of schooling between woman and man, woman to man ratio ",unit:"years",value:3,natural_value:1.05},{category:"Inclusion",indicator:"Slavery index",unit:"index",value:2,natural_value:33},{category:"Inclusion",indicator:"Percentage of women aged 25-34 years old that have successfully completed secondary education",unit:"%",value:2,natural_value:.3},{category:"Inclusion",indicator:"Regulations for building construction and equipment, public transport for people with disabilities",unit:"Yes/No",value:5,natural_value:1},{category:"Inclusion",indicator:"Perception of inclusion index",unit:"index",value:3,natural_value:2.3},{category:"Accountability",indicator:"City budget execution publication",unit:"Yes/No",value:5,natural_value:1},{category:"Accountability",indicator:"City budget publication",unit:"Yes/No",value:5,natural_value:1},{category:"Accountability",indicator:"Financial transparency on city government companies",unit:"Yes/No",value:1,natural_value:0},{category:"Accountability",indicator:"ISO certification",unit:"Yes/No",value:5,natural_value:1},{category:"Accountability",indicator:"City council checks and balances",unit:"Yes/No",value:5,natural_value:1},{category:"Accountability",indicator:"Plans to obtain ISO certification",unit:"Yes/No",value:1,natural_value:0},{category:"Accountability",indicator:"Perception of accountability index",unit:"index",value:3,natural_value:.9},{category:"City budget",indicator:"Poor financial condition",unit:"Yes/No",value:5,natural_value:0},{category:"City budget",indicator:"Central/higher level government financial intervention taking place",unit:"Yes/No",value:5,natural_value:0},{category:"City budget",indicator:"Long-term financial planning",unit:"Yes/No",value:5,natural_value:1},{category:"City budget",indicator:"Central/higher level government financial intervention is considered",unit:"Yes/No",value:1,natural_value:0},{category:"City budget",indicator:"Prudent fiscal policy requirements",unit:"Yes/No",value:5,natural_value:1},{category:"City budget",indicator:"Medium-term planning",unit:"Yes/No",value:5,natural_value:1},{category:"SME",indicator:"Number of SMEs per 100,000 population",unit:"per 100,000",value:3,natural_value:1188.4164559871294},{category:"SME",indicator:"Number of start-ups",unit:"start-ups",value:3,natural_value:775},{category:"SME",indicator:"Global Startup Ecosystem Index",unit:"index",value:5,natural_value:.662},{category:"SME",indicator:"Number of SMEs per capita/100 000 population (change in last 3 years)",unit:"%",value:3,natural_value:-.060895231200825406},{category:"SME",indicator:"Number of start-ups (change in last 3 years)",unit:"%",value:3,natural_value:.125},{category:"Public services",indicator:"Free phone to call the police, ambulance, firefighters",unit:"1,2,3,4,5",value:5,natural_value:1},{category:"Public services",indicator:"Services for working with citizens' appeals and complaint",unit:"Yes/No",value:5,natural_value:1},{category:"Public services",indicator:"E-gov services",unit:"Yes/No",value:1,natural_value:0},{category:"Public services",indicator:"Perception of public services index: Public Services",unit:"index",value:3,natural_value:1.77},{category:"Sustainability commitment",indicator:"City ESG reporting",unit:"Yes/No",value:5,natural_value:1},{category:"Sustainability commitment",indicator:"City ESG reporting verification",unit:"Yes/No",value:5,natural_value:1},{category:"Sustainability commitment",indicator:"ESG planning",unit:"Yes/No",value:5,natural_value:1},{category:"Sustainability commitment",indicator:"Plan with specific targets to develop and implement smart city principles",unit:"Yes/No",value:5,natural_value:1},{category:"Sustainability commitment",indicator:"Rollout and status of ESG / UN SDG training across the municipal/asset workforce",unit:"Yes/No",value:1,natural_value:0},{category:"Sustainability commitment",indicator:"City municipality involved in network or partnership promoting sustainable development (for example, C40 Cities network)",unit:"Yes/No",value:5,natural_value:1}]},{city:"Amman",data:[{category:"Air pollution",indicator:"CO2 emissions",unit:"kt",value:4,natural_value:2.29819392},{category:"Air pollution",indicator:"CO2 emissions (change in last 3 years)",unit:"%",value:3,natural_value:-.0397125056600682},{category:"Air pollution",indicator:"CO2 concentration",unit:"ppm",value:4,natural_value:424.0303438},{category:"Air pollution",indicator:"CO2 concentration (change in last 3 years)",unit:"%",value:5,natural_value:.010229294125018148},{category:"Air pollution",indicator:"Annual average of SO2 concentration in ambient air",unit:"microgram/m3",value:3,natural_value:19.05745758},{category:"Air pollution",indicator:"Annual Average of SO2 Concentration in Ambient Air (change in last 3 years)",unit:"%",value:3,natural_value:-.007976779262179951},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air",unit:"microgram/m3",value:2,natural_value:27.8},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air (change in last 3 years), microgram/m3",unit:"%",value:3,natural_value:.002166534267350411},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air, microgram/m3",unit:"microgram/m3",value:2,natural_value:63.70975559},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air (change in last 3 years), microgram/m3",unit:"%",value:3,natural_value:-.008936926031556151},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air, microgram/m3",unit:"microgram/m3",value:4,natural_value:.229819392},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air (change in last 3 years), microgram/m3",unit:"%",value:3,natural_value:-.0397125056600682},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air, microgram/m3",unit:"microgram/m3",value:4,natural_value:56.1712303},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air (change in last 3 years), microgram/m3",unit:"%",value:3,natural_value:-.02113665705443046},{category:"Air pollution",indicator:"Volatile organic compounds/reactive organic gases emissions",unit:"microgram/m3",value:3,natural_value:1.7},{category:"Air pollution",indicator:"Perception of air pollution index",unit:"index",value:3,natural_value:1.6},{category:"Air pollution",indicator:"Paris Agreement",unit:"Yes/No",value:5,natural_value:1},{category:"Water pollution",indicator:"Annual average of dissolved oxygen (DO) concentration in water",unit:"%",value:3,natural_value:6.08},{category:"Water pollution",indicator:"Annual average of pH concentration in water",unit:"pH",value:3,natural_value:7.1},{category:"Water pollution",indicator:"Annual average dissolved solids in drinking-water",unit:"ppm",value:2,natural_value:319.4},{category:"Water pollution",indicator:"Water management strategy in a city",unit:"Yes/No",value:5,natural_value:1},{category:"Water pollution",indicator:"Perception of water pollution index",unit:"index",value:3,natural_value:1.9},{category:"Land use and waste",indicator:"Share of devastated and degraded land area requiring reclamation",unit:"%",value:2,natural_value:23},{category:"Land use and waste",indicator:"3-year average growth rate of devastated and degraded land area requiring reclamation",unit:"%",value:3,natural_value:.002},{category:"Land use and waste",indicator:"Waste deposits",unit:"%",value:3,natural_value:.009},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous)",unit:"kg per capita ",value:3,natural_value:635},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous), (change in last 3 years)",unit:"%",value:3,natural_value:4.2},{category:"Land use and waste",indicator:"Total recycled construction waste",unit:"tons per capita",value:3,natural_value:1.7},{category:"Land use and waste",indicator:"Share of recycled construction and demolish waste in total generated construction and demolish waste",unit:"%",value:2,natural_value:.07},{category:"Land use and waste",indicator:"Total area of impervious surfaces and percentage to total city area",unit:"%",value:4,natural_value:.00578},{category:"Land use and waste",indicator:"Productive urban land (in percent total land)",unit:"%",value:3,natural_value:32.2},{category:"Land use and waste",indicator:"Waste managenet strategy",unit:"Yes/No",value:5,natural_value:1},{category:"Land use and waste",indicator:"Perception of waste index",unit:"index",value:3,natural_value:2.3},{category:"Land use and waste",indicator:"Green spaces, % city area",unit:"%",value:3,natural_value:.21},{category:"Land use and waste",indicator:"Green spaces, change in last 3 years",unit:"%",value:3,natural_value:-.06},{category:"Land use and waste",indicator:"NDVI",unit:"%",value:4,natural_value:.159},{category:"Natural disaster hazards",indicator:"Share of total area with altitude above sea level less than 0,5 meters",unit:"%",value:3,natural_value:.085},{category:"Natural disaster hazards",indicator:"Growth rate of freshwater mirror area",unit:"%",value:3,natural_value:-.06},{category:"Natural disaster hazards",indicator:"Number of registered heavy rain, flood and thunderbolt (change in last 3 years)",unit:"%",value:4,natural_value:-.115709},{category:"Natural disaster hazards",indicator:"Number of registered sand storm (change in last 3 years)",unit:"%",value:4,natural_value:-.115709},{category:"Natural disaster hazards",indicator:"Environmental/natural disasters’ risk mitigation",unit:"Yes/No",value:5,natural_value:1},{category:"Natural disaster hazards",indicator:"Strategy/policy/government officials’ statement on environmental issues ",unit:"Yes/No",value:5,natural_value:1},{category:"Natural disaster hazards",indicator:"Total overall losses from natural disaster hazards",unit:"US$ mln ",value:3,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of days with average daily temperature above the threshold for 1990-2010",unit:"days",value:3,natural_value:15},{category:"Natural disaster hazards",indicator:"Number of disruptions to basic services, attributed to disasters",unit:"%",value:3,natural_value:0},{category:"Water availability",indicator:"Water consumption per capita",unit:"mcm",value:3,natural_value:61e-6},{category:"Water availability",indicator:"Water tariff to disposable income ratio",unit:"ratio",value:3,natural_value:1.29},{category:"Water availability",indicator:"Sanitary facilities tariff to disposable income ratio",unit:"ratio",value:3,natural_value:1.1},{category:"Water availability",indicator:"Water consumption per capita (change in last 3 years)",unit:"%",value:3,natural_value:.037490119437293856},{category:"Water availability",indicator:"Percentage of population with access to drinking water",unit:"%",value:3,natural_value:.98},{category:"Water availability",indicator:"Percentage of population with access to drinking water (change in last 3 years)",unit:"%",value:3,natural_value:-337e-6},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities",unit:"%",value:4,natural_value:.971},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities (change in last 3 years)",unit:"%",value:4,natural_value:-343e-6},{category:"Food availability",indicator:"Cereal import dependency ratio (5-years average)",unit:"%",value:1,natural_value:1},{category:"Food availability",indicator:"Cereal import dependency ratio (change in last 3 years)",unit:"%",value:3,natural_value:.002},{category:"Food availability",indicator:"Prevalence of undernourishment",unit:"%",value:3,natural_value:.169},{category:"Food availability",indicator:"Prevalence of undernourishment (change in last 3 years)",unit:"%",value:3,natural_value:.05700000000000001},{category:"Food availability",indicator:"Prevalence of undernourishment children",unit:"%",value:4,natural_value:.006},{category:"Food availability",indicator:"Prevalence of undernourishment children (change in last 3 years)",unit:"%",value:3,natural_value:-.018000000000000002},{category:"Food availability",indicator:"Prevalence of moderate or severe food insecurity in the population",unit:"%",value:3,natural_value:.26},{category:"Food availability",indicator:"Share of imports in food resources",unit:"%",value:3,natural_value:.43},{category:"Food availability",indicator:"Percentage of people with access to at least one food vendor/retailer within 15 minutes of walking",unit:"%",value:3,natural_value:91},{category:"Food availability",indicator:"Perception of food availability index",unit:"index",value:3,natural_value:2.2},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity",unit:"%",value:5,natural_value:1},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity (change in last 3 years)",unit:"%",value:3,natural_value:.01},{category:"Energy availability",indicator:"Consumption of electricity per capita",unit:"kWh/person",value:3,natural_value:4171},{category:"Energy availability",indicator:"Consumption of electricity per capita (change in last 3 years)",unit:"%",value:3,natural_value:.04},{category:"Energy availability",indicator:"Electricity tariff to disposable income ratio",unit:"ratio",value:3,natural_value:.1},{category:"Energy availability",indicator:"Share of renewable sources in electricity consumption",unit:"%",value:2,natural_value:.1104},{category:"Energy availability",indicator:"Perception of energy availability index",unit:"index",value:3,natural_value:1.07},{category:"Health",indicator:"Child mortality rate (under 5 years-old)",unit:"% of live births ",value:3,natural_value:14.6},{category:"Health",indicator:"City ambulance",unit:"Yes/No",value:5,natural_value:1},{category:"Health",indicator:"Life expectancy at birth, years",unit:"Years",value:4,natural_value:77.9},{category:"Health",indicator:"Life expectancy at birth goals",unit:"categories",value:1,natural_value:1},{category:"Health",indicator:"Number of hospital beds per 1,000 population",unit:"per 1,000",value:3,natural_value:1.47},{category:"Health",indicator:"Number of doctors per 1,000 population",unit:"per 1,000",value:3,natural_value:2.5},{category:"Health",indicator:"Maternal mortality ratio",unit:"deaths per 1,000 live births",value:4,natural_value:41},{category:"Health",indicator:"Ambulance arrival speed, min",unit:"min",value:5,natural_value:8.8},{category:"Education",indicator:"Literacy rate among population (15-24 Years)",unit:"%",value:4,natural_value:.994199982},{category:"Education",indicator:"Literacy rate among population (15-24 Years) (change in last 3 years)",unit:"%",value:3,natural_value:312e-6},{category:"Education",indicator:"Primary education engagement",unit:"%",value:3,natural_value:.5406670007324498},{category:"Education",indicator:"Pupils per teacher rate",unit:"ratio",value:3,natural_value:18.5},{category:"Education",indicator:"Proportion of population with post-secondary and higher education",unit:"%",value:3,natural_value:.325574417114258},{category:"Wealth",indicator:"Percentage of population with food expenditure is above 52% of total expenditure",unit:"%",value:4,natural_value:.071},{category:"Wealth",indicator:"Mean monthly salary",unit:"US dollars thousand",value:3,natural_value:2284.29},{category:"Wealth",indicator:"Mean monthly salary, change in last 3 years",unit:"%",value:3,natural_value:.01098},{category:"Wealth",indicator:"Disposable monthly income",unit:"US dollars thousand",value:3,natural_value:595.7819488480237},{category:"Wealth",indicator:"Disposable monthly income (change in last 3 years)",unit:"%",value:3,natural_value:.04442},{category:"Wealth",indicator:"Debt to salary ratio",unit:"ratio",value:5,natural_value:.088},{category:"Wealth",indicator:"Number of mobile phones per 1,000 population",unit:"per 1,000",value:4,natural_value:675.6799743},{category:"Wealth",indicator:"Decile income coefficient",unit:"ratio",value:4,natural_value:7.857142857142857},{category:"Wealth",indicator:"Decile income coefficient (change in last 3 years)",unit:"%",value:3,natural_value:-.011548},{category:"Wealth",indicator:"Poverty headcount ratio at national poverty lines",unit:"%",value:3,natural_value:.157},{category:"Wealth",indicator:"Working poverty rate (percentage of employed living below US$1.90 PPP), 15+ age (%) ",unit:"%",value:1,natural_value:.2},{category:"Wealth",indicator:"Poverty headcount ratio at $2.15 PPP 2017 a day",unit:"%",value:1,natural_value:.1},{category:"Wealth",indicator:"Living spaces per capita, sq m (change in last 3 years)",unit:"%",value:3,natural_value:.033},{category:"Wealth",indicator:"Population living in slums (% of urban population)",unit:"%",value:3,natural_value:.17},{category:"Wealth",indicator:"Availability of finance (consumer loans)",unit:"%",value:3,natural_value:.43},{category:"Wealth",indicator:"Perception of wealth & poverty index",unit:"index",value:3,natural_value:1.7},{category:"Safety",indicator:"Road fatalities rate per 100,000 population",unit:"per 100,000",value:2,natural_value:19.68},{category:"Safety",indicator:"Road fatalities rate per 100,000 population (change in last 3 years)",unit:"%",value:3,natural_value:-.095554},{category:"Safety",indicator:"Violent crime rate per 100,000 population",unit:"per 100,000",value:3,natural_value:11.418181818181818},{category:"Safety",indicator:"Violent crime rate per 100,000 population (change in last 3 years)",unit:"%",value:2,natural_value:.075114},{category:"Safety",indicator:"Crime rate per 100,000 population",unit:"per 100,000",value:3,natural_value:530.1151894060845},{category:"Safety",indicator:"Crime rate per 100,000 population  (change in last 3 years)",unit:"%",value:3,natural_value:-.03},{category:"Safety",indicator:"Police arrival speed",unit:"min",value:3,natural_value:21.7},{category:"Safety",indicator:"Perception of safety index",unit:"index",value:3,natural_value:2.79},{category:"Livability",indicator:"Number of LEED certified green buildings",unit:"Certified square meters per capita",value:4,natural_value:21.55},{category:"Livability",indicator:"Number of BREEAM certified projects",unit:"Certified square meters per capita",value:1,natural_value:0},{category:"Livability",indicator:"Whether or not the city has ISO 37120 certification",unit:"Yes/No",value:5,natural_value:1},{category:"Livability",indicator:"Mobile connection coverage",unit:"%",value:3,natural_value:.93},{category:"Livability",indicator:"Internet coverage",unit:"%",value:3,natural_value:.9},{category:"Livability",indicator:"Perception of livability index",unit:"index",value:3,natural_value:1.5},{category:"Livability",indicator:"Share of population in 1 km from schools",unit:"%",value:3,natural_value:37.6},{category:"Livability",indicator:"Share of population in 1 km from parks",unit:"%",value:3,natural_value:64.3},{category:"Transport",indicator:"Time loss in traffic",unit:"%",value:2,natural_value:.3768},{category:"Transport",indicator:"Share of the population in 1 km from public transport stop",unit:"%",value:3,natural_value:29.1},{category:"Transport",indicator:"Ratio of the cost of monthly public transport usage Ithe cheapest option) to average mobthly income",unit:"ratio",value:5,natural_value:.01751091148672016},{category:"Transport",indicator:"Ratio of the cost of a 1-kilometer taxi ride to average mobthly income",unit:"%",value:5,natural_value:.0006566591807520061},{category:"Transport",indicator:"Percentage of city's roads that are segregated and/or has specialized lane for cyclists",unit:"%",value:3,natural_value:.06},{category:"Transport",indicator:"Number of public electric vehicle (EV) charging points per 100,000 population",unit:"per 100,000",value:2,natural_value:.28846153846153844},{category:"Transport",indicator:"Public transport (excluding subway) operates by schedule ",unit:"Yes/No",value:5,natural_value:1},{category:"Transport",indicator:"Perception of transport index",unit:"index",value:3,natural_value:1.5},{category:"Inclusion",indicator:"Female-friendly city",unit:"1,2,3,4,5",value:5,natural_value:1},{category:"Inclusion",indicator:"Number of refugees per 1,000 population",unit:"per 1,000",value:3,natural_value:4.1},{category:"Inclusion",indicator:"Homeless people per 1,000 population",unit:"per 1,000",value:3,natural_value:7.7},{category:"Inclusion",indicator:"Difference in number of years of schooling between woman and man, woman to man ratio ",unit:"years",value:3,natural_value:.93},{category:"Inclusion",indicator:"Slavery index",unit:"index",value:1,natural_value:49},{category:"Inclusion",indicator:"Percentage of women aged 25-34 years old that have successfully completed secondary education",unit:"%",value:3,natural_value:.41},{category:"Inclusion",indicator:"Regulations for building construction and equipment, public transport for people with disabilities",unit:"Yes/No",value:5,natural_value:1},{category:"Inclusion",indicator:"Perception of inclusion index",unit:"index",value:3,natural_value:2.3},{category:"Accountability",indicator:"City budget execution publication",unit:"Yes/No",value:5,natural_value:1},{category:"Accountability",indicator:"City budget publication",unit:"Yes/No",value:5,natural_value:1},{category:"Accountability",indicator:"Financial transparency on city government companies",unit:"Yes/No",value:1,natural_value:0},{category:"Accountability",indicator:"ISO certification",unit:"Yes/No",value:5,natural_value:1},{category:"Accountability",indicator:"City council checks and balances",unit:"Yes/No",value:5,natural_value:1},{category:"Accountability",indicator:"Plans to obtain ISO certification",unit:"Yes/No",value:5,natural_value:1},{category:"Accountability",indicator:"Perception of accountability index",unit:"index",value:3,natural_value:.9},{category:"City budget",indicator:"Poor financial condition",unit:"Yes/No",value:5,natural_value:0},{category:"City budget",indicator:"Central/higher level government financial intervention taking place",unit:"Yes/No",value:5,natural_value:0},{category:"City budget",indicator:"Long-term financial planning",unit:"Yes/No",value:"",natural_value:""},{category:"City budget",indicator:"Central/higher level government financial intervention is considered",unit:"Yes/No",value:1,natural_value:0},{category:"City budget",indicator:"Prudent fiscal policy requirements",unit:"Yes/No",value:1,natural_value:0},{category:"City budget",indicator:"Medium-term planning",unit:"Yes/No",value:5,natural_value:1},{category:"SME",indicator:"Number of SMEs per 100,000 population",unit:"per 100,000",value:3,natural_value:9336},{category:"SME",indicator:"Number of start-ups",unit:"start-ups",value:2,natural_value:80},{category:"SME",indicator:"Global Startup Ecosystem Index",unit:"index",value:2,natural_value:2.425},{category:"SME",indicator:"Number of SMEs per capita/100 000 population (change in last 3 years)",unit:"%",value:3,natural_value:-7e-4},{category:"SME",indicator:"Number of start-ups (change in last 3 years)",unit:"%",value:3,natural_value:.125},{category:"Public services",indicator:"Free phone to call the police, ambulance, firefighters",unit:"1,2,3,4,5",value:1,natural_value:0},{category:"Public services",indicator:"Services for working with citizens' appeals and complaint",unit:"Yes/No",value:5,natural_value:1},{category:"Public services",indicator:"E-gov services",unit:"Yes/No",value:5,natural_value:1},{category:"Public services",indicator:"Perception of public services index: Public Services",unit:"index",value:3,natural_value:1.77},{category:"Sustainability commitment",indicator:"City ESG reporting",unit:"Yes/No",value:1,natural_value:0},{category:"Sustainability commitment",indicator:"City ESG reporting verification",unit:"Yes/No",value:1,natural_value:0},{category:"Sustainability commitment",indicator:"ESG planning",unit:"Yes/No",value:5,natural_value:1},{category:"Sustainability commitment",indicator:"Plan with specific targets to develop and implement smart city principles",unit:"Yes/No",value:5,natural_value:1},{category:"Sustainability commitment",indicator:"Rollout and status of ESG / UN SDG training across the municipal/asset workforce",unit:"Yes/No",value:1,natural_value:0},{category:"Sustainability commitment",indicator:"City municipality involved in network or partnership promoting sustainable development (for example, C40 Cities network)",unit:"Yes/No",value:5,natural_value:1}]},{city:"Bangkok",data:[{category:"Air pollution",indicator:"CO2 emissions",unit:"kt",value:3,natural_value:4.43369794},{category:"Air pollution",indicator:"CO2 emissions (change in last 3 years)",unit:"%",value:3,natural_value:.07848997390501591},{category:"Air pollution",indicator:"CO2 concentration",unit:"ppm",value:2,natural_value:460.5116023},{category:"Air pollution",indicator:"CO2 concentration (change in last 3 years)",unit:"%",value:5,natural_value:.0058540614082655705},{category:"Air pollution",indicator:"Annual average of SO2 concentration in ambient air",unit:"microgram/m3",value:3,natural_value:23.48326534},{category:"Air pollution",indicator:"Annual Average of SO2 Concentration in Ambient Air (change in last 3 years)",unit:"%",value:3,natural_value:.09924267894029333},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air",unit:"microgram/m3",value:3,natural_value:21.5},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air (change in last 3 years), microgram/m3",unit:"%",value:3,natural_value:.09681541685835517},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air, microgram/m3",unit:"microgram/m3",value:5,natural_value:40.72419549},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air (change in last 3 years), microgram/m3",unit:"%",value:3,natural_value:-.07769443975402442},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air, microgram/m3",unit:"microgram/m3",value:3,natural_value:.443369794},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air (change in last 3 years), microgram/m3",unit:"%",value:3,natural_value:.07848997390501591},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air, microgram/m3",unit:"microgram/m3",value:3,natural_value:80.77055411},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air (change in last 3 years), microgram/m3",unit:"%",value:3,natural_value:.0716916595957008},{category:"Air pollution",indicator:"Volatile organic compounds/reactive organic gases emissions",unit:"microgram/m3",value:3,natural_value:1.7},{category:"Air pollution",indicator:"Perception of air pollution index",unit:"index",value:3,natural_value:1.6},{category:"Air pollution",indicator:"Paris Agreement",unit:"Yes/No",value:5,natural_value:1},{category:"Water pollution",indicator:"Annual average of dissolved oxygen (DO) concentration in water",unit:"%",value:3,natural_value:6.08},{category:"Water pollution",indicator:"Annual average of pH concentration in water",unit:"pH",value:3,natural_value:7.1},{category:"Water pollution",indicator:"Annual average dissolved solids in drinking-water",unit:"ppm",value:3,natural_value:139},{category:"Water pollution",indicator:"Water management strategy in a city",unit:"Yes/No",value:5,natural_value:0},{category:"Water pollution",indicator:"Perception of water pollution index",unit:"index",value:3,natural_value:1.9},{category:"Land use and waste",indicator:"Share of devastated and degraded land area requiring reclamation",unit:"%",value:2,natural_value:21},{category:"Land use and waste",indicator:"3-year average growth rate of devastated and degraded land area requiring reclamation",unit:"%",value:3,natural_value:.002},{category:"Land use and waste",indicator:"Waste deposits",unit:"%",value:3,natural_value:.009},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous)",unit:"kg per capita ",value:3,natural_value:635},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous), (change in last 3 years)",unit:"%",value:3,natural_value:4.2},{category:"Land use and waste",indicator:"Total recycled construction waste",unit:"tons per capita",value:3,natural_value:1.7},{category:"Land use and waste",indicator:"Share of recycled construction and demolish waste in total generated construction and demolish waste",unit:"%",value:3,natural_value:.249},{category:"Land use and waste",indicator:"Total area of impervious surfaces and percentage to total city area",unit:"%",value:4,natural_value:.010827876520112254},{category:"Land use and waste",indicator:"Productive urban land (in percent total land)",unit:"%",value:3,natural_value:32.2},{category:"Land use and waste",indicator:"Waste managenet strategy",unit:"Yes/No",value:5,natural_value:1},{category:"Land use and waste",indicator:"Perception of waste index",unit:"index",value:3,natural_value:2.3},{category:"Land use and waste",indicator:"Green spaces, % city area",unit:"%",value:3,natural_value:.21},{category:"Land use and waste",indicator:"Green spaces, change in last 3 years",unit:"%",value:3,natural_value:-.06},{category:"Land use and waste",indicator:"NDVI",unit:"%",value:3,natural_value:.373},{category:"Natural disaster hazards",indicator:"Share of total area with altitude above sea level less than 0,5 meters",unit:"%",value:3,natural_value:.085},{category:"Natural disaster hazards",indicator:"Growth rate of freshwater mirror area",unit:"%",value:3,natural_value:-.06},{category:"Natural disaster hazards",indicator:"Number of registered heavy rain, flood and thunderbolt (change in last 3 years)",unit:"%",value:1,natural_value:.5},{category:"Natural disaster hazards",indicator:"Number of registered sand storm (change in last 3 years)",unit:"%",value:1,natural_value:.5},{category:"Natural disaster hazards",indicator:"Environmental/natural disasters’ risk mitigation",unit:"Yes/No",value:5,natural_value:1},{category:"Natural disaster hazards",indicator:"Strategy/policy/government officials’ statement on environmental issues ",unit:"Yes/No",value:5,natural_value:1},{category:"Natural disaster hazards",indicator:"Total overall losses from natural disaster hazards",unit:"US$ mln ",value:2,natural_value:606.681668405105},{category:"Natural disaster hazards",indicator:"Number of days with average daily temperature above the threshold for 1990-2010",unit:"days",value:3,natural_value:1},{category:"Natural disaster hazards",indicator:"Number of disruptions to basic services, attributed to disasters",unit:"%",value:3,natural_value:0},{category:"Water availability",indicator:"Water consumption per capita",unit:"mcm",value:3,natural_value:1095e-7},{category:"Water availability",indicator:"Water tariff to disposable income ratio",unit:"ratio",value:4,natural_value:.01731179318646874},{category:"Water availability",indicator:"Sanitary facilities tariff to disposable income ratio",unit:"ratio",value:3,natural_value:1.1},{category:"Water availability",indicator:"Water consumption per capita (change in last 3 years)",unit:"%",value:5,natural_value:-.004},{category:"Water availability",indicator:"Percentage of population with access to drinking water",unit:"%",value:5,natural_value:.99},{category:"Water availability",indicator:"Percentage of population with access to drinking water (change in last 3 years)",unit:"%",value:3,natural_value:.0016},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities",unit:"%",value:4,natural_value:.987},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities (change in last 3 years)",unit:"%",value:4,natural_value:.002035},{category:"Food availability",indicator:"Cereal import dependency ratio (5-years average)",unit:"%",value:2,natural_value:.57},{category:"Food availability",indicator:"Cereal import dependency ratio (change in last 3 years)",unit:"%",value:3,natural_value:.002},{category:"Food availability",indicator:"Prevalence of undernourishment",unit:"%",value:3,natural_value:.052},{category:"Food availability",indicator:"Prevalence of undernourishment (change in last 3 years)",unit:"%",value:3,natural_value:-.008},{category:"Food availability",indicator:"Prevalence of undernourishment children",unit:"%",value:4,natural_value:.077},{category:"Food availability",indicator:"Prevalence of undernourishment children (change in last 3 years)",unit:"%",value:5,natural_value:.023},{category:"Food availability",indicator:"Prevalence of moderate or severe food insecurity in the population",unit:"%",value:5,natural_value:.071},{category:"Food availability",indicator:"Share of imports in food resources",unit:"%",value:5,natural_value:.04},{category:"Food availability",indicator:"Percentage of people with access to at least one food vendor/retailer within 15 minutes of walking",unit:"%",value:3,natural_value:91},{category:"Food availability",indicator:"Perception of food availability index",unit:"index",value:3,natural_value:2.2},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity",unit:"%",value:5,natural_value:1},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity (change in last 3 years)",unit:"%",value:3,natural_value:601e-6},{category:"Energy availability",indicator:"Consumption of electricity per capita",unit:"kWh/person",value:3,natural_value:3748.45273},{category:"Energy availability",indicator:"Consumption of electricity per capita (change in last 3 years)",unit:"%",value:3,natural_value:.04},{category:"Energy availability",indicator:"Electricity tariff to disposable income ratio",unit:"ratio",value:5,natural_value:.001137782160890261},{category:"Energy availability",indicator:"Share of renewable sources in electricity consumption",unit:"%",value:2,natural_value:.1526},{category:"Energy availability",indicator:"Perception of energy availability index",unit:"index",value:3,natural_value:1.07},{category:"Health",indicator:"Child mortality rate (under 5 years-old)",unit:"% of live births ",value:3,natural_value:8.29},{category:"Health",indicator:"City ambulance",unit:"Yes/No",value:5,natural_value:1},{category:"Health",indicator:"Life expectancy at birth, years",unit:"Years",value:4,natural_value:77.74},{category:"Health",indicator:"Life expectancy at birth goals",unit:"categories",value:5,natural_value:3},{category:"Health",indicator:"Number of hospital beds per 1,000 population",unit:"per 1,000",value:3,natural_value:2.41},{category:"Health",indicator:"Number of doctors per 1,000 population",unit:"per 1,000",value:4,natural_value:.95},{category:"Health",indicator:"Maternal mortality ratio",unit:"deaths per 1,000 live births",value:4,natural_value:29},{category:"Health",indicator:"Ambulance arrival speed, min",unit:"min",value:1,natural_value:300},{category:"Education",indicator:"Literacy rate among population (15-24 Years)",unit:"%",value:3,natural_value:.988000030517578},{category:"Education",indicator:"Literacy rate among population (15-24 Years) (change in last 3 years)",unit:"%",value:3,natural_value:943e-6},{category:"Education",indicator:"Primary education engagement",unit:"%",value:3,natural_value:.484145},{category:"Education",indicator:"Pupils per teacher rate",unit:"ratio",value:3,natural_value:16.6},{category:"Education",indicator:"Proportion of population with post-secondary and higher education",unit:"%",value:2,natural_value:.129012299},{category:"Wealth",indicator:"Percentage of population with food expenditure is above 52% of total expenditure",unit:"%",value:3,natural_value:.18},{category:"Wealth",indicator:"Mean monthly salary",unit:"US dollars thousand",value:2,natural_value:420.54},{category:"Wealth",indicator:"Mean monthly salary, change in last 3 years",unit:"%",value:3,natural_value:.016679},{category:"Wealth",indicator:"Disposable monthly income",unit:"US dollars thousand",value:3,natural_value:571.2868617059399},{category:"Wealth",indicator:"Disposable monthly income (change in last 3 years)",unit:"%",value:3,natural_value:-.024122},{category:"Wealth",indicator:"Debt to salary ratio",unit:"ratio",value:5,natural_value:.2270070622615472},{category:"Wealth",indicator:"Number of mobile phones per 1,000 population",unit:"per 1,000",value:4,natural_value:1763.169269},{category:"Wealth",indicator:"Decile income coefficient",unit:"ratio",value:4,natural_value:8.53125},{category:"Wealth",indicator:"Decile income coefficient (change in last 3 years)",unit:"%",value:3,natural_value:.011596},{category:"Wealth",indicator:"Poverty headcount ratio at national poverty lines",unit:"%",value:3,natural_value:.063},{category:"Wealth",indicator:"Working poverty rate (percentage of employed living below US$1.90 PPP), 15+ age (%) ",unit:"%",value:2,natural_value:.1},{category:"Wealth",indicator:"Poverty headcount ratio at $2.15 PPP 2017 a day",unit:"%",value:2,natural_value:.04},{category:"Wealth",indicator:"Living spaces per capita, sq m (change in last 3 years)",unit:"%",value:3,natural_value:.033},{category:"Wealth",indicator:"Population living in slums (% of urban population)",unit:"%",value:4,natural_value:.0679482},{category:"Wealth",indicator:"Availability of finance (consumer loans)",unit:"%",value:3,natural_value:.43},{category:"Wealth",indicator:"Perception of wealth & poverty index",unit:"index",value:3,natural_value:1.7},{category:"Safety",indicator:"Road fatalities rate per 100,000 population",unit:"per 100,000",value:2,natural_value:30.48},{category:"Safety",indicator:"Road fatalities rate per 100,000 population (change in last 3 years)",unit:"%",value:3,natural_value:-.0137},{category:"Safety",indicator:"Violent crime rate per 100,000 population",unit:"per 100,000",value:4,natural_value:2.58},{category:"Safety",indicator:"Violent crime rate per 100,000 population (change in last 3 years)",unit:"%",value:2,natural_value:.0481278275098662},{category:"Safety",indicator:"Crime rate per 100,000 population",unit:"per 100,000",value:4,natural_value:40.55},{category:"Safety",indicator:"Crime rate per 100,000 population  (change in last 3 years)",unit:"%",value:3,natural_value:-.03},{category:"Safety",indicator:"Police arrival speed",unit:"min",value:3,natural_value:20},{category:"Safety",indicator:"Perception of safety index",unit:"index",value:3,natural_value:2.79},{category:"Livability",indicator:"Number of LEED certified green buildings",unit:"Certified square meters per capita",value:4,natural_value:21.55},{category:"Livability",indicator:"Number of BREEAM certified projects",unit:"Certified square meters per capita",value:1,natural_value:0},{category:"Livability",indicator:"Whether or not the city has ISO 37120 certification",unit:"Yes/No",value:1,natural_value:0},{category:"Livability",indicator:"Mobile connection coverage",unit:"%",value:5,natural_value:1},{category:"Livability",indicator:"Internet coverage",unit:"%",value:5,natural_value:1},{category:"Livability",indicator:"Perception of livability index",unit:"index",value:3,natural_value:1.5},{category:"Livability",indicator:"Share of population in 1 km from schools",unit:"%",value:3,natural_value:29.4},{category:"Livability",indicator:"Share of population in 1 km from parks",unit:"%",value:3,natural_value:64.3},{category:"Transport",indicator:"Time loss in traffic",unit:"%",value:1,natural_value:.6456},{category:"Transport",indicator:"Share of the population in 1 km from public transport stop",unit:"%",value:3,natural_value:55.1},{category:"Transport",indicator:"Ratio of the cost of monthly public transport usage Ithe cheapest option) to average mobthly income",unit:"ratio",value:5,natural_value:.09120895596981358},{category:"Transport",indicator:"Ratio of the cost of a 1-kilometer taxi ride to average mobthly income",unit:"%",value:5,natural_value:.002687021448613687},{category:"Transport",indicator:"Percentage of city's roads that are segregated and/or has specialized lane for cyclists",unit:"%",value:3,natural_value:.06},{category:"Transport",indicator:"Number of public electric vehicle (EV) charging points per 100,000 population",unit:"per 100,000",value:5,natural_value:3.191340782122905},{category:"Transport",indicator:"Public transport (excluding subway) operates by schedule ",unit:"Yes/No",value:5,natural_value:1},{category:"Transport",indicator:"Perception of transport index",unit:"index",value:3,natural_value:1.5},{category:"Inclusion",indicator:"Female-friendly city",unit:"1,2,3,4,5",value:1,natural_value:4},{category:"Inclusion",indicator:"Number of refugees per 1,000 population",unit:"per 1,000",value:3,natural_value:4.1},{category:"Inclusion",indicator:"Homeless people per 1,000 population",unit:"per 1,000",value:5,natural_value:.229357798},{category:"Inclusion",indicator:"Difference in number of years of schooling between woman and man, woman to man ratio ",unit:"years",value:3,natural_value:.97},{category:"Inclusion",indicator:"Slavery index",unit:"index",value:1,natural_value:46},{category:"Inclusion",indicator:"Percentage of women aged 25-34 years old that have successfully completed secondary education",unit:"%",value:3,natural_value:.41},{category:"Inclusion",indicator:"Regulations for building construction and equipment, public transport for people with disabilities",unit:"Yes/No",value:5,natural_value:1},{category:"Inclusion",indicator:"Perception of inclusion index",unit:"index",value:3,natural_value:2.3},{category:"Accountability",indicator:"City budget execution publication",unit:"Yes/No",value:5,natural_value:1},{category:"Accountability",indicator:"City budget publication",unit:"Yes/No",value:5,natural_value:1},{category:"Accountability",indicator:"Financial transparency on city government companies",unit:"Yes/No",value:1,natural_value:0},{category:"Accountability",indicator:"ISO certification",unit:"Yes/No",value:1,natural_value:0},{category:"Accountability",indicator:"City council checks and balances",unit:"Yes/No",value:5,natural_value:1},{category:"Accountability",indicator:"Plans to obtain ISO certification",unit:"Yes/No",value:1,natural_value:0},{category:"Accountability",indicator:"Perception of accountability index",unit:"index",value:3,natural_value:.9},{category:"City budget",indicator:"Poor financial condition",unit:"Yes/No",value:5,natural_value:0},{category:"City budget",indicator:"Central/higher level government financial intervention taking place",unit:"Yes/No",value:5,natural_value:0},{category:"City budget",indicator:"Long-term financial planning",unit:"Yes/No",value:1,natural_value:0},{category:"City budget",indicator:"Central/higher level government financial intervention is considered",unit:"Yes/No",value:1,natural_value:0},{category:"City budget",indicator:"Prudent fiscal policy requirements",unit:"Yes/No",value:1,natural_value:0},{category:"City budget",indicator:"Medium-term planning",unit:"Yes/No",value:1,natural_value:0},{category:"SME",indicator:"Number of SMEs per 100,000 population",unit:"per 100,000",value:3,natural_value:4558.664923782264},{category:"SME",indicator:"Number of start-ups",unit:"start-ups",value:2,natural_value:184},{category:"SME",indicator:"Global Startup Ecosystem Index",unit:"index",value:4,natural_value:8.619},{category:"SME",indicator:"Number of SMEs per capita/100 000 population (change in last 3 years)",unit:"%",value:3,natural_value:.011495},{category:"SME",indicator:"Number of start-ups (change in last 3 years)",unit:"%",value:3,natural_value:.125},{category:"Public services",indicator:"Free phone to call the police, ambulance, firefighters",unit:"1,2,3,4,5",value:1,natural_value:0},{category:"Public services",indicator:"Services for working with citizens' appeals and complaint",unit:"Yes/No",value:1,natural_value:0},{category:"Public services",indicator:"E-gov services",unit:"Yes/No",value:1,natural_value:0},{category:"Public services",indicator:"Perception of public services index: Public Services",unit:"index",value:3,natural_value:1.77},{category:"Sustainability commitment",indicator:"City ESG reporting",unit:"Yes/No",value:5,natural_value:1},{category:"Sustainability commitment",indicator:"City ESG reporting verification",unit:"Yes/No",value:1,natural_value:0},{category:"Sustainability commitment",indicator:"ESG planning",unit:"Yes/No",value:5,natural_value:1},{category:"Sustainability commitment",indicator:"Plan with specific targets to develop and implement smart city principles",unit:"Yes/No",value:5,natural_value:1},{category:"Sustainability commitment",indicator:"Rollout and status of ESG / UN SDG training across the municipal/asset workforce",unit:"Yes/No",value:5,natural_value:1},{category:"Sustainability commitment",indicator:"City municipality involved in network or partnership promoting sustainable development (for example, C40 Cities network)",unit:"Yes/No",value:5,natural_value:1}]},{city:"Colombo",data:[{category:"Air pollution",indicator:"CO2 emissions",unit:"kt",value:3,natural_value:3.6589237000000003},{category:"Air pollution",indicator:"CO2 emissions (change in last 3 years)",unit:"%",value:3,natural_value:.026410067738081355},{category:"Air pollution",indicator:"CO2 concentration",unit:"ppm",value:3,natural_value:436.697055},{category:"Air pollution",indicator:"CO2 concentration (change in last 3 years)",unit:"%",value:5,natural_value:.009401072323507535},{category:"Air pollution",indicator:"Annual average of SO2 concentration in ambient air",unit:"microgram/m3",value:3,natural_value:18.4707334},{category:"Air pollution",indicator:"Annual Average of SO2 Concentration in Ambient Air (change in last 3 years)",unit:"%",value:3,natural_value:-.002810218110774317},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air",unit:"microgram/m3",value:3,natural_value:13.5},{category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air (change in last 3 years), microgram/m3",unit:"%",value:3,natural_value:-.015029913906318366},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air, microgram/m3",unit:"microgram/m3",value:3,natural_value:48.62512501},{category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air (change in last 3 years), microgram/m3",unit:"%",value:3,natural_value:.041136887700210525},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air, microgram/m3",unit:"microgram/m3",value:3,natural_value:.36589237},{category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air (change in last 3 years), microgram/m3",unit:"%",value:3,natural_value:.026410067738081355},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air, microgram/m3",unit:"microgram/m3",value:3,natural_value:75.11740601},{category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air (change in last 3 years), microgram/m3",unit:"%",value:3,natural_value:.031062641636741342},{category:"Air pollution",indicator:"Volatile organic compounds/reactive organic gases emissions",unit:"microgram/m3",value:3,natural_value:1.7},{category:"Air pollution",indicator:"Perception of air pollution index",unit:"index",value:3,natural_value:1.6},{category:"Air pollution",indicator:"Paris Agreement",unit:"Yes/No",value:5,natural_value:1},{category:"Water pollution",indicator:"Annual average of dissolved oxygen (DO) concentration in water",unit:"%",value:3,natural_value:6.08},{category:"Water pollution",indicator:"Annual average of pH concentration in water",unit:"pH",value:3,natural_value:7.1},{category:"Water pollution",indicator:"Annual average dissolved solids in drinking-water",unit:"ppm",value:4,natural_value:24.51},{category:"Water pollution",indicator:"Water management strategy in a city",unit:"Yes/No",value:5,natural_value:1},{category:"Water pollution",indicator:"Perception of water pollution index",unit:"index",value:3,natural_value:1.9},{category:"Land use and waste",indicator:"Share of devastated and degraded land area requiring reclamation",unit:"%",value:3,natural_value:7},{category:"Land use and waste",indicator:"3-year average growth rate of devastated and degraded land area requiring reclamation",unit:"%",natural_value:.002},{category:"Land use and waste",indicator:"Waste deposits",unit:"%",natural_value:.005},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous)",unit:"kg per capita ",value:3,natural_value:635},{category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous), (change in last 3 years)",unit:"%",value:3,natural_value:4.2},{category:"Land use and waste",indicator:"Total recycled construction waste",unit:"tons per capita",value:3,natural_value:1.7},{category:"Land use and waste",indicator:"Share of recycled construction and demolish waste in total generated construction and demolish waste",unit:"%",value:3,natural_value:.249},{category:"Land use and waste",indicator:"Total area of impervious surfaces and percentage to total city area",unit:"%",value:3,natural_value:.02},{category:"Land use and waste",indicator:"Productive urban land (in percent total land)",unit:"%",value:3,natural_value:32.2},{category:"Land use and waste",indicator:"Waste managenet strategy",unit:"Yes/No",value:1,natural_value:0},{category:"Land use and waste",indicator:"Perception of waste index",unit:"index",value:3,natural_value:2.3},{category:"Land use and waste",indicator:"Green spaces, % city area",unit:"%",value:3,natural_value:.24},{category:"Land use and waste",indicator:"Green spaces, change in last 3 years",unit:"%",value:3,natural_value:-.06},{category:"Land use and waste",indicator:"NDVI",unit:"%",value:2,natural_value:.575},{category:"Natural disaster hazards",indicator:"Share of total area with altitude above sea level less than 0,5 meters",unit:"%",value:3,natural_value:.085},{category:"Natural disaster hazards",indicator:"Growth rate of freshwater mirror area",unit:"%",value:3,natural_value:-.06},{category:"Natural disaster hazards",indicator:"Number of registered heavy rain, flood and thunderbolt (change in last 3 years)",unit:"%",value:5,natural_value:-.5},{category:"Natural disaster hazards",indicator:"Number of registered sand storm (change in last 3 years)",unit:"%",value:5,natural_value:-.5},{category:"Natural disaster hazards",indicator:"Environmental/natural disasters’ risk mitigation",unit:"Yes/No",value:5,natural_value:1},{category:"Natural disaster hazards",indicator:"Strategy/policy/government officials’ statement on environmental issues ",unit:"Yes/No",value:5,natural_value:1},{category:"Natural disaster hazards",indicator:"Total overall losses from natural disaster hazards",unit:"US$ mln ",value:3,natural_value:0},{category:"Natural disaster hazards",indicator:"Number of days with average daily temperature above the threshold for 1990-2010",unit:"days",value:3,natural_value:15},{category:"Natural disaster hazards",indicator:"Number of disruptions to basic services, attributed to disasters",unit:"%",value:3,natural_value:0},{category:"Water availability",indicator:"Water consumption per capita",unit:"mcm",value:3,natural_value:.11944},{category:"Water availability",indicator:"Water tariff to disposable income ratio",unit:"ratio",value:3,natural_value:1.29},{category:"Water availability",indicator:"Sanitary facilities tariff to disposable income ratio",unit:"ratio",value:3,natural_value:1.1},{category:"Water availability",indicator:"Water consumption per capita (change in last 3 years)",unit:"%",value:5,natural_value:-.004},{category:"Water availability",indicator:"Percentage of population with access to drinking water",unit:"%",value:5,natural_value:.99},{category:"Water availability",indicator:"Percentage of population with access to drinking water (change in last 3 years)",unit:"%",value:3,natural_value:.0016},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities",unit:"%",value:3,natural_value:.915},{category:"Water availability",indicator:"Percentage of population with access to sanitary facilities (change in last 3 years)",unit:"%",value:4,natural_value:9e-5},{category:"Food availability",indicator:"Cereal import dependency ratio (5-years average)",unit:"%",value:3,natural_value:.35},{category:"Food availability",indicator:"Cereal import dependency ratio (change in last 3 years)",unit:"%",value:3,natural_value:.002},{category:"Food availability",indicator:"Prevalence of undernourishment",unit:"%",value:3,natural_value:.058},{category:"Food availability",indicator:"Prevalence of undernourishment (change in last 3 years)",unit:"%",value:3,natural_value:-.001999999999999995},{category:"Food availability",indicator:"Prevalence of undernourishment children",unit:"%",value:4,natural_value:.151},{category:"Food availability",indicator:"Prevalence of undernourishment children (change in last 3 years)",unit:"%",value:1,natural_value:-.10834034891947486},{category:"Food availability",indicator:"Prevalence of moderate or severe food insecurity in the population",unit:"%",value:4,natural_value:.109},{category:"Food availability",indicator:"Share of imports in food resources",unit:"%",value:4,natural_value:.209},{category:"Food availability",indicator:"Percentage of people with access to at least one food vendor/retailer within 15 minutes of walking",unit:"%",value:3,natural_value:91},{category:"Food availability",indicator:"Perception of food availability index",unit:"index",value:3,natural_value:2.2},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity",unit:"%",value:3,natural_value:.986},{category:"Energy availability",indicator:"Percentage of urban population with access to electricity (change in last 3 years)",unit:"%",value:5,natural_value:.04506506935002963},{category:"Energy availability",indicator:"Consumption of electricity per capita",unit:"kWh/person",value:4,natural_value:626},{category:"Energy availability",indicator:"Consumption of electricity per capita (change in last 3 years)",unit:"%",value:3,natural_value:.056395649590240904},{category:"Energy availability",indicator:"Electricity tariff to disposable income ratio",unit:"ratio",value:3,natural_value:.1},{category:"Energy availability",indicator:"Share of renewable sources in electricity consumption",unit:"%",value:5,natural_value:.4932},{category:"Energy availability",indicator:"Perception of energy availability index",unit:"index",value:3,natural_value:1.07},{category:"Health",indicator:"Child mortality rate (under 5 years-old)",unit:"% of live births ",value:3,natural_value:14.9},{category:"Health",indicator:"City ambulance",unit:"Yes/No",value:5,natural_value:1},{category:"Health",indicator:"Life expectancy at birth, years",unit:"Years",value:4,natural_value:76.9},{category:"Health",indicator:"Life expectancy at birth goals",unit:"categories",value:1,natural_value:1},{category:"Health",indicator:"Number of hospital beds per 1,000 population",unit:"per 1,000",value:3,natural_value:4.2},{category:"Health",indicator:"Number of doctors per 1,000 population",unit:"per 1,000",value:4,natural_value:1.2},{category:"Health",indicator:"Maternal mortality ratio",unit:"deaths per 1,000 live births",value:4,natural_value:29},{category:"Health",indicator:"Ambulance arrival speed, min",unit:"min",value:5,natural_value:10},{category:"Education",indicator:"Literacy rate among population (15-24 Years)",unit:"%",value:3,natural_value:.99},{category:"Education",indicator:"Literacy rate among population (15-24 Years) (change in last 3 years)",unit:"%",value:3,natural_value:.00033692724921396966},{category:"Education",indicator:"Primary education engagement",unit:"%",value:3,natural_value:.73},{category:"Education",indicator:"Pupils per teacher rate",unit:"ratio",value:5,natural_value:.217},{category:"Education",indicator:"Proportion of population with post-secondary and higher education",unit:"%",value:3,natural_value:.296},{category:"Wealth",indicator:"Percentage of population with food expenditure is above 52% of total expenditure",unit:"%",value:2,natural_value:.555},{category:"Wealth",indicator:"Mean monthly salary",unit:"US dollars thousand",value:2,natural_value:182.75},{category:"Wealth",indicator:"Mean monthly salary, change in last 3 years",unit:"%",value:3,natural_value:.020413775479336982},{category:"Wealth",indicator:"Disposable monthly income",unit:"US dollars thousand",value:3,natural_value:784},{category:"Wealth",indicator:"Disposable monthly income (change in last 3 years)",unit:"%",value:3,natural_value:.02},{category:"Wealth",indicator:"Debt to salary ratio",unit:"ratio",value:3,natural_value:5},{category:"Wealth",indicator:"Number of mobile phones per 1,000 population",unit:"per 1,000",value:4,natural_value:1410},{category:"Wealth",indicator:"Decile income coefficient",unit:"ratio",value:4,natural_value:9.935483870967742},{category:"Wealth",indicator:"Decile income coefficient (change in last 3 years)",unit:"%",value:3,natural_value:-.02237297581008335},{category:"Wealth",indicator:"Poverty headcount ratio at national poverty lines",unit:"%",value:3,natural_value:.143},{category:"Wealth",indicator:"Working poverty rate (percentage of employed living below US$1.90 PPP), 15+ age (%) ",unit:"%",value:5,natural_value:.004},{category:"Wealth",indicator:"Poverty headcount ratio at $2.15 PPP 2017 a day",unit:"%",value:5,natural_value:.04},{category:"Wealth",indicator:"Living spaces per capita, sq m (change in last 3 years)",unit:"%",value:3,natural_value:.033},{category:"Wealth",indicator:"Population living in slums (% of urban population)",unit:"%",value:1,natural_value:.5},{category:"Wealth",indicator:"Availability of finance (consumer loans)",unit:"%",value:3,natural_value:.43},{category:"Wealth",indicator:"Perception of wealth & poverty index",unit:"index",value:3,natural_value:1.7},{category:"Safety",indicator:"Road fatalities rate per 100,000 population",unit:"per 100,000",value:3,natural_value:11.340252707581227},{category:"Safety",indicator:"Road fatalities rate per 100,000 population (change in last 3 years)",unit:"%",value:3,natural_value:-.04507057046287022},{category:"Safety",indicator:"Violent crime rate per 100,000 population",unit:"per 100,000",value:4,natural_value:3.43},{category:"Safety",indicator:"Violent crime rate per 100,000 population (change in last 3 years)",unit:"%",value:1,natural_value:.14919896707064462},{category:"Safety",indicator:"Crime rate per 100,000 population",unit:"per 100,000",value:5,natural_value:3.43},{category:"Safety",indicator:"Crime rate per 100,000 population  (change in last 3 years)",unit:"%",value:3,natural_value:-.03},{category:"Safety",indicator:"Police arrival speed",unit:"min",value:3,natural_value:21.7},{category:"Safety",indicator:"Perception of safety index",unit:"index",value:3,natural_value:2.79},{category:"Livability",indicator:"Number of LEED certified green buildings",unit:"Certified square meters per capita",value:3,natural_value:.08486437677053825},{category:"Livability",indicator:"Number of BREEAM certified projects",unit:"Certified square meters per capita",value:1,natural_value:0},{category:"Livability",indicator:"Whether or not the city has ISO 37120 certification",unit:"Yes/No",value:"n0",natural_value:"n0"},{category:"Livability",indicator:"Mobile connection coverage",unit:"%",value:2,natural_value:.87},{category:"Livability",indicator:"Internet coverage",unit:"%",value:2,natural_value:.75},{category:"Livability",indicator:"Perception of livability index",unit:"index",value:3,natural_value:1.5},{category:"Livability",indicator:"Share of population in 1 km from schools",unit:"%",value:3,natural_value:54.9},{category:"Livability",indicator:"Share of population in 1 km from parks",unit:"%",value:3,natural_value:64.3},{category:"Transport",indicator:"Time loss in traffic",unit:"%",value:2,natural_value:.2235},{category:"Transport",indicator:"Share of the population in 1 km from public transport stop",unit:"%",value:3,natural_value:44.1},{category:"Transport",indicator:"Ratio of the cost of monthly public transport usage Ithe cheapest option) to average mobthly income",unit:"ratio",value:3,natural_value:.04},{category:"Transport",indicator:"Ratio of the cost of a 1-kilometer taxi ride to average mobthly income",unit:"%",value:3,natural_value:.04},{category:"Transport",indicator:"Percentage of city's roads that are segregated and/or has specialized lane for cyclists",unit:"%",value:3,natural_value:.06},{category:"Transport",indicator:"Number of public electric vehicle (EV) charging points per 100,000 population",unit:"per 100,000",value:3,natural_value:1.4},{category:"Transport",indicator:"Public transport (excluding subway) operates by schedule ",unit:"Yes/No",value:5,natural_value:1},{category:"Transport",indicator:"Perception of transport index",unit:"index",value:3,natural_value:1.5},{category:"Inclusion",indicator:"Female-friendly city",unit:"1,2,3,4,5",value:1,natural_value:4},{category:"Inclusion",indicator:"Number of refugees per 1,000 population",unit:"per 1,000",value:3,natural_value:1.227346570397112},{category:"Inclusion",indicator:"Homeless people per 1,000 population",unit:"per 1,000",value:3,natural_value:7.7},{category:"Inclusion",indicator:"Difference in number of years of schooling between woman and man, woman to man ratio ",unit:"years",value:3,natural_value:1.03},{category:"Inclusion",indicator:"Slavery index",unit:"index",value:1,natural_value:56},{category:"Inclusion",indicator:"Percentage of women aged 25-34 years old that have successfully completed secondary education",unit:"%",value:3,natural_value:.302},{category:"Inclusion",indicator:"Regulations for building construction and equipment, public transport for people with disabilities",unit:"Yes/No",value:5,natural_value:1},{category:"Inclusion",indicator:"Perception of inclusion index",unit:"index",value:3,natural_value:2.3},{category:"Accountability",indicator:"City budget execution publication",unit:"Yes/No",value:1,natural_value:0},{category:"Accountability",indicator:"City budget publication",unit:"Yes/No",value:1,natural_value:0},{category:"Accountability",indicator:"Financial transparency on city government companies",unit:"Yes/No",value:1,natural_value:0},{category:"Accountability",indicator:"ISO certification",unit:"Yes/No",value:1,natural_value:0},{category:"Accountability",indicator:"City council checks and balances",unit:"Yes/No",value:5,natural_value:1},{category:"Accountability",indicator:"Plans to obtain ISO certification",unit:"Yes/No",value:1,natural_value:0},{category:"Accountability",indicator:"Perception of accountability index",unit:"index",value:3,natural_value:.9},{category:"City budget",indicator:"Poor financial condition",unit:"Yes/No",value:1,natural_value:1},{category:"City budget",indicator:"Central/higher level government financial intervention taking place",unit:"Yes/No",value:1,natural_value:1},{category:"City budget",indicator:"Long-term financial planning",unit:"Yes/No",value:1,natural_value:0},{category:"City budget",indicator:"Central/higher level government financial intervention is considered",unit:"Yes/No",value:5,natural_value:1},{category:"City budget",indicator:"Prudent fiscal policy requirements",unit:"Yes/No",value:5,natural_value:1},{category:"City budget",indicator:"Medium-term planning",unit:"Yes/No",value:1,natural_value:0},{category:"SME",indicator:"Number of SMEs per 100,000 population",unit:"per 100,000",value:3,natural_value:4589.350180505415},{category:"SME",indicator:"Number of start-ups",unit:"start-ups",value:2,natural_value:105},{category:"SME",indicator:"Global Startup Ecosystem Index",unit:"index",value:2,natural_value:1.144},{category:"SME",indicator:"Number of SMEs per capita/100 000 population (change in last 3 years)",unit:"%",value:3,natural_value:-7e-4},{category:"SME",indicator:"Number of start-ups (change in last 3 years)",unit:"%",value:3,natural_value:.125},{category:"Public services",indicator:"Free phone to call the police, ambulance, firefighters",unit:"1,2,3,4,5",value:5,natural_value:1},{category:"Public services",indicator:"Services for working with citizens' appeals and complaint",unit:"Yes/No",value:5,natural_value:1},{category:"Public services",indicator:"E-gov services",unit:"Yes/No",value:5,natural_value:1},{category:"Public services",indicator:"Perception of public services index: Public Services",unit:"index",value:3,natural_value:1.77},{category:"Sustainability commitment",indicator:"City ESG reporting",unit:"Yes/No",value:1,natural_value:0},{category:"Sustainability commitment",indicator:"City ESG reporting verification",unit:"Yes/No",value:1,natural_value:0},{category:"Sustainability commitment",indicator:"ESG planning",unit:"Yes/No",value:1,natural_value:0},{category:"Sustainability commitment",indicator:"Plan with specific targets to develop and implement smart city principles",unit:"Yes/No",value:5,natural_value:1},{category:"Sustainability commitment",indicator:"Rollout and status of ESG / UN SDG training across the municipal/asset workforce",unit:"Yes/No",value:1,natural_value:0},{category:"Sustainability commitment",indicator:"City municipality involved in network or partnership promoting sustainable development (for example, C40 Cities network)",unit:"Yes/No",value:5,natural_value:1}]}],oLe=["Very low","Low","Average","Strong","Very strong"],sLe=["#FF3B29","#FF632F","#FF9B3F","#A0DA8B","#35CB00"],lLe=({currentCity:n,cities:e,category:i,indicator:o})=>{const s=tj(Cx.find(_=>_.city===n),i,o),l=Cx.map(_=>tj(_,i,o)),[d,p]=rLe(n,e,l),f=tLe(s,d),y=nLe(oLe,sLe)(s,d);return $e("div",{style:{width:"100%",height:"auto",position:"absolute",bottom:"5vh",left:"0"},children:[X(XJ,{width:"1260px",height:"330px",options:f,data:y}),X(aLe,{currentCity:s.city,selectedCities:d.map(_=>_.city),cities:Cx.map(_=>_.city),onChange:p})]})},nj={Air_pollution:`The Air Pollution category assesses the levels of air pollutants impacting the urban environment and residents. Air pollution directly affects public health, quality of life, and the environment in cities. In the Global South, this issue is particularly acute for many urban areas as industrialization and motorization rates here are still on the rise.\r
\r
We measure the concentration of the most important pollutants based on World Health Organization guidelines[2]. These indicators help us to evaluate the extent of air pollution and its impact on human health and the environment, enabling cities to take informed actions to reduce pollution.`,Water_pollution:`The Water Pollution category evaluates the quality of water sources and the impact of pollution on the urban environment and communities. Adequate clean water supply is essential for public health and the natural environment. Particularly, in the Global South, where access to safe water is often limited, while pollution sources are diverse.\r
\r
We measure the levels of contamination from pollutants, industrial waste, and inadequate sanitation based on the WHO standards while also evaluating the effectiveness of local efforts to mitigate water pollution and safeguard the health and well-being of their communities. These indicators help us to determine the extent of water pollution and the effectiveness of purification methods, gauging efforts to ensure clean and safe water.`,Land_use_and_waste:`The Land Use and Waste category assesses how cities manage land resources and handle waste. The issue of land and waste directly impacts urban development and environmental sustainability. Rapid urbanization and resource constraints in the Global South pose distinct challenges to land use and waste management. The category also evaluates a city's efforts to expand green spaces and promote environmental sustainability. Urban greening directly affects livability, health, and resilience to climate change. Vegetation cover mitigates the effect of urban heat island cooling the environment. In the Global South, where rapid urbanization and environmental challenges it causes lead to significant inequalities, greening initiatives are crucial for improving quality of life.\r
\r
We measure land use practices, waste management methods, recycling rates, as well as waste disposal practices based on extensive scientific research. These indicators are designed to evaluate sustainable land management, waste reduction, and environmental protection that guide cities toward eco-friendliness.`,Natural_disaster_hazards:`The Natural Disaster Hazards category aims to assess a city's vulnerability to natural disasters and its capacity to mitigate their impact. For cities around the world, the problem of natural disasters is particularly acute due to higher population densities that multiply the damage caused by natural hazards. In the environmental and social settings of the Global South, this often becomes a key challenge for community safety.\r
\r
We measure resilience by evaluating natural conditions that can exacerbate the situation, as well as past records of extreme events including their type and volume of damage caused based on recent scientific studies. These indicators evaluate the impact of natural disasters on communities and overall sustainability.`,Water_availability:`The Water Availability category evaluates access to water resources. Water scarcity issues and population growth in many urban areas of the Global South make this issue essential for ensuring equitable access to drinking and technical water.\r
\r
It assesses the adequacy of water supply, and its affordability considering the cities' capacity to ensure equitable and sustainable access to water and sanitation services for their residents. These indicators reflect how cities address water security, resilience, and equitable access to such a vital resource.`,Food_availability:`The Food Availability category evaluates access to and availability of food resources. This category is often crucial in the Global South due to food security concerns, vulnerable populations, and sustainability challenges. This category is essential to consider as it measures equitable access to nutritious food addressing hunger and malnutrition.\r
\r
We capture and measure data on food supply chains and access to food. This assessment is designed to measure the cities' capacity to ensure a consistent and accessible food supply, as well as their ability to address hunger and nutritional requirements for their residents.`,Energy_availability:`The Energy Availability category specifically targets challenges related to ensuring reliable energy access, affordability, and sustainability of generation sources. It is essential in the Global South due to energy access disparities, sustainability challenges, and rapid economic development.\r
\r
We capture and measure data on energy infrastructure, electricity access, energy efficiency, and renewable energy adoption. This evaluation is intended to measure the cities' capacity to provide affordable and renewable energy for their residents, while also promoting environmental sustainability.`,Health:`The Health category assesses a city's healthcare infrastructure and residents’ access to healthcare. It centers on the distinct healthcare challenges faced by urban areas in the Global South, including intrinsic burdens of diseases that impact public health, healthcare infrastructure, and overall well-being. \r
\r
We capture and measure data on healthcare access, disease prevention, healthcare quality, and public health outcomes based on the extensive SDG-related WHO guidelines. This evaluation is crafted to assess the cities’ ability to deliver quality healthcare, reduce mortality rates, and enhance the well-being of residents, while also addressing their unique healthcare needs and challenges.`,Education:`The Education category assesses a city’s commitment to high-quality education, access to schools, and educational outcomes. It addresses the unique educational challenges faced by the cities in the Global South due to their generally higher share of the younger population, including issues related to access, quality, and educational attainment.\r
\r
We capture and measure data on educational infrastructure, enrollment rates, as well as literacy and numeracy skills in line with the UN recommendations. This assessment aims to evaluate the cities’ capacity to provide accessible, high-quality education, promote educational attainment, and offer lifelong learning opportunities for their residents while addressing their specific educational needs and challenges.`,Wealth:`The Wealth category assesses a city’s economic well-being and income distribution. This issue is crucial for the growing economies in the Global South facing vast disparities and poverty challenges.\r
\r
We capture and measure data on income distribution, poverty rates, and economic opportunities based on international practices. This assessment aims to evaluate the cities' capacity to address economic disparities, reduce poverty, and enhance economic well-being for their residents while considering their unique economic challenges.`,Safety:`The Safety category addresses issues related to road safety, crime, and overall safety. These challenges are inherent to cities of the Global South experiencing population growth, poverty, and increasing motorization rates. \r
\r
We capture and measure data on crime and traffic accident rates and law enforcement effectiveness based on substantive scientific research. This assessment aims to evaluate the cities’ ability to enhance safety, reduce crime, and promote overall security for their residents while addressing their safety challenges and concerns.`,Livability:`The Livability category assesses a city's quality of life, infrastructure, and overall living conditions. These challenges are quite acute for the rapidly changing urban environment in the Global South where authorities seek to improve living conditions and have to focus on infrastructure development.\r
\r
We capture and measure data on housing and infrastructure quality standards, communications, and basic healthcare service availability as well as public perception of this complex category. This evaluation is designed to assess the cities' efforts in promoting environmentally sustainable and livable urban environments, addressing infrastructure and accessibility challenges, and enhancing the overall quality of life for their residents.`,Transport:`The Transport category assesses a city's transportation and mobility infrastructure and accessibility. We address here the specific transportation challenges and infrastructure issues that rapidly urbanizing areas in the Global South face, including issues related to traffic congestion, accessibility, and public transportation.\r
\r
We capture and measure data on the outcomes of transport policies regarding public transit infrastructure, its accessibility, affordability and performance, traffic congestion, and green initiatives based on broad scientific evidence. This assessment aims to evaluate the cities’ transportation system performance that defines the mobility of their residents.`,Inclusion:`The Inclusion category assesses a city’s commitment to inclusivity and equity, ensuring that all residents have equal access to opportunities and services. This category is crucial in the Global South as it addresses social disparities, discrimination, and social justice issues.\r
\r
We capture and measure data on social equity, access to education and healthcare, economic opportunities, and the presence of anti-discrimination policies based on extensive research. This assessment aims to evaluate the cities’ performance regarding social inclusion, gender equity, and support for groups at risk.`,Accountability:`The Accountability category assesses a city’s commitment to transparency, governance, and accountability. This category is crucial in the Global South where the potential for change is maximized through the promotion of good governance and responsible public resources use.\r
\r
This assessment aims to evaluate cities’ commitment to transparent governance, accountability in resource allocation, and overall effective administration. This category shows how cities ensure responsible resource management, citizens’ trust, and effective governance.`,City_budget:`The City Budget category evaluates a city’s financial management, allocation of funds, and budget transparency. The topic is of higher importance for the Global South as it encompasses the stability of government financial planning.\r
\r
We capture and measure data on budget allocations to essential services, financial transparency, fiscal responsibility, and adherence to financial sustainability principles. This assessment aims to evaluate the cities' capacity to manage their budgets effectively, ensure fiscal stability, and plan for long-term financial sustainability.`,SME:`The SME category evaluates a city's support for and the impact of SMEs on the local economy. SMEs in the Global South are a significant source of employment and economic growth. It is crucial for fostering local businesses and reducing unemployment. \r
\r
We capture and measure data on employment generation, business sustainability, and innovation related to SMEs and entrepreneurship. This assessment aims to evaluate the cities’ efforts in promoting a vibrant entrepreneurial ecosystem, supporting small and medium-sized enterprises.`,Public_services:`The Public Services category assesses the quality and accessibility of essential government and municipal services. This category is crucial in the Global South due to disparities in access to services. It is essential for improving living standards, health, and social equity.\r
\r
We capture and measure data on the availability and performance of key government services. This evaluation aims to represent the city’s commitment to public service digitalization, efficient emergency response, and citizen engagement in the context of government services`,Sustainability_commitment:`The Sustainability Commitment category assesses a city's dedication and efforts to promote sustainability and environmental responsibility. This category is critical in the Global South because of the more pronounced need to prioritize sustainable development, resilience, and environmental stewardship.\r
\r
We capture and measure a city's sustainability policies, initiatives, and their effectiveness. This assessment aims to evaluate the cities' dedication to sustainable development, ESG principles, and the UN Sustainable Development Goals to build community resilience.`},cLe=({city:n,category:e,setClickedCategory:i})=>{const{classes:o}=TIe(),s=Cx.find(_=>_.city===n).data.filter(_=>_.category===e),[l,d]=ie.useState(0),p=_=>{_&&l+1===s.length?d(0):_?d(l+1):!_&&l-1<0?d(s.length-1):d(l-1)};ie.useEffect(()=>{},[l]);const f=e.replace(" ","_"),y=Object.keys(nj).includes(f)?nj[f]:"No description available";return $e("div",{className:o.backgroundWrapper,children:[$e("div",{onClick:()=>{i(null);const _=document.getElementById("landing");_.scrollTo({top:_.clientHeight*2})},className:o.returnBack,children:[X("img",{className:o.returnBackIcon,src:"/assets/returnBackIcon.svg",alt:"return back"}),X(Ii,{className:o.returnBackText,children:"Back to Urban resilience index"})]}),$e("div",{className:o.content,children:[$e("div",{className:o.blueSection,children:[X(PIe,{title:e,text:y}),$e(Ii,{style:{position:"absolute",top:"25vh",left:"8vh",color:"#fff",fontFamily:"SuisseIntl-Regular",fontSize:"4vh"},children:["Chose cities ",X("br",{}),"and compare to peers"]}),X(ZIe,{category:e,currentCity:n,cities:fM})]}),$e("div",{className:o.whiteSection,children:[$e("div",{style:{position:"absolute",top:"4vh",left:"8vh"},children:[$e("div",{className:o.title,style:{color:"#000000",fontFamily:"SuisseIntl-Light"},children:["Indicators of"," "]}),X("div",{className:o.title,style:{color:"#2D67FF"},children:e})]}),$e(Ii,{style:{position:"absolute",top:"27.5vh",left:"8vh",width:"30vw",color:"#000000",fontFamily:"SuisseIntl-Light",fontSize:"2vh"},children:["The graph highlights the strengths and weaknesses of cities across various aspects of ",e," category. The further the vertices of the shape are from the center of the diagram, the better the city's performance in that particular indicator. The larger the area of the shape, the higher the overall assessment in the ",e," category."]}),X(QIe,{category:e,city:n})]}),$e("div",{className:o.blueSection,children:[$e("div",{style:{position:"absolute",top:"4vh",left:"8vh",display:"flex",flexDirection:"row",alignItems:"left",justifyContent:"left",gap:"1vw",height:"5vh"},children:[X("img",{src:"/assets/circle_arrow_transparent.svg",alt:"arrow",style:{width:"100%",height:"100%",cursor:"pointer"},onClick:()=>p(!1)}),X("img",{src:"/assets/circle_arrow_transparent.svg",alt:"arrow",style:{width:"100%",height:"100%",cursor:"pointer",transform:"rotate(180deg)"},onClick:()=>p(!0)})]}),X(Ii,{style:{position:"absolute",top:"5vh",left:"12vw",fontFamily:"SuisseIntl-Regular",fontSize:"2vh",color:"#fff",alignSelf:"center"},children:"Browse indicators for the Wealth category"}),X("div",{style:{position:"absolute",top:"10vh",left:"8vh"},children:$e("div",{className:o.title,style:{fontSize:"6vh"},children:[s[l].indicator,X("br",{}),X("span",{style:{fontSize:"3vh",fontFamily:"SuisseIntl-Light",letterSpacing:"0"},children:s[l].unit})]})}),X(lLe,{cities:fM,currentCity:n,category:e,indicator:s[l].indicator})]})]})]})},uLe=pr()({backgroundWrapper:{position:"absolute",top:0,left:0,backgroundColor:"#0C1F68",width:"100vw",height:"100vh",overflowY:"scroll","&::-webkit-scrollbar":{width:"0em"},zIndex:"1200"},content:{position:"relative",width:"90%",margin:"12vh 5% 5vh",borderRadius:"3vh",overflow:"hidden",display:"flex"},whiteSection:{position:"relative",display:"flex",flexDirection:"column",width:"100%",height:"fit-content",float:"left",background:"#ffffff"},returnBack:{position:"absolute",top:"4vh",left:"5%",display:"flex",flexDirection:"row",alignItems:"center",gap:"1vh",cursor:"pointer"},returnBackIcon:{height:"4vh"},returnBackText:{fontFamily:"SuisseIntl-Light",fontWeight:400,color:"#fff",textTransform:"none",fontSize:"1.8vh","&:hover":{backgroundColor:"inherit"}},titleWrapper:{marginTop:"4vh",marginLeft:"8vh"},title:{fontWeight:400,lineHeight:"9vh",letterSpacing:"-0.2vh",fontSize:"8vh",width:"100%",color:"#000000",fontFamily:"SuisseIntl-Light"},filterBtn:{fontFamily:"SuisseIntl-Light",fontWeight:600,fontSize:"2vh",textTransform:"none"}});pr()({wrapper:{display:"flex",flexDirection:"row",justifyContent:"space-between",width:"100%",padding:"4vh 8vh",boxSizing:"border-box"},titleWrapper:{width:"50%"},title:{fontFamily:"SuisseIntl-Regular",fontWeight:400,lineHeight:"9vh",letterSpacing:"-0.2vh",fontSize:"8vh",color:"#fff",width:"100%"},subTitle:{fontFamily:"SuisseIntl-Light",fontWeight:200,lineHeight:"9vh",letterSpacing:"-0.2vh",fontSize:"6vh",color:"#fff",width:"100%"},text:{fontFamily:"SuisseIntl-Light",fontWeight:400,lineHeight:"3vh",letterSpacing:"0vh",fontSize:"2vh",color:"#fff",width:"55%",paddingTop:"3vh"}});const dLe=[{id:1,group:"E",category:"Air pollution",indicator:"CO2 emissions",scope:1,dimension:"Current state",type:"Key",unit:"kt"},{id:2,group:"E",category:"Air pollution",indicator:"CO2 emissions (change in last 3 years)",scope:1,dimension:"Ability & willingness",type:"Key",unit:"CAGR, %"},{id:3,group:"E",category:"Air pollution",indicator:"CO2 concentration",scope:1,dimension:"Current state",type:"Key",unit:"ppm"},{id:4,group:"E",category:"Air pollution",indicator:"CO2 concentration (change in last 3 years)",scope:1,dimension:"Ability & willingness",type:"Key",unit:"CAGR, %"},{id:5,group:"E",category:"Air pollution",indicator:"Annual average of SO2 concentration in ambient air",scope:0,dimension:"Current state",type:"Key",unit:"microgram/m3"},{id:6,group:"E",category:"Air pollution",indicator:"Annual Average of SO2 Concentration in Ambient Air (change in last 3 years)",scope:0,dimension:"Ability & willingness",type:"Key",unit:"CAGR, %"},{id:7,group:"E",category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air",scope:0,dimension:"Current state",type:"Key",unit:"microgram/m3"},{id:8,group:"E",category:"Air pollution",indicator:"Annual Average of NO2 Concentration in Ambient Air (change in last 3 years)",scope:0,dimension:"Ability & willingness",type:"Key",unit:"CAGR, %"},{id:9,group:"E",category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air",scope:0,dimension:"Current state",type:"Key",unit:"microgram/m3"},{id:10,group:"E",category:"Air pollution",indicator:"Annual Average of O3 Concentration in Ambient Air (change in last 3 years)",scope:0,dimension:"Ability & willingness",type:"Key",unit:"CAGR, %"},{id:11,group:"E",category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air",scope:0,dimension:"Current state",type:"Key",unit:"microgram/m3"},{id:12,group:"E",category:"Air pollution",indicator:"Annual Average of CO Concentration in Ambient Air (change in last 3 years)",scope:0,dimension:"Ability & willingness",type:"Key",unit:"CAGR, %"},{id:13,group:"E",category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air",scope:0,dimension:"Current state",type:"Key",unit:"microgram/m3"},{id:14,group:"E",category:"Air pollution",indicator:"Annual Average of Particulate Matter (PM10) Concentration in Ambient Air (change in last 3 years)",scope:0,dimension:"Ability & willingness",type:"Key",unit:"CAGR, %"},{id:15,group:"E",category:"Air pollution",indicator:"Volatile organic compounds/reactive organic gases emissions",scope:1,dimension:"Current state",type:"Supportive",unit:"microgram/m3"},{id:16,group:"E",category:"Air pollution",indicator:"Perception of air pollution index",scope:0,dimension:"Current state",type:"Key",unit:"index"},{id:17,group:"E",category:"Air pollution",indicator:"Paris Agreement",scope:3,dimension:"Ability & willingness",type:"Supportive",unit:"Yes/No"},{id:18,group:"E",category:"Water pollution",indicator:"Annual average of dissolved oxygen (DO) concentration in water",scope:1,dimension:"Current state",type:"Supportive",unit:"%"},{id:19,group:"E",category:"Water pollution",indicator:"Annual average of pH concentration in water",scope:1,dimension:"Current state",type:"Supportive",unit:"pH"},{id:20,group:"E",category:"Water pollution",indicator:"Annual average dissolved solids in drinking water",scope:1,dimension:"Current state",type:"Supportive",unit:"ppm"},{id:21,group:"E",category:"Water pollution",indicator:"Water management strategy in a city",scope:1,dimension:"Ability & willingness",type:"Supportive",unit:"Yes/No"},{id:22,group:"E",category:"Water pollution",indicator:"Perception of water pollution index",scope:0,dimension:"Current state",type:"Key",unit:"index"},{id:23,group:"E",category:"Land use and waste",indicator:"Share of devastated and degraded land area requiring reclamation",scope:1,dimension:"Current state",type:"Key",unit:"%"},{id:24,group:"E",category:"Land use and waste",indicator:"3-year average growth rate of devastated and degraded land area requiring reclamation",scope:1,dimension:"Ability & willingness",type:"Key",unit:"CAGR, %"},{id:25,group:"E",category:"Land use and waste",indicator:"Waste deposits",scope:0,dimension:"Current state",type:"Supportive",unit:"%"},{id:26,group:"E",category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous)",scope:0,dimension:"Current state",type:"Supportive",unit:"kg per capita "},{id:27,group:"E",category:"Land use and waste",indicator:"Collected and managed in dumps wastes (hazardous and non-hazardous), (change in last 3 years)",scope:0,dimension:"Ability & willingness",type:"Supportive",unit:"CAGR, %"},{id:28,group:"E",category:"Land use and waste",indicator:"Total recycled construction waste",scope:1,dimension:"Current state",type:"Supportive",unit:"tons per capita"},{id:29,group:"E",category:"Land use and waste",indicator:"Share of recycled construction and demolish waste in total generated construction and demolish waste",scope:1,dimension:"Current state",type:"Supportive",unit:"%"},{id:30,group:"E",category:"Land use and waste",indicator:"Total area of impervious surfaces and percentage to total city area",scope:1,dimension:"Current state",type:"Supportive",unit:"%"},{id:31,group:"E",category:"Land use and waste",indicator:"Productive urban land, % of total area",scope:1,dimension:"Current state",type:"Supportive",unit:"%"},{id:32,group:"E",category:"Land use and waste",indicator:"Waste management strategy",scope:1,dimension:"Ability & willingness",type:"Supportive",unit:"Yes/No"},{id:33,group:"E",category:"Land use and waste",indicator:"Perception of waste index",scope:0,dimension:"Current state",type:"Key",unit:"index"},{id:34,group:"E",category:"Land use and waste",indicator:"Green spaces, % city area",scope:1,dimension:"Current state",type:"Key",unit:"%"},{id:35,group:"E",category:"Land use and waste",indicator:"Green spaces, change in last 3 years",scope:1,dimension:"Ability & willingness",type:"Key",unit:"CAGR, %"},{id:36,group:"E",category:"Land use and waste",indicator:"NDVI (Normalized Difference Vegetation Index)",scope:1,dimension:"Current state",type:"Supportive",unit:"index"},{id:37,group:"E",category:"Natural disaster hazards",indicator:"Share of total area with altitude above sea level less than 0,5 meters",scope:1,dimension:"Current state",type:"Supportive",unit:"%"},{id:38,group:"E",category:"Natural disaster hazards",indicator:"Growth rate of freshwater mirror area",scope:1,dimension:"Ability & willingness",type:"Key",unit:"%"},{id:39,group:"E",category:"Natural disaster hazards",indicator:"Number of registered heavy rain, flood and thunderbolt (change in last 3 years)",scope:1,dimension:"Current state",type:"Supportive",unit:"CAGR, %"},{id:40,group:"E",category:"Natural disaster hazards",indicator:"Number of registered sandstorm (change in last 3 years)",scope:1,dimension:"Current state",type:"Supportive",unit:"CAGR, %"},{id:41,group:"E",category:"Natural disaster hazards",indicator:"Environmental/natural disasters’ risk mitigation",scope:1,dimension:"Ability & willingness",type:"Supportive",unit:"Yes/No"},{id:42,group:"E",category:"Natural disaster hazards",indicator:"Strategy/policy/government officials’ statement on environmental issues ",scope:1,dimension:"Ability & willingness",type:"Supportive",unit:"Yes/No"},{id:43,group:"E",category:"Natural disaster hazards",indicator:"Total overall losses from natural disaster hazards",scope:1,dimension:"Current state",type:"Supportive",unit:"US$ mln "},{id:44,group:"E",category:"Natural disaster hazards",indicator:"Number of days with average daily temperature above the threshold for 1990-2010",scope:1,dimension:"Current state",type:"Supportive",unit:"days"},{id:45,group:"E",category:"Natural disaster hazards",indicator:"Number of disruptions to basic services, attributed to disasters",scope:0,dimension:"Current state",type:"Supportive",unit:"%"},{id:46,group:"S",category:"Water availability",indicator:"Water consumption per capita",scope:0,dimension:"Current state",type:"Supportive",unit:"mcm per capita"},{id:47,group:"S",category:"Water availability",indicator:"Water tariff to disposable income ratio",scope:0,dimension:"Current state",type:"Supportive",unit:"ratio"},{id:48,group:"S",category:"Water availability",indicator:"Sanitary facilities tariff to disposable income ratio",scope:0,dimension:"Current state",type:"Supportive",unit:"ratio"},{id:49,group:"S",category:"Water availability",indicator:"Water consumption per capita (change in last 3 years)",scope:1,dimension:"Ability & willingness",type:"Supportive",unit:"CAGR, %"},{id:50,group:"S",category:"Water availability",indicator:"Percentage of population with access to drinking water",scope:0,dimension:"Current state",type:"Key",unit:"%"},{id:51,group:"S",category:"Water availability",indicator:"Percentage of population with access to drinking water (change in last 3 years)",scope:0,dimension:"Ability & willingness",type:"Supportive",unit:"CAGR, %"},{id:52,group:"S",category:"Water availability",indicator:"Percentage of population with access to sanitary facilities",scope:0,dimension:"Current state",type:"Key",unit:"%"},{id:53,group:"S",category:"Water availability",indicator:"Percentage of population with access to sanitary facilities (change in last 3 years)",scope:0,dimension:"Ability & willingness",type:"Supportive",unit:"CAGR, %"},{id:54,group:"S",category:"Food availability",indicator:"Cereal import dependency ratio (5-years average)",scope:1,dimension:"Current state",type:"Supportive",unit:"ratio"},{id:55,group:"S",category:"Food availability",indicator:"Cereal import dependency ratio (change in last 3 years)",scope:1,dimension:"Ability & willingness",type:"Supportive",unit:"CAGR, %"},{id:56,group:"S",category:"Food availability",indicator:"Prevalence of undernourishment",scope:0,dimension:"Current state",type:"Key",unit:"%"},{id:57,group:"S",category:"Food availability",indicator:"Prevalence of undernourishment (change in last 3 years)",scope:0,dimension:"Ability & willingness",type:"Supportive",unit:"CAGR, %"},{id:58,group:"S",category:"Food availability",indicator:"Prevalence of undernourishment children",scope:0,dimension:"Current state",type:"Supportive",unit:"%"},{id:59,group:"S",category:"Food availability",indicator:"Prevalence of undernourishment children (change in last 3 years)",scope:0,dimension:"Ability & willingness",type:"Supportive",unit:"CAGR, %"},{id:60,group:"S",category:"Food availability",indicator:"Prevalence of moderate or severe food insecurity in the population",scope:0,dimension:"Current state",type:"Supportive",unit:"%"},{id:61,group:"S",category:"Food availability",indicator:"Share of imports in food resources",scope:1,dimension:"Current state",type:"Supportive",unit:"%"},{id:62,group:"S",category:"Food availability",indicator:"Percentage of people with access to at least one food vendor/retailer within 15 minutes of walking",scope:1,dimension:"Current state",type:"Supportive",unit:"%"},{id:63,group:"S",category:"Food availability",indicator:"Perception of food availability index",scope:0,dimension:"Current state",type:"Key",unit:"index"},{id:64,group:"S",category:"Energy availability",indicator:"Percentage of urban population with access to electricity",scope:0,dimension:"Ability & willingness",type:"Key",unit:"%"},{id:65,group:"S",category:"Energy availability",indicator:"Percentage of urban population with access to electricity (change in last 3 years)",scope:0,dimension:"Ability & willingness",type:"Supportive",unit:"CAGR, %"},{id:66,group:"S",category:"Energy availability",indicator:"Consumption of electricity per capita",scope:0,dimension:"Current state",type:"Supportive",unit:"kWh/person"},{id:67,group:"S",category:"Energy availability",indicator:"Consumption of electricity per capita (change in last 3 years)",scope:0,dimension:"Ability & willingness",type:"Supportive",unit:"CAGR, %"},{id:68,group:"S",category:"Energy availability",indicator:"Electricity tariff to disposable income ratio",scope:0,dimension:"Ability & willingness",type:"Supportive",unit:"ratio"},{id:69,group:"S",category:"Energy availability",indicator:"Share of renewable sources in electricity consumption",scope:2,dimension:"Current state",type:"Supportive",unit:"%"},{id:70,group:"S",category:"Energy availability",indicator:"Perception of energy availability index",scope:0,dimension:"Current state",type:"Supportive",unit:"index"},{id:71,group:"S",category:"Health",indicator:"Child mortality rate (under 5 years-old)",scope:1,dimension:"Current state",type:"Key",unit:"% of live births "},{id:72,group:"S",category:"Health",indicator:"City ambulance",scope:0,dimension:"Current state",type:"Key",unit:"Yes/No"},{id:73,group:"S",category:"Health",indicator:"Life expectancy at birth, years",scope:1,dimension:"Ability & willingness",type:"Supportive",unit:"years"},{id:74,group:"S",category:"Health",indicator:"Life expectancy at birth goals",scope:1,dimension:"Ability & willingness",type:"Key",unit:"index"},{id:75,group:"S",category:"Health",indicator:"Number of hospital beds per 1,000 population",scope:1,dimension:"Current state",type:"Supportive",unit:"per 1,000"},{id:76,group:"S",category:"Health",indicator:"Number of doctors per 1,000 population",scope:1,dimension:"Current state",type:"Supportive",unit:"per 1,000"},{id:77,group:"S",category:"Health",indicator:"Maternal mortality ratio",scope:0,dimension:"Current state",type:"Supportive",unit:"deaths per 1,000 live births"},{id:78,group:"S",category:"Health",indicator:"Ambulance arrival speed",scope:0,dimension:"Current state",type:"Supportive",unit:"min"},{id:79,group:"S",category:"Education",indicator:"Literacy rate among population (15-24 Years)",scope:0,dimension:"Current state",type:"Key",unit:"%"},{id:80,group:"S",category:"Education",indicator:"Literacy rate among population (15-24 Years) (change in last 3 years)",scope:0,dimension:"Ability & willingness",type:"Key",unit:"CAGR, %"},{id:81,group:"S",category:"Education",indicator:"Primary education engagement",scope:1,dimension:"Current state",type:"Supportive",unit:"%"},{id:82,group:"S",category:"Education",indicator:"Pupils per teacher rate",scope:1,dimension:"Current state",type:"Supportive",unit:"ratio"},{id:83,group:"S",category:"Education",indicator:"Proportion of population with post-secondary and higher education",scope:1,dimension:"Current state",type:"Supportive",unit:"%"},{id:84,group:"S",category:"Wealth",indicator:"Percentage of population with food expenditure is above 52% of total expenditure",scope:0,dimension:"Current state",type:"Key",unit:"%"},{id:85,group:"S",category:"Wealth",indicator:"Mean monthly salary",scope:1,dimension:"Current state",type:"Key",unit:"US dollars thousand PPP"},{id:86,group:"S",category:"Wealth",indicator:"Mean monthly salary, change in last 3 years",scope:1,dimension:"Ability & willingness",type:"Key",unit:"CAGR, %"},{id:87,group:"S",category:"Wealth",indicator:"Disposable monthly income",scope:0,dimension:"Current state",type:"Supportive",unit:"US dollars thousand PPP"},{id:88,group:"S",category:"Wealth",indicator:"Disposable monthly income (change in last 3 years)",scope:1,dimension:"Ability & willingness",type:"Supportive",unit:"CAGR, %"},{id:89,group:"S",category:"Wealth",indicator:"Debt to salary ratio",scope:1,dimension:"Current state",type:"Supportive",unit:"ratio"},{id:90,group:"S",category:"Wealth",indicator:"Number of mobile phones per 1,000 population",scope:1,dimension:"Current state",type:"Supportive",unit:"per 1,000"},{id:91,group:"S",category:"Wealth",indicator:"Decile income coefficient",scope:1,dimension:"Current state",type:"Supportive",unit:"ratio"},{id:92,group:"S",category:"Wealth",indicator:"Decile income coefficient (change in last 3 years)",scope:1,dimension:"Ability & willingness",type:"Supportive",unit:"CAGR, %"},{id:93,group:"S",category:"Wealth",indicator:"Poverty headcount ratio at national poverty lines",scope:1,dimension:"Current state",type:"Supportive",unit:"ratio"},{id:94,group:"S",category:"Wealth",indicator:"Working poverty rate (percentage of employed living below US$1.90 PPP), 15+ age (%) ",scope:1,dimension:"Current state",type:"Supportive",unit:"%"},{id:95,group:"S",category:"Wealth",indicator:"Poverty headcount ratio at $2.15 PPP 2017 a day",scope:0,dimension:"Current state",type:"Supportive",unit:"ratio"},{id:96,group:"S",category:"Wealth",indicator:"Living spaces per capita, sq m (change in last 3 years)",scope:0,dimension:"Ability & willingness",type:"Supportive",unit:"CAGR, %"},{id:97,group:"S",category:"Wealth",indicator:"Population living in slums (% of urban population)",scope:0,dimension:"Ability & willingness",type:"Supportive",unit:"%"},{id:98,group:"S",category:"Wealth",indicator:"Availability of finance (consumer loans)",scope:1,dimension:"Current state",type:"Supportive",unit:"%"},{id:99,group:"S",category:"Wealth",indicator:"Perception of wealth & poverty index",scope:0,dimension:"Current state",type:"Key",unit:"index"},{id:100,group:"S",category:"Safety",indicator:"Road fatalities rate per 100,000 population",scope:1,dimension:"Current state",type:"Supportive",unit:"per 100,000"},{id:101,group:"S",category:"Safety",indicator:"Road fatalities rate per 100,000 population (change in last 3 years)",scope:1,dimension:"Ability & willingness",type:"Supportive",unit:"CAGR, %"},{id:102,group:"S",category:"Safety",indicator:"Violent crime rate per 100,000 population",scope:0,dimension:"Current state",type:"Key",unit:"per 100,000"},{id:103,group:"S",category:"Safety",indicator:"Violent crime rate per 100,000 population (change in last 3 years)",scope:0,dimension:"Ability & willingness",type:"Supportive",unit:"CAGR, %"},{id:104,group:"S",category:"Safety",indicator:"Crime rate per 100,000 population",scope:0,dimension:"Current state",type:"Supportive",unit:"per 100,000"},{id:105,group:"S",category:"Safety",indicator:"Crime rate per 100,000 population  (change in last 3 years)",scope:0,dimension:"Ability & willingness",type:"Supportive",unit:"CAGR, %"},{id:106,group:"S",category:"Safety",indicator:"Police arrival speed",scope:0,dimension:"Current state",type:"Supportive",unit:"min"},{id:107,group:"S",category:"Safety",indicator:"Perception of safety index",scope:0,dimension:"Current state",type:"Supportive",unit:"index"},{id:108,group:"S",category:"Livability",indicator:"Number of LEED certified green buildings",scope:1,dimension:"Current state",type:"Supportive",unit:"certified square meters per capita"},{id:109,group:"S",category:"Livability",indicator:"Number of CEEQUAL certified projects",scope:2,dimension:"Current state",type:"Supportive",unit:"certified square meters per capita"},{id:110,group:"S",category:"Livability",indicator:"Whether or not the city has ISO 37120 certification",scope:2,dimension:"Ability & willingness",type:"Supportive",unit:"Yes/No"},{id:111,group:"S",category:"Livability",indicator:"Mobile connection coverage",scope:0,dimension:"Current state",type:"Supportive",unit:"%"},{id:112,group:"S",category:"Livability",indicator:"Internet coverage",scope:1,dimension:"Current state",type:"Supportive",unit:"%"},{id:113,group:"S",category:"Livability",indicator:"Perception of livability index",scope:0,dimension:"Current state",type:"Key",unit:"index"},{id:114,group:"S",category:"Livability",indicator:"Share of population in 1 km from hospitals",scope:0,dimension:"Current state",type:"Key",unit:"%"},{id:115,group:"S",category:"Livability",indicator:"Share of population in 1 km from parks",scope:0,dimension:"Current state",type:"Key",unit:"%"},{id:116,group:"S",category:"Transport",indicator:"Time loss in traffic",scope:1,dimension:"Current state",type:"Key",unit:"%"},{id:117,group:"S",category:"Transport",indicator:"Share of the population in 1 km from public transport stop",scope:1,dimension:"Current state",type:"Supportive",unit:"%"},{id:118,group:"S",category:"Transport",indicator:"Ratio of the cost of monthly public transport usage (the cheapest option) to average monthly income",scope:1,dimension:"Current state",type:"Supportive",unit:"ratio"},{id:119,group:"S",category:"Transport",indicator:"Ratio of the cost of a 1-kilometer taxi ride to average monthly income",scope:1,dimension:"Current state",type:"Supportive",unit:"ratio"},{id:120,group:"S",category:"Transport",indicator:"Percentage of city roads that are segregated and/or has specialized lane for cyclists",scope:1,dimension:"Current state",type:"Supportive",unit:"%"},{id:121,group:"S",category:"Transport",indicator:"Number of public electric vehicle (EV) charging points per 100,000 population",scope:3,dimension:"Current state",type:"Supportive",unit:"per 100,000"},{id:122,group:"S",category:"Transport",indicator:"Public transport (excluding subway) operates by schedule ",scope:1,dimension:"Current state",type:"Supportive",unit:"Yes/No"},{id:123,group:"S",category:"Transport",indicator:"Perception of transport index",scope:0,dimension:"Current state",type:"Key",unit:"index"},{id:124,group:"S",category:"Inclusion",indicator:"Female-friendly city",scope:1,dimension:"Current state",type:"Supportive",unit:"index"},{id:125,group:"S",category:"Inclusion",indicator:"Number of refugees per 1,000 population",scope:0,dimension:"Current state",type:"Supportive",unit:"per 1,000"},{id:126,group:"S",category:"Inclusion",indicator:"Homeless people per 1,000 population",scope:0,dimension:"Current state",type:"Key",unit:"per 1,000"},{id:127,group:"S",category:"Inclusion",indicator:"Difference in number of years of schooling between woman and man, woman to man ratio ",scope:1,dimension:"Current state",type:"Supportive",unit:"ratio"},{id:128,group:"S",category:"Inclusion",indicator:"Slavery index",scope:0,dimension:"Current state",type:"Supportive",unit:"index"},{id:129,group:"S",category:"Inclusion",indicator:"Percentage of women aged 25-34 years old that have successfully completed secondary education",scope:1,dimension:"Current state",type:"Supportive",unit:"%"},{id:130,group:"S",category:"Inclusion",indicator:"Regulations for building construction and equipment, public transport for people with disabilities",scope:2,dimension:"Current state",type:"Supportive",unit:"Yes/No"},{id:131,group:"S",category:"Inclusion",indicator:"Perception of inclusion index",scope:0,dimension:"Current state",type:"Key",unit:"index"},{id:132,group:"G",category:"Accountability",indicator:"City budget execution publication",scope:1,dimension:"Current state",type:"Key",unit:"Yes/No"},{id:133,group:"G",category:"Accountability",indicator:"City budget publication",scope:1,dimension:"Current state",type:"Key",unit:"Yes/No"},{id:134,group:"G",category:"Accountability",indicator:"Financial transparency on city government companies",scope:2,dimension:"Current state",type:"Key",unit:"Yes/No"},{id:135,group:"G",category:"Accountability",indicator:"ISO certification",scope:2,dimension:"Current state",type:"Key",unit:"Yes/No"},{id:136,group:"G",category:"Accountability",indicator:"City council checks and balances",scope:1,dimension:"Ability & willingness",type:"Supportive",unit:"Yes/No"},{id:137,group:"G",category:"Accountability",indicator:"Plans to obtain ISO certification",scope:2,dimension:"Ability & willingness",type:"Supportive",unit:"Yes/No"},{id:138,group:"G",category:"Accountability",indicator:"Perception of accountability index",scope:1,dimension:"Current state",type:"Key",unit:"index"},{id:139,group:"G",category:"City budget",indicator:"Poor financial condition",scope:2,dimension:"Current state",type:"Key",unit:"Yes/No"},{id:140,group:"G",category:"City budget",indicator:"Central/higher level government financial intervention taking place",scope:2,dimension:"Current state",type:"Key",unit:"Yes/No"},{id:141,group:"G",category:"City budget",indicator:"Long-term financial planning",scope:3,dimension:"Ability & willingness",type:"Key",unit:"Yes/No"},{id:142,group:"G",category:"City budget",indicator:"Central/higher level government financial intervention is considered",scope:2,dimension:"Ability & willingness",type:"Supportive",unit:"Yes/No"},{id:143,group:"G",category:"City budget",indicator:"Prudent fiscal policy requirements",scope:2,dimension:"Ability & willingness",type:"Supportive",unit:"Yes/No"},{id:144,group:"G",category:"City budget",indicator:"Medium-term planning",scope:3,dimension:"Ability & willingness",type:"Key",unit:"Yes/No"},{id:145,group:"G",category:"SME",indicator:"Number of SMEs per 100,000 population",scope:2,dimension:"Current state",type:"Key",unit:"per 100,000"},{id:146,group:"G",category:"SME",indicator:"Number of start-ups",scope:2,dimension:"Current state",type:"Supportive",unit:"start-ups"},{id:147,group:"G",category:"SME",indicator:"Global Startup Ecosystem Index",scope:3,dimension:"Current state",type:"Supportive",unit:"index"},{id:148,group:"G",category:"SME",indicator:"Number of SMEs per capita/100 000 population (change in last 3 years)",scope:2,dimension:"Ability & willingness",type:"Supportive",unit:"CAGR, %"},{id:149,group:"G",category:"SME",indicator:"Number of start-ups (change in last 3 years)",scope:2,dimension:"Ability & willingness",type:"Supportive",unit:"CAGR, %"},{id:150,group:"G",category:"Public services",indicator:"Free phone to call the police, ambulance, firefighters",scope:0,dimension:"Current state",type:"Supportive",unit:"index"},{id:151,group:"G",category:"Public services",indicator:"Services for working with citizens' appeals and complaint",scope:1,dimension:"Current state",type:"Supportive",unit:"Yes/No"},{id:152,group:"G",category:"Public services",indicator:"E-gov services",scope:1,dimension:"Current state",type:"Key",unit:"Yes/No"},{id:153,group:"G",category:"Public services",indicator:"Perception of public services index: Public Services",scope:1,dimension:"Current state",type:"Key",unit:"index"},{id:154,group:"G",category:"Sustainability commitment",indicator:"City ESG reporting",scope:3,dimension:"Ability & willingness",type:"Key",unit:"Yes/No"},{id:155,group:"G",category:"Sustainability commitment",indicator:"City ESG reporting verification",scope:3,dimension:"Ability & willingness",type:"Supportive",unit:"Yes/No"},{id:156,group:"G",category:"Sustainability commitment",indicator:"ESG planning",scope:3,dimension:"Ability & willingness",type:"Key",unit:"Yes/No"},{id:157,group:"G",category:"Sustainability commitment",indicator:"Plan with specific targets to develop and implement smart city principles",scope:1,dimension:"Ability & willingness",type:"Supportive",unit:"Yes/No"},{id:158,group:"G",category:"Sustainability commitment",indicator:"Rollout and status of ESG / UN SDG training across the municipal/asset workforce",scope:1,dimension:"Current state",type:"Supportive",unit:"Yes/No"},{id:159,group:"G",category:"Sustainability commitment",indicator:"City municipality involved in network or partnership promoting sustainable development (for example, C40 Cities network)",scope:3,dimension:"Current state",type:"Supportive",unit:"Yes/No"}],u0=({title:n,menuItems:e,indicatorsDataArr:i,setRows:o,accessorKey:s})=>{const l=(x,S)=>i.filter(T=>T[x]===S),[d,p]=ie.useState(null),f=!!d,y=x=>{p(x.currentTarget)},_=()=>{p(null)};return $e("div",{children:[$e(xr,{id:"basic-button","aria-controls":f?"basic-menu":void 0,"aria-haspopup":"true","aria-expanded":f?"true":void 0,onClick:y,style:{fontFamily:"SuisseIntl-Light",fontWeight:600,fontSize:"2vh",textTransform:"none",color:"rgba(0, 0, 0, 0.6)"},children:[n,X("img",{src:"/assets/arrowDownIcon.svg",alt:"arrowDownIcon",style:{marginLeft:"1vh"}})]}),X(w_,{id:"basic-menu",anchorEl:d,open:f,onClose:_,MenuListProps:{"aria-labelledby":"basic-button"},children:e.map(x=>X(Fg,{onClick:()=>{o(l(s,x)),_()},children:x},x))})]},n)},hLe=(n,e,i,o,s,l,d,p,f)=>({id:n,group:e,category:i,indicator:o,scope:s,dimension:l,type:d,unit:p,natural_value:f}),pLe=()=>{C_();const e=Kl().City,i=Cx.find(f=>f.city===e).data,o=f=>{const y=l.map(_=>_[f]);return[...new Set(y)]},s=i.map(f=>({...dLe.find(_=>_.indicator===f.indicator),...f})),l=s.map(f=>hLe(f.id,f.group,f.category,f.indicator,f.scope,f.dimension,f.type,f.unit,f.natural_value)),[d,p]=ie.useState(l);return $e(V0e,{"aria-label":"simple table",children:[X(g_e,{children:$e(cW,{children:[X(ps,{align:"left",children:X(u0,{title:"Category",accessorKey:"category",menuItems:o("category"),indicatorsDataArr:s,setRows:p})}),X(ps,{align:"left",children:X(u0,{title:"Index",accessorKey:"group",menuItems:o("group"),setRows:p})}),X(ps,{align:"left",children:"Indicator"}),X(ps,{align:"center",children:X(u0,{title:"Scope",accessorKey:"scope",menuItems:o("scope"),indicatorsDataArr:s,setRows:p})}),X(ps,{align:"center",children:X(u0,{title:"Dimension",accessorKey:"dimension",menuItems:o("dimension"),indicatorsDataArr:s,setRows:p})}),X(ps,{align:"left",children:X(u0,{title:"Type",accessorKey:"type",menuItems:o("type"),indicatorsDataArr:s,setRows:p})}),X(ps,{align:"left",children:X(u0,{title:"Unit",accessorKey:"unit",menuItems:o("unit"),indicatorsDataArr:s,setRows:p})}),X(ps,{align:"left",children:"Value"})]})}),X(Z0e,{children:d.map(f=>{var y;return $e(cW,{sx:{"&:last-child td, &:last-child th":{border:0}},children:[X(ps,{align:"left",children:f.category}),X(ps,{component:"th",scope:"row",children:f.group}),X(ps,{align:"left",children:f.indicator}),X(ps,{align:"center",children:f.scope}),X(ps,{align:"center",children:f.dimension}),X(ps,{align:"left",children:f.type}),X(ps,{align:"left",children:f.unit}),X(ps,{align:"left",children:Number.isInteger(f.natural_value)?f.natural_value:(y=Number(f.natural_value))==null?void 0:y.toFixed(2)})]},f.id)})})]})},fLe=({setTablePopupOpen:n})=>{const{classes:e}=uLe(),o=Kl().City,s="Urban resilience index";return $e("div",{className:e.backgroundWrapper,children:[$e("div",{className:e.returnBack,onClick:()=>{const l=document.getElementById("landing");l.scrollTo({top:l.clientHeight*2}),n(!1)},children:[X("img",{className:e.returnBackIcon,src:"/assets/returnBackIcon.svg",alt:"return back"}),X(Ii,{className:e.returnBackText,children:"Back to Urban resilience index"})]}),X("div",{className:e.content,children:$e("div",{className:e.whiteSection,children:[$e("div",{className:e.titleWrapper,children:[$e("div",{className:e.title,children:[o,": Indicators of "]}),X("div",{className:e.title,style:{color:"#2D67FF"},children:s})]}),X("div",{style:{width:"100%",height:"fit-content",display:"flex"},children:X(c_e,{component:gq,sx:{width:"100%",height:"auto",marginLeft:"8vh",marginRight:"8vh",marginTop:"4vh",marginBottom:"4vh"},children:X(pLe,{})})})]})})]})},ij=()=>{const{classes:n}=VK(),[e,i]=ie.useState(0);ie.useState(!1);const[o,s]=ie.useState(null),[l,d]=ie.useState(!1),[p,f]=ie.useState(!1),y=vu(),{cityName:_}=DY(),x=H6.find(T=>T.City===_);x||y("/");const S=T=>{const I=document.getElementById("landing"),R=I.clientHeight,D=I.scrollTop;let L=0;T=="down"?L=D+R:T=="up"&&(L=D-R),I.scrollTo({top:L,left:0,behavior:"smooth"})};return ie.useEffect(()=>{const T=document.getElementById("landing");return T.addEventListener("wheel",I=>{I.deltaY<0||I.deltaY>0}),()=>{T.removeEventListener("scroll",S)}},[]),ie.useEffect(()=>{const T=document.getElementById("landing");return T.addEventListener("scroll",I=>{}),()=>{T.removeEventListener("scroll",S)}},[]),ie.useEffect(()=>{const T=document.getElementById("landing");T.addEventListener("scroll",I=>{const R=T.clientHeight,D=T.scrollTop,L=Math.floor(D/R);i(L)})},[]),$e(mIe,{cityData:x,children:[p&&X(T_,{setVisible:f}),l&&X(fLe,{setTablePopupOpen:d}),X("div",{style:{position:"absolute",backgroundColor:"#203CBF",width:"100vw",height:"100vh"},children:X(WJ,{invertColors:e===3||e===4,setMenuVisible:f})}),$e("div",{className:n.root,id:"landing",children:[X(Rb,{isActive:e===0,sectionIndex:0,children:X(dIe,{setActiveSection:i})},0),X(Rb,{isActive:e===1,sectionIndex:1,children:X(hIe,{setActiveSection:i})},1),X(Rb,{isActive:e===2,sectionIndex:2,children:X(fIe,{setClickedCategory:s,clickedCategory:o,setTablePopupOpen:d})},2),X(Rb,{isActive:e===3,sectionIndex:3,children:X(aIe,{})},3),((x==null?void 0:x.City)==="Dubai"||(x==null?void 0:x.City)==="Dar es Salaam")&&X(Rb,{isActive:e===5,sectionIndex:5,children:X(MIe,{})},5)]}),o&&X(cLe,{category:o,city:x.City,setClickedCategory:s})]})},mLe=pr()({root:{position:"relative",width:"100%",height:"100vh",backgroundColor:"rgba(21, 52, 175, 1)"},svgBox:{position:"absolute",bottom:"5vh",left:"50%",transform:"translateX(-50%)",height:"80vh",width:"125.5vh"},svg:{position:"absolute",bottom:0,left:0,height:"100%"},toolTip:{width:"15vw"}}),gLe=pr()({root:{position:"absolute",width:"100%",height:"100%",overflowY:"auto"}}),yLe=pr()({root:{display:"flex",flexDirection:"row",alignItems:"start",gap:"8vw"},textWrapper:{maxWidth:"40vw",display:"flex",flexDirection:"row",justifyContent:"start",alignItems:"left",lineHeight:"5vh",gap:"1vh"},name:{width:"10vw",fontFamily:"SuisseIntl-Regular",fontWeight:400,fontSize:"4vh",color:"#000000",opacity:.2,margin:"0"},text:{fontFamily:"SuisseIntl-Light",fontWeight:400,fontSize:"4vh",color:"#000000",margin:"0"}}),dO=pr()({root:{position:"relative",display:"flex",flexDirection:"column",alignItems:"left",boxSizing:"border-box",padding:"0 10vh",gap:"6vh"},smallText:{fontFamily:"SuisseIntl-Regular",fontWeight:400,fontSize:"2vh",color:"#000000",margin:"0"},statusRow:{display:"flex",gap:"1vh",alignItems:"center"},text:{fontFamily:"SuisseIntl-Regular",fontWeight:400,fontSize:"4vh",color:"#000000",margin:"0"},link:{height:"3vh",width:"3vh"},textWrapper:{maxWidth:"40vw",display:"flex",flexDirection:"row",justifyContent:"start",alignItems:"left",lineHeight:"5vh",gap:"1vh"}}),vLe=pr()({root:{zIndex:2,position:"sticky",display:"flex",borderBottom:"1px solid #fff",height:"10.3vh",justifyContent:"space-between",alignItems:"center",top:0,backgroundColor:"#fff",padding:"0 10vh 0 10vh",boxSizing:"border-box"},menuIconWrapper:{cursor:"pointer",display:"flex",justifyContent:"space-between",alignItems:"center",gap:"8px"},buttonsWrapper:{display:"flex",gap:"8px",justifyContent:"space-between",alignItems:"center"},whiteText:{fontFamily:"SuisseIntl-Light",fontWeight:400,color:"#fff",textTransform:"none",fontSize:"1.8vh","&:hover":{backgroundColor:"inherit"}},signUpButton:{fontFamily:"SuisseIntl-Light",fontWeight:600,color:"#fff",textTransform:"none",fontSize:"1.8vh",height:"4.6vh",backgroundColor:"rgba(45, 103, 255, 1)",borderRadius:"50px",padding:"0.5rem 1.3rem","&:hover":{backgroundColor:"rgba(45, 103, 255, 0.85)"}}}),_Le={menu:"Menu",login:"Log in",signup:"Sign up",back:"Back to globe"},bLe=({invertColors:n,setMenuVisible:e})=>{const i=l=>_Le[l],{classes:o}=vLe(),s=vu();return $e("div",{className:o.root,style:{borderBottom:n?"1px solid #000":"1px solid #fff"},children:[$e("div",{style:{display:"flex",gap:"2.5vh",alignItems:"center"},children:[$e("div",{onClick:()=>{s("/marketplace")},style:{display:"flex",gap:"1vh",alignItems:"center",cursor:"pointer",marginRight:"2vh"},children:[X("img",{style:{width:"4.7vh"},src:"/assets/back_black.svg",width:45,alt:"logo"}),X(Ii,{className:o.whiteText,style:{color:"#000"},children:"Back to project market"})]}),$e("div",{className:o.menuIconWrapper,onClick:()=>{e(!0)},children:[n?X("img",{style:{width:"4.7vh"},src:"/assets/blackMenuIcon.svg",width:45,alt:"logo"}):X("img",{style:{width:"4.7vh"},src:"/assets/menuIcon.svg",width:45,alt:"logo"}),X(Ii,{className:o.whiteText,style:{color:n?"#000":"#fff"},children:i("menu")})]})]}),n?X("img",{style:{width:"7.8vh",position:"absolute",left:"50%",transform:"translateX(-50%)"},src:"/assets/blackLogo.svg",alt:"logo"}):X("img",{style:{width:"7.8vh"},src:"/assets/logo.svg",alt:"logo"}),$e("div",{className:o.buttonsWrapper,children:[X("div",{style:{width:"19vh"}}),n?X("img",{src:"/assets/blackAvatarIcon.svg",alt:"user icon"}):X("div",{style:{fontFamily:"SuisseIntl-Light",fontWeight:600,color:"#fff",textTransform:"none",fontSize:"1.8vh",height:"4.6vh",width:"fit-content",padding:"0 1.5vh",backgroundColor:"#fff",borderRadius:"50px",display:"flex",alignItems:"center"},children:X("img",{src:"/assets/avatarIcon.svg",alt:"user icon"})})]})]})},xLe=pr()({bubble:{display:"flex",flexDirection:"row",alignItems:"center",fontFamily:"SuisseIntl-Regular",fontWeight:400,fontSize:"2vh",color:"#000000",boxSizing:"border-box",border:"1px solid #ccc",padding:"1vh 2vh",borderRadius:"50px",backgroundColor:"#ffffff"},statusCircle:{width:"1vh",height:"1vh",borderRadius:"50%",marginLeft:"1vh"}}),wLe=pr()({button:{backgroundColor:"#2D67FF",boxSizing:"border-box",padding:"1vh 2vh",margin:"0",borderRadius:"50px",display:"flex",flexDirection:"row",alignItems:"center",gap:"1vh"},title:{fontFamily:"SuisseIntl-Light",fontWeight:400,fontSize:"2vh",color:"#FFFFFF",textTransform:"none"},icon:{width:"2vh",height:"2vh"}}),SLe=pr()({root:{position:"relative",height:"50vh",overflow:"hidden",borderRadius:"0 0 50px 50px"},image:{width:"100%",height:"100%",objectFit:"cover"}}),ALe=pr()({root:{display:"flex",flexDirection:"column",alignItems:"left",gap:"0.5vh",marginTop:"2vh"},title:{fontFamily:"SuisseIntl-Medium",fontWeight:500,fontSize:"8vh",lineHeight:"9vh",color:"#2D67FF",margin:"0"},subtitle:{fontFamily:"SuisseIntl-Light",fontWeight:400,fontSize:"4vh",color:"#000",margin:"0"},country:{color:"rgba(0, 0, 0, 1)"},city:{color:"rgba(0, 0, 0, 0.4)",cursor:"pointer"},location:{fontFamily:"SuisseIntl-Light",fontWeight:400,fontSize:"2.5vh",color:"rgba(0, 0, 0, 0.2)",margin:"0",display:"flex",flexDirection:"row",alignItems:"center",gap:"4px"}}),ELe=({subtitle:n,country:e,city:i,children:o,style:s})=>{const{classes:l}=ALe(),d=vu();return $e("div",{className:l.root,style:s,children:[$e("div",{children:[X(Ii,{className:l.title,children:o}),X(Ii,{className:l.subtitle,children:n})]}),$e(Ii,{className:l.location,children:[X("span",{className:l.country,children:e})," / ",X("span",{className:l.city,onClick:()=>{d("/city/"+i)},children:i})]})]})},eQ=({title:n,onClick:e,disabled:i,variant:o,style:s})=>{const{classes:l}=wLe();return X("div",{className:l.button,onClick:e,style:s||{opacity:i?.5:1,cursor:i?"default":"pointer",pointerEvents:i?"none":"auto"},children:o==="icon"?$e(_s,{children:[X("img",{className:l.icon,src:"/assets/like_icon.svg",alt:"icon"}),X(Ii,{className:l.title,children:n})]}):X(Ii,{className:l.title,children:n})})},MLe=({imageURL:n,style:e})=>{const{classes:i}=SLe();return $e("div",{className:i.root,style:e,children:[X("img",{className:i.image,src:n,alt:"project image"}),X("div",{style:{position:"absolute",bottom:"4vh",left:"4vh"},children:X(eQ,{title:"Add project to Portfolio",variant:"icon"})})]})},TLe=({parametrs:n,investment:e,newJobs:i,startYear:o,contractType:s})=>{const{classes:l}=dO();return X("div",{style:{display:"flex",flexDirection:"row",gap:"2vw",flex:5},children:$e("div",{style:{display:"flex",flexDirection:"column",gap:"2vh"},children:[$e("div",{style:{display:"flex",flexDirection:"row",gap:"2vh"},children:[X(Ii,{className:l.smallText,style:{width:"11vw"},children:"Parameters"}),X(Ii,{className:l.smallText,style:{maxWidth:"29vw"},children:n})]}),$e("div",{style:{display:"flex",flexDirection:"row",gap:"2vh"},children:[X(Ii,{className:l.smallText,style:{width:"11vw"},children:"Investment, $USD M"}),X(Ii,{className:l.smallText,style:{maxWidth:"29vw"},children:e})]}),$e("div",{style:{display:"flex",flexDirection:"row",gap:"2vh"},children:[X(Ii,{className:l.smallText,style:{width:"11vw"},children:"New jobs"}),X(Ii,{className:l.smallText,style:{maxWidth:"29vw"},children:i})]}),$e("div",{style:{display:"flex",flexDirection:"row",gap:"2vh"},children:[X(Ii,{className:l.smallText,style:{width:"11vw"},children:"Start, year"}),X(Ii,{className:l.smallText,style:{maxWidth:"29vw"},children:o})]}),$e("div",{style:{display:"flex",flexDirection:"row",gap:"2vh"},children:[X(Ii,{className:l.smallText,style:{width:"11vw"},children:"Contract type"}),X(Ii,{className:l.smallText,style:{maxWidth:"29vw"},children:s})]})]})})},_g=({title:n,value:e,style:i,children:o})=>{let s="#000";if(e)switch(e){case"Very strong":s="#35CB00";break;case"Strong":s="#A0DA8B";break;case"Average":s="#FF9B3F";break;case"Low":s="#FF632F";break;case"Very low":s="#FF3B29";break;default:s="#000";break}const{classes:l}=xLe();return e?$e("div",{className:l.bubble,style:i,children:[n,X("div",{className:l.statusCircle,style:{background:s}}),o]}):$e("div",{className:l.bubble,style:i,children:[n,o]})},CLe=({status:n,resilienceImpact:e,directImpact:i,indirectImpact:o})=>{const{classes:s}=dO();let l="#000";switch(e){case"Very strong":l="#35CB00";break;case"Strong":l="#A0DA8B";break;case"Average":l="#FF9B3F";break;case"Low":l="#FF632F";break;case"Very low":l="#FF3B29";break;default:l="#000";break}return X("div",{style:{display:"flex",flexDirection:"row",alignContent:"space-between",gap:"5vw",flex:5},children:$e("div",{style:{display:"flex",flexDirection:"column",gap:"2vh"},children:[$e("div",{className:s.statusRow,children:[X(Ii,{className:s.smallText,style:{width:"9vw"},children:"Status"}),X(_g,{title:n.title,value:n.value})]}),$e("div",{className:s.statusRow,children:[X(Ii,{className:s.smallText,style:{width:"9vw"},children:"Resilience impact"}),X(_g,{title:e,style:{borderColor:l,color:l}})]}),$e("div",{className:s.statusRow,children:[X(Ii,{className:s.smallText,style:{width:"9vw"},children:"Direct impact"}),i.map((d,p)=>X(_g,{title:d.title,value:d.value},p))]}),$e("div",{className:s.statusRow,children:[X(Ii,{className:s.smallText,style:{width:"9vw"},children:"Indirect impact"}),o.map((d,p)=>X(_g,{title:d.title,value:d.value},p))]})]})})},aj=()=>X("div",{style:{width:"100%",height:"1px",backgroundColor:"#000",margin:"0"}}),OA=({name:n,text:e,children:i})=>{const{classes:o}=yLe();return $e("div",{className:o.root,children:[X("div",{className:o.name,children:n}),e&&X("div",{className:o.textWrapper,children:X("div",{className:o.text,children:e})}),i]})},FI=[{ID:8,Country:"Kazakhstan",City:"Almaty",Category:"Inclusion, SME",Searching_for:"Operation & management",Status:"Implementation",Project:"Women Entrepreneurship Development Centers",Desciption:"To provide training and networking opportunities to around 7,000 women.",TitleBlue:" in Almaty",Parametres:"To provide training and networking opportunities to around 7,000 women.",Participation_options:"Operation & management",Goals:"Creation of safe and inclusive business environment, delivering specialized training and capacity building programs to over 15,000 women entrepreneurs across the country by 2025",Investment:200,New_Jobs:7e3,Start_Date:2020,End_Date:2025,Contract_type:"Design-Build",Resilience_Impact:"Average",Direct_Impact:"Inclusion, SME",Indirect_Impact:"Wealth",Location:"https://maps.app.goo.gl/o6eM4KX36KX6zXCU8",Website:"https://www.adb.org/results/building-better-normal-women-entrepreneurs-kazakhstan",News_Sources:"https://www.undp.org/kazakhstan/news/women-entrepreneurship-development-centers-are-opening-all-regions-kazakhstan",News_Headers:"15 March 2022. Women entrepreneurship development centers are opening in all regions of Kazakhstan",Initiator:"the National Commission for Women's Affairs and Family and Population Policy under the President of the Republic of Kazakhstan",Financial_Partners:"Ministry of National Economy, the National Commission for Women's Affairs and Family and Population Policy under the President of the Republic of Kazakhstan, NCE Atameken, Asian Development Bank, the United Nations Development Programme (UNDP) in Kazakhstan.",url:"/assets/PROJECTS/Inclusion.jpg"},{ID:15,Country:"Tanzania",City:"Dar es Salaam",Category:"Water Availability, Water Pollution",Searching_for:"Construction",Status:"Implementation",Project:"New wastewater treatment plant",TitleBlue:" in Dar es Salaam region",Desciption:"Consturction of a new wastewater treatment plant. The project is expected to reduce environmental pollution through safe treatment of wastewater.",Parametres:"New 16K m3 per day wastewater treatment plant",Participation_options:"Construction",Goals:"A new the 16,000 m3/day wastewater plant will mitigate the environmental impact of a growing city and improve the access to clean water.",Investment:178,New_Jobs:40,Start_Date:2023,End_Date:2024,Contract_type:"Design-Build-Operate",Resilience_Impact:"Very strong",Direct_Impact:"Water Availability, Water Pollution",Indirect_Impact:"Health",Location:"https://maps.app.goo.gl/rA2JU3DPmYb1MeXT7",Website:"https://www.maji.go.tz/uploads/publications/sw1683132047-MBEZI%20BEACH%20SEWERAGE%20PROJECT_%20ESIA%20EXECUTIVE%20SUMMARY%20ENGLISH.pdf",News_Sources:"https://www.metito.com/news-detail/tanzania-to-develop-its-first-wastewater-treatment-plant-project-dar-es-salaam-water-supply-and-sanitation-authority-appoints-metito-to-develop-the-first-of-its-type-project/",News_Headers:"4 April 2023. Tanzania to develop its first wastewater treatment plant project Dar es Salaam Water Supply and Sanitation Authority appoints Metito to develop the first of its type project",Initiator:"Dar Es Salaam Water Supply and Sanitation Authority (DAWASA)",Financial_Partners:"Tanzanian Government, the World Bank",Contracting_Party:"Metito",url:"/assets/PROJECTS/Water_Pollution.jpg"}],PLe=({projectID:n})=>{let e=FI[0];n==="8"?e=FI[0]:n==="15"&&(e=FI[1]);let i;switch(e.Status){case"Suspended":i="Very low";break;case"Planning":i="Low";break;case"Implementation":i="Average";break;case"Completed":i="Very strong";break;default:i="Very low";break}const o=e.Direct_Impact.split(", ").map(d=>({title:d})),s=e.Indirect_Impact.split(", ").map(d=>({title:d})),{classes:l}=dO();return $e("div",{className:l.root,children:[$e("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",width:"100%",height:"100%",backgroundColor:"#fff"},children:[$e(ELe,{country:e.Country,city:e.City,style:{flex:5},children:[e.Project,X("span",{style:{color:"#000",fontFamily:"SuisseIntl-Light",fontWeight:400},children:e.TitleBlue})]}),X("div",{style:{flex:1}}),X(MLe,{imageURL:e.url,style:{flex:5}})]}),$e("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"flex-start",width:"100%",height:"100%",backgroundColor:"#fff"},children:[X(TLe,{parametrs:e.Parametres,investment:e.Investment,newJobs:e.New_Jobs,startYear:e.Start_Date,contractType:e.Contract_type}),X("div",{style:{flex:1}}),X(CLe,{status:{title:e.Status,value:i},resilienceImpact:e.Resilience_Impact,directImpact:o,indirectImpact:s})]}),X(aj,{}),X(OA,{name:"Initiator",children:$e("div",{style:{display:"flex",flexDirection:"column",justifyContent:"start",alignItems:"left",gap:"2vh",width:"fit-content"},children:[X("div",{className:l.textWrapper,style:{maxWidth:"100%"},children:X(Ii,{className:l.text,children:e.Initiator})}),X(_g,{title:"Contact initiator",style:{color:"#ffffff",backgroundColor:"#000000",width:"fit-content",padding:"1.2vh 3vh"}})]})}),X(OA,{name:"Financial partners",children:X("div",{style:{display:"flex",flexDirection:"column",justifyContent:"start",alignItems:"left",gap:0},children:e.Financial_Partners.split(", ").map(d=>X("div",{className:l.textWrapper,style:{maxWidth:"100%"},children:X(Ii,{className:l.text,children:d})}))})}),X(aj,{}),X(OA,{name:"Participation options",children:X("div",{style:{display:"flex",flexDirection:"row",justifyContent:"start",alignItems:"center",gap:"2vh",flexWrap:"wrap",maxWidth:"50vw"},children:e.Participation_options.split(", ").map(d=>X(_g,{title:d,style:{color:"#000000",border:"1px solid #000000",backgroundColor:"#FFFFFF",width:"fit-content",fontSize:"4vh",padding:"1.2vh 3vh"}}))})}),X(OA,{name:"Project description",children:X("div",{className:l.textWrapper,style:{flexDirection:"column",maxWidth:"100%",gap:"4vh"},children:X(Ii,{className:l.text,children:e.Desciption})})}),X(_g,{title:"Download project",style:{color:"#ffffff",backgroundColor:"#000000",width:"fit-content",marginLeft:"18vw",padding:"1.2vh 3vh"},children:X("img",{src:"/assets/projects_download_icon.svg",style:{width:"2vh",height:"2vh",marginLeft:"1vh"}})}),X("div",{style:{height:"1vh"}})]})},NA=Bn(({className:n,...e})=>X(E0e,{...e,classes:{popper:n}}))(({theme:n})=>({[`& .${Ih.tooltip}`]:{backgroundColor:"rgba(0, 0, 0, 0)",color:"rgba(0, 0, 0, 0)",maxWidth:220,fontSize:n.typography.pxToRem(12)}})),ILe=({city:n})=>{const{classes:e}=mLe();let i="";switch(n){case"Almaty":i="/assets/pm_schemes/Almaty.svg";break;case"Dar es Salaam":i="/assets/pm_schemes/Dar_es_Salaam.svg";break;default:i="/assets/pm_schemes/Almaty.svg";break}return ie.useState({city:"",category:""}),$e("div",{className:e.root,children:[X("div",{style:{position:"absolute",top:"5vh",left:"5vw",fontFamily:"SuisseIntl-Light",fontWeight:400,fontSize:"8vh",lineHeight:"9vh",color:"#fff",margin:"0"},children:"Project impact"}),$e("div",{className:e.svgBox,children:[X("img",{src:i,className:e.svg,alt:"project impact"}),n==="Almaty"?$e(_s,{children:[X(NA,{title:X(_s,{children:X("img",{src:"/assets/tooltip/SME.svg",alt:"SME data",className:e.toolTip})}),children:X("div",{style:{position:"absolute",width:"4.4vh",height:"4.4vh",top:"42.2vh",right:"47.4vh",borderRadius:"50%"}})}),X(NA,{title:X(_s,{children:X("img",{src:"/assets/tooltip/Inclusion.svg",alt:"Inclusion data",className:e.toolTip})}),children:X("div",{style:{position:"absolute",width:"5vh",height:"5vh",left:"45.9vh",borderRadius:"50%",top:"42.3vh"}})})]}):$e(_s,{children:[X(NA,{title:X(_s,{children:X("img",{src:"/assets/tooltip/Water_availability.svg",alt:"Water_availability data",className:e.toolTip})}),children:X("div",{style:{position:"absolute",width:"5vh",height:"5vh",top:"37.5vh",right:"47.5vh",borderRadius:"50%"}})}),X(NA,{title:X(_s,{children:X("img",{src:"/assets/tooltip/Water_pollution.svg",alt:"Water_pollution data",className:e.toolTip})}),children:X("div",{style:{position:"absolute",width:"6vh",height:"6vh",left:"45.5vh",borderRadius:"50%",top:"37.5vh"}})})]})]}),X(eQ,{title:"Add project to Portfolio",variant:"icon",style:{position:"absolute",bottom:"5vh",right:"5vw",fontFamily:"SuisseIntl-Light",fontWeight:400,fontSize:"8vh",lineHeight:"9vh",color:"#fff",margin:"0"}})]})},LLe=()=>{const{projectID:n}=DY(),[e,i]=ie.useState(!1),{classes:o}=gLe();let s="Almaty";return n==="8"?s="Almaty":n==="15"&&(s="Dar es Salaam"),$e(_s,{children:[e&&X(T_,{setVisible:i}),$e("div",{className:o.root,children:[X(bLe,{invertColors:!0,setMenuVisible:i}),X(PLe,{projectID:n}),X(ILe,{city:s})]})]})},RLe={menu:"Menu",login:"Log in",signup:"Sign up",back:"Back to globe"},kLe=({invertColors:n,setMenuVisible:e})=>{const i=s=>RLe[s],{classes:o}=DT();return vu(),$e("div",{className:o.root,style:{margin:"0 10vh 0 10vh",borderBottom:n?"1px solid #000":"1px solid #fff"},children:[X("div",{style:{display:"flex",gap:"2.5vh",alignItems:"center"},children:$e("div",{className:o.menuIconWrapper,onClick:()=>{e(!0)},children:[n?X("img",{style:{width:"4.7vh"},src:"/assets/blackMenuIcon.svg",width:45,alt:"logo"}):X("img",{style:{width:"4.7vh"},src:"/assets/menuIcon.svg",width:45,alt:"logo"}),X(Ii,{className:o.whiteText,style:{color:n?"#000":"#fff"},children:i("menu")})]})}),n?X("img",{style:{width:"7.8vh"},src:"/assets/blackLogo.svg",alt:"logo"}):X("img",{style:{width:"7.8vh"},src:"/assets/logo.svg",alt:"logo"}),$e("div",{className:o.buttonsWrapper,children:[X("div",{style:{width:"5vh"}}),n?X("img",{src:"/assets/blackAvatarIcon.svg",alt:"user icon"}):X("div",{style:{fontFamily:"SuisseIntl-Light",fontWeight:600,color:"#fff",textTransform:"none",fontSize:"1.8vh",height:"4.6vh",width:"fit-content",padding:"0 1.5vh",backgroundColor:"#fff",borderRadius:"50px",display:"flex",alignItems:"center"},children:X("img",{src:"/assets/avatarIcon.svg",alt:"user icon"})})]})]})},vC=pr()({contentWrapper:{position:"relative",overflowY:"scroll",margin:"0 10vh",height:"calc(100vh - 10.3vh)"},title:{fontFamily:"SuisseIntl-Light",fontWeight:400,fontSize:"6.8vh",margin:"2vh 0vh 4vh"},titleBold:{fontFamily:"SuisseIntl-Regular",fontWeight:"700"},filtersAndProjectsWrapper:{display:"flex",flexDirection:"row",marginBottom:"10vh",gap:"2vh"},filtersWrapper:{flex:1},projectsWrapper:{flex:4,display:"flex",flexDirection:"row",flexWrap:"wrap",rowGap:"4vh",columnGap:"4vh",justifyContent:"flex-start",alignItems:"flex-start",height:"fit-content"},addProjectBtn:{position:"sticky",zIndex:1,top:"2vh",backgroundColor:"#000",color:"#fff",borderRadius:"50px",textTransform:"none",fontSize:"2.1vh",display:"flex",flexDirection:"row",gap:"1vh",padding:"1.5vh 3vh",textWrap:"nowrap"},filterGroupHeader:{fontFamily:"SuisseIntl-Light",fontWeight:400,fontSize:"3.5vh",marginTop:"4vh",marginBottom:"1vh",textWrap:"nowrap"},filterList:{overflow:"visible",display:"flex",flexDirection:"column",gap:"0"},filterRow:{fontFamily:"SuisseIntl-Light",fontWeight:400,fontSize:"2.1vh",display:"flex",flexDirection:"row",justifyContent:"flex-start",alignItems:"center",marginLeft:"-1vh",textWrap:"nowrap"},moreFiltersBtn:{fontFamily:"SuisseIntl-Light",fontWeight:400,fontSize:"2.1vh",color:"#000",cursor:"pointer",marginTop:"1vh",opacity:"0.5"},projectItem:{position:"relative",overflow:"hidden",borderRadius:"3vh",backgroundColor:"#fff",width:"25vh",height:"45vh",display:"flex",flexDirection:"column",justifyContent:"flex-start",alignItems:"center",border:"1px solid #CCCCCC"},statItem:{fontFamily:"SuisseIntl-Light",fontWeight:800,color:"#35CB00",border:"1px solid rgba(53, 203, 0, 0.5)",padding:"1vh 1.5vh",borderRadius:"50px",fontSize:"1.4vh",width:"fit-content"},projectImageWrapper:{width:"100%",height:"15vh",overflow:"hidden",backgroundSize:"cover",backgroundPosition:"center"},projectInfoWrapper:{display:"flex",flexDirection:"column",gap:"1vh",padding:"0 1.5vh",height:"20vh"},projectTitle:{cursor:"pointer",fontFamily:"SuisseIntl-Regular",fontWeight:600,fontSize:"1.8vh"},projectSubTitle:{fontFamily:"SuisseIntl-Light",fontWeight:400,fontSize:"1.5vh",opacity:"0.5"},projectStatsWrapper:{display:"flex",flexDirection:"row",alignItems:"center",gap:"1.5vh"},impactLabel:{fontFamily:"SuisseIntl-Regular",fontWeight:100,fontSize:"1.5vh"},likeBtn:{backgroundColor:"#2D67FF",fontSize:"1.5vh",color:"#fff",borderRadius:"50px",display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"flex-start",justifySelf:"flex-end",gap:"2vh",padding:".7vh 1.5vh",textTransform:"none",width:"21vh","&:hover":{backgroundColor:"#000"}},projectsOnMapBtn:{position:"absolute",top:"9vh",right:"6vw",zIndex:200,cursor:"pointer",width:"12vh",height:"12vh"}}),zA=({title:n,checked:e,onChange:i})=>{const{classes:o}=vC(),s=()=>{i&&i(n)};return X("div",{children:$e("div",{className:o.filterRow,children:[X(oye,{checked:e,style:{marginLeft:"0"},onChange:s}),X("div",{children:n})]})})},rj={"Very Low":Hs.VERY_LOW,Low:Hs.LOW,Average:Hs.AVERAGE,Strong:Hs.STRONG,"Very Strong":Hs.VERY_STRONG},DLe={Suspended:Hs.VERY_LOW,Planning:Hs.LOW,Implementation:Hs.AVERAGE,Completed:Hs.VERY_STRONG},OLe=({project:n,isLiked:e,setLikedProjects:i})=>{const{classes:o}=vC(),s=vu(),[l,d]=ie.useState(!1);ie.useEffect(()=>{d(e)},[e]);const p=()=>{d(!l),i(y=>l?y.filter(_=>_.id!==n.id):[...y,n]);const f=localStorage.getItem("grp:likedProjects");if(f){const y=JSON.parse(f);if(l){const _=y.filter(x=>x.id!==n.id);localStorage.setItem("grp:likedProjects",JSON.stringify(_))}else localStorage.setItem("grp:likedProjects",JSON.stringify([...y,n]))}else localStorage.setItem("grp:likedProjects",JSON.stringify([n]))};return $e("div",{className:o.projectItem,style:{opacity:n.id==8||n.id==15?1:.6},children:[$e("div",{style:{position:"absolute",right:"1.2vh",top:"1.2vh",backgroundColor:"#fff",padding:"0.5vh 1vh 0.5vh 1vh",borderRadius:"2vh",display:"flex",flexDirection:"row",alignItems:"center",gap:"0.5vh",fontFamily:"SuisseIntl-Light",fontWeight:600,fontSize:"1.4vh"},children:[n.Status,X("div",{style:{width:"1.2vh",height:"1.2vh",borderRadius:"50%",backgroundColor:DLe[n.Status]}})]}),X("div",{className:o.projectImageWrapper,style:{backgroundImage:`url(${n.url})`}}),$e("div",{className:o.projectInfoWrapper,children:[$e("div",{style:{fontFamily:"SuisseIntl-Light",fontWeight:600,fontSize:"1.4vh",marginTop:"2vh"},children:[n.City,", ",n.Country]}),$e("div",{className:o.projectTitle,onClick:()=>{(n.id==8||n.id==15)&&s(`/project_page/${n.id}`)},children:[n.Project," ",X("img",{src:"/assets/arrowRightIcon.svg",alt:"arrowRightIcon"})]}),X("div",{className:o.projectSubTitle,children:n.Description})]}),$e("div",{style:{display:"flex",flexDirection:"column-reverse",height:"10vh"},children:[$e(xr,{onClick:p,className:o.likeBtn,style:{marginBottom:"2vh"},children:[X("img",{src:l?"/assets/likeIconFill.svg":"/assets/likeIcon.svg",alt:"likeIcon",style:{width:"1.8vh",height:"1.8vh"}}),"Add to Portfolio"]}),$e("div",{className:o.projectStatsWrapper,style:{marginBottom:"2vh"},children:[X("div",{className:o.impactLabel,children:"Impact"}),X("div",{className:o.statItem,style:{color:rj[n["Resilience Impact"]],borderColor:`${rj[n["Resilience Impact"]]}30`},children:n["Resilience Impact"]})]})]})]})},$g=[{id:1,Country:"Kazakhstan",City:"Almaty",Category:"Air Pollution, Energy Availability","Searching for":"Finance",Status:"Implementation",Project:"Modernisation of CHP-2 (TETs-2)",Description:"Conversion from coal to gas, increase in installed capacity from 510 to 600 MW","Resilience Impact":"Very strong",url:"/assets/PROJECTS/Air_Pollution.jpg"},{id:2,Country:"Kazakhstan",City:"Almaty",Category:"Transport","Searching for":"Construction",Status:"Implementation",Project:"Expansion and Modernisation of the International Airport",Description:"The international passenger terminal with an area of 53K m²","Resilience Impact":"Low",url:"/assets/PROJECTS/Transport.jpg"},{id:3,Country:"Kazakhstan",City:"Almaty",Category:"Water Pollution, Natural disaster hazards","Searching for":"Construction",Status:"Implementation",Project:"Reconstruction of Aryk Water Drainage Networks",Description:"Constuction of 376 km of aryk water drainage network","Resilience Impact":"Very strong",url:"/assets/PROJECTS/Water_Pollution.jpg"},{id:4,Country:"Kazakhstan",City:"Almaty",Category:"Transport","Searching for":"Construction",Status:"Completed",Project:"Big Ring Almaty Road (BAKAD)",Description:"Сonstruction of a 66-km first class bypass road","Resilience Impact":"Strong",url:"/assets/PROJECTS/Transport.jpg"},{id:5,Country:"Kazakhstan",City:"Almaty",Category:"Transport","Searching for":"Finance",Status:"Implementation",Project:"Renewal of Electric Public Transport",Description:"Acquisition of 190 modern trolleybuses and rehabilitation of 10 power supply sub-stations","Resilience Impact":"Strong",url:"/assets/PROJECTS/Transport.jpg"},{id:6,Country:"Kazakhstan",City:"Almaty",Category:"Liveability, Energy Availability","Searching for":"Finance",Status:"Suspended",Project:"Modernisation of Outdoor Lighting",Description:"Replacement with modern luminaires and supports for 45K+ light points","Resilience Impact":"Strong",url:"/assets/PROJECTS/Livability.jpg"},{id:7,Country:"Kazakhstan",City:"Almaty",Category:"Accountability, Public Services","Searching for":"Finance",Status:"Implementation",Project:'Public Reception Office "Open Almaty"',Description:'Creation of a public reception centre on the principle of "one window"',"Resilience Impact":"Low",url:"/assets/PROJECTS/Public_Services.jpg"},{id:8,Country:"Kazakhstan",City:"Almaty",Category:"Inclusion, SME",Status:"Implementation",Project:"Women Entrepreneurship Development Centres",Description:"Provide training and networking opportunities to around 7K women","Resilience Impact":"Average",url:"/assets/PROJECTS/Inclusion.jpg"},{id:9,Country:"Kazakhstan",City:"Almaty",Category:"Sustainability Commitment, Inclusion",Status:"Completed",Project:"Involvement of Youth in Solving ESG Problems",Description:"Raising sustainability awareness among future decision makers","Resilience Impact":"Low",url:"/assets/PROJECTS/Inclusion.jpg"},{id:10,Country:"Tanzania",City:"Dar es Salaam",Category:"Greening, Air Pollution, Land use and waste","Searching for":"Finance",Status:"Implementation",Project:"Urban Greening",Description:"Facilitating greening interventions to prevent surface water runoff and soil erosion","Resilience Impact":"Strong",url:"/assets/PROJECTS/Land_use_and_waste.jpg"},{id:11,Country:"Tanzania",City:"Dar es Salaam",Category:"Land use and waste","Searching for":"Finance",Status:"Planning",Project:"Waste Collection and Management",Description:"Creation of the centralised waste collection, management and recycling system","Resilience Impact":"Very strong",url:"/assets/PROJECTS/Land_use_and_waste.jpg"},{id:12,Country:"Tanzania",City:"Dar es Salaam",Category:"Air Pollution, Energy Availability","Searching for":"Finance",Status:"Planning",Project:"CNG and PNG Distribution Network ",Description:"New gas distribution trunk pipelines to form a complete network","Resilience Impact":"Very strong",url:"/assets/PROJECTS/Air_Pollution.jpg"},{id:13,Country:"Tanzania",City:"Dar es Salaam",Category:"SME, Wealth","Searching for":"Finance",Status:"Planning",Project:"Expansion of the Nyerere Trade Fair Ground",Description:"Construction halls, an expo village, conference halls, and banking ","Resilience Impact":"Low",url:"/assets/PROJECTS/Wealth.jpg"},{id:14,Country:"Tanzania",City:"Dar es Salaam",Category:"Transport","Searching for":"Finance",Status:"Planning",Project:"Procurement and Repair of Rolling Stocks of the Railways",Description:"Revamp of railway operations of the Central Line to Kigoma and Mwanza","Resilience Impact":"Very strong",url:"/assets/PROJECTS/Transport.jpg"},{id:15,Country:"Tanzania",City:"Dar es Salaam",Category:"Water Availability, Water Pollution","Searching for":"Construction",Status:"Implementation",Project:"New Wastewater Treatment Plant",Description:"New 16K m3 per day wastewater treatment plant","Resilience Impact":"Very strong",url:"/assets/PROJECTS/Water_Pollution.jpg"},{id:16,Country:"Tanzania",City:"Dar es Salaam",Category:"Transport, Air Pollution","Searching for":"Finance",Status:"Implementation",Project:"Bus Rapid Transit Project – Phase 2",Description:"20.3 km of exclusive BRT lanes along Kilwa Road","Resilience Impact":"Very strong",url:"/assets/PROJECTS/Transport.jpg"},{id:17,Country:"Tanzania",City:"Dar es Salaam",Category:"Accountability, Health","Searching for":"",Status:"Completed",Project:"Covid-19 Crisis Response Budget Support",Description:"Creation a national Covid-19 response plan and mitigation measures","Resilience Impact":"Average",url:"/assets/PROJECTS/Health.jpg"}],NLe=()=>{const e=[...new Set($g.map(i=>i.Category))].map(i=>i.split(", ")).flat();return new Set(e)},zLe=()=>{const n=$g.map(e=>e["Searching for"]);return new Set(n.filter(e=>e))},FLe=()=>{const n=$g.map(e=>e.Status);return new Set(n.filter(e=>e))},BLe=()=>{const n=$g.map(e=>e.Country);return new Set(n.filter(e=>e))},ULe=({setFilteredProjects:n})=>{const{classes:e}=vC(),[i,o]=ie.useState(!1),s=zLe(),l=FLe(),d=NLe(),p=BLe(),[f,y]=ie.useState({categories:new Set,searchFor:new Set,statuses:new Set,countries:new Set});ie.useEffect(()=>{if(!f.categories.size&&!f.searchFor.size&&!f.statuses.size&&!f.countries.size){n($g);return}else{let x=$g;f.categories.size&&(x=x.filter(S=>Array.from(f.categories).some(T=>S.Category.includes(T)))),f.searchFor.size&&(x=x.filter(S=>Array.from(f.searchFor).some(T=>S["Searching for"]?S["Searching for"].includes(T):!1))),f.statuses.size&&(x=x.filter(S=>Array.from(f.statuses).some(T=>S.Status.includes(T)))),f.countries.size&&(x=x.filter(S=>Array.from(f.countries).some(T=>S.Country.includes(T)))),n(x)}},[f]);const _=(x,S)=>{f[S].has(x)?f[S].delete(x):f[S].add(x),y({...f})};return $e("div",{children:[X("div",{className:e.filterGroupHeader,children:"Searching for"}),X("div",{className:e.filterList,children:Array.from(s).map(x=>X(zA,{title:x,checked:f.searchFor.has(x),onChange:S=>_(S,"searchFor")},x))}),X("div",{className:e.filterGroupHeader,children:"Status"}),X("div",{className:e.filterList,children:Array.from(l).map(x=>X(zA,{title:x,checked:f.statuses.has(x),onChange:S=>_(S,"statuses")},x))}),X("div",{className:e.filterGroupHeader,children:"Category"}),$e("div",{className:e.filterList,children:[Array.from(d).slice(0,i?d.size:3).map(x=>X(zA,{title:x,checked:f.categories.has(x),onChange:S=>_(S,"categories")},x)),X("div",{className:e.moreFiltersBtn,onClick:()=>o(!i),children:i?"Show less":"More categories"})]}),X("div",{className:e.filterGroupHeader,children:"Country"}),X("div",{className:e.filterList,children:Array.from(p).map(x=>X(zA,{title:x,checked:f.countries.has(x),onChange:S=>_(S,"countries")},x))})]})},WLe=()=>{const{classes:n}=vC(),[e,i]=ie.useState($g.sort((p,f)=>p.id==8||p.id==15?-1:f.id==8||f.id==15?1:0)),[o,s]=ie.useState([]),[l,d]=ie.useState(!1);return ie.useEffect(()=>{const p=localStorage.getItem("grp:likedProjects");p&&s(JSON.parse(p))},[]),$e("div",{children:[l&&X(T_,{setVisible:d}),X(kLe,{invertColors:!0,setMenuVisible:d}),X("img",{src:"/assets/projectsOnMapBtn.svg",alt:"projectsOnMapBtn",className:n.projectsOnMapBtn}),X(_ye,{direction:"up",in:o.length>0,mountOnEnter:!0,unmountOnExit:!0,children:$e("div",{style:{position:"absolute",left:"10vh",bottom:"4vh",backgroundColor:"#000",color:"#fff",zIndex:1,borderTopRightRadius:"2vh",borderTopLeftRadius:"2vh",borderBottomRightRadius:"4vh",borderBottomLeftRadius:"4vh",padding:"2vh",display:"flex",flexDirection:"column",gap:"1vh"},children:[$e("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center",gap:"1vh"},children:[X("img",{src:"/assets/likeIconFill.svg",alt:"likeIcon",style:{width:"2.5vh",height:"2.5vh"}}),$e("div",{style:{fontFamily:"SuisseIntl-Regular",fontWeight:100,fontSize:"1.8vh"},children:[o.length+" "," projects added"]})]}),$e(xr,{className:n.likeBtn,style:{alignItems:"center",justifyContent:"center",fontSize:"1.8vh"},children:["Check your Portfolio"," "]})]})}),$e("div",{className:n.contentWrapper,children:[$e("div",{className:n.title,children:["Project ",X("span",{className:n.titleBold,children:"marketplace"})]}),$e("div",{className:n.filtersAndProjectsWrapper,children:[$e("div",{className:n.filtersWrapper,children:[$e(xr,{className:n.addProjectBtn,children:[X("img",{src:"/assets/plusIconWhite.svg",alt:"plus"}),"Add project"]}),X(ULe,{setFilteredProjects:i})]}),X("div",{className:n.projectsWrapper,children:e.map(p=>X(OLe,{project:p,isLiked:o.some(f=>f.id===p.id),setLikedProjects:s},p.id))})]})]})]})},_C=pr()({root:{position:"absolute",top:0,left:0,width:"100%",height:"100%",backgroundImage:"url(/assets/mainPageBg.png)",backgroundSize:"cover",backgroundRepeat:"no-repeat",backgroundPosition:"center"},title:{fontFamily:"SuisseIntl-Light",fontWeight:400,fontSize:"6vh",display:"flex",justifyContent:"center",alignItems:"center",textAlign:"center",color:"#fff",marginTop:"5vh"},content:{display:"flex",flexDirection:"row",width:"100%",color:"#fff",fontFamily:"SuisseIntl-Light",fontWeight:400,fontSize:"4.5vh",marginTop:"15vh"},sectionWrapper:{flex:1,paddingLeft:"15vh"},smallTextGroupWrapper:{display:"flex",flexDirection:"row",fontSize:"2vh",gap:"5vh",marginTop:"4vh"},smallTextWrapper:{alignSelf:"flex-start",display:"flex",flexDirection:"column",gap:"1vh",textWrap:"nowrap"},sectionTitle:{alignSelf:"flex-end"},whiteButton:{fontFamily:"SuisseIntl-Light",fontWeight:600,backgroundColor:"#fff",color:"#000",width:"fit-content",padding:"1vh 3vh",borderRadius:"4vh",textTransform:"none",fontSize:"2.8vh",display:"flex",justifyContent:"center",alignItems:"center",gap:"1vh","&:hover":{backgroundColor:"#fff"}}}),VLe=()=>{const{classes:n}=_C();return X("div",{className:n.title,children:$e("div",{children:[$e("span",{style:{fontFamily:"SuisseIntl-Regular",fontWeight:600},children:["Global Resilience Platform"," "]}),"is a data-driven ",X("br",{}),"resilience diagnostic observatory for the",X("br",{})," Global South which provides"]})})},GLe=()=>{const{classes:n}=_C(),[e,i]=ie.useState(!1);return $e("div",{className:n.root,children:[e&&X(T_,{setVisible:i}),X(WJ,{setMenuVisible:i,displayBackButton:!0,marginLogo:"15vh"}),X(VLe,{}),$e("div",{className:n.content,children:[X(HLe,{}),X(jLe,{})]})]})},FA={title:$e(_s,{children:[X("b",{children:"Ratings & monitoring"}),X("br",{})," tool for cities and ",X("br",{})," corporates"]}),first:$e("div",{children:["Reimagining ESG ",X("br",{}),"metrics through the ",X("br",{})," lens of Resilience"]}),second:$e("div",{children:["Focusing on basic ",X("br",{})," needs satisfaction ",X("br",{})," and human’s dignity"]}),third:$e("div",{children:["Introducing ",X("br",{}),"transparent ",X("br",{}),"methodology & AI-",X("br",{}),"driven data handling"]})},HLe=()=>{const{classes:n}=_C(),e=vu();return $e("div",{className:n.sectionWrapper,children:[X("div",{className:n.sectionTitle,children:FA.title}),$e("div",{className:n.smallTextGroupWrapper,children:[$e("div",{className:n.smallTextWrapper,children:[X($0,{}),FA.first]}),$e("div",{className:n.smallTextWrapper,children:[X($0,{}),FA.second]}),$e("div",{className:n.smallTextWrapper,children:[X($0,{}),FA.third]})]}),$e("div",{style:{display:"flex",flexDirection:"row",gap:"2vh",marginTop:"5vh"},children:[$e(xr,{className:n.whiteButton,onClick:()=>e("/urban"),children:["Urban",X("img",{src:"assets/arrowRightIcon.svg",alt:"arrowRightIcon",style:{width:"2.5vh",height:"2.5vh"}})]}),$e(xr,{className:n.whiteButton,disabled:!0,style:{opacity:.5},children:["Corporate",X("img",{src:"assets/arrowRightIcon.svg",alt:"arrowRightIcon",style:{width:"2.5vh",height:"2.5vh"}})]})]})]})},BA={title:$e(_s,{children:["Projects ",X("br",{}),X("b",{children:"marketplace"})]}),first:$e("div",{children:["Evaluating the ",X("br",{})," resilience impact of ",X("br",{}),"investment projects"]}),second:$e("div",{children:["Promoting the better ",X("br",{})," impact investment ",X("br",{})," opportunities"]}),third:$e("div",{children:["Bridging the gap between ",X("br",{})," impact investment ",X("br",{})," demand and supply"]})},jLe=()=>{const{classes:n}=_C(),e=vu();return $e("div",{className:n.sectionWrapper,style:{paddingLeft:0},children:[X("div",{className:n.sectionTitle,style:{marginTop:"5vh"},children:BA.title}),$e("div",{className:n.smallTextGroupWrapper,children:[$e("div",{className:n.smallTextWrapper,children:[X($0,{}),BA.first]}),$e("div",{className:n.smallTextWrapper,children:[X($0,{}),BA.second]}),$e("div",{className:n.smallTextWrapper,children:[X($0,{}),BA.third]})]}),X("div",{style:{display:"flex",flexDirection:"row",gap:"2vh",marginTop:"7.5vh"},children:$e(xr,{className:n.whiteButton,onClick:()=>e("/marketplace"),children:["Project marketplace",X("img",{src:"assets/arrowRightIcon.svg",alt:"arrowRightIcon",style:{width:"2.5vh",height:"2.5vh"}})]})})]})},$0=()=>X("div",{style:{width:"1vh",height:"1vh",backgroundColor:"#fff",borderRadius:"50%"}}),$Le={menu:"Menu",login:"Log in",signup:"Sign up",back:"Back to globe"},YLe=({invertColors:n,setMenuVisible:e,displayBackButton:i,marginLogo:o})=>{const s=d=>$Le[d],{classes:l}=DT();return vu(),$e("div",{className:l.root,style:{margin:"0 10vh 0 10vh",borderBottom:n?"1px solid #000":"1px solid #fff",backgroundColor:"transparent"},children:[X("div",{style:{display:"flex",gap:"2.5vh",alignItems:"center"},children:X("div",{className:l.menuIconWrapper,children:$e("div",{onClick:()=>e(!0),style:{display:"flex",gap:"1vh",flexDirection:"row",alignItems:"center"},children:[X("img",{style:{width:"4.7vh"},src:"/assets/orangeMenuIcon.svg",width:45,alt:"logo"}),X(Ii,{className:l.whiteText,style:{color:n?"#000":"#fff"},children:s("menu")})]})})}),X("img",{style:{width:"50vh",marginLeft:o||"0"},src:n?"/assets/expo_logo_black.svg":"/assets/expo_logo.svg",alt:"logo"}),X("img",{src:"/assets/orangeAvatarIcon.svg",alt:"user icon"})]})},qLe=pr()({root:{position:"absolute",width:"100vw",height:"100vh"},headerWrapper:{position:"absolute",width:"100vw",height:"100vh"},contentWrapper:{position:"absolute",overflowY:"scroll",width:"100vw",height:"100vh","&::-webkit-scrollbar":{width:"0em"}},sectionWrapper:{position:"relative",height:"100%",width:"100%"},title:{fontFamily:"SuisseIntl-Light",fontWeight:100,fontSize:"6vh",color:"#fff"},textWrapper:{position:"relative",zIndex:1,marginLeft:"10vh",paddingTop:"15vh"},description:{paddingTop:"4vh",fontFamily:"SuisseIntl-Light",fontWeight:100,fontSize:"3vh",color:"#fff",width:"40vw"},bottomWrapper:{position:"absolute",bottom:"0",zIndex:1,display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:"4vh",pointerEvents:"none",width:"100%"}}),oj=["/assets/expo_bg.png","/assets/Expo/1.jpg","/assets/Expo/2.jpg","/assets/Expo/3.jpg","/assets/Expo/4.jpg","/assets/Expo/5.jpg"],XLe=()=>{const{classes:n}=qLe(),[e,i]=ie.useState(0),[o,s]=ie.useState(0),[l,d]=ie.useState(!1);return ie.useEffect(()=>{const p=document.getElementById("landing2");p.addEventListener("scroll",f=>{const y=p.clientHeight,_=p.scrollTop,x=Math.floor(_/y);s(x)})},[]),$e("div",{className:n.root,children:[l&&X(T_,{setVisible:d}),X("div",{className:n.headerWrapper,children:X(YLe,{displayBackButton:!0,invertColors:o===1,marginLogo:"0 10vh 0 10vh",setMenuVisible:d})}),$e("div",{className:n.contentWrapper,id:"landing2",children:[$e("div",{className:n.sectionWrapper,children:[X(HJ,{imagesUrls:oj,activeImageIndex:e}),X("div",{style:{position:"absolute",width:"100%",height:"100%",background:"linear-gradient(180deg, rgba(0,0,0,0.65) 60%, rgba(0,0,0,0.4))"}}),$e("div",{className:n.textWrapper,children:[$e("div",{className:n.title,children:["Expo City Dubai is the visionary inspiration",X("br",{}),"behind the"," ",X("span",{style:{color:"#FFB800"},children:X("b",{children:"Global Resilience Platform"})})]}),$e("div",{className:n.description,children:["Global Resilience platform is one of the tools Expo City employs to promote its values which centre around diversity, sustainability, and knowledge-sharing. The city prioritizes sustainable practices and open exchange of ideas to shape ",X("br",{})," a better future for the community and environment. ",X("br",{}),X("br",{}),X("a",{target:"_blank",href:"https://www.expocitydubai.com/en/",style:{color:"#fff"},children:"Explore more about Expo City Dubai"})]})]}),$e("div",{className:n.bottomWrapper,children:[X("div",{}),X("div",{style:{position:"absolute",width:"100%",display:"flex",flexDirection:"row",justifyContent:"center",gap:"1.6vh"},children:oj.map((p,f)=>X(GJ,{bgUrl:p,onClick:()=>{i(f)},isActive:e===f},f))}),$e(xr,{style:{pointerEvents:"all",color:"#000",backgroundColor:"#FFB800",borderRadius:50,padding:"1vh 2.5vh",textTransform:"none",fontFamily:"SuisseIntl-Light",fontSize:"1.7vh",display:"flex",flexDirection:"row",justifyContent:"center",gap:"1.2vh",marginRight:"10vh"},children:[X("div",{onClick:()=>{const p="Dubai_Expo_IEC_A&S_Report.pdf",f=document.createElement("a");f.href=`/pdf/${p}`,f.download=p,f.click()},children:"Download report"}),X("img",{src:"/assets/downloadIcon.svg",alt:"arrow down",style:{filter:"invert(1)"}})]})]}),$e("div",{style:{position:"absolute",bottom:"12vh",width:"100%",textAlign:"center",fontFamily:"SuisseIntl-Light",fontWeight:100,fontSize:"3vh",color:"#fff"},children:[X("span",{style:{color:"#FFB800"},children:"Expo City Dubai"}),X("br",{}),"Flourishing and expanding business environment"]})]}),$e("div",{className:n.sectionWrapper,style:{backgroundImage:"url(/assets/expo_bg_2.png)",backgroundSize:"cover",backgroundPosition:"center"},children:[$e("div",{className:n.textWrapper,children:[X("div",{className:n.title,style:{color:"#000"},children:"Expo City Dubai, UAE"}),X("img",{src:"/assets/expo_urban.svg",alt:"expo",style:{width:"50vh",marginTop:"4vh"}})]}),X("img",{src:"/assets/expo_cube.png",alt:"expo",style:{position:"absolute",bottom:"0",width:"77vh"}}),$e("div",{style:{position:"absolute",top:"15vh",right:"10vh",width:"45vw",height:"65vh",fontFamily:"SuisseIntl-Light",fontWeight:100,fontSize:"2vh",border:"1.5px solid #FFB800",borderRadius:"1vh",padding:"2vh",overflowY:"scroll",zIndex:1},children:["Expo City Dubai not only remains true to its Expo 2020 heritage but also transcends it. ECD is building upon the great legacy of the Expo, making a remarkable leap forward, and developing into a thriving urban community. This transformation is acknowledged by the city’s high rating. ",X("br",{}),X("br",{}),"The ECD’s urban environment is based on the 15-minute city concept, ensuring that sustainability is the focal point within its boundaries. Expo City demonstrates exceptional livability through internationally certified urban developments and construction initiatives accredited by LEED and BREEAM. ",X("br",{}),X("br",{}),"A defining feature of Expo City Dubai is its unwavering commitment to implementing top-tier environmental, social, and governance policies. The city prioritizes inclusion fostering equal opportunities for all. Expo City sets the pace for inclusion in Asia by creating and implementing best practices in gender equality and empowering people of determination. This commitment is reinforced by initiatives supporting representation and participation in the labor force. Also, this approach extends to the urban infrastructure design, providing an accessible environment for all. Designed as a pedestrian-centric city, Expo City minimizes its carbon footprint by emphasizing walkability, green spaces, and efficient public transport. ",X("br",{}),X("br",{}),"While upholding high standards, Expo City Dubai is actively striving to further enhance its sustainability practices. The city has made significant investments in tree planting initiatives, facilitating the rapid expansion of lush green spaces across the city. Despite challenges such as relatively higher water and electricity tariffs in proportion to income, which may concern future residents, the city is taking proactive measures to ensure a balanced and sustainable cost of living. In its pursuit of becoming an unparalleled residential destination, Expo City is dedicated to improving accessibility to essential amenities such as best practice governmental services, schools, and hospitals.",X("br",{}),X("br",{}),"Special measures are being implemented to address air pollution concerns, aligning with the broader sustainability objectives prevalent in the Middle East, considering environmental and climate hazards. Expo City Dubai stands as a testament to its commitment to sustainable practices, continuously evolving to provide an increasingly harmonious, eco-friendly, and desirable living environment for its residents while setting new standards for responsible urban development in the Global South."]}),$e(xr,{style:{position:"absolute",marginRight:"10vh",bottom:"2vw",right:0,width:"fit-content",pointerEvents:"all",color:"#000",backgroundColor:"#FFB800",borderRadius:50,padding:"1vh 2.5vh",textTransform:"none",fontFamily:"SuisseIntl-Light",fontSize:"1.7vh",display:"flex",flexDirection:"row",justifyContent:"center",gap:"1.2vh"},children:[X("div",{onClick:()=>{const p="Dubai_Expo_IEC_A&S_Report.pdf",f=document.createElement("a");f.href=`/pdf/${p}`,f.download=p,f.click()},children:"Download report"}),X("img",{src:"/assets/downloadIcon.svg",alt:"arrow down",style:{filter:"invert(1)"}})]})]})]})]})},ZLe=[{path:"/",element:X(GLe,{})},{path:"/urban",element:X(ZMe,{})},{path:"/city",element:X(ij,{}),state:{selectedCityName:"Moscow"}},{path:"/city/:cityName",element:X(ij,{})},{path:"/project_page/:projectID",element:X(LLe,{})},{path:"/marketplace",element:X(WLe,{})},{path:"/expo_city_dubai",element:X(XLe,{})}],KLe=()=>prompt("Enter password")==="g"?(localStorage.setItem("user","admin"),X(nQ,{})):X("div",{children:"Wrong password"}),tQ=document.getElementById("root");if(!tQ)throw new Error("There is no root element in HTML!");const JLe=Rce(ZLe),QLe=localStorage.getItem("user"),nQ=()=>X(wpe,{theme:F_e,children:X(Wce,{router:JLe})});BI.createRoot(tQ).render(X(cu.StrictMode,{children:QLe==="admin"?X(nQ,{}):KLe()}));
